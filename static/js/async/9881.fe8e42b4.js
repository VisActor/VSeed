/*! For license information please see 9881.fe8e42b4.js.LICENSE.txt */
(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["9881"],{11697:function(t,e,i){"use strict";let r,n;i.r(e),i.d(e,{isValueInScaleDomain:()=>ao,PolarBandAxis:()=>bq,isProgressiveDataColorScheme:()=>it,PolarMarkLine:()=>Rn,registerSunburstChart:()=>wL,CircularProgressSeries:()=>_X,SEGMENT_FIELD_START:()=>sw,TextMark:()=>_R,registerMarkLine:()=>Re,registerDimensionTooltipProcessor:()=>mb,BasePolygonMark:()=>CR,registerMarkPoint:()=>R7,createLine:()=>cq.W,ThemeManager:()=>iL,findMarkGraphic:()=>iU,stackOffsetSilhouette:()=>dQ,MOSAIC_CAT_START_PERCENT:()=>sx,MediaQuery:()=>EH,queryColorFromColorScheme:()=>e8,RadarChart:()=>_c,getGroupAnimationParams:()=>cO,LayoutLevel:()=>z,BasePieChart:()=>bC,DEFAULT_SERIES_STYLE_NAME:()=>sa,dataScheme:()=>ez,GroupMark:()=>og,vglobal:()=>ea.rF,PolarSeries:()=>v1,registerSankeyChart:()=>AZ,registerArcAnimation:()=>de,getTheme:()=>iR,PieChart:()=>bw,STACK_FIELD_KEY:()=>so,DimensionEventEnum:()=>Z,registerScaleInOutAnimation:()=>u3,CartesianMarkArea:()=>Rp,stackMosaicTotal:()=>dq,registerRangeColumnSeries:()=>C9,registerScrollBar:()=>kN,registerComponentMark:()=>gj,valueInScaleRange:()=>aa,isColorKey:()=>e7,STACK_FIELD_TOTAL:()=>sf,piePresetAnimation:()=>be,getSpecInfo:()=>d6,normalizeLayoutPaddingSpec:()=>ek,registerRectAnimation:()=>dt,computeActualDataScheme:()=>e6,getDimensionInfoByValue:()=>ms,randomOpacity:()=>EN,registerElementHighlightByLegend:()=>Pb,SankeySeries:()=>AD,registerAllMarks:()=>PE,MarkTypeEnum:()=>tE,columnRightToLeft:()=>EG,BaseSeriesSpecTransformer:()=>cE,registerHistogramChart:()=>_j,registerCartesianTimeAxis:()=>Mx,FunnelSeries:()=>CO,HeatmapChart:()=>A7,pieDisappear:()=>bt,registerWordCloudChart:()=>Cg,registerReactAttributePlugin:()=>uA,alternatingWave:()=>Eq,isZAxis:()=>p2,registerElementHighlight:()=>dm,DEFAULT_DATA_SERIES_FIELD:()=>sl,ImageMark:()=>PB,registerVennSeries:()=>Ew,sortDataInAxisHelper:()=>cF,lookup:()=>yk,StreamLight:()=>PD.G,registerMediaQuery:()=>Ez,registerCartesianLogAxis:()=>MM,BaseArcMark:()=>bd,registerStateTransition:()=>E7,STACK_FIELD_START_PERCENT:()=>sd,DEFAULT_LAYOUT_RECT_LEVEL_MIN:()=>sU,barGrowOut:()=>m1,registerTreemapChart:()=>Sc,STACK_FIELD_END:()=>su,PathMark:()=>yL,RadarSeries:()=>_h,AttributeLevel:()=>W,WaterfallSeries:()=>SI,PREFIX:()=>st,STACK_FIELD_END_PERCENT:()=>sc,Layout:()=>lr,STACK_FIELD_START:()=>sh,defaultThemeName:()=>iS,TransformLevel:()=>F,registerLiquidSeries:()=>PQ,CorrelationSeries:()=>Mf,RuleMark:()=>_b,registerTreemapSeries:()=>Sh,registerPieSeries:()=>bb,BaseWordCloudChart:()=>xh,MapSeries:()=>vX,isPercent:()=>eC,RangeAreaChart:()=>Aq,WaterfallChart:()=>SO,CartesianSymlogAxis:()=>MT,PolarMarkArea:()=>Rm,createRect:()=>yt.f,registerTitle:()=>Ro,TotalLabel:()=>R0,registerContinuousLegend:()=>M0,getCartesianCrosshairRect:()=>md,getColorSchemeBySeries:()=>ii,registerSankeySeries:()=>AH,RoseSeries:()=>b1,DEFAULT_MEASURE_CANVAS_ID:()=>sr,registerVRenderAnimate:()=>uM.d,CartesianLinearAxis:()=>fv,SymbolMark:()=>pG,registerCirclePackingChart:()=>w5,registerHarmonyEnv:()=>ua,STACK_FIELD_TOTAL_PERCENT:()=>sm,createArc:()=>bn.Q,registerPolarBandAxis:()=>bJ,centerToCorner:()=>E5,BoxPlotSeries:()=>Ar,registerMarkArea:()=>Rg,DEFAULT_DATA_KEY:()=>ss,registerNodeEnv:()=>ur,functionTransform:()=>eu,registerIndicator:()=>kY,registerCorrelationChart:()=>Mb,SeriesTypeEnum:()=>rR,registerGeoCoordinate:()=>v$,VennChart:()=>EA,barGrowIn:()=>m0,registerGeoMarkPoint:()=>Br,registerRangeColumnChart:()=>we,STACK_FIELD_START_OffsetSilhouette:()=>sp,WordCloudChart:()=>Cp,ManualTicker:()=>PO,registerAnimate:()=>dn,registerBrush:()=>Bc,Tooltip:()=>M9,registerGroupMark:()=>of,ScrollBar:()=>kW,LiquidChart:()=>P0,registerMosaicSeries:()=>ER,CartesianMarkLine:()=>Rt,Stack:()=>fU,CommonChart:()=>_f,getDiffAttributesOfGraphic:()=>iK,shouldMarkDoMorph:()=>cR,DataZoom:()=>kH,GaugePointerSeries:()=>xt,ComponentMark:()=>gN,builtinThemes:()=>iw,registerArcMark:()=>bp,registerDataZoom:()=>kz,getCombinedSizeOfRegions:()=>gY,getRegionStackGroup:()=>d$,ContinuousLegend:()=>MQ,rotationScan:()=>E$,registerPoptip:()=>Bb,CirclePackingSeries:()=>w0,registerImageMark:()=>PP,registerLabel:()=>RQ,registerLineChart:()=>mA,calcLayoutNumber:()=>eS,AreaSeries:()=>m$,CartesianBandAxis:()=>fs,diagonalCenterToEdge:()=>EU,getFieldAlias:()=>dK,pulseWave:()=>E4,boundsInRect:()=>eM,isCollectionMark:()=>iV,CorrelationChart:()=>Mv,CircularProgressChart:()=>_0,registerBarChart:()=>yu,registerLarkEnv:()=>ue,AreaMark:()=>mj,BaseChart:()=>fV,registerMosaicChart:()=>EP,PolygonMark:()=>CE,calcPadding:()=>eA,registerLinearProgressSeries:()=>CX,version:()=>PH,LinearProgressChart:()=>CJ,SunburstSeries:()=>wB,registerLynxEnv:()=>ui,registerLineSeries:()=>fL,setDefaultCrosshairForCartesianChart:()=>sW,LiquidSeries:()=>PJ,registerSunBurstSeries:()=>wP,STACK_FIELD_TOTAL_BOTTOM:()=>sv,LinkSeries:()=>_w,BaseSeries:()=>cI,registerRoseChart:()=>b9,stackMosaic:()=>dJ,lightTheme:()=>eN,BoxPlotChart:()=>Al,BaseWordCloudChartSpecTransformer:()=>xo,MapChart:()=>vQ,registerAllEnv:()=>h7,registerGaugeSeries:()=>xn,registerRoseSeries:()=>b2,BaseWordCloudSeries:()=>xb,BaseHistogramChart:()=>_z,CartesianTimeAxis:()=>M_,FunnelChart:()=>Cz,MOSAIC_CAT_END_PERCENT:()=>sC,SankeyChart:()=>AV,transformToGraphic:()=>gd,mergeFields:()=>dU,registerPolarLinearAxis:()=>b0,columnEdgeToCenter:()=>E0,registerLinearProgressChart:()=>CQ,registerTaroEnv:()=>un,queryToken:()=>uo,getMergedTheme:()=>iE,Event:()=>iO,DEFAULT_SMOOTH_INTERPOLATE:()=>cH,registerBoxplotChart:()=>Aa,createSymbol:()=>pN.t,getCartesianDimensionInfo:()=>mr,registerWaterfallSeries:()=>SL,RoseLikeSeries:()=>bP,BaseComponent:()=>gz,FormatterPlugin:()=>Pa,registerPolarCrossHair:()=>km,registerLinkSeries:()=>_S,STATE_VALUE_ENUM:()=>j,AxisSyncPlugin:()=>ga,spiralEffect:()=>EJ,STACK_FIELD_TOTAL_TOP:()=>sy,BasePieChartSpecTransformer:()=>bx,rowTopToBottom:()=>EV,registerElementActive:()=>Pd,BaseMark:()=>od,TreemapChart:()=>Sd,registerPolarMarkPoint:()=>Be,CommonChartSpecTransformer:()=>_g,BandAxisMixin:()=>gQ,SEGMENT_FIELD_END:()=>sS,isPercentOffset:()=>ew,registerFunnelSeries:()=>CD,MosaicChart:()=>EB,WordCloudSeries:()=>Cu,CartesianSeries:()=>cD,transformColorSchemeToStandardStruct:()=>ie,createGroup:()=>n9.sS,CartesianChartSpecTransformer:()=>fH,pieExit:()=>v7,CirclePackingChart:()=>w3,rowCenterToEdge:()=>E1,registerDimensionHover:()=>fX,themes:()=>iA,registerCustomMark:()=>Bg,registerDataSetInstanceTransform:()=>nq,AreaChart:()=>mq,Brush:()=>Bd,isXAxis:()=>p0,registerAreaMark:()=>mG,registerHtmlAttributePlugin:()=>uw,Player:()=>RV,GaugeSeries:()=>xr,registerElementHighlightByName:()=>Pw,DEFAULT_LINEAR_INTERPOLATE:()=>cz,PolarLinearAxis:()=>bQ,registerGroupTooltipProcessor:()=>mw,registerTooltip:()=>M7,registerElementHighlightByGroup:()=>PM,registerRangeAreaChart:()=>AJ,registerHeatmapSeries:()=>A8,DEFAULT_ANIMATION_CONFIG:()=>u0,GridLayout:()=>Bf,ScatterSeries:()=>yx,stackTotal:()=>dX,registerCircularProgressSeries:()=>_q,columnLeftToRight:()=>Ej,registerElementActiveByLegend:()=>Pf,registerAreaChart:()=>mJ,registerDimensionEvents:()=>f8,CompilableData:()=>aC,registerMapChart:()=>v0,PolarAxis:()=>bF,PieSeriesSpecTransformer:()=>bf,createRichText:()=>_T.p,registerCirclePackingSeries:()=>w1,registerCircularProgressChart:()=>_1,registerPolygonMark:()=>CI,DEFAULT_DATA_INDEX:()=>sn,RenderModeEnum:()=>rM,Factory:()=>iv,registerVennChart:()=>EM,GlyphMark:()=>SX,registerBoxplotSeries:()=>An,cornerToCenter:()=>E3,registerFormatPlugin:()=>Po,RangeAreaSeries:()=>A$,Direction:()=>tI,registerRangeAreaSeries:()=>AY,RangeColumnSeries:()=>C8,SeriesMarkNameEnum:()=>rB,registerWXEnv:()=>us,snakeWave:()=>EX,GaugeChart:()=>xl,Indicator:()=>k$,LineChart:()=>mS,registerCartesianCrossHair:()=>kh,registerMapSeries:()=>vq,registerMarkFilterTransform:()=>Se,registerCustomAnimate:()=>E8.Hp,registerWordCloudSeries:()=>Cd,HistogramChartSpecTransformer:()=>_W,getActualNumValue:()=>eR,PieSeries:()=>bv,BasePieSeries:()=>by,registerBarSeries:()=>ya,themeExist:()=>iP,DEFAULT_KEY:()=>sA,isSpecValueWithScale:()=>ah,DomTooltipHandler:()=>BG,registerSymbolMark:()=>pV,registerCartesianLinearAxis:()=>fb,registerCartesianSymlogAxis:()=>MR,baseSeriesMark:()=>cy,token:()=>eW,rowBottomToTop:()=>EZ,registerGesturePlugin:()=>dl,BaseComponentSpecTransformer:()=>gD,DimensionHoverEvent:()=>f4,DimensionClickEvent:()=>f6,registerDotSeries:()=>_I,registerMarkMapTransform:()=>Si,registerPolygonAnimation:()=>dr,registerRectMark:()=>yi,registerRuleMark:()=>__,BarChart:()=>yh,LineMark:()=>pz,registerRadarSeries:()=>_u,getActualColor:()=>e9,registerSequentialAnimate:()=>Is,rowEdgeToCenter:()=>E2,Title:()=>Ra,RectMark:()=>ye,RoseChart:()=>b8,TreemapSeries:()=>So,darkTheme:()=>ej,isYAxis:()=>p1,GeoSeries:()=>yT,ArcMark:()=>bc,LineSeries:()=>fI,FunnelChartSpecTransformer:()=>CH,SequenceChart:()=>_O,registerSequenceChart:()=>_D,registerFunnelChart:()=>CW,DEFAULT_LAYOUT_RECT_LEVEL:()=>sZ,USER_LAYOUT_RECT_LEVEL:()=>sV,CartesianCrossHair:()=>ko,registerDomTooltipHandler:()=>BV,registerScatterSeries:()=>yC,sortStackValueGroup:()=>dY,userAnimationConfig:()=>cM,VennSeries:()=>EC,DEFAULT_CHART_HEIGHT:()=>si,HeatmapSeries:()=>A6,VChart:()=>dw,stack:()=>d0,pieEnter:()=>v9,registerScatterChart:()=>yA,registerTotalLabel:()=>R1,registerCartesianBandAxis:()=>fl,CartesianLogAxis:()=>MA,DotSeries:()=>_E,registerRadarChart:()=>_p,CustomMark:()=>Bp,registerCanvasTooltipHandler:()=>B5,HistogramChart:()=>_N,registerGlyphMark:()=>Sq,convertPoint:()=>eT,PositionEnum:()=>tL,Label:()=>RJ,isTokenKey:()=>uh,registerTTEnv:()=>ul,ChartEvent:()=>rI,registerPathMark:()=>yF,registerPolarMarkArea:()=>Ry,PolarCrossHair:()=>kf,BarSeriesSpecTransformer:()=>ys,CartesianAxis:()=>gJ,registerLiquidChart:()=>P1,registerMarkTooltipProcessor:()=>mx,BarSeries:()=>yl,ScatterChart:()=>yS,getPolarDimensionInfo:()=>b6,registerDataSetInstanceParser:()=>nJ,RippleMark:()=>Mu,createScaleWithSpec:()=>al,registerLineMark:()=>pW,columnCenterToEdge:()=>EQ,getDatumOfGraphic:()=>iZ,DEFAULT_CHART_WIDTH:()=>se,ElementHighlight:()=>df,TooltipResult:()=>tD,measureText:()=>ov,SunburstChart:()=>wI,specTransform:()=>eh,registerTextMark:()=>_B,DiscreteLegend:()=>MH,getDataScheme:()=>e4,LinearProgressSeries:()=>CY,registerTheme:()=>iT,GeoCoordinate:()=>vK,rippleEffect:()=>EY,ElementSelect:()=>dv,BaseChartSpecTransformer:()=>fD,registerCommonChart:()=>_m,registerBrowserEnv:()=>ut,particleEffect:()=>E6,RangeColumnSeriesSpecTransformer:()=>C6,createScale:()=>as,registerDragPlugin:()=>ds,registerGaugeChart:()=>xa,registerWordCloudShapeChart:()=>Cf,BasePlugin:()=>gl,BaseSeriesTooltipHelper:()=>cs,barPresetAnimation:()=>m5,LinearAxisMixin:()=>ff,isPolarAxisSeries:()=>cL,hasThemeMerged:()=>ik,CartesianMarkPoint:()=>R9,SeriesTypeForThemeEnum:()=>tO,createArea:()=>mR,diagonalTopLeftToBottomRight:()=>EK,registerChartPlugin:()=>Pr,MosaicSeries:()=>ET,registerElementHighlightByKey:()=>PR,FunnelSeriesSpecTransformer:()=>CF,PolarMarkPoint:()=>Bt,isValidOrient:()=>ex,registerDiscreteLegend:()=>Mz,registerAreaSeries:()=>mY,registerWaterfallChart:()=>SD,LayoutZIndex:()=>H,removeTheme:()=>iB,getFunnelTheme:()=>ix,DEFAULT_CLOSE_STROKE_JOIN:()=>cW,registerElementSelect:()=>db,registerGridLayout:()=>By,registerPieChart:()=>bS,StackChartMixin:()=>fK,MOSAIC_VALUE_END_PERCENT:()=>s_,RangeColumnChart:()=>wt,ProgressLikeSeries:()=>_V,registerPlayer:()=>RZ,CanvasTooltipHandler:()=>B3,default:()=>Il,registerHeatmapChart:()=>Mt,stackGroup:()=>d1,GeoMarkPoint:()=>Bi,STACK_FIELD_END_OffsetSilhouette:()=>sg,registerPolarMarkLine:()=>Rs,MOSAIC_VALUE_START_PERCENT:()=>sb,animationConfig:()=>cA,createText:()=>g$.r,registerRippleMark:()=>Md,BarChartSpecTransformer:()=>yo,warn:()=>eO,registerGaugePointerSeries:()=>xe});var s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X,q,J,Q,te,ti,tr,tn,ts,tl,ta,to,th,tu,td,tc,tp,tg,tf,tm,ty,tv,tb,t_,tx,tC,tw,tS,tA,tM,tk,tT,tR,tB,tP,tE,tI,tL,tF,tO,tD,tH={};i.r(tH),i.d(tH,{LX:()=>lq});let tz=t=>t;(rm=rM||(rM={}))["desktop-browser"]="desktop-browser",rm["mobile-browser"]="mobile-browser",rm.node="node",rm.worker="worker",rm.miniApp="miniApp",rm.wx="wx",rm.tt="tt",rm.harmony="harmony",rm["desktop-miniApp"]="desktop-miniApp",rm.lynx="lynx",(ry=rk||(rk={})).cartesianAxis="cartesianAxis",ry.cartesianBandAxis="cartesianAxis-band",ry.cartesianLinearAxis="cartesianAxis-linear",ry.cartesianTimeAxis="cartesianAxis-time",ry.cartesianLogAxis="cartesianAxis-log",ry.cartesianSymlogAxis="cartesianAxis-symlog",ry.polarAxis="polarAxis",ry.polarBandAxis="polarAxis-band",ry.polarLinearAxis="polarAxis-linear",ry.crosshair="crosshair",ry.cartesianCrosshair="cartesianCrosshair",ry.polarCrosshair="polarCrosshair",ry.dataZoom="dataZoom",ry.geoCoordinate="geoCoordinate",ry.indicator="indicator",ry.discreteLegend="discreteLegend",ry.continuousLegend="continuousLegend",ry.colorLegend="colorLegend",ry.sizeLegend="sizeLegend",ry.markLine="markLine",ry.markArea="markArea",ry.markPoint="markPoint",ry.polarMarkLine="polarMarkLine",ry.polarMarkArea="polarMarkArea",ry.polarMarkPoint="polarMarkPoint",ry.geoMarkPoint="geoMarkPoint",ry.tooltip="tooltip",ry.title="title",ry.player="player",ry.scrollBar="scrollBar",ry.label="label",ry.totalLabel="totalLabel",ry.brush="brush",ry.poptip="poptip",ry.customMark="customMark";var tW=i(21883),tN=i.n(tW);let tj=(t,e)=>Object.prototype.toString.call(t)===`[object ${e}]`,tG=(t,e=!1)=>{let i=typeof t;return e?"number"===i:"number"===i||tj(t,"Number")},tV="undefined"!=typeof console;function tZ(t,e,i){let r=[e].concat([].slice.call(i));tV&&console[t].apply(console,r)}(rv=rT||(rT={}))[rv.None=0]="None",rv[rv.Error=1]="Error",rv[rv.Warn=2]="Warn",rv[rv.Info=3]="Info",rv[rv.Debug=4]="Debug";class tU{static getInstance(t,e){return tU._instance&&tG(t)?tU._instance.level(t):tU._instance||(tU._instance=new tU(t,e)),tU._instance}static setInstance(t){return tU._instance=t}static setInstanceLevel(t){tU._instance?tU._instance.level(t):tU._instance=new tU(t)}static clearInstance(){tU._instance=null}constructor(t=rT.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){let e=this._onErrorHandler.findIndex(e=>e===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=rT.Info}canLogDebug(){return this._level>=rT.Debug}canLogError(){return this._level>=rT.Error}canLogWarn(){return this._level>=rT.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=rT.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):tZ(null!=(e=this._method)?e:"error","ERROR",t)),this}warn(...t){return this._level>=rT.Warn&&tZ(this._method||"warn","WARN",t),this}info(...t){return this._level>=rT.Info&&tZ(this._method||"log","INFO",t),this}debug(...t){return this._level>=rT.Debug&&tZ(this._method||"log","DEBUG",t),this}}tU._instance=null;let tK=0;function t$(t="dataset"){return tK>1e8&&(tK=0),t+"_"+tK++}class tY{constructor(t){var e;let i;this.options=t,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new(tN()),i=(null==t?void 0:t.name)?t.name:t$("dataset"),this.name=i,this._logger=null!=(e=null==t?void 0:t.logger)?e:tU.getInstance()}setLogger(t){this._logger=t}getDataView(t){return this.dataViewMap[t]}setDataView(t,e){var i;this.dataViewMap[t]&&(null==(i=this._logger)||i.error(`Error: dataView ${t} 之前已存在，请重新命名`)),this.dataViewMap[t]=e}removeDataView(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}registerParser(t,e){var i;this.parserMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.parserMap[t]=e}removeParser(t){this.parserMap[t]=null,delete this.parserMap[t]}getParser(t){return this.parserMap[t]||this.parserMap.default}registerTransform(t,e){var i;this.transformMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.transformMap[t]=e}removeTransform(t){this.transformMap[t]=null,delete this.transformMap[t]}getTransform(t){return this.transformMap[t]}multipleDataViewAddListener(t,e,i){this._callMap||(this._callMap=new Map);let r=this._callMap.get(i);r||(r=()=>{t.some(t=>t.isRunning)||i()}),t.forEach(t=>{t.target.addListener(e,r)}),this._callMap.set(i,r)}allDataViewAddListener(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}multipleDataViewRemoveListener(t,e,i){if(this._callMap){let r=this._callMap.get(i);r&&t.forEach(t=>{t.target.removeListener(e,r)}),this._callMap.delete(i)}}multipleDataViewUpdateInParse(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.parseNewData(t.data,t.options)})}multipleDataViewUpdateInRawData(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.updateRawData(t.data,t.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}let tX=(t,e=!1)=>e?"boolean"==typeof t:!0===t||!1===t||tj(t,"Boolean"),tq=t=>Array.isArray?Array.isArray(t):tj(t,"Array"),tJ=(t,e,i)=>{let r=!tX(null==e?void 0:e.dependencyUpdate)||(null==e?void 0:e.dependencyUpdate);if(!t||!tq(t))throw TypeError("Invalid data: must be DataView array!");return tq(i.rawData)&&i.rawData.forEach(t=>{t.target&&(t.target.removeListener("change",i.reRunAllTransform),t.target.removeListener("markRunning",i.markRunning))}),r&&t.forEach(t=>{t.target.addListener("change",i.reRunAllTransform),t.target.addListener("markRunning",i.markRunning)}),t},tQ=t=>"function"==typeof t,t0=t=>"object"==typeof t&&null!==t,t1=function(t){if(!t0(t)||!tj(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function t2(t){return Object.prototype.toString.call(t)}function t3(t){return Object.keys(t)}function t5(t,e,i){if(t===e)return!0;if(typeof t!=typeof e||null==t||null==e)return!1;if(Number.isNaN(t)&&Number.isNaN(e))return!0;if(t2(t)!==t2(e))return!1;if(tQ(t))return!!(null==i?void 0:i.skipFunction);if("object"!=typeof t)return!1;if(tq(t)){if(t.length!==e.length)return!1;for(let r=t.length-1;r>=0;r--)if(!t5(t[r],e[r],i))return!1;return!0}if(!t1(t))return!1;let r=t3(t),n=t3(e);if(r.length!==n.length)return!1;r.sort(),n.sort();for(let t=r.length-1;t>=0;t--)if(r[t]!=n[t])return!1;for(let n=r.length-1;n>=0;n--){let s=r[n];if(!t5(t[s],e[s],i))return!1}return!0}let t4=t=>tj(t,"Date"),t6=(t,e=!1)=>{let i=typeof t;return e?"string"===i:"string"===i||tj(t,"String")},t8=t=>null!=t;function t9(t,e,i){let r;if(!t8(t)||"object"!=typeof t||e&&e(t))return t;let n=tq(t),s=t.length;r=n?Array(s):"object"==typeof t?{}:tX(t)||tG(t)||t6(t)?t:t4(t)?new Date(+t):void 0;let l=n?void 0:Object.keys(Object(t)),a=-1;if(r)for(;++a<(l||t).length;){let n=l?l[a]:a,s=t[n];i&&i.includes(n.toString())?r[n]=s:r[n]=t9(s,e,i)}return r}let t7=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)};function et(t,e,i=!1,r=!1){if(e&&t!==e&&t8(e)&&"object"==typeof e){let n=Object(e),s=[];for(let t in n)s.push(t);let{length:l}=s,a=-1;for(;l--;){let l=s[++a];!t8(n[l])||"object"!=typeof n[l]||r&&tq(t[l])?ee(t,l,n[l]):function(t,e,i,r=!1,n=!1){let s=t[i],l=e[i],a=e[i],o=!0;if(tq(l)){if(r)a=[];else if(tq(s))a=s;else if(t7(s)){a=Array(s.length);let t=-1,e=s.length;for(;++t<e;)a[t]=s[t]}}else t1(l)?(a=null!=s?s:{},"function"!=typeof s&&"object"==typeof s||(a={})):o=!1;o&&et(a,l,r,n),ee(t,i,a)}(t,e,l,i,r)}}}function ee(t,e,i){var r,n;(void 0===i||(r=t[e],r===(n=i)||Number.isNaN(r)&&Number.isNaN(n)))&&(void 0!==i||e in t)||(t[e]=i)}function ei(t,...e){let i=-1,r=e.length;for(;++i<r;)et(t,e[i],!0);return t}let er=t=>null==t,en=t=>tG(t)&&Number.isFinite(t),es=(t,e)=>{var i,r;if(!(null==e?void 0:e.fields)||0===t.length)return t;let n=e.fields,s=t[0],l={},a=[];for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e)){let o,h=n[e];if(h.sort&&(en(h.sortIndex)||(h.sortIndex=0),t8(h.sortReverse)||(h.sortReverse="desc"===h.sort)),!h.type){let r=s;e in s||(r=null!=(i=t.find(t=>e in t))?i:s),h.type="number"==typeof r[e]?"linear":"ordinal"}if("number"==typeof h.sortIndex&&(o={key:e,type:h.type,index:h.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===h.sortReverse},a.push(o)),(null==(r=h.domain)?void 0:r.length)>0)if("ordinal"===h.type){h._domainCache={},l[e]=h;let t={};h.domain.forEach((e,i)=>{t[e]=i,h._domainCache[e]=i}),o&&(o.sortIndex=t,o.sortIndexCount=h.domain.length)}else h.domain.length>=2&&(l[e]=h)}return Object.keys(l).length>0&&(t=t.filter(t=>{for(let e in l){let i=l[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0})),a.sort((t,e)=>t.index-e.index),t.sort((t,e)=>(function(t,e,i){for(let r=0;r<i.length;r++){let n=i[r],s=0;if("ordinal"===n.type?(void 0===n.sortIndex[e[n.key]]&&(n.sortIndex[e[n.key]]=n.sortIndexCount++),void 0===n.sortIndex[t[n.key]]&&(n.sortIndex[t[n.key]]=n.sortIndexCount++),s=n.sortIndex[t[n.key]]-n.sortIndex[e[n.key]]):"linear"===n.type&&(s=t[n.key]-e[n.key]),n.sortReverse&&(s=-s),0!==s)return s}return 0})(t,e,a)),t};class el{constructor(t,e){let i;this.dataSet=t,this.options=e,this.isDataView=!0,this.target=new(tN()),this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(t={})=>{let e=this.latestData;return this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(e=>{this.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1})}),this.isRunning=!1,!1===t.emitMessage||t.skipEqual&&t5(e,this.latestData)||this.target.emit("change",{latestData:this.latestData}),this},this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},i=(null==e?void 0:e.name)?e.name:t$("dataview"),this.name=i,(null==e?void 0:e.history)&&(this.history=e.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(null==e?void 0:e.fields)}parse(t,e,i=!1){var r;this.isRunning=!0,i&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);let n=this.cloneParseData(t,e);if(null==e?void 0:e.type){let t=(null!=(r=this.dataSet.getParser(e.type))?r:this.dataSet.getParser("bytejson"))(n,e.options,this);this.rawData=n,this.parserData=t,this.history&&this.historyData.push(n,t),this.latestData=t}else this.parserData=n,this.rawData=n,this.history&&this.historyData.push(n),this.latestData=n;return this.isRunning=!1,i&&this.target.emit("afterParse",[]),this}transform(t,e=!0){if(this.isRunning=!0,t&&t.type){let i=!0;if("fields"===t.type){this._fields=t.options.fields;let e=this.transformsArr.findIndex(e=>e.type===t.type);e>=0&&(i=!1,this.transformsArr[e].options.fields=this._fields)}i&&this.transformsArr.push(t),e&&this.executeTransform(t)}return this.sortTransform(),this.isRunning=!1,this}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((t,e)=>{var i,r;return(null!=(i=t.level)?i:0)-(null!=(r=e.level)?r:0)})}executeTransform(t,e={}){let{pushHistory:i,emitMessage:r,skipEqual:n}=e,s=this.dataSet.getTransform(t.type),l=this.latestData,a=s(l,t.options);this.history&&!1!==i&&this.historyData.push(a),this.latestData=a,!1===r||n&&t5(l,this.latestData)||this.target.emit("change",{latestData:this.latestData})}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}cloneParseData(t,e){let i=!1;return t instanceof el||!0!==(null==e?void 0:e.clone)||(i=!0),i?t9(t):t}parseNewData(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}updateRawData(t,e){let i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var t;return this._fields?this._fields:"dataview"===(null==(t=this.parseOption)?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(t,e=!1){this._fields=t&&e?ei({},this._fields,t):t;let i=this.transformsArr.find(t=>"fields"===t.type);!er(this._fields)&&er(i)?(this.dataSet.registerTransform("fields",es),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}var ea=i(89983);function eo(t){return function(e){return tq(t)?t.reduce((t,e)=>null==t?void 0:t[e],e):null==e?void 0:e[t]}}function eh(t,e={data:t=>t}){if(!t)return t;if(t.constructor===Object){let i={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e[r]){i[r]=e[r](t[r]);continue}i[r]=eh(t[r],e)}return i}return tq(t)?t.map(t=>eh(t,e)):t}function eu(t,e){if(!t)return t;if(t1(t)){let i={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(t6(t[r])&&e.getFunction(t[r])){i[r]=e.getFunction(t[r]);continue}i[r]=eu(t[r],e)}return i}return tq(t)?t.map(t=>eu(t,e)):t}function ed(t){return t8(t)?tq(t)?t:[t]:[]}function ec(t){if(t7(t))return t[t.length-1]}let ep=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let n=1;n<t.length;n++){let s=t[n];(null!=(i=null==e?void 0:e(s,r))?i:s-r)>0&&(r=s)}return r},eg=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let n=1;n<t.length;n++){let s=t[n];(null!=(i=null==e?void 0:e(s,r))?i:s-r)<0&&(r=s)}return r};function ef(t,e=Math.random){let i,r,n=t.length;for(;n;)i=Math.floor(e()*n),r=t[--n],t[n]=t[i],t[i]=r;return t}let em=0;function ey(){return em>=9999999&&(em=0),em++}function ev(t){return null!=t&&""!==t&&(!!tG(t)||+t==+t)}function eb(t){return!(!t||0===t.length)&&!er(t[0])&&!er(t[0].dataId)&&tq(t[0].fields)}let e_=t=>{let e=typeof t;return null!==t&&"object"===e||"function"===e};function ex(t){switch(t){case"left":case"right":case"top":case"bottom":return!0;default:return!1}}function eC(t){return!!t6(t)&&!!t.endsWith("%")&&ev(t.substring(0,t.length-1))}function ew(t){return!!e_(t)&&("percent"in t||"offset"in t)}function eS(t,e,i,r=0){var n,s;return tG(t)?t:eC(t)?Number(t.substring(0,t.length-1))*e/100:tQ(t)?t(i):e_(t)?e*(null!=(n=t.percent)?n:0)+(null!=(s=t.offset)?s:0):r}function eA(t,e,i){var r,n,s,l;let a={top:0,bottom:0,left:0,right:0};return Object.values(t).every(t=>tG(t))?(a.top=null!=(r=t.top)?r:0,a.right=null!=(n=t.right)?n:0,a.bottom=null!=(s=t.bottom)?s:0,a.left=null!=(l=t.left)?l:0):[{orients:["left","right"],size:e.width},{orients:["top","bottom"],size:e.height}].forEach(e=>{e.orients.forEach(r=>{a[r]=eS(t[r],e.size,i)})}),a}function eM(t,e){return t?{width:Math.ceil(Math.min(t.x2-t.x1,e.width)),height:Math.ceil(Math.min(t.y2-t.y1,e.height))}:{width:0,height:0}}function ek(t){let e={};return tq(t)?(er(t[0])||(e.top=e.left=e.bottom=e.right=t[0]),er(t[1])||(e.left=e.right=t[1]),er(t[2])||(e.bottom=t[2]),er(t[3])||(e.left=t[3]),e):tG(t)||eC(t)||tQ(t)||ew(t)?(e.top=e.left=e.bottom=e.right=t,e):e_(t)?e=Object.assign({},t):e}function eT(t,e,i){return i?{x:t.x+e.x,y:t.y+e.y}:t}let eR=(t,e)=>{let i=Number(t),r=t.toString();return isNaN(i)&&"%"===r[r.length-1]?e*(Number(r.slice(0,r.length-1))/100):i},eB=(0,i(27865).kP)(),eP=eB&&globalThis?globalThis.document:void 0;function eE(t){return("desktop-browser"===t||"mobile-browser"===t)&&eB}function eI(t){return eL(t)||"mobile-browser"===t}function eL(t){return t.includes("miniApp")||"lynx"===t||"wx"===t||"harmony"===t}let eF=(t,...e)=>eH.silent?null:tU.getInstance().info(`[VChart log]: ${t}`,...e),eO=(t,e)=>(tQ(eH.warnHandler)&&eH.warnHandler.call(null,t,e),e?tU.getInstance().warn(`[VChart warn]: ${t}`,e):tU.getInstance().warn(`[VChart warn]: ${t}`)),eD=(t,e,i)=>{if(!eH.silent){if(!tQ(eH.errorHandler))throw Error(t);eH.errorHandler.call(null,t,e)}},eH={silent:!1,warnHandler:!1,errorHandler:!1},ez=[{maxDomainLength:10,scheme:["#1664FF","#1AC6FF","#FF8A00","#3CC780","#7442D4","#FFC400","#304D77","#B48DEB","#009488","#FF7DDA"]},{scheme:["#1664FF","#B2CFFF","#1AC6FF","#94EFFF","#FF8A00","#FFCE7A","#3CC780","#B9EDCD","#7442D4","#DDC5FA","#FFC400","#FAE878","#304D77","#8B959E","#B48DEB","#EFE3FF","#009488","#59BAA8","#FF7DDA","#FFCFEE"]}],eW={fontFamily:"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",fontSize:14,l1FontSize:32,l1LineHeight:"150%",l2FontSize:20,l2LineHeight:"140%",l3FontSize:16,l3LineHeight:"150%",l4FontSize:14,l4LineHeight:"150%",l5FontSize:12,l5LineHeight:"130%",l6FontSize:10,l6LineHeight:"120%"},eN={name:"light",background:{type:"palette",key:"backgroundColor"},padding:20,fontFamily:{type:"token",key:"fontFamily"},colorScheme:{default:{dataScheme:ez,palette:{backgroundColor:"#ffffff",borderColor:"#e3e5e8",shadowColor:"rgba(33,37,44,0.1)",hoverBackgroundColor:"#f1f2f5",sliderRailColor:"#f1f3f4",sliderHandleColor:"#ffffff",sliderTrackColor:"#0040ff",popupBackgroundColor:"#ffffff",primaryFontColor:"#21252c",secondaryFontColor:"#606773",tertiaryFontColor:"#89909d",axisLabelFontColor:"#89909d",disableFontColor:"#bcc1cb",axisMarkerFontColor:"#ffffff",axisGridColor:"#f1f2f5",axisDomainColor:"#d9dde4",dataZoomHandleStrokeColor:"#aeb5be",dataZoomChartColor:"#c9ced8",playerControllerColor:"#0040ff",scrollBarSliderColor:"rgba(0,0,0,0.3)",axisMarkerBackgroundColor:"#21252c",markLabelBackgroundColor:"#f1f2f5",markLineStrokeColor:"#606773",dangerColor:"#e33232",warningColor:"#ffc528",successColor:"#07a35a",infoColor:"#3073f2",discreteLegendPagerTextColor:"rgb(51, 51, 51)",discreteLegendPagerHandlerColor:"rgb(47, 69, 84)",discreteLegendPagerHandlerDisableColor:"rgb(170, 170, 170)",emptyCircleColor:"#e3e5e8",linearProgressTrackColor:"#E7EBED"}}},token:eW,component:{poptip:{visible:!0,position:"auto",padding:8,titleStyle:{fontSize:{type:"token",key:"l5FontSize"},fontWeight:"bold",fill:{type:"palette",key:"primaryFontColor"}},contentStyle:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"primaryFontColor"}},panel:{visible:!0,fill:{type:"palette",key:"popupBackgroundColor"},cornerRadius:3,lineWidth:0,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"},size:0,space:12}}},mark:{text:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1}}},markByName:{label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1,lineJoin:"bevel"}},area:{style:{fillOpacity:.2}},line:{style:{lineWidth:2,lineCap:"round",lineJoin:"round"}},point:{style:{size:8,stroke:{type:"palette",key:"backgroundColor"},lineWidth:1,fillOpacity:1}},word:{style:{fontWeight:null,fontSize:null}},fillingWord:{style:{fontWeight:null,fontSize:null}},barBackground:{visible:!1,style:{fill:{type:"palette",key:"primaryFontColor",a:.06},stroke:"transparent"}}},animationThreshold:2e3},ej={name:"dark",colorScheme:{default:{dataScheme:ez,palette:{backgroundColor:"#202226",borderColor:"#404349",shadowColor:"rgba(0,0,0,0.1)",hoverBackgroundColor:"#404349",sliderRailColor:"#404349",sliderHandleColor:"#202226",sliderTrackColor:"#4284FF",popupBackgroundColor:"#404349",primaryFontColor:"#fdfdfd",secondaryFontColor:"#bbbdc3",tertiaryFontColor:"#888c93",axisLabelFontColor:"#888c93",disableFontColor:"#55595f",axisMarkerFontColor:"#202226",axisGridColor:"#404349",axisDomainColor:"#4b4f54",dataZoomHandleStrokeColor:"#bbbdc3",dataZoomChartColor:"#55595F",playerControllerColor:"#4284FF",scrollBarSliderColor:"rgba(255,255,255,0.3)",axisMarkerBackgroundColor:"#fdfdfd",markLabelBackgroundColor:"#404349",markLineStrokeColor:"#bbbdc3",dangerColor:"#eb4b4b",warningColor:"#f0bd30",successColor:"#14b267",infoColor:"#4284ff",discreteLegendPagerTextColor:"#BBBDC3",discreteLegendPagerHandlerColor:"#BBBDC3",discreteLegendPagerHandlerDisableColor:"#55595F",emptyCircleColor:"#bbbdc3",linearProgressTrackColor:"#404349"}}},component:{dataZoom:{selectedBackground:{style:{fillOpacity:.4,outerBorder:{strokeOpacity:.4}}}}}},eG=function(t,e,i){return t<e?e:t>i?i:t};function eV(t,e,i){let r=(1-Math.abs(2*(i/=100)-1))*(e/=100),n=r*(1-Math.abs(t/60%2-1)),s=i-r/2,l=0,a=0,o=0;return 0<=t&&t<60?(l=r,a=n,o=0):60<=t&&t<120?(l=n,a=r,o=0):120<=t&&t<180?(l=0,a=r,o=n):180<=t&&t<240?(l=0,a=n,o=r):240<=t&&t<300?(l=n,a=0,o=r):300<=t&&t<360&&(l=r,a=0,o=n),{r:l=Math.round(255*(l+s)),g:a=Math.round(255*(a+s)),b:o=Math.round(255*(o+s))}}function eZ(t,e,i){t/=255;let r=Math.min(t,e/=255,i/=255),n=Math.max(t,e,i),s=n-r,l=0,a=0,o=0;return(l=Math.round(60*(l=0===s?0:n===t?(e-i)/s%6:n===e?(i-t)/s+2:(t-e)/s+4)))<0&&(l+=360),o=(n+r)/2,{h:l,s:a=+(100*(a=0===s?0:s/(1-Math.abs(2*o-1)))).toFixed(1),l:o=+(100*o).toFixed(1)}}let eU=/^#([0-9a-f]{3,8})$/,eK={transparent:0xffffff00},e$={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function eY(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function eX(t){return tG(t)?new e1(t>>16,t>>8&255,255&t,1):tq(t)?new e1(t[0],t[1],t[2]):new e1(255,255,255)}function eq(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function eJ(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let eQ=(t,e)=>{let i=eU.exec(t);if(e||i){let t=parseInt(i[1],16),e=i[1].length;return 3===e?new e1((t>>8&15)+((t>>8&15)<<4),(t>>4&15)+((t>>4&15)<<4),(15&t)+((15&t)<<4),1):6===e?eX(t):8===e?new e1(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):null}};class e0{static Brighter(t,e=1){return 1===e?t:new e0(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return 1===e?t:new e0(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){let i=t instanceof e0?t:new e0(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3();case"wcag":return i.getLuminanceWCAG()}}static parseColorString(t){if(t8(eK[t])){var e;return tG(e=eK[t])?new e1(e>>>24,e>>>16&255,e>>>8&255,255&e):tq(e)?new e1(e[0],e[1],e[2],e[3]):new e1(255,255,255,1)}if(t8(e$[t]))return eX(e$[t]);let i=`${t}`.trim().toLowerCase(),r=eQ(i);if(void 0!==r)return r;if(/^(rgb|RGB|rgba|RGBA)/.test(i)){let t=i.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new e1(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),parseFloat(t[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(i)){let t=i.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),e=eV(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));return new e1(e.r,e.g,e.b,parseFloat(t[3]))}}constructor(t){let e=e0.parseColorString(t);e?this.color=e:(console.warn(`Warn: 传入${t}无法解析为Color`),this.color=new e1(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){let{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){let r=this.color.opacity,n=eZ(this.color.r,this.color.g,this.color.b),s=eV(er(t)?n.h:eG(t,0,360),er(e)?n.s:e>=0&&e<=1?100*e:e,er(i)?n.l:i<=1&&i>=0?100*i:i);return this.color=new e1(s.r,s.g,s.b,r),this}setRGB(t,e,i){return er(t)||(this.color.r=t),er(e)||(this.color.g=e),er(i)||(this.color.b=i),this}setHex(t){let e=eQ(`${t}`.trim().toLowerCase(),!0);return null!=e?e:this}setColorName(t){let e=e$[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}getLuminanceWCAG(){let t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;return .2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))}clone(){return new e0(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){let i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=eq(t.color.r),this.color.g=eq(t.color.g),this.color.b=eq(t.color.b),this}copyLinearToSRGB(t){return this.color.r=eJ(t.color.r),this.color.g=eJ(t.color.g),this.color.b=eJ(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class e1{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),t8(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${eY(this.r)+eY(this.g)+eY(this.b)+(1===this.opacity?"":eY(255*this.opacity))}`}formatRgb(){let t=this.opacity;return`${1===t?"rgb(":"rgba("}${this.r},${this.g},${this.b}${1===t?")":`,${t})`}`}formatHsl(){let t=this.opacity,{h:e,s:i,l:r}=eZ(this.r,this.g,this.b);return`${1===t?"hsl(":"hsla("}${e},${i}%,${r}%${1===t?")":`,${t})`}`}toString(){return this.formatHex()}}function e2(t){var e,i;let{type:r}=t;return r===rR.sankey?null!=(e=t.direction)?e:"horizontal":null!=(i=t.direction)?i:"vertical"}(rb=rR||(rR={})).area="area",rb.line="line",rb.bar="bar",rb.rangeColumn="rangeColumn",rb.rangeArea="rangeArea",rb.dot="dot",rb.geo="geo",rb.link="link",rb.map="map",rb.pie="pie",rb.radar="radar",rb.rose="rose",rb.scatter="scatter",rb.circularProgress="circularProgress",rb.wordCloud="wordCloud",rb.funnel="funnel",rb.linearProgress="linearProgress",rb.boxPlot="boxPlot",rb.sankey="sankey",rb.gaugePointer="gaugePointer",rb.gauge="gauge",rb.treemap="treemap",rb.sunburst="sunburst",rb.circlePacking="circlePacking",rb.waterfall="waterfall",rb.heatmap="heatmap",rb.correlation="correlation",rb.liquid="liquid",rb.venn="venn",rb.mosaic="mosaic",rb.pictogram="pictogram",(r_=rB||(rB={})).label="label",r_.point="point",r_.line="line",r_.area="area",r_.bar="bar",r_.boxPlot="boxPlot",r_.outlier="outlier",r_.circlePacking="circlePacking",r_.group="group",r_.gridBackground="gridBackground",r_.grid="grid",r_.dot="dot",r_.title="title",r_.subTitle="subTitle",r_.symbol="symbol",r_.funnel="funnel",r_.transform="transform",r_.transformLabel="transformLabel",r_.outerLabel="outerLabel",r_.outerLabelLine="outerLabelLine",r_.pin="pin",r_.pinBackground="pinBackground",r_.pointer="pointer",r_.segment="segment",r_.track="track",r_.cell="cell",r_.cellBackground="cellBackground",r_.link="link",r_.arrow="arrow",r_.pie="pie",r_.labelLine="labelLine",r_.progress="progress",r_.minLabel="minLabel",r_.maxLabel="maxLabel",r_.rose="rose",r_.node="node",r_.sunburst="sunburst",r_.nonLeaf="nonLeaf",r_.leaf="leaf",r_.nonLeafLabel="nonLeafLabel",r_.leaderLine="leaderLine",r_.stackLabel="stackLabel",r_.word="word",r_.fillingWord="fillingWord",r_.wordMask="wordMask",r_.nodePoint="nodePoint",r_.ripplePoint="ripplePoint",r_.centerPoint="centerPoint",r_.centerLabel="centerLabel",r_.barBackground="barBackground",r_.lineLabel="lineLabel",r_.areaLabel="areaLabel",r_.liquidGroup="liquidGroup",r_.liquid="liquid",r_.liquidBackground="liquidBackground",r_.liquidOutline="liquidOutline",r_.circle="circle",r_.overlap="overlap",r_.overlapLabel="overlapLabel";let e3={primaryFontColor:"titleFontColor",tertiaryFontColor:"labelFontColor",axisLabelFontColor:"axisFontColor",axisMarkerFontColor:"labelReverseFontColor",dataZoomHandleStrokeColor:"dataZoomHandlerStrokeColor",sliderHandleColor:"dataZoomHandlerFillColor",sliderRailColor:"dataZoomBackgroundColor",sliderTrackColor:"dataZoomSelectedColor",playerControllerColor:"dataZoomSelectedColor",popupBackgroundColor:"tooltipBackgroundColor",hoverBackgroundColor:"axisGridColor"},e5={titleFontColor:"primaryFontColor",labelFontColor:"tertiaryFontColor",axisFontColor:"axisLabelFontColor",labelReverseFontColor:"axisMarkerFontColor",dataZoomHandlerStrokeColor:"dataZoomHandleStrokeColor",dataZoomHandlerFillColor:"sliderHandleColor",dataZoomBackgroundColor:"sliderRailColor",dataZoomSelectedColor:"sliderTrackColor",tooltipBackgroundColor:"popupBackgroundColor"};function e4(t,e){if(!t)return[];let i=ii(t,e);if(!i||tq(i))return null!=i?i:[];if(e_(i)){let{dataScheme:r}=i;return r?it(r)?r.map(i=>Object.assign(Object.assign({},i),{scheme:i.scheme.map(i=>e7(i)?e8(t,i,e):i).filter(t8)})):r.map(i=>e7(i)?e8(t,i,e):i).filter(t8):[]}return[]}function e6(t,e){var i,r;return it(t)?null!=(r=null==(i=t.find(t=>t8(t.isAvailable)?tQ(t.isAvailable)?t.isAvailable(e):!!t.isAvailable:!t8(t.maxDomainLength)||(null==e?void 0:e.length)<=t.maxDomainLength))?void 0:i.scheme)?r:t[t.length-1].scheme:t}function e8(t,e,i){var r;let n,s=ii(t,i);if(!s)return;let{palette:l}=s;if(e_(l)&&(n=null!=(r=function(t,e){let i=e3[e];if(i&&t[i])return t[i];if(t[e])return t[e];let r=e5[e];return r?t[r]:void 0}(l,e.key))?r:e.default),!n)return;if(er(e.a)&&er(e.l)||!t6(n))return n;let a=new e0(n);if(t8(e.l)){let{r:t,g:i,b:r}=a.color,{h:n,s:s}=eZ(t,i,r),l=eV(n,s,e.l),o=new e0(`rgb(${l.r}, ${l.g}, ${l.b})`);o.setOpacity(a.color.opacity),a=o}return t8(e.a)&&a.setOpacity(e.a),a.toRGBA()}let e9=(t,e)=>{if(e&&e7(t)){let i=e8(e,t);if(i)return i}return t};function e7(t){return t&&"palette"===t.type&&!!t.key}function it(t){return!(!tq(t)||0===t.length)&&t.every(t=>t8(t.scheme))}function ie(t){return tq(t)?{dataScheme:t}:t}function ii(t,e){var i,r;let n,{type:s}=null!=e?e:{};if(!e||er(s))n=null==t?void 0:t.default;else{let l=e2(e);n=null!=(r=null!=(i=null==t?void 0:t[`${s}_${l}`])?i:null==t?void 0:t[s])?r:null==t?void 0:t.default}return n}function ir(t,...e){let i=-1,r=e.length;for(;++i<r;)et(t,e[i],!0,!0);return t}var is={},il={};function ia(t){return Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function io(t){var e=Object.create(null),i=[];return t.forEach(function(t){for(var r in t)r in e||i.push(e[r]=r)}),i}function ih(t,e){var i=t+"",r=i.length;return r<e?Array(e-r+1).join(0)+i:i}function iu(t){var e=RegExp('["'+t+"\n\r]"),i=t.charCodeAt(0);function r(t,e){var r,n=[],s=t.length,l=0,a=0,o=s<=0,h=!1;function u(){if(o)return il;if(h)return h=!1,is;var e,r,n=l;if(34===t.charCodeAt(n)){for(;l++<s&&34!==t.charCodeAt(l)||34===t.charCodeAt(++l););return(e=l)>=s?o=!0:10===(r=t.charCodeAt(l++))?h=!0:13===r&&(h=!0,10===t.charCodeAt(l)&&++l),t.slice(n+1,e-1).replace(/""/g,'"')}for(;l<s;){if(10===(r=t.charCodeAt(e=l++)))h=!0;else if(13===r)h=!0,10===t.charCodeAt(l)&&++l;else if(r!==i)continue;return t.slice(n,e)}return o=!0,t.slice(n,s)}for(10===t.charCodeAt(s-1)&&--s,13===t.charCodeAt(s-1)&&--s;(r=u())!==il;){for(var d=[];r!==is&&r!==il;)d.push(r),r=u();e&&null==(d=e(d,a++))||n.push(d)}return n}function n(e,i){return e.map(function(e){return i.map(function(t){return l(e[t])}).join(t)})}function s(e){return e.map(l).join(t)}function l(t){var i,r,n,s,l,a;return null==t?"":t instanceof Date?(r=(i=t).getUTCHours(),n=i.getUTCMinutes(),s=i.getUTCSeconds(),l=i.getUTCMilliseconds(),isNaN(i)?"Invalid Date":((a=i.getUTCFullYear())<0?"-"+ih(-a,6):a>9999?"+"+ih(a,6):ih(a,4))+"-"+ih(i.getUTCMonth()+1,2)+"-"+ih(i.getUTCDate(),2)+(l?"T"+ih(r,2)+":"+ih(n,2)+":"+ih(s,2)+"."+ih(l,3)+"Z":s?"T"+ih(r,2)+":"+ih(n,2)+":"+ih(s,2)+"Z":n||r?"T"+ih(r,2)+":"+ih(n,2)+"Z":"")):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var i,n,s=r(t,function(t,r){var s;if(i)return i(t,r-1);n=t,i=e?(s=ia(t),function(i,r){return e(s(i),r,t)}):ia(t)});return s.columns=n||[],s},parseRows:r,format:function(e,i){return null==i&&(i=io(e)),[i.map(l).join(t)].concat(n(e,i)).join("\n")},formatBody:function(t,e){return null==e&&(e=io(t)),n(t,e).join("\n")},formatRows:function(t){return t.map(s).join("\n")},formatRow:s,formatValue:l}}var id=iu(","),ic=id.parse;id.parseRows,id.format,id.formatBody,id.formatRows,id.formatRow,id.formatValue;var ip=iu("	"),ig=ip.parse;ip.parseRows,ip.format,ip.formatBody,ip.formatRows,ip.formatRow,ip.formatValue,(rx=rP||(rP={})).DSV="dsv",rx.TREE="tree",rx.GEO="geo",rx.BYTE="bytejson",rx.HEX="hex",rx.GRAPH="graph",rx.TABLE="table",rx.GEO_GRATICULE="geo-graticule";let im=function(t,...e){return function(t,...e){t||(t={});let i=-1,r=e.length;for(;++i<r;){var n=t,s=e[i];if(e_(s)&&n!==s)for(let t in s)!function t(e,i,r){let n=i[r];if(void 0===n)e[r]=null;else if(e_(n))for(let i in e_(e[r])||(e[r]={}),n)t(e[r],n,i);else e[r]=n}(n,s,t)}return t}(t9(t),...e)},iy={delimiter:","};class iv{static registerChart(t,e){iv._charts[t]=e}static registerSeries(t,e){iv._series[t]=e}static registerComponent(t,e,i,r){iv._components[t]={cmp:e,alwaysCheck:i,createOrder:null!=r?r:0}}static registerGraphicComponent(t,e){iv._graphicComponents[t]=e}static createGraphicComponent(t,e,i){let r=iv._graphicComponents[t];return r?r(e,i):null}static registerMark(t,e){iv._marks[t]=e}static registerRegion(t,e){iv._regions[t]=e}static registerTransform(t,e){iv.transforms[t]=e}static registerGrammarTransform(t,e){iv._grammarTransforms[t]=e}static getGrammarTransform(t){return iv._grammarTransforms[t]}static registerLayout(t,e){iv._layout[t]=e}static registerAnimation(t,e){iv._animations[t]=e}static registerImplement(t,e){iv._implements[t]=e}static registerChartPlugin(t,e){iv._chartPlugin[t]=e}static registerVChartPlugin(t,e){iv._vChartPlugin[t]=e}static registerComponentPlugin(t,e){iv._componentPlugin[t]=e}static createChart(t,e,i){return iv._charts[t]?new(0,iv._charts[t])(e,i):null}static getChart(t){return iv._charts[t]}static createChartSpecTransformer(t,e){if(!iv._charts[t])return null;let i=iv._charts[t];return new(0,i.transformerConstructor)(Object.assign({seriesType:i.seriesType},e))}static createRegion(t,e,i){return iv._regions[t]?new(0,iv._regions[t])(e,i):null}static createRegionSpecTransformer(t,e){return iv._regions[t]?new(0,iv._regions[t].transformerConstructor)(e):null}static createSeries(t,e,i){return iv._series[t]?new(0,iv._series[t])(e,i):null}static createSeriesSpecTransformer(t,e){return iv._series[t]?new(0,iv._series[t].transformerConstructor)(e):null}static createMark(t,e,i){if(!iv._marks[t])return null;let r=new(0,iv._marks[t])(e,i);return"group"===r.type&&r.setMarkConfig({interactive:!1}),r}static getComponents(){return Object.values(iv._components)}static getComponentInKey(t){return iv._components[t].cmp}static getLayout(){return Object.values(iv._layout)}static getLayoutInKey(t){return iv._layout[t]}static getSeries(){return Object.values(iv._series)}static getSeriesInType(t){return iv._series[t]}static getRegionInType(t){return iv._regions[t]}static getAnimationInKey(t){return iv._animations[t]}static getImplementInKey(t){return iv._implements[t]}static getSeriesMarkMap(t){return iv._series[t]?iv._series[t].mark:{}}static getSeriesBuiltInTheme(t){for(let e in iv._series){let i=iv._series[e];if(i&&i.builtInTheme&&i.builtInTheme[t])return i.builtInTheme[t]}return null}static getComponentBuiltInTheme(t){for(let e in iv._components){let i=iv._components[e];if(i&&i.cmp&&i.cmp.builtInTheme&&i.cmp.builtInTheme[t])return i.cmp.builtInTheme[t]}return null}static getChartPlugins(){return Object.values(iv._chartPlugin)}static getVChartPlugins(){return Object.values(iv._vChartPlugin)}static getComponentPlugins(){return Object.values(iv._componentPlugin)}static getComponentPluginInType(t){return iv._componentPlugin[t]}static registerFormatter(t){this._formatter=t}static getFormatter(){return this._formatter}static createInteractionTrigger(t,e){let i=iv._interactionTriggers[t];return i?new i(e):null}static hasInteractionTrigger(t){return!!iv._interactionTriggers[t]}static getComposedEvent(t){return iv._composedEventMap[t]}}function ib(t,...e){return ir(i_(t),...e.map(i_))}function i_(t){var e,i;if(!t)return t;let r=((i=t.colorScheme)&&(i=Object.keys(i).reduce((t,e)=>{let r=i[e];return t[e]=ie(r),t},{})),i);return Object.assign({},t,{colorScheme:r,token:null!=(e=t.token)?e:{},series:Object.assign({},t.series)})}iv._charts={},iv._series={},iv._components={},iv._graphicComponents={},iv._marks={},iv._regions={},iv._animations={},iv._implements={},iv._chartPlugin={},iv._vChartPlugin={},iv._componentPlugin={},iv.transforms={fields:es,filter:(t,e)=>{let{callback:i}=e;return i&&(t=t.filter(i)),t},fold:(t,e)=>{let{fields:i,key:r,value:n,retains:s}=e,l=[];for(let e=0;e<t.length;e++)i.forEach(a=>{let o={};if(o[r]=a,o[n]=t[e][a],s)s.forEach(i=>{o[i]=t[e][i]});else for(let r in t[e])-1===i.indexOf(r)&&(o[r]=t[e][r]);l.push(o)});return l}},iv.dataParser={csv:(t,e={},i)=>(i.type=rP.DSV,ic(t)),dsv:(t,e={},i)=>{i.type=rP.DSV;let{delimiter:r}=im(iy,e);if(!t6(r))throw TypeError("Invalid delimiter: must be a string!");return iu(r).parse(t)},tsv:(t,e={},i)=>(i.type=rP.DSV,ig(t))},iv._layout={},iv._grammarTransforms={},iv._stageEventPlugins={},iv.registerStageEventPlugin=(t,e)=>{iv._stageEventPlugins[t]=e},iv.getStageEventPlugin=t=>iv._stageEventPlugins[t],iv._interactionTriggers={},iv.registerInteractionTrigger=(t,e)=>{iv._interactionTriggers[t]=e},iv._composedEventMap={},iv.registerComposedEvent=(t,e)=>{iv._composedEventMap[t]=e},iv._tooltipProcessors={},iv.registerTooltipProcessor=(t,e)=>{iv._tooltipProcessors[t]=e},iv.createTooltipProcessor=(t,e)=>{let i=iv._tooltipProcessors[t];return i?new i(e):null};let ix=t=>{let e={label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"}},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle"}}};return e[t?"transform3d":"transform"]={style:{fill:{type:"palette",key:"axisGridColor"}}},e},iC=ix(),iw={[eN.name]:eN},iS=eN.name,iA=new Map(Object.keys(iw).map(t=>[t,iw[t]])),iM=new Map,ik=new Map(Object.keys(iw).map(t=>[t,t===iS])),iT=(t,e)=>{if(!t)return;let i=iE(e);iA.set(t,i),ik.set(t,!0)},iR=(t=iS)=>(ik.has(t)&&!ik.get(t)&&iT(t,iA.get(t)),iA.get(t)),iB=t=>iA.delete(t)&&iM.delete(t)&&ik.delete(t),iP=t=>!!t6(t)&&iA.has(t),iE=t=>{var e;return ib({},iR(null!=(e=t.type)?e:iS),t)};class iI{static registerInstance(t){iI.instances.set(t.id,t)}static unregisterInstance(t){iI.instances.delete(t.id)}static getInstance(t){return iI.instances.get(t)}static instanceExist(t){return iI.instances.has(t)}static forEach(t,e=[],i){let r=ed(e);return iI.instances.forEach((e,i,n)=>{r.includes(i)||t(e,i,n)},i)}}iI.instances=new Map;class iL{static registerTheme(t,e){iT(t,e)}static getTheme(t,e=!1){return iR(t)}static removeTheme(t){return iB(t)}static themeExist(t){return iP(t)}static getDefaultTheme(){return iL.themes.get(iS)}static setCurrentTheme(t){iL.themeExist(t)&&(iL._currentThemeName=t,iI.forEach(e=>null==e?void 0:e.setCurrentTheme(t)))}static getCurrentTheme(t=!1){return iL.getTheme(iL._currentThemeName,t)}static getCurrentThemeName(){return iL._currentThemeName}}function iF(t){return t6(t)?iL.themeExist(t)?iL.getTheme(t):{}:e_(t)?t:{}}iL.themes=iA,iL._currentThemeName=iS;class iO{getComposedEventMap(){return this._composedEventMap}constructor(t,e){this._composedEventMap=new Map,this._eventDispatcher=t,this._mode=e}on(t,e,i){let r="function"==typeof e?{query:null,callback:e}:{query:e,callback:i},n=iv.getComposedEvent(t);if(n){let e=new n(this._eventDispatcher,this._mode);e.register(t,r),this._composedEventMap.set(i,{eventType:t,event:e})}else this._eventDispatcher.register(t,r);return this}off(t,e,i){var r,n;let s=null!=i?i:e;if(iv.getComposedEvent(t))if(s)null==(r=this._composedEventMap.get(s))||r.event.unregister(),this._composedEventMap.delete(s);else for(let e of this._composedEventMap.entries())e[1].eventType===t&&(null==(n=this._composedEventMap.get(e[0]))||n.event.unregister(),this._composedEventMap.delete(e[0]));else if(s){let i={callback:s,query:null,filter:{nodeName:null,type:t,level:null,source:e.source,markName:null,filter:null,userId:null}};this._eventDispatcher.unregister(t,i)}else this._eventDispatcher.unregister(t);return this}emit(t,e,i){return this._eventDispatcher.dispatch(t,e,i),this}prevent(t,e){return this._eventDispatcher.prevent(t,e),this}allow(t){return this._eventDispatcher.allow(t),this}release(){this._eventDispatcher.clear(),this._composedEventMap.clear()}}(rC=rE||(rE={})).BEFORE_EVALUATE_DATA="beforeEvaluateData",rC.AFTER_EVALUATE_DATA="afterEvaluateData",rC.BEFORE_EVALUATE_SCALE="beforeEvaluateScale",rC.AFTER_EVALUATE_SCALE="afterEvaluateScale",rC.BEFORE_PARSE_VIEW="beforeParseView",rC.AFTER_PARSE_VIEW="afterParseView",rC.BEFORE_TRANSFORM="beforeTransform",rC.AFTER_TRANSFORM="afterTransform",rC.BEFORE_CREATE_VRENDER_STAGE="beforeCreateVRenderStage",rC.AFTER_CREATE_VRENDER_STAGE="afterCreateVRenderStage",rC.BEFORE_CREATE_VRENDER_LAYER="beforeCreateVRenderLayer",rC.AFTER_CREATE_VRENDER_LAYER="afterCreateVRenderLayer",rC.BEFORE_STAGE_RESIZE="beforeStageResize",rC.AFTER_STAGE_RESIZE="afterStageResize",rC.BEFORE_VRENDER_DRAW="beforeVRenderDraw",rC.AFTER_VRENDER_DRAW="afterVRenderDraw",rC.BEFORE_MARK_JOIN="beforeMarkJoin",rC.AFTER_MARK_JOIN="afterMarkJoin",rC.BEFORE_MARK_UPDATE="beforeMarkUpdate",rC.AFTER_MARK_UPDATE="afterMarkUpdate",rC.BEFORE_MARK_STATE="beforeMarkState",rC.AFTER_MARK_STATE="afterMarkState",rC.BEFORE_MARK_ENCODE="beforeMarkEncode",rC.AFTER_MARK_ENCODE="afterMarkEncode",rC.BEFORE_DO_LAYOUT="beforeDoLayout",rC.AFTER_DO_LAYOUT="afterDoLayout",rC.BEFORE_MARK_LAYOUT_END="beforeMarkLayoutEnd",rC.AFTER_MARK_LAYOUT_END="afterMarkLayoutEnd",rC.BEFORE_DO_RENDER="beforeDoRender",rC.AFTER_DO_RENDER="afterDoRender",rC.BEFORE_MARK_RENDER_END="beforeMarkRenderEnd",rC.AFTER_MARK_RENDER_END="afterMarkRenderEnd",rC.BEFORE_CREATE_VRENDER_MARK="beforeCreateVRenderMark",rC.AFTER_CREATE_VRENDER_MARK="afterCreateVRenderMark",rC.BEFORE_ADD_VRENDER_MARK="beforeAddVRenderMark",rC.AFTER_ADD_VRENDER_MARK="afterAddVRenderMark",rC.AFTER_VRENDER_NEXT_RENDER="afterVRenderNextRender",rC.BEFORE_ELEMENT_UPDATE_DATA="beforeElementUpdateData",rC.AFTER_ELEMENT_UPDATE_DATA="afterElementUpdateData",rC.BEFORE_ELEMENT_STATE="beforeElementState",rC.AFTER_ELEMENT_STATE="afterElementState",rC.BEFORE_ELEMENT_ENCODE="beforeElementEncode",rC.AFTER_ELEMENT_ENCODE="afterElementEncode",rC.ANIMATION_START="animationStart",rC.ANIMATION_END="animationEnd",rC.ELEMENT_ANIMATION_START="elementAnimationStart",rC.ELEMENT_ANIMATION_END="elementAnimationEnd",rC.ALL_ANIMATION_START="allAnimationStart",rC.ALL_ANIMATION_END="allAnimationEnd";let iD=["pointerdown","pointerup","pointerupoutside","pointertap","pointerover","pointermove","pointerenter","pointerleave","pointerout","mousedown","mouseup","mouseupoutside","rightdown","rightup","rightupoutside","click","dblclick","mousemove","mouseover","mouseout","mouseenter","mouseleave","wheel","touchstart","touchend","touchendoutside","touchmove","touchcancel","tap","dragstart","drag","dragenter","dragleave","dragover","dragend","drop","pan","panstart","panend","press","pressup","pressend","pinch","pinchstart","pinchend","swipe"];(rw=rI||(rI={})).initialized="initialized",rw.rendered="rendered",rw.renderFinished="renderFinished",rw.animationFinished="animationFinished",rw.regionSeriesDataFilterOver="regionSeriesDataFilterOver",rw.afterInitData="afterInitData",rw.afterInitEvent="afterInitEvent",rw.afterInitMark="afterInitMark",rw.rawDataUpdate="rawDataUpdate",rw.viewDataFilterOver="viewDataFilterOver",rw.viewDataUpdate="viewDataUpdate",rw.viewDataStatisticsUpdate="viewDataStatisticsUpdate",rw.markDeltaYUpdate="markDeltaYUpdate",rw.viewDataLabelUpdate="viewDataLabelUpdate",rw.scaleDomainUpdate="scaleDomainUpdate",rw.scaleUpdate="scaleUpdate",rw.dataZoomChange="dataZoomChange",rw.drill="drill",rw.layoutStart="layoutStart",rw.layoutEnd="layoutEnd",rw.layoutRectUpdate="layoutRectUpdate",rw.playerPlay="playerPlay",rw.playerPause="playerPause",rw.playerEnd="playerEnd",rw.playerChange="playerChange",rw.playerForward="playerForward",rw.playerBackward="playerBackward",rw.scrollBarChange="scrollBarChange",rw.brushStart="brushStart",rw.brushChange="brushChange",rw.brushEnd="brushEnd",rw.brushClear="brushClear",rw.brushActive="brushActive",rw.legendSelectedDataChange="legendSelectedDataChange",rw.legendFilter="legendFilter",rw.legendItemClick="legendItemClick",rw.legendItemHover="legendItemHover",rw.legendItemUnHover="legendItemUnHover",rw.tooltipShow="tooltipShow",rw.tooltipHide="tooltipHide",rw.tooltipRelease="tooltipRelease",rw.afterResize="afterResize",rw.afterRender="afterRender",rw.afterLayout="afterLayout",rw.afterMarkLayoutEnd="afterMarkLayoutEnd",rw.afterWordcloudShapeDraw="afterWordcloudShapeDraw",(rS=rL||(rL={})).chart="chart",rS.window="window",rS.canvas="canvas",(rA=rF||(rF={})).vchart="vchart",rA.chart="chart",rA.model="model",rA.mark="mark";let iH=[rF.mark,rF.model,rF.chart,rF.vchart];class iz{constructor(){this._map=new Map,this._levelNodes=new Map,this._levelNodes.set(rF.vchart,[]),this._levelNodes.set(rF.chart,[]),this._levelNodes.set(rF.model,[]),this._levelNodes.set(rF.mark,[])}addHandler(t,e){var i;let r={level:e,handler:t};return null==(i=this._levelNodes.get(e))||i.push(r),this._map.set(t.callback,r),this}removeHandler(t){let e=this._map.get(t.callback);if(!e)return this;this._map.delete(t.callback);let i=this._levelNodes.get(e.level),r=null==i?void 0:i.findIndex(e=>e.handler.callback===t.callback);return void 0!==r&&r>=0&&(null==i||i.splice(r,1)),this}preventHandler(t){return t&&(t.prevented=!0),this}allowHandler(t){return t&&(t.prevented=!1),this}getHandlers(t){var e;return(null==(e=this._levelNodes.get(t))?void 0:e.map(t=>t.handler))||[]}getAllHandlers(){return Array.from(this._map.values()).map(t=>t.handler)||[]}getCount(){return this._map.size}release(){this._map.clear(),this._levelNodes.clear()}}let iW=(t,e,i)=>{let r=t6(e)?e.split("."):e;for(let e=0;e<r.length;e++)t=t?t[r[e]]:void 0;return void 0===t?i:t},iN=!1;try{iN="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame}catch(t){iN=!1}iN=!1;let ij=function(t,e,i){let r,n,s,l,a,o,h=0,u=!1,d=!1,c=!0,p=!e&&0!==e&&iN;if("function"!=typeof t)throw TypeError("Expected a function");function g(e){let i=r,s=n;return r=n=void 0,h=e,l=t.apply(s,i)}function f(t,e){return p?(cancelAnimationFrame(a),requestAnimationFrame(t)):setTimeout(t,e)}function m(t){let i=t-o;return void 0===o||i>=e||i<0||d&&t-h>=s}function y(){let t=Date.now();if(m(t))return v(t);a=f(y,function(t){let i=t-h,r=e-(t-o);return d?Math.min(r,s-i):r}(t))}function v(t){return a=void 0,c&&r?g(t):(r=n=void 0,l)}function b(...t){let i=Date.now(),s=m(i);if(r=t,n=this,o=i,s){if(void 0===a){var c;return h=c=o,a=f(y,e),u?g(c):l}if(d)return a=f(y,e),g(o)}return void 0===a&&(a=f(y,e)),l}return e=+e||0,e_(i)&&(u=!!i.leading,(d="maxWait"in i)&&(s=Math.max(en(i.maxWait)?i.maxWait:0,e)),c="trailing"in i?!!i.trailing:c),b.cancel=function(){void 0!==a&&function(t){if(p)return cancelAnimationFrame(t);clearTimeout(t)}(a),h=0,r=o=n=a=void 0},b.flush=function(){return void 0===a?l:v(Date.now())},b.pending=function(){return void 0!==a},b},iG=function(t,e,i){let r=!0,n=!0;if("function"!=typeof t)throw TypeError("Expected a function");return e_(i)&&(r="leading"in i?!!i.leading:r,n="trailing"in i?!!i.trailing:n),ij(t,e,{leading:r,trailing:n,maxWait:e})},iV=t=>"line"===t||"area"===t,iZ=t=>{if(!t||!t.context)return null;let{data:e,markType:i}=t.context;return"line"===i||"area"===i?e:null==e?void 0:e[0]},iU=(t,e)=>{let i=e;for(;(null==i?void 0:i.parent)&&i.parent!==t;)if((i=i.parent).context)return i;return null},iK=(t,e)=>{let i=t.getAttributes(!0),r={};return Object.keys(e).forEach(t=>{i[t]!==e[t]&&(r[t]=e[t])}),r},i$={cartesianAxis:"axis","cartesianAxis-band":"axis","cartesianAxis-linear":"axis","cartesianAxis-time":"axis",polarAxis:"axis","polarAxis-band":"axis","polarAxis-linear":"axis",discreteLegend:"legend",continuousLegend:"legend",colorLegend:"legend",sizeLegend:"legend"};class iY{constructor(t,e){this._viewBubbles=new Map,this._windowBubbles=new Map,this._canvasBubbles=new Map,this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this._onDelegate=t=>{var e;let i=this.globalInstance.getChart(),r=t8(t.modelId)&&(null==i?void 0:i.getModelById(t.modelId))||void 0,n=t8(t.markId)&&(null==i?void 0:i.getMarkById(t.markId))||null,s=iW(t.event,"target"),l=t.datum;r&&"component"===r.modelType&&(l=null!=(e=r.getDatum(s))?e:l);let a={event:t.event,item:t.item,source:t.source,datum:l,chart:i,model:r,mark:null!=n?n:void 0,node:s};this.dispatch(t.type,a)},this._onDelegateInteractionEvent=t=>{let e=this.globalInstance.getChart(),i=t.event,r=null;i.graphics&&(r=i.graphics);let n={event:t.event,chart:e,graphics:r,datums:r&&r.map(t=>iZ(t))};this.dispatch(t.type,n)},this.globalInstance=t,this._compiler=e}register(t,e){var i,r,n,s,l;this._parseQuery(e);let a=this.getEventBubble((null==(i=e.filter)?void 0:i.source)||rL.chart),o=this.getEventListeners((null==(r=e.filter)?void 0:r.source)||rL.chart);if(a.get(t)||a.set(t,new iz),a.get(t).addHandler(e,null==(n=e.filter)?void 0:n.level),this._isValidEvent(t)&&!o.has(t)){let i=this._onDelegate.bind(this);this._compiler.addEventListener(null==(s=e.filter)?void 0:s.source,t,i),o.set(t,i)}else if(this._isInteractionEvent(t)&&!o.has(t)){let i=this._onDelegateInteractionEvent.bind(this);this._compiler.addEventListener(null==(l=e.filter)?void 0:l.source,t,i),o.set(t,i)}return this}unregister(t,e){var i,r,n,s;let l=!1,a=this.getEventBubble((null==(i=null==e?void 0:e.filter)?void 0:i.source)||rL.chart),o=this.getEventListeners((null==(r=null==e?void 0:e.filter)?void 0:r.source)||rL.chart);if(e){let i=a.get(t);null==i||i.removeHandler(e),0===(null==i?void 0:i.getCount())&&(null==i||i.release(),a.delete(t),l=!0),(null==(n=null==e?void 0:e.wrappedCallback)?void 0:n.cancel)&&e.wrappedCallback.cancel()}else{let e=a.get(t);null==e||e.release(),a.delete(t),l=!0}if(l&&this._isValidEvent(t)){let i=o.get(t);this._compiler.removeEventListener((null==(s=null==e?void 0:e.filter)?void 0:s.source)||rL.chart,t,i),o.delete(t)}return this}dispatch(t,e,i){let r=this.getEventBubble(e.source||rL.chart).get(t);if(!r)return this;let n=!1;if(i){let s=r.getHandlers(i);n=this._invoke(s,t,e)}else{let i=0;for(;!n&&i<iH.length;)n=this._invoke(r.getHandlers(iH[i]),t,e),i++}return this}prevent(t,e){return["canvas","chart","window"].forEach(i=>{let r=this.getEventBubble(i).get(t);r&&r.getAllHandlers().forEach(t=>{e?iH.indexOf(t.filter.level)<iH.indexOf(e.level)&&t.callback!==e.handler&&r.preventHandler(t):r.preventHandler(t)})}),this}allow(t){return["canvas","chart","window"].forEach(e=>{let i=this.getEventBubble(e).get(t);i&&i.getAllHandlers().forEach(t=>i.allowHandler(t))}),this}clear(){[rL.chart,rL.window,rL.canvas].forEach(t=>{let e=this.getEventListeners(t);for(let i of e.entries())this._compiler.removeEventListener(t,i[0],i[1]);e.clear()}),[this._viewBubbles,this._windowBubbles,this._canvasBubbles].forEach(t=>{for(let e of t.values())e.release();t.clear()})}release(){this.clear(),this.globalInstance=null,this._compiler=null}_filter(t,e,i){var r,n,s;if(tQ(t.filter)&&!t.filter(i)||t.nodeName&&iW(i,"node.name")!==t.nodeName||t.markName&&(null==(r=null==i?void 0:i.mark)?void 0:r.name)!==t.markName)return!1;let l=null==(n=i.model)?void 0:n.type;return i$[l]&&(l=i$[l]),(!t.type||l===t.type)&&!("mark"===t.level&&!t.type&&!(null==i?void 0:i.mark))&&!("model"===t.level&&!t.type&&!(null==i?void 0:i.model))&&(!t8(t.userId)||(null==(s=i.model)?void 0:s.userId)===t.userId)}_invoke(t,e,i){return t.map(t=>{var r,n,s;let l=t.filter;if(!t.prevented&&(!t.query||this._filter(l,e,i))){let e=(t.wrappedCallback||t.callback).call(null,Object.assign({},i)),l=null!=e?e:null==(r=t.query)?void 0:r.consume;return l&&(null==(n=i.event)||n.stopPropagation(),null==(s=i.event)||s.preventDefault()),!!l}}).some(t=>!0===t)}_getQueryLevel(t){return t?t.level?t.level:t8(t.id)?rF.model:rF.vchart:rF.vchart}_parseQuery(t){var e;let i=t.query;(null==i?void 0:i.throttle)?t.wrappedCallback=iG(t.callback,i.throttle):(null==i?void 0:i.debounce)&&(t.wrappedCallback=ij(t.callback,i.debounce));let r=this._getQueryLevel(i),n=null,s=rL.chart,l=null,a=null,o=null;return(null==i?void 0:i.nodeName)&&(l=i.nodeName),(null==i?void 0:i.markName)&&(a=i.markName),(null==i?void 0:i.type)&&(r===rF.model||r===rF.mark)&&(n=i.type),(null==i?void 0:i.source)&&(s=i.source),t8(null==i?void 0:i.id)&&(o=null==i?void 0:i.id,r=rF.model),t.filter={level:r,markName:a,type:n,source:s,nodeName:l,userId:o,filter:null!=(e=null==i?void 0:i.filter)?e:null},t}getEventBubble(t){switch(t){case rL.chart:return this._viewBubbles;case rL.window:return this._windowBubbles;case rL.canvas:return this._canvasBubbles;default:return this._viewBubbles}}getEventListeners(t){switch(t){case rL.chart:return this._viewListeners;case rL.window:return this._windowListeners;case rL.canvas:return this._canvasListeners;default:return this._viewListeners}}_isValidEvent(t){return iD.includes(t)||Object.values(rE).includes(t)}_isInteractionEvent(t){let e;return t&&(e=t.split(":")[0])&&iv.hasInteractionTrigger(e)}}function iX(t){return t}function iq(t,e){t&&iQ.hasOwnProperty(t.type)&&iQ[t.type](t,e)}var iJ={Feature:function(t,e){iq(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,r=-1,n=i.length;++r<n;)iq(i[r].geometry,e)}},iQ={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,r=-1,n=i.length;++r<n;)t=i[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){i0(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,r=-1,n=i.length;++r<n;)i0(i[r],e,0)},Polygon:function(t,e){i1(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,r=-1,n=i.length;++r<n;)i1(i[r],e)},GeometryCollection:function(t,e){for(var i=t.geometries,r=-1,n=i.length;++r<n;)iq(i[r],e)}};function i0(t,e,i){var r,n=-1,s=t.length-i;for(e.lineStart();++n<s;)r=t[n],e.point(r[0],r[1],r[2]);e.lineEnd()}function i1(t,e){var i=-1,r=t.length;for(e.polygonStart();++i<r;)i0(t[i],e,1);e.polygonEnd()}function i2(t,e){t&&iJ.hasOwnProperty(t.type)?iJ[t.type](t,e):iq(t,e)}function i3(){this.reset()}i3.prototype={constructor:i3,reset:function(){this.s=this.t=0},add:function(t){i4(i5,t,this.t),i4(this,i5.s,this.s),this.s?this.t+=i5.t:this.s=i5.t},valueOf:function(){return this.s}};var i5=new i3;function i4(t,e,i){var r=t.s=e+i,n=r-e;t.t=e-(r-n)+(i-n)}var i6=Math.PI,i8=i6/2,i9=i6/4,i7=2*i6,rt=180/i6,re=i6/180,ri=Math.abs,rr=Math.atan,rn=Math.atan2,rs=Math.cos,rl=Math.exp,ra=Math.log,ro=Math.pow,rh=Math.sin,ru=Math.sign||function(t){return t>0?1:t<0?-1:0},rd=Math.sqrt,rc=Math.tan;function rp(t){return t>1?0:t<-1?i6:Math.acos(t)}function rg(t){return t>1?i8:t<-1?-i8:Math.asin(t)}function rf(){}var rm,ry,rv,rb,r_,rx,rC,rw,rS,rA,rM,rk,rT,rR,rB,rP,rE,rI,rL,rF,rO,rD,rH,rz,rW=new i3,rN=new i3,rj={point:rf,lineStart:rf,lineEnd:rf,polygonStart:function(){rj.lineStart=rG,rj.lineEnd=rU},polygonEnd:function(){rj.lineStart=rj.lineEnd=rj.point=rf,rW.add(ri(rN)),rN.reset()},result:function(){var t=rW/2;return rW.reset(),t}};function rG(){rj.point=rV}function rV(t,e){rj.point=rZ,rO=rH=t,rD=rz=e}function rZ(t,e){rN.add(rz*t-rH*e),rH=t,rz=e}function rU(){rZ(rO,rD)}var rK=1/0,r$=1/0,rY=-1/0,rX=rY;let rq={point:function(t,e){t<rK&&(rK=t),t>rY&&(rY=t),e<r$&&(r$=e),e>rX&&(rX=e)},lineStart:rf,lineEnd:rf,polygonStart:rf,polygonEnd:rf,result:function(){var t=[[rK,r$],[rY,rX]];return rY=rX=-(r$=rK=1/0),t}};var rJ,rQ,r0,r1,r2=0,r3=0,r5=0,r4=0,r6=0,r8=0,r9=0,r7=0,nt=0,ne={point:ni,lineStart:nr,lineEnd:nl,polygonStart:function(){ne.lineStart=na,ne.lineEnd=no},polygonEnd:function(){ne.point=ni,ne.lineStart=nr,ne.lineEnd=nl},result:function(){var t=nt?[r9/nt,r7/nt]:r8?[r4/r8,r6/r8]:r5?[r2/r5,r3/r5]:[NaN,NaN];return r2=r3=r5=r4=r6=r8=r9=r7=nt=0,t}};function ni(t,e){r2+=t,r3+=e,++r5}function nr(){ne.point=nn}function nn(t,e){ne.point=ns,ni(r0=t,r1=e)}function ns(t,e){var i=t-r0,r=e-r1,n=rd(i*i+r*r);r4+=n*(r0+t)/2,r6+=n*(r1+e)/2,r8+=n,ni(r0=t,r1=e)}function nl(){ne.point=ni}function na(){ne.point=nh}function no(){nu(rJ,rQ)}function nh(t,e){ne.point=nu,ni(rJ=r0=t,rQ=r1=e)}function nu(t,e){var i=t-r0,r=e-r1,n=rd(i*i+r*r);r4+=n*(r0+t)/2,r6+=n*(r1+e)/2,r8+=n,r9+=(n=r1*t-r0*e)*(r0+t),r7+=n*(r1+e),nt+=3*n,ni(r0=t,r1=e)}function nd(t){this._context=t}nd.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,i7)}},result:rf};var nc,np,ng,nf,nm,ny=new i3,nv={point:rf,lineStart:function(){nv.point=nb},lineEnd:function(){nc&&n_(np,ng),nv.point=rf},polygonStart:function(){nc=!0},polygonEnd:function(){nc=null},result:function(){var t=+ny;return ny.reset(),t}};function nb(t,e){nv.point=n_,np=nf=t,ng=nm=e}function n_(t,e){nf-=t,nm-=e,ny.add(rd(nf*nf+nm*nm)),nf=t,nm=e}function nx(){this._string=[]}function nC(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function nw(t,e){var i,r,n=4.5;function s(t){return t&&("function"==typeof n&&r.pointRadius(+n.apply(this,arguments)),i2(t,i(r))),r.result()}return s.area=function(t){return i2(t,i(rj)),rj.result()},s.measure=function(t){return i2(t,i(nv)),nv.result()},s.bounds=function(t){return i2(t,i(rq)),rq.result()},s.centroid=function(t){return i2(t,i(ne)),ne.result()},s.projection=function(e){return arguments.length?(i=null==e?(t=null,iX):(t=e).stream,s):t},s.context=function(t){return arguments.length?(r=null==t?(e=null,new nx):new nd(e=t),"function"!=typeof n&&r.pointRadius(n),s):e},s.pointRadius=function(t){return arguments.length?(n="function"==typeof t?t:(r.pointRadius(+t),+t),s):n},s.projection(t).context(e)}function nS(t){var e={type:"Feature"};return Object.keys(t).forEach(function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=t[i]}}),e.properties=function t(e){var i={};return e&&Object.keys(e).forEach(function(r){var n=e[r];"object"==typeof n?null===n?i[r]=null:Array.isArray(n)?i[r]=n.map(function(t){return t}):i[r]=t(n):i[r]=n}),i}(t.properties),e.geometry=nA(t.geometry),e}function nA(t){var e={type:t.type};return(t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type)?e.geometries=t.geometries.map(function(t){return nA(t)}):e.coordinates=function t(e){return"object"!=typeof e[0]?e.slice():e.map(function(e){return t(e)})}(t.coordinates),e}nx.prototype={_radius:4.5,_circle:nC(4.5),pointRadius:function(t){return(t*=1)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=nC(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(!this._string.length)return null;var t=this._string.join("");return this._string=[],t}};let nM=function(t){if(!t)throw Error("geojson is required");switch(t.type){case"Feature":return nS(t);case"FeatureCollection":var e,i;return i={type:"FeatureCollection"},Object.keys(e=t).forEach(function(t){switch(t){case"type":case"features":return;default:i[t]=e[t]}}),i.features=e.features.map(function(t){return nS(t)}),i;case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return nA(t);default:throw Error("unknown GeoJSON type")}};function nk(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function nT(t){for(var e,i,r=nk(t),n=0,s=1;s<r.length;)e=i||r[0],n+=((i=r[s])[0]-e[0])*(i[1]+e[1]),s++;return n>0}function nR(t,e,i){void 0===i&&(i={});var r={type:"Feature"};return(0===i.id||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties=e||{},r.geometry=t,r}function nB(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function nP(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function nE(t,e){var i,r,n,s,l,a,o,h,u,d,c=0,p="FeatureCollection"===t.type,g="Feature"===t.type,f=p?t.features.length:1;for(i=0;i<f;i++){for(n=0,a=p?t.features[i].geometry:g?t.geometry:t,h=p?t.features[i].properties:g?t.properties:{},u=p?t.features[i].bbox:g?t.bbox:void 0,d=p?t.features[i].id:g?t.id:void 0,l=(o=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1;n<l;n++){if(null===(s=o?a.geometries[n]:a)){if(!1===e(null,c,h,u,d))return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(s,c,h,u,d))return!1;break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===e(s.geometries[r],c,h,u,d))return!1;break;default:throw Error("Unknown Geometry Type")}}c++}}function nI(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return nE(t,function(t){nI(t,e)}),t;case"LineString":return nL(nk(t),e),t;case"Polygon":return nF(nk(t),e),t;case"MultiLineString":return nk(t).forEach(function(t){nL(t,e)}),t;case"MultiPolygon":return nk(t).forEach(function(t){nF(t,e)}),t;case"Point":case"MultiPoint":return t}}function nL(t,e){nT(t)===e&&t.reverse()}function nF(t,e){nT(t[0])!==e&&t[0].reverse();for(var i=1;i<t.length;i++)nT(t[i])===e&&t[i].reverse()}let nO=function(t,e){if((e=e||{}).constructor!==Object)throw Error("options is invalid");var i=e.reverse||!1,r=e.mutate||!1;if(!t)throw Error("<geojson> is required");if("boolean"!=typeof i)throw Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw Error("<mutate> must be a boolean");!1===r&&(t=nM(t));var n=[];switch(t.type){case"GeometryCollection":return nE(t,function(t){nI(t,i)}),t;case"FeatureCollection":return nP(t,function(t){nP(nI(t,i),function(t){n.push(t)})}),nB(n)}return nI(t,i)},nD=function(t){if(!t)throw Error("geojson is required");var e,i=[];return e=function(t){i.push(t)},nE(t,function(t,i,r,n,s){var l,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":if(!1===e(nR(t,r,{bbox:n,id:s}),i,0))return!1;return}switch(a){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon"}for(var o=0;o<t.coordinates.length;o++)if(!1===e(nR({type:l,coordinates:t.coordinates[o]},r),i,o))return!1}),nB(i)},nH=nw(),nz={centroid:!1,name:!1,bbox:!1,rewind:!1},nW=t=>{if(t.geometry.type.startsWith("Multi")){let e=nD(t).features[0];return Object.assign(Object.assign({},e),e.properties)}return Object.assign(Object.assign({},t),t.properties)},nN=t=>{let e=[];return t.forEach(t=>{"FeatureCollection"===t.type?t.features.forEach(t=>{e.push(nW(t))}):e.push(nW(t))}),e},nj=(t,e={},i)=>{i.type=rP.GEO;let{centroid:r,name:n,bbox:s,rewind:l}=im(nz,e);if(Array.isArray(t))return nN(t);let a=t.features;return l&&(a=nO(t,{reverse:!e_(l)||l.reverse}).features),a.forEach(t=>{if(r){let e=nH.centroid(t);t.centroidX=e[0],t.centroidY=e[1]}if(n&&(t.name=t.properties.name),s){let e=nH.bounds(t);t.bbox=e}}),t.features=a,t};function nG(t){return t}function nV(t,e){var i=e.id,r=e.bbox,n=null==e.properties?{}:e.properties,s=function(t,e){var i=function(t){if(null==t)return nG;var e,i,r=t.scale[0],n=t.scale[1],s=t.translate[0],l=t.translate[1];return function(t,a){a||(e=i=0);var o=2,h=t.length,u=Array(h);for(u[0]=(e+=t[0])*r+s,u[1]=(i+=t[1])*n+l;o<h;)u[o]=t[o],++o;return u}}(t.transform),r=t.arcs;function n(t){return i(t)}function s(t){for(var e=[],n=0,s=t.length;n<s;++n)!function(t,e){e.length&&e.pop();for(var n=r[t<0?~t:t],s=0,l=n.length;s<l;++s)e.push(i(n[s],s));t<0&&function(t,e){for(var i,r=t.length,n=r-e;n<--r;)i=t[n],t[n++]=t[r],t[r]=i}(e,l)}(t[n],e);return e.length<2&&e.push(e[0]),e}function l(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function a(t){return t.map(l)}return function t(e){var i,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":i=n(e.coordinates);break;case"MultiPoint":i=e.coordinates.map(n);break;case"LineString":i=s(e.arcs);break;case"MultiLineString":i=e.arcs.map(s);break;case"Polygon":i=a(e.arcs);break;case"MultiPolygon":i=e.arcs.map(a);break;default:return null}return{type:r,coordinates:i}}(e)}(t,e);return null==i&&null==r?{type:"Feature",properties:n,geometry:s}:null==r?{type:"Feature",id:i,properties:n,geometry:s}:{type:"Feature",id:i,bbox:r,properties:n,geometry:s}}let nZ={},nU=(t,e,i)=>{var r;i.type=rP.GEO;let n=im(nz,nZ,e),{object:s}=n;if(!t6(s))throw TypeError("Invalid object: must be a string!");return nj(("string"==typeof(r=t.objects[s])&&(r=t.objects[r]),"GeometryCollection"===r.type?{type:"FeatureCollection",features:r.geometries.map(function(e){return nV(t,e)})}:nV(t,r)),n,i)};var nK=i(30939),n$=i.n(nK);let nY={tolerance:.01},nX=(t,e)=>{let{tolerance:i}=im(nY,e);return n$()(t,i)};function nq(t,e,i){t.getTransform(e)||t.registerTransform(e,i)}function nJ(t,e,i){t.getParser(e)||t.registerParser(e,i)}let nQ=new Map;function n0(t,e,i={type:"geojson",centroid:!0}){nQ.has(t)&&eO(`map type of '${t}' already exists, will be overwritten.`),r||(nJ(r=new tY,"geojson",nj),nJ(r,"topojson",nU),nq(r,"simplify",nX));let n=new el(r),s=ei({},{centroid:!0,simplify:!1},i);"topojson"===i.type?n.parse(e,{type:"topojson",options:s}):n.parse(e,{type:"geojson",options:s});let{simplify:l}=i;!0===l?n.transform({type:"simplify"}):e_(l)&&n.transform({type:"simplify",options:l}),nQ.set(t,n)}function n1(t){nQ.has(t)?nQ.delete(t):eO(`map type of '${t}' does not exists.`)}function n2(t,e=!1){let i=e;return t.latestData instanceof el&&(i=!1),i?t9(t.latestData):t.latestData&&t.latestData.slice()}let n3=(t,e)=>0===t.length?[]:1===t.length?n2(t[0],null==e?void 0:e.deep):t.map(t=>n2(t,null==e?void 0:e.deep));function n5(t,e,i){nq(e=e instanceof tY?e:t.dataSet,"copyDataView",n3);let r=new el(e,i);return r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView",level:F.copyDataView}),r}function n4(t,e,i=[]){let r;if(t instanceof el)return t;let{id:n,values:s=[],fromDataIndex:l,fromDataId:a,transforms:o=[]}=t,h=t.parser?t9(t.parser):{clone:!0},u=t9(t.fields);h.clone=!1!==h.clone;let d=i.find(t=>t.name===n);if(d)r=d;else{let t={name:n};if(u&&(t.fields=u),r=new el(e,t),"string"==typeof a){let t=i.find(t=>t.name===a);if(!t)return eO(`no data matches fromDataId ${a}`),null;r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView"})}else if("number"==typeof l){let t=i[l];if(!t)return eO(`no data matches fromDataIndex ${l}`),null;r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView"})}else Array.isArray(s)?r.parse(s,h):t6(s)&&(!h||["csv","dsv","tsv"].includes(h.type))?r.parse(s,null!=h?h:{type:"csv"}):(r.parse([]),eO("values should be array"));o&&o.length&&o.forEach(t=>{e.getTransform(t.type)&&r.transform(t)})}return r}function n6(t,e,i){t&&(e.fields&&t.setFields(e.fields,i),t.parseNewData(e.values,e.parser))}(l=F||(F={}))[l.copyDataView=-10]="copyDataView",l[l.treemapFilter=-8]="treemapFilter",l[l.treemapFlatten=-7]="treemapFlatten",l[l.dotObjFlat=-7]="dotObjFlat",l[l.linkDotInfo=-7]="linkDotInfo",l[l.sankeyLayout=-7]="sankeyLayout",l[l.dataZoomFilter=-6]="dataZoomFilter",l[l.legendFilter=-5]="legendFilter",(a=O||(O={})).appear="appear",a.disappear="disappear",a.enter="enter",a.update="update",a.state="state",a.exit="exit",a.normal="normal",a.none="none",(o=D||(D={})).before="before",o.layouting="layouting",o.reevaluate="reevaluate",o.after="after";var n8=i(34301),n9=i(75485),n7=i(72790);let st="__VCHART",se=500,si=500,sr=`${st}_MEASURE_CANVAS_ID`,sn=`${st}_DEFAULT_DATA_INDEX`,ss=`${st}_DEFAULT_DATA_KEY`,sl=`${st}_DEFAULT_DATA_SERIES_FIELD`,sa=`${st}_DEFAULT_SERIES_STYLE_NAME`,so=`${st}_STACK_KEY`,sh=`${st}_STACK_START`,su=`${st}_STACK_END`,sd=`${st}_STACK_START_PERCENT`,sc=`${st}_STACK_END_PERCENT`,sp=`${st}_STACK_START_OffsetSilhouette`,sg=`${st}_STACK_END_OffsetSilhouette`,sf=`${st}_STACK_TOTAL`,sm=`${st}_STACK_TOTAL_PERCENT`,sy=`${st}_STACK_TOTAL_TOP`,sv=`${st}_STACK_TOTAL_BOTTOM`,sb=`${st}_MOSAIC_VALUE_START_PERCENT`,s_=`${st}_MOSAIC_VALUE_END_PERCENT`,sx=`${st}_MOSAIC_CAT_START_PERCENT`,sC=`${st}_MOSAIC_CAT_END_PERCENT`,sw=`${st}_SEGMENT_START`,sS=`${st}_SEGMENT_END`,sA=`${st}_KEY`,sM=["line","area","trail"];function sk(t,e,i){let r=new Map;if(!t||0===t.length)return{keys:[],data:r};if(!e)return r.set(sA,i?t.slice().sort(i):t.slice()),{keys:[sA],data:r};if(1===t.length){let i=e(t[0],0);return r.set(i,[t[0]]),{keys:[i],data:r}}let n=new Set;return t.forEach((t,i)=>{var s;let l=e(t,i),a=null!=(s=r.get(l))?s:[];a.push(t),r.set(l,a),n.add(l)}),i&&n.forEach(t=>{r.get(t).sort(i)}),{keys:Array.from(n),data:r}}let sT=(t,e,i={})=>(t&&Object.keys(t).forEach(r=>{i[r]=t[r](e)}),i);function sR(t,e,i,r,n){let s=t=>{if(!r&&t&&(!i||i(t))){let i=e.call(null,t);if(n&&i)return i}if("group"===t.type){let e=t.getMarks();if(e)for(let t=0;t<e.length;t++){let i=s(e[t]);if(i&&n)return i}}if(r&&t&&(!i||i(t))){let i=e.call(null,t);if(i&&n)return i}};return s(t)}function sB(t){let e=[];return t.forEach(t=>{sR(t,t=>{"group"!==t.type&&"component"!==t.type&&e.push(t)})}),e}function sP(t,e,i,r){let n=sk(t,t=>i(t)),s=sk(e,t=>r(t)),l=t,a=e,o=[];return s.keys.forEach(t=>{if(!er(t)){let e=n.data.get(t),i=s.data.get(t);e&&i&&(o.push({prev:e,next:i}),l=l.filter(t=>!e.includes(t)),a=a.filter(t=>!i.includes(t)))}}),{prev:l,next:a,update:o}}class sE{getRootGroup(){return this._rootGroup}constructor(t,e){this._count=0,this._rootMarks=[],this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.isInited=!1,this._released=!1,this._compileChart=null,this.handleLayoutEnd=()=>{var t,e;null==(e=null==(t=this._compileChart)?void 0:t.getEvent())||e.emit(rI.afterMarkLayoutEnd,{chart:this._compileChart})},this.handleStageRender=()=>{var t,e;null==(e=null==(t=this._compileChart)?void 0:t.getEvent())||e.emit(rI.afterRender,{chart:this._compileChart})},this._handleAfterNextRender=()=>{var t,e,i,r;this._stage&&!this._option.disableDirtyBounds&&this._stage.enableDirtyBounds(),this._compileChart&&(null==(t=this._compileChart.getEvent())||t.emit(rI.renderFinished,{chart:this._compileChart,vchart:null==(e=this._compileChart.getOption())?void 0:e.globalInstance})),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterVRenderDraw)||r.call(i,this._compileChart.getOption().globalInstance)},this.handleProgressiveFrame=()=>{this._progressiveMarks.length&&this._progressiveMarks.forEach(t=>{t.isDoingProgressive()&&t.renderProgressive()}),this.doPreProgressive()},this._container=t,this._option=e}getChart(){return this._compileChart}getCanvas(){var t;return null==(t=this._stage)?void 0:t.window.getNativeHandler().nativeCanvas}getStage(){return this._stage}initView(){var t,e,i,r;if(this._released||(this.isInited=!0,this._stage))return;let{autoRefreshDpr:n,dpr:s,mode:l,modeParams:a,gestureConfig:o,interactive:h,clickInterval:u,autoPreventDefault:d,background:c}=this._option;ea.rF.setEnv(function(t){switch(t){case rM["desktop-browser"]:case rM["mobile-browser"]:break;case rM.node:case rM.worker:return"node";case rM.miniApp:case rM["desktop-miniApp"]:return"feishu";case rM.lynx:return"lynx";case rM.wx:return"wx";case rM.tt:return"tt";case rM.harmony:return"harmony"}return"browser"}(l),null!=a?a:{}),this._stage=null!=(t=this._option.stage)?t:new n8.H(Object.assign({background:c,width:this._width,height:this._height,container:null!=(e=this._container.dom)?e:null,canvas:null!=(i=this._container.canvas)?i:null,dpr:s,viewBox:this._option.viewBox,canvasControled:this._option.canvasControled,beforeRender:t=>{var e,i,r;null==(e=this._compileChart)||e.onBeforeRender(),null==(r=(i=this._option).beforeRender)||r.call(i,t)},afterRender:this._option.afterRender,disableDirtyBounds:!0,autoRender:!0,ticker:this._option.ticker,pluginList:this._option.pluginList,enableHtmlAttribute:this._option.enableHtmlAttribute,optimize:this._option.optimize,supportsTouchEvents:this._option.supportsTouchEvents,supportsPointerEvents:this._option.supportsPointerEvents,event:{clickInterval:u,autoPreventDefault:d},ReactDOM:this._option.ReactDOM,autoRefresh:t8(n)?n:!t8(s)},null!=(r=this._option.renderHooks)?r:{})),this._stage.enableIncrementalAutoRender(),this._stage.setTheme({symbol:{shape:"circle",size:8},text:{fontSize:14,fill:"#000000"}});let p=(0,n9.sS)({x:0,y:0,width:this._width,height:this._height});p.name="root",this._stage.defaultLayer.appendChild(p),this._rootGroup=p;let g=(t8(o)?o:eI(l))&&!1!==h&&iv.getStageEventPlugin("gesture");g&&(this._gestureController=new g(this._stage,e_(o)?o:{})),this._setCanvasStyle(),this.getStage().hooks.afterRender.tap("chart-event",this.handleStageRender),!1!==h&&this._viewListeners.forEach(t=>{})}getLayoutState(){return this._layoutState}updateLayoutTag(){this._layoutState=D.before}_setCanvasStyle(){if(this._stage&&this._container.dom&&!t6(this._container.dom)){this._container.dom.style.display="block",this._container.dom.style.position="relative";let t=this.getCanvas();t&&(t.style.display="block")}}compile(t,e){if(this._released)return;let{chart:i}=t;this._compileChart=i,this.initView(),this._stage&&("render"!==(null==e?void 0:e.actionSource)&&this._cachedMarks&&(this.reuseOrMorphing(e.morphConfig),this._cachedMarks=null),i.compile(),i.afterCompile())}clearNextRender(){return!!this._nextRafId&&(ea.rF.getSpecifiedCancelAnimationFrame(10)(this._nextRafId),this._nextRafId=null,!0)}clear(t){let{chart:e}=t;this.clearNextRender(),e.clear()}renderNextTick(t){this._released||(this._nextRafId&&this.clearNextRender(),this._nextRafId=ea.rF.getSpecifiedRequestAnimationFrame(10)(()=>{this._nextRafId=null,this.render(t)}))}_commitedAll(){return this._rootMarks.some(t=>sR(t,t=>t.commit()))}_hasCommitedMark(){return this._rootMarks.some(t=>sR(t,t=>t.isCommited(),null,null,!0))}_doRender(t){var e,i,r,n,s,l;null==(i=null==(e=this._option.performanceHook)?void 0:e.beforeDoRender)||i.call(e,this._compileChart.getOption().globalInstance),this._stage&&(this._rootMarks.forEach(t=>{sR(t,t=>{t.needClear&&(this._progressiveMarks||t.runAnimation(),t.clearExitGraphics(),t.needClear=!1)},null,!0)}),null==(n=null==(r=this._option.performanceHook)?void 0:r.beforeVRenderDraw)||n.call(r,this._compileChart.getOption().globalInstance),this._stage.disableDirtyBounds(),this._stage.afterNextRender(this._handleAfterNextRender),t&&(this._stage.render(),null==(l=null==(s=this._option.performanceHook)?void 0:s.afterVRenderDraw)||l.call(s,this._compileChart.getOption().globalInstance)))}renderMarks(){var t;this._hasCommitedMark()&&(eF(`--- start of renderMarks(${this._count}) ---`),this.clearProgressive(),this._rootMarks.forEach(t=>{t.render()}),this._layoutState===D.before&&(this._layoutState=D.layouting,null==(t=this._compileChart)||t.onLayout(),this._layoutState=D.reevaluate,this._hasCommitedMark()&&this._rootMarks.forEach(t=>{t.render()}),this.handleLayoutEnd()),this.findProgressiveMarks(),this._doRender(!0),this.doPreProgressive(),eF(`--- start of renderMarks(${this._count}) ---`),this._count++)}reuseOrMorphing(t={}){let{reuse:e=!0,morph:i=!0,morphAll:r=!1,animation:n={},enableExitAnimation:s=!1}=t,l=sB(this._rootMarks),{update:a,exit:o}=function(t,e,i){let r={enter:[],exit:[],update:[]},n=[],s=[];t.forEach(t=>{i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?n.push(t):r.exit.push({prev:[t]})}),e.forEach(t=>{i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?s.push(t):r.enter.push({next:[t]})});let l=sP(n,s,t=>t.getMarkConfig().morphKey,t=>t.getMarkConfig().morphKey);n=l.prev,s=l.next,r.update=r.update.concat(l.update);let a=sP(n,s,t=>`${t.getUserId()}`,t=>`${t.getUserId()}`);n=a.prev,s=a.next,r.update=r.update.concat(a.update);let o=sk(n,t=>{var e,i;return null==(i=null==(e=t.group)?void 0:e.id)?void 0:i.call(e)}),h=sk(s,t=>{var e,i;return null==(i=null==(e=t.group)?void 0:e.id)?void 0:i.call(e)});return Object.keys(h).forEach(t=>{let e=o.data.get(t),i=h.data.get(t);if(e&&i){for(let t=0;t<Math.max(e.length,i.length);t+=1){let n=e[t],s=i[t];n&&s?r.update.push({prev:[n],next:[s]}):n?r.exit.push({prev:[n]}):s&&r.enter.push({next:[s]})}n=n.filter(t=>!e.includes(t)),s=s.filter(t=>!i.includes(t))}}),n.forEach(t=>r.exit.push({prev:[t]})),s.forEach(t=>r.enter.push({next:[t]})),r}(this._cachedMarks,l,{morph:i,morphAll:r,reuse:e});a.forEach(({prev:t,next:i})=>{if(e&&1===t.length&&1===i.length&&t[0].type===i[0].type)i[0].reuse(t[0]);else{let e=t.filter(t=>t.getMarkConfig().morph)[0];e&&i.forEach(t=>{t.getMarkConfig().morph&&t.prepareMorph(e)})}}),o.forEach(({prev:t})=>{t.forEach(t=>{t.removeProduct()})})}render(t){if(this._released||(this.clearNextRender(),this.initView(),!this._stage))return;let{width:e,height:i}=this._rootGroup.attribute;this._width===e&&this._height===i||this._rootGroup.setAttributes({width:this._width,height:this._height}),this.renderMarks(),this.clearNextRender()&&this.renderMarks()}updateViewBox(t,e=!0){if(!this._stage)return;let i=this._stage.viewBox;!t||i&&i.x1===t.x1&&i.y1===t.y1&&i.x2===t.x2&&i.y2===t.y2||this._stage.setViewBox(t,e)}resize(t,e,i=!0){if(!this._stage)return;let r=this._width!==t||this._height!==e;this._width=t,this._height=e,r&&(this._stage.resize(t,e),this._commitedAll(),i&&this.render({morph:!1}))}setBackground(t){this._stage&&(this._stage.background=t)}setSize(t,e){this._width=t,this._height=e,this._stage}setViewBox(t,e=!0){this.updateViewBox(t,e)}addEventListener(t,e,i){var r,n;if(!1!==this._option.interactive){if(t===rL.chart){let n=this.getRootGroup(),s=(function(r){var s;let l=r.target,a=null;l&&(a=t8(l.context)?l:iU(n,l));let o=null!=(s=null==a?void 0:a.context)?s:{},h=t8(o.markId)?o.markId:null,u=t8(o.modelId)?o.modelId:null,d=t8(o.modelUserId)?o.modelUserId:null,c=t8(o.markUserId)?o.markUserId:null,p={event:r,type:e,source:t,item:a,datum:iZ(a),markId:h,modelId:u,markUserId:c,modelUserId:d};i.call(null,p)}).bind(this);this._viewListeners.set(i,{type:e,callback:s}),null==(r=this._stage)||r.addEventListener(e,s)}else if(t===rL.window){let r=(function(r){i.call(null,{event:r,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null})}).bind(this);this._windowListeners.set(i,{type:e,callback:r});let n=this._getGlobalThis();null==n||n.addEventListener(e,r)}else if(t===rL.canvas){let r=(function(r){i.call(null,{event:r,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null})}).bind(this);this._canvasListeners.set(i,{type:e,callback:r});let s=null==(n=this.getStage())?void 0:n.window;null==s||s.addEventListener(e,r)}}}removeEventListener(t,e,i){var r,n,s,l,a;if(!1!==this._option.interactive){if(t===rL.chart){let t=null==(r=this._viewListeners.get(i))?void 0:r.callback;t&&(null==(n=this._stage)||n.removeEventListener(e,t)),this._viewListeners.delete(i)}else if(t===rL.window){let t=this._getGlobalThis(),r=null==(s=this._windowListeners.get(i))?void 0:s.callback;r&&(null==t||t.removeEventListener(e,r)),this._windowListeners.delete(i)}else if(t===rL.canvas){let t=null==(l=this.getStage())?void 0:l.window,r=null==(a=this._canvasListeners.get(i))?void 0:a.callback;t&&r&&(null==t||t.removeEventListener(e,r)),this._canvasListeners.delete(i)}}}releaseEvent(){let t=this.getStage();t&&t.hooks.afterRender.unTap("chart-event",this.handleStageRender),this._viewListeners.clear(),this._windowListeners.clear(),this._canvasListeners.clear()}release(){var t;this.clearNextRender(),this.releaseEvent(),this._option=this._container=null,this.releaseGrammar(!0),this._stage!==(null==(t=this._option)?void 0:t.stage)&&this._stage.release(),this._stage=null,this.isInited=!1,this._compileChart=null,this._released=!0}releaseGrammar(t=!1){t?this._rootMarks.forEach(t=>{sR(t,t=>{t.removeProduct()},null,!0)}):this._cachedMarks=sB(this._rootMarks),this._rootMarks=[]}addRootMark(t){this._rootMarks.includes(t)||this._rootMarks.push(t)}getRootMarks(){return this._rootMarks}removeRootMark(t){let e=this._rootMarks.findIndex(e=>e===t);return e>=0&&(this._rootMarks.splice(e,1),!0)}_getGlobalThis(){var t;return eE(this._option.mode)?globalThis:null==(t=this.getStage())?void 0:t.window}_combineIncrementalLayers(){this._stage&&(0,n7.b4)(this._stage).then(()=>{this._stage&&this._stage.defaultLayer.combineSubLayer()})}findProgressiveMarks(){let t=[];return this._rootMarks.forEach(e=>{sR(e,e=>{e.isProgressive()&&t.push(e)})}),t.length?(this._progressiveMarks=t,this._combineIncrementalLayers(),t):(this._progressiveMarks=null,null)}doPreProgressive(){if(this._progressiveMarks&&this._progressiveMarks.some(t=>t.isDoingProgressive())){let t=ea.rF.getSpecifiedRequestAnimationFrame(10);this._progressiveRafId=t(this.handleProgressiveFrame)}else this._progressiveMarks&&this._progressiveMarks.every(t=>t.canAnimateAfterProgressive())?this._progressiveMarks.forEach(t=>{t.runAnimation()}):this._progressiveMarks&&(this._progressiveMarks=null)}clearProgressive(){this._progressiveRafId&&ea.rF.getSpecifiedCancelAnimationFrame(10)(this._progressiveRafId),this._progressiveMarks&&this._progressiveMarks.length&&(this._progressiveMarks.forEach(t=>{t.clearProgressive()}),this._progressiveMarks=null)}}let sI=t=>({}).toString.call(t).replace(/^\[object /,"").replace(/]$/,""),sL=Object.prototype,sF=function(t){let e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||sL)},sO=Object.prototype.hasOwnProperty,sD=function(t){if(er(t))return!0;if(t7(t))return!t.length;let e=sI(t);if("Map"===e||"Set"===e)return!t.size;if(sF(t))return!Object.keys(t).length;for(let e in t)if(sO.call(t,e))return!1;return!0};var sH=i(56306);function sz(t,e=0,i=0){let r;if(!t)return{width:e,height:i};try{r=null==window?void 0:window.getComputedStyle}catch(t){r=()=>({})}let n=r(t);if(/^(\d*\.?\d+)(px)$/.exec(n.width)){let r=parseFloat(n.width)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)||t.clientWidth-1,s=parseFloat(n.height)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)||t.clientHeight-1;return{width:r<=0?e:r,height:s<=0?i:s}}return{width:e,height:i}}function sW(t){t.crosshair=ed(t.crosshair||{}).map(e=>ir({["horizontal"===t.direction?"yField":"xField"]:{visible:!0,line:{visible:!0,type:"rect"}}},e))}function sN(t,e,i){var r;let{width:n,height:s}=t;if(t8(n)&&t8(s))return{width:n,height:s};let l=i.width,a=i.height,o=e.container,h=e.canvas;if(o){let{width:t,height:e}=sz(o,i.width,i.height);l=t,a=e}else if(h&&eE(e.mode)){let{width:t,height:e}=sz(t6(h)?ea.rF.getElementById(h):h,i.width,i.height);l=t,a=e}else if(eL(e.mode)&&(null==(r=e.modeParams)?void 0:r.domref)){let t=e.modeParams.domref;l=t.width,a=t.height}return{width:l=null!=n?n:l,height:a=null!=s?s:a}}function sj(t,...e){let i=i=>e.reduce((t,e)=>t||(null==e?void 0:e[i]),t[i]);return Object.assign(t,{change:i("change"),reCompile:i("reCompile"),reMake:i("reMake"),reRender:i("reRender"),reSize:i("reSize"),reTransformSpec:i("reTransformSpec"),changeTheme:i("changeTheme"),changeBackground:i("changeBackground")}),t}function sG(t,e){return"line"===t||"area"===t||"common"===t&&e.series.every(t=>"area"===t.type||"line"===t.type)?{paddingInner:1,paddingOuter:0}:{paddingOuter:0}}let sV=9,sZ=0,sU=-1;(h=H||(H={}))[h.SeriesGroup=0]="SeriesGroup",h[h.Axis_Grid=50]="Axis_Grid",h[h.CrossHair_Grid=100]="CrossHair_Grid",h[h.Region=450]="Region",h[h.Mark=300]="Mark",h[h.Node=400]="Node",h[h.Axis=100]="Axis",h[h.MarkLine=500]="MarkLine",h[h.MarkArea=100]="MarkArea",h[h.MarkPoint=500]="MarkPoint",h[h.DataZoom=500]="DataZoom",h[h.ScrollBar=500]="ScrollBar",h[h.Player=500]="Player",h[h.Legend=500]="Legend",h[h.CrossHair=500]="CrossHair",h[h.Indicator=500]="Indicator",h[h.Title=500]="Title",h[h.Label=500]="Label",h[h.Brush=500]="Brush",h[h.CustomMark=500]="CustomMark",h[h.Interaction=700]="Interaction",(u=z||(z={}))[u.Indicator=10]="Indicator",u[u.Region=20]="Region",u[u.Axis=30]="Axis",u[u.DataZoom=40]="DataZoom",u[u.Player=40]="Player",u[u.ScrollBar=40]="ScrollBar",u[u.Legend=50]="Legend",u[u.Title=70]="Title",u[u.CustomMark=70]="CustomMark",(d=W||(W={}))[d.Default=0]="Default",d[d.Theme=1]="Theme",d[d.Chart=2]="Chart",d[d.Base_Series=3]="Base_Series",d[d.Series=4]="Series",d[d.Mark=5]="Mark",d[d.User_Chart=6]="User_Chart",d[d.User_Series=7]="User_Series",d[d.User_Mark=8]="User_Mark",d[d.User_SeriesStyle=9]="User_SeriesStyle",d[d.Built_In=99]="Built_In";class sK{constructor(){this._children=[],this._markNameMap={},this._infoMap=new Map}getMarkNameMap(){return this._markNameMap}addMark(t,e){er(t)||(this._children.push(t),this._markNameMap[t.name]=t,this._infoMap.set(t,ei({},sK.defaultMarkInfo,e)))}removeMark(t){let e=this._children.findIndex(e=>e.name===t);e>=0&&(this._infoMap.delete(this._children[e]),delete this._markNameMap[t],this._children.splice(e,1))}clear(){this._children=[],this._markNameMap={},this._infoMap.clear()}forEach(t){this._children.forEach(t)}includes(t,e){return this._children.includes(t,e)}get(t){return isNaN(Number(t))?this._markNameMap[t]:this._children[t]}getMarks(){return this._children.slice()}getMarksInType(t){let e=ed(t);return this._children.filter(t=>e.includes(t.type))}getMarkInId(t){return this._children.find(e=>e.id===t)}getMarkWithInfo(t){return this._children.find(e=>Object.keys(t).every(i=>t[i]===this._infoMap.get(e)[i]))}}sK.defaultMarkInfo={};class s${getOption(){return this._option}constructor(t){this._option=t,this.getCompiler=this._option.getCompiler}getStage(){var t;return null==(t=this.getCompiler())?void 0:t.getStage()}release(){this._option=null,this.getCompiler=null}}class sY{constructor(t){this._option=t,this.type=t.type}_initTheme(t,e){return this._theme=this.getTheme(t,e),this._mergeThemeToSpec(t,e)}getTheme(t,e){}transformSpec(t,e,i){this._transformSpecBeforeMergingTheme(t,e,i);let r=this._initTheme(t,e);return this._transformSpecAfterMergingTheme(r.spec,e,i),r}_transformSpecBeforeMergingTheme(t,e,i){}_transformSpecAfterMergingTheme(t,e,i){}_mergeThemeToSpec(t,e){let i=this._theme;if(this._shouldMergeThemeToSpec()){let r=this._getDefaultSpecFromChart(e),n=t=>ir({},i,r,t);return tq(t)?{spec:t.map(t=>n(t)),theme:i}:{spec:n(t),theme:i}}return{spec:t,theme:i}}_shouldMergeThemeToSpec(){return!0}_getDefaultSpecFromChart(t){}}let sX=(t,e)=>t===e||!tQ(t)&&!tQ(e)&&(tq(t)&&tq(e)?e.every(e=>t.some(t=>sX(t,e))):!(!e_(t)||!e_(e))&&Object.keys(e).every(i=>sX(t[i],e[i]))),sq=(t,e,i)=>{if(er(e))return t;let r=e[0];return er(r)?t:1===e.length?(t[r]=i,t):(er(t[r])&&("number"==typeof e[1]?t[r]=[]:t[r]={}),sq(t[r],e.slice(1),i))},sJ=(t,e,i)=>{if(!er(e))return iW(t,e,i)};var sQ=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class s0 extends s${getSpec(){return this._spec||{}}getSpecPath(){var t;return null==(t=this._option)?void 0:t.specPath}getSpecInfoPath(){var t,e,i;return null!=(e=null==(t=this._option)?void 0:t.specInfoPath)?e:null==(i=this._option)?void 0:i.specPath}getData(){return this._data}get layout(){return this._layout}getOption(){return this._option}getMarks(){var t,e;return null!=(e=null==(t=this._marks)?void 0:t.getMarks())?e:[]}getMarkNameMap(){var t;return null==(t=this._marks)?void 0:t.getMarkNameMap()}getMarkSet(){return this._marks}getChart(){return this._option.getChart()}get _theme(){var t;return null==(t=this.getSpecInfo())?void 0:t.theme}constructor(t,e){var i;super(e),this.transformerConstructor=sY,this.type="null",this.modelType="null",this.userId=void 0,this._data=null,this._layout=null,this.specKey="",this._marks=new sK,this._lastLayoutRect=null,this.id=ey(),this.userId=t.id,this._spec=t,this.effect={},this.event=new iO(e.eventDispatcher,e.mode),null==(i=e.map)||i.set(this.id,this)}_releaseEvent(){this.event.release()}created(){this.setAttrFromSpec()}init(t){}afterInit(){}getVisible(){var t;return!1!==(null==(t=this._spec)?void 0:t.visible)}onLayoutStart(t,e){var i;null==(i=this._layout)||i.onLayoutStart(t,e)}onLayoutEnd(){var t;null==(t=this._layout)||t.onLayoutEnd(),this.getMarks().forEach(t=>t.commit(!1,!0))}onEvaluateEnd(t){}onBeforeRender(){}onDataUpdate(){}beforeRelease(){}clear(){this.getMarks().forEach(t=>{var e;return null==(e=t.clear)?void 0:e.call(t)})}release(){var t;this._releaseEvent(),this._spec=void 0,this.getMarks().forEach(t=>t.release()),null==(t=this._data)||t.release(),this._data=null,this._marks.clear(),super.release()}updateSpec(t){var e;let i=this._compareSpec(t,this._spec);return(i.reRender||i.reMake||i.reCompile)&&(null==(e=this._layout)||e.setWillLayoutTag()),this._spec=t,i}_compareSpec(t,e){return{change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1}}reInit(t){t&&(this._spec=t),this.setAttrFromSpec()}updateLayoutAttribute(){}setAttrFromSpec(){var t;null==(t=this._layout)||t.setAttrFromSpec(this._spec,this._option.getChartViewRect())}_convertMarkStyle(t){return Object.assign({},t)}setMarkStyle(t,e,i,r){t8(t)&&t8(e)&&t.setStyle(this._convertMarkStyle(e),i,r)}initMarkStyleWithSpec(t,e){if(!t8(t)||!t8(e))return;let{style:i,state:r}=e,n=Object.assign({},e);i&&(n.style=this._convertMarkStyle(i)),r&&(n.state={},Object.keys(r).forEach(t=>{n.state[t]=this._convertMarkStyle(r[t])})),t.initStyleWithSpec(n)}stateKeyToSignalName(t,e){let i=`${st}_${this.modelType}_${this.type}_${this.id}_${t}`;return e&&(i+=`_${e}`),i}compileData(){var t;null==(t=this._data)||t.compile()}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t})})}_createMark(t,e={},i){let{type:r,name:n}=t,{parent:s}=e,l=sQ(e,["parent"]),a=iv.createMark(r,n,Object.assign({model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._option.globalScale},l));return s?s.addMark(a):this.getCompiler().addRootMark(a),a&&(a.created(),i&&a.setMarkConfig(i)),a}_getDataIdKey(){}getColorScheme(){var t,e;return null==(e=(t=this._option).getTheme)?void 0:e.call(t,"colorScheme")}getSpecInfo(){var t,e,i;return sJ(null!=(i=null==(e=(t=this._option).getSpecInfo)?void 0:e.call(t))?i:{},this.getSpecInfoPath())}getSpecIndex(){let t=this.getSpecPath();if(!(null==t?void 0:t.length))return 0;let e=Number(t[t.length-1]);return isNaN(e)?0:e}updateAnimateStateCallback(t){this._aniamtionStateCallback=t}getAnimationStateCallback(){return this._aniamtionStateCallback}}class s1{getSpec(){return this._spec||{}}getLayoutStartPoint(){return this._layoutStartPoint}get layoutRectLevelMap(){return this._layoutRectLevelMap}get minWidth(){return this._minWidth}set minWidth(t){this._minWidth=t}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth=t}get minHeight(){return this._minHeight}set minHeight(t){this._minHeight=t}get maxHeight(){return this._maxHeight}set maxHeight(t){this._maxHeight=t}get lastComputeRect(){return this._lastComputeRect}getLastComputeOutBounds(){return this._lastComputeOutBounds}get layoutOrient(){return this._layoutOrient}set layoutOrient(t){this._layoutOrient=t}get model(){return this._model}get type(){return this._model.type}get willLayoutTag(){return this._willLayoutTag}constructor(t,e){var i;this.layoutClip=!1,this.autoIndent=!1,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:0,height:0},this._layoutRectLevelMap={width:sZ,height:sZ},this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._lastComputeRect=null,this._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0},this.getLayoutRect=()=>this._layoutRect,this.layoutType="normal",this._layoutOrient="left",this.layoutPaddingLeft=0,this.layoutPaddingTop=0,this.layoutPaddingRight=0,this.layoutPaddingBottom=0,this.layoutOffsetX=0,this.layoutOffsetY=0,this.layoutLevel=z.Region,this._willLayoutTag=!0,this._model=t,this._option=e,this.layoutLevel=e.layoutLevel,this.layoutType=e.layoutType,e.layoutOrient&&(this.layoutOrient=e.layoutOrient),this._spec=null==(i=null==t?void 0:t.getSpec)?void 0:i.call(t)}_setLayoutAttributeFromSpec(t,e){var i,r,n,s;if(this._spec&&!1!==this._spec.visible){let l=eA(ek(t.padding),e,e);this._option.transformLayoutPadding&&(l=this._option.transformLayoutPadding(l)),this.layoutPaddingLeft=l.left,this.layoutPaddingRight=l.right,this.layoutPaddingTop=l.top,this.layoutPaddingBottom=l.bottom,this._minHeight=er(t.minHeight)?null!=(i=this._minHeight)?i:null:eS(t.minHeight,e.height,e),this._maxHeight=er(t.maxHeight)?null!=(r=this._maxHeight)?r:null:eS(t.maxHeight,e.height,e),this._minWidth=er(t.minWidth)?null!=(n=this._minWidth)?n:null:eS(t.minWidth,e.width,e),this._maxWidth=er(t.maxWidth)?null!=(s=this._maxWidth)?s:null:eS(t.maxWidth,e.width,e),t.width&&this.setLayoutRect({width:eS(t.width,e.width,e)},{width:sV}),t.height&&this.setLayoutRect({height:eS(t.height,e.height,e)},{height:sV}),er(t.offsetX)||(this.layoutOffsetX=eS(t.offsetX,e.width,e)),er(t.offsetY)||(this.layoutOffsetY=eS(t.offsetY,e.height,e)),t.alignSelf&&(this.alignSelf=t.alignSelf)}}setAttrFromSpec(t,e){var i,r,n,s;this._spec=t,this.layoutType=null!=(i=t.layoutType)?i:this.layoutType,this.layoutLevel=null!=(r=t.layoutLevel)?r:this.layoutLevel,this.layoutOrient=null!=(n=t.orient)?n:this.layoutOrient,this._setLayoutAttributeFromSpec(t,e),this.layoutClip=null!=(s=t.clip)?s:this.layoutClip}onLayoutStart(t,e){this._setLayoutAttributeFromSpec(this._spec,e)}onLayoutEnd(){}_getAbsoluteSpecValue(t){let e={top:null,bottom:null,left:null,right:null};return["top","bottom","left","right"].forEach(i=>{er(this._spec[i])||(e[i]=eS(this._spec[i],"top"===i||"bottom"===i?t.height:t.width,t))}),e}absoluteLayoutInRect(t){let{top:e,bottom:i,left:r,right:n}=this._getAbsoluteSpecValue(t),s={width:t.width-this.layoutPaddingLeft-this.layoutPaddingRight,height:t.height-this.layoutPaddingTop-this.layoutPaddingBottom};er(r)||(s.width-=r),er(n)||(s.width-=n),er(e)||(s.height-=e),er(i)||(s.height-=i),this.setLayoutRect(s);let{width:l,height:a}=this.computeBoundsInRect(this.getLayoutRect());this.setLayoutRect({width:l,height:a});let o={x:t.x,y:t.y};!0===this._spec.center?(o.x=t.x+.5*t.width-.5*l,o.y=t.y+.5*t.height-.5*a):(er(r)?er(n)||(o.x=t.x+t.width-this.layoutPaddingRight-n-l):o.x=t.x+r+this.layoutPaddingLeft,er(e)?er(i)||(o.y=t.y+t.height-this.layoutPaddingBottom-i-a):o.y=t.y+e+this.layoutPaddingTop),this.setLayoutStartPosition(o)}setLayoutStartPosition(t){var e,i;this._option.transformLayoutPosition&&(t=this._option.transformLayoutPosition(t)),en(t.x)&&(this._layoutStartPoint.x=t.x),en(t.y)&&(this._layoutStartPoint.y=t.y),null==(i=(e=this._model).afterSetLayoutStartPoint)||i.call(e,this._layoutStartPoint)}setLayoutRect({width:t,height:e},i){var r,n,s,l;en(t)&&(null!=(r=null==i?void 0:i.width)?r:sZ)>=this._layoutRectLevelMap.width&&(this._layoutRect.width=t,this._layoutRectLevelMap.width=null!=(n=null==i?void 0:i.width)?n:sZ),en(e)&&(null!=(s=null==i?void 0:i.height)?s:sZ)>=this._layoutRectLevelMap.height&&(this._layoutRect.height=e,this._layoutRectLevelMap.height=null!=(l=null==i?void 0:i.height)?l:sZ),this.setRectInSpec(this._layoutRect)}getLayout(){return{x:this._layoutStartPoint.x,y:this._layoutStartPoint.y,width:this._layoutRect.width,height:this._layoutRect.height}}mergeLayoutRect({width:t,height:e}){let i={width:t,height:e};return this._layoutRectLevelMap.width>sZ&&(i.width=this._layoutRect.width),this._layoutRectLevelMap.height>sZ&&(i.height=this._layoutRect.height),i}getOrientPosAttribute(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"x":"y"}getOrientSizeAttribute(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"width":"height"}changeBoundsBySetting(t){return this._layoutRectLevelMap.width>sZ&&(t.x2=t.x1+this._layoutRect.width),this._layoutRectLevelMap.height>sZ&&(t.y2=t.y1+this._layoutRect.height),t.x1-=this._layoutStartPoint.x,t.x2-=this._layoutStartPoint.x,t.y1-=this._layoutStartPoint.y,t.y2-=this._layoutStartPoint.y,t}setRectInSpec(t){let e=Object.assign({},t);return this._layoutRectLevelMap.width<sV?(er(this._minWidth)||(e.width=Math.max(e.width,this._minWidth)),er(this._maxWidth)||(e.width=Math.min(e.width,this._maxWidth))):e.width=this._layoutRect.width,this._layoutRectLevelMap.height<sV?(er(this._minHeight)||(e.height=Math.max(e.height,this._minHeight)),er(this._maxHeight)||(e.height=Math.min(e.height,this._maxHeight))):e.height=this._layoutRect.height,e}computeBoundsInRect(t){if(this._lastComputeRect=t,("region-relative"===this.layoutType||"region-relative-overlap"===this.layoutType)&&(this._layoutRectLevelMap.width===sV&&("left"===this.layoutOrient||"right"===this.layoutOrient)||this._layoutRectLevelMap.height===sV&&("bottom"===this.layoutOrient||"top"===this.layoutOrient)))return this._layoutRect;let e=Object.assign({},this._model.getBoundsInRect(this.setRectInSpec(t),t));this.changeBoundsBySetting(e),this.autoIndent&&e.x2-e.x1>0&&e.y2-e.y1>0&&(this._lastComputeOutBounds.x1=Math.ceil(-e.x1),this._lastComputeOutBounds.x2=Math.ceil(e.x2-t.width),this._lastComputeOutBounds.y1=Math.ceil(-e.y1),this._lastComputeOutBounds.y2=Math.ceil(e.y2-t.height));let i=this.setRectInSpec(eM(e,t));return this._option.transformLayoutRect&&(i=this._option.transformLayoutRect(i)),i}getModelId(){return this._model.id}getModelVisible(){return this._model.getVisible()}setWillLayoutTag(){this._willLayoutTag=!0}clearWillLayoutTag(){this._willLayoutTag=!1}}class s2 extends s0{constructor(){super(...arguments),this.layoutType="normal",this.layoutLevel=0,this.layoutZIndex=0,this._forceLayoutTag=!1,this._layout=null,this._orient=null,this._layoutRect={width:0,height:0},this._layoutStartPos={x:0,y:0},this._isLayout=!0,this.getGraphicBounds=()=>this._layout?{x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}:{x1:0,x2:0,y1:0,y2:0},this._transformLayoutRect=null,this._transformLayoutPosition=null,this._transformLayoutPadding=null}get layoutOrient(){return this._orient}set layoutOrient(t){this._orient=t,this._layout&&(this._layout.layoutOrient=t)}initLayout(){"none"!==this.layoutType&&(this._layout=new s1(this,{layoutType:this.layoutType,layoutLevel:this.layoutLevel,layoutOrient:this._orient,transformLayoutRect:this._transformLayoutRect,transformLayoutPosition:this._transformLayoutPosition,transformLayoutPadding:this._transformLayoutPadding}),this._orient&&"radius"!==this._orient&&"angle"!==this._orient&&this._layout&&(this._layout.layoutOrient=this._orient))}onLayoutStart(t,e){this._isLayout=!0,super.onLayoutStart(t,e)}onLayoutEnd(){super.onLayoutEnd(),this.updateLayoutAttribute();let t=this.getLayoutRect();!this._forceLayoutTag&&t5(this._lastLayoutRect,t)||(this._lastLayoutRect=Object.assign({},t)),this._forceLayoutTag=!1,this._isLayout=!1}afterSetLayoutStartPoint(t){}_forceLayout(){var t,e;this._isLayout||(null==(t=this._layout)||t.setWillLayoutTag(),this._forceLayoutTag=!0,null==(e=this._option.globalInstance.getChart())||e.setLayoutTag(!0))}getLayoutStartPoint(){return this._layout?this._layout.getLayoutStartPoint():this._layoutStartPos}setLayoutStartPosition(t){return this._layout?this._layout.setLayoutStartPosition(t):this._layoutStartPos=ei(this._layoutStartPos,t)}getLayoutRect(){return this._layout?this._layout.getLayoutRect():this._layoutRect}setLayoutRect(t,e){return this._layout?this._layout.setLayoutRect(t):this._lastLayoutRect=ei(this._layoutRect,t)}getLastComputeOutBounds(){var t;return null==(t=this._layout)?void 0:t.getLastComputeOutBounds()}setAttrFromSpec(){var t,e,i,r,n;super.setAttrFromSpec(),this.layoutClip=null!=(t=this._spec.clip)?t:this.layoutClip,this.layoutZIndex=null!=(e=this._spec.zIndex)?e:this.layoutZIndex,this.layoutType=null!=(i=this._spec.layoutType)?i:this.layoutType,this._orient=null!=(r=this._spec.orient)?r:this._orient,this.layoutLevel=null!=(n=this._spec.layoutLevel)?n:this.layoutLevel}}class s3 extends sY{_initTheme(t,e){return{spec:t,theme:this._theme}}}class s5 extends s2{getMaxWidth(){return this._layout.maxWidth}setMaxWidth(t){this._layout.maxWidth=t}getMaxHeight(){return this._layout.maxHeight}setMaxHeight(t){this._layout.maxHeight=t}getGroupMark(){return this._groupMark}getInteractionMark(){return this._interactionMark}getStackInverse(){return!0===this._spec.stackInverse}getStackSort(){return!0===this._spec.stackSort}constructor(t,e){var i;super(t,e),this.transformerConstructor=s3,this.modelType="region",this.specKey="region",this.type=s5.type,this._series=[],this.layoutType="region",this.layoutZIndex=H.Region,this.seriesDataFilterOver=()=>{this.event.emit(rI.regionSeriesDataFilterOver,{model:this,chart:this.getChart()}),this._series.forEach(t=>{t.getViewDataFilter()&&t.reTransformViewData()})},this.getBoundsInRect=()=>({x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}),this.userId=t.id,this.coordinate=null!=(i=t.coordinate)?i:"cartesian"}_getClipDefaultValue(){var t,e,i,r;let n=this._option.getChart().getSpec(),s=null==(e=null==(t=n.dataZoom)?void 0:t.some)?void 0:e.call(t,t=>{var e;return"axis"===(null!=(e=t.filterMode)?e:"filter")}),l=null==(r=null==(i=n.scrollBar)?void 0:i.some)?void 0:r.call(i,t=>{var e;return"axis"===(null!=(e=t.filterMode)?e:"axis")});return!(!s&&!l)||this._layout.layoutClip}created(){var t,e;this.initLayout(),super.created();let i=null!=(t=this._spec.clip)?t:this._getClipDefaultValue();this._groupMark=this._createGroupMark("regionGroup",this.userId,this.layoutZIndex),this._spec.roam&&this._groupMark.setMarkConfig({interactive:!0}),this._interactionMark=this._createGroupMark("regionInteractionGroup",(null!=(e=this.userId)?e:this.type)+"_interaction",H.Interaction),sD(this._spec.style)||(this._backgroundMark=this._createMark({type:"rect",name:"regionBackground"},{parent:this._groupMark}),i&&(this._foregroundMark=this._createMark({type:"rect",name:"regionForeground"},{parent:this._groupMark})),[this._backgroundMark,this._foregroundMark].forEach(t=>{t&&(t.created(),this.setMarkStyle(t,{width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height},"normal",W.Built_In),this._groupMark.addMark(t))}),this._backgroundMark&&this._backgroundMark.setMarkConfig({zIndex:H.SeriesGroup-1}),this._foregroundMark&&this._foregroundMark.setMarkConfig({zIndex:H.Mark+1}))}_createGroupMark(t,e,i){var r,n;let s=this._createMark({type:"group",name:t});s.setUserId(e),s.setMarkConfig({zIndex:i});let l=null!=(r=this._spec.clip)?r:this._getClipDefaultValue();return this.setMarkStyle(s,{x:()=>this.getLayoutStartPoint().x,y:()=>this.getLayoutStartPoint().y,width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height,clip:l},"normal",W.Built_In),this.setMarkStyle(s,{cornerRadius:null==(n=this._spec.style)?void 0:n.cornerRadius},"normal",W.User_Mark),this._marks.addMark(s),s}init(t){super.init(t),this.initMark(),this.initSeriesDataflow()}initMark(){this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}_initBackgroundMarkStyle(){var t,e;this._backgroundMark&&(this.setMarkStyle(this._backgroundMark,Object.assign({fillOpacity:+(null!=(t=this._spec.style)&&!!t.fill)},this._spec.style),"normal",W.User_Mark),(null!=(e=this._spec.clip)?e:this._getClipDefaultValue())&&this.setMarkStyle(this._backgroundMark,{strokeOpacity:0},"normal",W.Built_In))}_initForegroundMarkStyle(){this._foregroundMark&&this.setMarkStyle(this._foregroundMark,Object.assign(Object.assign({},this._spec.style),{fillOpacity:0,pickable:!1}),"normal",W.User_Mark)}_compareSpec(t,e){let i=super._compareSpec(t,e);return t5(null==e?void 0:e.style,null==t?void 0:t.style)||(i.reMake=!0),i}reInit(t){super.reInit(t),this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}addSeries(t){t&&(this._series.includes(t)||this._series.push(t))}removeSeries(t){if(!t)return;let e=this._series.findIndex(e=>e===t);e>=0&&this._series.splice(e,1)}getSeries(t={}){return this._series.filter(e=>{var i,r;return(!t.name||(null==e?void 0:e.name)===t.name)&&(!t.userId||ed(t.userId).includes(e.userId))&&(!t8(t.specIndex)||ed(t.specIndex).includes(e.getSpecIndex()))&&(!t.id||e.id===t.id)&&(!t.type||e.type===t.type)&&(!t.coordinateType||e.coordinate===t.coordinateType)&&(!t.dataName||(null==(r=null==(i=e.getRawData)?void 0:i.call(e))?void 0:r.name)===t.dataName)})}getSeriesInName(t){return this.getSeries({name:t})[0]}getSeriesInUserId(t){return this.getSeries({userId:t})[0]}getSeriesInId(t){return this.getSeries({id:t})[0]}getSeriesInType(t){return this.getSeries({type:t})}getSeriesInCoordinateType(t){return this.getSeries({coordinateType:t})}getSeriesInDataName(t){return this.getSeries({dataName:t})}initSeriesDataflow(){let t=this._series.map(t=>{var e;return null!=(e=t.getViewDataFilter())?e:t.getViewData()}).filter(t=>!!t);this._option.dataSet.multipleDataViewAddListener(t,"change",this.seriesDataFilterOver)}release(){super.release(),this._series=[]}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t,context:{model:this}})})}compile(){this.compileMarks()}onLayoutEnd(){this._series.forEach(t=>t.onLayoutEnd()),super.onLayoutEnd()}}function s4(t){let e=[],i=[],r=[];return t.forEach(t=>{er(t.getSpec().position)||"start"===t.getSpec().position?e.push(t):"middle"===t.getSpec().position?i.push(t):"end"===t.getSpec().position&&r.push(t)}),{startItems:e,endItems:r,middleItems:i}}function s6(t,e,i){e?t.forEach(t=>{let e=ec(t),r=(i-(e.getLayoutStartPoint().y+e.getLayoutRect().height-t[0].getLayoutStartPoint().y))/2;t.forEach(t=>{t.setLayoutStartPosition({x:t.getLayoutStartPoint().x,y:t.getLayoutStartPoint().y+r})})}):t.forEach(t=>{let e=ec(t),r=(i-(e.getLayoutStartPoint().x+e.getLayoutRect().width-t[0].getLayoutStartPoint().x))/2;t.forEach(t=>{t.setLayoutStartPosition({x:t.getLayoutStartPoint().x+r,y:t.getLayoutStartPoint().y})})})}function s8(t,e,i,r){let n;t.forEach((t,s)=>{t.length>1&&(n=i[s],t.forEach(t=>{if(!t.alignSelf||"start"===t.alignSelf)return;let i=t.getLayoutStartPoint(),s="middle"===t.alignSelf?.5:1,l=e?n-(t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight):n-(t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom);e?t.setLayoutStartPosition({x:i.x+r*l*s,y:i.y}):t.setLayoutStartPosition({x:i.x,y:i.y+r*l*s})}))})}function s9(t,e,i,r,n,s){if(t.length){let l=0,a="right"===n,o=a?-1:1,h=a?e.rightCurrent:e.leftCurrent,u=e.topCurrent,d=[],c=[],p=[];t.forEach(t=>{let{rect:r}=li(t,e,s),n=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=a?-r.width-t.layoutPaddingRight:t.layoutPaddingLeft;t.setLayoutStartPosition({x:h+t.layoutOffsetX+f,y:u+t.layoutOffsetY+t.layoutPaddingTop}),(u+=n)>i&&c.length?(p.push(l),h+=o*l,l=g,u=e.topCurrent+n,t.setLayoutStartPosition({x:h+t.layoutOffsetX+f,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),d.push(c),c=[t]):(l=Math.max(l,g),c.push(t))}),p.push(l),d.push(c),s8(d,!0,p,o),r&&s6(d,!0,i),a?e.rightCurrent=h+o*l:e.leftCurrent=h+o*l}}function s7(t,e,i,r,n){if(t.length){let i=0,s="right"===r,l=s?-1:1,a=s?e.rightCurrent:e.leftCurrent,o=e.bottomCurrent,h=[],u=[],d=[];t.forEach(t=>{let{rect:r}=li(t,e,n),c=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,p=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,g=s?-r.width-t.layoutPaddingRight:t.layoutPaddingLeft;o<c&&u.length?(d.push(i),a+=l*i,i=p,o=e.bottomCurrent,t.setLayoutStartPosition({x:a+t.layoutOffsetX+g,y:o+t.layoutOffsetY-r.height-t.layoutPaddingBottom}),h.push(u),u=[t]):(t.setLayoutStartPosition({x:a+t.layoutOffsetX+g,y:o+t.layoutOffsetY-r.height-t.layoutPaddingBottom}),i=Math.max(i,p),o-=c,u.push(t))}),d.push(i),h.push(u),s8(h,!0,d,l),s?e.rightCurrent=a+l*i:e.leftCurrent=a+l*i}}function lt(t,e,i,r,n,s){if(t.length){let l="top"===n,a=l?1:-1,o=0,h=e.leftCurrent,u=l?e.topCurrent:e.bottomCurrent,d=[],c=[],p=[];t.forEach(t=>{let{rect:r}=li(t,e,s),n=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=l?t.layoutPaddingTop:-r.height-t.layoutPaddingBottom;t.setLayoutStartPosition({x:h+t.layoutOffsetX+t.layoutPaddingLeft,y:u+t.layoutOffsetY+f}),(h+=g)>i&&c.length?(p.push(o),h=e.leftCurrent+g,u+=a*o,o=n,t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:u+t.layoutOffsetY+f}),d.push(c),c=[t]):(o=Math.max(o,n),c.push(t))}),p.push(o),d.push(c),s8(d,!1,p,a),r&&s6(d,!1,i),l?e.topCurrent=u+a*o:e.bottomCurrent=u+a*o}}function le(t,e,i,r,n){if(t.length){let i="top"===r,s=i?1:-1,l=0,a=e.rightCurrent,o=i?e.topCurrent:e.bottomCurrent,h=[],u=[],d=[];t.forEach(t=>{let{layoutTag:r,layoutRect:d,rect:c}=li(t,e,n),p=c.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=c.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=i?t.layoutPaddingTop:-c.height-t.layoutPaddingBottom;a<g&&u.length?(a=e.rightCurrent,o+=s*l,l=p,t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-c.width-t.layoutPaddingRight,y:o+t.layoutOffsetY+f}),h.push(u),u=[t]):(u.push(t),t.setLayoutStartPosition({x:a+t.layoutOffsetX-c.width-t.layoutPaddingRight,y:o+t.layoutOffsetY+f}),l=Math.max(l,p),a-=g)}),d.push(l),h.push(u),s8(h,!1,d,s),i?e.topCurrent=o+s*l:e.bottomCurrent=o+s*l}}function li(t,e,i,r=!0){let n,s,l="recomputeHeight",a="recomputeWidth",o="width";"top"!==t.layoutOrient&&"bottom"!==t.layoutOrient||(l="recomputeWidth",a="recomputeHeight",o="height");let h=!(!t.willLayoutTag&&!1===i[l]);if(h){let l=Object.assign({},t.getLayoutRect()),u=t.lastComputeRect;n=e.getItemComputeLayoutRect(t),!t.willLayoutTag&&t5(n,u)?(h=!1,s=t.getLayoutRect()):(s=t.computeBoundsInRect(n),t5(l[o],s[o])?h=!1:(r&&t.setLayoutRect(s),i[a]=!0))}else n=t.getLastComputeOutBounds(),s=t.getLayoutRect();return{layoutRect:n,rect:s,layoutTag:h}}s5.type="region",s5.transformerConstructor=s3,s5.specKey="region";class lr{constructor(t,e){this.leftCurrent=0,this.topCurrent=0,this.rightCurrent=0,this.bottomCurrent=0,this.recomputeWidth=!1,this.recomputeHeight=!1,this._onError=null==e?void 0:e.onError}_layoutInit(t,e,i,r){this._chartLayoutRect=i,this._chartViewBox=r,this.leftCurrent=i.x,this.topCurrent=i.y,this.rightCurrent=i.x+i.width,this.bottomCurrent=i.height+i.y,this.recomputeWidth=!1,this.recomputeHeight=!1,e.sort((t,e)=>e.layoutLevel-t.layoutLevel)}_layoutNormalItems(t,e){this.layoutNormalInlineItems(t.filter(t=>"normal-inline"===t.layoutType),e),this.layoutNormalItems(t.filter(t=>"normal"===t.layoutType),e)}_groupItems(t){let e=t.filter(t=>"region"===t.layoutType),i=t.filter(t=>"region-relative"===t.layoutType),r=t.filter(t=>"region-relative-overlap"===t.layoutType),n=i.concat(r),s={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}};return r.forEach(t=>{s[t.layoutOrient].items.push(t)}),{regionItems:e,relativeItems:i,relativeOverlapItems:r,allRelatives:n,overlapItems:s}}layoutItems(t,e,i,r){this._layoutInit(t,e,i,r);let n={recomputeWidth:this.recomputeWidth,recomputeHeight:this.recomputeHeight};this._layoutNormalItems(e,n);let s={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},{regionItems:l,relativeItems:a,relativeOverlapItems:o,allRelatives:h,overlapItems:u}=this._groupItems(e);this.layoutRegionItems(l,a,o,u,n),this._processAutoIndent(l,a,o,u,h,s,n),this.layoutAbsoluteItems(e.filter(t=>"absolute"===t.layoutType)),e.forEach(t=>{t.clearWillLayoutTag()})}_processAutoIndent(t,e,i,r={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}},n,s,l){if(n.some(t=>t.autoIndent)){let{top:a,bottom:o,left:h,right:u}=this._checkAutoIndent(n,s);(a||o||h||u)&&(this.topCurrent=s.top+a,this.bottomCurrent=s.bottom-o,this.leftCurrent=s.left+h,this.rightCurrent=s.right-u,this.layoutRegionItems(t,e,i,r,l))}}layoutNormalItems(t,e){t.forEach(t=>{let{rect:i}=li(t,this,e);"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"top"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"right"===t.layoutOrient?(t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX-i.width-t.layoutPaddingRight,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"bottom"===t.layoutOrient&&(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingRight,y:this.bottomCurrent+t.layoutOffsetY-i.height-t.layoutPaddingBottom}),this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom)})}layoutNormalInlineItems(t,e){let i=t.filter(t=>"left"===t.layoutOrient),r=t.filter(t=>"right"===t.layoutOrient),n=t.filter(t=>"top"===t.layoutOrient),s=t.filter(t=>"bottom"===t.layoutOrient),l=this._chartLayoutRect.width+this._chartLayoutRect.x,a=this._chartLayoutRect.height+this._chartLayoutRect.y;return i.length&&function(t,e,i,r){let{startItems:n,middleItems:s,endItems:l}=s4(t);n.length&&s9(n,e,i,!1,"left",r),s.length&&s9(s,e,i,!0,"left",r),l.length&&s7(l,e,i,"left",r)}(i,this,a,e),n.length&&function(t,e,i,r){let{startItems:n,middleItems:s,endItems:l}=s4(t);n.length&&lt(n,e,i,!1,"top",r),s.length&&lt(s,e,i,!0,"top",r),l.length&&le(l,e,i,"top",r)}(n,this,l,e),r.length&&function(t,e,i,r){let{startItems:n,middleItems:s,endItems:l}=s4(t);n.length&&s9(n,e,i,!1,"right",r),s.length&&s9(s,e,i,!0,"right",r),l.length&&s7(l,e,i,"right",r)}(r,this,a,e),s.length&&function(t,e,i,r){let{startItems:n,middleItems:s,endItems:l}=s4(t);n.length&&lt(n,e,i,!1,"bottom",r),s.length&&lt(s,e,i,!0,"bottom",r),l.length&&le(l,e,i,"bottom",r)}(s,this,l,e),!0}_layoutRelativeOverlap(t,e,i){e.items.forEach(t=>{let{rect:r}=li(t,this,i);e.rect.width=Math.max(r.width+t.layoutPaddingLeft+t.layoutPaddingRight,e.rect.width),e.rect.height=Math.max(r.height+t.layoutPaddingTop+t.layoutPaddingBottom,e.rect.height)}),e.items.forEach(i=>{t5(i.getLayoutRect(),e.rect)||i.setLayoutRect(e.rect),"left"===t?i.setLayoutStartPosition({x:this.leftCurrent+i.layoutOffsetX}):"right"===t?i.setLayoutStartPosition({x:this.rightCurrent-e.rect.width+i.layoutOffsetX}):"top"===t?i.setLayoutStartPosition({x:this.topCurrent+i.layoutOffsetY}):i.setLayoutStartPosition({x:this.bottomCurrent-e.rect.height+i.layoutOffsetY})}),"left"===t?this.leftCurrent+=e.rect.width:"right"===t?this.rightCurrent-=e.rect.width:"top"===t?this.topCurrent+=e.rect.height:this.bottomCurrent-=e.rect.height}_layoutRelativeItem(t,e){let{rect:i}=li(t,this,e,!1);"left"===t.layoutOrient||"right"===t.layoutOrient?t.setLayoutRect({width:i.width}):t.setLayoutRect({height:i.height}),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"right"===t.layoutOrient?(this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX+t.layoutPaddingLeft})):"top"===t.layoutOrient?(t.setLayoutStartPosition({y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"bottom"===t.layoutOrient&&(this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,t.setLayoutStartPosition({y:this.bottomCurrent+t.layoutOffsetY+t.layoutPaddingTop}))}_layoutRegionItem(t,e,i){let r=Math.max(Math.min(e,...t.map(t=>{var e;return null!=(e=t.maxWidth)?e:Number.MAX_VALUE})),0),n=Math.max(Math.min(i,...t.map(t=>{var e;return null!=(e=t.maxHeight)?e:Number.MAX_VALUE})),0);return t.forEach(t=>{let e=r-t.layoutPaddingLeft-t.layoutPaddingRight,i=n-t.layoutPaddingTop-t.layoutPaddingBottom;t.setLayoutRect({width:e,height:i}),t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop})}),{regionHeight:n,regionWidth:r}}layoutRegionItems(t,e,i,r={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}},n){let s=this.rightCurrent-this.leftCurrent,l=this.bottomCurrent-this.topCurrent;e.filter(t=>"left"===t.layoutOrient||"right"===t.layoutOrient).forEach(t=>{this._layoutRelativeItem(t,n)}),this._layoutRelativeOverlap("left",r.left,n),this._layoutRelativeOverlap("right",r.right,n),s=this.rightCurrent-this.leftCurrent,e.filter(t=>"top"===t.layoutOrient||"bottom"===t.layoutOrient).forEach(t=>{this._layoutRelativeItem(t,n)}),this._layoutRelativeOverlap("top",r.top,n),this._layoutRelativeOverlap("bottom",r.bottom,n),l=this.bottomCurrent-this.topCurrent;let{regionWidth:a,regionHeight:o}=this._layoutRegionItem(t,s,l);e.concat(i).forEach(e=>{if(["left","right"].includes(e.layoutOrient)){let i=this.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({height:i.getLayoutRect().height}),e.setLayoutStartPosition({y:i.getLayoutStartPoint().y+e.layoutOffsetY+e.layoutPaddingTop}),"right"===e.layoutOrient&&e.setLayoutStartPosition({x:e.getLayoutStartPoint().x+a-s})}else if(["top","bottom"].includes(e.layoutOrient)){let i=this.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({width:i.getLayoutRect().width}),e.setLayoutStartPosition({x:i.getLayoutStartPoint().x+e.layoutOffsetX+e.layoutPaddingLeft}),"bottom"===e.layoutOrient&&e.setLayoutStartPosition({y:e.getLayoutStartPoint().y+o-l})}})}layoutAbsoluteItems(t){t.forEach(t=>{t.willLayoutTag&&t.absoluteLayoutInRect(this._chartLayoutRect)})}filterRegionsWithID(t,e){var i;let r=t.find(t=>t.getModelId()===e);return r||(null!=(i=this._onError)?i:eD)("can not find target region item, invalid id"),r}getItemComputeLayoutRect(t){return{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight,height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom}}_checkAutoIndent(t,e){let i={top:0,left:0,bottom:0,right:0};return t.forEach(t=>{if(!t.getModelVisible()||!t.autoIndent)return;let r="left"===t.layoutOrient||"right"===t.layoutOrient,n=t.getLastComputeOutBounds(),s=this._getOutInLayout(n,t,e);r?(i.top=Math.max(i.top,s.top),i.bottom=Math.max(i.bottom,s.bottom)):(i.left=Math.max(i.left,s.left),i.right=Math.max(i.right,s.right))}),i}_getOutInLayout(t,e,i){let{x:r,y:n}=e.getLayoutStartPoint(),{width:s,height:l}=e.getLayoutRect();return{left:i.left-(r-t.x1),right:r+s+t.x2-i.right,top:i.top-(n-t.y1),bottom:n+l+t.y2-i.bottom}}}lr.type="base",(c=N||(N={})).enter="enter",c.update="update",c.exit="exit",c.unChange="unChange",(p=j||(j={})).STATE_NORMAL="normal",p.STATE_HOVER="hover",p.STATE_HOVER_REVERSE="hover_reverse",p.STATE_DIMENSION_HOVER="dimension_hover",p.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",p.STATE_SELECTED="selected",p.STATE_SELECTED_REVERSE="selected_reverse",p.STATE_SANKEY_EMPHASIS="selected",p.STATE_SANKEY_EMPHASIS_REVERSE="blur",p.STATE_HIGHLIGHT="highlight",p.STATE_BLUR="blur",p.STATE_ACTIVE="active",(g=G||(G={})).STATE_HOVER_REVERSE="hover_reverse",g.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",g.STATE_SELECTED_REVERSE="selected_reverse",(f=V||(V={})).Identity="identity",f.Linear="linear",f.Log="log",f.Pow="pow",f.Sqrt="sqrt",f.Symlog="symlog",f.Time="time",f.Quantile="quantile",f.Quantize="quantize",f.Threshold="threshold",f.Ordinal="ordinal",f.Point="point",f.Band="band";let ln={};function ls(t){switch(t){case V.Linear:case V.Log:case V.Pow:case V.Sqrt:case V.Symlog:case V.Time:return!0;default:return!1}}function ll(t){switch(t){case V.Ordinal:case V.Point:case V.Band:return!0;default:return!1}}function la(t,e,i){t8(e)||(e=t,t=0),t8(i)||(i=1);let r=-1,n=0|Math.max(0,Math.ceil((e-t)/i)),s=Array(n);for(;++r<n;)s[r]=t+r*i;return s}Object.values(V).forEach(t=>{ln[t]=!0});let lo=t=>{let e=null,i=null;return(...r)=>(e&&r.every((t,i)=>t===e[i])||(e=r,i=t(...r)),i)};function lh(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function lu(t,e,i=0,r){for(er(r)&&(r=t.length);i<r;){let n=i+r>>>1;lh(t[n],e)>0?r=n:i=n+1}return i}let ld=(t,e)=>lc(0,t.length,i=>e(t[i])),lc=(t,e,i)=>{let r=t,n=e;for(;r<n;){let t=Math.floor((r+n)/2);i(t)>=0?n=t:r=t+1}return r};function lp(t){return t}let lg=t=>t<0?-Math.sqrt(-t):Math.sqrt(t),lf=t=>t<0?-t*t:t*t,lm=t=>-Math.log(-t),ly=t=>-Math.exp(-t),lv=t=>isFinite(t)?Math.pow(10,t):t<0?0:t,lb=t=>10===t?lv:t===Math.E?Math.exp:e=>Math.pow(t,e),l_=t=>t===Math.E?Math.log:10===t?Math.log10:2===t?Math.log2:(t=Math.log(t),e=>Math.log(e)/t),lx=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),lC=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t;function lw(t,e){if(t=Number(t),e=Number(e)-t)return i=>(i-t)/e;let i=Number.isNaN(e)?NaN:.5;return()=>i}function lS(t,e,i){let r,n,s=t[0],l=t[1],a=e[0],o=e[1];return l<s?(r=lw(l,s),n=i(o,a)):(r=lw(s,l),n=i(a,o)),t=>n(r(t))}function lA(t,e,i){let r;return r=1===t?t+2*i:t-e+2*i,t?r>0?r:1:0}function lM(t,e,i,r){return 1===i&&(i=0),lA(t,i,r)*(e/(1-i))}function lk(t,e){let i=(t[1]-t[0])/(e[1]-e[0]),r=t[0]-i*e[0];return[r,i+r]}function lT(t,e,i){let r=Math.min(t.length,e.length)-1,n=Array(r),s=Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)n[l]=lw(t[l],t[l+1]),s[l]=i(e[l],e[l+1]);return function(e){let i=lu(t,e,1,r)-1;return s[i](n[i](e))}}let lR=(t,e)=>{let i=t.slice(),r=0,n=i.length-1,s=i[r],l=i[n];return l<s&&([r,n]=[n,r],[s,l]=[l,s]),i[r]=e.floor(s),i[n]=e.ceil(l),i},lB=(t,e=!1)=>{let i=Math.floor(Math.log10(t)),r=t/Math.pow(10,i);return(e?r<1.5?1:r<3?2:r<7?5:10:r<=1?1:r<=2?2:r<=5?5:10)*Math.pow(10,i)},lP=(t,e)=>{let i,r;return e[0]<e[1]?(i=e[0],r=e[1]):(i=e[1],r=e[0]),Math.min(Math.max(t,i),r)},lE=Math.sqrt(50),lI=Math.sqrt(10),lL=Math.sqrt(2),lF=(t,e,i)=>{let r=1,n=t,s=Math.floor((e-1)/2),l=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?n=0:t<0&&t>=-Number.MIN_VALUE?n=-(e-1):!i&&l<1?r=lW(l).step:(i||l>1)&&(n=Math.floor(t)-s*r),r>0?(t>0?n=Math.max(n,0):t<0&&(n=Math.min(n,-(e-1)*r)),la(0,e).map(t=>n+t*r)):t>0?lD(0,-(e-1)/r,r):lD((e-1)/r,0,r)},lO=lo((t,e,i,r)=>{let n,s,l,a,o=-1;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((n=e<t)&&(s=t,t=e,e=s),!isFinite(a=lN(t,e,i).step))return[];if(a>0){let i=Math.round(t/a),r=Math.round(e/a);for(i*a<t&&++i,r*a>e&&--r,l=Array(s=r-i+1);++o<s;)l[o]=(i+o)*a}else if(a<0&&(null==r?void 0:r.noDecimals)){a=1;let i=Math.ceil(t),r=Math.floor(e);if(!(i<=r))return[];for(l=Array(s=r-i+1);++o<s;)l[o]=i+o}else{let i=Math.round(t*(a=-a)),r=Math.round(e*a);for(i/a<t&&++i,r/a>e&&--r,l=Array(s=r-i+1);++o<s;)l[o]=(i+o)/a}return n&&l.reverse(),l}),lD=(t,e,i)=>{let r,n,s=-1;if(i>0){let l=Math.floor(t/i),a=Math.ceil(e/i);for((l+1)*i<t&&++l,(a-1)*i>e&&--a,n=Array(r=a-l+1);++s<r;)n[s]=(l+s)*i}else{let l=Math.floor(t*(i=-i)),a=Math.ceil(e*i);for((l+1)/i<t&&++l,(a-1)/i>e&&--a,n=Array(r=a-l+1);++s<r;)n[s]=(l+s)/i}return n},lH=(t,e,i)=>{let r,n=t[0],s=t[t.length-1],l=e-t.length;if(s<=0){let e=[];for(r=l;r>=1;r--)e.push(n-r*i);return e.concat(t)}if(n>=0){for(r=1;r<=l;r++)t.push(s+r*i);return t}let a=[],o=[];for(r=1;r<=l;r++)r%2==0?a=[n-Math.floor(r/2)*i].concat(a):o.push(s+Math.ceil(r/2)*i);return a.concat(t).concat(o)},lz=lo((t,e,i,r)=>{let n,s,l;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return lF(t,i,null==r?void 0:r.noDecimals);(n=e<t)&&(l=t,t=e,e=l);let a=lN(t,e,i),o=a.step;if(!isFinite(o))return[];if(o>0){let r=1,{power:n,gap:l}=a,h=10===l?2*10**n:+(10**n);for(;r<=5&&(s=lD(t,e,o)).length>i+1&&i>2;)o+=h,r+=1;i>2&&s.length<i-1&&(s=lH(s,i,o))}else(null==r?void 0:r.noDecimals)&&o<0&&(o=1),s=lD(t,e,o);return n&&s.reverse(),s}),lW=t=>{let e=Math.floor(Math.log(t)/Math.LN10),i=t/10**e,r=1;return i>=lE?r=10:i>=lI?r=5:i>=lL&&(r=2),e>=0?{step:r*10**e,gap:r,power:e}:{step:-(10**-e)/r,gap:r,power:e}};function lN(t,e,i){return lW((e-t)/Math.max(0,i))}function lj(t,e,i){let r;if(i*=1,(t*=1)==(e*=1)&&i>0)return[t];if(i<=0||0==(r=(e-t)/Math.max(1,i-1))||!isFinite(r))return[];let n=Array(i);for(let e=0;e<i;e++)n[e]=t+e*r;return n}function lG(t,e,i){let r,n,s=-1;if(i*=1,(n=(e*=1)<(t*=1))&&(r=t,t=e,e=r),!isFinite(i)||e-t<=i)return[t];let l=Math.floor((e-t)/i+1),a=Array(l);for(;++s<l;)a[s]=t+s*i;return n&&a.reverse(),a}function lV(t,e=10){let i,r,n=0,s=t.length-1,l=t[n],a=t[s],o=10;for(a<l&&(r=l,l=a,a=r,r=n,n=s,s=r);o-- >0;){if((r=lN(l,a,e).step)===i)return t[n]=l,t[s]=a,t;if(r>0)l=Math.floor(l/r)*r,a=Math.ceil(a/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,a=Math.floor(a*r)/r}i=r}}function lZ(t,e){let i=tG(e.forceMin),r=tG(e.forceMax),n=null,s=[],l=null,a=i&&r?t=>t>=e.forceMin&&t<=e.forceMax:i?t=>t>=e.forceMin:r?t=>t<=e.forceMax:null;return i?s[0]=e.forceMin:tG(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(s[0]=e.min),r?s[1]=e.forceMax:tG(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(s[1]=e.max),tG(s[0])&&tG(s[1])?((l=t.slice())[0]=s[0],l[l.length-1]=s[1]):n=tG(s[0])||tG(s[1])?tG(s[0])?"max":"min":"all",{niceType:n,niceDomain:l,niceMinMax:s,domainValidator:a}}let lU=(t,e,i)=>1>Math.abs(e-t)?+i.toFixed(1):Math.round(+i),lK=lo((t,e,i,r,n,s,l)=>{let a=t,o=e,h=o<a;h&&([a,o]=[o,a]);let u,d,c=n(a),p=n(o),g=[];if(!(r%1)&&p-c<i){if(c=Math.floor(c),p=Math.ceil(p),a>0){for(;c<=p;++c)for(u=1;u<r;++u)if(!((d=c<0?u/s(-c):u*s(c))<a)){if(d>o)break;g.push(d)}}else for(;c<=p;++c)for(u=r-1;u>=1;--u)if(!((d=c>0?u/s(-c):u*s(c))<a)){if(d>o)break;g.push(d)}2*g.length<i&&(g=lz(a,o,i))}else g=lz(c,p,Math.min(p-c,i)).map(s);return g=g.filter(t=>0!==t),(null==l?void 0:l.noDecimals)&&(g=Array.from(new Set(g.map(t=>Math.floor(t))))),h?g.reverse():g}),l$=lo((t,e,i,r,n,s)=>{let l=[],a={},o=n(t),h=n(e),u=[];if(Number.isInteger(r))u=lz(o,h,i);else{let t=(h-o)/(i-1);for(let e=0;e<i;e++)u.push(o+e*t)}return u.forEach(i=>{let n=s(i),o=Number.isInteger(r)?lU(t,e,n):lU(t,e,lB(n)),h=lU(t,e,lP(o,[t,e]));a[h]||isNaN(h)||!(u.length>1)||(a[h]=1,l.push(h))}),l}),lY=lo((t,e,i,r,n)=>lj(r(t),r(e),i).map(t=>lB(n(t))));lo((t,e,i,r,n)=>lG(r(t),r(e),i).map(t=>lB(n(t))));class lX{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:t8(this._rangeFactorStart)&&t8(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=lk(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(2===t.length&&t.every(t=>t>=0&&t<=1)&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):t8(this._rangeFactorStart)&&t8(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return er(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&(er(this._rangeFactorEnd)||1===this._rangeFactorEnd)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t,this._rangeFactorEnd=null!=(i=this._rangeFactorEnd)?i:1)),this)}rangeFactorEnd(t,e){var i;return er(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&(er(this._rangeFactorStart)||0===this._rangeFactorStart)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorEnd=t,this._rangeFactorStart=null!=(i=this._rangeFactorStart)?i:0)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);let{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,n=this.range(),s=n[0],l=n[n.length-1],a=Math.min(s,l),o=Math.max(s,l),h=eG(null!=(t=this._fishEyeOptions.focus)?t:0,a,o),u=er(r)?(o-a)*i:r,d=Math.exp(e);d=d/(d-1)*u;let c=e/u;this._fishEyeTransform=t=>{let e=Math.abs(t-h);return e>=u?t:e<=1e-6?h:h+(t-h)*(d*(1-Math.exp(-e*c))/e*.75+.25)}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var i;return null!=(i=null==this?void 0:this[t])?i:e}}function lq(t,e){let i=t.r,r=e.r,n=t.g,s=e.g,l=t.b,a=e.b,o=t.opacity,h=e.opacity;return t=>new e1(Math.round(i*(1-t)+r*t),Math.round(n*(1-t)+s*t),Math.round(l*(1-t)+a*t),o*(1-t)+h*t)}function lJ(t,e){return i=>t*(1-i)+e*i}function lQ(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}RegExp(/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g.source,"g");let{LX:l0}=tH;function l1(t,e){let i,r=typeof e;if(er(e)||"boolean"===r)return()=>e;if("number"===r)return lJ(t,e);if("string"===r){if(i=e0.parseColorString(e)){let e=l0(e0.parseColorString(t),i);return t=>e(t).formatRgb()}return lJ(Number(t),Number(e))}return e instanceof e1?l0(t,e):e instanceof e0?l0(t.color,e.color):e instanceof Date?function(t,e){let i=t.valueOf(),r=e.valueOf(),n=new Date;return t=>(n.setTime(i*(1-t)+r*t),n)}(t,e):lJ(Number(t),Number(e))}function l2(t){return Number(t)}function l3(t,e){let i;return t>e&&(i=t,t=e,e=i),i=>Math.max(t,Math.min(e,i))}class l5 extends lX{constructor(t=lp,e=lp){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=lp,this._piecewise=lS,this._interpolate=l1}calculateVisibleDomain(t){var e;return t8(this._rangeFactorStart)&&t8(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!=(e=this._niceDomain)?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),lJ)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return(null!=(i=this._niceDomain)?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;let r=Array.from(t,l2);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();let i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){let i=Array.from(t);return this._range=i,this._interpolate=lQ,this.rescale(e)}rescale(t){var e;if(t)return this;let i=null!=(e=this._niceDomain)?e:this._domain,r=i.length,n=this._range.length,s=Math.min(r,n);if(r&&r<n&&this._forceAlign){let t=n-r+1,e=i[r-1],l=r>=2?(e-i[r-2])/t:0;for(let n=1;n<=t;n++)i[r-2+n]=e-l*(t-n);s=n}return this._autoClamp&&(this._clamp=l3(i[0],i[s-1])),this._piecewise=s>2?lT:lS,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:lp),this.rescale(i)):this._clamp!==lp}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){let e=this.ticks(t);return(null!=e?e:[]).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return er(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return er(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}class l4 extends l5{constructor(){super(...arguments),this.type=V.Linear}clone(){var t;let e=new l4;return e.domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate),this._niceType&&(e._niceType=this._niceType,e._domainValidator=this._domainValidator,e._niceDomain=null==(t=this._niceDomain)?void 0:t.slice()),e}tickFormat(){return()=>{}}d3Ticks(t=10,e){let i=this.calculateVisibleDomain(this._range);return lO(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if(tQ(null==e?void 0:e.customTicks))return e.customTicks(this,t);if(t8(this._rangeFactorStart)&&t8(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(t,e);let r=null!=(i=this._niceDomain)?i:this._domain,n=this._domain,s=r[0],l=r[r.length-1],a=lz(n[0],n[n.length-1],t,e);if(!a.length)return a;if(this._domainValidator)a=a.filter(this._domainValidator);else if((a[0]!==s||a[a.length-1]!==l)&&this._niceType){let t=r.slice();if("all"===this._niceType?(t[0]=a[0],t[t.length-1]=a[a.length-1],this._niceDomain=t,this.rescale()):"min"===this._niceType&&a[0]!==s?(t[0]=a[0],this._niceDomain=t,this.rescale()):"max"===this._niceType&&a[a.length-1]!==l&&(t[t.length-1]=a[a.length-1],this._niceDomain=t,this.rescale()),"all"!==this._niceType){let e=Math.min(t[0],t[t.length-1]),i=Math.max(t[0],t[t.length-1]);a=a.filter(t=>t>=e&&t<=i)}}return a}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return lj(e[0],e[e.length-1],t)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return lG(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;let n=this._domain,s=[];if(e){let t=lZ(n,e);if(s=t.niceMinMax,this._domainValidator=t.domainValidator,this._niceType=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){let e=lV(n.slice(),t);"min"===this._niceType?e[e.length-1]=null!=(i=s[1])?i:e[e.length-1]:"max"===this._niceType&&(e[0]=null!=(r=s[0])?r:e[0]),this._niceDomain=e,this.rescale()}return this}niceMin(t=10){this._niceType="min";let e=this._domain[this._domain.length-1],i=lV(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";let e=this._domain[0],i=lV(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}function l6(t,e,i=1e-10,r=1e-10){let n=i*Math.max(t,e);return Math.abs(t-e)<=Math.max(r,n)}let l8=Symbol("implicit");class l9 extends lX{specified(t){var e;return t?(this._specified=Object.assign(null!=(e=this._specified)?e:{},t),this):Object.assign({},this._specified)}_getSpecifiedValue(t){if(this._specified)return this._specified[t]}constructor(){super(),this.type=V.Ordinal,this._index=new Map,this._domain=[],this._ordinalRange=[],this._unknown=l8}clone(){let t=(new l9).domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}calculateVisibleDomain(t){return t8(this._rangeFactorStart)&&t8(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:this._domain}scale(t){let e=`${t}`,i=this._getSpecifiedValue(e);if(void 0!==i)return i;let r=this._index.get(e);if(!r){if(this._unknown!==l8)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}let n=this._ordinalRange[(r-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(n):n}invert(t){let e=0;for(;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}domain(t){if(!t)return this._domain.slice();for(let e of(this._domain=[],this._index=new Map,t)){let t=`${e}`;this._index.has(t)||this._index.set(t,this._domain.push(e))}return this}range(t){if(!t)return this._ordinalRange.slice();let e=Array.from(t);return this._ordinalRange=e,this}index(t){var e;return this._index&&null!=(e=this._index.get(`${t}`))?e:-1}}function l7(t,e,i,r){let n=[],s=t;for(;s<=e;)n.push(s),s+=i;return r&&n.reverse(),n}function at(t,e,i,r){let n,s;if(e=Math.floor(+e),t=Math.floor(+t),!(i=Math.floor(+i)))return[];if(t===e)return[t];if(n=e<t){let i=t;t=e,e=i}let l=l3(1,e-t+1)(i);if(s=Math.floor((e-t+1)/l),!r)for(;Math.ceil((e-t+1)/s)>i&&l>1;)l-=1,s=Math.floor((e-t)/l);return l7(t,e,s,n)}class ae extends l9{constructor(t){super(),this.type=V.Band,this._range=[0,1],this._step=void 0,this._bandwidth=void 0,this._isFixed=!1,this._round=!1,this._paddingInner=0,this._paddingOuter=0,this._align=.5,this._unknown=void 0,delete this.unknown,this.rescale(t)}rescale(t,e){if(t)return this;this._wholeRange=null;let i=this._calculateWholeRange(this._range,e),r=super.domain().length,n=i[1]<i[0],s=i[Number(n)-0],l=i[1-Number(n)],a=lA(r,this._paddingInner,this._paddingOuter);return this._step=(l-s)/Math.max(1,a||1),this._round&&(this._step=Math.floor(this._step)),s+=(l-s-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(s=Math.round(s),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:n,start:n?eG(s+this._step*(r-1),i[1],i[0]):eG(s,i[0],i[1]),min:n?i[1]:i[0],max:l,count:r},this.generateFishEyeTransform(),this}scale(t){if(!this._bandRangeState)return;let e=`${t}`,i=this._getSpecifiedValue(e);if(void 0!==i)return i;let r=this._index.get(e);if(!r){if(this._unknown!==l8)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}let{count:n,start:s,reverse:l,min:a,max:o}=this._bandRangeState,h=s+(r-1)%n*(l?-1:1)*this._step;return eG(this._fishEyeTransform?this._fishEyeTransform(h):h,a,o)}_calculateWholeRange(t,e){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){var i,r,n,s,l;let e,a,o;if(t8(this._rangeFactorStart)&&t8(this._rangeFactorEnd)&&2===t.length){let i=lk(t,[this._rangeFactorStart,this._rangeFactorEnd]);e=Math.abs(i[1]-i[0])}else e=Math.abs(t[1]-t[0]);let h=(i=super.domain().length,r=e,n=this._paddingInner,s=this._paddingOuter,l=this._round,a=r/Math.max(1,lA(i,n,s)||1),l&&(a=Math.floor(a)),o=a*(1-n),l&&(o=Math.round(o)),o);h<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):h>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=h,this._isFixed=!1)}if(this.isBandwidthFixed()){let i=lM(super.domain().length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),r=Math.min((t[1]-t[0])/i,1);if(t8(this._rangeFactorStart)&&t8(this._rangeFactorEnd)){let n=this._rangeFactorStart+r<=1,s=this._rangeFactorEnd-r>=0;if("rangeFactorStart"===e&&n?this._rangeFactorEnd=this._rangeFactorStart+r:"rangeFactorEnd"===e&&s?this._rangeFactorStart=this._rangeFactorEnd-r:t[0]<=t[1]?n?this._rangeFactorEnd=this._rangeFactorStart+r:s?this._rangeFactorStart=this._rangeFactorEnd-r:(this._rangeFactorStart=0,this._rangeFactorEnd=r):s?this._rangeFactorStart=this._rangeFactorEnd-r:n?this._rangeFactorEnd=this._rangeFactorStart+r:(this._rangeFactorStart=1-r,this._rangeFactorEnd=1),i>0){let e=t[0]-i*this._rangeFactorStart;this._wholeRange=[e,e+i]}else{let e=t[1]+i*(1-this._rangeFactorEnd);this._wholeRange=[e-i,e]}}else this._rangeFactorStart=0,this._rangeFactorEnd=r,this._wholeRange=[t[0],t[0]+i];return this._wholeRange}return super._calculateWholeRange(t)}calculateWholeRangeSize(){let t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}calculateVisibleDomain(t){let e=this._domain;if(t8(this._rangeFactorStart)&&t8(this._rangeFactorEnd)&&e.length){let i=this._getInvertIndex(t[0]),r=this._getInvertIndex(t[1]);return e.slice(Math.min(i,r),Math.max(i,r)+1)}return e}domain(t,e){return t?(super.domain(t),this.rescale(e)):super.domain()}range(t,e){return t?(this._range=[l2(t[0]),l2(t[1])],this.rescale(e)):this._range}rangeRound(t,e){return this._range=[l2(t[0]),l2(t[1])],this._round=!0,this.rescale(e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return -1===t?e:at(0,e.length-1,t,!1).map(t=>e[t])}tickData(t=10){return this.ticks(t).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0]+this._bandwidth/2)/(this._range[1]-this._range[0])}))}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return at(0,e.length-1,t,!0).filter(t=>t<e.length).map(t=>e[t])}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return(function(t,e,i){let r;if(i=l3(1,(e=Math.floor(+e))-(t=Math.floor(+t))+1)(Math.floor(+i)),r=e<t){let i=t;t=e,e=i}return l7(t,e,i,r)})(0,e.length-1,t).map(t=>e[t])}_getInvertIndex(t){let e=0,i=this.step()/2,r=this.bandwidth()/2,n=this._domain.length,s=this.range(),l=s[0]>s[s.length-1];for(e=0;e<n;e++){var a,o,h,u;let s=this.scale(this._domain[e])+r;if(0===e&&(!l&&!(t>(a=s+i)&&!l6(t,a,void 0,void 0))||l&&!(t<(o=s-i)&&!l6(t,o,void 0,void 0)))||e===n-1)break;if(!(t<(h=s-i)&&!l6(t,h,void 0,void 0))&&!(t>(u=s+i)&&!l6(t,u,void 0,void 0)))break}return e>=0&&e<=n-1?e:n-1}invert(t){return this._domain[this._getInvertIndex(t)]}padding(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}paddingInner(t,e){return void 0!==t?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}paddingOuter(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}step(){return this._step}round(t,e){return void 0!==t?(this._round=t,this.rescale(e)):this._round}align(t,e){return void 0!==t?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}rangeFactor(t,e){return t?(super.rangeFactor(t),this.rescale(e)):super.rangeFactor()}rangeFactorStart(t,e){return er(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this.rescale(e,"rangeFactorStart"))}rangeFactorEnd(t,e){return er(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this.rescale(e,"rangeFactorEnd"))}bandwidth(t,e){return t?("auto"===t?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}maxBandwidth(t,e){return t?(this._maxBandwidth="auto"===t?void 0:t,this.rescale(e)):this._maxBandwidth}minBandwidth(t,e){return t?(this._minBandwidth="auto"===t?void 0:t,this.rescale(e)):this._minBandwidth}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}isBandwidthFixed(){return this._isFixed&&!!this._bandwidth}_isBandwidthFixedByUser(){return this._isFixed&&this._userBandwidth&&tG(this._userBandwidth)}clone(){var t,e,i;return new ae(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth(null!=(t=this._userBandwidth)?t:"auto",!0).maxBandwidth(null!=(e=this._maxBandwidth)?e:"auto",!0).minBandwidth(null!=(i=this._maxBandwidth)?i:"auto")}}class ai{constructor(){this.type=V.Threshold,this._range=[0,1],this._domain=[.5],this.n=1}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}scale(t){return!er(t)&&en(+t)?this._range[lu(this._domain,t,0,this.n)]:this._unknown}invertExtent(t){let e=this._range.indexOf(t);return[this._domain[e-1],this._domain[e]]}domain(t){return t?(this._domain=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._domain.slice()}range(t){return t?(this._range=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._range.slice()}clone(){return(new ai).domain(this._domain).range(this._range).unknown(this._unknown)}}class ar extends l9{range(t){return t?(this._range=t,this._resetRange(),this):super.range()}domain(t){return t?(super.domain(t),this._resetRange(),this):super.domain()}_resetRange(){if(!it(this._range))return void super.range(this._range);let t=e6(this._range,this._domain);super.range(t)}}let an={linear:l4,band:ae,point:class extends ae{constructor(t){super(!1),this.type=V.Point,this._padding=0,this.paddingInner(1,t),this.padding=this.paddingOuter,this.paddingInner=void 0,this.paddingOuter=void 0}},ordinal:l9,threshold:ai,colorOrdinal:ar};function as(t){let e=an[t];return e?new e:null}function al(t,e){var i,r;if("scale"in t&&t.scale)return t6(t.scale)&&(null==e?void 0:e.globalScale)?e.globalScale.registerMarkAttributeScale(t,e.seriesId):t.scale;let n=as(t.type);return n&&(i=n,r=t,i&&r&&(r.domain&&i.domain(r.domain),r.range&&i.range(r.range),r.specified&&i.specified&&i.specified(r.specified),r.clamp&&i.clamp&&i.clamp(r.clamp))),n}function aa(t,e,i){if(!e)return t;let r=e.range(),n=i&&e._calculateWholeRange?e._calculateWholeRange(r):e.range();return Math.min(Math.max(Math.min(n[0],n[n.length-1]),t),Math.max(n[0],n[n.length-1]))}function ao(t,e,i){if(!e)return!0;let r=e.range(),n=(i&&e._calculateWholeRange?e._calculateWholeRange(r):e.range()).map(t=>e.invert(t)),s=Math.min(n[0],n[n.length-1]),l=Math.max(n[0],n[n.length-1]);return Array.isArray(t)?t.every(t=>t>=s&&t<=l):t>=s&&t<=l}function ah(t){return t8(null==t?void 0:t.field)&&t8(null==t?void 0:t.scale)}let au=["linear","radial","conical"],ad={linear:{x0:0,y0:0,x1:1,y1:1},radial:{x0:0,y0:0,x1:1,y1:1,r0:0,r1:1},conical:{x:.5,y:.5,startAngle:0,endAngle:2*Math.PI}},ac={};Object.values(j).forEach(t=>{ac[t]=!0}),j.STATE_HOVER,j.STATE_HOVER_REVERSE,j.STATE_SELECTED,j.STATE_SELECTED_REVERSE,j.STATE_DIMENSION_HOVER,j.STATE_DIMENSION_HOVER_REVERSE;class ap extends s${compile(){}getStateMap(){return this._stateMap}_getDefaultStateMap(){return{}}constructor(t){super(t),this.initStateMap()}initStateMap(t){this._stateMap=null!=t?t:this._getDefaultStateMap()}updateState(t,e){if(t&&(ei(this._stateMap,t),!e))return this.getCompiler().renderNextTick()}}class ag extends ap{getStateInfoList(){return this._stateInfoList}constructor(t,e){super(t),this._stateInfoList=[],this._mark=e}_getDefaultStateMap(){return{markUpdateRank:1}}getStateInfo(t){return this._stateInfoList.find(e=>e.stateValue===t)}addStateInfo(t){if(this.getStateInfo(t.stateValue))return;t.level=t.level||0;let e=!0;for(let i=0;i<this._stateInfoList.length;i++){let r=this._stateInfoList[i].level;if(r&&r>t.level){this._stateInfoList.splice(i,0,t),e=!1;break}}e&&this._stateInfoList.push(t)}_clearStateBeforeSet(t){t.datums=null,t.items=null,t.fields=null,t.filter=null}changeStateInfo(t){let e=this.getStateInfo(t.stateValue);if(e){if(void 0!==t.datums&&(this._clearStateBeforeSet(e),e.datums=t.datums,e.datumKeys=t.datumKeys),void 0!==t.items&&(this._clearStateBeforeSet(e),e.items=t.items),void 0!==t.fields)if(this._clearStateBeforeSet(e),null===t.fields)e.fields=t.fields;else for(let i in e.fields=e.fields||{},t.fields){let r=t.fields[i];e.fields[i]=e.fields[i]||{};let n=e.fields[i];t8(r.domain)&&(n.domain=r.domain),t8(r.type)&&(n.type=r.type)}t.filter&&(this._clearStateBeforeSet(e),e.filter=t.filter)}else this.addStateInfo(t)}clearStateInfo(t){t.forEach(t=>{this.getStateInfo(t)&&this.changeStateInfo({stateValue:t,datumKeys:null,datums:null,fields:null,items:null,filter:null,cache:{}})})}_isMultiMark(){var t;return!this._mark||(t=this._mark.type,sM.includes(t))}checkOneState(t,e,i){var r;let n=!1,s=!1;if(t8(i.datums)&&i.datums.length>0)n=this.checkDatumState(i,e),s=!0;else if(i.items)n=null!=(r=this.checkItemsState(i,t))&&r,s=!0;else if(i.fields)n=this.checkFieldsState(i,e,t),s=!0;else if(!n&&i.filter){let r={mark:this._mark,renderNode:t,type:this._mark.type};n=i.filter(null==e?void 0:e[0],r),s=!0}return s?n?"in":"out":"skip"}checkState(t,e){var i;let r=(null!=(i=t.context.states)?i:[]).filter(t=>!!ac[t]).map(t=>[t,10]);for(let i=0;i<this._stateInfoList.length;i++){let n=this._stateInfoList[i],s=this.checkOneState(t,e,n);"skip"!==s&&"in"===s&&r.push([n.stateValue,n.level])}return r.map(t=>t[0])}checkDatumState(t,e){let i=!1,r=e[0];if(tq(t.datums)){let e=this._isMultiMark(),n=t.datumKeys||Object.keys(t.datums[0]).filter(t=>!t.startsWith(st));i=t.datums.some(t=>e&&tq(null==t?void 0:t.items)?n.every(e=>{var i,n;return(null==(n=null==(i=null==t?void 0:t.items)?void 0:i[0])?void 0:n[e])===(null==r?void 0:r[e])}):n.every(e=>(null==t?void 0:t[e])===(null==r?void 0:r[e])))}else if(e_(t.datums)){let e=t.datumKeys||Object.keys(t.datums).filter(t=>!t.startsWith(st)),n=this._isMultiMark();i=e.every(e=>{var i,s;return n?(null==(i=t.datums.items)?void 0:i[0][e])===r[e]:(null==(s=t.datums)?void 0:s[e])===r[e]})}else i=e===t.datums;return i}checkItemsState(t,e){var i;return null==(i=t.items)?void 0:i.includes(e)}checkFieldsState(t,e,i){var r;let n=!0;for(let s in t.fields){let l=t.fields[s],a=l.type,o=l.domain,h=null==(r=e[0])?void 0:r[s];if(ls(a)&&o.length>1){if(this.checkLinearFieldState(o,s,e,i)){n=!1;break}n=!0}else{if(!o.some(t=>t===h)){n=!1;break}n=!0}}return n}checkLinearFieldState(t,e,i,r){var n;let s=this._isMultiMark()?null==(n=i[0])?void 0:n[e]:i[e];return s<t[0]||s>t[t.length-1]}release(){}}function af(t){return Math.PI/180*t}function am(t){return 180*t/Math.PI}function ay(t,e,i){return e?{x:t.x+e*Math.cos(i),y:t.y+e*Math.sin(i)}:{x:t.x,y:t.y}}function av(t,e={x:0,y:0},i=0,r=2*Math.PI){let{x:n,y:s}=t,{x:l,y:a}=e,o=n-l,h=s-a,u=Math.sqrt(o*o+h*h);if(0===u)return{radius:0,angle:0};o/=u;let d=Math.atan2(h/=u,o);if(d<i)for(;d<=i;)d+=2*Math.PI;if(d>r)for(;d>=r;)d-=2*Math.PI;return{radius:u,angle:d}}function ab(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}var a_=i(33974);class ax extends s${constructor(){super(...arguments),this.id=ey(),this._compiledProductId=null}getProductId(){var t;return null!=(t=this._compiledProductId)?t:this.generateProductId()}compile(t){this._compileProduct(t)}setTransform(t){this._transform=t}runTransforms(t,e){if(!t||!t.length)return e;let i=e;return t.forEach(t=>{var e;i=null==(e=iv.getGrammarTransform(t.type))?void 0:e.transform(t,i)}),i}}class aC extends ax{getProduct(){return this._product||(this._product=this.runTransforms(this._transform,this.getLatestData())),this._product}getDataView(){return this._data}setDataView(t){this._data=t}getLatestData(){var t;return null==(t=this._data)?void 0:t.latestData}constructor(t,e){super(t),this._data=null,this._data=e}removeProduct(){this._product=null,this._prevProduct=null,this._compiledProductId=null}release(){this.removeProduct(),super.release(),this._data=null}addRelatedMark(t){this._relatedMarks||(this._relatedMarks={}),this._relatedMarks[t.id]=t}updateData(t){if(this._compileProduct(),this._relatedMarks){let e=!1;if(Object.keys(this._relatedMarks).forEach(t=>{this._relatedMarks[t]&&(e=!0,this._relatedMarks[t].commit())}),!t&&e)return this.getCompiler().renderNextTick()}}_compileProduct(){this._prevProduct=this._product,this._product=null}generateProductId(){var t;return`${null==(t=this.getDataView())?void 0:t.name}`}}var aw=i(63603);function aS(t,e,i,r,n,s){let l=(e-t)*n+t,a=(i-e)*n+e,o=(r-i)*n+i,h=(a-l)*n+l,u=(o-a)*n+a,d=(u-h)*n+h;s[0]=t,s[1]=l,s[2]=h,s[3]=d,s[4]=d,s[5]=u,s[6]=o,s[7]=r}function aA(t,e){let i=t||e,r=i.length,n=i[r-2],s=i[r-1],l=[];for(let t=0;t<e.length;t+=2)l[t]=n,l[t+1]=s;return l}function aM(t){let e=0,i=0,r=0,n=t.length;for(let s=0,l=n-2;s<n;l=s,s+=2){let n=t[l],a=t[l+1],o=t[s],h=t[s+1],u=n*h-o*a;e+=u,i+=(n+o)*u,r+=(a+h)*u}return 0===e?[t[0]||0,t[1]||0,0]:[i/e/3,r/e/3,e]}function ak(t){let e=new a_.r,i=t.toString();if(!i)return[];e.fromString(i);let r=e.tryBuildCurves();if(!r||0===r.length)return[];let n=[],s=null;s=[];let l=0,a=0,o=0,h=0,u=!0;for(let t=0;t<r.length;t++){let e=r[t];if(u&&(l=e.p0.x,a=e.p0.y,o=l,h=a,s=[l,a],n.push(s),u=!1),e.p1&&e.p2&&e.p3)s.push(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y),o=e.p3.x,h=e.p3.y;else if(e.p1&&e.p2){let t=e.p1.x,i=e.p1.y,r=e.p2.x,n=e.p2.y;s.push(o+2/3*(t-o),h+2/3*(i-h),r+2/3*(t-r),n+2/3*(i-n),r,n),o=r,h=n}else if(e.p1){let t=e.p1.x,i=e.p1.y;1e-10>Math.abs(o-t)&&1e-10>Math.abs(h-i)||s.push(o,h,t,i,t,i),o=t,h=i}if(r.length,t<r.length-1){let e=r[t+1];(Math.abs(o-e.p0.x)>1e-10||Math.abs(h-e.p0.y)>1e-10)&&(u=!0)}}let d=n.filter(t=>t.length>2);return 1===d.length?[d[0]]:d}function aT(t,e){for(let i=0;i<t.length;i++){let r=t[i];for(let t=0;t<r.length;t+=2){let i=r[t],n=r[t+1],s={x:i,y:n};e.transformPoint({x:i,y:n},s),r[t]=s.x,r[t+1]=s.y}}}var aR=i(38705),aB=i(16049),aP=i(45273),aE=i(33049),aI=i(76620),aL=i(10546);function aF(t,e,i){let r,n,s=t/e;t>=e?(n=Math.ceil(Math.sqrt(i*s)),0===(r=Math.floor(i/n))&&(r=1,n=i)):(r=Math.ceil(Math.sqrt(i/s)),0===(n=Math.floor(i/r))&&(n=1,r=i));let l=[];for(let t=0;t<r;t++)l.push(n);let a=i-r*n;if(a>0)for(let t=0;t<a;t+=n)t+n<a?l.push(n):l.push(a-t);return l}let aO=(t,e)=>{let{width:i,height:r}=(0,aL.p)(t.attribute),n=aF(i,r,e),s=[],l=r/n.length;for(let t=0,e=n.length;t<e;t++){let e=n[t],r=i/e;for(let i=0;i<e;i++)s.push({x:0+i*r,y:0+t*l,width:r,height:l})}return s},aD=(t,e)=>{let i=t.getParsedAngle(),r=i.startAngle,n=i.endAngle,s=t.getComputedAttribute("innerRadius"),l=t.getComputedAttribute("outerRadius"),a=Math.abs(r-n),o=Math.abs(l-s),h=aF(a*(s+l)/2,o,e),u=[],d=o/h.length,c=l>=s?1:-1,p=n>=r?1:-1;for(let t=0,e=h.length;t<e;t++){let e=h[t],i=a/e;for(let n=0;n<e;n++)u.push({innerRadius:l-d*t*c,outerRadius:l-d*(t+1)*c,startAngle:r+i*n*p,endAngle:r+i*(n+1)*p})}return u},aH=(t,e)=>{let i=t.getComputedAttribute("startAngle"),r=t.getComputedAttribute("endAngle"),n=t.getComputedAttribute("radius"),s=Math.abs(i-r),l=aF(s*n,n,e),a=[],o=s/l[0],h=n/l.length,u=r>=i?1:-1;for(let t=0,e=l.length;t<e;t++)for(let e=0,r=l[t];e<r;e++)a.push({innerRadius:h*t,outerRadius:h*(t+1),startAngle:i+o*e*u,endAngle:i+o*(e+1)*u});return a},az=(t,e)=>{let i=t.filter(t=>!1!==t.defined&&(0,aP.Z)(t.x)&&(0,aP.Z)(t.y));if(0===i.length)return[];if(1===i.length)return Array(e).fill(0).map(t=>i[0]);let r=[];if(e<=i.length){let t=i.length/e,n=0,s=0;for(;n<e;)r.push(i[Math.floor(s)]),s+=t,n++;return r}let n=e-i.length,s=1/(n/(i.length-1)+1),l=0;for(let e=0,i=t.length;e<i;e++)if(r.push(t[e]),e<i-1){let i=s,a=t[e].x,o=t[e].y,h=t[e+1].x,u=t[e+1].y;for(;i<1&&l<n;)r.push({x:a+(h-a)*i,y:o+(u-o)*i}),i+=s,l+=1}return r},aW=(t,e)=>{var i,r;let n=t.attribute,s=n.points,l=n.segments;s||(s=l.reduce((t,e)=>{var i;return t.concat(null!=(i=e.points)?i:[])},[]));let a=s.filter(t=>!1!==t.defined&&(0,aP.Z)(t.x)&&(0,aP.Z)(t.y));if(!a.length)return[];let o=[];a.forEach(t=>{o.push({x:t.x,y:t.y})});for(let t=a.length-1;t>=0;t--){let e=a[t];o.push({x:null!=(i=e.x1)?i:e.x,y:null!=(r=e.y1)?r:e.y})}let h=[];return aZ(o,e,h),h},aN=(t,e)=>{let i=t.attribute,r=i.points;return r?az(r,e):i.segments?az(i.segments.reduce((t,e)=>{var i;return t.concat(null!=(i=e.points)?i:[])},[]),e):[]},aj=t=>t.map(t=>({x:t.x,y:t.y})),aG=(t,e,i)=>{let r=t.length,n=[];for(let a=0;a<r;a++){var s,l;let o=t[a],h=a===r-1?t[0]:t[a+1],u=(0,aE.Jz)([e.x,e.y],[i.x,i.y],[o.x,o.y],[h.x,h.y]);u&&"boolean"!=typeof u&&n.push({dot:(s=[u[0]-e.x,u[1]-e.x],l=[i.x-e.x,i.y-e.x],s[0]*l[1]-s[1]*l[0]),point:{x:u[0],y:u[1]},edgeIndex:a})}if(n.length<2)return[aj(t),aj(t)];n.sort((t,e)=>t.dot-e.dot);let a=n[0],o=n[n.length-1];a.edgeIndex>o.edgeIndex&&([a,o]=[o,a]);let h=a.point,u=o.point,d=[{x:h.x,y:h.y}];for(let e=a.edgeIndex+1;e<=o.edgeIndex;e++)d.push({x:t[e].x,y:t[e].y});d.push({x:u.x,y:u.y});let c=[{x:u.x,y:u.y}];for(let e=o.edgeIndex+1,i=a.edgeIndex+r;e<=i;e++){let i=t[e%r];c.push({x:i.x,y:i.y})}return c.push({x:h.x,y:h.y}),[d,c]},aV=t=>{let e=new aI.YZ;t.forEach(t=>{e.add(t.x,t.y)});let i=e.width(),r=e.height();if(i>=r){let r=e.x1+i/2;return aG(t,{x:r,y:e.y1},{x:r,y:e.y2})}let n=e.y1+r/2;return aG(t,{x:e.x1,y:n},{x:e.x2,y:n})},aZ=(t,e,i)=>{if(1===e)i.push({points:t});else{let r=Math.floor(e/2),n=aV(t);aZ(n[0],r,i),aZ(n[1],e-r,i)}},aU=(t,e)=>{let i=t.attribute.points;if(!i||!i.length)return[];if(1===e)return[{points:aj(i)}];let r=[];return aZ(i,e,r),r},aK=(t,e)=>{let i=ak(t.getParsedPathShape());if(!i.length||e<0)return[];let r=i.length;if(i.length>=e){let t=[],n=Math.floor(i.length/e);for(let s=0;s<e;s++){let l=i.slice(s*n,s===e-1?r:(s+1)*n);t.push({path:function(t){let e=new a_.r;for(let i=0;i<t.length;i++){let r=t[i];if(r.length>2){e.moveTo(r[0],r[1]);for(let t=2;t<r.length;t+=6)e.bezierCurveTo(r[t],r[t+1],r[t+2],r[t+3],r[t+4],r[t+5])}}return e}(l)})}return t}let n=[],s=Math.floor(e/r),l=e;for(let t=0;t<r;t++){let e=[];for(let r=2,n=i[t].length;r<n;r+=2)e.push({x:i[0][r],y:i[0][r+1]});aZ(e,t===r-1?l:s,n),l-=s}return n};var a$=i(17209),aY=i(35652),aX=i(31535),aq=i(43682);let aJ={duration:1e3,easing:"quadInOut"},aQ=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","scrollX","scrollY"],a0=t=>aQ.includes(t),a1=(t,e,i)=>{t.forEach(t=>{if(Number.isFinite(t.to))e[t.key]=t.from+(t.to-t.from)*i;else if("fill"===t.key||"stroke"===t.key){let r=(0,aw.BM)(t.from,t.to,i,!1);r&&(e[t.key]=r)}})},a2=(t,e,i)=>{let r=[],n=[];e.clear();for(let s=0;s<t.length;s++){let l=t[s],a=l.from,o=l.to,h=l.rotation*i,u=l.fromCp,d=l.toCp,c=Math.sin(h),p=Math.cos(h);n[0]=u[0]+(d[0]-u[0])*i,n[1]=u[1]+(d[1]-u[1])*i;for(let t=0;t<a.length;t+=2){let e=a[t],s=a[t+1],l=e*(1-i)+o[t]*i,h=s*(1-i)+o[t+1]*i;r[t]=l*p-h*c+n[0],r[t+1]=l*c+h*p+n[1]}let g=r[0],f=r[1];e.moveTo(g,f);for(let t=2;t<a.length;t+=6){let i=r[t],n=r[t+1],s=r[t+2],l=r[t+3],a=r[t+4],o=r[t+5];g===i&&f===n&&s===a&&l===o?e.lineTo(a,o):e.bezierCurveTo(i,n,s,l,a,o),g=a,f=o}}},a3=(t,e,i)=>{let r=t?ak(t):[],n=ak(e);i&&r&&(i.fromTransform&&aT(r,i.fromTransform.clone().getInverse()),aT(r,i.toTransfrom));let[s,l]=function(t,e){let i,r,n=[],s=[];for(let l=0;l<Math.max(t.length,e.length);l++){let a,o,h=t[l],u=e[l];h?u?([a,o]=function(t,e){let i=t.length,r=e.length;if(i===r)return[t,e];let n=[],s=[],l=i<r?t:e,a=Math.min(i,r),o=Math.abs(r-i)/6,h=Math.ceil(o/((a-2)/6)),u=[l[0],l[1]],d=o;for(let t=2;t<a;t+=6){let e=l[t-2],i=l[t-1],r=l[t],a=l[t+1],o=l[t+2],c=l[t+3],p=l[t+4],g=l[t+5];if(d<=0){u.push(r,a,o,c,p,g);continue}let f=Math.min(d,h)+1;for(let t=1;t<=f;t++){let l=t/f;aS(e,r,o,p,l,n),aS(i,a,c,g,l,s),e=n[3],i=s[3],u.push(n[1],s[1],n[2],s[2],e,i),r=n[5],a=s[5],o=n[6],c=s[6]}d-=f-1}return l===t?[u,e]:[t,u]}(h,u),i=a,r=o):(o=aA(r,h),a=h):(a=aA(i,u),o=u),n.push(a),s.push(o)}return[n,s]}(r,n);return t?function(t,e,i,r){let n,s=[];for(let i=0;i<t.length;i++){let l=t[i],a=e[i],o=aM(l),h=aM(a);null==n&&(n=o[2]<0!=h[2]<0);let u=[],d=[],c=0,p=1/0,g=[],f=l.length;n&&(l=function(t){let e=[],i=t.length;for(let r=0;r<i;r+=2)e[r]=t[i-r-2],e[r+1]=t[i-r-1];return e}(l));let m=6*function(t,e,i,r){let n=(t.length-2)/6,s=1/0,l=0,a=t.length,o=a-2;for(let h=0;h<n;h++){let n=6*h,u=0;for(let s=0;s<a;s+=2){let l=0===s?n:(n+s-2)%o+2,a=t[l]-i[0],h=t[l+1]-i[1],d=e[s]-r[0]-a,c=e[s+1]-r[1]-h;u+=d*d+c*c}u<s&&(s=u,l=h)}return l}(l,a,o,h),y=f-2;for(let t=0;t<y;t+=2){let e=(m+t)%y+2;u[t+2]=l[e]-o[0],u[t+3]=l[e+1]-o[1]}u[0]=l[m]-o[0],u[1]=l[m+1]-o[1];{let t=r/10;for(let e=-r/2;e<=r/2;e+=t){let t=Math.sin(e),i=Math.cos(e),r=0;for(let e=0;e<l.length;e+=2){let n=u[e],s=u[e+1],l=a[e]-h[0],o=a[e+1]-h[1],d=l*i-o*t,c=l*t+o*i;g[e]=d,g[e+1]=c;let p=d-n,f=c-s;r+=p*p+f*f}if(r<p){p=r,c=e;for(let t=0;t<g.length;t++)d[t]=g[t]}}}s.push({from:u,to:d,fromCp:o,toCp:h,rotation:-c})}return s}(s,l,10,Math.PI):l.map((t,e)=>({from:s[e],to:t,fromCp:[0,0],toCp:[0,0],rotation:0}))},a5=["fill","fillOpacity","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","lineDashOffset"],a4=(t,e)=>{if(!t||!e)return null;let i=[],r=!1;return Object.keys(t).forEach(n=>{if(!a5.includes(n))return;let s=e[n];if(!(0,aY.Z)(s)&&!(0,aY.Z)(t[n])&&s!==t[n]){if("fill"===n||"stroke"===n){let e=t=>"string"==typeof t?aR.VH.Get(t,aR.Mr.Color255):t;i.push({from:(0,aX.Z)(t[n])?t[n].map(e):e(t[n]),to:(0,aX.Z)(s)?s.map(e):e(s),key:n})}else i.push({from:t[n],to:s,key:n});r=!0}}),r?i:null};class a6 extends aq.rd{constructor(t,e,i){super({},{},e,i),this.morphingData=t.morphingData,this.otherAttrs=t.otherAttrs,this.saveOnEnd=t.saveOnEnd}getEndProps(){return{}}onBind(){this.target.createPathProxy(),this.onUpdate(!1,0,this.target.attribute)}onEnd(){}onUpdate(t,e,i){let r=this.target,n="function"==typeof r.pathProxy?r.pathProxy(r.attribute):r.pathProxy;a2(this.morphingData,n,e),this.otherAttrs&&this.otherAttrs.length&&a1(this.otherAttrs,i,e),this.target.setAttributes(i),t&&!this.saveOnEnd&&(this.target.pathProxy=null)}}let a8=(t,e,i,r)=>{var n,s,l;if(t&&(!t.valid||!t.toCustomPath))return __DEV__&&console.error(t," is not validate"),null;if(!e.valid||!e.toCustomPath)return __DEV__&&console.error(e," is not validate"),null;let a=null==t?void 0:t.globalTransMatrix;r&&a&&(a=r.clone().multiply(a.a,a.b,a.c,a.d,a.e,a.f));let o=a3(null==(n=null==t?void 0:t.toCustomPath)?void 0:n.call(t),e.toCustomPath(),{fromTransform:a,toTransfrom:e.globalTransMatrix}),h=a4(null==t?void 0:t.attribute,e.attribute),u=e.animate(i);(null==i?void 0:i.delay)&&u.wait(i.delay);let d=new a6({morphingData:o,otherAttrs:h},null!=(s=null==i?void 0:i.duration)?s:aJ.duration,null!=(l=null==i?void 0:i.easing)?l:aJ.easing);return u.play(d),u},a9=(t,e,i)=>{var r;let n=e.filter(t=>t&&t.toCustomPath&&t.valid);n.length||__DEV__&&console.error(n," is not validate"),t.valid&&t.toCustomPath||__DEV__&&console.error(t," is not validate");let s=("clone"===(null==i?void 0:i.splitPath)?oi:null!=(r=null==i?void 0:i.splitPath)?r:or)(t,n.length,!1),l=null==i?void 0:i.onEnd,a=n.length,o=()=>{0==--a&&l&&l()};n.forEach((e,r)=>{var l;let a=s[r],h=(null!=(l=null==i?void 0:i.delay)?l:0)+((null==i?void 0:i.individualDelay)?i.individualDelay(r,n.length,a,e):0);a8(a,e,Object.assign({},i,{onEnd:o,delay:h}),t.globalTransMatrix)})};class a7 extends aq.rd{constructor(t,e,i){super({},{},e,i),this.morphingData=t.morphingData,this.otherAttrs=t.otherAttrs}getEndProps(){return{}}onBind(){this.addPathProxy()}addPathProxy(){this.target.shadowRoot.forEachChildren(t=>{t.createPathProxy()}),this.onUpdate(!1,0,this.target.attribute)}clearPathProxy(){this.target.shadowRoot.forEachChildren(t=>{t.pathProxy=null})}onEnd(){}onUpdate(t,e,i){this.target.shadowRoot.forEachChildren((t,i)=>{var r;a2(this.morphingData[i],"function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy,e),(null==(r=this.otherAttrs)?void 0:r[i])&&this.otherAttrs[i].length&&a1(this.otherAttrs[i],t.attribute,e)}),t&&(this.clearPathProxy(),this.morphingData=null)}}let ot=t=>{let e={};return Object.keys(t).forEach(i=>{a0(i)||(e[i]=t[i])}),e},oe=(t,e,i)=>{let r=ot(t.attribute),n=t.attachShadow();if(e.length)n.setTheme({[e[0].type]:r}),e.forEach(t=>{t.setAttributes({pickable:!1}),n.appendChild(t)});else{let s=t.AABBBounds,l=s.width(),a=s.height();n.setTheme({rect:r}),Array(i).fill(0).forEach(t=>{let i=aB.w.graphicService.creator.rect({x:0,y:0,width:l,height:a,pickable:!1});n.appendChild(i),e.push(i)})}},oi=(t,e,i)=>{let r=[],n=i?null:ot(t.attribute),s=t.toCustomPath();for(let t=0;t<e;t++){let t={path:(new a_.r).fromCustomPath2D(s)};r.push(aB.w.graphicService.creator.path(i?t:Object.assign({},n,t)))}return i&&oe(t,r,e),r},or=(t,e,i)=>{let r=[],n=i?null:ot(t.attribute);if("rect"===t.type)aO(t,e).forEach(t=>{r.push(aB.w.graphicService.creator.rect(i?t:Object.assign({},n,t)))});else if("arc"===t.type)aD(t,e).forEach(t=>{r.push(aB.w.graphicService.creator.arc(i?t:Object.assign({},n,t)))});else if("circle"===t.type)aH(t,e).forEach(t=>{r.push(aB.w.graphicService.creator.arc(i?t:Object.assign({},n,t)))});else if("line"===t.type){let s=aN(t,e),l={size:10,symbolType:"circle"};s.forEach(t=>{r.push(aB.w.graphicService.creator.symbol(i?Object.assign({},t,l):Object.assign({},n,t,l)))})}else"polygon"===t.type?aU(t,e).forEach(t=>{r.push(aB.w.graphicService.creator.polygon(i?t:Object.assign({},n,t)))}):"area"===t.type?aW(t,e).forEach(t=>{r.push(aB.w.graphicService.creator.polygon(i?t:Object.assign({},n,t)))}):"path"===t.type&&aK(t,e).forEach(t=>{"path"in t?r.push(aB.w.graphicService.creator.path(i?t:Object.assign({},n,t))):r.push(aB.w.graphicService.creator.polygon(i?t:Object.assign({},n,t)))});return i&&oe(t,r,e),r},on=(t,e,i)=>{var r,n,s;let l=t.filter(t=>t.toCustomPath&&t.valid);l.length||__DEV__&&console.error(t," is not validate"),e.valid&&e.toCustomPath||__DEV__&&console.error(e," is not validate");let a=("clone"===(null==i?void 0:i.splitPath)?oi:null!=(r=null==i?void 0:i.splitPath)?r:or)(e,l.length,!0),o=e.attribute;e.setAttribute("visible",!1);let h=l.map((t,e)=>a3(t.toCustomPath(),a[e].toCustomPath(),{fromTransform:t.globalTransMatrix,toTransfrom:a[e].globalTransMatrix})),u=l.map((t,e)=>a4(t.attribute,o));if(null==i?void 0:i.individualDelay){let r=i.onEnd,n=l.length,s=()=>{0==--n&&(e.setAttributes({visible:!0,ratio:null},!1,{type:a$.Gk.ANIMATE_END}),e.detachShadow(),r&&r())};a.forEach((e,r)=>{var n,a,o;let d=(null!=(n=i.delay)?n:0)+i.individualDelay(r,l.length,t[r],e),c=e.animate(Object.assign({},i,{onEnd:s}));c.wait(d),c.play(new a6({morphingData:h[r],saveOnEnd:!0,otherAttrs:u[r]},null!=(a=i.duration)?a:aJ.duration,null!=(o=i.easing)?o:aJ.easing))})}else{let t=null==i?void 0:i.onEnd,r=i?Object.assign({},i):{};r.onEnd=()=>{e.setAttribute("visible",!0,!1,{type:a$.Gk.ANIMATE_END}),e.detachShadow(),t&&t()};let l=e.animate(r);(null==i?void 0:i.delay)&&l.wait(i.delay),l.play(new a7({morphingData:h,otherAttrs:u},null!=(n=null==i?void 0:i.duration)?n:aJ.duration,null!=(s=null==i?void 0:i.easing)?s:aJ.easing))}},os=(t,e,i,r)=>"function"==typeof t?t(e,i,r):t,ol=(t,e,i,r,n)=>{var s;let l={prev:t.map(t=>{var e,i;return null==(i=null==(e=t.context)?void 0:e.data)?void 0:i[0]}),next:e.map(t=>{var e,i;return null==(i=null==(e=t.context)?void 0:e.data)?void 0:i[0]})},a={prev:t.slice(),next:e.slice()},o=null!=(s=i.animation)?s:{},h=o.easing,u=os(o.delay,n,l,a),d=os(o.duration,n,l,a),c=os(o.oneByOne,n,l,a),p=os(o.splitPath,n,l,a),g=en(c)&&c>0?t=>tG(c)?t*c:!0===c?t*d:0:void 0;1!==t.length&&0!==t.length||1!==e.length?1===t.length&&e.length>1?a9(t[0],e,{delay:u,duration:d,easing:h,onEnd:r,individualDelay:g,splitPath:p}):t.length>1&&1===e.length&&on(t,e[0],{delay:u,duration:d,easing:h,onEnd:r,individualDelay:g,splitPath:p}):a8(t[0],e[0],{delay:u,duration:d,easing:h,onEnd:r})},oa=(t,e)=>{let i=Math.floor(t.length/e);return Array(e).fill(0).map((r,n)=>t.slice(i*n,n===e-1?t.length:i*(n+1)))},oo=t=>{let e=t.getMarkConfig();t8(e.morphElementKey)&&t.getGraphics().forEach(t=>{var i,r;let n=null==(r=null==(i=t.context)?void 0:i.data)?void 0:r[0];n&&(t.context.morphKey=n[e.morphElementKey])})},oh=(t,e,i={})=>{let r=[],n=[];t.forEach(t=>{oo(t),r.push(...t.getGraphics())}),e.forEach(t=>{oo(t),n.push(...t.getGraphics())});let s=t=>{var e,i,r;return null!=(i=null==(e=t.context)?void 0:e.morphKey)?i:null==(r=t.context)?void 0:r.key},l=new Map,a=new Map;if(r.forEach(t=>{let e=s(t);e&&(l.has(e)||l.set(e,[]),l.get(e).push(t))}),n.forEach(t=>{let e=s(t);e&&(a.has(e)||a.set(e,[]),a.get(e).push(t))}),l.size!==a.size||!Array.from(l.keys()).every(t=>a.has(t)))return!1;let o=[...new Set([...l.keys()].filter(t=>a.has(t)))],h=[...a.keys()].filter(t=>!l.has(t)),u=0,d=()=>{0==(u-=1)&&e.forEach(t=>{})};return h.forEach(t=>{ol([],a.get(t),i,d,{}),u+=1}),o.forEach(t=>{let e=l.get(t),r=a.get(t),n=Math.min(e.length,r.length);if(n>0){let t=oa(e,n),s=oa(r,n);for(let e=0;e<n;e++)ol(t[e],s[e],i,d,{}),u+=1}}),0===u&&d(),!0};var ou=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class od extends ax{commit(t,e){e&&this.getMarks().length>0&&this.getMarks().forEach(t=>t.commit(!1,e)),this._isCommited=!0,t&&this.getCompiler().renderNextTick()}uncommit(){this._isCommited=!1}isCommited(){return this._isCommited}getMarkConfig(){return this._markConfig}setMarkConfig(t){Object.keys(t).forEach(e=>{this._markConfig[e]=t[e]})}getVisible(){return this._visible}setVisible(t){this._visible=t}getUserId(){return this._userId}setUserId(t){t8(t)&&(this._userId=t)}getDataView(){var t;return null==(t=this._data)?void 0:t.getDataView()}setDataView(t){er(this._data)&&this.initMarkData(this._option),this._data.setDataView(t)}getData(){return this._data}setData(t){this._data=t,t&&t.addRelatedMark(this)}hasState(t){return t in this.state.getStateMap()}getState(t){return this.state.getStateMap()[t]}getAnimationConfig(){return this._animationConfig}setAnimationConfig(t){let e="group"===this.type?{selfOnly:!0}:{},i=t=>{var i;let r=null!=(i=t.options)?i:{};return Object.assign(Object.assign(Object.assign({},e),t),{options:(t,e,i)=>{var n,s;let l="function"==typeof r?r(t,e,i):r;if(e&&e.context&&e.context.compiler&&t8(e.context.modelId)){let t=null==(n=e.context.compiler.getChart())?void 0:n.getModelById(e.context.modelId);return Object.assign(Object.assign({},l),{layoutRect:null==(s=null==t?void 0:t.getLayoutRect)?void 0:s.call(t)})}return Object.assign({},l)}})},r={};Object.keys(t).forEach(e=>{let n=t[e];tq(n)?r[e]=n.map(i):t8(n)&&(r[e]=i(n))}),this._animationConfig=r}disableAnimationByState(t){let e=ed(t);this._disabledAnimationStates=[...new Set([...this._disabledAnimationStates,...e])]}enableAnimationByState(t){let e=ed(t);this._disabledAnimationStates=this._disabledAnimationStates.filter(t=>!e.includes(t))}setSkipBeforeLayouted(t){this._skipBeforeLayouted=t}setGroupKey(t){this._groupKey=t}getProduct(){return this._product}initMarkData(t){this._data=new aC(t),this._data.addRelatedMark(this)}_compileProduct(t){this.commit(),this._context=null==t?void 0:t.context;let e=this.getProduct();if(this._visible){if(t8(e))t.group&&e.parent!==t.group&&t.group.appendChild(e);else{if(!this.getCompiler().isInited)return;this._initProduct(null==t?void 0:t.group)}er(this._product)||(this.compileData(),this.compileState(),this.compileEncode())}else t8(e)&&this.removeProduct()}_initProduct(t){var e;if(!this.getStage())return;let i=this.getProductId();this._product=(0,n9.sS)("group"!==this.type?{pickable:!1,zIndex:this._markConfig.zIndex,overflow:this._markConfig.overflow}:{}),this._product.name=i,this._product.mark=this,(null!=t?t:null==(e=this.getCompiler())?void 0:e.getRootGroup()).appendChild(this._product),this._compiledProductId=i}generateProductId(){return this._userId?`${this._userId}`:`${this.name}_${this.id}`}layout(t){}compileData(){er(this._data)||this._data.compile()}compileEncode(){}compileState(){}compileAnimation(){}compileContext(t){this._context=Object.assign({markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId},t)}getContext(){return this._context}compileTransform(){}updateState(t,e){return this.commit(),this.state.updateState(t,e)}getMarks(){return[]}runAnimationByState(t){}stopAnimationByState(t){}pauseAnimationByState(t){}resumeAnimationByState(t){}removeProduct(){this._product&&this._product.parent&&this._product.parent.removeChild(this._product),this._product=null,this._compiledProductId=null}release(){this.state.release(),super.release(),this._lastMark=null}setSimpleStyle(t){this._simpleStyle=t}getSimpleStyle(){return this._simpleStyle}constructor(t,e){var i;super(e),this.type=void 0,this.name="mark",this._markConfig={zIndex:H.Mark,morph:!1},this._visible=!0,this.stateStyle={},this._unCompileChannel={},this._disabledAnimationStates=[],this._skipBeforeLayouted=!1,this._extensionChannel={},this._computeExChannel={},this._graphicMap=new Map,this._graphics=[],this._getEncoderOfStyle=(t,e)=>{if(e&&t){let i={};return Object.keys(e).forEach(e=>{this._unCompileChannel[e]||(i[e]=this._computeAttribute(e,t))}),i}return null},this._setGraphicFromMarkConfig=t=>{let{setCustomizedShape:e,graphicName:i}=this._markConfig;e&&(t.pathProxy=i=>e(t.context.data,i,new a_.r)),i&&(tQ(i)?t.name=i(t):t.name=i)},this._setStateOfGraphic=t=>{t.clearStates(),t.stateProxy=null,t.context.diffState!==N.enter&&t.context.diffState!==N.update||(t.stateProxy=(e,i)=>{var r;return this._runEncoderOfGraphic(null==(r=this._encoderOfState)?void 0:r[e],t)},t.context.states&&t.useStates(t.context.states))},this.name=t,this.model=e.model,this.key=e.key,this.state=new ag(e,this),this._attributeContext=e.attributeContext,null==(i=e.map)||i.set(this.id,this)}created(){this._initStyle()}initStyleWithSpec(t){t&&(t8(t.id)&&(this._userId=t.id),tX(t.interactive)&&(this._markConfig.interactive=t.interactive),t8(t.zIndex)&&(this._markConfig.zIndex=t.zIndex),tX(t.visible)&&this.setVisible(t.visible),this._markConfig.setCustomizedShape=t.customShape,this._stateSort=t.stateSort,this._initSpecStyle(t))}_transformStyleValue(t,e){if(t.scale){let i=t.scale,r=i.range();return i.range(r.map(e)),t}return"function"==typeof t?(...i)=>e(t(...i)):e(t)}convertAngleToRadian(t){return this._transformStyleValue(t,af)}isUserLevel(t){return[W.User_Mark,W.User_Series,W.User_Chart,W.User_SeriesStyle].includes(t)}setStyle(t,e="normal",i=0){if(er(t))return;void 0===this.stateStyle[e]&&(this.stateStyle[e]={});let r=this.isUserLevel(i);Object.keys(t).forEach(n=>{let s=t[n];er(s)||(s=this._filterAttribute(n,s,e,i,r),this.setAttribute(n,s,e,i))})}getStyle(t,e="normal"){var i;return null==(i=this.stateStyle[e][t])?void 0:i.style}_filterAttribute(t,e,i,r,n){let s=this._styleConvert(e);if(n)switch(t){case"angle":s=this.convertAngleToRadian(s);break;case"innerPadding":case"outerPadding":s=this._transformStyleValue(s,t=>-t);break;case"curveType":s=this._transformStyleValue(s,t=>{var e;return e=this._option.model.direction,"monotone"===t?"horizontal"===e?"monotoneY":"monotoneX":t})}return s}setReferer(t,e,i){var r;if(t)if(e&&i){let n=null!=(r=this.stateStyle[i])?r:{[e]:{}};this.stateStyle[i][e]=Object.assign(Object.assign({},n[e]),{referer:t})}else Object.entries(this.stateStyle).forEach(([e,i])=>{Object.entries(i).forEach(([i,r])=>{this.stateStyle[e][i].referer=t})})}setPostProcess(t,e,i="normal"){var r;(null==(r=this.stateStyle[i])?void 0:r[t])&&(this.stateStyle[i][t].postProcess=e)}getAttribute(t,e,i="normal"){return this._computeAttribute(t,i)(e)}getAttributesOfState(t,e="normal"){let i=this.stateStyle[e];if(i){let r={};return Object.keys(i).forEach(i=>{this._unCompileChannel[i]||(r[i]=this._computeAttribute(i,e)(t))}),r}}setAttribute(t,e,i="normal",r=0){var n;void 0===this.stateStyle[i]&&(this.stateStyle[i]={}),void 0===this.stateStyle[i][t]&&(this.stateStyle[i][t]={level:r,style:e,referer:void 0});let s=null==(n=this.stateStyle[i][t])?void 0:n.level;t8(s)&&s<=r&&ir(this.stateStyle[i][t],{style:e,level:r}),"normal"!==i&&t in this._extensionChannel&&this._extensionChannel[t].forEach(t=>{void 0===this.stateStyle[i][t]&&(this.stateStyle[i][t]=this.stateStyle.normal[t])})}_getDefaultStyle(){return{visible:!0,x:0,y:0}}_styleConvert(t){if(!t)return t;if(ln[t.type]||t.scale){let e=al(t,{globalScale:this._option.globalScale,seriesId:this._option.seriesId});if(e)return{scale:e,field:t.field,changeDomain:t.changeDomain}}return t}_computeAttribute(t,e){var i;let r=null==(i=this.stateStyle[e])?void 0:i[t];r||(r=this.stateStyle.normal[t]);let n=this._computeStateAttribute(r,t,e),s=tQ(null==r?void 0:r.postProcess),l=t in this._computeExChannel;if(s&&l){let i=this._computeExChannel[t];return s=>{let l=n(s);return l=r.postProcess(l,s,this._attributeContext,this.getDataView()),i(t,s,e,l)}}if(s)return t=>r.postProcess(n(t),t,this._attributeContext,this.getDataView());if(l){let i=this._computeExChannel[t];return r=>i(t,r,e,n(r))}return n}_computeStateAttribute(t,e,i){var r;return t?t.referer?t.referer._computeAttribute(e,i):t.style?"function"==typeof t.style?e=>t.style(e,this._attributeContext,{mark:this},this.getDataView()):au.includes(t.style.gradient)?this._computeGradientAttr(t.style):["outerBorder","innerBorder"].includes(e)?this._computeBorderAttr(t.style):ln[null==(r=t.style.scale)?void 0:r.type]?e=>{let i=e;return"series"===this.model.modelType&&this.model.getMarkData&&(i=this.model.getMarkData(e)),t.style.scale.scale(i[t.style.field])}:e=>t.style:e=>t.style:t=>{}}_initStyle(){let t=this._getDefaultStyle();this.setStyle(t,"normal",0)}_initSpecStyle(t){t.style&&this.setStyle(t.style,"normal",W.User_Mark);let e=t.state;e&&Object.keys(e).forEach(t=>{let i=e[t];if("style"in i){let e=i.style,r={stateValue:t};"level"in i&&(r.level=i.level),"filter"in i&&(r=tQ(i.filter)?Object.assign({filter:i.filter},r):Object.assign(Object.assign({},i.filter),r)),this.state.addStateInfo(r),this.setStyle(e,t,W.User_Mark)}else this.setStyle(i,t,W.User_Mark)})}_computeGradientAttr(t){var e,i;let{gradient:r,scale:n,field:s}=t,l=ou(t,["gradient","scale","field"]),a=n,o=s;if(!(n&&s||"series"!==this.model.modelType)){let{scale:t,field:e}=this.model.getColorAttribute();n||(a=t),o||(o=e)}let h=e6(e4(this.model.getColorScheme(),"series"===this.model.modelType?null==(i=(e=this.model).getSpec)?void 0:i.call(e):void 0),this.model.getDefaultColorDomain()),u=Object.assign(Object.assign({},ad[r]),l);return t=>{let e={},i=this.getDataView();return Object.keys(u).forEach(r=>{let n=u[r];"stops"===r?e.stops=n.map(e=>{let{opacity:r,color:n,offset:s}=e,l=null!=n?n:null==a?void 0:a.scale(t[o]);return tQ(n)&&(l=n(t,this._attributeContext,i)),t8(r)&&(l=e0.SetOpacity(l,r)),{offset:tQ(s)?s(t,this._attributeContext,i):s,color:l||h[0]}}):tQ(n)?e[r]=n(t,this._attributeContext,i):e[r]=n}),e.gradient=r,e}}_computeBorderAttr(t){let{scale:e,field:i}=t,r=ou(t,["scale","field"]);return t=>{var n,s,l;let a={};if(Object.keys(r).forEach(e=>{let i=r[e];tQ(i)?a[e]=i(t,this._attributeContext,this.getDataView()):a[e]=i}),"stroke"in a)au.includes(null==(l=r.stroke)?void 0:l.gradient)&&(a.stroke=this._computeGradientAttr(r.stroke)(t));else{let r=e6(e4(this.model.getColorScheme(),"series"===this.model.modelType?null==(s=(n=this.model).getSpec)?void 0:s.call(n):void 0),this.model.getDefaultColorDomain()),l=e,o=i;if(!(e&&i||"series"!==this.model.modelType)){let{scale:i,field:n}=this.model.getColorAttribute();e||(l=i),o||(o=n),a.stroke=(null==l?void 0:l.scale(t[o]))||r[0]}}return a}}_getDataByKey(t){return sk(t,(t,e)=>{var i;return`${this._groupKeyGetter(t)}_${null!=(i=this._keyGetter(t))?i:e}`})}_getCommonContext(){return{compiler:this.getCompiler(),markType:this.type,markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId}}prepareMorph(t){this._lastMark=t}reuse(t){this.type===t.type&&(this._product=t.getProduct(),this._graphics=t.getGraphics(),this._graphicMap=t._graphicMap,this._graphicMap.forEach(t=>{t.context=Object.assign(Object.assign({},t.context),this._getCommonContext())}),this._dataByKey=t._dataByKey,this._prevDataByKey=t._prevDataByKey,this.needClear=t.needClear)}_parseProgressiveContext(t){let e=this._markConfig.progressiveStep>0&&this._markConfig.progressiveThreshold>0&&this._markConfig.progressiveStep<this._markConfig.progressiveThreshold,i=this._markConfig.large&&this._markConfig.largeThreshold>0&&t.length>=this._markConfig.largeThreshold;if(e){let e=this._dataByGroup;return e&&e.keys&&e.keys.some(t=>e.data.get(t).length>this._markConfig.progressiveThreshold)?{large:i,progressive:{data:t,step:this._markConfig.progressiveStep,currentIndex:0,totalStep:e.keys.reduce((t,i)=>Math.max(Math.ceil(e.data.get(i).length/this._markConfig.progressiveStep),t),1),groupedData:e.data}}:{large:i}}return{large:i}}getGraphics(){return this._graphics}_createGraphic(t={}){return iv.createGraphicComponent(this.type,t)}_runGroupData(t){this._keyGetter=tQ(this.key)?this.key:t8(this.key)?t=>null==t?void 0:t[this.key]:t=>null==t?void 0:t[ss],this._groupKeyGetter=t8(this._groupKey)?t=>`${null==t?void 0:t[this._groupKey]}`:()=>"key",this._dataByGroup=sk(t,this._groupKeyGetter)}createAnimationStateList(t,e){var i;let r=e[t];return r&&Array.isArray(r)&&(r=1===r.length?r[0]:r),Array.isArray(r)?r.map((t,e)=>{var i;return Object.assign(Object.assign({},t),{priority:null!=(i=t.priority)?i:1/0})}):r?Object.assign(Object.assign({},r),{priority:"normal"===t?null!=(i=r.priority)?i:1/0:r.priority}):r}tryRunMorphing(t){if(this._lastMark){t.forEach(t=>{"appear"!==t.context.animationState&&"enter"!==t.context.animationState||t.setAttributes(t.getAttributes(!0))});let e=oh([this._lastMark],[this],{});return this._lastMark=null,e}return!1}_runStateAnimation(t){var e,i;if(!this._animationConfig||0===t.length||this.tryRunMorphing(t))return;let r=this.getAnimationConfig();if(null!=(e=this._markConfig.useSequentialAnimation)&&e&&this._runSequentialAnimations)return void this._runSequentialAnimations(t);let n=t.every(t=>"appear"===t.context.animationState),s=this.createAnimationStateList("appear",r);if(n&&this._product){let t=s?["appear"]:[],e=s?[{name:"appear",animation:s}]:[];if(r.normal){t.push("normal");let i={name:"normal",animation:this.createAnimationStateList("normal",r)};e.push(i)}this._product.applyAnimationState(t,e)}let l=!1;if(t.forEach(t=>{let e=t.context.animationState;if("appear"===e)return;let i=r[e];if(i&&i.length>0){let r=i.map((t,i)=>({name:`${e}_${i}`,animation:t}));r.forEach(e=>{e.animation.customParameters=t.context});let n=[e];t.applyAnimationState(n,[1===r.length?r[0]:r])}"enter"===e&&r.normal&&(l=!0)}),l&&this._product&&(null==(i=r.normal)?void 0:i.length)){this._product.stopAnimationState("normal","start");let t={name:"normal",animation:this.createAnimationStateList("normal",r)};this._product.applyAnimationState(["normal"],[t])}}_setAnimationState(t){var e,i,r;let n=(("component"===this.type?this.model.getAnimationStateCallback():null==(r=null==(i=(e=this.model).getRegion)?void 0:i.call(e))?void 0:r.getAnimationStateCallback())||(t=>{var e;let i=null==(e=t.context)?void 0:e.diffState;return i===O.exit?O.exit:i===O.update?O.update:O.appear}))(t);t.context.animationState=null!=n?n:t.context.diffState,t.context.animationState===N.exit&&(t.context.reusing=!0,t.animates&&t.animates.forEach(t=>t.stop()))}_runJoin(t){let e=this._getDataByKey(t),i=this._prevDataByKey,r=[],n=new Set(this._graphics.filter(t=>t.context.diffState===N.enter)),s=(t,e,i)=>{var s,l,a,o,h,u,d,c,p;let g,f;return er(e)?(g=this._graphicMap.get(t))&&(f=N.exit):er(i)?(g=this._graphicMap.has(t)?this._graphicMap.get(t):{},f=N.enter,g.isExiting=!1,this._graphicMap.set(t,g),r.push(g)):(g=this._graphicMap.get(t))&&(f=N.update,r.push(g)),g&&(n.delete(g),g.context=Object.assign(Object.assign({},this._getCommonContext()),{diffState:f,reusing:null==(s=g.context)?void 0:s.reusing,originalFieldX:null==(l=g.context)?void 0:l.originalFieldX,originalFieldY:null==(a=g.context)?void 0:a.originalFieldY,fieldX:null==(o=g.context)?void 0:o.fieldX,fieldY:null==(h=g.context)?void 0:h.fieldY,data:null!=e?e:null==(u=g.context)?void 0:u.data,uniqueKey:t,key:e?this._keyGetter(e[0]):null==(d=g.context)?void 0:d.key,groupKey:e?this._groupKeyGetter(e[0]):null==(c=g.context)?void 0:c.groupKey,indexKey:"__VCHART_DEFAULT_DATA_INDEX",stateAnimateConfig:null==(p=this.getAnimationConfig())?void 0:p.state}),this._setAnimationState(g)),g};if(i&&e){let t=new Map(i.data);e.keys.forEach(i=>{s(i,e.data.get(i),t.get(i)),t.delete(i)}),i.keys.forEach(e=>{t.has(e)&&s(e,null,t.get(e))})}else e?e.keys.forEach(t=>{let i=s(t,e.data.get(t),null);i&&(i.context.animationState=O.appear)}):i&&i.keys.forEach(t=>{s(t,null,i.data.get(t)).context.animationState=O.disappear});n.forEach(t=>{this._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release()});let l=r.length;r.forEach((t,e)=>{t.context.graphicCount=l,t.context.graphicIndex=e}),this._dataByKey=e,this._graphics=r,this.needClear=!0}_runEncoderOfGraphic(t,e,i={}){return sT(t,e.context.data[0],i)}_runGroupEncoder(t){if(!this._dataByGroup)return null;let e={};return this._dataByGroup.keys.forEach(i=>{e[i]=sT(t,this._dataByGroup.data.get(i)[0])}),this._attrsByGroup=e,e}_transformGraphicAttributes(t,e,i){return Object.assign(Object.assign({},i),e)}_separateNormalStyle(t){let e={},i={};return Object.keys(t).forEach(r=>{this._unCompileChannel[r]||(this._option.noSeparateStyle||function(t,e,i){var r,n,s;let l=null==(r=e[t])?void 0:r.style;return n=t,s=l,!!(("fill"===n||"stroke"===n)&&(null==s?void 0:s.gradient)&&(null==s?void 0:s.stops)||tQ(l))||!(!(null==l?void 0:l.scale)||l.field===i)}(r,t,this._groupKey)?e[r]=t[r]:i[r]=t[r])}),{updateStyles:e,groupStyles:i}}_addProgressiveGraphic(t,e){t.incrementalAppendChild(e)}_runEncoder(t,e){var i;let r=e?null:this._runGroupEncoder(null==(i=this._encoderOfState)?void 0:i.group);t.forEach((t,e)=>{var i;let n=this._runEncoderOfGraphic(null==(i=this._encoderOfState)?void 0:i.update,t);er(this._markConfig.interactive)||(n.pickable=this._markConfig.interactive);let s=this._transformGraphicAttributes(t,n,null==r?void 0:r[t.context.groupKey]);t.context.finalAttrs=s})}_runApplyGraphic(t){let e=this.hasAnimation();t.forEach((i,r)=>{var n;let s=i.context.finalAttrs,l=this.hasAnimationByState(i.context.animationState);if(i.setAttributes){let t=iK(i,s);i.context.diffAttrs=t,i.context.reusing?(i.context.lastAttrs=i.attribute,i.initAttributes({}),i.context.reusing=!1):l||(e?i.setAttributesAndPreventAnimate(t):i.setAttributes(t)),e&&i.setFinalAttributes(s)}else{let l=i;i=this._createGraphic(s),e&&i.setFinalAttributes(s),i.context=l.context,i.context.diffAttrs=s;let a=this._graphics===t?r:r+this._graphics.length-t.length;if(a>=0&&(this._graphics[a]=i),null==(n=this.renderContext)?void 0:n.progressive){let t=this._dataByGroup?this._dataByGroup.keys.indexOf(i.context.groupKey):0,e=t>=0?this._product.getChildAt(t):null;e&&this._addProgressiveGraphic(e,i)}else this._product.appendChild(i),this._graphicMap.set(i.context.uniqueKey,i)}this._setStateOfGraphic(i),this._setGraphicFromMarkConfig(i)})}_updateEncoderByState(){let t={};Object.keys(this.stateStyle).forEach(e=>{if(e===j.STATE_NORMAL){let{groupStyles:i,updateStyles:r}=this._separateNormalStyle(this.stateStyle[e]);t.group=this._getEncoderOfStyle(e,i),t.update=this._getEncoderOfStyle(e,r)}else t[e]=this._getEncoderOfStyle(e,this.stateStyle[e])}),this._encoderOfState=t}_runState(t){t.forEach(t=>{var e;let i=[...(null!=(e=t.currentStates)?e:[]).filter(t=>!this.state.getStateInfo(t)),...this.state.checkState(t,t.context.data)];this._stateSort&&i.length&&i.sort(this._stateSort),t.context.states=i})}_getAttrsFromConfig(t={}){let{zIndex:e,clip:i,clipPath:r,overflow:n}=this._markConfig;if(er(e)||(t.zIndex=e),er(i)||(t.clip=i),!er(r)){let e=tq(r)?r:r(this._graphics);e&&e.length||(t.clip=!1),t.path=e}return er(n)||(t.overflow=n),t}_updateAttrsOfGroup(){var t;let e=this._getAttrsFromConfig();null==(t=this._product)||t.setAttributes(e),this._markConfig.support3d&&this._product&&this._product.setMode("3d")}_runBeforeTransform(t){var e;let i=null==(e=this._transform)?void 0:e.filter(t=>{if(t.type){let e=iv.getGrammarTransform(t.type);return e&&(!e.runType||"beforeJoin"===e.runType)}return!1});return this.runTransforms(i,t)}_runEncoderTransform(t,e){var i;let r=null==(i=this._transform)?void 0:i.filter(t=>{if(t.type){let i=iv.getGrammarTransform(t.type);return i&&"afterEncode"===i.runType&&!!i.canProgressive===e}return!1});return this.runTransforms(r,t)}renderInner(){var t,e,i;let r;this._updateEncoderByState();let n=null!=(e=null==(t=this._data)?void 0:t.getProduct())?e:[{}],s=this._runBeforeTransform(n);if(null==s?void 0:s.progressive){this.renderContext={beforeTransformProgressive:s.progressive};let t=s.progressive;if(t.canAnimate&&t.canAnimate()&&t.unfinished())return void this._updateAttrsOfGroup();r=t.output()}else r=ed(s),this._runGroupData(r),this.renderContext=this._parseProgressiveContext(r);(null==(i=this.renderContext)?void 0:i.progressive)?(this._graphicMap.clear(),this._runProgressiveStep()):(this._runJoin(r),this._runState(this._graphics),this._runEncoder(this._graphics),this._runEncoderTransform(this._graphics,!1),this._runApplyGraphic(this._graphics)),this._updateAttrsOfGroup()}render(){this.isCommited()&&(!this.getVisible()||this._skipBeforeLayouted&&this.getCompiler().getLayoutState()===D.before||(eF(`render mark: ${this.getProductId()}, type is ${this.type}`),this.renderInner()),this.uncommit())}updateMarkState(t){if(!this._product)return;let e=this.state.getStateInfo(t);this._graphics.forEach(i=>{"in"===this.state.checkOneState(i,i.context.data,e)?i.addState(t,!0,this.hasAnimationByState("state")):i.removeState(t,this.hasAnimationByState("state"))})}clearExitGraphics(){this._prevDataByKey=this._dataByKey;let t=(t,e)=>{this._graphicMap.delete(e),t.parent&&t.parent.removeChild(t),t.release&&t.release()};this._graphicMap.forEach((e,i)=>{if(e.context.diffState===N.exit&&!e.isExiting)if(e.context.animationState===N.exit&&this.hasAnimationByState("exit")){e.isExiting=!0;let r=this.getAnimationConfig();if(r.exit&&r.exit.length){let n=r.exit.map((t,i)=>({name:`exit_${i}`,animation:Object.assign(Object.assign({},t),{customParameters:e.context})}));e.applyAnimationState(["exit"],[1===n.length?n[0]:n],()=>{t(e,i)})}}else t(e,i)})}isProgressive(){return this.renderContext&&(!!this.renderContext.progressive||!!this.renderContext.beforeTransformProgressive)}canAnimateAfterProgressive(){var t,e;return this.renderContext&&this.renderContext.beforeTransformProgressive&&(null==(e=(t=this.renderContext.beforeTransformProgressive).canAnimate)?void 0:e.call(t))}isDoingProgressive(){return this.renderContext&&(this.renderContext.progressive&&this.renderContext.progressive.currentIndex<this.renderContext.progressive.totalStep||this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.unfinished())}clearProgressive(){this.renderContext&&this.renderContext.progressive&&(this._graphics=[],this._product.children.forEach(t=>{t.incrementalClearChild()}),this._product.removeAllChild()),this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.release(),this.renderContext=null}restartProgressive(){this.renderContext&&this.renderContext.progressive&&(this.renderContext.progressive.currentIndex=0)}_runBeforeProgressive(){var t;let e=this.renderContext.beforeTransformProgressive;e.progressiveRun();let i=e.output();if(null==(t=e.canAnimate)?void 0:t.call(e)){if(e.unfinished())return;this._runGroupData(i),this._runJoin(i),this._runState(this._graphics),this._runEncoder(this._graphics),this._runApplyGraphic(this._graphics)}}_runProgressiveJoin(){let t=this.renderContext.progressive.currentIndex,e=[],i={};return this._dataByGroup.keys.forEach(r=>{let n=this.renderContext.progressive.groupedData.get(r),s=this.renderContext.progressive.step,l=n.slice(t*s,(t+1)*s),a=[];l.forEach((i,n)=>{let l=this._keyGetter(i),o={context:Object.assign(Object.assign({},this._getCommonContext()),{diffState:N.enter,data:[i],uniqueKey:`${r}_${null!=l?l:t*s+n}`,key:l,groupKey:r})};a.push(o),e.push(o)}),i[r]=a}),{graphicsByGroup:i,graphics:e,needUpdate:!0}}_createIncrementalGraphics(){this._product.removeAllChild(),this._dataByGroup.keys.forEach(t=>{let e=(0,n9.sS)({pickable:!1,zIndex:this._markConfig.zIndex});e.incremental=this.renderContext.progressive.step,this._product.appendChild(e)})}_setCommonAttributesToTheme(t){var e,i,r;if(this._attrsByGroup&&t){let n=t.parent;n&&(null==(e=this._attrsByGroup)?void 0:e[null==(i=t.context)?void 0:i.groupKey])&&n.setTheme({common:this._attrsByGroup[null==(r=t.context)?void 0:r.groupKey]})}}_runProgressiveEncoder(t){0===this.renderContext.progressive.currentIndex?this._runEncoder(t):this._runEncoder(t,!0)}_runProgressiveApplyGraphic(t){0===this.renderContext.progressive.currentIndex?(this._runApplyGraphic(t),this._setCommonAttributesToTheme(t[0])):this._runApplyGraphic(t)}_runProgressiveStep(){let{graphics:t,graphicsByGroup:e,needUpdate:i}=this._runProgressiveJoin();0===this.renderContext.progressive.currentIndex?(this._createIncrementalGraphics(),this._graphics=t):i&&t.forEach(t=>{this._graphics.push(t)}),this._runState(t),Object.keys(e).forEach(t=>{this._runProgressiveEncoder(e[t])}),this._runEncoderTransform(this._graphics,!0),Object.keys(e).forEach(t=>{this._runProgressiveApplyGraphic(e[t])}),this.renderContext.progressive.currentIndex+=1}renderProgressive(){var t;(null==(t=this.renderContext)?void 0:t.beforeTransformProgressive)?this._runBeforeProgressive():this.renderContext.progressive&&this._runProgressiveStep()}hasAnimationByState(t){if(!t||!this._animationConfig||!this._animationConfig[t]||this._disabledAnimationStates.includes(t))return!1;let e=this._animationConfig[t];return e.length>0||e_(e)}hasAnimation(){return!!this._animationConfig&&Object.keys(this._animationConfig).length>0}runAnimation(){this._runStateAnimation(this.getGraphics())}}var oc=i(96531),op=i(15589);class og extends od{constructor(){super(...arguments),this.type=og.type,this._marks=[],this._diffState=N.enter}getMarks(){return this._marks}isMarkExist(t){return void 0!==this._marks.find(e=>e.id===t.id)}addMark(t){return this.isMarkExist(t)?(eO("Mark already exists, add mark failed."),!1):(this._marks.push(t),!0)}removeMark(t){let e=this._marks.findIndex(e=>e.id===t.id||e.name===t.name);return -1===e?(eO("Mark does not exists, removeMark failed."),!1):(this._marks.splice(e,1),!0)}getMarkInType(t){return this._marks.filter(e=>e.type===t)}getMarkInId(t){return this._marks.find(e=>e.id===t)}getMarkInUserId(t){let e;return sR(this,t=>{e=t},e=>e.getUserId()===t,null,!0),e}getMarkInName(t){return this._marks.filter(e=>e.name===t)}_compileProduct(t){super._compileProduct(t),this.getMarks().forEach(t=>{t.compile({group:this._product})})}_getAttrsFromConfig(t={}){let e=super._getAttrsFromConfig(t);return er(this._markConfig.interactive)||(e.pickable=this._markConfig.interactive),t}getGraphics(){return[this._product]}renderInner(){var t;if(!this._product)return;let e=null!=(t=this._simpleStyle)?t:this.getAttributesOfState({});this._product.context=Object.assign(Object.assign(Object.assign({},this._product.context),this._getCommonContext()),{diffState:this._diffState}),this._setAnimationState(this._product);let i=this._getAttrsFromConfig(e);if(this._product.context.diffState===N.update){let t=this.hasAnimation(),e=iK(this._product,i);this._product.context.diffAttrs=e,this.hasAnimationByState(this._product.context.animationState)||(t?this._product.setAttributesAndPreventAnimate(e):this._product.setAttributes(e)),t&&this._product.setFinalAttributes(i)}else this._product.setAttributes(i);this.needClear=!0}clearExitGraphics(){this._diffState=N.update}render(){this._isCommited&&(eF(`render mark: ${this.getProductId()}, type is ${this.type}`),this.renderInner(),this.uncommit()),this.getMarks().forEach(t=>{t.render()})}release(){super.release(),this.removeProduct()}}og.type="group";let of=()=>{(0,oc.W)(),(0,op.M)(),iv.registerMark(og.type,og)};var om=i(14135);let oy=(t,e,i)=>(0,om.gM)(t,e,i,{fontFamily:eW.fontFamily,fontSize:eW.fontSize}),ov=(t,e,i,r)=>oy(e,i,r).measure(t);class ob{static instance(){return ob.instance_||(ob.instance_=new ob),ob.instance_}constructor(){this.functions={}}registerFunction(t,e){t&&e&&(this.functions[t]=e)}unregisterFunction(t){t&&delete this.functions[t]}getFunction(t){return this.functions[t]||null}getFunctionNameList(){return Object.keys(this.functions)}}var o_=i(91018),ox=i(59526),oC=i(99262),ow=i(71071),oS=i(84527),oA=i(26004),oM=i(2123);let ok=class extends oM.s{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}getImageData(t,e,i,r){return new Promise((n,s)=>{var l;try{tt.canvasGetImageData({canvasId:null!=(l=this.canvas.nativeCanvas.id)?l:this.canvas.id,x:t,y:e,width:i,height:r,success(t){n(t)}})}catch(t){s(t)}})}draw(){let t=this.nativeContext;t.draw&&(this.drawPromise=new Promise(e=>{t.draw(!0,()=>{this.drawPromise=null,e(null)})}))}createPattern(t,e){return null}};ok.env="feishu",ok=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)()],ok);let oT=class extends oS.u{constructor(t){super(t)}init(){this._context=new ok(this,this._dpr)}release(...t){}};oT.env="feishu",oT=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],oT);var oR=i(69646);let oB=(0,oR.l)(oT,ok);var oP=i(84956),oE=i(40398),oI=i(47061),oL=i(56488);class oF{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let oO=class extends oP.X{get container(){return null}constructor(t){super(),this.global=t,this.type="feishu",this.eventManager=new oF}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oE.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new oT(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new oT({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};oO.env="feishu",oO=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(m=(0,oI.f)(ow.y2),function(t,e){m(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],oO);let oD=new oC.n(t=>{t(oO).toSelf(),t(oL.zd).toDynamicValue(t=>t.container.get(oO)).whenTargetNamed(oO.env)});var oH=i(58365),oz=i(9941),oW=i(92679),oN=i(58233),oj=i(6146),oG=i(47012),oV=function(t,e){return function(i,r){e(i,r,t)}};let oZ=class extends oz.f{constructor(t,e,i){super(e,i),this.contributions=t,this.pickItemInterceptorContributions=e,this.pickServiceInterceptorContributions=i,this.global.hooks.onSetEnv.tap("math-picker-service",(t,e,i)=>{this.configure(i,e)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(t=>{this.pickerMap.set(t.numberType,t)}),super._init()}configure(t,e){this.pickContext=new oW.w(null,1)}pickItem(t,e,i,r){if(!1===t.attribute.pickable)return null;let n=this.pickerMap.get(t.numberType);if(!n)return null;let s=n.contains(t,e,r),l=s?t:null;return l?{graphic:l,params:s}:null}};oZ=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),oV(0,(0,oI.f)(oN.Qc)),oV(0,(0,oj.t)(oG.XN)),oV(1,(0,oI.f)(oN.Qc)),oV(1,(0,oj.t)(oH.uH)),oV(2,(0,oI.f)(oN.Qc)),oV(2,(0,oj.t)(oH.tn)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object,Object])],oZ);let oU=new oC.n(t=>{oU.__vloaded||(oU.__vloaded=!0,(0,oN.yb)(t,oG.XN))});oU.__vloaded=!1;var oK=i(2567),o$=i(79314),oY=i(28856),oX=i(60766);let oq=class extends oX.o{constructor(t){super(),this.canvasRenderer=t,this.type="area",this.numberType=o$.Ri}};oq=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(y=(0,oI.f)(oY.Gs),function(t,e){y(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],oq);let oJ=!1,oQ=new oC.n((t,e,i,r)=>{oJ||(oJ=!0,t(oG.$Y).to(oq).inSingletonScope(),t(oG.XN).toService(oG.$Y))});var o0=i(75315);class o1{constructor(){this.type="glyph",this.numberType=o$.Nd}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=null==i?void 0:i.pickerService;if(n){let r=!1;return t.getSubGraphic().forEach(t=>{if(r)return;let s=n.pickItem(t,e,null,i);r=!(!s||!s.graphic)}),r}return!1}}let o2=class extends o1{constructor(t){super(),this.canvasRenderer=t}};o2=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(v=(0,oI.f)(oY.FU),function(t,e){v(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],o2);let o3=!1,o5=new oC.n((t,e,i,r)=>{o3||(o3=!0,t(oG.Uv).to(o2).inSingletonScope(),t(o2).toService(oG.Uv))});var o4=i(73797),o6=i(86971),o8=i(55478),o9=i(63869),o7=i(18114),ht=i(95197),he=i(53279),hi=i(59087);let hr=new oC.n((t,e,i,r)=>{i(oZ)||t(oZ).toSelf().inSingletonScope(),i(oH.hH)?r(oH.hH).toService(oZ):t(oH.hH).toService(oZ)});function hn(t){t.load(oU),t.load(hr),t.load(oK.E),t.load(oQ),t.load(o0.P),t.load(o5),t.load(o4.x),t.load(o6.c),t.load(o8.C),t.load(o9.t),t.load(o7.k),t.load(ht.D),t.load(he.n),t.load(hi.T)}var hs=i(57565),hl=i(70749);class ha{get width(){return this._w*this.dpr}set width(t){}get height(){return this._h*this.dpr}set height(t){}get offsetWidth(){return this._w}set offsetWidth(t){}get offsetHeight(){return this._h}set offsetHeight(t){}constructor(t,e,i,r,n,s){this.nativeCanvas=t,this.ctx=e,this._w=r,this._h=n,this.id=s,t.id=s,this.dpr=i}getContext(){return this.ctx}getBoundingClientRect(){return{width:this._w,height:this._h}}}class ho{get width(){return this._w*this.dpr}set width(t){this._w=t/this.dpr,this.nativeCanvas.width=t}get height(){return this._h*this.dpr}set height(t){this._h=t/this.dpr,this.nativeCanvas.height=t}get offsetWidth(){return this._w}set offsetWidth(t){this._w=t,this.nativeCanvas.width=t*this.dpr}get offsetHeight(){return this._h}set offsetHeight(t){this._h=t,this.nativeCanvas.height=t*this.dpr}constructor(t,e,i,r,n,s){this.nativeCanvas=t,this.ctx=e,this._w=r,this._h=n,this.id=s,t.id=s,this.dpr=i}getContext(){return this.ctx}getBoundingClientRect(){return{width:this._w,height:this._h}}}let hh=class extends hs.z{constructor(){super(),this.type="feishu",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}getDynamicCanvasCount(){return this.freeCanvasList.length}getStaticCanvasCount(){return 9999}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),function(t,e,i,r,n,s){let l=null!=s?s:tt.getSystemInfoSync().pixelRatio;e.forEach((e,s)=>{let a=tt.createCanvasContext(e),o=new ha(a.canvas||{},a,l,t.width,t.height,e);a.canvas=o,i.set(e,o),s>=r&&n.push(o)})}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.pixelRatio))}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return tt.getSystemInfoSync().pixelRatio}getRequestAnimationFrame(){return function(t){return hl.dZ.call(t)}}getCancelAnimationFrame(){return t=>{hl.dZ.clear(t)}}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}};hh=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],hh);let hu=new oC.n(t=>{hu.isFeishuBound||(hu.isFeishuBound=!0,t(hh).toSelf().inSingletonScope(),t(ow.D0).toService(hh))});function hd(t,e=!0){hd.__loaded||(hd.__loaded=!0,t.load(hu),t.load(oB),t.load(oD),e&&hn(t))}hu.isFeishuBound=!1,hd.__loaded=!1;var hc=i(21823);let hp=class extends oM.s{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}setLineDash(t){let e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){let t=e[0];if(0===t[0]&&0===t[1])return;t&&i.setLineDash(t)}}_setStrokeStyle(t,e,i,r,n){let s=this.nativeContext;n||(n=this.strokeAttributes);let{strokeOpacity:l=n.strokeOpacity,opacity:a=n.opacity}=e;if(l>1e-12&&a>1e-12){let{lineWidth:o=n.lineWidth,stroke:h=n.stroke,lineJoin:u=n.lineJoin,lineDash:d=n.lineDash,lineCap:c=n.lineCap,miterLimit:p=n.miterLimit,keepStrokeScale:g=n.keepStrokeScale,lineDashOffset:f=n.lineDashOffset}=e;s.globalAlpha=l*a*this.baseGlobalAlpha,s.lineWidth=g?o:(0,hc.D)(this,o,this.dpr),s.strokeStyle=(0,hc.L)(this,h,t,i,r),s.lineJoin=u,(0!==d[0]||0!==d[1])&&d&&(s.setLineDash(d),s.lineDashOffset=f),s.lineCap=c,s.miterLimit=p}}measureText(t,e=aB.w.global.measureTextMethod){return this.setTransform(1,0,0,1,0,0,!0,aB.w.global.devicePixelRatio),{width:super.measureText(t,e).width,fontBoundingBoxDescent:void 0,fontBoundingBoxAscent:void 0,actualBoundingBoxAscent:void 0,actualBoundingBoxDescent:void 0}}createPattern(t,e){return null}draw(){let t=this.nativeContext;t.draw&&(this.drawPromise=new Promise(e=>{t.draw(!0,()=>{this.drawPromise=null,e(null)})}))}};hp.env="lynx",hp=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)()],hp);let hg=class extends oS.u{constructor(t){super(t)}init(){this._context=new hp(this,this._dpr)}resize(t,e){this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._nativeCanvas.nativeCanvas&&(this._nativeCanvas.nativeCanvas.width=this._pixelWidth,this._nativeCanvas.nativeCanvas.height=this._pixelHeight),this._context.dpr=this._dpr}release(...t){}};hg.env="lynx",hg=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hg);class hf{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let hm=class extends oP.X{get container(){return null}constructor(t){super(),this.global=t,this.type="lynx",this.eventManager=new hf}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oE.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new hg(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new hg({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};hm.env="lynx",hm=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(b=(0,oI.f)(ow.y2),function(t,e){b(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hm);let hy=new oC.n(t=>{t(hm).toSelf(),t(oL.zd).toDynamicValue(t=>t.container.get(hm)).whenTargetNamed(hm.env)}),hv=(0,oR.l)(hg,hp),hb=!1;try{hb=!!lynx.createCanvasNG}catch(t){}let h_=class extends hs.z{constructor(){super(),this.type="lynx",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),function(t,e,i,r,n,s,l){let a=null!=l?l:SystemInfo.pixelRatio;if(e.forEach((e,l)=>{let o;s?o=lynx.createOffscreenCanvas():(o=hb?lynx.createCanvasNG(e):lynx.createCanvas(e),hb&&o.attachToCanvasView(e)),o.width=t.width*a,o.height=t.height*a;let h=o.getContext("2d"),u=new ho(o,h,a,t.width,t.height,e);i.set(e,u),l>r&&n.push(u)}),!n.length&&lynx.createOffscreenCanvas){let e=lynx.createOffscreenCanvas();e.width=t.width*a,e.height=t.height*a;let r=e.getContext("2d"),s=Math.random().toString(),l=new ho(e,r,a,t.width,t.height,s);i.set(s,l),n.push(l)}}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,!!e.offscreen,e.pixelRatio))}getDynamicCanvasCount(){return this.freeCanvasList.length}getStaticCanvasCount(){return 9999}loadImage(t){return(function(t,e=!1){if(e)return Promise.reject();let i=lynx.createImage(t);return new Promise((t,e)=>{i.onload=()=>{t(i)},i.onerror=()=>{e(Error("加载失败"))}})})(t,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return SystemInfo.pixelRatio}getRequestAnimationFrame(){return function(t){return hl.dZ.call(t)}}getCancelAnimationFrame(){return t=>{hl.dZ.clear(t)}}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}};h_=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],h_);let hx=new oC.n(t=>{hx.isLynxBound||(hx.isLynxBound=!0,t(h_).toSelf().inSingletonScope(),t(ow.D0).toService(h_))});function hC(t,e=!0){hC.__loaded||(hC.__loaded=!0,t.load(hx),t.load(hv),t.load(hy),e&&hn(t))}hx.isLynxBound=!1,hC.__loaded=!1;var hw=i(37438),hS=i(28504);let hA=class extends oM.s{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.setGlobalAlpha(t),this._globalAlpha=t}draw(){this.nativeContext.draw()}strokeText(t,e,i){}_setCommonStyle(t,e,i,r,n){let s=this.nativeContext;n||(n=this.fillAttributes);let{fillOpacity:l=n.fillOpacity,opacity:a=n.opacity,fill:o=n.fill}=e;l>1e-12&&a>1e-12&&(s.setGlobalAlpha(l*a),s.setFillStyle((0,hc.L)(this,o,t,i,r)))}_setStrokeStyle(t,e,i,r,n){let s=this.nativeContext;n||(n=this.strokeAttributes);let{strokeOpacity:l=n.strokeOpacity,opacity:a=n.opacity}=e;if(l>1e-12&&a>1e-12){let{lineWidth:o=n.lineWidth,stroke:h=n.stroke,lineJoin:u=n.lineJoin,lineDash:d=n.lineDash,lineDashOffset:c=n.lineDashOffset,lineCap:p=n.lineCap,miterLimit:g=n.miterLimit,keepStrokeScale:f=n.keepStrokeScale}=e;s.setGlobalAlpha(l*a),s.setLineWidth(f?o:(0,hc.D)(this,o,this.dpr)),s.setStrokeStyle((0,hc.L)(this,h,t,i,r)),s.setLineJoin(u),d&&(s.setLineDash(d),s.lineDashOffset=c),s.setLineCap(p),s.setMiterLimit(g)}}setTextStyleWithoutAlignBaseline(t,e){var i;let r=this.nativeContext;e||(e=this.textAttributes),t.font?r.font=t.font:r.font=(0,hS.U)(t,e),r.setFontSize(null!=(i=t.fontSize)?i:e.fontSize)}setTextStyle(t,e){var i,r;let n=this.nativeContext;e||(e=this.textAttributes),t.font?n.font=t.font:n.font=(0,hS.U)(t,e),n.setTextAlign(null!=(i=t.textAlign)?i:e.textAlign),n.setTextBaseline(null!=(r=t.textBaseline)?r:e.textBaseline)}createConicGradient(t,e,i,r){return null}createPattern(t,e){return null}getImageData(t,e,i,r){let n=this.nativeContext,s=n.taro;if(n&&s)return!n.getImageData&&s.canvasGetImageData?new Promise((n,l)=>{try{s.canvasGetImageData({canvasId:this.canvas.nativeCanvas.id,sx:t,sy:e,sw:i,sh:r,success(t){n(t)}})}catch(t){l(t)}}):void 0}createRadialGradient(t,e,i,r,n,s){return this.nativeContext.createCircularGradient&&this.nativeContext.createCircularGradient(t,e,i,r,n,s)}};hA.env="taro",hA=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)()],hA);let hM=class extends oS.u{constructor(t){super(t)}init(){this._context=new hA(this,this._dpr)}release(...t){}};hM.env="taro",hM=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hM);let hk=(0,oR.l)(hM,hA);class hT{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let hR=class extends oP.X{get container(){return null}constructor(t){super(),this.global=t,this.type="taro",this.eventManager=new hT}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oE.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new hM(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new hM({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches.length>0&&(t.changedTouches.forEach((e,i)=>{t.changedTouches[i]=Object.assign(Object.assign({},t.changedTouches[i]),{offsetX:e.x,offsetY:e.y})}),t.offsetX=t.changedTouches[0].offsetX,t.offsetY=t.changedTouches[0].offsetY),t.touches.length>0&&t.touches.forEach((e,i)=>{t.touches[i]=Object.assign(Object.assign({},t.touches[i]),{offsetX:e.x,offsetY:e.y})}),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};hR.env="taro",hR=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(_=(0,oI.f)(ow.y2),function(t,e){_(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hR);let hB=new oC.n(t=>{t(hR).toSelf(),t(oL.zd).toDynamicValue(t=>t.container.get(hR)).whenTargetNamed(hR.env)}),hP=class extends hs.z{constructor(){super(),this.type="taro",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}getDynamicCanvasCount(){return this.freeCanvasList.length}getStaticCanvasCount(){return 9999}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}configure(t,e){var i,r,n,s,l,a,o;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,r=e.canvasIdLists,n=this.canvasMap,s=e.freeCanvasIdx,l=this.freeCanvasList,a=e.taro,o=e.pixelRatio,r.forEach((t,e)=>{let r=a.createCanvasContext(t),h=new ha(r.canvas||{},r,o,i.width,i.height,t);return r.canvas=h,n.set(t,h),e>=s&&l.push(h),h}),this.taro=e.taro,this.pixelRatio=e.pixelRatio)}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){let e=window||globalThis;if(e.DOMParser){let i=(new e.DOMParser).parseFromString(t,"image/svg+xml").children[0],r=(new XMLSerializer).serializeToString(i);return Promise.resolve({data:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(r)}`,loadState:"success"})}if(e.Blob){let i=new e.Blob([t],{type:"image/svg+xml"});return Promise.resolve({data:e.URL.createObjectURL(i),loadState:"success"})}return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return this.pixelRatio}getRequestAnimationFrame(){return requestAnimationFrame}getCancelAnimationFrame(){return cancelAnimationFrame}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}};hP=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],hP);let hE=new oC.n(t=>{hE.isTaroBound||(hE.isTaroBound=!0,t(hP).toSelf().inSingletonScope(),t(ow.D0).toService(hP))});function hI(t,e=!0){hI.__loaded||(hI.__loaded=!0,t.load(hE),t.load(hk),t.load(hB),e&&hn(t))}hE.isTaroBound=!1,hI.__loaded=!1;let hL=class extends oM.s{draw(){}createPattern(t,e){return null}};hL.env="wx",hL=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)()],hL);let hF=class extends oS.u{constructor(t){super(t)}init(){this._context=new hL(this,this._dpr)}release(...t){}};hF.env="wx",hF=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hF);let hO=(0,oR.l)(hF,hL);class hD{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let hH=class extends oP.X{get container(){return null}constructor(t){super(),this.global=t,this.type="wx",this.eventManager=new hD}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oE.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new hF(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new hF({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){var e,i,r,n;let{type:s}=t;return!!this.eventManager.cache[s]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=null!=(e=t.changedTouches[0].x)?e:t.changedTouches[0].pageX,t.changedTouches[0].clientX=null!=(i=t.changedTouches[0].x)?i:t.changedTouches[0].pageX,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=null!=(r=t.changedTouches[0].y)?r:t.changedTouches[0].pageY,t.changedTouches[0].clientY=null!=(n=t.changedTouches[0].y)?n:t.changedTouches[0].pageY),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[s].listener&&this.eventManager.cache[s].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};hH.env="wx",hH=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(x=(0,oI.f)(ow.y2),function(t,e){x(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hH);let hz=new oC.n(t=>{t(hH).toSelf(),t(oL.zd).toDynamicValue(t=>t.container.get(hH)).whenTargetNamed(hH.env)}),hW=class extends hs.z{constructor(){super(),this.type="wx",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}configure(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),(function(t,e,i,r,n,s,l){var a,o,h,u;return a=this,o=void 0,h=void 0,u=function*(){let t=wx.getSystemInfoSync().pixelRatio;for(let a=0;a<e.length;a++){let o=e[a];!l&&i.has(o)||(yield new Promise(e=>{let l=wx.createSelectorQuery();s&&(l=l.in(s)),l.select(`#${o}`).fields({node:!0,size:!0}).exec(s=>{if(!s[0])return;let l=s[0].node,h=s[0].width,u=s[0].height;l.width=h*t,l.height=u*t,i.set(o,l),a>=r&&n.push(l),e(null)})}))}},new(h||(h=Promise))(function(t,e){function i(t){try{n(u.next(t))}catch(t){e(t)}}function r(t){try{n(u.throw(t))}catch(t){e(t)}}function n(e){var n;e.done?t(e.value):((n=e.value)instanceof h?n:new h(function(t){t(n)})).then(i,r)}n((u=u.apply(a,o||[])).next())})})(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component,e.forceUpdate).then(()=>{})}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return wx.getSystemInfoSync().pixelRatio}getRequestAnimationFrame(){return function(t){return hl.dZ.call(t)}}getCancelAnimationFrame(){return t=>{hl.dZ.clear(t)}}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}};hW=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],hW);let hN=new oC.n(t=>{hN._isWxBound||(hN._isWxBound=!0,t(hW).toSelf().inSingletonScope(),t(ow.D0).toService(hW))});function hj(t,e=!0){hj.__loaded||(hj.__loaded=!0,t.load(hN),t.load(hO),t.load(hz),e&&hn(t))}hN._isWxBound=!1,hj.__loaded=!1;var hG=i(98456);function hV(t){hV.__loaded||(hV.__loaded=!0,(0,ox.Ns)(t,!1),hd(t,!1),hC(t,!1),(0,hw.sn)(t,!1),hI(t,!1),hj(t,!1),(0,hG.q)(t),ea.rF.hooks.onSetEnv.tap("loadMathPicker",(e,i)=>{"browser"!==i&&hn(t)}))}hV.__loaded=!1;let hZ=class extends ok{};hZ.env="tt",hZ=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)()],hZ);let hU=class extends oS.u{constructor(t){super(t)}init(){this._context=new hZ(this,this._dpr)}release(...t){}};hU.env="tt",hU=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hU);let hK=(0,oR.l)(hU,hZ);class h${constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let hY=class extends oP.X{get container(){return null}constructor(t){super(),this.global=t,this.type="tt",this.eventManager=new h$}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oE.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new hU(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new hU({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};hY.env="tt",hY=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(C=(0,oI.f)(ow.y2),function(t,e){C(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hY);let hX=new oC.n(t=>{t(hY).toSelf(),t(oL.zd).toDynamicValue(t=>t.container.get(hY)).whenTargetNamed(hY.env)}),hq=class extends hs.z{constructor(){super(),this.type="tt",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}configure(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),(function(t,e,i,r,n,s){var l,a,o,h;return l=this,a=void 0,o=void 0,h=function*(){let t=tt.getSystemInfoSync().pixelRatio;for(let l=0;l<e.length;l++){let a=e[l];yield new Promise(e=>{let o=tt.createSelectorQuery();s&&(o=o.in(s)),o.select(`#${a}`).node().exec(s=>{let o=s[0].node,h=o.width,u=o.height;o.width=h*t,o.height=u*t,i.set(a,o),l>=r&&n.push(o),e(null)})})}},new(o||(o=Promise))(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){var n;e.done?t(e.value):((n=e.value)instanceof o?n:new o(function(t){t(n)})).then(i,r)}n((h=h.apply(l,a||[])).next())})})(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component).then(()=>{})}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return tt.getSystemInfoSync().pixelRatio}getRequestAnimationFrame(){return function(t){return hl.dZ.call(t)}}getCancelAnimationFrame(){return t=>{hl.dZ.clear(t)}}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}};hq=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],hq);let hJ=new oC.n(t=>{hJ.isTTBound||(hJ.isTTBound=!0,t(hq).toSelf().inSingletonScope(),t(ow.D0).toService(hq))});function hQ(t,e=!0){hQ.__loaded||(hQ.__loaded=!0,t.load(hJ),t.load(hK),t.load(hX),e&&hn(t))}hJ.isTTBound=!1,hQ.__loaded=!1;let h0=class extends oM.s{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}setLineDash(t){let e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){let t=e[0];if(0===t[0]&&0===t[1])return;t&&i.setLineDash(t)}}_setStrokeStyle(t,e,i,r,n){let s=this.nativeContext;n||(n=this.strokeAttributes);let{strokeOpacity:l=n.strokeOpacity,opacity:a=n.opacity}=e;if(l>1e-12&&a>1e-12){let{lineWidth:o=n.lineWidth,stroke:h=n.stroke,lineJoin:u=n.lineJoin,lineDash:d=n.lineDash,lineCap:c=n.lineCap,miterLimit:p=n.miterLimit,keepStrokeScale:g=n.keepStrokeScale,lineDashOffset:f=n.lineDashOffset}=e;s.globalAlpha=l*a*this.baseGlobalAlpha,s.lineWidth=g?o:(0,hc.D)(this,o,this.dpr),s.strokeStyle=(0,hc.L)(this,h,t,i,r),s.lineJoin=u,0===d[0]&&0===d[1]||(d&&s.setLineDash(d),s.lineDashOffset=f),s.lineCap=c,s.miterLimit=p}}measureText(t,e=aB.w.global.measureTextMethod){return this.setTransform(1,0,0,1,0,0,!0,aB.w.global.devicePixelRatio),super.measureText(t,e)}setTextStyleWithoutAlignBaseline(t,e,i){let r=this.nativeContext;e||(e=this.textAttributes);let{scaleIn3d:n=e.scaleIn3d}=t,s="";r.font=((t.font?t.font:(0,hS.U)(t,e,n&&this.camera&&this.camera.getProjectionScale(i)))||"").replace("px","vp");let{fontFamily:l=e.fontFamily,fontSize:a=e.fontSize}=t;this.fontFamily=l,this.fontSize=a,r.textAlign="left",r.textBaseline="alphabetic"}setTextStyle(t,e,i){var r,n;let s=this.nativeContext;e||(e=this.textAttributes);let l="";s.font=((t.font?t.font:(0,hS.U)(t,e,this.camera&&this.camera.getProjectionScale(i)))||"").replace("px","vp");let{fontFamily:a=e.fontFamily,fontSize:o=e.fontSize}=t;this.fontFamily=a,this.fontSize=o,s.textAlign=null!=(r=t.textAlign)?r:e.textAlign,s.textBaseline=null!=(n=t.textBaseline)?n:e.textBaseline}createPattern(t,e){return null}drawImage(){let t=this.nativeContext,e=arguments;e[0].drawImage&&(e[0]=e[0].transferToImageBitmap()),3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}draw(){}};h0.env="harmony",h0=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)()],h0);let h1=class extends oS.u{constructor(t){super(t)}init(){this._context=new h0(this,this._dpr)}resize(t,e){}release(...t){}};h1.env="harmony",h1=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],h1);class h2{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let h3=class extends oP.X{get container(){return null}constructor(t){super(),this.global=t,this.type="harmony",this.eventManager=new h2}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oE.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new h1(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}this.canvas=new h1({width:i,height:r,dpr:1,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};h3.env="harmony",h3=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(w=(0,oI.f)(ow.y2),function(t,e){w(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],h3);let h5=new oC.n(t=>{t(h3).toSelf(),t(oL.zd).toDynamicValue(t=>t.container.get(h3)).whenTargetNamed(h3.env)}),h4=(0,oR.l)(h1,h0),h6=class extends hs.z{constructor(){super(),this.type="harmony",this.supportEvent=!0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0,this.rafSTO=new hl.p9(0)}configure(t,e){t.env===this.type&&t.setActiveEnvContribution(this)}getDynamicCanvasCount(){return 9999}getStaticCanvasCount(){return 9999}loadImage(t){}loadSvg(t){return Promise.reject()}createCanvas(t){return function(t,e,i){let r=new OffscreenCanvas(t,e),n=r.getContext("2d");return new ha({width:t,height:e,context:n,_c:r,getBoundingClientRect:()=>({width:t,height:e}),getContext:()=>n},n,1,t,e,i)}(t.width,t.height,t.id)}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return t=>this.rafSTO.call(t)}getCancelAnimationFrame(){return t=>{this.rafSTO.clear(t)}}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return null}getRootElement(){return null}getDocument(){return null}release(...t){}};h6=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],h6);let h8=new oC.n(t=>{h8.isHarmonyBound||(h8.isHarmonyBound=!0,t(h6).toSelf().inSingletonScope(),t(ow.D0).toService(h6))});function h9(t,e=!0){h9.__loaded||(h9.__loaded=!0,t.load(h8),t.load(h4),t.load(h5),e&&hn(t))}h8.isHarmonyBound=!1,h9.__loaded=!1;let h7=()=>{hV(o_.n)},ut=()=>{(0,ox.Ns)(o_.n)},ue=()=>{hd(o_.n)},ui=()=>{hC(o_.n)},ur=()=>{(0,hw.sn)(o_.n)},un=()=>{hI(o_.n)},us=()=>{hj(o_.n)},ul=()=>{hQ(o_.n)},ua=()=>{h9(o_.n)};function uo(t,e){return t&&e.key in t?t[e.key]:e.default}function uh(t){return t&&"token"===t.type&&!!t.key}let uu=["animationThreshold","colorScheme","name","padding"];class ud{constructor(){this.id=ey(),this._plugins=[]}add(t){if(!t||0===t.length)return null;let e=[];return t.forEach(t=>{this._plugins.find(e=>e.id===t.id)?eO("不要重复添加相同的plugin"):(this._plugins.push(t),e.push(t),t.onAdd&&t.onAdd(this))}),e}load(t){let e=this.add(t);e&&e.length&&this.activate(t)}activate(t){t.length&&t.forEach(t=>{t.init&&t.init()})}get(t){return this._plugins.find(e=>e.id===t)}getAll(){return this._plugins.slice()}release(t){let e=this.get(t);e&&(e.release(this),this._plugins=this._plugins.filter(t=>t!==e))}releaseAll(){this._plugins.forEach(t=>{t.release(this)}),this._plugins=[]}clear(t){let e=this.get(t);e&&e.clear(this)}clearAll(){this._plugins.forEach(t=>{var e;null==(e=t.clear)||e.call(t,this)})}}class uc extends ud{constructor(t){super(),this.globalInstance=t}onInit(t){this._plugins.forEach(e=>{e.onInit&&e.onInit(this,t)})}onBeforeResize(t,e){this._plugins.forEach(i=>{i.onBeforeResize&&i.onBeforeResize(this,t,e)})}onAfterChartSpecTransform(t,e){this._plugins.forEach(i=>{i.onAfterChartSpecTransform&&i.onAfterChartSpecTransform(this,t,e)})}onAfterModelSpecTransform(t,e,i){this._plugins.forEach(r=>{r.onAfterModelSpecTransform&&r.onAfterModelSpecTransform(this,t,e,i)})}onBeforeInitChart(t,e){this._plugins.forEach(i=>{i.onBeforeInitChart&&i.onBeforeInitChart(this,t,e)})}releaseAll(){super.releaseAll(),this.globalInstance=null}}var up=i(4062),ug=i(36081),uf=i(38939),um=i(70016),uy=i(98116),uv=i(43562),ub=i(30756),u_=i(97424),ux=i(9911);class uC{constructor(){this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=oE.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={},this.renderId=0,this.onWheel=t=>{try{let e=new t.constructor(t.type,t);this.pluginService.stage.window.getContext().getCanvas().nativeCanvas.dispatchEvent(e)}catch(t){return}}}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,e=>{e&&e===this.pluginService.stage&&this.drawHTML([...t.stage.getChildren()])})}deactivate(t){t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter(t=>t.name!==this.key),this.release()}getWrapContainer(t,e,i){let r;return r=e?"string"==typeof e?aB.w.global.getElementById(e):e:t.window.getContainer(),{wrapContainer:aB.w.global.createDom(Object.assign({tagName:"div",parent:r},i)),nativeContainer:r}}parseDefaultStyleFromGraphic(t){let e="text"===t.type&&t.attribute?t.attribute:(0,up.gh)(t).text;return(0,uf.WD)(e)}getTransformOfText(t){let e=(0,up.gh)(t).text,{textAlign:i=e.textAlign,textBaseline:r=e.textBaseline}=t.attribute,{rotateDeg:n,scaleX:s,scaleY:l}=t.globalTransMatrix.toTransformAttrs(),a={left:"0",start:"0",end:"-100%",center:"-50%",right:"-100%",top:"0",middle:"-50%",bottom:"-100%",alphabetic:"-79%"},o={left:"0",start:"0",end:"100%",center:"50%",right:"100%",top:"0",middle:"50%",bottom:"100%",alphabetic:"79%"};return{textAlign:i,transform:`translate(${a[i]},${a[r]}) rotate(${n}deg) scaleX(${s}) scaleY(${l})`,transformOrigin:`${o[i]} ${o[r]}`}}updateStyleOfWrapContainer(t,e,i,r,n){let{pointerEvents:s,penetrateEventList:l=[]}=n,a=this.parseDefaultStyleFromGraphic(t);a.display=!1!==t.attribute.visible?"block":"none",a.pointerEvents=!0===s?"all":s||"none","none"!==a.pointerEvents&&(this.removeWrapContainerEventListener(i),l.forEach(t=>{"wheel"===t&&i.addEventListener("wheel",this.onWheel)})),i.style.position||(i.style.position="absolute",r.style.position="relative");let o=0,h=0,u=t.globalAABBBounds,d=n.anchorType;if((0,aY.Z)(d)&&(d="text"===t.type?"position":"boundsLeftTop"),"boundsLeftTop"===d&&(d="top-left"),"position"===d||u.empty()){let e=t.globalTransMatrix;o=e.e,h=e.f}else{let t=(0,um.v1)(u,d);o=t.x,h=t.y}let c=aB.w.global.getElementTopLeft(r,!1),p=e.window.getTopLeft(!1),g=e.viewBox,f=o+p.left-c.left+g.x1,m=h+p.top-c.top+g.y1;if(a.left=`${f}px`,a.top=`${m}px`,"text"===t.type&&"position"===d&&(a=Object.assign(Object.assign({},a),this.getTransformOfText(t))),(0,uy.Z)(n.style)){let e=n.style({top:m,left:f,width:u.width(),height:u.height()},t,i);e&&(a=Object.assign(Object.assign({},a),e))}else(0,uv.Z)(n.style)?a=Object.assign(Object.assign({},a),n.style):(0,ub.Z)(n.style)&&n.style&&(a=Object.assign(Object.assign({},a),(0,u_.wv)(n.style)));aB.w.global.updateDom(i,{width:n.width,height:n.height,style:a})}clearCacheContainer(){this.htmlMap&&Object.keys(this.htmlMap).forEach(t=>{this.htmlMap[t]&&this.htmlMap[t].renderId!==this.renderId&&this.removeElement(t)}),this.renderId+=1}drawHTML(t){"browser"===aB.w.global.env&&(t.sort((t,e)=>{var i,r;return(null!=(i=t.attribute.zIndex)?i:ug.xF.zIndex)-(null!=(r=e.attribute.zIndex)?r:ug.xF.zIndex)}).forEach(t=>{this.renderGroupHTML(t)}),this.clearCacheContainer())}renderGroupHTML(t){this.renderGraphicHTML(t),t.forEachChildren(t=>{t.isContainer?this.renderGroupHTML(t):this.renderGraphicHTML(t)})}removeElement(t){if(!this.htmlMap||!this.htmlMap[t])return;let{wrapContainer:e}=this.htmlMap[t];e&&aB.w.global.removeDom(e),this.htmlMap[t]=null}removeWrapContainerEventListener(t){t.removeEventListener("wheel",this.onWheel)}renderGraphicHTML(t){var e;let{html:i}=t.attribute;if(!i)return;let r=t.stage;if(!r)return;let{dom:n,container:s}=i;if(!n)return;let l=(0,aY.Z)(i.id)?`${null!=(e=t.id)?e:t._uid}_react`:i.id;if(this.htmlMap&&this.htmlMap[l]&&s&&s!==this.htmlMap[l].container&&this.removeElement(l),this.htmlMap&&this.htmlMap[l])"string"==typeof n?this.htmlMap[l].wrapContainer.innerHTML=n:n!==this.htmlMap[l].wrapContainer.firstChild&&(this.htmlMap[l].wrapContainer.removeChild(this.htmlMap[l].wrapContainer.firstChild),this.htmlMap[l].wrapContainer.appendChild(n));else{let{wrapContainer:t,nativeContainer:e}=this.getWrapContainer(r,s);t&&("string"==typeof n?t.innerHTML=n:t.appendChild(n),this.htmlMap||(this.htmlMap={}),this.htmlMap[l]={wrapContainer:t,nativeContainer:e,container:s,renderId:this.renderId})}if(!this.htmlMap||!this.htmlMap[l])return;let{wrapContainer:a,nativeContainer:o}=this.htmlMap[l];this.updateStyleOfWrapContainer(t,r,a,o,i),this.htmlMap[l].renderId=this.renderId}release(){"browser"===aB.w.global.env&&this.removeAllDom(this.pluginService.stage.defaultLayer)}removeAllDom(t){this.htmlMap&&(Object.keys(this.htmlMap).forEach(t=>{this.removeElement(t)}),this.htmlMap=null)}}let uw=()=>{ux.F.registerPlugin("HtmlAttributePlugin",uC)};class uS extends uC{constructor(){super(...arguments),this.name="ReactAttributePlugin",this.activeEvent="onRegister",this._uid=oE.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={}}removeElement(t){if(!this.htmlMap||!this.htmlMap[t])return;let{root:e,wrapContainer:i,unmount:r}=this.htmlMap[t];e?aB.w.global.getRequestAnimationFrame()(()=>{e.unmount()}):r&&r(),i&&aB.w.global.removeDom(i),this.htmlMap[t]=null}renderGraphicHTML(t){var e;let{react:i}=t.attribute;if(!i)return;let r=t.stage;if(!r)return;let n=r.params.ReactDOM,{element:s,container:l}=i;if(!s||!n||!n.createRoot&&!n.render)return;let a=(0,aY.Z)(i.id)?`${null!=(e=t.id)?e:t._uid}_react`:i.id;if(this.htmlMap&&this.htmlMap[a]&&l&&l!==this.htmlMap[a].container&&this.removeElement(a),this.htmlMap&&this.htmlMap[a])n.createRoot?this.htmlMap[a].root.render(s):n.render(s,this.htmlMap[a].wrapContainer);else{let{wrapContainer:t,nativeContainer:e}=this.getWrapContainer(r,l);if(t)if(this.htmlMap||(this.htmlMap={}),n.createRoot){let i=n.createRoot(t);i.render(s),this.htmlMap[a]={root:i,wrapContainer:t,nativeContainer:e,container:l,renderId:this.renderId}}else n.render(s,t),this.htmlMap[a]={wrapContainer:t,nativeContainer:e,container:l,renderId:this.renderId,unmount:()=>{n.unmountComponentAtNode(t)}}}if(!this.htmlMap||!this.htmlMap[a])return;let{wrapContainer:o,nativeContainer:h}=this.htmlMap[a];this.updateStyleOfWrapContainer(t,r,o,h,i),this.htmlMap[a].renderId=this.renderId}}let uA=()=>{ux.F.registerPlugin("ReactAttributePlugin",uS)};var uM=i(21964);class uk{constructor(t){this.onPointerDown=t=>{let e=t.target,i=this.rootNode,r=e===i;if(e&&!r){let s,l=!1;function n(t){if(l||(t.type="dragstart",null==e||e.dispatchEvent(t),l=!0),t.type="drag",null==e||e.dispatchEvent(t),!r){e.attribute.pickable=!1;let r=(null==i?void 0:i.pick(t.global.x,t.global.y)).graphic;e.attribute.pickable=!0,s!==r&&(s&&(t.type="dragleave",t.target=s,s.dispatchEvent(t)),r&&(t.type="dragenter",t.target=r,r.dispatchEvent(t)),(s=r)&&(t.type="dragover",t.target=s,s.dispatchEvent(t)))}}null==i||i.addEventListener("pointermove",n);let a=function(){l&&(s&&(t.type="drop",t.target=s,s.dispatchEvent(t)),t.type="dragend",e.dispatchEvent(t),l=!1),null==i||i.removeEventListener("pointermove",n)};e.addEventListener("pointerup",a,{once:!0}),e.addEventListener("pointerupoutside",a,{once:!0})}},this.rootNode=t,this.initEvents()}initEvents(){var t;null==(t=this.rootNode)||t.addEventListener("pointerdown",this.onPointerDown)}removeEvents(){var t;null==(t=this.rootNode)||t.removeEventListener("pointerdown",this.onPointerDown)}release(){this.removeEvents(),this.rootNode=null}}var uT=i(56447);class uR extends aq.rd{constructor(t,e,i,r,n){super(null,{},i,r,n),this.clipFromAttribute=t,this.clipToAttribute=e,this._group=null==n?void 0:n.group,this._clipGraphic=null==n?void 0:n.clipGraphic}onBind(){super.onBind(),this._group&&this._clipGraphic&&(this._lastClip=this._group.attribute.clip,this._lastPath=this._group.attribute.path,this._group.setAttributes({clip:!0,path:[this._clipGraphic]},!1,{type:a$.Gk.ANIMATE_BIND}))}onEnd(){this._group&&this._group.setAttributes({clip:this._lastClip,path:this._lastPath},!1,{type:a$.Gk.ANIMATE_END})}onUpdate(t,e,i){if(!this._clipGraphic)return;let r={};Object.keys(this.clipFromAttribute).forEach(t=>{r[t]=this.clipFromAttribute[t]+(this.clipToAttribute[t]-this.clipFromAttribute[t])*e}),this._clipGraphic.setAttributes(r,!1,{type:a$.Gk.ANIMATE_UPDATE,animationState:{ratio:e,end:t}})}}class uB extends uR{constructor(t,e,i,r,n){var s,l,a,o,h,u,d,c,p,g,f,m;let y,v,b=null!=(l=null==(s=null==n?void 0:n.group)?void 0:s.attribute)?l:{},_=null!=(a=b.width)?a:0,x=null!=(o=b.height)?o:0,C=null!=(h=null==n?void 0:n.animationType)?h:"in",w=null!=(u=null==n?void 0:n.startAngle)?u:0,S=null!=(d=null==n?void 0:n.orient)?d:"clockwise",A=0,M=0;"anticlockwise"===S?(M="in"===C?w+2*Math.PI:w,M=w+2*Math.PI):(A=w,M="out"===C?w+2*Math.PI:w);let k=aB.w.graphicService.creator.arc({x:null!=(p=null==(c=null==n?void 0:n.center)?void 0:c.x)?p:_/2,y:null!=(f=null==(g=null==n?void 0:n.center)?void 0:g.y)?f:x/2,outerRadius:null!=(m=null==n?void 0:n.radius)?m:(_+x)/2,innerRadius:0,startAngle:A,endAngle:M,fill:!0});"anticlockwise"===S?(y={startAngle:w+2*Math.PI},v={startAngle:w}):(y={endAngle:w},v={endAngle:w+2*Math.PI}),super("in"===C?y:v,"in"===C?v:y,i,r,{group:null==n?void 0:n.group,clipGraphic:k})}}class uP extends uR{constructor(t,e,i,r,n){var s,l,a,o,h,u,d,c,p;let g=null!=(l=null==(s=null==n?void 0:n.group)?void 0:s.attribute)?l:{},f=null!=(o=null!=(a=null==n?void 0:n.width)?a:g.width)?o:0,m=null!=(u=null!=(h=null==n?void 0:n.height)?h:g.height)?u:0,y=null!=(d=null==n?void 0:n.animationType)?d:"in",v=null!=(c=null==n?void 0:n.direction)?c:"x",b=null!=(p=null==n?void 0:n.orient)?p:"positive",_=aB.w.graphicService.creator.rect({x:0,y:0,width:"in"===y&&"x"===v?0:f,height:"in"===y&&"y"===v?0:m,fill:!0}),x={},C={};"y"===v?"negative"===b?(x={y:m,height:0},C={y:0,height:m}):(x={height:0},C={height:m}):"negative"===b?(x={x:f,width:0},C={x:0,width:f}):(x={width:0},C={width:f}),super("in"===y?x:C,"in"===y?C:x,i,r,{group:null==n?void 0:n.group,clipGraphic:_})}}var uE=i(70501),uI=i(21648),uL=i(41457);class uF extends aq.rd{constructor(t,e,i,r,n){var s,l;super(t,e,i,r,n),this.newPointAnimateType=null!=(s=null==n?void 0:n.newPointAnimateType)?s:"grow",this.clipRangeByDimension=null!=(l=null==n?void 0:n.clipRangeByDimension)?l:"x"}getPoints(t,e=!1){if(t.points)return t.points;if(t.segments){let i=[];return this.segmentsCache||(this.segmentsCache=[]),t.segments.map(t=>{var r,n;t.points&&i.push(...t.points),e&&this.segmentsCache.push(null!=(n=null==(r=t.points)?void 0:r.length)?n:0)}),i}return[]}onBind(){super.onBind();let{points:t,segments:e}=this.target.attribute,{points:i,segments:r}=this.target.getFinalAttribute();this.from={points:t,segments:e},this.to={points:i,segments:r},this.props=this.to;let n=this.getPoints(this.from),s=this.getPoints(this.to,!0);this.fromPoints=n?Array.isArray(n)?n:[n]:[],this.toPoints=s?Array.isArray(s)?s:[s]:[];let l=new Map;this.fromPoints.forEach(t=>{t.context&&l.set(t.context,t)});let a,o,h=1/0,u=-1/0;for(let t=0;t<this.toPoints.length;t+=1)if(l.has(this.toPoints[t].context)){h=t,a=l.get(this.toPoints[t].context);break}for(let t=this.toPoints.length-1;t>=0;t-=1)if(l.has(this.toPoints[t].context)){u=t,o=l.get(this.toPoints[t].context);break}"clip"===this.newPointAnimateType&&0!==this.toPoints.length&&(Number.isFinite(u)?(this.clipRange=this.toPoints[u][this.clipRangeByDimension]/this.toPoints[this.toPoints.length-1][this.clipRangeByDimension],1===this.clipRange&&(this.shrinkClipRange=this.toPoints[u][this.clipRangeByDimension]/this.fromPoints[this.fromPoints.length-1][this.clipRangeByDimension]),(0,uE.Z)(this.clipRange)?this.clipRange=(0,uI.Z)(this.clipRange,0,1):this.clipRange=0):this.clipRange=0);let d=this.toPoints[0];this.interpolatePoints=this.toPoints.map((t,e)=>{let i=l.get(t.context);return i?(d=i,[i,t]):"appear"===this.newPointAnimateType||"clip"===this.newPointAnimateType?[t,t]:e<h&&a?[a,t]:e>u&&o?[o,t]:[d,t]}),this.points=this.interpolatePoints.map(t=>{let e=t[0],i=t[1],r=new uL.E9(e.x,e.y,e.x1,e.y1);return r.defined=i.defined,r.context=i.context,r})}onFirstRun(){let t=this.target.attribute.clipRange;(0,uE.Z)(t*this.clipRange)&&(this.clipRange*=t)}onUpdate(t,e,i){if(t)return Object.keys(this.to).forEach(t=>{this.target.attribute[t]=this.to[t]}),this.target.addUpdatePositionTag(),void this.target.addUpdateShapeAndBoundsTag();if(this.points=this.points.map((t,i)=>{let r=(0,hl.q9)(this.interpolatePoints[i][0],this.interpolatePoints[i][1],e);return r.context=t.context,r}),this.clipRange){if(this.shrinkClipRange)return void(t?(i.points=this.toPoints,i.clipRange=1):(i.points=this.fromPoints,i.clipRange=this.clipRange-(this.clipRange-this.shrinkClipRange)*e));this.target.setAttributes({clipRange:this.clipRange+(1-this.clipRange)*e})}if(this.segmentsCache&&this.to.segments){let t=0,e=this.to.segments.map((e,i)=>{let r=t+this.segmentsCache[i],n=this.points.slice(t,r);return t=r,Object.assign(Object.assign({},e),{points:n})});this.target.attribute.segments=e}else this.target.attribute.points=this.points;this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}var uO=i(92851),uD=i(60116),uH=i(44785),uz=i(29562),uW=i(60678),uN=i(89258),uj=i(48110),uG=i(86946),uV=i(36376),uZ=i(81887),uU=i(85673),uK=i(93735),u$=i(888),uY=i(1977),uX=i(12839);let uq=t=>({type:"clipIn",options:{clipDimension:"horizontal"===t.direction?"y":"x"}}),uJ={type:"fadeIn"},uQ=t=>({type:"horizontal"===t.direction?"growPointsXIn":"growPointsYIn",options:{orient:"horizontal"===t.direction?"positive":"negative"}}),u0={appear:{duration:1e3,easing:"cubicOut"},update:{type:"update",duration:300,easing:"linear"},enter:{duration:300,easing:"linear"},exit:{duration:300,easing:"linear"},disappear:{duration:500,easing:"cubicIn"},state:{duration:300,easing:"linear"}},u1={appear:{type:"scaleIn"},enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:{type:"scaleOut"}},u2={appear:{type:"fadeIn"},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}},u3=()=>{iv.registerAnimation("scaleInOut",()=>u1)},u5=()=>{iv.registerAnimation("fadeInOut",()=>u2)},u4=()=>{iv.registerAnimation("cartesianGroupClip",t=>({appear:{custom:uP,customParameters:(e,i)=>({animationType:"in",group:i,direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()})},disappear:{custom:uP,customParameters:(e,i)=>({animationType:"out",group:i,direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()})}}))},u6=(t,e)=>({appear:function(t,e){switch(e){case"grow":return uQ(t);case"fadeIn":return uJ;default:return uq(t)}}(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},update:[{type:"update",options:{excludeChannels:["points","defined","segments"]}},{channel:["points","segments"],custom:uF,duration:u0.update.duration,easing:u0.update.easing,customParameters:{clipRangeByDimension:"horizontal"===t.direction?"y":"x"}}],disappear:{type:"clipOut"}}),u8=()=>{iv.registerAnimation("line",u6)},u9=()=>{iv.registerAnimation("area",u6)},u7=()=>{uO.a.registerBuiltInAnimate("scaleIn",uD.O),uO.a.registerBuiltInAnimate("scaleOut",uD.E),uO.a.registerBuiltInAnimate("fadeIn",uH.U),uO.a.registerBuiltInAnimate("fadeOut",uH.D),uO.a.registerBuiltInAnimate("moveIn",uz.V8),uO.a.registerBuiltInAnimate("moveOut",uz.vW),uO.a.registerBuiltInAnimate("rotateIn",uW.hD),uO.a.registerBuiltInAnimate("rotateOut",uW.XN),uO.a.registerBuiltInAnimate("update",uN.B),uO.a.registerBuiltInAnimate("state",uj.Z),uO.a.registerBuiltInAnimate("fromTo",uG.$)},dt=()=>{uO.a.registerBuiltInAnimate("growHeightIn",uV.HQ),uO.a.registerBuiltInAnimate("growHeightOut",uV.qG),uO.a.registerBuiltInAnimate("growWidthIn",uZ.dR),uO.a.registerBuiltInAnimate("growWidthOut",uZ.yi),uO.a.registerBuiltInAnimate("growCenterIn",uU.W),uO.a.registerBuiltInAnimate("growCenterOut",uU.B)},de=()=>{uO.a.registerBuiltInAnimate("growRadiusIn",uK.$),uO.a.registerBuiltInAnimate("growRadiusOut",uK.em),uO.a.registerBuiltInAnimate("growAngleIn",u$.kj),uO.a.registerBuiltInAnimate("growAngleOut",u$.j2)},di=()=>{uO.a.registerBuiltInAnimate("growPointsIn",uY.Kk),uO.a.registerBuiltInAnimate("growPointsOut",uY.Yf),uO.a.registerBuiltInAnimate("growPointsXIn",uY.xJ),uO.a.registerBuiltInAnimate("growPointsXOut",uY.$m),uO.a.registerBuiltInAnimate("growPointsYIn",uY.yQ),uO.a.registerBuiltInAnimate("growPointsYOut",uY.rf),uO.a.registerBuiltInAnimate("clipIn",uX.b),uO.a.registerBuiltInAnimate("clipOut",uX.v)},dr=()=>{uO.a.registerBuiltInAnimate("growPointsOut",uY.Yf)},dn=()=>{(0,uM.d)(),u7()},ds=()=>{iv.registerStageEventPlugin("drag",uk)},dl=()=>{iv.registerStageEventPlugin("gesture",uT.o)},da=t=>{let e=ed(t),i=[],r=[];return e.forEach(t=>{"empty"===t?i.push("view"):t6(t)&&"none"!==t?t.includes("view:")?(r.push(t.replace("view:","")),i.push("view")):(r.push(t),i.push("self")):tG(t)&&i.push("timeout")}),{eventNames:r,resetType:i}},dh=(t,e)=>{if(!e||!t)return null;let i={};return t.forEach(t=>{let r=t.stateStyle;r&&e.forEach(e=>{e&&r[e]&&(i[e]||(i[e]=[]),i[e].push(t.id))})}),i},du=(t,e)=>{if(!e||!e.length)return[];let i=[];return t.markIds?e.filter(e=>{t.markIds.includes(e.getProductId())&&i.push(e)}):t.markNames?e.forEach(e=>{t.markNames.includes(e.name)&&i.push(e)}):e.forEach(t=>{i.push(t)}),i},dd=t=>t.filterField?e=>{var i;return null==(i=iZ(e))?void 0:i[t.filterField]}:e=>e.context[t.filterType],dc={highlightState:j.STATE_HIGHLIGHT,blurState:j.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"};class dp{constructor(t){this._markSet=new sK,this.options=t,t.marks&&t.marks.length&&t.marks.forEach(t=>{this.registerMark(t)})}getMarks(){return this._markSet.getMarks()}getMarksByState(t){if(this._markIdByState&&this._markSet){let e=this._markIdByState[t];return e?this.getMarks().filter(t=>t&&e.includes(t.id)):[]}return[]}registerMark(t){tq(t)?t.forEach(t=>{this._markSet.addMark(t)}):this._markSet.addMark(t)}updateMarkIdByState(t){this._markIdByState=dh(this.getMarks(),t)}getMarkIdByState(){var t;return null!=(t=this._markIdByState)?t:{}}isGraphicInStateMark(t,e){var i;let r=this.getMarkIdByState();return r&&r[e]&&r[e].includes(null==(i=t.context)?void 0:i.markId)}isGraphicInMark(t){var e;return!!this._markSet.getMarkInId(null==(e=t.context)?void 0:e.markId)}getStartState(){return null}getResetState(){return null}init(){let t=this.getEvents();t&&this.options.event&&t.forEach(t=>{t.type&&t.handler&&(tq(t.type)?t.type.forEach(e=>{e&&"none"!==e&&this.options.event.on(e,t.handler)}):"none"!==t.type&&this.options.event.on(t.type,t.handler))})}release(){let t=this.getEvents();t&&this.options.event&&(null!=t?t:[]).forEach(t=>{t.type&&t.handler&&(tq(t.type)?t.type.forEach(e=>{e&&"none"!==e&&this.options.event.on(e,t.handler)}):"none"!==t.type&&this.options.event.off(t.type,t.handler))})}start(t){}reset(t){}dispatchEvent(t,e){this.options.event&&(this.options.event.emit(`${this.type}:${t}`,e),"start"===t&&this.options.onStart?this.options.onStart(e):"reset"===t&&this.options.onReset?this.options.onReset(e):"update"===t&&this.options.onUpdate?this.options.onUpdate(e):"end"===t&&this.options.onEnd&&this.options.onEnd(e))}}let dg={highlightState:j.STATE_HIGHLIGHT,blurState:j.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"};class df extends dp{constructor(t){super(t),this.type="element-highlight",this.resetAll=()=>{let{highlightState:t,blurState:e,interaction:i}=this.options;this._lastGraphic&&(i.clearAllStatesOfTrigger(this,t,e),this.dispatchEvent("reset",{graphics:[this._lastGraphic],options:this.options}),this._lastGraphic=null,i.setStatedGraphics(this,[]))},this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{let{interaction:e}=this.options,i=e.getStatedGraphics(this);if(!i||!i.length)return;let r=t.item,n=r&&this._markSet.getMarkInId(r.context.markId);(this._resetType.includes("view")&&!n||this._resetType.includes("self")&&n)&&this.resetAll()},this.options=Object.assign({},dg,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){let t=this.options.triggerOff,e=[{type:this.options.trigger,handler:this.handleStart}],i=t;return t6(t)&&t.includes("view:")?(i=t.replace("view:",""),this._resetType="view"):this._resetType="self",e.push({type:i,handler:this.handleReset}),e}start(t){if(t&&this._markSet.getMarkInId(t.context.markId)){let{highlightState:e,blurState:i,interaction:r}=this.options;if(this._lastGraphic===t)return;let n=r.updateStates(this,[t],r.getStatedGraphics(this),e,i);r.setStatedGraphics(this,n),this._lastGraphic=t,this.dispatchEvent("start",{graphics:n,options:this.options})}else this._lastGraphic&&"view"===this._resetType&&this.resetAll()}reset(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}df.type="element-highlight",df.defaultOptions=dg;let dm=()=>{iv.registerInteractionTrigger(df.type,df)},dy={state:j.STATE_SELECTED,trigger:"click"};class dv extends dp{constructor(t){super(t),this.type="element-select",this._resetType=[],this.resetAll=()=>{let{state:t,reverseState:e,interaction:i}=this.options,r=i.getStatedGraphics(this);r&&r.length&&(i.clearAllStatesOfTrigger(this,t,e),this.dispatchEvent("reset",{graphics:r,options:this.options}),i.setStatedGraphics(this,[]))},this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{let{interaction:e}=this.options,i=e.getStatedGraphics(this);if(!i||!i.length)return;let r=t.item,n=r&&this._markSet.getMarkInId(r.context.markId);(this._resetType.includes("view")&&!n||this._resetType.includes("self")&&n)&&this.resetAll()},this.options=Object.assign({},dy,t),this.updateMarkIdByState([this.options.state,this.options.reverseState])}getStartState(){return this.options.state}getResetState(){return this.options.reverseState}getEvents(){let t=this.options.triggerOff,e=this.options.trigger,i=[{type:e,handler:this.handleStart}],{eventNames:r,resetType:n}=da(t);return r.forEach(t=>{t&&(tq(e)?!e.includes(t):t!==e)&&i.push({type:t,handler:this.handleReset})}),this._resetType=n,i}start(t){let{state:e,reverseState:i,isMultiple:r,interaction:n}=this.options,s=n.getStatedGraphics(this);if(t&&this._markSet.getMarkInId(t.context.markId))if(t.hasState(e)){if(this._resetType.includes("self")){let r=s&&s.filter(e=>e!==t);r&&r.length?n.setStatedGraphics(this,n.updateStates(this,r,s,e,i)):this.resetAll()}}else{this._timer&&clearTimeout(this._timer),t.addState(e,!0);let l=this.options.interaction.updateStates(this,r&&s?[...s,t]:[t],s,e,i);n.setStatedGraphics(this,l),this.dispatchEvent("start",{graphics:l,options:this.options}),this._resetType.includes("timeout")&&(this._timer=setTimeout(()=>{this.resetAll()},this.options.triggerOff))}else this._resetType.includes("view")&&s&&s.length&&this.resetAll()}reset(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.state,this.options.reverseState]):this.resetAll()}}dv.type="element-select",dv.defaultOptions=dy;let db=()=>{iv.registerInteractionTrigger(dv.type,dv)};class d_ extends ud{constructor(t){super(),this.globalInstance=t}onInit(){this._plugins.forEach(t=>{t.onInit&&t.onInit(this)})}releaseAll(){super.releaseAll(),this.globalInstance=null}}var dx=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function l(t){try{o(r.next(t))}catch(t){s(t)}}function a(t){try{o(r.throw(t))}catch(t){s(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(l,a)}o((r=r.apply(t,e||[])).next())})},dC=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class dw{static useRegisters(t){t.forEach(t=>{"function"==typeof t?t():console.error("Invalid function:",t)})}static useChart(t){t.forEach(t=>iv.registerChart(t.type,t))}static useSeries(t){t.forEach(t=>iv.registerSeries(t.type,t))}static useComponent(t){t.forEach(t=>iv.registerComponent(t.type,t))}static useMark(t){t.forEach(t=>{var e;return iv.registerMark(null!=(e=t.constructorType)?e:t.type,t)})}static useLayout(t){t.forEach(t=>iv.registerLayout(t.type,t))}static registerDataSetTransform(t,e){iv.registerTransform(t,e)}static registerFunction(t,e){t&&e&&ob.instance().registerFunction(t,e)}static unregisterFunction(t){t&&ob.instance().unregisterFunction(t)}static getFunction(t){return t?ob.instance().getFunction(t):null}static getFunctionList(){return ob.instance().getFunctionNameList()}static registerMap(t,e,i){let r=iv.getImplementInKey("registerMap");r&&r(t,e,i)}static unregisterMap(t){let e=iv.getImplementInKey("unregisterMap");e&&e(t)}static getMap(t){return nQ.get(t)}static registerSVG(t,e,i){let r=iv.getImplementInKey("registerSVG");r&&r(t,e,i)}static unregisterSVG(t){let e=iv.getImplementInKey("unregisterSVG");e&&e(t)}static hideTooltip(t=[]){iI.forEach(t=>{var e;return null==(e=null==t?void 0:t.hideTooltip)?void 0:e.call(t)},t)}static getLogger(){return tU.getInstance()}getSpec(){return this._spec}getSpecInfo(){return this._specInfo}get event(){return this._event}getDataSet(){return this._dataSet}constructor(t,e){var i,r,n,s,l,a,o,h,u;this.id=ey(),this._userEvents=[],this._autoSize=!0,this._option={mode:rM["desktop-browser"],onError:t=>{throw Error(t)},optimize:{disableCheckGraphicWidthOutRange:!0}},this._observer=null,this._context={},this._doResize=()=>{let{width:t,height:e}=this.getCurrentSize();this._currentSize.width===t&&this._currentSize.height===e||(this._currentSize={width:t,height:e},this.resizeSync(t,e))},this._renderSync=(t={})=>{var e;return this._beforeRender(t)&&(null==(e=this._compiler)||e.render(t.morphConfig),this._updateAnimateState(!1),this._afterRender()),this},this._updateSpec=(t,e=!1,i)=>{var r;let n=this._spec,s={changeBackground:!1,reTransformSpec:!1,change:!1,reMake:!1,reCompile:!1,reSize:!1,changeTheme:!1};if(!this._setNewSpec(t,e))return;if(t5(n.theme,this._spec.theme)?t5(this._spec.background,n.background)||(s.reMake=!0,s.changeBackground=!0):s.changeTheme=!0,s.reSize=this._shouldChartResize(n),this._spec.type!==n.type)return null==(r=this._compiler)||r.updateLayoutTag(),s.reMake=!0,s.reTransformSpec=!0,s.change=!0,s.changeTheme=!0,s;this._initChartSpec(this._spec,"updateSpec");let l=sj(this._chart.updateSpec(this._spec),s);return i?Object.assign(Object.assign({},l),i):l},this.getTheme=(...t)=>{if(!this._currentTheme||!t||!t.length)return;this._cachedProcessedTheme||(this._cachedProcessedTheme={});let e=t.join(".");if(this._cachedProcessedTheme[e])return this._cachedProcessedTheme[e];let i=this._currentTheme;return t.forEach((e,r)=>{if(1!==r||"series"!==t[0]&&"component"!==t[0])i=null==i?void 0:i[e];else{let r="series"===t[0]?iv.getSeriesBuiltInTheme(e):iv.getComponentBuiltInTheme(e);i=i?ir({},r,i[e]):r}r===t.length-1&&t8(i)&&(i=function t(e,i,r){if(!e)return e;i||(i=e.colorScheme),r||(r=e.token);let n={};return Object.keys(e).forEach(s=>{let l=e[s];uu.includes(s)?n[s]=l:t1(l)?e7(l)?n[s]=e9(l,i):uh(l)?n[s]=uo(r,l):n[s]=t(l,i,r):n[s]=l}),n}({[e]:i},this._currentTheme.colorScheme,this._currentTheme.token)[e])}),this._cachedProcessedTheme[e]=i,i},function t(e,i=!1){if(null===e||"object"!=typeof e)return e;for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(void 0===e[r]){delete e[r];continue}i&&t(e[r],i)}}(e),this._option=Object.assign(Object.assign({},this._option),e),(null==e?void 0:e.optimize)&&(this._option.optimize=Object.assign(Object.assign({},this._option.optimize),e.optimize)),this._onError=null==(i=this._option)?void 0:i.onError;let d=this._option,{dom:c,renderCanvas:p,mode:g,stage:f,poptip:m}=d,y=dC(d,["dom","renderCanvas","mode","stage","poptip"]),v=eE(g);if(v?ut():"node"===g&&ur(),v&&c&&(this._container=t6(c)?ea.rF.getElementById(c):c),p&&(this._canvas=p),f&&(this._stage=f),"node"!==g&&!this._container&&!this._canvas&&!this._stage)return void(null==(r=this._option)||r.onError("please specify container or renderCanvas!"));this._viewBox=this._option.viewBox,this._currentThemeName=iL.getCurrentThemeName(),this._setNewSpec(t),this._updateCurrentTheme(),this._currentSize=this.getCurrentSize();let b=[];!1!==m&&b.push("poptipForText"),"sankey"===t.type&&b.push("scrollbar");let _=new tU(null!=(n=this._option.logLevel)?n:rT.Error);tU.setInstance(_),(null==(s=this._option)?void 0:s.onError)&&_.addErrorHandler((...t)=>{var e,i;null==(i=null==(e=this._option)?void 0:e.onError)||i.call(e,...t)}),this._compiler=new sE({dom:null!=(l=this._container)?l:"none",canvas:p},Object.assign(Object.assign({mode:this._option.mode,stage:f,pluginList:b},y),{background:this._getBackground(),onError:this._onError})),this._compiler.setSize(this._currentSize.width,this._currentSize.height),this._eventDispatcher=new iY(this,this._compiler),this._event=new iO(this._eventDispatcher,g),this._compiler.initView(),this._compiler.updateLayoutTag(),this._setFontFamilyTheme(this.getTheme("fontFamily")),this._initDataSet(this._option.dataSet),this._autoSize=!!v&&(null==(o=null!=(a=t.autoFit)?a:this._option.autoFit)||o),this._bindResizeEvent(),this._bindViewEvent(),this._initChartPlugin(),iI.registerInstance(this),null==(u=null==(h=this._option.performanceHook)?void 0:h.afterCreateVChart)||u.call(h,this)}_setNewSpec(t,e){return!!t&&(t6(t)&&(t=JSON.parse(t)),e&&this._originalSpec&&(t=ir({},this._originalSpec,t)),this._originalSpec=t,this._spec=this._getSpecFromOriginalSpec(),!0)}_getSpecFromOriginalSpec(){var t;let e=eh(this._originalSpec);return e.data=null!=(t=e.data)?t:[],e}_initChartSpec(t,e){var i,r;dw.getFunctionList()&&dw.getFunctionList().length&&(t=eu(t,dw)),this._spec=t,this._chartSpecTransformer||(this._chartSpecTransformer=iv.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),null==(i=this._chartSpecTransformer)||i.transformSpec(this._spec),this._chartPluginApply("onAfterChartSpecTransform",this._spec,e),this._specInfo=null==(r=this._chartSpecTransformer)?void 0:r.transformModelSpec(this._spec),this._chartPluginApply("onAfterModelSpecTransform",this._spec,this._specInfo,e)}_updateSpecInfo(){var t;this._chartSpecTransformer||(this._chartSpecTransformer=iv.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),this._specInfo=null==(t=this._chartSpecTransformer)?void 0:t.createSpecInfo(this._spec)}_initChart(t){var e,i,r;if(!this._compiler)return void(null==(e=this._option)||e.onError("compiler is not initialized"));if(this._chart)return void(null==(i=this._option)||i.onError("chart is already initialized"));let n=iv.createChart(t.type,t,this._getChartOption(t.type));n?(this._chart=n,this._chart.setCanvasRect(this._currentSize.width,this._currentSize.height),this._chart.created(this._chartSpecTransformer),this._chart.init(),this._event.emit(rI.initialized,{chart:n,vchart:this})):null==(r=this._option)||r.onError("init chart fail")}_releaseData(){this._dataSet&&(this._dataSet.dataViewMap={},this._dataSet=null)}_bindViewEvent(){var t,e;this._compiler&&(null==(e=null==(t=this._compiler.getStage())?void 0:t.getTimeline())||e.on("animationEnd",()=>{this._event.emit(rI.animationFinished,{chart:this._chart,vchart:this})}))}_bindResizeEvent(){var t,e;if(this._autoSize){if(this._onResize=iG(this._doResize,null!=(t=this._option.resizeDelay)?t:100),this._container){let t=window.ResizeObserver;t&&(this._observer=new t(this._onResize),null==(e=this._observer)||e.observe(this._container))}window.addEventListener("resize",this._onResize)}}_unBindResizeEvent(){this._autoSize&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))}getCurrentSize(){var t,e,i,r;return sN(this._spec,{container:this._container,canvas:this._canvas,mode:this._getMode(),modeParams:this._option.modeParams},{width:null!=(e=null==(t=this._currentSize)?void 0:t.width)?e:se,height:null!=(r=null==(i=this._currentSize)?void 0:i.height)?r:si})}_initDataSet(t){for(let e in this._dataSet=t instanceof tY?t:new tY,nJ(this._dataSet,"dataview",tJ),nJ(this._dataSet,"array",tz),nq(this._dataSet,"copyDataView",n3),iv.transforms)nq(this._dataSet,e,iv.transforms[e]);for(let t in iv.dataParser)nJ(this._dataSet,t,iv.dataParser[t])}updateCustomConfigAndRerender(t,e,i={}){if(!this._isReleased&&t)return tQ(t)&&(t=t()),t.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._reCompile(t),e?this._renderSync(i):this._renderAsync(i)}_updateCustomConfigAndRecompile(t,e={}){return!!t&&(this._reCompile(t),this._beforeRender(e))}_reCompile(t,e){var i,r,n,s,l,a,o;if(t.reMake&&(this._releaseData(),this._initDataSet(),null==(i=this._chart)||i.release(),this._chart=null),t.reTransformSpec&&(this._chartSpecTransformer=null),t.changeTheme?(this._setCurrentTheme(),this._setFontFamilyTheme(this.getTheme("fontFamily"))):t.changeBackground&&(null==(r=this._compiler)||r.setBackground(this._getBackground())),t.reMake?(null==(n=this._compiler)||n.releaseGrammar(),this._userEvents.forEach(t=>{var e;return null==(e=this._event)?void 0:e.on(t.eType,t.query,t.handler)})):t.reCompile&&(null==(s=this._compiler)||s.clear({chart:this._chart,vChart:this}),null==(l=this._compiler)||l.compile({chart:this._chart,vChart:this})),t.reSize){let{width:t,height:e}=this.getCurrentSize();this._currentSize={width:t,height:e},null==(a=this._chart)||a.onResize(t,e,!1),null==(o=this._compiler)||o.resize(t,e,!1)}}_beforeRender(t={}){var e,i,r,n,s,l,a,o;if(this._isReleased)return!1;if(this._chart)return!0;let{transformSpec:h,actionSource:u}=t;return h&&this._initChartSpec(this._spec,"render"),this._chartPluginApply("onBeforeInitChart",this._spec,u),null==(i=null==(e=this._option.performanceHook)?void 0:e.beforeInitializeChart)||i.call(e,this),this._initChart(this._spec),null==(n=null==(r=this._option.performanceHook)?void 0:r.afterInitializeChart)||n.call(r,this),!(!this._chart||!this._compiler)&&(null==(l=null==(s=this._option.performanceHook)?void 0:s.beforeCompileToVGrammar)||l.call(s,this),this._compiler.compile({chart:this._chart,vChart:this},t),null==(o=null==(a=this._option.performanceHook)?void 0:a.afterCompileToVGrammar)||o.call(a,this),!0)}_afterRender(){return!this._isReleased&&(this._event.emit(rI.rendered,{chart:this._chart,vchart:this}),!0)}renderSync(t){return this._renderSync({morphConfig:t,transformSpec:!0,actionSource:"render"})}renderAsync(t){return dx(this,void 0,void 0,function*(){return this._renderAsync({morphConfig:t,transformSpec:!0,actionSource:"render"})})}_renderAsync(t={}){return dx(this,void 0,void 0,function*(){return this._renderSync(t)})}_updateAnimateState(t){var e,i;if(this.isAnimationEnable()){let r=e=>{var i;let r=null==(i=e.context)?void 0:i.diffState;return t?"exit"===r?O.none:O.appear:r};null==(e=this._chart)||e.getAllRegions().forEach(t=>{t.updateAnimateStateCallback(r)}),null==(i=this._chart)||i.getAllComponents().forEach(t=>{t.updateAnimateStateCallback(r)})}}release(){var t,e,i,r;(null==(t=this._onResize)?void 0:t.cancel)&&this._onResize.cancel(),this._chartPluginApply("releaseAll"),this._chartPlugin=null,this._chartSpecTransformer=null,null==(e=this._chart)||e.release(),null==(i=this._eventDispatcher)||i.release(),null==(r=this._compiler)||r.release(),this._unBindResizeEvent(),this._releaseData(),this._onError=null,this._onResize=null,this._container=null,this._currentTheme=null,this._cachedProcessedTheme=null,this._option=null,this._chart=null,this._compiler=null,this._spec=null,this._specInfo=null,this._originalSpec=null,this._userEvents=null,this._event=null,this._eventDispatcher=null,this._isReleased=!0,iI.unregisterInstance(this)}updateData(t,e,i,r){return dx(this,void 0,void 0,function*(){return this.updateDataSync(t,e,i,r)})}_updateDataById(t,e,i){let r=this._spec.data.find(e=>e.name===t||e.id===t);r?r.id===t?r.values=e:r.name===t&&r.parse(e,i):tq(e)?this._spec.data.push({id:t,values:e}):this._spec.data.push(e)}updateDataInBatches(t){return dx(this,void 0,void 0,function*(){return this._chart?(this._chart.updateFullData(t.map(({id:t,data:e,options:i})=>({id:t,values:e,parser:i}))),this._chart.updateGlobalScaleDomain(),this._compiler.render()):(this._spec.data=ed(this._spec.data),t.forEach(({id:t,data:e,options:i})=>{this._updateDataById(t,e,i)})),this})}updateDataSync(t,e,i,r){return er(this._dataSet)||(this._chart?(this._chart.updateData(t,e,!0,i),(null==r?void 0:r.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render()):(this._spec.data=ed(this._spec.data),this._updateDataById(t,e,i))),this}updateFullDataSync(t,e=!0,i){if(this._chart)return this._chart.updateFullData(t),e&&((null==i?void 0:i.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render()),this;let r=ed(this._spec.data);return ed(t).forEach(t=>{let{id:e,values:i,parser:n,fields:s}=t,l=r.find(t=>t.name===e);if(l)l instanceof el?(l.setFields(t9(s)),l.parse(i,t9(n))):(l.values=i,t8(n)&&(l.parser=n),t8(s)&&(l.fields=s));else{let e=n4(t,this._dataSet,r);tq(this._spec.data)&&this._spec.data.push(e)}}),this}updateFullData(t,e=!0){return dx(this,void 0,void 0,function*(){return this.updateFullDataSync(t,e)})}updateSpec(t,e=!1,i,r){return dx(this,void 0,void 0,function*(){let n=this._updateSpec(t,e,r);return n&&(yield this.updateCustomConfigAndRerender(n,!1,{morphConfig:i,transformSpec:n.reTransformSpec,actionSource:"updateSpec"})),this})}updateSpecSync(t,e=!1,i,r){let n=this._updateSpec(t,e,r);return n&&this.updateCustomConfigAndRerender(n,!0,{morphConfig:i,transformSpec:n.reTransformSpec,actionSource:"updateSpec"}),this}updateSpecAndRecompile(t,e=!1,i={}){let r=this._updateSpec(t,e);return this._updateCustomConfigAndRecompile(r,Object.assign({actionSource:"updateSpecAndRecompile"},i))}updateModelSpec(t,e,i=!1,r){return dx(this,void 0,void 0,function*(){return this.updateModelSpecSync(t,e,i,r)})}updateModelSpecSync(t,e,i=!1,r){var n,s;if(!e||!this._spec)return this;if(t6(e)&&(e=JSON.parse(e)),tQ(t)||(n=this._spec,s=e,Object.keys(n).forEach(e=>{if(e_(t))t.type===e&&(tq(n[e])?n[e].length>=t.index&&(n[e][t.index]=i?ir({},n[e][t.index],s):s):n[e]=i?ir({},n[e],s):s);else if(tq(n[e])){let r=n[e].findIndex(e=>e.id===t);r>=0&&(n[e][r]=i?ir({},n[e][r],s):s)}else n.id===t&&(n[e]=i?ir({},n[e],s):s)})),this._chart){let n=this._chart.getModelInFilter(t);if(n)return this._updateModelSpec(n,e,!0,i,r)}return this}_updateModelSpec(t,e,i=!1,r=!1,n){r&&(e=ir({},t.getSpec(),e));let s=t.updateSpec(e);return t.reInit(e),(s.change||s.reCompile||s.reMake||s.reSize||s.reRender)&&this._chart.reDataFlow(),this.updateCustomConfigAndRerender(s,i,{morphConfig:n,transformSpec:!1,actionSource:"updateModelSpec"})}resize(t,e){return dx(this,void 0,void 0,function*(){return this.resizeSync(t,e)})}resizeSync(t,e){var i,r;return this._beforeResize(t,e)?(null==(r=(i=this._compiler).resize)||r.call(i,t,e),this._afterResize()):this}_beforeResize(t,e){var i,r,n,s;if(!this._chart||!this._compiler)return!1;let l=this._chart.getCanvasRect();return(!l||l.width!==t||l.height!==e)&&(this._chartPluginApply("onBeforeResize",t,e),null==(r=null==(i=this._option.performanceHook)?void 0:i.beforeResizeWithUpdate)||r.call(i,this),this._chart.onResize(t,e,!1),null==(s=null==(n=this._option.performanceHook)?void 0:n.afterResizeWithUpdate)||s.call(n,this),!0)}_afterResize(){return this._isReleased||this._event.emit(rI.afterResize,{chart:this._chart}),this}updateViewBox(t,e=!0,i=!0){return this._chart&&this._compiler&&(this._viewBox=t,this._chart.updateViewBox(t,i),i&&(this._compiler.render(),this._chart.onEvaluateEnd()),this._compiler.updateViewBox(t,e)),this}on(t,e,i){var r;this._userEvents&&(this._userEvents.push({eType:t,query:"function"==typeof e?null:e,handler:"function"==typeof e?e:i}),null==(r=this._event)||r.on(t,e,i))}off(t,e){var i;if(this._userEvents&&0!==this._userEvents.length)if(e){let r=this._userEvents.findIndex(i=>i.eType===t&&i.handler===e);r>=0&&(this._userEvents.splice(r,1),null==(i=this._event)||i.off(t,e))}else this._userEvents.forEach(e=>{var i;e.eType===t&&(null==(i=this._event)||i.off(t,e.handler))}),this._userEvents=this._userEvents.filter(e=>e.eType!==t)}updateState(t,e){this._chart&&this._chart.updateState(t,e)}setSelected(t,e,i){this._chart&&this._chart.setSelected(t,e,i)}setHovered(t,e,i){this._chart&&this._chart.setHovered(t,e,i)}clearState(t){this._chart&&this._chart.clearState(t)}clearAllStates(){this._chart&&this._chart.clearAllStates()}clearSelected(){this._chart&&this._chart.clearSelected()}clearHovered(){this._chart&&this._chart.clearHovered()}_updateCurrentTheme(t){var e,i,r;let n,s=this._option.theme,l=null==(e=this._spec)?void 0:e.theme,a=null==(i=this._spec)?void 0:i.type;t&&(this._currentThemeName=t);let o=(t,e)=>{var i;return(null==(i=e.chart)?void 0:i[t])&&(e=ib({},e,e.chart[t])),e};if(sD(s)&&sD(l))n=iF(this._currentThemeName),this._currentTheme=o(a,n);else if(t6(s)&&(!l||t6(l))||t6(l)&&(!s||t6(s))){let t=ib({},iF(this._currentThemeName),iF(s),iF(l));this._currentTheme=o(a,t)}else{let t=ib({},iF(this._currentThemeName),iF(s),iF(l));this._currentTheme=o(a,t)}this._cachedProcessedTheme=null,(0,sH.C)(this.getTheme("component","poptip")),null==(r=this._compiler)||r.setBackground(this._getBackground())}_shouldChartResize(t){var e,i;let r=!1;er(this._spec.width)?er(t.width)||(this._spec.width=t.width):this._spec.width!==t.width&&(r=!0),er(this._spec.height)?er(t.height)||(this._spec.height=t.height):this._spec.height!==t.height&&(r=!0);let n=this._autoSize;return this._autoSize=!!eE(this._option.mode)&&(null==(i=null!=(e=this._spec.autoFit)?e:this._option.autoFit)||i),this._autoSize!==n&&(r=!0),r}_getBackground(){return("string"==typeof this._spec.background||e_(this._spec.background)&&this._spec.background.gradient?this._spec.background:null)||this.getTheme("background")||this._option.background}getCurrentTheme(){return iF(this._currentThemeName)}getCurrentThemeName(){return this._currentThemeName}setCurrentTheme(t){return dx(this,void 0,void 0,function*(){return this.setCurrentThemeSync(t)})}setCurrentThemeSync(t){if(!iL.themeExist(t))return this;let e=this._setCurrentTheme(t);return this._setFontFamilyTheme(this.getTheme("fontFamily")),this.updateCustomConfigAndRerender(e,!0,{transformSpec:!1,actionSource:"setCurrentTheme"}),this}_setCurrentTheme(t){var e;return this._updateCurrentTheme(t),this._initChartSpec(this._getSpecFromOriginalSpec(),"setCurrentTheme"),null==(e=this._chart)||e.setCurrentTheme(),{change:!0,reMake:!1}}_setFontFamilyTheme(t){var e;t&&(null==(e=this.getStage())||e.setTheme({text:{fontFamily:t},richtext:{fontFamily:t}}))}_getTooltipComponent(){var t;return null==(t=this._chart)?void 0:t.getComponentsByType(rk.tooltip)[0]}setTooltipHandler(t){var e,i;this._context.tooltipHandler=t;let r=this._getTooltipComponent();r&&(null==(i=null==(e=r.tooltipHandler)?void 0:e.release)||i.call(e),r.tooltipHandler=t)}getTooltipHandlerByUser(){var t;return null==(t=this._context)?void 0:t.tooltipHandler}getTooltipHandler(){let t=this._getTooltipComponent();return t?t.tooltipHandler:this._context.tooltipHandler}showTooltip(t,e){var i;let r=this._getTooltipComponent();return null!=(i=t8(t)&&"none"!==(null==r?void 0:r.showTooltip(t,e)))&&i}hideTooltip(){var t;let e=this._getTooltipComponent();return null!=(t=null==e?void 0:e.hideTooltip())&&t}getLegendDataById(t){var e;let i=null==(e=this._chart)?void 0:e.getComponentByUserId(t);return i?i.getLegendData():[]}getLegendDataByIndex(t=0){var e;let i=null==(e=this._chart)?void 0:e.getComponentsByType(rk.discreteLegend);return i&&i[t]?i[t].getLegendData():[]}getLegendSelectedDataById(t){var e;let i=null==(e=this._chart)?void 0:e.getComponentByUserId(t);return i?i.getSelectedData():[]}getLegendSelectedDataByIndex(t=0){var e;let i=null==(e=this._chart)?void 0:e.getComponentsByType(rk.discreteLegend);return i&&i[t]?i[t].getSelectedData():[]}setLegendSelectedDataById(t,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentByUserId(t);r&&r.setSelectedData(e)}setLegendSelectedDataByIndex(t=0,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentsByType(rk.discreteLegend);r&&r[t]&&r[t].setSelectedData(e)}getDataURL(){var t;return dx(this,void 0,void 0,function*(){let e=this.getStage();if(this._chart&&e){e.render();let t=this._chart.getCanvas();return yield function(t,e){var i,r,n,s,l;return r=this,n=void 0,s=void 0,l=function*(){if(!t)return"";try{if(void 0!==OffscreenCanvas&&t instanceof OffscreenCanvas)return new Promise(e=>{t.convertToBlob().then(t=>{let i=new FileReader;i.readAsDataURL(t),i.onload=()=>{e(i.result)}})})}catch(t){(null!=(i=null==e?void 0:e.onError)?i:eD)(`getCanvasDataURL error : ${t.toString()}`)}return t.toDataURL()},new(s||(s=Promise))(function(t,e){function i(t){try{o(l.next(t))}catch(t){e(t)}}function a(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof s?r:new s(function(t){t(r)})).then(i,a)}o((l=l.apply(r,n||[])).next())})}(t,{onError:this._onError})}return null==(t=this._option)||t.onError(ReferenceError("render is not defined")),null})}exportImg(t){var e,i;return dx(this,void 0,void 0,function*(){if(!eE(this._option.mode))return void(null==(e=this._option)||e.onError(TypeError("non-browser environment can not export img")));let r=yield this.getDataURL();r?function(t="vchart",e){let i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank"),i.setAttribute("download",`${t}.png`),i.dispatchEvent(new MouseEvent("click"))}(t,r):null==(i=this._option)||i.onError(ReferenceError("render is not defined"))})}exportCanvas(){var t;let e=this.getStage();if(this._chart&&e)return e.toCanvas();null==(t=this._option)||t.onError(ReferenceError("render is not defined"))}getImageBuffer(){var t,e;if("node"!==this._option.mode)return void(null==(t=this._option)||t.onError(TypeError("getImageBuffer() now only support node environment.")));let i=this.getStage();return i?(i.render(),i.window.getImageBuffer()):(null==(e=this._option)||e.onError(ReferenceError("render is not defined")),null)}setLayout(t){var e;this._option.layout=t,null==(e=this._chart)||e.setLayout(t)}reLayout(){var t;this._chart.resetLayoutItemTag(),null==(t=this._chart)||t.setLayoutTag(!0)}getCompiler(){return this._compiler}getChart(){return this._chart}getStage(){return this._compiler.getStage()}getCanvas(){var t;return null==(t=this._compiler)?void 0:t.getCanvas()}getContainer(){var t;let e;return t8(this._container)?this._container:t8(e=t6(this._canvas)?ea.rF.getElementById(this._canvas):this._canvas)?e.parentElement:null==(t=this.getCanvas())?void 0:t.parentElement}getComponents(){return this._chart.getAllComponents()}getScale(t){var e;let i=null==(e=this._chart)?void 0:e.getGlobalScale();return null==i?void 0:i.getScale(t)}setDimensionIndex(t,e={}){var i;return null==(i=this._chart)?void 0:i.setDimensionIndex(t,e)}stopAnimation(){var t;null==(t=this.getStage())||t.stopAnimation(!0)}reRunNormalAnimation(){var t;null==(t=this.getStage())||t.reApplyAnimationState("normal",!0)}pauseAnimation(){var t;null==(t=this.getStage())||t.pauseAnimation(!0)}resumeAnimation(){var t;null==(t=this.getStage())||t.resumeAnimation(!0)}convertDatumToPosition(t,e={},i=!1,r){var n;let s;if(!this._chart||sD(t))return null;let{seriesId:l,seriesIndex:a=0}=e;if(t8(l)?s=this._chart.getSeriesInUserId(l):t8(a)&&(s=null==(n=this._chart.getSeriesInIndex([a]))?void 0:n[0]),s){let e,n=Object.keys(t),l=s.getViewData().latestData.find(e=>n.every(i=>e[i]==t[i])),a=s.getRegion().getLayoutStartPoint();return(e=l?s.dataToPosition(l,r):s.dataToPosition(t,r))?eT(e,a,i):null}return null}convertValueToPosition(t,e,i=!1){var r,n;let s;if(!this._chart||er(t)||sD(e))return null;if(!tq(t)){let n,{axisId:s,axisIndex:l}=e;if(t8(s)?n=this._chart.getComponentsByKey("axes").find(t=>t.userId===s):t8(l)&&(n=null==(r=this._chart.getComponentsByKey("axes"))?void 0:r[l]),!n)return eO("Please check whether the `axisId` or `axisIndex` is set!"),null;let a=null==n?void 0:n.valueToPosition(t);if(i){let t=n.getLayoutStartPoint(),e=n.getOrient();return a+("bottom"===e||"top"===e?t.x:t.y)}return a}let{seriesId:l,seriesIndex:a}=e;return t8(l)?s=this._chart.getSeriesInUserId(l):t8(a)&&(s=null==(n=this._chart.getSeriesInIndex([a]))?void 0:n[0]),s?eT(s.valueToPosition(t[0],t[1]),s.getRegion().getLayoutStartPoint(),i):(eO("Please check whether the `seriesId` or `seriesIndex` is set!"),null)}getFunction(t){return ob.instance().getFunction(t)}registerFunction(t,e){t&&e&&ob.instance().registerFunction(t,e)}unregisterFunction(t){t&&ob.instance().unregisterFunction(t)}getFunctionList(){return ob.instance().getFunctionNameList()}setRuntimeSpec(t){this._spec=t,this._updateSpecInfo()}updateIndicatorDataById(t,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentByUserId(t);r&&r.updateDatum(e)}updateIndicatorDataByIndex(t=0,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentsByType(rk.indicator);r&&r[t]&&r[t].updateDatum(e)}geoZoomByIndex(t=0,e,i){this._geoZoomByQuery({regionIndex:t},e,i)}geoZoomById(t,e,i){this._geoZoomByQuery({regionId:t},e,i)}_geoZoomByQuery(t,e,i){var r,n;let s=null==(r=this._chart)?void 0:r.getRegionsInQuerier(t)[0],l=null==(n=this._chart)?void 0:n.getComponentsByType(rk.geoCoordinate),a=null==l?void 0:l.find(t=>{var e;return null==(e=t.getRegions())?void 0:e.includes(s)});a&&a.dispatchZoom(e,i)}_initChartPlugin(){let t=iv.getChartPlugins();t.length>0&&(this._chartPlugin=new uc(this),this._chartPlugin.load(t.map(t=>new t)),this._chartPluginApply("onInit",this._spec));let e=iv.getVChartPlugins();e.length>0&&(this._vChartPlugin=new d_(this),this._vChartPlugin.load(e.map(t=>new t)),this._vChartPlugin.onInit())}_chartPluginApply(t,...e){this._chartPlugin&&this._chartPlugin[t]&&this._chartPlugin[t].apply(this._chartPlugin,e)}_getMode(){return this._option.mode||rM["desktop-browser"]}isAnimationEnable(){return"animation"in this._option?!!this._option.animation:!1!==this._spec.animation}_getChartOption(t){return{type:t,globalInstance:this,eventDispatcher:this._eventDispatcher,dataSet:this._dataSet,container:this._container,canvas:this._canvas,map:new Map,mode:this._getMode(),modeParams:this._option.modeParams,getCompiler:()=>this._compiler,viewBox:this._viewBox,getTheme:this.getTheme,getSpecInfo:()=>{var t;return null!=(t=this._specInfo)?t:{}},layout:this._option.layout,onError:this._onError,disableTriggerEvent:!0===this._option.disableTriggerEvent}}}dw.InstanceManager=iI,dw.ThemeManager=iL,dw.globalConfig={uniqueTooltip:!0},dw.Utils={measureText:ov},dw.vglobal=ea.rF,iv.registerRegion("region",s5),iv.registerLayout("base",lr),of(),dl(),dm(),db(),iT(ej.name,ej);let dS=(t,e)=>{let i=t;return!0!==e&&(i=t.sort(lh)),function(t,e,i=l2){let r=t.length;if(!r)return;if(r<2)return i(t[0],0,t);!1;let n=(r-1)*e,s=Math.floor(n),l=i(t[s],s,t);return l+(i(t[s+1],s+1,t)-l)*(n-s)}(i,.5)};function dA(t,e,i,r){let n,s,l=-1;t.forEach(t=>{n=e(t),s=i(t),!er(n)&&(n*=1)>=n&&!er(s)&&(s*=1)>=s&&r(n,s,++l)})}let dM=Math.abs,dk=Math.max,dT=Math.sqrt,dR=Math.pow;function dB(t,e){return t[0]*e[1]-t[1]*e[0]}function dP(t,e){let i=0;for(let r=0;r<t.length;++r)i+=t[r]*e[r];return i}function dE(t,e=10){return Math.round(t*e)/e}function dI(t){let e=t.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-(+e[1]||0);return i>0?i:0}function dL(t,e){return dE(t+e,10**Math.max(dI(t),dI(e)))}function dF(t,e){return dE(t-e,10**Math.max(dI(t),dI(e)))}class dO{constructor(t=0,e=0,i,r){this.x=0,this.y=0,this.x=t,this.y=e,this.x1=i,this.y1=r}clone(){return new dO(this.x,this.y)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}set(t,e){return this.x=t,this.y=e,this}add(t){return tG(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}sub(t){return tG(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}multi(t){throw Error("暂不支持")}div(t){throw Error("暂不支持")}}class dD{static distancePP(t,e){return dT(dR(t.x-e.x,2)+dR(t.y-e.y,2))}static distanceNN(t,e,i,r){return dT(dR(t-i,2)+dR(e-r,2))}static distancePN(t,e,i){return dT(dR(e-t.x,2)+dR(i-t.y,2))}static pointAtPP(t,e,i){return new dO((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}function dH(t,e){let i=[];return t.forEach(t=>{let r=+t[e];en(r)&&i.push(r)}),0===i.length?null:eg(i)}function dz(t,e){let i=[];return t.forEach(t=>{let r=+t[e];en(r)&&i.push(r)}),0===i.length?null:ep(i)}function dW(t,e){return t.reduce((t,i)=>{let r=e?+i[e]:+i;return en(r)&&(t+=r),t},0)}function dN(t,e){let i=0,r=0;return t.forEach(t=>{let n=e?+t[e]:+t;en(n)&&(i+=n,r++)}),i/r}function dj(t,e){let i=dN(t,e);return t.length<=1?0:t.reduce((t,r)=>t+(e?+r[e]:r-i)**2,0)/(t.length-1)}function dG(t,e){let i=dV(t),r=dV(e),n=Math.asin((t.x*e.y-e.x*t.y)/i/r),s=Math.acos((t.x*e.x+t.y*e.y)/i/r);return n<0?-s:s}function dV(t,e={x:0,y:0}){return dD.distancePP(t,e)}function dZ(t){return en(t.x)&&en(t.y)}function dU(t,e){for(let i=0;i<e.length;i++){let r=e[i],n=function(t,e){return t.find(t=>t.key===e)}(t,r.key);n?n.operations=[...new Set(n.operations.concat(r.operations))]:t.push(r)}return t}function dK(t,e){var i;if(!t)return null!=e?e:null;let r=t.getFields();return r&&r[e]?null!=(i=r[e].alias)?i:e:null!=e?e:null}function d$(t,e,i){let r=t.getStackSort(),n={},s=null;return r&&(s={},t.getSeries().forEach(t=>{let e=t.getSeriesField();if(e){let i=t.getRawDataStatisticsByField(e);i.values&&(s[e]||(s[e]={lastIndex:0,sort:{}}),i.values.forEach((t,i)=>{t in s[e].sort||(s[e].sort[t]=s[e].lastIndex,s[e].lastIndex++)}))}})),t.getSeries().forEach(t=>{var r;let l=t.getStackData(),a=t.getStackValue(),o=t.getStackValueField(),h=!i||i(t);l&&o&&h&&(n[a]=null!=(r=n[a])?r:{groupField:l.groupField,nodes:{}},d1(t,l,n[a],o,e,s))}),r?dY(n,s):n}function dY(t,e){var i;for(let r in t)(null==(i=t[r].sortDatums)?void 0:i.length)?(t[r].sortDatums.sort((t,e)=>t.index-e.index),t[r].values=t[r].sortDatums.map(t=>t.datum)):dY(t[r].nodes,e);return t}function dX(t,e){if("values"in t&&t.values.length){let i=dW(t.values,e),r=dz(t.values,sc);t.values.forEach(t=>{t[sf]=i,t[sm]=r})}else for(let i in t.nodes)dX(t.nodes[i],e)}function dq(t,e){var i,r;if("values"in t&&t.values.length)t8(null==(i=t.values[0])?void 0:i[sf])?t.total=null==(r=t.values[0])?void 0:r[sf]:t.total=dW(t.values,e);else{for(let i in t.nodes)dq(t.nodes[i],e);t.nodes&&(t.total=dW(Object.keys(t.nodes).map(e=>t.nodes[e]),"total"))}}function dJ(t,e,i){var r;if(e.groupField&&e.nodes){let i=(null==(r=t.getRawDataStatisticsByField(e.groupField,!1))?void 0:r.values)||[],n={key:`${e.groupField}`,values:i.map(i=>{var r,n;let s,l=e.nodes[i];return{groupValue:i,value:s=t.bandWidthField&&null!=(n=null==(r=l.values.find(e=>t8(e[t.bandWidthField])))?void 0:r[t.bandWidthField])?n:l.total,end:s}})};d0(n,!1,!0,!1,{key:"groupField",start:"start",end:"end",startPercent:"startPercent",endPercent:"endPercent"}),n.values.forEach(t=>{e.nodes[t.groupValue].mosaicData=t})}else if("values"in e&&e.values.length&&i&&i.length){let t=i.length,r=0,n=1,s=0,l=1;for(let e=0;e<t;e++)if(e%2==0){let t=n-r;n=r+i[e].endPercent*t,r+=i[e].startPercent*t}else{let t=l-s;l=s+i[e].endPercent*t,s+=i[e].startPercent*t}t%2==0?e.values.forEach(t=>{let e=n-r;t[sC]=r+e*t[sc],t[sx]=r+e*t[sd],t[s_]=l,t[sb]=s}):e.values.forEach(t=>{let e=l-s;t[s_]=s+e*t[sc],t[sb]=s+e*t[sd],t[sC]=n,t[sx]=r})}for(let r in e.nodes)dJ(t,e.nodes[r],e.nodes[r].mosaicData?i?[...i,e.nodes[r].mosaicData]:[e.nodes[r].mosaicData]:null)}function dQ(t){if(!t.values.length)return;let e=t.values[t.values.length-1][su]/2;for(let i=0;i<t.values.length;i++)t.values[i][sp]=t.values[i][sh]-e,t.values[i][sg]=t.values[i][su]-e}function d0(t,e,i,r,n={key:so,start:sh,end:su,startPercent:sd,endPercent:sc,max:sy,min:sv}){let s=r&&t8(n.min),l=r&&t8(n.max);if(t.values.length>0){let r=0,a=0,o=1,h=0,u=null,d=null,c=t.values.length;for(let i=0;i<c;i++){let o=t.values[e?c-1-i:i];(h=o[n.end])>=0?(o[n.start]=r,r+=o[n.end],o[n.end]=r):(o[n.start]=a,a+=o[n.end],o[n.end]=a),o[n.key]=t.key,l&&(delete o[n.max],(!d||o[n.end]>d[n.end])&&(d=o)),s&&(delete o[n.min],(!u||o[n.start]<u[n.start])&&(u=o))}if(l&&d&&(d[n.max]=!0),s&&u&&(u[n.min]=!0),i)for(let i=0;i<c;i++){let s=t.values[e?c-1-i:i],l=(h=s[n.end])>=0?r:a;o=h>=0?1:-1,s[n.startPercent]=0===l?0:Math.min(1,s[n.start]/l)*o,s[n.endPercent]=0===l?0:Math.min(1,s[n.end]/l)*o}}for(let s in t.nodes)d0(t.nodes[s],e,i,r,n)}function d1(t,e,i,r,n,s,l){var a;if("values"in e)if(n&&e.values.forEach(t=>t[su]=function(t){if(en(t))return t;let e=+t;return en(e)?e:0}(t[r])),i.series.push({s:t,values:e.values}),s){let r=t.getSeriesField();e.values.forEach(e=>{i.sortDatums.push({series:t,datum:e,index:r?s[r].sort[e[r]]:0})})}else i.values.push(...e.values);else for(let o in e.nodes){let h=l?`${l}_${o}`:o;i.nodes[o]||(i.nodes[o]={values:[],series:[],nodes:{},sortDatums:[],key:h},t8(null==(a=e.nodes[o])?void 0:a.groupField)&&(i.nodes[o].groupField=e.nodes[o].groupField)),d1(t,e.nodes[o],i.nodes[o],r,n,s,h)}}let d2=(t,e)=>{let i=e.beforeCall();return t&&t.forEach((t,r)=>e.call(t,r,i)),i.keyMap&&(i.keyMap.clear(),i.keyMap=null),t};class d3{static getInstance(){return d3.instance||(d3.instance=new d3),d3.instance}constructor(){this.locale_shortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.locale_periods=["AM","PM"],this.locale_weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.locale_shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.numberRe=/^\s*\d+/,this.pads={"-":"",_:" ",0:"0"},this.requoteRe=/[\\^$*+?|[\]().{}]/g,this.locale_months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.formatShortWeekday=t=>this.locale_shortWeekdays[t.getDay()],this.formatWeekday=t=>this.locale_weekdays[t.getDay()],this.formatShortMonth=t=>this.locale_shortMonths[t.getMonth()],this.formatMonth=t=>this.locale_months[t.getMonth()],this.formatDayOfMonth=(t,e)=>this.pad(t.getDate(),e,2),this.formatHour24=(t,e)=>this.pad(t.getHours(),e,2),this.formatHour12=(t,e)=>this.pad(t.getHours()%12||12,e,2),this.formatMilliseconds=(t,e)=>this.pad(t.getMilliseconds(),e,3),this.formatMonthNumber=(t,e)=>this.pad(t.getMonth()+1,e,2),this.formatMinutes=(t,e)=>this.pad(t.getMinutes(),e,2),this.formatPeriod=t=>this.locale_periods[+(t.getHours()>=12)],this.formatSeconds=(t,e)=>this.pad(t.getSeconds(),e,2),this.formatFullYear=(t,e)=>this.pad(t.getFullYear()%1e4,e,4),this.formatUTCShortWeekday=t=>this.locale_shortWeekdays[t.getUTCDay()],this.formatUTCWeekday=t=>this.locale_weekdays[t.getUTCDay()],this.formatUTCShortMonth=t=>this.locale_shortMonths[t.getUTCMonth()],this.formatUTCMonth=t=>this.locale_months[t.getUTCMonth()],this.formatUTCDayOfMonth=(t,e)=>this.pad(t.getUTCDate(),e,2),this.formatUTCHour24=(t,e)=>this.pad(t.getUTCHours(),e,2),this.formatUTCHour12=(t,e)=>this.pad(t.getUTCHours()%12||12,e,2),this.formatUTCMilliseconds=(t,e)=>this.pad(t.getUTCMilliseconds(),e,3),this.formatUTCMonthNumber=(t,e)=>this.pad(t.getUTCMonth()+1,e,2),this.formatUTCMinutes=(t,e)=>this.pad(t.getUTCMinutes(),e,2),this.formatUTCPeriod=t=>this.locale_periods[+(t.getUTCHours()>=12)],this.formatUTCSeconds=(t,e)=>this.pad(t.getUTCSeconds(),e,2),this.formatUTCFullYear=(t,e)=>this.pad(t.getUTCFullYear()%1e4,e,4),this.formats={a:this.formatShortWeekday,A:this.formatWeekday,b:this.formatShortMonth,B:this.formatMonth,d:this.formatDayOfMonth,e:this.formatDayOfMonth,H:this.formatHour24,I:this.formatHour12,L:this.formatMilliseconds,m:this.formatMonthNumber,M:this.formatMinutes,p:this.formatPeriod,S:this.formatSeconds,Y:this.formatFullYear},this.utcFormats={a:this.formatUTCShortWeekday,A:this.formatUTCWeekday,b:this.formatUTCShortMonth,B:this.formatUTCMonth,d:this.formatUTCDayOfMonth,e:this.formatUTCDayOfMonth,H:this.formatUTCHour24,I:this.formatUTCHour12,L:this.formatUTCMilliseconds,m:this.formatUTCMonthNumber,M:this.formatUTCMinutes,p:this.formatUTCPeriod,S:this.formatUTCSeconds,Y:this.formatUTCFullYear},this.parseShortWeekday=(t,e,i)=>{let r=this.shortWeekdayRe.exec(e.slice(i));return r?(t.w=this.shortWeekdayLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseWeekday=(t,e,i)=>{let r=this.weekdayRe.exec(e.slice(i));return r?(t.w=this.weekdayLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseShortMonth=(t,e,i)=>{let r=this.shortMonthRe.exec(e.slice(i));return r?(t.m=this.shortMonthLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseMonth=(t,e,i)=>{let r=this.monthRe.exec(e.slice(i));return r?(t.m=this.monthLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseDayOfMonth=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.d=+r[0],i+r[0].length):-1},this.parseHour24=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.H=+r[0],i+r[0].length):-1},this.parseMilliseconds=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+3));return r?(t.L=+r[0],i+r[0].length):-1},this.parseMonthNumber=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.m=r-1,i+r[0].length):-1},this.parseMinutes=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.M=+r[0],i+r[0].length):-1},this.parsePeriod=(t,e,i)=>{let r=this.periodRe.exec(e.slice(i));return r?(t.p=this.periodLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseSeconds=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.S=+r[0],i+r[0].length):-1},this.parseFullYear=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+4));return r?(t.y=+r[0],i+r[0].length):-1},this.parses={a:this.parseShortWeekday,A:this.parseWeekday,b:this.parseShortMonth,B:this.parseMonth,d:this.parseDayOfMonth,e:this.parseDayOfMonth,H:this.parseHour24,I:this.parseHour24,L:this.parseMilliseconds,m:this.parseMonthNumber,M:this.parseMinutes,p:this.parsePeriod,S:this.parseSeconds,Y:this.parseFullYear},this.timeFormat=(t,e)=>this.newFormat(t,this.formats)(new Date(this.getFullTimeStamp(e))),this.timeUTCFormat=(t,e)=>this.newFormat(t,this.utcFormats)(new Date(this.getFullTimeStamp(e))),this.timeParse=(t,e)=>this.newParse(t,!1)(e+""),this.requoteF=this.requote.bind(this),this.periodRe=this.formatRe(this.locale_periods),this.periodLookup=this.formatLookup(this.locale_periods),this.weekdayRe=this.formatRe(this.locale_weekdays),this.weekdayLookup=this.formatLookup(this.locale_weekdays),this.shortWeekdayRe=this.formatRe(this.locale_shortWeekdays),this.shortWeekdayLookup=this.formatLookup(this.locale_shortWeekdays),this.monthRe=this.formatRe(this.locale_months),this.monthLookup=this.formatLookup(this.locale_months),this.shortMonthRe=this.formatRe(this.locale_shortMonths),this.shortMonthLookup=this.formatLookup(this.locale_shortMonths)}requote(t){return t.replace(this.requoteRe,"\\$&")}localDate(t){if(0<=t.y&&t.y<100){let e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}utcDate(t){if(0<=t.y&&t.y<100){let e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}newDate(t,e,i){return{y:t,m:e,d:i,H:0,M:0,S:0,L:0}}formatRe(t){return RegExp("^(?:"+t.map(this.requoteF).join("|")+")","i")}formatLookup(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}pad(t,e,i){let r=t<0?"-":"",n=(r?-t:t)+"",s=n.length;return r+(s<i?Array(i-s+1).join(e)+n:n)}parseSpecifier(t,e,i,r){let n,s,l=0,a=e.length,o=i.length;for(;l<a;){if(r>=o)return -1;if(37===(n=e.charCodeAt(l++))){if(n=e.charAt(l++),!(s=this.parses[n in this.pads?e.charAt(l++):n])||(r=s(t,i,r))<0)return -1}else if(n!==i.charCodeAt(r++))return -1}return r}newParse(t,e){let i=this;return function(r){let n=i.newDate(1900,void 0,1);return i.parseSpecifier(n,t,r+="",0)!==r.length?null:"Q"in n?new Date(n.Q):"s"in n?new Date(1e3*n.s+("L"in n?n.L:0)):(!e||"Z"in n||(n.Z=0),"p"in n&&(n.H=n.H%12+12*n.p),void 0===n.m&&(n.m="q"in n?n.q:0),"Z"in n?(n.H+=n.Z/100|0,n.M+=n.Z%100,i.utcDate(n)):i.localDate(n))}}newFormat(t,e){let i=this;return function(r){let n,s,l=[],a=-1,o=0,h=t.length;for(r instanceof Date||(r=new Date(+r));++a<h;)37===t.charCodeAt(a)&&(l.push(t.slice(o,a)),(s=i.pads[n=t.charAt(++a)])?n=t.charAt(++a):s="e"===n?" ":"0",l.push(n=(0,e[n])(r,s)),o=a+1);return l.push(t.slice(o,a)),l.join("")}}getFullTimeStamp(t){let e=parseInt(t+"",10);return 10===String(e).length?1e3*e:e}}function d5(t,e){return e("component",t)}function d4(t,e,i,r){if(t)return{formatFunc:t,args:[i,r]};let n=iv.getFormatter();return e&&n?{formatFunc:n,args:[i,r,e]}:{}}let d6=(t,e,i,r)=>{if(er(t[e]))return;let n=tq(t[e]),s=n?t[e]:[t[e]],l=[];return s.forEach((t,s)=>{t&&(!r||r(t))&&l.push({spec:t,specPath:n?[e,s]:[e],specInfoPath:["component",e,s],type:i})}),l},d8=(t,e,i,r)=>{let n;if(n=tQ(t)?t(e,i):t1(t)&&t8(t.field)?iW(e,t.field):t,r){let{formatFunc:i,args:s}=d4(void 0,r,t,e);i&&s&&(n=i(...s))}return n},d9=(t,e,i)=>er(t)?t:tQ(t)?t(e,i):t;var d7=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let ct=t=>{var e,i,r;if(!1===(null==t?void 0:t.visible))return[];let n={mark:!1!==(null==(e=null==t?void 0:t.mark)?void 0:e.visible),dimension:!1!==(null==(i=null==t?void 0:t.dimension)?void 0:i.visible),group:!1!==(null==(r=null==t?void 0:t.group)?void 0:r.visible)};return t8(null==t?void 0:t.activeType)&&Object.keys(n).forEach(e=>{var i;n[e]=null==(i=null==t?void 0:t.activeType)?void 0:i.includes(e)}),Object.keys(n).filter(t=>n[t])},ce=(t,e)=>!e||!1!==e.visible&&(!e[t]||!1!==e[t].visible)&&!(e.activeType&&!(tq(e.activeType)?e.activeType.includes(t):e.activeType===t));function ci(t,e,i,r,n,s){let l=e=>{if(e){let l={datum:n},a=er(e.key)&&er(e.value)&&!sD(e)?Object.assign(Object.assign(Object.assign({},r),i),e):Object.assign(Object.assign({},r),e),{key:o,keyFormatter:h,keyTimeFormat:u,keyTimeFormatMode:d,value:c,valueFormatter:p,valueTimeFormat:g,valueTimeFormatMode:f}=a,m=d7(a,["key","keyFormatter","keyTimeFormat","keyTimeFormatMode","value","valueFormatter","valueTimeFormat","valueTimeFormatMode"]);l.key=cn(d8(o,n,s,h),u,d),l.value=cn(d8(c,n,s,p),g,f),Object.keys(m).forEach(t=>{l[t]=d8(a[t],n,s)}),!1!==l.visible&&(t8(l.key)||t8(l.value))&&t.push(l)}};tq(e)?e.forEach(t=>{l(t)}):l(e)}function cr(t,e,i,r,n,s,l){tQ(e)?ci(t,e(n,l),i,r,s,l):e&&ci(t,e,i,r,s,l)}let cn=(t,e,i)=>{if(!e&&!i)return"object"!=typeof t?null==t?void 0:t.toString():t;let r=d3.getInstance();return e=e||"%Y%m%d",("local"===(i=i||"local")?r.timeFormat:r.timeUTCFormat)(e,t)};class cs{constructor(t){this.activeTriggerSet={mark:new Set,group:new Set},this.ignoreTriggerSet={mark:new Set},this._getSeriesCacheInfo=()=>{var t,e,i;let{series:r}=this,n=r.getSeriesField();return{seriesFields:t8(n)?ed(n):null!=(t=r.getSeriesKeys())?t:[],dimensionFields:null!=(e=r.getDimensionField())?e:[],measureFields:null!=(i=r.getMeasureField())?i:[],type:r.type}},this._getDimensionData=t=>{let{dimensionFields:e}=this._seriesCacheInfo;return e[0]&&(null==t?void 0:t[e[0]])},this._getMeasureData=t=>{let{measureFields:e}=this._seriesCacheInfo;return e[0]&&(null==t?void 0:t[e[0]])},this._getSeriesFieldData=t=>{let{dimensionFields:e,seriesFields:i}=this._seriesCacheInfo;if(t8(i[0])&&(null==t?void 0:t[i[0]]))return null==t?void 0:t[i[0]];let r=e[e.length-1];return e.length>1&&(0===i.length||this.series.getSeriesKeys().length),null==t?void 0:t[r]},this._getSeriesStyle=(t,e,i)=>{var r;for(let i of ed(e)){let e=null==(r=this.series.getSeriesStyle(t))?void 0:r(i);if(t8(e))return e}return i},this.markTooltipKeyCallback=(t,e)=>this._getSeriesFieldData(t),this.markTooltipValueCallback=(t,e)=>this._getMeasureData(t),this.shapeTypeCallback=(t,e)=>{var i;return null!=(i=this._getSeriesStyle(t,"shape",null))?i:this._getSeriesStyle(t,"symbolType",this.series.getDefaultShapeType())},this.shapeColorCallback=(t,e)=>this._getSeriesStyle(t,["fill","stroke"]),this.shapeStrokeCallback=(t,e)=>this._getSeriesStyle(t,["stroke","fill"]),this.dimensionTooltipTitleCallback=(t,e)=>this._getDimensionData(t),this.groupTooltipTitleCallback=(t,e)=>this._getSeriesFieldData(t),this.groupTooltipKeyCallback=(t,e)=>{let{seriesFields:i}=this._seriesCacheInfo,r=this._seriesCacheInfo.dimensionFields;return i[0]&&(r=r.filter(t=>t!==i[0])),r.map(e=>null==t?void 0:t[e]).join("-")},this.getHasShape=t=>!!t,this.series=t,this.updateTooltipSpec()}updateTooltipSpec(){var t;let e=null==(t=this.series.getSpec())?void 0:t.tooltip;this.spec=e,this._seriesCacheInfo=this._getSeriesCacheInfo()}getShapeAttrs(t,e,i){var r,n,s,l,a,o,h,u,d,c,p,g;let f=e?"content":"title",m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},null==(r=null==i?void 0:i.style)?void 0:r.shape),null==i?void 0:i[t]),null==(n=null==i?void 0:i[t])?void 0:n[f]),null==(s=this.spec)?void 0:s[t]),null==(a=null==(l=this.spec)?void 0:l[t])?void 0:a[f]);return{shapeType:null!=(o=m.shapeType)?o:this.shapeTypeCallback,shapeFill:null!=(u=null!=(h=m.shapeFill)?h:m.shapeColor)?u:this.shapeColorCallback,shapeStroke:null!=(d=m.shapeStroke)?d:this.shapeStrokeCallback,shapeHollow:null!=(c=m.shapeHollow)&&c,shapeLineWidth:m.shapeLineWidth,shapeSize:null!=(p=m.shapeSize)?p:m.size,hasShape:null!=(g=m.hasShape)?g:this.getHasShape(e)}}enableByType(t){return!0}getDefaultContentList(t){return[this.getDefaultContentPattern(t)]}getContentList(t,e,i,r,n,s){var l;return function(t,e,i,r,n,s){if(n&&n.length){let l=[];return n.forEach(n=>{tq(t)?t.forEach(t=>{cr(l,t,e,i,r,n,s)}):tQ(t)?cr(l,t,e,i,r,n,s):t&&ci(l,t,e,i,n,s)}),l}return null}(null!=(l=null==e?void 0:e.content)?l:this.getDefaultContentList(t),this.getDefaultContentPattern(t),i,r,n,s)}getTitleResult(t,e,i,r,n){let s=tQ(e)?e(r,n):e;if(s?er(s.value)&&(s=Object.assign(Object.assign({},this.getDefaultTitlePattern(t)),s)):s=this.getDefaultTitlePattern(t),s&&!1!==s.visible){let t=function(t){var e;for(let{data:i}of(null==(e=t[0])?void 0:e.series)?[{data:t,value:""}]:t)for(let{datum:t}of i)for(let e of null!=t?t:[])if(e)return e}(r),e={visible:d8(s.visible,t,n),value:cn(d8(s.value,t,n,s.valueFormatter),s.valueTimeFormat,s.valueTimeFormatMode),valueStyle:d8(s.valueStyle,t,n),hasShape:s.hasShape};return Object.keys(i).forEach(r=>{e[r]=d8(i[r],t,n)}),e}return{hasShape:!1,visible:!1}}getTooltipData(t,e,i,r,n){var s,l;let a;if(!(this.enableByType(t)&&ce(t,this.spec)&&("dimension"!==t||r&&r.length)))return null;let o=null!=(l=null==(s=this.spec)?void 0:s[t])?l:null==e?void 0:e[t],h=this.getShapeAttrs(t,!0,e),u=this.getShapeAttrs(t,!1,e);return"dimension"===t?(a=[],this.getContentList(t,o,h,i,r,n).forEach(t=>{a.push(t)})):a=this.getContentList(t,o,h,i,r,n),{visible:!0,activeType:t,data:i,title:this.getTitleResult(t,null==o?void 0:o.title,u,i,n),content:a}}getDefaultTitlePattern(t){return{key:void 0,value:"group"===t?this.groupTooltipTitleCallback:this.dimensionTooltipTitleCallback}}getDefaultContentPattern(t){return{seriesId:this.series.id,key:"group"===t?this.groupTooltipKeyCallback:this.markTooltipKeyCallback,value:this.markTooltipValueCallback}}}let cl={min:t=>t.length?eg(t.map(t=>+t)):0,max:t=>t.length?ep(t.map(t=>+t)):0,"array-min":t=>t.length?eg(t.map(t=>+t)):0,"array-max":t=>t.length?ep(t.map(t=>+t)):0,values:t=>{let e={},i=[];for(let r of t)e[r]||(i.push(r),e[r]=1);return i}},ca=(t,e)=>{var i,r;let n=e.fields;if(tQ(n)&&(n=n()),!(null==n?void 0:n.length)||!(null==t?void 0:t.length))return{};n=dU([],n);let s="parser"===e.target?"parserData":"latestData";return co(t[0][s]?t[0][s]:t||[],n,null==(r=(i=t[0]).getFields)?void 0:r.call(i))},co=(t,e,i)=>{let r={},n=[],s=[];return e.forEach(e=>{let l=e.key;r[l]={};let a=null==i?void 0:i[l],o=e.operations,h=o.some(t=>"min"===t||"max"===t||"allValid"===t),u=!0;n.length=0,t&&t.forEach(t=>{t&&n.push(t[l])});let d=n.length;if(h){s.length=0,n.forEach((t,e)=>{ev(t)&&s.push(t)});let t=n;n=s,s=t,u=n.length===d}else n=o.some(t=>"array-min"===t||"array-max"===t)?n.reduce((t,e)=>(e&&e.forEach(e=>{ev(e)&&t.push(e)}),t),[]):n.filter(t=>void 0!==t);e.filter&&(n=n.filter(e.filter)),o.forEach(t=>{if(e.customize)r[l][t]=e.customize;else{if(a&&!0===a.lockStatisticsByDomain&&!er(a.domain)){if("values"===t)return void(r[l][t]=a.domain.slice())}else if("allValid"===t)return;r[l][t]=cl[t](n),"array-max"===t&&(r[l].max=r[l][t]),"array-min"===t&&(r[l].min=r[l][t])}}),h&&(r[l].allValid=u)}),r},ch=(t,e)=>{let{config:i}=e;if(!i)return t;let{invalidType:r,checkField:n}=i();return"zero"!==r||n&&n.length&&t.forEach(t=>{n.forEach(e=>{ev(t[e])||(t[e]=0)})}),t},cu=`${st}_HIERARCHY_DEPTH`,cd=`${st}_HIERARCHY_ROOT`,cc=`${st}_HIERARCHY_ROOT_INDEX`;function cp(){return{keyMap:new Map,needDefaultSeriesField:!this._seriesField,defaultSeriesField:this._seriesField?null:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey)}}function cg(t,e,i){t&&(i.needDefaultSeriesField&&(t[sl]=i.defaultSeriesField),t[sn]=e,t[ss]=i.getKey(t,e,i))}function cf(){return{keyMap:new Map,needDefaultSeriesField:!0,defaultSeriesField:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey),categoryField:this.getCategoryField()}}function cm(t,e,i,r=0,n,s){void 0===s&&(s=e),cg(t,e,i),t[cu]=r,t[cd]=n||t[i.categoryField],t[cc]=s,t.children&&t.children.length&&t.children.forEach((e,r)=>cm(e,r,i,t[cu]+1,t[cd],s))}let cy={label:{name:"label",type:"text"}},cv=`${st}_rect_x`,cb=`${st}_rect_x1`,c_=`${st}_rect_y`,cx=`${st}_rect_y1`,cC={data:!0},cw={invalidType:!0,animation:!0,animationAppear:!0,animationEnter:!0,animationUpdate:!0,animationExit:!0,animationNormal:!0},cS=[...Object.keys(u0),"normal"];function cA(t={},e,i){let r={};for(let n=0;n<cS.length;n++){let s,l,a=cS[n],o=e?e[a]:void 0;if(!1!==o){if("normal"===a){o&&(r.normal=o);continue}if("state"===a){!1!==o&&(r.state=null!=o?o:u0.state);continue}("update"===a||o||t[a])&&((s=tq(t[a])?t[a]:[Object.assign(Object.assign({},u0[a]),t[a])],"exit"===a&&s.forEach(t=>{t.controlOptions={stopWhenStateChange:!0}}),o)?(l=tq(o)?o.map((t,e)=>{var r;let n=t;return cB(n)&&delete n.type,n.oneByOne&&(n=ck(n,null!=(r=null==i?void 0:i.dataIndex)?r:cT,null==i?void 0:i.dataCount)),n}):s.map((t,e)=>{var r;let n=ir({},s[e],o);return cB(n)&&delete n.type,n.oneByOne&&(n=ck(n,null!=(r=null==i?void 0:i.dataIndex)?r:cT,null==i?void 0:i.dataCount)),n}),r[a]=l):r[a]=s)}}return r}function cM(t,e,i){var r,n,s,l,a,o;let h={};return t8(e.animationAppear)&&(h.appear=null!=(r=e.animationAppear[t])?r:e.animationAppear),t8(e.animationDisappear)&&(h.disappear=null!=(n=e.animationDisappear[t])?n:e.animationDisappear),t8(e.animationEnter)&&(h.enter=null!=(s=e.animationEnter[t])?s:e.animationEnter),t8(e.animationExit)&&(h.exit=null!=(l=e.animationExit[t])?l:e.animationExit),t8(e.animationUpdate)&&(h.update=null!=(a=e.animationUpdate[t])?a:e.animationUpdate),t8(e.animationState)&&(h.state=null!=(o=e.animationState[t])?o:e.animationState),e.animationNormal&&e.animationNormal[t]&&(h.normal=e.animationNormal[t]),function(t,e){if(!t)return t;let i=["custom","customParameters"];return function t(e,i,r=[]){if(tq(e))e.forEach((n,s)=>{e[s]=i(e[s],s),t(e[s],i,r)});else if(e_(e)&&"function"!=typeof e)for(let n in e)r.includes(n)||(e[n]=i(e[n],n),t(e[n],i,r))}(t=t9(t,null,i),t=>{var i;return tQ(t)&&(null==(i=t.prototype)?void 0:i.constructor)!==t?(...i)=>t(...i,e):t},i),t}(h,i)}function ck(t,e,i){let{oneByOne:r,duration:n,delay:s,delayAfter:l}=t;return t.delay=(t,i,l)=>{let a=e(t,l),o=tQ(n)?n(t,i,l):en(n)?n:0,h=tQ(s)?s(t,i,l):en(s)?s:0,u=tQ(r)?r(t,i,l):r;return!1===u?h:h+a*(o+(u=!0===u?0:u))},t.delayAfter=(t,s,a)=>{let o=e(t,a),h=tQ(n)?n(t,s,a):en(n)?n:0,u=tQ(l)?l(t,s,a):en(l)?l:0,d=tQ(r)?r(t,s,a):r;return!1===d?u:(d=!0===d?0:d,u+((i?i():s.parent.count-1)-o)*(h+d))},delete t.oneByOne,t}function cT(t,e){var i;return null!=(i=null==t?void 0:t[sn])?i:e.context.graphicIndex}function cR(t,e){var i,r,n,s,l;if(!1===t.animation||!1===(null==(i=t.morph)?void 0:i.enable))return!1;let a=!1!==(null!=(n=null==(r=t.animationAppear)?void 0:r[e])?n:t.animationAppear),o=!1!==(null!=(l=null==(s=t.animationUpdate)?void 0:s[e])?l:t.animationUpdate);return!(!a||!o)}function cB(t){return!t8(t.timeSlices)&&t8(t.channel)}function cP(t){var e,i,r,n,s,l;let a=t.getSpec();if(!1===a.animation||!1===(null==(i=null==(e=t.getOption())?void 0:e.globalInstance)?void 0:i.isAnimationEnable()))return!1;let o=null!=(r=a.animationThreshold)?r:Number.MAX_SAFE_INTEGER;return null==(n=t.getMarks())||n.forEach(t=>{let e=t.getMarkConfig();e&&(e.large&&e.largeThreshold&&(o=Math.min(o,e.largeThreshold)),e.progressiveThreshold&&(o=Math.min(o,e.progressiveThreshold)))}),!((null==(l=null==(s=t.getRawData())?void 0:s.latestData)?void 0:l.length)>=o)}class cE extends sY{constructor(){super(...arguments),this.markLabelSpec={}}getLabelSpec(t){return this.markLabelSpec[t]}setLabelSpec(t,e){this.markLabelSpec[t]=ed(e)}addLabelSpec(t,e,i=!1){this.markLabelSpec[t]||(this.markLabelSpec[t]=[]),i?this.markLabelSpec[t].unshift(e):this.markLabelSpec[t].push(e)}getTheme(t,e){var i,r,n;let s=e2(t),l=null==(i=this._option)?void 0:i.getTheme,a=this._option.type,o=iv.getSeriesMarkMap(a)?function(t,e,i){let r=iv.getSeriesMarkMap(e);if(!r)return t;let n={};return Object.values(r).forEach(({type:e,name:r})=>{n[r]=ir({},i("mark",ed(e)[0]),i("markByName",r),null==t?void 0:t[r])}),Object.assign(Object.assign({},t),n)}(l("series",a),a,l):{},h=l("series",`${a}_${s}`),u=(null!=(n=null!=(r=this.stack)?r:null==h?void 0:h.stack)?n:null==o?void 0:o.stack)?l("series",`${a}_stack`):void 0;return ir({},o,h,u)}transformSpec(t,e,i){this._transformStack(t);let r=super.transformSpec(t,e,i);return this._transformLabelSpec(r.spec),Object.assign(Object.assign({},r),{markLabelSpec:this.markLabelSpec,stack:this.stack})}_transformLabelSpec(t){}_transformStack(t){tX(t.stack)&&(this.stack=t.stack),tX(t.percent)&&(this.stack=t.percent||this.stack),er(this.stack)&&this._supportStack&&t.seriesField&&(this.stack=!0)}_addMarkLabelSpec(t,e,i="label",r="initLabelMarkStyle",n=!0,s){t&&ed(t[i]).forEach(i=>{var l,a,o;if(i&&i.visible){let{animation:h=!0,animationUpdate:u=!0,animationEnter:d=!0,animationExit:c=!0}=i,{animationUpdate:p=!0,animationEnter:g=!0,animationExit:f=!0}=t,m=!!(null!=(o=null!=(a=null==(l=this._option.globalInstance)?void 0:l.isAnimationEnable())?a:t.animation)?o:i.animation)&&!!n;this.addLabelSpec(tQ(e)?e(i):e,Object.assign(Object.assign({},i),{animation:!!m&&h,animationUpdate:!!(m&&p&&u)&&p,animationEnter:!!(m&&g&&d)&&g,animationExit:!!(m&&g&&c)&&f,getStyleHandler:t=>{var e;return null==(e=t[r])?void 0:e.bind(t)}}),s)}})}_getDefaultSpecFromChart(t){var e;let i=null!=(e=super._getDefaultSpecFromChart(t))?e:{},{outerRadius:r,innerRadius:n,direction:s}=t;return t8(r)&&(i.outerRadius=r),t8(n)&&(i.innerRadius=n),t8(s)&&(i.direction=s),Object.keys(i).length>0?i:void 0}_mergeThemeToSpec(t,e){let i=this._theme;if(this._shouldMergeThemeToSpec()){let r=this._getDefaultSpecFromChart(e),n=t=>{let e=ir({},i,r,t),n=i.label;return n&&e_(n)&&tq(e.label)&&(e.label=e.label.map(t=>ir({},n,t))),e};return tq(t)?{spec:t.map(t=>n(t)),theme:i}:{spec:n(t),theme:i}}return{spec:t,theme:i}}}class cI extends s0{getRegion(){return this._region}getLayoutStartPoint(){return this._region.getLayoutStartPoint()}getRootMark(){return this._rootMark}getSeriesMark(){return this._seriesMark}getRawData(){return this._rawData}getViewDataFilter(){return this._viewDataFilter}getViewData(){var t;return null==(t=this._data)?void 0:t.getDataView()}getViewDataProductId(){var t;return null==(t=this._data)?void 0:t.getProductId()}getViewDataStatistics(){return this._viewDataStatistics}getViewStackData(){return this._viewStackData}getSeriesField(){return this._seriesField}setSeriesField(t){t8(t)&&(this._seriesField=t)}getGroups(){return this._groups}getStack(){var t;return null==(t=this.getSpecInfo())?void 0:t.stack}getStackValue(){var t;return null!=(t=this._spec.stackValue)?t:`${st}_series_${this.type}`}getPercent(){return this._spec.percent}getStackOffsetSilhouette(){return this._spec.stackOffsetSilhouette}get tooltipHelper(){return this._tooltipHelper||this.initTooltip(),this._tooltipHelper}getInvalidType(){return this._invalidType}setInvalidType(t){var e;this._invalidType=t,null==(e=this.getViewData())||e.reRunAllTransform()}getMarkAttributeContext(){return this._markAttributeContext}constructor(t,e){var i;super(t,e),this.specKey="series",this.type="series",this.layoutType="absolute",this.modelType="series",this.name=void 0,this.transformerConstructor=cE,this.coordinate="none",this._region=null,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:null,height:null},this.getLayoutRect=()=>{var t,e;return{width:null!=(t=this._layoutRect.width)?t:this._region.getLayoutRect().width,height:null!=(e=this._layoutRect.height)?e:this._region.getLayoutRect().height}},this._rootMark=null,this._seriesMark=null,this._viewDataMap=new Map,this._viewDataFilter=null,this._data=null,this.layoutZIndex=H.SeriesGroup,this._invalidType="break",this._region=e.region,this._dataSet=e.dataSet,(null==(i=this._spec)?void 0:i.name)&&(this.name=this._spec.name)}created(){super.created(),this._buildMarkAttributeContext(),this.initData(),this.initGroups(),this.initStatisticalData(),this.event.emit(rI.afterInitData,{model:this}),this.initRootMark(),this.initMark();let t=cP(this);this._initExtensionMark({hasAnimation:t}),this.initMarkStyle(),this.initMarkState(),t&&this.initAnimation(),this.afterInitMark(),this.initEvent(),this.event.emit(rI.afterInitEvent,{model:this})}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(t,e)=>{var i;return null==(i=this._option.globalScale.getScale(t))?void 0:i.scale(e)},seriesColor:t=>{var e;return er(t)&&(t=this.getSeriesKeys()[0]),null==(e=this._option.globalScale.getScale("color"))?void 0:e.scale(t)},getRegion:()=>this._region}}setAttrFromSpec(){super.setAttrFromSpec(),this.setSeriesField(this._spec.seriesField),t8(this._spec.invalidType)&&(this._invalidType=this._spec.invalidType)}getInvalidCheckFields(){return[this.getStackValueField()]}initInvalidDataTransform(){var t,e;"zero"===this._invalidType&&(null==(t=this._rawData)?void 0:t.dataSet)&&(nq(this._rawData.dataSet,"invalidTravel",ch),null==(e=this._rawData)||e.transform({type:"invalidTravel",options:{config:()=>({invalidType:this._invalidType,checkField:this.getInvalidCheckFields()})}},!1))}initData(){var t,e,i;let r=null!=(t=this._spec.data)?t:this._option.getSeriesData(this._spec.dataId,this._spec.dataIndex);if(r&&(this._rawData=n4(r,this._dataSet,this._option.sourceDataList)),null==(i=null==(e=this._rawData)?void 0:e.target)||i.addListener("change",this.rawDataUpdate.bind(this)),this._addDataIndexAndKey(),this._rawData){this.getStack()&&(this._viewDataFilter=n5(this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewDataFilter`}));let t=n5(this.getStack()?this._viewDataFilter:this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewData`});this._data=new aC(this._option,t),this.getStack()&&this._viewDataFilter.target.removeListener("change",t.reRunAllTransform)}this.initInvalidDataTransform()}initGroups(){let t=this.getGroupFields();t&&t.length&&(this._groups={fields:t})}initStatisticalData(){this._data&&this._statisticViewData()}getRawDataStatisticsByField(t,e){var i,r,n;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]||e&&(er(this._rawStatisticsCache[t].min)||er(this._rawStatisticsCache[t].max))||!e&&er(this._rawStatisticsCache[t].values)){if(this._viewDataStatistics&&(!this._viewDataFilter||this._viewDataFilter.transformsArr.length<=1)&&this.getViewData().transformsArr.length<=1&&(null==(i=this._viewDataStatistics.latestData)?void 0:i[t]))this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t];else if(this._rawData){let i=null==(r=this._rawData.getFields())?void 0:r[t];if(i&&i.lockStatisticsByDomain&&i.domain)this._rawStatisticsCache[t]={},e?(this._rawStatisticsCache[t].min=eg(i.domain),this._rawStatisticsCache[t].max=ep(i.domain)):this._rawStatisticsCache[t].values=i.domain;else{let i=co(this._rawData.latestData,[{key:t,operations:e?["min","max"]:["values"]}])[t];this._rawStatisticsCache[t]=ei(null!=(n=this._rawStatisticsCache[t])?n:{},i)}}}return this._rawStatisticsCache[t]}_statisticViewData(){nq(this._dataSet,"dimensionStatistics",ca);let t=`${this.type}_${this.id}_viewDataStatic`;this._viewDataStatistics=new el(this._dataSet,{name:t}),this._viewDataStatistics.parse([this._data.getDataView()],{type:"dataview"}),this._viewDataStatistics.transform({type:"dimensionStatistics",options:{fields:()=>{let t=this.getStatisticFields();return this._seriesField&&dU(t,[{key:this._seriesField,operations:["values"]}]),t},target:"latest"}},!1),this._data.getDataView().target.removeListener("change",this._viewDataStatistics.reRunAllTransform),this.getStack()&&this.createdStackData()}createStatisticalData(t,e,i){nq(this._dataSet,"dimensionStatistics",ca);let r=new el(this._dataSet,{name:t});return r.parse([e],{type:"dataview"}),r.transform({type:"dimensionStatistics",options:{operations:["max","min","values"],fields:()=>{var t;let r=dU(this.getStatisticFields(),null!=(t=null==i?void 0:i(e.name))?t:[]);return this._seriesField&&dU(r,[{key:this._seriesField,operations:["values"]}]),r},target:"latest"}},!1),r}createdStackData(){let t=`${this.type}_${this.id}_viewStackData`;this._viewStackData=new el(this._dataSet,{name:t}),this._viewStackData.parse([this._viewDataFilter],{type:"dataview"}),this._viewStackData.transform({type:"stackSplit",options:{fields:this.getStackGroupFields()}},!1)}_noAnimationDataKey(t,e){return e}generateDefaultDataKey(t){var e;return er(t)?(t,e,i)=>{if(!1===this._spec.animation){let i=this._noAnimationDataKey(t,e);if(void 0!==i)return i}let{keyMap:r}=i,n=this._getSeriesDataKey(t);return void 0===r.get(n)?(r.set(n,0),n):(r.set(n,r.get(n)+1),`${n}_${r.get(n)}`)}:t6(t)?e=>e[t]:tq(t)&&t.every(t=>t6(t))?e=>t.map(t=>e[t]).join("-"):tQ(t)?(e,i)=>t(e,i):(null==(e=this._option)||e.onError(`invalid dataKey: ${t}`),(t,e)=>{})}_addDataIndexAndKey(){var t;(null==(t=this._rawData)?void 0:t.dataSet)&&(nq(this._rawData.dataSet,"addVChartProperty",d2),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:cp.bind(this),call:cg}},!1))}updateRawData(t){this._rawData&&this._rawData.updateRawData(t)}rawDataUpdate(t){var e;null==(e=this._rawDataStatistics)||e.reRunAllTransform(),this._rawStatisticsCache=null,this.event.emit(rI.rawDataUpdate,{model:this})}viewDataFilterOver(t){this.event.emit(rI.viewDataFilterOver,{model:this})}viewDataUpdate(t){var e;this.event.emit(rI.viewDataUpdate,{model:this}),null==(e=this._data)||e.updateData(),this._viewDataStatistics&&this._viewDataStatistics.reRunAllTransform()}viewDataStatisticsUpdate(t){this.event.emit(rI.viewDataStatisticsUpdate,{model:this})}getDatumPositionValue(t,e){return!t||er(e)?null:t[e]}getDatumPositionValues(t,e){return!t||er(e)?[]:t6(e)?[t[e]]:e.map(e=>t[e])}setValueFieldToStack(){}setValueFieldToPercent(){}setValueFieldToStackOffsetSilhouette(){}initRootMark(){var t,e,i;this._rootMark=this._createMark({type:"group",name:`seriesGroup_${this.type}_${this.id}`},{parent:null==(e=(t=this._region).getGroupMark)?void 0:e.call(t),dataView:!1}),this._rootMark.setMarkConfig({zIndex:null!=(i=this._spec.zIndex)?i:this.layoutZIndex})}_getExtensionMarkNamePrefix(){return`${this.type}_${this.id}_extensionMark`}_initExtensionMark(t){var e;this._spec.extensionMark&&(null==(e=this._spec.extensionMark)||e.forEach((e,i)=>{this._createExtensionMark(e,null,this._getExtensionMarkNamePrefix(),i,t)}))}_createExtensionMark(t,e,i,r,n){var s;let l=this._createMark({type:t.type,name:t8(t.name)?`${t.name}`:`${i}_${r}`},{skipBeforeLayouted:!0,markSpec:t,parent:e,dataView:!1,componentType:t.componentType,key:t.dataKey});if(l){if(t8(t.id)&&l.setUserId(t.id),n.hasAnimation){let e=cA({},cM(t.type,t,this._markAttributeContext));l.setAnimationConfig(e)}if("group"===t.type)i=`${i}_${r}`,null==(s=t.children)||s.forEach((t,e)=>{this._createExtensionMark(t,l,i,e,n)});else if(!(e||er(t.dataId)&&er(t.dataIndex))){let e=this._option.getSeriesData(t.dataId,t.dataIndex);e===this._rawData?l.setData(this._data):(l.setDataView(e),e.target.addListener("change",()=>{l.getData().updateData()}))}}}_updateExtensionMarkSpec(){var t;null==(t=this._spec.extensionMark)||t.forEach((t,e)=>{let i=this._marks.getMarkWithInfo({name:t8(t.name)?`${t.name}`:`${this._getExtensionMarkNamePrefix()}_${e}`});i&&(this.initMarkStyleWithSpec(i,t),i.commit(!1,!0))})}getStackData(){var t;return null==(t=this._viewStackData)?void 0:t.latestData}_parseDefaultInteractionConfig(t){var e;if(!(null==t?void 0:t.length))return[];let i=(e=this._option.mode)===rM["desktop-browser"]||e===rM["desktop-miniApp"]?{hover:{enable:!0,trigger:"pointermove",triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"pointertap"}}:eI(e)||eL(e)?{hover:{enable:!0,trigger:["pointerdown","pointermove"],triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"tap"}}:null,r=Object.assign({},null==i?void 0:i.hover),n=Object.assign({},null==i?void 0:i.select),s=this._spec.hover;tX(s)?r.enable=s:e_(s)&&(r.enable=!0,r=ir(r,s));let l=this._spec.select;tX(l)?n.enable=l:e_(l)&&(n.enable=!0,n=ir(n,l));let a=[{trigger:{type:"dimension-hover"},marks:t}];if(r.enable){let e=du(r,t);e.length&&a.push({trigger:this._defaultHoverConfig(r),marks:e})}if(n.enable){let e=du(n,t);e.length&&a.push({trigger:this._defaultSelectConfig(n),marks:e})}return a}_defaultHoverConfig(t){return{type:"element-highlight",trigger:t.trigger,triggerOff:t.triggerOff,blurState:j.STATE_HOVER_REVERSE,highlightState:j.STATE_HOVER}}_defaultSelectConfig(t){let e="multiple"===t.mode,i=t8(t.triggerOff)?t.triggerOff:e?["empty"]:["empty",t.trigger];return{type:"element-select",trigger:t.trigger,triggerOff:i,reverseState:j.STATE_SELECTED_REVERSE,state:j.STATE_SELECTED,isMultiple:e}}_parseInteractionConfig(t){let{interactions:e}=this._spec,i=this._parseDefaultInteractionConfig(t);return e&&e.length&&e.forEach(t=>{let e=du(t,this.getMarks());e.length&&i.push({trigger:t,marks:e})}),i}getInteractionTriggers(){if(!0!==this._option.disableTriggerEvent){let t=this.getMarksWithoutRoot();return this._parseInteractionConfig(t)}return[]}initAnimation(){}initMarkState(){this.initSeriesStyleState()}initSeriesStyleState(){var t;let e=this._spec.seriesStyle;if(!e||!e.length)return;let i=null!=(t=this._seriesField)?t:sl;this.getMarksWithoutRoot().forEach(t=>{let r={},n={},s={};e.forEach(e=>{var i;let l=null==(i=e[t.name])?void 0:i.style;l&&(r[e.name]=!0,s[e.name]=s[e.name]||{},Object.keys(l).forEach(t=>{n[t]=!0,s[e.name][t]=l[t]}))}),t.state.addStateInfo({stateValue:sa,level:-1,filter:t=>Array.isArray(t)?0!==t.length&&!0===r[t[0][i]]:!0===r[t[i]]});let l={};Object.keys(n).forEach(e=>{l[e]=r=>{var n,l;let a;if(Array.isArray(r)){if(0===r.length)return;a=null==(n=s[r[0][i]])?void 0:n[e]}return t8(a=null==(l=s[r[i]])?void 0:l[e])?a:t.getAttribute(e,r)}}),this.setMarkStyle(t,l,sa,W.User_SeriesStyle)})}afterInitMark(){this.event.emit(rI.afterInitMark,{model:this}),this.setSeriesField(this._spec.seriesField),this.getMarks().forEach(t=>{var e,i;(null==(i=null==(e=t.stateStyle)?void 0:e.normal)?void 0:i.lineWidth)&&t.setAttribute("stroke",this.getColorAttribute(),"normal",W.Base_Series)})}getMarksWithoutRoot(){return this.getMarks().filter(t=>{var e;return!(null==(e=t.name)?void 0:e.includes("seriesGroup"))})}getMarksInType(t){return this._marks.getMarksInType(t)}getMarkInName(t){return this._marks.get(t)}getMarkInId(t){return this.getMarks().find(e=>e.id===t)}initEvent(){var t,e,i;null==(e=null==(t=this._data)?void 0:t.getDataView())||e.target.addListener("change",this.viewDataUpdate.bind(this)),null==(i=this._viewDataStatistics)||i.target.addListener("change",this.viewDataStatisticsUpdate.bind(this))}_releaseEvent(){super._releaseEvent()}initTooltip(){this._tooltipHelper=new cs(this)}_compareExtensionMarksSpec(t,e,i){t.length!==e.length||e.some((e,i)=>e.type!==t[i].type||e.id!==t[i].id||e.name!==t[i].name)?i.reMake=!0:e.some((e,i)=>e.visible!==t[i].visible)&&(i.reCompile=!0)}_compareLabelSpec(t,e,i){t.length!==e.length||e.some((e,i)=>e.labelLayout!==t[i].labelLayout||e.visible!==t[i].visible)?i.reMake=!0:!i.reCompile&&e.some((e,i)=>!t5(e,t[i]))&&(i.reCompile=!0)}_compareSpec(t,e,i){let r=super._compareSpec(t,e),n=Object.keys(e||{}).sort();if(!t5(n,Object.keys(t||{}).sort()))return r.reMake=!0,r;let s=Object.assign(Object.assign(Object.assign(Object.assign({},cC),cw),i),{extensionMark:!0,label:!0,totalLabel:!0});return this._compareExtensionMarksSpec(ed(t.extensionMark),ed(e.extensionMark),r),r.reMake||this._compareLabelSpec(ed(t.label),ed(e.label),r),r.reMake||this._compareLabelSpec(ed(t.totalLabel),ed(e.totalLabel),r),r.reMake||(!r.reCompile&&this._marks.getMarks().some(i=>{var r,n;return s[i.name]=!0,(null==(r=e[i.name])?void 0:r.visible)!==(null==(n=t[i.name])?void 0:n.visible)})&&(r.reCompile=!0),!r.reCompile&&n.some(i=>cw[i]&&!t5(t[i],e[i]))&&(r.reCompile=!0),n.some(i=>!s[i]&&!t5(t[i],e[i]))&&(r.reMake=!0)),r}_updateSpecData(){!this._rawData||!this._spec.data||this._spec.data instanceof el||n6(this._rawData,this._spec.data,!0)}reInit(t){super.reInit(t);let e=this.getMarksWithoutRoot();e.forEach(t=>{this._spec[t.name]&&this.initMarkStyleWithSpec(t,this._spec[t.name])}),this.initMarkStyle(),e.forEach(t=>{t.commit(!1)}),this._updateExtensionMarkSpec(),this._updateSpecData(),this._tooltipHelper&&this._tooltipHelper.updateTooltipSpec(),cP(this)&&this.initAnimation()}onEvaluateEnd(t){this._data.updateData()}release(){var t,e;super.release(),this._viewDataMap.clear();let i=null==(e=null==(t=this._rawData)?void 0:t.transformsArr)?void 0:e.findIndex(t=>"addVChartProperty"===t.type);i>=0&&this._rawData.transformsArr.splice(i,1),this._dataSet=this._data=this._rawData=this._rawDataStatistics=this._spec=this._region=this._viewDataStatistics=this._viewStackData=null}setLayoutStartPosition(t){en(t.x)&&(this._layoutStartPoint.x=t.x),en(t.y)&&(this._layoutStartPoint.y=t.y)}setLayoutRect({width:t,height:e},i){en(t)&&(this._layoutRect.width=t),en(e)&&(this._layoutRect.height=e)}getSeriesKeys(){var t,e;return this._seriesField?null!=(e=null==(t=this.getRawDataStatisticsByField(this._seriesField))?void 0:t.values)?e:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}getSeriesStyle(t){return e=>{var i,r;return null!=(r=null==(i=this._seriesMark)?void 0:i.getAttribute(e,t))?r:void 0}}_getSeriesInfo(t,e){let i=this.getDefaultShapeType();return e.map(e=>({key:e,originalKey:e,style:this.getSeriesStyle({[t]:e}),shapeType:i}))}getSeriesInfoInField(t){var e,i;return this._getSeriesInfo(t,null!=(i=null==(e=this.getRawDataStatisticsByField(t))?void 0:e.values)?i:[])}getSeriesInfoList(){var t;return this._getSeriesInfo(null!=(t=this._seriesField)?t:sl,this.getSeriesKeys())}_getDefaultColorScale(){var t,e;let i=this.getDefaultColorDomain(),r=this._getDataScheme();return null==(e=(t=(new ar).domain(i)).range)?void 0:e.call(t,r)}_getDataScheme(){return e4(this.getColorScheme(),this.type)}getDefaultColorDomain(){var t,e;return this._seriesField?null==(e=null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._seriesField])?void 0:e.values:[]}getColorAttribute(){var t,e;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:null!=(e=this._seriesField)?e:sl}}getDimensionField(){return[]}getMeasureField(){return[]}onMarkPositionUpdate(){this.onMarkTreePositionUpdate(this.getMarksWithoutRoot())}onMarkTreePositionUpdate(t){}_createMark(t,e={},i={}){var r,n,s,l,a;let{key:o,groupKey:h,skipBeforeLayouted:u,themeSpec:d={},markSpec:c,dataView:p,parent:g,isSeriesMark:f,noSeparateStyle:m=!1}=e,y=super._createMark(t,{key:null!=o?o:this._getDataIdKey(),seriesId:this.id,attributeContext:this._markAttributeContext,componentType:e.componentType,noSeparateStyle:m,parent:!1!==g?null!=g?g:this._rootMark:null});if(t8(y)){let e=this.getSpec()||{};this._marks.addMark(y,{name:t.name}),f&&(this._seriesMark=y),er(p)?y.setData(this._data):!1!==p&&y.setDataView(p),y.setSkipBeforeLayouted(!1!==u),er(h)||y.setGroupKey(h);let o=Object.assign(Object.assign({},i),{progressiveStep:e.progressiveStep,progressiveThreshold:e.progressiveThreshold,large:e.large,largeThreshold:e.largeThreshold,morph:null!=(r=i.morph)&&r,useSequentialAnimation:e.useSequentialAnimation,support3d:null!=(n=i.support3d)?n:e.support3d||!!e.zField,morphKey:(null==(s=e.morph)?void 0:s.morphKey)||`${this.getSpecIndex()}_${this.getMarks().length}`,morphElementKey:null!=(a=null==(l=e.morph)?void 0:l.morphElementKey)?a:i.morphElementKey});y.setMarkConfig(o),this.initMarkStyleWithSpec(y,ir({},d,c||e[y.name]))}return y}_getDataIdKey(){var t;return null!=(t=super._getDataIdKey())?t:ss}_getSeriesDataKey(t){let e="";if(!t)return e;let i=this.getDimensionField();e=i.map(e=>t[e]).join("_");let r=this.getSeriesField();return r&&!i.includes(r)&&(e+=`_${t[r]}`),e}addViewDataFilter(t){var e,i;null==(i=null!=(e=this._viewDataFilter)?e:this.getViewData())||i.transform(t,!1)}reFilterViewData(){var t,e;null==(e=null!=(t=this._viewDataFilter)?t:this.getViewData())||e.reRunAllTransform()}reTransformViewData(){var t,e;null==(e=null==(t=this._data)?void 0:t.getDataView())||e.reRunAllTransform()}fillData(){var t;null==(t=this.getRawData())||t.reRunAllTransform()}compile(){this.compileData()}getDefaultShapeType(){return"circle"}getFieldAlias(t){var e;return t!==su&&t!==sc&&t!==sh&&t!==sd||(t=this.getStackValueField()),null!=(e=dK(this.getRawData(),t))?e:t}_getInvalidConnectType(){return"zero"===this._invalidType?"zero":"link"===this._invalidType?"connect":"none"}_getInvalidDefined(t){let e=this.getInvalidCheckFields();return!e.length||e.every(e=>ev(t[e]))}_getRelatedComponentSpecInfo(t){var e;let i=this.getSpecIndex(),r=null==(e=this._option.getSpecInfo().component[t])?void 0:e.filter(t=>t.seriesIndexes.includes(i));return null!=r?r:[]}_forEachStackGroup(t,e){var i,r;(e=null!=e?e:null==(i=this._viewStackData)?void 0:i.latestData)&&((null==(r=e.values)?void 0:r.length)?t(e):e.nodes&&Object.values(e.nodes).forEach(e=>{this._forEachStackGroup(t,e)}))}isDatumInViewData(t){if(!t)return!1;let e=this.getViewData().latestData;return!!e&&(!!e.includes(t)||e.some(e=>Object.keys(t).every(i=>t[i]===e[i])))}getSeriesFieldValue(t,e){var i;return t[null!=(i=null!=e?e:this.getSeriesField())?i:sl]}}function cL(t){return[rR.rose,rR.radar,rR.circularProgress].includes(t)}function cF(t,e,i){let r=t.getScale(0),n="isInverse"in t&&t.isInverse();ls(r.type)?i.sort((t,i)=>(t[e]-i[e])*(n?-1:1)):i.sort((t,i)=>(r.index(t[e])-r.index(i[e]))*(n?-1:1))}function cO(t){return{dataIndex:e=>{var i,r;let n="horizontal"===t.direction?t.fieldY[0]:t.fieldX[0],s=null==e?void 0:e[n],l="horizontal"===t.direction?t.scaleY:t.scaleX;return(null!=(r=null==(i=null==l?void 0:l.domain)?void 0:i.call(l))?r:[]).indexOf(s)||0},dataCount:()=>{var e,i,r;let n="horizontal"===t.direction?t.scaleY:t.scaleX;return null!=(r=(null!=(i=null==(e=null==n?void 0:n.domain)?void 0:e.call(n))?i:[]).length)?r:0}}}cI.mark=cy,cI.transformerConstructor=cE;class cD extends cI{constructor(){super(...arguments),this.coordinate="cartesian",this._bandPosition=.5,this._scaleConfig={bandPosition:this._bandPosition},this._direction="vertical",this._sortDataByAxis=!1,this._getPositionXEncoder=()=>{var t;return null==(t=this._positionXEncoder)?void 0:t.bind(this)},this._setPositionXEncoder=t=>{this._positionXEncoder=t.bind(this)},this._getPositionYEncoder=()=>{var t;return null==(t=this._positionYEncoder)?void 0:t.bind(this)},this._setPositionYEncoder=t=>{this._positionYEncoder=t.bind(this)}}_buildScaleConfig(){this._scaleConfig={bandPosition:this._bandPosition}}get fieldX(){return this._fieldX}setFieldX(t){this._fieldX=ed(t)}get fieldY(){return this._fieldY}setFieldY(t){this._fieldY=ed(t)}get fieldZ(){return this._fieldZ}setFieldZ(t){this._fieldZ=t&&ed(t)}get fieldX2(){return this._fieldX2}setFieldX2(t){this._fieldX2=t}get fieldY2(){return this._fieldY2}setFieldY2(t){this._fieldY2=t}get direction(){return this._direction}get scaleX(){return this._scaleX}setScaleX(t){this._scaleX=t}get scaleY(){return this._scaleY}setScaleY(t){this._scaleY=t}get scaleZ(){return this._scaleZ}setScaleZ(t){this._scaleZ=t}getXAxisHelper(){return this._xAxisHelper}setXAxisHelper(t){this._xAxisHelper=t,this.onXAxisHelperUpdate()}getYAxisHelper(){return this._yAxisHelper}setYAxisHelper(t){this._yAxisHelper=t,this.onYAxisHelperUpdate()}getZAxisHelper(){return this._zAxisHelper}setZAxisHelper(t){this._zAxisHelper=t,this.onYAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}getStatisticFields(){let t=[];return[{axisHelper:this.getXAxisHelper(),fields:this._fieldX2?[...this._fieldX,this._fieldX2]:this._fieldX},{axisHelper:this.getYAxisHelper(),fields:this._fieldY2?[...this._fieldY,this._fieldY2]:this._fieldY},{axisHelper:this.getZAxisHelper(),fields:this._fieldZ}].forEach(e=>{e.axisHelper&&e.axisHelper.getScale&&e.fields&&e.fields.forEach(i=>{let r={key:i,operations:[]},n=e.axisHelper.getScale(0);ls(n.type)?(r.operations=["max","min"],"log"===n.type&&(r.filter=t=>t>0)):r.operations=["values"],t.push(r)})}),this.getStack()&&t.push({key:this.getStackValueField(),operations:["allValid"]}),t}getGroupFields(){return"vertical"===this.direction?this._fieldX:this._fieldY}getStackGroupFields(){return this.getGroupFields()}getStackValue(){var t,e;let i=null==(t="horizontal"===this.direction?this.getXAxisHelper():this.getYAxisHelper())?void 0:t.getAxisId();return null!=(e=this._spec.stackValue)?e:`${st}_series_${this.type}_${i}`}getStackValueField(){return"horizontal"===this.direction?ed(this._spec.xField)[0]:ed(this._spec.yField)[0]}setValueFieldToStack(){"horizontal"===this.direction?(this.setFieldX(su),this.setFieldX2(sh)):(this.setFieldY(su),this.setFieldY2(sh))}setValueFieldToPercent(){"horizontal"===this.direction?(this.setFieldX(sc),this.setFieldX2(sd)):(this.setFieldY(sc),this.setFieldY2(sd))}setValueFieldToStackOffsetSilhouette(){"horizontal"===this.direction?(this.setFieldX(sg),this.setFieldX2(sp)):(this.setFieldY(sg),this.setFieldY2(sp))}onXAxisHelperUpdate(){this.onMarkPositionUpdate()}onYAxisHelperUpdate(){this.onMarkPositionUpdate()}onZAxisHelperUpdate(){this.onMarkPositionUpdate()}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.setFieldX(this._spec.xField),this.setFieldY(this._spec.yField),this.setFieldZ(this._spec.zField),this._specXField=ed(this._spec.xField),this._specYField=ed(this._spec.yField),t8(this._spec.direction)&&(this._direction=this._spec.direction),this.setFieldX2(null==(t=this._spec)?void 0:t.x2Field),this.setFieldY2(null==(e=this._spec)?void 0:e.y2Field),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent(),this.getStackOffsetSilhouette()&&this.setValueFieldToStackOffsetSilhouette(),t8(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)}dataToPosition(t,e){return t?e&&!this.isDatumInViewData(t)?null:{x:this.dataToPositionX(t),y:this.dataToPositionY(t)}:null}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToX=this.valueToPositionX.bind(this),this._markAttributeContext.valueToY=this.valueToPositionY.bind(this),this._markAttributeContext.xBandwidth=(t=0)=>{var e,i,r;return null!=(r=null==(i=(e=this.getXAxisHelper()).getBandwidth)?void 0:i.call(e,t))?r:0},this._markAttributeContext.yBandwidth=(t=0)=>{var e,i,r;return null!=(r=null==(i=(e=this.getYAxisHelper()).getBandwidth)?void 0:i.call(e,t))?r:0},this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)}valueToPosition(t,e){return{x:this.valueToPositionX(t),y:this.valueToPositionY(e)}}_axisPosition(t,e,i){return this._scaleConfig.datum=i,t.isContinuous?t.valueToPosition(e,this._scaleConfig):t.dataToPosition(ed(e),this._scaleConfig)}valueToPositionX(t,e){return this._axisPosition(this._xAxisHelper,t,e)}valueToPositionY(t,e){return this._axisPosition(this._yAxisHelper,t,e)}_dataToPosition(t,e,i,r,n,s){let l=n();if(l)return l(t);if(!e)return s(t=>Number.NaN),Number.NaN;let a=(e.getFields?e.getFields():i).slice(0,r);return a&&0!==a.length?(e.isContinuous?s(t=>(this._scaleConfig.datum=t,e.valueToPosition(this.getDatumPositionValue(t,a[0]),this._scaleConfig))):s(t=>(this._scaleConfig.datum=t,e.dataToPosition(ed(this.getDatumPositionValues(t,a)),this._scaleConfig))),n()(t)):(s(t=>null),null)}dataToPositionX(t){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,void 0,this._getPositionXEncoder,this._setPositionXEncoder)}dataToPositionY(t){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,void 0,this._getPositionYEncoder,this._setPositionYEncoder)}dataToPositionZ(t){if(!this._zAxisHelper)return Number.NaN;let{dataToPosition:e}=this._zAxisHelper;return e(this.getDatumPositionValues(t,this._fieldZ),{bandPosition:this._bandPosition})}dataToPositionX1(t){return this._xAxisHelper?this._fieldX2&&this._fieldX2 in t?this.valueToPositionX(this.getDatumPositionValues(t,this._fieldX2)):this.valueToPositionX(0):Number.NaN}dataToPositionY1(t){return this._yAxisHelper?this._fieldY2&&this._fieldY2 in t?this.valueToPositionY(this.getDatumPositionValues(t,this._fieldY2)):this.valueToPositionY(0):Number.NaN}positionToData(t){return t?{x:this.positionToDataX(t.x),y:this.positionToDataY(t.y)}:null}positionToDataX(t){return this._scaleX?this._scaleX.invert(t):null}positionToDataY(t){return this._scaleY?this._scaleY.invert(t):null}getRegionRectLeft(){if(!this._xAxisHelper)return Number.NaN;let{getScale:t}=this._xAxisHelper;return t(0).range()[0]}getRegionRectRight(){if(!this._xAxisHelper)return Number.NaN;let{getScale:t}=this._xAxisHelper;return t(0).range()[1]}afterInitMark(){super.afterInitMark(),this.setFieldX(this._fieldX),this.setFieldY(this._fieldY),this._buildScaleConfig()}getDimensionField(){return"horizontal"===this._direction?this._specYField:this._specXField}getDimensionContinuousField(){return"horizontal"===this._direction?[this.fieldY[0],this.fieldY2]:[this.fieldX[0],this.fieldX2]}getMeasureField(){return"horizontal"===this._direction?this._specXField:this._specYField}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(rI.scaleDomainUpdate,{filter:t=>{var e;return t.model.id===(null==(e="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper)?void 0:e.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var t,e,i;(null==(e=null==(t=this.getViewData())?void 0:t.latestData)?void 0:e.length)&&(cF("horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,"horizontal"===this._direction?this._fieldY[0]:this._fieldX[0],this.getViewData().latestData),null==(i=this._data)||i.updateData(!0))}getInvalidCheckFields(){let t=[];return this._xAxisHelper&&this._xAxisHelper.isContinuous&&this._xAxisHelper.getAxisType()!==rk.geoCoordinate&&(this._xAxisHelper.getFields?this._xAxisHelper.getFields():this._specXField).forEach(e=>{t.push(e)}),this._yAxisHelper&&this._yAxisHelper.isContinuous&&this._yAxisHelper.getAxisType()!==rk.geoCoordinate&&(this._yAxisHelper.getFields?this._yAxisHelper.getFields():this._specYField).forEach(e=>{t.push(e)}),t}reInit(t){this._positionXEncoder&&(this._positionXEncoder=null),this._positionYEncoder&&(this._positionYEncoder=null),super.reInit(t)}}let cH="monotone",cz="linear",cW="bevel";(S=Z||(Z={})).dimensionHover="dimensionHover",S.dimensionClick="dimensionClick";let cN={point:{name:"point",type:"symbol"},line:{name:"line",type:"line"}};class cj{addSamplingCompile(){if(this._spec.sampling){let{width:t,height:e}=this._region.getLayoutRect(),i=this._fieldY,r=this._fieldX;this._data&&this._data.setTransform([{type:"dataSampling",size:"horizontal"===this._direction?e:t,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?r[0]:i[0],groupBy:this._seriesField,mode:this._spec.sampling}])}}addOverlapCompile(){var t;if(this._spec.markOverlap){let e=[];e.push({type:"symbolOverlap",direction:"horizontal"===this._direction&&"cartesian"===this.coordinate?2:1,delta:this._spec.pointDis,deltaMul:this._spec.pointDisMul,groupBy:this._seriesField}),null==(t=this._symbolMark)||t.setTransform(e)}}reCompileSampling(){this._spec.sampling&&this.compile()}initLineMark(t){return this._lineMark=this._createMark(cN.line,{groupKey:this._seriesField,isSeriesMark:null==t||t},{morphElementKey:this.getDimensionField()[0]}),this._lineMark}initLineMarkStyle(t,e){var i,r;let n=this._lineMark;if(n){if(this.setMarkStyle(n,{stroke:this.getColorAttribute()},"normal",W.Series),"zero"!==this._invalidType&&this.setMarkStyle(n,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",W.Series),this.event.on(rI.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(n,"defined")}),"polar"===this.coordinate)this.setMarkStyle(n,{lineJoin:cW,curveType:cz,closePath:!0},"normal",W.Series);else{let s=null!=e?e:null==(r=null==(i=this.getSpec().line)?void 0:i.style)?void 0:r.curveType;this.setMarkStyle(n,{curveType:s===cH?"horizontal"===t?"monotoneY":"monotoneX":s},"normal",W.Built_In)}this.setMarkStyle(n,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",W.Series)}return n}_getEventElement(t,e=!1){let i=[];return t.dimensionInfo.some(t=>(t.data.some(t=>t.series===this&&(i=t.datum,!0)),!i.length)),i}_dimensionTrigger(t){let e=this._getEventElement(t);switch(t.action){case"enter":this._symbolActiveMark.getDataView().parse(e),this._symbolActiveMark.getData().updateData(!1);break;case"leave":this._symbolActiveMark.getDataView().parse([]),this._symbolActiveMark.getData().updateData(!1)}}initSymbolMark(t){if(!1!==(this._spec.point||{}).visible&&(this._symbolMark=this._createMark(cN.point,{groupKey:this._seriesField,isSeriesMark:!!t},{morph:cR(this._spec,cN.point.name),morphElementKey:this.getDimensionField()[0]})),!0===this._spec.activePoint){let t=new el(this._option.dataSet,{name:`${st}_series_${this.id}_active_point`});t.parse([]),this._symbolActiveMark=this._createMark({name:`active_point_${this.id}`,type:"symbol"},{groupKey:this._seriesField,isSeriesMark:!1,dataView:t,parent:this._region.getInteractionMark()},{morph:!1}),this._symbolActiveMark.setVisible(!1)}return this._symbolMark}initSymbolMarkStyle(){let t=this._symbolMark;if(!t)return this._initSymbolActiveMarkAlone(),t;if(this._initSymbolMark(t),this._symbolActiveMark&&this._symbolMark.stateStyle.dimension_hover){for(let e in this._symbolActiveMark.setVisible(!0),this.event.on(Z.dimensionHover,this._dimensionTrigger.bind(this)),this._symbolMark.stateStyle)for(let i in this._symbolActiveMark.stateStyle[e]={},this._symbolMark.stateStyle[e])"visible"!==i&&(this._symbolActiveMark.stateStyle[e][i]={style:null,level:W.Series,referer:t});this._symbolActiveMark.state.changeStateInfo({stateValue:j.STATE_DIMENSION_HOVER,filter:()=>!0})}return t}_initSymbolMark(t){t&&(this.setMarkStyle(t,{fill:this.getColorAttribute()},"normal",W.Series),this.setMarkStyle(t,{x:t=>"zero"===this._invalidType||this._getInvalidDefined(t)?this.dataToPositionX(t):Number.NaN,y:t=>"zero"===this._invalidType||this._getInvalidDefined(t)?this.dataToPositionY(t):Number.NaN,z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",W.Series))}_initSymbolActiveMarkAlone(){var t,e;let i=this._symbolActiveMark;i&&(this._initSymbolMark(i),i&&(null==(e=null==(t=this._spec[cN.point.name])?void 0:t.state)?void 0:e.dimension_hover)&&(i.setVisible(!0),this.event.on(Z.dimensionHover,this._dimensionTrigger.bind(this)),this.initMarkStyleWithSpec(i,ir({},this._spec[cN.point.name],{visible:!0})),this._symbolActiveMark.state.changeStateInfo({stateValue:j.STATE_DIMENSION_HOVER,filter:()=>!0})))}initLabelMarkStyle(t){var e;t&&("symbol"!==(null==(e=t.getTarget())?void 0:e.type)&&t.setRule("line-data"),this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null}),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},"normal",W.Series),this.event.on(rI.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(t,"visible")}))}initLineLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>{var e;return null!=(e=t[this.getSeriesField()])?e:this.getSeriesKeys()[0]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})}encodeDefined(t,e){var i,r,n,s;if(!t)return;let l=this._isFieldAllValid();if("zero"===this._invalidType||l){if(!0===(null==(r=null==(i=t.stateStyle.normal)?void 0:i[e])?void 0:r.style))return;this.setMarkStyle(t,{[e]:!0},"normal",W.Series)}else{if(!0!==(null==(s=null==(n=t.stateStyle.normal)?void 0:n[e])?void 0:s.style))return;this.setMarkStyle(t,{[e]:this._getInvalidDefined.bind(this)},"normal",W.Series)}t.compileEncode()}_isFieldAllValid(){let t=this.getViewDataStatistics(),e=this.getStackValueField();return!!(t&&t.latestData&&e)&&t.latestData[e]&&t.latestData[e].allValid}}function cG(t,e,i=!0){if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames){let r=Object.getOwnPropertyNames(e);for(let n=0;n<r.length;n++){let s=r[n];"constructor"!==s&&(i?null!=e[s]:null==t[s])&&(t[s]=e[s])}}else{var r=t,n=e,s=i;let l=function(t){if(!t)return[];if(Object.keys)return Object.keys(t);let e=[];for(let i in t)t.hasOwnProperty(i)&&e.push(i);return e}(n);for(let t=0;t<l.length;t++){let e=l[t];(s?null!=n[e]:null==r[e])&&(r[e]=n[e])}}}let cV=Object.assign(Object.assign({},cy),cN),cZ=(t,e)=>{var i,r;if(t===e)return!0;let n=null!=(i=t&&t.length)?i:0;return n===(null!=(r=e&&e.length)?r:0)&&0!==n&&t.every((t,i)=>!t&&!e[i]||t&&e[i]&&t.color===e[i].color&&t.offset===e[i].offset)},cU=(t,e)=>{if(t===e)return!0;if(typeof t!=typeof e||t6(t))return!1;if(tq(t))return t.length===e.length&&t.every((t,i)=>cU(t,e[i]));if(t.gradient!==e.gradient)return!1;let i=Object.keys(t),r=Object.keys(e);return i.length===r.length&&i.every(i=>"stops"===i?cZ(t[i],e[i]):t[i]===e[i])},cK=(t,e)=>t.length===e.length&&t.join("-")===e.join("-"),c$=(t,e,i)=>!(!er(t)||!er(e))||!er(t)&&!er(e)&&("lineDash"===i?cK(t,e):"stroke"===i||"fill"===i?cU(t,e):t===e),cY=["stroke","strokeOpacity","lineDash","lineDashOffset","lineCap","lineJoin","lineWidth","miterLimit"];class cX extends od{constructor(){super(...arguments),this._segmentStyleKeys=[],this._isValidPointChannel=t=>["x","y","defined"].includes(t)}_getSegmentAttributes(){return cY}initStyleWithSpec(t){this._segmentStyleKeys=[],super.initStyleWithSpec(t)}setStyle(t,e="normal",i=0){if(er(t))return;void 0===this.stateStyle[e]&&(this.stateStyle[e]={});let r=this._getIgnoreAttributes(),n=this._getSegmentAttributes(),s=this.isUserLevel(i);Object.keys(t).forEach(l=>{let a=t[l];if(er(a)||r.includes(l))return;s&&n.includes(l)&&(ln[null==a?void 0:a.type]||(null==a?void 0:a.scale)||tQ(a))&&(this._segmentStyleKeys.includes(l)||this._segmentStyleKeys.push(l));let o=this._filterAttribute(l,a,e,i,s);this.setAttribute(l,o,e,i)})}_getLineSegments(t,e){if(!this._segmentStyleKeys||!this._segmentStyleKeys.length)return null;let i=[],r=null;return t.forEach((t,e)=>{r&&this._segmentStyleKeys.every(e=>c$(r[e],t[e],e))||(i.length&&(i[i.length-1].endIndex=e),r=t,i.push({attrs:r,startIndex:e}))}),i.length>=2?i.map(t=>Object.assign(Object.assign({},t.attrs),{points:e.slice(t.startIndex,er(t.endIndex)?e.length:t.endIndex)})):null}_getPrevPoints(t){let{points:e,segments:i}=t.attribute;return null!=e?e:i?i.reduce((t,e)=>(e.points&&e.points.forEach(e=>{t.push(e)}),t),[]):null}_runPointsEncoder(t,e,i={}){var r,n,s;let l=e.context.data,a=[],o=[],h={},u=null==(r=this.renderContext)?void 0:r.progressive,d=u&&0===u.currentIndex;if(l.forEach((e,i)=>{var r;o[i]={},a[i]={},Object.keys(t).forEach(r=>{this._isValidPointChannel(r)?o[i][r]=t[r](e):this._segmentStyleKeys.includes(r)&&!u?a[i][r]=t[r](e):0!==i||u&&!d||(h[r]=t[r](e))}),o[i].context=null!=(r=this._keyGetter(e))?r:i}),u){let t=null!=(s=null==(n=e.attribute)?void 0:n.segments)?s:[];return t.push({points:o}),d?Object.assign(Object.assign({},h),{segments:t}):{segments:t}}if(this._segmentStyleKeys&&this._segmentStyleKeys.length){let t=this._getLineSegments(a,o);if(t)return Object.assign(Object.assign(Object.assign({},h),a[0]),{segments:t,points:null})}return Object.assign(Object.assign(Object.assign({},h),a[0]),{points:o,segments:null})}_runEncoderOfGraphic(t,e,i={}){let r=e.context.data;return t&&Object.keys(t).some(this._isValidPointChannel)&&r&&r.length?this._runPointsEncoder(t,e,i):super._runEncoderOfGraphic(t,e,i)}_getDataByKey(t){return this._dataByGroup}_runProgressiveJoin(){let t=this.renderContext.progressive.currentIndex,e=[];this._dataByGroup.keys.forEach((i,r)=>{let n=this.renderContext.progressive.groupedData.get(i),s=this.renderContext.progressive.step,l=n.slice(t*s,(t+1)*s);if(0===t){let t={context:Object.assign(Object.assign({},this._getCommonContext()),{diffState:N.enter,data:l,uniqueKey:i,key:i,groupKey:i})};e.push(t)}else this._graphics[r].context.data=l});let i=0===t?e:this._graphics;return{graphicsByGroup:{[ss]:i},graphics:i,needUpdate:!1}}_setCommonAttributesToTheme(t){}_addProgressiveGraphic(t,e){e.incremental=1,t.appendChild(e)}}var cq=i(32463),cJ=i(79134),cQ=i(95950),c0=i(45011),c1=i(47704),c2=i(21777),c3=i(14925);let c5=["#ffffff","#000000"];function c4(t,e,i,r,n,s){if("string"!=typeof t||"string"!=typeof e)return t;let l=new c3.Il(t).toHex(),a=new c3.Il(e).toHex();return c6(l,a,i,r,s)?l:function(t,e,i,r,n,s){let l=[];for(let a of(n&&(n instanceof Array?l.push(...n):l.push(n)),l.push(...c5),l))if(t!==a&&c6(a,e,i,r,s))return a}(l,a,i,r,n,s)}function c6(t,e,i,r,n){if("lightness"===n){let i=c3.Il.getColorBrightness(new c3.Il(e));return .5>c3.Il.getColorBrightness(new c3.Il(t))?i>=.5:i<.5}return r?c8(t,e)>r:"largeText"===i?c8(t,e)>3:c8(t,e)>4.5}function c8(t,e){let i=c9(t),r=c9(e);return((i>r?i:r)+.05)/((i>r?r:i)+.05)}function c9(t){let e=function(t){let e="",i="",r="",n=+("#"===t[0]);for(let s=n;s<t.length;s++)"#"!==t[s]&&(s<n+2?e+=t[s]:s<n+4?i+=t[s]:s<n+6&&(r+=t[s]));return[parseInt(e,16),parseInt(i,16),parseInt(r,16)]}(t),i=e[0]/255,r=e[1]/255,n=e[2]/255;return .2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))}function c7(t,e,i,r){let n;switch(t){case"base":n=e;break;case"invertBase":n=i;break;case"similarBase":n=r}return n}var pt=i(6091),pe=i(76114);let pi=new Uint32Array(33),pr=new Uint32Array(33);pr[0]=0,pi[0]=~pr[0];for(let t=1;t<=32;++t)pr[t]=pr[t-1]<<1|1,pi[t]=~pr[t];function pn(t,e,i={top:0,left:0,right:0,bottom:0}){let{top:r=0,left:n=0,right:s=0,bottom:l=0}=i,a=Math.max(1,Math.sqrt(t*e/1e6)),o=~~((t+n+s+a)/a),h=~~((e+r+l+a)/a),u=t=>~~(t/a);return u.bitmap=()=>(function(t,e){let i=new Uint32Array(~~((t*e+32)/32));return{array:i,get:(e,r)=>{let n=r*t+e;return i[n>>>5]&1<<(31&n)},set:(e,r)=>{let n=r*t+e;i[n>>>5]|=1<<(31&n)},clear:(e,r)=>{let n=r*t+e;i[n>>>5]&=~(1<<(31&n))},getRange:({x1:r,y1:n,x2:s,y2:l})=>{if(s<0||l<0||r>t||n>e)return!0;let a,o,h,u,d=l;for(;d>=n;--d)if(a=d*t+r,o=d*t+s,(h=a>>>5)==(u=o>>>5)){if(i[h]&pi[31&a]&pr[1+(31&o)])return!0}else{if(i[h]&pi[31&a]||i[u]&pr[1+(31&o)])return!0;for(let t=h+1;t<u;++t)if(i[t])return!0}return!1},setRange:({x1:r,y1:n,x2:s,y2:l})=>{var a,o,h,u;let d,c,p,g,f;if(!(s<0)&&!(l<0)&&!(r>t)&&!(n>e))for(;n<=l;++n)if(d=n*t+r,c=n*t+s,(p=d>>>5)==(g=c>>>5))a=pi[31&d]&pr[1+(31&c)],i[p]|=a;else for(o=pi[31&d],i[p]|=o,h=pr[1+(31&c)],i[g]|=h,f=p+1;f<g;++f)u=f,i[u]|=0xffffffff},clearRange:({x1:e,y1:r,x2:n,y2:s})=>{var l,a,o,h;let u,d,c,p,g;for(;r<=s;++r)if(u=r*t+e,d=r*t+n,(c=u>>>5)==(p=d>>>5))l=pr[31&u]|pi[1+(31&d)],i[c]&=l;else for(a=pr[31&u],i[c]&=a,o=pi[1+(31&d)],i[p]&=o,g=c+1;g<p;++g)h=g,i[h]&=0},outOfBounds:({x1:i,y1:r,x2:n,y2:s})=>i<0||r<0||s>=e||n>=t,toImageData:r=>{let n=r.createImageData(t,e),s=n.data;for(let r=0;r<e;++r)for(let e=0;e<t;++e){let n=r*t+e,l=4*n,a=i[n>>>5]&1<<(31&n);s[l+0]=255*a,s[l+1]=255*a,s[l+2]=255*a,s[l+3]=31}return n}}})(o,h),u.x=t=>~~((t+n)/a),u.y=t=>~~((t+r)/a),u.ratio=a,u.padding=i,u.width=t,u.height=e,u}function ps(t,e){let{x1:i,x2:r,y1:n,y2:s}=e,{top:l=0,left:a=0,right:o=0,bottom:h=0}=t.padding,u=(0,uI.Z)(i,-a,t.width+o),d=(0,uI.Z)(r,-a,t.width+o),c=(0,uI.Z)(n,-l,t.height+h),p=(0,uI.Z)(s,-l,t.height+h);return{x1:t.x(u),x2:t.x(d),y1:t.y(c),y2:t.y(p)}}function pl(t,e,i=!1){return i?ps(t,e):{x1:t.x(e.x1),x2:t.x(e.x2),y1:t.y(e.y1),y2:t.y(e.y2)}}function pa(t,e,i,r=!0,n=0){let s=i;n>0&&(s={x1:i.x1-n,x2:i.x2+n,y1:i.y1-n,y2:i.y2+n}),s=pl(t,s);let l=e.outOfBounds(s);return(!r||!l)&&(l&&(s=ps(t,s)),!e.getRange(s))}function po(t,e,i,r=[],n=!0,s=0,l=!1){let a=r.filter(t=>(0,c2.Z)(t));for(let r=0;r<a.length;r++){let o;if((o=l?i:i.clone()).setAttributes(a[r]),pa(t,e,o.AABBBounds,n,s))return e.setRange(pl(t,o.AABBBounds,!0)),a[r]}return!1}let ph=["top","bottom","right","left","top-right","bottom-right","top-left","bottom-left"],pu=["top","inside-top","inside"];function pd(t,e,i,r={}){let{x1:n,x2:s,y1:l,y2:a}=t.AABBBounds,{top:o=0,left:h=0,right:u=0,bottom:d=0}=r,c=Math.min(n,s),p=Math.max(n,s),g=Math.min(l,a),f=Math.max(l,a),m=e+u,y=i+d,v=0,b=0;return c<0-h?v=-c:p>m&&(v=m-p),g<0-o?b=-g:f>y&&(b=y-f),{dx:v,dy:b}}let pc={mode:"same-time",duration:300,easing:"linear"};function pp(t){return 3===t||4===t}let pg=(t,e,i="top",r=0)=>{if(!t)return;let{x1:n,y1:s,x2:l,y2:a}=t,o=Math.abs(l-n),h=Math.abs(a-s),u=(e.x1+e.x2)/2,d=(e.y1+e.y2)/2,c=0,p=0,g=0,f=0;e&&(g=Math.abs(e.x1-e.x2)/2,f=Math.abs(e.y1-e.y2)/2);let m={"top-right":-235,"top-left":235,"bottom-right":45,"bottom-left":-45};switch(i){case"top":p=-1;break;case"bottom":p=1;break;case"left":c=-1;break;case"right":c=1;break;case"bottom-left":case"bottom-right":case"top-left":case"top-right":c=Math.sin(m[i]*(Math.PI/180)),p=Math.cos(m[i]*(Math.PI/180));break;case"center":c=0,p=0}return{x:u+c*(r+g)+o/2*Math.sign(c),y:d+p*(r+f)+h/2*Math.sign(p)}},pf=t=>{if(!t||!t.attribute)return[];let{points:e,segments:i}=t.attribute;if(i&&i.length){let t=[];return i.forEach(e=>{e.points.forEach(e=>{t.push(e)})}),t}return e};function pm(t,e,i,r,n,s){return Math.abs(e/t)<s/n?{x:i+(t>0?n:-n),y:r+e*n/Math.abs(t)}:{x:i+t*s/Math.abs(e),y:r+(e>0?s:-s)}}var py=i(69877),pv=i(840),pb=i(3793),p_=i(18101),px=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class pC extends aq.Or{onBind(){let t=(0,pb.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,{prevText:r,curText:n,prevLabelLine:s,curLabelLine:l,increaseEffect:a=!0}=this.params,o={};for(let t in n.attribute)r.attribute[t]!==n.attribute[t]&&(o[t]=n.attribute[t]);let{text:h}=o,u=px(o,["text"]);t.animate(r,{type:"to",to:u,duration:e,easing:i}),!1!==a&&t.animate(r,{type:"increaseCount",to:{text:n.attribute.text},duration:e,easing:i}),s&&t.animate(s,{type:"to",to:l.attribute,duration:e,easing:i}),this.completeBind(t)}tryPreventConflict(){}}class pw extends aq.Or{onBind(){let t=(0,pb.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,{relatedGraphic:r,relatedGraphics:n,config:s}=this.params,{mode:l,type:a="fadeIn"}=s,o=this.target,h=0;"after"===l?r.animates&&r.animates.forEach(t=>{h=Math.max(h,t.getStartTime()+t.getTotalDuration())}):"after-all"===l?n&&n.forEach(t=>{t.animates&&t.animates.forEach(t=>{h=Math.max(h,t.getStartTime()+t.getTotalDuration())})}):r.animates&&r.animates.forEach(t=>{h=Math.max(h,t.getStartTime())}),t.animate(o,Object.assign(Object.assign({},s),{duration:e,easing:i,startTime:h,type:a})),this.completeBind(t)}tryPreventConflict(){}}var pS=i(25258);let pA=(t,e)=>Math.ceil(t)>Math.floor(e),pM=([t,e],[i,r])=>r>t&&e>i;var pk=i(307),pT=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};(0,op.M)(),(0,py.g)(),(0,pv.v)(),(0,cJ.N)(),uO.a.registerBuiltInAnimate("increaseCount",p_.B),uO.a.registerBuiltInAnimate("labelUpdate",pC),uO.a.registerBuiltInAnimate("labelEnter",pw);class pR extends pk.g{setBitmap(t){this._bitmap=t}setBitmapTool(t){this._bmpTool=t}constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cQ.Z)({},pR.defaultAttributes,pT(t,["data"])))),this.name="label",this._onHover=t=>{let e=t.target;e===this._lastHover||(0,c1.Z)(e.states)||(e.addState(pe.HW.hover,!0),(0,pt.Ck)(this,t=>{t===e||(0,c1.Z)(t.states)||t.addState(pe.HW.hoverReverse,!0)}),this._lastHover=e)},this._onUnHover=t=>{this._lastHover&&((0,pt.Ck)(this,t=>{(0,c1.Z)(t.states)||(t.removeState(pe.HW.hoverReverse),t.removeState(pe.HW.hover))}),this._lastHover=null)},this._onClick=t=>{let e=t.target;if(this._lastSelect===e&&e.hasState("selected"))return this._lastSelect=null,void(0,pt.Ck)(this,t=>{(0,c1.Z)(t.states)||(t.removeState(pe.HW.selectedReverse),t.removeState(pe.HW.selected))});(0,c1.Z)(e.states)||(e.addState(pe.HW.selected,!0),(0,pt.Ck)(this,t=>{t===e||(0,c1.Z)(t.states)||t.addState(pe.HW.selectedReverse,!0)}),this._lastSelect=e)},this._handleRelatedGraphicSetState=t=>{var e,i,r,n,s;if((null==(e=t.detail)?void 0:e.type)===a$.Gk.STATE||(null==(i=t.detail)?void 0:i.type)===a$.Gk.ANIMATE_UPDATE&&(null==(r=t.detail.animationState)?void 0:r.isFirstFrameOfStep)){let e=null!=(s=null==(n=t.target)?void 0:n.currentStates)?s:[],i=this._isCollectionBase?[...this._graphicToText.values()]:[this._graphicToText.get(t.target)];this.updateStatesOfLabels(i,e)}}}labeling(t,e,i,r){}_getLabelLinePoints(t,e){return function(t,e){if(!t||!e||(0,aE.SX)(t,e,!0))return;let i=Math.min(t.x1,t.x2),r=Math.min(t.y1,t.y2),n=Math.min(e.x1,e.x2),s=Math.min(e.y1,e.y2),l=Math.abs(t.x2-i)/2,a=Math.abs(t.y2-r)/2,o=Math.abs(e.x2-n)/2,h=Math.abs(e.y2-s)/2,u=i+l,d=r+a,c=n+o,p=s+h,g=c-u,f=p-d;return[pm(g,f,u,d,l,a),pm(-g,-f,c,p,o,h)]}(t.AABBBounds,null==e?void 0:e.AABBBounds)}_createLabelLine(t,e){let i=this._getLabelLinePoints(t,e);if(i){let r=c0.i.line({points:i}),{line:n={}}=t.attribute;if(n.customShape){let i=n.customShape;r.pathProxy=r=>i({text:t,baseMark:e},r,new a_.r)}return e&&e.getAttributes(!0).fill&&r.setAttribute("stroke",e.getAttributes(!0).fill),this.attribute.line&&!(0,c1.Z)(this.attribute.line.style)&&r.setAttributes(this.attribute.line.style),this._setStatesOfLabelLine(r),r}}render(){if(this._prepare(),(0,aY.Z)(this._idToGraphic)||this._isCollectionBase&&(0,aY.Z)(this._idToPoint))return;let t=[];!1!==this._enableAnimation&&this._baseMarks.forEach(e=>{t.push(e.attribute),e.initAttributes(e.getAttributes(!0))});let{overlap:e,smartInvert:i,dataFilter:r,customLayoutFunc:n,customOverlapFunc:s}=this.attribute,l=this.attribute.data;if((0,uy.Z)(r)&&(l=r(l)),l&&l.length){let t=new Set;l=l.filter(e=>!t.has(e.id)&&t.add(e.id))}let a=this._initText(l);a=(0,uy.Z)(n)?n(l,a,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null,this):this._layout(a),(0,uy.Z)(s)?a=s(a,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null,this):!1!==e&&(a=this._overlapping(a)),(0,uy.Z)(this.attribute.onAfterOverlapping)&&this.attribute.onAfterOverlapping(a,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null,this),a&&a.length&&a.forEach(t=>{this._bindEvent(t),this._setStatesOfText(t)}),!1!==i&&this._smartInvert(a),this._renderLabels(a),!1!==this._enableAnimation&&this._baseMarks.forEach((e,i)=>{e.initAttributes(t[i])})}_bindEvent(t){if(this.attribute.disableTriggerEvent||!t)return;let{hover:e,select:i}=this.attribute;e&&(t.addEventListener("pointermove",this._onHover),t.addEventListener("pointerout",this._onUnHover)),i&&t.addEventListener("pointerdown",this._onClick)}_setStatesOfText(t){if(!t)return;let e=this.attribute.state;e&&!(0,c1.Z)(e)&&(t.states=e)}_setStatesOfLabelLine(t){if(!t)return;let e=this.attribute.labelLineState;e&&!(0,c1.Z)(e)&&(t.states=e)}_createLabelText(t){var e,i;let r=Object.assign(Object.assign({},null==(i=null==(e=this.stage)?void 0:e.getTheme())?void 0:i.text),t);return(0,om.vS)(r,"textType")}_prepare(){var t,e;let i=[];if(((0,uy.Z)(this.attribute.getBaseMarks)?this.attribute.getBaseMarks():(0,pt.tP)(this.getRootNode(),this.attribute.baseMarkGroupName)).forEach(t=>{"willRelease"!==t.releaseStatus&&i.push(t)}),null==(t=this._idToGraphic)||t.clear(),null==(e=this._idToPoint)||e.clear(),this._baseMarks=i,this._isCollectionBase="line-data"===this.attribute.type,!i||0===i.length)return;let{data:r}=this.attribute;if(r&&0!==r.length){if(this._idToGraphic||(this._idToGraphic=new Map),this._isCollectionBase){this._idToPoint||(this._idToPoint=new Map);let t=0;for(let e=0;e<i.length;e++){let n=i[e],s=pf(n);if(s&&s.length)for(let e=0;e<s.length;e++){let i=r[t];i&&s[e]&&((0,c2.Z)(i.id)||(i.id=`vrender-component-${this.name}-${t}`),this._idToPoint.set(i.id,s[e]),this._idToGraphic.set(i.id,n)),t++}}}else for(let t=0;t<i.length;t++){let e=r[t],n=i[t];e&&n&&((0,c2.Z)(e.id)||(e.id=`vrender-component-${this.name}-${t}`),this._idToGraphic.set(e.id,n))}this._prepareAnimate(pc)}}getRelatedGraphic(t){return this._idToGraphic.get(t.id)}_initText(t=[]){let{textStyle:e={}}=this.attribute,i=[];for(let r=0;r<t.length;r++){let n=t[r],s=this.getRelatedGraphic(n);if(!s)continue;let l=s.getAttributes(!0),a=Object.assign(Object.assign({fill:this._isCollectionBase?(0,aX.Z)(l.stroke)?l.stroke.find(t=>!!t&&!0!==t):l.stroke:l.fill},e),n),o=this._createLabelText(a);i.push(o)}return i}_layout(t){let{position:e,offset:i}=this.attribute;for(let r=0;r<t.length;r++){let n=t[r];if(!n)return;let s=n.attribute,l=this.getRelatedGraphic(s);if(!l)continue;n.attachedThemeGraphic=this;let a=this.getGraphicBounds(n);n.attachedThemeGraphic=null;let o=(0,uy.Z)(e)?e(s):e,h=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(s.id),o):this.getGraphicBounds(l,{x:s.x,y:s.y},o),u=this.labeling(a,h,o,i);u&&n.setAttributes(u)}return t}_overlapping(t){var e,i,r;if(0===t.length)return[];let n=(0,uv.Z)(this.attribute.overlap)?this.attribute.overlap:{},s=this.getBaseMarkGroup(),l=null!=(e=n.size)?e:{width:null!=(i=null==s?void 0:s.AABBBounds.width())?i:0,height:null!=(r=null==s?void 0:s.AABBBounds.height())?r:0};if(0===l.width||0===l.height)return t;let{strategy:a,priority:o}=n,h=this._bmpTool||pn(l.width,l.height),u=this._bitmap||h.bitmap();return o&&(t=t.sort((t,e)=>o(e.attribute.data)-o(t.attribute.data))),"shiftY"===(null==a?void 0:a.type)?this._overlapGlobal(t,n,h,u):this._overlapByStrategy(t,n,h,u)}_overlapGlobal(t,e,i,r){let n=t.filter(t=>t.attribute.visible&&0!==t.attribute.opacity&&this.isMarkInsideRect(this.getRelatedGraphic(t.attribute),i)),{clampForce:s=!0,hideOnHit:l=!0,hideOnOverflow:a=!1,overlapPadding:o,strategy:h}=e;if(s||a)for(let e=0;e<n.length;e++){let r=t[e],{dx:n=0,dy:s=0}=pd(r,i.width,i.height,i.padding);0===n&&0===s||(a?r.setAttributes({visible:!1}):(r.setAttributes({x:r.attribute.x+n,y:r.attribute.y+s}),r._isClamped=!0))}n=function(t,e){let{maxY:i=Number.MAX_VALUE,labelling:r,globalShiftY:n={enable:!0,maxIterations:10,maxError:.1,padding:1}}=e,s=t.length;if(s<=1)return t;let l=new Map,a=new Map,o=t=>a.get(t).y1Initial,h=t=>a.get(t).height,u=t=>a.get(t).y1,d=t=>a.get(t).x,c=t=>a.get(t).x1,p=t=>a.get(t).x2,g=t=>a.get(t).attempts,f=(t,e)=>{a.get(t).y1=e},m=(t,e)=>{a.get(t).attempts=e};for(let e of(t.sort((t,e)=>t.attribute.x-e.attribute.x),t)){let{y1:t,y2:i,x1:r,x2:n}=e.AABBBounds,{x:s,y:o}=e.attribute;a.set(e,{y1Initial:t,y1:t,y2:i,y:o,height:i-t,x1:r,x2:n,x:s,attempts:0});let h=!1;for(let[t,i]of l){let{start:a,end:o}=t;if(r>=a&&n<=o)i.push(e),h=!0;else if((0,pS.Yt)(s,d(i[0]),void 0,5)){let s={start:Math.min(a,r),end:Math.max(o,n)};i.push(e),l.set(s,i),l.delete(t),h=!0}else if(function(t,e){let[i,r]=t,[n,s]=e;return Math.max(0,Math.min(r,s)-Math.max(i,n))}([a,o],[r,n])/(o-a)>.5){let s={start:Math.min(a,r),end:Math.max(o,n)};i.push(e),l.set(s,i),l.delete(t),h=!0}if(h)break}h||l.set({start:r,end:n},[e])}for(let t of l.values())t.sort((t,e)=>o(t)-o(e)),function(t){for(let e=t.length-1;e>=0;e--){let n=t[e],s=t[e-1],l=t[e+1];if(s&&pA(u(s)+h(s),u(n))||0===u(n)&&n._isClamped){let{y:t}=r(n);l&&pA(t+h(n)/2,u(l))||t+h(n)/2<=i&&f(n,u(n)+t-a.get(n).y)}}}(t);if(!1!==n.enable){let{maxIterations:e=10,maxError:r=.1,padding:l=1,maxAttempts:a=1e3,deltaYTolerance:d=Number.MAX_VALUE}=n;for(let n=0;n<e;n++){t.sort((t,e)=>o(t)-o(e));let e=0;for(let r=0;r<s-1;r++){let n=t[r];if(g(n)>=a)continue;let s,y=r+1;for(;(s=t[y])&&!pM([c(n),p(n)],[c(s),p(s)]);)y+=1;if(s){let t=u(n),r=h(n),a=u(s),c=a-(t+r);if(c<l){let r=(l-c)/2;if(e=Math.max(e,r),t+r+h(s)>i){let e=t-(l-c);Math.abs(o(n)-e)<=d&&(f(n,e),m(n,g(n)+1))}else if(t-r<0){let t=a+(l-c);Math.abs(o(s)-t)<=d&&(f(s,t),m(s,g(s)+1))}else{let e=t-r,i=o(n)-e,l=a+r,h=o(s)-l;Math.abs(i)<=d&&Math.abs(h)<=d&&(f(n,e),f(s,l),m(n,g(n)+1),m(s,g(s)+1))}}}}if(e<r)break}}for(let e of t){let t=e.attribute.y+u(e)-o(e);e.setAttribute("y",t)}let y=[];t.sort((t,e)=>t.attribute.x-e.attribute.x);let v=0,b=t.length-1;for(;v<=b;)v===b?y.push(t[v]):(y.push(t[v]),y.push(t[b])),v++,b--;return y}(n,Object.assign(Object.assign({maxY:i.height},h),{labelling:t=>{let e=this.getRelatedGraphic(t.attribute),i=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t.attribute.id)):this.getGraphicBounds(e,t);return this.labeling(t.AABBBounds,i,"bottom",this.attribute.offset)}}));for(let t=0;t<n.length;t++){let e=n[t],h=e.AABBBounds,u=pl(i,h,!0);if(pa(i,r,h,s||a,o))r.setRange(u);else{if(a){if(this._processHideOnOverflow(e,i))continue}else if(s&&this._processClampForce(e,i,r,o))continue;l?e.setAttributes({visible:!1}):r.setRange(u)}}return n}_processHideOnOverflow(t,e){let{dy:i=0,dx:r=0}=pd(t,e.width,e.height,e.padding);return 0===r&&0===i||(t.setAttributes({visible:!1}),!1)}_processClampForce(t,e,i,r=0){let{dy:n=0,dx:s=0}=pd(t,e.width,e.height,e.padding);if(0===s&&0===n){if(pa(e,i,t.AABBBounds,!1,r))return i.setRange(pl(e,t.AABBBounds,!0)),!0}else if(pa(e,i,{x1:t.AABBBounds.x1+s,x2:t.AABBBounds.x2+s,y1:t.AABBBounds.y1+n,y2:t.AABBBounds.y2+n}))return t.setAttributes({x:t.attribute.x+s,y:t.attribute.y+n}),i.setRange(pl(e,t.AABBBounds,!0)),!0;return!1}_overlapByStrategy(t,e,i,r){var n;let{avoidBaseMark:s,strategy:l=[],hideOnHit:a=!0,clampForce:o=!0,avoidMarks:h=[],overlapPadding:u,hideOnOverflow:d=!1}=e,c=[],p=l.some(t=>"bound"===t.type);s&&(null==(n=this._baseMarks)||n.forEach(t=>{t.AABBBounds&&r.setRange(pl(i,t.AABBBounds,!0))})),h.length>0&&h.forEach(t=>{(0,ub.Z)(t)?(0,pt.Dh)(this.getRootNode(),t).forEach(t=>{t.AABBBounds&&r.setRange(pl(i,t.AABBBounds,!0))}):t.AABBBounds&&r.setRange(pl(i,t.AABBBounds,!0))});for(let e=0;e<t.length;e++){if(!1===t[e].attribute.visible)continue;let n=t[e],s=this.getRelatedGraphic(n.attribute);if(n.update(),!this.isMarkInsideRect(s,i))continue;if(pa(i,r,n.AABBBounds,o||d,u)&&(!p||p&&s&&s.AABBBounds&&this._canPlaceInside(n.AABBBounds,s.AABBBounds))){r.setRange(pl(i,n.AABBBounds,!0)),c.push(n);continue}let h=!1;for(let a=0;a<l.length;a++)if(!1!==(h=function(t,e,i,r,n,s,l){var a,o;let h=null==(a=r.overlap)?void 0:a.clampForce,u=null==(o=r.overlap)?void 0:o.overlapPadding;if("bound"===i.type||"position"===i.type){if((0,uy.Z)(l)){let a=(((0,uy.Z)(i.position)?i.position(n.attribute):i.position)||("rect"===r.type?pu:ph)).map(t=>l(n.AABBBounds,s,t,r.offset));return po(t,e,n,a,h,u,!1===i.restorePosition)}return!1}if("moveY"===i.type){let r=(i.offset?(0,uy.Z)(i.offset)?i.offset(n.attribute):i.offset:[]).map(t=>({x:n.attribute.x,y:n.attribute.y+t}));return po(t,e,n,r,h,u)}if("moveX"===i.type){let r=(i.offset?(0,uy.Z)(i.offset)?i.offset(n.attribute):i.offset:[]).map(t=>({x:n.attribute.x+t,y:n.attribute.y}));return po(t,e,n,r,h,u)}return!1}(i,r,l[a],this.attribute,n,this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t[e].attribute.id)):this.getGraphicBounds(s,t[e].attribute),this.labeling))&&(n.setAttributes({x:h.x,y:h.y}),!d||this._processHideOnOverflow(n,i))){c.push(n);break}if(!h){if(d&&!this._processHideOnOverflow(n,i))continue;if(o&&this._processClampForce(n,i,r,u)){c.push(n);continue}}h||a||c.push(n)}return c}isMarkInsideRect(t,e){let{left:i,right:r,top:n,bottom:s}=e.padding,l={x1:-i,x2:e.width+r,y1:-n,y2:e.height+s},a=t.AABBBounds;if(0!==a.width()&&0!==a.height())return(0,aE.SX)(t.AABBBounds,l,!0);let{attribute:o}=t;if("rect"===t.type){let{x:t,x1:e,y:i,y1:r}=o;return(0,aE.qr)({x:null!=t?t:e,y:null!=i?i:r},l,!0)}return"x"in o&&"y"in o&&(0,aE.qr)({x:o.x,y:o.y},l,!0)}getBaseMarkGroup(){let{baseMarkGroupName:t}=this.attribute;if(t)return this.getRootNode().find(e=>e.name===t,!0)}getGraphicBounds(t,e={},i){var r;if(t){if(!1!==t.attribute.visible){if(null==(r=t.context)?void 0:r.animationState){let e=t.clone();return Object.assign(e.attribute,t.getAttributes(!0)),e.AABBBounds}return t.AABBBounds}let{x:e,y:i}=t.attribute;return{x1:e,x2:e,y1:i,y2:i}}if(e&&i&&"inside-middle"===i){let{x:t,y:i,x1:r=t,y1:n=i}=e;return{x1:(t+r)/2,x2:(t+r)/2,y1:(i+n)/2,y2:(i+n)/2}}let{x:n,y:s}=e;return{x1:n,x2:n,y1:s,y2:s}}_renderLabels(t){var e;let{syncState:i}=this.attribute,r=new Map,n=this._graphicToText||new Map,s=[],l=[],{visible:a}=null!=(e=this.attribute.line)?e:{};t&&t.forEach((t,e)=>{var o;let h,u=this.getRelatedGraphic(t.attribute),d=this._isCollectionBase?t.attribute.id:u,c=(null==n?void 0:n.get(d))?"update":"enter";a&&(h=this._createLabelLine(t,u));let p=h?{text:t,labelLine:h}:{text:t};if(i&&this.updateStatesOfLabels([p],null!=(o=u.currentStates)?o:[]),"enter"===c)s.push(t),r.set(d,p),this._addLabel(p,s,l,e);else if("update"===c){let t=n.get(d);n.delete(d),r.set(d,t),this._updateLabel(t,p)}}),this._removeLabel(n),this._graphicToText=r}runEnterAnimation(t,e){if(!1===this._enableAnimation||!this._animationConfig.enter)return;let i=this.getRelatedGraphic(t.attribute),{enter:r}=this._animationConfig;[t,e].filter(Boolean).forEach(e=>e.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r),{type:"labelEnter",selfOnly:!0,customParameters:{relatedGraphic:i,relatedGraphics:this._idToGraphic,config:Object.assign(Object.assign({},r),{type:e===t?r.type:"fadeIn"})}})}]))}_runUpdateAnimation(t,e){let{text:i,labelLine:r}=t,{text:n,labelLine:s}=e;i.applyAnimationState(["update"],[{name:"update",animation:{type:"labelUpdate",customParameters:Object.assign(Object.assign({},this._animationConfig.update),{prevText:i,curText:n,prevLabelLine:r,curLabelLine:s})}}])}_syncStateWithRelatedGraphic(t){this.attribute.syncState&&t&&t.on("afterStateUpdate",this._handleRelatedGraphicSetState)}_addLabel(t,e,i,r){let{text:n,labelLine:s}=t,l=this.getRelatedGraphic(n.attribute);this._syncStateWithRelatedGraphic(l),n&&this.add(n),s&&this.add(s),this.runEnterAnimation(n,s)}_updateLabel(t,e){let{text:i,labelLine:r}=t,{text:n,labelLine:s}=e;!1===this._enableAnimation||!1===this._animationConfig.update?(t.text.setAttributes(n.attribute),r&&s&&t.labelLine.setAttributes(s.attribute)):this._runUpdateAnimation(t,e)}_removeLabel(t){let e=t=>{this.removeChild(t.text),t.labelLine&&this.removeChild(t.labelLine)};!1!==this._enableAnimation&&!1!==this._animationConfig.exit?t.forEach(t=>{var i;t.text.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},this._animationConfig.exit),{type:"fadeOut"})}],()=>{e(t)}),null==(i=t.labelLine)||i.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},this._animationConfig.exit),{type:"fadeOut"})}],()=>{})}):t.forEach(t=>{e(t)})}updateStatesOfLabels(t,e){t.forEach(t=>{t&&(t.text&&t.text.useStates(e),t.labelLine&&t.labelLine.useStates(e))})}_smartInvert(t){var e,i,r,n,s,l,a;let o=(0,uv.Z)(this.attribute.smartInvert)?this.attribute.smartInvert:{},{textType:h,contrastRatiosThreshold:u,alternativeColors:d,mode:c,interactInvertType:p}=o,g=null!=(e=o.fillStrategy)?e:"invertBase",f=null!=(i=o.strokeStrategy)?i:"base",m=null!=(r=o.brightColor)?r:"#ffffff",y=null!=(n=o.darkColor)?n:"#000000",v=null!=(s=o.outsideEnable)&&s;if("null"!==g||"null"!==f)for(let e=0;e<t.length;e++){let i=t[e];if(!i)continue;let r=this.getRelatedGraphic(i.attribute),n=r.getAttributes(!0).fill,s=i.attribute.fill;if((0,uv.Z)(n)&&n.gradient){let t=null==(a=null==(l=n.stops)?void 0:l[0])?void 0:a.color;t&&(n=t,s=t)}let o=c4(s,n,h,u,d,c),b=c6(o,m)?m:y,_=this._canPlaceInside(i.AABBBounds,r.AABBBounds),x=!_&&i.AABBBounds&&r.AABBBounds&&r.AABBBounds.intersects(i.AABBBounds);if(_||v||x&&"inside"===p){let t=c7(g,n,o,b);if(t&&i.setAttributes({fill:t}),0===i.attribute.lineWidth||0===i.attribute.strokeOpacity)continue;let e=c7(f,n,o,b);e&&i.setAttributes({stroke:e})}else if(x&&"none"!==p){if(0===i.attribute.lineWidth||0===i.attribute.strokeOpacity)continue;if(i.attribute.stroke){i.setAttributes({fill:c4(i.attribute.fill,i.attribute.stroke,h,u,d,c)});continue}let t=c7(g,n,o,b);t&&i.setAttributes({fill:t});let e=c7(f,n,o,b);e&&i.setAttributes({stroke:e})}}}_canPlaceInside(t,e){return!(!t||!e)&&e.encloses(t)}setLocation(t){this.translateTo(t.x,t.y)}disableAnimation(){this._enableAnimation=!1}enableAnimation(){this._enableAnimation=!0}}pR.defaultAttributes={textStyle:{fontSize:12,textAlign:"center",textBaseline:"middle",boundsPadding:[-2,-1,-2,-1]},offset:0,pickable:!1};let pB={},pP=(t,e)=>{pB[t]=e},pE=t=>pB[t];var pI=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class pL extends pR{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cQ.Z)({},pL.defaultAttributes,pI(t,["data"])))),this.name="line-label"}getGraphicBounds(t,e={},i="end"){if(!t||"line"!==t.type&&"area"!==t.type)return super.getGraphicBounds(t,e);let r=t.attribute.points,n=t.attribute.segments;!r&&n&&n.length&&(r=n.reduce((t,e)=>{var i;return t.concat(null!=(i=e.points)?i:[])},[])),r&&0!==r.length||(r=[e]);let s="start"===i?0:r.length-1;return r[s]?{x1:r[s].x,x2:r[s].x,y1:r[s].y,y2:r[s].y}:void 0}labeling(t,e,i="end",r=0){return function(t,e,i="end",r=0){if(!t||!e)return{x:1/0,y:1/0};let{x1:n,x2:s}=t,l=Math.abs(s-n),a=e.x1,o=a;return"end"===i?o=a+l/2+r:"start"===i&&(o=a-l/2-r),{x:o,y:e.y1}}(t,e,i,r)}}pL.defaultAttributes={textStyle:{fill:"#000"},position:"end",offset:6};let pF=()=>{pP("line",pL),pP("area",pL)};var pO=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class pD extends pR{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cQ.Z)({},pD.defaultAttributes,pO(t,["data"])))),this.name="symbol-label"}labeling(t,e,i="top",r=0){return pg(t,e,i,r)}}pD.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};let pH=()=>{pP("symbol",pD),pP("line-data",pD)};class pz extends cX{constructor(){super(...arguments),this.type=pz.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:1})}_getIgnoreAttributes(){var t,e;return(null==(t=this.model)?void 0:t.type)===rR.radar&&"polar"===(null==(e=this.model)?void 0:e.coordinate)?[]:["fill","fillOpacity"]}}pz.type="line";let pW=()=>{iv.registerMark(pz.type,pz),(0,oc.W)(),(0,cJ.N)(),pF(),pH(),di(),iv.registerGraphicComponent("line",cq.W)};var pN=i(8042),pj=i(95694);class pG extends od{constructor(){super(...arguments),this.type=pG.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{size:1,symbolType:"circle",fill:void 0,lineWidth:0})}_transformGraphicAttributes(t,e,i){var r,n,s;let l=super._transformGraphicAttributes(t,e,i),a=null!=(n=null!=(r=l.shape)?r:l.symbolType)?n:null==(s=t.attribute)?void 0:s.symbolType;return er(a)?l.symbolType="circle":l.symbolType=a,l}}pG.type="symbol";let pV=()=>{iv.registerMark(pG.type,pG),(0,oc.W)(),(0,pj.k)(),pH(),iv.registerGraphicComponent("symbol",pN.t)};class pZ extends cE{_transformLabelSpec(t){var e,i,r;!1!==(null==(e=t.point)?void 0:e.visible)&&!1!==(null==(r=null==(i=t.point)?void 0:i.style)?void 0:r.visible)?this._addMarkLabelSpec(t,"point"):this._addMarkLabelSpec(t,"line"),this._addMarkLabelSpec(t,"line","lineLabel","initLineLabelMarkStyle",void 0,!0)}}function pU(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1]}function pK(t,e,i,r){let n=t[0],s=e[0],l=i[0],a=r[0];return s<n&&([n,s]=[s,n]),a<l&&([a,l]=[l,a]),!(s<l||a<n)&&(n=t[1],s=e[1],l=i[1],a=r[1],s<n&&([n,s]=[s,n]),a<l&&([a,l]=[l,a]),!(s<l||a<n))}function p$(t,e,i){if(!e)return!0;if(!i)return t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2;let r=e.x1,n=e.x2,s=e.y1,l=e.y2;return r>n&&([r,n]=[n,r]),s>l&&([s,l]=[l,s]),t.x>=r&&t.x<=n&&t.y>=s&&t.y<=l}(A=U||(U={}))[A.NONE=0]="NONE",A[A.BBOX1=1]="BBOX1",A[A.BBOX2=2]="BBOX2";class pY{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new pY(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return tq(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){let r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){let n=this.scalePoints(t,e,i,r);return this.clear().add(n[0],n[1]).add(n[2],n[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return function(t,e,i){let{x1:r,y1:n,x2:s,y2:l}=e;i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f)):(t.clear(),t.add(i.a*r+i.c*n+i.e,i.b*r+i.d*n+i.f),t.add(i.a*s+i.c*n+i.e,i.b*s+i.d*n+i.f),t.add(i.a*s+i.c*l+i.e,i.b*s+i.d*l+i.f),t.add(i.a*r+i.c*l+i.e,i.b*r+i.d*l+i.f))}(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){let{x1:r,y1:n,x2:s,y2:l}=this,a=Math.cos(t),o=Math.sin(t),h=e-e*a+i*o,u=i-e*o-i*a;return[a*r-o*n+h,o*r+a*n+u,a*r-o*l+h,o*r+a*l+u,a*s-o*n+h,o*s+a*n+u,a*s-o*l+h,o*s+a*l+u]}scalePoints(t,e,i,r){let{x1:n,y1:s,x2:l,y2:a}=this;return[t*n+(1-t)*i,e*s+(1-e)*r,t*l+(1-t)*i,e*a+(1-e)*r]}}function pX(t,e,i){let r=!1;if(e&&tQ(e)){for(let n of t)for(let t of n.getSeries(i))if(r=!!e.call(null,t))return r}return r}function pq(t,e){let i=[];for(let r of t)for(let t of r.getSeries(e))i.push(t);return i}let pJ=(t,e)=>{for(let i=0;i<t.length;i++){let r=t[i].getSeries();for(let t=0;t<r.length;t++){let i=r[t];if(e&&i&&i.coordinate===e||!e&&i)return i}}return null},pQ=t=>void 0===t;function p0(t){return"bottom"===t||"top"===t}function p1(t){return"left"===t||"right"===t}function p2(t){return"z"===t}function p3(t,e){return ex(t.orient)||e&&e.includes(t.orient)?t.orient:"left"}function p5(t){return"top"===t||"bottom"===t?"horizontal":"vertical"}function p4(t,e){var i,r;let n=null!=(i=t.type)?i:(r=t.orient,e?p0(r)?"linear":"band":p0(r)?"band":"linear");return{axisType:n,componentName:`${rk.cartesianAxis}-${n}`}}let p6=(t,e,i)=>{var r;let n=null!=(r="band"===e?d5("axisBand",i):["linear","log","symlog"].includes(e)?d5("axisLinear",i):{})?r:{},s=p0(t)?d5("axisX",i):p1(t)?d5("axisY",i):d5("axisZ",i);return ir({},d5("axis",i),n,s)};function p8(t){return t.length>=2&&en(t[0])&&en(ec(t))&&ec(t)>=t[0]}function p9(t,e){var i;let r=ec(e)-e[0],n=ec(e)*e[0]<0,s=e[0]<=0?0-e[0]:0,l=ec(e)>0?ec(e)-0:0;0===r?e[0]<0?(s=1,l=0):e[0]>0&&(s=0,l=1):(s/=r,l/=r);let a=t.getDomainSpec(),o={total:r,negative:s,positive:l,includeZero:n,domain:e,extendable_min:!en(a.min),extendable_max:!en(a.max)};if(null==(i=t._break)?void 0:i.scope){let i,r,n=e.findIndex(t=>t>=0);0===n?(i=t._break.scope[n],r=[e[0],e[1]],o.positive=1,o.negative=0):0>=ec(e)?(o.positive=0,o.negative=1,r=[e[e.length-2],e[e.length-1]]):(i=t._break.scope[n-1],r=[e[n-1],e[n]],o.negative=i[0]+(0-r[0])/(r[1]-r[0])*(i[1]-i[0]),o.positive=1-o.negative),o.break=!0,o.extendable_max=!1,o.extendable_min=!1,o.domain=r}return o}function p7(t,e){let{positive:i,negative:r,extendable_min:n,extendable_max:s,domain:l}=t,{positive:a,negative:o,extendable_min:h,extendable_max:u,domain:d}=e;if(a>0){if(!h)return!1;let t=r/i;s&&(t=r/Math.max(i,a),l[1]=-l[0]/t),d[0]=-d[1]*t}else if(o>0){if(!u)return!1;let t=i/r;n&&(t=i/Math.max(r,r),l[0]=-l[1]/t),d[1]=-d[0]*t}return!0}function gt(t,e){let{extendable_min:i,extendable_max:r,domain:n}=t,{positive:s,negative:l,domain:a}=e;return(0!==s||0!==l)&&!(s>0&&!r)&&!(l>0&&!i)&&(n[0]=a[0],n[1]=a[1],!0)}function ge(t,e){let{positive:i,negative:r,extendable_max:n,domain:s}=t,{positive:l,negative:a,extendable_min:o,domain:h}=e;if(n&&o){let t=Math.max(r,a)/Math.max(i,l);s[1]=-s[0]/t,h[0]=-h[1]*t}else if(o)h[0]=-h[1]*(r/i);else{if(!n)return!1;s[1]=-s[0]/(a/l)}return!0}function gi(t,e){let{extendable_min:i,domain:r}=t,{extendable_max:n,domain:s}=e;return!(!i||!n)&&(r[0]=-r[1],s[1]=-s[0],!0)}let gr=(t,e)=>{var i,r,n,s;let l=t.getScale(),a=e.getScale();if(!l||!a)return;let o=null!=(r=null==(i=t.getDomainAfterSpec)?void 0:i.call(t))?r:[0,1],h=null!=(s=null==(n=e.getDomainAfterSpec)?void 0:n.call(e))?s:[0,1];if(!(o&&h&&p8(o)&&p8(h)))return;let u=p9(t,o),d=p9(e,h);if(!0===u.break&&!0===d.break)return;let{positive:c,negative:p,extendable_min:g,extendable_max:f,includeZero:m}=u,{positive:y,negative:v,extendable_min:b,extendable_max:_,includeZero:x}=d;if(0===c&&0===p){if(!gt(u,d))return}else if(0===y&&0===v){if(!gt(d,u))return}else if(m||x)if(m&&!x){if(!p7(u,d))return}else if(x&&!m){if(!p7(d,u))return}else{if(p===v)return;if(p>v){if(!ge(u,d))return}else if(!ge(d,u))return}else{if(0===p&&0===y){if(!gi(u,d))return}else if(0===v&&0===c&&!gi(d,u))return;if(0===p&&0===v)if(0===o[0]&&h[0]>0){if(!b)return;h[0]=0}else{if(!(0===h[0]&&o[0]>0)||!g)return;o[0]=0}if(0===c&&0===y)if(0===o[1]&&h[1]>0){if(!_)return;h[1]=0}else{if(!(0===h[1]&&o[1]>0)||!f)return;o[1]=0}}l.domain(o),a.domain(h)};var gn=i(5533);let gs=(t,e)=>{var i,r,n,s,l;if(!t)return t;let a=null==(i=null==e?void 0:e.targetAxis)?void 0:i.call(e);if(!a)return t;let o=null==(r=null==e?void 0:e.currentAxis)?void 0:r.call(e);if(!o)return t;let h=null==(n=o.getTickData())?void 0:n.getDataView();if(!h||!h.transformsArr.find(t=>t.type.includes("ticks")))return t;let u=o.getScale();if(!u)return t;let d=null==(l=null==(s=a.getTickData())?void 0:s.getDataView())?void 0:l.latestData;if(!(null==d?void 0:d.length))return t;let c=a.getScale();if(!c)return t;let p=c.domain(),g=ec(p)-p[0];if(0===g)return t;let f=u.domain(),m=ec(f)-f[0];if(0===g)return t;let y=d.map(t=>(function(t,e,i,r,n){let s=dF(t,e),l=Math.max(dI(i),dI(s));return Math.round(s*10**l)/Math.round(i*10**l)*n+r})(t.value,p[0],g,f[0],m));return(0,gn.KV)(y)};class gl{constructor(t){this.id=ey(),this.name=`${t}_${this.id}`}onAdd(t){this.service=t}release(){this.service=null}}class ga extends gl{constructor(){super(ga.type),this.type="AxisSyncPlugin"}_checkEnableSync(t){if(!ls(t.getScale().type))return!1;let e=t.getSpec().sync;return!!(null==e?void 0:e.axisId)&&e}_getTargetAxis(t,e){let i=t.getOption().getChart().getComponentByUserId(e.axisId);return(null==i?void 0:i.type.startsWith("cartesianAxis"))?i:null}onInit(t,e){let i=this._checkEnableSync(e);if(!i||!i.zeroAlign)return;let r=this._getTargetAxis(e,i);r&&e.event.on(rI.scaleDomainUpdate,{filter:({model:t})=>t.id===e.id||t.id===r.id},()=>{gr(r,e)})}onDidCompile(t,e){var i;let r=this._checkEnableSync(e);if(!r)return;let n=this._getTargetAxis(e,r);if(n&&r.tickAlign){nq(e.getOption().dataSet,"tickAlign",gs);let t=null==(i=n.getTickData())?void 0:i.getDataView();t&&t.target.addListener("change",()=>{var t,i;null==(i=null==(t=e.getTickData())?void 0:t.getDataView())||i.reRunAllTransform({skipEqual:!0})}),e.addTransformToTickData({type:"tickAlign",options:{targetAxis:()=>n,currentAxis:()=>e},level:Number.MAX_SAFE_INTEGER},!1)}}}function go(t={}){let e=Object.assign({},t);if(tQ(t.style)?e.style=(e,i,r,n)=>gd(t.style(e,i,r,n)):sD(t.style)||(e.style=gd(t.style)),!sD(t.state)){let i={};Object.keys(t.state).forEach(e=>{tQ(t.state[e])?i[e]=(i,r,n,s)=>gd(t.state[e](i,r,n,s)):sD(t.state[e])||(i[e]=gd(t.state[e]))}),e.state=i}return e}function gh(t){if(sD(t))return null;let e={};return Object.keys(t).forEach(i=>{tQ(t[i])?e[i]=(e,r,n,s)=>gd(t[i](e,r,n,s)):sD(t[i])||(e[i]=gd(t[i]))}),e}function gu(t,e){if(sD(t))return null;let i={};return Object.keys(t).forEach(r=>{tQ(t[r])?i[r]=t[r](e):i[r]=t[r]}),gd(i)}function gd(t){return(null==t?void 0:t.angle)?Object.assign(Object.assign({},t),{angle:af(t.angle)}):t}ga.pluginType="component",ga.type="AxisSyncPlugin";let gc={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}};function gp(t){let e=0;return iW(t,"tick.visible")&&(e+=iW(t,"tick.tickSize")),iW(t,"label.visible")&&(e+=iW(t,"label.space")),e}function gg(t,e){var i,r,n,s,l,a;return{min:null!=(n=null!=(i=t.min)?i:null==(r=t.range)?void 0:r.min)?n:null==e?void 0:e.min,max:null!=(a=null!=(s=t.max)?s:null==(l=t.range)?void 0:l.max)?a:null==e?void 0:e.max}}function gf(t){let e=null==t?void 0:t.orient;return"top"===e||"bottom"===e||"left"===e||"right"===e||"z"===e}let gm=t=>"band"===t||"ordinal"===t||"point"===t;function gy(t,e){return{id:t,label:t,value:e,rawValue:t}}function gv(t,e,i){return i||!t||t.getAxisId()===e.getAxisId()}var gb=i(60981);class g_ extends ud{constructor(t){super(),this.component=t}releaseAll(){super.releaseAll(),this.component=null}}let gx=`${st}_ARC_TRANSFORM_VALUE`,gC=`${st}_ARC_RATIO`,gw=`${st}_ARC_START_ANGLE`,gS=`${st}_ARC_END_ANGLE`,gA=`${st}_ARC_K`,gM=`${st}_ARC_MIDDLE_ANGLE`,gk=`${st}_ARC_QUADRANT`,gT=`${st}_ARC_RADIAN`,gR=-Math.PI/2,gB=3*Math.PI/2,gP=(t,e)=>{var i,r,n,s,l,a;let o=null!=(i=t.type)?i:"angle"===t.orient?"band":"linear",h=`${rk.polarAxis}-${o}`,u=null!=(r=t.startAngle)?r:e.startAngle,d=null!=(n=t.endAngle)?n:e.endAngle;return{axisType:o,componentName:h,startAngle:null!=u?u:-90,endAngle:null!=d?d:t8(u)?u+360:270,center:t8(e.center)?e.center:t8(null==e?void 0:e.centerX)||t8(null==e?void 0:e.centerY)?{x:null==e?void 0:e.centerX,y:null==e?void 0:e.centerY}:void 0,outerRadius:null!=(a=null!=(l=null!=(s=t.outerRadius)?s:t.radius)?l:e.outerRadius)?a:e.radius,layoutRadius:e.layoutRadius}},gE=(t,e,i,r)=>{let n=t();if(tG(n))return n;if(tQ(n))return n(e(),i());let s=e();if("auto"===n&&s.width>0&&s.height>0){let{startAngle:t=0,endAngle:e=2*Math.PI}=r();return function(t,e,i,r){let{x:n,y:s}=e,l=function(t,e){let i=Math.abs(e-t);if(i>=2*Math.PI||2*Math.PI-i<1e-6)return[0,Math.PI/2,Math.PI,1.5*Math.PI];let r=ab(Math.min(t,e)),n=r+i,s=[r,n],l=Math.floor(r/Math.PI)*Math.PI/2;for(;l<n;)l>r&&s.push(l),l+=Math.PI/2;return s}(i,r),{width:a,height:o}=t,h=[];return l.forEach(t=>{let e=Math.sin(t),i=Math.cos(t);1===e?h.push(o-s):-1===e?h.push(s):1===i?h.push(a-n):-1===i?h.push(n):(e>0?h.push(Math.abs((o-s)/e)):h.push(Math.abs(s/e)),i>0?h.push(Math.abs((a-n)/i)):h.push(Math.abs(n/i)))}),Math.min.apply(null,h)}(s,i(),t,e)}return Math.min(s.width/2,s.height/2)},gI=(t,e,i)=>{var r;let n=null!=(r="band"===e?d5("axisBand",i):"linear"===e?d5("axisLinear",i):{})?r:{},s=d5("angle"===t?"axisAngle":"axisRadius",i);return ir({},d5("axis",i),n,s)},gL=(t,e)=>{var i,r;let n,s=ed(null!=(i=e.axes)?i:[]),{bandField:l,linearField:a,xField:o,yField:h,trigger:u,triggerOff:d}=null!=(r=d5(rk.crosshair,t))?r:{},c=s.find(t=>p0(t.orient));n=t8(c)?ir({},gm(c.type)?l:a,o):o;let p=s.find(t=>p1(t.orient));return{xField:n,yField:t8(p)?ir({},ll(p.type)?l:a,h):h,trigger:u,triggerOff:d}},gF=(t,e)=>{var i,r;let n,s=ed(null!=(i=e.axes)?i:[]),{bandField:l,linearField:a,categoryField:o,valueField:h,trigger:u,triggerOff:d}=null!=(r=d5(rk.crosshair,t))?r:{},c=s.find(t=>"angle"===t.orient);n=t8(c)?ir({},gm(c.type)?l:a,o):o;let p=s.find(t=>"radius"===t.orient);return{categoryField:n,valueField:t8(p)?ir({},ll(p.type)?l:a,h):h,trigger:u,triggerOff:d}},gO=(t,e)=>{var i;let r=null!=(i=t.orient)?i:e.orient,n=e[p5(r)],s=ir({},e,n);return delete s.horizontal,delete s.vertical,s};class gD extends sY{getTheme(t,e){var i=this.type,r=this._option.getTheme;switch(i){case rk.cartesianBandAxis:return p6(p3(t,["z"]),"band",r);case rk.cartesianLinearAxis:return p6(p3(t,["z"]),"linear",r);case rk.cartesianLogAxis:return p6(p3(t,["z"]),"log",r);case rk.cartesianSymlogAxis:return p6(p3(t,["z"]),"symlog",r);case rk.cartesianAxis:case rk.cartesianTimeAxis:return p6(p3(t),void 0,r);case rk.polarBandAxis:return gI(t.orient,"band",r);case rk.polarLinearAxis:return gI(t.orient,"linear",r);case rk.polarAxis:return gI(t.orient,void 0,r);case rk.cartesianCrosshair:return gL(r,e);case rk.polarCrosshair:return gF(r,e);case rk.colorLegend:case rk.sizeLegend:case rk.discreteLegend:case rk.dataZoom:case rk.scrollBar:return gO(t,d5(i,r));default:return d5(i,r)}}_mergeThemeToSpec(t,e){let{spec:i,theme:r}=super._mergeThemeToSpec(t,e);return this._adjustPadding(i),{spec:i,theme:r}}_adjustPadding(t){let{padding:e,noOuterPadding:i=!0,orient:r}=t;i&&e&&r&&(t.padding=Object.assign(Object.assign({},ek(e)),{[r]:0}))}}var gH=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class gz extends s2{constructor(){super(...arguments),this.name="component",this.modelType="component",this.transformerConstructor=gD,this._delegateEvent=(t,e,i,r=null,n=null)=>{var s,l;e instanceof gb.A||this.event.emit(i,{model:this,node:t,event:e,item:r,datum:n,source:rL.chart,chart:null==(l=null==(s=this._option)?void 0:s.globalInstance)?void 0:l.getChart()},"model")}}static createComponent(t,e){let{spec:i}=t,r=gH(t,["spec"]);return new this(i,Object.assign(Object.assign({},e),r))}getRegions(){return this._regions}created(){super.created(),this.initLayout(),this.pluginService=new g_(this)}initLayout(){var t;super.initLayout(),this._regions=null!=(t=this._regions)?t:this._option.getRegionsInIndex(),this._layout&&(this._layout.layoutBindRegionID=this._regions.map(t=>null==t?void 0:t.id))}_getNeedClearVRenderComponents(){return[]}getVRenderComponents(){return this._getNeedClearVRenderComponents()}callPlugin(t){this.pluginService&&this.pluginService.getAll().forEach(e=>t(e))}getContainer(){var t;return this._container||(this._container=null==(t=this._option)?void 0:t.globalInstance.getStage().find(t=>"root"===t.name,!0)),this._container}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reMake=["seriesId","seriesIndex","regionId","regionIndex"].some(i=>!t5(null==e?void 0:e[i],t[i]))),(null==e?void 0:e.visible)!==t.visible&&(i.reCompile=!0),i}release(){var t;super.release(),this.clear(),null==(t=this.pluginService)||t.releaseAll(),this.pluginService=null}clear(){var t;let e=this._getNeedClearVRenderComponents();e&&e.length&&e.forEach(t=>{var e;t&&(null==(e=this.getContainer())||e.removeChild(t),t=null)}),this._container=null,null==(t=this.pluginService)||t.clearAll()}compile(){this.compileMarks(),this.reAppendComponents()}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t,context:{model:this}})})}reAppendComponents(){let t=this._getNeedClearVRenderComponents();t&&t.length&&t.forEach(t=>{var e;t&&!t.stage&&(null==(e=this.getContainer())||e.appendChild(t))})}getBoundsInRect(t,e){return{x1:0,x2:0,y1:0,y2:0}}getDatum(t){}}function gW(t,e){if(!t||!t1(t))return t;let i={};return Object.keys(t).forEach(r=>{let n=t[r],s=!1;e.forEach(t=>{(t6(t)&&t===r||t instanceof RegExp&&r.match(t))&&(s=!0)}),s||(i[r]=n)}),i}gz.transformerConstructor=gD,(M=K||(K={})).lineAxis="lineAxis",M.circleAxis="circleAxis",(k=$||($={})).lineAxisGrid="lineAxisGrid",k.circleAxisGrid="circleAxisGrid";class gN extends od{constructor(t,e){super(t,e),this.type="component",this._componentType=e.componentType,this._mode=e.mode}_getDefaultStyle(){return{}}getComponent(){return this._component}clearComponent(){this._component&&(this._component.parent&&this._component.parent.removeChild(this._component),this._component=null)}_getAttrsFromConfig(t={}){let e=super._getAttrsFromConfig(t);return er(this._markConfig.interactive)||(e.pickable=this._markConfig.interactive),t}setAttributeTransform(t){this._attributesTransform=t}renderInner(){var t;let e=null!=(t=this._simpleStyle)?t:this.getAttributesOfState({}),i=this._getAttrsFromConfig(e);this._attributesTransform&&(i=this._attributesTransform(i)),this._animationConfig&&(i=Object.assign(Object.assign({},i),{animation:!0,animationAppear:this._animationConfig.appear?Array.isArray(this._animationConfig.appear)?this._animationConfig.appear[0]:this._animationConfig.appear:void 0,animationEnter:this._animationConfig.enter?Array.isArray(this._animationConfig.enter)?this._animationConfig.enter[0]:this._animationConfig.enter:void 0,animationUpdate:this._animationConfig.update?Array.isArray(this._animationConfig.update)?this._animationConfig.update[0]:this._animationConfig.update:void 0,animationExit:this._animationConfig.exit?Array.isArray(this._animationConfig.exit)?this._animationConfig.exit[0]:this._animationConfig.exit:void 0})),this._component?this._component.setAttributes(i):(this._component=iv.createGraphicComponent(this._componentType,i,{mode:this._mode,skipDefault:this._markConfig.skipTheme}),this._component&&this._product.appendChild(this._component)),this._component&&(this._component.context=this._getCommonContext()),this._markConfig.support3d&&this._product&&this._product.setMode("3d"),this.model.event.emit(rE.AFTER_ELEMENT_ENCODE,{mark:this,model:this.model}),this.needClear=!0}release(){super.release(),this.removeProduct()}}gN.type="component";let gj=()=>{iv.registerMark(gN.type,gN)};var gG=i(171);let gV=t=>t;var gZ=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class gU extends gz{getOrient(){return this._orient}getScale(){return this._scale}getScales(){return this._scales}getTickData(t=0){return this._tickData[t]}get visible(){return this._visible}getInverse(){return this._inverse}getCoordinateType(){return this._coordinateType}constructor(t,e){var i;super(t,e),this.specKey="axes",this._scales=[],this._tickData=[],this._visible=!0,this._tick=void 0,this._onTickDataChange=t=>{this._forceLayout(),null==t||t.updateData()},this._visible=null==(i=t.visible)||i,this._coordinateType="none"}getVRenderComponents(){var t,e;return[null==(t=this._axisMark)?void 0:t.getProduct(),null==(e=this._gridMark)?void 0:e.getProduct()].filter(t8)}created(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v;if(super.created(),this.setSeriesAndRegionsFromSpec(),this.initEvent(),this.initScales(),this.updateSeriesScale(),this._shouldComputeTickData()&&this._initData(),this._visible){let b=this._createMark({type:"component",name:`axis-${this.getOrient()}`},{componentType:"angle"===this.getOrient()?K.circleAxis:K.lineAxis,mode:this._spec.mode},{skipTheme:!0});if(this._updateTickDataMarks(b),this._axisMark=b,b.setMarkConfig({zIndex:this.layoutZIndex}),t8(this._spec.id)&&b.setUserId(this._spec.id),b.setMarkConfig({interactive:null!=(t=this._spec.interactive)?t:this.getDefaultInteractive()}),this._marks.addMark(b),null==(e=this._spec.grid)?void 0:e.visible){let t=this._createMark({type:"component",name:`axis-${this.getOrient()}-grid`},{componentType:"angle"===this.getOrient()?$.circleAxisGrid:$.lineAxisGrid,mode:this._spec.mode},{skipTheme:!0});this._updateTickDataMarks(t),t.setMarkConfig({zIndex:null!=(l=null!=(n=null==(r=null==(i=this._spec.grid)?void 0:i.style)?void 0:r.zIndex)?n:null==(s=this._spec.grid)?void 0:s.zIndex)?l:H.Axis_Grid,interactive:!1}),this._marks.addMark(t),this._gridMark=t}if((null==(a=this._option.globalInstance)?void 0:a.isAnimationEnable())&&!1!==iW(this._option.getChart().getSpec(),"animation")&&!0===this._spec.animation){let t=cA(null==(o=iv.getAnimationInKey("axis"))?void 0:o(),{appear:null!=(u=null!=(h=this._spec.animationAppear)?h:iW(this._option.getChart().getSpec(),"animationAppear.axis"))?u:iW(this._option.getChart().getSpec(),"animationAppear"),disappear:null!=(c=null!=(d=this._spec.animationDisappear)?d:iW(this._option.getChart().getSpec(),"animationDisappear.axis"))?c:iW(this._option.getChart().getSpec(),"animationDisappear"),enter:null!=(g=null!=(p=this._spec.animationEnter)?p:iW(this._option.getChart().getSpec(),"animationEnter.axis"))?g:iW(this._option.getChart().getSpec(),"animationEnter"),exit:null!=(m=null!=(f=this._spec.animationExit)?f:iW(this._option.getChart().getSpec(),"animationExit.axis"))?m:iW(this._option.getChart().getSpec(),"animationExit"),update:null!=(v=null!=(y=this._spec.animationUpdate)?y:iW(this._option.getChart().getSpec(),"animationUpdate.axis"))?v:iW(this._option.getChart().getSpec(),"animationUpdate")});t.enter&&(t.update[0].customParameters={enter:t.enter[0]}),this._marks.forEach(e=>e.setAnimationConfig(t))}}}_shouldComputeTickData(){return this.getVisible()||this._spec.forceInitTick}_initData(){let t=this._initTickDataSet(this._tickTransformOption()),e=new aC(this._option,t);this._tickData=[e],t.target.addListener("change",()=>{this._onTickDataChange(e)})}collectData(t,e){let i=[];return pX(this._regions,r=>{var n;let s=this.collectSeriesField(t,r);if(s=tq(s)?ls(this._scale.type)?s:[s[0]]:[s],t||(this._dataFieldText=r.getFieldAlias(s[0])),s){let t=r.getViewData();if(e)s.forEach(t=>{i.push(r.getRawDataStatisticsByField(t,!1))});else if(t&&t.latestData&&t.latestData.length){let e=null==(n=r.getViewDataStatistics)?void 0:n.call(r),l=this.type===rk.cartesianLinearAxis&&this._spec.breaks&&this._spec.breaks.length;s.forEach(r=>{var n;(null==(n=null==e?void 0:e.latestData)?void 0:n[r])&&(l?i.push(Object.assign(Object.assign({},e.latestData[r]),{values:t.latestData.map(t=>t[r])})):i.push(e.latestData[r]))})}}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),i}isSeriesDataEnable(){let t=!0;return pX(this._regions,e=>{var i;tq(null==(i=e.getViewDataStatistics())?void 0:i.latestData)&&(t=!1)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),t}setSeriesAndRegionsFromSpec(){let{seriesId:t,seriesIndex:e,regionId:i,regionIndex:r}=this._spec;t8(t)&&(this._seriesUserId=ed(t)),t8(i)&&(this._regionUserId=ed(i)),t8(e)&&(this._seriesIndex=ed(e)),t8(r)&&(this._regionIndex=ed(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionIndex),this.layout.layoutBindRegionID=this._regions.map(t=>t.id)}getBindSeriesFilter(){return{userId:this._seriesUserId,specIndex:this._seriesIndex}}initEvent(){this.event.on(rI.scaleUpdate,{filter:({model:t})=>(null==t?void 0:t.id)===this.id},this.effect.scaleUpdate.bind(this));let t=pq(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}).map(t=>t.getViewDataStatistics()).filter(t=>!!t);t.length>1?this._option.dataSet.multipleDataViewAddListener(t,"change",()=>{this.updateScaleDomain()}):1===t.length&&t[0].target.addListener("change",()=>{this.updateScaleDomain()}),pX(this._regions,t=>{t.event.on(rI.rawDataUpdate,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>{this._clearRawDomain()})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}updateScaleDomain(){}_clearRawDomain(){}onLayoutEnd(){this.updateScaleRange(),this.event.emit(rI.scaleUpdate,{model:this,value:"range"}),super.onLayoutEnd()}computeData(t){"force"!==t||this._tickData&&this._tickData.length?!this._tickData||!this._tickData.length||"force"!==t&&t5(this._scale.range(),[0,1])||this._tickData.forEach(t=>{t.getDataView().reRunAllTransform({skipEqual:!0})}):pX(this._regions,t=>{var e;null==(e=t.getViewData())||e.reRunAllTransform()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_updateTickDataMarks(t){this._tickData&&this._tickData.forEach(e=>{e.addRelatedMark(t)})}initScales(){this._scales=[this._scale];let t=[];if(pX(this._regions,e=>{let i=e.getGroups();i&&t.push(i)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),0!==t.length){let e=ep(t.map(t=>t.fields.length));for(let t=1;t<e;t++){let t=this._scale.clone();this._scales.push(t)}}}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reRender=!0,(null==e?void 0:e.type)!==(null==t?void 0:t.type)||(null==e?void 0:e.visible)!==(null==t?void 0:t.visible)?i.reMake=!0:i.reMake=["grid","subGrid","tick","subTick","label","domainLine","title"].some(i=>{var r,n;return(null==(r=null==e?void 0:e[i])?void 0:r.visible)!==(null==(n=null==t?void 0:t[i])?void 0:n.visible)})),i}_getAxisAttributes(){var t;let e=this._spec,i={orient:this.getOrient(),select:!0!==this._option.disableTriggerEvent&&e.select,hover:!0!==this._option.disableTriggerEvent&&e.hover};if((e.domainLine&&e.domainLine.visible?((t=go(t=e.domainLine)).startSymbol=go(t.startSymbol),t.endSymbol=go(t.endSymbol),i.line=t):i.line={visible:!1},e.label&&e.label.visible)?(i.label=gW(e.label,["style","formatMethod","state"]),e.label.style&&(i.label.style=tQ(e.label.style)?(t,i,r,n)=>{var s;let l=e.label.style(t.rawValue,i,t,r,n);return gd(ir({},null==(s=this._theme.label)?void 0:s.style,l))}:gd(e.label.style)),(e.label.formatMethod||e.label.formatter)&&(i.label.formatMethod=this._getLabelFormatMethod()),e.label.state&&(i.label.state=function(t){if(sD(t))return null;let e={};return Object.keys(t).forEach(i=>{tQ(t[i])?e[i]=(e,r,n,s)=>gd(t[i](e.rawValue,r,e,n,s)):sD(t[i])||(e[i]=gd(t[i]))}),e}(e.label.state)),tQ(e.label.dataFilter)&&(i.label.dataFilter=(t,i)=>e.label.dataFilter(t,i,{vchart:this._option.globalInstance}))):i.label={visible:!1},e.tick&&e.tick.visible?(i.tick={visible:e.tick.visible,length:e.tick.tickSize,inside:e.tick.inside,alignWithLabel:e.tick.alignWithLabel,dataFilter:tQ(e.tick.dataFilter)?t=>e.tick.dataFilter(t,{vchart:this._option.globalInstance}):void 0},e.tick.style&&(i.tick.style=tQ(e.tick.style)?(t,i,r,n)=>{var s;let l=e.tick.style(t,i,r,n);return gd(ir({},null==(s=this._theme.tick)?void 0:s.style,l))}:gd(e.tick.style)),e.tick.state&&(i.tick.state=gh(e.tick.state))):i.tick={visible:!1},e.subTick&&e.subTick.visible?(i.subTick={visible:e.subTick.visible,length:e.subTick.tickSize,inside:e.subTick.inside,count:e.subTick.tickCount},e.subTick.style&&(i.subTick.style=tQ(e.subTick.style)?(t,i,r,n)=>{var s;let l=e.subTick.style(t,i,r,n);return gd(ir({},null==(s=this._theme.subTick)?void 0:s.style,l))}:gd(e.subTick.style)),e.subTick.state&&(i.subTick.state=gh(e.subTick.state))):i.subTick={visible:!1},e.title&&e.title.visible){let t=e.title,{autoRotate:r,angle:n,style:s={},background:l,state:a,shape:o}=t,h=gZ(t,["autoRotate","angle","style","background","state","shape"]),u,d=n;"left"!==e.orient&&"right"!==e.orient||r&&er(d)&&(d="left"===e.orient?-90:90,u=gc[e.orient]),i.title=Object.assign(Object.assign({},h),{autoRotate:!1,angle:d?af(d):null,textStyle:ir({},u,gd(s)),pickable:!1!==s.pickable,childrenPickable:!1!==s.pickable,state:{}}),o&&o.visible?(i.title.shape=Object.assign(Object.assign({},o),{style:gd(o.style)}),o.state&&(i.title.state.shape=gh(o.state))):i.title.shape={visible:!1},l&&l.visible?(i.title.background=Object.assign(Object.assign({},l),{style:gd(l.style)}),l.state&&(i.title.state.background=gh(l.state))):i.title.background={visible:!1},a&&(i.title.state.text=gh(a))}else i.title={visible:!1};return e.background&&e.background.visible?(i.panel={visible:!0},e.background.style&&(i.panel.style=gd(e.background.style)),e.background.state&&(i.panel.state=gh(e.background.state))):i.panel={visible:!1},i}_getGridAttributes(){let t=this._spec;return{alternateColor:t.grid.alternateColor,alignWithLabel:t.grid.alignWithLabel,style:tQ(t.grid.style)?(e,i)=>{var r,n;let s=t.grid.style(null==(r=e.datum)?void 0:r.rawValue,i,e.datum);return gd(ir({},null==(n=this._theme.grid)?void 0:n.style,s))}:gd(t.grid.style),subGrid:!1===t.subGrid.visible?{visible:!1}:{type:"line",visible:t.subGrid.visible,alternateColor:t.subGrid.alternateColor,style:gd(t.subGrid.style)}}}_getLabelFormatMethod(){let{formatMethod:t,formatter:e}=this._spec.label,{formatFunc:i}=d4(t,e);return i?(t,r,n)=>i(r.rawValue,r,e):null}_initTickDataSet(t,e=0){nJ(this._option.dataSet,"scale",gV);let i=this.registerTicksTransform();return new el(this._option.dataSet,{name:`${this.type}_${this.id}_ticks_${e}`}).parse(this._scales[e],{type:"scale"}).transform({type:i,options:t},!1)}_tickTransformOption(){let t=this._tick||{},e=this._spec.label||{},{tickCount:i,forceTickCount:r,tickStep:n,tickMode:s}=t,{style:l,formatMethod:a,minGap:o}=e;return{sampling:!1!==this._spec.sampling,tickCount:i,forceTickCount:r,tickStep:n,tickMode:s,axisOrientType:this._orient,coordinateType:this._coordinateType,labelStyle:l,labelFormatter:a,labelGap:o}}addTransformToTickData(t,e){this._tickData.forEach(i=>{var r;null==(r=null==i?void 0:i.getDataView())||r.transform(t,e)})}dataToPosition(t){return this._scale.scale(t)}getDatum(t){var e;return t&&t.name===gG.X9.label?t.data:this._axisMark?null==(e=this._axisMark.getComponent())?void 0:e.attribute.items:void 0}scaleRangeFactor(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactor(t,e,i)}scaleRangeFactorEnd(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorEnd(t,e)}scaleRangeFactorStart(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorStart(t,e)}}gU.specKey="axes";let gK=()=>{gj(),iv.registerAnimation("axis",()=>({appear:{type:"fadeIn"},enter:{type:"fadeIn"},update:{type:"update"},exit:{type:"fadeOut"}}))};var g$=i(64103);let gY=t=>{let{x:e,y:i}=t[0].getLayoutStartPoint(),r=e+t[0].getLayoutRect().width,n=i+t[0].getLayoutRect().height;for(let s=1;s<t.length;s++){let l=t[s],{x:a,y:o}=l.getLayoutStartPoint(),{width:h,height:u}=l.getLayoutRect();e=Math.min(e,a),r=Math.max(r,h+a),i=Math.min(i,o),n=Math.max(n,u+o)}return{width:Math.abs(r-e),height:Math.abs(n-i)}};var gX=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let gq=[ga];class gJ extends gU{getOrient(){return this._orient}getDefaultInteractive(){return!0}set autoIndentOnce(t){this._autoIndentOnce=t}getScales(){return this._scales}constructor(t,e){super(t,e),this.type=rk.cartesianAxis,this.name=rk.cartesianAxis,this._defaultBandPosition=.5,this._defaultBandInnerPadding=.1,this._defaultBandOuterPadding=.3,this.layoutType="region-relative",this.layoutZIndex=H.Axis,this.layoutLevel=z.Axis,this._orient="left",this._autoIndentOnce=!1,this._hasAutoIndent=!1,this._scales=[],this._tick=void 0,this._layoutCache={width:0,height:0,_lastComputeOutBounds:{x1:0,x2:0,y1:0,y2:0}},this._innerOffset={top:0,bottom:0,left:0,right:0},this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),pX(this._regions,t=>{let e=this.getOrient();p0(e)?gv(t.getXAxisHelper(),this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&t.setXAxisHelper(this.axisHelper()):p1(e)?gv(t.getYAxisHelper(),this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&t.setYAxisHelper(this.axisHelper()):p2(e)&&gv(t.getZAxisHelper(),this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&t.setZAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=t=>{let{x:e,y:i}=t;return en(e)&&(e+=Number("left"===this._orient)*this.getLayoutRect().width),en(i)&&(i+=Number("top"===this._orient)*this.getLayoutRect().height),{x:e,y:i}},this._transformLayoutRect=t=>{if(!this._visible)return t;let e=this._latestBounds.clone().translate(-this.getLayoutStartPoint().x,-this.getLayoutStartPoint().y);switch(this._layout.layoutOrient){case"left":this._layout.layoutRectLevelMap.width===sZ&&(t.width=e.x1<0?-e.x1:0);break;case"right":this._layout.layoutRectLevelMap.width===sZ&&(t.width=e.x2>0?e.x2:0);break;case"top":this._layout.layoutRectLevelMap.height===sZ&&(t.height=e.y1<0?-e.y1:0);break;case"bottom":this._layout.layoutRectLevelMap.height===sZ&&(t.height=e.y2>0?e.y2:0)}return t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),this._layout.setRectInSpec(this._layoutCacheProcessing(t))},this._transformLayoutPadding=t=>("left"===this.layoutOrient||"right"===this.layoutOrient?(t.top=0,t.bottom=0):"top"!==this.layoutOrient&&"bottom"!==this.layoutOrient||(t.left=0,t.right=0),t),this._updateAxisLayout=()=>{let t=this.getLayoutStartPoint(),e=this._getUpdateAttribute(!1),{grid:i}=e,r=gX(e,["grid"]),n=ir({x:t.x,y:t.y},this._axisStyle,r);this._axisMark.setSimpleStyle(n),this._gridMark&&this._gridMark.setSimpleStyle(ir({x:t.x,y:t.y},this._getGridAttributes(),i))},this._fixAxisOnZero=()=>{let{onZero:t,visible:e}=this._spec.domainLine;if(this.visible&&t&&!1!==e){let{onZeroAxisId:t,onZeroAxisIndex:e}=this._spec.domainLine,i=this._option.getComponentsByKey("axes"),r=p0(this.getOrient()),n=t=>{var e;return(r?!p0(t.getOrient()):p0(t.getOrient()))&&ls(t.getScale().type)&&(t.getTickData()?null==(e=t.getTickData().getLatestData())?void 0:e.find(t=>0===t.value):t.getScale().domain()[0]<=0&&ec(t.getScale().domain())>=0)},s=i.filter(t=>n(t));if(s.length){let l;if(t8(t))l=s.find(e=>e.id===t);else if(t8(e)){let t=i[e];n(t)&&(l=t)}else l=s[0];if(l){let t=this._axisMark,e=l.valueToPosition(0);r?t.setSimpleStyle(Object.assign(Object.assign({},t.getSimpleStyle()),{line:Object.assign(Object.assign({},this._axisStyle.line),{dy:"bottom"===this._orient?-((l.getInverse()?l.getScale().range()[1]:l.getScale().range()[0])-e):e})})):t.setSimpleStyle(Object.assign(Object.assign({},t.getSimpleStyle()),{line:Object.assign(Object.assign({},this._axisStyle.line),{dx:"left"===this._orient?e:-((l.getInverse()?l.getScale().range()[0]:l.getScale().range()[1])-e)})}))}}}},this._orient=p3(t,["z"]),p2(this._orient)&&(this.layoutType="absolute"),this._dataSet=e.dataSet,this._coordinateType="cartesian"}static getSpecInfo(t){let e=t[this.specKey];if(!e)return null;let i="horizontal"===t.direction;if(!tq(e)){if(!gf(e))return null;let{axisType:t,componentName:r}=p4(e,i);return e.type=t,[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:r}]}let r=!0;if(e.filter(t=>"z"===t.orient)[0]){let t=e.filter(t=>"bottom"===t.orient)[0],i=e.filter(t=>p1(t.orient))[0];r=3===e.length&&t&&i}let n=e.map((t,e)=>({spec:t,index:e}));r||(n=n.filter(({spec:t})=>"z"!==t.orient));let s=[];return n.forEach(({spec:t,index:e})=>{if(!gf(t))return;let{axisType:r,componentName:n}=p4(t,i);t.type=r,s.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:n})}),s}static createComponent(t,e){let{spec:i}=t,r=gX(t,["spec"]),n=iv.getComponentInKey(r.type);return n?new n(i,Object.assign(Object.assign({},e),r)):(e.onError(`Component ${r.type} not found`),null)}initLayout(){super.initLayout(),this._layout.autoIndent=!1!==this._spec.autoIndent,this._layout.layoutOrient=this._orient}getNewScaleRange(){let{width:t,height:e}=this.getLayoutRect(),{left:i,right:r,top:n,bottom:s}=this._innerOffset,l=[];return p0(this.getOrient())?en(t)&&(l=this._inverse?[t-r,i]:[i,t-r]):p2(this.getOrient())?en(t)&&(l=this._inverse?[t-r,i]:[i,t-r],this._scale.range(l)):en(e)&&(l=this._inverse?[n,e-s]:[e-s,n]),l}updateScaleRange(){let t=!1,e=this.getNewScaleRange(),i=this._scale.range();return e.length===i.length&&e.every((t,e)=>t===i[e])?t=!1:(t=!0,this._scale.range(e)),t}init(t){var e;super.init(t),null==(e=this.pluginService)||e.load(gq.map(t=>new t)),this.callPlugin(t=>{this.pluginService&&t.onInit&&t.onInit(this.pluginService,this)})}setAttrFromSpec(){var t,e,i;let r;if(super.setAttrFromSpec(),this.visible){p0(this.getOrient())?pQ(this._spec.maxHeight)&&(this._spec.maxHeight="30%"):pQ(this._spec.maxWidth)&&(this._spec.maxWidth="30%");let t=this._getAxisAttributes();t.label.formatMethod=this._getLabelFormatMethod(),t.verticalFactor="top"===this.getOrient()||"right"===this.getOrient()?-1:1,this._axisStyle=t}this._tick=this._spec.tick;let n=null==(t=this._option.getChart())?void 0:t.getSpec();this._inverse=(e=this._spec,i="horizontal"===(null==n?void 0:n.direction),r=e.inverse,i&&!p0(e.orient)&&(r=!t8(e.inverse)||!e.inverse),r)}onLayoutStart(t,e){if(super.onLayoutStart(t,e),!p2(this.getOrient())&&this._spec.innerOffset){let t=this._spec;p1(this.getOrient())?["top","bottom"].forEach(i=>{this._innerOffset[i]=eS(t.innerOffset[i],e.height,e)}):["left","right"].forEach(i=>{this._innerOffset[i]=eS(t.innerOffset[i],e.width,e)})}}getSeriesStatisticsField(t){let e;return e=p0(this.getOrient())?t.fieldX:p2(this.getOrient())?t.fieldZ:t.fieldY,ls(this._scale.type)?e:[e[0]]}_tickTransformOption(){var t,e,i,r;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimals:null==(t=this._tick)?void 0:t.noDecimals,labelLastVisible:null==(e=this._spec.label)?void 0:e.lastVisible,labelFirstVisible:null==(i=this._spec.label)?void 0:i.firstVisible,labelFlush:null==(r=this._spec.label)?void 0:r.flush})}axisHelper(){return{isContinuous:ls(this._scale.type),dataToPosition:this.dataToPosition.bind(this),getScale:(t=0)=>this._scales[t],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!0===this._inverse,getSpec:()=>this._spec}}afterCompile(){var t;(null==(t=this._axisMark)?void 0:t.getProduct())&&this.event.on(rE.AFTER_ELEMENT_ENCODE,({mark:t})=>{if(t===this._axisMark&&!1===this._isLayout&&(p0(this.getOrient())?this.callPlugin(t=>{this.pluginService&&t.onDidLayoutHorizontal&&t.onDidLayoutHorizontal(this.pluginService,this)}):this.callPlugin(t=>{this.pluginService&&t.onDidLayoutVertical&&t.onDidLayoutVertical(this.pluginService,this)}),this._unitText)){let{x:t,y:e}=this.getLayoutStartPoint(),i=p0(this._orient)?{x:ep(this._scale.range())+t,y:e}:{x:t,y:eg(this._scale.range())+e};this._unitText.setAttributes(i)}}),this.callPlugin(t=>{this.pluginService&&t.onDidCompile&&t.onDidCompile(this.pluginService,this)})}collectScale(){let t=[];return pX(this._regions,e=>{t.push("left"===this.getOrient()||"right"===this.getOrient()?e.scaleY:e.scaleX)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),t}collectSeriesField(t,e){var i,r;return t>0?null==(r=null==(i=e.getGroups())?void 0:i.fields)?void 0:r[t]:p0(this.getOrient())?e.getSpec().x2Field?[...e.fieldX,e.fieldX2]:e.fieldX:p2(this.getOrient())?e.fieldZ:e.getSpec().y2Field?[...e.fieldY,e.fieldY2]:e.fieldY}updateSeriesScale(){let t=this.getOrient();pX(this._regions,e=>{p0(t)?gv(e.getXAxisHelper(),this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&(e.setScaleX(this._scale),e.setXAxisHelper(this.axisHelper())):p1(t)?gv(e.getYAxisHelper(),this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&(e.setScaleY(this._scale),e.setYAxisHelper(this.axisHelper())):p2(t)&&gv(e.getZAxisHelper(),this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&(e.setScaleZ(this._scale),e.setZAxisHelper(this.axisHelper()))},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getBoundsInRect(t){var e;let i={x1:0,y1:0,x2:0,y2:0};if(!this._visible)return i;this._verticalLimitSize=p0(this.getOrient())?t.height:t.width,this.setLayoutRect(t),!this.updateScaleRange()&&tq(null==(e=this.getTickData())?void 0:e.getLatestData())||this.computeData("range");let r={skipLayout:!1},n=p0(this.getOrient());this.pluginService&&(n?this.callPlugin(t=>{t.onWillLayoutHorizontal&&t.onWillLayoutHorizontal(this.pluginService,r,this)}):this.callPlugin(t=>{t.onWillLayoutVertical&&t.onWillLayoutVertical(this.pluginService,r,this)}));let s=this._axisMark.getProduct(),l=!1;if(!r.skipLayout){let t=this._getUpdateAttribute(!0),e=this._axisMark.getComponent(),r=ir(Object.assign({},this.getLayoutStartPoint()),this._axisStyle,t,{line:{visible:!1}}),s=null==e?void 0:e.getBoundsWithoutRender(r);s&&!s.empty()||(s=(new pY).set(r.x,r.y,r.x,r.y)),l=!0,this._latestBounds=s,i=this._appendAxisUnit(s,n)}return l||(this._latestBounds=s.AABBBounds),i}positionToData(t,e){let i=p0(this.getOrient());e&&(t-=i?this.getLayoutStartPoint().x:this.getLayoutStartPoint().y),this._innerOffset&&(t=i?eG(t,this._innerOffset.left,this.getLayoutRect().width-this._innerOffset.right):eG(t,this._innerOffset.top,this.getLayoutRect().height-this._innerOffset.bottom));let r=this._scale.range();return(t-r[0])*(t-ec(r))>0?null:this._scale.invert(t)}_getTitleLimit(t){var e,i,r,n,s;let l=this._spec.title;if(l.visible&&er(null==(e=l.style)?void 0:e.maxLineWidth)){let e=null!=(s=null!=(r=null==(i=this._axisStyle.title)?void 0:i.angle)?r:null==(n=l.style)?void 0:n.angle)?s:0;if(t){let t=this.getLayoutRect().width,i=Math.abs(Math.cos(e));return i<1e-6?1/0:t/i}let a=this.getLayoutRect().height,o=Math.abs(Math.sin(e));return o<1e-6?1/0:a/o}return null}_getUpdateAttribute(t){let e=0,i=0;if(!t){let t=gY(this.getRegions());i=t.width,e=t.height}let{width:r,height:n}=this.getLayoutRect(),s=p0(this._orient),l=p1(this._orient),a={x:0,y:0},o=e,h=r;s?a={x:r,y:0}:l&&(a={x:0,y:n},o=i,h=n);let u=this.getLabelItems(h),d={start:{x:0,y:0},end:a,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(s)},items:u,scale:this._scale.clone()};t||(d.grid={type:"line",start:{x:0,y:0},end:a,items:u[0],verticalFactor:this._axisStyle.verticalFactor,length:o});let c=s?this.layout.minHeight:this.layout.minWidth;return(s&&this._layout.layoutRectLevelMap.height===sV||l&&this._layout.layoutRectLevelMap.width===sV)&&(c=this._verticalLimitSize),d.verticalLimitSize=this._verticalLimitSize,d.verticalMinSize=c,d.label={overflowLimitLength:this._getLabelOverflowLimit(s)},this._afterUpdateAttribute?this._afterUpdateAttribute(d,t):d}getLabelItems(t){var e;let i=null==(e=this.getTickData())?void 0:e.getLatestData();return i&&i.length?[i.map(e=>{let i=this._getNormalizedValue([e.value],t);return gy(e.value,i)}).filter(t=>{let{value:e,rawValue:i}=t,r=this._scale.domain();return"log"===this.getSpec().type?e>=0&&e<=1:ls(this._scale.type)?i>=r[0]&&i<=ec(r):r.includes(i)})]:[]}initEvent(){super.initEvent(),this.visible&&(this.event.on(rI.layoutEnd,this._updateAxisLayout),this.event.on(rI.layoutEnd,this._fixAxisOnZero),this.event.on(rI.layoutRectUpdate,()=>{this._clearLayoutCache()}))}_getNormalizedValue(t,e){return 0===e?0:this.dataToPosition(t)/e}_layoutCacheProcessing(t){return["width","height"].forEach(e=>{t[e]<this._layoutCache[e]?t[e]=this._layoutCache[e]:this._layoutCache[e]=t[e]}),this._autoIndentOnce&&this._hasAutoIndent?["x1","x2","y1","y2"].forEach(t=>{this.layout.getLastComputeOutBounds()[t]=this._layoutCache._lastComputeOutBounds[t]}):(this._hasAutoIndent=!0,["x1","x2","y1","y2"].forEach(t=>{this.layout.getLastComputeOutBounds()[t]<this._layoutCache._lastComputeOutBounds[t]?this.layout.getLastComputeOutBounds()[t]=this._layoutCache._lastComputeOutBounds[t]:this._layoutCache._lastComputeOutBounds[t]=this.layout.getLastComputeOutBounds()[t]})),t}reInit(t){super.reInit(t),this._clearLayoutCache()}_clearLayoutCache(){this._hasAutoIndent=!1,this._layoutCache.width=0,this._layoutCache.height=0,this._layoutCache._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0}}onDataUpdate(){this._clearLayoutCache()}_appendAxisUnit(t,e){var i;if(this._spec.unit&&this._spec.unit.visible){let r,n,{text:s,style:l}=this._spec.unit,{x:a,y:o}=this.getLayoutStartPoint();e?(r={x:ep(this._scale.range())+a,y:o},n={textAlign:"left",textBaseline:"middle"}):(r={x:a,y:eg(this._scale.range())+o},n={textAlign:"left"===this._orient?"left":"right",textBaseline:"bottom"}),n=Object.assign(Object.assign(Object.assign({},n),l),{x:r.x,y:r.y,text:s}),this._unitText?this._unitText.setAttributes(n):(this._unitText=(0,g$.r)(n),this._unitText.name="axis-unit",null==(i=this.getContainer())||i.add(this._unitText));let h=this._unitText.AABBBounds;e?(t.x2+=h.x2>t.x2?h.x2-t.x2:0,t.y2+=h.y2>t.y2?h.y2-t.y2:0):(t.x1+=h.x1<t.x1?h.x1-t.x1:0,t.y1+=h.y1<t.y1?h.y1-t.y1:0)}return t}_getNeedClearVRenderComponents(){return this._unitText?[this._unitText]:[]}_getLabelOverflowLimit(t){var e,i;if(t&&!1!==(null==(e=this._spec.label)?void 0:e.visible)&&!0===(null==(i=this._spec.label)?void 0:i.autoLimit)){let t=this._option.getComponentsByKey("axes"),e=this.getRegions(),i=t.filter(t=>{let i=t.getOrient();return("left"===i||"right"===i)&&t.getRegions().some(t=>e.includes(t))}),r=0,n=0,s=this.getLayoutStartPoint().x,l=s+this.getLayoutRect().width;return i.forEach(t=>{let e=t.getLayoutStartPoint().x;if("left"===t.getOrient()&&e===s){let e=t.getLayoutRect().width;r=Math.max(r,e)}else if(e===l){let e=t.getLayoutRect().width;n=Math.max(n,e)}}),{left:r,right:n}}}}gJ.type=rk.cartesianAxis,gJ.specKey="axes";class gQ{constructor(){this._rawDomainIndex=[]}_initData(){var t;if(this._spec.showAllGroupLayers&&this._scales.length>1)for(let e=0;e<this._scales.length;e++){let i=(null!=(t=this._spec.layers)?t:[])[this._scales.length-1-e]||{};if(!1!==i.visible&&0!==i.tickCount&&0!==i.forceTickCount){let t=this._initTickDataSet(Object.assign(Object.assign({},this._tickTransformOption()),i),e),r=new aC(this._option,t);this._tickData.push(r),t.target.addListener("change",()=>{this._onTickDataChange(r)}),this._tickDataMap||(this._tickDataMap={}),this._tickDataMap[e]=r}}else{let t=this._initTickDataSet(this._tickTransformOption()),e=new aC(this._option,t);t.target.addListener("change",()=>{this._onTickDataChange(e)}),this._tickData=[e],this._tickDataMap={0:e}}}_updateData(){var t,e,i;let r=this.registerTicksTransform();if(this._spec.showAllGroupLayers&&this._scales.length>1){let e=null!=(t=this._spec.layers)?t:[];Object.keys(this._tickDataMap).forEach(t=>{let i=e[this._scales.length-1-t]||{},n=this._tickDataMap[t],s=null==n?void 0:n.getDataView().transformsArr.find(t=>t.type===r);s&&(s.options=Object.assign(Object.assign({},this._tickTransformOption()),i))})}else{let t=null==(i=null==(e=this._tickData)?void 0:e[0])?void 0:i.getDataView().transformsArr.find(t=>t.type===r);t&&(t.options=this._tickTransformOption())}}dataToPosition(t,e={}){var i,r;if(0===t.length||0===this._scales.length)return 0;let{position:n,bandScale:s}=this.getPosition(t);return n+s.bandwidth()*(null!=(r=null!=(i=e.bandPosition)?i:this._spec.bandPosition)?r:this._defaultBandPosition)}valueToPosition(t){return this._scale.scale(t)}updateGroupScaleRange(){let t=this._scale;this._scales.forEach((e,i)=>{i>0&&(e.range([0,t.bandwidth()]),t=e)})}getPosition(t){let e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{let r=Math.min(t.length,this._scales.length);for(let i=0;i<r;i++)e+=this._scales[i].scale(t[i]);i=this._scales[r-1]}return{position:e,bandScale:i}}calcScales(t,e){var i,r;let{bandPadding:n,paddingInner:s,paddingOuter:l}=this._spec,a=tq(n),o=tq(s),h=tq(l);for(let u=0;u<this._scales.length;u++){let d=a?n[u]:n,c=o?s[u]:s,p=h?l[u]:l;this._scales[u].paddingInner(null!=(i=null!=c?c:d)?i:t,!0).paddingOuter(null!=(r=null!=p?p:d)?r:e,!0)}}computeBandDomain(t){if(!t.length)return[];if(1===t.length)return t[0].values;let e=new Set;for(let i=0;i<t.length;i++)for(let r=0;r<t[i].values.length;r++)e.add(t[i].values[r]);return Array.from(e)}updateScaleDomain(){var t;if(!this.isSeriesDataEnable())return;(null==(t=this._rawDomainIndex)?void 0:t.length)||!this._scales.length||this._updateRawDomain();let e=this._spec.domain;for(let t=0;t<this._scales.length;t++)if(e&&e.length&&0===t)this._scales[t].domain(e);else{let e=this.collectData(t),i=this.computeBandDomain(e);this._scales[t].domain(i.sort((e,i)=>this._rawDomainIndex[t][e]-this._rawDomainIndex[t][i]))}this.transformScaleDomain(),this.event.emit(rI.scaleDomainUpdate,{model:this}),this.event.emit(rI.scaleUpdate,{model:this,value:"domain"})}getLabelItems(t){let e=[],i=[];return(this._spec.showAllGroupLayers?this._scales:[this._scales[0]]).forEach((r,n)=>{var s;let l=this._tickDataMap[n],a=null==(s=null==l?void 0:l.getLatestData())?void 0:s.length,o=a?l.getLatestData().map(t=>t.value):r.domain();if(o&&o.length)if(i&&i.length){let r=[],n=[];i.forEach(e=>{o.forEach(i=>{let s=ed(e).concat(i);if(n.push(s),a){let e=gy(i,this._getNormalizedValue(s,t));r.push(e)}})}),a&&e.push(r.filter(t=>t.value>=0&&t.value<=1)),i=n}else o.forEach(t=>{i.push(t)}),a&&e.push(l.getLatestData().map(e=>gy(e.value,this._getNormalizedValue([e.value],t))).filter(t=>t.value>=0&&t.value<=1))}),e.reverse()}_updateRawDomain(){this._rawDomainIndex=[];let t=this._spec.domain;for(let e=0;e<this._scales.length;e++)if(t&&t.length&&0===e)this._scales[e].domain(t);else{let t=this.collectData(e,!0),i=this.computeBandDomain(t);this._rawDomainIndex[e]={},i.forEach((t,i)=>this._rawDomainIndex[e][t]=i)}}_clearRawDomain(){this._rawDomainIndex=[]}}var g0=i(94051),g1=i(87986),g2=i(88504),g3=i(74562),g5=i(3496);function g4(t,e,i,r){let n="";if(!t||0===e.length)return n;let s=e[0],l=uL.HL.distancePP(t,s),a=+!i;return r?n+=`M${t.x},${t.y-l}A${l},${l},0,0,${a},${t.x},${t.y+l}A${l},${l},0,0,${a},${t.x},${t.y-l}Z`:e.forEach((t,e)=>{0===e?n=`M${t.x},${t.y}`:n+=`A${l},${l},0,0,${a},${t.x},${t.y}`}),n}class g6 extends g3.k{constructor(){super(...arguments),this.name="axis-grid",this.data=[]}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}render(){this._prevInnerView=this._innerView&&(0,g5.uX)(this._innerView),this.removeAllChild(!0),this._innerView=c0.i.group({x:0,y:0,pickable:!1}),this.add(this._innerView);let{items:t,visible:e}=this.attribute;t&&t.length&&!1!==e&&(this.data=this._transformItems(t),this._renderGrid(this._innerView))}getVerticalCoord(t,e,i){return(0,g5.cN)(t,this.getVerticalVector(e,i,t))}_transformItems(t){let e=[];return t.forEach(t=>{var i;e.push(Object.assign(Object.assign({},t),{point:this.getTickCoord(t.value),id:null!=(i=t.id)?i:t.label}))}),e}_renderGrid(t){let{visible:e}=this.attribute.subGrid||{};e&&this._renderGridByType(!0,t),this._renderGridByType(!1,t)}_renderGridByType(t,e){let i=(0,cQ.Z)({},this.attribute,this.getGridAttribute(t)),{type:r,items:n,style:s,closed:l,alternateColor:a,depth:o=0}=i,h=t?`${gG.X9.grid}-sub`:`${gG.X9.grid}`;if(n.forEach((t,i)=>{let{id:n,points:a}=t,u="";if("line"===r||"polygon"===r)u=(0,g5.st)(a,!!l);else if("circle"===r){let{center:t}=this.attribute;u=g4(t,a,!1,!!l)}let d=c0.i.path(Object.assign({path:u,z:o},(0,uy.Z)(s)?(0,cQ.Z)({},this.skipDefault?null:g6.defaultAttributes.style,s(t,i)):s));d.name=`${h}-line`,d.id=this._getNodeId(`${h}-path-${n}`),e.add(d)}),o&&"line"===r&&n.forEach((t,i)=>{let{id:r,points:n}=t,a=[];a.push(n[0]);let u=n[1].x-n[0].x,d=n[1].y-n[0].y,c=o/Math.sqrt(u*u+d*d);a.push({x:n[0].x+u*c,y:n[0].y+d*c});let p=(0,g5.st)(a,!!l),g=(0,g2.Wn)(a[0].x-a[1].x),f=(0,g2.Wn)(a[0].y-a[1].y),m=c0.i.path(Object.assign({path:p,z:0,alpha:g>f?(n[1].x-n[0].x>0?-1:1)*g2.pi/2:0,beta:g<f?-g2.pi/2:0,anchor3d:g>f?[a[0].x,0]:[0,a[0].y]},(0,uy.Z)(s)?(0,cQ.Z)({},this.skipDefault?null:g6.defaultAttributes.style,s(t,i)):s));m.name=`${h}-line`,m.id=this._getNodeId(`${h}-path-${r}`),e.add(m)}),n.length>1&&a){let t=(0,aX.Z)(a)?a:[a,"transparent"],r=e=>t[e%t.length],s=this.attribute.items,l=s[0],o=s[s.length-1],u=!(0,pS.Yt)(l.value,0)&&!(0,pS.Yt)(o.value,0),d=!(0,pS.Yt)(l.value,1)&&!(0,pS.Yt)(o.value,1),c=[],p=l.value>o.value;(p&&d||!p&&u)&&c.push(this.getGridPointsByValue(+!!p)),n.forEach(t=>{c.push(t.points)}),(p&&u||!p&&d)&&c.push(this.getGridPointsByValue(+!p));for(let t=0;t<c.length-1;t++){let n=function(t,e,i){let{type:r,closed:n}=i,s=e.slice(0).reverse(),l="",a="";if("line"===r&&i.smoothLink&&i.center){let e=t[0],r=s[0],o=i.center;l=(0,g5.st)(t,!!n),a=(0,g5.st)(s,!!n);let h=uL.HL.distancePP(r,o),u=uL.HL.distancePP(e,o);l+=`A${h},${h},0,0,1,${r.x},${r.y}L${r.x},${r.y}`,a+=`A${u},${u},0,0,0,${e.x},${e.y}`}else if("circle"===r){let{center:e}=i;l=g4(e,t,!1,!!n),a=g4(e,s,!0,!!n)}else"line"!==r&&"polygon"!==r||(l=(0,g5.st)(t,!!n),a=(0,g5.st)(s,!!n));return n?l+=a:(l+=a="L"+a.substring(1),l+="Z"),l}(c[t],c[t+1],i),s=c0.i.path({path:n,fill:r(t)});s.name=`${h}-region`,s.id=this._getNodeId(`${h}-region-${t}`),e.add(s)}}}_getNodeId(t){return`${this.id}-${t}`}_parseTickSegment(){let t=1;return this.data.length>=2&&(t=this.data[1].value-this.data[0].value),t}_getPointsOfSubGrid(t,e){let i=this.data.length,r=[];return i>=2&&this.data.forEach(i=>{let n=i.value;if(!e){let e=i.value-t/2;if(this.isInValidValue(e))return;n=e}r.push({value:n})}),r}release(){super.release(),this._prevInnerView=null,this._innerView=null}}g6.defaultAttributes={style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]}}};var g8=i(75303),g9=i(25894);(0,g9.nZ)();class g7 extends g6{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},g6.defaultAttributes,t),e)}_getGridPoint(t,e){let i;if("line"===t){let{length:t}=this.attribute;i=[e,this.getVerticalCoord(e,t,!0)]}else if("circle"===t||"polygon"===t){let{center:t,sides:r=6,startAngle:n=pe.v2,endAngle:s=pe.Di}=this.attribute,l=uL.HL.distancePP(t,e);i=(0,g5.zl)(t,r,l,n,s)}return i}getGridPointsByValue(t){let e=this.getTickCoord(t);return this._getGridPoint(this.attribute.type,e)}getGridAttribute(t){let{type:e,alignWithLabel:i=!0}=this.attribute,r=this._parseTickSegment(),n,s=[];if(t){n=(0,cQ.Z)({},this.attribute,this.attribute.subGrid);let t=[],{count:e=4}=n;if(this.data.length>=2){let n=this._getPointsOfSubGrid(r,i);for(let i=0;i<n.length-1;i++){let r=n[i],s=n[i+1];t.push({id:`sub-${i}-0`,points:this.getGridPointsByValue(r.value),datum:{}});for(let n=0;n<e;n++){let l=(n+1)/(e+1),a=(1-l)*r.value+l*s.value;t.push({id:`sub-${i}-${n+1}`,points:this.getGridPointsByValue(a),datum:{}})}i===n.length-2&&t.push({id:`sub-${i}-${e+1}`,points:this.getGridPointsByValue(s.value),datum:{}})}s=t}}else{n=this.attribute;let t=[];this.data.forEach(n=>{let{point:s}=n;if(!i){let t=n.value-r/2;if(this.isInValidValue(t))return;s=this.getTickCoord(t)}t.push({id:n.label,datum:n,points:this._getGridPoint(e,s)})}),s=t}return Object.assign(Object.assign({},n),{items:s})}}(0,g1.jB)(g7,g8.b);var ft=i(84788);let fe={domainLine:{visible:!0},grid:{visible:!1},subGrid:{visible:!1},tick:{visible:!0},subTick:{visible:!1}},fi={domainLine:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,inside:!1,tickSize:4,alignWithLabel:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},subTick:{visible:!1,tickSize:2,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},label:{visible:!0,inside:!1,space:10,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}},title:{space:10,padding:0,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor"},fontWeight:"normal",fillOpacity:1}}},fr={label:{space:8},title:{space:8},maxHeight:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},fn={label:{space:12,autoLimit:!0},title:{space:12,autoRotate:!0},maxWidth:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}};class fs extends gJ{constructor(){super(...arguments),this.type=rk.cartesianBandAxis,this._scale=new ae}computeDomain(t){return this.computeBandDomain(t)}updateScaleRange(){let t=super.updateScaleRange();return this.updateGroupScaleRange(),t}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}axisHelper(){let t=(t=0)=>this._scales[t];return{isContinuous:!1,dataToPosition:this.dataToPosition.bind(this),getScale:t,getBandwidth:(e=0)=>t(e).bandwidth(),getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>this._inverse,getSpec:()=>this._spec}}registerTicksTransform(){let t=`${this.type}-ticks`;return nq(this._option.dataSet,t,g0.U),t}transformScaleDomain(){this.updateFixedWholeLength()}updateFixedWholeLength(){if(this._scale){let{bandSize:t,maxBandSize:e,minBandSize:i}=this._getOuterBandSizeFromSpec();if(t&&this._scale.bandwidth(t),e&&this._scale.maxBandwidth(e),i&&this._scale.minBandwidth(i),this._scale.isBandwidthFixed()&&this._spec.autoRegionSize&&(t||e)){let i=lM(this._scale.domain().length,null!=t?t:e,this._scale.paddingInner(),this._scale.paddingOuter());["bottom","top"].includes(this._orient)?this._regions.forEach(t=>t.setMaxWidth(i)):["left","right"].includes(this._orient)&&this._regions.forEach(t=>t.setMaxHeight(i))}}}_getOuterBandSizeFromSpec(){var t;let{bandSize:e,maxBandSize:i,minBandSize:r,bandSizeLevel:n=0}=this._spec,{gap:s,extend:l=0}=null!=(t=this._spec.bandSizeExtend)?t:{};n=Math.min(n,this._scales.length-1);for(let t=n;t>0;t--){let a=this._scales[t],o=a.domain(),h=a.paddingInner(),u=a.paddingOuter(),d=e=>{let i=t===n?l:0;return er(s)||t<n?lM(o.length,e,h,u)+i:(e+(t6(s)?e*(Number(s.substring(0,s.length-1))/100):s))*o.length/(this._scales[t-1].paddingInner()+1)+i};t8(e)&&(e=d(e)),t8(i)&&(i=d(i)),t8(r)&&(r=d(r))}return{bandSize:e,maxBandSize:i,minBandSize:r}}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(null==e?void 0:e.showAllGroupLayers)===(null==t?void 0:t.showAllGroupLayers)&&t5(null==e?void 0:e.layers,null==t?void 0:t.layers)||(i.reMake=!0),i}reInit(t){super.reInit(),null==this||this._updateData()}}fs.type=rk.cartesianBandAxis,fs.specKey="axes",fs.builtInTheme={axis:fi,axisBand:fe,axisX:fr,axisY:fn},cG(fs,gQ);let fl=()=>{iv.registerGraphicComponent(K.lineAxis,(t,e)=>new ft.$(t,e)),iv.registerGraphicComponent($.lineAxisGrid,(t,e)=>new g7(t,e)),gK(),iv.registerComponent(fs.type,fs,!1)};function fa(t){let e=[];for(let i=0;i<t.length;i++){let r=t[i];0!==i&&r[0]===e[e.length-1]||e.push(r[0]),e.push(r[1])}return e}function fo(t,e,i){let r=t.indexOf(e),n=t.indexOf(i);r>=0&&n>=0&&r<n&&(t.splice(r,1),t.splice(n,0,e))}let fh=(t,e,i)=>i.reduce((t,r,n)=>(t.push([r,i.length===n+1?e:i[n+1]]),t),[[t,i[0]]]),fu=(t,e)=>t-e,fd=(t,e)=>{let i=[{count:0,sub:[],max:e[0],min:e[0]}],r=0,n=0;for(;r<e.length;)t[n]<=e[r]?(i[r].count+=1,i[r].sub.push(t[n]),n+=1):i[r+=1]={count:0,sub:[],max:e[r],min:e[r]};i.forEach(t=>{t.count&&(t.min=Math.min.apply(null,t.sub))});let s=t.slice(n);return i[r]={count:s.length,sub:s,min:e[e.length-1],max:Math.max.apply(null,s)},i},fc=Math.sqrt(50),fp=Math.sqrt(10),fg=Math.sqrt(2);class ff{constructor(){this._extend={},this.niceLabelFormatter=null}setExtraAttrFromSpec(){t8(this._spec.nice)&&(this._nice=this._spec.nice),t8(this._spec.zero)&&(this._zero=this._spec.zero),this._expand=this._spec.expand,this._domain=gg(this._spec)}transformScaleDomain(){this.setScaleNice()}setLinearScaleNice(){var t;if(!this._nice)return!1;let e=5,i=this._spec.tick||{};if(en(i.forceTickCount))e=i.forceTickCount;else if(tQ(i.tickCount)){let t=this._scale.range(),r=Math.abs(ec(t)-t[0]);1===r&&this._option&&(r=p0(this._orient)?this._option.getChartViewRect().width:this._option.getChartViewRect().height),e=i.tickCount({axisLength:r,labelStyle:this._spec.label&&this._spec.label.style})}else e=en(i.tickCount)?i.tickCount:5;"accurateFirst"===this._spec.niceType&&(e=Math.max(5,e));let{min:r,max:n}=null!=(t=this._domain)?t:{};return er(r)&&er(n)&&er(this._softMaxValue)&&er(this._softMinValue)?this._scale.nice(e):(t8(r)||t8(this._softMinValue))&&er(n)&&er(this._softMaxValue)?this._scale.niceMax(e):!(!er(r)||!er(this._softMinValue)||!t8(n)&&!t8(this._softMaxValue))&&this._scale.niceMin(e)}setLogScaleNice(){var t;if(!this._nice)return!1;let{min:e,max:i}=null!=(t=this._domain)?t:{};return er(e)&&er(i)&&er(this._softMaxValue)&&er(this._softMinValue)?this._scale.nice():(t8(e)||t8(this._softMinValue))&&er(i)&&er(this._softMaxValue)?this._scale.niceMax():!(!er(e)||!er(this._softMinValue)||!t8(i)&&!t8(this._softMaxValue))&&this._scale.niceMin()}setScaleNice(){return"log"===this._spec.type?this.setLogScaleNice():this.setLinearScaleNice()}dataToPosition(t,e){return this.valueToPosition(t[0])}valueToPosition(t){return this._scale.scale(t)}computeLinearDomain(t){let e=[];if(t.length){let s=this._spec.breaks&&this._spec.breaks.length,l,a,o=[];if(t.forEach(t=>{let{min:e,max:i}=t;l=void 0===l?e:Math.min(l,e),a=void 0===a?i:Math.max(a,i),s&&(o=o.concat(t.values))}),s){let t=[],s=[],h=er(this._domain.max)?a:this._domain.max;for(let e=0;e<this._spec.breaks.length;e++){let{range:i}=this._spec.breaks[e];i[0]<=i[1]&&i[1]<=h&&(t.push(i),s.push(this._spec.breaks[e]))}if(t.sort((t,e)=>t[0]-e[0]),t.length){var i,r,n;let{domain:l,scope:a}=(i=o,r=fa(t),n=this._spec.breaks[0].scopeType,i.sort(fu),r.sort(fu),{domain:function(t,e){let i=t[0],r=t[t.length-1],n=e.filter(t=>t>i&&t<r);return 0===n.length?[[i,r]]:fh(i,r,n)}(i,r),scope:function(t,e,i="count"){let r=fd(t,e),n="count"===i?t.length:r.reduce((t,e,i)=>e.count>0?t+e.max-e.min:t,0),s=[],l=0,a=0;return r.forEach((t,e)=>{if(0===n)s.push([0,e/r.length-1]);else{let o="count"===i?t.count:t.max-t.min,h=s[a-1]?s[a-1][1]:0,u=e===r.length-1?1:Math.min((l+o)/n,1);(h!==u||0!==h&&1!==h)&&(a+=1,s.push([h,u]),l+=o)}}),s}(i,r,n)});e=fa(l),this._break={domain:l,scope:a,breakDomains:t,breaks:s}}else e=[l,a]}else e=[l,a]}else e[0]=0,e[1]=0;return this.setSoftDomainMinMax(e),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e}expandDomain(t){if(!this._expand)return;let e=t[0],i=ec(t);e===i&&(0===i?i=1:i>0?e=0:i<0&&(i=0)),t8(this._expand.min)&&(t[0]=e-(i-e)*this._expand.min),t8(this._expand.max)&&(t[t.length-1]=i+(i-e)*this._expand.max)}niceDomain(t){let{min:e,max:i}=gg(this._spec);if(t8(e)||t8(i)||"linear"!==this._spec.type)return t;if(1e-12>=Math.abs(eg(t)-ep(t))){let e=t[0],i=e>=0?1:-1;if((e=Math.abs(e))<1)t[0]=0,t[t.length-1]=1;else{let i=e/5,r=Math.floor(Math.log(i)/Math.LN10),n=i/Math.pow(10,r);i=(n>=fc?10:n>=fp?5:n>=fg?2:1)*Math.pow(10,r),t[0]=0,t[t.length-1]=10*i}i<0&&(t.reverse(),t[0]*=-1,t[t.length-1]*=-1)}return t}includeZero(t){this._zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(ec(t),0))}setExtendDomain(t,e){if(void 0===e)return void delete this._extend[t];this._extend[t]=e;let i=this._scale.domain();this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this._nice),this._nice&&(this.setScaleNice()||this._scale.rescale()),this.event.emit(rI.scaleUpdate,{model:this,value:"domain"})}extendDomain(t){let e,i=t.length-1,r=t[0]-t[i]>0,n=r?i:0,s=r?0:i;for(let i in this._extend)(e=this._extend[i])>t[s]&&(t[s]=e),e<t[n]&&(t[n]=e)}getDomainSpec(){return this._domain}setDomainMinMax(t){if(!this._domain)return;let{min:e,max:i}=this._domain;t8(e)&&(t[0]=e),t8(i)&&(t[t.length-1]=i)}setSoftDomainMinMax(t){let{softMin:e,softMax:i}=this._spec;if(t8(e)){let i=tQ(e)?e(t):e;er(i)&&(i=t[0]),i<=t[0]&&(t[0]=i,this._softMinValue=i)}if(t8(i)){let e=tQ(i)?i(t):i;er(e)&&(e=ec(t)),e>=ec(t)&&(t[t.length-1]=e),this._softMaxValue=e}}setZero(t){this._zero!==t&&(this._zero=t,this.updateScaleDomain())}updateScaleDomain(){if(!this.isSeriesDataEnable())return;let t=this.collectData(),e=this.computeLinearDomain(t);this.updateScaleDomainByModel(e)}updateScaleDomainByModel(t){t=null!=t?t:this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this._nice),this._nice&&(this.setScaleNice()||this._scale.rescale()),this._updateNiceLabelFormatter(t),this._domainAfterSpec=this._scale.domain(),this.event.emit(rI.scaleDomainUpdate,{model:this}),this.event.emit(rI.scaleUpdate,{model:this,value:"domain"})}getDomainAfterSpec(){return this._domainAfterSpec}_updateNiceLabelFormatter(t){let e=Math.pow(10,Math.max(-Math.floor(Math.log10(Math.abs(ec(t)-t[0]))),0)+2);this.niceLabelFormatter=t=>en(+t)?Math.round(t*e)/e:t}}var fm=i(31943);let fy={domainLine:{visible:!1},grid:{visible:!0},subGrid:{visible:!1},tick:{visible:!1},subTick:{visible:!1}};class fv extends gJ{constructor(){super(...arguments),this.type=rk.cartesianLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new l4}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.setExtraAttrFromSpec();let i=null==(e=null==(t=this._tickData)?void 0:t[0])?void 0:e.getDataView().transformsArr.find(t=>t.type===this.registerTicksTransform());i&&(i.options=this._tickTransformOption())}initScales(){var t,e;super.initScales();let i=[0,1];t8(null==(t=this._domain)?void 0:t.min)&&(i[0]=this._domain.min),t8(null==(e=this._domain)?void 0:e.max)&&(i[1]=this._domain.max),this._scale.domain(i)}_tickTransformOption(){var t;return Object.assign(Object.assign({},super._tickTransformOption()),{breakData:(null==(t=this._spec.breaks)?void 0:t.length)?()=>this._break:null})}_getUpdateAttribute(t){var e,i;let r=super._getUpdateAttribute(t);if(!p2(this._orient)&&(null==(i=null==(e=this._break)?void 0:e.breaks)?void 0:i.length)){let{width:t,height:e}=this.getLayoutRect(),i=p0(this._orient),n=i?t:e;r.breaks=this._break.breaks.map(t=>{let e,{range:r,breakSymbol:s,gap:l=6}=t,a=this.valueToPosition((r[0]+r[1])/2)/n;e=eC(l)?Number(l.substring(0,l.length-1))/100:l/n;let o=en(null==s?void 0:s.angle)?s.angle:i?60:15;return{range:[a-e/2,a+e/2],breakSymbol:Object.assign(Object.assign({visible:!0},s),{angle:o*Math.PI/180}),rawRange:r}})}return r}getNewScaleRange(){var t,e;let i=super.getNewScaleRange();return(null==(t=this._spec.breaks)?void 0:t.length)&&(null==(e=this._break)?void 0:e.scope)&&(i=fa(this._break.scope).map(t=>i[0]+(ec(i)-i[0])*t)),i}computeDomain(t){return this.computeLinearDomain(t)}axisHelper(){let t=super.axisHelper();return t.setExtendDomain=this.setExtendDomain.bind(this),t.valueToPosition=this.valueToPosition.bind(this),t}registerTicksTransform(){let t=`${this.type}-ticks`;return nq(this._option.dataSet,t,fm.m),t}}fv.type=rk.cartesianLinearAxis,fv.specKey="axes",fv.builtInTheme={axis:fi,axisLinear:fy,axisX:fr,axisY:fn},cG(fv,ff);let fb=()=>{iv.registerGraphicComponent(K.lineAxis,(t,e)=>new ft.$(t,e)),iv.registerGraphicComponent($.lineAxisGrid,(t,e)=>new g7(t,e)),gK(),iv.registerComponent(fv.type,fv)},f_=`${st}_hide_`;function fx(t,e){t.context.finalAttrs&&(t.context.finalAttrs.visible=e)}let fC=(t,e)=>{if(!e||0===e.length)return e;let{direction:i,delta:r,deltaMul:n=1,groupBy:s}=t,l=e=>{e.forEach(t=>{t[f_]&&(fx(t,!0),t[f_]=!1)});let s=t.sort?e.slice().sort((t,e)=>t.context.finalAttrs.x-e.context.finalAttrs.x):e;0===i?function(t,e,i){let r=-1/0,n=0,s=0,l=er(e),a=e;t.forEach(t=>{if(!1===t.context.finalAttrs.visible)return;let e=t.context.finalAttrs.size/2,{x:s,y:o}=t.context.finalAttrs;l&&(a=(e+n)*i),(-1/0-s)**2+(r-o)**2<(a+n+e)**2?t.context.finalAttrs.forceShow||(t[f_]=!0,fx(t,!1)):r=o,n=e})}(s,r,n):1===i?function(t,e,i){let r=-1/0,n=0,s=er(e),l=e;t.forEach(t=>{if(!1===t.context.finalAttrs.visible)return;let e=t.context.finalAttrs.size/2,a=t.context.finalAttrs.x;s&&(l=(e+n)*i),Math.abs(a-r)<l+n+e?t.context.finalAttrs.forceShow||(t[f_]=!0,fx(t,!1)):r=a,n=e})}(s,r,n):function(t,e,i){let r=-1/0,n=0,s=er(e),l=e;t.forEach(t=>{if(!1===t.context.finalAttrs.visible)return;let e=t.context.finalAttrs.size/2,a=t.context.finalAttrs.y;s&&(l=(e+n)*i),Math.abs(a-r)<l+n+e?t.context.finalAttrs.forceShow||(t[f_]=!0,fx(t,!1)):r=a,n=e})}(s,r,n)};if(s){let t=e.reduce((t,e)=>{var i,r;let n=null==(r=null==(i=e.context.data)?void 0:i[0])?void 0:r[s];return t[n]?t[n].push(e):t[n]=[e],t},{});Object.keys(t).forEach(e=>{l(t[e])})}else l(e);return e},fw=()=>{iv.registerGrammarTransform("symbolOverlap",{transform:fC,runType:"afterEncode"})},fS={min:eg,max:ep,average:dN,sum:dW};function fA(t,e,i,r){let n=Math.floor(e.length/t),s=[],l=e.length,a,o,h,u=0,d=0;s[d++]=u;for(let t=1;t<l-1;t+=n){let i=Math.min(t+n,l-1),c=Math.min(t+2*n,l),p=(c+i)/2,g=0;for(let t=i;t<c;t++){let i=e[t][r];Number.isNaN(i)||(g+=i)}g/=c-i;let f=t,m=Math.min(t+n,l),y=t-1,v=e[u][r];a=-1,h=f;for(let t=f;t<m;t++){let i=e[t][r];Number.isNaN(r)||(o=Math.abs((y-p)*(i-v)-(y-t)*(g-v)))>a&&(a=o,h=t)}s[d++]=h,u=h}return s[d-1]!==l-1&&(s[d++]=l-1),s.map(t=>i?e[t].i:t)}function fM(t,e,i,r,n){let s=Math.floor(e.length/t),l=[],a=e.length,o=0,h=[];l.push(o),e[o][n]=e[o][n];for(let t=1;t<a-1;t+=s){s>a-t&&(s=a-t,h.length=s),h=[];for(let i=0;i<s;i++)h.push(e[t+i][n]);let i=fS[r](h);e[o=Math.min(Math.round(t+h.length/2)||0,a-1)][n]=i,l.push(o)}return l.map(t=>i?e[t].i:t)}function fk(t,e,i,r){return fM(t,e,i,"min",r)}function fT(t,e,i,r){return fM(t,e,i,"max",r)}function fR(t,e,i,r){return fM(t,e,i,"average",r)}function fB(t,e,i,r){return fM(t,e,i,"sum",r)}let fP=(t,e)=>{let i=tQ(t.size)?t.size():t.size,r=t.factor||1;if(Array.isArray(i)&&(i=Math.floor(i[1]-i[0])),(i*=r)<=0)return[];if(e.length<=i)return e;if(t.skipfirst)return e.slice(0,1);let{mode:n,yfield:s,groupBy:l}=t,a=null!=s?s:"y",o=fA;if("min"===n?o=fk:"max"===n?o=fT:"average"===n?o=fR:"sum"===n&&(o=fB),e.length){let t={};if(l){for(let i=0,r=e.length;i<r;i++){let r=e[i],n=r[l];t[n]||(t[n]=[]),t[n].push({[a]:r[a],i:i})}let r=[];return Object.keys(t).forEach(n=>{let s=t[n];if(s.length<=i){let t=s.map(t=>t.i);r=r.concat(t)}else{let t=o(i,s,!0,a);r=r.concat(t),s.forEach(t=>e[t.i][a]=t[a])}}),r.sort((t,e)=>t-e),r.map(t=>e[t])}return o(i,e,!1,a).map(t=>e[t])}return[]},fE=()=>{iv.registerGrammarTransform("dataSampling",{transform:fP})};class fI extends cD{constructor(){super(...arguments),this.type=rR.line,this.transformerConstructor=pZ,this._sortDataByAxis=!1}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}initMark(){var t;let e=null!=(t=this._spec.seriesMark)?t:"line";this.initLineMark("line"===e),this.initSymbolMark("point"===e)}initTooltip(){super.initTooltip();let{group:t,mark:e}=this._tooltipHelper.activeTriggerSet;this._lineMark&&t.add(this._lineMark),this._symbolMark&&(e.add(this._symbolMark),t.add(this._symbolMark))}initMarkStyle(){this.initLineMarkStyle(this._direction),this.initSymbolMarkStyle()}initAnimation(){var t,e,i,r;let n={direction:this.direction},s=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;if(this._lineMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("line"))?void 0:i(n,s),cM("line",this._spec,this._markAttributeContext))),this._symbolMark){let t=cO(this);this._symbolMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("scaleInOut"))?void 0:r(),cM("point",this._spec,this._markAttributeContext),t))}}onLayoutEnd(){super.onLayoutEnd(),this.reCompileSampling()}getSeriesStyle(t){var e;let i="point"!==(null==(e=this._spec)?void 0:e.seriesMark);return e=>{var r,n;return i&&"fill"===e&&(e="stroke"),null!=(n=null==(r=this._seriesMark)?void 0:r.getAttribute(e,t))?n:void 0}}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._lineMark,this._symbolMark]}}fI.type=rR.line,fI.mark=cV,fI.builtInTheme={line:{label:{visible:!1,position:"top",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}}},fI.transformerConstructor=pZ,cG(fI,cj);let fL=()=>{fE(),fw(),pW(),pV(),u8(),u3(),fl(),fb(),iv.registerSeries(fI.type,fI)},fF=(t,e)=>{var i;let{regionId:r,regionIndex:n}=t.spec;if(t8(r)){let t=ed(r);return null==(i=e.region)?void 0:i.filter(({spec:e})=>t.includes(e.id))}if(t8(n))return ed(n).map(t=>{var i;return null==(i=e.region)?void 0:i[t]}).filter(t8)},fO=(t,e)=>{var i;let{seriesId:r,seriesIndex:n}=t.spec;if(t8(r)){let t=ed(r);return null==(i=e.series)?void 0:i.filter(({spec:e})=>t.includes(e.id))}if(t8(n))return ed(n).map(t=>{var i;return null==(i=e.series)?void 0:i[t]}).filter(t8)};class fD{constructor(t){this._option=t,this.type=t.type,this.seriesType=t.seriesType}initChartSpec(t){return this.transformSpec(t),this.transformModelSpec(t)}transformSpec(t){t.region&&0!==t.region.length||(t.region=[{}]),void 0===t.tooltip&&(t.tooltip={}),t8(t.stackInverse)&&t.region.forEach(e=>{t8(e.stackInverse)||(e.stackInverse=t.stackInverse)}),t8(t.stackSort)&&t.region.forEach(e=>{t8(e.stackSort)||(e.stackSort=t.stackSort)})}generateTransform(t,e){return(i,r,n)=>{let{spec:s,specPath:l,specInfoPath:a,type:o}=r,h=new i.transformerConstructor(Object.assign(Object.assign({},this._option),{type:o})),u=h.transformSpec(s,t,n),d=Object.assign(Object.assign({},r),u);e?d.theme=h.getTheme(s,t):sq(t,l,u.spec),sq(n,null!=a?a:l,d)}}transformModelSpec(t){return this.createSpecInfo(t,this.generateTransform(t,!1))}createSpecInfo(t,e){var i,r;e||(e=this.generateTransform(t,!0));let n={};return this.forEachRegionInSpec(t,e,n),this.forEachSeriesInSpec(t,e,n),null==(i=n.series)||i.forEach((t,e)=>{var i,r;let s=(null!=(r=null!=(i=fF(t,n))?i:n.region)?r:[])[0];s&&(s.seriesIndexes||(s.seriesIndexes=[]),s.seriesIndexes.push(e),t.regionIndexes=s.regionIndexes.slice())}),this.forEachComponentInSpec(t,e,n),Object.values(null!=(r=n.component)?r:{}).forEach(t=>t.forEach((t,e)=>{var i,r,s;if(t){if(!t.regionIndexes){let e=null!=(r=null!=(i=fF(t,n))?i:n.region)?r:[];t.regionIndexes=e.map(t=>t.regionIndexes[0])}if(!t.seriesIndexes){let e=fO(t,n);if(e)t.seriesIndexes=e.map(({seriesIndexes:t})=>t[0]);else{let e=new Set;(null!=(s=t.regionIndexes)?s:[]).forEach(t=>{var i,r;let s=null==(i=n.region)?void 0:i[t];null==(r=null==s?void 0:s.seriesIndexes)||r.forEach(t=>e.add(t))}),t.seriesIndexes=Array.from(e)}}}})),n}_isValidSeries(t){return!0}_getDefaultSeriesSpec(t,e,i){var r,n,s,l,a;let o={dataKey:t.dataKey,hover:t.hover,select:t.select,label:t.label,seriesStyle:t.seriesStyle,animation:null!=(r=t.animation)?r:null==(n=this._option.globalInstance)?void 0:n.isAnimationEnable(),animationThreshold:null!=(s=t.animationThreshold)?s:null==(a=(l=this._option).getTheme)?void 0:a.call(l,"animationThreshold"),animationAppear:t.animationAppear,animationDisappear:t.animationDisappear,animationEnter:t.animationEnter,animationUpdate:t.animationUpdate,animationExit:t.animationExit,animationNormal:t.animationNormal,animationState:t.animationState,extensionMark:t.extensionMark,large:t.large,largeThreshold:t.largeThreshold,progressiveStep:t.progressiveStep,progressiveThreshold:t.progressiveThreshold,background:t.seriesBackground,invalidType:t.invalidType,seriesField:t.seriesField,morph:t.morph,interactions:t.interactions},h=this.seriesType;return h&&(o.type=h,o[h]=t[h]),e&&e.length&&e.forEach(e=>{o[e]=t[e]}),i&&i.length&&i.forEach(e=>{o[e]=t[e]}),o}forEachRegionInSpec(t,e,i){var r;return(null!=(r=t.region)?r:[]).map((t,r)=>e(iv.getRegionInType("region"),{spec:t,specPath:["region",r],type:"region",regionIndexes:[r]},i))}forEachSeriesInSpec(t,e,i){var r;return(null!=(r=t.series)?r:[]).map((t,r)=>e(iv.getSeriesInType(t.type),{spec:t,specPath:["series",r],type:t.type,seriesIndexes:[r]},i))}forEachComponentInSpec(t,e,i){var r,n,s;let l,a,o,h,u=[],d=iv.getComponents(),c=[];for(let e=0;e<d.length;e++){let{cmp:i,alwaysCheck:n}=d[e];i.type.startsWith(rk.cartesianAxis)?l=i:i.type.startsWith(rk.polarAxis)?a=i:i.type===rk.geoCoordinate?o=i:(n||t[null!=(r=i.specKey)?r:i.type])&&(i.type===rk.tooltip?h=i:c.push(d[e]))}let p=!1;if(l){let r=l.getSpecInfo(t,i);(null==r?void 0:r.length)>0&&(p=!0,r.forEach(t=>{let r=iv.getComponentInKey(t.type);u.push(e(r,t,i))}))}if(a&&!p){let r=a.getSpecInfo(t,i);(null==r?void 0:r.length)>0&&(p=!0,r.forEach(t=>{let r=iv.getComponentInKey(t.type);u.push(e(r,t,i))}))}return o&&!p&&(null==(n=o.getSpecInfo(t,i))||n.forEach(t=>{u.push(e(o,t,i))})),c.sort((t,e)=>t.createOrder-e.createOrder),c.forEach(({cmp:r})=>{var n;null==(n=r.getSpecInfo?r.getSpecInfo(t,i):d6(t,r.specKey,r.type))||n.forEach(t=>{u.push(e(r,t,i))})}),h&&(null==(s=d6(t,h.specKey,h.type))||s.forEach(t=>{u.push(e(h,t,i))})),u}transformSeriesSpec(t){let e=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}):t.series=[e]}_findBandAxisBySeries(t,e,i){let r="horizontal"===(null==t?void 0:t.direction)?["left","right"]:["top","bottom"];return i.find(i=>!!r.includes(i.orient)&&(t8(i.seriesId)?ed(i.seriesId).includes(null==t?void 0:t.id):t8(i.seriesIndex)?ed(i.seriesIndex).includes(e):i.type,!0))}_applyAxisBandSize(t,e,i){let{barMaxWidth:r,barMinWidth:n,barWidth:s,barGapInGroup:l}=i,a=!1;tG(n)?(t.minBandSize=n,a=!0):tG(s)?(t.minBandSize=s,a=!0):tG(r)&&(t.minBandSize=r,a=!0),a&&(t.bandSizeLevel=Number.MAX_VALUE,t.bandSizeExtend={extend:e,gap:tq(l)?l[l.length-1]:l})}}class fH extends fD{needAxes(){return!0}_isValidSeries(t){return!this.seriesType||t===this.seriesType}_getDefaultSeriesSpec(t,e){return super._getDefaultSeriesSpec(t,["xField","yField","zField","direction","stack","percent","stackOffsetSilhouette","totalLabel","sortDataByAxis"],e)}transformSpec(t){super.transformSpec(t),super.transformSeriesSpec(t),this._transformAxisSpec(t)}_setDefaultXAxisSpec(t){return{orient:"bottom"}}_setDefaultYAxisSpec(t){return{orient:"left"}}_setDefaultZAxisSpec(t){return{orient:"z"}}_transformAxisSpec(t){if(this.needAxes()){t.axes||(t.axes=[]);let e={x:!1,y:!1,z:!1};t.axes.forEach(i=>{let{orient:r}=i,n=null;"top"!==r&&"bottom"!==r||(e.x=!0,n=this._setDefaultXAxisSpec(t)),"left"!==r&&"right"!==r||(e.y=!0,n=this._setDefaultYAxisSpec(t)),"z"===r&&(e.z=!0,n=this._setDefaultZAxisSpec(t)),n&&Object.keys(n).forEach(t=>{er(i[t])&&(i[t]=n[t])}),iW(i,"trimPadding")&&ir(i,sG(this.type,t))}),e.x||t.axes.push(this._setDefaultXAxisSpec(t)),e.y||t.axes.push(this._setDefaultYAxisSpec(t)),t.zField&&!e.z&&t.axes.push(this._setDefaultZAxisSpec(t))}}}class fz extends fH{_getDefaultSeriesSpec(t){var e;let i=super._getDefaultSeriesSpec(t,["point","line","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","lineLabel"]);return i.seriesMark=null!=(e=t.seriesMark)?e:"line",i}transformSpec(t){super.transformSpec(t),sW(t)}}class fW{get dataList(){return this._dataArr}constructor(t){this._dataArr=[],this._dataSet=t}parseData(t){this._dataArr=[];let e=ed(t);for(let t=0;t<e.length;t++)this._dataArr.push(n4(e[t],this._dataSet,this._dataArr))}updateData(t,e=!1,i=!0){let r=ed(t);return(!e||r.length===this._dataArr.length)&&(this._dataValueForEach(r,(t,e)=>{e.markRunning()}),this._dataValueForEach(r,(t,e)=>{n6(e,t,i)}),!0)}_dataValueForEach(t,e){t.forEach((t,i)=>{if(t instanceof el)return;let r=this.getSeriesData(t.id,i);r&&e(t,r,i)})}getSeriesData(t,e){if(!this._dataArr.length)return null;if("string"==typeof t){let e=this._dataArr.filter(e=>e.name===t);if(e[0])return e[0];eO(`no data matches dataId ${t}!`)}if("number"==typeof e){if(this._dataArr[e])return this._dataArr[e];eO(`no data matches dataIndex ${e}!`)}return this._dataArr[0]}}class fN{constructor(t,e){this._scaleSpecMap=new Map,this._scaleMap=new Map,this._modelScaleSpecMap=new Map,this._markAttributeScaleMap=new Map,this._spec=null,this._chart=null,this.getStatisticalFields=t=>{let e=[];return this._scaleSpecMap.forEach((i,r)=>{eb(i.domain)&&i.domain.forEach(r=>{r.dataId===t&&r.fields.forEach(t=>{dU(e,[{key:t,operations:ls(i.type)?["max","min"]:["values"]}])})})}),this._markAttributeScaleMap.forEach((i,r)=>{let n=this.getScale(r);i.forEach(i=>{this._getSeriesBySeriesId(i.seriesId).getRawData().name===t&&i.field&&dU(e,[{key:i.field,operations:ls(n.type)?["max","min"]:["values"]}])})}),e},this._spec=t,this._chart=e,this._setAttrFromSpec()}_createFromSpec(t){if(!t.id)return null;let e=this._scaleMap.get(t.id);return e||(e="ordinal"===t.type&&"color"===t.id?as("colorOrdinal"):as(t.type)),e?(tq(t.range)&&e.range(t.range),tq(t.domain)&&(eb(t.domain)||e.domain(t.domain)),t.specified&&e.specified&&e.specified(t.specified),t.clamp&&e.clamp&&e.clamp(t.clamp),e):null}_setAttrFromSpec(){var t;if(!(null==(t=this._spec)?void 0:t.length))return;let e=new Map,i=new Map;this._spec.forEach(t=>{let r=this._createFromSpec(t);r&&(e.set(t.id,r),i.set(t.id,t))}),this._modelScaleSpecMap.forEach(t=>{let r=this._createFromSpec(t);r&&(e.set(t.id,r),i.set(t.id,t))}),this._scaleSpecMap=i,this._scaleMap=e}updateSpec(t){let e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(t5(t,this._spec))return e;e.change=!0;for(let i=0;i<t.length;i++){let r=t[i],n=this._scaleMap.get(r.id);if(!n)return e.reMake=!0,e;let s=this._spec.find(t=>t.id===r.id);if(!s.id||s.type!==r.type||!t5(s.specified,r.specified))return e.reMake=!0,e;r.range&&!t5(r.range,n.range())&&(n.range(r.range),e.reRender=!0),eb(r.domain)?e.reRender=!0:t5(r.domain,n.domain())||(n.domain(r.domain),e.reRender=!0),this._scaleSpecMap.set(r.id,r)}return this._spec=t,e}registerModelScale(t){let e=this._createFromSpec(t);e&&(this._modelScaleSpecMap.set(t.id,t),this._scaleSpecMap.set(t.id,t),this._scaleMap.set(t.id,e))}removeModelScale(t){this._modelScaleSpecMap.forEach(e=>{t(e)&&(this._modelScaleSpecMap.delete(e.id),this._scaleSpecMap.delete(e.id),this._scaleMap.delete(e.id))})}getScale(t){return this._scaleMap.get(t)}getScaleSpec(t){return this._scaleSpecMap.get(t)}_getSeriesByRawDataId(t){let e=this._chart.getAllSeries();for(let i=0;i<e.length;i++){let r=e[i];if(r.getRawData().name===t)return r}return null}_getSeriesBySeriesId(t){let e=this._chart.getAllSeries();for(let i=0;i<e.length;i++){let r=e[i];if(r.id===t)return r}return null}updateScaleDomain(t){this._scaleSpecMap.forEach((e,i)=>{let r,n=this._scaleMap.get(i);if(!n)return;if(!eb(e.domain))return e.domain&&0!==e.domain.length||n.domain(t),void this._updateMarkScale(i,n,n.domain().slice());r=ls(e.type)?[null,null]:new Set,e.domain.forEach(t=>{let i=this._getSeriesByRawDataId(t.dataId);if(!i)return;let n=ls(e.type);t.fields.forEach(t=>{let e=i.getRawDataStatisticsByField(t,n);e&&(n?(er(r[0])?r[0]=e.min:r[0]=Math.min(e.min,r[0]),er(r[1])?r[1]=e.max:r[1]=Math.max(e.max,r[1])):e.values.forEach(t=>{r.add(t)}))})});let s=r;ls(e.type)||(r=Array.from(r)),n.domain(r),this._updateMarkScale(i,n,s)})}_updateMarkScale(t,e,i){let r=this._markAttributeScaleMap.get(t);r&&0!==r.length&&r.forEach(t=>{if(!t.field||!t.markScale||t.markScale===e)return;if(er(t.changeDomain)||"none"===t.changeDomain||er(t.seriesId))return void(ls(e.type)?t.markScale.domain(i):e.domain(Array.from(i)));let r=this._getSeriesBySeriesId(t.seriesId),n=ls(e.type),s=r.getRawDataStatisticsByField(t.field,n);if(!sD(s))return"expand"===t.changeDomain?(n?(i[0]=Math.min(i[0],s.min),i[1]=Math.max(i[1],s.max)):(s.values.forEach(t=>{i.add(t)}),i=Array.from(i)),void t.markScale.domain(i)):void("replace"!==t.changeDomain||(n?t.markScale.domain([s.min,s.max]):t.markScale.domain(s.values)));ls(e.type)?t.markScale.domain(i):e.domain(Array.from(i))})}registerMarkAttributeScale(t,e){let i=this._scaleMap.get(t.scale),r=this._markAttributeScaleMap.get(t.scale);r||(r=[],this._markAttributeScaleMap.set(t.scale,r));let n=i;return!er(t.field)&&(er(t.changeDomain)||"none"===t.changeDomain||er(e))||(n=i.clone()),r.push(Object.assign(Object.assign({},t),{seriesId:e,markScale:n})),n}}class fj{constructor(){this._stateGraphicsByTrigger=new Map,this._disableTriggerEvent=!1,this._triggerMapByState=new Map}setDisableActiveEffect(t){this._disableTriggerEvent=t}addTrigger(t){t&&[t.getStartState(),t.getResetState()].forEach(e=>{if(e){let i=this._triggerMapByState.get(e);i?i.includes(t)||i.push(t):this._triggerMapByState.set(e,[t])}})}setStatedGraphics(t,e){this._stateGraphicsByTrigger.set(t,e)}getStatedGraphics(t){return this._stateGraphicsByTrigger.get(t)}updateStates(t,e,i,r,n){return this._disableTriggerEvent?[]:e&&e.length?(r&&n?i&&i.length?(this.toggleReverseStateOfGraphics(t,e,i,n),this.toggleStateOfGraphics(t,e,i,r)):this.addBothStateOfGraphics(t,e,r,n):r&&(i&&i.length?this.toggleStateOfGraphics(t,e,i,r):this.addStateOfGraphics(t,e,r)),e):[]}toggleReverseStateOfGraphics(t,e,i,r){let n=t.getMarkIdByState();i.forEach(t=>{var e;if(r&&n[r]&&n[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,n=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(r,!0,n)}}),e.forEach(t=>{var e;if(r&&n[r]&&n[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,n=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(r,n)}})}toggleStateOfGraphics(t,e,i,r){let n=t.getMarkIdByState();i.forEach(t=>{var e;if(r&&n[r]&&n[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,n=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(r,n)}}),e.forEach(t=>{var e;if(r&&n[r]&&n[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,n=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(r,!0,n)}})}addBothStateOfGraphics(t,e,i,r){let n=t.getMarks(),s=t.getMarkIdByState();n.forEach(t=>{var n;let l=r&&s[r]&&s[r].includes(t.id),a=i&&s[i]&&s[i].includes(t.id);if(!l&&!a)return;let o=t.hasAnimationByState&&t.hasAnimationByState("state");null==(n=t.getGraphics())||n.forEach(t=>{e&&e.includes(t)?a&&t.addState(i,!0,o):l&&t.addState(r,!0,o)})})}addStateOfGraphics(t,e,i){let r=t.getMarks(),n=t.getMarkIdByState();r.forEach(t=>{var r;let s=i&&n[i]&&n[i].includes(t.id);if(!s)return;let l=t.hasAnimationByState&&t.hasAnimationByState("state");null==(r=t.getGraphics())||r.forEach(t=>{e&&e.includes(t)&&s&&t.addState(i,!0,l)})})}clearAllStatesOfTrigger(t,e,i){if(this._disableTriggerEvent)return;let r=this.getStatedGraphics(t);if(!r||!r.length)return;let n=t.getMarks(),s=t.getMarkIdByState();n.forEach(t=>{if(t){let n=t.getGraphics(),l=t.hasAnimationByState&&t.hasAnimationByState("state");n&&n.length&&(i&&s[i]&&s[i].includes(t.id)&&n.forEach(t=>{t.removeState(i,l)}),e&&s[e]&&s[e].includes(t.id)&&n.forEach(t=>{r.includes(t)&&t.removeState(e,l)}))}})}clearAllStates(){this._disableTriggerEvent||this._triggerMapByState.forEach((t,e)=>{t.forEach(t=>{this.clearAllStatesOfTrigger(t,e,t.getResetState())})})}clearByState(t){if(this._disableTriggerEvent)return;let e=this._triggerMapByState.get(t);e&&e.length&&e.forEach(e=>{this.clearAllStatesOfTrigger(e,t,e.getResetState()),this.setStatedGraphics(e,[])})}updateStateOfGraphics(t,e){if(this._disableTriggerEvent)return;let i=this._triggerMapByState.get(t);i&&i.length&&i.forEach(t=>{let i=e.filter(e=>t.getMarks().some(t=>{let i=t&&t.getGraphics();return i&&i.includes(e)}));this.updateStates(t,i,this.getStatedGraphics(t),t.getStartState(),t.getResetState()),this.setStatedGraphics(t,i)})}}var fG=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class fV extends s${getSpec(){return this._spec}setSpec(t){this._spec=t}getOption(){return this._option}getLayoutRect(){return this._layoutRect}getViewRect(){return this._viewRect}getLayoutTag(){return this._layoutTag}setLayoutTag(t,e,i=!0){this._layoutTag=t;let r=this.getCompiler();return r&&(r.updateLayoutTag(),t&&i&&r.renderNextTick(e)),this._layoutTag}resetLayoutItemTag(){this.getLayoutElements().forEach(t=>t.setWillLayoutTag())}getModelOption(){return this._modelOption}getGlobalScale(){return this._globalScale}getEvent(){return this._event}get chartData(){return this._chartData}_setModelOption(){}constructor(t,e){var i,r,n;super(e),this.type="chart",this.id=ey(),this._regions=[],this._series=[],this._components=[],this._layoutRect={x:0,y:0,width:se,height:si},this._viewRect={width:se,height:si},this._viewBox={x1:0,y1:0,x2:se,y2:si},this._layoutTag=!0,this._idMap=new Map,this.state={layoutUpdateRank:1},this.padding={top:0,left:0,right:0,bottom:0},this.getAllSeries=()=>{var t;return null!=(t=this._series)?t:[]},this.getRegionsInIndex=t=>t&&0!==t.length?this._regions.filter((e,i)=>t.includes(i)):[this._regions[0]],this.getAllRegions=()=>this._regions,this.getRegionsInIds=t=>t?this._regions.filter(e=>t.includes(e.id)):[],this.getRegionsInQuerier=t=>t?this._regions.filter((e,i)=>ed(t).some(t=>t8(t.regionId)&&t.regionId===e.userId||t.regionIndex===i)):this._regions,this.getRegionsInUserId=t=>{if(t)return this._regions.find(e=>e.userId===t)},this.getRegionsInUserIdOrIndex=(t,e)=>this.getAllRegions().filter(i=>(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())),this.getComponents=()=>this._components,this.getSeriesInIndex=t=>t&&0!==t.length?this._series.filter((e,i)=>t.includes(i)):[this._series[0]],this.getSeriesInIds=t=>t?this._series.filter(e=>t.includes(e.id)):[],this.getSeriesInUserId=t=>{if(t)return this._series.find(e=>e.userId===t)},this.getSeriesInUserIdOrIndex=(t,e)=>this.getAllSeries().filter(i=>(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())),this.getComponentByIndex=(t,e)=>{let i=this._components.filter(e=>(e.specKey||e.type)===t);if(i&&0!==i.length)return i[e]},this.getComponentsByKey=t=>this._components.filter(e=>(e.specKey||e.type)===t),this.getComponentByUserId=t=>{let e=this._components.find(e=>e.userId===t);if(e)return e},this.getComponentsByType=t=>this._components.filter(e=>e.type===t),this._paddingSpec=ek(null!=(i=t.padding)?i:e.getTheme("padding")),this._event=new iO(e.eventDispatcher,e.mode),this._dataSet=e.dataSet,this._chartData=new fW(this._dataSet),this._modelOption=Object.assign(Object.assign({},e),{mode:this._option.mode,map:this._idMap,getChartLayoutRect:()=>this._layoutRect,getChartViewRect:()=>this._viewRect,getChart:()=>this,globalScale:this._globalScale,onError:null==(r=this._option)?void 0:r.onError,disableTriggerEvent:!0===(null==(n=this._option)?void 0:n.disableTriggerEvent),getSeriesData:this._chartData.getSeriesData.bind(this._chartData),dispatchEvent:(t,e)=>this._option.globalInstance.event.emit(t,e)}),this._setModelOption&&this._setModelOption(),this._spec=t}created(t){this._chartData.parseData(this._spec.data),this._createGlobalScale(),this._createBackground(),this._createLayout(),t.forEachRegionInSpec(this._spec,this._createRegion.bind(this)),t.forEachSeriesInSpec(this._spec,this._createSeries.bind(this)),t.forEachComponentInSpec(this._spec,this._createComponent.bind(this),this._option.getSpecInfo())}_initInteractions(){if(this._option.disableTriggerEvent)return;this._interaction=new fj;let t=this.getAllSeries(),e=[],i={};t.forEach(t=>{let r=t.getInteractionTriggers();if(r&&r.length){let n=t.getRegion().id;r.forEach(({trigger:t,marks:r})=>{let s=`${n}-${t.type}`;i[s]?r.forEach(t=>{i[s].marks.push(t)}):(i[s]=Object.assign(Object.assign({},t),{marks:r}),e.push(i[s]))})}}),e.forEach(t=>{let e=iv.createInteractionTrigger(t.type,Object.assign(Object.assign({},t),{event:this._event,interaction:this._interaction}));e&&(e.init(),this._interaction.addTrigger(e))})}init(){var t,e;null==(t=this._beforeInit)||t.call(this),this._regions.forEach(t=>t.init({})),this._series.forEach(t=>t.init({})),this._components.forEach(t=>t.init({dataSet:this._dataSet})),this._initEvent(),null==(e=this._initStack)||e.call(this),this.reDataFlow(),this._initInteractions()}reDataFlow(){this._series.forEach(t=>{var e;return null==(e=t.getRawData())?void 0:e.markRunning()}),this._series.forEach(t=>t.fillData()),this.updateGlobalScaleDomain()}onResize(t,e,i=!0){this._canvasRect={width:t,height:e},this._updateLayoutRect(this._option.viewBox),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,i)}updateViewBox(t,e){this._option.viewBox=t,this._updateLayoutRect(t),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,e)}_createBackground(){let t=this._spec.background;if(!t||"object"!=typeof t||t8(t.gradient))return;let e=gW(t,["x","y","width","height","x1","y1","image"]);e.background=t.image,this._backgroundMark=iv.createMark("group","chart-background",{model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._globalScale}),this._backgroundMark.created(),this._backgroundMark.setStyle(Object.assign(Object.assign({},e),{x:()=>this._viewBox.x1,y:()=>this._viewBox.y1,width:()=>this._viewBox.x2-this._viewBox.x1,height:()=>this._viewBox.y2-this._viewBox.y1})),this._backgroundMark.setMarkConfig({zIndex:H.SeriesGroup-2}),this.getCompiler().addRootMark(this._backgroundMark)}_createRegion(t,e){if(!t)return;let{spec:i}=e,r=fG(e,["spec"]),n=new t(i,Object.assign(Object.assign({},this._modelOption),r));n&&(n.created(),this._regions.push(n))}_createSeries(t,e){let i;if(!t)return;let{spec:r}=e,n=fG(e,["spec"]);if(t8(r.regionId)?i=this.getRegionsInUserId(r.regionId):t8(r.regionIndex)&&(i=this.getRegionsInIndex([r.regionIndex])[0]),!i&&!(i=this._regions[0]))return;let s=new t(r,Object.assign(Object.assign(Object.assign({},this._modelOption),n),{type:r.type,region:i,globalScale:this._globalScale,sourceDataList:this._chartData.dataList}));s&&(s.created(),this._series.push(s),i.addSeries(s))}getSeriesById(t){return this._series.find(e=>e.id===t)}_createComponent(t,e){let i=t.createComponent(e,Object.assign(Object.assign({},this._modelOption),{type:t.type,getAllRegions:this.getAllRegions,getRegionsInIndex:this.getRegionsInIndex,getRegionsInIds:this.getRegionsInIds,getRegionsInUserIdOrIndex:this.getRegionsInUserIdOrIndex,getAllSeries:this.getAllSeries,getSeriesInIndex:this.getSeriesInIndex,getSeriesInIds:this.getSeriesInIds,getSeriesInUserIdOrIndex:this.getSeriesInUserIdOrIndex,getAllComponents:this.getComponents,getComponentByIndex:this.getComponentByIndex,getComponentByUserId:this.getComponentByUserId,getComponentsByKey:this.getComponentsByKey,getComponentsByType:this.getComponentsByType}));i&&(i.created(),this._components.push(i))}getAllComponents(){return this._components}getAllModels(){return[].concat(this.getAllSeries(),this.getAllComponents(),this.getAllRegions())}getModelInFilter(t){if(t6(t))return this.getAllModels().find(e=>e.userId===t);if(tQ(t))return this.getAllModels().find(e=>t(e));let e=0;return this.getAllModels().find(i=>{var r;if((null!=(r=i.specKey)?r:i.type)===t.type){if(e===t.index)return!0;e++}return!1})}_createLayout(){this._updateLayoutRect(this._option.viewBox),this._initLayoutFunc()}setLayout(t){this._option.layout=t,this._initLayoutFunc()}_initLayoutFunc(){var t,e,i;if(this._layoutFunc=this._option.layout,!this._layoutFunc){let r=iv.getLayoutInKey(null!=(e=null==(t=this._spec.layout)?void 0:t.type)?e:"base");if(r){let t=new r(this._spec.layout,{onError:null==(i=this._option)?void 0:i.onError});this._layoutFunc=t.layoutItems.bind(t)}}}layout(){var t,e,i,r;if(null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeLayoutWithSceneGraph)||e.call(t,this._option.globalInstance),this.getLayoutTag()){this._event.emit(rI.layoutStart,{chart:this,vchart:this._option.globalInstance}),this.onLayoutStart();let t=this.getLayoutElements();this._layoutFunc(this,t,this._layoutRect,this._viewBox),this._event.emit(rI.afterLayout,{elements:t,chart:this}),this.setLayoutTag(!1),this.onLayoutEnd(),this._event.emit(rI.layoutEnd,{chart:this,vchart:this._option.globalInstance})}null==(r=null==(i=this._option.performanceHook)?void 0:i.afterLayoutWithSceneGraph)||r.call(i,this._option.globalInstance)}onLayoutStart(){this.getAllModels().forEach(t=>t.onLayoutStart(this._layoutRect,this._viewRect))}onLayoutEnd(){this.getAllModels().forEach(t=>{"series"!==t.modelType&&t.onLayoutEnd()})}onEvaluateEnd(t){[...this._components,...this._regions,...this._series].forEach(e=>e.onEvaluateEnd(t))}onBeforeRender(){[...this._components,...this._regions,...this._series].forEach(t=>t.onBeforeRender())}getLayoutElements(){return this.getAllModels().map(t=>t.layout).filter(t=>!!t)}getModelById(t){let e=this._idMap.get(t);if(e&&e instanceof s0)return e}getModelByUserId(t){let e=this.getSeriesInUserId(t);if(e)return e;let i=this.getRegionsInUserId(t);return i||this.getComponentByUserId(t)||void 0}getAllMarks(){return Array.from(this._idMap.values()).filter(t=>t&&t instanceof od)}getMarkById(t){let e=this._idMap.get(t);if(e&&e instanceof od)return e}getMarkByUserName(t){return this.getAllMarks().filter(e=>e.name&&e.name===t)}updateData(t,e,i=!0,r){let n=this._dataSet.getDataView(t);n&&(n.markRunning(),n.parseNewData(e,r)),i&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(t=>t.onDataUpdate())}updateFullData(t,e=!0){ed(t).forEach(t=>{let e=this._dataSet.getDataView(t.id);e&&e.markRunning()}),ed(t).forEach(t=>{let e=this._dataSet.getDataView(t.id);e&&n6(e,t,!0)}),e&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(t=>t.onDataUpdate())}setCanvasRect(t,e){this._canvasRect={width:t,height:e}}getCanvasRect(){return this._canvasRect||(this._canvasRect=sN(this._spec,this._option,{width:se,height:si})),this._canvasRect}getSeriesData(t,e){return this._chartData.getSeriesData(t,e)}_transformSpecScale(){var t;let e=this._spec.scales?[...this._spec.scales]:[],i=e.find(t=>"color"===t.id),r=this.getColorScheme();if(!i&&(i={type:"ordinal",id:"color",domain:null,range:null},e.push(i),this._spec.color)){let t=this._spec.color;tq(t)?i.range=t:(Object.prototype.hasOwnProperty.call(t,"type")&&(i.type=t.type),Object.prototype.hasOwnProperty.call(t,"domain")&&(i.domain=t.domain),Object.prototype.hasOwnProperty.call(t,"range")&&(i.range=t.range),Object.prototype.hasOwnProperty.call(t,"specified")&&(i.specified=t.specified),Object.prototype.hasOwnProperty.call(t,"clamp")&&(i.clamp=t.clamp))}return(null==(t=i.range)?void 0:t.length)||(i.range=e4(r),i.rangeTheme=!0),e}_createGlobalScale(){this._globalScale=new fN(this._transformSpecScale(),this),this._modelOption.globalScale=this._globalScale}updateGlobalScaleDomain(){let t=new Set;this._series.forEach(e=>{let i=e.getSeriesKeys();i&&i.forEach(e=>t.add(e))});let e=Array.from(t);this._globalScale.updateScaleDomain(e)}updateGlobalScale(t){sj(t,this._globalScale.updateSpec(this._transformSpecScale()))}updateGlobalScaleTheme(){let t=this._globalScale.getScaleSpec("color"),e=this.getColorScheme();t.rangeTheme&&(t.range=e4(e),this._globalScale.getScale("color").range(t.range))}_getSpecKeys(t){let e={width:!0,height:!0};return Object.keys(t).filter(t=>!e[t]).sort()}updateSpec(t){let e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(this.setLayoutTag(!0,null,!1),t.type!==this.type)return e.reMake=!0,e;let i=this._getSpecKeys(this._spec);if(!t5(i,this._getSpecKeys(t)))return e.reMake=!0,e;for(let r=0;r<i.length;r++){let n=i[r];if(tq(this._spec[n])&&this._spec[n].length!==ed(t[n]).length)return e.reMake=!0,e}let r=this._spec;return this._spec=t,this.updateChartConfig(e,r),e.reMake||(this.updateGlobalScale(e),e.reMake||(this.updateRegionSpec(e),e.reMake||(this.updateComponentSpec(e),e.reMake||(this.updateSeriesSpec(e),e.reMake||(this.reInit(),this.updateDataSpec(),this.updateGlobalScaleDomain()))))),e}updateChartConfig(t,e){var i,r;this._paddingSpec=ek(null!=(i=this._spec.padding)?i:null==(r=this._option)?void 0:r.getTheme("padding")),this._updateLayoutRect(this._viewBox)}updateDataSpec(){this._spec.data&&this._chartData.updateData(this._spec.data,!1,!0)}updateRegionSpec(t){var e;(null==(e=this._spec)?void 0:e.region)&&(this._spec.region.length===this._regions.length?this._regions.forEach(e=>{sj(t,e.updateSpec(this._spec.region[e.getSpecIndex()]))}):t.reMake=!0)}updateComponentSpec(t){let e={},i={[rk.title]:!0,[rk.brush]:!0,[rk.indicator]:!0};for(let r in this._components.forEach(r=>{var n,s;if(r.type===rk.label||r.type===rk.totalLabel)return;i[r.type]&&(i[r.type]=!1);let l=r.specKey||r.type,a=null!=(n=this._spec[l])?n:{};tq(a)?(e[l]=e[l]||{specCount:a.length,componentCount:0},e[l].componentCount++,sj(t,r.updateSpec(null!=(s=a[r.getSpecIndex()])?s:{},a))):sj(t,r.updateSpec(a))}),e)if(Object.prototype.hasOwnProperty.call(e,r)){let i=e[r];i.componentCount!==i.specCount&&(t.reMake=!0)}let r=t=>t&&!1!==t.visible;Object.keys(i).forEach(e=>{if(i[e]){let i=this._spec[e];(tq(i)?i.some(r):r(i))&&(t.reMake=!0)}})}updateSeriesSpec(t){this._spec.series.length===this._series.length?this._series.forEach(e=>{let i=this._spec.series[e.getSpecIndex()];sj(t,e.updateSpec(i))}):t.reMake=!0}getCanvas(){var t,e;return null!=(e=null==(t=this.getCompiler())?void 0:t.getCanvas())?e:null}_updateLayoutRect(t){let e=this.getCanvasRect();if(t){this._viewBox=t;let{x1:i=0,y1:r=0,x2:n,y2:s}=t;e={width:n-i,height:s-r}}else this._viewBox={x1:0,y1:0,x2:e.width,y2:e.height};this._viewRect=e,this.padding=eA(this._paddingSpec,e,e),this._layoutRect.width=e.width-this.padding.left-this.padding.right,this._layoutRect.height=e.height-this.padding.top-this.padding.bottom,this._layoutRect.x=this.padding.left,this._layoutRect.y=this.padding.top,this._event.emit(rI.layoutRectUpdate,{chart:this})}setCurrentTheme(){this.updateChartConfig({change:!0,reMake:!1},this._spec),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,!1),this.updateGlobalScaleTheme(),this.reInit()}reInit(){[...this._regions,...this._series,...this._components].forEach(t=>{let e=t.getSpecInfo();e&&e.spec&&t.reInit(e.spec)})}clear(){this.getAllModels().forEach(t=>{var e;return null==(e=t.clear)?void 0:e.call(t)})}compile(){this.compileBackground(),this.compileLayout(),this.compileRegions(),this.compileSeries(),this.compileComponents()}afterCompile(){this.getAllRegions().forEach(t=>{var e;null==(e=t.afterCompile)||e.call(t)}),this.getAllSeries().forEach(t=>{var e;null==(e=t.afterCompile)||e.call(t)}),this.getAllComponents().forEach(t=>{var e;null==(e=t.afterCompile)||e.call(t)})}compileLayout(){let{width:t,height:e}=this.getCanvasRect();this.getCompiler().setSize(t,e)}compileBackground(){this._backgroundMark&&this._backgroundMark.compile()}compileRegions(){var t,e,i,r;null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeRegionCompile)||e.call(t,this._option.globalInstance),this.getAllRegions().forEach(t=>{t.compile()}),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterRegionCompile)||r.call(i,this._option.globalInstance)}compileSeries(){var t,e,i,r;null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeSeriesCompile)||e.call(t,this._option.globalInstance),this.getAllSeries().forEach(t=>{t.compile()}),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterSeriesCompile)||r.call(i,this._option.globalInstance)}compileComponents(){var t,e,i,r;null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeComponentCompile)||e.call(t,this._option.globalInstance),this.getAllComponents().forEach(t=>{t.compile()}),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterComponentCompile)||r.call(i,this._option.globalInstance)}release(){[...this._components,...this._regions,...this._series].forEach(t=>{t.beforeRelease()}),super.release(),this.clear(),[...this._components,...this._regions,...this._series].forEach(t=>{t.release()}),this._components=this._regions=this._series=[],this._spec={},this._dataSet=this._globalScale=this._layoutFunc=null,this._layoutTag=!1,this._idMap.clear()}onLayout(){this.layout()}updateState(t,e){let i=this.getAllSeries();for(let r in t){if(sD(t[r]))continue;let n=t[r],s={stateValue:r};s=tQ(n.filter)?Object.assign({filter:n.filter},s):Object.assign(Object.assign({},n.filter),s),n.level&&(s.level=n.level),i.forEach(t=>{t.getMarks().forEach(i=>{i.stateStyle[r]&&(e&&!e(t,i,r)||(i.state.changeStateInfo(s),i.updateMarkState(r)))})})}}setSelected(t,e,i){this._setStateInDatum(j.STATE_SELECTED,t,e,i)}setHovered(t,e,i){this._setStateInDatum(j.STATE_HOVER,t,e,i)}clearState(t){this._interaction.clearByState(t)}clearAllStates(){this._interaction.clearAllStates()}clearSelected(){this.clearState(j.STATE_SELECTED)}clearHovered(){this.clearState(j.STATE_HOVER)}_initEvent(){[rI.dataZoomChange,rI.scrollBarChange].forEach(t=>{this._event.on(t,({value:t})=>{this._disableMarkAnimation(["exit","update"]);let e=()=>{this._enableMarkAnimation(["exit","update"]),this._event.off(rE.AFTER_MARK_RENDER_END,e)};this._event.on(rE.AFTER_MARK_RENDER_END,e)})})}_enableMarkAnimation(t){this.getAllMarks().forEach(e=>e.enableAnimationByState(t))}_disableMarkAnimation(t){this.getAllMarks().forEach(e=>e.disableAnimationByState(t))}filterGraphicsByDatum(t,e={}){var i;let r=(t=t?ed(t):null)?Object.keys(t[0]):null,n=[],s=null!=(i=e.getDatum)?i:iZ;return this.getRegionsInQuerier(e.region).forEach(i=>{let l=[];t&&i.getSeries().forEach(a=>{a.getMarks().forEach(o=>{let h=o.getGraphics();if(h&&h.length&&(!e.filter||tQ(e.filter)&&e.filter(a,o)))if(iV(o.type))h.filter(h=>{let u=s(h,o,a,i);u&&t.every((t,e)=>r.every(i=>t[i]==u[e][i]))&&(l.push(h),n.push(h),e.callback&&e.callback(h,o,a,i))});else if(t.length>1){let u=t.slice();h.forEach(t=>{let h=s(t,o,a,i),d=h&&u.findIndex(t=>r.every(e=>t[e]==h[e]));d>=0&&(u.splice(d,1),l.push(t),n.push(t),e.callback&&e.callback(t,o,a,i))})}else{let u=h.find(e=>{let n=s(e,o,a,i);return n&&r.every(e=>t[0][e]==n[e])});u&&(l.push(u),n.push(u),e.callback&&e.callback(u,o,a,i))}})}),e.regionCallback&&e.regionCallback(l,i)}),n}_setStateInDatum(t,e,i,r){if(!e)return void this._interaction.clearByState(t);let n=this.filterGraphicsByDatum(e,{filter:i,region:r});this._interaction.updateStateOfGraphics(t,n)}setDimensionIndex(t,e){var i;let r=null;Array.from(this._event.getComposedEventMap().values()).forEach(i=>{let{eventType:n,event:s}=i;if(n===Z.dimensionHover||n===Z.dimensionClick){let i=s.dispatch(t,e);(null==i?void 0:i.length)&&(r=i)}});let n=er(t)||!r||r.every(t=>ll(t.axis.getScale().type)&&er(t.index));if(!1!==e.tooltip){let t=this.getComponentsByType(rk.tooltip)[0];if(null==t?void 0:t.getVisible())if(n)null==(i=t.hideTooltip)||i.call(t);else{let i={};r.forEach(t=>{let{axis:e,value:r,data:n}=t,s="left"===e.getOrient()||"right"===e.getOrient();n.forEach(t=>{var e,n,l;let a=s?t.series.fieldY[0]:t.series.fieldX[0];i[a]=null!=(l=null==(n=null==(e=t.datum)?void 0:e[0])?void 0:n[a])?l:r})}),t.showTooltip(i,e.showTooltipOption)}}if(!1!==e.crosshair){let t=this.getComponentsByType(rk.cartesianCrosshair)[0];t&&t.clearAxisValue&&t.setAxisValue&&(n?t.hideCrosshair():t.showCrosshair(r))}}getColorScheme(){var t,e;return null==(e=(t=this._option).getTheme)?void 0:e.call(t,"colorScheme")}}let fZ=(t,e)=>{let i={nodes:{}},{fields:r}=e;if(!(null==r?void 0:r.length))return i;let n=r.length-1,s,l=i;return t.forEach(t=>{t.latestData&&t.latestData.forEach(t=>{l=i;for(let e=0;e<r.length;e++){let i=r[e],a=t[i];if(er(a))break;l.groupField=i,l.nodes[a]||(e===n?l.nodes[a]={values:[]}:(s={nodes:{}},l.nodes[a]=s)),e===n?l.nodes[a].values.push(t):l=l.nodes[a]}})}),i};class fU{constructor(t,e){this.stackRegion=({model:t})=>{var e;let i=t.getSeries();if(!i.some(t=>t.getStack()))return;let r=i.some(t=>{var e,i,r,n;return!!(null==(i=null==(e=t.getSpec())?void 0:e.totalLabel)?void 0:i.alwayCalculateTotal)||(null==(n=null==(r=t.getSpec())?void 0:r.totalLabel)?void 0:n.visible)}),n=r||i.some(t=>t.getPercent()),s=i.some(t=>t.getStackOffsetSilhouette()),l=d$(t,!0);for(let e in l)for(let i in l[e].nodes)d0(l[e].nodes[i],t.getStackInverse(),n,r);if(s)for(let t in l)for(let e in l[t].nodes)dQ(l[t].nodes[e]);r&&t.getSeries().forEach(t=>{let e=t.getStackData(),i=t.getStackValue(),r=t.getStackValueField();e&&r&&dX(l[i],r)}),(null==(e=this._options)?void 0:e.afterStackRegion)&&this._options.afterStackRegion(t,l)},this._chart=t,this._options=e}init(){this._chart.getAllRegions().forEach(t=>{t.event.on(rI.regionSeriesDataFilterOver,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},this.stackRegion)})}stackAll(){this._chart.getAllRegions().forEach(t=>{this.stackRegion({model:t})})}}class fK{_beforeInit(){this._dataSet&&nq(this._dataSet,"stackSplit",fZ)}_initStack(){this._stack=new fU(this),this._stack.init()}}let f$={state:j.STATE_DIMENSION_HOVER,reverseState:j.STATE_DIMENSION_HOVER_REVERSE,trigger:Z.dimensionHover};class fY extends dp{constructor(t){super(t),this.type="dimension-hover",this._resetType=[],this.resetAll=()=>{let{state:t,reverseState:e,interaction:i}=this.options,r=i.getStatedGraphics(this);r&&r.length&&(i.clearAllStatesOfTrigger(this,t,e),this.dispatchEvent("reset",{graphics:r,options:this.options}),i.setStatedGraphics(this,[]))},this.handleStart=t=>{let e=this.options.interaction;switch(t.action){case"enter":let i=this.getStatedGraphics(t);e.updateStates(this,this.getStatedGraphics(t),e.getStatedGraphics(this),this.options.state,this.options.reverseState),e.setStatedGraphics(this,i);break;case"leave":e.clearAllStatesOfTrigger(this,this.options.state,this.options.reverseState),e.setStatedGraphics(this,[])}},this.options=Object.assign({},f$,t),this.updateMarkIdByState([this.options.state,this.options.reverseState])}getStartState(){return this.options.state}getResetState(){return this.options.reverseState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart}]}getStatedGraphics(t,e=!1){let i=this.getMarksByState(e?this.options.reverseState:this.options.state),r=[];return t.dimensionInfo.forEach(t=>{t.data.forEach(t=>{i.filter(e=>e.model===t.series&&e.getVisible()).forEach(i=>{let n=i.getGraphics();if(!n||!n.length)return;let s=n.filter(i=>{let r,n=iZ(i);return r=tq(n)?n.every((e,i)=>e===t.datum[i]):t.datum.some(t=>t===n),e?!r:r});r.push(...s)})})}),r}}fY.type="dimension-hover",fY.defaultOptions=f$;let fX=()=>{iv.registerInteractionTrigger(fY.type,fY)};class fq{constructor(t,e){this._eventDispatcher=t,this._mode=e}get chart(){var t,e;return this._chart||(this._chart=null==(e=(t=this._eventDispatcher.globalInstance).getChart)?void 0:e.call(t)),this._chart}register(t,e){var i,r;(null!=(r=null==(i=this.chart)?void 0:i.getOption().onError)?r:eD)("Method not implemented.")}unregister(){var t,e;(null!=(e=null==(t=this.chart)?void 0:t.getOption().onError)?e:eD)("Method not implemented.")}getTargetDimensionInfo(t,e){var i,r,n;let s=null!=(n=null==(r=(i=this.chart.getModelOption()).getDimensionInfo)?void 0:r.call(i,this.chart,{x:t,y:e}))?n:[];return 0===s.length?null:s}dispatch(t,e){var i,r;let n=null==(i=this.chart)?void 0:i.getAllComponents().filter(t=>"axes"===t.specKey&&(!(null==e?void 0:e.filter)||e.filter(t))),s=n.filter(t=>ll(t.getScale().type)),l=s.length?s:n.filter(t=>{let e=t.getOrient();return p0(e)||"angle"===e}),a=[],o=null==(r=this.chart)?void 0:r.getModelOption().getDimensionInfoByValue;return o&&l.forEach(e=>{let i=o(e,t);i&&a.push(i)}),this._callback.call(null,{action:"enter",dimensionInfo:a}),a}}let fJ=(t,e,i)=>t.x>=e.x&&t.x<=i.x&&t.y>=e.y&&t.y<=i.y,fQ=(t,e,i)=>{let r=t.getRegionsInIds(ed(e.layout.layoutBindRegionID));return null==r?void 0:r.some(t=>{let e=t.getLayoutRect(),r=t.getLayoutStartPoint();return fJ(i,{x:r.x,y:r.y},{x:e.width+r.x,y:e.height+r.y})})},f0=(t,e)=>{var i,r;return t===e||!er(t)&&!er(e)&&t.value===e.value&&(null==(i=t.axis)?void 0:i.id)===(null==(r=e.axis)?void 0:r.id)},f1=(t,e)=>{let i=t.tooltipFilterRange,r="function"==typeof i?i({scale:e}):i;return en(r)?[-r,r]:r},f2=(t,e,i,r)=>{var n;let s=e.getScale(),l=ll(s.type),a=[];for(let o of e.getOption().getChart().getSeriesInIndex(e.getSpecInfo().seriesIndexes))if(o.coordinate===i){let i=ed(r(o)),h=null==(n=o.getViewData())?void 0:n.latestData;if(i&&h)if(l){let e=[],r=[];h.forEach((n,s)=>{var l;(null==(l=n[i[0]])?void 0:l.toString())===(null==t?void 0:t.toString())&&(e.push(n),r.push(s))}),a.push({series:o,datum:e,key:f3(o,r)})}else if(t8(i[1])){let e=[],r=[];h.forEach((n,s)=>{var l;((null==(l=n[i[0]])?void 0:l.toString())===(null==t?void 0:t.toString())||t8(n[i[0]])&&t8(n[i[1]])&&t>=n[i[0]]&&t<n[i[1]])&&(e.push(n),r.push(s))}),a.push({series:o,datum:e,key:f3(o,r)})}else{let r=f1(e.getSpec(),s),n=[],l=[];if(r)h.forEach((e,s)=>{if(t8(e[i[0]])){let a=e[i[0]]-t;a>=r[0]&&a<=r[1]&&(n.push(e),l.push(s))}});else{let e=1/0,r=0;h.forEach((s,a)=>{if(t8(s[i[0]])){let o=Math.abs(s[i[0]]-t),h=Math.sign(s[i[0]]-t);o<e?(e=o,n=[s],l=[a],r=h):o===e&&h===r&&(n.push(s),l.push(a))}})}a.push({series:o,datum:n,key:f3(o,l)})}}return a},f3=(t,e)=>`${t.id}_${e.join("_")}`,f5=(t,e,i)=>{let r=t.getAllComponents().filter(r=>"axes"===r.specKey&&e(r)&&fQ(t,r,i));return r.length?r:null};class f4 extends fq{constructor(){super(...arguments),this._cacheDimensionInfo=null,this.onMouseMove=t=>{if(!t)return;let e=t.event.viewX,i=t.event.viewY,r=this.getTargetDimensionInfo(e,i);null===r&&null!==this._cacheDimensionInfo?(this._callback.call(null,Object.assign(Object.assign({},t),{action:"leave",dimensionInfo:this._cacheDimensionInfo.slice()})),this._cacheDimensionInfo=r):null!==r&&(null===this._cacheDimensionInfo||r.length!==this._cacheDimensionInfo.length||r.some((t,e)=>!f0(t,this._cacheDimensionInfo[e])))?(this._callback.call(null,Object.assign(Object.assign({},t),{action:"enter",dimensionInfo:r.slice()})),this._cacheDimensionInfo=r):null!==r&&this._callback.call(null,Object.assign(Object.assign({},t),{action:"move",dimensionInfo:r.slice()}))},this.onMouseOut=t=>{t&&(this._callback.call(null,Object.assign(Object.assign({},t),{action:"leave",dimensionInfo:this._cacheDimensionInfo?this._cacheDimensionInfo.slice():[]})),this._cacheDimensionInfo=null)}}register(t,e){this._callback=e.callback,this._eventDispatcher.register("pointermove",{query:Object.assign(Object.assign({},e.query),{source:rL.chart}),callback:this.onMouseMove}),this._eventDispatcher.register("pointerout",{query:Object.assign(Object.assign({},e.query),{source:rL.canvas}),callback:this.onMouseOut}),eI(this._mode)&&this._eventDispatcher.register("pointerdown",{query:Object.assign(Object.assign({},e.query),{source:rL.chart}),callback:this.onMouseMove})}unregister(){this._eventDispatcher.unregister("pointermove",{query:null,callback:this.onMouseMove}),eI(this._mode)&&this._eventDispatcher.unregister("pointerdown",{query:null,callback:this.onMouseMove})}}class f6 extends fq{constructor(){super(...arguments),this.onClick=t=>{if(!t)return;let e=t.event.viewX,i=t.event.viewY,r=this.getTargetDimensionInfo(e,i);r&&this._callback.call(null,Object.assign(Object.assign({},t),{action:"click",dimensionInfo:r.slice()}))}}register(t,e){this._callback=e.callback,this._eventDispatcher.register("pointertap",{query:Object.assign(Object.assign({},e.query),{source:rL.chart}),callback:this.onClick})}unregister(){this._eventDispatcher.unregister("pointertap",{query:null,callback:this.onClick})}}let f8=()=>{iv.registerComposedEvent(Z.dimensionHover,f4),iv.registerComposedEvent(Z.dimensionClick,f6)},f9=t=>t.fieldX[0],f7=t=>t.fieldY[0],mt=t=>{var e;return[t.fieldX[0],null!=(e=t.fieldX2)?e:t.fieldX[1]]},me=t=>{var e;return[t.fieldY[0],null!=(e=t.fieldY2)?e:t.fieldY[1]]},mi=(t,e)=>t?e?f9:mt:e?f7:me,mr=(t,e,i)=>{var r,n;if(!t)return null;let{x:s,y:l}=e,a=null!=(r=f5(t,t=>p0(t.getOrient()),e))?r:[],o=null!=(n=f5(t,t=>p1(t.getOrient()),e))?n:[];if(!a.length&&!o.length)return null;let h=new Set,u=new Set,d=new Set;[a,o].forEach(t=>t.forEach(t=>{ll(t.getScale().type)?h.add(t):u.add(t),i&&t.getSpec().hasDimensionTooltip&&d.add(t)}));let c=[],p=t=>{let e="x"===t,i=e?s:l;(e?a:o).forEach(t=>{if(d.size>0){if(d.has(t)){let r=mn(t,i,mi(e,ll(t.getScale().type)));r&&c.push(r)}}else{let r=h.size>0;if((r?h:u).has(t)){let n=mn(t,i,mi(e,r));n&&c.push(n)}}})};return"horizontal"===t.getSpec().direction?(p("y"),0===c.length&&p("x")):(p("x"),0===c.length&&p("y")),c.length?c:null},mn=(t,e,i)=>{let r=t.positionToData(e,!0);return er(r)?null:ms(t,r,i)},ms=(t,e,i)=>{let r=t.getScale();if(er(e))return null;let n=r.domain().findIndex(t=>(null==t?void 0:t.toString())===e.toString());n<0&&(n=void 0);let s=f2(e,t,"cartesian",null!=i?i:p0(t.getOrient())?f9:f7);return{index:n,value:e,position:r.scale(e),axis:t,data:s}},ml=(t,e,i,r=!1)=>(i||(i={x:0,y:0}),Object.keys(t).forEach(n=>{var s,l,a,o,h,u;let d,{currentValue:c,cacheInfo:p,labelsComp:g,attributes:f,coordKey:m}=t[n],y=null,v=0,b=null;if(c.size){let t=Array.from(c.values())[0];v=t.axis.getScale().scale(t.datum)+t.axis.getLayoutStartPoint()[m]-i[m],b=null==(u=null==(h=null==(o=null==(a=null==(l=null==(s=(y=t.axis).getVRenderComponents()[0])?void 0:s.children[0])?void 0:l.children[0])?void 0:a.children[0])?void 0:o.getChildByName("axis-label-container"))?void 0:h.getChildByName("axis-label-container-layer-0"))?void 0:u.children[0]}let _=!!c.size&&Number.isFinite(v)&&!Number.isNaN(v),x=r&&!_&&t8(p),C=x?p:{coordRange:[0,0],sizeRange:[0,0],coord:v,labelsTextStyle:{},labels:g?Object.keys(g).reduce((t,e)=>(t[e]={visible:!1,text:"",dx:0,dy:0},t),{}):null,visible:_,axis:y,axisLabel:b};C&&(C._isCache=x);let w=0;if(f&&c.forEach(({axis:t,datum:i=""})=>{var r,s,l,a,o,h,u,c,p,g;let m=null,y=t.getScale();if(ll(y.type))0===(d=y.bandwidth())&&y.step&&(w=y.step());else if(ls(y.type)){let r="xField"===n?e.fieldX[0]:e.fieldY[0],s="xField"===n?e.fieldX2:e.fieldY2,l=function(t,e,i,r){for(let n=0,s=t.length;n<s;n++){let s=t[n];if(s){let t=s[i],n=s[r||i];if(t<=e&&n>=e)return s}}return null}(e.getViewData().latestData,+i,r,s);if(l){let t="xField"===n?e.dataToPositionX(l):e.dataToPositionY(l);s?(d=Math.abs(t-("xField"===n?e.dataToPositionX1(l):e.dataToPositionY1(l))),i=`${l[r]} ~ ${l[s]}`):d=1,v=t}m=t.niceLabelFormatter}if(C&&(null==(r=f.label)?void 0:r.visible)&&!x){let e=gp(t.getSpec()),r=t.getOrient(),n=null==(s=f.label)?void 0:s.syncAxisLabelAngle;C.labels[r]&&(C.labels[r].visible=!0,C.labels[r].text=i,"left"===r?(C.labels[r].dx=-e,C.labelsTextStyle[r]={textAlign:n&&b&&null!=(l=b.attribute.textAlign)?l:"right",textBaseline:n&&b&&null!=(a=b.attribute.textBaseline)?a:"middle"}):"right"===r?(C.labels[r].dx=e,C.labelsTextStyle[r]={textAlign:n&&b&&null!=(o=b.attribute.textAlign)?o:"left",textBaseline:n&&b&&null!=(h=b.attribute.textBaseline)?h:"middle"}):"top"===r?(C.labels[r].y=0,C.labels[r].dy=-e,C.labelsTextStyle[r]={textAlign:n&&b&&null!=(u=b.attribute.textAlign)?u:"center",textBaseline:n&&b&&null!=(c=b.attribute.textBaseline)?c:"bottom"}):"bottom"===r&&(C.labels[r].dy=e,C.labelsTextStyle[r]={textAlign:n&&b&&null!=(p=b.attribute.textAlign)?p:"center",textBaseline:n&&b&&null!=(g=b.attribute.textBaseline)?g:"top"}),C.labels[r].defaultFormatter=m)}}),C&&!x){let t={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};mo(t,c),"xField"===n?(C.coordRange=[t.x1,t.x2],C.sizeRange=[t.y1,t.y2],C.coord=v+i.x,C.labels&&(C.labels.top.y=t.y1,C.labels.bottom.y=t.y2)):(C.coordRange=[t.y1,t.y2],C.sizeRange=[t.x1,t.x2],C.coord=v+i.y,C.labels&&(C.labels.left.x=t.x1,C.labels.right.x=t.x2)),(C.coord<C.coordRange[0]||C.coord>C.coordRange[1])&&(C.visible=!1),f&&f.label&&Object.keys(C.labels).forEach(t=>{C.labels[t].visible&&ma(C.labels[t],t,f.label)})}t[n].bandSize=null!=d?d:0,t[n].offsetSize=w,t[n].cacheInfo=C}),t),ma=(t,e,i)=>{let{formatMethod:r,formatter:n}=i,{formatFunc:s,args:l}=d4(r,n,t.text,{label:t.text,position:e});s?t.text=s(...l):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))},mo=(t,e)=>{e.forEach(({axis:e})=>{e.getRegions().forEach(e=>{let{x:i,y:r}=e.getLayoutStartPoint(),{width:n,height:s}=e.getLayoutRect();t.x1=Math.min(t.x1,i),t.y1=Math.min(t.y1,r),t.x2=Math.max(t.x2,i+n),t.y2=Math.max(t.y2,r+s)})})},mh=t=>{let e,{cacheInfo:i,attributes:r,bandSize:n,offsetSize:s,coordKey:l,anotherAxisKey:a}=t,{coord:o,sizeRange:h}=i,u=r.type;if("line"===u){let t=o+n/2;e={visible:!0,start:{[l]:t,[a]:h[0]},end:{[l]:t,[a]:h[1]}}}else if("rect"===u){let[t,u]=mu(r,n,s,i.axis),{coordRange:d}=i;e={visible:!0,start:{[l]:Math.max(o+t,d[0]),[a]:h[0]},end:{[l]:Math.min(o+u,d[1]),[a]:h[1]}}}return e},mu=(t,e,i,r)=>{var n,s,l;let a=0===e?i:e,o=a;if(null==(n=t.style)?void 0:n.sizePercent)o=a*t.style.sizePercent;else if("number"==typeof(null==(s=t.style)?void 0:s.size))o=t.style.size;else if("function"==typeof(null==(l=t.style)?void 0:l.size)){let e=r.getLayoutRect();o=t.style.size(e,r)}return 0===e?[-o/2,o/2]:[e/2-o/2,o/2+e/2]},md=(t,e)=>{var i;let r=new Map,n=new Map,{series:s,datum:l}=t,a="horizontal"===s.direction,o=(a?s.getYAxisHelper():s.getXAxisHelper()).getAxisId(),h=s.getChart().getComponentsByKey("axes").find(t=>t.id===o);if(!h)return;(a?n:r).set(h.getSpecIndex(),{datum:null==(i=s.getDatumPositionValues(l[0],s.getDimensionField()))?void 0:i[0],axis:h});let u={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:r,attributes:{visible:!!r.size,type:"rect"}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:n,attributes:{visible:!!n.size,type:"rect"}}};return ml(u,s,e),u.xField.cacheInfo?mh(u.xField):u.yField.cacheInfo?mh(u.yField):void 0},mc=["updateTitle","updateContent","updatePosition","maxLineCount","othersLine"],mp=(t,e,i,r,n)=>{var s,l,a;let o={activeType:t};switch(t){case"mark":case"group":if(i){let a=null==(s=i.getSpec())?void 0:s.tooltip;return o.visible=!0,(null==a?void 0:a.handler)&&(o.handler=a.handler),(null==(l=o.handler)?void 0:l.showTooltip)?o:((null==a?void 0:a[t])&&mc.forEach(e=>{t8(a[t][e])&&(o[e]=a[t][e])}),Object.assign(Object.assign({},o),i.tooltipHelper.getTooltipData(t,e,r,r[0].datum,n)))}break;case"dimension":if(null==r?void 0:r.length){if(mg(r).every(t=>{var e;return!ce("dimension",null==(e=t.tooltipHelper)?void 0:e.spec)})?o.visible=!1:o.visible=!0,o.handler=e.handler,null==(a=o.handler)?void 0:a.showTooltip)return o;let i=[];return r.forEach(s=>s.data.forEach(s=>{let{series:l}=s,a=l.tooltipHelper.getTooltipData(t,e,r,s.datum,n);a&&i.push(a)})),function(t){if(!t||!t.length)return null;let e=[];return t.forEach(({content:t})=>{t&&t.forEach(t=>{e.push(t)})}),e.length?Object.assign(Object.assign({},t[0]),{content:e}):t[0]}(i)}}return null},mg=t=>{let e=[];return t.forEach(t=>{t.data.forEach(t=>{t8(t.series)&&e.push(t.series)})}),e},mf={dom:`${st}_TOOLTIP_HANDLER_DOM`,canvas:`${st}_TOOLTIP_HANDLER_CANVAS`},mm={key:"其他",value:"..."};(T=Y||(Y={})).group="group",T.mark="mark",T.dimension="dimension";class my{constructor(t){this._showTooltipByHandler=(t,e)=>{var i,r,n;let s;if(er(t))return 1;e.changePositionOnly||this.clearCache(),this._updateViewSpec(t,e);let l=this._cacheActiveSpec;if(er(l)||!1===l.visible)return 1;e.tooltipSpec=this.component.getSpec(),e.activeTooltipSpec=l;let{title:a,content:o}=l,h=er(null==a?void 0:a.key)&&er(null==a?void 0:a.value)&&!(null==o?void 0:o.length);return(this.component.event.emit(rI.tooltipShow,Object.assign(Object.assign({},e),{isEmptyTooltip:h,tooltipData:t,activeType:this.activeType,tooltip:this.component})),h)?1:((null==(i=l.handler)?void 0:i.showTooltip)?s=l.handler.showTooltip.bind(l.handler):(null==(r=this.component.tooltipHandler)?void 0:r.showTooltip)&&(s=this.component.tooltipHandler.showTooltip.bind(this.component.tooltipHandler)),s?null!=(n=s(this.activeType,t,e))?n:0:1)},this.component=t}_preprocessDimensionInfo(t){let e=[];if(null==t||t.forEach(t=>{let i=Object.assign(Object.assign({},t),{data:t.data.filter(({series:t})=>{var e,i;return!1!==(null==(i=null==(e=t.getSpec())?void 0:e.tooltip)?void 0:i.visible)})});i.data.length>0&&e.push(i)}),e.length>0)return e}_updateViewSpec(t,e){var i,r,n,s,l,a,o,h,u;let{changePositionOnly:d,model:c}=e;if(!d||!this._cacheActiveSpec){let d=this.component.getSpec();if(this._cacheActiveSpec=mp(this.activeType,this.component.getSpec(),c,t,e),this._cacheActiveSpec){er(this._cacheActiveSpec.handler)&&t8(d.handler)&&(this._cacheActiveSpec.handler=d.handler);let c=null!=(i=d[this.activeType])?i:{},p=null!=(r=this._cacheActiveSpec.updateTitle)?r:c.updateTitle,g=null!=(n=this._cacheActiveSpec.updateContent)?n:c.updateContent,f=null!=(l=null!=(s=this._cacheActiveSpec.maxLineCount)?s:c.maxLineCount)?l:20;if(p&&(this._cacheActiveSpec.title=null!=(a=p(this._cacheActiveSpec.title,t,e))?a:this._cacheActiveSpec.title),g)this._cacheActiveSpec.content=null!=(o=g(this._cacheActiveSpec.content,t,e))?o:this._cacheActiveSpec.content;else if(f>=1&&(null==(h=this._cacheActiveSpec.content)?void 0:h.length)>f){let t=null!=(u=this._cacheActiveSpec.othersLine)?u:c.othersLine,e=t?Object.assign(Object.assign({},mm),t):mm;this._cacheActiveSpec.content=[...this._cacheActiveSpec.content.slice(0,f-1),Object.assign(Object.assign({},this._cacheActiveSpec.content[f-1]),e)]}}}}shouldHandleTooltip(t,e){var i,r;return!er(e)&&ce(this.activeType,null==(r=null==(i=t.model)?void 0:i.tooltipHelper)?void 0:r.spec)}clearCache(){this._cacheActiveSpec=void 0}}class mv extends my{constructor(){super(...arguments),this.activeType="dimension"}showTooltip(t,e,i){let r=Object.assign(Object.assign({},e),{dimensionInfo:this._preprocessDimensionInfo(t),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(t,r)}_getDimensionInfo(t){var e,i,r;let n,s=this.component.getChart(),l=s.getCompiler().getStage().getLayer(void 0),a={x:t.event.viewX,y:t.event.viewY};if(l.globalTransMatrix.transformPoint({x:t.event.viewX,y:t.event.viewY},a),0===(n=null!=(r=null==(i=(e=this.component.getOption()).getDimensionInfo)?void 0:i.call(e,s,a,!0))?r:[]).length)n=void 0;else if(n.length>1){let t=n.filter(t=>{var e;let i,r=t.axis;if(r.getSpec().hasDimensionTooltip)return!0;if(!ll(r.getScale().type))return!1;for(let t of null!=(e=null==r?void 0:r.getRegions())?e:[]){for(let e of t.getSeries())if("cartesian"===e.coordinate){i=e;break}if(t8(i))break}return t8(i)&&i.getDimensionField()[0]===i.fieldY[0]?"left"===r.getOrient()||"right"===r.getOrient():"bottom"===r.getOrient()||"top"===r.getOrient()});if((n=t.length?t:n.slice(0,1)).length>1){let t=new Set;n.forEach(e=>{e.data=e.data.filter(({key:e})=>!t.has(e)&&(t.add(e),!0))})}}return n}getMouseEventData(t){return{tooltipInfo:this._getDimensionInfo(t),ignore:!1}}}let mb=()=>{iv.registerTooltipProcessor("dimension",mv)};class m_ extends my{constructor(){super(...arguments),this.activeType="mark"}showTooltip(t,e,i){var r,n,s;let{datum:l,series:a}=t,o=this.component.getSpec(),h=[{datum:[l],series:a}],u=a.tooltipHelper,d=null==(r=a.getSpec())?void 0:r.tooltip,c=null==(n=null==d?void 0:d.mark)?void 0:n.checkOverlap,p=!1;if(!0===c||!0===(null==(s=o.mark)?void 0:s.checkOverlap)&&!1!==c){let t=null==u?void 0:u.activeTriggerSet.mark;if(t){p=!0;let i=this.component.getChart().getCompiler().getStage().getLayer(void 0),r={x:e.event.viewX,y:e.event.viewY};i.globalTransMatrix.transformPoint({x:e.event.viewX,y:e.event.viewY},r),t.forEach(t=>{t.getGraphics().forEach(t=>{t!==e.node&&t&&t.containsPoint(r.x,r.y,a$.LZ.GLOBAL,t.stage.getPickerService())&&h[0].datum.push(iZ(t))})})}}let g=Object.assign(Object.assign({},e),{model:a,changePositionOnly:i,tooltip:this.component});if(i&&p){let t=this._cacheActiveSpec&&this._cacheActiveSpec.data;t&&t[0].series===h[0].series&&t[0].datum.length===h[0].datum.length&&!t[0].datum.some((t,e)=>t!==h[0].datum[e])||(g.changePositionOnly=!1)}return this._showTooltipByHandler(h,g)}getMouseEventData(t){var e;let i,r,n=null==(e=t.model)?void 0:e.modelType;if("series"===n){let e=t.model,n=e.tooltipHelper,s=null==n?void 0:n.activeTriggerSet.mark,l=null==n?void 0:n.ignoreTriggerSet.mark;(null==s?void 0:s.has(t.mark))?i={mark:t.mark,datum:t.datum,series:e}:(null==l?void 0:l.has(t.mark))&&(r=!0)}else if("component"===n){let e=t.model,n=t.node;if("label"===e.name&&n){let t=e.getLabelInfoByTextGraphic(n),{baseMark:s,series:l,labelMark:a}=null!=t?t:{},o=l.tooltipHelper,h=null==o?void 0:o.activeTriggerSet.mark,u=null==o?void 0:o.ignoreTriggerSet.mark;(null==h?void 0:h.has(a))?i={mark:s,datum:n.attribute.data,series:l}:(null==u?void 0:u.has(a))&&(r=!0)}}return{tooltipInfo:i,ignore:r}}}let mx=()=>{iv.registerTooltipProcessor("mark",m_)};class mC extends my{constructor(){super(...arguments),this.activeType="group"}showTooltip(t,e,i){let{datum:r,series:n}=t,s=[{datum:ed(r),series:n}],l=Object.assign(Object.assign({},e),{groupDatum:this._getGroupDatum(e),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(s,l)}getMouseEventData(t){var e,i;let r;if("series"===(null==(e=t.model)?void 0:e.modelType)){let e=t.model,n=e.tooltipHelper,s=null==n?void 0:n.activeTriggerSet.group;if(null==s?void 0:s.has(t.mark)){let n=this.component.getSpec()[this.activeType];((null==n?void 0:n.triggerMark)?ed(n.triggerMark):[]).includes(null==(i=t.mark)?void 0:i.name)&&(r={mark:t.mark,datum:t.datum,series:e})}}return{tooltipInfo:r,ignore:!1}}_getGroupDatum(t){let{model:e,mark:i,datum:r}=t;if(["line","area"].includes(i.type))return ed(r);let n=e.getViewData().latestData,s=e.getSeriesField();if(!s)return n;let l=ed(r)[0][s];return n.filter(t=>t[s]===l)}}let mw=()=>{iv.registerTooltipProcessor("group",mC)};class mS extends fV{constructor(){super(...arguments),this.transformerConstructor=fz,this.type="line",this.seriesType=rR.line}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}mS.type="line",mS.seriesType=rR.line,mS.transformerConstructor=fz,cG(mS,fK);let mA=()=>{mb(),mx(),mw(),f8(),fX(),fL(),iv.registerChart(mS.type,mS)};var mM=i(26670);let mk=["segments","points","curveType","curveTension",...mM.DH];class mT extends mM.zs{constructor(t){super(t),this.type="area",this.numberType=o$.Ri}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;let{points:t,segments:e}=this.attribute;return e?0!==e.length:!!t&&0!==t.length}getGraphicTheme(){return(0,up.gh)(this).area}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateAreaAABBBoundsBySegments(t,e,i):this.updateAreaAABBBoundsByPoints(t,e,i)),aB.w.graphicService.updateTempAABBBounds(i),this.setWidthHeightWithoutTransform(i);let{lineJoin:r=e.lineJoin}=t;return aB.w.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}updateAreaAABBBoundsByPoints(t,e,i,r){let{points:n=e.points}=t;return n.forEach(t=>{var e,r;i.add(t.x,t.y),i.add(null!=(e=t.x1)?e:t.x,null!=(r=t.y1)?r:t.y)}),i}updateAreaAABBBoundsBySegments(t,e,i,r){let{segments:n=e.segments}=t;return n.forEach(t=>{t.points.forEach(t=>{var e,r;i.add(t.x,t.y),i.add(null!=(e=t.x1)?e:t.x,null!=(r=t.y1)?r:t.y)})}),i}_interpolate(t,e,i,r,n){"points"===t&&(n.points=(0,hl.SA)(i,r,e))}needUpdateTags(t){return super.needUpdateTags(t,mk)}needUpdateTag(t){return super.needUpdateTag(t,mk)}toCustomPath(){let t=super.toCustomPath();if(t)return t;t=new a_.r;let e=this.attribute,i=e.segments,r=e=>{if(e&&e.length){let i=!0,r=[];if(e.forEach(e=>{var n,s;!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),r.push({x:null!=(n=e.x1)?n:e.x,y:null!=(s=e.y1)?s:e.y}),i=!1)}),r.length){for(let e=r.length-1;e>=0;e--)t.lineTo(r[e].x,r[e].y);t.closePath()}}};return e.points?r(e.points):i&&i.length&&i.forEach(t=>{r(t.points)}),t}clone(){return new mT(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return mT.NOWORK_ANIMATE_ATTR}}function mR(t){return new mT(t)}mT.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},mM.Wl);var mB=i(7246),mP=i(56229),mE=i(879),mI=i(13950);let mL=!1,mF=new oC.n(t=>{mL||(mL=!0,t(mB.j).toSelf().inSingletonScope(),t(oY.Gs).to(mB.j).inSingletonScope(),t(oY.uz).toService(oY.Gs),t(mE.Gq).toService(mP.Sg),(0,oN.yb)(t,mE.Gq),t(mI.K).toSelf().inSingletonScope())});var mO=i(73636);let mD=class extends oX.o{constructor(t){super(),this.canvasRenderer=t,this.type="area",this.numberType=o$.Ri}};mD=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(R=(0,oI.f)(oY.Gs),function(t,e){R(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mD);let mH=!1,mz=new oC.n((t,e,i,r)=>{mH||(mH=!0,t(oG.CV).to(mD).inSingletonScope(),t(oG.EL).toService(oG.CV))});function mW(){mW.__loaded||(mW.__loaded=!0,c0.i.RegisterGraphicCreator("area",mR),o_.n.load(mF),o_.n.load(mO.X?mz:oQ))}mW.__loaded=!1;let mN=[...cY,"fill","fillOpacity","background","texture","texturePadding","textureSize","textureColor"];class mj extends cX{constructor(){super(...arguments),this.type=mj.type,this._isValidPointChannel=t=>["x","y","x1","y1","defined"].includes(t)}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}_getSegmentAttributes(){return mN}_getIgnoreAttributes(){return[]}}mj.type="area";let mG=()=>{iv.registerMark(mj.type,mj),(0,oc.W)(),mW(),pF(),pH(),di(),iv.registerGraphicComponent("area",mR)};class mV extends cs{constructor(){super(...arguments),this._getSeriesStyle=(t,e,i)=>{var r,n,s,l;for(let i of ed(e)){let e=null==(r=this.series.getSeriesStyle(t))?void 0:r(i);if(!1!==e||"fill"!==i&&"stroke"!==i||(e="fill"===i?null==(s=null==(n=this.series.getSeriesStyle(t))?void 0:n("stroke"))?void 0:s[0]:null==(l=this.series.getSeriesStyle(t))?void 0:l("fill")),t8(e))return e}return i}}}let mZ=Object.assign(Object.assign(Object.assign({},cy),cN),{area:{name:"area",type:"area"}}),mU=()=>{u9(),u8(),u3()};class mK extends pZ{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){var e,i,r;let n=!1!==(null==(e=t.point)?void 0:e.visible)&&!1!==(null==(r=null==(i=t.point)?void 0:i.style)?void 0:r.visible);this._addMarkLabelSpec(t,t=>{let e="inside-middle"===t.position;return!n||e?"area":"point"}),this._addMarkLabelSpec(t,"area","areaLabel","initLineLabelMarkStyle",void 0,!0)}_transformSpecAfterMergingTheme(t,e,i){var r,n,s,l,a;super._transformSpecAfterMergingTheme(t,e,i);let{area:o={},line:h={},seriesMark:u}=t,d=!1!==o.visible&&!1!==(null==(r=o.style)?void 0:r.visible),c=!1!==h.visible&&!1!==(null==(n=h.style)?void 0:n.visible);o.support3d=!(!o.support3d&&!h.support3d),o.zIndex=t8(o.zIndex)||t8(h.zIndex)?Math.max(null!=(s=o.zIndex)?s:0,null!=(l=h.zIndex)?l:0):void 0,o.style&&delete o.style.stroke,o.state&&Object.keys(o.state).forEach(t=>{"style"in o.state[t]?delete o.state[t].style.stroke:delete o.state[t].stroke});let p=o,g=h;("line"===u||c&&!d)&&(p=h,g=o),o.style=ir({},g.style,p.style),o.state=ir({},g.state,p.state),!1===o.interactive&&(o.style.fillPickable=!1),!1===h.interactive&&(h.style.strokePickable=!1),o.interactive=!(!o.interactive&&null!=(a=h.interactive)&&!a),t.area=o,t.line=h}}class m$ extends cD{constructor(){super(...arguments),this.type=rR.area,this.transformerConstructor=mK,this._sortDataByAxis=!1}initMark(){var t;let e=null!=(t=this._spec.seriesMark)?t:"area",i=this._isAreaVisible()||this._isLineVisible();this._areaMark=this._createMark(m$.mark.area,{groupKey:this._seriesField,isSeriesMark:i&&"point"!==e},{morphElementKey:this.getDimensionField()[0]}),this.initSymbolMark("point"===e)}initMarkStyle(){this.initAreaMarkStyle(),this.initSymbolMarkStyle()}initAreaMarkStyle(){var t,e,i,r,n;let s=null!=(i=null==(e=null==(t=this.getSpec().area)?void 0:t.style)?void 0:e.curveType)?i:null==(n=null==(r=this.getSpec().line)?void 0:r.style)?void 0:n.curveType,l=s===cH?"horizontal"===this._direction?"monotoneY":"monotoneX":s,a=this._areaMark;if(a){let t=this._isAreaVisible(),e=this._isLineVisible();t||e?a.setVisible(!0):a.setVisible(!1),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:t=>{var e,i;return aa(this.dataToPositionX1(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),y1:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,orient:this._direction},"normal",W.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:this.dataToPositionX.bind(this),y1:t=>{var e,i;return aa(this.dataToPositionY1(t),null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",W.Series),this.setMarkStyle(a,{fill:!!t&&this.getColorAttribute(),stroke:!!e&&this.getColorAttribute()},"normal",W.Series),"zero"!==this._invalidType&&this.setMarkStyle(a,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",W.Series),this.getStack()&&this.setMarkStyle(a,{zIndex:t=>-t[su]},"normal",W.Series),this.setMarkStyle(a,{curveType:l},"normal",W.Built_In),Object.keys(a.stateStyle).forEach(t=>{a.stateStyle[t].stroke&&a.setPostProcess("stroke",t=>[t,!1,!1,!1],t)})}}initAnimation(){var t,e,i,r;let n={direction:this.direction},s=null==(t=this._spec.animationAppear)?void 0:t.preset;if(this._lineMark&&this._lineMark.setAnimationConfig(cA(null==(e=iv.getAnimationInKey("line"))?void 0:e(n,s),cM("line",this._spec,this._markAttributeContext))),this._areaMark&&this._areaMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("area"))?void 0:i(n,s),cM("area",this._spec,this._markAttributeContext))),this._symbolMark){let t=cO(this);this._symbolMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("scaleInOut"))?void 0:r(),cM("point",this._spec,this._markAttributeContext),t))}}_isAreaVisible(){var t;let e=this._spec.area||{};return!1!==e.visible&&!1!==(null==(t=e.style)?void 0:t.visible)}_isLineVisible(){var t;let e=this._spec.line||{};return!1!==e.visible&&!1!==(null==(t=e.style)?void 0:t.visible)}initTooltip(){this._tooltipHelper=new mV(this);let{group:t,mark:e}=this._tooltipHelper.activeTriggerSet;this._areaMark&&t.add(this._areaMark),this._lineMark&&t.add(this._lineMark),this._symbolMark&&(e.add(this._symbolMark),t.add(this._symbolMark))}viewDataStatisticsUpdate(t){super.viewDataStatisticsUpdate(t),this.encodeDefined(this._areaMark,"defined")}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}onLayoutEnd(){super.onLayoutEnd(),this.reCompileSampling()}getSeriesStyle(t){return e=>{var i,r,n,s,l;let a=null!=(i=this._spec.seriesMark)?i:"area",o=null!=(n=null==(r=this._seriesMark)?void 0:r.getAttribute(e,t))?n:void 0;return"fill"!==e||o&&"line"!==a||(e="stroke",o=null!=(l=null==(s=this._seriesMark)?void 0:s.getAttribute(e,t))?l:void 0),"stroke"===e&&tq(o)?o[0]:o}}}m$.type=rR.area,m$.builtInTheme={area:{label:{visible:!1,offset:5,position:"top",style:{stroke:{type:"palette",key:"backgroundColor"},lineWidth:2}},point:{style:{symbolType:"circle"}},seriesMark:"area"}},m$.mark=mZ,m$.transformerConstructor=mK,cG(m$,cj);let mY=()=>{fE(),fw(),pW(),mG(),pV(),mU(),fl(),fb(),iv.registerSeries(m$.type,m$)};class mX extends fH{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["point","line","area","seriesMark","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","areaLabel","useSequentialAnimation"])}transformSpec(t){super.transformSpec(t),sW(t)}}class mq extends fV{constructor(){super(...arguments),this.transformerConstructor=mX,this.type="area",this.seriesType=rR.area}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}mq.type="area",mq.seriesType=rR.area,mq.transformerConstructor=mX,cG(mq,fK);let mJ=()=>{mb(),mx(),mw(),fX(),mY(),f8(),iv.registerChart(mq.type,mq)};function mQ(t,e=!0){return(i,r,n)=>{let s="vertical"===t.direction?t.yField:t.xField,l=null==i?void 0:i[s];return"vertical"===t.direction?{overall:e?t.growFrom():e,orient:l>0?"negative":"positive"}:{overall:!!e&&t.growFrom(),orient:l>0?"positive":"negative"}}}let m0=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:mQ(t,e)}),m1=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:mQ(t,e)}),m2={type:"fadeIn"},m3={type:"growCenterIn"};function m5(t,e){if(!1===e)return{};switch(e){case"fadeIn":return m2;case"scaleIn":return m3;default:return m0(t)}}let m4=()=>{iv.registerAnimation("bar",(t,e)=>({appear:m5(t,e),enter:m0(t,!1),exit:m1(t,!1),disappear:m1(t)}))};var m6=i(86972),m8=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class m9 extends pR{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cQ.Z)({},m9.defaultAttributes,m8(t,["data"]))))}labeling(t,e,i="top",r=0){if(!t||!e)return;let{x1:n,y1:s,x2:l,y2:a}=t,o=Math.abs(l-n),h=Math.abs(a-s),{x:u,y:d}=(0,um.v1)(e,i),c=0,p=0,g=i.includes("inside");switch(i.includes("top")?p=g?1:-1:i.includes("bottom")?p=g?-1:1:i.includes("left")?c=g?1:-1:i.includes("right")&&(c=g?-1:1),i){case"top-right":case"bottom-right":c=-1;break;case"top-left":case"bottom-left":c=1}return{x:u+c*r+c*o/2,y:d+p*r+p*h/2}}}m9.tag="rect-label",m9.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};let m7=()=>{pP("rect",m9)};var yt=i(35953);class ye extends od{constructor(){super(...arguments),this.type=ye.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}ye.type="rect";let yi=()=>{(0,oc.W)(),(0,m6.k)(),m7(),iv.registerMark(ye.type,ye),dt(),iv.registerGraphicComponent("rect",yt.f)},yr=Object.assign(Object.assign({},cy),{bar:{name:"bar",type:"rect"},barBackground:{name:"barBackground",type:"rect"}});function yn(t,e,i,r,n,s){let l=i.getSpec().barMinHeight,a=i[r.axisHelper].isInverse(),o=aa(i[r.startMethod](t),n),h=aa(i[r.endMethod](t),n);s&&(e=o);let u=Math.abs(o-h);u<l&&(u=l);let d=1;return h<o?d=-1:h===o&&(d=r.isVertical?a?1:-1:a?-1:1),h=e+d*u,t[r.start]=e,t[r.end]=h,h}class ys extends cE{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){this._addMarkLabelSpec(t,"bar")}}class yl extends cD{constructor(){super(...arguments),this.type=rR.bar,this._barMarkName="bar",this._barMarkType="rect",this.transformerConstructor=ys,this._bandPosition=0,this._getLinearBarRange=(t,e)=>{let[i,r]=[t,e].sort((t,e)=>t-e),n=r-i;if(this._spec.barGap){let t=.5*this._spec.barGap;i+=t,r-=t}let s=r-i,l=eR(this._spec.barMinWidth||2,n);if(s<l){let t=(l-s)/2;i-=t,r+=t}return[i,r]},this._getBarXStart=(t,e,i)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),t[cv]):this._spec.barMinHeight?this._calculateRectPosition(t,!1,i):aa(this._dataToPosX(t),e,i),this._getBarXEnd=(t,e,i)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),t[cb]):aa(this._dataToPosX1(t),e,i),this._getLinearBarXRange=(t,e,i)=>{let r=aa(this._dataToPosX(t),e,i),n=aa(this._dataToPosX1(t),e,i);return this._getLinearBarRange(r,n)},this._getBarYStart=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),t[c_]):this._spec.barMinHeight?this._calculateRectPosition(t,!0):aa(this._dataToPosY(t),e),this._getBarYEnd=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),t[cx]):aa(this._dataToPosY1(t),e),this._getLinearBarYRange=(t,e,i)=>{let r=aa(this._dataToPosY(t),e,i),n=aa(this._dataToPosY1(t),e,i);return this._getLinearBarRange(r,n)},this._getBarBackgroundXStart=t=>{let e=t.range();return Math.min(e[0],e[e.length-1])},this._getBarBackgroundXEnd=t=>{let e=t.range();return Math.max(e[0],e[e.length-1])},this._getBarBackgroundYStart=t=>{let e=t.range();return Math.min(e[0],e[e.length-1])},this._getBarBackgroundYEnd=t=>{let e=t.range();return Math.max(e[0],e[e.length-1])},this._getBarBackgroundPositionXEncoder=()=>{var t;return null==(t=this._barBackgroundPositionXEncoder)?void 0:t.bind(this)},this._setBarBackgroundPositionXEncoder=t=>{this._barBackgroundPositionXEncoder=t.bind(this)},this._getBarBackgroundPositionYEncoder=()=>{var t;return null==(t=this._barBackgroundPositionYEncoder)?void 0:t.bind(this)},this._setBarBackgroundPositionYEncoder=t=>{this._barBackgroundPositionYEncoder=t.bind(this)}}initMark(){this._initBarBackgroundMark(),this._barMark=this._createMark(Object.assign(Object.assign({},yl.mark.bar),{name:this._barMarkName,type:this._barMarkType}),{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0],morph:cR(this._spec,this._barMarkName)})}_initBarBackgroundMark(){this._spec.barBackground&&this._spec.barBackground.visible&&(this._barBackgroundMark=this._createMark(yl.mark.barBackground,{dataView:this._barBackgroundViewData.getDataView(),dataProductId:this._barBackgroundViewData.getProductId()}))}initMarkStyle(){this._barMark&&this.setMarkStyle(this._barMark,{fill:this.getColorAttribute()},"normal",W.Series)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null})}initTooltip(){super.initTooltip();let{mark:t,group:e}=this._tooltipHelper.activeTriggerSet;this._barMark&&(t.add(this._barMark),e.add(this._barMark))}_statisticViewData(){var t,e;let i;super._statisticViewData();let r=null!=(t=this._spec.barBackground)?t:{};if(!r.visible)return;let n=this._getRelatedComponentSpecInfo("axes").some(t=>t.type===rk.cartesianBandAxis);if(nq(this._option.dataSet,"addVChartProperty",d2),n)nq(this._option.dataSet,"dimensionItems",([t],{scaleDepth:e})=>{var i,r;let n=[{}],s=this.getDimensionField(),l=er(e)?s.length:Math.min(s.length,e);for(let e=0;e<l;e++){let l=s[e],a=null==(i=t.latestData[l])?void 0:i.values;if(!(null==a?void 0:a.length))continue;let o=[],h=null!=(r=this._spec.dataKey)?r:ss;for(let t=0;t<a.length;t++)for(let e=0;e<n.length;e++)o.push(Object.assign(Object.assign({},n[e]),{[l]:a[t],[h]:a[t]}));n=o}return n}),i=new el(this._option.dataSet).parse([this._viewDataStatistics],{type:"dataview"}).transform({type:"dimensionItems",options:{scaleDepth:er(r.fieldLevel)?void 0:r.fieldLevel+1}},!1).transform({type:"addVChartProperty",options:{beforeCall:cp.bind(this),call:cg}},!1),null==(e=this._viewDataStatistics)||e.target.addListener("change",i.reRunAllTransform);else{nq(this._option.dataSet,"dimensionItems",([e])=>{let i=[],[r,n]=this.getDimensionContinuousField(),s={};return t.latestData.forEach(t=>{let e=`${t[r]}-${t[n]}`;s[e]||(s[e]={[r]:t[r],[n]:t[n]},i.push(s[e]))}),i});let t=this.getViewData();i=new el(this._option.dataSet).parse([t],{type:"dataview"}).transform({type:"dimensionItems"},!1).transform({type:"addVChartProperty",options:{beforeCall:cp.bind(this),call:cg}},!1),null==t||t.target.addListener("change",i.reRunAllTransform)}this._barBackgroundViewData=new aC(this._option,i)}init(t){var e,i;super.init(t),"vertical"===this.direction?"band"===(null==(e=this._xAxisHelper)?void 0:e.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle():"band"===(null==(i=this._yAxisHelper)?void 0:i.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle()}_shouldDoPreCalculate(){let t=this.getRegion();return this.getStack()&&t.getSeries().filter(t=>t.type===this.type&&t.getSpec().barMinHeight).length}_calculateStackRectPosition(t){let e,i,r,n,s,l=this.getRegion();if(l._bar_series_position_calculated)return;l._bar_series_position_calculated=!0,t?(e=cx,i=c_,r="_dataToPosY1",n="_dataToPosY",s="_yAxisHelper"):(e=cb,i=cv,r="_dataToPosX1",n="_dataToPosX",s="_xAxisHelper");let a=d$(l,!1,t=>t.type===this.type);for(let o in a)for(let h in a[o].nodes)!function t(e,i,r){var n,s;if(e.values.length>0){let t;if(e.sortDatums.length){let l=e.sortDatums;i&&(l=e.sortDatums.slice().reverse());for(let e=0;e<l.length;e++)t=yn(l[e].datum,t,l[e].series,r,null==(s=(n=l[e].series[r.axisHelper]).getScale)?void 0:s.call(n,0),0===e)}else{let n=e.series;i&&(n=n.slice().reverse()),n.forEach(({s:e,values:n},s)=>{var l,a;let o=null==(a=(l=e[r.axisHelper]).getScale)?void 0:a.call(l,0);for(let l=0;l<n.length;l++)t=yn(n[i?n.length-1-l:l],t,e,r,o,0===l&&0===s)})}}for(let n in e.nodes)t(e.nodes[n],i,r)}(a[o].nodes[h],l.getStackInverse(),{isVertical:t,start:e,end:i,startMethod:r,endMethod:n,axisHelper:s})}_calculateRectPosition(t,e,i){var r,n;let s,l,a;e?(s="_dataToPosY1",l="_dataToPosY",a="_yAxisHelper"):(s="_dataToPosX1",l="_dataToPosX",a="_xAxisHelper");let o=null==(n=(r=this[a]).getScale)?void 0:n.call(r,0),h=this[a].isInverse(),u=this._spec.barMinHeight,d=aa(this[s](t),o,i),c=aa(this[l](t),o,i),p=Math.abs(d-c);p<u&&(p=u);let g=1;return c<d?g=-1:c===d&&(g=e?h?1:-1:h?-1:1),d+g*p}_dataToPosX(t){return this.dataToPositionX(t)}_dataToPosX1(t){return this.dataToPositionX1(t)}_dataToPosY(t){return this.dataToPositionY(t)}_dataToPosY1(t){return this.dataToPositionY1(t)}initBandRectMarkStyle(){var t,e,i,r;let n=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),s=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0);"horizontal"===this.direction?this.setMarkStyle(this._barMark,{x:t=>this._getBarXStart(t,n),x1:t=>this._getBarXEnd(t,n),y:t=>this._getPosition(this.direction,t),height:()=>this._getBarWidth(this._yAxisHelper),width:()=>{},y1:()=>{}},"normal",W.Series):this.setMarkStyle(this._barMark,{y:t=>this._getBarYStart(t,s),y1:t=>this._getBarYEnd(t,s),x:t=>this._getPosition(this.direction,t),width:()=>this._getBarWidth(this._xAxisHelper),x1:()=>{},height:()=>{}},"normal",W.Series),this._initStackBarMarkStyle(),this._initBandBarBackgroundMarkStyle()}_initStackBarMarkStyle(){var t,e,i,r;if(!this._spec.stackCornerRadius)return;let n=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),s=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0);this._barMark.setMarkConfig({clip:!0,clipPath:()=>{let t=[];return this._forEachStackGroup(e=>{let i=1/0,r=-1/0,l=!1,a=1/0,o=-1/0;e.values.forEach(t=>{let e=t[sh],n=t[su],s=t[sd],h=t[sc];i=Math.min(i,e,n),r=Math.max(r,e,n),t8(s)&&t8(h)&&(l=!0,a=Math.min(a,s,h),o=Math.max(o,s,h))});let h=Object.assign(Object.assign(Object.assign({},e.values[0]),{[sh]:i,[su]:r}),l?{[sd]:a,[sc]:o}:void 0),u="horizontal"===this.direction?{x:this._getBarXStart(h,n),x1:this._getBarXEnd(h,n),y:this._getPosition(this.direction,h),height:this._getBarWidth(this._yAxisHelper)}:{y:this._getBarYStart(h,s),y1:this._getBarYEnd(h,s),x:this._getPosition(this.direction,h),width:this._getBarWidth(this._xAxisHelper)};t.push((0,yt.f)(Object.assign(Object.assign({},u),{cornerRadius:tQ(this._spec.stackCornerRadius)?this._spec.stackCornerRadius(u,h,this._markAttributeContext):this._spec.stackCornerRadius,fill:!0})))}),t}})}initLinearRectMarkStyle(){var t,e,i,r;let n=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),s=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0);if("horizontal"===this.direction){let t=t8(this._fieldY2)?{y:t=>this._getLinearBarYRange(t,s,!0)[0],y1:t=>this._getLinearBarYRange(t,s,!0)[1]}:{y:t=>aa(this._dataToPosY(t)-this._getBarWidth(this._yAxisHelper)/2,s,!0),height:t=>this._getBarWidth(this._yAxisHelper)};this.setMarkStyle(this._barMark,Object.assign({x:t=>this._getBarXStart(t,n,!0),x1:t=>this._getBarXEnd(t,n,!0)},t),"normal",W.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign({x:()=>this._getBarBackgroundXStart(n),x1:()=>this._getBarBackgroundXEnd(n)},t),"normal",W.Series)}else{let t=t8(this._fieldX2)?{x:t=>this._getLinearBarXRange(t,n,!0)[0],x1:t=>this._getLinearBarXRange(t,n,!0)[1]}:{x:t=>aa(this._dataToPosX(t)-this._getBarWidth(this._xAxisHelper)/2,n,!0),width:t=>this._getBarWidth(this._xAxisHelper)};this.setMarkStyle(this._barMark,Object.assign(Object.assign({},t),{y:t=>this._getBarYStart(t,s),y1:t=>this._getBarYEnd(t,s)}),"normal",W.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign(Object.assign({},t),{y:()=>this._getBarBackgroundYStart(s),y1:()=>this._getBarBackgroundYEnd(s)}),"normal",W.Series)}}_initBandBarBackgroundMarkStyle(){var t,e,i,r,n;if(!this._barBackgroundMark)return;let s=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),l=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0),a=null!=(n=this._spec.barBackground)?n:{},o=er(a.fieldLevel)?void 0:a.fieldLevel+1;"horizontal"===this.direction?this.setMarkStyle(this._barBackgroundMark,{x:()=>this._getBarBackgroundXStart(s),x1:()=>this._getBarBackgroundXEnd(s),y:t=>this._getPosition(this.direction,t,o,"barBackground"),height:()=>this._getBarWidth(this._yAxisHelper,o),width:()=>{},y1:()=>{}},"normal",W.Series):this.setMarkStyle(this._barBackgroundMark,{x:t=>this._getPosition(this.direction,t,o,"barBackground"),y:()=>this._getBarBackgroundYStart(l),y1:()=>this._getBarBackgroundYEnd(l),width:()=>this._getBarWidth(this._xAxisHelper,o),x1:()=>{},height:()=>{}},"normal",W.Series)}initAnimation(){var t,e;let i={yField:this._fieldY[0],xField:this._fieldX[0],direction:this.direction,growFrom:()=>{var t;let e="horizontal"===this.direction?null==(t=this._xAxisHelper)?void 0:t.getScale(0):this._yAxisHelper.getScale(0);if(e){let t=e.domain(),i=eg(t),r=ep(t);return r<0?e.scale(r):i>0?e.scale(i):e.scale(0)}}},r=null==(t=this._spec.animationAppear)?void 0:t.preset,n=cO(this);this._barMark.setAnimationConfig(cA(null==(e=iv.getAnimationInKey("bar"))?void 0:e(i,r),cM(this._barMarkName,this._spec,this._markAttributeContext),n))}_getBarWidth(t,e){var i,r;let n=this._groups?this._groups.fields.length:1,s=er(e)?n:Math.min(n,e),l=null!=(r=null==(i=t.getBandwidth)?void 0:i.call(t,s-1))?r:6,a=t8(this._spec.barWidth)&&s===n,o=t8(this._spec.barMinWidth),h=t8(this._spec.barMaxWidth),u=l;return a&&(u=eR(this._spec.barWidth,l)),o&&(u=Math.max(u,eR(this._spec.barMinWidth,l))),h&&(u=Math.min(u,eR(this._spec.barMaxWidth,l))),u}_getPosition(t,e,i,r){var n,s,l,a,o;let h,u,d;"horizontal"===t?(h=this.getYAxisHelper(),u="height",d="barBackground"===r?this.dataToBarBackgroundPositionY.bind(this):this.dataToPositionY.bind(this)):(h=this.getXAxisHelper(),u="width",d="barBackground"===r?this.dataToBarBackgroundPositionX.bind(this):this.dataToPositionX.bind(this));let c=h.getScale(0),p=this._groups?this._groups.fields.length:1,g=er(i)?p:Math.min(p,i),f=null!=(s=null==(n=h.getBandwidth)?void 0:n.call(h,g-1))?s:6,m=g===p?this._barMark.getAttribute(u,e):f;if(g>1&&t8(this._spec.barGapInGroup)){let t=this._groups.fields,i=ed(this._spec.barGapInGroup),r=0,n=0;for(let s=t.length-1;s>=1;s--){let u=t[s],d=null!=(a=null==(l=h.getScale(s))?void 0:l.domain())?a:[],c=d.length,p=eR(null!=(o=i[s-1])?o:ec(i),f),g=d.indexOf(e[u]);s===t.length-1?(r+=c*m+(c-1)*p,n+=g*(m+p)):(n+=g*(r+p),r+=r+(c-1)*p)}return c.scale(e[t[0]])+h.getBandwidth(0)/2-r/2+n}let y=ls(c.type||"band");return d(e,g)+.5*(f-m)+(y?-f/2:0)}dataToBarBackgroundPositionX(t,e){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,e,this._getBarBackgroundPositionXEncoder,this._setBarBackgroundPositionXEncoder)}dataToBarBackgroundPositionY(t,e){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,e,this._getBarBackgroundPositionYEncoder,this._setBarBackgroundPositionYEncoder)}onLayoutEnd(){super.onLayoutEnd(),this.getRegion()._bar_series_position_calculated=!1,this._spec.sampling&&this.compile()}onDataUpdate(){super.onDataUpdate(),this.getRegion()._bar_series_position_calculated=!1}compile(){if(super.compile(),this._spec.sampling){let{width:t,height:e}=this._region.getLayoutRect(),i=this._fieldY,r=this._fieldX;this._data.setTransform([{type:"sampling",size:"horizontal"===this._direction?e:t,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?r[0]:i[0],groupBy:this._seriesField,mode:this._spec.sampling}])}}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._barMark]}compileData(){var t;super.compileData(),null==(t=this._barBackgroundViewData)||t.compile()}fillData(){var t,e;super.fillData(),null==(e=null==(t=this._barBackgroundViewData)?void 0:t.getDataView())||e.reRunAllTransform()}viewDataUpdate(t){var e,i,r;super.viewDataUpdate(t),null==(i=null==(e=this._barBackgroundViewData)?void 0:e.getDataView())||i.reRunAllTransform(),null==(r=this._barBackgroundViewData)||r.updateData()}release(){var t;super.release(),null==(t=this._barBackgroundViewData)||t.release(),this._barBackgroundViewData=null}}yl.type=rR.bar,yl.builtInTheme={bar:{label:{visible:!1,position:"outside",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}}},yl.mark=yr,yl.transformerConstructor=ys;let ya=()=>{fE(),yi(),m4(),fl(),fb(),iv.registerSeries(yl.type,yl)};class yo extends fH{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barMinHeight","sampling","samplingFactor","barBackground","stackCornerRadius","useSequentialAnimation"])}transformSpec(t){super.transformSpec(t),sW(t)}_transformAxisSpec(t){var e,i;if(super._transformAxisSpec(t),!t.axes)return;let r=t.series.some(t=>"horizontal"===t.direction),n=null!=(e=t.axes.find(t=>"band"===t.type))?e:t.axes.find(t=>(r?["left","right"]:["top","bottom"]).includes(t.orient));if(n&&!n.bandSize&&!n.maxBandSize&&!n.minBandSize&&t.autoBandSize){let e=e_(t.autoBandSize)&&null!=(i=t.autoBandSize.extend)?i:0,{barMaxWidth:r,barMinWidth:s,barWidth:l,barGapInGroup:a}=t.series.find(t=>"bar"===t.type);this._applyAxisBandSize(n,e,{barMaxWidth:r,barMinWidth:s,barWidth:l,barGapInGroup:a})}}}class yh extends fV{constructor(){super(...arguments),this.transformerConstructor=yo,this.type="bar",this.seriesType=rR.bar}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}yh.type="bar",yh.seriesType=rR.bar,yh.transformerConstructor=yo,cG(yh,fK);let yu=()=>{mb(),mx(),mw(),fX(),ya(),f8(),iv.registerChart(yh.type,yh)},yd=t=>"string"==typeof t&&!isNaN(Number(t))&&!isNaN(parseFloat(t)),yc=[10,20],yp=V.Linear,yg="circle",yf=V.Ordinal,ym=["circle","square","triangle","diamond","star"],yy=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"},yv=()=>{iv.registerAnimation("scatter",(t,e)=>Object.assign({appear:yy(0,e)},u1))},yb=Object.assign(Object.assign({},cy),{point:{name:"point",type:"symbol"}});class y_ extends cE{_transformLabelSpec(t){this._addMarkLabelSpec(t,"point")}}class yx extends cD{constructor(){super(...arguments),this.type=rR.scatter,this.transformerConstructor=y_,this._invalidType="zero"}setAttrFromSpec(){super.setAttrFromSpec(),this._size=this._spec.size,this._sizeField=this._spec.sizeField,this._shape=this._spec.shape,this._shapeField=this._spec.shapeField}_getSeriesAttribute(t,e,{defaultScaleType:i,defaultRange:r},n){var s,l,a,o;if(tQ(e))return e;if(tq(e)){if(er(t))return null==(s=this._option)||s.onError(`${n}Field is required.`),e;if("ordinal"!==i&&e.length>2)return null==(l=this._option)||l.onError(`${n} length is invalid, specify up to 2 ${n}s.`),e;let r=`${st}_series_scatter_${this.id}_scale_${n}`;return this._option.globalScale.registerModelScale({id:r,type:i,domain:[{dataId:this._rawData.name,fields:[t]}],range:e}),{scale:r,field:t}}if(e_(e)){if(er(t))return null==(a=this._option)||a.onError(`${n}Field is required.`),e;let s=Object.assign({id:`${st}_series_scatter_${this.id}_scale_${n}`,type:i,domain:[{dataId:this._rawData.name,fields:[t]}],range:r},e);return this._option.globalScale.registerModelScale(s),{scale:s.id,field:t}}return null==(o=this._option)||o.onError(`${n} attribute is invalid.`),e}getSizeAttribute(t,e){return er(e)?10:tG(e)?e:t6(e)&&yd(e)?parseFloat(e):this._getSeriesAttribute(t,e,{defaultScaleType:yp,defaultRange:yc},"size")}getShapeAttribute(t,e){return er(e)?yg:t6(e)?e:this._getSeriesAttribute(t,e,{defaultScaleType:yf,defaultRange:ym},"shape")}initMark(){this._symbolMark=this._createMark(yx.mark.point,{groupKey:this._seriesField,isSeriesMark:!0},{morph:cR(this._spec,yx.mark.point.name),morphElementKey:this.getDimensionField()[0]})}initMarkStyle(){this.initSymbolMarkStyle()}initAnimation(){var t,e,i;let r=cO(this),n=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._symbolMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("scatter"))?void 0:i({},n),cM("point",this._spec,this._markAttributeContext),r))}initSymbolMarkStyle(){let t=this._symbolMark;t&&("zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)}),this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,fill:this.getColorAttribute(),size:tG(this._size)||tQ(this._size)?this._size:10,symbolType:t6(this._shape)||tQ(this._shape)?this._shape:yg},j.STATE_NORMAL,W.Series),(t8(this._sizeField)||t8(this._size))&&this.setMarkStyle(t,{size:this.getSizeAttribute(this._sizeField,this._size)},j.STATE_NORMAL,W.User_Mark),(t8(this._shapeField)||t8(this._shape))&&this.setMarkStyle(t,{symbolType:this.getShapeAttribute(this._shapeField,this._shape)},j.STATE_NORMAL,W.User_Mark))}initTooltip(){super.initTooltip(),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)}viewDataStatisticsUpdate(t){super.viewDataStatisticsUpdate(t);let e=[this.getDimensionField()[0],this.getStackValueField()].every(t=>{var e,i,r;return t&&(null==(r=null==(i=null==(e=this.getViewDataStatistics())?void 0:e.latestData)?void 0:i[t])?void 0:r.allValid)});"zero"===this._invalidType||e?this.setMarkStyle(this._symbolMark,{visible:!0},"normal",W.Series):this.setMarkStyle(this._symbolMark,{visible:this._getInvalidDefined.bind(this)},"normal",W.Series),this._symbolMark.getProduct()&&this._symbolMark.compileEncode()}initLabelMarkStyle(t){t&&(this._labelMark=t,this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null},j.STATE_NORMAL,W.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},j.STATE_NORMAL,W.Series))}handleZoom(t){var e,i;this.getMarksWithoutRoot().forEach(t=>{if(!t)return;let e=t.getGraphics();e&&e.length&&e.forEach((t,e)=>{var i,r;let n=null==(r=null==(i=null==t?void 0:t.context)?void 0:i.data)?void 0:r[0],s=this.dataToPosition(n);s&&t&&t.translateTo(s.x,s.y)})});let r=null==(i=null==(e=this._labelMark)?void 0:e.getComponent())?void 0:i.getProduct();r&&r.evaluate(null,null)}handlePan(t){this.handleZoom(t)}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._symbolMark]}}yx.type=rR.scatter,yx.mark=yb,yx.builtInTheme={scatter:{point:{style:{size:8,symbolType:"circle",lineWidth:0,fillOpacity:.8}},label:{visible:!1,offset:5,position:"top",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}}},yx.transformerConstructor=y_;let yC=()=>{pV(),yv(),fl(),fb(),iv.registerSeries(yx.type,yx)};class yw extends fH{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["point","size","shape","shapeField","sizeField"])}}class yS extends fV{constructor(){super(...arguments),this.transformerConstructor=yw,this.type="scatter",this.seriesType=rR.scatter}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}yS.type="scatter",yS.seriesType=rR.scatter,yS.transformerConstructor=yw,cG(yS,fK);let yA=()=>{mb(),mx(),f8(),fX(),yC(),iv.registerChart(yS.type,yS)};class yM{constructor(t=1,e=0,i=0,r=1,n=0,s=0){this.a=t,this.b=e,this.c=i,this.d=r,this.e=n,this.f=s}equalToMatrix(t){return this.e===t.e&&this.f===t.f&&this.a===t.a&&this.d===t.d&&this.b===t.b&&this.c===t.c}equalTo(t,e,i,r,n,s){return this.e===n&&this.f===s&&this.a===t&&this.d===r&&this.b===e&&this.c===i}setValue(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.e=n,this.f=s,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){let t=this.a,e=this.b,i=this.c,r=this.d,n=this.e,s=this.f,l=new yM,a=t*r-e*i;return l.a=r/a,l.b=-e/a,l.c=-i/a,l.d=t/a,l.e=(i*s-r*n)/a,l.f=-(t*s-e*n)/a,l}rotate(t){let e=Math.cos(t),i=Math.sin(t),r=this.a*e+this.c*i,n=this.b*e+this.d*i,s=-(this.a*i)+this.c*e,l=-(this.b*i)+this.d*e;return this.a=r,this.b=n,this.c=s,this.d=l,this}rotateByCenter(t,e,i){let r=Math.cos(t),n=Math.sin(t),s=r*this.a-n*this.b,l=n*this.a+r*this.b,a=r*this.c-n*this.d,o=n*this.c+r*this.d,h=r*this.e-n*this.f+((1-r)*e+n*i),u=n*this.e+r*this.f+((1-r)*i-n*e);return this.a=s,this.b=l,this.c=a,this.d=o,this.e=h,this.f=u,this}scale(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}setScale(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}transform(t,e,i,r,n,s){return this.multiply(t,e,i,r,n,s),this}translate(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}transpose(){let{a:t,b:e,c:i,d:r,e:n,f:s}=this;return this.a=e,this.b=t,this.c=r,this.d=i,this.e=s,this.f=n,this}multiply(t,e,i,r,n,s){let l=this.a,a=this.b,o=this.c,h=this.d,u=l*n+o*s+this.e,d=a*n+h*s+this.f;return this.a=l*t+o*e,this.b=a*t+h*e,this.c=l*i+o*r,this.d=a*i+h*r,this.e=u,this.f=d,this}interpolate(t,e){let i=new yM;return i.a=this.a+(t.a-this.a)*e,i.b=this.b+(t.b-this.b)*e,i.c=this.c+(t.c-this.c)*e,i.d=this.d+(t.d-this.d)*e,i.e=this.e+(t.e-this.e)*e,i.f=this.f+(t.f-this.f)*e,i}transformPoint(t,e){let{a:i,b:r,c:n,d:s,e:l,f:a}=this,o=i*s-r*n,{x:h,y:u}=t;e.x=s/o*h+-n/o*u+(n*a-s*l)/o,e.y=-r/o*h+i/o*u+-(i*a-r*l)/o}onlyTranslate(t=1){return this.a===t&&0===this.b&&0===this.c&&this.d===t}clone(){return new yM(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){let t=this.a,e=this.b,i=this.c,r=this.d,n=t*r-e*i,s={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){let l=Math.sqrt(t*t+e*e);s.rotateDeg=e>0?Math.acos(t/l):-Math.acos(t/l),s.scaleX=l,s.scaleY=n/l,s.skewX=(t*i+e*r)/n,s.skewY=0}else if(0!==i||0!==r){let l=Math.sqrt(i*i+r*r);s.rotateDeg=Math.PI/2-(r>0?Math.acos(-i/l):-Math.acos(i/l)),s.scaleX=n/l,s.scaleY=l,s.skewX=0,s.skewY=(t*i+e*r)/n}return s.rotateDeg=am(s.rotateDeg),s}}let yk=(t,e)=>{let i;if(!e.from||!e.from())return t;let r=e.fields,n=e.key,s=e.values,l=e.default,a=e.as||[r],o=e.from().reduce(function(t,e){return e[r]&&t.set(e[r],e),t},new Map);if(tQ(e.set))i=function(t){let i=o.get(t[n]);e.set(t,i)};else if(s){let t=s.length;i=function(e){let i=o.get(e[n]);if(er(i))for(let i=0;i<t;++i)e[a[i]]=l;else for(let r=0;r<t;++r)e[a[r]]=i[s[r]]}}else i=function(t){let e=o.get(t[n]);t[a[0]]=t8(e)?e:l};return 0===t.length?[]:t.map(t=>(i(t),t))};class yT extends cI{constructor(){super(...arguments),this.type=rR.geo,this.coordinate="geo",this._nameProperty="name"}getMapViewData(){var t;return null==(t=this._mapViewData)?void 0:t.getDataView()}get nameField(){return this._nameField}set nameField(t){this._nameField=t}get valueField(){return this._valueField}set valueField(t){this._valueField=t}getNameProperty(){return this._nameProperty}getCentroidProperty(){return this._centroidProperty}getCoordinateHelper(){return this._coordinateHelper}setCoordinateHelper(t){this._coordinateHelper=t}getStatisticFields(){let t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}getGroupFields(){return null}dataToPosition(t,e){var i;let r=null;if(!t||e&&!this.isDatumInViewData(t))return r;let{dataToPosition:n,latitudeField:s,longitudeField:l}=this._coordinateHelper;if(null===(r=this.nameToPosition(t))){let e=l?null==t?void 0:t[l]:Number.NaN,a=s?null==t?void 0:t[s]:Number.NaN;r=null!=(i=null==n?void 0:n([e,a]))?i:null}return r}nameToPosition(t){let e=this.getDatumName(t);return er(e)?null:this.nameValueToPosition(e)}nameValueToPosition(t){var e,i;let r=null==(i=null==(e=this.getMapViewData())?void 0:e.latestData)?void 0:i.filter(e=>this.getDatumName(e)===t)[0];if(er(r))return null;let{dataToPosition:n}=this._coordinateHelper,s=this.getDatumCenter(r),l=null==n?void 0:n(s);return er(l)||isNaN(l.x)||isNaN(l.y)?null:l}dataToLatitude(t){if(!this._coordinateHelper)return Number.NaN;let{dataToLatitude:e}=this._coordinateHelper;return e(t)}dataToLongitude(t){if(!this._coordinateHelper)return Number.NaN;let{dataToLatitude:e}=this._coordinateHelper;return e(t)}valueToPosition(t,e){return{x:this.dataToLongitude(t),y:this.dataToLatitude(e)}}positionToData(t){}latitudeToData(t){}longitudeToData(t){}dataToPositionX(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}dataToPositionY(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}dataToPositionZ(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}release(){super.release(),this._mapViewData.release(),this._mapViewData=this._mapViewDataStatistics=null}getStackGroupFields(){return[this._nameField]}getStackValueField(){return this._spec.valueField}compileData(){var t;null==(t=this._mapViewData)||t.compile()}initStatisticalData(){if(super.initStatisticalData(),this._mapViewData){let t=`${st}_series_${this.id}_mapViewDataStatic`;this._mapViewDataStatistics=this.createStatisticalData(t,this._mapViewData.getDataView()),this._mapViewData.getDataView().target.removeListener("change",this._mapViewDataStatistics.reRunAllTransform)}}getSeriesKeys(){var t,e,i,r,n;return this._seriesField?null!=(n=null!=(e=null==(t=this.getRawDataStatisticsByField(this._seriesField))?void 0:t.values)?e:null==(r=null==(i=this._mapViewDataStatistics)?void 0:i.latestData[this._seriesField])?void 0:r.values)?n:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}fillData(){var t,e;super.fillData(),null==(t=this._mapViewData.getDataView())||t.reRunAllTransform(),null==(e=this._mapViewDataStatistics)||e.reRunAllTransform()}getActiveMarks(){return[]}}let yR=`${st}_MAP_LOOK_UP_KEY`,yB=(t,e)=>(t.features&&t.features.forEach((t,i)=>{var r;t[sn]=i;let n=null==(r=t.properties)?void 0:r[e.nameProperty];e.nameMap&&e.nameMap[n]?t[yR]=e.nameMap[n]:t[yR]=n}),t.features);class yP extends cs{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=t=>{var e;let i=this.series;return null!=(e=this._getDimensionData(t))?e:i.getDatumName(t)}}}var yE=i(9994),yI=i(20033);class yL extends od{constructor(){super(...arguments),this.type=yL.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0,path:""})}}yL.type="path";let yF=()=>{iv.registerMark(yL.type,yL),(0,oc.W)(),(0,yE.N)(),iv.registerGraphicComponent("path",yI.E)},yO=Object.assign(Object.assign({},cy),{area:{name:"area",type:"path"}});function yD(){var t,e=[];return{point:function(e,i,r){t.push([e,i,r])},lineStart:function(){e.push(t=[])},lineEnd:rf,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function yH(t,e){return 1e-6>ri(t[0]-e[0])&&1e-6>ri(t[1]-e[1])}function yz(t,e,i,r){this.x=t,this.z=e,this.o=i,this.e=r,this.v=!1,this.n=this.p=null}function yW(t,e,i,r,n){var s,l,a=[],o=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,i,r=t[0],l=t[e];if(yH(r,l)){if(!r[2]&&!l[2]){for(n.lineStart(),s=0;s<e;++s)n.point((r=t[s])[0],r[1]);n.lineEnd();return}l[0]+=2e-6}a.push(i=new yz(r,t,null,!0)),o.push(i.o=new yz(r,null,i,!1)),a.push(i=new yz(l,t,null,!1)),o.push(i.o=new yz(l,null,i,!0))}}),a.length){for(o.sort(e),yN(a),yN(o),s=0,l=o.length;s<l;++s)o[s].e=i=!i;for(var h,u,d=a[0];;){for(var c=d,p=!0;c.v;)if((c=c.n)===d)return;h=c.z,n.lineStart();do{if(c.v=c.o.v=!0,c.e){if(p)for(s=0,l=h.length;s<l;++s)n.point((u=h[s])[0],u[1]);else r(c.x,c.n.x,1,n);c=c.n}else{if(p)for(s=(h=c.p.z).length-1;s>=0;--s)n.point((u=h[s])[0],u[1]);else r(c.x,c.p.x,-1,n);c=c.p}h=(c=c.o).z,p=!p}while(!c.v);n.lineEnd()}}}function yN(t){if(e=t.length){for(var e,i,r=0,n=t[0];++r<e;)n.n=i=t[r],i.p=n,n=i;n.n=i=t[0],i.p=n}}function yj(t){return[rn(t[1],t[0]),rg(t[2])]}function yG(t){var e=t[0],i=t[1],r=rs(i);return[r*rs(e),r*rh(e),rh(i)]}function yV(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function yZ(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function yU(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function yK(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function y$(t){var e=rd(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var yY=new i3;function yX(t){return ri(t[0])<=i6?t[0]:ru(t[0])*((ri(t[0])+i6)%i7-i6)}function yq(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var yJ=(1===(B=yq).length&&(s=B,B=function(t,e){return yq(s(t),e)}),{left:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var n=i+r>>>1;0>B(t[n],e)?i=n+1:r=n}return i},right:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var n=i+r>>>1;B(t[n],e)>0?r=n:i=n+1}return i}});yJ.right,yJ.left;var yQ=Array.prototype;function y0(t){for(var e,i,r,n=t.length,s=-1,l=0;++s<n;)l+=t[s].length;for(i=Array(l);--n>=0;)for(e=(r=t[n]).length;--e>=0;)i[--l]=r[e];return i}function y1(t,e,i,r){return function(n){var s,l,a,o=e(n),h=yD(),u=e(h),d=!1,c={point:p,lineStart:f,lineEnd:m,polygonStart:function(){c.point=y,c.lineStart=v,c.lineEnd=b,l=[],s=[]},polygonEnd:function(){c.point=p,c.lineStart=f,c.lineEnd=m,l=y0(l);var t=function(t,e){var i=yX(e),r=e[1],n=rh(r),s=[rh(i),-rs(i),0],l=0,a=0;yY.reset(),1===n?r=i8+1e-6:-1===n&&(r=-i8-1e-6);for(var o=0,h=t.length;o<h;++o)if(d=(u=t[o]).length)for(var u,d,c=u[d-1],p=yX(c),g=c[1]/2+i9,f=rh(g),m=rs(g),y=0;y<d;++y,p=b,f=x,m=C,c=v){var v=u[y],b=yX(v),_=v[1]/2+i9,x=rh(_),C=rs(_),w=b-p,S=w>=0?1:-1,A=S*w,M=A>i6,k=f*x;if(yY.add(rn(k*S*rh(A),m*C+k*rs(A))),l+=M?w+S*i7:w,M^p>=i^b>=i){var T=yZ(yG(c),yG(v));y$(T);var R=yZ(s,T);y$(R);var B=(M^w>=0?-1:1)*rg(R[2]);(r>B||r===B&&(T[0]||T[1]))&&(a+=M^w>=0?1:-1)}}return(l<-1e-6||l<1e-6&&yY<-1e-6)^1&a}(s,r);l.length?(d||(n.polygonStart(),d=!0),yW(l,y3,t,i,n)):t&&(d||(n.polygonStart(),d=!0),n.lineStart(),i(null,null,1,n),n.lineEnd()),d&&(n.polygonEnd(),d=!1),l=s=null},sphere:function(){n.polygonStart(),n.lineStart(),i(null,null,1,n),n.lineEnd(),n.polygonEnd()}};function p(e,i){t(e,i)&&n.point(e,i)}function g(t,e){o.point(t,e)}function f(){c.point=g,o.lineStart()}function m(){c.point=p,o.lineEnd()}function y(t,e){a.push([t,e]),u.point(t,e)}function v(){u.lineStart(),a=[]}function b(){y(a[0][0],a[0][1]),u.lineEnd();var t,e,i,r,o=u.clean(),c=h.result(),p=c.length;if(a.pop(),s.push(a),a=null,p){if(1&o){if((e=(i=c[0]).length-1)>0){for(d||(n.polygonStart(),d=!0),n.lineStart(),t=0;t<e;++t)n.point((r=i[t])[0],r[1]);n.lineEnd()}return}p>1&&2&o&&c.push(c.pop().concat(c.shift())),l.push(c.filter(y2))}}return c}}function y2(t){return t.length>1}function y3(t,e){return((t=t.x)[0]<0?t[1]-i8-1e-6:i8-t[1])-((e=e.x)[0]<0?e[1]-i8-1e-6:i8-e[1])}yQ.slice,yQ.map;let y5=y1(function(){return!0},function(t){var e,i=NaN,r=NaN,n=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,l){var a,o,h,u,d,c,p,g=s>0?i6:-i6,f=ri(s-i);1e-6>ri(f-i6)?(t.point(i,r=(r+l)/2>0?i8:-i8),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(g,r),t.point(s,r),e=0):n!==g&&f>=i6&&(1e-6>ri(i-n)&&(i-=1e-6*n),1e-6>ri(s-g)&&(s-=1e-6*g),a=i,o=r,h=s,u=l,r=ri(p=rh(a-h))>1e-6?rr((rh(o)*(c=rs(u))*rh(h)-rh(u)*(d=rs(o))*rh(a))/(d*c*p)):(o+u)/2,t.point(n,r),t.lineEnd(),t.lineStart(),t.point(g,r),e=0),t.point(i=s,r=l),n=g},lineEnd:function(){t.lineEnd(),i=r=NaN},clean:function(){return 2-e}}},function(t,e,i,r){var n;if(null==t)n=i*i8,r.point(-i6,n),r.point(0,n),r.point(i6,n),r.point(i6,0),r.point(i6,-n),r.point(0,-n),r.point(-i6,-n),r.point(-i6,0),r.point(-i6,n);else if(ri(t[0]-e[0])>1e-6){var s=t[0]<e[0]?i6:-i6;n=i*s/2,r.point(-s,n),r.point(0,n),r.point(s,n)}else r.point(e[0],e[1])},[-i6,-i8]);function y4(t,e){e=yG(e),e[0]-=t,y$(e);var i=rp(-e[1]);return((0>-e[2]?-i:i)+i7-1e-6)%i7}function y6(t,e,i,r){function n(n,s){return t<=n&&n<=i&&e<=s&&s<=r}function s(n,s,a,h){var u=0,d=0;if(null==n||(u=l(n,a))!==(d=l(s,a))||0>o(n,s)^a>0)do h.point(0===u||3===u?t:i,u>1?r:e);while((u=(u+a+4)%4)!==d);else h.point(s[0],s[1])}function l(r,n){return 1e-6>ri(r[0]-t)?n>0?0:3:1e-6>ri(r[0]-i)?n>0?2:1:1e-6>ri(r[1]-e)?+(n>0):n>0?3:2}function a(t,e){return o(t.x,e.x)}function o(t,e){var i=l(t,1),r=l(e,1);return i!==r?i-r:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(l){var o,h,u,d,c,p,g,f,m,y,v,b=l,_=yD(),x={point:C,lineStart:function(){x.point=w,h&&h.push(u=[]),y=!0,m=!1,g=f=NaN},lineEnd:function(){o&&(w(d,c),p&&m&&_.rejoin(),o.push(_.result())),x.point=C,m&&b.lineEnd()},polygonStart:function(){b=_,o=[],h=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,n=h.length;i<n;++i)for(var s,l,a=h[i],o=1,u=a.length,d=a[0],c=d[0],p=d[1];o<u;++o)s=c,l=p,c=(d=a[o])[0],p=d[1],l<=r?p>r&&(c-s)*(r-l)>(p-l)*(t-s)&&++e:p<=r&&(c-s)*(r-l)<(p-l)*(t-s)&&--e;return e}(),i=v&&e,n=(o=y0(o)).length;(i||n)&&(l.polygonStart(),i&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),n&&yW(o,a,e,s,l),l.polygonEnd()),b=l,o=h=u=null}};function C(t,e){n(t,e)&&b.point(t,e)}function w(s,l){var a=n(s,l);if(h&&u.push([s,l]),y)d=s,c=l,p=a,y=!1,a&&(b.lineStart(),b.point(s,l));else if(a&&m)b.point(s,l);else{var o=[g=Math.max(-1e9,Math.min(1e9,g)),f=Math.max(-1e9,Math.min(1e9,f))],_=[s=Math.max(-1e9,Math.min(1e9,s)),l=Math.max(-1e9,Math.min(1e9,l))];!function(t,e,i,r,n,s){var l,a=t[0],o=t[1],h=e[0],u=e[1],d=0,c=1,p=h-a,g=u-o;if(l=i-a,!p&&l>0)return;if(l/=p,p<0){if(l<d)return;l<c&&(c=l)}else if(p>0){if(l>c)return;l>d&&(d=l)}if(l=n-a,p||!(l<0)){if(l/=p,p<0){if(l>c)return;l>d&&(d=l)}else if(p>0){if(l<d)return;l<c&&(c=l)}if(l=r-o,g||!(l>0)){if(l/=g,g<0){if(l<d)return;l<c&&(c=l)}else if(g>0){if(l>c)return;l>d&&(d=l)}if(l=s-o,g||!(l<0)){if(l/=g,g<0){if(l>c)return;l>d&&(d=l)}else if(g>0){if(l<d)return;l<c&&(c=l)}return d>0&&(t[0]=a+d*p,t[1]=o+d*g),c<1&&(e[0]=a+c*p,e[1]=o+c*g),!0}}}}(o,_,t,e,i,r)?a&&(b.lineStart(),b.point(s,l),v=!1):(m||(b.lineStart(),b.point(o[0],o[1])),b.point(_[0],_[1]),a||b.lineEnd(),v=!1)}g=s,f=l,m=a}return x}}function y8(t,e){function i(i,r){return e((i=t(i,r))[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,r){return(i=e.invert(i,r))&&t.invert(i[0],i[1])}),i}function y9(t,e){return[ri(t)>i6?t+Math.round(-t/i7)*i7:t,e]}function y7(t,e,i){return(t%=i7)?e||i?y8(ve(t),vi(e,i)):ve(t):e||i?vi(e,i):y9}function vt(t){return function(e,i){return[(e+=t)>i6?e-i7:e<-i6?e+i7:e,i]}}function ve(t){var e=vt(t);return e.invert=vt(-t),e}function vi(t,e){var i=rs(t),r=rh(t),n=rs(e),s=rh(e);function l(t,e){var l=rs(e),a=rs(t)*l,o=rh(t)*l,h=rh(e),u=h*i+a*r;return[rn(o*n-u*s,a*i-h*r),rg(u*n+o*s)]}return l.invert=function(t,e){var l=rs(e),a=rs(t)*l,o=rh(t)*l,h=rh(e),u=h*n-o*s;return[rn(o*n+h*s,a*i+u*r),rg(u*i-a*r)]},l}function vr(t){return function(e){var i=new vn;for(var r in t)i[r]=t[r];return i.stream=e,i}}function vn(){}function vs(t,e,i){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),i2(i,t.stream(rq)),e(rq.result()),null!=r&&t.clipExtent(r),t}function vl(t,e,i){return vs(t,function(i){var r=e[1][0]-e[0][0],n=e[1][1]-e[0][1],s=Math.min(r/(i[1][0]-i[0][0]),n/(i[1][1]-i[0][1])),l=+e[0][0]+(r-s*(i[1][0]+i[0][0]))/2,a=+e[0][1]+(n-s*(i[1][1]+i[0][1]))/2;t.scale(150*s).translate([l,a])},i)}function va(t,e,i){return vl(t,[[0,0],e],i)}function vo(t,e,i){return vs(t,function(i){var r=+e,n=r/(i[1][0]-i[0][0]),s=(r-n*(i[1][0]+i[0][0]))/2,l=-n*i[0][1];t.scale(150*n).translate([s,l])},i)}function vh(t,e,i){return vs(t,function(i){var r=+e,n=r/(i[1][1]-i[0][1]),s=-n*i[0][0],l=(r-n*(i[1][1]+i[0][1]))/2;t.scale(150*n).translate([s,l])},i)}y9.invert=y9,vn.prototype={constructor:vn,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var vu=rs(30*re);function vd(t,e){var i;return+e?function(t,e){function i(r,n,s,l,a,o,h,u,d,c,p,g,f,m){var y=h-r,v=u-n,b=y*y+v*v;if(b>4*e&&f--){var _=l+c,x=a+p,C=o+g,w=rd(_*_+x*x+C*C),S=rg(C/=w),A=1e-6>ri(ri(C)-1)||1e-6>ri(s-d)?(s+d)/2:rn(x,_),M=t(A,S),k=M[0],T=M[1],R=k-r,B=T-n,P=v*R-y*B;(P*P/b>e||ri((y*R+v*B)/b-.5)>.3||l*c+a*p+o*g<vu)&&(i(r,n,s,l,a,o,k,T,A,_/=w,x/=w,C,f,m),m.point(k,T),i(k,T,A,_,x,C,h,u,d,c,p,g,f,m))}}return function(e){var r,n,s,l,a,o,h,u,d,c,p,g,f={point:m,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),f.lineStart=_},polygonEnd:function(){e.polygonEnd(),f.lineStart=y}};function m(i,r){i=t(i,r),e.point(i[0],i[1])}function y(){u=NaN,f.point=v,e.lineStart()}function v(r,n){var s=yG([r,n]),l=t(r,n);i(u,d,h,c,p,g,u=l[0],d=l[1],h=r,c=s[0],p=s[1],g=s[2],16,e),e.point(u,d)}function b(){f.point=m,e.lineEnd()}function _(){y(),f.point=x,f.lineEnd=C}function x(t,e){v(r=t,e),n=u,s=d,l=c,a=p,o=g,f.point=v}function C(){i(u,d,h,c,p,g,n,s,r,l,a,o,16,e),f.lineEnd=b,b()}return f}}(t,e):(i=t,vr({point:function(t,e){t=i(t,e),this.stream.point(t[0],t[1])}}))}var vc=vr({point:function(t,e){this.stream.point(t*re,e*re)}});function vp(t,e,i,r,n,s){var l=rs(s),a=rh(s),o=l*t,h=a*t,u=l/t,d=a/t,c=(a*i-l*e)/t,p=(a*e+l*i)/t;function g(t,s){return[o*(t*=r)-h*(s*=n)+e,i-h*t-o*s]}return g.invert=function(t,e){return[r*(u*t-d*e+c),n*(p-d*t-u*e)]},g}function vg(t){return vf(function(){return t})()}function vf(t){var e,i,r,n,s,l,a,o,h,u,d=150,c=480,p=250,g=0,f=0,m=0,y=0,v=0,b=0,_=1,x=1,C=null,w=y5,S=null,A=iX,M=.5;function k(t){return o(t[0]*re,t[1]*re)}function T(t){return(t=o.invert(t[0],t[1]))&&[t[0]*rt,t[1]*rt]}function R(){var t=vp(d,0,0,_,x,b).apply(null,e(g,f)),r=(b?vp:function(t,e,i,r,n){function s(s,l){return[e+t*(s*=r),i-t*(l*=n)]}return s.invert=function(s,l){return[(s-e)/t*r,(i-l)/t*n]},s})(d,c-t[0],p-t[1],_,x,b);return i=y7(m,y,v),a=y8(e,r),o=y8(i,a),l=vd(a,M),B()}function B(){return h=u=null,k}return k.stream=function(t){var e;return h&&u===t?h:h=vc((e=i,vr({point:function(t,i){var r=e(t,i);return this.stream.point(r[0],r[1])}}))(w(l(A(u=t)))))},k.preclip=function(t){return arguments.length?(w=t,C=void 0,B()):w},k.postclip=function(t){return arguments.length?(A=t,S=r=n=s=null,B()):A},k.clipAngle=function(t){return arguments.length?(w=+t?function(t){var e=rs(t),i=6*re,r=e>0,n=ri(e)>1e-6;function s(t,i){return rs(t)*rs(i)>e}function l(t,i,r){var n=yG(t),s=yG(i),l=[1,0,0],a=yZ(n,s),o=yV(a,a),h=a[0],u=o-h*h;if(!u)return!r&&t;var d=yZ(l,a),c=yK(l,e*o/u);yU(c,yK(a,-e*h/u));var p=yV(c,d),g=yV(d,d),f=p*p-g*(yV(c,c)-1);if(!(f<0)){var m=rd(f),y=yK(d,(-p-m)/g);if(yU(y,c),y=yj(y),!r)return y;var v,b=t[0],_=i[0],x=t[1],C=i[1];_<b&&(v=b,b=_,_=v);var w=_-b,S=1e-6>ri(w-i6);if(!S&&C<x&&(v=x,x=C,C=v),S||w<1e-6?S?x+C>0^y[1]<(1e-6>ri(y[0]-b)?x:C):x<=y[1]&&y[1]<=C:w>i6^(b<=y[0]&&y[0]<=_)){var A=yK(d,(-p+m)/g);return yU(A,c),[y,yj(A)]}}}function a(e,i){var n=r?t:i6-t,s=0;return e<-n?s|=1:e>n&&(s|=2),i<-n?s|=4:i>n&&(s|=8),s}return y1(s,function(t){var e,i,o,h,u;return{lineStart:function(){h=o=!1,u=1},point:function(d,c){var p,g,f=[d,c],m=s(d,c),y=r?m?0:a(d,c):m?a(d+(d<0?i6:-i6),c):0;!e&&(h=o=m)&&t.lineStart(),m!==o&&(!(g=l(e,f))||yH(e,g)||yH(f,g))&&(f[2]=1),m!==o?(u=0,m?(t.lineStart(),g=l(f,e),t.point(g[0],g[1])):(g=l(e,f),t.point(g[0],g[1],2),t.lineEnd()),e=g):n&&e&&r^m&&!(y&i)&&(p=l(f,e,!0))&&(u=0,r?(t.lineStart(),t.point(p[0][0],p[0][1]),t.point(p[1][0],p[1][1]),t.lineEnd()):(t.point(p[1][0],p[1][1]),t.lineEnd(),t.lineStart(),t.point(p[0][0],p[0][1],3))),!m||e&&yH(e,f)||t.point(f[0],f[1]),e=f,o=m,i=y},lineEnd:function(){o&&t.lineEnd(),e=null},clean:function(){return u|(h&&o)<<1}}},function(e,r,n,s){!function(t,e,i,r,n,s){if(i){var l=rs(e),a=rh(e),o=r*i;null==n?(n=e+r*i7,s=e-o/2):(n=y4(l,n),s=y4(l,s),(r>0?n<s:n>s)&&(n+=r*i7));for(var h,u=n;r>0?u>s:u<s;u-=o)h=yj([l,-a*rs(u),-a*rh(u)]),t.point(h[0],h[1])}}(s,t,i,n,e,r)},r?[0,-t]:[-i6,t-i6])}(C=t*re):(C=null,y5),B()):C*rt},k.clipExtent=function(t){return arguments.length?(A=null==t?(S=r=n=s=null,iX):y6(S=+t[0][0],r=+t[0][1],n=+t[1][0],s=+t[1][1]),B()):null==S?null:[[S,r],[n,s]]},k.scale=function(t){return arguments.length?(d=+t,R()):d},k.translate=function(t){return arguments.length?(c=+t[0],p=+t[1],R()):[c,p]},k.center=function(t){return arguments.length?(g=t[0]%360*re,f=t[1]%360*re,R()):[g*rt,f*rt]},k.rotate=function(t){return arguments.length?(m=t[0]%360*re,y=t[1]%360*re,v=t.length>2?t[2]%360*re:0,R()):[m*rt,y*rt,v*rt]},k.angle=function(t){return arguments.length?(b=t%360*re,R()):b*rt},k.reflectX=function(t){return arguments.length?(_=t?-1:1,R()):_<0},k.reflectY=function(t){return arguments.length?(x=t?-1:1,R()):x<0},k.precision=function(t){return arguments.length?(l=vd(a,M=t*t),B()):rd(M)},k.fitExtent=function(t,e){return vl(k,t,e)},k.fitSize=function(t,e){return va(k,t,e)},k.fitWidth=function(t,e){return vo(k,t,e)},k.fitHeight=function(t,e){return vh(k,t,e)},function(){return e=t.apply(this,arguments),k.invert=e.invert&&T,R()}}function vm(t){var e=0,i=i6/3,r=vf(t),n=r(e,i);return n.parallels=function(t){return arguments.length?r(e=t[0]*re,i=t[1]*re):[e*rt,i*rt]},n}function vy(t,e){var i=rh(t),r=(i+rh(e))/2;if(1e-6>ri(r)){var n=rs(t);function s(t,e){return[t*n,rh(e)/n]}return s.invert=function(t,e){return[t/n,rg(e*n)]},s}var l=1+i*(2*r-i),a=rd(l)/r;function o(t,e){var i=rd(l-2*r*rh(e))/r;return[i*rh(t*=r),a-i*rs(t)]}return o.invert=function(t,e){var i=a-e,n=rn(t,ri(i))*ru(i);return i*r<0&&(n-=i6*ru(t)*ru(i)),[n/r,rg((l-(t*t+i*i)*r*r)/(2*r))]},o}function vv(){return vm(vy).scale(155.424).center([0,33.6442])}function vb(){return vv().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function v_(t){return function(e,i){var r=rs(e),n=rs(i),s=t(r*n);return[s*n*rh(e),s*rh(i)]}}function vx(t){return function(e,i){var r=rd(e*e+i*i),n=t(r),s=rh(n);return[rn(e*s,r*rs(n)),rg(r&&i*s/r)]}}var vC=v_(function(t){return rd(2/(1+t))});vC.invert=vx(function(t){return 2*rg(t/2)});var vw=v_(function(t){return(t=rp(t))&&t/rh(t)});function vS(t,e){return[t,ra(rc((i8+e)/2))]}function vA(t){var e,i,r,n=vg(t),s=n.center,l=n.scale,a=n.translate,o=n.clipExtent,h=null;function u(){var s=i6*l(),a=n((function(t){function e(e){return e=t(e[0]*re,e[1]*re),e[0]*=rt,e[1]*=rt,e}return t=y7(t[0]*re,t[1]*re,t.length>2?t[2]*re:0),e.invert=function(e){return e=t.invert(e[0]*re,e[1]*re),e[0]*=rt,e[1]*=rt,e},e})(n.rotate()).invert([0,0]));return o(null==h?[[a[0]-s,a[1]-s],[a[0]+s,a[1]+s]]:t===vS?[[Math.max(a[0]-s,h),e],[Math.min(a[0]+s,i),r]]:[[h,Math.max(a[1]-s,e)],[i,Math.min(a[1]+s,r)]])}return n.scale=function(t){return arguments.length?(l(t),u()):l()},n.translate=function(t){return arguments.length?(a(t),u()):a()},n.center=function(t){return arguments.length?(s(t),u()):s()},n.clipExtent=function(t){return arguments.length?(null==t?h=e=i=r=null:(h=+t[0][0],e=+t[0][1],i=+t[1][0],r=+t[1][1]),u()):null==h?null:[[h,e],[i,r]]},u()}function vM(t){return rc((i8+t)/2)}function vk(t,e){var i=rs(t),r=t===e?rh(t):ra(i/rs(e))/ra(vM(e)/vM(t)),n=i*ro(vM(t),r)/r;if(!r)return vS;function s(t,e){n>0?e<-i8+1e-6&&(e=-i8+1e-6):e>i8-1e-6&&(e=i8-1e-6);var i=n/ro(vM(e),r);return[i*rh(r*t),n-i*rs(r*t)]}return s.invert=function(t,e){var i=n-e,s=ru(r)*rd(t*t+i*i),l=rn(t,ri(i))*ru(i);return i*r<0&&(l-=i6*ru(t)*ru(i)),[l/r,2*rr(ro(n/s,1/r))-i8]},s}function vT(t,e){return[t,e]}function vR(t,e){var i=rs(t),r=t===e?rh(t):(i-rs(e))/(e-t),n=i/r+t;if(1e-6>ri(r))return vT;function s(t,e){var i=n-e,s=r*t;return[i*rh(s),n-i*rs(s)]}return s.invert=function(t,e){var i=n-e,s=rn(t,ri(i))*ru(i);return i*r<0&&(s-=i6*ru(t)*ru(i)),[s/r,n-ru(r)*rd(t*t+i*i)]},s}vw.invert=vx(function(t){return t}),vS.invert=function(t,e){return[t,2*rr(rl(e))-i8]},vT.invert=vT;var vB=rd(3)/2;function vP(t,e){var i=rg(vB*rh(e)),r=i*i,n=r*r*r;return[t*rs(i)/(vB*(1.340264+-.24331799999999998*r+n*(.0062510000000000005+.034164*r))),i*(1.340264+-.081106*r+n*(893e-6+.003796*r))]}function vE(t,e){var i=rs(e),r=rs(t)*i;return[i*rh(t)/r,rh(e)/r]}function vI(t,e){var i=e*e,r=i*i;return[t*(.8707-.131979*i+r*(-.013791+r*(.003971*i-.001529*r))),e*(1.007226+i*(.015085+r*(-.044475+.028874*i-.005916*r)))]}function vL(t,e){return[rs(e)*rh(t),rh(e)]}function vF(t,e){var i=rs(e),r=1+rs(t)*i;return[i*rh(t)/r,rh(e)/r]}function vO(t,e){return[ra(rc((i8+e)/2)),-t]}vP.invert=function(t,e){for(var i,r,n=e,s=n*n,l=s*s*s,a=0;a<12&&(r=n*(1.340264+-.081106*s+l*(893e-6+.003796*s))-e,n-=i=r/(1.340264+-.24331799999999998*s+l*(.0062510000000000005+.034164*s)),l=(s=n*n)*s*s,!(1e-12>ri(i)));++a);return[vB*t*(1.340264+-.24331799999999998*s+l*(.0062510000000000005+.034164*s))/rs(n),rg(rh(n)/vB)]},vE.invert=vx(rr),vI.invert=function(t,e){var i,r=e,n=25;do{var s=r*r,l=s*s;r-=i=(r*(1.007226+s*(.015085+l*(-.044475+.028874*s-.005916*l)))-e)/(1.007226+s*(.045255+l*(-.311325+.259866*s-.005916*11*l)))}while(ri(i)>1e-6&&--n>0);return[t/(.8707+(s=r*r)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),r]},vL.invert=vx(rg),vF.invert=vx(function(t){return 2*rr(t)}),vO.invert=function(t,e){return[-e,2*rr(rl(t))-i8]},nw();let vD={},vH={albers:vb,albersusa:function(){var t,e,i,r,n,s,l=vb(),a=vv().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=vv().rotate([157,0]).center([-3,19.9]).parallels([8,18]),h={point:function(t,e){s=[t,e]}};function u(t){var e=t[0],l=t[1];return s=null,i.point(e,l),s||(r.point(e,l),s)||(n.point(e,l),s)}function d(){return t=e=null,u}return u.invert=function(t){var e=l.scale(),i=l.translate(),r=(t[0]-i[0])/e,n=(t[1]-i[1])/e;return(n>=.12&&n<.234&&r>=-.425&&r<-.214?a:n>=.166&&n<.234&&r>=-.214&&r<-.115?o:l).invert(t)},u.stream=function(i){var r,n;return t&&e===i?t:(n=(r=[l.stream(e=i),a.stream(i),o.stream(i)]).length,t={point:function(t,e){for(var i=-1;++i<n;)r[i].point(t,e)},sphere:function(){for(var t=-1;++t<n;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<n;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<n;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<n;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<n;)r[t].polygonEnd()}})},u.precision=function(t){return arguments.length?(l.precision(t),a.precision(t),o.precision(t),d()):l.precision()},u.scale=function(t){return arguments.length?(l.scale(t),a.scale(.35*t),o.scale(t),u.translate(l.translate())):l.scale()},u.translate=function(t){if(!arguments.length)return l.translate();var e=l.scale(),s=+t[0],u=+t[1];return i=l.translate(t).clipExtent([[s-.455*e,u-.238*e],[s+.455*e,u+.238*e]]).stream(h),r=a.translate([s-.307*e,u+.201*e]).clipExtent([[s-.425*e+1e-6,u+.12*e+1e-6],[s-.214*e-1e-6,u+.234*e-1e-6]]).stream(h),n=o.translate([s-.205*e,u+.212*e]).clipExtent([[s-.214*e+1e-6,u+.166*e+1e-6],[s-.115*e-1e-6,u+.234*e-1e-6]]).stream(h),d()},u.fitExtent=function(t,e){return vl(u,t,e)},u.fitSize=function(t,e){return va(u,t,e)},u.fitWidth=function(t,e){return vo(u,t,e)},u.fitHeight=function(t,e){return vh(u,t,e)},u.scale(1070)},azimuthalequalarea:function(){return vg(vC).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return vg(vw).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return vm(vk).scale(109.5).parallels([30,30])},conicequalarea:vv,conicequidistant:function(){return vm(vR).scale(131.154).center([0,13.9389])},equalearth:function(){return vg(vP).scale(177.158)},equirectangular:function(){return vg(vT).scale(152.63)},gnomonic:function(){return vg(vE).scale(144.049).clipAngle(60)},identity:function(){var t,e,i,r,n,s,l,a=1,o=0,h=0,u=1,d=1,c=0,p=null,g=1,f=1,m=vr({point:function(t,e){var i=b([t,e]);this.stream.point(i[0],i[1])}}),y=iX;function v(){return g=a*u,f=a*d,s=l=null,b}function b(i){var r=i[0]*g,n=i[1]*f;if(c){var s=n*t-r*e;r=r*t+n*e,n=s}return[r+o,n+h]}return b.invert=function(i){var r=i[0]-o,n=i[1]-h;if(c){var s=n*t+r*e;r=r*t-n*e,n=s}return[r/g,n/f]},b.stream=function(t){return s&&l===t?s:s=m(y(l=t))},b.postclip=function(t){return arguments.length?(y=t,p=i=r=n=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(p=i=r=n=null,iX):y6(p=+t[0][0],i=+t[0][1],r=+t[1][0],n=+t[1][1]),v()):null==p?null:[[p,i],[r,n]]},b.scale=function(t){return arguments.length?(a=+t,v()):a},b.translate=function(t){return arguments.length?(o=+t[0],h=+t[1],v()):[o,h]},b.angle=function(i){return arguments.length?(e=rh(c=i%360*re),t=rs(c),v()):c*rt},b.reflectX=function(t){return arguments.length?(u=t?-1:1,v()):u<0},b.reflectY=function(t){return arguments.length?(d=t?-1:1,v()):d<0},b.fitExtent=function(t,e){return vl(b,t,e)},b.fitSize=function(t,e){return va(b,t,e)},b.fitWidth=function(t,e){return vo(b,t,e)},b.fitHeight=function(t,e){return vh(b,t,e)},b},mercator:function(){return vA(vS).scale(961/i7)},naturalearth1:function(){return vg(vI).scale(175.295)},orthographic:function(){return vg(vL).scale(249.5).clipAngle(90.000001)},stereographic:function(){return vg(vF).scale(250).clipAngle(142)},transversemercator:function(){var t=vA(vO),e=t.center,i=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?i([t[0],t[1],t.length>2?t[2]+90:90]):[(t=i())[0],t[1],t[2]-90]},i([0,0,90]).scale(159.155)}},vz=["clipAngle","clipExtent","scale","translate","center","rotate","precision","reflectX","reflectY","parallels","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function vW(t,e){return function i(){let r=e();return r.type=t,r.path=nw().projection(r),r.copy=r.copy||function(){let t=i();return vz.forEach(e=>{r[e]&&t[e](r[e]())}),t.path.pointRadius(r.path.pointRadius()),t},r}}class vN{constructor(t){this.projection=(function(t,e){let i=t.toLowerCase();return arguments.length>1?vW(i,e):vH[i]?(vD[i]||(vD[i]=vW(i,vH[i])),vD[i]):null})(t.type)()}fit(t,e,i){this.projection.fitExtent([t,e],{type:"FeatureCollection",features:i})}center(t){var e,i;null==(i=null==(e=this.projection)?void 0:e.center)||i.call(e,t)}project(t){var e;return null==(e=this.projection)?void 0:e.call(this,t)}shape(t){var e,i;return null==(i=null==(e=this.projection)?void 0:e.path)?void 0:i.call(e,t)}invert(t){var e,i;return null==(i=null==(e=this.projection)?void 0:e.invert)?void 0:i.call(e,t)}scale(t){var e;if(null==(e=this.projection)?void 0:e.scale){if(void 0===t)return this.projection.scale();this.projection.scale(t)}}translate(t){var e;if(null==(e=this.projection)?void 0:e.scale){if(void 0===t)return this.projection.translate();this.projection.translate(t)}}evaluate(t,e,i){let r=this.projection.copy();return null==r?void 0:r.fitExtent([t,e],{type:"FeatureCollection",features:i})}}class vj{parserScrollEvent(t){return t?!(t.ctrlKey||0===t.deltaY&&0===t.deltaX)&&(t.scrollX=t.deltaX,t.scrollY=t.deltaY,t):t}parserZoomEvent(t){if(!t)return t;let e=Math.pow(1.0005,-t.deltaY*Math.pow(16,t.deltaMode));return t.zoomDelta=e,t.zoomX=t.canvasX,t.zoomY=t.canvasY,t}clearZoom(){}clearScroll(){}clearDrag(){}}class vG{constructor(){this._lastScale=0}clearZoom(){this._lastScale=0}parserZoomEvent(t){let e=t.scale;if(0===this._lastScale)return this._lastScale=e,t;t.zoomDelta=e/this._lastScale;let i=t.center;return t.zoomX=i.x,t.zoomY=i.y,this._lastScale=e,t}parserScrollEvent(t){return t}clearScroll(){}clearDrag(){}}function vV(t){return t===rM["desktop-browser"]||t===rM["desktop-miniApp"]?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside"],zoom:"wheel",zoomEnd:"pointerup",scroll:"wheel",trigger:vj}:eI(t)||eL(t)?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside","pointerleave"],zoom:"pinch",zoomEnd:"pinchend",scroll:"pan",scrollEnd:"panend",trigger:vG}:null}let vZ={debounce:ij,throttle:iG};class vU{constructor(){this._isGestureListener=!1}initZoomable(t,e=rM["desktop-browser"]){this._eventObj=t,this._renderMode=e,this._gestureController=this._option.getCompiler()._gestureController,this._isGestureListener=eI(this._renderMode)||eL(this._renderMode),vV(this._renderMode)&&(this._clickEnable=!0,this._zoomableTrigger=new(this._getZoomTriggerEvent("trigger")))}_getZoomTriggerEvent(t){return vV(this._renderMode)[t]}_zoomEventDispatch(t,e,i,r){if(!this._isGestureListener&&!t.event)return;let n=this._isGestureListener?t:t.event.clone();this._zoomableTrigger.parserZoomEvent(n);let{zoomDelta:s,zoomX:l,zoomY:a,path:o}=n;if(!r&&!o.some(t=>t.name&&t.name.includes("region"))||er(s)||!p$({x:l,y:a},this._getRegionOrSeriesLayout(e),!1))return;this._clearDragEvent(),this._zoomableTrigger.clearScroll();let h={};i&&(h=i({zoomDelta:s,zoomX:l,zoomY:a},n)),this._eventObj.emit("zoom",Object.assign(Object.assign({scale:n.zoomDelta,scaleCenter:{x:n.zoomX,y:n.zoomY}},h),{model:this}))}_getRegionOrSeriesLayout(t){"region"!==t.type&&(t=t.getRegion());let{x:e,y:i,width:r,height:n}=t.layout.getLayout();return{x1:e,y1:i,x2:e+r,y2:i+n}}_bindZoomEventAsRegion(t,e,i,r){var n,s;let l=null!=(n=null==r?void 0:r.delayType)?n:"throttle",a=null!=(s=null==r?void 0:r.delayTime)?s:0,o=this._isGestureListener?this._gestureController:t,h=this._isGestureListener?[this._getZoomTriggerEvent("zoom")]:[this._getZoomTriggerEvent("zoom"),{level:rF.chart,consume:!0}],u=this._isGestureListener?[this._getZoomTriggerEvent("zoomEnd")]:[this._getZoomTriggerEvent("zoomEnd"),{level:rF.chart,consume:!1}];o.on(...u,vZ[l](t=>{this._zoomableTrigger.clearZoom()},a)),o.on(...h,vZ[l](t=>{var n;this._zoomEventDispatch(t,e,i,null!=(n=null==r?void 0:r.allowComponentZoom)&&n)},a))}initZoomEventOfSeries(t,e,i){this._option.disableTriggerEvent||vV(this._renderMode)&&this._bindZoomEventAsRegion(t.event,t,e,i)}initZoomEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||vV(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&this._bindZoomEventAsRegion(t.event,t,i,r)}):this._bindZoomEventAsRegion(this._eventObj,t,i,r)})}_scrollEventDispatch(t,e,i){let r=!1;if(!this._isGestureListener&&(!t.event||this._option.disableTriggerEvent))return r;let n=this._isGestureListener?t:t.event;this._zoomableTrigger.parserScrollEvent(n);let{scrollX:s,scrollY:l,canvasX:a,canvasY:o}=n;return er(s)&&er(l)||p$({x:a,y:o},this._getRegionOrSeriesLayout(e),!1)&&(this._clearDragEvent(),this._zoomableTrigger.clearZoom(),i&&(r=i({scrollX:s,scrollY:l},n)),this._eventObj.emit("scroll",{scrollX:s,scrollY:l,model:this})),r}_bindScrollEventAsRegion(t,e,i,r){var n,s;let l=null!=(n=null==r?void 0:r.delayType)?n:"throttle",a=null!=(s=null==r?void 0:r.delayTime)?s:0,o=this._isGestureListener?this._gestureController:t,h=this._isGestureListener?[this._getZoomTriggerEvent("scroll")]:[this._getZoomTriggerEvent("scroll"),{level:rF.chart,consume:!0}],u=this._isGestureListener?[this._getZoomTriggerEvent("scrollEnd")]:[this._getZoomTriggerEvent("scrollEnd"),{level:rF.chart,consume:!1}];o.on(...u,vZ[l](t=>{this._zoomableTrigger.clearScroll()},a)),o.on(...h,vZ[l](t=>this._scrollEventDispatch(t,e,i),a))}initScrollEventOfSeries(t,e,i){vV(this._renderMode)&&this._bindScrollEventAsRegion(t.event,t,e,i)}initScrollEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||vV(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&this._bindScrollEventAsRegion(t.event,t,i,r)}):this._bindScrollEventAsRegion(this._eventObj,t,i,r)})}_bindDragEventAsRegion(t,e,i,r){t.on(this._getZoomTriggerEvent("start"),{level:rF.chart},t=>{if(!t.event)return;let{event:n}=t;p$({x:n.canvasX,y:n.canvasY},this._getRegionOrSeriesLayout(e),!1)&&this._handleDrag(t,i,r)}),t.on("click",{level:rF.chart},()=>!this._clickEnable)}initDragEventOfSeries(t,e,i){this._option.disableTriggerEvent||vV(this._renderMode)&&t.event.on(this._getZoomTriggerEvent("start"),{level:rF.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},t=>{this._handleDrag(t,e,i)})}initDragEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||vV(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&(t.event.on(this._getZoomTriggerEvent("start"),{level:rF.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},t=>{this._handleDrag(t,i)}),t.event.on("click",{level:rF.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>!this._clickEnable))}):this._bindDragEventAsRegion(this._eventObj,t,i,r)})}_clearDragEvent(){let t=this._getZoomTriggerEvent("move"),e=this._getZoomTriggerEvent("end");this._handleDragMouseMove&&(this._eventObj.off(t,{level:rF.chart,source:rL.chart},this._handleDragMouseMove),this._handleDragMouseMove=void 0),this._handleDragMouseUp&&(e.forEach(t=>{this._eventObj.off(t,{level:rF.chart,source:rL.chart},this._handleDragMouseUp),this._eventObj.allow(t)}),this._handleDragMouseUp=void 0)}isDragEnable(t){if(this._isGestureListener&&this._gestureController){let t=this._gestureController.cachedEvents;return!t||t.length<2}return!0}_handleDrag(t,e,i){var r,n,s;if(this._clearDragEvent(),this._option.disableTriggerEvent||(this._clickEnable=!1,!this.isDragEnable(t.event)))return;this._zoomableTrigger.clearZoom(),this._zoomableTrigger.clearScroll();let l=null!=(r=null==i?void 0:i.delayType)?r:"throttle",a=null!=(n=null==i?void 0:i.delayTime)?n:0,o=null==(s=null==i?void 0:i.realTime)||s,h=this._getZoomTriggerEvent("move"),u=this._getZoomTriggerEvent("end"),d=t.event,c=d.canvasX,p=d.canvasY,g=d.canvasX,f=d.canvasY;this._handleDragMouseUp=vZ[l](t=>{this._clickEnable=!0;let i=t.event,r=[i.canvasX-g,i.canvasY-f];g=i.canvasX,f=i.canvasY,!o&&e&&e(r,t.event),this._eventObj.emit("panend",{delta:r,model:this}),this._clearDragEvent()},a),this._handleDragMouseMove=vZ[l](t=>{if(!this.isDragEnable(t.event))return;this._clickEnable=!1,u.forEach(t=>{this._eventObj.prevent(t,{handler:this._handleDragMouseUp,level:rF.chart})});let i=t.event,r=[i.canvasX-c,i.canvasY-p];c=i.canvasX,p=i.canvasY,o&&e&&e(r,t.event),this._eventObj.emit("panmove",{delta:r,model:this})},a),this._eventObj.on(h,{level:rF.chart,source:rL.chart},this._handleDragMouseMove),u.forEach(t=>{this._eventObj.on(t,{level:rF.chart,source:rL.chart},this._handleDragMouseUp)})}}class vK extends gz{constructor(){var t,e;super(...arguments),this.type=rk.geoCoordinate,this.name=rk.geoCoordinate,this.layoutType="none",this.layoutZIndex=H.Mark,this._projectionSpec={name:(t=this.type,e=this.id,`${st}_${e}_${t}`),type:"mercator"},this._actualScale=1,this._initialScale=1,this.effect={scaleUpdate:()=>{this.coordinateHelper()}},this._handleChartZoom=(t,e)=>{var i,r,n,s,l,a;let o=t.zoomDelta,h=this._actualScale;return this._actualScale*=o,this._actualScale<(null==(i=this._spec.zoomLimit)?void 0:i.min)?(this._actualScale=null==(r=this._spec.zoomLimit)?void 0:r.min,o=(null==(n=this._spec.zoomLimit)?void 0:n.min)/h):this._actualScale>(null==(s=this._spec.zoomLimit)?void 0:s.max)&&(this._actualScale=null==(l=this._spec.zoomLimit)?void 0:l.max,o=(null==(a=this._spec.zoomLimit)?void 0:a.max)/h),this.zoom(o,[t.zoomX,t.zoomY]),{scale:o,totalScale:this._actualScale}},this.pan=(t=[0,0])=>{var e,i,r;let n=null!=(i=null==(e=this._projection)?void 0:e.translate())?i:[0,0],s=n[0],l=n[1];s+=t[0],l+=t[1],null==(r=this._projection)||r.translate([s,l])}}get longitudeField(){return this._longitudeField}get latitudeField(){return this._latitudeField}get projectionSpec(){return this._projectionSpec}setProjection(t){this._projectionSpec=Object.assign(Object.assign({},t),{name:this._projectionSpec.name})}getZoom(){return this._actualScale}static getSpecInfo(t){if(er(t))return null;let e=[];return t.region.forEach((t,i)=>{if("geo"===t.coordinate){let r=Object.assign(Object.assign({},t),{padding:0});e.push({spec:r,regionIndex:i,type:rk.geoCoordinate,specInfoPath:["component","geoCoordinate",i]})}}),e}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec(),this._spec.roam&&this.initZoomable(this.event,this._option.mode),this._projectionSpec=ir(this._projectionSpec,this._spec.projection),this._projectionSpec.zoom>(null==(t=this._spec.zoomLimit)?void 0:t.max)&&(this._projectionSpec.zoom=this._spec.zoomLimit.max),this._projectionSpec.zoom<(null==(e=this._spec.zoomLimit)?void 0:e.min)&&(this._projectionSpec.zoom=this._spec.zoomLimit.min),this._actualScale=null!=(i=this._projectionSpec.zoom)?i:1,this._initialScale=this._actualScale,this._longitudeField=this._spec.longitudeField,this._latitudeField=this._spec.latitudeField}created(){super.created(),this._regions=this._option.getRegionsInIndex([this._option.regionIndex]),this.initProjection(),this.coordinateHelper(),this.initEvent(),this._initCenterCache()}dispatchZoom(t,e){let i=e||{x:this.getLayoutStartPoint().x+this.getLayoutRect().width/2,y:this.getLayoutStartPoint().y+this.getLayoutRect().height/2},{scale:r,totalScale:n}=this._handleChartZoom({zoomDelta:t,zoomX:i.x,zoomY:i.y});1!==r&&this.event.emit("zoom",{scale:r,scaleCenter:i,totalScale:n,model:this})}initEvent(){var t,e,i;this.event.on(rI.scaleUpdate,{filter:({model:t})=>(null==t?void 0:t.id)===this.id},this.effect.scaleUpdate.bind(this));let{roam:r}=this._spec;if(r){let n=!0,s=!0,l=!1;!0!==r&&(n=null==(t=r.zoom)||t,s=null==(e=r.drag)||e,l=null!=(i=r.blank)&&i),n&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom),s&&this.initDragEventOfRegions(this._regions,l?null:()=>!0,this.pan),this._regions.forEach(t=>{t.getSeries().forEach(t=>{t.event.on("zoom",e=>(t.handleZoom(e),!0)),t.event.on("panmove",e=>(t.handlePan(e),!0))})})}}initProjection(){var t;this._projection=new vN(this._projectionSpec),null!==this._projection.projection||null==(t=this._option)||t.onError("unsupported projection type!")}coordinateHelper(){let t={longitudeField:this._longitudeField,latitudeField:this._latitudeField,dataToPosition:this.dataToPosition.bind(this),dataToLongitude:this.dataToLongitude.bind(this),dataToLatitude:this.dataToLatitude.bind(this),shape:this.shape.bind(this),getCoordinateId:()=>this.id};this._regions.forEach(e=>{e.getSeries().forEach(e=>{e.type===rR.map||e.type===rR.pictogram?e.setCoordinateHelper(t):(e.setXAxisHelper(Object.assign(Object.assign({},t),{isContinuous:!0,dataToPosition:(t,i)=>{var r;let n=t[0];if(er(n)&&(null==i?void 0:i.datum)){let t=i.datum[e.getDimensionField()[0]];n=null==(r=this._centerCache.get(t))?void 0:r.x}return this.dataToLongitude(n)},valueToPosition:(t,i)=>{var r;if(er(t)&&(null==i?void 0:i.datum)){let n=i.datum[e.getDimensionField()[0]];t=null==(r=this._centerCache.get(n))?void 0:r.x}return this.dataToLongitude(t)},getFields:()=>[this._longitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})),e.setYAxisHelper(Object.assign(Object.assign({},t),{isContinuous:!0,dataToPosition:(t,i)=>{var r;let n=t[0];if(er(n)&&(null==i?void 0:i.datum)){let t=i.datum[e.getDimensionField()[0]];n=null==(r=this._centerCache.get(t))?void 0:r.y}return this.dataToLatitude(n)},valueToPosition:(t,i)=>{var r;if(er(t)&&(null==i?void 0:i.datum)){let n=i.datum[e.getDimensionField()[0]];t=null==(r=this._centerCache.get(n))?void 0:r.y}return this.dataToLatitude(t)},getFields:()=>[this._latitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})))})})}onLayoutEnd(){this.setLayoutRect(this._regions[0].getLayoutRect()),this.setLayoutStartPosition(this._regions[0].getLayoutStartPoint());let{width:t,height:e}=this.getLayoutRect(),{translate:i,scale:r,center:n}=this.evaluateProjection([0,0],[t,e]);i&&this._projection.translate(i),r&&this._projection.scale(r),n&&this._projection.center(n),pX(this._regions,t=>{var e;if(t.type===rR.map||t.type===rR.pictogram){null==(e=t.areaPath)||e.clear();let i=t.getRootMark().getProduct();i&&i.attribute.postMatrix&&i.setAttributes({postMatrix:new yM})}}),this._actualScale=this._initialScale,super.onLayoutEnd()}collectFeatures(){let t=[];return this._regions.forEach(e=>{e.getSeries().forEach(e=>{var i,r;e.type!==rR.map&&e.type!==rR.pictogram||t.push(...null!=(r=null==(i=e.getMapViewData())?void 0:i.latestData)?r:[])})}),t}dataToPosition(t=[]){var e;let i=null==(e=this._projection)?void 0:e.project([t[0],t[1]]);return{x:null==i?void 0:i[0],y:null==i?void 0:i[1]}}dataToLatitude(t){var e;let i=null==(e=this._projection)?void 0:e.project([0,t]);return null==i?void 0:i[1]}dataToLongitude(t){var e;let i=null==(e=this._projection)?void 0:e.project([t,0]);return null==i?void 0:i[0]}zoom(t,e=[0,0]){var i,r,n,s,l,a;let o=null!=(r=null==(i=this._projection)?void 0:i.scale())?r:0,h=null!=(s=null==(n=this._projection)?void 0:n.translate())?s:[0,0],u=h[0],d=h[1];o*=t,u-=(e[0]-u)*(t-1),d-=(e[1]-d)*(t-1),null==(l=this._projection)||l.scale(o),null==(a=this._projection)||a.translate([u,d])}shape(t){return this._projection.shape(t)}invert(t){return this._projection.invert(t)}evaluateProjection(t,e){var i;let r=this._projection.evaluate(t,e,this.collectFeatures()),n=r.translate(),s=r.scale()*this._initialScale,l=null!=(i=this._projectionSpec.center)?i:r.invert([e[0]/2,e[1]/2]);return l&&(n=[e[0]/2,e[1]/2]),{translate:n,scale:s,center:l}}_initCenterCache(){this._centerCache||(this._centerCache=new Map),this._regions.forEach(t=>{t.getSeries().forEach(t=>{var e,i;"map"===t.type&&(null!=(i=null==(e=t.getMapViewData())?void 0:e.latestData)?i:[]).forEach((e={})=>{let i=e[t.getDimensionField()[0]]||e[yR],r=t.getDatumCenter(e);i&&t8(r)&&this._centerCache.set(i,{x:r[0],y:r[1]})})})})}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reMake=["roam","longitudeField","latitudeField","projection","zoomLimit"].some(i=>!t5(null==e?void 0:e[i],t[i]))),i}release(){super.release(),this._centerCache&&this._centerCache.clear(),this._centerCache=null}}vK.type=rk.geoCoordinate,cG(vK,vU);let v$=()=>{iv.registerComponent(vK.type,vK)};class vY extends cE{_transformLabelSpec(t){this._addMarkLabelSpec(t,"area",void 0,void 0,!1)}}class vX extends yT{constructor(){super(...arguments),this.type=rR.map,this.transformerConstructor=vY,this._areaCache=new Map}getNameMap(){return this._nameMap}get areaPath(){return this._areaCache}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.map=this._spec.map,this._nameMap=this._spec.nameMap,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this._spec.nameProperty&&(this._nameProperty=this._spec.nameProperty),this._spec.centroidProperty&&(this._centroidProperty=this._spec.centroidProperty),this.map||null==(t=this._option)||t.onError(`map type '${this.map}' is not specified !`),nQ.get(this.map)||null==(e=this._option)||e.onError(`'${this.map}' data is not registered !`)}initData(){var t,e;super.initData(),nq(this._dataSet,"copyDataView",n3),nq(this._dataSet,"map",yB),nq(this._dataSet,"lookup",yk);let i=nQ.get(this.map);i||null==(t=this._option)||t.onError("no valid map data found!");let r=new el(this._dataSet,{name:`map_${this.id}_data`});r.parse([i],{type:"dataview"}).transform({type:"copyDataView",options:{deep:!0},level:F.copyDataView}).transform({type:"map",options:{nameMap:this._nameMap,nameProperty:this._nameProperty}}).transform({type:"lookup",options:{from:()=>{var t;return null==(t=this._data)?void 0:t.getLatestData()},key:yR,fields:this._nameField,set:(t,e)=>{e&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}}}),null==(e=this._data)||e.getDataView().target.addListener("change",r.reRunAllTransform),this._mapViewData=new aC(this._option,r)}compileData(){var t;super.compileData(),null==(t=this._mapViewData)||t.compile()}initMark(){this._pathMark=this._createMark(vX.mark.area,{groupKey:this.getDimensionField()[0],isSeriesMark:!0},{morph:cR(this._spec,vX.mark.area.name),morphElementKey:this.getDimensionField()[0]}),this._pathMark.setData(this._mapViewData)}initMarkStyle(){let t=this._pathMark;t&&(this.setMarkStyle(t,{fill:t=>{var e,i,r,n;return t8(t[null!=(e=this._seriesField)?e:sl])?(null!=(i=this._option.globalScale.getScale("color"))?i:this._getDefaultColorScale()).scale(t[null!=(r=this._seriesField)?r:sl]):null==(n=this._spec)?void 0:n.defaultFillColor},path:this.getPath.bind(this)},"normal",W.Series),t.setPostProcess("fill",t=>t8(t)?t:this._spec.defaultFillColor),this.setMarkStyle(t,{smoothScale:!0},"normal",W.Built_In))}initLabelMarkStyle(t){t&&(this._labelMark=t,this.setMarkStyle(t,{text:t=>this.getDatumName(t),x:t=>{var e;return null==(e=this.dataToPosition(t))?void 0:e.x},y:t=>{var e;return null==(e=this.dataToPosition(t))?void 0:e.y}}))}initAnimation(){var t;this._pathMark.setAnimationConfig(cA(null==(t=iv.getAnimationInKey("fadeInOut"))?void 0:t(),cM("area",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new yP(this),this._pathMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pathMark)}getPath(t){var e;let i=this._areaCache.get(t[sn]);if(i)return i.shape;let r=null==(e=this._coordinateHelper)?void 0:e.shape(t);return this._areaCache.set(t[sn],{shape:r}),r}onEvaluateEnd(){this._mapViewData.updateData()}getDimensionField(){return[this.nameField]}getMeasureField(){return[this.valueField]}release(){super.release(),this._areaCache.clear(),this._nameMap={},this._mapViewData=null}handleZoom(t){var e;let{scale:i,scaleCenter:r}=t;if(1===i)return;let n=this.getRootMark().getProduct();n&&(n.attribute.postMatrix||n.setAttributes({postMatrix:new yM}),n.scale(i,i,r));let s=null==(e=this._labelMark)?void 0:e.getComponent();s&&s.renderInner()}handlePan(t){var e;let{delta:i}=t;if(0===i[0]&&0===i[1])return;let r=this.getRootMark().getProduct();r&&(r.attribute.postMatrix||r.setAttributes({postMatrix:new yM}),r.translate(i[0],i[1]));let n=null==(e=this._labelMark)?void 0:e.getComponent();n&&n.renderInner()}getDatumCenter(t){var e,i,r,n;return this._centroidProperty&&(null==(e=t.properties)?void 0:e[this._centroidProperty])?null==(i=t.properties)?void 0:i[this._centroidProperty]:en(t.centroidX*t.centroidY)?[t.centroidX,t.centroidY]:(null==(r=t.properties)?void 0:r.center)?t.properties.center:(null==(n=t.properties)?void 0:n.centroid)?t.properties.centroid:[Number.NaN,Number.NaN]}getDatumName(t){var e;if(t[this.nameField])return t[this.nameField];let i=null==(e=t.properties)?void 0:e[this._nameProperty];if(i){if(this._spec.nameMap&&this._spec.nameMap[i])return this._spec.nameMap[i];if(this._spec.showDefaultName||!this._spec.nameMap)return i}return""}dataToPositionX(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}dataToPositionY(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}viewDataUpdate(t){var e,i,r;super.viewDataUpdate(t),null==(i=null==(e=this._mapViewData)?void 0:e.getDataView())||i.reRunAllTransform(),null==(r=this._mapViewData)||r.updateData()}_getDataIdKey(){return sn}getActiveMarks(){return[this._pathMark]}}vX.type=rR.map,vX.mark=yO,vX.builtInTheme={map:{defaultFillColor:"#f3f3f3",area:{style:{lineWidth:.5,strokeOpacity:1,stroke:"black",fillOpacity:1}},label:{interactive:!1,style:{fontSize:{type:"token",key:"l6FontSize"},lineHeight:{type:"token",key:"l6LineHeight"},textBaseline:"middle",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},stroke:{type:"palette",key:"backgroundColor"}}}}},vX.transformerConstructor=vY;let vq=()=>{v$(),yF(),iv.registerSeries(vX.type,vX),iv.registerImplement("registerMap",n0),iv.registerImplement("unregisterMap",n1),u5()};class vJ extends fD{_isValidSeries(t){return t===rR.map}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["type","nameField","valueField","map","nameProperty","centroidProperty","nameMap","area","defaultFillColor","showDefaultName"])}transformSpec(t){super.transformSpec(t),t.region.forEach(t=>{t.coordinate="geo"}),super.transformSeriesSpec(t)}}class vQ extends fV{constructor(){super(...arguments),this.transformerConstructor=vJ,this.type="map",this.seriesType=rR.map}}vQ.type="map",vQ.seriesType=rR.map,vQ.transformerConstructor=vJ;let v0=()=>{mx(),vq(),iv.registerChart(vQ.type,vQ)};class v1 extends cI{constructor(){super(...arguments),this.coordinate="polar",this._outerRadius=.6,this._innerRadius=0,this._angleField=[],this._radiusField=[],this._sortDataByAxis=!1}get outerRadius(){return this._outerRadius}get innerRadius(){return this._innerRadius}getAngleField(){return this._angleField}setAngleField(t){return this._angleField=t8(t)?ed(t):[],this._angleField}getRadiusField(){return this._radiusField}setRadiusField(t){return this._radiusField=t8(t)?ed(t):[],this._radiusField}get innerRadiusField(){return this._innerRadiusField}setInnerRadiusField(t){return this._innerRadiusField=ed(t),this._innerRadiusField}get radiusScale(){return this._radiusScale}setRadiusScale(t){return this._radiusScale=t,t}get angleScale(){return this._angleScale}setAngleScale(t){return this._angleScale=t,t}get angleAxisHelper(){return this._angleAxisHelper}set angleAxisHelper(t){this._angleAxisHelper=t,this.onAngleAxisHelperUpdate()}get radiusAxisHelper(){return this._radiusAxisHelper}set radiusAxisHelper(t){this._radiusAxisHelper=t,this.onRadiusAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getCenter=()=>this.angleAxisHelper.center(),this._markAttributeContext.getLayoutRadius=()=>this._computeLayoutRadius()}valueToPosition(t,e){if(er(t)||er(e)||!this.angleAxisHelper||!this.radiusAxisHelper)return{x:Number.NaN,y:Number.NaN};let i=this.radiusAxisHelper.dataToPosition(ed(e));if(i<0){if("break"===this._invalidType||"link"===this._invalidType)return{x:Number.NaN,y:Number.NaN};if("zero"===this._invalidType)return this.angleAxisHelper.center()}let r=this.angleAxisHelper.dataToPosition(ed(t));return this.angleAxisHelper.coordToPoint({angle:r,radius:i})}dataToPosition(t,e){return t&&this.angleAxisHelper&&this.radiusAxisHelper?e&&!this.isDatumInViewData(t)?null:this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getDatumPositionValues(t,this._radiusField)):null}dataToPositionX(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.x}dataToPositionY(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.y}dataToPositionZ(t){return 0}positionToData(t){}radiusToData(t){}angleToData(t){}getStatisticFields(){var t,e;let i=[];return(null==(t=this.radiusAxisHelper)?void 0:t.getScale)&&this._radiusField.forEach(t=>{let e={key:t,operations:[]};ls(this.radiusAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],i.push(e)}),(null==(e=this.angleAxisHelper)?void 0:e.getScale)&&this._angleField.forEach(t=>{let e={key:t,operations:[]};ls(this.angleAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],i.push(e)}),i}setAttrFromSpec(){super.setAttrFromSpec(),t8(this._spec.outerRadius)&&(this._outerRadius=this._spec.outerRadius),t8(this._spec.radius)&&(this._outerRadius=this._spec.radius),t8(this._spec.innerRadius)&&(this._innerRadius=this._spec.innerRadius),t8(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)}onRadiusAxisHelperUpdate(){this.onMarkPositionUpdate()}onAngleAxisHelperUpdate(){this.onMarkPositionUpdate()}afterInitMark(){super.afterInitMark()}_computeLayoutRadius(){let t=this._angleAxisHelper||this._radiusAxisHelper;if(t)return t.layoutRadius();let{width:e,height:i}=this._region.getLayoutRect();return Math.min(e/2,i/2)}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(rI.scaleDomainUpdate,{filter:t=>{var e;return t.model.id===(null==(e=this._angleAxisHelper)?void 0:e.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var t,e;(null==(e=null==(t=this.getViewData())?void 0:t.latestData)?void 0:e.length)&&cF(this.angleAxisHelper,this._angleField[0],this.getViewData().latestData)}getInvalidCheckFields(){let t=[];return this.angleAxisHelper.isContinuous&&this._angleField.forEach(e=>{t.push(e)}),this.radiusAxisHelper.isContinuous&&this._radiusField.forEach(e=>{t.push(e)}),t}}function v2(t){return ev(t)?Number.parseFloat(t):0}let v3=(t,e)=>{let{asStartAngle:i,asEndAngle:r,asMiddleAngle:n,asRadian:s,asRatio:l,asQuadrant:a,asK:o,showAllZero:h,supportNegative:u,showEmptyCircle:d}=e,c=e.angleField(),p=e.startAngle(),g=e.endAngle(),f=e.minAngle(),m=t.map(t=>Object.assign({},t));if(!m||0===m.length)return m;if(!h&&d&&v5(m,c,u))return[];let y=(t,e,l)=>{var o;t[i]=e,t[r]=e+l,t[n]=e+l/2,t[s]=l,t[a]=(o=ab(o=e+l/2))>0&&o<=Math.PI/2?2:o>Math.PI/2&&o<=Math.PI?3:o>Math.PI&&o<=3*Math.PI/2?4:1},v=0,b=-1/0,_=!0;for(let t=0;t<m.length;t++){let e=u?Math.abs(v2(m[t][c])):v2(m[t][c]);v+=e,b=Math.max(e,b),_&&0!==e&&(_=!1),m[t][gx]=e}let x=m.map(t=>Number(t[c])),C=g-p,w=p,S=C,A=0,M=function(t,e=2){let i=t.reduce((t,e)=>t+(isNaN(e)?0:e),0);if(0===i)return 0;let r=Math.pow(10,e),n=t.map(t=>(isNaN(t)?0:t)/i*r*100),s=100*r,l=n.map(t=>Math.floor(t)),a=l.reduce((t,e)=>t+e,0),o=n.map((t,e)=>t-l[e]);for(;a<s;){let t=Number.NEGATIVE_INFINITY,e=null;for(let i=0;i<o.length;i++)o[i]>t&&(t=o[i],e=i);++l[e],o[e]=0,++a}return l.map(t=>t/r)}(x);if(m.forEach((t,e)=>{let i=t[gx],r=v?i/v:0,n=r*C;n<f?(n=f,S-=f):A+=i;let s=w,a=w+n;t[l]=r,t[o]=b?i/b:0,t._percent_=M[e],y(t,s,n),w=a}),S<C)if(S<=.001){let t=C/m.length;m.forEach((e,i)=>{y(e,p+i*t,t)})}else{let t=S/A;w=p,m.forEach(e=>{let i=e[s]===f?f:e[gx]*t;y(e,w,i),w+=i})}if(0!==v&&(m[m.length-1][r]=g),_&&h){let t=C/m.length;m.forEach((e,i)=>{y(e,p+i*t,t)})}return m},v5=(t,e,i)=>!!er(t)||0===t.length||!!t.every(t=>0===v2(t[e]))||!i&&0===t.reduce((t,i)=>t+v2(i[e]),0);function v4(t,e,i){return(r,n,s)=>e?"radius"===t.growField?{overall:0}:{overall:t.growFrom(r,n,i)}:{overall:!1}}let v6=t=>({type:"radius"===t.growField?"growRadiusIn":"growAngleIn",options:v4(t,!0,O.appear)}),v8={type:"fadeIn"},v9=t=>({type:"radius"===t.growField?"growRadiusIn":"growAngleIn",easing:"linear",options:v4(t,!0,O.enter)}),v7=t=>({type:"radius"===t.growField?"growRadiusOut":"growAngleOut",easing:"linear",options:v4(t,!0,O.exit)}),bt=t=>({type:"radius"===t.growField?"growRadiusOut":"growAngleOut",options:v4(t,!0,O.exit)});function be(t,e){if(!1===e)return{};switch(e){case"fadeIn":return v8;case"growRadius":return v6(Object.assign(Object.assign({},t),{growField:"radius"}));default:return v6(Object.assign(Object.assign({},t),{growField:"angle"}))}}let bi=()=>{iv.registerAnimation("pie",(t,e)=>({appear:be(t,e),enter:v9(t),exit:v7(t),disappear:bt(t)}))},br=()=>{iv.registerAnimation("emptyCircle",(t,e)=>({appear:be(t,e)}))};var bn=i(41035),bs=i(98706),bl=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class ba{constructor(t,e,i,r,n,s,l,a,o){this.refDatum=t,this.center=e,this.outerCenter=i,this.quadrant=r,this.radian=n,this.middleAngle=s,this.innerRadius=l,this.outerRadius=a,this.circleCenter=o,this.labelVisible=!0}getLabelBounds(){return this.labelPosition&&this.labelSize?{x1:this.labelPosition.x-this.labelSize.width/2,y1:this.labelPosition.y-this.labelSize.height/2,x2:this.labelPosition.x+this.labelSize.width/2,y2:this.labelPosition.y+this.labelSize.height/2}:{x1:0,x2:0,y1:0,y2:0}}}class bo extends pR{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cQ.Z)({},bo.defaultAttributes,bl(t,["data"])))),this.name="arc-label",this._ellipsisWidth=0,this._arcLeft=new Map,this._arcRight=new Map,this._line2MinLength=0,this._alignOffset=0}_overlapping(t){return["inside","inside-center"].includes(this.attribute.position)?super._overlapping(t):t}labeling(t,e,i="outside",r=0){if(t&&e)return{x:0,y:0}}_layout(t){var e,i,r;if(!t||!t.length)return;let n=super._layout(t),s=n.map(t=>this.getGraphicBounds(t)),l=Object.assign(Object.assign({},this.attribute.textStyle),{text:"…"}),a=1/0;if(!1!==l.ellipsis){let t=this._createLabelText(l),e=this.getGraphicBounds(t);a=e.x2-e.x1}let o=n.map(t=>t.attribute),h=Array.from(this._idToGraphic.values());this._line2MinLength=(0,uy.Z)(this.attribute.line.line2MinLength)?this.attribute.line.line2MinLength(t,h,this.attribute):this.attribute.line.line2MinLength,this._alignOffset=null!=(e=(0,uy.Z)(this.attribute.layout.alignOffset)?this.attribute.layout.alignOffset(t,h,this.attribute):this.attribute.layout.alignOffset)?e:0;let u=this.layoutArcLabels(this.attribute.position,this.attribute,h,o,s,a);for(let t=0;t<o.length;t++){let e=o[t],s=u.find(t=>{var i;return(null==(i=t.refDatum)?void 0:i.id)===e.id});if(s){let e={visible:s.labelVisible,x:s.labelPosition.x,y:s.labelPosition.y,angle:s.angle,points:s.pointA&&s.pointB&&s.pointC?[s.pointA,s.pointB,s.pointC]:void 0,line:s.labelLine};"richtext"===n[t].type?e.width=null!=(i=s.labelLimit)?i:n[t].attribute.width:e.maxLineWidth=null!=(r=s.labelLimit)?r:n[t].attribute.maxLineWidth,s.refArc&&"arc3d"===s.refArc.type&&(e.anchor3d=[s.circleCenter.x-e.x,s.circleCenter.y-e.y],e.beta=s.refArc.attribute.beta),n[t].setAttributes(e)}}return n}layoutArcLabels(t,e,i,r,n,s){this._arcLeft.clear(),this._arcRight.clear(),this._ellipsisWidth=s;let l=0;i.forEach(t=>{t.attribute.outerRadius>l&&(l=t.attribute.outerRadius)}),r.forEach((t,i)=>{var s,a,o;let h=this._idToGraphic.get(t.id),u=h.getAttributes(!0),d={x:null!=(s=null==u?void 0:u.x)?s:0,y:null!=(a=null==u?void 0:u.y)?a:0};if(!(0,aY.Z)(r[i])&&!(0,aY.Z)(n[i])){let t=r[i]?r[i]:null,s=n[i]?n[i]:{x1:0,x2:0,y1:0,y2:0},a=(u.startAngle+u.endAngle)/2,c=u.endAngle-u.startAngle,p=(0,bs.tc)(u.endAngle-c/2),g=new ba(t,(0,bs.op)(d,u.outerRadius,a),(0,bs.op)(d,l+e.line.line1MinLength,a),p,c,a,u.innerRadius,u.outerRadius,d);g.refArc=h,g.pointA=(0,bs.op)(d,this.computeDatumRadius(2*d.x,2*d.y,u.outerRadius),g.middleAngle),g.labelSize={width:s.x2-s.x1,height:s.y2-s.y1},1===(o=g.quadrant)||2===o?this._arcRight.set(g.refDatum,g):pp(g.quadrant)&&this._arcLeft.set(g.refDatum,g)}});let a=Array.from(this._arcLeft.values()),o=Array.from(this._arcRight.values()),h=[];switch(t){case"inside":case"inside-inner":case"inside-outer":case"inside-center":h.push(...this._layoutInsideLabels(o,e,i)),h.push(...this._layoutInsideLabels(a,e,i));break;default:h.push(...this._layoutOutsideLabels(o,e,i)),h.push(...this._layoutOutsideLabels(a,e,i))}return h}_layoutInsideLabels(t,e,i){var r,n;let s=e.spaceWidth,l=null!=(r=e.position)?r:"inside",a=null!=(n=e.offsetRadius)?n:-s;return t.forEach(t=>{var i,r,n,o;let h,{labelSize:u,radian:d}=t,c=t.innerRadius,p=t.outerRadius;h=d<((o=u.height)>2*p?NaN:2*Math.asin(o/2/p))?0:p-(d>=Math.PI?c:Math.max(c,u.height/2/Math.tan(d/2)))-s,!0!==e.rotate&&(h=p-s);let g=this._getFormatLabelText(t.refDatum,h);t.labelText=g;let f=Math.min(h,t.labelSize.width),m=this._computeAlign(t,e),y,v=0;if("inside"===l&&(v="left"===m?f:"right"===m?0:f/2),y="inside-inner"===l?c-a+v:"inside-center"===l?c+(p-c)/2:p+a-v,t.labelPosition=(0,bs.op)(t.circleCenter,y,t.middleAngle),t.labelLimit=f,(0,pS.Vy)(f,0)||(t.labelVisible=!1),!1!==e.rotate){t.angle=null!=(r=null==(i=e.textStyle)?void 0:i.angle)?r:t.middleAngle;let s=null!=(n=e.offsetAngle)?n:0;["inside-inner","inside-outer"].includes(l)&&(s+=Math.PI/2),t.angle+=s}}),t}_layoutOutsideLabels(t,e,i){var r,n,s;let l=null!=(r=i[0].attribute.x)?r:0,a=2*(null!=(n=i[0].attribute.y)?n:0),o=e.layout,h=e.spaceWidth;if(t.forEach(t=>{let e=pp(t.quadrant)?-1:1;t.labelPosition={x:t.outerCenter.x+e*(t.labelSize.width/2+this._line2MinLength+h),y:t.outerCenter.y}}),t.sort((t,e)=>t.labelPosition.y-e.labelPosition.y),!1!==e.coverEnable||"none"===o.strategy){for(let r of t){let{labelPosition:t,labelSize:n}=r;r.labelLimit=n.width,r.pointB=pp(r.quadrant)?{x:t.x+n.width/2+this._line2MinLength+h,y:t.y}:{x:t.x-n.width/2-this._line2MinLength-h,y:t.y},this._computeX(r,e,i)}!1===e.coverEnable&&"none"===o.strategy&&this._coverLabels(t)}else{let r=a/((null==(s=e.textStyle)?void 0:s.fontSize)||16);this._adjustY(t,r,e,i);let{minY:n,maxY:l}=t.reduce((t,e)=>{let{y1:i,y2:r}=e.getLabelBounds();return t.minY=Math.max(0,Math.min(i,t.minY)),t.maxY=Math.min(a,Math.max(r,t.maxY)),t},{minY:1/0,maxY:-1/0}),o=Math.max(Math.abs(a/2-n),Math.abs(l-a/2)),h=this._computeLayoutRadius(o,e,i);for(let r of t)this._computePointB(r,h,e,i),this._computeX(r,e,i)}let u=2*l;return t.forEach(t=>{var i,r;t.labelVisible&&((0,pS.SQ)(t.pointB.x,this._line2MinLength+h)||(0,pS.Vy)(t.pointB.x,u-this._line2MinLength-h))&&(t.labelVisible=!1),t.angle=null!=(r=null==(i=e.textStyle)?void 0:i.angle)?r:0,e.offsetAngle&&(t.angle+=e.offsetAngle),t.labelLine=Object.assign(Object.assign({},e.line),{visible:t.labelVisible})}),t}_computeX(t,e,i){var r,n;let s=t.circleCenter,l=this.attribute.width;this.attribute.height;let a=0;i.forEach(t=>{t.getAttributes(!0).outerRadius>a&&(a=t.getAttributes(!0).outerRadius)});let o=this.computeLayoutOuterRadius(a,e.width,e.height),h=e.line.line1MinLength,u=null==(r=e.layout)?void 0:r.align,d=e.spaceWidth,{labelPosition:c,quadrant:p,pointB:g}=t;(0,uE.Z)(g.x*g.y)||(t.pointC={x:NaN,y:NaN},c.x=NaN,t.labelLimit=0);let f=this.computeRadius(o,e.width,e.height),m=pp(p)?-1:1,y=0,v=(m>0?l-g.x:g.x-0)+this._alignOffset-this._line2MinLength-d;"labelLine"===u&&(y=(f+h+this._line2MinLength)*m+s.x,v=(m>0?l-y:y-0)-d);let b=this._getFormatLabelText(t.refDatum,v);t.labelText=b;let _=Math.min(v,t.labelSize.width);switch(u){case"labelLine":break;case"edge":y=m>0?l-_-d:0+_+d;break;default:y=g.x+m*this._line2MinLength}let x=(_=Math.max(this._ellipsisWidth,_))<t.labelSize.width-1;t.labelLimit=x?_:null,t.pointC={x:y,y:c.y};let C=("left"===(n=this._computeAlign(t,e))?0:"right"===n?1:.5)*(x?_:t.labelSize.width);"edge"===u?(c.x=(m>0?l:0)-m*C+m*this._alignOffset,t.pointC.x+=m*this._alignOffset):c.x=y+m*(this._alignOffset+d+C)}_computeAlign(t,e){var i,r,n,s,l,a;let o=null!=(r=null==(i=e.textStyle)?void 0:i.textAlign)?r:null==(n=e.textStyle)?void 0:n.align,h=null!=(l=null==(s=e.layout)?void 0:s.textAlign)?l:null==(a=e.layout)?void 0:a.align;return"inside"!==e.position?(0,aY.Z)(o)||"auto"===o?"edge"===h?pp(t.quadrant)?"left":"right":pp(t.quadrant)?"right":"left":o:(0,aY.Z)(o)||"auto"===o?"center":o}_getFormatLabelText(t,e){var i;return null!=(i=null==t?void 0:t.text)?i:""}_adjustY(t,e,i,r){var n;r[0].attribute.x;let s=2*(null!=(n=r[0].attribute.y)?n:0),l=i.layout;if("vertical"===l.strategy){let e,i=0,r=t.length;if(r<=0)return;for(let n=0;n<r;n++){let{y1:s}=t[n].getLabelBounds();if(e=s-i,(0,pS.SQ)(e,0)){let i=this._shiftY(t,n,r-1,-e);this._shiftY(t,i,0,e/2)}let{y2:l}=t[n].getLabelBounds();i=l}let{y1:n}=t[0].getLabelBounds();e=n-0,(0,pS.SQ)(e,0)&&this._shiftY(t,0,r-1,-e);for(let e=t.length-1;e>=0&&t[e].getLabelBounds().y2>s;e--)t[e].labelVisible=!1}else if("none"!==l.strategy){let n=t.map((t,e)=>({arc:t,originIndex:e,priorityIndex:0}));n.sort((t,e)=>e.arc.radian-t.arc.radian),n.forEach((t,e)=>{t.priorityIndex=e,t.arc.labelVisible=!1});let a=1/0,o=-1/0;for(let h=0;h<e&&h<t.length;h++){let e;this._storeY(t);let u=n[h].arc;this._computeYRange(u,i,r),u.labelVisible=!0;let d=u.labelPosition.y,{lastIndex:c,nextIndex:p}=this._findNeighborIndex(t,n[h]),g=t[c],f=t[p];if(-1===c&&-1!==p){let e=f.labelPosition.y;d>e?u.labelPosition.y=e-f.labelSize.height/2-u.labelSize.height/2:this._twoWayShift(t,u,f,p)}else if(-1!==c&&-1===p){let e=g.labelPosition.y;d<e?u.labelPosition.y=e+g.labelSize.height/2+u.labelSize.height/2:this._twoWayShift(t,g,u,n[h].originIndex)}else if(-1!==c&&-1!==p){let e=g.labelPosition.y,i=f.labelPosition.y;d>i?(u.labelPosition.y=i-f.labelSize.height/2-u.labelSize.height/2,this._twoWayShift(t,g,u,n[h].originIndex)):(d<e?u.labelPosition.y=e+g.labelSize.height/2+u.labelSize.height/2:this._twoWayShift(t,g,u,n[h].originIndex),this._twoWayShift(t,u,f,p))}let m=Math.min(a,n[h].originIndex),y=Math.max(o,n[h].originIndex);if(e=t[y].getLabelBounds().y2-s,(0,pS.Vy)(e,0)&&this._shiftY(t,y,0,-e),e=t[m].getLabelBounds().y1-0,(0,pS.SQ)(e,0)&&this._shiftY(t,m,t.length-1,-e),e=t[y].getLabelBounds().y2-s,(0,pS.Vy)(e,0)){u.labelVisible=!1,this._restoreY(t);break}l.tangentConstraint&&!this._checkYRange(t)?(u.labelVisible=!1,this._restoreY(t)):(a=m,o=y)}}}_shiftY(t,e,i,r){let n=e<i?1:-1,s=e;for(;-1!==s;){t[s].labelPosition.y+=r;let e=this._findNextVisibleIndex(t,s,i,n);if(e>=0&&e<t.length){let{y1:i,y2:r}=t[s].getLabelBounds(),{y1:l,y2:a}=t[e].getLabelBounds();if(n>0&&r<l||n<0&&i>a)return s}s=e}return i}_findNextVisibleIndex(t,e,i,r){let n=(i-e)*r;for(let i=1;i<=n;i++){let n=e+i*r;if(t[n].labelVisible)return n}return -1}_computePointB(t,e,i,r){let n=0;r.forEach(t=>{t.getAttributes(!0).outerRadius>n&&(n=t.getAttributes(!0).outerRadius)});let s=this.computeLayoutOuterRadius(n,i.width,i.height),l=i.line.line1MinLength;if("none"===i.layout.strategy)t.pointB={x:t.outerCenter.x,y:t.outerCenter.y};else{let r=t.circleCenter,n=this.computeRadius(s,i.width,i.height),{labelPosition:a,quadrant:o}=t,h=e-Math.max(n+l,t.outerRadius),u=Math.sqrt(e**2-Math.abs(r.y-a.y)**2)-h;(0,uE.Z)(u)?t.pointB={x:r.x+u*(pp(o)?-1:1),y:a.y}:t.pointB={x:NaN,y:NaN}}}_storeY(t){for(let e of t)e.labelVisible&&(e.lastLabelY=e.labelPosition.y)}_computeYRange(t,e,i){let r,n,s,l,a,o=t.circleCenter,h={width:2*o.x,height:2*o.y},u=0;i.forEach(t=>{t.getAttributes(!0).outerRadius>u&&(u=t.getAttributes(!0).outerRadius)});let d=this.computeLayoutOuterRadius(u,e.width,e.height),c=e.line.line1MinLength,{width:p,height:g}=h,f=this.computeRadius(d,e.width,e.height),m=this._computeLayoutRadius(g/2,e,i),y=Math.abs(t.center.x-p/2),v=t.center.y-g/2;if((0,pS.Yt)(p/2,y))r=0,n=1,s=-v;else if((0,pS.Yt)(g/2,v))r=1,n=0,s=-y;else{let t=-1/(v/y);r=t,n=-1,s=v-t*y}let b=function(t,e,i,r,n,s){if(0===t&&0===e||s<=0)return[];if(0===t){let t=-i/e,n=s**2-(t-0)**2;return n<0?[]:0===n?[{x:r,y:t}]:[{x:Math.sqrt(n)+r,y:t},{x:-Math.sqrt(n)+r,y:t}]}if(0===e){let e=-i/t,l=s**2-(e-r)**2;return l<0?[]:0===l?[{x:e,y:0}]:[{x:e,y:Math.sqrt(l)+n},{x:e,y:-Math.sqrt(l)+n}]}let l=(e/t)**2+1,a=2*(e/t*(i/t+r)-n),o=a**2-4*l*((i/t+r)**2+n**2-s**2);if(o<0)return[];let h=(-a+Math.sqrt(o))/(2*l),u=(-a-Math.sqrt(o))/(2*l),d=-(e*h+i)/t;return 0===o?[{x:d,y:h}]:[{x:d,y:h},{x:-(e*u+i)/t,y:u}]}(r,n,s,c+f-m,0,m);b.length<2||(b[0].x>b[1].x&&b.reverse(),b[0].x<0?(0,pS.Yt)(b[0].y,b[1].y)?(0,pS.Vy)(t.middleAngle,-Math.PI)&&(0,pS.SQ)(t.middleAngle,0)||(0,pS.Vy)(t.middleAngle,Math.PI)&&(0,pS.SQ)(t.middleAngle,2*Math.PI)?(l=0,a=b[1].y+g/2):(l=b[1].y+g/2,a=g):b[0].y<b[1].y?(l=0,a=b[1].y+g/2):(l=b[1].y+g/2,a=h.height):(l=Math.min(b[0].y,b[1].y)+g/2,a=Math.max(b[0].y,b[1].y)+g/2),t.labelYRange=[l,a])}_computeLayoutRadius(t,e,i){let r=e.layoutArcGap,n=e.line.line1MinLength,s=0;i.forEach(t=>{t.getAttributes(!0).outerRadius>s&&(s=t.getAttributes(!0).outerRadius)});let l=this.computeLayoutOuterRadius(s,e.width,e.height),a=this.computeRadius(l,e.width,e.height)+n,o=a-r;return Math.max((o**2+t**2)/(2*o),a)}_findNeighborIndex(t,e){let i=e.originIndex,r=-1,n=-1;for(let e=i-1;e>=0;e--)if(t[e].labelVisible){r=e;break}for(let e=i+1;e<t.length;e++)if(t[e].labelVisible){n=e;break}return{lastIndex:r,nextIndex:n}}_twoWayShift(t,e,i,r){let n=i.getLabelBounds().y1-e.getLabelBounds().y2;if((0,pS.SQ)(n,0)){let e=this._shiftY(t,r,t.length-1,-n);this._shiftY(t,e,0,n/2)}}_restoreY(t){for(let e of t)e.labelVisible&&(e.labelPosition.y=e.lastLabelY)}_checkYRange(t){for(let e of t){let{labelYRange:t,labelPosition:i}=e;if(e.labelVisible&&t&&((0,pS.SQ)(i.y,t[0])||(0,pS.Vy)(i.y,t[1])))return!1}return!0}_coverLabels(t){if(t.length<=1)return;let e=t[0].getLabelBounds();for(let i=1;i<t.length;i++){let r=t[i].getLabelBounds();!function(t,e){let{x1:i,y1:r,x2:n,y2:s}=t,{x1:l,y1:a,x2:o,y2:h}=e;return!(i<=l&&n<=l||i>=o&&n>=o||r<=a&&s<=a||r>=h&&s>=h)}(e,r)?e=r:t[i].labelVisible=!1}}_getLabelLinePoints(t,e){return t.attribute.points}_createLabelLine(t,e){var i,r,n,s,l;let{line:a={},visible:o}=t.attribute,h=super._createLabelLine(t,e);if(h&&(h.setAttributes({visible:null==(n=null!=(i=a.visible&&o)?i:null==(r=t.attribute)?void 0:r.visible)||n,lineWidth:null!=(l=null==(s=a.style)?void 0:s.lineWidth)?l:1}),a.smooth&&h.setAttributes({curveType:"basis"}),"arc3d"===e.type&&e)){let{beta:t,x:i,y:r}=e.getAttributes(!0);h.setAttributes({beta:t,anchor3d:[i,r]})}return h}computeRadius(t,e,i,r){return this.computeLayoutRadius(e||0,i||0)*t*((0,aY.Z)(r)?1:r)}computeLayoutRadius(t,e){return Math.min(t/2,e/2)}_canPlaceInside(t,e){return"inside"===this.attribute.position||"inside-center"===this.attribute.position}computeLayoutOuterRadius(t,e,i){return t/(Math.min(e,i)/2)}computeDatumRadius(t,e,i){let r=this.computeLayoutOuterRadius(i,t,e);return this.computeLayoutRadius(t||0,e||0)*r}}bo.defaultAttributes={coverEnable:!1,spaceWidth:5,layoutArcGap:6,textStyle:{visible:!0,fontSize:14,fontWeight:"normal",fillOpacity:1,boundsPadding:[-1,0,-1,0],ellipsis:!0},position:"outside",line:{visible:!0,line1MinLength:20,line2MinLength:10},layout:{align:"arc",strategy:"priority",tangentConstraint:!0}};let bh=()=>{pP("arc",bo)};var bu=i(16483);class bd extends od{constructor(t,e){super(t,e),this.type=bc.type,this._unCompileChannel={centerOffset:!0,radiusOffset:!0},this.computeOuterRadius=(t,e,i="normal",r)=>{var n;return r+(null!=(n=this.getAttribute("radiusOffset",e,i))?n:0)},this.computeCenter=(t,e,i="normal",r)=>ay({x:0,y:0},this.getAttribute("centerOffset",e,i),e[gM])[t]+r,this._computeExChannel.x=this.computeCenter,this._computeExChannel.y=this.computeCenter,this._computeExChannel.outerRadius=this.computeOuterRadius,this._extensionChannel.centerOffset=["x","y"],this._extensionChannel.radiusOffset=["outerRadius"]}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{startAngle:0,endAngle:0,outerRadius:0,innerRadius:0,cornerRadius:0,lineWidth:0,innerPadding:0,outerPadding:0})}}class bc extends bd{constructor(){super(...arguments),this.type=bc.type}}bc.type="arc";let bp=()=>{(0,oc.W)(),(0,bu.x)(),bh(),de(),iv.registerGraphicComponent("arc",bn.Q),iv.registerMark(bc.type,bc)},bg=Object.assign(Object.assign({},cy),{pie:{name:"pie",type:"arc"},labelLine:{name:"labelLine",type:"path"}});class bf extends cE{_transformLabelSpec(t){this._addMarkLabelSpec(t,"pie")}_mergeThemeToSpec(t,e){let i=this._theme,r=t;if(this._shouldMergeThemeToSpec()){let i=this._getDefaultSpecFromChart(e);r=ir({},this._theme,i,t);let n=(t,e)=>ir({},"inside"===t||"inside-center"===t?this._theme.innerLabel:this._theme.outerLabel,e);tq(r.label)?r.label=r.label.map(t=>n(t.position,t)):r.label=n(r.label.position,r.label)}return{spec:r,theme:i}}_getDefaultSpecFromChart(t){var e;let i=null!=(e=super._getDefaultSpecFromChart(t))?e:{},{centerX:r,centerY:n}=t;return t8(r)&&(i.centerX=r),t8(n)&&(i.centerY=n),Object.keys(i).length>0?i:void 0}}let bm=`${st}_LABEL_VISIBLE`;class by extends v1{constructor(){super(...arguments),this.transformerConstructor=bf,this._pieMarkName="pie",this._pieMarkType="arc",this.getCenter=()=>{var t,e;let i=this._region.getLayoutRect();return{x:eS(null==(t=this._spec)?void 0:t.centerX,i.width,i,i.width/2),y:eS(null==(e=this._spec)?void 0:e.centerY,i.height,i,i.height/2)}},this._startAngle=gR,this._endAngle=gB,this._pieMark=null,this._labelMark=null,this._labelLineMark=null,this._emptyArcMark=null,this.dataToCentralPosition=t=>{let e=t[gM];if(er(e))return null;let i=this.computeDatumRadius(t),r=this.computeDatumInnerRadius(t);return ay(this.computeCenter(t),(i+r)/2,e)}}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.getCenter().x,y:()=>this.getCenter().y}),this._markAttributeContext.startAngleScale=t=>this.startAngleScale(t),this._markAttributeContext.endAngleScale=t=>this.endAngleScale(t)}setAttrFromSpec(){var t,e,i,r,n,s;super.setAttrFromSpec(),this._centerOffset=null!=(t=this._spec.centerOffset)?t:0,this._cornerRadius=null!=(e=this._spec.cornerRadius)?e:0;let l=function(t,e){let i=0,r=2*Math.PI,n=t8(t),s=t8(e);for(n||s?s?(i=n?t:e-2*Math.PI,r=e):(i=t,r=t+2*Math.PI):(i=0,r=2*Math.PI);r<=i;)r+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI,r-=2*Math.PI;for(;r<0;)i+=2*Math.PI,r+=2*Math.PI;return{startAngle:i,endAngle:r}}(t8(this._spec.startAngle)?af(this._spec.startAngle):this._startAngle,t8(this._spec.endAngle)?af(this._spec.endAngle):this._endAngle);this._startAngle=l.startAngle,this._endAngle=l.endAngle,this._padAngle=t8(this._spec.padAngle)?af(this._spec.padAngle):0,this.setAngleField(this._spec.valueField||this._spec.angleField),this._spec.categoryField&&this.setSeriesField(this._spec.categoryField),this._radiusField=[],this._specAngleField=this._angleField.slice(),this._specRadiusField=[],this._showEmptyCircle=null!=(r=null==(i=this._spec.emptyPlaceholder)?void 0:i.showEmptyCircle)&&r,this._showAllZero=null!=(n=this._spec.showAllZero)&&n,this._supportNegative=null!=(s=this._spec.supportNegative)&&s}initData(){super.initData();let t=this.getViewData();if(!t)return;nq(this._dataSet,"pie",v3),t.transform({type:"pie",options:{angleField:()=>this._angleField[0],startAngle:()=>this._startAngle,endAngle:()=>this._endAngle,minAngle:()=>t8(this._spec.minAngle)?af(this._spec.minAngle):0,asStartAngle:gw,asEndAngle:gS,asRatio:gC,asMiddleAngle:gM,asRadian:gT,asQuadrant:gk,asK:gA,showAllZero:this._showAllZero,supportNegative:this._supportNegative,showEmptyCircle:this._showEmptyCircle}},!1);let e=new el(this._dataSet,{name:`${st}_series_${this.id}_viewDataLabel`});e.parse([this.getViewData()],{type:"dataview"}),this._viewDataLabel=new aC(this._option,e)}compileData(){var t;super.compileData(),null==(t=this._viewDataLabel)||t.compile()}initMark(){this._pieMark=this._createMark(Object.assign(Object.assign({},by.mark.pie),{name:this._pieMarkName,type:this._pieMarkType}),{key:ss,groupKey:this._seriesField,isSeriesMark:!0},{morph:cR(this._spec,this._pieMarkName),morphElementKey:this._seriesField}),this._showEmptyCircle&&(this._emptyArcMark=this._createMark({name:"emptyCircle",type:"arc"},{dataView:!1}),this._data.addRelatedMark(this._emptyArcMark))}startAngleScale(t){return eo(gw)(t)}endAngleScale(t){return eo(gS)(t)}_computeLayoutRadius(){return gE(()=>this._spec.layoutRadius,this.getLayoutRect,this.getCenter,()=>({startAngle:this._startAngle,endAngle:this._endAngle}))}initMarkStyle(){let t={x:()=>this.getCenter().x,y:()=>this.getCenter().y,fill:this.getColorAttribute(),outerRadius:ah(this._outerRadius)?this._outerRadius:()=>this._computeLayoutRadius()*this._outerRadius,innerRadius:ah(this._innerRadius)?this._innerRadius:()=>this._computeLayoutRadius()*this._innerRadius,cornerRadius:()=>this._computeLayoutRadius()*this._cornerRadius,startAngle:t=>this.startAngleScale(t),endAngle:t=>this.endAngleScale(t),padAngle:this._padAngle,centerOffset:this._centerOffset},e=this._pieMark;e&&this.setMarkStyle(e,t,"normal",W.Series);let i=this._emptyArcMark;i&&this.setMarkStyle(i,Object.assign(Object.assign({},t),{visible:()=>{let t=this.getViewData().latestData;return!t||!t.length}}),"normal",W.Series)}getInteractionTriggers(){return this._parseInteractionConfig(this._pieMark?[this._pieMark]:[])}initTooltip(){super.initTooltip(),this._pieMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pieMark)}initMarkStyleWithSpec(t,e){if(super.initMarkStyleWithSpec(t,e),t.name===this._pieMarkName){let e=this.getSpec()[t.name];if(e)for(let i in e.state||{})this.setMarkStyle(t,this.generateRadiusStyle(e.state[i]),i,W.User_Mark)}"emptyCircle"===t.name&&this.setMarkStyle(t,this.generateRadiusStyle(e.style),"normal",W.User_Mark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{visible:eo(bm).bind(this),text:t=>t[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:this.dataToPositionZ.bind(this)})}afterInitMark(){super.afterInitMark()}initEvent(){var t;super.initEvent(),null==(t=this._viewDataLabel.getDataView())||t.target.addListener("change",this.viewDataLabelUpdate.bind(this))}initGroups(){}onLayoutEnd(){this._viewDataLabel.getDataView().reRunAllTransform(),this.onMarkPositionUpdate(),super.onLayoutEnd()}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return this._specAngleField}viewDataLabelUpdate(){this.event.emit(rI.viewDataLabelUpdate,{model:this}),this._viewDataLabel.updateData()}generateRadiusStyle(t){if(!t)return;let e={};return t.outerRadius&&(e.outerRadius=()=>this._computeLayoutRadius()*t.outerRadius),t.innerRadius&&(e.innerRadius=()=>this._computeLayoutRadius()*t.innerRadius),t.cornerRadius&&(e.cornerRadius=()=>this._computeLayoutRadius()*t.cornerRadius),e}computeCenter(t){return{x:this._pieMark.getAttribute("x",t,"normal"),y:this._pieMark.getAttribute("y",t,"normal")}}getRadius(t="normal"){var e,i,r,n,s,l,a;let o="normal"===t?null==(r=null==(i=this.getSpec()[(null==(e=this._pieMark)?void 0:e.name)||"pie"])?void 0:i.style)?void 0:r.outerRadius:null==(a=null==(l=null==(s=this.getSpec()[(null==(n=this._pieMark)?void 0:n.name)||"pie"])?void 0:s.state)?void 0:l[t])?void 0:a.outerRadius;return null!=o?o:this._outerRadius}getInnerRadius(t="normal"){var e,i,r,n,s,l,a;let o="normal"===t?null==(r=null==(i=this.getSpec()[(null==(e=this._pieMark)?void 0:e.name)||"pie"])?void 0:i.style)?void 0:r.innerRadius:null==(a=null==(l=null==(s=this.getSpec()[(null==(n=this._pieMark)?void 0:n.name)||"pie"])?void 0:s.state)?void 0:l[t])?void 0:a.innerRadius;return null!=o?o:this._innerRadius}computeRadius(t,e){return this._computeLayoutRadius()*t*(er(e)?1:e)+this._centerOffset}computeDatumRadius(t,e){return this._computeLayoutRadius()*this.getRadius(e)+this._centerOffset}_compareSpec(t,e,i){i=null!=i?i:{data:!0};let r=["centerX","centerY","centerOffset","radius","innerRadius","cornerRadius","startAngle","endAngle","padAngle"];r.forEach(t=>{i[t]=!0});let n=super._compareSpec(t,e,i);return t=null!=t?t:{},r.some(i=>t[i]!==e[i])&&(n.reRender=!0,n.change=!0),n}computeDatumInnerRadius(t,e){return this._computeLayoutRadius()*this.getInnerRadius(e)+this._centerOffset}dataToPosition(t,e){let i=t[gM];if(er(i)||e&&!this.isDatumInViewData(t))return null;let r=this.computeDatumRadius(t);return ay(this.computeCenter(t),r,i)}initAnimation(){var t,e,i;let r={growFrom:(t,e,i)=>{var r,n;if(i===O.appear)return this._startAngle;if(i===O.disappear)return this._endAngle;let s=[O.disappear,O.exit],l=this._pieMark.getGraphics(),a=null==t?void 0:t[sn];if(void 0===l.find(t=>{var e;return(null==(e=t.context.data[0])?void 0:e[sn])<a}))return this._startAngle;if(void 0===l.find(t=>{var e;return(null==(e=t.context.data[0])?void 0:e[sn])>a}))return this._endAngle;let o=[...l].reverse().find(t=>{var e;return(null==(e=t.context.data[0])?void 0:e[sn])<a});return s.includes(i)?null==(r=null==o?void 0:o.getFinalAttribute())?void 0:r.endAngle:null==(n=null==o?void 0:o.attribute)?void 0:n.endAngle}},n=null==(t=this._spec.animationAppear)?void 0:t.preset;if(this._pieMark){let t=cA(null==(e=iv.getAnimationInKey("pie"))?void 0:e(r,n),cM("pie",this._spec,this._markAttributeContext));t.normal&&t.normal.type&&(t.normal=function(t,e){var i,r,n,s;let l=null!=(r=null==(i=e.options)?void 0:i.distance)?r:10,a=en(e.duration)?e.duration/2:1e3,o=null!=(n=e.options.easing)?n:"cubicOut";return{oneByOne:e.oneByOne,loop:null!=(s=e.loop)&&s,timeSlices:[{duration:a,effects:{easing:o,channel:{x:{from:e=>t.getAttribute("x",e),to:e=>t.getAttribute("x",e)+ay({x:0,y:0},l,e[gM]).x},y:{from:e=>t.getAttribute("y",e),to:e=>t.getAttribute("y",e)+ay({x:0,y:0},l,e[gM]).y}}}},{duration:a,effects:{easing:o,channel:{x:{to:e=>t.getAttribute("x",e),from:e=>t.getAttribute("x",e)+ay({x:0,y:0},l,e[gM]).x},y:{to:e=>t.getAttribute("y",e),from:e=>t.getAttribute("y",e)+ay({x:0,y:0},l,e[gM]).y}}}}]}}(this._pieMark,t.normal)),this._pieMark.setAnimationConfig(t)}if(this._emptyArcMark){let t=cA(null==(i=iv.getAnimationInKey("emptyCircle"))?void 0:i(r,null!=n?n:"fadeIn"));this._emptyArcMark.setAnimationConfig(t)}}getDefaultShapeType(){return"circle"}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(t,e){return e}getActiveMarks(){return[this._pieMark]}}by.transformerConstructor=bf,by.mark=bg,by.builtInTheme={pie:{outerRadius:.6,pie:{style:{fillOpacity:1}},label:{visible:!1,interactive:!0,position:"outside",style:{fontWeight:"normal",stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1}},innerLabel:{style:{lineWidth:2}},emptyCircle:{style:{fill:{type:"palette",key:"emptyCircleColor"},fillOpacity:1}}}};class bv extends by{constructor(){super(...arguments),this.type=rR.pie}}bv.type=rR.pie;let bb=()=>{bp(),bi(),br(),iv.registerSeries(bv.type,bv)};class b_ extends fD{_isValidSeries(t){return!this.seriesType||t===this.seriesType}getIndicatorSpec(t){var e,i,r;let n=ed(t.indicator),s=null!=(e=t.innerRadius)?e:null==(r=null==(i=t.series)?void 0:i[0])?void 0:r.innerRadius;return t8(s)&&n.forEach(t=>{er(t.limitRatio)&&(t.limitRatio=s)}),n}_getDefaultSeriesSpec(t,e){return super._getDefaultSeriesSpec(t,["radius","outerRadius","innerRadius","startAngle","endAngle","sortDataByAxis"],e)}transformSpec(t){super.transformSpec(t),tq(t.dataZoom)&&t.dataZoom.length>0&&t.dataZoom.forEach(t=>{"axis"===t.filterMode&&(t.filterMode="filter")}),this.transformSeriesSpec(t),t8(t.indicator)&&(t.indicator=this.getIndicatorSpec(t))}}class bx extends b_{needAxes(){return!1}_getDefaultSeriesSpec(t){var e;let i=super._getDefaultSeriesSpec(t,["center","centerOffset","cornerRadius","padAngle","minAngle","emptyPlaceholder","showAllZero","supportNegative","useSequentialAnimation","layoutRadius"]);return i.categoryField=t.categoryField||t.seriesField,i.valueField=t.valueField||t.angleField,i.emptyCircle=null==(e=t.emptyPlaceholder)?void 0:e.emptyCircle,i}}class bC extends fV{constructor(){super(...arguments),this.transformerConstructor=bx}}bC.transformerConstructor=bx;class bw extends bC{constructor(){super(...arguments),this.transformerConstructor=bx,this.type="pie",this.seriesType=rR.pie}}bw.type="pie",bw.seriesType=rR.pie,bw.transformerConstructor=bx;let bS=()=>{mx(),bb(),iv.registerChart(bw.type,bw)};function bA(t){return"angle"===t?"growAngleIn":"growRadiusIn"}let bM=t=>({type:bA(t.growField),options:{overall:!0}}),bk={type:"fadeIn"},bT=t=>({type:bA(t.growField)}),bR=t=>({type:"angle"===t.growField?"growAngleOut":"growRadiusOut"}),bB=()=>{iv.registerAnimation("rose",(t,e)=>({appear:function(t,e){if(!1===e)return{};switch(e){case"fadeIn":return bk;case"growAngle":return bM(Object.assign(Object.assign({},t),{growField:"angle"}));default:return bM(Object.assign(Object.assign({},t),{growField:"radius"}))}}(t,e),enter:bT(t),exit:bR(t),disappear:bR(t)}))};class bP extends v1{getStackGroupFields(){return this._angleField}getStackValueField(){return ed(this._spec.valueField)[0]||ed(this._spec.radiusField)[0]}getGroupFields(){return this._angleField}setAttrFromSpec(){super.setAttrFromSpec(),this.setAngleField(this._spec.categoryField||this._spec.angleField),this.setRadiusField(this._spec.valueField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice(),this.setInnerRadiusField(this._spec.valueField||this._spec.radiusField),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent()}setValueFieldToStack(){this.setRadiusField(su),this.setInnerRadiusField(sh)}setValueFieldToPercent(){this.setRadiusField(sc),this.setInnerRadiusField(sd)}getDimensionField(){return this._specAngleField}getMeasureField(){return this._specRadiusField}getDefaultShapeType(){return"square"}}let bE=Object.assign(Object.assign({},cy),{rose:{name:"rose",type:"arc"}});class bI extends cE{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){this._addMarkLabelSpec(t,"rose")}}var bL=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class bF extends gU{get center(){return this._center}get startAngle(){return this._startAngle}get endAngle(){return this._endAngle}getOrient(){return this._orient}getDefaultInteractive(){return"angle"!==this._orient}getGroupScales(){return this._groupScales}static getSpecInfo(t){let e,i;if(!t[this.specKey])return null;let r=tq(t[this.specKey]),n=r?t[this.specKey]:[t[this.specKey]],s=[],l=[],a=[];return n.forEach((n,o)=>{if(!function(t){let e=null==t?void 0:t.orient;return"angle"===e||"radius"===e}(n))return;let{axisType:h,componentName:u,startAngle:d,endAngle:c,center:p,outerRadius:g,layoutRadius:f}=gP(n,t);n.center=p,n.startAngle=d,n.endAngle=c,n.outerRadius=g,n.type=h,n.layoutRadius=f;let m={spec:n,specPath:r?[this.specKey,o]:[this.specKey],specInfoPath:["component",this.specKey,o],type:u};s.push(m),"radius"===n.orient?(l.push(m),i=o):(a.push(m),e=o)}),l.forEach(t=>{t.angleAxisIndex=e}),a.forEach(t=>{t.radiusAxisIndex=i}),s}static createComponent(t,e){let{spec:i}=t,r=bL(t,["spec"]),n=iv.getComponentInKey(r.type);return n?new n(i,Object.assign(Object.assign({},e),r)):(e.onError(`Component ${r.type} not found`),null)}constructor(t,e){super(t,e),this.type=rk.polarAxis,this.name=rk.polarAxis,this._defaultBandPosition=0,this._defaultBandInnerPadding=0,this._defaultBandOuterPadding=0,this.layoutType="absolute",this.layoutZIndex=H.Axis,this._tick=void 0,this._center=null,this._startAngle=gR,this._endAngle=gB,this._orient="radius",this._groupScales=[],this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),pX(this._regions,t=>{"radius"===this.getOrient()?gv(t.radiusAxisHelper,this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&(t.radiusAxisHelper=this.axisHelper()):gv(t.angleAxisHelper,this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&(t.angleAxisHelper=this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=t=>{var e;let i=null==(e=this.getRegions())?void 0:e[0];return i?i.getLayoutStartPoint():t},this.getCenter=()=>{var t,e;let i=this.getRefLayoutRect(),{width:r,height:n}=i;return{x:eS(null==(t=this._center)?void 0:t.x,r,i,r/2),y:eS(null==(e=this._center)?void 0:e.y,n,i,n/2)}},this.getRefLayoutRect=()=>this.getRegions()[0].getLayoutRect(),this._coordinateType="polar"}setAttrFromSpec(){super.setAttrFromSpec(),this.visible&&(this._axisStyle=this._getAxisAttributes(),this._gridStyle=this._getGridAttributes()),this._tick=this._spec.tick,this._orient="angle"===this._spec.orient?"angle":"radius",this._center=this._spec.center,this._startAngle=af(this._spec.startAngle),this._endAngle=af(this._spec.endAngle),this._inverse=this._spec.inverse}_tickTransformOption(){var t;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimal:null==(t=this._tick)?void 0:t.noDecimals,startAngle:this.startAngle,labelOffset:gp(this._spec),getRadius:()=>this.getOuterRadius(),inside:this._spec.inside})}updateScaleRange(){let t,e=this._scale.range();return t="radius"===this.getOrient()?this._inverse?[this.computeLayoutOuterRadius(),this.computeLayoutInnerRadius()]:[this.computeLayoutInnerRadius(),this.computeLayoutOuterRadius()]:this._inverse?[this._endAngle,this._startAngle]:[this._startAngle,this._endAngle],(!e||!t||e[0]!==t[0]||e[1]!==t[1])&&(this._scale.range(t),!0)}collectSeriesField(t,e){var i,r;return t>0?null==(r=null==(i=e.getGroups())?void 0:i.fields)?void 0:r[t]:"radius"===this.getOrient()?e.getRadiusField():e.getAngleField()}updateSeriesScale(){pX(this._regions,t=>{"radius"===this.getOrient()?gv(t.radiusAxisHelper,this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&(t.setRadiusScale(this._scale),t.radiusAxisHelper=this.axisHelper()):gv(t.angleAxisHelper,this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&(t.setAngleScale(this._scale),t.angleAxisHelper=this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getSeriesStatisticsField(t){let e="radius"===this.getOrient()?t.getRadiusField():t.getAngleField();return ls(this._scale.type)?e:[e[0]]}initGroupScales(){}axisHelper(){return{isContinuous:ls(this._scale.type),dataToPosition:this.dataToPosition.bind(this),coordToPoint:this.coordToPoint.bind(this),pointToCoord:this.pointToCoord.bind(this),center:this.getCenter.bind(this),layoutRadius:this._computeLayoutRadius.bind(this),getScale:(t=0)=>this._scales[t],getAxisId:()=>this.id,getSpec:()=>this._spec}}positionToData(t){let e=this.pointToCoord(t);return"radius"===this.getOrient()?this.invert(e.radius):this.invert(e.angle)}coordToPoint(t){return ay(this.getCenter(),t.radius,t.angle)}pointToCoord(t){let e=this.getCenter();return av(t,e,this._startAngle,this._endAngle)}getOuterRadius(){return this.computeLayoutOuterRadius()}getInnerRadius(){return this.computeLayoutInnerRadius()}updateLayoutAttribute(){this._visible&&("radius"===this.getOrient()?this._layoutRadiusAxis():this._layoutAngleAxis()),super.updateLayoutAttribute()}_getNormalizedValue(t,e){return 0===e?0:(this.dataToPosition(t)-this._getStartValue())/e}getLabelItems(t){var e;let i=null==(e=this.getTickData())?void 0:e.getLatestData();return i&&i.length?[i.map(e=>gy(e.value,this._getNormalizedValue([e.value],t)))]:[]}_getStartValue(){return"radius"===this.getOrient()?this.computeLayoutInnerRadius():this._startAngle}_layoutAngleAxis(){var t,e,i;let r=this.getCenter(),n=this.computeLayoutOuterRadius(),s=this.computeLayoutInnerRadius(),l=this._endAngle-this._startAngle,a=this.getLabelItems(l),o=Object.assign(Object.assign({},this.getLayoutStartPoint()),{inside:this._spec.inside,center:r,radius:n,innerRadius:s,startAngle:this._startAngle,endAngle:this._endAngle,sides:(null==(i=null==(e=null==(t=this._getRelatedAxis(this._option.radiusAxisIndex))?void 0:t.getSpec())?void 0:e.grid)?void 0:i.smooth)?void 0:this.getScale().domain().length}),h=Object.assign(Object.assign({},o),{size:this.getRefLayoutRect(),title:{text:this._spec.title.text||this._dataFieldText},items:a,orient:"angle",scale:this._scale});this._spec.grid.visible&&(h.grid=Object.assign({type:"line",smoothLink:!0,items:a[0]},o)),this._update(h)}_layoutRadiusAxis(){var t,e,i;let r=this.getCenter(),n=this.computeLayoutOuterRadius(),s=this.computeLayoutInnerRadius(),l=this.coordToPoint({angle:this._startAngle,radius:n}),a=this.coordToPoint({angle:this._startAngle,radius:s}),o=dD.distancePP(a,l),h=this.getLabelItems(o),u=Object.assign(Object.assign({},this.getLayoutStartPoint()),{start:a,end:l,verticalFactor:-1}),d=Object.assign(Object.assign({},u),{title:{text:this._spec.title.text||this._dataFieldText},items:h,orient:"radius",scale:this._scale.clone()});(null==(t=this._spec.grid)?void 0:t.visible)&&(d.grid=Object.assign({items:h[0],type:(null==(e=this._spec.grid)?void 0:e.smooth)?"circle":"polygon",center:r,closed:!0,sides:null==(i=this._getRelatedAxis(this._option.angleAxisIndex))?void 0:i.getScale().domain().length,startAngle:this._startAngle,endAngle:this._endAngle},u)),this._update(d)}_getRelatedAxis(t){if(t8(t))return this._option.getComponentByIndex(this.specKey,t)}_computeLayoutRadius(){return gE(()=>this._spec.layoutRadius,this.getRefLayoutRect,this.getCenter,()=>({startAngle:this._startAngle,endAngle:this._endAngle}))}computeLayoutOuterRadius(){var t;let e=null!=(t=this._spec.outerRadius)?t:this._spec.radius,i=null!=e?e:this.getRefSeriesRadius().outerRadius;return this._computeLayoutRadius()*i}computeLayoutInnerRadius(){var t;let e=null!=(t=this._spec.innerRadius)?t:this.getRefSeriesRadius().innerRadius;return this._computeLayoutRadius()*e}getRefSeriesRadius(){let t=.6,e=0,i=this.getChart().getSpec();return pX(this.getRegions(),r=>{if(cL(r.type)){let{outerRadius:n=i.outerRadius,innerRadius:s=i.innerRadius}=r;en(n)&&(t=n),en(s)&&(e=s)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),{outerRadius:t,innerRadius:e}}_update(t){let{grid:e}=t,i=bL(t,["grid"]);this._axisMark.getComponent().setAttributes(ir({},this._axisStyle,i)),this._gridMark&&this._gridMark.getComponent().setAttributes(ir({},this._gridStyle,e))}invert(t){var e;if("angle"===this.getOrient()&&"band"===this._scale.type){let i=this._scale.range(),r=i[i.length-1]-i[0],n=.5===(null!=(e=this.getSpec().bandPosition)?e:this._defaultBandPosition)?0:this._scale.bandwidth()/2;if(i[0]<0){let e=(t+n+Math.abs(i[0]))%r-Math.abs(i[0]);return this._scale.invert(e)}return this._scale.invert((t+n)%r)}return this._scale.invert(t)}}bF.type=rk.polarAxis,bF.specKey="axes";var bO=i(84964),bD=i(59225),bH=i(2420),bz=i(30427);class bW{isInValidValue(t){let{startAngle:e=pe.v2,endAngle:i=pe.Di}=this.attribute;return Math.abs(i-e)%(2*Math.PI)==0?t>1:t<0||t>1}getTickCoord(t){let{startAngle:e=pe.v2,endAngle:i=pe.Di,center:r,radius:n,inside:s=!1,innerRadius:l=0}=this.attribute;return(0,bs.op)(r,s&&l>0?l:n,e+(i-e)*t)}getVerticalVector(t,e=!1,i){return(0,g5.jO)(t,i,this.attribute.center,e,this.attribute.inside)}getRelativeVector(t){let{center:e}=this.attribute;return[t.y-e.y,-1*(t.x-e.x)]}}var bN=i(48606);function bj(t,e){let i=t.length;return{prevLabel:e>=1?t[e-1]:t[i-1],nextLabel:e<i-1?t[e+1]:t[0]}}function bG(t,e,i){var r;t.setAttributes({maxLineWidth:e,ellipsis:null!=(r=t.attribute.ellipsis)?r:i})}function bV(t,e,i){let r=[];if(t.length>=3){let{prevLabel:i,nextLabel:n}=bj(t,e);r.push(i,n)}else 2===t.length&&r.push(t[+(0===e)]);let n=t[e],s=Math.min(Math.abs(n.attribute.y-i.y1),Math.abs(n.attribute.y-i.y2));r.forEach(t=>{s=Math.min(s,Math.abs(t.attribute.y-n.attribute.y))}),s>0&&n.setAttributes({whiteSpace:"normal",heightLimit:s})}var bZ=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};(0,g9.WF)();class bU extends bH.I{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},bU.defaultAttributes,t))}renderLine(t){let{startAngle:e=pe.v2,endAngle:i=pe.Di,radius:r,center:n,innerRadius:s=0,line:l={},inside:a=!1,sides:o}=this.attribute,h,u=r,d=s;if(a&&s>0&&(u=s,d=0),(0,uE.Z)(o)&&o>=3){let t=(0,g5.zl)(n,o,u,e,i);h=c0.i.path(Object.assign(Object.assign({},l.style),{path:(0,g5.st)(t,!0)}))}else{let t=Object.assign(Object.assign(Object.assign({},n),{startAngle:e,endAngle:i,radius:u,innerRadius:d}),l.style);h=c0.i.circle(t)}h.name=gG.X9.line,h.id=this._getNodeId("line"),(0,c1.Z)(l.state)||(h.states=(0,cQ.Z)({},gG.n0,l.state)),t.add(h)}getTitleAttribute(){var t,e,i;let{center:r,radius:n,innerRadius:s=0}=this.attribute,l=this.attribute.title,{space:a=4,textStyle:o={},shape:h,background:u,state:d={}}=l,c=bZ(l,["space","textStyle","shape","background","state"]),p=r,g=0;(null==(t=this.attribute.label)?void 0:t.visible)&&!1===this.attribute.label.inside&&(g=(0,bD.Z)(this.attribute.label,"style.fontSize",12)+(0,bD.Z)(this.attribute.label,"space",4));let f=0;(null==(e=this.attribute.tick)?void 0:e.visible)&&!1===this.attribute.tick.inside&&(f=this.attribute.tick.length||4),(null==(i=this.attribute.subTick)?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(f=Math.max(f,this.attribute.subTick.length||2));let m=n+f+g+a,y="middle",{position:v}=this.attribute.title;(0,aY.Z)(v)&&(v=0===s?"end":"middle"),"start"===v?(y="bottom",p={x:r.x,y:r.y-m}):"end"===v&&(y="top",p={x:r.x,y:r.y+m});let b=Object.assign(Object.assign(Object.assign({},p),c),{textStyle:Object.assign({textBaseline:y,textAlign:"center"},o),state:{text:(0,cQ.Z)({},gG.n0,d.text),shape:(0,cQ.Z)({},gG.n0,d.shape),panel:(0,cQ.Z)({},gG.n0,d.background)}}),{angle:_}=c;return b.angle=_,h&&h.visible&&(b.shape=Object.assign({visible:!0},h.style),h.space&&(b.space=h.space)),u&&u.visible&&(b.panel=Object.assign({visible:!0},u.style)),b}getSubTickLineItems(){var t,e;let{subTick:i}=this.attribute,r=[],{count:n=4,inside:s=!1,length:l=2}=i,a=this.tickLineItems,o=a.length;if(o>=2){let i=this.data[1].value-this.data[0].value,h=null==(e=null==(t=this.attribute)?void 0:t.tick)?void 0:e.alignWithLabel;for(let t=0;t<o;t++){let e=a[t],o=a[t+1];for(let t=0;t<n;t++){let a=(t+1)/(n+1),u=(1-a)*e.value+a*(o?o.value:h?1:e.value+i),d=this.getTickCoord(u),c=this.getVerticalCoord(d,l,s);r.push({start:d,end:c,value:u})}}}return r}beforeLabelsOverlap(t,e,i,r,n){}handleLabelsOverlap(t,e,i,r,n){if((0,c1.Z)(t))return;let{inside:s,radius:l,center:a,size:o,label:h,orient:u}=this.attribute,d=o?{x1:0,y1:0,x2:o.width,y2:o.height}:{x1:a.x-l,y1:a.y-l,x2:a.x+l,y2:a.y+l},{layoutFunc:c,autoLimit:p,limitEllipsis:g,autoHide:f,autoHideMethod:m,autoHideSeparation:y,autoWrap:v}=h;(0,uy.Z)(c)?c(t,e,r,this):((p||v)&&function(t,e){let{ellipsis:i,inside:r,bounds:n,autoWrap:s,center:l}=e;r||t.forEach((e,r)=>{let{x:a,y:o}=e.attribute,h=e.AABBBounds;if((0,pS.Yt)(a,l.x)){if(o>n.y2||o<n.y1)return void bG(e,0,i);let s=n.x2-n.x1;if(t.length>=3){let{prevLabel:n,nextLabel:l}=bj(t,r),o=n.attribute.x,h=l.attribute.x;o>h&&(o=l.attribute.x,h=n.attribute.x);let u=o===h?s:a>=o&&a<=h?h-o:Math.min(Math.abs(o-a),Math.abs(h-a));e.AABBBounds.width()>u&&bG(e,u,i)}else e.AABBBounds.width()>s&&bG(e,s,i)}else a>l.x&&h.x2>n.x2?(bG(e,n.x2-a,i),s&&bV(t,r,n)):a<l.x&&h.x1<n.x1&&(bG(e,a-n.x1,i),s&&bV(t,r,n))})}(t,{inside:s,autoWrap:v,bounds:d,ellipsis:g,center:a}),f&&(0,bN.t)(t,{orient:u,method:m,separation:y}))}afterLabelsOverlap(t,e,i,r,n){}getTextBaseline(t){return .3>Math.abs(t[1]/t[0])?"middle":t[1]<0?"bottom":t[1]>0?"top":"middle"}getLabelAlign(t,e,i){return(0,pS.Yt)(t[0],0)?{textAlign:"center",textBaseline:t[1]>0?"top":"bottom"}:t[0]<0?{textAlign:"right",textBaseline:this.getTextBaseline(t)}:t[0]>0?{textAlign:"left",textBaseline:this.getTextBaseline(t)}:{textAlign:"center",textBaseline:"middle"}}getLabelPosition(t,e,i,r){return t}}bU.defaultAttributes=bz.p,(0,g1.jB)(bU,bW);var bK=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};(0,g9.sC)();class b$ extends g6{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},g6.defaultAttributes,t),e)}getGridPointsByValue(t){let e=this.getTickCoord(t),{radius:i,innerRadius:r=0}=this.attribute;return[e,this.getVerticalCoord(e,i-r,!0)]}getGridAttribute(t){let e,i=[],r=this.attribute,{radius:n,innerRadius:s=0,startAngle:l=pe.v2,endAngle:a=pe.Di,center:o,subGrid:h}=r,u=bK(r,["radius","innerRadius","startAngle","endAngle","center","subGrid"]),{alignWithLabel:d=!0}=u||{},c=n-s,p=this._parseTickSegment();if(t){e=(0,cQ.Z)({},u,h);let t=[],{count:r=4}=h||{},n=this.data.length;if(n>=2){let e=this._getPointsOfSubGrid(p,d);for(let i=0;i<n;i++){let n=e[i],s=e[i+1];t.push({id:`sub-${i}-0`,points:[this.getTickCoord(n.value),this.getVerticalCoord(this.getTickCoord(n.value),c,!0)],datum:{}});for(let e=0;e<r;e++){let l=(e+1)/(r+1),a=(1-l)*n.value+l*(s?s.value:d?1:n.value+p),o=this.getTickCoord(a),h=this.getVerticalCoord(o,c,!0);t.push({id:`sub-${i}-${e+1}`,points:[o,h],datum:{}})}}Math.abs(a-l)%(2*Math.PI)==0&&t.push(t[0]),i=t}}else{e=u;let t=[];(Math.abs(a-l)%(2*Math.PI)==0?[...this.data].concat(this.data[0]):this.data).forEach(e=>{let{point:i}=e;if(!d){let t=e.value-p/2;if(this.isInValidValue(t))return;i=this.getTickCoord(t)}let r=this.getVerticalCoord(i,c,!0);t.push({id:e.id,points:[i,r],datum:e})}),i=t}return Object.assign(Object.assign({},e),{items:i,center:o,type:"line"})}}(0,g1.jB)(b$,bW);let bY={grid:{smooth:!0,visible:!0},subGrid:{smooth:!0,visible:!1}},bX={grid:{visible:!0,style:{lineDash:[6,6]}},label:{space:5}};class bq extends bF{constructor(){super(...arguments),this.type=rk.polarBandAxis,this._scale=new ae}computeDomain(t){return this.computeBandDomain(t)}updateScaleRange(){let t=super.updateScaleRange();return this.updateGroupScaleRange(),t}axisHelper(){let t=super.axisHelper();return Object.assign(Object.assign({},t),{getBandwidth:e=>t.getScale(e).bandwidth()})}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}registerTicksTransform(){let t=`${this.type}-ticks`;return nq(this._option.dataSet,t,bO.t),t}transformScaleDomain(){}}bq.type=rk.polarBandAxis,bq.specKey="axes",bq.builtInTheme={axis:fi,axisBand:fe,axisAngle:bX,axisRadius:bY},cG(bq,gQ);let bJ=()=>{iv.registerGraphicComponent(K.lineAxis,(t,e)=>new ft.$(t,e)),iv.registerGraphicComponent($.lineAxisGrid,(t,e)=>new g7(t,e)),iv.registerGraphicComponent(K.circleAxis,(t,e)=>new bU(t,e)),iv.registerGraphicComponent($.circleAxisGrid,(t,e)=>new b$(t,e)),gK(),iv.registerComponent(bq.type,bq)};class bQ extends bF{constructor(){super(...arguments),this.type=rk.polarLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new l4}setAttrFromSpec(){super.setAttrFromSpec(),this.setExtraAttrFromSpec()}initScales(){super.initScales(),this.setScaleNice()}computeDomain(t){return this.computeLinearDomain(t)}axisHelper(){let t=super.axisHelper();return t.setExtendDomain=this.setExtendDomain.bind(this),t}registerTicksTransform(){let t=`${this.type}-ticks`;return nq(this._option.dataSet,t,fm.m),t}}bQ.type=rk.polarLinearAxis,bQ.specKey="axes",bQ.builtInTheme={axis:fi,axisLinear:fy,axisAngle:bX,axisRadius:bY},cG(bQ,ff);let b0=()=>{iv.registerGraphicComponent(K.lineAxis,(t,e)=>new ft.$(t,e)),iv.registerGraphicComponent($.lineAxisGrid,(t,e)=>new g7(t,e)),iv.registerGraphicComponent(K.circleAxis,(t,e)=>new bU(t,e)),iv.registerGraphicComponent($.circleAxisGrid,(t,e)=>new b$(t,e)),gK(),iv.registerComponent(bQ.type,bQ)};class b1 extends bP{constructor(){super(...arguments),this.type=rR.rose,this.transformerConstructor=bI,this._roseMark=null,this._labelMark=null}initMark(){this.initRoseMark()}initMarkStyle(){this.initRoseMarkStyle()}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y}),this._markAttributeContext.startAngleScale=t=>this.startAngleScale(t),this._markAttributeContext.endAngleScale=t=>this.endAngleScale(t)}initRoseMark(){this._roseMark=this._createMark(b1.mark.rose,{groupKey:this._seriesField,isSeriesMark:!0},{morph:cR(this._spec,b1.mark.rose.name),morphElementKey:this.getDimensionField()[0]})}getRoseAngle(){var t,e,i;return null!=(i=null==(e=(t=this.angleAxisHelper).getBandwidth)?void 0:e.call(t,this._groups?this._groups.fields.length-1:0))?i:.5}startAngleScale(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}endAngleScale(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+this.getRoseAngle()-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}initRoseMarkStyle(){let t=this._roseMark;t&&this.setMarkStyle(t,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:t=>this.startAngleScale(t),endAngle:t=>this.endAngleScale(t),fill:this.getColorAttribute(),outerRadius:t=>aa(this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]]),this.radiusAxisHelper.getScale(0)),innerRadius:t=>{var e;if(!this.getStack())return 0;let i=aa(this.radiusAxisHelper.dataToPosition([t[this._innerRadiusField[0]]]),this.radiusAxisHelper.getScale(0));return i<=Number.MIN_VALUE?this._computeLayoutRadius()*(null!=(e=this._spec.innerRadius)?e:0):i}})}initTooltip(){super.initTooltip(),this._roseMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._roseMark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{text:t=>t[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:0})}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._roseMark&&this._roseMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("rose"))?void 0:i({innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!=(t=this._spec.innerRadius)?t:0)}},r),cM("rose",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._roseMark]}}b1.type=rR.rose,b1.mark=bE,b1.builtInTheme={rose:{rose:{style:{fillOpacity:1}},label:{style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"},textAlign:"center",textBaseline:"middle"}}}},b1.transformerConstructor=bI;let b2=()=>{iv.registerSeries(b1.type,b1),bp(),bB(),bJ(),b0()};class b3 extends b_{needAxes(){return!0}_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.categoryField=t.categoryField||t.angleField,e.valueField=t.valueField||t.radiusField,e}transformSpec(t){var e;if(super.transformSpec(t),this.needAxes()){t.axes||(t.axes=[]);let i={radius:!1,angle:!1};(null!=(e=t.axes)?e:[]).forEach(t=>{let{orient:e}=t;"radius"===e&&(i.radius=!0),"angle"===e&&(i.angle=!0)}),i.angle||t.axes.push({orient:"angle"}),i.radius||t.axes.push({orient:"radius"})}}}class b5 extends b3{_getDefaultSeriesSpec(t){var e,i,r;let n=super._getDefaultSeriesSpec(t);return n.radius=null!=(e=t.radius)?e:.6,n.outerRadius=null!=(i=t.outerRadius)?i:.6,n.innerRadius=null!=(r=t.innerRadius)?r:0,n.stack=t.stack,n.percent=t.percent,n}transformSpec(t){var e;super.transformSpec(t),(null!=(e=t.axes)?e:[]).forEach(t=>{["domainLine","grid","label","tick"].forEach(e=>{t[e]||(t[e]={visible:!1})}),"angle"===t.orient&&er(t.bandPosition)&&(t.bandPosition=.5)}),t.crosshair=ed(t.crosshair||{}).map(t=>ir({categoryField:{visible:!0,line:{visible:!0,type:"rect"}}},t))}}let b4=(t,e)=>{let i=2*Math.PI,r=eg(e),n=ep(e);return t<r?t+=Math.ceil((r-t)/i)*i:t>n&&(t-=Math.ceil((t-n)/i)*i),t},b6=(t,e)=>{if(!t)return null;let i=f5(t,t=>"angle"===t.getOrient(),e),r=f5(t,t=>"radius"===t.getOrient(),e);if(!(i&&i.length||r&&r.length))return null;let n=[],s=t=>t.getDimensionField()[0],{x:l,y:a}=e;return i&&i.forEach(t=>{var e;let i=t.getScale();if(i&&ll(i.type)){let o=i.domain(),h=i.range(),u=t.getCenter(),d={x:l-t.getLayoutStartPoint().x-u.x,y:a-t.getLayoutStartPoint().y-u.y},c=dG({x:1,y:0},d);c=b4(c,h);let p=dV(d),g=null==(e=r[0])?void 0:e.getScale(),f=null==g?void 0:g.range();if((c-(null==h?void 0:h[0]))*(c-(null==h?void 0:h[1]))>0||(p-(null==f?void 0:f[0]))*(p-(null==f?void 0:f[1]))>0)return;let m=t.invert(c);if(er(m))return;let y=o.findIndex(t=>(null==t?void 0:t.toString())===m.toString());y<0&&(y=void 0);let v=f2(m,t,"polar",s);n.push({index:y,value:m,position:i.scale(m),axis:t,data:v})}}),r&&r.forEach(t=>{var e;let r=t.getScale(),o=null==r?void 0:r.range();if(r&&ll(r.type)){let h=t.getCenter(),u={x:l-t.getLayoutStartPoint().x-h.x,y:a-t.getLayoutStartPoint().y-h.y},d=dG({x:1,y:0},u);d<-Math.PI/2&&(d=2*Math.PI+d);let c=dV(u),p=null==(e=i[0])?void 0:e.getScale(),g=null==p?void 0:p.range();if((d-(null==g?void 0:g[0]))*(d-(null==g?void 0:g[1]))>0||(c-(null==o?void 0:o[0]))*(c-(null==o?void 0:o[1]))>0)return;let f=r.invert(c);if(er(f))return;let m=r.domain().findIndex(t=>(null==t?void 0:t.toString())===f.toString());m<0&&(m=void 0);let y=f2(f,t,"polar",s);n.push({index:m,value:f,position:r.scale(f),axis:t,data:y})}}),n.length?n:null};class b8 extends fV{constructor(){super(...arguments),this.transformerConstructor=b5,this.type="rose",this.seriesType=rR.rose}_setModelOption(){this._modelOption.getDimensionInfo=b6}}b8.type="rose",b8.seriesType=rR.rose,b8.transformerConstructor=b5,cG(b8,fK);let b9=()=>{mb(),mx(),f8(),fX(),b2(),iv.registerChart(b8.type,b8)};class b7 extends aq.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this._center=e.center}getEndProps(){return!1===this.valid?{}:ay(this._center,this._toRadius,this._toAngle)}onBind(){this.from=this.target.attribute,this.to=this.target.getFinalAttribute(),this._prevCenter=this.target.attribute.center,this._center&&this._prevCenter||(this.valid=!1);let{angle:t,radius:e}=av(this.from,this._prevCenter),{angle:i,radius:r}=av(this.to,this._center);en(i*r)||(this.valid=!1),this._fromAngle=en(t)?t:i,this._fromRadius=en(e)?e:r,this._toAngle=i,this._toRadius=r,l6(this._fromAngle,this._toAngle)&&l6(this._fromRadius,this._toRadius)&&(this.valid=!1),this.props=this.getEndProps()}onUpdate(t,e,i){if(!1===this.valid)return i.x=this.to.x,void(i.y=this.to.y);let{x:r,y:n}=ay({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*e,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*e},this._fromRadius+(this._toRadius-this._fromRadius)*e,this._fromAngle+(this._toAngle-this._fromAngle)*e);this.target.setAttributes({x:r,y:n}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class _t extends uF{onBind(){super.onBind();let{center:t}=this.target.attribute,{center:e}=this.target.getFinalAttribute();this._center=e,this._prevCenter=t}onUpdate(t,e,i){this.points=this.points.map((r,n)=>{let s=this.polarPointInterpolation(this.interpolatePoints[n][0],this.interpolatePoints[n][1],e);return t&&(i.center=this._center),s.context=r.context,s}),this.target.attribute.points=this.points,this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}_interpolationSinglePoint(t,e,i){if(!dZ(t)&&!dZ(e))return e;let r=av(t,this._prevCenter),n=av(e,this._center),s=ab(r.angle),l=ab(n.angle);!en(s)&&en(l)&&(s=l),en(s)&&!en(l)&&(l=s);let a=s+(l-s)*i,o=r.radius+(n.radius-r.radius)*i;return ay({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*i,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*i},o,a)}polarPointInterpolation(t,e,i){let{x:r,y:n}=this._interpolationSinglePoint(t,e,i),{x:s,y:l}=this._interpolationSinglePoint({x:t.x1,y:t.y1},{x:e.x1,y:e.y1},i),a=new dO(r,n,s,l);return a.defined=e.defined,a}}let _e=t=>({type:"in"===t?"fadeIn":"fadeOut"}),_i=(t,e)=>({type:"in"===e?"growPointsIn":"growPointsOut",options:()=>({center:t.center()})});function _r(t,e,i){return"fadeIn"===e?_e(i):_i(t,i)}let _n=(t,e)=>{let i=()=>{var e;return null==(e=t.center())?void 0:e.x},r=(t,e)=>e.getGraphicAttribute("x"),n=()=>{var e;return null==(e=t.center())?void 0:e.y},s=(t,e)=>e.getGraphicAttribute("y");return"in"===e?{channel:{x:{from:i,to:r},y:{from:n,to:s}}}:{channel:{x:{from:r,to:i},y:{from:s,to:n}}}};function _s(t,e,i){return"fadeIn"===e?_e(i):_n(t,i)}let _l=(t,e)=>({custom:uB,customParameters:(i,r)=>{var n;return{group:r,startAngle:null!=(n=t.startAngle)?n:Math.PI/2,orient:"clockwise",center:t.center(),radius:t.radius(),animationType:e}}}),_a=()=>{iv.registerAnimation("radar",(t,e)=>({appear:"clipIn"===e?void 0:_r(t,e,"in"),enter:_r(t,e,"in"),exit:_r(t,e,"out"),disappear:"clipIn"===e?void 0:_r(t,e,"out"),update:[{channel:["points","center"],custom:_t,customParameters:t,duration:u0.update.duration,easing:u0.update.easing},{type:"update",options:{excludeChannels:["points","defined","center"]}}]})),iv.registerAnimation("radarSymbol",(t,e)=>({appear:"clipIn"===e?void 0:_s(t,e,"in"),enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:"clipIn"===e?void 0:_s(t,e,"out"),update:[{options:{excludeChannels:["x","y","center"]}},{channel:["x","y","center"],custom:b7,customParameters:t,duration:u0.update.duration,easing:u0.update.easing}]})),iv.registerAnimation("radarGroup",(t,e)=>({appear:_l(t,"in"),disappear:_l(t,"out")})),(0,bu.x)()},_o=Object.assign(Object.assign(Object.assign({},cy),cN),{area:{name:"area",type:"area"}});class _h extends bP{constructor(){super(...arguments),this.type=rR.radar,this.transformerConstructor=pZ,this._sortDataByAxis=!1}initGroups(){}compile(){super.compile(),this.addOverlapCompile()}initMark(){var t,e,i,r;let n=!1!==(null==(t=this._spec.area)?void 0:t.visible)&&!1!==(null==(i=null==(e=this._spec.area)?void 0:e.style)?void 0:i.visible),s=null!=(r=this._spec.seriesMark)?r:"area";this.initAreaMark(n&&"area"===s),this.initLineMark("line"===s||"area"===s&&!n),this.initSymbolMark("point"===s)}initMarkStyle(){this.initAreaMarkStyle(),this.initLineMarkStyle(),this.initSymbolMarkStyle(),[this._lineMark,this._symbolMark,this._areaMark].forEach(t=>{t&&this.setMarkStyle(t,{center:()=>{var t;return null==(t=this.angleAxisHelper)?void 0:t.center()}})})}initAreaMark(t){this._areaMark=this._createMark(_h.mark.area,{groupKey:this._seriesField,isSeriesMark:t})}initAreaMarkStyle(){let t=this._areaMark;t&&(this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),x1:t=>t&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getStack()?this.getDatumPositionValues(t,this._innerRadiusField):this.radiusScale.domain()[0]).x:Number.NaN,y1:t=>t&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getStack()?this.getDatumPositionValues(t,this._innerRadiusField):this.radiusScale.domain()[0]).y:Number.NaN,fill:this.getColorAttribute(),curveType:cz,closePath:!0},"normal",W.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",W.Series),this.event.on(rI.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(t,"defined")}))}initTooltip(){super.initTooltip();let{group:t,mark:e}=this._tooltipHelper.activeTriggerSet;this._lineMark&&t.add(this._lineMark),this._areaMark&&t.add(this._areaMark),this._symbolMark&&(e.add(this._symbolMark),t.add(this._symbolMark))}initAnimation(){var t,e,i,r;let n={center:()=>{var t;return null==(t=this.angleAxisHelper)?void 0:t.center()},radius:()=>{let t=this.getLayoutRect();return Math.min(t.width,t.height)},startAngle:t8(this._spec.startAngle)?af(this._spec.startAngle):gR},s=null!=(i=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset)?i:"clipIn";"clipIn"===s&&this._rootMark&&this._rootMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("radarGroup"))?void 0:r(n,s),cM("group",this._spec,this._markAttributeContext))),[[this._areaMark,"radar"],[this._lineMark,"radar"],[this._symbolMark,"radarSymbol"]].forEach(([t,e])=>{if(t8(t)){let i=iv.getAnimationInKey(e);t.setAnimationConfig(cA(null==i?void 0:i(n,s),cM(t.name,this._spec,this._markAttributeContext)))}})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}getSeriesStyle(t){return e=>{var i,r,n,s;let l=null!=(r=null==(i=this._seriesMark)?void 0:i.getAttribute(e,t))?r:void 0;return"fill"!==e||l||(e="stroke",l=null!=(s=null==(n=this._seriesMark)?void 0:n.getAttribute(e,t))?s:void 0),"stroke"===e&&tq(l)?l[0]:l}}}_h.type=rR.radar,_h.mark=_o,_h.builtInTheme={radar:{label:{visible:!1,offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}}},_h.transformerConstructor=pZ,cG(_h,cj);let _u=()=>{iv.registerSeries(_h.type,_h),mG(),pW(),pV(),_a(),bJ(),b0()};class _d extends b3{_getDefaultSeriesSpec(t){var e;let i=super._getDefaultSeriesSpec(t);return i.line=t.line,i.point=t.point,i.stack=t.stack,i.percent=t.percent,i.area=ir({visible:!1},t.area),i.seriesMark=null!=(e=t.seriesMark)?e:"area",i.activePoint=t.activePoint,i.pointDis=t.pointDis,i.pointDisMul=t.pointDisMul,i.markOverlap=t.markOverlap,i}transformSpec(t){var e;super.transformSpec(t),(null!=(e=t.axes)?e:[]).forEach(t=>{"radius"===t.orient&&(["domainLine","label","tick"].forEach(e=>{t[e]||(t[e]={visible:!1})}),t.grid||(t.grid={visible:!0}))}),t.crosshair=ed(t.crosshair||{}).map(t=>ir({categoryField:{visible:!0,line:{visible:!0,type:"line"}}},t))}}class _c extends fV{constructor(){super(...arguments),this.transformerConstructor=_d,this.type="radar",this.seriesType=rR.radar}_setModelOption(){this._modelOption.getDimensionInfo=b6}}_c.type="radar",_c.seriesType=rR.radar,_c.transformerConstructor=_d,cG(_c,fK);let _p=()=>{mb(),mx(),mw(),f8(),fX(),_u(),iv.registerChart(_c.type,_c)};class _g extends fD{_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return delete e.data,e}_transformAxisSpec(t){t.axes&&t.autoBandSize&&t.series.forEach((e,i)=>{var r;if("bar"===e.type){let n=this._findBandAxisBySeries(e,i,t.axes);if(n&&!n.bandSize&&!n.maxBandSize&&!n.minBandSize){let t=e_(e.autoBandSize)&&null!=(r=e.autoBandSize.extend)?r:0,{barMaxWidth:i,barMinWidth:s,barWidth:l,barGapInGroup:a}=e;this._applyAxisBandSize(n,t,{barMaxWidth:i,barMinWidth:s,barWidth:l,barGapInGroup:a})}}})}transformSpec(t){if(super.transformSpec(t),t.series&&t.series.length){let e=this._getDefaultSeriesSpec(t);t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})})}t.axes&&t.axes.length&&t.axes.forEach(e=>{iW(e,"trimPadding")&&ir(e,sG(this.type,t))}),this._transformAxisSpec(t)}}class _f extends fV{constructor(){super(...arguments),this.transformerConstructor=_g,this.type="common"}_setModelOption(){this._modelOption.getDimensionInfo=(t,e,i)=>{var r,n;return[...null!=(r=mr(t,e,i))?r:[],...null!=(n=b6(t,e))?n:[]]},this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}_f.type="common",_f.transformerConstructor=_g,cG(_f,fK);let _m=()=>{mb(),mx(),mw(),f8(),iv.registerChart(_f.type,_f),fX()};class _y extends cs{constructor(){super(...arguments),this.shapeTypeCallback=()=>"square"}enableByType(t){return"mark"===t}getDefaultTitlePattern(t){return{key:"link info",value:"link info"}}getDefaultContentList(){return[{key:"time",value:t=>d3.getInstance().timeFormat("%Y%m%d %H:%M",t.from.split("_")[1])},{key:"type",value:t=>t.action_type},{key:"from",value:t=>t.from},{key:"to",value:t=>t.to}]}}var _v=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class _b extends od{constructor(){super(...arguments),this.type=_b.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x1:0,y1:0})}_transformGraphicAttributes(t,e,i){let r=super._transformGraphicAttributes(t,e,i),{x:n,x1:s,y:l,y1:a}=r;return Object.assign(Object.assign({},_v(r,["x","x1","y","y1"])),{points:[{x:n,y:l},{x:s,y:a}]})}_createGraphic(t={}){return(0,cq.W)(t)}}_b.type="rule";let __=()=>{iv.registerMark(_b.type,_b),(0,oc.W)(),(0,cJ.N)(),iv.registerGraphicComponent("line",cq.W)},_x=Object.assign(Object.assign({},cy),{group:{name:"group",type:"group"},link:{name:"link",type:"rule"},arrow:{name:"arrow",type:"symbol"}}),_C=(t,e)=>{let{infoKey:i,fields:r,linkData:n,dotData:s}=e,{fromField:l,toField:a,xField:o,yField:h}=r(),u=n(),d=s(),c={};return d.forEach(t=>{let e={};for(let r in t)r!==i&&(e[r]=t[r]);let r=t[i];null==r||r.forEach(t=>{c[t.node_name]=Object.assign({},e,t)})}),u.forEach(t=>{var e,i,r,n;t[l+"_xField"]=null==(e=null==c?void 0:c[t[l]])?void 0:e[o],t[l+"_yField"]=null==(i=null==c?void 0:c[t[l]])?void 0:i[h],t[a+"_xField"]=null==(r=null==c?void 0:c[t[a]])?void 0:r[o],t[a+"_yField"]=null==(n=null==c?void 0:c[t[a]])?void 0:n[h]}),u};class _w extends cD{constructor(){super(...arguments),this.type=rR.link}getFromField(){return this._fromField}setFromField(t){t8(t)&&(this._fromField=t)}getToField(){return this._toField}setToField(t){t8(t)&&(this._toField=t)}getDotTypeField(){return this._dotTypeField}setDotTypeField(t){t8(t)&&(this._dotTypeField=t)}getDotSeriesSpec(){return this._dotSeriesSpec}setDotSeriesSpec(t){t8(t)&&(this._dotSeriesSpec=t)}_getDotData(){let t=this._option.getChart().getSeriesInIndex([this._spec.dotSeriesIndex])[0];return t?t.getRawData().latestData:[]}initData(){var t;super.initData(),nq(this._option.dataSet,"linkDotInfo",_C),null==(t=this.getViewData())||t.transform({type:"linkDotInfo",options:{infoKey:"dots",fields:()=>({fromField:this._fromField,toField:this._toField,xField:this._dotSeriesSpec.xField,yField:this._dotSeriesSpec.yField}),linkData:()=>this._rawData.latestData,dotData:()=>this._getDotData()},level:F.linkDotInfo},!1)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFromField(this._spec.fromField),this.setToField(this._spec.toField),this.setDotTypeField(this._spec.dotTypeField),this.setDotSeriesSpec(this._spec.dotSeriesSpec)}initMark(){this._clipMark=this._createMark(_w.mark.group),this._containerMark=this._createMark(_w.mark.group,{parent:this._clipMark}),this._linkMark=this._createMark(_w.mark.link,{skipBeforeLayouted:!1,parent:this._containerMark}),this._arrowMark=this._createMark(_w.mark.arrow,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark})}initMarkStyle(){var t,e,i,r;let n=this._clipMark;n&&(this.setMarkStyle(n,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",W.Series),n.setMarkConfig({interactive:!1,clip:!0}));let s=this._containerMark;s&&(this.setMarkStyle(s,{x:this._spec.leftAppendPadding,width:this.getLayoutRect().width},"normal",W.Series),s.setMarkConfig({interactive:!1}));let l=this._linkMark;l&&this.setMarkStyle(l,{stroke:this.getColorAttribute(),strokeOpacity:this.dataToOpacity.bind(this),x:this.dataToPositionXFrom.bind(this),y:this.dataToPositionYFrom.bind(this),x1:this.dataToPositionXTo.bind(this),y1:this.dataToPositionYTo.bind(this)},"normal",W.Series);let a=this._arrowMark;if(a){let n=null!=(r=null==(i=null==(e=null==(t=this._theme)?void 0:t.arrow)?void 0:e.style)?void 0:i.size)?r:10;this.setMarkStyle(a,{x:this.dataToPositionXTo.bind(this),y:t=>this.dataToPositionArrowYTo(t,n),fill:this.getColorAttribute(),fillOpacity:this.dataToOpacity.bind(this),size:n,symbolType:t=>this.isPositionYFromHigher(t)?"triangleDown":"triangleUp"},"normal",W.Series)}}afterInitMark(){super.afterInitMark()}dataToPositionXFrom(t){if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._fromField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYFrom(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fromField+"_yField"))}dataToPositionXTo(t){if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._toField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYTo(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})}dataToPositionArrowYTo(t,e){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:i}=this._yAxisHelper,r=this.isPositionYFromHigher(t)?-e/2:e/2;return i(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})+r}dataToOpacity(t){return this.isPositionXOuterRange(t,this._fromField+"_xField")||this.isPositionXOuterRange(t,this._toField+"_xField")||t[this._fromField]===t[this._toField]?0:1}isPositionYFromHigher(t){return this.dataToPositionYFrom(t)<this.dataToPositionYTo(t)}isPositionXOuterRange(t,e){if(!this._xAxisHelper)return!1;let{dataToPosition:i,getScale:r}=this._xAxisHelper;return i(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})<r(0).range()[0]||i(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})>r(0).range()[1]}getDefaultColorDomain(){var t,e;return this._dotTypeField?null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._dotTypeField].values:this._seriesField?null==(e=this.getViewDataStatistics())?void 0:e.latestData[this._seriesField].values:[]}getColorAttribute(){var t,e,i;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:null!=(i=null!=(e=this._dotTypeField)?e:this._seriesField)?i:sl}}getInteractionTriggers(){let t=[];return this._linkMark&&t.push(this._linkMark),this._arrowMark&&t.push(this._arrowMark),this._parseInteractionConfig(t)}initTooltip(){this._tooltipHelper=new _y(this),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._arrowMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._arrowMark)}onMarkTreePositionUpdate(t){t.forEach(t=>{t.commit(!1,!0)})}getDotInfoData(){var t,e;return null==(e=null!=(t=this._linkMark)?t:this._arrowMark)?void 0:e.getData()}getActiveMarks(){return[this._linkMark,this._arrowMark]}}_w.type=rR.link,_w.mark=_x,_w.builtInTheme={link:{arrow:{style:{size:10}}}};let _S=()=>{__(),pV(),fl(),fb(),iv.registerSeries(_w.type,_w)};class _A extends cs{constructor(){super(...arguments),this.shapeTypeCallback=()=>"square"}enableByType(t){return"mark"===t}getDefaultTitlePattern(t){return{key:"event info",value:"event info"}}getDefaultContentList(){return[{key:t=>t.type,value:t=>t.id},{key:"event_time",value:t=>d3.getInstance().timeFormat("%Y%m%d",t.event_time)},{key:"action_type",value:t=>t.action_type},{key:"children",value:t=>t.children}]}getTooltipData(t,e,i,r,n){var s,l,a,o;let h=super.getTooltipData(t,e,i,r,n),u=null!=(a=null==(l=null==(s=this.spec)?void 0:s[t])?void 0:l.updateContent)?a:null==(o=null==e?void 0:e[t])?void 0:o.updateContent;return h&&!u&&(h.updateContent=(t,e,i)=>{let r=[],n=t.filter(t=>"children"===t.key);return n.length>0&&n[0].value.forEach(t=>{let e=!0;for(let i in t)r.push(Object.assign(Object.assign({},n[0]),{shapeType:"circle",hasShape:e,key:i,value:t[i]+""})),e=!1}),t.concat(r)}),h}}let _M=(t,e)=>{var i;let r=(null==(i=t[0])?void 0:i.latestData)?t[0].latestData:t||[],n=[],s=0;return r.forEach(t=>{let i,r={};for(let n in t)n===e||n.startsWith(st)||(r[n]=t[n],i=t8(i)?`${i}_${t[n]}`:`${t[n]}`);let l=t[e];null==l||l.forEach((t,e)=>{n.push(Object.assign({},r,t,{[sn]:s,[ss]:`${i}_${e}`})),s++})}),n},_k={fill:"#bbb",fillOpacity:.2};var _T=i(29559);class _R extends od{getTextType(){return this._textType}constructor(t,e){super(t,e),this.type=_R.type,this._textType="text"}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{angle:0,textAlign:"center",lineWidth:0,textConfig:[]})}initStyleWithSpec(t){super.initStyleWithSpec(t),t.textType&&(this._textType=t.textType)}_transformGraphicAttributes(t,e,i){let r=super._transformGraphicAttributes(t,e,i),{text:n}=r;return e_(n)&&t8(n.text)&&("rich"===this._textType||"rich"===n.type)&&(r.textConfig=n.text),r}_createGraphic(t={}){let{text:e}=t;return"rich"===this._textType||"rich"===(null==e?void 0:e.type)?(0,_T.p)(t):(0,g$.r)(t)}}_R.type="text";let _B=()=>{iv.registerMark(_R.type,_R),(0,oc.W)(),(0,py.g)(),(0,pv.v)(),iv.registerGraphicComponent("text",g$.r),iv.registerGraphicComponent("richtext",_T.p)},_P=Object.assign(Object.assign({},cy),{group:{name:"group",type:"group"},grid:{name:"grid",type:"rule"},gridBackground:{name:"gridBackground",type:"rect"},dot:{name:"dot",type:"symbol"},title:{name:"title",type:"text"},subTitle:{name:"subTitle",type:"text"},symbol:{name:"symbol",type:"symbol"}});class _E extends cD{constructor(){super(...arguments),this.type=rR.dot}getSeriesGroupField(){return this._seriesField}setSeriesGroupField(t){t8(t)&&(this._seriesGroupField=t)}getTitleField(){return this._titleField}setTitleField(t){t8(t)&&(this._titleField=t)}getSubTitleField(){return this._subTitleField}setSubTitleField(t){t8(t)&&(this._subTitleField=t)}getDotTypeField(){return this._dotTypeField}setDotTypeField(t){t8(t)&&(this._dotTypeField=t)}getHighLightSeriesGroup(){return this._highLightSeriesGroup}setHighLightSeriesGroup(t){t8(t)&&(this._highLightSeriesGroup=t)}setGridBackground(t){t8(t)&&(this._gridBackground=t)}initData(){var t;super.initData(),this._xDimensionStatisticsDomain=this.getRawData().latestData.map(t=>t[this._fieldY[0]]),nq(this._option.dataSet,"objFlat",_M),nq(this._option.dataSet,"copyDataView",n3),nJ(this._option.dataSet,"dataview",tJ),null==(t=this.getViewData())||t.transform({type:"objFlat",options:"dots",level:F.dotObjFlat},!1)}getStatisticFields(){return[{key:this._fieldY[0],operations:["values"],customize:this._xDimensionStatisticsDomain}]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setSeriesGroupField(this._spec.seriesGroupField),this.setTitleField(this._spec.titleField),this.setSubTitleField(this._spec.subTitleField),this.setDotTypeField(this._spec.dotTypeField),this.setHighLightSeriesGroup(this._spec.highLightSeriesGroup),this.setGridBackground(ir(_k,(null==(t=this._spec.grid)?void 0:t.background)||{}))}initMark(){this._clipMark=this._createMark(_E.mark.group),this._containerMark=this._createMark(_E.mark.group,{parent:this._clipMark,dataView:this.getRawData()}),this._gridBackgroundMark=this._createMark(_E.mark.gridBackground,{parent:this._containerMark,dataView:this.getRawData()}),this._gridMark=this._createMark(_E.mark.grid,{parent:this._containerMark,dataView:this.getRawData()}),this._dotMark=this._createMark(_E.mark.dot,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark}),this._titleMark=this._createMark(_E.mark.title,{parent:this._containerMark,dataView:this.getRawData()}),this._subTitleMark=this._createMark(_E.mark.subTitle,{parent:this._containerMark,dataView:this.getRawData()}),this._symbolMark=this._createMark(_E.mark.symbol,{parent:this._containerMark,dataView:this.getRawData()})}initMarkStyle(){let t=this._clipMark;t&&(this.setMarkStyle(t,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",W.Series),t.setMarkConfig({interactive:!1,clip:!0}));let e=this._containerMark;e&&(this.setMarkStyle(e,{x:this._spec.leftAppendPadding},"normal",W.Series),e.setMarkConfig({interactive:!1}));let i=this._gridBackgroundMark;i&&this.setMarkStyle(i,{x:this.getRegionRectLeft.bind(this),x1:this.getRegionRectRight.bind(this),y:this.dataToGridBackgroundPositionY.bind(this),y1:this.dataToGridBackgroundPositionY1.bind(this),fill:this._gridBackground.fill,fillOpacity:this.dataToGridBackgroundOpacity.bind(this)},"normal",W.Series);let r=this._gridMark;r&&this.setMarkStyle(r,{stroke:this.getColorAttribute(),x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),x1:this.getRegionRectRight.bind(this),y1:this.dataToPositionY.bind(this)},"normal",W.Series);let n=this._dotMark;n&&this.setMarkStyle(n,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),fill:this.getDotColorAttribute(),stroke:this.getDotColorAttribute(),fillOpacity:this.dataToOpacity.bind(this)},"normal",W.Series);let s=this._titleMark;s&&this.setMarkStyle(s,{fill:this.getColorAttribute(),text:t=>t[this.getTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",W.Series);let l=this._subTitleMark;l&&this.setMarkStyle(l,{fill:this.getColorAttribute(),text:t=>t[this.getSubTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",W.Series);let a=this._symbolMark;a&&this.setMarkStyle(a,{x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),fill:this.getColorAttribute()},"normal",W.Series)}dataToGridBackgroundPositionY(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e,getBandwidth:i}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})-i(0)/2}dataToGridBackgroundPositionY1(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e,getBandwidth:i}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})+i(0)/2}dataToOpacity(t){var e,i,r,n;if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:s,getScale:l}=this._xAxisHelper;return s(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})<l(0).range()[0]||s(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})>l(0).range()[1]?0:null!=(n=null==(r=null==(i=null==(e=this._theme)?void 0:e.dot)?void 0:i.style)?void 0:r.fillOpacity)?n:1}dataToGridBackgroundOpacity(t){return t[this._seriesGroupField]===this._highLightSeriesGroup?this._gridBackground.fillOpacity:0}onLayoutEnd(){var t,e;super.onLayoutEnd();let i=null!=(e=null==(t=this._spec)?void 0:t.leftAppendPadding)?e:0;this.setMarkStyle(this._clipMark,{width:this.getLayoutRect().width+i},"normal",W.Series)}getDefaultColorDomain(){var t,e;return this._seriesGroupField?null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._seriesGroupField].values:this._seriesField?null==(e=this.getViewDataStatistics())?void 0:e.latestData[this._seriesField].values:[]}getColorAttribute(){var t,e,i;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:null!=(i=null!=(e=this._seriesGroupField)?e:this._seriesField)?i:sl}}getDotColorScale(){var t,e,i;let r=this._dotTypeField?null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._dotTypeField].values:this._seriesGroupField?null==(e=this.getViewDataStatistics())?void 0:e.latestData[this._seriesGroupField].values:this._seriesField?null==(i=this.getViewDataStatistics())?void 0:i.latestData[this._seriesField].values:[],n=this._getDataScheme();return(new ar).domain(r).range(n)}getDotColorAttribute(){var t,e,i,r;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this.getDotColorScale(),field:null!=(r=null!=(i=null!=(e=this._dotTypeField)?e:this._seriesGroupField)?i:this._seriesField)?r:sl}}initTooltip(){this._tooltipHelper=new _A(this),this._dotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._dotMark)}onEvaluateEnd(t){super.onEvaluateEnd(t)}onMarkTreePositionUpdate(t){t.forEach(t=>{t.commit(!1,!0)})}getDotData(){var t;return null==(t=this._dotMark)?void 0:t.getData()}_getDataIdKey(){}getStackValueField(){return null}getActiveMarks(){return[this._dotMark]}}_E.type=rR.dot,_E.mark=_P,_E.builtInTheme={dot:{dot:{style:{size:10,fillOpacity:1}},symbol:{style:{size:10}},title:{style:{textAlign:"left",textBaseline:"middle",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},subTitle:{style:{textAlign:"left",textBaseline:"top",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}};let _I=()=>{pV(),__(),yi(),_B(),iv.registerSeries(_E.type,_E)};class _L extends fD{_getSeriesDataLength(t,e){var i,r;if(e.data){let t=ed(e.data)[0];return t instanceof el?null==(i=t.latestData)?void 0:i.length:null==(r=t.values)?void 0:r.length}let n=ed(t.data).find((t,i)=>e.dataId?t instanceof el?t.name===e.dataId:t.id===e.dataId:e.dataIndex===i);return n?n instanceof el?n.latestData.length:n.values.length:0}addAttrToComponentSpec(t,e,i){return Array.isArray(t)?t[0][e]=i:t[e]=i,t}addPaddingRow(t,e,i){t.push({index:e,size:i})}addOrientAxes(t,e,i,r){t.push({id:`regionAxesRow${i}`}),e.push({modelId:`axesRow${i}`,col:1,row:i}),r.axes[0].id=`axesRow${i}`,r.axes[0].regionIndex=Array.from(Array(r.series.length),(t,e)=>"top"===r.axes[0].orient?e+1:e)}transformSpec(t){var e,i,r,n,s,l,a,o,h,u,d,c,p,g,f;super.transformSpec(t);let m=0,y=[],v=[],b=[],_=[],x=[],C=this._option.getCompiler().getStage(),w=(C.viewWidth,C.viewHeight),S=0;if(null==t?void 0:t.legends){y.push({modelId:`legendRow${m}`,col:1,row:m}),this.addAttrToComponentSpec(t.legends,"id",`legendRow${m}`);let a=ed(t.legends),o=null!=(e=a[0].height)?e:40;if(a[0].padding){let t=ek(a[0].padding);o+=Number(null!=(i=null==t?void 0:t.bottom)?i:0),o+=Number(null!=(r=null==t?void 0:t.top)?r:0),a[0].offsetY=Number(null!=(s=null==(n=a[0])?void 0:n.offsetY)?s:0)+Number(null!=(l=null==t?void 0:t.top)?l:0)}x.push({index:m,size:o}),S+=o,m++}(null==t?void 0:t.dataZoom)&&(y.push({modelId:`dataZoomRow${m}`,col:1,row:m}),this.addAttrToComponentSpec(t.dataZoom,"id",`dataZoomRow${m}`),S+=60,m++,this.addPaddingRow(x,m,10),S+=10,m++),S+=60,null!==t.axes&&"top"!==(null==(o=null==(a=null==t?void 0:t.axes)?void 0:a[0])?void 0:o.orient)||(this.addOrientAxes(v,y,m,t),m++);let A=t.series.filter(t=>t.type!==rR.link).length,M=(w-S-20*A)/A,k=(null==(h=null==t?void 0:t.appendPadding)?void 0:h.left)||0,T=(null==(u=null==t?void 0:t.appendPadding)?void 0:u.right)||0;null==(d=null==t?void 0:t.series)||d.forEach(e=>{var i,r;if([rR.bar,rR.line,rR.area,rR.dot].includes(e.type)){if(y.push({modelId:`${e.type}Row${m}`,col:1,row:m}),y.push({modelId:`axesLeftRow${m}`,col:0,row:m}),v.push({id:`${e.type}Row${m}`,clip:!1}),x.push({index:m,size:(null==e?void 0:e.height)||M}),b.push({orient:"left",id:`axesLeftRow${m}`,type:e.type===rR.dot?"band":"linear",visible:e.type!==rR.dot,title:{visible:!0,autoRotate:!1,style:{text:null==e?void 0:e.barTitle,dx:-20,textBaseline:"middle",textAlign:"end"}},grid:{visible:"boolean"!=typeof(null==(i=null==e?void 0:e.grid)?void 0:i.visible)||(null==(r=null==e?void 0:e.grid)?void 0:r.visible),style:(t,i)=>{var r,n,s,l,a;let o=0;if(0===i){let t=null==(r=null==e?void 0:e.grid)?void 0:r.style;o=null!=(s=null!=(n=null==t?void 0:t.lineWidth)?n:null==t?void 0:t.strokeWidth)?s:1}return{lineWidth:o,stroke:(null==(a=null==(l=null==e?void 0:e.grid)?void 0:l.style)?void 0:a.stroke)||"#dfdfdf",lineDash:[0,0]}}},domainLine:{visible:!1},tick:{visible:!1},label:{visible:!1},regionIndex:v.length-1}),e.type===rR.dot){y.push({modelId:`scrollBarRightRow${m}`,col:2,row:m});let i=this._getSeriesDataLength(t,e),r=0;i&&(r=((null==e?void 0:e.height)||M)/(30*i)),_.push(Object.assign({orient:"right",visible:e.type===rR.dot&&r<1,id:`scrollBarRightRow${m}`,start:0,end:Math.min(r,1),filterMode:"axis",regionIndex:v.length-1,axisId:`axesLeftRow${m}`},ed(null==t?void 0:t.scrollBar)[0]))}e.regionIndex=v.length-1,m++,this.addPaddingRow(x,m,(null==e?void 0:e.padding)||20),m++,e.leftAppendPadding=k,e.type===rR.dot&&(e.title.style.dx=-k,e.subTitle.style.dx=-k)}}),this.addPaddingRow(x,m,20),m++,null==(c=null==t?void 0:t.series)||c.forEach(e=>{if(e.type===rR.link){let i=e.dotSeriesIndex+1;y.push({modelId:`${e.type}Row${i}`,col:1,row:i-1}),e.regionIndex=t.series[e.dotSeriesIndex].regionIndex,e.leftAppendPadding=k,e.height=t.series[e.dotSeriesIndex].height,e.clipHeight=t.series[e.dotSeriesIndex].clipHeight}}),(null==t?void 0:t.legends)&&this.addAttrToComponentSpec(t.legends,"regionIndex",[v.length-1]),"bottom"===(null==(g=null==(p=null==t?void 0:t.axes)?void 0:p[0])?void 0:g.orient)&&(this.addOrientAxes(v,y,m,t),m++),t.layout={type:"grid",col:4,row:m,colWidth:[{index:0,size:k},{index:2,size:12},{index:3,size:T}],rowHeight:x,elements:y},t.region=v,null==(f=t.axes)||f.push(...b),t.scrollBar=_}}var _F=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class _O extends fV{constructor(){super(...arguments),this.transformerConstructor=_L,this.type="sequence"}_createSeries(t,e){let i;if(!t)return;let{spec:r}=e,n=_F(e,["spec"]);if(r.type===rR.link&&(r.dotSeriesSpec=this._spec.series[r.dotSeriesIndex]),r.regionId&&(i=this.getRegionsInUserId(r.regionId)),i||(i=this.getRegionsInIndex(r.regionIndex?[r.regionIndex]:void 0)[0]),!i)return;let s=new t(r,Object.assign(Object.assign(Object.assign({},this._modelOption),n),{region:i,specKey:"series",globalScale:this._globalScale}));s&&(s.created(),this._series.push(s),i.addSeries(s))}}_O.type="sequence",_O.transformerConstructor=_L;let _D=()=>{mb(),mx(),_I(),_S(),fl(),fb(),iv.registerChart(_O.type,_O)};class _H extends fH{transformSpec(t){super.transformSpec(t),t.axes.forEach(t=>t.type="linear")}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["x2Field","y2Field","barMinHeight","barBackground","barGap"])}}class _z extends fV{constructor(){super(...arguments),this.transformerConstructor=_H}}_z.transformerConstructor=_H,cG(_z,fK);class _W extends _H{transformSpec(t){super.transformSpec(t),sW(t)}}class _N extends _z{constructor(){super(...arguments),this.transformerConstructor=_W,this.type="histogram",this.seriesType=rR.bar}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}_N.type="histogram",_N.seriesType=rR.bar,_N.transformerConstructor=_W;let _j=()=>{mb(),mx(),mw(),f8(),fX(),ya(),iv.registerChart(_N.type,_N)},_G=Object.assign(Object.assign({},cy),{group:{name:"group",type:"group"}});class _V extends v1{constructor(){super(...arguments),this._arcGroupMark=null,this._getAngleValueStart=t=>{let e=this._getAngleAxis(),{tickMask:i}=this._spec;if((null==i?void 0:i.forceAlign)&&this._isTickMaskVisible(e)){let r,n=t[this.getStack()?sh:sw],s=this._getAngleAxisSubTickData(e),l=s[1].value-s[0].value,a=af(i.offsetAngle);if(t8(n)){let t=ld(s,t=>t.value-n),e=t>=s.length||n>s[t].value-l/2?Math.min(t,s.length-1):t>0?t-1:void 0;void 0!==e&&(r=this.angleAxisHelper.dataToPosition([s[e].value-l/2]))}return er(r)&&(r=this.angleAxisHelper.dataToPosition([s[0].value-l/2])),r+a}return this._getAngleValueStartWithoutMask(t)},this._getAngleValueEnd=t=>{let e=this._getAngleAxis(),{tickMask:i}=this._spec;if((null==i?void 0:i.forceAlign)&&this._isTickMaskVisible(e)){let r=t[this.getStack()?su:this._angleField[0]],n=this._getAngleAxisSubTickData(e),s=n[1].value-n[0].value,l=af(i.offsetAngle),a=ld(n,t=>t.value-r),o=a>=n.length||r>n[a].value-s/2?Math.min(a,n.length-1):a>0?a-1:void 0;return(void 0!==o?this.angleAxisHelper.dataToPosition([n[o].value+s/2]):this.angleAxisHelper.dataToPosition([n[0].value-s/2]))+l}return this._getAngleValueEndWithoutMask(t)}}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec();let r=null==(t=this._option.globalInstance.getChart())?void 0:t.getSpec(),n=null!=(e=this._spec.startAngle)?e:null==r?void 0:r.startAngle;this._startAngle=t8(n)?af(n):gR;let s=null!=(i=this._spec.endAngle)?i:null==r?void 0:r.endAngle;this._endAngle=t8(s)?af(s):gB,this.setAngleField(this._spec.valueField||this._spec.angleField),this.setRadiusField(this._spec.categoryField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice()}getStackGroupFields(){return this._radiusField}getStackValueField(){var t;return null==(t=this._angleField)?void 0:t[0]}getGroupFields(){return this._angleField}_convertMarkStyle(t){let e=super._convertMarkStyle(t);if(e.fill){let i=t.fill;"conical"!==(null==i?void 0:i.gradient)||t8(null==i?void 0:i.startAngle)||t8(null==i?void 0:i.endAngle)||(e.fill=Object.assign(Object.assign({},i),{startAngle:this._startAngle,endAngle:this._endAngle}))}return e}_getAngleValueStartWithoutMask(t){if(this.getStack()){let e=aa(this.angleAxisHelper.dataToPosition([t[sh]]),this.angleAxisHelper.getScale(0));if(en(e))return e}return this._startAngle}_getAngleValueEndWithoutMask(t){if(this.getStack()){let e=aa(this.angleAxisHelper.dataToPosition([t[su]]),this.angleAxisHelper.getScale(0));if(en(e))return e}let e=this.angleAxisHelper.dataToPosition([t[this._angleField[0]]]);return this._spec.clamp?aa(e,this.angleAxisHelper.getScale(0)):e}getDimensionField(){return this._specRadiusField}getMeasureField(){return this._specAngleField}initMark(){this._initArcGroupMark()}initMarkStyle(){this._initArcGroupMarkStyle()}_initArcGroupMark(){return this._arcGroupMark=this._createMark(_V.mark.group,{skipBeforeLayouted:!1}),this._arcGroupMark}_initArcGroupMarkStyle(){let t=this._arcGroupMark;t.created(),this.setMarkStyle(t,{x:0,y:0},"normal",W.Series),this._arcGroupMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0,clipPath:()=>{let t=this._getAngleAxis(),{x:e,y:i}=this.angleAxisHelper.center(),r=this._computeLayoutRadius();if(this._isTickMaskVisible(t)){let{tickMask:n}=this._spec,{angle:s,offsetAngle:l,style:a={}}=n;return this._getAngleAxisSubTickData(t).map(({value:t})=>{let n=this.angleAxisHelper.dataToPosition([t])+af(l),o=af(s)/2;return(0,bn.Q)(Object.assign(Object.assign({},a),{x:e,y:i,startAngle:n-o,endAngle:n+o,innerRadius:r*this._innerRadius,outerRadius:r*this._outerRadius,fill:!0}))})}let{width:n,height:s}=this.getLayoutRect();return[(0,yt.f)({width:n,height:s,fill:!0})]}})}_getAngleAxis(){if(!this.angleAxisHelper)return;let t=this.angleAxisHelper.getAxisId();return this._option.getChart().getAllComponents().find(e=>e.id===t)}_getAngleAxisTickData(t){var e;return null==(e=null==t?void 0:t.getTickData())?void 0:e.getLatestData()}_isTickMaskVisible(t){let e=this._getAngleAxisTickData(t),{tickMask:i}=this._spec;return i&&!1!==i.visible&&(null==e?void 0:e.length)>1}_getAngleAxisSubTickData(t){var e;let i=this._getAngleAxisTickData(t),r=[],{subTick:n={},tick:s={}}=null!=(e=null==t?void 0:t.getSpec())?e:{},{tickCount:l=4}=n,{alignWithLabel:a}=s;if((null==i?void 0:i.length)>=2){let t=i[1].value-i[0].value;for(let e=0;e<i.length-1;e++){let n=i[e],s=i[e+1];r.push(n);for(let e=0;e<l;e++){let i=(e+1)/(l+1),o=(1-i)*n.value+i*(s?s.value:a?1:n.value+t);r.push({value:o})}}return r.push(i[i.length-1]),r}return i}}_V.mark=_G;let _Z=Object.assign(Object.assign({},_G),{track:{name:"track",type:"arc"},progress:{name:"progress",type:"arc"}}),_U=t=>({type:"growAngleIn",options:{overall:t.startAngle}}),_K={type:"fadeIn"},_$=()=>{iv.registerAnimation("circularProgress",(t,e)=>({appear:"fadeIn"===e?_K:_U(t),enter:{type:"growAngleIn"},disappear:{type:"growAngleOut"}}))};class _Y extends cE{constructor(){super(...arguments),this._supportStack=!0}}class _X extends _V{constructor(){super(...arguments),this.type=rR.circularProgress,this.transformerConstructor=_Y,this._progressMark=null,this._trackMark=null,this._getRadiusValueStart=t=>{if(this.getGroupFields().length>1){let e=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()));if(en(e))return e}return this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]])},this._getRadiusValueEnd=t=>{var e,i;if(this.getGroupFields().length>1){let r=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+(null==(i=(e=this.radiusAxisHelper).getBandwidth)?void 0:i.call(e,this._groups?this._groups.fields.length-1:0));if(en(r))return r}return this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]])+this.radiusAxisHelper.getScale(0).step()}}getStackGroupFields(){return this.getGroupFields()}getGroupFields(){return this._radiusField}initMark(){super.initMark(),this._initTrackMark(),this._initProgressMark()}initMarkStyle(){super.initMarkStyle(),this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){return this._progressMark=this._createMark(_X.mark.progress,{parent:this._arcGroupMark,isSeriesMark:!0},{morph:cR(this._spec,"progress")}),this._progressMark}_initProgressMarkStyle(){var t;let e=this._progressMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart,endAngle:this._getAngleValueEnd,innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cap:null!=(t=this._spec.roundCap)&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0},"normal",W.Series)}getInteractionTriggers(){let t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)}initTooltip(){super.initTooltip(),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark)}_initTrackMark(){return this._trackMark=this._createMark(_X.mark.track,{parent:this._arcGroupMark}),this._trackMark.setMarkConfig({morph:!1,morphKey:null,morphElementKey:null}),this._trackMark}_initTrackMarkStyle(){let t=this._trackMark;t&&this.setMarkStyle(t,{visible:t=>{let e=this.angleAxisHelper.getScale(0).range(),i=Math.min(e[0],e[e.length-1]);return 1e-14>=Math.abs(this._getAngleValueStartWithoutMask(t)-i)},x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:()=>{let t=this.getStack()?sh:this._angleField[0],e=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueStart({[t]:e[0]})},endAngle:()=>{let t=this.getStack()?su:this._angleField[0],e=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueEnd({[t]:e[e.length-1]})},innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:100},"normal",W.Series)}initAnimation(){var t,e,i,r;let n=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._progressMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("circularProgress"))?void 0:i({startAngle:this._startAngle},n),cM("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("fadeInOut"))?void 0:r(),cM("track",this._spec,this._markAttributeContext)))}getActiveMarks(){return[this._progressMark]}}_X.type=rR.circularProgress,_X.mark=_Z,_X.builtInTheme={circularProgress:{outerRadius:.8,innerRadius:.6,progress:{style:{fillOpacity:1}},track:{style:{fillOpacity:.2}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}}},_X.transformerConstructor=_Y;let _q=()=>{iv.registerSeries(_X.type,_X),bp(),_$(),u5(),bJ(),b0()};class _J extends b_{needAxes(){return!1}_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t,["startAngle","endAngle","centerX","centerY"]);return e.categoryField=t.categoryField||t.radiusField,e.valueField=t.valueField||t.angleField,e}_transformProgressAxisSpec(t,e,i,r,n){var s,l;t.axes||(t.axes=[]);let a=(null!=(s=t.axes)?s:[]).find(t=>"radius"===t.orient),o=(null!=(l=t.axes)?l:[]).find(t=>"angle"===t.orient);o||(o=e,t.axes.push(o)),a||(a=i,t.axes.push(a)),er(o.type)&&(o.type="linear"),er(a.type)&&(a.type="band");let h=gg(o,{min:0,max:1});er(o.min)&&(o.min=h.min),er(o.max)&&(o.max=h.max),r&&Object.assign(o,ir({},r,o)),n&&Object.assign(a,ir({},n,a))}}class _Q extends _J{_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t);return r.progress=t.progress,r.track=t.track,r.tickMask=t.tickMask,r.cornerRadius=null!=(e=t.cornerRadius)?e:0,r.roundCap=null!=(i=t.roundCap)&&i,r}transformSpec(t){super.transformSpec(t),this._transformProgressAxisSpec(t,{orient:"angle",visible:!1},{orient:"radius",visible:!1},{forceInitTick:t.tickMask&&!1!==t.tickMask.visible})}}class _0 extends fV{constructor(){super(...arguments),this.transformerConstructor=_Q,this.type="circularProgress",this.seriesType=rR.circularProgress}_setModelOption(){this._modelOption.getDimensionInfo=b6}}_0.type="circularProgress",_0.seriesType=rR.circularProgress,_0.transformerConstructor=_Q,cG(_0,fK);let _1=()=>{mb(),mx(),f8(),fX(),_q(),iv.registerChart(_0.type,_0)},_2=Object.assign(Object.assign({},_G),{segment:{name:"segment",type:"arc"},track:{name:"track",type:"arc"}}),_3=Object.assign(Object.assign({},cy),{pin:{name:"pin",type:"path"},pinBackground:{name:"pinBackground",type:"path"},pointer:{name:"pointer",type:["path","rect"]}}),_5=t=>({channel:{angle:{from:t.startAngle+Math.PI/2}}}),_4={type:"fadeIn"},_6=()=>{iv.registerAnimation("gaugePointer",(t,e)=>{let i="fadeIn"===e?_4:_5(t);return{appear:i,enter:i,disappear:{type:"fadeOut"}}})};class _8 extends cE{constructor(){super(...arguments),this._supportStack=!1}}class _9 extends cs{enableByType(t){return"dimension"!==t}}let _7="M1 0 C1 0.55228 0.55228 1 0 1 C-0.552285 1 -1 0.55228 -1 0 C-1 -0.552285 -0.552285 -1 0 -1 C0.55228 -1 1 -0.552285 1 0Z";class xt extends _V{constructor(){super(...arguments),this.type=rR.gaugePointer,this.transformerConstructor=_8,this._pinMark=null,this._pointerMark=null,this._pinBackgroundMark=null}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setRadiusField(this._spec.radiusField),this._pointerType="rect"===(null==(t=this._spec.pointer)?void 0:t.type)?"rect":"path"}initMark(){this._pinBackgroundMark=this._createMark(xt.mark.pinBackground),this._pointerMark=this._createMark(Object.assign(Object.assign({},xt.mark.pointer),{type:this._pointerType}),{isSeriesMark:!0}),this._pinMark=this._createMark(xt.mark.pin)}initMarkStyle(){this.initPinBackgroundMarkStyle(),this.initPointerMarkStyle(),this.initPinMarkStyle()}initGroups(){}initPointerMarkStyle(){let t=this._pointerMark,e=this._spec.pointer;t&&(this.setMarkStyle(t,{x:t=>{var i,r;let{x:n}=this._getPointerAnchor(t,e);return n-this._getPointerWidth()*(null!=(r=null==(i=null==e?void 0:e.center)?void 0:i[0])?r:0)},y:t=>{var i,r;let{y:n}=this._getPointerAnchor(t,e);return n-this._getPointerHeight(t)*(null!=(r=null==(i=null==e?void 0:e.center)?void 0:i[1])?r:0)},anchor:t=>{let{x:i,y:r}=this._getPointerAnchor(t,e);return[i,r]},fill:this.getColorAttribute(),zIndex:200}),"path"===this._pointerType?this.setMarkStyle(t,{scaleX:this._getPointerWidth.bind(this),scaleY:this._getPointerHeight.bind(this),angle:t=>this._getPointerAngle(t)+Math.PI/2}):this.setMarkStyle(t,{width:this._getPointerWidth.bind(this),height:this._getPointerHeight.bind(this),angle:t=>this._getPointerAngle(t)-Math.PI/2}))}initTooltip(){this._tooltipHelper=new _9(this),this._pointerMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pointerMark)}_getPointerAnchor(t,e){var i;return null==(i=e.isOnCenter)||i?this.angleAxisHelper.center():this.radiusAxisHelper.coordToPoint({radius:this._innerRadius*this._computeLayoutRadius(),angle:this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])})}_getPointerWidth(){return this._spec.pointer.width*this._computeLayoutRadius()}_getPointerHeight(t){var e,i;let r=this._spec.pointer,n=this._radiusField[0];return t8(this.radiusAxisHelper)&&t8(n)?this.radiusAxisHelper.dataToPosition([t[n]])-(null!=(e=null==r?void 0:r.innerPadding)?e:0)-(null!=(i=null==r?void 0:r.outerPadding)?i:10):r.height*this._computeLayoutRadius()}_getPointerAngle(t){let e=this.angleAxisHelper.getScale().domain(),i=ep(e),r=eg(e),n=eG(t[this._angleField[0]],r,i);return this.angleAxisHelper.dataToPosition([n])}_getRotatedPointerCenterOffset(t){var e,i,r,n;let s=this._spec.pointer,l=this._getPointerWidth()*(null!=(i=null==(e=null==s?void 0:s.center)?void 0:e[0])?i:0),a=-this._getPointerHeight(t)*(null!=(n=null==(r=null==s?void 0:s.center)?void 0:r[1])?n:0),o=this._getPointerAngle(t)-Math.PI/2,h=Math.cos(o),u=Math.sin(o);return{x:l*h+a*u,y:-(a*h-l*u)}}initPinBackgroundMarkStyle(){let t=this._pinBackgroundMark,e=this._spec.pinBackground;t&&this.setMarkStyle(t,{x:t=>this._getPointerAnchor(t,e).x,y:t=>this._getPointerAnchor(t,e).y,scaleX:()=>e.width*this._computeLayoutRadius(),scaleY:()=>e.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:100})}initPinMarkStyle(){let t=this._pinMark,e=this._spec.pin;t&&this.setMarkStyle(t,{x:t=>this._getPointerAnchor(t,e).x,y:t=>this._getPointerAnchor(t,e).y,scaleX:()=>e.width*this._computeLayoutRadius(),scaleY:()=>e.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:300})}getInteractionTriggers(){return this._parseInteractionConfig(this._pointerMark?[this._pointerMark]:[])}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._pointerMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("gaugePointer"))?void 0:i({startAngle:this._startAngle},r),cM("pointer",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}xt.type=rR.gaugePointer,xt.mark=_3,xt.builtInTheme={gaugePointer:{pointer:{type:"path",width:.4,height:.4,style:{path:"M-0.020059 -0.978425 C-0.018029 -0.9888053 -0.013378 -1 0 -1 C0.01342 -1 0.01812 -0.989146 0.0201 -0.978425 C0.02161 -0.9702819 0.0692 -0.459505 0.09486 -0.184807 C0.10298 -0.097849 0.1089 -0.034548 0.11047 -0.018339 C0.11698 0.04908 0.07373 0.11111 0.00002 0.11111 C-0.07369 0.11111 -0.117184 0.04991 -0.110423 -0.018339 C-0.103662 -0.086591 -0.022089 -0.9680447 -0.020059 -0.978425Z"}},pin:{width:.025,height:.025,style:{path:_7,fill:"#888"}},pinBackground:{width:.06,height:.06,style:{path:_7,fill:"#ddd"}}}},xt.transformerConstructor=_8;let xe=()=>{iv.registerSeries(xt.type,xt),yF(),yi(),_6(),bJ(),b0()};class xi extends cE{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){this._addMarkLabelSpec(t,"segment")}}class xr extends _V{constructor(){super(...arguments),this.type=rR.gauge,this.transformerConstructor=xi,this._segmentMark=null,this._trackMark=null,this._padAngle=0}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._padAngle=af(null!=(t=this._spec.padAngle)?t:0)}initData(){var t;super.initData(),nq(this._option.dataSet,"spiltSegment",(t,e)=>{let i=t.slice();return i.sort((t,e)=>t[this._angleField[0]]-e[this._angleField[0]]),i.forEach((t,e)=>{t[sS]=t[this._angleField[0]],t[sw]=e>0?i[e-1][sS]:void 0}),i}),null==(t=this.getViewData())||t.transform({type:"spiltSegment"},!1)}initMark(){super.initMark(),this._trackMark=this._createMark(xr.mark.track,{parent:this._arcGroupMark,dataView:!1}),this._segmentMark=this._createMark(xr.mark.segment,{parent:this._arcGroupMark,isSeriesMark:!0})}initMarkStyle(){super.initMarkStyle(),this.initTrackMarkStyle(),this.initSegmentMarkStyle()}initSegmentMarkStyle(){var t;let e=this._segmentMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart.bind(this),endAngle:this._getAngleValueEnd.bind(this),innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!=(t=this._spec.innerRadius)?t:0)},outerRadius:()=>{var t,e;return this._computeLayoutRadius()*(null!=(e=null!=(t=this._spec.radius)?t:this._spec.outerRadius)?e:1)},cap:null!=(t=this._spec.roundCap)&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0})}generateRadiusStyle(t){if(!t)return;let e={};return t.outerRadius&&(e.outerRadius=()=>this._computeLayoutRadius()*t.outerRadius),t.innerRadius&&(e.innerRadius=()=>this._computeLayoutRadius()*t.innerRadius),e}initMarkStyleWithSpec(t,e){if(super.initMarkStyleWithSpec(t,e),t&&"segment"===t.name){let e=this.getSpec().segment;if(e)for(let i in e.state||{})this.setMarkStyle(t,this.generateRadiusStyle(e.state[i]),i,W.User_Mark)}}initTooltip(){super.initTooltip(),this._segmentMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._segmentMark)}initTrackMarkStyle(){var t;let e=this._trackMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!=(t=this._spec.innerRadius)?t:0)},outerRadius:()=>{var t,e;return this._computeLayoutRadius()*(null!=(e=null!=(t=this._spec.radius)?t:this._spec.outerRadius)?e:1)},cap:null!=(t=this._spec.roundCap)&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,zIndex:100})}_getAngleValueStartWithoutMask(t){let e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),r=l3(e,(e+i)/2)(e+(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?aa(r,this.angleAxisHelper.getScale(0)):r}_getAngleValueEndWithoutMask(t){let e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),r=l3(i,(e+i)/2)(i-(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?aa(r,this.angleAxisHelper.getScale(0)):r}_getAngleValueStartWithoutPadAngle(t){return t8(t[sw])?this.angleAxisHelper.dataToPosition([t[sw]]):this._startAngle}_getAngleValueEndWithoutPadAngle(t){return this.angleAxisHelper.dataToPosition([t[sS]])}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._segmentMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("circularProgress"))?void 0:i({startAngle:this._startAngle},r),cM("segment",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}xr.type=rR.gauge,xr.mark=_2,xr.builtInTheme={gauge:{outerRadius:.8,innerRadius:.6,padAngle:1.146,segment:{style:{fillOpacity:1}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}}},xr.transformerConstructor=xi;let xn=()=>{iv.registerSeries(xr.type,xr),bp(),_$(),b0()};class xs extends _J{_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.radiusField=t.radiusField,e.pin=t.pin,e.pinBackground=t.pinBackground,e.pointer=t.pointer,e}_getDefaultCircularProgressSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.type=rR.circularProgress,e}transformSpec(t){var e,i,r,n,s;super.transformSpec(t);let l=null==(e=t.series)?void 0:e.find(t=>t.type===rR.gauge||t.type===rR.circularProgress);er(l)&&("circularProgress"===(l=null!=(i=t.gauge)?i:this._getDefaultCircularProgressSeriesSpec(t)).type&&(er(l.radiusField)&&er(l.categoryField)&&(l.radiusField=null!=(n=null!=(r=t.radiusField)?r:t.categoryField)?n:t.seriesField),er(l.valueField)&&er(l.angleField)&&(l.valueField=null!=(s=t.valueField)?s:t.angleField)),1===t.series.length?t.series.push(l):t.series.forEach(t=>{t.type===l.type&&Object.keys(l).forEach(e=>{e in t||(t[e]=l[e])})})),l.type===rR.circularProgress?this._transformProgressAxisSpec(t,{orient:"angle",visible:!0,domainLine:{visible:!1},grid:{visible:!1}},{orient:"radius",visible:!1},{zIndex:H.Region+50}):this._transformGaugeAxisSpec(t)}_transformGaugeAxisSpec(t){var e;t.axes||(t.axes=[]);let i={radius:null,angle:null};(null!=(e=t.axes)?e:[]).forEach(t=>{let{orient:e}=t;"radius"===e&&(i.radius=t),"angle"===e&&(i.angle=t)}),i.angle||(i.angle={orient:"angle",visible:!0},t.axes.push(i.angle)),i.radius||(i.radius={orient:"radius",visible:!1},t.axes.push(i.radius)),er(i.angle.type)&&(i.angle.type="linear"),er(i.radius.type)&&(i.radius.type="linear"),er(i.angle.zIndex)&&(i.angle.zIndex=H.Region+50)}}class xl extends fV{constructor(){super(...arguments),this.transformerConstructor=xs,this.type="gauge",this.seriesType=rR.gaugePointer}}xl.type="gauge",xl.seriesType=rR.gaugePointer,xl.transformerConstructor=xs;let xa=()=>{mx(),xe(),xn(),_q(),iv.registerChart(xl.type,xl)};class xo extends fD{transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["nameField","valueField","fontFamilyField","fontWeightField","fontStyleField","colorHexField","colorMode","colorList","rotateAngles","fontWeightRange","fontSizeRange","maskShape","keepAspect","random","wordCloudConfig","wordCloudShapeConfig","word","fillingWord","wordMask"])}}class xh extends fV{constructor(){super(...arguments),this.transformerConstructor=xo,this.type="wordCloud",this.seriesType=rR.wordCloud}}xh.transformerConstructor=xo;let xu=[0],xd=[20,40],xc=[200,500],xp={shrink:!1,enlarge:!1,fontSizeLimitMin:0},xg=["triangleForward","triangle","diamond","square","star","cardioid","circle","pentagon","rect"],xf=`${st}_WORD_CLOUD_TEXT`,xm=Object.assign(Object.assign({},cy),{word:{name:"word",type:"text"},fillingWord:{name:"fillingWord",type:"text"},wordMask:{name:"wordMask",type:"rect"}});var xy=i(25496),xv=i(77474);class xb extends cI{constructor(){super(...arguments),this._fontSizeRange=[20,20],this._isWordCloudShape=!1,this._dataChange=!0,this.handleMaskCanvasUpdate=(t,e)=>{this._maskCanvas=t},this.getWordColor=t=>t.isFillingWord?(this._fillingColorCallback&&!this._dataChange||(this._fillingColorCallback=this._wordCloudShapeConfig.fillingColorHexField?t=>t[this._wordCloudShapeConfig.fillingColorHexField]:this.initColorCallback(this._wordCloudShapeConfig.fillingSeriesField,!0)),this._fillingColorCallback(t)):(this._keyWordColorCallback&&!this._dataChange||(this._keyWordColorCallback=this._spec.colorHexField?t=>t[this._spec.colorHexField]:this.initColorCallback(this._seriesField,!1)),this._keyWordColorCallback(t)),this._calculateFontWeight=t=>{let e=this.getRawDataStatisticsByField(this._valueField,!0);return e.min===e.max?this._fontWeightRange[0]:this._fontWeightRange[0]+(this._fontWeightRange[this._fontWeightRange.length-1]-this._fontWeightRange[0])*(t[this._valueField]-e.min)/(e.max-e.min)}}setValueField(t){t8(t)&&(this._valueField=t)}setFontSizeRange(t){t8(t)?this._fontSizeRange=t:this._fontSizeRange=xd}setAttrFromSpec(){var t,e,i,r,n;super.setAttrFromSpec(),this._padding=this._option.getChart().padding,this._nameField=this._spec.nameField,this._colorMode=null!=(t=this._spec.colorMode)?t:"ordinal",this._colorList=this._spec.colorList,this.setValueField(this._spec.valueField),this._fontWeightRange=null!=(e=this._spec.fontWeightRange)?e:xc,this._rotateAngles=null!=(i=this._spec.rotateAngles)?i:xu,this.setFontSizeRange(this._spec.fontSizeRange),this._maskShape=null!=(r=this._spec.maskShape)?r:"circle",this._textField=(null==(n=this._spec.word)?void 0:n.formatMethod)?xf:this._nameField;let s=this._spec.wordCloudConfig;this._wordCloudConfig=Object.assign({drawOutOfBound:"hidden",layoutMode:"default",zoomToFit:xp},this._spec.wordCloudConfig),s&&!er(s.layoutMode)||eE(this._option.mode)||(this._wordCloudConfig.layoutMode="fast"),this._wordCloudShapeConfig=Object.assign({fillingSeriesField:this.getSeriesField(),fillingRotateAngles:xu,layoutMode:"default"},this._spec.wordCloudShapeConfig),this._isWordCloudShape=!xg.includes(this._maskShape)&&!["fast","grid","cloud"].includes(this._wordCloudConfig.layoutMode),this._defaultFontFamily=this._option.getTheme("fontFamily")}initData(){var t,e;super.initData(),null==(e=null==(t=this.getViewData())?void 0:t.target)||e.addListener("change",()=>{this._dataChange=!0,this.compile()})}initMark(){var t;this._wordMark=this._createMark(xb.mark.word,{key:ss,groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this._seriesField}),(null==(t=this._spec.wordMask)?void 0:t.visible)&&(this._maskMark=this._createMark(xb.mark.wordMask,{dataView:!1}),this._maskMark.setMarkConfig({zIndex:H.Mark-1}))}initMarkStyle(){this.initMarkStyleOfWord(this._wordMark,this._spec.word,this._spec.colorHexField,this._seriesField),this._maskMark&&this.setMarkStyle(this._maskMark,{width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,background:()=>this._maskCanvas},"normal",W.Series)}initMarkStyleOfWord(t,e,i,r,n){var s,l;t&&(this.setMarkStyle(t,{text:(null==e?void 0:e.formatMethod)?t=>e.formatMethod(t):t=>t[this._textField],x:t=>t.x,y:t=>t.y,fontSize:t=>t.fontSize,fontStyle:t=>t.fontStyle,angle:t=>t.angle,visible:t=>t.visible},"normal",W.Series),this.setMarkStyle(t,{fill:null!=(l=null==(s=null==e?void 0:e.style)?void 0:s.fill)?l:this.getWordColor,fontWeight:t=>t.fontWeight,fontFamily:t=>t.fontFamily},"normal",W.User_Mark))}initTooltip(){super.initTooltip(),this._wordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._wordMark)}initAnimation(){[this._wordMark].forEach(t=>{var e,i;if(t){let r=null==(i=null==(e=this._spec)?void 0:e.animationAppear)?void 0:i.preset;t.setAnimationConfig(cA(iv.getAnimationInKey("wordCloud")({animationConfig:()=>{var e,i;return null==(i=null==(e=t.getAnimationConfig())?void 0:e.appear)?void 0:i[0]}},r),cM("word",this._spec,this._markAttributeContext)))}})}getWordOrdinalColorScale(t,e){var i,r,n,s,l;let a=e?this._wordCloudShapeConfig.fillingColorList:this._colorList,o=t?null==(i=this.getViewData())?void 0:i.latestData.map(e=>e[t]):[],h=null!=(n=null!=a?a:null==(r=this._option.globalScale.getScale("color"))?void 0:r.range())?n:this._getDataScheme();return null==(l=(s=(new ar).domain(o)).range)?void 0:l.call(s,h)}initColorCallback(t,e){var i,r,n,s;if("ordinal"===this._colorMode){let i=this.getWordOrdinalColorScale(t,e);return e=>i.scale(e[null!=t?t:sl])}let l=null!=(i=e?this._colorList:this._wordCloudShapeConfig.fillingColorList)?i:this._option.globalScale.getScale("color").range();if(1===l.length)return t=>l[0];if(this._valueField){let t=this.getRawDataStatisticsByField(this._valueField,!0);if(t.min===t.max)return l[0];let e=(new l4).domain([t.min,t.max]).range(l);return t=>e.scale(t[this._valueField])}let a=(new l4).domain([0,null!=(s=null==(n=null==(r=this.getViewData())?void 0:r.latestData)?void 0:n.length)?s:1]).range(l);return t=>a.scale(t[sn])}compile(){super.compile();let{width:t,height:e}=this._region.getLayoutRect();if(!en(t)||!en(e)||!(e>0&&t>0))return;let i=[];this._isWordCloudShape?i.push(Object.assign({type:"wordcloudShape"},this._wordCloudShapeTransformOption())):i.push(Object.assign({type:"wordcloud"},this._wordCloudTransformOption())),this._wordMark.setTransform(i)}_getCommonTransformOptions(){var t,e,i,r,n;let{width:s,height:l}=this._region.getLayoutRect(),a=null!=(t=this._spec.word)?t:{},o=null!=(e=a.style)?e:{};return{size:[s,l],shape:e_(this._maskShape)&&"text"===this._maskShape.type&&er(this._maskShape.fontFamily)?Object.assign({fontFamily:this._option.getTheme("fontFamily")},this._maskShape):this._maskShape,onUpdateMaskCanvas:this.handleMaskCanvasUpdate,onLayoutFinished:()=>{let t=()=>{var e,i,r,n;this._option.globalInstance.getStage().hooks.afterRender.taps=this._option.globalInstance.getStage().hooks.afterRender.taps.filter(e=>e.fn!==t),null==(i=(e=this._option).dispatchEvent)||i.call(e,rI.afterWordcloudShapeDraw,{instance:this._option.globalInstance}),null==(n=null==(r=this._option.globalInstance.getChart().getOption().performanceHook)?void 0:r.afterWordcloudShapeDraw)||n.call(r,this._option.globalInstance)};this._option.globalInstance.getStage().hooks.afterRender.taps.push({type:"sync",name:"afterWordcloudShapeDraw",fn:t})},dataIndexKey:ss,text:a.formatMethod?t=>a.formatMethod(t):{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:null!=(r=null==(i=this._spec.word)?void 0:i.padding)?r:1,fontFamily:t8(this._spec.fontFamilyField)?{field:this._spec.fontFamilyField}:null!=(n=o.fontFamily)?n:this._defaultFontFamily,fontWeight:t8(this._spec.fontWeightField)?{field:this._spec.fontWeightField}:t8(o.fontWeight)?o.fontWeight:t8(this._valueField)?this._calculateFontWeight:"normal",fontStyle:t8(this._spec.fontStyleField)?{field:this._spec.fontStyleField}:o.fontStyle,createCanvas:ea.rF.createCanvas.bind(ea.rF),getTextBounds:xy.o}}_wordCloudTransformOption(){var t,e;return Object.assign(Object.assign(Object.assign({},null!=(t=this._wordCloudConfig)?t:{}),this._getCommonTransformOptions()),{layoutType:this._wordCloudConfig.layoutMode,rotate:this._rotateAngles,randomVisible:null==(e=this._spec.random)||e,clip:"clip"===this._wordCloudConfig.drawOutOfBound,shrink:this._wordCloudConfig.zoomToFit.shrink,enlarge:this._wordCloudConfig.zoomToFit.enlarge,minFontSize:this._wordCloudConfig.zoomToFit.fontSizeLimitMin,progressiveTime:this._wordCloudConfig.progressiveTime,progressiveStep:this._wordCloudConfig.progressiveStep,repeatFill:this._wordCloudConfig.zoomToFit.repeat})}_wordCloudShapeTransformOption(){var t,e,i,r,n,s;let l=null!=(e=null==(t=this._spec.fillingWord)?void 0:t.style)?e:{},a=null!=(i=this._wordCloudShapeConfig)?i:{};return Object.assign(Object.assign(Object.assign({},a),this._getCommonTransformOptions()),{createImage:xv.B,rotateList:this._rotateAngles,fillingRotateList:a.fillingRotateAngles,fillingFontFamily:t8(a.fillingFontFamilyField)?{field:a.fillingFontFamilyField}:null!=(r=l.fontFamily)?r:this._defaultFontFamily,fillingPadding:null!=(s=null==(n=this._spec.fillingWord)?void 0:n.padding)?s:1,fillingFontStyle:t8(a.fillingFontStyleField)?{field:a.fillingFontStyleField}:l.fontStyle,fillingFontWeight:t8(a.fillingFontWeightField)?{field:a.fillingFontWeightField}:l.fontWeight})}getStatisticFields(){let t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}dataToPosition(t){return null}dataToPositionX(t){return null}dataToPositionY(t){return null}dataToPositionZ(t){return null}valueToPosition(t,e){return null}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}onLayoutEnd(){super.onLayoutEnd(),this.compile(),this._dataChange=!1}getActiveMarks(){return[this._wordMark]}reInit(){super.reInit(),this._keyWordColorCallback&&(this._keyWordColorCallback=null),this._fillingColorCallback&&(this._fillingColorCallback=null)}}xb.mark=xm,xb.builtInTheme={wordCloud:{word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}}};let x_=t=>({type:"scaleIn",duration:200,delay:(e,i)=>{let r=t.animationConfig(),n=(null==r?void 0:r.duration)||200,s=(null==r?void 0:r.totalTime)||u0.appear.duration,l=i.context.graphicCount;return i.context.graphicIndex*(n*l<s?n+(s-l*n)/(l-1):(s-n)/(l-1))}}),xx=()=>{iv.registerAnimation("wordCloud",(t,e)=>({appear:!1===e?{}:"fadeIn"===e?{type:"fadeIn"}:x_(t),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}))};function xC(t){return parseFloat("0."+Math.sin(t).toString().substring(6))}let xw=()=>{let t=-1,e=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9];return()=>(t=(t+1)%e.length,e[t])},xS={triangleForward:function(){return function(t){let e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}},triangleUpright:xA,triangle:xA,diamond:function(){return function(t){let e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))}},square:function(){return function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))}},star:function(){return function(t){let e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}},cardioid:function(){return function(t){return 1+Math.sin(t)}},circle:function(){return function(){return 1}},pentagon:function(){return function(t){let e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))}}};function xA(){return function(t){let e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function xM(t,e){let i=e[0],r=e[1],n=1,s=[e[0]>>1,e[1]>>1];switch(t){case"cardioid":s[1]=~~(r/2.7*.4),n=Math.floor(Math.min(i/2.3,r/2.6));break;case"triangleForward":n=r/Math.sqrt(.75)>i?Math.floor(i/2):Math.floor(r/(2*Math.sqrt(.75)));break;case"triangle":case"triangleUpright":s[1]=~~(r/1.5),n=Math.floor(Math.min(r/1.5,i/2));break;case"circle":case"diamond":case"square":case"star":case"pentagon":n=Math.floor(Math.min(i/2,r/2));break;default:n=Math.floor(Math.max(i/2,r/2))}return{maxRadius:n,center:s}}let xk=t=>xS[t]?xS[t]():xS.circle(),xT=(t,e)=>"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)";function xR(t){return tQ(t)?t:function(){return t}}class xB{constructor(t){var e,i;switch(this.options=ei({},xB.defaultOptions,t),tQ(this.options.shape)?this.shape=this.options.shape:this.shape=xk(this.options.shape),this.getText=null!=(e=xR(this.options.text))?e:t=>t,this.getTextFontWeight=xR(this.options.fontWeight),this.getTextFontSize=xR(this.options.fontSize),this.getTextFontStyle=xR(this.options.fontStyle),this.getTextFontFamily=xR(this.options.fontFamily),this.outputCallback=null!=(i=this.options.outputCallback)?i:t=>t,this.options.color){case"random-dark":this.getTextColor=()=>xT(10,50);break;case"random-light":this.getTextColor=()=>xT(50,90);break;default:this.getTextColor=xR(this.options.color)}if(er(this.options.rotate))if(this.options.useRandomRotate){let t=Math.abs(this.options.maxRotation-this.options.minRotation),e=Math.abs(Math.floor(this.options.rotationSteps)),i=Math.min(this.options.maxRotation,this.options.minRotation);this.getTextRotate=()=>0===this.options.rotateRatio||Math.random()>this.options.rotateRatio?0:0===t?i:e>0?i+Math.floor(Math.random()*e)*t/(e-1):i+Math.random()*t}else this.getTextRotate=()=>0;else this.getTextRotate=tQ(this.options.rotate)?t=>{var e;return af(null!=(e=this.options.rotate(t))?e:0)}:(t,e)=>{let i=ed(this.options.rotate);return af(i[Math.floor((this.options.random?Math.random():xC(e))*i.length)])}}canRepeat(){return!1}exceedTime(){var t;return this.options.progressiveStep>0?this.progressiveIndex>=((null!=(t=this.currentStepIndex)?t:-1)+1)*this.options.progressiveStep:this.options.progressiveTime>0&&(new Date).getTime()-this.escapeTime>this.options.progressiveTime}progressiveRun(){var t;if(this.options.progressiveStep>0?this.currentStepIndex=(null!=(t=this.currentStepIndex)?t:-1)+1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.data&&this.progressiveIndex<this.data.length){this.progressiveResult=[];let t=this.progressiveIndex,e=0,i=this.options.maxSingleWordTryCount,r=Math.min(this.options.maxFailCount,this.originalData.length);for(;t<this.data.length&&this.failCount<r;){let n=this.layoutWord(t);if(e++,(n||e>i)&&(t++,e=0,this.failCount=n?0:this.failCount+1),this.progressiveIndex=t,this.exceedTime())break;t===this.data.length&&this.failCount<r&&this.options.repeatFill&&this.canRepeat()&&(this.data=[...this.data,...this.originalData.map(t=>Object.assign(Object.assign({},t),{isFill:!0}))],this.isTryRepeatFill=!0)}return this.progressiveResult}return this.result}initProgressive(){this.failCount=0,this.progressiveIndex=0,this.options.progressiveStep>0?this.currentStepIndex=-1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.progressiveResult=[]}output(){return this.result?this.outputCallback(this.result):null}progressiveOutput(){return this.progressiveResult?this.outputCallback(this.progressiveResult):null}unfinished(){return this.data&&this.data.length&&!er(this.progressiveIndex)&&this.progressiveIndex<this.data.length}release(){this.data=null,this.result=null,this.progressiveIndex=null,this.progressiveResult=null}}xB.defaultOptions={fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",fontStyle:"normal",minFontSize:12,drawOutOfBound:!1,shrink:!1,minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,rotateRatio:.1,random:!1,shape:"circle",progressiveTime:0,progressiveStep:0,repeatFill:!1,fillTextFontSize:12,maxFailCount:20};let xP={archimedean:function(t){let e=t[0]/t[1];return t=>[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]},rectangular:function(t){let e=4*t[0]/t[1],i=0,r=0;return t=>{let n=t<0?-1:1;switch(Math.sqrt(1+4*n*t)-n&3){case 0:i+=e;break;case 1:r+=4;break;case 2:i-=e;break;default:r-=4}return[i,r]}}};class xE extends xB{constructor(t){var e;super(ei({},xE.defaultOptions,t)),this.cw=64,this.ch=2048,this._size=[256,256],this._isBoardExpandCompleted=!1,this._placeStatus=0,this._tTemp=null,this._dtTemp=null,this._dy=0,this.cacheMap=new Map,this.options.minFontSize<=xE.defaultOptions.minFontSize&&(this.options.minFontSize=xE.defaultOptions.minFontSize),this.spiral=t6(this.options.spiral)?null!=(e=xP[this.options.spiral])?e:xP.archimedean:this.options.spiral,this.random=this.options.random?Math.random:()=>1,this.getTextPadding=xR(this.options.padding)}zoomRatio(){return this._originSize[0]/this._size[0]}dy(){return this._dy}layoutWord(t){let e=this.data[t];if(""===(""+e.text).trim())return!0;let{maxRadius:i,center:r}=xM(this.options.shape,this._size);if(e.x=r[0],e.y=r[1],function(t,e,i,r,n,s){let l,a,o,h,u;if(e.sprite)return;let d=t.context,c=t.ratio;d.setTransform(c,0,0,c,0,0),d.clearRect(0,0,(n<<5)/c,s/c);let p=0,g=0,f=0,m=i.length;for(--r;++r<m;){if(e=i[r],d.save(),d.font=e.fontStyle+" "+e.fontWeight+" "+~~((e.fontSize+1)/c)+"px "+e.fontFamily,l=d.measureText(e.text+"m").width*c,o=e.fontSize<<1,e.angle){let t=Math.sin(e.angle),i=Math.cos(e.angle),r=l*i,n=l*t,s=o*i,a=o*t;l=Math.max(Math.abs(r+a),Math.abs(r-a))+31>>5<<5,o=~~Math.max(Math.abs(n+s),Math.abs(n-s))}else l=l+31>>5<<5;if(o>f&&(f=o),p+l>=n<<5&&(p=0,g+=f,f=0),g+o>=s)break;d.translate((p+(l>>1))/c,(g+(o>>1))/c),e.angle&&d.rotate(e.angle),d.fillText(e.text,0,0),e.padding&&(d.lineWidth=2*e.padding,d.strokeText(e.text,0,0)),d.restore(),e.width=l,e.height=o,e.xoff=p,e.yoff=g,e.x1=l>>1,e.y1=o>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=l}let y=d.getImageData(0,0,(n<<5)/c,s/c).data,v=[];for(;--r>=0;){if(!(e=i[r]).hasText)continue;for(a=(l=e.width)>>5,o=e.y1-e.y0,h=0;h<o*a;h++)v[h]=0;if(null==(p=e.xoff))return;g=e.yoff;let t=0,s=-1;for(u=0;u<o;u++){for(h=0;h<l;h++){let e=a*u+(h>>5),i=y[(g+u)*(n<<5)+(p+h)<<2]?1<<31-h%32:0;v[e]|=i,t|=i}t?s=u:(e.y0++,o--,u--,g++)}e.y1=e.y0+s,e.sprite=v.slice(0,(e.y1-e.y0)*a)}}(this.contextAndRatio,e,this.data,t,this.cw,this.ch),this._placeStatus=0,e.hasText&&this.place(this._board,e,this._bounds,i))return this.result.push(e),this._bounds?function(t,e){let i=t[0],r=t[1];e.x+e.x0<i.x&&(i.x=e.x+e.x0),e.y+e.y0<i.y&&(i.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}(this._bounds,e):this._bounds=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=this._size[0]>>1,e.y-=this._size[1]>>1,this._tTemp=null,this._dtTemp=null,!0;if(this.updateBoardExpandStatus(e.fontSize),e.hasText&&this.shouldShrinkContinue()){if(1===this._placeStatus){let t=e.fontSize*this._originSize[0]/this.options.minFontSize,i=Math.max(e.width,e.height);if(i<=t)this.expandBoard(this._board,this._bounds,i/this._size[0]);else{if(!this.options.clip)return!0;this.expandBoard(this._board,this._bounds,t/this._size[0])}}else this._placeStatus,this.expandBoard(this._board,this._bounds);return this.updateBoardExpandStatus(e.fontSize),!1}return this._tTemp=null,this._dtTemp=null,!0}layout(t,e){this.initProgressive(),this.result=[],this._size=[e.width,e.height],this.clearCache(),this._originSize=[...this._size];let i=this.getContext(this.options.createCanvas({width:1,height:1}));this.contextAndRatio=i,this._board=Array((this._size[0]>>5)*this._size[1]).fill(0),this._bounds=null,t.length,this.result=[];let r=t.map((t,e)=>({text:this.getText(t),fontFamily:this.getTextFontFamily(t),fontStyle:this.getTextFontStyle(t),fontWeight:this.getTextFontWeight(t),angle:this.getTextRotate(t,e),fontSize:~~this.getTextFontSize(t),padding:this.getTextPadding(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t,x:0,y:0,width:0,height:0})).sort(function(t,e){return e.fontSize-t.fontSize});if(this.originalData=r,this.data=r,this.progressiveRun(),!this.options.clip&&this.options.enlarge&&this._bounds&&this.shrinkBoard(this._bounds),this._bounds&&["cardioid","triangle","triangle-upright"].includes(this.options.shape)){let t=(this._bounds[0].y+this._bounds[1].y)/2;this._dy=-(t-this._originSize[1]/2)}return this.result}formatTagItem(t){let e,i,r=this._size,n=this.zoomRatio(),s=this.dy(),l=r[0]>>1,a=r[1]>>1,o=t.length,h=[];for(let r=0;r<o;++r)e=t[r],(i={}).datum=e.datum,i.x=(e.x+l)*n,i.y=(e.y+a+s)*n,i.fontFamily=e.fontFamily,i.fontSize=e.fontSize*n,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.angle=e.angle,h.push(i);return h}output(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.result)):this.formatTagItem(this.result)}progressiveOutput(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.progressiveResult)):this.formatTagItem(this.progressiveResult)}updateBoardExpandStatus(t){this._isBoardExpandCompleted=t*(this._originSize[0]/this._size[0])<this.options.minFontSize}shouldShrinkContinue(){return!this.options.clip&&this.options.shrink&&!this._isBoardExpandCompleted}shrinkBoard(t){let e=t[0],i=t[1];if(i.x>=this._size[0]||i.y>=this._size[1])return;let r=Math.min(e.x,this._size[0]-i.x),n=Math.min(e.y,this._size[1]-i.y),s=2*Math.min(r/this._size[0],n/this._size[1]);this._size=this._size.map(t=>t*(1-s))}expandBoard(t,e,i){let r=this._size[0]*(i||1.1)-this._size[0]>>5,n=2*r>2?r:2;n%2!=0&&n++;let s=Math.ceil(this._size[1]*(n<<5)/this._size[0]);s%2!=0&&s++;let l=this._size[0],a=this._size[1],o=Array(n).fill(0),h=Array(s/2*(n+(l>>5))).fill(0);this.insertZerosToArray(t,a*(l>>5),h.length+n/2);for(let e=a-1;e>0;e--)this.insertZerosToArray(t,e*(l>>5),o.length);this.insertZerosToArray(t,0,h.length+n/2),this._size=[l+(n<<5),a+s],e&&(e[0].x+=(n<<5)/2,e[0].y+=s/2,e[1].x+=(n<<5)/2,e[1].y+=s/2)}insertZerosToArray(t,e,i){if(this.options.customInsertZerosToArray)return this.options.customInsertZerosToArray(t,e,i);let r=Math.floor(i/6e4);for(let i=0;i<r;i++)t.splice(e+6e4*i,0,...Array(6e4).fill(0));t.splice(e+6e4*r,0,...Array(i%6e4).fill(0))}getContext(t){t.width=1,t.height=1;let e=Math.sqrt(t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1).data.length>>2);t.width=(this.cw<<5)/e,t.height=this.ch/e;let i=t.getContext("2d",{willReadFrequently:!0});return i.fillStyle=i.strokeStyle="red",i.textAlign="center",{context:i,ratio:e,canvas:t}}place(t,e,i,r){let n=!1;if(this.shouldShrinkContinue()&&(e.width>this._size[0]||e.height>this._size[1]))return this._placeStatus=1,!1;let s=.5>this.random()?1:-1;if(!this.shouldShrinkContinue()&&this.isSizeLargerThanMax(e,s))return null;let l=e.x,a=e.y,o=Math.sqrt(this._size[0]*this._size[0]+this._size[1]*this._size[1]),h=this.spiral(this._size),u,d,c,p,g=-s;for(this._tTemp=null,this._dtTemp=null;u=h(g+=s);){let h=Math.sqrt((d=u[0])**2+(c=u[1])**2),y=Math.atan(c/d);d<0?y+=Math.PI:c<0&&(y=2*Math.PI+y);let v=this.shape(y);if(Math.min(Math.abs(d),Math.abs(c))>=o)break;if(h>=r)n&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=s);else{var f,m;if(e.x=l+~~(h*v*Math.cos(-y)),e.y=a+~~(h*v*Math.sin(-y)),p=e,this.options.clip)if(this.shouldShrinkContinue()){if(xL(p,this._size)){n&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=s);continue}}else{if(xI(p,this._size)){n&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=s);continue}xL(p,this._size)&&(p=function(t,e){let i=t.sprite,r=t.y1-t.y0,n=t.width>>5,s=0,l=[],a=Math.max(-(t.y0+t.y),0),o=Math.min(r+(e[1]-(t.y1+t.y)),r),h=Math.max(-(t.x0+t.x),0)>>5,u=Math.min(n+(e[0]-(t.x1+t.x)>>5)+1,n);for(let t=0;t<r;t++){for(let e=0;e<n;e++)t<a||o<=t||e<h||u<=e||l.push(i[s+e]);s+=n}let d=h<<5,c=n-u<<5,p=r-o;return Object.assign(Object.assign({},t),{width:t.width-d-c,height:t.height-a-p,x0:t.x0+d,x1:t.x1-c,y0:t.y0+a,y1:t.y1-p,x:t.x+d/2-c/2,sprite:l})}(p,this._size))}else if(xL(p,this._size)){n&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=s);continue}if(n=!0,(!i||(f=p,m=i,f.x+f.x1>m[0].x&&f.x+f.x0<m[1].x&&f.y+f.y1>m[0].y&&f.y+f.y0<m[1].y))&&(!i||!function(t,e,i){let r=i[0]>>5,n=t.sprite,s=t.width>>5,l=t.x-(s<<4),a=127&l,o=32-a,h=t.y1-t.y0,u,d=(t.y+t.y0)*r+(l>>5);for(let t=0;t<h;t++){u=0;for(let i=0;i<=s;i++)if((u<<o|(i<s?(u=n[t*s+i])>>>a:0))&e[d+i])return!0;d+=r}return!1}(p,t,this._size))){let i=p.sprite,r=p.width>>5,n=this._size[0]>>5,s=p.x-(r<<4),l=127&s,a=32-l,o=p.y1-p.y0,h,u=(p.y+p.y0)*n+(s>>5);for(let e=0;e<o;e++){h=0;for(let n=0;n<=r;n++)t[u+n]|=h<<a|(n<r?(h=i[e*r+n])>>>l:0);u+=n}return e.sprite=null,p.sprite=null,!0}}}return null!==this._tTemp&&(this._placeStatus=3),this.shouldShrinkContinue()||this.setCache(p,s),!1}clearCache(){this.cacheMap.clear()}setCache(t,e){let i=`${t.angle}-${e}`,r=t.x1-t.x0,n=t.y1-t.y0;if(!this.cacheMap.has(i))return void this.cacheMap.set(i,{width:r,height:n});let{width:s,height:l}=this.cacheMap.get(i);(r<s&&n<l||r<=s&&n<l)&&this.cacheMap.set(i,{width:r,height:n})}isSizeLargerThanMax(t,e){let i=`${t.angle}-${e}`;if(!this.cacheMap.has(i))return!1;let{width:r,height:n}=this.cacheMap.get(i),s=t.x1-t.x0,l=t.y1-t.y0;return s>=r&&l>=n}}xE.defaultOptions={enlarge:!1,minFontSize:2,maxSingleWordTryCount:2};let xI=(t,e)=>t.x+t.x0>e[0]||t.y+t.y0>e[0]||t.x+t.x1<0||t.y+t.y1<0,xL=(t,e)=>t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>e[0]||t.y+t.y1>e[1],xF=(t,e,i)=>{let{threshold:r,invert:n=!1}=null!=e?e:{};if(!t||"#fff"===t)return(t,e,i)=>{let s=t.width;if(0===t.data[e*s*4+4*i+3])return!n;let l=t.data[e*s*4+4*i+0],a=t.data[e*s*4+4*i+1],o=t.data[e*s*4+4*i+2];if(255===l&&255===a&&255===o)return!n;if(en(r)){let t=.3*l+.59*a+.11*o;return n?t<=r:t>=r}return!1};let s=i({width:1,height:1}).getContext("2d",{willReadFrequently:!0});s.fillStyle=t,s.fillRect(0,0,1,1);let l=s.getImageData(0,0,1,1).data;return(t,e,i)=>{let r=t.width;return[0,1,2,3].every(s=>n?t.data[4*(e*r+i)+s]!==l[s]:t.data[4*(e*r+i)+s]===l[s])}},xO=(t,e,i,r,n=!1,s)=>{let{backgroundColor:l="#fff"}=t,{fill:a="#000"}=t;n&&([l,a]=[a,l]);let o=r||s({width:e,height:i,dpr:1}),h=o.getContext("2d",{willReadFrequently:!0});if(r){let t=r.width,n=r.height;h.clearRect(0,0,t,n),r.style.width=`${e}px`,r.style.height=`${i}px`,r.width=e,r.height=i}return h.fillStyle=l,h.fillRect(0,0,o.width,o.height),"text"===t.type?xD(t,a,o.width,o.height,h):"geometric"===t.type&&xj(t,a,o.width,o.height,h),o},xD=(t,e,i,r,n)=>{let{fontFamily:s="sans-serif",fontWeight:l="normal",fontStyle:a="normal",fontVariant:o="normal",text:h,hollow:u}=t,d=12;n.font=`${a} ${o} ${l} ${d}px ${s}`,n.textAlign="center",n.textBaseline="middle",n.fillStyle=e;let c=n.measureText(h),p="normal"!==a?1.1:1,g=t8(c.actualBoundingBoxRight)&&t8(c.actualBoundingBoxLeft)?Math.ceil(p*(Math.abs(c.actualBoundingBoxRight)+Math.abs(c.actualBoundingBoxLeft))):0,f=Math.max(Math.ceil(c.width),g,d);if(u&&(n.globalCompositeOperation="xor"),f>i){let t=Math.min(i/f,r/d);n.fillText(h,i/2,r/2),n.scale(t,t)}else d=Math.min(d=Math.floor(d*i/f),r),n.font=`${a} ${o} ${l} ${d}px ${s}`,n.fillText(h,Math.floor(i/2),Math.floor(r/2))},xH=(t,e,i=0,r)=>{let n=2*Math.PI/r;return Array(r).fill(0).map((r,s)=>ay(t,e,i+s*n))},xz=(t,e,i=0,r)=>{let n=2*Math.PI/r,s=xk("cardioid");return Array(r).fill(0).map((r,l)=>{let a=i+l*n;return ay(t,e*s(a),a)})},xW=(t,e)=>{t.beginPath(),e.forEach((e,i)=>{0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)}),t.closePath(),t.fill()},xN=(t,e)=>{let i;t.beginPath(),e.forEach((e,r)=>{0===r?t.moveTo(e.x,e.y):t.bezierCurveTo(e.x,e.y,i.x,i.y,e.x,e.y),i=e}),t.closePath(),t.fill()},xj=(t,e,i,r,n)=>{let{hollow:s}=t,{center:l,maxRadius:a}=xM(t.shape,[i,r]);n.fillStyle=e,s&&(n.globalCompositeOperation="xor");let o=l[0],h=l[1];if("cardioid"===t.shape)xN(n,xz({x:o,y:h},a,0,100));else if("circle"===t.shape)n.beginPath(),n.arc(o,h,a,0,2*Math.PI,!0),n.fill();else if("diamond"===t.shape)xW(n,xH({x:o,y:h},a,-Math.PI/2,4));else if("square"===t.shape)xW(n,xH({x:o,y:h},a,-Math.PI/4,4));else if("pentagon"===t.shape)xW(n,xH({x:o,y:h},a,Math.PI/2,5));else if("triangle"===t.shape||"triangleUpright"===t.shape)xW(n,xH({x:o,y:h},a,-Math.PI/2,3));else if("triangleForward"===t.shape)xW(n,xH({x:o,y:h},a,0,3));else if("star"===t.shape){let t=xH({x:o,y:h},a,-Math.PI/2,5),e=xH({x:o,y:h},a/(2*Math.cos(Math.PI/5)),-Math.PI/2+Math.PI/5,5),i=[];for(let r=0;r<5;r++)i.push(t[r]),i.push(e[r]);xW(n,i)}else n.fillRect(0,0,i,r)};class xG extends xB{constructor(t){super(ei({},xG.defaultOptions,t)),this.fillGridAt=(t,e)=>{t>=this.ngx||e>=this.ngy||t<0||e<0||(this.grid[t][e]=!1)},this.updateGrid=(t,e,i,r,n)=>{let s=n.occupied,l=s.length;for(;l--;){let i=t+s[l][0],r=e+s[l][1];i>=this.ngx||r>=this.ngy||i<0||r<0||this.fillGridAt(i,r)}},this.gridSize=Math.max(Math.floor(this.options.gridSize),4)}getPointsAtRadius(t){if(this.pointsAtRadius[t])return this.pointsAtRadius[t];let e=8*t,i=e,r=[];for(0===t&&r.push([this.center[0],this.center[1],0]);i--;){let n=this.shape(i/e*2*Math.PI);r.push([this.center[0]+t*n*Math.cos(-i/e*2*Math.PI),this.center[1]+t*n*Math.sin(-i/e*2*Math.PI)*this.options.ellipticity,i/e*2*Math.PI])}return this.pointsAtRadius[t]=r,r}getTextInfo(t,e=1,i){var r;let n=this.options.clip?1:e,s=Math.max(Math.floor((this.isTryRepeatFill?this.options.fillTextFontSize:this.getTextFontSize(t))*n),this.options.minFontSize),l=this.getText(t)+"";if(this.options.clip&&(l=l.slice(0,Math.ceil(l.length*e))),!l)return null;let a=this.getTextFontWeight(t),o=this.getTextFontStyle(t),h=this.getTextRotate&&null!=(r=this.getTextRotate(t,i))?r:0,u=this.getTextFontFamily(t),d=this.options.createCanvas({width:1,height:1}),c=d.getContext("2d",{willReadFrequently:!0});c.font=o+" "+a+" "+s.toString(10)+"px "+u;let p=c.measureText(l).width,g=Math.max(s,c.measureText("m").width,c.measureText("Ｗ").width),f=p+2*g,m=3*g,y=Math.ceil(f/this.gridSize),v=Math.ceil(m/this.gridSize);f=y*this.gridSize;let b=-p/2,_=-(.4*g),x=Math.ceil((f*Math.abs(Math.sin(h))+(m=v*this.gridSize)*Math.abs(Math.cos(h)))/this.gridSize),C=Math.ceil((f*Math.abs(Math.cos(h))+m*Math.abs(Math.sin(h)))/this.gridSize),w=C*this.gridSize,S=x*this.gridSize;d.setAttribute("width",""+w),d.setAttribute("height",""+S),c.scale(1,1),c.translate(w/2,S/2),c.rotate(-h),c.font=o+" "+a+" "+s.toString(10)+"px "+u,c.fillStyle="#000",c.textBaseline="middle",c.fillText(l,b,_);let A=c.getImageData(0,0,w,S).data;if(this.exceedTime())return null;let M=[],k,T=C,R=[x/2,C/2,x/2,C/2],B=(t,e,i)=>{let r=this.gridSize;for(;r--;){let n=this.gridSize;for(;n--;)if(A[4*((e*this.gridSize+r)*w+(t*this.gridSize+n))+3])return i.push([t,e]),t<R[3]&&(R[3]=t),t>R[1]&&(R[1]=t),e<R[0]&&(R[0]=e),void(e>R[2]&&(R[2]=e))}};for(;T--;)for(k=x;k--;)B(T,k,M);return{datum:t,occupied:M,bounds:R,gw:C,gh:x,fillTextOffsetX:b,fillTextOffsetY:_,fillTextWidth:p,fillTextHeight:g,fontSize:s,fontStyle:o,fontWeight:a,fontFamily:u,angle:h,text:l}}calculateEmptyRate(){let t=this.ngx*this.ngy,e=0;for(let t=0;t<this.ngx;t++)for(let i=0;i<this.ngy;i++)this.grid[t][i]&&e++;return e/t}canFitText(t,e,i,r,n){let s=n.length;for(;s--;){let i=t+n[s][0],r=e+n[s][1];if(i>=this.ngx||r>=this.ngy||i<0||r<0){if(!this.options.drawOutOfBound)return!1}else if(!this.grid[i][r])return!1}return!0}layoutWord(t,e=1){let i=this.data[t],r=this.getTextInfo(i,e,t);if(!r||this.exceedTime())return!1;if(!this.options.drawOutOfBound&&(!this.options.shrink||r.fontSize<=this.options.minFontSize)&&!this.options.clip){let t=r.bounds;if(t[1]-t[3]+1>this.ngx||t[2]-t[0]+1>this.ngy)return!1}let n=this.maxRadius+1,s=t=>{let e=Math.floor(t[0]-r.gw/2),i=Math.floor(t[1]-r.gh/2),s=r.gw,l=r.gh;return!!this.canFitText(e,i,s,l,r.occupied)&&(r.distance=this.maxRadius-n,r.theta=t[2],this.outputText(e,i,r),this.updateGrid(e,i,s,l,r),!0)};for(;n--;){let t=this.getPointsAtRadius(this.maxRadius-n);if(this.options.random&&ef(t=[].concat(t)),t.some(s))return!0}return(this.options.clip||!!(this.options.shrink&&r.fontSize>this.options.minFontSize))&&this.layoutWord(t,.75*e)}outputText(t,e,i){let r=this.getTextColor(i),n={text:i.text,datum:i.datum,color:r,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontFamily:i.fontFamily,angle:i.angle,width:i.fillTextWidth,height:i.fillTextHeight,x:(t+i.gw/2)*this.gridSize,y:(e+i.gh/2)*this.gridSize+i.fillTextOffsetY+.5*i.fontSize,fontSize:i.fontSize};this.result.push(n),this.progressiveResult&&this.progressiveResult.push(n)}initGrid(t){this.grid=[];let e=this.options.shape;if(e_(e)){let i=xO(e,t.width,t.height,void 0,!1,this.options.createCanvas),r=i.getContext("2d").getImageData(0,0,this.ngx*this.gridSize,this.ngy*this.gridSize);this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(i);let n=xF(e.backgroundColor,void 0,this.options.createCanvas),s=(t,e)=>{let i=this.gridSize;for(;i--;){let s=this.gridSize;for(;s--;)if(!n(r,e*this.gridSize+i,t*this.gridSize+s))return void(this.grid[t][e]=!0)}this.grid[t][e]=!1},l=this.ngx;for(;l--;){this.grid[l]=[];let t=this.ngy;for(;t--;)s(l,t),!1!==this.grid[l][t]&&(this.grid[l][t]=!0)}r=n=void 0}else{let t=this.ngx;for(;t--;){this.grid[t]=[];let e=this.ngy;for(;e--;)this.grid[t][e]=!0}}}canRepeat(){return this.calculateEmptyRate()>.001}layout(t,e){this.initProgressive(),this.drawnCount=0,this.isTryRepeatFill=!1,this.originalData=t,this.data=t,this.pointsAtRadius=[],this.ngx=Math.floor(e.width/this.gridSize),this.ngy=Math.floor(e.height/this.gridSize);let{center:i,maxRadius:r}=xM(this.options.shape,[e.width,e.height]);return this.center=e.origin?[e.origin[0]/this.gridSize,e.origin[1]/this.gridSize]:[i[0]/this.gridSize,i[1]/this.gridSize],this.maxRadius=Math.floor(r/this.gridSize),this.initGrid(e),this.result=[],this.progressiveRun()}}xG.defaultOptions={gridSize:8,ellipticity:1,maxSingleWordTryCount:1};class xV extends xB{constructor(t){super(ei({},xV.defaultOptions,t)),this.random=this.options.random?Math.random:()=>0,this.aspectRatio=1}fit(t){for(let r=0,n=this.result.length;r<n;r++){var e,i;if(e=t,i=this.result[r],!(e.left+e.width<i.left||e.top+e.height<i.top||e.left>i.left+i.width||e.top>i.top+i.height))return!1}return!0}getTextInfo(t,e){let i={datum:t,fontSize:this.getTextFontSize(t),fontWeight:this.getTextFontWeight(t),fontStyle:this.getTextFontStyle(t),fontFamily:this.getTextFontFamily(t),angle:this.getTextRotate(t,e),text:this.getText(t)+"",x:this.center[0],y:this.center[1]},r=this.options.getTextBounds(i);return i.width=r.width(),i.height=r.height(),i.top=this.center[1]-i.height+.21*i.height,i.left=this.center[0]-i.width/2,i}layoutWord(t){let e=this.getTextInfo(this.data[t],t),i=2*Math.PI,r=0,n=e.left,s=e.top,l=e.width,a=e.height,o=1,h=this.fit(e);for(;!h&&r<this.maxRadius;)r+=.5,o=this.shape(r/this.maxRadius*2*Math.PI),i+=.5*(this.options.random?this.random()>.5?1:-1:t%2==0?1:-1),n=this.center[0]-l/2+r*o*Math.cos(i)*this.aspectRatio,s=this.center[1]-a/2+r*o*Math.sin(i),e.left=n,e.top=s,e.x=n+l/2,e.y=s+a/2,h=this.fit(e);return!!h&&!!(this.options.clip||e.left>=0&&e.left+e.width<=this.width&&e.top>=0&&e.top+e.height<=this.height)&&(this.result.push(e),!0)}layout(t,e){if(!(null==t?void 0:t.length))return[];this.initProgressive(),this.result=[],this.maxRadius=Math.sqrt(e.width*e.width+e.height*e.height)/2,this.center=[e.width/2,e.height/2],this.width=e.width,this.height=e.height,this.data=t.sort((t,e)=>this.getTextFontSize(e)-this.getTextFontSize(t));let i=0;for(;i<t.length&&(this.layoutWord(i),i++,this.progressiveIndex=i,!this.exceedTime()););return this.result}}xV.defaultOptions={enlarge:!1};let xZ={x:"x",y:"y",z:"z",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle"},xU=(t,e)=>{var i,r,n,s,l,a;if(t.size&&(t.size[0]<=0||t.size[1]<=0))return tU.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];let o=(null!=(i=t.size)?i:[500,500]).slice();o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]);let h=t.fontFamily?xK(t.fontFamily):"sans-serif",u=t.fontStyle?xK(t.fontStyle):"normal",d=t.fontWeight?xK(t.fontWeight):"normal",c=t.rotate?xK(t.rotate):0,p=xK(t.text),g=null!=(r=t.spiral)?r:"archimedean",f=t.padding?xK(t.padding):1,m=null!=(n=t.shape)?n:"square",y=null!=(s=t.shrink)&&s,v=null!=(l=t.enlarge)&&l,b=null!=(a=t.clip)&&a,_=t.minFontSize,x=t.randomVisible,C=t.as?Object.assign(Object.assign({},xZ),t.as):xZ,w=t.depth_3d,S=t.postProjection,A=t.fontSize?xK(t.fontSize):14,M=t.fontSizeRange;if(M&&!tG(A)){let t=A,i=xY(xX(t,e),M);A=e=>i(t(e))}let k=xE;"fast"===t.layoutType?k=xV:"grid"===t.layoutType&&(k=xG);let T=new k(Object.assign(Object.assign({},t),{text:p,padding:f,spiral:g,shape:m,rotate:c,fontFamily:h,fontStyle:u,fontWeight:d,fontSize:A,shrink:y,clip:b,enlarge:v,minFontSize:_,random:x,outputCallback:e=>{let i,r,n=[];for(let s=0,l=e.length;s<l;s++)(i=(r=e[s]).datum)[C.x]=r.x,i[C.y]=r.y,i[C.fontFamily]=r.fontFamily,i[C.fontSize]=r.fontSize,i[C.fontStyle]=r.fontStyle,i[C.fontWeight]=r.fontWeight,i[C.angle]=r.angle,"StereographicProjection"===S&&function(t,e,i,r,n){let s=Math.max(t[0],t[1])/2,l=function(t,e,i,r,n){let{x:s,y:l}=n,a=s/t*Math.PI*2,o=Math.PI-l/e*Math.PI;return{x:i*Math.sin(o+=(o<Math.PI/2?1:-1)*Math.pow(Math.min(o-Math.PI/2,1),2)/5)*Math.cos(a)+r.x,y:i*Math.cos(o)+r.y,z:i*Math.sin(o)*Math.sin(a)+r.z}}(t[0],t[1],s,{x:s,y:s,z:null!=n?n:s},e);i[r.x]=l.x,i[r.y]=l.y,i[r.z]=l.z}(o,r,i,C,w),t.dataIndexKey&&(i[t.dataIndexKey]=`${s}`),n.push(i);return n}}));return T.layout(e,{width:o[0],height:o[1]}),t.progressiveStep>0||t.progressiveTime>0?{progressive:T}:T.output()},xK=t=>t6(t)||tG(t)||tQ(t)||tq(t)?t:e=>e[t.field],x$=t=>t<0?-Math.sqrt(-t):Math.sqrt(t),xY=(t,e,i)=>{if(t[0]===t[1])return t=>e[0];let r=x$(t[0]),n=x$(t[1]),s=Math.min(r,n),l=Math.max(r,n);return t=>(x$(t)-s)/(l-s)*(e[1]-e[0])+e[0]},xX=(t,e)=>{let i,r=1/0,n=-1/0,s=e.length;for(let l=0;l<s;++l)(i=l2(t(e[l])))<r&&(r=i),i>n&&(n=i);return 1===e.length&&r===n&&(r-=1e4),[r,n]};(P=X||(X={})).BEFORE_WORDCLOUD_SHAPE_LAYOUT="beforeWordcloudShapeLayout",P.AFTER_WORDCLOUD_SHAPE_LAYOUT="afterWordcloudShapeLayout",P.AFTER_WORDCLOUD_SHAPE_DRAW="afterWordcloudShapeDraw";let xq=(t,e)=>{if(1===e.length&&"#537EF5"===e[0])return!0;if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},xJ=t=>/^[\u4e00-\u9fa5]+$/.test(t),xQ=(t,e)=>{if(er(t))return 0;let i=0;for(let e of t)xJ(e)?i+=1:i+=.53;return i};function x0(t,e,i){let{stepFactor:r,importantWordCount:n,globalShinkLimit:s}=e,{size:l,segmentation:{regions:a},tempCanvas:o,boardSize:h,shapeCenter:u,shapeMaxR:d,shapeRatio:c}=i,p=o.getContext("2d",{willReadFrequently:!0}),g=x4(i),f=g.slice(0),m=e.fontSizeShrinkFactor,y=null,v=1,b=1,_=0;t.length>n&&(_=t.sort((t,e)=>e.weight-t.weight)[n].weight);for(let e=0;e<a.length;e++){let{words:i,center:n,maxR:u,ratio:d}=a[e],c=!1;for(let e=0;e<i.length;e++){x5(o,p,t,e);let a=i[e];if(a.x=n[0],a.y=n[1],!a.skip&&a.hasText&&a.sprite&&x1(f,a,u,d,l,h,r))a.hasPlaced=!0;else{if(!a.skip&&a.weight>_&&b>s){let e=a.datum[Symbol.for("vGrammar_id")];e!==y&&(y=e,v=b),b*=m,t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*m}),f=g.slice(0),c=!0;break}if(!a.skip&&a.datum[Symbol.for("vGrammar_id")]===y){t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/b}),a.skip=!0,b=v,y=null,f=g.slice(0),c=!0;break}}}c&&(e=-1)}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];x5(o,p,i,t),e.x=u[0],e.y=u[1],e.hasText&&x1(f,e,d,c,l,h,r)&&(e.hasPlaced=!0)}}e.board=f}function x1(t,e,i,r,n,s,l){var a;let o=e.x,h=e.y,u=(a=r,function(t){return[a*(t*=.1)*Math.cos(t),t*Math.sin(t)]}),d=+l,c,p,g,f=-d;for(;c=u(f+=d);){let{wordSize:r,bounds:{dTop:l,dBottom:a,dLeft:u,dRight:d}}=e;if(Math.min(Math.abs(p=c[0]),Math.abs(g=c[1]))>=i)break;if(e.x=~~(o+p),e.y=~~(h+g),!(e.x-u<0||e.x+d>n[0]||e.y-l<0||e.y+a>n[1]||x3(e,t,s)))return x2(e,t,s),!0}return!1}function x2(t,e,i){let{wordSize:r}=t,n=t.sprite,s=r[0]>>5,l=i[0]>>5,a=t.x-(s<<4),o=a%32,h=32-o,u=r[1],d,c=(t.y-(r[1]>>1))*l+(a>>5);if(0===o)for(let t=0;t<u;t++){for(let i=0;i<s;i++)e[c+i]|=n[t*s+i];c+=l}else for(let t=0;t<u;t++){d=0;for(let i=0;i<=s;i++)e[c+i]|=d<<h|(i<s?(d=n[t*s+i])>>>o:0);c+=l}}function x3(t,e,i){let{sprite:r,wordSize:n}=t,s=i[0]>>5,l=n[0]>>5,a=t.x-(l<<4),o=a%32,h=32-o,u=n[1],d,c=(t.y-(n[1]>>1))*s+(a>>5);if(0===o)for(let t=0;t<u;t++){for(let i=0;i<l;i++)if(e[c+i]&r[t*l+i])return!0;c+=s}else for(let t=0;t<u;t++){d=0;for(let i=0;i<=l;i++)if((d<<h|(i<l?(d=r[t*l+i])>>>o:0))&e[c+i])return!0;c+=s}return!1}function x5(t,e,i,r){let n,s;if(i[r].sprite||0===i[r].fontSize)return;let l=Math.PI/180,a=i.length;t.width=2048,t.height=2048,e.clearRect(0,0,2048,2048),e.textAlign="center";let o,h,u=0,d=0,c=0,p=0,g=r;for(--r;++r<a;){let t=i[r],n=Math.max(t.fontSize,2);if(e.save(),e.font=t.fontStyle+" "+t.fontWeight+" "+n+"px "+t.fontFamily,o=e.measureText(t.text+"m").width+2*t.padding,h=2*n+2*t.padding,0!==t.rotate){let e=Math.sin(t.rotate*l),i=Math.cos(t.rotate*l),r=o*i,n=o*e,s=h*i,a=h*e;o=Math.max(Math.abs(r+a),Math.abs(r-a)),h=~~Math.max(Math.abs(n+s),Math.abs(n-s))}if(o=o+31>>5<<5,(h=Math.ceil(h))>c&&(c=h),u+o>=2048&&(u=0,d+=c,c=h),d+h>=2048){if(0===d){t.hasText=!1;continue}break}d+h>=p&&(p=d+h),e.translate(u+(o>>1),d+(h>>1)),0!==t.rotate&&e.rotate(t.rotate*l),e.fillText(t.text,0,0),t.padding&&(e.lineWidth=2*t.padding,e.strokeText(t.text,0,0)),e.restore(),t.LT=[u,d],t.wordSize=[o,h],t.hasText=!0,u+=o}if(0===p)return;let f=e.getImageData(0,0,2048,p).data;for(;--r>=g;){let t=i[r];if(!t.hasText){t.bounds={dTop:1/0,dBottom:-1/0,dLeft:1/0,dRight:-1/0};break}let{LT:e=[0,0],wordSize:l}=t;[u,d]=e;let a=l[0]>>5,o=Array(a*l[1]).fill(0),[h,c,p,g]=[1/0,-1/0,1/0,-1/0];for(s=0;s<l[1];s++){let t;for(n=0;n<l[0];n++)if(f[4*((d+s)*2048+(u+n))+3]>0){let e=1<<31-n%32;o[a*s+(n>>5)]|=e,n<p&&(p=n),n>g&&(g=n),t|=e}t&&(s<h&&(h=s),s>c&&(c=s))}t.bounds={dTop:(l[1]>>1)-h,dBottom:c-(l[1]>>1),dLeft:(l[0]>>1)-p,dRight:g-(l[0]>>1)},t.sprite=o,delete t.LT}}function x4(t){let{segmentation:{labels:e},boardSize:i,size:r}=t,n=i[0]>>5,s=Array(n*r[1]).fill(0);for(let t=0;t<r[1];t++)for(let i=0;i<r[0];i++)if(0===e[t*r[0]+i]){let e=1<<31-i%32;s[n*t+(i>>5)]|=e}if(i[0]>r[0]){let t=(1<<i[0]-r[0])-1;for(let e=0;e<r[1];e++)s[n*e+n-1]|=t}return s}let x6=t=>new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(t),x8=t=>new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(t),x9=t=>e=>iW(e,t),x7=(t,e={})=>{if(tQ(t))return t;let i=[t];return(e&&e.get||x9)(i)},Ct=(t,e={})=>{if(tq(t)){let i=t.map(t=>x7(t,e));return t=>i.map(e=>e(t))}return x7(t,e)},Ce=t=>t?"string"==typeof t||"number"==typeof t?()=>t:tQ(t)?t:e=>e[t.field]:null;class Ci extends l4{constructor(){super(lg,lf),this.type=V.Sqrt}clone(){return(new Ci).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}}let Cr={x:"x",y:"y",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle",opacity:"opacity",visible:"visible",isFillingWord:"isFillingWord",color:"color"};class Cn{constructor(t){this.progressiveResult=[],this.options=t}layout(t){this.data=t;let e=this.options,i={shapeUrl:e.shape,size:e.size,ratio:e.ratio||.8,tempCanvas:void 0,boardSize:[0,0],random:!1,randomGenerator:void 0},r=this.options.createCanvas({width:e.size[0],height:e.size[1]}),n=r.getContext("2d",{willReadFrequently:!0});if(n.textAlign="center",n.textBaseline="middle",i.tempCanvas=r,i.boardSize=[e.size[0]+31>>5<<5,e.size[1]],i.random?i.randomGenerator=Math.random:i.randomGenerator=xw(),this.segmentationInput=i,t6(i.shapeUrl)){var s,l;i.isEmptyPixel=xF(void 0,void 0,this.options.createCanvas);let t=(s=i.shapeUrl,l=this.options.createImage,s&&(x6(s)||x8(s)||s.startsWith("<svg"))?new Promise((t,e)=>{var i;let r=l({image:s}),n=null==(i=r.resources)?void 0:i.get(s);n&&"success"===n.state&&n.data?t(n.data):(r.successCallback=()=>{var i;if(r){let n=null==(i=r.resources)?void 0:i.get(s);n&&"success"===n.state&&n.data?t(n.data):e(Error("image load failed: "+s))}else e(Error("image load failed: "+s))},r.failCallback=()=>{e(Error("image load failed: "+s))})}):null);t?(this.isImageFinished=!1,this.isLayoutFinished=!1,t.then(t=>{this.isImageFinished=!0;let r=this.options.createCanvas({width:e.size[0],height:e.size[1],dpr:1});i.maskCanvas=r;let n=r.getContext("2d");e.removeWhiteBorder&&function(t,e,i){e.width=t.width,e.height=t.height;let r=e.getContext("2d",{willReadFrequently:!0});r.clearRect(0,0,e.width,e.height),r.drawImage(t,0,0);let n=e.width,s=r.getImageData(0,0,e.width,e.height),l=0,a=s.height,o=0,h=s.width,u=(t,e)=>{for(let r=0;r<t;++r)if(!i(s,e,r))return!1;return!0},d=(t,e,r)=>{for(let n=e;n<r;++n)if(!i(s,n,t))return!1;return!0};for(;l<a&&u(n,l);)++l;for(;a-1>l&&u(n,a-1);)--a;for(;o<h&&d(o,l,a);)++o;for(;h-1>o&&d(h-1,l,a);)--h;let c=r.getImageData(o,l,h-o,a-l);e.width=c.width,e.height=c.height,r.clearRect(0,0,e.width,e.height),r.putImageData(c,0,0)}(t,r,i.isEmptyPixel);let s=function(t,e){let i=t.width,r=t.height,n=e[0]/i;r*n>e[1]&&(n=e[1]/r);let s=Math.floor(n*i),l=Math.floor(n*r);return{x:(e[0]-s)/2,y:(e[1]-l)/2,width:s,height:l,scale:n}}(t,e.size);n.clearRect(0,0,e.size[0],e.size[1]),n.drawImage(t,s.x,s.y,s.width,s.height),this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(i.maskCanvas)}).catch(t=>{this.isImageFinished=!0})):(this.isImageFinished=!0,this.isLayoutFinished=!0)}else if(i.shapeUrl&&("text"===i.shapeUrl.type||"geometric"===i.shapeUrl.type)){i.isEmptyPixel=xF(i.shapeUrl.backgroundColor,void 0,this.options.createCanvas);let t=xO(i.shapeUrl,e.size[0],e.size[1],void 0,!1,this.options.createCanvas);i.maskCanvas=t,this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(t),this.doLayout(),this.isImageFinished=!0,this.isLayoutFinished=!0}}canAnimate(){return!0}unfinished(){return!this.isLayoutFinished}output(){return this.progressiveResult}progressiveRun(){this.isImageFinished&&!this.isLayoutFinished&&(this.segmentationInput.maskCanvas&&this.doLayout(),this.isLayoutFinished=!0)}progressiveOutput(){return this.progressiveResult}doLayout(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_;let x,C,w=this.segmentationInput,S=function(t){let{size:e,maskCanvas:i}=t,r=i.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,i.width,i.height),n=Array(e[0]*e[1]).fill(0),s=1,l=[[0,1],[1,0],[-1,0],[0,-1]],a=[];for(let i=0;i<e[1];i++)for(let o=0;o<e[0];o++)if(0===n[i*e[0]+o]&&!t.isEmptyPixel(r,i,o)){n[i*e[0]+o]=s,a.push([i,o]);for(let i=0;i<a.length;i++)for(let o=0;o<4;o++){let h=a[i][0]+l[o][0],u=a[i][1]+l[o][1];h=h<0?0:h>=e[1]?e[1]-1:h,u=u<0?0:u>=e[0]?e[0]-1:u,0!==n[h*e[0]+u]||t.isEmptyPixel(r,h,u)||(n[h*e[0]+u]=s,a.push([h,u]))}s++,a=[]}let o={},h={},u={},d={},c={},p={},g={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0,width:0,height:0},f=[];for(let t=0;t<e[1];t++)for(let i=0;i<e[0];i++){let r=n[t*e[0]+i];0!==r&&(function(t,i){let r=[[0,1],[1,0],[-1,0],[0,-1]];if(0===t||0===i||t===e[1]-1||i===e[0]-1)return!0;for(let s=0;s<4;s++){let l=t+r[s][0],a=i+r[s][1];if(l=l<0?0:l>=e[1]?e[1]-1:l,a=a<0?0:a>=e[0]?e[0]-1:a,0===n[l*e[0]+a])return!0}return!1}(t,i)&&(f.push([t,i]),o[r]=o[r]||[],o[r].push([i,t]),d[r]||(d[r]=[1/0,-1/0,1/0,-1/0]),t<d[r][0]&&(d[r][0]=t),t>d[r][1]&&(d[r][1]=t),i<d[r][2]&&(d[r][2]=i),i>d[r][3]&&(d[r][3]=i),i<g.x1&&(g.x1=i),i>g.x2&&(g.x2=i),t<g.y1&&(g.y1=t),t>g.y2&&(g.y2=t)),h[r]=(h[r]||0)+1)}let m=[];for(let t in o){let e=o[t],i=~~(e.reduce((t,e)=>t+e[0],0)/e.length),r=~~(e.reduce((t,e)=>t+e[1],0)/e.length);u[t]=[i,r],m.push(...e);let[n,s,l,a]=d[t];c[t]=~~Math.max(Math.sqrt((i-l)**2+(r-n)**2),Math.sqrt((i-a)**2+(r-s)**2),Math.sqrt((i-l)**2+(r-s)**2),Math.sqrt((i-a)**2+(r-n)**2)),p[t]=(a-l)/(s-n)}let y=Object.keys(u).map(t=>({label:t-1,boundary:o[t],area:h[t],center:u[t],maxPoint:d[t],maxR:c[t],ratio:p[t]}));g.width=g.x2-g.x1+1,g.height=g.y2-g.y1+1;let v=~~(m.reduce((t,e)=>t+e[0],0)/m.length),b=~~(m.reduce((t,e)=>t+e[1],0)/m.length),_=~~Math.max(Math.sqrt((v-g.x1)**2+(b-g.y1)**2),Math.sqrt((v-g.x2)**2+(b-g.y2)**2),Math.sqrt((v-g.x1)**2+(b-g.y2)**2),Math.sqrt((v-g.x2)**2+(b-g.y1)**2)),x=g.width/g.height,C=Object.keys(h).reduce((t,e)=>t+h[e],0),w={regions:y,labels:n,labelNumber:s-1};if(t.blur){let i=t.blur,r=function(t,e,i,r){let n=Math.ceil(r/2),s=function(t,e){let i=Array(2*t+1).fill(0),r=0;for(let n=-t;n<=t;n++){let s=Math.exp(-n*n/(2*e*e));i[n+t]=s,r+=s}for(let t=0;t<i.length;t++)i[t]/=r;return i}(n,r/3),l=Array(t.length).fill(0),a=Array(t.length).fill(0);for(let r=0;r<i;r++)for(let i=0;i<e;i++){let a=0;for(let l=-n;l<=n;l++)a+=t[r*e+Math.min(Math.max(i+l,0),e-1)]*s[l+n];l[r*e+i]=a}for(let t=0;t<e;t++)for(let r=0;r<i;r++){let o=0;for(let a=-n;a<=n;a++)o+=l[Math.min(Math.max(r+a,0),i-1)*e+t]*s[a+n];a[r*e+t]=Math.max(0,Math.min(1,o))}return a}(n,e[0],e[1],i);(function(t,e,i,r,n=1){let s=Array(t.length).fill(0);for(let[t,l]of e)if(s[t*i+l]=1,n>1){for(let e=1-n;e<=n-1;e++)for(let a=1-n;a<=n-1;a++)if(Math.sqrt(e*e+a*a)<n){let n=t+e,o=l+a;n>=0&&n<r&&o>=0&&o<i&&(s[n*i+o]=1)}}return s})(n,f,e[0],e[1],Math.ceil(i/2)).forEach((t,e)=>{1===t&&(n[e]=r[e])})}return Object.assign(t,{segmentation:w,shapeBounds:g,shapeMaxR:_,shapeRatio:x,shapeCenter:[v,b],shapeArea:C})}(w);if(!S.segmentation.regions.length)return;let A=this.options,M=this.data,k=A.colorMode||"ordinal",T={getText:Ce(A.text),getFontSize:Ce(A.fontSize),fontSizeRange:A.fontSizeRange,colorMode:k,getColor:A.colorField?Ce(A.colorField):Ce(A.text),getFillingColor:Ce(A.fillingColorField),colorList:A.colorList||("ordinal"===k?["#2E62F1"]:["#537EF5","#2E62F1","#2358D8","#184FBF","#0C45A6","#013B8E"]),getColorHex:Ce(A.colorHexField),getFontFamily:Ce(A.fontFamily||"sans-serif"),rotateList:A.rotateList||[0],getPadding:Ce(A.padding||1),getFontStyle:Ce(A.fontStyle||"normal"),getFontWeight:Ce(A.fontWeight||"normal"),getFontOpacity:A.fontOpacity?Ce(A.fontOpacity):()=>1};Cl(M,T,S);let R={size:A.size,ratio:A.ratio||.8,shapeUrl:A.shape,random:void 0===A.random||A.random,textLayoutTimes:null!=(t=A.textLayoutTimes)?t:3,removeWhiteBorder:A.removeWhiteBorder,layoutMode:null!=(e=A.layoutMode)?e:"default",fontSizeShrinkFactor:null!=(i=A.fontSizeShrinkFactor)?i:.8,stepFactor:null!=(r=A.stepFactor)?r:1,importantWordCount:null!=(n=A.importantWordCount)?n:10,globalShinkLimit:A.globalShinkLimit||.2,fontSizeEnlargeFactor:null!=(s=A.fontSizeEnlargeFactor)?s:1.5,fillingRatio:null!=(l=A.fillingRatio)?l:.7,fillingTimes:null!=(a=A.fillingTimes)?a:4,fillingXStep:A.fillingXRatioStep?Math.max(Math.floor(A.size[0]*A.fillingXRatioStep),1):null!=(o=A.fillingXStep)?o:4,fillingYStep:A.fillingYRatioStep?Math.max(Math.floor(A.size[1]*A.fillingYRatioStep),1):null!=(h=A.fillingYStep)?h:4,fillingInitialFontSize:A.fillingInitialFontSize,fillingDeltaFontSize:A.fillingDeltaFontSize,fillingInitialOpacity:null!=(u=A.fillingInitialOpacity)?u:.8,fillingDeltaOpacity:null!=(d=A.fillingDeltaOpacity)?d:.05,getFillingFontFamily:Ce(A.fillingFontFamily||"sans-serif"),getFillingFontStyle:Ce(A.fillingFontStyle||"normal"),getFillingFontWeight:Ce(A.fillingFontWeight||"normal"),getFillingPadding:Ce(null!=(c=A.fillingPadding)?c:.4),fillingRotateList:null!=(p=A.fillingRotateList)?p:[0,90],fillingDeltaFontSizeFactor:null!=(g=A.fillingDeltaFontSizeFactor)?g:.2,fillingColorList:A.fillingColorList||["#537EF5"],sameColorList:!1,minInitFontSize:null!=(f=A.minInitFontSize)?f:10,minFontSize:null!=(m=A.minFontSize)?m:4,minFillFontSize:null!=(y=A.minFillFontSize)?y:2},B=xq(T.colorList,R.fillingColorList);R.sameColorList=B,Cs(M,T,R,A),function(t,e,i,r){let{getText:n}=e,{fillingInitialFontSize:s,fillingDeltaFontSize:l}=i,{fillingRatio:a}=i,o=Math.ceil(Math.sqrt(r.shapeArea)/4);if(!s||!l){let e,h=t.reduce((t,e)=>{let i=xQ(n(e));return i>o?t:t+i},0)/t.length;s=~~(e=0===h?8:Math.sqrt(.2*r.shapeArea/h*(a/100))),l=e*i.fillingDeltaFontSizeFactor,Object.assign(i,{fillingInitialFontSize:s,fillingDeltaFontSize:l})}}(M,T,R,S);let{getText:P,getFontFamily:E,getFontStyle:I,getFontWeight:L,getPadding:F,getColor:O,getFillingColor:D,getColorHex:H,fontSizeScale:z,colorScale:W,fillingColorScale:N,getFontOpacity:j,rotateList:G}=T,V=M.map(t=>{var e,i;return{x:0,y:0,weight:0,text:P(t),fontFamily:E(t),fontWeight:L(t),fontStyle:I(t),rotate:G[~~(w.randomGenerator()*G.length)],fontSize:Math.max(R.minInitFontSize,~~z(t)),opacity:j(t),padding:F(t),color:H&&H(t)||W&&W(O(t))||"black",fillingColor:!D||(null==(e=A.colorField)?void 0:e.field)===(null==(i=A.fillingColorField)?void 0:i.field)&&B?void 0:H&&H(t)||N&&N(D(t))||"black",datum:t,visible:!0,hasPlaced:!1}}),Z=ep(V.map(t=>t.fontSize));V.forEach(t=>t.weight=t.fontSize/Z),V.sort((t,e)=>e.weight-t.weight);let{fillingWords:U,successedWords:K,failedWords:$}=function(t,e,i){(function(t,e){let{segmentation:{regions:i}}=e,r=-1/0,n=0,s=0;i.forEach((t,e)=>{let i=t.area;i>r&&(r=i,s=e),n+=i});let l=0;i.forEach(e=>{let i=e.area,s=Math.ceil(i/n*t.length),a=i/r;e.words=[],e.regionNum=s,e.regionWeight=a,l+=s}),l<t.length&&(i[s].wordsNum+=t.length-l);let a=s,o=i.map(t=>t.regionNum);t.forEach(t=>{let e=0,r=0;t.regionIndex=-1;do{if(o[a]>0&&t.weight<=i[a].regionWeight){t.regionIndex=a,i[a].words.push(t),o[a]--,a=(a+1)%i.length;break}a=(a+1)%i.length,e++,++r>i.length+1&&(i.forEach(t=>{t.regionWeight+=.15}),r=0)}while(-1===t.regionIndex&&e<3*i.length);-1===t.regionIndex&&(t.regionIndex=s,i[s].words.push(t),o[s]--)}),i.forEach(t=>{t.words.sort((t,e)=>e.weight-t.weight)})})(t,i),"ensureMapping"===e.layoutMode?x0(t,e,i):"ensureMappingEnlarge"===e.layoutMode?function(t,e,i){let{size:r,stepFactor:n,importantWordCount:s}=e,{segmentation:{regions:l},tempCanvas:a,boardSize:o,shapeCenter:h,shapeMaxR:u,shapeRatio:d}=i,c=a.getContext("2d",{willReadFrequently:!0}),p=x4(i),g=p.slice(0),f=e.fontSizeEnlargeFactor,m=Math.min(s,t.length),y=0;t.length>m&&(y=t.sort((t,e)=>e.weight-t.weight)[m-1].weight);let v=0,b=1,_=!1;for(let s=0;s<l.length;s++){let{words:h,center:u,maxR:d,ratio:x}=l[s],C=!1;for(let s=0;s<h.length;s++){x5(a,c,t,s);let l=h[s];if(l.x=u[0],l.y=u[1],l.hasText&&l.sprite&&x1(g,l,d,x,r,o,n)){if(l.hasPlaced=!0,l.weight>=y&&v++,v>=m&&!_){b*=f,t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*f}),g=p.slice(0),C=!0,v=0;break}}else{if(l.weight>=y&&b>1){t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/f}),b/=f,_=!0,g=p.slice(0),C=!0;break}if(l.weight>=y)return x0(t,e,i)}}C&&(s=-1)}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];x5(a,c,i,t),e.x=h[0],e.y=h[1],e.hasText&&x1(g,e,u,d,r,o,n)&&(e.hasPlaced=!0)}}e.board=g}(t,e,i):function(t,e,i){let{size:r,stepFactor:n}=e,{segmentation:{regions:s},tempCanvas:l,boardSize:a,shapeCenter:o,shapeMaxR:h,shapeRatio:u}=i,d=x4(i),c=l.getContext("2d",{willReadFrequently:!0});for(let e of s){let{words:i,center:s,maxR:o,ratio:h}=e;for(let e=0;e<i.length;e++){x5(l,c,t,e);let u=i[e];u.x=s[0],u.y=s[1],u.hasText&&u.sprite&&x1(d,u,o,h,r,a,n)&&(u.hasPlaced=!0)}}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];x5(l,c,i,t),e.x=o[0],e.y=o[1],e.hasText&&x1(d,e,h,u,r,a,n)&&(e.hasPlaced=!0)}}e.board=d}(t,e,i);let r=function(t,e,i){let{size:r,fillingTimes:n,fillingXStep:s,fillingYStep:l,getFillingFontStyle:a,getFillingFontWeight:o,getFillingFontFamily:h,fillingInitialFontSize:u,fillingDeltaFontSize:d,fillingInitialOpacity:c,fillingDeltaOpacity:p,fillingRotateList:g,getFillingPadding:f,random:m,board:y,minFillFontSize:v}=e,{boardSize:b,shapeBounds:_,tempCanvas:x,randomGenerator:C}=i,w=x.getContext("2d",{willReadFrequently:!0}),S=u,A=c,M=[];for(let e=0;e<n;e++)(function(e,i){let n=t.map(t=>{let{text:r,color:n,fillingColor:s,hasPlaced:l,datum:u}=t;return{x:0,y:0,weight:0,text:r,fontFamily:h(u),fontStyle:a(u),fontWeight:o(u),fontSize:e,rotate:g[~~(C()*g.length)],padding:f(u),opacity:i,visible:!0,color:n,fillingColor:s,hasPlaced:l,datum:u}});k(n);let u=0,{x1:d,y1:c,x2:p,y2:v}=_,[S,A]=[d+~~(C()*s*2),c+~~(C()*l*2)];for(let t=A;t<=v;t+=l)for(let e=S;e<=p;e+=s){x5(x,w,n,u);let i=n[u];i.x=e,i.y=t;let{wordSize:s,bounds:l,hasPlaced:a}=i;if(!a||!l){++u===n.length&&(u=0,m&&k(n));continue}let{dTop:o,dBottom:h,dLeft:d,dRight:c}=l;i.x-d<0||i.x+c>r[0]||i.y-o<0||i.y+h>r[1]||i.hasText&&i.sprite&&!x3(i,y,b)&&(x2(i,y,b),M.push(Object.assign({},i)),++u===n.length&&(u=0,m&&k(n)))}})(S,A),S=Math.max(S>d?S-d:d,v),A=A>p?A-p:p;return M;function k(t){return t.sort(()=>C()-.5)}}(t,e,i),n=[],s=[];for(let e=0;e<t.length;e++)t[e].hasPlaced?s.push(t[e]):n.push(t[e]);return n.forEach(t=>t.visible=!1),{fillingWords:r,successedWords:s,failedWords:n}}(V,R,S),Y=null!=(b=null==(v=A.text)?void 0:v.field)?b:"textKey",X=null!=(_=A.dataIndexKey)?_:"defaultDataIndexKey",q=A.as?Object.assign(Object.assign({},Cr),A.as):Cr,J=[];for(let t=0;t<V.length;++t)(C=(x=V[t]).datum)[q.x]=x.x,C[q.y]=x.y,C[q.fontFamily]=x.fontFamily,C[q.fontSize]=x.fontSize,C[q.fontStyle]=x.fontStyle,C[q.fontWeight]=x.fontWeight,C[q.angle]=af(x.rotate),C[q.opacity]=x.opacity,C[q.visible]=x.visible,C[q.isFillingWord]=!1,C[q.color]=x.color,C[X]=`${x.text}_${t}_keyword`,J.push(C);let Q=[];U.forEach((t,e)=>{var i,r;let n=Object.assign({},t.datum);n[q.x]=t.x,n[q.y]=t.y,n[q.fontFamily]=t.fontFamily,n[q.fontSize]=t.fontSize,n[q.fontStyle]=t.fontStyle,n[q.fontWeight]=t.fontWeight,n[q.angle]=af(t.rotate),n[q.opacity]=t.opacity,n[q.visible]=t.visible,n[q.isFillingWord]=!0,n[q.color]=D?(null==(i=A.colorField)?void 0:i.field)===(null==(r=A.fillingColorField)?void 0:r.field)&&B?t.color:t.fillingColor:R.fillingColorList[~~(w.randomGenerator()*R.fillingColorList.length)],n[Y]=t.text,n[X]=`${t.text}_${e}_fillingWords`,Q.push(n)}),this.options.onLayoutFinished&&this.options.onLayoutFinished({successedWords:K,failedWords:$}),this.progressiveResult=J.concat(Q)}release(){this.segmentationInput=null,this.data=null,this.progressiveResult=null,this.options=null}}let Cs=(t,e,i,r)=>{var n,s,l,a;let{colorMode:o,getColor:h,getFillingColor:u}=e,{sameColorList:d}=i,c,p,g=e.colorList,f=i.fillingColorList;if("ordinal"===o){let e=t.map(t=>h(t));if(c=t=>(new l9).domain(e).range(g).scale(t),u&&((null==(n=r.colorField)?void 0:n.field)!==(null==(s=r.fillingColorField)?void 0:s.field)||!d)){let e=t.map(t=>u(t));p=t=>(new l9).domain(e).range(f).scale(t)}}else{1===g.length&&(g=[g[0],g[0]]);let e=(new l4).domain(Co(h,t)).range(g);if(c=t=>e.scale(t),u&&((null==(l=r.colorField)?void 0:l.field)!==(null==(a=r.fillingColorField)?void 0:a.field)||!d)){1===f.length&&(f=[f[0],f[0]]);let e=(new l4).domain(Co(u,t)).range(f);p=t=>e.scale(t)}}Object.assign(e,{colorScale:c,fillingColorScale:p})},Cl=(t,e,i)=>{let r,{fontSizeRange:n}=e,{getFontSize:s,getText:l}=e;if(s){if(s&&n){let e=(new Ci).domain(Co(s,t)).range(n);r=t=>e.scale(s(t))}else if(s&&tQ(s)&&!n){let[e,a]=Co(s,t),o=Ca(t.map(t=>({text:l(t),value:s(t),weight:a===e?1:(s(t)-e)/(a-e)})),i,!0);n=[~~(.5*o),~~o];let h=(new Ci).domain(Co(s,t)).range(n);r=t=>h.scale(s(t))}}else{var a;r="function"==typeof(a=Ca(t.map(t=>({text:l(t)})),i,!1))?a:function(){return a}}Object.assign(e,{getFontSize:s,fontSizeRange:n,fontSizeScale:r})},Ca=(t,e,i)=>{let r=e.shapeArea,n=e.ratio,s=e.segmentation.regions,l=Math.ceil(Math.sqrt(r)/12),a=t.reduce((t,e)=>{let r=xQ(e.text);return r<l?t+r*(i?(.5+.5*e.weight)**2:1):t},0);if(0===a)return 12;let o=20;if(1===s.length)o=Math.sqrt(r/(1.7*a)*n);else{let t=[];for(let e=0;e<s.length;e++){let i=s[e].area,l=s[e].ratio,o=i/r;if(o<.1)continue;let h=Math.sqrt(i/(a*(l<1?2.7-l:1.7)*o)*n);t.push(h)}o=t.length?Math.min(...t):Math.sqrt(r/(1.7*a)*n)}return o},Co=(t,e)=>{let i,r=1/0,n=-1/0,s=e.length;for(let l=0;l<s;++l)(i=l2(t(e[l])))<r&&(r=i),i>n&&(n=i);return 1===e.length&&r===n&&(r-=1e4),[r,n]},Ch=(t,e,i)=>{if(!t.size||er(t.size[0])||er(t.size[1])||t.size[0]<=0||t.size[1]<=0)return tU.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(t.size=[Math.ceil(t.size[0]),Math.ceil(t.size[1])],t.shape||tU.getInstance().error("WordcloudShape shape must be specified."),t.text||tU.getInstance().error("WordcloudShape text must be specified."),t.onBeforeLayout&&t.onBeforeLayout(),!e||0===e.length)return[];let r=new Cn(t);return r.layout(e),r.unfinished()?{progressive:r}:r.output()};class Cu extends xb{constructor(){super(...arguments),this.type=rR.wordCloud}}Cu.type=rR.wordCloud;let Cd=()=>{iv.registerGrammarTransform("wordcloud",{transform:xU}),_B(),xx(),iv.registerSeries(Cu.type,Cu)},Cc=()=>{iv.registerGrammarTransform("wordcloudShape",{transform:Ch}),iv.registerGrammarTransform("wordcloud",{transform:xU}),_B(),xx(),iv.registerSeries(Cu.type,Cu)};class Cp extends xh{constructor(){super(...arguments),this.transformerConstructor=xo,this.type="wordCloud",this.seriesType=rR.wordCloud}}Cp.type="wordCloud",Cp.seriesType=rR.wordCloud,Cp.transformerConstructor=xo;let Cg=()=>{mx(),Cd(),iv.registerChart(Cp.type,Cp)},Cf=()=>{Cc(),mx(),Cd(),iv.registerChart(Cp.type,Cp)},Cm=(t,e)=>{var i,r;let n=t.map(t=>Object.assign({},t));if(!n||0===n.length)return n;let{valueField:s,asTransformRatio:l,asReachRatio:a,asHeightRatio:o,asValueRatio:h,asNextValueRatio:u,asLastValueRatio:d,asLastValue:c,asCurrentValue:p,asNextValue:g,heightVisual:f=!1,isCone:m=!0,range:y}=e,v=n.reduce((t,e)=>Math.max(t,Number.parseFloat(e[s])||-1/0),-1/0),b=n.reduce((t,e)=>Math.min(t,Number.parseFloat(e[s])||1/0),1/0),_=[null!=(i=null==y?void 0:y.min)?i:b,null!=(r=null==y?void 0:y.max)?r:v];return n.forEach((t,e)=>{var i,r;let y=Number.parseFloat(t[s]),v=Number.parseFloat(null==(i=n[e-1])?void 0:i[s]),b=Number.parseFloat(null==(r=n[e+1])?void 0:r[s]),x=en(b*y)&&0!==y?b/y:0,C=en(y*v)&&0!==v?y/v:0;c&&(t[c]=v),g&&(t[g]=b),l&&(t[l]=x),a&&(t[a]=0===e?1:C),o&&(t[o]=!0===f?x:1/n.length),h&&(t[h]=y/_[1]),u&&(t[u]=e===n.length-1?m?0:t[h]:b/_[1]),d&&(t[d]=0===e?1:v/_[1]),p&&(t[p]=y)}),n},Cy=(t,e)=>{var i,r;let n=null==(r=null==(i=t[0])?void 0:i.latestData)?void 0:r.map(t=>Object.assign({},t));return n&&0!==n.length&&(n.shift(),n.forEach(t=>{t[e.asIsTransformLevel]=!0})),n},Cv=`${st}_FUNNEL_TRANSFORM_RATIO`,Cb=`${st}_FUNNEL_REACH_RATIO`,C_=`${st}_FUNNEL_HEIGHT_RATIO`,Cx=`${st}_FUNNEL_VALUE_RATIO`,CC=`${st}_FUNNEL_LAST_VALUE_RATIO`,Cw=`${st}_FUNNEL_NEXT_VALUE_RATIO`,CS=`${st}_FUNNEL_LAST_VALUE`,CA=`${st}_FUNNEL_CURRENT_VALUE`,CM=`${st}_FUNNEL_NEXT_VALUE`,Ck=`${st}_FUNNEL_TRANSFORM_LEVEL`;class CT extends cs{constructor(t){var e,i;super(t),this.dimensionTooltipTitleCallback=(t,e)=>{var i,r,n;let s=this.series;return"transform"===(null==(i=null==e?void 0:e.mark)?void 0:i.name)?this._transformRatioText:null!=(r=this._getDimensionData(t))?r:null==(n=t.properties)?void 0:n[`${s.getCategoryField()}`]},this.markTooltipValueCallback=(t,e)=>{var i;return"transform"===(null==(i=null==e?void 0:e.mark)?void 0:i.name)?`${(100*(null==t?void 0:t[Cb])).toFixed(1)}%`:this._getMeasureData(t)},this.markTooltipKeyCallback=(t,e)=>{var i;if("transform"===(null==(i=null==e?void 0:e.mark)?void 0:i.name))return this._transformRatioText;let{dimensionFields:r,seriesFields:n}=this._seriesCacheInfo,s=r[r.length-1];return t8(n[0])?null==t?void 0:t[n[0]]:null==t?void 0:t[s]},this._transformRatioText=null!=(i=null==(e=t.getSpec())?void 0:e.transformRatioText)?i:"转化率"}}class CR extends od{_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{points:[]})}}var CB=i(34807),CP=i(26854);class CE extends CR{constructor(){super(...arguments),this.type=CE.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}}CE.type="polygon";let CI=()=>{iv.registerMark(CE.type,CE),(0,oc.W)(),(0,CB.M)(),dr(),iv.registerGraphicComponent("polygon",CP.p)},CL=Object.assign(Object.assign({},cy),{funnel:{name:"funnel",type:"polygon"},transform:{name:"transform",type:"polygon"},transformLabel:{name:"transformLabel",type:"text"},outerLabel:{name:"outerLabel",type:"text"},outerLabelLine:{name:"outerLabelLine",type:"rule"}});class CF extends cE{_transformLabelSpec(t){this._addMarkLabelSpec(t,"funnel"),t.isTransform&&this._addMarkLabelSpec(t,"transform","transformLabel")}}class CO extends cI{constructor(){super(...arguments),this.type=rR.funnel,this._funnelMarkName="funnel",this._funnelMarkType="polygon",this._transformMarkName="transform",this._transformMarkType="polygon",this.transformerConstructor=CF,this._funnelMark=null,this._funnelTransformMark=null,this._labelMark=null,this._transformLabelMark=null,this._funnelOuterLabelMark={}}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t,e,i,r,n;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this._funnelOrient=null!=(t=this._spec.funnelOrient)?t:"top",this._shape=null!=(e=this._spec.shape)?e:"trapezoid",this._minLabelLineWidth=null!=(n=null==(r=null==(i=this._spec.outerLabel)?void 0:i.line)?void 0:r.minLength)?n:20,this._isHorizontal()?this._funnelAlign=["top","bottom"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center":this._funnelAlign=["left","right"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center",!this._seriesField&&this._spec.categoryField&&this.setSeriesField(this._spec.categoryField)}initData(){if(super.initData(),!this._data)return;nq(this._dataSet,"funnel",Cm),nq(this._dataSet,"funnelTransform",Cy);let t=new el(this._dataSet,{name:`${st}_series_${this.id}_viewDataTransform`});t.parse([this.getViewData()],{type:"dataview"}),this._viewDataTransform=new aC(this._option,t)}compile(){var t,e;super.compile(),this._funnelOuterLabelMark&&(null==(t=this._funnelOuterLabelMark.label)||t.compile({group:this._rootMark.getProduct()}),null==(e=this._funnelOuterLabelMark.line)||e.compile({group:this._rootMark.getProduct()}))}compileData(){var t;super.compileData(),null==(t=this._viewDataTransform)||t.compile()}getStatisticFields(){let t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}_statisticViewData(){var t,e,i,r,n,s,l,a,o;super._statisticViewData(),this._data.getDataView().transform({type:"funnel",options:{valueField:this.getValueField(),isCone:this._spec.isCone,asCurrentValue:CA,asTransformRatio:Cv,asReachRatio:Cb,asHeightRatio:C_,asValueRatio:Cx,asNextValueRatio:Cw,asLastValueRatio:CC,asLastValue:CS,asNextValue:CM,range:{min:null!=(e=null==(t=this._spec.range)?void 0:t.min)?e:null==(r=null==(i=this.getViewDataStatistics().latestData)?void 0:i[this.getValueField()])?void 0:r.min,max:null!=(s=null==(n=this._spec.range)?void 0:n.max)?s:null==(a=null==(l=this.getViewDataStatistics().latestData)?void 0:l[this.getValueField()])?void 0:a.max}}}),null==(o=this._viewDataTransform.getDataView())||o.transform({type:"funnelTransform",options:{asIsTransformLevel:Ck}})}initMark(){var t,e,i,r,n,s,l,a;if(this._funnelMark=this._createMark(Object.assign(Object.assign({},CO.mark.funnel),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null==(t=this._theme)?void 0:t.funnel,groupKey:this._seriesField,isSeriesMark:!0,noSeparateStyle:!0},{morph:cR(this._spec,this._funnelMarkName),morphElementKey:this._seriesField}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(Object.assign(Object.assign({},CO.mark.transform),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null==(e=this._theme)?void 0:e.transform,noSeparateStyle:!0}),this._funnelTransformMark&&this._funnelTransformMark.setData(this._viewDataTransform)),null==(r=null==(i=this._spec)?void 0:i.outerLabel)?void 0:r.visible){let{line:t}=null!=(n=this._spec.outerLabel)?n:{},{line:e}=null!=(l=null==(s=this._theme)?void 0:s.outerLabel)?l:{};this._funnelOuterLabelMark.label=this._createMark(CO.mark.outerLabel,{themeSpec:null==(a=this._theme)?void 0:a.outerLabel,markSpec:this._spec.outerLabel,noSeparateStyle:!0,parent:!1}),this._funnelOuterLabelMark.line=this._createMark(CO.mark.outerLabelLine,{themeSpec:e,markSpec:t,noSeparateStyle:!0,parent:!1})}}initTooltip(){this._tooltipHelper=new CT(this),this._funnelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelMark),this._funnelTransformMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelTransformMark)}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return[this._valueField]}getGroupFields(){return null}initMarkStyle(){var t,e,i,r;let n=this._funnelMark;n&&this.setMarkStyle(n,{points:t=>this.getPoints(t),visible:t=>t8(t[this._valueField]),fill:this.getColorAttribute()},"normal",W.Series);let s=this._funnelTransformMark;s&&this.setMarkStyle(s,{points:t=>this.getPoints(t)},"normal",W.Series);let l=this._funnelOuterLabelMark.label;l&&(this.setMarkStyle(l,{text:t=>`${t[this.getCategoryField()]}`,x:t=>this._computeOuterLabelPosition(t).x,y:t=>this._computeOuterLabelPosition(t).y,textAlign:t=>this._computeOuterLabelPosition(t).align,textBaseline:t=>this._computeOuterLabelPosition(t).textBaseline,maxLineWidth:t=>this._computeOuterLabelLimit(t),width:0,height:0},"normal",W.Series),tQ(this._spec.outerLabel.formatMethod)&&this.setMarkStyle(l,{text:t=>this._spec.outerLabel.formatMethod(`${t[this.getCategoryField()]}`,t)},"normal",W.User_Mark));let a=this._funnelOuterLabelMark.line;if(a&&l){this.setMarkStyle(a,{x:t=>this._computeOuterLabelLinePosition(t).x1,y:t=>this._computeOuterLabelLinePosition(t).y1,x1:t=>this._computeOuterLabelLinePosition(t).x2,y1:t=>this._computeOuterLabelLinePosition(t).y2},"normal",W.Series);let n=null!=(i=null==(e=null==(t=this._spec.outerLabel)?void 0:t.line)?void 0:e.visible)?i:null==(r=this._spec.outerLabel)?void 0:r.visible;t8(n)&&a.setVisible(n)}}initLabelMarkStyle(t){var e;if(!t)return;let i=t.getTarget(),r=t.getComponent();if(i===this._funnelMark){this._labelMark=t,this.setMarkStyle(t,{text:t=>`${t[this.getCategoryField()]} ${t[this.getValueField()]}`,x:t=>this._computeLabelPosition(t).x,y:t=>this._computeLabelPosition(t).y,maxLineWidth:t=>this._computeLabelLimit(t,this._spec.label),stroke:this.getColorAttribute()},"normal",W.Series);let i=this.getCompiler().getRootMarks();this._funnelOuterLabelMark.label&&fo(i,this._funnelOuterLabelMark.label,r),this._funnelOuterLabelMark.line&&fo(i,this._funnelOuterLabelMark.line,null!=(e=this._funnelOuterLabelMark.label)?e:r)}else this._funnelTransformMark&&i===this._funnelTransformMark&&(this._transformLabelMark=t,this.setMarkStyle(t,{text:t=>`${(100*eo(Cb).bind(this)(t)).toFixed(1)}%`,x:t=>this._computeLabelPosition(t).x,y:t=>this._computeLabelPosition(t).y,maxLineWidth:t=>this._computeLabelLimit(t,this._spec.transformLabel)},"normal",W.Series))}initAnimation(){var t,e,i,r,n,s,l;let a=null!=(i=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset)?i:"clipIn";"clipIn"===a&&this._rootMark&&this._rootMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("cartesianGroupClip"))?void 0:r({direction:()=>this._isHorizontal()?"x":"y",width:()=>{let t=this.getRootMark().getProduct();if(t){let{x1:e,x2:i}=t.AABBBounds;return Math.max(e,i)}return this.getLayoutRect().width},height:()=>{let t=this.getRootMark().getProduct();if(t){let{y1:e,y2:i}=t.AABBBounds;return Math.max(e,i)}return this.getLayoutRect().height},orient:()=>this._isReverse()?"negative":"positive"},a),cM("group",this._spec,this._markAttributeContext))),[null==(n=this._funnelOuterLabelMark)?void 0:n.label].forEach(t=>{t&&t.setAnimationConfig(cA(iv.getAnimationInKey("fadeInOut")(),cM(t.name,this._spec,this._markAttributeContext)))}),[this._funnelMark,this._funnelTransformMark].forEach(t=>{t&&t.setAnimationConfig(cA(iv.getAnimationInKey("funnel")({},a),cM(t.name,this._spec,this._markAttributeContext)))}),(null==(s=this._funnelOuterLabelMark)?void 0:s.line)&&this._funnelOuterLabelMark.line.setAnimationConfig(cA(null==(l=iv.getAnimationInKey("fadeInOut"))?void 0:l(),cM("outerLabelLine",this._spec,this._markAttributeContext)))}initGroups(){}getStackGroupFields(){return[]}getStackValueField(){return null}initEvent(){var t;super.initEvent(),null==(t=this._viewDataTransform.getDataView())||t.target.addListener("change",t=>{this._viewDataTransform.updateData()})}getPoints(t){let e,i,r=this.isTransformLevel(t),n=this._getMainAxisLength(r)/2;r?(e="rect"===this._shape?this._getSecondaryAxisLength(t[CC])/2:this._getSecondaryAxisLength(t[Cx])/2,i=this._getSecondaryAxisLength(t[Cx])/2):(e=this._getSecondaryAxisLength(t[Cx])/2,i="rect"===this._shape?e:this._getSecondaryAxisLength(t[Cw])/2);let{x:s,y:l}=this._getPositionByData(t),a=this._getPolygonPoints([s,l],e,i,e,i,n);return"center"!==this._funnelAlign&&this._adjustPoints(a),a}isTransformLevel(t){return!!(null==t?void 0:t[Ck])}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getPoints=this.getPoints.bind(this),this._markAttributeContext.isTransformLevel=this.isTransformLevel.bind(this)}valueToPosition(t){var e,i,r;let n=null==(r=null==(i=null==(e=this.getViewData())?void 0:e.latestData)?void 0:i.find)?void 0:r.call(i,e=>e[this._categoryField]===t);return t8(n)?this._getPolygonCenter(this.getPoints(n)):null}dataToPosition(t,e){return e&&!this.isDatumInViewData(t)?null:this.valueToPosition(t[this._categoryField])}dataToPositionX(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.x}dataToPositionY(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.y}dataToPositionZ(t){return 0}_getMainAxisLength(t=!1){var e;let i=this.getViewData().latestData.length,r=this._isHorizontal()?this.getLayoutRect().width:this.getLayoutRect().height,n=!!this._spec.isTransform,s=n?0:null!=(e=this._spec.gap)?e:0,l=n?Math.max(0,i-1):0,a=this._spec.heightRatio||.5,o=(r-s*Math.max(0,i-1))/(i+a*l);return t?n?o*a:0:o}_getSecondaryAxisLength(t){let e=Number.isNaN(t)||!Number.isFinite(t)?0:t,i=this._computeMaxSize(),r=this._computeMinSize();return r+(i-r)*e}_getPositionByData(t){var e;let i=null==(e=this.getViewData().latestData)?void 0:e.findIndex(e=>e[this._categoryField]===t[this._categoryField]&&e[ss]===t[ss]);if(!t8(i)||i<0)return{};let r=this.isTransformLevel(t),n=this._isHorizontal(),s=n?this.getLayoutRect().height:this.getLayoutRect().width,l=n?this.getLayoutRect().width:this.getLayoutRect().height,a=s/2,o=0,h=this._getMainAxisLength(),u=this._getMainAxisLength(!0);return o+=i*(h+u)+(r?-u/2:h/2),!this._spec.isTransform&&this._spec.gap&&(o+=this._spec.gap*i),this._isReverse()&&(o=l-o),this._isHorizontal()?{x:o,y:a}:{x:a,y:o}}_getPolygonPoints(t,e,i,r,n,s){let l=t[0],a=t[1];switch(this._funnelOrient){case"left":return[{x:l-s,y:a+e},{x:l-s,y:a-r},{x:l+s,y:a-n},{x:l+s,y:a+i}];case"right":return[{x:l+s,y:a-r},{x:l+s,y:a+r},{x:l-s,y:a+i},{x:l-s,y:a-i}];case"bottom":return[{x:l+e,y:a+s},{x:l-r,y:a+s},{x:l-n,y:a-s},{x:l+i,y:a-s}];default:return[{x:l-e,y:a-s},{x:l+r,y:a-s},{x:l+n,y:a+s},{x:l-i,y:a+s}]}}_getPolygonCenter(t){if(this._isHorizontal()){let e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}let e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}_adjustPoints(t){let e,i,r;return this._isHorizontal()?(r="y","left"===this._funnelOrient?(e="bottom"===this._funnelAlign?-t[1].y:t[1].y,i="bottom"===this._funnelAlign?-t[2].y:t[2].y):(e="bottom"===this._funnelAlign?-t[0].y:t[0].y,i="bottom"===this._funnelAlign?-t[3].y:t[3].y)):(r="x","top"===this._funnelOrient?(e="left"===this._funnelAlign?t[0].x:-t[0].x,i="left"===this._funnelAlign?t[3].x:-t[3].x):(e="left"===this._funnelAlign?t[1].x:-t[1].x,i="left"===this._funnelAlign?t[2].x:-t[2].x)),t[0][r]-=e,t[1][r]-=e,t[2][r]-=i,t[3][r]-=i,t}_computeLabelPosition(t){let e=this.getPoints(t);return this._getPolygonCenter(e)}_computeLabelLimit(t,e){let i=null==e?void 0:e.limit;if(tG(i))return i;let r=this.getPoints(t);return"shapeSize"===i?this._isHorizontal()?Math.abs(r[3].x-r[0].x):(Math.abs(r[0].x-r[1].x)+Math.abs(r[2].x-r[3].x))/2:this._isHorizontal()?Math.abs(r[3].x-r[0].x):void 0}_computeOuterLabelPosition(t){var e,i;let r,n,s=null==(e=this._spec.outerLabel)?void 0:e.position,l="center",a="middle";if(s=this._isHorizontal()?["top","bottom"].includes(s)?s:"bottom"===this._funnelAlign?"top":"bottom":["left","right"].includes(s)?s:"left"===this._funnelAlign?"right":"left",!1!==(null==(i=this._spec.outerLabel)?void 0:i.alignLabel))({x:r,y:n}=this._getPositionByData(t)),"left"===s?(r=0,l="left"):"right"===s?(r=this.getLayoutRect().width,l="right"):"top"===s?(n=0,a="top"):"bottom"===s&&(n=this.getLayoutRect().height,a="bottom");else{let{x2:e,y2:i}=this._computeOuterLabelLinePosition(t);r=e,n=i,"left"===s?(r-=5,l="right"):"right"===s?(r+=5,l="left"):"top"===s?(n-=5,a="bottom"):"bottom"===s&&(n+=5,a="top")}return{x:r,y:n,align:l,textBaseline:a}}_computeOuterLabelLimit(t){var e,i,r,n,s,l;if(this._isHorizontal())return this._getMainAxisLength(this.isTransformLevel(t));let a=this.getPoints(t),o=(Math.abs(a[0].x-a[1].x)+Math.abs(a[2].x-a[3].x))/2,h=this.getCategoryField(),u=null==(n=null==(r=null==(i=null==(e=this._labelMark)?void 0:e.getComponent())?void 0:i.getComponent())?void 0:r.find(({attribute:e,type:i})=>{var r;return"text"===i&&(null==(r=e.data)?void 0:r[h])===t[h]},!0))?void 0:n.AABBBounds,d=u?u.x2-u.x1:0,c=this._funnelOuterLabelMark.line?this._minLabelLineWidth:0,p=this.getLayoutRect().width-Math.max(o,d);return"center"===this._funnelAlign&&(p/=2),p-c-(null!=(l=null==(s=this._spec.outerLabel)?void 0:s.spaceWidth)?l:5)}_computeOuterLabelLinePosition(t){var e,i,r,n,s,l,a,o,h,u;let d,c,p,g,f=this.getCategoryField(),m=null==(n=null==(r=null==(i=null==(e=this._funnelOuterLabelMark)?void 0:e.label)?void 0:i.getGraphics())?void 0:r.find(e=>{var i;return(null==(i=e.context.data[0])?void 0:i[f])===t[f]}))?void 0:n.AABBBounds,y=null==(l=null==(s=this._labelMark)?void 0:s.getComponent())?void 0:l.getComponent(),v=null==(a=null==y?void 0:y.find(({attribute:e,type:i})=>{var r;return"text"===i&&(null==(r=e.data)?void 0:r[f])===t[f]},!0))?void 0:a.AABBBounds,b=null!=(o=this._spec.outerLabel)?o:{};if(this._isHorizontal()){let e=null!=(h=b.spaceWidth)?h:5,i=this.getPoints(t),r=(Math.abs(i[0].y-i[1].y)+Math.abs(i[2].y-i[3].y))/2;return"top"===this._spec.outerLabel.position||"bottom"===this._funnelAlign?(p=this._getPolygonCenter(i).y-r/2-e,g=!1!==b.alignLabel?(null==m?void 0:m.y2)+e:p-e,d=this._getPolygonCenter(i).x,p-g<this._minLabelLineWidth&&(g=p-this._minLabelLineWidth)):(p=this._getPolygonCenter(i).y+r/2+e,g=!1!==b.alignLabel?(null==m?void 0:m.y1)-e:p+e,d=this._getPolygonCenter(i).x,g-p<this._minLabelLineWidth&&(g=p+this._minLabelLineWidth)),c=d,{x1:d,x2:c,y1:p,y2:g}}let _=this.getPoints(t),x=(Math.abs(_[0].x-_[1].x)+Math.abs(_[2].x-_[3].x))/2,C=(null==v?void 0:v.x2)-(null==v?void 0:v.x1)||0,w=null!=(u=b.spaceWidth)?u:5;return"right"===this._spec.outerLabel.position||"left"===this._funnelAlign?(d=this._getPolygonCenter(_).x+Math.max(C/2,x/2)+w,c=!1!==b.alignLabel?(null==m?void 0:m.x1)-w:d+w,p=this._getPolygonCenter(_).y,c-d<this._minLabelLineWidth&&(c=d+this._minLabelLineWidth)):(d=this._getPolygonCenter(_).x-Math.max(C/2,x/2)-w,c=!1!==b.alignLabel?(null==m?void 0:m.x2)+w:d-w,p=this._getPolygonCenter(_).y,d-c<this._minLabelLineWidth&&(c=d-this._minLabelLineWidth)),g=p,{x1:d,x2:c,y1:p,y2:g}}_computeMaxSize(){var t;let e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return eS(null!=(t=this._spec.maxSize)?t:"80%",e)}_computeMinSize(){var t;let e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return eS(null!=(t=this._spec.minSize)?t:0,e)}_isHorizontal(){return"left"===this._funnelOrient||"right"===this._funnelOrient}_isReverse(){return"bottom"===this._funnelOrient||"right"===this._funnelOrient}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._funnelMark]}}CO.type=rR.funnel,CO.mark=CL,CO.builtInTheme={funnel:iC},CO.transformerConstructor=CF;let CD=()=>{CI(),_B(),__(),iv.registerSeries(CO.type,CO),iv.registerAnimation("funnel",(t,e)=>Object.assign({appear:"clipIn"===e?void 0:{type:"fadeIn"}},u2)),u4(),u5()};class CH extends fD{needAxes(){return!1}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","funnelAlign","funnelOrient","heightRatio","shape","funnel","transform","outerLabel","transformLabel","isTransform","maxSize","minSize","gap","isCone","range","transformRatioText"])}transformSpec(t){super.transformSpec(t),super.transformSeriesSpec(t)}}class Cz extends fV{constructor(){super(...arguments),this.transformerConstructor=CH,this.type="funnel",this.seriesType=rR.funnel}}Cz.type="funnel",Cz.seriesType=rR.funnel,Cz.transformerConstructor=CH;let CW=()=>{mx(),CD(),iv.registerChart(Cz.type,Cz)};function CN(t){return()=>"vertical"===t.direction?{orient:"negative"}:{orient:"positive"}}let Cj=t=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:CN(t)}),CG=t=>({type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:CN(t)}),CV={type:"fadeIn"};function CZ(t,e="grow"){return!1===e?{}:"fadeIn"===e?CV:Cj(t)}let CU=()=>{iv.registerAnimation("linearProgress",(t,e)=>({appear:CZ(t,e),enter:CZ(t),disappear:CG(t)}))};class CK extends cs{enableByType(t){return"dimension"!==t}}let C$=Object.assign(Object.assign({},cy),{track:{name:"track",type:"rect"},progress:{name:"progress",type:"rect"},group:{name:"group",type:"group"}});class CY extends cD{constructor(){super(...arguments),this.type=rR.linearProgress,this._progressMark=null,this._trackMark=null,this._defaultProgressCustomShape=(t,e,i)=>{var r,n;let s=null==(r=this._spec)?void 0:r.cornerRadius,l=t8(e.width)?e.width:e.x1-e.x,a=t8(e.height)?e.height:e.y1-e.y,o=Math.min(0,l),h=Math.max(0,l),u=Math.min(0,a),d=Math.max(0,a);if(s>0){let t=s;if("vertical"===(null==(n=this._spec)?void 0:n.direction)){if(2*(t=Math.min(Math.abs(l/2),s))>Math.abs(a)){let e=Math.acos((t-Math.abs(a)/2)/t);return i.moveTo(o+t,u),i.arc(o+t,u+t,t,1.5*Math.PI,1.5*Math.PI-e,!0),i.arc(o+t,d-t,t,e+Math.PI/2,Math.PI/2,!0),i.lineTo(h-s,d),i.arc(h-t,d-t,t,Math.PI/2,Math.PI/2-e,!0),i.arc(h-t,u+t,t,-Math.PI/2+e,-Math.PI/2,!0),i.lineTo(o+t,u),i.closePath(),i}}else if(2*(t=Math.min(Math.abs(a/2),s))>Math.abs(l)){let e=Math.acos((t-Math.abs(l)/2)/t);return i.moveTo(o,u+t),i.arc(o+t,u+t,t,Math.PI,Math.PI+e),i.arc(h-t,u+t,t,-e,0),i.lineTo(h,d-t),i.arc(h-t,d-t,t,0,e),i.arc(o+t,d-t,t,Math.PI-e,Math.PI),i.closePath(),i}i.moveTo(o,u+t),i.arc(o+t,u+t,t,Math.PI,1.5*Math.PI),i.lineTo(h-t,u),i.arc(h-t,u+t,t,-Math.PI/2,0),i.lineTo(h,d-t),i.arc(h-t,d-t,t,0,Math.PI/2),i.lineTo(o+t,d),i.arc(o+t,d-t,t,Math.PI/2,Math.PI),i.closePath()}else i.moveTo(o,u),i.lineTo(h,u),i.lineTo(h,d),i.lineTo(o,d),i.closePath();return i}}initMark(){this._initTrackMark(),this._initProgressMark()}initMarkStyle(){this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){var t;return this._progressMark=this._createMark(CY.mark.progress,{isSeriesMark:!0}),er(null==(t=this._spec.progress)?void 0:t.customShape)&&this._progressMark.setMarkConfig({setCustomizedShape:this._defaultProgressCustomShape}),this._progressMark}_initProgressMarkStyle(){var t,e,i,r;let n=this._progressMark;if(n)if("vertical"===this._spec.direction){let i=this._spec.progress||{},r=null!=(t=i.leftPadding)?t:0,s=null!=(e=i.rightPadding)?e:0;this.setMarkStyle(n,{x:t=>{var e,i;return aa(this.dataToPositionX(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0),!0)-this._spec.bandWidth/2+r},y1:t=>{var e,i;return aa(this.dataToPositionY(t),null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:()=>{var t,e,i;let r=null==(t=this._yAxisHelper)?void 0:t.dataToPosition([0],{bandPosition:this._bandPosition});return this._spec.clamp?aa(r,null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0)):r},width:this._spec.bandWidth-r-s,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",W.Series)}else{let t=this._spec.progress||{},e=null!=(i=t.topPadding)?i:0,s=null!=(r=t.bottomPadding)?r:0;this.setMarkStyle(n,{x1:t=>{var e,i;return aa(this.dataToPositionX(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:t=>{var i,r;return aa(this.dataToPositionY(t),null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0),!0)-this._spec.bandWidth/2+e},height:this._spec.bandWidth-e-s,x:()=>{var t,e,i;let r=null==(t=this._xAxisHelper)?void 0:t.dataToPosition([0],{bandPosition:this._bandPosition});return this._spec.clamp?aa(r,null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0)):r},cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",W.Series)}}_initTrackMark(){return this._trackMark=this._createMark(CY.mark.track),this._trackMark}_initTrackMarkStyle(){let t=this._trackMark;t&&("vertical"===this._spec.direction?this.setMarkStyle(t,{x:t=>{var e,i;return aa(this.dataToPositionX(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0),!0)-this._spec.bandWidth/2},y:0,width:this._spec.bandWidth,height:()=>this._scaleY.range()[0],cornerRadius:this._spec.cornerRadius},"normal",W.Series):this.setMarkStyle(t,{x:0,y:t=>{var e,i;return aa(this.dataToPositionY(t),null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0),!0)-this._spec.bandWidth/2},height:this._spec.bandWidth,width:()=>this._scaleX.range()[1],cornerRadius:this._spec.cornerRadius},"normal",W.Series))}getInteractionTriggers(){let t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)}initAnimation(){var t,e,i,r;let n={direction:this.direction},s=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._progressMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("linearProgress"))?void 0:i(n,s),cM("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("fadeInOut"))?void 0:r(),cM("track",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new CK(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark),this._trackMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._trackMark)}getActiveMarks(){return[this._progressMark]}}CY.type=rR.linearProgress,CY.mark=C$,CY.builtInTheme={linearProgress:{bandWidth:30,progress:{style:{fillOpacity:1}},track:{style:{fill:{type:"palette",key:"linearProgressTrackColor"},fillOpacity:1}}}};let CX=()=>{yi(),CU(),u5(),iv.registerSeries(CY.type,CY)};class Cq extends fH{needAxes(){return!1}_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t,["bandWidth","progress","track","clamp"]);return r.direction=null!=(e=t.direction)?e:"horizontal",r.cornerRadius=null!=(i=t.cornerRadius)?i:0,r}transformSpec(t){var e,i;if(super.transformSpec(t),t.axes||(t.axes=[]),"vertical"===t.direction){let i=null,r=null;(null!=(e=t.axes)?e:[]).forEach(t=>{let{orient:e}=t;"left"===e&&(i=t),"bottom"===e&&(r=t)}),i||(i={orient:"left",visible:!1},t.axes.push(i)),r||(r={orient:"bottom",visible:!1},t.axes.push(r)),er(r.type)&&(r.type="band"),er(i.type)&&(i.type="linear");let n=gg(i,{min:0,max:1});er(i.min)&&(i.min=n.min),er(i.max)&&(i.max=n.max)}else{let e=null,r=null;(null!=(i=t.axes)?i:[]).forEach(t=>{let{orient:i}=t;"left"===i&&(e=t),"bottom"===i&&(r=t)}),e||(e={type:"band",orient:"left",visible:!1},t.axes.push(e)),r||(r={orient:"bottom",visible:!1},t.axes.push(r)),er(r.type)&&(r.type="linear"),er(e.type)&&(e.type="band");let n=gg(r,{min:0,max:1});er(r.min)&&(r.min=n.min),er(r.max)&&(r.max=n.max)}}}class CJ extends fV{constructor(){super(...arguments),this.transformerConstructor=Cq,this.type="linearProgress",this.seriesType=rR.linearProgress}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}CJ.type="linearProgress",CJ.seriesType=rR.linearProgress,CJ.transformerConstructor=Cq,cG(CJ,fK);let CQ=()=>{mb(),mx(),f8(),fX(),CX(),iv.registerChart(CJ.type,CJ)};class C0 extends cs{constructor(){super(...arguments),this._getMeasureData=t=>"horizontal"===this.series.getSpec().direction?t[this.series.getSpec().xField[0]]+"-"+t[this.series.getSpec().xField[1]]:t[this.series.getSpec().yField[0]]+"-"+t[this.series.getSpec().yField[1]]}}let C1=t=>({type:"growCenterIn",options:{direction:"horizontal"===t.direction?"x":"y"}}),C2={type:"fadeIn"},C3=t=>({type:"growCenterOut",options:{direction:"horizontal"===t.direction?"x":"y"}}),C5=()=>{iv.registerAnimation("rangeColumn",(t,e)=>({appear:"fadeIn"===e?C2:C1(t),enter:C1(t),exit:C3(t),disappear:C3(t)}))},C4=Object.assign(Object.assign({},yr),{minLabel:{name:"minLabel",type:"text"},maxLabel:{name:"maxLabel",type:"text"}});class C6 extends ys{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){var e;"bothEnd"!==(null==(e=t.label)?void 0:e.position)&&this._addMarkLabelSpec(t,"bar")}}class C8 extends yl{constructor(){super(...arguments),this.type=rR.rangeColumn,this._barMarkType="rect",this._barName=rR.bar,this.transformerConstructor=C6}initMark(){var t,e,i,r,n,s,l,a;this._initBarBackgroundMark();let o=null==(t=this._spec.label)?void 0:t.position;this._barMark=this._createMark(C8.mark.bar,{groupKey:this._seriesField,isSeriesMark:!0},{morph:cR(this._spec,C8.mark.bar.name),morphElementKey:this.getDimensionField()[0]}),!1!==(null==(e=this._spec.label)?void 0:e.visible)&&"bothEnd"===o&&(!1!==(null==(r=null==(i=this._spec.label)?void 0:i.minLabel)?void 0:r.visible)&&(this._minLabelMark=this._createMark(C8.mark.minLabel,{markSpec:null==(n=this._spec.label)?void 0:n.minLabel})),!1!==(null==(l=null==(s=this._spec.label)?void 0:s.maxLabel)?void 0:l.visible)&&(this._maxLabelMark=this._createMark(C8.mark.maxLabel,{markSpec:null==(a=this._spec.label)?void 0:a.maxLabel})))}initMarkStyle(){var t,e;super.initMarkStyle(),this._initLabelMarkPos(this._minLabelMark,null==(t=this._spec.label)?void 0:t.minLabel,0,"end"),this._initLabelMarkPos(this._maxLabelMark,null==(e=this._spec.label)?void 0:e.maxLabel,1,"start")}_initLabelMarkPos(t,e,i,r){var n,s,l,a,o,h,u,d,c;if(t){this.setMarkStyle(t,{fill:null!=(s=null==(n=null==e?void 0:e.style)?void 0:n.fill)?s:this.getColorAttribute(),text:t=>{let r="horizontal"===this._spec.direction?t[this._spec.xField[i]]:t[this._spec.yField[i]];return(null==e?void 0:e.formatMethod)?e.formatMethod(r,t):r}});let p=null!=(l=null==e?void 0:e.position)?l:r,g=null!=(a=null==e?void 0:e.offset)?a:"vertical"===this._direction?-20:-25;o=t=>this._barMark.getAttribute("x",t),h=t=>"vertical"===this._direction?this._barMark.getAttribute("x",t)+this._barMark.getAttribute("width",t):this._barMark.getAttribute("x1",t),u=t=>this._barMark.getAttribute("y",t),d=t=>"vertical"===this._direction?this._barMark.getAttribute("y1",t):this._barMark.getAttribute("y",t)+this._barMark.getAttribute("height",t),c=()=>this._direction,this.setMarkStyle(t,{textAlign:t=>{if("vertical"===c())return"center";let e=o(t),i=h(t);if("middle"===p)return"center";if(e>=i){if("start"===p)return"left";if("end"===p)return"right";if("outside"===p)return"left"}else{if("start"===p)return"right";if("end"===p)return"left";if("outside"===p)return"right"}return"center"},textBaseline:t=>{if("horizontal"===c())return"middle";let e=u(t),i=d(t);if("middle"===p)return"middle";if(i>=e){if("start"===p)return"bottom";if("end"===p)return"top";if("outside"===p)return"bottom"}else{if("start"===p)return"top";if("end"===p)return"bottom";if("outside"===p)return"top"}return"middle"}}),this.setMarkStyle(t,{x:t=>{let e=c(),i=o(t),r=h(t);if("vertical"===e||"middle"===p)return(i+r)/2;if(i>=r){if("start"===p)return r+g;if("end"===p)return i-g;if("outside"===p)return i+g}else{if("start"===p)return r-g;if("end"===p)return i+g;if("outside"===p)return i-g}return(i+r)/2},y:t=>{let e=c(),i=u(t),r=d(t);if("horizontal"===e||"middle"===p)return(i+r)/2;if(i>=r){if("start"===p)return r+g;if("end"===p)return i-g;if("outside"===p)return i+g}else{if("start"===p)return r-g;if("end"===p)return i+g;if("outside"===p)return i-g}return(i+r)/2}},"normal",W.Series)}}initLabelMarkStyle(t){t&&(this.setMarkStyle(t,{text:t=>{let e,i;return"horizontal"===this._spec.direction?(e=t[this._spec.xField[0]],i=t[this._spec.xField[1]]):(e=t[this._spec.yField[0]],i=t[this._spec.yField[1]]),e+"-"+i},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._labelMark=t)}_dataToPosX(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[0]),{bandPosition:this._bandPosition})}_dataToPosX1(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})}_dataToPosY(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[0]),{bandPosition:this._bandPosition})}_dataToPosY1(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})}initAnimation(){var t,e,i,r,n;let s=cO(this),l=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._barMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("rangeColumn"))?void 0:i({direction:this.direction},l),cM("bar",this._spec,this._markAttributeContext),s)),this._minLabelMark&&this._minLabelMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("fadeInOut"))?void 0:r(),cM("label",this._spec,this._markAttributeContext),s)),this._maxLabelMark&&this._maxLabelMark.setAnimationConfig(cA(null==(n=iv.getAnimationInKey("fadeInOut"))?void 0:n(),cM("label",this._spec,this._markAttributeContext),s))}initTooltip(){this._tooltipHelper=new C0(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark),this._minLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._minLabelMark),this._maxLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._maxLabelMark),this._labelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._labelMark)}}C8.type=rR.rangeColumn,C8.mark=C4,C8.builtInTheme={rangeColumn:{label:{visible:!1,offset:5,position:"inside",style:{lineWidth:2,fill:{type:"palette",key:"axisMarkerFontColor"}},minLabel:{position:"end"},maxLabel:{position:"start"}}}},C8.transformerConstructor=C6;let C9=()=>{yi(),_B(),C5(),u5(),fl(),fb(),iv.registerSeries(C8.type,C8)};class C7 extends fH{_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar"]);return"horizontal"===t.direction?r.xField=null!=(e=t.xField)?e:[t.minField,t.maxField]:r.yField=null!=(i=t.yField)?i:[t.minField,t.maxField],r}transformSpec(t){super.transformSpec(t),sW(t)}}class wt extends fV{constructor(){super(...arguments),this.transformerConstructor=C7,this.type="rangeColumn",this.seriesType=rR.rangeColumn}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}wt.type="rangeColumn",wt.seriesType=rR.rangeColumn,wt.transformerConstructor=C7;let we=()=>{mb(),mx(),f8(),fX(),C9(),iv.registerChart(wt.type,wt)},wi=(t,e)=>Math.max(0,Math.min(1,(t-e[0])/(e[1]-e[0]||1))),wr=t=>{let e=t.filter(t=>t.context.diffState===N.update),i=eg(e.map(t=>{var e,i;return null==(i=null==(e=null==t?void 0:t.context)?void 0:e.data)?void 0:i[0].depth}));return e.filter(t=>{var e,r;return(null==(r=null==(e=null==t?void 0:t.context)?void 0:e.data)?void 0:r[0].depth)===i})},wn=(t,e,i)=>sD(t)?[e,i]:[eg(t.map(t=>+t.getFinalAttribute().startAngle)),ep(t.map(t=>+t.getFinalAttribute().endAngle))],ws=t=>({channel:{startAngle:{from:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),s=wn(wr(i.parent.children),r,n);return wi(i.getFinalAttribute().startAngle,s)*(n-r)+r},to:(t,e)=>e.getFinalAttribute().startAngle},endAngle:{from:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),s=wn(wr(i.parent.children),r,n);return wi(i.getFinalAttribute().endAngle,s)*(n-r)+r},to:(t,e)=>e.getFinalAttribute().endAngle},outerRadius:{from:(t,e)=>e.getFinalAttribute().innerRadius,to:(t,e)=>e.getFinalAttribute().outerRadius},innerRadius:{from:(t,e)=>e.getFinalAttribute().innerRadius,to:(t,e)=>e.getFinalAttribute().innerRadius}}}),wl=t=>[eg(t.map(t=>+t.getFinalAttribute().startAngle)),ep(t.map(t=>+t.getFinalAttribute().endAngle))],wa=t=>({channel:{startAngle:{from:(t,e)=>e.getFinalAttribute().startAngle,to:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),s=wl(wr(i.parent.children));return wi(i.getFinalAttribute().startAngle,s)*(n-r)+r}},endAngle:{from:(t,e)=>e.getFinalAttribute().endAngle,to:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),s=wl(wr(i.parent.children));return wi(i.getFinalAttribute().endAngle,s)*(n-r)+r}},outerRadius:{from:(t,e)=>e.getFinalAttribute().outerRadius,to:()=>t.animationInfo().innerRadius},innerRadius:{from:(t,e)=>e.getFinalAttribute().innerRadius,to:()=>t.animationInfo().innerRadius}}}),wo=(t,e)=>{switch(e){case"fadeIn":return{type:"fadeIn"};case"growAngle":return{type:"growAngleIn"};default:return{type:"growRadiusIn"}}},wh=()=>{iv.registerAnimation("sunburst",(t,e)=>({appear:wo(t,e),enter:ws(t),exit:wa(t),disappear:wa(t)}))};function wu(t){if(en(t))return t;let e=+t;return en(e)?e:0}let wd=(t,e,i=0,r=-1,n,s,l="value")=>{let a=0,o=null!=r?r:-1,h=i;return t.forEach((t,r)=>{var u,d;let c={flattenIndex:++o,key:s?s(t):`${null!=(u=null==n?void 0:n.key)?u:""}-${r}`,maxDepth:-1,depth:i,index:r,value:t[l],isLeaf:!0,datum:n?n.datum.concat(t):[t],parentKey:null==n?void 0:n.key};if(null==(d=t.children)?void 0:d.length){c.children=[],c.isLeaf=!1;let e=wd(t.children,c.children,i+1,o,c,s,l);c.value=er(t[l])?e.sum:Math.max(e.sum,wu(t[l])),o=e.flattenIndex,h=Math.max(e.maxDepth,h)}else c.isLeaf=!0,c.value=wu(t[l]);a+=Math.abs(c.value),e.push(c)}),{sum:a,maxDepth:h,flattenIndex:o}},wc=(t,e,i,r)=>{let n=r;return t.forEach((t,r)=>{var s;n=e(t,r,i,n),(null==(s=t.children)?void 0:s.length)&&(n=wc(t.children,e,t,n))}),r},wp=(t,e,i,r)=>{let n=r;return t.forEach((t,r)=>{var s;(null==(s=t.children)?void 0:s.length)&&(n=wp(t.children,e,t,n)),n=e(t,r,i,n)}),n},wg=(t,e=[],i)=>{let r=(null==i?void 0:i.maxDepth)>=0;return t.forEach(t=>{(!r||t.depth<=i.maxDepth)&&(e.push((null==i?void 0:i.callback)?i.callback(t):t),t.children&&(r&&t.depth===i.maxDepth?(t.children=null,t.isLeaf=!0):wg(t.children,e,i)))}),e},wf=(t,e={})=>{if(!t)return[];let i=[];return wg(t,i,e),i};function wm(t,e,i,r,n,s={x0:"x0",x1:"x1",y0:"y0",y1:"y1"}){let l=t.children,a,o=-1,h=l.length,u=t.value&&(r-e)/t.value;for(;++o<h;)(a=l[o])[s.y0]=i,a[s.y1]=n,a[s.x0]=e,a[s.x1]=e+=a.value*u}let wy=(t,e)=>er(t)?e:t6(t)?e*parseFloat(t)/100:t,wv={x0:"startAngle",x1:"endAngle",y0:"innerRadius",y1:"outerRadius"};class wb{constructor(t){this._layoutNode=t=>{if(t.maxDepth=this._maxDepth,t.children){let e=this._parsedInnerRadius[t.depth+1],i=this._parsedOutterRadius[t.depth+1];wm(t,t.startAngle,Math.min(e,i),t.endAngle,Math.max(e,i),wv);let r=tq(this.options.label)?this.options.label[t.depth+1]:this.options.label;t.children.forEach(t=>{if(t.x=this._parsedCenter[0],t.y=this._parsedCenter[1],r)return this._layoutLabel(t,tX(r)?{align:"center",rotate:"radial"}:r)})}},this.options=t?Object.assign({},wb.defaultOpionts,t):Object.assign({},wb.defaultOpionts);let e=this.options.nodeKey,i=tQ(e)?e:e?Ct(e):null;this._getNodeKey=i,this._maxDepth=-1}_parseRadius(t,e){let i=t.x0+wy(this.options.center[0],t.width),r=t.y0+wy(this.options.center[1],t.height),n=Math.min(t.width/2,t.height/2),s=this.options.innerRadius,l=this.options.outerRadius,a=tq(s),o=a?s.map(t=>wy(t,n)):wy(s,n),h=tq(l),u=this.options.gapRadius,d=h?l.map(t=>wy(t,n)):wy(l,n),c=la(0,e+1);if(a)this._parsedInnerRadius=c.map((t,e)=>{let i=o[e];return er(i)?n:i}),this._parsedOutterRadius=c.map((t,i)=>{var r,s;return h?null!=(r=d[i])?r:n:i<e?this._parsedInnerRadius[i+1]-(tq(u)?null!=(s=u[i])?s:0:u):d});else if(h)this._parsedOutterRadius=c.map((t,e)=>er(d[e])?n:d[e]),this._parsedInnerRadius=c.map((t,e)=>{var i;return 0===e?o:this._parsedOutterRadius[e-1]-(tq(u)?null!=(i=u[e])?i:0:u)});else{let t=wy(s,n),i=(d-t)/(e+1);this._parsedInnerRadius=c.map((e,r)=>t+r*i),this._parsedOutterRadius=c.map((t,e)=>{var r;return this._parsedInnerRadius[e]+i-(tq(u)?null!=(r=u[e])?r:0:u)})}this._parsedCenter=[i,r],this._maxRadius=n}layout(t,e){let i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];let r=[],n=wd(t,r,0,-1,null,this._getNodeKey);return this._parseRadius(i,n.maxDepth),this._maxDepth=n.maxDepth,this._layout(r,{flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:n.sum,datum:null,children:r,startAngle:this.options.startAngle,endAngle:this.options.endAngle}),r}_layout(t,e){this._layoutNode(e),t.forEach(t=>{var e;(null==(e=null==t?void 0:t.children)?void 0:e.length)?this._layout(t.children,t):this._layoutNode(t)})}_layoutLabel(t,e){var i;let r=(t.startAngle+t.endAngle)/2,n=("start"===e.align?t.innerRadius:"end"===e.align?t.outerRadius:(t.innerRadius+t.outerRadius)/2)+(null!=(i=e.offset)?i:0),s=ay({x:this._parsedCenter[0],y:this._parsedCenter[1]},n,r);if(t.label={x:s.x,y:s.y,textBaseline:"middle"},"tangential"===e.rotate)t.label.angle=r-Math.PI/2,t.label.textAlign="center",t.label.maxLineWidth=Math.abs(t.endAngle-t.startAngle)*n;else{let i=r%(2*Math.PI),n=i<0?i+2*Math.PI:i;n>Math.PI/2&&n<1.5*Math.PI?(t.label.angle=n+Math.PI,t.label.textAlign="start"===e.align?"end":"end"===e.align?"start":"center"):(t.label.angle=n,t.label.textAlign=e.align),t.label.maxLineWidth=t.isLeaf?void 0:Math.abs(t.outerRadius-t.innerRadius)}}}wb.defaultOpionts={startAngle:Math.PI/2,endAngle:-3*Math.PI/2,center:["50%","50%"],gapRadius:0,innerRadius:0,outerRadius:"70%"};let w_=(t,e)=>{if(!t)return t;let i=e(),{width:r,height:n}=i;return new wb(i).layout(t,{width:r,height:n})};class wC extends cs{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>null==t?void 0:t[this.series.getDimensionField()[0]]}}let ww=(t,e,i="key",r="children")=>{for(let n=0;n<t.length;n++){let s=t[n];if(s[i]===e)return s;if(s[r]){let t=ww(s[r],e,i,r);if(t)return t}}return null},wS=(t,e,i="key",r="children")=>{for(let n=0;n<t.length;n++){let s=t[n];if(s[r])for(let t=0;t<s[r].length;t++){let n=s[r][t];if(n[i]===e)return s;let l=wS([n],e,i,r);if(l)return l}}return null},wA=(t,e,i="key",r="children")=>{let n=[],s=(t,l)=>{for(let a of t){if(a[i]===e)return n.push(...l,a[i].toString()),!0;if(a[r]){let t=s(a[r],[...l,a[i]]);if(!0===t)return t}}return!1};return s(t,[]),n};(E=q||(q={})).DrillDown="drillDown",E.DrillUp="drillUp";let wM=(t,e)=>{let i=e.info(),r=e.keyField(),n=null==i?void 0:i.key;if(er(n))return t;if(i.type===q.DrillDown)return ed(ww(t,n,r,"children"));if(i.type===q.DrillUp){let e=wS(t,n,r,"children");if(e)return ed(e)}return t};class wk{_getDrillTriggerEvent(t){var e;let{mode:i}=this._drillParams;return null==(e=vV(i))?void 0:e[t]}_hideTooltip(){let t=this.getChart().getComponentsByType(rk.tooltip)[0];t&&t.hideTooltip()}initDrillable(t){this._drillParams=t}initDrillableData(t){let{getRawData:e}=this._drillParams;nq(t,"drillFilter",wM),e().transform({type:"drillFilter",options:{info:()=>this._drillInfo,keyField:()=>this._drillParams.drillField()}})}bindDrillEvent(){let{event:t,getRawData:e,drillField:i}=this._drillParams,r=i();this._getDrillTriggerEvent("start")&&t.on(this._getDrillTriggerEvent("start"),t=>{var i,n,s;if(er(t.datum)||er(null==(i=t.datum)?void 0:i[r]))return void this.drillUp();this._hideTooltip();let l=t.datum[r],a=null!=(s=null==(n=this._drillInfo)?void 0:n.path)?s:[],o=wA(e().rawData,l,r,"children");a[a.length-1]===o[o.length-1]?this.drillUp():this.drillDown(o)})}drillDown(t=[]){let{getRawData:e,event:i}=this._drillParams;if(!tq(t)||sD(t))return t;let r=t[t.length-1];return this._drillInfo={key:r,path:t,type:q.DrillDown},e().reRunAllTransform(),i.emit(rI.drill,{value:{path:t,type:q.DrillDown},model:this}),t}drillUp(){var t,e;let{getRawData:i,event:r}=this._drillParams,n=null!=(e=null==(t=this._drillInfo)?void 0:t.path)?e:[];if(!tq(n)||sD(n))return n;let s=n.pop();return this._drillInfo={key:s,path:n,type:q.DrillUp},i().reRunAllTransform(),r.emit(rI.drill,{value:{path:n,type:q.DrillUp},model:this}),n}}let wT=Object.assign(Object.assign({},cy),{sunburst:{name:"sunburst",type:"arc"}}),wR=(t,e,i)=>(t.push({key:e,operations:["values"]}),t.push({key:i,operations:["max","min"]}),t.push({key:cu,operations:["max","min","values"]}),t.push({key:cd,operations:["values"]}),t);class wB extends v1{constructor(){super(...arguments),this.type=rR.sunburst}setCategoryField(t){return this._categoryField=t,this._categoryField}getCategoryField(){return this._categoryField}setValueField(t){return this._valueField=t,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:cd),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t;return null!=(t=this._spec.drillField)?t:ss},getRawData:()=>this.getRawData()}),this._startAngle=af(this._spec.startAngle),this._endAngle=af(this._spec.endAngle),this._centerX=this._spec.centerX,this._centerY=this._spec.centerY,this._offsetX=this._spec.offsetX,this._offsetY=this._spec.offsetY,this.__innerRadius=this._spec.innerRadius,this.__outerRadius=this._spec.outerRadius,this._gap=this._spec.gap,this._labelLayout=this._spec.labelLayout,this._sunburst=this._spec.sunburst,this._label=this._spec.label,this._labelAutoVisible=this._spec.labelAutoVisible}initData(){super.initData();let t=this.getRawData();t&&(this._spec.drill&&this.initDrillableData(this._dataSet),nq(this._dataSet,"sunburstLayout",w_),nq(this._dataSet,"flatten",wf),t.transform({type:"sunburstLayout",options:()=>{let{innerRadius:t,outerRadius:e,gap:i,label:r}=this._computeLevel();return{nodeKey:this._categoryField,width:this.getLayoutRect().width,height:this.getLayoutRect().height,center:[t8(this._centerX)?this._centerX:this.getLayoutRect().width/2,t8(this._centerY)?this._centerY:this.getLayoutRect().height/2],startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:t,outerRadius:e,gapRadius:i,label:r}}}),t.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}}))}getStatisticFields(){return wR(super.getStatisticFields(),this._categoryField,this._valueField)}_addDataIndexAndKey(){let t=this.getRawData();er(null==t?void 0:t.dataSet)||(nq(t.dataSet,"addVChartProperty",d2),t.transform({type:"addVChartProperty",options:{beforeCall:cf.bind(this),call:cm}}))}initMark(){this._initArcMark(),this._initLabelMark()}initMarkStyle(){this._initArcMarkStyle(),this._initLabelMarkStyle()}_initArcMark(){if(!1===this._sunburst.visible)return;let t=this._createMark(wB.mark.sunburst,{isSeriesMark:!0});this._sunburstMark=t}_initArcMarkStyle(){er(this._sunburstMark)||this.setMarkStyle(this._sunburstMark,{x:t=>t.x+(t8(this._offsetX)?this._offsetX:0),y:t=>t.y+(t8(this._offsetY)?this._offsetY:0),outerRadius:t=>t.outerRadius,innerRadius:t=>t.innerRadius,startAngle:t=>t.startAngle,endAngle:t=>t.endAngle,fill:this.getColorAttribute()},j.STATE_NORMAL,W.Series)}_initLabelMark(){if(!0!==this._label.visible)return;let t=this._createMark(wB.mark.label,{isSeriesMark:!1});this._labelMark=t}_initLabelMarkStyle(){er(this._labelMark)||this.setMarkStyle(this._labelMark,{visible:t=>{var e;let i=this._labelAutoVisible;return e_(i)&&!0===i.enable?(t.endAngle-t.startAngle)*(t.outerRadius-t.innerRadius)>(null!=(e=null==i?void 0:i.circumference)?e:10):this._spec.label.visible},x:t=>{var e;return(null==(e=t.label)?void 0:e.x)+(t8(this._offsetX)?this._offsetX:0)},y:t=>{var e;return(null==(e=t.label)?void 0:e.y)+(t8(this._offsetY)?this._offsetY:0)},textBaseline:t=>{var e;return null==(e=t.label)?void 0:e.textBaseline},textAlign:t=>{var e;return null==(e=t.label)?void 0:e.textAlign},angle:t=>{var e,i;return null!=(i=null==(e=t.label)?void 0:e.angle)?i:0},fontSize:10,text:t=>t.name},j.STATE_NORMAL,W.Series)}initTooltip(){this._tooltipHelper=new wC(this),this._sunburstMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._sunburstMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var t,e;let i={animationInfo:()=>({innerRadius:this._computeRadius(ed(this.__innerRadius))[0],outerRadius:this._computeRadius(ed(this.__outerRadius))[0],startAngle:ed(this._startAngle)[0],endAngle:ed(this._endAngle)[0]})},r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this.getMarksInType("arc").forEach(t=>{var e;t.setAnimationConfig(cA(null==(e=iv.getAnimationInKey("sunburst"))?void 0:e(i,r),cM(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(t=>{var e;t.setAnimationConfig(cA(null==(e=iv.getAnimationInKey("fadeInOut"))?void 0:e(),cM(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(){super.onLayoutEnd(),this._rawData.reRunAllTransform()}_computeRadius(t){return tq(t)?t.map(t=>this._computeLayoutRadius()*t):this._computeLayoutRadius()*t}_computeLevel(){return{innerRadius:this._computeRadius(this.__innerRadius),outerRadius:this._computeRadius(this.__outerRadius),gap:this._gap,label:this._labelLayout}}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._sunburstMark]}getMarkData(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t}}wB.type=rR.sunburst,wB.mark=wT,wB.builtInTheme={sunburst:{innerRadius:0,outerRadius:1,startAngle:-90,endAngle:270,gap:0,labelLayout:{align:"center",offset:0,rotate:"radial"},sunburst:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1,cursor:"pointer"}},label:{visible:!0,style:{cursor:"pointer",fill:{type:"palette",key:"primaryFontColor"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},cG(wB,wk);let wP=()=>{iv.registerSeries(wB.type,wB),bp(),_B(),u5(),wh()};class wE extends fD{_getDefaultSeriesSpec(t){let e=t8(t.startAngle)?t.startAngle:-90,i=t8(t.endAngle)?t.endAngle:e+am(2*Math.PI),r=super._getDefaultSeriesSpec(t,["categoryField","valueField","centerX","centerY","offsetX","offsetY","innerRadius","outerRadius","gap","labelLayout","label","labelAutoVisible","drill","drillField"]);return r.startAngle=e,r.endAngle=i,r}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class wI extends fV{constructor(){super(...arguments),this.transformerConstructor=wE,this.type="sunburst",this.seriesType=rR.sunburst}}wI.type="sunburst",wI.seriesType=rR.sunburst,wI.transformerConstructor=wE;let wL=()=>{mx(),wP(),iv.registerChart(wI.type,wI)};function wF(t,e){let i=t.radius-e.radius,r=e.x-t.x,n=e.y-t.y;return i<0||i*i<r*r+n*n}function wO(t,e){let i=t.radius-e.radius+1e-9*Math.max(t.radius,e.radius,1),r=e.x-t.x,n=e.y-t.y;return i>0&&i*i>r*r+n*n}function wD(t,e){for(let i=0;i<e.length;++i)if(!wO(t,e[i]))return!1;return!0}function wH(t,e){let i=t.x,r=t.y,n=t.radius,s=e.x,l=e.y,a=e.radius,o=s-i,h=l-r,u=a-n,d=Math.sqrt(o*o+h*h);return{x:(i+s+o/d*u)/2,y:(r+l+h/d*u)/2,radius:(d+n+a)/2}}function wz(t,e,i){let r=t.x,n=t.y,s=t.radius,l=e.x,a=e.y,o=e.radius,h=i.x,u=i.y,d=i.radius,c=r-l,p=r-h,g=n-a,f=n-u,m=o-s,y=d-s,v=r*r+n*n-s*s,b=v-l*l-a*a+o*o,_=v-h*h-u*u+d*d,x=p*g-c*f,C=(g*_-f*b)/(2*x)-r,w=(f*m-g*y)/x,S=(p*b-c*_)/(2*x)-n,A=(c*y-p*m)/x,M=w*w+A*A-1,k=2*(s+C*w+S*A),T=C*C+S*S-s*s,R=-(Math.abs(M)>1e-6?(k+Math.sqrt(k*k-4*M*T))/(2*M):T/k);return{x:r+C+w*R,y:n+S+A*R,radius:R}}function wW(t,e,i){let r,n,s,l,a=t.x-e.x,o=t.y-e.y,h=a*a+o*o;h?(n=e.radius+i.radius,n*=n,l=t.radius+i.radius,n>(l*=l)?(r=(h+l-n)/(2*h),s=Math.sqrt(Math.max(0,l/h-r*r)),i.x=t.x-r*a-s*o,i.y=t.y-r*o+s*a):(r=(h+n-l)/(2*h),s=Math.sqrt(Math.max(0,n/h-r*r)),i.x=e.x+r*a-s*o,i.y=e.y+r*o+s*a)):(i.x=e.x+i.radius,i.y=e.y)}function wN(t,e){let i=t.radius+e.radius-1e-6,r=e.x-t.x,n=e.y-t.y;return i>0&&i*i>r*r+n*n}function wj(t){let e=t._,i=t.next._,r=e.radius+i.radius,n=(e.x*i.radius+i.x*e.radius)/r,s=(e.y*i.radius+i.y*e.radius)/r;return n*n+s*s}function wG(t){return{_:t,next:null,prev:null}}let wV=t=>0;function wZ(t){return function(e){e.children||(e.radius=Math.max(0,+t(e)||0))}}function wU(t,e,i){return function(r){let n=null==r?void 0:r.children;if(n){let s,l=n.length,a=t(r)*e||0;if(a)for(s=0;s<l;++s)n[s].radius+=a;let o=function(t,e){let i=(t=ed(t)).length;if(!i)return 0;let r=t[0];if(r.x=0,r.y=0,1===i)return r.radius;let n=t[1];if(r.x=-n.radius,n.x=r.radius,n.y=0,2===i)return r.radius+n.radius;let s=t[2];wW(n,r,s);let l,a,o,h,u,d,c,p=wG(r),g=wG(n),f=wG(s);p.next=g,f.prev=g,g.next=f,p.prev=f,f.next=p,g.prev=p;for(let e=3;e<i;++e){c=!1,s=t[e],wW(p._,g._,s),f=wG(s),l=g.next,a=p.prev,o=g._.radius,h=p._.radius;do if(o<=h){if(wN(l._,f._)){g=l,p.next=g,g.prev=p,--e,c=!0;break}o+=l._.radius,l=l.next}else{if(wN(a._,f._)){(p=a).next=g,g.prev=p,--e,c=!0;break}h+=a._.radius,a=a.prev}while(l!==a.next);if(!c){for(f.prev=p,f.next=g,p.next=g.prev=g=f,u=wj(p),f=f.next;f!==g;)(d=wj(f))<u&&(p=f,u=d),f=f.next;g=p.next}}let m=[g._];for(f=g.next;f!==g;)m.push(f._),f=f.next;s=function(t,e){let i=0,r=ef(Array.from(t),e),n=r.length,s,l,a=[];for(;i<n;)s=r[i],l&&wO(l,s)?++i:(l=function(t){switch(t.length){case 1:var e;return{x:(e=t[0]).x,y:e.y,radius:e.radius};case 2:return wH(t[0],t[1]);case 3:return wz(t[0],t[1],t[2])}}(a=function(t,e){let i,r;if(wD(e,t))return[e];for(i=0;i<t.length;++i)if(wF(e,t[i])&&wD(wH(t[i],e),t))return[t[i],e];for(i=0;i<t.length-1;++i)for(r=i+1;r<t.length;++r)if(wF(wH(t[i],t[r]),e)&&wF(wH(t[i],e),t[r])&&wF(wH(t[r],e),t[i])&&wD(wz(t[i],t[r],e),t))return[t[i],t[r],e];tU.getInstance().error("error when packEncloseRandom")}(a,s)),i=0);return l}(m,e);for(let e=0;e<i;++e)r=t[e],r.x-=s.x,r.y-=s.y;return s.radius}(n,i);if(a)for(s=0;s<l;++s)n[s].radius-=a;r.radius=o+a}}}function wK(t,e){return function(i,r,n){i.radius*=t,i.maxDepth=e,n&&(i.x=n.x+t*i.x,i.y=n.y+t*i.y)}}class w${constructor(t){this.options=t;let e=null==t?void 0:t.nodeKey,i=tQ(e)?e:e?Ct(e):null;this._getNodeKey=i,this._getPadding=tG(null==t?void 0:t.padding)?e=>t.padding:tq(null==t?void 0:t.padding)?e=>{var i;return null!=(i=t.padding[e.depth+1])?i:0}:()=>0,this._maxDepth=-1}layout(t,e){var i;let r="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];let n=[],s=wd(t,n,0,-1,null,this._getNodeKey);this._maxDepth=s.maxDepth;let l=function(t=1){let e=t;return()=>(e=(1664525*e+0x3c6ef35f)%0x100000000)/0x100000000}(),a={flattenIndex:-1,maxDepth:-1,key:"root",depth:-1,index:-1,value:s.sum,datum:null,children:n,x:r.x0+r.width/2,y:r.y0+r.height/2},{nodeSort:o,setRadius:h,padding:u,includeRoot:d}=null!=(i=this.options)?i:{};if(!1!==o){let t=tQ(o)?this.options.nodeKey:w$.defaultOpionts.nodeSort;wc([a],e=>{e.children&&e.children.length&&e.children.sort(t)})}if(h)wc([a],wZ(h)),wp([a],wU(this._getPadding,.5,l)),wc([a],wK(1,this._maxDepth));else{let t=Math.min(r.width,r.height);wc([a],wZ(w$.defaultOpionts.setRadius)),wp([a],wU(wV,1,l)),u&&wp([a],wU(this._getPadding,a.radius/t,l)),wc([a],wK(t/(2*a.radius),this._maxDepth))}return d?[a]:n}}w$.defaultOpionts={setRadius:t=>Math.sqrt(t.value),padding:0,nodeSort:(t,e)=>e.value-t.value};let wY=(t,e)=>{if(!t)return t;let i=e(),{width:r,height:n}=i;return 0===r||0===n?t:new w$(i).layout(t,{width:r,height:n})};class wX extends cs{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>null==t?void 0:t[this.series.getDimensionField()[0]]}}let wq=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"growRadiusIn"},wJ=()=>{iv.registerAnimation("circlePacking",(t,e)=>({appear:wq(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}))},wQ=Object.assign(Object.assign({},cy),{circlePacking:{name:"circlePacking",type:"arc"}});class w0 extends cD{constructor(){super(...arguments),this.type=rR.circlePacking}setCategoryField(t){return this._categoryField=t,this._categoryField}getCategoryField(){return this._categoryField}setValueField(t){return this._valueField=t,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:cd),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t;return null!=(t=this._spec.drillField)?t:ss},getRawData:()=>this.getRawData()}),this._circlePacking=this._spec.circlePacking,this._label=this._spec.label,this._layoutPadding=this._spec.layoutPadding}initData(){super.initData();let t=this.getRawData();er(t)||(this._spec.drill&&this.initDrillableData(this._dataSet),nq(this._dataSet,"circlePackingLayout",wY),nq(this._dataSet,"flatten",wf),t.transform({type:"circlePackingLayout",options:()=>({nodeKey:this._categoryField,padding:this._layoutPadding,includeRoot:!1,width:this.getLayoutRect().width||1,height:this.getLayoutRect().height||1})}),t.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}}))}_addDataIndexAndKey(){let t=this.getRawData();er(null==t?void 0:t.dataSet)||(nq(t.dataSet,"addVChartProperty",d2),t.transform({type:"addVChartProperty",options:{beforeCall:cf.bind(this),call:cm}}))}initMark(){this._initCirclePackingMark(),this._initLabelMark()}initMarkStyle(){this._initCirclePackingMarkStyle(),this._initLabelMarkStyle()}_initCirclePackingMark(){var t;if(!1===(null==(t=this._circlePacking)?void 0:t.visible))return;let e=this._createMark(w0.mark.circlePacking,{isSeriesMark:!0});this._circlePackingMark=e}_initCirclePackingMarkStyle(){er(this._circlePackingMark)||this.setMarkStyle(this._circlePackingMark,{x:t=>t.x,y:t=>t.y,outerRadius:t=>t.radius,innerRadius:0,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),zIndex:t=>t.depth},j.STATE_NORMAL,W.Series)}_initLabelMark(){var t;if(!1===(null==(t=this._label)?void 0:t.visible))return;let e=this._createMark(w0.mark.label,{isSeriesMark:!1});this._labelMark=e}_initLabelMarkStyle(){er(this._labelMark)||this.setMarkStyle(this._labelMark,{x:t=>t.x,y:t=>t.y,text:t=>t.key,cursor:"pointer"},j.STATE_NORMAL,W.Series)}getStatisticFields(){return wR(super.getStatisticFields(),this._categoryField,this._valueField)}initTooltip(){this._tooltipHelper=new wX(this),this._circlePackingMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circlePackingMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var t;let e=null==(t=this._spec.animationAppear)?void 0:t.preset;this.getMarksInType("arc").forEach(t=>{var i;t.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("circlePacking"))?void 0:i(void 0,e),cM(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(t=>{var e;t.setAnimationConfig(cA(null==(e=iv.getAnimationInKey("scaleInOut"))?void 0:e(),cM(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(){super.onLayoutEnd(),this._rawData.reRunAllTransform()}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._circlePackingMark]}getMarkData(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t}}w0.type=rR.circlePacking,w0.mark=wQ,w0.builtInTheme={circlePacking:{layoutPadding:5,circlePacking:{visible:!0,style:{cursor:"pointer",lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},label:{visible:!0,style:{cursor:"pointer",fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},cG(w0,wk);let w1=()=>{iv.registerSeries(w0.type,w0),bp(),_B(),u3(),wJ()};class w2 extends fD{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","layoutPadding","circlePacking","drill","drillField"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class w3 extends fV{constructor(){super(...arguments),this.transformerConstructor=w2,this.type="circlePacking",this.seriesType=rR.circlePacking}}w3.type="circlePacking",w3.seriesType=rR.circlePacking,w3.transformerConstructor=w2;let w5=()=>{mx(),w1(),iv.registerChart(w3.type,w3)},w4=(t,e)=>{let i=e.fields;return(tQ(i)&&(i=i()),(null==i?void 0:i.length)&&(null==t?void 0:t.length)&&t[0].latestData)?ca([{latestData:wf(t[0].latestData)}],e):{}};class w6 extends cs{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>{var e,i;return null==(i=null==(e=this.series)?void 0:e.getMarkData(t))?void 0:i[this.series.getDimensionField()[0]]},this.markTooltipValueCallback=t=>{var e,i;let{measureFields:r}=this._seriesCacheInfo,n=null==(e=this.series)?void 0:e.getMarkData(t);if(r[0]&&n)return null!=(i=n[r[0]])?i:t.value},this.dimensionTooltipTitleCallback=t=>{var e;let{dimensionFields:i}=this._seriesCacheInfo,r=null==(e=this.series)?void 0:e.getMarkData(t);if(i[0]&&r)return r[i[0]]}}get defaultShapeType(){return"square"}}let w8=Object.assign(Object.assign({},cy),{nonLeaf:{name:"nonLeaf",type:"rect"},leaf:{name:"leaf",type:"rect"},nonLeafLabel:{name:"nonLeafLabel",type:"text"}}),w9=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"growCenterIn"},w7=()=>{iv.registerAnimation("treemap",(t,e)=>({appear:w9(e),enter:{type:"growCenterIn"},exit:{type:"growCenterOut"},disappear:{type:"growCenterOut"}}))};class St extends cE{_transformLabelSpec(t){this._addMarkLabelSpec(t,"nonLeaf","nonLeafLabel","initNonLeafLabelMarkStyle"),this._addMarkLabelSpec(t,"leaf")}}let Se=()=>{iv.registerGrammarTransform("filter",{transform:(t,e)=>null==e?void 0:e.filter(t.callback)})},Si=()=>{iv.registerGrammarTransform("map",{transform:(t,e)=>(null==e||e.forEach((e,i)=>{t.callback(e)}),e)})};function Sr(t,e,i,r,n){let s=t.children,l,a=-1,o=s.length,h=t.value&&(n-i)/t.value;for(;++a<o;)(l=s[a]).x0=e,l.x1=r,l.y0=i,i+=l.value*h,l.y1=i}let Sn=t=>(e,i,r,n,s)=>{!function(t,e,i,r,n,s){let l=[],a=e.children,o,h,u=0,d=0,c=a.length,p,g,f,m,y,v,b,_,x,C=e.value;for(;u<c;){p=n-i,g=s-r;do f=a[d++].value;while(!f&&d<c);for(m=f,b=Math.max((y=f)/(x=f*f*(_=Math.max(g/p,p/g)/(C*t))),x/m);d<c;++d){if(f+=h=a[d].value,h<m&&(m=h),h>y&&(y=h),(v=Math.max(y/(x=f*f*_),x/m))>b){f-=h;break}b=v}o=Object.assign({},e,{value:f,children:a.slice(u,d)}),l.push(o),p<g?wm(o,i,r,n,C?r+=g*f/C:s):Sr(o,i,r,C?i+=p*f/C:n,s),C-=f,u=d}}(t,e,i,r,n,s)},Ss={binary:function(t,e,i,r,n){let s=t.children,l=s.length,a=0,o=Array(l+1);o[0]=0;for(let t=0;t<l;++t)a+=s[t].value,o[t+1]=a;let h=(t,e,i,r,n,l,a)=>{if(t>=e-1){let e=s[t];return e.x0=r,e.y0=n,e.x1=l,void(e.y1=a)}let u=o[t],d=i/2+u,c=t+1,p=e-1;for(;c<p;){let t=c+p>>>1;o[t]<d?c=t+1:p=t}d-o[c-1]<o[c]-d&&t+1<c&&--c;let g=o[c]-u,f=i-g;if(l-r>a-n){let s=i?(r*f+l*g)/i:l;h(t,c,g,r,n,s,a),h(c,e,f,s,n,l,a)}else{let s=i?(n*f+a*g)/i:a;h(t,c,g,r,n,l,s),h(c,e,f,r,s,l,a)}};h(0,l,t.value,e,i,r,n)},dice:wm,slice:Sr,sliceDice:function(t,e,i,r,n){(t.depth%2==1?Sr:wm)(t,e,i,r,n)}};class Sl{constructor(t){var e;this._filterByArea=(t,e)=>{var i;let r=this._getMinAreaByDepth(t.depth);if(r>0&&t.value*e<r)return!1;if(null==(i=t.children)?void 0:i.length){let i=t.children.filter(t=>this._filterByArea(t,e));i.length?i.length!==t.children.length&&(t.children=i):(t.isLeaf=!0,t.children=null)}return!0},this._getMinAreaByDepth=t=>{var e;return t<0?0:null!=(e=tq(this.options.minVisibleArea)?this.options.minVisibleArea[t]:this.options.minVisibleArea)?e:0},this._getGapWidthByDepth=t=>{var e;return t<0?0:null!=(e=tq(this.options.gapWidth)?this.options.gapWidth[t]:this.options.gapWidth)?e:0},this._getPaddingByDepth=t=>{var e;return t<0?0:null!=(e=tq(this.options.padding)?this.options.padding[t]:this.options.padding)?e:0},this._getLabelPaddingByDepth=t=>{var e;return t<0?0:null!=(e=tq(this.options.labelPadding)?this.options.labelPadding[t]:this.options.labelPadding)?e:0},this._layoutNode=t=>{let e=this._getGapWidthByDepth(t.depth),i=t.x0,r=t.y0,n=t.x1,s=t.y1;if(t.maxDepth=this._maxDepth,e>0&&(i+=e/2,n-=e/2,r+=e/2,s-=e/2,i>n&&(n=i=(i+n)/2),r>s&&(s=r=(r+s)/2),t.x0=i,t.x1=n,t.y0=r,t.y1=s),t.children){let e=this._getLabelPaddingByDepth(t.depth),l=this._getPaddingByDepth(t.depth);l>0&&l<Math.min(n-i,s-r)/2&&(r+=l,s-=l,i+=l,n-=l),e>0&&("top"===this.options.labelPosition&&r+e<s?(t.labelRect={x0:i,y0:r,x1:n,y1:r+e},r+=e):"bottom"===this.options.labelPosition&&s-e>r?(t.labelRect={x0:i,y0:s-e,x1:n,y1:s},s-=e):"left"===this.options.labelPosition&&i+e<n?(t.labelRect={x0:i,y0:r,x1:i+e,y1:s},i+=e):"right"===this.options.labelPosition&&n-e>i&&(t.labelRect={x0:n-e,y0:r,x1:n,y1:s},n-=e));let a=this._getGapWidthByDepth(t.depth+1);a>0&&(i-=a/2,n+=a/2,r-=a/2,s+=a/2),this._splitNode(t,i,r,n,s)}},this.options=Object.assign({},Sl.defaultOpionts,t);let i=this.options.nodeKey,r=tQ(i)?i:i?Ct(i):null;this._getNodeKey=r,this._splitNode="squarify"===this.options.splitType?Sn(this.options.aspectRatio):null!=(e=Ss[this.options.splitType])?e:Ss.binary,this._maxDepth=-1}layout(t,e){var i;if(!t||!t.length)return[];let r="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},n=[],s=wd(t,n,0,-1,null,this._getNodeKey,this.options.valueField);if(this._maxDepth=s.maxDepth,s.sum<=0)return[];let l={flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:s.sum,datum:null,x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1,children:n},a=r.width*r.height/s.sum;return this._filterByArea(l,a),this._layout(l),null!=(i=l.children)?i:[]}_filterChildren(t){let e=this.options.maxDepth;if(tG(e)&&e>=0&&t.depth>=e)return!1;let i=this.options.minChildrenVisibleArea;if(tG(i)&&Math.abs((t.x1-t.x0)*(t.y1-t.y0))<i)return!1;let r=this.options.minChildrenVisibleSize;return!tG(r)||!(Math.abs(t.x1-t.x0)<r||Math.abs(t.y1-t.y0)<r)}_layout(t){var e;this._filterChildren(t)||(t.children=null,t.isLeaf=!0),this._layoutNode(t),(null==(e=t.children)?void 0:e.length)&&t.children.forEach(t=>{var e;(null==(e=null==t?void 0:t.children)?void 0:e.length)?this._layout(t):this._layoutNode(t)})}}Sl.defaultOpionts={aspectRatio:(1+Math.sqrt(5))/2,gapWidth:0,labelPadding:0,labelPosition:"top",splitType:"binary",minVisibleArea:10};let Sa=(t,e)=>{if(e.getViewBox()){let i=new Sl(e).layout(t,e.getViewBox()),r=[];return wg(i,r,{maxDepth:null==e?void 0:e.maxDepth}),r.forEach((t,i)=>{t&&[cd,"name"].forEach(i=>{t[i]=t.datum[t.depth][e.nameField]})}),r}return[]};class So extends cD{constructor(){super(...arguments),this.type=rR.treemap,this.transformerConstructor=St,this._categoryField="name",this._valueField="value",this._viewBox=new pY,this._enableAnimationHook=this.enableMarkAnimation.bind(this),this.isHierarchyData=()=>!0}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:cd),this._spec.roam&&(this.initZoomable(this.event,this._option.mode),this._matrix=new yM),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t,e;return null!=(e=null!=(t=this._spec.drillField)?t:this._categoryField)?e:ss},getRawData:()=>this.getRawData()}),en(this._spec.maxDepth)&&(this._maxDepth=this._spec.maxDepth-1)}initData(){var t,e,i,r,n;super.initData(),nq(this._dataSet,"treemap",Sa),null==(t=this._data.getDataView())||t.transform({type:"treemap",options:{nameField:this._categoryField,valueField:this._valueField,getViewBox:()=>this._viewBox.empty()?null:{x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2},maxDepth:this._maxDepth,gapWidth:this._spec.gapWidth,padding:this._spec.nodePadding,splitType:this._spec.splitType,aspectRatio:this._spec.aspectRatio,labelPadding:(null==(e=this._spec.nonLeafLabel)?void 0:e.visible)?null==(i=this._spec.nonLeafLabel)?void 0:i.padding:0,labelPosition:null==(r=this._spec.nonLeafLabel)?void 0:r.position,minVisibleArea:null!=(n=this._spec.minVisibleArea)?n:10,minChildrenVisibleArea:this._spec.minChildrenVisibleArea,minChildrenVisibleSize:this._spec.minChildrenVisibleSize}}),this.getViewData()&&this._spec.drill&&this.initDrillableData(this._dataSet)}_runTreemapTransform(t=!1){this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()}_addDataIndexAndKey(){var t;(null==(t=this._rawData)?void 0:t.dataSet)&&(nq(this._rawData.dataSet,"addVChartProperty",d2),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:cf.bind(this),call:cm}}))}getRawDataStatisticsByField(t,e){var i;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&this._rawData){let r=w4([this._rawData],{fields:[{key:t,operations:e?["min","max"]:["values"]}]})[t];this._rawStatisticsCache[t]=ei(null!=(i=this._rawStatisticsCache[t])?i:{},r)}return this._rawStatisticsCache[t]}_createHierarchyDataStatistics(t,e){nq(this._dataSet,"hierarchyDimensionStatistics",w4),nq(this._dataSet,"flatten",wf);let i=new el(this._dataSet,{name:t});return i.parse(e,{type:"dataview"}),i.transform({type:"hierarchyDimensionStatistics",options:{fields:()=>{let t=this.getStatisticFields();return this._seriesField&&this._seriesField!==this._categoryField&&t.push({key:this._seriesField,operations:["values"]}),t}}},!1),i}getStatisticFields(){return wR(super.getStatisticFields(),this._categoryField,this._valueField)}initMark(){let t=this._createMark(So.mark.nonLeaf,{isSeriesMark:!0});t&&(t.setTransform([{type:"filter",callback:t=>!this._shouldFilterElement(t,"nonLeaf")}]),this._nonLeafMark=t);let e=this._createMark(So.mark.leaf,{isSeriesMark:!0});e&&(e.setTransform([{type:"filter",callback:t=>!this._shouldFilterElement(t,"leaf")}]),this._leafMark=e)}initMarkStyle(){this._initLeafMarkStyle(),this._initNonLeafMarkStyle()}_initLeafMarkStyle(){this._leafMark&&this.setMarkStyle(this._leafMark,{x:t=>t.x0,y:t=>t.y0,x1:t=>t.x1,y1:t=>t.y1,fill:this.getColorAttribute()},j.STATE_NORMAL,W.Series)}_initNonLeafMarkStyle(){this._nonLeafMark&&this.setMarkStyle(this._nonLeafMark,{x:t=>t.x0,y:t=>t.y0,x1:t=>t.x1,y1:t=>t.y1,fill:this.getColorAttribute()},j.STATE_NORMAL,W.Series)}_initRichStyleOfLabelMark(t){"rich"===t.getTextType()&&this.setMarkStyle(t,{maxWidth:t=>Math.abs(t.x0-t.x1),maxHeight:t=>Math.abs(t.y0-t.y1),ellipsis:!0},j.STATE_NORMAL,W.Series)}initLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:t=>(t.x0+t.x1)/2,y:t=>(t.y0+t.y1)/2,text:t=>{var e;return null==(e=t.datum[t.depth])?void 0:e[this.getDimensionField()[0]]},maxLineWidth:t=>t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0},j.STATE_NORMAL,W.Series),this._initRichStyleOfLabelMark(t))}initNonLeafLabelMarkStyle(t){t&&(this._nonLeafLabelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:t=>t.labelRect?(t.labelRect.x0+t.labelRect.x1)/2:(t.x0+t.x1)/2,y:t=>t.labelRect?(t.labelRect.y0+t.labelRect.y1)/2:(t.y0+t.y1)/2,text:t=>{var e;return null==(e=t.datum[t.depth])?void 0:e[this.getDimensionField()[0]]},maxLineWidth:t=>t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0},j.STATE_NORMAL,W.Series),this._initRichStyleOfLabelMark(t))}initAnimation(){this.getMarksInType("rect").forEach(t=>{var e;t.setAnimationConfig(cA(null==(e=iv.getAnimationInKey("treemap"))?void 0:e(),cM(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.roam&&(this.initDragEventOfSeries(this),this.event.on("panmove",t=>{this.handlePan(t)}),this.initZoomEventOfSeries(this),this.event.on("zoom",t=>{this.handleZoom(t)})),this._spec.drill&&this.bindDrillEvent()}_getDataIdKey(){return"key"}initTooltip(){this._tooltipHelper=new w6(this),this._leafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._leafMark),this._nonLeafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nonLeafMark)}_shouldFilterElement(t,e){let i=t.isLeaf;return"leaf"===e?!i:i}handlePan(t){let{delta:e}=t;if(0===e[0]&&0===e[1])return;this._matrix.reset(),this._matrix.translate(e[0],e[1]);let{a:i,b:r,c:n,d:s,e:l,f:a}=this._matrix;this._matrix.multiply(i,r,n,s,l,a),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}handleZoom(t){let{scale:e,scaleCenter:i}=t;if(1===e)return;this._matrix.reset();let{x:r,y:n}=i;this._matrix.translate(r,n),this._matrix.scale(e,e),this._matrix.translate(-r,-n);let{a:s,b:l,c:a,d:o,e:h,f:u}=this._matrix;this._matrix.multiply(s,l,a,o,h,u),this.disableMarkAnimation(),this.event.on(rE.AFTER_DO_RENDER,this._enableAnimationHook),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runTreemapTransform()}enableMarkAnimation(){this.getMarks().forEach(t=>{}),[this._labelMark,this._nonLeafLabelMark].forEach(t=>{t&&t.getComponent()&&t.getComponent().getProduct().enableAnimation()}),this.event.off(rE.AFTER_DO_RENDER,this._enableAnimationHook)}disableMarkAnimation(){this.getMarks().forEach(t=>{}),[this._labelMark,this._nonLeafLabelMark].forEach(t=>{t&&t.getComponent()&&t.getComponent().getProduct().disableAnimation()})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._nonLeafMark,this._leafMark]}getMarkData(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t}}So.type=rR.treemap,So.mark=w8,So.builtInTheme={treemap:{gapWidth:1,nodePadding:[5],nonLeaf:{visible:!1,style:{fillOpacity:.5}},label:{style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},nonLeafLabel:{padding:24,style:{fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},textBaseline:"middle",textAlign:"center"}}}},So.transformerConstructor=St,cG(So,wk),cG(So,vU);let Sh=()=>{Se(),Si(),yi(),_B(),w7(),u5(),iv.registerSeries(So.type,So)};class Su extends fD{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","aspectRatio","splitType","maxDepth","gapWidth","nodePadding","minVisibleArea","minChildrenVisibleArea","minChildrenVisibleSize","roam","drill","drillField","leaf","nonLeaf","nonLeafLabel"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class Sd extends fV{constructor(){super(...arguments),this.transformerConstructor=Su,this.type="treemap",this.seriesType=rR.treemap}}Sd.type="treemap",Sd.seriesType=rR.treemap,Sd.transformerConstructor=Su;let Sc=()=>{mx(),Sh(),iv.registerChart(Sd.type,Sd)},Sp=`${st}_waterfall_default_seriesField`,Sg=(t,e)=>{if(!t||0===t.length)return t;let{indexField:i,total:r,groupData:n,calculationMode:s}=e,l=[],{dimensionValues:a,dimensionData:o}=n().latestData,h=Array.from(a[i]);"decrease"===s&&(h=h.reverse());let u={start:0,end:0,positive:0,negative:0,lastIndex:null};return h.forEach((t,i)=>{let n={start:u.end,end:u.end,lastIndex:u.lastIndex,lastEnd:u.end,index:t,isTotal:!1,positive:u.end,negative:u.end},s=!0===e.stackInverse?o[t].reverse():o[t];if(null==s||s.forEach((t,e)=>{e===s.length-1?t[sy]=!0:delete t[sy]}),s.length>1){let a=t=>{if(r&&"end"!==r.type){if("field"===r.type||"custom"===r.type)return!!t[r.tagField]}else if(i===h.length-1)return!0;return!1};if(s.some(t=>a(t)))return u=function(t,e,i,r,n,s,l,a,o){i.isTotal=!0;let{valueField:h,startAs:u,endAs:d,total:c}=a,p=[],g=[];if(t.forEach(t=>{o(t)?g.push(t):p.push(t)}),g.length===t.length){let o=Sf([t[0]],e,i,r,n,s,l,a);return g.forEach(e=>{e[u]=t[0][u],e[d]=t[0][d],e[h]=t[0][h]}),o}let{start:f,end:m}=Sm(g[0],i,r,n,c);i.start=f,i.end=m;let y=f,v=f,b=m-f;return p.forEach(t=>{let e=+t[h];e>=0?(t[u]=+y,y=dL(y,e)):(t[u]=+v,v=dL(v,e)),t[d]=dL(t[u],e),f=dL(f,e),b=dF(b,e)}),g.forEach(t=>{t[u]=+f,t[d]=dL(t[u],b),t[h]=b}),Object.assign(Object.assign({},i),{lastIndex:e})}(s,t,n,l,u,h,i,e,a),void l.push(n)}u=Sf(s,t,n,l,u,h,i,e),l.push(n)}),l};function Sf(t,e,i,r,n,s,l,a){let{valueField:o,startAs:h,endAs:u,total:d,seriesField:c,seriesFieldName:p}=a;return t.forEach(t=>{let e=!1;if(d&&"end"!==d.type){if(("field"===d.type||"custom"===d.type)&&t[d.tagField]){e=!0;let{start:s,end:l}=Sm(t,i,r,n,d);t[h]=s,t[u]=l,t[o]=l-s,i.start=s,i.end=l}}else l===s.length-1&&(i.start=0,t[h]=i.start,t[u]=i.end,e=!0);if(!e){let e=+t[o];e>=0?(t[h]=+i.positive,i.positive=dL(i.positive,e)):(t[h]=+i.negative,i.negative=dL(i.negative,e)),t[u]=dL(t[h],e),i.end=dL(i.end,e)}i.isTotal=e,(er(c)||c===Sp)&&(t[Sp]=e?p.total:+t[o]>=0?p.increase:p.decrease)}),Object.assign(Object.assign({},i),{lastIndex:e})}function Sm(t,e,i,r,n){var s,l,a,o,h;let u,d;return n&&"end"!==n.type?"field"===n.type||"custom"===n.type?"custom"===n.type?(s=t,l=r,n.product(s,l)):n.collectCountField&&!er(t[n.collectCountField])?function(t,e,i,r){let n=0,s=i.end,l=e.length-t[r.collectCountField],a=e.length-1;return l<0?eO("total.collectCountField error"):n=e[l].start,a<0?eO("total.collectCountField error"):s=e[a].end,{start:n,end:s}}(t,i,e,n):(a=t,o=e,h=n,u=0,d=o.end,h.startField&&!er(a[h.startField])&&(u=+a[h.startField]),h.valueField&&!er(a[h.valueField])&&(d=dL(u,+a[h.valueField])),{start:u,end:d}):{start:0,end:0}:{start:0,end:e.end}}let Sy=(t,e)=>{if(!t)return t;let{indexField:i,valueField:r,total:n,seriesField:s,calculationMode:l}=e,a={[i]:(null==n?void 0:n.text)||"total",[r]:t.reduce((t,e)=>dL(t,+e[r]),0)};return s&&(a[s]="total"),"decrease"===l?t.unshift(a):t.push(a),t},Sv={type:"fadeIn"},Sb={type:"growCenterIn"},S_=()=>{iv.registerAnimation("waterfall",(t,e)=>({appear:function(t,e){switch(e){case"fadeIn":return Sv;case"scaleIn":return Sb;default:return m0(t,!1)}}(t,e),enter:m0(t,!1),exit:m1(t,!1),disappear:m1(t,!1)}))},Sx=Object.assign(Object.assign({},yr),{leaderLine:{name:"leaderLine",type:"rule"},stackLabel:{name:"stackLabel",type:"text"}}),SC=(t,e)=>{if(!e.fields)return t;let i={};return{dimensionValues:i,dimensionData:function t(e,i,r){var n,s;if(0===i.length)return e;let l=i[0],a=i.slice(1);r[l]=new Set;let o=function(t,e,i){let r={};return t.forEach(t=>{let n=t[e];r[n]||(r[n]=[],i.add(n)),r[n].push(t)}),r}(e,l,r[l]);return a.length?(n=o,s=(e,i)=>t(e,a,r),Object.keys(n).reduce((t,e)=>(t[e]=s(n[e],e),t),{})):o}(t.map(t=>t.latestData).flat(),e.fields,i)}};class Sw{get fields(){return this._fields}get groupData(){return this._groupData}constructor(t){this._fields=[],this._fields=t}initData(t,e){let i=t.name,r=new el(e instanceof tY?e:t.dataSet);r.name=i,r.parse([t],{type:"dataview"}),nq(e,"dimensionTree",SC),r.transform({type:"dimensionTree",options:{fields:this._fields}},!1),r.target.addListener("change",this.groupDataUpdate.bind(this)),this._groupData=r}groupDataUpdate(){}getGroupValueInField(t){var e,i,r;let n=null==(r=null==(i=null==(e=this.groupData)?void 0:e.latestData)?void 0:i.dimensionValues)?void 0:r[t];return n?Array.from(n):[]}}class SS extends ys{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){this._addMarkLabelSpec(t,"bar"),this._addMarkLabelSpec(t,"bar","stackLabel","initStackLabelMarkStyle")}}let SA={rect:SR,symbol:ST,arc:SB,point:function(t){let{labelSpec:e}=t;return{position:"center",overlap:!1!==e.overlap&&{clampForce:!1,avoidBaseMark:!1}}},"line-data":function(t){let e=ST(t);return tX(e.overlap)||(e.overlap.avoidBaseMark=!1,e.overlap.clampForce=!1),e},stackLabel:SP,line:SE,area:SE,rect3d:SR,arc3d:SB,treemap:function(t){return{customLayoutFunc:(t,e)=>e,overlap:!1}},venn:function(t){return{customLayoutFunc:(t,e)=>e,smartInvert:!0}}};function SM(t,e,i,r){var n,s;let{labelMark:l,series:a}=t,o=a.getMeasureField()[0],h=l.getAttributesOfState(e);if("text"in h||(h.text=null!=(n=h.text)?n:e[o]),"textType"in h||(h.textType=null!=(s=t.labelSpec.textType)?s:"text"),h.data=e,a.type!==rR.sankey){let{formatFunc:t,args:n}=d4(i,r,h.text,e);t&&(h._originText=h.text,h.text=t(...n,{series:a}))}return h}function Sk(t){return tQ(t)?e=>t(e.data):t}function ST(t){var e,i,r;let n,{series:s,labelSpec:l}=t,a="horizontal"===s.direction?"right":"top",o=null!=(e=Sk(l.position))?e:a;return n=!1!==l.overlap&&{strategy:null!=(r=null==(i=l.overlap)?void 0:i.strategy)?r:[{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}],avoidBaseMark:"center"!==o},{position:o,overlap:n}}function SR(t){var e,i,r,n,s,l,a;let{series:o,labelSpec:h={}}=t,u=null!=(e=Sk(h.position))?e:"outside",d=null!=(i=o.direction)?i:"vertical",c="horizontal"===o.direction?null==(r=o.getXAxisHelper())?void 0:r.isInverse():null==(n=o.getYAxisHelper())?void 0:n.isInverse(),p,g=u;g=t=>{var e;let{data:i}=t,r=null!=(e="function"==typeof h.position?h.position(i):h.position)?e:"outside";if("outside"===r){let t=o.getMeasureField()[0];return({vertical:["top","bottom"],horizontal:["right","left"]})[d][(null==i?void 0:i[t])>=0&&c||(null==i?void 0:i[t])<0&&!c?1:0]}return r},p=!1!==h.overlap&&{strategy:null!=(l=null==(s=h.overlap)?void 0:s.strategy)?l:(a=o,[{type:"position",position:t=>{var e,i;let{data:r}=t,n=a.getMeasureField()[0];return("horizontal"===a.direction?null==(e=a.getXAxisHelper())?void 0:e.isInverse():null==(i=a.getYAxisHelper())?void 0:i.isInverse())?(null==r?void 0:r[n])>=0?"horizontal"===a.direction?["left","inside-left"]:["bottom","inside-bottom"]:"horizontal"===a.direction?["right","inside-right"]:["top","inside-top"]:(null==r?void 0:r[n])>=0?"horizontal"===a.direction?["right","inside-right"]:["top","inside-top"]:"horizontal"===a.direction?["left","inside-left"]:["bottom","inside-bottom"]}}])};let f=!1;return t6(u)&&u.includes("inside")&&(f=!0),{position:g,overlap:p,smartInvert:f}}function SB(t){var e;let i,{labelSpec:r}=t,n=null!=(e=Sk(r.position))?e:"outside";return i=r.smartInvert?r.smartInvert:t6(n)&&n.includes("inside"),{position:n,smartInvert:i}}function SP(t,e,i){let r=t.series,n=t.labelSpec||{},s=r.getTotalData();return{customLayoutFunc:s=>s.map(s=>{let l=n.position||"withChange",a=n.offset||0,o=e?e(s.data):s.data,h=SM(t,o,n.formatMethod);return h.x="horizontal"===r.direction?"middle"===l?.5*(r.totalPositionX(o,"end")+r.totalPositionY(o,"start")):"max"===l?r.totalPositionX(o,o.end>=o.start?"end":"start")+a:"min"===l?r.totalPositionX(o,o.end>=o.start?"start":"end")-a:r.totalPositionX(o,"end")+(o.end>=o.start?a:-a):r.totalPositionX(o,"index",.5),h.y="horizontal"===r.direction?r.totalPositionY(o,"index",.5):"middle"===l?.5*(r.totalPositionY(o,"end")+r.totalPositionY(o,"start")):"max"===l?r.totalPositionY(o,o.end>=o.start?"end":"start")-a:"min"===l?r.totalPositionY(o,o.end>=o.start?"start":"end")+a:r.totalPositionY(o,"end")+(o.end>=o.start?-a:a),"horizontal"===r.direction?h.textAlign="middle"===l?"center":"withChange"===l&&o.end-o.start>=0||"max"===l?"left":"right":h.textBaseline="middle"===l?l:"withChange"===l&&o.end-o.start>=0||"max"===l?"bottom":"top",null==i||i(s,o,h),(0,g$.r)(Object.assign(Object.assign({},h),{id:s.id}))}),dataFilter:t=>{let e=[];return s.forEach(i=>{let n=t.find(t=>{var e;return i.index===(null==(e=t.data)?void 0:e[r.getDimensionField()[0]])});n&&(n.data=i,e.push(n))}),e},overlap:{strategy:[]}}}function SE(t){var e,i,r,n;let{labelSpec:s,series:l}=t,a=null==(r=null==(i=null==(e=l.getViewDataStatistics)?void 0:e.call(l).latestData)?void 0:i[l.getSeriesField()])?void 0:r.values,o=a?a.map((t,e)=>({[l.getSeriesField()]:t,index:e})):[{index:0,[sl]:l.getSeriesKeys()[0]}];return{position:null!=(n=s.position)?n:"end",data:o,overlap:{avoidBaseMark:!1,clampForce:!1}}}class SI extends yl{constructor(){super(...arguments),this.type=rR.waterfall,this.transformerConstructor=SS,this._leaderLineMark=null,this._stackLabelMark=null,this._labelMark=null}getTotalData(){var t;return null==(t=this._totalData)?void 0:t.getLatestData()}initGroups(){let t=this.getGroupFields();t&&t.length&&(this._groups=new Sw(t),this._data&&this._groups.initData(this._data.getDataView(),this._dataSet))}setAttrFromSpec(){super.setAttrFromSpec(),this.setValueFieldToStack(),this._fieldX=[this._fieldX[0]],this._fieldY=[this._fieldY[0]],er(this._seriesField)&&(this._seriesField=Sp)}getSeriesKeys(){return this._seriesField===Sp?[this._theme.seriesFieldName.increase,this._theme.seriesFieldName.decrease,this._theme.seriesFieldName.total]:super.getSeriesKeys()}initData(){var t,e,i;super.initData(),nq(this._dataSet,"waterfallFillTotal",Sy),nq(this._dataSet,"waterfall",Sg),(er(this._spec.total)||"end"===this._spec.total.type)&&(null==(t=this._rawData)||t.transform({type:"waterfallFillTotal",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,total:this._spec.total,calculationMode:null!=(e=this._spec.calculationMode)?e:"increase",stackInverse:this.getRegion().getStackInverse()}},!1));let r=n5(this.getViewData(),this._dataSet,{name:`${st}_series_${this.id}_totalData`});this.getViewData().target.removeListener("change",r.reRunAllTransform),this._totalData=new aC(this._option,r),r.transform({type:"waterfall",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,startAs:sh,endAs:su,total:this._spec.total,calculationMode:null!=(i=this._spec.calculationMode)?i:"increase",groupData:()=>this.getGroups().groupData,stackInverse:this.getRegion().getStackInverse()}},!1)}compileData(){var t;super.compileData(),null==(t=this._totalData)||t.compile()}initAnimation(){var t,e,i,r;let n={yField:"horizontal"===this.direction?this._fieldY[0]:this.getStackValueField(),xField:"horizontal"===this.direction?this.getStackValueField():this._fieldX[0],direction:this.direction,growFrom:()=>{var t,e;return"horizontal"===this.direction?null==(t=this._xAxisHelper)?void 0:t.getScale(0).scale(0):null==(e=this._yAxisHelper)?void 0:e.getScale(0).scale(0)}},s=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset,l=cO(this);this._barMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("waterfall"))?void 0:i(n,s),cM("bar",this._spec,this._markAttributeContext),l)),this._leaderLineMark&&this._leaderLineMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("fadeInOut"))?void 0:r(),cM("leaderLine",this._spec,this._markAttributeContext)))}viewDataUpdate(t){this._totalData.getDataView().reRunAllTransform(),this._totalData.updateData(),super.viewDataUpdate(t)}addViewDataFilter(t){}reFilterViewData(){}onEvaluateEnd(t){super.onEvaluateEnd(t),this._totalData.updateData()}initMark(){super.initMark();let t=this._createMark(SI.mark.leaderLine,{key:"index"});t&&(this._leaderLineMark=t,t.setData(this._totalData))}initLabelMarkStyle(t){var e;if(t)return!this._labelMark&&(null==(e=this._spec.label)?void 0:e.visible)?(super.initLabelMarkStyle(t),void(this._labelMark=t)):void 0}initStackLabelMarkStyle(t){t&&(this._stackLabelMark=t,t.skipEncode=!0,t.setRule("stackLabel"),t.setData(this._totalData),this.setMarkStyle(t,{text:t=>{var e;return"absolute"===(null==(e=this._spec.stackLabel)?void 0:e.valueType)?t.end:dF(t.end,t.start)}}))}initTotalLabelMarkStyle(t){this.setMarkStyle(t,{text:t=>{var e;return"end"in t?"absolute"===(null==(e=this._spec.totalLabel)?void 0:e.valueType)?t.end:dF(t.end,t.start):"horizontal"===this.direction?t[this._fieldX[0]]:t[this._fieldY[0]]}})}getTotalLabelComponentStyle(t){return SP(Object.assign(Object.assign({},t),{series:this,labelSpec:this._spec.totalLabel}),t=>{let e="vertical"===this.direction?t[this._fieldX[0]]:t[this._fieldY[0]];return this._totalData.getLatestData().find(t=>t.index===e)})}totalPositionX(t,e,i=.5){let{dataToPosition:r,getBandwidth:n}=this._xAxisHelper;return"horizontal"===this._direction?aa(r([t[e]],{bandPosition:this._bandPosition})):r([t[e]],{bandPosition:this._bandPosition})+.5*n(0)-this._barMark.getAttribute("width",t)*(.5-i)}totalPositionY(t,e,i=.5){let{dataToPosition:r,getBandwidth:n}=this._yAxisHelper;return"horizontal"===this._direction?r([t[e]],{bandPosition:this._bandPosition})+.5*n(0)-this._barMark.getAttribute("height",t)*(.5-i):aa(r([t[e]],{bandPosition:this._bandPosition}))}initMarkStyle(){super.initMarkStyle();let t="decrease"===this._spec.calculationMode;this._leaderLineMark&&("horizontal"===this._direction?this.setMarkStyle(this._leaderLineMark,{visible:t=>this.isVisibleLeaderLine(t),x:t=>this.totalPositionX(t,"lastEnd",0),x1:t=>this.totalPositionX(t,t.isTotal?"end":"start",0),y:e=>e.lastIndex?this.totalPositionY(e,"lastIndex",+!t):0,y1:e=>this.totalPositionY(e,"index",+!!t)},"normal",W.Series):this.setMarkStyle(this._leaderLineMark,{visible:t=>this.isVisibleLeaderLine(t),x:e=>e.lastIndex?this.totalPositionX(e,"lastIndex",+!t):0,x1:e=>this.totalPositionX(e,"index",+!!t),y:t=>this.totalPositionY(t,"lastEnd",0),y1:t=>this.totalPositionY(t,t.isTotal?"end":"start",0)},"normal",W.Series))}isVisibleLeaderLine(t){return!er(t.lastIndex)&&ao([t.lastEnd,t[t.isTotal?"end":"start"]],"horizontal"===this.direction?this._xAxisHelper.getScale(0):this._yAxisHelper.getScale(0))}}SI.type=rR.waterfall,SI.mark=Sx,SI.builtInTheme={waterfall:{seriesFieldName:{total:"total",increase:"increase",decrease:"decrease"},leaderLine:{style:{stroke:"black",lineWidth:1,lineDash:[4,4]}},stackLabel:{visible:!0,offset:12,position:"withChange",style:{fill:"black",fontSize:{type:"token",key:"l4FontSize"}}},label:{visible:!1,offset:12,position:"inside",style:{lineWidth:2}}}},SI.transformerConstructor=SS;let SL=()=>{__(),yi(),S_(),u5(),fl(),fb(),iv.registerSeries(SI.type,SI)};class SF extends yo{transformSpec(t){super.transformSpec(t),t.legends&&ed(t.legends).forEach(t=>{t.select=!1,t.hover=!1,t.filter=!1}),sW(t)}_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.bar=t.bar,e.stackLabel=t.stackLabel,e.leaderLine=t.leaderLine,e.total=t.total,e.calculationMode=t.calculationMode,e}}class SO extends yh{constructor(){super(...arguments),this.transformerConstructor=SF,this.type="waterfall",this.seriesType=rR.waterfall}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}SO.type="waterfall",SO.seriesType=rR.waterfall,SO.transformerConstructor=SF;let SD=()=>{mb(),mx(),mw(),f8(),fX(),SL(),iv.registerChart(SO.type,SO)},SH=`${st}_BOX_PLOT_OUTLIER_VALUE`;(I=J||(J={})).OUTLIER="outlier",I.MAX="max",I.MIN="min",I.MEDIAN="median",I.Q1="q1",I.Q3="q3",I.SERIES_FIELD="seriesField";let Sz=(t,e)=>{let i=[],{outliersField:r,dimensionField:n}=e;return(t[0].latestData||[]).forEach(t=>{let e=t[r];tq(e)||(e=[e]),i.push(...e.map(e=>{let i={[SH]:e};return n.forEach(e=>{i[e]=t[e]}),i}))}),i};class SW extends cs{constructor(){super(...arguments),this.getContentKey=t=>e=>{if(this.isOutlierMark(e))return t===J.OUTLIER?this.series.getOutliersField():t===J.SERIES_FIELD?this.series.getSeriesField():null;switch(t){case J.MIN:return this.series.getMinField();case J.MAX:return this.series.getMaxField();case J.MEDIAN:return this.series.getMedianField();case J.Q1:return this.series.getQ1Field();case J.Q3:return this.series.getQ3Field();case J.SERIES_FIELD:return this.series.getSeriesField()}return null},this.getContentValue=t=>e=>{if(this.isOutlierMark(e))return t===J.OUTLIER?e[SH]:t===J.SERIES_FIELD?e[this.series.getSeriesField()]:null;switch(t){case J.MIN:return e[this.series.getMinField()];case J.MAX:return e[this.series.getMaxField()];case J.MEDIAN:return e[this.series.getMedianField()];case J.Q1:return e[this.series.getQ1Field()];case J.Q3:return e[this.series.getQ3Field()];case J.SERIES_FIELD:return e[this.series.getSeriesField()]}return null},this.shapeColorCallback=t=>"line"===this.series.getShaftShape()?this.series.getMarkInName("boxPlot").getAttribute("stroke",t):this.series.getMarkInName("boxPlot").getAttribute("fill",t),this.getOutlierFillColor=t=>{var e,i;let r=this.series.getOutliersStyle();return null!=(e=null==r?void 0:r.fill)?e:null==(i=this.series.getMarkInName("outlier"))?void 0:i.getAttribute("fill",t)},this.isOutlierMark=t=>t8(t[SH])}getDefaultContentList(t){return[{key:this.getContentKey(J.OUTLIER),value:this.getContentValue(J.OUTLIER),shapeType:this.shapeTypeCallback,shapeColor:this.getOutlierFillColor,shapeStroke:this.getOutlierFillColor},{key:this.getContentKey(J.MAX),value:this.getContentValue(J.MAX)},{key:this.getContentKey(J.Q3),value:this.getContentValue(J.Q3)},{key:this.getContentKey(J.MEDIAN),value:this.getContentValue(J.MEDIAN)},{key:this.getContentKey(J.Q1),value:this.getContentValue(J.Q1)},{key:this.getContentKey(J.MIN),value:this.getContentValue(J.MIN)},{key:this.getContentKey(J.SERIES_FIELD),value:this.getContentValue(J.SERIES_FIELD)}]}}class SN extends mM.zs{constructor(t){super(t),this.type="glyph",this.numberType=o$.Nd,this.subGraphic=[],this._onInit&&this._onInit(this),this.valid=this.isValid()}setSubGraphic(t){this.detachSubGraphic(),this.subGraphic=t,t.forEach(t=>{t.glyphHost=this,Object.setPrototypeOf(t.attribute,this.attribute)}),this.valid=this.isValid(),this.addUpdateBoundTag()}detachSubGraphic(){this.subGraphic.forEach(t=>{t.glyphHost=null,Object.setPrototypeOf(t.attribute,{})})}getSubGraphic(){return this.subGraphic}onInit(t){this._onInit=t}onUpdate(t){this._onUpdate=t}isValid(){return!0}setAttribute(t,e,i,r){super.setAttribute(t,e,i,r),this.subGraphic.forEach(t=>{t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()})}setAttributes(t,e=!1,i){super.setAttributes(t,e,i),this.subGraphic.forEach(t=>{t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()})}translate(t,e){return super.translate(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}translateTo(t,e){return super.translateTo(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}scale(t,e,i){return super.scale(t,e,i),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}scaleTo(t,e){return super.scaleTo(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}rotate(t){return super.rotate(t),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}rotateTo(t){return super.rotate(t),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}getGraphicTheme(){return(0,up.gh)(this).glyph}updateAABBBounds(t,e,i){return this.getSubGraphic().forEach(t=>{i.union(t.AABBBounds)}),i}doUpdateAABBBounds(){this.updateAABBBoundsStamp++,this._AABBBounds.clear();let t=this.updateAABBBounds(this.attribute,this.getGraphicTheme(),this._AABBBounds);return this.clearUpdateBoundTag(),t}needUpdateTags(t){return!1}needUpdateTag(t){return!1}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!((null==(i=this.currentStates)?void 0:i.length)!==t.length||t.some((t,e)=>this.currentStates[e]!==t)))return;this.stopStateAnimates();let r={},n=this.subGraphic.map(()=>({}));t.forEach(e=>{var i;let s=this.glyphStateProxy?this.glyphStateProxy(e,t):this.glyphStates[e];s&&(Object.assign(r,s.attributes),(null==(i=s.subAttributes)?void 0:i.length)&&n.forEach((t,e)=>{Object.assign(t,s.subAttributes[e])}))}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}clearStates(t){this.stopStateAnimates(),this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}clone(){let t=new SN(Object.assign({},this.attribute));return t.setSubGraphic(this.subGraphic.map(t=>t.clone())),t}getNoWorkAnimateAttr(){return SN.NOWORK_ANIMATE_ATTR}}function Sj(t){return new SN(t)}SN.NOWORK_ANIMATE_ATTR=mM.Wl;let SG=class{constructor(){this.numberType=o$.Nd}reInit(){}drawShape(t,e,i,r,n,s,l,a){n.drawContribution&&t.getSubGraphic().forEach(t=>{let o=n.drawContribution.getRenderContribution(t);o&&o.drawShape&&o.drawShape(t,e,i,r,n,s,l,a)})}draw(t,e,i,r){let{context:n}=i;if(!n||(n.highPerformanceSave(),!i.drawContribution))return;let s=(0,up.gh)(t),l=t.getSubGraphic();l.length&&l.forEach(t=>{i.drawContribution.renderItem(t,i,{theme:s})}),n.highPerformanceRestore()}};SG=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)()],SG);let SV=!1,SZ=new oC.n(t=>{SV||(SV=!0,t(oY.FU).to(SG).inSingletonScope(),t(oY.uz).toService(oY.FU))}),SU=class extends o1{constructor(t){super(),this.canvasRenderer=t}};SU=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)(),(L=(0,oI.f)(oY.FU),function(t,e){L(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],SU);let SK=!1,S$=new oC.n((t,e,i,r)=>{SK||(SK=!0,t(oG.Se).to(SU).inSingletonScope(),t(oG.EL).toService(oG.Se))});function SY(){SY.__loaded||(SY.__loaded=!0,c0.i.RegisterGraphicCreator("glyph",Sj),o_.n.load(SZ),o_.n.load(mO.X?S$:o5))}SY.__loaded=!1;class SX extends od{constructor(){super(...arguments),this._setStateOfGraphic=t=>{t.clearStates(),t.stateProxy=null,t.context.diffState!==N.enter&&t.context.diffState!==N.update||(t.glyphStateProxy=(e,i)=>{var r;let n={attributes:Object.assign(Object.assign({},this._runEncoderOfGraphic(null==(r=this._encoderOfState)?void 0:r[e],t)),t.runtimeStateCache?t.runtimeStateCache[e]:null)};return t.glyphStates?t.glyphStates[e]||(t.glyphStates[e]=n):t.glyphStates={[e]:n},n},t.useStates(t.context.states))}}getSubMarks(){return this._subMarks}setGlyphConfig(t){this._glyphConfig=t}getGlyphConfig(){return this._glyphConfig}getPositionChannels(){return this._positionChannels}_onGlyphAttributeUpdate(t){return e=>{var i,r;let n=this.getPositionChannels(),s=n&&this._positionEncoder&&Object.keys(e).some(t=>n.includes(t))?this._positionEncoder(e,null==(r=null==(i=null==t?void 0:t.context)?void 0:i.data)?void 0:r[0],t):null;return this._channelEncoder&&Object.keys(this._channelEncoder).forEach(t=>{if(t in e){let i=this._channelEncoder[t](e[t]);s=s?ei(s,i):i}}),s&&t.getSubGraphic().forEach(t=>{t&&s[t.name]&&t.setAttributes(s[t.name])}),e}}_createGraphic(t={}){let e=Sj(t);e.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(e);let i=this._subMarks;if(i){let t=[];Object.keys(i).forEach(e=>{let r=iv.createGraphicComponent(i[e].type,Object.assign({},i[e].defaultAttributes));r&&(t.push(r),r.name=e,r.onBeforeAttributeUpdate=t=>t)}),e.setSubGraphic(t)}return e.onBeforeAttributeUpdate(t),e}_runProgressiveEncoder(t){this._runEncoder(t)}}let Sq=()=>{iv.registerGraphicComponent("glyph",Sj),(0,oc.W)(),SY()},SJ=["x","y","minMaxWidth","minMaxHeight","q1q3Width","q1q3Height","q1","q3","min","max","median","angle"],SQ=["x","y","boxWidth","boxHeight","ruleWidth","ruleHeight","q1","q3","min","max","median","angle"];class S0 extends SX{constructor(){super(...arguments),this.type=S0.type}_isHorizontal(){return this._glyphConfig&&"horizontal"===this._glyphConfig.direction}setGlyphConfig(t){super.setGlyphConfig(t),"bar"===t.shaftShape?(this._subMarks={minMaxBox:{type:"rect",defaultAttributes:{lineWidth:0}},q1q3Box:{type:"rect",defaultAttributes:{lineWidth:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=SJ,this._channelEncoder={minMaxFillOpacity:t=>({minMaxBox:{fillOpacity:t}}),lineWidth:t=>({minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0}}),stroke:t=>({minMaxBox:{stroke:!1},q1q3Box:{stroke:!1}})},this._positionEncoder=(t,e,i)=>{var r;let{x:n=i.attribute.x,y:s=i.attribute.y,minMaxWidth:l=i.attribute.minMaxWidth,minMaxHeight:a=i.attribute.minMaxHeight,q1q3Width:o=i.attribute.q1q3Width,q1q3Height:h=i.attribute.q1q3Height,q1:u=i.attribute.q1,q3:d=i.attribute.q3,min:c=i.attribute.min,max:p=i.attribute.max,median:g=i.attribute.median,angle:f}=t,m=this._isHorizontal(),y={};if(m?(y.minMaxBox={x:c,x1:p,y:s-a/2,y1:s+a/2},y.q1q3Box={x:u,x1:d,y:s-h/2,y1:s+h/2},y.median={points:[{x:g,y:s-h/2},{x:g,y:s+h/2}]}):(y.minMaxBox={y:c,y1:p,x:n-l/2,x1:n+l/2},y.q1q3Box={y:u,y1:d,x:n-o/2,x1:n+o/2},y.median={points:[{y:g,x:n-o/2},{y:g,x:n+o/2}]}),en(f)){let e=null!=(r=t.anchor)?r:m?[(c+p)/2,s]:[n,(c+p)/2];Object.keys(y).forEach(t=>{y[t].angle=f,y[t].anchor=e})}return y}):(this._subMarks={shaft:{type:"line",defaultAttributes:{x:0,y:0}},box:{type:"rect"},max:{type:"line",defaultAttributes:{x:0,y:0}},min:{type:"line",defaultAttributes:{x:0,y:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=SQ,this._channelEncoder=null,this._positionEncoder=(t,e,i)=>{var r;let{x:n=i.attribute.x,y:s=i.attribute.y,boxWidth:l=i.attribute.boxWidth,boxHeight:a=i.attribute.boxHeight,ruleWidth:o=i.attribute.ruleWidth,ruleHeight:h=i.attribute.ruleHeight,q1:u=i.attribute.q1,q3:d=i.attribute.q3,min:c=i.attribute.min,max:p=i.attribute.max,median:g=i.attribute.median,angle:f}=t,m=this._isHorizontal(),y={};if(m?(y.box={x:u,x1:d,y:s-a/2,y1:s+a/2},y.median={points:[{x:g,y:s-a/2},{x:g,y:s+a/2}]},y.shaft={points:[{x:c,y:s},{x:p,y:s}]},y.max={points:[{x:p,y:s-h/2},{x:p,y:s+h/2}]},y.min={points:[{x:c,y:s-h/2},{x:c,y:s+h/2}]}):(y.box={x:n-l/2,x1:n+l/2,y:u,y1:d},y.median={points:[{x:n-l/2,y:g},{x:n+l/2,y:g}]},y.max={points:[{x:n-o/2,y:p},{x:n+o/2,y:p}]},y.min={points:[{x:n-o/2,y:c},{x:n+o/2,y:c}]},y.shaft={points:[{x:n,y:c},{x:n,y:p}]}),en(f)){let e=null!=(r=t.anchor)?r:m?[(c+p)/2,s]:[n,(c+p)/2];Object.keys(y).forEach(t=>{y[t].angle=f,y[t].anchor=e})}return y})}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:2,boxWidth:30,shaftWidth:20,shaftShape:"line"})}}S0.type="boxPlot";let S1=()=>{Sq(),(0,cJ.N)(),(0,m6.k)(),iv.registerGraphicComponent("line",t=>(0,cq.W)(t)),iv.registerGraphicComponent("rect",t=>(0,yt.f)(t)),iv.registerMark(S0.type,S0)},S2=Object.assign(Object.assign({},cy),{boxPlot:{name:"boxPlot",type:"boxPlot"},outlier:{name:"outlier",type:"symbol"}}),S3=t=>(e,i,r)=>{var n;let s=e.getFinalAttribute(),l=t(e,null!=(n=s.direction)?n:"vertical",i);if(!en(l))return{};let{x:a,y:o,min:h,max:u,q1:d,q3:c,median:p}=s,g={from:{x:a,y:o},to:{x:a,y:o}};return en(h)&&(g.from.min=l,g.to.min=h),en(u)&&(g.from.max=l,g.to.max=u),en(d)&&(g.from.q1=l,g.to.q1=d),en(c)&&(g.from.q3=l,g.to.q3=c),en(p)&&(g.from.median=l,g.to.median=p),g},S5=t=>(e,i,r)=>{var n;let s=e.getFinalAttribute(),l=t(e,null!=(n=s.direction)?n:"vertical",i);if(!en(l))return{};let{x:a,y:o,min:h,max:u,q1:d,q3:c,median:p}=s,g={from:{x:a,y:o},to:{x:a,y:o}};return en(h)&&(g.to.min=l,g.from.min=h),en(u)&&(g.to.max=l,g.from.max=u),en(d)&&(g.to.q1=l,g.from.q1=d),en(c)&&(g.to.q3=l,g.from.q3=c),en(p)&&(g.to.median=l,g.from.median=p),g},S4=(t,e)=>t.getSubGraphic().find(t=>t.name===e),S6=(t,e,i)=>{var r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S;let A,M,k,T,R;if(i&&en(i.center))return i.center;if("horizontal"===e){A=null==(s=null==(n=(null==(r=S4(t,"median"))?void 0:r.attribute).points)?void 0:n[0])?void 0:s.x,M=null==(h=null==(o=null==(a=null==(l=S4(t,"max"))?void 0:l.attribute)?void 0:a.points)?void 0:o[0])?void 0:h.x,k=null==(p=null==(c=null==(d=null==(u=S4(t,"min"))?void 0:u.attribute)?void 0:d.points)?void 0:c[0])?void 0:p.x;let e=S4(t,"box").attribute.width,i=S4(t,"box").attribute.x;T=i,R=i+e}else{A=null==(m=null==(f=(null==(g=S4(t,"median"))?void 0:g.attribute).points)?void 0:f[0])?void 0:m.y,M=null==(_=null==(b=null==(v=null==(y=S4(t,"max"))?void 0:y.attribute)?void 0:v.points)?void 0:b[0])?void 0:_.y,k=null==(S=null==(w=null==(C=null==(x=S4(t,"min"))?void 0:x.attribute)?void 0:C.points)?void 0:w[0])?void 0:S.y;let e=S4(t,"box").attribute.height,i=S4(t,"box").attribute.y;T=i,R=i+e}return en(A)?A:en(T)&&en(R)?(T+R)/2:en(M)&&en(k)?(M+k)/2:en(k)?k:en(M)?M:NaN},S8=(t,e,i)=>{var r,n,s,l,a,o,h,u,d,c,p,g,f,m;let y,v,b,_,x;if(en(null==i?void 0:i.center))return i.center;if("horizontal"===e){y=null==(s=null==(n=(null==(r=S4(t,"median"))?void 0:r.attribute).points)?void 0:n[0])?void 0:s.x;let e=(null==(l=S4(t,"minMaxBox"))?void 0:l.attribute).width,i=null==(a=S4(t,"minMaxBox"))?void 0:a.attribute.x;b=i,v=i+e;let u=(null==(o=S4(t,"q1q3Box"))?void 0:o.attribute).width,d=null==(h=S4(t,"q1q3Box"))?void 0:h.attribute.x;_=d,x=d+u}else{y=null==(c=null==(d=(null==(u=S4(t,"median"))?void 0:u.attribute).points)?void 0:d[0])?void 0:c.y;let e=(null==(p=S4(t,"minMaxBox"))?void 0:p.attribute).height,i=null==(g=S4(t,"minMaxBox"))?void 0:g.attribute.y;b=i,v=i+e;let r=(null==(f=S4(t,"q1q3Box"))?void 0:f.attribute).height,n=null==(m=S4(t,"q1q3Box"))?void 0:m.attribute.y;_=n,x=n+r}return en(y)?y:en(_)&&en(x)?(_+x)/2:en(v)&&en(b)?(v+b)/2:en(b)?b:en(v)?v:NaN};class S9 extends aq.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){super.onBind();let t=this.target.getFinalAttribute();t&&this.target.setAttributes(t);let{from:e,to:i}=this.computeAttribute();this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.animate.reSyncProps(),this.from=e,this.to=i,this.target.setAttributes(this.from)}computeAttribute(){return S3(S6)(this.target,this.params,this.params.options)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}class S7 extends aq.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t;(null==(t=this.params)?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);let{from:e,to:i}=this.computeAttribute();this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.animate.reSyncProps(),this.from=e,this.to=i,this.target.setAttributes(this.from)}computeAttribute(){return S5(S6)(this.target,this.params,this.params.options)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}class At extends S9{computeAttribute(){return S3(S8)(this.target,this.params,this.params.options)}}class Ae extends S7{computeAttribute(){return S5(S8)(this.target,this.params,this.params.options)}}let Ai=()=>{uO.a.registerBuiltInAnimate("boxplotScaleIn",S9),uO.a.registerBuiltInAnimate("boxplotScaleOut",S7),uO.a.registerBuiltInAnimate("barBoxplotScaleIn",At),uO.a.registerBuiltInAnimate("barBoxplotScaleOut",Ae)};class Ar extends cD{constructor(){super(...arguments),this.type=rR.boxPlot}getMinField(){return this._minField}getMaxField(){return this._maxField}getQ1Field(){return this._q1Field}getMedianField(){return this._medianField}getQ3Field(){return this._q3Field}getOutliersField(){return this._outliersField}getShaftShape(){return this._shaftShape}getBoxFillColor(){return this._boxFillColor}getStrokeColor(){return this._strokeColor}getOutliersStyle(){return this._outliersStyle}setAttrFromSpec(){var t,e,i,r,n;super.setAttrFromSpec();let s=null!=(e=null==(t=this._spec.boxPlot)?void 0:t.style)?e:{};this._minField=this._spec.minField,this._maxField=this._spec.maxField,this._q1Field=this._spec.q1Field,this._medianField=this._spec.medianField,this._q3Field=this._spec.q3Field,this._outliersField=this._spec.outliersField,this._lineWidth=null!=(i=s.lineWidth)?i:2,this._boxWidth=s.boxWidth,this._shaftShape=null!=(r=s.shaftShape)?r:"line",this._shaftWidth=s.shaftWidth,this._boxFillColor=s.boxFill,this._strokeColor=s.stroke,this._shaftFillOpacity="bar"===this._shaftShape?null!=(n=s.shaftFillOpacity)?n:.5:void 0,this._outliersStyle=this._spec.outliersStyle}initMark(){this._boxPlotMark=this._createMark(Ar.mark.boxPlot,{groupKey:this._seriesField,isSeriesMark:!0}),this._outliersField&&(this._outlierMark=this._createMark(Ar.mark.outlier,{key:sn,groupKey:this._seriesField,dataView:this._outlierDataView.getDataView(),dataProductId:this._outlierDataView.getProductId()}))}initMarkStyle(){var t,e,i,r,n;let s=this._boxPlotMark;if(s){let i={lineWidth:this._lineWidth,fill:null!=(t=this._boxFillColor)?t:"line"===this._shaftShape?"#FFF":this.getColorAttribute(),minMaxFillOpacity:this._shaftFillOpacity,stroke:null!=(e=this._strokeColor)?e:"line"===this._shaftShape?this.getColorAttribute():"#000"};s.setGlyphConfig({direction:this._direction,shaftShape:this._shaftShape});let r="horizontal"===this._direction?Object.assign(Object.assign({y:this.dataToPositionY.bind(this)},i),{boxHeight:()=>{var t;return null!=(t=this._boxWidth)?t:this._getMarkWidth()},ruleHeight:()=>{var t;return null!=(t=this._shaftWidth)?t:this._getMarkWidth()},q1q3Height:()=>{var t;return null!=(t=this._boxWidth)?t:this._getMarkWidth()},minMaxHeight:()=>{var t;return null!=(t=this._shaftWidth)?t:this._getMarkWidth()}}):Object.assign(Object.assign({x:this.dataToPositionX.bind(this)},i),{boxWidth:()=>{var t;return null!=(t=this._boxWidth)?t:this._getMarkWidth()},ruleWidth:()=>{var t;return null!=(t=this._shaftWidth)?t:this._getMarkWidth()},q1q3Width:()=>{var t;return null!=(t=this._boxWidth)?t:this._getMarkWidth()},minMaxWidth:()=>{var t;return null!=(t=this._shaftWidth)?t:this._getMarkWidth()}});this.setMarkStyle(s,r,j.STATE_NORMAL,W.Series)}let l=this._outlierMark;l&&this.setMarkStyle(l,{fill:null!=(r=null==(i=this._outliersStyle)?void 0:i.fill)?r:this.getColorAttribute(),size:tG(null==(n=this._outliersStyle)?void 0:n.size)?this._outliersStyle.size:10,symbolType:"circle"},j.STATE_NORMAL,W.Series)}initBoxPlotMarkStyle(){var t,e;let i=this._boxPlotMark,r="horizontal"===this._direction?this._xAxisHelper:this._yAxisHelper;if(i&&r){let{dataToPosition:e}=r,n=null==(t=null==r?void 0:r.getScale)?void 0:t.call(r,0);this.setMarkStyle(i,{min:t=>aa(e(this.getDatumPositionValues(t,this._minField),{bandPosition:this._bandPosition}),n),q1:t=>aa(e(this.getDatumPositionValues(t,this._q1Field),{bandPosition:this._bandPosition}),n),median:t=>aa(e(this.getDatumPositionValues(t,this._medianField),{bandPosition:this._bandPosition}),n),q3:t=>aa(e(this.getDatumPositionValues(t,this._q3Field),{bandPosition:this._bandPosition}),n),max:t=>aa(e(this.getDatumPositionValues(t,this._maxField),{bandPosition:this._bandPosition}),n)},j.STATE_NORMAL,W.Series)}let n=this._outlierMark;if(n&&r){let{dataToPosition:t}=r,i=null==(e=null==r?void 0:r.getScale)?void 0:e.call(r,0),s="horizontal"===this._direction?{y:this.dataToPositionY.bind(this),x:e=>aa(t(this.getDatumPositionValues(e,SH),{bandPosition:this._bandPosition}),i)}:{x:this.dataToPositionX.bind(this),y:e=>aa(t(this.getDatumPositionValues(e,SH),{bandPosition:this._bandPosition}),i)};this.setMarkStyle(n,s,j.STATE_NORMAL,W.Series)}}initData(){if(super.initData(),!this._data)return;nq(this._dataSet,"foldOutlierData",Sz),nq(this._dataSet,"addVChartProperty",d2);let t=new el(this._dataSet,{name:`${this.type}_outlier_${this.id}_data`});t.parse([this.getViewData()],{type:"dataview"}),t.name=`${st}_series_${this.id}_outlierData`,t.transform({type:"foldOutlierData",options:{dimensionField:"horizontal"===this._direction?this._fieldY:this._fieldX,outliersField:this._outliersField}}),t.transform({type:"addVChartProperty",options:{beforeCall:cp.bind(this),call:cg}},!1),this._outlierDataView=new aC(this._option,t)}compileData(){var t;super.compileData(),null==(t=this._outlierDataView)||t.compile()}init(t){super.init(t),this.initBoxPlotMarkStyle()}_getMarkWidth(){if(this._autoBoxWidth)return this._autoBoxWidth;let t="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,e="horizontal"===this._direction?this._fieldY:this._fieldX,i=t.getBandwidth(e.length-1)/e.length;return this._autoBoxWidth=i,this._autoBoxWidth}onLayoutEnd(){super.onLayoutEnd(),this._autoBoxWidth=null}_initAnimationSpec(t={}){let e=ei({},t);return["appear","enter","update","exit","disappear"].forEach(t=>{e[t]&&"scaleIn"===e[t].type?e[t].type="line"===this._shaftShape?"boxplotScaleIn":"barBoxplotScaleIn":e[t]&&"scaleOut"===e[t].type&&(e[t].type="line"===this._shaftShape?"boxplotScaleOut":"barBoxplotScaleOut")}),e}initAnimation(){var t,e,i,r,n,s,l;let a=cO(this);if(this._boxPlotMark){let e=this._initAnimationSpec(null==(t=iv.getAnimationInKey("scaleInOut"))?void 0:t()),i=this._initAnimationSpec(cM("boxPlot",this._spec,this._markAttributeContext));this._boxPlotMark.setAnimationConfig(cA(e,i,a))}if(this._outlierMark){let t={appear:null==(e=this._spec.animationAppear)?void 0:e.symbol,disappear:null==(i=this._spec.animationDisappear)?void 0:i.symbol,enter:null==(r=this._spec.animationEnter)?void 0:r.symbol,exit:null==(n=this._spec.animationExit)?void 0:n.symbol,update:null==(s=this._spec.animationUpdate)?void 0:s.symbol};this._outlierMark.setAnimationConfig(cA(null==(l=iv.getAnimationInKey("scaleInOut"))?void 0:l(),t,a))}}initTooltip(){this._tooltipHelper=new SW(this),this._boxPlotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._boxPlotMark),this._outlierMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._outlierMark)}getStatisticFields(){let t=super.getStatisticFields(),e=t.find(t=>t.key===this._outliersField);return e&&(e.operations=["array-min","array-max"]),t}onEvaluateEnd(t){super.onEvaluateEnd(t),this._outlierDataView.updateData()}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._boxPlotMark]}}Ar.type=rR.boxPlot,Ar.builtInTheme={boxPlot:{boxPlot:{style:{lineWidth:1}},label:{style:{lineWidth:2}}}},Ar.mark=S2;let An=()=>{S1(),pV(),u3(),fl(),fb(),Ai(),iv.registerSeries(Ar.type,Ar)};class As extends fH{_getDefaultSeriesSpec(t){var e;let i=[t.maxField,t.medianField,t.q1Field,t.q3Field,t.minField,t.outliersField],r=super._getDefaultSeriesSpec(t,["boxPlot","minField","maxField","q1Field","medianField","q3Field","outliersField","outliersStyle"]);return r.direction=null!=(e=t.direction)?e:"vertical",r["horizontal"===r.direction?"xField":"yField"]=i,r}transformSpec(t){super.transformSpec(t),t.axes||(t.axes=[{orient:"bottom"},{orient:"left"}]),sW(t)}}class Al extends fV{constructor(){super(...arguments),this.transformerConstructor=As,this.type="boxPlot",this.seriesType=rR.boxPlot}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}Al.type="boxPlot",Al.seriesType=rR.boxPlot,Al.transformerConstructor=As;let Aa=()=>{mb(),mx(),f8(),fX(),An(),iv.registerChart(Al.type,Al)},Ao=t=>{let e=0;return t.forEach((t,i)=>{var r;er(t.value)&&((null==(r=t.children)?void 0:r.length)?t.value=Ao(t.children):t.value=0),e+=Math.abs(t.value)}),e};function Ah(t){return t.depth}function Au(t,e){return e-1-t.endDepth}let Ad=(t,e)=>(null==t?void 0:t.y0)-(null==e?void 0:e.y0),Ac=(t,e)=>{if(er(t.value))return null;let i=(e?t.targetLinks:t.sourceLinks).reduce((t,e)=>(er(e.value)?t.count+=1:t.sum+=e.value,t),{sum:0,count:0});return i.count>0?(t.value-i.sum)/i.count:null},Ap={left:Ah,right:Au,justify:function(t,e){return t.sourceLinks.length?t.depth:e-1},center:function(t,e,i){return t.targetLinks.length?t.depth:t.sourceLinks.length?eg(t.sourceLinks.map(t=>i[t.target].depth))-1:0},start:Ah,end:Au},Ag=l3(0,1);class Af{constructor(t){this._ascendingSourceBreadth=(t,e)=>Ad(this._nodeMap[t.source],this._nodeMap[e.source])||t.index-e.index,this._ascendingTargetBreadth=(t,e)=>Ad(this._nodeMap[t.target],this._nodeMap[e.target])||t.index-e.index,this.options=Object.assign({},Af.defaultOptions,t);let e=this.options.nodeKey,i=tQ(e)?e:e?Ct(e):null;this._getNodeKey=i,this._logger=tU.getInstance(),this._alignFunc=tQ(this.options.setNodeLayer)?t=>this.options.setNodeLayer(t.datum):Ap[this.options.nodeAlign]}layout(t,e){if(!t)return null;let i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};"vertical"===this.options.direction?this._viewBox={x0:i.y0,x1:i.y1,y0:i.x0,y1:i.x1,width:i.height,height:i.width}:this._viewBox=i;let r=this.computeNodeLinks(t),n=r.nodes,s=r.links;if(this._nodeMap=r.nodeMap,this.computeNodeValues(n),this.computeNodeDepths(n),["right","end","justify"].includes(this.options.nodeAlign)&&this.computeNodeEndDepths(n),this._maxDepth<=0)return null;let l=this.computeNodeBreadths(n);if(this.computeLinkBreadths(n),n.forEach(t=>{t.sourceLinks=t.sourceLinks.filter(t=>!er(t.source)&&!er(t.target)),t.targetLinks=t.targetLinks.filter(t=>!er(t.source)&&!er(t.target))}),s=s.filter(t=>!er(t.source)&&!er(t.target)),"vertical"===this.options.direction)if(this.options.inverse){let t=this._viewBox.x1;n.forEach(e=>{let{y0:i,y1:r,x0:n,x1:s}=e;e.y0=t-s,e.y1=t-n,e.x0=i,e.x1=r}),s.forEach(e=>{e.vertical=!0;let{x0:i,x1:r,y0:n,y1:s}=e;e.x0=n,e.x1=s,e.y0=t-i,e.y1=t-r})}else n.forEach(t=>{let{y0:e,y1:i}=t;t.y0=t.x0,t.y1=t.x1,t.x0=e,t.x1=i}),s.forEach(t=>{t.vertical=!0;let e=t.x0,i=t.x1;t.x0=t.y0,t.x1=t.y1,t.y0=e,t.y1=i});else this.options.inverse&&(n.forEach(t=>{let{x0:e,x1:r}=t;t.x0=i.x1-r,t.x1=i.x1-e}),s.forEach(t=>{t.x0=i.x1-t.x0,t.x1=i.x1-t.x1}));return s.forEach(t=>{let e=this._nodeMap[t.source],i=this._nodeMap[t.target];t.sourceRect={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},t.targetRect={x0:i.x0,x1:i.x1,y1:i.y1,y0:i.y0}}),{nodes:n,links:s,columns:l}}computeHierarchicNodeLinks(t){let e=[],i=[],r={},n={},s=[];Ao(t);let l=(t,i,n)=>{t.forEach((t,a)=>{let o=this._getNodeKey?this._getNodeKey(t):n?`${n[n.length-1].key}-${a}`:`${i}-${a}`,h=er(t.value)?0:wu(t.value);if(r[o])r[o].value=void 0;else{let n={depth:i,datum:t,index:a,key:o,value:h,sourceLinks:[],targetLinks:[]};r[o]=n,e.push(n)}n&&s.push({source:n[n.length-1].key,target:o,value:h,parents:n}),t.children&&t.children.length&&l(t.children,i+1,n?n.concat([r[o]]):[r[o]])})};return l(t,0,null),s.forEach((t,e)=>{let s=`${t.source}-${t.target}`,l=gW(t,["parents"]);if(l.parents=t.parents.map(t=>gW(t,["sourceLinks","targetLinks"])),n[s])return n[s].value+=wu(t.value),void n[s].datum.push(l);let a={index:e,key:`${t.source}-${t.target}`,source:t.source,target:t.target,datum:[l],value:t.value,parents:t.parents.map(t=>t.key)};i.push(a),r[t.source].sourceLinks.push(a),r[t.target].targetLinks.push(a),n[s]=a}),{nodes:e,links:i,nodeMap:r}}computeSourceTargetNodeLinks(t){let e=[],i=[],r={};t.nodes&&t.nodes.forEach((t,i)=>{let n={depth:-1,datum:t,index:i,key:this._getNodeKey?this._getNodeKey(t):i,value:t.value,sourceLinks:[],targetLinks:[]};r[n.key]=n,e.push(n)});let n=[];return t.links.forEach((s,l)=>{let a=!er(s.source),o=!er(s.target);if(t.nodes&&(!r[s.source]||!r[s.target]))return;t.nodes||!a||r[s.source]||(r[s.source]={value:void 0,depth:-1,index:e.length,key:s.source,datum:null,sourceLinks:[],targetLinks:[]},e.push(r[s.source])),t.nodes||!o||r[s.target]||(r[s.target]={value:void 0,depth:-1,index:e.length,key:s.target,datum:null,sourceLinks:[],targetLinks:[]},e.push(r[s.target]));let h={index:l,source:s.source,target:s.target,datum:s,value:s.value};this.options.divideNodeValueToLink&&er(s.value)&&n.push(h),i.push(h),a&&r[s.source].sourceLinks.push(h),o&&r[s.target].targetLinks.push(h)}),this.options.divideNodeValueToLink&&n.length&&n.forEach(t=>{let e=[Ac(r[t.source]),Ac(r[t.target],!0)].filter(t=>!er(t));e.length&&(t.value=eg(e))}),{nodeMap:r,nodes:e,links:i}}computeNodeLinks(t){let e;"links"in t?e=this.computeSourceTargetNodeLinks(t):(this._isHierarchic=!0,e=this.computeHierarchicNodeLinks(t.nodes));let i=e.nodes,r=e.links;if(this.options.linkSortBy)for(let t=0,e=i.length;t<e;t++)i[t].sourceLinks.sort(this.options.linkSortBy),i[t].targetLinks.sort(this.options.linkSortBy);return this.options.dropIsolatedNode&&(i=i.filter(t=>t.targetLinks.length||t.sourceLinks.length)),{nodes:i,links:r,nodeMap:e.nodeMap}}computeNodeValues(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];i.value=Math.max(er(i.value)?0:wu(i.value),i.sourceLinks.reduce((t,e)=>{var i;return t+(null!=(i=wu(e.value))?i:0)},0),i.targetLinks.reduce((t,e)=>{var i;return t+(null!=(i=wu(e.value))?i:0)},0))}}computeNodeDepths(t){var e;let i=t.length,r,n,s=t,l=0,a=-1,o=tQ(this.options.setNodeLayer)?this.options.setNodeLayer:null;for(;s.length&&l<i;){r=[],n={};for(let t=0,i=s.length;t<i;t++){let i=s[t];if(i&&(i.depth=o&&null!=(e=o(i.datum))?e:l,o&&(a=Math.max(i.depth,a)),i.sourceLinks&&i.sourceLinks.length))for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t];n[e.target]||(r.push(this._nodeMap[e.target]),n[e.target]=!0)}}s=r,l+=1}l>i&&this._logger.warn("Error: there is a circular link"),this._maxDepth=o?a+1:l}computeNodeEndDepths(t){let e=t.length,i,r,n=t,s=0;for(;n.length&&s<e;){i=[],r={};for(let t=0,e=n.length;t<e;t++){let e=n[t];if(e){e.endDepth=s;for(let t=0,n=e.targetLinks.length;t<n;t++){let n=e.targetLinks[t];r[n.source]||(i.push(this._nodeMap[n.source]),r[n.source]=!0)}}}n=i,s+=1}s>e&&this._logger.warn("Error: there is a circular link")}computeNodeLayers(t){let e=this.options.nodeWidth,i=this.options.linkWidth,r=this.options.minStepWidth,n=this._viewBox.width,s=null,l=null,a=!1;if(t6(e)){let t=eG(parseFloat(e.replace("%",""))/100,0,1),i=n/(this._maxDepth-1+t);r>0&&(i=Math.max(r,i)),s=i*t,l=i*(1-t),a=!0}else if(tG(e)){if(s=e,tG(i))l=i;else if(er(i)){let t=(n-e)/(this._maxDepth-1);r>0&&(t=Math.max(r,t)),l=t-e}a=!0}else tQ(e)&&tG(i)&&(l=i);let o=[];for(let e=0,i=t.length;e<i;e++){let i=t[e];i.layer=this._isHierarchic?i.depth:eG(Math.floor(this._alignFunc(i,this._maxDepth,this._nodeMap)),0,this._maxDepth-1);let r=i.layer;r===this._maxDepth-1&&(i.isLastLayer=!0),a&&(i.x0=this._viewBox.x0+r*(s+l),i.x1=i.x0+s),o[r]?o[r].push(i):o[r]=[i]}if(this.options.nodeSortBy)for(let t=0,e=o.length;t<e;t++)o[t].sort(this.options.nodeSortBy);if(!a&&tQ(e)){let t=this._viewBox.x0;for(let r=0;r<this._maxDepth;r++){let n=o[r],a=0,h=0;for(let r=0,o=n&&n.length;r<o;r++){let o=n[r],u=e(o);o.x0=t,o.x1=t+u,a=Math.max(s,u);let d=o.sourceLinks;for(let t=0,e=d.length;t<e;t++){let e=d[t];h=Math.max(h,tQ(i)?i(e,this._viewBox):l)}}t+=a+h}}return o}initializeNodeBreadths(t){var e,i,r;let n=null!=(e=this.options.minLinkHeight)?e:0,s=null!=(i=this.options.minNodeHeight)?i:0,l=null!=(r=this.options.maxNodeHeight)?r:1/0,a=this.options.maxLinkHeight;(er(s)||s<n)&&(s=n),(er(a)||a>l)&&(a=l);let o=0,h=null,u=null;if(tQ(this.options.nodeGap))h=this.options.nodeGap,o=t.reduce((t,e)=>{let i=e.reduce((t,e)=>t+e.value,0),r=e.reduce((t,e)=>t+this.options.nodeGap(e),0);return Math.min(t,(this._viewBox.height-r)/i)},1/0);else{let e=t.reduce((t,e)=>Math.max(t,e.length),0),i=this._viewBox.height/e,r=Math.min(this.options.nodeGap,i);if(s+r>i&&(r=s>=i?i/2:(i-s)/2,s=Math.min(i-r,s)),h=()=>r,this._gapY=r,this.options.equalNodeHeight)u=this._viewBox.height/e-r;else{let e=s>0?Math.max(r,s):r;o=t.reduce((t,i)=>{let r=i.reduce((t,e)=>t+e.value,0);return Math.min(t,(this._viewBox.height-((i.length-1)*e+s))/r)},1/0)}}let d="start"===this.options.gapPosition,c=!d&&"end"!==this.options.gapPosition,p=tG(this.options.nodeHeight)?t=>this.options.nodeHeight:tQ(this.options.nodeHeight)?this.options.nodeHeight:u>0?t=>u:t=>Math.max(t.value*o,0),g=tG(this.options.linkHeight)?()=>this.options.linkHeight:tQ(this.options.linkHeight)?this.options.linkHeight:(t,e,i)=>Math.min(Math.max(e.value?i*Ag(t.value/e.value):0,n,0),a);for(let e=0,i=t.length;e<i;e++){let i=t[e];if(!i||!i.length)continue;let r=this._viewBox.y0,n=0,a=0,o=0;for(let t=0,e=i.length;t<e;t++){let e=i[t];n=h(e),d&&(r+=n),a=Math.min(Math.max(o=p(e),s),l),e.y0=r,e.y1=r+a,r=d?e.y1:e.y1+n;for(let t=0,i=e.sourceLinks.length;t<i;t++){let i=e.sourceLinks[t];i.thickness=g(i,e,o)}}let u=this._viewBox.y1-r+(c?n:0);if(u>0)if("start"===this.options.crossNodeAlign);else if("end"===this.options.crossNodeAlign)for(let t=0,e=i.length;t<e;++t){let e=i[t];e.y0+=u,e.y1+=u}else if("parent"===this.options.crossNodeAlign){let r=i.reduce((t,e)=>(e.targetLinks&&e.targetLinks.length&&e.targetLinks.forEach(e=>{t[e.source]=!0}),t),{});if(Object.keys(r).length&&t[e-1]&&t[e-1].length){let n=t[e-1].filter(t=>r[t.key]);if(n&&n.length&&n[0].y0!==i[0].y0){let t=n[0].y0-i[0].y0;for(let e=0,r=i.length;e<r;++e){let r=i[e];r.y0+=t,r.y1+=t}}}}else{u/=i.length+1;for(let t=0,e=i.length;t<e;++t){let e=i[t];e.y0+=u*(t+1),e.y1+=u*(t+1)}}else if(u<0&&i.length>1&&n+(u/=i.length-1)>=0){n+=u,this._gapY=Math.min(n);for(let t=1,e=i.length;t<e;++t){let e=i[t];e.y0+=u*t,e.y1+=u*t}}this.reorderLinks(i)}}computeNodeBreadths(t){let e=this.computeNodeLayers(t);this.initializeNodeBreadths(e);let i=this.options.iterations;if(!this._isHierarchic&&!tQ(this.options.setNodeLayer)&&!tQ(this.options.nodeGap))for(let t=0;t<i;++t){let r=Math.pow(.99,t),n=Math.max(1-r,(t+1)/i);this.relaxRightToLeft(e,r,n),this.relaxLeftToRight(e,r,n)}return e}relaxLeftToRight(t,e,i){for(let r=1,n=t.length;r<n;++r){let n=t[r];for(let t=0,i=n.length;t<i;t++){let i=n[t],r=0,s=0;for(let t=0,e=i.targetLinks.length;t<e;t++){let e=i.targetLinks[t],n=e.value*(i.layer-this._nodeMap[e.source].layer);r+=this.targetTop(this._nodeMap[e.source],i)*n,s+=n}if(!(s>0))continue;let l=(r/s-i.y0)*e;i.y0+=l,i.y1+=l,this.reorderNodeLinks(i)}er(this.options.nodeSortBy)&&n.sort(Ad),this.resolveCollisions(n,i)}}relaxRightToLeft(t,e,i){for(let r=t.length-2;r>=0;--r){let n=t[r];for(let t=0,i=n.length;t<i;t++){let i=n[t],r=0,s=0;for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t],n=e.value*(this._nodeMap[e.target].layer-i.layer);r+=this.sourceTop(i,this._nodeMap[e.target])*n,s+=n}if(!(s>0))continue;let l=(r/s-i.y0)*e;i.y0+=l,i.y1+=l,this.reorderNodeLinks(i)}void 0===this.options.nodeSortBy&&n.sort(Ad),this.resolveCollisions(n,i)}}resolveCollisions(t,e){let i=t.length>>1,r=t[i];this.resolveCollisionsBottomToTop(t,r.y0-this._gapY,i-1,e),this.resolveCollisionsTopToBottom(t,r.y1+this._gapY,i+1,e),this.resolveCollisionsBottomToTop(t,this._viewBox.y1,t.length-1,e),this.resolveCollisionsTopToBottom(t,this._viewBox.y0,0,e)}resolveCollisionsTopToBottom(t,e,i,r){for(;i<t.length;++i){let n=t[i],s=(e-n.y0)*r;s>1e-6&&(n.y0+=s,n.y1+=s),e=n.y1+this._gapY}}resolveCollisionsBottomToTop(t,e,i,r){for(;i>=0;--i){let n=t[i],s=(n.y1-e)*r;s>1e-6&&(n.y0-=s,n.y1-=s),e=n.y0-this._gapY}}targetTop(t,e){let i,r,n,s=t.y0-(t.sourceLinks.length-1)*this._gapY/2;for(i=0,r=t.sourceLinks.length;i<r&&(n=t.sourceLinks[i]).target!==e.key;i++)s+=n.thickness+this._gapY;for(i=0,r=e.targetLinks.length;i<r&&(n=e.targetLinks[i]).source!==t.key;i++)s-=n.thickness;return s}sourceTop(t,e){let i,r,n,s=e.y0-(e.targetLinks.length-1)*this._gapY/2;for(i=0,r=e.targetLinks.length;i<r&&(n=e.targetLinks[i]).source!==t.key;i++)s+=n.thickness+this._gapY;for(i=0,r=t.sourceLinks.length;i<r&&(n=t.sourceLinks[i]).target!==e.key;i++)s-=n.thickness;return s}computeLinkBreadthsNoOverlap(t){for(let e=0,i=t.length;e<i;e++){let i=t[e],r=i.y0,n=!1;for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t];n||(e.y0=r+e.thickness/2),e.x0=i.x1,r+e.thickness>i.y1||n?(e.y0=i.y1-e.thickness/2,n=!0):r+=e.thickness}let s=i.y0;n=!1;for(let t=0,e=i.targetLinks.length;t<e;t++){let e=i.targetLinks[t];n||(e.y1=s+e.thickness/2),e.x1=i.x0,s+e.thickness>i.y1||n?(e.y1=i.y1-e.thickness/2,n=!0):s+=e.thickness}}}computeLinkBreadthsOverlap(t){let e=this.options.linkOverlap;for(let i=0,r=t.length;i<r;i++){let r=t[i],n="start"===e?r.y0:"end"===e?r.y1:(r.y0+r.y1)/2,s="start"===e?.5:"end"===e?-.5:0;for(let t=0,e=r.sourceLinks.length;t<e;t++){let e=r.sourceLinks[t];e.y0=n+s*e.thickness,e.x0=r.x1}for(let t=0,e=r.targetLinks.length;t<e;t++){let e=r.targetLinks[t];e.y1=n+s*e.thickness,e.x1=r.x0}}}computeLinkBreadths(t){this.options.linkOverlap?this.computeLinkBreadthsOverlap(t):this.computeLinkBreadthsNoOverlap(t)}reorderNodeLinks(t){if(er(this.options.linkSortBy)){let e=t.targetLinks,i=t.sourceLinks;for(let t=0,i=e.length;t<i;t++){let i=e[t];this._nodeMap[i.source].sourceLinks.sort(this._ascendingTargetBreadth)}for(let t=0,e=i.length;t<e;t++){let e=i[t];this._nodeMap[e.target].targetLinks.sort(this._ascendingSourceBreadth)}}}reorderLinks(t){if(er(this.options.linkSortBy))for(let e=0,i=t.length;e<i;e++){let i=t[e];i.sourceLinks.sort(this._ascendingTargetBreadth),i.targetLinks.sort(this._ascendingSourceBreadth)}}}Af.defaultOptions={iterations:6,nodeAlign:"justify",direction:"horizontal",nodeWidth:24,nodeGap:8,crossNodeAlign:"middle",dropIsolatedNode:!0};let Am=(t,e,i)=>{e.forEach(e=>{er(e[i])||t.add(e[i]),e.children&&e.children.length>0&&Am(t,e.children,i)})},Ay=t=>{var e;if(!t||!tq(t))return[];if(t.length>1){let e={links:[],nodes:[]};return t.forEach(t=>{"links"!==t.id&&"nodes"!==t.id||(e[t.id]=t.values)}),[e]}return(null==(e=t[0])?void 0:e.latestData)?t[0].latestData:t},Av=(t,e)=>{if(!t||!(null==e?void 0:e.view)||!t.length)return[];let i=e.view();if(i.x1-i.x0==0||i.y1-i.y0==0||i.x1-i.x0==-1/0||i.x1-i.x0==1/0||i.y1-i.y0==-1/0||i.y1-i.y0==1/0)return[];let r=t[0];if(("source"!==e.sourceField||"target"!==e.targetField||"value"!==e.valueField)&&r.links){let t=[];r.links.forEach(i=>{let r={};for(let t in i)t===e.sourceField?r.source=i[e.sourceField]:t===e.targetField?r.target=i[e.targetField]:t===e.valueField?r.value=i[e.valueField]:r[t]=i[t];t.push(r)}),r.links=t}let n=new Af(e),s=[];return s.push(n.layout(r,i)),s},Ab=t=>{var e,i;return t&&tq(t)&&(null==(e=t[0])?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!=(i=t[0].latestData[0].nodes)?i:[]},A_=t=>{var e,i;return t&&tq(t)&&(null==(e=t[0])?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!=(i=t[0].latestData[0].links)?i:[]};class Ax extends cs{constructor(){super(...arguments),this._getDimensionData=t=>{if(t.source){if(tG(t.source)){let e=this.series.getSeriesKeys();return e[t.source]+" => "+e[t.target]}return t.source+" => "+t.target}return t.datum?t.datum[this.series.getSpec().categoryField]:t.key},this.markTooltipValueCallback=t=>t.value}}let AC=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:{overall:e?t.growFrom():e,orient:"positive"}}),Aw=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:AC(t),AS=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"linkPathGrowIn"},AA=(t,e,i)=>{let r={x0:t.getFinalAttribute().x0,x1:t.getFinalAttribute().x1,y0:t.getFinalAttribute().y0,y1:t.getFinalAttribute().y1,thickness:t.getFinalAttribute().thickness};return{from:Object.assign({},r,{x1:r.x0,y1:r.y0}),to:r}},AM=(t,e,i)=>{let r={x0:t.getFinalAttribute().x0,x1:t.getFinalAttribute().x1,y0:t.getFinalAttribute().y0,y1:t.getFinalAttribute().y1,thickness:t.getFinalAttribute().thickness};return{from:r,to:Object.assign({},r,{x1:r.x0,y1:r.y0})}};class Ak extends aq.rd{onBind(){var t,e,i;super.onBind(),(null==(t=this.params)?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);let{from:r,to:n}=AA(this.target,this.params.options,this.params),s=null!=(i=null==(e=this.target.context)?void 0:e.lastAttrs)?i:r,l=this.target.getFinalAttribute();l&&Object.assign(this.target.attribute,l),this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.animate.reSyncProps(),this.from=s,this.to=n,this.target.setAttributes(s)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}class AT extends aq.rd{onBind(){var t,e,i;super.onBind(),(null==(t=this.params)?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);let{from:r,to:n}=AM(this.target,this.params.options,this.params),s=null!=(i=null==(e=this.target.context)?void 0:e.lastAttrs)?i:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.animate.reSyncProps(),this.from=s,this.to=n,this.target.setAttributes(s)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}let AR=()=>{iv.registerAnimation("sankeyNode",(t,e)=>Object.assign({appear:Aw(t,e)},u2)),iv.registerAnimation("sankeyLinkPath",(t,e)=>({appear:AS(e),enter:{type:"linkPathGrowIn"},exit:{type:"linkPathGrowOut"},disappear:{type:"linkPathGrowOut"}})),uO.a.registerBuiltInAnimate("linkPathGrowOut",AT),uO.a.registerBuiltInAnimate("linkPathGrowIn",Ak)},AB=(t,e)=>{var i;let r=null!=(i=t.curvature)?i:.5,n="number"==typeof e?t.thickness*e:t.thickness,s=t.x0,l=t.x1,a=t.y0,o=t.y1,h=s+r*(l-s),u=l+r*(s-l),d=t=>t;!1!==t.round&&(s=Math.round(s),l=Math.round(l),a=Math.round(a),o=Math.round(o),h=Math.round(h),u=Math.round(u),d=Math.round),"line"===t.pathType||t.pathType,"center"===t.align?(a=d(t.y0-n/2),o=d(t.y1-n/2)):"end"===t.align?(a=d(t.y0+t.thickness/2-n),o=d(t.y1+t.thickness/2-n)):(a=d(t.y0-t.thickness/2),o=d(t.y1-t.thickness/2));let c=d(a+n),p=d(o+n),g=Math.abs(l-s)>1e-6,f=t.endArrow&&g?`L${l},${d(o-n/2)}L${d(l+n)},${d((o+p)/2)}L${l},${d(p+n/2)}`:"",m=t.startArrow&&g?`L${s},${d(c+n/2)}L${d(s-n)},${d((a+c)/2)}L${s},${d(a-n/2)}`:"";return"line"===t.pathType?`M${s},${a}L${l},${o}${f}L${l},${p}L${s},${c}${m}Z`:"polyline"===t.pathType?`M${s},${a}L${h},${a}L${h},${o}L${l},${o}
    ${f}L${l},${p}L${h},${p}L${h},${c}L${s},${c}${m}Z`:`M${s},${a}C${h},${a},${u},${o},${l},${o}
  ${f}L${l},${p}C${u},${p},${h},${c},${s},${c}${m}Z`},AP=(t,e)=>{var i;let r=null!=(i=t.curvature)?i:.5,n="number"==typeof e?t.thickness*e:t.thickness,s=t.y0,l=t.y1,a=t.x0,o=t.x1,h=s+r*(l-s),u=l+r*(s-l),d=t=>t;!1!==t.round&&(d=Math.round,s=Math.round(s),l=Math.round(l),a=Math.round(a),o=Math.round(o),h=Math.round(h),u=Math.round(u)),"line"===t.pathType||t.pathType,"center"===t.align?(a=d(t.x0-n/2),o=d(t.x1-n/2)):"end"===t.align?(a=d(t.x0+t.thickness/2-n),o=d(t.x1+t.thickness/2-n)):(a=d(t.x0-t.thickness/2),o=d(t.x1-t.thickness/2));let c=d(a+n),p=d(o+n),g=Math.abs(l-s)>1e-6,f=t.endArrow&&g?`L${d(o-n/2)},${l}L${d((o+p)/2)},${d(l+n)}L${d(p+n/2)},${l}`:"",m=t.startArrow&&g?`L${d(c+n/2)},${s}L${d((c+a)/2)},${d(s-n)}L${d(a-n/2)},${s}`:"";return"line"===t.pathType?`M${a},${s}L${o},${l}${f}L${p},${l}L${c},${s}${m}Z`:"polyline"===t.pathType?`M${a},${s}L${a},${h}L${o},${h}L${o},${l}
    ${f}L${p},${l}L${p},${h}L${c},${h}L${c},${s}${m}Z`:`M${a},${s}C${a},${h},${o},${u},${o},${l}
  ${f}L${p},${l}C${p},${u},${c},${h},${c},${s}${m}Z`};class AE extends SX{constructor(){super(...arguments),this.type=AE.type,this._subMarks={back:{type:"path",defaultAttributes:{zIndex:0}},front:{type:"path",defaultAttributes:{zIndex:1}}},this._positionChannels=["x0","y0","x1","y1","thickness","round","curvature","ratio","pathType","align","endArrow","startArrow","ratio"],this._channelEncoder={backgroundStyle:t=>({back:t})},this._positionEncoder=(t,e,i)=>{var r,n;let s=Object.assign(Object.assign({},i.attribute),t),l=["vertical","TB","BT"].includes(null!=(r=s.direction)?r:null==(n=this._glyphConfig)?void 0:n.direction)?AP:AB,a="number"==typeof s.ratio&&s.ratio>=0&&s.ratio<=1;return{back:{path:a?l(s,1):""},front:{path:l(s,a?s.ratio:1)}}}}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,x0:0,y0:0,x1:100,y1:100,thickness:1,round:!0})}}AE.type="linkPath";let AI=()=>{Sq(),(0,yE.N)(),iv.registerGraphicComponent("path",t=>(0,yI.E)(t)),iv.registerMark(AE.type,AE)},AL=Object.assign(Object.assign({},cy),{node:{name:"node",type:"rect"},link:{name:"link",type:"linkPath"}});class AF extends cE{_transformLabelSpec(t){this._addMarkLabelSpec(t,"node")}}let AO=(t,e,i,r=!0,n)=>{t.runtimeStateCache||(t.runtimeStateCache={}),t.runtimeStateCache[e]=i,t.hasState(e)&&t.removeState(e),t.addState(e,r,n)};class AD extends cD{constructor(){super(...arguments),this.type=rR.sankey,this.transformerConstructor=AF,this._nodeLayoutZIndex=H.Node,this._labelLayoutZIndex=H.Label,this._viewBox=new pY,this._fillByNode=t=>{var e,i,r,n,s;if(t&&t.sourceRect&&t.targetRect)return this._fillByLink(t);let l=null==(i=null==(e=this._spec.node)?void 0:e.style)?void 0:i.fill;if(t8(l))return l;if(t8(this._spec.seriesField)){let e=null==(n=null==(r=this._option)?void 0:r.globalScale)?void 0:n.getScale("color"),i=(null==t?void 0:t.datum)?t.datum:t;return null==e?void 0:e.scale(null==i?void 0:i[this._spec.seriesField])}return null==(s=this._colorScale)?void 0:s.scale(this._getNodeNameFromData(t))},this._fillByLink=t=>{var e,i,r,n,s,l;let a=null==(i=null==(e=this._spec.link)?void 0:e.style)?void 0:i.fill;if(a)return a;if(t8(this._spec.seriesField)){let e=null==(r=this._nodesSeriesData.latestData)?void 0:r.find(e=>t.source===e.key),i=null==e?void 0:e.datum,l=null==(s=null==(n=this._option)?void 0:n.globalScale)?void 0:s.getScale("color");return null==l?void 0:l.scale(null==i?void 0:i[this._spec.seriesField])}let o=tG(t.source)?this.getNodeList()[t.source]:t.source;return null==(l=this._colorScale)?void 0:l.scale(o)},this._handleEmphasisElement=t=>{var e;let i=null!=(e=this._spec.emphasis)?e:{},r=t.item;"adjacency"===i.effect?r&&t.mark===this._nodeMark?this._handleNodeAdjacencyClick(r):r&&t.mark===this._linkMark?this._handleLinkAdjacencyClick(r):this._handleClearEmpty():"related"===i.effect&&(r&&t.mark===this._nodeMark?this._handleNodeRelatedClick(r):r&&t.mark===this._linkMark?this._handleLinkRelatedClick(r):this._handleClearEmpty())},this._handleClearEmpty=()=>{var t,e;if(!this._needClear)return;let i=null==(t=this._nodeMark)?void 0:t.getGraphics();if(!i||!i.length)return;let r=null==(e=this._linkMark)?void 0:e.getGraphics();r&&r.length&&(i.forEach(t=>{t.removeState(j.STATE_SANKEY_EMPHASIS),t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE)}),r.forEach(t=>{t.removeState(j.STATE_SANKEY_EMPHASIS),t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE)}),this._needClear=!1)},this._handleNodeAdjacencyClick=t=>{let e=iZ(t),i=[e.key];if(this._linkMark){let t=this._linkMark.getGraphics();if(!t||!t.length)return;t.forEach((t,r)=>{let n=iZ(t);n.source===e.key?(i.includes(n.target)||i.push(n.target),t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(j.STATE_SANKEY_EMPHASIS,!0)):n.target===e.key?(i.includes(n.source)||i.push(n.source),t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(j.STATE_SANKEY_EMPHASIS,!0)):(t.removeState(j.STATE_SANKEY_EMPHASIS),t.addState(j.STATE_SANKEY_EMPHASIS_REVERSE,!0))})}this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),i),this._needClear=!0},this._handleLinkAdjacencyClick=t=>{let e=iZ(t),i=[e.source,e.target];if(this._linkMark){let e=this._linkMark.getGraphics();if(!e||!e.length)return;e.forEach(e=>{e===t?(e.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE),AO(e,j.STATE_SANKEY_EMPHASIS,{ratio:1})):(e.removeState(j.STATE_SANKEY_EMPHASIS),e.addState(j.STATE_SANKEY_EMPHASIS_REVERSE,!0))})}this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),i),this._needClear=!0},this._handleNodeRelatedClick=t=>{var e;let i=iZ(t),r=this._nodeMark.getGraphics();if(!r||!r.length)return;let n=this._linkMark.getGraphics();if(!n||!n.length)return;let s=(null==(e=iZ(n[0]))?void 0:e.parents)?"parents":"source";if("source"===s){let t=[i.key],e=[];if(n.forEach((n,s)=>{var l,a,o,h;let u=iZ(n),d=(null==u?void 0:u.parents)?"parents":"source";if(ed(u[d]).includes(i.key)){if(e.includes(null!=(l=u.key)?l:u.index)||e.push(null!=(a=u.key)?a:u.index),t.includes(u.source)||t.push(u.source),!t.includes(u.target)){t.push(u.target);let i=r.find(t=>t.data[0].key===u.target).data[0].sourceLinks;for(;(null==i?void 0:i.length)>0;){let n=[];return i.forEach(i=>{var s,l;if(!e.includes(null!=(s=i.key)?s:i.index)&&(e.push(null!=(l=i.key)?l:i.index),!t.includes(i.target))){t.push(i.target);let e=r.find(t=>t.data[0].key===i.target);n.push(e.data[0].targetLinks)}}),void(i=n)}}}else if(u.target===i.key&&(e.includes(null!=(o=u.key)?o:u.index)||e.push(null!=(h=u.key)?h:u.index),!t.includes(u.source))){t.push(u.source);let i=r.find(t=>t.data[0].key===u.source).data[0].targetLinks;for(;(null==i?void 0:i.length)>0;){let n=[];return i.forEach(i=>{var s,l;if(!e.includes(null!=(s=i.key)?s:i.index)&&(e.push(null!=(l=i.key)?l:i.index),!t.includes(i.source))){t.push(i.source);let e=r.find(t=>t.data[0].key===i.source);n.push(e.data[0].targetLinks)}}),void(i=n)}}}),this._linkMark){let t=this._linkMark.getGraphics();if(!t||!t.length)return;t.forEach((t,i)=>{var r;let n=iZ(t);e.includes(null!=(r=n.key)?r:n.index)?(t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(j.STATE_SANKEY_EMPHASIS,!0)):(t.removeState(j.STATE_SANKEY_EMPHASIS),t.addState(j.STATE_SANKEY_EMPHASIS_REVERSE,!0))})}this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),t)}else{let t=[i.key],e=i.targetLinks.reduce((t,e)=>(ed(e.datum).forEach(e=>{let r=e.parents,n=r.length;for(let s=0;s<n;s++){let n=r[s].key,l=r[s+1]?r[s+1].key:i.key,a=e.value,o=t.find(t=>t.source===n&&t.target===l);o?o.value+=a:t.push({source:n,target:l,value:a})}}),t),[]);n.forEach((r,n)=>{let l=iZ(r),a=l.datum,o=a?a.filter(t=>t[s].some(t=>t.key===i.key)):null,h=e.find(t=>t.source===l.source&&t.target===l.target);if(o&&o.length){t.includes(l.source)||t.push(l.source),t.includes(l.target)||t.push(l.target);let e=o.reduce((t,e)=>t+e.value,0)/l.value;return r.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE),void AO(r,j.STATE_SANKEY_EMPHASIS,{ratio:e})}if(h)return t.includes(l.source)||t.push(l.source),t.includes(l.target)||t.push(l.target),r.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE),void AO(r,j.STATE_SANKEY_EMPHASIS,{ratio:h.value/l.value});r.removeState(j.STATE_SANKEY_EMPHASIS),r.addState(j.STATE_SANKEY_EMPHASIS_REVERSE,!0)}),this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),t)}this._needClear=!0},this._handleLinkRelatedClick=t=>{let e=this._nodeMark.getGraphics();if(!e||!e.length)return;let i=this._linkMark.getGraphics();if(i&&i.length){if("source"==(iZ(t)?"parents":"source"))this._linkMark&&i.forEach(t=>{t.removeState(j.STATE_SANKEY_EMPHASIS),t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE)}),this._nodeMark&&e.forEach(t=>{t.removeState(j.STATE_SANKEY_EMPHASIS),t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE)});else{let r=iZ(t),n=[r.source,r.target],s=[];ed(r.datum).forEach(t=>{let e=t.parents,i=e.length;for(let r=0;r<i-1;r++){let i=e[r].key,n=e[r+1].key,l=t.value,a=s.find(t=>t.source===i&&t.target===n);s.push({source:e[r].key,target:e[r+1].key,value:t.value}),a?a.value+=l:s.push({source:i,target:n,value:l})}}),i.forEach(t=>{let e=iZ(t),i=e.datum;if(e.source===r.source&&e.target===r.target)return t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE),void AO(t,j.STATE_SANKEY_EMPHASIS,{ratio:1});let l=i?i.filter(t=>{let e=t.parents.map(t=>t.key);return e.includes(r.source)&&e.includes(r.target)}):null;if(l&&l.length){n.includes(e.source)||n.push(e.source),n.includes(e.target)||n.push(e.target);let i=l.filter(t=>t.parents.some((e,i)=>{var n;return e.key===r.source&&(null==(n=t.parents[i+1])?void 0:n.key)===r.target})).reduce((t,e)=>t+e.value,0)/e.value;return t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE),void AO(t,j.STATE_SANKEY_EMPHASIS,{ratio:i})}let a=s.find(t=>t.source===e.source&&t.target===e.target);if(a)return n.includes(e.source)||n.push(e.source),n.includes(e.target)||n.push(e.target),t.removeState(j.STATE_SANKEY_EMPHASIS_REVERSE),void AO(t,j.STATE_SANKEY_EMPHASIS,{ratio:a.value/e.value});t.removeState(j.STATE_SANKEY_EMPHASIS),t.addState(j.STATE_SANKEY_EMPHASIS_REVERSE,!0)}),this._highLightElements(e,n)}this._needClear=!0}}}get direction(){var t;return null!=(t=this._spec.direction)?t:"horizontal"}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:this._spec.categoryField)}initData(){var t,e,i,r;super.initData();let n=this.getViewData(),s=this.getRawData();if(s&&n){nq(this._dataSet,"sankeyLayout",Av),nq(this._dataSet,"sankeyFormat",Ay),s.transform({type:"sankeyFormat"},!1),n.transform({type:"sankeyLayout",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),sourceField:this._spec.sourceField,targetField:this._spec.targetField,valueField:this._spec.valueField,direction:this.direction,crossNodeAlign:this._spec.crossNodeAlign,nodeAlign:null!=(t=this._spec.nodeAlign)?t:"justify",nodeGap:null!=(e=this._spec.nodeGap)?e:8,nodeWidth:null!=(i=this._spec.nodeWidth)?i:10,linkWidth:this._spec.linkWidth,minStepWidth:this._spec.minStepWidth,minNodeHeight:null!=(r=this._spec.minNodeHeight)?r:4,maxNodeHeight:this._spec.maxNodeHeight,minLinkHeight:this._spec.minLinkHeight,maxLinkHeight:this._spec.maxLinkHeight,iterations:this._spec.iterations,nodeKey:this._spec.nodeKey,linkSortBy:this._spec.linkSortBy,nodeSortBy:this._spec.nodeSortBy,setNodeLayer:this._spec.setNodeLayer,dropIsolatedNode:this._spec.dropIsolatedNode,nodeHeight:this._spec.nodeHeight,linkHeight:this._spec.linkHeight,equalNodeHeight:this._spec.equalNodeHeight,linkOverlap:this._spec.linkOverlap,inverse:this._spec.inverse},level:F.sankeyLayout});let{dataSet:l}=this._option;nq(l,"sankeyNodes",Ab),nq(l,"flatten",wf);let a=new el(l,{name:`sankey-node-${this.id}-data`});a.parse([this.getViewData()],{type:"dataview"}),a.transform({type:"sankeyNodes"}),a.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}},!1),a.transform({type:"addVChartProperty",options:{beforeCall:cp.bind(this),call:cg}},!1),this._nodesSeriesData=a,nq(l,"sankeyLinks",A_);let o=new el(l,{name:`sankey-link-${this.id}-data`});o.parse([this.getViewData()],{type:"dataview"}),o.transform({type:"sankeyLinks"}),o.transform({type:"addVChartProperty",options:{beforeCall:cp.bind(this),call:cg}},!1),this._linksSeriesData=o}}compileData(){var t,e;super.compileData(),null==(t=this._linkMark)||t.compileData(),null==(e=this._nodeMark)||e.compileData()}initMark(){this._rootMark.setMarkConfig({overflow:this._spec.overflow,interactive:!!this._spec.overflow});let t=this._createMark(AD.mark.node,{isSeriesMark:!0,dataView:this._nodesSeriesData});t&&(t.setMarkConfig({zIndex:this._nodeLayoutZIndex}),this._nodeMark=t);let e=this._createMark(AD.mark.link,{dataView:this._linksSeriesData});e&&(this._linkMark=e)}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToNode=this.valueToNode.bind(this),this._markAttributeContext.valueToLink=this.valueToLink.bind(this)}valueToNode(t){let e=this._nodesSeriesData.latestData,i=ed(t)[0];return e&&e.find(t=>t.key===i)}valueToLink(t){let e=this._linksSeriesData.latestData,i=ed(t);return e&&e.find(t=>t&&t.source===i[0]&&t.target===i[1])}valueToPositionX(t){let e=this.valueToNode(t);return null==e?void 0:e.x0}valueToPositionY(t){let e=this.valueToNode(t);return null==e?void 0:e.y0}initMarkStyle(){this._initNodeMarkStyle(),this._initLinkMarkStyle()}_initNodeMarkStyle(){var t,e;let i=this._nodeMark;i&&(this.setMarkStyle(i,{x:t=>t.x0,x1:t=>t.x1,y:t=>t.y0,y1:t=>t.y1},j.STATE_NORMAL,W.Mark),this.setMarkStyle(i,{fill:null!=(e=null==(t=this._spec.node.style)?void 0:t.fill)?e:this._fillByNode},"normal",W.User_Mark))}_initLinkMarkStyle(){var t,e;let i=this._linkMark;i&&(i.setGlyphConfig({direction:this.direction}),this.setMarkStyle(i,{x0:t=>t.x0,x1:t=>t.x1,y0:t=>t.y0,y1:t=>t.y1,thickness:t=>t.thickness},j.STATE_NORMAL,W.Series),this.setMarkStyle(i,{fill:null!=(e=null==(t=this._spec.link.style)?void 0:t.fill)?e:this._fillByLink},"normal",W.User_Mark))}initLabelMarkStyle(t,e){if(!t)return;let i=e.position;i&&i.includes("inside")?this.setMarkStyle(t,{fill:"#ffffff",text:t=>this._createText(t,e),maxLineWidth:t=>{var i;return null!=(i=e.limit)?i:t.x1-t.x0}}):this.setMarkStyle(t,{fill:this._fillByNode,text:t=>this._createText(t,e),maxLineWidth:e.limit}),t.setMarkConfig({zIndex:this._labelLayoutZIndex})}_createText(t,e){if(er(t)||er(t.datum))return"";let i=t.datum[this._spec.categoryField]||"",{formatMethod:r,formatter:n}=e||{},{formatFunc:s,args:l}=d4(r,n,i,t.datum);return s&&(i=s(...l,{series:this})),i}initAnimation(){var t,e,i,r;let n={direction:this.direction,growFrom:()=>{var t,e;return"horizontal"===this.direction?null==(t=this._xAxisHelper)?void 0:t.getScale(0).scale(0):null==(e=this._yAxisHelper)?void 0:e.getScale(0).scale(0)}},s=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._nodeMark&&this._nodeMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("sankeyNode"))?void 0:i(n,s),cM("node",this._spec,this._markAttributeContext))),this._linkMark&&this._linkMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("sankeyLinkPath"))?void 0:r(n,s),cM("link",this._spec,this._markAttributeContext)))}initEvent(){var t,e,i;super.initEvent(),null==(t=this._nodesSeriesData)||t.target.addListener("change",this.nodesSeriesDataUpdate.bind(this)),null==(e=this._linksSeriesData)||e.target.addListener("change",this.linksSeriesDataUpdate.bind(this));let r=null!=(i=this._spec.emphasis)?i:{};if(!0!==this._option.disableTriggerEvent&&r.enable&&("adjacency"===r.effect||"related"===r.effect)){let t="hover"===r.trigger?"pointerover":"pointerdown";this.event.on(t,{level:rF.chart},this._handleEmphasisElement)}}nodesSeriesDataUpdate(){this._nodeMark.getData().updateData(),this._nodeList=null,this._setNodeOrdinalColorScale()}linksSeriesDataUpdate(){this._linkMark.getData().updateData()}_highLightElements(t,e){t&&t.length&&t.forEach(t=>{t.removeState([j.STATE_SANKEY_EMPHASIS_REVERSE,j.STATE_SANKEY_EMPHASIS]),e.includes(iZ(t).key)?t.addState(j.STATE_SANKEY_EMPHASIS,!0):t.addState(j.STATE_SANKEY_EMPHASIS_REVERSE,!0)})}initTooltip(){this._tooltipHelper=new Ax(this),this._nodeMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodeMark),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark)}_setNodeOrdinalColorScale(){var t,e,i,r,n;let s,l,a=null==(e=null==(t=this._option)?void 0:t.globalScale)?void 0:e.getScale("color");if(null==a?void 0:a._specified)return void(this._colorScale=a);a&&(s=a.domain(),l=a.range()),l||(l=this._getDataScheme()),s&&!er(s[0])||(s=this.getNodeList())&&s.length>10&&(l=null==(i=this._getDataScheme()[1])?void 0:i.scheme);let o=new ar;null==(n=(r=o.domain(s)).range)||n.call(r,l),this._colorScale=o}getNodeList(){var t,e;if(this._nodeList)return this._nodeList;let i=this._rawData.latestData[0],r=(null==i?void 0:i.nodes)?(null==(t=i.nodes[0])?void 0:t.children)?Array.from(this.extractNamesFromTree(i.nodes,this._spec.categoryField)):i.nodes.map((t,e)=>t[this._spec.categoryField]):(null==i?void 0:i.links)?Array.from(this.extractNamesFromLink(i.links)):null==(e=null==i?void 0:i.values)?void 0:e.map((t,e)=>t[this._spec.categoryField]);return this._nodeList=r,r}_getNodeNameFromData(t){var e;return(null==t?void 0:t.datum)?t.datum[this._spec.categoryField]:null!=(e=t.key)?e:t[this._spec.categoryField]}extractNamesFromTree(t,e){let i=new Set;return t.forEach(t=>{i.add(t[e]),t.children&&this.extractNamesFromTree(t.children,e).forEach(t=>i.add(t))}),i}extractNamesFromLink(t){let e=new Set,{sourceField:i,targetField:r}=this._spec;return t.forEach(t=>{t8(t[i])&&e.add(t[i]),t8(t[r])&&e.add(t[r])}),e}getDimensionField(){return[this._spec.categoryField]}getMeasureField(){return[this._valueField]}getRawDataStatisticsByField(t,e){var i;return this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&(this._viewDataStatistics&&this.getViewData().transformsArr.length<=1&&(null==(i=this._viewDataStatistics.latestData)?void 0:i[t])?this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t]:this._rawData&&(this._rawStatisticsCache[t]={values:this._collectByField(t)})),this._rawStatisticsCache[t]}_collectByField(t){var e,i,r;let n=[],s=null==(i=null==(e=this.getRawData())?void 0:e.latestData)?void 0:i[0];if(!s)return[];if(s.links)(null==(r=s.nodes)?void 0:r.length)&&s.nodes.forEach(t=>{t[this._seriesField]&&n.push(t[this._seriesField])});else if(s.nodes){let t=new Set;return Am(t,s.nodes,this._seriesField),Array.from(t)}return n}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this.getViewData().reRunAllTransform()}getDefaultShapeType(){return"square"}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._nodeMark,this._linkMark]}getMarkData(t){return t.datum?tq(t.datum)?t.datum[t.datum.length-1]:t.datum:t}}AD.type=rR.sankey,AD.transformerConstructor=AF,AD.mark=AL,AD.builtInTheme={sankey:{link:{style:{fillOpacity:.15,round:!0}}}};let AH=()=>{yi(),AI(),_B(),AR(),u5(),iv.registerSeries(AD.type,AD)};class Az extends fD{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","sourceField","targetField","direction","nodeAlign","crossNodeAlign","nodeGap","nodeWidth","linkWidth","minStepWidth","minNodeHeight","maxNodeHeight","minLinkHeight","maxLinkHeight","dropIsolatedNode","nodeHeight","linkHeight","equalNodeHeight","linkOverlap","iterations","nodeKey","linkSortBy","nodeSortBy","setNodeLayer","node","link","emphasis","inverse","overflow"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}var AW=i(17959),AN=i(57823);let Aj=Q=class{constructor(){this.name="scrollbar",this.activeEvent="onRegister",this._uid=oE.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.scroll=t=>{var e,i;let r=t.target,n=this.getScrollContainer(r);if(!n&&!this.scrollContainer)return;if(!n&&this.scrollContainer){if(!this.scrollContainer.g.stage||this.scrollContainer.g.stage!==r.stage)return;let t=this.formatScrollContainer(this.scrollContainer.g);if(!t)return void this.clearScrollbar(this.scrollContainer.g,"all");this.scrollContainer.showH&&!t.showH&&this.clearScrollbar(this.scrollContainer.g,"horizontal"),this.scrollContainer.showV&&!t.showV&&this.clearScrollbar(this.scrollContainer.g,"vertical"),this.scrollContainer=t}else n&&this.scrollContainer&&n.g!==this.scrollContainer.g&&this.clearScrollbar(this.scrollContainer.g,"all");if(this.scrollContainer=null!=n?n:this.scrollContainer,!n)return;let s=n.g;if(!s)return;let{width:l,height:a,scrollX:o=0,scrollY:h=0}=s.attribute,u=o,d=h,{showH:c,showV:p}=n;this.scrollContainerBounds=(new aI.YZ).set(0,0,s.attribute.width,s.attribute.height),c&&c&&((0,g2.Wn)(t.deltaX)>(0,g2.Wn)(t.deltaY)?(c=c&&!0,p=p&&!1):(c=c&&!1,p=p&&!0));let g=this.childrenBounds.width(),f=this.childrenBounds.height();c&&((u=o-(null!=(e=t.deltaX)?e:0))>0?u=0:u<l-g&&(u=l-g)),p&&((d=h-(null!=(i=t.deltaY)?i:0))>0?d=0:d<a-f&&(d=a-f)),s.setAttributes({scrollX:u,scrollY:d}),this.addOrUpdateScroll(c,p,s.parent,s)},this.handleScrollBarChange=t=>{if(!(this.scrollContainer&&this.scrollContainerBounds&&this.childrenBounds&&t&&t.target&&t.detail&&t.detail.value))return;let e=t.target,i=t.detail.value;if("horizontal"===e.attribute.direction){let t=this.childrenBounds.width();this.scrollContainer.g.setAttributes({scrollX:-i[0]*t})}else{let t=this.childrenBounds.height();this.scrollContainer.g.setAttributes({scrollY:-i[0]*t})}}}activate(t){this.pluginService=t;let{stage:e}=this.pluginService;this.childrenBounds=new aI.FB,e.addEventListener("wheel",this.scroll),this.params=Q.defaultParams}initEventOfScrollbar(t,e,i){t.addEventListener("pointerover",()=>{e.setAttribute("visibleAll",!0)}),t.addEventListener("pointermove",()=>{e.setAttribute("visibleAll",!0)}),t.addEventListener("pointerout",()=>{e.setAttribute("visibleAll",!1)}),e.addEventListener("pointerover",()=>{e.setAttribute("visibleAll",!0)}),e.addEventListener("pointerout",()=>{e.setAttribute("visibleAll",!0)}),e.addEventListener("scrollUp",this.handleScrollBarChange),e.addEventListener(pe.eV,this.handleScrollBarChange)}addOrUpdateScroll(t,e,i,r){if(t){let{scrollBar:t,isUpdate:e}=this.addOrUpdateHScroll(r,i,!0);e||this.initEventOfScrollbar(r,t,!0)}else this.clearScrollbar(r,"horizontal");if(e){let{scrollBar:t,isUpdate:e}=this.addOrUpdateHScroll(r,i,!1);e||this.initEventOfScrollbar(r,t,!1)}else this.clearScrollbar(r,"vertical")}getDirection(t){return t?"horizontal":"vertical"}addOrUpdateHScroll(t,e,i){var r,n;let s=this.getDirection(i),l=`${null!=(r=t.name)?r:t._uid}_${this.getDirection(i)}_${this.name}`,a=e.children.filter(t=>t.name===l),o=!0,h=a[0],{y:u=0,dy:d=0,x:c=0,dx:p=0,height:g,width:f,zIndex:m=0}=this.scrollContainer.g.attribute,y={x:0,y:0,direction:s,zIndex:m+1,visibleAll:!0,padding:[2,0],railStyle:{fill:"rgba(0, 0, 0, .1)"},range:[0,.05]};i?(y.width=this.scrollContainerBounds.width(),y.height=12):(y.height=this.scrollContainerBounds.height(),y.width=12),h?a.length>1&&a.forEach((t,e)=>{var i;e&&(null==(i=t.parent)||i.removeChild(t))}):(o=!1,(h=new AN.B(y)).name=l,e.add(h),h.isScrollBar=!0);let v=this.childrenBounds,{scrollX:b,scrollY:_}=t.attribute;if(i){let t=Math.min(this.scrollContainerBounds.width()/v.width(),1),e=Math.max(Math.min(b/this.childrenBounds.width(),0),t-1);y.x=c+p,y.y=u+d+g-(null!=(n=y.height)?n:0),y.range=[-e,-e+t]}else{let t=Math.min(this.scrollContainerBounds.height()/v.height(),1),e=Math.max(Math.min(_/this.childrenBounds.height(),0),t-1);y.x=c+p+f-this.scrollContainerBounds.width(),y.y=u+d,y.range=[-e,-e+t]}return h.setAttributes(y),{scrollBar:h,isUpdate:o}}clearScrollbar(t,e){t.parent&&t.parent.children.filter(t=>t.isScrollBar&&("all"===e||t.attribute.direction===e)).forEach(t=>{t.parent.removeChild(t)})}formatScrollContainer(t){if(!t||"group"!==t.type||!t.attribute)return null;let{overflow:e,width:i,height:r}=t.attribute;if(!e||"hidden"===e)return null;let n=!1,s=!1;"scroll"===e?(n=!0,s=!0):s=!(n="scroll-x"===e);let l=this.childrenBounds;return l.clear(),t.forEachChildren(t=>{l.union(t.AABBBounds)}),t.AABBBounds.empty()||(n&&(n=i<l.width()),s&&(s=r<l.height())),n||s?{g:t,showH:n,showV:s}:null}getScrollContainer(t){let e=t;for(;e;){let t=this.formatScrollContainer(e);if(t)return t;e=e.parent}return null}deactivate(t){let{stage:e}=this.pluginService;e.removeEventListener("wheel",this.scroll)}};Aj.defaultParams={timeout:500},Aj=Q=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,oA.b)()],Aj);let AG=new oC.n((t,e,i,r)=>{i(Aj)||(t(Aj).toSelf(),t(AW.X).toService(Aj))});class AV extends fV{constructor(){super(...arguments),this.transformerConstructor=Az,this.type="sankey",this.seriesType=rR.sankey}_setStateInDatum(t,e,i,r){let n=tq(e)?e[0]:e;if(!n)return void this._interaction.clearByState(t);let s=null;this.filterGraphicsByDatum(n,{filter:(t,e)=>"text"!==e.type&&e.getProduct()&&(!i||i(t,e)),region:r,getDatum:t=>{var e;let i=null==(e=iZ(t))?void 0:e.datum;return tq(i)&&(i=i[0]),i},callback:(t,e,i,r)=>{var n;let s=e.getProductId();s&&(s.includes("node")||s.includes("link"))&&(null==(n=i._handleEmphasisElement)||n.call(i,{item:t,mark:e}))},regionCallback:(t,e)=>{n&&t.length&&(s=t[0])}}),s&&this._interaction.updateStateOfGraphics(t,[s])}}AV.type="sankey",AV.seriesType=rR.sankey,AV.transformerConstructor=Az;let AZ=()=>{mx(),o_.n.load(AG),AH(),iv.registerChart(AV.type,AV)};class AU extends cs{constructor(){super(...arguments),this._getMeasureData=t=>"horizontal"===this.series.getSpec().direction?t[this.series.getSpec().xField[0]]+"-"+t[this.series.getSpec().xField[1]]:t[this.series.getSpec().yField[0]]+"-"+t[this.series.getSpec().yField[1]]}}let AK=Object.assign({},mZ);class A$ extends m${constructor(){super(...arguments),this.type=rR.rangeArea}initMark(){this._areaMark=this._createMark(A$.mark.area,{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0]})}initMarkStyle(){this.initAreaMarkStyle()}initAreaMarkStyle(){let t=this._areaMark;t&&(super.initAreaMarkStyle(),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x1:t=>{if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})}},"normal",W.Series):this.setMarkStyle(this._areaMark,{y1:t=>{if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})}},"normal",W.Series),this.setMarkStyle(t,{stroke:!1},"normal",W.Series))}initTooltip(){this._tooltipHelper=new AU(this)}_isFieldAllValid(){let t=this.getViewDataStatistics(),e=this.fieldY;return!!(t&&t.latestData&&e.length)&&e.every(e=>t.latestData[e]&&t.latestData[e].allValid)}}A$.type=rR.rangeArea,A$.mark=AK;let AY=()=>{mG(),fl(),fb(),iv.registerSeries(A$.type,A$)};class AX extends fH{_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t);return r.area=t.area,r.point=t.point,r.line=t.line,"horizontal"===t.direction?r.xField=null!=(e=t.xField)?e:[t.minField,t.maxField]:r.yField=null!=(i=t.yField)?i:[t.minField,t.maxField],r.stack=!1,r}transformSpec(t){super.transformSpec(t),sW(t)}}class Aq extends fV{constructor(){super(...arguments),this.transformerConstructor=AX,this.type="rangeArea",this.seriesType=rR.rangeArea}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}Aq.type="rangeArea",Aq.seriesType=rR.rangeArea,Aq.transformerConstructor=AX;let AJ=()=>{mb(),mx(),mw(),f8(),fX(),AY(),iv.registerChart(Aq.type,Aq)};class AQ extends od{constructor(){super(...arguments),this.type=AQ.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{fill:void 0,lineWidth:0,padding:0})}_createGraphic(t={}){return(0,pN.t)(t)}_transformGraphicAttributes(t,e,i){var r,n,s;let l=super._transformGraphicAttributes(t,e,i),a=null!=(n=null!=(r=l.shape)?r:l.symbolType)?n:null==(s=t.attribute)?void 0:s.symbolType;return er(a)?l.symbolType="rect":l.symbolType=a,l}}AQ.type="cell";let A0=()=>{iv.registerMark(AQ.type,AQ),iv.registerGraphicComponent("symbol",pN.t),(0,oc.W)(),(0,pj.k)(),pH()},A1=()=>{iv.registerAnimation("heatmap",(t,e)=>Object.assign(Object.assign({},u2),{appear:!1===e?{}:{type:"fadeIn"}}))};function A2(t){if(en(t))return[t,t,t,t];if(tq(t)){let e=t.length;if(1===e){let e=t[0];return[e,e,e,e]}if(2===e){let[e,i]=t;return[e,i,e,i]}if(3===e){let[e,i,r]=t;return[e,i,r,i]}if(4===e)return t}if(e_(t)){let{top:e=0,right:i=0,bottom:r=0,left:n=0}=t;return[e,i,r,n]}return[0,0,0,0]}class A3 extends cs{enableByType(t){return"dimension"!==t}}let A5=Object.assign(Object.assign({},cy),{cell:{name:"cell",type:"cell"},cellBackground:{name:"cellBackground",type:"cell"}});class A4 extends cE{_transformLabelSpec(t){this._addMarkLabelSpec(t,"cell")}}class A6 extends cD{constructor(){super(...arguments),this.type=rR.heatmap,this.transformerConstructor=A4}getFieldValue(){return this._fieldValue}setFieldValue(t){this._fieldValue=ed(t)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFieldValue(this._spec.valueField)}initMark(){this._cellMark=this._createMark(A6.mark.cell,{isSeriesMark:!0},{morph:cR(this._spec,A6.mark.cell.name),morphElementKey:this.getDimensionField()[0]}),this._backgroundMark=this._createMark(A6.mark.cellBackground)}initMarkStyle(){this.initCellMarkStyle(),this.initCellBackgroundMarkStyle()}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getMeasureField()[0]]})}initCellMarkStyle(){this.setMarkStyle(this._cellMark,{x:t=>this.dataToPositionX(t),y:t=>this.dataToPositionY(t),size:()=>[this.getCellSize(this._xAxisHelper),this.getCellSize(this._yAxisHelper)],fill:this.getColorAttribute()},"normal",W.Series)}initCellBackgroundMarkStyle(){var t,e,i;let r=A2(null!=(i=null==(e=null==(t=this._spec.cellBackground)?void 0:t.style)?void 0:e.padding)?i:0);this.setMarkStyle(this._backgroundMark,{x:t=>{let e=this.getCellSize(this._xAxisHelper);return this.dataToPositionX(t)-e/2+r[3]},y:t=>{let e=this.getCellSize(this._yAxisHelper);return this.dataToPositionY(t)-e/2+r[0]},width:()=>this.getCellSize(this._xAxisHelper)-r[1]-r[3],height:()=>this.getCellSize(this._yAxisHelper)-r[0]-r[2]},"normal",W.Series)}getColorAttribute(){var t;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:this.getFieldValue[0]}}getInteractionTriggers(){return this._parseInteractionConfig(this._cellMark?[this._cellMark]:[])}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset,n=cO(this);this._cellMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("heatmap"))?void 0:i(r),cM("cell",this._spec,this._markAttributeContext),n))}getCellSize(t){var e,i;return null!=(i=null==(e=t.getBandwidth)?void 0:e.call(t,0))?i:6}initTooltip(){this._tooltipHelper=new A3(this),this._cellMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._cellMark)}getDefaultShapeType(){return"square"}getDimensionField(){return[].concat(this.fieldX,this.fieldY)}getMeasureField(){return this.getFieldValue()}getActiveMarks(){return[this._cellMark]}}A6.type=rR.heatmap,A6.mark=A5,A6.builtInTheme={heatmap:{cell:{style:{shape:"square",fillOpacity:1}},cellBackground:{visible:!1}}},A6.transformerConstructor=A4;let A8=()=>{_B(),A0(),A1(),fl(),fb(),iv.registerSeries(A6.type,A6)};class A9 extends fH{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["valueField","cell"])}}class A7 extends fV{constructor(){super(...arguments),this.transformerConstructor=A9,this.type="heatmap",this.seriesType=rR.heatmap}}A7.type="heatmap",A7.seriesType=rR.heatmap,A7.transformerConstructor=A9;let Mt=()=>{mx(),A8(),iv.registerChart(A7.type,A7)},Me=Object.assign(Object.assign({},cy),{nodePoint:{name:"nodePoint",type:"symbol"},ripplePoint:{name:"ripplePoint",type:"ripple"},centerPoint:{name:"centerPoint",type:"symbol"},centerLabel:{name:"centerLabel",type:"text"}}),Mi=(t,e)=>{let i,r,n=tQ(e)?e:t=>t;if(t&&t.length){let e=t.length;for(let s=0;s<e;s+=1){let e=n(t[s]);er(e)||!tG(e*=1)||Number.isNaN(e)||(er(i)?(i=e,r=e):(i=Math.min(i,e),r=Math.max(r,e)))}}return[i,r]},Mr=`${st}_CORRELATION_X`,Mn=`${st}_CORRELATION_Y`,Ms=`${st}_CORRELATION_SIZE`,Ml=(t,e)=>{var i,r,n,s,l,a,o,h,u,d,c,p,g,f,m;if(!t||!(null==e?void 0:e.view)||!tq(t))return t;let y=e.view();if(y.x1-y.x0==0||y.y1-y.y0==0||y.x1-y.x0==-1/0||y.x1-y.x0==1/0||y.y1-y.y0==-1/0||y.y1-y.y0==1/0)return t;let v=af(null!=(i=e.startAngle)?i:-90),b=af(null!=(r=e.endAngle)?r:270),_=Math.max((y.x1-y.x0)/2,(y.y1-y.y0)/2),x=wy(null!=(n=e.innerRadius)?n:0,_),C=wy(e.outerRadius,_),w=[tG(null==(s=e.center)?void 0:s[0])?e.center[0]:y.x0+wy(null!=(a=null==(l=e.center)?void 0:l[0])?a:"50%",y.x1-y.x0),tG(null==(o=e.center)?void 0:o[1])?e.center[1]:y.y0+wy(null!=(u=null==(h=e.center)?void 0:h[1])?u:"50%",y.y1-y.y0)],S=Ct(e.field),A=t.map(S),[M,k]=Mi(A),T=M===k?t=>(x+C)/2:t=>x+(C-x)*(t-M)/(k-M),R=er(e.radiusField)?S:Ct(e.radiusField),B=null!=(c=null==(d=null==e?void 0:e.radiusRange)?void 0:d[1])?c:5,P=t=>B;if(R){let[i,r]=R!==S?Mi(t.map(R)):[M,k],n=null!=(g=null==(p=e.radiusRange)?void 0:p[0])?g:5,s=null!=(m=null==(f=e.radiusRange)?void 0:f[1])?m:5;i!==r&&(P=t=>n+(s-n)*(R(t)-i)/(r-i))}let E=Math.min(v,b),I=Math.max(v,b),L=Ma(E,I,t.length),F=[],O=(I-E)/60;return t.forEach((t,e)=>{let i=T(A[e]),r=P(t),n,s,l=L[e];for(let t=0;t<60&&(Mo({x:n=w[0]+i*Math.cos(l),y:s=w[1]+i*Math.sin(l),size:r},F)||n-r<y.x0||n+r>y.x1||s-r<y.y0||s+r>y.y1);t++)t<59&&((l+=O)>I?l=E:l<E&&(l=I));F.push(Object.assign({[Mr]:n,[Mn]:s,[Ms]:r},t))}),F},Ma=(t,e,i)=>{let r=0,n=Math.max(Math.ceil(2*(e-t)/Math.PI),2),s=(e-t)/n,l=0,a=1,o=0,h=0,u=[],d=t;for(;o<i;)h<n&&(u.push(d+(h%2?Math.floor(h/2)+Math.floor(n/2):h/2)*s*a),h++),o++,h===n&&(h=0,l+=1,a*=-1,0===r?r=s/2:r/=2,d=-1===a?e-r:t+r,l>=2&&(s/=2,n*=2));return u},Mo=(t,e)=>!(!e||!e.length)&&e.some(e=>Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<Math.pow(t.size+e.size,2)),Mh=(t,e)=>{if(!t||!tq(t))return[];let{keyword:i,categoryField:r}=e,n=t[0].latestData[0];return{[r]:i,[sn]:null==n?void 0:n[sn],[sl]:null==n?void 0:n[sl]}};class Mu extends SX{constructor(){super(...arguments),this.type=Mu.type,this._subMarks={ripple0:{type:"symbol",defaultAttributes:{fillOpacity:.75}},ripple1:{type:"symbol",defaultAttributes:{fillOpacity:.5}},ripple2:{type:"symbol",defaultAttributes:{fillOpacity:.25}}},this._positionChannels=["ripple","size"],this._positionEncoder=(t,e,i)=>{let{ripple:r=i.attribute.ripple,size:n=i.attribute.size}=t,s=eG(r,0,1),l=.5*n;return{ripple0:{size:n+l*s,fillOpacity:.75-.25*s},ripple1:{size:n+l*(1+s),fillOpacity:.5-.25*s},ripple2:{size:n+l*(2+s),fillOpacity:.25-.25*s}}}}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,ripple:0})}}Mu.type="ripple";let Md=()=>{Sq(),(0,pj.k)(),iv.registerMark(Mu.type,Mu),iv.registerGraphicComponent("symbol",t=>(0,pN.t)(t))},Mc=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"},Mp=()=>{iv.registerAnimation("correlation",(t,e)=>Object.assign({appear:Mc(0,e)},u1))};class Mg extends cE{_transformLabelSpec(t){this._addMarkLabelSpec(t,"nodePoint"),this._addMarkLabelSpec(t,"centerPoint","centerLabel")}}class Mf extends v1{constructor(){super(...arguments),this.type=rR.correlation,this.transformerConstructor=Mg,this._viewBox=new pY}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}getSeriesField(){return this._seriesField}setSeriesField(t){t8(t)&&(this._seriesField=t)}getSizeField(){return this._sizeField}setSizeField(t){t8(t)&&(this._sizeField=t)}getSizeRange(){return this._sizeRange}setSizeRange(t){t8(t)&&(this._sizeRange=t)}setAttrFromSpec(){super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(this._spec.seriesField),this.setSizeField(this._spec.sizeField),this.setSizeRange(this._spec.sizeRange)}initData(){var t,e,i;if(super.initData(),!this._data)return;nq(this._dataSet,"correlation",Ml);let r=new tY;nJ(r,"dataview",tJ),nq(r,"correlationCenter",Mh);let n=new el(r,{name:`${this.type}_${this.id}_center`});n.parse([this.getViewData()],{type:"dataview"}),n.transform({type:"correlationCenter",options:{keyword:null!=(i=null==(e=null==(t=this._spec.centerLabel)?void 0:t.style)?void 0:e.text)?i:"",categoryField:this._spec.categoryField}}),this._centerSeriesData=new aC(this._option,n)}compileData(){var t;super.compileData(),null==(t=this._centerSeriesData)||t.compile()}_statisticViewData(){super._statisticViewData(),this._data.getDataView().transform({type:"correlation",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),field:this._spec.valueField,radiusRange:this._spec.sizeRange,radiusField:this._spec.sizeField,center:[this._spec.centerX,this._spec.centerY],innerRadius:this._spec.innerRadius,outerRadius:this._spec.outerRadius,startAngle:this._spec.startAngle,endAngle:this._spec.endAngle}})}initMark(){let t=this._createMark(Mf.mark.nodePoint,{groupKey:this._seriesField,isSeriesMark:!0,key:sn});t&&(t.setMarkConfig({zIndex:H.Node}),this._nodePointMark=t);let e=this._createMark(Mf.mark.ripplePoint,{key:sn,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});e&&(this._ripplePointMark=e);let i=this._createMark(Mf.mark.centerPoint,{key:sn,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});i&&(i.setMarkConfig({zIndex:H.Node}),this._centerPointMark=i)}initMarkStyle(){this._initNodePointMarkStyle(),this._initRipplePointMarkStyle(),this._initCenterPointMarkStyle()}_initNodePointMarkStyle(){var t,e,i,r;let n=this._nodePointMark;if(!n)return;let s=null!=(e=null==(t=this._spec.nodePoint)?void 0:t.style)?e:{};this.setMarkStyle(n,{x:t=>t[Mr],y:t=>t[Mn],size:t=>t[Ms],fill:null!=(i=s.fill)?i:this.getColorAttribute(),fillOpacity:null!=(r=s.fillOpacity)?r:1,lineWidth:0},j.STATE_NORMAL,W.Series)}_initRipplePointMarkStyle(){var t,e,i,r,n;let s=this._ripplePointMark;if(!s)return;let l=null!=(e=null==(t=this._spec.ripplePoint)?void 0:t.style)?e:{};this.setMarkStyle(s,{x:()=>{var t;return null!=(t=this._spec.centerX)?t:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var t;return null!=(t=this._spec.centerY)?t:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:null!=(i=l.fill)?i:this.getColorAttribute(),opacity:null!=(r=l.fillOpacity)?r:.2,ripple:null!=(n=l.ripple)?n:0},j.STATE_NORMAL,W.Series)}_initCenterPointMarkStyle(){var t,e,i,r,n,s;let l=this._centerPointMark;l&&this.setMarkStyle(l,{x:()=>{var t;return null!=(t=this._spec.centerX)?t:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var t;return null!=(t=this._spec.centerY)?t:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>.2*Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:null!=(i=null==(e=null==(t=this._spec.centerPoint)?void 0:t.style)?void 0:e.fill)?i:this.getColorAttribute(),fillOpacity:null!=(s=null==(n=null==(r=this._spec.centerPoint)?void 0:r.style)?void 0:n.fillOpacity)?s:1},j.STATE_NORMAL,W.Series)}initTooltip(){super.initTooltip(),this._nodePointMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodePointMark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this._categoryField],z:this.dataToPositionZ.bind(this)},j.STATE_NORMAL,W.Series)}initAnimation(){var t,e;let i=null==(t=this._spec.animationAppear)?void 0:t.preset;this._nodePointMark.setAnimationConfig(cA(null==(e=iv.getAnimationInKey("correlation"))?void 0:e({},i),cM("nodePoint",this._spec,this._markAttributeContext)))}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}getActiveMarks(){return[this._nodePointMark,this._centerPointMark]}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this._rawData.reRunAllTransform(),this.getViewData().reRunAllTransform()}}Mf.type=rR.correlation,Mf.mark=Me,Mf.builtInTheme={correlation:{centerLabel:{visible:!0,position:"center",style:{fill:"#fff",text:""}},label:{visible:!0,position:"bottom",style:{fill:"#000"}}}},Mf.transformerConstructor=Mg;let Mm=()=>{pV(),Md(),iv.registerSeries(Mf.type,Mf),Mp()};class My extends fD{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","sizeField","sizeRange","centerX","centerY","innerRadius","outerRadius","startAngle","endAngle","ripplePoint","centerPoint","centerLabel","nodePoint"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class Mv extends fV{constructor(){super(...arguments),this.transformerConstructor=My,this.type="correlation",this.seriesType=rR.correlation}}Mv.type="correlation",Mv.seriesType=rR.correlation,Mv.transformerConstructor=My;let Mb=()=>{mx(),Mm(),iv.registerChart(Mv.type,Mv)};class M_ extends fv{constructor(){super(...arguments),this.type=rk.cartesianTimeAxis,this._zero=!1,this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),pX(this._regions,t=>{p0(this.getOrient())?gv(t.getXAxisHelper(),this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&t.setXAxisHelper(this.axisHelper()):gv(t.getYAxisHelper(),this.axisHelper(),t8(this._seriesUserId)||t8(this._seriesIndex))&&t.setYAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._tick=ir({},this._spec.tick,null==(t=this._spec.layers)?void 0:t[0])}_initData(){var t;if(super._initData(),null==(t=this._spec.layers)?void 0:t[1]){let t=new el(this._option.dataSet,{name:`${this.type}_${this.id}_layer_1_ticks`}).parse(this._scale,{type:"scale"}).transform({type:`${this.type}-ticks`,options:Object.assign(Object.assign({},this._tickTransformOption()),{tickCount:this._spec.layers[1].tickCount,forceTickCount:this._spec.layers[1].forceTickCount,tickStep:this._spec.layers[1].tickStep})},!1);this._layerTickData=new aC(this._option,t)}}computeData(t){super.computeData(t),this._layerTickData&&(this._layerTickData.getDataView().reRunAllTransform(),this._layerTickData.updateData())}created(){super.created(),this._layerTickData&&(this._axisMark&&this._layerTickData.addRelatedMark(this._axisMark),this._gridMark&&this._layerTickData.addRelatedMark(this._gridMark))}_getLabelFormatMethod(){var t,e,i,r,n,s,l,a;let o=d3.getInstance(),h=(null==(e=null==(t=this._spec.layers)?void 0:t[1])?void 0:e.timeFormat)||"%Y%m%d",u="local"===((null==(r=null==(i=this._spec.layers)?void 0:i[1])?void 0:r.timeFormatMode)||"local")?o.timeFormat:o.timeUTCFormat,d=(null==(s=null==(n=this._spec.layers)?void 0:n[0])?void 0:s.timeFormat)||"%Y%m%d",c="local"===((null==(a=null==(l=this._spec.layers)?void 0:l[0])?void 0:a.timeFormatMode)||"local")?o.timeFormat:o.timeUTCFormat;return(t,e,i,r,n)=>{var s;let l;return l=0===n?c(d,t):u(h,t),(null==(s=this._spec.label)?void 0:s.formatMethod)?this._spec.label.formatMethod(l,e):l}}getLabelItems(t){var e,i;let r=[],n=null==(e=this.getTickData())?void 0:e.getLatestData();n&&n.length&&r.push(n.map(e=>gy(e.value,this._getNormalizedValue([e.value],t))));let s=null==(i=this._layerTickData)?void 0:i.getLatestData();return s&&s.length&&r.push(s.map(e=>gy(e.value,this._getNormalizedValue([e.value],t)))),r}registerTicksTransform(){let t=`${this.type}-ticks`;return nq(this._option.dataSet,t,fm.m),t}transformScaleDomain(){}}M_.type=rk.cartesianTimeAxis,M_.specKey="axes",M_.builtInTheme={axis:fi,axisX:fr,axisY:fn};let Mx=()=>{iv.registerGraphicComponent(K.lineAxis,(t,e)=>new ft.$(t,e)),iv.registerGraphicComponent($.lineAxisGrid,(t,e)=>new g7(t,e)),gK(),iv.registerComponent(M_.type,M_)};class MC{nice(t=10,e){var i,r,n,s;let l=this._domain,a=[],o=null;if(e){let t=lZ(l,e);if(a=t.niceMinMax,this._domainValidator=t.domainValidator,o=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else o="all";if(o){let t=lR(l.slice(),null!=(r=null==(i=this.getNiceConfig)?void 0:i.call(this))?r:{floor:t=>Math.floor(t),ceil:t=>Math.ceil(t)});return"min"===o?t[t.length-1]=null!=(n=a[1])?n:t[t.length-1]:"max"===o&&(t[0]=null!=(s=a[0])?s:t[0]),this._niceDomain=t,this.rescale(),this}return this}niceMin(){let t=this._domain[this._domain.length-1];this.nice();let e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}niceMax(){let t=this._domain[0];this.nice();let e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}function Mw(t=Number.EPSILON){return e=>Math.max(e,t)}class MS extends l5{constructor(){super(l_(10),lb(10)),this.type=V.Log,this._limit=Mw(),this._logs=this.transformer,this._pows=this.untransformer,this._domain=[1,10],this._base=10}clone(){return(new MS).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}rescale(t){var e;if(t)return this;super.rescale();let i=l_(this._base),r=lb(this._base);return(null!=(e=this._niceDomain)?e:this._domain)[0]<0?(this._logs=t=>-i(-t),this._pows=t=>-r(-t),this._limit=function(t=Number.EPSILON){return e=>Math.min(e,-t)}(),this.transformer=lm,this.untransformer=ly):(this._logs=i,this._pows=r,this._limit=Mw(),this.transformer=this._logs,this.untransformer=r),this}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!=(e=this._niceDomain)?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}base(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}tickFormat(){return lp}d3Ticks(t=10,e){let i=this.domain();return lK(this._limit(i[0]),this._limit(i[i.length-1]),t,this._base,this.transformer,this.untransformer,e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return l$(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return lY(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return lY(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}getNiceConfig(){return{floor:t=>this._pows(Math.floor(this._logs(this._limit(t)))),ceil:t=>Math.abs(t)>=1?Math.ceil(t):this._pows(Math.ceil(this._logs(this._limit(t))))}}}cG(MS,MC);class MA extends fv{constructor(){super(...arguments),this.type=rk.cartesianLogAxis,this._zero=!1,this._scale=new MS}initScales(){var t;super.initScales(),this._scale.base(null!=(t=this._spec.base)?t:10),this._scale.clamp(!0,null,!1)}registerTicksTransform(){let t=`${this.type}-ticks`;return nq(this._option.dataSet,t,fm.m),t}transformScaleDomain(){}}MA.type=rk.cartesianLogAxis,MA.specKey="axes",MA.builtInTheme={axis:fi,axisLinear:fy,axisX:fr,axisY:fn},cG(MA,ff);let MM=()=>{iv.registerGraphicComponent(K.lineAxis,(t,e)=>new ft.$(t,e)),iv.registerGraphicComponent($.lineAxisGrid,(t,e)=>new g7(t,e)),gK(),iv.registerComponent(MA.type,MA)};class Mk extends l4{constructor(){super(lx(1),lC(1)),this.type=V.Symlog,this._const=1}clone(){return(new Mk).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}constant(t,e){return arguments.length?(this._const=t,this.transformer=lx(t),this.untransformer=lC(t),this.rescale(e)):this._const}d3Ticks(t=10,e){let i=this.domain();return lK(i[0],i[i.length-1],t,this._const,this.transformer,this.untransformer,e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return l$(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return lY(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return lY(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}cG(Mk,MC);class MT extends fv{constructor(){super(...arguments),this.type=rk.cartesianSymlogAxis,this._zero=!1,this._scale=new Mk}initScales(){var t;super.initScales(),this._scale.constant(null!=(t=this._spec.constant)?t:10)}registerTicksTransform(){let t=`${this.type}-ticks`;return nq(this._option.dataSet,t,fm.m),t}transformScaleDomain(){}}MT.type=rk.cartesianSymlogAxis,MT.specKey="axes",MT.builtInTheme={axis:fi,axisLinear:fy,axisX:fr,axisY:fn},cG(MT,ff);let MR=()=>{iv.registerGraphicComponent(K.lineAxis,(t,e)=>new ft.$(t,e)),iv.registerGraphicComponent($.lineAxisGrid,(t,e)=>new g7(t,e)),gK(),iv.registerComponent(MT.type,MT)};function MB(t){var e,i;let r=Object.assign({},t);return sD(t.style)||(r.textStyle=gd(t.style)),sD(t.textStyle)||ir(r.textStyle,gd(t.textStyle)),(null==(e=t.shape)?void 0:e.style)&&gd(r.shape.style),(null==(i=t.background)?void 0:i.style)&&gd(r.background.style),r}var MP=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i},ME=i(35622),MI=i(48742);let ML=(t,e)=>{let i=[],r={},{series:n,seriesField:s}=e;return n().forEach(t=>{let e=s(t);(e===t.getSeriesField()?t.getSeriesInfoList():t.getSeriesInfoInField(e)).forEach(t=>{r[t.key]||(r[t.key]=!0,i.push(t))})}),i},MF=(t,e)=>{var i,r,n;let{series:s,selected:l,field:a,data:o,customFilter:h}=e,u=l(),d=o();if(0===u.length&&d.length)return[];if(u.length===d.length)return t;let c={};u.forEach(t=>{c[t]=!0});let p=null!=(i=a())?i:sl;return h?h(t,u,p):(tq(t)&&(null==(r=t[0])?void 0:r.nodes)?(t[0].nodes=t[0].nodes.filter(t=>!0===c[t.key]),(null==(n=t[0])?void 0:n.links)&&(t[0].links=t[0].links.filter(t=>!0===c[t.source]&&!0===c[t.target]))):t8(p)&&(t=t.filter(t=>!0===c[s.getSeriesFieldValue(t,p)])),t)};class MO extends gz{constructor(){super(...arguments),this.layoutType="normal",this.layoutZIndex=H.Legend,this.layoutLevel=z.Legend,this.specKey="legends",this._orient="left",this._visible=!0,this._position="middle",this._preSelectedData=[],this._selectedData=[],this.effect={onSelectedDataChange:()=>{pX(this._regions,t=>{var e;null==(e=t.getViewData())||e.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),pX(this._regions,t=>{t.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}get orient(){return this._orient}get visible(){return this._visible}get position(){return this._position}getLegendData(){return this._legendData.getLatestData()}getSelectedData(){return this._selectedData}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._orient=ex(this._spec.orient)?this._spec.orient:"left",this._position=null!=(t=this._spec.position)?t:"middle",this._visible=!1!==this._spec.visible;let{regionId:e,regionIndex:i,seriesId:r,seriesIndex:n}=this._spec;t8(r)&&(this._seriesUserId=ed(r)),t8(e)&&(this._regionUserId=ed(e)),t8(n)&&(this._seriesIndex=ed(n)),t8(i)&&(this._regionUserIndex=ed(i)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionUserIndex)}created(){super.created(),this.initData()}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reRender=!0,(null==t?void 0:t.orient)!==(null==e?void 0:e.orient)?i.reMake=!0:t5(e,t)||(i.reCompile=!0),i}_bindLegendDataChange(){this._preSelectedData=this._selectedData.slice(),this._initSelectedData(),this._forceLayout()}initData(){let t=this._initLegendData();t.target.addListener("change",this._bindLegendDataChange.bind(this)),this._legendData=new aC(this._option,t),this._initSelectedData(),pX(this._regions,t=>{t.event.on(rI.rawDataUpdate,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>{this._legendData.getDataView().reRunAllTransform({skipEqual:!0})})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}setSelectedData(t){var e,i,r;let n=this._selectedData;er(t)||JSON.stringify(n)===JSON.stringify(t)||(pX(this._regions,e=>{e.legendSelectedFilter&&(t=e.legendSelectedFilter(this,t))},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._selectedData=[...t],null==(i=(e=this.effect).onSelectedDataChange)||i.call(e),this.event.emit(rI.legendSelectedDataChange,{model:this}),null==(r=this._legendComponent)||r.setSelected(this._selectedData))}afterSetLayoutStartPoint(t){if(super.afterSetLayoutStartPoint(t),this._legendComponent){let{x:e,y:i}=t;en(e*i)&&this._legendComponent.setAttributes({x:e,y:i})}}getBoundsInRect(t,e){if(!this._visible)return this._legendComponent&&this._legendComponent.parent&&(this._legendComponent.parent.removeChild(this._legendComponent),this._legendComponent=null),{x1:0,y1:0,x2:0,y2:0};let i={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},r=this._getLegendAttributes(t);if(r.disableTriggerEvent=this._option.disableTriggerEvent,this._legendComponent)t5(r,this._cacheAttrs)||this._legendComponent.setAttributes(ir({},r,{defaultSelected:this._selectedData}));else{let t=new(this._getLegendConstructor())(ir({},r,{defaultSelected:this._selectedData}));t.name="legend",this._legendComponent=t,this.getContainer().add(t),this._option.disableTriggerEvent||this._initEvent(),t.on("*",(t,e)=>this._delegateEvent(this._legendComponent,t,e))}this._cacheAttrs=r;let n=isFinite(this._legendComponent.AABBBounds.width())?this._legendComponent.AABBBounds.width():0,s=isFinite(this._legendComponent.AABBBounds.height())?this._legendComponent.AABBBounds.height():0;if("normal-inline"!==this.layoutType){let t="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",i=this._position,{width:r,height:l}=e,a=0,o=0;"horizontal"===t?"middle"===i?a=(r-n)/2:"end"===i&&(a=r-n):"middle"===i?o=(l-s)/2:"end"===i&&(o=l-s),this._legendComponent.setAttributes({dx:a,dy:o})}return i.x2=i.x1+n,i.y2=i.y1+s,i}onDataUpdate(){var t,e;if(JSON.stringify(this._preSelectedData)!==JSON.stringify(this._selectedData)){if(this._legendComponent){let t=this._getLegendAttributes(this.getLayoutRect());t5(t,this._cacheAttrs)||this._legendComponent.setAttributes(ir({},t,{defaultSelected:this._selectedData}))}null==(e=(t=this.effect).onSelectedDataChange)||e.call(t),this.event.emit(rI.legendSelectedDataChange,{model:this})}}_getNeedClearVRenderComponents(){return[this._legendComponent]}clear(){super.clear(),this._cacheAttrs=null,this._preSelectedData=null}}MO.specKey="legends";let MD={orient:"bottom",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal"},space:12},pager:{textStyle:{fill:{type:"palette",key:"discreteLegendPagerTextColor"}},handler:{style:{fill:{type:"palette",key:"discreteLegendPagerHandlerColor"}},state:{disable:{fill:{type:"palette",key:"discreteLegendPagerHandlerDisableColor"}}}}},item:{visible:!0,spaceCol:10,spaceRow:6,padding:2,background:{state:{selectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}},unSelectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}}}},shape:{space:6,style:{lineWidth:0,fillOpacity:1,opacity:1},state:{unSelected:{fillOpacity:.2,opacity:1}}},label:{space:6,style:{fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},opacity:1},state:{unSelected:{fill:{type:"palette",key:"disableFontColor"},opacity:1}}}},allowAllCanceled:!1};class MH extends MO{constructor(){super(...arguments),this.type=rk.discreteLegend,this.name=rk.discreteLegend}static getSpecInfo(t){return d6(t,this.specKey,this.type,t=>!t.type||"discrete"===t.type)}init(t){super.init(t),pX(this._regions,t=>{t.addViewDataFilter({type:"discreteLegendFilter",options:{series:t,selected:()=>this._selectedData,field:()=>this._getSeriesLegendField(t),data:()=>this.getLegendDefaultData(),customFilter:this._spec.customFilter},level:F.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_initLegendData(){nq(this._option.dataSet,"discreteLegendFilter",MF),nq(this._option.dataSet,"discreteLegendDataMake",ML);let t=new el(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return t.transform({type:"discreteLegendDataMake",options:{series:()=>{let t=[];return pX(this._regions,e=>{t.push(e)},{specIndex:this._spec.seriesIndex,userId:this._spec.seriesId}),t},seriesField:t=>this._getSeriesLegendField(t)}}),t}_getSeriesLegendField(t){var e,i,r;let n=t.getSeriesField(),s=null!=(e=this._spec.scaleName)?e:this._spec.scale;if(er(s)||!t.getRawData())return n;let l=this._option.globalScale.getScaleSpec(s);if(!l)return n;if(this._spec.field)return this._spec.field;if(!eb(l.domain))return n;let a=l.domain.find(e=>e.dataId===t.getRawData().name);return a&&null!=(r=null==(i=a.fields)?void 0:i[0])?r:n}_initSelectedData(){let t=this.getLegendDefaultData();if(this._unselectedData){let e=[],i=[];t.forEach(t=>{this._unselectedData.includes(t)?i.push(t):e.push(t)}),this._selectedData=e,this._unselectedData=i}else this._spec.defaultSelected?this._selectedData=[...this._spec.defaultSelected]:this._selectedData=t}getLegendDefaultData(t){return tQ(this._spec.data)?this._getLegendItems().map(t=>t.label):this._legendData.getLatestData().map(t?t=>t.originalKey:t=>t.key)}_addDefaultTitleText(t){var e,i,r,n;if((null==(e=t.title)?void 0:e.visible)&&er(t.title.text)&&er(null==(i=t.title.style)?void 0:i.text)){let e=null==(n=null==(r=this._regions)?void 0:r[0])?void 0:n.getSeries()[0];if(!e)return;t.title.text=dK(e.getRawData(),e.getSeriesField())}}_getLegendAttributes(t){let e=Object.assign(Object.assign({layout:"bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",items:this._getLegendItems(),zIndex:this.layoutZIndex},function(t,e){let{title:i={},item:r={},pager:n={},background:s={},type:l,id:a,visible:o,orient:h,position:u,data:d,filter:c,regionId:p,regionIndex:g,seriesIndex:f,seriesId:m,padding:y}=t,v=MP(t,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible?v.title=MB(i):v.title={visible:!1},sD(r.focusIconStyle)||gd(r.focusIconStyle),r.shape&&(r.shape=go(r.shape)),r.label&&(r.label=go(r.label)),r.value&&(r.value=go(r.value)),r.background&&(r.background=go(r.background)),eC(r.maxWidth)&&(r.maxWidth=Number(r.maxWidth.substring(0,r.maxWidth.length-1))*e.width/100),eC(r.width)&&(r.width=Number(r.width.substring(0,r.width.length-1))*e.width/100),eC(r.height)&&(r.height=Number(r.height.substring(0,r.height.length-1))*e.width/100),v.item=r,"scrollbar"===n.type?(sD(n.railStyle)||gd(n.railStyle),sD(n.sliderStyle)||gd(n.sliderStyle)):(sD(n.textStyle)||gd(n.textStyle),n.handler&&go(n.handler)),v.pager=n,s.visible&&!sD(s.style)&&(ir(v,s.style),t8(s.padding)&&(v.padding=s.padding)),v}(this._spec,t)),{maxWidth:t.width,maxHeight:t.height});return this._addDefaultTitleText(e),this._addLegendItemFormatMethods(e),e}_getLegendConstructor(){return MI.W}setSelectedData(t){t&&(this._unselectedData=this.getLegendDefaultData().filter(e=>!t.includes(e))),super.setSelectedData(t)}_initEvent(){if(this._legendComponent){let t=!1!==this._spec.filter;this._legendComponent.addEventListener(ME.dk.legendItemClick,e=>{let i=iW(e,"detail.currentSelected");t&&this.setSelectedData(i),this.event.emit(rI.legendItemClick,{model:this,value:i,event:e})}),this._legendComponent.addEventListener(ME.dk.legendItemHover,t=>{let e=iW(t,"detail");this.event.emit(rI.legendItemHover,{model:this,value:e,event:t})}),this._legendComponent.addEventListener(ME.dk.legendItemUnHover,t=>{let e=iW(t,"detail");this.event.emit(rI.legendItemUnHover,{model:this,value:e,event:t})})}}_getLegendItems(){let t=(this._legendData.getLatestData()||[]).map(t=>{var e,i;let r=t.style("fillOpacity"),n=t.style("strokeOpacity"),s=t.style("opacity"),l=t.style("texture");return{label:t.key,shape:{symbolType:null!=(i=null!=(e=t.style("symbolType"))?e:t.shapeType)?i:"circle",fillOpacity:en(r)?r:1,strokeOpacity:en(n)?n:1,opacity:en(s)?s:1,texturePadding:l?1:null,textureSize:l?4:null,texture:l,fill:t.style("fill"),stroke:t.style("stroke"),textureColor:t.style("textureColor"),innerBorder:t.style("innerBorder"),outerBorder:t.style("outerBorder"),lineDash:t.style("lineDash"),lineDashOffset:t.style("lineDashOffset"),lineWidth:t.style("lineWidth")}}});return tQ(this._spec.data)?this._spec.data(t,this._option.globalScale.getScale("color"),this._option.globalScale):t}_addLegendItemFormatMethods(t){var e,i,r,n;let{formatMethod:s,formatter:l}=null!=(i=null==(e=this._spec.item)?void 0:e.label)?i:{},{formatMethod:a,formatter:o}=null!=(n=null==(r=this._spec.item)?void 0:r.value)?n:{},{formatFunc:h}=d4(s,l);l&&!s&&h&&(t.item.label.formatMethod=(t,e)=>h(t,e,l));let{formatFunc:u}=d4(a,o);o&&!a&&u&&(t.item.value.formatMethod=(t,e)=>u(o,t,e,l))}}MH.specKey="legends",MH.builtInTheme={discreteLegend:MD},MH.type=rk.discreteLegend;let Mz=()=>{iv.registerComponent(MH.type,MH)},MW=(t,e)=>{let{series:i,field:r,scale:n}=e,s=r();if(r&&s){let t=1/0,e=-1/0;return i().forEach(i=>{let r=i.getRawDataStatisticsByField(s,!0),n=null==r?void 0:r.min,l=null==r?void 0:r.max;en(n)&&(t=Math.min(n,t)),en(l)&&(e=Math.max(l,e))}),[t,e]}if(n){let t=n();return t?t.domain():[]}return[]},MN=(t,e)=>{let{selected:i,field:r,data:n,isHierarchyData:s,customFilter:l}=e,a=i(),o=r(),h=s||(t=>t&&t.some(t=>t&&function(t,e="value",i="children"){return!!e_(t)&&!!t.hasOwnProperty(i)&&Array.isArray(t[i])}(t)));if(a===n())return t;if(o&&!sD(a)){let[e,i]=a;return l?l(t,a,o):h(t)?function t(e,i,r,n="value",s="children"){return Array.isArray(e)?e.map(e=>{let l=Object.assign({},e);return Array.isArray(l[s])&&(l[s]=t(l[s],i,r,n,s)),l}).filter(t=>+t[n]>=i&&+t[n]<=r||t[s]&&t[s].length>0):e}(t,+e,+i,o):t.filter(t=>t[o]>=e&&t[o]<=i)}return t};var Mj=i(58183),MG=i(71149),MV=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let MZ={color:Mj.e,size:MG.D},MU={orient:"right",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"primaryFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},endText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},handlerText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6}},MK=t=>{let e={width:200,height:8,style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=8):(e.width=8,e.height=200),Object.assign(Object.assign({},MU),{rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:"#ffffff"},shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"}}}})},M$={horizontal:MK(!0),vertical:MK(!1)},MY=t=>{let e={style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=4):(e.height=200,e.width=4),Object.assign(Object.assign({},MU),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:{type:"palette",key:"sliderTrackColor"}},fill:{type:"palette",key:"sliderHandleColor"}}}})},MX={horizontal:MY(!0),vertical:MY(!1)},Mq=["#C4E7FF","#98CAFF","#75ACFF","#518FF9","#2775DC","#005CBE","#00429F","#00287E"],MJ=[2,10];class MQ extends MO{static getSpecInfo(t){let e=d6(t,this.specKey,this.type,t=>{var e;return"color"===(e=t.type)||"size"===e});return e&&e.forEach(t=>{t.type="color"===t.spec.type?rk.colorLegend:rk.sizeLegend}),e}constructor(t,e){super(t,e),this.type=rk.colorLegend,this.name=rk.colorLegend;let i="color"===this._spec.type?rk.colorLegend:rk.sizeLegend;this.type=i,this.name=i}setAttrFromSpec(){super.setAttrFromSpec(),this._field=this._spec.field,this._legendType=this._spec.type}init(t){super.init(t),pX(this._regions,t=>{t.addViewDataFilter({type:"continuousLegendFilter",options:{selected:()=>this._selectedData,field:()=>this._field,data:()=>this._legendData.getLatestData(),isHierarchyData:t.isHierarchyData,customFilter:this._spec.customFilter},level:F.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_getScaleInGlobal(){let t=this._option.globalScale,e=this._spec.scale;return e||(e=this._legendType),t.getScale(e)}_initLegendData(){nq(this._option.dataSet,"continuousLegendFilter",MN),nq(this._option.dataSet,"continuousLegendDataMake",MW);let t=new el(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return t.transform({type:"continuousLegendDataMake",options:{series:()=>pq(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}),field:()=>this._field,scale:this._getScaleInGlobal.bind(this)}}),t}_initSelectedData(){this._spec.defaultSelected?this._selectedData=this._spec.defaultSelected.slice():this._selectedData=this._legendData.getLatestData()}_addDefaultTitleText(t){var e,i,r,n;if((null==(e=t.title)?void 0:e.visible)&&er(t.title.text)&&er(null==(i=t.title.style)?void 0:i.text)){let e=this._field;if(e){let i=null==(n=null==(r=this._regions)?void 0:r[0])?void 0:n.getSeries()[0];if(!i)return;return void(t.title.text=dK(i.getRawData(),e))}let i=this._spec.scale;i||(i=this._legendType);let s=this._option.globalScale.getScaleSpec(i);if(!eb(null==s?void 0:s.domain))return;let l=s.domain[0];if(0===l.fields.length)return;t.title.text=dK(this._option.dataSet.getDataView(l.dataId),l.fields[0])}}_getLegendAttributes(t){var e,i;let r="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",n="horizontal"===r?"bottom":this.layoutOrient,s=[],l=this._getScaleInGlobal();l&&"linear"===l.type&&(s=l.range()),sD(s)&&(s="color"===this._legendType?Mq:MJ);let a=null!=(e=this._legendData.getLatestData()[0])?e:0,o=null!=(i=this._legendData.getLatestData()[1])?i:1;this._legendData.getLatestData()[0]===this._legendData.getLatestData()[1]&&(a=Math.min(0,this._legendData.getLatestData()[0]),o=0===this._legendData.getLatestData()[0]?1:Math.max(0,this._legendData.getLatestData()[0]));let h=Object.assign({layout:r,align:n,zIndex:this.layoutZIndex,min:a,max:o,value:this._spec.defaultSelected,["color"===this._legendType?"colors":"sizeRange"]:s},function(t){let e=ir({},t),{title:i={},handler:r={},rail:n={},track:s={},startText:l,endText:a,handlerText:o,sizeBackground:h,background:u={},type:d,id:c,visible:p,orient:g,position:f,data:m,defaultSelected:y,field:v,filter:b,regionId:_,regionIndex:x,seriesIndex:C,seriesId:w,padding:S}=e,A=MV(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible?A.title=MB(i):A.title={visible:!1},A.showHandler=!1!==r.visible,sD(r.style)||(A.handlerStyle=gd(r.style)),t8(n.width)&&(A.railWidth=n.width),t8(n.height)&&(A.railHeight=n.height),sD(n.style)||(A.railStyle=gd(n.style)),sD(s.style)||(A.trackStyle=gd(s.style)),A.startText=go(l),A.endText=go(a),A.handlerText=go(o),sD(h)||(A.sizeBackground=gd(h)),u.visible&&!sD(u.style)&&(ir(A,u.style),t8(u.padding)&&(A.padding=u.padding)),A}(this._spec));return this._addDefaultTitleText(h),h}_getLegendConstructor(){return MZ[this._legendType]}_initEvent(){if(this._legendComponent){let t=!1!==this._spec.filter;this._legendComponent.addEventListener("change",ij(e=>{let i=iW(e,"detail.value");t&&this.setSelectedData(i),this.event.emit(rI.legendFilter,{model:this,value:i,event:e})},30))}}}MQ.specKey="legends",MQ.builtInTheme={colorLegend:M$,sizeLegend:MX},MQ.type=rk.continuousLegend;let M0=()=>{iv.registerComponent(MQ.type,MQ)},M1=(t,e)=>t8(e)?t.map(t=>e[t]):void 0,M2=(t,e)=>i=>t.every((t,r)=>i[t]===(null==e?void 0:e[r])),M3=t=>!er(t)&&(tq(t)?t.length>0&&t.every(t8):Object.keys(t).length>0),M5=(t,e)=>{let i=e.getSeries(),r=[];return i.forEach(e=>{var i,n,s,l,a,o,h;let u=e.getDimensionField(),d=e.getMeasureField(),c=e.getSeriesField(),p=t8(c)?t[c]:void 0,g=t8(c)&&null!=(l=null==(s=null==(n=null==(i=e.getViewDataStatistics)?void 0:i.call(e))?void 0:n.latestData[c])?void 0:s.values)?l:[],f=M1(u,t),m=M1(d,t),y=M3(m),v=!y&&t8(c)&&er(p)&&g.length>0,b=()=>{var t;let i=null==(t=e.getViewData())?void 0:t.latestData.find(M2(u,f));if(!y&&!M3(m=M1(d,i)))return;let n=e.type===rR.pie?e.dataToCentralPosition(i):e.dataToPosition(i);er(n)||isNaN(n.x)||isNaN(n.y)||r.push({pos:n,data:{dimensionFields:u,dimensionData:f,measureFields:d,measureData:m,hasMeasureData:y,groupField:c,groupData:p},series:e})};if("cartesian"===e.coordinate){let t=ll(null==(o=null==(a=e.getYAxisHelper())?void 0:a.getScale(0))?void 0:o.type)?"y":"x",i=u.map((t,e)=>[t,e]).filter(([,t])=>er(null==f?void 0:f[t])),n=[null!=f?f:[]];i.length>0&&i.forEach(([t,i])=>{var r,s,l,a;let o=null!=(a=null==(l=null==(s=null==(r=e.getViewDataStatistics)?void 0:r.call(e))?void 0:s.latestData[t])?void 0:l.values)?a:[],h=[];n.forEach(t=>{o.forEach(e=>{var r;let n=null!=(r=null==t?void 0:t.slice())?r:[];n[i]=e,h.push(n)})}),n=h}),n.forEach(i=>{var n,s;if(v){let s=null==(n=e.getViewData())?void 0:n.latestData.filter(M2(u,i));g.forEach(n=>{let l=s.find(t=>t[c]===n);if(!M3(m=M1(d,l)))return;let a=e.dataToPosition(l);er(a)||isNaN(a.x)||isNaN(a.y)||r.push({pos:a,data:{dimensionFields:u,dimensionData:i,measureFields:d,measureData:m,hasMeasureData:y,groupField:c,groupData:n},series:e,dimType:t})})}else{let n=null==(s=e.getViewData())?void 0:s.latestData.find(M2(u,i));if(!y&&!M3(m=M1(d,n)))return;let l=e.dataToPosition(n);if(er(l)||isNaN(l.x)||isNaN(l.y))return;r.push({pos:l,data:{dimensionFields:u,dimensionData:i,measureFields:d,measureData:m,hasMeasureData:y,groupField:c,groupData:p},dimType:t,series:e})}})}else if("polar"===e.coordinate)if(e.type===rR.pie)b();else if(v){let t=(null==(h=e.getViewData())?void 0:h.latestData.filter(M2(u,f))).find(t=>t[c]===p);g.forEach(i=>{if(!M3(m=M1(d,t)))return;let n=e.dataToPosition(t);er(n)||isNaN(n.x)||isNaN(n.y)||r.push({pos:n,data:{dimensionFields:u,dimensionData:f,measureFields:d,measureData:m,hasMeasureData:y,groupField:c,groupData:i},series:e})})}else b();else"geo"===e.coordinate&&b()}),r},M4=t=>t8(t)&&!tq(t),M6=t=>t8(t)&&tq(t);class M8 extends gD{_shouldMergeThemeToSpec(){return!1}_initTheme(t,e){var i,r,n;let{spec:s,theme:l}=super._initTheme(t,e);return s.style=ir({},this._theme,s.style),s.offset=ir({},l.offset,t.offset),s.transitionDuration=null!=(i=t.transitionDuration)?i:l.transitionDuration,s.trigger=null!=(r=t.trigger)?r:l.trigger,s.triggerOff=null!=(n=t.triggerOff)?n:l.triggerOff,{spec:s,theme:l}}_transformSpecAfterMergingTheme(t,e,i){var r,n,s,l,a,o,h;super._transformSpecAfterMergingTheme(t,e,i),t.visible=null==(r=t.visible)||r,t.activeType=ct(t),t.renderMode=null!=(n=t.renderMode)?n:eL(this._option.mode)||!eE(this._option.mode)?"canvas":"html",t.trigger=null!=(s=t.trigger)?s:"hover",t.className=null!=(l=t.className)?l:"vchart-tooltip-element",t.enterable=null!=(a=t.enterable)&&a,t.transitionDuration=null!=(o=t.transitionDuration)?o:150,t.confine=null!=(h=t.confine)?h:"canvas"===t.renderMode,t8(t.parentElement)?t6(t.parentElement)&&(t.parentElement=ea.rF.getElementById(t.parentElement)):eE(this._option.mode)&&(t.parentElement=null==eP?void 0:eP.body)}}class M9 extends gz{constructor(){super(...arguments),this.layoutZIndex=1,this.type=rk.tooltip,this.name=rk.tooltip,this.transformerConstructor=M8,this.specKey="tooltip",this.layoutType="none",this._isReleased=!1,this._alwaysShow=!1,this._eventList=[],this._isTooltipShown=!1,this._clickLock=!1,this._mountEvent=(t,e,i)=>{this.event.on(t,e,i),this._eventList.push({eventType:t,handler:i})},this._handleClickToLock=t=>{var e,i;if(this._clickLock)this._handleChartMouseOut(t),this._clickLock=!1;else{if(!this._isTooltipShown&&!(null==(i=null==(e=this.tooltipHandler)?void 0:e.isTooltipShown)?void 0:i.call(e)))return;this._clickLock=!0}},this._getMouseOutHandler=t=>e=>{var i,r,n,s,l;if(this._isReleased||this._alwaysShow||this._clickLock||!this._isTooltipShown&&!(null==(r=null==(i=this.tooltipHandler)?void 0:i.isTooltipShown)?void 0:r.call(i)))return;let a=eE(null==(n=this._option)?void 0:n.mode),{clientX:o,clientY:h}=e.event;a&&t&&this._isPointerInChart({x:o,y:h})||(this._enterable?this._outTimer=setTimeout(()=>{this._handleChartMouseOut(e)},null!=(l=null==(s=this._spec)?void 0:s.showDelay)?l:50):this._handleChartMouseOut(e))},this._handleChartMouseOut=t=>{this._alwaysShow||this._isReleased||this._isEnterTooltip||"none"!==this._spec.triggerOff&&(this._hideTooltipByHandler(Object.assign(Object.assign({},t),{tooltip:this})),this._handleMouseMove&&this._handleMouseMove.cancel&&this._handleMouseMove.cancel(),this._cacheEnterableRect=null,this._cacheInfo=void 0,this._cacheParams=void 0,this._cacheActiveType=void 0)},this._getMouseMoveHandler=t=>e=>{var i,r,n,s;this._isReleased||this._isEnterTooltip||(this._outTimer&&(clearTimeout(this._outTimer),this._outTimer=null),this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),this._alwaysShow||(this._clickLock?t&&(this._handleChartMouseOut(e),this._clickLock=!1):!t&&this._enterable&&(null==(r=null==(i=this.tooltipHandler)?void 0:i.isTooltipShown)?void 0:r.call(i))?(this._showTimer&&clearTimeout(this._showTimer),this._showTimer=setTimeout(()=>{this._handleChartMouseMove(e,t)},null!=(s=null==(n=this._spec)?void 0:n.showDelay)?s:50)):this._handleChartMouseMove(e,t)))},this._handleChartMouseMove=(t,e)=>{if(this._isReleased)return;let i=this._getMouseEventData(t),{tooltipInfo:{dimension:r},ignore:{mark:n}}=i,s={mark:!1,dimension:!1,group:!1},l=["group","mark","dimension"];for(let r=0,n=l.length;r<n;r++){let n=l[r];if(this.processor[n]&&this._showTooltipByMouseEvent(n,i,t,e)){s[n]=!0;break}}Object.values(s).every(t=>!t)&&!(er(t.mark)&&er(t.model)&&er(t.datum))&&(n&&M4(this._cacheInfo)?s.mark=this._showTooltipByMouseEvent("mark",i,t,e,!0):t8(r)&&(s.dimension=this._showTooltipByMouseEvent("dimension",i,t,e))),s.mark||s.group||s.dimension&&!er(r)?this._initEventOfTooltipContent():this._handleChartMouseOut(t)},this._showTooltipByMouseEvent=(t,e,i,r,n)=>{var s;let l,a=this.processor[t];if(!a.shouldHandleTooltip(i,e.tooltipInfo[t]))return!1;if(this._hideTimer&&clearTimeout(this._hideTimer),n)l=!a.showTooltip(this._cacheInfo,i,!0);else{let r=e.tooltipInfo[t],n=this._isSameAsCache(r,i,t);(l=!a.showTooltip(r,i,n))&&(this._cacheInfo=r,this._cacheParams=i,this._cacheActiveType=t)}l&&(this._isTooltipShown=!0,r&&this._spec.lockAfterClick&&!this._clickLock?this._clickLock=!0:Number.isFinite(this._spec.hideTimer)&&(this._hideTimer=setTimeout(()=>{this._handleChartMouseOut()},this._spec.hideTimer)));let o=null==(s=this._option)?void 0:s.globalInstance;return l&&dw.globalConfig.uniqueTooltip&&o&&dw.hideTooltip(o.id),l},this._getMouseEventData=t=>{let e={tooltipInfo:{},ignore:{}};return Object.keys(this.processor).forEach(i=>{let{tooltipInfo:r,ignore:n}=this.processor[i].getMouseEventData(t);e.tooltipInfo[i]=r,e.ignore[i]=n}),e},this._hideTooltipByHandler=t=>{var e,i,r;if(!this._isTooltipShown&&!(null==(i=null==(e=this.tooltipHandler)?void 0:e.isTooltipShown)?void 0:i.call(e)))return 0;this.event.emit(rI.tooltipHide,Object.assign(Object.assign({},t),{source:rL.chart,tooltip:this})),Object.values(this.processor).forEach(t=>{t.clearCache()});let n=null!=(r=this._spec.handler)?r:this.tooltipHandler;if(n.hideTooltip){let e=n.hideTooltip.call(n,t);return e||(this._isTooltipShown=!1),e}return 1},this.hideTooltip=()=>{if(this._isReleased)return!1;let t={changePositionOnly:!1,tooltip:this,item:void 0,datum:void 0,source:rL.chart};return this._alwaysShow=!1,!this._hideTooltipByHandler(t)}}isTooltipShown(){return this._isTooltipShown}_registerEvent(){}_releaseEvent(){}onLayoutEnd(){}created(){super.created(),this._regions=this._option.getAllRegions(),this._initEvent()}release(){var t,e;super.release(),this._isReleased=!0,this._hideTimer&&clearTimeout(this._hideTimer),this._eventList.forEach(({eventType:t,handler:e})=>{this.event.off(t,e)}),this._eventList=[],null==(e=null==(t=this.tooltipHandler)?void 0:t.release)||e.call(t),this._isTooltipShown=!1}beforeRelease(){this.event.emit(rI.tooltipHide,{tooltip:this,chart:this.getChart()}),this.event.emit(rI.tooltipRelease,{tooltip:this,chart:this.getChart()})}_initHandler(){var t,e,i;let r=null!=(t=this._spec.renderMode)?t:"html",n=this._option.globalInstance.getTooltipHandlerByUser();if(n)this.tooltipHandler=n,this._enterable=!1;else{let t="canvas"===r?mf.canvas:mf.dom,n=iv.getComponentPluginInType(t);n||eD("Can not find tooltip handler: "+t);let s=new n;s.name=`${this._spec.className}-${null!=(e=this._option.globalInstance.id)?e:0}-${this.getSpecIndex()}`,null==(i=this.pluginService)||i.load([s]),this.tooltipHandler=s,this._spec.enterable&&"html"===r&&this.tooltipHandler?(this._enterable=!0,this._needInitEventOfTooltip=!0):this._enterable=!1}}_initEventOfTooltipContent(){var t,e;if(!this._needInitEventOfTooltip)return;let i=null==(e=(t=this.tooltipHandler).getRootDom)?void 0:e.call(t);i&&(i.addEventListener("pointerenter",()=>{var t;if(!this._enterable)return;this._isEnterTooltip=!0;let e=null==(t=i.getBoundingClientRect)?void 0:t.call(i);e&&(this._cacheEnterableRect={width:e.width,height:e.height}),this._outTimer&&(clearTimeout(this._outTimer),this._outTimer=null),this._showTimer&&(clearTimeout(this._showTimer),this._showTimer=null)}),i.addEventListener("pointerleave",()=>{var t,e,r;if(this._enterable&&(this._isEnterTooltip=!1,"none"!==this._spec.triggerOff&&this._cacheEnterableRect)){let n=null==(t=i.getBoundingClientRect)?void 0:t.call(i);n&&Object.keys(this._cacheEnterableRect).every(t=>this._cacheEnterableRect[t]===n[t])&&(this._cacheEnterableRect=null,this._outTimer=setTimeout(this.hideTooltip,null!=(r=null==(e=this._spec)?void 0:e.showDelay)?r:50))}}),this._needInitEventOfTooltip=!1)}_initProcessor(){let t=this._spec.activeType;this.processor={},t.forEach(t=>{let e=iv.createTooltipProcessor(t,this);e&&(this.processor[t]=e)})}_initEvent(){var t;if(this._option.disableTriggerEvent)return;let e=ed(null!=(t=this._spec.trigger)?t:"hover"),i=ed(this._spec.triggerOff),r=this._option.mode;e.forEach(t=>{var e;"hover"===t?(this._handleMouseMove=this._throttle(this._getMouseMoveHandler(!1)),this._mountEvent("pointermove",{source:"chart"},this._handleMouseMove),(eI(r)||eL(r))&&(this._mountEvent("pointerdown",{source:"chart"},this._getMouseMoveHandler(!1)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))),this._mountEvent("pointerleave",{source:"chart"},this._getMouseOutHandler(!1))):"click"===t?(this._mountEvent("pointertap",{source:"chart"},this._getMouseMoveHandler(!0)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))):e_(t)&&this._mountEvent(t.eventType,{source:null!=(e=t.source)?e:"chart",consume:t.consume},this._getMouseMoveHandler(!0))}),i.filter(t=>e_(t)).forEach(t=>{var e,i;this._mountEvent(t.eventType,{source:null!=(e=t.source)?e:"chart",consume:t.consume},this._getMouseOutHandler(null!=(i=t.checkOutside)&&i))}),!e.includes("click")&&this._spec.lockAfterClick&&this._mountEvent("pointertap",{source:"chart"},this._handleClickToLock)}_throttle(t){return iG(t,tG(this._spec.throttleInterval)?this._spec.throttleInterval:"html"===this._spec.renderMode&&this._spec.transitionDuration?50:10)}reInit(t){var e,i,r;if(super.reInit(t),this.tooltipHandler){let t=null!=(e=this._spec.renderMode)?e:"html",n=this._spec.enterable&&"html"===t;n&&!this._enterable&&(this._needInitEventOfTooltip=!0),this._enterable=n,null==(r=(i=this.tooltipHandler).reInit)||r.call(i)}else this._initHandler()}showTooltip(t,e){var i;if(this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),!(null==(i=this.tooltipHandler)?void 0:i.showTooltip))return!1;let r=function(t,e,i){var r,n,s;let l=Object.assign({regionIndex:0},e),a=i.getOption(),o=a.getRegionsInUserIdOrIndex(t8(l.regionId)?[l.regionId]:void 0,t8(l.regionIndex)?[l.regionIndex]:void 0)[0];if(!o)return"none";let h=M5(t,o),u=null!=(r=l.activeType)?r:h.length>1?"dimension":"mark",d=o.getLayoutStartPoint(),c=o.getLayoutRect(),p=a.globalInstance.getContainer(),g=Object.assign({x:0,y:0},p?function(t){let{x:e,y:i}=t.getBoundingClientRect();return{x:e,y:i}}(p):{}),f=t=>{var e;let{dimensionFields:i,dimensionData:r,measureFields:n,measureData:s,groupField:l,groupData:a}=t.data;return null==(e=t.series.getViewData())?void 0:e.latestData.find(t=>M2(i,r)(t)&&M2(n,s)(t)&&(er(l)||M2([l],[a])(t)))},m=t=>{var e,i;let r={x:Math.min(Math.max(t.x,0),c.width),y:Math.min(Math.max(t.y,0),c.height)},n=null!=(e=l.x)?e:d.x+r.x,s=null!=(i=l.y)?i:d.y+r.y;return{canvasX:n,canvasY:s,clientX:g.x+n,clientY:g.y+s}};if("dimension"===u){let e=h[0];if(!e)return"none";let r=new Map;h.forEach(t=>{var e;r.has(t.series)||r.set(t.series,[]),null==(e=r.get(t.series))||e.push(t)});let s=[{value:t[e.data.dimensionFields[0]],data:[...r.keys()].map(t=>{var e,i;return{series:t,datum:null!=(i=null==(e=r.get(t))?void 0:e.map(t=>f(t)))?i:[]}})}];t8(e.dimType)&&(s[0].position=e.pos[e.dimType],s[0].dimType=e.dimType);let l={changePositionOnly:!1,action:"enter",tooltip:null,dimensionInfo:s,chart:null!=(n=a.globalInstance.getChart())?n:void 0,datum:void 0,model:void 0,source:rL.chart,event:m({x:h.reduce((t,e)=>t+e.pos.x,0)/h.length,y:h.reduce((t,e)=>t+e.pos.y,0)/h.length}),item:void 0};i.processor.dimension.showTooltip(s,l,!1);let o=a.globalInstance;return dw.globalConfig.uniqueTooltip&&dw.hideTooltip(o.id),u}if("mark"===u){let e=h[0];if(!e)return"none";let r=Object.assign(Object.assign({},f(e)),t),n=[{datum:[r],series:e.series}],l={changePositionOnly:!1,tooltip:null,dimensionInfo:[{value:r[e.data.dimensionFields[0]],data:n}],chart:null!=(s=a.globalInstance.getChart())?s:void 0,datum:r,model:e.series,source:rL.chart,event:m(e.pos),item:void 0};i.processor.mark.showTooltip({datum:r,mark:null,series:e.series},l,!1);let o=a.globalInstance;return dw.globalConfig.uniqueTooltip&&dw.hideTooltip(o.id),u}return"none"}(t,e,this);return"none"!==r&&(this._alwaysShow=!!(null==e?void 0:e.alwaysShow)),r}_isSameAsCache(t,e,i){if(i!==this._cacheActiveType)return!1;if(t===this._cacheInfo)return!0;if(er(this._cacheInfo)||er(t))return!1;if(M6(t)){if(M4(this._cacheInfo))return!1;let e=this._cacheInfo;return e.length===t.length&&t.every((t,i)=>f0(t,e[i]))}if(M6(this._cacheInfo))return!1;let r=this._cacheInfo;if((null==t?void 0:t.datum)!==r.datum||(null==t?void 0:t.mark)!==r.mark||(null==t?void 0:t.series)!==r.series)return!1;let n=this._cacheParams;return!er(n)&&!er(e)&&n.mark===e.mark&&n.model===e.model&&n.datum===e.datum}_isPointerInChart(t){var e;let i=null==(e=this._option)?void 0:e.globalInstance;if(!i||!i.getChart())return!1;let{x:r,y:n}=t,{x:s,y:l,width:a,height:o}=i.getCanvas().getBoundingClientRect();return r>=s&&r<=s+a&&n>=l&&n<=l+o}getVisible(){return!1!==this._spec.visible}}M9.type=rk.tooltip,M9.transformerConstructor=M8,M9.builtInTheme={tooltip:{offset:{x:10,y:10},panel:{padding:{top:10,left:10,right:10,bottom:10},backgroundColor:{type:"palette",key:"popupBackgroundColor"},border:{color:{type:"palette",key:"popupBackgroundColor"},width:0,radius:3},shadow:{x:0,y:4,blur:12,spread:0,color:{type:"palette",key:"shadowColor"}}},spaceRow:6,titleLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0},shape:{size:8,spacing:6},keyLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle",spacing:26},valueLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0}}},M9.specKey="tooltip";let M7=()=>{iv.registerComponent(M9.type,M9)};class kt extends g3.k{constructor(){super(...arguments),this.name="crosshair"}render(){this.renderCrosshair(this)}}(0,op.M)(),(0,cJ.N)();class ke extends kt{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},ke.defaultAttributes,t))}renderCrosshair(t){let{start:e,end:i,lineStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-line",Object.assign({points:[e,i]},r),"line")}setLocation(t){let{start:e,end:i}=t;this.setAttributes({start:e,end:i})}}ke.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},(0,op.M)(),(0,m6.k)();class ki extends kt{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},ki.defaultAttributes,t))}renderCrosshair(t){let{start:e,end:i,rectStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-rect",Object.assign({x:e.x,y:e.y,width:i.x-e.x,height:i.y-e.y},r),"rect")}setLocation(t){let{start:e,end:i}=t;this.setAttributes({start:e,end:i})}}ki.defaultAttributes={rectStyle:{fill:"#b2bacf",opacity:.2}};var kr=i(52404);(te=tb||(tb={}))[te.ALL=3]="ALL",te[te.HORIZONTAL=2]="HORIZONTAL",te[te.VERTICAL=1]="VERTICAL";var kn=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let ks={x:["top","bottom"],y:["left","right"],category:["angle"],value:["radius"]};class kl extends gz{get enableRemain(){return"none"===this.triggerOff}constructor(t,e){super(t,e),this.specKey="crosshair",this.layoutType="none",this.gridZIndex=H.CrossHair_Grid,this.labelZIndex=H.CrossHair,this.trigger="hover",this._handleIn=t=>{if(!this._option)return;let{x:e,y:i}=this.calculateTriggerPoint(t);this.showDefault=!1,this._layoutCrosshair(e,i);let r=this._getNeedClearVRenderComponents();this._hasActive=r.some(t=>t&&!1!==t.attribute.visible)},this._handleClickInEvent=t=>{if(!this._hasActive||!this._spec.lockAfterClick||this._clickLock)return this._clickLock?(this._clickLock=!1,void this._handleOutEvent()):void(this._onlyLockClick||(this._handleIn(t),tG(this.triggerOff)&&(this._timer&&clearTimeout(this._timer),this._timer=setTimeout(()=>{this._handleOutEvent()},this.triggerOff))));this._clickLock=!0},this._handleHoverInEvent=iG(t=>{this._clickLock||this._handleIn(t)},10),this._handleOutEvent=()=>{this.enableRemain||this._clickLock||!this._hasActive||(this.clearOutEvent(),this.hide())},this._handleTooltipShow=t=>{let e=t.tooltipData;if(t.isEmptyTooltip||!e||!e.length||e_(this._spec.followTooltip)&&!1===this._spec.followTooltip[t.activeType])return void this._handleTooltipHideOrRelease();let{x:i,y:r}=this.calculateTriggerPoint(t);this.showDefault=!1,this._layoutCrosshair(i,r,e,t.activeType);let n=this._getNeedClearVRenderComponents();this._hasActive=n.some(t=>t&&!1!==t.attribute.visible)},this._handleTooltipHideOrRelease=()=>{this.clearOutEvent(),this.hide()},this.enable=!0,this.showDefault=!0}_setAllAxisValues(t,e,i){let r=!1;if(t.forEach(t=>{ll(t.axis.getScale().type)&&(r?this.enable=!1:r=!0)}),!this.enable)return!1;let{currentValue:n}=this._stateByField[i];return t.forEach((t,i)=>{let r=t.axis;n.set(i,{datum:this._getDatumAtPoint(r,e),axis:r})}),!0}clearAxisValue(){Object.keys(this._stateByField).forEach(t=>{this._stateByField[t].currentValue.clear()})}hideCrosshair(){this.clearAxisValue(),this.hide()}showCrosshair(t){t&&t.length&&(this.showDefault=!1,this.clearAxisValue(),t.forEach(t=>{let{axis:e,value:i}=t;this.setAxisValue(i,e)}),this.layoutByValue(!1))}_getLimitBounds(){var t,e;if(!this._limitBounds){let{width:i,height:r}=null!=(e=null==(t=this._option.globalInstance.getChart())?void 0:t.getViewRect())?e:{width:0,height:0};this._limitBounds={x1:0,y1:0,x2:i,y2:r}}return this._limitBounds}_showDefaultCrosshairBySpec(){Object.keys(this._stateByField).forEach(t=>{let e=this._spec[t];if(e&&e.visible&&e.defaultSelect){let{axisIndex:i=0,datum:r}=e.defaultSelect,n=this._option.getComponentsByKey("axes").find(t=>t.getSpecIndex()===i);n&&(this._stateByField[t].currentValue.clear(),this._stateByField[t].currentValue.set(i,{axis:n,datum:r}))}})}_updateVisibleCrosshair(){let t=!1;Object.keys(this._stateByField).forEach(e=>{let i=this._spec[e];i&&i.visible&&this._stateByField[e].currentValue.size?t=!0:this._hideByField(e)}),t&&this.layoutByValue(!1)}_showDefaultCrosshair(){this.showDefault?(this._showDefaultCrosshairBySpec(),this.layoutByValue(!1)):this._updateVisibleCrosshair()}setAttrFromSpec(){super.setAttrFromSpec(),this._parseCrosshairSpec()}created(){super.created(),this._initEvent()}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||t5(e,t)||(i.reRender=!0,i.reMake=!0),i}_initEvent(){if(!this._option.disableTriggerEvent)if(this._spec.followTooltip)this._registerTooltipEvent();else{let t=this._getTriggerEvent();t&&t.forEach(t=>{this._registerEvent(t.in,!1,t.click),t.out&&this._registerEvent(t.out,!0)})}}_registerEvent(t,e,i){let r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent,n=e?{level:rF.chart}:{source:rL.chart};tq(t)?t.forEach(t=>{this.event.on(t,n,r)}):this.event.on(t,n,r)}_eventOff(t,e,i){let r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent;tq(t)?t.forEach(t=>{this.event.off(t,r)}):this.event.off(t,r)}onBeforeRender(){this._limitBounds=null,this._showDefaultCrosshair()}calculateTriggerPoint(t){let{event:e}=t,i=this._option.getCompiler().getStage().getLayer(void 0),r={x:e.viewX,y:e.viewY};return i.globalTransMatrix.transformPoint({x:e.viewX,y:e.viewY},r),{x:r.x-this.getLayoutStartPoint().x,y:r.y-this.getLayoutStartPoint().y}}_getTriggerEvent(){let{mode:t=rM["desktop-browser"]}=this._option,e=t===rM["desktop-browser"]||t===rM["desktop-miniApp"]?{click:"pointertap",hover:"pointermove",hoverOut:"pointerleave",clickOut:"pointerleave"}:eI(t)||eL(t)?{click:"tap",hover:["pointerdown","pointermove"],hoverOut:"pointerleave",clickOut:"pointerleave"}:null;if(e){let t=ed(this.trigger||"hover"),i=t=>"click"===t?"none"===this.triggerOff?null:e.clickOut:e.hoverOut;this._spec.lockAfterClick&&!t.includes("click")?(t.push("click"),this._onlyLockClick=!0):this._onlyLockClick=!1;let r=[];return t.forEach(t=>{r.push({click:"click"===t,in:e[t],out:i(t)})}),r}return null}_registerTooltipEvent(){this.event.on(rI.tooltipHide,{source:rL.chart},this._handleTooltipHideOrRelease),this.event.on(rI.tooltipShow,{source:rL.chart},this._handleTooltipShow),this.event.on(rI.tooltipRelease,{source:rL.chart},this._handleTooltipHideOrRelease)}_getAxisInfoByField(t){var e,i;let r=null==(i=(e=this._option).getComponentsByKey)?void 0:i.call(e,"axes");if(!(null==r?void 0:r.length))return null;let n=iW(this._spec,`${t}Field.bindingAxesIndex`);if(n||(n=[],r.forEach((e,i)=>{ks[t].includes(e.getOrient())&&n.push(i)})),!n.length)return null;let s=new Map,l=1/0,a=1/0,o=-1/0,h=-1/0,{x:u,y:d}=this.getLayoutStartPoint();return n.forEach(t=>{l=1/0,a=1/0,o=-1/0,h=-1/0;let e=r.find(e=>e.getSpecIndex()===t);e&&(e.getRegions().forEach(t=>{let{x:e,y:i}=t.getLayoutStartPoint();l=Math.min(l,e-u),a=Math.min(a,i-d),o=Math.max(o,e+t.getLayoutRect().width-u),h=Math.max(h,i+t.getLayoutRect().height-d)}),s.set(t,{x1:l,y1:a,x2:o,y2:h,axis:e}))}),s}onLayoutEnd(){let t=this._regions[0];this.setLayoutRect(t.getLayoutRect()),this.setLayoutStartPosition(t.getLayoutStartPoint()),super.onLayoutEnd()}_releaseEvent(){this.clearOutEvent();let t=this._getTriggerEvent();t&&t.forEach(t=>{this._eventOff(t.in,!1,t.click),t.out&&this._eventOff(t.out,!0)})}_parseFieldInfo(){Object.keys(this._stateByField).forEach(t=>{let e=this._spec[t],{crosshairComp:i}=this._stateByField[t];if(e&&e.visible){if(this._stateByField[t].attributes=this._parseField(e,t),i){let{style:e,type:r}=this._stateByField[t].attributes;i.setAttributes({["rect"===r?"rectStyle":"lineStyle"]:e})}}else i&&i.parent&&i.parent.removeChild(i)})}_parseCrosshairSpec(){this._parseFieldInfo();let{trigger:t,triggerOff:e,labelZIndex:i,gridZIndex:r}=this._spec;t&&(this.trigger=t),("none"===e||tG(e)&&e>0)&&(this.triggerOff=e),void 0!==i&&(this.labelZIndex=i),void 0!==r&&(this.gridZIndex=r)}_parseField(t,e){var i,r,n;let s={},{line:l={},label:a={},visible:o}=t;if(s.visible=o,s.type=l.type||"line",!1===l.visible)s.style={visible:!1};else{let e=l.style||{},{stroke:n,fill:a,lineWidth:o}=e,{strokeOpacity:h,fillOpacity:u,opacity:d}=e,c=kn(e,["strokeOpacity","fillOpacity","opacity"]),p="line"===s.type,g=p?h:u;if(tG(d)&&(g=(null!=g?g:1)*d),s.style=Object.assign({opacity:g,pickable:!1,visible:!0},c),p)s.style.stroke=n||a,s.style.lineWidth=iW(l,"width",o||2);else{s.style.fill=a||n,(null==(r=null==(i=null==t?void 0:t.line)?void 0:i.style)?void 0:r.stroke)&&(s.style.stroke=t.line.style.stroke);let e=iW(l,"width");if("string"==typeof e){let t=parseInt(e.substring(0,e.length-1),10)/100;s.style.sizePercent=t}else"number"!=typeof e&&"function"!=typeof e||(s.style.size=e)}}if(a.visible){let t=a.labelBackground||{},e=null!=(n=a.syncAxisLabelAngle)&&n,i=a.style||{},r=t.style||{},{fill:l="rgba(47, 59, 82, 0.9)",stroke:o,outerBorder:h}=r,u=kn(r,["fill","stroke","outerBorder"]);s.label={visible:!0,formatMethod:a.formatMethod,formatter:a.formatter,minWidth:t.minWidth,maxWidth:t.maxWidth,padding:t.padding,syncAxisLabelAngle:e,textStyle:Object.assign(Object.assign({fontSize:14,pickable:!1},i),{fill:i.fill||"#fff",stroke:iW(i,"stroke")}),panel:(tX(t.visible)?t.visible:t)?Object.assign({visible:!0,pickable:!1,fill:l,stroke:o,outerBorder:Object.assign({stroke:l,distance:0,lineWidth:3},h)},u):{visible:!1},zIndex:this.labelZIndex,childrenPickable:!1,pickable:!1}}else s.label={visible:!1};return s}_filterAxisByPoint(t,e,i){return t&&t.forEach(r=>{let n=r.axis;if((r.x1>e||r.x2<e||r.y1>i||r.y2<i)&&t.delete(n.getSpecIndex()),n.type.startsWith("polarAxis")){let r=n.getCenter(),s=n.getInnerRadius(),l=n.getOuterRadius(),a=dD.distancePP({x:e,y:i},r);(a>l||a<s)&&t.delete(n.getSpecIndex())}}),t}_updateCrosshairLabel(t,e,i){let r=this.getContainer();t?t.setAttributes(e):(t=new kr.V(e),null==r||r.add(t),i(t)),function(t,e){let{x1:i,y1:r,x2:n,y2:s}=e,{x1:l,y1:a,x2:o,y2:h}=t.AABBBounds,{dx:u=0,dy:d=0}=t.attribute,c=0,p=0;l<i&&(c=i-l),a<r&&(p=r-a),o>n&&(c=n-o),h>s&&(p=s-h),c&&t.setAttribute("dx",c+u),p&&t.setAttribute("dy",p+d)}(t,this._getLimitBounds())}clearOutEvent(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._clickLock&&(this._clickLock=null),this._hasActive&&(this._hasActive=null)}_hideByField(t){let{crosshairComp:e,labelsComp:i}=this._stateByField[t];e&&e.hideAll(),i&&Object.keys(i).forEach(t=>{i[t]&&i[t].hideAll()})}hide(){Object.keys(this._stateByField).forEach(t=>{this._hideByField(t)})}_getNeedClearVRenderComponents(){return Object.keys(this._stateByField).reduce((t,e)=>{let{crosshairComp:i,labelsComp:r}=this._stateByField[e];return i&&t.push(i),r&&Object.keys(r).forEach(e=>{r[e]&&t.push(r[e])}),t},[])}}kl.specKey="crosshair";let ka={trigger:"hover",bandField:{visible:!1,line:{type:"rect",visible:!0,style:{fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineWidth:0,stroke:{type:"palette",key:"markLineStrokeColor"},lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}},linearField:{visible:!1,line:{type:"line",visible:!0,style:{stroke:{type:"palette",key:"markLineStrokeColor"},fill:"transparent",opacity:.7,lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}}};class ko extends kl{static getSpecInfo(t){return d6(t,this.specKey,this.type,t=>t.xField&&!1!==t.xField.visible||t.yField&&!1!==t.yField.visible)}constructor(t,e){super(t,e),this.type=rk.cartesianCrosshair,this.name=rk.cartesianCrosshair,this._stateByField={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:new Map,labelsComp:{top:null,bottom:null}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:new Map,labelsComp:{left:null,right:null}}}}_findAllAxisContains(t,e){let i=this._getAxisInfoByField("x"),r=this._getAxisInfoByField("y");return{xAxisMap:this._filterAxisByPoint(i,t,e),yAxisMap:this._filterAxisByPoint(r,t,e)}}_getDatumAtPoint(t,e){let i=p0(t.getOrient())?"x":"y",r=e[i]-(t.getLayoutStartPoint()[i]-this.getLayoutStartPoint()[i]);return t.getScale().invert(r)}setAxisValue(t,e){p0(e.getOrient())?this._stateByField.xField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.yField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})}_layoutCrosshair(t,e,i,r){var n;let s=t,l=e;if(i&&i.length){if("dimension"===r){let t,e=i[0],r=e.data.findIndex(t=>t.datum.length>0);if(r>-1){let i=e.data[r];t=i.series.dataToPosition(i.datum[0])}(t8(e.dimType)?"y"===e.dimType:p1(null==(n=null==e?void 0:e.axis)?void 0:n.getOrient()))?l=null==t?void 0:t.y:s=null==t?void 0:t.x}else if("mark"===r){let t=i[0],e=t.series.dataToPosition(t.datum[0]);s=null==e?void 0:e.x,l=null==e?void 0:e.y}}this.clearAxisValue();let{xAxisMap:a,yAxisMap:o}=this._findAllAxisContains(s,l);if(a&&0===a.size||o&&0===o.size){if(this.enableRemain)return;this.hide()}else a&&a.size&&this._setAllAxisValues(a,{x:s,y:l},"xField"),o&&o.size&&this._setAllAxisValues(o,{x:s,y:l},"yField"),this.layoutByValue()}layoutByValue(t){if(!this.enable)return;let e=pJ(this._regions,"cartesian");e&&(ml(this._stateByField,e,this.getLayoutStartPoint(),null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach(t=>{this._layoutByField(t)}))}_layoutByField(t){let{cacheInfo:e,attributes:i,labelsComp:r,bandSize:n,coordKey:s}=this._stateByField[t];if(!i||!e||e._isCache&&this.enableRemain)return;let{coord:l,labels:a,visible:o,labelsTextStyle:h}=e;if(o){let o=mh(this._stateByField[t]);this._updateCrosshairByField(t,o),Object.keys(a).forEach(o=>{var u,d,c;if(a[o].visible){let p=Object.assign(Object.assign(Object.assign({[s]:l+n/2},a[o]),i.label),{angle:i.label.syncAxisLabelAngle&&null!=(d=null==(u=e.axisLabel)?void 0:u.attribute.angle)?d:0,textStyle:Object.assign(Object.assign({},null==(c=i.label)?void 0:c.textStyle),h[o]),zIndex:this.labelZIndex,visible:!0});this._updateCrosshairLabel(r[o],p,e=>{e.name=`crosshair-${t.replace("Field","")}-${o}-label`,r[o]=e})}else r[o]&&r[o].hideAll()})}else this._hideByField(t)}_updateCrosshairByField(t,e){let i=this.getContainer(),{attributes:r}=this._stateByField[t],{crosshairComp:n}=this._stateByField[t];if(n)n.setAttributes(e);else{let s=r.style;"line"===r.type?n=new ke(Object.assign(Object.assign({},e),{lineStyle:s,zIndex:this.gridZIndex+1,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1})):"rect"===r.type&&(n=new ki(Object.assign(Object.assign({},e),{rectStyle:s,zIndex:this.gridZIndex,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1}))),null==i||i.add(n),this._stateByField[t].crosshairComp=n}}}ko.specKey="crosshair",ko.builtInTheme={crosshair:ka},ko.type=rk.cartesianCrosshair;let kh=()=>{iv.registerComponent(ko.type,ko)};(0,op.M)(),(0,bu.x)();class ku extends kt{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},ku.defaultAttributes,t))}renderCrosshair(t){let{center:e,radius:i,innerRadius:r=0,sectorStyle:n}=this.attribute,{startAngle:s,endAngle:l}=this.attribute;return t.createOrUpdateChild("crosshair-sector",Object.assign(Object.assign(Object.assign({},e),{outerRadius:i,innerRadius:r,startAngle:s,endAngle:l}),n),"arc")}setLocation(t){let{center:e,startAngle:i=pe.v2,endAngle:r=pe.Di}=this.attribute,n=r-i,s=(0,bs.Dt)((0,bs.Oy)(e,t));this.setAttributes({startAngle:s-n/2,endAngle:s+n/2})}}ku.defaultAttributes={sectorStyle:{fill:"#b2bacf",opacity:.2}},(0,op.M)(),(0,yE.N)();class kd extends kt{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},kd.defaultAttributes,t))}renderCrosshair(t){let e,{center:i,radius:r,sides:n=6,lineStyle:s}=this.attribute,{startAngle:l,endAngle:a}=this.attribute,o=(a-l)%(2*Math.PI)==0,h=(a-l)/n;for(let t=0;t<=n;t++){let s=(0,bs.op)(i,r,l+h*t);0===t?e=`M${s.x},${s.y}`:e+=`L${s.x},${s.y}`,t===n&&o&&(e+="Z")}return t.createOrUpdateChild("crosshair-polygon",Object.assign({path:e},s),"path")}setLocation(t){let{center:e}=this.attribute,i=uL.HL.distancePP(t,e);this.setAttribute("radius",i)}}kd.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},(0,op.M)(),(0,bu.x)();class kc extends kt{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},kc.defaultAttributes,t))}renderCrosshair(t){let{center:e,radius:i,lineStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-circle",Object.assign(Object.assign(Object.assign(Object.assign({},e),{outerRadius:i}),this.attribute),r),"arc")}setLocation(t){let{center:e}=this.attribute,i=uL.HL.distancePP(t,e);this.setAttribute("radius",i)}}kc.defaultAttributes={lineStyle:{stroke:["#b2bacf",!1,!1,!1],lineWidth:1,lineDash:[2]}};let kp=(t,e,i=!1)=>{Object.keys(t).forEach(r=>{let{attributes:n,currentValue:s,cacheInfo:l,coordKey:a}=t[r];if(n){let o=!!s.size,h=i&&!o&&t8(l),u=h?l:{coord:0,axis:null,visible:o,coordRange:[0,0],sizeRange:[0,0],labels:{all:{visible:!1,text:"",offset:0}}};if(l&&(l._isCache=h),"valueField"===r&&(u.sides=e.angleAxisHelper.getScale(0).domain().length),s.forEach(({axis:t,datum:i=""})=>{var s;let l=t.niceLabelFormatter;if((null==(s=n.label)?void 0:s.visible)&&(u.labels.all.visible=!0,u.labels.all.defaultFormatter=l,u.labels.all.text=i,u.labels.all.offset=gp(t.getSpec())),"categoryField"===r){let r=e.angleAxisHelper.dataToPosition([i]),n=e.angleAxisHelper.getBandwidth(0),s=t.getOuterRadius();u.coord=r,u.coordRange=[r-n/2,r+n/2],u.sizeRange=[s,s]}else{let r=t.startAngle,n=e.radiusAxisHelper.dataToPosition([i]);u.coord=n,u.coordRange=[n,n],u.sizeRange=[r,r]}u.axis=t}),u&&!h&&u.labels.all.visible&&n&&n.label){let t=u.labels.all,{formatMethod:e,formatter:i}=n.label,{formatFunc:r,args:s}=d4(e,i,t.text,{label:t.text,orient:a});r?t.text=r(...s):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))}t[r].cacheInfo=u}})},kg=(t,e,i)=>{let{cacheInfo:r,coordKey:n,attributes:s}=t,{axis:l,coord:a,sizeRange:o,coordRange:h}=r,u=l.getCenter(),d={x:u.x+e.x,y:u.y+e.y};if("angle"===n)return"sector"==("rect"===s.type?"sector":"line")?{center:d,innerRadius:l.getInnerRadius(),radius:l.getOuterRadius(),startAngle:h[0],endAngle:h[1]}:{start:ay(d,l.getInnerRadius(),a),end:ay(d,l.getOuterRadius(),a)};let c=l.startAngle,p=l.endAngle,g=r.sides,f=a;if(!i){let t=l.getCenter(),e=l.coordToPoint({angle:o[0],radius:a}),i=Math.atan2(e.y-t.y,e.x-t.x),r=(p-c)/g,n=Math.floor((i-c)/r),s=Math.min((n+1)*r+c,p),h=ay(t,a,n*r+c),u=ay(t,a,s),d=function(t,e,i,r){if(!pK(t,e,i,r))return!1;let n=[0,0],s=[0,0],l=[0,0];if(pU(n,e,t),pU(s,r,i),dM(n[0]-s[0])+dM(n[1]-s[1])<1e-12)return!0;pU(l,i,t);let a=dB(l,s)/dB(n,s);return a>=0&&a<=1&&[t[0]+n[0]*a,t[1]+n[1]*a]}([u.x,u.y],[h.x,h.y],[t.x,t.y],[e.x,e.y]);d&&(f=eG(dD.distancePN(e,d[0],d[1])+a,l.getInnerRadius(),l.getOuterRadius()))}return{center:d,startAngle:c,endAngle:p,radius:f,sides:g}};class kf extends kl{static getSpecInfo(t){return d6(t,this.specKey,this.type,t=>t.categoryField&&!1!==t.categoryField.visible||t.valueField&&!1!==t.valueField.visible)}constructor(t,e){super(t,e),this.type=rk.polarCrosshair,this.name=rk.polarCrosshair,this._stateByField={categoryField:{coordKey:"angle",anotherAxisKey:"radius",currentValue:new Map,labelsComp:{all:null}},valueField:{coordKey:"radius",anotherAxisKey:"angle",currentValue:new Map,labelsComp:{all:null}}}}setAxisValue(t,e){"radius"===e.getOrient()?this._stateByField.valueField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.categoryField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})}_findAllAxisContains(t,e){let i=this._getAxisInfoByField("category"),r=this._getAxisInfoByField("value");return{angleAxisMap:this._filterAxisByPoint(i,t,e),radiusAxisMap:this._filterAxisByPoint(r,t,e)}}_getDatumAtPoint(t,e){let{x:i,y:r}=t.getLayoutStartPoint(),{x:n,y:s}=this.getLayoutStartPoint();return t.positionToData({x:e.x-(i-n),y:e.y-(r-s)})}_layoutCrosshair(t,e,i,r){let n=t,s=e;if(i&&i.length){if("dimension"===r){let t=i[0];if(t.axis){let e=t.axis.pointToCoord({x:n,y:s}),i="radius"===t.axis.getOrient()?{radius:t.position,angle:e.angle}:{radius:e.radius,angle:t.position},r=t.axis.coordToPoint(i);n=r.x,s=r.y}}else if("mark"===r){let t=i[0],e=t.series.dataToPosition(t.datum[0]);n=e.x,s=e.y}}this.clearAxisValue();let{angleAxisMap:l,radiusAxisMap:a}=this._findAllAxisContains(n,s);if(0!==l.size||0!==a.size)l&&this._setAllAxisValues(l,{x:n,y:s},"categoryField"),a&&this._setAllAxisValues(a,{x:n,y:s},"valueField"),this.layoutByValue();else{if(this.enableRemain)return;this.hide()}}layoutByValue(t){if(!this.enable)return;let e=pJ(this._regions,"polar");e&&(kp(this._stateByField,e,null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach(t=>{this._layoutByField(t)}))}_layoutByField(t){var e,i,r,n;let{cacheInfo:s,attributes:l,crosshairComp:a,labelsComp:o,coordKey:h}=this._stateByField[t];if(!s||s._isCache&&this.enableRemain)return;let u=this.getContainer(),{visible:d,labels:c,coord:p,sizeRange:g,axis:f}=s;if(d){let s=this.getLayoutStartPoint(),d=null==(i=null==(e=this._spec.valueField)?void 0:e.line)?void 0:i.smooth,m=kg(this._stateByField[t],s,d);if(a)a.setAttributes(m);else{let e;if("angle"===h){let t="rect"===l.type?"sector":"line";"line"===t?e=new ke(Object.assign(Object.assign({},m),{lineStyle:l.style,zIndex:this.gridZIndex,pickable:!1})):"sector"===t&&(e=new ku(Object.assign(Object.assign({},m),{sectorStyle:l.style,zIndex:this.gridZIndex,pickable:!1})))}else e="polygon"==(d?"circle":"polygon")?new kd(Object.assign(Object.assign({},m),{lineStyle:l.style,zIndex:this.gridZIndex+1})):new kc(Object.assign(Object.assign({},m),{lineStyle:l.style,zIndex:this.gridZIndex}));this._stateByField[t].crosshairComp=e,u.add(e)}let y=c.all;if(y.visible){let t,e,i=f.getCenter(),a={x:i.x+s.x,y:i.y+s.y},u="angle"===h?(0,g5.mU)(p):(n=f.startAngle,{align:(n=ab(n))>=7/6*Math.PI&&n<=11/6*Math.PI?"right":n>=1/6*Math.PI&&n<=5/6*Math.PI?"left":"center",baseline:n>=5/3*Math.PI||n<=1/3*Math.PI?"bottom":n>=2/3*Math.PI&&n<=4/3*Math.PI?"top":"middle"}),d=Object.assign(Object.assign(Object.assign(Object.assign({},"angle"===h?ay(a,g[1]+y.offset,p):ay(a,m.radius,f.startAngle)),l.label),y),{textStyle:Object.assign(Object.assign({},null==(r=l.label)?void 0:r.textStyle),{textAlign:u.align,textBaseline:u.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(o.all,d,t=>{t.name=`crosshair-${h}-label`,o.all=t})}else o.all&&o.all.hideAll()}}}kf.specKey="crosshair",kf.builtInTheme={crosshair:ka},kf.type=rk.polarCrosshair;let km=()=>{iv.registerComponent(kf.type,kf)},ky=(t,e)=>{let{getNewDomain:i,isContinuous:r,field:n,originalFields:s}=e,l=n(),a=i();if(er(a)||er(l))return t;let o=s(),h=tq(l)?l[0]:l;return t[h]&&o&&o[h]&&o[h].lockStatisticsByDomain&&!r()&&(t[h].values=a),t},kv=(t,e)=>{let{getNewDomain:i,isContinuous:r,field:n}=e,s=n(),l=i();if(er(l)||er(s))return t;if(0===l.length)return[];let a={};l.forEach(t=>{a[t]||(a[t]=1)});let o=null;return o=r()?t=>{let e=!1;return ed(s).every(i=>{t[i]>=l[0]&&t[i]<=ec(l)&&(e=!0)}),e}:t=>{let e=!1;return ed(s).every(i=>{(a[t[i]+""]||a[t[i]])&&(e=!0)}),e},t.filter(o)},kb=(t,e)=>{let{stateFields:i,valueFields:r,dataCollection:n,isCategoryState:s}=e.input,{stateField:l,valueField:a}=e.output,o={},h=[],u=[],d=!1;return n.forEach((t,e)=>{var n;if(er(i[e]))return;let s=null==(n=t.getFields())?void 0:n[i[e]];s&&s.lockStatisticsByDomain&&(d=!0,s.domain.forEach(t=>{er(o[t])&&(u.push(t),o[t]=0)})),t.latestData.forEach(t=>{ed(i[e]).forEach(i=>{er(t[i])||(er(o[t[i]])&&(u.push(t[i]),o[t[i]]=0),er(r[e])||(o[t[i]]+=isNaN(parseFloat(t[r[e]]))?1:parseFloat(t[r[e]])))})})}),(d?u:!1===s?u.sort((t,e)=>t-e):Object.keys(o)).forEach(t=>{let e={[l]:t};a&&(e[a]=o[t]),h.push(e)}),h};class k_ extends gz{get relatedAxisComponent(){return this._relatedAxisComponent}setStartAndEnd(t,e,i=["percent","percent"]){let[r="percent",n="percent"]=i,s="percent"===r?t:this.dataToStatePoint(t),l="percent"===n?e:this.dataToStatePoint(e);this._handleChange(s,l,!0)}enableInteraction(){this._activeRoam=!0}disableInteraction(){this._activeRoam=!1}zoomIn(t){this._handleChartZoom({zoomDelta:1.2,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})}zoomOut(t){this._handleChartZoom({zoomDelta:.8,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})}_handleChange(t,e,i){var r,n;null!=(n=null==(r=this._spec)?void 0:r.zoomLock)&&n||e-t!==this._spanCache&&(e-t<this._minSpan||e-t>this._maxSpan)?this._shouldChange=!1:(this._shouldChange=!0,this._spanCache=e-t)}_isReverse(){let t=this._relatedAxisComponent;if(!t)return!1;let e=t.getScale();return e.range()[0]>e.range()[1]&&(!t.getInverse()||this._isHorizontal)}_updateRangeFactor(t){let e=this._relatedAxisComponent,i=e.getScale(),r=this._isReverse(),n=r?[1-this._end,1-this._start]:[this._start,this._end];if(r)switch(t){case"startHandler":e.scaleRangeFactorEnd(n[1]);break;case"endHandler":e.scaleRangeFactorStart(n[0]);break;default:e.scaleRangeFactorStart(n[0],!0),e.scaleRangeFactorEnd(n[1])}else switch(t){case"startHandler":e.scaleRangeFactorStart(n[0]);break;case"endHandler":e.scaleRangeFactorEnd(n[1]);break;default:e.scaleRangeFactorEnd(n[1],!0),e.scaleRangeFactorStart(n[0])}let s=i.rangeFactor();s?(this._start=r?1-s[1]:s[0],this._end=r?1-s[0]:s[1]):(this._start=0,this._end=1)}get visible(){return this._visible}constructor(t,e){super(t,e),this.layoutType="none",this._orient="left",this._cacheVisibility=void 0,this._dataUpdating=!1,this._shouldChange=!0,this._stateField="x",this._activeRoam=!0,this._zoomAttr={enable:!0,rate:1,focus:!0},this._dragAttr={enable:!0,rate:1,reverse:!0},this._scrollAttr={enable:!0,rate:1,reverse:!0},this.effect={onZoomChange:t=>{var e,i;let r=this._relatedAxisComponent;if(r&&"axis"===this._filterMode){let n=r.getScale(),s=r.getSpec();this._auto&&this._getAxisBandSize(s)&&this._spec.ignoreBandSize&&(n.bandwidth("auto"),n.maxBandwidth("auto"),n.minBandwidth("auto")),this._updateRangeFactor(t),this._auto&&(null==(i=null==(e=this._component)?void 0:e.setStartAndEnd)||i.call(e,this._start,this._end)),r.effect.scaleUpdate({value:"force"})}else pX(this._regions,t=>{var e;null==(e=t.getViewData())||e.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),pX(this._regions,t=>{t.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._visible=!0,this._handleStateChange=(t,e,i)=>{var r,n;return this._startValue=t,this._endValue=e,this._newDomain=this._parseDomainFromState(this._startValue,this._endValue),null==(n=(r=this.effect).onZoomChange)||n.call(r,i),!0},this._handleChartZoom=(t,e)=>{var i,r;if(!this._activeRoam||this._zoomAttr.filter&&!this._zoomAttr.filter(t,e))return;let{zoomDelta:n,zoomX:s,zoomY:l}=t,{x:a,y:o}=this._regions[0].getLayoutStartPoint(),{width:h,height:u}=this._regions[0].getLayoutRect(),d=Math.abs(this._start-this._end),c=null!=(r=null==(i=this._spec.roamZoom)?void 0:i.rate)?r:1;if(d>=1&&n<1||d<=.01&&n>1)return;let p=this._isHorizontal?s:l,g=d*(n-1)*c,f=g/2,m=g/2;if(p){let t=this._isHorizontal?a:o,e=this._isHorizontal?h:u;f=Math.abs(t-p)/Math.abs(e-t)*g,m=Math.abs(e-p)/Math.abs(e-t)*g}let y=eG(this._start+f,0,1),v=eG(this._end-m,0,1);this._handleChange(Math.min(y,v),Math.max(y,v),!0)},this._handleChartScroll=(t,e)=>{var i;if(!this._activeRoam||this._scrollAttr.filter&&!this._scrollAttr.filter(t,e))return!1;let{scrollX:r,scrollY:n}=t,s=this._isHorizontal?r:n,l=this._isHorizontal?dM(r/n)>=.5:dM(n/r)>=.5;this._scrollAttr.reverse||(s=-s),l&&this._handleChartMove(s,null!=(i=this._scrollAttr.rate)?i:1);let a=0!==this._start&&1!==this._end;return l&&a},this._handleChartDrag=(t,e)=>{var i,r;if(!this._activeRoam||this._dragAttr.filter&&!this._dragAttr.filter(t,e))return;(null==(i=this._spec.roamDrag)?void 0:i.autoVisible)&&this.show();let[n,s]=t,l=this._isHorizontal?n:s;this._dragAttr.reverse&&(l=-l),this._handleChartMove(l,null!=(r=this._dragAttr.rate)?r:1)},this._handleChartMove=(t,e)=>{let i=this._isHorizontal?this.getLayoutRect().width:this.getLayoutRect().height;if(Math.abs(t)>=1e-6){if(t>0&&this._end<1){let r=Math.min(1-this._end,t/i)*e;this._handleChange(this._start+r,this._end+r,!0)}else if(t<0&&this._start>0){let r=Math.max(-this._start,t/i)*e;this._handleChange(this._start+r,this._end+r,!0)}}return!1},this._orient=p3(t),this._isHorizontal="horizontal"===p5(this._orient)}created(){super.created(),this._setAxisFromSpec(),this._setRegionsFromSpec(),this._initEvent(),this._initData(),this._initStateScale(),this._setStateFromSpec()}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}_setAxisFromSpec(){if(t8(this._spec.axisId)?this._relatedAxisComponent=this._option.getComponentByUserId(this._spec.axisId):t8(this._spec.axisIndex)&&(this._relatedAxisComponent=this._option.getComponentByIndex("axes",this._spec.axisIndex)),er(this._spec.field)&&!this._relatedAxisComponent){let t=this._option.getComponentsByKey("axes"),e=t.find(t=>t._orient===this._orient);if(e)this._relatedAxisComponent=e;else{let e=t.find(t=>!ls(t.getScale().type));this._relatedAxisComponent=e}}this._relatedAxisComponent&&"axis"===this._filterMode&&(this._relatedAxisComponent.autoIndentOnce=!0)}_setRegionsFromSpec(){var t,e;this._regions=this._relatedAxisComponent?this._relatedAxisComponent.getRegions():this._option.getAllRegions();let i=this._relatedAxisComponent?null==(e=(t=this._relatedAxisComponent).getBindSeriesFilter)?void 0:e.call(t):null;if(t8(i)&&(t8(i.userId)&&(this._seriesUserId=ed(i.userId)),t8(i.specIndex)&&(this._seriesIndex=ed(i.specIndex))),t8(this._spec.seriesId)){let t=ed(this._spec.seriesId);this._seriesUserId?this._seriesUserId=this._seriesUserId.filter(e=>t.includes(e)):this._seriesUserId=t}if(t8(this._spec.seriesIndex)){let t=ed(this._spec.seriesIndex);this._seriesIndex?this._seriesIndex=this._seriesIndex.filter(e=>t.includes(e)):this._seriesIndex=t}if(t8(this._spec.regionIndex)){let t=this._option.getRegionsInIndex(ed(this._spec.regionIndex));this._regions=this._regions.filter(e=>t.includes(e))}else if(t8(this._spec.regionId)){let t=ed(this._spec.regionId);this._regions=t.length?this._regions.filter(e=>t.includes(e.id)):[]}}onDataUpdate(){var t;let e=this._computeDomainOfStateScale(ls(this._stateScale.type));this._stateScale.domain(e,!1),this._handleChange(this._start,this._end,!0),this._spec.auto&&!t5(this._domainCache,e)&&(this._domainCache=e,this._dataUpdating=!0,null==(t=this.getChart())||t.setLayoutTag(!0,null,!1))}_computeDomainOfStateScale(t){if(this._spec.customDomain)return this._spec.customDomain;let e=this._data.getLatestData().map(t=>t[this._stateField]);if(t){let t=e.map(t=>+t);return e.length?[eg(t),ep(t)]:[-1/0,1/0]}return e}_initEvent(){this._initCommonEvent()}_initData(){let t,e=[],i=[],r=[];if(this._relatedAxisComponent){let n={};pX(this._regions,s=>{var l,a;let o="cartesian"===s.coordinate?s.getXAxisHelper():"polar"===s.coordinate?s.angleAxisHelper:null,h="cartesian"===s.coordinate?s.getYAxisHelper():"polar"===s.coordinate?s.radiusAxisHelper:null;if(!o||!h)return;let u=o.getAxisId()===this._relatedAxisComponent.id?o:h.getAxisId()===this._relatedAxisComponent.id?h:this._isHorizontal?o:h,d=u===o?h:o;e.push(s.getRawData());let c=s.getSpec(),p="cartesian"===s.coordinate?ed(c.xField):ed(null!=(l=c.angleField)?l:c.categoryField),g="cartesian"===s.coordinate?ed(c.yField):ed(null!=(a=c.radiusField)?a:c.valueField);if(n[s.id]="link"===s.type?["from_xField"]:u===o?p:g,ls(u.getScale(0).type)?(t=!1,i.push(n[s.id])):i.push(n[s.id][0]),this._valueField){let t="link"===s.type?["from_yField"]:d===o?p:g;ls(d.getScale(0).type)&&r.push(...t)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._originalStateFields=n}else pX(this._regions,t=>{e.push(t.getRawData()),i.push(this._field),this._valueField&&r.push(this._spec.valueField)},{userId:this._seriesUserId,specIndex:this._seriesIndex});let{dataSet:n}=this._option;nJ(n,"dataview",tJ),nq(n,"dataFilterComputeDomain",kb);let s=new el(n,{name:`${this.type}_${this.id}_data`});s.transform({type:"dataFilterComputeDomain",options:{input:{dataCollection:e,stateFields:i,valueFields:r,isCategoryState:t},output:{stateField:this._stateField,valueField:this._valueField}}},!1),this._data=new aC(this._option,s),s.reRunAllTransform(),n.multipleDataViewAddListener(e,"change",this._handleDataCollectionChange.bind(this))}setAttrFromSpec(){var t;super.setAttrFromSpec(),!0===this._spec.roamZoom||this._spec.roamZoom?this._zoomAttr=ei({},this._zoomAttr,this._spec.roamZoom):this._zoomAttr.enable=!1,!0===this._spec.roamDrag||this._spec.roamDrag?this._dragAttr=ei({},this._dragAttr,this._spec.roamDrag):this._dragAttr.enable=!1,!0===this._spec.roamScroll||this._spec.roamScroll?this._scrollAttr=ei({},this._scrollAttr,this._spec.roamScroll):this._scrollAttr.enable=!1,this._field=this._spec.field,this._width=this._computeWidth(),this._height=this._computeHeight(),this._visible=null==(t=this._spec.visible)||t}statePointToData(t){let e=this._stateScale,i=e.domain();if(ls(e.type))return this._isReverse()?i[0]+(ec(i)-i[0])*(1-t):i[0]+(ec(i)-i[0])*t;let r=e.range();this._isReverse()&&(r=r.slice().reverse());let n=r[0]+(ec(r)-r[0])*t;return e.invert(n)}dataToStatePoint(t){let e=this._stateScale,i=e.scale(t),r=e.range();return!this._isHorizontal&&ls(e.type)&&(r=r.slice().reverse()),(i-r[0])/(ec(r)-r[0])}_modeCheck(t,e){return"start"===t?"percent"===e&&t8(this._spec.start)||"value"===e&&t8(this._spec.startValue):"percent"===e&&t8(this._spec.end)||"value"===e&&t8(this._spec.endValue)}_setStateFromSpec(){var t,e;let i,r;if(this._auto=!!this._spec.auto,this._spec.rangeMode){let[t,e]=this._spec.rangeMode;this._modeCheck("start",t)&&this._modeCheck("end",e)&&(i="percent"===t?this._spec.start:this.dataToStatePoint(this._spec.startValue),r="percent"===e?this._spec.end:this.dataToStatePoint(this._spec.endValue))}else i=this._spec.start?this._spec.start:this._spec.startValue?this.dataToStatePoint(this._spec.startValue):0,r=this._spec.end?this._spec.end:this._spec.endValue?this.dataToStatePoint(this._spec.endValue):1;this._startValue=this.statePointToData(i),this._endValue=this.statePointToData(r),this._start=i,this._end=r,this._minSpan=null!=(t=this._spec.minSpan)?t:0,this._maxSpan=null!=(e=this._spec.maxSpan)?e:1,ls(this._stateScale.type)&&this._stateScale.domain()[0]!==ec(this._stateScale.domain())&&(this._spec.minValueSpan&&(this._minSpan=this._spec.minValueSpan/(ec(this._stateScale.domain())-this._stateScale.domain()[0])),this._spec.maxValueSpan&&(this._maxSpan=this._spec.maxValueSpan/(ec(this._stateScale.domain())-this._stateScale.domain()[0]))),this._minSpan=Math.max(0,this._minSpan),this._maxSpan=Math.min(this._maxSpan,1),this._relatedAxisComponent&&"axis"===this._filterMode||0===this._start&&1===this._end||(this._newDomain=this._parseDomainFromState(this._startValue,this._endValue))}_parseFieldOfSeries(t){var e;return null==(e=this._originalStateFields)?void 0:e[t.id]}_initStateScale(){let t=[0,1];if(this._relatedAxisComponent){let e=this._relatedAxisComponent.getScale(),i=ls(e.type),r=this._computeDomainOfStateScale(i);if(this._stateScale=e.clone(),i){let e=r.map(t=>+t);this._stateScale.domain(r.length?[eg(e),ep(e)]:[0,1],!0).range(t)}else this._stateScale.domain(r,!0).range(t)}else this._stateScale=new ae,this._stateScale.domain(this._computeDomainOfStateScale(),!0).range(t)}init(t){super.init(t),this._addTransformToSeries(),0===this._start&&1===this._end||this.effect.onZoomChange()}_addTransformToSeries(){this._relatedAxisComponent&&"axis"===this._filterMode||(nq(this._option.dataSet,"dataFilterWithNewDomain",kv),nq(this._option.dataSet,"lockStatisticsFilter",ky),pX(this._regions,t=>{t.getViewDataStatistics().transform({type:"lockStatisticsFilter",options:{originalFields:()=>t.getViewDataStatistics().getFields(),getNewDomain:()=>this._newDomain,field:()=>{var e;return null!=(e=this._field)?e:this._parseFieldOfSeries(t)},isContinuous:()=>ls(this._stateScale.type)},level:1},!1),t.addViewDataFilter({type:"dataFilterWithNewDomain",options:{getNewDomain:()=>this._newDomain,field:()=>{var e;return null!=(e=this._field)?e:this._parseFieldOfSeries(t)},isContinuous:()=>ls(this._stateScale.type)},level:F.dataZoomFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex}))}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||t5(e,t)||(i.reRender=!0,i.reMake=!0),i}reInit(t){super.reInit(t),this._marks.forEach(t=>{t.getMarks().forEach(t=>{this.initMarkStyleWithSpec(t,this._spec[t.name])})})}_parseDomainFromState(t,e){if(ls(this._stateScale.type))return[Math.min(e,t),Math.max(e,t)];let i=this._stateScale.domain(),r=i.indexOf(t),n=i.indexOf(e);return i.slice(Math.min(r,n),Math.max(r,n)+1)}_initCommonEvent(){var t,e,i,r,n,s,l,a;let o={delayType:null!=(e=null==(t=this._spec)?void 0:t.delayType)?e:"throttle",delayTime:t8(null==(i=this._spec)?void 0:i.delayType)?null!=(n=null==(r=this._spec)?void 0:r.delayTime)?n:30:0,realTime:null==(l=null==(s=this._spec)?void 0:s.realTime)||l,allowComponentZoom:!0};this._zoomAttr.enable&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom,o),this._scrollAttr.enable&&this.initScrollEventOfRegions(this._regions,null,this._handleChartScroll,o),this._dragAttr.enable&&this.initDragEventOfRegions(this._regions,null,this._handleChartDrag,o),(null==(a=this._spec.roamDrag)?void 0:a.autoVisible)&&(this._throttledHide=iG(()=>this.hide(),300),this.event.on("panend",()=>{this._throttledHide()}))}updateLayoutAttribute(){this._visible&&this._createOrUpdateComponent(),super.updateLayoutAttribute()}_autoVisible(t){if(!this._auto)return;t?this.show():this.hide();let e=this._isHorizontal?"height":"width";this.layout.setLayoutRect({[e]:t?this[`_${e}`]:0},{[e]:W.Built_In})}onLayoutStart(t,e){super.onLayoutStart(t,e);let i=this._autoUpdate(t);this._autoVisible(i),this._dataUpdating=!1}onLayoutEnd(){let t=0!==this._start||1!==this._end;this._autoVisible(t),super.onLayoutEnd()}getBoundsInRect(t){let e={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0};return this._isHorizontal?(e.y2=e.y1+this._height,e.x2=e.x1+t.width):(e.x2=e.x1+this._width,e.y2=e.y1+t.height),e}hide(){var t;null==(t=this._component)||t.hideAll()}show(){var t;null==(t=this._component)||t.showAll()}_getAxisBandSize(t){let e=null==t?void 0:t.bandSize,i=null==t?void 0:t.maxBandSize,r=null==t?void 0:t.minBandSize;if(e||r||i)return{bandSize:e,maxBandSize:i,minBandSize:r}}_autoUpdate(t){var e,i,r,n,s,l;if(!this._auto)return this._cacheVisibility=void 0,!0;let a=this._relatedAxisComponent,o=null==a?void 0:a.getSpec(),h=null==a?void 0:a.getScale(),u=this._getAxisBandSize(o);if(!this._dataUpdating&&ll(h.type)&&(null==t?void 0:t.height)===(null==(e=this._cacheRect)?void 0:e.height)&&(null==t?void 0:t.width)===(null==(i=this._cacheRect)?void 0:i.width)&&this._fixedBandSize===(null==u?void 0:u.bandSize))return this._cacheVisibility;let d=!0;if(this._isHorizontal&&(null==t?void 0:t.width)!==(null==(r=this._cacheRect)?void 0:r.width)?h.range(a.getInverse()?[t.width,0]:[0,t.width]):(null==t?void 0:t.height)!==(null==(n=this._cacheRect)?void 0:n.height)&&h.range(a.getInverse()?[0,t.height]:[t.height,0]),this._cacheRect={width:null==t?void 0:t.width,height:null==t?void 0:t.height},this._fixedBandSize=null==u?void 0:u.bandSize,ll(h.type)){u&&(this._start||this._end)&&(this.type===rk.scrollBar&&(this._start=0,this._end=1),this._updateRangeFactor());let[t,e]=null!=(s=h.rangeFactor())?s:[];d=(!er(t)||!er(e))&&(0!==t||1!==e)}else{let[t,e]=null!=(l=h.rangeFactor())?l:[this._start,this._end];d=0!==t||1!==e}return this.setStartAndEnd(this._start,this._end),this._cacheVisibility=d,d}_getNeedClearVRenderComponents(){return[this._component]}clear(){this._throttledHide=null}}cG(k_,vU);var kx=i(88663);(ti=t_||(t_={})).startHandler="startHandler",ti.endHandler="endHandler",ti.middleHandler="middleHandler",ti.background="background",(tr=tx||(tx={})).stateUpdate="stateUpdate",tr.maskUpdate="maskUpdate",tr.dataZoomUpdate="dataZoomUpdate",(tC||(tC={})).dataZoomChange="dataZoomChange";let kC="M -0.0544 0.25 C -0.0742 0.25 -0.0901 0.234 -0.0901 0.2143 L -0.0901 -0.1786 C -0.0901 -0.1983 -0.0742 -0.2143 -0.0544 -0.2143 L -0.0187 -0.2143 L -0.0187 -0.5 L 0.017 -0.5 L 0.017 -0.2143 L 0.0527 -0.2143 C 0.0724 -0.2143 0.0884 -0.1983 0.0884 -0.1786 L 0.0884 0.2143 C 0.0884 0.234 0.0724 0.25 0.0527 0.25 L 0.017 0.25 L 0.017 0.5 L -0.0187 0.5 L -0.0187 0.25 L -0.0544 0.25 Z M -0.0187 -0.1429 L -0.0544 -0.1429 L -0.0544 0.1786 L -0.0187 0.1786 L -0.0187 -0.1429 Z M 0.0527 -0.1429 L 0.017 -0.1429 L 0.017 0.1786 L 0.0527 0.1786 L 0.0527 -0.1429 Z",kw={horizontal:{angle:0,strokeBoundsBuffer:0,boundsPadding:2,pickMode:"imprecise",cursor:"ew-resize"},vertical:{angle:Math.PI/180*90,cursor:"ns-resize",boundsPadding:2,pickMode:"imprecise",strokeBoundsBuffer:0}},kS=(t,e,i,r)=>{if(!e)return!1;if(r){if("start"===i){if(e.x1<t.x1)return!0}else if(e.x2>t.x2)return!0}else if("start"===i){if(e.y1<t.y1)return!0}else if(e.y2>t.y2)return!0;return!1};var kA=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class kM{get startHandlerMask(){return this._startHandlerMask}get middleHandlerSymbol(){return this._middleHandlerSymbol}get middleHandlerRect(){return this._middleHandlerRect}get endHandlerMask(){return this._endHandlerMask}get selectedBackground(){return this._selectedBackground}get dragMask(){return this._dragMask}get startText(){return this._startText}get endText(){return this._endText}get startValue(){return this._startValue}get endValue(){return this._endValue}set showText(t){this._showText=t}get background(){return this._background}set previewData(t){this._previewData=t}get previewGroup(){return this._previewGroup}get selectedPreviewGroup(){return this._selectedPreviewGroup}set previewPointsX(t){this._previewPointsX=t}set previewPointsY(t){this._previewPointsY=t}set previewPointsX1(t){this._previewPointsX1=t}set previewPointsY1(t){this._previewPointsY1=t}set statePointToData(t){this._statePointToData=t}_initAttrs(t){this.attribute=t.attribute,this._isHorizontal="top"===this.attribute.orient||"bottom"===this.attribute.orient;let{previewData:e,previewPointsX:i,previewPointsY:r,previewPointsX1:n,previewPointsY1:s}=this.attribute;e&&(this._previewData=e),(0,uy.Z)(i)&&(this._previewPointsX=i),(0,uy.Z)(r)&&(this._previewPointsY=r),(0,uy.Z)(n)&&(this._previewPointsX1=n),(0,uy.Z)(s)&&(this._previewPointsY1=s),this._getState=t.getState,this._getLayoutAttrFromConfig=t.getLayoutAttrFromConfig,this._getContainer=t.getContainer}constructor(t){this._previewData=[],this._statePointToData=t=>t;let{showDetail:e}=t.attribute;this._showText="auto"!==e&&e,this._initAttrs(t)}setAttributes(t){this._initAttrs(t)}renderDataZoom(t=!1){var e,i,r,n,s,l;let{backgroundChartStyle:a={},selectedBackgroundChartStyle:o={},brushSelect:h}=this.attribute;this._renderBackground(),(null==(e=a.line)?void 0:e.visible)&&!t&&this._setPreviewAttributes("line",this._getContainer()),(null==(i=a.area)?void 0:i.visible)&&!t&&this._setPreviewAttributes("area",this._getContainer()),h&&this.renderDragMask(),this._renderSelectedBackground(),(null==(r=o.line)?void 0:r.visible)&&this._setSelectedPreviewClipAttributes("line",this._getContainer()),(null==(n=o.line)?void 0:n.visible)&&!t&&this._setSelectedPreviewAttributes("line"),(null==(s=o.line)?void 0:s.visible)&&this._setSelectedPreviewClipAttributes("area",this._getContainer()),(null==(l=o.area)?void 0:l.visible)&&!t&&this._setSelectedPreviewAttributes("area"),this._renderHandler(),this._showText&&this.renderText()}renderDragMask(){let{dragMaskStyle:t}=this.attribute,{position:e,width:i,height:r}=this._getLayoutAttrFromConfig(),{start:n,end:s}=this._getState();return this._isHorizontal?this._dragMask=this._getContainer().createOrUpdateChild("dragMask",Object.assign({x:e.x+n*i,y:e.y,width:(s-n)*i,height:r},t),"rect"):this._dragMask=this._getContainer().createOrUpdateChild("dragMask",Object.assign({x:e.x,y:e.y+n*r,width:i,height:(s-n)*r},t),"rect"),{start:n,end:s}}_renderBackground(){var t;let{backgroundStyle:e,brushSelect:i,zoomLock:r}=this.attribute,{position:n,width:s,height:l}=this._getLayoutAttrFromConfig(),a=this._getContainer();this._background=a.createOrUpdateChild("background",Object.assign(Object.assign({x:n.x,y:n.y,width:s,height:l,cursor:i?"crosshair":"auto"},e),{pickable:!r&&(null==(t=e.pickable)||t)}),"rect")}_renderHandler(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M;let{orient:k,middleHandlerStyle:T={},startHandlerStyle:R={},endHandlerStyle:B={},zoomLock:P}=this.attribute,{start:E,end:I}=this._getState(),{position:L,width:F,height:O}=this._getLayoutAttrFromConfig(),D=null!=(t=R.triggerMinSize)?t:40,H=null!=(e=B.triggerMinSize)?e:40,z=this._getContainer();if(this._isHorizontal){if(T.visible){let t=(null==(i=T.background)?void 0:i.size)||10;this._middleHandlerRect=z.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:L.x+E*F,y:L.y-t,width:(I-E)*F,height:t},null==(r=T.background)?void 0:r.style),{pickable:!P&&(null==(l=null==(s=null==(n=T.background)?void 0:n.style)?void 0:s.pickable)||l)}),"rect"),this._middleHandlerSymbol=z.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:L.x+(E+I)/2*F,y:L.y-t/2,strokeBoundsBuffer:0,angle:0,symbolType:null!=(o=null==(a=T.icon)?void 0:a.symbolType)?o:"square"},T.icon),{pickable:!P&&(null==(h=T.icon.pickable)||h)}),"symbol")}this._startHandler=z.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:L.x+E*F,y:L.y+O/2,size:O,symbolType:null!=(u=R.symbolType)?u:"square"},kw.horizontal),R),{pickable:!P&&(null==(d=R.pickable)||d)}),"symbol"),this._endHandler=z.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:L.x+I*F,y:L.y+O/2,size:O,symbolType:null!=(c=B.symbolType)?c:"square"},kw.horizontal),B),{pickable:!P&&(null==(p=B.pickable)||p)}),"symbol");let t=Math.max(this._startHandler.AABBBounds.width(),D),e=Math.max(this._startHandler.AABBBounds.height(),D),g=Math.max(this._endHandler.AABBBounds.width(),H),f=Math.max(this._endHandler.AABBBounds.height(),H);this._startHandlerMask=z.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:L.x+E*F-t/2,y:L.y+O/2-e/2,width:t,height:e,fill:"white",fillOpacity:0,zIndex:999},kw.horizontal),{pickable:!P}),"rect"),this._endHandlerMask=z.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:L.x+I*F-g/2,y:L.y+O/2-f/2,width:g,height:f,fill:"white",fillOpacity:0,zIndex:999},kw.horizontal),{pickable:!P}),"rect")}else{if(T.visible){let t=(null==(g=T.background)?void 0:g.size)||10;this._middleHandlerRect=z.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:"left"===k?L.x-t:L.x+F,y:L.y+E*O,width:t,height:(I-E)*O},null==(f=T.background)?void 0:f.style),{pickable:!P&&(null==(v=null==(y=null==(m=T.background)?void 0:m.style)?void 0:y.pickable)||v)}),"rect"),this._middleHandlerSymbol=z.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:"left"===k?L.x-t/2:L.x+F+t/2,y:L.y+(E+I)/2*O,angle:Math.PI/180*90,symbolType:null!=(_=null==(b=T.icon)?void 0:b.symbolType)?_:"square",strokeBoundsBuffer:0},T.icon),{pickable:!P&&(null==(C=null==(x=T.icon)?void 0:x.pickable)||C)}),"symbol")}this._startHandler=z.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:L.x+F/2,y:L.y+E*O,size:F,symbolType:null!=(w=R.symbolType)?w:"square"},kw.vertical),R),{pickable:!P&&(null==(S=R.pickable)||S)}),"symbol"),this._endHandler=z.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:L.x+F/2,y:L.y+I*O,size:F,symbolType:null!=(A=B.symbolType)?A:"square"},kw.vertical),B),{pickable:!P&&(null==(M=B.pickable)||M)}),"symbol");let t=Math.max(this._startHandler.AABBBounds.width(),D),e=Math.max(this._startHandler.AABBBounds.height(),D),i=Math.max(this._endHandler.AABBBounds.width(),H),r=Math.max(this._endHandler.AABBBounds.height(),H);this._startHandlerMask=z.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:L.x+F/2+t/2,y:L.y+E*O-e/2,width:r,height:i,fill:"white",fillOpacity:0,zIndex:999},kw.vertical),{pickable:!P}),"rect"),this._endHandlerMask=z.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:L.x+F/2+i/2,y:L.y+I*O-r/2,width:r,height:i,fill:"white",fillOpacity:0,zIndex:999},kw.vertical),{pickable:!P}),"rect")}}_renderSelectedBackground(){var t,e;let{selectedBackgroundStyle:i={},selectedBackgroundChartStyle:r={},brushSelect:n,zoomLock:s}=this.attribute,{start:l,end:a}=this._getState(),{position:o,width:h,height:u}=this._getLayoutAttrFromConfig(),d=this._getContainer();this._isHorizontal?this._selectedBackground=d.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:o.x+l*h,y:o.y,width:(a-l)*h,height:u,cursor:n?"crosshair":"move"},i),{pickable:!s&&(null==(t=r.pickable)||t)}),"rect"):this._selectedBackground=d.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:o.x,y:o.y+l*u,width:h,height:(a-l)*u,cursor:n?"crosshair":"move"},i),{pickable:!s&&(null==(e=i.pickable)||e)}),"rect")}_setPreviewAttributes(t,e){this._previewGroup||(this._previewGroup=e.createOrUpdateChild("previewGroup",{pickable:!1},"group")),"line"===t?this._previewLine=this._previewGroup.createOrUpdateChild("previewLine",{},"line"):this._previewArea=this._previewGroup.createOrUpdateChild("previewArea",{curveType:"basis"},"area");let{backgroundChartStyle:i={}}=this.attribute;"line"===t&&this._previewLine.setAttributes(Object.assign({points:this._getPreviewLinePoints(),curveType:"basis",pickable:!1},i.line)),"area"===t&&this._previewArea.setAttributes(Object.assign({points:this._getPreviewAreaPoints(),curveType:"basis",pickable:!1},i.area))}_setSelectedPreviewClipAttributes(t,e){this._selectedPreviewGroupClip||(this._selectedPreviewGroupClip=e.createOrUpdateChild("selectedPreviewGroupClip",{pickable:!1},"group"),this._selectedPreviewGroup=this._selectedPreviewGroupClip.createOrUpdateChild("selectedPreviewGroup",{},"group"));let{start:i,end:r}=this._getState(),{position:n,width:s,height:l}=this._getLayoutAttrFromConfig();this._selectedPreviewGroupClip.setAttributes({x:this._isHorizontal?n.x+i*s:n.x,y:this._isHorizontal?n.y:n.y+i*l,width:this._isHorizontal?(r-i)*s:s,height:this._isHorizontal?l:(r-i)*l,clip:!0,pickable:!1}),this._selectedPreviewGroup.setAttributes({x:-(this._isHorizontal?n.x+i*s:n.x),y:-(this._isHorizontal?n.y:n.y+i*l),width:this._isHorizontal?(r-i)*s:s,height:this._isHorizontal?l:(r-i)*l,pickable:!1})}_setSelectedPreviewAttributes(t){let{selectedBackgroundChartStyle:e={}}=this.attribute;"line"===t?this._selectedPreviewLine=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewLine",{},"line"):this._selectedPreviewArea=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewArea",{curveType:"basis"},"area"),"line"===t&&this._selectedPreviewLine.setAttributes(Object.assign({points:this._getPreviewLinePoints(),curveType:"basis",pickable:!1},e.line)),"area"===t&&this._selectedPreviewArea.setAttributes(Object.assign({points:this._getPreviewAreaPoints(),curveType:"basis",pickable:!1},e.area))}_computeBasePoints(){let t,e,{orient:i}=this.attribute,{position:r,width:n,height:s}=this._getLayoutAttrFromConfig();return this._isHorizontal?(t=[{x:r.x,y:r.y+s}],e=[{x:r.x+n,y:r.y+s}]):"left"===i?(t=[{x:r.x+n,y:r.y}],e=[{x:r.x+n,y:r.y+s}]):(t=[{x:r.x,y:r.y+s}],e=[{x:r.x,y:r.y}]),{basePointStart:t,basePointEnd:e}}_simplifyPoints(t){var e,i;if(t.length>1e4){let r=null!=(e=this.attribute.tolerance)?e:this._previewData.length/1e4;return(i=t).length<=10?i:i=function(t,e){let i,r,n=t[0].x,s=t[0].y,l=[t[0]];for(let a=1,o=t.length;a<o;a++)(i=t[a].x-n)*i+(r=t[a].y-s)*r>e&&(n=t[a].x,s=t[a].y,l.push(t[a]));return t[t.length-1].x===n&&t[t.length-1].y===s||l.push(t[t.length-1]),l}(i,void 0!==r?r*r:1)}return t}_getPreviewLinePoints(){let t=this._previewData.map(t=>({x:this._previewPointsX&&this._previewPointsX(t),y:this._previewPointsY&&this._previewPointsY(t)}));if(0===t.length)return t;t=this._simplifyPoints(t);let{basePointStart:e,basePointEnd:i}=this._computeBasePoints();return e.concat(t).concat(i)}_getPreviewAreaPoints(){let t=this._previewData.map(t=>({x:this._previewPointsX&&this._previewPointsX(t),y:this._previewPointsY&&this._previewPointsY(t),x1:this._previewPointsX1&&this._previewPointsX1(t),y1:this._previewPointsY1&&this._previewPointsY1(t)}));if(0===t.length)return t;t=this._simplifyPoints(t);let{basePointStart:e,basePointEnd:i}=this._computeBasePoints();return e.concat(t).concat(i)}renderText(){let t=null,e=null;if(this._setTextAttr(t,e),this._showText){t=this._startText.AABBBounds,e=this._endText.AABBBounds,this._setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds;let{x1:i,x2:r,y1:n,y2:s}=t,{dx:l=0,dy:a=0}=this.attribute.startTextStyle;if((new aI.YZ).set(i,n,r,s).intersects(e)){let t="bottom"===this.attribute.orient||"right"===this.attribute.orient?-1:1;this._isHorizontal?this._startText.setAttribute("dy",a+t*Math.abs(e.y1-e.y2)):this._startText.setAttribute("dx",l+t*Math.abs(e.x1-e.x2))}else this._isHorizontal?this._startText.setAttribute("dy",a):this._startText.setAttribute("dx",l)}}_setTextAttr(t,e){var i,r,n,s,l,a,o,h;let u,d,c,p,{startTextStyle:g,endTextStyle:f}=this.attribute,{formatMethod:m}=g,y=kA(g,["formatMethod"]),{formatMethod:v}=f,b=kA(f,["formatMethod"]),{start:_,end:x}=this._getState();this._startValue=this._statePointToData(_),this._endValue=this._statePointToData(x);let{position:C,width:w,height:S}=this._getLayoutAttrFromConfig(),A=m?m(this._startValue):this._startValue,M=v?v(this._endValue):this._endValue,k={x1:C.x,y1:C.y,x2:C.x+w,y2:C.y+S};this._isHorizontal?(u={x:C.x+_*w,y:C.y+S/2},d={x:C.x+x*w,y:C.y+S/2},c={textAlign:kS(k,t,"start",this._isHorizontal)?"left":"right",textBaseline:null!=(r=null==(i=null==y?void 0:y.textStyle)?void 0:i.textBaseline)?r:"middle"},p={textAlign:kS(k,e,"end",this._isHorizontal)?"right":"left",textBaseline:null!=(s=null==(n=null==b?void 0:b.textStyle)?void 0:n.textBaseline)?s:"middle"}):(u={x:C.x+w/2,y:C.y+_*S},d={x:C.x+w/2,y:C.y+x*S},c={textAlign:null!=(a=null==(l=null==y?void 0:y.textStyle)?void 0:l.textAlign)?a:"center",textBaseline:kS(k,t,"start",this._isHorizontal)?"top":"bottom"},p={textAlign:null!=(h=null==(o=null==b?void 0:b.textStyle)?void 0:o.textAlign)?h:"center",textBaseline:kS(k,e,"end",this._isHorizontal)?"bottom":"top"}),this._startText=this._maybeAddLabel(this._getContainer(),(0,cQ.Z)({},y,{text:A,x:u.x,y:u.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:c}),"data-zoom-start-text"),this._endText=this._maybeAddLabel(this._getContainer(),(0,cQ.Z)({},b,{text:M,x:d.x,y:d.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:p}),"data-zoom-end-text")}_maybeAddLabel(t,e,i){let r=t.find(t=>t.name===i,!0);return r?r.setAttributes(e):((r=new kr.V(e)).name=i,t.add(r)),r}}var kk=i(30685),kT=i(10391),kR=i(70527);let kB={debounce:kT.Z,throttle:kR.Z};class kP extends tN(){constructor(t){super(),this._activeState=!1,this._activeCache={startPos:{x:0,y:0},lastPos:{x:0,y:0}},this._layoutCache={attPos:"x",attSize:"width",size:0},this._handleTouchMove=t=>{this._activeState&&t.preventDefault()},this._onHandlerPointerDown=(t,e)=>{this.clearDragEvents(),"start"===e?(this._activeTag=t_.startHandler,this._activeItem=this._startHandlerMask):"end"===e?(this._activeTag=t_.endHandler,this._activeItem=this._endHandlerMask):"middleRect"===e?(this._activeTag=t_.middleHandler,this._activeItem=this._middleHandlerRect):"middleSymbol"===e?(this._activeTag=t_.middleHandler,this._activeItem=this._middleHandlerSymbol):"background"===e&&(this._activeTag=t_.background,this._activeItem=this._background),this._activeState=!0,this._activeCache.startPos=this._eventPosToStagePos(t),this._activeCache.lastPos=this._eventPosToStagePos(t);let i="browser"===ea.rF.env?ea.rF:this.stage,r=(0,kk.G)();i.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.on("pointermove",this._onHandlerPointerMove,{capture:!0}),r.forEach(t=>{i.addEventListener(t,this._onHandlerPointerUp)})},this._pointerMove=t=>{let{brushSelect:e}=this.attribute,{position:i}=this._getLayoutAttrFromConfig(),r=this._eventPosToStagePos(t),{attPos:n,size:s,attSize:l}=this._layoutCache,a=(r[n]-this._activeCache.lastPos[n])/s,o=(r[n]-i[n])/this._getLayoutAttrFromConfig()[l],{start:h,end:u}=this._getState(),d=!0;this._activeState&&(this._activeTag===t_.middleHandler?{start:h,end:u}=this._moveZoomWithMiddle(a):this._activeTag===t_.startHandler?{start:h,end:u}=this._moveZoomWithHandler(o,"start"):this._activeTag===t_.endHandler?{start:h,end:u}=this._moveZoomWithHandler(o,"end"):this._activeTag===t_.background&&e&&({start:h,end:u}=this._moveZoomWithBackground(o),d=!1,this._dispatchEvent(tx.maskUpdate)),this._activeCache.lastPos=r),this._getState().start===h&&this._getState().end===u||(this._setStateAttr(h,u),this._dispatchEvent(tx.stateUpdate,{start:this._getState().start,end:this._getState().end,shouldRender:d,tag:this._activeTag}),this.attribute.realTime&&this._dispatchEvent(tx.dataZoomUpdate,{start:this._getState().start,end:this._getState().end,shouldRender:!0,tag:this._activeTag}))},this._onHandlerPointerUp=t=>{this._activeState&&this._activeTag===t_.background&&(this._setStateAttr(this._getState().start,this._getState().end),this._dispatchEvent(tx.stateUpdate,{start:this._getState().start,end:this._getState().end,shouldRender:!0,tag:this._activeTag})),this._activeState=!1,this._dispatchEvent(tx.dataZoomUpdate,{start:this._getState().start,end:this._getState().end,shouldRender:!0,tag:this._activeTag}),this.clearDragEvents()},this._initAttrs(t)}setAttributes(t){var e,i,r,n,s,l;this._initAttrs(t),this._onHandlerPointerMove=0===(null!=(i=null==(e=this.attribute)?void 0:e.delayTime)?i:0)?this._pointerMove:kB[null!=(n=null==(r=this.attribute)?void 0:r.delayType)?n:"debounce"](this._pointerMove,null!=(l=null==(s=this.attribute)?void 0:s.delayTime)?l:0)}_initAttrs(t){this.stage=t.stage,this.attribute=t.attribute,this._startHandlerMask=t.startHandlerMask,this._endHandlerMask=t.endHandlerMask,this._middleHandlerSymbol=t.middleHandlerSymbol,this._middleHandlerRect=t.middleHandlerRect,this._selectedBackground=t.selectedBackground,this._background=t.background,this._previewGroup=t.previewGroup,this._selectedPreviewGroup=t.selectedPreviewGroup,this._getLayoutAttrFromConfig=t.getLayoutAttrFromConfig,this._getState=t.getState,this._setState=t.setState;let{width:e,height:i}=this._getLayoutAttrFromConfig();this._spanCache=this._getState().end-this._getState().start;let r="top"===this.attribute.orient||"bottom"===this.attribute.orient;this._layoutCache.size=r?e:i,this._layoutCache.attPos=r?"x":"y",this._layoutCache.attSize=r?"width":"height",this._getGlobalTransMatrix=t.getGlobalTransMatrix}clearDragEvents(){let t="browser"===ea.rF.env?ea.rF:this.stage,e=(0,kk.G)();t.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),e.forEach(e=>{t.removeEventListener(e,this._onHandlerPointerUp)}),this.off("pointermove",this._onHandlerPointerMove,{capture:!0})}clearVGlobalEvents(){("browser"===ea.rF.env?ea.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}bindEvents(){var t,e,i,r,n,s,l,a;let{brushSelect:o}=this.attribute;null==(t=this._startHandlerMask)||t.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"start")),null==(e=this._endHandlerMask)||e.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"end")),null==(i=this._middleHandlerSymbol)||i.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"middleSymbol")),null==(r=this._middleHandlerRect)||r.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"middleRect"));let h=o?"background":"middleRect";null==(n=this._selectedBackground)||n.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,h)),o&&(null==(s=this._background)||s.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"background"))),o&&(null==(l=this._previewGroup)||l.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"background"))),null==(a=this._selectedPreviewGroup)||a.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,h)),("browser"===ea.rF.env?ea.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}_setStateAttr(t,e){let{zoomLock:i=!1,minSpan:r=0,maxSpan:n=1}=this.attribute,s=e-t;s!==this._spanCache&&(i||s<r||s>n)||(this._spanCache=s,this._setState({start:t,end:e}))}_moveZoomWithMiddle(t){let{start:e,end:i}=this._getState();return t>0&&i+t>1?t=1-i:t<0&&e+t<0&&(t=-e),{start:(0,uI.Z)(e+t,0,1),end:(0,uI.Z)(i+t,0,1)}}_moveZoomWithHandler(t,e){let{start:i,end:r}=this._getState(),n=i,s=r;return"start"===e?t>r?(n=r,s=t,this._activeTag=t_.endHandler):n=t:"end"===e&&(t<i?(s=i,n=t,this._activeTag=t_.startHandler):s=t),{start:(0,uI.Z)(n,0,1),end:(0,uI.Z)(s,0,1)}}_moveZoomWithBackground(t){let{position:e}=this._getLayoutAttrFromConfig(),{attSize:i}=this._layoutCache,r=(this._activeCache.startPos[this._layoutCache.attPos]-e[this._layoutCache.attPos])/this._getLayoutAttrFromConfig()[i],n=(0,uI.Z)(r,0,1),s=(0,uI.Z)(t,0,1);return n>s&&([n,s]=[s,n]),{start:n,end:s}}_eventPosToStagePos(t){var e,i;let r={x:0,y:0},n=null!=(i=null==(e=this.stage)?void 0:e.eventPointTransform(t))?i:{x:0,y:0};return this._getGlobalTransMatrix().transformPoint(n,r),r}_dispatchEvent(t,e){this.emit(t,e)}}var kE=i(34160);(0,kE.b)(),(0,m6.k)(),(0,pj.k)(),mW(),(0,cJ.N)();class kI extends g3.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},kI.defaultAttributes,t)),this.name="dataZoom",this._state={start:0,end:1},this.getLayoutAttrFromConfig=()=>{var t,e,i,r,n,s;let l,a,o;if(this._layoutCacheFromConfig)return this._layoutCacheFromConfig;let{position:h,size:u,orient:d,middleHandlerStyle:c={},startHandlerStyle:p={},endHandlerStyle:g={},backgroundStyle:f={}}=this.attribute,{width:m,height:y}=u,v=null!=(e=null==(t=c.background)?void 0:t.size)?e:10;c.visible?this._isHorizontal?(l=m,a=y-v,o={x:h.x,y:h.y+v}):(l=m-v,a=y,o={x:h.x+("left"===d?v:0),y:h.y}):(l=m,a=y,o=h);let b=null!=(i=p.size)?i:this._isHorizontal?a:l,_=null!=(r=g.size)?r:this._isHorizontal?a:l;return p.visible&&(this._isHorizontal?(l-=(b+_)/2,o={x:o.x+b/2,y:o.y}):(a-=(b+_)/2,o={x:o.x,y:o.y+b/2})),a+=(null!=(n=f.lineWidth)?n:2)/2,l+=(null!=(s=f.lineWidth)?s:2)/2,this._layoutCacheFromConfig={position:o,width:l,height:a},this._layoutCacheFromConfig};let{start:i,end:r,orient:n}=this.attribute;this._isHorizontal="top"===n||"bottom"===n,i&&(this._state.start=i),r&&(this._state.end=r),this._renderer=new kM(this._getRendererAttrs()),this._interaction=new kP(this._getInteractionAttrs())}_getRendererAttrs(){return{attribute:this.attribute,getLayoutAttrFromConfig:this.getLayoutAttrFromConfig,setState:t=>{this._state=t},getState:()=>this._state,getContainer:()=>this._container}}_getInteractionAttrs(){return{stage:this.stage,attribute:this.attribute,startHandlerMask:this._renderer.startHandlerMask,endHandlerMask:this._renderer.endHandlerMask,middleHandlerSymbol:this._renderer.middleHandlerSymbol,middleHandlerRect:this._renderer.middleHandlerRect,selectedBackground:this._renderer.selectedBackground,background:this._renderer.background,previewGroup:this._renderer.previewGroup,selectedPreviewGroup:this._renderer.selectedPreviewGroup,getLayoutAttrFromConfig:this.getLayoutAttrFromConfig,setState:t=>{this._state=t},getState:()=>this._state,getGlobalTransMatrix:()=>this.globalTransMatrix}}bindEvents(){this.attribute.disableTriggerEvent?this.setAttribute("childrenPickable",!1):(this._interaction.bindEvents(),this._interaction.on(tx.stateUpdate,({shouldRender:t})=>{t&&this._renderer.renderDataZoom(!0)}),this._interaction.on(tx.dataZoomUpdate,({start:t,end:e,tag:i})=>{this._dispatchEvent(tC.dataZoomChange,{start:t,end:e,tag:i})}),this._interaction.on(tx.maskUpdate,()=>{this._renderer.renderDragMask()}),"auto"===this.attribute.showDetail&&(this._container.addEventListener("pointerenter",()=>{this._renderer.showText=!0,this._renderer.renderText()}),this._container.addEventListener("pointerleave",()=>{this._renderer.showText=!1,this._renderer.renderText()})))}setAttributes(t,e){let{start:i,end:r}=this.attribute;i&&(this._state.start=i),r&&(this._state.end=r),this._renderer.setAttributes(this._getRendererAttrs()),this._interaction.setAttributes(this._getInteractionAttrs()),super.setAttributes(t,e)}render(){this._layoutCacheFromConfig=null,this._container=this.createOrUpdateChild("datazoom-container",{},"group"),this._renderer.renderDataZoom(),this._interaction.setAttributes(this._getInteractionAttrs())}release(t){super.release(t),this._interaction.clearDragEvents()}setStartAndEnd(t,e){let{start:i,end:r}=this._state;(0,c2.Z)(t)&&(0,c2.Z)(e)&&(t!==i||e!==r)&&(this._state={start:t,end:e},this._renderer.renderDataZoom(!0),this._dispatchEvent(tC.dataZoomChange,{start:t,end:e}))}setPreviewData(t){this._renderer.previewData=t}setText(t,e){"start"===e?this._renderer.startText.setAttribute("text",t):this._renderer.endText.setAttribute("text",t)}getStartValue(){return this._renderer.startValue}getEndTextValue(){return this._renderer.endValue}getMiddleHandlerSize(){var t,e,i,r;let{middleHandlerStyle:n={}}=this.attribute,s=null!=(e=null==(t=n.background)?void 0:t.size)?e:10,l=null!=(r=null==(i=n.icon)?void 0:i.size)?r:10;return Math.max(s,...(0,kx.IX)(l))}setPreviewPointsX(t){(0,uy.Z)(t)&&(this._renderer.previewPointsX=t)}setPreviewPointsY(t){(0,uy.Z)(t)&&(this._renderer.previewPointsY=t)}setPreviewPointsX1(t){(0,uy.Z)(t)&&(this._renderer.previewPointsX1=t)}setPreviewPointsY1(t){(0,uy.Z)(t)&&(this._renderer.previewPointsY1=t)}setStatePointToData(t){(0,uy.Z)(t)&&(this._renderer.statePointToData=t)}}kI.defaultAttributes={orient:"bottom",showDetail:"auto",brushSelect:!0,zoomLock:!1,minSpan:0,maxSpan:1,delayType:"throttle",delayTime:0,realTime:!0,backgroundStyle:{fill:"white",stroke:"#D1DBEE",lineWidth:1,cornerRadius:2},dragMaskStyle:{fill:"#B0C8F9",fillOpacity:.2},backgroundChartStyle:{area:{visible:!0,stroke:"#D1DBEE",lineWidth:1,fill:"#F6F8FC"},line:{visible:!0,stroke:"#D1DBEE",lineWidth:1}},selectedBackgroundStyle:{fill:"#B0C8F9",fillOpacity:.5},selectedBackgroundChartStyle:{area:{visible:!0,stroke:"#B0C8F9",lineWidth:1,fill:"#fbb934"},line:{visible:!0,stroke:"#fbb934",lineWidth:1}},middleHandlerStyle:{visible:!0,background:{size:8,style:{fill:"white",stroke:"#B0C8F9",cornerRadius:2}},icon:{size:6,fill:"white",stroke:"#B0C8F9",symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}},startHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:kC,fill:"white",stroke:"#B0C8F9",lineWidth:.5},endHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:kC,fill:"white",stroke:"#B0C8F9",lineWidth:.5},startTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}},endTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}}};class kL extends gD{_mergeThemeToSpec(t,e){let i=this._theme,r=t;if(this._shouldMergeThemeToSpec()){let e=t=>{let e=ir({selectedBackgroundChart:{line:{},area:{}}},this._theme,t),{selectedBackgroundChart:i={}}=t,{line:r,area:n}=i;return r&&!1!==r.visible&&(e.selectedBackgroundChart.line.style=Object.assign(Object.assign({},e.selectedBackgroundChart.line.style),{visible:!0})),n&&!1!==n.visible&&(e.selectedBackgroundChart.area.style=Object.assign(Object.assign({},e.selectedBackgroundChart.area.style),{visible:!0})),e};r=tq(t)?t.map(t=>e(t)):e(t)}return this._adjustPadding(r),{spec:r,theme:i}}}let kF=()=>({style:{symbolType:"M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}}),kO=t=>({area:{style:{visible:t,stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{visible:t,stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}}),kD={padding:[12,0],showDetail:"auto",brushSelect:!1,middleHandler:{visible:!1,background:{size:6,style:{stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},cornerRadius:2}},icon:{style:{size:4,fill:{type:"palette",key:"sliderHandleColor"},stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}}},background:{size:20,style:{fill:{type:"palette",key:"sliderRailColor"},lineWidth:0}},selectedBackground:{style:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.1,outerBorder:{stroke:{type:"palette",key:"sliderTrackColor"},strokeOpacity:.2,distance:-.5,lineWidth:1}}},selectedBackgroundChart:kO(!1),startHandler:kF(),endHandler:kF(),startText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},endText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},backgroundChart:kO(!0)};class kH extends k_{constructor(t,e){var i;super(t,e),this.type=rk.dataZoom,this.name=rk.dataZoom,this.transformerConstructor=kL,this.specKey="dataZoom",this.layoutZIndex=H.DataZoom,this.layoutLevel=z.DataZoom,this.layoutType="region-relative",this._isReverseCache=!1,this._dataToPositionX=t=>{let e="left"===this._orient?this._middleHandlerSize:0,i=this._isHorizontal?this._startHandlerSize/2:0,r=this._isHorizontal?this._stateScale:this._valueScale,n=this._isHorizontal?this._stateField:this._valueField;return r.scale(t[n])+this.getLayoutStartPoint().x+e+i},this._dataToPositionX2=t=>{let e="left"===this._orient?this._middleHandlerSize:0,i=this._isHorizontal?this._startHandlerSize/2:0,r=this._isHorizontal?this._stateScale:this._valueScale,n=r.domain()[0];return r.scale(n)+this.getLayoutStartPoint().x+e+i},this._dataToPositionY=t=>{let e=this._isHorizontal?this._middleHandlerSize:0,i=this._isHorizontal?0:this._startHandlerSize/2,r=this._isHorizontal?this._valueScale:this._stateScale,n=this._isHorizontal?this._valueField:this._stateField;return r.scale(t[n])+this.getLayoutStartPoint().y+e+i},this._dataToPositionY2=t=>{let e=this._isHorizontal?this._middleHandlerSize:0,i=this._isHorizontal?0:this._startHandlerSize/2,r=this._isHorizontal?this._valueScale:this._stateScale,n=r.domain()[0];return r.scale(n)+this.getLayoutStartPoint().y+e+i},this._valueField="y",this._filterMode=null!=(i=t.filterMode)?i:"filter"}created(){super.created(),this._initValueScale()}setAttrFromSpec(){var t,e,i,r,n,s,l,a,o,h;super.setAttrFromSpec(),tX(this._spec.roam)&&(this._zoomAttr.enable=this._spec.roam,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode),this._backgroundSize=null!=(e=null==(t=this._spec.background)?void 0:t.size)?e:30,this._middleHandlerSize=this._computeMiddleHandlerSize(),this._width=this._computeWidth(),this._height=this._computeHeight(),er(null==(n=null==(r=null==(i=this._spec)?void 0:i.startHandler)?void 0:r.style)?void 0:n.size)&&(this._spec.startHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize),er(null==(a=null==(l=null==(s=this._spec)?void 0:s.endHandler)?void 0:l.style)?void 0:a.size)&&(this._spec.endHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize);let u=null==(o=this._spec.startHandler.style.visible)||o,d=null==(h=this._spec.endHandler.style.visible)||h;this._startHandlerSize=u?this._spec.startHandler.style.size:0,this._endHandlerSize=d?this._spec.endHandler.style.size:0}onLayoutEnd(){this._updateScaleRange(),this._isReverse()&&!this._isReverseCache&&(this._isReverseCache=this._isReverse(),this.effect.onZoomChange()),!1!==this._cacheVisibility&&super.onLayoutEnd()}_initValueScale(){let t=this._computeDomainOfValueScale();if(t){let e=new l4;e.domain(t),this._valueScale=e}}_updateScaleRange(){var t,e;let i,r=this._startHandlerSize+this._endHandlerSize;if(!this._stateScale||!this._valueScale)return;let n=this._isHorizontal?this.getLayoutRect().width-r:this.getLayoutRect().height-r,s=null!=(e=null==(t=this._relatedAxisComponent)?void 0:t.getScale().range())?e:[this._startHandlerSize/2,n+this._startHandlerSize/2],l=this._computeWidth(),a=this._computeHeight();this._isHorizontal?(i=this._visible?[this._startHandlerSize/2,l-r+this._startHandlerSize/2]:s,this._stateScale.range(i),this._valueScale.range([a-this._middleHandlerSize,0])):(i=this._visible?[this._startHandlerSize/2,a-r+this._startHandlerSize/2]:s,this._stateScale.range(i),"left"===this.layoutOrient?this._valueScale.range([l-this._middleHandlerSize,0]):this._valueScale.range([0,l-this._middleHandlerSize])),this._component&&!1!==this._cacheVisibility&&this._component.setAttributes({size:{width:l,height:a},position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y}})}_computeDomainOfValueScale(){let t=this._data.getLatestData().map(t=>t[this._valueField]),e=t.map(t=>+t);return t.length?[eg(e),ep(e)]:null}_computeMiddleHandlerSize(){var t,e,i,r;let n=0;return(null==(e=null==(t=this._spec)?void 0:t.middleHandler)?void 0:e.visible)&&(n+=Math.max(null!=(i=this._spec.middleHandler.icon.style.size)?i:8,null!=(r=this._spec.middleHandler.background.size)?r:40)),n}_computeWidth(){return!1===this._visible?0:tG(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:this._backgroundSize+this._middleHandlerSize}_computeHeight(){return!1===this._visible?0:tG(this._spec.height)?this._spec.height:this._isHorizontal?this._backgroundSize+this._middleHandlerSize:this.getLayoutRect().height}_isScaleValid(t){if(!t||!t.domain())return!1;let e=t.domain();return(!ls(t.type)||e[0]!==ec(e))&&(!ll(t.type)||1!==(e&&tq(e)?Array.from(new Set(ed(e))):e).length)}_getAttrs(t){var e,i,r,n,s;let l=null!=(e=this._spec)?e:{};return Object.assign({zIndex:this.layoutZIndex,start:this._start,end:this._end,position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},orient:this._orient,size:{width:this._computeWidth(),height:this._computeHeight()},showDetail:l.showDetail,brushSelect:null!=(i=l.brushSelect)&&i,zoomLock:null!=(r=l.zoomLock)&&r,minSpan:this._minSpan,maxSpan:this._maxSpan,delayType:l.delayType,delayTime:t8(l.delayType)?null!=(n=l.delayTime)?n:30:0,realTime:null==(s=l.realTime)||s,previewData:t&&this._data.getLatestData(),previewPointsX:t&&this._dataToPositionX,previewPointsY:t&&this._dataToPositionY,tolerance:this._spec.tolerance},this._getComponentAttrs(t))}_createOrUpdateComponent(){if(this._visible){let t=this._isHorizontal?this._stateScale:this._valueScale,e=this._isHorizontal?this._valueScale:this._stateScale,i=this._isScaleValid(t)&&this._isScaleValid(e)&&!1!==this._spec.showBackgroundChart,r=this._getAttrs(i);if(this._component)this._component.setAttributes(r);else{let t=this.getContainer();this._component=new kI(r),this._isHorizontal?i&&this._component.setPreviewPointsY1(this._dataToPositionY2):i&&this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData(t=>this.statePointToData(t)),this._component.addEventListener("change",t=>{let{start:e,end:i,tag:r}=t.detail;this._handleChange(e,i,void 0,r)}),t.add(this._component),this._updateScaleRange()}}}_handleChange(t,e,i,r){if(super._handleChange(t,e,i),this._shouldChange){i&&this._component&&this._component.setStartAndEnd(t,e),this._start=t,this._end=e;let n=this.statePointToData(t),s=this.statePointToData(e);(tQ(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(t,e,n,s):this._handleStateChange(n,s,r))&&this.event.emit(rI.dataZoomChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:t,end:e,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){var t;let e=this._data.getDataView();if(e.reRunAllTransform(),null==(t=this._component)||t.setPreviewData(e.latestData),this._valueScale){let t=this._computeDomainOfValueScale();t&&this._valueScale.domain(t)}}_getComponentAttrs(t){var e,i,r,n,s,l,a,o,h,u,d;let{middleHandler:c={},startText:p={},endText:g={},backgroundChart:f={},selectedBackgroundChart:m={}}=this._spec;return{backgroundStyle:gd(null==(e=this._spec.background)?void 0:e.style),startHandlerStyle:gd(null==(i=this._spec.startHandler)?void 0:i.style),middleHandlerStyle:c.visible?{visible:!0,icon:gd(null==(r=c.icon)?void 0:r.style),background:{size:null==(n=c.background)?void 0:n.size,style:gd(null==(s=c.background)?void 0:s.style)}}:{visible:!1},endHandlerStyle:gd(null==(l=this._spec.endHandler)?void 0:l.style),startTextStyle:{padding:p.padding,formatMethod:this._getHandlerTextFormatMethod(p),textStyle:gd(p.style)},endTextStyle:{padding:g.padding,formatMethod:this._getHandlerTextFormatMethod(g),textStyle:gd(g.style)},selectedBackgroundStyle:gd(this._spec.selectedBackground.style),dragMaskStyle:gd(null==(a=this._spec.dragMask)?void 0:a.style),backgroundChartStyle:t?{line:ir(gd(null==(o=f.line)?void 0:o.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},gd(null==(h=f.area)?void 0:h.style))}:{line:{visible:!1},area:{visible:!1}},selectedBackgroundChartStyle:t?{line:ir(gd(null==(u=m.line)?void 0:u.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},gd(null==(d=m.area)?void 0:d.style))}:{line:{visible:!1},area:{visible:!1}},disableTriggerEvent:this._option.disableTriggerEvent}}_getHandlerTextFormatMethod(t){let{formatMethod:e,formatter:i}=t,{formatFunc:r}=d4(e,i);return r?t=>r(t,{label:t},i):void 0}_getNeedClearVRenderComponents(){return[this._component]}clear(){if(this._component){let t=this.getContainer();this._component.removeAllChild(),t&&t.removeChild(this._component),this._component=null}super.clear()}}kH.type=rk.dataZoom,kH.transformerConstructor=kL,kH.builtInTheme={dataZoom:kD},kH.specKey="dataZoom";let kz=()=>{iv.registerComponent(kH.type,kH)};class kW extends k_{constructor(t,e){var i;super(t,e),this.type=rk.scrollBar,this.name=rk.scrollBar,this.specKey="scrollBar",this.layoutZIndex=H.DataZoom,this.layoutLevel=z.DataZoom,this.layoutType="region-relative",this._filterMode=null!=(i=t.filterMode)?i:"axis"}setAttrFromSpec(){super.setAttrFromSpec(),tX(this._spec.roam)&&(this._zoomAttr.enable=!1,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode)}onLayoutEnd(){var t,e;this._updateScaleRange(),null==(e=(t=this.effect).onZoomChange)||e.call(t),super.onLayoutEnd()}_updateScaleRange(){this._component&&this._component.setAttributes({x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height})}_computeWidth(){return tG(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:12}_computeHeight(){return tG(this._spec.height)?this._spec.height:this._isHorizontal?12:this.getLayoutRect().height}_getAttrs(){var t,e,i,r,n,s;return Object.assign({zIndex:this.layoutZIndex,x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height,range:[this._start,this._end],direction:this._isHorizontal?"horizontal":"vertical",delayType:null==(t=this._spec)?void 0:t.delayType,delayTime:t8(null==(e=this._spec)?void 0:e.delayType)?null!=(r=null==(i=this._spec)?void 0:i.delayTime)?r:30:0,realTime:null==(s=null==(n=this._spec)?void 0:n.realTime)||s},this._getComponentAttrs())}_createOrUpdateComponent(){let t=this._getAttrs();if(this._component)this._component.setAttributes(t);else{let e=this.getContainer();this._component=new AN.B(t),this._component.addEventListener("scrollDrag",t=>{let e=t.detail.value;this._handleChange(e[0],e[1])}),this._component.addEventListener("scrollUp",t=>{let e=t.detail.value;this._handleChange(e[0],e[1])}),e.add(this._component)}}_handleChange(t,e,i){super._handleChange(t,e,i);let r=l6(this._start,t)&&l6(this._end,e);if(this._shouldChange&&(!r||!1===this._spec.realTime)){i&&this._component&&this._component.setAttribute("range",[t,e]),this._start=t,this._end=e;let r=this.statePointToData(t),n=this.statePointToData(e);(tQ(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(t,e,r,n):this._handleStateChange(this.statePointToData(t),this.statePointToData(e)))&&this.event.emit(rI.scrollBarChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:this._start,end:this._end,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){this._spec.auto&&this._data.getDataView().reRunAllTransform()}_getComponentAttrs(){let{rail:t,slider:e,innerPadding:i}=this._spec,r={};return er(i)||(r.padding=i),sD(null==t?void 0:t.style)||(r.railStyle=gd(t.style)),sD(null==e?void 0:e.style)||(r.sliderStyle=gd(e.style)),r.disableTriggerEvent=this._option.disableTriggerEvent,r}_getNeedClearVRenderComponents(){return[this._component]}}kW.type=rk.scrollBar,kW.builtInTheme={scrollBar:{horizontal:{height:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}},vertical:{width:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}}}},kW.specKey="scrollBar";let kN=()=>{iv.registerComponent(kW.type,kW)},kj=(t,e)=>{let{datum:i,title:r,content:n}=e,s=[],l=i.call(null);return r.visible&&s.push({type:"title",index:0,datum:l,spec:r}),ed(n).forEach((t,e)=>{t.visible&&s.push({type:"content",index:e,datum:l,spec:t})}),s},kG={title:{style:{text:"",fontSize:20,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{style:{text:"",fontSize:16,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}};(0,op.M)(),(0,py.g)(),(0,pv.v)();class kV extends g3.k{constructor(){super(...arguments),this.name="indicator"}_renderText(t,e,i,r,n,s){if(!1!==e.visible){let l=(0,cQ.Z)({},(0,bD.Z)(kG,n),e.style,{visible:e.visible});l.lineHeight=(0,c2.Z)(l.lineHeight)?l.lineHeight:l.fontSize,e.formatMethod&&(l._originText=l.text,l.text=e.formatMethod(l.text,l));let a=(0,om.vS)(l);return a.name=s,t.appendChild(a),e.autoFit&&(0,uE.Z)(i)&&this._setLocalAutoFit(i,a,e),e.autoLimit&&(0,uE.Z)(r)&&a.setAttribute("maxLineWidth",i),a}}render(){var t,e;if(this.removeAllChild(!0),!0!==this.attribute.visible)return;let{title:i={},content:r,size:n,limitRatio:s=1/0}=this.attribute,l=Math.min(n.width,n.height)*s,a=this.createOrUpdateChild("indicator-container",{x:0,y:0,zIndex:1,pickable:null==(t=this.attribute.pickable)||t},"group");if((0,c2.Z)(i)&&(this._title=this._renderText(a,i,l,s,"title.style","indicator-title")),(0,c2.Z)(r)){let t=(0,kx.IX)(r),e=[];t.forEach((t,i)=>{!1!==t.visible&&e.push(this._renderText(a,t,l,s,"content.style","indicator-content-"+i))}),this._content=e}this._setGlobalAutoFit(l),this._setYPosition();let o=null!=(e=null==a?void 0:a.AABBBounds.height())?e:0;a.setAttribute("y",n.height/2-o/2),a.setAttribute("x",n.width/2)}_setLocalAutoFit(t,e,i){var r,n,s,l,a,o,h,u,d;if("default"!==(null!=(r=i.fitStrategy)?r:"default"))return;let c=(0,om.fe)(null!=(s=null==(n=i.style)?void 0:n.text)?s:"",null!=(l=i.style)?l:{},null==(o=null==(a=this.stage)?void 0:a.getTheme())?void 0:o.text).width;if(c>0){let r=t*(null!=(h=i.fitPercent)?h:.5)/c,n=Math.floor((null!=(d=null==(u=i.style)?void 0:u.fontSize)?d:20)*r);e.setAttribute("fontSize",n),e.setAttribute("lineHeight",(0,c2.Z)(i.style.lineHeight)?i.style.lineHeight:n)}}_setGlobalAutoFit(t){var e,i,r,n,s,l,a;let o=[],h=0,u=null!=(e=this.attribute.title)?e:{};u.autoFit&&"inscribed"===u.fitStrategy?(this._title.setAttribute("fontSize",12),o.push({text:this._title,spec:null!=(i=this.attribute.title)?i:{}})):h+=null!=(l=null==(s=null==(n=null==(r=this._title)?void 0:r.AABBBounds)?void 0:n.height)?void 0:s.call(n))?l:0;let d=null!=(a=u.space)?a:0;if(h+=d,(0,kx.IX)(this.attribute.content).filter(t=>!1!==t.visible).forEach((t,e)=>{var i,r,n,s;let l=this._content[e];t.autoFit&&"inscribed"===t.fitStrategy?(l.setAttribute("fontSize",12),o.push({text:l,spec:t})):h+=null!=(n=null==(r=null==(i=null==l?void 0:l.AABBBounds)?void 0:i.height)?void 0:r.call(i))?n:0;let a=null!=(s=t.space)?s:0;h+=a}),o.length<=0)return;let c=12/o.reduce((t,e)=>Math.max(t,e.text.AABBBounds.width()),0)*o.length,p=h/2,g=c**2+1,f=2*p*c,m=2*(c*((-f+Math.sqrt(f**2-4*g*(p**2-(t/2)**2)))/(2*g))+p),y=(m-h)/o.length;(0,uE.Z)(m)&&o.forEach(t=>{var e;let i=null==(e=t.spec.style)?void 0:e.lineHeight;t.text.setAttribute("fontSize",y),t.text.setAttribute("lineHeight",(0,c2.Z)(i)?i:y)})}_setYPosition(){var t,e,i,r,n,s;let l=0,a=null!=(r=null==(i=null==(e=null==(t=this._title)?void 0:t.AABBBounds)?void 0:e.height)?void 0:i.call(e))?r:0,o=null!=(s=null==(n=this.attribute.title)?void 0:n.space)?s:0;(0,kx.IX)(this.attribute.content).filter(t=>!1!==t.visible).forEach((t,e)=>{var i;let r=this._content[e];r.setAttribute("y",a+o+l);let n=null!=(i=t.space)?i:0;l+=r.AABBBounds.height()+n})}}let kZ=(t,e)=>({fontSize:{type:"token",key:t},fill:{type:"palette",key:e},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}),kU={title:{visible:!0,autoLimit:!1,autoFit:!1,style:kZ("l1FontSize","primaryFontColor")},content:{visible:!0,style:kZ("l2FontSize","tertiaryFontColor")}};var kK=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class k$ extends gz{constructor(){super(...arguments),this.type=rk.indicator,this.name=rk.indicator,this.specKey="indicator",this.layoutType="none",this.layoutZIndex=H.Indicator,this.layoutLevel=z.Indicator,this._gap=0,this._activeDatum=null}static getSpecInfo(t){return d6(t,this.specKey,this.type,t=>t&&!1!==t.visible)}created(){super.created(),this.initData(),this.initEvent()}setAttrFromSpec(){super.setAttrFromSpec(),this._gap=this._spec.gap||0,this._title=this._spec.title,this._content=ed(this._spec.content),this._regions=this._option.getRegionsInUserIdOrIndex(ed(this._spec.regionId),ed(this._spec.regionIndex))}initEvent(){this._option.disableTriggerEvent||"none"!==this._spec.trigger&&("hover"===this._spec.trigger?(this.event.on("element-highlight:start",t=>{let e=t.graphics[0];this.isRelativeModel(e)&&this.updateDatum(iZ(e))}),this.event.on("element-highlight:reset",t=>{this._activeDatum&&this.updateDatum(null)})):(this.event.on("element-select:start",t=>{let e=t.graphics[0];this.isRelativeModel(e)&&this.updateDatum(iZ(e))}),this.event.on("element-select:reset",t=>{this._activeDatum&&this.updateDatum(null)})))}updateDatum(t){this._activeDatum=t,this._displayData.updateData();let e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e)}initData(){nq(this._option.dataSet,"indicatorFilter",kj);let t=new el(this._option.dataSet,{name:`${this.type}_${this.id}_data`});t.transform({type:"indicatorFilter",options:{title:this._title,content:this._content,datum:()=>this._activeDatum}}),t.target.addListener("change",this.updateDatum.bind(this)),this._displayData=new aC(this._option,t)}updateLayoutAttribute(){let t=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(t),super.updateLayoutAttribute()}_getIndicatorAttrs(){if(!1===this._spec.visible||!1===this._spec.fixed&&null===this._activeDatum)return{visible:!1};let t=this._regions[0],{width:e,height:i}=t.getLayoutRect(),{x:r,y:n}=t.getLayoutStartPoint(),s=this._spec,{content:l,offsetX:a,offsetY:o,limitRatio:h,title:u}=s,d=kK(s,["content","offsetX","offsetY","limitRatio","title"]),c=[];return ed(l).forEach(t=>{let e=ir({},this._theme.content,t);c.push({visible:!1!==e.visible&&(!e.field||null!==this._activeDatum),space:e.space||this._gap,autoLimit:e.autoLimit,autoFit:e.autoFit,fitPercent:e.fitPercent,fitStrategy:e.fitStrategy,style:Object.assign(Object.assign({},gu(gW(e.style,["text"]),this._activeDatum)),{text:this._createText(e.field,e.style.text)})})}),Object.assign({visible:!0,size:{width:e,height:i},zIndex:this.layoutZIndex,x:r,y:n,dx:a?eR(a,this._computeLayoutRadius()):0,dy:o?eR(o,this._computeLayoutRadius()):0,limitRatio:h||1/0,title:{visible:!1!==u.visible&&(!t8(u.field)||null!==this._activeDatum),space:u.space||this._gap,autoLimit:u.autoLimit,autoFit:u.autoFit,fitPercent:u.fitPercent,fitStrategy:u.fitStrategy,style:Object.assign(Object.assign({},gu(gW(u.style,["text"]),this._activeDatum)),{text:this._createText(u.field,u.style.text)})},content:c},d)}_createOrUpdateIndicatorComponent(t){if(!1===t.visible)return this._indicatorComponent&&this._indicatorComponent.parent&&this._indicatorComponent.parent.removeChild(this._indicatorComponent),void(this._indicatorComponent=null);if(this._indicatorComponent)t5(t,this._cacheAttrs)||this._indicatorComponent.setAttributes(t);else{let e=this.getContainer(),i=new kV(t);i.name="indicator",e.add(i),this._indicatorComponent=i,this._indicatorComponent.on("*",(t,e)=>this._delegateEvent(this._indicatorComponent,t,e))}this._cacheAttrs=t}_createText(t,e){var i;return t?this._activeDatum?this._activeDatum[t]:"":tQ(e)?null!=(i=e(this._activeDatum,void 0))?i:"":null!=e?e:""}_computeLayoutRadius(){let{width:t,height:e}=this._regions[0].getLayoutRect();return Math.min(t/2,e/2)}isRelativeModel(t){return this._regions.some(e=>!!e.getSeriesInId(t.context.modelId))}_getNeedClearVRenderComponents(){return[this._indicatorComponent]}clear(){this._cacheAttrs=null,super.clear()}getIndicatorComponent(){return this._indicatorComponent}}k$.type=rk.indicator,k$.builtInTheme={indicator:kU},k$.specKey="indicator";let kY=()=>{iv.registerComponent(k$.type,k$)},kX=["sum","average","min","max","variance","standardDeviation","median"];var kq=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};function kJ(t,e,i){if(!i)return!1;let r=t.map(t=>+t),n=eg(r),s=ep(r);return e<n||e>s}function kQ(t,e,i,r,n,s){var l,a;let{relativeSeries:o}=r;return tG(t.x)&&kJ(e,t.x,i)&&(null==(a=null==o?void 0:(l=o.getXAxisHelper()).setExtendDomain)||a.call(l,"marker_xAxis_extend",t.x)),eC(t.x)?k3(t.x,n)+s.x:k5(o.getXAxisHelper(),[t.x])+s.x}function k0(t,e,i,r,n,s){var l,a;let{relativeSeries:o}=r;return tG(t.y)&&kJ(e,t.y,i)&&(null==(a=null==(l=o.getYAxisHelper())?void 0:l.setExtendDomain)||a.call(l,"marker_yAxis_extend",t.y)),eC(t.y)?k3(t.y,n)+s.y:k5(o.getYAxisHelper(),[t.y])+s.y}function k1(t,e,i,r){var n,s;let{relativeSeries:l}=r;return tG(t.angle)&&kJ(e,t.angle,i)&&(null==(s=null==(n=l.angleAxisHelper)?void 0:n.setExtendDomain)||s.call(n,"marker_angleAxis_extend",t.angle)),k5(l.angleAxisHelper,[t.angle])}function k2(t,e,i,r){var n,s;let{relativeSeries:l}=r;return tG(t.radius)&&kJ(e,t.radius,i)&&(null==(s=null==(n=l.radiusAxisHelper)?void 0:n.setExtendDomain)||s.call(n,"marker_radiusAxis_extend",t.radius)),k5(l.radiusAxisHelper,[t.radius])}function k3(t,e){return Number(t.substring(0,t.length-1))*e/100}function k5(t,e){let i=t.getScale(0);return ls(i.type)&&i.domain()[0]===i.domain()[1]&&e[0]!==i.domain()[0]?NaN:t.dataToPosition(e)}function k4(t){return kX.includes(t)}function k6(t,e,i,r,n,s=!1){let l=e.getRegion(),a=l.getLayoutStartPoint(),o=i.getRegion(),h=o.getLayoutStartPoint(),u=Math.abs(Math.min(a.x,h.x)-Math.max(a.x+l.getLayoutRect().width,h.x+o.getLayoutRect().width)),d=Math.abs(Math.min(a.y,h.y)-Math.max(a.y+l.getLayoutRect().height,h.y+o.getLayoutRect().height)),c={relativeSeries:r,startRelativeSeries:e,endRelativeSeries:i},p=[],g=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,f=r.getXAxisHelper(),m=r.getXAxisHelper(),y=f.getScale(0).domain(),v=m.getScale(0).domain(),b=s&&!f.isContinuous&&!!f.getBandwidth,_=s&&!m.isContinuous&&!!m.getBandwidth,x={min:null,max:null},C={min:null,max:null};return g.forEach(t=>{let e,i,r=t8(t.x),s=t8(t.y);if(r&&s)e=kQ(t,y,n,c,u,a),i=k0(t,v,n,c,d,a),k8(e,b,x,p.length),k8(i,_,C,p.length),p.push([{x:e,y:i}]);else if(r){e=kQ(t,y,n,c,u,a),i=Math.max(a.y+l.getLayoutRect().height,h.y+o.getLayoutRect().height);let r=Math.min(a.y,h.y);k8(e,b,x,p.length),p.push([{x:e,y:i},{x:e,y:r}])}else if(s){e=Math.min(a.x,h.x),i=k0(t,v,n,c,d,a);let r=Math.max(a.x+l.getLayoutRect().width,h.x+o.getLayoutRect().width);k8(i,_,C,p.length),p.push([{x:e,y:i},{x:r,y:i}])}}),function(t,e,i,r,n){if(r.min||r.max){let i=e.getBandwidth(0)*(1+e.getScale(0).paddingInner());r.min&&t[r.min.index].forEach(t=>t.x-=i/2),r.max&&t[r.max.index].forEach(t=>t.x+=i/2)}if(n.min||n.max){let e=i.getBandwidth(0)*(1+i.getScale(0).paddingInner());n.min&&t[n.min.index].forEach(t=>t.y-=e/2),n.max&&t[n.max.index].forEach(t=>t.y+=e/2)}}(p,f,m,x,C),p}function k8(t,e,i,r){return e&&((null===i.min||i.min.value>t)&&(i.min={value:t,index:r}),(null===i.max||i.max.value<t)&&(i.max={value:t,index:r})),t}function k9(t,e,i,r,n){let s={relativeSeries:r,startRelativeSeries:e,endRelativeSeries:i},l=[],a=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,o=r.angleAxisHelper.getScale(0).domain(),h=r.radiusAxisHelper.getScale(0).domain(),u=Math.min(r.getRegion().getLayoutRect().width/2,r.getRegion().getLayoutRect().height/2);return a.forEach(t=>{let e=t8(t.angle),i=t8(t.radius);if(e&&i){let e=k1(t,o,n,s),i=k2(t,h,n,s);l.push([{angle:e,radius:i}])}else if(e){let e=k1(t,o,n,s);l.push([{angle:e,radius:-u},{angle:e,radius:u}])}else if(i){let e=k2(t,h,n,s);l.push([{radius:e,angle:0},{radius:e,angle:2*Math.PI}])}}),l}function k7(t,e,i,r){let n=[],s=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,l=tq(r);return s.forEach((t,s)=>{var a,o,h,u;let d=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,c=d.getRegion(),p=c.getLayoutStartPoint(),{width:g,height:f}=c.getLayoutRect(),m=0,y=0;if(r){let t=l?r[s]:r,e=t.x,i=t.y;e&&(m=eC(e)?Number(e.substring(0,e.length-1))*g/100:e),i&&(y=eC(i)?Number(i.substring(0,i.length-1))*f/100:i)}let v=d.getXAxisHelper().getScale(0).domain(),b=d.getYAxisHelper().getScale(0).domain(),_=ed(t.x),x=ed(t.y);1===_.length&&tG(_[0])&&kJ(v,_[0],i)&&(null==(o=null==(a=d.getXAxisHelper())?void 0:a.setExtendDomain)||o.call(a,"marker_xAxis_extend",_[0])),1===x.length&&tG(x[0])&&kJ(b,x[0],i)&&(null==(u=null==(h=d.getYAxisHelper())?void 0:h.setExtendDomain)||u.call(h,"marker_yAxis_extend",x[0])),n.push({x:k5(d.getXAxisHelper(),_)+p.x+m,y:k5(d.getYAxisHelper(),x)+p.y+y})}),n}function Tt(t,e,i){let r=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach(t=>{var n,s,l,a;let o=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,h=o.angleAxisHelper.getScale(0).domain(),u=o.radiusAxisHelper.getScale(0).domain(),d=ed(t.angle),c=ed(t.radius);1===d.length&&tG(d[0])&&kJ(h,d[0],i)&&(null==(s=null==(n=o.angleAxisHelper)?void 0:n.setExtendDomain)||s.call(n,"marker_xAxis_extend",d[0])),1===c.length&&tG(c[0])&&kJ(u,c[0],i)&&(null==(a=null==(l=o.radiusAxisHelper)?void 0:l.setExtendDomain)||a.call(l,"marker_yAxis_extend",c[0])),r.push({angle:k5(o.angleAxisHelper,d),radius:k5(o.radiusAxisHelper,c)})}),r}function Te(t,e,i){let{x:r,y:n}=t;return eC(r)&&(r=k3(r,e)),eC(n)&&(n=k3(n,i)),{x:r,y:n}}function Ti(t,e,i){let r;if(r=tQ(t)?ed(t(e.getData().getLatestData(),e)):ed(t),i){let t=e.getRegion(),{x:i,y:n}=t.getLayoutStartPoint(),{width:s,height:l}=t.getLayoutRect();return r.map(t=>{let{x:e,y:r}=Te(t,s,l);return{x:e+=i,y:r+=n}})}let{width:n,height:s}=e.getOption().getChart().getViewRect();return r.map(t=>Te(t,n,s))}function Tr(t){let e=1/0,i=-1/0,r=1/0,n=-1/0;return t.forEach(t=>{let s=t.getLayoutStartPoint(),l=t.getLayoutRect();s.x<e&&(e=s.x),s.x+l.width>i&&(i=s.x+l.width),s.y<r&&(r=s.y),s.y+l.height>n&&(n=s.y+l.height)}),{minX:e,maxX:i,minY:r,maxY:n}}function Tn(t,e,i){let{labelBackground:r={},style:n,shape:s}=t,l=kq(t,["labelBackground","style","shape"]);return!1!==t.visible?((null==s?void 0:s.visible)?l.shape=Object.assign({visible:!0},gd(s.style)):l.shape={visible:!1},!1!==r.visible?(l.panel=Object.assign({visible:!0,customShape:r.customShape},Tl(gd(r.style),e,i)),t8(r.padding)&&(l.padding=A2(r.padding))):(l.panel={visible:!1},l.padding=0),n&&(l.textStyle=Tl(gd(n),e,i)),l):{visible:!1}}function Ts(t,e,i){for(let r in t)tQ(t[r])&&(t[r]=t[r](e,i));return t}function Tl(t,e,i){return tQ(t)?t(e,i):t}function Ta(t,e,i){return t8(t)?"regionLeft"===e?i.getLayoutStartPoint().x-t.x:"regionRight"===e?i.getLayoutStartPoint().x+i.getLayoutRect().width-t.x:"regionTop"===e?i.getLayoutStartPoint().y-t.y:"regionBottom"===e?i.getLayoutStartPoint().y+i.getLayoutRect().height-t.y:e:e}function To(t){return{isXProcess:t8(t.x),isYProcess:t8(t.y),isX1Process:t8(t.x1),isY1Process:t8(t.y1),isAngleProcess:t8(t.angle),isRadiusProcess:t8(t.radius),isAngle1Process:t8(t.angle1),isRadius1Process:t8(t.radius1),isCoordinatesProcess:t8(t.coordinates),isValidProcess:t8(t.process)}}function Th(t){let{isXProcess:e,isYProcess:i,isX1Process:r,isY1Process:n,isAngleProcess:s,isRadiusProcess:l,isAngle1Process:a,isRadius1Process:o,isCoordinatesProcess:h,isValidProcess:u}=To(t);return{doXProcess:e&&!i&&!n,doXYY1Process:e&&i&&n,doYProcess:i&&!e&&!r,doYXX1Process:i&&e&&r,doXYProcess:e&&i&&r&&n,doAngleProcess:s&&!a&&!l&&!o,doRadiusProcess:l&&!o&&!s&&!a,doAngRadRad1Process:s&&!a&&l&&o,doRadAngAng1Process:l&&s&&a&&!o,doRadAngProcess:s&&l&&a&&o,doCoordinatesProcess:h&&(!u||"process"in t&&"xy"in t.process)}}function Tu(t){let{isXProcess:e,isYProcess:i,isX1Process:r,isY1Process:n,isAngleProcess:s,isRadiusProcess:l,isAngle1Process:a,isRadius1Process:o,isCoordinatesProcess:h}=To(t);return{doXProcess:e&&r&&!i&&!n,doYProcess:i&&n&&!e&&!r,doXYProcess:e&&r&&i&&n,doAngleProcess:s&&a&&!l&&!o,doRadiusProcess:l&&o&&!s&&!a,doRadAngProcess:s&&l&&a&&o,doCoordinatesProcess:h}}function Td(t){return{doXYProcess:t8(t.x)&&t8(t.y),doPolarProcess:t8(t.angle)&&t8(t.radius),doGeoProcess:t8(t.areaName)}}var Tc=i(96628),Tp=i(19917);function Tg(){(0,op.M)(),(0,kE.b)(),(0,uM.d)()}function Tf(t,e){let{x1:i,y1:r,x2:n,y2:s}=e,{x1:l,y1:a,x2:o,y2:h}=t.AABBBounds,u=0,d=0;return l<i&&(u=i-l),a<r&&(d=r-a),o>n&&(u=n-o),h>s&&(d=s-h),{dx:u,dy:d}}function Tm(t,e){let{dx:i,dy:r}=Tf(t,e),{dx:n=0,dy:s=0}=t.attribute;i&&t.setAttribute("dx",i+n),r&&t.setAttribute("dy",r+s)}var Ty=i(64215);class Tv extends g3.k{constructor(){super(...arguments),this.name="marker",this._onHover=t=>{this._lastHover=(0,Ty.fM)(t,this._container,this._lastHover)},this._onUnHover=t=>{this._lastHover=(0,Ty.lO)(t,this._container,this._lastHover)},this._onClick=t=>{this._lastSelect=(0,Ty.Q6)(t,this._container,this._lastSelect)}}transAnimationConfig(){var t,e,i;if(!1!==this.attribute.animation){let r=(0,uv.Z)(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:(0,cQ.Z)({},this.defaultUpdateAnimation,r,null!=(t=this.attribute.animationEnter)?t:{}),exit:(0,cQ.Z)({},this.defaultExitAnimation,r,null!=(e=this.attribute.animationExit)?e:{}),update:(0,cQ.Z)({},this.defaultUpdateAnimation,r,null!=(i=this.attribute.animationUpdate)?i:{})}}}setAttribute(t,e,i){super.setAttribute(t,e,i),"visible"===t&&this.render()}_bindEvent(){var t,e,i;if(!this.attribute.interactive)return;let{hover:r,select:n}=this.attribute;r&&(null==(t=this._container)||t.addEventListener("pointermove",this._onHover),null==(e=this._container)||e.addEventListener("pointerout",this._onUnHover)),n&&(null==(i=this._container)||i.addEventListener("pointerdown",this._onClick))}_releaseEvent(){var t,e,i;null==(t=this._container)||t.removeEventListener("pointermove",this._onHover),null==(e=this._container)||e.removeEventListener("pointerout",this._onUnHover),null==(i=this._container)||i.removeEventListener("pointerdown",this._onClick)}_initContainer(){var t,e;let i,{limitRect:r={},clipInRange:n}=this.attribute;if(n){let n=c0.i.group(Object.assign(Object.assign({},r),{clip:!0,pickable:!1}));i=c0.i.group({x:-(null!=(t=r.x)?t:0),y:-(null!=(e=r.y)?e:0),pickable:!1}),n.add(i),this._containerClip=n,this.add(n)}else i=c0.i.group({x:0,y:0,pickable:!1}),this.add(i);i.name="marker-container",this._container=i}_updateContainer(){var t,e;let{limitRect:i={},clipInRange:r}=this.attribute;this._containerClip&&this._containerClip.setAttributes(Object.assign({},i)),this._container.setAttributes({x:r?-(null!=(t=i.x)?t:0):0,y:r?-(null!=(e=i.y)?e:0):0})}render(){var t;this.transAnimationConfig(),this.setAttribute("pickable",!1);let e=null==(t=this.attribute.visible)||t;!1===this.attribute.interactive&&this.setAttribute("childrenPickable",!1),e&&this.isValidPoints()?this._container?(this._updateContainer(),this.updateMarker(),this.markerAnimate("update")):(this._initContainer(),this.initMarker(this._container),this.markerAnimate("enter")):(this.markerAnimate("exit"),this._container=null,this.removeAllChild(!0)),this._releaseEvent(),this._bindEvent()}release(){this.markerAnimate("exit"),super.release(),this._releaseEvent(),this._container=null}}function Tb(t,e,i,r){var n,s,l,a,o;if(!t)return;null==(n=null==t?void 0:t.animates)||n.forEach(t=>t.stop("end"));let h=null!=(l=null==(s=t.attribute)?void 0:s.fillOpacity)?l:1,u=null!=(o=null==(a=t.attribute)?void 0:a.strokeOpacity)?o:1;t.setAttributes({fillOpacity:0,strokeOpacity:0}),t.animate().wait(e).to({fillOpacity:h,strokeOpacity:u},i,r)}function T_(t,e,i,r){t&&(Tb(t.startSymbol,e,i,r),t.lines.forEach(t=>Tb(t,e,i,r)),Tb(t.line,e,i,r),Tb(t.endSymbol,e,i,r))}function Tx(t,e,i,r){t&&(Tb(t.getTextShape(),e,i,r),Tb(t.getBgRect(),e,i,r))}function TC(t,e,i,r){var n,s,l,a;t&&(t.setAttributes({fillOpacity:null!=(s=null==(n=t.attribute)?void 0:n.fillOpacity)?s:1,strokeOpacity:null!=(a=null==(l=t.attribute)?void 0:l.strokeOpacity)?a:1}),t.animate().wait(e).to({fillOpacity:0,strokeOpacity:0},i,r))}function Tw(t,e,i,r){t&&(TC(t.startSymbol,e,i,r),t.lines.forEach(t=>TC(t,e,i,r)),TC(t.line,e,i,r),TC(t.endSymbol,e,i,r))}function TS(t,e,i,r){t&&(TC(t.getTextShape(),e,i,r),TC(t.getBgRect(),e,i,r))}function TA(t,e,i,r,n){let s=.1*i,l=.7*i,a=.1*i,o=.1*i;Tb(t.startSymbol,r,s,n),t.lines.forEach(t=>t.setAttribute("clipRange",0)),t.lines.forEach((e,i)=>{let a=l/t.lines.length;e.animate().wait(r+s+i*a).to({clipRange:1},a,n)}),Tb(t.endSymbol,r+s+l,a,n),(0,kx.IX)(e).forEach(t=>{let e=r+s+l+a;Tb(t.getTextShape(),e,o,n),Tb(t.getBgRect(),e,o,n)})}function TM(t,e,i,r,n){T_(t,r,i,n),(0,kx.IX)(e).forEach(t=>{Tx(t,r,i,n)})}function Tk(t,e,i,r,n){Tb(t,r,i,n),(0,kx.IX)(e).forEach(t=>{Tx(t,r,i,n)})}function TT(t,e,i,r,n){Tb(t,r,i,n),(0,kx.IX)(e).forEach(t=>{Tx(t,r,i,n)})}function TR(t,e,i,r,n,s){var l;T_(t,n,r,s),Tb(e,n,r,s),(null==(l=i.getTextShape)?void 0:l.call(i))?Tx(i,n,r,s):Tb(i,n,r,s)}function TB(t,e,i,r,n,s){var l;let a=.1*r,o=.65*r,h=.05*r,u=.1*r,d=.1*r;Tb(t.startSymbol,n,a,s),t.lines.forEach(t=>t.setAttribute("clipRange",0)),t.lines.forEach((e,i)=>{let r=o/t.lines.length;e.animate().wait(n+a+i*r).to({clipRange:1},r,s)}),Tb(e,n+a+o,h,s),Tb(t.endSymbol,n+a+o+h,u,s),(null==(l=i.getTextShape)?void 0:l.call(i))?(Tb(i.getTextShape(),n+a+o+h+u,d,s),Tb(i.getBgRect(),n+a+o+u,d,s)):Tb(i,n+a+o+u,d,s)}function TP(t,e,i,r){let{enter:n,update:s,exit:l}=i;if("enter"===r){let{type:i,duration:r,delay:s,easing:l}=n;"clipIn"===i?TA(t,e,r,s,l):"fadeIn"===i&&TM(t,e,r,s,l)}else if("update"===r){let{type:i,duration:r,delay:n,easing:l}=s;"clipIn"===i?TA(t,e,r,n,l):"fadeIn"===i&&TM(t,e,r,n,l)}else if("exit"===r){let{duration:i,delay:r,easing:n}=l;Tw(t,r,i,n),(0,kx.IX)(e).forEach(t=>{TS(t,r,i,n)})}}function TE(t,e,i,r){let{enter:n,update:s,exit:l}=i;if("enter"===r){let{type:i,duration:r,delay:s,easing:l}=n;"fadeIn"===i&&Tk(t,e,r,s,l)}else if("update"===r){let{type:i,duration:r,delay:n,easing:l}=s;"fadeIn"===i&&Tk(t,e,r,n,l)}else if("exit"===r){let{duration:i,delay:r,easing:n}=l;TC(t,r,i,n),(0,kx.IX)(e).forEach(t=>{TS(t,r,i,n)})}}function TI(t,e,i,r){let{enter:n,update:s,exit:l}=i;if("enter"===r){let{type:i,duration:r,delay:s,easing:l}=n;"fadeIn"===i&&TT(t,e,r,s,l)}else if("update"===r){let{type:i,duration:r,delay:n,easing:l}=s;"fadeIn"===i&&TT(t,e,r,n,l)}else if("exit"===r){let{duration:i,delay:r,easing:n}=l;TC(t,r,i,n),(0,kx.IX)(e).forEach(t=>{TS(t,r,i,n)})}}function TL(t,e,i,r){let[n,s]=t,{enter:l,update:a,exit:o}=i;if("enter"===r){let{type:t,duration:i,delay:r,easing:a}=l;"fadeIn"===t?TR(n,s,e,i,r,a):"callIn"===t&&TB(n,s,e,i,r,a)}else if("update"===r){let{type:t,duration:i,delay:r,easing:l}=a;"fadeIn"===t?TR(n,s,e,i,r,l):"callIn"===t&&TB(n,s,e,i,r,l)}else if("exit"===r){var h;let{duration:t,delay:i,easing:r}=o;Tw(n,i,t,r),TC(s,i,t,r),(null==(h=e.getTextShape)?void 0:h.call(e))?TS(e,i,t,r):TC(e,i,t,r)}}let TF={type:"clipIn",duration:500,easing:"linear",delay:0},TO={type:"fadeIn",duration:500,easing:"linear",delay:0},TD={type:"callIn",duration:500,easing:"linear",delay:0},TH={type:"fadeOut",duration:500,easing:"linear",delay:0};class Tz{getLabel(){return this._label}_addMarkLabels(t,e,i){let{label:r,state:n}=this.attribute,s=(0,kx.IX)(null==n?void 0:n.label),l=(0,kx.IX)(null==n?void 0:n.labelBackground),a=(0,kx.IX)(r).map((r,n)=>{var a,o;let h=(0,cQ.Z)({},i,r),u=new kr.V(Object.assign(Object.assign({},h),{state:{panel:(0,cQ.Z)({},pe.n0,null!=(a=l[n])?a:(0,kx.Z$)(l)),text:(0,cQ.Z)({},pe.n0,null!=(o=s[n])?o:(0,kx.Z$)(s))}}));return u.name=e,t.add(u),this.setLabelPos(u,h),u});this._label=1===(0,kx.IX)(a).length?a[0]:a}_updateMarkLabels(t){let{label:e,state:i}=this.attribute,r=(0,kx.IX)(this._label),n=(0,kx.IX)(null==i?void 0:i.label),s=(0,kx.IX)(null==i?void 0:i.labelBackground);if(r.length){let i=(0,kx.IX)(e);r.forEach((e,r)=>{var l,a;let o=(0,cQ.Z)({},t,i[r]);e.setAttributes(Object.assign(Object.assign({dx:0,dy:0},o),{state:{panel:(0,cQ.Z)({},pe.n0,null!=(l=s[r])?l:(0,kx.Z$)(s)),text:(0,cQ.Z)({},pe.n0,null!=(a=n[r])?a:(0,kx.Z$)(n))}})),this.setLabelPos(e,o)})}}}class TW extends Tv{constructor(){super(...arguments),this.name="markCommonLine",this.defaultUpdateAnimation=TF,this.defaultExitAnimation=TH}getLine(){return this._line}setLabelPos(t,e){let{limitRect:i}=this.attribute,{position:r,confine:n,autoRotate:s}=e,l=this.getPointAttrByPosition(r,e),a=r.toString().toLocaleLowerCase().includes("start")?this._line.getStartAngle()||0:this._line.getEndAngle()||0;if(t.setAttributes(Object.assign(Object.assign({},l.position),{angle:s?this.getRotateByAngle(l.angle,e):0,textStyle:Object.assign(Object.assign({},this.getTextStyle(r,a,s)),e.textStyle)})),i&&n){let{x:e,y:r,width:n,height:s}=i;Tm(t,{x1:e,y1:r,x2:e+n,y2:r+s})}}initMarker(t){let e=this.createSegment();e.name="mark-common-line-line",this._line=e,t.add(e),this.addMarkLineLabels(t)}updateMarker(){this.setLineAttributes(),this.updateMarkLineLabels()}}(0,g1.jB)(TW,Tz);var TN=i(15532);(tn=tw||(tw={})).start="start",tn.startTop="startTop",tn.startBottom="startBottom",tn.insideStart="insideStart",tn.insideStartTop="insideStartTop",tn.insideStartBottom="insideStartBottom",tn.middle="middle",tn.insideMiddleTop="insideMiddleTop",tn.insideMiddleBottom="insideMiddleBottom",tn.end="end",tn.endTop="endTop",tn.endBottom="endBottom",tn.insideEnd="insideEnd",tn.insideEndTop="insideEndTop",tn.insideEndBottom="insideEndBottom",(ts=tS||(tS={})).left="left",ts.right="right",ts.top="top",ts.bottom="bottom",ts.topLeft="topLeft",ts.topRight="topRight",ts.bottomLeft="bottomLeft",ts.bottomRight="bottomRight",ts.middle="middle",ts.insideLeft="insideLeft",ts.insideRight="insideRight",ts.insideTop="insideTop",ts.insideBottom="insideBottom",ts.insideTopLeft="insideTopLeft",ts.insideTopRight="insideTopRight",ts.insideBottomLeft="insideBottomLeft",ts.insideBottomRight="insideBottomRight",(tl=tA||(tA={})).arcInnerStart="arcInnerStart",tl.arcInnerEnd="arcInnerEnd",tl.arcInnerMiddle="arcInnerMiddle",tl.arcOuterStart="arcOuterStart",tl.arcOuterEnd="arcOuterEnd",tl.arcOuterMiddle="arcOuterMiddle",tl.center="center",(ta=tM||(tM={})).top="top",ta.bottom="bottom",ta.middle="middle",ta.insideTop="insideTop",ta.insideBottom="insideBottom",ta.insideMiddle="insideMiddle";let Tj={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:tw.end,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},TG={postiveXAxis:{start:{textAlign:"left",textBaseline:"middle"},startTop:{textAlign:"left",textBaseline:"bottom"},startBottom:{textAlign:"left",textBaseline:"top"},insideStart:{textAlign:"right",textBaseline:"middle"},insideStartTop:{textAlign:"right",textBaseline:"bottom"},insideStartBottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"left",textBaseline:"middle"},endTop:{textAlign:"left",textBaseline:"bottom"},endBottom:{textAlign:"left",textBaseline:"top"},insideEnd:{textAlign:"right",textBaseline:"middle"},insideEndTop:{textAlign:"right",textBaseline:"bottom"},insideEndBottom:{textAlign:"right",textBaseline:"top"}},negativeXAxis:{start:{textAlign:"right",textBaseline:"middle"},startTop:{textAlign:"right",textBaseline:"bottom"},startBottom:{textAlign:"right",textBaseline:"top"},insideStart:{textAlign:"left",textBaseline:"middle"},insideStartTop:{textAlign:"left",textBaseline:"bottom"},insideStartBottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"right",textBaseline:"middle"},endTop:{textAlign:"right",textBaseline:"bottom"},endBottom:{textAlign:"right",textBaseline:"top"},insideEnd:{textAlign:"left",textBaseline:"middle"},insideEndTop:{textAlign:"left",textBaseline:"bottom"},insideEndBottom:{textAlign:"left",textBaseline:"top"}}},TV={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{autoRotate:!0,position:tA.arcOuterMiddle,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},TZ={interactive:!0,label:{position:tS.right,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},TU={interactive:!0,label:{autoRotate:!0,position:tA.arcOuterMiddle,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},TK={arcInnerStart:{textAlign:"center",textBaseline:"bottom"},arcInnerEnd:{textAlign:"center",textBaseline:"bottom"},arcInnerMiddle:{textAlign:"center",textBaseline:"bottom"},arcOuterStart:{textAlign:"center",textBaseline:"top"},arcOuterEnd:{textAlign:"center",textBaseline:"top"},arcOuterMiddle:{textAlign:"center",textBaseline:"top"},center:{textAlign:"center",textBaseline:"middle"}},T$={left:{textAlign:"right",textBaseline:"middle"},insideLeft:{textAlign:"left",textBaseline:"middle"},right:{textAlign:"left",textBaseline:"middle"},insideRight:{textAlign:"right",textBaseline:"middle"},top:{textAlign:"center",textBaseline:"bottom"},insideTop:{textAlign:"center",textBaseline:"top"},bottom:{textAlign:"center",textBaseline:"top"},insideBottom:{textAlign:"center",textBaseline:"bottom"},middle:{textAlign:"center",textBaseline:"middle"},topLeft:{textAlign:"right",textBaseline:"top"},insideTopLeft:{textAlign:"left",textBaseline:"top"},topRight:{textAlign:"left",textBaseline:"top"},insideTopRight:{textAlign:"right",textBaseline:"top"},bottomLeft:{textAlign:"right",textBaseline:"bottom"},insideBottomLeft:{textAlign:"left",textBaseline:"bottom"},bottomRight:{textAlign:"left",textBaseline:"bottom"},insideBottomRight:{textAlign:"right",textBaseline:"bottom"}},TY={postiveXAxis:{top:{textAlign:"left",textBaseline:"bottom"},bottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"left",textBaseline:"middle"},insideTop:{textAlign:"right",textBaseline:"bottom"},insideBottom:{textAlign:"right",textBaseline:"top"},insideMiddle:{textAlign:"right",textBaseline:"middle"}},negativeXAxis:{top:{textAlign:"right",textBaseline:"bottom"},bottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"right",textBaseline:"middle"},insideTop:{textAlign:"left",textBaseline:"bottom"},insideBottom:{textAlign:"left",textBaseline:"top"},insideMiddle:{textAlign:"left",textBaseline:"middle"}}};function TX(){Tq._animate=TP}Tg(),(0,Tp.j)(),(0,uM.d)();class Tq extends TW{markerAnimate(t){Tq._animate&&this._animationConfig&&Tq._animate(this._line,this._label,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},Tq.defaultAttributes,t)),this.name="markLine"}getPointAttrByPosition(t,e){var i;let{refX:r=0,refY:n=0}=e,s=this._line.getMainSegmentPoints(),l=null!=(i=this._line.getEndAngle())?i:0,a=((0,pt.WF)(l),l),o=r*Math.cos(a)+n*Math.cos(a-Math.PI/2),h=r*Math.sin(a)+n*Math.sin(a-Math.PI/2);return t.includes("start")||t.includes("Start")?{position:{x:s[0].x+o,y:s[0].y+h},angle:a}:t.includes("middle")||t.includes("Middle")?{position:{x:(s[0].x+s[s.length-1].x)/2+o,y:(s[0].y+s[s.length-1].y)/2+h},angle:a}:{position:{x:s[s.length-1].x+o,y:s[s.length-1].y+h},angle:a}}getRotateByAngle(t,e){var i;return((0,pt.WF)(t)?t:t-Math.PI)+(null!=(i=e.refAngle)?i:0)}getTextStyle(t,e,i){return(0,pt.U4)(Math.abs(e),Math.PI/2,.001)||(0,pt.U4)(Math.abs(e),3*Math.PI/2,.001)?(0,pt.ic)(i,e,t):(0,pt.WF)(e)?TG.postiveXAxis[t]:TG.negativeXAxis[t]}createSegment(){let{points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:s,state:l}=this.attribute;return new TN.X({points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:s,pickable:!1,state:{line:(0,cQ.Z)({},pe.n0,null==l?void 0:l.line),startSymbol:(0,cQ.Z)({},pe.n0,null==l?void 0:l.lineStartSymbol),endSymbol:(0,cQ.Z)({},pe.n0,null==l?void 0:l.lineEndSymbol)}})}setLineAttributes(){let{points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:s,state:l}=this.attribute;this._line&&this._line.setAttributes({points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:s,state:{line:(0,cQ.Z)({},pe.n0,null==l?void 0:l.line),startSymbol:(0,cQ.Z)({},pe.n0,null==l?void 0:l.lineStartSymbol),endSymbol:(0,cQ.Z)({},pe.n0,null==l?void 0:l.lineEndSymbol)}})}isValidPoints(){let{points:t}=this.attribute;if(!t||t.length<2)return!1;let e=!0;return t.forEach(t=>{if(t.length)t.forEach(t=>{(0,uE.Z)(t.x)&&(0,uE.Z)(t.y)||(e=!1)});else if(!(0,uE.Z)(t.x)||!(0,uE.Z)(t.y))return void(e=!1)}),e}addMarkLineLabels(t){this._addMarkLabels(t,"mark-common-line-label",Tq.defaultAttributes.label)}updateMarkLineLabels(){this._updateMarkLabels(Tq.defaultAttributes.label)}}Tq.defaultAttributes=Tj;var TJ=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};function TQ(t,e){let i;if(e.coordinates){let t,r,{coordinates:n,coordinateType:s,getSeriesByIdOrIndex:l}=e,a=TJ(e,["coordinates","coordinateType","getSeriesByIdOrIndex"]);if(tQ(n)){let i=e.getRelativeSeries();t=n(i.getData().getLatestData(),i)}else t=n;i=(t=ed(t)).map(t=>{let e=l(t.refRelativeSeriesId,t.refRelativeSeriesIndex);if("cartesian"===s){let{xField:i,yField:n}=e.getSpec(),{xFieldDim:s,xFieldIndex:l,yFieldDim:o,yFieldIndex:h}=t,u=i;t8(l)&&(u=ed(i)[l]),s&&ed(i).includes(s)&&(u=s);let d=n;t8(h)&&(d=ed(n)[h]),o&&ed(n).includes(o)&&(d=o),r=Object.assign({x:void 0,y:void 0},a),t6(t[u])&&k4(t[u])?r.x={field:u,aggrType:t[u]}:r.x=ed(u).map(e=>t[e]),t6(t[d])&&k4(t[d])?r.y={field:d,aggrType:t[d]}:r.y=ed(d).map(e=>t[e])}else if("polar"===s){let{valueField:i,categoryField:n}=e.getSpec(),{angleFieldDim:s,angleFieldIndex:l}=t,o=n;t8(l)&&(o=ed(n)[l]),s&&ed(n).includes(s)&&(o=s),r=Object.assign({angle:void 0,radius:void 0},a),t6(t[o])&&k4(t[o])?r.angle={field:o,aggrType:t[o]}:r.angle=ed(o).map(e=>t[e]),t6(t[i])&&k4(t[i])?r.radius={field:i,aggrType:t[i]}:r.radius=ed(i).map(e=>t[e])}return r.getRefRelativeSeries=()=>e,r})}else i=e;let r=[];return i.forEach(e=>{let i={x:null,y:null,angle:null,radius:null,areaName:null};if(t8(e.x)){let r=e.x;tq(r)?i.x=r.map(i=>T1(i,t,e)):i.x=T1(r,t,e)}if(t8(e.y)){let r=e.y;tq(r)?i.y=r.map(i=>T1(i,t,e)):i.y=T1(r,t,e)}if(t8(e.angle)){let r=e.angle;tq(r)?i.angle=r.map(i=>T1(i,t,e)):i.angle=T1(r,t,e)}if(t8(e.radius)){let r=e.radius;tq(r)?i.radius=r.map(i=>T1(i,t,e)):i.radius=T1(r,t,e)}t8(e.areaName)&&(i.areaName=T1(e.areaName,t,e)),e.getRefRelativeSeries&&(i.getRefRelativeSeries=e.getRefRelativeSeries),r.push(i)}),r}let T0={min:(t,e)=>dH(t[0].latestData,e.field),max:(t,e)=>dz(t[0].latestData,e.field),sum:function(t,e){return dW(t[0].latestData,e.field)},average:function(t,e){return dN(t[0].latestData,e.field)},variance:function(t,e){return dj(t[0].latestData,e.field)},standardDeviation:function(t,e){return Math.sqrt(dj(t[0].latestData,e.field))},median:function(t,e){var i,r;return i=t[0].latestData,r=e.field,dS(i.map(t=>t[r]))}};function T1(t,e,i){let r=i.getRelativeSeries(),n=i.getStartRelativeSeries(),s=i.getEndRelativeSeries(),l=r.getData().getLatestData(),a=n.getData().getLatestData(),o=s.getData().getLatestData();if(tQ(t))return t(l,a,o,r,n,s);if(t1(t)){let{aggrType:i,field:r}=t;return T0[i](e,{field:r})}return t}function T2(t,e){if(e&&e.getRelativeSeries){let i=e.getRelativeSeries();if(i){let e=i.getViewData();return e&&e.latestData&&e.latestData.length?t:[]}}return t}class T3 extends gz{constructor(){super(...arguments),this.layoutType="none",this._layoutOffsetX=0,this._layoutOffsetY=0}getRelativeSeries(){return this._relativeSeries}getMarkerData(){return this._markerData}static _getMarkerCoordinateType(t){return"cartesian"}static getSpecInfo(t){return d6(t,this.specKey,this.type,t=>!1!==t.visible&&this._getMarkerCoordinateType(t)===this.coordinateType)}getMarkAttributeContext(){return this._markAttributeContext}_buildMarkerAttributeContext(){this._markAttributeContext={relativeSeries:this._relativeSeries,startRelativeSeries:this._startRelativeSeries,endRelativeSeries:this._endRelativeSeries,vchart:this._option.globalInstance}}created(){super.created(),this._bindSeries(),this._initDataView(),this.initEvent(),this._buildMarkerAttributeContext()}_getAllRelativeSeries(){return{getRelativeSeries:()=>this._relativeSeries,getStartRelativeSeries:()=>this._startRelativeSeries,getEndRelativeSeries:()=>this._endRelativeSeries}}_getFieldInfoFromSpec(t,e,i){return t6(e)&&k4(e)?{field:i.getSpec()[({x:"xField",y:"yField",radius:"valueField",angle:"categoryField",areaName:"nameField"})[t]],aggrType:e}:e}_processSpecByDims(t){let e=this._relativeSeries,i={};return t.forEach(t=>i[t.dim]=this._getFieldInfoFromSpec(t.dim,t.specValue,e)),Object.assign(Object.assign({},i),this._getAllRelativeSeries())}_processSpecCoo(t){return Object.assign(Object.assign({coordinates:t.coordinates||t.coordinate},this._getAllRelativeSeries()),{getSeriesByIdOrIndex:(t,e)=>this._getSeriesByIdOrIndex(t,e),coordinateType:this.coordinateType})}_getRelativeDataView(){if(this._specifiedDataSeries){let t=[];ed(this._specifiedDataSeries).forEach(e=>{t=t.concat(e.getViewData().latestData)});let e=new tY;return e.registerParser("array",tz),new el(e).parse(t,{type:"array"})}return this._relativeSeries.getViewData()}updateLayoutAttribute(){var t,e,i;if(null==(t=this._spec.visible)||t){if(!this._markerComponent){let t=this._createMarkerComponent();t.name=null!=(e=this._spec.name)?e:this.type,t.id=null!=(i=this._spec.id)?i:`${this.type}-${this.id}`,this._markerComponent=t,this.getContainer().add(this._markerComponent),this._markerComponent.on("*",(t,e)=>{this._delegateEvent(this._markerComponent,t,e,null,this.getMarkerData.bind(this))})}this._markerLayout()}super.updateLayoutAttribute()}_getSeriesByIdOrIndex(t,e){var i,r;let n;return(n=null==(i=this._option.getSeriesInUserIdOrIndex(t8(t)?[t]:[],[e]))?void 0:i[0])||(n=null!=(r=this._relativeSeries)?r:this._getFirstSeries()),n}_bindSeries(){let t=this._spec;this._relativeSeries=this._getSeriesByIdOrIndex(t.relativeSeriesId,t.relativeSeriesIndex),this._startRelativeSeries=this._getSeriesByIdOrIndex(t.startRelativeSeriesId,t.startRelativeSeriesIndex),this._endRelativeSeries=this._getSeriesByIdOrIndex(t.endRelativeSeriesId,t.endRelativeSeriesIndex),t.specifiedDataSeriesIndex&&"all"===t.specifiedDataSeriesIndex||t.specifiedDataSeriesId&&"all"===t.specifiedDataSeriesId?this._specifiedDataSeries=this._option.getAllSeries():(t.specifiedDataSeriesIndex||t.specifiedDataSeriesId)&&(this._specifiedDataSeries=this._getSeriesByIdOrIndex(t.specifiedDataSeriesId,t.specifiedDataSeriesIndex))}initEvent(){"cartesian"!==this._relativeSeries.coordinate&&(this._relativeSeries.event.on("zoom",this._markerLayout.bind(this)),this._relativeSeries.event.on("panmove",this._markerLayout.bind(this)),this._relativeSeries.event.on("scroll",this._markerLayout.bind(this)))}clear(){super.clear(),this._firstSeries=null}_getFirstSeries(){var t;if(this._firstSeries)return this._firstSeries;let e=pJ(this._regions);return e?(this._firstSeries=e,e):(null==(t=this._option)||t.onError("need at least one series"),null)}_getNeedClearVRenderComponents(){return[this._markerComponent]}onLayoutStart(t,e){er(this._spec.offsetX)||(this._layoutOffsetX=eS(this._spec.offsetX,e.width,e)),er(this._spec.offsetY)||(this._layoutOffsetY=eS(this._spec.offsetY,e.height,e)),super.onLayoutStart(t,e)}_compareSpec(t,e){let i=super._compareSpec(t,e);return t5(e,t)||(i.reRender=!0,i.reMake=!0,i.change=!0),i}_initCommonDataView(){let{options:t}=this._computeOptions(),e=this._getRelativeDataView();nq(this._option.dataSet,"markerAggregation",TQ),nq(this._option.dataSet,"markerFilter",T2);let i=new el(this._option.dataSet,{name:`${this.type}_${this.id}_data`});i.parse([e],{type:"dataview"}),i.transform({type:"markerAggregation",options:t}),i.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),i.target.on("change",()=>{this._markerLayout()}),this._markerData=i}}function T5(t,e){return function(t,e,i){let{predict:r}=function(t,e=t=>t.x,i=t=>t.y){var r;let n,s,l=0,a=0,o=0,h=0,u=0;dA(t,e,i,(t,e)=>{++u,l+=(t-l)/u,a+=(e-a)/u,o+=(t*e-o)/u,h+=(t*t-h)/u});let d=function(t,e,i,r){let n=r-t*t,s=1e-24>Math.abs(n)?0:(i-t*e)/n;return[e-s*t,s]}(l,a,o,h),c=t=>d[0]+d[1]*t;return{coef:d,predict:c,rSquared:(r=a,n=0,s=0,dA(t,e,i,(t,e)=>{let i=e-c(t),l=e-r;n+=i*i,s+=l*l}),1-n/s)}}(t,t=>t[e],t=>t[i]),n=dH(t,e),s=dz(t,e),l=r(n),a=r(s);return[{[e]:n,[i]:l},{[e]:s,[i]:a}]}(t[0].latestData,e.fieldX,e.fieldY)}class T4 extends T3{constructor(){super(...arguments),this.specKey="markLine",this.layoutZIndex=H.MarkLine}static _getMarkerCoordinateType(t){let{doAngleProcess:e,doRadiusProcess:i,doAngRadRad1Process:r,doRadAngAng1Process:n,doRadAngProcess:s}=Th(t);return"polar"===t.coordinateType||e||i||r||n||s?"polar":"cartesian"}_createMarkerComponent(){var t,e,i,r,n,s,l,a,o,h,u,d,c;let{startSymbol:p={},endSymbol:g={}}=this._spec,f=ed(null!=(t=this._spec.label)?t:{}),m={zIndex:this.layoutZIndex,interactive:null==(e=this._spec.interactive)||e,hover:null==(i=this._spec.interactive)||i,select:null==(r=this._spec.interactive)||r,points:[{x:0,y:0},{x:0,y:0}],center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,lineStyle:Tl(gd(null==(n=this._spec.line)?void 0:n.style),this._markerData,this._markAttributeContext),clipInRange:null!=(s=this._spec.clip)&&s,label:f.map(t=>Tn(t,this._markerData,this._markAttributeContext)),state:{line:Ts(null!=(a=null==(l=this._spec.line)?void 0:l.state)?a:{},this._markerData,this._markAttributeContext),lineStartSymbol:Ts(null!=(h=null==(o=this._spec.startSymbol)?void 0:o.state)?h:{},this._markerData,this._markAttributeContext),lineEndSymbol:Ts(null!=(d=null==(u=this._spec.endSymbol)?void 0:u.state)?d:{},this._markerData,this._markAttributeContext),label:f.map(t=>{var e;return Ts(null!=(e=t.state)?e:{},this._markerData,this._markAttributeContext)}),labelBackground:f.map(t=>{var e,i;return Ts(null!=(i=null==(e=t.labelBackground)?void 0:e.state)?i:{},this._markerData,this._markAttributeContext)})},animation:null!=(c=this._spec.animation)&&c,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return p.visible?m.startSymbol=Object.assign(Object.assign({},p),{visible:!0,style:Tl(gd(p.style),this._markerData,this._markAttributeContext)}):m.startSymbol={visible:!1},g.visible?m.endSymbol=Object.assign(Object.assign({},g),{visible:!0,style:Tl(gd(g.style),this._markerData,this._markAttributeContext)}):m.endSymbol={visible:!1},this._newMarkLineComponent(m)}_getUpdateMarkerAttrs(){var t,e;let i,r=this._spec,n=this._markerData,s=this._startRelativeSeries,l=this._endRelativeSeries,a=this._relativeSeries,o=this._computePointsAttr(),h=a.getViewData().latestData,u=n.latestData[0]&&n.latestData[0].latestData?n.latestData[0].latestData:n.latestData;if(r.clip||ed(r.label).some(t=>null==t?void 0:t.confine)){let{minX:t,maxX:e,minY:r,maxY:n}=Tr([s.getRegion(),l.getRegion(),a.getRegion()]);i={x:t,y:r,width:e-t,height:n-r}}let d=ed((null!=(e=null==(t=this._markerComponent)?void 0:t.attribute)?e:{}).label),c=ed(this._spec.label),p=d.map((t,e)=>{let i=c[e]||{};return Object.assign(Object.assign({},t),{text:i.formatMethod?i.formatMethod(u,h):null==t?void 0:t.text})});return Object.assign(Object.assign({},o),{label:p,limitRect:i,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}_markerLayout(){var t;let e=this._getUpdateMarkerAttrs();null==(t=this._markerComponent)||t.setAttributes(e)}_initDataView(){let t=this._spec,e="coordinates"in t,{doXProcess:i,doYProcess:r,doXYY1Process:n,doYXX1Process:s,doXYProcess:l,doAngleProcess:a,doRadiusProcess:o,doAngRadRad1Process:h,doRadAngAng1Process:u,doRadAngProcess:d}=Th(t);if(this._markerData=this._getRelativeDataView(),!(i||r||n||s||l||a||o||h||u||d||e))return;nq(this._option.dataSet,"markerAggregation",TQ),nq(this._option.dataSet,"markerRegression",T5),nq(this._option.dataSet,"markerFilter",T2);let{options:c,needAggr:p,needRegr:g,processData:f}=this._computeOptions(),m=new el(this._option.dataSet);m.parse([f],{type:"dataview"}),p&&m.transform({type:"markerAggregation",options:c}),g&&m.transform({type:"markerRegression",options:c}),m.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),m.target.on("change",()=>{this._markerLayout()}),this._markerData=m}}T4.specKey="markLine";let T6=()=>({style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}),T8=t=>({visible:t,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}}),T9=T6();T9.refY=5;let T7={line:{style:{lineDash:[3,3],stroke:{type:"palette",key:"markLineStrokeColor"}}},startSymbol:T8(!1),endSymbol:T8(!0),label:T9};class Rt extends T4{constructor(){super(...arguments),this.type=rk.markLine,this.name=rk.markLine,this.coordinateType="cartesian"}_newMarkLineComponent(t){return new Tq(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,s=this._relativeSeries,l=t8(e.coordinates),a=t8(e.process),o=a&&t8(e.process.x),h=a&&t8(e.process.y),u=t8(e.positions),d=null!=(t=e.autoRange)&&t,{doXProcess:c,doYProcess:p,doXYY1Process:g,doYXX1Process:f,doXYProcess:m,doCoordinatesProcess:y}=Th(e),v=[];if(c||g||p||f||m||l&&o||l&&h){let t=k6(i,r,n,s,d);v=1===t.length?t[0]:t.map(t=>t[0])}else y?v=k7(i,s,d,e.coordinatesOffset):u&&(v=Ti(e.positions,s,e.regionRelative));return{points:v}}_markerLayout(){var t,e,i,r,n;let s=this._getUpdateMarkerAttrs();if("type-step"===this._spec.type){let n,l,a=this._startRelativeSeries,o=this._endRelativeSeries,{multiSegment:h,mainSegmentIndex:u}=this._spec.line||{},{connectDirection:d,expandDistance:c=0}=this._spec;if(eC(c)){let t=a.getRegion(),e=t.getLayoutStartPoint(),i=o.getRegion(),r=i.getLayoutStartPoint();if("bottom"===d||"top"===d){let s=Math.abs(Math.min(e.y,r.y)-Math.max(e.y+t.getLayoutRect().height,r.y+i.getLayoutRect().height));n=Number(c.substring(0,c.length-1))*s/100}else{let s=Math.abs(Math.min(e.x,r.x)-Math.max(e.x+t.getLayoutRect().width,r.x+i.getLayoutRect().width));n=Number(c.substring(0,c.length-1))*s/100}}else n=c;let{points:p,limitRect:g}=s;if(!p||p.length<2)return void(null==(t=this._markerComponent)||t.setAttributes(s));let f=function(t,e,i,r=0){let n=[],s=t.y-e.y,l=t.x-e.x;switch(i){case"top":n.push(t),n.push({x:t.x,y:s>0?t.y-r-Math.abs(s):t.y-r}),n.push({x:e.x,y:s>0?e.y-r:e.y-r-Math.abs(s)}),n.push(e);break;case"bottom":n.push(t),n.push({x:t.x,y:s<0?t.y+r+Math.abs(s):t.y+r}),n.push({x:e.x,y:s<0?e.y+r:e.y+r+Math.abs(s)}),n.push(e);break;case"left":n.push(t),n.push({x:l>0?t.x-r-Math.abs(l):t.x-r,y:t.y}),n.push({x:l>0?e.x-r:e.x-r-Math.abs(l),y:e.y}),n.push(e);break;case"right":n.push(t),n.push({x:l>0?t.x+r:t.x+r+Math.abs(l),y:t.y}),n.push({x:l>0?e.x+r+Math.abs(l):e.x+r,y:e.y}),n.push(e)}return n}(p[0],p[1],d,n);l=h&&t8(u)?{position:"middle",autoRotate:!1}:Object.assign({position:"start",autoRotate:!1},function(t,e,i,r=0){let n=t.y-e.y,s=t.x-e.x;return"bottom"===i?{dx:s>0?-s/2:Math.abs(s/2),dy:n>0?r:Math.abs(n)+r}:"top"===i?{dx:s>0?-Math.abs(s/2):+Math.abs(s/2),dy:n>0?-(Math.abs(n)+r):-r}:"left"===i?{dx:s>0?-s-r:-r,dy:n>0?-n/2:Math.abs(n/2)}:"right"===i?{dx:s>0?r:Math.abs(s)+r,dy:n>0?-n/2:Math.abs(n/2)}:{}}(p[0],p[1],d,n));let m=ed((null!=(i=null==(e=this._markerComponent)?void 0:e.attribute)?i:{}).label),y=ed(s.label),v=ed(this._spec.label);null==(r=this._markerComponent)||r.setAttributes({points:h?[[f[0],f[1]],[f[1],f[2]],[f[2],f[3]]]:f,label:y.map((t,e)=>{var i,r,n,s;let a=0,o=0,h=null!=(i=l.dx)?i:0,u=null!=(r=l.dy)?r:0,d=null!=(n=v[e])?n:v[0];return en(null==d?void 0:d.refX)&&(a+=d.refX),en(null==d?void 0:d.refY)&&(o+=d.refY),en(null==d?void 0:d.dx)&&(h+=d.dx),en(null==d?void 0:d.dy)&&(u+=d.dy),Object.assign(Object.assign(Object.assign({},t),l),{refX:a,refY:o,dx:h,dy:u,textStyle:Object.assign(Object.assign({},null==(s=m[e])?void 0:s.textStyle),{textAlign:"center",textBaseline:"middle"})})}),limitRect:g,multiSegment:h,mainSegmentIndex:u,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}else null==(n=this._markerComponent)||n.setAttributes(s)}_computeOptions(){let t,e=this._getRelativeDataView(),i=!0,r=!1,n=this._spec,s=this._relativeSeries,{doXProcess:l,doYProcess:a,doXYY1Process:o,doYXX1Process:h,doXYProcess:u,doCoordinatesProcess:d}=Th(n);if(u)t=[this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y}]),this._processSpecByDims([{dim:"x",specValue:n.x1},{dim:"y",specValue:n.y1}])];else if(l)t=[this._processSpecByDims([{dim:"x",specValue:n.x}])];else if(a)t=[this._processSpecByDims([{dim:"y",specValue:n.y}])];else if(o)t=[this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y}]),this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y1}])];else if(h)t=[this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y}]),this._processSpecByDims([{dim:"x",specValue:n.x1},{dim:"y",specValue:n.y}])];else if(d){if(t=this._processSpecCoo(n),i=!1,e=new el(this._option.dataSet,{name:`${this.type}_${this.id}_data`}).parse([s.getViewData()],{type:"dataview"}).transform({type:"markerAggregation",options:t}),n.process&&t8(n.process.x)&&(t=[this._processSpecByDims([{dim:"x",specValue:n.process.x}])],i=!0),n.process&&t8(n.process.y)&&(t=t=[this._processSpecByDims([{dim:"y",specValue:n.process.y}])],i=!0),n.process&&t8(n.process.xy)){let{xField:e,yField:i}=s.getSpec();t={fieldX:e,fieldY:i},r=!0}}else i=!1;return{options:t,needAggr:i,needRegr:r,processData:e}}}Rt.type=rk.markLine,Rt.coordinateType="cartesian",Rt.builtInTheme={markLine:T7};let Re=()=>{iv.registerComponent(Rt.type,Rt),TX()};(0,Tp.O)();class Ri extends TN.X{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},TN.X.defaultAttributes,t)),this.name="arc-segment",this.key="arc-segment",this.isReverseArc=!1}getStartAngle(){let t=this.isReverseArc?this._startAngle+Math.PI/2:this._startAngle-Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}getEndAngle(){let t=this.isReverseArc?this._endAngle-Math.PI/2:this._endAngle+Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}getMainSegmentPoints(){return this._mainSegmentPoints}_computeStartRotate(t){return this.isReverseArc?t+Math.PI:t}_computeEndRotate(t){return this.isReverseArc?t:t+Math.PI}render(){this.removeAllChild(!0),this._reset();let{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:n=!0,radius:s,startAngle:l,endAngle:a,center:o}=this.attribute;if(!n)return;this._startAngle=l,this._endAngle=a,this.isReverseArc=l>a;let h={x:o.x+s*Math.cos(this._startAngle),y:o.y+s*Math.sin(this._startAngle)},u={x:o.x+s*Math.cos(this._endAngle),y:o.y+s*Math.sin(this._endAngle)};this._mainSegmentPoints=[h,u];let d=this._renderSymbol(t,this._mainSegmentPoints,"start"),c=this._renderSymbol(e,this._mainSegmentPoints,"end");this.startSymbol=d,this.endSymbol=c;let p=c0.i.arc(Object.assign({x:o.x,y:o.y,startAngle:l,endAngle:a,innerRadius:s,outerRadius:s},i));p.name=`${this.name}-line`,p.id=this._getNodeId("arc"),(0,c1.Z)(null==r?void 0:r.line)||(p.states=[].concat(r.line)[0]),this.add(p),this.line=p}}Tg(),(0,Tp.O)(),(0,uM.d)();class Rr extends TW{markerAnimate(t){Rr._animate&&this._animationConfig&&Rr._animate(this._line,this._label,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},Rr.defaultAttributes,t)),this.name="markArcLine"}getPointAttrByPosition(t,e){let i,{center:r,radius:n,startAngle:s,endAngle:l}=this.attribute,{refX:a=0,refY:o=0}=e;switch(t){case tA.arcInnerStart:i=s;case tA.arcOuterStart:i=s;break;case tA.arcInnerEnd:i=l;case tA.arcOuterEnd:i=l;break;case tA.center:case tA.arcInnerMiddle:case tA.arcOuterMiddle:default:i=(s+l)/2}return{position:{x:r.x+(n+o)*Math.cos(i)+a*Math.cos(i-Math.PI/2),y:r.y+(n+o)*Math.sin(i)+a*Math.sin(i-Math.PI/2)},angle:i}}getTextStyle(t){return TK[t]}getRotateByAngle(t,e){var i;return t-Math.PI/2+(null!=(i=e.refAngle)?i:0)}createSegment(){let{center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:s,lineStyle:l,state:a}=this.attribute;return new Ri({center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:s,lineStyle:l,state:{line:(0,cQ.Z)({},pe.n0,null==a?void 0:a.line),startSymbol:(0,cQ.Z)({},pe.n0,null==a?void 0:a.lineStartSymbol),endSymbol:(0,cQ.Z)({},pe.n0,null==a?void 0:a.lineEndSymbol)}})}setLineAttributes(){let{center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:s,lineStyle:l,state:a}=this.attribute;this._line&&this._line.setAttributes({center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:s,lineStyle:l,state:{line:(0,cQ.Z)({},pe.n0,null==a?void 0:a.line),startSymbol:(0,cQ.Z)({},pe.n0,null==a?void 0:a.lineStartSymbol),endSymbol:(0,cQ.Z)({},pe.n0,null==a?void 0:a.lineEndSymbol)}})}isValidPoints(){return!0}addMarkLineLabels(t){this._addMarkLabels(t,"mark-common-line-label",Rr.defaultAttributes.label)}updateMarkLineLabels(){this._updateMarkLabels(Rr.defaultAttributes.label)}}Rr.defaultAttributes=TV;class Rn extends T4{constructor(){super(...arguments),this.type=rk.polarMarkLine,this.name=rk.polarMarkLine,this.coordinateType="polar"}_newMarkLineComponent(t){let{doRadiusProcess:e,doRadAngAng1Process:i}=Th(this._spec);return e||i?new Rr(t):new Tq(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,s=this._relativeSeries,l=null!=(t=e.autoRange)&&t,{doAngleProcess:a,doRadiusProcess:o,doAngRadRad1Process:h,doRadAngAng1Process:u,doRadAngProcess:d,doCoordinatesProcess:c}=Th(e),p=[],g={},f={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(a||o||h||u||d){let t=k9(i,r,n,s,l);g=(p=1===t.length?t[0]:t.map(t=>t[0]))[0].radius===p[1].radius?{radius:p[0].radius,startAngle:p[0].angle,endAngle:p[1].angle,center:f}:{points:p.map(t=>ay(f,t.radius,t.angle))}}else c&&(g={points:(p=Tt(i,s,l)).map(t=>ay(f,t.radius,t.angle))});return g}_computeOptions(){let t,e=this._spec,{doAngleProcess:i,doRadiusProcess:r,doAngRadRad1Process:n,doRadAngAng1Process:s,doRadAngProcess:l,doCoordinatesProcess:a}=Th(e),o=this._getRelativeDataView();return l?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius1}])]:s?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:a&&(t=this._processSpecCoo(e)),{options:t,needAggr:!0,needRegr:!1,processData:o}}}Rn.type=rk.polarMarkLine,Rn.coordinateType="polar",Rn.builtInTheme={polarMarkLine:T7};let Rs=()=>{iv.registerComponent(Rn.type,Rn),Rr._animate=TP,TX()};var Rl=i(70830);class Ra extends gz{get orient(){return this._orient}constructor(t,e){super(t,e),this.type=rk.title,this.specKey=rk.title,this.layoutType="normal",this.layoutZIndex=H.Title,this.layoutLevel=z.Title,this._orient="top",this._orient=ex(t.orient)?t.orient:"top"}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}static getSpecInfo(t){return d6(t,this.specKey,rk.title,t=>!1!==t.visible)}_compareSpec(t,e){let i=super._compareSpec(t,e);return(null==e?void 0:e.orient)===(null==t?void 0:t.orient)&&(null==e?void 0:e.visible)===t.visible||(i.reMake=!0),i.change=!0,i.reRender=!0,i}afterSetLayoutStartPoint(t){en(t.x)&&this._titleComponent&&this._titleComponent.setAttribute("x",t.x),en(t.y)&&this._titleComponent&&this._titleComponent.setAttribute("y",t.y),super.afterSetLayoutStartPoint(t)}getBoundsInRect(t){let e={};this.setLayoutRect(t);let i=this._getTitleAttrs();this._createOrUpdateTitleComponent(i),e=this._getTitleLayoutRect();let{x:r,y:n}=this.getLayoutStartPoint();return{x1:r,y1:n,x2:r+e.width,y2:n+e.height}}_getTitleLayoutRect(){let t=this._titleComponent.AABBBounds;return{width:this._spec.width?this._spec.width:en(t.width())?t.width():0,height:this._spec.height?this._spec.height:en(t.height())?t.height():0}}_getTitleAttrs(){var t,e,i,r,n,s,l,a;if(!1===this._spec.visible)return{visible:!1};let o=this.getLayoutRect(),h=eS(this._spec.width,o.width,null,o.width),u=Math.max(Math.min(h,eS(this._spec.maxWidth,o.width,null,o.width),o.width),0),d=Object.assign(Object.assign({},gW(this._spec,["padding"])),{textType:null!=(t=this._spec.textType)?t:"text",text:null!=(e=this._spec.text)?e:"",subtextType:null!=(i=this._spec.subtextType)?i:"text",subtext:null!=(r=this._spec.subtext)?r:"",x:null!=(n=this._spec.x)?n:0,y:null!=(s=this._spec.y)?s:0,height:this._spec.height,minWidth:this._spec.minWidth,maxWidth:u,minHeight:this._spec.minHeight,maxHeight:this._spec.maxHeight,padding:this._spec.innerPadding,align:null!=(l=this._spec.align)?l:"left",verticalAlign:null!=(a=this._spec.verticalAlign)?a:"top",textStyle:Object.assign({width:u,maxLineWidth:u},this._spec.textStyle),subtextStyle:Object.assign({maxLineWidth:u},this._spec.subtextStyle)});return t8(this._spec.width)&&(d.textStyle.width=Math.max(h,o.width),d.subtextStyle.width=d.textStyle.width),d}_createOrUpdateTitleComponent(t){if(this._titleComponent)t5(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{let e=this.getContainer(),i=new Rl.D(t);i.name="title",e.add(i),this._titleComponent=i,i.on("*",(t,e)=>this._delegateEvent(i,t,e))}return this._cacheAttrs=t,this._titleComponent}_getNeedClearVRenderComponents(){return[this._titleComponent]}clear(){super.clear(),this._cacheAttrs=null}}Ra.type=rk.title,Ra.specKey=rk.title,Ra.builtInTheme={title:{padding:{top:4,bottom:20},textStyle:{fontSize:{type:"token",key:"l3FontSize"},lineHeight:{type:"token",key:"l3LineHeight"},fill:{type:"palette",key:"primaryFontColor"}},subtextStyle:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fill:{type:"palette",key:"tertiaryFontColor"}}}};let Ro=()=>{iv.registerComponent(Ra.type,Ra)};function Rh(){Ru._animate=TE}Tg(),(0,CB.M)(),(0,uM.d)();class Ru extends Tv{markerAnimate(t){Ru._animate&&this._animationConfig&&Ru._animate(this._area,this._label,this._animationConfig,t)}getArea(){return this._area}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},Ru.defaultAttributes,t)),this.name="markArea",this.defaultUpdateAnimation=TO,this.defaultExitAnimation=TH}getPointAttrByPosition(t){let{x1:e,x2:i,y1:r,y2:n}=this._area.AABBBounds,s={x:(e+i)/2,y:(r+n)/2};return(t.includes("left")||t.includes("Left"))&&(s.x=e),(t.includes("right")||t.includes("Right"))&&(s.x=i),(t.includes("top")||t.includes("Top"))&&(s.y=r),(t.includes("bottom")||t.includes("Bottom"))&&(s.y=n),s}setLabelPos(t,e){var i;if(this._area){let r=null!=(i=e.position)?i:"middle",n=this.getPointAttrByPosition(r);if(t.setAttributes(Object.assign(Object.assign({},n),{textStyle:Object.assign(Object.assign({},T$[r]),e.textStyle)})),this.attribute.limitRect&&e.confine){let{x:e,y:i,width:r,height:n}=this.attribute.limitRect;Tm(t,{x1:e,y1:i,x2:e+r,y2:i+n})}}}initMarker(t){let{points:e,areaStyle:i,state:r}=this.attribute,n=c0.i.polygon(Object.assign({points:e},i));n.states=(0,cQ.Z)({},pe.n0,null==r?void 0:r.area),n.name="mark-area-polygon",this._area=n,t.add(n),this._addMarkLabels(t,"mark-area-label",Ru.defaultAttributes.label)}updateMarker(){let{points:t,areaStyle:e,state:i}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({points:t},e)),this._area.states=(0,cQ.Z)({},pe.n0,null==i?void 0:i.area)),this._updateMarkLabels(Ru.defaultAttributes.label)}isValidPoints(){let{points:t}=this.attribute;if(!t||t.length<3)return!1;let e=!0;return t.forEach(t=>{(0,uE.Z)(t.x)&&(0,uE.Z)(t.y)||(e=!1)}),e}}Ru.defaultAttributes=TZ,(0,g1.jB)(Ru,Tz);class Rd extends T3{constructor(){super(...arguments),this.specKey="markArea",this.layoutZIndex=H.MarkArea}static _getMarkerCoordinateType(t){let{doAngleProcess:e,doRadiusProcess:i,doRadAngProcess:r}=Tu(t);return"polar"===t.coordinateType||e||i||r?"polar":"cartesian"}_createMarkerComponent(){var t,e,i,r,n,s,l,a;let o=ed(null!=(t=this._spec.label)?t:{}),h={zIndex:this.layoutZIndex,interactive:null==(e=this._spec.interactive)||e,hover:null==(i=this._spec.interactive)||i,select:null==(r=this._spec.interactive)||r,points:[{x:0,y:0}],center:{x:0,y:0},innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,areaStyle:Tl(gd(null==(n=this._spec.area)?void 0:n.style),this._markerData,this._markAttributeContext),clipInRange:null!=(s=this._spec.clip)&&s,label:o.map(t=>Tn(t,this._markerData,this._markAttributeContext)),state:{area:Ts(null==(l=this._spec.area)?void 0:l.state,this._markerData,this._markAttributeContext),label:o.map(t=>Ts(t.state,this._markerData,this._markAttributeContext)),labelBackground:o.map(t=>{var e;return Ts(null==(e=t.labelBackground)?void 0:e.state,this._markerData,this._markAttributeContext)})},animation:null!=(a=this._spec.animation)&&a,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return this._newMarkAreaComponent(h)}_markerLayout(){var t;let e,i=this._spec,r=this._markerData,n=this._startRelativeSeries,s=this._endRelativeSeries,l=this._relativeSeries,a=this._computePointsAttr(),o=this._getRelativeDataView().latestData,h=r?r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData:o;if(i.clip||ed(i.label).some(t=>null==t?void 0:t.confine)){let{minX:t,maxX:i,minY:r,maxY:a}=Tr([n.getRegion(),s.getRegion(),l.getRegion()]);e={x:t,y:r,width:i-t,height:a-r}}if(this._markerComponent){let i=ed(null==(t=this._markerComponent.attribute)?void 0:t.label),r=ed(this._spec.label);this._markerComponent.setAttributes(Object.assign(Object.assign({},a),{label:i.map((t,e)=>{let i=r[e]||{};return Object.assign(Object.assign({},t),{text:i.formatMethod?i.formatMethod(h,o):null==t?void 0:t.text})}),limitRect:e,dx:this._layoutOffsetX,dy:this._layoutOffsetY}))}}_initDataView(){let{doXProcess:t,doYProcess:e,doXYProcess:i,doAngleProcess:r,doRadiusProcess:n,doRadAngProcess:s,doCoordinatesProcess:l}=Tu(this._spec);if(!(t||e||i||r||n||s||l))return null;this._initCommonDataView()}}Rd.specKey="markArea";let Rc={area:{style:{fill:{type:"palette",key:"axisDomainColor",a:.25}}},label:T6()};class Rp extends Rd{constructor(){super(...arguments),this.type=rk.markArea,this.name=rk.markArea,this.coordinateType="cartesian"}_newMarkAreaComponent(t){return new Ru(t)}_computePointsAttr(){var t,e;let i=this._spec,r=this._markerData,n=this._startRelativeSeries,s=this._endRelativeSeries,l=this._relativeSeries,{doXProcess:a,doYProcess:o,doXYProcess:h,doCoordinatesProcess:u}=Tu(i),d=t8(i.positions),c=null!=(t=i.autoRange)&&t,p=null!=(e=i.includeFullBand)&&e,g=[],f=[];if(h){let[t,e]=k6(r,n,s,l,c,p);t&&t.length&&e&&e.length&&(g=[{x:t[0].x,y:e[0].y},t[0],{x:e[0].x,y:t[0].y},e[0]])}else if(a||o){let[t,e]=k6(r,n,s,l,c,p);t&&t.length&&e&&e.length&&(g=[...t,e[1],e[0]])}else u?g=k7(r,l,c,i.coordinatesOffset):d&&(g=Ti(i.positions,l,i.regionRelative));return{points:g}}_computeOptions(){let t,e=this._spec,{doXProcess:i,doYProcess:r,doXYProcess:n,doCoordinatesProcess:s}=Tu(e);return n?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"x",specValue:e.x1},{dim:"y",specValue:e.y1}])]:i?t=[this._processSpecByDims([{dim:"x",specValue:e.x}]),this._processSpecByDims([{dim:"x",specValue:e.x1}])]:r?t=[this._processSpecByDims([{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"y",specValue:e.y1}])]:s&&(t=this._processSpecCoo(e)),{options:t}}}Rp.type=rk.markArea,Rp.coordinateType="cartesian",Rp.builtInTheme={markArea:Rc};let Rg=()=>{iv.registerComponent(Rp.type,Rp),Rh()};Tg(),(0,bu.x)(),(0,uM.d)();class Rf extends Tv{markerAnimate(t){Rf._animate&&this._animationConfig&&Rf._animate(this._area,this._label,this._animationConfig,t)}getArea(){return this._area}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},Rf.defaultAttributes,t)),this.name="markArcArea",this.defaultUpdateAnimation=TO,this.defaultExitAnimation=TH}getPointAttrByPosition(t,e){let i,r,{center:n,innerRadius:s,outerRadius:l,startAngle:a,endAngle:o}=this.attribute,{refX:h=0,refY:u=0}=e;switch(t){case tA.center:i=(s+l)/2,r=(a+o)/2;break;case tA.arcInnerStart:i=s,r=a;break;case tA.arcOuterStart:i=l,r=a;break;case tA.arcInnerEnd:i=s,r=o;break;case tA.arcOuterEnd:i=l,r=o;break;case tA.arcInnerMiddle:i=s,r=(a+o)/2;break;case tA.arcOuterMiddle:i=l,r=(a+o)/2;break;default:i=s,r=(a+o)/2}return{position:{x:n.x+(i+u)*Math.cos(r)+h*Math.cos(r-Math.PI/2),y:n.y+(i+u)*Math.sin(r)+h*Math.sin(r-Math.PI/2)},angle:r}}setLabelPos(t,e){var i;if(this._area){let{position:r="arcInnerMiddle",autoRotate:n}=e,s=this.getPointAttrByPosition(r,e);if(t.setAttributes(Object.assign(Object.assign({},s.position),{angle:n?s.angle-Math.PI/2+(null!=(i=e.refAngle)?i:0):0,textStyle:Object.assign(Object.assign({},TK[r]),e.textStyle)})),this.attribute.limitRect&&e.confine){let{x:e,y:i,width:r,height:n}=this.attribute.limitRect;Tm(t,{x1:e,y1:i,x2:e+r,y2:i+n})}}}initMarker(t){let{center:e,innerRadius:i,outerRadius:r,startAngle:n,endAngle:s,areaStyle:l,state:a}=this.attribute,o=c0.i.arc(Object.assign({x:e.x,y:e.y,innerRadius:i,outerRadius:r,startAngle:n,endAngle:s},l));o.states=(0,cQ.Z)({},pe.n0,null==a?void 0:a.area),o.name="polar-mark-area-area",this._area=o,t.add(o),this._addMarkLabels(t,"mark-area-label",Rf.defaultAttributes.label)}updateMarker(){let{center:t,innerRadius:e,outerRadius:i,startAngle:r,endAngle:n,areaStyle:s,label:l,state:a}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({x:t.x,y:t.y,innerRadius:e,outerRadius:i,startAngle:r,endAngle:n},s)),this._area.states=(0,cQ.Z)({},pe.n0,null==a?void 0:a.area)),this._updateMarkLabels(Rf.defaultAttributes.label)}isValidPoints(){return!0}}Rf.defaultAttributes=TU,(0,g1.jB)(Rf,Tz);class Rm extends Rd{constructor(){super(...arguments),this.type=rk.polarMarkArea,this.name=rk.polarMarkArea,this.coordinateType="polar"}_newMarkAreaComponent(t){let{doRadiusProcess:e,doAngleProcess:i,doRadAngProcess:r}=Tu(this._spec);return i||e||r?new Rf(t):new Ru(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,s=this._relativeSeries,{doAngleProcess:l,doRadiusProcess:a,doRadAngProcess:o,doCoordinatesProcess:h}=Tu(e),u=null!=(t=e.autoRange)&&t,d={},c={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(l||a||o){let t=k9(i,r,n,s,u);o?d={innerRadius:t[0][0].radius,outerRadius:t[1][0].radius,startAngle:t[0][0].angle,endAngle:t[1][0].angle,center:c}:l?d={innerRadius:0,outerRadius:Math.abs(t[0][0].radius),startAngle:t[0][1].angle,endAngle:t[1][1].angle,center:c}:a&&(d={innerRadius:t[0][0].radius,outerRadius:t[1][0].radius,startAngle:t[0][0].angle,endAngle:t[1][1].angle,center:c})}else h&&(d={points:Tt(i,s,u).map(t=>ay(c,t.radius,t.angle))});return d}_computeOptions(){let t,e=this._spec,{doAngleProcess:i,doRadiusProcess:r,doRadAngProcess:n,doCoordinatesProcess:s}=Tu(e);return n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"radius",specValue:e.radius1}])]:s&&(t=this._processSpecCoo(e)),{options:t}}}Rm.type=rk.polarMarkArea,Rm.coordinateType="polar",Rm.builtInTheme={polarMarkArea:Rc};let Ry=()=>{iv.registerComponent(Rm.type,Rm),Rf._animate=TI,Rh()};var Rv=i(16018);class Rb extends pN.m{constructor(t){super(t)}}(to=tk||(tk={})).OnPlay="onPlay",to.OnPause="onPause",to.OnForward="onForward",to.OnBackward="onBackward",(th=tT||(tT={})).Start="start",th.Pause="pause",th.Forward="forward",th.Backward="backward";class R_ extends g3.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},R_.defaultAttributes,t)),this._isPaused=!0,this.updateAttributes=()=>{this._startAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -73.1429 161.4994 a 48.7619 48.7619 0 0 1 25.9901 7.5093 l 201.7524 127.1223 a 48.7619 48.7619 0 0 1 0.3657 82.2613 l -201.7524 129.6335 A 48.7619 48.7619 0 0 1 292.5952 540.1838 v -256.7314 a 48.7619 48.7619 0 0 1 48.7619 -48.7619 z m 24.381 92.9402 v 167.9116 l 131.9497 -84.7726 L 365.7381 327.6063 z"},R_.defaultControllerAttr),{visible:this.attribute.start.visible}),this.attribute.start.style)},this._pauseAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -48.7619 195.0476 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z m 158.4762 0 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z"},R_.defaultControllerAttr),{visible:this.attribute.pause.visible}),this.attribute.pause.style)},this._forwardAttr={style:Object.assign(Object.assign(Object.assign({},R_.defaultControllerAttr),{visible:this.attribute.forward.visible}),this.attribute.forward.style)},this._backwardAttr={style:Object.assign(Object.assign(Object.assign({},R_.defaultControllerAttr),{visible:this.attribute.backward.visible}),this.attribute.backward.style)},this.updateLayout()},this.updateLayout=()=>{var t,e,i,r;this._layout=this.attribute.layout,"horizontal"===this._layout?(this._backwardAttr.style.symbolType=null!=(t=this._backwardAttr.style.symbolType)?t:"M 521.29 734.276 L 230.929 448.019 L 521.29 161.762 c 37.685 -37.153 38.003 -97.625 0.707 -134.384 c -37.297 -36.758 -98.646 -36.435 -136.331 0.718 l -357.43 352.378 c -0.155 0.153 -0.297 0.314 -0.451 0.468 c -0.084 0.082 -0.172 0.157 -0.256 0.239 c -18.357 18.092 -27.581 41.929 -27.743 65.902 c -0.004 0.311 -0.017 0.623 -0.018 0.934 c 0.001 0.316 0.014 0.632 0.018 0.948 c 0.165 23.97 9.389 47.803 27.743 65.892 c 0.083 0.082 0.171 0.157 0.255 0.239 c 0.154 0.154 0.296 0.315 0.452 0.468 l 357.43 352.378 c 37.685 37.153 99.034 37.476 136.331 0.718 c 37.297 -36.758 36.979 -97.231 -0.707 -134.384 z",this._forwardAttr.style.symbolType=null!=(e=this._forwardAttr.style.symbolType)?e:"M 30 163 L 320.361 449.257 L 30 735.514 c -37.685 37.153 -38.003 97.625 -0.707 134.384 c 37.297 36.758 98.646 36.435 136.331 -0.718 l 357.43 -352.378 c 0.155 -0.153 0.297 -0.314 0.451 -0.468 c 0.084 -0.082 0.172 -0.157 0.256 -0.239 c 18.357 -18.092 27.581 -41.929 27.743 -65.902 c 0.004 -0.311 0.017 -0.623 0.018 -0.934 c -0.001 -0.316 -0.014 -0.632 -0.018 -0.948 c -0.165 -23.97 -9.389 -47.803 -27.743 -65.892 c -0.083 -0.082 -0.171 -0.157 -0.255 -0.239 c -0.154 -0.154 -0.296 -0.315 -0.452 -0.468 l -357.43 -352.378 c -37.685 -37.153 -99.034 -37.476 -136.331 -0.718 c -37.297 36.758 -36.979 97.231 0.707 134.384 z"):"vertical"===this._layout&&(this._backwardAttr.style.symbolType=null!=(i=this._backwardAttr.style.symbolType)?i:"m 161.724 521.29 l 286.257 -290.361 l 286.257 290.361 c 37.153 37.685 97.625 38.003 134.384 0.707 c 36.758 -37.297 36.435 -98.646 -0.718 -136.331 l -352.378 -357.43 c -0.153 -0.155 -0.314 -0.297 -0.468 -0.451 c -0.082 -0.084 -0.157 -0.172 -0.239 -0.256 c -18.092 -18.357 -41.929 -27.581 -65.902 -27.743 c -0.311 -0.004 -0.623 -0.017 -0.934 -0.018 c -0.316 0.001 -0.632 0.014 -0.948 0.018 c -23.97 0.165 -47.803 9.389 -65.892 27.743 c -0.082 0.083 -0.157 0.171 -0.239 0.255 c -0.154 0.154 -0.315 0.296 -0.468 0.452 l -352.378 357.43 c -37.153 37.685 -37.476 99.034 -0.718 136.331 c 36.758 37.297 97.231 36.979 134.384 -0.707 z",this._forwardAttr.style.symbolType=null!=(r=this._forwardAttr.style.symbolType)?r:"M 734.276 28.71 L 448.019 319.071 L 161.762 28.71 c -37.153 -37.685 -97.625 -38.003 -134.384 -0.707 c -36.758 37.297 -36.435 98.646 0.718 136.331 l 352.378 357.43 c 0.153 0.155 0.314 0.297 0.468 0.451 c 0.082 0.084 0.157 0.172 0.239 0.256 c 18.092 18.357 41.929 27.581 65.902 27.743 c 0.311 0.004 0.623 0.017 0.934 0.018 c 0.316 -0.001 0.632 -0.014 0.948 -0.018 c 23.97 -0.165 47.803 -9.389 65.892 -27.743 c 0.082 -0.083 0.157 -0.171 0.239 -0.255 c 0.154 -0.154 0.315 -0.296 0.468 -0.452 l 352.378 -357.43 c 37.153 -37.685 37.476 -99.034 0.718 -136.331 c -36.758 -37.297 -97.231 -36.979 -134.384 0.707 z")},this._initPlay=()=>{(0,aY.Z)(this._playController)&&(this._playController=new Rb(Object.assign({},this._startAttr.style)),this.add(this._playController))},this._initBackward=()=>{(0,aY.Z)(this._backwardController)&&(this._backwardController=new Rb(Object.assign({},this._backwardAttr.style)),this.add(this._backwardController))},this._initForward=()=>{(0,aY.Z)(this._forwardController)&&(this._forwardController=new Rb(Object.assign({},this._forwardAttr.style)),this.add(this._forwardController))},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._playController.addEventListener("pointerdown",t=>{t.stopPropagation(),!0===this._isPaused?this.play():this.pause()}),this._backwardController.addEventListener("pointerdown",t=>{t.stopPropagation(),this.backward()}),this._forwardController.addEventListener("pointerdown",t=>{t.stopPropagation(),this.forward()}))},this.renderPlay=()=>{this._isPaused?this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._startAttr.style)):this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._pauseAttr.style))},this.renderBackward=()=>{this._backwardController.setAttributes(this._backwardAttr.style)},this.renderForward=()=>{this._forwardController.setAttributes(this._forwardAttr.style)},this.play=()=>{this._dispatchEvent(tk.OnPlay)},this.pause=()=>{this._dispatchEvent(tk.OnPause)},this.forward=()=>{this._dispatchEvent(tk.OnForward)},this.backward=()=>{this._dispatchEvent(tk.OnBackward)},this.togglePlay=()=>{this._playController.setAttributes(this._startAttr.style),this._isPaused=!0},this.togglePause=()=>{this._playController.setAttributes(this._pauseAttr.style),this._isPaused=!1},this.updateAttributes(),this._initPlay(),this._initBackward(),this._initForward(),this._initEvents()}render(){this.updateAttributes(),this.renderPlay(),this.renderBackward(),this.renderForward()}}R_.defaultControllerAttr={visible:!0,x:0,y:0,size:20,fill:"#91caff",pickMode:"imprecise",cursor:"pointer"},R_.defaultAttributes={[tT.Start]:{},[tT.Pause]:{},[tT.Backward]:{},[tT.Forward]:{}};let Rx={visible:!0,style:{x:0,y:0,dx:0,dy:0,size:20},order:0,space:10},RC=[200,10];(tu=tR||(tR={})).Default="default",tu.Reverse="reverse";let Rw=({direction:t,maxIndex:e,dataIndex:i})=>t===tR.Default&&i===e,RS=({direction:t,minIndex:e,dataIndex:i})=>t===tR.Reverse&&i===e,RA=({direction:t,maxIndex:e,minIndex:i,dataIndex:r})=>Rw({direction:t,maxIndex:e,dataIndex:r})||RS({direction:t,minIndex:i,dataIndex:r}),RM=({direction:t,minIndex:e,dataIndex:i})=>t===tR.Default&&i===e,Rk=({direction:t,maxIndex:e,dataIndex:i})=>t===tR.Reverse&&i===e,RT=({direction:t,maxIndex:e,minIndex:i,dataIndex:r})=>RM({direction:t,minIndex:i,dataIndex:r})||Rk({direction:t,maxIndex:e,dataIndex:r}),RR=t=>"top"===t||"bottom"===t,RB=(t,e,i,r)=>"default"===t?Math.min(e+1,r):Math.max(e-1,i);class RP extends g3.k{getMinIndex(){return this._minIndex}getMaxIndex(){return this._maxIndex}getDataIndex(){return this._dataIndex}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},RP.defaultAttributes,t)),this._data=[],this._dataIndex=0,this._layoutInfo={},this._updateSliderAttrs=()=>{var t,e;let i;(0,uE.Z)(this._handlerStyle.size)?i=this._handlerStyle.size:this._handlerStyle.size&&this._handlerStyle.size.length&&(i=(0,g2.Fp)(this._handlerStyle.size[0],this._handlerStyle.size[1]));let r={visible:this._sliderVisible,min:this._minIndex,max:this._maxIndex,value:this._dataIndex,railWidth:this._railStyle.width,railHeight:this._railStyle.height,railStyle:this._railStyle,trackStyle:this._trackStyle,handlerSize:(0,uE.Z)(i)?i:void 0,handlerStyle:this._handlerStyle,dy:this.attribute.slider.dy,dx:this.attribute.slider.dx,slidable:!0,range:!1,handlerText:{visible:!1},startText:{visible:!1},endText:{visible:!1},disableTriggerEvent:this.attribute.disableTriggerEvent};if(RR(this._orient)){let e=Math.max(0,this._layoutInfo.slider.size),i=null!=(t=this._railStyle.height)?t:RC["1"];r.layout="horizontal",r.railHeight=i,r.railWidth=e,r.x=this._layoutInfo.slider.x,r.y=this._layoutInfo.slider.y}else{let t=Math.max(0,this._layoutInfo.slider.size),i=null!=(e=this._railStyle.width)?e:RC["1"];r.layout="vertical",r.railWidth=i,r.railHeight=t,r.x=this._layoutInfo.slider.x,r.y=this._layoutInfo.slider.y}return r},this._initSlider=()=>{let t=this._updateSliderAttrs();this._slider=new Rv.i(t),this._sliderVisible&&this.add(this._slider)},this._updateControllerAttrs=()=>{let t={start:this._start,pause:this._pause,forward:this._forward,backward:this._backward,disableTriggerEvent:this.attribute.disableTriggerEvent};return t.layout=RR(this._orient)?"horizontal":"vertical",t.start=Object.assign(Object.assign({},t.start),{style:Object.assign(Object.assign({},t.start.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),t.pause=Object.assign(Object.assign({},t.pause),{style:Object.assign(Object.assign({},t.pause.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),t.backward=Object.assign(Object.assign({},t.backward),{style:Object.assign(Object.assign({},t.backward.style),{x:this._layoutInfo.backward.x,y:this._layoutInfo.backward.y})}),t.forward=Object.assign(Object.assign({},t.forward),{style:Object.assign(Object.assign({},t.forward.style),{x:this._layoutInfo.forward.x,y:this._layoutInfo.forward.y})}),t},this._initController=()=>{let t=this._updateControllerAttrs();this._controller=new R_(t),this._controllerVisible&&this.add(this._controller)},this._initAttributes(),this._initDataIndex(),this._initLayoutInfo(),this._initController(),this._initSlider()}_initAttributes(){this._size=this.attribute.size,this._orient=this.attribute.orient,this._data=this.attribute.data,this._minIndex=0,this._maxIndex=this._data.length-1;let{slider:t={},controller:e={}}=this.attribute;this._sliderVisible=t.visible,this._railStyle=Object.assign({},t.railStyle),this._trackStyle=Object.assign({},t.trackStyle),this._handlerStyle=Object.assign({},t.handlerStyle),this._controllerVisible=e.visible,this._start=Object.assign({},e.start),this._pause=Object.assign({},e.pause),this._forward=Object.assign({},e.forward),this._backward=Object.assign({},e.backward)}_initDataIndex(){var t;this._dataIndex=null!=(t=this.attribute.dataIndex)?t:0}_initLayoutInfo(){var t,e,i;let r=[this._start,this._backward,this._forward].sort((t,e)=>t.order-e.order),n=r.filter(t=>"end"!==t.position),s=r.filter(t=>"end"===t.position),l=null!=(t=RR(this._orient)?this._railStyle.height:this._railStyle.width)?t:RC["1"],a=r.reduce((t,e)=>{let i=e.style.size,r=(0,aP.Z)(i)?i:(0,g2.Fp)(i[0],i[1]);return t+e.space+r},0),o=this._sliderVisible?(RR(this._orient)?null==(e=this._size)?void 0:e.width:null==(i=this._size)?void 0:i.height)-a:0,h=o-this.attribute.slider.space,u=n.reduce((t,e)=>{let{key:i,space:r,style:{size:n}}=e,s=(0,aP.Z)(n)?n:(0,g2.Fp)(n[0],n[1]);return this._layoutInfo[i]=Object.assign(Object.assign({},this._layoutInfo[i]),{size:s,x:RR(this._orient)?t+r:(this._size.width-s)/2,y:RR(this._orient)?(this._size.height-s)/2:t+r}),t+r+s},0);this._layoutInfo.slider=Object.assign(Object.assign({},this._layoutInfo.slider),{size:h,x:RR(this._orient)?u+this.attribute.slider.space:(this._size.width-l)/2,y:RR(this._orient)?(this._size.height-l)/2:u+this.attribute.slider.space}),s.reduce((t,e)=>{let{key:i,space:r,style:{size:n}}=e,s=(0,aP.Z)(n)?n:(0,g2.Fp)(n[0],n[1]);return this._layoutInfo[i]=Object.assign(Object.assign({},this._layoutInfo[i]),{size:s,x:RR(this._orient)?t+r:(this._size.width-s)/2,y:RR(this._orient)?(this._size.height-s)/2:t+r}),t+r+s},u+o)}render(){this._initLayoutInfo(),this.renderSlider(),this.renderController()}renderSlider(){let t=this._updateSliderAttrs();this._slider.setAttributes(t)}renderController(){let t=this._updateControllerAttrs();this._controller.setAttributes(t)}dispatchCustomEvent(t,e){this._dispatchEvent(t,{eventType:t,index:e,value:this._data[e]})}}RP.defaultAttributes={visible:!0,data:[],interval:1e3,orient:"bottom",align:"center",size:{height:20,width:300},slider:{visible:!0,space:10,dx:0,dy:0,railStyle:{cornerRadius:5},trackStyle:{},handlerStyle:{}},controller:{visible:!0,start:Object.assign(Object.assign({},Rx),{key:"start",position:"start",space:0}),pause:Object.assign(Object.assign({},Rx),{key:"pause",position:"start"}),forward:Object.assign(Object.assign({},Rx),{key:"forward",position:"end"}),backward:Object.assign(Object.assign({},Rx),{key:"backward",position:"start"})}},(td=tB||(tB={})).change="change",td.play="play",td.pause="pause",td.backward="backward",td.forward="forward",td.end="end",td.OnChange="change",td.OnPlay="play",td.OnPause="pause",td.OnBackward="backward",td.OnForward="forward",td.OnEnd="end";var RE=i(66542);function RI(){(0,RE.d)(),(0,op.M)(),(0,pj.k)()}RI();class RL extends RP{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},t)),this._activeIndex=-1,this._isReachEnd=!1,this._initAttributes=()=>{var t,e,i;super._initAttributes(),this._alternate=null!=(t=this.attribute.alternate)&&t,this._interval=null!=(e=this.attribute.interval)?e:1e3,this._direction=null!=(i=this.attribute.direction)?i:tR.Default},this._initDataIndex=()=>{var t;this._dataIndex=(0,aY.Z)(this.attribute.dataIndex)?"default"===this._direction?this._minIndex:this._maxIndex:null!=(t=this.attribute.dataIndex)?t:0,this._slider.setAttribute("value",this._dataIndex)},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(tk.OnPlay,t=>{t.stopPropagation(),this.play()}),this._controller.addEventListener(tk.OnPause,t=>{t.stopPropagation(),this.pause()}),this._controller.addEventListener(tk.OnForward,t=>{t.stopPropagation(),this.forward()}),this._controller.addEventListener(tk.OnBackward,t=>{t.stopPropagation(),this.backward()}),this._slider.addEventListener("change",t=>{let e=Math.floor(t.detail.value)+.5;this._dataIndex=t.detail.value>=e?Math.ceil(t.detail.value):Math.floor(t.detail.value),this._slider.setValue(this._dataIndex),this.dispatchCustomEvent(tB.change)}))},this.play=()=>{this._isPlaying||1!==this._data.length&&(this._controller.togglePause(),this._isPlaying=!0,(RA({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction})||RT({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction}))&&(this._direction===tR.Default?this._updateDataIndex(this._minIndex):this._updateDataIndex(this._maxIndex)),this.dispatchCustomEvent(tB.play),this._isReachEnd=!1,this._tickTime=Date.now(),this._rafId=ea.rF.getRequestAnimationFrame()(this._play.bind(this,!0)))},this._play=t=>{let e=Date.now();if(this._isReachEnd&&e-this._tickTime>=this._interval)return this._isReachEnd=!1,void this._playEnd();t&&this._activeIndex!==this._dataIndex?(this.dispatchCustomEvent(tB.change),this._activeIndex=this._dataIndex):e-this._tickTime>=this._interval&&(this._tickTime=e,this._updateDataIndex(RB(this._direction,this._dataIndex,this._minIndex,this._maxIndex)),this._activeIndex=this._dataIndex,this.dispatchCustomEvent(tB.change)),("default"===this._direction&&this._dataIndex>=this._maxIndex||"reverse"===this._direction&&this._dataIndex<=this._minIndex)&&(this._isReachEnd=!0),this._rafId=ea.rF.getRequestAnimationFrame()(this._play.bind(this,!1))},this._updateDataIndex=t=>{this._dataIndex=t,this._slider.setValue(this._dataIndex)},this._playEnd=()=>{this._isPlaying=!1,this._controller.togglePlay(),ea.rF.getCancelAnimationFrame()(this._rafId),this._activeIndex=-1,this.dispatchCustomEvent(tB.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,ea.rF.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(tB.pause))},this.backward=()=>{let t,{loop:e=!1}=this.attribute;t=e?this._dataIndex-1<this._minIndex?this._maxIndex:this._dataIndex-1:Math.max(this._dataIndex-1,this._minIndex),this._updateDataIndex(t),this.dispatchCustomEvent(tB.change),this.dispatchCustomEvent(tB.backward)},this.forward=()=>{let t,{loop:e=!1}=this.attribute;t=e?this._dataIndex+1>this._maxIndex?this._minIndex:this._dataIndex+1:Math.min(this._dataIndex+1,this._maxIndex),this._updateDataIndex(t),this.dispatchCustomEvent(tB.change),this.dispatchCustomEvent(tB.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}setAttributes(t,e){super.setAttributes(t,e),this._initAttributes()}dispatchCustomEvent(t){super.dispatchCustomEvent(t,this._dataIndex)}}RI();class RF extends RP{constructor(t){super(t),this._isPlaying=!1,this._startTime=Date.now(),this._initAttributes=()=>{var t;super._initAttributes(),this._maxIndex=this._data.length,this._slider.setAttribute("max",this._maxIndex),this._isPlaying=!1,this._elapsed=0,this._interval=null!=(t=this.attribute.interval)?t:1e3;let e=this._data.length;this.attribute.totalDuration&&this._data.length?(this._totalDuration=this.attribute.totalDuration,this._interval=this._totalDuration/(null!=e?e:1)):(this._totalDuration=this._interval*e,this._interval=this.attribute.interval)},this._initDataIndex=()=>{var t;this._dataIndex=null!=(t=this.attribute.dataIndex)?t:this._minIndex},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(tk.OnPlay,t=>{t.stopPropagation(),this.play()}),this._controller.addEventListener(tk.OnPause,t=>{t.stopPropagation(),this.pause()}),this._controller.addEventListener(tk.OnForward,t=>{t.stopPropagation(),this.forward()}),this._controller.addEventListener(tk.OnBackward,t=>{t.stopPropagation(),this.backward()}),this._slider.addEventListener("change",t=>{var e;t.stopPropagation();let i=null==(e=t.detail)?void 0:e.value,r=i/this._maxIndex;this._elapsed=r*this._totalDuration,this._startTime=Date.now()-this._elapsed,this._dispatchChange(i)}))},this._getSliderValue=()=>Math.min(this._elapsed/this._totalDuration*this._maxIndex,this._maxIndex),this._updateSlider=()=>{let t=this._getSliderValue();this._dataIndex=Math.floor(t),this._slider.setValue(Math.min(t,this._maxIndex)),this._dispatchChange(Math.floor(t))},this._dispatchChange=t=>{let e=Math.floor(t);e!==this._activeIndex&&(this._dataIndex=e,this._activeIndex=e,e!==this._maxIndex&&this.dispatchCustomEvent(tB.change))},this.play=()=>{var t,e,i,r;return t=this,e=void 0,i=void 0,r=function*(){this._isPlaying||(this._controller.togglePause(),this._isPlaying=!0,this._elapsed>=this._totalDuration&&(this._elapsed=0),this._startTime=Date.now()-this._elapsed,this.dispatchCustomEvent(tB.play),this._rafId=ea.rF.getRequestAnimationFrame()(this._play.bind(this)))},new(i||(i=Promise))(function(n,s){function l(t){try{o(r.next(t))}catch(t){s(t)}}function a(t){try{o(r.throw(t))}catch(t){s(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(l,a)}o((r=r.apply(t,e||[])).next())})},this._play=()=>{this._elapsed=Date.now()-this._startTime;let t=this._getSliderValue();this._updateSlider(),t>=this._maxIndex?this._playEnd():this._rafId=ea.rF.getRequestAnimationFrame()(this._play.bind(this))},this._playEnd=()=>{this._isPlaying=!1,ea.rF.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(tB.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,this._elapsed=Date.now()-this._startTime,ea.rF.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(tB.pause))},this.backward=()=>{let t=Date.now(),e=+this._interval,i=this._elapsed-e;i<=0?(this._elapsed=0,this._startTime=t):(this._elapsed=i,this._startTime=this._startTime+this._interval),this._updateSlider(),this.dispatchCustomEvent(tB.backward)},this.forward=()=>{let t=Date.now(),e=+this._interval,i=this._elapsed+e;i>=this._totalDuration?(this._startTime=t-this._totalDuration,this._elapsed=this._totalDuration):(this._startTime=this._startTime-e,this._elapsed=i),this._updateSlider(),this.dispatchCustomEvent(tB.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}dispatchCustomEvent(t){super.dispatchCustomEvent(t,this._dataIndex)}render(){super.render()}}let RO=t=>gd(Object.assign({},t)),RD=t=>gd(Object.assign({},t)),RH=t=>Object.assign(Object.assign({},t),{style:Object.assign({},gd(t.style))}),Rz=t=>{var e,i,r,n,s,l,a,o,h,u,d,c,p,g,f;let m=RO(null!=(i=null==(e=null==t?void 0:t.slider)?void 0:e.trackStyle)?i:{}),y=RO(null!=(n=null==(r=null==t?void 0:t.slider)?void 0:r.railStyle)?n:{}),v=RD(null!=(l=null==(s=null==t?void 0:t.slider)?void 0:s.handlerStyle)?l:{}),b=RH(null!=(o=null==(a=null==t?void 0:t.controller)?void 0:a.start)?o:{}),_=RH(null!=(u=null==(h=null==t?void 0:t.controller)?void 0:h.pause)?u:{}),x=RH(null!=(c=null==(d=null==t?void 0:t.controller)?void 0:d.backward)?c:{}),C=RH(null!=(g=null==(p=null==t?void 0:t.controller)?void 0:p.forward)?g:{}),w=Object.assign(Object.assign({},t),{direction:t.direction,interval:t.interval,visible:t.visible,orient:null!=(f=t.orient)?f:"bottom",slider:Object.assign(Object.assign({},t.slider),{trackStyle:m,railStyle:y,handlerStyle:v}),controller:Object.assign(Object.assign({},t.controller),{start:b,pause:_,backward:x,forward:C})});return t.visible||(w.controller.visible=!1,w.slider.visible=!1),w},RW=(t,e)=>Object.assign(Object.assign({},Rz(t)),{data:e,type:"continuous"}),RN=(t,e)=>Object.assign(Object.assign({},Rz(t)),{data:e,type:"discrete"}),Rj=t=>"left"===t||"right"===t,RG=t=>"top"===t||"bottom"===t;class RV extends gz{constructor(){super(...arguments),this.layoutZIndex=H.Player,this.layoutLevel=z.Player,this.specKey="player",this.type=rk.player,this._orient="bottom",this._getPlayerAttrs=()=>{var t,e,i,r,n,s;let l=this._spec.type,a={size:{width:this._width,height:this._height},dx:null!=(t=this._spec.dx)?t:0+this._dx,dy:null!=(e=this._spec.dy)?e:0+this._dy};return"discrete"===l?Object.assign(Object.assign(Object.assign({},RN(this._spec,this._specs)),a),{disableTriggerEvent:this._option.disableTriggerEvent,loop:null==(r=null==(i=this._spec)?void 0:i.loop)||r}):Object.assign(Object.assign(Object.assign({},RW(this._spec,this._specs)),a),{disableTriggerEvent:this._option.disableTriggerEvent,loop:null==(s=null==(n=this._spec)?void 0:n.loop)||s})},this._createOrUpdatePlayerComponent=()=>{let t=Object.assign({},this._getPlayerAttrs()),e=this.getContainer();this._playerComponent?t5(t,this._cacheAttrs)||(this._cacheAttrs=t,this._playerComponent.setAttributes(t),this._playerComponent._initAttributes(),this._playerComponent.render()):("discrete"===t.type?this._playerComponent=new RL(t):this._playerComponent=new RF(t),this._cacheAttrs=t,this._playerComponent.name="player",e.add(this._playerComponent),this._initEvent())},this._maxSize=()=>{var t,e,i,r,n,s,l,a,o;return Math.max(...ed(null==(e=null==(t=this._spec.controller.start)?void 0:t.style)?void 0:e.size),...ed(null==(r=null==(i=this._spec.controller.pause)?void 0:i.style)?void 0:r.size),...ed(null==(s=null==(n=this._spec.controller.backward)?void 0:n.style)?void 0:s.size),...ed(null==(a=null==(l=this._spec.controller.forward)?void 0:l.style)?void 0:a.size),null!=(o=Rj(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)?o:10)},this._sliderExceededSize=()=>{var t,e,i,r,n,s,l,a,o;let h=null!=(t=Rj(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)?t:10,u=Math.max(...ed(null==(i=null==(e=this._spec.controller.start)?void 0:e.style)?void 0:i.size),...ed(null==(n=null==(r=this._spec.controller.pause)?void 0:r.style)?void 0:n.size),...ed(null==(l=null==(s=this._spec.controller.backward)?void 0:s.style)?void 0:l.size),...ed(null==(o=null==(a=this._spec.controller.forward)?void 0:a.style)?void 0:o.size));return h>=u?h-u:0},this._initEvent=()=>{this._option.disableTriggerEvent||(this._option.globalInstance.on(rI.rendered,()=>{var t;(null==(t=this._spec)?void 0:t.auto)&&(this._playerComponent.pause(),this._playerComponent.play())}),this._playerComponent.addEventListener(tB.end,()=>{var t;this.event.emit(rI.playerEnd,{model:this}),this._alternate&&"discrete"===this._spec.type&&(this._direction="default"===this._direction?"reverse":"default",this._playerComponent.setAttributes({direction:this._direction,dataIndex:"reverse"===this._direction?this._specs.length-2:1})),(null==(t=this._spec)?void 0:t.loop)&&this._playerComponent.play()}),this._playerComponent.addEventListener(tB.change,t=>{let{index:e}=t.detail;this.changePlayerIndex(e)}),this._playerComponent.addEventListener(tB.backward,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(rI.playerBackward,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(tB.forward,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(rI.playerForward,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(tB.play,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(rI.playerPlay,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(tB.pause,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(rI.playerPause,{model:this,value:{spec:i,index:e,specs:this._specs}})}))}}get orient(){return this._orient}set layoutOrient(t){this._orient=t}setAttrFromSpec(){var t,e,i,r,n,s,l,a;super.setAttrFromSpec(),this._orient=null!=(t=this._spec.orient)?t:"bottom",this._specs=null!=(e=this._spec.specs)?e:[],this._direction=null!=(i=this._spec.direction)?i:"default",this._alternate=null!=(r=this._spec.alternate)&&r,this._dx=null!=(n=this._spec.dx)?n:0,this._dy=null!=(s=this._spec.dy)?s:0,this._position=null!=(l=this._spec.position)?l:"middle",this._visible=null==(a=this._spec.visible)||a}afterSetLayoutStartPoint(t){if(super.afterSetLayoutStartPoint(t),en(t.x)){let e=Rj(this._orient)?t.x+this._sliderExceededSize()/2:t.x;this._playerComponent&&this._playerComponent.setAttribute("x",e)}if(en(t.y)){let e=RG(this._orient)?t.y+this._sliderExceededSize()/2:t.y;this._playerComponent&&this._playerComponent.setAttribute("y",e)}}getBoundsInRect(t,e){this._width=this._computeWidth(t),this._height=this._computeHeight(t),this._dx=this._computeDx(e),this._dy=this._computeDy(e);let i=this._computeLayoutRect(t,this._width,this._height);return this._createOrUpdatePlayerComponent(),i}_getNeedClearVRenderComponents(){return[this._playerComponent]}_computeLayoutRect(t,e,i){if(!1===this._visible)return{x1:0,x2:0,y1:0,y2:0};switch(this._orient){case"top":case"left":return{x1:0,y1:0,x2:e,y2:i};case"right":return{x1:t.width-e,y1:0,x2:t.width,y2:t.height};default:return{x1:0,y1:t.height-i,x2:t.width,y2:t.height}}}_computeWidth(t){return tG(this._spec.width)?Math.min(t.width,Number(this._spec.width)):Rj(this._orient)?this._maxSize():t.width}_computeHeight(t){return tG(this._spec.height)?(this._height=this._spec.height,Math.min(t.height,Number(this._spec.height))):RG(this._orient)?this._maxSize():t.height}_computeDx(t){return Rj(this._orient)||"start"===this._position?0:"middle"===this._position?(t.width-this._width)/2:t.width-this._width}_computeDy(t){return RG(this._orient)||"start"===this._position?0:"middle"===this._position?(t.height-this._height)/2:t.height-this._height}changePlayerIndex(t){let e=this._specs[t];this._option.globalInstance.updateFullData(e.data),this.event.emit(rI.playerChange,{model:this,value:{spec:e,index:t,specs:this._specs}})}}RV.builtInTheme={player:{visible:!0,position:"start",padding:{top:20,bottom:20},slider:{space:10,trackStyle:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.8},railStyle:{fill:{type:"palette",key:"sliderRailColor"}},handlerStyle:{size:15,stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fill:{type:"palette",key:"playerControllerColor"}}},controller:{start:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},pause:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},backward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},forward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}}}}},RV.specKey="player",RV.type=rk.player;let RZ=()=>{iv.registerComponent(RV.type,RV)};class RU extends gz{constructor(t,e){super(t,e),this.type=rk.label,this.name=rk.label,this.layoutType="none",this.layoutZIndex=H.Label,this._regions=e.getRegionsInIndex(e.regionIndexes)}_interactiveConfig(t){let{interactive:e}=t,i={hover:!1,select:!1,state:t.state};if(!0!==e)return i;let{hover:r,select:n}=this._option.getChart().getSpec();return!1===r&&!1===r.enable||(i.hover=!0),!1===n&&!1===n.enable||(i.select=!0),i}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reRender=!0,t5(e,t)||(i.reMake=!0),i}_getDataLabelType(t,e){let i=t.type;return"line"===i||"area"===i?null!=e?e:"line-data":"rect"===i?"rect":"arc"===i?"arc":"symbol"===i||"cell"===i?"symbol":t.setDataLabelType?t.setDataLabelType():""}_setTransformOfComponent(t,e){t.setAttributeTransform(({labelStyle:t,size:i,itemEncoder:r})=>{let n=i(),s=e9({type:"palette",key:"secondaryFontColor"},this.getColorScheme());return{dataLabels:ed(e).map((e,i)=>{let l=t(i),a=[],o=e.getGraphics();if(o)return l.data&&l.data.length?l.data.forEach((t,e)=>{if(o[e]){let e=r(t,{labelIndex:i});er(e.fill)&&(e.fill=s),er(e.data)&&(e.data=t),a.push(e)}}):o.forEach(t=>{let{data:e,diffState:n}=t.context;n!==N.exit&&e.forEach((t,{})=>{let e=r(t,{labelIndex:i});er(e.fill)&&(e.fill=s),er(e.data)&&(e.data=t),a.push(e)})}),t1(l.overlap)&&er(l.overlap.size)&&(l.overlap.size=Object.assign({},n)),Object.assign(Object.assign({smartInvert:!1,baseMarkGroupName:e.getProductId(),getBaseMarks:()=>o},l),{type:this._getDataLabelType(e,l.type),data:a})}),size:n}})}getVRenderComponents(){let t=[];return this.getMarks().forEach(e=>{let i=e.getComponent();i&&t.push(i)}),t}clear(){super.clear(),this.getMarks().forEach(t=>{t&&t.clearComponent()})}}RU.type=rk.label;class RK extends _R{constructor(){super(...arguments),this.skipEncode=!1}getRule(){return this._rule}setRule(t){this._rule=t}getTarget(){return this._target}setTarget(t){this._target=t,this._rule||this.setRule(t.type)}getComponent(){return this._component}setComponent(t){this._component=t}render(){}}RK.type="text",RK.constructorType="label";let R$=()=>{_B(),iv.registerMark(RK.constructorType,RK)};class RY extends gD{_initTheme(t,e){return{spec:t,theme:this._theme}}}var RX=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Rq extends g3.k{constructor(t,e){let{dataLabels:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({dataLabels:i},(0,cQ.Z)({},Rq.defaultAttributes,RX(t,["dataLabels"])))),this.name="data-label"}render(){var t;let{dataLabels:e,size:i}=this.attribute;if(!e||0===e.length)return;let{width:r=0,height:n=0,padding:s}=i||{};if(!r||!n||!(0,uE.Z)(n*r))return;this._componentMap||(this._componentMap=new Map);let l=pn(r,n,s),a=l.bitmap(),o=new Map,h=this._componentMap;for(let r=0;r<e.length;r++){let n=e[r],s=pE(n.type)||pR;if(s){let{baseMarkGroupName:e,type:h}=n,u=null!=(t=n.id)?t:`${e}-${h}-${r}`;"arc"===n.type&&(n.width=i.width,n.height=i.height);let d=this._componentMap.get(u);d?(d.setBitmapTool(l),d.setBitmap(a),d.setAttributes(n)):((d=new s(n)).setBitmap(a),d.setBitmapTool(l),this.add(d)),o.set(u,d)}}h.forEach((t,e)=>{o.get(e)||this.removeChild(t)}),this._componentMap=o}setLocation(t){this.translateTo(t.x,t.y)}disableAnimation(){this._componentMap.forEach(t=>{t.disableAnimation()})}enableAnimation(){this._componentMap.forEach(t=>{t.enableAnimation()})}}Rq.defaultAttributes={pickable:!1};class RJ extends RU{constructor(t,e){super(t,e),this.type=rk.label,this.name=rk.label,this.specKey="label",this.transformerConstructor=RY,this.layoutZIndex=H.Label,this._layoutRule=t.labelLayout||"series"}static getSpecInfo(t,e){let i=[];return((null==e?void 0:e.region)||[]).forEach((r,n)=>{(r.seriesIndexes||[]).some(t=>{let{markLabelSpec:i={}}=e.series[t];return Object.values(i).some(t=>Array.isArray(t)&&t.some(t=>t.visible))})&&i.push({spec:t,type:rk.label,specInfoPath:["component",this.specKey,n],regionIndexes:[n]})}),i}init(t){super.init(t),this.initEvent(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()}reInit(t){super.reInit(t),this._labelInfoMap&&(this._labelInfoMap.forEach(t=>{t.forEach(({labelMark:t})=>{t.release()})}),this._labelInfoMap.clear()),this._labelInfoMap&&this._labelInfoMap.clear(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()}initEvent(){this.event.on(rI.dataZoomChange,()=>{this._labelComponentMap.forEach((t,e)=>{let i=e.getComponent();i&&i.disableAnimation()}),this.event.on(rE.AFTER_MARK_RENDER_END,t)});let t=()=>{this._labelComponentMap.forEach((t,e)=>{let i=e.getComponent();i&&i.enableAnimation()}),this.event.off(rE.AFTER_MARK_RENDER_END,t)}}_initTextMark(){this._labelInfoMap||(this._labelInfoMap=new Map),this._labelComponentMap||(this._labelComponentMap=new Map),pX(this._regions,t=>{let{markLabelSpec:e={}}=t.getSpecInfo(),i=Object.keys(e),r=t.getRegion();this._labelInfoMap.get(r)||this._labelInfoMap.set(r,[]);for(let n=0;n<i.length;n++){let s=i[n],l=t.getMarkInName(s);l&&e[s].forEach((e,i)=>{var n,a,o;if(e.visible){let h=this._labelInfoMap.get(r),u=this._createMark({type:"label",name:`${null!=(n=t.userId)?n:t.id}-${s}-label-${i}`},{attributeContext:t.getMarkAttributeContext()});e.showRelatedMarkTooltip&&(null==(o=null==(a=t.tooltipHelper)?void 0:a.activeTriggerSet.mark)||o.add(u)),u.setTarget(l),h.push({labelMark:u,baseMark:l,series:t,labelSpec:e})}})}})}_initLabelComponent(){let t={};this._labelComponentMap.forEach((e,i)=>{t[i.name]=i}),this._labelInfoMap.forEach((e,i)=>{if("region"===this._layoutRule){let r=!1,n=`${i.getGroupMark().name}-label-component`,s=t[n];s||(r=!0,s=this._createMark({type:"component",name:n},{componentType:"label"},{support3d:this._spec.support3d})),s&&(r&&(s.setSkipBeforeLayouted(!0),this._marks.addMark(s),e.forEach(t=>{var e;null==(e=t.baseMark.getData())||e.addRelatedMark(s)})),e[0]&&t8(e[0].labelSpec.zIndex)&&s.setMarkConfig({zIndex:e[0].labelSpec.zIndex}),this._labelComponentMap.set(s,()=>this._labelInfoMap.get(i)),t[n]=null)}else e.forEach((e,r)=>{var n;let s=!1,l=`${e.labelMark.name}-component`,a=t[l];a||(s=!0,a=this._createMark({type:"component",name:l},{componentType:"label",noSeparateStyle:!0},{support3d:e.baseMark.getMarkConfig().support3d})),a&&(t8(e.labelSpec.zIndex)&&a.setMarkConfig({zIndex:e.labelSpec.zIndex}),s&&(a.setSkipBeforeLayouted(!0),this._marks.addMark(a),null==(n=e.baseMark.getData())||n.addRelatedMark(a)),this._labelComponentMap.set(a,()=>this._labelInfoMap.get(i)[r]),t[l]=null)})}),Object.keys(t).forEach(e=>{let i=t[e];i&&(i.release(),this._labelComponentMap.delete(i))})}_initTextMarkStyle(){this._labelComponentMap.forEach((t,e)=>{ed(t()).forEach(({labelMark:t})=>{t.setComponent(e)})}),this._labelInfoMap.forEach(t=>{t.forEach(t=>{var e,i;let{labelMark:r,labelSpec:n,series:s}=t;if(this.initMarkStyleWithSpec(r,n),tQ(null==n?void 0:n.getStyleHandler)){let t=n.getStyleHandler(s);null==t||t.call(s,r,n)}(null==(i=null==(e=r.stateStyle)?void 0:e.normal)?void 0:i.lineWidth)&&r.setAttribute("stroke",s.getColorAttribute(),"normal",W.Base_Series)})})}updateLayoutAttribute(){super.updateLayoutAttribute(),this._labelComponentMap.forEach((t,e)=>{let i=t();tq(i)?this._updateMultiLabelAttribute(i,e):this._updateSingleLabelAttribute(i,e)})}_updateMultiLabelAttribute(t,e){this._updateLabelComponentAttribute(e,t.map(({baseMark:t})=>t),t)}_updateSingleLabelAttribute(t,e){let{baseMark:i}=t;this._updateLabelComponentAttribute(e,i,[t])}_updateLabelComponentAttribute(t,e,i){let r=this._option.getComponentsByType("totalLabel");t.setMarkConfig({interactive:!1}),t.setSimpleStyle({labelStyle:t=>{var e,n;let s=i[t],{labelSpec:l,labelMark:a,series:o}=s,h=a.getRule(),u=this._interactiveConfig(l),d=null!=(n=null==(e=this._spec)?void 0:e.centerOffset)?n:0,c=ir({textStyle:Object.assign({pickable:!0===l.interactive},l.style),overlap:{avoidMarks:r.map(t=>t.getMarks()[0].getProductId())}},function(t,e){var i;let{labelSpec:r}=e;r.overlap&&!e_(r.overlap)&&(r.overlap={});let n=null!=(i=SA[t])?i:SA.point;return e.series.type===rR.sankey?function(t){var e,i,r,n;let{series:s,labelSpec:l={}}=t,a=null!=(e=Sk(l.position))?e:"outside",o=s.direction,h=a;return t6(a)&&("vertical"===o?h="inside-start"===a?t=>"inside-left":"inside-middle"===a?t=>"center":"inside-end"===a?t=>"inside-right":t=>"bottom":"inside-start"===a?h=t=>"inside-left":"inside-middle"===a?h=t=>"center":"inside-end"===a?h=t=>"inside-right":"outside"===a&&(h=t=>"right")),{position:h,overlap:!1!==l.overlap&&(!t6(a)||!a.includes("inside"))&&{strategy:null!=(r=null==(i=l.overlap)?void 0:i.strategy)?r:(n=s,[{type:"position",position:t=>"horizontal"===n.direction?["right","left"]:["bottom","top"]}])},smartInvert:!1,offset:0,syncState:!0}}(e):n(e)}(h,s),Object.assign(Object.assign(Object.assign({},gW(l,["position","style","state","type","stackDataFilterType","getStyleHandler"])),u),{centerOffset:d}),l.stackDataFilterType?{dataFilter:"min"===l.stackDataFilterType?t=>t.filter(t=>t.data[sv]):t=>t.filter(t=>t.data[sy])}:{});return o&&o.parseLabelStyle&&(c=o.parseLabelStyle(c,l,a)),"line"!==h&&"area"!==h||(c.type=h),c},size:()=>{var t;return Object.assign({padding:null==(t=i[0].labelSpec.overlap)?void 0:t.padding},i[0].series.getRegion().getLayoutRect())},itemEncoder:(t,{labelIndex:e})=>i[e]&&!i[e].labelMark.skipEncode?SM(i[e],t,i[e].labelSpec.formatMethod,i[e].labelSpec.formatter):{data:t}}),this._setTransformOfComponent(t,e)}compileMarks(){this.getMarks().forEach(t=>{let e,i=this._labelComponentMap.get(t)();e=tq(i)?i[0].series.getRegion().getGroupMark().getProduct():i.series.getRegion().getGroupMark().getProduct(),t.compile({group:e})})}getLabelInfoByTextGraphic(t){let e,i=null==t?void 0:t.parent,r=null==i?void 0:i.parent;if(r){let t=r.getChildren().indexOf(i);this._labelComponentMap.forEach((i,n)=>{n.getComponent()===r&&(e=ed(i())[t])})}return e}}RJ.type=rk.label,RJ.specKey="label",RJ.transformerConstructor=RY;let RQ=()=>{iv.registerGraphicComponent(RJ.type,t=>new Rq(t)),R$(),gj(),iv.registerComponent(RJ.type,RJ,!0,1/0)};class R0 extends RU{constructor(){super(...arguments),this.type=rk.totalLabel,this.name=rk.totalLabel,this.specKey="totalLabel",this.layoutZIndex=H.Label}static getSpecInfo(t,e){var i;let r=[];return null==(i=null==e?void 0:e.region)||i.forEach((t,i)=>{var n;null==(n=t.seriesIndexes)||n.forEach(t=>{let{spec:n}=e.series[t],s=n[this.specKey];(null==s?void 0:s.visible)&&r.push({spec:s,type:rk.totalLabel,specPath:["series",t,this.specKey],specInfoPath:["component",this.specKey,t],regionIndexes:[i],seriesIndexes:[t]})})}),r}init(t){super.init(t),this._initTextMark(),this._initLabelComponent()}reInit(t){super.reInit(t),this._initTextMark()}_initTextMark(){var t;let e=this._getSeries();if(null==(t=e.getSpec().totalLabel)?void 0:t.visible){let t=e.getSeriesMark();if(t){let e=this._createMark({type:"label",name:`${t.name}-total-label`});this._baseMark=t,this._textMark=e,this._initTextMarkStyle()}}}_initTextMarkStyle(){var t;super.initMarkStyleWithSpec(this._textMark,this._spec),this.setMarkStyle(this._textMark,{text:t=>t[sf]},"normal",W.Default);let e=this._getSeries();null==(t=e.initTotalLabelMarkStyle)||t.call(e,this._textMark)}_initLabelComponent(){var t;let e=this._getSeries(),i=this._createMark({type:"component",name:`${null!=(t=e.name)?t:e.type}-total-label-component`},{componentType:"label"},{support3d:this._spec.support3d});i&&(this._marks.addMark(i),e.getData().addRelatedMark(i))}updateLayoutAttribute(){super.updateLayoutAttribute();let t=this._getSeries();this._marks.forEach((e,i)=>{e.setMarkConfig({interactive:!1}),e.setSimpleStyle({labelStyle:()=>{var e,i;if(this._baseMark){let{offset:r,animation:n,overlap:s,position:l="top"}=this._spec,a=this._interactiveConfig(this._spec);return ir({textStyle:{pickable:!0===this._spec.interactive},position:function(t,e,i="top"){var r,n;let s,{direction:l}=t,a=+("horizontal"===l?null!=(r=t.getXAxisHelper())&&!!r.isInverse():null!=(n=t.getYAxisHelper())&&!!n.isInverse());switch(e){case"rect":case"symbol":s=("bottom"===i?{vertical:["bottom","top"],horizontal:["left","right"]}:{vertical:["top","bottom"],horizontal:["right","left"]})[l][a];break;default:s="top"}return s}(t,this._baseMark.type,l),x:0,y:0},null!=(i=null==(e=t.getTotalLabelComponentStyle)?void 0:e.call(t,{baseMark:this._baseMark,labelMark:this._textMark}))?i:{},Object.assign({offset:r,animation:n,overlap:s,dataFilter:t=>t.filter(t=>"bottom"===l?t.data[sv]:t.data[sy])},a))}},size:()=>{var t;return Object.assign({padding:null==(t=this._spec.overlap)?void 0:t.padding},this._regions[0].getLayoutRect())},itemEncoder:e=>SM({baseMark:this._baseMark,labelMark:this._textMark,series:t,labelSpec:t.getSpec().totalLabel},e,this._spec.formatMethod)}),this._setTransformOfComponent(e,this._baseMark)})}compileMarks(){this.getMarks().forEach(t=>{let e=this._regions[0].getGroupMark().getProduct();t.compile({group:e,context:{model:this}})})}_getSeries(){return this._option.getSeriesInIndex([this.getSpecPath()[1]])[0]}}R0.type=rk.totalLabel,R0.builtInTheme={totalLabel:{visible:!1,offset:5,overlap:{clampForce:!0,strategy:[]},smartInvert:!1,animation:!1,style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"primaryFontColor"}}}},R0.specKey="totalLabel";let R1=()=>{iv.registerGraphicComponent(R0.type,t=>new Rq(t)),R$(),gj(),iv.registerComponent(R0.type,R0,!0)},R2=(t,e)=>{let i=Math.atan2(t,e);return i<0?i+2*Math.PI:i};function R3(){R5._animate=TL}Tg(),(0,Tp.j)(),(0,Tp.O)(),(0,pj.k)(),(0,Tc.i)(),(0,cJ.N)(),(0,uM.d)();class R5 extends Tv{markerAnimate(t){R5._animate&&this._animationConfig&&R5._animate([this._line,this._decorativeLine],this._item,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},R5.defaultAttributes,t)),this.name="markPoint",this.defaultUpdateAnimation=TD,this.defaultExitAnimation=TH,this._isArcLine=!1,this._isStraightLine=!1}setLabelPos(){}getTextAlignAttr(t,e,i,r,n){return(0,pt.U4)(Math.abs(r),Math.PI/2,.001)||(0,pt.U4)(Math.abs(r),3*Math.PI/2,.001)?(0,pt.ic)(t,r,n):(0,pt.WF)(r)?TY.postiveXAxis[n]:TY.negativeXAxis[n]}setItemAttributes(t,e,i,r,n){var s,l;if(!t)return;let{autoRotate:a=!0,refX:o=0,refY:h=0,refAngle:u=0,style:d,position:c=tM.middle}=e,{state:p}=this.attribute,g=(null==(s=this._line)?void 0:s.getEndAngle())||0,f=o*Math.cos(g)+h*Math.cos(g-Math.PI/2),m=o*Math.sin(g)+h*Math.sin(g-Math.PI/2);if("text"===n){let n=r.x-i.x,s=r.y-i.y;t.setAttributes(Object.assign(Object.assign({},d),{textStyle:Object.assign(Object.assign({},this.getTextAlignAttr(a,n,s,g,null!=(l=e.position)?l:"end")),d.textStyle),state:{panel:(0,cQ.Z)({},pe.n0,null==p?void 0:p.textBackground),text:(0,cQ.Z)({},pe.n0,null==p?void 0:p.itemContent)}}))}else("richText"===n||"image"===n)&&(t.setAttributes({dx:this.getItemDx(t,c,d)+(d.dx||0),dy:this.getItemDy(t,c,d)+(d.dy||0)}),t.states=(0,cQ.Z)({},pe.n0,null==p?void 0:p.itemContent));let y=(0,pt.WF)(g)?g:g-Math.PI;t.setAttributes({x:r.x+(f||0),y:r.y+(m||0),angle:a&&y+u})}getItemDx(t,e,i){var r,n;let s=null!=(n=null==(r=null==t?void 0:t.AABBBounds)?void 0:r.width())?n:(null==i?void 0:i.width)||0;return e.includes("inside")?-s:0}getItemDy(t,e,i){var r,n;let s=null!=(n=null==(r=null==t?void 0:t.AABBBounds)?void 0:r.height())?n:(null==i?void 0:i.height)||0;return e.includes("top")||e.includes("Top")?-s:e.includes("middle")||e.includes("Middle")?-s/2:0}initItem(t,e,i){let r,{state:n}=this.attribute,{type:s="text",style:l,renderCustomCallback:a}=t;return"symbol"===s?(r=c0.i.symbol(Object.assign(Object.assign({},i),l))).states=(0,cQ.Z)({},pe.n0,null==n?void 0:n.itemContent):"text"===s?r=new kr.V(Object.assign(Object.assign({},i),{state:{panel:(0,cQ.Z)({},pe.n0,null==n?void 0:n.textBackground),text:(0,cQ.Z)({},pe.n0,null==n?void 0:n.itemContent)}})):"richText"===s?(r=c0.i.richtext(Object.assign(Object.assign({},i),l))).states=(0,cQ.Z)({},pe.n0,null==n?void 0:n.itemContent):"image"===s?(r=c0.i.image(Object.assign(Object.assign({},i),l))).states=(0,cQ.Z)({},pe.n0,null==n?void 0:n.itemContent):"custom"===s&&a&&((r=a()).states=(0,cQ.Z)({},pe.n0,null==n?void 0:n.itemContent)),r.name=`mark-point-${s}`,this.setItemAttributes(r,t,e,i,s),r}getItemLineAttr(t,e,i){let r=[],n={x:0,y:0},s=0,l=0,a=0,{type:o="type-s",arcRatio:h=.8}=t,u=i.x-e.x,d=i.y-e.y;if(this._isStraightLine=(0,pt.U4)(u,0,.001)||(0,pt.U4)(d,0,.001),this._isArcLine){let{x:t,y:e}=this.attribute.position,{x:r,y:o}=i,u=(t+r)/2,d=u+h*(o>e?-1:1)*u,c=(e===o?0:-(t-r)/(e-o))*(d-u)+(e+o)/2;l=R2(e-c,t-d),a=R2(o-c,r-d),n={x:d,y:c};let p=Math.sqrt((d-t)*(d-t)+(c-e)*(c-e)),g=this.attribute.targetSymbol.style.size/2;l+=2*Math.acos(Math.sqrt(1-g*g/(4*p*p))),h>0?a<l&&(a+=2*Math.PI):l<a&&(l+=2*Math.PI),s=Math.sqrt((d-t)*(d-t)+(c-e)*(c-e))}else r="type-do"!==o||this._isStraightLine?"type-po"!==o||this._isStraightLine?"type-op"!==o||this._isStraightLine?[e,i]:[e,{x:e.x,y:i.y},i]:[e,{x:i.x,y:e.y},i]:[e,{x:(e.x+i.x)/2,y:i.y},i];return{points:r=(0,pt.Bh)(r),center:n,radius:s,startAngle:l,endAngle:a}}reDrawLine(t,e){this._line.release();let{startSymbol:i,endSymbol:r,lineStyle:n,type:s="type-s"}=t,{state:l}=this.attribute,a=this._isArcLine?Ri:TN.X;this._container.removeChild(this._line),this._line=new a(Object.assign(Object.assign({},e),{pickable:!1,startSymbol:i,endSymbol:r,lineStyle:n,visible:t.visible,state:{line:(0,cQ.Z)({},pe.n0,null==l?void 0:l.line),startSymbol:(0,cQ.Z)({},pe.n0,null==l?void 0:l.lineStartSymbol),endSymbol:(0,cQ.Z)({},pe.n0,null==l?void 0:l.lineEndSymbol)}})),this._container.add(this._line)}setItemLineAttr(t,e,i){if(this._line){let{startSymbol:r,endSymbol:n,lineStyle:s,type:l="type-s"}=t,{state:a}=this.attribute,o=this.getItemLineAttr(t,e,i);this._isArcLine&&"arc-segment"===this._line.key||!this._isArcLine&&"segment"===this._line.key?this._line.setAttributes(Object.assign(Object.assign({},o),{startSymbol:r,endSymbol:n,lineStyle:s,visible:t.visible,state:{line:(0,cQ.Z)({},pe.n0,null==a?void 0:a.line),startSymbol:(0,cQ.Z)({},pe.n0,null==a?void 0:a.lineStartSymbol),endSymbol:(0,cQ.Z)({},pe.n0,null==a?void 0:a.lineEndSymbol)}})):this.reDrawLine(t,o)}}getDecorativeLineAttr(t){var e;let i=(null==(e=null==t?void 0:t.decorativeLine)?void 0:e.length)||10,r=this._line.getEndAngle()||0;return{startPointOffsetX:i/2*Math.cos(r-Math.PI/2),startPointOffsetY:i/2*Math.sin(r-Math.PI/2),endPointOffsetX:-i/2*Math.cos(r-Math.PI/2),endPointOffsetY:-i/2*Math.sin(r-Math.PI/2)}}setDecorativeLineAttr(t,e,i){var r;if(this._decorativeLine){let{lineStyle:n}=t,{startPointOffsetX:s,startPointOffsetY:l,endPointOffsetX:a,endPointOffsetY:o}=this.getDecorativeLineAttr(t);this._decorativeLine.setAttributes(Object.assign(Object.assign({points:[{x:e.x+s,y:e.y+l},{x:e.x+a,y:e.y+o}]},n),{visible:i})),this._decorativeLine.states=(0,cQ.Z)({},pe.n0,null==(r=this.attribute.state)?void 0:r.line)}}setTargetItemAttributes(t,e){var i,r;this._targetItem&&(this._targetItem.setAttributes(Object.assign({x:e.x,y:e.y,visible:null!=(i=t.visible)&&i,size:t.size},t.style)),this._targetItem.states=(0,cQ.Z)({},pe.n0,null==(r=this.attribute.state)?void 0:r.targetItem))}setAllOfItemsAttr(t,e){var i;let{position:r,itemLine:n={},itemContent:s={},limitRect:l,targetSymbol:a}=this.attribute,{type:o="text",confine:h}=s;if(l&&h){let{x:t,y:i,width:r,height:n}=l,{dx:s,dy:a}=Tf(this._item,{x1:t,y1:i,x2:t+r,y2:i+n});e.x=e.x+s,e.y=e.y+a}this.setTargetItemAttributes(a,r),this.setItemLineAttr(n,t,e),this.setItemAttributes(this._item,s,t,e,o),this.setDecorativeLineAttr(n,e,null==(i=n.decorativeLine)?void 0:i.visible)}computeNewPositionAfterTargetItem(t){var e,i;let r,{itemContent:n={},targetSymbol:s,itemLine:l}=this.attribute,{offsetX:a=0,offsetY:o=0}=n,{offset:h=0,style:u,visible:d=!1,size:c}=s,p=d?null!=(i=null!=(e=u.size)?e:c)?i:20:0;return r="type-do"===l.type?R2(o,a/2):"type-po"===l.type?R2(0,a):"type-op"===l.type?R2(o,0):R2(o,a),{newPosition:{x:t.x+(p/2+h)*Math.cos(r),y:t.y+(p/2+h)*Math.sin(r)},newItemPosition:{x:t.x+(p/2+h)*Math.cos(r)+a,y:t.y+(p/2+h)*Math.sin(r)+o}}}initMarker(t){let{position:e,itemContent:i={},itemLine:r}=this.attribute,{type:n="type-s",arcRatio:s=.8}=r,{offsetX:l=0,offsetY:a=0}=i;this._isStraightLine=(0,pt.U4)(l,0,.001)||(0,pt.U4)(a,0,.001),this._isArcLine="type-arc"===n&&0!==s&&!this._isStraightLine;let{newPosition:o,newItemPosition:h}=this.computeNewPositionAfterTargetItem(e),u=new(this._isArcLine?Ri:TN.X)({points:[],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0});u.name="mark-point-line",this._line=u,t.add(u);let d=c0.i.line({points:[]});d.name="mark-point-decorativeLine",this._decorativeLine=d,t.add(d);let c=c0.i.symbol({});c.name="mark-point-targetItem",this._targetItem=c,t.add(this._targetItem);let p=this.initItem(i,o,h);this._item=p,t.add(p),this.setAllOfItemsAttr(o,h)}updateMarker(){let{position:t,itemContent:e={},itemLine:i}=this.attribute,{type:r="text"}=e,{type:n="type-s",arcRatio:s=.8}=i,{offsetX:l=0,offsetY:a=0}=e;this._isStraightLine=(0,pt.U4)(l,0,.001)||(0,pt.U4)(a,0,.001);let o="type-arc"===n&&0!==s&&!this._isStraightLine,{newPosition:h,newItemPosition:u}=this.computeNewPositionAfterTargetItem(t);o!==this._isArcLine?(this._isArcLine=o,this.reDrawLine(i,{points:[{x:0,y:0}],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0})):this._isArcLine=o,this.setItemAttributes(this._item,e,h,u,r),this.setAllOfItemsAttr(h,u)}isValidPoints(){let{position:t}=this.attribute;return!(!(0,uE.Z)(t.x)||!(0,uE.Z)(t.y))}}R5.defaultAttributes={interactive:!0,targetSymbol:{visible:!1,offset:0,style:{symbolType:"circle",size:20,fill:!1,stroke:"rgba(46, 47, 50)"}},itemLine:{visible:!0,decorativeLine:{visible:!1,length:30},startSymbol:{visible:!0,clip:!0,symbolType:"circle",size:20,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},endSymbol:{visible:!1,clip:!0,symbolType:"triangle",size:12,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},lineStyle:{stroke:"#000",lineWidth:1}},itemContent:{type:"text",position:"middle",refX:10}};var R4=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class R6 extends T3{constructor(){super(...arguments),this.specKey="markPoint",this.layoutZIndex=H.MarkPoint}static _getMarkerCoordinateType(t){let{doPolarProcess:e,doGeoProcess:i}=Td(t);return"polar"===t.coordinateType||e?"polar":"geo"===t.coordinateType||i?"geo":"cartesian"}_createMarkerComponent(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F;let{itemContent:O={},itemLine:D={},targetSymbol:H={}}=this._spec,{type:z="text",text:W,symbol:N,image:j,richText:G,customMark:V,textStyle:Z,symbolStyle:U,imageStyle:K,richTextStyle:$,customMarkStyle:Y,style:X={},state:q={}}=O,J=R4(O,["type","text","symbol","image","richText","customMark","textStyle","symbolStyle","imageStyle","richTextStyle","customMarkStyle","style","state"]),Q=null,te=null,ti={};"text"===z?(Q=null!=(t=null==W?void 0:W.state)?t:q,te=Tn(ei({dx:0,dy:0},null!=(e=null!=W?W:Z)?e:X),this._markerData,this._markAttributeContext)):"richText"===z?(Q=null!=(i=null==G?void 0:G.state)?i:q,te=Tl(ei({width:100,height:100},null!=(n=null!=(r=null==G?void 0:G.style)?r:$)?n:X),this._markerData,this._markAttributeContext)):"symbol"===z?(Q=null!=(s=null==N?void 0:N.state)?s:q,te=gd(Tl(ei({symbolType:"star",fill:"rgb(48, 115, 242)",fillOpacity:.8,size:20},null!=(a=null!=(l=null==N?void 0:N.style)?l:U)?a:X),this._markerData,this._markAttributeContext))):"image"===z?(Q=null!=(o=null==j?void 0:j.state)?o:q,te=Tl(ei({width:80,height:80},null!=(u=null!=(h=null==j?void 0:j.style)?h:K)?u:X),this._markerData,this._markAttributeContext)):"custom"===z&&(Q=null!=(d=null==V?void 0:V.state)?d:q,te=Tl(null!=(p=null!=(c=null==V?void 0:V.style)?c:Y)?p:X,this._markerData,this._markAttributeContext));let tr={zIndex:this.layoutZIndex,interactive:null==(g=this._spec.interactive)||g,hover:null==(f=this._spec.interactive)||f,select:null==(m=this._spec.interactive)||m,position:{x:0,y:0},clipInRange:null!=(y=this._spec.clip)&&y,itemContent:Object.assign(Object.assign({type:z,offsetX:(E=O.offsetX,I=this._relativeSeries.getRegion(),tQ(E)?E(I):E),offsetY:(L=O.offsetX,F=this._relativeSeries.getRegion(),tQ(L)?L(F):L)},J),{style:Tl(te,this._markerData,this._markAttributeContext)}),targetSymbol:{offset:null!=(v=H.offset)?v:0,visible:null!=(b=H.visible)&&b,size:null!=(_=H.size)?_:20,style:Tl(H.style,this._markerData,this._markAttributeContext)},state:{line:Ts(null!=(C=null==(x=this._spec.itemLine.line)?void 0:x.state)?C:{},this._markerData,this._markAttributeContext),lineStartSymbol:Ts(null!=(S=null==(w=this._spec.itemLine.startSymbol)?void 0:w.state)?S:{},this._markerData,this._markAttributeContext),lineEndSymbol:Ts(null!=(M=null==(A=this._spec.itemLine.endSymbol)?void 0:A.state)?M:{},this._markerData,this._markAttributeContext),itemContent:Ts(Q,this._markerData,this._markAttributeContext),textBackground:Ts(null==(T=null==(k=this._spec.itemContent.text)?void 0:k.labelBackground)?void 0:T.state,this._markerData,this._markAttributeContext),targetItem:Ts(null!=(B=null==(R=this._spec.targetSymbol)?void 0:R.state)?B:{},this._markerData,this._markAttributeContext)},animation:null!=(P=this._spec.animation)&&P,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate},{visible:tn,line:ts={}}=D,tl=R4(D,["visible","line"]);return tr.itemLine=!1!==tn?Object.assign(Object.assign({},tl),{visible:!0,lineStyle:gd(ts.style)}):{visible:!1},new R5(tr)}_markerLayout(){var t,e,i,r,n;let s,l=this._spec,a=this._markerData,o=this._relativeSeries,{point:h}=this._computePointsAttr(),u=this._getRelativeDataView().latestData,d=a?a.latestData[0]&&a.latestData[0].latestData?a.latestData[0].latestData:a.latestData:u;if(l.clip||(null==(t=l.itemContent)?void 0:t.confine)){let{minX:t,maxX:e,minY:i,maxY:r}=Tr([o.getRegion()]);s={x:t,y:i,width:e-t,height:r-i}}if(this._markerComponent){let t=null!=(e=this._markerComponent.attribute)?e:{},l=null!=(r=null==(i=t.itemContent)?void 0:i.textStyle)?r:{};this._markerComponent.setAttributes({position:void 0===h?{x:null,y:null}:h,itemContent:Object.assign(Object.assign({},t.itemContent),{textStyle:Object.assign(Object.assign({},l),{text:(null==(n=this._spec.itemContent.text)?void 0:n.formatMethod)?this._spec.itemContent.text.formatMethod(d,u):l.text}),offsetX:Ta(h,t.itemContent.offsetX,this._relativeSeries.getRegion()),offsetY:Ta(h,t.itemContent.offsetY,this._relativeSeries.getRegion())}),limitRect:s,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}}_initDataView(){let t=this._spec,{doXYProcess:e,doPolarProcess:i,doGeoProcess:r}=Td(t);(t8(t.coordinate)||e||i||r)&&this._initCommonDataView()}}R6.specKey="markPoint";let R8={itemLine:{decorativeLine:{visible:!1},startSymbol:{size:5,visible:!0,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},line:{style:{stroke:{type:"palette",key:"markLineStrokeColor"}}}},itemContent:{offsetY:-50}};class R9 extends R6{constructor(){super(...arguments),this.type=rk.markPoint,this.name=rk.markPoint,this.coordinateType="cartesian"}_computePointsAttr(){var t,e,i;let r,n=this._spec,s=this._markerData,l=this._relativeSeries,a=t8(n.x)&&t8(n.y),o=t8(n.coordinate),h=t8(n.position),u=null!=(t=null==n?void 0:n.autoRange)&&t;return a?r=null==(i=null==(e=k6(s,l,l,l,u))?void 0:e[0])?void 0:i[0]:o?r=k7(s,l,u,n.coordinatesOffset)[0]:h&&(r=Ti(n.position,l,n.regionRelative)[0]),{point:r}}_computeOptions(){let t,e=this._spec,{doXYProcess:i}=Td(e),r=t8(e.coordinate);return i?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}])]:r&&(t=this._processSpecCoo(e)),{options:t}}}R9.type=rk.markPoint,R9.coordinateType="cartesian",R9.builtInTheme={markPoint:R8};let R7=()=>{iv.registerComponent(R9.type,R9),R3()};class Bt extends R6{constructor(){super(...arguments),this.type=rk.polarMarkPoint,this.name=rk.polarMarkPoint,this.coordinateType="polar"}_computePointsAttr(){var t,e;let i=this._markerData,r=this._relativeSeries,n=k9(i,r,r,r,null!=(e=null==(t=this._spec)?void 0:t.autoRange)&&e)[0][0];return{point:ay({x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y},n.radius,n.angle)}}_computeOptions(){let t=this._spec;return{options:[this._processSpecByDims([{dim:"radius",specValue:t.radius},{dim:"angle",specValue:t.angle}])]}}}Bt.type=rk.polarMarkPoint,Bt.coordinateType="polar",Bt.builtInTheme={polarMarkPoint:R8};let Be=()=>{iv.registerComponent(Bt.type,Bt),R3()};class Bi extends R6{constructor(){super(...arguments),this.type=rk.geoMarkPoint,this.name=rk.geoMarkPoint,this.coordinateType="geo"}_computePointsAttr(){return{point:function(t,e){let i=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach(t=>{t8(t.areaName)&&i.push([{x:e.nameValueToPosition(t.areaName).x+e.getRegion().getLayoutStartPoint().x,y:e.nameValueToPosition(t.areaName).y+e.getRegion().getLayoutStartPoint().y}])}),i}(this._markerData,this._relativeSeries)[0][0]}}_computeOptions(){let t=this._spec;return{options:[this._processSpecByDims([{dim:"areaName",specValue:t.areaName}])]}}}Bi.type=rk.geoMarkPoint,Bi.coordinateType="geo",Bi.builtInTheme={geoMarkPoint:R8};let Br=()=>{iv.registerComponent(Bi.type,Bi),R3()};var Bn=i(92493),Bs=i(6201);(tc=tP||(tP={})).drawStart="drawStart",tc.drawEnd="drawEnd",tc.drawing="drawing",tc.moving="moving",tc.moveStart="moveStart",tc.moveEnd="moveEnd",tc.brushActive="brushActive",tc.brushClear="brushClear";let Bl={trigger:"pointerdown",updateTrigger:"pointermove",endTrigger:["pointerup","pointerleave"],resetTrigger:"pointerupoutside",hasMask:!0,brushMode:"single",brushType:"rect",brushStyle:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",strokeWidth:2},brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:10,interactiveRange:{minY:-1/0,maxY:1/0,minX:-1/0,maxX:1/0}},Ba={debounce:kT.Z,throttle:kR.Z};(0,op.M)(),(0,CB.M)();class Bo extends g3.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},Bo.defaultAttributes,t)),this.name="brush",this._activeBrushState=!1,this._activeDrawState=!1,this._cacheDrawPoints=[],this._activeMoveState=!1,this._operatingMaskMoveDx=0,this._operatingMaskMoveDy=0,this._operatingMaskMoveRangeX=[-1/0,1/0],this._operatingMaskMoveRangeY=[-1/0,1/0],this._brushMaskAABBBoundsDict={},this._firstUpdate=!0,this._onBrushStart=t=>{let{updateTrigger:e=Bl.updateTrigger,endTrigger:i=Bl.endTrigger,brushMoved:r=!0}=this.attribute;(0,kx.IX)(e).forEach(t=>this.stage.addEventListener(t,this._onBrushingWithDelay)),(0,kx.IX)(i).forEach(t=>this.stage.addEventListener(t,this._onBrushEnd)),t.stopPropagation(),this._firstUpdate=!0,this._activeMoveState=r&&this._isPosInBrushMask(t),this._activeDrawState=!this._activeMoveState,this._startPos=this.eventPosToStagePos(t),this._cacheDrawPoints=[this._startPos]},this._onBrushing=t=>{this._outOfInteractiveRange(t)||(t.stopPropagation(),this._firstUpdate?(this._activeDrawState&&this._initDraw(t),this._activeMoveState&&this._initMove(t),this._firstUpdate=!1):(this._activeDrawState&&this._drawing(t),this._activeMoveState&&this._moving(t)))},this._onBrushingWithDelay=0===this.attribute.delayTime?this._onBrushing:Ba[this.attribute.delayType](this._onBrushing,this.attribute.delayTime),this._onBrushEnd=t=>{this._releaseBrushUpdateEvents(),t.preventDefault(),this._activeDrawState&&this._drawEnd(t),this._activeMoveState&&this._moveEnd(t),this._activeDrawState=!1,this._activeMoveState=!1},this._onBrushClear=t=>{t.preventDefault(),this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(tP.brushClear,t)),this._activeDrawState=!1,this._activeMoveState=!1}}_bindBrushEvents(){if(this.releaseBrushEvents(),this.attribute.disableTriggerEvent)return;let{trigger:t=Bl.trigger,resetTrigger:e=Bl.resetTrigger}=this.attribute;(0,kx.IX)(t).forEach(t=>this.stage.addEventListener(t,this._onBrushStart)),(0,kx.IX)(e).forEach(t=>this.stage.addEventListener(t,this._onBrushClear))}_initDraw(t){let{brushMode:e}=this.attribute,i=this.eventPosToStagePos(t);this._cacheDrawPoints.push(i),"single"===e&&this._clearMask(),this._addBrushMask(),this._dispatchBrushEvent(tP.drawStart,t),this._activeBrushState=!1}_initMove(t){var e,i;this._cacheMovePoint=this.eventPosToStagePos(t),this._operatingMaskMoveDx=null!=(e=this._operatingMask.attribute.dx)?e:0,this._operatingMaskMoveDy=null!=(i=this._operatingMask.attribute.dy)?i:0;let{interactiveRange:r}=this.attribute,{minY:n=-1/0,maxY:s=1/0,minX:l=-1/0,maxX:a=1/0}=r,{x1:o,x2:h,y1:u,y2:d}=this._operatingMask.globalAABBBounds;this._operatingMaskMoveRangeX=[l-o,a-h],this._operatingMaskMoveRangeY=[n-u,s-d],this._operatingMask.setAttribute("pickable",!0),this._dispatchBrushEvent(tP.moveStart,t)}_drawing(t){var e;let i=this.eventPosToStagePos(t),{brushType:r,sizeThreshold:n=5}=this.attribute,s=this._cacheDrawPoints.length;if(s>0){let t=null!=(e=this._cacheDrawPoints[this._cacheDrawPoints.length-1])?e:{};if(i.x===t.x&&i.y===t.y)return}"polygon"===r||s<=1?this._cacheDrawPoints.push(i):this._cacheDrawPoints[s-1]=i;let l=this._computeMaskPoints();this._operatingMask.setAttribute("points",l);let{x:a,y:o}=this._startPos,{x:h,y:u}=this.eventPosToStagePos(t);(Math.abs(h-a)>n||Math.abs(o-u)>n)&&(1!==Object.keys(this._brushMaskAABBBoundsDict).length||this._activeBrushState?this._dispatchBrushEvent(tP.drawing,t):(this._activeBrushState=!0,this._dispatchBrushEvent(tP.brushActive,t)))}_moving(t){let e=this._cacheMovePoint,i=this.eventPosToStagePos(t);if(i.x===(null==e?void 0:e.x)&&i.y===(null==e?void 0:e.y))return;let r=i.x-e.x,n=i.y-e.y,s=Math.min(this._operatingMaskMoveRangeX[1],Math.max(this._operatingMaskMoveRangeX[0],r))+this._operatingMaskMoveDx,l=Math.min(this._operatingMaskMoveRangeY[1],Math.max(this._operatingMaskMoveRangeY[0],n))+this._operatingMaskMoveDy;this._operatingMask.setAttributes({dx:s,dy:l}),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(tP.moving,t)}_drawEnd(t){let{removeOnClick:e=!0,sizeThreshold:i=5}=this.attribute;if(this._outOfInteractiveRange(t))this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(tP.brushClear,t));else{let{x:r,y:n}=this._startPos,{x:s,y:l}=this.eventPosToStagePos(t);1>=Math.abs(s-r)&&1>=Math.abs(l-n)&&e?this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(tP.brushClear,t)):Math.abs(s-r)<i&&Math.abs(n-l)<i?(delete this._brushMaskAABBBoundsDict[this._operatingMask.name],this._container.setAttributes({}),this._container.removeChild(this._operatingMask),this._isEmptyMask()&&this._dispatchBrushEvent(tP.brushClear,t)):(this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(tP.drawEnd,t))}}_moveEnd(t){this._operatingMask&&this._operatingMask.setAttribute("pickable",!1),this._dispatchBrushEvent(tP.moveEnd,t)}render(){this._bindBrushEvents();let t=this.createOrUpdateChild("brush-container",{},"group");this._container=t}releaseBrushEvents(){let{trigger:t=Bl.trigger,resetTrigger:e=Bl.resetTrigger}=this.attribute;(0,kx.IX)(t).forEach(t=>this.stage.removeEventListener(t,this._onBrushStart)),(0,kx.IX)(e).forEach(t=>this.stage.removeEventListener(t,this._onBrushClear)),this._releaseBrushUpdateEvents()}_releaseBrushUpdateEvents(){let{updateTrigger:t=Bl.updateTrigger,endTrigger:e=Bl.endTrigger}=this.attribute;(0,kx.IX)(t).forEach(t=>this.stage.removeEventListener(t,this._onBrushingWithDelay)),(0,kx.IX)(e).forEach(t=>this.stage.removeEventListener(t,this._onBrushEnd))}_computeMaskPoints(){let{brushType:t,xRange:e=[0,0],yRange:i=[0,0]}=this.attribute,r=this._cacheDrawPoints[0],n=this._cacheDrawPoints[this._cacheDrawPoints.length-1];return"rect"===t?[r,{x:n.x,y:r.y},n,{x:r.x,y:n.y}]:"x"===t?[{x:r.x,y:i[0]},{x:n.x,y:i[0]},{x:n.x,y:i[1]},{x:r.x,y:i[1]}]:"y"===t?[{x:e[0],y:r.y},{x:e[0],y:n.y},{x:e[1],y:n.y},{x:e[1],y:r.y}]:(0,Bn.Z)(this._cacheDrawPoints)}_addBrushMask(){var t;let{brushStyle:e,hasMask:i}=this.attribute,r=c0.i.polygon(Object.assign(Object.assign({points:(0,Bn.Z)(this._cacheDrawPoints),cursor:"move",pickable:!1},e),{opacity:i?null!=(t=e.opacity)?t:1:0}));r.name=`brush-${Date.now()}`,this._operatingMask=r,this._container.add(r),this._brushMaskAABBBoundsDict[r.name]=r.AABBBounds}_isPosInBrushMask(t){let e=this.eventPosToStagePos(t),i=this._container.getChildren();for(let t=0;t<i.length;t++){let{points:r=[],dx:n=0,dy:s=0}=i[t].attribute,l=r.map(t=>({x:t.x+n,y:t.y+s}));if((0,Bs.O0)(l,e.x,e.y))return this._operatingMask=i[t],!0}return!1}_outOfInteractiveRange(t){let{interactiveRange:e}=this.attribute,{minY:i=-1/0,maxY:r=1/0,minX:n=-1/0,maxX:s=1/0}=e,l=this.eventPosToStagePos(t);return l.x>s||l.x<n||l.y>r||l.y<i}_dispatchBrushEvent(t,e){this._dispatchEvent(t,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e})}_clearMask(){this._brushMaskAABBBoundsDict={},this._container.removeAllChild(),this._operatingMask=null}_isEmptyMask(){return(0,c1.Z)(this._brushMaskAABBBoundsDict)||Object.keys(this._brushMaskAABBBoundsDict).every(t=>this._brushMaskAABBBoundsDict[t].empty())}}function Bh(t,e,i,r,n,s){if(s>e&&s>r||s<e&&s<r||r===e)return 0;let l=(s-e)/(r-e),a=r<e?1:-1;1!==l&&0!==l||(a=r<e?.5:-.5);let o=l*(i-t)+t;return o===n?1/0:o>n?a:0}function Bu(t,e){return 1e-8>Math.abs(t-e)}Bo.defaultAttributes=Bl;class Bd extends gz{constructor(){super(...arguments),this.layoutType="none",this.type=rk.brush,this.name=rk.brush,this.specKey="brush",this.layoutZIndex=H.Brush,this._linkedSeries=[],this._itemMap={},this._linkedItemMap={},this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._cacheInteractiveRangeAttrs=[],this._releatedAxes=[],this._regionAxisMap={},this._axisDataZoomMap={},this._zoomRecord=[]}static getSpecInfo(t){return d6(t,this.specKey,this.type,t=>!1!==t.visible)}init(){let t=this._transformBrushedMarkAttr(this._spec.inBrush),e=this._transformBrushedMarkAttr(this._spec.outOfBrush);this._option.getAllSeries().forEach(i=>{i.getActiveMarks().forEach(r=>{r&&(i.setMarkStyle(r,Object.assign({},t),"inBrush",W.Series),i.setMarkStyle(r,Object.assign({},e),"outOfBrush",W.Series))})})}_initNeedOperatedItem(){let t=this._spec.seriesId,e=this._spec.seriesIndex;this._relativeRegions.forEach(i=>{let r=[];i.getSeries().forEach(n=>{(t&&ed(t).includes(n.userId.toString())||e&&ed(e).includes(n.getSpecIndex())||!e&&!t)&&r.push(...n.getMarksWithoutRoot()),this._itemMap[i.id]=r})}),this._linkedSeries.forEach(t=>{this._linkedItemMap[t.id]=t.getMarksWithoutRoot()})}created(){super.created(),this.initEvent(),this._bindRegions(),this._bindLinkedSeries(),this._initRegionAxisMap(),this._initAxisDataZoomMap(),this._initNeedOperatedItem()}_bindRegions(){t8(this._spec.regionId)||t8(this._spec.regionIndex)?this._relativeRegions=this._option.getRegionsInUserIdOrIndex(ed(this._spec.regionId),ed(this._spec.regionIndex)):this._relativeRegions=this._option.getAllRegions()}_bindLinkedSeries(){(t8(this._spec.brushLinkSeriesId)||t8(this._spec.brushLinkSeriesIndex))&&(this._linkedSeries=this._option.getSeriesInUserIdOrIndex(ed(this._spec.brushLinkSeriesId),ed(this._spec.brushLinkSeriesIndex)))}_initRegionAxisMap(){t8(this._spec.axisId)?ed(this._spec.axisId).forEach(t=>{this._releatedAxes.push(this._option.getComponentByUserId(t))}):t8(this._spec.axisIndex)?ed(this._spec.axisIndex).forEach(t=>{this._releatedAxes.push(this._option.getComponentByIndex("axes",t))}):this._releatedAxes=this._option.getComponentsByKey("axes"),this._releatedAxes.forEach(t=>{null==t||t.getRegions().forEach(e=>{this._regionAxisMap["region_"+e.id]?this._regionAxisMap["region_"+e.id].push(t):this._regionAxisMap["region_"+e.id]=[t]})})}_initAxisDataZoomMap(){this._option.getComponentsByKey("dataZoom").forEach(t=>{t.relatedAxisComponent&&(this._axisDataZoomMap[t.relatedAxisComponent.id]=t)})}initEvent(){}_compareSpec(t,e){this._brushComponents&&this._relativeRegions.forEach((t,e)=>{this._updateBrushComponent(t,e)});let i=super._compareSpec(t,e);return t5(e,t)||(i.reRender=!0,i.reMake=!0),i}onLayoutEnd(){var t;super.onLayoutEnd(),!this._option.disableTriggerEvent&&(null==(t=this._spec.visible)||t)&&(this._brushComponents?this._relativeRegions.forEach((t,e)=>{this._updateBrushComponent(t,e)}):(this._brushComponents=[],this._relativeRegions.forEach((t,e)=>{this._createBrushComponent(t,e)})))}_updateBrushComponent(t,e){let i=this._getBrushInteractiveAttr(t),r=this._brushComponents[e];r.setAttributes(i),this._initMarkBrushState(e,""),r.children[0].removeAllChild()}_createBrushComponent(t,e){var i,r;let n=this._getBrushInteractiveAttr(t),s=new Bo(Object.assign(Object.assign(Object.assign({zIndex:this.layoutZIndex,brushStyle:gd(null==(i=this._spec)?void 0:i.style)},n),this._spec),{disableTriggerEvent:this._option.disableTriggerEvent}));s.id=null!=(r=this._spec.id)?r:`brush-${this.id}`,this.getContainer().add(s),this._brushComponents.push(s),this._cacheInteractiveRangeAttrs.push(n),s.addEventListener(tP.brushActive,i=>{this._initMarkBrushState(e,"outOfBrush"),this._emitEvent(rI.brushActive,t)}),s.addEventListener(tP.drawStart,e=>{this._setRegionMarkPickable(t,!0),this._emitEvent(rI.brushStart,t)}),s.addEventListener(tP.moveStart,e=>{this._setRegionMarkPickable(t,!0),this._emitEvent(rI.brushStart,t)}),s.addEventListener(tP.drawing,e=>{this._setRegionMarkPickable(t,!1),this._handleBrushChange(t,e),this._emitEvent(rI.brushChange,t)}),s.addEventListener(tP.moving,e=>{this._setRegionMarkPickable(t,!1),this._handleBrushChange(t,e),this._emitEvent(rI.brushChange,t)}),s.addEventListener(tP.brushClear,i=>{this._setRegionMarkPickable(t,!0),this._initMarkBrushState(e,""),this._emitEvent(rI.brushClear,t)}),s.addEventListener(tP.drawEnd,i=>{var r;this._setRegionMarkPickable(t,!0);let{operateMask:n}=i.detail,{updateElementsState:s=!0}=this._spec;if(null==(r=this._spec)?void 0:r.onBrushEnd)!0===this._spec.onBrushEnd(i)?(this.clearGraphic(),this._initMarkBrushState(e,""),this._emitEvent(rI.brushClear,t)):(this._spec.onBrushEnd(i),this._emitEvent(rI.brushEnd,t));else{let e=this._extendDataInBrush(this._inBrushElementsMap);(this._spec.zoomWhenEmpty||!(e.length>0))&&s||this._setAxisAndDataZoom(n,t),this._emitEvent(rI.brushEnd,t)}}),s.addEventListener(tP.moveEnd,e=>{this._setRegionMarkPickable(t,!0);let{operateMask:i}=e.detail,{updateElementsState:r=!0}=this._spec,n=this._extendDataInBrush(this._inBrushElementsMap);(!this._spec.zoomWhenEmpty&&n.length>0||r)&&this._setAxisAndDataZoom(i,t),this._emitEvent(rI.brushEnd,t)})}_getBrushInteractiveAttr(t){let e=t.getLayoutStartPoint(),i=t.getLayoutRect(),r=e.x,n=r+i.width,s=e.y,l=s+i.height;return{interactiveRange:{minY:s,maxY:l,minX:r,maxX:n},xRange:[r,n],yRange:[s,l]}}_transformBrushedMarkAttr(t){let e={};return(null==t?void 0:t.symbol)&&(e.symbolType=t.symbol),(null==t?void 0:t.symbolSize)&&(e.size=t.symbolSize),(null==t?void 0:t.color)&&(e.fill=t.color),(null==t?void 0:t.colorAlpha)&&(e.fillOpacity=t.colorAlpha),Object.assign(Object.assign({},gd(t)),e)}_handleBrushChange(t,e){let{operateMask:i}=e.detail,{updateElementsState:r=!0}=this._spec;r&&(this._reconfigItem(i,t),this._reconfigLinkedItem(i,t))}_extendDataInBrush(t){var e,i;let r=[];for(let n in t)for(let s in t[n])r.push(Object.assign({},null==(i=null==(e=t[n][s].context)?void 0:e.data)?void 0:i[0]));return r}_extendDatumOutOfBrush(t){var e,i;let r=[];for(let n in t)r.push(null==(i=null==(e=t[n].context)?void 0:e.data)?void 0:i[0]);return r}_emitEvent(t,e){var i;this.event.emit(t,{model:this,value:{operateType:t,operateRegion:e,inBrushData:this._extendDataInBrush(this._inBrushElementsMap),outOfBrushData:this._extendDatumOutOfBrush(this._outOfBrushElementsMap),linkInBrushData:this._extendDataInBrush(this._linkedInBrushElementsMap),linkOutOfBrushData:this._extendDatumOutOfBrush(this._linkedOutOfBrushElementsMap),inBrushElementsMap:this._inBrushElementsMap,outOfBrushElementsMap:this._outOfBrushElementsMap,linkedInBrushElementsMap:this._linkedInBrushElementsMap,linkedOutOfBrushElementsMap:this._linkedOutOfBrushElementsMap,zoomRecord:this._zoomRecord},vchart:null==(i=this._option)?void 0:i.globalInstance})}_reconfigItem(t,e){var i,r,n;if(!(null==t?void 0:t.globalTransMatrix)||!(null==(i=null==t?void 0:t.attribute)?void 0:i.points))return;let s=null!=(n=null==(r=null==t?void 0:t.attribute)?void 0:r.points)?n:[],{a:l,b:a,c:o,d:h,e:u,f:d}=t.globalTransMatrix,c=s.map(t=>({x:l*t.x+o*t.y+u,y:a*t.x+h*t.y+d})),{markTypeFilter:p=[]}=this._spec;this._itemMap[e.id].forEach(e=>{if(p.includes(e.type))return;let i=e.getGraphics();i&&i.length&&i.forEach(i=>{var r,n,s;let l=e.id+"_"+i.context.key,a=this._isBrushContainItem(t.globalAABBBounds,c,i);(null==(r=this._outOfBrushElementsMap)?void 0:r[l])&&a?(i.addState("inBrush",!0),this._inBrushElementsMap[null==t?void 0:t.name]||(this._inBrushElementsMap[null==t?void 0:t.name]={}),this._inBrushElementsMap[null==t?void 0:t.name][l]=i,delete this._outOfBrushElementsMap[l]):(null==(s=null==(n=this._inBrushElementsMap)?void 0:n[null==t?void 0:t.name])?void 0:s[l])&&!a&&(i.removeState("inBrush"),i.addState("outOfBrush",!0),this._outOfBrushElementsMap[l]=i,delete this._inBrushElementsMap[t.name][l])})})}_reconfigLinkedItem(t,e){var i;if(!(null==t?void 0:t.globalTransMatrix)||!(null==(i=null==t?void 0:t.attribute)?void 0:i.points))return;let r=e.getLayoutStartPoint(),n=e.getSeries().map(t=>t.id);this._linkedSeries.forEach(e=>{var i,s;if(!n.includes(e.id)){let n=e.getRegion().getLayoutStartPoint(),l=n.x-r.x,a=n.y-r.y,o=null!=(s=null==(i=null==t?void 0:t.attribute)?void 0:i.points)?s:[],{a:h,b:u,c:d,d:c,e:p,f:g}=t.globalTransMatrix,f=l||0,m=a||0,y=o.map(t=>({x:h*t.x+d*t.y+p+f,y:u*t.x+c*t.y+g+m}));t.globalAABBBounds.clone().set(t.globalAABBBounds.x1+f,t.globalAABBBounds.y1+m,t.globalAABBBounds.x2+f,t.globalAABBBounds.y2+m);let{markTypeFilter:v=[]}=this._spec;this._linkedItemMap[e.id].forEach(e=>{if(v.includes(e.type))return;let i=e.getGraphics();i&&i.length&&i.forEach(i=>{var r,n,s;let{key:l}=i.context,a=e.id+"_"+i.context.key;(null==(r=this._linkedOutOfBrushElementsMap)?void 0:r[a])&&this._isBrushContainItem(t.globalAABBBounds,y,i)?(i.addState("inBrush",!0),this._linkedInBrushElementsMap[null==t?void 0:t.name]||(this._linkedInBrushElementsMap[null==t?void 0:t.name]={}),this._linkedInBrushElementsMap[null==t?void 0:t.name][a]=i,delete this._linkedOutOfBrushElementsMap[a]):(null==(s=null==(n=this._linkedInBrushElementsMap)?void 0:n[null==t?void 0:t.name])?void 0:s[a])&&!this._isBrushContainItem(t.globalAABBBounds,y,i)&&(i.removeState("inBrush"),i.addState("outOfBrush",!0),this._linkedOutOfBrushElementsMap[a]=i)})})}})}_isBrushContainItem(t,e,i){let r=[];if(["symbol","rect"].includes(i.type)){let{x1:t,x2:r,y1:s,y2:l}=null==i?void 0:i.globalAABBBounds;var n=[{x:t,y:s},{x:r,y:s},{x:r,y:l},{x:t,y:l}];for(let t=0;t<n.length;t++)if(function(t,e,i){let r=0,n=t[0];if(!n)return!1;for(let s=1;s<t.length;s++){let l=t[s];r+=Bh(n.x,n.y,l.x,l.y,e,i),n=l}let s=t[0];return Bu(n.x,s.x)&&Bu(n.y,s.y)||(r+=Bh(n.x,n.y,s.x,s.y,e,i)),0!==r}(e,n[t].x,n[t].y)||t>0&&function(t,e,i,r,n){for(let s=0,l=n[n.length-1];s<n.length;s++){let a=n[s];if(pK([t,e],[i,r],[a.x,a.y],[l.x,l.y]))return!0;l=a}return!1}(n[t-1].x,n[t-1].y,n[t].x,n[t].y,e))return!0;return!1}return t.intersects(i.globalAABBBounds)}_initItemMap(t,e,i){let{markTypeFilter:r=[]}=this._spec;Object.entries(t).forEach(([t,n])=>{n.forEach(t=>{if(r.includes(t.type))return;let n=t.getGraphics();n&&n.length&&n.forEach(r=>{let n=t.id+"_"+r.context.key;r.removeState("inBrush"),r.removeState("outOfBrush"),i&&r.addState(i,!0),e[n]=r})})})}_initMarkBrushState(t,e){this._brushComponents.forEach((e,i)=>{i!==t&&e.children[0].removeAllChild()}),this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._initItemMap(this._itemMap,this._outOfBrushElementsMap,e),this._initItemMap(this._linkedItemMap,this._linkedOutOfBrushElementsMap,e)}_setRegionMarkPickable(t,e){t.getGroupMark().getGraphics().forEach(t=>t.setAttribute("childrenPickable",e))}_stateClamp(t){return Math.min(Math.max(0,t),1)}_setAxisAndDataZoom(t,e){var i;if(this._zoomRecord=[],this._spec.zoomAfterBrush){let r=t.AABBBounds;null==(i=this._regionAxisMap["region_"+e.id])||i.forEach(t=>{var i,n;let s="bottom"===t.layoutOrient||"top"===t.layoutOrient,l=null!=(i=this._spec.axisRangeExpand)?i:0,{x1:a,x2:o,y1:h,y2:u}=r,d=s?"x":"y",c=s?a:h,p=s?o:u;if(this._axisDataZoomMap[t.id]){let i=this._axisDataZoomMap[t.id],r=i.relatedAxisComponent,n=r.getScale().invert(c-e.getLayoutStartPoint()[d]),s=r.getScale().invert(p-e.getLayoutStartPoint()[d]),a=i.dataToStatePoint(n),o=i.dataToStatePoint(s),h=this._stateClamp(a-l),u=this._stateClamp(o+l);i.setStartAndEnd(Math.min(h,u),Math.max(h,u),["percent","percent"]),this._zoomRecord.push({operateComponent:i,start:h,end:u,startValue:i.statePointToData(h),endValue:i.statePointToData(u)})}else{let i=t.getScale().range(),r=null!=(n=t.scaleRangeFactor())?n:[0,1],s=ec(i)<i[0],a=c-e.getLayoutStartPoint()[d],o=p-e.getLayoutStartPoint()[d],h=s?Math.min(a,o):Math.max(a,o),u=s?Math.max(a,o):Math.min(a,o),g=(u-i[0])/(ec(i)-i[0])*(r[1]-r[0])+r[0],f=(h-i[0])/(ec(i)-i[0])*(r[1]-r[0])+r[0],m=this._stateClamp(g-l),y=this._stateClamp(f+l);t.scaleRangeFactor([m,y]),t.effect.scaleUpdate(),this._zoomRecord.push({operateComponent:t,start:m,end:y,startValue:t.getScale().invert(u),endValue:t.getScale().invert(h)})}})}}_getNeedClearVRenderComponents(){return this._brushComponents}clearGraphic(){this._brushComponents&&this._brushComponents.forEach(t=>{t._container.incrementalClearChild()})}clear(){if(this._brushComponents){let t=this.getContainer();this._brushComponents.forEach((e,i)=>{this._initMarkBrushState(i,""),e.removeAllChild(),e.releaseBrushEvents(),t&&t.removeChild(e)}),this._brushComponents=null}}}Bd.type=rk.brush,Bd.builtInTheme={brush:{style:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",lineWidth:2},brushMode:"single",brushType:"rect",brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:0}},Bd.specKey="brush";let Bc=()=>{iv.registerComponent(Bd.type,Bd)};class Bp extends gz{constructor(){super(...arguments),this.type=rk.customMark,this.specKey="customMark",this.layoutType="none",this.layoutZIndex=H.CustomMark,this.layoutLevel=z.CustomMark}created(){super.created(),this.initMarks(),this.initEvent()}getMarkAttributeContext(){return this._markAttributeContext}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(t,e)=>{var i;return null==(i=this._option.globalScale.getScale(t))?void 0:i.scale(e)}}}initMarks(){if(!this._spec)return;let t=null;if(this._spec.parent){let e=this.getChart().getAllMarks().find(t=>t.getUserId()===this._spec.parent);"group"===e.type&&(t=e)}this._createExtensionMark(this._spec,t,`${st}_series_${this.id}_extensionMark`,0)}_createExtensionMark(t,e,i,r=0){var n,s;let l=this._createMark({type:t.type,name:t8(t.name)?`${t.name}`:`${i}_${r}`},{skipBeforeLayouted:!0,attributeContext:this._getMarkAttributeContext(),componentType:t.componentType,key:t.dataKey});if(l){if(t8(t.id)&&l.setUserId(t.id),(null==(n=this._option.globalInstance)?void 0:n.isAnimationEnable())&&t.animation){let e=cA({},cM(t.type,t,this._markAttributeContext));l.setAnimationConfig(e)}if(er(e)?this._marks.addMark(l):e&&e.addMark(l),this.initMarkStyleWithSpec(l,t),"group"===t.type&&(i=`${i}_${r}`,null==(s=t.children)||s.forEach((t,e)=>{this._createExtensionMark(t,l,i,e)})),t8(t.dataId)||en(t.dataIndex)){let e=this.getChart().getSeriesData(t.dataId,t.dataIndex);e&&(e.target.addListener("change",()=>{l.getData().updateData()}),l.setDataView(e))}}}initEvent(){}_compareSpec(t,e){let i=super._compareSpec(t,e);return t5(e,t)||(i.reMake=!0),i.change=!0,i.reRender=!0,i}_getMarkAttributeContext(){return{vchart:this._option.globalInstance,chart:this.getChart(),globalScale:(t,e)=>{var i;return null==(i=this._option.globalScale.getScale(t))?void 0:i.scale(e)},getLayoutBounds:()=>{let{x:t,y:e}=this.getLayoutStartPoint(),{width:i,height:r}=this.getLayoutRect();return(new pY).set(t,e,t+i,e+r)}}}_getLayoutRect(){let t=new pY;return this.getMarks().forEach(e=>{let i=e.getProduct();i&&t.union(i.AABBBounds)}),t.empty()?{width:0,height:0}:{width:t.width(),height:t.height()}}getBoundsInRect(t){this.setLayoutRect(t);let e=this._getLayoutRect(),{x:i,y:r}=this.getLayoutStartPoint();return{x1:i,y1:r,x2:i+e.width,y2:r+e.height}}getVRenderComponents(){let t=[],e=i=>{if(i&&"group"===i.type)i.getMarks().forEach(t=>{e(t)});else if("component"===i.type){let e=null==i?void 0:i.getComponent();e&&t.push(e)}};return this.getMarks().forEach(t=>{e(t)}),t}}Bp.type=rk.customMark,Bp.specKey="customMark";let Bg=()=>{iv.registerComponent(Bp.type,Bp)};class Bf{constructor(t,e){this._chartLayoutRect={x:0,y:0,width:1,height:1},this._col=1,this._row=1,this._elementMap=new Map,this.standardizationSpec(t),this._gridInfo=t,this._col=t.col,this._row=t.row,this._colSize=Array(this._col).fill(null),this._rowSize=Array(this._row).fill(null),this._colElements=Array(this._col).fill([]),this._rowElements=Array(this._row).fill([]),this._onError=null==e?void 0:e.onError,this.initUserSetting()}standardizationSpec(t){var e,i,r;t.col=null!=(e=t.col)?e:1,t.row=null!=(i=t.row)?i:1,t.elements=null!=(r=t.elements)?r:[]}initUserSetting(){this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((t,e)=>{t||(this._colSize[e]={value:0,isUserSetting:!1,isLayoutSetting:!1})}),this._rowSize.forEach((t,e)=>{t||(this._rowSize[e]={value:0,isUserSetting:!1,isLayoutSetting:!1})})}setSizeFromUserSetting(t,e,i,r){t.forEach(t=>{t.index<0&&t.index>=i||(en(t.size)?e[t.index]={value:+t.size,isUserSetting:!0,isLayoutSetting:!1}:tQ(t.size)&&(e[t.index]={value:t.size(r),isUserSetting:!0,isLayoutSetting:!1}))})}clearLayoutSize(){this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach(t=>{t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)}),this._rowSize.forEach(t=>{t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)})}getItemGridInfo(t){var e;let i,r=this._elementMap.get(t);return r||((i=null==(e=this._gridInfo.elements)?void 0:e.find(e=>{var i;if("modelId"in e&&t8(e.modelId)){if(t8(t.model.userId)&&t.model.userId===e.modelId)return!0}else if("modelKey"in e&&t8(e.modelKey)&&"modelIndex"in e&&t8(e.modelIndex)&&(null!=(i=t.model.specKey)?i:t.model.type)===e.modelKey&&t.model.getSpecIndex()===e.modelIndex)return!0;return!1}))||(i={col:0,colSpan:1,row:0,rowSpan:1}),this._elementMap.set(t,i),i)}getSizeFromGrid(t,e){var i;let r="col"===e?this._colSize:this._rowSize,n=0;for(let s=t[e];s<t[e]+(null!=(i=t[`${e}Span`])?i:1);s++)n+=r[s].value;return n}getSizeFromUser(t,e){var i,r;let n="col"===e?this._colSize:this._rowSize;if(!(null==(i=n[t[e]])?void 0:i.isUserSetting))return;let s=0;for(let i=t[e];i<t[e]+(null!=(r=t[`${e}Span`])?r:1);i++){if(!n[i].isUserSetting)return;s+=n[i].value}return s}setItemLayoutSizeToGrid(t,e){if(Bm(t))e.colSpan&&e.colSpan>1||this._colSize[e.col].isUserSetting||(this._colSize[e.col].value=Math.max(this._colSize[e.col].value,t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight),this._colSize[e.col].isLayoutSetting=!0);else{if(e.rowSpan&&e.rowSpan>1||this._rowSize[e.row].isUserSetting)return;this._rowSize[e.row].value=Math.max(this._rowSize[e.row].value,t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom),this._rowSize[e.row].isLayoutSetting=!0}}layoutGrid(t){let e="col"===t?this._colSize:this._rowSize,i="col"===t?this._chartLayoutRect.width:this._chartLayoutRect.height,r=[];e.forEach(t=>{t.isUserSetting||t.isLayoutSetting?i-=t.value:r.push(t)}),i<0&&console.warn(`layout content ${t} size bigger than chart`),r.forEach(t=>t.value=i/r.length)}getItemPosition(t){let e=this.getItemGridInfo(t),i={x:this._chartLayoutRect.x,y:this._chartLayoutRect.y};for(let t=0;t<e.col;t++)i.x+=this._colSize[t].value;for(let t=0;t<e.row;t++)i.y+=this._rowSize[t].value;return i.x+=t.layoutPaddingLeft+t.layoutOffsetX,i.y+=t.layoutPaddingTop+t.layoutOffsetY,i}getItemLayoutRect(t){var e,i;let r=this.getItemGridInfo(t);return{width:(null!=(e=this.getSizeFromGrid(r,"col"))?e:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!=(i=this.getSizeFromGrid(r,"row"))?i:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom}}layoutItems(t,e,i,r){this._chartLayoutRect=i,this._chartViewBox=r,this.clearLayoutSize(),e.sort((t,e)=>e.layoutLevel-t.layoutLevel);let n=e.filter(t=>"normal"===t.layoutType&&!1!==t.getModelVisible()),s=n.filter(t=>Bm(t)),l=n.filter(t=>!Bm(t));n.forEach(t=>{this.layoutOneItem(t,"user",!1)});let a=e.filter(t=>"region-relative"===t.layoutType),o=a.filter(t=>Bm(t)),h=a.filter(t=>!Bm(t));o.forEach(t=>this.layoutOneItem(t,"user",!1)),this.layoutGrid("col"),l.forEach(t=>this.layoutOneItem(t,"colGrid",!1)),h.forEach(t=>{this.layoutOneItem(t,"colGrid",!1)}),this.layoutGrid("row"),h.forEach(t=>{this.layoutOneItem(t,"grid",!1)}),s.forEach(t=>this.layoutOneItem(t,"grid",!1)),o.forEach(t=>{this.layoutOneItem(t,"grid",!0)}),this.layoutGrid("col"),e.filter(t=>"region"===t.layoutType).forEach(t=>this.layoutOneItem(t,"grid",!1)),this.layoutAbsoluteItems(e.filter(t=>"absolute"===t.layoutType)),e.filter(t=>"absolute"!==t.layoutType).forEach(t=>{t.setLayoutStartPosition(this.getItemPosition(t))})}layoutAbsoluteItems(t){t.forEach(t=>{t.absoluteLayoutInRect(this._chartLayoutRect)})}layoutOneItem(t,e,i){var r,n;let s="rowGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),l="colGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),a=this.getItemGridInfo(t),o={width:(null!=(r=l(a,"col"))?r:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!=(n=s(a,"row"))?n:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom},h=t.computeBoundsInRect(o);en(h.width)||(h.width=o.width),en(h.height)||(h.height=o.height),t.setLayoutRect("grid"!==e?h:o),this.setItemLayoutSizeToGrid(t,a)}}function Bm(t){return"left"===t.layoutOrient||"right"===t.layoutOrient}Bf.type="grid";let By=()=>{iv.registerLayout(Bf.type,Bf)};var Bv=i(1788);let Bb=()=>{(0,Bv.C)()},B_="vchart-tooltip",Bx=`${B_}-container`,BC=`${B_}-title`,Bw=`${B_}-content-box`,BS={offsetX:10,offsetY:10},BA="99999999999999";function BM(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\(/g,"&#40;").replace(/  /g," &nbsp;")}let Bk=(t,e)=>t?(e||(e=t.getBoundingClientRect()),t.offsetWidth>0?e.width/t.offsetWidth:t.offsetHeight>0?e.height/t.offsetHeight:1):1,BT=t=>t6(t)&&""!==(null==t?void 0:t.trim())||tG(t)?BM(t):"",BR=(t,e)=>{let i;if(t8(t)){if(tG(t))i=t;else if(tQ(t)){let r=t(e);tG(r)&&(i=r)}}return i},BB={left:[-2,0],right:[2,0],top:[0,-2],bottom:[0,2],insideTop:[0,-1.5],insideBottom:[0,1.5],insideLeft:[-1.5,0],insideRight:[1.5,0],insideTopLeft:[-1.5,-1.5],insideTopRight:[1.5,-1.5],insideBottomLeft:[-1.5,1.5],insideBottomRight:[1.5,1.5],lt:[-2,-2],tl:[-2,-2],rt:[2,-2],tr:[2,-2],bl:[-2,2],lb:[-2,2],br:[2,2],rb:[2,2],inside:[0,0],center:[0,0],centerBottom:[0,1],centerTop:[0,-1],centerLeft:[-1,0],centerRight:[1,0]},BP=(t,e,i=2)=>{var r,n;return null!=(n=null==(r=BB[t])?void 0:r[+("x"!==e)])?n:i},BE=t=>e_(t)&&(t8(t.left)||t8(t.right)||t8(t.top)||t8(t.bottom)),BI=t=>e_(t)&&(t8(t.x)||t8(t.y));class BL extends gl{constructor(){super(...arguments),this._visible=!0,this._isReleased=!1,this.showTooltip=(t,e,i)=>{let{changePositionOnly:r}=i;return r?this.changeTooltipPosition(i,e):this.changeTooltip(!0,i,e)},this.changeTooltip=(t,e,i)=>this._isReleased?1:t?this.changeTooltipPosition(e,i):(this._updateTooltip(!1,e),0),this.changeTooltipPosition=(t,e)=>{var i,r,n,s,l;if(this._isReleased)return 1;let a=t.event,{tooltipSpec:o,activeTooltipSpec:h,changePositionOnly:u}=t;if(!h)return 1;let d=h.activeType;if(h.handler)return null!=(n=null==(r=(i=h.handler).showTooltip)?void 0:r.call(i,d,e,t))?n:0;let c=this._getActualTooltipPosition(h,t,this._getTooltipBoxSize(h,u));h.position=c;let p=null!=(s=h.updatePosition)?s:null==(l=o[d])?void 0:l.updatePosition;p&&(h.position=p(h.position,e,t));let g=!1!==(null==h?void 0:h.visible);return e&&"pointerout"!==a.type&&h.visible&&(h.title||h.content)||(g=!1),this._updateTooltip(g,Object.assign(Object.assign({},t),{changePositionOnly:u})),0},this._getActualTooltipPosition=(t,e,i)=>{var r,n,s,l,a,o,h,u,d;let c=this._chartOption.getRectByDimensionData,{tooltipSpec:p}=e,g={x:1/0,y:1/0};if(!p)return g;let f=e.event,{activeType:m,data:y}=t,v="dimension"===m?null==(n=null==(r=y[0])?void 0:r.data)?void 0:n[0]:null==y?void 0:y[0],{offsetX:b,offsetY:_}=this._option,x=p[m],C=d9(null==x?void 0:x.position,y,e),w=null!=(s=d9(null==x?void 0:x.positionMode,y,e))?s:"mark"===m?"mark":"pointer",{width:S=0,height:A=0}=null!=i?i:{},M="canvas"===p.renderMode,k=null==(l=null==e?void 0:e.chart)?void 0:l.getCanvasRect(),T=null!=(a=null==k?void 0:k.width)?a:se,R=null!=(o=null==k?void 0:k.height)?o:si,B=!1,P={width:0,height:0},E,I={x:0,y:0},L={x:0,y:0},F=1,O=1,D=eE(this._env);if(D&&!p.confine?(P.width=window.innerWidth,P.height=window.innerHeight):(P.width=T,P.height=R),D&&!M){let t=this._getParentElement(p);L=null!=(u=null==(h=null==t?void 0:t.getBoundingClientRect)?void 0:h.call(t))?u:g;let e=null!=(d=this._compiler.getCanvas())?d:this._chartContainer;I={x:(E=null==e?void 0:e.getBoundingClientRect()).x-L.x,y:E.y-L.y},F=Bk(e,E),O=Bk(t,L)}let H=O/F,z={},W={x:C,y:C},N={x:["left","right"],y:["top","bottom"]},j=({orient:t,mode:i,offset:r},n)=>{var s;let l,a,o=e.model,h=null==o?void 0:o.getLayoutStartPoint(),u=null!=r?r:"x"===n?b:_;if("mark"===i){B=!0;let t=e.item,i=null==t?void 0:t.AABBBounds;i&&h&&(l=("x"===n?i.x1:i.y1)+h[n],a=("x"===n?i.x2:i.y2)+h[n])}else if(c&&"crosshair"===i&&"cartesian"===(null==(s=null==v?void 0:v.series)?void 0:s.coordinate)&&v.datum&&v.datum.length){B=!0;let t=c(v,h);t&&(l=t.start[n],a=t.end[n])}else W[n]=t;if(B){let e=N[n][0],i="x"===n?S:A;switch(BP(t,n)){case -2:z[e]=l-i*H-u;break;case -1.5:z[e]=l+u;break;case 0:z[e]=(l+a)/2-i*H/2;break;case -1:z[e]=(l+a)/2-i*H-u;break;case 1:z[e]=(l+a)/2+u;break;case 1.5:z[e]=a-i*H-u;break;case 2:z[e]=a+u}}},G=["x","y"];if(e_(C))if(BE(C)){let{left:t,right:e,top:i,bottom:r}=C;z.left=BR(t,f),z.top=BR(i,f),z.right=BR(e,f),z.bottom=BR(r,f)}else BI(C)&&G.forEach(t=>{let e=C[t];tG(e)||tQ(e)?z[N[t][0]]=BR(e,f):j(e,t)});else t8(C)&&(j({orient:C,mode:w},"x"),j({orient:C,mode:w},"y"));let V={x:null,y:null};return G.forEach(t=>{var e;let i="x"===t?S:A,r="x"===t?T:R,n="x"===t?b:_,s=BP(W[t],t);if(en(z[N[t][0]]))V[t]=z[N[t][0]];else if(en(z[N[t][1]]))V[t]=r-i*H-z[N[t][1]];else{let e="x"===t?f.canvasX:f.canvasY;V[t]=s>0?e+n:0===s?e-i*H/2:e-i*H-n}V[t]*=F,D&&(V[t]+=I[t]),V[t]/=O;let l="x"===t?P.width:P.height,a=p.confine?-(L[t]-(null!=(e=null==E?void 0:E[t])?e:0)/F)/O:-L[t]/O,o=l/O+a-i;2!==s&&V[t]<a?B?V[t]=a:(V[t]+=0===s?n+i/2:2*n+i,V[t]>o&&(V[t]=o)):-2!==s&&V[t]>o&&(B?V[t]=o:(V[t]-=0===s?n+i/2:2*n+i,V[t]<a&&(V[t]=a)))}),V}}get env(){return this._env}onAdd(t){super.onAdd(t);let e=t.component;this._component=e,this._chartOption=e.getOption(),this._env=this._chartOption.mode,this._chartContainer=this._chartOption.globalInstance.getContainer(),this._compiler=e.getCompiler(),this._initFromSpec()}hideTooltip(t){return this.changeTooltip(!1,t)}release(){var t,e,i,r;let n=null!=(e=null==(t=this._component)?void 0:t.getSpec())?e:{};n.handler?null==(r=(i=n.handler).release)||r.call(i):(this._removeTooltip(),this._isReleased=!0,this._chartOption=null,this._component=null)}_getDefaultOption(){var t,e;let{offset:i}=this._component.getSpec();return i?{offsetX:null!=(t=i.x)?t:BS.offsetX,offsetY:null!=(e=i.y)?e:BS.offsetY}:BS}_getParentElement(t){return t.parentElement}getTooltipContainer(){return this._container}_initFromSpec(){this._option=this._getDefaultOption()}reInit(){this._initFromSpec()}}BL.specKey="tooltip";let BF=(t,e)=>t8(t)?tq(t)?t.map(t=>`${t}px`).join(" "):`${t}px`:null!=e?e:"initial",BO=(t={},e={})=>{var i,r;t8(t.fontFamily)&&(e.fontFamily=t.fontFamily);let n=null!=(i=t.fill)?i:t.fontColor;return t8(n)&&(e.color=n),t8(t.fontWeight)&&(e.fontWeight=t.fontWeight),t8(t.textAlign)&&(e.textAlign=t.textAlign),t8(t.fontSize)&&(e.fontSize=BF(t.fontSize)),t8(t.maxWidth)&&(e.maxWidth=BF(t.maxWidth)),t.multiLine||t8(t.maxWidth)&&!1!==t.multiLine?(e.whiteSpace="initial",e.wordBreak=null!=(r=t.wordBreak)?r:"break-word"):(e.wordBreak="normal",e.whiteSpace="nowrap"),e},BD=(t={})=>{let{lineHeight:e}=t;return t.fontSize?eS(e,t.fontSize):0},BH=(t={})=>{var e,i,r,n;let{style:s={},enterable:l,transitionDuration:a}=t,{panel:o={},titleLabel:h,shape:u,keyLabel:d,valueLabel:c,spaceRow:p,align:g}=s,{panelStyle:f,panelPadding:m}=Bz(o),y={marginTop:"0px",marginBottom:"0px"};f.pointerEvents=l?"auto":"none",a&&(f.transitionDuration=a?`${a}ms`:"initial",f.transitionProperty=a?"transform":"initial",f.transitionTimingFunction=a?"ease-out":"initial"),en(p)&&(y.marginBottom=`${p}px`);let v={width:BF(null!=(e=null==u?void 0:u.size)?e:8)},b=BO(h),_=BO(d),x=BO(c),C="right"===g?"marginLeft":"marginRight";"right"===g&&(f.direction="rtl"),er(b.textAlign)&&(b.textAlign="right"===g?"right":"left"),er(_.textAlign)&&(_.textAlign="right"===g?"right":"left"),er(x.textAlign)&&(x.textAlign="right"===g?"left":"right"),v[C]=BF(null!=(i=u.spacing)?i:8),_[C]=BF(null!=(r=d.spacing)?r:26),x[C]=BF(null!=(n=c.spacing)?n:0);let w=Math.max(BD(c),BD(d));return y.lineHeight=w>0?`${w}px`:"20px",{panelPadding:m,row:y,panel:f,title:b,shape:v,key:_,value:x}},Bz=t=>{var e;let{backgroundColor:i,border:r,shadow:n,padding:s}=t,l={borderWidth:`${null!=(e=null==r?void 0:r.width)?e:0}px`},a=null;(null==r?void 0:r.color)&&(l.borderColor=r.color),i&&(l.backgroundColor=i),l.boxShadow=n?`${n.x}px ${n.y}px ${n.blur}px ${n.spread}px ${n.color}`:"initial";let{radius:o}=null!=r?r:{};return t8(o)&&(l.borderRadius=en(o)?`${o}px`:`${o}`),s&&(l.padding=BF(a=A2(s))),{panelStyle:l,panelPadding:a}};function BW(t,e){t&&t.style&&e&&Object.keys(e).forEach(i=>{t.style[i]=e[i]})}let BN=t=>{iv.registerComponentPlugin(t.type,t)};var Bj=i(74984);class BG extends BL{getVisibility(){return!!this._rootDom&&"visible"===this._rootDom.style.visibility}setVisibility(t){t!==this.getVisibility()&&this._rootDom&&(this._rootDom.style.visibility=t?"visible":"hidden")}getRootDom(){return this._rootDom}constructor(){super(BG.type),this.type=mf.dom,this._tooltipContainer=null==eP?void 0:eP.body}onAdd(t){super.onAdd(t),this._initStyle(),this.initEl()}initEl(){let t=this._component.getSpec().parentElement;if(eP&&t&&t.children&&t.children.length){for(let e=0;e<t.children.length;e++)if(t.children[e].classList.contains(Bx)){this._container=t.children[e];break}this._container||(this._container=eP.createElement("div"),this._container.style.position="relative",this._container.style.zIndex=BA,this._container.classList.add(Bx),t.appendChild(this._container))}}initRootDom(){var t;let e=this._component.getSpec(),i=document.createElement("div"),r=null==(t=this._chartOption)?void 0:t.getTheme("fontFamily");BW(i,Object.assign({left:"0",top:"0",pointerEvents:"none",padding:"12px",position:"absolute",zIndex:BA,fontFamily:null!=r?r:eW.fontFamily,fontSize:"11px",borderRadius:"3px",borderStyle:"solid",lineHeight:"initial",background:"#fff",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)",maxWidth:"100wh",maxHeight:"100vh",visibility:"hidden"},this._domStyle.panel)),i.classList.add(e.className),i.setAttribute("vchart-tooltip-id",`${this.id}`),this._container.appendChild(i),this._rootDom=i}_getTooltipBoxSize(t,e){var i;this._rootDom||this.initRootDom(),e||this._updateDomStringByCol(t),this._updateDomStyle("height",e);let r=null==(i=this._rootDom)?void 0:i.getBoundingClientRect();return{width:null==r?void 0:r.width,height:null==r?void 0:r.height}}_removeTooltip(){this._rootDom&&this._rootDom.parentNode&&(this._rootDom.parentNode.removeChild(this._rootDom),this._rootDom=null),this._container=null}_updateTooltip(t,e){var i,r;if(t&&this._rootDom){let{tooltipSpec:n,activeTooltipSpec:s}=e;e.changePositionOnly||(this._tooltipActual=s);let l=this._rootDom;if(l){let{x:a=0,y:o=0}=null!=(i=s.position)?i:{},h={x:a,y:o},u=this.getVisibility();n.updateElement&&(this._updatePosition(null!=(r=this._cacheCustomTooltipPosition)?r:{x:a,y:o}),n.updateElement(l,s,e),h=this._getActualTooltipPosition(s,e,{width:l.offsetWidth,height:l.offsetHeight}),this._cacheCustomTooltipPosition=h),!u&&t&&(this._rootDom.style.transition="none",this._updatePosition(h,!1),this._rootDom.getBoundingClientRect()),this._updatePosition(h)}this.setVisibility(t)}else this.setVisibility(t),this._cacheCustomTooltipPosition=void 0}_initStyle(){let t=this._component.getSpec();this._domStyle=BH(t)}_updateDomStringByCol(t){var e;let{title:i={},content:r}=t,n=r&&r.length,s=this._domStyle.row,l=[...this._rootDom.children],a=l.find(t=>t.className.includes(BC)),o=l.find(t=>t.className.includes(Bw));if(!a&&!1!==i.visible){a=document.createElement("h2");let t=document.createElement("span");a.appendChild(t),a.classList.add(BC),this._rootDom.firstChild?this._rootDom.insertBefore(a,this._rootDom.firstChild):this._rootDom.appendChild(a)}a&&!1!==i.visible?(BW(a,Object.assign(Object.assign(Object.assign({},this._domStyle.title),n?s:{marginBottom:"0px"}),{marginTop:"0px"})),a.firstChild.innerHTML=`${null!=(e=i.value)?e:""}`):a&&!1===i.visible&&a.parentNode.removeChild(a);let h=["shape","key","value"];if(!o&&n&&(o=document.createElement("div"),h.forEach(t=>{let e=document.createElement("div");e.classList.add(`${B_}-column`),e.classList.add(`${B_}-${t}-column`),e.setAttribute("data-col",t),o.appendChild(e)}),o.classList.add(Bw),this._rootDom.appendChild(o)),o&&n){let t=[...o.children];BW(o,{whiteSpace:"nowrap"}),t.forEach((t,e)=>{let i=t.getAttribute("data-col");if(i&&h.includes(i)){let e="shape"===i&&r.every(t=>!t.hasShape||!t.shapeType);BW(t,Object.assign(Object.assign({},this._domStyle[i]),{display:e?"none":"inline-block",verticalAlign:"top"}));let n=[...t.children];n.slice(r.length).forEach(t=>{t.parentNode.removeChild(t)}),r.forEach((e,l)=>{let a=n[l];a||((a=document.createElement("div")).classList.add(`${B_}-${i}`),t.appendChild(a));let o=Object.assign({},s);l===r.length-1&&(o.marginBottom="0px"),o.display=!1===e.visible?"none":"block",o.height="initial","key"===i?(a.innerHTML=BT(e.key),e.keyStyle&&BO(e.keyStyle,o)):"value"===i?(a.innerHTML=BT(e.value),e.valueStyle&&BO(e.valueStyle,o)):"shape"===i&&(a.innerHTML=function(t,e){var i,r,n,s,l,a;let o,h;if(!t||!t.hasShape||!t.shapeType)return"";let u='style="display:inline-block;vertical-align:middle;"',{shapeType:d,shapeStroke:c,shapeHollow:p=!1,shapeFill:g}=t,f=null!=(i=t.shapeSize)?i:8,m=t.shapeLineWidth?BM(t.shapeLineWidth)+"px":"0px",y="currentColor",v=()=>c?BM(c):y,b=t=>new pN.m({symbolType:t,size:f,fill:!0}),_=b(d),x=_.getParsedPath();if(!x.path&&x.pathStr&&(_=b(x.pathStr)),_.getParsedPath().path){let t=_.getParsedPath().path;h=t.toString(),o=t.bounds}else x.isSvg&&x.svgCache&&(h=x.svgCache.map(t=>t.path.toString()).join(),o=x.svgCache.reduce((t,e)=>t.union(e.path.bounds),new pY));let C=`${o.x1} ${o.y1} ${o.width()} ${o.height()}`;if("0px"!==m){let[t,e,i,r]=C.split(" ").map(t=>Number(t)),n=Number(m.slice(0,-2));C=`${t-n/2} ${e-n/2} ${i+n} ${r+n}`}let w=Bj.a.IsGradientStr(g);if(!g||t6(g)&&!w||p)return y=p?"none":g?BM(g):"currentColor",`
    <svg ${u} width="${f}" height="${f}" viewBox="${C}">
      <path
        d="${h}"
        style="fill: ${y}; stroke: ${v()}; stroke-width: ${m}"
      >
      </path>
    </svg>`;let S=w?Bj.a.Parse(g):e_(g)?g:null;if(S){y="gradientColor"+(null!=e?e:"");let t="",i=(null!=(r=S.stops)?r:[]).map(t=>`<stop offset="${BM(t.offset.toString())}" stop-color="${BM(t.color)}"/>`).join("");return"radial"===S.gradient?t=`<radialGradient id="${y}" cx="50%" cy="50%" r="50%" fx="0%" fy="0%">
      ${i}
      </radialGradient>`:"linear"===S.gradient&&(t=`<linearGradient id="${y}" x1="${100*(null!=(n=S.x0)?n:0)}%" y1="${100*(null!=(s=S.y0)?s:0)}%" x2="${100*(null!=(l=S.x1)?l:0)}%" y2="${100*(null!=(a=S.y1)?a:0)}%">
      ${i}
      </linearGradient>`),`
    <svg ${u} width="${f}" height="${f}" viewBox="-0.5 -0.5 1 1">
      ${t}
      <path
        d="${h}"
        style="fill: url(#${y}); stroke: ${v()}; stroke-width: ${m}"
      >
      </path>
    </svg>`}return""}(e,`${this.id}_${l}`)),BW(a,o)})}})}else o&&!n&&o.parentNode.removeChild(o)}_updateDomStyle(t="width",e){var i,r,n,s,l;let a=this._rootDom,o=[...a.children].find(t=>t.className.includes(Bw)),h=[...a.children].find(t=>t.className.includes(BC));if(o){let a=this._component.getSpec(),u={},d=null==(i=a.style)?void 0:i.titleLabel;if(d&&d.autoWidth&&!1!==d.multiLine&&h){let e=[...o.children].reduce((e,i)=>"height"===t?e+i.getBoundingClientRect().width:Math.max(e,i.getBoundingClientRect().width),0);e>0&&(h.style.maxWidth=`${e}px`,h.style.maxWidth=`${Math.ceil(o.getBoundingClientRect().width)}px`)}if(t8(null==(r=null==a?void 0:a.style)?void 0:r.maxContentHeight)){let t=h&&h.className.includes(BC)?h.getBoundingClientRect().height+(null!=(n=a.style.spaceRow)?n:0):0,e=this._chartOption.getChartViewRect(),i=eS(a.style.maxContentHeight,Math.min(e.height,document.body.clientHeight)-t-(this._domStyle.panelPadding?this._domStyle.panelPadding[0]+this._domStyle.panelPadding[1]:0));i>0&&(u.maxHeight=`${i}px`,u.overflowY="auto",u.width=`calc(100% + ${this._domStyle.panelPadding?this._domStyle.panelPadding[1]+"px":"10px"})`,BW(o,u))}let c=o.children,p=[];if(c){for(let i=0;i<c.length;i++){let r=null!=(s=c[i].children)?s:[];for(let i=0;i<r.length;i++){e&&(r[i].style[t]="initial");let n=r[i].getBoundingClientRect()[t];(void 0===p[i]||p[i]<n)&&(p[i]=n)}}for(let e=0;e<c.length;e++){let i=null!=(l=c[e].children)?l:[];for(let e=0;e<i.length;e++)i[e].style[t]=`${p[e]}px`}}}}_getParentElement(t){var e;return null!=(e=this._container)?e:super._getParentElement(t)}isTooltipShown(){return this.getVisibility()}reInit(){super.reInit(),this._initStyle(),this._rootDom&&BW(this._rootDom,this._domStyle.panel),this.getVisibility()&&(this._updateDomStringByCol(this._tooltipActual),this._updateDomStyle("height",!1))}_updatePosition({x:t,y:e},i=!0){this._rootDom&&(this._rootDom.style.transform=`translate3d(${t}px, ${e}px, 0)`,i&&""!==this._rootDom.style.transition&&(this._rootDom.style.transition="",Object.assign(this._rootDom.style,this._domStyle.panel)))}}BG.type=mf.dom;let BV=()=>{BN(BG)};var BZ=i(13342),BU=i(11681);let BK=(t,...e)=>{let i=[t.shape,...e.map(t=>null==t?void 0:t.shape)],r=[t.key,...e.map(t=>null==t?void 0:t.key)],n=[t.value,...e.map(t=>null==t?void 0:t.value)];return(0,cQ.Z)(t,...e,{shape:i.every(aY.Z)?void 0:(0,cQ.Z)({},...i),key:r.every(aY.Z)?void 0:(0,cQ.Z)({},...r),value:n.every(aY.Z)?void 0:(0,cQ.Z)({},...n)})},B$=t=>{let{width:e,height:i,wordBreak:r="break-word",textAlign:n,textBaseline:s,text:l}=t;return Array.isArray(l)?{width:e,height:i,wordBreak:r,textAlign:n,textBaseline:s,singleLine:!1,textConfig:(0,kx.IX)(l).map(e=>Object.assign(Object.assign({},t),{text:e}))}:{width:e,height:i,wordBreak:r,textAlign:n,textBaseline:s,singleLine:!1,textConfig:null==l?void 0:l.text}},BY={panel:{visible:!0,cornerRadius:[3,3,3,3],fill:"white",shadow:!0,shadowBlur:12,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:4,shadowSpread:0,stroke:"white"},titleStyle:{value:{fill:"#4E5969",fontFamily:pe.iR,fontSize:14,lineHeight:18,textAlign:"left",textBaseline:"middle"},spaceRow:6},contentStyle:{shape:{fill:"black",size:8,symbolType:"circle",spacing:6},key:{fill:"#4E5969",fontFamily:pe.iR,fontSize:12,lineHeight:18,textAlign:"left",textBaseline:"middle",spacing:26},value:{fill:"#4E5969",fontFamily:pe.iR,fontSize:12,lineHeight:18,textAlign:"right",textBaseline:"middle",spacing:0},spaceRow:6},padding:10,positionX:"right",positionY:"bottom",offsetX:10,offsetY:10,parentBounds:(new aI.FB).setValue(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),autoCalculatePosition:!0,autoMeasure:!0,pickable:!1,childrenPickable:!1,zIndex:500},BX=["pointerX","pointerY","offsetX","offsetY","positionX","positionY","parentBounds"];(0,op.M)(),(0,m6.k)(),(0,pj.k)(),(0,py.g)(),(0,pv.v)();class Bq extends g3.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cQ.Z)({},Bq.defaultAttributes,t),e),this.name="tooltip"}render(){var t;let{visible:e,content:i,panel:r,keyWidth:n,valueWidth:s,hasContentShape:l,autoCalculatePosition:a,autoMeasure:o,align:h}=this.attribute;if(!e)return void this.hideAll();o&&Bq.measureTooltip(this.attribute),a&&Bq.calculateTooltipPosition(this.attribute);let u=(0,BU.o)(this.attribute.padding);this._tooltipPanel=this.createOrUpdateChild("tooltip-background",Object.assign({visible:!0},r),"rect"),this._tooltipTitleContainer=this.createOrUpdateChild("tooltip-title",{visible:!0,x:u[3],y:u[0]},"group");let d=Bq.getTitleAttr(this.attribute);this._tooltipTitleSymbol=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-shape",(0,cQ.Z)({symbolType:"circle"},d.shape,{visible:(0,pt.pn)(d)&&(0,pt.pn)(d.shape)}),"symbol"),"object"!=typeof d.value.text||null===d.value.text||"rich"!==d.value.text.type&&"html"!==d.value.text.type?d.value.multiLine?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:(0,pt.pn)(d)&&(0,pt.pn)(d.value)},B$(d.value)),"richtext"):this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({text:null!=(t=d.value.text)?t:"",visible:(0,pt.pn)(d)&&(0,pt.pn)(d.value)},d.value),"text"):"rich"===d.value.text.type?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:(0,pt.pn)(d)&&(0,pt.pn)(d.value)},B$(d.value)),"richtext"):"html"===d.value.text.type&&(this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({html:Object.assign(Object.assign({dom:d.value.text.text},pe.Ze),d.value),visible:(0,pt.pn)(d)&&(0,pt.pn)(d.value),width:d.value.width,height:d.value.height,wordBreak:d.value.wordBreak,textAlign:d.value.textAlign,textBaseline:d.value.textBaseline,singleLine:!1,textConfig:[]},d.value),"richtext"));let c=(0,pt.pn)(d.shape)?d.shape.size+d.shape.spacing:0,{textAlign:p,textBaseline:g}=d.value,f=r.width-u[3]-u[0]-c;"center"===p?this._tooltipTitle.setAttribute("x",c+f/2):"right"===p||"end"===p?this._tooltipTitle.setAttribute("x",c+f):this._tooltipTitle.setAttribute("x",c),"bottom"===g?this._tooltipTitle.setAttribute("y",d.height):"middle"===g?this._tooltipTitle.setAttribute("y",d.height/2):this._tooltipTitle.setAttribute("y",0);let m=(0,pt.pn)(d)?d.height+d.spaceRow:0;if(this._tooltipContent=this.createOrUpdateChild("tooltip-content",{visible:!0},"group"),this._tooltipContent.removeAllChild(!0),i&&i.length){this._tooltipContent.setAttribute("x",u[3]),this._tooltipContent.setAttribute("y",u[0]+m);let t=0;i.forEach((e,i)=>{let r=Bq.getContentAttr(this.attribute,i);if(!(0,pt.pn)(r))return;let a=`tooltip-content-${i}`,o=this._tooltipContent.createOrUpdateChild(a,{visible:!0,x:0,y:t},"group"),u=r.shape.size+r.shape.spacing,d="right"===h?(l?u:0)+((0,pt.pn)(r.key)?n+r.key.spacing:0)+((0,pt.pn)(r.value)?s:0):0;this._createShape("right"===h?d-r.shape.size/2:d+r.shape.size/2,r,o,a),l&&("right"===h?d-=u:d+=u);let c=this._createKey(r,o,a);c&&((0,om.He)(h,c,r.key.textAlign,d,n),c.setAttribute("y",0),"right"===h?d-=n+r.key.spacing:d+=n+r.key.spacing);let p=this._createValue(r,o,a);if(p){let t="right";(0,c2.Z)(r.value.textAlign)?t=r.value.textAlign:(0,pt.pn)(r.key)||"right"===h||(t="left"),p.setAttribute("textAlign",t),(0,om.He)(h,p,t,d,s),p.setAttribute("y",0)}t+=r.height+r.spaceRow})}}_createShape(t,e,i,r){var n;if((0,pt.pn)(e.shape))return i.createOrUpdateChild(`${r}-shape`,Object.assign({visible:!0,x:t,y:e.shape.size/2+((null!=(n=(0,hl.VA)(e.key.lineHeight,e.key.fontSize))?n:e.key.fontSize)-e.shape.size)/2},e.shape),"symbol")}_createKey(t,e,i){var r;if((0,pt.pn)(t.key))return t.key.multiLine?e.createOrUpdateChild(`${i}-key`,Object.assign(Object.assign({visible:!0},B$(t.key)),{textBaseline:"top"}),"richtext"):"object"!=typeof t.key.text||null===t.key.text||"rich"!==t.key.text.type&&"html"!==t.key.text.type?e.createOrUpdateChild(`${i}-key`,Object.assign(Object.assign({visible:!0,text:null!=(r=t.key.text)?r:""},t.key),{textBaseline:"top"}),"text"):"rich"===t.key.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},B$(t.key)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild(`${i}-value`,{html:Object.assign(Object.assign({dom:t.key.text.text},pe.Ze),t.key)},"richtext")}_createValue(t,e,i){var r;if((0,pt.pn)(t.value))return t.value.multiLine?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},B$(t.value)),{textBaseline:"top"}),"richtext"):"object"!=typeof t.value.text||null===t.value.text||"rich"!==t.value.text.type&&"html"!==t.value.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0,text:null!=(r=t.value.text)?r:""},t.value),{textBaseline:"top"}),"text"):"rich"===t.value.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},B$(t.value)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild(`${i}-value`,{html:Object.assign({dom:t.value.text.text,container:"",width:30,height:30,style:{}},t.value)},"richtext")}setAttributes(t,e){let i=Object.keys(t);this.attribute.autoCalculatePosition&&i.every(t=>BX.includes(t))?(this._mergeAttributes(t,i),(0,aY.Z)(this.attribute.panel.width)&&this.attribute.autoMeasure&&Bq.measureTooltip(this.attribute),Bq.calculateTooltipPosition(this.attribute),super.setAttributes({x:this.attribute.x,y:this.attribute.y},e)):super.setAttributes(t,e)}static calculateTooltipPosition(t){let{width:e=0,height:i=0}=t.panel,{offsetX:r,offsetY:n,pointerX:s,pointerY:l,positionX:a,positionY:o,parentBounds:h}=t,u=s,d=l;return"left"===a?u-=e+r:"center"===a?u-=e/2:u+=r,"top"===o?d-=i+n:"middle"===o?d-=i/2:d+=n,u+e>h.x2&&(u-=e+r),d+i>h.y2&&(d-=i+n),u<h.x1&&(u=h.x1),d<h.y1&&(d=h.y1),t.x=u,t.y=d,t}static measureTooltip(t){let{content:e,contentStyle:i}=t,r=(0,BU.o)(t.padding),n=Bq.getTitleAttr(t),s=0,l=r[0]+r[2],a=0,{value:o,shape:h}=n,{visible:u=!1,symbolType:d=""}=null!=h?h:{};if((0,c2.Z)(o)&&"object"!=typeof n.value.text){let{width:t,height:e}=(0,om.gM)(o).quickMeasure(o.text);s=t,a=e}if(u&&BZ.g6[d]&&(s+=h.size+h.spacing,a=Math.max(h.size,a)),t.title&&(t.title.width=s,t.title.height=a),(0,pt.pn)(n)&&(l+=a+n.spaceRow),e&&e.length){let r=[];if(e.forEach((e,i)=>{let n=Bq.getContentAttr(t,i);(e.key||e.value)&&(0,pt.pn)(n)&&r.push([e,n])}),r.length){let n=!1,a=[],o=[],h=[];r.forEach(([t,e],s)=>{var u;let{key:d,value:c,shape:p,spaceRow:g}=e,f=(0,pt.pn)(p),m=null!=(u=null==p?void 0:p.symbolType)?u:"",y=(0,om.gM)(d),v=(0,om.gM)(c),b=0;if((0,pt.pn)(d)){let{width:t,height:e}=y.quickMeasure(d.text);o.push(t),b=Math.max(b,e)}if((0,pt.pn)(c)){let{width:t,height:e}=v.quickMeasure(c.text);h.push(t),b=Math.max(b,e)}f&&BZ.g6[m]&&(n=!0,a.push(p.size),b=Math.max(p.size,b)),t.height=b,l+=b,s<r.length-1&&(l+=null!=g?g:i.spaceRow)});let u=a.length?Math.max(...a):0,d=o.length?Math.max(...o):0,c=h.length?Math.max(...h):0;s=Math.max(d+c+i.key.spacing+i.value.spacing+(n?u+i.shape.spacing:0),s),e.forEach(t=>{t.width=s}),t.hasContentShape=n,t.keyWidth=d,t.valueWidth=c}}return t.panel.width=s+r[1]+r[3],t.panel.height=l,t}static getTitleAttr(t){return BK({},Bq.defaultAttributes.titleStyle,Bq.defaultAttributes.title,t.titleStyle,t.title)}static getContentAttr(t,e){return BK({},Bq.defaultAttributes.contentStyle,t.contentStyle,t.content[e])}}Bq.defaultAttributes=BY;let BJ={fontFamily:eW.fontFamily,spacing:10,wordBreak:"break-word"},BQ=(t,e)=>{var i;let r,n;"rich"!==(null==t?void 0:t.type)&&"html"!==(null==t?void 0:t.type)?(t=(null!=t?t:"").toString(),n=(r=e.multiLine?(r=t.split("\n")).map((t,e)=>e<r.length-1?t+"\n":t):[t]).map(t=>Object.assign(Object.assign({},e),{text:t}))):(n=t.text,r=t);let s=(0,xy.X)({wordBreak:null!=(i=e.wordBreak)?i:"break-word",maxWidth:e.maxWidth?e.maxWidth:void 0,width:0,height:0,textConfig:n});return{width:s.width(),height:s.height(),text:r}};function B0(t={},e,i){var r,n;return Object.assign(Object.assign({},null!=i?i:BJ),{fill:null!=(r=t.fill)?r:t.fontColor,textAlign:t.textAlign,textBaseline:t.textBaseline,fontFamily:null!=(n=t.fontFamily)?n:e,fontSize:t.fontSize,fontWeight:t.fontWeight,lineHeight:t.lineHeight,spacing:t.spacing,multiLine:t8(t.maxWidth)?!1!==t.multiLine:t.multiLine,maxWidth:t.maxWidth,wordBreak:t.wordBreak,autoWidth:t.autoWidth})}let B1=t=>{var e;let{backgroundColor:i,border:r,shadow:n}=t,s={lineWidth:null!=(e=null==r?void 0:r.width)?e:0,shadow:!!n};(null==r?void 0:r.color)&&(s.stroke=r.color),i&&(s.fill=i),n&&(s.shadowColor=n.color,s.shadowBlur=n.blur,s.shadowOffsetX=n.x,s.shadowOffsetY=n.y,s.shadowSpread=n.spread);let{radius:l}=null!=r?r:{};return t8(l)&&(s.cornerRadius=[l,l,l,l]),s},B2=(t,e,i)=>{var r,n,s,l,a;let{style:o={},enterable:h,transitionDuration:u}=e,{panel:d={},titleLabel:c,shape:p,keyLabel:g,valueLabel:f,spaceRow:m,align:y}=o,v=A2(d.padding),b=ek(d.padding),_=B0(Object.assign({textAlign:"right"===y?"right":"left"},c),i),x=B0(Object.assign({textAlign:"right"===y?"right":"left"},g),i),C=B0(f,i),w={fill:!0,size:null!=(r=null==p?void 0:p.size)?r:8,spacing:null!=(n=null==p?void 0:p.spacing)?n:6},S={panel:B1(d),padding:v,title:{},content:[],titleStyle:{value:_,spaceRow:m},contentStyle:{shape:w,key:x,value:C,spaceRow:m},hasContentShape:!1,keyWidth:0,valueWidth:0,enterable:h,transitionDuration:u,align:y},{title:A={},content:M=[]}=t,k=b.left+b.right,T=b.top+b.bottom,R=0,B=!!M.length,P=0,E=0,I=0,L=0;if(B){let t=[],e=[],i=[],r=[],n=0;S.content=M.map((s,l)=>{let a=0,{hasShape:o,key:h,shapeType:u="",shapeFill:d,shapeStroke:c,shapeLineWidth:p,shapeSize:g,value:f,isKeyAdaptive:y,spaceRow:v,keyStyle:b,valueStyle:_,shapeHollow:S}=s,A={height:0,spaceRow:null!=v?v:m};if(t8(h)){let i=ir({},x,B0(b,void 0,{})),{width:r,height:n,text:s}=BQ(h,i);A.key=Object.assign(Object.assign({width:r,height:n},i),{text:s}),y?e.push(r):t.push(r),a=Math.max(a,n)}if(t8(f)){let t=ir({},C,B0(_,void 0,{})),{width:e,height:r,text:n}=BQ(f,t);A.value=Object.assign(Object.assign({width:e,height:r},t),{text:n}),i.push(e),a=Math.max(a,r)}if(o){let t={visible:!0,symbolType:u};S?t.stroke=d:t.fill=d,t.stroke=null!=c?c:d,t.lineWidth=p,A.shape=t;let e=null!=g?g:w.size;a=Math.max(e,a),r.push(e)}else A.shape={visible:!1};return A.height=a,n+=a,l<M.length-1&&(n+=A.spaceRow),A}),T+=n,P=t.length?ep(t):0,E=e.length?ep(e):0,I=i.length?ep(i):0,R=Math.max((L=r.length?ep(r)+w.spacing:0)+P+x.spacing+I+C.spacing,L+E,R),S.hasContentShape=!!r.length,S.keyWidth=P,S.valueWidth=I}let F=0,O=0,D=0,{visible:H=!0,value:z="",valueStyle:W,spaceRow:N}=A;S.title.visible=H,S.title.spaceRow=null!=N?N:m;let j={},G=()=>j.autoWidth&&!1!==j.multiLine;if(H){j=ir({},_,B0(W,void 0,{})),G()&&(j.multiLine=null==(s=j.multiLine)||s,j.maxWidth=null!=(l=j.maxWidth)?l:B?Math.ceil(R):void 0);let{text:t,width:e,height:i}=BQ(z,j);S.title.value=Object.assign(Object.assign({width:G()?Math.min(e,null!=(a=j.maxWidth)?a:Number.MAX_VALUE):e,height:i},j),{text:t}),F=S.title.value.width,D=(O=S.title.value.height)+(B?S.title.spaceRow:0)}return T+=D,S.title.width=F,S.title.height=O,G()?k+=R||F:k+=Math.max(F,R),B&&S.content.forEach(t=>{var e;let i=t.value;i&&(null==(e=i.autoWidth)||e)&&(i.width=k-b.left-b.right-L-P-x.spacing-C.spacing,i.maxWidth||(i.maxWidth=Math.ceil(i.width)),S.valueWidth=Math.max(S.valueWidth,i.width))}),S.panel.width=k,S.panel.height=T,S};class B3 extends BL{constructor(){super(B3.type),this.type=mf.canvas,this._attributes=null}onAdd(t){var e;super.onAdd(t),this._tooltipCanvasId=null==(e=this._chartOption.modeParams)?void 0:e.tooltipCanvasId}_initTooltipComponent(t){let e=this._getLayer(t);this._tooltipComponent=new Bq({autoCalculatePosition:!1,autoMeasure:!1}),e.add(this._tooltipComponent)}_getLayer(t){if(this._layer)return this._layer;this._layer=t.createLayer(this._tooltipCanvasId);let e=this._layer.layerHandler.canvas.nativeCanvas;return e&&e.style&&(e.style.touchAction="none",e.style.pointerEvents="none"),this._layer}_getTooltipBoxSize(t,e){var i,r;if(!e||er(this._attributes)){let e=null==(i=this._chartOption)?void 0:i.getTheme("fontFamily");this._attributes=B2(t,this._component.getSpec(),e)}let{panel:n}=null!=(r=this._attributes)?r:{};return{width:n.width+n.lineWidth,height:n.height+n.lineWidth}}_removeTooltip(){this._layer&&this._layer.removeAllChild(),this._attributes=null}_updateTooltip(t,e){this._visible=t;let i=this._compiler.getStage();if(!i)return;if(!t)return void(this._tooltipComponent&&this._tooltipComponent.attribute.visible&&(this._tooltipComponent.hideAll(),this._tooltipComponent.setAttributes({visibleAll:!1})));this._tooltipComponent||this._initTooltipComponent(i);let{activeTooltipSpec:r}=e,n=r.position;e.changePositionOnly?t8(n)&&this._tooltipComponent.setAttributes(n):this._tooltipComponent.setAttributes(Object.assign(Object.assign({},this._attributes),n)),this._tooltipComponent.attribute.visible||(this._tooltipComponent.showAll(),this._tooltipComponent.setAttributes({visibleAll:!0}))}isTooltipShown(){var t;return null==(t=this._tooltipComponent)?void 0:t.attribute.visibleAll}release(){var t;super.release(),null==(t=this._layer)||t.release()}}B3.type=mf.canvas;let B5=()=>{BN(B3)};function B4(t,e){let i=e?t.toExponential(e-1):t.toExponential(),r=i.indexOf("e");if(r<0)return null;let n=i.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+i.slice(r+1)]}function B6(t,e){let i=B4(t,e);if(!i)return t+"";let r=i[0],n=i[1];return n<0?"0."+Array(-n).join("0")+r:r.length>n+1?r.slice(0,n+1)+"."+r.slice(n+1):r+Array(n-r.length+2).join("0")}class B8{constructor(t={}){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}toString(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}}let B9=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function B7(t){let e;if(e=B9.exec(t))return new B8({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]});tU.getInstance().error("invalid format: "+t)}let Pt=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];class Pe{constructor(){var t,e,i;this.locale={thousands:",",grouping:[3],currency:["$",""]},this.group=void 0===this.locale.grouping||void 0===this.locale.thousands?t=>t:(t=[...this.locale.grouping].map(Number),e=`${this.locale.thousands}`,function(i,r){let n=i.length,s=[],l=0,a=t[0],o=0;for(;n>0&&a>0&&(o+a+1>r&&(a=Math.max(1,r-o)),s.push(i.substring(n-=a,n+a)),!((o+=a+1)>r));)a=t[l=(l+1)%t.length];return s.reverse().join(e)}),this.currencyPrefix=void 0===this.locale.currency?"":this.locale.currency[0]+"",this.currencySuffix=void 0===this.locale.currency?"":this.locale.currency[1]+"",this.decimal=void 0===this.locale.decimal?".":this.locale.decimal+"",this.numerals=void 0===this.locale.numerals?t=>t:(i=[...this.locale.numerals].map(String),function(t){return t.replace(/[0-9]/g,t=>i[+t])}),this.percent=void 0===this.locale.percent?"%":this.locale.percent+"",this.minus=void 0===this.locale.minus?"−":this.locale.minus+"",this.nan=void 0===this.locale.nan?"NaN":this.locale.nan+"",this.formatter=t=>this.newFormat(t),this.format=(t,e)=>this.formatter(t)(e),this.formatPrefix=(t,e)=>this._formatPrefix(t,e)}static getInstance(){return Pe.instance||(Pe.instance=new Pe),Pe.instance}newFormat(t){let e=B7(t),i=e.fill,r=e.align,s=e.sign,l=e.symbol,a=e.zero,o=e.width,h=e.comma,u=e.precision,d=e.trim,c=e.type;"n"===c?(h=!0,c="g"):Pi[c]||(void 0===u&&(u=12),d=!0,c="g"),(a||"0"===i&&"="===r)&&(a=!0,i="0",r="=");let p="$"===l?this.currencyPrefix:"#"===l&&/[boxX]/.test(c)?"0"+c.toLowerCase():"",g="$"===l?this.currencySuffix:/[%p]/.test(c)?this.percent:"",f=Pi[c],m=/[defgprstz%]/.test(c);u=void 0===u?6:/[gprs]/.test(c)?Math.max(1,Math.min(21,u)):Math.max(0,Math.min(20,u));let{nan:y,minus:v,decimal:b,group:_,numerals:x}=this;function C(t){let e,l,C,w=p,S=g,A=t;if("c"===c)S=f(A)+S,A="";else{let t=(A*=1)<0||1/A<0;if(A=isNaN(A)?y:f(Math.abs(A),u),d&&(A=function(t){let e=t.length,i,r=-1;t:for(let n=1;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":0===r&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(i+1):t}(A)),t&&0==+A&&"+"!==s&&(t=!1),w=(t?"("===s?s:v:"-"===s||"("===s?"":s)+w,S=("s"===c?Pt[8+n/3]:"")+S+(t&&"("===s?")":""),m){for(e=-1,l=A.length;++e<l;)if(48>(C=A.charCodeAt(e))||C>57){S=(46===C?b+A.slice(e+1):A.slice(e))+S,A=A.slice(0,e);break}}}h&&!a&&(A=_(A,1/0));let M=w.length+A.length+S.length,k=M<o?Array(o-M+1).join(i):"";switch(h&&a&&(A=_(k+A,k.length?o-S.length:1/0),k=""),r){case"<":A=w+A+S+k;break;case"=":A=w+k+A+S;break;case"^":A=k.slice(0,M=k.length>>1)+w+A+S+k.slice(M);break;default:A=k+w+A+S}return x(A)}return C.toString=function(){return t+""},C}_formatPrefix(t,e){let i=B7(t);i.type="f";let r=this.newFormat(i.toString()),n=3*Math.max(-8,Math.min(8,Math.floor(function(t){let e=B4(Math.abs(t));return e?e[1]:NaN}(e)/3))),s=Math.pow(10,-n),l=Pt[8+n/3];return function(t){return r(s*t)+l}}}let Pi={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},f:(t,e)=>t.toFixed(e),e:(t,e)=>t.toExponential(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>B6(100*t,e),r:B6,s:function(t,e){let i=B4(t,e);if(!i)return t+"";let r=i[0],s=i[1],l=s-(n=3*Math.max(-8,Math.min(8,Math.floor(s/3))))+1,a=r.length;return l===a?r:l>a?r+Array(l-a+1).join("0"):l>0?r.slice(0,l)+"."+r.slice(l):"0."+Array(1-l).join("0")+B4(t,Math.max(0,e+l-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16),t:(t,e)=>Number.isInteger(t)?t.toFixed(2):Math.floor(t*Math.pow(10,e))/Math.pow(10,e)+"",z:(t,e)=>t%1==0?t+"":t.toFixed(e)},Pr=t=>{iv.registerChartPlugin(t.type,t)},Pn=/\{([^}]+)\}/,Ps=/\{([^}]+)\}/g,Pl=/:/;class Pa extends gl{constructor(){super(Pa.type),this.type="formatterPlugin",this._timeModeFormat={utc:d3.getInstance().timeUTCFormat,local:d3.getInstance().timeFormat},this._formatter=this._format,this._timeFormatter=this._timeModeFormat.local,this._numericFormatter=Pe.getInstance().format,this._numericSpecifier=Pe.getInstance().formatter,this._numericFormatterCache=new Map,this._isNumericFormatterCache=new Map}onInit(t,e){var i;let{globalInstance:r}=t;if(!r)return;this._spec=null!=(i=null==e?void 0:e[Pa.specKey])?i:{};let{timeMode:n,customFormatter:s,numericFormatter:l,timeFormatter:a}=this._spec;tQ(s)?this._formatter=s:(this._formatter=this._format.bind(this),tQ(a)?this._timeFormatter=a:n&&this._timeModeFormat[n]&&(this._timeFormatter=this._timeModeFormat[n]),l&&(this._numericFormatter=l,this._numericSpecifier=null,this._numericFormatterCache=null)),iv.registerFormatter(this._formatter)}_format(t,e,i){return tq(t)?t.map((t,r)=>{let n=tq(i)?i[r]:i;return n?this._formatSingleLine(t,e,n):t}):tq(i)?i.map(i=>this._formatSingleLine(t,e,i)):this._formatSingleLine(t,e,i)}_formatSingleLine(t,e,i){let r;return(this._isNumericFormatterCache&&(this._isNumericFormatterCache.get(i)?r=this._isNumericFormatterCache.get(i):(r=Pn.test(i),this._isNumericFormatterCache.set(i,r))),r)?i.replace(Ps,(t,i)=>{if(!Pl.test(i)){let r=e[i.trim()];return void 0!==r?r:t}let r=i.split(":"),n=e[r.shift()],s=r.join(":");return this._formatSingleText(n,s)}):this._formatSingleText(t,i)}_formatSingleText(t,e){if(B9.test(e)&&this._numericFormatter){let i;return this._numericFormatterCache&&this._numericSpecifier?(this._numericFormatterCache.get(e)?i=this._numericFormatterCache.get(e):(i=this._numericSpecifier(e),this._numericFormatterCache.set(e,i)),i(Number(t))):this._numericFormatter(e,Number(t))}return e.includes("%")&&this._timeFormatter?this._timeFormatter(e,t):e.startsWith("calc(")?this._calcFormatter(e,t):t}_calcFormatter(t,e){try{let i=t.slice(5,-1).replace(/v/g,String(e));return this._calculateMathExpression(i,e)}catch(t){return e}}_calculateMathExpression(t,e){let i=t.replace(/\s+/g,"");if(!this._isValidMathExpression(i))return e;try{let t=Function("return ("+i+")")();if("number"!=typeof t||isNaN(t)||!isFinite(t))throw Error("Invalid calculation result");return t}catch(t){return e}}_isValidMathExpression(t){return/^[0-9+\-*/().]+$/.test(t)}release(){super.release(),this._format=null,this._timeFormatter=null,this._numericFormatter=null,this._numericSpecifier=null,this._numericFormatterCache=null,this._isNumericFormatterCache=null}}Pa.pluginType="chart",Pa.specKey="formatter",Pa.type="formatterPlugin";let Po=()=>{Pr(Pa)},Ph={state:j.STATE_ACTIVE,trigger:"pointerover",triggerOff:"pointerout"};class Pu extends dp{constructor(t){super(t),this.type="element-active",this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{this.reset(t.item)},this.options=Object.assign({},Ph,t),this.updateMarkIdByState([this.options.state])}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}getStartState(){return this.options.state}start(t){if(t){let{state:e,interaction:i}=this.options;this.isGraphicInStateMark(t,e)&&(t.addState(e,!0),i.setStatedGraphics(this,[t]))}}reset(t){let{interaction:e,state:i}=this.options,r=e.getStatedGraphics(this),n=null!=t?t:null==r?void 0:r[0];n&&r.includes(n)&&(n.removeState(i),e.setStatedGraphics(this,r.filter(t=>t!==n)))}}Pu.type="element-active",Pu.defaultOptions=Ph;let Pd=()=>{iv.registerInteractionTrigger(Pu.type,Pu)},Pc="element-active-by-legend",Pp={state:j.STATE_ACTIVE,filterType:"groupKey"};class Pg extends dp{constructor(t){super(t),this.type=Pc,this.handleStart=t=>{var e,i;let r=t.event;r&&this.start(null==(i=null==(e=r.detail)?void 0:e.data)?void 0:i.id)},this.handleReset=t=>{this.resetAll()},this.options=Object.assign({},Pp,t),this.updateMarkIdByState([this.options.state])}getEvents(){return[{type:rI.legendItemHover,handler:this.handleStart},{type:rI.legendItemUnHover,handler:this.handleReset}]}getStartState(){return this.options.state}start(t){if(er(t))return;let{interaction:e,state:i}=this.options,r=dd(this.options),n=e.getStatedGraphics(this),s=[];this.getMarks().forEach(e=>{var i;null==(i=e.getGraphics())||i.forEach(e=>{r(e)===t&&s.push(e)})}),e.updateStates(this,s,n,i),e.setStatedGraphics(this,s)}resetAll(){let{interaction:t,state:e}=this.options;t.clearAllStatesOfTrigger(this,e),t.setStatedGraphics(this,[])}reset(t){let{state:e,interaction:i}=this.options;if(t){let r=i.getStatedGraphics(this);r&&r.includes(t)&&(t.removeState(e),i.setStatedGraphics(this,r.filter(e=>e!==t)))}else this.resetAll()}}Pg.type=Pc,Pg.defaultOptions=Pp;let Pf=()=>{iv.registerInteractionTrigger(Pc,Pg)},Pm="element-highlight-by-legend",Py={highlightState:j.STATE_HIGHLIGHT,blurState:j.STATE_BLUR,filterType:"groupKey"};class Pv extends dp{constructor(t){super(t),this.type=Pm,this.handleStart=t=>{var e,i;let r=t.event;r&&this.start(null==(i=null==(e=r.detail)?void 0:e.data)?void 0:i.id)},this.handleReset=t=>{this.resetAll()},this.options=Object.assign({},Py,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){return[{type:rI.legendItemHover,handler:this.handleStart},{type:rI.legendItemUnHover,handler:this.handleReset}]}start(t){if(t){let e=dd(this.options),{interaction:i,highlightState:r,blurState:n}=this.options,s=i.getStatedGraphics(this),l=[];this.getMarks().forEach(i=>{var r;null==(r=i.getGraphics())||r.forEach(i=>{e(i)===t&&l.push(i)})}),i.updateStates(this,l,s,r,n),i.setStatedGraphics(this,l)}}resetAll(){let{interaction:t,highlightState:e,blurState:i}=this.options;t.clearAllStatesOfTrigger(this,e,i),t.setStatedGraphics(this,[])}reset(t){let{highlightState:e,blurState:i,interaction:r}=this.options;if(t){let n=r.getStatedGraphics(this);n&&n.includes(t)&&(t.removeState([e,i]),r.setStatedGraphics(this,n.filter(e=>e!==t)))}else this.resetAll()}}Pv.type=Pm,Pv.defaultOptions=Py;let Pb=()=>{iv.registerInteractionTrigger(Pm,Pv)},P_="element-highlight-by-name",Px={highlightState:j.STATE_HIGHLIGHT,blurState:j.STATE_BLUR,filterType:"groupKey"};class PC extends dp{constructor(t){super(t),this.type=P_,this.handleStart=t=>{if(this.options.shouldStart?this.options.shouldStart(t):this._filterByName(t)){let e=this._parseTargetKey(t);this.start(e)}},this.handleReset=t=>{(this.options.shouldReset?this.options.shouldReset(t):this._filterByName(t))&&this.resetAll()},this.options=Object.assign({},Px,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}_filterByName(t){var e;let i=ed(this.options.graphicName);return(null==(e=null==t?void 0:t.node)?void 0:e.name)&&i.includes(t.node.name)}_parseTargetKey(t){return this.options.parseData?this.options.parseData(t):"text"===t.node.type?t.node.attribute.text:null}start(t){if(t){let e=dd(this.options),{interaction:i,highlightState:r,blurState:n}=this.options,s=i.getStatedGraphics(this),l=[];this.getMarks().forEach(i=>{var r;null==(r=i.getGraphics())||r.forEach(i=>{e(i)===t&&l.push(i)})}),i.updateStates(this,l,s,r,n),i.setStatedGraphics(this,l)}}resetAll(){let{interaction:t,highlightState:e,blurState:i}=this.options;t.clearAllStatesOfTrigger(this,e,i),t.setStatedGraphics(this,[])}reset(t){let{highlightState:e,blurState:i,interaction:r}=this.options;if(t){let n=r.getStatedGraphics(this);n&&n.includes(t)&&(t.removeState([e,i]),r.setStatedGraphics(this,n.filter(e=>e!==t)))}else this.resetAll()}}PC.type=P_,PC.defaultOptions=Px;let Pw=()=>{iv.registerInteractionTrigger(P_,PC)},PS="element-highlight-by-group";class PA extends dp{constructor(t){super(t),this.type=PS,this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{let e=t.item;e&&this.isGraphicInMark(e)&&this.resetAll()},this.options=Object.assign({},dc,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}resetAll(){let{interaction:t,highlightState:e,blurState:i}=this.options;t.clearAllStatesOfTrigger(this,e,i),t.setStatedGraphics(this,[])}_getHightlightKey(t){var e;return null==(e=t.context)?void 0:e.groupKey}start(t){if(t&&this.isGraphicInMark(t)){let e=this._getHightlightKey(t);if(er(e))return;let{interaction:i,highlightState:r,blurState:n}=this.options,s=i.getStatedGraphics(this),l=[];this.getMarks().forEach(t=>{var i;null==(i=t.getGraphics())||i.forEach(t=>{this._getHightlightKey(t)===e&&l.push(t)})}),i.updateStates(this,l,s,r,n),i.setStatedGraphics(this,l)}}reset(t){if(t){if(this.isGraphicInMark(t)){let{interaction:e}=this.options,i=e.getStatedGraphics(this);t.removeState([this.options.highlightState,this.options.blurState]),e.setStatedGraphics(this,i.filter(e=>e!==t))}}else this.resetAll()}}PA.type=PS,PA.defaultOptions=dc;let PM=()=>{iv.registerInteractionTrigger(PS,PA)},Pk="element-highlight-by-key";class PT extends PA{constructor(){super(...arguments),this.type=Pk}_getHightlightKey(t){var e;return null==(e=t.context)?void 0:e.key}}PT.type=Pk;let PR=()=>{iv.registerInteractionTrigger(Pk,PT)};class PB extends od{constructor(){super(...arguments),this.type=PB.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}PB.type="image";let PP=()=>{iv.registerMark(PB.type,PB),(0,oc.W)(),(0,Tc.i)(),iv.registerGraphicComponent("image",xv.B)};(tp=tE||(tE={})).group="group",tp.symbol="symbol",tp.rule="rule",tp.line="line",tp.text="text",tp.rect="rect",tp.image="image",tp.path="path",tp.area="area",tp.arc="arc",tp.polygon="polygon",tp.boxPlot="boxPlot",tp.linkPath="linkPath",tp.cell="cell",tp.ripple="ripple",tp.liquid="liquid",tp.component="component",tp.dataLabel="dataLabel",tp.label="label",tp.pictogram="pictogram";let PE=()=>{of(),pW(),pV(),__(),_B(),mG(),yi(),yF(),bp(),CI(),PP(),Md(),gj()};dw.useRegisters([mA,mJ,yu,yA,bS,b9,_p,_j,v0,xa,Cg,Cf,CW,SD,Aa,_1,CQ,we,AJ,wL,w5,Sc,AZ,Mt,_D,Mb,_m,fb,fl,Mx,MM,MR,bJ,b0,Mz,M0,M7,kh,km,kz,kN,kY,v$,Re,Rg,R7,Rs,Ry,Be,Br,Ro,RZ,RQ,R1,Bc,Bg,Bb,By,PE,BV,B5,Po,Pd,Pf,Pb,Pw,PM,PR,dn,uA,uw]),(tg=tI||(tI={})).vertical="vertical",tg.horizontal="horizontal";var PI=i(9511),PL=i(60831);class PF{constructor(){this.released=!1,this.currentTime=-1}tick(t,e){this.currentTime<0&&(this.currentTime=0),this.currentTime+=t,e(this)}release(){this.released=!0}getTime(){return this.currentTime}tickTo(t,e){this.currentTime<0&&(this.currentTime=0);let i=t-this.currentTime;this.tick(i,e)}}class PO extends PL.H{constructor(t){super(t),this.lastFrameTime=0,this.status=PI.Q.RUNNING}setupTickHandler(){let t=new PF;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0}checkSkip(t){return!1}getTime(){return this.tickerHandler.getTime()}tickAt(t){this.tickTo(t)}start(t=!1){return!(this.status===PI.Q.RUNNING||!this.tickerHandler||!t&&(this.status===PI.Q.PAUSE||this.ifCanStop()))&&(this.status=PI.Q.RUNNING,!0)}}var PD=i(30380);let PH="2.0.6";class Pz extends fD{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["valueField","maskShape","reverse","outlineMargin","outlinePadding","indicatorSmartInvert","liquidBackground","liquidOutline"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}let PW={duration:2e3,loop:!0,channel:{wave:{from:0,to:1}}},PN=t=>({duration:2e3,channel:{wave:{from:0,to:1},height:t.height,dy:t.dy}}),Pj=t=>({duration:2e3,channel:{dy:t.dy}}),PG=t=>({duration:2e3,channel:{dy:t.dy}});function PV(t,e){switch(e){case"wave":default:return PW;case"grow":case"waveGrow":return PN(t)}}function PZ(t,e){switch(e){case"wave":default:return PW;case"grow":return Pj(t);case"waveGrow":return PG(t)}}let PU=()=>{iv.registerAnimation("liquid",(t,e)=>({appear:PV(t,e),enter:PV(t,e),exit:PV(t,e)})),iv.registerAnimation("liquidGroup",(t,e)=>({appear:PZ(t,e),enter:PZ(t,e),exit:PZ(t,e)}))},PK=Object.assign(Object.assign({},cy),{liquidGroup:{name:"liquidGroup",type:"group"},liquid:{name:"liquid",type:"liquid"},liquidBackground:{name:"liquidBackground",type:"group"},liquidOutline:{name:"liquidOutline",type:"group"}});class P$ extends SX{constructor(){super(...arguments),this.type=P$.type,this._subMarks={wave0:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:1}},wave1:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.66}},wave2:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.33}}},this._positionChannels=["wave","y","height"],this._positionEncoder=(t,e,i)=>{let{wave:r=i.attribute.wave,y:n=i.attribute.y,height:s=i.attribute.height}=t,l=[],a=[],o=[];for(let t=0;t<21;t++){let e=50*t-500,i=n+20*(t%2==0),h=n+s;l.push({x:e+100*r,y:i,y1:h}),a.push({x:e+200*r-40,y:i,y1:h}),o.push({x:e+300*r-20,y:i,y1:h})}return{wave0:{x:0,y:0,points:l},wave1:{x:0,y:0,points:a},wave2:{x:0,y:0,points:o}}}}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{wave:0})}}P$.type="liquid";let PY=()=>{Sq(),mW(),iv.registerMark(P$.type,P$),iv.registerGraphicComponent("area",t=>mR(t))},PX=(t,e)=>"drop"===t?function(t,e,i){let r=4*i/3,n=Math.max(r,2*i),s=r/2,l=s+0-n/2,a=Math.asin(s/(.85*(n-s))),o=Math.sin(a)*s,h=Math.cos(a)*s,u=0-h,d=l+o,c=l+s/Math.sin(a);return`
      M ${u} ${d}
      A ${s} ${s} 0 1 1 ${u+2*h} ${d}
      Q ${t} ${c} ${t} ${e+n/2}
      Q ${t} ${c} ${u} ${d}
      Z 
    `}(0,0,e):t;class Pq extends cs{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>this.series.getValueField(),this.markTooltipValueCallback=t=>t[this.series.getValueField()],this.shapeStrokeCallback=t=>this.series.getMarkInName("liquid").getAttribute("fill",t)}}class PJ extends cI{constructor(){super(...arguments),this.type=rR.liquid,this.transformerConstructor=pZ,this._liquidBackgroundMark=null,this._liquidOutlineMark=null,this._getLiquidPosY=()=>{let t=0,{height:e,startY:i}=this._getLiquidBackPosAndSize();return(this._reverse?e*this._heightRatio:e*(1-this._heightRatio))+i},this._getLiquidHeight=()=>{let{height:t}=this._getLiquidBackPosAndSize();return t*this._heightRatio},this._getLiquidBackPosAndSize=(t=!1)=>{var e,i;let{top:r=0,bottom:n=0,left:s=0,right:l=0}=this._marginSpec,{top:a=0,bottom:o=0,left:h=0,right:u=0}=t?{}:this._paddingSpec;"triangle"===this._maskShape&&(n/=Math.sqrt(3),r=r/Math.sqrt(3)*2,o/=Math.sqrt(3),a=a/Math.sqrt(3)*2);let{width:d,height:c}=null!=(i=null==(e=this._region)?void 0:e.getLayoutRect())?i:{width:0,height:0},p=d/2+(s+h-(l+u))/2,g=c/2+(r+a-(n+o))/2,f=d-(s+l+h+u),m=c-(r+n+a+o),y=Math.min(f,m);return"rect"!==this._maskShape&&(f=y,m=y),{x:p,y:g,size:y,width:f,height:m,startX:p-f/2,startY:g-m/2,endX:p+f/2,endY:g+m/2}},this._getLiquidBackPath=(t=!1)=>{var e;let i;if("rect"===this._maskShape){let{x:e,y:r,width:n,height:s}=this._getLiquidBackPosAndSize(t);i=(0,yt.f)({x:e-n/2,y:r-s/2,width:n,height:s,fill:!0})}else{let{x:r,y:n,size:s}=this._getLiquidBackPosAndSize(t);i=(0,pN.t)({x:r,y:n,size:s,symbolType:PX(null!=(e=this._spec.maskShape)?e:"circle",s),fill:!0})}return[i]}}setValueField(t){t8(t)&&(this._valueField=t)}getValueField(){return this._valueField}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this._marginSpec=ek(this._spec.outlineMargin),this._paddingSpec=ek(this._spec.outlinePadding),this.setValueField(this._spec.valueField),this._reverse=null!=(t=this._spec.reverse)&&t,this._maskShape=null!=(e=this._spec.maskShape)?e:"circle"}viewDataUpdate(t){super.viewDataUpdate(t),this._heightRatio=dk(...this._data.getLatestData().map(t=>t[this._valueField]))}initMark(){this._initLiquidOutlineMark(),this._initLiquidBackgroundMark(),this._initLiquidMark()}initMarkStyle(){this._initLiquidOutlineMarkStyle(),this._initLiquidBackgroundMarkStyle(),this._initLiquidMarkStyle()}_initLiquidOutlineMark(){return this._liquidOutlineMark=this._createMark(PJ.mark.liquidOutline,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidOutlineMark}_initLiquidBackgroundMark(){return this._liquidBackgroundMark=this._createMark(PJ.mark.liquidBackground,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidBackgroundMark}_initLiquidMark(){return this._liquidGroupMark=this._createMark(PJ.mark.liquidGroup,{parent:this._liquidBackgroundMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark=this._createMark(PJ.mark.liquid,{parent:this._liquidGroupMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getLiquidBackPosAndSize=this._getLiquidBackPosAndSize,this._markAttributeContext.getLiquidPosY=this._getLiquidPosY,this._markAttributeContext.getLiquidHeight=this._getLiquidHeight}_initLiquidOutlineMarkStyle(){let t=this._liquidOutlineMark;t.created(),this.setMarkStyle(t,{stroke:this.getColorAttribute(),width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,path:()=>this._getLiquidBackPath(!0)},"normal",W.Series),this._liquidOutlineMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex})}_initLiquidBackgroundMarkStyle(){let t=this._liquidBackgroundMark;t.created(),this.setMarkStyle(t,{width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,path:()=>this._getLiquidBackPath()},"normal",W.Series),this._liquidBackgroundMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0})}_initLiquidMarkStyle(){let t=this._liquidMark,e=this._liquidGroupMark;e&&this.setMarkStyle(e,{x:()=>this._region.getLayoutStartPoint().x+this._region.getLayoutRect().width/2,angle:this._reverse?-Math.PI:0,y:0,dy:this._getLiquidPosY}),t&&this.setMarkStyle(t,{y:0,dy:0,height:this._getLiquidHeight,fill:this.getColorAttribute(),wave:0},"normal",W.Series)}initTooltip(){this._tooltipHelper=new Pq(this),this._liquidMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._liquidMark)}getInteractionTriggers(){return this._parseInteractionConfig(this._liquidMark?[this._liquidMark]:[])}initAnimation(){var t,e,i,r;let n={height:{from:0,to:()=>this._getLiquidHeight()},dy:{from:()=>{let t=0,{height:e,startY:i}=this._getLiquidBackPosAndSize();return(this._reverse?0:e)+i}}},s=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._liquidMark.setAnimationConfig(cA(null==(i=iv.getAnimationInKey("liquid"))?void 0:i(n,s),cM("liquid",this._spec,this._markAttributeContext))),this._liquidGroupMark.setAnimationConfig(cA(null==(r=iv.getAnimationInKey("liquidGroup"))?void 0:r(n,s),cM("liquidGroup",this._spec,this._markAttributeContext)))}initEvent(){super.initEvent(),this._spec.indicatorSmartInvert&&this._option.getChart().getComponentsByKey("indicator")&&this.event.on(rI.renderFinished,()=>{this._option.getChart().getComponentsByKey("indicator").forEach(t=>{var e,i,r;let n=null==(e=this._liquidMark.getGraphics()[0].getSubGraphic())?void 0:e[0],{y1:s,y2:l}=n.globalAABBBounds;s+=this._region.getLayoutStartPoint().y,l+=this._region.getLayoutStartPoint().y,null==(r=null==(i=null==t?void 0:t.getIndicatorComponent())?void 0:i.getChildren()[0])||r.getChildren().forEach(t=>{let{y1:e,y2:i}=t.globalAABBBounds;if(s<e&&l>i){let e=c4(t.attribute.fill,n.attribute.fill);t.setAttribute("fill",e)}})})})}dataToPosition(t){return null}dataToPositionX(t){return null}dataToPositionY(t){return null}valueToPosition(t,e){return null}getStatisticFields(){return[]}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}getActiveMarks(){return[this._liquidMark]}}PJ.type=rR.liquid,PJ.mark=PK,PJ.builtInTheme={liquid:{outlinePadding:10,liquidBackground:{style:{lineWidth:0,fillOpacity:.2}},liquidOutline:{style:{lineWidth:2}}}},PJ.transformerConstructor=pZ;let PQ=()=>{PY(),of(),PU(),iv.registerSeries(PJ.type,PJ)};class P0 extends fV{constructor(){super(...arguments),this.transformerConstructor=Pz,this.type="liquid",this.seriesType=rR.liquid}}P0.type="liquid",P0.seriesType=rR.liquid,P0.transformerConstructor=Pz;let P1=()=>{mx(),PQ(),iv.registerChart(P0.type,P0)},P2=t=>ed(t).join(",");class P3 extends cs{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=t=>P2(null==t?void 0:t[this.series.getDimensionField()[0]]),this.markTooltipKeyCallback=t=>P2(null==t?void 0:t[this.series.getDimensionField()[0]])}}let P5=Object.assign(Object.assign({},cy),{circle:{name:"circle",type:"arc"},overlap:{name:"overlap",type:"path"},overlapLabel:{name:"overlapLabel",type:"text"}});function P4(t,e){let i=function(t){let e=[];for(let i=0;i<t.length;++i)for(let r=i+1;r<t.length;++r){let n=P9(t[i],t[r]);for(let t=0;t<n.length;++t){let s=n[t];s.parentIndex=[i,r],e.push(s)}}return e}(t),r=i.filter(function(e){var i=e,r=t;for(let t=0;t<r.length;++t)if(dD.distancePP(i,r[t])>r[t].radius+1e-10)return!1;return!0}),n=0,s=0,l=[];if(r.length>1){let e=P7(r);for(let t=0;t<r.length;++t){let i=r[t];i.angle=Math.atan2(i.x-e.x,i.y-e.y)}r.sort(function(t,e){return e.angle-t.angle});let i=r[r.length-1];for(let e=0;e<r.length;++e){let a=r[e];s+=(i.x+a.x)*(a.y-i.y);let o={x:(a.x+i.x)/2,y:(a.y+i.y)/2},h=null;for(let e=0;e<a.parentIndex.length;++e)if(i.parentIndex.indexOf(a.parentIndex[e])>-1){let r=t[a.parentIndex[e]],n=Math.atan2(a.x-r.x,a.y-r.y),s=Math.atan2(i.x-r.x,i.y-r.y),l=s-n;l<0&&(l+=2*Math.PI);let u=s-l/2,d=dD.distancePP(o,{x:r.x+r.radius*Math.sin(u),y:r.y+r.radius*Math.cos(u)});d>2*r.radius&&(d=2*r.radius),(null===h||h.width>d)&&(h={circle:r,width:d,p1:a,p2:i})}null!==h&&(l.push(h),n+=P6(h.circle.radius,h.width),i=a)}}else{let e=t[0];for(let i=1;i<t.length;++i)t[i].radius<e.radius&&(e=t[i]);let i=!1;for(let r=0;r<t.length;++r)if(dD.distancePP(t[r],e)>Math.abs(e.radius-t[r].radius)){i=!0;break}i?n=s=0:(n=e.radius*e.radius*Math.PI,l.push({circle:e,p1:{x:e.x,y:e.y+e.radius},p2:{x:e.x-1e-10,y:e.y+e.radius},width:2*e.radius}))}return s/=2,e&&(e.area=n+s,e.arcArea=n,e.polygonArea=s,e.arcs=l,e.innerPoints=r,e.intersectionPoints=i),n+s}function P6(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function P8(t,e,i){return i>=t+e?0:i<=Math.abs(t-e)?Math.PI*Math.min(t,e)*Math.min(t,e):P6(t,t-(i*i-e*e+t*t)/(2*i))+P6(e,e-(i*i-t*t+e*e)/(2*i))}function P9(t,e){let i=dD.distancePP(t,e),r=t.radius,n=e.radius;if(i>=r+n||i<=Math.abs(r-n))return[];let s=(r*r-n*n+i*i)/(2*i),l=Math.sqrt(r*r-s*s),a=t.x+s*(e.x-t.x)/i,o=t.y+s*(e.y-t.y)/i,h=-(e.y-t.y)*(l/i),u=-(e.x-t.x)*(l/i);return[{x:a+h,y:o-u},{x:a-h,y:o+u}]}function P7(t){let e={x:0,y:0};for(let i=0;i<t.length;++i)e.x+=t[i].x,e.y+=t[i].y;return e.x/=t.length,e.y/=t.length,e}let Et=t=>{let e={},i=Object.values(t);if(!i.length)return[];P4(i,e);let r=e.arcs.map(({p1:t,p2:e,circle:i,width:r})=>({p1:t,p2:e,radius:i.radius,setId:i.setId,largeArcFlag:r>i.radius})),n=[],s=0,l=r[0];for(;s<r.length&&l;){let{p2:t}=l;n.push(l),l=r.find(e=>1e-10>dD.distancePP(e.p1,t)),s++}return n},Ee=t=>{if(!(null==t?void 0:t.length))return"";let e=0,i=t[0],{p1:r}=i,n=`M${r.x},${r.y}`;for(;i;){let{p2:r,radius:s,largeArcFlag:l}=i;n+=`A${s},${s} 0 ${+!!l},0 ${r.x},${r.y}`,i=t[++e]}return n+" Z"},Ei=t=>{var e;return null!=(e=null==t?void 0:t.map(t=>{let{p1:e,p2:i,radius:r,largeArcFlag:n,setId:s}=t,{x:l,y:a}=e,{x:o,y:h}=i,u=((o-l)**2+(h-a)**2)**.5,d=(l+o)/2,c=(a+h)/2,p=(r**2-(u/2)**2)**.5,g=d+p*(h-a)/u,f=c-p*(o-l)/u;return(dB([o-l,h-a],[g-l,f-a])>0||n)&&(g=d-p*(h-a)/u,f=c+p*(o-l)/u),{x:g,y:f,radius:r,setId:s}}))?e:[]},Er=t=>{switch(t){case"fadeIn":default:return{type:"fadeIn"};case"growIn":return{type:"growRadiusIn"};case"scaleIn":return{type:"scaleIn"}}},En=t=>{switch(t){case"fadeIn":default:return{type:"fadeIn"};case"scaleIn":return{type:"scaleIn"}}};class Es extends aq.rd{onBind(){var t,e;this.fromCircles={},null==(t=Ei(this.target.attribute.arcs))||t.forEach(t=>{this.fromCircles[t.setId]=t}),this.toCircles={},null==(e=Ei(this.target.getFinalAttribute().arcs))||e.forEach(t=>{this.toCircles[t.setId]=t})}onUpdate(t,e,i){let r=[];Object.keys(this.fromCircles).forEach(t=>{let i=this.fromCircles[t],n=this.toCircles[t];i&&n&&r.push({radius:i.radius+(n.radius-i.radius)*e,x:i.x+(n.x-i.x)*e,y:i.y+(n.y-i.y)*e,setId:t})});let n=Et(r);this.target.setAttributes({arcs:n,path:Ee(n)})}}let El=()=>{iv.registerAnimation("vennCircle",(t,e)=>({appear:Er(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}})),iv.registerAnimation("vennOverlap",(t,e)=>({appear:En(e),update:{custom:Es},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}))};class Ea extends cE{_transformLabelSpec(t){this._addMarkLabelSpec(t,"circle"),this._addMarkLabelSpec(t,"overlap","overlapLabel","initOverlapLabelMarkStyle")}}function Eo(t,e){let i=0;for(let r=0;r<e.length;++r){let n,s=e[r];if(1!==s.sets.length){if(2===s.sets.length){let e=t[s.sets[0]],i=t[s.sets[1]];n=P8(e.radius,i.radius,dD.distancePP(e,i))}else n=P4(s.sets.map(function(e){return t[e]}));i+=(s.hasOwnProperty("weight")?s.weight:1)*(n-s.size)*(n-s.size)}}return i}function Eh(t){let e=Array(t);for(let i=0;i<t;++i)e[i]=0;return e}function Eu(t,e){return Eh(t).map(function(){return Eh(e)})}function Ed(t){return Math.sqrt(dP(t,t))}function Ec(t,e,i){for(let r=0;r<e.length;++r)t[r]=e[r]*i}function Ep(t,e,i,r,n){for(let s=0;s<t.length;++s)t[s]=e*i[s]+r*n[s]}function Eg(t,e,i){return Math.min(t,e)*Math.min(t,e)*Math.PI<=i+1e-10?Math.abs(t-e):function(t,e,i,r){var n;let s=100,l=(n=void 0,1e-10),a=t(e),o=t(i),h=i-e;if(a*o>0)return tU.getInstance().error("Initial bisect points must have opposite signs"),NaN;if(0===a)return e;if(0===o)return i;for(let i=0;i<s;++i){let i=e+(h/=2),r=t(i);if(r*a>=0&&(e=i),Math.abs(h)<l||0===r)return i}return e+h}(function(r){return P8(t,e,r)-i},0,t+e)}function Ef(t,e,i){let r,n=(i=i||{}).maxIterations||200*e.length,s=i.nonZeroDelta||1.05,l=i.zeroDelta||.001,a=i.minErrorDelta||1e-6,o=i.minErrorDelta||1e-5,h=void 0!==i.rho?i.rho:1,u=void 0!==i.chi?i.chi:2,d=void 0!==i.psi?i.psi:-.5,c=void 0!==i.sigma?i.sigma:.5,p=e.length,g=Array(p+1);g[0]=e,g[0].fx=t(e),g[0].id=0;for(let i=0;i<p;++i){let r=e.slice();r[i]=r[i]?r[i]*s:l,g[i+1]=r,g[i+1].fx=t(r),g[i+1].id=i+1}function f(t){for(let e=0;e<t.length;e++)g[p][e]=t[e];g[p].fx=t.fx}let m=function(t,e){return t.fx-e.fx},y=e.slice(),v=e.slice(),b=e.slice(),_=e.slice();for(let e=0;e<n;++e){if(g.sort(m),i.history){let t=g.map(function(t){let e=t.slice();return e.fx=t.fx,e.id=t.id,e});t.sort(function(t,e){return t.id-e.id}),i.history.push({x:g[0].slice(),fx:g[0].fx,simplex:t})}r=0;for(let t=0;t<p;++t)r=Math.max(r,Math.abs(g[0][t]-g[1][t]));if(Math.abs(g[0].fx-g[p].fx)<a&&r<o)break;for(let t=0;t<p;++t){y[t]=0;for(let e=0;e<p;++e)y[t]+=g[e][t];y[t]/=p}let e=g[p];if(Ep(v,1+h,y,-h,e),v.fx=t(v),v.fx<g[0].fx)Ep(_,1+u,y,-u,e),_.fx=t(_),f(_.fx<v.fx?_:v);else if(v.fx>=g[p-1].fx){let i=!1;if(v.fx>e.fx?(Ep(b,1+d,y,-d,e),b.fx=t(b),b.fx<e.fx?f(b):i=!0):(Ep(b,1-d*h,y,d*h,e),b.fx=t(b),b.fx<v.fx?f(b):i=!0),i){if(c>=1)break;for(let e=1;e<g.length;++e)Ep(g[e],1-c,g[0],c,g[e]),g[e].fx=t(g[e])}}else f(v)}return g.sort(m),{fx:g[0].fx,x:g[0]}}function Em(t,e){let i=function(t,e){let i=e&&e.lossFunction?e.lossFunction:Eo,r={},n={};for(let e=0;e<t.length;++e){let i=t[e];if(1===i.sets.length){let t=i.sets[0];r[t]={x:1e10,y:1e10,size:i.size,radius:Math.sqrt(i.size/Math.PI),setId:t},n[t]=[]}}t=t.filter(function(t){return 2===t.sets.length});for(let e=0;e<t.length;++e){let i=t[e],s=i.hasOwnProperty("weight")?i.weight:1,l=i.sets[0],a=i.sets[1];i.size+1e-10>=Math.min(r[l].size,r[a].size)&&(s=0),n[l].push({set:a,size:i.size,weight:s}),n[a].push({set:l,size:i.size,weight:s})}let s=[];for(let t in n)if(n.hasOwnProperty(t)){let e=0;for(let i=0;i<n[t].length;++i)e+=n[t][i].size*n[t][i].weight;s.push({set:t,size:e})}function l(t,e){return e.size-t.size}s.sort(l);let a={};function o(t){return t.set in a}function h(t,e){r[e].x=t.x,r[e].y=t.y,a[e]=!0}h({x:0,y:0},s[0].set);for(let e=1;e<s.length;++e){let a=s[e].set,u=n[a].filter(o),d=r[a];if(u.sort(l),0===u.length)throw"ERROR: missing pairwise overlap information";let c=[];for(let t=0;t<u.length;++t){let e=r[u[t].set],i=Eg(d.radius,e.radius,u[t].size);c.push({x:e.x+i,y:e.y}),c.push({x:e.x-i,y:e.y}),c.push({y:e.y+i,x:e.x}),c.push({y:e.y-i,x:e.x});for(let n=t+1;n<u.length;++n){let t=r[u[n].set],s=Eg(d.radius,t.radius,u[n].size),l=P9({x:e.x,y:e.y,radius:i},{x:t.x,y:t.y,radius:s});for(let t=0;t<l.length;++t)c.push(l[t])}}let p=1e50,g=c[0];for(let e=0;e<c.length;++e){r[a].x=c[e].x,r[a].y=c[e].y;let n=i(r,t);n<p&&(p=n,g=c[e])}h(g,a)}return r}(t,e),r=e.lossFunction||Eo;if(t.length>=8){let n=function(t,e){let i,r,n,s=(e=e||{}).restarts||10,l=[],a={};for(i=0;i<t.length;++i){let e=t[i];1===e.sets.length&&(a[e.sets[0]]=l.length,l.push(e))}let o=function(t,e,i){let r=Eu(e.length,e.length),n=Eu(e.length,e.length);return t.filter(function(t){return 2===t.sets.length}).map(t=>{let s=i[t.sets[0]],l=i[t.sets[1]],a=Eg(Math.sqrt(e[s].size/Math.PI),Math.sqrt(e[l].size/Math.PI),t.size);r[s][l]=r[l][s]=a;let o=0;t.size+1e-10>=Math.min(e[s].size,e[l].size)?o=1:t.size<=1e-10&&(o=-1),n[s][l]=n[l][s]=o}),{distances:r,constraints:n}}(t,l,a),h=o.distances,u=o.constraints,d=Ed(h.map(Ed))/h.length;h=h.map(t=>t.map(t=>t/d));let c=function(t,e){return function(t,e,i,r){let n,s=0;for(n=0;n<e.length;++n)e[n]=0;for(n=0;n<i.length;++n){let l=t[2*n],a=t[2*n+1];for(let o=n+1;o<i.length;++o){let h=t[2*o],u=t[2*o+1],d=i[n][o],c=r[n][o],p=(h-l)*(h-l)+(u-a)*(u-a),g=Math.sqrt(p),f=p-d*d;c>0&&g<=d||c<0&&g>=d||(s+=2*f*f,e[2*n]+=4*f*(l-h),e[2*n+1]+=4*f*(a-u),e[2*o]+=4*f*(h-l),e[2*o+1]+=4*f*(u-a))}}return s}(t,e,h,u)};for(i=0;i<s;++i)n=function(t,e,i){let r={x:e.slice(),fx:0,fxprime:e.slice()},n={x:e.slice(),fx:0,fxprime:e.slice()},s=e.slice(),l,a=1,o=(i=i||{}).maxIterations||20*e.length;r.fx=t(r.x,r.fxprime);let h=r.fxprime.slice();Ec(h,r.fxprime,-1);for(let e=0;e<o;++e){if(a=function(t,e,i,r,n,s,l){let a=i.fx,o=dP(i.fxprime,e),h=a,u=a,d=o,c=0;function p(u,c,p){for(let g=0;g<16;++g)if(n=(u+c)/2,Ep(r.x,1,i.x,n,e),h=r.fx=t(r.x,r.fxprime),d=dP(r.fxprime,e),h>a+s*n*o||h>=p)c=n;else{if(Math.abs(d)<=-l*o)return n;d*(c-u)>=0&&(c=u),u=n,p=h}return 0}n=n||1,s=s||1e-6,l=l||.1;for(let g=0;g<10;++g){if(Ep(r.x,1,i.x,n,e),h=r.fx=t(r.x,r.fxprime),d=dP(r.fxprime,e),h>a+s*n*o||g&&h>=u)return p(c,n,u);if(Math.abs(d)<=-l*o)break;if(d>=0)return p(n,c,h);u=h,c=n,n*=2}return n}(t,h,r,n,a),i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:a}),a){Ep(s,1,n.fxprime,-1,r.fxprime);let t=dP(r.fxprime,r.fxprime);Ep(h,Math.max(0,dP(s,n.fxprime)/t),h,-1,n.fxprime),l=r,r=n,n=l}else Ec(h,r.fxprime,-1);if(1e-5>=Ed(r.fxprime))break}return i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:a}),r}(c,Eh(2*h.length).map((t,e)=>xC(e)),e),(!r||n.fx<r.fx)&&(r=n);let p=r.x,g={};for(i=0;i<l.length;++i){let t=l[i];g[t.sets[0]]={x:p[2*i]*d,y:p[2*i+1]*d,radius:Math.sqrt(t.size/Math.PI)}}if(e.history)for(i=0;i<e.history.length;++i)Ec(e.history[i].x,d);return g}(t,e);r(n,t)+1e-8<r(i,t)&&(i=n)}return i}function Ey(t){let e=function(e){return{max:Math.max.apply(null,t.map(function(t){return t[e]+t.radius})),min:Math.min.apply(null,t.map(function(t){return t[e]-t.radius}))}};return{xRange:e("x"),yRange:e("y")}}function Ev(t,e,i){let r,n,s=e[0].radius-dD.distancePP(e[0],t);for(r=1;r<e.length;++r)(n=e[r].radius-dD.distancePP(e[r],t))<=s&&(s=n);for(r=0;r<i.length;++r)(n=dD.distancePP(i[r],t)-i[r].radius)<=s&&(s=n);return s}let Eb=(t,e)=>{let{x0:i,x1:r,y0:n,y1:s,setField:l="sets",valueField:a="size",orientation:o=Math.PI/2,orientationOrder:h=null}=t,u={},d={};if(e.length>0){let c=e.map(t=>({sets:ed(t[l]),size:t[a]})),p=function(t,e){(e=e||{}).maxIterations=e.maxIterations||500;let i=e.initialLayout||Em,r=e.lossFunction||Eo,n=i(t=function(t){t=t.slice();let e=[],i={};for(let r=0;r<t.length;++r){let n=t[r];if(1===n.sets.length)e.push(n.sets[0]);else if(2===n.sets.length){let t=n.sets[0],e=n.sets[1];i[[t,e].toString()]=!0,i[[e,t].toString()]=!0}}e.sort(function(t,e){return+(t>e)});for(let r=0;r<e.length;++r){let n=e[r];for(let s=r+1;s<e.length;++s){let r=e[s];[n,r].toString()in i||t.push({sets:[n,r],size:0})}}return t}(t),e),s=[],l=[];for(let t in n)n.hasOwnProperty(t)&&(s.push(n[t].x),s.push(n[t].y),l.push(t));let a=Ef(function(e){let i={};for(let t=0;t<l.length;++t){let r=l[t];i[r]={x:e[2*t],y:e[2*t+1],radius:n[r].radius}}return r(i,t)},s,e).x;for(let t=0;t<l.length;++t){let e=l[t];n[e].x=a[2*t],n[e].y=a[2*t+1]}return n}(c,t);d=function(t,e){let i={},r=function(t){let e={},i=[];for(let r in t)i.push(r),e[r]=[];for(let r=0;r<i.length;r++){let n=t[i[r]];for(let s=r+1;s<i.length;++s){let l=t[i[s]],a=dD.distancePP(n,l);a+l.radius<=n.radius+1e-10?e[i[s]].push(i[r]):a+n.radius<=l.radius+1e-10&&e[i[r]].push(i[s])}}return e}(t);for(let n=0;n<e.length;++n){let s=e[n].sets,l={},a={};for(let t=0;t<s.length;++t){l[s[t]]=!0;let e=r[s[t]];for(let t=0;t<e.length;++t)a[e[t]]=!0}let o=[],h=[];for(let e in t)e in l?o.push(t[e]):e in a||h.push(t[e]);let u=function t(e,i){let r=[];for(let t=0;t<e.length;++t){let i=e[t];r.push({x:i.x,y:i.y}),r.push({x:i.x+i.radius/2,y:i.y}),r.push({x:i.x-i.radius/2,y:i.y}),r.push({x:i.x,y:i.y+i.radius/2}),r.push({x:i.x,y:i.y-i.radius/2})}let n=r[0],s=Ev(r[0],e,i);for(let t=1;t<r.length;++t){let l=Ev(r[t],e,i);l>=s&&(n=r[t],s=l)}let l=Ef(function(t){return -1*Ev({x:t[0],y:t[1]},e,i)},[n.x,n.y],{maxIterations:500,minErrorDelta:1e-10}).x,a={x:l[0],y:l[1]},o=!0;for(let t=0;t<e.length;++t)if(dD.distancePP(a,e[t])>e[t].radius){o=!1;break}for(let t=0;t<i.length;++t)if(dD.distancePP(a,i[t])<i[t].radius){o=!1;break}if(!o)if(1===e.length)a={x:e[0].x,y:e[0].y};else{let r={};P4(e,r),a=0===r.arcs.length?{x:0,y:-1e3,disjoint:!0}:1===r.arcs.length?{x:r.arcs[0].circle.x,y:r.arcs[0].circle.y}:i.length?t(e,[]):P7(r.arcs.map(function(t){return t.p1}))}return a}(o,h);i[s.toString()]=u,u.disjoint&&e[n].size>0&&tU.getInstance().error("Area "+s+" not represented on screen")}return i}(u=function(t,e,i,r,n){e=Math.max(e,1),i=Math.max(i,1);let s=[],l=[];for(let e in t)t.hasOwnProperty(e)&&(l.push(e),s.push(t[e]));let a=Ey(s),o=a.xRange,h=a.yRange;if(o.max===o.min||h.max===h.min)return console.log("not scaling solution: zero size detected"),t;let u=e/(o.max-o.min),d=Math.min(i/(h.max-h.min),u),c=(e-(o.max-o.min)*d)/2,p=(i-(h.max-h.min)*d)/2,g={};for(let t=0;t<s.length;++t){let e=s[t];g[l[t]]={radius:d*e.radius,x:r+c+(e.x-o.min)*d,y:n+p+(e.y-h.min)*d,setId:e.setId}}return g}(p=function(t,e,i){null===e&&(e=Math.PI/2);let r=[];for(let e in t)if(t.hasOwnProperty(e)){let i=t[e];r.push({x:i.x,y:i.y,radius:i.radius,setId:e})}let n=function(t){let e;function i(t){return t.parent!==t&&(t.parent=i(t.parent)),t.parent}t.map(function(t){t.parent=t});for(let e=0;e<t.length;++e)for(let s=e+1;s<t.length;++s){var r,n;let l=t[e].radius+t[s].radius;dD.distancePP(t[e],t[s])+1e-10<l&&(r=t[s],n=t[e],i(r).parent=i(n))}let s={};for(let r=0;r<t.length;++r)(e=i(t[r]).parent.setId)in s||(s[e]=[]),s[e].push(t[r]);t.map(function(t){delete t.parent});let l=[];for(e in s)s.hasOwnProperty(e)&&l.push(s[e]);return l}(r);for(let t=0;t<n.length;++t){!function(t,e,i){let r;if(null===i?t.sort(function(t,e){return e.radius-t.radius}):t.sort(i),t.length>0){let e=t[0].x,i=t[0].y;for(r=0;r<t.length;++r)t[r].x-=e,t[r].y-=i}if(2===t.length&&dD.distancePP(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y),t.length>1){let i,n,s=Math.atan2(t[1].x,t[1].y)-e,l=Math.cos(s),a=Math.sin(s);for(r=0;r<t.length;++r)i=t[r].x,n=t[r].y,t[r].x=l*i-a*n,t[r].y=a*i+l*n}if(t.length>2){let i=Math.atan2(t[2].x,t[2].y)-e;for(;i<0;)i+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI;if(i>Math.PI){let e=t[1].y/(1e-10+t[1].x);for(r=0;r<t.length;++r){let i=(t[r].x+e*t[r].y)/(1+e*e);t[r].x=2*i-t[r].x,t[r].y=2*i*e-t[r].y}}}}(n[t],e,i);let r=Ey(n[t]);n[t].size=(r.xRange.max-r.xRange.min)*(r.yRange.max-r.yRange.min),n[t].bounds=r}n.sort(function(t,e){return e.size-t.size});let s=(r=n[0]).bounds,l=(s.xRange.max-s.xRange.min)/50;function a(t,e,i){let n,a,o;if(!t)return;let h=t.bounds;e?n=s.xRange.max-h.xRange.min+l:(n=s.xRange.max-h.xRange.max,(o=(h.xRange.max-h.xRange.min)/2-(s.xRange.max-s.xRange.min)/2)<0&&(n+=o)),i?a=s.yRange.max-h.yRange.min+l:(a=s.yRange.max-h.yRange.max,(o=(h.yRange.max-h.yRange.min)/2-(s.yRange.max-s.yRange.min)/2)<0&&(a+=o));for(let e=0;e<t.length;++e)t[e].x+=n,t[e].y+=a,r.push(t[e])}let o=1;for(;o<n.length;)a(n[o],!0,!1),a(n[o+1],!1,!0),a(n[o+2],!0,!0),o+=3,s=Ey(r);let h={};for(let t=0;t<r.length;++t)h[r[t].setId]=r[t];return h}(p,o,h),r-i,s-n,i,n),c)}return e.map(t=>{let e=ed(t[l]),i=e.toString(),r=d[i],n=Object.assign(Object.assign({},t),{datum:t,sets:e,key:i,size:t[a],labelX:null==r?void 0:r.x,labelY:null==r?void 0:r.y}),s=u[i];if(s)return Object.assign(Object.assign({},n),{type:"circle",x:s.x,y:s.y,radius:s.radius});let o=Et(e.map(t=>u[t]));return Object.assign(Object.assign({},n),{type:"overlap",x:0,y:0,path:Ee(o),arcs:o})})},E_=(t,e)=>e.filter(e=>e.type===t.datumType),Ex=(t,e)=>{let i=e.getViewBox();return i&&(null==t?void 0:t.length)?Eb(Object.assign({setField:e.setField,valueField:e.valueField},i),t):[]};class EC extends cI{constructor(){super(...arguments),this.type=rR.venn,this.transformerConstructor=Ea,this._viewBox=new pY}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec(),this.setCategoryField(null!=(t=this._spec.categoryField)?t:"sets"),this.setValueField(null!=(e=this._spec.valueField)?e:"size"),this.setSeriesField(null!=(i=this._spec.seriesField)?i:ss)}initData(){var t;super.initData(),nq(this._dataSet,"venn",Ex),null==(t=this._data.getDataView())||t.transform({type:"venn",options:{getViewBox:()=>this._viewBox.empty()?null:{x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2},setField:this._categoryField,valueField:this._valueField}})}compile(){super.compile(),this._runVennTransform()}_runVennTransform(t=!1){this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()}initMark(){let t=this._createMark(EC.mark.circle,{isSeriesMark:!0});t&&(t.setTransform([{type:"vennMark",datumType:"circle"}]),this._circleMark=t);let e=this._createMark(EC.mark.overlap,{isSeriesMark:!0});e&&(e.setTransform([{type:"vennMark",datumType:"overlap"}]),this._overlapMark=e)}initMarkStyle(){this._initCircleMarkStyle(),this._initOverlapMarkStyle()}_initCircleMarkStyle(){this._circleMark&&this.setMarkStyle(this._circleMark,{x:t=>t.x,y:t=>t.y,innerRadius:0,outerRadius:t=>t.radius,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),stroke:this.getColorAttribute()},j.STATE_NORMAL,W.Series)}_initOverlapMarkStyle(){this._overlapMark&&(this.setMarkStyle(this._overlapMark,{x:t=>t.x,y:t=>t.y,path:t=>t.path,arcs:t=>t.arcs,fill:this.getColorAttribute(),stroke:this.getColorAttribute(),zIndex:t=>100*t.sets.length},j.STATE_NORMAL,W.Series),this.setMarkStyle(this._overlapMark,{zIndex:t=>100*t.sets.length+1},j.STATE_HOVER,W.Series))}initLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("venn"),this.setMarkStyle(t,{x:t=>t.labelX,y:t=>t.labelY,text:t=>P2(t.sets),maxLineWidth:t=>{let{x:e,radius:i,labelX:r}=t;return Math.min(r-(e-i),e+i-r)}},j.STATE_NORMAL,W.Series))}initOverlapLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("venn"),this.setMarkStyle(t,{x:t=>t.labelX,y:t=>t.labelY,text:t=>P2(t.sets)},j.STATE_NORMAL,W.Series))}initTooltip(){this._tooltipHelper=new P3(this),this._circleMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circleMark),this._overlapMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._overlapMark)}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runVennTransform()}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._circleMark,this._overlapMark]}getStatisticFields(){let t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}getGroupFields(){return null}dataToPosition(t,e){return{x:t.x,y:t.y}}dataToPositionX(t){return t.x}dataToPositionY(t){return t.y}valueToPosition(t,e){throw Error("Method not implemented.")}getStackGroupFields(){return[]}getStackValueField(){return null}_getSeriesInfo(t,e){let i=this.getDefaultShapeType();return e.map(e=>({key:P2(e),originalKey:e,style:this.getSeriesStyle({[t]:e}),shapeType:i}))}getSeriesFieldValue(t,e){return P2(super.getSeriesFieldValue(t,e))}legendSelectedFilter(t,e){if(t.type===rk.discreteLegend){let i=t.getLegendDefaultData(!0);if(0===e.length&&i.length)return[];if(e.length===i.length)return e;let r={};e.forEach(t=>{r[t]=!0});let n=i.filter(t=>!r[P2(t)]),s=i.filter(t=>!n.includes(t)&&n.some(e=>ed(e).every(e=>t.includes(e))));e=e.slice(),s.forEach(t=>{e.splice(e.indexOf(P2(t)),1)})}return e}initAnimation(){this.getMarksInType("arc").forEach(t=>{var e;t.setAnimationConfig(cA(null==(e=iv.getAnimationInKey("vennCircle"))?void 0:e(),cM(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("path").forEach(t=>{var e;t.setAnimationConfig(cA(null==(e=iv.getAnimationInKey("vennOverlap"))?void 0:e(),cM(t.name,this._spec,this._markAttributeContext)))})}}EC.type=rR.venn,EC.mark=P5,EC.builtInTheme={venn:{circle:{style:{opacity:.8},state:{hover:{opacity:1}}},overlap:{style:{opacity:.8},state:{hover:{opacity:1,stroke:"white",lineWidth:2}}},label:{visible:!0,style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"}}},overlapLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},EC.transformerConstructor=Ea;let Ew=()=>{bp(),yF(),El(),u5(),iv.registerGrammarTransform("vennMark",{transform:E_}),iv.registerSeries(EC.type,EC)};class ES extends fD{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","circle","overlap","overlapLabel"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class EA extends fV{constructor(){super(...arguments),this.transformerConstructor=ES,this.type="venn",this.seriesType=rR.venn}}EA.type="venn",EA.seriesType=rR.venn,EA.transformerConstructor=ES;let EM=()=>{mx(),Ew(),iv.registerChart(EA.type,EA)};class Ek extends fH{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar","bandWidthField"])}transformSpec(t){super.transformSpec(t),sW(t)}_setDefaultXAxisSpec(t){return{orient:"bottom",type:"linear",label:{visible:!1}}}_setDefaultYAxisSpec(t){return{orient:"left",type:"linear"}}}class ET extends yl{constructor(){super(...arguments),this.type=rR.mosaic,this.transformerConstructor=ys}get bandWidthField(){return this._bandWidthField}getStack(){return!0}getPercent(){return this._spec.percent}getGroupFields(){return"vertical"===this.direction?this._specXField:this._specYField}setAttrFromSpec(){super.setAttrFromSpec();let t=this.getPercent();"horizontal"===this.direction?(t&&(this.setFieldX(s_),this.setFieldX2(sb)),this.setFieldY(sC),this.setFieldY2(sx)):(t&&(this.setFieldY(s_),this.setFieldY2(sb)),this.setFieldX(sC),this.setFieldX2(sx)),this._spec.bandWidthField&&(this._bandWidthField=this._spec.bandWidthField)}parseLabelStyle(t,e){if((null==e?void 0:e.filterByGroup)&&er(t.dataFilter)){let i=this.getGroupFields(),{field:r,type:n="max",filter:s}=e.filterByGroup;delete t.filterField;let l=i.indexOf(r);if(l<0)return;let a=l%2?"min"===n?"horizontal"===this.direction?this._fieldY2:this._fieldX2:"horizontal"===this.direction?this._fieldY:this._fieldX:"min"===n?"horizontal"===this.direction?this._fieldX2:this._fieldY2:"horizontal"===this.direction?this._fieldX:this._fieldY,o="min"===n?(t,e)=>{var i,r;return(null==(i=t.data)?void 0:i[a])<(null==(r=e.data)?void 0:r[a])}:(t,e)=>{var i,r;return(null==(i=t.data)?void 0:i[a])>(null==(r=e.data)?void 0:r[a])};t.dataFilter=t=>{let e={};return t.forEach(t=>{let i=t.data,n=null==i?void 0:i[r];er(n)||s&&!s(t)||e[n]&&!o(t,e[n])||(e[n]=t)}),t.filter(t=>{var i;let n=null==(i=t.data)?void 0:i[r];return e[n]&&e[n]===t})}}return t}}ET.type=rR.mosaic,ET.builtInTheme={mosaic:{label:{visible:!1,position:"center",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},bar:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}}}},ET.transformerConstructor=ys;let ER=()=>{yi(),_B(),u5(),fb(),iv.registerSeries(ET.type,ET)};class EB extends fV{constructor(){super(...arguments),this.transformerConstructor=Ek,this.type="mosaic",this.seriesType=rR.mosaic,this.handleAfterStackRegion=(t,e)=>{t.getSeries().forEach(t=>{let i=t.getStackData(),r=t.getStackValue(),n=t.getStackValueField();i&&n&&(dq(e[r],n),dJ(t,e[r]))})}}_beforeInit(){this._dataSet&&nq(this._dataSet,"stackSplit",fZ)}_initStack(){this._stack=new fU(this,{afterStackRegion:this.handleAfterStackRegion}),this._stack.init()}_setModelOption(){this._modelOption.getDimensionInfo=mr,this._modelOption.getDimensionInfoByValue=ms,this._modelOption.getRectByDimensionData=md}}EB.type="mosaic",EB.seriesType=rR.mosaic,EB.transformerConstructor=Ek;let EP=()=>{mb(),mx(),mw(),f8(),fX(),ER(),iv.registerChart(EB.type,EB)};(tf=tL||(tL={})).middle="middle",tf.start="start",tf.end="end",tf.bothEnd="bothEnd",(tm=tF||(tF={})).middle="middle",tm.start="start",tm.end="end",(ty=tO||(tO={})).area_horizontal="area_horizontal",ty.area_vertical="area_vertical",ty.area_stack="area_stack",ty.line_horizontal="line_horizontal",ty.line_vertical="line_vertical",ty.line_stack="line_stack",ty.bar_horizontal="bar_horizontal",ty.bar_vertical="bar_vertical",ty.bar_stack="bar_stack",ty.rangeColumn_horizontal="rangeColumn_horizontal",ty.rangeColumn_vertical="rangeColumn_vertical",ty.rangeArea_horizontal="rangeArea_horizontal",ty.rangeArea_vertical="rangeArea_vertical",ty.linearProgress_horizontal="linearProgress_horizontal",ty.linearProgress_vertical="linearProgress_vertical",ty.linearProgress_stack="linearProgress_stack",ty.boxPlot_horizontal="boxPlot_horizontal",ty.boxPlot_vertical="boxPlot_vertical",ty.sankey_horizontal="sankey_horizontal",ty.sankey_vertical="sankey_vertical",ty.waterfall_horizontal="waterfall_horizontal",ty.waterfall_vertical="waterfall_vertical",ty.circularProgress_stack="circularProgress_stack",ty.radar_stack="radar_stack",ty.rose_stack="rose_stack",(tv=tD||(tD={}))[tv.success=0]="success",tv[tv.failed=1]="failed";let EE=(t,e,i)=>{for(let r in t)switch(r){case"maxHeight":if(t8(t.maxHeight)&&e.height>t.maxHeight)return!1;break;case"minHeight":if(t8(t.minHeight)&&e.height<t.minHeight)return!1;break;case"maxWidth":if(t8(t.maxWidth)&&e.width>t.maxWidth)return!1;break;case"minWidth":if(t8(t.minWidth)&&e.width<t.minWidth)return!1;break;case"onResize":if(t8(t.onResize)&&!t.onResize(e,i))return!1}return!0},EI=(t="chart",e,i,r,n,s)=>{let l=EL(t,n,s);return Object.assign(Object.assign({},l),{modelInfo:l.modelInfo.filter(t=>!!er(e)||ed(e).some(e=>tQ(e)?e(t,i,r):sX(t.spec,e)))})},EL=(t="chart",e,i)=>{var r,n,s,l,a,o,h,u,d,c,p;let g={modelInfo:[]};if("chart"===t)g.isChart=!0,g.modelInfo.push({spec:e,type:"chart"});else if("region"===t)g.modelType="region",g.specKey="region",null==(r=e.region)||r.forEach((t,e)=>{g.modelInfo.push({spec:t,specPath:["region",e],type:"region"})});else if("series"===t)g.modelType="series",g.specKey="series",null==(n=e.series)||n.forEach((t,e)=>{g.modelInfo.push({spec:t,specPath:["series",e],type:t.type})});else if(Object.values(rR).includes(t))g.modelType="series",g.specKey="series",g.type=t,null==(s=e.series)||s.forEach((e,i)=>{e.type===t&&g.modelInfo.push({spec:e,specPath:["series",i],type:t})});else if(Object.values(rk).includes(t)){g.modelType="component",g.type=t,g.specKey=null==(l=iv.getComponentInKey(t))?void 0:l.specKey;let{specKey:r}=g,n=ed(null!=(o=null==(a=i.component)?void 0:a[r])?o:[]);null==(u=ed(null!=(h=e[r])?h:[]))||u.forEach((e,i)=>{let r=n[i];r&&r.type===t?g.modelInfo.push(Object.assign(Object.assign({},r),{spec:e})):e&&!1===e.visible&&g.modelInfo.push({type:t,spec:e})})}else{let r=iv.getComponents().filter(({cmp:e})=>e.specKey===t).map(({cmp:t})=>t.type);if(r.length>0){g.modelType="component",g.specKey=t;let n=ed(null!=(c=null==(d=i.component)?void 0:d[t])?c:[]);ed(null!=(p=e[t])?p:[]).forEach((t,e)=>{let i=n[e];i&&r.includes(i.type)&&g.modelInfo.push(Object.assign(Object.assign({},i),{spec:t}))})}}return g},EF=(t,e,i,r)=>{let{spec:n,filter:s,filterType:l,forceAppend:a}=t,{isChart:o,modelType:h,specKey:u,type:d,modelInfo:c}=EI(l,s,t,e,i,r);if(0===c.length&&!a)return{chartSpec:i,hasChanged:!1};let p=ir({},i),g=tQ(n)?n(c,t,e):n;for(let{spec:t,specPath:e}of c){if(o)return{chartSpec:ir(p,g),hasChanged:!0};sq(p,e,ir({},t,g))}if(0===c.length&&a){let t=Object.assign({type:d},g);tq(p[u])?p[u].push(t):er(p[u])?p[u]="component"===h?t:[t]:p[u]=[p[u],t]}return{chartSpec:p,hasChanged:!0}},EO=t=>t instanceof el||function(t){try{return t instanceof Element}catch(i){let e=Object.keys(t);return["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"].every(t=>e.includes(t))}}(t);function ED(t,e=["data"]){return t9(t,EO,e)}class EH extends gl{constructor(){super(EH.type),this.type="MediaQueryPlugin",this._currentMediaInfo={},this.currentActiveItems=new Set,this._initialized=!1}onInit(t,e){if(!(null==e?void 0:e[EH.specKey]))return;let{globalInstance:i}=t;this._option={globalInstance:t.globalInstance,updateSpec:(t,e,r)=>{r?i.updateSpecSync(t):e?i.updateSpecAndRecompile(t,!1,{transformSpec:!0}):i.setRuntimeSpec(t)}},this._spec=e[EH.specKey],this._initialized=!0}onBeforeResize(t,e,i){this._initialized&&this._changeSize(e,i,!0,!1)}onAfterChartSpecTransform(t,e,i){this._initialized&&"setCurrentTheme"===i&&this._reInit(!1,!1)}onAfterModelSpecTransform(t,e,i,r){this._initialized&&"updateSpec"===r&&this.onBeforeInitChart(t,e,"setCurrentTheme")}onBeforeInitChart(t,e,i){let r,n;if(this._initialized){switch(i){case"render":case"updateModelSpec":r=!1,n=!0;break;case"setCurrentTheme":r=!0,n=!1;break;case"updateSpecAndRecompile":r=!1,n=!1}if(r&&this.release(),this._initialized||this.onInit(t,e),r||n){let{width:t,height:e}=this._option.globalInstance.getCurrentSize();this._changeSize(t,e,!1,!1)}}}_changeSize(t,e,i,r){return(this._currentMediaInfo.width!==t||this._currentMediaInfo.height!==e)&&(this._currentMediaInfo.width=t,this._currentMediaInfo.height=e,this._applyQueries(i,r))}_applyQueries(t,e){let i,r,n=[],s=[];if(this._spec.forEach(t=>{let{hasChanged:e,isActive:i}=this._check(t);e&&(i?n.push(t):s.push(t))}),!n.length&&!s.length)return!1;this._baseChartSpec||(this._baseChartSpec=ED(this._option.globalInstance.getSpec(),["data",EH.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo());let l=!1;return s.length>0?(i=ED(this._baseChartSpec,["data",EH.specKey]),r=this._baseChartSpecInfo,Array.from(this.currentActiveItems).forEach(t=>{if(s.includes(t))return void this.currentActiveItems.delete(t);i=this._apply(t,i,r).chartSpec}),l=!0):(i=this._option.globalInstance.getSpec(),r=this._option.globalInstance.getSpecInfo()),n.forEach(t=>{this.currentActiveItems.add(t);let e=this._apply(t,i,r);i=e.chartSpec,l||(l=e.hasChanged)}),l&&this._option.updateSpec(i,t,e),!0}_check(t){let{globalInstance:e}=this._option,i=EE(t.query,this._currentMediaInfo,e);return{isActive:i,hasChanged:i!==this.currentActiveItems.has(t)}}_apply(t,e,i){let{query:r,action:n}=t,s=!1;return ed(n).forEach(t=>{let n=EF(t,r,e,i);e=n.chartSpec,s||(s=n.hasChanged)}),{chartSpec:e,hasChanged:s}}_reInit(t,e){let i=this._option.globalInstance.getSpec();this._baseChartSpec=ED(i,["data",EH.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo();let r=!1;this.currentActiveItems.forEach(t=>{let e=this._apply(t,i,this._baseChartSpecInfo);i=e.chartSpec,r||(r=e.hasChanged)}),r&&this._option.updateSpec(i,t,e)}release(){super.release(),this._initialized=!1,this._spec=[],this._option=void 0,this._currentMediaInfo={},this.currentActiveItems.clear()}}EH.pluginType="chart",EH.specKey="media",EH.type="MediaQueryPlugin";let Ez=()=>{Pr(EH)};function EW(t,e=0){let i=0xdeadbeef^e;return i=(i=0xcc9e2d51*((i=(0x9e3779b9^i)+(i<<6)+(i>>2))^t))<<15|i>>>17,i^=i<<25,i+=i<<9,i^=i>>4,i^=i<<18,((i|=1)>>>0)%0x7fffffff/0x7fffffff}function EN(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI+2*EW(e*n+i)*Math.PI)+1)/2))}function Ej(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-i/n*2*Math.PI)+1)/2))}function EG(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-(n-1-i)/n*2*Math.PI)+1)/2))}function EV(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-e/r*2*Math.PI)+1)/2))}function EZ(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-(r-1-e)/r*2*Math.PI)+1)/2))}function EU(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-2*Math.sqrt(Math.pow((e-r/2)/r,2)+Math.pow((i-n/2)/n,2))*Math.PI)+1)/2))}function EK(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-(e/r+i/n)/2*2*Math.PI)+1)/2))}function E$(t,e,i,r,n,s,l,a=0,o=1){let h=Math.atan2(e-r/2,i-n/2);return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-(h<0?h+2*Math.PI:h)/(2*Math.PI)*2*Math.PI)+1)/2))}function EY(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI*3-2*(Math.sqrt(Math.pow(e-r/2,2)+Math.pow(i-n/2,2))/Math.sqrt(Math.pow(r/2,2)+Math.pow(n/2,2)))*Math.PI)+1)/2))}function EX(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-(e+i)%(r+n)/(r+n)*4*Math.PI)+1)/2))}function Eq(t,e,i,r,n,s,l,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-e/r*2*Math.PI)*Math.sin(2*s*Math.PI-i/n*2*Math.PI)+1)/2))}function EJ(t,e,i,r,n,s,l,a=0,o=1){let h=r/2,u=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-4*((Math.sqrt(Math.pow(e-h,2)+Math.pow(i-u,2))/Math.sqrt(Math.pow(r/2,2)+Math.pow(n/2,2))+Math.atan2(e-h,i-u)/(2*Math.PI))/2)*Math.PI)+1)/2))}function EQ(t,e,i,r,n,s,l,a=0,o=1){let h=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-Math.abs(i-h)/h*2*Math.PI)+1)/2))}function E0(t,e,i,r,n,s,l,a=0,o=1){let h=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-2*(1-Math.abs(i-h)/h)*Math.PI)+1)/2))}function E1(t,e,i,r,n,s,l,a=0,o=1){let h=r/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-Math.abs(e-h)/h*2*Math.PI)+1)/2))}function E2(t,e,i,r,n,s,l,a=0,o=1){let h=r/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-2*(1-Math.abs(e-h)/h)*Math.PI)+1)/2))}function E3(t,e,i,r,n,s,l,a=0,o=1){let h=r/2,u=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-2*Math.min(Math.sqrt(Math.pow((e-h)/h,2)+Math.pow((i-u)/u,2)),1)*Math.PI)+1)/2))}function E5(t,e,i,r,n,s,l,a=0,o=1){let h=r/2,u=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*s*Math.PI-2*(1-Math.min(Math.sqrt(Math.pow((e-h)/h,2)+Math.pow((i-u)/u,2)),1))*Math.PI)+1)/2))}function E4(t,e,i,r,n,s,l,a=0,o=1){let h=r/2,u=n/2,d=Math.min(Math.sqrt(Math.pow((e-h)/h,2)+Math.pow((i-u)/u,2)),1),c=Math.max(0,1-d);return Math.min(1,Math.max(0,a+o*((Math.sin(2*s*Math.PI*3-4*d*Math.PI)+1)/2)*(.7*c+.3)))}function E6(t,e,i,r,n,s,l,a=0,o=1){let h=e*n+i,u=2*EW(h,0)*Math.PI,d=.5*EW(h,1)+.5,c=2*EW(h,2)*Math.PI,p=r/2,g=n/2,f=(s-.4)/.6,m=Math.sin(f*d*8*Math.PI+u+c*f),y=Math.cos(Math.min(Math.sqrt(Math.pow((e-p)/p,2)+Math.pow((i-g)/g,2)),1)*Math.PI+f*Math.PI);return Math.min(1,Math.max(0,a+(m+1)/2*Math.max(0,1-1.2*f)*(.3+.7*y)*o))}var E8=i(93431),E9=i(76554);function E7(){let t=E9.X.getInstance();t.registerTransition("update","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),t.registerTransition("update","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),t.registerTransition("update","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),t.registerTransition("state","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),t.registerTransition("state","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),t.registerTransition("state","exit",()=>({allowTransition:!0,stopOriginalTransition:!0}))}class It{constructor(t,e,i,r,n){this.state=t,this.graphics=e,this.config=i||[],this.beforeExecute=r,this.afterExecute=n}execute(t,e){if(!this.graphics.length||!this.config.length)return void(null==e||e());this.beforeExecute&&this.beforeExecute(this.graphics);let i=0,r=this.graphics.length,n=()=>{++i>=r&&(this.afterExecute&&this.afterExecute(this.graphics),null==e||e())};this.graphics.forEach(t=>{if(!t)return void i++;"exit"===this.state&&(t.isExiting=!0);let e=this.config.length>1?this.config.map(e=>({name:this.state,animation:Object.assign(Object.assign({},e),{customParameters:t.context})})):{name:this.state,animation:Object.assign(Object.assign({},this.config[0]),{customParameters:t.context})};t.applyAnimationState([this.state],[e],n)})}executeOnGroup(t,e){if(!this.graphics.length||!this.config.length||!t)return void(null==e||e());this.beforeExecute&&this.beforeExecute(this.graphics);let i=this.config[0],r=[{name:this.state,animation:Object.assign({},i)}];r.forEach(t=>{t.animation.customParameters=(t,e)=>e.context}),t.applyAnimationState([this.state],r,()=>{this.afterExecute&&this.afterExecute(this.graphics),null==e||e()})}}class Ie{constructor(){this.name="verticalBarSplit"}shouldApply(t,e){var i,r;let n="rect"===t.type,s="vertical"===(null==(i=t.model)?void 0:i.direction),l=(null==(r=e.context)?void 0:r.diffAttrs)||{};return n&&s&&("x"in l||"width"in l||"x1"in l)&&("y"in l||"height"in l||"y1"in l)}split(t,e){var i;let r=(null==(i=e.context)?void 0:i.diffAttrs)||{},n={},s={};Object.entries(r).forEach(([t,e])=>{"x"===t||"width"===t||"x1"===t?n[t]=e:"y"===t||"height"===t||"y1"===t?s[t]=e:n[t]=e});let l=e.context,a=l.fieldX,o=l.originalFieldX,h=Array.isArray(a)&&a.length>1,u=(o?!(Array.isArray(o)&&o.length>1):!h)&&h;return[{attrs:n,order:u?1:2},{attrs:s,order:u?2:1}]}}class Ii{constructor(){this.name="horizontalBarSplit"}shouldApply(t,e){var i,r;let n="rect"===t.type,s="horizontal"===(null==(i=t.model)?void 0:i.direction),l=(null==(r=e.context)?void 0:r.diffAttrs)||{};return n&&s&&("y"in l||"height"in l||"y1"in l)&&("x"in l||"width"in l||"x1"in l)}split(t,e){var i;let r=(null==(i=e.context)?void 0:i.diffAttrs)||{},n={},s={};Object.entries(r).forEach(([t,e])=>{"y"===t||"height"===t||"y1"===t?n[t]=e:"x"===t||"width"===t||"x1"===t?s[t]=e:n[t]=e});let l=e.context,a=l.fieldY,o=l.originalFieldY,h=Array.isArray(a)&&a.length>1,u=!(o?!(Array.isArray(o)&&o.length>1):!h)&&!h;return[{attrs:n,order:u?2:1},{attrs:s,order:u?1:2}]}}class Ir{constructor(t){this.splitStrategies=[],this.mark=t,"rect"===t.type&&(this.registerStrategy(new Ie),this.registerStrategy(new Ii))}registerStrategy(t){this.splitStrategies.push(t)}detect(t,e){let i=[],r=[],n=[],s=[],l=this.mark.model.fieldX,a=this.mark.model.fieldY;return t.forEach(t=>{let e=t.context;switch(e.fieldX&&(e.originalFieldX=e.fieldX),e.fieldY&&(e.originalFieldY=e.fieldY),e.fieldX=l,e.fieldY=a,t.context.animationState){case"update":r.push(t);break;case"enter":n.push(t);break;case"appear":s.push(t);break;default:t.context.diffState===N.exit?i.push(t):t.context.diffState===N.enter?n.push(t):r.push(t)}}),e.size>t.length&&e.forEach((t,e)=>{t.context.diffState!==N.exit||t.isExiting||i.push(t)}),{hasExit:i.length>0,hasUpdate:r.length>0,hasEnter:n.length>0,hasAppear:s.length>0,exitGraphics:i,updateGraphics:r,enterGraphics:n,appearGraphics:s}}createPlanners(t,e){let i=[];if(t.hasExit&&e.exit&&i.push(new It("exit",t.exitGraphics,e.exit)),t.hasUpdate&&e.update){let r=new Map,n=[];t.updateGraphics.forEach(t=>{let e=!1;for(let i of this.splitStrategies)if(i.shouldApply(this.mark,t)){let n=i.split(this.mark,t),s={graphic:t,steps:n};n.forEach(t=>{let{order:e}=t;r.has(e)||r.set(e,[]),r.get(e).push(s)}),e=!0;break}e||n.push(t)}),n.length>0&&i.push(new It("update",n,e.update));let s=Array.from(r.keys()).sort((t,e)=>t-e);s.forEach(t=>{let n=r.get(t);if(n&&n.length>0){let r=n.map(({graphic:e,steps:i})=>{let r=i.find(e=>e.order===t);return{graphic:e,attrs:(null==r?void 0:r.attrs)||{}}});i.push(new It("update",r.map(t=>t.graphic),e.update,t=>{t.forEach((t,e)=>{let i=r[e].attrs,n=t.context;n._originalDiffAttrs||(n._originalDiffAttrs=t.context.diffAttrs),t.context.diffAttrs=i})},e=>{t===s[s.length-1]&&e.forEach(t=>{let e=t.context;e._originalDiffAttrs&&(t.context.diffAttrs=e._originalDiffAttrs,delete e._originalDiffAttrs)})}))}})}return t.hasEnter&&e.enter&&i.push(new It("enter",t.enterGraphics,e.enter)),t.hasAppear&&e.appear&&i.push(new It("appear",t.appearGraphics,e.appear)),i}}class In{registerAnimationSplitStrategy(t){this._grammarDetector||(this._grammarDetector=new Ir(this)),this._grammarDetector.registerStrategy(t)}getGrammarDetector(){return this.initGrammarDetector(),this._grammarDetector}initGrammarDetector(){this._grammarDetector||(this._grammarDetector=new Ir(this))}_runSequentialAnimations(t){this.initGrammarDetector();let e=this.getAnimationConfig(),i=this._grammarDetector.detect(t,this._graphicMap),r=this._grammarDetector.createPlanners(i,e);this._executePlanners(r,0)}_executePlanners(t,e){if(e>=t.length)return;let i=t[e];i.execute(this._product,()=>{this._executePlanners(t,e+1),"exit"===i.state&&i.graphics.forEach(t=>{t.isExiting&&(this._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release&&t.release())})})}}function Is(){cG(od,In)}let Il=dw},43286:function(t,e,i){"use strict";i.d(e,{vI:()=>_,VO:()=>b});var r=i(21883),n=i.n(r),s=i(19159),l=i(7610),a=i(82904),o=i(12709),h=i(6946),u=i(84148);let d=t=>"object"==typeof t&&null!==t;var c=i(84326);let p=function(t){if(!d(t)||!(0,c.Z)(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function g(t,e,i){var r,n;(void 0===i||(r=t[e],r===(n=i)||Number.isNaN(r)&&Number.isNaN(n)))&&(void 0!==i||e in t)||(t[e]=i)}var f=i(53908),m=i(42769);let y=(t,e)=>{var i,r;if(!(null==e?void 0:e.fields)||0===t.length)return t;let n=e.fields,s=t[0],l={},a=[];for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e)){let o,h=n[e];if(!h.type){let r=s;e in s||(r=null!=(i=t.find(t=>e in t))?i:s),h.type="number"==typeof r[e]?"linear":"ordinal"}if("number"==typeof h.sortIndex&&(o={key:e,type:h.type,index:h.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===h.sortReverse},a.push(o)),(null==(r=h.domain)?void 0:r.length)>0)if("ordinal"===h.type){h._domainCache={},l[e]=h;let t={};h.domain.forEach((e,i)=>{t[e]=i,h._domainCache[e]=i}),o&&(o.sortIndex=t,o.sortIndexCount=h.domain.length)}else h.domain.length>=2&&(l[e]=h)}return Object.keys(l).length>0&&(t=t.filter(t=>{for(let e in l){let i=l[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0})),a.sort((t,e)=>t.index-e.index),t.sort((t,e)=>(function(t,e,i){for(let r=0;r<i.length;r++){let n=i[r],s=0;if("ordinal"===n.type?(void 0===n.sortIndex[e[n.key]]&&(n.sortIndex[e[n.key]]=n.sortIndexCount++),void 0===n.sortIndex[t[n.key]]&&(n.sortIndex[t[n.key]]=n.sortIndexCount++),s=n.sortIndex[t[n.key]]-n.sortIndex[e[n.key]]):"linear"===n.type&&(s=t[n.key]-e[n.key]),n.sortReverse&&(s=-s),0!==s)return s}return 0})(t,e,a)),t},v="_data-view-diff-rank";class b{constructor(t,e){let i;this.dataSet=t,this.options=e,this.isDataView=!0,this.target=new(n()),this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(t={pushHistory:!0,emitMessage:!0})=>(this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(e=>{this.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1}),this.isLastTransform(e)&&this.diffLastData()}),this.isRunning=!1,!1!==t.emitMessage&&this.target.emit("change",[]),this),this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},i=(null==e?void 0:e.name)?e.name:(0,m.F)("dataview"),this.name=i,(null==e?void 0:e.history)&&(this.history=e.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(null==e?void 0:e.fields)}parse(t,e,i=!1){var r;this.isRunning=!0,i&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);let n=this.cloneParseData(t,e);if(null==e?void 0:e.type){let t=(null!=(r=this.dataSet.getParser(e.type))?r:this.dataSet.getParser("bytejson"))(n,e.options,this);this.rawData=n,this.parserData=t,this.history&&this.historyData.push(n,t),this.latestData=t}else this.parserData=n,this.rawData=n,this.history&&this.historyData.push(n),this.latestData=n;return this.isRunning=!1,i&&this.target.emit("afterParse",[]),this}transform(t,e=!0){if(this.isRunning=!0,t&&t.type){let i=!0;if("fields"===t.type){this._fields=t.options.fields;let e=this.transformsArr.findIndex(e=>e.type===t.type);e>=0&&(i=!1,this.transformsArr[e].options.fields=this._fields)}if(i&&this.transformsArr.push(t),e){let e=this.isLastTransform(t);this.executeTransform(t),e&&this.diffLastData()}}return this.sortTransform(),this.isRunning=!1,this}isLastTransform(t){return this.transformsArr[this.transformsArr.length-1]===t}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((t,e)=>{var i,r;return(null!=(i=t.level)?i:0)-(null!=(r=e.level)?r:0)})}executeTransform(t,e={pushHistory:!0,emitMessage:!0}){let{pushHistory:i,emitMessage:r}=e,n=this.dataSet.getTransform(t.type)(this.latestData,t.options);this.history&&!1!==i&&this.historyData.push(n),this.latestData=n,!1!==r&&this.target.emit("change",[])}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}enableDiff(t){this._diffData=!0,this._diffKeys=t,this._diffMap=new Map,this._diffRank=0}disableDiff(){this._diffData=!1,this._diffMap=null,this._diffRank=null}resetDiff(){this._diffMap=new Map,this._diffRank=0}diffLastData(){var t;if(!this._diffData||!this.latestData.forEach||!(null==(t=this._diffKeys)?void 0:t.length))return;let e=this._diffRank+1;if(0===this._diffRank)this.latestData.forEach(t=>{t[v]=e,this._diffMap.set(this._diffKeys.reduce((e,i)=>e+t[i],""),t)}),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else{let t;this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach(i=>{i[v]=e,t=this._diffKeys.reduce((t,e)=>t+i[e],""),this._diffMap.get(t)?this.latestDataAUD.update.push(i):this.latestDataAUD.add.push(i),this._diffMap.set(t,i)}),this._diffMap.forEach((t,i)=>{t[v]<e&&(this.latestDataAUD.del.push(t),this._diffMap.delete(i))})}this._diffRank=e}cloneParseData(t,e){let i=!1;return t instanceof b||!0!==(null==e?void 0:e.clone)||(i=!0),i?function t(e,i,r){let n;if(!(0,u.Z)(e)||"object"!=typeof e||i&&i(e))return e;let d=(0,s.Z)(e),c=e.length;n=d?Array(c):"object"==typeof e?{}:(0,l.Z)(e)||(0,o.Z)(e)||(0,h.Z)(e)?e:(0,a.Z)(e)?new Date(+e):void 0;let p=d?void 0:Object.keys(Object(e)),g=-1;if(n)for(;++g<(p||e).length;){let s=p?p[g]:g,l=e[s];r&&r.includes(s.toString())?n[s]=l:n[s]=t(l,i,r)}return n}(t):t}parseNewData(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}updateRawData(t,e){let i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var t;return this._fields?this._fields:"dataview"===(null==(t=this.parseOption)?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(t,e=!1){this._fields=t&&e?function(t,...e){let i=-1,r=e.length;for(;++i<r;)!function t(e,i,r=!1,n=!1){if(i&&e!==i&&(0,u.Z)(i)&&"object"==typeof i){let l=Object(i),a=[];for(let t in l)a.push(t);let{length:o}=a,h=-1;for(;o--;){let o=a[++h];!(0,u.Z)(l[o])||"object"!=typeof l[o]||n&&(0,s.Z)(e[o])?g(e,o,l[o]):function(e,i,r,n=!1,l=!1){let a=e[r],o=i[r],h=i[r],u=!0;if((0,s.Z)(o)){if(n)h=[];else if((0,s.Z)(a))h=a;else if(null!==a&&"function"!=typeof a&&Number.isFinite(a.length)){h=Array(a.length);let t=-1,e=a.length;for(;++t<e;)h[t]=a[t]}}else p(o)?(h=null!=a?a:{},"function"!=typeof a&&"object"==typeof a||(h={})):u=!1;u&&t(h,o,n,l),g(e,r,h)}(e,i,o,r,n)}}}(t,e[i],!0);return t}({},this._fields,t):t;let i=this.transformsArr.find(t=>"fields"===t.type);!(0,f.Z)(this._fields)&&(0,f.Z)(i)?(this.dataSet.registerTransform("fields",y),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}function _(t){return t instanceof b}},42769:function(t,e,i){"use strict";i.d(e,{F:()=>n});let r=0;function n(t="dataset"){return r>1e8&&(r=0),t+"_"+r++}},88764:function(t,e,i){"use strict";i.d(e,{r:()=>a});var r=i(62722),n=i(40398),s=i(41075),l=i(32190);class a{constructor(t=n.R.GenAutoIncrementId(),e=l.P,i){this.id=t,this.status=s.t.INITIAL,this._timeline=e,e.addAnimate(this),this.slience=i,this._startTime=0,this._duration=0,this._totalDuration=0,this._loopCount=0,this._currentLoop=0,this._bounce=!1,this._firstStep=null,this._lastStep=null,this._startProps={},this._endProps={},this._preventAttrs=new Set,this.currentTime=0,this.interpolateUpdateFunction=null,this.priority=0}getStartProps(){return this._startProps}getEndProps(){return this._endProps}setTimeline(t){this._timeline=t}getTimeline(){return this._timeline}get timeline(){return this._timeline}bind(t){return this.target=t,this.target.animates||(this.target.animates=new Map),this.target.animates.set(this.id,this),this.onRemove(()=>{this.stop(),this.target.animates.delete(this.id)}),this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.target.animationAttribute||(this.target.animationAttribute={}),this}to(t,e=300,i="linear"){let n=new r.h(s.T.to,t,e,i);return n.bind(this.target,this),this.updateStepAfterAppend(n),this}wait(t){let e=new r.o(s.T.wait,{},t,"linear");return e.bind(this.target,this),this.updateStepAfterAppend(e),this}updateStepAfterAppend(t){this._firstStep?this._lastStep.append(t):this._firstStep=t,this._lastStep=t,this.parseStepProps(t),this.updateDuration()}parseStepProps(t){this._lastStep&&(t.propKeys=t.propKeys||Object.keys(t.props),Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=null!=(i=t.props[e])?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}))}reSyncProps(){if(!this._lastStep)return;this._endProps={};let t=this._firstStep;for(;t;)Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=null!=(i=t.props[e])?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}),t=t.next}from(t,e=300,i="linear"){let n=new r.h(s.T.from,t,e,i);return this._firstStep?this._lastStep.append(n):this._firstStep=n,this._lastStep=n,this.updateDuration(),this}play(t){return t.bind(this.target,this),this.updateStepAfterAppend(t),this}pause(){this.status===s.t.RUNNING&&(this.status=s.t.PAUSED)}resume(){this.status===s.t.PAUSED&&(this.status=s.t.RUNNING)}onStart(t){var e;t?(this._onStart||(this._onStart=[]),this._onStart.push(t)):(null==(e=this._onStart)||e.forEach(t=>t()),Object.keys(this._endProps).forEach(t=>{this._startProps[t]=this.target.getComputedAttribute(t)}))}onEnd(t){var e;t?(this._onEnd||(this._onEnd=[]),this._onEnd.push(t)):null==(e=this._onEnd)||e.forEach(t=>t())}onFrame(t){t&&(this._onFrame||(this._onFrame=[]),this._onFrame.push(t))}onRemove(t){var e;t?(this._onRemove||(this._onRemove=[]),this._onRemove.push(t)):null==(e=this._onRemove)||e.forEach(t=>t())}preventAttr(t){this._preventAttrs.add(t),delete this._startProps[t],delete this._endProps[t];let e=this._firstStep;for(;e;)e.deleteSelfAttr(t),e=e.next}preventAttrs(t){t.forEach(t=>this._preventAttrs.add(t))}validAttr(t){return!this._preventAttrs.has(t)}runCb(t){var e;return null==(e=this._lastStep)||e.onEnd(t),this}startAt(t){return this._startTime=t,this}customInterpolate(t,e,i,r,n,s){return!1}getFromValue(){return this._startProps}getToValue(){return this._endProps}stop(t){let e=this._firstStep;for(;e;)e.stop(),e=e.next;this.status!==s.t.END&&this.onEnd(),this.status=s.t.END,this.target&&("start"===t?this.target.setAttributes(this._startProps):"end"===t?this.target.setAttributes(this._endProps):t&&this.target.setAttributes(t))}release(){this.status=s.t.END,this._onRemove&&this._onRemove.forEach(t=>t()),this._onStart=[],this._onFrame=[],this._onEnd=[],this._onRemove=[],this.forEachStep(t=>{t.release()})}getDuration(){return this._duration}getStartTime(){return this._startTime}afterAll(t){if(!t||0===t.length)return this;let e=0;return t.forEach(t=>{let i=t.getStartTime()+t.getTotalDuration();e=Math.max(e,i)}),this.startAt(e)}after(t){if(!t)return this;let e=t.getStartTime()+t.getTotalDuration();return this.startAt(e)}parallel(t){return t&&this.startAt(t.getStartTime()),this}loop(t){return!0===t?t=1/0:!1===t&&(t=0),this._loopCount=t,this.updateDuration(),this}bounce(t){return this._bounce=t,this}advance(t){var e,i,r;if(this.status===s.t.END)return void console.warn("aaa 动画已经结束，不能推进");let n=this.currentTime+t;if(n<this._startTime)return void(this.currentTime=n);if(n>=this._startTime+this._totalDuration)return null==(e=this._lastStep)||e.onUpdate(!0,1,{}),null==(i=this._lastStep)||i.onEnd(),this.onEnd(),void(this.status=s.t.END);this.status=s.t.RUNNING,this.currentTime<=this._startTime&&this.onStart(),this.currentTime=n;let l=n-this._startTime,a=!1,o=!1;if(this._loopCount>0){l=(n-this._startTime)%this._duration;let t=Math.floor((n-this._startTime)/this._duration);a=t>this._currentLoop,this._currentLoop=t,(o=this._bounce&&t%2==1)&&(l=this._duration-l)}a&&!o&&this.target.setAttributes(this._startProps);let h=null;if(this._lastStep===this._firstStep)h=this._firstStep;else{let t=this._firstStep;for(;t;){let e=t.getStartTime(),i=t.getDuration();if(l>=e&&l<=e+i){h=t;break}t=t.next}}if(!h)return;h!==this.lastRunStep&&(null==(r=this.lastRunStep)||r.onEnd()),this.lastRunStep=h;let u=(l-h.getStartTime())/h.getDuration(),d=u>=1;h.update(d,u,{}),d&&(h.onEnd(),this.lastRunStep=null)}updateDuration(){this._lastStep?(this._duration=this._lastStep.getStartTime()+this._lastStep.getDuration(),this._totalDuration=this._duration*(this._loopCount+1)):this._duration=0}getTotalDuration(){return this._totalDuration}getLoop(){return this._loopCount}forEachStep(t){let e=this._firstStep;for(;e;)t(e),e=e.next}}},3793:function(t,e,i){"use strict";i.d(e,{L:()=>s});var r=i(92851);class n{constructor(t){this.tasks=[],this.started=!1,this.completed=0,this.totalDuration=0,this.onStartCallbacks=[],this.onEndCallbacks=[],this.onUpdateCallbacks=[],this.component=t}animate(t,e){return this.started?console.warn("Cannot add animations after animation has started"):this.tasks.push({graphic:t,config:e}),this}onStart(t){return this.onStartCallbacks.push(t),this}onEnd(t){return this.onEndCallbacks.push(t),this}onUpdate(t){return this.onUpdateCallbacks.push(t),this}start(){return this.started?console.warn("Animation has already started"):(this.started=!0,this.completed=0,this.onStartCallbacks.forEach(t=>t()),0===this.tasks.length?setTimeout(()=>{this.onEndCallbacks.forEach(t=>t())},0):this.tasks.forEach(t=>{let e=new r.a(t.graphic);e.onEnd(()=>{this.completed++,this.completed===this.tasks.length&&this.onEndCallbacks.forEach(t=>t())});let i=e.executeItem(t.config,t.graphic);t.animate=i,i.forEach(t=>{this.totalDuration=Math.max(this.totalDuration,t.getStartTime()+t.getDuration())})})),this}deleteSelfAttr(t){this.tasks.forEach(e=>{e.animate&&e.animate.forEach(e=>e.preventAttr(t))})}stop(t){return this.tasks.forEach(e=>{e.animate&&e.animate.forEach(e=>e.stop(t))}),this.started&&this.completed!==this.tasks.length&&(this.onEndCallbacks.forEach(t=>t()),this.completed=this.tasks.length),this}getDuration(){return this.totalDuration}}function s(t){return new n(t)}},12839:function(t,e,i){"use strict";i.d(e,{b:()=>n,v:()=>s});var r=i(90767);class n extends r.W{constructor(t,e,i,r,n){super(t,e,i,r,n),this.keys=["clipRange"],this.from={clipRange:0}}onFirstRun(){var t;super.onFirstRun();let{clipDimension:e}=(null==(t=this.params)?void 0:t.options)||{};e&&(this.target.attribute.clipRangeByDimension=e)}}class s extends r.U{constructor(t,e,i,r,n){super(t,e,i,r,n),this.keys=["clipRange"]}}},90767:function(t,e,i){"use strict";i.d(e,{U:()=>s,W:()=>n});var r=i(43682);class n extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i;super.onBind();let r=this.target.getFinalAttribute(),n=null!=(t=this.target.attribute)?t:{},s={},l=null!=(e=this.from)?e:{};this.keys.forEach(t=>{var e,i,a;s[t]=null!=(e=null==r?void 0:r[t])?e:1,l[t]=null!=(a=null!=(i=l[t])?i:n[t])?a:0});let a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),this.props=s,this.propKeys=this.keys,this.from=l,this.to=s,!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(l)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class s extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){super.onBind();let t=this.target.attribute,e={},i={};this.keys.forEach(r=>{var n;e[r]=0,i[r]=null!=(n=t[r])?n:1}),this.props=e,this.propKeys=this.keys,this.from=i,this.to=e,Object.assign(this.target.attribute,i),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}},43682:function(t,e,i){"use strict";i.d(e,{Or:()=>s,_j:()=>l,rd:()=>n});var r=i(62722);class n extends r.h{constructor(t,e,i,r,n){super("customAnimate",e,i,r),this.type="customAnimate",this.customFrom=t,this.params=n,this.from=t,this.to=e}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.onUpdate(t,r,i),this.syncAttributeUpdate()}setProps(t){this.props=t,this.propKeys=Object.keys(t),this.animate.reSyncProps()}}class s extends n{completeBind(t){this.setStartTime(0),this._animator&&this._animator.start(),this.setDuration(t.getDuration())}stop(){this._animator&&this._animator.stop()}}class l extends n{constructor(t,e,i,r,n){super(t,e,i,r,n),this.willCallBeforeStageRender=!0,this.willCallAfterStageRender=!0,this._beforeStageRender=()=>{if(!this.willCallBeforeStageRender)return;this.willCallBeforeStageRender=!1;let t=this.target.stage,e=t.window.getContext().canvas.nativeCanvas,i=this.beforeStageRender(t,e);i&&this.renderToStage(t,i)},this._afterStageRender=()=>{if(!this.willCallAfterStageRender)return;this.willCallAfterStageRender=!1;let t=this.target.stage,e=t.window.getContext().canvas.nativeCanvas,i=this.afterStageRender(t,e);i&&this.renderToStage(t,i)},this.props={}}beforeStageRender(t,e){return!1}afterStageRender(t,e){return!1}onFirstRun(){super.onFirstRun(),this.target.stage.setBeforeRender(this._beforeStageRender),this.target.stage.setAfterRender(this._afterStageRender),this.target.stage.disableDirtyBounds()}stop(){super.stop(),this.target.stage.removeBeforeRender(this._beforeStageRender),this.target.stage.removeAfterRender(this._afterStageRender)}onUpdate(t,e,i){super.onUpdate(t,e,i),this.willCallBeforeStageRender=!0,this.willCallAfterStageRender=!0}renderToStage(t,e){let i=t.window.getContext().canvas.nativeCanvas,r=i.getContext("2d");return!!r&&(r.clearRect(0,0,i.width,i.height),r.drawImage(e,0,0),i)}}},44785:function(t,e,i){"use strict";i.d(e,{D:()=>s,U:()=>n});var r=i(90767);class n extends r.W{constructor(t,e,i,r,n){super(t,e,i,r,n),this.keys=["opacity","fillOpacity","strokeOpacity"],this.from={opacity:0,fillOpacity:0,strokeOpacity:0}}}class s extends r.U{constructor(t,e,i,r,n){super(t,e,i,r,n),this.keys=["opacity","fillOpacity","strokeOpacity"]}}},86946:function(t,e,i){"use strict";i.d(e,{$:()=>n});var r=i(43682);class n extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.from=null!=t?t:{}}onBind(){var t,e;super.onBind(),Object.keys(this.from).forEach(t=>{null==this.props[t]&&(this.props[t]=this.target.getGraphicAttribute(t))});let i=this.target.getFinalAttribute();"appear"===(null==(t=this.target.context)?void 0:t.animationState)&&i&&this.target.setAttributes(i),!1!==(null==(e=this.params.controlOptions)?void 0:e.immediatelyApply)&&this.target.setAttributes(this.from)}onFirstRun(){this.from=Object.assign(Object.assign({},this.getLastProps()),this.from);let t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.from[e]=null!=(i=this.from[e])?i:t[e]}),this.target.setAttributes(this.from)}deleteSelfAttr(t){super.deleteSelfAttr(t),delete this.from[t]}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.from,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.from[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}},888:function(t,e,i){"use strict";i.d(e,{j2:()=>c,kj:()=>d});var r=i(43682),n=i(45273);let s=(t,e,i)=>{let r=t.getFinalAttribute();return e&&"anticlockwise"===e.orient?{from:{startAngle:null==r?void 0:r.endAngle},to:{startAngle:null==r?void 0:r.startAngle}}:{from:{endAngle:null==r?void 0:r.startAngle},to:{endAngle:null==r?void 0:r.endAngle}}},l=(t,e,i)=>{let r=t.getFinalAttribute();if(e&&"anticlockwise"===e.orient){let t=(0,n.Z)(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:t,endAngle:t},to:{startAngle:null==r?void 0:r.startAngle,endAngle:null==r?void 0:r.endAngle}}}let s=(0,n.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:s,endAngle:s},to:{startAngle:null==r?void 0:r.startAngle,endAngle:null==r?void 0:r.endAngle}}},a=(t,e,i)=>{var r;return!1!==(null!=(r=null==e?void 0:e.overall)&&r)?l(t,e):s(t,e)},o=(t,e,i)=>{let r=t.attribute;return e&&"anticlockwise"===e.orient?{from:{startAngle:r.startAngle},to:{startAngle:null==r?void 0:r.endAngle}}:{from:{endAngle:r.endAngle},to:{endAngle:null==r?void 0:r.startAngle}}},h=(t,e,i)=>{let r=t.attribute;if(e&&"anticlockwise"===e.orient){let t=(0,n.Z)(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:r.startAngle,endAngle:r.endAngle},to:{startAngle:t,endAngle:t}}}let s=(0,n.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:r.startAngle,endAngle:r.endAngle},to:{startAngle:s,endAngle:s}}};class u extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}determineUpdateFunction(){this.propKeys?this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this.valid=!1:this.valid=!1}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];let e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this._updateFunction=null}updateStartAngle(t){this.target.attribute.startAngle=this.from.startAngle+(this.to.startAngle-this.from.startAngle)*t}updateEndAngle(t){this.target.attribute.endAngle=this.from.endAngle+(this.to.endAngle-this.from.endAngle)*t}updateAngle(t){this.updateStartAngle(t),this.updateEndAngle(t)}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdateShapeAndBoundsTag())}}class d extends u{onBind(){var t,e,i;super.onBind();let{from:r,to:n}=a(this.target,this.params.options,this.params),s=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=s,this.to=n;let l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(s),this.determineUpdateFunction()}}class c extends u{onBind(){var t,e,i;super.onBind();let{from:r,to:n}=(t=this.target,e=this.params.options,this.params,!1!==(null!=(i=null==e?void 0:e.overall)&&i)?h(t,e):o(t,e));this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=null!=r?r:this.target.attribute,this.to=n,this.determineUpdateFunction()}}},85673:function(t,e,i){"use strict";i.d(e,{B:()=>o,W:()=>a});var r=i(21777),n=i(43682);let s=(t,e,i)=>{let n=t.getFinalAttribute();switch(null==e?void 0:e.direction){case"x":{let t=n.x,e=n.x1,i=n.width;return{from:(0,r.Z)(i)?{x:t+i/2,x1:void 0,width:0}:{x:(t+e)/2,x1:(t+e)/2,width:void 0},to:{x:t,x1:e,width:i}}}case"y":{let t=n.y,e=n.y1,i=n.height;return{from:(0,r.Z)(i)?{y:t+i/2,y1:void 0,height:0}:{y:(t+e)/2,y1:(t+e)/2,height:void 0},to:{y:t,y1:e,height:i}}}default:{let t=n.x,e=n.x1,i=n.width,s=n.y,l=n.y1,a=n.height,o={};return(0,r.Z)(i)?(o.x=t+i/2,o.width=0,o.x1=void 0):(o.x=(t+e)/2,o.x1=(t+e)/2,o.width=void 0),(0,r.Z)(a)?(o.y=s+a/2,o.height=0,o.y1=void 0):(o.y=(s+l)/2,o.y1=(s+l)/2,o.height=void 0),{from:o,to:{x:t,y:s,x1:e,y1:l,width:i,height:a}}}}},l=(t,e,i)=>{let n=t.attribute;switch(null==e?void 0:e.direction){case"x":{let t=n.x,e=n.x1,i=n.width;return{to:(0,r.Z)(i)?{x:t+i/2,x1:void 0,width:0}:{x:(t+e)/2,x1:(t+e)/2,width:void 0}}}case"y":{let t=n.y,e=n.y1,i=n.height;return{to:(0,r.Z)(i)?{y:t+i/2,y1:void 0,height:0}:{y:(t+e)/2,y1:(t+e)/2,height:void 0}}}default:{let t=n.x,e=n.y,i=n.x1,s=n.y1,l=n.width,a=n.height,o={};return(0,r.Z)(l)?(o.x=t+l/2,o.width=0,o.x1=void 0):(o.x=(t+i)/2,o.x1=(t+i)/2,o.width=void 0),(0,r.Z)(a)?(o.y=e+a/2,o.height=0,o.y1=void 0):(o.y=(e+s)/2,o.y1=(e+s)/2,o.height=void 0),{to:o}}}};class a extends n.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i;super.onBind();let{from:r,to:n}=s(this.target,this.params.options,this.params),l=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=l,this.to=n;let a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(l)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class o extends n.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){super.onBind();let{from:t,to:e}=l(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(t=>null!=e[t]),this.from=null!=t?t:this.target.attribute,this.to=e}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}},36376:function(t,e,i){"use strict";i.d(e,{HQ:()=>o,qG:()=>h});var r=i(21777),n=i(35652),s=i(45273),l=i(43682);let a=(t,e,i)=>{var l;return!1!==(null!=(l=null==e?void 0:e.overall)&&l)?function(t,e,i){var r,l,a;let o,h=t.getFinalAttribute(),u=h.y,d=h.y1,c=h.height;return e&&"negative"===e.orient?(0,s.Z)(e.overall)?o=e.overall:i.group?(o=null!=(a=null!=(r=i.groupHeight)?r:null==(l=e.layoutRect)?void 0:l.height)?a:i.group.getBounds().height(),i.groupHeight=o):o=i.height:o=(0,s.Z)(null==e?void 0:e.overall)?e.overall:0,{from:{y:o,y1:(0,n.Z)(d)?void 0:o,height:(0,n.Z)(c)?void 0:0},to:{y:u,y1:d,height:c}}}(t,e,i):function(t,e,i){let s=t.getFinalAttribute(),l=s.y,a=s.y1,o=s.height;if(e&&"negative"===e.orient){let t=(0,r.Z)(o)?Math.max(l,l+o):Math.max(l,a);return{from:{y:t,y1:(0,n.Z)(a)?void 0:t,height:(0,n.Z)(o)?void 0:0},to:{y:l,y1:a,height:o}}}let h=(0,r.Z)(o)?Math.min(l,l+o):Math.min(l,a);return{from:{y:h,y1:(0,n.Z)(a)?void 0:h,height:(0,n.Z)(o)?void 0:0},to:{y:l,y1:a,height:o}}}(t,e,0)};class o extends l.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i;super.onBind();let{from:r,to:n}=a(this.target,this.params.options,this.params),s=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=s,this.to=n;let l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(s)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class h extends l.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,l;super.onBind();let{from:a,to:o}=(t=this.target,e=this.params.options,i=this.params,!1!==(null!=(l=null==e?void 0:e.overall)&&l)?function(t,e,i){var r,l,a;let o,h=t.getFinalAttribute(),u=h.y1,d=h.height;return e&&"negative"===e.orient?(0,s.Z)(e.overall)?o=e.overall:i.group?(o=null!=(a=null!=(r=i.groupHeight)?r:null==(l=e.layoutRect)?void 0:l.height)?a:i.group.getBounds().height(),i.groupHeight=o):o=i.height:o=(0,s.Z)(null==e?void 0:e.overall)?e.overall:0,{to:{y:o,y1:(0,n.Z)(u)?void 0:o,height:(0,n.Z)(d)?void 0:0}}}(t,e,i):function(t,e,i){let s=t.getFinalAttribute(),l=s.y,a=s.y1,o=s.height;if(e&&"negative"===e.orient){let t=(0,r.Z)(o)?Math.max(l,l+o):Math.max(l,a);return{to:{y:t,y1:(0,n.Z)(a)?void 0:t,height:(0,n.Z)(o)?void 0:0}}}let h=(0,r.Z)(o)?Math.min(l,l+o):Math.min(l,a);return{to:{y:h,y1:(0,n.Z)(a)?void 0:h,height:(0,n.Z)(o)?void 0:0}}}(t,e,0));this.props=o,this.propKeys=Object.keys(o).filter(t=>null!=o[t]),this.from=null!=a?a:this.target.attribute,this.to=o}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}},1977:function(t,e,i){"use strict";i.d(e,{$m:()=>g,Kk:()=>h,Yf:()=>u,rf:()=>v,xJ:()=>p,yQ:()=>y});var r=i(70749),n=i(70501),s=i(43682);let l=(t,e,i)=>{let r=t.getFinalAttribute().points,s={x:0,y:0};return r.forEach(t=>{s.x+=t.x,s.y+=t.y}),s.x/=r.length,s.y/=r.length,e&&e.center&&((0,n.Z)(e.center.x)&&(s.x=e.center.x),(0,n.Z)(e.center.y)&&(s.y=e.center.y)),"area"===t.type&&(s.x1=s.x,s.y1=s.y),r.map(t=>Object.assign({},t,s))},a=(t,e,i)=>{let r=t.getFinalAttribute();return{from:{points:l(t,e)},to:{points:r.points}}};class o extends s.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onUpdate(t,e,i){var n,s;let l=null==(n=this.from)?void 0:n.points,a=null==(s=this.to)?void 0:s.points;l&&a&&(this.target.attribute.points=l.map((t,i)=>(0,r.q9)(l[i],a[i],e)),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag())}}class h extends o{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:e,to:i}=a(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}else this.valid=!1}}class u extends o{onBind(){var t,e;if(super.onBind(),["area","line"].includes(this.target.type)){let i=this.target.getFinalAttribute(),{from:r,to:n}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:l(t,e)}});this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=r||i,this.to=n}else this.valid=!1}}let d=(t,e,i)=>t.getFinalAttribute().points.map(i=>{if(e&&"negative"===e.orient){let e=t.stage.viewWidth;return t.parent.parent.parent&&(e=t.parent.parent.parent.AABBBounds.width()),Object.assign(Object.assign({},i),{x:e,y:i.y,x1:e,y1:i.y1,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:0,y:i.y,x1:0,y1:i.y1,defined:!1!==i.defined})}),c=(t,e,i)=>{let r=t.getFinalAttribute();return{from:{points:d(t,e)},to:{points:r.points}}};class p extends o{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:e,to:i}=c(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}else this.valid=!1}}class g extends o{onBind(){var t,e;if(super.onBind(),["area","line"].includes(this.target.type)){let i=this.target.getFinalAttribute(),{from:r,to:n}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:d(t,e)}});this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=r||i,this.to=n}else this.valid=!1}}let f=(t,e,i)=>t.getFinalAttribute().points.map(i=>{if(e&&"negative"===e.orient){let e=t.stage.viewHeight;return t.parent.parent.parent&&(e=t.parent.parent.parent.AABBBounds.height()),Object.assign(Object.assign({},i),{x:i.x,y:e,x1:i.x1,y1:e,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:i.x,y:0,x1:i.x1,y1:0,defined:!1!==i.defined})}),m=(t,e,i)=>{let r=t.getFinalAttribute();return{from:{points:f(t,e)},to:{points:r.points}}};class y extends o{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:e,to:i}=m(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}else this.valid=!1}}class v extends o{onBind(){var t,e;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:i,to:r}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:f(t,e)}});this.props=r,this.propKeys=Object.keys(r).filter(t=>null!=r[t]),this.from=null!=i?i:this.target.attribute,this.to=r}else this.valid=!1}}},93735:function(t,e,i){"use strict";i.d(e,{$:()=>d,em:()=>c});var r=i(43682),n=i(45273);let s=(t,e,i)=>{let r=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==r?void 0:r.outerRadius},to:{innerRadius:null==r?void 0:r.innerRadius}}:{from:{outerRadius:null==r?void 0:r.innerRadius},to:{outerRadius:null==r?void 0:r.outerRadius}}},l=(t,e,i)=>{let r=t.getFinalAttribute(),s=(0,n.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:s,outerRadius:s},to:{innerRadius:null==r?void 0:r.innerRadius,outerRadius:null==r?void 0:r.outerRadius}}},a=(t,e,i)=>{var r;return!1!==(null!=(r=null==e?void 0:e.overall)&&r)?l(t,e):s(t,e)},o=(t,e,i)=>{let r=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==r?void 0:r.innerRadius},to:{innerRadius:null==r?void 0:r.outerRadius}}:{from:{outerRadius:null==r?void 0:r.outerRadius},to:{outerRadius:null==r?void 0:r.innerRadius}}},h=(t,e,i)=>{let r=t.getFinalAttribute(),s=(0,n.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:null==r?void 0:r.innerRadius,outerRadius:null==r?void 0:r.outerRadius},to:{innerRadius:s,outerRadius:s}}};class u extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class d extends u{onBind(){var t,e,i;super.onBind();let{from:r,to:n}=a(this.target,this.params.options,this.params),s=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=s,this.to=n;let l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(s)}}class c extends u{onBind(){var t,e,i;super.onBind();let{to:r}=(t=this.target,e=this.params.options,this.params,!1!==(null!=(i=null==e?void 0:e.overall)&&i)?h(t,e):o(t,e));this.props=r,this.propKeys=Object.keys(r).filter(t=>null!=r[t]),this.from=this.target.attribute,this.to=r}}},81887:function(t,e,i){"use strict";i.d(e,{dR:()=>o,yi:()=>h});var r=i(21777),n=i(35652),s=i(45273),l=i(43682);let a=(t,e,i)=>{var l;return!1!==(null!=(l=null==e?void 0:e.overall)&&l)?function(t,e,i){var r;let l,a=t.getFinalAttribute(),o=a.x,h=a.x1,u=a.width;return e&&"negative"===e.orient?(0,s.Z)(e.overall)?l=e.overall:i.group?(l=null!=(r=i.groupWidth)?r:i.group.getBounds().width(),i.groupWidth=l):l=i.width:l=(0,s.Z)(null==e?void 0:e.overall)?null==e?void 0:e.overall:0,{from:{x:l,x1:(0,n.Z)(h)?void 0:l,width:(0,n.Z)(u)?void 0:0},to:{x:o,x1:h,width:u}}}(t,e,i):function(t,e,i){let s=t.getFinalAttribute(),l=s.x,a=s.x1,o=s.width;if(e&&"negative"===e.orient){let t=(0,r.Z)(o)?Math.max(l,l+o):Math.max(l,a);return{from:{x:t,x1:(0,n.Z)(a)?void 0:t,width:(0,n.Z)(o)?void 0:0},to:{x:l,x1:a,width:o}}}let h=(0,r.Z)(o)?Math.min(l,l+o):Math.min(l,a);return{from:{x:h,x1:(0,n.Z)(a)?void 0:h,width:(0,n.Z)(o)?void 0:0},to:{x:l,x1:a,width:o}}}(t,e,0)};class o extends l.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i;super.onBind();let{from:r,to:n}=a(this.target,this.params.options,this.params),s=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=s,this.to=n;let l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(s)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class h extends l.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,l;super.onBind();let{from:a,to:o}=(t=this.target,e=this.params.options,i=this.params,!1!==(null!=(l=null==e?void 0:e.overall)&&l)?function(t,e,i){var r;let l,a=t.getFinalAttribute(),o=a.x1,h=a.width;return e&&"negative"===e.orient?(0,s.Z)(e.overall)?l=e.overall:i.group?(l=null!=(r=i.groupWidth)?r:i.group.getBounds().width(),i.groupWidth=l):l=i.width:l=(0,s.Z)(null==e?void 0:e.overall)?e.overall:0,{to:{x:l,x1:(0,n.Z)(o)?void 0:l,width:(0,n.Z)(h)?void 0:0}}}(t,e,i):function(t,e,i){let s=t.getFinalAttribute(),l=s.x,a=s.x1,o=s.width;if(e&&"negative"===e.orient){let t=(0,r.Z)(o)?Math.max(l,l+o):Math.max(l,a);return{to:{x:t,x1:(0,n.Z)(a)?void 0:t,width:(0,n.Z)(o)?void 0:0}}}let h=(0,r.Z)(o)?Math.min(l,l+o):Math.min(l,a);return{to:{x:h,x1:(0,n.Z)(a)?void 0:h,width:(0,n.Z)(o)?void 0:0}}}(t,e,0));this.props=o,this.propKeys=Object.keys(o).filter(t=>null!=o[t]),this.from=null!=a?a:this.target.attribute,this.to=o}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}},29562:function(t,e,i){"use strict";i.d(e,{V8:()=>h,vW:()=>u});var r=i(98116),n=i(70501),s=i(43682);let l=(t,e,i)=>{var s,l,a,o;let{offset:h=0,orient:u,direction:d,point:c,excludeChannels:p=[],layoutRect:g={}}=null!=e?e:{},f=0,m=0;"negative"===u&&(f=null!=(s=g.width)?s:t.stage.viewWidth,m=null!=(l=g.height)?l:t.stage.viewHeight),f+=h,m+=h;let y=(0,r.Z)(c)?c.call(null,null==(o=null==(a=t.context)?void 0:a.data)?void 0:o[0],t,i):c,v=t.getGraphicAttribute("x"),b=t.getGraphicAttribute("y"),_=p.includes("x")?v:y&&(0,n.Z)(y.x)?y.x:f,x=p.includes("y")?b:y&&(0,n.Z)(y.y)?y.y:m;switch(d){case"x":return{from:{x:p.includes("x")?v:_},to:{x:v}};case"y":return{from:{y:x},to:{y:b}};default:return{from:{x:_,y:x},to:{x:v,y:b}}}},a=(t,e,i)=>{var s,l,a,o;let{offset:h=0,orient:u,direction:d,point:c}=null!=e?e:{},p=i.group?i.group.AABBBounds:null,g=null!=(s=p.width())?s:i.width,f=null!=(l=p.height())?l:i.height,m=(0,r.Z)(c)?c.call(null,null==(o=null==(a=t.context)?void 0:a.data)?void 0:o[0],t,i):c,y=m&&(0,n.Z)(m.x)?m.x:("negative"===u?g:0)+h,v=m&&(0,n.Z)(m.y)?m.y:("negative"===u?f:0)+h;switch(d){case"x":return{from:{x:t.getGraphicAttribute("x")},to:{x:y}};case"y":return{from:{y:t.getGraphicAttribute("y")},to:{y:v}};default:return{from:{x:t.getGraphicAttribute("x"),y:t.getGraphicAttribute("y")},to:{x:y,y:v}}}};class o extends s.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class h extends o{onBind(){var t;super.onBind();let{from:e,to:i}=l(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}}class u extends o{onBind(){super.onBind();let{from:t,to:e}=a(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(t=>null!=e[t]),this.from=t,this.to=e}}},18101:function(t,e,i){"use strict";i.d(e,{B:()=>n});var r=i(43682);class n extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.formatTemplate=null,this.decimalLength=null==n?void 0:n.decimalLength,(null==n?void 0:n.formatTemplate)&&n.formatTemplate.includes("{{var}}")&&(this.formatTemplate=n.formatTemplate)}onFirstRun(){var t,e,i;let r=this.getLastProps(),n=this.getEndProps(),s=null!=(t=r.text)?t:0,l=null!=(e=n.text)?e:0;this.valid=!0;let a=0,o=0,h="",u="",d=0;if("number"==typeof s)a=s,d=Math.max(d,(s.toString().split(".")[1]||"").length);else{if("string"!=typeof s)return void(this.valid=!1);if(s.endsWith("%")){h="%";let t=s.substring(0,s.length-1).replace(/,/g,"");if(isNaN(a=parseFloat(t)/100))return void(this.valid=!1);d=Math.max(d,(t.split(".")[1]||"").length+2)}else{let t=s.replace(/,/g,"");if(isNaN(a=parseFloat(t)))return void(this.valid=!1);s.includes(",")&&(h=","),d=Math.max(d,(t.split(".")[1]||"").length)}}if("number"==typeof l)o=l,d=Math.max(d,(l.toString().split(".")[1]||"").length);else{if("string"!=typeof l)return void(this.valid=!1);if(l.endsWith("%")){u="%";let t=l.substring(0,l.length-1).replace(/,/g,"");if(isNaN(o=parseFloat(t)/100))return void(this.valid=!1);d=Math.max(d,(t.split(".")[1]||"").length+2)}else{let t=l.replace(/,/g,"");if(isNaN(o=parseFloat(t)))return void(this.valid=!1);l.includes(",")&&(u=","),d=Math.max(d,(t.split(".")[1]||"").length)}}if(null==(i=this.params)?void 0:i.format){switch(this.params.format){case"percent":this.format="%";break;case"thousandth":this.format=",";break;case"none":this.format="";break;default:this.format=u||h}"%"===this.format&&"%"!==u&&"%"!==h&&void 0===this.decimalLength&&(this.decimalLength=2),"%"===this.format||"%"!==u&&"%"!==h||(a*=100,o*=100)}else this.format=u||h;this.fromNumber=a,this.toNumber=o,void 0===this.decimalLength&&(this.decimalLength=d)}onEnd(t){super.onEnd(t),t||this.props&&this.target.setAttributes(this.props)}onUpdate(t,e,i){if(!this.valid)return;let r=this.fromNumber+(this.toNumber-this.fromNumber)*e,n="",s=this.format,l=("%"===s?100*r:r).toFixed(this.decimalLength),a,o=l;if(parseFloat(l)===Math.floor(parseFloat(l))&&(o=Math.floor(parseFloat(l))),"%"===s)a=`${o}%`;else if(","===s){let t=o.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),a=t.join(".")}else a=o;n=this.formatTemplate?this.formatTemplate.replace("{{var}}",a.toString()):a,this.target.setAttribute("text",n)}}},93431:function(t,e,i){"use strict";i.d(e,{Hp:()=>ta});var r=i(92851),n=i(12839),s=i(44785),l=i(888),a=i(85673),o=i(36376),h=i(1977),u=i(93735),d=i(81887),c=i(43682);class p extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromText="",this.toText="",this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",void 0!==(null==n?void 0:n.showCursor)&&(this.showCursor=n.showCursor),void 0!==(null==n?void 0:n.cursorChar)&&(this.cursorChar=n.cursorChar),void 0!==(null==n?void 0:n.blinkCursor)&&(this.blinkCursor=n.blinkCursor),void 0!==(null==n?void 0:n.beforeText)&&(this.beforeText=n.beforeText),void 0!==(null==n?void 0:n.afterText)&&(this.afterText=n.afterText)}onFirstRun(){var t,e;let i=this.getLastProps(),r=this.getEndProps(),n=null!=(t=i.text)?t:"",s=null!=(e=r.text)?e:"";this.valid=!0,this.fromText=n.toString(),this.toText=s.toString(),this.toText||""===this.toText||(this.valid=!1)}onEnd(t){super.onEnd(t),t||(this.showCursor&&!this.blinkCursor?this.target.setAttribute("text",this.beforeText+this.toText+this.cursorChar+this.afterText):this.target.setAttribute("text",this.beforeText+this.toText+this.afterText))}onUpdate(t,e,i){let r,n;if(!this.valid)return;let s=this.toText.length,l=this.fromText.length;l>s?(r=Math.round(l-(l-s)*e),n=this.fromText.substring(0,r)):(r=Math.round(l+(s-l)*e),n=this.toText.startsWith(this.fromText)?this.toText.substring(0,r):r<=l?this.fromText.substring(0,r):this.toText.substring(0,r-l+Math.min(l,r)));let a=this.beforeText+n+this.afterText;this.showCursor&&(this.blinkCursor?Math.floor(e/.1)%2==0&&(a=this.beforeText+n+this.cursorChar+this.afterText):a=this.beforeText+n+this.cursorChar+this.afterText),this.target.setAttribute("text",a)}}var g=i(3793);class f extends c.Or{onBind(){let t,e;super.onBind();let i=(0,g.L)(this.target);this._animator=i;let r=this.duration,n=this.easing,s=this.target,{symbolStartOuterType:l="scale",titleType:a="typewriter",titlePanelType:o="scale"}=this.params,h=r/10;if(s._symbolStart.setAttributes({scaleX:0,scaleY:0}),i.animate(s._symbolStart,{type:"to",to:{scaleX:1,scaleY:1},duration:5*h,easing:n}),"scale"===l?(t={scaleX:0,scaleY:0},e={scaleX:1,scaleY:1}):(t={clipRange:0},e={clipRange:1}),s._symbolStartOuter.setAttributes(t),i.animate(s._symbolStartOuter,{type:"to",to:e,duration:5*h,easing:n}),s._symbolEnd.setAttributes({scaleX:0,scaleY:0}),i.animate(s._symbolEnd,{type:"to",to:{scaleX:1,scaleY:1},duration:2*h,delay:8*h,easing:n}),s._line.setAttributes({clipRange:0}),i.animate(s._line,{type:"to",to:{clipRange:1},duration:9*h,easing:n}),"typewriter"===a){let t=s._titleTop.attribute.text;s._titleTop.setAttributes({text:""}),i.animate(s._titleTop,{type:"custom",delay:5*h,duration:4*h,easing:"linear",to:{text:t},custom:p});let e=s._titleBottom.attribute.text;s._titleBottom.setAttributes({text:""}),i.animate(s._titleBottom,{type:"custom",delay:5*h,duration:4*h,easing:"linear",to:{text:e},custom:p})}else s._titleTop.setAttributes({dy:s._titleTop.AABBBounds.height()+10}),i.animate(s._titleTop,{type:"to",to:{dy:0},delay:5*h,duration:4*h,easing:"linear"}),s._titleBottom.setAttributes({dy:-(10+s._titleBottom.AABBBounds.height())}),i.animate(s._titleBottom,{type:"to",to:{dy:0},delay:5*h,duration:4*h,easing:"linear"});"scale"===o?[s._titleTopPanel,s._titleBottomPanel].forEach(t=>{var e;let s=null!=(e=t.attribute.scaleX)?e:1;t.setAttributes({scaleX:0}),i.animate(t,{type:"to",to:{scaleX:s},duration:r,easing:n})}):"stroke"===o&&[s._titleTopPanel,s._titleBottomPanel].forEach(t=>{let e=t.AABBBounds,s=2*(e.width()+e.height());t.setAttributes({lineDash:[0,10*s]}),i.animate(t,{type:"to",to:{lineDash:[s,10*s]},duration:r,easing:n})}),this.completeBind(i)}}class m extends c.Or{onBind(){super.onBind();let t=(0,g.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,r=this.target,{mode:n}=this.params;"scale"===n?t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}):(t.animate(r._line,{type:"to",to:{clipRange:0},duration:e,easing:i}),t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._symbolEnd,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),t.animate(r._titleTop,{type:"to",to:{dy:r._titleTop.AABBBounds.height()+10},duration:e/2,easing:i}),t.animate(r._titleBottom,{type:"to",to:{dy:-(10+r._titleBottom.AABBBounds.height())},duration:e/2,easing:i}),t.animate(r._symbolStartOuter,{type:"to",to:{clipRange:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._titleTopPanel,{type:"to",to:{scaleX:0},duration:e,easing:i}),t.animate(r._titleBottomPanel,{type:"to",to:{scaleX:0},duration:e,easing:i})),this.completeBind(t)}}var y=i(18101);class v extends c.Or{onBind(){super.onBind();let t=(0,g.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,r=this.target,{wave:n}=this.params;if(r.setAttributes({scaleX:0,scaleY:0}),t.animate(r,{type:"to",to:{scaleX:1,scaleY:1},duration:e/3*2,easing:i}),r.titleShape&&t.animate(r.titleShape,{type:"custom",to:{text:r.titleShape.attribute.text},duration:e,easing:i,custom:p}),r.contentShape&&t.animate(r.contentShape,{type:"custom",to:{text:r.contentShape.attribute.text},duration:e,easing:i,custom:p}),n){let s=e/6;t.animate(r.group,{timeSlices:[{duration:s,effects:{type:"to",to:{angle:n},easing:i}},{duration:2*s,effects:{type:"to",to:{angle:-n},easing:i}},{duration:2*s,effects:{type:"to",to:{angle:n},easing:i}},{duration:s,effects:{type:"to",to:{angle:0},easing:i}}]})}this.completeBind(t)}}class b extends c.Or{onBind(){super.onBind();let t=(0,g.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,r=this.target;t.animate(r,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),this.completeBind(t)}}var _=i(29559);class x extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.fadeInChars=!1,this.fadeInDuration=.3,this.strokeFirst=!1,this.strokeToFillRatio=.3,void 0!==(null==n?void 0:n.showCursor)&&(this.showCursor=n.showCursor),void 0!==(null==n?void 0:n.cursorChar)&&(this.cursorChar=n.cursorChar),void 0!==(null==n?void 0:n.blinkCursor)&&(this.blinkCursor=n.blinkCursor),void 0!==(null==n?void 0:n.fadeInChars)&&(this.fadeInChars=n.fadeInChars),void 0!==(null==n?void 0:n.fadeInDuration)&&(this.fadeInDuration=n.fadeInDuration),void 0!==(null==n?void 0:n.strokeFirst)&&(this.strokeFirst=n.strokeFirst),void 0!==(null==n?void 0:n.strokeToFillRatio)&&(this.strokeToFillRatio=n.strokeToFillRatio)}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?_.H.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=_.H.TransformTextConfig2SingleCharacter(this.originalTextConfig)):this.valid=!1}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){let r,n;if(!this.valid)return;let s=this.toTextConfig.length,l=this.fromTextConfig.length,a=this.fadeInChars?1-this.fadeInDuration:1;if(r=l>s?Math.round(l-(l-s)*e):this.fadeInChars?Math.round(l+(s-l)*Math.min(1,e/a)):Math.round(l+(s-l)*e),n=l>s?this.fromTextConfig.slice(0,r):this.toTextConfig.slice(0,r).map((t,i)=>{if("text"in t){let r=Object.assign({},t);if(this.strokeFirst){let t=i/s*a,n=Math.max(0,e-t),l=1-t,o=Math.min(1,n/(this.strokeToFillRatio*l));"fill"in r&&r.fill&&(r.stroke=r.fill,o<1&&(r.fillOpacity=o)),this.fadeInChars&&(r.opacity=Math.max(0,Math.min(1,Math.min(1,n/(this.fadeInDuration*l)))))}else this.fadeInChars&&(r.opacity=Math.max(0,Math.min(1,(e-i/s*a)/this.fadeInDuration)));return r}return t}),this.showCursor&&r<s){let t=!0;if(this.blinkCursor&&(t=Math.floor(e/.1)%2==0),t&&n.length>0){let t=n.length-1,e=n[t];if("text"in e)n[t]=Object.assign(Object.assign({},e),{text:String(e.text)+this.cursorChar});else{let t={text:this.cursorChar,fontSize:16};n.push(t)}}}this.target.setAttribute("textConfig",n)}}class C extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",this.fadeOutChars=!1,this.fadeOutDuration=.3,this.direction="backward",void 0!==(null==n?void 0:n.showCursor)&&(this.showCursor=n.showCursor),void 0!==(null==n?void 0:n.cursorChar)&&(this.cursorChar=n.cursorChar),void 0!==(null==n?void 0:n.blinkCursor)&&(this.blinkCursor=n.blinkCursor),void 0!==(null==n?void 0:n.beforeText)&&(this.beforeText=n.beforeText),void 0!==(null==n?void 0:n.afterText)&&(this.afterText=n.afterText),void 0!==(null==n?void 0:n.fadeOutChars)&&(this.fadeOutChars=n.fadeOutChars),void 0!==(null==n?void 0:n.fadeOutDuration)&&(this.fadeOutDuration=n.fadeOutDuration),void 0!==(null==n?void 0:n.direction)&&(this.direction=n.direction),this.propKeys=["textConfig"]}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=_.H.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?_.H.TransformTextConfig2SingleCharacter(e.textConfig):[]):this.valid=!1}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){let r;if(!this.valid)return;let n=this.fromTextConfig.length,s=this.fadeOutChars?1-this.fadeOutDuration:1;if("forward"===this.direction){r=this.fadeOutChars?Math.round(n*(1-Math.min(1,e/s))):Math.round(n*(1-e));let t="forward"===this.direction?this.fromTextConfig.slice(n-r):this.fromTextConfig.slice(0,r);this.fadeOutChars&&(t=this.applyFadeEffect(t,e,n,r)),this.showCursor&&r>0&&(t=this.addCursor(t,e)),this.target.setAttribute("textConfig",t)}else{r=this.fadeOutChars?Math.round(n*(1-Math.min(1,e/s))):Math.round(n*(1-e));let t=this.fromTextConfig.slice(0,r);this.fadeOutChars&&(t=this.applyFadeEffect(t,e,n,r)),this.showCursor&&r>0&&(t=this.addCursor(t,e)),this.target.setAttribute("textConfig",t)}}applyFadeEffect(t,e,i,r){this.direction;let n=Math.max(0,1-Math.min(1,(e-(1-this.fadeOutDuration))/this.fadeOutDuration));return t.map((e,i)=>{if("forward"===this.direction){if(0===i&&"text"in e)return Object.assign(Object.assign({},e),{opacity:n})}else if(i===t.length-1&&"text"in e)return Object.assign(Object.assign({},e),{opacity:n});return e})}addCursor(t,e){let i=!0;if(this.blinkCursor&&(i=Math.floor(e/.1)%2==0),i&&t.length>0){let e="forward"===this.direction?0:t.length-1,i=t[e];if("text"in i){let r=[...t];return"forward"===this.direction?r[e]=Object.assign(Object.assign({},i),{text:this.cursorChar+String(i.text)}):r[e]=Object.assign(Object.assign({},i),{text:String(i.text)+this.cursorChar}),r}}return t}}class w extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeInDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],void 0!==(null==n?void 0:n.fadeInDuration)&&(this.fadeInDuration=n.fadeInDuration),void 0!==(null==n?void 0:n.slideDirection)&&(this.slideDirection=n.slideDirection),void 0!==(null==n?void 0:n.slideDistance)&&(this.slideDistance=n.slideDistance),void 0!==(null==n?void 0:n.wordByWord)&&(this.wordByWord=n.wordByWord),void 0!==(null==n?void 0:n.wordRegex)&&(this.wordRegex=n.wordRegex)}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?_.H.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=_.H.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.singleCharConfig=this.toTextConfig.map(t=>"text"in t?Object.assign(Object.assign({},t),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}):Object.assign(Object.assign({},t),{opacity:0})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="",e={},i,r=0;for(this.toTextConfig.forEach((i,n)=>{if("text"in i){let s=String(i.text);t+=s,e[r]=n,r++}}),this.wordRegex.lastIndex=0;null!==(i=this.wordRegex.exec(t));){let t=i.index,r=i.index+i[0].length,n=[];for(let i=t;i<r;i++)void 0!==e[i]&&n.push(e[i]);n.length>0&&this.wordGroups.push(n)}let n=new Set;this.wordGroups.forEach(t=>{t.forEach(t=>n.add(t))});for(let t=0;t<this.toTextConfig.length;t++)"text"in this.toTextConfig[t]&&!n.has(t)&&this.wordGroups.push([t])}getInitialDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getInitialDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){let r;if(!this.valid)return;let n=1-this.fadeInDuration;r=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,n):this.updateByCharacter(e,n),this.target.setAttribute("textConfig",r)}updateByWord(t,e){let i=this.wordGroups.length,r=[...this.singleCharConfig];for(let n=0;n<this.wordGroups.length;n++){let s;if(t<(s="left"===this.slideDirection?(i-1-n)/i*e:n/i*e)){for(let t of this.wordGroups[n]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}))}continue}let l=Math.max(0,Math.min(1,(t-s)/this.fadeInDuration)),a=this.getInitialDx()*(1-l),o=this.getInitialDy()*(1-l);for(let t of this.wordGroups[n]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:l,dx:a,dy:o}))}}return r}updateByCharacter(t,e){let i=this.toTextConfig.length,r=[...this.singleCharConfig];for(let n=0;n<r.length;n++){let s=r[n];if("text"in s){let l;if(t<(l="left"===this.slideDirection?(i-1-n)/i*e:n/i*e)){r[n]=Object.assign(Object.assign({},s),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()});continue}let a=Math.max(0,Math.min(1,(t-l)/this.fadeInDuration)),o=this.getInitialDx()*(1-a),h=this.getInitialDy()*(1-a);r[n]=Object.assign(Object.assign({},s),{opacity:a,dx:o,dy:h})}}return r}}class S extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeOutDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],this.reverseOrder=!1,void 0!==(null==n?void 0:n.fadeOutDuration)&&(this.fadeOutDuration=n.fadeOutDuration),void 0!==(null==n?void 0:n.slideDirection)&&(this.slideDirection=n.slideDirection),void 0!==(null==n?void 0:n.slideDistance)&&(this.slideDistance=n.slideDistance),void 0!==(null==n?void 0:n.wordByWord)&&(this.wordByWord=n.wordByWord),void 0!==(null==n?void 0:n.wordRegex)&&(this.wordRegex=n.wordRegex),void 0!==(null==n?void 0:n.reverseOrder)&&(this.reverseOrder=n.reverseOrder),this.propKeys=["textConfig"]}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=_.H.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?_.H.TransformTextConfig2SingleCharacter(e.textConfig):[],this.singleCharConfig=this.fromTextConfig.map(t=>"text"in t?Object.assign(Object.assign({},t),{opacity:1,dx:0,dy:0}):Object.assign(Object.assign({},t),{opacity:1})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="",e={},i,r=0;for(this.fromTextConfig.forEach((i,n)=>{if("text"in i){let s=String(i.text);t+=s,e[r]=n,r++}}),this.wordRegex.lastIndex=0;null!==(i=this.wordRegex.exec(t));){let t=i.index,r=i.index+i[0].length,n=[];for(let i=t;i<r;i++)void 0!==e[i]&&n.push(e[i]);n.length>0&&this.wordGroups.push(n)}let n=new Set;this.wordGroups.forEach(t=>{t.forEach(t=>n.add(t))});for(let t=0;t<this.fromTextConfig.length;t++)"text"in this.fromTextConfig[t]&&!n.has(t)&&this.wordGroups.push([t])}getTargetDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getTargetDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){let r;if(!this.valid)return;let n=1-this.fadeOutDuration;r=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,n):this.updateByCharacter(e,n),this.target.setAttribute("textConfig",r)}updateByWord(t,e){let i=this.wordGroups.length,r=[...this.singleCharConfig];for(let n=0;n<this.wordGroups.length;n++){let s;if(t<(s=this.reverseOrder?"left"===this.slideDirection?n/i*e:(i-1-n)/i*e:"left"===this.slideDirection?(i-1-n)/i*e:n/i*e)){for(let t of this.wordGroups[n]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:1,dx:0,dy:0}))}continue}let l=Math.max(0,Math.min(1,(t-s)/this.fadeOutDuration)),a=this.getTargetDx()*l,o=this.getTargetDy()*l,h=1-l;for(let t of this.wordGroups[n]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:h,dx:a,dy:o}))}}return r}updateByCharacter(t,e){let i=this.fromTextConfig.length,r=[...this.singleCharConfig];for(let n=0;n<r.length;n++){let s=r[n];if("text"in s){let l;if(t<(l=this.reverseOrder?"left"===this.slideDirection?n/i*e:(i-1-n)/i*e:"left"===this.slideDirection?(i-1-n)/i*e:n/i*e)){r[n]=Object.assign(Object.assign({},s),{opacity:1,dx:0,dy:0});continue}let a=Math.max(0,Math.min(1,(t-l)/this.fadeOutDuration)),o=this.getTargetDx()*a,h=this.getTargetDy()*a,u=1-a;r[n]=Object.assign(Object.assign({},s),{opacity:u,dx:o,dy:h})}}return r}}var A=i(60116),M=i(48110),k=i(63603);class T extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n,s,l,a,o,h,u,d;super.onBind();let c=this.target.getFinalAttribute(),p=(null==(t=this.params)?void 0:t.direction)||"right",g=(null==(e=this.params)?void 0:e.distance)||50,f=null!=(r=null==(i=this.params)?void 0:i.fromOpacity)?r:0,m={opacity:f,baseOpacity:f},y={opacity:1,baseOpacity:1};"top"===p?(m.y=(null!=(n=c.y)?n:0)-g,y.y=null!=(s=c.y)?s:0,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===p?(m.y=(null!=(l=c.y)?l:0)+g,y.y=null!=(a=c.y)?a:0,this.propKeys=["opacity","baseOpacity","y"]):("left"===p?(m.x=(null!=(o=c.x)?o:0)-g,y.x=null!=(h=c.x)?h:0):(m.x=(null!=(u=c.x)?u:0)+g,y.x=null!=(d=c.x)?d:0),this.propKeys=["opacity","baseOpacity","x"]),this.from=m,this.to=y,this.props=y,this.target.setAttributes(m)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class R extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n,s,l;super.onBind();let a=this.target.getFinalAttribute(),o=null!=(e=null==(t=this.params)?void 0:t.fromScale)?e:0,h=(null==(i=this.params)?void 0:i.direction)||"xy",u=null!=(n=null==(r=this.params)?void 0:r.fromOpacity)?n:0,d={opacity:u,baseOpacity:u},c={opacity:1,baseOpacity:1};this.propKeys=["opacity","baseOpacity"],"x"!==h&&"xy"!==h||(d.scaleX=o,c.scaleX=null!=(s=a.scaleX)?s:1,this.propKeys.push("scaleX")),"y"!==h&&"xy"!==h||(d.scaleY=o,c.scaleY=null!=(l=a.scaleY)?l:1,this.propKeys.push("scaleY")),this.from=d,this.to=c,this.props=c,this.target.setAttributes(d)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class B extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n,s,l,a,o;super.onBind();let h=this.target.getFinalAttribute(),u=null!=(e=null==(t=this.params)?void 0:t.fromAngle)?e:2*Math.PI,d=null!=(r=null==(i=this.params)?void 0:i.fromScale)?r:0,c=null!=(s=null==(n=this.params)?void 0:n.fromOpacity)?s:0,p={opacity:c,baseOpacity:c,angle:u,scaleX:d,scaleY:d},g={opacity:1,baseOpacity:1,angle:null!=(l=h.angle)?l:0,scaleX:null!=(a=h.scaleX)?a:1,scaleY:null!=(o=h.scaleY)?o:1};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=p,this.to=g,this.props=g,this.target.setAttributes(p)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class P extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.perimeter=0,this.originalAttributes={}}onBind(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y;if(super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){let i=this.target.attribute,r=null!=(t=i.width)?t:100,n=null!=(e=i.height)?e:100;this.perimeter=2*(r+n)}else if("circle"===this.target.type){let t=null!=(i=this.target.attribute.radius)?i:50;this.perimeter=2*Math.PI*t}else if("ellipse"===this.target.type){let t=this.target.attribute,e=null!=(r=t.radiusX)?r:50,i=null!=(n=t.radiusY)?n:50;this.perimeter=2*Math.PI*Math.sqrt((e*e+i*i)/2)}else this.perimeter=1e3;let v=null!=(l=null==(s=this.params)?void 0:s.lineWidth)?l:2,b=null!=(o=null==(a=this.params)?void 0:a.strokeColor)?o:"black",_=null!=(u=null==(h=this.params)?void 0:h.fromOpacity)?u:1,x=null!=(c=null==(d=this.params)?void 0:d.dashLength)?c:this.perimeter,C=null!=(g=null==(p=this.params)?void 0:p.showFill)&&g,w=null!=(m=null==(f=this.params)?void 0:f.fillOpacity)?m:0;this.from={lineDash:[x,x],lineDashOffset:x,lineWidth:v,stroke:b,strokeOpacity:_},this.to={lineDash:[x,x],lineDashOffset:0,lineWidth:v,stroke:b,strokeOpacity:_},C?(this.from.fillOpacity=w,this.to.fillOpacity=null!=(y=this.originalAttributes.fillOpacity)?y:1):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;let n=this.target.attribute;n.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null==(r=this.params)?void 0:r.showFill)&&(n.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}onEnd(){var t;if(super.onEnd(),!(null==(t=this.params)?void 0:t.showFill)){let t=Object.assign({},this.originalAttributes);t.fillOpacity=0,this.target.setAttributes(t)}}}class E extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.perimeter=0,this.originalAttributes={}}onFirstRun(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f;if(this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){let i=this.target.attribute,r=null!=(t=i.width)?t:100,n=null!=(e=i.height)?e:100;this.perimeter=2*(r+n)}else if("circle"===this.target.type){let t=null!=(i=this.target.attribute.radius)?i:50;this.perimeter=2*Math.PI*t}else if("ellipse"===this.target.type){let t=this.target.attribute,e=null!=(r=t.radiusX)?r:50,i=null!=(n=t.radiusY)?n:50;this.perimeter=2*Math.PI*Math.sqrt((e*e+i*i)/2)}else this.perimeter=1e3;let m=null!=(l=null==(s=this.params)?void 0:s.lineWidth)?l:2,y=null!=(o=null==(a=this.params)?void 0:a.strokeColor)?o:"black",v=null!=(u=null==(h=this.params)?void 0:h.fromOpacity)?u:1,b=null!=(c=null==(d=this.params)?void 0:d.dashLength)?c:this.perimeter,_=null!=(g=null==(p=this.params)?void 0:p.showFill)&&g;this.from={lineDash:[b,b],lineDashOffset:0,lineWidth:m,stroke:y,strokeOpacity:v},this.to={lineDash:[b,b],lineDashOffset:-b,lineWidth:m,stroke:y,strokeOpacity:v},_?this.from.fillOpacity=null!=(f=this.originalAttributes.fillOpacity)?f:1:this.from.fillOpacity=0,this.to.fillOpacity=0,this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;let n=this.target.attribute;n.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null==(r=this.params)?void 0:r.showFill)&&(n.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}}class I extends c.rd{constructor(t,e,i,r,n){var s;super(t,e,i,r,n);let l=null!=(s=null==n?void 0:n.slideRatio)?s:.5;this.slideInDuration=i*l,this.growInDuration=i*(1-l)}onBind(){var t,e,i,n,s,l;super.onBind();let a=new r.a(this.target);a.execute({type:"custom",custom:T,customParameters:{direction:(null==(t=this.params)?void 0:t.slideDirection)||"right",distance:(null==(e=this.params)?void 0:e.slideDistance)||50,fromOpacity:null!=(n=null==(i=this.params)?void 0:i.fromOpacity)?n:0},duration:this.slideInDuration,easing:this.easing}),a.execute({type:"custom",custom:R,customParameters:{fromScale:(null==(s=this.params)?void 0:s.fromScale)||.5,direction:(null==(l=this.params)?void 0:l.scaleDirection)||"xy",fromOpacity:1},duration:this.growInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class L extends c.rd{constructor(t,e,i,r,n){var s;super(t,e,i,r,n);let l=null!=(s=null==n?void 0:n.slideRatio)?s:.5;this.slideInDuration=i*l,this.spinInDuration=i*(1-l)}onBind(){var t,e,i,n,s,l;super.onBind();let a=new r.a(this.target);a.execute({type:"custom",custom:T,customParameters:{direction:(null==(t=this.params)?void 0:t.slideDirection)||"right",distance:(null==(e=this.params)?void 0:e.slideDistance)||50,fromOpacity:null!=(n=null==(i=this.params)?void 0:i.fromOpacity)?n:0},duration:this.slideInDuration,easing:this.easing}),a.execute({type:"custom",custom:B,customParameters:{fromAngle:(null==(s=this.params)?void 0:s.fromAngle)||Math.PI,fromScale:(null==(l=this.params)?void 0:l.fromScale)||.5,fromOpacity:1},duration:this.spinInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class F extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onFirstRun(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p;let g=this.target.getAttributes(),f=(null==(t=this.params)?void 0:t.direction)||"right",m=(null==(e=this.params)?void 0:e.distance)||50,y=null!=(r=null==(i=this.params)?void 0:i.fromOpacity)?r:1,v=null!=(s=null==(n=this.params)?void 0:n.toOpacity)?s:0,b={opacity:y,baseOpacity:y},_={opacity:v,baseOpacity:v};"top"===f?(b.y=null!=(l=g.y)?l:0,_.y=(null!=(a=g.y)?a:0)-m,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===f?(b.y=null!=(o=g.y)?o:0,_.y=(null!=(h=g.y)?h:0)+m,this.propKeys=["opacity","baseOpacity","y"]):("left"===f?(b.x=null!=(u=g.x)?u:0,_.x=(null!=(d=g.x)?d:0)-m):(b.x=null!=(c=g.x)?c:0,_.x=(null!=(p=g.x)?p:0)+m),this.propKeys=["opacity","baseOpacity","x"]),this.from=b,this.to=_,this.props=_}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class O extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onFirstRun(){var t,e,i,r,n,s,l,a,o;let h=this.target.getAttributes(),u=null!=(e=null==(t=this.params)?void 0:t.fromScale)?e:0,d=(null==(i=this.params)?void 0:i.direction)||"xy",c=null!=(n=null==(r=this.params)?void 0:r.fromOpacity)?n:1,p=null!=(l=null==(s=this.params)?void 0:s.toOpacity)?l:0,g={opacity:c,baseOpacity:c},f={opacity:p,baseOpacity:p};this.propKeys=["opacity","baseOpacity"],"x"!==d&&"xy"!==d||(g.scaleX=null!=(a=h.scaleX)?a:1,f.scaleX=u,this.propKeys.push("scaleX")),"y"!==d&&"xy"!==d||(g.scaleY=null!=(o=h.scaleY)?o:1,f.scaleY=u,this.propKeys.push("scaleY")),this.from=g,this.to=f,this.props=f}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class D extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onFirstRun(){var t,e,i,r,n,s,l,a,o,h,u;let d=this.target.getAttributes(),c=null!=(e=null==(t=this.params)?void 0:t.fromAngle)?e:2*Math.PI,p=null!=(r=null==(i=this.params)?void 0:i.fromScale)?r:0,g=null!=(s=null==(n=this.params)?void 0:n.fromOpacity)?s:1,f=null!=(a=null==(l=this.params)?void 0:l.toOpacity)?a:0,m={opacity:g,baseOpacity:g,angle:null!=(o=d.angle)?o:0,scaleX:null!=(h=d.scaleX)?h:1,scaleY:null!=(u=d.scaleY)?u:1},y={opacity:f,baseOpacity:f,angle:c,scaleX:p,scaleY:p};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=m,this.to=y,this.props=y}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class H extends c.rd{constructor(t,e,i,r,n){var s;super(t,e,i,r,n);let l=null!=(s=null==n?void 0:n.slideRatio)?s:.5;this.growOutDuration=i*(1-l),this.slideOutDuration=i*l}onFirstRun(){var t,e,i,n;let s=new r.a(this.target);s.execute({type:"custom",custom:O,customParameters:{fromScale:(null==(t=this.params)?void 0:t.fromScale)||.5,direction:(null==(e=this.params)?void 0:e.scaleDirection)||"xy",fromOpacity:1,toOpacity:1},duration:this.growOutDuration,easing:this.easing}),s.execute({type:"custom",custom:F,customParameters:{direction:(null==(i=this.params)?void 0:i.slideDirection)||"right",distance:(null==(n=this.params)?void 0:n.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.growOutDuration})}onUpdate(t,e,i){}}class z extends c.rd{constructor(t,e,i,r,n){var s;super(t,e,i,r,n);let l=null!=(s=null==n?void 0:n.slideRatio)?s:.5;this.spinOutDuration=i*(1-l),this.slideOutDuration=i*l}onFirstRun(){var t,e,i,n;let s=new r.a(this.target);s.execute({type:"custom",custom:D,customParameters:{fromAngle:(null==(t=this.params)?void 0:t.fromAngle)||Math.PI,fromScale:(null==(e=this.params)?void 0:e.fromScale)||.5,fromOpacity:1,toOpacity:1},duration:this.spinOutDuration,easing:this.easing}),s.execute({type:"custom",custom:F,customParameters:{direction:(null==(i=this.params)?void 0:i.slideDirection)||"right",distance:(null==(n=this.params)?void 0:n.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.spinOutDuration})}onUpdate(t,e,i){}}class W extends c.rd{constructor(t,e,i,r,n){super(t,e,i,r,n),this.originalAttributes={},this.pulseCount=3,this.pulseOpacity=.3,this.pulseScale=1.05,this.pulseColor=null,this.pulseColorIntensity=.2,this.strokeOnly=!1,this.fillOnly=!1,this.useScale=!0,this.useOpacity=!0,this.useStroke=!0,this.useFill=!0,this.useColor=!1,this.originalFill=null,this.originalStroke=null,void 0!==(null==n?void 0:n.pulseCount)&&(this.pulseCount=n.pulseCount),void 0!==(null==n?void 0:n.pulseScale)&&(this.pulseScale=n.pulseScale),void 0!==(null==n?void 0:n.pulseColor)&&(this.pulseColor=n.pulseColor),void 0!==(null==n?void 0:n.pulseColorIntensity)&&(this.pulseColorIntensity=n.pulseColorIntensity),void 0!==(null==n?void 0:n.strokeOnly)&&(this.strokeOnly=n.strokeOnly),void 0!==(null==n?void 0:n.fillOnly)&&(this.fillOnly=n.fillOnly),void 0!==(null==n?void 0:n.useScale)&&(this.useScale=n.useScale),void 0!==(null==n?void 0:n.useOpacity)&&(this.useOpacity=n.useOpacity),void 0!==(null==n?void 0:n.useStroke)&&(this.useStroke=n.useStroke),void 0!==(null==n?void 0:n.useFill)&&(this.useFill=n.useFill),void 0!==(null==n?void 0:n.useColor)&&(this.useColor=n.useColor)}onBind(){super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),this.useColor&&(this.originalFill=this.originalAttributes.fill||null,this.originalStroke=this.originalAttributes.stroke||null,this.pulseColor||(this.fillOnly&&this.originalFill?this.pulseColor=this.originalFill:this.strokeOnly&&this.originalStroke?this.pulseColor=this.originalStroke:this.originalFill?this.pulseColor=this.originalFill:this.originalStroke?this.pulseColor=this.originalStroke:this.pulseColor="#FFFFFF"))}onUpdate(t,e,i){let r=Math.abs(Math.sin(e*Math.PI*this.pulseCount)),n=this.target.attribute;if(this.useOpacity){let t=1+(this.pulseOpacity-1)*r;this.useStroke&&(n.strokeOpacity=(this.originalAttributes.strokeOpacity||1)*t),this.useFill&&(n.fillOpacity=(this.originalAttributes.fillOpacity||1)*t)}if(this.useScale){let t=1+(this.pulseScale-1)*r;n.scaleX=(this.originalAttributes.scaleX||1)*t,n.scaleY=(this.originalAttributes.scaleY||1)*t}this.useColor&&this.pulseColor&&this.applyColorPulse(n,r),this.target.addUpdateShapeAndBoundsTag(),this.target.addUpdatePositionTag()}applyColorPulse(t,e){let i=this.pulseColorIntensity*e;this.useFill&&this.originalFill&&this.pulseColor&&(t.fill=(0,k.BM)(this.originalFill,this.pulseColor,i,!0)),this.useStroke&&this.originalStroke&&this.pulseColor&&(t.stroke=(0,k.BM)(this.originalStroke,this.pulseColor,i,!0))}onEnd(){super.onEnd(),this.target.setAttributes(this.originalAttributes)}}var N=i(89258),j=i(29562),G=i(60678);class V extends c.rd{constructor(t,e,i,r,n){var s;super(t,e,i,r,n),n&&(this.pathLength=n.path.getLength(),this.path=n.path,this.distance=n.distance,this.totalLength=this.distance*this.pathLength,this.initAngle=null!=(s=n.initAngle)?s:0,this.changeAngle=!!n.changeAngle,this.cb=n.cb)}onBind(){this.from={x:0,y:0},this.to=this.path.getAttrAt(this.totalLength).pos,this.props=this.to}onUpdate(t,e,i){let r={},n=this.totalLength*e,{pos:s,angle:l}=this.path.getAttrAt(n);r.x=s.x,r.y=s.y,this.changeAngle&&(r.angle=l+this.initAngle),this.cb&&this.cb(this.from,this.to,e,this.target),this.target.setAttributes(r)}}var Z=i(86946),U=i(30380),K=i(89983);class $ extends c._j{constructor(t,e,i,r,n){super(t,e,i,r,n),this.webglCanvas=null,this.gl=null,this.program=null,this.currentAnimationRatio=0,this.animationTime=0}onUpdate(t,e,i){super.onUpdate(t,e,i),this.currentAnimationRatio=e,this.animationTime=e*Math.PI*2}getAnimationTime(){return this.currentAnimationRatio>0?this.animationTime:Date.now()/1e3}getDurationFromParent(){return this.duration||1e3}initWebGL(t){try{if(this.webglCanvas=K.rF.createCanvas({width:t.width,height:t.height,dpr:K.rF.devicePixelRatio}),!this.webglCanvas)return console.warn("WebGL canvas creation failed"),!1;this.webglCanvas.style.width=t.style.width||`${t.width}px`,this.webglCanvas.style.height=t.style.height||`${t.height}px`;let e=null;try{(e=this.webglCanvas.getContext("webgl"))||(e=this.webglCanvas.getContext("experimental-webgl"))}catch(t){console.warn("Failed to get WebGL context:",t)}if(this.gl=e,!this.gl)return console.warn("WebGL not supported"),!1;let i=this.getShaderSources();return this.program=this.createShaderProgram(i.vertex,i.fragment),null!==this.program}catch(t){return console.warn("Failed to initialize WebGL:",t),!1}}createShaderProgram(t,e){if(!this.gl)return null;let i=this.createShader(this.gl.VERTEX_SHADER,t),r=this.createShader(this.gl.FRAGMENT_SHADER,e);if(!i||!r)return null;let n=this.gl.createProgram();return n?(this.gl.attachShader(n,i),this.gl.attachShader(n,r),this.gl.linkProgram(n),this.gl.getProgramParameter(n,this.gl.LINK_STATUS)?n:(console.error("Shader program link error:",this.gl.getProgramInfoLog(n)),null)):null}createShader(t,e){if(!this.gl)return null;let i=this.gl.createShader(t);return i?(this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(console.error("Shader compile error:",this.gl.getShaderInfoLog(i)),this.gl.deleteShader(i),null)):null}setupWebGLState(t){this.gl&&this.webglCanvas&&(this.webglCanvas.width===t.width&&this.webglCanvas.height===t.height||(this.webglCanvas.width=t.width,this.webglCanvas.height=t.height),this.gl.viewport(0,0,this.webglCanvas.width,this.webglCanvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT))}createFullScreenQuad(){if(!this.gl)return null;let t=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,1,1,1,0]),e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),e}createTextureFromCanvas(t){if(!this.gl)return null;let e=this.gl.createTexture();return this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),e}setupVertexAttributes(){if(!this.gl||!this.program)return;let t=this.gl.getAttribLocation(this.program,"a_position"),e=this.gl.getAttribLocation(this.program,"a_texCoord");this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,2,this.gl.FLOAT,!1,16,0),this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,16,8)}createOutputCanvas(t){let e=K.rF.createCanvas({width:t.width,height:t.height,dpr:K.rF.devicePixelRatio}),i=e.getContext("2d");return i?(i.clearRect(0,0,t.width,t.height),i.drawImage(t,0,0),{canvas:e,ctx:i}):null}getShaderSources(){return null}applyWebGLEffect(t){return null}applyCanvas2DEffect(t){return null}supportsWebGL(){return null!==this.getShaderSources()}supportsCanvas2D(){return this.applyCanvas2DEffect!==$.prototype.applyCanvas2DEffect}release(){super.release(),this.gl&&(this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.gl=null),this.webglCanvas&&(this.webglCanvas=null),this.currentAnimationRatio=0,this.animationTime=0}afterStageRender(t,e){let i=null;if(this.supportsWebGL()&&(this.gl||this.initWebGL(e)||console.warn("WebGL初始化失败，尝试Canvas 2D回退"),this.gl)){if(i=this.applyWebGLEffect(e))return i;console.warn("WebGL特效执行失败，尝试Canvas 2D回退")}if(this.supportsCanvas2D()){if(i=this.applyCanvas2DEffect(e))return i;console.warn("Canvas 2D特效执行失败")}return this.supportsWebGL()||this.supportsCanvas2D()||console.error(`特效类 ${this.constructor.name} 未实现任何渲染方法。请实现 applyWebGLEffect 或 applyCanvas2DEffect 方法。`),e}}class Y extends ${constructor(t,e,i,r,n){super(t,e,i,r,n)}getShaderSources(){return null}applyWebGLEffect(t){return null}}class X extends ${constructor(t,e,i,r,n){super(t,e,i,r,n)}getShaderSources(){return null}applyWebGLEffect(t){return null}applyCanvas2DEffect(t){return null}supportsWebGL(){return this.getShaderSources!==X.prototype.getShaderSources&&null!==this.getShaderSources()}supportsCanvas2D(){return this.applyCanvas2DEffect!==X.prototype.applyCanvas2DEffect}afterStageRender(t,e){var i,r;let n=null;if(!1!==(null==(r=null==(i=this.params)?void 0:i.options)?void 0:r.useWebGL)){if(this.supportsWebGL()&&(this.gl||this.initWebGL(e)||console.warn("WebGL初始化失败，尝试Canvas 2D回退"),this.gl)){if(n=this.applyWebGLEffect(e))return n;console.warn("WebGL特效执行失败，尝试Canvas 2D回退")}if(this.supportsCanvas2D()){if(n=this.applyCanvas2DEffect(e))return n;console.warn("Canvas 2D特效执行失败")}}else if(this.supportsCanvas2D()){if(n=this.applyCanvas2DEffect(e))return n;console.warn("Canvas 2D特效执行失败")}else console.warn(`${this.constructor.name}: useWebGL=false 但未实现Canvas 2D方法`);return this.supportsWebGL()||this.supportsCanvas2D()||console.error(`特效类 ${this.constructor.name} 未实现任何渲染方法。请实现 applyWebGLEffect 或 applyCanvas2DEffect 方法。`),e}}class q{static createTempCanvas(t,e,i){return K.rF.createCanvas({width:t,height:e,dpr:i||K.rF.devicePixelRatio})}static cloneImageData(t){return new ImageData(new Uint8ClampedArray(t.data),t.width,t.height)}static lerp(t,e,i){return t*(1-i)+e*i}static smoothstep(t,e,i){let r=Math.max(0,Math.min(1,(i-t)/(e-t)));return r*r*(3-2*r)}static distance(t,e,i,r){let n=i-t,s=r-e;return Math.sqrt(n*n+s*s)}static normalizeAngle(t){return(t+Math.PI)/(2*Math.PI)}static pixelNoise(t,e,i){if(i<=0)return 0;let r=43758.5453*Math.sin(Math.floor(t/i)*i*12.9898+Math.floor(e/i)*i*78.233);return r-Math.floor(r)}static generateNoiseTexture(t,e){let i=new Uint8Array(t*e);for(let t=0;t<i.length;t++)i[t]=Math.floor(256*Math.random());return i}static applyCSSFilter(t,e){let i=this.createTempCanvas(t.width,t.height),r=i.getContext("2d");return r?(r.filter=e,r.drawImage(t,0,0),r.filter="none",i):t}static extractChannel(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i.length);for(let t=0;t<i.length;t+=4)s[t]=0,s[t+1]=0,s[t+2]=0,s[t+3]=i[t+3],e>=0&&e<=2&&(s[t+e]=i[t+e]);return new ImageData(s,r,n)}static blendImageData(t,e,i){let{data:r,width:n,height:s}=t,{data:l}=e,a=new Uint8ClampedArray(r.length);for(let t=0;t<r.length;t+=4)a[t]=Math.round(this.lerp(r[t],l[t],i)),a[t+1]=Math.round(this.lerp(r[t+1],l[t+1],i)),a[t+2]=Math.round(this.lerp(r[t+2],l[t+2],i)),a[t+3]=Math.round(this.lerp(r[t+3],l[t+3],i));return new ImageData(a,n,s)}static getLuminance(t,e,i){return .299*t+.587*e+.114*i}static applySepiaToPixel(t,e,i){return[Math.min(255,.393*t+.769*e+.189*i),Math.min(255,.349*t+.686*e+.168*i),Math.min(255,.272*t+.534*e+.131*i)]}static calculateDynamicStrength(t,e){return e/(2*Math.PI)*t}}class J{}J.STANDARD_VERTEX_SHADER="\n    attribute vec2 a_position;\n    attribute vec2 a_texCoord;\n    varying vec2 v_texCoord;\n\n    void main() {\n      gl_Position = vec4(a_position, 0.0, 1.0);\n      v_texCoord = a_texCoord;\n    }\n  ",J.SHADER_FUNCTIONS="\n    // 亮度计算函数\n    float luminance(vec3 color) {\n      return dot(color, vec3(0.299, 0.587, 0.114));\n    }\n\n    // 褐色调函数\n    vec3 sepia(vec3 color) {\n      float r = color.r * 0.393 + color.g * 0.769 + color.b * 0.189;\n      float g = color.r * 0.349 + color.g * 0.686 + color.b * 0.168;\n      float b = color.r * 0.272 + color.g * 0.534 + color.b * 0.131;\n      return vec3(r, g, b);\n    }\n\n    // 线性插值函数\n    float lerp(float a, float b, float t) {\n      return a * (1.0 - t) + b * t;\n    }\n\n\n    // 简单噪声函数\n    float pixelNoise(vec2 coord, float pixelSize) {\n      vec2 gridCoord = floor(coord / pixelSize) * pixelSize;\n      return fract(sin(dot(gridCoord, vec2(12.9898, 78.233))) * 43758.5453123);\n    }\n\n    // 动态强度计算\n    float calculateDynamicStrength(float baseStrength, float time) {\n      return baseStrength * (time / 6.28318531); // 2π\n    }\n  ";class Q extends X{constructor(t,e,i,r,n){var s,l,a,o;super(t,e,i,r,n),this.noiseData=null;let h=null==(s=null==n?void 0:n.options)?void 0:s.noiseScale,u=void 0!==h?Math.max(0,Math.floor(h)):8;this.dissolveConfig={dissolveType:(null==(l=null==n?void 0:n.options)?void 0:l.dissolveType)||"outward",useWebGL:void 0===(null==(a=null==n?void 0:n.options)?void 0:a.useWebGL)||n.options.useWebGL,noiseScale:u,fadeEdge:void 0===(null==(o=null==n?void 0:n.options)?void 0:o.fadeEdge)||n.options.fadeEdge}}getShaderSources(){return{vertex:J.STANDARD_VERTEX_SHADER,fragment:`
      precision mediump float;
      uniform sampler2D u_texture;
      uniform sampler2D u_noiseTexture;
      uniform float u_time;
      uniform int u_dissolveType;
      uniform vec2 u_resolution;
      uniform float u_noiseScale;
      uniform bool u_fadeEdge;
      varying vec2 v_texCoord;

      ${J.SHADER_FUNCTIONS}

      // 向外溶解函数
      float outwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        vec2 center = vec2(0.5, 0.5);
        float distFromCenter = length(uv - center);
        float maxDist = length(vec2(0.5, 0.5));

        // 归一化距离 (0为中心，1为边缘)
        float normalizedDist = distFromCenter / maxDist;

        // 向外溶解：从边缘开始溶解，time控制溶解进度
        // 增加安全边距，确保动画结束时完全溶解
        float edgeThreshold = 1.2 - time * 1.5;

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          // 添加基于像素大小的噪声，让边缘呈现颗粒状
          vec2 pixelCoord = uv * resolution; // 转换为像素坐标
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.4; // 增强噪声影响
          edgeThreshold += noiseInfluence;
          return normalizedDist > edgeThreshold ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.15; // 渐变宽度
            return 1.0 - smoothstep(edgeThreshold - fadeWidth, edgeThreshold, normalizedDist);
          } else {
            // 硬边缘：返回0或1
            return normalizedDist > edgeThreshold ? 0.0 : 1.0;
          }
        }
      }

      // 向内溶解函数
      float inwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        vec2 center = vec2(0.5, 0.5);
        float distFromCenter = length(uv - center);
        float maxDist = length(vec2(0.5, 0.5));

        float normalizedDist = distFromCenter / maxDist;

        // 向内溶解：从中心开始溶解，time控制溶解进度
        // 增加系数，确保动画结束时完全溶解
        float centerThreshold = time * 1.4;

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.4;
          centerThreshold += noiseInfluence;
          return normalizedDist < centerThreshold ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.15; // 渐变宽度
            return smoothstep(centerThreshold, centerThreshold + fadeWidth, normalizedDist);
          } else {
            // 硬边缘：返回0或1
            return normalizedDist < centerThreshold ? 0.0 : 1.0;
          }
        }
      }

      // 径向溶解函数
      float radialDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        vec2 center = vec2(0.5, 0.5);
        float angle = atan(uv.y - center.y, uv.x - center.x);
        float normalizedAngle = (angle + 3.14159) / (2.0 * 3.14159);

        // 径向溶解：按角度顺序溶解，time控制溶解进度
        // 增加系数，确保动画结束时完全溶解
        float angleThreshold = time * 1.2;

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          angleThreshold += noiseInfluence;
          return normalizedAngle < angleThreshold ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(angleThreshold, angleThreshold + fadeWidth, normalizedAngle);
          } else {
            // 硬边缘：返回0或1
            return normalizedAngle < angleThreshold ? 0.0 : 1.0;
          }
        }
      }

      // 从左到右溶解函数
      float leftToRightDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // 左到右溶解：从x=0开始向x=1溶解
        float dissolvePosition = time * 1.2; // 增加系数确保完全溶解

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.x < dissolvePosition ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.x);
          } else {
            // 硬边缘：返回0或1
            return uv.x < dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      // 从右到左溶解函数
      float rightToLeftDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // 右到左溶解：从x=1开始向x=0溶解
        float dissolvePosition = 1.0 - time * 1.2; // 增加系数确保完全溶解

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.x > dissolvePosition ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.x);
          } else {
            // 硬边缘：返回0或1
            return uv.x > dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      // 从上到下溶解函数
      float topToBottomDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // 上到下溶解：从y=0开始向y=1溶解
        float dissolvePosition = time * 1.2; // 增加系数确保完全溶解

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.y < dissolvePosition ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.y);
          } else {
            // 硬边缘：返回0或1
            return uv.y < dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      // 从下到上溶解函数
      float bottomToTopDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // 下到上溶解：从y=1开始向y=0溶解
        float dissolvePosition = 1.0 - time * 1.2; // 增加系数确保完全溶解

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.y > dissolvePosition ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.y);
          } else {
            // 硬边缘：返回0或1
            return uv.y > dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      void main() {
        vec2 uv = v_texCoord;
        vec4 texColor = texture2D(u_texture, uv);

        float alpha = 1.0;

        // 根据溶解类型选择对应的溶解函数
        if (u_dissolveType == 0) {
          alpha = outwardDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 1) {
          alpha = inwardDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 2) {
          alpha = radialDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 3) {
          alpha = leftToRightDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 4) {
          alpha = rightToLeftDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 5) {
          alpha = topToBottomDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 6) {
          alpha = bottomToTopDissolve(uv, u_time, u_noiseScale, u_resolution);
        }

        gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);
      }
    `}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return t;this.setupWebGLState(t);let e=this.createTextureFromCanvas(t);if(!e)return t;this.noiseData||(this.noiseData=q.generateNoiseTexture(256,256));let i=this.gl.createTexture();this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,256,256,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,this.noiseData),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);let r=this.createFullScreenQuad();return r?(this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setUniforms(),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.deleteTexture(e),this.gl.deleteTexture(i),this.gl.deleteBuffer(r),this.webglCanvas):t}setUniforms(){if(!this.gl||!this.program||!this.webglCanvas)return;let t=this.gl.getUniformLocation(this.program,"u_texture"),e=this.gl.getUniformLocation(this.program,"u_noiseTexture"),i=this.gl.getUniformLocation(this.program,"u_time"),r=this.gl.getUniformLocation(this.program,"u_dissolveType"),n=this.gl.getUniformLocation(this.program,"u_resolution"),s=this.gl.getUniformLocation(this.program,"u_noiseScale"),l=this.gl.getUniformLocation(this.program,"u_fadeEdge");this.gl.uniform1i(t,0),this.gl.uniform1i(e,1),this.gl.uniform1f(i,this.currentAnimationRatio),this.gl.uniform2f(n,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1f(s,this.dissolveConfig.noiseScale),this.gl.uniform1i(l,+!!this.dissolveConfig.fadeEdge),this.gl.uniform1i(r,{outward:0,inward:1,radial:2,leftToRight:3,rightToLeft:4,topToBottom:5,bottomToTop:6}[this.dissolveConfig.dissolveType]||0)}applyCanvas2DEffect(t){let e,i=this.createOutputCanvas(t);if(!i)return t;let{canvas:r,ctx:n}=i,s=n.getImageData(0,0,t.width,t.height),l=this.currentAnimationRatio;switch(this.dissolveConfig.dissolveType){case"outward":e=this.applyOutwardDissolve(s,l);break;case"inward":e=this.applyInwardDissolve(s,l);break;case"radial":e=this.applyRadialDissolve(s,l);break;case"leftToRight":e=this.applyLeftToRightDissolve(s,l);break;case"rightToLeft":e=this.applyRightToLeftDissolve(s,l);break;case"topToBottom":e=this.applyTopToBottomDissolve(s,l);break;case"bottomToTop":e=this.applyBottomToTopDissolve(s,l);break;default:e=s}return n.putImageData(e,0,0),r}applyOutwardDissolve(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i.length);s.set(i);let l=r/2,a=n/2,o=Math.sqrt(l*l+a*a),h=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=i-l,u=t-a,d=Math.sqrt(n*n+u*u)/o,c=1.2-1.4*e,p=1;if(h>0)c+=.4*(q.pixelNoise(i,t,h)-.5),p=d>c?0:1;else if(this.dissolveConfig.fadeEdge){let t=c-.15;p=d<t?1:d>c?0:1-(d-t)/(c-t)}else p=d>c?0:1;let g=4*(t*r+i);s[g+3]=Math.floor(s[g+3]*p)}return new ImageData(s,r,n)}applyInwardDissolve(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i.length);s.set(i);let l=r/2,a=n/2,o=Math.sqrt(l*l+a*a),h=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=i-l,u=t-a,d=Math.sqrt(n*n+u*u)/o,c=1.4*e,p=1;if(h>0)c+=.4*(q.pixelNoise(i,t,h)-.5),p=d<c?0:1;else if(this.dissolveConfig.fadeEdge){let t=c+.15;p=d<c?0:d>t?1:(d-c)/(t-c)}else p=d<c?0:1;let g=4*(t*r+i);s[g+3]=Math.floor(s[g+3]*p)}return new ImageData(s,r,n)}applyRadialDissolve(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i.length);s.set(i);let l=r/2,a=n/2,o=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=(Math.atan2(t-a,i-l)+Math.PI)/(2*Math.PI),h=1.2*e,u=1;if(o>0)h+=.3*(q.pixelNoise(i,t,o)-.5),u=n<h?0:1;else if(this.dissolveConfig.fadeEdge){let t=h+.08;u=n<h?0:n>t?1:(n-h)/(t-h)}else u=n<h?0:1;let d=4*(t*r+i);s[d+3]=Math.floor(s[d+3]*u)}return new ImageData(s,r,n)}applyLeftToRightDissolve(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i.length);s.set(i);let l=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=i/r,a=1.2*e,o=1;if(l>0)a+=.3*(q.pixelNoise(i,t,l)-.5),o=n<a?0:1;else if(this.dissolveConfig.fadeEdge){let t=a+.08;o=n<a?0:n>t?1:(n-a)/(t-a)}else o=n<a?0:1;let h=4*(t*r+i);s[h+3]=Math.floor(s[h+3]*o)}return new ImageData(s,r,n)}applyRightToLeftDissolve(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i.length);s.set(i);let l=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=i/r,a=1-1.2*e,o=1;if(l>0)a+=.3*(q.pixelNoise(i,t,l)-.5),o=n>a?0:1;else if(this.dissolveConfig.fadeEdge){let t=a-.08;o=n<t?1:n>a?0:1-(n-t)/(a-t)}else o=n>a?0:1;let h=4*(t*r+i);s[h+3]=Math.floor(s[h+3]*o)}return new ImageData(s,r,n)}applyTopToBottomDissolve(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i.length);s.set(i);let l=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let a=t/n,o=1.2*e,h=1;if(l>0)o+=.3*(q.pixelNoise(i,t,l)-.5),h=a<o?0:1;else if(this.dissolveConfig.fadeEdge){let t=o+.08;h=a<o?0:a>t?1:(a-o)/(t-o)}else h=a<o?0:1;let u=4*(t*r+i);s[u+3]=Math.floor(s[u+3]*h)}return new ImageData(s,r,n)}applyBottomToTopDissolve(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i.length);s.set(i);let l=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let a=t/n,o=1-1.2*e,h=1;if(l>0)o+=.3*(q.pixelNoise(i,t,l)-.5),h=a>o?0:1;else if(this.dissolveConfig.fadeEdge){let t=o-.08;h=a<t?1:a>o?0:1-(a-t)/(o-t)}else h=a>o?0:1;let u=4*(t*r+i);s[u+3]=Math.floor(s[u+3]*h)}return new ImageData(s,r,n)}}class te extends X{constructor(t,e,i,r,n){var s,l,a;super(t,e,i,r,n);let o=Math.max(0,Math.min(1,void 0!==(null==(s=null==n?void 0:n.options)?void 0:s.strength)?n.options.strength:1));this.colorConfig={effectType:(null==(l=null==n?void 0:n.options)?void 0:l.effectType)||"grayscale",strength:o,useWebGL:void 0===(null==(a=null==n?void 0:n.options)?void 0:a.useWebGL)||n.options.useWebGL}}getShaderSources(){return{vertex:J.STANDARD_VERTEX_SHADER,fragment:`
      precision mediump float;
      uniform sampler2D u_texture;
      uniform float u_time;
      uniform float u_strength;
      uniform int u_effectType;
      uniform vec2 u_resolution;
      varying vec2 v_texCoord;

      ${J.SHADER_FUNCTIONS}

      void main() {
        vec2 uv = v_texCoord;
        vec4 originalColor = texture2D(u_texture, uv);
        vec3 color = originalColor.rgb;

        // 计算动态强度
        float dynamicStrength = calculateDynamicStrength(u_strength, u_time);

        if (u_effectType == 0) {
          // 灰度效果
          float gray = luminance(color);
          vec3 grayColor = vec3(gray);
          color = mix(color, grayColor, dynamicStrength);
        } else if (u_effectType == 1) {
          // 褐色调效果
          vec3 sepiaColor = sepia(color);
          color = mix(color, sepiaColor, dynamicStrength);
        }

        gl_FragColor = vec4(color, originalColor.a);
      }
    `}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);let e=this.createTextureFromCanvas(t);if(!e)return null;let i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setColorUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}setColorUniforms(){if(!this.gl||!this.program)return;let t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),r=this.gl.getUniformLocation(this.program,"u_effectType"),n=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.colorConfig.strength),this.gl.uniform2f(n,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(r,{grayscale:0,sepia:1}[this.colorConfig.effectType]||0)}applyCanvas2DEffect(t){if(this.colorConfig.strength<=0){let e=this.createOutputCanvas(t);return e?e.canvas:null}if(this.canUseCSSFilter())return this.applyCSSFilter(t);let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r,n=i.getImageData(0,0,t.width,t.height),s=this.getAnimationTime();switch(this.colorConfig.effectType){case"grayscale":default:r=this.applyGrayscaleEffect(n,this.colorConfig.strength,s);break;case"sepia":r=this.applySepiaEffect(n,this.colorConfig.strength,s)}return i.clearRect(0,0,t.width,t.height),i.putImageData(r,0,0),e.canvas}catch(t){return console.warn("Canvas 2D color effect failed:",t),null}}canUseCSSFilter(){var t;return!!window.useFilterAPI&&"undefined"!=typeof CSS&&(null==(t=CSS.supports)?void 0:t.call(CSS,"filter","grayscale(1)"))}applyCSSFilter(t){try{let e=q.createTempCanvas(t.width,t.height),i=e.getContext("2d");if(!i)return null;let r=this.getAnimationTime(),n=q.calculateDynamicStrength(this.colorConfig.strength,r),s="";return"grayscale"===this.colorConfig.effectType?s=`grayscale(${Math.min(1,n)})`:"sepia"===this.colorConfig.effectType&&(s=`sepia(${Math.min(1,n)})`),i.filter=s,i.drawImage(t,0,0),i.filter="none",e}catch(t){return console.warn("CSS Filter API failed, falling back to pixel processing:",t),null}}applyGrayscaleEffect(t,e,i){let{data:r,width:n,height:s}=t,l=new Uint8ClampedArray(r.length),a=q.calculateDynamicStrength(e,i);for(let t=0;t<r.length;t+=4){let e=r[t],i=r[t+1],n=r[t+2],s=r[t+3],o=q.getLuminance(e,i,n);l[t]=Math.round(q.lerp(e,o,a)),l[t+1]=Math.round(q.lerp(i,o,a)),l[t+2]=Math.round(q.lerp(n,o,a)),l[t+3]=s}return new ImageData(l,n,s)}applySepiaEffect(t,e,i){let{data:r,width:n,height:s}=t,l=new Uint8ClampedArray(r.length),a=q.calculateDynamicStrength(e,i);for(let t=0;t<r.length;t+=4){let e=r[t],i=r[t+1],n=r[t+2],s=r[t+3],[o,h,u]=q.applySepiaToPixel(e,i,n);l[t]=Math.round(q.lerp(e,o,a)),l[t+1]=Math.round(q.lerp(i,h,a)),l[t+2]=Math.round(q.lerp(n,u,a)),l[t+3]=s}return new ImageData(l,n,s)}afterStageRender(t,e){if(this.canUseCSSFilter()&&this.colorConfig.strength>0){let t=this.applyCSSFilter(e);if(t)return t}return super.afterStageRender(t,e)}}class ti extends X{constructor(t,e,i,r,n){var s,l,a;super(t,e,i,r,n),this.distortionConfig={distortionType:(null==(s=null==n?void 0:n.options)?void 0:s.distortionType)||"wave",strength:(null==(l=null==n?void 0:n.options)?void 0:l.strength)||.3,useWebGL:void 0===(null==(a=null==n?void 0:n.options)?void 0:a.useWebGL)||n.options.useWebGL}}getShaderSources(){return{vertex:"\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        v_texCoord = a_texCoord;\n      }\n    ",fragment:"\n      precision mediump float;\n      uniform sampler2D u_texture;\n      uniform float u_time;\n      uniform float u_strength;\n      uniform int u_distortionType;\n      uniform vec2 u_resolution;\n      varying vec2 v_texCoord;\n\n      // 波浪扭曲函数\n      vec2 wave(vec2 uv, float time, float strength) {\n        float waveX = sin(uv.y * 10.0 + time * 3.0) * strength * 0.1;\n        float waveY = sin(uv.x * 10.0 + time * 2.0) * strength * 0.1;\n        return uv + vec2(waveX, waveY);\n      }\n\n      // 涟漪扭曲函数\n      vec2 ripple(vec2 uv, float time, float strength) {\n        vec2 center = vec2(0.5, 0.5);\n        float distance = length(uv - center);\n        float ripple = sin(distance * 20.0 - time * 5.0) * strength * 0.1;\n        vec2 direction = normalize(uv - center);\n        return uv + direction * ripple;\n      }\n\n      // 漩涡扭曲函数\n      vec2 swirl(vec2 uv, float time, float strength) {\n        vec2 center = vec2(0.5, 0.5);\n        vec2 delta = uv - center;\n        float dist = length(delta);\n        float originalAngle = atan(delta.y, delta.x);\n        float rotationAngle = dist * strength * time * 2.0;\n        float finalAngle = originalAngle + rotationAngle;\n        return center + dist * vec2(cos(finalAngle), sin(finalAngle));\n      }\n\n      void main() {\n        vec2 uv = v_texCoord;\n\n        // 根据扭曲类型应用相应变换\n        if (u_distortionType == 0) {\n          uv = wave(uv, u_time, u_strength);\n        } else if (u_distortionType == 1) {\n          uv = ripple(uv, u_time, u_strength);\n        } else if (u_distortionType == 2) {\n          uv = swirl(uv, u_time, u_strength);\n        }\n\n        // 边界检查\n        if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        } else {\n          gl_FragColor = texture2D(u_texture, uv);\n        }\n      }\n    "}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);let e=this.createTextureFromCanvas(t);if(!e)return null;let i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setDistortionUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}setDistortionUniforms(){if(!this.gl||!this.program)return;let t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),r=this.gl.getUniformLocation(this.program,"u_distortionType"),n=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.distortionConfig.strength),this.gl.uniform2f(n,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(r,{wave:0,ripple:1,swirl:2}[this.distortionConfig.distortionType]||0)}applyCanvas2DEffect(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r,n=i.getImageData(0,0,t.width,t.height),s=this.getAnimationTime();switch(this.distortionConfig.distortionType){case"wave":r=this.applyWaveDistortion(n,this.distortionConfig.strength,s);break;case"ripple":r=this.applyRippleDistortion(n,this.distortionConfig.strength,s);break;case"swirl":r=this.applySwirlDistortion(n,this.distortionConfig.strength,s);break;default:r=n}return i.clearRect(0,0,t.width,t.height),i.putImageData(r,0,0),e.canvas}catch(t){return console.warn("Canvas 2D distortion effect failed:",t),null}}applyWaveDistortion(t,e,i){let{data:r,width:n,height:s}=t,l=new Uint8ClampedArray(r.length);for(let t=0;t<s;t++)for(let a=0;a<n;a++){let o=Math.sin(.1*t+3*i)*e*20,h=Math.sin(.1*a+2*i)*e*20,u=Math.round(a-o),d=Math.round(t-h),c=4*(t*n+a);if(u>=0&&u<n&&d>=0&&d<s){let t=4*(d*n+u);l[c]=r[t],l[c+1]=r[t+1],l[c+2]=r[t+2],l[c+3]=r[t+3]}else l[c+3]=0}return new ImageData(l,n,s)}applyRippleDistortion(t,e,i){let{data:r,width:n,height:s}=t,l=new Uint8ClampedArray(r.length),a=n/2,o=s/2;for(let t=0;t<s;t++)for(let h=0;h<n;h++){let u=h-a,d=t-o,c=Math.sin(.2*Math.sqrt(u*u+d*d)-5*i)*e*10,p=Math.atan2(d,u),g=Math.round(h-Math.cos(p)*c),f=Math.round(t-Math.sin(p)*c),m=4*(t*n+h);if(g>=0&&g<n&&f>=0&&f<s){let t=4*(f*n+g);l[m]=r[t],l[m+1]=r[t+1],l[m+2]=r[t+2],l[m+3]=r[t+3]}else l[m+3]=0}return new ImageData(l,n,s)}applySwirlDistortion(t,e,i){let{data:r,width:n,height:s}=t,l=new Uint8ClampedArray(r.length),a=n/2,o=s/2;for(let t=0;t<s;t++)for(let h=0;h<n;h++){let u=h-a,d=t-o,c=Math.sqrt(u*u+d*d),p=Math.atan2(d,u)+c*e*i*.02,g=Math.round(a+c*Math.cos(p)),f=Math.round(o+c*Math.sin(p)),m=4*(t*n+h);if(g>=0&&g<n&&f>=0&&f<s){let t=4*(f*n+g);l[m]=r[t],l[m+1]=r[t+1],l[m+2]=r[t+2],l[m+3]=r[t+3]}else l[m+3]=0}return new ImageData(l,n,s)}afterStageRender(t,e){return this.distortionConfig.strength<=0?e:super.afterStageRender(t,e)}}class tr extends X{constructor(t,e,i,r,n){var s,l,a,o,h;super(t,e,i,r,n),this.particles=[],this.positionBuffer=null,this.colorBuffer=null,this.particleConfig={effectType:(null==(s=null==n?void 0:n.options)?void 0:s.effectType)||"gravity",count:(null==(l=null==n?void 0:n.options)?void 0:l.count)||4e3,size:(null==(a=null==n?void 0:n.options)?void 0:a.size)||20,strength:(null==(o=null==n?void 0:n.options)?void 0:o.strength)||1.5,useWebGL:void 0===(null==(h=null==n?void 0:n.options)?void 0:h.useWebGL)||n.options.useWebGL}}getShaderSources(){return{vertex:"\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_size;\n\n      uniform vec2 u_resolution;\n      uniform float u_time;\n      uniform float u_forceStrength;\n      uniform int u_effectType;\n\n      varying vec4 v_color;\n\n      void main() {\n        // 将像素坐标转换为剪辑空间坐标\n        vec2 clipSpace = ((a_position / u_resolution) * 2.0) - 1.0;\n        clipSpace.y = -clipSpace.y; // 翻转Y轴\n\n        gl_Position = vec4(clipSpace, 0.0, 1.0);\n        gl_PointSize = a_size;\n        v_color = a_color;\n      }\n    ",fragment:"\n      precision mediump float;\n      varying vec4 v_color;\n\n      void main() {\n        // 创建圆形粒子\n        vec2 coord = gl_PointCoord - vec2(0.5);\n        float distance = length(coord);\n\n        if (distance > 0.5) {\n          discard;\n        }\n\n        // 保持原始颜色，只调整透明度渐变\n        gl_FragColor = vec4(v_color.rgb, v_color.a);\n      }\n    "}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t),0===this.particles.length&&this.extractParticles(t),this.updateParticles(t);let e=this.gl;return e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.useProgram(this.program),this.prepareAndDrawParticles(e),this.webglCanvas}applyCanvas2DEffect(t){let e=this.createOutputCanvas(t);if(!e)return null;let{canvas:i,ctx:r}=e,n=this.currentAnimationRatio;switch(this.particleConfig.effectType){case"explode":this.applyCanvas2DExplode(r,t,n);break;case"gravity":this.applyCanvas2DGravity(r,t,n);break;case"vortex":this.applyCanvas2DVortex(r,t,n);break;default:r.globalAlpha=Math.max(0,1-n),r.drawImage(t,0,0)}return i}extractParticles(t){let e=q.createTempCanvas(t.width,t.height,1),i=e.getContext("2d");if(!i)return;i.drawImage(t,0,0,e.width,e.height);let r=i.getImageData(0,0,e.width,e.height).data;this.particles=[];let n=Math.max(1,Math.floor(Math.sqrt(e.width*e.height/(1.5*this.particleConfig.count))));for(let i=0;i<e.height;i+=n)for(let s=0;s<e.width;s+=n){let n=4*(i*e.width+s),l=r[n],a=r[n+1],o=r[n+2],h=r[n+3];if(h>5){let r=s/e.width*t.width,n=i/e.height*t.height,u={x:r,y:n,originX:r,originY:n,vx:0,vy:0,r:l/255,g:a/255,b:o/255,a:Math.max(.6,h/255),life:1,size:this.particleConfig.size*(1+.5*Math.random())};this.particles.push(u)}}}updateParticles(t){let e=t.width/2,i=t.height/2,r=this.currentAnimationRatio,n=this.getDurationFromParent(),s=n<2e3,l=s?Math.max(1.5,3e3/n):1,a=s?Math.min(2,2e3/n):1;this.particles.forEach(n=>{let o=n.x-e,h=n.y-i,u=Math.sqrt(o*o+h*h),d=Math.atan2(h,o);this.applyParticleForces(n,d,u,r,a,t),this.updateParticleProperties(n,r,s,l,a)})}applyParticleForces(t,e,i,r,n,s){let l=this.getAnimationTime();switch(this.particleConfig.effectType){case"explode":let a=r*this.particleConfig.strength*n*5;t.vx+=Math.cos(e)*a,t.vy+=Math.sin(e)*a;break;case"gravity":this.applyGravityEffect(t,r,n,s,l);break;case"vortex":this.applyVortexEffect(t,r,n,s,e,i)}}applyGravityEffect(t,e,i,r,n){let s=(t.originX+.7*t.originY)/(r.width+r.height)*.8;if(e>s){let r=(e-s)/(1-s),l=this.particleConfig.strength*r*r*12*i;t.vy+=l;let a=Math.sin(3*n+.02*t.originX)*Math.cos(2*n+.015*t.originY);t.vx+=a*this.particleConfig.strength*2*i}}applyVortexEffect(t,e,i,r,n,s){let l=r.width/2,a=r.height/2,o=n+e*Math.PI*.8,h=s+e*Math.max(r.width,r.height)*1.26,u=l+Math.cos(o)*h,d=a+Math.sin(o)*h,c=e*this.particleConfig.strength*.08*i;t.vx+=(u-t.x)*c,t.vy+=(d-t.y)*c}updateParticleProperties(t,e,i,r,n){let s=i?.99:.98;(t.vx*=s,t.vy*=s,t.x+=t.vx,t.y+=t.vy,i)?(t.life=Math.max(0,1-e*Math.max(.1,.5/r)),t.a=Math.max(.2,t.life*Math.min(1,1.2*t.a)),t.size=Math.max(.7*this.particleConfig.size,this.particleConfig.size*(.5+.5*t.life))):(t.life=Math.max(0,1-.2*e),t.a=Math.max(.1,t.life*Math.min(1,1.5*t.a)),t.size=Math.max(.5*this.particleConfig.size,this.particleConfig.size*(.3+.7*t.life)))}prepareAndDrawParticles(t){let e=new Float32Array(2*this.particles.length),i=new Float32Array(4*this.particles.length),r=new Float32Array(this.particles.length);this.particles.forEach((t,n)=>{e[2*n]=t.x,e[2*n+1]=t.y,i[4*n]=t.r,i[4*n+1]=t.g,i[4*n+2]=t.b,i[4*n+3]=Math.max(.1,t.a),r[n]=Math.max(6,1.5*t.size)}),this.updateParticleBuffers(t,e,i,r),this.setParticleUniforms(t),t.drawArrays(t.POINTS,0,this.particles.length),this.cleanupTempBuffers(t)}updateParticleBuffers(t,e,i,r){this.positionBuffer||(this.positionBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW);let n=t.getAttribLocation(this.program,"a_position");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),this.colorBuffer||(this.colorBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,i,t.DYNAMIC_DRAW);let s=t.getAttribLocation(this.program,"a_color");t.enableVertexAttribArray(s),t.vertexAttribPointer(s,4,t.FLOAT,!1,0,0);let l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferData(t.ARRAY_BUFFER,r,t.DYNAMIC_DRAW);let a=t.getAttribLocation(this.program,"a_size");t.enableVertexAttribArray(a),t.vertexAttribPointer(a,1,t.FLOAT,!1,0,0),this._tempSizeBuffer=l}setParticleUniforms(t){let e=t.getUniformLocation(this.program,"u_resolution"),i=t.getUniformLocation(this.program,"u_time"),r=t.getUniformLocation(this.program,"u_forceStrength"),n=t.getUniformLocation(this.program,"u_effectType");t.uniform2f(e,this.webglCanvas.width,this.webglCanvas.height),t.uniform1f(i,this.getAnimationTime()),t.uniform1f(r,this.particleConfig.strength),t.uniform1i(n,{explode:0,vortex:1,gravity:2}[this.particleConfig.effectType]||0)}cleanupTempBuffers(t){let e=this._tempSizeBuffer;e&&(t.deleteBuffer(e),delete this._tempSizeBuffer)}applyCanvas2DExplode(t,e,i){let r=e.width/2,n=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(r,n);let s=1+.5*i;t.scale(s,s),t.translate(-r,-n),t.drawImage(e,0,0),t.restore()}applyCanvas2DGravity(t,e,i){t.save(),t.globalAlpha=Math.max(0,1-i);let r=i*e.height*.3;t.drawImage(e,0,r),t.restore()}applyCanvas2DVortex(t,e,i){let r=e.width/2,n=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(r,n),t.rotate(i*Math.PI*2),t.translate(-r,-n),t.drawImage(e,0,0),t.restore()}}class tn extends Y{constructor(t,e,i,r,n){var s,l;super(t,e,i,r,n),this.glitchConfig={effectType:(null==(s=null==n?void 0:n.options)?void 0:s.effectType)||"rgb-shift",intensity:void 0!==(null==(l=null==n?void 0:n.options)?void 0:l.intensity)?n.options.intensity:.5}}applyCanvas2DEffect(t){if(this.glitchConfig.intensity<=0){let e=this.createOutputCanvas(t);return e?e.canvas:null}try{switch(this.glitchConfig.effectType){case"rgb-shift":default:return this.applyRGBShiftGlitch(t);case"digital-distortion":return this.applyDigitalDistortionGlitch(t);case"scan-lines":return this.applyScanLineGlitch(t);case"data-corruption":return this.applyDataCorruptionGlitch(t)}}catch(t){return console.warn("Glitch effect failed:",t),null}}applyRGBShiftGlitch(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{i.clearRect(0,0,t.width,t.height);let r=q.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),n=Math.floor(20*r),s=this.generateRandomOffset(n),l=this.generateRandomOffset(n,.3),a=this.generateRandomOffset(-n),o=q.createTempCanvas(t.width,t.height),h=o.getContext("2d");h.drawImage(t,0,0);let u=h.getImageData(0,0,t.width,t.height),d=q.extractChannel(u,0),c=q.extractChannel(u,1),p=q.extractChannel(u,2);return i.globalCompositeOperation="screen",h.clearRect(0,0,t.width,t.height),h.putImageData(d,0,0),i.drawImage(o,s.x,s.y),h.clearRect(0,0,t.width,t.height),h.putImageData(c,0,0),i.drawImage(o,l.x,l.y),h.clearRect(0,0,t.width,t.height),h.putImageData(p,0,0),i.drawImage(o,a.x,a.y),i.globalCompositeOperation="source-over",e.canvas}catch(t){return console.warn("RGB shift glitch failed:",t),null}}applyDigitalDistortionGlitch(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r=i.getImageData(0,0,t.width,t.height),n=q.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),s=this.processDigitalDistortion(r,n);return i.clearRect(0,0,t.width,t.height),i.putImageData(s,0,0),e.canvas}catch(t){return console.warn("Digital distortion glitch failed:",t),null}}applyScanLineGlitch(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r=q.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),n=Math.max(2,Math.floor(10-8*r));i.globalCompositeOperation="multiply";for(let e=0;e<t.height;e+=n)if(Math.random()<r){let n=.1+.4*r;i.fillStyle=`rgba(0, 0, 0, ${n})`,i.fillRect(0,e,t.width,1)}i.globalCompositeOperation="screen";let s=Math.floor(20*r);for(let e=0;e<s;e++){let e=Math.random()*t.height,n=.3*r;i.fillStyle=`rgba(255, 255, 255, ${n})`,i.fillRect(0,Math.floor(e),t.width,1)}return i.globalCompositeOperation="source-over",e.canvas}catch(t){return console.warn("Scan line glitch failed:",t),null}}applyDataCorruptionGlitch(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r=i.getImageData(0,0,t.width,t.height),n=q.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),s=this.processDataCorruption(r,n);return i.clearRect(0,0,t.width,t.height),i.putImageData(s,0,0),e.canvas}catch(t){return console.warn("Data corruption glitch failed:",t),null}}generateRandomOffset(t,e=1){return{x:(Math.random()-.5)*t,y:(Math.random()-.5)*t*e}}processDigitalDistortion(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i),l=Math.floor(20*e)+5,a=Math.floor(n/l);for(let t=0;t<l;t++)if(Math.random()<e){let i=t*a,l=Math.min(i+a,n),o=Math.floor((Math.random()-.5)*r*e*.1);this.shiftSliceHorizontal(s,r,n,i,l,o)}let o=.3*e;for(let t=0;t<i.length;t+=4)Math.random()<o&&(s[t]=255*Math.random(),s[t+1]=255*Math.random(),s[t+2]=255*Math.random());return new ImageData(s,r,n)}shiftSliceHorizontal(t,e,i,r,n,s){let l=new Uint8ClampedArray(4*e);for(let i=r;i<n;i++){let r=i*e*4;for(let i=0;i<4*e;i++)l[i]=t[r+i];for(let i=0;i<e;i++){let n=r+4*i,a=(i-s+e)%e*4;t[n]=l[a],t[n+1]=l[a+1],t[n+2]=l[a+2],t[n+3]=l[a+3]}}}processDataCorruption(t,e){let{data:i,width:r,height:n}=t,s=new Uint8ClampedArray(i),l=Math.floor(15*e)+5;for(let t=0;t<l;t++)if(Math.random()<e){let t=Math.floor(Math.random()*r),e=Math.floor(5*Math.random())+1,i=.5>Math.random()?0:255;for(let l=0;l<n;l++)for(let n=0;n<e&&t+n<r;n++){let e=4*(l*r+t+n);s[e]=i,s[e+1]=i,s[e+2]=i}}let a=Math.floor(20*e);for(let t=0;t<a;t++){let t=Math.floor(Math.random()*r),e=Math.floor(Math.random()*n),i=Math.floor(20*Math.random())+5,l=Math.floor(10*Math.random())+2;this.corruptBlock(s,r,n,t,e,i,l)}return new ImageData(s,r,n)}corruptBlock(t,e,i,r,n,s,l){for(let a=0;a<l&&n+a<i;a++)for(let i=0;i<s&&r+i<e;i++){let s=4*((n+a)*e+(r+i));.7>Math.random()&&(t[s]=255*Math.random(),t[s+1]=255*Math.random(),t[s+2]=255*Math.random())}}}class ts extends c._j{constructor(t,e,i,r,n){var s,l;super(t,e,i,r,n),this.blurConfig={blurRadius:(null==(s=null==n?void 0:n.options)?void 0:s.blurRadius)||8,useOptimizedBlur:void 0===(null==(l=null==n?void 0:n.options)?void 0:l.useOptimizedBlur)||n.options.useOptimizedBlur}}applyCSSBlur(t,e){let i=K.rF.createCanvas({width:t.width,height:t.height,dpr:K.rF.devicePixelRatio}),r=i.getContext("2d");return r?(r.filter=`blur(${e}px)`,r.drawImage(t,0,0),r.filter="none",i):t}applyDownsampleBlur(t,e){let{width:i,height:r}=t,n=Math.max(1,Math.floor(e/2)),s=Math.floor(i/n),l=Math.floor(r/n),a=K.rF.createCanvas({width:s,height:l,dpr:1}),o=a.getContext("2d");if(!o)return t;let h=K.rF.createCanvas({width:i,height:r,dpr:1}),u=h.getContext("2d");return u?(u.putImageData(t,0,0),o.drawImage(h,0,0,s,l),o.filter=`blur(${e/n}px)`,o.drawImage(a,0,0),o.filter="none",u.clearRect(0,0,i,r),u.drawImage(a,0,0,i,r),u.getImageData(0,0,i,r)):t}afterStageRender(t,e){let i;if(this.blurConfig.blurRadius<=0)return e;if(this.blurConfig.useOptimizedBlur)i=this.applyCSSBlur(e,this.blurConfig.blurRadius);else{let t=K.rF.createCanvas({width:e.width,height:e.height,dpr:K.rF.devicePixelRatio}),r=t.getContext("2d");if(!r)return!1;r.clearRect(0,0,e.width,e.height),r.drawImage(e,0,0);let n=r.getImageData(0,0,e.width,e.height),s=this.applyDownsampleBlur(n,this.blurConfig.blurRadius);r.putImageData(s,0,0),i=t}let r=i.getContext("2d");return r&&(r.globalCompositeOperation="overlay",r.fillStyle="rgba(255, 255, 255, 0.1)",r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="source-over"),i}}class tl extends ${constructor(t,e,i,r,n){var s,l;super(t,e,i,r,n),this.pixelationConfig={maxPixelSize:(null==(s=null==n?void 0:n.options)?void 0:s.maxPixelSize)||20,method:(null==(l=null==n?void 0:n.options)?void 0:l.method)||"out"}}applyDownsamplePixelation(t,e){if(e<=1)return t;let{width:i,height:r}=t,n=Math.ceil(i/e),s=Math.ceil(r/e),l=K.rF.createCanvas({width:n,height:s,dpr:1}),a=l.getContext("2d");if(!a)return t;let o=K.rF.createCanvas({width:i,height:r,dpr:K.rF.devicePixelRatio}),h=o.getContext("2d");return h?(a.imageSmoothingEnabled=!1,h.imageSmoothingEnabled=!1,a.drawImage(t,0,0,n,s),h.drawImage(l,0,0,i,r),o):t}updateAnimationProgress(){return"in"===this.pixelationConfig.method?this.pixelationConfig.maxPixelSize-this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1):1+this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1)}afterStageRender(t,e){let i=this.updateAnimationProgress();return i<=1?e:this.applyDownsamplePixelation(e,i)}}let ta=()=>{r.a.registerBuiltInAnimate("increaseCount",y.B),r.a.registerBuiltInAnimate("fromTo",Z.$),r.a.registerBuiltInAnimate("scaleIn",A.O),r.a.registerBuiltInAnimate("scaleOut",A.E),r.a.registerBuiltInAnimate("growHeightIn",o.HQ),r.a.registerBuiltInAnimate("growHeightOut",o.qG),r.a.registerBuiltInAnimate("growWidthIn",d.dR),r.a.registerBuiltInAnimate("growWidthOut",d.yi),r.a.registerBuiltInAnimate("growCenterIn",a.W),r.a.registerBuiltInAnimate("growCenterOut",a.B),r.a.registerBuiltInAnimate("clipIn",n.b),r.a.registerBuiltInAnimate("clipOut",n.v),r.a.registerBuiltInAnimate("fadeIn",s.U),r.a.registerBuiltInAnimate("fadeOut",s.D),r.a.registerBuiltInAnimate("growPointsIn",h.Kk),r.a.registerBuiltInAnimate("growPointsOut",h.Yf),r.a.registerBuiltInAnimate("growPointsXIn",h.xJ),r.a.registerBuiltInAnimate("growPointsXOut",h.$m),r.a.registerBuiltInAnimate("growPointsYIn",h.yQ),r.a.registerBuiltInAnimate("growPointsYOut",h.rf),r.a.registerBuiltInAnimate("growAngleIn",l.kj),r.a.registerBuiltInAnimate("growAngleOut",l.j2),r.a.registerBuiltInAnimate("growRadiusIn",u.$),r.a.registerBuiltInAnimate("growRadiusOut",u.em),r.a.registerBuiltInAnimate("moveIn",j.V8),r.a.registerBuiltInAnimate("moveOut",j.vW),r.a.registerBuiltInAnimate("rotateIn",G.hD),r.a.registerBuiltInAnimate("rotateOut",G.XN),r.a.registerBuiltInAnimate("update",N.B),r.a.registerBuiltInAnimate("state",M.Z),r.a.registerBuiltInAnimate("labelItemAppear",f),r.a.registerBuiltInAnimate("labelItemDisappear",m),r.a.registerBuiltInAnimate("poptipAppear",v),r.a.registerBuiltInAnimate("poptipDisappear",b),r.a.registerBuiltInAnimate("inputText",p),r.a.registerBuiltInAnimate("inputRichText",x),r.a.registerBuiltInAnimate("outputRichText",C),r.a.registerBuiltInAnimate("slideRichText",w),r.a.registerBuiltInAnimate("slideOutRichText",S),r.a.registerBuiltInAnimate("slideIn",T),r.a.registerBuiltInAnimate("growIn",R),r.a.registerBuiltInAnimate("spinIn",B),r.a.registerBuiltInAnimate("moveScaleIn",I),r.a.registerBuiltInAnimate("moveRotateIn",L),r.a.registerBuiltInAnimate("strokeIn",P),r.a.registerBuiltInAnimate("slideOut",F),r.a.registerBuiltInAnimate("growOut",O),r.a.registerBuiltInAnimate("spinOut",D),r.a.registerBuiltInAnimate("moveScaleOut",H),r.a.registerBuiltInAnimate("moveRotateOut",z),r.a.registerBuiltInAnimate("strokeOut",E),r.a.registerBuiltInAnimate("pulse",W),r.a.registerBuiltInAnimate("MotionPath",V),r.a.registerBuiltInAnimate("streamLight",U.G),r.a.registerBuiltInAnimate("dissolve",Q),r.a.registerBuiltInAnimate("grayscale",te),r.a.registerBuiltInAnimate("distortion",ti),r.a.registerBuiltInAnimate("particle",tr),r.a.registerBuiltInAnimate("glitch",tn),r.a.registerBuiltInAnimate("gaussianBlur",ts),r.a.registerBuiltInAnimate("pixelation",tl)}},60678:function(t,e,i){"use strict";i.d(e,{XN:()=>u,hD:()=>h});var r=i(25258),n=i(70501),s=i(43682);let l=(t,e)=>{var i;let s=null!=(i=t.getFinalAttribute().angle)?i:0,l=0;return{from:{angle:(0,r.Yt)(s/(2*Math.PI),0)?Math.round(s/(2*Math.PI))*Math.PI*2:(0,n.Z)(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(s/(2*Math.PI))*Math.PI*2:Math.floor(s/(2*Math.PI))*Math.PI*2},to:{angle:s}}},a=(t,e)=>{var i;let s=null!=(i=t.getFinalAttribute().angle)?i:0,l=0;return l=(0,r.Yt)(s/(2*Math.PI),0)?Math.round(s/(2*Math.PI))*Math.PI*2:(0,n.Z)(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(s/(2*Math.PI))*Math.PI*2:Math.floor(s/(2*Math.PI))*Math.PI*2,{from:{angle:s},to:{angle:l}}};class o extends s.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class h extends o{onBind(){var t;super.onBind();let{from:e,to:i}=l(this.target,this.params.options);this.props=i,this.propKeys=["angle"],this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}}class u extends o{onBind(){super.onBind();let{from:t,to:e}=a(this.target,this.params.options);this.props=e,this.propKeys=["angle"],this.from=t,this.to=e}}},60116:function(t,e,i){"use strict";i.d(e,{E:()=>s,O:()=>n});var r=i(43682);class n extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n,s,l,a,o,h,u;let d,c;super.onBind();let p=this.target.getFinalAttribute(),g=null!=(t=this.target.attribute)?t:{};switch(null==(e=this.params)?void 0:e.direction){case"x":d={scaleX:null!=(i=g.scaleX)?i:0},c={scaleX:null!=(r=null==p?void 0:p.scaleX)?r:1},this._updateFunction=this.updateX;break;case"y":d={scaleY:null!=(n=g.scaleY)?n:0},c={scaleY:null!=(s=null==p?void 0:p.scaleY)?s:1},this._updateFunction=this.updateY;break;default:d={scaleX:null!=(l=g.scaleX)?l:0,scaleY:null!=(a=g.scaleY)?a:0},c={scaleX:null!=(o=null==p?void 0:p.scaleX)?o:1,scaleY:null!=(h=null==p?void 0:p.scaleY)?h:1},this._updateFunction=this.updateXY}let f=this.target.getFinalAttribute();f&&this.target.setAttributes(f),this.props=c,this.from=d,this.to=c,!1!==(null==(u=this.params.controlOptions)?void 0:u.immediatelyApply)&&this.target.setAttributes(d)}onEnd(t){super.onEnd(t)}updateX(t){this.target.attribute.scaleX=this.from.scaleX+(this.to.scaleX-this.from.scaleX)*t}updateY(t){this.target.attribute.scaleY=this.from.scaleY+(this.to.scaleY-this.from.scaleY)*t}updateXY(t){this.updateX(t),this.updateY(t)}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];let e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateXY:"scaleX"===this.propKeys[0]?this._updateFunction=this.updateX:"scaleY"===this.propKeys[0]?this._updateFunction=this.updateY:this._updateFunction=null}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag())}}class s extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n;let s,l;super.onBind();let a=this.target.attribute;switch(null==(t=this.params)?void 0:t.direction){case"x":s={scaleX:null!=(e=null==a?void 0:a.scaleX)?e:1},l={scaleX:0};break;case"y":s={scaleY:null!=(i=null==a?void 0:a.scaleY)?i:1},l={scaleY:0};break;default:s={scaleX:null!=(r=null==a?void 0:a.scaleX)?r:1,scaleY:null!=(n=null==a?void 0:a.scaleY)?n:1},l={scaleX:0,scaleY:0}}this.props=l,this.from=s,this.to=l}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}}},48110:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(43682);class n extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.fromProps[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}},30380:function(t,e,i){"use strict";i.d(e,{G:()=>h});var r=i(16049),n=i(33974),s=i(17209),l=i(76989),a=i(43682),o=i(41457);class h extends a.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}getEndProps(){return{}}onStart(){this.target&&("rect"===this.target.type?this.onStartRect():"line"===this.target.type?this.onStartLineOrArea("line"):"area"===this.target.type&&this.onStartLineOrArea("area"))}onStartLineOrArea(t){var e;let i=this.target.attachShadow(),s=r.w.graphicService.creator[t](Object.assign({},null==(e=this.params)?void 0:e.attribute));this[t]=s,s.pathProxy=new n.r,i.add(s)}onStartRect(){var t,e,i;let n=this.target.attachShadow(),s=null==(e=null==(t=this.params)?void 0:t.isHorizontal)||e,l=s?"height":"width",a=this.target.AABBBounds[l](),o=s?0:this.target.AABBBounds.y1,h=r.w.graphicService.creator.rect(Object.assign(Object.assign({[l]:a,fill:"#bcdeff",shadowBlur:30,shadowColor:"#bcdeff"},null==(i=this.params)?void 0:i.attribute),{x:0,y:o,[s?"width":"height"]:0}));this.rect=h,n.add(h)}onBind(){}onEnd(){this.target.detachShadow()}onUpdate(t,e,i){return this.rect?this.onUpdateRect(t,e,i):this.line||this.area?this.onUpdateLineOrArea(t,e,i):void 0}onUpdateRect(t,e,i){var r,n,l,a,o,h,u,d,c,p,g,f,m,y,v,b;let _=null==(n=null==(r=this.params)?void 0:r.isHorizontal)||n,x=this.target.attribute;if(_){let i=null!=(a=null!=(l=x.width)?l:Math.abs(x.x1-x.x))?a:250,r=null!=(h=null==(o=this.params)?void 0:o.streamLength)?h:i,n=null!=(c=null==(d=null==(u=this.params)?void 0:u.attribute)?void 0:d.width)?c:60,p=-n,g=p+(r-p)*e,f=Math.max(g,0),m=Math.min(Math.min(g+n,n),r-g),y=m+f>i?Math.max(i-f,0):m;this.rect.setAttributes({x:f+Math.min(x.x1-x.x,0),width:y},!1,{type:s.Gk.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}else{let i,r=null!=(g=null!=(p=x.height)?p:Math.abs(x.y1-x.y))?g:250,n=null!=(m=null==(f=this.params)?void 0:f.streamLength)?m:r,l=null!=(b=null==(v=null==(y=this.params)?void 0:y.attribute)?void 0:v.height)?b:60,a=r-(n+l)*e,o=Math.min(a,r),h=Math.min(r-a,l);o<=0?(i=Math.max(o+h,0),o=0):i=h,this.rect.setAttributes({y:o+Math.min(x.y1-x.y,0),height:i},!1,{type:s.Gk.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}}onUpdateLineOrArea(t,e,i){let r=this.line||this.area;if(!r)return;let n=r.pathProxy,s=this.target;s.cache||s.cacheArea?this._onUpdateLineOrAreaWithCache(n,s,t,e,i):this._onUpdateLineWithoutCache(n,s,t,e,i);let l=s.attribute;r.setAttributes(Object.assign({stroke:l.stroke},r.attribute)),r.addUpdateBoundTag()}_onUpdateLineOrAreaWithCache(t,e,i,r,n){var s,l;if(t.clear(),"line"===e.type){let i=e.cache;Array.isArray(i)||(i=[i]);let n=i.reduce((t,e)=>t+e.getLength(),0),s=[];return i.forEach(t=>{t.curves.forEach(t=>s.push(t))}),this._updateCurves(t,s,n,r)}if("area"===e.type&&(null==(l=null==(s=e.cacheArea)?void 0:s.top)?void 0:l.curves)){let i=e.cacheArea,n=i.top.curves.reduce((t,e)=>t+e.getLength(),0);return this._updateCurves(t,i.top.curves,n,r)}}_updateCurves(t,e,i,r){var n,s;let a=i*r,o=Math.min(a+(null!=(s=null==(n=this.params)?void 0:n.streamLength)?s:10),i),h=0,u=!1;for(let i=0;i<e.length;i++)if(!1!==e[i].defined){let r=e[i],n=r.getLength(),s=1-(h+n-a)/n,d,c=1-(h+n-o)/n;if(h<a&&h+n>a)if(u=!0,r.p2&&r.p3){let[e,i]=(0,l.m)(r,s);t.moveTo(i.p0.x,i.p0.y),d=i}else{let e=r.getPointAt(s);t.moveTo(e.x,e.y)}if(h<o&&h+n>o){if(r.p2&&r.p3){d&&(c=(o-a)/d.getLength());let[e]=(0,l.m)(d||r,c);t.bezierCurveTo(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y)}else{let e=r.getPointAt(c);t.lineTo(e.x,e.y)}break}if(u)if(r.p2&&r.p3){let e=d||r;t.bezierCurveTo(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y)}else t.lineTo(r.p1.x,r.p1.y);h+=n}}_onUpdateLineWithoutCache(t,e,i,r,n){var s,l;let{points:a,curveType:h}=e.attribute;if(!a||a.length<2||"linear"!==h)return;let u=0;for(let t=1;t<a.length;t++)u+=o.HL.distancePP(a[t],a[t-1]);let d=u*r,c=Math.min(d+(null!=(l=null==(s=this.params)?void 0:s.streamLength)?l:10),u),p=[],g=0;for(let t=1;t<a.length;t++){let e=o.HL.distancePP(a[t],a[t-1]);if(g<d&&g+e>d&&p.push(o.HL.pointAtPP(a[t-1],a[t],1-(g+e-d)/e)),g<c&&g+e>c){p.push(o.HL.pointAtPP(a[t-1],a[t],1-(g+e-c)/e));break}p.length&&p.push(a[t]),g+=e}if(p.length&&!(p.length<2)){t.clear(),t.moveTo(p[0].x,p[0].y);for(let e=1;e<p.length;e++)t.lineTo(p[e].x,p[e].y)}}}},89258:function(t,e,i){"use strict";i.d(e,{B:()=>n});var r=i(43682);class n extends r.rd{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e;super.onBind();let{diffAttrs:i={}}=null!=(t=this.target.context)?t:{},{options:r}=this.params;i=Object.assign({},i),(null==(e=null==r?void 0:r.excludeChannels)?void 0:e.length)&&r.excludeChannels.forEach(t=>{delete i[t]}),this.props=i}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.fromProps[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i)}}},92851:function(t,e,i){"use strict";i.d(e,{a:()=>l});var r=i(41075),n=i(31535),s=i(98116);class l{static registerBuiltInAnimate(t,e){l.builtInAnimateMap[t]=e}constructor(t){this._animates=[],this._startCallbacks=[],this._endCallbacks=[],this._started=!1,this._activeCount=0,this._target=t}get started(){return this._started}onStart(t){t?(this._startCallbacks.push(t),this._started&&this._activeCount>0&&t()):this._startCallbacks.forEach(t=>{t()})}onEnd(t){t?this._endCallbacks.push(t):this._endCallbacks.forEach(t=>{t()})}_trackAnimation(t){this._animates.push(t),this._activeCount++,1!==this._activeCount||this._started||(this._started=!0,this.onStart()),t.onEnd(()=>{this._activeCount--;let e=this._animates.indexOf(t);e>=0&&this._animates.splice(e,1),0===this._activeCount&&this._started&&(this._started=!1,this.onEnd())})}parseParams(t,e,i){var r,a;let o=this.resolveValue(t.totalTime,void 0,void 0),h=this.resolveValue(t.startTime,void 0,0),u=Object.assign({},t);u.oneByOneDelay=0,u.startTime=h,u.totalTime=o;let d=this.resolveValue(t.oneByOne,i,!1);if(e){let t=u.timeSlices;(0,n.Z)(t)||(u.timeSlices=[t]);let e=0;u.timeSlices=u.timeSlices.map(t=>{let r=this.resolveValue(t.delay,i,0),n=this.resolveValue(t.delayAfter,i,0),s=this.resolveValue(t.duration,i,300);return e+=r+s+n,Object.assign(Object.assign({},t),{delay:r,delayAfter:n,duration:s})});let r=0;d&&(r="number"==typeof d?d:d?e:0),u.oneByOneDelay=r;let a=1;if(o){let t=e+r*(this._target.count-2);a=o?o/t:1}u.timeSlices=u.timeSlices.map(t=>{let e=t.effects;return Array.isArray(e)||(e=[e]),Object.assign(Object.assign({},t),{delay:t.delay*a,delayAfter:t.delayAfter*a,duration:t.duration*a,effects:e.map(t=>{var e,i;let r=null!=(e=t.custom)?e:l.builtInAnimateMap[null!=(i=t.type)?i:"fromTo"],n=r&&(0,s.Z)(r)?/^class\s/.test(Function.prototype.toString.call(r))?1:2:0;return Object.assign(Object.assign({},t),{custom:r,customType:n})})})}),u.oneByOneDelay=r*a,u.startTime=h*a}else{let e=this.resolveValue(t.delay,i,0),n=this.resolveValue(t.delayAfter,i,0),c=this.resolveValue(t.duration,i,300),p=0;d&&(p="number"==typeof d?d:d?e+n+c:0),u.oneByOneDelay=p,u.custom=null!=(r=t.custom)?r:l.builtInAnimateMap[null!=(a=t.type)?a:"fromTo"];let g=u.custom&&(0,s.Z)(u.custom)?/^class\s/.test(Function.prototype.toString.call(u.custom))?1:2:0;if(u.customType=g,o){let t=e+n+c+p*(this._target.count-2),i=o?o/t:1;u.delay=e*i,u.delayAfter=n*i,u.duration=c*i,u.oneByOneDelay=p*i,u.startTime=h}}return u}execute(t){Array.isArray(t)?t.forEach(t=>this._execute(t)):this._execute(t)}_execute(t){let e;if(t.selfOnly)return this._executeItem(t,this._target,0,1);let i="timeSlices"in t;i&&t.partitioner&&(e=(null!=e?e:this._target.getChildren()).filter(e=>{var i,r;return t.partitioner(null==(r=null==(i=e.context)?void 0:i.data)?void 0:r[0],e,{})})),i&&t.sort&&(e=null!=e?e:this._target.getChildren()).sort((e,i)=>{var r,n,s,l;return t.sort(null==(n=null==(r=e.context)?void 0:r.data)?void 0:n[0],null==(l=null==(s=i.context)?void 0:s.data)?void 0:l[0],e,i,{})});let r=i?(e,r,n)=>{let s=this.parseParams(t,i,e),l=this.executeTimelineItem(s,e,r,n);l&&this._trackAnimation(l)}:(e,r,n)=>{let s=this.parseParams(t,i,e),l=this.executeTypeConfigItem(s,e,r,n);l&&this._trackAnimation(l)};e?e.forEach((t,i)=>r(t,i,e.length)):this._target.count<=1?r(this._target,0,1):this._target.forEachChildren((t,e)=>r(t,e,this._target.count-1))}executeTypeConfigItem(t,e,i,r){var n,l,a,o,h,u,d,c;let{type:p="fromTo",channel:g,customParameters:f,easing:m="linear",delay:y=0,delayAfter:v=0,duration:b=300,startTime:_=0,oneByOneDelay:x=0,loop:C,bounce:w,priority:S=0,options:A,custom:M,customType:k,controlOptions:T}=t,R=e.animate();R.priority=S;let B=(0,s.Z)(y)?y(null==(l=null==(n=e.context)?void 0:n.data)?void 0:l[0],e,{}):y,P=null==(o=null==(a=e.context)?void 0:a.data)?void 0:o[0],E=null==(h=e.context)?void 0:h.indexKey;P&&E&&(i=null!=(u=P[E])?u:i),R.startAt(_);let I=i*x+B;I>0&&R.wait(I);let L=null,F=t.to,O=t.from;F||(L||(L=this.createPropsFromChannel(g,e)),F=L.props),O||(L||(L=this.createPropsFromChannel(g,e)),O=L.from),this._handleRunAnimate(R,M,k,O,F,b,m,f,T,A,p,e);let D=0;x&&(D=x*(r-i-1));let H=(0,s.Z)(v)?v(null==(c=null==(d=e.context)?void 0:d.data)?void 0:c[0],e,{}):v;return H>0&&(D+=H),D>0&&R.wait(D),C&&C>0&&R.loop(C),w&&R.bounce(!0),R}_handleRunAnimate(t,e,i,r,n,l,a,o,h,u,d,c){var p,g,f,m,y,v;if(e&&i){let d=Object.assign({width:(null==(p=c.stage)?void 0:p.width)||0,height:(null==(g=c.stage)?void 0:g.height)||0,group:this._target.parent},this.resolveValue(o,c)),b=(0,s.Z)(u)?u.call(null,null!=(m=d&&(null==(f=d.data)?void 0:f[0]))?m:null==(v=null==(y=c.context)?void 0:y.data)?void 0:v[0],c,d):u;d.options=b,d.controlOptions=h,1===i?this.createCustomAnimation(t,e,r,n,l,a,d):2===i&&this.createCustomInterpolatorAnimation(t,e,n,l,a,d)}else"to"===d?t.to(n,l,a):"from"===d&&t.from(n,l,a)}executeTimelineItem(t,e,i,r){var n,s,l,a;let{timeSlices:o,startTime:h=0,loop:u,bounce:d,oneByOneDelay:c,priority:p,controlOptions:g}=t,f=null==(s=null==(n=e.context)?void 0:n.data)?void 0:s[0],m=null==(l=e.context)?void 0:l.indexKey;f&&m&&(i=null!=(a=f[m])?a:i);let y=e.animate();return y.priority=p,y.startAt(h),y.wait(i*c),u&&u>0&&y.loop(u),d&&y.bounce(!0),(Array.isArray(o)?o:[o]).forEach(t=>{this.applyTimeSliceToAnimate(t,y,e,g)}),c&&y.wait(c*(r-i-1)),y}applyTimeSliceToAnimate(t,e,i,r){var n,a,o,h;let{effects:u,duration:d=300,delay:c=0,delayAfter:p=0}=t,g=(0,s.Z)(c)?c(null==(a=null==(n=i.context)?void 0:n.data)?void 0:a[0],i,{}):c,f=(0,s.Z)(p)?p(null==(h=null==(o=i.context)?void 0:o.data)?void 0:h[0],i,{}):p;g>0&&e.wait(g),(Array.isArray(u)?u:[u]).forEach(t=>{var n;let{type:s="fromTo",channel:a,customParameters:o,easing:h="linear",options:u}=t,c=null,p=t.to,g=t.from;p||(c||(c=this.createPropsFromChannel(a,i)),p=c.props),g||(c||(c=this.createPropsFromChannel(a,i)),g=c.from);let f=null!=(n=t.custom)?n:l.builtInAnimateMap[s],m=t.customType;this._handleRunAnimate(e,f,m,g,p,d,h,o,r,u,s,i)}),f>0&&e.wait(f)}createCustomInterpolatorAnimation(t,e,i,r,n,s){let l={};Object.keys(i).forEach(e=>{l[e]=t.target.getComputedAttribute(e)}),t.interpolateUpdateFunction=(i,r,n,l,a)=>{e(n,i,r,l,a,t.target,s)},t.to(i,r,n)}createCustomAnimation(t,e,i,r,n,s,l){let a=new e(i,r,n,s,l);t.play(a)}createPropsFromChannel(t,e){let i={},r=null;return t&&(Array.isArray(t)?t.forEach(t=>{var r,n;let s=null==(n=null==(r=e.context)?void 0:r.diffAttrs)?void 0:n[t];void 0!==s&&(i[t]=s)}):Object.keys(t).forEach(n=>{var s,l,a,o;let h=t[n];void 0!==h.to&&("function"==typeof h.to?i[n]=h.to(null==(l=null==(s=e.context)?void 0:s.data)?void 0:l[0],e,{}):i[n]=h.to),void 0!==h.from&&(r||(r={}),"function"==typeof h.from?r[n]=h.from(null==(o=null==(a=e.context)?void 0:a.data)?void 0:o[0],e,{}):r[n]=h.from)})),{from:r,props:i}}resolveValue(t,e,i){var r,n;return void 0===t?i:"function"==typeof t&&e?t(null==(n=null==(r=e.context)?void 0:r.data)?void 0:n[0],e,{}):t}executeItem(t,e,i=0,r=1){return Array.isArray(t)?t.map(t=>this._executeItem(t,e,i,r)).filter(Boolean):[this._executeItem(t,e,i,r)].filter(Boolean)}_executeItem(t,e,i=0,r=1){if(!e)return null;let n="timeSlices"in t,s=null,l=this.parseParams(t,n);return(s=n?this.executeTimelineItem(l,e,i,r):this.executeTypeConfigItem(l,e,i,r))&&this._trackAnimation(s),s}stop(t,e=!0){for(;this._animates.length>0;){let i=this._animates.pop();!1===e&&(i.status=r.t.END),null==i||i.stop(t)}this._animates=[],this._activeCount=0,this._started&&(this._started=!1,e&&this.onEnd())}}l.builtInAnimateMap={}},21964:function(t,e,i){"use strict";i.d(e,{d:()=>_});var r=i(26670),n=i(87986),s=i(76554),l=i(92851),a=i(31535);let o="appear",h="disappear",u="update",d="highlight",c="unhighlight";class p{constructor(t){this.graphic=t}registerState(t){this.states||(this.states=new Map),this.states.set(t.name,t)}clearStates(){var t;null==(t=this.states)||t.clear()}}class g{constructor(t){this.stateList=null,this.graphic=t}applyState(t,e,i){let r=s.X.getInstance(),n=[],o=[];if(this.stateList&&this.stateList.length?t.forEach((t,i)=>{let s={allowTransition:!0};this.stateList.forEach(e=>{let i=r.isTransitionAllowed(e.state,t,this.graphic);s.allowTransition=s.allowTransition&&i.allowTransition}),s.allowTransition&&(o.push({state:t,animationConfig:(0,a.Z)(e[i])?e[i].map(t=>t.animation):e[i].animation,executor:new l.a(this.graphic)}),this.stateList.forEach(e=>{r.isTransitionAllowed(e.state,t,this.graphic).stopOriginalTransition&&n.push(e)}))}):t.forEach((t,i)=>{o.push({state:t,animationConfig:(0,a.Z)(e[i])?e[i].map(t=>t.animation):e[i].animation,executor:new l.a(this.graphic)})}),n.forEach(t=>{t.executor.stop(null,!1)}),o.length){o[0].executor.execute(o[0].animationConfig);for(let t=0;t<o.length;t++){let e=o[t+1],r=o[t];r.executor.onEnd(()=>{e&&e.executor.execute(e.animationConfig),this.stateList=this.stateList.filter(t=>t!==r),t===o.length-1&&i&&i(!1)})}}else i&&i(!0);this.stateList?this.stateList=this.stateList.filter(t=>!n.includes(t)):this.stateList=[],this.stateList.push(...o)}applyAppearState(t,e){this.applyState([o],[{name:o,animation:t}],e)}applyDisappearState(t,e){this.applyState([h],[{name:h,animation:t}],e)}applyUpdateState(t,e){this.applyState([u],[{name:u,animation:t}],e)}applyHighlightState(t,e){this.applyState([d],[{name:d,animation:t}],e)}applyUnhighlightState(t,e){this.applyState([c],[{name:c,animation:t}],e)}stopState(t,e){var i;let r=null==(i=this.stateList)?void 0:i.find(e=>e.state===t);r&&r.executor.stop(e)}clearState(){var t;null==(t=this.stateList)||t.forEach(t=>{t.executor.stop(null,!1)}),this.stateList=null}reApplyState(t){var e;let i=null==(e=this.stateList)?void 0:e.find(e=>e.state===t);if(i&&i.executor.started){let t=this.stateList.slice();i.executor.stop(),this.stateList=t,i.executor.execute(i.animationConfig)}}}class f{_getAnimationStateManager(t){return t._animationStateManager||(t._animationStateManager=new g(t)),t._animationStateManager}_getAnimationStateStore(t){return t._animationStateStore||(t._animationStateStore=new p(t)),t._animationStateStore}registerAnimationState(t){return this._getAnimationStateStore(this).registerState(t),this}applyAnimationState(t,e,i){return this._getAnimationStateManager(this).applyState(t,e,i),this}applyAppearState(t,e){return this._getAnimationStateManager(this).applyAppearState(t,e),this}applyDisappearState(t,e){return this._getAnimationStateManager(this).applyDisappearState(t,e),this}applyUpdateState(t,e){return this._getAnimationStateManager(this).applyUpdateState(t,e),this}applyHighlightState(t,e){return this._getAnimationStateManager(this).applyHighlightState(t,e),this}applyUnhighlightState(t,e){return this._getAnimationStateManager(this).applyUnhighlightState(t,e),this}stopAnimationState(t,e,i=!1){return this._getAnimationStateManager(this).stopState(t,e),i&&this.isContainer&&this.forEachChildren(r=>{r.stopAnimationState(t,e,i)}),this}clearAnimationStates(){let t=this._animationStateManager;return t&&t.clearState(),this}reApplyAnimationState(t,e=!1){let i=this._animationStateManager;return i&&i.reApplyState(t),e&&this.isContainer&&this.forEachChildren(i=>{i.reApplyAnimationState(t,e)}),this}static extend(t){return(new f)._getAnimationStateManager(t),t}}var m=i(88764),y=i(32190),v=i(60831);class b{getAttributes(t=!1){return t&&this.finalAttribute?this.finalAttribute:this.attribute}animate(t){var e,i,r;let n=new m.r(null==t?void 0:t.id,null!=(i=null!=(e=null==t?void 0:t.timeline)?e:this.stage&&this.stage.getTimeline())?i:y.P,null==t?void 0:t.slience);if(n.bind(this),t){let{onStart:e,onEnd:i,onRemove:r}=t;null!=e&&n.onStart(e),null!=i&&n.onEnd(i),null!=r&&n.onRemove(r)}return null==(r=this.stage)||r.ticker.start(),n}createTimeline(){return new y.L}createTicker(t){return new v.H(t)}setFinalAttributes(t){this.finalAttribute||(this.finalAttribute={}),Object.assign(this.finalAttribute,t)}initFinalAttributes(t){this.finalAttribute=t}initAnimateExecutor(){this._animateExecutor||(this._animateExecutor=new l.a(this))}executeAnimation(t){return this.initAnimateExecutor(),this._animateExecutor.execute(t),this}executeAnimations(t){return this.initAnimateExecutor(),t.forEach(t=>{this._animateExecutor.execute(t)}),this}getFinalAttribute(){return this.finalAttribute}getGraphicAttribute(t,e=!1){return!e&&this.finalAttribute?this.finalAttribute[t]:this.attribute[t]}pauseAnimation(t=!1){this.animates&&this.animates.forEach(t=>t.pause()),t&&this.isContainer&&this.forEachChildren(e=>{e.pauseAnimation(t)})}resumeAnimation(t=!1){this.animates&&this.animates.forEach(t=>t.resume()),t&&this.isContainer&&this.forEachChildren(e=>{e.resumeAnimation(t)})}stopAnimation(t=!1){this.animates&&this.animates.forEach(t=>t.stop()),t&&this.isContainer&&this.forEachChildren(e=>{e.stopAnimation(t)})}}function _(){(0,n.jB)(r.zs,f),(0,n.jB)(r.zs,b)}},76554:function(t,e,i){"use strict";i.d(e,{X:()=>r});class r{constructor(){this.transitions=new Map,this.registerDefaultTransitions()}static getInstance(){return r.instance||(r.instance=new r),r.instance}registerDefaultTransitions(){this.registerTransition("appear","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("appear","appear",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("appear","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("appear","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("normal","normal",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("normal","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("exit","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","enter",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","exit",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("enter","enter",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("enter","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("disappear","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("disappear","appear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("update","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("state","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","exit",()=>({allowTransition:!0,stopOriginalTransition:!0}))}isTransitionAllowed(t,e,i){var r,n,s,l;let a=null==(r=this.transitions.get(t))?void 0:r.get(e);return a||(a=null==(n=this.transitions.get(t))?void 0:n.get("*"))||(a=null==(s=this.transitions.get("*"))?void 0:s.get(e))||(a=null==(l=this.transitions.get("*"))?void 0:l.get("*"))?a(i,t):{allowTransition:!0,stopOriginalTransition:!0}}registerTransition(t,e,i){let r=this.transitions.get(t);r||(r=new Map,this.transitions.set(t,r)),r.set(e,i)}}r.getInstance()},62722:function(t,e,i){"use strict";i.d(e,{h:()=>p,o:()=>g});var r=i(40398),n=i(38705),s=i(88504);class l{constructor(){}static linear(t){return t}static none(){return this.linear}static get(t){return t<-1?t=-1:t>1&&(t=1),function(e){return 0===t?e:t<0?e*(-(e*t)+1+t):e*((2-e)*t+(1-t))}}static getPowIn(t){return function(e){return Math.pow(e,t)}}static getPowOut(t){return function(e){return 1-Math.pow(1-e,t)}}static getPowInOut(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}static getBackIn(t){return function(e){return e*e*((t+1)*e-t)}}static getBackOut(t){return function(e){return--e*e*((t+1)*e+t)+1}}static getBackInOut(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}static sineIn(t){return 1-Math.cos(t*Math.PI/2)}static sineOut(t){return Math.sin(t*Math.PI/2)}static sineInOut(t){return-(Math.cos(Math.PI*t)-1)/2}static expoIn(t){return 0===t?0:Math.pow(2,10*t-10)}static expoOut(t){return 1===t?1:1-Math.pow(2,-10*t)}static expoInOut(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}static circIn(t){return-(Math.sqrt(1-t*t)-1)}static circOut(t){return Math.sqrt(1- --t*t)}static circInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}static bounceOut(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}static bounceIn(t){return 1-l.bounceOut(1-t)}static bounceInOut(t){return t<.5?.5*l.bounceIn(2*t):.5*l.bounceOut(2*t-1)+.5}static getElasticIn(t,e){return function(i){if(0===i||1===i)return i;let r=e/s.f7*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*s.f7/e)}}static getElasticOut(t,e){return function(i){if(0===i||1===i)return i;let r=e/s.f7*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-r)*s.f7/e)+1}}static getElasticInOut(t,e){return function(i){let r=e/s.f7*Math.asin(1/t);return(i*=2)<1?-(t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*s.f7/e)*.5):t*Math.pow(2,-10*(i-=1))*Math.sin((i-r)*s.f7/e)*.5+1}}static registerFunc(t,e){l[t]=e}}l.quadIn=l.getPowIn(2),l.quadOut=l.getPowOut(2),l.quadInOut=l.getPowInOut(2),l.cubicIn=l.getPowIn(3),l.cubicOut=l.getPowOut(3),l.cubicInOut=l.getPowInOut(3),l.quartIn=l.getPowIn(4),l.quartOut=l.getPowOut(4),l.quartInOut=l.getPowInOut(4),l.quintIn=l.getPowIn(5),l.quintOut=l.getPowOut(5),l.quintInOut=l.getPowInOut(5),l.backIn=l.getBackIn(1.7),l.backOut=l.getBackOut(1.7),l.backInOut=l.getBackInOut(1.7),l.elasticIn=l.getElasticIn(1,.3),l.elasticOut=l.getElasticOut(1,.3),l.elasticInOut=l.getElasticInOut(1,.3*1.5),l.easeInOutQuad=t=>(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2),l.easeOutElastic=t=>{let e=2*Math.PI/3;return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1},l.easeInOutElastic=t=>{let e=2*Math.PI/4.5;return 0===t?0:1===t?1:t<.5?-Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*e)/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*e)/2+1};for(let t=0;t<10;t++)l[`flicker${t}`]=e=>(function(t,e){let i=1/e,r=1;for(;t>i;)t-=i,r*=-1;let n=r*t/i;return n>0?n:1+n})(e,t);for(let t=2;t<10;t++)l[`aIn${t}`]=e=>t*e*e+(1-t)*e;var a=i(63603),o=i(70749);let h=new class{constructor(){this.opacity=(t,e,i,r,n,s)=>{s.attribute.opacity=e+(i-e)*r},this.baseOpacity=(t,e,i,r,n,s)=>{s.attribute.baseOpacity=e+(i-e)*r},this.fillOpacity=(t,e,i,r,n,s)=>{s.attribute.fillOpacity=e+(i-e)*r},this.strokeOpacity=(t,e,i,r,n,s)=>{s.attribute.strokeOpacity=e+(i-e)*r},this.zIndex=(t,e,i,r,n,s)=>{s.attribute.zIndex=e+(i-e)*r},this.backgroundOpacity=(t,e,i,r,n,s)=>{s.attribute.backgroundOpacity=e+(i-e)*r},this.shadowOffsetX=(t,e,i,r,n,s)=>{s.attribute.shadowOffsetX=e+(i-e)*r},this.shadowOffsetY=(t,e,i,r,n,s)=>{s.attribute.shadowOffsetY=e+(i-e)*r},this.shadowBlur=(t,e,i,r,n,s)=>{s.attribute.shadowBlur=e+(i-e)*r},this.fill=(t,e,i,r,n,s)=>{s.attribute.fill=(0,a.BM)(e,i,r,!1)},this.fillPure=(t,e,i,r,n,s)=>{s.attribute.fill=n.fromParsedProps.fill?(0,a.Ib)(n.fromParsedProps.fill,n.toParsedProps.fill,r):n.toParsedProps.fill},this.stroke=(t,e,i,r,n,s)=>{s.attribute.stroke=(0,a.BM)(e,i,r,!1)},this.strokePure=(t,e,i,r,n,s)=>{s.attribute.stroke=n.fromParsedProps.stroke?(0,a.Ib)(n.fromParsedProps.stroke,n.toParsedProps.stroke,r):n.toParsedProps.stroke},this.width=(t,e,i,r,n,s)=>{s.attribute.width=e+(i-e)*r,s.addUpdateBoundTag()},this.height=(t,e,i,r,n,s)=>{s.attribute.height=e+(i-e)*r,s.addUpdateBoundTag()},this.x=(t,e,i,r,n,s)=>{s.attribute.x=e+(i-e)*r,s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.y=(t,e,i,r,n,s)=>{s.attribute.y=e+(i-e)*r,s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.dx=(t,e,i,r,n,s)=>{s.attribute.dx=e+(i-e)*r,s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.dy=(t,e,i,r,n,s)=>{s.attribute.dy=e+(i-e)*r,s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.angle=(t,e,i,r,n,s)=>{s.attribute.angle=e+(i-e)*r,s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.scaleX=(t,e,i,r,n,s)=>{s.attribute.scaleX=e+(i-e)*r,s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.scaleY=(t,e,i,r,n,s)=>{s.attribute.scaleY=e+(i-e)*r,s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.lineWidth=(t,e,i,r,n,s)=>{s.attribute.lineWidth=e+(i-e)*r,s.addUpdateBoundTag()},this.startAngle=(t,e,i,r,n,s)=>{s.attribute.startAngle=e+(i-e)*r,s.addUpdateBoundTag()},this.endAngle=(t,e,i,r,n,s)=>{s.attribute.endAngle=e+(i-e)*r,s.addUpdateBoundTag()},this.radius=(t,e,i,r,n,s)=>{s.attribute.radius=e+(i-e)*r,s.addUpdateBoundTag()},this.outerRadius=(t,e,i,r,n,s)=>{s.attribute.outerRadius=e+(i-e)*r,s.addUpdateBoundTag()},this.innerRadius=(t,e,i,r,n,s)=>{s.attribute.innerRadius=e+(i-e)*r,s.addUpdateBoundTag()},this.size=(t,e,i,r,n,s)=>{s.attribute.size=e+(i-e)*r,s.addUpdateBoundTag()},this.points=(t,e,i,r,n,s)=>{s.attribute.points=(0,o.SA)(e,i,r),s.addUpdateBoundTag()}}};function u(t,e,i,r,n,s){if(Number.isFinite(i)&&Number.isFinite(e))return s.attribute[t]=e+(i-e)*r,!0;if(Array.isArray(i)&&Array.isArray(e)&&i.length===e.length){let n=[],l=!0;for(let t=0;t<i.length;t++){let s=e[t],a=s+(i[t]-s)*r;if(!Number.isFinite(a)){l=!1;break}n.push(a)}return l&&(s.attribute[t]=n),!0}return!1}var d=i(30756);function c(){}class p{constructor(t,e,i,n){var s;this._startTime=0,this._hasFirstRun=!1,this._syncAttributeUpdate=()=>{this.target.setAttributes(this.target.attribute)},this.type=t,this.props=e,this.duration=i,this.easing=n?"function"==typeof n?n:null!=(s=l[n])?s:l.linear:l.linear,"wait"===t&&(this.onUpdate=c),this.id=r.R.GenAutoIncrementId(),this.syncAttributeUpdate=c}bind(t,e){this.target=t,this.animate=e,this.onBind(),this.syncAttributeUpdate()}append(t){this.next=t,t.prev=this,t.setStartTime(this.getStartTime()+this.duration,!1)}updateDownstreamStartTimes(){let t=this.next,e=this._startTime+this.duration;for(;t;)t.setStartTime(e,!1),e+=t.duration,t=t.next;this.animate.updateDuration()}getLastProps(){return this.prev?this.prev.props||{}:this.animate.getStartProps()}setDuration(t,e=!0){this.duration=t,e&&this.updateDownstreamStartTimes()}getDuration(){return this.duration}determineInterpolateUpdateFunction(){if(!this.props)return;let t=[];this.propKeys.forEach(e=>{if("fill"===e||"stroke"===e){let i=this.fromProps[e],r=this.props[e];if((0,d.Z)(i)&&(0,d.Z)(r)){let s=n.VH.Get(i,n.Mr.Color255),l=n.VH.Get(r,n.Mr.Color255);this.fromParsedProps||(this.fromParsedProps={}),this.toParsedProps||(this.toParsedProps={}),this.fromParsedProps[e]=s,this.toParsedProps[e]=l,t.push(h["fill"===e?"fillPure":"strokePure"])}else h[e]?t.push(h[e]):t.push(u)}else h[e]?t.push(h[e]):t.push(u)}),this.interpolateUpdateFunctions=t}setStartTime(t,e=!0){this._startTime=t,e&&this.updateDownstreamStartTimes()}getStartTime(){return this._startTime}onBind(){"glyph"===this.target.type&&(this.syncAttributeUpdate=this._syncAttributeUpdate)}onFirstRun(){}onStart(){if(!this._hasFirstRun){this._hasFirstRun=!0,this.fromProps=this.getLastProps();let t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.fromProps[e]=null!=(i=this.fromProps[e])?i:t[e]}),this.determineInterpolateUpdateFunction(),this.tryPreventConflict(),this.trySyncStartProps(),this.onFirstRun()}}tryPreventConflict(){let t=this.animate;this.target.animates.forEach(e=>{if(e===t||e.priority>t.priority||e.priority===1/0)return;let i=e.getStartProps();this.propKeys.forEach(t=>{null!=i[t]&&e.preventAttr(t)})})}deleteSelfAttr(t){var e;delete this.props[t],this.fromProps&&delete this.fromProps[t];let i=this.propKeys.indexOf(t);-1!==i&&(this.propKeys.splice(i,1),null==(e=this.interpolateUpdateFunctions)||e.splice(i,1))}trySyncStartProps(){this.propKeys.forEach(t=>{this.fromProps[t]=this.animate.target.getComputedAttribute(t)})}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.fromProps[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}onUpdate(t,e,i){}onEnd(t){this.target.setAttributes(this.props),t?this._endCb=t:this._endCb&&this._endCb(this.animate,this)}getEndProps(){return this.props}getFromProps(){return this.fromProps}getMergedEndProps(){return this.getEndProps()}stop(){}release(){}}class g extends p{constructor(t,e,i,r){super(t,e,i,r)}onStart(){super.onStart();let t=this.getFromProps();this.target.setAttributes(t)}update(t,e,i){this.onStart()}determineInterpolateUpdateFunction(){}}},60831:function(t,e,i){"use strict";i.d(e,{H:()=>u});var r=i(21883),n=i.n(r),s=i(42159),l=i(9511),a=i(16049);let o=new s.A;class h{constructor(){this.released=!1}tick(t,e){o.addAnimationFrameCb(()=>{if(!this.released)return e(this)})}release(){this.released=!0}getTime(){return Date.now()}}class u extends n(){constructor(t){super(),this.timelines=[],this.frameTimeHistory=[],this.handleTick=(t,e)=>{let{once:i=!1}=null!=e?e:{};if(this.ifCanStop())return this.stop(),!1;let r=t.getTime();this._lastTickTime=r,this.lastFrameTime<0&&(this.lastFrameTime=r-this.interval+this.timeOffset,this.frameTimeHistory.push(this.lastFrameTime));let n=r-this.lastFrameTime,s=this.checkSkip(n);return s||(this._handlerTick(n),this.lastFrameTime=r,this.frameTimeHistory.push(this.lastFrameTime)),i||t.tick(this.interval,this.handleTick),!s},this._handlerTick=t=>{this.status===l.Q.RUNNING&&(this.tickCounts++,this.timelines.forEach(e=>{e.tick(t)}),this.emit("tick",t))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.stage=t,this.autoStop=!0,this.interval=16,this.computeTimeOffsetAndJitter()}bindStage(t){this.stage=t}computeTimeOffsetAndJitter(){this.timeOffset=Math.floor(Math.random()*this.interval),this._jitter=Math.min(Math.max(.2*this.interval,6),.7*this.interval)}init(){this.interval=16,this.status=l.Q.INITIAL,a.w.global.hooks.onSetEnv.tap("graph-ticker",()=>{this.initHandler(!1)}),a.w.global.env&&this.initHandler(!1)}addTimeline(t){this.timelines.push(t)}remTimeline(t){this.timelines=this.timelines.filter(e=>e!==t)}getTimelines(){return this.timelines}initHandler(t=!1){this.setupTickHandler(t)}setupTickHandler(t=!1){if(!t&&this.tickerHandler)return!0;let e=new h;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=e,!0}setInterval(t){this.interval=t,this.computeTimeOffsetAndJitter()}getInterval(){return this.interval}setFPS(t){this.setInterval(Math.floor(1e3/t))}getFPS(){return 1e3/this.interval}tick(t){this.tickerHandler.tick(t,t=>this.handleTick(t,{once:!0}))}tickTo(t){this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,t=>{this.handleTick(t,{once:!0})})}pause(){return this.status!==l.Q.INITIAL&&(this.status=l.Q.PAUSE,!0)}resume(){return this.status!==l.Q.INITIAL&&(this.status=l.Q.RUNNING,!0)}ifCanStop(){return!!(this.autoStop&&(!this.timelines.length||this.timelines.every(t=>!t.isRunning())))||!1}start(t=!1){return!(this.status===l.Q.RUNNING||!this.tickerHandler||!t&&(this.status===l.Q.PAUSE||this.ifCanStop()))&&(this.status=l.Q.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0)}stop(){this.status=l.Q.INITIAL,this.setupTickHandler(!0),this.lastFrameTime=-1}trySyncTickStatus(){this.status===l.Q.INITIAL&&this.timelines.some(t=>t.isRunning())?this.start():this.status===l.Q.RUNNING&&this.timelines.every(t=>!t.isRunning())&&this.stop()}release(){var t;this.stop(),this.timelines=[],null==(t=this.tickerHandler)||t.release(),this.tickerHandler=null,this.lastFrameTime=-1}checkSkip(t){var e,i,r;return"performance"!==(null==(r=null==(i=null==(e=this.stage)?void 0:e.params)?void 0:i.optimize)?void 0:r.tickRenderMode)&&t<this.interval+2*(Math.random()-.5)*this._jitter}}},32190:function(t,e,i){"use strict";i.d(e,{L:()=>a,P:()=>o});var r=i(40398),n=i(41075),s=i(21883),l=i.n(s);class a extends l(){get animateCount(){return this._animateCount}constructor(){super(),this.head=null,this.tail=null,this.animateMap=new Map,this._animateCount=0,this._playSpeed=1,this._totalDuration=0,this._startTime=0,this._currentTime=0,this._animationEndFlag=!0,this.id=r.R.GenAutoIncrementId(),this.paused=!1}isRunning(){return!this.paused&&this._animateCount>0}forEachAccessAnimate(t){let e=this.head,i=0;for(;e;){let r=e.next;t(e.animate,i),i++,e=r}}addAnimate(t){let e={animate:t,next:null,prev:null};this.head?this.tail&&(this.tail.next=e,e.prev=this.tail,this.tail=e):(this.head=e,this.tail=e),this.animateMap.set(t,e),this._animateCount++,this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())}pause(){this.paused=!0}resume(){this.paused=!1}tick(t){if(this.paused)return;this._animationEndFlag&&(this._animationEndFlag=!1,this.emit("animationStart"));let e=t*this._playSpeed;this._currentTime+=e,this.forEachAccessAnimate((t,i)=>{t.status===n.t.END?this.removeAnimate(t,!0):t.status!==n.t.RUNNING&&t.status!==n.t.INITIAL||t.advance(e)}),0===this._animateCount&&(this._animationEndFlag=!0,this.emit("animationEnd"))}clear(){this.forEachAccessAnimate(t=>{t.release()}),this.head=null,this.tail=null,this.animateMap.clear(),this._animateCount=0,this._totalDuration=0}removeAnimate(t,e=!0){let i=this.animateMap.get(t);i&&(e&&(t._onRemove&&t._onRemove.forEach(t=>t()),t.release()),i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev,this.animateMap.delete(t),this._animateCount--,t.getStartTime()+t.getDuration()>=this._totalDuration&&this.recalculateTotalDuration())}recalculateTotalDuration(){this._totalDuration=0,this.forEachAccessAnimate(t=>{this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())})}getTotalDuration(){return this._totalDuration}getPlaySpeed(){return this._playSpeed}setPlaySpeed(t){this._playSpeed=t}getPlayState(){return this.paused?"paused":0===this.animateCount?"stopped":"playing"}setStartTime(t){this._startTime=t}getStartTime(){return this._startTime}getCurrentTime(){return this._currentTime}setCurrentTime(t){this._currentTime=t}}let o=new a;o.isGlobal=!0},307:function(t,e,i){"use strict";i.d(e,{g:()=>a});var r=i(74562),n=i(43562),s=i(95950),l=i(31535);class a extends r.k{_prepareAnimate(t){if(!1!==this.attribute.animation){let{animation:e,animationEnter:i,animationExit:r,animationUpdate:a}=this.attribute,o=(0,n.Z)(e)?e:{};this._animationConfig={enter:!1!==i&&(0,s.Z)({},t,o,null!=i?i:{}),exit:!1!==r&&(0,s.Z)({},t,o,null!=r?r:{}),update:!1!==a&&((0,l.Z)(a)?a:(0,s.Z)({},t,o,null!=a?a:{}))}}else this._animationConfig={enter:!1,exit:!1,update:!1}}}},2420:function(t,e,i){"use strict";i.d(e,{I:()=>S});var r=i(45011),n=i(31535),s=i(98116),l=i(80875);function a(t){return Object.prototype.toString.call(t)}function o(t){return Object.keys(t)}var h=i(92493),u=i(47704),d=i(95950),c=i(88504),p=i(59225),g=i(14135),f=i(6091),m=i(76114),y=i(171),v=i(30427),b=i(52404),_=i(3496),x=i(64215),C=i(307);let w={type:"default",duration:300,easing:"linear"};class S extends C.g{constructor(){super(...arguments),this.name="axis",this.data=[],this.tickLineItems=[],this.subTickLineItems=[],this.axisLabelLayerSize={},this.axisLabelsContainer=null,this._onHover=t=>{this._lastHover=(0,x.fM)(t,this.axisContainer,this._lastHover)},this._onUnHover=t=>{this._lastHover=(0,x.lO)(t,this.axisContainer,this._lastHover)},this._onClick=t=>{this._lastSelect=(0,x.Q6)(t,this.axisContainer,this._lastSelect)}}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}getBoundsWithoutRender(t){let e=(0,h.Z)(this.attribute);e.scale=this.attribute.scale,this.attribute=t;let i=r.i.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}render(){this._prepare(),this._prevInnerView=this._innerView&&(0,_.uX)(this._innerView),this.removeAllChild(!0),this._innerView=r.i.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent(),this.runAnimation()}_prepare(){this._prepareAnimate(w)}_bindEvent(){if(this.attribute.disableTriggerEvent)return;let{hover:t,select:e}=this.attribute;t&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),e&&this._innerView.addEventListener("pointerdown",this._onClick)}_renderInner(t){let{title:e,label:i,tick:n,line:s,items:l}=this.attribute,a=r.i.group({x:0,y:0,zIndex:1,pickable:!1});if(a.name=y.X9.axisContainer,a.id=this._getNodeId("container"),a.setMode(this.mode),this.axisContainer=a,t.add(a),s&&s.visible&&this.renderLine(a),l&&l.length&&(this.data=this._transformItems(l[0]),n&&n.visible&&this.renderTicks(a),i&&i.visible)){let t=r.i.group({x:0,y:0,pickable:!1});t.name=y.X9.labelContainer,t.id=this._getNodeId("label-container"),this.axisLabelsContainer=t,a.add(t),l.forEach((e,i)=>{let r=this.renderLabels(t,e,i),n=r.getChildren();this.beforeLabelsOverlap(n,e,r,i,l.length),this.handleLabelsOverlap(n,e,r,i,l.length),this.afterLabelsOverlap(n,e,r,i,l.length);let s=0,a=0,o="center",h="middle",u=0;n.forEach((t,e)=>{var i;let r=t.attribute,n=null!=(i=r.angle)?i:0,l=t.AABBBounds,d=l.width(),c=l.height();n&&(d=Math.abs(d*Math.cos(n)),c=Math.abs(c*Math.sin(n))),s=Math.max(s,d),a=Math.max(a,c),o=r.textAlign,h=r.textBaseline,0===e&&(u=r.x)}),this.axisLabelLayerSize[i]={width:s,height:a,labelPos:u,textAlign:o,textBaseline:h}})}e&&e.visible&&this.renderTitle(a)}renderTicks(t){let e=this.getTickLineItems(),i=r.i.group({x:0,y:0,pickable:!1});i.name=y.X9.tickContainer,i.id=this._getNodeId("tick-container"),t.add(i),e.forEach((t,n)=>{var l;let a=r.i.line(Object.assign({},this._getTickLineAttribute("tick",t,n,e)));if(a.name=y.X9.tick,a.id=this._getNodeId(t.id),(0,u.Z)(null==(l=this.attribute.tick)?void 0:l.state))a.states=m.n0;else{let t=this.data[n],e=(0,d.Z)({},m.n0,this.attribute.tick.state);Object.keys(e).forEach(i=>{(0,s.Z)(e[i])&&(e[i]=e[i](t.rawValue,n,t,this.data))}),a.states=e}i.add(a)}),this.tickLineItems=e;let{subTick:n}=this.attribute;if(n&&n.visible){let t=this.getSubTickLineItems();t.length&&t.forEach((t,l)=>{let a=r.i.line(Object.assign({},this._getTickLineAttribute("subTick",t,l,e)));if(a.name=y.X9.subTick,a.id=this._getNodeId(`${l}`),(0,u.Z)(n.state))a.states=m.n0;else{let i=(0,d.Z)({},m.n0,n.state);Object.keys(i).forEach(r=>{(0,s.Z)(i[r])&&(i[r]=i[r](t.value,l,t,e))}),a.states=i}i.add(a)}),this.subTickLineItems=t}}renderLabels(t,e,i){let{dataFilter:n}=this.attribute.label;n&&(0,s.Z)(n)&&(e=n(e,i));let l=this._transformItems(e),a=r.i.group({x:0,y:0,pickable:!1});return a.name=`${y.X9.labelContainer}-layer-${i}`,a.id=this._getNodeId(`label-container-layer-${i}`),t.add(a),l.forEach((t,e)=>{var r;let n=this._getLabelAttribute(t,e,l,i),o=(0,g.vS)(n);if(o.name=y.X9.label,o.id=this._getNodeId(`layer${i}-label-${t.id}`),(0,u.Z)(null==(r=this.attribute.label)?void 0:r.state))o.states=m.n0;else{let r=(0,d.Z)({},m.n0,this.attribute.label.state);Object.keys(r).forEach(n=>{(0,s.Z)(r[n])&&(r[n]=r[n](t,e,l,i))}),o.states=r}o.data=Object.assign(Object.assign({},t),{index:e,layer:i}),a.add(o)}),a}renderTitle(t){let e=this.getTitleAttribute(),i=new b.V(Object.assign({},e));i.name=y.X9.title,i.id=this._getNodeId("title"),t.add(i)}getVerticalCoord(t,e,i){return(0,_.cN)(t,this.getVerticalVector(e,i,t))}getTickLineItems(){let{tick:t}=this.attribute,e=this.data,i=[],{alignWithLabel:r,inside:n=!1,length:l,dataFilter:a}=t,o=1;return e.length>=2&&(o=e[1].value-e[0].value),(a&&(0,s.Z)(a)?a(e):e).forEach(t=>{let e=t.point,s=t.value;if(!r){let i=t.value-o/2;if(this.isInValidValue(i))return;e=this.getTickCoord(i),s=i}let a=this.getVerticalCoord(e,l,n);if("3d"===this.mode){let r=this.getVerticalVector(l,n,e),o=0,h=0;(0,c.Wn)(r[0])>(0,c.Wn)(r[1])?o=c.pi/2*(a.x>e.x?1:-1):h=c.pi/2*(a.y>e.y?-1:1),i.push({start:e,end:a,value:s,id:`tick-${t.id}`,anchor:[e.x,e.y],alpha:o,beta:h})}else i.push({start:e,end:a,value:s,id:`tick-${t.id}`})}),i}getSubTickLineItems(){let{subTick:t}=this.attribute,e=[],{count:i=4,inside:r=!1,length:n=2}=t,s=this.tickLineItems,l=s.length;if(l>=2)for(let t=0;t<l-1;t++){let l=s[t],a=s[t+1];for(let t=0;t<i;t++){let s=(t+1)/(i+1),o=(1-s)*l.value+s*a.value,h=this.getTickCoord(o),u=this.getVerticalCoord(h,n,r);e.push({start:h,end:u,value:o,id:`sub-tick-${o}`})}}return e}_getTickLineAttribute(t,e,i,r){let n=(0,p.Z)(this.attribute,`${t}.style`),l=this.data[i];n=(0,s.Z)(n)?(0,d.Z)({},(0,p.Z)(v.p,`${t}.style`),"tick"===t?n(l.rawValue,i,l,this.data):n(e.value,i,e,r)):n;let{start:a,end:o,anchor:h,alpha:u,beta:c}=e;return Object.assign({points:[a,o],anchor:h,alpha:u,beta:c},n)}_getLabelAttribute(t,e,i,r){var n,l;let{space:a=4,inside:o=!1,formatMethod:h,type:u="text",text:c}=this.attribute.label,g=a,f=0;(null==(n=this.attribute.tick)?void 0:n.visible)&&this.attribute.tick.inside===o&&(f=this.attribute.tick.length||4),(null==(l=this.attribute.subTick)?void 0:l.visible)&&this.attribute.subTick.inside===o&&(f=Math.max(f,this.attribute.subTick.length||2)),g+=f;let m=this.getRelativeVector(t.point);r>0&&(0===m[1]?g+=(this.axisLabelLayerSize[r-1].height+(0,p.Z)(this.attribute,"label.space",4))*r:g+=(this.axisLabelLayerSize[r-1].width+(0,p.Z)(this.attribute,"label.space",4))*r);let y=this.getVerticalCoord(t.point,g,o),b=this.getVerticalVector(g||1,o,y),_=h?h(`${t.label}`,t,e,i,r):t.label,{style:x}=this.attribute.label;x=(0,s.Z)(x)?(0,d.Z)({},v.p.label.style,x(t,e,i,r)):x;let C=this.getLabelAlign(b,o,x.angle);return x=(0,d.Z)(C,x),(0,s.Z)(x.text)&&(x.text=x.text({label:t.label,value:t.rawValue,index:t.index,layer:r})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(y,b,_,x)),{text:null!=c?c:_,_originText:t.label,lineHeight:null==x?void 0:x.fontSize,type:u}),x)}getLabelPosition(t,e,i,r){return t}_transformItems(t){let e=[];return t.forEach(t=>{var i;e.push(Object.assign(Object.assign({},t),{point:this.getTickCoord(t.value),id:null!=(i=t.id)?i:t.label}))}),e}runAnimation(){let t=this.lastScale;if(this.attribute.scale){let t=this.attribute.scale;this.lastScale=t.clone(),this.lastScale.range([0,1])}if(this.attribute.animation&&this.applyAnimationState){let e=this.getInnerView(),i=this.getPrevInnerView();if(!i)return;let r=this._animationConfig;this._newElementAttrMap={},(0,f.Ck)(e,e=>{var h;if("group"!==e.type&&e.id){let u=i[e.id];if(e.setFinalAttributes(e.attribute),u){u.release();let i=u.attribute,d=e.getFinalAttribute(),c=function(t,e,i){let r={};for(let i in e)i in t&&function t(e,i,r){if(e===i)return!0;if(typeof e!=typeof i||null==e||null==i)return!1;if(Number.isNaN(e)&&Number.isNaN(i))return!0;if(a(e)!==a(i))return!1;if((0,s.Z)(e))return!!(null==r?void 0:r.skipFunction);if("object"!=typeof e)return!1;if((0,n.Z)(e)){if(e.length!==i.length)return!1;for(let n=e.length-1;n>=0;n--)if(!t(e[n],i[n],r))return!1;return!0}if(!(0,l.Z)(e))return!1;let h=o(e),u=o(i);if(h.length!==u.length)return!1;h.sort(),u.sort();for(let t=h.length-1;t>=0;t--)if(h[t]!=u[t])return!1;for(let n=h.length-1;n>=0;n--){let s=h[n];if(!t(e[s],i[s],r))return!1}return!0}(t[i],e[i])||(r[i]=e[i]);return r}(i,d),p=Object.keys(c).length>0;if("opacity"in i&&d.opacity!==i.opacity&&(c.opacity=null!=(h=d.opacity)?h:1,p=!0),r.update&&p){this._newElementAttrMap[e.id]={state:"update",node:e,attrs:e.attribute};let i=u.attribute;e.setAttributes(i),e.applyAnimationState(["update"],[{name:"update",animation:Object.assign(Object.assign({selfOnly:!0},r.update),{type:"axisUpdate",customParameters:{config:r.update,diffAttrs:c,lastScale:t}})}])}}else r.enter&&(this._newElementAttrMap[e.id]={state:"enter",node:e,attrs:e.attribute},e.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r.enter),{type:"axisEnter",selfOnly:!0,customParameters:{config:r.enter,lastScale:t,getTickCoord:this.getTickCoord.bind(this)}})}]))}})}}release(){super.release(),this._prevInnerView=null,this._innerView=null}}},30427:function(t,e,i){"use strict";i.d(e,{P:()=>n,p:()=>r});let r={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},n={size:8,stroke:"#000",lineWidth:1,zIndex:1}},171:function(t,e,i){"use strict";var r,n,s,l;i.d(e,{X9:()=>r,bz:()=>o,n0:()=>a}),(s=r||(r={})).innerView="inner-view",s.axisContainer="axis-container",s.labelContainer="axis-label-container",s.tickContainer="axis-tick-container",s.tick="axis-tick",s.subTick="axis-sub-tick",s.label="axis-label",s.title="axis-title",s.gridContainer="axis-grid-container",s.grid="axis-grid",s.gridRegion="axis-grid-region",s.line="axis-line",s.background="axis-background",s.axisLabelBackground="axis-label-background",s.axisBreak="axis-break",s.axisBreakSymbol="axis-break-symbol",(l=n||(n={})).selected="selected",l.selectedReverse="selected_reverse",l.hover="hover",l.hoverReverse="hover_reverse";let a={[n.selectedReverse]:{},[n.selected]:{},[n.hover]:{},[n.hoverReverse]:{}},o=999},84788:function(t,e,i){"use strict";i.d(e,{$:()=>L});var r=i(95950),n=i(47704),s=i(25258),l=i(59225),a=i(35652),o=i(70501),h=i(88663),u=i(98116),d=i(21777),c=i(11681),p=i(87986),g=i(45011),f=i(15532),m=i(69590),y=i(2420),v=i(30427),b=i(171),_=i(14135),x=i(48606),C=i(98706),w=i(96210);function S(t=0){if(t<0)for(;t<0;)t+=2*Math.PI;if(t>0)for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function A(t,e=0){let i,r=["center","left","left","left","center","right","right","right","left"],n=["top","top","middle","bottom","bottom","bottom","middle","top","top"];"top"===t&&(r=["center","right","right","right","center","left","left","left","right"],n=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);let s=(e=S(e))/(.5*Math.PI);return{textAlign:r[i=s===Math.floor(s)?2*Math.floor(s):2*Math.floor(s)+1],textBaseline:n[i]}}function M(t,e=0){let i,r=["right","right","center","left","left","left","center","right","right"],n=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];"right"===t&&(r=["left","left","center","right","right","right","center","left","left"],n=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);let s=(e=S(e))/(.5*Math.PI);return{textAlign:r[i=s===Math.floor(s)?2*Math.floor(s):2*Math.floor(s)+1],textBaseline:n[i]}}var k=i(43562),T=i(88504);function R(t,e,i){let r;return(0,o.Z)(e)&&(r=Math.abs(e-t)),(0,o.Z)(i)&&(r=(0,o.Z)(r)?Math.min(Math.abs(t-i),r):Math.abs(t-i)),r}var B=i(75303),P=i(25894),E=i(3496),I=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};(0,P.Vu)();class L extends y.I{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},L.defaultAttributes,t),e)}_renderInner(t){var e;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){let t=[];for(let e=0;e<this.attribute.breaks.length;e++){let{range:i,breakSymbol:r,rawRange:n}=this.attribute.breaks[e];t.push({startPoint:this.getTickCoord(i[0]),endPoint:this.getTickCoord(i[1]),range:i,breakSymbol:r,rawRange:n})}this._breaks=t}super._renderInner(t),this._breaks&&this._breaks.length&&this._breaks.forEach((e,i)=>{let{startPoint:r,endPoint:n,breakSymbol:s,rawRange:l}=e;if(!1!==(null==s?void 0:s.visible)){let e=g.i.group({zIndex:b.bz});e.name=b.X9.axisBreak,e.id=this._getNodeId(`${b.X9.axisBreak}-${i}`),e.data=l;let a=(0,E.uf)(s),o=g.i.symbol(Object.assign({x:r.x,y:r.y},a));o.name=b.X9.axisBreakSymbol;let h=g.i.symbol(Object.assign({x:n.x,y:n.y},a));h.name=b.X9.axisBreakSymbol,e.add(o),e.add(h),t.add(e)}});let{panel:i}=this.attribute;if(i&&i.visible){let t=this.axisContainer,n=t.AABBBounds,s=g.i.rect(Object.assign({x:n.x1,y:n.y1,width:n.width(),height:n.height()},i.style));s.name=b.X9.background,s.id=this._getNodeId("background"),s.states=(0,r.Z)({},b.n0,null!=(e=i.state)?e:{}),t.insertBefore(s,t.firstChild)}}renderLine(t){let{start:e,end:i,line:s}=this.attribute,{startSymbol:l,endSymbol:a,style:o,state:h}=s,u=Object.assign({startSymbol:l,endSymbol:a,lineStyle:o},I(s,["startSymbol","endSymbol","style","state"]));if(this._breaks&&this._breaks.length){let t=[],r=e;this._breaks.forEach(e=>{let{startPoint:i,endPoint:n}=e;t.push([r,i]),r=n}),t.push([r,i]),u.points=t,u.multiSegment=!0}else u.points=[e,i];(0,n.Z)(h)||(u.state={line:(0,r.Z)({},b.n0,h),symbol:(0,r.Z)({},b.n0,h)});let d=new f.X(u);d.name=b.X9.line,d.id=this._getNodeId("line"),t.add(d)}getTextAlign(t){let e="center";return(0,s.Yt)(t[0],0)?(0,s.Yt)(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}getTitleAttribute(){var t,e,i;let n=this.attribute.title,{position:s="middle",space:h=4,textStyle:u={},autoRotate:d=!0,shape:c,background:p,state:g={},maxWidth:f}=n,y=I(n,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]),v=.5;"start"===s?v=0:"end"===s&&(v=1);let{verticalFactor:_=1}=this.attribute,x=this.getTickCoord(v),C=this.getRelativeVector(),w=0;if((null==(t=this.attribute.label)?void 0:t.visible)&&!1===this.attribute.label.inside){let t=+(0,l.Z)(this.attribute,"label.space",4);w+=t;let e=Object.keys(this.axisLabelLayerSize).length;if(0===C[1]){let i=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(i)?w+=i+(e-1)*t:w=0}else if(0===C[0])if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){let i=this.axisLabelLayerSize[0].labelPos,r=this.axisLabelsContainer.AABBBounds;w+=(1==-1*_?r.x2>i?Math.min(r.x2-i,r.width()):0:r.x1<i?Math.min(i-r.x1,r.width()):0)+(e-1)*t}else w=0;else Object.keys(this.axisLabelLayerSize).forEach((e,i)=>{w+=this.axisLabelLayerSize[e].width+(i>0?t:0)})}let S=0;(null==(e=this.attribute.tick)?void 0:e.visible)&&!1===this.attribute.tick.inside&&(S=this.attribute.tick.length||4),(null==(i=this.attribute.subTick)?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(S=Math.max(S,this.attribute.subTick.length||2));let A=S+w+h,M=this.getVerticalCoord(x,A,!1),k=this.getVerticalVector(A,!1,{x:0,y:0}),T,R,{angle:B}=y;if(T="start"===s?"start":"end"===s?"end":"center",(0,a.Z)(B)&&d){B=(0,m.Dg)(C,[1,0],!0);let{verticalFactor:t=1}=this.attribute;R=1==-1*t?"bottom":"top"}else T=this.getTextAlign(k),R=this.getTextBaseline(k,!1);let P=f;if((0,a.Z)(P)){let{verticalLimitSize:t,verticalMinSize:e,orient:i}=this.attribute,r=Math.min(t||1/0,e||1/0);if((0,o.Z)(r))if("bottom"===i||"top"===i)if(B!==Math.PI/2){let t=Math.abs(Math.cos(null!=B?B:0));P=t<1e-6?1/0:this.attribute.end.x/t}else P=r-A;else if(B&&0!==B){let t=Math.abs(Math.sin(B));P=t<1e-6?1/0:this.attribute.end.y/t}else P=r-A}let E=Object.assign(Object.assign(Object.assign({},M),y),{maxWidth:P,textStyle:Object.assign({textAlign:T,textBaseline:R},u),state:{text:(0,r.Z)({},b.n0,g.text),shape:(0,r.Z)({},b.n0,g.shape),panel:(0,r.Z)({},b.n0,g.background)}});return E.angle=B,c&&c.visible&&(E.shape=Object.assign({visible:!0},c.style),c.space&&(E.space=c.space)),p&&p.visible&&(E.panel=Object.assign({visible:!0},p.style)),E}getTextBaseline(t,e){let i="middle",{verticalFactor:r=1}=this.attribute;return(0,s.Yt)(t[1],0)?i=!(0,s.Yt)(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":1==(e?1:-1)*r?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}getLabelAlign(t,e,i){let r=this.attribute.orient;if(["top","bottom","right","left"].includes(r)||0===t[0]&&0===t[1]){if("top"===r||"bottom"===r)return A(e?"bottom"===r?"top":"bottom":r,i);if("left"===r||"right"===r)return M(e?"left"===r?"right":"left":r,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}beforeLabelsOverlap(t,e,i,r,n){var s,l,a,o;let{flush:u=!1}=this.attribute.label||{};if(u&&t.length){let{orient:e,start:i,end:r}=this.attribute,n="bottom"===e||"top"===e,u=t[0],d=(0,h.Z$)(t),c=n?u.attribute.x>d.attribute.x:u.attribute.y<d.attribute.y;if(n){let t=c?d:u,e=c?u:d,n=i.x,a=r.x,o=t.AABBBounds.x1,h=e.AABBBounds.x2;o<n&&(t.attribute.angle?t.setAttributes({dx:(null!=(s=t.attribute.dx)?s:0)+n-o}):t.setAttributes({x:n,textAlign:"left"})),h>a&&(e.attribute.angle?e.setAttributes({dx:(null!=(l=e.attribute.dx)?l:0)+a-h}):e.setAttributes({x:a,textAlign:"right"}))}else{let t=c?d:u,e=c?u:d,n=t.AABBBounds.y2,s=e.AABBBounds.y1,l=i.y,h=r.y;s<l&&(e.attribute.angle?e.setAttributes({dy:(null!=(a=e.attribute.dy)?a:0)+l-s}):e.setAttributes({y:l,textBaseline:"top"})),n>h&&(t.attribute.angle?t.setAttributes({dy:(null!=(o=t.attribute.dy)?o:0)+h-n}):t.setAttributes({y:h,textBaseline:"bottom"}))}}}handleLabelsOverlap(t,e,i,r,s){if((0,n.Z)(t))return;let{verticalLimitSize:l,label:h,orient:d}=this.attribute,c=this._getAxisLabelLimitLength(l,s),{layoutFunc:p,autoRotate:g,autoRotateAngle:f,autoLimit:m,limitEllipsis:y,autoHide:v,autoHideMethod:b,autoHideSeparation:_,lastVisible:B,firstVisible:P,autoWrap:E,overflowLimitLength:I}=h;if((0,u.Z)(p))p(t,e,r,this);else{if(g)!function(t,e){if((0,n.Z)(t))return;let{orient:i,labelRotateAngle:r=[0,45,90]}=e;if(0===r.length||t.some(t=>!!t.attribute.angle))return;let s=0,l=0;for(r&&r.length>0&&(l=r.length);s<l;){var a,o;let e=r[s++];if(t.forEach(t=>{t.attribute.angle=(0,C.M4)(e)}),a=i,o=t,"bottom"!==a&&"top"!==a||function(t,e){e.forEach(e=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},A(t,e.attribute.angle)),{angle:S(e.attribute.angle)}))})}(a,o),"left"!==a&&"right"!==a||function(t,e){e.forEach((e,i)=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},M(t,e.attribute.angle)),{angle:S(e.attribute.angle)}))})}(a,o),(0,w.PY)(o),!function(t){for(let e=1;e<t.length;e++)if((0,w.Ph)(t[e-1],t[e]))return!0;return!1}(t))break}}(t,{labelRotateAngle:f,orient:d});else if(E){let e="left"===d||"right"===d?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x);!function(t,e){let{limitLength:i,axisLength:r,ellipsis:s="...",orient:l}=e;if((0,n.Z)(t)||!(0,o.Z)(i))return;let a=t[0].attribute.angle,h=(0,w.nw)(a),u=(0,w.GK)(a),d="top"===l||"bottom"===l,c=r/t.length;t.forEach((e,r)=>{var n,l,a,p,g;if(d){if(u&&Math.floor(e.AABBBounds.height())<=i)return;if(h){let i=R(e.attribute.x,null==(n=t[r+1])?void 0:n.attribute.x,null==(l=t[r-1])?void 0:l.attribute.x);(0,o.Z)(i)&&(c=(0,T.VV)(c,i))}}else{if(u){let i=R(e.attribute.y,null==(a=t[r+1])?void 0:a.attribute.y,null==(p=t[r-1])?void 0:p.attribute.y);(0,o.Z)(i)&&(c=(0,T.VV)(c,i))}if(h&&Math.floor(e.AABBBounds.width())<=i)return}let f=null,m=null;d?u?(f=i,m=c):(f=c,m=i):u?(f=c,m=i):(f=i,m=c),e.setAttributes({maxLineWidth:f,ellipsis:null!=(g=e.attribute.ellipsis)?g:s,whiteSpace:"normal",heightLimit:m})})}(t,{orient:d,limitLength:c,axisLength:e,ellipsis:y})}if(!E&&m&&(0,o.Z)(c)&&c>0){let e="left"===d||"right"===d,i=e?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x),r=e?i/t.length:v||g?1/0:i/t.length;!function(t,e){var i;let{limitLength:r,verticalLimitLength:s,ellipsis:l="...",orient:h,axisLength:u}=e;if((0,n.Z)(t)||!(0,o.Z)(r))return;let d=(i=e.overflowLimitLength,(0,o.Z)(i)?{left:i,right:i}:(0,k.Z)(i)?{left:i.left||0,right:i.right||0}:{left:0,right:0}),c=t[0],p=c.attribute.angle,g=!(0,a.Z)(p),f=g?Math.cos(p):1,m=g?Math.sin(p):0,y=(0,w.nw)(p),v=(0,w.GK)(p),b="top"===h||"bottom"===h,_=c.attribute.direction,x=!y&&!v&&b&&(t.length<2||t.some(t=>Math.abs(t.AABBBounds.width()-c.AABBBounds.width())>=2))&&c.AABBBounds.width()>Math.abs(r/m);t.forEach(t=>{var e;if(b&&(v&&Math.floor(t.AABBBounds.height())<=r||y&&Math.floor(t.AABBBounds.width())<=s))return;if(!b&&("vertical"===_&&Math.floor(t.AABBBounds.height())<=s||"vertical"!==_&&(y&&Math.floor(t.AABBBounds.width())<=r||v&&Math.floor(t.AABBBounds.height())<=s)))return;let i=null;if(y||v)i=b?y?s:r:"vertical"===_||v?s:r;else if(b){let{x1:e,x2:n}=t.AABBBounds,s=m/f,l=Math.abs(r/m);i=x&&s>0&&e<=u+d.right&&r/s+e>u+d.right?Math.min((u-e+d.right)/Math.abs(f),l):x&&s<0&&n>=-d.left&&r/s+n<-d.left?Math.min((n+d.left)/Math.abs(f),l):l}else i=Math.abs(r/f);(0,o.Z)(t.attribute.maxLineWidth)&&(i=(0,o.Z)(i)?Math.min(t.attribute.maxLineWidth,i):t.attribute.maxLineWidth),t.setAttributes({maxLineWidth:i,ellipsis:null!=(e=t.attribute.ellipsis)?e:l})})}(t,{limitLength:c,verticalLimitLength:r,ellipsis:y,orient:d,axisLength:i,overflowLimitLength:I})}v&&(0,x.t)(t,{orient:d,method:b,separation:_,lastVisible:B,firstVisible:P})}}afterLabelsOverlap(t,e,i,r,n){let{verticalLimitSize:s,orient:l}=this.attribute,a="bottom"===l||"top"===l,h=i.AABBBounds,u=a?h.height():h.width(),{verticalMinSize:c}=this.attribute;if((0,o.Z)(c)&&(!(0,o.Z)(s)||c<=s)){let t,e;u=Math.max(u,this._getAxisLabelLimitLength(c,n)),"left"===l?(t=h.x2-u,e=h.y1):"right"===l?(t=h.x1,e=h.y1):"top"===l?(t=h.x1,e=h.y2-u):"bottom"===l&&(t=h.x1,e=h.y1);let r=g.i.rect({x:t,y:e,width:a?h.width():u,height:a?u:h.height(),pickable:!1});r.name=b.X9.axisLabelBackground,r.id=this._getNodeId("axis-label-background"),i.insertBefore(r,i.firstChild)}if((0,d.Z)(this.attribute.label.containerAlign)){var p,f,m;let e;"left"===l?e=h.x2-u:"right"===l?e=h.x1:"top"===l?e=h.y2-u:"bottom"===l&&(e=h.y1),p=e,f=u,m=this.attribute.label.containerAlign,"left"===l||"right"===l?"left"===m?t.forEach(t=>{var e;t.setAttributes({dx:(null!=(e=t.attribute.dx)?e:0)+p-t.AABBBounds.x1})}):"right"===m?t.forEach(t=>{var e;t.setAttributes({dx:(null!=(e=t.attribute.dx)?e:0)+p+f-t.AABBBounds.x2})}):"center"===m&&t.forEach(t=>{var e;t.setAttributes({dx:(null!=(e=t.attribute.dx)?e:0)+p+f/2-(t.AABBBounds.x1+t.AABBBounds.x2)/2})}):"bottom"!==l&&"top"!==l||("top"===m?t.forEach(t=>{var e;t.setAttributes({dy:(null!=(e=t.attribute.dy)?e:0)+p-t.AABBBounds.y1})}):"bottom"===m?t.forEach(t=>{var e;t.setAttributes({dy:(null!=(e=t.attribute.dy)?e:0)+p+f-t.AABBBounds.y2})}):"middle"===m&&t.forEach(t=>{var e;t.setAttributes({dy:(null!=(e=t.attribute.dy)?e:0)+p+f/2-(t.AABBBounds.y1+t.AABBBounds.y2)/2})}))}}_getAxisLabelLimitLength(t,e){var i,r,n,s,l;let{label:a,title:o,line:h,tick:u}=this.attribute,d=null!=(i=a.space)?i:4,p=t,g=0,f=0,m=h&&h.visible?null!=(r=h.style.lineWidth)?r:1:0,y=u&&u.visible?null!=(n=u.length)?n:4:0;if(o&&o.visible&&"string"==typeof o.text){g=(0,_.fe)(o.text,o.textStyle,null==(l=null==(s=this.stage)?void 0:s.getTheme())?void 0:l.text).height;let t=(0,c.o)(o.padding);f=o.space+t[0]+t[2]}return p&&(p=(p-d-f-g-m-y)/e),p}release(){super.release(),this._breaks=null}}L.defaultAttributes=v.p,(0,p.jB)(L,B.b)},75303:function(t,e,i){"use strict";i.d(e,{b:()=>n});var r=i(69590);class n{isInValidValue(t){return t<0||t>1}getTickCoord(t){let{start:e}=this.attribute,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}getRelativeVector(t){let{start:e,end:i}=this.attribute;return[i.x-e.x,i.y-e.y]}getVerticalVector(t,e=!1,i){let{verticalFactor:n=1}=this.attribute,s=this.getRelativeVector(),l=(0,r.Fv)(s),a=[l[1],-1*l[0]];return(0,r.bA)(a,t*(e?1:-1)*n)}}},48606:function(t,e,i){"use strict";i.d(e,{t:()=>u});var r=i(47704),n=i(98116),s=i(88663),l=i(3496);let a={parity:function(t){return t.filter((t,e)=>e%2?t.setAttribute("opacity",0):1)},greedy:function(t,e){let i;return t.filter((t,r)=>r&&(0,l.qw)(i,t,e)?t.setAttribute("opacity",0):(i=t,1))}};function o(t){let e;return(e=t.OBBBounds.empty()?t.AABBBounds:t.OBBBounds).width()>1&&e.height()>1}function h(t,e,i,r,n=!1){if(i&&!t.attribute.opacity){let i=e.length;if(i>1){t.setAttribute("opacity",1);for(let t=0;t<i;t++){let s=n?e[i-1-t]:e[t];if(!r(s))break;s.setAttribute("opacity",0)}}}}function u(t,e){let i;if((0,r.Z)(t))return;let u=t.filter(o);if((0,r.Z)(u))return;u.forEach(t=>t.setAttribute("opacity",1)),i=u;let{method:d="parity",separation:c=0}=e,p=(0,n.Z)(d)?d:a[d]||a.parity;if(i.length>=3&&(0,l.A9)(i,c)){do i=p(i,c);while(i.length>=3&&(0,l.A9)(i,c));let t=(t,e,i=!0)=>i&&t<3||e,r=t(i.length,e.firstVisible,!1),n=t(i.length,e.lastVisible),a=u[0],o=(0,s.Z$)(u);(0,l.qw)(a,o,c)&&r&&n&&(o.setAttribute("opacity",0),n=!1),h(a,i,r,t=>(0,l.qw)(t,a,c)),h(o,i,n,t=>(0,l.qw)(t,o,c)||!(!r||t===a)&&(0,l.qw)(t,a,c),!0)}u.forEach(t=>{t.setAttribute("visible",!!t.attribute.opacity)})}},96210:function(t,e,i){"use strict";i.d(e,{GK:()=>o,PY:()=>s,Ph:()=>l,nw:()=>h});var r=i(33049),n=i(35652);function s(t){t.forEach(t=>{if(t.rotatedBounds||!t.attribute.angle)return;let e=function(t){let e=t.AABBBounds;return{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,centerX:t.attribute.x,centerY:t.attribute.y,angle:t.attribute.angle}}(t),i=(0,r.xj)({x:t.attribute.x,y:t.attribute.y},e.angle,{x:e.centerX,y:e.centerY}),n=i.x-e.centerX,s=i.y-e.centerY;e.x1+=n,e.x2+=n,e.y1+=s,e.y2+=s,e.centerX+=n,e.centerY+=s,t.rotatedBounds=e})}function l(t,e){var i,n;return(null==(i=t.OBBBounds)?void 0:i.empty())||(null==(n=e.OBBBounds)?void 0:n.empty())?(0,r.SX)(t.AABBBounds,e.AABBBounds,!1)&&(!t.rotatedBounds||!e.rotatedBounds||(0,r.nn)(t.rotatedBounds,e.rotatedBounds,!0)):t.OBBBounds.intersects(e.OBBBounds)}let a=Math.sin(Math.PI/10);function o(t,e=a){let i=!(0,n.Z)(t)&&0!==t,r=i?Math.cos(t):1;return i&&Math.abs(r)<=e}function h(t,e=a){let i=!(0,n.Z)(t)&&0!==t,r=i?Math.sin(t):0;return!i||Math.abs(r)<=e}},25894:function(t,e,i){"use strict";i.d(e,{WF:()=>y,sC:()=>b,Vu:()=>m,nZ:()=>v});var r=i(15589),n=i(79134),s=i(840),l=i(69877),a=i(86972),o=i(51619),h=i(9994),u=i(43682),d=i(3793),c=i(92851);class p extends u.Or{onBind(){var t;let e=(0,d.L)(this.target);this._animator=e;let i=this.duration,r=this.easing,{config:n,lastScale:s,getTickCoord:l}=this.params,a=1,o=this.target.data;if(s&&l&&o){a=.7;let t=l(s.scale(o.rawValue)),n=this.target.attribute.x,h=this.target.attribute.y;this.target.setAttributes({x:t.x,y:t.y}),e.animate(this.target,{type:"to",to:{x:n,y:h},duration:i,easing:r})}e.animate(this.target,{type:null!=(t=n.type)?t:"fadeIn",to:n.to,duration:i*a,easing:r}),this.completeBind(e)}}class g extends u.Or{onBind(){let t=(0,d.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,{config:r,diffAttrs:n}=this.params;t.animate(this.target,{type:"to",to:Object.assign({},n),duration:e,easing:i,customParameters:{diffAttrs:Object.assign({},n)}}),this.completeBind(t)}deleteSelfAttr(t){super.deleteSelfAttr(t),this._animator.deleteSelfAttr(t)}tryPreventConflict(){}}function f(){(0,r.M)(),(0,n.N)(),(0,s.v)(),(0,l.g)(),c.a.registerBuiltInAnimate("axisEnter",p),c.a.registerBuiltInAnimate("axisUpdate",g)}function m(){f(),(0,a.k)()}function y(){f(),(0,o.f)()}function v(){(0,r.M)(),(0,h.N)()}function b(){(0,r.M)(),(0,h.N)()}},31943:function(t,e,i){"use strict";i.d(e,{m:()=>d});var r=i(83143),n=i(21777),s=i(98116),l=i(88663),a=i(5533),o=i(3496);function h(t,e,i,r){let n,{breakData:s}=t;if(s&&s()){let{breakDomains:t}=s(),l=e.domain();n=[];for(let e=0;e<l.length-1;e++)r(i,[l[e],l[e+1]]).forEach(e=>{t.some(t=>e>=t[0]&&e<=t[1])||n.push(e)});e.domain(l)}else n=r(i);return n}function u(t,e,i,r,n=!1){if(i&&!e.includes(t)){let i=e.length;if(i>1){n?e.push(t):e.unshift(t);for(let t=0;t<i;t++){let s=n?i-1-t:t;if(!r(e[s]))break;e.splice(s,1),t--,i--}}}}let d=(t,e)=>{var i,d,p,g,f,m;let y;if(!(0,r.z2)(t.type))return(0,a.KV)(t.domain());let v=t.range(),b=Math.abs(v[v.length-1]-v[0]);if(b<2)return(0,a.KV)([t.domain()[0]]);let{tickCount:_,forceTickCount:x,tickStep:C,noDecimals:w=!1,labelStyle:S,breakData:A}=e;if((0,n.Z)(C))f=t.stepTicks(C),y=(m=A&&A()?A().breakDomains:null)&&m.length?f.filter(t=>m.every(e=>t<e[0]||t>e[1])):f;else if((0,n.Z)(x))y=h(e,t,x,(e,i)=>i&&i.length?t.domain(i,!0).forceTicks(e):t.forceTicks(e));else if("d3"===e.tickMode)y=h(e,t,null!=(i=(0,s.Z)(_)?_({axisLength:b,labelStyle:S}):_)?i:5,(e,i)=>i&&i.length?t.domain(i,!0).d3Ticks(e,{noDecimals:w}):t.d3Ticks(e,{noDecimals:w}));else{let i=null!=(d=(0,s.Z)(_)?_({axisLength:b,labelStyle:S}):_)?d:5,r=(0,s.Z)(e.tickMode)?e.tickMode:void 0;y=h(e,t,i,(e,i)=>i&&i.length?t.domain(i,!0).ticks(e,{noDecimals:w,customTicks:r}):t.ticks(e,{noDecimals:w,customTicks:r}))}let M=t.domain();if(e.labelFirstVisible&&M[0]!==y[0]&&!y.includes(M[0])&&y.unshift(M[0]),e.labelLastVisible&&M[M.length-1]!==y[y.length-1]&&!y.includes(M[M.length-1])&&y.push(M[M.length-1]),e.sampling&&y.length>1&&("cartesian"===e.coordinateType||"polar"===e.coordinateType&&"radius"===e.axisOrientType)){let i,{labelGap:r=4,labelFlush:n}=e;if(6*y.length>b){let r=[],n=Math.floor(6*y.length/b);y.forEach((t,e)=>{e%n!=0&&e!==y.length-1||r.push(t)}),i=null==(p=(0,a.SZ)(t,r,e))?void 0:p.map((t,e)=>({AABBBounds:t,value:r[e]}))}else i=null==(g=(0,a.SZ)(t,y,e))?void 0:g.map((t,e)=>({AABBBounds:t,value:y[e]}));if(i){let t=i[0],s=(0,l.Z$)(i),a=A&&A()?c.greedy:c.parity;for(;i.length>=3&&(0,o.A9)(i,r);)i=a(i,r);let h=e.labelFirstVisible,d=e.labelLastVisible;(0,o.qw)(t,s,r)&&i.includes(s)&&i.length>1&&h&&d&&(i.splice(i.indexOf(s),1),d=!1),u(t,i,h,e=>(0,o.qw)(e,t,r)),u(s,i,d,e=>(0,o.qw)(e,s,r)||!(!h||e===t)&&(0,o.qw)(e,t,r),!0);let p=i.map(t=>t.value);p.length<3&&n&&(p.length>1&&p.pop(),(0,l.Z$)(p)!==(0,l.Z$)(y)&&p.push((0,l.Z$)(y))),y=p}}return(0,a.KV)(y)},c={parity:function(t){return t.filter((t,e)=>e%2==0)},greedy:function(t,e){let i;return t.filter((t,r)=>(!r||!(0,o.qw)(i,t,e))&&(i=t,!0))}}},94051:function(t,e,i){"use strict";i.d(e,{U:()=>c});var r=i(21777),n=i(98116),s=i(88663),l=i(35652),a=i(45103),o=i(5533);let h=(t,e,i,r)=>{let n=(0,o.SZ)(t,e,i);return n&&n.map(t=>r?[t.x1,t.x2,t.width()]:[t.y1,t.y2,t.height()])},u=(t,e,i=0)=>Math.max(t[0],e[0])-i/2<=Math.min(t[1],e[1])+i/2,d=(t,e)=>t[1]<e[0]?e[0]-t[1]:e[1]<t[0]?t[0]-e[1]:0,c=(t,e)=>{var i;let a,u=t.domain();if(!u.length)return[];let{tickCount:d,forceTickCount:c,tickStep:g,labelGap:f=4,axisOrientType:m,labelStyle:y}=e,v=(0,o.tz)(m),b=t.range(),_=t.calculateWholeRangeSize();if(_<2)return e.labelLastVisible?(0,o.KV)([u[u.length-1]]):(0,o.KV)([u[0]]);if((0,r.Z)(g))a=t.stepTicks(g);else if((0,r.Z)(c))a=t.forceTicks(c);else if((0,r.Z)(d)){let e=(0,n.Z)(d)?d({axisLength:_,labelStyle:y}):d;a=t.ticks(e)}else if(e.sampling){let r=(null!=(i=e.labelStyle.fontSize)?i:12)+2,n=(0,s.iH)(b),l=(0,s.CE)(b);if(u.length<=_/r){let i=h(t,u,e,v);if(i){let r=Math.min(...i.map(t=>t[2])),s=(l-n)/u.length,o=p(u,i,f,e.labelLastVisible,Math.floor(r/s),!1);a=t.stepTicks(o.step),e.labelLastVisible&&(o.delCount&&(a=a.slice(0,a.length-o.delCount)),a.push(u[u.length-1]))}}else{let i=h(t,[u[0],u[Math.floor(u.length/2)],u[u.length-1]],e,v);if(i){let r=null;i.forEach(t=>{r?r[2]<t[2]&&(r=t):r=t});let s=l-n-f>0?Math.ceil(u.length*(f+r[2])/(l-n-f)):u.length-1;a=t.stepTicks(s),!e.labelLastVisible||a.length&&a[a.length-1]===u[u.length-1]||(a.length&&Math.abs(t.scale(a[a.length-1])-t.scale(u[u.length-1]))<r[2]&&(a=a.slice(0,-1)),a.push(u[u.length-1]))}}}return(0,l.Z)(a)&&(a=t.domain()),(0,o.KV)(a)},p=(t,e,i,r,n,s)=>{let l=0,o=0,h=-1,c=Number.MAX_VALUE,p=r=>{let n=!0,s=0;do s+r<t.length&&u(e[s],e[s+r],i)&&(n=!1),s+=r;while(n&&s<t.length);return n},g=(0,a.o0)(n,t.length,t=>p(t)?1:-1),f=g;do if(!(f>g)||s||p(f)){if(!r){o=f;break}{let r=t.length-1,n,s=0;n=t.length%f>0?t.length-t.length%f+f:t.length;do{if((n-=f)!==r&&!u(e[n],e[r],i))break;s++}while(n>0);if(n===r){o=f,l=s;break}{let i=Math.floor(t.length/f)-s+1;if(i<h)break;{h=i;let t=d(e[n],e[r]),a=n-f>=0?d(e[n-f],e[n]):t,u=Math.abs(t-a);if(u<c&&(c=u,o=f,l=s),t<=a)break}}}f++}else f++;while(f<=t.length);return{step:o,delCount:l}}},84964:function(t,e,i){"use strict";i.d(e,{t:()=>c});var r=i(25258),n=i(21777),s=i(98116),l=i(88663),a=i(5533),o=i(76620),h=i(14135),u=i(3496);let d=(t,e,i)=>{var n;let{labelStyle:s,getRadius:l,labelOffset:d,labelFormatter:c,inside:p}=i,g=null==l?void 0:l(),f=null!=(n=s.angle)?n:0,m=(0,h.gM)(s);return e.map(e=>{let i=c?c(e):`${e}`,{width:n,height:l}=m.quickMeasure(i),h=Math.max(n,a.rd),y=Math.max(l,a.rd),v=t.scale(e),b={x:0,y:0},_=0,x=0,C={align:s.textAlign,baseline:s.textBaseline},{x:w,y:S}=(0,u.DJ)(v,b,g,d,p);return C.align||((0,r.Yt)(w,b.x)?C.baseline||(C.baseline=S>b.y?"top":"bottom"):w>b.x?C.align="left":w<b.x&&(C.align="right")),_=w+("right"===C.align?-h:"left"===C.align?0:-h/2),x=S+("bottom"===C.baseline?-y:"top"===C.baseline?0:-y/2),(new o.FB).set(_,x,_+h,x+y).rotate(f,_+h/2,x+y/2)})},c=(t,e)=>{let i,{tickCount:r,forceTickCount:o,tickStep:h,getRadius:u,labelOffset:c,labelGap:g=0,labelStyle:f}=e,m=null==u?void 0:u();if(!m)return(0,a.KV)(t.domain());if((0,n.Z)(h))i=t.stepTicks(h);else if((0,n.Z)(o))i=t.forceTicks(o);else if((0,n.Z)(r)){let e=t.range(),n=Math.abs(e[e.length-1]-e[0]),l=(0,s.Z)(r)?r({axisLength:n,labelStyle:f}):r;i=t.ticks(l)}else if(e.sampling){let r=t.domain(),n=t.range(),s=d(t,r,e),a=(0,l.iH)(n),o=Math.abs((0,l.CE)(n)-a)*(m+c)/r.length,{step:h,delCount:u}=p(r,s,g,Math.floor(s.reduce((t,e)=>Math.min(t,e.width(),e.height()),Number.MAX_VALUE)/o));i=(i=t.stepTicks(h)).slice(0,i.length-u)}else i=t.domain();return(0,a.KV)(i)},p=(t,e,i,r)=>{let n=r;do{let r=!0;n++;let s=0;do s+n<t.length&&(0,a.jY)(e[s],e[s+n],i)&&(r=!1),s+=n;while(r&&s<t.length);if(r)break}while(n<=t.length);let s=0;if(t.length>2){let i=t.length-t.length%n;for(i>=t.length&&(i-=n);i>0&&(0,a.jY)(e[0],e[i]);)s++,i-=n}return{step:n,delCount:s}}},5533:function(t,e,i){"use strict";i.d(e,{KV:()=>a,SZ:()=>d,jY:()=>o,rd:()=>h,tz:()=>c});var r=i(76620),n=i(98706),s=i(80875),l=i(14135);let a=t=>t.map((t,e)=>({index:e,value:t})),o=(t,e,i=0)=>{let n=new r.FB(t).expand(i/2),s=new r.FB(e).expand(i/2);return n.intersects(s)},h=12,u=(t,e,i,r)=>i<t?Math.max(t-e/2,i):i>t?Math.min(t-e/2,i-e):i<r?i:i-e,d=(t,e,i)=>{var a,o,h;let{labelStyle:d,axisOrientType:c,labelFlush:p,labelFormatter:g,startAngle:f=0}=i,m=null!=(a=d.angle)?a:0;"vertical"===d.direction&&(m+=(0,n.M4)(90));let y=["bottom","top"].includes(c),v=["left","right"].includes(c),b=1,_=0;y||(v?(b=0,_=1):f&&(b=Math.cos(f),_=-Math.sin(f)));let x=(0,l.gM)(d),C=t.range(),w=[];for(let i=0;i<e.length;i++){let n=e[i],l=g?g(n):`${n}`;if((0,s.Z)(l)){w=void 0;break}let{width:a,height:c}=x.quickMeasure(l),f=Math.max(a,12),S=Math.max(c,12),A=t.scale(n),M=b*A,k=_*A,T,R,B=M,P=k;p&&y&&0===i?B=u(M,f,C[0],C[C.length-1]):p&&y&&i===e.length-1?B=u(M,f,C[C.length-1],C[0]):T=null!=(o=d.textAlign)?o:"center","right"===T?B-=f:"center"===T&&(B-=f/2),p&&v&&0===i?P=u(k,S,C[0],C[C.length-1]):p&&v&&i===e.length-1?P=u(k,S,C[C.length-1],C[0]):R=null!=(h=d.textBaseline)?h:"middle","bottom"===R?P-=S:"middle"===R&&(P-=S/2);let E=(new r.FB).set(B,P,B+f,P+S);m&&E.rotate(m,M,k),w.push(E)}return w},c=t=>["bottom","top","z"].includes(t)},3496:function(t,e,i){"use strict";i.d(e,{A9:()=>b,DJ:()=>f,cN:()=>c,jO:()=>p,mU:()=>g,qw:()=>v,st:()=>y,uX:()=>d,uf:()=>u,zl:()=>m});var r=i(95950),n=i(98706),s=i(70016),l=i(6091),a=i(69590),o=i(30427),h=i(96210);function u(t={}){var e,i;let{style:n={},angle:s=.5*Math.PI}=t,l=(0,r.Z)({},o.P,n),a=null!=(e=l.size)?e:o.P.size;return Object.assign(Object.assign({},l),{symbolType:null!=(i=l.symbolType)?i:`M ${-a/2} ${a*Math.sin(s)} L ${a/2} ${-a*Math.sin(s)}`,symbolSize:a})}function d(t){let e={};return(0,l.Ck)(t,t=>{"group"!==t.type&&t.id&&(e[t.id]=t)}),e}function c(t,e){return{x:t.x+e[0],y:t.y+e[1]}}function p(t,e,i,r=!1,n=!1){let s=[e.x-i.x,e.y-i.y];return(0,a.bA)(s,(r?-1:1)*(n?-1:1)*t/(0,a.kE)(s))}function g(t){let e="center",i="middle";return{align:e=(t=(0,n.LW)(t))>=5/3*Math.PI||t<=1/3*Math.PI?"left":t>=2/3*Math.PI&&t<=4/3*Math.PI?"right":"center",baseline:t>=7/6*Math.PI&&t<=11/6*Math.PI?"bottom":t>=1/6*Math.PI&&t<=5/6*Math.PI?"top":"middle"}}function f(t,e,i,r,s){var l;let a=(0,n.op)({x:0,y:0},i,t),o=c(a,p(r,a,e,s));return l=p(r||1,o,e,s),{x:o.x+l[0],y:o.y+l[1]}}function m(t,e,i,r,s){let l=[],a=s-r;for(let s=0;s<e;s++){let o=r+s*a/e;l.push((0,n.op)(t,i,o))}return l}function y(t,e){let i="";return 0===t.length||(t.forEach((t,e)=>{0===e?i=`M${t.x},${t.y}`:i+=`L${t.x},${t.y}`}),e&&(i+="Z")),i}function v(t,e,i){var r;let n=null==(r=t.attribute)?void 0:r.angle;if((0,h.nw)(n,Number.EPSILON))return i>(0,s.YB)(t.AABBBounds,e.AABBBounds);let l=t.OBBBounds,a=e.OBBBounds;return!l||!a||l.empty()||a.empty()?i>(0,s.YB)(t.AABBBounds,e.AABBBounds):l.intersects(a)||i>(0,s.up)(l,a)}function b(t,e){for(let i,r=1,n=t.length,s=t[0];r<n;s=i,++r)if(v(s,i=t[r],e))return!0;return!1}},29539:function(t,e,i){"use strict";i.d(e,{J:()=>c});var r=i(95950),n=i(74562),s=i(35953),l=i(77474),a=i(64103),o=i(15589),h=i(86972),u=i(69877),d=i(96628);(0,o.M)(),(0,h.k)(),(0,u.g)(),(0,d.i)();class c extends n.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},c.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?this.setAttribute("checked",!1):this.setAttribute("checked",!0),this.setAttribute("indeterminate",!1),this._dispatchEvent("checkbox_state_change",{eventType:"checkbox_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(t,e,i)=>{"interactive"in t&&this.setAttribute("pickable",t.interactive),"disabled"in t&&this.setAttribute("cursor",t.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderIcon(),this.renderText(),this.layout()}renderBox(){this._box=new s.U((0,r.Z)({},this.attribute.box));let t=this.attribute.checked||this.attribute.indeterminate;t&&this.attribute.disabled?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill,stroke:this.attribute.box.disableCheckedStroke}):t?this._box.setAttributes({fill:this.attribute.box.checkedFill,stroke:this.attribute.box.checkedStroke}):this.attribute.disabled&&this._box.setAttributes({fill:this.attribute.box.disableFill}),this.appendChild(this._box)}renderIcon(){this._checkIcon=new l.E((0,r.Z)({image:this.attribute.icon.checkIconImage},this.attribute.icon)),this.appendChild(this._checkIcon),this._indeterminateIcon=new l.E((0,r.Z)({image:this.attribute.icon.indeterminateIconImage},this.attribute.icon)),this.appendChild(this._indeterminateIcon),this.attribute.checked?(this._checkIcon.setAttribute("visible",!0),this._indeterminateIcon.setAttribute("visible",!1)):this.attribute.indeterminate?(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!0)):(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!1))}renderText(){this._text=new a.x((0,r.Z)({wrap:!0},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){let t=this.attribute.box.height,e=this.attribute.icon.height,i=this._text.AABBBounds.height(),r=Math.max(t,e,i),n=r/2-e/2,s=this.attribute.box.width,l=this.attribute.icon.width,a=Math.max(s,l),o=a/2-l/2,h=a+this.attribute.spaceBetweenTextAndIcon;this._box.setAttributes({x:a/2-s/2,y:r/2-t/2}),this._checkIcon.setAttributes({x:o,y:n}),this._indeterminateIcon.setAttributes({x:o,y:n}),this._text.setAttributes({x:h,y:r/2-i/2})}initAttributes(t,e){t=(null==e?void 0:e.skipDefault)?t:(0,r.Z)({},c.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}c.defaultAttributes={interactive:!0,disabled:!1,checked:!1,indeterminate:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},icon:{checkIconImage:'<svg width="200" height="200" viewBox="0 0 1024 1024" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path d="M877.44815445 206.10060629a64.72691371 64.72691371 0 0 0-95.14856334 4.01306852L380.73381888 685.46812814 235.22771741 533.48933518a64.72691371 64.72691371 0 0 0-92.43003222-1.03563036l-45.82665557 45.82665443a64.72691371 64.72691371 0 0 0-0.90617629 90.61767965l239.61903446 250.10479331a64.72691371 64.72691371 0 0 0 71.19960405 15.14609778 64.33855261 64.33855261 0 0 0 35.08198741-21.23042702l36.24707186-42.71976334 40.5190474-40.77795556-3.36579926-3.49525333 411.40426297-486.74638962a64.72691371 64.72691371 0 0 0-3.88361443-87.64024149l-45.3088404-45.43829334z"></path></svg>',indeterminateIconImage:'<svg width="200" height="200" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="5" d="M5 12h14"/></svg>',width:10,height:10,pickable:!1},box:{width:14,height:14,cornerRadius:2,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}}},76114:function(t,e,i){"use strict";var r,n;i.d(e,{$M:()=>o,Di:()=>l,HW:()=>r,Ze:()=>u,eV:()=>c,gB:()=>p,iR:()=>a,m3:()=>d,n0:()=>h,v2:()=>s});let s=-.5*Math.PI,l=1.5*Math.PI,a="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",o=14;(n=r||(r={})).selected="selected",n.selectedReverse="selected_reverse",n.hover="hover",n.hoverReverse="hover_reverse";let h={[r.selectedReverse]:{},[r.selected]:{},[r.hover]:{},[r.hoverReverse]:{}},u={container:"",width:30,height:30,style:{}},d="scrollDown",c="scrollDrag",p="scrollUp"},74562:function(t,e,i){"use strict";i.d(e,{k:()=>u});var r=i(75485),n=i(60981),s=i(80875),l=i(98116),a=i(95950),o=i(35652);let h=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"];class u extends r.ZA{constructor(t,e){super(t),this._skipRenderAttributes=h,(null==e?void 0:e.mode)&&(this.mode=e.mode,this.setMode(e.mode)),(null==e?void 0:e.skipDefault)&&(this.skipDefault=!0),this.setTheme({common:{strokeBoundsBuffer:0}}),this.attribute=t,this.onSetStage(()=>{this.render(),this.bindEvents()})}setAttribute(t,e,i,r){let n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);if(n)return this._setAttributes(n,i);(0,s.Z)(this.attribute[t])&&(0,s.Z)(e)&&!(0,l.Z)(this.attribute[t])&&!(0,l.Z)(e)?(0,a.Z)(this.attribute[t],e):this.attribute[t]=e,this._skipRenderAttributes.includes(t)||this.render(),this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(i||this.needUpdateTag(t))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}setAttributes(t,e,i){return t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t,this._setAttributes(t,e)}_setAttributes(t,e){let i=Object.keys(t);this._mergeAttributes(t,i),i.every(t=>this._skipRenderAttributes.includes(t))||this.render(),this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(e||this.needUpdateTags(i))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}_mergeAttributes(t,e){(0,o.Z)(e)&&(e=Object.keys(t));for(let i=0;i<e.length;i++){let r=e[i];!(0,s.Z)(this.attribute[r])||(0,l.Z)(this.attribute[r])||(0,l.Z)(t[r])?this.attribute[r]=t[r]:(0,a.Z)(this.attribute[r],t[r])}}bindEvents(){}_getNodeId(t){var e;return`${null!=(e=this.id)?e:this._uid}-${this.name}-${t}`}_dispatchEvent(t,e){var i;let r=new n.A(t,e);r.manager=null==(i=this.stage)?void 0:i.eventSystem.manager,this.dispatchEvent(r)}eventPosToStagePos(t){var e,i;let r={x:0,y:0},n=null!=(i=null==(e=this.stage)?void 0:e.eventPointTransform(t))?i:{x:0,y:0};return this.globalTransMatrix.transformPoint(n,r),r}}},45890:function(t,e,i){"use strict";i.d(e,{U:()=>h});var r=i(11681),n=i(21777),s=i(45011),l=i(74562),a=i(52404),o=i(35622);class h extends l.k{constructor(){super(...arguments),this.name="legend",this._title=null}render(){this.removeAllChild(!0);let{interactive:t=!0,title:e,padding:i=0}=this.attribute;this._parsedPadding=(0,r.o)(i);let n=s.i.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:t,childrenPickable:t});n.name=o.GN.innerView,this.add(n),this._innerView=n,(null==e?void 0:e.visible)&&this._renderTitle(e),this._renderContent(),this._adjustLayout(),t&&this._bindEvents();let l=this._innerView.AABBBounds;this.attribute.width=l.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=l.height()+this._parsedPadding[0]+this._parsedPadding[2]}_renderTitle(t){let{text:e="",textStyle:i,padding:s=0,background:l,minWidth:h,maxWidth:u,shape:d}=t,c={x:0,y:0,text:e,textStyle:i,padding:(0,r.o)(s),minWidth:h,maxWidth:u};d&&d.visible&&(c.shape=Object.assign({visible:!0},d.style),(0,n.Z)(d.space)&&(c.space=d.space)),l&&l.visible&&(c.panel=Object.assign({visible:!0},l.style));let p=new a.V(c);p.name=o.GN.title,this._title=p,this._innerView.add(p)}_adjustLayout(){var t;if(this._title){let e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),r=null==(t=this.attribute.title)?void 0:t.align;"center"===r?this._title.setAttribute("x",(e-i)/2):"end"===r&&this._title.setAttribute("x",e-i)}}}},58183:function(t,e,i){"use strict";i.d(e,{e:()=>$});var r={};i.r(r),i.d(r,{LX:()=>O});var n=i(95950),s=i(35652),l=i(59225),a=i(47704),o=i(83143),h=i(21777);let u=t=>{let e=null,i=null;return(...r)=>(e&&r.every((t,i)=>t===e[i])||(e=r,i=t(...r)),i)};var d=i(45273),c=i(45103);function p(t){return t}function g(t,e){if(t=Number(t),e=Number(e)-t)return i=>(i-t)/e;let i=Number.isNaN(e)?NaN:.5;return()=>i}function f(t,e,i){let r,n,s=t[0],l=t[1],a=e[0],o=e[1];return l<s?(r=g(l,s),n=i(o,a)):(r=g(s,l),n=i(a,o)),t=>n(r(t))}function m(t,e,i){let r=Math.min(t.length,e.length)-1,n=Array(r),s=Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)n[l]=g(t[l],t[l+1]),s[l]=i(e[l],e[l+1]);return function(e){let i=(0,c.b4)(t,e,1,r)-1;return s[i](n[i](e))}}let y=(t,e=!1)=>{let i=Math.floor(Math.log10(t)),r=t/Math.pow(10,i);return(e?r<1.5?1:r<3?2:r<7?5:10:r<=1?1:r<=2?2:r<=5?5:10)*Math.pow(10,i)},v=(t,e)=>{let i,r;return e[0]<e[1]?(i=e[0],r=e[1]):(i=e[1],r=e[0]),Math.min(Math.max(t,i),r)},b=Math.sqrt(50),_=Math.sqrt(10),x=Math.sqrt(2),C=(t,e,i)=>{let r=1,n=t,s=Math.floor((e-1)/2),l=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?n=0:t<0&&t>=-Number.MIN_VALUE?n=-(e-1):!i&&l<1?r=k(l).step:(i||l>1)&&(n=Math.floor(t)-s*r),r>0?(t>0?n=Math.max(n,0):t<0&&(n=Math.min(n,-(e-1)*r)),(function(t,e,i){(0,h.Z)(e)||(e=t,t=0),(0,h.Z)(i)||(i=1);let r=-1,n=0|Math.max(0,Math.ceil((e-t)/i)),s=Array(n);for(;++r<n;)s[r]=t+r*i;return s})(0,e).map(t=>n+t*r)):t>0?S(0,-(e-1)/r,r):S((e-1)/r,0,r)},w=u((t,e,i,r)=>{let n,s,l,a,o=-1;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((n=e<t)&&(s=t,t=e,e=s),!isFinite(a=T(t,e,i).step))return[];if(a>0){let i=Math.round(t/a),r=Math.round(e/a);for(i*a<t&&++i,r*a>e&&--r,l=Array(s=r-i+1);++o<s;)l[o]=(i+o)*a}else if(a<0&&(null==r?void 0:r.noDecimals)){a=1;let i=Math.ceil(t),r=Math.floor(e);if(!(i<=r))return[];for(l=Array(s=r-i+1);++o<s;)l[o]=i+o}else{let i=Math.round(t*(a=-a)),r=Math.round(e*a);for(i/a<t&&++i,r/a>e&&--r,l=Array(s=r-i+1);++o<s;)l[o]=(i+o)/a}return n&&l.reverse(),l}),S=(t,e,i)=>{let r,n,s=-1;if(i>0){let l=Math.floor(t/i),a=Math.ceil(e/i);for((l+1)*i<t&&++l,(a-1)*i>e&&--a,n=Array(r=a-l+1);++s<r;)n[s]=(l+s)*i}else{let l=Math.floor(t*(i=-i)),a=Math.ceil(e*i);for((l+1)/i<t&&++l,(a-1)/i>e&&--a,n=Array(r=a-l+1);++s<r;)n[s]=(l+s)/i}return n},A=(t,e,i)=>{let r,n=t[0],s=t[t.length-1],l=e-t.length;if(s<=0){let e=[];for(r=l;r>=1;r--)e.push(n-r*i);return e.concat(t)}if(n>=0){for(r=1;r<=l;r++)t.push(s+r*i);return t}let a=[],o=[];for(r=1;r<=l;r++)r%2==0?a=[n-Math.floor(r/2)*i].concat(a):o.push(s+Math.ceil(r/2)*i);return a.concat(t).concat(o)},M=u((t,e,i,r)=>{let n,s,l;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return C(t,i,null==r?void 0:r.noDecimals);(n=e<t)&&(l=t,t=e,e=l);let a=T(t,e,i),o=a.step;if(!isFinite(o))return[];if(o>0){let r=1,{power:n,gap:l}=a,h=10===l?2*10**n:+(10**n);for(;r<=5&&(s=S(t,e,o)).length>i+1&&i>2;)o+=h,r+=1;i>2&&s.length<i-1&&(s=A(s,i,o))}else(null==r?void 0:r.noDecimals)&&o<0&&(o=1),s=S(t,e,o);return n&&s.reverse(),s}),k=t=>{let e=Math.floor(Math.log(t)/Math.LN10),i=t/10**e,r=1;return i>=b?r=10:i>=_?r=5:i>=x&&(r=2),e>=0?{step:r*10**e,gap:r,power:e}:{step:-(10**-e)/r,gap:r,power:e}};function T(t,e,i){return k((e-t)/Math.max(0,i))}function R(t,e,i){let r;if(i*=1,(t*=1)==(e*=1)&&i>0)return[t];if(i<=0||0==(r=(e-t)/Math.max(1,i-1))||!isFinite(r))return[];let n=Array(i);for(let e=0;e<i;e++)n[e]=t+e*r;return n}function B(t,e,i){let r,n,s=-1;if(i*=1,(n=(e*=1)<(t*=1))&&(r=t,t=e,e=r),!isFinite(i)||e-t<=i)return[t];let l=Math.floor((e-t)/i+1),a=Array(l);for(;++s<l;)a[s]=t+s*i;return n&&a.reverse(),a}function P(t,e=10){let i,r,n=0,s=t.length-1,l=t[n],a=t[s],o=10;for(a<l&&(r=l,l=a,a=r,r=n,n=s,s=r);o-- >0;){if((r=T(l,a,e).step)===i)return t[n]=l,t[s]=a,t;if(r>0)l=Math.floor(l/r)*r,a=Math.ceil(a/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,a=Math.floor(a*r)/r}i=r}}let E=(t,e,i)=>1>Math.abs(e-t)?+i.toFixed(1):Math.round(+i);u((t,e,i,r,n,s,l)=>{let a=t,o=e,h=o<a;h&&([a,o]=[o,a]);let u,d,c=n(a),p=n(o),g=[];if(!(r%1)&&p-c<i){if(c=Math.floor(c),p=Math.ceil(p),a>0){for(;c<=p;++c)for(u=1;u<r;++u)if(!((d=c<0?u/s(-c):u*s(c))<a)){if(d>o)break;g.push(d)}}else for(;c<=p;++c)for(u=r-1;u>=1;--u)if(!((d=c>0?u/s(-c):u*s(c))<a)){if(d>o)break;g.push(d)}2*g.length<i&&(g=M(a,o,i))}else g=M(c,p,Math.min(p-c,i)).map(s);return g=g.filter(t=>0!==t),(null==l?void 0:l.noDecimals)&&(g=Array.from(new Set(g.map(t=>Math.floor(t))))),h?g.reverse():g}),u((t,e,i,r,n,s)=>{let l=[],a={},o=n(t),h=n(e),u=[];if(Number.isInteger(r))u=M(o,h,i);else{let t=(h-o)/(i-1);for(let e=0;e<i;e++)u.push(o+e*t)}return u.forEach(i=>{let n=s(i),o=Number.isInteger(r)?E(t,e,n):E(t,e,y(n)),h=E(t,e,v(o,[t,e]));a[h]||isNaN(h)||!(u.length>1)||(a[h]=1,l.push(h))}),l}),u((t,e,i,r,n)=>R(r(t),r(e),i).map(t=>y(n(t)))),u((t,e,i,r,n)=>B(r(t),r(e),i).map(t=>y(n(t))));var I=i(21648);class L{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:(0,h.Z)(this._rangeFactorStart)&&(0,h.Z)(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=function(t,e){let i=(t[1]-t[0])/(e[1]-e[0]),r=t[0]-i*e[0];return[r,i+r]}(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(2===t.length&&t.every(t=>t>=0&&t<=1)&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):(0,h.Z)(this._rangeFactorStart)&&(0,h.Z)(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return(0,s.Z)(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&((0,s.Z)(this._rangeFactorEnd)||1===this._rangeFactorEnd)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t,this._rangeFactorEnd=null!=(i=this._rangeFactorEnd)?i:1)),this)}rangeFactorEnd(t,e){var i;return(0,s.Z)(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&((0,s.Z)(this._rangeFactorStart)||0===this._rangeFactorStart)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorEnd=t,this._rangeFactorStart=null!=(i=this._rangeFactorStart)?i:0)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);let{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,n=this.range(),l=n[0],a=n[n.length-1],o=Math.min(l,a),h=Math.max(l,a),u=(0,I.Z)(null!=(t=this._fishEyeOptions.focus)?t:0,o,h),d=(0,s.Z)(r)?(h-o)*i:r,c=Math.exp(e);c=c/(c-1)*d;let p=e/d;this._fishEyeTransform=t=>{let e=Math.abs(t-u);return e>=d?t:e<=1e-6?u:u+(t-u)*(c*(1-Math.exp(-e*p))/e*.75+.25)}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var i;return null!=(i=null==this?void 0:this[t])?i:e}}var F=i(14925);function O(t,e){let i=t.r,r=e.r,n=t.g,s=e.g,l=t.b,a=e.b,o=t.opacity,h=e.opacity;return t=>{let e=Math.round(i*(1-t)+r*t),u=Math.round(n*(1-t)+s*t),d=Math.round(l*(1-t)+a*t);return new F.eX(e,u,d,o*(1-t)+h*t)}}function D(t,e){return i=>t*(1-i)+e*i}function H(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}RegExp(/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g.source,"g");let{LX:z}=r;function W(t,e){let i,r=typeof e;if((0,s.Z)(e)||"boolean"===r)return()=>e;if("number"===r)return D(t,e);if("string"===r){if(i=F.Il.parseColorString(e)){let e=z(F.Il.parseColorString(t),i);return t=>e(t).formatRgb()}return D(Number(t),Number(e))}return e instanceof F.eX?z(t,e):e instanceof F.Il?z(t.color,e.color):e instanceof Date?function(t,e){let i=t.valueOf(),r=e.valueOf(),n=new Date;return t=>(n.setTime(i*(1-t)+r*t),n)}(t,e):D(Number(t),Number(e))}function N(t){return Number(t)}class j extends L{constructor(t=p,e=p){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=p,this._piecewise=f,this._interpolate=W}calculateVisibleDomain(t){var e;return(0,h.Z)(this._rangeFactorStart)&&(0,h.Z)(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!=(e=this._niceDomain)?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),D)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return(null!=(i=this._niceDomain)?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;let r=Array.from(t,N);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();let i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){let i=Array.from(t);return this._range=i,this._interpolate=H,this.rescale(e)}rescale(t){var e,i,r;let n;if(t)return this;let s=null!=(e=this._niceDomain)?e:this._domain,l=s.length,a=this._range.length,o=Math.min(l,a);if(l&&l<a&&this._forceAlign){let t=a-l+1,e=s[l-1],i=l>=2?(e-s[l-2])/t:0;for(let r=1;r<=t;r++)s[l-2+r]=e-i*(t-r);o=a}return this._autoClamp&&(this._clamp=(i=s[0],r=s[o-1],i>r&&(n=i,i=r,r=n),t=>Math.max(i,Math.min(r,t)))),this._piecewise=o>2?m:f,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:p),this.rescale(i)):this._clamp!==p}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){let e=this.ticks(t);return(null!=e?e:[]).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return(0,s.Z)(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return(0,s.Z)(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}var G=i(98116);class V extends j{constructor(){super(...arguments),this.type=o._f.Linear}clone(){var t;let e=new V;return e.domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate),this._niceType&&(e._niceType=this._niceType,e._domainValidator=this._domainValidator,e._niceDomain=null==(t=this._niceDomain)?void 0:t.slice()),e}tickFormat(){return()=>{}}d3Ticks(t=10,e){let i=this.calculateVisibleDomain(this._range);return w(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if((0,G.Z)(null==e?void 0:e.customTicks))return e.customTicks(this,t);if((0,h.Z)(this._rangeFactorStart)&&(0,h.Z)(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(t,e);let r=null!=(i=this._niceDomain)?i:this._domain,n=this._domain,s=r[0],l=r[r.length-1],a=M(n[0],n[n.length-1],t,e);if(!a.length)return a;if(this._domainValidator)a=a.filter(this._domainValidator);else if((a[0]!==s||a[a.length-1]!==l)&&this._niceType){let t=r.slice();if("all"===this._niceType?(t[0]=a[0],t[t.length-1]=a[a.length-1],this._niceDomain=t,this.rescale()):"min"===this._niceType&&a[0]!==s?(t[0]=a[0],this._niceDomain=t,this.rescale()):"max"===this._niceType&&a[a.length-1]!==l&&(t[t.length-1]=a[a.length-1],this._niceDomain=t,this.rescale()),"all"!==this._niceType){let e=Math.min(t[0],t[t.length-1]),i=Math.max(t[0],t[t.length-1]);a=a.filter(t=>t>=e&&t<=i)}}return a}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return R(e[0],e[e.length-1],t)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return B(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;let n=this._domain,s=[];if(e){let t=function(t,e){let i=(0,d.Z)(e.forceMin),r=(0,d.Z)(e.forceMax),n=null,s=[],l=null,a=i&&r?t=>t>=e.forceMin&&t<=e.forceMax:i?t=>t>=e.forceMin:r?t=>t<=e.forceMax:null;return i?s[0]=e.forceMin:(0,d.Z)(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(s[0]=e.min),r?s[1]=e.forceMax:(0,d.Z)(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(s[1]=e.max),(0,d.Z)(s[0])&&(0,d.Z)(s[1])?((l=t.slice())[0]=s[0],l[l.length-1]=s[1]):n=(0,d.Z)(s[0])||(0,d.Z)(s[1])?(0,d.Z)(s[0])?"max":"min":"all",{niceType:n,niceDomain:l,niceMinMax:s,domainValidator:a}}(n,e);if(s=t.niceMinMax,this._domainValidator=t.domainValidator,this._niceType=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){let e=P(n.slice(),t);"min"===this._niceType?e[e.length-1]=null!=(i=s[1])?i:e[e.length-1]:"max"===this._niceType&&(e[0]=null!=(r=s[0])?r:e[0]),this._niceDomain=e,this.rescale()}return this}niceMin(t=10){this._niceType="min";let e=this._domain[this._domain.length-1],i=P(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";let e=this._domain[0],i=P(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}var Z=i(45890),U=i(16018),K=i(35622);(0,i(54062).Fw)();class $ extends Z.U{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,n.Z)({},$.defaultAttributes,t)),this.name="colorLegend",this._onSliderToolipChange=t=>{let e=this._slider.tooltipShape;if(e&&t.detail&&!(0,s.Z)(t.detail.value)){let i=this._colorScale.scale(t.detail.value);e.setAttribute("fill",i)}this.dispatchEvent(t)},this._onSliderChange=t=>{this._updateColor(),this.dispatchEvent(t)}}setSelected(t){this._slider&&(this._slider.setValue(t),this._updateColor())}_renderContent(){let{colors:t,slidable:e,layout:i,align:r,min:n,max:s,value:a,railWidth:o,railHeight:h,showHandler:u=!0,handlerSize:d,handlerStyle:c,railStyle:p,trackStyle:g,startText:f,endText:m,handlerText:y,showTooltip:v,tooltip:b,inverse:_,disableTriggerEvent:x}=this.attribute,C=[],w=(s-n)/(t.length-1);for(let e=0;e<t.length;e++)C.push(n+w*e);this._colorScale=(new V).domain(C,!0).range(t),this._color=this._getTrackColor();let S=new U.i({x:0,y:0,range:{draggableTrack:!0},slidable:e,layout:i,align:r,min:n,max:s,value:a,railWidth:o,railHeight:h,showHandler:u,handlerSize:d,handlerStyle:c,railStyle:p,trackStyle:Object.assign({fill:this._color},g),startText:f,endText:m,handlerText:y,showTooltip:v,tooltip:b,disableTriggerEvent:x,inverse:_});this._innerView.add(S),this._slider=S,S.translateTo(0-S.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+(0,l.Z)(this.attribute,"title.space",K.$5):0)-S.AABBBounds.y1),this._updateColor()}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}_getTrackColor(){let{colors:t,layout:e,inverse:i}=this.attribute;if((0,a.Z)(t))return;let r=t.length;if(1===r)return t[0];let n=[];for(let e=0;e<r;e++){let i=e/(r-1);n.push({offset:i,color:t[e]})}let s="horizontal"===e,l={gradient:"linear",stops:n,x0:0,y0:0,x1:+!!s,y1:+!s};return i&&(s?(l.x0=1,l.x1=0):(l.y0=1,l.y1=0)),l}_updateColor(){var t;let{layout:e="horizontal",colors:i,railWidth:r,railHeight:n}=this.attribute,{startHandler:s,endHandler:l,track:a,attribute:o}=this._slider,{startValue:h,endValue:u,startPos:d,endPos:c}=this._slider.currentValue,p=null==(t=o.handlerStyle)?void 0:t.fill;if(s&&!p){let t=this._colorScale.scale(h);s.setAttribute("fill",t)}if(l&&!p){let t=this._colorScale.scale(u);l.setAttribute("fill",t)}let g="horizontal"===e?r:n;if(Math.abs(d-c)!==g&&i&&i.length>1){let t=this._color.stops,e=Math.min(d,c)/g,i=Math.max(d,c)/g,r=i-e,n=t.filter(t=>t.offset>e&&t.offset<i),s=Math.min(h,u),l=Math.max(h,u),o=this._colorScale.scale(s),p=this._colorScale.scale(l),f=[{offset:0,color:o}];n.forEach(t=>{f.push({offset:(t.offset-e)/r,color:t.color})}),f.push({offset:1,color:p}),a.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:f}))}}}$.defaultAttributes={layout:"horizontal",title:{align:"start",space:K.$5,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}}},35622:function(t,e,i){"use strict";var r,n,s,l,a,o;i.d(e,{$5:()=>f,DN:()=>d,GN:()=>s,Nu:()=>p,SX:()=>h,Th:()=>m,dk:()=>n,g:()=>u,qL:()=>c,so:()=>g,uu:()=>r});let h=10,u=8,d=8,c=8,p=16,g=8,f=12,m=12;(l=r||(r={})).selected="selected",l.unSelected="unSelected",l.selectedHover="selectedHover",l.unSelectedHover="unSelectedHover",l.focus="focus",(a=n||(n={})).legendItemHover="legendItemHover",a.legendItemUnHover="legendItemUnHover",a.legendItemClick="legendItemClick",a.legendItemAttributeUpdate="legendItemAttributeUpdate",(o=s||(s={})).innerView="innerView",o.title="legendTitle",o.item="legendItem",o.itemShape="legendItemShape",o.itemLabel="legendItemLabel",o.itemValue="legendItemValue",o.focus="legendItemFocus"},48742:function(t,e,i){"use strict";i.d(e,{W:()=>R});var r=i(95950),n=i(31535),s=i(21777),l=i(47704),a=i(88663),o=i(59225),h=i(43562),u=i(11681),d=i(35652),c=i(70527),p=i(25258),g=i(21648),f=i(98116),m=i(45011),y=i(45890),v=i(45273),b=i(74562),_=i(14135),x=i(97160);let C={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};(0,x.s)();class w extends b.k{getCurrent(){return this._current}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},w.defaultAttributes,t)),this.name="pager",this._current=1,this._onHover=t=>{let e=t.target;e.hasState("disable")||e.addState("hover")},this._onUnHover=t=>{t.target.removeState("hover")},this._onClick=t=>{let e=t.target;if("preHandler"===e.name){if(1===this._current)return;this._current-=1,1===this._current?e.addState("disable"):e.removeState("disable"),this._dispatchEvent("toPrev",{current:this._current,total:this._total,direction:"pre",event:t})}if("nextHandler"===e.name){if(this._current===this._total)return;this._current+=1,this._current===this._total?e.addState("disable"):e.removeState("disable"),this._dispatchEvent("toNext",{current:this._current,total:this._total,direction:"next",event:t})}this._current>1&&this.preHandler.removeState("disable"),this._current<this._total&&this.nextHandler.removeState("disable"),this.text.setAttribute("text",this._getPageText(this._current))}}render(){var t,e,i;this._reset();let{layout:r="horizontal",handler:n=C,total:s,defaultCurrent:l=1,textStyle:a,padding:o=0}=this.attribute;this._current=l;let h=(0,u.o)(o),d="horizontal"===r,c=m.i.group({x:0,y:0}),p=n.style||{},g=p.size||15,f=null!=(t=n.space)?t:8,y=n.state||{},{preShape:b,nextShape:x}=n;b||(b=d?"triangleLeft":"triangleUp"),x||(x=d?"triangleRight":"triangleDown");let w=m.i.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},p),{x:0,y:0,symbolType:b,size:g}));w.states=y,w.name="preHandler",this.preHandler=w,c.add(w);let{width:S,height:A}=(0,_.fe)(this._getPageText(s),Object.assign({textAlign:"center",textBaseline:"middle"},a),null==(i=null==(e=this.stage)?void 0:e.getTheme())?void 0:i.text),M=(0,v.Z)(g)?g:g[0],k=(0,v.Z)(g)?g:g[1],T=m.i.text(Object.assign({x:d?M/2+f+S/2:0,y:d?0:k/2+f+A/2,text:this._getPageText(l),textAlign:"center",textBaseline:"middle",lineHeight:null==a?void 0:a.fontSize},a));this.text=T,c.add(T);let R=m.i.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},p),{x:d?M+2*f+S:0,y:d?0:k+2*f+A,symbolType:x,size:g}));R.name="nextHandler",R.states=y,this.nextHandler=R,c.add(R),1===this._total?(w.addState("disable"),R.addState("disable")):1===this._current?w.addState("disable"):this._current===s&&R.addState("disable");let B=c.AABBBounds,P=B.width(),E=B.height();c.translateTo(0-B.x1+h[3],0-B.y1+h[0]),this.add(c),this.attribute.width=P+h[1]+h[3],this.attribute.height=E+h[0]+h[2],this._bindEvents()}_bindEvents(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}_reset(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}_getPageText(t){let{pageFormatter:e}=this.attribute;return e?(0,f.Z)(e)?e(t,this._total):`${e}`.replace("{current}",`${t}`).replace("{total}",`${this._total}`):`${t}/${this._total}`}setTotal(t){t!==this.attribute.total&&(this._total=t,1!==this._current&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}w.defaultAttributes={handler:C,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};var S=i(35622),A=i(54062),M=i(57823),k=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let T={[S.uu.focus]:{},[S.uu.selected]:{},[S.uu.selectedHover]:{},[S.uu.unSelected]:{},[S.uu.unSelectedHover]:{}};(0,A.cV)();class R extends y.U{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},R.defaultAttributes,t)),this.name="discreteLegend",this._itemsContainer=null,this._itemHeightByUser=void 0,this._itemHeight=0,this._itemMaxWidth=0,this._contentMaxHeight=0,this._onHover=t=>{let e=t.target;if(e&&e.name&&e.name.startsWith(S.GN.item)){let i=e.delegate;if(this._lastActiveItem){if(this._lastActiveItem.id===i.id)return;this._unHover(this._lastActiveItem,t)}this._hover(i,t)}else this._lastActiveItem&&(this._unHover(this._lastActiveItem,t),this._lastActiveItem=null)},this._onUnHover=t=>{this._lastActiveItem&&(this._unHover(this._lastActiveItem,t),this._lastActiveItem=null)},this._onClick=t=>{var e,i,r,n;let s=t.target;if(s&&s.name&&s.name.startsWith(S.GN.item)){let l=s.delegate,{selectMode:a="multiple"}=this.attribute;if(s.name===S.GN.focus||"focus"===a){let r=l.hasState(S.uu.focus);l.toggleState(S.uu.focus),r?null==(e=this._itemsContainer)||e.getChildren().forEach(e=>{this._removeLegendItemState(e,[S.uu.unSelected,S.uu.unSelectedHover,S.uu.focus],t),this._setLegendItemState(e,S.uu.selected,t)}):(this._setLegendItemState(l,S.uu.selected,t),this._removeLegendItemState(l,[S.uu.unSelected,S.uu.unSelectedHover],t),null==(i=this._itemsContainer)||i.getChildren().forEach(e=>{l!==e&&(this._removeLegendItemState(e,[S.uu.selected,S.uu.selectedHover,S.uu.focus],t),this._setLegendItemState(e,S.uu.unSelected,t))}))}else{null==(r=this._itemsContainer)||r.getChildren().forEach(t=>{t.removeState(S.uu.focus)});let{allowAllCanceled:e=!0}=this.attribute,i=l.hasState(S.uu.selected),s=this._getSelectedLegends();if("multiple"===a){if(!1===e&&i&&1===s.length)return void this._dispatchLegendEvent(S.dk.legendItemClick,l,t);i?(this._removeLegendItemState(l,[S.uu.selected,S.uu.selectedHover],t),this._setLegendItemState(l,S.uu.unSelected,t)):(this._setLegendItemState(l,S.uu.selected,t),this._removeLegendItemState(l,[S.uu.unSelected,S.uu.unSelectedHover],t))}else this._setLegendItemState(l,S.uu.selected,t),this._removeLegendItemState(l,[S.uu.unSelected,S.uu.unSelectedHover],t),null==(n=this._itemsContainer)||n.getChildren().forEach(e=>{l!==e&&(this._removeLegendItemState(e,[S.uu.selected,S.uu.selectedHover],t),this._setLegendItemState(e,S.uu.unSelected,t))})}this._dispatchLegendEvent(S.dk.legendItemClick,l,t)}}}render(){super.render(),this._lastActiveItem=null}setSelected(t){var e;(null==(e=this._itemsContainer)?void 0:e.getChildren()).forEach(e=>{let i=e.data;t.includes(i.label)?(this._setLegendItemState(e,S.uu.selected),this._removeLegendItemState(e,[S.uu.unSelected,S.uu.unSelectedHover])):(this._removeLegendItemState(e,[S.uu.selected,S.uu.selectedHover]),this._setLegendItemState(e,S.uu.unSelected))})}_renderItems(){let{item:t={},maxCol:e=1,maxRow:i=2,maxWidth:r,defaultSelected:l,lazyload:a,autoPage:o}=this.attribute,{spaceCol:h=S.Nu,spaceRow:u=S.so,verticalAlign:d="middle"}=t,c=this._itemsContainer,{items:p,isHorizontal:g,startIndex:f,isScrollbar:m}=this._itemContext,y=m?1:g?i:e,v=this._contentMaxHeight,b,{doWrap:_,maxWidthInCol:x,startX:C,startY:w,pages:A}=this._itemContext,M=0,k=0,T=[];for(let t=f,e=p.length;t<e&&!(a&&A>this._itemContext.currentPage*y);t++){a&&(this._itemContext.startIndex=t+1),(b=p[t]).id||(b.id=b.label),b.index=t;let e=!0;(0,n.Z)(l)&&(e=l.includes(b.label));let i=this._renderEachItem(b,e,t,p),f=i.attribute.width,y=i.attribute.height;this._itemHeight=Math.max(this._itemHeight,y),x=Math.max(f,x),this._itemMaxWidth=Math.max(f,this._itemMaxWidth),g?((0,s.Z)(r)&&(m&&o?_=(A=Math.ceil((C+f)/r))>1:C+f>r&&(_=!0,C>0&&("middle"!==d&&"bottom"!==d||T.forEach(t=>{t.setAttributes({y:t.attribute.y+(k-t.attribute.height)/("middle"===d?2:1)})}),A+=1,C=0,w+=k+u,k=0,T.length=0))),0===C&&0===w||i.setAttributes({x:C,y:w}),C+=h+f,k=Math.max(k,y),T.push(i)):((0,s.Z)(v)&&(m&&o?_=(A=Math.ceil((w+y)/v))>1:v<=y?(A+=1,_=!0,w=0,t>0&&(C+=M+h)):v<w+y&&(A+=1,_=!0,w=0,C+=x+h,x=0)),0===C&&0===w||i.setAttributes({x:C,y:w}),w+=u+y),c.add(i),M=f}return g&&("middle"===d||"bottom"===d)&&T.forEach(t=>{t.setAttributes({y:t.attribute.y+(k-t.attribute.height)/("middle"===d?2:1)})}),this._itemContext.doWrap=_,this._itemContext.startX=C,this._itemContext.startY=w,this._itemContext.maxWidthInCol=x,this._itemContext.pages=A,this._itemContext.maxPages=y,m&&(this._itemContext.totalPage=A),a||(this._itemContext.startIndex=p.length),this._itemContext}_renderContent(){let{item:t={},items:e,reversed:i,maxWidth:r,maxHeight:n}=this.attribute;if(!1===t.visible||(0,l.Z)(e))return;let h=e;i&&(h=null==e?void 0:e.reverse()),this._contentMaxHeight=Math.max(0,n-this._parsedPadding[0]-this._parsedPadding[2]);let u=m.i.group({x:0,y:0});this._itemsContainer=u;let{layout:d,autoPage:c}=this.attribute,{maxWidth:p,width:g,height:f}=t,y=[];(0,s.Z)(p)&&y.push(p),(0,s.Z)(g)&&y.push(g),y.length&&((0,s.Z)(r)&&y.push(r),this._itemWidthByUser=(0,a.iH)(y)),(0,s.Z)(f)&&(this._itemHeightByUser=f);let v=this.attribute.pager;this._itemContext={currentPage:v&&v.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:h,isHorizontal:"horizontal"===d,totalPage:1/0,isScrollbar:v&&"scrollbar"===v.type,clipContainer:void 0},this._itemContext=this._renderItems();let b=!1;this._itemContext.doWrap&&c&&this._itemContext.pages>this._itemContext.maxPages&&(b=this._renderPagerComponent()),b||(u.setAttribute("y",this._title?this._title.AABBBounds.height()+(0,o.Z)(this.attribute,"title.space",8):0),this._innerView.add(u))}_bindEvents(){if(this.attribute.disableTriggerEvent||!this._itemsContainer)return;let{hover:t=!0,select:e=!0}=this.attribute;if(t){let e="pointermove",i="pointerleave";(0,h.Z)(t)&&(t.trigger&&(e=t.trigger),t.triggerOff&&(i=t.triggerOff)),this._itemsContainer.addEventListener(e,this._onHover),this._itemsContainer.addEventListener(i,this._onUnHover)}if(e){let t="pointerdown";(0,h.Z)(e)&&e.trigger&&(t=e.trigger),this._itemsContainer.addEventListener(t,this._onClick)}}_autoEllipsis(t,e,i,r){var n,s;let{label:l,value:a}=this.attribute.item,o=r.AABBBounds,h=i.AABBBounds,u=o.width(),d=h.width(),c=!1;"labelFirst"===t?d>e?c=!0:r.setAttribute("maxLineWidth",e-d):"valueFirst"===t?u>e?c=!0:i.setAttribute("maxLineWidth",e-u):u+d>e&&(c=!0),c&&(r.setAttribute("maxLineWidth",Math.max(e*(null!=(n=l.widthRatio)?n:.5),e-d)),i.setAttribute("maxLineWidth",Math.max(e*(null!=(s=a.widthRatio)?s:.5),e-u)))}_renderEachItem(t,e,i,r){var l,a;let h,{id:c,label:p,value:g,shape:f}=t,{padding:y=0,focus:v,focusIconStyle:b,align:x,autoEllipsisStrategy:C}=this.attribute.item,{shape:w,label:A,value:M,background:k}=this.attribute.item,T=this._handleStyle(w,t,e,i,r),R=this._handleStyle(A,t,e,i,r),B=this._handleStyle(M,t,e,i,r),P=this._handleStyle(k,t,e,i,r),E=(0,u.o)(y);!1===k.visible?(h=m.i.group({x:0,y:0,cursor:null==(l=P.style)?void 0:l.cursor}),this._appendDataToShape(h,S.GN.item,t,h)):(h=m.i.group(Object.assign({x:0,y:0},P.style)),this._appendDataToShape(h,S.GN.item,t,h,P.state)),h.id=`${null!=c?c:p}-${i}`,h.addState(e?S.uu.selected:S.uu.unSelected);let I=m.i.group({x:0,y:0,pickable:!1});h.add(I);let L,F=0,O=0,D=0;if(w&&!1!==w.visible){let i=(0,o.Z)(T,"style.size",S.SX);O=(0,n.Z)(i)?i[0]||0:i,D=(0,o.Z)(w,"space",S.g);let r=m.i.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},f),T.style));Object.keys(T.state||{}).forEach(t=>{let e=T.state[t].fill||T.state[t].stroke;f.fill&&(0,d.Z)(T.state[t].fill)&&e&&(T.state[t].fill=e),f.stroke&&(0,d.Z)(T.state[t].stroke)&&e&&(T.state[t].stroke=e)}),this._appendDataToShape(r,S.GN.itemShape,t,h,T.state),r.addState(e?S.uu.selected:S.uu.unSelected),I.add(r)}let H=0;if(v){let e=(0,o.Z)(b,"size",S.SX);L=m.i.symbol(Object.assign(Object.assign({x:0,y:-e/2-1,strokeBoundsBuffer:0,boundsPadding:E},b),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(L,S.GN.focus,t,h),H=e}let z=A.formatMethod?A.formatMethod(p,t,i):p,W=Object.assign(Object.assign({x:O/2+D,y:0,textAlign:"start",textBaseline:"middle",lineHeight:null==(a=R.style)?void 0:a.fontSize},R.style),{text:z,_originText:A.formatMethod?p:void 0}),N=(0,_.vS)(W);this._appendDataToShape(N,S.GN.itemLabel,t,h,R.state),N.addState(e?S.uu.selected:S.uu.unSelected),I.add(N);let j=(0,o.Z)(A,"space",S.DN);if((0,s.Z)(g)){let r=(0,o.Z)(M,"space",v?S.qL:0),n=M.formatMethod?M.formatMethod(g,t,i):g,s=Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:B.style.fontSize},B.style),{text:n,_originText:M.formatMethod?g:void 0}),l=(0,_.vS)(s);if(this._appendDataToShape(l,S.GN.itemValue,t,h,B.state),l.addState(e?S.uu.selected:S.uu.unSelected),this._itemWidthByUser){let t=this._itemWidthByUser-E[1]-E[3]-O-D-j-H-r;this._autoEllipsis(C,t,N,l),M.alignRight?l.setAttributes({textAlign:"right",x:this._itemWidthByUser-O/2-E[1]-E[3]-H-r}):l.setAttribute("x",j+(N.AABBBounds.empty()?0:N.AABBBounds.x2))}else l.setAttribute("x",j+(N.AABBBounds.empty()?0:N.AABBBounds.x2));F=r+(l.AABBBounds.empty()?0:l.AABBBounds.x2),I.add(l)}else this._itemWidthByUser&&N.setAttribute("maxLineWidth",this._itemWidthByUser-E[1]-E[3]-O-D-H),F=j+(N.AABBBounds.empty()?0:N.AABBBounds.x2);L&&(L.setAttribute("x",F),I.add(L));let G=I.AABBBounds,V=G.width();if("right"===x){let t=G.x2,e=G.x1;I.forEachChildren((i,r)=>{"symbol"!==i.type&&"right"!==i.attribute.textAlign||i===L?i.setAttribute("x",e+t-i.attribute.x-i.AABBBounds.width()):"symbol"!==i.type?i.setAttributes({x:e+t-i.attribute.x,textAlign:"left"}):i.setAttribute("x",e+t-i.attribute.x)})}let Z=G.height(),U=(0,s.Z)(this.attribute.item.width)?this.attribute.item.width:V+E[1]+E[3],K=this._itemHeightByUser||Z+E[0]+E[2];return h.attribute.width=U,h.attribute.height=K,L&&L.setAttribute("visible",!1),I.translateTo(-G.x1+E[3],-G.y1+E[0]),h}_createPager(t){var e,i;let{disableTriggerEvent:n,maxRow:s}=this.attribute,l=t=>t<=99?99:t<=999?999:9999;return new w(this._itemContext.isHorizontal?Object.assign(Object.assign({layout:1===s?"horizontal":"vertical",total:l(this._itemContext.pages)},(0,r.Z)({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:null==(e=this.attribute.pager)?void 0:e.defaultCurrent,disableTriggerEvent:n}):Object.assign({layout:"horizontal",total:l(this._itemContext.pages),disableTriggerEvent:n,defaultCurrent:null==(i=this.attribute.pager)?void 0:i.defaultCurrent},t))}_createScrollbar(t,e){let{disableTriggerEvent:i}=this.attribute;return new M.B(this._itemContext.isHorizontal?Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:i,range:[0,.5],height:12*(!1!==t.visible)},t),{width:e}):Object.assign(Object.assign({direction:"vertical",width:12*(!1!==t.visible),range:[0,.5]},t),{height:e,disableTriggerEvent:i}))}_updatePositionOfPager(t,e,i){let{pager:r}=this.attribute,{totalPage:n,isHorizontal:s}=this._itemContext,l=r&&r.position||"middle";if(this._pagerComponent.setTotal(n),s){let r;r="start"===l?t:"end"===l?t+i-this._pagerComponent.AABBBounds.height()/2:t+i/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:e-this._pagerComponent.AABBBounds.width(),y:r})}else{let t;t="start"===l?0:"end"===l?e-this._pagerComponent.AABBBounds.width():(e-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:t,y:i-this._pagerComponent.AABBBounds.height()})}}_computeScrollbarDelta(){let t,{isHorizontal:e,clipContainer:i}=this._itemContext,r=this._itemsContainer.AABBBounds,n=i.AABBBounds;return e?n.width()/r.width():n.height()/r.height()}_updatePositionOfScrollbar(t,e,i){let{isHorizontal:r,currentPage:n,totalPage:s}=this._itemContext,l=(n-1)/s;this._pagerComponent.setScrollRange([l,l+this._computeScrollbarDelta()]),r?this._pagerComponent.setAttributes({x:0,y:i+e}):this._pagerComponent.setAttributes({x:t,y:i})}_bindEventsOfPager(t,e){let{animation:i=!0,animationDuration:r=450,animationEasing:n="quadIn"}=this.attribute.pager||{},s=this._itemContext.isScrollbar?t=>{let{value:e}=t.detail;return 0===e[0]?1:1===e[1]?this._itemContext.totalPage:e[0]*this._itemContext.totalPage+1}:t=>t.detail.current,l=l=>{let a=s(l);if(a!==this._itemContext.currentPage){if(this._itemContext.currentPage=a,this._itemContext&&this._itemContext.startIndex<this._itemContext.items.length){this._renderItems();let t=Math.ceil(this._itemContext.pages/this._itemContext.maxPages);if(this._itemContext.totalPage=t,this._itemContext.isScrollbar&&this._pagerComponent){let t=this._computeScrollbarDelta(),[e]=this._pagerComponent.getScrollRange();this._pagerComponent.setScrollRange([e,e+t])}}if(this._itemContext.isScrollbar){let[t]=this._pagerComponent.getScrollRange(),s=(this._itemContext.isHorizontal?this._itemsContainer.AABBBounds.width():this._itemsContainer.AABBBounds.height())*t;this.updateScrollMask(),i?this._itemsContainer.animate().to({[e]:-s},r,n):this._itemsContainer.setAttribute(e,-s)}else i?this._itemsContainer.animate().to({[e]:-(a-1)*t},r,n):this._itemsContainer.setAttribute(e,-(a-1)*t)}};this._itemContext.isScrollbar?(this._pagerComponent.addEventListener("scrollDrag",l),this._pagerComponent.addEventListener("scrollUp",l),this.attribute.pager.roamScroll&&(this.addEventListener("wheel",t=>t.nativeEvent.preventDefault()),this.addEventListener("wheel",(0,c.Z)(t=>{let e=this._pagerComponent,i=e.getScrollRange(),{direction:r}=e.attribute,{width:n,height:s}=e.getSliderRenderBounds(),l="vertical"===r?t.deltaY/s:t.deltaX/n;e.setScrollRange([i[0]+l,i[1]+l],!0),this.updateScrollMask()},50)))):(this._pagerComponent.addEventListener("toPrev",l),this._pagerComponent.addEventListener("toNext",l))}_renderPager(){let t=this._title?this._title.AABBBounds.height()+(0,o.Z)(this.attribute,"title.space",8):0,{maxWidth:e,maxCol:i=1,maxRow:r=2,item:n={},pager:s={}}=this.attribute,{spaceCol:l=S.Nu,spaceRow:a=S.so}=n,h=this._itemsContainer,{space:u=S.Th,defaultCurrent:d=1}=s,c=k(s,["space","defaultCurrent"]),{isHorizontal:p}=this._itemContext,g=this._contentMaxHeight,f,y=0,v=0,b=0,_=0,x=0,C=0,w=1;if(p){if(v=(r-1)*a+this._itemHeight*r,y=e,f=this._createPager(c),this._pagerComponent=f,this._innerView.add(f),(b=e-f.AABBBounds.width()-u)<=0)return this._innerView.removeChild(f),!1;h.getChildren().forEach((t,e)=>{let{width:i,height:r}=t.attribute;b<x+i&&e>0&&(x=0,C+=r+a,w+=1),e>0&&t.setAttributes({x:x,y:C}),x+=l+i}),this._itemContext.startX=x,this._itemContext.startY=C,this._itemContext.pages=w;let i=Math.ceil(w/r);this._itemContext.totalPage=i,this._updatePositionOfPager(t,y,v)}else{if(y=this._itemMaxWidth*i+(i-1)*l,v=g,b=y,f=this._createPager(c),this._pagerComponent=f,this._innerView.add(f),(_=g-f.AABBBounds.height()-u-t)<=0)return this._innerView.removeChild(f),!1;h.getChildren().forEach((t,e)=>{let{width:i,height:r}=t.attribute;_<C+r&&e>0&&(C=0,x+=this._itemMaxWidth+l,w+=1),e>0&&t.setAttributes({x:x,y:C}),C+=a+r});let e=Math.ceil(w/i);this._itemContext.totalPage=e,this._updatePositionOfPager(t,y,v)}d>1&&(p?h.setAttribute("y",-(d-1)*(v+a)):h.setAttribute("x",-(d-1)*(y+l)));let A=m.i.group({x:0,y:t,width:p?b:y,height:p?v:_,clip:!0,pickable:!1});return A.add(h),this._innerView.add(A),this._itemContext.clipContainer=A,this._bindEventsOfPager(p?v+a:y+l,p?"y":"x"),!0}_renderScrollbar(){var t;let e=this._title?this._title.AABBBounds.height()+(0,o.Z)(this.attribute,"title.space",8):0,{maxWidth:i,item:r={},pager:n={}}=this.attribute,{spaceCol:s=S.Nu,spaceRow:l=S.so}=r,a=this._itemsContainer,{space:h=S.Th,defaultCurrent:u=1}=n,d=k(n,["space","defaultCurrent"]),{isHorizontal:c}=this._itemContext,p=this._contentMaxHeight,g,f=0,y=0,v=0,b=1;if(c)f=i,y=this._itemHeight,g=this._createScrollbar(d,f),this._pagerComponent=g,this._innerView.add(g);else{if(y=p-e,f=this._itemMaxWidth,g=this._createScrollbar(d,y),this._pagerComponent=g,this._innerView.add(g),y<=0)return this._innerView.removeChild(g),!1;let t=a.getChildren(),i=t.map(t=>t.attribute.height);if(1===i.length||i.every(t=>t===i[0])){let e=i[0],r=Math.floor(y/(l+e));y=r*(l+e),b=Math.ceil(t.length/r)}else t.forEach((t,e)=>{let{height:i}=t.attribute,r=b,n=v;b=Math.floor((v+i)/y)+1,v+=l+i,r!==b&&e===a.getChildren().length-1&&v-y>=1/3*i&&(y=n+i,b-=1)});this._itemContext.totalPage=b,this._itemContext.pages=b}if(u>1)if(c){let t=this._itemsContainer.AABBBounds.width()-f;a.setAttribute("x",-Math.min((u-1)*(f+s),t))}else{let t=this._itemsContainer.AABBBounds.height()-y;a.setAttribute("y",-Math.min((u-1)*(y+l),t))}let _=m.i.group({x:0,y:e,width:f,height:y,clip:!0,pickable:!1});return _.add(a),this._innerView.add(_),this._itemContext.clipContainer=_,this._updatePositionOfScrollbar(f,y,e),(null==(t=n.scrollMask)?void 0:t.visible)&&this.renderScrollMask(_),this._bindEventsOfPager(c?f:y,c?"x":"y"),!0}renderScrollMask(t){let{scrollMask:e={}}=this.attribute.pager,{visible:i=!0,gradientLength:r=16,gradientStops:n}=e;if(!i||!n)return;let s=t.AABBBounds.width(),l=t.AABBBounds.height(),a=this._itemContext.isHorizontal?s:l,o=n.map(t=>({offset:r*t.offset/a,color:t.color})),h=n.map(t=>({offset:(a-r*t.offset)/a,color:t.color})),u=m.i.rect({x:0,y:0,width:s,height:l});this._scrollMask=u,this._scrollMaskContext={startStops:o,endStops:h},this.updateScrollMask(),t.add(u)}updateScrollMask(){if(!this._scrollMask||!this._pagerComponent||!this._itemContext.isScrollbar)return;let[t,e]=this._pagerComponent.getScrollRange(),i=[];(0,p.Yt)((0,g.Z)(e,0,1),1)||i.push(...this._scrollMaskContext.endStops),(0,p.Yt)((0,g.Z)(t,0,1),0)||i.push(...this._scrollMaskContext.startStops),i.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:i}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:i}}))}_renderPagerComponent(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}_hover(t,e){this._lastActiveItem=t,t.hasState(S.uu.selected)?this._setLegendItemState(t,S.uu.selectedHover,e):this._setLegendItemState(t,S.uu.unSelectedHover,e);let i=t.getChildren()[0].find(t=>t.name===S.GN.focus,!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(S.dk.legendItemHover,t,e)}_unHover(t,e){let i=!1;(t.hasState(S.uu.unSelectedHover)||t.hasState(S.uu.selectedHover))&&(i=!0),t.removeState(S.uu.unSelectedHover),t.removeState(S.uu.selectedHover),t.getChildren()[0].getChildren().forEach(t=>{!i&&(t.hasState(S.uu.unSelectedHover)||t.hasState(S.uu.selectedHover))&&(i=!0),t.removeState(S.uu.unSelectedHover),t.removeState(S.uu.selectedHover)});let r=t.getChildren()[0].find(t=>t.name===S.GN.focus,!1);r&&r.setAttribute("visible",!1),i&&this._dispatchLegendEvent(S.dk.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(S.dk.legendItemUnHover,t,e)}_setLegendItemState(t,e,i){let r=!1;t.hasState(e)||(r=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach(t=>{t.name!==S.GN.focus&&(r||t.hasState(e)||(r=!0),t.addState(e,!0))}),r&&this._dispatchLegendEvent(S.dk.legendItemAttributeUpdate,t,i)}_removeLegendItemState(t,e,i){let r=!1;e.forEach(e=>{!r&&t.hasState(e)&&(r=!0),t.removeState(e)}),t.getChildren()[0].getChildren().forEach(t=>{t.name!==S.GN.focus&&e.forEach(e=>{!r&&t.hasState(e)&&(r=!0),t.removeState(e)})}),r&&this._dispatchLegendEvent(S.dk.legendItemAttributeUpdate,t,i)}_getSelectedLegends(){var t;let e=[];return null==(t=this._itemsContainer)||t.getChildren().forEach(t=>{t.hasState(S.uu.selected)&&e.push(t.data)}),e}_appendDataToShape(t,e,i,n,s={}){t.name=e,t.data=i,t.delegate=n,t.states=(0,r.Z)({},T,s)}_dispatchLegendEvent(t,e,i){let r=this._getSelectedLegends();r.sort((t,e)=>t.index-e.index);let n=r.map(t=>t.label);this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(S.uu.selected),currentSelectedItems:r,currentSelected:n,event:i})}_handleStyle(t,e,i,r,n){let s={};return t.style&&((0,f.Z)(t.style)?s.style=t.style(e,i,r,n):s.style=t.style),t.state&&(s.state={},Object.keys(t.state).forEach(l=>{t.state[l]&&((0,f.Z)(t.state[l])?s.state[l]=t.state[l](e,i,r,n):s.state[l]=t.state[l])})),s}release(){super.release(),this.removeAllEventListeners()}}R.defaultAttributes={layout:"horizontal",title:{align:"start",space:S.$5,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:S.Nu,spaceRow:S.so,shape:{space:S.g,style:{size:S.SX,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:S.DN,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:S.SX,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:S.Th,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0}},54062:function(t,e,i){"use strict";i.d(e,{Fw:()=>d,Vo:()=>c,cV:()=>u});var r=i(15589),n=i(9994),s=i(34160),l=i(97160),a=i(66542),o=i(56960);function h(){(0,r.M)(),(0,s.b)()}function u(){h(),(0,l.s)(),(0,o.M)()}function d(){h(),(0,a.d)()}function c(){h(),(0,a.d)(),(0,n.N)()}},71149:function(t,e,i){"use strict";i.d(e,{D:()=>h});var r=i(45011),n=i(95950),s=i(59225),l=i(45890),a=i(16018),o=i(35622);(0,i(54062).Vo)();class h extends l.U{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,n.Z)({},h.defaultAttributes,t)),this.name="sizeLegend",this._onSliderChange=t=>{this.dispatchEvent(t)},this._onSliderToolipChange=t=>{this.dispatchEvent(t)}}setSelected(t){this._slider&&this._slider.setValue(t)}_renderContent(){let{slidable:t,layout:e,align:i,min:n,max:l,value:h,railWidth:u,railHeight:d,showHandler:c=!0,handlerSize:p,handlerStyle:g,railStyle:f,trackStyle:m,startText:y,endText:v,handlerText:b,showTooltip:_,tooltip:x,sizeBackground:C,disableTriggerEvent:w,inverse:S}=this.attribute,A=r.i.group({x:0,y:0});this._innerView.add(A);let M=new a.i({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:t,layout:e,align:i,min:n,max:l,value:h,railWidth:u,railHeight:d,showHandler:c,handlerSize:p,handlerStyle:Object.assign({symbolType:function(t="bottom"){let e=0;return"top"===t?`
    M${e},-6L${e-3.5},-2.5
    v5
    h7
    v-5
    Z
`:"left"===t?(e=1,`
    M${e-6},0L${e-6+2.5},-3.5
    h5
    v7
    h-5
    Z
`):"right"===t?(e=-1,`
    M${e+6},0L${e+6-2.5},-3.5
    h-5
    v7
    h5
    Z
  `):`
    M${e},6L${e-3.5},2.5
    v-5
    h7
    v5
    Z
`}(i)},g),railStyle:f,trackStyle:m,startText:y,endText:v,handlerText:b,showTooltip:_,tooltip:x,disableTriggerEvent:w,inverse:S});A.add(M);let k,T=0;"horizontal"===e?"top"===i?(k=`M0,0L${u},0L${S?0:u},12Z`,T=d):(k=`M0,12L${u},12L${S?0:u},0Z`,M.setAttribute("y",12)):"left"===i?k=`M${u},0L${u+12},${S?0:d}L${u},${d}Z`:(k=`M0,${S?0:d}L12,${d}L12,0Z`,M.setAttribute("x",12));let R=r.i.path(Object.assign(Object.assign({x:0,y:T,path:k},C),{zIndex:0}));A.add(R);let B=this._title?this._title.AABBBounds.height()+(0,s.Z)(this.attribute,"title.space",o.$5):0;A.translate(0-A.AABBBounds.x1,B-A.AABBBounds.y1),this._slider=M}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}h.defaultAttributes={layout:"horizontal",title:{align:"start",space:o.$5,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}}},97160:function(t,e,i){"use strict";i.d(e,{s:()=>l});var r=i(15589),n=i(95694),s=i(69877);function l(){(0,r.M)(),(0,n.k)(),(0,s.g)()}},1788:function(t,e,i){"use strict";i.d(e,{C:()=>F});var r=i(99262),n=i(879),s=i(17959),l=i(91018),a=i(26004),o=i(76620),h=i(95950),u=i(11681),d=i(21777),c=i(31535),p=i(47704),g=i(88504),f=i(61868),m=i(33049),y=i(74562),v=i(56306),b=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let _=new o.FB;(0,v.q)();let x="M -0.5 -0.5, L -0.5 0.5, L 0.5 -0.5, Z",C="M -0.5 -0.5, L -0.5 0.5, L 0.5 0.5, Z",w="M -0.5 -0.5, L 0.5 -0.5, L 0.5 0.5, Z",S="M 0.5 -0.5, L 0.5 0.5, L -0.5 0.5, Z",A={tl:x,tr:w,bl:C,br:S,lt:x,lb:C,rt:w,rb:S};class M extends y.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h.Z)({},M.defaultAttributes,t)),this.name="poptip",this.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"]}render(){var t,e,i,r,n,s,l,a,h;let{titleStyle:y={},position:v,contentStyle:x={},panel:C,logoSymbol:w,poptipAnchor:S="position",logoText:M,logoTextStyle:k={},triangleMode:T="default",space:R=4,minWidth:B=0,maxWidth:P=1/0,padding:E=4,maxWidthPercent:I,visible:L,state:F,dx:O=0,dy:D=0,positionBounds:H}=this.attribute,{title:z="",content:W=""}=this.attribute;z=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(z):z,W=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(W):W;let N=(0,u.o)(E),j=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group");this.group=j;let G=P-N[1]-N[3],V=(0,d.Z)(z)&&!1!==L,Z=Object.assign(Object.assign({text:(0,c.Z)(z)?z:[z],visible:V,wrap:!0},y),{x:N[3],y:N[0],maxLineWidth:G,textAlign:"left",textBaseline:"top"}),U=j.createOrUpdateChild("poptip-title",Z,"text");(0,p.Z)(null==F?void 0:F.title)||(U.states=F.title);let K=U.AABBBounds,$=K.height(),Y=K.width(),X=$+R;V||(X=0);let q=(0,d.Z)(W)&&!1!==L,J=Object.assign(Object.assign({text:(0,c.Z)(W)?W:[W],visible:q,wrap:!0},x),{x:N[3],y:N[0]+X,maxLineWidth:G,textAlign:"left",textBaseline:"top"}),Q=j.createOrUpdateChild("poptip-content",J,"text");(0,p.Z)(null==F?void 0:F.content)||(Q.states=F.content);let te=Q.AABBBounds,ti=te.height(),tr=te.width();q&&(X+=ti),this.titleShape=U,this.contentShape=Q;let tn=(0,g.Fp)(Y+N[1]+N[3],tr+N[1]+N[3]);tn>P?tn=P:tn<B&&(tn=B);let ts=N[0]+N[2]+X,{visible:tl,square:ta}=C,to=b(C,["visible","square"]);if(ta){let t=(0,g.Fp)(tn,ts);tn=t;let e=t-ts;ts=t,U.setAttributes({dy:e/2}),Q.setAttributes({dy:e/2})}let th=null!=(t=to.size)?t:12,tu=(0,c.Z)(th)?[th[0]+(null!=(e=to.space)?e:0),th[1]+(null!=(i=to.space)?i:0)]:th+(null!=(r=to.space)?r:0),td=null!=(n=to.lineWidth)?n:1,tc=this.stage?[null!=(s=this.stage.viewWidth)?s:this.stage.width,null!=(l=this.stage.viewHeight)?l:this.stage.height]:void 0;if(tc){let t=this.AABBBounds,e=Math.max(null!=(a=this.attribute.x)?a:t.x1,tc[0]-t.x1);if((e=Math.min(e-(((0,c.Z)(th)?th[0]:12)+3),e*I))<tn){tn=e;let t=N[1]+N[3];U.setAttribute("maxLineWidth",e-t),Q.setAttribute("maxLineWidth",e-t),ts=N[0]+N[2],V&&(ts+=U.AABBBounds.height()+R),ts+=Q.AABBBounds.height()}}let tp="auto"===v||(0,c.Z)(v),tg=(0,c.Z)(v)?v:this.positionList,tf,tm=-1/0;for(let t=0;t<tg.length+1;t++){let e=tp?tg[t===tg.length?tf:t]:v,i="arrow2Left",r=((0,c.Z)(th)?th[0]:th)/4,n=0;"top"===e||"bottom"===e||"left"===e||"right"===e?i="arrow2Left":"concise"===T&&(i=A[e],r=["tl","bl","rt","rb"].includes(e)?((0,c.Z)(th)?th[0]:th)/2:-((0,c.Z)(th)?th[0]:th)/2,n=["tl","tr","lb","rb"].includes(e)?-((0,c.Z)(th)?th[1]:th)/2:((0,c.Z)(th)?th[1]:th)/2);let{angle:s,offset:l}=this.getAngleAndOffset(e,tn,ts,(0,c.Z)(tu)?tu:[tu,tu-td],i),a,u={x:0,y:0};if("bounds"===S&&H&&(u=this.calculateAnchorPoint(e,H)),(0,f.Z)(tl)){let t;a=j.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},to),{visible:tl&&(q||V),x:r,y:n,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:i,angle:s,dx:l[0],dy:l[1]-(null!=(h=to.space)?h:0),size:th,zIndex:9}),"symbol"),(0,p.Z)(null==F?void 0:F.panel)||(a.states=F.panel),t=C.panelSymbolType?j.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},to),{visible:tl&&(q||V),x:0,y:0,symbolType:"rect",size:[tn,ts],zIndex:-8}),"symbol"):j.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},to),{visible:tl&&(q||V),x:0,y:0,width:tn,height:ts,zIndex:-8}),"rect"),(0,p.Z)(null==F?void 0:F.panel)||(t.states=F.panel)}if(j.setAttributes({x:-l[0]+O+u.x,y:-l[1]+D+u.y,anchor:[r,n]}),w){let{size:t=12}=w,e=(0,c.Z)(t)?t:[t,t];"auto"===e[1]&&(e[1]=ts),"auto"===e[0]&&(e[0]=ts);let i=e[0];j.createOrUpdateChild("poptip-logo",Object.assign(Object.assign({},w),{x:0,y:ts/2,visible:tl&&(q||V),zIndex:10,size:e}),"symbol"),j.setAttributes({x:-l[0]+O+i/2,y:-l[1]+D}),M&&j.createOrUpdateChild("poptip-logo-text",Object.assign(Object.assign({},k),{x:0,y:ts/2,visible:tl&&(q||V),text:M,textAlign:"center",textBaseline:"middle",zIndex:10}),"text")}if(!tc)break;{_.setValue(0,0,tn,ts).transformWithMatrix(j.globalTransMatrix);let i=(new o.YZ).setValue(0,0,tc[0],tc[1]);if(tp){if((0,m.RA)(_,i,!1))break;{let e=(0,m.di)(_,i,!1),r=(e.x2-e.x1)*(e.y2-e.y1);r>tm&&(tm=r,tf=t)}}if(["top","bottom","left","right"].includes(e)){let t="top"===e||"bottom"===e,r="left"===e||"right"===e,n=!1;if(t?n="top"===e&&_.y1<0||"bottom"===e&&_.y2>i.y2:r&&(n="left"===e&&_.x1<0||"right"===e&&_.x2>i.x2),!n){let e=0,n=((0,c.Z)(th)?th[1]:th)/2;t?(_.x1<0?e=-_.x1:_.x2>i.x2&&(e=i.x2-_.x2),j.setAttribute("x",j.attribute.x+e),a.setAttribute("dx",(0,g.VV)((0,g.Fp)(a.attribute.dx-e,n),_.width()-n))):r&&(_.y1<0?e=-_.y1:_.y2>i.y2&&(e=i.y2-_.y2),j.setAttribute("y",j.attribute.y+e),a.setAttribute("dy",(0,g.VV)((0,g.Fp)(a.attribute.dy-e,n),_.height()-n)));break}}if(!tp)break}}}calculateAnchorPoint(t,e){if(!e)return{x:0,y:0};let{x:i,y:r}=this.attribute,{x1:n,y1:s,x2:l,y2:a}=e,o=l-n,h=a-s;switch(t){case"top":case"tl":case"tr":return{x:n+o/2-i,y:s-r};case"bottom":case"bl":case"br":return{x:n+o/2-i,y:a-r};case"left":case"lt":case"lb":return{x:n-i,y:s+h/2-r};case"right":case"rt":case"rb":return{x:l-i,y:s+h/2-r};default:return{x:0,y:0}}}getAngleAndOffset(t,e,i,r,n){let s="arrow2Left"===n?r[1]/2:r[1];switch(t){case"tl":return{angle:"arrow2Left"===n?g.pi/2*3:0,offset:"arrow2Left"===n?[e/4,i+s]:[0,i+s]};case"top":return{angle:g.pi/2*3,offset:[e/2,i+s]};case"tr":return{angle:"arrow2Left"===n?g.pi/2*3:0,offset:"arrow2Left"===n?[e/4*3,i+s]:[e,i+s]};case"rt":return{angle:0,offset:"arrow2Left"===n?[-s,i/5]:[-s,0]};case"right":return{angle:0,offset:[-s,i/2]};case"rb":return{angle:0,offset:"arrow2Left"===n?[-s,i/5*4]:[-s,i]};case"bl":return{angle:"arrow2Left"===n?g.pi/2:0,offset:"arrow2Left"===n?[e/4,-s]:[0,-s]};case"bottom":return{angle:g.pi/2,offset:[e/2,-s]};case"br":return{angle:"arrow2Left"===n?g.pi/2:0,offset:"arrow2Left"===n?[e/4*3,-s]:[e,-s]};case"lt":return{angle:"arrow2Left"===n?g.pi:0,offset:"arrow2Left"===n?[e+s,i/5]:[e+s,0]};case"left":return{angle:g.pi,offset:[e+s,i/2]};case"lb":return{angle:"arrow2Left"===n?g.pi:0,offset:"arrow2Left"===n?[e+s,i/5*4]:[e+s,i]}}}}M.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},panel:{},maxWidthPercent:.8,space:8,padding:10};var k=i(45156);let T=class{render(t,e,i,r,n,s,l,a,o,u,d,c,p){var g,f,m;if(1===t._showPoptip){let{visible:e,visibleCb:i}=t.attribute.poptip||{};if(!1===e||i&&!1===i(t))return;let r={};(0,h.Z)(r,M.defaultAttributes,t.attribute.poptip?t.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(r):this.poptipComponent=new M(r);let n=t.attribute.poptip||{};if("text"===t.type&&null==n.title&&null==n.content){let e={};m=n,(0,h.Z)(e,k.r.poptip,m),(n=e).content=null!=(g=n.content)?g:t.attribute.text}let s=t.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1,poptipAnchor:"bounds"},n),{x:s.e,y:s.f,positionBounds:t.globalAABBBounds})),u.stage.tryInitInteractiveLayer();let l=u.stage.getLayer("_builtin_interactive");l&&l.add(this.poptipComponent)}else 2===t._showPoptip&&(t._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),null==(f=this.poptipComponent.parent)||f.removeChild(this.poptipComponent),this.poptipComponent=null))}};T=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)()],T);var R=i(40398),B=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l};class P{constructor(){this.activeEvent="onRegister",this._uid=R.R.GenAutoIncrementId(),this.poptip=t=>{let e=t.target;this.needHide(e)?this.unpoptip(t):e!==this.activeGraphic&&(this.needShow(e)&&(e.setAttributes({}),e._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(e,!0))},this.unpoptip=t=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(t){this.pluginService=t;let{stage:e}=this.pluginService;e.addEventListener("pointerover",this.poptip)}needHide(t){return t.isContainer||!t.attribute}needShow(t){return!!t.attribute.poptip}setActiveGraphic(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}deactivate(t){let{stage:e}=this.pluginService;e.removeEventListener("pointerover",this.poptip)}}let E=class extends P{constructor(){super(...arguments),this.name="poptip",this.key=this.name+this._uid}};E=B([(0,a.b)()],E);let I=class extends P{constructor(){super(...arguments),this.name="poptipForText",this.key=this.name+this._uid,this.pointerlave=t=>{let{stage:e}=this.pluginService;t.target===e&&this.unpoptip(t)}}activate(t){super.activate(t);let{stage:e}=this.pluginService;e.addEventListener("pointerleave",this.pointerlave)}needHide(t){return"text"!==t.type||!t.cliped||t.isContainer||!t.attribute||t.attribute.disableAutoClipedPoptip}needShow(t){return!0}deactivate(t){let{stage:e}=this.pluginService;super.deactivate(t),e.removeEventListener("pointerleave",this.pointerlave)}};I=B([(0,a.b)()],I);let L=new r.n((t,e,i,r)=>{i(T)||(t(T).toSelf().inSingletonScope(),t(n.tg).toService(T)),i(E)||(t(E).toSelf(),t(s.X).toService(E)),i(I)||(t(I).toSelf(),t(s.X).toService(I))});function F(){l.n.load(L)}},56306:function(t,e,i){"use strict";i.d(e,{C:()=>u,q:()=>h});var r=i(95950),n=i(45156),s=i(15589),l=i(69877),a=i(95694),o=i(86972);function h(){(0,s.M)(),(0,l.g)(),(0,a.k)(),(0,o.k)()}function u(t){(0,r.Z)(n.r.poptip,n.t,t)}},45156:function(t,e,i){"use strict";i.d(e,{r:()=>s,t:()=>n});var r=i(95950);let n={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},s={poptip:(0,r.Z)({},n)}},42857:function(t,e,i){"use strict";i.d(e,{Y:()=>b});var r=i(95950),n=i(74562),s=i(41035),l=i(64103),a=i(15589),o=i(86972),h=i(31535),u=i(10797),d=i(16049),c=i(70749);let p=["heightLimit","lineClamp"];class g extends l.x{constructor(t){super(Object.assign(Object.assign({},t),{wrap:!0}))}_isValid(){let{text:t}=this.attribute;return(0,h.Z)(t)?!t.every(t=>null==t||""===t):null!=t&&""!==t}updateMultilineAABBBounds(t){var e,i,r,n,s;let l=this.getGraphicTheme(),{fontFamily:a=l.fontFamily,textAlign:o=l.textAlign,textBaseline:h=l.textBaseline,fontSize:p=l.fontSize,ellipsis:g=l.ellipsis,maxLineWidth:f,stroke:m=l.stroke,lineWidth:y=l.lineWidth,wordBreak:v=l.wordBreak,fontWeight:b=l.fontWeight,ignoreBuf:_=l.ignoreBuf,heightLimit:x=0,suffixPosition:C=l.suffixPosition,lineClamp:w}=this.attribute,S=null!=(e=(0,c.VA)(this.attribute.lineHeight,this.attribute.fontSize||l.fontSize))?e:this.attribute.fontSize||l.fontSize;if(!this.shouldUpdateShape()&&(null==(i=this.cache)?void 0:i.layoutData)){let t=this.cache.layoutData.bbox;return this._AABBBounds.set(t.xOffset,t.yOffset,t.xOffset+t.width,t.yOffset+t.height),m&&this._AABBBounds.expand(y/2),this._AABBBounds}let A=d.w.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null==(r=this.stage)?void 0:r.textMeasureId)),M=new u.j(a,{fontSize:p,fontWeight:b,fontFamily:a},A),k=t.map(t=>t.toString()),T=[],R=[0,0],B=1/0;if(x>0&&(B=Math.max(Math.floor(x/S),1)),w&&(B=Math.min(B,w)),"number"==typeof f&&f!==1/0){if(f>0)for(let t=0;t<k.length;t++){let e=k[t],i=!0;if(t===B-1){let t=M.textMeasure.clipTextWithSuffix(e,M.textOptions,f,g,!1,C);T.push({str:t.str,width:t.width,ascent:0,descent:0,keepCenterInLine:!1});break}let r=M.textMeasure.clipText(e,M.textOptions,f,"break-word"===v);if(""!==e&&""===r.str){if(g){let t=M.textMeasure.clipTextWithSuffix(e,M.textOptions,f,g,!1,C);r.str=null!=(n=t.str)?n:"",r.width=null!=(s=t.width)?s:0}else r.str="",r.width=0;i=!1}if(T.push({str:r.str,width:r.width,ascent:0,descent:0,keepCenterInLine:!1}),r.str.length===e.length);else if(i){let i=e.substring(r.str.length);k.splice(t+1,0,i)}}let t=0;T.forEach(e=>{t=Math.max(t,e.width)}),R[0]=t}else{let t,e,i=0;for(let r=0,n=k.length;r<n;r++){if(r===B-1){let t=M.textMeasure.clipTextWithSuffix(k[r],M.textOptions,f,g,!1,C);T.push({str:t.str,width:t.width,ascent:0,descent:0,keepCenterInLine:!1}),i=Math.max(i,t.width);break}e=k[r],i=Math.max(i,t=M.textMeasure.measureTextWidth(e,M.textOptions,"break-word"===v)),T.push({str:e,width:t,ascent:0,descent:0,keepCenterInLine:!1})}R[0]=i}R[1]=T.length*(S+2*!_);let P={xOffset:0,yOffset:0,width:R[0],height:R[1]};M.LayoutBBox(P,o,h);let E=M.layoutWithBBox(P,T,o,h,S);return this.cache.layoutData=E,this.clearUpdateShapeTag(),this._AABBBounds.set(P.xOffset,P.yOffset,P.xOffset+P.width,P.yOffset+P.height),m&&this._AABBBounds.expand(y/2),this._AABBBounds}needUpdateTags(t){for(let e=0;e<p.length;e++){let i=p[e];if(-1!==t.indexOf(i))return!0}return super.needUpdateTags(t)}needUpdateTag(t){for(let e=0;e<p.length;e++)if(t===p[e])return!0;return super.needUpdateTag(t)}getNoWorkAnimateAttr(){return g.NOWORK_ANIMATE_ATTR}}function f(t){return new g(t)}var m=i(45011);function y(){y.__loaded||(y.__loaded=!0,m.i.RegisterGraphicCreator("wrapText",f))}y.__loaded=!1;var v=i(96628);(0,a.M)(),(0,o.k)(),y(),(0,v.i)();class b extends n.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},b.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||this.attribute.checked||(this.setAttribute("checked",!0),this._dispatchEvent("radio_checked",{eventType:"radio_checked",target:this}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(t,e,i)=>{"interactive"in t&&this.setAttribute("pickable",t.interactive),"disabled"in t&&this.setAttribute("cursor",t.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderCircle(),this.renderText(),this.layout()}renderCircle(){this._circle=new s.w((0,r.Z)({},this.attribute.circle));let t=this.attribute.checked;t&&this.attribute.disabled?this._circle.setAttributes({fill:this.attribute.circle.disableCheckedFill,stroke:this.attribute.circle.disableCheckedStroke}):t?this._circle.setAttributes({fill:this.attribute.circle.checkedFill,stroke:this.attribute.circle.checkedStroke}):this.attribute.disabled&&this._circle.setAttributes({fill:this.attribute.circle.disableFill}),this.appendChild(this._circle)}renderText(){this._text=new l.x((0,r.Z)({},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){let t=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),e=this._text.AABBBounds.height(),i=Math.max(t,e),r=i/2-t/2+this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,n=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),s=this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,l=n+this.attribute.spaceBetweenTextAndIcon;this._circle.setAttributes({x:s,y:r}),this._text.setAttributes({x:l,y:i/2-e/2})}initAttributes(t,e){t=(null==e?void 0:e.skipDefault)?t:(0,r.Z)({},b.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}b.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},circle:{outerRadius:7,innerRadius:3,startAngle:0,endAngle:2*Math.PI,lineWidth:1,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}}},56960:function(t,e,i){"use strict";i.d(e,{M:()=>s});var r=i(15589),n=i(86972);function s(){(0,r.M)(),(0,n.k)()}},57823:function(t,e,i){"use strict";i.d(e,{B:()=>m});var r=i(89983),n=i(10391),s=i(70527),l=i(95950),a=i(21777),o=i(21648),h=i(12319),u=i(11681),d=i(74562),c=i(56960),p=i(76114),g=i(30685);let f={debounce:n.Z,throttle:s.Z};(0,c.M)();class m extends d.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,l.Z)({},m.defaultAttributes,t)),this.name="scrollbar",this._handleTouchMove=t=>{(0,a.Z)(this._prePos)&&t.preventDefault()},this._onRailPointerDown=t=>{let e,{viewX:i,viewY:r}=t,{direction:n,width:s,height:l,range:a}=this.attribute,h=this._sliderSize,[u,d]=this._getScrollRange();if("vertical"===n){let t=r-this._viewPosition.y,i=(0,o.Z)(t-h/2,u,d);e=t/l,this._slider.setAttribute("y",i,!0)}else{let t=i-this._viewPosition.x,r=(0,o.Z)(t-h/2,u,d);e=t/s,this._slider.setAttribute("x",r,!0)}this.setScrollRange([e-(a[1]-a[0])/2,e+(a[1]-a[0])/2],!1),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()},this._onSliderPointerDown=t=>{this._clearDragEvents();let{stopSliderDownPropagation:e=!0}=this.attribute;e&&t.stopPropagation();let{direction:i}=this.attribute,{x:n,y:s}=this.stage.eventPointTransform(t);this._prePos="horizontal"===i?n:s,this._dispatchEvent(p.m3,{pos:this._prePos,event:t});let l=(0,g.G)(),a="browser"===r.rF.env?r.rF:this.stage;a.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),l.forEach(t=>{a.addEventListener(t,this._onSliderPointerUp)})},this._computeScrollValue=t=>{let{direction:e}=this.attribute,{x:i,y:r}=this.stage.eventPointTransform(t),n,s,l=0,{width:a,height:o}=this.getSliderRenderBounds();return n="vertical"===e?((s=r)-this._prePos)/o:((s=i)-this._prePos)/a,[s,n]},this._onSliderPointerMove=t=>{let{stopSliderMovePropagation:e=!0}=this.attribute;e&&t.stopPropagation();let i=this.getScrollRange(),[r,n]=this._computeScrollValue(t);this.setScrollRange([i[0]+n,i[1]+n],!0),this._prePos=r},this._onSliderPointerMoveWithDelay=0===this.attribute.delayTime?this._onSliderPointerMove:f[this.attribute.delayType](this._onSliderPointerMove,this.attribute.delayTime),this._onSliderPointerUp=t=>{let{range:e,limitRange:i=[0,1]}=this.attribute,r=this.getScrollRange(),[n,s]=this._computeScrollValue(t),l=[r[0]+s,r[1]+s];this._prePos=null,this._dispatchEvent(p.gB,{pre:e,value:(0,h.Z)(l,i[0],i[1])}),this._clearDragEvents()}}setScrollRange(t,e=!0){let{direction:i="horizontal",limitRange:r=[0,1],range:n,realTime:s=!0}=this.attribute,l=(0,h.Z)(t,r[0],r[1]);if(e){let t=this._getSliderPos(l);if(this._slider){let e=t[1]-t[0];this._sliderSize=e,"horizontal"===i?this._slider.setAttributes({x:t[0],width:e},!0):this._slider.setAttributes({y:t[0],height:e},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=l,s&&this._dispatchEvent(p.eV,{pre:n,value:l})}getScrollRange(){return this.attribute.range}bindEvents(){if(this.attribute.disableTriggerEvent)return;let{delayType:t="throttle",delayTime:e=0}=this.attribute;this._rail&&this._rail.addEventListener("pointerdown",f[t](this._onRailPointerDown,e)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown),("browser"===r.rF.env?r.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}render(){let t;this._reset();let{direction:e="horizontal",width:i,height:r,range:n,limitRange:s=[0,1],railStyle:l,sliderStyle:a,padding:o=2}=this.attribute,d=this.createOrUpdateChild("scrollbar-container",{},"group"),c=d.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:i,height:r},l),"rect");this._rail=c;let p=this.getSliderRenderBounds(),g=this._getSliderPos((0,h.Z)(n,s[0],s[1])),f=g[1]-g[0];this._sliderSize=f,t="horizontal"===e?{x:g[0],y:p.y1,width:f,height:p.height}:{x:p.x1,y:g[0],width:p.width,height:f};let m=d.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},t),{cornerRadius:this._getDefaultSliderCornerRadius()}),a),{boundsPadding:(0,u.o)(o),pickMode:"imprecise"}),"rect");this._slider=m,this._container=d;let y=this._container.AABBBounds;this._viewPosition={x:y.x1,y:y.y1}}getSliderRenderBounds(){if(this._sliderRenderBounds)return this._sliderRenderBounds;let{width:t,height:e,padding:i=2}=this.attribute,[r,n,s,l]=(0,u.o)(i),a={x1:l,y1:r,x2:t-n,y2:e-s,width:Math.max(0,t-(l+n)),height:Math.max(0,e-(r+s))};return this._sliderRenderBounds=a,a}_getDefaultSliderCornerRadius(){let{direction:t,round:e}=this.attribute;if(e){let{width:e,height:i}=this.getSliderRenderBounds();return"horizontal"===t?i:e}return 0}_getSliderPos(t){let{direction:e}=this.attribute,{width:i,height:r,x1:n,y1:s}=this.getSliderRenderBounds();return"horizontal"===e?[i*t[0]+n,i*t[1]+n]:[r*t[0]+s,r*t[1]+s]}_getScrollRange(){if(this._sliderLimitRange)return this._sliderLimitRange;let{limitRange:t=[0,1],direction:e}=this.attribute,[i,r]=(0,h.Z)(t,0,1),{width:n,height:s,x1:l,y1:a}=this.getSliderRenderBounds(),o=this._sliderSize;return"horizontal"===e?(0,h.Z)([l+i*n,l+r*n],l,n-o):(0,h.Z)([a+i*s,a+r*s],a,s-o)}_clearDragEvents(){let t=(0,g.G)(),e="browser"===r.rF.env?r.rF:this.stage;e.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),t.forEach(t=>{e.removeEventListener(t,this._onSliderPointerUp)})}_reset(){this._sliderRenderBounds=null,this._sliderLimitRange=null}release(t){super.release(t),("browser"===r.rF.env?r.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}m.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0}},19917:function(t,e,i){"use strict";i.d(e,{O:()=>h,j:()=>o});var r=i(15589),n=i(79134),s=i(34807),l=i(95694),a=i(16483);function o(){(0,r.M)(),(0,n.N)(),(0,s.M)(),(0,l.k)()}function h(){(0,r.M)(),(0,n.N)(),(0,a.x)(),(0,l.k)()}},15532:function(t,e,i){"use strict";i.d(e,{X:()=>c});var r=i(95950),n=i(70501),s=i(88663),l=i(31535),a=i(47704),o=i(45011),h=i(74562),u=i(19917),d=i(98706);(0,u.j)();class c extends h.k{getStartAngle(){return(0,d.LW)(this._startAngle)}getEndAngle(){return(0,d.LW)(this._endAngle)}getMainSegmentPoints(){return this._mainSegmentPoints}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},c.defaultAttributes,t)),this.name="segment",this.key="segment",this.lines=[]}render(){this.removeAllChild(!0),this._reset();let{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:h=!0,multiSegment:u,mainSegmentIndex:d}=this.attribute;if(!h)return;this._computeLineAngle();let c=this._getMainSegmentPoints(),p=this._renderSymbol(t,c,"start"),g=this._renderSymbol(e,c,"end");if(this.startSymbol=p,this.endSymbol=g,u){let t=[...this.attribute.points];if((0,n.Z)(d))t[d]=this._clipPoints(t[d]);else{let e=this._clipPoints((0,s.VF)(t));t[0][0]=e[0],t[t.length-1][t[t.length-1].length-1]=e[e.length-1]}t.forEach((t,e)=>{var n,s;let h=o.i.line(Object.assign(Object.assign({points:t},(0,l.Z)(i)?null!=(n=i[e])?n:i[i.length-1]:i),{fill:!1}));h.name=`${this.name}-line`,h.id=this._getNodeId("line"+e),(0,a.Z)(null==r?void 0:r.line)||(h.states=(0,l.Z)(r.line)?null!=(s=r.line[e])?s:r.line[r.line.length-1]:r.line),this.add(h),this.lines.push(h)})}else{let t=o.i.line;(0,s.IX)(i)[0].cornerRadius&&(t=o.i.polygon);let e=t(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},(0,s.IX)(i)[0]),{fill:!1,closePath:!1}));e.name=`${this.name}-line`,e.id=this._getNodeId("line"),(0,a.Z)(null==r?void 0:r.line)||(e.states=[].concat(r.line)[0]),this.add(e),this.lines.push(e)}}_computeStartRotate(t){return t+Math.PI/2}_computeEndRotate(t){return t+Math.PI/2}_renderSymbol(t,e,i){let r;if(!e.length)return;let{autoRotate:s=!0}=t;if(t&&t.visible){let l,h,u=this.getStartAngle(),d=this.getEndAngle(),{state:c}=this.attribute,p=e[0],g=e[e.length-1],{refX:f=0,refY:m=0,refAngle:y=0,style:v,symbolType:b,size:_=12}=t;"start"===i?(l={x:p.x+((0,n.Z)(u)?f*Math.cos(u)+m*Math.cos(u-Math.PI/2):0),y:p.y+((0,n.Z)(u)?f*Math.sin(u)+m*Math.sin(u-Math.PI/2):0)},h=this._computeStartRotate(this._startAngle)):(l={x:g.x+((0,n.Z)(d)?f*Math.cos(d)+m*Math.cos(d-Math.PI/2):0),y:g.y+((0,n.Z)(d)?f*Math.sin(d)+m*Math.sin(d-Math.PI/2):0)},h=this._computeEndRotate(this._endAngle)),(r=o.i.symbol(Object.assign(Object.assign(Object.assign({},l),{symbolType:b,size:_,angle:s?h+y:0,strokeBoundsBuffer:0}),v))).name=`${this.name}-${i}-symbol`,r.id=this._getNodeId(`${i}-symbol`),(0,a.Z)(null==c?void 0:c.symbol)||(r.states=c.symbol),"start"===i?(0,a.Z)(null==c?void 0:c.startSymbol)||(r.states=c.startSymbol):(0,a.Z)(null==c?void 0:c.endSymbol)||(r.states=c.endSymbol),this.add(r)}return r}_getMainSegmentPoints(){let t;if(this._mainSegmentPoints)return this._mainSegmentPoints;let{points:e,multiSegment:i,mainSegmentIndex:r}=this.attribute;return t=i?(0,n.Z)(r)?e[r]:(0,s.VF)(e):e,this._mainSegmentPoints=t,t}_clipPoints(t){let{startSymbol:e={},endSymbol:i={}}=this.attribute,r=t;if(e.visible){let i=e.clip?e.size||10:0;r=[{x:t[0].x-i/2*(Math.cos(this._startAngle)||0),y:t[0].y-i/2*(Math.sin(this._startAngle)||0)},...r.slice(1)]}if(i.visible){let e=i.clip?i.size||10:0,n={x:t[t.length-1].x-e/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-e/2*(Math.sin(this._endAngle)||0)};r=[...r.slice(0,r.length-1),n]}return r}_computeLineAngle(){let t=this._getMainSegmentPoints();if(t.length<=1)return;let e=t[0],i=t[1],r=t[t.length-2],n=t[t.length-1],s=[e.x-i.x,e.y-i.y],l=Math.atan2(s[1],s[0]),a=[n.x-r.x,n.y-r.y],o=Math.atan2(a[1],a[0]);this._startAngle=l,this._endAngle=o}_reset(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}c.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}}},66542:function(t,e,i){"use strict";i.d(e,{d:()=>a});var r=i(15589),n=i(69877),s=i(86972),l=i(95694);function a(){(0,r.M)(),(0,n.g)(),(0,s.k)(),(0,l.k)()}},16018:function(t,e,i){"use strict";i.d(e,{i:()=>_});var r,n,s=i(31535),l=i(95950),a=i(21648),o=i(21777),h=i(88663),u=i(35652),d=i(12319),c=i(43562),p=i(89983),g=i(45011),f=i(74562);(r=n||(n={})).innerView="innerView",r.railContainer="sliderRailContainer",r.rail="sliderRail",r.startText="sliderStartText",r.endText="sliderEndText",r.startHandler="sliderStartHandler",r.startHandlerText="startHandlerText",r.endHandler="sliderEndHandler",r.endHandlerText="sliderEndHandlerText",r.track="sliderTrack",r.trackContainer="sliderTrackContainer";var m=i(66542),y=i(30685);function v(t){return(0,s.Z)(t)?t:[t,t]}function b(t){return t?"ew-resize":"ns-resize"}(0,m.d)();class _ extends f.k{get track(){return this._track}get currentValue(){return this._currentValue}get startHandler(){return this._startHandler}get endHandler(){return this._endHandler}get tooltipShape(){return this._tooltipShape}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,l.Z)({},_.defaultAttributes,t)),this.name="slider",this._isHorizontal=!0,this._startHandler=null,this._endHandler=null,this._startHandlerText=null,this._endHandlerText=null,this._currentHandler=null,this._currentValue={},this._onTooltipShow=t=>{this._isChanging||this._tooltipState&&this._tooltipState.isActive||(this._tooltipState?this._tooltipState.isActive=!0:this._tooltipState={isActive:!0},this._onTooltipUpdate(t),this._dispatchTooltipEvent("sliderTooltipShow"))},this._onTooltipUpdate=t=>{if(this._isChanging||!this._tooltipState||!this._tooltipState.isActive)return;let e=this._isHorizontal?this._rail.globalAABBBounds.width():this._rail.globalAABBBounds.height(),i=(0,a.Z)(this._isHorizontal?(t.viewX-this._rail.globalAABBBounds.x1)/e:(t.viewY-this._rail.globalAABBBounds.y1)/e,0,1);i!==this._tooltipState.pos&&(this._tooltipState.pos=i,this._tooltipState.value=this.calculateValueByPos(i*e),this._updateTooltip(),this._dispatchTooltipEvent("sliderTooltipUpdate"))},this._onTooltipHide=()=>{let{tooltip:t}=this.attribute;t&&t.alwaysShow||(this._tooltipState=null,this._tooltipShape&&this._tooltipShape.setAttribute("visible",!1),this._tooltipText&&this._tooltipText.setAttribute("visible",!1),this._dispatchTooltipEvent("sliderTooltipHide"))},this._onHandlerPointerdown=t=>{this._clearAllDragEvents(),this._isChanging=!0;let{x:e,y:i}=this.stage.eventPointTransform(t);this._currentHandler=t.target,this._prePos=this._isHorizontal?e:i;let r=(0,y.G)(),n="browser"===p.rF.env?p.rF:this.stage;n.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),r.forEach(t=>{n.addEventListener(t,this._onHandlerPointerUp)})},this._onHandlerPointerMove=t=>{var e,i;this._isChanging=!0;let{railWidth:r,railHeight:n,min:s,max:l}=this.attribute;if(l===s)return;let{x:o,y:h}=this.stage.eventPointTransform(t),u,d,c,p=0;this._isHorizontal?(p=(u=o)-this._prePos,d=null==(i=this._currentHandler)?void 0:i.attribute.x,c=r):(p=(u=h)-this._prePos,d=null==(e=this._currentHandler)?void 0:e.attribute.y,c=n);let g=(0,a.Z)(d+p,0,c),f=this.calculateValueByPos(g);"text"===this._currentHandler.type?this._updateHandlerText(this._currentHandler,g,f):this._updateHandler(this._currentHandler,g,f),this._updateTrack(),this._prePos=u,this._dispatchChangeEvent()},this._onHandlerPointerUp=t=>{this._isChanging=!1,this._currentHandler=null,this._clearAllDragEvents()},this._handleTouchMove=t=>{this._isChanging&&t.preventDefault()},this._onTrackPointerdown=t=>{this._clearAllDragEvents(),this._isChanging=!0;let{x:e,y:i}=this.stage.eventPointTransform(t);this._prePos=this._isHorizontal?e:i;let r=(0,y.G)(),n="browser"===p.rF.env?p.rF:this.stage;n.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),r.forEach(t=>{n.addEventListener(t,this._onTrackPointerUp)})},this._onTrackPointerMove=t=>{let e,i,r;this._isChanging=!0;let{railWidth:n,railHeight:s,min:l,max:o,inverse:h}=this.attribute;if(o===l)return;let{startHandler:u,endHandler:d}=this._getHandlers(),{x:c,y:p}=this.stage.eventPointTransform(t);this._isHorizontal?(e=c,i=this._track.attribute.width,r=n):(e=p,i=this._track.attribute.height,r=s);let g=e-this._prePos;if(u){let t=this._isHorizontal?u.attribute.x:u.attribute.y,e=h?(0,a.Z)(t+g,i,r):(0,a.Z)(t+g,0,r-i),n=this.calculateValueByPos(e);this._updateHandler(u,e,n)}if(d){let t=this._isHorizontal?d.attribute.x:d.attribute.y,e=h?(0,a.Z)(t+g,0,r-i):(0,a.Z)(t+g,i,r),n=this.calculateValueByPos(e),s=null==u?void 0:u.attribute;this._updateHandler(d,e,n),this._track.setAttributes(this._isHorizontal?{x:Math.min(s.x,d.attribute.x),width:Math.abs(s.x-d.attribute.x)}:{y:Math.min(s.y,d.attribute.y),height:Math.abs(s.y-d.attribute.y)})}this._prePos=e,this._dispatchChangeEvent()},this._onTrackPointerUp=t=>{this._isChanging=!1,this._clearAllDragEvents()},this._onRailPointerDown=t=>{let e,i,r;this._clearAllDragEvents(),this._isChanging=!0;let{railWidth:n,railHeight:s,min:l,max:a}=this.attribute;if(a===l)return;let h=this._startHandler,u=this._endHandler;this._isHorizontal?(e=t.viewX-this._rail.globalAABBBounds.x1,i=null==h?void 0:h.attribute.x,r=null==u?void 0:u.attribute.x):(e=t.viewY-this._rail.globalAABBBounds.y1,i=null==h?void 0:h.attribute.y,r=null==u?void 0:u.attribute.y);let d=this.calculateValueByPos(e);if((0,o.Z)(r)){let t=Math.abs(e-i)>Math.abs(e-r)?u:h;this._updateHandler(t,e,d)}else this._updateHandler(h,e,d);this._updateTrack(),this._dispatchChangeEvent()}}calculatePosByValue(t,e){let{layout:i,railWidth:r,railHeight:n,min:s,max:l,inverse:a}=this.attribute,o=0;return o=s===l?"start"===e?0:+("end"===e):(t-s)/(l-s),(a?1-o:o)*("vertical"===i?n:r)}calculateValueByPos(t){let{layout:e,railWidth:i,railHeight:r,min:n,max:s,inverse:l}=this.attribute,a="vertical"===e?r:i;return n+(s-n)*(l?1-t/a:t/a)}setValue(t){let{min:e,max:i}=this.attribute;if(i===e)return;let[r,n]=(0,h.IX)(t),{startHandler:s,endHandler:l}=this._getHandlers();s&&this._updateHandler(s,this.calculatePosByValue(r),r),l&&this._updateHandler(l,this.calculatePosByValue(n),n),this._updateTrack()}render(){var t,e;let i;this.removeAllChild(!0);let{layout:r="horizontal",railWidth:s,railHeight:l,startText:a,endText:h,min:d,max:c,showHandler:p=!0,showTooltip:f}=this.attribute,{value:m}=this.attribute;(0,u.Z)(m)&&(m=[d,c]),this._currentValue={startValue:v(m)[0],endValue:v(m)[1]};let y="horizontal"===r;this._isHorizontal=y;let b=g.i.group({x:0,y:0});b.name=n.innerView,this.add(b),this._innerView=b;let _,x=0;if(a&&a.visible){(_=g.i.text(Object.assign({x:y?0:s/2,y:y?l/2:0,textAlign:y?"start":"center",textBaseline:y?"middle":"top",text:a.text,lineHeight:null==(t=a.style)?void 0:t.fontSize},a.style))).name=n.startText,b.add(_);let e=(0,o.Z)(a.space)?a.space:0;x+=(y?_.AABBBounds.width():_.AABBBounds.height())+e}let C=g.i.group({x:y?x:0,y:y?0:x});b.add(C);let w=g.i.group({x:0,y:0});if(w.name=n.railContainer,this._railContainer=w,C.add(w),this._mainContainer=C,this._renderRail(w),x+=y?s:l,h&&h.visible){let t=(0,o.Z)(h.space)?h.space:0;(i=g.i.text(Object.assign({x:y?x+t:s/2,y:y?l/2:x+t,textAlign:y?"start":"center",textBaseline:y?"middle":"top",text:h.text,lineHeight:null==(e=h.style)?void 0:e.fontSize},h.style))).name=n.endText,b.add(i)}this._renderTrack(w),p&&(this._renderHandlers(C),this._bindEvents()),f&&(this._renderTooltip(),this._bindTooltipEvents())}_renderRail(t){let{railWidth:e,railHeight:i,railStyle:r,slidable:s}=this.attribute,l="default";!1!==s&&(l="pointer");let a=g.i.rect(Object.assign({x:0,y:0,width:e,height:i,cursor:l},r));return a.name=n.rail,t.add(a),this._rail=a,a}_renderHandlers(t){let{range:e,min:i,max:r,handlerSize:s=14,handlerStyle:l,handlerText:a,railHeight:o,railWidth:h,slidable:d}=this.attribute,{value:c}=this.attribute;(0,u.Z)(c)&&(c=[i,r]);let p=a&&a.visible,g=this._isHorizontal,[f,m]=v(c),y=this.calculatePosByValue(f,e?"start":"end"),_=this._renderHandler(Object.assign({x:g?y:h/2,y:g?o/2:y,size:s,strokeBoundsBuffer:0,cursor:!1===d?"default":b(g)},l));if(_.name=n.startHandler,this._startHandler=_,t.add(_),this._currentValue.startPos=y,p){let i=this._renderHandlerText(f,e?"start":"end");i.name=n.startHandlerText,t.add(i),this._startHandlerText=i}if(e){let e=this.calculatePosByValue(m,"end"),i=this._renderHandler(Object.assign({x:g?e:h/2,y:g?o/2:e,size:s,strokeBoundsBuffer:0,cursor:!1===d?"default":b(g)},l));if(i.name=n.endHandler,this._endHandler=i,t.add(i),this._currentValue.endPos=e,p){let e=this._renderHandlerText(m,"end");e.name=n.endHandlerText,t.add(e),this._endHandlerText=e}}}_renderTrack(t){let e,i,r,{range:s,min:l,max:o,railHeight:h,railWidth:p,trackStyle:f,railStyle:m,slidable:y,value:v}=this.attribute;if((0,u.Z)(v))s?(e=l,i=o):e=i=l;else if(s){let t=(0,d.Z)(v,l,o);e=t[0],i=t[1]}else e=l,i=(0,a.Z)(v,l,o);let _=this._isHorizontal;s||(e=l);let x=g.i.group({x:0,y:0,width:p,height:h,cornerRadius:null==m?void 0:m.cornerRadius,clip:!0,pickable:!1});x.name=n.trackContainer;let C=(0,c.Z)(s)&&!0===s.draggableTrack;r=!1===y?"default":!1===s||!1===C?"pointer":b(_);let w=this.calculatePosByValue(e,"start"),S=this.calculatePosByValue(i,s?"end":"start"),A=g.i.rect(Object.assign({x:_?Math.min(w,S):0,y:_?0:Math.min(w,S),width:_?Math.abs(S-w):p,height:_?h:Math.abs(S-w),cursor:r},f));A.name=n.track,this._track=A,x.add(A),t.add(x)}_renderHandler(t){return g.i.symbol(t)}_renderHandlerText(t,e){var i,r,n;let{align:s,handlerSize:l=14,handlerText:a={},railHeight:o,railWidth:h,slidable:u}=this.attribute,d=this._isHorizontal,c=this.calculatePosByValue(t,e),p=null!=(i=a.space)?i:4,f={text:a.formatter?a.formatter(t):t.toFixed(null!=(r=a.precision)?r:0),lineHeight:null==(n=a.style)?void 0:n.lineHeight,cursor:!1===u?"default":b(d)};return d?"top"===s?(f.textBaseline="bottom",f.textAlign="center",f.x=c,f.y=(o-l)/2-p):(f.textBaseline="top",f.textAlign="center",f.x=c,f.y=(o+l)/2+p):("left"===s?(f.textBaseline="middle",f.textAlign="end",f.x=(h-l)/2-p):(f.textBaseline="middle",f.textAlign="start",f.x=(h+l)/2+p),f.y=c),g.i.text(Object.assign(Object.assign({},f),a.style))}_renderTooltip(){var t;let{tooltip:e,railHeight:i,railWidth:r,align:n}=this.attribute;e&&e.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;let s=this._isHorizontal?0:r/2,l=this._isHorizontal?i/2:0;if(e&&e.shape){let t=g.i.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:s,y:l,symbolType:"circle"},e.shapeStyle));this._tooltipShape=t,this._mainContainer.add(t)}let a=e&&e.text||{},o=null!=(t=a.space)?t:6,h={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(h.x=s,h.y="top"===n?l-i/2-o:l+i/2+o,h.textAlign="center",h.textBaseline="top"===n?"bottom":"top"):(h.y=l,h.x="left"===n?s-r/2-o:l+r/2+o,h.textAlign="left"===n?"end":"start",h.textBaseline="middle");let u=g.i.text(Object.assign(Object.assign({},h),a.style));this._mainContainer.add(u),this._tooltipText=u,this._tooltipState&&this._updateTooltip()}_updateTooltip(){var t,e;if(!this._tooltipShape&&!this._tooltipText||!this._tooltipState)return;let{railWidth:i,railHeight:r}=this.attribute,n=this._isHorizontal?i:r,s=this._tooltipState.pos*n,l=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes({visible:!0,[l]:s});let{align:a}=this.attribute;if(this._tooltipText){let i=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes({visible:!0,[l]:s,text:i.formatter?i.formatter(this._tooltipState.value):this._isHorizontal||"left"!==a?`≈ ${this._tooltipState.value.toFixed(null!=(e=i.precision)?e:0)}`:`${this._tooltipState.value.toFixed(null!=(t=i.precision)?t:0)} ≈`})}}_bindEvents(){if(this.attribute.disableTriggerEvent)return;let{slidable:t,range:e}=this.attribute;t&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),(0,c.Z)(e)&&e.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown),("browser"===p.rF.env?p.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}))}_bindTooltipEvents(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}_clearAllDragEvents(){let t=(0,y.G)(),e="browser"===p.rF.env?p.rF:this.stage;e.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),t.forEach(t=>{e.removeEventListener(t,this._onHandlerPointerUp)}),e.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),t.forEach(t=>{e.removeEventListener(t,this._onTrackPointerUp)})}_updateTrack(){let{inverse:t,railWidth:e,railHeight:i}=this.attribute,r=this._startHandler,n=this._endHandler;if(this._isHorizontal){let i=null==r?void 0:r.attribute.x;if(n){let t=null==n?void 0:n.attribute.x;this._track.setAttributes({x:Math.min(i,t),width:Math.abs(i-t)})}else t?this._track.setAttributes({x:i,width:e-i}):this._track.setAttributes({width:i})}else{let e=null==r?void 0:r.attribute.y;if(n){let t=null==n?void 0:n.attribute.y;this._track.setAttributes({y:Math.min(e,t),height:Math.abs(e-t)})}else t?this._track.setAttributes({y:e,height:i-e}):this._track.setAttributes({height:e})}}_updateHandler(t,e,i){var r;let s=this._isHorizontal;t.setAttribute(s?"x":"y",e);let l=t.name===n.startHandler?this._startHandlerText:this._endHandlerText;if(l){let{handlerText:t={}}=this.attribute;l.setAttributes({text:t.formatter?t.formatter(i):i.toFixed(null!=(r=t.precision)?r:0),[s?"x":"y"]:e})}t.name===n.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_updateHandlerText(t,e,i){var r;let s=this._isHorizontal,{handlerText:l={}}=this.attribute;t.setAttributes({[s?"x":"y"]:e,text:l.formatter?l.formatter(i):i.toFixed(null!=(r=l.precision)?r:0)});let a=t.name===n.startHandlerText?this._startHandler:this._endHandler;a&&a.setAttributes({[s?"x":"y"]:e}),t.name===n.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_dispatchChangeEvent(){let t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}_dispatchTooltipEvent(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}_getHandlers(){let{inverse:t}=this.attribute,e=this._startHandler,i=this._endHandler;return i&&(this._isHorizontal?(!t&&i.attribute.x<(null==e?void 0:e.attribute.x)||t&&i.attribute.x>(null==e?void 0:e.attribute.x))&&([e,i]=[i,e]):(!t&&i.attribute.y<(null==e?void 0:e.attribute.y)||t&&i.attribute.y>(null==e?void 0:e.attribute.y))&&([e,i]=[i,e])),{startHandler:e,endHandler:i}}release(t){super.release(t),("browser"===p.rF.env?p.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearAllDragEvents()}}_.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}}},34160:function(t,e,i){"use strict";i.d(e,{b:()=>o});var r=i(15589),n=i(86972),s=i(95694),l=i(840),a=i(69877);function o(){(0,r.M)(),(0,n.k)(),(0,s.k)(),(0,l.v)(),(0,a.g)()}},52404:function(t,e,i){"use strict";i.d(e,{V:()=>y});var r=i(33974),n=i(95950),s=i(11681),l=i(61868),a=i(45273),o=i(47704),h=i(21777),u=i(35652),d=i(43562),c=i(88663),p=i(74562),g=i(14135),f=i(34160),m=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};(0,f.b)();class y extends p.k{getBgRect(){return this._bgRect}getTextShape(){return this._textShape}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,n.Z)({},y.defaultAttributes,t)),this.name="tag",this._tagStates=[],this._rectStates=[],this._symbolStates=[],this._textStates=[]}render(){var t,e,i;let n,p,f;this.cacheStates();let{text:y="",textStyle:v={},shape:b={},panel:_={},space:x=4,minWidth:C,maxWidth:w,padding:S=4,visible:A,state:M,type:k,textAlwaysCenter:T,containerTextAlign:R}=this.attribute,B=(0,s.o)(S),P=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group"),E,I=-B[3],L=-B[0],F=B[1]+B[3],O=B[0]+B[2],D=0,H=0,{visible:z}=b,W=m(b,["visible"]);if((0,l.Z)(z)){let t=(null==W?void 0:W.size)||10,e=(0,a.Z)(t)?t:Math.max(t[0],t[1]);E=P.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:t,strokeBoundsBuffer:0},W),{visible:z,x:e/2,y:e/2}),"symbol"),(0,o.Z)(null==M?void 0:M.shape)||(E.states=M.shape),z&&(H=e+x)}if(F+=H,D+=H,(0,g.TV)({text:y})||"rich"===k){let t=Object.assign(Object.assign(Object.assign({},(0,g.ut)(Object.assign({type:k,text:y},v))),v),{visible:(0,h.Z)(y)&&!1!==A,x:D,y:0});(0,u.Z)(t.lineHeight)&&(t.lineHeight=v.fontSize),p=(n=P.createOrUpdateChild("tag-text",t,"richtext")).AABBBounds.width(),f=n.AABBBounds.height()}else{let i=Object.assign(Object.assign({text:(0,d.Z)(y)&&"type"in y&&"text"===y.type?y.text:y,visible:(0,h.Z)(y)&&!1!==A,lineHeight:null==v?void 0:v.fontSize},v),{x:D,y:0});(0,u.Z)(i.lineHeight)&&(i.lineHeight=v.fontSize),n=P.createOrUpdateChild("tag-text",i,"text");let r=(0,g.fe)(i.text,v,null==(e=null==(t=this.stage)?void 0:t.getTheme())?void 0:e.text);p=r.width,f=r.height}F+=p;let N=null!=(i=b.size)?i:10,j=(0,a.Z)(N)?N:Math.max(N[0],N[1]);O+=Math.max(f,b.visible?j:0);let{textAlign:G,textBaseline:V}=v;((0,h.Z)(C)||(0,h.Z)(w))&&((0,h.Z)(C)&&F<C&&(F=C),(0,h.Z)(w)&&F>w&&(F=w,n.setAttribute("maxLineWidth",w-B[1]-B[2]))),I=0,L=0;let Z=0;"left"===G||"start"===G?Z=1:"right"===G||"end"===G?Z=-1:"center"===G&&(Z=0),Z?Z<0?(I-=F,E&&E.setAttribute("x",(E.attribute.x||0)-p),P.setAttribute("x",-B[1]-H)):Z>0&&P.setAttribute("x",B[3]):(I-=F/2,E&&E.setAttribute("x",(E.attribute.x||0)-p/2),P.setAttribute("x",-H/2));let U=(t,e)=>{"richtext"===n.type?n.setAttributes({x:t,textAlign:e,textConfig:(0,c.IX)(n.attribute.textConfig).map(t=>Object.assign(Object.assign({},t),{textAlign:e}))}):n.setAttributes({x:t,textAlign:e})};if((R?"center"===R:T)&&Z){let t=F-B[1]-B[3],e=p+H,i=1===Z?(t-e)/2+H+p/2:B[0]+H-(F/2+e/2-H)+p/2;if(U(i,"center"),E){let t=i-p/2-H+j/2;E.setAttributes({x:t})}}if(("left"===R||"start"===R)&&1!==Z){let t=F-B[1]-B[3],e=0===Z?-t/2+H/2:-F+B[3]+B[1]+H;U(e+H,"left"),E&&E.setAttributes({x:e+j/2})}if(("right"===R||"end"===R)&&-1!==Z){let t=F-B[1]-B[3],e=0===Z?t/2+H/2:t;if(U(e,"right"),E){let t=e-p-H+j/2;E.setAttributes({x:t})}}"middle"===V?(L-=O/2,E&&E.setAttribute("y",0)):"bottom"===V?(L-=O,E&&E.setAttribute("y",-f/2),P.setAttribute("y",-B[2])):"top"===V&&(P.setAttribute("y",B[0]),E&&E.setAttribute("y",f/2)),(0,o.Z)(null==M?void 0:M.text)||(n.states=M.text);let{visible:K}=_,$=m(_,["visible"]);if(A&&(0,l.Z)(K)){let t=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},$),{visible:K&&!!y,width:F,height:O,x:I,y:L}),"rect");if((0,o.Z)(null==M?void 0:M.panel)||(t.states=M.panel),$.customShape){let e=$.customShape;t.pathProxy=t=>e(this,t,new r.r)}this._bgRect=t}this._textShape=n,this._symbol=E,this.resetStates()}initAttributes(t,e){t=(null==e?void 0:e.skipDefault)?t:(0,n.Z)({},y.defaultAttributes,t),super.initAttributes(t),this.render()}addState(t,e,i){super.addState(t,e,i),this._textShape&&this._textShape.addState(t,e,i),this._bgRect&&this._bgRect.addState(t,e,i),this._symbol&&this._symbol.addState(t,e,i)}removeState(t,e){super.removeState(t,e),this._textShape&&this._textShape.removeState(t,e),this._bgRect&&this._bgRect.removeState(t,e),this._symbol&&this._symbol.removeState(t,e)}cacheStates(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p;this._tagStates=null!=(e=null==(t=this.currentStates)?void 0:t.slice())?e:[],this._rectStates=null!=(n=null==(r=null==(i=this._bgRect)?void 0:i.currentStates)?void 0:r.slice())?n:[],this._symbolStates=null!=(a=null==(l=null==(s=this._symbol)?void 0:s.currentStates)?void 0:l.slice())?a:[],this._textStates=null!=(u=null==(h=null==(o=this._textShape)?void 0:o.currentStates)?void 0:h.slice())?u:[],this.clearStates(),null==(d=this._bgRect)||d.clearStates(),null==(c=this._symbol)||c.clearStates(),null==(p=this._textShape)||p.clearStates()}resetStates(){var t,e,i;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&(null==(t=this._bgRect)||t.useStates(this._rectStates)),this._symbolStates.length&&(null==(e=this._symbol)||e.useStates(this._symbolStates)),this._textStates.length&&(null==(i=this._textShape)||i.useStates(this._textStates))}}y.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}}},70830:function(t,e,i){"use strict";i.d(e,{D:()=>c});var r=i(95950),n=i(11681),s=i(21777),l=i(31535),a=i(74562),o=i(76114),h=i(15589),u=i(69877),d=i(840);(0,h.M)(),(0,u.g)(),(0,d.v)();class c extends a.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},c.defaultAttributes,t)),this.name="title"}render(){var t,e,i,r,a,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w;let{textType:S,text:A,subtextType:M,textStyle:k={},subtext:T,subtextStyle:R={},width:B,height:P,minWidth:E,maxWidth:I,minHeight:L,maxHeight:F,align:O,verticalAlign:D,padding:H=0}=this.attribute,z=(0,n.o)(H),W=this.createOrUpdateChild("title-container",{x:z[3],y:z[0],zIndex:1},"group"),N=null!=(t=k.height)?t:P;if(!1!==this.attribute.visible&&!1!==k.visible){let{width:t,maxHeight:n,maxWidth:d,x:c=0,y:p=0,ellipsis:g=!0,wordBreak:f="break-word",maxWidth:m,lineClamp:y}=k;if("rich"===S||(0,s.Z)(k.character)){let r=Object.assign({x:c,y:p,width:null!=(e=null!=t?t:B)?e:0,height:null!=N?N:0,ellipsis:null==g||g,wordBreak:null!=f?f:"break-word",maxHeight:null!=n?n:F,maxWidth:null!=d?d:m,textConfig:null!=(i=k.character)?i:A},k);this._mainTitle=W.createOrUpdateChild("mainTitle",r,"richtext")}else if("html"===S){let e=Object.assign({html:Object.assign(Object.assign({dom:A},o.Ze),k),x:c,y:p,width:null!=(r=null!=t?t:B)?r:0,height:null!=N?N:0,ellipsis:g,wordBreak:f,maxHeight:null!=n?n:F,maxWidth:null!=d?d:m,textConfig:[]},k);this._mainTitle=W.createOrUpdateChild("mainTitle",e,"richtext")}else(0,s.Z)(A)&&(this._mainTitle=W.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:(0,l.Z)(A)?A:[A],whiteSpace:"normal"},k),{maxLineWidth:null!=(h=null!=(a=k.maxLineWidth)?a:t)?h:B,heightLimit:null!=(u=k.height)?u:F,lineClamp:y,ellipsis:g,x:c,y:p}),"text"))}let j=this._mainTitle?this._mainTitle.AABBBounds.height():0,G=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(!1!==this.attribute.visible&&!1!==R.visible){let{width:t,height:e,maxWidth:i,maxHeight:r,x:n=0,y:a=0,ellipsis:h=!0,wordBreak:u="break-word",lineClamp:v}=R,b=Math.max(Number.MIN_VALUE,F-j);if("rich"===M||(0,s.Z)(R.character)){let s=Object.assign({x:n,y:a,width:null!=(d=null!=t?t:B)?d:0,height:null!=(c=null!=e?e:P)?c:0,ellipsis:h,wordBreak:u,maxHeight:null!=r?r:b,maxWidth:null!=i?i:I,textConfig:null!=(p=R.character)?p:T},R);this._subTitle=W.createOrUpdateChild("subTitle",s,"richtext")}else if("html"===M){let s=Object.assign({html:Object.assign(Object.assign({dom:T},o.Ze),R),x:n,y:a,width:null!=(g=null!=t?t:B)?g:0,height:null!=(f=null!=e?e:P)?f:0,ellipsis:h,wordBreak:u,maxHeight:null!=r?r:b,maxWidth:null!=i?i:I,textConfig:[]},R);this._subTitle=W.createOrUpdateChild("subTitle",s,"richtext")}else(0,s.Z)(T)&&(this._subTitle=W.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:(0,l.Z)(T)?T:[T],whiteSpace:"normal"},R),{maxLineWidth:null!=(m=R.maxLineWidth)?m:B,heightLimit:null!=(y=R.heightLimit)?y:b,lineClamp:v,ellipsis:h,x:0,y:j}),"text"))}let V=this._subTitle?this._subTitle.AABBBounds.height():0,Z=Math.max(G,this._subTitle?this._subTitle.AABBBounds.width():0),U=j+(null!=(v=R.height)?v:V);if((0,s.Z)(B)&&(Z=B),(0,s.Z)(P)&&(U=P),(0,s.Z)(E)&&Z<E&&(Z=E),(0,s.Z)(I)&&Z>I&&(Z=I),(0,s.Z)(L)&&U<L&&(U=L),(0,s.Z)(F)&&U>F&&(U=F),W.attribute.width=Z,W.attribute.height=U,W.attribute.boundsPadding=z,this._mainTitle){if((0,s.Z)(O)||(0,s.Z)(k.align)){let t=k.align?k.align:O,e=null!=(b=k.width)?b:Z;"center"===t?(this._mainTitle.setAttribute("x",e/2),this._mainTitle.setAttribute("textAlign","center")):"right"===t?(this._mainTitle.setAttribute("x",e),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}let t=k.verticalAlign?k.verticalAlign:D,e=null!=N?N:this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height();"middle"===t?(this._mainTitle.setAttribute("y",e/2),this._mainTitle.setAttribute("textBaseline","middle")):"bottom"===t?(this._mainTitle.setAttribute("y",e),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}if(this._subTitle){if((0,s.Z)(O)||(0,s.Z)(R.align)){let t=R.align?R.align:O,e=null!=(x=null!=(_=R.width)?_:k.width)?x:Z;"center"===t?(this._subTitle.setAttribute("x",e/2),this._subTitle.setAttribute("textAlign","center")):"right"===t?(this._subTitle.setAttribute("x",e),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}let t=R.verticalAlign?R.verticalAlign:D,e=this._mainTitle?(0,s.Z)(N)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height(),N):this._mainTitle.AABBBounds.y2:0,i=null!=(w=null!=(C=R.height)?C:P)?w:this._subTitle.AABBBounds.empty()?0:this._subTitle.AABBBounds.height();"middle"===t?(this._subTitle.setAttribute("y",e+i/2),this._subTitle.setAttribute("textBaseline","middle")):"bottom"===t?(this._subTitle.setAttribute("y",e+i),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",e),this._subTitle.setAttribute("textBaseline","top"))}}}c.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}}},6091:function(t,e,i){"use strict";i.d(e,{Bh:()=>a,Ck:()=>function t(e,i){e.forEachChildren(e=>{let r=i(e);e.isContainer&&!r&&t(e,i)})},Dh:()=>l,U4:()=>h,WF:()=>o,ic:()=>u,pn:()=>n,tP:()=>s});var r=i(35652);let n=t=>!(0,r.Z)(t)&&!1!==t.visible;function s(t,e){if(!e)return[];let i=t.find(t=>t.name===e,!0);return i?i.getChildren():[]}function l(t,e){if(!e)return[];let i=t.find(t=>t.name===e,!0);return i?i.findAll(t=>"group"!==t.type,!0):[]}function a(t){let e=[t[0]];for(let i=1;i<t.length;i++)t[i].x===t[i-1].x&&t[i].y===t[i-1].y||e.push(t[i]);return e}function o(t){return t>=0&&t<Math.PI/2||t>3*Math.PI/2&&t<=2*Math.PI}function h(t,e,i){return Math.abs(t-e)<i}function u(t,e,i){return t?{textAlign:"right",textBaseline:"middle"}:{textAlign:e<Math.PI&&i.toLocaleLowerCase().includes("top")||e>Math.PI&&i.toLocaleLowerCase().includes("bottom")?"left":e<Math.PI&&i.toLocaleLowerCase().includes("bottom")||e>Math.PI&&i.toLocaleLowerCase().includes("top")?"right":"center",textBaseline:e<Math.PI&&i.includes("inside")||e>Math.PI&&!i.includes("inside")?"bottom":"top"}}},30685:function(t,e,i){"use strict";i.d(e,{G:()=>n});var r=i(89983);function n(){return"browser"===r.rF.env?["pointerup","pointerleave","pointercancel"]:["pointerup","pointerleave","pointerupoutside"]}},64215:function(t,e,i){"use strict";i.d(e,{Q6:()=>o,fM:()=>l,lO:()=>a});var r=i(76114),n=i(6091),s=i(47704);let l=(t,e,i)=>{let l=t.target;return l!==i&&l.name&&!(0,s.Z)(l.states)?(l.addState(r.HW.hover,!0),(0,n.Ck)(e,t=>{t!==l&&t.name&&!(0,s.Z)(t.states)&&t.addState(r.HW.hoverReverse,!0)}),l):i},a=(t,e,i)=>i?((0,n.Ck)(e,t=>{t.name&&!(0,s.Z)(t.states)&&(t.removeState(r.HW.hoverReverse),t.removeState(r.HW.hover))}),null):i,o=(t,e,i)=>{let l=t.target;return i===l&&l.hasState(r.HW.selected)?((0,n.Ck)(e,t=>{t.name&&!(0,s.Z)(t.states)&&(t.removeState(r.HW.selectedReverse),t.removeState(r.HW.selected))}),null):l.name&&!(0,s.Z)(l.states)?(l.addState(r.HW.selected,!0),(0,n.Ck)(e,t=>{t!==l&&t.name&&!(0,s.Z)(t.states)&&t.addState(r.HW.selectedReverse,!0)}),l):i}},69590:function(t,e,i){"use strict";i.d(e,{Dg:()=>a,Fv:()=>l,bA:()=>n,kE:()=>s});var r=i(88504);function n(t,e){return[t[0]*e,t[1]*e]}function s(t){let[e,i]=t;return Math.sqrt(e*e+i*i)}function l(t){let e=s(t);return e>0&&(e=1/e),[t[0]*e,t[1]*e]}function a(t,e,i){let n=function(t,e){let[i,r]=t,[n,s]=e,l=Math.sqrt((i*i+r*r)*(n*n+s*s));return Math.acos(Math.min(Math.max(l&&(i*n+r*s)/l,-1),1))}(t,e),s=(0,r.ir)(t,e)>=0;return i?s?2*Math.PI-n:n:s?n:2*Math.PI-n}},14135:function(t,e,i){"use strict";i.d(e,{He:()=>f,TV:()=>d,fe:()=>u,gM:()=>h,ut:()=>p,vS:()=>g});var r=i(25496),n=i(45011),s=i(21728),l=i(43562),a=i(21777),o=i(76114);let h=(t,e,i,n)=>new s.e(Object.assign({defaultFontParams:Object.assign({fontFamily:o.iR,fontSize:o.$M},n),getTextBounds:i?void 0:r.o,specialCharSet:"-/: .,@%'\"~"+s.e.ALPHABET_CHAR_SET+s.e.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t);function u(t,e,i={}){if(!t)return{width:0,height:0};let n=(0,r.o)({text:t,fontFamily:e.fontFamily||i.fontFamily||o.iR,fontSize:e.fontSize||i.fontSize||12,fontWeight:e.fontWeight||i.fontWeight,textAlign:e.textAlign||"center",textBaseline:e.textBaseline,ellipsis:!!e.ellipsis,maxLineWidth:e.maxLineWidth||1/0,lineHeight:e.fontSize||i.fontSize||12});return{width:n.width(),height:n.height()}}function d(t,e="type"){return"rich"===c(t,e)}function c(t,e="type"){var i,r;return(0,l.Z)(t.text)&&"type"in t.text?null!=(i=t.text.type)?i:"text":e in t&&null!=(r=t[e])?r:"text"}function p(t){var e,i;return(0,a.Z)(t.maxLineWidth)&&(t.maxWidth=t.maxLineWidth,delete t.maxLineWidth),t.width=null!=(e=t.width)?e:0,t.height=null!=(i=t.height)?i:0,t.textConfig=t.text.text||t.text,t}function g(t,e="type"){let i=c(t,e);return"rich"===i?n.i.richtext(p(t)):("html"===i?t=function(t){let{text:e,_originText:i}=t,{text:r}=e;return t.html=r,t.text=i,t.renderable=!1,t}(t):"react"===i&&(t=function(t){let{text:e,_originText:i}=t,{text:r}=e;return t.react=r,t.text=i,t.renderable=!1,t}(t)),n.i.text(t))}function f(t,e,i,r,n){"right"===t?"center"===i?e.setAttribute("x",r-n/2):"right"===i||"end"===i?e.setAttribute("x",r):e.setAttribute("x",r-n):"center"===i?e.setAttribute("x",r+n/2):"right"===i||"end"===i?e.setAttribute("x",r+n):e.setAttribute("x",r)}},70341:function(t,e,i){"use strict";i.d(e,{et:()=>n});var r=i(76620);Symbol.for("BoundsAllocate");let n=new class{constructor(){this.pools=[];for(let t=0;t<10;t++)this.pools.push(new r.FB)}allocate(t,e,i,n){if(!this.pools.length)return(new r.FB).setValue(t,e,i,n);let s=this.pools.pop();return s.x1=t,s.y1=e,s.x2=i,s.y2=n,s}allocateByObj(t){if(!this.pools.length)return new r.FB(t);let e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}},26050:function(t,e,i){"use strict";i.d(e,{A:()=>s});var r=i(16049),n=i(43937);let s=new class{constructor(){this.pools=[],this.allocatedCanvas=[]}shareCanvas(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}getCommonCanvas(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}allocate(t){if(!this.pools.length){let e=(0,n.JN)(Object.assign({nativeCanvas:r.w.global.createCanvas(t)},t));return this.allocatedCanvas.push(e),e}let e=this.pools.pop();return e.resize(t.width,t.height),e.dpr=t.dpr,e}allocateByObj(t){if(!this.pools.length){let e={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},i=(0,n.JN)(Object.assign({nativeCanvas:r.w.global.createCanvas(e)},e));return this.allocatedCanvas.push(i),i}let e=this.pools.pop();return e.width=t.width,e.height=t.height,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}},60504:function(t,e,i){"use strict";i.d(e,{QE:()=>a,yp:()=>o});var r=i(8992),n=i(4484);function s(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Symbol.for("MatrixAllocate"),Symbol.for("Mat4Allocate");class l{constructor(){this.pools=[]}static identity(t){return(0,n.TL)(t)}allocate(){if(!this.pools.length)return s();let t=this.pools.pop();return l.identity(t),t}allocateByObj(t){let e;e=this.pools.length?this.pools.pop():s();for(let i=0;i<e.length;i++)e[i]=t[i];return e}free(t){t&&this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}let a=new class{constructor(){this.pools=[]}allocate(t,e,i,n,s,l){if(!this.pools.length)return new r.y(t,e,i,n,s,l);let a=this.pools.pop();return a.a=t,a.b=e,a.c=i,a.d=n,a.e=s,a.f=l,a}allocateByObj(t){if(!this.pools.length)return new r.y(t.a,t.b,t.c,t.d,t.e,t.f);let e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}},o=new l},16049:function(t,e,i){"use strict";i.d(e,{w:()=>s});var r=i(91018),n=i(13380);let s=new class{get renderService(){return this._renderService||(this._renderService=r.n.get(n.p)),this._renderService}}},20686:function(t,e,i){"use strict";i.d(e,{Of:()=>d,MB:()=>u});class r{constructor(){this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}clearCache(t,e){let{CLEAN_THRESHOLD:i=this.CLEAN_THRESHOLD,L_TIME:r=this.L_TIME,R_COUNT:n=this.R_COUNT}=e;if(t.size<i)return 0;let s=0,l=e=>{s++,t.delete(e)},a=Date.now();return t.forEach((t,e)=>{if(t.timestamp.length<n)return l(e);let i=0;for(;a-t.timestamp[t.timestamp.length-1-i]<r&&!(++i>=n););if(i<n)return l(e);for(;a-t.timestamp[0]>r;)t.timestamp.shift()}),s}addLimitedTimestamp(t,e,i){let{R_TIMESTAMP_MAX_SIZE:r=this.R_TIMESTAMP_MAX_SIZE}=i;t.timestamp.length>r&&t.timestamp.shift(),t.timestamp.push(e)}clearTimeStamp(t,e){let{L_TIME:i=this.L_TIME}=e,r=Date.now();t.forEach(t=>{for(;r-t.timestamp[0]>i;)t.timestamp.shift()})}clearItemTimestamp(t,e){let{L_TIME:i=this.L_TIME}=e,r=Date.now();for(;r-t.timestamp[0]>i;)t.timestamp.shift()}}var n=i(88504),s=i(16049),l=i(63603);class a{static GetCanvas(){try{return a.canvas||(a.canvas=s.w.global.createCanvas({})),a.canvas}catch(t){return null}}static GetCtx(){if(!a.ctx){let t=a.GetCanvas();a.ctx=t.getContext("2d")}return a.ctx}}class o extends r{static getInstance(){return o._instance||(o._instance=new o),o._instance}constructor(t=[],e=100){super(),this.cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},this.dataMap=new Map;let i=a.GetCanvas(),r=a.GetCtx();if(i.width=e,i.height=1,!r)return;if(r.translate(0,0),!r)throw Error("获取ctx发生错误");let n=r.createLinearGradient(0,0,e,0);t.forEach(t=>{n.addColorStop(t[0],t[1])}),r.fillStyle=n,r.fillRect(0,0,e,1),this.rgbaSet=r.getImageData(0,0,e,1).data}getColor(t){let e=this.rgbaSet.slice(4*t,4*t+4);return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]/255})`}GetOrCreate(t,e,i,r,n=[],s=100){let l=`${t}${e}${i}${r}`;n.forEach(t=>l+=t.join()),l+=s;let a=this.dataMap.get(l);return a||(a={data:new o(n,s),timestamp:[]},this.addLimitedTimestamp(a,Date.now(),{}),this.dataMap.set(l,a)),this.clearCache(this.dataMap,this.cacheParams),a.data}}class h{static GetSize(t){for(let e=0;e<h.ImageSize.length;e++)if(h.ImageSize[e]>=t)return h.ImageSize[e];return t}static Get(t,e,i,r,n,s,l){let a=h.GenKey(t,e,i,r,n),o=h.cache[a];if(!o||0===o.length)return null;for(let t=0;t<o.length;t++)if(o[t].width>=s&&o[t].height>=l)return o[t].pattern;return null}static Set(t,e,i,r,n,s,l,a){let o=h.GenKey(t,e,i,r,n);h.cache[o]?h.cache[o].push({width:l,height:a,pattern:s}):h.cache[o]=[{width:l,height:a,pattern:s}]}static GenKey(t,e,i,r,n){return`${e},${i},${r},${n},${t.join()}`}}function u(t,e,i,r){let{stops:s,startAngle:a,endAngle:o}=r;for(;i<0;)i+=n.f7;for(;i>n.f7;)i-=n.f7;if(i<a||i>o)return s[0].color;let h,u,d=(i-a)/(o-a);for(let t=0;t<s.length;t++)if(s[t].offset>=d){h=s[t-1],u=s[t];break}return d=(d-h.offset)/(u.offset-h.offset),(0,l.BM)(h.color,u.color,d,!1)}function d(t,e,i,r,n,s,l,u,d){let c=Math.floor(180*n/Math.PI),p=a.GetCanvas(),g=a.GetCtx();if(!g)return null;let f=h.GetSize(u),m=h.GetSize(d),y=h.Get(e,i,r,s,l,f,m);if(y)return y;let v=Math.sqrt(Math.max(Math.max(Math.pow(i,2)+Math.pow(r,2),Math.pow(f-i,2)+Math.pow(r,2)),Math.max(Math.pow(f-i,2)+Math.pow(m-r,2),Math.pow(i,2)+Math.pow(m-r,2)))),b=c+1,_=n/Math.max(1,b-1),x=o.getInstance().GetOrCreate(i,r,f,m,e,b),C=2*Math.PI*v/360;p.width=f,p.height=m,g.setTransform(1,0,0,1,0,0),g.clearRect(0,0,f,m),g.translate(i,r),g.rotate(s);for(let t=0,e=b-1;t<e&&!(s+t*_>l);t++){let e=x.getColor(t);g.beginPath(),g.rotate(_),g.moveTo(0,0),g.lineTo(v,-2*C),g.lineTo(v,0),g.fillStyle=e,g.closePath(),g.fill()}let w=g.getImageData(0,0,f,m);return p.width=w.width,p.height=w.height,g.putImageData(w,0,0),(y=t.createPattern(p,"no-repeat"))&&h.Set(e,i,r,s,l,y,f,m),y}h.cache={},h.ImageSize=[20,40,80,160,320,640,1280,2560]},26514:function(t,e,i){"use strict";i.d(e,{A:()=>n,r:()=>r});let r=Symbol.for("CanvasFactory"),n=Symbol.for("Context2dFactory")},84527:function(t,e,i){"use strict";i.d(e,{u:()=>r});class r{get displayWidth(){return this._pixelWidth/this._dpr}get displayHeight(){return this._pixelHeight/this._dpr}get id(){return this._id}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get nativeCanvas(){return this._nativeCanvas}set nativeCanvas(t){this._nativeCanvas=t}get width(){return this._pixelWidth}set width(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}get height(){return this._pixelHeight}set height(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}getContext(t){return this._context}get visiable(){return this._visiable}set visiable(t){this._visiable=t,t?this.show():this.hide()}get dpr(){return this._dpr}set dpr(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}constructor(t){var e;let{nativeCanvas:i,width:r=500,height:n=500,dpr:s=1,x:l,y:a,id:o,canvasControled:h=!0}=t;this._x=null!=l?l:0,this._y=null!=a?a:0,this._pixelWidth=r*s,this._pixelHeight=n*s,this._visiable=!1!==t.visiable,this.controled=h,this._displayWidth=r,this._displayHeight=n,this._dpr=s,this._nativeCanvas=i,this._id=null!=(e=i.id)?e:o,o&&(i.id=o),this.init(t)}getNativeCanvas(){return this._nativeCanvas}hide(){}show(){}applyPosition(){}resetStyle(t){}resize(t,e){}toDataURL(t,e){return""}readPixels(t,e,i,r){return this._context.getImageData(t,e,i,r)}convertToBlob(t){throw Error("暂未实现")}transferToImageBitmap(){throw Error("暂未实现")}release(...t){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}r.env="browser"},92679:function(t,e,i){"use strict";i.d(e,{w:()=>d});var r=i(8992),n=i(26004),s=i(43937),l=i(33974),a=i(21823),o=i(60504);let h=new r.y(1,0,0,1,0,0),u={x:0,y:0},d=class{get nativeContext(){return this.path}constructor(t,e){this.matrix=new r.y(1,0,0,1,0,0),this.stack=[],this.dpr=e,this.applyedMatrix=new r.y(1,0,0,1,0,0),this.path=new l.r,this._clearMatrix=new r.y(1,0,0,1,0,0)}getCanvas(){throw Error("不支持getCanvas")}getContext(){throw Error("不支持getContext")}setTransformForCurrent(t=!1){!t&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix=this.cloneMatrix(this.matrix))}get currentMatrix(){return this.matrix}cloneMatrix(t){return o.QE.allocateByObj(t)}clear(){this.save(),this.resetTransform(),this.restore()}reset(){this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new r.y(1,0,0,1,0,0),this.stack.length=0}restore(){this.stack.length>0&&(o.QE.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent())}highPerformanceRestore(){this.stack.length>0&&(o.QE.free(this.matrix),this.matrix=this.stack.pop())}rotate(t,e=!0){this.matrix.rotate(t),e&&this.setTransformForCurrent()}save(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}highPerformanceSave(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}scale(t,e,i=!0){this.matrix.scale(t,e),i&&this.setTransformForCurrent()}setScale(t,e,i=!0){this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}scalePoint(t,e,i,r,n=!0){this.translate(i,r,!1),this.scale(t,e,!1),this.translate(-i,-r,!1),n&&this.setTransformForCurrent()}setTransform(t,e,i,r,n,s,l=!0,a=this.dpr){this.matrix.setValue(a*t,a*e,a*i,a*r,a*n,a*s),l&&this.setTransformForCurrent()}setTransformFromMatrix(t,e=!0,i=this.dpr){this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}resetTransform(t=!0,e=this.dpr){this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}transform(t,e,i,r,n,s,l=!0){this.matrix.multiply(t,e,i,r,n,s),l&&this.setTransformForCurrent()}transformFromMatrix(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}translate(t,e,i=!0){this.matrix.translate(t,e),i&&this.setTransformForCurrent()}rotateDegrees(t,e=!0){let i=t*Math.PI/180;this.rotate(i,e)}rotateAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}rotateDegreesAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}beginPath(){this.path.clear()}clip(t,e){}arc(t,e,i,r,n,s){this.path.arc(t,e,i,r,n,s)}arcTo(t,e,i,r,n){this.path.arcTo(t,e,i,r,n)}bezierCurveTo(t,e,i,r,n,s){this.path.bezierCurveTo(t,e,i,r,n,s)}closePath(){this.path.closePath()}ellipse(t,e,i,r,n,s,l,a){}lineTo(t,e){this.path.lineTo(t,e)}moveTo(t,e){this.path.moveTo(t,e)}quadraticCurveTo(t,e,i,r){this.path.quadraticCurveTo(t,e,i,r)}rect(t,e,i,r){this.path.rect(t,e,i,r)}createImageData(t,e){return null}createLinearGradient(t,e,i,r){throw Error("不支持createLinearGradient")}createPattern(t,e){throw Error("不支持createPattern")}createRadialGradient(t,e,i,r,n,s){throw Error("不支持createRadialGradient")}createConicGradient(t,e,i,r){return null}fill(t,e){}fillRect(t,e,i,r){this.path.rect(t,e,i,r)}clearRect(t,e,i,r){}fillText(t,e,i){}getImageData(t,e,i,r){return null}getLineDash(){return[]}isPointInPath(t,e){return this.matrix.transformPoint({x:t,y:e},u),(0,s.XS)(this.path.commandList,u.x,u.y)}isPointInStroke(t,e){if(!this.lineWidth)return!1;this.matrix.transformPoint({x:t,y:e},u);let i=(0,a.D)(this,this.lineWidth,this.dpr);return(0,s.me)(this.path.commandList,i,u.x,u.y)}measureText(t){throw Error("不支持measureText")}putImageData(t,e,i){throw Error("不支持measureText")}setLineDash(t){}stroke(t){}strokeRect(t,e,i,r){this.path.rect(t,e,i,r)}strokeText(t,e,i){}drawImage(){}setCommonStyle(t,e,i,r,n){}_setCommonStyle(t,e,i,r){}setStrokeStyle(t,e,i,r,n){}_setStrokeStyle(t,e,i,r){}setTextStyleWithoutAlignBaseline(t,e){}setTextStyle(t,e){}draw(){}clearMatrix(t=!0,e=this.dpr){this.setTransformFromMatrix(h,t,e)}setClearMatrix(t,e,i,r,n,s){this._clearMatrix.setValue(t,e,i,r,n,s)}onlyTranslate(t=this.dpr){return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}release(...t){this.stack.forEach(t=>o.QE.free(t)),this.stack.length=0}};d=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,n.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],d)},43937:function(t,e,i){"use strict";i.d(e,{JN:()=>h,XS:()=>k,me:()=>T});var r=i(88504),n=i(6201),s=i(13105),l=i(91018),a=i(16049),o=i(26514);function h(t){return l.n.getNamed(o.r,a.w.global.env)(t)}let u=Math.sqrt(3),d=1/3;function c(t){return t>-x&&t<x}let p=[0,0],g=[0,0],f=[0,0];function m(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function y(t,e,i,r){let n=1-r;return n*(n*t+2*r*e)+r*r*i}function v(t,e,i,r,n){let s=1-n;return s*s*(s*t+3*n*e)+n*n*(n*r+3*s*i)}function b(t){return(t%=r.f7)<0&&(t+=r.f7),t}function _(t,e,i,r,n,s,l){if(0===n)return!1;let a=n/2,o=0,h=t;if(l>e+a&&l>r+a||l<e-a&&l<r-a||s>t+a&&s>i+a||s<t-a&&s<i-a)return!1;if(t===i)return Math.abs(s-t)<=n/2;let u=(o=(e-r)/(t-i))*s-l+(t*r-i*e)/(t-i);return u*u/(o*o+1)<=n/2*n/2}let x=1e-4,C=[-1,-1,-1],w=[-1,-1];function S(t){return Math.round(t/r.pi*1e8)/1e8%2*r.pi}let A=[0,0];function M(t,e,i,l,a){let o=t.length,h,M,k=0,T=0,R=0,B=0,P=0;for(let O=0;O<o;O++){var E,I,L,F;let o=t[O],D=0===O;o[0]===s.m.M&&O>1&&(i||(k+=(0,n.N0)(T,R,B,P,l,a))),D&&(T=o[1],R=o[2],B=T,P=R);let H=o[0],z=o[1],W=o[2],N=o[3],j=o[4],G=o[5],V=o[6],Z=j,U=G;A[0]=Z,A[1]=U,function(t,e){let i=S(t[0]);i<0&&(i+=r.f7);let n=i-t[0],s=t[1];s+=n,!e&&s-i>=r.f7?s=i+r.f7:e&&i-s>=r.f7?s=i-r.f7:!e&&i>s?s=i+(r.f7-S(i-s)):e&&i<s&&(s=i-(r.f7-S(s-i))),t[0]=i,t[1]=s}(A,!!o[6]),Z=A[0],U=A[1];let K=Z,$=U-Z,Y=!!(1-!o[6]),X=(l-z)*N/N+z;switch(H){case s.m.M:B=z,P=W,T=B,R=P;break;case s.m.L:if(i){if(_(T,R,z,W,e,l,a))return!0}else k+=(0,n.N0)(T,R,z,W,l,a)||0;T=z,R=W;break;case s.m.C:if(i){if(E=T,I=R,0!==e&&(!(a>I+e)||!(a>W+e)||!(a>j+e)||!(a>V+e))&&(!(a<I-e)||!(a<W-e)||!(a<j-e)||!(a<V-e))&&(!(l>E+e)||!(l>z+e)||!(l>N+e)||!(l>G+e))&&(!(l<E-e)||!(l<z-e)||!(l<N-e)||!(l<G-e))&&function(t,e,i,r,n,s,l,a,o,h,u){let d,c,y,b,_=0,x=.005,C=1/0;p[0]=o,p[1]=h;for(let o=0;o<1;o+=.05)g[0]=v(t,i,n,l,o),g[1]=v(e,r,s,a,o),(y=m(p,g))<C&&(_=o,C=y);C=1/0;for(let o=0;o<32&&!(x<1e-4);o++)d=_-x,c=_+x,g[0]=v(t,i,n,l,d),g[1]=v(e,r,s,a,d),y=m(g,p),d>=0&&y<C?(_=d,C=y):(f[0]=v(t,i,n,l,c),f[1]=v(e,r,s,a,c),b=m(f,p),c<=1&&b<C?(_=c,C=b):x*=.5);return Math.sqrt(C)}(E,I,z,W,N,j,G,V,l,a,0)<=e/2)return!0}else k+=function(t,e,i,r,n,s,l,a,o,h){if(h>e&&h>r&&h>s&&h>a||h<e&&h<r&&h<s&&h<a)return 0;let p=function(t,e,i,r,n,s){let l=r+3*(e-i)-t,a=3*(i-2*e+t),o=3*(e-t),h=t-n,p=a*a-3*l*o,g=a*o-9*l*h,f=o*o-3*a*h,m=0;if(c(p)&&c(g))if(c(a))s[0]=0;else{let t=-o/a;t>=0&&t<=1&&(s[m++]=t)}else{let t=g*g-4*p*f;if(c(t)){let t=g/p,e=-a/l+t,i=-t/2;e>=0&&e<=1&&(s[m++]=e),i>=0&&i<=1&&(s[m++]=i)}else if(t>0){let e=Math.sqrt(t),i=p*a+1.5*l*(-g+e),r=p*a+1.5*l*(-g-e),n=(-a-((i=i<0?-Math.pow(-i,d):Math.pow(i,d))+(r=r<0?-Math.pow(-r,d):Math.pow(r,d))))/(3*l);n>=0&&n<=1&&(s[m++]=n)}else{let t=Math.acos((2*p*a-3*l*g)/(2*Math.sqrt(p*p*p)))/3,e=Math.sqrt(p),i=Math.cos(t),r=(-a-2*e*i)/(3*l),n=(-a+e*(i+u*Math.sin(t)))/(3*l),o=(-a+e*(i-u*Math.sin(t)))/(3*l);r>=0&&r<=1&&(s[m++]=r),n>=0&&n<=1&&(s[m++]=n),o>=0&&o<=1&&(s[m++]=o)}}return m}(e,r,s,a,h,C);if(0===p)return 0;let g=0,f=-1,m=0,y=0;for(let h=0;h<p;h++){let u=C[h],d=0===u||1===u?.5:1;v(t,i,n,l,u)<o||(f<0&&(f=function(t,e,i,r,n){let s=6*i-12*e+6*t,l=9*e+3*r-3*t-9*i,a=3*e-3*t,o=0;if(c(l)){if(s>x||s<-x){let t=-a/s;t>=0&&t<=1&&(n[o++]=t)}}else{let t=s*s-4*l*a;if(c(t))n[0]=-s/(2*l);else if(t>0){let e=Math.sqrt(t),i=(-s+e)/(2*l),r=(-s-e)/(2*l);i>=0&&i<=1&&(n[o++]=i),r>=0&&r<=1&&(n[o++]=r)}}return o}(e,r,s,a,w),w[1]<w[0]&&f>1&&function(){let t=w[0];w[0]=w[1],w[1]=t}(),m=v(e,r,s,a,w[0]),f>1&&(y=v(e,r,s,a,w[1]))),2===f?u<w[0]?g+=m<e?d:-d:u<w[1]?g+=y<m?d:-d:g+=a<y?d:-d:u<w[0]?g+=m<e?d:-d:g+=a<m?d:-d)}return g}(T,R,z,W,N,j,G,V,l,a)||0;T=G,R=V;break;case s.m.Q:if(i){if(L=T,F=R,0!==e&&(!(a>F+e)||!(a>W+e)||!(a>j+e))&&(!(a<F-e)||!(a<W-e)||!(a<j-e))&&(!(l>L+e)||!(l>z+e)||!(l>N+e))&&(!(l<L-e)||!(l<z-e)||!(l<N-e))&&function(t,e,i,r,n,s,l,a,o){let h=0,u=.005,d=1/0;p[0]=l,p[1]=a;for(let l=0;l<1;l+=.05){g[0]=y(t,i,n,l),g[1]=y(e,r,s,l);let a=m(p,g);a<d&&(h=l,d=a)}d=1/0;for(let l=0;l<32&&!(u<1e-4);l++){let l=h-u,a=h+u;g[0]=y(t,i,n,l),g[1]=y(e,r,s,l);let o=m(g,p);if(l>=0&&o<d)h=l,d=o;else{f[0]=y(t,i,n,a),f[1]=y(e,r,s,a);let l=m(f,p);a<=1&&l<d?(h=a,d=l):u*=.5}}return Math.sqrt(d)}(L,F,z,W,N,j,l,a,0)<=e/2)return!0}else k+=function(t,e,i,r,n,s,l,a){if(a>e&&a>r&&a>s||a<e&&a<r&&a<s)return 0;let o=function(t,e,i,r,n){let s=t-2*e+i,l=2*(e-t),a=t-r,o=0;if(c(s)){if(l>x||l<-x){let t=-a/l;t>=0&&t<=1&&(n[o++]=t)}}else{let t=l*l-4*s*a;if(c(t)){let t=-l/(2*s);t>=0&&t<=1&&(n[o++]=t)}else if(t>0){let e=Math.sqrt(t),i=(-l+e)/(2*s),r=(-l-e)/(2*s);i>=0&&i<=1&&(n[o++]=i),r>=0&&r<=1&&(n[o++]=r)}}return o}(e,r,s,a,C);if(0===o)return 0;let h=function(t,e,i){let r=t+i-2*e;return 0===r?.5:(t-e)/r}(e,r,s);if(h>=0&&h<=1){let a=0,u=y(e,r,s,h);for(let r=0;r<o;r++){let o=0===C[r]||1===C[r]?.5:1;y(t,i,n,C[r])<l||(C[r]<h?a+=u<e?o:-o:a+=s<u?o:-o)}return a}let u=0===C[0]||1===C[0]?.5:1;return y(t,i,n,C[0])<l?0:s<e?u:-u}(T,R,z,W,N,j,l,a)||0;T=N,R=j;break;case s.m.A:if(h=Math.cos(K)*N+z,M=Math.sin(K)*N+W,D?(B=h,P=M):k+=(0,n.N0)(T,R,h,M,l,a),i){if(function(t,e,i,n,s,l,a,o,h){if(0===a)return!1;let u=Math.sqrt((o-=t)*o+(h-=e)*h);if(u-a>i||u+a<i)return!1;if(Math.abs(n-s)%r.f7<1e-4)return!0;if(l){let t=n;n=b(s),s=b(t)}else n=b(n),s=b(s);n>s&&(s+=r.f7);let d=Math.atan2(h,o);return d<0&&(d+=r.f7),d>=n&&d<=s||d+r.f7>=n&&d+r.f7<=s}(z,W,N,K,K+$,Y,e,X,a))return!0}else k+=function(t,e,i,n,s,l,a,o){if((o-=e)>i||o<-i)return 0;let h=Math.sqrt(i*i-o*o);C[0]=-h,C[1]=h;let u=Math.abs(n-s);if(u<1e-4)return 0;if(u>=r.f7-1e-4)return n=0,s=r.f7,a>=C[0]+t&&a<=C[1]+t?l?1:-1:0;if(n>s){let t=n;n=s,s=t}n<0&&(n+=r.f7,s+=r.f7);let d=0;for(let e=0;e<2;e++){let i=C[e];if(i+t>a){let t=Math.atan2(o,i),e=l?1:-1;t<0&&(t=r.f7+t),(t>=n&&t<=s||t+r.f7>=n&&t+r.f7<=s)&&(t>r.pi/2&&t<1.5*r.pi&&(e=-e),d+=e)}}return d}(z,W,N,K,K+$,Y,X,a);T=Math.cos(K+$)*N+z,R=Math.sin(K+$)*N+W;break;case s.m.R:if(B=T=z,P=R=W,h=B+N,M=P+j,i){if(_(B,P,h,P,e,l,a)||_(h,P,h,M,e,l,a)||_(h,M,B,M,e,l,a)||_(B,M,B,P,e,l,a))return!0}else k+=(0,n.N0)(h,P,h,M,l,a),k+=(0,n.N0)(B,M,B,P,l,a);break;case s.m.Z:if(i){if(_(T,R,B,P,e,l,a))return!0}else k+=(0,n.N0)(T,R,B,P,l,a);T=B,R=P}}return i||Math.abs(R-P)<x||(k+=(0,n.N0)(T,R,B,P,l,a)||0),0!==k}function k(t,e,i){return M(t,0,!1,e,i)}function T(t,e,i,r){return M(t,e,!0,i,r)}},63603:function(t,e,i){"use strict";i.d(e,{BM:()=>a,Ib:()=>h});var r=i(38705),n=i(45273),s=i(31535);function l(t,e=!1){return Array.isArray(t)&&(0,n.Z)(t[0])?e?`rgb(${Math.round(t[0])},${Math.round(t[1])},${Math.round(t[2])},${t[3].toFixed(2)})`:`rgb(${Math.round(t[0])},${Math.round(t[1])},${Math.round(t[2])})`:t}function a(t,e,i,r,l){return Array.isArray(t)&&!(0,n.Z)(t[0])||Array.isArray(e)&&!(0,n.Z)(e[0])?[,,,,].fill(0).map((n,l)=>{var a,h;return o((0,s.Z)(t)?null!=(a=t[l])?a:t[0]:t,(0,s.Z)(e)?null!=(h=e[l])?h:e[0]:e,i,r)}):o(t,e,i,r,l)}function o(t,e,i,n,s){if(!t||!e)return t&&l(t)||e&&l(e)||!1;let o,h,u=!1,d=!1;if(Array.isArray(t)?o=t:"string"==typeof t?o=r.VH.Get(t,r.Mr.Color255):u=!0,Array.isArray(e)?h=e:"string"==typeof e?h=r.VH.Get(e,r.Mr.Color255):d=!0,u!==d){let r=u?t:e,o=u?e:t,h=Object.assign(Object.assign({},r),{stops:r.stops.map(t=>Object.assign(Object.assign({},t),{color:l(o)}))});return u?a(r,h,i,n,s):a(h,r,i,n,s)}if(u){if(t.gradient===e.gradient){let r=t.stops,n=e.stops;if(r.length!==n.length)return!1;if("linear"===t.gradient){var p,g,f,m=t,y=e,v=i;let r=m.stops,n=y.stops;return{gradient:"linear",x0:m.x0+(y.x0-m.x0)*v,x1:m.x1+(y.x1-m.x1)*v,y0:m.y0+(y.y0-m.y0)*v,y1:m.y1+(y.y1-m.y1)*v,stops:Array(r.length).fill(0).map((t,e)=>({color:c(r[e].color,n[e].color,v),offset:r[e].offset+(n[e].offset-r[e].offset)*v}))}}if("radial"===t.gradient){var b=t,_=e,x=i;let r=b.stops,n=_.stops;return{gradient:"radial",x0:b.x0+(_.x0-b.x0)*x,x1:b.x1+(_.x1-b.x1)*x,y0:b.y0+(_.y0-b.y0)*x,y1:b.y1+(_.y1-b.y1)*x,r0:b.r0+(_.r0-b.r0)*x,r1:b.r1+(_.r1-b.r1)*x,stops:Array(r.length).fill(0).map((t,e)=>({color:c(r[e].color,n[e].color,x),offset:r[e].offset+(n[e].offset-r[e].offset)*x}))}}if("conical"===t.gradient){var C=t,w=e,S=i;let r=C.stops,n=w.stops;return{gradient:"conical",startAngle:C.startAngle+(w.startAngle-C.startAngle)*S,endAngle:C.endAngle+(w.endAngle-C.endAngle)*S,x:C.x+(w.x-C.x)*S,y:C.y+(w.y-C.y)*S,stops:Array(r.length).fill(0).map((t,e)=>({color:c(r[e].color,n[e].color,S),offset:r[e].offset+(n[e].offset-r[e].offset)*S}))}}}return!1}return s&&s(o,h),l((p=o,g=h,f=i,[p[0]+(g[0]-p[0])*f,p[1]+(g[1]-p[1])*f,p[2]+(g[2]-p[2])*f,p[3]+(g[3]-p[3])*f]),n)}function h(t,e,i){return`rgba(${t[0]+(e[0]-t[0])*i},${t[1]+(e[1]-t[1])*i},${t[2]+(e[2]-t[2])*i},${t[3]+(e[3]-t[3])*i})`}let u=[0,0,0,0],d=[0,0,0,0];function c(t,e,i){return r.VH.Get(t,r.Mr.Color255,u),r.VH.Get(e,r.Mr.Color255,d),`rgba(${Math.round(u[0]+(d[0]-u[0])*i)},${Math.round(u[1]+(d[1]-u[1])*i)},${Math.round(u[2]+(d[2]-u[2])*i)},${u[3]+(d[3]-u[3])*i})`}},38705:function(t,e,i){"use strict";i.d(e,{Mr:()=>n,VH:()=>l});var r,n,s=i(14925);(r=n||(n={}))[r.Color255=0]="Color255",r[r.Color1=1]="Color1";class l{static Get(t,e=n.Color1,i=[0,0,0,1]){if(e===n.Color1){let e=l.store1[t];if(e)return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i;let r=s.Il.parseColorString(t);if(r){let e=[r.r/255,r.g/255,r.b/255,r.opacity];l.store1[t]=e,l.store255[t]=[r.r,r.g,r.b,r.opacity],i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]}return i}let r=l.store255[t];if(r)return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i;let a=s.Il.parseColorString(t);return a&&(l.store1[t]=[a.r/255,a.g/255,a.b/255,a.opacity],l.store255[t]=[a.r,a.g,a.b,a.opacity],i[0]=a.r,i[1]=a.g,i[2]=a.b,i[3]=a.opacity),i}static Set(t,e,i){if(e===n.Color1)l.store1[t]||(l.store1[t]=i,l.store255[t]=[Math.floor(255*i[0]),Math.floor(255*i[1]),Math.floor(255*i[2]),Math.floor(255*i[3])]);else{if(l.store255[t])return;l.store255[t]=i,l.store1[t]=[i[0]/255,i[1]/255,i[2]/255,i[3]]}}}l.store255={},l.store1={}},49009:function(t,e,i){"use strict";i.d(e,{y:()=>s});var r=i(88504),n=i(79314);let s=(t,e,i,s)=>{let l,a=!1,o=!1;if(e.forEachChildren(t=>!(a=t.numberType===n.IJ)),e.forEachChildren(t=>!(o=!!t.findFace)),a){let t=e.getChildren(),n=[...t];n.sort((t,e)=>{var i,n,s,l;let a=(null!=(n=null!=(i=t.attribute.startAngle)?i:0+t.attribute.endAngle)?n:0)/2,o=(null!=(l=null!=(s=e.attribute.startAngle)?s:0+e.attribute.endAngle)?l:0)/2;for(;a<0;)a+=r.f7;for(;o<0;)o+=r.f7;return o-a}),n.forEach(t=>{t._next=null,t._prev=null}),e.removeAllChild(),e.update(),n.forEach(t=>{e.appendChild(t)}),s.hack_pieFace="outside",(l=i(a,o))&&l.graphic||(s.hack_pieFace="inside",l=i(a,o)),l&&l.graphic||(s.hack_pieFace="top",l=i(a,o)),e.removeAllChild(),t.forEach(t=>{t._next=null,t._prev=null}),t.forEach(t=>{e.appendChild(t)})}else if(o){let r=e.getChildren(),n=r.map(e=>({ave_z:e.findFace().vertices.map(i=>{var r;return t.view(i[0],i[1],null!=(r=i[2]+e.attribute.z)?r:0)[2]}).reduce((t,e)=>t+e,0),g:e}));n.sort((t,e)=>e.ave_z-t.ave_z),e.removeAllChild(),n.forEach(t=>{t.g._next=null,t.g._prev=null}),e.update(),n.forEach(t=>{e.add(t.g)}),l=i(a,o),e.removeAllChild(),r.forEach(t=>{t._next=null,t._prev=null}),e.update(),r.forEach(t=>{e.add(t)})}else l=i(a,o);return l}},58866:function(t,e,i){"use strict";var r,n;i.d(e,{Z:()=>s});let s=(r={},function(t){Object.prototype.hasOwnProperty;let e="function"==typeof Symbol,i=e&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=(e&&void 0!==Symbol.iterator&&Symbol.iterator,Object.create,Object.getPrototypeOf(Function)),n=("object"==typeof process&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL,Map),s=new WeakMap;function l(t,e,i){let r=s.get(t);if(o(r)){if(!i)return;r=new n,s.set(t,r)}let l=r.get(e);if(o(l)){if(!i)return;l=new n,r.set(e,l)}return l}function a(t,e,i){let r=l(e,i,!1);return!o(r)&&!!r.has(t)}function o(t){return void 0===t}function h(t){return null===t}function u(t){return"object"==typeof t?null!==t:"function"==typeof t}function d(t){let e=function(t,e){switch(function(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}let r="string",n=function(t,e){let i=t[e];if(null!=i){if(!c(i))throw TypeError();return i}}(t,i);if(void 0!==n){let e=n.call(t,r);if(u(e))throw TypeError();return e}return function(t,e){if("string"===e){let e=t.toString;if(c(e)){let i=e.call(t);if(!u(i))return i}let i=t.valueOf;if(c(i)){let e=i.call(t);if(!u(e))return e}}else{let e=t.valueOf;if(c(e)){let i=e.call(t);if(!u(i))return i}let i=t.toString;if(c(i)){let e=i.call(t);if(!u(e))return e}}throw TypeError()}(t,r)}(t,0);return"symbol"==typeof e?e:""+e}function c(t){return"function"==typeof t}function p(t){let e=Object.getPrototypeOf(t);if("function"!=typeof t||t===r||e!==r)return e;let i=t.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return e;let s=n.constructor;return"function"!=typeof s||s===t?e:s}t("defineMetadata",function(t,e,i,r){var n,s;if(!u(i))throw TypeError();return n=t,s=e,void l(i,r,!0).set(n,s)}),t("hasMetadata",function(t,e,i){if(!u(e))throw TypeError();return o(i)||(i=d(i)),function t(e,i,r){if(a(e,i,r))return!0;let n=p(i);return null!==n&&t(e,n,r)}(t,e,i)}),t("hasOwnMetadata",function(t,e,i){if(!u(e))throw TypeError();return o(i)||(i=d(i)),a(t,e,i)}),t("getMetadata",function(t,e,i){if(!u(e))throw TypeError();return o(i)||(i=d(i)),function t(e,i,r){if(a(e,i,r)){var n=e,s=i,h=r;let t=l(s,h,!1);return o(t)?void 0:t.get(n)}let u=p(i);return null===u?void 0:t(e,u,r)}(t,e,i)})}(function(t,e){"function"!=typeof r[t]&&Object.defineProperty(r,t,{configurable:!0,writable:!0,value:e}),n&&n(t,e)}),r)},6057:function(t,e,i){"use strict";i.d(e,{Ci:()=>s,P:()=>a,Pv:()=>h,hN:()=>u});var r=i(41457);function n(t,e){let i=0,n=t.length;for(let s=0;s<n;s++){let l=t[s],a=e[s],o=t[(s+1)%n],h=e[(s+1)%n];i+=r.HL.distanceNN(l,a,o,h)}return i/2}function s(t,e,i,r,s){return n([t.x,e.x,i.x,r.x],[t.y,e.y,i.y,r.y])}function l(t,e,i,r,n){let s=1-n;return s*s*s*t+3*e*n*s*s+3*i*n*n*s+r*n*n*n}function a(t,e,i,n,s){let a=l(t.x,e.x,i.x,n.x,s),o=l(t.y,e.y,i.y,n.y,s);return new r.E9(a,o)}function o(t,e,i,r){let n=1-r;return n*n*t+2*n*r*e+r*r*i}function h(t,e,i,n){let s=o(t.x,e.x,i.x,n),l=o(t.y,e.y,i.y,n);return new r.E9(s,l)}function u(t,e,i,r){return n([t.x,e.x,i.x],[t.y,e.y,i.y])}},43291:function(t,e,i){"use strict";i.d(e,{C:()=>s});var r=i(88504);let n=r.BZ-1e-8;class s{constructor(t){this.init(t)}init(t){this.bounds=t}arc(t,e,i,s,l,a){if(Math.abs(l-s)>n)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);let o,h,u,d,c=1/0,p=-1/0,g=1/0,f=-1/0;function m(t){u=i*Math.cos(t),d=i*Math.sin(t),u<c&&(c=u),u>p&&(p=u),d<g&&(g=d),d>f&&(f=d)}if(m(s),m(l),l!==s)if((s%=r.BZ)<0&&(s+=r.BZ),(l%=r.BZ)<0&&(l+=r.BZ),l<s&&(a=!a,o=s,s=l,l=o),a)for(l-=r.BZ,o=s-s%r.ou,h=0;h<4&&o>l;++h,o-=r.ou)m(o);else for(o=s-s%r.ou+r.ou,h=0;h<4&&o<l;++h,o+=r.ou)m(o);this.bounds.add(t+c,e+g),this.bounds.add(t+p,e+f)}arcTo(t,e,i,r,n){this.bounds.add(t,e)}bezierCurveTo(t,e,i,r,n,s){this.bounds.add(t,e),this.bounds.add(i,r),this.bounds.add(n,s)}closePath(){}ellipse(){throw Error("不支持ellipse")}lineTo(t,e){this.bounds.add(t,e)}moveTo(t,e){this.bounds.add(t,e)}quadraticCurveTo(t,e,i,r){this.bounds.add(t,e),this.bounds.add(i,r)}rect(t,e,i,r){this.bounds.add(t,e),this.bounds.add(t+i,e+r)}clear(){this.bounds.clear()}release(...t){}}},21823:function(t,e,i){"use strict";i.d(e,{D:()=>s,L:()=>l});var r=i(31535),n=i(74984);function s(t,e,i){let r=e,{a:n,b:s,c:l,d:a}=t.currentMatrix,o=Math.sign(n)*Math.sqrt(n*n+s*s),h=Math.sign(a)*Math.sqrt(l*l+a*a);return o+h===0?0:r=r/Math.abs(o+h)*2*i}function l(t,e,i,s=0,a=0){var o,h,u,d;let c,p;if(!e||!0===e)return"black";if((0,r.Z)(e))for(let t=0;t<e.length&&!(p=e[t]);t++);else p=e;if("string"==typeof(p=n.a.Parse(p)))return p;if(i.AABBBounds&&(!i.attribute||0!==i.attribute.scaleX||0!==i.attribute.scaleY)){let e=i.AABBBounds,r=e.x2-e.x1,n=e.y2-e.y1,l=e.x1-s,g=e.y1-a;if(i.attribute){let{scaleX:t=1,scaleY:e=1,angle:s=0}=i.attribute;r/=t,n/=e,l/=t,g/=e,(s||1!==t||1!==e)&&(l=null!=(o=i.x1WithoutTransform)?o:0,g=null!=(h=i.y1WithoutTransform)?h:0,r=null!=(u=i.widthWithoutTransform)?u:r,n=null!=(d=i.heightWithoutTransform)?d:n)}"linear"===p.gradient?c=function(t,e,i,r,n,s){var l,a,o,h;let u=t.createLinearGradient(i+(null!=(l=e.x0)?l:0)*n,r+(null!=(a=e.y0)?a:0)*s,i+(null!=(o=e.x1)?o:1)*n,r+(null!=(h=e.y1)?h:0)*s);return e.stops.forEach(t=>{u.addColorStop(t.offset,t.color)}),u}(t,p,l,g,r,n):"conical"===p.gradient?c=function(t,e,i,r,n,s){var l,a;let o=t.createConicGradient(i+(null!=(l=e.x)?l:0)*n,r+(null!=(a=e.y)?a:0)*s,e.startAngle,e.endAngle);return e.stops.forEach(t=>{o.addColorStop(t.offset,t.color)}),o.GetPattern?o.GetPattern(n+i,s+r,void 0):o}(t,p,l,g,r,n):"radial"===p.gradient&&(c=function(t,e,i,r,n,s){var l,a,o,h,u,d;let c=t.createRadialGradient(i+(null!=(l=e.x0)?l:.5)*n,r+(null!=(a=e.y0)?a:.5)*s,Math.max(n,s)*(null!=(o=e.r0)?o:0),i+(null!=(h=e.x1)?h:.5)*n,r+(null!=(u=e.y1)?u:.5)*s,Math.max(n,s)*(null!=(d=e.r1)?d:.5));return e.stops.forEach(t=>{c.addColorStop(t.offset,t.color)}),c}(t,p,l,g,r,n))}return c||"orange"}},74984:function(t,e,i){"use strict";i.d(e,{a:()=>s});var r=i(88504);let n=function(){let t={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i},e="";function i(t){let i=Error(e+": "+t);throw i.source=e,i}function r(){return n("linear",t.linearGradient,s)||n("radial",t.radialGradient,a)||n("conic",t.conicGradient,l)}function n(e,r,n){let s=y(r);if(s){y(t.startCall)||i("Missing (");let r=function(r){let s=n();return s&&(y(t.comma)||i("Missing comma before color stops")),{type:e,orientation:s,colorStops:c(p)}}(0);return y(t.endCall)||i("Missing )"),r}}function s(){return m("directional",t.sideOrCorner,1)||m("angular",t.angleValue,1)}function l(){return m("angular",t.fromAngleValue,1)}function a(){let i,r,n=o();return n&&((i=[]).push(n),r=e,y(t.comma)&&((n=o())?i.push(n):e=r)),i}function o(){let t=function(){let t=m("shape",/^(circle)/i,0);return t&&(t.style=f()||h()),t}()||function(){let t=m("shape",/^(ellipse)/i,0);return t&&(t.style=g()||h()),t}();if(t)t.at=u();else{let e=h();if(e){t=e;let i=u();i&&(t.at=i)}else{let e=d();e&&(t={type:"default-radial",at:e})}}return t}function h(){return m("extent-keyword",t.extentKeywords,1)}function u(){if(m("position",/^at/,0)){let t=d();return t||i("Missing positioning value"),t}}function d(){let t={x:g(),y:g()};if(t.x||t.y)return{type:"position",value:t}}function c(e){let r=e(),n=[];if(r)for(n.push(r);y(t.comma);)(r=e())?n.push(r):i("One extra comma");return n}function p(){let e=m("hex",t.hexColor,1)||m("rgba",t.rgbaColor,1)||m("rgb",t.rgbColor,1)||m("literal",t.literalColor,0);return e||i("Expected color definition"),e.length=g(),e}function g(){return m("%",t.percentageValue,1)||m("position-keyword",t.positionKeywords,1)||f()}function f(){return m("px",t.pixelValue,1)||m("em",t.emValue,1)}function m(t,e,i){let r=y(e);if(r)return{type:t,value:r[i]}}function y(t){let i=/^[\n\r\t\s]+/.exec(e);i&&v(i[0].length);let r=t.exec(e);return r&&v(r[0].length),r}function v(t){e=e.substr(t)}return function(t){return e=t.toString(),function(){let t=c(r);return e.length>0&&i("Invalid input not EOF"),t}()}}();class s{static IsGradient(t){return!("string"==typeof t&&!t.includes("gradient"))}static IsGradientStr(t){return"string"==typeof t&&t.includes("gradient")}static Parse(t){if(s.IsGradientStr(t))try{let e=n(t)[0];if(e){if("linear"===e.type)return s.ParseLinear(e);if("radial"===e.type)return s.ParseRadial(e);if("conic"===e.type)return s.ParseConic(e)}}catch(t){}return t}static processColorStops(t){if(!t||0===t.length)return[];if(t.some(t=>t.length)){let e=t.map(t=>({color:t.value,offset:t.length?parseFloat(t.length.value)/100:-1}));e[0].offset<0&&(e[0].offset=0),e[e.length-1].offset<0&&(e[e.length-1].offset=1);for(let t=1;t<e.length-1;t++)if(e[t].offset<0){let i=t-1,r=t+1;for(;r<e.length&&e[r].offset<0;)r++;let n=e[i].offset,s=e[r].offset,l=r-i;for(let t=1;t<l;t++)e[i+t].offset=n+(s-n)*t/l;t=r-1}return e}return t.map((e,i)=>{let r=t.length>1?i/(t.length-1):0;return{color:e.value,offset:r}})}static ParseConic(t){let{orientation:e,colorStops:i=[]}=t,n=r.pi/2,l=parseFloat(e.value)/180*r.pi-n;return{gradient:"conical",x:.5,y:.5,startAngle:l,endAngle:l+r.f7,stops:s.processColorStops(i)}}static ParseRadial(t){let{colorStops:e=[]}=t;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:s.processColorStops(e)}}static ParseLinear(t){let{orientation:e,colorStops:i=[]}=t,n=r.pi/2,l="angular"===e.type?parseFloat(e.value)/180*r.pi:0;for(;l<0;)l+=r.f7;for(;l>=r.f7;)l-=r.f7;let a=0,o=0,h=0,u=0;return l<n?(a=0,o=1,h=Math.sin(l),u=o-Math.cos(l)):l<r.pi?(a=0,o=0,h=Math.cos(l-n),u=Math.sin(l-n)):l<r.pi+n?(o=0,h=(a=1)-Math.sin(l-r.pi),u=Math.cos(l-r.pi)):(h=(a=1)-Math.cos(l-n-r.pi),u-=Math.sin(l-n-r.pi)),{gradient:"linear",x0:a,y0:o,x1:h,y1:u,stops:s.processColorStops(i)}}}},58233:function(t,e,i){"use strict";i.d(e,{EM:()=>l,Qc:()=>r,yb:()=>s});let r=Symbol("ContributionProvider");class n{constructor(t,e){this.serviceIdentifier=t,this.container=e,a.setStore(this.serviceIdentifier,this)}getContributions(){return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier))),this.caches}refresh(){this.caches&&(this.caches.length=0,this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier)))}}function s(t,e){t(r).toDynamicValue(({container:t})=>new n(e,t)).inSingletonScope().whenTargetNamed(e)}function l(t,e){t(r).toDynamicValue(({container:t})=>new n(e,t)).whenTargetNamed(e)}class a{static getStore(t){return this.store.get(t)}static setStore(t,e){this.store.set(t,e)}static refreshAllContributions(){this.store.forEach(t=>{t.refresh()})}}a.store=new Map},33974:function(t,e,i){"use strict";i.d(e,{r:()=>x});var r=i(43291),n=i(76620);class s{constructor(){this._curves=[],this.bounds=new n.FB}get curves(){return this._curves}getCurveLengths(){return this._curves.map(t=>t.getLength())}getPointAt(t){return{x:0,y:0}}getLength(){return 0}getBounds(){return this.bounds}}var l=i(13105),a=i(88504),o=i(17209),h=i(98706);function u(t,e,i,r){let n=function(t,e,i,r,n,s,l,o,u){let d=(0,h.M4)(l),c=Math.sin(d),p=Math.cos(d),g=p*(o-t)*.5+c*(u-e)*.5,f=p*(u-e)*.5-c*(o-t)*.5,m=g*g/((i=Math.abs(i))*i)+f*f/((r=Math.abs(r))*r);m>1&&(i*=m=Math.sqrt(m),r*=m);let y=p/i,v=c/i,b=-c/r,_=p/r,x=y*o+v*u,C=b*o+_*u,w=y*t+v*e,S=b*t+_*e,A=1/((w-x)*(w-x)+(S-C)*(S-C))-.25;A<0&&(A=0);let M=Math.sqrt(A);s===n&&(M=-M);let k=.5*(x+w)-M*(S-C),T=.5*(C+S)+M*(w-x),R=Math.atan2(C-T,x-k),B=Math.atan2(S-T,w-k)-R;B<0&&1===s?B+=a.BZ:B>0&&0===s&&(B-=a.BZ);let P=Math.ceil(Math.abs(B/(a.ou+.001))),E=[];for(let t=0;t<P;++t){let e=R+t*B/P,n=R+(t+1)*B/P;E[t]=[k,T,e,n,i,r,c,p]}return E}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,i);for(let e=0;e<n.length;++e){let i=function(t){let e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],l=t[5],a=t[6],o=t[7],h=o*s,u=-a*l,d=a*s,c=o*l,p=Math.cos(r),g=Math.sin(r),f=Math.cos(n),m=Math.sin(n),y=.5*(n-r),v=Math.sin(.5*y),b=8/3*v*v/Math.sin(y),_=e+p-b*g,x=i+g+b*p,C=e+f,w=i+m,S=C+b*m,A=w-b*f;return[h*_+u*x,d*_+c*x,h*S+u*A,d*S+c*A,h*C+u*w,d*C+c*w]}(n[e]);t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5])}}let d=(t,e,i,r,n,s,l,a=!1)=>{let o=2*Math.PI,h=(e%o+o)%o,u,d=(i%o+o)%o;a?d>=h&&(d-=o):d<=h&&(d+=o);let c=Math.ceil(Math.abs(u=d-h)/(.5*Math.PI)),p=u/c;for(let e=0;e<c;e++){let i=h+p*e,o=h+p*(e+1),u=4/3*Math.tan(Math.abs(p)/4),d=Math.cos(i),c=Math.sin(i),g=Math.cos(o),f=Math.sin(o),m=d*s+r,y=c*l+n,v=g*s+r,b=f*l+n,_=a?-1:1,x=s*u*_,C=l*u*_;t.push(m-x*c,y+C*d,v+x*f,b-C*g,v,b)}};var c=i(23603),p=i(41457),g=i(73602),f=i(76989),m=i(6057),y=i(20818);class v extends y.H{constructor(t,e,i){super(),this.type=o.D5.QuadraticBezierCurve,this.p0=t,this.p1=e,this.p2=i}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y)}getPointAt(t){if(!1!==this.defined)return(0,m.Pv)(this.p0,this.p1,this.p2,t);throw Error("defined为false的点不能getPointAt")}calcLength(){return this._validPoint()?(0,m.hN)(this.p0,this.p1,this.p2,0):60}calcProjLength(t){return t===o.Nm.ROW?(0,a.Wn)(this.p0.x-this.p2.x):t===o.Nm.COLUMN?(0,a.Wn)(this.p0.y-this.p2.y):0}getAngleAt(t){let e=(0,a.Fp)(t-.01,0),i=(0,a.VV)(t+.01,1),r=this.getPointAt(e),n=this.getPointAt(i);return(0,a.fv)(n.y-r.y,n.x-r.x)}draw(t,e,i,r,n,s){if(t.moveTo(this.p0.x*r+e,this.p0.y*n+i),s>=1)t.quadraticCurveTo(this.p1.x*r+e,this.p1.y*n+i,this.p2.x*r+e,this.p2.y*n+i);else if(s>0){let[l]=function(t,e){let{p0:i,p1:r,p2:n}=t,s=(0,m.Pv)(i,r,n,e),l=p.HL.pointAtPP(i,r,e),a=p.HL.pointAtPP(r,n,e);return[new v(i,l,s),new v(s,a,n)]}(this,s);t.quadraticCurveTo(l.p1.x*r+e,l.p1.y*n+i,l.p2.x*r+e,l.p2.y*n+i)}}getYAt(t){throw Error("QuadraticBezierCurve暂不支持getYAt")}includeX(t){throw Error("QuadraticBezierCurve暂不支持includeX")}}class b{constructor(t){this.path=t,this._lastX=this._lastY=this._startX=this._startY=0}moveTo(t,e){return this._lastX=this._startX=t,this._lastY=this._startY=e,this}lineTo(t,e){let i=this.addLinearCurve(t,e);this.path.addCurve(i),this._lastX=t,this._lastY=e}addLinearCurve(t,e){return new g.g(new p.E9(this._lastX,this._lastY),new p.E9(t,e))}quadraticCurveTo(t,e,i,r){let n=new v(new p.E9(this._lastX,this._lastY),new p.E9(t,e),new p.E9(i,r));this.path.addCurve(n),this._lastX=i,this._lastY=r}bezierCurveTo(t,e,i,r,n,s){let l=new f.A(new p.E9(this._lastX,this._lastY),new p.E9(t,e),new p.E9(i,r),new p.E9(n,s));this.path.addCurve(l),this._lastX=n,this._lastY=s}arcTo(t,e,i,r,n){throw Error("CurveContext不支持调用arcTo")}ellipse(t,e,i,r,n,s,l,a){throw Error("CurveContext不支持调用ellipse")}rect(t,e,i,r){throw Error("CurveContext不支持调用rect")}arc(t,e,i,r,n,s){throw Error("CurveContext不支持调用arc")}closePath(){this.path.curves.length<2||this.lineTo(this._startX,this._startY)}}var _=i(51402);class x extends s{constructor(t){super(),this.commandList=[],t&&(this._ctx=t),this._boundsContext=new r.C(this.bounds)}get curves(){return this.tryBuildCurves()}setCtx(t){this._ctx=t}moveTo(t,e){return this.commandList.push([l.m.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}lineTo(t,e){return this.commandList.push([l.m.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}quadraticCurveTo(t,e,i,r){return this.commandList.push([l.m.Q,t,e,i,r]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,r),this}bezierCurveTo(t,e,i,r,n,s){return this.commandList.push([l.m.C,t,e,i,r,n,s]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,r,n,s),this}arcTo(t,e,i,r,n){return this.commandList.push([l.m.AT,t,e,i,r,n]),this._ctx&&this._ctx.arcTo(t,e,i,r,n),this}ellipse(t,e,i,r,n,s,a,o){return this.commandList.push([l.m.E,t,e,i,r,n,s,a,o]),this._ctx&&this._ctx.ellipse(t,e,i,r,n,s,a,o),this}rect(t,e,i,r){return this.commandList.push([l.m.R,t,e,i,r]),this._ctx&&this._ctx.rect(t,e,i,r),this}arc(t,e,i,r,n,s){return this.commandList.push([l.m.A,t,e,i,r,n,s]),this._ctx&&this._ctx.arc(t,e,i,r,n,s),this}closePath(){return this.commandList.push([l.m.Z]),this._ctx&&this._ctx.closePath(),this}addCurve(t){this._curves.push(t)}clear(){this.transformCbList=null,this.commandList.length=0,this._curves.length=0}beginPath(){this.clear()}tryBuildCurves(){if(!this._curves||!this._curves.length){let t=new b(this);(0,c.h)(this.commandList,t,0,0,1,1)}return this._curves}toString(){if(!this.toStringCbList){let t=[];t[l.m.M]=t=>`M${t[1]} ${t[2]}`,t[l.m.L]=t=>`L${t[1]} ${t[2]}`,t[l.m.Q]=t=>`Q${t[1]} ${t[2]} ${t[3]} ${t[4]}`,t[l.m.C]=t=>`C${t[1]} ${t[2]} ${t[3]} ${t[4]} ${t[5]} ${t[6]}`,t[l.m.A]=t=>{let e=[],i=t[1],r=t[2],n=t[3],s=t[4];d(e,s,t[5],i,r,n,n,t[6]);let l="";for(let t=0;t<e.length;t+=6)l+=`C${e[t]} ${e[t+1]} ${e[t+2]} ${e[t+3]} ${e[t+4]} ${e[t+5]}`;return l},t[l.m.R]=t=>`M${t[1]} ${t[2]} h${t[3]} v${t[4]} H${t[1]}Z`,t[l.m.Z]=t=>"Z",this.toStringCbList=t}let t=this.toStringCbList,e="";return this.commandList.forEach(i=>{e+=t[i[0]](i)}),e}fromString(t,e,i,r,n){this.clear();let s=(0,l.U)(t);return this._runCommandStrList(s,e,i,r,n),this._updateBounds(),this}fromLine(t){let{points:e,curveType:i,clipRangeByDimension:r}=t.attribute;if(!e)return;let n=(0,_.X0)(e,i);"x"===r?this.direction=o.Nm.ROW:"y"===r?this.direction=o.Nm.COLUMN:"auto"===r&&(this.direction=n.direction),this._curves=n.curves}fromCustomPath2D(t,e,i,r,n){return this.clear(),this._runCommandList(t.commandList,e,i,r,n),this._updateBounds(),this}transform(t,e,i,r){let n=this.commandList;if(!this.transformCbList){let t=[];t[l.m.M]=this.moveToTransform,t[l.m.L]=this.lineToTransform,t[l.m.Q]=this.quadraticCurveToTransform,t[l.m.C]=this.bezierCurveToTransform,t[l.m.AT]=this.arcToTransform,t[l.m.E]=this.ellipseTransform,t[l.m.R]=this.rectTransform,t[l.m.A]=this.arcTransform,t[l.m.Z]=this.closePathTransform,this.transformCbList=t}n.forEach(n=>{this.transformCbList[n[0]](n,t,e,i,r)}),this._updateBounds()}moveToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i}lineToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i}quadraticCurveToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r+e,t[4]=t[4]*n+i}bezierCurveToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r+e,t[4]=t[4]*n+i,t[5]=t[5]*r+e,t[6]=t[6]*n+i}arcToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r+e,t[4]=t[4]*n+i,t[5]=t[5]*(r+n)/2}ellipseTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r,t[4]=t[4]*n}rectTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r,t[4]=t[4]*n}arcTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*(r+n)/2}closePathTransform(){}_runCommandStrList(t,e=0,i=0,r=1,n=1){let s,l,a,o,h,d=null,c=0,p=0,g=0,f=0;for(let m=0,y=t.length;m<y;++m){switch(s=t[m],1===r&&1===n||(s=function(t,e,i){let r=C[0]=t[0];if("a"===r||"A"===r)C[1]=e*t[1],C[2]=i*t[2],C[3]=t[3],C[4]=t[4],C[5]=t[5],C[6]=e*t[6],C[7]=i*t[7];else if("h"===r||"H"===r)C[1]=e*t[1];else if("v"===r||"V"===r)C[1]=i*t[1];else for(let r=1,n=t.length;r<n;++r)C[r]=(r%2==1?e:i)*t[r];return C}(s,r,n)),s[0]){case"l":c+=s[1],p+=s[2],this.lineTo(c+e,p+i);break;case"L":c=s[1],p=s[2],this.lineTo(c+e,p+i);break;case"h":c+=s[1],this.lineTo(c+e,p+i);break;case"H":c=s[1],this.lineTo(c+e,p+i);break;case"v":p+=s[1],this.lineTo(c+e,p+i);break;case"V":p=s[1],this.lineTo(c+e,p+i);break;case"m":c+=s[1],p+=s[2],this.moveTo(c+e,p+i);break;case"M":c=s[1],p=s[2],this.moveTo(c+e,p+i);break;case"c":l=c+s[5],a=p+s[6],g=c+s[3],f=p+s[4],this.bezierCurveTo(c+s[1]+e,p+s[2]+i,g+e,f+i,l+e,a+i),c=l,p=a;break;case"C":c=s[5],p=s[6],g=s[3],f=s[4],this.bezierCurveTo(s[1]+e,s[2]+i,g+e,f+i,c+e,p+i);break;case"s":l=c+s[3],a=p+s[4],null===d[0].match(/[CcSs]/)?(g=c,f=p):(g=2*c-g,f=2*p-f),o=c+s[1],h=p+s[2],this.bezierCurveTo(g+e,f+i,o+e,h+i,l+e,a+i),g=o,f=h,c=l,p=a;break;case"S":l=s[3],a=s[4],null===d[0].match(/[CcSs]/)?(g=c,f=p):(g=2*c-g,f=2*p-f),o=s[1],h=s[2],this.bezierCurveTo(g+e,f+i,o+e,h+i,l+e,a+i),g=o,f=h,c=l,p=a;break;case"q":l=c+s[3],a=p+s[4],g=c+s[1],f=p+s[2],this.quadraticCurveTo(g+e,f+i,l+e,a+i),c=l,p=a;break;case"Q":l=s[3],a=s[4],this.quadraticCurveTo(s[1]+e,s[2]+i,l+e,a+i),c=l,p=a,g=s[1],f=s[2];break;case"t":l=c+s[1],a=p+s[2],null===d[0].match(/[QqTt]/)?(g=c,f=p):"t"===d[0]?(g=2*c-o,f=2*p-h):"q"===d[0]&&(g=2*c-g,f=2*p-f),o=g,h=f,this.quadraticCurveTo(g+e,f+i,l+e,a+i),c=l,p=a,g=c+s[1],f=p+s[2];break;case"T":l=s[1],a=s[2],g=2*c-g,f=2*p-f,this.quadraticCurveTo(g+e,f+i,l+e,a+i),c=l,p=a;break;case"a":u(this,c+e,p+i,[s[1],s[2],s[3],s[4],s[5],s[6]+c+e,s[7]+p+i]),c+=s[6],p+=s[7];break;case"A":u(this,c+e,p+i,[s[1],s[2],s[3],s[4],s[5],s[6]+e,s[7]+i]),c=s[6],p=s[7];break;case"z":case"Z":this.closePath()}d=s}}_runCommandList(t,e=0,i=0,r=1,n=1){if(0!==e||0!==i||1!==r||1!==n)for(let s=0,a=t.length;s<a;++s){let a=t[s].slice();switch(a[0]){case l.m.L:this.lineToTransform(a,e,i,r,n);break;case l.m.M:this.moveToTransform(a,e,i,r,n);break;case l.m.C:this.bezierCurveToTransform(a,e,i,r,n);break;case l.m.Q:this.quadraticCurveToTransform(a,e,i,r,n);break;case l.m.A:this.arcToTransform(a,e,i,r,n);break;case l.m.E:this.ellipseTransform(a,e,i,r,n);break;case l.m.R:this.rectTransform(a,e,i,r,n);break;case l.m.AT:this.arcToTransform(a,e,i,r,n);break;case l.m.Z:this.closePath()}}else this.commandList=t.map(t=>t.slice())}_updateBounds(){this.bounds.clear(),(0,c.h)(this.commandList,this._boundsContext)}release(){this.commandList=[],this._boundsContext=null,this._ctx=null}getLength(){if(this.direction===o.Nm.COLUMN){if(!this._curves.length)return 0;let t=this._curves[0],e=this._curves[this._curves.length-1];return(0,a.Wn)(t.p0.y-e.p1.y)}if(this.direction===o.Nm.ROW){if(!this._curves.length)return 0;let t=this._curves[0],e=this._curves[this._curves.length-1];return(0,a.Wn)(t.p0.x-e.p1.x)}return this._curves.reduce((t,e)=>t+e.getLength(),0)}getYAt(t){if(!this.curves)return 1/0;for(let e=0;e<this.curves.length;e++){let i=this.curves[e];if(i.includeX(t))return i.getYAt(t)}return 1/0}getAttrAt(t){if(!this._curves)return{pos:{x:0,y:0},angle:0};let e,i=0;for(let r=0;r<this._curves.length;r++){let n=(e=this._curves[r]).getLength(this.direction);if(i+n>=t)break;i+=n}let r=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(r),angle:e.getAngleAt(r)}}drawWithClipRange(t,e,i,r,n){this.tryBuildCurves();let s=this.getLength()*n,l=0;for(let n=0;n<this._curves.length;n++){let a=this._curves[n],o=a.getLength(this.direction);if(!(l+o<=s)){let n=1-(l+o-s)/o;a.draw(t,i,r,e,e,n);break}a.draw(t,i,r,e,e,1),l+=o}}}let C=["l",0,0,0,0,0,0,0]},17209:function(t,e,i){"use strict";var r,n,s,l,a,o,h,u,d,c,p,g;i.d(e,{D5:()=>a,Gk:()=>s,Gz:()=>r,LZ:()=>n,Nm:()=>l,Oh:()=>o}),(h=r||(r={}))[h.NONE=0]="NONE",h[h.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",h[h.UPDATE_SHAPE=2]="UPDATE_SHAPE",h[h.CLEAR_SHAPE=253]="CLEAR_SHAPE",h[h.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",h[h.INIT=179]="INIT",h[h.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",h[h.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",h[h.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",h[h.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",h[h.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",h[h.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",h[h.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",h[h.CLEAR_LAYOUT=127]="CLEAR_LAYOUT",(u=n||(n={}))[u.GLOBAL=1]="GLOBAL",u[u.LOCAL=16]="LOCAL",u[u.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",u[u.LOCAL_ACCURATE=48]="LOCAL_ACCURATE",(d=s||(s={}))[d.INIT=0]="INIT",d[d.DEFAULT=1]="DEFAULT",d[d.STATE=2]="STATE",d[d.ANIMATE_BIND=10]="ANIMATE_BIND",d[d.ANIMATE_PLAY=11]="ANIMATE_PLAY",d[d.ANIMATE_START=12]="ANIMATE_START",d[d.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",d[d.ANIMATE_END=14]="ANIMATE_END",d[d.TRANSLATE=20]="TRANSLATE",d[d.TRANSLATE_TO=21]="TRANSLATE_TO",d[d.SCALE=22]="SCALE",d[d.SCALE_TO=23]="SCALE_TO",d[d.ROTATE=24]="ROTATE",d[d.ROTATE_TO=25]="ROTATE_TO",(c=l||(l={}))[c.ROW=1]="ROW",c[c.COLUMN=2]="COLUMN",(p=a||(a={}))[p.CubicBezierCurve=0]="CubicBezierCurve",p[p.QuadraticBezierCurve=1]="QuadraticBezierCurve",p[p.ArcCurve=2]="ArcCurve",p[p.LineCurve=3]="LineCurve",p[p.EllipseCurve=4]="EllipseCurve",p[p.MoveCurve=5]="MoveCurve",(g=o||(o={}))[g.beforeFillStroke=0]="beforeFillStroke",g[g.afterFillStroke=1]="afterFillStroke"},99072:function(t,e,i){"use strict";i.d(e,{w:()=>r});class r{constructor(){this._listenerMap=new Map,this._eventListenerTransformer=t=>t}setEventListenerTransformer(t){this._eventListenerTransformer=t||(t=>t)}addEventListener(t,e,i){if(!e)return;let r=t=>{let i=this._eventListenerTransformer(t);"function"==typeof e?e(i):e.handleEvent&&e.handleEvent(i)};this._listenerMap.has(t)||this._listenerMap.set(t,new Map),this._listenerMap.get(t).set(e,r),this._nativeAddEventListener(t,r,i)}removeEventListener(t,e,i){var r;if(!e)return;let n=null==(r=this._listenerMap.get(t))?void 0:r.get(e);n&&(this._nativeRemoveEventListener(t,n,i),this._listenerMap.get(t).delete(e),0===this._listenerMap.get(t).size&&this._listenerMap.delete(t))}dispatchEvent(t){return this._nativeDispatchEvent(t)}clearAllEventListeners(){this._listenerMap.forEach((t,e)=>{t.forEach((t,i)=>{this._nativeRemoveEventListener(e,t,void 0)})}),this._listenerMap.clear()}_nativeAddEventListener(t,e,i){throw Error("_nativeAddEventListener must be implemented by derived classes")}_nativeRemoveEventListener(t,e,i){throw Error("_nativeRemoveEventListener must be implemented by derived classes")}_nativeDispatchEvent(t){throw Error("_nativeDispatchEvent must be implemented by derived classes")}}},40398:function(t,e,i){"use strict";i.d(e,{R:()=>r});class r{static GenAutoIncrementId(){return r.auto_increment_id++}}r.auto_increment_id=0},47061:function(t,e,i){"use strict";i.d(e,{f:()=>n});var r=i(47293);let n=(0,i(70587).v)(r.B8)},70587:function(t,e,i){"use strict";i.d(e,{f:()=>l,v:()=>a});var r=i(12486),n=i(47293),s=i(58866);function l(t){return(e,i,r)=>{var l,a;let o,h;l=n.LD,a=r.toString(),o={},s.Z.hasOwnMetadata(l,e)&&(o=s.Z.getMetadata(l,e)),void 0===(h=o[a])&&(h=[]),h.push(t),o[a]=h,s.Z.defineMetadata(l,o,e)}}function a(t){return e=>(i,n,s)=>l(new r.S(t,e))(i,n,s)}},26004:function(t,e,i){"use strict";i.d(e,{b:()=>s});var r=i(47293),n=i(58866);function s(){return function(t){return n.Z.defineMetadata(r.FL,null,t),t}}},6146:function(t,e,i){"use strict";i.d(e,{t:()=>l});var r=i(12486),n=i(47293),s=i(70587);function l(t){return(0,s.f)(new r.S(n.vO,t))}},99262:function(t,e,i){"use strict";i.d(e,{n:()=>n});var r=i(40398);class n{constructor(t){this.id=r.R.GenAutoIncrementId(),this.registry=t}}},12486:function(t,e,i){"use strict";i.d(e,{S:()=>n});var r=i(47293);class n{constructor(t,e){this.key=t,this.value=e}toString(){return this.key===r.vO?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}},47293:function(t,e,i){"use strict";i.d(e,{B8:()=>n,FL:()=>a,LD:()=>l,Lc:()=>s,vO:()=>r});let r="named",n="inject",s="multi_inject",l="inversify:tagged",a="inversify:paramtypes"},4484:function(t,e,i){"use strict";function r(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function n(t,e,i){let r=Math.sin(i),n=Math.cos(i),s=e[4],l=e[5],a=e[6],o=e[7],h=e[8],u=e[9],d=e[10],c=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*n+h*r,t[5]=l*n+u*r,t[6]=a*n+d*r,t[7]=o*n+c*r,t[8]=h*n-s*r,t[9]=u*n-l*r,t[10]=d*n-a*r,t[11]=c*n-o*r,t}function s(t,e,i){let r=Math.sin(i),n=Math.cos(i),s=e[0],l=e[1],a=e[2],o=e[3],h=e[8],u=e[9],d=e[10],c=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n-h*r,t[1]=l*n-u*r,t[2]=a*n-d*r,t[3]=o*n-c*r,t[8]=s*r+h*n,t[9]=l*r+u*n,t[10]=a*r+d*n,t[11]=o*r+c*n,t}function l(t,e,i){let r=Math.sin(i),n=Math.cos(i),s=e[0],l=e[1],a=e[2],o=e[3],h=e[4],u=e[5],d=e[6],c=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n+h*r,t[1]=l*n+u*r,t[2]=a*n+d*r,t[3]=o*n+c*r,t[4]=h*n-s*r,t[5]=u*n-l*r,t[6]=d*n-a*r,t[7]=c*n-o*r,t}function a(t,e,i){let r,n,s,l,a,o,h,u,d,c,p,g,f=i[0],m=i[1],y=i[2];return e===t?(t[12]=e[0]*f+e[4]*m+e[8]*y+e[12],t[13]=e[1]*f+e[5]*m+e[9]*y+e[13],t[14]=e[2]*f+e[6]*m+e[10]*y+e[14],t[15]=e[3]*f+e[7]*m+e[11]*y+e[15]):(r=e[0],n=e[1],s=e[2],l=e[3],a=e[4],o=e[5],h=e[6],u=e[7],d=e[8],c=e[9],p=e[10],g=e[11],t[0]=r,t[1]=n,t[2]=s,t[3]=l,t[4]=a,t[5]=o,t[6]=h,t[7]=u,t[8]=d,t[9]=c,t[10]=p,t[11]=g,t[12]=r*f+a*m+d*y+e[12],t[13]=n*f+o*m+c*y+e[13],t[14]=s*f+h*m+p*y+e[14],t[15]=l*f+u*m+g*y+e[15]),t}function o(t,e){t[0]=e.a,t[1]=e.b,t[2]=0,t[3]=0,t[4]=e.c,t[5]=e.d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e.e,t[13]=e.f,t[14]=0,t[15]=1}function h(t,e,i){let r=i[0],n=i[1],s=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function u(t,e,i){let r=e[0],n=e[1],s=e[2],l=e[3],a=e[4],o=e[5],h=e[6],u=e[7],d=e[8],c=e[9],p=e[10],g=e[11],f=e[12],m=e[13],y=e[14],v=e[15],b=i[0],_=i[1],x=i[2],C=i[3];return t[0]=b*r+_*a+x*d+C*f,t[1]=b*n+_*o+x*c+C*m,t[2]=b*s+_*h+x*p+C*y,t[3]=b*l+_*u+x*g+C*v,b=i[4],_=i[5],x=i[6],C=i[7],t[4]=b*r+_*a+x*d+C*f,t[5]=b*n+_*o+x*c+C*m,t[6]=b*s+_*h+x*p+C*y,t[7]=b*l+_*u+x*g+C*v,b=i[8],_=i[9],x=i[10],C=i[11],t[8]=b*r+_*a+x*d+C*f,t[9]=b*n+_*o+x*c+C*m,t[10]=b*s+_*h+x*p+C*y,t[11]=b*l+_*u+x*g+C*v,b=i[12],_=i[13],x=i[14],C=i[15],t[12]=b*r+_*a+x*d+C*f,t[13]=b*n+_*o+x*c+C*m,t[14]=b*s+_*h+x*p+C*y,t[15]=b*l+_*u+x*g+C*v,t}function d(t,e,i){let r=e[0],n=e[1],s=e[2],l=i[3]*r+i[7]*n+i[11]*s+i[15];return l=l||1,t[0]=(i[0]*r+i[4]*n+i[8]*s+i[12])/l,t[1]=(i[1]*r+i[5]*n+i[9]*s+i[13])/l,t[2]=(i[2]*r+i[6]*n+i[10]*s+i[14])/l,t}i.d(e,{B$:()=>o,G9:()=>u,Iu:()=>a,TL:()=>r,fF:()=>d,jI:()=>l,lM:()=>n,mN:()=>h,uD:()=>s})},13105:function(t,e,i){"use strict";let r,n,s,l,a;i.d(e,{U:()=>d,m:()=>u});let o=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,h={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},u={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};function d(t){let e,i;if(!t)return[];let u=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(null===u)return[];let d=[];for(let t=0,c=u.length;t<c;t++)if(n=(r=u[t]).slice(1),e=[s=r[0]],null!==(i=n.match(o))){for(let t=0,r=i.length;t<r;t++)Number.isNaN(l=parseFloat(i[t]))||e.push(l);if(a=h[s],e.length-1>a){let t,i=s;for(let r=1,n=e.length;r<n;r+=a){t=[i];for(let i=r,n=r+a;i<n;i++)t.push(e[i]);d.push(t),"m"===i?i="l":"M"===i&&(i="L")}}else d.push(e)}else d.push(e);return d}},42159:function(t,e,i){"use strict";i.d(e,{A:()=>s});var r=i(16049);let n=0;class s{constructor(){this.nextAnimationFrameCbs=new Map,this._rafHandle=null,this.runAnimationFrame=t=>{this._rafHandle=null;let e=this.nextAnimationFrameCbs;this.nextAnimationFrameCbs=new Map,e.forEach(e=>e(t))},this.tryRunAnimationFrameNextFrame=()=>{null===this._rafHandle&&0!==this.nextAnimationFrameCbs.size&&(this._rafHandle=r.w.global.getRequestAnimationFrame()(this.runAnimationFrame))}}addAnimationFrameCb(t){return this.nextAnimationFrameCbs.set(++n,t),this.tryRunAnimationFrameNextFrame(),n}removeAnimationFrameCb(t){return!!this.nextAnimationFrameCbs.has(t)&&(this.nextAnimationFrameCbs.delete(t),!0)}}},10546:function(t,e,i){"use strict";i.d(e,{p:()=>n});var r=i(35652);let n=t=>{if(!t)return{x:0,y:0,width:0,height:0};let e=(0,r.Z)(t.width)?t.x1-t.x:t.width,i=(0,r.Z)(t.height)?t.y1-t.y:t.height,n=0,s=0;return e<0?(n=e,e=-e):Number.isNaN(e)&&(e=0),i<0?(s=i,i=-i):Number.isNaN(i)&&(i=0),{x:n,y:s,width:e,height:i}}},23603:function(t,e,i){"use strict";i.d(e,{h:()=>n});let r=[(t,e,i,r,n,s,l)=>e.arc(t[1]*n+i,t[2]*s+r,t[3]*(n+s)/2,t[4],t[5],t[6],l),(t,e,i,r,n,s,l)=>e.arcTo(t[1]*n+i,t[2]*s+r,t[3]*n+i,t[4]*s+r,t[5]*(n+s)/2,l),(t,e,i,r,n,s,l)=>e.bezierCurveTo(t[1]*n+i,t[2]*s+r,t[3]*n+i,t[4]*s+r,t[5]*n+i,t[6]*s+r,l),(t,e,i,r)=>e.closePath(),(t,e,i,r,n,s)=>e.ellipse(t[1]*n+i,t[2]*s+r,t[3]*n,t[4]*s,t[5],t[6],t[7],t[8]),(t,e,i,r,n,s,l)=>e.lineTo(t[1]*n+i,t[2]*s+r,l),(t,e,i,r,n,s,l)=>e.moveTo(t[1]*n+i,t[2]*s+r,l),(t,e,i,r,n,s,l)=>e.quadraticCurveTo(t[1]*n+i,t[2]*s+r,t[3]*n+i,t[4]*s+r,l),(t,e,i,r,n,s,l)=>e.rect(t[1]*n+i,t[2]*s+r,t[3]*n,t[4]*s,l)];function n(t,e,i=0,s=0,l=1,a=1,o){for(let n=0;n<t.length;n++){let h=t[n];r[h[0]](h,e,i,s,l,a,o)}}},29863:function(t,e,i){"use strict";i.d(e,{V3:()=>o,fW:()=>a,hJ:()=>h});var r=i(88504),n=i(17209),s=i(12061);function l(t,e,i,r,n,s,l){var a;let o=e.p0,h=r;if(i&&i.originP1===i.originP2&&(o=i.p0),e.defined)r||(t.lineTo(o.x+n,o.y+s,l),h=!r);else{let u,{originP1:d,originP2:c}=e;if(d&&!1!==d.defined&&!i?u=o:d&&!1!==c.defined&&(u=null!=(a=e.p3)?a:e.p1),r){h=!r;let i=u?u.x:e.p0.x,a=u?u.y:e.p0.y;t.moveTo(i+n,a+s,l)}else u&&(h=!r,t.lineTo(u.x+n,u.y+s,l))}return h}function a(t,e,i,a,o){let h,{offsetX:u=0,offsetY:d=0,offsetZ:c=0,mode:p="none",drawConnect:g=!1}=o||{};if(g&&"none"===p||!e)return;let f=!0,{curves:m}=e;if(i>=1){if(g){let e,i=!0;m.forEach((r,n)=>{r.originP1!==r.originP2&&(i=l(t,r,e,i,u,d,c)),e=r})}else m.forEach(e=>{e.defined?(f&&t.moveTo(e.p0.x+u,e.p0.y+d,c),(0,s.w)(t,e,1,o),f=!1):f=!0});return}if(i<=0)return;"x"===a?h=n.Nm.ROW:"y"===a?h=n.Nm.COLUMN:"auto"===a&&(h=e.direction);let y=i*e.tryUpdateLength(h),v=0,b=!0,_=null;for(let e=0,i=m.length;e<i;e++){let i=m[e],n=i.getLength(h),a=(y-v)/n;if(v+=n,a<0)break;if(g){if(i.originP1===i.originP2){_=i;continue}b=l(t,i,_,b,u,d,c),_=i}else{if(!i.defined){f=!0;continue}f&&t.moveTo(i.p0.x+u,i.p0.y+d,c),(0,s.w)(t,i,(0,r.VV)(a,1),o),f=!1}}}function o(t,e,i,r){let{offsetX:n=0,offsetY:s=0}=r||{},l=e?e.points[e.points.length-1]:i.points[0];t.moveTo(l.x+n,l.y+s),i.points.forEach(e=>{!1!==e.defined?t.lineTo(e.x+n,e.y+s):t.moveTo(e.x+n,e.y+s)})}function h(t,e,i,r){let{offsetX:n=0,offsetY:s=0}=r||{},{points:l}=i,a=[],o=0;for(let t=0;t<l.length;t++)!1===l[t].defined&&(o+1!==t&&a.slice(o,t),o=t);a.push(l),a.forEach((i,r)=>{var l,a,o,h;let u=e&&0===r?e.points[e.points.length-1]:i[0];t.moveTo(u.x+n,u.y+s),i.forEach(e=>{!1!==e.defined?t.lineTo(e.x+n,e.y+s):t.moveTo(e.x+n,e.y+s)});for(let e=i.length-1;e>=0;e--){let r=i[e];t.lineTo(null!=(l=r.x1)?l:r.x,null!=(a=r.y1)?a:r.y)}t.lineTo(null!=(o=u.x1)?o:u.x,null!=(h=u.y1)?h:u.y),t.closePath()})}},12061:function(t,e,i){"use strict";i.d(e,{w:()=>n});var r=i(76989);function n(t,e,i,n){if(!e.p1)return;let{offsetX:s=0,offsetY:l=0,offsetZ:a=0}=n||{};if(1===i)e.p2&&e.p3?t.bezierCurveTo(s+e.p1.x,l+e.p1.y,s+e.p2.x,l+e.p2.y,s+e.p3.x,l+e.p3.y,a):t.lineTo(s+e.p1.x,l+e.p1.y,a);else if(e.p2&&e.p3){let[n]=(0,r.m)(e,i);t.bezierCurveTo(s+n.p1.x,l+n.p1.y,s+n.p2.x,l+n.p2.y,s+n.p3.x,l+n.p3.y,a)}else{let r=e.getPointAt(i);t.lineTo(s+r.x,l+r.y,a)}}},20818:function(t,e,i){"use strict";i.d(e,{H:()=>r});class r{getLength(t){return null!=t?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}},76989:function(t,e,i){"use strict";i.d(e,{A:()=>h,m:()=>o});var r=i(41457),n=i(88504),s=i(20818),l=i(17209),a=i(6057);function o(t,e){let{p0:i,p1:n,p2:s,p3:l}=t,o=(0,a.P)(i,n,s,l,e),u=r.HL.pointAtPP(i,n,e),d=r.HL.pointAtPP(n,s,e),c=r.HL.pointAtPP(s,l,e),p=r.HL.pointAtPP(u,d,e),g=r.HL.pointAtPP(d,c,e);return[new h(i,u,p,o),new h(o,g,c,l)]}class h extends s.H{constructor(t,e,i,r){super(),this.type=l.D5.CubicBezierCurve,this.p0=t,this.p1=e,this.p2=i,this.p3=r}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}getPointAt(t){if(!1!==this.defined)return(0,a.P)(this.p0,this.p1,this.p2,this.p3,t);throw Error("defined为false的点不能getPointAt")}calcLength(){return this._validPoint()?(0,a.Ci)(this.p0,this.p1,this.p2,this.p3,0):60}calcProjLength(t){return t===l.Nm.ROW?(0,n.Wn)(this.p0.x-this.p3.x):t===l.Nm.COLUMN?(0,n.Wn)(this.p0.y-this.p3.y):0}getAngleAt(t){let e=(0,n.Fp)(t-.01,0),i=(0,n.VV)(t+.01,1),r=this.getPointAt(e),s=this.getPointAt(i);return(0,n.fv)(s.y-r.y,s.x-r.x)}draw(t,e,i,r,n,s){if(t.moveTo(this.p0.x*r+e,this.p0.y*n+i),s>=1)t.bezierCurveTo(this.p1.x*r+e,this.p1.y*n+i,this.p2.x*r+e,this.p2.y*n+i,this.p3.x*r+e,this.p3.y*n+i);else if(s>0){let[l]=o(this,s);t.bezierCurveTo(l.p1.x*r+e,l.p1.y*n+i,l.p2.x*r+e,l.p2.y*n+i,l.p3.x*r+e,l.p3.y*n+i)}}includeX(t){let e=(0,n.VV)(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(0,n.Fp)(this.p0.x,this.p1.x,this.p2.x,this.p3.x);return t>=e&&t<=i}getYAt(t){let e=(0,n.VV)(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(t-e)/((0,n.Fp)(this.p0.x,this.p1.x,this.p2.x,this.p3.x)-e);return this.getPointAt(i).y}}},73602:function(t,e,i){"use strict";i.d(e,{d:()=>a,g:()=>o});var r=i(41457),n=i(88504),s=i(20818),l=i(17209);function a(t,e){let{p0:i,p1:n}=t,s=r.HL.pointAtPP(i,n,e);return[new o(i,s),new o(s,n)]}class o extends s.H{constructor(t,e){super(),this.type=l.D5.LineCurve,this.p0=t,this.p1=e}getPointAt(t){if(!1!==this.defined)return r.HL.pointAtPP(this.p0,this.p1,t);throw Error("defined为false的点不能getPointAt")}getAngleAt(t){return null==this.angle&&(this.angle=(0,n.fv)(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}calcLength(){return this._validPoint()?r.HL.distancePP(this.p0,this.p1):60}calcProjLength(t){return t===l.Nm.ROW?(0,n.Wn)(this.p0.x-this.p1.x):t===l.Nm.COLUMN?(0,n.Wn)(this.p0.y-this.p1.y):0}draw(t,e,i,r,n,s){if(t.moveTo(this.p0.x*r+e,this.p0.y*n+i),s>=1)t.lineTo(this.p1.x*r+e,this.p1.y*n+i);else if(s>0){let l=this.getPointAt(s);t.lineTo(l.x*r+e,l.y*n+i)}}includeX(t){return t>=this.p0.x&&t<=this.p1.x||t>=this.p1.x&&t<=this.p0.x}getYAt(t){if(this.includeX(t)){let e=this.p0,i=this.p1;this.p0.x>this.p1.x&&(e=this.p1,i=this.p0);let r=(t-e.x)/(i.x-e.x);return e.y+r*(i.y-e.y)}return 1/0}}},51402:function(t,e,i){"use strict";i.d(e,{X0:()=>R});var r=i(88504),n=i(41457),s=i(17209),l=i(76989),a=i(73602);class o{get endX(){return this._lastX}get endY(){return this._lastY}constructor(t,e){this.init(t,e)}init(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}bezierCurveTo(t,e,i,r,s,a,o,h){let u=new l.A(new n.E9(this._lastX,this._lastY),new n.E9(t,e),new n.E9(i,r),new n.E9(s,a));u.originP1=this._lastOriginP,u.originP2=h,u.defined=o,this.curves.push(u),this._lastX=s,this._lastY=a,this._lastOriginP=h}closePath(){if(this.curves.length<2)return;let t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}ellipse(){throw Error("SegContext不支持调用ellipse")}lineTo(t,e,i,r){let n=this.addLinearCurve(t,e,i,this._lastOriginP,r);this.curves.push(n),this._lastX=t,this._lastY=e,this._lastOriginP=r}moveTo(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}quadraticCurveTo(t,e,i,r){throw Error("SegContext不支持调用quadraticCurveTo")}clear(){this.curves=[],this.length=NaN}tryUpdateLength(t){return this.getLength(t)}addLinearCurve(t,e,i,r,s){let l=new a.g(new n.E9(this._lastX,this._lastY),new n.E9(t,e));return l.originP1=r,l.originP2=s,l.defined=i,l}getPointAt(t){throw Error("暂未实现")}getCurveLengths(){return[]}getLength(t){var e,i;if(t===s.Nm.COLUMN){if(!this.curves.length)return 0;let t=this.curves[0],i=this.curves[this.curves.length-1],n=null!=(e=i.p3)?e:i.p1;return(0,r.Wn)(t.p0.y-n.y)}if(t===s.Nm.ROW){if(!this.curves.length)return 0;let t=this.curves[0],e=this.curves[this.curves.length-1],n=null!=(i=e.p3)?i:e.p1;return(0,r.Wn)(t.p0.x-n.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((t,e)=>t+e.getLength(),0)),this.length}}class h extends o{bezierCurveTo(t,e,i,r,n,s,l,a){return super.bezierCurveTo(e,t,r,i,s,n,l,a)}lineTo(t,e,i,r){return super.lineTo(e,t,i,r)}moveTo(t,e,i){return super.moveTo(e,t,i)}clear(){return super.clear()}}function u(t,e,i=1){let r=!1;for(let i=0,n=e.length;i<=n;i++)i>=n===r&&((r=!r)?t.lineStart():t.lineEnd()),r&&t.point(e[i])}function d(t,e,i){let n=null!=e?e:(0,r.Wn)(i[i.length-1].x-i[0].x)>(0,r.Wn)(i[i.length-1].y-i[0].y)?s.Nm.ROW:s.Nm.COLUMN;return"monotoneY"===t?new h(t,n):new o(t,n)}class c{constructor(t,e){this.context=t,e&&(this.startPoint=e)}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t)}this._lastDefined=t.defined}tryUpdateLength(){return this.context.tryUpdateLength()}}function p(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;let n=d("linear",i,t);return u(new c(n,r),t,1),n}function g(t,e,i,r,n){t.context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+i)/6,r,t.lastPoint1)}class f{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){2===this._point&&g(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:g(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function m(t,e,i){let r=t._x1-t._x0,n=e-t._x1,s=(t._y1-t._y0)/(r||Number(n<0&&-0)),l=(i-t._y1)/(n||Number(r<0&&-0));return((s<0?-1:1)+(l<0?-1:1))*Math.min(Math.abs(s),Math.abs(l),.5*Math.abs((s*n+l*r)/(r+n)))||0}function y(t,e){let i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function v(t,e,i,r,n){let s=t._x0,l=t._y0,a=t._x1,o=t._y1,h=(a-s)/3;t.context.bezierCurveTo(s+h,l+h*e,a-h,o-h*i,a,o,r,t.lastPoint1)}class b{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:v(this,this._t0,y(this,this._t0),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1)}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=NaN,i=t.x,r=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,r,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(i,r,t);break;case 1:this._point=2;break;case 2:this._point=3,v(this,y(this,e=m(this,i,r)),e,!1!==this._lastDefined1&&!1!==this._lastDefined2,t);break;default:v(this,this._t0,e=m(this,i,r),!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=r,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=!1!==t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class _ extends b{constructor(t,e){super(t,e)}point(t){return super.point({y:t.x,x:t.y,defined:t.defined})}}class x{constructor(t,e=.5,i){this.context=t,this._t=e,this.startPoint=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){0<this._t&&this._t<1&&2===this._point&&this.context.lineTo(this._x,this._y,!1!==this._lastDefined,this.lastPoint),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t);else{let r=this._x*(1-this._t)+e*this._t;.5===this._t?this.context.lineTo(r,this._y,!1!==this._lastDefined,this.lastPoint):this.context.lineTo(r,this._y,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(r,i,!1!==this._lastDefined&&!1!==t.defined,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class C extends x{lineEnd(){this.context.closePath()}}function w(t,e,i={}){let{direction:n,startPoint:l}=i;if(t.length<2-Number(!!l))return null;let a=new o("step",null!=n?n:(0,r.Wn)(t[t.length-1].x-t[0].x)>(0,r.Wn)(t[t.length-1].y-t[0].y)?s.Nm.ROW:s.Nm.COLUMN);return u(new x(a,e,l),t,1),a}class S extends c{lineEnd(){this.context.closePath()}}function A(t,e,i,n,s){let l=t._x1,a=t._y1,o=t._x2,h=t._y2;if(t._l01_a>r.Ho){let e=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,i=3*t._l01_a*(t._l01_a+t._l12_a);l=(l*e-t._x0*t._l12_2a+t._x2*t._l01_2a)/i,a=(a*e-t._y0*t._l12_2a+t._y2*t._l01_2a)/i}if(t._l23_a>r.Ho){let r=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,n=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*r+t._x1*t._l23_2a-e*t._l12_2a)/n,h=(h*r+t._y1*t._l23_2a-i*t._l12_2a)/n}t.context.bezierCurveTo(l,a,o,h,t._x2,t._y2,n,t.lastPoint1)}function M(t,e){return function(i,r,n={}){let{direction:s,startPoint:l}=n;if(i.length<2-Number(!!l))return null;if(i.length<3-Number(!!l))return p(i,n);let a=d(t,s,i);return u(new e(a,r,l),i,2),a}}let k=M("catmullRom",class{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let{x:e,y:i}=t;if(this._point){let t=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2):this.context.moveTo(e,i);break;case 1:this._point=2;break;case 2:this._point=3;default:A(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}),T=M("catmullRomClosed",class{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}point(t){let{x:e,y:i}=t;if(this._point){let t=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=i;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=i,t);break;case 2:this._point=3,this._x5=e,this._y5=i;break;default:A(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}});function R(t,e,i){var n,l;switch(e){case"linear":default:return p(t,i);case"basis":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return p(t,e);let n=d("basis",i,t);return u(new f(n,r),t,2),n}(t,i);case"monotoneX":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return p(t,e);let n=d("monotoneX",i,t);return u(new b(n,r),t,2),n}(t,i);case"monotoneY":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return p(t,e);let n=d("monotoneY",i,t);return u(new _(n,r),t,2),n}(t,i);case"step":return w(t,.5,i);case"stepClosed":return function(t,e,i={}){let{direction:n,startPoint:l}=i;if(t.length<2-Number(!!l))return null;let a=new o("step",null!=n?n:(0,r.Wn)(t[t.length-1].x-t[0].x)>(0,r.Wn)(t[t.length-1].y-t[0].y)?s.Nm.ROW:s.Nm.COLUMN);return u(new C(a,.5,l),t,1),a}(t,0,i);case"stepBefore":return w(t,0,i);case"stepAfter":return w(t,1,i);case"catmullRom":return k(t,null!=(n=null==i?void 0:i.curveTension)?n:.5,i);case"catmullRomClosed":return T(t,null!=(l=null==i?void 0:i.curveTension)?l:.5,i);case"linearClosed":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;let n=d("linear",i,t);return u(new S(n,r),t,1),n}(t,i)}}},2844:function(t,e,i){"use strict";i.d(e,{U:()=>a});var r=i(88504),n=i(45273),s=i(88663);let l=r.pi/2;function a(t,e,i,o,h,u,d=!0,c){let p;if(Array.isArray(d)&&(c=d,d=!0),o<0&&(e+=o,o=-o),h<0&&(i+=h,h=-h),(0,n.Z)(u,!0))p=[u=(0,r.Wn)(u),u,u,u];else if(Array.isArray(u)){let t,e,i=u;switch(i.length){case 0:p=[0,0,0,0];break;case 1:p=[t=(0,r.Wn)(i[0]),t,t,t];break;case 2:case 3:p=[t=(0,r.Wn)(i[0]),e=(0,r.Wn)(i[1]),t,e];break;default:(p=i)[0]=(0,r.Wn)(p[0]),p[1]=(0,r.Wn)(p[1]),p[2]=(0,r.Wn)(p[2]),p[3]=(0,r.Wn)(p[3])}}else p=[0,0,0,0];if(o<0||p[0]+p[1]+p[2]+p[3]<1e-12)return t.rect(e,i,o,h);let[g,f,m,y]=[[e,i],[e+o,i],[e+o,i+h],[e,i+h]],v=Math.min(o/2,h/2),b=[Math.min(v,p[0]),Math.min(v,p[1]),Math.min(v,p[2]),Math.min(v,p[3])],_=[g[0]+b[0],g[1]],x=[g[0],g[1]+b[0]],C=[f[0]-b[1],f[1]],w=[f[0],f[1]+b[1]],S=[m[0]-b[2],m[1]],A=[m[0],m[1]-b[2]],M=[y[0]+b[3],y[1]],k=[y[0],y[1]-b[3]];if(t.moveTo(_[0],_[1]),d){if(c&&c[0]?c[0](_[0],_[1],C[0],C[1]):t.lineTo(C[0],C[1]),!(0,s.h6)(C,w)){c&&c[0]&&t.moveTo(C[0],C[1]);let e=C[0],i=C[1]+b[1];t.arc(e,i,b[1],-l,0,!1)}if(c&&c[1]?c[1](w[0],w[1],A[0],A[1]):t.lineTo(A[0],A[1]),!(0,s.h6)(S,A)){let e=A[0]-b[2],i=A[1];c&&c[1]&&t.moveTo(A[0],A[1]),t.arc(e,i,b[2],0,l,!1)}if(c&&c[2]?c[2](S[0],S[1],M[0],M[1]):t.lineTo(M[0],M[1]),!(0,s.h6)(M,k)){let e=M[0],i=M[1]-b[3];c&&c[2]&&t.moveTo(M[0],M[1]),t.arc(e,i,b[3],l,r.pi,!1)}if(c&&c[3]?c[3](k[0],k[1],x[0],x[1]):t.lineTo(x[0],x[1]),!(0,s.h6)(_,x)){let e=_[0],i=_[1]+b[0];c&&c[3]&&t.moveTo(x[0],x[1]),t.arc(e,i,b[0],r.pi,r.pi+l,!1)}}else c&&c[0]?c[0](_[0],_[1],C[0],C[1]):t.lineTo(C[0],C[1]),c&&c[1]?c[1](C[0],C[1],S[0],S[1]):t.lineTo(S[0],S[1]),c&&c[2]?c[2](S[0],S[1],M[0],M[1]):t.lineTo(M[0],M[1]),c&&c[2]?c[2](M[0],M[1],_[0],_[1]):t.lineTo(_[0],_[1]);return c||t.closePath(),t}},29230:function(t,e,i){"use strict";function r(t,e,i){let r={},n=[];return t.forEachChildren(t=>{let{zIndex:i=e}=t.attribute;r[i]?r[i].push(t):(r[i]=[t],n.push(i))},i),n.sort((t,e)=>i?e-t:t-e),{childMap:r,zIdxArray:n}}function n(t,e,i,s=!1,l=!1){let a=!1;if(l)a=!0;else{let i;t.forEachChildren((t,r)=>{let{zIndex:n=e}=t.attribute;if(0===r)i=n;else if(i!==n)return a=!0,!0;return!1},s)}if(a){let{childMap:n,zIdxArray:a}=r(t,e,s),o=!1;for(let t=0;t<a.length&&!o;t++){let e=n[a[t]];l&&e.sort((t,e)=>{var i,r;return(s?-1:1)*((null!=(i=e.attribute.z)?i:0)-(null!=(r=t.attribute.z)?r:0))});for(let t=0;t<e.length;t++)if(i(e[t],t)){o=!0;break}}}else t.forEachChildren(i,s)}function s(t,e,i,r=!1){var n,l,a,o;return n=this,l=void 0,a=void 0,o=function*(){yield t.forEachChildrenAsync(i,r)},new(a||(a=Promise))(function(t,e){function i(t){try{s(o.next(t))}catch(t){e(t)}}function r(t){try{s(o.throw(t))}catch(t){e(t)}}function s(e){var n;e.done?t(e.value):((n=e.value)instanceof a?n:new a(function(t){t(n)})).then(i,r)}s((o=o.apply(n,l||[])).next())})}function l(t,e,i,n=!1){let s=!1;t.forEachChildren((t,e)=>{let{zIndex:r=i}=t.attribute;if(0===e);else if(void 0!==r)return s=!0,!0;return!1},n);let a=null,o=!1;if(s){let{childMap:s,zIdxArray:l}=r(t,i,n),h=!1;for(let t=0;t<l.length&&!h;t++){let i=s[l[t]];for(let t=0;t<i.length;t++){if(o){h=!0,a=i[t];break}i[t]._uid!==e||(o=!0)}}}else t.forEachChildren(t=>o?(a=t,!0):(t._uid===e&&(o=!0),!1),n);return a}i.d(e,{Ud:()=>s,kD:()=>n,qA:()=>l})},38939:function(t,e,i){"use strict";i.d(e,{WD:()=>h,js:()=>a,nV:()=>o});var r=i(97424),n=i(35652),s=i(21777),l=i(30756);function a(t,e){return"end"===t||"right"===t?-e:"center"===t?-e/2:0}function o(t,e,i,r=0){return"middle"===t?-e/2:"top"===t?0:"bottom"===t?r-e:t&&"alphabetic"!==t?0:(i||(i=e),-(e-i)/2-.79*i)}function h(t){let e={},i=t=>/^\d+(\.\d+)?$/.test(`${t}`)?`${t}px`:`${t}`;return["textAlign","fontFamily","fontVariant","fontStyle","fontWeight"].forEach(i=>{t[i]&&(e[(0,r.Z2)(i)]=t[i])}),["fontSize","lineHeight"].forEach(s=>{let l=(0,r.Z2)(s);(0,n.Z)(t[s])||(e[l]=i(t[s]))}),(0,s.Z)(t.maxLineWidth)&&(e["max-width"]=i(t.maxLineWidth)),t.underline?e["text-decoration"]="underline":t.lineThrough&&(e["text-decoration"]="line-through"),t.fill&&(0,l.Z)(t.fill)&&(e.color=t.fill),e}},70749:function(t,e,i){"use strict";i.d(e,{Dn:()=>d,SA:()=>v,VA:()=>w,dZ:()=>x,dj:()=>p,hT:()=>b,jx:()=>m,p9:()=>_,q9:()=>y});var r,n,s=i(61868),l=i(31535),a=i(88504),o=i(41457),h=i(30756);(r=n||(n={}))[r.Top=1]="Top",r[r.Right=2]="Right",r[r.Bottom=4]="Bottom",r[r.Left=8]="Left",r[r.ALL=15]="ALL";let u=[!1,!1,!1,!1],d=t=>{var e;let i=!0;if((0,s.Z)(t,!0)){for(let r=0;r<4;r++)u[r]=t,i&&(i=!(null!=(e=u[r])&&!e));i=t}else if(Array.isArray(t))for(let e=0;e<4;e++)u[e]=!!t[e],i&&(i=!!u[e]);else u[0]=!1,u[1]=!1,u[2]=!1,u[3]=!1;return{isFullStroke:i,stroke:u}},c=[0,0,0,0],p=t=>t?(0,l.Z)(t)?0===t.length?0:1===t.length?t[0]:2===t.length?(c[0]=t[0],c[2]=t[0],c[1]=t[1],c[3]=t[1],c):t:t:0,g=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],f=[1,2,3,0,1,2,3,0];function m(t,e,i,r){for(;t>=a.f7;)t-=a.f7;for(;t<0;)t+=a.f7;for(;t>e;)e+=a.f7;g[0].x=i,g[1].y=i,g[2].x=-i,g[3].y=-i;let n=Math.ceil(t/a.ou)%4,s=Math.ceil(e/a.ou)%4;if(r.add((0,a.mC)(t)*i,(0,a.O$)(t)*i),r.add((0,a.mC)(e)*i,(0,a.O$)(e)*i),n!==s||e-t>a.pi){let t=!1;for(let e=0;e<f.length;e++)if(t||n!==f[e]){if(t&&s===f[e])break;if(t){let t=g[f[e]];r.add(t.x,t.y)}}else{t=!0;let e=g[n];r.add(e.x,e.y)}}}function y(t,e,i){let{x:r,y:n}=(0,a.KU)(t.x,t.y,e.x,e.y,i),{x:s,y:l}=(0,a.KU)(t.x1,t.y1,e.x1,e.y1,i),h=new o.E9(r,n,s,l);return h.defined=e.defined,h}function v(t,e,i){if(!t||!e)return[];Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);let r=[];if(t.length>e.length){r=e.map(t=>{let e=new o.E9(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e});for(let n=0;n<e.length;n++)r[n]=y(t[n],e[n],i)}else{r=e.map(t=>{let e=new o.E9(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e});for(let n=0;n<t.length;n++)r[n]=y(t[n],e[n],i)}return r}function b(t,e){if((0,l.Z)(t)){let i;for(let r=0;r<t.length&&void 0===i;r++)i=t[r][e];return i}return t[e]}class _{constructor(t=_.TimeOut){this.durations=[],this.timeout=t,this.lastDate=0,this.durationsListThreshold=30}call(t){return this.lastDate=Date.now(),setTimeout(()=>{this.appendDuration(Date.now()-this.lastDate),t(0)},this.timeout,!0)}clear(t){clearTimeout(t)}appendDuration(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((t,e)=>t+e,0)/this.durations.length,1e3/60),1e3/30)}}_.TimeOut=1e3/60;let x=new _,C=(t,e)=>(0,h.Z)(t)&&"%"===t[t.length-1]?e*(Number.parseFloat(t.substring(0,t.length-1))/100):t,w=(t,e)=>{let i=C(t,e);return isNaN(i)?i:Math.max(e,i)}},71071:function(t,e,i){"use strict";i.d(e,{D0:()=>r,iR:()=>s,y2:()=>n});let r=Symbol.for("EnvContribution"),n=Symbol.for("VGlobal"),s="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol"},91018:function(t,e,i){"use strict";let r;i.d(e,{n:()=>f});var n=i(40398);let s={Singleton:"Singleton",Transient:"Transient"},l={ConstantValue:"ConstantValue",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid"};class a{constructor(t,e){this.id=n.R.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=l.Invalid,this.constraint=t=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}clone(){let t=new a(this.serviceIdentifier,this.scope);return t.activated=t.scope===s.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.provider=this.provider,t.constraint=this.constraint,t.cache=this.cache,t}}var o=i(47293),h=i(58866);class u{getConstructorMetadata(t){return{compilerGeneratedMetadata:h.Z.getMetadata(o.FL,t),userGeneratedMetadata:h.Z.getMetadata(o.LD,t)||{}}}getPropertiesMetadata(t){throw Error("暂未实现")}}var d=i(12486);let c=(r=o.vO,t=>{let e=e=>{if(null==e)return!1;if(e.key===r&&e.value===t)return!0;if(null==e.constructorArgsMetadata)return!1;let i=e.constructorArgsMetadata;for(let e=0;e<i.length;e++)if(i[e].key===r&&i[e].value===t)return!0;return!1};return e.metaData=new d.S(r,t),e});class p{constructor(t){this._binding=t}inRequestScope(){throw Error("暂未实现")}inSingletonScope(){return this._binding.scope=s.Singleton,this}inTransientScope(){return this._binding.scope=s.Transient,this}whenTargetNamed(t){return this._binding.constraint=c(t),this}}class g{constructor(t){this._binding=t}to(t){return this._binding.type=l.Instance,this._binding.implementationType=t,new p(this._binding)}toSelf(){let t=this._binding.serviceIdentifier;return this.to(t)}toDynamicValue(t){return this._binding.type=l.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new p(this._binding)}toConstantValue(t){return this._binding.type=l.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=s.Singleton,new p(this._binding)}toFactory(t){return this._binding.type=l.Factory,this._binding.factory=t,this._binding.scope=s.Singleton,new p(this._binding)}toService(t){this.toDynamicValue(e=>e.container.get(t))}}let f=new class{constructor(t){let e=t||{};e.defaultScope=e.defaultScope||s.Transient,this.options=e,this.id=n.R.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new u}load(t){let e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}get(t){let e=this._getNotAllArgs(t,!1);return this._get(e)}getAll(t){let e=this._getAllArgs(t);return this._get(e)}getTagged(t,e,i){let r=this._getNotAllArgs(t,!1,e,i);return this._get(r)}getNamed(t,e){return this.getTagged(t,o.vO,e)}isBound(t){return this._bindingDictionary.has(t)}bind(t){let e=new a(t,this.options.defaultScope),i=this._bindingDictionary.get(t)||[];return i.push(e),this._bindingDictionary.set(t,i),new g(e)}unbind(t){this._bindingDictionary.delete(t)}rebind(t){return this.unbind(t),this.bind(t)}_getContainerModuleHelpersFactory(){let t=(t,e)=>{t._binding.moduleId=e},e=e=>i=>{let r=this.bind(i);return t(r,e),r},i=()=>t=>this.unbind(t),r=()=>t=>this.isBound(t),n=e=>i=>{let r=this.rebind(i);return t(r,e),r};return t=>({bindFunction:e(t),isboundFunction:r(),rebindFunction:n(t),unbindFunction:i(),unbindAsyncFunction:t=>null})}_getNotAllArgs(t,e,i,r){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:r}}_getAllArgs(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}_get(t){let e=[];return this._bindingDictionary.get(t.serviceIdentifier).filter(e=>e.constraint(t)).forEach(t=>{e.push(this._resolveFromBinding(t))}),t.isMultiInject||1!==e.length?e:e[0]}_getChildRequest(t){let e=t.implementationType,{userGeneratedMetadata:i}=this._metadataReader.getConstructorMetadata(e),r=Object.keys(i),n=[];for(let t=0;t<r.length;t++){let e=i[t],r={};e.forEach(t=>{r[t.key]=t.value});let s={inject:r[o.B8],multiInject:r[o.Lc]},l=s.inject||s.multiInject,a={serviceIdentifier:l,constructorArgsMetadata:e},h=(this._bindingDictionary.get(l)||[]).filter(t=>t.constraint(a));if(h.length){let t={injectIdentifier:l,metadata:e,bindings:h};n.push(t)}}return n}_resolveFromBinding(t){let e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}_getResolvedFromBinding(t){let e;switch(t.type){case l.ConstantValue:case l.Function:e=t.cache;break;case l.Instance:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}_resolveInstance(t,e){if(t.activated)return t.cache;let i=this._getChildRequest(t);return this._createInstance(e,i)}_createInstance(t,e){return e.length?new t(...this._resolveRequests(e)):new t}_resolveRequests(t){return t.map(t=>t.bindings.length>1?t.bindings.map(t=>this._resolveFromBinding(t)):this._resolveFromBinding(t.bindings[0]))}_saveToScope(t,e){t.scope===s.Singleton&&(t.cache=e,t.activated=!0)}}},58952:function(t,e,i){"use strict";i.d(e,{Gp:()=>r,IT:()=>s,XJ:()=>o,kj:()=>l,no:()=>n,ym:()=>a});let r=Symbol.for("TransformUtil"),n=Symbol.for("GraphicUtil"),s=Symbol.for("LayerService"),l=Symbol.for("StaticLayerHandlerContribution"),a=Symbol.for("DynamicLayerHandlerContribution"),o=Symbol.for("VirtualLayerHandlerContribution")},57565:function(t,e,i){"use strict";i.d(e,{z:()=>s});var r=i(26004),n=i(76620);let s=class{configure(t,...e){t.env===this.type&&t.setActiveEnvContribution(this)}getNativeAABBBounds(t){return new n.FB}removeDom(t){return!1}createDom(t){return null}updateDom(t,e){return!1}getDynamicCanvasCount(){return 999}getStaticCanvasCount(){return 999}getElementById(t){return document.getElementById(t)}getRootElement(){return document.body}loadJson(t){let e=fetch(t).then(t=>t.json());return e.then(t=>({data:t,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(t){return fetch(t).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadBlob(t){return fetch(t).then(t=>t.blob()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}getElementTop(t,e){return 0}getElementLeft(t,e){return 0}getElementTopLeft(t,e){return{top:0,left:0}}loadFont(t,e,i){var r,n,s,l;return r=this,n=void 0,l=function*(){return{loadState:"fail"}},new(s=void 0,s=Promise)(function(t,e){function i(t){try{o(l.next(t))}catch(t){e(t)}}function a(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof s?r:new s(function(t){t(r)})).then(i,a)}o((l=l.apply(r,n||[])).next())})}isMacOS(){return!1}copyToClipBoard(t){return Promise.resolve(null)}};s=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,r.b)()],s)},10797:function(t,e,i){"use strict";i.d(e,{j:()=>n});var r=i(32623);class n{constructor(t,e,i){this.fontFamily=t,this.textOptions=e,this.textMeasure=i}LayoutBBox(t,e,i,r){if(t.xOffset="left"===e||"start"===e?0:"center"===e?-(t.width/2):"right"===e||"end"===e?-t.width:0,"top"===i)t.yOffset=0;else if("middle"===i)t.yOffset=-(t.height/2);else if("alphabetic"===i){let e=.79;if(1===r.length){let t=r[0];e=t.ascent/(t.ascent+t.descent)}t.yOffset=-(t.height*e)}else t.yOffset=-t.height;return t}GetLayoutByLines(t,e,i,n,s="",l,a){let{lineWidth:o,suffixPosition:h="end",measureMode:u=r.r.actualBounding,keepCenterInLine:d=!1}=null!=a?a:{};t=t.map(t=>t.toString());let c=[],p=[0,0];if("number"==typeof o&&o!==1/0){let e;for(let i=0,r=t.length;i<r;i++){let r=this.textMeasure.measureTextPixelADscentAndWidth(t[i],this.textOptions,u),n=t[i].toString();if(r.width>o){let r=this.textMeasure.clipTextWithSuffix(t[i],this.textOptions,o,s,l,h);n=r.str,e=r.width}else e=r.width;c.push({str:n,width:e,ascent:r.ascent,descent:r.descent,keepCenterInLine:d})}p[0]=o}else{let e,i,r=0;for(let n=0,s=t.length;n<s;n++){i=t[n];let s=this.textMeasure.measureTextPixelADscentAndWidth(t[n],this.textOptions,u);r=Math.max(r,e=s.width),c.push({str:i,width:e,ascent:s.ascent,descent:s.descent,keepCenterInLine:d})}p[0]=r}p[1]=c.length*n,p[0]=c.reduce((t,e)=>Math.max(t,e.width),0);let g={xOffset:0,yOffset:0,width:p[0],height:p[1]};return this.LayoutBBox(g,e,i,c),this.layoutWithBBox(g,c,e,i,n)}layoutWithBBox(t,e,i,r,n){let s=[0,0],l=e.length*n;"top"===r||("middle"===r?s[1]=(t.height-l)/2:"bottom"===r&&(s[1]=t.height-l));for(let l=0;l<e.length;l++)this.lineOffset(t,e[l],i,r,n,s);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:n,textAlign:i,textBaseline:r}}lineOffset(t,e,i,r,n,s){if("left"===i||"start"===i?e.leftOffset=0:"center"===i?e.leftOffset=(t.width-e.width)/2:"right"!==i&&"end"!==i||(e.leftOffset=t.width-e.width),e.topOffset=n/2+(e.ascent-e.descent)/2+s[1],!e.keepCenterInLine){let t=e.ascent+e.descent+0;if(t<n-0&&("bottom"===r?e.topOffset+=(n-t)/2:"top"===r&&(e.topOffset-=(n-t)/2)),"alphabetic"===r){let t=n/(e.ascent+e.descent);e.topOffset=n/2+(e.ascent-e.descent)/2*t+s[1]}}return s[1]+=n,e}}},46919:function(t,e,i){"use strict";i.d(e,{j:()=>h,f:()=>u});var r=i(26004),n=i(32623),s=i(36081),l=i(21295),a=i(30943);let o=class{constructor(){this.id="ATextMeasure"}configure(t,e){this.canvas=t.canvas,this.context=t.context,t.bindTextMeasure(this)}_measureTextWithoutAlignBaseline(t,e,i){this.context.setTextStyleWithoutAlignBaseline(e);let r=this.context.measureText(t);return i?this.compatibleMetrics(r,e):r}_measureTextWithAlignBaseline(t,e,i){this.context.setTextStyle(e);let r=this.context.measureText(t);return i?this.compatibleMetrics(r,e):r}compatibleMetrics(t,e){if(null==t.actualBoundingBoxAscent||null==t.actualBoundingBoxDescent||null==t.fontBoundingBoxAscent||null==t.fontBoundingBoxDescent){t={width:t.width};let{ascent:i,descent:r}=this.measureTextBoundADscentEstimate(e);t.actualBoundingBoxAscent=i,t.actualBoundingBoxDescent=r,t.fontBoundingBoxAscent=i,t.fontBoundingBoxDescent=r}if(null==t.actualBoundingBoxLeft||null==t.actualBoundingBoxRight){t={width:t.width,actualBoundingBoxAscent:t.actualBoundingBoxAscent,actualBoundingBoxDescent:t.actualBoundingBoxDescent,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent};let{left:i,right:r}=this.measureTextBoundLeftRightEstimate(e);t.actualBoundingBoxLeft=i,t.actualBoundingBoxRight=r}return t}estimate(t,{fontSize:e=s.T5.fontSize}){let i=0,r=0;for(let e=0;e<t.length;e++)128>t.charCodeAt(e)?i++:r++;return{width:~~(.8*i*e+r*e),height:e}}measureTextWidth(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}measureTextBoundsWidth(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}measureTextBoundsLeftRight(t,e,i){return this.context?{left:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxLeft,right:i.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(e)}measureTextPixelHeight(t,e,i){var r;return this.context?Math.abs((i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0)).actualBoundingBoxAscent-i.actualBoundingBoxDescent):null!=(r=e.fontSize)?r:s.q9.fontSize}measureTextPixelADscent(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}measureTextBoundHieght(t,e,i){var r;return this.context?Math.abs((i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0)).fontBoundingBoxAscent-i.fontBoundingBoxDescent):null!=(r=e.fontSize)?r:s.q9.fontSize}measureTextBoundADscent(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).fontBoundingBoxAscent,descent:i.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}measureTextBoundADscentEstimate(t){var e;let i=null!=(e=t.fontSize)?e:s.q9.fontSize;return{ascent:.79*i,descent:.21*i}}measureTextBoundLeftRightEstimate(t){var e;let i=null!=(e=t.fontSize)?e:s.q9.fontSize,{textAlign:r}=t;return"center"===r?{left:i/2,right:i/2}:"right"===r||"end"===r?{left:i,right:0}:{left:0,right:i}}measureTextPixelADscentAndWidth(t,e,i){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:this.estimate(t,e).width});let r=this._measureTextWithoutAlignBaseline(t,e,!0);if(i===n.r.actualBounding)return{ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,width:r.width};if(i===n.r.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:r.width});if(i===n.r.fontBounding){let t=r.fontBoundingBoxAscent,e=r.fontBoundingBoxDescent;if(r.actualBoundingBoxDescent&&e<r.actualBoundingBoxDescent){let i=r.actualBoundingBoxDescent-e;e+=i,t-=i}else if(r.actualBoundingBoxAscent&&t<r.actualBoundingBoxAscent){let i=r.actualBoundingBoxAscent-t;t+=i,e-=i}return{ascent:t,descent:e,width:r.width}}return{ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,width:r.width}}measureText(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t)):this.estimate(t,e)}clipTextVertical(t,e,i,r){if(0===t.length)return{verticalList:t,width:0};let{fontSize:n=12}=e;t.forEach(t=>{t.width=0===t.direction?n:this.measureTextWidth(t.text,e)});let s=[],a=0,o=0;for(;o<t.length&&a+t[o].width<i;o++)a+=t[o].width,s.push(t[o]);if(t[o]&&t[o].text.length>1){let n=this._clipText(t[o].text,e,i-a,0,t[o].text.length-1,"end",!1);if(r&&n.str!==t[o].text){let i="",r=0;for(let e=0;e<o;e++){let n=t[e];i+=n.text,r+=n.text.length}i+=t[o].text;let s=r+n.str.length,a=(0,l.SZ)(i,s);(a-=r)!=n.str.length-1&&(n.str=n.str.substring(0,a),n.width=this.measureTextWidth(n.str,e))}s.push(Object.assign(Object.assign({},t[o]),{text:n.str,width:n.width})),a+=n.width}return{verticalList:s,width:a}}clipText(t,e,i,r,n){if(0===t.length)return{str:"",width:0};let s=this.measureTextWidth(t,e);if(s<=i)return{str:t,width:s};if((s=this.measureTextWidth(t[0],e))>i)return{str:"",width:0};let a=this._clipText(t,e,i,0,t.length-1,"end",!1);if(r&&a.str!==t){let i=(0,l.SZ)(t,a.str.length,n);i!==a.str.length&&(i>a.str.length&&(a.wordBreaked=i,i=a.str.length),a.str=t.substring(0,i),a.width=this.measureTextWidth(a.str,e))}return a}_clipText(t,e,i,r,n,s,l){let a;if("start"===s)a=this._clipTextStart(t,e,i,r,n),l&&(a.result=l+a.str);else if("middle"===s){let r=this._clipTextMiddle(t,e,i,"","",0,0,1);a={str:"none",width:r.width,result:r.left+l+r.right}}else a=this._clipTextEnd(t,e,i,r,n),l&&(a.result=a.str+l);return a}_clipTextEnd(t,e,i,r,n){let s;if(r===n){a.Y.getInstance().warn(`【_clipTextEnd】不应该走到这里${t}, ${r}, ${n}`);let i=t.substring(0,n+1);return{str:i,width:this.measureTextWidth(i,e)}}let l=Math.floor((r+n)/2),o=t.substring(0,l+1),h=this.measureTextWidth(o,e);if(h>i){if(o.length<=1)return{str:"",width:0};let n=t.substring(0,l);return(s=this.measureTextWidth(n,e))<=i?{str:n,width:s}:this._clipTextEnd(t,e,i,r,l)}if(h<i){if(l>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};let r=t.substring(0,l+2);return(s=this.measureTextWidth(r,e))>=i?{str:o,width:h}:this._clipTextEnd(t,e,i,l,n)}return{str:o,width:h}}_clipTextStart(t,e,i,r,n){let s,l=Math.ceil((r+n)/2),a=t.substring(l-1,t.length),o=this.measureTextWidth(a,e);if(o>i){if(a.length<=1)return{str:"",width:0};let r=t.substring(l,t.length);return(s=this.measureTextWidth(r,e))<=i?{str:r,width:s}:this._clipTextStart(t,e,i,l,t.length)}if(o<i){if(l<=0)return{str:t,width:this.measureTextWidth(t,e)};let n=t.substring(l-2,t.length);return(s=this.measureTextWidth(n,e))>=i?{str:a,width:o}:this._clipTextStart(t,e,i,r,l)}return{str:a,width:o}}_clipTextMiddle(t,e,i,r,n,s,l,a){let o=t.substring(0,a),h=this.measureTextWidth(o,e);if(h+l>i)return{left:r,right:n,width:s+l};let u=t.substring(t.length-a,t.length),d=this.measureTextWidth(u,e);return h+d>i?{left:o,right:n,width:h+l}:this._clipTextMiddle(t,e,i,o,u,h,d,a+1)}clipTextWithSuffixVertical(t,e,i,r,n,s){let l;if(""===r)return this.clipTextVertical(t,e,i,n);if(0===t.length)return{verticalList:t,width:0};let a=this.clipTextVertical(t,e,i,n);if(a.verticalList.length===t.length&&a.verticalList[a.verticalList.length-1].width===t[t.length-1].width)return a;let o=this.measureTextWidth(r,e);if(o>i)return a;if(i-=o,"start"===s){let s=this.revertVerticalList(t);l=this.clipTextVertical(s,e,i,n);let a=this.revertVerticalList(l.verticalList);a.unshift({text:r,direction:1,width:o}),l.verticalList=a}else if("middle"===s){let s=this.clipTextVertical(t,e,i/2,n),a=this.revertVerticalList(t),h=this.clipTextVertical(a,e,i/2,n);s.verticalList.push({text:r,direction:1,width:o}),this.revertVerticalList(h.verticalList).forEach(t=>s.verticalList.push(t)),l={verticalList:s.verticalList,width:s.width+h.width}}else(l=this.clipTextVertical(t,e,i,n)).verticalList.push({text:r,direction:1,width:o});return l.width+=o,l}revertVerticalList(t){return t.reverse().map(t=>{let e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})})}clipTextWithSuffix(t,e,i,r,n,s,a=!1){if(""===r)return this.clipText(t,e,i,n);if(0===t.length)return{str:"",width:0};let o=this.measureTextWidth(t,e);if(!a&&o<=i)return{str:t,width:o};let h=this.measureTextWidth(r,e);if(h>i)return{str:"",width:0};if(a&&o+h<=i)return{str:t+r,width:o+h};i-=h;let u=this._clipText(t,e,i,0,t.length-1,s,r);if(n&&u.str!==t){let i=(0,l.SZ)(t,u.str.length);i!==u.str.length&&(u.result=t.substring(0,i),u.width=this.measureTextWidth(u.str,e))}else a&&u.str===t&&(u.result=t+r);return u.str=u.result,u.width+=h,u}};o=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,r.b)()],o);let h=Symbol.for("TextMeasureContribution"),u=class extends o{constructor(){super(...arguments),this.id="DefaultTextMeasureContribution"}};u=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,r.b)()],u)},84956:function(t,e,i){"use strict";i.d(e,{X:()=>a});var r=i(26004),n=i(40398),s=i(76620),l=i(8992);let a=class{constructor(){this._uid=n.R.GenAutoIncrementId(),this.viewBox=new s.FB,this.modelMatrix=new l.y(1,0,0,1,0,0)}onChange(t){this._onChangeCb=t}configure(t,e){e.env===this.type&&t.setWindowHandler(this)}release(...t){this.releaseWindow()}isVisible(t){return!0}onVisibleChange(t){}getTopLeft(t){return{top:0,left:0}}setViewBox(t){this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2)}getViewBox(){return this.viewBox}setViewBoxTransform(t,e,i,r,n,s){this.modelMatrix.setValue(t,e,i,r,n,s)}getViewBoxTransform(){return this.modelMatrix}};a=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,r.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],a)},34301:function(t,e,i){"use strict";i.d(e,{H:()=>j});var r=i(30756),n=i(76620),s=i(41457),l=i(56488);let a=Object.prototype.hasOwnProperty,o=(t,e)=>null!=t&&a.call(t,e),h=t=>void 0===t;var u=i(21883),d=i.n(u),c=i(30943),p=i(10693);class g extends p.x{constructor(){super(...arguments),this.client={x:0,y:0},this.movement={x:0,y:0},this.offset={x:0,y:0},this.global={x:0,y:0},this.screen={x:0,y:0}}get clientX(){return this.client.x}get clientY(){return this.client.y}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,r,n,s,l,a,o,h,u,d,c,p,g){throw Error("Method not implemented.")}}class f extends g{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw Error("getPredictedEvents is not supported!")}clone(){var t,e,i;let r=new f(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null==(t=this.manager)||t.copyPointerData(this,r),null==(e=this.manager)||e.copyMouseData(this,r),null==(i=this.manager)||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();let n=this.composedDetailPath();return r.detailPath=n&&n.slice(),r.type=this.type,r}}class m extends g{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}clone(){var t,e,i;let r=new m(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null==(t=this.manager)||t.copyWheelData(this,r),null==(e=this.manager)||e.copyMouseData(this,r),null==(i=this.manager)||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();let n=this.composedDetailPath();return r.detailPath=n&&n.slice(),r.type=this.type,r}}m.DOM_DELTA_PIXEL=0,m.DOM_DELTA_LINE=1,m.DOM_DELTA_PAGE=2;var y=i(12895),v=i(61963);function b(t){return"mouse"===t||"pen"===t}class _{constructor(t,e){this.dispatch=new(d()),this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=(t,e)=>{if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.createPointerEvent(t,t.type,e);if(this.dispatchEvent(i,"pointerdown"),"touch"===i.pointerType)this.dispatchEvent(i,"touchstart");else if(b(i.pointerType)){let t=2===i.button;this.dispatchEvent(i,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=i.composedPath(),this.freeEvent(i)},this.onPointerMove=(t,e)=>{var i,r;if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let n=this.createPointerEvent(t,t.type,e),s=b(n.pointerType),l=this.trackingData(t.pointerId),a=this.findMountedTarget(l.overTargets);if(l.overTargets&&a&&a!==this.rootTarget&&a!==n.target){let e="mousemove"===t.type?"mouseout":"pointerout",i=this.createPointerEvent(t,e,a||void 0);if(this.dispatchEvent(i,"pointerout"),s&&this.dispatchEvent(i,"mouseout"),!n.composedPath().includes(a)){let e=this.createPointerEvent(t,"pointerleave",a||void 0);for(e.eventPhase=e.AT_TARGET;e.target&&!n.composedPath().includes(e.target);)e.currentTarget=e.target,this.notifyTarget(e),s&&this.notifyTarget(e,"mouseleave"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(i)}if(a!==n.target){let e="mousemove"===t.type?"mouseover":"pointerover",i=this.clonePointerEvent(n,e);this.dispatchEvent(i,"pointerover"),s&&this.dispatchEvent(i,"mouseover");let r=null==a?void 0:a.parent;for(;r&&r!==this.rootTarget.parent&&r!==n.target;)r=r.parent;if(!r||r===this.rootTarget.parent){let t=this.clonePointerEvent(n,"pointerenter");t.eventPhase=t.AT_TARGET;let e=t.target,i=new Set,r=a;for(;r&&r!==this.rootTarget;)i.add(r),r=r.parent;for(;e&&e!==a&&e!==this.rootTarget.parent;)i.has(e)||(t.currentTarget=e,this.notifyTarget(t),s&&this.notifyTarget(t,"mouseenter")),e=e.parent;this.freeEvent(t)}this.freeEvent(i)}this.dispatchEvent(n,"pointermove"),"touch"===n.pointerType&&this.dispatchEvent(n,"touchmove"),s&&(this.dispatchEvent(n,"mousemove"),this.cursorTarget=n.target,this.cursor=(null==(r=null==(i=n.target)?void 0:i.attribute)?void 0:r.cursor)||this.rootTarget.getCursor()),l.overTargets=n.composedPath(),this.freeEvent(n)},this.onPointerOver=(t,e)=>{var i,r;if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let n=this.trackingData(t.pointerId),s=this.createPointerEvent(t,t.type,e),l=b(s.pointerType);this.dispatchEvent(s,"pointerover"),l&&this.dispatchEvent(s,"mouseover"),"mouse"===s.pointerType&&(this.cursorTarget=s.target,this.cursor=(null==(r=null==(i=s.target)?void 0:i.attribute)?void 0:r.cursor)||this.rootTarget.getCursor());let a=this.clonePointerEvent(s,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),l&&this.notifyTarget(a,"mouseenter"),a.target=a.target.parent;n.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(a)},this.onPointerOut=(t,e)=>{if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.trackingData(t.pointerId);if(i.overTargets){let e=b(t.pointerType),r=this.findMountedTarget(i.overTargets),n=this.createPointerEvent(t,"pointerout",r||void 0);this.dispatchEvent(n),e&&this.dispatchEvent(n,"mouseout");let s=this.createPointerEvent(t,"pointerleave",r||void 0);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),e&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;i.overTargets=[],this.freeEvent(n),this.freeEvent(s)}this.cursorTarget=null,this.cursor=""},this.onPointerUp=(t,e)=>{var i;if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let r=v.m.now(),n=this.createPointerEvent(t,t.type,e);if(this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)this.dispatchEvent(n,"touchend");else if(b(n.pointerType)){let t=2===n.button;this.dispatchEvent(n,t?"rightup":"mouseup")}let s=this.trackingData(t.pointerId),l=this.findMountedTarget(s.pressTargetsByButton[t.button]),a=l;if(l&&!n.composedPath().includes(l)){let e=l;for(;e&&!n.composedPath().includes(e);){if(n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)this.notifyTarget(n,"touchendoutside");else if(b(n.pointerType)){let t=2===n.button;this.notifyTarget(n,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete s.pressTargetsByButton[t.button],a=e}if(a){let e=this.clonePointerEvent(n,"click");e.target=a,e.path=[],e.detailPath=[],s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:e.target,timeStamp:r});let l=s.clicksByButton[t.button];l.target===e.target&&r-l.timeStamp<(null!=(i=this._config.clickInterval)?i:200)?++l.clickCount:l.clickCount=1,l.target=e.target,l.timeStamp=r,e.detail=l.clickCount,b(e.pointerType)?(this.dispatchEvent(e,"click"),2===l.clickCount&&this.dispatchEvent(e,"dblclick")):"touch"===e.pointerType&&this._config.supportsTouchEvents&&(this.dispatchEvent(e,"tap"),2===l.clickCount&&this.dispatchEvent(e,"dbltap")),this.dispatchEvent(e,"pointertap"),this.freeEvent(e)}this.freeEvent(n)},this.onPointerUpOutside=(t,e)=>{if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.trackingData(t.pointerId),r=this.findMountedTarget(i.pressTargetsByButton[t.button]),n=this.createPointerEvent(t,t.type,e);if(r){let e=r;for(;e;)n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):b(n.pointerType)&&this.notifyTarget(n,2===n.button?"rightupoutside":"mouseupoutside"),e=e.parent;delete i.pressTargetsByButton[t.button]}this.freeEvent(n)},this.onWheel=(t,e)=>{if(!(t instanceof m))return void c.Y.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event");let i=this.createWheelEvent(t,e);this.dispatchEvent(i),this.freeEvent(i)},this.rootTarget=t,this.mappingTable={},this._config=Object.assign({clickInterval:200},e),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((t,e)=>t.priority-e.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){var e,i,r,n,s,l,a;let o;if(!this.rootTarget)return;let h=this.mappingTable[t.type],u=`${t.canvasX}-${t.canvasY}`;if((null==(e=this._prePointTargetCache)?void 0:e[u])&&(null==(r=null==(i=this._prePointTargetCache)?void 0:i[u])?void 0:r.stage)&&(null==(s=null==(n=this._prePointTargetCache)?void 0:n[u])?void 0:s.stage.renderCount)===(null==(l=this._prePointTargetCache)?void 0:l.stageRenderCount)?o=this._prePointTargetCache[u]:(o=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache={[u]:o,stageRenderCount:null!=(a=null==o?void 0:o.stage.renderCount)?a:-1})),h)for(let e=0,i=h.length;e<i;e++)h[e].fn(t,o);else c.Y.getInstance().warn(`[EventManager]: Event mapping not defined for ${t.type}`)}propagate(t,e){if(!t.target)return;let i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,n=i.length-1;r<n;r++)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}propagationPath(t){let e=[t];for(let i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}notifyTarget(t,e){if(this.pauseNotify)return;e=null!=e?e:t.type;let i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){var r,n;let s=this.allocateEvent(f);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=i||this.pickTarget(null!=(r=s.viewX)?r:s.global.x,null!=(n=s.viewY)?n:s.global.y,s),"string"==typeof e&&(s.type=e),s}createWheelEvent(t,e){var i,r;let n=this.allocateEvent(m);return this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=e||this.pickTarget(null!=(i=n.viewX)?i:n.global.x,null!=(r=n.viewY)?r:n.global.y,n),n}clonePointerEvent(t,e){let i=this.allocateEvent(f);i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice();let r=t.composedDetailPath();return i.detailPath=r&&r.slice(),i.type=null!=e?e:i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof f&&e instanceof f&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof g&&e instanceof g&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach(i=>{e[i].x=t[i].x,e[i].y=t[i].y}))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=v.m.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);let i=(null==(e=this.eventPool.get(t))?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.detailPath=[],i.target=null,i}freeEvent(t){var e;if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventManager!");let i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),null==(e=this.eventPool.get(i))||e.push(t)}notifyListeners(t,e){let i=t.currentTarget._events[e];if(i)if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(let r=0,n=i.length;r<n&&!t.propagationImmediatelyStopped;r++)i[r].once&&t.currentTarget.removeEventListener(e,i[r].fn,{once:!0}),i[r].fn.call(i[r].context,t);this.emitDelegation(t,e)}emitDelegation(t,e){let i=t.currentTarget._events[y.g];if(i)if("fn"in i)i.fn.call(i.context,t,e);else for(let r=0,n=i.length;r<n&&!t.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,t,e)}pickTarget(t,e,i){let r,n=this.rootTarget.pick(t,e);return r=n&&n.graphic?n.graphic:n&&n.group?n.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=n.params),r}release(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}}let x={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class C{constructor(t){this.resolution=1,this.onPointerDown=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(!t.cancelable&&"cancelable"in t||t.preventDefault());for(let t=0,i=e.length;t<i;t++){let i=e[t],r=this.bootstrapEvent(this.rootPointerEvent,i);this.manager.mapEvent(r)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerMove=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType||this.isEventOutsideOfTargetElement(t))return;let e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){let i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.manager.mapEvent(i)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerUp=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.isEventOutsideOfTargetViewPort(t)?"outside":"",i=this.normalizeToPointerData(t);for(let t=0,r=i.length;t<r;t++){let r=this.bootstrapEvent(this.rootPointerEvent,i[t]);r.type+=e,this.manager.mapEvent(r)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerOverOut=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){let i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.manager.mapEvent(i)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onWheel=t=>{let e=this.normalizeWheelEvent(t);this.manager.mapEvent(e)};let{targetElement:e,resolution:i,rootNode:r,global:n,autoPreventDefault:s=!1,clickInterval:l,supportsTouchEvents:a=n.supportsTouchEvents,supportsPointerEvents:o=n.supportsPointerEvents}=t;this.manager=new _(r,{clickInterval:l,supportsTouchEvents:a}),this.globalObj=n,this.supportsPointerEvents=o,this.supportsTouchEvents=a,this.supportsMouseEvents=n.supportsMouseEvents,this.applyStyles=n.applyStyles,this.autoPreventDefault=s,this.eventsAdded=!1,this.rootPointerEvent=new f,this.rootWheelEvent=new m,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=i,this.setTargetElement(e)}release(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}setCursor(t,e){if(!e&&!this.manager.rootTarget.window._handler.canvas.controled)return;t||(t="default");let{applyStyles:i,domElement:n}=this;if(this.currentCursor===t)return;this.currentCursor=t;let s=this.cursorStyles[t];s?"string"==typeof s&&i?n.style.cursor=s:"function"==typeof s?s(t):"object"==typeof s&&i&&Object.assign(n.style,s):i&&(0,r.Z)(t)&&!o(this.cursorStyles,t)&&(n.style.cursor=t)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;let{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.addEventListener("pointermove",this.onPointerMove,!0),t.addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.addEventListener("mousemove",this.onPointerMove,!0),t.addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;let{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.removeEventListener("pointermove",this.onPointerMove,!0),t.removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.removeEventListener("mousemove",this.onPointerMove,!0),t.removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapToViewportPoint(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}mapToCanvasPoint(t){var e,i;let r=null==(e=this.globalObj)?void 0:e.mapToCanvasPoint(t,this.domElement);if(r)return r;let n=0,s=0;if(t.changedTouches){let e=null!=(i=t.changedTouches[0])?i:{};n=e.clientX||0,s=e.clientY||0}else n=t.clientX||0,s=t.clientY||0;let l=this.domElement.getBoundingClientRect();return{x:n-l.left,y:s-l.top}}normalizeToPointerData(t){let e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(let i=0,r=t.changedTouches.length;i<r;i++){let r=t.changedTouches[i];h(r.button)&&(r.button=0),h(r.buttons)&&(r.buttons=1),h(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),h(r.width)&&(r.width=r.radiusX||1),h(r.height)&&(r.height=r.radiusY||1),h(r.tiltX)&&(r.tiltX=0),h(r.tiltY)&&(r.tiltY=0),h(r.pointerType)&&(r.pointerType="touch"),h(r.pointerId)&&(r.pointerId=r.identifier||0),h(r.pressure)&&(r.pressure=r.force||.5),h(r.twist)&&(r.twist=0),h(r.tangentialPressure)&&(r.tangentialPressure=0),h(r.layerX)&&(r.layerX=r.offsetX=r.clientX),h(r.layerY)&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else this.globalObj.supportsMouseEvents&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof PointerEvent)||(h(t.isPrimary)&&(t.isPrimary=!0),h(t.width)&&(t.width=1),h(t.height)&&(t.height=1),h(t.tiltX)&&(t.tiltX=0),h(t.tiltY)&&(t.tiltY=0),h(t.pointerType)&&(t.pointerType="mouse"),h(t.pointerId)&&(t.pointerId=1),h(t.pressure)&&(t.pressure=.5),h(t.twist)&&(t.twist=0),h(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),e.push(t);return e}normalizeWheelEvent(t){let e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;let{x:i,y:r}=this.mapToCanvasPoint(t);e.canvas.x=i,e.canvas.y=r,e.global.x=i,e.global.y=r,e.offset.x=i,e.offset.y=r;let{x:n,y:s}=this.mapToViewportPoint(e);return e.viewport.x=n,e.viewport.y=s,e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);let{x:i,y:r}=this.mapToCanvasPoint(e);t.canvas.x=i,t.canvas.y=r,t.global.x=i,t.global.y=r,t.offset.x=i,t.offset.y=r;let{x:n,y:s}=this.mapToViewportPoint(t);return t.viewport.x=n,t.viewport.y=s,t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=x[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=v.m.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}isEventOutsideOfTargetViewPort(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){let e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),i=this.domElement.getViewBox(),r=i.width(),n=i.height();return!(e.x<r&&e.y<n&&e.x>0&&e.y>0)}return!1}isEventOutsideOfTargetElement(t){let e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}pauseTriggerEvent(){this.manager.pauseNotify=!0}resumeTriggerEvent(){this.manager.pauseNotify=!1}}var w=i(91018),S=i(13380),A=i(75485),M=i(4062),k=i(58365),T=i(17959),R=i(40398);class B{constructor(){this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=R.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t;let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),e.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),e.graphicService.hooks.onRemove.tap(this.key,this.handleChange))}deactivate(t){let e=t=>t.filter(t=>t.name!==this.key),i=this.pluginService.stage;i&&(i.graphicService.hooks.onAttributeUpdate.taps=e(i.graphicService.hooks.onAttributeUpdate.taps),i.graphicService.hooks.onSetStage.taps=e(i.graphicService.hooks.onSetStage.taps),i.graphicService.hooks.onRemove.taps=e(i.graphicService.hooks.onRemove.taps))}}var P=i(16049);class E{constructor(){this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=R.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t,this.dpr=P.w.global.devicePixelRatio,this.refresh()}refresh(){this._refreshByMediaQuery()||this._refreshByRaf()}_refreshByRaf(){let t=P.w.global.getRequestAnimationFrame();this.rafId=t(()=>{P.w.global.devicePixelRatio!==this.dpr&&(this.dpr=P.w.global.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0)),this.refresh()})}_refreshByMediaQuery(){try{let t=`(resolution: ${window.devicePixelRatio}dppx)`,e=()=>{window.devicePixelRatio!==this.dpr&&(this.dpr=window.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0))},i=matchMedia(t);i&&i.addEventListener("change",e),this.autoRefreshCbs||(this.autoRefreshCbs=[]),this.autoRefreshCbs.push(()=>{i&&i.removeEventListener("change",e)})}catch(t){return!1}return!0}deactivate(t){var e;let i=P.w.global.getCancelAnimationFrame();i&&this.rafId&&i(this.rafId),null==(e=this.autoRefreshCbs)||e.forEach(t=>{t()}),this.autoRefreshCbs=void 0}}class I{constructor(){this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=R.R.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t;let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.tap(this.key,(e,i,r)=>{e.glyphHost&&(e=e.glyphHost),e.stage===t.stage&&null!=e.stage&&(this.nextUserParams.startAtId=i._uid,this.renderNextFrame(i))}),e.graphicService.hooks.onClearIncremental.tap(this.key,(e,i)=>{e.stage===t.stage&&null!=e.stage&&(this.nextUserParams.startAtId=e._uid,this.nextUserParams.restartIncremental=!0,this.renderNextFrame(e))}))}deactivate(t){let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.taps=e.graphicService.hooks.onAddIncremental.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.onClearIncremental.taps=e.graphicService.hooks.onClearIncremental.taps.filter(t=>t.name!==this.key))}renderNextFrame(t){this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,P.w.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){let t=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach(e=>{let i=e.layer;if(!i||!e.layer.subLayers)return;let r=e.layer.subLayers.get(e._uid);r&&r.drawContribution&&r.drawContribution.draw(t.renderService,Object.assign({stage:t,layer:i,viewBox:t.window.getViewBox(),transMatrix:t.window.getViewBoxTransform(),clear:"transparent",renderService:t.renderService,updateBounds:!1,startAtId:e._uid,context:r.layer.getNativeHandler().getContext()},this.nextUserParams))}),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}let L=new n.FB;class F{constructor(){this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=R.R.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,t=>{t&&t===this.pluginService.stage&&t.dirtyBounds.clear()});let e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(t,e,i,r)=>{t.glyphHost&&(t=t.glyphHost),e&&e===this.pluginService.stage&&e.renderCount&&(t.isContainer&&!t.shouldSelfChangeUpdateAABBBounds()||i&&(L.setValue(r.x1,r.y1,r.x2,r.y2),e.dirty(L,t.parent&&t.parent.globalTransMatrix)))}),e.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(t,e,i,r,n)=>{e&&e===this.pluginService.stage&&e.renderCount&&(t.isContainer&&!n||e.dirty(r.globalAABBBounds))}),e.graphicService.hooks.clearAABBBounds.tap(this.key,(t,e,i)=>{e&&e===this.pluginService.stage&&e.renderCount&&e&&e.dirty(i)}),e.graphicService.hooks.onRemove.tap(this.key,t=>{let e=t.stage;e&&e===this.pluginService.stage&&e.renderCount&&e&&e.dirty(t.globalAABBBounds)}))}deactivate(t){let e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.taps=e.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.afterUpdateAABBBounds.taps=e.graphicService.hooks.afterUpdateAABBBounds.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.clearAABBBounds.taps=e.graphicService.hooks.clearAABBBounds.taps.filter(t=>t.name!==this.key),e.hooks.afterRender.taps=e.hooks.afterRender.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.onRemove.taps=e.graphicService.hooks.onRemove.taps.filter(t=>t.name!==this.key))}}var O=i(2079),D=i(58952),H=i(27865),z=i(9911),W=i(79314);let N={BACKGROUND:"white"};class j extends A.ZA{set viewBox(t){this.window.setViewBox(t)}get viewBox(){return this.window.getViewBox()}get x(){return this.window.getViewBox().x1}set x(t){let e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}get y(){return this.window.getViewBox().y1}set y(t){let e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}get width(){return this.window.width}set width(t){this.resize(t,this.height)}get viewWidth(){return this.window.getViewBox().width()}set viewWidth(t){this.resizeView(t,this.viewHeight)}get viewHeight(){return this.window.getViewBox().height()}set viewHeight(t){this.resizeView(this.viewWidth,t)}get height(){return this.window.height}set height(t){this.resize(this.width,t)}get dpr(){return this.window.dpr}set dpr(t){this.setDpr(t)}get background(){var t;return null!=(t=this._background)?t:N.BACKGROUND}set background(t){this._background=t}get defaultLayer(){return this.at(0)}get eventSystem(){return this._eventSystem}get ticker(){return this._ticker}set ticker(t){t.bindStage(this),this._ticker&&this._ticker.removeListener("tick",this.afterTickCb),t.addTimeline(this.timeline),this._ticker=t,this._ticker.on("tick",this.afterTickCb)}constructor(t={}){var e,i;super({}),this.tickedBeforeRender=!0,this._onVisibleChange=t=>{if(!(this._skipRender<0))if(t){if(this.dirtyBounds){let t=this.window.getViewBox();this.dirtyBounds.setValue(t.x1,t.y1,t.width(),t.height())}this._skipRender>1&&this.renderNextFrame(),this._skipRender=0}else this._skipRender=1},this.beforeRender=t=>{this._beforeRenderList.forEach(e=>e(t))},this.afterClearScreen=t=>{this._afterClearScreen&&this._afterClearScreen(t)},this.afterClearRect=t=>{this._afterClearRect&&this._afterClearRect(t)},this.afterRender=t=>{this.renderCount++,this._afterRenderList.forEach(e=>e(t)),this._afterNextRenderCbs&&this._afterNextRenderCbs.forEach(e=>e(t)),this._afterNextRenderCbs=null,this.tickedBeforeRender=!1},this.afterTickCb=()=>{this.tickedBeforeRender=!0,"rendering"!==this.state&&this.renderNextFrame()},this.params=t,this.theme=new M.Q2,this.hooks={beforeRender:new O.n(["stage"]),afterRender:new O.n(["stage"]),afterClearScreen:new O.n(["stage"]),afterClearRect:new O.n(["stage"])},this.global=P.w.global,!this.global.env&&(0,H.kP)()&&this.global.setEnv("browser"),this.window=w.n.get(l.Oo),this.renderService=w.n.get(S.p),this.pluginService=w.n.get(T.H),this.layerService=w.n.get(D.IT),this.graphicService=w.n.get(W.fB),this.pluginService.active(this,t),this._beforeRenderList=[],this._afterRenderList=[],this.window.create({width:t.width,height:t.height,viewBox:t.viewBox,container:t.container,dpr:t.dpr||this.global.devicePixelRatio,canvasControled:!1!==t.canvasControled,title:t.title||"",canvas:t.canvas}),this.state="normal",this.renderCount=0,this.tryInitEventSystem(),this._background=null!=(e=t.background)?e:N.BACKGROUND,this.appendChild(this.layerService.createLayer(this,{main:!0})),this.nextFrameRenderLayerSet=new Set,this.willNextFrameRender=!1,this.stage=this,this.renderStyle=t.renderStyle,t.autoRender&&this.enableAutoRender(),t.autoRefresh&&this.enableAutoRefresh(),!1===t.disableDirtyBounds&&this.enableDirtyBounds(),t.enableHtmlAttribute&&this.enableHtmlAttribute(t.enableHtmlAttribute),t.ReactDOM&&this.enableReactAttribute(t.ReactDOM),t.enableLayout&&this.enableLayout(),this.hooks.beforeRender.tap("constructor",this.beforeRender),this.hooks.afterRender.tap("constructor",this.afterRender),t.beforeRender&&this._beforeRenderList.push(t.beforeRender),t.afterRender&&this._afterRenderList.push(t.afterRender),this.hooks.afterClearScreen.tap("constructor",this.afterClearScreen),this.hooks.afterClearRect.tap("constructor",this.afterClearRect),this._afterClearScreen=t.afterClearScreen,this._afterClearRect=t.afterClearRect,this.supportInteractiveLayer=!1!==t.interactiveLayer,t.optimize||(t.optimize={tickRenderMode:"effect"}),this.optmize(t.optimize),t.background&&(0,r.Z)(this._background)&&this._background.includes("/")&&this.setAttributes({background:this._background}),this.initAnimate(t),this.rafId=null!=(i=t.rafId)?i:Math.floor(6*Math.random())}initAnimate(t){var e;this.createTicker&&this.createTimeline&&(this._ticker=t.ticker||this.createTicker(this),this._ticker.bindStage(this),"performance"===(null==(e=this.params.optimize)?void 0:e.tickRenderMode)&&this._ticker.setFPS(30),this.timeline=this.createTimeline(),this._ticker.addTimeline(this.timeline),this._ticker.on("tick",this.afterTickCb))}startAnimate(){this._ticker&&this.timeline&&(this._ticker.start(),this.timeline.resume())}pauseRender(t=-1){this._skipRender=t}resumeRender(){this._skipRender=0}tryInitEventSystem(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new C(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}preventRender(t){t?this._skipRender=-1/0:!1!==this.params.optimize.skipRenderWithOutRange?this._skipRender=+!this.window.isVisible():this._skipRender=0}optmize(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}optmizeRender(t=!1){t&&(this._skipRender=this._skipRender<0?this._skipRender:+!this.window.isVisible(),this.window.onVisibleChange(this._onVisibleChange))}getTimeline(){return this.timeline}get3dOptions(t){let{center:e={x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0},light:i={},alpha:r=0,beta:n=0,camera:s,fieldRatio:l=1,fieldDepth:a}=t;return Object.assign(Object.assign({},t),{center:e,light:i,alpha:r,beta:n,camera:s,fieldRatio:l,fieldDepth:a})}set3dOptions(t){var e,i,r,n,s,l;this.option3d=t;let{light:a,center:o,camera:h,alpha:u,beta:d,fieldRatio:c,fieldDepth:p}=this.get3dOptions(t),{dir:g=[1,1,-1],color:f="white",ambient:m}=a,y=(null!=(e=o.x)?e:this.width/2)+(null!=(i=o.dx)?i:0),v=(null!=(r=o.y)?r:this.height/2)+(null!=(n=o.dy)?n:0),b=[y,v,(null!=(s=o.z)?s:0)+(null!=(l=o.dz)?l:0)],_=0,x=0,C=0;h||(_=Math.sin(u)+y,x=Math.sin(d)+v,C=Math.cos(u)*Math.cos(d)*1);let w=z.F.getPlugin("DirectionalLight");w&&(this.light=new w(g,f,m));let S={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:c,fieldDepth:p,viewParams:{pos:[_,x,C],center:b,up:[0,1,0]}};if(this.camera)this.camera.params=S;else{let t=z.F.getPlugin("OrthoCamera");t&&(this.camera=new t(S))}t.enableView3dTransform&&this.enableView3dTransform()}setBeforeRender(t){this._beforeRenderList.push(t)}removeBeforeRender(t){this._beforeRenderList=this._beforeRenderList.filter(e=>e!==t)}setAfterRender(t){this._afterRenderList.push(t)}removeAfterRender(t){this._afterRenderList=this._afterRenderList.filter(e=>e!==t)}afterNextRender(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}enableView3dTransform(){if(this.view3dTranform)return;this.view3dTranform=!0;let t=z.F.getPlugin("ViewTransform3dPlugin");t&&this.pluginService.register(new t)}disableView3dTranform(){this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRender(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new B))}disableAutoRender(){this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRefresh(){this.autoRefresh||(this.autoRefresh=!0,this.pluginService.register(new E))}disableAutoRefresh(){this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableIncrementalAutoRender(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new I))}disableIncrementalAutoRender(){this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableDirtyBounds(){if(this.dirtyBounds)return;this.dirtyBounds=new n.YZ;let t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new F,this.pluginService.register(t))}disableDirtyBounds(){this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableLayout(){if(this._enableLayout)return;this._enableLayout=!0;let t=z.F.getPlugin("FlexLayoutPlugin");t&&this.pluginService.register(new t)}disableLayout(){this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableHtmlAttribute(t){if(this.htmlAttribute)return;let e=z.F.getPlugin("HtmlAttributePlugin");e&&(this.htmlAttribute=t,this.pluginService.register(new e))}disableHtmlAttribute(){this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableReactAttribute(t){if(this.reactAttribute)return;let e=z.F.getPlugin("ReactAttributePlugin");e&&(this.reactAttribute=t,this.pluginService.register(new e))}disableReactAttribute(){this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}getPluginsByName(t){return this.pluginService.findPluginsByName(t)}tryUpdateAABBBounds(){let t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}combineLayer(t,e){throw Error("暂不支持")}createLayer(t,e){if("released"===this.releaseStatus)return;let i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}sortLayer(t){let e=this.children;e.sort(t),this.removeAllChild(),e.forEach(t=>{this.appendChild(t)})}removeLayer(t){return this.removeChild(this.findChildByUid(t))}tryInitInteractiveLayer(){"released"!==this.releaseStatus&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}clearViewBox(t){this.window.clearViewBox(t)}render(t,e){if("released"===this.releaseStatus)return;this.startAnimate();let i=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}combineLayersToWindow(){if("harmony"===this.global.env){let t=this.window.getContext().nativeContext;this.forEachChildren((e,i)=>{if(i>0){let i=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(i)}})}}renderNextFrame(t,e){this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach(t=>{this.nextFrameRenderLayerSet.add(t)}),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getSpecifiedRequestAnimationFrame(this.rafId)(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){if("released"===this.releaseStatus)return;this.startAnimate();let t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}renderLayerList(t,e){let i=[];for(let e=0;e<t.length;e++){let r=t[e];"virtual"===r.layerMode&&(r=r.getNativeHandler().mainHandler.layer),i.includes(r)||i.push(r)}i.forEach(t=>{t.renderCount>this.renderCount||(t.renderCount=this.renderCount+1,t===this.interactiveLayer&&this.dirtyBounds&&this.dirtyBounds.clear(),t.render({renderService:this.renderService,background:t===this.defaultLayer?this.background:void 0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}resizeWindow(t,e,i=!0){this.window.resize(t,e),i&&this.render()}resize(t,e,i=!0){"released"!==this.releaseStatus&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren(i=>{i.resize(t,e)}),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render())}resizeView(t,e,i=!0){"released"!==this.releaseStatus&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren(i=>{i.resizeView(t,e)}),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render())}setViewBox(t,e,i,r,n){let s=!0;"object"==typeof t?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),!1===e&&(s=!1)):(this.viewBox.setValue(t,e,t+i,e+r),!1===n&&(s=!1)),this.forEachChildren(t=>{t.resizeView(this.viewBox.width(),this.viewBox.height())}),s&&this.render()}setDpr(t,e=!0){this.forEachChildren(e=>{e.setDpr(t)}),e&&this.render()}setOrigin(t,e){throw Error("暂不支持")}export(t){throw Error("暂不支持")}pick(t,e){if("released"===this.releaseStatus)return;let i=this.getPickerService().pick(this.children,new s.E9(t,e),{bounds:this.AABBBounds});return!(!(null==i?void 0:i.graphic)&&!(null==i?void 0:i.group))&&i}setToFrame(t){throw Error("暂不支持")}release(){var t,e;super.release(),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach(t=>{t.release()}),this.interactiveLayer&&(this.interactiveLayer.forEachChildren(t=>{t.setStage&&t.setStage(null,null),this.interactiveLayer.removeChild(t)}),this.interactiveLayer.release()),this.window.release(),null==(t=this._ticker)||t.remTimeline(null==this?void 0:this.timeline),null==(e=this._ticker)||e.removeListener("tick",this.afterTickCb),this.renderService.renderTreeRoots=[]}setStage(t){}dirty(t,e){"released"!==this.releaseStatus&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}getLayer(t){return this.children.filter(e=>e.name===t)[0]}renderTo(t){"released"!==this.releaseStatus&&this.forEachChildren((e,i)=>{e.drawTo(t,{renderService:this.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:e===this.defaultLayer?this.background:void 0,clear:0===i,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())})})}renderToNewWindow(t=!0,e){if("released"===this.releaseStatus)return;let i=w.n.get(l.Oo),r=e?-e.x1:0,n=e?-e.y1:0,s=e?e.x2:this.viewWidth,a=e?e.y2:this.viewHeight,o=e?e.width():this.viewWidth,h=e?e.height():this.viewHeight;return i.create({viewBox:{x1:r,y1:n,x2:s,y2:a},width:o,height:h,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(i),i}toCanvas(t=!0,e){if("released"===this.releaseStatus)return;let i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}setCursor(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}getCursor(){return this._cursor}eventPointTransform(t){let e=this.global.mapToCanvasPoint(t,this.window);return this.stage.window.pointTransform(e.x,e.y)}pauseTriggerEvent(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}resumeTriggerEvent(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}getPickerService(){return this.pickerService||(this.pickerService=w.n.get(k.hH)),this.pickerService}reInit(){this.renderService.reInit(),this.pickerService.reInit()}}},56488:function(t,e,i){"use strict";i.d(e,{Il:()=>c,Oo:()=>u,zd:()=>d});var r=i(26004),n=i(25258),s=i(40398),l=i(91018),a=i(2079),o=i(16049),h=i(99072);let u=Symbol.for("VWindow"),d=Symbol.for("WindowHandlerContribution"),c=class extends h.w{get width(){if(this._handler){let t=this._handler.getWH();return this._width=t.width}return this._width}get height(){if(this._handler){let t=this._handler.getWH();return this._height=t.height}return this._height}get dpr(){return this._handler.getDpr()}constructor(){super(),this.hooks={onChange:new a.n(["x","y","width","height"])},this.active=()=>{let t=this.global;t.env&&!this.actived&&(l.n.getNamed(d,t.env).configure(this,t),this.actived=!0)},this._uid=s.R.GenAutoIncrementId(),this.global=o.w.global,this.postInit()}_nativeAddEventListener(t,e,i){return this._handler.addEventListener(t,e,i)}_nativeRemoveEventListener(t,e,i){return this._handler.removeEventListener(t,e,i)}_nativeDispatchEvent(t){return this._handler.dispatchEvent(t)}postInit(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}get style(){var t;return null!=(t=this._handler.getStyle())?t:{}}set style(t){this._handler.setStyle(t)}create(t){var e,i;this._handler.createWindow(t);let r=this._handler.getWH();this._width=r.width,this._height=r.height,t.viewBox?this.setViewBox(t.viewBox):!1!==t.canvasControled?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:null!=(e=t.width)?e:this._width,y2:null!=(i=t.height)?i:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}setWindowHandler(t){this._handler=t}setDpr(t){return this._handler.setDpr(t)}resize(t,e){return this._handler.resizeWindow(t,e)}configure(){throw Error("暂不支持")}release(){return this.global.hooks.onSetEnv.unTap("window",this.active),this.clearAllEventListeners(),this._handler.releaseWindow()}getContext(){return this._handler.getContext()}getNativeHandler(){return this._handler.getNativeHandler()}getImageBuffer(t){return this._handler.getImageBuffer?this._handler.getImageBuffer(t):null}getBoundingClientRect(){return this._handler.getBoundingClientRect()}getContainer(){return this._handler.container}clearViewBox(t){this._handler.clearViewBox(t)}setViewBox(t){this._handler.setViewBox(t)}setViewBoxTransform(t,e,i,r,n,s){this._handler.setViewBoxTransform(t,e,i,r,n,s)}getViewBox(){return this._handler.getViewBox()}getViewBoxTransform(){return this._handler.getViewBoxTransform()}pointTransform(t,e){let i=this._handler.getViewBox(),r={x:t,y:e};return this._handler.getViewBoxTransform().transformPoint({x:t,y:e},r),r.x-=i.x1,r.y-=i.y1,r}hasSubView(){let t=this._handler.getViewBox();return!(0===t.x1&&0===t.y1&&(0,n.Yt)(this.width,t.width())&&(0,n.Yt)(this.height,t.height()))}isVisible(t){return this._handler.isVisible(t)}onVisibleChange(t){return this._handler.onVisibleChange(t)}getTopLeft(t){return this._handler.getTopLeft(t)}};c=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,r.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],c)},27865:function(t,e,i){"use strict";let r;i.d(e,{KV:()=>a,kP:()=>l});var n=i(16049);function s(){if(null==r)try{let t=document.createElement("canvas"),e=t.getContext("2d");(r=!!(window&&t.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&e&&e.isPointInPath&&e.isPointInStroke))&&(r=!!document.createElement)}catch(t){r=!1}}function l(){s();let t=n.w.global&&n.w.global.env;return t?"browser"===t:r}function a(){s();let t=n.w.global&&n.w.global.env;return t?"node"===t:!r}},12895:function(t,e,i){"use strict";i.d(e,{g:()=>r});let r="*"},10693:function(t,e,i){"use strict";i.d(e,{x:()=>n});var r=i(98116);class n{get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get x(){return this.canvas.x}get y(){return this.canvas.y}get canvasX(){return this.canvas.x}get canvasY(){return this.canvas.y}get viewX(){return this.viewport.x}get viewY(){return this.viewport.y}constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=n.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}composedDetailPath(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}_composedDetailPath(t){if(t&&t.graphic){let e=t.graphic;if(e.stage){let i=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(i),this._composedDetailPath(t.params)}}}preventDefault(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch(t){this.nativeEvent.preventDefault&&(0,r.Z)(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch(t){this.nativeEvent.stopPropagation&&(0,r.Z)(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}initEvent(){}initUIEvent(){}clone(){throw Error("Method not implemented.")}}},60981:function(t,e,i){"use strict";i.d(e,{A:()=>n});var r=i(10693);class n extends r.x{constructor(t,e){super(),this.type=t,this.detail=e}}},61963:function(t,e,i){"use strict";i.d(e,{m:()=>r});let r="object"==typeof performance&&performance.now?performance:Date},9911:function(t,e,i){"use strict";i.d(e,{F:()=>r});class r{static registerPlugin(t,e){r._pluginClasses[t]=e}static getPlugin(t){return r._pluginClasses[t]}}r._pluginClasses={}},41035:function(t,e,i){"use strict";i.d(e,{Q:()=>m,w:()=>f});var r=i(45273),n=i(31535),s=i(98706),l=i(88504),a=i(26670),o=i(33974),h=i(70749),u=i(4062),d=i(16049),c=i(79314),p=i(1544);let g=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap",...a.DH];class f extends a.zs{constructor(t){super(t),this.type="arc",this.numberType=c.r_}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{startAngle:t,endAngle:e,outerRadius:i,innerRadius:r}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)&&this._validNumber(r)}getParsedCornerRadius(){let t=this.getGraphicTheme(),{cornerRadius:e=t.cornerRadius,innerPadding:i=t.innerPadding,outerPadding:s=t.outerPadding}=this.attribute,{outerRadius:l=t.outerRadius,innerRadius:a=t.innerRadius}=this.attribute;if(l+=s,a-=i,0===e||"0%"===e)return 0;let o=Math.abs(l-a),h=t=>Math.min((0,r.Z)(t,!0)?t:o*parseFloat(t)/100,o/2);if((0,n.Z)(e)){let t=e.map(t=>h(t)||0);return 0===t.length?[t[0],t[0],t[0],t[0]]:2===t.length?[t[0],t[1],t[0],t[1]]:(3===t.length&&t.push(0),t)}return h(e)}getParsedAngle(){let t=this.getGraphicTheme(),{startAngle:e=t.startAngle,endAngle:i=t.endAngle}=this.attribute,{cap:r=t.cap}=this.attribute,n=i-e>=0?1:-1,a=i-e;if(i=(e=(0,s.gt)(e))+a,r&&(0,l.Wn)(a)<l.f7-l.Ho){let s=1,a=1;r.length&&(s=Number(r[0]),a=Number(r[1]));let{outerRadius:o=t.outerRadius,innerRadius:h=t.innerRadius}=this.attribute,{outerPadding:u=t.outerPadding,innerPadding:d=t.innerPadding}=this.attribute,c=Math.abs((o+=u)-(h-=d))/2,p=c/o;if(c>l.Ho&&o>l.Ho)return{startAngle:e-n*p*s,endAngle:i+n*p*a,sc:n*p*s,ec:n*p*a}}return{startAngle:e,endAngle:i}}getParsePadAngle(t,e){let i=this.getGraphicTheme(),{innerPadding:r=i.innerPadding,outerPadding:n=i.outerPadding,padAngle:s=i.padAngle}=this.attribute,{outerRadius:a=i.outerRadius,innerRadius:o=i.innerRadius}=this.attribute;a+=n,o-=r;let{padRadius:h=(0,l._b)(a*a+o*o)}=this.attribute,u=(0,l.Wn)(e-t),d=t,c=e,p=t,g=e,f=s/2,m=u,y=u;if(f>l.Ho&&h>l.Ho){let i=e>t?1:-1,r=(0,l.ZR)(Number(h)/o*(0,l.O$)(f)),n=(0,l.ZR)(Number(h)/a*(0,l.O$)(f));return(m-=2*r)>l.Ho?(r*=i,p+=r,g-=r):(m=0,p=g=(t+e)/2),(y-=2*n)>l.Ho?(n*=i,d+=n,c-=n):(y=0,d=c=(t+e)/2),{outerStartAngle:d,outerEndAngle:c,innerStartAngle:p,innerEndAngle:g,innerDeltaAngle:m,outerDeltaAngle:y}}return{outerStartAngle:d,outerEndAngle:c,innerStartAngle:p,innerEndAngle:g,innerDeltaAngle:m,outerDeltaAngle:y}}getGraphicTheme(){return(0,u.gh)(this).arc}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateArcAABBBoundsImprecise(t,e,i):this.updateArcAABBBoundsAccurate(t,e,i));let{tb1:n,tb2:s}=d.w.graphicService.updateTempAABBBounds(i);(0,p.E)(t,e,n),i.union(n),n.setValue(s.x1,s.y1,s.x2,s.y2),this.setWidthHeightWithoutTransform(i);let{lineJoin:l=e.lineJoin}=t;return d.w.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}updateArcAABBBoundsImprecise(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:n=e.innerRadius}=t,{outerPadding:s=e.outerPadding,innerPadding:l=e.innerPadding}=t;return(r+=s)<(n-=l)&&(r=n),i.set(-r,-r,r,r),i}updateArcAABBBoundsAccurate(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:n=e.innerRadius}=t,{outerPadding:s=e.outerPadding,innerPadding:a=e.innerPadding}=t;if((r+=s)<(n-=a)){let t=r;r=n,n=t}let{endAngle:o=e.endAngle,startAngle:u=e.startAngle}=t;if(u>o){let t=u;u=o,o=t}return r<=l.Ho?i.set(0,0,0,0):Math.abs(o-u)>l.f7-l.Ho?i.set(-r,-r,r,r):((0,h.jx)(u,o,r,i),(0,h.jx)(u,o,n,i)),i}needUpdateTags(t){return super.needUpdateTags(t,g)}needUpdateTag(t){return super.needUpdateTag(t,g)}toCustomPath(){var t,e,i,r;let n=super.toCustomPath();if(n)return n;let s=this.attribute,{startAngle:a,endAngle:h}=this.getParsedAngle(),u=(null!=(t=s.innerRadius)?t:0)-(null!=(e=s.innerPadding)?e:0),d=(null!=(i=s.outerRadius)?i:0)-(null!=(r=s.outerPadding)?r:0),c=(0,l.Wn)(h-a),p=h>a;if(d<u){let t=d;d=u,u=t}if(n=new o.r,d<=l.Ho)n.moveTo(0,0);else if(c>=l.f7-l.Ho)n.moveTo(0+d*(0,l.mC)(a),0+d*(0,l.O$)(a)),n.arc(0,0,d,a,h,!p),u>l.Ho&&(n.moveTo(0+u*(0,l.mC)(h),0+u*(0,l.O$)(h)),n.arc(0,0,u,h,a,p));else{let t=d*(0,l.mC)(a),e=d*(0,l.O$)(a),i=u*(0,l.mC)(h),r=u*(0,l.O$)(h);n.moveTo(0+t,0+e),n.arc(0,0,d,a,h,!p),n.lineTo(0+i,0+r),n.arc(0,0,u,h,a,p),n.closePath()}return n}clone(){return new f(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return f.NOWORK_ANIMATE_ATTR}}function m(t){return new f(t)}f.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},a.Wl)},25496:function(t,e,i){"use strict";let r,n;i.d(e,{X:()=>a,o:()=>l});var s=i(45011);function l(t){return r||(r=s.i.CreateGraphic("text",{})),r.initAttributes(t),r.AABBBounds}function a(t){return n||(n=s.i.CreateGraphic("richtext",{})),n.setAttributes(t),n.AABBBounds}},13342:function(t,e,i){"use strict";i.d(e,{g6:()=>tl,SR:()=>ta});var r=i(88504),n=i(45273);class s{bounds(t,e){if((0,n.Z)(t)){let i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}parseSize(t){return(0,n.Z)(t)?t:Math.min(t[0],t[1])}}function l(t,e,i,n,s){return s?t.arc(i,n,e,0,r.BZ,!1,s):t.arc(i,n,e,0,r.BZ),!1}let a=new class extends s{constructor(){super(...arguments),this.type="circle",this.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0"}draw(t,e,i,r,n){return l(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,s){return l(t,this.parseSize(e)/2+n,i,r,s)}drawToSvgPath(t,e,i,r){let n=this.parseSize(t)/2;return`M ${e-n}, ${i} a ${n},${n} 0 1,0 ${2*n},0 a ${n},${n} 0 1,0 -${2*n},0`}},o=new class extends s{constructor(){super(...arguments),this.type="cross",this.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z"}draw(t,e,i,r,n){var s;return s=this.parseSize(e)/6,t.moveTo(-3*s+i,-s+r,n),t.lineTo(-s+i,-s+r,n),t.lineTo(-s+i,-3*s+r,n),t.lineTo(s+i,-3*s+r,n),t.lineTo(s+i,-s+r,n),t.lineTo(3*s+i,-s+r,n),t.lineTo(3*s+i,s+r,n),t.lineTo(s+i,s+r,n),t.lineTo(s+i,3*s+r,n),t.lineTo(-s+i,3*s+r,n),t.lineTo(-s+i,s+r,n),t.lineTo(-3*s+i,s+r,n),t.closePath(),!0}drawOffset(t,e,i,r,n,s){var l;return l=this.parseSize(e)/6,t.moveTo(-3*l+i-n,-l+r-n,s),t.lineTo(-l+i-n,-l+r-n,s),t.lineTo(-l+i-n,-3*l+r-n,s),t.lineTo(l+i+n,-3*l+r-n,s),t.lineTo(l+i+n,-l+r-n,s),t.lineTo(3*l+i+n,-l+r-n,s),t.lineTo(3*l+i+n,l+r+n,s),t.lineTo(l+i+n,l+r+n,s),t.lineTo(l+i+n,3*l+r+n,s),t.lineTo(-l+i-n,3*l+r+n,s),t.lineTo(-l+i-n,l+r+n,s),t.lineTo(-3*l+i-n,l+r+n,s),t.closePath(),!0}};function h(t,e,i,r,n){return t.moveTo(i,r-e,n),t.lineTo(e+i,r,n),t.lineTo(i,r+e,n),t.lineTo(i-e,r,n),t.closePath(),!0}let u=new class extends s{constructor(){super(...arguments),this.type="diamond",this.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z"}draw(t,e,i,r,n){return h(t,this.parseSize(e)/2,i,r,n)}drawFitDir(t,e,i,r,n){return h(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,s){return h(t,this.parseSize(e)/2+n,i,r,s)}};function d(t,e,i,r){let n=2*e;return t.rect(i-e,r-e,n,n),!1}let c=new class extends s{constructor(){super(...arguments),this.type="square",this.pathStr="M-0.5,-0.5h1v1h-1Z"}draw(t,e,i,r){return d(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return d(t,this.parseSize(e)/2+n,i,r)}};function p(t,e,i,r,n=0){return t.moveTo(i+e+2*n,e+r+n),t.lineTo(i-e-2*n,e+r+n),t.lineTo(i,r-e-2*n),t.closePath(),!0}class g extends s{constructor(){super(...arguments),this.type="triangleUp",this.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z"}draw(t,e,i,r){return p(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return p(t,this.parseSize(e)/2,i,r,n)}}let f=new g,m=new class extends g{constructor(){super(...arguments),this.type="triangle"}},y=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),v=Math.sin(r.BZ/10)*y,b=-Math.cos(r.BZ/10)*y;function _(t,e,i,n){let s=v*e,l=b*e;t.moveTo(i,-e+n),t.lineTo(s+i,l+n);for(let a=1;a<5;++a){let o=r.BZ*a/5,h=Math.cos(o),u=Math.sin(o);t.lineTo(u*e+i,-h*e+n),t.lineTo(h*s-u*l+i,u*s+h*l+n)}return t.closePath(),!0}let x=new class extends s{constructor(){super(...arguments),this.type="star",this.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z"}draw(t,e,i,r){return _(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return _(t,this.parseSize(e)/2+n,i,r)}},C=(0,r._b)(3);function w(t,e,i,r){let n=e/C,s=n/5;return t.moveTo(0+i,-e+r),t.lineTo(n/2+i,r),t.lineTo(s/2+i,r),t.lineTo(s/2+i,e+r),t.lineTo(-s/2+i,e+r),t.lineTo(-s/2+i,r),t.lineTo(-n/2+i,r),t.closePath(),!0}let S=new class extends s{constructor(){super(...arguments),this.type="arrow",this.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z"}draw(t,e,i,r){return w(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return w(t,this.parseSize(e)/2+n,i,r)}};function A(t,e,i,r){let n=2*e;return t.moveTo(i,-e+r),t.lineTo(n/3/2+i,e+r),t.lineTo(-n/3/2+i,e+r),t.closePath(),!0}let M=new class extends s{constructor(){super(...arguments),this.type="wedge",this.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z"}draw(t,e,i,r){return A(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return A(t,this.parseSize(e)/2+n,i,r)}};function k(t,e,i,r){return t.moveTo(-e+i,r),t.lineTo(i,e+r),!1}let T=new class extends s{constructor(){super(...arguments),this.type="stroke",this.pathStr=""}draw(t,e,i,r){return k(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return k(t,this.parseSize(e)/2+n,i,r)}},R=(0,r._b)(3)/2,B=1/(0,r._b)(12);function P(t,e,i,r){let n=e/2,s=e*B,l=e*B+e,a=-n;return t.moveTo(n+i,s+r),t.lineTo(n+i,l+r),t.lineTo(a+i,l+r),t.lineTo(-.5*n-R*s+i,R*n+-.5*s+r),t.lineTo(-.5*n-R*l+i,R*n+-.5*l+r),t.lineTo(-.5*a-R*l+i,R*a+-.5*l+r),t.lineTo(-.5*n+R*s+i,-.5*s-R*n+r),t.lineTo(-.5*n+R*l+i,-.5*l-R*n+r),t.lineTo(-.5*a+R*l+i,-.5*l-R*a+r),t.closePath(),!1}let E=new class extends s{constructor(){super(...arguments),this.type="wye",this.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z"}draw(t,e,i,r){return P(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return P(t,this.parseSize(e)/2+n,i,r)}};function I(t,e,i,r,n){return t.moveTo(-e+i-2*n,r),t.lineTo(e+i+n,e+r+2*n),t.lineTo(e+i+n,r-e-2*n),t.closePath(),!0}let L=new class extends s{constructor(){super(...arguments),this.type="triangleLeft",this.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z"}draw(t,e,i,r){return I(t,this.parseSize(e)/2,i,r,0)}drawOffset(t,e,i,r,n){return I(t,this.parseSize(e)/2,i,r,n)}};function F(t,e,i,r,n=0){return t.moveTo(i-e-n,e+r+2*n),t.lineTo(e+i+2*n,r),t.lineTo(i-e-n,r-e-2*n),t.closePath(),!0}let O=new class extends s{constructor(){super(...arguments),this.type="triangleRight",this.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z"}draw(t,e,i,r){return F(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return F(t,this.parseSize(e)/2,i,r,n)}};function D(t,e,i,r,n=0){return t.moveTo(i-e-2*n,r-e-n),t.lineTo(i+e+2*n,r-e-n),t.lineTo(i,r+e+2*n),t.closePath(),!0}let H=new class extends s{constructor(){super(...arguments),this.type="triangleDown",this.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z"}draw(t,e,i,r){return D(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return D(t,this.parseSize(e)/2,i,r,n)}},z=(0,r._b)(3);function W(t,e,i,r){let n=e*z;return t.moveTo(i,r+-n/3*2),t.lineTo(e+i,r+n),t.lineTo(i-e,r+n),t.closePath(),!0}let N=new class extends s{constructor(){super(...arguments),this.type="thinTriangle",this.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z"}draw(t,e,i,r){return W(t,this.parseSize(e)/2/z,i,r)}drawOffset(t,e,i,r,n){return W(t,this.parseSize(e)/2/z+n,i,r)}};function j(t,e,i,r){let n=2*e;return t.moveTo(e+i,r-n),t.lineTo(i-e,r),t.lineTo(e+i,n+r),!0}let G=new class extends s{constructor(){super(...arguments),this.type="arrow2Left",this.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5"}draw(t,e,i,r){return j(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,n){return j(t,this.parseSize(e)/4+n,i,r)}};function V(t,e,i,r){let n=2*e;return t.moveTo(i-e,r-n),t.lineTo(i+e,r),t.lineTo(i-e,n+r),!0}let Z=new class extends s{constructor(){super(...arguments),this.type="arrow2Right",this.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5"}draw(t,e,i,r){return V(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,n){return V(t,this.parseSize(e)/4+n,i,r)}};function U(t,e,i,r){let n=2*e;return t.moveTo(i-n,r+e),t.lineTo(i,r-e),t.lineTo(i+n,r+e),!0}let K=new class extends s{constructor(){super(...arguments),this.type="arrow2Up",this.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25"}draw(t,e,i,r){return U(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,n){return U(t,this.parseSize(e)/4+n,i,r)}};function $(t,e,i,r){let n=2*e;return t.moveTo(i-n,r-e),t.lineTo(i,r+e),t.lineTo(i+n,r-e),!0}let Y=new class extends s{constructor(){super(...arguments),this.type="arrow2Down",this.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25"}draw(t,e,i,r){return $(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,n){return $(t,this.parseSize(e)/4+n,i,r)}};function X(t,e,i,r,n){return t.moveTo(i,r-e),t.lineTo(i,r+e),!0}let q=new class extends s{constructor(){super(...arguments),this.type="lineV",this.pathStr="M0,-0.5L0,0.5"}draw(t,e,i,r,n){return X(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,s){return X(t,this.parseSize(e)/2+n,i,r,s)}drawToSvgPath(t,e,i,r){let n=this.parseSize(t)/2;return`M ${e}, ${i-n} L ${e},${i+n}`}};function J(t,e,i,r,n){return t.moveTo(i-e,r),t.lineTo(i+e,r),!0}let Q=new class extends s{constructor(){super(...arguments),this.type="lineH",this.pathStr="M-0.5,0L0.5,0"}draw(t,e,i,r,n){return J(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,s){return J(t,this.parseSize(e)/2+n,i,r,s)}drawToSvgPath(t,e,i,r){let n=this.parseSize(t)/2;return`M ${e-n}, ${i} L ${e+n},${i}`}};function te(t,e,i,r,n){return t.moveTo(i-e,r-e),t.lineTo(i+e,r+e),t.moveTo(i+e,r-e),t.lineTo(i-e,r+e),!0}let ti=new class extends s{constructor(){super(...arguments),this.type="close",this.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5"}draw(t,e,i,r,n){return te(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,s){return te(t,this.parseSize(e)/2+n,i,r,s)}drawToSvgPath(t,e,i,r){let n=this.parseSize(t)/2;return`M ${e-n}, ${i-n} L ${e+n},${i+n} M ${e+n}, ${i-n} L ${e-n},${i+n}`}};function tr(t,e,i,r){return t.rect(i-e[0]/2,r-e[1]/2,e[0],e[1]),!1}function tn(t,e,i,r){let n=e/2;return t.rect(i-e/2,r-n/2,e,n),!1}let ts=new class extends s{constructor(){super(...arguments),this.type="rect",this.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z"}draw(t,e,i,r){return(0,n.Z)(e)?tn(t,e,i,r):tr(t,e,i,r)}drawWithClipRange(t,e,i,r,s,l,a){(0,n.Z)(e)&&(e=[e,e/2]);let o=2*(e[0]+e[1])*s,h=[{x:i+e[0]/2,y:r-e[1]/2},{x:i+e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r-e[1]/2}],u=0,d=h[3];t.moveTo(d.x,d.y);for(let e=0;e<h.length;e++){let i=h[e],r=Math.sqrt((i.x-d.x)*(i.x-d.x)+(i.y-d.y)*(i.y-d.y));if(u+r>o){let e=(i.x-d.x)*(o-u)/r,n=(i.y-d.y)*(o-u)/r;t.lineTo(d.x+e,d.y+n);break}t.lineTo(i.x,i.y),d=i,u+=r}return!1}drawOffset(t,e,i,r,s){return(0,n.Z)(e)?tn(t,e+2*s,i,r):tr(t,[e[0]+2*s,e[1]+2*s],i,r)}},tl={};[a,o,u,c,N,m,x,S,M,T,E,L,O,f,H,G,Z,K,Y,ts,q,Q,ti].forEach(t=>{tl[t.type]=t});let ta={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"}},11089:function(t,e,i){"use strict";i.d(e,{C:()=>c,y:()=>p});var r=i(88504),n=i(26670),s=i(33974),l=i(70749),a=i(4062),o=i(16049),h=i(79314),u=i(1544);let d=["radius","startAngle","endAngle",...n.DH];class c extends n.zs{constructor(t={radius:1}){super(t),this.type="circle",this.numberType=h.Aw}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{startAngle:t,endAngle:e,radius:i}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)}getGraphicTheme(){return(0,a.gh)(this).circle}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateCircleAABBBoundsImprecise(t,e,i):this.updateCircleAABBBoundsAccurate(t,e,i));let{tb1:n,tb2:s}=o.w.graphicService.updateTempAABBBounds(i);return(0,u.E)(t,e,n),i.union(n),n.setValue(s.x1,s.y1,s.x2,s.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,o.w.graphicService.transformAABBBounds(t,i,e,!1,this),i}updateCircleAABBBoundsImprecise(t,e,i){let{radius:r=e.radius}=t;return i.set(-r,-r,r,r),i}updateCircleAABBBoundsAccurate(t,e,i){let{startAngle:n=e.startAngle,endAngle:s=e.endAngle,radius:a=e.radius}=t;return s-n>r.f7-r.Ho?i.set(-a,-a,a,a):(0,l.jx)(n,s,a,i),i}needUpdateTags(t){return super.needUpdateTags(t,d)}needUpdateTag(t){return super.needUpdateTag(t,d)}toCustomPath(){var t,e,i;let r=super.toCustomPath();if(r)return r;let n=this.attribute,l=null!=(t=n.radius)?t:this.getDefaultAttribute("radius"),a=null!=(e=n.startAngle)?e:this.getDefaultAttribute("startAngle"),o=null!=(i=n.endAngle)?i:this.getDefaultAttribute("endAngle");return(r=new s.r).arc(0,0,l,a,o),r}clone(){return new c(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return c.NOWORK_ANIMATE_ATTR}}function p(t){return new c(t)}c.NOWORK_ANIMATE_ATTR=n.Wl},36081:function(t,e,i){"use strict";i.d(e,{F1:()=>o,Iq:()=>T,J7:()=>C,T5:()=>k,Up:()=>m,VF:()=>S,WC:()=>d,YW:()=>B,ZD:()=>w,bZ:()=>b,e9:()=>_,eh:()=>y,h8:()=>x,jK:()=>R,kx:()=>A,pp:()=>h,q9:()=>c,t8:()=>v,th:()=>M,xF:()=>f});var r=i(8992),n=i(88504),s=i(30943),l=i(33974),a=i(32623);let o={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new r.y},h={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},u={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},d=Object.assign({outerBorder:Object.assign(Object.assign({},u),{distance:0}),innerBorder:Object.assign(Object.assign({},u),{distance:0})},u),c={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:"PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,\n    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",fontWeight:"",ellipsis:"…",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:a.r.fontBounding,keepCenterInLine:!1},p=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,autoAnimateTexture:!1,textureRatio:1,textureOptions:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,backgroundKeepAspectRatio:!1,backgroundClip:!0,backgroundScale:1,backgroundOffsetX:0,backgroundOffsetY:0,blur:0,filter:"",cursor:null,html:null,react:null,vue:null},h),d),{alignSelf:"auto"}),{pickStrokeBuffer:0}),g={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},f=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1,clipConfig:null,roughStyle:null},{_debug_bounds:!1}),p),o),m=Object.assign(Object.assign({},f),{startAngle:0,endAngle:n.f7,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),y=Object.assign(Object.assign(Object.assign({},f),g),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),v=Object.assign(Object.assign({},f),{radius:1,startAngle:0,endAngle:n.f7}),b=Object.assign(Object.assign({},f),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1,cornerType:"round"}),_=Object.assign(Object.assign({},f),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),x=Object.assign(Object.assign(Object.assign({},f),g),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),C=Object.assign(Object.assign({},f),{path:new l.r,fillStrokeOrder:1,clipRange:1,customPath:()=>{s.Y.getInstance().warn("空函数")}}),w=Object.assign(Object.assign({},f),{points:[],cornerRadius:0,closePath:!0}),S=Object.assign(Object.assign({},f),{width:100,height:100,spikes:5,thickness:.5}),A=Object.assign(Object.assign({},f),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0,cornerType:"round",drawStrokeWhenZeroWH:!1});Object.assign(Object.assign({},f),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0,cornerType:"round",drawStrokeWhenZeroWH:!1});let M=Object.assign(Object.assign({},f),{symbolType:"circle",size:10,keepDirIn3d:!0,clipRange:1}),k=Object.assign(Object.assign(Object.assign({},f),c),{strokeBoundsBuffer:0,keepDirIn3d:!0}),T=Object.assign(Object.assign(Object.assign({},f),c),{upgradeAttrs:null,editable:!1,editOptions:null,ascentDescentMode:"actual",width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),R=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0,maxWidth:500,maxHeight:500},f),{fill:!0,cornerRadius:0,cornerType:"round"}),B=Object.assign(Object.assign({},R),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1})},79314:function(t,e,i){"use strict";i.d(e,{$M:()=>f,Aw:()=>a,B5:()=>m,Hf:()=>d,IJ:()=>s,IO:()=>_,I_:()=>h,Kh:()=>p,Lo:()=>x,Nd:()=>o,PN:()=>u,Ri:()=>l,Us:()=>y,_u:()=>g,fB:()=>v,qm:()=>c,r_:()=>n,tA:()=>b});var r=i(72790);let n=(0,r.Gg)(),s=(0,r.Gg)(),l=(0,r.Gg)(),a=(0,r.Gg)(),o=(0,r.Gg)(),h=(0,r.Gg)(),u=(0,r.Gg)(),d=(0,r.Gg)(),c=(0,r.Gg)(),p=(0,r.Gg)();(0,r.Gg)();let g=(0,r.Gg)();(0,r.Gg)();let f=(0,r.Gg)();(0,r.Gg)();let m=(0,r.Gg)(),y=(0,r.Gg)(),v=Symbol.for("GraphicService"),b=Symbol.for("GraphicCreator"),_={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},x=Object.keys(_)},45011:function(t,e,i){"use strict";i.d(e,{i:()=>r});let r=new class{constructor(){this.store=new Map}RegisterGraphicCreator(t,e){this.store.set(t,e),this[t]=e}CreateGraphic(t,e){let i=this.store.get(t);return i?i(e):null}}},1544:function(t,e,i){"use strict";i.d(e,{E:()=>r});let r=(t,e,i)=>{let{outerBorder:r,shadowBlur:n=e.shadowBlur}=t;if(r){let t=e.outerBorder,{distance:s=t.distance,lineWidth:l=t.lineWidth}=r;i.expand(s+(n+l)/2)}return i}},91509:function(t,e,i){"use strict";i.d(e,{JG:()=>v,M_:()=>y,RT:()=>m});var r,n=i(26004),s=i(47061),l=i(76620),a=i(45273),o=i(2079),h=i(38939),u=i(72790),d=i(60504),c=i(43291),p=i(23603),g=i(79314),f=i(4484);function m(t,e,i){var r;let{x:n=i.x,y:s=i.y,z:l=i.z,dx:a=i.dx,dy:o=i.dy,dz:h=i.dz,scaleX:u=i.scaleX,scaleY:c=i.scaleY,scaleZ:p=i.scaleZ,alpha:g=i.alpha,beta:m=i.beta,angle:y=i.angle,anchor3d:v=e.attribute.anchor,anchor:b}=e.attribute,_=[0,0,0];if(v){if("string"==typeof v[0]){let t=parseFloat(v[0])/100,i=e.AABBBounds;_[0]=i.x1+(i.x2-i.x1)*t}else _[0]=v[0];if("string"==typeof v[1]){let t=parseFloat(v[1])/100,i=e.AABBBounds;_[1]=i.x1+(i.x2-i.x1)*t}else _[1]=v[1];_[2]=null!=(r=v[2])?r:0}if((0,f.TL)(t),(0,f.Iu)(t,t,[n+a,s+o,l+h]),(0,f.Iu)(t,t,[_[0],_[1],_[2]]),(0,f.lM)(t,t,m),(0,f.uD)(t,t,g),(0,f.Iu)(t,t,[-_[0],-_[1],_[2]]),(0,f.mN)(t,t,[u,c,p]),y){let i=d.yp.allocate(),r=[0,0];if(b){if("string"==typeof v[0]){let t=parseFloat(v[0])/100,i=e.AABBBounds;r[0]=i.x1+(i.x2-i.x1)*t}else r[0]=v[0];if("string"==typeof v[1]){let t=parseFloat(v[1])/100,i=e.AABBBounds;r[1]=i.x1+(i.x2-i.x1)*t}else r[1]=v[1]}(0,f.Iu)(i,i,[r[0],r[1],0]),(0,f.jI)(i,i,y),(0,f.Iu)(i,i,[-r[0],-r[1],0]),(0,f.G9)(t,t,i)}}function y(t){let{alpha:e,beta:i}=t.attribute;return e||i}let v=class{constructor(t){this.creator=t,this.hooks={onAttributeUpdate:new o.n(["graphic"]),onSetStage:new o.n(["graphic","stage"]),onRemove:new o.n(["graphic"]),onRelease:new o.n(["graphic"]),onAddIncremental:new o.n(["graphic","group","stage"]),onClearIncremental:new o.n(["graphic","group","stage"]),beforeUpdateAABBBounds:new o.n(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new o.n(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new o.n(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new l.FB,this.tempAABBBounds2=new l.FB}onAttributeUpdate(t){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(t)}onSetStage(t,e){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(t,e)}onRemove(t){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(t)}onRelease(t){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(t)}onAddIncremental(t,e,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(t,e,i)}onClearIncremental(t,e){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(t,e)}beforeUpdateAABBBounds(t,e,i,r){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(t,e,i,r)}afterUpdateAABBBounds(t,e,i,r,n){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(t,e,i,r,n)}clearAABBBounds(t,e,i){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(t,e,i)}updatePathProxyAABBBounds(t,e){let i="function"==typeof e.pathProxy?e.pathProxy(e.attribute):e.pathProxy;if(!i)return!1;let r=new c.C(t);return(0,p.h)(i.commandList,r,0,0),!0}updateHTMLTextAABBBounds(t,e,i,r){let{textAlign:n,textBaseline:s}=t;if(null!=t.forceBoundsHeight){let e=(0,a.Z)(t.forceBoundsHeight)?t.forceBoundsHeight:t.forceBoundsHeight(),r=(0,h.nV)(s,e,e);i.set(i.x1,r,i.x2,r+e)}if(null!=t.forceBoundsWidth){let e=(0,a.Z)(t.forceBoundsWidth)?t.forceBoundsWidth:t.forceBoundsWidth(),r=(0,h.js)(n,e);i.set(r,i.y1,r+e,i.y2)}}combindShadowAABBBounds(t,e){if(e&&e.shadowRoot){let i=e.shadowRoot.AABBBounds;t.union(i)}}transformAABBBounds(t,e,i,r,n){if(!e.empty()){let{scaleX:n=i.scaleX,scaleY:s=i.scaleY,stroke:l=i.stroke,shadowBlur:a=i.shadowBlur,lineWidth:o=i.lineWidth,pickStrokeBuffer:h=i.pickStrokeBuffer,strokeBoundsBuffer:d=i.strokeBoundsBuffer}=t,c=this.tempAABBBounds1,p=this.tempAABBBounds2;if(l&&o){let t=(o+h)/Math.abs(n+s);(0,u.ph)(c,t,r,d),e.union(c),c.setValue(p.x1,p.y1,p.x2,p.y2)}if(a){let{shadowOffsetX:r=i.shadowOffsetX,shadowOffsetY:l=i.shadowOffsetY}=t,o=a/Math.abs(n+s)*2;(0,u.ph)(c,o,!1,d+1),c.translate(r,l),e.union(c)}}if(this.combindShadowAABBBounds(e,n),e.empty())return;let s=!0,a=n.transMatrix;n&&n.isContainer&&(s=1!==a.a||0!==a.b||0!==a.c||1!==a.d||0!==a.e||0!==a.f),s&&(0,l.n2)(e,e,a)}validCheck(t,e,i,r){if(!r||null!=t.forceBoundsHeight||null!=t.forceBoundsWidth||r.shadowRoot||r.isContainer)return!0;let{visible:n=e.visible}=t;return!(!r.valid||!n)||(i.empty()||(r.parent&&i.transformWithMatrix(r.parent.globalTransMatrix),this.clearAABBBounds(r,r.stage,i),i.clear()),!1)}updateTempAABBBounds(t){let e=this.tempAABBBounds1,i=this.tempAABBBounds2;return e.setValue(t.x1,t.y1,t.x2,t.y2),i.setValue(t.x1,t.y1,t.x2,t.y2),{tb1:e,tb2:i}}};v=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,n.b)(),(r=(0,s.f)(g.tA),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],v)},26670:function(t,e,i){"use strict";i.d(e,{zs:()=>q,DH:()=>Z,Wl:()=>X});var r=i(76620),n=i(31535),s=i(88504),l=i(8992),a=i(41457),o=i(35652),h=i(30756);let u=t=>new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(t),d=t=>new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(t);var c=i(43562),p=i(21883),g=i.n(p),f=i(30943),m=i(61868),y=i(98116),v=i(40398);class b extends g(){get previousSibling(){return this._prev}get nextSibling(){return this._next}get children(){return this.getChildren()}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}get count(){return this._count}get childrenCount(){return this._idMap?this._idMap.size:0}constructor(){super(),this._uid=v.R.GenAutoIncrementId(),this._firstChild=null,this._lastChild=null,this.parent=null,this._count=1}forEachChildren(t,e=!1){if(e){let e=this._lastChild,i=0;for(;e;){if(t(e,i++))return;e=e._prev}}else{let e=this._firstChild,i=0;for(;e;){if(t(e,i++))return;e=e._next}}}forEachChildrenAsync(t,e=!1){var i,r,n,s;return i=this,r=void 0,n=void 0,s=function*(){if(e){let e=this._lastChild,i=0;for(;e;){let r=t(e,i++);if(r.then&&(r=yield r),r)return;e=e._prev}}else{let e=this._firstChild,i=0;for(;e;){let r=t(e,i++);if(r.then&&(r=yield r),r)return;e=e._next}}},new(n||(n=Promise))(function(t,e){function l(t){try{o(s.next(t))}catch(t){e(t)}}function a(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(l,a)}o((s=s.apply(i,r||[])).next())})}forEach(t){return this.forEachChildren(t)}appendChild(t,e=!0){if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw Error("【Node::appendChild】不能将父辈元素append为子元素");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}appendChildArrHighPerformance(t,e=!1){return console.error("暂不支持该函数"),t}insertBefore(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw Error("【Node::insertBefore】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertAfter(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw Error("【Node::insertAfter】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertInto(t,e){if(!this._ignoreWarn&&this._nodeList&&f.Y.getInstance().warn("insertIntoKeepIdx和insertInto混用可能会存在错误"),e>=this.childrenCount)return this.appendChild(t);if(this===t)return null;if(t.isAncestorsOf(this))throw Error("【Node::insertBefore】不能将父辈元素insert为子元素");if(t.parent&&t.parent.removeChild(t),t.parent=this,0===e)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{let i=this._firstChild;for(let t=0;t<e;t++){if(!i)return null;t>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}insertIntoKeepIdx(t,e){let i;if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){let i=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,i)}this._nodeList[e]=t;for(let t=e-1;t>=0&&!(i=this._nodeList[t]);t--);if(i)return i._next?this.insertBefore(t,i._next):this.appendChild(t);this._ignoreWarn=!0;let r=this.insertInto(t,0);return this._ignoreWarn=!1,r}removeChild(t){if(!this._idMap||!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){let e=this._nodeList.findIndex(e=>e===t);e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}delete(){this.parent&&this.parent.removeChild(this)}removeAllChild(t){if(!this._idMap)return;this._nodeList&&(this._nodeList.length=0);let e=this._firstChild;for(;e;){let t=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=t}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}replaceChild(t,e){throw Error("暂不支持")}find(t,e=!1){let i=null;return this.forEachChildren((e,r)=>!(e===this||!t(e,r))&&(i=e,!0)),e&&this.forEachChildren(e=>{if(e.isContainer){let r=e.find(t,!0);if(r)return i=r,!0}return!1}),i}findAll(t,e=!1){let i=[];return this.forEachChildren((e,r)=>{e!==this&&t(e,r)&&i.push(e)}),e&&this.forEachChildren(e=>{if(e.isContainer){let r=e.findAll(t,!0);r.length&&(i=i.concat(r))}}),i}getElementById(t){return this.find(e=>e.id===t,!0)}findChildById(t){return this.getElementById(t)}findChildByUid(t){return this._idMap&&this._idMap.get(t)||null}getElementsByName(t){return this.findAll(e=>e.name===t,!0)}findChildrenByName(t){return this.getElementsByName(t)}getElementsByType(t){return this.findAll(e=>e.type===t,!0)}getChildByName(t,e=!1){return this.find(e=>e.name===t,e)}getChildAt(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}at(t){return this.getChildAt(t)}containNode(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;let e=this._firstChild;for(;e;){if(e.containNode(t))return!0;e=e._next}return!1}getRootNode(){let t=this.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t||this}hasChildNodes(){return null!==this._firstChild}addChild(t){return this.appendChild(t)}add(t){return this.appendChild(t)}getChildren(){let t=[],e=this._firstChild;for(;e;)t.push(e),e=e._next;return t}isChildOf(t){return!!this.parent&&this.parent._uid===t._uid}isParentOf(t){return t.isChildOf(this)}isDescendantsOf(t){let e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(null!==e);return!1}isAncestorsOf(t){return t.isDescendantsOf(this)}getAncestor(t){throw Error("暂不支持")}setAllDescendantsProps(t,e){let i=this._firstChild;for(;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}setCount(t){this._count+=t;let e=this.parent;if(e)do e._count+=t,e=e.parent;while(null!==e)}clone(){throw Error("暂不支持")}cloneTo(t){throw Error("暂不支持")}getParent(){return this.parent}del(t){return this.removeChild(t)}addEventListener(t,e,i){let r=(0,m.Z)(i,!0)&&i||(0,c.Z)(i)&&i.capture,n=(0,c.Z)(i)&&i.once,s=(0,y.Z)(e)?void 0:e;return t=r?`${t}capture`:t,e=(0,y.Z)(e)?e:e.handleEvent,n?super.once(t,e,s):super.on(t,e,s),this}on(t,e,i){return this.addEventListener(t,e,i)}removeEventListener(t,e,i){let r=(0,m.Z)(i,!0)&&i||(0,c.Z)(i)&&i.capture,n=(0,y.Z)(e)?void 0:e;t=r?`${t}capture`:t,e=(0,y.Z)(e)?e:e.handleEvent;let s=(0,c.Z)(i)&&i.once;return super.off(t,e,n,s),this}off(t,e,i){return this.removeEventListener(t,e,i)}once(t,e,i){return(0,c.Z)(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}removeAllEventListeners(){return super.removeAllListeners(),this}removeAllListeners(){return this.removeAllEventListeners()}dispatchEvent(t,...e){return super.emit(t.type,t,...e),!t.defaultPrevented}emit(t,e){return this.dispatchEvent(t,e)}release(){this.removeAllListeners()}}var _=i(60981),x=i(10693),C=i(36081),w=i(16049),S=i(33974),A=i(20842),M=i(17209),k=i(43291),T=i(23603),R=i(70749),B=i(13342),P=i(45273);let E=new r.FB;class I{constructor(t,e,i=!1){this.pathStr="",this.type=t,(0,n.Z)(e)?this.svgCache=e:this.path=e,this.isSvg=i}drawOffset(t,e,i,r,n,s,l){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(n=>{t.beginPath(),(0,T.h)(n.path.commandList,t,i,r,e,e),l&&l(n.path,n.attribute)}),!1):((0,T.h)(this.path.commandList,t,i,r,e+n,e+n),!1)}draw(t,e,i,r,n,s){return e=this.parseSize(e),this.drawOffset(t,e,i,r,0,n,s)}parseSize(t){return(0,P.Z)(t)?t:Math.min(t[0],t[1])}drawWithClipRange(t,e,i,r,n,s,l){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(s=>{s.path.drawWithClipRange(t,e,i,r,n),l&&l(s.path,s.attribute)}),!1):(this.path.drawWithClipRange(t,e,i,r,n),!1)}bounds(t,e){if(t=this.parseSize(t),this.isSvg){if(!this.svgCache)return;return e.clear(),void this.svgCache.forEach(({path:i})=>{E.x1=i.bounds.x1*t,E.y1=i.bounds.y1*t,E.x2=i.bounds.x2*t,E.y2=i.bounds.y2*t,e.union(E)})}this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}class L{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}function F(t,e,i,r){let n=t.indexOf(e,i);if(-1===n)throw Error(r);return n+e.length-1}function O(t,e,i,r=">"){let n=function(t,e,i=">"){let r,n="";for(let s=e;s<t.length;s++){let e=t[s];if(r)e===r&&(r="");else if('"'===e||"'"===e)r=e;else if(e===i[0]){if(!i[1]||t[s+1]===i[1])return{data:n,index:s}}else"	"===e&&(e=" ");n+=e}}(t,e+1,r);if(!n)return;let s=n.data,l=n.index,a=s.search(/\s/),o=s,h=!0;-1!==a&&(o=s.substr(0,a).replace(/\s\s*$/,""),s=s.substr(a+1));let u=o;if(i){let t=o.indexOf(":");-1!==t&&(h=(o=o.substr(t+1))!==n.data.substr(t+1))}return{tagName:o,tagExp:s,closeIndex:l,attrExpPresent:h,rawTagName:u}}let D=RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");class H{constructor(t){this.currentNode=null,this.options=t,this.tagsNodeStack=[],this.docTypeEntities={}}addChild(t,e,i){let r=e.tagname;"string"==typeof r&&(e.tagname=r),t.addChild(e)}buildAttributesMap(t,e,i){let r={};if(!t)return;let n=function(t,e){let i=[],r=e.exec(t);for(;r;){let n=[];n.startIndex=e.lastIndex-r[0].length;let s=r.length;for(let t=0;t<s;t++)n.push(r[t]);i.push(n),r=e.exec(t)}return i}(t,D),s=n.length;for(let t=0;t<s;t++){let e=n[t][1],i=n[t][4];e&&(r[e]=void 0===i||(isNaN(i)?i:Number(i)))}return r}parseXml(t){t=t.replace(/\r\n?/g,"\n");let e=new L("!xml"),i=e,r="",n="";for(let s=0;s<t.length;s++)if("<"===t[s])if("/"===t[s+1]){let e=F(t,">",s,"Closing Tag is not closed."),l=n.lastIndexOf(".");n=n.substring(0,l),(i=this.tagsNodeStack.pop())&&i.child&&r&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=r),r="",s=e}else if("?"===t[s+1])s=O(t,s,!1,"?>").closeIndex+1;else if("!--"===t.substr(s+1,3))s=F(t,"--\x3e",s+4,"Comment is not closed.");else{let l=O(t,s,!1),a=l.tagName,o=l.tagExp,h=l.attrExpPresent,u=l.closeIndex;if(a!==e.tagname&&(n+=n?"."+a:a),o.length>0&&o.lastIndexOf("/")===o.length-1){"/"===a[a.length-1]?(a=a.substr(0,a.length-1),n=n.substr(0,n.length-1),o=a):o=o.substr(0,o.length-1);let t=new L(a);a!==o&&h&&(t[":@"]=this.buildAttributesMap(o,n,a)),this.addChild(i,t,n),n=n.substr(0,n.lastIndexOf("."))}else{let t=new L(a);this.tagsNodeStack.push(i),a!==o&&h&&(t[":@"]=this.buildAttributesMap(o,n,a)),this.addChild(i,t,n),i=t}r="",s=u}else r+=t[s];return e.child}}class z{constructor(t){this.options=Object.assign({},z.defaultOptions,t)}valid(t){return t.startsWith("<")}parse(t){var e,i;return!!this.valid&&(e=new H(this.options).parseXml(t),this.options,function t(e,i){let r={};for(let n=0;n<e.length;n++){let s=e[n],l=function(t){let e=Object.keys(t);for(let t=0;t<e.length;t++){let i=e[t];if(":@"!==i)return i}}(s),a="";if(a=void 0===i?l:i+"."+l,void 0!==l&&s[l]){let e=t(s[l],a);Object.keys(e).length,s[":@"]&&function(t,e,i){if(e){let i=Object.keys(e),r=i.length;for(let n=0;n<r;n++){let r=i[n];t[r]=e[r]}}}(e,s[":@"],0),void 0!==r[l]&&r.hasOwnProperty(l)?(Array.isArray(r[l])||(r[l]=[r[l]]),r[l].push(e)):r[l]=e}}return r}(e))}}z.defaultOptions={};var W=i(79314);let N={duration:200,easing:"cubicOut"};var j=i(92679);let G=new r.FB,V=new l.y;new r.FB;let Z=["lineWidth","scaleX","scaleY","angle","anchor","visible"],U=["x","y"],K=["scaleX","scaleY"],$=["angle"],Y=new a.E9,X={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1};class q extends b{static mixin(t){let e=Object.keys(t);for(let i=0;i<e.length;++i){let r=e[i];Object.defineProperty(q.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get AABBBounds(){return this.tryUpdateAABBBounds()}get OBBBounds(){return this.tryUpdateOBBBounds()}get globalAABBBounds(){return this.tryUpdateGlobalAABBBounds()}get transMatrix(){return this.tryUpdateLocalTransMatrix(!0)}get globalTransMatrix(){return this.tryUpdateGlobalTransMatrix(!0)}constructor(t={}){var e;super(),this._AABBBounds=new r.FB,this._updateTag=M.Gz.INIT,this.attribute=t,this.valid=this.isValid(),this.updateAABBBoundsStamp=0,t.background?this.loadImage(null!=(e=t.background.background)?e:t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic)}getGraphicService(){var t,e;return null!=(e=null==(t=this.stage)?void 0:t.graphicService)?e:w.w.graphicService}getAttributes(){return this.attribute}setMode(t){"3d"===t?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}getOffsetXY(t,e=!1){var i,r;let{dx:n=t.dx,dy:s=t.dy}=this.attribute;if(e&&this.parent){let t=this.parent.attribute;Y.x=n+(null!=(i=t.scrollX)?i:0),Y.y=s+(null!=(r=t.scrollY)?r:0)}else Y.x=n,Y.y=s;return Y}onAnimateBind(t){this._emitCustomEvent("animate-bind",t)}tryUpdateAABBBounds(){let t="imprecise"===this.attribute.boundsMode;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);let e=this.doUpdateAABBBounds(t);return this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),"empty"===this.attribute.boundsMode&&e.clear(),e}tryUpdateOBBBounds(){return(this._OBBBounds||(this._OBBBounds=new r.a5),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp)?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid)?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds)}combindShadowAABBBounds(t){if(this.shadowRoot){let e=this.shadowRoot.AABBBounds.clone();t.union(e)}}doUpdateOBBBounds(){return this._OBBBounds}getClipPath(){let{clipConfig:t}=this.attribute;if(!t)return null;this.clipPathMap||(this.clipPathMap=new Map);let{shape:e}=t,i=this.clipPathMap.get(e)||null;return i||(this.clipPathMap.size>10&&this.clipPathMap.clear(),(i=this.parsePath(e))&&this.clipPathMap.set(e,i)),i}parsePath(t){var e;if(!t)return null;let i=B.g6[t];if(i||(i=q.userSymbolMap[t]))return i;if(!0===((e=t=B.SR[t]||t).startsWith("<svg")||e.startsWith("<?xml"))){let{svg:e}=(new z).parse(t);if(!e)return null;let i=(0,n.Z)(e.path)?e.path:[e.path];G.clear();let r=[];i.forEach(t=>{let e=(new S.r).fromString(t.d),i={};W.Lo.forEach(e=>{t[e]&&(i[W.IO[e]]=t[e])}),r.push({path:e,attribute:i}),G.union(e.bounds)});let l=G.width(),a=G.height(),o=1/(0,s.Fp)(l,a);r.forEach(t=>t.path.transform(0,0,o,o));let h=new I(t,r,!0);return q.userSymbolMap[t]=h,h}let r=(new S.r).fromString(t),l=r.bounds.width(),a=r.bounds.height(),o=1/(0,s.Fp)(l,a);r.transform(0,0,o,o);let h=new I(t,r);return q.userSymbolMap[t]=h,h}doUpdateAABBBounds(t){this.updateAABBBoundsStamp++;let e=this.getGraphicTheme();this._AABBBounds.clear();let i=this.attribute,r=this.updateAABBBounds(i,e,this._AABBBounds,t),{boundsPadding:n=e.boundsPadding}=i,s=(0,R.dj)(n);return s&&r.expand(s),this.clearUpdateBoundTag(),r}updatePathProxyAABBBounds(t){let e="function"==typeof this.pathProxy?this.pathProxy(this.attribute):this.pathProxy;if(!e)return!1;let i=new k.C(t);return(0,T.h)(e.commandList,i,0,0),!0}tryUpdateGlobalAABBBounds(){let t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}tryUpdateGlobalTransMatrix(t=!0){if(this._globalTransMatrix){if(this.parent){let t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!0}tryUpdateLocalTransMatrix(t=!0){return this._transMatrix||(this._transMatrix=new l.y),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}shouldUpdateAABBBounds(){return this.shadowRoot?(!!(this._updateTag&M.Gz.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&M.Gz.UPDATE_BOUNDS)&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}shouldSelfChangeUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&M.Gz.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&M.Gz.UPDATE_BOUNDS)}shouldUpdateLocalMatrix(){return!!(this._updateTag&M.Gz.UPDATE_LOCAL_MATRIX)}isValid(){var t,e;let i=this.attribute;return Number.isFinite((null!=(t=i.x)?t:0)+(null!=(e=i.y)?e:0))}_validNumber(t){return null==t||Number.isFinite(t)}shouldUpdateShape(){return!!(this._updateTag&M.Gz.UPDATE_SHAPE)}clearUpdateShapeTag(){this._updateTag&=M.Gz.CLEAR_SHAPE}containsPoint(t,e,i,r){if(!r)return!1;if(i===M.LZ.GLOBAL){let i=new a.E9(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(i,i),t=i.x,e=i.y}return r.containsPoint(this,{x:t,y:e})}setWidthHeightWithoutTransform(t){this.widthWithoutTransform=t.x2-t.x1,this.heightWithoutTransform=t.y2-t.y1}setAttributesAndPreventAnimate(t,e=!1,i,r){this.setAttributes(t,e,i),this.animates&&this.animates.forEach(e=>{(e.priority!==1/0||r)&&Object.keys(t).forEach(t=>{e.preventAttr(t)})})}setAttributes(t,e=!1,i){t&&((t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,i))}_setAttributes(t,e=!1,i){let r=Object.keys(t);for(let e=0;e<r.length;e++){let i=r[e];this.attribute[i]=t[i]}this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(e||this.needUpdateTags(r))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}setAttribute(t,e,i,r){var n;let s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);s?this._setAttributes(s,i,r):(0,o.Z)(null==(n=this.normalAttrs)?void 0:n[t])?(this.attribute[t]=e,this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(i||this.needUpdateTag(t))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)):this.normalAttrs[t]=e,"background"===t?this.loadImage(e,!0):"shadowGraphic"===t&&this.setShadowGraphic(e)}needUpdateTags(t,e=Z){for(let i=0;i<e.length;i++){let r=e[i];if(-1!==t.indexOf(r))return!0}return!1}needUpdateTag(t,e=Z){for(let i=0;i<e.length;i++)if(t===e[i])return!0;return!1}initAttributes(t){let e={type:M.Gk.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=M.Gz.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}translate(t,e){var i,r;if(0===t&&0===e)return this;let n={type:M.Gk.TRANSLATE},s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,U,n);s&&(t=s.x,e=s.y,delete s.x,delete s.y,this._setAttributes(s));let l=this.attribute,a=l.postMatrix;return a?w.w.transformUtil.fromMatrix(a,a).translate(t,e):(l.x=(null!=(i=l.x)?i:C.F1.x)+t,l.y=(null!=(r=l.y)?r:C.F1.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this}translateTo(t,e){let i=this.attribute;if(i.x===t&&i.y===e)return this;let r={type:M.Gk.TRANSLATE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,U,r);return n?this._setAttributes(n,!1,r):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)),this}scale(t,e,i){var r,n;if(1===t&&1===e)return this;let s={type:M.Gk.SCALE},a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,K,s);a&&(t=a.scaleX,e=a.scaleY,delete a.scaleX,delete a.scaleY,this._setAttributes(a));let o=this.attribute;if(i){let{postMatrix:r}=this.attribute;r||(o.postMatrix=r=new l.y),w.w.transformUtil.fromMatrix(r,r).scale(t,e,i)}else o.scaleX=(null!=(r=o.scaleX)?r:C.F1.scaleX)*t,o.scaleY=(null!=(n=o.scaleY)?n:C.F1.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(s),this}scaleTo(t,e){let i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;let r={type:M.Gk.SCALE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,K,r);return n?this._setAttributes(n,!1,r):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)),this}rotate(t,e){var i;if(0===t)return this;let r={type:M.Gk.ROTATE},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,$,r);n&&(delete n.angle,this._setAttributes(n,!1,r));let s=this.attribute;if(e){let{postMatrix:i}=this.attribute;i||(s.postMatrix=i=new l.y),w.w.transformUtil.fromMatrix(i,i).rotate(t,e)}else s.angle=(null!=(i=s.angle)?i:C.F1.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}rotateTo(t){let e=this.attribute;if(e.angle===t)return this;let i={type:M.Gk.ROTATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,$,i);return r?this._setAttributes(r,!1,i):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)),this}skewTo(t,e){return this}onAttributeUpdate(t){t&&t.skipUpdateCallback||(this.getGraphicService().onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}update(t){t?(t.bounds&&this.tryUpdateAABBBounds(),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(),this.tryUpdateLocalTransMatrix())}hasState(t){return!(!this.currentStates||!this.currentStates.length)&&(!!(0,o.Z)(t)||this.currentStates.includes(t))}getState(t){var e;return null==(e=this.states)?void 0:e[t]}applyStateAttrs(t,e,i,r){var n,s;if(i){let e,i=Object.keys(t),l=this.getNoWorkAnimateAttr(),a={};i.forEach(i=>{l[i]?(e||(e={}),e[i]=t[i]):a[i]=r&&void 0===t[i]?this.getDefaultAttribute(i):t[i]});let o=null!=(s=null!=(n=this.context&&this.context.stateAnimateConfig)?n:this.stateAnimateConfig)?s:N;this.applyAnimationState(["state"],[{name:"state",animation:{type:"state",to:a,duration:o.duration,easing:o.easing}}]),e&&this.setAttributesAndPreventAnimate(e,!1,{type:M.Gk.STATE})}else this.stopStateAnimates(),this.setAttributesAndPreventAnimate(t,!1,{type:M.Gk.STATE}),this.finalAttribute&&Object.assign(this.finalAttribute,t);this._emitCustomEvent("afterStateUpdate",{type:M.Gk.STATE})}updateNormalAttrs(t){let e={};this.normalAttrs?(Object.keys(t).forEach(t=>{t in this.normalAttrs?(e[t]=this.normalAttrs[t],delete this.normalAttrs[t]):e[t]=this.getNormalAttribute(t)}),Object.keys(this.normalAttrs).forEach(e=>{t[e]=this.normalAttrs[e]})):Object.keys(t).forEach(t=>{e[t]=this.getNormalAttribute(t)}),this.normalAttrs=e}stopStateAnimates(t="end"){this.animates&&this.animates.forEach(e=>{e.stateNames&&(e.stop(t),this.animates.delete(e.id))})}getNormalAttribute(t){var e,i;let r=this.attribute[t];return this.animates?null==(e=this.finalAttribute)?void 0:e[t]:null!=r?r:null==(i=this.finalAttribute)?void 0:i[t]}clearStates(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}removeState(t,e){if(this.currentStates){let i=(0,n.Z)(t)?e=>!t.includes(e):e=>e!==t,r=this.currentStates.filter(i);r.length!==this.currentStates.length&&this.useStates(r,e)}}toggleState(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){let i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}addState(t,e,i){var r;if(this.currentStates&&this.currentStates.includes(t)&&(e||1===this.currentStates.length))return;let n=e&&(null==(r=this.currentStates)?void 0:r.length)?this.currentStates.concat([t]):[t];this.useStates(n,i)}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!((null==(i=this.currentStates)?void 0:i.length)!==t.length||t.some((t,e)=>this.currentStates[e]!==t)))return;let r={};t.forEach(e=>{var i;let n=this.stateProxy?this.stateProxy(e,t):null==(i=this.states)?void 0:i[e];n&&Object.assign(r,n)}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}addUpdateBoundTag(){this._updateTag|=M.Gz.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}addUpdateShapeTag(){this._updateTag|=M.Gz.UPDATE_SHAPE}addUpdateShapeAndBoundsTag(){this._updateTag|=M.Gz.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}updateShapeAndBoundsTagSetted(){return(this._updateTag&M.Gz.UPDATE_SHAPE_AND_BOUNDS)===M.Gz.UPDATE_SHAPE_AND_BOUNDS}clearUpdateBoundTag(){this._updateTag&=M.Gz.CLEAR_BOUNDS}addUpdatePositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=M.Gz.UPDATE_GLOBAL_LOCAL_MATRIX}addUpdateGlobalPositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=M.Gz.UPDATE_GLOBAL_MATRIX}clearUpdateLocalPositionTag(){this._updateTag&=M.Gz.CLEAR_LOCAL_MATRIX}clearUpdateGlobalPositionTag(){this._updateTag&=M.Gz.CLEAR_GLOBAL_MATRIX}addUpdateLayoutTag(){this._updateTag|=M.Gz.UPDATE_LAYOUT}clearUpdateLayoutTag(){this._updateTag&=M.Gz.CLEAR_LAYOUT}needUpdateLayout(){return!!(this._updateTag&M.Gz.UPDATE_LAYOUT)}getAnchor(t,e,i){let r=[0,0],n=()=>{if(e.b)return e.b;let t=this.clone();return t.attribute.angle=0,t.attribute.scaleCenter=null,i&&(t.attribute.scaleX=1,t.attribute.scaleY=1),e.b=t.AABBBounds,e.b};if("string"==typeof t[0]){let e=parseFloat(t[0])/100,i=n();r[0]=i.x1+(i.x2-i.x1)*e}else r[0]=t[0];if("string"==typeof t[1]){let e=parseFloat(t[1])/100,i=n();r[1]=i.y1+(i.y2-i.y1)*e}else r[1]=t[1];return r}doUpdateLocalMatrix(){let{x:t=C.F1.x,y:e=C.F1.y,scaleX:i=C.F1.scaleX,scaleY:r=C.F1.scaleY,angle:n=C.F1.angle,scaleCenter:s,anchor:a,postMatrix:o}=this.attribute,h=[0,0],u={};if(a&&n&&(h=this.getAnchor(a,u)),s&&(1!==i||1!==r)){let l=this._transMatrix;l.reset(),l.translate(h[0],h[1]),l.rotate(n),l.translate(-h[0],-h[1]),l.translate(t,e),h=this.getAnchor(s,u,!0),w.w.transformUtil.fromMatrix(l,l).scale(i,r,{x:h[0],y:h[1]})}else(0,l.X)(this._transMatrix,this._transMatrix.reset(),t,e,i,r,n,a&&h);let d=this.getOffsetXY(C.F1);if(this._transMatrix.e+=d.x,this._transMatrix.f+=d.y,o){let t=V.setValue(o.a,o.b,o.c,o.d,o.e,o.f),e=this._transMatrix;t.multiply(e.a,e.b,e.c,e.d,e.e,e.f),e.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}doUpdateGlobalMatrix(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);let{scrollX:t=0,scrollY:e=0}=this.parent.attribute;this._globalTransMatrix.translate(t,e)}}setStage(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){let e=t.getTimeline();this.animates.forEach(t=>{t.timeline.isGlobal&&(t.setTimeline(e),e.addAnimate(t))})}this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t)}}setStageToShadowRoot(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}onAddStep(t){}onStop(t){t&&this.setAttributes(t,!1,{type:M.Gk.ANIMATE_END})}getDefaultAttribute(t){return this.getGraphicTheme()[t]}getComputedAttribute(t){var e;return null!=(e=this.attribute[t])?e:this.getDefaultAttribute(t)}onSetStage(t,e=!1){this._onSetStage=t,e&&this.stage&&t(this,this.stage)}attachShadow(t){return t&&(t.shadowHost=this),this.shadowRoot=null!=t?t:w.w.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}detachShadow(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot.release(!0),this.shadowRoot=null)}toJson(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map(t=>t.toJson())}}createPathProxy(t){return(0,h.Z)(t,!0)?this.pathProxy=(new S.r).fromString(t):this.pathProxy=new S.r,this.pathProxy}loadImage(t,e=!1){var i;if(!t||e&&!(!(i=t).fill&&!i.stroke))return;this.resources||(this.resources=new Map);let r={data:"init",state:null};this.resources.set(t,r),"string"==typeof t?(r.state="loading",t.startsWith("<svg")?(A.h.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):(u(t)||t.includes("/")||d(t))&&(A.h.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):(0,c.Z)(t)?(r.state="success",r.data=t,this.backgroundImg=this.backgroundImg||e):r.state="fail"}setShadowGraphic(t){t?this.attachShadow().add(t):this.detachShadow()}imageLoadSuccess(t,e,i){if(!this.resources)return;let r=this.resources.get(t);r&&(r.state="success",r.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}imageLoadFail(t,e){if(!this.resources)return;let i=this.resources.get(t);i&&(i.state="fail",e&&e())}_stopAnimates(t){t&&t.forEach(t=>{t.stop()})}stopAnimates(t=!1){this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren(e=>{e.stopAnimates(t)})}release(){this.releaseStatus="released",this.stopAnimates(),w.w.graphicService.onRelease(this)}_emitCustomEvent(t,e){var i,r;if(this._events&&t in this._events){let n=new _.A(t,e);n.bubbles=!1,n.manager=null==(r=null==(i=this.stage)?void 0:i.eventSystem)?void 0:r.manager,this.dispatchEvent(n)}}toCustomPath(){var t,e,i;let r=null==(i=null==(e=(null==(t=this.stage)?void 0:t.renderService)||w.w.renderService)?void 0:e.drawContribution)?void 0:i.getRenderContribution(this);if(r){let t=new j.w(null,1);return r.drawShape(this,t,0,0,{},{}),t.path}return null}}q.userSymbolMap={},q.mixin({dispatchEvent(t){var e;if(!(t instanceof x.x))throw Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=[],t.detailPath&&(t.detailPath=[]),t.target=this,null==(e=null==t?void 0:t.manager)||e.dispatchEvent(t),!t.defaultPrevented},emit(t,e){return this.dispatchEvent(new _.A(t,e))}})},75485:function(t,e,i){"use strict";i.d(e,{ZA:()=>c,sS:()=>p});var r,n,s=i(41457),l=i(16049),a=i(26670),o=i(4062),h=i(17209),u=i(79314),d=i(36081);(r=n||(n={}))[r.LESS_GROUP=0]="LESS_GROUP",r[r.MORE_GROUP=1]="MORE_GROUP";class c extends a.zs{constructor(t){super(t),this.type="group",this.parent=null,this.isContainer=!0,this.numberType=u.I_,this._childUpdateTag=h.Gz.UPDATE_BOUNDS}setMode(t){"3d"===t?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}setTheme(t){return this.theme||(this.theme=new o.Q2),this.theme.setTheme(t,this)}createTheme(){this.theme||(this.theme=new o.Q2)}visibleAll(t){this.setAttribute("visible",t),this.forEachChildren(e=>{e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute("visible",t)})}hideAll(){this.visibleAll(!1)}showAll(){this.visibleAll(!0)}containsPoint(t,e,i){if(i===h.LZ.GLOBAL){let i=new s.E9(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(i,i),this.AABBBounds.contains(i.x,i.y)}return this.AABBBounds.contains(t,e)}shouldUpdateAABBBounds(){return!!super.shouldUpdateAABBBounds()||!!(this._childUpdateTag&h.Gz.UPDATE_BOUNDS)}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);let t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),"empty"===this.attribute.boundsMode&&e.clear(),e}doUpdateLocalMatrix(){let{x:t=d.F1.x,y:e=d.F1.y,dx:i=d.F1.dx,dy:r=d.F1.dy,scaleX:n=d.F1.scaleX,scaleY:s=d.F1.scaleY,angle:l=d.F1.angle,postMatrix:a}=this.attribute;if(0!==t||0!==e||0!==i||0!==r||1!==n||1!==s||0!==l||a)return super.doUpdateLocalMatrix();this._transMatrix.reset()}getGraphicTheme(){return(0,o.gh)(this).group}updateAABBBounds(t,e,i){let r=i;i=i.clone();let{width:n,height:s,path:a,clip:o=e.clip}=t;if(a&&a.length?a.forEach(t=>{i.union(t.AABBBounds)}):null!=n&&null!=s&&i.set(0,0,Math.max(0,n),Math.max(0,s)),!o){this.forEachChildren(t=>{i.union(t.AABBBounds)});let{scrollX:e=0,scrollY:r=0}=t;i.translate(e,r)}return l.w.graphicService.updateTempAABBBounds(i),l.w.graphicService.transformAABBBounds(t,i,e,!1,this),r.copy(i),r}doUpdateAABBBounds(){this.updateAABBBoundsStamp++;let t=super.doUpdateAABBBounds();return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),t}clearUpdateBoundTag(){this._updateTag&=h.Gz.CLEAR_BOUNDS,this._childUpdateTag&=h.Gz.CLEAR_BOUNDS}addUpdateBoundTag(){this._updateTag|=h.Gz.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}addChildUpdateBoundTag(){this._childUpdateTag&h.Gz.UPDATE_BOUNDS||(this._childUpdateTag|=h.Gz.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}getTheme(){return this.theme.getTheme(this)}incrementalAppendChild(t){let e=super.appendChild(t);return this.stage&&e&&(e.stage=this.stage,e.layer=this.layer),this.addUpdateBoundTag(),this.getGraphicService().onAddIncremental(t,this,this.stage),e}incrementalClearChild(){super.removeAllChild(),this.addUpdateBoundTag(),this.getGraphicService().onClearIncremental(this,this.stage)}_updateChildToStage(t){return this.stage&&t&&t.setStage(this.stage,this.layer),this.addUpdateBoundTag(),t}appendChild(t,e=!0){let i=super.appendChild(t);return e&&this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}insertBefore(t,e){return this._updateChildToStage(super.insertBefore(t,e))}insertAfter(t,e){return this._updateChildToStage(super.insertAfter(t,e))}insertInto(t,e){return this._updateChildToStage(super.insertInto(t,e))}removeChild(t){let e=super.removeChild(t);return this.getGraphicService().onRemove(t),t.stage=null,this.addUpdateBoundTag(),e}removeAllChild(t=!1){this.forEachChildren(e=>{this.getGraphicService().onRemove(e),t&&e.isContainer&&e.removeAllChild(t)}),super.removeAllChild(),this.addUpdateBoundTag()}setStage(t,e){this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t),this.forEachChildren(e=>{e.setStage(t,this.layer)}))}addUpdatePositionTag(){super.addUpdatePositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}addUpdateGlobalPositionTag(){super.addUpdateGlobalPositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){let t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!!(this._updateTag&h.Gz.UPDATE_GLOBAL_MATRIX)}_getChildByName(t,e){return this.find(e=>e.name===t,e)}createOrUpdateChild(t,e,i){let r=this._getChildByName(t);return r?r.setAttributes(e):((r=l.w.graphicService.creator[i](e)).name=t,this.add(r)),r}clone(){return new c(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return c.NOWORK_ANIMATE_ATTR}release(t){t&&this.forEachChildren(e=>{e.release(t)}),super.release()}}function p(t){return new c(t)}c.NOWORK_ANIMATE_ATTR=a.Wl},77474:function(t,e,i){"use strict";i.d(e,{B:()=>d,E:()=>u});var r=i(26670),n=i(36081),s=i(4062),l=i(16049),a=i(79314),o=i(1544);let h=["width","height","image",...r.DH];class u extends r.zs{constructor(t){super(t),this.type="image",this.numberType=a.PN,this.loadImage(this.attribute.image)}getImageElement(){let{image:t}=this.attribute;if(!t||!this.resources)return null;let e=this.resources.get(t);return"success"!==e.state?null:e.data}get width(){return this.tryUpdateAABBBounds(),this._actualWidth}get height(){return this.tryUpdateAABBBounds(),this._actualHeight}get repeatX(){var t;return null!=(t=this.attribute.repeatX)?t:"no-repeat"}set repeatX(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}get repeatY(){var t;return null!=(t=this.attribute.repeatY)?t:"no-repeat"}set repeatY(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}get image(){return this.attribute.image}set image(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}imageLoadSuccess(t,e,i){super.imageLoadSuccess(t,e,()=>{this.successCallback&&this.successCallback()}),this.addUpdateBoundTag()}imageLoadFail(t,e){super.imageLoadFail(t,()=>{this.failCallback&&this.failCallback()})}setAttributes(t,e,i){return t.image&&this.loadImage(t.image),super.setAttributes(t,e,i)}setAttribute(t,e,i,r){return"image"===t&&this.loadImage(e),super.setAttribute(t,e,i,r)}getGraphicTheme(){return(0,s.gh)(this).image}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let{maxWidth:r=e.maxWidth,maxHeight:n=e.maxHeight}=t,{width:s,height:l}=t;if(null==s||null==l){let t=this.getImageElement();if(t){let e=t.width,i=t.height;if(null!=s)l=i/e*s;else if(null!=l)s=e/i*l;else{let t=e/i;t>r/n?(s=r,l=r/t):(l=n,s=n*t)}}else s=r,l=n}this._actualWidth=s,this._actualHeight=l,i.set(0,0,s,l)}let{tb1:r,tb2:n}=l.w.graphicService.updateTempAABBBounds(i);return(0,o.E)(t,e,r),i.union(r),r.setValue(n.x1,n.y1,n.x2,n.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,l.w.graphicService.transformAABBBounds(t,i,e,!1,this),i}getDefaultAttribute(t){return n.jK[t]}needUpdateTags(t){return super.needUpdateTags(t,h)}needUpdateTag(t){return super.needUpdateTag(t,h)}clone(){return new u(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return u.NOWORK_ANIMATE_ATTR}}function d(t){return new u(t)}u.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},r.Wl)},32463:function(t,e,i){"use strict";i.d(e,{W:()=>d,x:()=>u});var r=i(26670),n=i(4062),s=i(16049),l=i(70749),a=i(33974),o=i(79314);let h=["segments","points","curveType","curveTension",...r.DH];class u extends r.zs{constructor(t={}){super(t),this.type="line",this.numberType=o.Hf}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;let{points:t,segments:e}=this.attribute;return e?0!==e.length:!!t&&!(t.length<=1)}_interpolate(t,e,i,r,n){"points"===t&&(n.points=(0,l.SA)(i,r,e))}getGraphicTheme(){return(0,n.gh)(this).line}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i):this.updateLineAABBBoundsByPoints(t,e,i)),s.w.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;let{lineJoin:r=e.lineJoin}=t;return s.w.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}updateLineAABBBoundsByPoints(t,e,i,r){let{points:n=e.points,connectedType:s}=t;return n.forEach(t=>{!1===t.defined&&"connect"!==s||i.add(t.x,t.y)}),i}updateLineAABBBoundsBySegments(t,e,i,r){let{segments:n=e.segments,connectedType:s}=t;return n.forEach(t=>{t.points.forEach(t=>{!1===t.defined&&"connect"!==s||i.add(t.x,t.y)})}),i}needUpdateTags(t){return super.needUpdateTags(t,h)}needUpdateTag(t){return super.needUpdateTag(t,h)}toCustomPath(){let t=super.toCustomPath();if(t)return t;let e=this.attribute;t=new a.r;let i=e.segments,r=e=>{if(e&&e.length){let i=!0;e.forEach(e=>{!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),i=!1)})}};return i&&i.length?i.forEach(t=>{r(t.points)}):e.points&&r(e.points),t}clone(){return new u(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return u.NOWORK_ANIMATE_ATTR}}function d(t){return new u(t)}u.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},r.Wl)},20033:function(t,e,i){"use strict";i.d(e,{E:()=>p});var r=i(35652),n=i(30756),s=i(26670),l=i(33974),a=i(4062),o=i(16049),h=i(79314),u=i(1544);let d=["path","customPath",...s.DH];class c extends s.zs{constructor(t){super(t),this.type="path",this.numberType=h.qm}get pathShape(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{path:t}=this.attribute;return null!=t&&""!==t}getParsedPathShape(){let t=this.getGraphicTheme();if(!this.valid)return t.path;let e=this.attribute;return e.path instanceof l.r?e.path:((0,r.Z)(this.cache)&&this.doUpdatePathShape(),this.cache instanceof l.r?this.cache:t.path)}getGraphicTheme(){return(0,a.gh)(this).path}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let t=this.getParsedPathShape();i.union(t.getBounds())}let{tb1:r,tb2:n}=o.w.graphicService.updateTempAABBBounds(i);(0,u.E)(t,e,r),i.union(r),r.setValue(n.x1,n.y1,n.x2,n.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;let{lineJoin:s=e.lineJoin}=t;return o.w.graphicService.transformAABBBounds(t,i,e,"miter"===s,this),i}doUpdateAABBBounds(t){return this.doUpdatePathShape(),super.doUpdateAABBBounds(t)}doUpdatePathShape(){let t=this.attribute;(0,n.Z)(t.path,!0)?this.cache=(new l.r).fromString(t.path):t.customPath&&(this.cache=new l.r,t.customPath(this.cache,this))}needUpdateTags(t){return super.needUpdateTags(t,d)}needUpdateTag(t){return super.needUpdateTag(t,d)}toCustomPath(){return(new l.r).fromCustomPath2D(this.getParsedPathShape(),0,0)}clone(){return new c(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return c.NOWORK_ANIMATE_ATTR}}function p(t){return new c(t)}c.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},s.Wl)},26854:function(t,e,i){"use strict";i.d(e,{p:()=>d});var r=i(26670),n=i(4062),s=i(70749),l=i(33974),a=i(16049),o=i(79314);let h=["points","cornerRadius",...r.DH];class u extends r.zs{constructor(t){super(t),this.type="polygon",this.numberType=o.Kh}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{points:t}=this.attribute;return t&&t.length>=2}getGraphicTheme(){return(0,n.gh)(this).polygon}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||this.updatePolygonAABBBoundsImprecise(t,e,i),a.w.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;let{lineJoin:r=e.lineJoin}=t;return a.w.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}updatePolygonAABBBoundsImprecise(t,e,i){let{points:r=e.points}=t;return r.forEach(t=>{i.add(t.x,t.y)}),i}_interpolate(t,e,i,r,n){"points"===t&&(n.points=(0,s.SA)(i,r,e))}needUpdateTags(t){return super.needUpdateTags(t,h)}needUpdateTag(t){return super.needUpdateTag(t,h)}toCustomPath(){let t=super.toCustomPath();if(t)return t;let e=this.attribute.points;return t=new l.r,e.forEach((e,i)=>{0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)}),t.closePath(),t}clone(){return new u(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return u.NOWORK_ANIMATE_ATTR}}function d(t){return new u(t)}u.NOWORK_ANIMATE_ATTR=r.Wl},35953:function(t,e,i){"use strict";i.d(e,{U:()=>d,f:()=>c});var r=i(26670),n=i(33974),s=i(4062),l=i(16049),a=i(79314),o=i(10546),h=i(1544);let u=["width","x1","y1","height","cornerRadius",...r.DH];class d extends r.zs{constructor(t){super(t),this.type="rect",this.numberType=a._u}isValid(){return super.isValid()&&this._isValid()}_isValid(){return!0}getGraphicTheme(){return(0,s.gh)(this).rect}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let{width:e,height:r}=t,{x1:n,y1:s,x:l,y:a}=t;e=null!=e?e:n-l,r=null!=r?r:s-a,(isFinite(e)||isFinite(r)||isFinite(l)||isFinite(a))&&i.set(0,0,e||0,r||0)}let{tb1:r,tb2:n}=l.w.graphicService.updateTempAABBBounds(i);return(0,h.E)(t,e,r),i.union(r),r.setValue(n.x1,n.y1,n.x2,n.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,l.w.graphicService.transformAABBBounds(t,i,e,!1,this),i}needUpdateTags(t){return super.needUpdateTags(t,u)}needUpdateTag(t){return super.needUpdateTag(t,u)}toCustomPath(){let t=super.toCustomPath();if(t)return t;let e=this.attribute,{x:i,y:r,width:s,height:l}=(0,o.p)(e);return(t=new n.r).moveTo(i,r),t.rect(i,r,s,l),t}clone(){return new d(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return d.NOWORK_ANIMATE_ATTR}}function c(t){return new d(t)}d.NOWORK_ANIMATE_ATTR=r.Wl},29559:function(t,e,i){"use strict";i.d(e,{H:()=>C,p:()=>w});var r=i(30756),n=i(45273),s=i(26670),l=i(36081),a=i(21295);class o{constructor(t,e,i,r,n,s,l,o,h,u,d,c,p,g){this.left=t,this.top=e,this.width=i,this.height=r,this.actualHeight=0,this.bottom=e+r,this.right=t+i,this.ellipsis=n,this.wordBreak=s,this.verticalDirection=l,this.lines=[],this.globalAlign=o,this.globalBaseline=h,this.layoutDirection=u,this.directionKey=a.i7[this.layoutDirection],this.isWidthMax=d,this.isHeightMax=c,this.singleLine=p,g?(g.clear(),this.icons=g):this.icons=new Map}draw(t,e){let{width:i,height:r}=this.getActualSize(),n=this.isWidthMax?Math.min(this.width,i):this.width||i||0,s=this.isHeightMax?Math.min(this.height,r):this.height||r||0;s=Math.min(s,r);let l=0;switch(this.globalBaseline){case"top":l=0;break;case"middle":l=-s/2;break;case"bottom":l=-s}let a=0;"right"===this.globalAlign||"end"===this.globalAlign?a=-n:"center"===this.globalAlign&&(a=-n/2);let o=this[this.directionKey.height];this.singleLine&&(o=this.lines[0].height+1);let h=!1;if("middle"===this.verticalDirection)if(this.actualHeight>=o&&0!==o)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i];if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+o)break;let s=!1;this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+o&&(s=!0,h=!0),this.lines[i].draw(t,s,this.lines[i][this.directionKey.left]+a,this.lines[i][this.directionKey.top]+l,this.ellipsis,e)}else{let i=Math.floor((o-this.actualHeight)/2);"vertical"===this.layoutDirection?a+=i:l+=i;for(let i=0;i<this.lines.length;i++)this.lines[i].draw(t,!1,this.lines[i][this.directionKey.left]+a,this.lines[i][this.directionKey.top]+l,this.ellipsis,e)}else if("bottom"===this.verticalDirection&&"vertical"!==this.layoutDirection)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i],s=o-this.lines[i].top-this.lines[i].height;if(0===o)this.lines[i].draw(t,!1,a,s+l,this.ellipsis,e);else{if(s+n>this[this.directionKey.top]+o||s<this[this.directionKey.top])return h;{let r=!1;this.ellipsis&&this.lines[i+1]&&s-this.lines[i+1].height<this[this.directionKey.top]&&(r=!0,h=!0),this.lines[i].draw(t,r,a,s+l,this.ellipsis,e)}}}else{"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&this.singleLine&&this.isWidthMax&&(a+=this.lines[0].height+1);for(let i=0;i<this.lines.length;i++){"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&(a-=this.lines[i].height+this.lines[i].top);let{top:r,height:n}=this.lines[i];if(0===o)this.lines[i].draw(t,!1,this.lines[i][this.directionKey.left]+a,this.lines[i][this.directionKey.top]+l,this.ellipsis,e);else{if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+o)return h;{let r=!1;this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+o&&(r=!0,h=!0),this.lines[i].draw(t,r,this.lines[i][this.directionKey.left]+a,this.lines[i][this.directionKey.top]+l,this.ellipsis,e)}}}}return h}getActualSize(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}getRawActualSize(){let t=0,e=0;for(let i=0;i<this.lines.length;i++){let r=this.lines[i];r.actualWidth>t&&(t=r.actualWidth),e+=r.height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}getActualSizeWidthEllipsis(){let t=0,e=0,{width:i,height:r}=this.getRawActualSize();this.width;let n=this.height||r||0;n=Math.min(n,r);let s=this[this.directionKey.height];if(this.singleLine&&(s=this.lines[0].height+1),"middle"===this.verticalDirection)if(this.actualHeight>=s&&0!==s)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i];if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+s);else if(this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+s){let r=!0===this.ellipsis?"...":this.ellipsis||"",n=this.lines[i].getWidthWithEllips(r);n>t&&(t=n),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else{this.actualHeight;for(let i=0;i<this.lines.length;i++)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else if("bottom"===this.verticalDirection)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i],l=s-this.lines[i].top-this.lines[i].height;if(0===s)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height;else if(l+n>this[this.directionKey.top]+s||l<this[this.directionKey.top]);else if(this.ellipsis&&this.lines[i+1]&&l-this.lines[i+1].height<this[this.directionKey.top]){let r=!0===this.ellipsis?"...":this.ellipsis||"",n=this.lines[i].getWidthWithEllips(r);n>t&&(t=n),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i];if(0===s)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height;else if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+s);else if(this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+s){let r=!0===this.ellipsis?"...":this.ellipsis||"",n=this.lines[i].getWidthWithEllips(r);n>t&&(t=n),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}}var h=i(70749);function u(t,e,i,r){let n=Math.round(t),s=Math.round(i),l=Math.round(e),a=Math.round(r);return{left:t>n?n:n-.5,top:i>s?s:s-.5,right:l>e?l:l+.5,bottom:a>r?a:a+.5}}class d{constructor(t,e,i,r){var n,s;this.fontSize=i.fontSize||16,this.textBaseline=i.textBaseline||"alphabetic",this.ascentDescentMode=r;let l=(0,h.VA)(i.lineHeight,this.fontSize);this.lineHeight="number"==typeof l?l>this.fontSize?l:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;let{ascent:o,height:u,descent:d,width:c}=(0,a.MS)(t,i,this.ascentDescentMode),p=0,g=0,f=0;this.height>u&&(g=Math.ceil(p=(this.height-u)/2),f=Math.floor(p)),"top"===this.textBaseline?(this.ascent=p,this.descent=u-p):"bottom"===this.textBaseline?(this.ascent=u-p,this.descent=p):"middle"===this.textBaseline?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=o+g,this.descent=d+f),this.length=t.length,this.width=c||0,this.text=t||"",this.newLine=e||!1,this.character=i,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,this.space=i.space,this.dx=null!=(n=i.dx)?n:0,this.dy=null!=(s=i.dy)?s:0,"vertical"===i.direction&&(this.direction=i.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}updateWidth(){let{width:t}=(0,a.MS)(this.text,this.character,this.ascentDescentMode);this.width=t,"vertical"===this.direction&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}drawBackground(t,e,i,r,n,s,l){if(""===this.text||"\n"===this.text||!this.character.background||this.character.backgroundOpacity&&!(this.character.backgroundOpacity>0))return;let o=e+i,h=this.text,d=this.left+r;o+=this.top;let c=this.direction;if(this.verticalEllipsis)h=this.ellipsisStr,c="vertical",o-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)h+=this.ellipsisStr,"right"!==s&&"end"!==s||(d-=this.ellipsisWidth);else if("replace"===this.ellipsis){let t=(0,a.Hi)(h,("vertical"===c?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,h.length-1);if(h=h.slice(0,t)+this.ellipsisStr,"right"===s||"end"===s)if("vertical"===c);else{let{width:e}=(0,a.MS)(this.text.slice(t),this.character,this.ascentDescentMode);d-=this.ellipsisWidth-e}}}return Object.assign(Object.assign({},u(d,d+(this.widthOrigin||this.width),e,e+l)),{fillStyle:this.character.background,globalAlpha:this.character.backgroundOpacity})}draw(t,e,i,r,n,s,l){var o;let h=e+i,d=this.text,c=this.left+r+(null!=(o=this.space)?o:0)/2;h+=this.top;let p=this.direction;if(this.verticalEllipsis)d=this.ellipsisStr,p="vertical",h-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)d+=this.ellipsisStr,"right"!==s&&"end"!==s||(c-=this.ellipsisWidth);else if("replace"===this.ellipsis){let t=(0,a.Hi)(d,("vertical"===p?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,d.length-1);if(d=d.slice(0,t)+this.ellipsisStr,"right"===s||"end"===s)if("vertical"===p);else{let{width:e}=(0,a.MS)(this.text.slice(t),this.character,this.ascentDescentMode);c-=this.ellipsisWidth-e}}}switch(this.character.script){case"super":h-=this.ascent*(1/3);break;case"sub":h+=this.descent/2}"vertical"===p&&(t.save(),t.rotateAbout(Math.PI/2,c,h),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(c,h),c=0,h=0);let{lineWidth:g=1}=this.character;if(this.character.stroke&&g&&t.strokeText(d,c+this.dx,h+this.dy),this.character.fill&&t.fillText(d,c+this.dx,h+this.dy),this.character.fill){if(this.character.lineThrough||this.character.underline){if(this.character.underline){let e=1+h,i=u(c,c+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+h,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}if(this.character.lineThrough){let e=1+h-this.ascent/2,i=u(c,c+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+h-this.ascent/2,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}else if("underline"===this.character.textDecoration){let e=1+h,i=u(c,c+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+h,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}else if("line-through"===this.character.textDecoration){let e=1+h-this.ascent/2,i=u(c,c+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+h-this.ascent/2,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}"vertical"===p&&t.restore()}getWidthWithEllips(t){let e=this.text,i="vertical"===t?this.height:this.width;if("hide"===this.ellipsis)return i;if("add"===this.ellipsis)return i+this.ellipsisWidth;if("replace"===this.ellipsis){let t=(0,a.Hi)(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,t)+this.ellipsisStr;let{width:r}=(0,a.MS)(this.text.slice(t),this.character,this.ascentDescentMode);return i+this.ellipsisWidth-r}return i}}var c=i(31535),p=i(77474);class g extends p.E{constructor(t){if(super(t),this._x=0,this._y=0,this._hovered=!1,this._marginArray=[0,0,0,0],"always"===t.backgroundShowMode&&(this._hovered=!0),t.margin){let e=(0,h.dj)(t.margin);this._marginArray="number"==typeof e?[e,e,e,e]:e}this.onBeforeAttributeUpdate=(t,e,i)=>{if((0,c.Z)(i)&&-1!==i.indexOf("margin")||"margin"===i)if(e.margin){let t=(0,h.dj)(e.margin);this._marginArray="number"==typeof t?[t,t,t,t]:t}else this._marginArray=[0,0,0,0]}}get width(){var t;return(null!=(t=this.attribute.width)?t:0)+this._marginArray[1]+this._marginArray[3]}get height(){var t;return(null!=(t=this.attribute.height)?t:0)+this._marginArray[0]+this._marginArray[2]}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();let{width:t=l.jK.width,height:e=l.jK.height}=this.attribute,{backgroundWidth:i=t,backgroundHeight:r=e}=this.attribute;return this._AABBBounds.expand([0,(i-t)/2*2,(r-e)/2*2,0]),this._AABBBounds}setHoverState(t){"hover"===this.attribute.backgroundShowMode&&this._hovered!==t&&(this._hovered=t)}}class f{constructor(t,e,i,r,n,s,l,o){this.left=t,this.width=e,this.baseline=i,this.ascent=r,this.descent=n,this.top=i-r,this.paragraphs=s.map(t=>t),this.textAlign=(this.paragraphs[0]instanceof g?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=l,this.directionKey=a.i7[this.direction],this.actualWidth=0;let h=0;this.paragraphs.forEach((t,e)=>{if(0===e&&t instanceof d){let e=a.cV.exec(t.text);0!==(null==e?void 0:e.index)&&(t.text=t.text.slice(null==e?void 0:e.index),t.updateWidth())}this.actualWidth+=t[this.directionKey.width],h=Math.max(t[this.directionKey.height],h)}),this.height=h,this.blankWidth=o?0:this.width-this.actualWidth,this.calcOffset(e,o)}calcOffset(t,e){let i=this.directionKey,r=this.height,n=this.left,s=0;this.actualWidth<t&&!e&&("right"===this.textAlign||"end"===this.textAlign?n=t-this.actualWidth:"center"===this.textAlign?n=(t-this.actualWidth)/2:"justify"===this.textAlign&&(this.paragraphs.length<2?n=(t-this.actualWidth)/2:s=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map(function(t){t instanceof g?(t["_"+i.x]=n,n+=t[i.width]+s,t["_"+i.y]="top"===t.attribute.textBaseline?0:"bottom"===t.attribute.textBaseline?r-t.height:(r-t.height)/2):(t[i.left]=n,n+=t[i.width]+s)})}draw(t,e,i,r,n,s){if(n&&(e||this.paragraphs.some(t=>t.overflow))){let t=!0,i=!1;for(let e=this.paragraphs.length-1;e>=0;e--){let r=this.paragraphs[e];if(r.overflow)t=t&&""===r.text;else if(t){i=!0;break}}let r=0;if(!i)for(let t=this.paragraphs.length-1;t>=0;t--){let i=this.paragraphs[t];if(i.overflow){if(""===i.text)break;continue}if(i instanceof g)break;if("vertical"===this.direction&&"vertical"!==i.direction){i.verticalEllipsis=!0;break}let s=!0===n?"...":n||"";i.ellipsisStr=s;let{width:l}=(0,a.MS)(s,i.character,i.ascentDescentMode),o=l||0;if(o<=this.blankWidth+r){e&&(i.ellipsis="add");break}if(o<=this.blankWidth+r+i.width){i.ellipsis="replace",i.ellipsisWidth=o,i.ellipsisOtherParagraphWidth=this.blankWidth+r;break}i.ellipsis="hide",r+=i.width}}let l="",o=-1,h=[],u=[h];this.paragraphs.forEach((e,n)=>{if(e instanceof g)return;let s=e.drawBackground(t,r,this.ascent,i,0===n,this.textAlign,this.height);s&&(l===s.fillStyle&&o===s.globalAlpha||(h=[],u.push(h),l=s.fillStyle,o=s.globalAlpha),h.push(s))}),u.forEach(e=>{if(0===e.length)return;let i=e[0],r=e[e.length-1];t.fillStyle=i.fillStyle,t.globalAlpha=i.globalAlpha,t.fillRect(i.left,i.top,r.right-i.left,r.bottom-i.top)}),this.paragraphs.forEach((e,n)=>{if(e instanceof g)return e.setAttributes({x:i+e._x,y:r+e._y}),void s(e,t,i+e._x,r+e._y,this.ascent);let l={x1:this.left,y1:this.top,x2:this.left+this.actualWidth,y2:this.top+this.height};(0,a.p3)(t,e.character),(0,a.nq)(t,e.character,l),e.draw(t,r,this.ascent,i,0===n,this.textAlign,this.height)})}getWidthWithEllips(t){let e=0;for(let i=this.paragraphs.length-1;i>=0;i--){let r=this.paragraphs[i];if(r instanceof g)break;let{width:n}=(0,a.MS)(t,r.character,r.ascentDescentMode),s=n||0;if(s<=this.blankWidth+e){r.ellipsis="add",r.ellipsisWidth=s;break}if(s<=this.blankWidth+e+r.width){r.ellipsis="replace",r.ellipsisWidth=s,r.ellipsisOtherParagraphWidth=this.blankWidth+e;break}r.ellipsis="hide",e+=r.width}let i=0;return this.paragraphs.forEach((t,e)=>{i+=t instanceof g?t.width:t.getWidthWithEllips(this.direction)}),i}}class m{constructor(t){this.frame=t,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=t.layoutDirection,this.directionKey=a.i7[this.direction]}store(t){if(t instanceof g){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];let e=0,i=0;"top"===t.attribute.textBaseline?(e=0,i=t.height):"bottom"===t.attribute.textBaseline?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),0!==t.text.length?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}send(){if(0===this.lineBuffer.length)return;let t=0===this.maxAscent?this.maxAscentForBlank:this.maxAscent,e=0===this.maxDescent?this.maxDescentForBlank:this.maxDescent,i=new f(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,"horizontal"===this.direction?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}deal(t,e=!1){t instanceof g?"horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):0===this.lineBuffer.length?(this.store(t),this.send()):(this.send(),this.deal(t)):"number"!=typeof this.width||this.width<0||(t.newLine&&this.send(),(0!==t.text.length||this.newLine)&&("horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t,e)))}cut(t,e){let i=this[this.directionKey.width]-this.lineWidth||0,r=Math.ceil(i/t[this.directionKey.width]*t.length)||0,n=(0,a.Hi)(t.text,i,t.character,r,"break-word"===this.frame.wordBreak);if(0!==n){let[i,r]=function(t,e){let i=t.text.slice(0,e),r=t.text.slice(e);return[new d(i,t.newLine,t.character,t.ascentDescentMode),new d(r,!0,t.character,t.ascentDescentMode)]}(t,n);this.store(i),e?this.send():this.deal(r)}else 0!==this.lineBuffer.length&&(this.send(),this.deal(t))}}var y=i(4062),v=i(16049),b=i(79314);let _=!1;try{_=Intl&&"function"==typeof Intl.Segmenter}catch(t){_=!1}let x=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity",...s.DH];class C extends s.zs{constructor(t){super(t),this.type="richtext",this._currentHoverIcon=null,this.numberType=b.$M,this.onBeforeAttributeUpdate=(t,e,i)=>{for(let i in t)if("hoverIconId"===i){if(t[i]===e[i])continue;let r=this._frameCache.icons.get(t[i]);this.updateHoverIconState(r)}}}get width(){var t;return null!=(t=this.attribute.width)?t:l.Iq.width}set width(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}get height(){var t;return null!=(t=this.attribute.height)?t:l.Iq.height}set height(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}get maxWidth(){return this.attribute.maxWidth}set maxWidth(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}get maxHeight(){return this.attribute.maxHeight}set maxHeight(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}get ellipsis(){var t;return null!=(t=this.attribute.ellipsis)?t:l.Iq.ellipsis}set ellipsis(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}get wordBreak(){var t;return null!=(t=this.attribute.wordBreak)?t:l.Iq.wordBreak}set wordBreak(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}get verticalDirection(){var t;return null!=(t=this.attribute.verticalDirection)?t:l.Iq.verticalDirection}set verticalDirection(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}get textAlign(){var t;return null!=(t=this.attribute.textAlign)?t:l.Iq.textAlign}set textAlign(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}get textBaseline(){var t;return null!=(t=this.attribute.textBaseline)?t:l.Iq.textBaseline}set textBaseline(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}get textConfig(){var t;return null!=(t=this.attribute.textConfig)?t:l.Iq.textConfig}set textConfig(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}getGraphicTheme(){return(0,y.gh)(this).richtext}static AllSingleCharacter(t){return t.lines?t.lines.every(t=>t.paragraphs.every(t=>!(t.text&&(0,r.Z)(t.text)&&C.splitText(t.text).length>1))):t.every(t=>t.isComposing||!(t.text&&(0,r.Z)(t.text)&&C.splitText(t.text).length>1))}static splitText(t){if(_){let e=new Intl.Segmenter(void 0,{granularity:"grapheme"}),i=[];for(let{segment:r}of e.segment(t))i.push(r);return i}return Array.from(t)}static TransformTextConfig2SingleCharacter(t){let e=[];return t.forEach(t=>{let i=C.splitText(t.text.toString());if((0,r.Z)(t.text)&&i.length>1)for(let r=0;r<i.length;r++){let n=i[r];e.push(Object.assign(Object.assign({},t),{text:n}))}else e.push(t)}),e}updateAABBBounds(t,e,i){var r,n,s,l;let{width:a=e.width,height:o=e.height,maxWidth:h=e.maxWidth,maxHeight:u=e.maxHeight,textAlign:d=e.textAlign,textBaseline:c=null!=(n=null!=(r=t.textBaseline)?r:e.textBaseline)?n:"top",editOptions:p}=t;if(a>0&&o>0)i.set(0,0,a,o);else{let{width:t,height:e}=this.getFrameCache().getActualSize(),r=a||t||0,n=o||e||0;n="number"==typeof u&&n>u?u:n||0,r="number"==typeof h&&r>h?h:r||0,i.set(0,0,r,n)}!p||!p.keepHeightWhileEmpty||i.height()||(null==(s=t.textConfig)?void 0:s.length)||(i.y2=i.y1+(null!=(l=t.fontSize)?l:12),i.x2=i.x1+2);let g=0;switch(c){case"top":g=0;break;case"middle":g=-i.height()/2;break;case"bottom":g=-i.height()}let f=0;switch(d){case"left":f=0;break;case"center":f=-i.width()/2;break;case"right":f=-i.width()}return o||("middle"===this.verticalDirection?g-=i.height()/2:"bottom"===this.verticalDirection&&(g-=i.height())),i.translate(f,g),v.w.graphicService.updateTempAABBBounds(i),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||v.w.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,v.w.graphicService.transformAABBBounds(t,i,e,!1,this),0===i.width()&&0===i.height()&&i.clear(),i}needUpdateTags(t){return super.needUpdateTags(t,x)}needUpdateTag(t){return super.needUpdateTag(t,x)}getFrameCache(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}get cliped(){let t=this.getFrameCache();if(t.actualHeight>t.height)return!0;let{disableAutoWrapLine:e}=this.attribute;if(e)for(let e=0;e<t.lines.length;e++){let i=t.lines[e];for(let t=0;t<i.paragraphs.length;t++){let e=i.paragraphs[t];if(e.overflow&&""!==e.text)return!0}}return!1}combinedStyleToCharacter(t){let{fill:e,stroke:i,fontSize:r,fontFamily:n,fontStyle:s,fontWeight:l,lineWidth:a,opacity:o,fillOpacity:h,lineHeight:u,strokeOpacity:d,upgradeAttrs:c}=this.attribute,p=Object.assign({fill:e,stroke:i,fontSize:r,fontFamily:n,fontStyle:s,fontWeight:l,lineWidth:a,opacity:o,fillOpacity:h,strokeOpacity:d},t);return(null==c?void 0:c.lineHeight)&&(p.lineHeight=u),p}doUpdateFrameCache(t){var e;let{maxWidth:i,maxHeight:r,width:s,height:l,ellipsis:a,wordBreak:h,verticalDirection:u,textAlign:c,textBaseline:p,layoutDirection:f,singleLine:y,disableAutoWrapLine:v,editable:b,ascentDescentMode:_,upgradeAttrs:x}=this.attribute,w=x&&x.multiBreakLine,{textConfig:S=[]}=this.attribute;b&&S.length>0&&!C.AllSingleCharacter(S)&&(S=C.TransformTextConfig2SingleCharacter(S),this.attribute.textConfig=S);let A=[],M=null!=t?t:S;for(let t=0;t<M.length;t++)if("image"in M[t]){let e=this.combinedStyleToCharacter(M[t]);e.lineWidth=void 0;let i=e.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(e.id);if(i)A.push(i);else{let t=new g(e);t.successCallback=()=>{var t;this.addUpdateBoundTag(),null==(t=this.stage)||t.renderNextFrame()},t.richtextId=e.id,A.push(t)}}else{let e=this.combinedStyleToCharacter(M[t]);if((0,n.Z)(e.text)&&(e.text=`${e.text}`),e.text&&e.text.includes("\n")){let i=e.text.split("\n");for(let r=0;r<i.length;r++)if(0===r)A.push(new d(i[r],!1,e,_));else if(i[r]||t===M.length-1)A.push(new d(i[r],!0,e,_));else{let e=this.combinedStyleToCharacter(M[t+1]);A.push(new d(i[r],!0,e,_))}}else e.text&&A.push(new d(e.text,!1,e,_))}let k="number"==typeof i&&Number.isFinite(i)&&i>0,T="number"==typeof r&&Number.isFinite(r)&&r>0,R="number"==typeof s&&Number.isFinite(s)&&s>0&&(!k||s<=i),B="number"==typeof l&&Number.isFinite(l)&&l>0&&(!T||l<=r),P=new o(0,0,(R?s:k?i:0)||0,(B?l:T?r:0)||0,a,h,u,c,p,f||"horizontal",!R&&k,!B&&T,y||!1,null==(e=this._frameCache)?void 0:e.icons),E=new m(P);if(E.newLine=w,v){let t=0,e=!1;for(let i=0;i<A.length;i++){let r=A[i];e?(r.overflow=!0,r.left=1/0,r.top=1/0,r.newLine||P.lines[P.lines.length-1].paragraphs.push(r)):E.deal(r,!0),P.lines.length!==t&&(t=P.lines.length,E.lineBuffer.length=0,r.overflow=!0,r.left=1e3,r.top=1e3,P.lines[P.lines.length-1].paragraphs.push(r),e=!0),r.newLine&&(e=!1,E.lineWidth=0),E.send()}}else for(let t=0;t<A.length;t++)E.deal(A[t]);if(E.send(),!("horizontal"===P.layoutDirection?R:B)){let t=P.getActualSizeWidthEllipsis(),e="horizontal"===P.layoutDirection?t.width:t.height;("horizontal"===P.layoutDirection?k:T)&&(e=Math.min(e,"horizontal"===P.layoutDirection?i:r)),P.lines.forEach(function(t){t.calcOffset(e,!1)})}w&&P.lines.forEach(t=>{let e=t.paragraphs;t.paragraphs=t.paragraphs.filter(t=>""!==t.text),0===t.paragraphs.length&&e.length&&(e[0].text="\n",t.paragraphs.push(e[0]))}),this._frameCache=P}clone(){return new C(Object.assign({},this.attribute))}setStage(t,e){super.setStage(t,e),this.getFrameCache().icons.forEach(i=>{i.setStage(t,e)})}bindIconEvent(){this.addEventListener("pointermove",t=>{let e=this.pickIcon(t.global);e&&e===this._currentHoverIcon||(e?this.setAttribute("hoverIconId",e.richtextId):!e&&this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0))}),this.addEventListener("pointerleave",t=>{this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0)})}updateHoverIconState(t){var e,i,r,n,s;t?(null==(e=this._currentHoverIcon)||e.setHoverState(!1),this._currentHoverIcon=t,this._currentHoverIcon.setHoverState(!0),null==(i=this.stage)||i.setCursor(t.attribute.cursor),null==(r=this.stage)||r.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,null==(n=this.stage)||n.setCursor(),null==(s=this.stage)||s.renderNextFrame())}pickIcon(t){let e,i=this.getFrameCache(),{e:r,f:n}=this.globalTransMatrix;return i.icons.forEach((i,s)=>{var l,a;let o=i.AABBBounds.clone();o.translate(i._marginArray[3],i._marginArray[0]),o.containsPoint({x:t.x-r,y:t.y-n})&&((e=i).globalX=(null!=(l=e.attribute.x)?l:0)+r+i._marginArray[3],e.globalY=(null!=(a=e.attribute.y)?a:0)+n+i._marginArray[0])}),e}getNoWorkAnimateAttr(){return C.NOWORK_ANIMATE_ATTR}}function w(t){return new C(t)}C.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},s.Wl)},21295:function(t,e,i){"use strict";i.d(e,{Hi:()=>g,MS:()=>m,SZ:()=>f,cV:()=>u,i7:()=>l,nq:()=>c,p3:()=>p});var r=i(16049),n=i(21823),s=i(71071);let l={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},a={fontSize:16,fontFamily:s.iR,fill:!0,stroke:!1,fontWeight:"normal",lineHeight:"normal",fontStyle:"normal",textDecoration:"none",textAlign:"left",script:"normal"};String.fromCharCode(160);let o=/\w|\(|\)|-/,h=/[.?!,;:/，。？！、；：]/,u=/\S/,d=(t,e)=>{let i=e.fontSize||16;switch(e.script){case"super":case"sub":i*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:i,fontFamily:e.fontFamily})};function c(t,e,i){let r=e&&e.fill||a.fill;if(!r)return void(t.globalAlpha=0);let{fillOpacity:s=1,opacity:l=1}=e;t.globalAlpha=s*l,t.fillStyle=i?(0,n.L)(t,r,{AABBBounds:i}):r,d(t,e)}function p(t,e){let i=e&&e.stroke||a.stroke;if(!i)return void(t.globalAlpha=0);let{strokeOpacity:r=1,opacity:n=1}=e;t.globalAlpha=r*n,t.lineWidth=e&&"number"==typeof e.lineWidth?e.lineWidth:1,t.strokeStyle=i,d(t,e)}function g(t,e,i,n,s){if(t.length<=1||!e||e<=0)return 0;let l=r.w.graphicUtil.textMeasure,a=n,o=t.slice(0,a),h=Math.floor(l.measureText(o,i).width),u=t.slice(0,a+1),d=Math.floor(l.measureText(u,i).width);for(;h>e||d<=e;){if(h>e?a--:a++,a>t.length){a=t.length;break}if(a<0){a=0;break}o=t.slice(0,a),h=Math.floor(l.measureText(o,i).width),u=t.slice(0,a+1),d=Math.floor(l.measureText(u,i).width)}return s&&(a=f(t,a)),a}function f(t,e,i=!1){let r=e;for(;o.test(t[r-1])&&o.test(t[r])||h.test(t[r]);)if(--r<=0)return i?function(t,e){let i=e;for(;o.test(t[i+1])&&o.test(t[i])||h.test(t[i]);)if(++i>=t.length)return i;return i+1}(t,e):e;return r}function m(t,e,i="actual"){var n;if(""===t)return{ascent:0,height:0,descent:0,width:0};let s=r.w.graphicUtil.textMeasure.measureText(t,e),l={ascent:0,height:0,descent:0,width:0},a="actual"===i?s.actualBoundingBoxAscent:s.fontBoundingBoxAscent,o="actual"===i?s.actualBoundingBoxDescent:s.fontBoundingBoxDescent;"number"!=typeof a||"number"!=typeof o?(l.width=Math.floor(s.width),l.height=e.fontSize||0,l.ascent=l.height,l.descent=0):(l.width=Math.floor(s.width),l.height=Math.floor(a+o),l.ascent=Math.floor(a),l.descent=l.height-l.ascent);let h=null!=(n=e.space)?n:0;return l.width+=h,l}},8042:function(t,e,i){"use strict";i.d(e,{t:()=>p,m:()=>c});var r=i(31535),n=i(26670),s=i(4062),l=i(16049),a=i(33974),o=i(79314),h=i(72790);let u=(t,e,i)=>{let{outerBorder:r,shadowBlur:n=e.shadowBlur,strokeBoundsBuffer:s=e.strokeBoundsBuffer}=t;if(r){let t=e.outerBorder,{distance:l=t.distance,lineWidth:a=t.lineWidth}=r;(0,h.ph)(i,l+(n+a)/2,!0,s)}return i},d=["symbolType","size",...n.DH];class c extends n.zs{constructor(t={symbolType:"circle"}){super(t),this.type="symbol",this.numberType=o.B5}getParsedPath(){return this.shouldUpdateShape()&&(this._parsedPath=this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}getParsedPath2D(t=0,e=0,i=1){let r=null;try{r=new Path2D}catch(t){return null}let n=this.getParsedPath();if(!n)return null;n.draw(r,i,t,e)}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{size:t}=this.attribute;return(0,r.Z)(t)?2===t.length&&t.every(this._validNumber):this._validNumber(t)}doUpdateParsedPath(){let{symbolType:t="circle"}=this.attribute;return super.parsePath(t)}getGraphicTheme(){return(0,s.gh)(this).symbol}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateSymbolAABBBoundsImprecise(t,e,i):this.updateSymbolAABBBoundsAccurate(t,e,i));let{tb1:n,tb2:s}=l.w.graphicService.updateTempAABBBounds(i);u(t,e,n),i.union(n),n.setValue(s.x1,s.y1,s.x2,s.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,this.x1WithoutTransform=i.x1,this.y1WithoutTransform=i.y1;let{lineJoin:a=e.lineJoin}=t;return l.w.graphicService.transformAABBBounds(t,i,e,"miter"===a,this),i}updateSymbolAABBBoundsImprecise(t,e,i){let{size:n=e.size}=t;if((0,r.Z)(n))i.set(-n[0]/2,-n[1]/2,n[0]/2,n[1]/2);else{let t=n/2;i.set(-t,-t,t,t)}return i}updateSymbolAABBBoundsAccurate(t,e,i){let{size:r=e.size}=t;return this.getParsedPath().bounds(r,i),i}needUpdateTags(t){return super.needUpdateTags(t,d)}needUpdateTag(t){return super.needUpdateTag(t,d)}toCustomPath(){let t=this.getParsedPath(),e=this.attribute.size,i=(0,r.Z)(e)?e:[e,e];return t.path?(new a.r).fromCustomPath2D(t.path,0,0,i[0],i[1]):(new a.r).fromString(t.pathStr,0,0,i[0],i[1])}clone(){return new c(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return c.NOWORK_ANIMATE_ATTR}}function p(t){return new c(t)}c.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},n.Wl)},64103:function(t,e,i){"use strict";i.d(e,{r:()=>v,x:()=>y});var r=i(28504),n=i(31535),s=i(33049),l=i(76620),a=i(88504),o=i(38939),h=i(10797),u=i(16049),d=i(26670),c=i(4062),p=i(70749),g=i(79314),f=i(72790);let m=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp",...d.DH];class y extends d.zs{get font(){let t=this.getGraphicTheme();return this._font||(this._font=(0,r.U)(this.attribute,t)),this._font}get clipedText(){var t;let e=this.attribute,i=this.getGraphicTheme();return Number.isFinite(this.getMaxWidth(i))?(this.tryUpdateAABBBounds(),this.cache.clipedText):(null!=(t=e.text)?t:i.text).toString()}get clipedWidth(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}get cliped(){var t,e;let i=this.getGraphicTheme(),r=this.attribute;if(!Number.isFinite(this.getMaxWidth(i)))return!1;let{text:n}=this.attribute;if(this.tryUpdateAABBBounds(),null==(e=null==(t=this.cache)?void 0:t.layoutData)?void 0:e.lines){let t="";return this.cache.layoutData.lines.forEach(e=>{t+=e.str}),(Array.isArray(n)?n.join(""):n).toString()!==t}return"vertical"===r.direction&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map(t=>t.text).join("")!==r.text.toString():null!=this.clipedText&&this.clipedText!==r.text.toString()}get multilineLayout(){return this.tryUpdateAABBBounds(),this.cache.layoutData}get isMultiLine(){return Array.isArray(this.attribute.text)||"normal"===this.attribute.whiteSpace}constructor(t={text:"",fontSize:16}){super(t),this.type="text",this.numberType=g.Us,this.cache={}}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{text:t}=this.attribute;return(0,n.Z)(t)?!t.every(t=>null==t||""===t):null!=t&&""!==t}getGraphicTheme(){return(0,c.gh)(this).text}doUpdateOBBBounds(){let t=this.getGraphicTheme();this._OBBBounds.clear();let e=this.attribute,{angle:i=t.angle}=e;if(!i){let t=this.AABBBounds;return this._OBBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._OBBBounds}this.obbText||(this.obbText=new y({})),this.obbText.setAttributes(Object.assign(Object.assign({},e),{angle:0}));let r=this.obbText.AABBBounds,{x:n,y:l}=e,a={x:(r.x1+r.x2)/2,y:(r.y1+r.y2)/2},o=(0,s.xj)(a,i,{x:n,y:l});return this._OBBBounds.copy(r),this._OBBBounds.translate(o.x-a.x,o.y-a.y),this._OBBBounds.angle=i,this._OBBBounds}updateAABBBounds(t,e,i){let{text:r=e.text}=this.attribute;Array.isArray(r)?this.updateMultilineAABBBounds(r):this.updateSingallineAABBBounds(r);let{tb1:n}=u.w.graphicService.updateTempAABBBounds(i),{scaleX:s=e.scaleX,scaleY:a=e.scaleY,shadowBlur:o=e.shadowBlur,strokeBoundsBuffer:h=e.strokeBoundsBuffer}=t;if(o){let t=o/Math.abs(s+a);(0,f.ph)(n,t,!0,h),i.union(n)}return u.w.graphicService.combindShadowAABBBounds(i,this),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||u.w.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,(0,l.n2)(i,i,this.transMatrix),i}updateSingallineAABBBounds(t){this.updateMultilineAABBBounds([t]);let e=this.cache.layoutData;if(e&&e.lines&&e.lines.length){let t=e.lines[0];this.cache.clipedText=t.str,this.cache.clipedWidth=t.width}return this._AABBBounds}updateMultilineAABBBounds(t){let e=this.getGraphicTheme(),{direction:i=e.direction,underlineOffset:r=e.underlineOffset}=this.attribute,n="horizontal"===i?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return"horizontal"===i&&r&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+r),n}guessLineHeightBuf(t){return t?.1*t:0}updateHorizontalMultilineAABBBounds(t){var e,i;let r=this.getGraphicTheme(),n=this.attribute,{fontFamily:s=r.fontFamily,textAlign:l=r.textAlign,textBaseline:a=r.textBaseline,fontSize:o=r.fontSize,fontWeight:d=r.fontWeight,ellipsis:c=r.ellipsis,maxLineWidth:p,stroke:g=r.stroke,wrap:f=r.wrap,measureMode:m=r.measureMode,lineWidth:y=r.lineWidth,whiteSpace:v=r.whiteSpace,suffixPosition:b=r.suffixPosition,ignoreBuf:_=r.ignoreBuf,keepCenterInLine:x=r.keepCenterInLine}=n,C=_?0:this.guessLineHeightBuf(o),w=this.getLineHeight(n,r,C);if("normal"===v||f)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(null==(e=this.cache)?void 0:e.layoutData)){let t=this.cache.layoutData.bbox;return this._AABBBounds.set(t.xOffset,t.yOffset,t.xOffset+t.width,t.yOffset+t.height),g&&this._AABBBounds.expand(y/2),this._AABBBounds}let S=u.w.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null==(i=this.stage)?void 0:i.textMeasureId)),A=new h.j(s,{fontSize:o,fontWeight:d,fontFamily:s,lineHeight:w},S).GetLayoutByLines(t,l,a,w,!0===c?r.ellipsis:c||void 0,!1,{lineWidth:p,suffixPosition:b,measureMode:m,keepCenterInLine:x}),{bbox:M}=A;return this.cache.layoutData=A,this.clearUpdateShapeTag(),this._AABBBounds.set(M.xOffset,M.yOffset,M.xOffset+M.width,M.yOffset+M.height),g&&this._AABBBounds.expand(y/2),this._AABBBounds}updateWrapAABBBounds(t){var e,i,r,s;let l=this.getGraphicTheme(),{fontFamily:a=l.fontFamily,textAlign:o=l.textAlign,textBaseline:d=l.textBaseline,fontSize:c=l.fontSize,ellipsis:p=l.ellipsis,maxLineWidth:g,stroke:f=l.stroke,lineWidth:m=l.lineWidth,wordBreak:y=l.wordBreak,fontWeight:v=l.fontWeight,ignoreBuf:b=l.ignoreBuf,measureMode:_=l.measureMode,suffixPosition:x=l.suffixPosition,heightLimit:C=0,lineClamp:w,keepCenterInLine:S=l.keepCenterInLine}=this.attribute,A=b?0:this.guessLineHeightBuf(c),M=this.getLineHeight(this.attribute,l,A);if(!this.shouldUpdateShape()&&(null==(e=this.cache)?void 0:e.layoutData)){let t=this.cache.layoutData.bbox;return this._AABBBounds.set(t.xOffset,t.yOffset,t.xOffset+t.width,t.yOffset+t.height),f&&this._AABBBounds.expand(m/2),this._AABBBounds}let k=u.w.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null==(i=this.stage)?void 0:i.textMeasureId)),T={fontSize:c,fontWeight:v,fontFamily:a,lineHeight:M},R=new h.j(a,T,k),B=(0,n.Z)(t)?t.map(t=>t.toString()):[t.toString()],P=[],E=[0,0],I=1/0;if(C>0&&(I=Math.max(Math.floor(C/M),1)),w&&(I=Math.min(I,w)),"number"==typeof g&&g!==1/0){if(g>0)for(let t=0;t<B.length;t++){let e=B[t],i=!0;if(t===I-1){let i=k.clipTextWithSuffix(e,T,g,p,!1,x,t!==B.length-1),r=k.measureTextPixelADscentAndWidth(i.str,T,_);P.push({str:i.str,width:i.width,ascent:r.ascent,descent:r.descent,keepCenterInLine:S});break}let n=k.clipText(e,T,g,"break-all"!==y,"keep-all"===y);if(""!==e&&""===n.str||n.wordBreaked){if(p){let t=k.clipTextWithSuffix(e,T,g,p,!1,x);n.str=null!=(r=t.str)?r:"",n.width=null!=(s=t.width)?s:0}else n.str="",n.width=0;i=!1}let l=k.measureTextPixelADscentAndWidth(n.str,T,_);P.push({str:n.str,width:n.width,ascent:l.ascent,descent:l.descent,keepCenterInLine:S});let a=n.str.length;if(n.wordBreaked&&(""===e||""!==n.str)&&(i=!0,a=n.wordBreaked),n.str.length===e.length);else if(i){let i=e.substring(a);"keep-all"===y&&(i=i.replace(/^\s+/g,"")),B.splice(t+1,0,i)}}let t=0;P.forEach(e=>{t=Math.max(t,e.width)}),E[0]=t}else{let t,e,i=0;for(let r=0,n=B.length;r<n;r++){if(r===I-1){let t=k.clipTextWithSuffix(B[r],T,g,p,!1,x),e=k.measureTextPixelADscentAndWidth(t.str,T,_);P.push({str:t.str,width:t.width,ascent:e.ascent,descent:e.descent,keepCenterInLine:S}),i=Math.max(i,t.width);break}e=B[r],i=Math.max(i,t=k.measureTextWidth(e,T));let n=k.measureTextPixelADscentAndWidth(e,T,_);P.push({str:e,width:t,ascent:n.ascent,descent:n.descent,keepCenterInLine:S})}E[0]=i}E[1]=P.length*M;let L={xOffset:0,yOffset:0,width:E[0],height:E[1]};R.LayoutBBox(L,o,d,P);let F=R.layoutWithBBox(L,P,o,d,M);return this.cache.layoutData=F,this.clearUpdateShapeTag(),this._AABBBounds.set(L.xOffset,L.yOffset,L.xOffset+L.width,L.yOffset+L.height),f&&this._AABBBounds.expand(m/2),this._AABBBounds}updateVerticalMultilineAABBBounds(t){var e,i,r;let n,s=this.getGraphicTheme(),l=u.w.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null==(e=this.stage)?void 0:e.textMeasureId)),h=this.attribute,{maxLineWidth:d=s.maxLineWidth,ellipsis:c=s.ellipsis,fontFamily:p=s.fontFamily,fontSize:g=s.fontSize,fontWeight:m=s.fontWeight,stroke:v=s.stroke,lineWidth:b=s.lineWidth,verticalMode:_=s.verticalMode,suffixPosition:x=s.suffixPosition}=h,C=this.getLineHeight(h,s,0),{textAlign:w=s.textAlign,textBaseline:S=s.textBaseline}=h;if(!_){let t=w;w=null!=(i=y.baselineMapAlign[S])?i:"left",S=null!=(r=y.alignMapBaseline[t])?r:"top"}if(n=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach(t=>{let e=t.reduce((t,e)=>t+e.width,0);n=(0,a.Fp)(e,n)});let t=(0,o.js)(w,n),e=this.cache.verticalList.length*C,i=(0,o.nV)(S,e,g);return this._AABBBounds.set(i,t,i+e,t+n),v&&this._AABBBounds.expand(b/2),this._AABBBounds}let A=t.map(t=>(0,f.Xk)(t.toString()));A.forEach((t,e)=>{if(Number.isFinite(d))if(c){let i=!0===c?s.ellipsis:c,r=l.clipTextWithSuffixVertical(t,{fontSize:g,fontWeight:m,fontFamily:p},d,i,!1,x);A[e]=r.verticalList,n=r.width}else{let i=l.clipTextVertical(t,{fontSize:g,fontWeight:m,fontFamily:p},d,!1);A[e]=i.verticalList,n=i.width}else n=0,t.forEach(t=>{let e=t.direction===f.m5.HORIZONTAL?g:l.measureTextWidth(t.text,{fontSize:g,fontWeight:m,fontFamily:p});n+=e,t.width=e})}),this.cache.verticalList=A,this.clearUpdateShapeTag(),this.cache.verticalList.forEach(t=>{let e=t.reduce((t,e)=>t+e.width,0);n=(0,a.Fp)(e,n)});let M=(0,o.js)(w,n),k=this.cache.verticalList.length*C,T=(0,o.nV)(S,k,g);return this._AABBBounds.set(T,M,T+k,M+n),v&&this._AABBBounds.expand(b/2),this._AABBBounds}getMaxWidth(t){var e,i;let r=this.attribute;return null!=(i=null!=(e=r.maxLineWidth)?e:r.maxWidth)?i:t.maxWidth}getLineHeight(t,e,i){var r;return null!=(r=(0,p.VA)(t.lineHeight,t.fontSize||e.fontSize))?r:(t.fontSize||e.fontSize)+i}needUpdateTags(t,e=m){return super.needUpdateTags(t,e)}needUpdateTag(t,e=m){return super.needUpdateTag(t,e)}_interpolate(t,e,i,r,n){"text"===t&&(n.text=r)}clone(){return new y(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return y.NOWORK_ANIMATE_ATTR}getBaselineMapAlign(){return y.baselineMapAlign}getAlignMapBaseline(){return y.alignMapBaseline}}function v(t){return new y(t)}y.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},d.Wl),y.baselineMapAlign={top:"left",bottom:"right",middle:"center"},y.alignMapBaseline={left:"top",right:"bottom",center:"middle"}},4062:function(t,e,i){"use strict";i.d(e,{Q2:()=>h,gh:()=>function t(e,i){return e.glyphHost?t(e.glyphHost):i?(e.isContainer,i):function(t){let e;if(e=t.isContainer?t:t.parent){for(;e&&!e.theme;)e=e.parent;return e?(e.theme||e.createTheme(),e.theme.getTheme(e)):u.getTheme()}return null}(e)||e.attachedThemeGraphic&&t(e.attachedThemeGraphic)||u.getTheme()}});var r=i(30943),n=i(36081);let s={arc:n.Up,area:n.eh,circle:n.t8,line:n.h8,path:n.J7,symbol:n.th,text:n.T5,rect:n.kx,polygon:n.ZD,star:n.VF,richtext:n.Iq,richtextIcon:n.YW,image:n.jK,group:n.bZ,glyph:n.e9},l=Object.keys(s);function a(t,e){Object.keys(e).forEach(i=>{t[i]=e[i]})}let o={arc:Object.assign({},s.arc),area:Object.assign({},s.area),circle:Object.assign({},s.circle),line:Object.assign({},s.line),path:Object.assign({},s.path),symbol:Object.assign({},s.symbol),text:Object.assign({},s.text),rect:Object.assign({},s.rect),polygon:Object.assign({},s.polygon),star:Object.assign({},s.star),richtext:Object.assign({},s.richtext),richtextIcon:Object.assign({},s.richtextIcon),image:Object.assign({},s.image),group:Object.assign({},s.group),glyph:Object.assign({},s.glyph)};class h{constructor(){this.initTheme(),this.dirty=!1}initTheme(){this._defaultTheme={},l.forEach(t=>{this._defaultTheme[t]=Object.create(o[t])}),this.combinedTheme=this._defaultTheme}getTheme(t){if(!t||!this.dirty)return this.combinedTheme;let e={},i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}getParentWithTheme(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}applyTheme(t,e,i=!1){if(this.dirty){let n=this.getParentWithTheme(t);if(n){let t=n.theme;(t.dirty||i)&&t.applyTheme(n,e,!0)}this.userTheme?this.doCombine(n&&n.theme.combinedTheme):(n?this.combinedTheme=n.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,r.Y.getInstance().warn("未知错误，走到不应该走的区域里")),this.dirty=!1)}return this.combinedTheme}doCombine(t){let e=this.userTheme,i=this.combinedTheme;l.forEach(r=>{let n=Object.create(o[r]);t&&t[r]&&a(n,t[r]),i[r]&&a(n,i[r]),e[r]&&a(n,e[r]),this.combinedTheme[r]=n}),e.common&&l.forEach(t=>{a(this.combinedTheme[t],e.common)}),this.dirty=!1}setTheme(t,e){let i=this.userTheme;i?Object.keys(t).forEach(e=>{i[e]?Object.assign(i[e],t[e]):i[e]=Object.assign({},t[e])}):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}resetTheme(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}dirtyChildren(t){t.forEachChildren(t=>{t.isContainer&&(t.theme&&(t.theme.dirty=!0),this.dirtyChildren(t))})}}let u=new h},72790:function(t,e,i){"use strict";i.d(e,{Gg:()=>h,Xk:()=>u,b4:()=>l,m5:()=>n,ph:()=>a});var r,n,s=i(16049);function l(t){var e,i,r,n;return e=this,i=void 0,r=void 0,n=function*(){let e=[],i=t.getChildren();yield new Promise(t=>{s.w.global.getRequestAnimationFrame()(()=>{t(null)})}),i.forEach(t=>{t.subLayers.size&&t.subLayers.forEach(t=>{t.drawContribution&&t.drawContribution.hooks&&t.drawContribution.rendering&&e.push(new Promise(e=>{t.drawContribution.hooks.completeDraw.tap("outWait",()=>{t.drawContribution.hooks.completeDraw.taps=t.drawContribution.hooks.completeDraw.taps.filter(t=>"outWait"!==t.name),e(null)})}))})}),yield Promise.all(e)},new(r||(r=Promise))(function(t,s){function l(t){try{o(n.next(t))}catch(t){s(t)}}function a(t){try{o(n.throw(t))}catch(t){s(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(l,a)}o((n=n.apply(e,i||[])).next())})}function a(t,e,i,r=0){var n,s;return t.expand(e+(r/2+(i?(n=i,s=e,n?s:0):0))),t}let o=0;function h(){return o++}function u(t){let e=[],i=0,r="";for(let s=0;s<t.length;s++)!function(t){if(d.has(t))return!0;if(c.has(t))return!1;let e=!1;return 256>t.codePointAt(0)&&(e=!0),e}(t[s])?(i&&(e.push({text:r,direction:n.VERTICAL}),r="",i=0),e.push({text:t[s],direction:n.HORIZONTAL})):i?r+=t[s]:(i=1,r=t[s]);return r&&e.push({text:r,direction:n.VERTICAL}),e}(r=n||(n={}))[r.HORIZONTAL=0]="HORIZONTAL",r[r.VERTICAL=1]="VERTICAL";let d=new Map;["…","（","）","—","【","】","「","」","《","》"].forEach(t=>d.set(t,!0));let c=new Map;[""].forEach(t=>c.set(t,!0))},9511:function(t,e,i){"use strict";var r,n;i.d(e,{Q:()=>r}),(n=r||(r={}))[n.INITIAL=0]="INITIAL",n[n.RUNNING=1]="RUNNING",n[n.PAUSE=2]="PAUSE"},41075:function(t,e,i){"use strict";var r,n,s,l;i.d(e,{T:()=>r,t:()=>n}),(s=r||(r={})).wait="wait",s.from="from",s.to="to",s.customAnimate="customAnimate",(l=n||(n={}))[l.INITIAL=0]="INITIAL",l[l.RUNNING=1]="RUNNING",l[l.PAUSED=2]="PAUSED",l[l.END=3]="END"},32623:function(t,e,i){"use strict";var r,n;i.d(e,{r:()=>r}),(n=r||(r={}))[n.estimate=0]="estimate",n[n.actualBounding=1]="actualBounding",n[n.fontBounding=2]="fontBounding"},89983:function(t,e,i){"use strict";i.d(e,{rF:()=>tZ,WN:()=>tU,VJ:()=>tV});var r,n=i(99262),s=i(26004),l=i(47061),a=i(6146),o=i(58233),h=i(2079),u=i(71071),d=i(40398),c=i(42159),p=i(99072),g=function(t,e){return function(i,r){e(i,r,t)}};let f=class extends p.w{get env(){return this._env}get isImageAnonymous(){return this._isImageAnonymous}set isImageAnonymous(t){this._isImageAnonymous=t}get devicePixelRatio(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}get supportEvent(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent}set supportEvent(t){this._env||this.setEnv("browser"),this.envContribution.supportEvent=t}get supportsTouchEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents}set supportsTouchEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=t}get supportsPointerEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents}set supportsPointerEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=t}get supportsMouseEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents}set supportsMouseEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=t}get applyStyles(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles}set applyStyles(t){this._env||this.setEnv("browser"),this.envContribution.applyStyles=t}constructor(t){super(),this.contributions=t,this._isImageAnonymous=!0,this._performanceRAFList=[],this.eventListenerTransformer=t=>t,this.id=d.R.GenAutoIncrementId(),this.hooks={onSetEnv:new h.n(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}_nativeAddEventListener(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(t,e,i)}_nativeRemoveEventListener(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(t,e,i)}_nativeDispatchEvent(t){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(t)}bindContribution(t){let e=[];if(this.contributions.getContributions().forEach(i=>{let r=i.configure(this,t);r&&r.then&&e.push(r)}),e.length)return Promise.all(e)}getDynamicCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}getStaticCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}setEnv(t,e){if(e&&!0===e.force||this._env!==t)return this.deactiveCurrentEnv(),this.activeEnv(t,e)}deactiveCurrentEnv(){this.envContribution&&this.envContribution.release()}activeEnv(t,e){let i=this._env;this._env=t;let r=this.bindContribution(e);if(r&&r.then)return r.then(()=>{this.envParams=e,this.hooks.onSetEnv.call(i,t,this)});this.envParams=e,this.hooks.onSetEnv.call(i,t,this)}setActiveEnvContribution(t){this.envContribution=t}createCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(t)}createOffscreenCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(t)}releaseCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(t)}getRequestAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}getSpecifiedRequestAnimationFrame(t){this._env||this.setEnv("browser"),this._performanceRAFList[t]||(this._performanceRAFList[t]=new c.A);let e=this._performanceRAFList[t];return t=>e.addAnimationFrameCb(t)}getSpecifiedCancelAnimationFrame(t){if(this._env||this.setEnv("browser"),!this._performanceRAFList[t])return()=>!1;let e=this._performanceRAFList[t];return t=>e.removeAnimationFrameCb(t)}getCancelAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}getElementById(t){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(t):null}getRootElement(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}getDocument(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}mapToCanvasPoint(t,e){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(t,e):null}loadImage(t){return this._env||this.setEnv("browser"),this.envContribution.loadImage(t)}loadSvg(t){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(t)}loadJson(t){return this._env||this.setEnv("browser"),this.envContribution.loadJson(t)}loadArrayBuffer(t){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(t)}loadBlob(t){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(t)}loadFont(t,e,i){var r,n,s,l;return r=this,n=void 0,s=void 0,l=function*(){return this._env||this.setEnv("browser"),this.envContribution.loadFont(t,e,i)},new(s||(s=Promise))(function(t,e){function i(t){try{o(l.next(t))}catch(t){e(t)}}function a(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof s?r:new s(function(t){t(r)})).then(i,a)}o((l=l.apply(r,n||[])).next())})}isChrome(){return null!=this._isChrome||(this._env||this.setEnv("browser"),this._isChrome="browser"===this._env&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}isSafari(){return null!=this._isSafari||(this._env||this.setEnv("browser"),this._isSafari="browser"===this._env&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}getNativeAABBBounds(t){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(t)}removeDom(t){return this._env||this.setEnv("browser"),this.envContribution.removeDom(t)}createDom(t){return this._env||this.setEnv("browser"),this.envContribution.createDom(t)}updateDom(t,e){return this._env||this.setEnv("browser"),this.envContribution.updateDom(t,e)}getElementTop(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTop(t,e)}getElementLeft(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(t,e)}getElementTopLeft(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(t,e)}isMacOS(){return this._env||this.setEnv("browser"),this.envContribution.isMacOS()}copyToClipBoard(t){return this._env||this.setEnv("browser"),this.envContribution.copyToClipBoard(t)}};f=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)(),g(0,(0,l.f)(o.Qc)),g(0,(0,a.t)(u.D0)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],f);var m=i(46919),y=i(36081),v=i(21728),b=i(8992),_=i(26050),x=i(16049),C=i(91018),w=i(56488),S=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l},A=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},M=function(t,e){return function(i,r){e(i,r,t)}};let k=class{get canvas(){return this.tryInitCanvas(),this._canvas}get context(){return this.tryInitCanvas(),this._context}constructor(t){this.contributions=t,this.configured=!1,this.global=x.w.global,this._textMeasureMap=new Map,this.global.hooks.onSetEnv.tap("graphic-util",(t,e,i)=>{this.configured=!1,this.configure(i,e)})}get textMeasure(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}getTextMeasureInstance(t){return t&&this._textMeasureMap.get(t)||this.textMeasure}configure(t,e){this.configured||(this.contributions.getContributions().forEach(t=>{t.configure(this,e)}),this.configured=!0)}tryInitCanvas(){if(!this._canvas){let t=_.A.shareCanvas();this._canvas=t,this._context=t.getContext("2d")}}bindTextMeasure(t){this._textMeasure&&"DefaultTextMeasureContribution"!==t.id||(this._textMeasure=t),this._textMeasureMap.has(t.id)||this._textMeasureMap.set(t.id,t)}measureText(t,e,i="native"){var r;this.configure(this.global,this.global.env);let n=this.global.measureTextMethod;this.global.measureTextMethod=i;let s={width:this._textMeasure.measureTextWidth(t,e),height:null!=(r=e.fontSize)?r:y.q9.fontSize};return this.global.measureTextMethod=n,s}createTextMeasureInstance(t,e,i){return this.configure(this.global,this.global.env),new v.e(Object.assign({defaultFontParams:{fontFamily:y.q9.fontFamily,fontSize:y.q9.fontSize},getCanvasForMeasure:i||(()=>this.canvas),getTextBounds:void 0,specialCharSet:"-/: .,@%'\"~"+v.e.ALPHABET_CHAR_SET+v.e.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)}drawGraphicToCanvas(t,e,i){if(!e.defaultLayer)return null;let r=C.n.get(w.Oo),n=t.AABBBounds,s=n.width(),l=n.height(),a=-n.x1,o=-n.y1;r.create({viewBox:{x1:a,y1:o,x2:n.x2,y2:n.y2},width:s,height:l,canvas:i,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""});let h=e.params.optimize.disableCheckGraphicWidthOutRange;e.params.optimize.disableCheckGraphicWidthOutRange=!0,e.defaultLayer.getNativeHandler().drawTo(r,[t],{transMatrix:r.getViewBoxTransform(),viewBox:r.getViewBox(),stage:e,layer:e.defaultLayer,renderService:e.renderService,background:"transparent",clear:!0,updateBounds:!1}),e.params.optimize.disableCheckGraphicWidthOutRange=h;let u=r.getNativeHandler();return u.nativeCanvas?u.nativeCanvas:null}};k=S([(0,s.b)(),M(0,(0,l.f)(o.Qc)),M(0,(0,a.t)(m.j)),A("design:paramtypes",[Object])],k),(tE=tI||(tI={}))[tE.transform=0]="transform",tE[tE.matrix=1]="matrix";let T=new b.y,R=class{constructor(){this.matrix=new b.y}init(t){return this.mode=tI.transform,this.originTransform=t,this.matrix.reset(),this}fromMatrix(t,e){return this.mode=tI.matrix,this.outSourceMatrix=t,this.outTargetMatrix=e,this}scaleMatrix(t,e,i){let r=this.outSourceMatrix;if(T.setValue(r.a,r.b,r.c,r.d,r.e,r.f),this.outTargetMatrix.reset(),i){let{x:r,y:n}=i;this.outTargetMatrix.translate(r,n),this.outTargetMatrix.scale(t,e),this.outTargetMatrix.translate(-r,-n)}else this.outTargetMatrix.scale(t,e);return this.outTargetMatrix.multiply(T.a,T.b,T.c,T.d,T.e,T.f),this}rotateMatrix(t,e){let i=this.outSourceMatrix;if(T.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){let{x:i,y:r}=e;this.outTargetMatrix.translate(i,r),this.outTargetMatrix.rotate(t),this.outTargetMatrix.translate(-i,-r)}else this.outTargetMatrix.rotate(t);return this.outTargetMatrix.multiply(T.a,T.b,T.c,T.d,T.e,T.f),this}scale(t,e,i){return this.mode===tI.matrix?this.scaleMatrix(t,e,i):this}rotate(t,e){return this.mode===tI.matrix?this.rotateMatrix(t,e):this}translateMatrix(t,e){let i=this.outSourceMatrix;return T.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(t,e),this.outTargetMatrix.multiply(T.a,T.b,T.c,T.d,T.e,T.f),this}translate(t,e){return this.mode===tI.matrix?this.translateMatrix(t,e):this}simplify(t){return this.mode===tI.matrix?this.simplifyMatrix(t):this}simplifyMatrix(t){return this}};R=S([(0,s.b)(),A("design:paramtypes",[])],R);var B=i(4062),P=i(75485);class E extends P.ZA{get offscreen(){return this.layerHandler.offscreen}get layerMode(){return this.layerHandler.type}get width(){return this.stage?this.stage.width:0}get height(){return this.stage?this.stage.height:0}get viewWidth(){return this.stage?this.stage.viewWidth:0}get viewHeight(){return this.stage?this.stage.viewHeight:0}get dirtyBound(){throw Error("暂不支持")}get dpr(){return this._dpr}constructor(t,e,i,r){var n;super({}),this.stage=t,this.global=e,this.window=i,this.main=r.main,this.layerHandler=r.layerHandler,this.layerHandler.init(this,i,{main:r.main,canvasId:r.canvasId,width:this.viewWidth,height:this.viewHeight,zIndex:null!=(n=r.zIndex)?n:0}),this.layer=this,this.subLayers=new Map,this.theme=new B.Q2,this.background="rgba(0, 0, 0, 0)",this.afterDrawCbs=[]}combineSubLayer(t=!0){let e=Array.from(this.subLayers.values()).sort((t,e)=>t.zIndex-e.zIndex);this.layerHandler.merge(e.map(e=>(e.layer.subLayers.size&&e.layer.combineSubLayer(t),e.layer.getNativeHandler()))),t&&e.forEach(t=>{t.group&&(t.group.incremental=0)}),e.forEach(t=>{x.w.layerService.releaseLayer(this.stage,t.layer)}),this.subLayers.clear()}getNativeHandler(){return this.layerHandler}setStage(t,e){super.setStage(t,this)}pick(t,e){throw Error("暂不支持")}tryRenderSecondaryLayer(t,e){this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach(i=>{i.layer.renderCount=this.renderCount,i.layer.render(t,e)})}render(t,e){var i;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:null!=(i=t.background)?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach(t=>t(this)),this.tryRenderSecondaryLayer(t,e)}resize(t,e){this.layerHandler.resize(t,e)}resizeView(t,e){this.layerHandler.resizeView(t,e)}setDpr(t){this.layerHandler.setDpr(t)}afterDraw(t){this.afterDrawCbs.push(t)}startAnimate(t){throw Error("暂不支持")}setToFrame(t){throw Error("暂不支持")}prepare(t,e){}release(){super.release(),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach(t=>{x.w.layerService.releaseLayer(this.stage,t.layer)})}drawTo(t,e){var i;this.layerHandler.drawTo(t,[this],Object.assign({background:null!=(i=e.background)?i:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach(t=>t(this))}}var I=i(58952);let L=tL=class{static GenerateLayerId(){return`${tL.idprefix}_${tL.prefix_count++}`}constructor(){this.layerMap=new Map,this.global=x.w.global}tryInit(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}getStageLayer(t){return this.layerMap.get(t)}getRecommendedLayerType(t){return t||(0!==this.staticLayerCountInEnv?"static":0!==this.dynamicLayerCountInEnv?"dynamic":"virtual")}getLayerHandler(t){return"static"===t?C.n.get(I.kj):"dynamic"===t?C.n.get(I.ym):C.n.get(I.XJ)}createLayer(t,e={main:!1}){var i;this.tryInit();let r=this.getRecommendedLayerType(e.layerMode);r=e.main||e.canvasId?"static":r;let n=this.getLayerHandler(r),s=new E(t,this.global,t.window,Object.assign(Object.assign({main:!1},e),{layerMode:r,canvasId:null!=(i=e.canvasId)?i:tL.GenerateLayerId(),layerHandler:n})),l=this.layerMap.get(t)||[];return l.push(s),this.layerMap.set(t,l),this.staticLayerCountInEnv--,s}prepareStageLayer(t){let e;t.forEachChildren(t=>{let i=t.getNativeHandler();"virtual"===i.type?(i.mainHandler=e,e.secondaryHandlers.push(i)):(e=i).secondaryHandlers=[]})}releaseLayer(t,e){e.release();let i=this.layerMap.get(t)||[];this.layerMap.set(t,i.filter(t=>t!==e))}layerCount(t){return(this.layerMap.get(t)||[]).length}restLayerCount(t){return 10*("browser"===this.global.env)}releaseStage(t){this.layerMap.delete(t)}};L.idprefix="visactor_layer",L.prefix_count=0,L=tL=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],L);let F=new n.n(t=>{t(u.y2).to(f).inSingletonScope(),t(w.Oo).to(w.Il),t(I.no).to(k).inSingletonScope(),t(I.Gp).to(R).inSingletonScope(),t(I.IT).to(L).inSingletonScope()});var O=i(28856);let D=class{constructor(t){this.drawContribution=t}prepare(t){t&&this.renderTreeRoots.forEach(e=>{this._prepare(e,t)})}_prepare(t,e){t.forEachChildren(t=>{this._prepare(t,e)}),t.update({bounds:e,trans:!0})}prepareRenderList(){}beforeDraw(t){}draw(t){this.drawContribution.draw(this,Object.assign({},this.drawParams))}afterDraw(t){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}reInit(){this.drawContribution.reInit()}render(t,e){this.renderTreeRoots=t,this.drawParams=e;let i=e.updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(e),this.draw(e),this.afterDraw(e),this.drawParams=null}};D=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)(),(tF=(0,l.f)(O.Iv),function(t,e){tF(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],D);var H=i(13380);let z=new n.n(t=>{t(H.p).to(D)});var W=i(58365),N=i(41457),j=i(60504),G=i(49009),V=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l};let Z=class{constructor(){this.order=1}afterPickItem(t,e,i,r,n){if(t.graphic){let e=t.graphic;for(;e.parent;)e=e.parent;e.shadowHost&&(t.params={shadowTarget:t.graphic},t.graphic=e.shadowHost)}return t}};Z=V([(0,s.b)()],Z);let U=class{constructor(){this.order=1}afterPickItem(t,e,i,r,n){return t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx?this._pickItem(t,e,i,r,n):null}beforePickItem(t,e,i,r,n){return t.attribute.shadowRootIdx<0?this._pickItem(t,e,i,r,n):null}_pickItem(t,e,i,r,n){var s;if(!t.shadowRoot)return null;let{parentMatrix:l}=n||{};if(!l)return null;let a=e.pickContext;a.highPerformanceSave();let o=null==(s=(0,B.gh)(t))?void 0:s[t.type],{shadowPickMode:h=null==o?void 0:o.shadowPickMode}=t.attribute,u=t.shadowRoot,d=j.QE.allocateByObj(l),c=new N.E9(d.a*i.x+d.c*i.y+d.e,d.b*i.x+d.d*i.y+d.f),p=e.pickGroup(u,c,d,r);return a.highPerformanceRestore(),!p.graphic&&p.group&&"full"===h&&(p.graphic=p.group),p}};U=V([(0,s.b)()],U);let K=class{constructor(){this.order=1}beforePickItem(t,e,i,r,n){let s=t.baseGraphic;if(s&&s.parent){let t=new N.E9(i.x,i.y),n=e.pickContext;n.highPerformanceSave();let l=s.parent.globalTransMatrix;l.transformPoint(t,t);let a=s.isContainer?e.pickGroup(s,t.clone(),l,r):e.pickItem(s,t.clone(),l,r);return n.highPerformanceRestore(),a}return null}};K=V([(0,s.b)()],K);let $=class{constructor(){this.order=1}beforePickItem(t,e,i,r,n){if(!t.in3dMode||r.in3dInterceptor)return null;let s=e.pickContext,l=t.stage;if(!s||!l)return null;if(r.in3dInterceptor=!0,s.save(),this.initCanvasCtx(s),s.camera=l.camera,t.isContainer){let l=(0,G.y)(s,t,()=>e.pickGroup(t,i,n.parentMatrix,r),r);return s.camera=null,r.in3dInterceptor=!1,s.restore(),l}return s.restore(),null}initCanvasCtx(t){t.setTransformForCurrent()}};$=V([(0,s.b)()],$);let Y=new n.n((t,e,i)=>{i(W.hH)||(t(W.BR).toSelf(),t(W.hH).toService(W.BR)),t($).toSelf().inSingletonScope(),t(W.uH).toService($),t(U).toSelf().inSingletonScope(),t(W.uH).toService(U),t(K).toSelf().inSingletonScope(),t(W.uH).toService(K),(0,o.yb)(t,W.uH),t(Z).toSelf().inSingletonScope(),t(W.tn).toService(Z),(0,o.yb)(t,W.tn)});var X=i(91509),q=i(79314),J=i(45011);let Q=new n.n(t=>{t(q.fB).to(X.JG),t(q.tA).toConstantValue(J.i)});var te=i(17959),ti=function(t,e){return function(i,r){e(i,r,t)}};let tr=class{constructor(t){this.autoEnablePlugins=t,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}active(t,e){this.stage=t,this.actived=!0;let{pluginList:i}=e;i&&C.n.isBound(te.X)&&this.autoEnablePlugins.getContributions().forEach(t=>{i.includes(t.name)&&this.register(t)})}findPluginsByName(t){let e=[];return this.onStartupFinishedPlugin.forEach(i=>{i.name===t&&e.push(i)}),this.onRegisterPlugin.forEach(i=>{i.name===t&&e.push(i)}),e}register(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.push(t):"onRegister"===t.activeEvent&&(this.onRegisterPlugin.push(t),t.activate(this))}unRegister(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1):"onRegister"===t.activeEvent&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1),t.deactivate(this)}release(...t){this.onStartupFinishedPlugin.forEach(t=>{t.deactivate(this)}),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach(t=>{t.deactivate(this)}),this.onRegisterPlugin=[]}};tr=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)(),ti(0,(0,l.f)(o.Qc)),ti(0,(0,a.t)(te.X)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],tr);let tn=new n.n(t=>{t(te.H).to(tr),(0,o.EM)(t,te.X)}),ts=new n.n(t=>{(0,o.yb)(t,u.D0)}),tl=new n.n(t=>{t(m.j).to(m.f).inSingletonScope(),(0,o.yb)(t,m.j)});var ta=i(43937);let to=class{constructor(){this.type="static",this.offscreen=!1,this.global=x.w.global}setDpr(t){this.canvas.dpr=t}init(t,e,i){if(this.layer=t,this.window=e,i.main)this.main=!0,this.context=e.getContext(),this.canvas=this.context.getCanvas();else{let t;this.main=!1,i.canvasId&&(t=this.global.getElementById(i.canvasId)),t||(t=this.global.createCanvas({width:e.width,height:e.height})),t.style&&(t.style["pointer-events"]="none");let r=e.getContext().getCanvas().nativeCanvas,n=(0,ta.JN)({nativeCanvas:t,width:e.width,height:e.height,dpr:e.dpr,id:i.canvasId,canvasControled:!0,container:e.getContainer(),x:r.offsetLeft,y:r.offsetTop});n.applyPosition(),this.canvas=n,this.context=n.getContext()}}resize(t,e){this.canvas.resize(t,e)}resizeView(t,e){}render(t,e,i){var r;if(!this.main){let t=this.window.getContext().getCanvas().nativeCanvas;t&&(this.canvas.x!==t.offsetLeft||this.canvas.y!==t.offsetTop)&&(this.canvas.x=t.offsetLeft,this.canvas.y=t.offsetTop,this.canvas.applyPosition())}e.renderService.render(t,Object.assign(Object.assign({context:this.context,clear:null!=(r=e.background)?r:"#ffffff"},e),i))}merge(t){t.forEach(t=>{let e=t.getContext().canvas.nativeCanvas;this.context.drawImage(e,0,0)})}prepare(t,e){}drawTo(t,e,i){var r;let n=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:n},i),{clear:i.clear?null!=(r=i.background)?r:"#fff":void 0}))}getContext(){return this.context}release(){this.canvas.release()}};to=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],to);let th=new n.n(t=>{t(to).toSelf(),t(I.kj).toService(to)});var tu=i(47293);let td=(0,i(70587).v)(tu.Lc);var tc=i(29230),tp=i(76620),tg=i(31535),tf=i(33049),tm=i(30943),ty=i(12687),tv=i(21823),tb=i(70341),t_=function(t,e){return function(i,r){e(i,r,t)}};let tx=class{constructor(t,e){this.contributions=t,this.drawItemInterceptorContributions=e,this._renderInGroup=(t,e,i,r)=>{var n;t?e.forEachChildren(t=>{i.break||(t.isContainer?this.renderGroup(t,i,r):this.renderItem(t,i))}):(0,tc.kD)(e,y.xF.zIndex,t=>{i.break||(t.isContainer?this.renderGroup(t,i,r):this.renderItem(t,i))},!1,!!(null==(n=i.context)?void 0:n.camera))},this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new tp.YZ,this.backupDirtyBounds=new tp.YZ,this.global=x.w.global,this.layerService=x.w.layerService,(0,tg.Z)(this.contributions)||(this.contributions=[this.contributions]),this.init()}reInit(){this.init(),this.contributions.forEach(t=>{t.reInit()})}init(){this.contributions.forEach(t=>{if(t.style){let e=this.styleRenderMap.get(t.style)||new Map;e.set(t.numberType,t),this.styleRenderMap.set(t.style,e)}else this.defaultRenderMap.set(t.numberType,t)}),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order)}prepareForDraw(t,e){e.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!e.stage.params.optimize.disableCheckGraphicWidthOutRange}draw(t,e){var i;this.prepareForDraw(t,e),e.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(e.renderStyle)||this.defaultRenderMap,this.currentRenderService=t;let{context:r,stage:n,viewBox:s,transMatrix:l}=e;if(!r)return;let a=this.dirtyBounds.setValue(0,0,s.width(),s.height());if(n.dirtyBounds&&!n.dirtyBounds.empty()){let t=(0,tf.di)(a,n.dirtyBounds,!1);a.x1=Math.floor(t.x1),a.y1=Math.floor(t.y1),a.x2=Math.ceil(t.x2),a.y2=Math.ceil(t.y2)}let o=r.dpr%1;(o||.5!==o)&&(a.x1=Math.floor(a.x1*r.dpr)/r.dpr,a.y1=Math.floor(a.y1*r.dpr)/r.dpr,a.x2=Math.ceil(a.x2*r.dpr)/r.dpr,a.y2=Math.ceil(a.y2*r.dpr)/r.dpr),this.backupDirtyBounds.copy(a),r.reset(!1),r.save(),r.setClearMatrix(l.a,l.b,l.c,l.d,l.e,l.f),r.clearMatrix(!1),r.translate(s.x1,s.y1,!0),r.beginPath(),r.rect(a.x1,a.y1,a.width(),a.height()),r.clip(),n.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(t,r,e),(null==(i=t.drawParams)?void 0:i.stage)&&t.drawParams.stage.hooks.afterClearScreen.call(t.drawParams),t.renderTreeRoots.sort((t,e)=>{var i,r;return(null!=(i=t.attribute.zIndex)?i:y.xF.zIndex)-(null!=(r=e.attribute.zIndex)?r:y.xF.zIndex)}).forEach(t=>{t.isContainer?this.renderGroup(t,e,j.QE.allocate(1,0,0,1,0,0)):this.renderItem(t,e)}),r.restore(),r.draw()}doRegister(){throw Error("暂不支持")}_findNextGraphic(t){let e=t.parent,i=t._uid;for(;e;){let t=(0,tc.qA)(e,i,y.xF.zIndex);if(t)return t;i=e._uid,e=e.parent}return null}renderGroup(t,e,i,r){if(e.break||!1===t.attribute.visibleAll)return;if(t.incremental&&(null==e.startAtId||e.startAtId===t._uid))return e.break=!0,void this._increaseRender(t,e);if(this.useDirtyBounds&&!(0,tf.SX)(t.AABBBounds,this.dirtyBounds,!1)&&"empty"!==t.attribute.boundsMode)return;let n,s=i;if(this.useDirtyBounds){n=tb.et.allocateByObj(this.dirtyBounds);let e=t.transMatrix;s=j.QE.allocateByObj(i).multiply(e.a,e.b,e.c,e.d,e.e,e.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(s.getInverse())}e.isGroupScroll=!(!t.attribute.scrollX&&!t.attribute.scrollY),this.renderItem(t,e,{renderInGroupParams:{skipSort:r,nextM:s},renderInGroup:this._renderInGroup}),this.useDirtyBounds&&(this.dirtyBounds.copy(n),tb.et.free(n),j.QE.free(s))}_increaseRender(t,e){let{layer:i,stage:r}=e,{subLayers:n}=i,s=n.get(t._uid);s||(s={layer:this.layerService.createLayer(r),zIndex:n.size,group:t},n.set(t._uid,s));let l=s.layer.getNativeHandler().getContext(),a=s.drawContribution||C.n.get(O.Pf);a.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:a,clear:"transparent",layer:s.layer,context:l,startAtId:t._uid,break:!1})),s.drawContribution=a;let o=this._findNextGraphic(t);if(o)if(o.isContainer&&o.incremental)this._increaseRender(o,e);else{let t=n.get(o._uid);t||(t={layer:this.layerService.createLayer(r),zIndex:n.size},n.set(o._uid,t));let i=t.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:a,clear:"transparent",layer:t.layer,context:i,startAtId:o._uid,break:!1}))}}getRenderContribution(t){let e;return e||(e=this.selectRenderByNumberType(t.numberType,t)),e||(e=this.selectRenderByType(t.type)),e}renderItem(t,e,i){if(this.InterceptorContributions.length)for(let r=0;r<this.InterceptorContributions.length;r++){let n=this.InterceptorContributions[r];if(n.beforeDrawItem&&n.beforeDrawItem(t,this.currentRenderService,e,this,i))return}let r=this.getRenderContribution(t);if(!r)return;let n,s=!1;if(e.isGroupScroll){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;s=!0,this.scrollMatrix||(this.scrollMatrix=j.QE.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-e,-i)}if(s&&(n=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),this.useDirtyBounds&&!t.isContainer&&"empty"!==t.attribute.boundsMode&&!(0,tf.SX)(t.AABBBounds,null!=n?n:this.dirtyBounds,!1)){if(s&&t.parent){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(e,i)}return}let l=null!=e.startAtId&&t._uid!==e.startAtId;if(t._uid===e.startAtId&&(e.startAtId=null),i&&(i.skipDraw=l),l?t.isContainer&&r.draw(t,this.currentRenderService,e,i):r.draw(t,this.currentRenderService,e,i),s&&t.parent){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(e,i)}if(this.InterceptorContributions.length)for(let i=0;i<this.InterceptorContributions.length;i++){let r=this.InterceptorContributions[i];if(r.afterDrawItem&&r.afterDrawItem(t,this.currentRenderService,e,this))return}}selectRenderByType(t){return tm.Y.getInstance().warn("未知错误，不应该走到这里"),null}selectRenderByNumberType(t,e){let i;if(e.attribute.renderStyle){let r=this.styleRenderMap.get(e.attribute.renderStyle);i=r&&r.get(t)}return i||this.currentRenderMap.get(t)||this.defaultRenderMap.get(t)}clearScreen(t,e,i){var r,n,s;let{clear:l,viewBox:a}=i,o=a.width(),h=a.height();if(l){e.clearRect(0,0,o,h),(null==(r=t.drawParams)?void 0:r.stage)&&t.drawParams.stage.hooks.afterClearRect.call(t.drawParams);let i=null==(n=t.drawParams)?void 0:n.stage;if(i&&(e.globalAlpha=null!=(s=i.attribute.opacity)?s:1),i&&i.backgroundImg&&i.resources){let t=i.resources.get(l);t&&"success"===t.state&&t.data&&e.drawImage(t.data,0,0,o,h)}else e.fillStyle=(0,tv.L)(e,l,{AABBBounds:{x1:0,y1:0,x2:0+o,y2:0+h}},0,0),e.fillRect(0,0,o,h)}}afterDraw(t,e){}};tx=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)(),t_(0,td(O.uz)),t_(1,(0,l.f)(o.Qc)),t_(1,(0,a.t)(ty.xL)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Array,Object])],tx);var tC=i(2844),tw=i(60543),tS=i(879),tA=i(17209),tM=i(56229);class tk extends tM.M2{constructor(){super(...arguments),this.time=tA.Oh.beforeFillStroke}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){let{background:c,backgroundMode:p=o.backgroundMode,backgroundFit:g=o.backgroundFit,backgroundKeepAspectRatio:f=o.backgroundKeepAspectRatio,backgroundScale:m=o.backgroundScale,backgroundOffsetX:y=o.backgroundOffsetX,backgroundOffsetY:v=o.backgroundOffsetY}=t.attribute;if(c)if(t.backgroundImg&&t.resources){let i=t.resources.get(c);if("success"!==i.state||!i.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);let r=t.AABBBounds;this.doDrawImage(e,i.data,r,{backgroundMode:p,backgroundFit:g,backgroundKeepAspectRatio:f,backgroundScale:m,backgroundOffsetX:y,backgroundOffsetY:v}),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=c,e.fill(),e.highPerformanceRestore()}}let tT=new tk;var tR=i(4484),tB=function(t,e){return function(i,r){e(i,r,t)}};let tP=class{constructor(t){this.groupRenderContribitions=t,this.numberType=q.I_}reInit(){this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(tT)}drawShape(t,e,i,r,n,s,l,a,o){let{clip:h,fill:u,stroke:d,background:c}=t.attribute;if(!(h||u||d||c))return;o=null!=o?o:(0,B.gh)(t,null==s?void 0:s.theme).group;let{opacity:p=o.opacity,width:g=o.width,height:f=o.height,fillOpacity:m=o.fillOpacity,strokeOpacity:y=o.strokeOpacity,cornerRadius:v=o.cornerRadius,path:b=o.path,lineWidth:_=o.lineWidth,visible:x=o.visible,fillStrokeOrder:C=o.fillStrokeOrder,cornerType:w=o.cornerType,x:S=o.x,y:A=o.y}=t.attribute,M=(0,tw.GT)(p,m,g,f,u),k=(0,tw.Ze)(p,y,g,f),T=(0,tw.dz)(u,c),R=(0,tw.ak)(d,_);if(!t.valid||!x||!h&&(!T&&!R||!(M||k||l||a||c)))return;if(b&&b.length&&n.drawContribution){let t=e.disableFill,i=e.disableStroke,r=e.disableBeginPath;e.disableFill=!0,e.disableStroke=!0,e.disableBeginPath=!0,b.forEach(t=>{n.drawContribution.getRenderContribution(t).draw(t,n.renderService,n,s)}),e.disableFill=t,e.disableStroke=i,e.disableBeginPath=r}else 0===v||(0,tg.Z)(v)&&v.every(t=>0===t)?(e.beginPath(),e.rect(i,r,g,f)):(e.beginPath(),(0,tC.U)(e,i,r,g,f,v,"bevel"!==w));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(tT));let P={doFill:T,doStroke:R};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this._groupRenderContribitions.forEach(s=>{s.time===tA.Oh.beforeFillStroke&&s.drawShape(t,e,i,r,T,R,M,k,o,n,l,a,P)}),h&&e.clip();let E=()=>{P.doFill&&(l?l(e,t.attribute,o):M&&(e.setCommonStyle(t,t.attribute,S-i,A-r,o),e.fill()))},I=()=>{P.doStroke&&(a?a(e,t.attribute,o):k&&(e.setStrokeStyle(t,t.attribute,S-i,A-r,o),e.stroke()))};C?(I(),E()):(E(),I()),this._groupRenderContribitions.forEach(s=>{s.time===tA.Oh.afterFillStroke&&s.drawShape(t,e,i,r,T,R,M,k,o,n,l,a)})}draw(t,e,i,r){var n,s;let l,{context:a}=i;if(!a)return;let{clip:o,baseOpacity:h=1,drawMode:u}=t.attribute,d=a.nativeContext,c=a.canvas.nativeCanvas;if(u>0){let{x:e,y:i,width:r,height:n}=t.attribute,s=a.canvas,l=x.w.global.createCanvas({width:s.width,height:s.height,dpr:1}),o=l.getContext("2d"),h=a.nativeContext.getTransform();o.setTransform(h.a,h.b,h.c,h.d,h.e,h.f),1===u&&(o.save(),o.clearRect(0,0,s.width,s.height),o.beginPath(),o.rect(e,i,r,n),o.clip(),o.drawImage(s.nativeCanvas,0,0,s.width,s.height,0,0,s.displayWidth,s.displayHeight),o.restore()),a.nativeContext=o,s.nativeCanvas=l}o?a.save():a.highPerformanceSave();let p=a.baseGlobalAlpha;a.baseGlobalAlpha*=h;let g=a.modelMatrix;if(a.camera){let e=(0,B.gh)(t,null==r?void 0:r.theme).group,i=j.yp.allocate(),n=j.yp.allocate();(0,X.RT)(n,t,e),(0,tR.G9)(i,g||i,n),a.modelMatrix=i,j.yp.free(n),a.setTransform(1,0,0,1,0,0,!0)}else a.transformFromMatrix(t.transMatrix,!0);a.beginPath(),r.skipDraw?this.drawShape(t,a,0,0,i,r,()=>!1,()=>!1):this.drawShape(t,a,0,0,i,null,null,null);let{scrollX:f,scrollY:m}=t.attribute;if((f||m)&&a.translate(f,m),r&&r.renderInGroup&&(l=r.renderInGroup(null==(n=r.renderInGroupParams)?void 0:n.skipSort,t,i,null==(s=r.renderInGroupParams)?void 0:s.nextM)),a.modelMatrix!==g&&j.yp.free(a.modelMatrix),a.modelMatrix=g,a.baseGlobalAlpha=p,u>0){let{x:e,y:i,width:r,height:n}=t.attribute,s=a.nativeContext,l=a.canvas.nativeCanvas;d.save(),d.setTransform(a.dpr,0,0,a.dpr,0,0,!0),1===u&&s.rect(e,i,r,n),d.drawImage(l,0,0,l.width,l.height,0,0,a.canvas.displayWidth,a.canvas.displayHeight);let o=s.getTransform();d.setTransform(o.a,o.b,o.c,o.d,o.e,o.f),a.nativeContext=d,a.canvas.nativeCanvas=c,d.restore()}l&&l.then?l.then(()=>{o?a.restore():a.highPerformanceRestore()}):o?a.restore():a.highPerformanceRestore()}};tP=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)(),tB(0,(0,l.f)(o.Qc)),tB(0,(0,a.t)(tS.jd)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],tP);var tE,tI,tL,tF,tO,tD=i(36063),tH=i(13950),tz=function(t,e){return function(i,r){e(i,r,t)}},tW=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function l(t){try{o(r.next(t))}catch(t){s(t)}}function a(t){try{o(r.throw(t))}catch(t){s(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(l,a)}o((r=r.apply(t,e||[])).next())})};(r=tO||(tO={}))[r.NORMAL=0]="NORMAL",r[r.STOP=1]="STOP";let tN=class extends tx{constructor(t,e,i,r){super(t,r),this.contributions=t,this.lineRender=e,this.areaRender=i,this.drawItemInterceptorContributions=r,this.rendering=!1,this.currFrameStartAt=0,this.currentIdx=0,this.status=tO.NORMAL,this.checkingForDrawPromise=null,this.hooks={completeDraw:new h.n([])},this.defaultRenderMap.set(this.lineRender.numberType,this.lineRender),this.defaultRenderMap.set(this.areaRender.numberType,this.areaRender)}draw(t,e){return tW(this,void 0,void 0,function*(){if(this.checkingForDrawPromise)return;this.lastRenderService=t,this.lastDrawContext=e,this.checkingForDrawPromise=this.checkForDraw(e);let i=yield this.checkingForDrawPromise;if(this.checkingForDrawPromise=null,i)return;this.currentRenderService=t;let{context:r,viewBox:n}=e;r&&(r.inuse=!0,r.clearMatrix(),r.setTransformForCurrent(!0),r.save(),e.restartIncremental&&this.clearScreen(this.currentRenderService,r,e),r.translate(n.x1,n.y1,!0),r.save(),t.renderTreeRoots.sort((t,e)=>{var i,r;return(null!=(i=t.attribute.zIndex)?i:y.xF.zIndex)-(null!=(r=e.attribute.zIndex)?r:y.xF.zIndex)}).forEach(t=>{this.renderGroup(t,e)}),this.hooks.completeDraw.tap("top-draw",()=>{r.restore(),r.restore(),r.draw(),r.inuse=!1,this.rendering=!1}))})}_increaseRender(t,e){return tW(this,void 0,void 0,function*(){this.rendering=!0,yield this._renderIncrementalGroup(t,e)})}_renderIncrementalGroup(t,e){return tW(this,void 0,void 0,function*(){this.count=t.count,yield new Promise(i=>{this.renderItem(t,e,{drawingCb:()=>tW(this,void 0,void 0,function*(){if(2!==t.count)yield(0,tc.Ud)(t,y.xF.zIndex,(i,r)=>{if(this.status===tO.STOP)return!0;if(i.isContainer||r<this.currentIdx)return!1;let n=this.currFrameStartAt+t.incremental;return r<n&&(this.currentIdx=r+1,this.renderItem(i,e)),r===n-1&&(this.currFrameStartAt=this.currentIdx,this.waitToNextFrame())}),i(!1);else{let r=t.getChildAt(0);if(r.incremental&&r.attribute.segments)for(r.incrementalAt||(r.incrementalAt=0);r.incrementalAt<r.attribute.segments.length;)e.multiGraphicOptions={startAtIdx:r.incrementalAt,length:r.incremental},this.renderItem(r,e),r.incrementalAt+=r.incremental,yield this.waitToNextFrame();else this.renderItem(r,e);i(!1)}})})}),this.hooks.completeDraw.call()})}waitToNextFrame(){return tW(this,void 0,void 0,function*(){return new Promise(t=>{this.global.getRequestAnimationFrame()(()=>{t(!1)})})})}checkForDraw(t){return tW(this,void 0,void 0,function*(){let e=this.rendering;return t.restartIncremental&&(e=!1,yield this.forceStop(),this.resetToInit()),e})}forceStop(){return tW(this,void 0,void 0,function*(){this.rendering&&(this.status=tO.STOP,yield new Promise(t=>{this.hooks.completeDraw.tap("stopCb",()=>{this.status=tO.NORMAL,this.hooks.completeDraw.taps=this.hooks.completeDraw.taps.filter(t=>"stopCb"!==t.name),t(!1)})}))})}resetToInit(){this.currFrameStartAt=0,this.currentIdx=0}renderGroup(t,e){return tW(this,void 0,void 0,function*(){if(!e.break&&!1!==t.attribute.visibleAll)return t.incremental&&e.startAtId===t._uid?(yield this._increaseRender(t,e),void(e.break=!0)):void(yield new Promise(i=>{this.renderItem(t,e,{drawingCb:()=>tW(this,void 0,void 0,function*(){yield(0,tc.Ud)(t,y.xF.zIndex,t=>tW(this,void 0,void 0,function*(){e.break||t.isContainer&&(yield this.renderGroup(t,e))})),i(!1)})})}))})}};tN=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)(),tz(0,td(O.uz)),tz(1,(0,l.f)(tD.U)),tz(2,(0,l.f)(tH.K)),tz(3,(0,l.f)(o.Qc)),tz(3,(0,a.t)(ty.xL)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Array,Object,Object,Object])],tN);var tj=i(82774);let tG=new n.n(t=>{t(tM.M2).toSelf().inSingletonScope(),t(tj.$).toSelf().inSingletonScope(),t(O.Iv).to(tx),t(O.Pf).to(tN),t(O.Cb).to(tP).inSingletonScope(),t(O.uz).toService(O.Cb),(0,o.yb)(t,tS.jd),t(tM.Sg).toSelf().inSingletonScope(),(0,o.yb)(t,tS.tg),(0,o.yb)(t,O.uz),t(ty.pN).toSelf().inSingletonScope(),t(ty.xL).toService(ty.pN),(0,o.yb)(t,ty.xL)});function tV(){var t;tV.__loaded||(tV.__loaded=!0,C.n.load(F),C.n.load(Q),C.n.load(z),C.n.load(Y),C.n.load(tn),(t=C.n).load(ts),t.load(tl),t.load(th),C.n.load(tG))}tV.__loaded=!1,tV();let tZ=C.n.get(u.y2);x.w.global=tZ;let tU=C.n.get(I.no);x.w.graphicUtil=tU;let tK=C.n.get(I.Gp);x.w.transformUtil=tK;let t$=C.n.get(q.fB);x.w.graphicService=t$;let tY=C.n.get(I.IT);x.w.layerService=tY},58365:function(t,e,i){"use strict";i.d(e,{BR:()=>n,hH:()=>r,tn:()=>l,uH:()=>s}),Symbol.for("GraphicPicker");let r=Symbol.for("PickerService");Symbol.for("BoundsPicker");let n=Symbol.for("GlobalPickerService"),s=Symbol.for("PickItemInterceptor"),l=Symbol.for("PickServiceInterceptor")},9941:function(t,e,i){"use strict";i.d(e,{f:()=>v});var r=i(76620),n=i(8992),s=i(41457),l=i(26004),a=i(47061),o=i(6146),h=i(29230),u=i(58233),d=i(4062),c=i(36081),p=i(4484),g=i(60504),f=i(16049),m=i(58365),y=function(t,e){return function(i,r){e(i,r,t)}};let v=class{constructor(t,e){this.pickItemInterceptorContributions=t,this.pickServiceInterceptorContributions=e,this.type="default",this.global=f.w.global}reInit(){this._init()}_init(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order),this.pickerServiceInterceptorContributions=this.pickServiceInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order)}pick(t,e,i){let s,l={graphic:null,group:null};i.pickerService=this;let a=i.bounds.width(),o=i.bounds.height();if(!(new r.FB).setValue(0,0,a,o).containsPoint(e))return l;this.pickContext&&(this.pickContext.inuse=!0),i.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);let h=new n.y(1,0,0,1,0,0);for(let r=t.length-1;r>=0&&!(l=t[r].isContainer?this.pickGroup(t[r],e,h,i):this.pickItem(t[r],e,h,i)).graphic;r--)s||(s=l.group);if(l.graphic||(l.group=s),this.pickContext&&(this.pickContext.inuse=!1),this.pickerServiceInterceptorContributions.length)for(let t=0;t<this.pickerServiceInterceptorContributions.length;t++){let r=this.pickerServiceInterceptorContributions[t];r.afterPickItem&&(l=r.afterPickItem(l,this,e,i,{parentMatrix:h}))}return l}containsPoint(t,e,i){var r;return!!(null==(r=this.pickItem(t,e,null,null!=i?i:{pickContext:this.pickContext,pickerService:this}))?void 0:r.graphic)}pickGroup(t,e,i,r){let n={group:null,graphic:null};if(!1===t.attribute.visibleAll)return n;let l=r.pickContext,a=l.modelMatrix;if(l.camera){let e=t.transMatrix,i=g.yp.allocate();if((0,p.B$)(i,e),a){if(i){let t=g.yp.allocate();l.modelMatrix=(0,p.G9)(t,a,i),g.yp.free(i)}}else(0,p.B$)(i,t.globalTransMatrix),l.modelMatrix=i}if(this.InterceptorContributions.length)for(let n=0;n<this.InterceptorContributions.length;n++){let s=this.InterceptorContributions[n];if(s.beforePickItem){let n=s.beforePickItem(t,this,e,r,{parentMatrix:i});if(n)return l.modelMatrix!==a&&g.yp.free(l.modelMatrix),l.modelMatrix=a,n}}let o=t.transMatrix,u=g.QE.allocateByObj(i),f=new s.E9(e.x,e.y);u.transformPoint(f,f);let m=t.AABBBounds.containsPoint(f);if(!m&&!t.stage.camera)return n;let y=this.pickItem(t,f.clone(),i,r);y&&y.graphic&&(n.graphic=y.graphic,n.params=y.params);let v=!1!==t.attribute.pickable&&m;return u.multiply(o.a,o.b,o.c,o.d,o.e,o.f),!1===t.attribute.childrenPickable||y&&y.graphic||(0,h.kD)(t,c.xF.zIndex,l=>{if(l.isContainer){let i=new s.E9(e.x,e.y),a=(0,d.gh)(t).group,{scrollX:o=a.scrollX,scrollY:h=a.scrollY}=t.attribute;i.x-=o,i.y-=h,n=this.pickGroup(l,i,u,r)}else{let a=new s.E9(e.x,e.y);u.transformPoint(a,a);let o=(0,d.gh)(t).group,{scrollX:h=o.scrollX,scrollY:c=o.scrollY}=t.attribute;a.x-=h,a.y-=c;let p=this.pickItem(l,a,i,r);p&&p.graphic&&(n.graphic=p.graphic,n.params=p.params)}return!!n.graphic||!!n.group},!0,!!l.camera),l.modelMatrix!==a&&g.yp.free(l.modelMatrix),l.modelMatrix=a,n.graphic||n.group||!v||t.stage.camera||(n.group=t),g.QE.free(u),n}selectPicker(t){return this.pickerMap.get(t.numberType)||null}};v=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,l.b)(),y(0,(0,a.f)(u.Qc)),y(0,(0,o.t)(m.uH)),y(1,(0,a.f)(u.Qc)),y(1,(0,o.t)(m.tn)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object])],v)},17959:function(t,e,i){"use strict";i.d(e,{H:()=>n,X:()=>r});let r=Symbol.for("AutoEnablePlugins"),n=Symbol.for("PluginService")},13380:function(t,e,i){"use strict";i.d(e,{p:()=>r});let r=Symbol.for("RenderService");Symbol.for("BeforeRenderConstribution")},7246:function(t,e,i){"use strict";i.d(e,{j:()=>k});var r=i(31535),n=i(88504),s=i(26004),l=i(47061),a=i(6146),o=i(58233),h=i(51402),u=i(4062),d=i(879),c=i(17209),p=i(76989),g=i(73602),f=i(12061);function m(t,e,i,r){let{offsetX:n=0,offsetY:s=0,offsetZ:l=0}=r||{},a=!0;e.forEach(e=>{e.defined?(a&&t.moveTo(e.p0.x+n,e.p0.y+s,l),(0,f.w)(t,e,1,r),a=!1):a=!0}),a=!0;for(let e=i.length-1;e>=0;e--){let o=i[e];o.defined?(a&&t.lineTo(o.p0.x+n,o.p0.y+s,l),(0,f.w)(t,o,1,r),a=!1):a=!0}t.closePath()}var y=i(79314),v=i(29863),b=i(34688),_=i(56229),x=i(82774),C=i(70749);class w extends x.${constructor(){super(...arguments),this.time=c.Oh.afterFillStroke}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){var p,g,f,m;this.textureMap||this.initTextureMap(e,t.stage);let{attribute:y=t.attribute}=c||{},{texture:v=null!=(p=t.attribute.texture)?p:(0,C.hT)(o,"texture"),textureColor:b=null!=(g=t.attribute.textureColor)?g:(0,C.hT)(o,"textureColor"),textureSize:_=null!=(f=t.attribute.textureSize)?f:(0,C.hT)(o,"textureSize"),texturePadding:x=null!=(m=t.attribute.texturePadding)?m:(0,C.hT)(o,"texturePadding")}=y;v&&this.drawTexture(v,t,e,i,r,o,b,_,x)}}let S=new w,A=_.R6;var M=function(t,e){return function(i,r){e(i,r,t)}};let k=class extends b.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=y.Ri,this.builtinContributions=[S,A],this.init(t)}drawLinearAreaHighPerformance(t,e,i,n,s,l,a,o,h,u,d,c,p){var g,f,m;let{points:y}=t.attribute;if(y.length<2)return;e.beginPath();let v=null!=(g=this.z)?g:0,b=y[0];e.moveTo(b.x+a,b.y+o,v);for(let t=1;t<y.length;t++){let i=y[t];e.lineTo(i.x+a,i.y+o,v)}for(let t=y.length-1;t>=0;t--){let i=y[t];e.lineTo((null!=(f=i.x1)?f:i.x)+a,(null!=(m=i.y1)?m:i.y)+o,v)}e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),this.beforeRenderStep(t,e,a,o,!!s,!1,i,!1,h,u,c,null,{attribute:t.attribute});let{x:_=0,x:x=0}=t.attribute;!1!==i&&(c?c(e,t.attribute,h):s&&(e.setCommonStyle(t,t.attribute,_-a,x-o,h),e.fill())),this.afterRenderStep(t,e,a,o,!!s,!1,i,!1,h,u,c,null,{attribute:t.attribute}),(()=>{var i,s;if(n){let{stroke:n=h&&h.stroke}=t.attribute;if((0,r.Z)(n)&&(n[0]||n[2])&&!1===n[1]){if(e.beginPath(),n[0]){e.moveTo(b.x+a,b.y+o,v);for(let t=1;t<y.length;t++){let i=y[t];e.lineTo(i.x+a,i.y+o,v)}}else if(n[2]){let t=y[y.length-1];e.moveTo(t.x+a,t.y+o,v);for(let t=y.length-2;t>=0;t--){let r=y[t];e.lineTo((null!=(i=r.x1)?i:r.x)+a,(null!=(s=r.y1)?s:r.y)+o,v)}}}p?p(e,t.attribute,h):(e.setStrokeStyle(t,t.attribute,_-a,x-o,h),e.stroke())}})()}drawShape(t,e,i,r,s,l,a,o){var d,c,p,g,f,m;let y=(0,u.gh)(t,null==l?void 0:l.theme).area,{fill:v=y.fill,stroke:b=y.stroke,fillOpacity:_=y.fillOpacity,z:x=y.z,strokeOpacity:C=y.strokeOpacity,curveTension:w=y.curveTension,connectedType:S=y.connectedType}=t.attribute,A=this.valid(t,y,a,o);if(!A)return;let{doFill:M}=A,k=A.doStroke&&A.sVisible,{clipRange:T=y.clipRange,closePath:R,points:B,segments:P}=t.attribute,{curveType:E=y.curveType}=t.attribute;function I(t,e){return"connect"!==e?t:t.filter(t=>!1!==t.defined)}if(R&&"linear"===E&&(E="linearClosed"),1===T&&!P&&!B.some(t=>!1===t.defined)&&"linear"===E)return this.drawLinearAreaHighPerformance(t,e,!!v,k,_,C,i,r,y,s,l,a,o);if(t.shouldUpdateShape()){if(P&&P.length){let e,i,r,n=P.map((t,r)=>{if(t.points.length<=1&&0===r)return t.points[0]&&(i={endX:t.points[0].x,endY:t.points[0].y}),null;1===r?e={x:i.endX,y:i.endY}:r>1&&(e.x=i.endX,e.y=i.endY);let n=(0,h.X0)(I(t.points,S),E,{startPoint:e,curveTension:w});return i=n,n}).filter(t=>!!t),s=[];for(let t=P.length-1;t>=0;t--){let e=P[t].points,i=[];for(let t=e.length-1;t>=0;t--)i.push({x:null!=(d=e[t].x1)?d:e[t].x,y:null!=(c=e[t].y1)?c:e[t].y});if(0!==t){let e=P[t-1].points,r=e[e.length-1];r&&i.push({x:null!=(p=r.x1)?p:r.x,y:null!=(g=r.y1)?g:r.y})}i.length>1&&(r=(0,h.X0)(I(i,S),"stepBefore"===E?"stepAfter":"stepAfter"===E?"stepBefore":E,{curveTension:w}),s.unshift(r))}t.cacheArea=s.map((t,e)=>({top:n[e],bottom:t}))}else{if(!B||!B.length)return t.cacheArea=null,void t.clearUpdateShapeTag();{let e=I(B,S),i=[];for(let t=e.length-1;t>=0;t--)i.push({x:null!=(f=e[t].x1)?f:e[t].x,y:null!=(m=e[t].y1)?m:e[t].y});t.cacheArea={top:(0,h.X0)(e,E,{curveTension:w}),bottom:(0,h.X0)(i,"stepBefore"===E?"stepAfter":"stepAfter"===E?"stepBefore":E,{curveTension:w})}}}t.clearUpdateShapeTag()}if(Array.isArray(t.cacheArea)){let l=t.attribute.segments.filter(t=>t.points.length);if(1===l[0].points.length&&l.shift(),1===T){let n=!1;t.cacheArea.forEach((h,u)=>{n||(n=this.drawSegmentItem(e,h,M,_,k,C,l[u],[y,t.attribute],T,i,r,x,t,s,a,o))})}else{let h=T*t.cacheArea.reduce((t,e)=>t+e.top.getLength(),0),u=0,d=!1;t.cacheArea.forEach((c,p)=>{if(d)return;let g=c.top.getLength(),f=(h-u)/g;u+=g,f>0&&(d=this.drawSegmentItem(e,c,M,_,k,C,l[p],[y,t.attribute],(0,n.VV)(f,1),i,r,x,t,s,a,o))})}}else this.drawSegmentItem(e,t.cacheArea,M,_,k,C,t.attribute,y,T,i,r,x,t,s,a,o)}draw(t,e,i,r){let n=(0,u.gh)(t,null==r?void 0:r.theme).area;this._draw(t,n,!1,i,r)}drawSegmentItem(t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f){return this._drawSegmentItem(t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f)}_drawSegmentItem(t,e,i,s,l,a,o,h,u,d,f,y,b,_,x,C){if(!(e&&e.top&&e.bottom&&e.top.curves&&e.top.curves.length&&e.bottom.curves&&e.bottom.curves.length))return;t.beginPath();let{points:w,segments:S}=b.attribute,A,M,k=c.Nm.ROW;if(S){let t=S[S.length-1];M=S[0].points[0],A=t.points[t.points.length-1]}else M=w[0],A=w[w.length-1];let T=(0,n.Wn)(A.x-M.x),R=(0,n.Wn)(A.y-M.y);(function(t,e,i,r){var s;let{top:l,bottom:a}=e;if(l.curves.length!==a.curves.length)return;if(i>=1){let e=[],i=[],n=!0;for(let s=0,o=l.curves.length;s<o;s++){let h=l.curves[s];n!==h.defined?(n?(m(t,e,i,r),e.length=0,i.length=0):(e.push(h),i.push(a.curves[o-s-1])),n=!n):n&&(e.push(h),i.push(a.curves[o-s-1]))}return m(t,e,i,r)}if(i<=0)return;let{direction:o}=r||{},{curves:h}=l,u=null!=(s=h[h.length-1].p3)?s:h[h.length-1].p1,d=(0,n.Wn)(u.x-h[0].p0.x),f=(0,n.Wn)(u.y-h[0].p0.y);o=null!=o?o:d>f?c.Nm.ROW:c.Nm.COLUMN,Number.isFinite(d)||(o=c.Nm.COLUMN),Number.isFinite(f)||(o=c.Nm.ROW);let y=i*(o===c.Nm.ROW?d:f),v=0,b=!0,_=[],x=[];for(let e=0,i=l.curves.length;e<i;e++){let n=l.curves[e],s=n.getLength(o),h=(y-v)/s;if(h<0)break;v+=s;let u=null,d=null;b!==n.defined?(b?(m(t,_,x,r),_.length=0,x.length=0):(u=n,d=a.curves[i-e-1]),b=!b):b&&(u=n,d=a.curves[i-e-1]),u&&d&&(h<1&&(u=u.p2&&u.p3?(0,p.m)(u,h)[0]:(0,g.d)(u,h)[0],d=d.p2&&d.p3?(0,p.m)(d,1-h)[1]:(0,g.d)(d,1-h)[1]),u.defined=b,d.defined=b,_.push(u),x.push(d)),u=null,d=null}m(t,_,x,r)})(t,e,u,{offsetX:d,offsetY:f,offsetZ:y,direction:k=null==A.x1?c.Nm.ROW:null==A.y1?c.Nm.COLUMN:Number.isFinite(T+R)?T>R?c.Nm.ROW:c.Nm.COLUMN:c.Nm.ROW}),this.beforeRenderStep(b,t,d,f,!!s,!1,i,!1,h,_,x,null,{attribute:o}),t.setShadowBlendStyle&&t.setShadowBlendStyle(b,o,h);let{x:B=0,x:P=0}=o;return!1!==i&&(x?x(t,o,h):s&&(t.setCommonStyle(b,o,B-d,P-f,h),t.fill())),this.afterRenderStep(b,t,d,f,!!s,!1,i,!1,h,_,x,null,{attribute:o}),(()=>{if(!1!==l)if(C)C(t,o,h);else{let{stroke:i=h&&h[1]&&h[1].stroke}=o;(0,r.Z)(i)&&(i[0]||i[2])&&!1===i[1]&&(t.beginPath(),(0,v.fW)(t,i[0]?e.top:e.bottom,u,k===c.Nm.ROW?"x":"y",{offsetX:d,offsetY:f,offsetZ:y})),t.setStrokeStyle(b,o,B-d,P-f,h),t.stroke()}})(),!1}};k=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)(),M(0,(0,l.f)(o.Qc)),M(0,(0,a.t)(d.Gq)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],k)},34688:function(t,e,i){"use strict";i.d(e,{Y:()=>c});var r=i(91509),n=i(60504),s=i(60543),l=i(17209),a=i(4484),o=i(4062),h=i(23603),u=i(56229);let d={x:0,y:0,z:0,lastModelMatrix:null};class c{init(t){t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions||(this.builtinContributions=[]),this.builtinContributions.push(u.rJ),this.builtinContributions.push(u.Eo),this.builtinContributions.forEach(t=>this._renderContribitions.push(t)),this._renderContribitions.length&&(this._renderContribitions.sort((t,e)=>e.order-t.order),this._beforeRenderContribitions=this._renderContribitions.filter(t=>t.time===l.Oh.beforeFillStroke),this._afterRenderContribitions=this._renderContribitions.filter(t=>t.time===l.Oh.afterFillStroke))}reInit(){this.init(this.graphicRenderContributions)}beforeRenderStep(t,e,i,r,n,s,l,a,o,h,u,d,c){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach(p=>{(!p.supportedAppName||!t.stage||!t.stage.params||!t.stage.params.context||!t.stage.params.context.appName||(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName))&&p.drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c)})}afterRenderStep(t,e,i,r,n,s,l,a,o,h,u,d,c){this._afterRenderContribitions&&this._afterRenderContribitions.forEach(p=>{(!p.supportedAppName||!t.stage||!t.stage.params||!t.stage.params.context||!t.stage.params.context.appName||(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName))&&p.drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c)})}drawPathProxy(t,e,i,r,n,l,a,u){if(!t.pathProxy)return!1;let d=(0,o.gh)(t,null==l?void 0:l.theme)[t.type.replace("3d","")],{fill:c=d.fill,stroke:p=d.stroke,opacity:g=d.opacity,fillOpacity:f=d.fillOpacity,lineWidth:m=d.lineWidth,strokeOpacity:y=d.strokeOpacity,visible:v=d.visible,x:b=d.x,y:_=d.y}=t.attribute,x=(0,s.Bv)(g,f,c),C=(0,s.Kf)(g,y),w=(0,s.dz)(c),S=(0,s.ak)(p,m);if(!v||!w&&!S||!(x||C||a||u))return!0;e.beginPath();let A="function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy;return(0,h.h)(A.commandList,e,i,r),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,r,w,S,x,C,d,n,a,u),S&&(u?u(e,t.attribute,d):C&&(e.setStrokeStyle(t,t.attribute,i-b,r-_,d),e.stroke())),w&&(a?a(e,t.attribute,d):x&&(e.setCommonStyle(t,t.attribute,i-b,r-_,d),e.fill())),this.afterRenderStep(t,e,i,r,w,S,x,C,d,n,a,u),!0}valid(t,e,i,r){let{fill:n=e.fill,background:l,stroke:a=e.stroke,opacity:o=e.opacity,fillOpacity:h=e.fillOpacity,lineWidth:u=e.lineWidth,strokeOpacity:d=e.strokeOpacity,visible:c=e.visible}=t.attribute,p=(0,s.Bv)(o,h,n),g=(0,s.Kf)(o,d),f=(0,s.dz)(n,l),m=(0,s.ak)(a,u);return!(!t.valid||!c)&&!(!f&&!m)&&!!(p||g||i||r||l)&&{fVisible:p,sVisible:g,doFill:f,doStroke:m}}transform(t,e,i,s=!1){let{x:l=e.x,y:o=e.y,z:h=e.z,scaleX:u=e.scaleX,scaleY:c=e.scaleY,angle:p=e.angle,postMatrix:g}=t.attribute,f=i.modelMatrix,m=i.camera;d.x=l,d.y=o,d.z=h,d.lastModelMatrix=f;let y=m&&(s||(0,r.M_)(t)),v=y?t.transMatrix.onlyTranslate()&&!g:1===u&&1===c&&0===p&&!g;if(y){let s=n.yp.allocate(),l=n.yp.allocate();(0,r.RT)(l,t,e),(0,a.G9)(s,f||s,l),d.x=0,d.y=0,d.z=0,i.modelMatrix=s,i.setTransform(1,0,0,1,0,0,!0),n.yp.free(l)}if(v&&!f){let r=t.getOffsetXY(e);d.x+=r.x,d.y+=r.y,d.z=h,i.setTransformForCurrent()}else if(y)d.x=0,d.y=0,d.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(m&&i.project){let r=t.getOffsetXY(e);d.x+=r.x,d.y+=r.y,this.transformWithoutTranslate(i,d.x,d.y,d.z,u,c,p)}else i.transformFromMatrix(t.transMatrix,!0),d.x=0,d.y=0,d.z=0;return d}transformUseContext2d(t,e,i,r){let n=r.camera;if(this.camera=n,n){let e=t.AABBBounds,n=e.x2-e.x1,s=e.y2-e.y1,l=r.project(0,0,i),a=r.project(n,0,i),o=r.project(n,s,i),h={x:0,y:0},u={x:n,y:0},d={x:n,y:s};r.camera=null;let c=1/(h.x*(d.y-u.y)-u.x*d.y+d.x*u.y+(u.x-d.x)*h.y),p=-(h.y*(o.x-a.x)-u.y*o.x+d.y*a.x+(u.y-d.y)*l.x)*c,g=(u.y*o.y+h.y*(a.y-o.y)-d.y*a.y+(d.y-u.y)*l.y)*c,f=(h.x*(o.x-a.x)-u.x*o.x+d.x*a.x+(u.x-d.x)*l.x)*c,m=-(u.x*o.y+h.x*(a.y-o.y)-d.x*a.y+(d.x-u.x)*l.y)*c,y=(h.x*(d.y*a.x-u.y*o.x)+h.y*(u.x*o.x-d.x*a.x)+(d.x*u.y-u.x*d.y)*l.x)*c,v=(h.x*(d.y*a.y-u.y*o.y)+h.y*(u.x*o.y-d.x*a.y)+(d.x*u.y-u.x*d.y)*l.y)*c;r.setTransform(p,g,f,m,y,v,!0)}}restoreTransformUseContext2d(t,e,i,r){this.camera&&(r.camera=this.camera)}transformWithoutTranslate(t,e,i,r,n,s,l){let a=t.project(e,i,r);t.translate(a.x,a.y,!1),t.scale(n,s,!1),t.rotate(l,!1),t.translate(-a.x,-a.y,!1),t.setTransformForCurrent()}_draw(t,e,i,r,s,l){let{context:a}=r;if(!a)return;let{renderable:o}=t.attribute;if(!1===o)return;a.highPerformanceSave();let{x:h,y:u,z:d,lastModelMatrix:c}=this.transform(t,e,a,i);this.z=d,this.drawPathProxy(t,a,h,u,r,s)||(this.drawShape(t,a,h,u,r,s,null,null,l),this.z=0,a.modelMatrix!==c&&n.yp.free(a.modelMatrix),a.modelMatrix=c),a.highPerformanceRestore()}}},56229:function(t,e,i){"use strict";i.d(e,{Eo:()=>m,M2:()=>c,R6:()=>p,Sg:()=>g,rJ:()=>f});var r=i(26004),n=i(47061),s=i(6146),l=i(4062),a=i(26050),o=i(17209),h=i(58233),u=i(879),d=function(t,e){return function(i,r){e(i,r,t)}};class c{constructor(){this.time=o.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,h,u,d,c,p){var g;let{background:f,backgroundOpacity:m=null!=(g=t.attribute.fillOpacity)?g:h.backgroundOpacity,opacity:y=h.opacity,backgroundMode:v=h.backgroundMode,backgroundFit:b=h.backgroundFit,backgroundKeepAspectRatio:_=h.backgroundKeepAspectRatio,backgroundScale:x=h.backgroundScale,backgroundOffsetX:C=h.backgroundOffsetX,backgroundOffsetY:w=h.backgroundOffsetY,backgroundClip:S=h.backgroundClip}=t.attribute;if(f)if(t.backgroundImg&&t.resources){let n=t.resources.get(f);if("success"!==n.state||!n.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){let i=(0,l.gh)(t.parent).group,{scrollX:r=i.scrollX,scrollY:n=i.scrollY}=t.parent.attribute;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(r,n)}S&&e.clip();let s=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,r,h),e.globalAlpha=m*y,this.doDrawImage(e,n.data,s,{backgroundMode:v,backgroundFit:b,backgroundKeepAspectRatio:_,backgroundScale:x,backgroundOffsetX:C,backgroundOffsetY:w}),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,h),e.globalAlpha=m*y,e.fillStyle=f,e.fill(),e.highPerformanceRestore()}doDrawImage(t,e,i,r){let{backgroundMode:n,backgroundFit:s,backgroundKeepAspectRatio:l,backgroundScale:o=1,backgroundOffsetX:h=0,backgroundOffsetY:u=0}=r,d=i.width(),c=i.height(),p=d,g=c;if("no-repeat"===n)if(s)if(l){let r=Math.max(d/e.width,c/e.height);t.drawImage(e,i.x1+h,i.y1+u,e.width*r*o,e.height*r*o)}else t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{let r=e.width*o,n=e.height*o;t.drawImage(e,i.x1+h,i.y1+u,r,n)}else{if(s&&"repeat"!==n&&(e.width||e.height)){let i=e.width,r=e.height;"repeat-x"===n?(p=c/r*i,g=c):"repeat-y"===n&&(g=d/i*r,p=d);let s=t.dpr,l=a.A.allocate({width:p,height:g,dpr:s}),o=l.getContext("2d");o&&(o.inuse=!0,o.clearMatrix(),o.setTransformForCurrent(!0),o.clearRect(0,0,p,g),o.drawImage(e,0,0,p,g),e=l.nativeCanvas),a.A.free(l)}let r=t.dpr,l=t.createPattern(e,n);l.setTransform&&l.setTransform(new DOMMatrix([1/r,0,0,1/r,0,0])),t.fillStyle=l,t.translate(i.x1,i.y1),t.fillRect(0,0,d,c),t.translate(-i.x1,-i.y1)}}}let p=new c,g=class{constructor(t){this.subRenderContribitions=t,this.time=o.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach(p=>{p.render(t,e,i,r,n,s,l,a,o,h,u,d,c)})}};g=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,r.b)(),d(0,(0,n.f)(h.Qc)),d(0,(0,s.t)(u.tg)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],g);let f=new class{constructor(){this.time=o.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){var p,g;let{clipConfig:f}=t.attribute;if(!f)return;let m=t.getClipPath();if(!m)return;let y=!(u||d),v=t.AABBBounds,b=null!=(p=t.attribute.width)?p:v.width(),_=null!=(g=t.attribute.height)?g:v.height();y&&e.save(),e.beginPath(),!1===m.draw(e,[b,_],i+b/2,r+_/2,0)&&e.closePath(),u&&u(e,t.attribute,o,!0),y&&e.clip()}},m=new class{constructor(){this.time=o.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{clipConfig:p}=t.attribute;p&&t.getClipPath()&&(u||d||e.restore())}}},82774:function(t,e,i){"use strict";i.d(e,{$:()=>a,H:()=>o});var r=i(26050),n=i(17209),s=i(8042),l=i(88504);class a{constructor(){this.time=n.Oh.afterFillStroke,this.useStyle=!0,this.order=10,this._tempSymbolGraphic=null}createCommonPattern(t,e,i,n,s){let l=(t-2*e)/2,a=n.dpr,o=r.A.allocate({width:t,height:t,dpr:a}),h=o.getContext("2d");if(!h)return null;h.inuse=!0,h.clearMatrix(),h.setTransformForCurrent(!0),h.clearRect(0,0,t,t),s(l,h);let u=n.createPattern(o.nativeCanvas,"repeat");return u.setTransform&&u.setTransform(new DOMMatrix([1/a,0,0,1/a,0,0])),r.A.free(o),u}createCirclePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,e)=>{e.fillStyle=i,e.arc(t,t,t,0,l.f7),e.fill()})}createDiamondPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{let n=t/2;r.fillStyle=i,r.moveTo(n,n-e),r.lineTo(e+n,n),r.lineTo(n,n+e),r.lineTo(n-e,n),r.closePath(),r.fill()})}createRectPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,r)=>{r.fillStyle=i,r.fillRect(e,e,2*t,2*t)})}createVerticalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(r,n)=>{n.fillStyle=i,n.fillRect(e,0,2*r,t)})}createHorizontalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(r,n)=>{n.fillStyle=i,n.fillRect(0,e,t,2*r)})}createBiasLRLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{r.strokeStyle=i,r.lineWidth=e,r.moveTo(0,0),r.lineTo(t,t);let n=t/2,s=-n;r.moveTo(n,s),r.lineTo(n+t,s+t),r.moveTo(-n,-s),r.lineTo(-n+t,-s+t),r.stroke()})}createBiasRLLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{r.strokeStyle=i,r.lineWidth=e,r.moveTo(t,0),r.lineTo(0,t);let n=t/2;r.moveTo(t+n,n),r.lineTo(n,n+t),r.moveTo(t-n,-n),r.lineTo(-n,-n+t),r.stroke()})}createGridPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,r)=>{r.fillStyle=i,r.fillRect(e,e,t,t),r.fillRect(e+t,e+t,t,t)})}initTextureMap(t,e){this.textureMap=new Map}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){this.textureMap||this.initTextureMap(e,t.stage);let{texture:p=o.texture,textureColor:g=o.textureColor,textureSize:f=o.textureSize,texturePadding:m=o.texturePadding}=t.attribute;p&&this.drawTexture(p,t,e,i,r,o,g,f,m)}drawTexture(t,e,i,n,l,a,o,h,u){var d;let{textureRatio:c=a.textureRatio,textureOptions:p=null}=e.attribute,g=this.textureMap.get(t);if(!g)switch(t){case"circle":g=this.createCirclePattern(h,u,o,i);break;case"diamond":g=this.createDiamondPattern(h,u,o,i);break;case"rect":g=this.createRectPattern(h,u,o,i);break;case"vertical-line":g=this.createVerticalLinePattern(h,u,o,i);break;case"horizontal-line":g=this.createHorizontalLinePattern(h,u,o,i);break;case"bias-lr":g=this.createBiasLRLinePattern(h,u,o,i);break;case"bias-rl":g=this.createBiasRLLinePattern(h,u,o,i);break;case"grid":g=this.createGridPattern(h,u,o,i)}if(p&&p.dynamicTexture){let g,{gridConfig:f={},useNewCanvas:m}=p,y=e.AABBBounds;n=y.x1,l=y.y1;let v=i;if(m){let t=(g=r.A.allocate({width:y.width(),height:y.height(),dpr:i.dpr})).getContext("2d");t.clearRect(0,0,y.width(),y.height()),n=0,l=0,i=t}if(v.save(),e.parent&&!e.transMatrix.onlyTranslate()){let{scrollX:t=0,scrollY:i=0}=e.parent.attribute;v.setTransformFromMatrix(e.parent.globalTransMatrix),v.translate(t,i,!0)}v.setCommonStyle(e,e.attribute,n,l,a),v.clip();let b=y.width(),_=y.height(),x=f.columns?f.columns:Math.ceil(b/h),C=f.rows?f.rows:Math.ceil(_/h),w=f.gutterColumn?f.gutterColumn:2*u,S=f.gutterRow?f.gutterRow:2*u;this._tempSymbolGraphic||(this._tempSymbolGraphic=(0,s.t)({}));let A=f.columns?b/f.columns:h,M=f.rows?_/f.rows:h;this._tempSymbolGraphic.setAttributes({size:[A-w,M-S],symbolType:t});let k=this._tempSymbolGraphic.getParsedPath();for(let t=0;t<C;t++)for(let r=0;r<x;r++){let s=n+h/2+r*h,a=l+h/2+t*h;null==(d=p.beforeDynamicTexture)||d.call(p,i,t,r,C,x,c,e,y.width(),y.height()),i.beginPath(),!1===k.draw(i,Math.min(A-w,M-S),s,a,0)&&i.closePath(),i.fillStyle=o,p.dynamicTexture(i,t,r,C,x,c,e,y.width(),y.height())}m&&(v.globalAlpha=1,v.drawImage(g.nativeCanvas,0,0,g.nativeCanvas.width,g.nativeCanvas.height,y.x1,y.y1,y.width()*v.dpr,y.height()*v.dpr)),v.restore()}else if(g)i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,n,l,a),i.fillStyle=g,i.fill(),i.highPerformanceRestore();else if("wave"===t){i.save(),i.setCommonStyle(e,e.attribute,n,l,a),i.clip();let t=e.AABBBounds;(function(t,e,i,r,n,s,l){let{fill:a="orange",percent:o=.6,frequency:h=4,opacity:u,phi:d=0}=n,{amplitude:c=10}=n;c*=e<=.5?4*e-1:-4*e+3;let p=r*(1-o),g=Math.max(Math.round(i/70),2);t.beginPath(),t.moveTo(0+s,r+l),t.lineTo(0+s,p+l);let f=i/h*e,m=i/Math.PI/(2*h);for(let e=0;e<i;e+=g){let i=c*Math.sin((e+f+d)/m+d);t.lineTo(e+s,p+i+l)}t.lineTo(i+s,r+l),t.closePath(),t.fillStyle=a,isFinite(u)&&(t.globalAlpha=u),t.fill()})(i,c,t.width(),t.height(),Object.assign(Object.assign({},p||{}),{fill:o}),n+t.x1-n,l+t.y1-l),i.restore()}}}let o=new a},879:function(t,e,i){"use strict";i.d(e,{$K:()=>c,Cs:()=>s,Gq:()=>n,JO:()=>a,Mj:()=>o,OL:()=>r,U7:()=>h,X3:()=>d,d5:()=>u,jd:()=>l,tg:()=>p});let r=Symbol.for("ArcRenderContribution"),n=Symbol.for("AreaRenderContribution"),s=Symbol.for("CircleRenderContribution"),l=Symbol.for("GroupRenderContribution"),a=Symbol.for("ImageRenderContribution"),o=Symbol.for("PathRenderContribution"),h=Symbol.for("PolygonRenderContribution"),u=Symbol.for("RectRenderContribution"),d=Symbol.for("SymbolRenderContribution"),c=Symbol.for("TextRenderContribution");Symbol.for("StarRenderContribution"),Symbol.for("CommonRenderContribution");let p=Symbol.for("InteractiveSubRenderContribution")},58276:function(t,e,i){"use strict";i.d(e,{Er:()=>p,NB:()=>g,d4:()=>c,gq:()=>m,k7:()=>f,sH:()=>d});var r=i(31535),n=i(26004),s=i(21823),l=i(56229),a=i(2844),o=i(17209),h=i(82774),u=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l};class d{constructor(){this.time=o.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,n,l,o,h,u,d,c,p,g){let{outerBorder:f,innerBorder:m}=t.attribute,y=f&&!1!==f.visible,v=m&&!1!==m.visible;if(!y&&!v)return;let{cornerRadius:b=d.cornerRadius,cornerType:_=d.cornerType,opacity:x=d.opacity,x:C=d.x,y:w=d.y,scaleX:S=d.scaleX,scaleY:A=d.scaleY,x1:M,y1:k,keepStrokeScale:T=d.keepStrokeScale}=t.attribute,{width:R,height:B}=t.attribute;R=(null!=R?R:M-i)||0,B=(null!=B?B:k-n)||0;let P=(l,o)=>{let h=!(!l||!l.stroke),u="outerBorder"===o?-1:1,{distance:c=d[o].distance}=l,p=T?c:(0,s.D)(e,c,e.dpr),f=i+u*p,m=n+u*p,y=2*p;if(0===b||(0,r.Z)(b)&&b.every(t=>0===t)?(e.beginPath(),e.rect(f,m,R-u*y,B-u*y)):(e.beginPath(),(0,a.U)(e,f,m,R-u*y,B-u*y,b,"bevel"!==_)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),g)g(e,l,d[o]);else if(h){let r=d[o].opacity;d[o].opacity=x,e.setStrokeStyle(t,l,(C-i)/S,(w-n)/A,d[o]),d[o].opacity=r,e.stroke()}};y&&P(f,"outerBorder"),v&&P(m,"innerBorder")}}let c=class{constructor(){this.time=o.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{stroke:p=o.stroke}=t.attribute;Array.isArray(p)&&p.some(t=>!1===t)&&(c.doStroke=!1)}};c=u([(0,n.b)()],c);let p=class{constructor(){this.time=o.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,n,s,l,o,h,u,d,c,p){let{x1:g,y1:f,x:m=u.x,y:y=u.y,stroke:v=u.stroke,cornerRadius:b=u.cornerRadius,cornerType:_=u.cornerType}=t.attribute,{width:x,height:C}=t.attribute;if(x=(null!=x?x:g-m)||0,C=(null!=C?C:f-y)||0,Array.isArray(v)&&v.some(t=>!1===t)){if(e.setStrokeStyle(t,t.attribute,i,n,u),!(0===b||(0,r.Z)(b)&&b.every(t=>0===t))){let r,s=0;return(0,a.U)(e,i,n,x,C,b,"bevel"!==_,[,,,,].fill(0).map((l,a)=>(l,o,h,d)=>{v[a]&&(s===a-1&&v[a]===r||(e.setStrokeStyle(t,Object.assign(Object.assign({},t.attribute),{stroke:v[a]}),i,n,u),e.beginPath(),e.moveTo(l,o),r=v[a]),s=a,e.lineTo(h,d),e.stroke(),3===a&&e.beginPath())})),void e.stroke()}if(e.beginPath(),e.moveTo(i,n),v[0]?e.lineTo(i+x,n):e.moveTo(i+x,n),v[1]?e.lineTo(i+x,n+C):e.moveTo(i+x,n+C),v[2]?e.lineTo(i,n+C):e.moveTo(i,n+C),v[3]){let t=v[0]?n-e.lineWidth/2:n;e.lineTo(i,t)}else e.moveTo(i,n);e.stroke()}}};p=u([(0,n.b)()],p);let g=new d,f=h.H,m=l.R6},66069:function(t,e,i){"use strict";i.d(e,{C:()=>u});var r=i(43562),n=i(17209),s=i(56229),l=i(70341),a=i(25496),o=i(2844);class h extends s.M2{constructor(){super(...arguments),this.time=n.Oh.beforeFillStroke}drawShape(t,e,i,n,s,h,u,d,c,p,g,f){var m,y,v,b,_,x,C,w,S,A;let M,{backgroundMode:k=c.backgroundMode,backgroundFit:T=c.backgroundFit,backgroundKeepAspectRatio:R=c.backgroundKeepAspectRatio}=t.attribute,B,{background:P}=t.attribute;if(!P)return;let E=()=>{"richtext"===t.type&&(e.restore(),e.save(),B&&e.setTransformFromMatrix(B,!0,1))};"richtext"===t.type&&(B=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());let I=(0,r.Z)(P)&&P.background,L=t.transMatrix.onlyTranslate();if(I){let e=t.AABBBounds,i=(null!=(m=P.x)?m:e.x1)+(null!=(y=P.dx)?y:0),r=(null!=(v=P.y)?v:e.y1)+(null!=(b=P.dy)?b:0),n=null!=(_=P.width)?_:e.width(),s=null!=(x=P.height)?x:e.height();if(M=l.et.allocate(i,r,i+n,r+s),P=P.background,!L){let t=M.width(),e=M.height();M.set((null!=(C=P.x)?C:0)+(null!=(w=P.dx)?w:0),(null!=(S=P.y)?S:0)+(null!=(A=P.dy)?A:0),t,e)}}else M=t.AABBBounds,L||(M=(0,a.o)(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){let r=t.resources.get(P);if("success"!==r.state||!r.data)return void E();e.highPerformanceSave(),L&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,n,c),this.doDrawImage(e,r.data,M,{backgroundMode:k,backgroundFit:T,backgroundKeepAspectRatio:R}),e.highPerformanceRestore(),e.setTransformForCurrent()}else{let{backgroundCornerRadius:r}=t.attribute;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,n,c),e.fillStyle=P,r?((0,o.U)(e,M.x1,M.y1,M.width(),M.height(),r,!0),e.fill()):e.fillRect(M.x1,M.y1,M.width(),M.height()),e.highPerformanceRestore()}I&&l.et.free(M),E()}}let u=new h},12687:function(t,e,i){"use strict";i.d(e,{pN:()=>g,xL:()=>h});var r=i(26004),n=i(76620),s=i(4484),l=i(45011),a=i(60504),o=i(49009);let h=Symbol.for("DrawItemInterceptor"),u=new n.FB,d=new n.FB;class c{constructor(){this.order=1}afterDrawItem(t,e,i,r,n){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,i,r,n),!1}beforeDrawItem(t,e,i,r,n){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,i,r,n),!1}drawItem(t,e,i,r,n){if(!t.shadowRoot)return!1;let{context:s}=i;if(s.highPerformanceSave(),s.transformFromMatrix(t.transMatrix,!0),r.dirtyBounds&&r.backupDirtyBounds){u.copy(r.dirtyBounds),d.copy(r.backupDirtyBounds);let e=t.globalTransMatrix.getInverse();r.dirtyBounds.copy(r.backupDirtyBounds).transformWithMatrix(e),r.backupDirtyBounds.copy(r.dirtyBounds)}return r.renderGroup(t.shadowRoot,i,a.QE.allocate(1,0,0,1,0,0)),s.highPerformanceRestore(),r.dirtyBounds&&r.backupDirtyBounds&&(r.dirtyBounds.copy(u),r.backupDirtyBounds.copy(d)),!0}}class p{constructor(){this.order=1}afterDrawItem(t,e,i,r,n){return t.attribute._debug_bounds&&this.drawItem(t,e,i,r,n),!1}drawItem(t,e,i,r,n){if(!t.attribute._debug_bounds)return!1;let{context:s}=i;s.highPerformanceSave(),t.parent&&s.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&s.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);let l=t.AABBBounds;return!0!==t.attribute._debug_bounds&&t.attribute._debug_bounds(s,t),s.strokeRect(l.x1,l.y1,l.width(),l.height()),s.highPerformanceRestore(),!0}}let g=class{constructor(){this.order=1,this.interceptors=[new c,new m,new f,new p]}afterDrawItem(t,e,i,r,n){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let s=0;s<this.interceptors.length;s++)if(this.interceptors[s].afterDrawItem&&this.interceptors[s].afterDrawItem(t,e,i,r,n))return!0;return!1}beforeDrawItem(t,e,i,r,n){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let s=0;s<this.interceptors.length;s++)if(this.interceptors[s].beforeDrawItem&&this.interceptors[s].beforeDrawItem(t,e,i,r,n))return!0;return!1}};g=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,r.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],g);class f{constructor(){this.order=1}beforeDrawItem(t,e,i,r,n){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,r,n):this.beforeSetInteractive(t,e,i,r,n))}beforeSetInteractive(t,e,i,r,n){let s=t.interactiveGraphic;if(t.attribute.globalZIndex){s||(s=t.clone(),t.interactiveGraphic=s,s.baseGraphic=t),s.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();let e=i.stage.getLayer("_builtin_interactive");return e&&this.getShadowRoot(e).add(s),!0}if(s){i.stage.tryInitInteractiveLayer();let e=i.stage.getLayer("_builtin_interactive");e&&this.getShadowRoot(e).removeChild(s),t.interactiveGraphic=null,s.baseGraphic=null}return!1}beforeDrawInteractive(t,e,i,r,n){let s=t.baseGraphic,l=!!s.stage,a=s.parent;for(;l&&a&&a.stage!==a;)l=!!a.stage,a=a.parent;if(!l){let e=i.stage.getLayer("_builtin_interactive");return e&&this.getShadowRoot(e).removeChild(t),!0}if(s){this.processing=!0;let{context:t}=i;return t.highPerformanceSave(),t.setTransformFromMatrix(s.parent.globalTransMatrix,!0),s.isContainer?r.renderGroup(s,i,s.parent.globalTransMatrix):r.renderItem(s,i),t.highPerformanceRestore(),this.processing=!1,!0}return!1}getShadowRoot(t){var e;let i=t.getElementById("_interactive_group");return i||((i=l.i.CreateGraphic("group",{})).id="_interactive_group",t.add(i)),null!=(e=i.shadowRoot)?e:i.attachShadow()}}class m{constructor(){this.order=1}beforeDrawItem(t,e,i,r,n){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;let{context:l,stage:h}=e.drawParams;l.canvas,l.save(),this.initCanvasCtx(l),l.camera=h.camera;let u=l.currentMatrix;u.a/=l.dpr,u.b/=l.dpr,u.c/=l.dpr,u.d/=l.dpr,u.e/=l.dpr,u.f/=l.dpr;let d=a.yp.allocate();(0,s.B$)(d,u);let c=l.modelMatrix;if(c){if(d){let t=a.yp.allocate();l.modelMatrix=(0,s.G9)(t,c,d)}}else l.modelMatrix=d;return l.setTransform(1,0,0,1,0,0,!0),t.isContainer?(0,o.y)(l,t,(e,n)=>r.renderGroup(t,i,t.parent.globalTransMatrix,!e&&n),i):r.renderItem(t,i),l.camera=null,l.restore(),l.modelMatrix!==c&&a.yp.free(l.modelMatrix),l.modelMatrix=c,i.in3dInterceptor=!1,!0}initCanvasCtx(t){t.setTransformForCurrent()}}},13950:function(t,e,i){"use strict";i.d(e,{K:()=>h});var r=i(26004),n=i(79314),s=i(4062),l=i(60543),a=i(7246),o=i(29863);let h=class extends a.j{constructor(){super(...arguments),this.numberType=n.Ri}drawShape(t,e,i,r,n,a,o){if(t.incremental&&n.multiGraphicOptions){let{startAtIdx:a,length:h}=n.multiGraphicOptions,{segments:u=[]}=t.attribute;if(a>u.length)return;let d=(0,s.gh)(t).area,{fill:c=d.fill,fillOpacity:p=d.fillOpacity,opacity:g=d.opacity,visible:f=d.visible}=t.attribute,m=(0,l.Bv)(g,p,c),y=(0,l.dz)(c);if(t.valid&&f&&y&&(m||o))for(let n=a;n<a+h;n++)this.drawIncreaseSegment(t,e,u[n-1],u[n],t.attribute.segments[n],[d,t.attribute],i,r)}else super.drawShape(t,e,i,r,n,a,o)}drawIncreaseSegment(t,e,i,r,n,s,l,a){r&&(e.beginPath(),(0,o.hJ)(e.camera?e:e.nativeContext,i,r,{offsetX:l,offsetY:a}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,n,s),e.setCommonStyle(t,n,l,a,s),e.fill())}};h=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,r.b)()],h)},36063:function(t,e,i){"use strict";i.d(e,{U:()=>h});var r=i(26004),n=i(4062),s=i(79314),l=i(60543),a=i(46553),o=i(29863);let h=class extends a.X{constructor(){super(...arguments),this.numberType=s.Hf}drawShape(t,e,i,r,s,a,o,h){if(t.incremental&&s.multiGraphicOptions){let{startAtIdx:e,length:a}=s.multiGraphicOptions,{segments:u=[]}=t.attribute;if(e>u.length)return;let d=(0,n.gh)(t).line,{fill:c=d.fill,stroke:p=d.stroke,opacity:g=d.opacity,fillOpacity:f=d.fillOpacity,strokeOpacity:m=d.strokeOpacity,lineWidth:y=d.lineWidth,visible:v=d.visible}=t.attribute,b=(0,l.Bv)(g,f,c),_=(0,l.Kf)(g,m),x=(0,l.dz)(c),C=(0,l.ak)(p,y);if(!t.valid||!v||!x&&!C||!(b||_||o||h))return;let{context:w}=s;for(let n=e;n<e+a;n++)this.drawIncreaseSegment(t,w,u[n-1],u[n],t.attribute.segments[n],[d,t.attribute],i,r)}else super.drawShape(t,e,i,r,s,a,o,h)}drawIncreaseSegment(t,e,i,r,n,s,l,a){r&&(e.beginPath(),(0,o.V3)(e.nativeContext,i,r,{offsetX:l,offsetY:a}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,n,s),e.setStrokeStyle(t,n,l,a,s),e.stroke())}};h=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,r.b)()],h)},46553:function(t,e,i){"use strict";i.d(e,{X:()=>d});var r=i(31535),n=i(88504),s=i(26004),l=i(4062),a=i(79314),o=i(34688),h=i(29863),u=i(51402);let d=class extends o.Y{constructor(){super(...arguments),this.numberType=a.Hf}draw(t,e,i,r){let n=(0,l.gh)(t,null==r?void 0:r.theme).line;this._draw(t,n,!1,i,r)}drawSegmentItem(t,e,i,n,s,l,a,o,u,d,c,p,g,f,m){var y;if(!e)return;t.beginPath();let v=null!=(y=this.z)?y:0;(0,h.fW)(t,e,u,d,{offsetX:c,offsetY:p,offsetZ:v}),g.cache&&!(0,r.Z)(g.cache)&&g.cache.curves.every(t=>t.defined)&&g.attribute.curveType&&g.attribute.curveType.includes("Closed")&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(g,a,o);let{x:b=0,x:_=0}=a;return!1!==i&&(f?f(t,a,o):s&&(t.setCommonStyle(g,a,b-c,_-p,o),t.fill())),!1!==n&&(m?m(t,a,o):l&&(t.setStrokeStyle(g,a,b-c,_-p,o),t.stroke())),!1}drawLinearLineHighPerformance(t,e,i,r,n,s,l,a,o,h,u,d,c){var p;e.beginPath();let g=null!=(p=this.z)?p:0,{points:f}=t.attribute,m=f[0];e.moveTo(m.x+l,m.y+a,g);for(let t=1;t<f.length;t++){let i=f[t];e.lineTo(i.x+l,i.y+a,g)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o);let{x:y=0,x:v=0}=t.attribute;!1!==i&&(d?d(e,t.attribute,o):n&&(e.setCommonStyle(t,t.attribute,y-l,v-a,o),e.fill())),!1!==r&&(c?c(e,t.attribute,o):s&&(e.setStrokeStyle(t,t.attribute,y-l,v-a,o),e.stroke()))}drawShape(t,e,i,r,s,a,o,h){let d=(0,l.gh)(t,null==a?void 0:a.theme).line,{fill:c=d.fill,stroke:p=d.stroke,fillOpacity:g=d.fillOpacity,strokeOpacity:f=d.strokeOpacity,segments:m,points:y,closePath:v,curveTension:b=d.curveTension,connectedType:_=d.connectedType}=t.attribute;if(!this.valid(t,d,o,h))return;let{curveType:x=d.curveType}=t.attribute;v&&"linear"===x&&(x="linearClosed");let{clipRange:C=d.clipRange,clipRangeByDimension:w=d.clipRangeByDimension}=t.attribute;if(1===C&&!m&&!y.some(t=>!1===t.defined)&&"linear"===x)return this.drawLinearLineHighPerformance(t,e,!!c,!!p,g,f,i,r,d,s,a,o,h);function S(t,e){return"none"===e?t:t.filter(t=>!1!==t.defined)}if(t.shouldUpdateShape()){let{points:e,segments:i}=t.attribute;if(i&&i.length){let e,r;if(t.cache=i.map((t,i)=>{if(t.points.length<=1&&0===i)return t.points[0]&&(r={endX:t.points[0].x,endY:t.points[0].y,curves:[{defined:!1!==t.points[0].defined}]}),null;1===i?e={x:r.endX,y:r.endY,defined:r.curves[r.curves.length-1].defined}:i>1&&(e.x=r.endX,e.y=r.endY,e.defined=r.curves[r.curves.length-1].defined);let n=(0,u.X0)(S(t.points,_),x,{startPoint:e,curveTension:b});return r=n,n}).filter(t=>!!t),"linearClosed"===x){let e;for(let i=0;i<t.cache.length;i++){let r=t.cache[i];for(let t=0;t<r.curves.length;t++)if(r.curves[t].defined){e=r.curves[t].p0;break}if(e)break}t.cache[t.cache.length-1]&&t.cache[t.cache.length-1].lineTo(e.x,e.y,!0)}}else{if(!e||!e.length)return t.cache=null,void t.clearUpdateShapeTag();t.cache=(0,u.X0)(S(e,_),x,{curveTension:b})}t.clearUpdateShapeTag()}if(Array.isArray(t.cache)){let s=t.attribute.segments.filter(t=>t.points.length);if(1===s[0].points.length&&s.shift(),1===C){let n=!1;t.cache.forEach((l,a)=>{n||(n=this.drawSegmentItem(e,l,!!c,!!p,g,f,s[a],[d,t.attribute],C,w,i,r,t,o,h))})}else{let l=C*t.cache.reduce((t,e)=>t+e.getLength(),0),a=0,u=!1;t.cache.forEach((m,y)=>{if(u)return;let v=m.getLength(),b=(l-a)/v;a+=v,b>0&&(u=this.drawSegmentItem(e,m,!!c,!!p,g,f,s[y],[d,t.attribute],(0,n.VV)(b,1),w,i,r,t,o,h))})}}else this.drawSegmentItem(e,t.cache,!!c,!!p,g,f,t.attribute,d,C,w,i,r,t,o,h)}};d=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,s.b)()],d)},28856:function(t,e,i){"use strict";i.d(e,{Cb:()=>o,EY:()=>g,FU:()=>m,Gs:()=>s,Iv:()=>v,O:()=>h,Pf:()=>r,Uj:()=>c,Xe:()=>n,ZT:()=>d,aP:()=>l,e0:()=>y,fS:()=>f,lG:()=>u,tP:()=>p,uz:()=>a});let r=Symbol.for("IncrementalDrawContribution"),n=Symbol.for("ArcRender");Symbol.for("Arc3dRender");let s=Symbol.for("AreaRender"),l=Symbol.for("CircleRender"),a=Symbol.for("GraphicRender"),o=Symbol.for("GroupRender"),h=Symbol.for("LineRender"),u=Symbol.for("PathRender"),d=Symbol.for("PolygonRender"),c=Symbol.for("RectRender");Symbol.for("Rect3DRender");let p=Symbol.for("SymbolRender"),g=Symbol.for("TextRender"),f=Symbol.for("RichTextRender");Symbol.for("Pyramid3dRender");let m=Symbol.for("GlyphRender"),y=Symbol.for("ImageRender");Symbol.for("RenderSelector");let v=Symbol.for("DrawContribution");Symbol.for("StarRender")},60543:function(t,e,i){"use strict";i.d(e,{Bv:()=>a,Eg:()=>p,GT:()=>o,Kf:()=>h,ZN:()=>c,Ze:()=>u,ak:()=>l,dz:()=>s,gI:()=>d});var r=i(31535),n=i(88504);function s(t,e){return!(!t&&!e)}function l(t,e){return((0,r.Z)(t)?t.some(t=>t||void 0===t):!!t)&&e>0}function a(t,e,i){return i&&t*e>0}function o(t,e,i,r,n){return n&&t*e>0&&0!==i&&0!==r}function h(t,e){return t*e>0}function u(t,e,i,r,n){return n?t*e>0:t*e>0&&0!==i&&0!==r}function d(t,e,i,r,n,s,l){let a=t-i,o=e-r,h=(l?s:-s)/Math.sqrt(a*a+o*o),u=h*o,d=-h*a,c=t+u,p=e+d,g=i+u,f=r+d,m=(c+g)/2,y=(p+f)/2,v=g-c,b=f-p,_=v*v+b*b,x=n-s,C=c*f-g*p,w=(b<0?-1:1)*Math.sqrt(Math.max(0,x*x*_-C*C)),S=(C*b-v*w)/_,A=(-C*v-b*w)/_,M=(C*b+v*w)/_,k=(-C*v+b*w)/_,T=S-m,R=A-y,B=M-m,P=k-y;return T*T+R*R>B*B+P*P&&(S=M,A=k),{cx:S,cy:A,x01:-u,y01:-d,x11:S*(n/x-1),y11:A*(n/x-1)}}function c(t,e,i,s,l){let a,o,h,u,d=(0,n.Wn)(i-e),c=t.getParsedCornerRadius(),p=(0,r.Z)(c),{outerDeltaAngle:g,innerDeltaAngle:f,outerStartAngle:m,outerEndAngle:y,innerEndAngle:v,innerStartAngle:b}=t.getParsePadAngle(e,i),_=p?c[0]:c,x=p?c[1]:c,C=p?c[2]:c,w=p?c[3]:c,S=Math.max(x,_),A=Math.max(C,w),M=S,k=A,T=l*(0,n.mC)(m),R=l*(0,n.O$)(m),B=s*(0,n.mC)(v),P=s*(0,n.O$)(v);if((A>n.Ho||S>n.Ho)&&(a=l*(0,n.mC)(y),o=l*(0,n.O$)(y),h=s*(0,n.mC)(b),u=s*(0,n.O$)(b),d<n.pi)){let t=function(t,e,i,r,s,l,a,o){let h=i-t,u=r-e,d=a-s,c=o-l,p=c*h-d*u;return p*p<n.Ho?[]:(p=(d*(e-l)-c*(t-s))/p,[t+p*h,e+p*u])}(T,R,h,u,a,o,B,P);if(t){let e=T-t[0],i=R-t[1],r=a-t[0],h=o-t[1],u=1/(0,n.O$)((0,n.Kh)((e*r+i*h)/((0,n._b)(e*e+i*i)*(0,n._b)(r*r+h*h)))/2),d=(0,n._b)(t[0]*t[0]+t[1]*t[1]);k=(0,n.VV)(A,(s-d)/(u-1)),M=(0,n.VV)(S,(l-d)/(u+1))}}return{outerDeltaAngle:g,xors:T,yors:R,xirs:h,yirs:u,xore:a,yore:o,xire:B,yire:P,limitedOcr:M,limitedIcr:k,outerCornerRadiusStart:_,outerCornerRadiusEnd:x,maxOuterCornerRadius:S,maxInnerCornerRadius:A,outerStartAngle:m,outerEndAngle:y,innerDeltaAngle:f,innerEndAngle:v,innerStartAngle:b,innerCornerRadiusStart:w,innerCornerRadiusEnd:C}}function p(t,e,i,r,s,l,a){let{startAngle:o,endAngle:h}=t.getParsedAngle(),u=(0,n.Wn)(h-o),p=h>o,g=!1;if(s<l){let t=s;s=l,l=t}if(s<=n.Ho)e.moveTo(i,r);else if(u>=n.f7-n.Ho)e.moveTo(i+s*(0,n.mC)(o),r+s*(0,n.O$)(o)),e.arc(i,r,s,o,h,!p),l>n.Ho&&(e.moveTo(i+l*(0,n.mC)(h),r+l*(0,n.O$)(h)),e.arc(i,r,l,h,o,p));else{let{outerDeltaAngle:u,xors:f,yors:m,xirs:y,yirs:v,limitedOcr:b,outerCornerRadiusStart:_,outerCornerRadiusEnd:x,maxOuterCornerRadius:C,xore:w,yore:S,xire:A,yire:M,outerStartAngle:k,outerEndAngle:T,limitedIcr:R,innerDeltaAngle:B,innerEndAngle:P,innerStartAngle:E,innerCornerRadiusStart:I,innerCornerRadiusEnd:L,maxInnerCornerRadius:F}=c(t,o,h,l,s);if(u<.001)a&&(a[3]||a[1])&&e.moveTo(i+f,r+m),g=!0;else if(b>n.Ho){let t=(0,n.VV)(_,b),l=(0,n.VV)(x,b),o=d(y,v,f,m,s,t,Number(p)),h=d(w,S,A,M,s,l,Number(p));b<C&&t===l?!a||a[0]?(e.moveTo(i+o.cx+o.x01,r+o.cy+o.y01),e.arc(i+o.cx,r+o.cy,b,(0,n.fv)(o.y01,o.x01),(0,n.fv)(h.y01,h.x01),!p)):e.moveTo(i+o.cx+b*(0,n.mC)((0,n.fv)(h.y01,h.x01)),r+o.cy+b*(0,n.O$)((0,n.fv)(h.y01,h.x01))):!a||a[0]?(e.moveTo(i+o.cx+o.x01,r+o.cy+o.y01),t>0&&e.arc(i+o.cx,r+o.cy,t,(0,n.fv)(o.y01,o.x01),(0,n.fv)(o.y11,o.x11),!p),e.arc(i,r,s,(0,n.fv)(o.cy+o.y11,o.cx+o.x11),(0,n.fv)(h.cy+h.y11,h.cx+h.x11),!p),l>0&&e.arc(i+h.cx,r+h.cy,l,(0,n.fv)(h.y11,h.x11),(0,n.fv)(h.y01,h.x01),!p)):l>0?e.moveTo(i+h.cx+l*(0,n.mC)((0,n.fv)(h.y01,h.x01)),r+h.cy+l*(0,n.O$)((0,n.fv)(h.y01,h.x01))):e.moveTo(i+w,r+s*(0,n.O$)(T))}else!a||a[0]?(e.moveTo(i+f,r+m),e.arc(i,r,s,k,T,!p)):e.moveTo(i+s*(0,n.mC)(T),r+s*(0,n.O$)(T));if(!(l>n.Ho)||B<.001)!a||a[1]?e.lineTo(i+A,r+M):e.moveTo(i+A,r+M),g=!0;else if(R>n.Ho){let t=(0,n.VV)(I,R),s=(0,n.VV)(L,R),o=d(A,M,w,S,l,-s,Number(p)),h=d(f,m,y,v,l,-t,Number(p));if(!a||a[1]?e.lineTo(i+o.cx+o.x01,r+o.cy+o.y01):e.moveTo(i+o.cx+o.x01,r+o.cy+o.y01),R<F&&t===s){let t=(0,n.fv)(h.y01,h.x01);!a||a[2]?e.arc(i+o.cx,r+o.cy,R,(0,n.fv)(o.y01,o.x01),t,!p):e.moveTo(i+o.cx+(0,n.mC)(t),r+o.cy+(0,n.O$)(t))}else!a||a[2]?(s>0&&e.arc(i+o.cx,r+o.cy,s,(0,n.fv)(o.y01,o.x01),(0,n.fv)(o.y11,o.x11),!p),e.arc(i,r,l,(0,n.fv)(o.cy+o.y11,o.cx+o.x11),(0,n.fv)(h.cy+h.y11,h.cx+h.x11),p),t>0&&e.arc(i+h.cx,r+h.cy,t,(0,n.fv)(h.y11,h.x11),(0,n.fv)(h.y01,h.x01),!p)):t>0?e.moveTo(i+h.cx+t*(0,n.mC)((0,n.fv)(h.y01,h.x01)),r+h.cy+t*(0,n.O$)((0,n.fv)(h.y01,h.x01))):e.moveTo(i+y,r+v)}else!a||a[1]?e.lineTo(i+A,r+M):e.moveTo(i+A,r+M),!a||a[2]?e.arc(i,r,l,P,E,p):e.moveTo(i+l*(0,n.mC)(E),r+l*(0,n.O$)(E))}return a?a[3]&&e.lineTo(i+s*(0,n.mC)(o),r+s*(0,n.O$)(o)):e.closePath(),g}},20842:function(t,e,i){"use strict";i.d(e,{h:()=>n});var r=i(16049);class n{static GetImage(t,e){var i;let s=n.cache.get(t);s?"fail"===s.loadState?r.w.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):"init"===s.loadState||"loading"===s.loadState?null==(i=s.waitingMark)||i.push(e):e&&e.imageLoadSuccess(t,s.data):n.loadImage(t,e)}static GetSvg(t,e){var i;let s=n.cache.get(t);s?"fail"===s.loadState?r.w.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):"init"===s.loadState||"loading"===s.loadState?null==(i=s.waitingMark)||i.push(e):e&&e.imageLoadSuccess(t,s.data):(s={type:"image",loadState:"init"},n.cache.set(t,s),s.dataPromise=r.w.global.loadSvg(t),s.dataPromise?(s.waitingMark=[e],s.dataPromise.then(e=>{var i;s.loadState=(null==e?void 0:e.data)?"success":"fail",s.data=null==e?void 0:e.data,null==(i=s.waitingMark)||i.map((i,r)=>{(null==e?void 0:e.data)?(s.loadState="success",s.data=e.data,i.imageLoadSuccess(t,e.data)):(s.loadState="fail",i.imageLoadFail(t))}),s.waitingMark&&(s.waitingMark=[])})):(s.loadState="fail",e.imageLoadFail(t)))}static GetFile(t,e){let i=n.cache.get(t);return i?"fail"===i.loadState?Promise.reject():"init"===i.loadState||"loading"===i.loadState?i.dataPromise.then(t=>t.data):Promise.resolve(i.data):(i={type:e,loadState:"init"},n.cache.set(t,i),"arrayBuffer"===e?i.dataPromise=r.w.global.loadArrayBuffer(t):"blob"===e?i.dataPromise=r.w.global.loadBlob(t):"json"===e&&(i.dataPromise=r.w.global.loadJson(t)),i.dataPromise.then(t=>t.data))}static loading(){setTimeout(()=>{if(!n.isLoading&&n.toLoadAueue.length){n.isLoading=!0;let t=n.toLoadAueue.splice(0,10),e=[];t.forEach(t=>{let{url:i,marks:s}=t,l={type:"image",loadState:"init"};if(n.cache.set(i,l),l.dataPromise=r.w.global.loadImage(i),l.dataPromise){l.waitingMark=s;let t=l.dataPromise.then(t=>{var e;l.loadState=(null==t?void 0:t.data)?"success":"fail",l.data=null==t?void 0:t.data,null==(e=l.waitingMark)||e.map((e,r)=>{(null==t?void 0:t.data)?(l.loadState="success",l.data=t.data,e.imageLoadSuccess(i,t.data)):(l.loadState="fail",e.imageLoadFail(i))}),l.waitingMark&&(l.waitingMark=[])});e.push(t)}else l.loadState="fail",s.forEach(t=>t.imageLoadFail(i))}),Promise.all(e).then(()=>{n.isLoading=!1,this.onLoadSuccessCb.forEach(t=>t()),n.loading()}).catch(t=>{console.error(t),n.isLoading=!1,this.onLoadSuccessCb.forEach(t=>t()),n.loading()})}},0)}static loadImage(t,e){let i=s(t,n.toLoadAueue);if(-1!==i)return n.toLoadAueue[i].marks.push(e),void n.loading();n.toLoadAueue.push({url:t,marks:[e]}),n.loading()}static improveImageLoading(t){let e=s(t,n.toLoadAueue);if(-1!==e){let t=n.toLoadAueue.splice(e,1);n.toLoadAueue.unshift(t[0])}}static onLoadSuccess(t){this.onLoadSuccessCb.push(t)}}function s(t,e){for(let i=0;i<e.length;i++)if(e[i].url===t)return i;return -1}n.cache=new Map,n.isLoading=!1,n.toLoadAueue=[],n.onLoadSuccessCb=[]},2079:function(t,e,i){"use strict";i.d(e,{n:()=>n});class r{constructor(t,e){this._args=t,this.name=e,this.taps=[]}tap(t,e){this._tap("sync",t,e)}unTap(t,e){let i="string"==typeof t?t.trim():t.name;i&&(this.taps=this.taps.filter(t=>!(t.name===i&&(!e||t.fn===e))))}_parseOptions(t,e,i){let r;if("string"==typeof e)r={name:e.trim()};else if("object"!=typeof e||null===e)throw Error("Invalid tap options");if("string"!=typeof r.name||""===r.name)throw Error("Missing name for tap");return Object.assign({type:t,fn:i},r)}_tap(t,e,i){this._insert(this._parseOptions(t,e,i))}_insert(t){let e;"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));let i=0;"number"==typeof t.stage&&(i=t.stage);let r=this.taps.length;for(;r>0;){r--;let t=this.taps[r];this.taps[r+1]=t;let n=t.stage||0;if(e){if(e.has(t.name)){e.delete(t.name);continue}if(e.size>0)continue}if(!(n>i)){r++;break}}this.taps[r]=t}}class n extends r{call(...t){this.taps.map(t=>t.fn).forEach(e=>e(...t))}}},2123:function(t,e,i){"use strict";i.d(e,{s:()=>m});var r=i(88504),n=i(8992),s=i(30943),l=i(28504),a=i(36081),o=i(60504),h=i(4484),u=i(20686),d=i(16049),c=i(21823),p=i(26004);let g=[0,0,0],f=(t,e,i,n,s,l,a,o)=>{if(o)for(;i>e;)i-=r.f7;else for(;i<e;)i+=r.f7;let h=r.pi/3*(i>e?1:-1),u=e,d=u;for(;d!==i;){let e=4*Math.tan(Math.abs((d=h>0?Math.min(d+h,i):Math.max(d+h,i))-u)/4)/3,r=d<u?-1:1,o=Math.cos(u),c=Math.sin(u),p=Math.cos(d),g=Math.sin(d),f=o*l+n,m=c*a+s,y=p*l+n,v=g*a+s,b=l*e*r,_=a*e*r;t.push([f-b*c,m+_*o,y+b*g,v-_*p,y,v]),u=d}},m=class{set fillStyle(t){this.nativeContext.fillStyle=t}get fillStyle(){return this.nativeContext.fillStyle}set font(t){t!==this._font&&(this._font=t,this.nativeContext.font=t)}get font(){var t;return null!=(t=this._font)?t:this.nativeContext.font}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha}get globalAlpha(){return this.nativeContext.globalAlpha}set lineCap(t){this.nativeContext.lineCap=t}get lineCap(){return this.nativeContext.lineCap}set lineDashOffset(t){this.nativeContext.lineDashOffset=t}get lineDashOffset(){return this.nativeContext.lineDashOffset}set lineJoin(t){this.nativeContext.lineJoin=t}get lineJoin(){return this.nativeContext.lineJoin}set lineWidth(t){this.nativeContext.lineWidth=t}get lineWidth(){return this.nativeContext.lineWidth}set miterLimit(t){this.nativeContext.miterLimit=t}get miterLimit(){return this.nativeContext.miterLimit}set shadowBlur(t){this.nativeContext.shadowBlur=t}get shadowBlur(){return this.nativeContext.shadowBlur}set shadowColor(t){this.nativeContext.shadowColor=t}get shadowColor(){return this.nativeContext.shadowColor}set shadowOffsetX(t){this.nativeContext.shadowOffsetX=t}get shadowOffsetX(){return this.nativeContext.shadowOffsetX}set shadowOffsetY(t){this.nativeContext.shadowOffsetY=t}get shadowOffsetY(){return this.nativeContext.shadowOffsetY}set strokeStyle(t){this.nativeContext.strokeStyle=t}get strokeStyle(){return this.nativeContext.strokeStyle}set textAlign(t){this.nativeContext.textAlign=t}get textAlign(){return this.nativeContext.textAlign}set textBaseline(t){this.nativeContext.textBaseline=t}get textBaseline(){return this.nativeContext.textBaseline}get inuse(){return!!this._inuse}set inuse(t){!!this._inuse!==t&&(this._inuse=t,t?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}constructor(t,e){this.fillAttributes=Object.assign(Object.assign({},a.pp),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},a.WC),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},a.q9),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;let i=t.nativeCanvas.getContext("2d");if(!i)throw Error("发生错误，获取2d上下文失败");this.nativeContext=i,this.canvas=t,this.matrix=new n.y(1,0,0,1,0,0),this.stack=[],this.dpr=e,this.applyedMatrix=new n.y(1,0,0,1,0,0),this._clearMatrix=new n.y(1,0,0,1,0,0),this.baseGlobalAlpha=1}reset(t=!0){this.stack.length&&s.Y.getInstance().warn("可能存在bug，matrix没有清空"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new n.y(1,0,0,1,0,0),this.stack.length=0,t&&this.nativeContext.setTransform(1,0,0,1,0,0)}getCanvas(){return this.canvas}getContext(){return this.nativeContext}setTransformForCurrent(t=!1){!t&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}get currentMatrix(){return this.matrix}cloneMatrix(t){return o.QE.allocateByObj(t)}clear(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}restore(){this.nativeContext.restore(),this.stack.length>0&&(o.QE.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0)),this.font="",this._clearFilterStyle=!1,this._clearShadowStyle=!1}highPerformanceRestore(){this.stack.length>0&&(o.QE.free(this.matrix),this.matrix=this.stack.pop())}rotate(t,e=!0){this.matrix.rotate(t),e&&this.setTransformForCurrent()}save(){let t=this.cloneMatrix(this.matrix);this.stack.push(t),this.nativeContext.save()}highPerformanceSave(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}scale(t,e,i=!0){this.matrix.scale(t,e),i&&this.setTransformForCurrent()}setScale(t,e,i=!0){this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}scalePoint(t,e,i,r,n=!0){this.translate(i,r,!1),this.scale(t,e,!1),this.translate(-i,-r,!1),n&&this.setTransformForCurrent()}setTransform(t,e,i,r,n,s,l=!0,a=this.dpr){this.matrix.setValue(a*t,a*e,a*i,a*r,a*n,a*s),l&&this.setTransformForCurrent()}setTransformFromMatrix(t,e=!0,i=this.dpr){this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}resetTransform(t=!0,e=this.dpr){this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}transform(t,e,i,r,n,s,l=!0){this.matrix.multiply(t,e,i,r,n,s),l&&this.setTransformForCurrent()}transformFromMatrix(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}translate(t,e,i=!0){this.matrix.translate(t,e),i&&this.setTransformForCurrent()}rotateDegrees(t,e=!0){let i=t*Math.PI/180;this.rotate(i,e)}rotateAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}rotateDegreesAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}beginPath(){this.disableBeginPath||this.nativeContext.beginPath()}clip(t,e){t?"string"==typeof t?this.nativeContext.clip(t):this.nativeContext.clip(t,e):this.nativeContext.clip()}arc(t,e,i,r,n,s,l){if(l=l||0,this.camera){let a=[];f(a,r,n,t,e,i,i,s);for(let t=0;t<a.length;++t){let e=a[t];this.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5],l)}}else this.nativeContext.arc(t,e,Math.max(0,i),r,n,s)}arcTo(t,e,i,r,n){this.nativeContext.arcTo(t,e,i,r,n)}bezierCurveTo(t,e,i,r,n,s,l){if(l=l||0,this.camera){let a=l,o=l;this.modelMatrix&&((0,h.fF)(g,[t,e,l],this.modelMatrix),t=g[0],e=g[1],a=g[2],(0,h.fF)(g,[i,r,l],this.modelMatrix),i=g[0],r=g[1],o=g[2],(0,h.fF)(g,[n,s,l],this.modelMatrix),n=g[0],s=g[1],l=g[2]);let u=this.camera.vp(n,s,l);n=u.x,s=u.y,t=(u=this.camera.vp(t,e,a)).x,e=u.y,i=(u=this.camera.vp(i,r,o)).x,r=u.y}this.nativeContext.bezierCurveTo(t,e,i,r,n,s)}closePath(){this.nativeContext.closePath()}ellipse(t,e,i,r,n,s,l,a){null==a?this.nativeContext.ellipse(t,e,i,r,n,s,l):this.nativeContext.ellipse(t,e,i,r,n,s,l,a)}lineTo(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[t,e,i],this.modelMatrix),t=g[0],e=g[1],i=g[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.lineTo(t,e)}moveTo(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[t,e,i],this.modelMatrix),t=g[0],e=g[1],i=g[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.moveTo(t,e)}quadraticCurveTo(t,e,i,r,n){if(n=n||0,this.camera){let s=n;this.modelMatrix&&((0,h.fF)(g,[t,e,n],this.modelMatrix),t=g[0],e=g[1],s=g[2],(0,h.fF)(g,[i,r,n],this.modelMatrix),i=g[0],r=g[1],n=g[2]);let l=this.camera.vp(i,r,n);i=l.x,r=l.y,t=(l=this.camera.vp(t,e,s)).x,e=l.y}this.nativeContext.quadraticCurveTo(t,e,i,r)}rect(t,e,i,r,n){n=n||0,this.camera?(this.moveTo(t,e,n),this.lineTo(t+i,e,n),this.lineTo(t+i,e+r,n),this.lineTo(t,e+r,n),this.closePath()):this.nativeContext.rect(t,e,i,r)}createImageData(){let t=arguments;return 2===t.length?this.nativeContext.createImageData(t[0],t[1]):1===t.length?this.nativeContext.createImageData(t[0]):null}createLinearGradient(t,e,i,r){return isFinite(t+e+i+r)||(t=0,e=0,i=0,r=0),this.nativeContext.createLinearGradient(t,e,i,r)}createPattern(t,e){return 0===t.width||0===t.height?null:this.nativeContext.createPattern(t,e)}createRadialGradient(t,e,i,r,n,s){return this.nativeContext.createRadialGradient(t,e,i,r,n,s)}createConicGradient(t,e,i,r){if(this.nativeContext.createConicGradient&&.001>Math.abs(r-i-2*Math.PI))return this.nativeContext.createConicGradient(i,t,e);let n,s=!1,l=this;return{stops:[],addColorStop(t,e){this.stops.push([t,e]),s=!0},GetPattern(a,o,h){return s&&(h||(h=r-i),n=(0,u.Of)(l,this.stops,t,e,h,i,r,a,o),s=!1),n}}}fill(t,e){this.disableFill||(t?this.nativeContext.fill(t):this.nativeContext.fill())}fillRect(t,e,i,r){this.nativeContext.fillRect(t,e,i,r)}clearRect(t,e,i,r){this.nativeContext.clearRect(t,e,i,r)}project(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[t,e,i],this.modelMatrix),t=g[0],e=g[1],i=g[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}return{x:t,y:e}}view(t,e,i){return i=i||0,this.camera?(this.modelMatrix&&((0,h.fF)(g,[t,e,i],this.modelMatrix),t=g[0],e=g[1],i=g[2]),this.camera.view(t,e,i)):[t,e,i]}fillText(t,e,i,r){if(r=r||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[e,i,r],this.modelMatrix),e=g[0],i=g[1],r=g[2]);let t=this.camera.vp(e,i,r);e=t.x,i=t.y}this.nativeContext.fillText(t,e,i)}getImageData(t,e,i,r){return this.nativeContext.getImageData(t,e,i,r)}getLineDash(){return this.nativeContext.getLineDash()}isPointInPath(t,e){return this.nativeContext.isPointInPath(t,e)}isPointInStroke(t,e){return this.nativeContext.isPointInStroke(t,e)}measureText(t,e=d.w.global.measureTextMethod){var i,r;if(!e||"native"===e)return this.nativeContext.measureText(t);this.mathTextMeasure||(this.mathTextMeasure=d.w.graphicUtil.createTextMeasureInstance({},{},()=>this.canvas.nativeCanvas));let n=null!=(i=this.fontFamily)?i:a.q9.fontFamily,s=null!=(r=this.fontSize)?r:a.q9.fontSize;return this.mathTextMeasure.textSpec.fontFamily===n&&this.mathTextMeasure.textSpec.fontSize===s||(this.mathTextMeasure.textSpec.fontFamily=n,this.mathTextMeasure.textSpec.fontSize=s,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(t,e)}putImageData(t,e,i){this.nativeContext.putImageData(t,e,i)}setLineDash(t){let e=arguments,i=this.nativeContext;this.nativeContext.setLineDash?e[0]&&i.setLineDash(e[0]):"mozDash"in i?i.mozDash=e[0]:"webkitLineDash"in i&&(i.webkitLineDash=e[0])}stroke(t){this.disableStroke||(t?this.nativeContext.stroke(t):this.nativeContext.stroke())}strokeRect(t,e,i,r){this.nativeContext.strokeRect(t,e,i,r)}strokeText(t,e,i,r){if(r=r||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[e,i,r],this.modelMatrix),e=g[0],i=g[1],r=g[2]);let t=this.camera.vp(e,i,r);e=t.x,i=t.y}this.nativeContext.strokeText(t,e,i)}drawImage(){let t=this.nativeContext,e=arguments;3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}setCommonStyle(t,e,i,r,n){if(Array.isArray(n)){if(n.length<=1)return this._setCommonStyle(t,e,i,r,n[0]);let s=Object.create(n[0]);return n.forEach((t,e)=>{0!==e&&Object.assign(s,t)}),this._setCommonStyle(t,e,i,r,s)}return this._setCommonStyle(t,e,i,r,n)}_setCommonStyle(t,e,i,r,n){let s=this.nativeContext;n||(n=this.fillAttributes);let{fillOpacity:l=n.fillOpacity,opacity:a=n.opacity,fill:o=n.fill}=e;s.globalAlpha=l*a*this.baseGlobalAlpha,l>1e-12&&a>1e-12&&(s.fillStyle=(0,c.L)(this,o,t,i,r))}setShadowBlendStyle(t,e,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(t,i[0]);let r=Object.create(i[0]);return i.forEach((t,e)=>{0!==e&&Object.assign(r,t)}),this._setShadowBlendStyle(t,e,r)}return this._setShadowBlendStyle(t,e,i)}_setShadowBlendStyle(t,e,i){let r=this.nativeContext;i||(i=this.fillAttributes);let{opacity:n=i.opacity,shadowBlur:s=i.shadowBlur,shadowOffsetX:l=i.shadowOffsetX,shadowOffsetY:a=i.shadowOffsetY,blur:o=i.blur,globalCompositeOperation:h=i.globalCompositeOperation}=e;if(!(n<=1e-12)){if(l||a||s){let{shadowColor:t=i.shadowColor,shadowOffsetX:n=i.shadowOffsetX,shadowOffsetY:l=i.shadowOffsetY}=e;r.shadowBlur=s*this.dpr,r.shadowColor=t,r.shadowOffsetX=n*this.dpr,r.shadowOffsetY=l*this.dpr,this._clearShadowStyle=!0}else this._clearShadowStyle&&(r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0);o?(r.filter=`blur(${o}px)`,this._clearFilterStyle=!0):this._clearFilterStyle&&(r.filter="blur(0px)",this._clearFilterStyle=!1),h?(r.globalCompositeOperation=h,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(r.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1)}}setStrokeStyle(t,e,i,r,n){if(Array.isArray(n)){if(n.length<=1)return this._setStrokeStyle(t,e,i,r,n[0]);let s=Object.create(n[0]);return n.forEach((t,e)=>{0!==e&&Object.assign(s,t)}),this._setStrokeStyle(t,e,i,r,s)}return this._setStrokeStyle(t,e,i,r,n)}_setStrokeStyle(t,e,i,r,n){let s=this.nativeContext;n||(n=this.strokeAttributes);let{strokeOpacity:l=n.strokeOpacity,opacity:a=n.opacity}=e;if(s.globalAlpha=l*a*this.baseGlobalAlpha,l>1e-12&&a>1e-12){let{lineWidth:l=n.lineWidth,stroke:a=n.stroke,lineJoin:o=n.lineJoin,lineDash:h=n.lineDash,lineDashOffset:u=n.lineDashOffset,lineCap:d=n.lineCap,miterLimit:p=n.miterLimit,keepStrokeScale:g=n.keepStrokeScale}=e;s.lineWidth=g?l:(0,c.D)(this,l,this.dpr),s.strokeStyle=(0,c.L)(this,a,t,i,r),s.lineJoin=o,h&&(s.setLineDash(h),s.lineDashOffset=u),s.lineCap=d,s.miterLimit=p}}setTextStyleWithoutAlignBaseline(t,e,i){let r=this.nativeContext;e||(e=this.textAttributes);let{scaleIn3d:n=e.scaleIn3d}=t;t.font?this.font=t.font:this.font=(0,l.U)(t,e,n&&this.camera&&this.camera.getProjectionScale(i));let{fontFamily:s=e.fontFamily,fontSize:a=e.fontSize}=t;this.fontFamily=s,this.fontSize=a,r.textAlign="left",r.textBaseline="alphabetic"}setTextStyle(t,e,i){var r,n;let s=this.nativeContext;e||(e=this.textAttributes),t.font?this.font=t.font:this.font=(0,l.U)(t,e,this.camera&&this.camera.getProjectionScale(i));let{fontFamily:a=e.fontFamily,fontSize:o=e.fontSize}=t;this.fontFamily=a,this.fontSize=o,s.textAlign=null!=(r=t.textAlign)?r:e.textAlign,s.textBaseline=null!=(n=t.textBaseline)?n:e.textBaseline}draw(){}clearMatrix(t=!0,e=this.dpr){this.setTransformFromMatrix(this._clearMatrix,t,e)}setClearMatrix(t,e,i,r,n,s){this._clearMatrix.setValue(t,e,i,r,n,s)}onlyTranslate(t=this.dpr){return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}release(...t){this.stack.forEach(t=>o.QE.free(t)),this.stack.length=0}};m.env="browser",m=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,p.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],m)},69646:function(t,e,i){"use strict";i.d(e,{l:()=>s});var r=i(99262),n=i(26514);function s(t,e){return new r.n(i=>{i(n.r).toDynamicValue(()=>e=>new t(e)).whenTargetNamed(t.env),i(n.A).toDynamicValue(()=>(t,i)=>new e(t,i)).whenTargetNamed(e.env)})}},59526:function(t,e,i){"use strict";i.d(e,{Ns:()=>k});var r,n=i(99262),s=i(71071),l=i(84527),a=i(16049),o=i(26004),h=i(2123);let u=class extends l.u{constructor(t){super(t)}init(t){let{container:e}=t;if("string"==typeof e){let t=a.w.global.getElementById(e);t&&(this._container=t)}else this._container=e;this._context=new h.s(this,this._dpr),this.initStyle()}initStyle(){if(!this.controled)return;let{nativeCanvas:t}=this;t.width=this._pixelWidth,t.height=this._pixelHeight,t.style&&this.setCanvasStyle(t,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(t),this.visiable||this.hide()}hide(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}show(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}applyPosition(){let t=this._nativeCanvas;t.style.position="absolute",t.style.top=`${this._y}px`,t.style.left=`${this._x}px`}resetStyle(t){if(!this.controled)return;let{width:e=this._displayWidth,height:i=this._displayHeight,dpr:r=this._dpr,x:n=this._x,y:s=this._y}=t,{nativeCanvas:l}=this;l.width=e*r,l.height=i*r,l.style&&this.setCanvasStyle(l,n,s,e,i),t.id&&(l.id=t.id),this.visiable||this.hide()}setCanvasStyle(t,e,i,r,n){this.controled&&(t.style.width=`${r}px`,t.style.height=`${n}px`)}toDataURL(t,e){return"image/jpeg"===t?this._nativeCanvas.toDataURL(t,e):"image/png"===t?this._nativeCanvas.toDataURL(t):this._nativeCanvas.toDataURL(t,e)}resize(t,e){this.controled&&(this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.style&&(this._nativeCanvas.style.width=`${t}px`,this._nativeCanvas.style.height=`${e}px`),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}};u.env="browser",u=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,o.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],u);let d=(0,i(69646).l)(u,h.s);var c=i(98456),p=i(84956),g=i(56488),f=i(76620),m=i(8992);let y=r=class extends p.X{get container(){return this.canvas.nativeCanvas.parentElement}static GenerateCanvasId(){return`${r.idprefix}_${r.prefix_count++}`}constructor(){super(),this.type="browser",this._canvasIsIntersecting=!0,this.global=a.w.global,this.viewBox=new f.FB,this.modelMatrix=new m.y(1,0,0,1,0,0)}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return this.canvas.nativeCanvas.getBoundingClientRect()}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t),this.postInit()}postInit(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch(t){console.error("发生错误，该环境不存在IntersectionObserver")}}isElementVisible(t){let e=t.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight;return!(e.right<0||e.bottom<0||e.left>i||e.top>r)}observerCanvas(){this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);let t=new IntersectionObserver((t,e)=>{t.forEach(t=>{this._canvasIsIntersecting!==t.isIntersecting?(this._canvasIsIntersecting=t.isIntersecting,this._onVisibleChangeCb&&this._onVisibleChangeCb(t.isIntersecting)):this._canvasIsIntersecting=t.isIntersecting})});t&&t.observe(this.canvas.nativeCanvas)}createWindowByConfig(t){let e,i=this.global.createCanvas({width:t.width,height:t.height});if(!(e="string"==typeof t.container?this.global.getElementById(t.container):t.container?t.container:this.global.getRootElement()))throw Error("发生错误，containerId可能传入有误");t.offscreen?e=null:e.appendChild(i);let n={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:i,container:e,id:r.GenerateCanvasId(),canvasControled:!0};this.canvas=new u(n)}createWindowByCanvas(t){var e;let i;if("string"==typeof t.canvas){if(!(i=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else i=t.canvas;if(!i)throw Error("发生错误，传入的canvas不正确");let r=t.width,n=t.height;if(null==r||null==n||!t.canvasControled){let t=i.getBoundingClientRect();r=t.width,n=t.height}let s=t.dpr;null==s&&(s=null!=(e=i.getContext("2d").pixelRatio)?e:i.width/r),this.canvas=new u({width:r,height:n,dpr:s,nativeCanvas:i,canvasControled:t.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e,i){return this.canvas.nativeCanvas.addEventListener(t,e,i)}removeEventListener(t,e,i){return this.canvas.nativeCanvas.removeEventListener(t,e,i)}dispatchEvent(t){return this.canvas.nativeCanvas.dispatchEvent(t)}getStyle(){var t;return null!=(t=this.canvas.nativeCanvas.style)?t:{}}setStyle(t){this.canvas.nativeCanvas.style=t}getBoundingClientRect(){let t=this.canvas.nativeCanvas,e=this.getWH();return t.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:e.width,height:e.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}isVisible(t){return this._canvasIsIntersecting}onVisibleChange(t){this._onVisibleChangeCb=t}getTopLeft(t){return this.global.getElementTopLeft(this.canvas.nativeCanvas,t)}};y.env="browser",y.idprefix="visactor_window",y.prefix_count=0,y=r=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,o.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],y);let v=new n.n(t=>{t(y).toSelf(),t(g.zd).toDynamicValue(t=>t.container.get(y)).whenTargetNamed(y.env)});var b=i(57565),_=i(40398),x=i(70501),C=i(30756);class w{get x1(){return this.dom.getBoundingClientRect().left}get x2(){return this.dom.getBoundingClientRect().right}get y1(){return this.dom.getBoundingClientRect().top}get y2(){return this.dom.getBoundingClientRect().bottom}get width(){return this.dom.getBoundingClientRect().width}get height(){return this.dom.getBoundingClientRect().height}constructor(t){this.dom=t}}function S(t,e=!1){let i=document.createElement("img");if(a.w.global.isImageAnonymous&&(i.crossOrigin="anonymous"),e){let e=new Blob([t],{type:"image/svg+xml"});t=window.URL.createObjectURL(e)}return(i.src=t,i.complete)?Promise.resolve(i):new Promise((t,e)=>{i.onload=()=>{t(i)},i.onerror=()=>{e(Error("加载失败"))}})}let A=class extends b.z{constructor(){super(),this.type="browser",this.supportEvent=!0;try{this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsTouchEvents=!1,this.supportsPointerEvents=!1,this.supportsPointerEvents=!1}this.applyStyles=!0}mapToCanvasPoint(t,e){var i,r;let n=0,s=0,l=0,a=0;if(t.changedTouches){let e=null!=(i=t.changedTouches[0])?i:{};n=e.clientX||0,s=e.clientY||0,l=n,a=s}else n=t.clientX||0,s=t.clientY||0,l=t.offsetX||0,a=t.offsetY||0;if(e){let t,i,l=n,a=s,o=e.getBoundingClientRect(),h=null==(r=e.getNativeHandler)?void 0:r.call(e).nativeCanvas;return h&&(t=o.width/h.offsetWidth,i=o.height/h.offsetHeight),{x:(l-o.left)/((0,x.Z)(t)?t:1),y:(a-o.top)/((0,x.Z)(i)?i:1)}}return{x:l,y:a}}getNativeAABBBounds(t){let e=t;return("string"==typeof t&&(e=(new DOMParser).parseFromString(t,"text/html").firstChild).lastChild&&(e=e.lastChild.firstChild),e.getBoundingClientRect)?new w(e.getBoundingClientRect()):new f.FB}removeDom(t){return t.parentElement.removeChild(t),!0}updateDom(t,e){let{width:i,height:r,style:n}=e;return n&&((0,C.Z)(n)?t.setAttribute("style",n):Object.keys(n).forEach(e=>{t.style[e]=n[e]})),null!=i&&(t.style.width=`${i}px`),null!=r&&(t.style.height=`${r}px`),!0}createDom(t){let{tagName:e="div",parent:i}=t,r=document.createElement(e);if(this.updateDom(r,t),i){let t=(0,C.Z)(i)?this.getElementById(i):i;t&&t.appendChild&&t.appendChild(r)}return r}loadImage(t){return S(t,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(t){return S(t,!0).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}createCanvas(t){var e,i;let r=document.createElement("canvas");t.id&&(r.id=null!=(e=t.id)?e:_.R.GenAutoIncrementId().toString());let n=null!=(i=t.dpr)?i:window.devicePixelRatio;return t.width&&t.height&&(r.style.width=`${t.width}px`,r.style.height=`${t.height}px`,r.width=t.width*n,r.height=t.height*n),r}createOffscreenCanvas(t){var e;let i=null!=(e=t.dpr)?e:window.devicePixelRatio;return new OffscreenCanvas(t.width*i,t.height*i)}releaseCanvas(t){let e;(e="string"==typeof t?document.getElementById(t):t)&&e.parentElement&&e.parentElement.removeChild(e)}getDevicePixelRatio(){return window.devicePixelRatio}getRequestAnimationFrame(){return window.requestAnimationFrame}getCancelAnimationFrame(){return window.cancelAnimationFrame}addEventListener(t,e,i){return document.addEventListener(t,e,i)}removeEventListener(t,e,i){return document.removeEventListener(t,e,i)}dispatchEvent(t){return document.dispatchEvent(t)}getElementById(t){return document.getElementById(t)}getRootElement(){return document.body}getDocument(){return document}release(...t){}getElementTop(t,e){let i=t.offsetTop,r=t.offsetParent;for(;null!==r;)i+=r.offsetTop,r=r.offsetParent;return i}getElementLeft(t,e){let i=t.offsetLeft,r=t.offsetParent;for(;null!==r;)i+=r.offsetLeft,r=r.offsetParent;return i}getElementTopLeft(t,e){let i=t.offsetTop,r=t.offsetLeft,n=t.offsetParent;for(;null!==n;)i+=n.offsetTop,r+=n.offsetLeft,n=n.offsetParent;return{top:i,left:r}}loadFont(t,e,i){var r,n,s,l;return r=this,n=void 0,s=void 0,l=function*(){return new FontFace(t,(0,C.Z)(e)?`url(${e})`:e,i).load().then(function(t){return document.fonts.add(t),{loadState:"success"}}).catch(function(t){return console.error("Failed to load font:",t),{loadState:"fail"}})},new(s||(s=Promise))(function(t,e){function i(t){try{o(l.next(t))}catch(t){e(t)}}function a(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof s?r:new s(function(t){t(r)})).then(i,a)}o((l=l.apply(r,n||[])).next())})}isMacOS(){if(void 0===this._isMacOS)try{this._isMacOS=navigator.platform.toUpperCase().indexOf("MAC")>=0}catch(t){this._isMacOS=!1}return this._isMacOS}copyToClipBoard(t){return navigator.clipboard.writeText(t).then(()=>{}).catch(t=>{})}};A=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,o.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],A);let M=new n.n(t=>{M.isBrowserBound||(M.isBrowserBound=!0,t(A).toSelf().inSingletonScope(),t(s.D0).toService(A))});function k(t,e=!0){k.__loaded||(k.__loaded=!0,t.load(M),t.load(d),t.load(v),e&&(0,c.q)(t))}M.isBrowserBound=!1,k.__loaded=!1},37438:function(t,e,i){"use strict";i.d(e,{sn:()=>S});var r,n=i(99262),s=i(71071),l=i(84527),a=i(26004),o=i(8992),h=i(2123);let u=class extends h.s{constructor(t,e){super(t,e);let i=t.nativeCanvas.getContext("2d");if(!i)throw Error("发生错误，获取2d上下文失败");this.nativeContext=i,this.canvas=t,this.matrix=new o.y(1,0,0,1,0,0),this.stack=[],this.dpr=null!=e?e:1}release(...t){}};u.env="node",u=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],u);var d=i(98116);let c=class extends l.u{constructor(t){super(t)}init(){this._context=new u(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}release(...t){this._nativeCanvas.release&&(0,d.Z)(this._nativeCanvas.release)&&this._nativeCanvas.release()}};c.env="node",c=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],c);let p=(0,i(69646).l)(c,u);var g=i(84956),f=i(40398),m=i(47061),y=i(56488);let v=class extends g.X{get container(){return null}constructor(t){super(),this.global=t,this.type="node"}getTitle(){return""}getWH(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:f.R.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new c(i)}createWindowByCanvas(t){var e;let i=t.canvas,r=null!=(e=t.dpr)?e:1,n=t.width,s=t.height;null!=n&&null!=s&&t.canvasControled||(n=i.width/r,s=i.height/r),this.canvas=new c({width:n,height:s,dpr:r,nativeCanvas:i,canvasControled:t.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}getImageBuffer(t="image/png"){return this.canvas.nativeCanvas.toBuffer(t)}addEventListener(t,e,i){}dispatchEvent(t){return!0}removeEventListener(t,e,i){}getStyle(){}setStyle(t){}getBoundingClientRect(){return null}clearViewBox(t){}};v.env="node",v=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)(),(r=(0,m.f)(s.y2),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],v);let b=new n.n(t=>{t(v).toSelf(),t(y.zd).toDynamicValue(t=>t.container.get(v)).whenTargetNamed(v.env)});var _=i(57565),x=i(70749);let C=class extends _.z{constructor(){super(...arguments),this.type="node",this._lastTime=0,this.supportEvent=!1}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),this.pkg=e)}getDynamicCanvasCount(){return 0}getStaticCanvasCount(){return 999}loadJson(t){let e=fetch(t).then(t=>t.json());return e.then(t=>({data:t,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(t){return fetch(t).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadImage(t){let{loadImage:e}=this.pkg;return e?e(t).then(t=>({loadState:t?"success":"fail",data:t})).catch(()=>({loadState:"fail",data:null})):Promise.reject(Error("node-canvas loadImage could not be found!"))}loadSvg(t){let e=this.pkg.Resvg;if(!e)return Promise.reject(Error("@resvg/resvg-js svgParser could not be found!"));let i=new e(t).render().asPng();return this.loadImage(i)}createCanvas(t){return this.pkg.createCanvas(t.width,t.height)}releaseCanvas(t){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return function(t){return x.dZ.call(t)}}getCancelAnimationFrame(){return t=>{x.dZ.clear(t)}}addEventListener(t,e,i){}removeEventListener(t,e,i){}getElementById(t){return null}getRootElement(){return null}dispatchEvent(t){}release(...t){}createOffscreenCanvas(t){}};C=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)()],C);let w=new n.n(t=>{w.isNodeBound||(w.isNodeBound=!0,t(C).toSelf().inSingletonScope(),t(s.D0).toService(C))});function S(t,e=!0){S.__loaded||(S.__loaded=!0,t.load(w),t.load(p),t.load(b))}w.isNodeBound=!1,S.__loaded=!1},56447:function(t,e,i){"use strict";i.d(e,{o:()=>d});var r=i(61963),n=i(16049),s=i(12895),l=i(21883),a=i.n(l);let o=(t,e)=>{let i=e.x-t.x,r=e.y-t.y;return Math.abs(i)>Math.abs(r)?i>0?"right":"left":r>0?"down":"up"},h=(t,e)=>{let i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return Math.sqrt(i*i+r*r)},u=t=>{let e=t.length;if(1===e)return{x:Math.round(t[0].x),y:Math.round(t[0].y)};let i=0,r=0,n=0;for(;n<e;)i+=t[n].x,r+=t[n].y,n++;return{x:Math.round(i/e),y:Math.round(r/e)}};class d extends a(){constructor(t,e={}){var i,n,s,l,a,d,c,p,g,f;super(),this.cachedEvents=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this.lastTapTarget=null,this.onStart=t=>{this.startTime=r.m.now();let{cachedEvents:e,startPoints:i}=this;t&&e.push(t.clone()),i.length=e.length;for(let t=0;t<e.length;t++){let{x:r,y:n}=e[t],s={x:r,y:n};i[t]=s}if(1!==i.length)this.startDistance=h(i[0],i[1]),this.center=u([i[0],i[1]]);else{let t=e[0];this.pressTimeout=setTimeout(()=>{t.direction="none",t.deltaX=0,t.deltaY=0,t.points=i,this.triggerStartEvent("press",t),this.triggerEvent("press",t),this.eventType="press",this.direction="none",this.pressTimeout=null},this.config.press.time)}},this.onMove=t=>{this.clearPressTimeout();let{startPoints:e,cachedEvents:i}=this;if(!e.length)return;let n=t.clone(),{x:s,y:l,pointerId:a}=n;for(let t=0,e=i.length;t<e;t++)if(a===i[t].pointerId){i[t]=n;break}let u={x:s,y:l},d=i.map(t=>({x:t.x,y:t.y})),c=r.m.now();if(this.prevMoveTime=this.lastMoveTime,this.prevMovePoint=this.lastMovePoint,this.lastMoveTime=c,this.lastMovePoint=u,1===e.length){let t=e[0],i=s-t.x,r=l-t.y,a=this.direction||o(t,u);this.direction=a;let h=this.getEventType(u);return n.direction=a,n.deltaX=i,n.deltaY=r,n.points=d,this.triggerStartEvent(h,n),void this.triggerEvent(h,n)}let{startDistance:p}=this;n.scale=h(d[0],d[1])/p,n.center=this.center,n.points=d,this.triggerStartEvent("pinch",n),this.triggerEvent("pinch",n)},this.onEnd=t=>{let e=t.clone(),{cachedEvents:i,startPoints:n}=this;if(e.points=i.map(t=>({x:t.x,y:t.y})),this.triggerEndEvent(e),1===i.length){let i=r.m.now(),s=this.lastMoveTime;if(i-s<100){let t=s-(this.prevMoveTime||this.startTime);if(t>0){let i=this.prevMovePoint||n[0],r=this.lastMovePoint||n[0],s=h(i,r),l=s/t;if(l>this.config.swipe.velocity&&s>this.config.swipe.threshold)return e.velocity=l,e.direction=o(i,r),this.triggerEvent("swipe",e),this.cachedEvents=[],this.startPoints=[],void this.reset()}}i-this.startTime<this.config.press.time&&(i-this.lastTapTime<this.config.tap.interval&&t.target===this.lastTapTarget?this.tapCount++:this.tapCount=1,this.lastTapTime=i,this.lastTapTarget=t.target,1===this.tapCount?this.triggerEvent("tap",e):2===this.tapCount&&(this.triggerEvent("doubletap",e),this.tapCount=0))}for(let t=0,r=i.length;t<r;t++)if(i[t].pointerId===e.pointerId){i.splice(t,1),n.splice(t,1);break}this.reset(),i.length>0&&this.onStart()},this.element=t,this.tapCount=0,this.lastTapTime=0,this.config={press:{time:null!=(n=null==(i=null==e?void 0:e.press)?void 0:i.time)?n:251,threshold:null!=(l=null==(s=null==e?void 0:e.press)?void 0:s.threshold)?l:9},swipe:{threshold:null!=(d=null==(a=null==e?void 0:e.swipe)?void 0:a.threshold)?d:10,velocity:null!=(p=null==(c=null==e?void 0:e.swipe)?void 0:c.velocity)?p:.3},tap:{interval:null!=(f=null==(g=null==e?void 0:e.tap)?void 0:g.interval)?f:300}},this.initEvents()}initEvents(){let{element:t}=this;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerleave",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}removeEvents(){let{element:t}=this;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerleave",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}release(){this.removeEvents(),this.element=null}getEventType(t){let e,{eventType:i,startTime:n,startPoints:s}=this;return"press"===i?i:(e=r.m.now()-n>this.config.press.time&&h(s[0],t)<this.config.press.threshold?"press":"pan",this.eventType=e,e)}enable(t){this.processEvent[t]=!0}isProcess(t){return this.processEvent[t]}pushEvent(t,e){let{emitThrottles:i}=this,r={type:t,ev:e};for(let e=0,n=i.length;e<n;e++)if(i[e].type===t)return void i.splice(e,1,r);i.push(r)}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}reset(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}triggerEvent(t,e){this.pushEvent(t,e);let{throttleTimer:i,emitThrottles:r}=this;i||(this.throttleTimer=n.w.global.getRequestAnimationFrame()(()=>{n.w.global.getCancelAnimationFrame()(this.throttleTimer),this.throttleTimer=null;for(let t=0,e=r.length;t<e;t++){let{type:e,ev:i}=r[t];this.emitEvent(e,i)}this.emitThrottles.length=0}))}triggerStartEvent(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent(`${t}start`,e))}triggerEndEvent(t){let e=this.processEvent;Object.keys(e).forEach(i=>{this.triggerEvent(`${i}end`,t),"press"===i&&this.triggerEvent(`${i}up`,t),delete e[i]})}emitEvent(t,e){if(!this.element)return;let i=this.element._events[s.g];if(i)if("fn"in i)i.fn.call(i.context,e,t);else for(let r=0,n=i.length;r<n&&!e.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,e,t);this.emit(t,e)}}},21093:function(t,e,i){"use strict";i.d(e,{EG:()=>d,Jj:()=>m,NP:()=>s,Nv:()=>n,VA:()=>c,bZ:()=>g,p8:()=>f,qP:()=>o,q_:()=>l,rE:()=>h,rV:()=>u,sg:()=>p,uU:()=>a});var r=i(45011);let n={onPointerDown:"pointerdown",onPointerUp:"pointerup",onPointerUpOutside:"pointerupoutside",onPointerTap:"pointertap",onPointerOver:"pointerover",onPointerMove:"pointermove",onPointerEnter:"pointerenter",onPointerLeave:"pointerleave",onPointerOut:"pointerout",onMouseDown:"mousedown",onMouseUp:"mouseup",onMouseUpOutside:"mouseupoutside",onMouseMove:"mousemove",onMouseOver:"mouseover",onMouseOut:"mouseout",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onPinch:"pinch",onPinchStart:"pinchstart",onPinchEnd:"pinchend",onPan:"pan",onPanStart:"panstart",onPanEnd:"panend",onDrag:"drag",onDragStart:"dragstart",onDragEnter:"dragenter",onDragLeave:"dragleave",onDragOver:"dragover",onDragEnd:"dragend",onRightDown:"rightdown",onRightUp:"rightup",onRightUpOutside:"rightupoutside",onTouchStart:"touchstart",onTouchEnd:"touchend",onTouchEndOutside:"touchendoutside",onTouchMove:"touchmove",onTouchCancel:"touchcancel",onPress:"press",onPressUp:"pressup",onPressEnd:"pressend",onSwipe:"swipe",onDrop:"drop",onWeel:"wheel",onClick:"click",onDblClick:"dblclick"};function s(t){return r.i.arc(t?t.attribute:{})}function l(t){return r.i.area(t?t.attribute:{})}function a(t){return r.i.circle(t?t.attribute:{})}function o(t){return r.i.group(t?t.attribute:{})}function h(t){return r.i.glyph(t?t.attribute:{})}function u(t){return r.i.image(t?t.attribute:{})}function d(t){return r.i.line(t?t.attribute:{})}function c(t){return r.i.path(t?t.attribute:{})}function p(t){return r.i.polygon(t?t.attribute:{})}function g(t){return r.i.rect(t?t.attribute:{})}function f(t){return r.i.symbol(t?t.attribute:{})}function m(t){return r.i.text(t?t.attribute:{})}function y(t){return r.i.richtext(t?t.attribute:{})}Object.keys(n),y.Text=function(t){return Object.assign({type:"rich/text"},t)},y.Image=function(t){return Object.assign({type:"rich/image"},t)}},98456:function(t,e,i){"use strict";i.d(e,{q:()=>b});var r=i(99262),n=i(58365),s=i(9941),l=i(26050),a=i(26004),o=i(47061),h=i(58233),u=i(6146),d=i(28856),c=i(47012),p=function(t,e){return function(i,r){e(i,r,t)}};let g=class extends s.f{constructor(t,e,i,r){super(i,r),this.contributions=t,this.drawContribution=e,this.pickItemInterceptorContributions=i,this.pickServiceInterceptorContributions=r,this.global.hooks.onSetEnv.tap("canvas-picker-service",(t,e,i)=>{this.configure(i,e)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(t=>{this.pickerMap.set(t.numberType,t)}),super._init()}configure(t,e){this.pickCanvas=l.A.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}pickItem(t,e,i,r){if(!1===t.attribute.pickable)return null;if(this.InterceptorContributions.length)for(let n=0;n<this.InterceptorContributions.length;n++){let s=this.InterceptorContributions[n];if(s.beforePickItem){let n=s.beforePickItem(t,this,e,r,{parentMatrix:i});if(n)return n}}let n=this.pickerMap.get(t.numberType);if(!n)return null;let s=n.contains(t,e,r),l=s?t:null,a={graphic:l,params:s};if(l)return a;if(this.InterceptorContributions.length)for(let n=0;n<this.InterceptorContributions.length;n++){let s=this.InterceptorContributions[n];if(s.afterPickItem){let n=s.afterPickItem(t,this,e,r,{parentMatrix:i});if(n)return n}}return a}};g=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)(),p(0,(0,o.f)(h.Qc)),p(0,(0,u.t)(c.EL)),p(1,(0,o.f)(d.Iv)),p(2,(0,o.f)(h.Qc)),p(2,(0,u.t)(n.uH)),p(3,(0,o.f)(h.Qc)),p(3,(0,u.t)(n.tn)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object,Object,Object])],g);var f=i(79314);let m=class{constructor(){this.type="group",this.numberType=f.I_}contains(t,e,i){return!1}};m=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)()],m);let y=new r.n((t,e,i,r)=>{y.__vloaded||(y.__vloaded=!0,t(c.pE).to(m).inSingletonScope(),t(c.EL).toService(c.pE),(0,h.yb)(t,c.EL))});y.__vloaded=!1;let v=new r.n((t,e,i,r)=>{i(g)||t(g).toSelf().inSingletonScope(),i(n.hH)?r(n.hH).toService(g):t(n.hH).toService(g)});function b(t){t.load(y),t.load(v)}},86380:function(t,e,i){"use strict";i.d(e,{D:()=>s});var r=i(34688),n=i(60504);class s extends r.Y{contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let s=t.getGraphicTheme();r.highPerformanceSave();let{x:l,y:a,z:o,lastModelMatrix:h}=this.transform(t,s,r),u=e;if(r.camera){u=e.clone();let i=t.parent.globalTransMatrix;u.x=i.a*e.x+i.c*e.y+i.e,u.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let d=!1;return this.canvasRenderer.drawShape(t,r,l,a,i,null,(t,e,i)=>!!d||(d=t.isPointInPath(u.x,u.y))),this.canvasRenderer.z=0,r.modelMatrix!==h&&n.yp.free(r.modelMatrix),r.modelMatrix=h,r.highPerformanceRestore(),d}}},34833:function(t,e,i){"use strict";i.d(e,{Q:()=>l});var r=i(34688),n=i(21823),s=i(60504);class l extends r.Y{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;r.highPerformanceSave();let l=t.getGraphicTheme(),{x:a,y:o,z:h,lastModelMatrix:u}=this.transform(t,l,r),d=e;if(r.camera){d=e.clone();let i=t.parent.globalTransMatrix;d.x=i.a*e.x+i.c*e.y+i.e,d.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=h;let c=!1;return this.canvasRenderer.drawShape(t,r,a,o,{},null,t=>!!c||(c=t.isPointInPath(d.x,d.y)),(t,e,i)=>{if(c)return!0;let s=e.lineWidth||i.lineWidth,l=e.pickStrokeBuffer||i.pickStrokeBuffer;return r.lineWidth=e.keepStrokeScale||i.keepStrokeScale?s+l:(0,n.D)(r,s+l,r.dpr),c=t.isPointInStroke(d.x,d.y)}),this.canvasRenderer.z=0,r.modelMatrix!==u&&s.yp.free(r.modelMatrix),r.modelMatrix=u,r.highPerformanceRestore(),c}}},60766:function(t,e,i){"use strict";i.d(e,{o:()=>n});var r=i(21823);class n{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode||!this.canvasRenderer)return!0;let{pickContext:n}=null!=i?i:{};if(!n)return!1;let s=t.getGraphicTheme();n.highPerformanceSave();let{x:l=s.x,y:a=s.y}=t.attribute;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(s);l+=e.x,a+=e.y,n.setTransformForCurrent()}else l=0,a=0,n.transformFromMatrix(t.transMatrix,!0);let o=!1,h=!1;return this.canvasRenderer.drawShape(t,n,l,a,{},null,(t,i,r,n)=>!(!o&&!h)||(o=t.isPointInPath(e.x,e.y),h=n||h,o),(t,i,s,l)=>{if(o||h)return!0;let a=i.lineWidth||s.lineWidth,u=i.pickStrokeBuffer||s.pickStrokeBuffer;return n.lineWidth=i.keepStrokeScale||s.keepStrokeScale?a+u:(0,r.D)(n,a+u,n.dpr),o=t.isPointInStroke(e.x,e.y),h=l||h,o}),n.highPerformanceRestore(),o}}},39284:function(t,e,i){"use strict";i.d(e,{b:()=>h});var r=i(76620),n=i(45273),s=i(31535),l=i(79314),a=i(21823);let o=new r.FB;class h{constructor(){this.type="rect",this.numberType=l._u}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let l=t.getGraphicTheme(),{cornerRadius:h=l.cornerRadius}=t.attribute,{x:u=l.x,y:d=l.y}=t.attribute;r.highPerformanceSave();let c=!0;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(l);u+=e.x,d+=e.y,r.setTransformForCurrent()}else u=0,d=0,c=!1,r.transformFromMatrix(t.transMatrix,!0);let p=!0;if(!c||t.shadowRoot||(0,n.Z)(h,!0)&&0!==h||(0,s.Z)(h)&&h.some(t=>0!==t))p=!1,this.canvasRenderer.drawShape(t,r,u,d,{},null,(t,i,r)=>!!p||(p=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(p)return!0;let s=i.lineWidth||n.lineWidth,l=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=i.keepStrokeScale||n.keepStrokeScale?s+l:(0,a.D)(r,s+l,r.dpr),p=t.isPointInStroke(e.x,e.y)});else{let{fill:i=l.fill,stroke:r=l.stroke,lineWidth:n=l.lineWidth}=t.attribute;if(i)p=!0;else if(r){let i=t.AABBBounds;o.setValue(i.x1,i.y1,i.x2,i.y2),o.expand(-n/2),p=!o.containsPoint(e)}}return r.highPerformanceRestore(),p}}},47012:function(t,e,i){"use strict";i.d(e,{$Y:()=>s,CV:()=>m,EL:()=>T,ES:()=>b,Ex:()=>h,RC:()=>C,Rz:()=>v,Se:()=>M,Sp:()=>w,TF:()=>x,Uv:()=>g,XN:()=>r,Yr:()=>d,ZY:()=>A,cs:()=>a,e_:()=>f,g2:()=>o,ks:()=>_,nb:()=>u,p1:()=>c,pE:()=>k,t3:()=>n,uV:()=>p,ww:()=>S,xp:()=>l,zT:()=>y});let r=Symbol.for("MathPickerContribution"),n=Symbol.for("MathArcPicker"),s=Symbol.for("MathAreaPicker"),l=Symbol.for("MathCirclePicker"),a=Symbol.for("MathImagePicker"),o=Symbol.for("MathLinePicker"),h=Symbol.for("MathPathPicker"),u=Symbol.for("MathRectPicker"),d=Symbol.for("MathSymbolPicker"),c=Symbol.for("MathTextPicker"),p=Symbol.for("MathPolygonPicker"),g=Symbol.for("MathGlyphPicker"),f=Symbol.for("CanvasArcPicker");Symbol.for("CanvasArc3dPicker");let m=Symbol.for("CanvasAreaPicker"),y=Symbol.for("CanvasCirclePicker"),v=Symbol.for("CanvasImagePicker");Symbol.for("CanvasGifImagePicker");let b=Symbol.for("CanvasLinePicker");Symbol.for("CanvasLottiePicker");let _=Symbol.for("CanvasPathPicker"),x=Symbol.for("CanvasRectPicker");Symbol.for("CanvasRect3dPicker");let C=Symbol.for("CanvasSymbolPicker"),w=Symbol.for("CanvasTextPicker"),S=Symbol.for("CanvasPolygonPicker");Symbol.for("CanvasPyramid3dPicker");let A=Symbol.for("CanvasRichTextPicker"),M=Symbol.for("CanvasGlyphPicker"),k=Symbol.for("CanvasGroupPicker");Symbol.for("CanvasStarPicker");let T=Symbol.for("CanvasPickerContribution")},2567:function(t,e,i){"use strict";i.d(e,{E:()=>p});var r,n=i(99262),s=i(79314),l=i(26004),a=i(47061),o=i(28856),h=i(60766);let u=class extends h.o{constructor(t){super(),this.canvasRenderer=t,this.type="arc",this.numberType=s.r_}};u=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,l.b)(),(r=(0,a.f)(o.Xe),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],u);var d=i(47012);let c=!1,p=new n.n((t,e,i,r)=>{c||(c=!0,t(d.t3).to(u).inSingletonScope(),t(d.XN).toService(d.t3))})},75315:function(t,e,i){"use strict";i.d(e,{P:()=>p});var r,n=i(99262),s=i(47012),l=i(79314),a=i(26004),o=i(47061),h=i(28856),u=i(60766);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="circle",this.numberType=l.Aw}};d=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)(),(r=(0,o.f)(h.aP),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new n.n((t,e,i,r)=>{c||(c=!0,t(s.xp).to(d).inSingletonScope(),t(s.XN).toService(s.xp))})},73797:function(t,e,i){"use strict";i.d(e,{x:()=>a});var r=i(99262),n=i(47012),s=i(42425);let l=!1,a=new r.n((t,e,i,r)=>{l||(l=!0,t(n.cs).to(s.Z).inSingletonScope(),t(s.Z).toService(n.cs))})},42425:function(t,e,i){"use strict";i.d(e,{Z:()=>s});var r=i(79314),n=i(26004);let s=class{constructor(){this.type="image",this.numberType=r.PN}contains(t,e,i){let{pickContext:r}=null!=i?i:{};return!!r&&!!t.AABBBounds.containsPoint(e)}};s=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,n.b)()],s)},86971:function(t,e,i){"use strict";i.d(e,{c:()=>p});var r,n=i(99262),s=i(47012),l=i(79314),a=i(26004),o=i(47061),h=i(28856),u=i(60766);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="line",this.numberType=l.Hf}};d=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)(),(r=(0,o.f)(h.O),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new n.n((t,e,i,r)=>{c||(c=!0,t(s.g2).to(d).inSingletonScope(),t(s.XN).toService(s.g2))})},63869:function(t,e,i){"use strict";i.d(e,{t:()=>p});var r,n=i(99262),s=i(47012),l=i(79314),a=i(26004),o=i(47061),h=i(28856),u=i(60766);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="path",this.numberType=l.qm}};d=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)(),(r=(0,o.f)(h.lG),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new n.n((t,e,i,r)=>{c||(c=!0,t(s.Ex).to(d).inSingletonScope(),t(s.XN).toService(s.Ex))})},55478:function(t,e,i){"use strict";i.d(e,{C:()=>p});var r,n=i(99262),s=i(47012),l=i(79314),a=i(26004),o=i(47061),h=i(28856),u=i(60766);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="polygon",this.numberType=l.Kh}};d=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)(),(r=(0,o.f)(h.ZT),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new n.n((t,e,i,r)=>{c||(c=!0,t(s.uV).to(d).inSingletonScope(),t(s.XN).toService(s.uV))})},18114:function(t,e,i){"use strict";i.d(e,{k:()=>c});var r,n=i(99262),s=i(47012),l=i(26004),a=i(47061),o=i(28856),h=i(39284);let u=class extends h.b{constructor(t){super(),this.canvasRenderer=t}};u=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,l.b)(),(r=(0,a.f)(o.Uj),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],u);let d=!1,c=new n.n((t,e,i,r)=>{d||(d=!0,t(s.nb).to(u).inSingletonScope(),t(s.XN).toService(s.nb))})},95197:function(t,e,i){"use strict";i.d(e,{D:()=>a});var r=i(99262),n=i(47012),s=i(42425);let l=!1,a=new r.n((t,e,i,r)=>{l||(l=!0,t(n.cs).to(s.Z).inSingletonScope(),t(s.Z).toService(n.cs))})},53279:function(t,e,i){"use strict";i.d(e,{n:()=>p});var r,n=i(99262),s=i(47012),l=i(79314),a=i(26004),o=i(47061),h=i(28856),u=i(60766);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="symbol",this.numberType=l.B5}};d=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,a.b)(),(r=(0,o.f)(h.tP),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new n.n((t,e,i,r)=>{c||(c=!0,t(s.Yr).to(d).inSingletonScope(),t(s.XN).toService(s.Yr))})},59087:function(t,e,i){"use strict";i.d(e,{T:()=>h});var r=i(99262),n=i(47012),s=i(79314),l=i(26004);let a=class{constructor(){this.type="text",this.numberType=s.Us}contains(t,e,i){return!!t.AABBBounds.containsPoint(e)}};a=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,l.b)()],a);let o=!1,h=new r.n((t,e,i,r)=>{o||(o=!0,t(n.p1).to(a).inSingletonScope(),t(n.XN).toService(n.p1))})},73636:function(t,e,i){"use strict";i.d(e,{X:()=>r});let r=(0,i(27865).kP)()},16483:function(t,e,i){"use strict";i.d(e,{x:()=>N});var r,n=i(41035),s=i(45011),l=i(91018),a=i(58233),o=i(99262),h=i(88504),u=i(61868),d=i(26004),c=i(47061),p=i(6146),g=i(4062),f=i(70749),m=i(60543),y=i(20686),v=i(879),b=i(79314),_=i(34688),x=i(21823),C=i(56229),w=i(17209),S=i(82774);let A=new class{constructor(){this.time=w.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{innerPadding:y=o.innerPadding,outerPadding:v=o.outerPadding,startAngle:b=o.startAngle,endAngle:_=o.endAngle,opacity:C=o.opacity,x:w=o.x,y:S=o.y,scaleX:A=o.scaleX,scaleY:M=o.scaleY,keepStrokeScale:k=o.keepStrokeScale}=t.attribute,{innerRadius:T=o.innerRadius,outerRadius:R=o.outerRadius}=t.attribute;R+=v,T-=y;let B=(n,s)=>{let l=!(!n||!n.stroke),{distance:a=o[s].distance}=n,h=k?a:(0,x.D)(e,a,e.dpr),u=a/R,c="outerBorder"===s?1:-1;if(t.setAttributes({outerRadius:R+c*h,innerRadius:T-c*h,startAngle:b-c*u,endAngle:_+c*u}),e.beginPath(),(0,m.Eg)(t,e,i,r,R+c*h,T-c*h),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),d)d(e,n,o[s]);else if(l){let l=o[s].opacity;o[s].opacity=C,e.setStrokeStyle(t,n,(w-i)/A,(S-r)/M,o[s]),o[s].opacity=l,e.stroke()}};g&&B(c,"outerBorder"),f&&B(p,"innerBorder"),t.setAttributes({outerRadius:R,innerRadius:T,startAngle:b,endAngle:_})}},M=S.H,k=C.R6;var T=function(t,e){return function(i,r){e(i,r,t)}};let R=class extends _.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=b.r_,this.builtinContributions=[A,k,M],this.init(t)}drawArcTailCapPath(t,e,i,r,n,s,l,a){let o=a-l,u=t.getParsedAngle(),d=u.startAngle,c=u.endAngle;c=a,(0,h.Wn)(c-d);let p=c>d,g=!1;if(n<s){let t=n;n=s,s=t}let{outerDeltaAngle:f,xors:y,yors:v,xirs:b,yirs:_,limitedOcr:x,outerCornerRadiusStart:C,outerCornerRadiusEnd:w,maxOuterCornerRadius:S,xore:A,yore:M,xire:k,yire:T,limitedIcr:R,innerDeltaAngle:B,innerStartAngle:P,innerCornerRadiusStart:E,innerCornerRadiusEnd:I,maxInnerCornerRadius:L}=(0,m.ZN)(t,d,c,s,n);if(x>h.Ho){let t=(0,h.VV)(C,x),s=(0,h.VV)(w,x),l=(0,m.gI)(b,_,y,v,n,t,Number(p)),a=(0,m.gI)(A,M,k,T,n,s,Number(p));if(x<S&&t===s)e.moveTo(i+l.cx+l.x01,r+l.cy+l.y01),e.arc(i+l.cx,r+l.cy,x,(0,h.fv)(l.y01,l.x01),(0,h.fv)(a.y01,a.x01),!p);else{let t=c-o-.03,l=(0,h.fv)(a.y11,a.x11);e.arc(i,r,n,t,l,!p),s>0&&e.arc(i+a.cx,r+a.cy,s,(0,h.fv)(a.y11,a.x11),(0,h.fv)(a.y01,a.x01),!p)}}else e.moveTo(i+y,r+v);if(!(s>h.Ho)||B<.001)e.lineTo(i+k,r+T),g=!0;else if(R>h.Ho){let t=(0,h.VV)(E,R),n=(0,h.VV)(I,R),l=(0,m.gI)(k,T,A,M,s,-n,Number(p)),a=(0,m.gI)(y,v,b,_,s,-t,Number(p));if(e.lineTo(i+l.cx+l.x01,r+l.cy+l.y01),R<L&&t===n){let t=(0,h.fv)(a.y01,a.x01);e.arc(i+l.cx,r+l.cy,R,(0,h.fv)(l.y01,l.x01),t,!p)}else{n>0&&e.arc(i+l.cx,r+l.cy,n,(0,h.fv)(l.y01,l.x01),(0,h.fv)(l.y11,l.x11),!p);let t=(0,h.fv)(l.cy+l.y11,l.cx+l.x11),a=c-o-.03;e.arc(i,r,s,t,a,p)}}else e.lineTo(i+s*(0,h.mC)(P),r+s*(0,h.O$)(P));return g}drawShape(t,e,i,r,n,s,l,a,o){o=null!=o?o:(0,g.gh)(t,null==s?void 0:s.theme).arc;let{fill:d=o.fill,stroke:c=o.stroke,x:p=o.x,y:v=o.y,fillStrokeOrder:b=o.fillStrokeOrder}=t.attribute,_=this.valid(t,o,l,a);if(!_)return;let{fVisible:x,sVisible:C,doFill:w,doStroke:S}=_,{outerPadding:A=o.outerPadding,innerPadding:M=o.innerPadding,cap:k=o.cap,forceShowCap:T=o.forceShowCap}=t.attribute,{outerRadius:R=o.outerRadius,innerRadius:B=o.innerRadius}=t.attribute;R+=A,B-=M;let P=0,E=((0,u.Z)(k)&&k||k[0])&&"conical"===d.gradient;if(E){let{sc:e,startAngle:i,endAngle:r}=t.getParsedAngle();(0,h.Wn)(r-i)<h.f7-h.Ho&&(P=e||0,d.startAngle-=P,d.endAngle-=P)}let I=!1,{isFullStroke:L,stroke:F}=(0,f.Dn)(c);if((w||L)&&(e.beginPath(),(0,m.Eg)(t,e,i,r,R,B),I=!0,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,w,S,x,C,o,n,l,a),b?(this._runStroke(t,e,i,r,o,S,L,C,a),this._runFill(t,e,i,r,o,w,x,p,v,l)):(this._runFill(t,e,i,r,o,w,x,p,v,l),this._runStroke(t,e,i,r,o,S,L,C,a))),!L&&S&&(e.beginPath(),(0,m.Eg)(t,e,i,r,R,B,F),I||this.beforeRenderStep(t,e,i,r,w,S,x,C,o,n,l,a),a?a(e,t.attribute,o):C&&(e.setStrokeStyle(t,t.attribute,i,r,o),e.stroke())),((0,u.Z)(k)&&k||k[1])&&T){let{startAngle:s,endAngle:u}=t.getParsedAngle();if((0,h.Wn)(u-s)>=h.f7-h.Ho){e.beginPath();let s=Math.abs(R-B)/2/R,{endAngle:h=o.endAngle,fill:u=o.fill}=t.attribute;this.drawArcTailCapPath(t,e,i,r,R,B,h,h+s),I||this.beforeRenderStep(t,e,i,r,w,S,x,C,o,n,l,a),(()=>{if(w&&"conical"===u.gradient){let n=(0,y.MB)(0,0,h,u);l||m.Bv&&(e.setCommonStyle(t,t.attribute,i,r,o),e.fillStyle=n,e.fill())}})(),S&&(a||C&&(e.setStrokeStyle(t,t.attribute,i,r,o),e.stroke()))}}this.afterRenderStep(t,e,i,r,w,S,x,C,o,n,l,a),E&&(d.startAngle+=P,d.endAngle+=P)}_runFill(t,e,i,r,n,s,l,a,o,h){s&&(h?h(e,t.attribute,n):l&&(e.setCommonStyle(t,t.attribute,a-i,o-r,n),e.fill()))}_runStroke(t,e,i,r,n,s,l,a,o){s&&l&&(o?o(e,t.attribute,n):a&&(e.setStrokeStyle(t,t.attribute,i,r,n),e.stroke()))}draw(t,e,i,r){let n=(0,g.gh)(t,null==r?void 0:r.theme).arc;this._draw(t,n,!1,i,r,n)}};R=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,d.b)(),T(0,(0,c.f)(a.Qc)),T(0,(0,p.t)(v.OL)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],R);var B=i(28856);let P=!1,E=new o.n(t=>{P||(P=!0,t(R).toSelf().inSingletonScope(),t(B.Xe).to(R).inSingletonScope(),t(B.uz).toService(B.Xe),t(v.OL).toService(C.Sg),(0,a.yb)(t,v.OL))});var I=i(73636),L=i(60766);let F=class extends L.o{constructor(t){super(),this.canvasRenderer=t,this.type="arc",this.numberType=b.r_}};F=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,d.b)(),(r=(0,c.f)(B.Xe),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],F);var O=i(47012);let D=!1,H=new o.n((t,e,i,r)=>{D||(D=!0,t(O.e_).to(F).inSingletonScope(),t(O.EL).toService(O.e_))});var z=i(2567);function W(){W.__loaded||(W.__loaded=!0,s.i.RegisterGraphicCreator("arc",n.Q),l.n.load(E),l.n.load(I.X?H:z.E))}W.__loaded=!1;let N=W},51619:function(t,e,i){"use strict";i.d(e,{f:()=>O});var r,n=i(11089),s=i(45011),l=i(91018),a=i(58233),o=i(99262),h=i(26004),u=i(47061),d=i(6146),c=i(4062),p=i(79314),g=i(879),f=i(34688),m=i(21823),y=i(56229),v=i(17209),b=i(82774);let _=new class{constructor(){this.time=v.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{radius:y=o.radius,startAngle:v=o.startAngle,endAngle:b=o.endAngle,opacity:_=o.opacity,x:x=o.x,y:C=o.y,scaleX:w=o.scaleX,scaleY:S=o.scaleY,keepStrokeScale:A=o.keepStrokeScale}=t.attribute,M=(n,s)=>{let l=!(!n||!n.stroke),{distance:a=o[s].distance}=n,h=A?a:(0,m.D)(e,a,e.dpr);if(e.beginPath(),e.arc(i,r,y+("outerBorder"===s?1:-1)*h,v,b),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),d)d(e,n,o[s]);else if(l){let l=o[s].opacity;o[s].opacity=_,e.setStrokeStyle(t,n,(x-i)/w,(C-r)/S,o[s]),o[s].opacity=l,e.stroke()}};g&&M(c,"outerBorder"),f&&M(p,"innerBorder")}},x=b.H,C=y.R6;var w=function(t,e){return function(i,r){e(i,r,t)}};let S=class extends f.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=p.Aw,this.builtinContributions=[_,C,x],this.init(t)}drawShape(t,e,i,r,n,s,l,a){let o=(0,c.gh)(t,null==s?void 0:s.theme).circle,{radius:h=o.radius,startAngle:u=o.startAngle,endAngle:d=o.endAngle,x:p=o.x,y:g=o.y,fillStrokeOrder:f=o.fillStrokeOrder}=t.attribute,m=this.valid(t,o,l,a);if(!m)return;let{fVisible:y,sVisible:v,doFill:b,doStroke:_}=m;e.beginPath(),e.arc(i,r,h,u,d),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,b,_,y,v,o,n,l,a);let x=()=>{b&&(l?l(e,t.attribute,o):y&&(e.setCommonStyle(t,t.attribute,p-i,g-r,o),e.fill()))},C=()=>{_&&(a?a(e,t.attribute,o):v&&(e.setStrokeStyle(t,t.attribute,p-i,g-r,o),e.stroke()))};f?(C(),x()):(x(),C()),this.afterRenderStep(t,e,i,r,b,_,y,v,o,n,l,a)}draw(t,e,i,r){let n=(0,c.gh)(t,null==r?void 0:r.theme).circle;this._draw(t,n,!1,i,r)}};S=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,h.b)(),w(0,(0,u.f)(a.Qc)),w(0,(0,d.t)(g.Cs)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],S);var A=i(28856);let M=!1,k=new o.n(t=>{M||(M=!0,t(S).toSelf().inSingletonScope(),t(A.aP).to(S).inSingletonScope(),t(A.uz).toService(A.aP),t(g.Cs).toService(y.Sg),(0,a.yb)(t,g.Cs))});var T=i(73636),R=i(47012),B=i(60766);let P=class extends B.o{constructor(t){super(),this.canvasRenderer=t,this.type="circle",this.numberType=p.Aw}};P=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,h.b)(),(r=(0,u.f)(A.aP),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],P);let E=!1,I=new o.n((t,e,i,r)=>{E||(E=!0,t(R.zT).to(P).inSingletonScope(),t(R.EL).toService(R.zT))});var L=i(75315);function F(){F.__loaded||(F.__loaded=!0,s.i.RegisterGraphicCreator("circle",n.y),l.n.load(k),l.n.load(T.X?I:L.P))}F.__loaded=!1;let O=F},15589:function(t,e,i){"use strict";i.d(e,{M:()=>l});var r=i(75485),n=i(45011);function s(){s.__loaded||(s.__loaded=!0,n.i.RegisterGraphicCreator("group",r.sS))}s.__loaded=!1;let l=s},96628:function(t,e,i){"use strict";i.d(e,{i:()=>W});var r,n=i(77474),s=i(45011),l=i(91018),a=i(58233),o=i(99262),h=i(56229),u=i(879),d=i(26004),c=i(47061),p=i(6146),g=i(4062),f=i(79314),m=i(31535),y=i(30756),v=i(2844),b=i(34688),_=i(17209),x=i(58276);class C extends x.sH{constructor(){super(...arguments),this.time=_.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){return super.drawShape(t,e,i,r,n,s,l,a,o,h,u,d)}}let w=new C,S=h.R6;var A=i(20842),M=function(t,e){return function(i,r){e(i,r,t)}};let k=["","repeat-x","repeat-y","repeat"],T=class extends b.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=f.PN,this.builtinContributions=[w,S],this.init(t)}drawShape(t,e,i,r,n,s,l,a){let o=(0,g.gh)(t).image,{repeatX:h=o.repeatX,repeatY:u=o.repeatY,x:d=o.x,y:c=o.y,cornerRadius:p=o.cornerRadius,fillStrokeOrder:f=o.fillStrokeOrder,cornerType:y=o.cornerType,image:b}=t.attribute,_=this.valid(t,o,l);if(!_)return;let{fVisible:x,sVisible:C,doFill:w,doStroke:S}=_;if(!b||!t.resources)return;let A=t.resources.get(b);if("success"!==A.state)return;let M=t.width,T=t.height;e.beginPath();let R=!1;0===p||(0,m.Z)(p)&&p.every(t=>0===t)?e.rect(i,r,M,T):((0,v.U)(e,i,r,M,T,p,"bevel"!==y),R=!0),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o);let B=()=>{if(w){if(l)l(e,t.attribute,o);else if(x){e.setCommonStyle(t,t.attribute,i,r,o);let n=0;if("repeat"===h&&(n|=1),"repeat"===u&&(n|=2),n){let t=e.createPattern(A.data,k[n]);e.fillStyle=t,e.translate(i,r,!0),e.fillRect(0,0,M,T),e.translate(-i,-r,!0)}else e.drawImage(A.data,i,r,M,T)}}},P=()=>{S&&(a?a(e,t.attribute,o):C&&(e.setStrokeStyle(t,t.attribute,d-i,c-r,o),e.stroke()))};f?(P(),R&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,r,w,!1,x,!1,o,n,l),B(),R&&e.restore()):(R&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,r,w,!1,x,!1,o,n,l),B(),R&&e.restore(),P()),this.afterRenderStep(t,e,i,r,w,!1,x,!1,o,n,l)}draw(t,e,i){let{image:r}=t.attribute;if(!r||!t.resources)return;let n=t.resources.get(r);if("loading"===n.state&&(0,y.Z)(r))return void A.h.improveImageLoading(r);if("success"!==n.state)return;let{context:s}=e.drawParams;if(!s)return;let l=(0,g.gh)(t).image;this._draw(t,l,!1,i)}};T=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,d.b)(),M(0,(0,c.f)(a.Qc)),M(0,(0,p.t)(u.JO)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],T);var R=i(28856);let B=!1,P=new o.n(t=>{B||(B=!0,t(R.e0).to(T).inSingletonScope(),t(R.uz).toService(R.e0),t(u.JO).toService(h.Sg),(0,a.yb)(t,u.JO))});var E=i(73636),I=i(47012),L=i(60766);let F=class extends L.o{constructor(t){super(),this.canvasRenderer=t,this.type="image",this.numberType=f.PN}};F=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,d.b)(),(r=(0,c.f)(R.e0),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],F);let O=!1,D=new o.n((t,e,i,r)=>{O||(O=!0,t(I.Rz).to(F).inSingletonScope(),t(I.EL).toService(I.Rz))});var H=i(73797);function z(){z.__loaded||(z.__loaded=!0,s.i.RegisterGraphicCreator("image",n.B),l.n.load(P),l.n.load(E.X?D:H.x))}z.__loaded=!1;let W=z},79134:function(t,e,i){"use strict";i.d(e,{N:()=>S});var r,n=i(32463),s=i(45011),l=i(91018),a=i(99262),o=i(36063),h=i(46553),u=i(28856);let d=!1,c=new a.n(t=>{d||(d=!0,t(h.X).toSelf().inSingletonScope(),t(o.U).toSelf().inSingletonScope(),t(u.O).to(h.X).inSingletonScope(),t(u.uz).toService(u.O))});var p=i(73636),g=i(47012),f=i(79314),m=i(26004),y=i(47061),v=i(34833);let b=class extends v.Q{constructor(t){super(),this.canvasRenderer=t,this.type="line",this.numberType=f.Hf}};b=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,m.b)(),(r=(0,y.f)(u.O),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],b);let _=!1,x=new a.n((t,e,i,r)=>{_||(_=!0,t(g.ES).to(b).inSingletonScope(),t(g.EL).toService(g.ES))});var C=i(86971);function w(){w.__loaded||(w.__loaded=!0,s.i.RegisterGraphicCreator("line",n.W),l.n.load(c),l.n.load(p.X?x:C.c))}w.__loaded=!1;let S=w},9994:function(t,e,i){"use strict";i.d(e,{N:()=>I});var r,n=i(20033),s=i(45011),l=i(91018),a=i(58233),o=i(99262),h=i(56229),u=i(879),d=i(26004),c=i(47061),p=i(6146),g=i(23603),f=i(4062),m=i(79314),y=i(34688);let v=i(82774).H,b=h.R6;var _=function(t,e){return function(i,r){e(i,r,t)}};let x=class extends y.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=m.qm,this.builtinContributions=[b,v],this.init(t)}drawShape(t,e,i,r,n,s,l,a){var o,h,u;let d=null!=(o=this.tempTheme)?o:(0,f.gh)(t,null==s?void 0:s.theme).path,{x:c=d.x,y:p=d.y,fillStrokeOrder:m=d.fillStrokeOrder}=t.attribute,y=null!=(h=this.z)?h:0,v=this.valid(t,d,l,a);if(!v)return;let{fVisible:b,sVisible:_,doFill:x,doStroke:C}=v;if(e.beginPath(),t.pathShape)(0,g.h)(t.pathShape.commandList,e,i,r,1,1,y);else{let n=null!=(u=t.attribute.path)?u:d.path;(0,g.h)(n.commandList,e,i,r,1,1,y)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,r,x,C,b,_,d,n,l,a);let w=()=>{C&&(a?a(e,t.attribute,d):_&&(e.setStrokeStyle(t,t.attribute,c-i,p-r,d),e.stroke()))},S=()=>{x&&(l?l(e,t.attribute,d):b&&(e.setCommonStyle(t,t.attribute,c-i,p-r,d),e.fill()))};m?(w(),S()):(S(),w()),this.afterRenderStep(t,e,i,r,x,C,b,_,d,n,l,a)}draw(t,e,i,r){let n=(0,f.gh)(t,null==r?void 0:r.theme).path;this.tempTheme=n,this._draw(t,n,!1,i,r),this.tempTheme=null}};x=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,d.b)(),_(0,(0,c.f)(a.Qc)),_(0,(0,p.t)(u.Mj)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],x);var C=i(28856);let w=!1,S=new o.n(t=>{w||(w=!0,t(x).toSelf().inSingletonScope(),t(C.lG).to(x).inSingletonScope(),t(C.uz).toService(C.lG),t(u.Mj).toService(h.Sg),(0,a.yb)(t,u.Mj))});var A=i(73636),M=i(47012),k=i(34833);let T=class extends k.Q{constructor(t){super(),this.canvasRenderer=t,this.type="path",this.numberType=m.qm}};T=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,d.b)(),(r=(0,c.f)(C.lG),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],T);let R=!1,B=new o.n((t,e,i,r)=>{R||(R=!0,t(M.ks).to(T).inSingletonScope(),t(M.EL).toService(M.ks))});var P=i(63869);function E(){E.__loaded||(E.__loaded=!0,s.i.RegisterGraphicCreator("path",n.E),l.n.load(S),l.n.load(A.X?B:P.t))}E.__loaded=!1;let I=E},34807:function(t,e,i){"use strict";i.d(e,{M:()=>O});var r,n=i(26854),s=i(45011),l=i(91018),a=i(58233),o=i(99262),h=i(56229),u=i(879),d=i(31535),c=i(26004),p=i(47061),g=i(6146),f=i(4062),m=i(79314);function y(t,e,i,r){if(e&&e.length){t.moveTo(e[0].x+i,e[0].y+r);for(let n=1;n<e.length;n++)t.lineTo(e[n].x+i,e[n].y+r)}}function v(t,e){return Math.sqrt(t*t+e*e)}function b(t,e,i,r,n){let s=e/i;return{x:t.x-r*s,y:t.y-n*s}}var _=i(34688);let x=i(82774).H,C=h.R6;var w=function(t,e){return function(i,r){e(i,r,t)}};let S=class extends _.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=m.Kh,this.builtinContributions=[C,x],this.init(t)}drawShape(t,e,i,r,n,s,l,a){let o=(0,f.gh)(t,null==s?void 0:s.theme).polygon,{points:h=o.points,cornerRadius:u=o.cornerRadius,x:c=o.x,y:p=o.y,closePath:g=o.closePath,fillStrokeOrder:m=o.fillStrokeOrder}=t.attribute,_=this.valid(t,o,l,a);if(!_)return;let{fVisible:x,sVisible:C,doFill:w,doStroke:S}=_;e.beginPath(),u<=0||(0,d.Z)(u)&&u.every(t=>0===t)?y(e.camera?e:e.nativeContext,h,i,r):function(t,e,i,r,n,s=!0){var l;if(e.length<3)return y(t,e,i,r);let a=0,o=e.length-1;s||(a+=1,o-=1,t.moveTo(e[0].x+i,e[0].y+r));for(let s=a;s<=o;s++){let a=e[0===s?o:(s-1)%e.length],h=e[s%e.length],u=e[(s+1)%e.length],d=h.x-a.x,c=h.y-a.y,p=h.x-u.x,g=h.y-u.y,f=Math.abs(Math.tan((Math.atan2(c,d)-Math.atan2(g,p))/2)),m=Array.isArray(n)?null!=(l=n[s%e.length])?l:0:n,y=m/f,_=v(d,c),x=v(p,g),C=Math.min(_,x);y>C&&(y=C,m=C*f);let w=b(h,y,_,d,c),S=b(h,y,x,p,g),A=2*h.x-w.x-S.x,M=2*h.y-w.y-S.y,k=v(A,M),T=b(h,v(y,m),k,A,M),R=Math.atan2(w.y-T.y,w.x-T.x),B=Math.atan2(S.y-T.y,S.x-T.x),P=B-R;P<0&&(R=B,P=-P),P>Math.PI&&(P-=Math.PI),0===s?t.moveTo(w.x+i,w.y+r):t.lineTo(w.x+i,w.y+r),P&&t.arcTo(h.x+i,h.y+r,S.x+i,S.y+r,m),t.lineTo(S.x+i,S.y+r)}s||t.lineTo(e[o+1].x+i,e[o+1].y+r)}(e.camera?e:e.nativeContext,h,i,r,u,g),g&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,w,S,x,C,o,n,l,a);let A=()=>{w&&(l?l(e,t.attribute,o):x&&(e.setCommonStyle(t,t.attribute,c-i,p-r,o),e.fill()))},M=()=>{S&&(a?a(e,t.attribute,o):C&&(e.setStrokeStyle(t,t.attribute,c-i,p-r,o),e.stroke()))};m?(M(),A()):(A(),M()),this.afterRenderStep(t,e,i,r,w,S,x,C,o,n,l,a)}draw(t,e,i,r){let n=(0,f.gh)(t,null==r?void 0:r.theme).polygon;this._draw(t,n,!1,i,r)}};S=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,c.b)(),w(0,(0,p.f)(a.Qc)),w(0,(0,g.t)(u.U7)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],S);var A=i(28856);let M=!1,k=new o.n(t=>{M||(M=!0,t(A.ZT).to(S).inSingletonScope(),t(A.uz).toService(A.ZT),t(u.U7).toService(h.Sg),(0,a.yb)(t,u.U7))});var T=i(73636),R=i(47012),B=i(60766);let P=class extends B.o{constructor(t){super(),this.canvasRenderer=t,this.type="polygon",this.numberType=m.Kh}};P=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,c.b)(),(r=(0,p.f)(A.ZT),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],P);let E=!1,I=new o.n((t,e,i,r)=>{E||(E=!0,t(R.ww).to(P).inSingletonScope(),t(R.EL).toService(R.ww))});var L=i(55478);function F(){F.__loaded||(F.__loaded=!0,s.i.RegisterGraphicCreator("polygon",n.p),l.n.load(k),l.n.load(T.X?I:L.C))}F.__loaded=!1;let O=F},86972:function(t,e,i){"use strict";i.d(e,{k:()=>L});var r,n=i(35953),s=i(45011),l=i(91018),a=i(58233),o=i(99262),h=i(58276),u=i(56229),d=i(879),c=i(31535),p=i(26004),g=i(47061),f=i(6146),m=i(4062),y=i(79314),v=i(2844),b=i(60543),_=i(34688),x=function(t,e){return function(i,r){e(i,r,t)}};let C=class extends _.Y{constructor(t){super(),this.graphicRenderContributions=t,this.type="rect",this.numberType=y._u,this.builtinContributions=[h.NB,h.gq,h.k7],this.init(t)}drawShape(t,e,i,r,n,s,l,a,o){o=null!=o?o:(0,m.gh)(t,null==s?void 0:s.theme).rect;let{fill:h=o.fill,background:u,stroke:d=o.stroke,cornerRadius:p=o.cornerRadius,cornerType:g=o.cornerType,opacity:f=o.opacity,fillOpacity:y=o.fillOpacity,lineWidth:_=o.lineWidth,strokeOpacity:x=o.strokeOpacity,visible:C=o.visible,x1:w,y1:S,x:A=o.x,y:M=o.y,fillStrokeOrder:k=o.fillStrokeOrder,drawStrokeWhenZeroWH:T=o.drawStrokeWhenZeroWH}=t.attribute,{width:R,height:B}=t.attribute;R=(null!=R?R:w-A)||0,B=(null!=B?B:S-M)||0;let P=(0,b.GT)(f,y,R,B,h),E=(0,b.Ze)(f,x,R,B,T),I=(0,b.dz)(h,u),L=(0,b.ak)(d,_);if(!t.valid||!C||!I&&!L||!(P||E||l||a||u))return;0===p||(0,c.Z)(p)&&p.every(t=>0===t)?(e.beginPath(),e.rect(i,r,R,B)):(e.beginPath(),(0,v.U)(e,i,r,R,B,p,"bevel"!==g));let F={doFill:I,doStroke:L};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,I,L,P,E,o,n,l,a,F),k?(this._runStroke(t,e,i,r,o,F,E,A,M,a),this._runFill(t,e,i,r,o,F,P,A,M,l)):(this._runFill(t,e,i,r,o,F,P,A,M,l),this._runStroke(t,e,i,r,o,F,E,A,M,a)),this.afterRenderStep(t,e,i,r,I,L,P,E,o,n,l,a)}_runFill(t,e,i,r,n,s,l,a,o,h){s.doFill&&(h?h(e,t.attribute,n):l&&(e.setCommonStyle(t,t.attribute,a-i,o-r,n),e.fill()))}_runStroke(t,e,i,r,n,s,l,a,o,h){s.doStroke&&(h?h(e,t.attribute,n):l&&(e.setStrokeStyle(t,t.attribute,a-i,o-r,n),e.stroke()))}draw(t,e,i,r){let n=(0,m.gh)(t,null==r?void 0:r.theme).rect;this._draw(t,n,!1,i,r,n)}};C=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,p.b)(),x(0,(0,g.f)(a.Qc)),x(0,(0,f.t)(d.d5)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],C);var w=i(28856);let S=!1,A=new o.n(t=>{S||(S=!0,t(C).toSelf().inSingletonScope(),t(w.Uj).to(C).inSingletonScope(),t(w.uz).toService(w.Uj),t(h.Er).toSelf(),t(h.d4).toSelf(),t(d.d5).toService(h.Er),t(d.d5).toService(h.d4),t(d.d5).toService(u.Sg),(0,a.yb)(t,d.d5))});var M=i(73636),k=i(47012),T=i(39284);let R=class extends T.b{constructor(t){super(),this.canvasRenderer=t}};R=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,p.b)(),(r=(0,g.f)(w.Uj),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],R);let B=!1,P=new o.n((t,e,i,r)=>{B||(B=!0,t(k.TF).to(R).inSingletonScope(),t(k.EL).toService(k.TF))});var E=i(18114);function I(){I.__loaded||(I.__loaded=!0,s.i.RegisterGraphicCreator("rect",n.f),l.n.load(A),l.n.load(M.X?P:E.k))}I.__loaded=!1;let L=I},840:function(t,e,i){"use strict";i.d(e,{v:()=>k});var r,n=i(29559),s=i(45011),l=i(91018),a=i(99262),o=i(26004),h=i(2844),u=i(4062),d=i(79314),c=i(60543),p=i(34688),g=i(66069);let f=class extends p.Y{constructor(){super(),this.numberType=d.$M,this.builtinContributions=[g.C],this.init()}drawShape(t,e,i,r,n){let s=(0,u.gh)(t).richtext,{strokeOpacity:l=s.strokeOpacity,opacity:a=s.opacity,fillOpacity:o=s.fillOpacity,visible:h=s.visible}=t.attribute;if(!t.valid||!h)return;let d=(0,c.Bv)(a,o,!0),p=(0,c.Bv)(a,l,!0);d&&(e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,s),e.translate(i,r),this.beforeRenderStep(t,e,i,r,d,p,d,p,s,n),t.getFrameCache().draw(e,this.drawIcon),this.afterRenderStep(t,e,i,r,d,p,d,p,s,n))}drawIcon(t,e,i,r,n){var s;let l=(0,u.gh)(t).richtextIcon,{width:a=l.width,height:o=l.height,opacity:d=l.opacity,image:c,backgroundFill:p=l.backgroundFill,backgroundFillOpacity:g=l.backgroundFillOpacity,backgroundStroke:f=l.backgroundStroke,backgroundStrokeOpacity:m=l.backgroundStrokeOpacity,backgroundRadius:y=l.backgroundRadius,margin:v}=t.attribute,{backgroundWidth:b=a,backgroundHeight:_=o}=t.attribute;if(v&&(i+=t._marginArray[3],r+=t._marginArray[0]),t._hovered){let t=(b-a)/2,n=(_-o)/2;0===y?(e.beginPath(),e.rect(i-t,r-n,b,_)):(e.beginPath(),(0,h.U)(e,i-t,r-n,b,_,y,!0)),p&&(e.globalAlpha=g,e.fillStyle=p,e.fill()),f&&(e.globalAlpha=m,e.strokeStyle=f,e.stroke())}let x=c&&(null==(s=null==t?void 0:t.resources)?void 0:s.get(c));x&&"success"===x.state&&(e.globalAlpha=d,e.drawImage(x.data,i,r,a,o))}draw(t,e,i){let r=(0,u.gh)(t).richtext;this._draw(t,r,!1,i)}};f=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,o.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],f);var m=i(28856);let y=!1,v=new a.n(t=>{y||(y=!0,t(m.fS).to(f).inSingletonScope(),t(m.uz).toService(m.fS))});var b=i(73636),_=i(47012),x=i(47061);let C=class{constructor(t){this.canvasRenderer=t,this.type="richtext",this.numberType=d.$M}contains(t,e,i){return!!t.AABBBounds.containsPoint(e)}};C=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,o.b)(),(r=(0,x.f)(m.fS),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],C);let w=!1,S=new a.n((t,e,i,r)=>{w||(w=!0,t(_.ZY).to(C).inSingletonScope(),t(_.EL).toService(_.ZY))});var A=i(95197);function M(){M.__loaded||(M.__loaded=!0,s.i.RegisterGraphicCreator("richtext",n.p),l.n.load(v),l.n.load(b.X?S:A.D))}M.__loaded=!1;let k=M},96531:function(t,e,i){"use strict";i.d(e,{W:()=>o});var r=i(75485);class n extends r.ZA{constructor(t){super({x:0,y:0}),this.type="shadowroot",this.shadowHost=t}clearUpdateBoundTag(){super.clearUpdateBoundTag(),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}addUpdateBoundTag(){super.addUpdateBoundTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}addUpdateShapeAndBoundsTag(){super.addUpdateShapeAndBoundsTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){let e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}doUpdateGlobalMatrix(){if(this.shadowHost){let t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}tryUpdateGlobalAABBBounds(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}function s(t){return new n(t)}var l=i(45011);function a(){a.__loaded||(a.__loaded=!0,l.i.RegisterGraphicCreator("shadowRoot",s))}a.__loaded=!1;let o=a},95694:function(t,e,i){"use strict";i.d(e,{k:()=>z});var r,n=i(8042),s=i(45011),l=i(91018),a=i(58233),o=i(99262),h=i(56229),u=i(879),d=i(28856),c=i(26004),p=i(47061),g=i(6146),f=i(4062),m=i(79314),y=i(34688),v=i(31535),b=i(21823),_=i(17209),x=i(82774);let C=new class{constructor(){this.time=_.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){let c=t.getParsedPath();if(!c)return;let{outerBorder:p,innerBorder:g}=t.attribute,f=p&&!1!==p.visible,m=g&&!1!==g.visible;if(!f&&!m)return;let{size:y=o.size,opacity:v=o.opacity,x:_=o.x,y:x=o.y,scaleX:C=o.scaleX,scaleY:w=o.scaleY,keepStrokeScale:S=o.keepStrokeScale}=t.attribute,A=(n,s)=>{let l=!(!n||!n.stroke),{distance:a=o[s].distance}=n,h=S?a:(0,b.D)(e,a,e.dpr);if(e.beginPath(),!1===c.drawOffset(e,y,i,r,("outerBorder"===s?1:-1)*h)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),d)d(e,n,o[s]);else if(l){let l=o[s].opacity;o[s].opacity=v,e.setStrokeStyle(t,n,(_-i)/C,(x-r)/w,o[s]),o[s].opacity=l,e.stroke()}};f&&A(p,"outerBorder"),m&&A(g,"innerBorder")}},w=new class{constructor(){this.time=_.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{clipRange:p=o.clipRange,x:g=o.x,y:f=o.y,z:m=o.z,size:y=o.size,scaleX:v=o.scaleX,scaleY:b=o.scaleY}=t.attribute,_=t.getParsedPath();_&&p<1&&p>0&&(e.beginPath(),_.drawWithClipRange&&_.drawWithClipRange(e,y,i,r,p,m,(n,s)=>{var l,h,u,c;if(t._parsedPath.svgCache){let e=Object.assign({},s);e.fill=null!=(l=s.fill)?l:t.attribute.fill,e.opacity=null!=(h=s.opacity)?h:t.attribute.opacity,e.fillOpacity=t.attribute.fillOpacity,e.stroke=null!=(u=s.stroke)?u:t.attribute.stroke,e.lineWidth=null!=(c=s.lineWidth)?c:t.attribute.lineWidth,s=e}s.stroke&&(d?d(e,t.attribute,o):a&&(e.setStrokeStyle(t,s,(g-i)/v,(f-r)/b,o),e.stroke()))}),s&&!_.isSvg&&(d?d(e,t.attribute,o):a&&(e.setStrokeStyle(t,t.attribute,(g-i)/v,(f-r)/b,o),e.stroke())))}},S=x.H,A=h.R6;var M=function(t,e){return function(i,r){e(i,r,t)}};let k=class extends y.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=m.B5,this.builtinContributions=[C,A,S,w],this.init(t)}drawShape(t,e,i,r,n,s,l,a,o){var h;o=null!=o?o:(0,f.gh)(t,null==s?void 0:s.theme).symbol;let{size:u=o.size,x:d=o.x,y:c=o.y,scaleX:p=o.scaleX,scaleY:g=o.scaleY,fillStrokeOrder:m=o.fillStrokeOrder,clipRange:y=o.clipRange}=t.attribute,b=this.valid(t,o,l,a);if(!b)return;let{fVisible:_,sVisible:x,doFill:C,doStroke:w}=b,S=t.getParsedPath();if(!S)return;let{keepDirIn3d:A=o.keepDirIn3d}=t.attribute,M=null!=(h=this.z)?h:0;e.beginPath();let k=i,T=r,R=M,B=e.camera;if(A&&B&&e.project){let t=e.project(i,r,M);e.camera=null,(0,v.Z)(u)&&(u[0],u[1]),k=t.x,T=t.y,R=void 0}!1===S.draw(e,u,k,T,R,(n,s)=>{var h,u,f,v;if(t._parsedPath.svgCache){let e=Object.assign({},s);e.fill=null!=(h=s.fill)?h:t.attribute.fill,e.opacity=null!=(u=s.opacity)?u:t.attribute.opacity,e.fillOpacity=t.attribute.fillOpacity,e.stroke=null!=(f=s.stroke)?f:t.attribute.stroke,e.lineWidth=null!=(v=s.lineWidth)?v:t.attribute.lineWidth,s=e}let b=()=>{s.fill&&(l?l(e,t.attribute,o):(e.setCommonStyle(t,s,d-i,c-r,o),e.fill()))},_=()=>{s.stroke&&(a?a(e,t.attribute,o):x&&y>=1&&(e.setStrokeStyle(t,s,(d-i)/p,(c-r)/g,o),e.stroke()))};m?(_(),b()):(b(),_())})&&e.closePath(),e.camera=B,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,C,w,_,x,o,n,l,a),m?(this._runStroke(t,e,i,r,o,w,x,d,c,S,y,p,g,a),this._runFill(t,e,i,r,o,C,_,d,c,S,l)):(this._runFill(t,e,i,r,o,C,_,d,c,S,l),this._runStroke(t,e,i,r,o,w,x,d,c,S,y,p,g,a)),this.afterRenderStep(t,e,i,r,C,w,_,x,o,n,l,a)}_runFill(t,e,i,r,n,s,l,a,o,h,u){s&&!h.isSvg&&(u?u(e,t.attribute,n):l&&(e.setCommonStyle(t,t.attribute,a-i,o-r,n),e.fill()))}_runStroke(t,e,i,r,n,s,l,a,o,h,u,d,c,p){s&&!h.isSvg&&(p?p(e,t.attribute,n):l&&u>=1&&(e.setStrokeStyle(t,t.attribute,(a-i)/d,(o-r)/c,n),e.stroke()))}draw(t,e,i,r){let n=(0,f.gh)(t,null==r?void 0:r.theme).symbol;this._draw(t,n,!1,i,r)}};k=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,c.b)(),M(0,(0,p.f)(a.Qc)),M(0,(0,g.t)(u.X3)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],k);let T=!1,R=new o.n(t=>{T||(T=!0,t(k).toSelf().inSingletonScope(),t(d.tP).to(k).inSingletonScope(),t(d.uz).toService(d.tP),t(u.X3).toService(h.Sg),(0,a.yb)(t,u.X3))});var B=i(73636),P=i(47012),E=i(60504),I=i(86380);let L=class extends I.D{constructor(t){super(),this.canvasRenderer=t,this.type="symbol",this.numberType=m.B5}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.getParsedPath();if(!r.camera){if(!t.AABBBounds.containsPoint(e))return!1;if(n.isSvg||"imprecise"===t.attribute.pickMode)return!0}r.highPerformanceSave();let s=t.getGraphicTheme(),{x:l,y:a,z:o,lastModelMatrix:h}=this.transform(t,s,r),u=e;if(r.camera){u=e.clone();let i=t.parent.globalTransMatrix;u.x=i.a*e.x+i.c*e.y+i.e,u.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let d=!1;return this.canvasRenderer.drawShape(t,r,l,a,{},null,(t,e,i)=>!!d||(d=t.isPointInPath(u.x,u.y)),(t,e,i)=>{if(d)return!0;let n=e.lineWidth||i.lineWidth,s=e.pickStrokeBuffer||i.pickStrokeBuffer;return r.lineWidth=e.keepStrokeScale||i.keepStrokeScale?n+s:(0,b.D)(r,n+s,r.dpr),d=t.isPointInStroke(u.x,u.y)}),this.canvasRenderer.z=0,r.modelMatrix!==h&&E.yp.free(r.modelMatrix),r.modelMatrix=h,r.highPerformanceRestore(),d}};L=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,c.b)(),(r=(0,p.f)(d.tP),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],L);let F=!1,O=new o.n((t,e,i,r)=>{F||(F=!0,t(P.RC).to(L).inSingletonScope(),t(P.EL).toService(P.RC))});var D=i(53279);function H(){H.__loaded||(H.__loaded=!0,s.i.RegisterGraphicCreator("symbol",n.t),l.n.load(R),l.n.load(B.X?O:D.n))}H.__loaded=!1;let z=H},69877:function(t,e,i){"use strict";i.d(e,{g:()=>O});var r,n=i(64103),s=i(45011),l=i(91018),a=i(58233),o=i(99262),h=i(56229),u=i(879),d=i(28856),c=i(26004),p=i(47061),g=i(6146),f=i(4062),m=i(79314),y=i(38939),v=i(34688),b=i(60504),_=i(88504),x=i(35652),C=i(70749),w=i(66069),S=function(t,e){return function(i,r){e(i,r,t)}};let A=class extends v.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=m.Us,this.builtinContributions=[w.C],this.init(t)}drawShape(t,e,i,r,n,s,l,a){var o,h,u;let d=(0,f.gh)(t,null==s?void 0:s.theme).text,{text:c,underline:p=d.underline,lineThrough:g=d.lineThrough,keepDirIn3d:m=d.keepDirIn3d,direction:y=d.direction,fontSize:v=d.fontSize,verticalMode:x=d.verticalMode,x:w=d.x,y:S=d.y}=t.attribute,A=null!=(o=(0,C.VA)(t.attribute.lineHeight,v))?o:v,M=this.valid(t,d,l,a);if(!M)return;let{fVisible:k,sVisible:T,doFill:R,doStroke:B}=M,P=!m,E=this.z||0;e.beginPath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,r,R,B,k,T,d,n,l,a),P&&this.transformUseContext2d(t,d,E,e);let I=(n,s,o,h)=>{let u=i+s,c=r+o;if(h){e.highPerformanceSave(),u+=v;let t=b.QE.allocate(1,0,0,1,0,0);t.rotateByCenter(Math.PI/2,u,c),e.transformFromMatrix(t,!0),b.QE.free(t)}B&&(a?a(e,t.attribute,d):T&&(e.setStrokeStyle(t,t.attribute,w-i,S-r,d),e.strokeText(n,u,c,E))),R&&(l?l(e,t.attribute,d):k&&(e.setCommonStyle(t,t.attribute,w-i,S-r,d),e.fillText(n,u,c,E))),h&&(e.highPerformanceRestore(),e.setTransformForCurrent())};if(e.setTextStyleWithoutAlignBaseline(t.attribute,d,E),"horizontal"===y){let{multilineLayout:n}=t;if(!n)return void e.highPerformanceRestore();let{xOffset:s,yOffset:o}=n.bbox;B&&(a?a(e,t.attribute,d):T&&(e.setStrokeStyle(t,t.attribute,w-i,S-r,d),n.lines.forEach(t=>{e.strokeText(t.str,(t.leftOffset||0)+s+i,(t.topOffset||0)+o+r,E)}))),R&&(l?l(e,t.attribute,d):k&&(e.setCommonStyle(t,t.attribute,w-i,S-r,d),n.lines.forEach(n=>{e.fillText(n.str,(n.leftOffset||0)+s+i,(n.topOffset||0)+o+r,E),this.drawUnderLine(p,g,t,(n.leftOffset||0)+s+i,(n.topOffset||0)+o+r,n.descent,(n.descent-n.ascent)/2,E,d,e,{width:n.width})})))}else{let{textAlign:i=d.textAlign,textBaseline:r=d.textBaseline}=t.attribute;if(!x){let e=i;i=null!=(h=t.getBaselineMapAlign()[r])?h:"left",r=null!=(u=t.getAlignMapBaseline()[e])?u:"top"}t.tryUpdateAABBBounds();let{verticalList:n}=t.cache;e.textAlign="left",e.textBaseline="top";let s=A*n.length,l=0;n.forEach(t=>{let e=t.reduce((t,e)=>t+(e.width||0),0);l=(0,_.Fp)(e,l)});let a=0,o=0;"bottom"===r?o=-s:"middle"===r&&(o=-s/2),"center"===i?a-=l/2:"right"===i&&(a-=l),n.forEach((t,e)=>{let r=t.reduce((t,e)=>t+(e.width||0),0),n=l-r,h=a;"center"===i?h+=n/2:"right"===i&&(h+=n),t.forEach(t=>{let{text:i,width:r,direction:n}=t;I(i,s-(e+1)*A+o,h,n),h+=r})})}P&&this.restoreTransformUseContext2d(t,d,E,e),this.afterRenderStep(t,e,i,r,R,B,k,T,d,n,l,a)}draw(t,e,i,r){let n=(0,f.gh)(t,null==r?void 0:r.theme).text,{keepDirIn3d:s=n.keepDirIn3d}=t.attribute;this._draw(t,n,!s,i,r)}drawUnderLine(t,e,i,r,n,s,l,a,o,h,u){if(e+t<=0)return;let{textAlign:d=o.textAlign,fill:c=o.fill,opacity:p=o.opacity,underlineOffset:g=o.underlineOffset,underlineDash:f=o.underlineDash,fillOpacity:m=o.fillOpacity}=i.attribute,v=!(0,x.Z)(u),b=v?u.width:i.clipedWidth,_=v?0:(0,y.js)(d,b),C={lineWidth:0,stroke:c,opacity:p,strokeOpacity:m};if(t){C.lineWidth=t,h.setStrokeStyle(i,C,r,n,o),f&&h.setLineDash(f),h.beginPath();let e=n+s+g;h.moveTo(r+_,e,a),h.lineTo(r+_+b,e,a),h.stroke()}if(e){C.lineWidth=e,h.setStrokeStyle(i,C,r,n,o),h.beginPath();let t=n+l;h.moveTo(r+_,t,a),h.lineTo(r+_+b,t,a),h.stroke()}}};A=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,c.b)(),S(0,(0,p.f)(a.Qc)),S(0,(0,g.t)(u.$K)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],A);let M=!1,k=new o.n(t=>{M||(M=!0,t(d.EY).to(A).inSingletonScope(),t(d.uz).toService(d.EY),t(u.$K).toService(h.Sg),(0,a.yb)(t,u.$K))});var T=i(73636),R=i(47012),B=i(86380);let P=class extends B.D{constructor(t){super(),this.canvasRenderer=t,this.type="text",this.numberType=m.Us}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.AABBBounds;if(!r.camera)return!!n.containsPoint(e);r.highPerformanceSave();let s=t.getGraphicTheme(),{keepDirIn3d:l=s.keepDirIn3d}=t.attribute,{x:a,y:o,z:h,lastModelMatrix:u}=this.transform(t,s,r,!l);this.canvasRenderer.z=h;let d=e;if(r.camera){d=e.clone();let i=t.parent.globalTransMatrix;d.x=i.a*e.x+i.c*e.y+i.e,d.y=i.b*e.x+i.d*e.y+i.f}let c=!1;return this.canvasRenderer.drawShape(t,r,a,o,{},null,(e,i,r)=>{if(c)return!0;let{fontSize:n=s.fontSize,textBaseline:l=s.textBaseline,textAlign:u=s.textAlign}=t.attribute,p=t.AABBBounds,g=p.height(),f=p.width(),m=(0,y.nV)(l,g,n),v=(0,y.js)(u,f);return e.rect(v+a,m+o,f,g,h),c=e.isPointInPath(d.x,d.y)},(t,e,i)=>c),this.canvasRenderer.z=0,r.modelMatrix!==u&&b.yp.free(r.modelMatrix),r.modelMatrix=u,r.highPerformanceRestore(),c}};P=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,c.b)(),(r=(0,p.f)(d.EY),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],P);let E=!1,I=new o.n((t,e,i,r)=>{E||(E=!0,t(R.Sp).to(P).inSingletonScope(),t(R.EL).toService(R.Sp))});var L=i(59087);function F(){F.__loaded||(F.__loaded=!0,s.i.RegisterGraphicCreator("text",n.r),l.n.load(k),l.n.load(T.X?I:L.T))}F.__loaded=!1;let O=F},44787:function(t,e,i){"use strict";i.d(e,{j:()=>m});var r=i(84148),n=i(6594);function s(t,e,i=1e-10,r=1e-10){let n=i*Math.max(t,e);return Math.abs(t-e)<=Math.max(r,n)}var l=i(53908),a=i(12709),o=i(84168),h=i(17283);let u=Symbol("implicit");class d extends h.s{specified(t){var e;return t?(this._specified=Object.assign(null!=(e=this._specified)?e:{},t),this):Object.assign({},this._specified)}_getSpecifiedValue(t){if(this._specified)return this._specified[t]}constructor(){super(),this.type=o._f.Ordinal,this._index=new Map,this._domain=[],this._ordinalRange=[],this._unknown=u}clone(){let t=(new d).domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}calculateVisibleDomain(t){return(0,r.Z)(this._rangeFactorStart)&&(0,r.Z)(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:this._domain}scale(t){let e=`${t}`,i=this._getSpecifiedValue(e);if(void 0!==i)return i;let r=this._index.get(e);if(!r){if(this._unknown!==u)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}let n=this._ordinalRange[(r-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(n):n}invert(t){let e=0;for(;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}domain(t){if(!t)return this._domain.slice();for(let e of(this._domain=[],this._index=new Map,t)){let t=`${e}`;this._index.has(t)||this._index.set(t,this._domain.push(e))}return this}range(t){if(!t)return this._ordinalRange.slice();let e=Array.from(t);return this._ordinalRange=e,this}index(t){var e;return this._index&&null!=(e=this._index.get(`${t}`))?e:-1}}var c=i(8273),p=i(34638);function g(t,e,i,r){let n=[],s=t;for(;s<=e;)n.push(s),s+=i;return r&&n.reverse(),n}function f(t,e,i,r){let n,s;if(e=Math.floor(+e),t=Math.floor(+t),!(i=Math.floor(+i)))return[];if(t===e)return[t];if(n=e<t){let i=t;t=e,e=i}let l=(0,p.i)(1,e-t+1)(i);if(s=Math.floor((e-t+1)/l),!r)for(;Math.ceil((e-t+1)/s)>i&&l>1;)l-=1,s=Math.floor((e-t)/l);return g(t,e,s,n)}class m extends d{constructor(t){super(),this.type=o._f.Band,this._range=[0,1],this._step=void 0,this._bandwidth=void 0,this._isFixed=!1,this._round=!1,this._paddingInner=0,this._paddingOuter=0,this._align=.5,this._unknown=void 0,delete this.unknown,this.rescale(t)}rescale(t,e){if(t)return this;this._wholeRange=null;let i=this._calculateWholeRange(this._range,e),r=super.domain().length,n=i[1]<i[0],s=i[Number(n)-0],l=i[1-Number(n)],a=(0,c.U6)(r,this._paddingInner,this._paddingOuter);return this._step=(l-s)/Math.max(1,a||1),this._round&&(this._step=Math.floor(this._step)),s+=(l-s-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(s=Math.round(s),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:n,start:n?s+this._step*(r-1):s,count:r},this.generateFishEyeTransform(),this}scale(t){if(!this._bandRangeState)return;let e=`${t}`,i=this._getSpecifiedValue(e);if(void 0!==i)return i;let r=this._index.get(e);if(!r){if(this._unknown!==u)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}let{count:n,start:s,reverse:l}=this._bandRangeState,a=s+(r-1)%n*(l?-1:1)*this._step;return this._fishEyeTransform?this._fishEyeTransform(a):a}_calculateWholeRange(t,e){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){let e;if((0,r.Z)(this._rangeFactorStart)&&(0,r.Z)(this._rangeFactorEnd)&&2===t.length){let i=(0,c.BK)(t,[this._rangeFactorStart,this._rangeFactorEnd]);e=Math.abs(i[1]-i[0])}else e=Math.abs(t[1]-t[0]);let i=(0,c.at)(super.domain().length,e,this._paddingInner,this._paddingOuter,this._round);i<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):i>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=i,this._isFixed=!1)}if(this.isBandwidthFixed()){let i=(0,c.$l)(super.domain().length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),n=Math.min((t[1]-t[0])/i,1);if((0,r.Z)(this._rangeFactorStart)&&(0,r.Z)(this._rangeFactorEnd)){if(i>0){let e=t[0]-i*this._rangeFactorStart;this._wholeRange=[e,e+i]}else{let e=t[1]+i*(1-this._rangeFactorEnd);this._wholeRange=[e-i,e]}let r=this._rangeFactorStart+n<=1,s=this._rangeFactorEnd-n>=0;"rangeFactorStart"===e&&r?this._rangeFactorEnd=this._rangeFactorStart+n:"rangeFactorEnd"===e&&s?this._rangeFactorStart=this._rangeFactorEnd-n:t[0]<=t[1]?r?this._rangeFactorEnd=this._rangeFactorStart+n:s?this._rangeFactorStart=this._rangeFactorEnd-n:(this._rangeFactorStart=0,this._rangeFactorEnd=n):s?this._rangeFactorStart=this._rangeFactorEnd-n:r?this._rangeFactorEnd=this._rangeFactorStart+n:(this._rangeFactorStart=1-n,this._rangeFactorEnd=1)}else this._rangeFactorStart=0,this._rangeFactorEnd=n,this._wholeRange=[t[0],t[0]+i];return this._wholeRange}return super._calculateWholeRange(t)}calculateWholeRangeSize(){let t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}calculateVisibleDomain(t){let e=this._domain;if((0,r.Z)(this._rangeFactorStart)&&(0,r.Z)(this._rangeFactorEnd)&&e.length){let i=this._getInvertIndex(t[0]),r=this._getInvertIndex(t[1]);return e.slice(Math.min(i,r),Math.max(i,r)+1)}return e}domain(t,e){return t?(super.domain(t),this.rescale(e)):super.domain()}range(t,e){return t?(this._range=[(0,n.H)(t[0]),(0,n.H)(t[1])],this.rescale(e)):this._range}rangeRound(t,e){return this._range=[(0,n.H)(t[0]),(0,n.H)(t[1])],this._round=!0,this.rescale(e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return -1===t?e:f(0,e.length-1,t,!1).map(t=>e[t])}tickData(t=10){return this.ticks(t).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0]+this._bandwidth/2)/(this._range[1]-this._range[0])}))}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return f(0,e.length-1,t,!0).filter(t=>t<e.length).map(t=>e[t])}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return(function(t,e,i){let r;if(e=Math.floor(+e),t=Math.floor(+t),i=(0,p.i)(1,e-t+1)(Math.floor(+i)),r=e<t){let i=t;t=e,e=i}return g(t,e,i,r)})(0,e.length-1,t).map(t=>e[t])}_getInvertIndex(t){let e=0,i=this.step()/2,r=this.bandwidth()/2,n=this._domain.length,l=this.range(),a=l[0]>l[l.length-1];for(e=0;e<n;e++){var o,h,u,d;let l=this.scale(this._domain[e])+r;if(0===e&&(!a&&!(t>(o=l+i)&&!s(t,o,void 0,void 0))||a&&!(t<(h=l-i)&&!s(t,h,void 0,void 0)))||e===n-1)break;if(!(t<(u=l-i)&&!s(t,u,void 0,void 0))&&!(t>(d=l+i)&&!s(t,d,void 0,void 0)))break}return e>=0&&e<=n-1?e:n-1}invert(t){return this._domain[this._getInvertIndex(t)]}padding(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}paddingInner(t,e){return void 0!==t?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}paddingOuter(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}step(){return this._step}round(t,e){return void 0!==t?(this._round=t,this.rescale(e)):this._round}align(t,e){return void 0!==t?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}rangeFactor(t,e){return t?(super.rangeFactor(t),this.rescale(e)):super.rangeFactor()}rangeFactorStart(t,e){return(0,l.Z)(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this.rescale(e,"rangeFactorStart"))}rangeFactorEnd(t,e){return(0,l.Z)(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this.rescale(e,"rangeFactorEnd"))}bandwidth(t,e){return t?("auto"===t?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}maxBandwidth(t,e){return t?(this._maxBandwidth="auto"===t?void 0:t,this.rescale(e)):this._maxBandwidth}minBandwidth(t,e){return t?(this._minBandwidth="auto"===t?void 0:t,this.rescale(e)):this._minBandwidth}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}isBandwidthFixed(){return this._isFixed&&!!this._bandwidth}_isBandwidthFixedByUser(){return this._isFixed&&this._userBandwidth&&(0,a.Z)(this._userBandwidth)}clone(){var t,e,i;return new m(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth(null!=(t=this._userBandwidth)?t:"auto",!0).maxBandwidth(null!=(e=this._maxBandwidth)?e:"auto",!0).minBandwidth(null!=(i=this._maxBandwidth)?i:"auto")}}},17283:function(t,e,i){"use strict";i.d(e,{s:()=>a});var r=i(84148),n=i(53908),s=i(16487),l=i(8273);class a{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:(0,r.Z)(this._rangeFactorStart)&&(0,r.Z)(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=(0,l.BK)(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(2===t.length&&t.every(t=>t>=0&&t<=1)&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):(0,r.Z)(this._rangeFactorStart)&&(0,r.Z)(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return(0,n.Z)(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&((0,n.Z)(this._rangeFactorEnd)||1===this._rangeFactorEnd)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t,this._rangeFactorEnd=null!=(i=this._rangeFactorEnd)?i:1)),this)}rangeFactorEnd(t,e){var i;return(0,n.Z)(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&((0,n.Z)(this._rangeFactorStart)||0===this._rangeFactorStart)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorEnd=t,this._rangeFactorStart=null!=(i=this._rangeFactorStart)?i:0)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);let{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,l=this.range(),a=l[0],o=l[l.length-1],h=Math.min(a,o),u=Math.max(a,o),d=(0,s.Z)(null!=(t=this._fishEyeOptions.focus)?t:0,h,u),c=(0,n.Z)(r)?(u-h)*i:r,p=Math.exp(e);p=p/(p-1)*c;let g=e/c;this._fishEyeTransform=t=>{let e=Math.abs(t-d);return e>=c?t:e<=1e-6?d:d+(t-d)*(p*(1-Math.exp(-e*g))/e*.75+.25)}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var i;return null!=(i=null==this?void 0:this[t])?i:e}}},84128:function(t,e,i){"use strict";i.d(e,{y:()=>B});var r={};i.r(r),i.d(r,{LX:()=>C});var n=i(17283),s=i(12709),l=i(19159),a=i(84148),o=i(53908),h=i(16487);function u(t,e,i){let r=(1-Math.abs(2*(i/=100)-1))*(e/=100),n=r*(1-Math.abs(t/60%2-1)),s=i-r/2,l=0,a=0,o=0;return 0<=t&&t<60?(l=r,a=n,o=0):60<=t&&t<120?(l=n,a=r,o=0):120<=t&&t<180?(l=0,a=r,o=n):180<=t&&t<240?(l=0,a=n,o=r):240<=t&&t<300?(l=n,a=0,o=r):300<=t&&t<360&&(l=r,a=0,o=n),{r:l=Math.round(255*(l+s)),g:a=Math.round(255*(a+s)),b:o=Math.round(255*(o+s))}}function d(t,e,i){t/=255;let r=Math.min(t,e/=255,i/=255),n=Math.max(t,e,i),s=n-r,l=0,a=0,o=0;return(l=Math.round(60*(l=0===s?0:n===t?(e-i)/s%6:n===e?(i-t)/s+2:(t-e)/s+4)))<0&&(l+=360),o=(n+r)/2,{h:l,s:a=+(100*(a=0===s?0:s/(1-Math.abs(2*o-1)))).toFixed(1),l:o=+(100*o).toFixed(1)}}let c=/^#([0-9a-f]{3,8})$/,p={transparent:0xffffff00},g={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function f(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function m(t){return(0,s.Z)(t)?new x(t>>16,t>>8&255,255&t,1):(0,l.Z)(t)?new x(t[0],t[1],t[2]):new x(255,255,255)}function y(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function v(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let b=(t,e)=>{let i=c.exec(t);if(e||i){let t=parseInt(i[1],16),e=i[1].length;return 3===e?new x((t>>8&15)+((t>>8&15)<<4),(t>>4&15)+((t>>4&15)<<4),(15&t)+((15&t)<<4),1):6===e?m(t):8===e?new x(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):null}};class _{static Brighter(t,e=1){return 1===e?t:new _(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return 1===e?t:new _(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){let i=t instanceof _?t:new _(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3()}}static parseColorString(t){if((0,a.Z)(p[t])){var e;return e=p[t],(0,s.Z)(e)?new x(e>>>24,e>>>16&255,e>>>8&255,255&e):(0,l.Z)(e)?new x(e[0],e[1],e[2],e[3]):new x(255,255,255,1)}if((0,a.Z)(g[t]))return m(g[t]);let i=`${t}`.trim().toLowerCase(),r=b(i);if(void 0!==r)return r;if(/^(rgb|RGB|rgba|RGBA)/.test(i)){let t=i.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new x(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),parseFloat(t[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(i)){let t=i.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),e=u(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));return new x(e.r,e.g,e.b,parseFloat(t[3]))}}constructor(t){let e=_.parseColorString(t);e?this.color=e:(console.warn(`Warn: 传入${t}无法解析为Color`),this.color=new x(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){let{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){let r=this.color.opacity,n=d(this.color.r,this.color.g,this.color.b),s=u((0,o.Z)(t)?n.h:(0,h.Z)(t,0,360),(0,o.Z)(e)?n.s:e>=0&&e<=1?100*e:e,(0,o.Z)(i)?n.l:i<=1&&i>=0?100*i:i);return this.color=new x(s.r,s.g,s.b,r),this}setRGB(t,e,i){return(0,o.Z)(t)||(this.color.r=t),(0,o.Z)(e)||(this.color.g=e),(0,o.Z)(i)||(this.color.b=i),this}setHex(t){let e=b(`${t}`.trim().toLowerCase(),!0);return null!=e?e:this}setColorName(t){let e=g[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}clone(){return new _(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){let i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=y(t.color.r),this.color.g=y(t.color.g),this.color.b=y(t.color.b),this}copyLinearToSRGB(t){return this.color.r=v(t.color.r),this.color.g=v(t.color.g),this.color.b=v(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class x{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),(0,a.Z)(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${f(this.r)+f(this.g)+f(this.b)+(1===this.opacity?"":f(255*this.opacity))}`}formatRgb(){let t=this.opacity;return`${1===t?"rgb(":"rgba("}${this.r},${this.g},${this.b}${1===t?")":`,${t})`}`}formatHsl(){let t=this.opacity,{h:e,s:i,l:r}=d(this.r,this.g,this.b);return`${1===t?"hsl(":"hsla("}${e},${i}%,${r}%${1===t?")":`,${t})`}`}toString(){return this.formatHex()}}function C(t,e){let i=t.r,r=e.r,n=t.g,s=e.g,l=t.b,a=e.b,o=t.opacity,h=e.opacity;return t=>new x(Math.round(i*(1-t)+r*t),Math.round(n*(1-t)+s*t),Math.round(l*(1-t)+a*t),o*(1-t)+h*t)}function w(t,e){return i=>t*(1-i)+e*i}function S(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}RegExp(/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g.source,"g");let{LX:A}=r;function M(t,e){let i,r=typeof e;if((0,o.Z)(e)||"boolean"===r)return()=>e;if("number"===r)return w(t,e);if("string"===r){if(i=_.parseColorString(e)){let e=A(_.parseColorString(t),i);return t=>e(t).formatRgb()}return w(Number(t),Number(e))}return e instanceof x?A(t,e):e instanceof _?A(t.color,e.color):e instanceof Date?function(t,e){let i=t.valueOf(),r=e.valueOf(),n=new Date;return t=>(n.setTime(i*(1-t)+r*t),n)}(t,e):w(Number(t),Number(e))}var k=i(8273),T=i(6594),R=i(34638);class B extends n.s{constructor(t=k.yR,e=k.yR){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=k.yR,this._piecewise=k.Pd,this._interpolate=M}calculateVisibleDomain(t){var e;return(0,a.Z)(this._rangeFactorStart)&&(0,a.Z)(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!=(e=this._niceDomain)?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),w)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return(null!=(i=this._niceDomain)?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;let r=Array.from(t,T.H);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();let i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){let i=Array.from(t);return this._range=i,this._interpolate=S,this.rescale(e)}rescale(t){var e;if(t)return this;let i=null!=(e=this._niceDomain)?e:this._domain,r=i.length,n=this._range.length,s=Math.min(r,n);if(r&&r<n&&this._forceAlign){let t=n-r+1,e=i[r-1],l=r>=2?(e-i[r-2])/t:0;for(let n=1;n<=t;n++)i[r-2+n]=e-l*(t-n);s=n}return this._autoClamp&&(this._clamp=(0,R.i)(i[0],i[s-1])),this._piecewise=s>2?k.PP:k.Pd,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:k.yR),this.rescale(i)):this._clamp!==k.yR}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){let e=this.ticks(t);return(null!=e?e:[]).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return(0,o.Z)(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return(0,o.Z)(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}},32889:function(t,e,i){"use strict";i.d(e,{f:()=>o});var r=i(84168),n=i(44264),s=i(84128);let l=t=>"function"==typeof t;var a=i(84148);class o extends s.y{constructor(){super(...arguments),this.type=r._f.Linear}clone(){return(new o).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}tickFormat(){return()=>{}}d3Ticks(t=10,e){let i=this.calculateVisibleDomain(this._range);return(0,n.Z6)(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if(l(null==e?void 0:e.customTicks))return e.customTicks(this,t);if((0,a.Z)(this._rangeFactorStart)&&(0,a.Z)(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(t,e);let r=null!=(i=this._niceDomain)?i:this._domain,s=this._domain,o=r[0],h=r[r.length-1],u=(0,n.sd)(s[0],s[s.length-1],t,e);if(!u.length)return u;if(this._domainValidator)u=u.filter(this._domainValidator);else if((u[0]!==o||u[u.length-1]!==h)&&this._niceType){let t=r.slice();if("all"===this._niceType?(t[0]=u[0],t[t.length-1]=u[u.length-1],this._niceDomain=t,this.rescale()):"min"===this._niceType&&u[0]!==o?(t[0]=u[0],this._niceDomain=t,this.rescale()):"max"===this._niceType&&u[u.length-1]!==h&&(t[t.length-1]=u[u.length-1],this._niceDomain=t,this.rescale()),"all"!==this._niceType){let e=Math.min(t[0],t[t.length-1]),i=Math.max(t[0],t[t.length-1]);u=u.filter(t=>t>=e&&t<=i)}}return u}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return(0,n.S8)(e[0],e[e.length-1],t)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return(0,n.Hb)(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;let s=this._domain,l=[];if(e){let t=(0,n.OQ)(s,e);if(l=t.niceMinMax,this._domainValidator=t.domainValidator,this._niceType=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){let e=(0,n.EL)(s.slice(),t);"min"===this._niceType?e[e.length-1]=null!=(i=l[1])?i:e[e.length-1]:"max"===this._niceType&&(e[0]=null!=(r=l[0])?r:e[0]),this._niceDomain=e,this.rescale()}return this}niceMin(t=10){this._niceType="min";let e=this._domain[this._domain.length-1],i=(0,n.EL)(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";let e=this._domain[0],i=(0,n.EL)(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}},97116:function(t,e,i){"use strict";i.d(e,{n:()=>s});var r=i(44264),n=i(8273);class s{nice(t=10,e){var i,s,l,a;let o=this._domain,h=[],u=null;if(e){let t=(0,r.OQ)(o,e);if(h=t.niceMinMax,this._domainValidator=t.domainValidator,u=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else u="all";if(u){let t=(0,n.kx)(o.slice(),null!=(s=null==(i=this.getNiceConfig)?void 0:i.call(this))?s:{floor:t=>Math.floor(t),ceil:t=>Math.ceil(t)});return"min"===u?t[t.length-1]=null!=(l=h[1])?l:t[t.length-1]:"max"===u&&(t[0]=null!=(a=h[0])?a:t[0]),this._niceDomain=t,this.rescale(),this}return this}niceMin(){let t=this._domain[this._domain.length-1];this.nice();let e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}niceMax(){let t=this._domain[0];this.nice();let e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}},37352:function(t,e,i){"use strict";i.d(e,{Y:()=>u});var r=i(44264),n=i(84128),s=i(84168),l=i(8273),a=i(94904),o=i(97116);function h(t=Number.EPSILON){return e=>Math.max(e,t)}class u extends n.y{constructor(){super((0,l.J7)(10),(0,l.ye)(10)),this.type=s._f.Log,this._limit=h(),this._logs=this.transformer,this._pows=this.untransformer,this._domain=[1,10],this._base=10}clone(){return(new u).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}rescale(t){var e;if(t)return this;super.rescale();let i=(0,l.J7)(this._base),r=(0,l.ye)(this._base);return(null!=(e=this._niceDomain)?e:this._domain)[0]<0?(this._logs=t=>-i(-t),this._pows=t=>-r(-t),this._limit=function(t=Number.EPSILON){return e=>Math.min(e,-t)}(),this.transformer=l.op,this.untransformer=l.ge):(this._logs=i,this._pows=r,this._limit=h(),this.transformer=this._logs,this.untransformer=r),this}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!=(e=this._niceDomain)?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}base(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}tickFormat(){return l.yR}d3Ticks(t=10,e){let i=this.domain(),n=this._limit(i[0]),s=this._limit(i[i.length-1]);return(0,r.e3)(n,s,t,this._base,this.transformer,this.untransformer,e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return(0,r.jb)(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return(0,r.RX)(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return(0,r.RX)(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}getNiceConfig(){return{floor:t=>this._pows(Math.floor(this._logs(this._limit(t)))),ceil:t=>Math.abs(t)>=1?Math.ceil(t):this._pows(Math.ceil(this._logs(this._limit(t))))}}}(0,a.jB)(u,o.n)},25777:function(t,e,i){"use strict";i.d(e,{g:()=>h});var r=i(94904),n=i(32889),s=i(84168),l=i(44264),a=i(8273),o=i(97116);class h extends n.f{constructor(){super((0,a.QG)(1),(0,a.Xw)(1)),this.type=s._f.Symlog,this._const=1}clone(){return(new h).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}constant(t,e){return arguments.length?(this._const=t,this.transformer=(0,a.QG)(t),this.untransformer=(0,a.Xw)(t),this.rescale(e)):this._const}d3Ticks(t=10,e){let i=this.domain(),r=i[0],n=i[i.length-1];return(0,l.e3)(r,n,t,this._const,this.transformer,this.untransformer,e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return(0,l.jb)(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return(0,l.RX)(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return(0,l.RX)(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}(0,r.jB)(h,o.n)},84168:function(t,e,i){"use strict";var r,n;i.d(e,{_f:()=>r}),(n=r||(r={})).Identity="identity",n.Linear="linear",n.Log="log",n.Pow="pow",n.Sqrt="sqrt",n.Symlog="symlog",n.Time="time",n.Quantile="quantile",n.Quantize="quantize",n.Threshold="threshold",n.Ordinal="ordinal",n.Point="point",n.Band="band";let s={};Object.values(r).forEach(t=>{s[t]=!0})},44264:function(t,e,i){"use strict";i.d(e,{sd:()=>g,Hb:()=>v,e3:()=>C,jb:()=>w,EL:()=>b,RX:()=>S,OQ:()=>_,S8:()=>y,Z6:()=>d});var r=i(84148);let n=t=>{let e=null,i=null;return(...r)=>(e&&r.every((t,i)=>t===e[i])||(e=r,i=t(...r)),i)};var s=i(12709),l=i(8273);let a=Math.sqrt(50),o=Math.sqrt(10),h=Math.sqrt(2),u=(t,e,i)=>{let n=1,s=t,l=Math.floor((e-1)/2),a=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?s=0:t<0&&t>=-Number.MIN_VALUE?s=-(e-1):!i&&a<1?n=f(a).step:(i||a>1)&&(s=Math.floor(t)-l*n),n>0?(t>0?s=Math.max(s,0):t<0&&(s=Math.min(s,-(e-1)*n)),(function(t,e,i){(0,r.Z)(e)||(e=t,t=0),(0,r.Z)(i)||(i=1);let n=-1,s=0|Math.max(0,Math.ceil((e-t)/i)),l=Array(s);for(;++n<s;)l[n]=t+n*i;return l})(0,e).map(t=>s+t*n)):t>0?c(0,-(e-1)/n,n):c((e-1)/n,0,n)},d=n((t,e,i,r)=>{let n,s,l,a,o=-1;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((n=e<t)&&(s=t,t=e,e=s),!isFinite(a=m(t,e,i).step))return[];if(a>0){let i=Math.round(t/a),r=Math.round(e/a);for(i*a<t&&++i,r*a>e&&--r,l=Array(s=r-i+1);++o<s;)l[o]=(i+o)*a}else if(a<0&&(null==r?void 0:r.noDecimals)){a=1;let i=Math.ceil(t),r=Math.floor(e);if(!(i<=r))return[];for(l=Array(s=r-i+1);++o<s;)l[o]=i+o}else{let i=Math.round(t*(a=-a)),r=Math.round(e*a);for(i/a<t&&++i,r/a>e&&--r,l=Array(s=r-i+1);++o<s;)l[o]=(i+o)/a}return n&&l.reverse(),l}),c=(t,e,i)=>{let r,n,s=-1;if(i>0){let l=Math.floor(t/i),a=Math.ceil(e/i);for((l+1)*i<t&&++l,(a-1)*i>e&&--a,n=Array(r=a-l+1);++s<r;)n[s]=(l+s)*i}else{let l=Math.floor(t*(i=-i)),a=Math.ceil(e*i);for((l+1)/i<t&&++l,(a-1)/i>e&&--a,n=Array(r=a-l+1);++s<r;)n[s]=(l+s)/i}return n},p=(t,e,i)=>{let r,n=t[0],s=t[t.length-1],l=e-t.length;if(s<=0){let e=[];for(r=l;r>=1;r--)e.push(n-r*i);return e.concat(t)}if(n>=0){for(r=1;r<=l;r++)t.push(s+r*i);return t}let a=[],o=[];for(r=1;r<=l;r++)r%2==0?a=[n-Math.floor(r/2)*i].concat(a):o.push(s+Math.ceil(r/2)*i);return a.concat(t).concat(o)},g=n((t,e,i,r)=>{let n,s,l;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return u(t,i,null==r?void 0:r.noDecimals);(n=e<t)&&(l=t,t=e,e=l);let a=m(t,e,i),o=a.step;if(!isFinite(o))return[];if(o>0){let r=1,{power:n,gap:l}=a,h=10===l?2*10**n:+(10**n);for(;r<=5&&(s=c(t,e,o)).length>i+1&&i>2;)o+=h,r+=1;i>2&&s.length<i-1&&(s=p(s,i,o))}else(null==r?void 0:r.noDecimals)&&o<0&&(o=1),s=c(t,e,o);return n&&s.reverse(),s}),f=t=>{let e=Math.floor(Math.log(t)/Math.LN10),i=t/10**e,r=1;return i>=a?r=10:i>=o?r=5:i>=h&&(r=2),e>=0?{step:r*10**e,gap:r,power:e}:{step:-(10**-e)/r,gap:r,power:e}};function m(t,e,i){return f((e-t)/Math.max(0,i))}function y(t,e,i){let r;if(i*=1,(t*=1)==(e*=1)&&i>0)return[t];if(i<=0||0==(r=(e-t)/Math.max(1,i-1))||!isFinite(r))return[];let n=Array(i);for(let e=0;e<i;e++)n[e]=t+e*r;return n}function v(t,e,i){let r,n,s=-1;if(i*=1,(n=(e*=1)<(t*=1))&&(r=t,t=e,e=r),!isFinite(i)||e-t<=i)return[t];let l=Math.floor((e-t)/i+1),a=Array(l);for(;++s<l;)a[s]=t+s*i;return n&&a.reverse(),a}function b(t,e=10){let i,r,n=0,s=t.length-1,l=t[n],a=t[s],o=10;for(a<l&&(r=l,l=a,a=r,r=n,n=s,s=r);o-- >0;){if((r=m(l,a,e).step)===i)return t[n]=l,t[s]=a,t;if(r>0)l=Math.floor(l/r)*r,a=Math.ceil(a/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,a=Math.floor(a*r)/r}i=r}}function _(t,e){let i=(0,s.Z)(e.forceMin),r=(0,s.Z)(e.forceMax),n=null,l=[],a=null,o=i&&r?t=>t>=e.forceMin&&t<=e.forceMax:i?t=>t>=e.forceMin:r?t=>t<=e.forceMax:null;return i?l[0]=e.forceMin:(0,s.Z)(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(l[0]=e.min),r?l[1]=e.forceMax:(0,s.Z)(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(l[1]=e.max),(0,s.Z)(l[0])&&(0,s.Z)(l[1])?((a=t.slice())[0]=l[0],a[a.length-1]=l[1]):n=(0,s.Z)(l[0])||(0,s.Z)(l[1])?(0,s.Z)(l[0])?"max":"min":"all",{niceType:n,niceDomain:a,niceMinMax:l,domainValidator:o}}let x=(t,e,i)=>1>Math.abs(e-t)?+i.toFixed(1):Math.round(+i),C=n((t,e,i,r,n,s,l)=>{let a=t,o=e,h=o<a;h&&([a,o]=[o,a]);let u,d,c=n(a),p=n(o),f=[];if(!(r%1)&&p-c<i){if(c=Math.floor(c),p=Math.ceil(p),a>0){for(;c<=p;++c)for(u=1;u<r;++u)if(!((d=c<0?u/s(-c):u*s(c))<a)){if(d>o)break;f.push(d)}}else for(;c<=p;++c)for(u=r-1;u>=1;--u)if(!((d=c>0?u/s(-c):u*s(c))<a)){if(d>o)break;f.push(d)}2*f.length<i&&(f=g(a,o,i))}else f=g(c,p,Math.min(p-c,i)).map(s);return f=f.filter(t=>0!==t),(null==l?void 0:l.noDecimals)&&(f=Array.from(new Set(f.map(t=>Math.floor(t))))),h?f.reverse():f}),w=n((t,e,i,r,n,s)=>{let a=[],o={},h=n(t),u=n(e),d=[];if(Number.isInteger(r))d=g(h,u,i);else{let t=(u-h)/(i-1);for(let e=0;e<i;e++)d.push(h+e*t)}return d.forEach(i=>{let n=s(i),h=Number.isInteger(r)?x(t,e,n):x(t,e,(0,l.ok)(n)),u=x(t,e,(0,l.uT)(h,[t,e]));o[u]||isNaN(u)||!(d.length>1)||(o[u]=1,a.push(u))}),a}),S=n((t,e,i,r,n)=>y(r(t),r(e),i).map(t=>(0,l.ok)(n(t))));n((t,e,i,r,n)=>v(r(t),r(e),i).map(t=>(0,l.ok)(n(t))))},8273:function(t,e,i){"use strict";i.d(e,{Pd:()=>p,U6:()=>g,yR:()=>n,J7:()=>h,at:()=>m,op:()=>s,kx:()=>b,BK:()=>y,PP:()=>v,Xw:()=>d,uT:()=>x,$l:()=>f,ge:()=>l,ok:()=>_,ye:()=>o,QG:()=>u});var r=i(53908);function n(t){return t}let s=t=>-Math.log(-t),l=t=>-Math.exp(-t),a=t=>isFinite(t)?Math.pow(10,t):t<0?0:t,o=t=>10===t?a:t===Math.E?Math.exp:e=>Math.pow(t,e),h=t=>t===Math.E?Math.log:10===t?Math.log10:2===t?Math.log2:(t=Math.log(t),e=>Math.log(e)/t),u=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),d=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t;function c(t,e){if(t=Number(t),e=Number(e)-t)return i=>(i-t)/e;let i=Number.isNaN(e)?NaN:.5;return()=>i}function p(t,e,i){let r,n,s=t[0],l=t[1],a=e[0],o=e[1];return l<s?(r=c(l,s),n=i(o,a)):(r=c(s,l),n=i(a,o)),t=>n(r(t))}function g(t,e,i){let r;return r=1===t?t+2*i:t-e+2*i,t?r>0?r:1:0}function f(t,e,i,r){return 1===i&&(i=0),g(t,i,r)*(e/(1-i))}function m(t,e,i,r,n){let s=e/Math.max(1,g(t,i,r)||1);n&&(s=Math.floor(s));let l=s*(1-i);return n&&(l=Math.round(l)),l}function y(t,e){let i=(t[1]-t[0])/(e[1]-e[0]),r=t[0]-i*e[0];return[r,i+r]}function v(t,e,i){let n=Math.min(t.length,e.length)-1,s=Array(n),l=Array(n),a=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<n;)s[a]=c(t[a],t[a+1]),l[a]=i(e[a],e[a+1]);return function(e){let i=function(t,e,i=0,n){for((0,r.Z)(n)&&(n=t.length);i<n;){var s;let r=i+n>>>1;((s=t[r])<e?-1:s>e?1:s>=e?0:NaN)>0?n=r:i=r+1}return i}(t,e,1,n)-1;return l[i](s[i](e))}}let b=(t,e)=>{let i=t.slice(),r=0,n=i.length-1,s=i[r],l=i[n];return l<s&&([r,n]=[n,r],[s,l]=[l,s]),i[r]=e.floor(s),i[n]=e.ceil(l),i},_=(t,e=!1)=>{let i=Math.floor(Math.log10(t)),r=t/Math.pow(10,i);return(e?r<1.5?1:r<3?2:r<7?5:10:r<=1?1:r<=2?2:r<=5?5:10)*Math.pow(10,i)},x=(t,e)=>{let i,r;return e[0]<e[1]?(i=e[0],r=e[1]):(i=e[1],r=e[0]),Math.min(Math.max(t,i),r)}},83143:function(t,e,i){"use strict";var r,n;i.d(e,{_f:()=>r,lK:()=>a,z2:()=>l}),(n=r||(r={})).Identity="identity",n.Linear="linear",n.Log="log",n.Pow="pow",n.Sqrt="sqrt",n.Symlog="symlog",n.Time="time",n.Quantile="quantile",n.Quantize="quantize",n.Threshold="threshold",n.Ordinal="ordinal",n.Point="point",n.Band="band";let s={};function l(t){switch(t){case r.Linear:case r.Log:case r.Pow:case r.Sqrt:case r.Symlog:case r.Time:return!0;default:return!1}}function a(t){switch(t){case r.Ordinal:case r.Point:case r.Band:return!0;default:return!1}}Object.values(r).forEach(t=>{s[t]=!0})},27281:function(t,e,i){"use strict";i.d(e,{T:()=>f});var r=i(61504),n=i(89082),s=i(97257),l=i(43735),a=i(18585),o=i(26771),h=i(42512),u=i(35953),d=i(13844),c=i(75382);function p(t,e){let i=e.getDrawRange();if((0,a.Z)(t)&&t>=e.frozenRowCount){let r=e.getFrozenRowsHeight(),n=e.getRowsHeight(0,t-1);e.scrollTop=Math.min(n-r,e.getAllRowsHeight()-i.height)-1}e.scenegraph.updateNextFrame()}var g=i(26364);(0,n.R2)(),(0,n.Eg)(),(0,n.I)(),(0,n.FD)(),(0,n._t)(),(0,n.Mh)(),d.F.registerComponent("listTreeStickCellPlugin",class t{constructor(t){this.titleRows=[],this.showedTitleRows=[],this.rowNow=-1,this.skipStartRow=-1,this.skipEndRow=-1,this.table=t,this.table.on("scroll",t=>{"vertical"===t.scrollDirection&&this.updateGroupTitle()}),this.table.on("tree_hierarchy_state_change",t=>{this.updateGroupTitle()}),this.table.on("resize_column",t=>{this.updateGroupTitle()})}updateGroupTitle(){0===this.table.scrollTop?(this.titleRows=[],this.showedTitleRows=[]):-1!==this.skipStartRow&&-1!==this.skipEndRow&&this.skipStartRow!==this.table.scenegraph.proxy.bodyTopRow-1?(this.table.scenegraph.proxy.screenTopRow<=this.skipStartRow||this.table.scenegraph.proxy.screenTopRow>=this.skipEndRow)&&(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()):(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()),this.updateScenegraph()}updateGroupTitleInfo(){this.rowNow=this.table.scenegraph.proxy.screenTopRow+this.titleRows.length;let t=this.table.getRecordIndexByCell(0,this.rowNow),e=this.table.getRecordIndexByCell(0,this.rowNow+1);this.getTitleRowsByRecordIndex(t,e)}getTitleRowsByRecordIndex(t,e){let i=[];(0,l.Z)(t)||(t=[t]),(0,l.Z)(e)||(e=[e]);for(let e=0;e<t.length;e++){let r=t.slice(0,e+1),n=this.table.dataSource.getRaw(r);i.push(n)}let r=[],n=e.length===t.length+1,s=t.slice(0,n?t.length:t.length-1),a=this.table.dataSource.currentIndexedData;for(let e=this.rowNow-this.table.columnHeaderLevelCount;e>=0;e--){let i=a[e];if((0,l.Z)(i)&&s.length===i.length){let t=!0;for(let e=0;e<i.length;e++)if(i[e]!==s[e]){t=!1;break}t&&(r.push(e+this.table.columnHeaderLevelCount),s=s.slice(0,s.length-1))}else if(i===t[0]){r.push(e+this.table.columnHeaderLevelCount);break}}this.titleRows=r.reverse()}updateScenegraph(){let{table:t}=this,{shadowGroup:e,shadowGroupFrozen:i}=function(t){let e=t.scenegraph.colHeaderGroup,i=t.scenegraph.cornerHeaderGroup;if(!e.border){let i=(0,u.f)({x:0,y:0,width:0,height:0,cursor:"pointer"});e.add(i),e.border=i,i.attachShadow(i.shadowRoot),i.name="border-rect",i.addEventListener("click",e=>{let i=t.listTreeStickCellPlugin.titleRows,{shadowTarget:r}=e.pickParams,{col:n,row:s}=(0,c.J$)(r);p(s-i.indexOf(s),t)})}if(!i.border){let e=(0,u.f)({x:0,y:0,width:0,height:0,cursor:"pointer"});i.add(e),i.border=e,e.attachShadow(e.shadowRoot),e.name="border-rect",e.addEventListener("click",e=>{let i=t.listTreeStickCellPlugin.titleRows,{shadowTarget:r}=e.pickParams,{col:n,row:s}=(0,c.J$)(r);p(s-i.indexOf(s),t)})}let r=e.border.shadowRoot,n=i.border.shadowRoot;return r.removeAllChild(),n.removeAllChild(),{shadowGroup:r,shadowGroupFrozen:n}}(t);this.showedTitleRows.length=0;let r=0;for(let d=0;d<t.colCount;d++){let c;d<t.frozenColCount?(c=new o.Z({x:t.getColsWidth(0,d-1),y:t.getFrozenRowsHeight()}),i.add(c)):(c=new o.Z({x:t.getColsWidth(t.frozenColCount,d-1),y:t.getFrozenRowsHeight()}),e.add(c)),c.col=d;for(let e=0;e<this.titleRows.length;e++){var n,s,l,a;let i=this.titleRows[e];if(n=i,s=this.rowNow,l=t.scenegraph.proxy.screenTopRow,a=this.titleRows,n===s&&n!==l+a.length-1||n===l+a.indexOf(n)+1&&n<s){0===d&&r++;continue}0===d&&this.showedTitleRows.push(i);let o=t.scenegraph.getCell(d,i);if("cell"===o.role){let t=function t(e){let i=e.clone();if(i.role=e.role,i.col=e.col,i.row=e.row,i.mergeStartCol=e.mergeStartCol,i.mergeStartRow=e.mergeStartRow,i.mergeEndCol=e.mergeEndCol,i.mergeEndRow=e.mergeEndRow,i.contentWidth=e.contentWidth,i.contentHeight=e.contentHeight,"cell"===i.role){let t=(0,u.f)({x:0,y:0,width:i.attribute.width,height:i.attribute.height});i.add(t)}return"group"===e.type&&e.forEachChildren(e=>{let r=t(e);i.add(r)}),i}(o);t.setAttributes({y:40*e}),c.add(t)}else{let r=(0,h.wW)(d,i,t,!0,!0);r.setAttributes({y:40*e}),c.add(r)}}}r>0&&-1===this.skipStartRow&&-1===this.skipEndRow&&(this.skipStartRow=t.scenegraph.proxy.screenTopRow-1,this.skipEndRow=t.scenegraph.proxy.screenTopRow+1)}}),(0,s.zf)(),(0,n.ph)(),(0,g.LQ)(),(0,g.yR)(),(0,g.pk)(),(0,g.m4)(),(0,g.Jy)(),(0,g.VT)(),(0,g.ah)(),(0,g.dB)(),(0,g.ge)(),(0,g.au)();class f extends r.e{}},61504:function(t,e,i){"use strict";i.d(e,{e:()=>F});var r=i(73664),n=i(91212),s=i(18585),l=i(13455),a=i(62413),o=i(83906),h=i(10026);class u{constructor(t,e,i,r){var n,s;this.seqId=0,this._columnMaxDepth=0,this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this.bodyRowSpanCount=1,this._transpose=!1,this._showHeader=!0,this._recordsCount=0,this._hasAggregation=!1,this._hasAggregationOnTopCount=0,this._hasAggregationOnBottomCount=0,this._cellRangeMap=new Map,this._showHeader=i,this._table=t,this._columns=[],this._columnsIncludeHided=[],this._headerCellIds=[],this._columnMaxDepth=this._calculateMaxDepth(e),this.hierarchyIndent=null!=r?r:20,this.hierarchyTextStartAlignment=t.options.hierarchyTextStartAlignment,this.columnHierarchyType=t.options.headerHierarchyType,this.columnExpandLevel=null!=(n=t.options.headerExpandLevel)?n:1,this.columnTree=new h.KO(e,{seqId:0},null!=(s=this.columnHierarchyType)?s:null,"grid-tree"===this.columnHierarchyType?this.columnExpandLevel:void 0),this._headerObjectsIncludeHided=this._addHeaders(0,e,[]),this._headerObjects=this._headerObjectsIncludeHided.filter(t=>!0!==t.define.hide),this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this.rowHierarchyType=(0,o.C1)(this)?"tree":"grid",this._hasAggregation=(0,o.MP)(this),this._hasAggregationOnBottomCount=(0,o.WM)(this),this._hasAggregationOnTopCount=(0,o.OT)(this),this.handleRowSeriesNumber(t.internalProps.rowSeriesNumber)}handleRowSeriesNumber(t){var e,i,r;t&&(Array.isArray(t)?this.rowSeriesNumberColumn=t.map((t,e)=>{var i,r;return{id:this.seqId++,title:t.title,define:(0,n.Z)({field:"_vtable_rowSeries_number_"+e},t),cellType:null!=(i=t.cellType)?i:"text",headerType:"checkbox"===t.cellType?"checkbox":"text",style:t.style,width:t.width,format:t.format,field:null!=(r=t.field)?r:"_vtable_rowSeries_number_"+e,icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:this.seqId++,title:t.title,define:(0,n.Z)({field:"_vtable_rowSeries_number"},t),cellType:null!=(e=t.cellType)?e:"text",headerType:null!=(i=t.headerType)?i:"checkbox"===t.cellType?"checkbox":"text",style:t.style,width:t.width,format:t.format,field:null!=(r=t.field)?r:"_vtable_rowSeries_number",icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(t=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(t=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}get transpose(){return this._transpose}set transpose(t){this._transpose=t}get showHeader(){return this._showHeader}set showHeader(t){this._showHeader=t}isSeriesNumberInHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}if(this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}return!1}isSeriesNumberInBody(t,e){return!!(this.leftRowSeriesNumberColumnCount>0)&&!!(t>=0)&&!!(t<this.leftRowSeriesNumberColumnCount)&&(!!this.transpose||!!(e>=this.headerLevelCount))||!!(this.rightRowSeriesNumberColumnCount>0)&&!!(t>=this.colCount-this.rightRowSeriesNumberColumnCount)&&(!!this.transpose||!!(e>=this.headerLevelCount))||!1}isSeriesNumber(t,e){return!!((0,s.Z)(t)&&(0,s.Z)(e))&&(!!(this.leftRowSeriesNumberColumnCount>0)&&!!(t>=0)&&!!(e>=0)&&!!(t<this.leftRowSeriesNumberColumnCount)||!!(this.rightRowSeriesNumberColumnCount>0)&&!!(e>=0)&&!!(t>=this.colCount-this.rightRowSeriesNumberColumnCount))||!1}getSeriesNumberHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return;if(e<this.headerLevelCount)return Object.assign({},this.leftRowSeriesNumberColumn[t],{style:Object.assign({},this._table.transpose?this._table.internalProps.theme.rowHeaderStyle:this._table.internalProps.theme.headerStyle,this._table.internalProps.rowSeriesNumber.headerStyle)})}if(this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e<this.headerLevelCount){if(this.transpose)return;if(e<this.headerLevelCount)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]}}getSeriesNumberBody(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount)?this.leftRowSeriesNumberColumn[t]:this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount)?this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}isHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)||!this.transpose&&e>=0&&e<this.headerLevelCount}isAggregation(t,e){if(this.hasAggregation){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}}return!1}isTopAggregation(t,e){if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}return!1}isBottomAggregation(t,e){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}return!1}get hasAggregation(){return this._hasAggregation}get hasAggregationOnTopCount(){return this._hasAggregationOnTopCount}get hasAggregationOnBottomCount(){return this._hasAggregationOnBottomCount}getAggregatorsByCell(t,e){return this.getColumnDefine(t,e).vtable_aggregator}getAggregatorsByCellRange(t,e,i,r){let n=[];if(!this.transpose){for(let r=t;r<=i;r++){let t=this.getColumnDefine(r,e);t.vtable_aggregator&&(n=n.concat(Array.isArray(t.vtable_aggregator)?t.vtable_aggregator:[t.vtable_aggregator]))}return n}for(let i=e;i<=r;i++){let e=this.getColumnDefine(t,i);e.vtable_aggregator&&(n=n.concat(Array.isArray(e.vtable_aggregator)?e.vtable_aggregator:[e.vtable_aggregator]))}return[]}getAggregatorOnTop(t,e){let i=this.getColumnDefine(t,e),r=i.vtable_aggregator,n=i.aggregation;if(Array.isArray(n)){let i=n.reduce((t,e,i)=>(e.showOnTop&&t.push(i),t),[]).map(t=>r[t]);return this.transpose?i[t-this.rowHeaderLevelCount]:i[e-this.columnHeaderLevelCount]}return this.transpose&&t-this.rowHeaderLevelCount==0?(null==n?void 0:n.showOnTop)?r:null:this.transpose||e-this.columnHeaderLevelCount!=0?null:(null==n?void 0:n.showOnTop)?r:null}getAggregatorOnBottom(t,e){let i=this.getColumnDefine(t,e),r=i.vtable_aggregator,n=i.aggregation;if(Array.isArray(n)){let i=n.reduce((t,e,i)=>(e.showOnTop||t.push(i),t),[]).map(t=>r[t]);return this.transpose?i[t-(this.colCount-this.hasAggregationOnBottomCount)]:i[e-(this.rowCount-this.hasAggregationOnBottomCount)]}return this.transpose&&t-(this.colCount-this.hasAggregationOnBottomCount)==0?(null==n?void 0:n.showOnTop)?null:r:this.transpose||e-(this.rowCount-this.hasAggregationOnBottomCount)!=0||(null==n?void 0:n.showOnTop)?null:r}getAggregatorCellAddress(t,e,i,r){let n=[],s=this.hasAggregationOnTopCount,l=this.hasAggregationOnBottomCount;if(this.transpose){for(let i=e;i<=r;i++)if(this.getColumnDefine(t,i).vtable_aggregator){for(let t=0;t<s;t++)n.push({col:this.headerLevelCount+t,row:i});for(let t=0;t<l;t++)n.push({col:this.rowCount-l+t,row:i})}}else for(let r=t;r<=i;r++)if(this.getColumnDefine(r,e).vtable_aggregator){for(let t=0;t<s;t++)n.push({col:r,row:this.headerLevelCount+t});for(let t=0;t<l;t++)n.push({col:r,row:this.rowCount-l+t})}return n}getCellLocation(t,e){return this.isHeader(t,e)?this.transpose?"rowHeader":"columnHeader":"body"}isRowHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)}isColumnHeader(t,e){return!this.transpose&&e>=0&&e<=this.headerLevelCount-1&&t>=this.leftRowSeriesNumberColumnCount&&t<this.colCount-this.rightRowSeriesNumberColumnCount}isFrozenColumn(t,e){if((0,s.Z)(e)){if(t>=0&&t<this.frozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&t>=0&&t<this.frozenColCount)return!0;return!1}isRightFrozenColumn(t,e){if((0,s.Z)(e)){if(t>=this.colCount-this.rightFrozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&t>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(t,e){if((0,s.Z)(e)){if(e>=0&&e<this.frozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.frozenRowCount>0&&e>=0&&e<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(t,e){if((0,s.Z)(e)){if(e>=this.rowCount-this.bottomFrozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.bottomFrozenRowCount>0&&e>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=0&&e<this.frozenRowCount}isLeftBottomCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=0&&e<this.frozenRowCount}isRightBottomCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isCornerHeader(t,e){return!1}getColumnHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:(null!=(t=this.rowCount)?t:0)-1}}:{start:{col:0,row:0},end:{col:(null!=(e=this.colCount)?e:0)-1,row:this._headerCellIds.length-1}}}getRowHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:(null!=(t=this.rowCount)?t:0)-1}}:{start:{col:0,row:0},end:{col:(null!=(e=this.colCount)?e:0)-1,row:this._headerCellIds.length-1}}}getCornerHeaderRange(){}getBodyRange(){var t,e,i,r;return this.transpose?{start:{col:this.headerLevelCount,row:0},end:{col:(null!=(t=this.colCount)?t:0)-1,row:(null!=(e=this.rowCount)?e:0)-1}}:{start:{col:0,row:this.headerLevelCount},end:{col:(null!=(i=this.colCount)?i:0)-1,row:(null!=(r=this.rowCount)?r:0)-1}}}get headerLevelCount(){return this.showHeader?this._headerCellIds.length:0}get columnHeaderLevelCount(){return this.transpose?0:this.headerLevelCount}get rowHeaderLevelCount(){return this.transpose?this.headerLevelCount:0}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get bottomFrozenRowCount(){return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0}get rightFrozenColCount(){return this._table.internalProps.rightFrozenColCount?this.colCount-this.frozenColCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:Math.max(0,this.colCount-this.frozenColCount):0}get colCount(){return this.transpose?this.headerLevelCount+this.recordsCount+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount:this._columns.length+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount}get rowCount(){return this.transpose?this._columns.length:this.headerLevelCount+this.recordsCount}get bodyRowCount(){return this.transpose?this._columns.length:this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.transpose?this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount:this._columns.length}get recordsCount(){return this._recordsCount}set recordsCount(t){this._recordsCount=t}get headerObjects(){return this._headerObjects}get columnObjects(){return this._columns}get headerObjectsIncludeHided(){return this._headerObjectsIncludeHided}get columnWidths(){if(this.leftRowSeriesNumberColumnCount){let t=this.leftRowSeriesNumberColumn.map(t=>({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}));return t.push(...this._columns.map(t=>({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}))),t}return this._columns.map(t=>({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}))}getColumnWidthDefined(t){var e;if(t>=0){if(t<this.leftRowSeriesNumberColumnCount)return this.leftRowSeriesNumberColumn[t];if(this.transpose){let i,r,n=0;if(t>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount){let t;return this.columnObjects.forEach((e,s)=>{"number"==typeof e.width?n=Math.max(e.width,n):"auto"===e.width&&(t=!0),"number"==typeof e.minWidth&&(r=Math.max(e.minWidth,r)),"number"==typeof e.maxWidth&&(i=Math.max(e.maxWidth,i))}),{width:n=n>0?n:t?"auto":void 0,minWidth:r,maxWidth:i}}if(this.isRowHeader(t,0)){let i=Array.isArray(this._table.defaultHeaderColWidth)?null!=(e=this._table.defaultHeaderColWidth[t])?e:this._table.defaultColWidth:this._table.defaultHeaderColWidth;return"auto"===i?{width:"auto"}:{width:i}}}return this._columns[t-this.leftRowSeriesNumberColumnCount]}}getCellId(t,e){var i,r,n,s;return this.transpose?t>=this.headerLevelCount+this.leftRowSeriesNumberColumnCount?null==(i=this._columns[e])?void 0:i.id:this.isSeriesNumber(t,e)?e+"_series_number":null==(r=this._headerCellIds[t-this.leftRowSeriesNumberColumnCount])?void 0:r[e]:this.isSeriesNumber(t,e)?this.rowSeriesNumberColumn[t].id:this.headerLevelCount<=e?null==(n=this._columns[t-this.leftRowSeriesNumberColumnCount])?void 0:n.id:null==(s=this._headerCellIds[e])?void 0:s[t-this.leftRowSeriesNumberColumnCount]}getHeader(t,e){if(this.isSeriesNumberInHeader(t,e))return this.getSeriesNumberHeader(t,e);let i=this.getCellId(t,e);return this._headerObjectMap[i]}getHeaderField(t,e){var i,r,n;if(this.isSeriesNumberInHeader(t,e))return null==(i=this.getSeriesNumberHeader(t,e))?void 0:i.field;if(this.isSeriesNumberInBody(t,e))return null==(r=this.getSeriesNumberBody(t,e))?void 0:r.field;let s=this.getCellId(t,e);return(null==(n=this._headerObjectMap[s])?void 0:n.field)||(this.transpose?this._columns[e]&&this._columns[e].field:this._columns[t-this.leftRowSeriesNumberColumnCount]&&this._columns[t-this.leftRowSeriesNumberColumnCount].field)}getHeaderCellAdressById(t){for(let e=0;e<this._headerCellIds.length;e++){let i=this._headerCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return this.transpose?{col:e,row:r}:{col:r+this.leftRowSeriesNumberColumnCount,row:e}}}getHeaderCellAddressByField(t){let e=this.headerObjects.find(e=>e&&e.field===t);return e&&this.getHeaderCellAdressById(e.id)}getBody(t,e){return this.isSeriesNumber(t,e)?this.getSeriesNumberBody(t,e):this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]}getBodyLayoutRangeById(t){var e,i;if(this.transpose){for(let i=0;i<(null!=(e=this.rowCount)?e:0);i++)if(t===this._columns[i].id)return{start:{col:0,row:i},end:{col:0,row:i}}}else for(let e=this.leftRowSeriesNumberColumnCount;e<(null!=(i=this.colCount)?i:0);e++)if(t===this._columns[e-this.leftRowSeriesNumberColumnCount].id)return{start:{col:e,row:0},end:{col:e,row:0}};return{start:{col:-1,row:-1},end:{col:-1,row:-1}}}getCellRange(t,e){return function(t,e,i){var r,n,s;if(-1===t||-1===e)return{start:{col:t,row:e},end:{col:t,row:e}};if(i._cellRangeMap.has(`$${t}$${e}`))return i._cellRangeMap.get(`$${t}$${e}`);let l={start:{col:t,row:e},end:{col:t,row:e}};if(i.transpose)l=function(t,e,i){var r,n,s,l;let a={start:{col:t,row:e},end:{col:t,row:e}};if(i.headerLevelCount+i.leftRowSeriesNumberColumnCount<=t||-1===t&&-1===e){if(i.headerLevelCount+i.leftRowSeriesNumberColumnCount<=t&&(null==(n=null==(r=i.columnObjects[e])?void 0:r.define)?void 0:n.mergeCell)){let r=i._table.getCellValue(t,e);for(let n=t-1;n>=i.headerLevelCount+i.leftRowSeriesNumberColumnCount;n--){let s=i._table.getCellValue(n,e);if("boolean"==typeof i.columnObjects[e].define.mergeCell){if(r!==s)break}else if(!i.columnObjects[e].define.mergeCell(r,s,{source:{col:t,row:e},target:{col:n,row:e},table:i._table}))break;a.start.col=n}for(let n=t+1;n<(null!=(s=i.colCount)?s:0);n++){let s=i._table.getCellValue(n,e);if("boolean"==typeof i.columnObjects[e].define.mergeCell){if(r!==s)break}else if(!i.columnObjects[e].define.mergeCell(r,s,{source:{col:t,row:e},target:{col:n,row:e},table:i._table}))break;a.end.col=n}}return a}let o=i.getCellId(t,e);for(let r=e-1;r>=0&&o===i.getCellId(t,r);r--)a.start.row=r;for(let r=e+1;r<(null!=(l=i.rowCount)?l:0)&&o===i.getCellId(t,r);r++)a.end.row=r;for(let r=t-1;r>=0&&o===i.getCellId(r,e);r--)a.start.col=r;for(let r=t+1;r<i.headerLevelCount+i.leftRowSeriesNumberColumnCount&&o===i.getCellId(r,e);r++)a.end.col=r;return a}(t,e,i);else if(i.headerLevelCount<=e){if(i.headerLevelCount<=e&&(null==(n=null==(r=i.columnObjects[t-i.leftRowSeriesNumberColumnCount])?void 0:r.define)?void 0:n.mergeCell)){let r=i._table.getCellValue(t,e);for(let n=e-1;n>=i.headerLevelCount;n--){let s=i._table.getCellValue(t,n);if("boolean"==typeof i.columnObjects[t-i.leftRowSeriesNumberColumnCount].define.mergeCell){if(r!==s)break}else if(!i.columnObjects[t-i.leftRowSeriesNumberColumnCount].define.mergeCell(r,s,{source:{col:t,row:e},target:{col:t,row:n},table:i._table}))break;l.start.row=n}for(let n=e+1;n<i.rowCount;n++){let s=i._table.getCellValue(t,n);if("boolean"==typeof i.columnObjects[t-i.leftRowSeriesNumberColumnCount].define.mergeCell){if(r!==s)break}else if(!i.columnObjects[t-i.leftRowSeriesNumberColumnCount].define.mergeCell(r,s,{source:{col:t,row:e},target:{col:t,row:n},table:i._table}))break;l.end.row=n}}!function(t,e,i,r){if("tree"!==r.rowHierarchyType)return;let n=r._table.getCellRawRecord(t,e);r._table.internalProps.groupTitleCheckbox&&r._table.internalProps.rowSeriesNumber?(null==n?void 0:n.vtableMerge)&&t>=r.leftRowSeriesNumberColumnCount&&(i.start.col=r.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount,i.end.col=r.colCount-1,i.start.row=i.end.row=e):(null==n?void 0:n.vtableMerge)&&(i.start.col=r.rowHeaderLevelCount,i.end.col=r.colCount-1,i.start.row=i.end.row=e)}(t,e,l,i)}else{let r=i.getCellId(t,e);for(let n=t-1;n>=0&&r===i.getCellId(n,e);n--)l.start.col=n;for(let n=t+1;n<(null!=(s=i.colCount)?s:0)&&r===i.getCellId(n,e);n++)l.end.col=n;for(let n=e-1;n>=0&&r===i.getCellId(t,n);n--)l.start.row=n;for(let n=e+1;n<i.headerLevelCount&&r===i.getCellId(t,n);n++)l.end.row=n}return i._cellRangeMap.set(`$${t}$${e}`,l),l}(t,e,this)}isCellRangeEqual(t,e,i,r){let n=this.getCellRange(t,e),s=this.getCellRange(i,r);return n.start.col===s.start.col&&n.end.col===s.end.col&&n.start.row===s.start.row&&n.end.row===s.end.row}getRecordShowIndexByCell(t,e){let i=this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount;return this.transpose?t<i?-1:t-i:e<i?-1:e-i}getRecordStartRowByRecordIndex(t){return(this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount)+t}_calculateMaxDepth(t,e=0){let i=e;return t.forEach(t=>{if(t.columns&&t.columns.length>0){let r=this._calculateMaxDepth(t.columns,e+1);r>i&&(i=r)}}),i}_addHeaders(t,e,i,n,s){let a=[],o=this._newRow(t,n);return e.forEach(e=>{var h,u,d,c;let p=this._columns.length,g=this.seqId++,f={id:g,title:null!=(h=e.title)?h:e.caption,headerIcon:e.headerIcon,field:e.field,style:e.headerStyle,headerType:null!=(u=e.headerType)?u:"text",dropDownMenu:e.dropDownMenu,define:e,hierarchyState:e.hierarchyState,columnWidthComputeMode:e.columnWidthComputeMode};a[g]=f;let m=t;if(e.levelSpan){m=Math.min(t+e.levelSpan-1,this._columnMaxDepth-1);for(let e=t;e<=m;e++)this._headerCellIds[e]||(this._headerCellIds[e]=[]),void 0===this._headerCellIds[e][p]&&(this._headerCellIds[e][p]=g)}if(s)for(let t=m-1;t>=0;t--)this._headerCellIds[t]&&void 0===this._headerCellIds[t][p]&&void 0!==i[m-s]&&(this._headerCellIds[t][p]=i[m-s]);else for(let t=m-1;t>=0;t--)this._headerCellIds[t]&&void 0===this._headerCellIds[t][p]&&void 0!==i[t]&&(this._headerCellIds[t][p]=i[t]);n?this._headerCellIds[t-1]&&void 0!==this._headerCellIds[t-1][p]&&(o[p]=this._headerCellIds[t-1][p]):o[p]=g;let y=!e.hierarchyState||e.hierarchyState===r.g.expand;if(e.columns&&y)e.columns.every(t=>t.hide)||e.hide||this._addHeaders(m+1,e.columns,[...i,g],e.hideColumnsSubHeader||n,e.levelSpan).forEach(t=>a.push(t));else{let i={id:this.seqId++,field:e.field,fieldFormat:e.fieldFormat,width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth,icon:e.icon,cellType:null!=(c=null!=(d=e.cellType)?d:e.columnType)?c:"text",chartModule:"chartModule"in e?e.chartModule:null,chartSpec:"chartSpec"in e?e.chartSpec:null,sparklineSpec:"sparklineSpec"in e?e.sparklineSpec:l.hW,style:e.style,define:e,columnWidthComputeMode:e.columnWidthComputeMode,disableColumnResize:null==e?void 0:e.disableColumnResize,aggregation:e.aggregation,isChildNode:t>=1};if(this._columnsIncludeHided.push(i),!0!==e.hide){this._columns.push(i);for(let e=t+1;e<this._headerCellIds.length;e++)this._headerCellIds[e][p]=g}}}),a}_newRow(t,e=!1){if(this._headerCellIds[t]){let e=this._headerCellIds[t-1];if(e.length>this._headerCellIds[t].length)for(let i=this._headerCellIds[t].length;i<e.length;i++)this._headerCellIds[t][i]=e[i];return this._headerCellIds[t]}if(e)return[];let i=this._headerCellIds[t]=[];if(!this._columns.length)return i;let r=this._headerCellIds[t-1];for(let t=0;t<r.length;t++)i[t]=r[t];return i}getCellHeaderPaths(t,e){if(this.isSeriesNumber(t,e))return;let i=[],r=[];return this.transpose?r=[{field:this._columns[e].field}]:i=[{field:this._columns[t-this.leftRowSeriesNumberColumnCount].field}],{colHeaderPaths:i,rowHeaderPaths:r,cellLocation:this.getCellLocation(t,e)}}getParentCellId(t,e){if(0!==e){if(this.isColumnHeader(t,e))return this.getCellId(t,e-1);if(this.isRowHeader(t,e)){if(this.isSeriesNumberInBody(t-1,e))return;return this.getCellId(t-1,e)}}}canMoveHeaderPosition(t,e){if(this.isSeriesNumberInHeader(e.col,e.row)||this.isSeriesNumberInHeader(t.col,t.row))return!1;if(!this.transpose&&this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)){let i=this.getRecordShowIndexByCell(0,t.row),r=this.getRecordShowIndexByCell(0,e.row);return this._table.dataSource.canChangeOrder(i,r)}if(this.transpose&&this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)&&(this.getBody(t.col+this.leftRowSeriesNumberColumnCount,t.row).isChildNode&&this.getBody(e.col+this.leftRowSeriesNumberColumnCount,e.row).isChildNode?(t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1):(t.col=t.col+this.leftRowSeriesNumberColumnCount,e.col=e.col+this.leftRowSeriesNumberColumnCount)),t.col<0||t.row<0||e.col<0||e.row<0||"disabled"===this._table.internalProps.frozenColDragHeaderMode&&this._table.isFrozenColumn(e.col))return!1;let i=this.getCellRange(t.col,t.row);return this.isColumnHeader(t.col,t.row)?this.getParentCellId(t.col,i.start.row)===this.getParentCellId(e.col,i.start.row):!!this.isRowHeader(t.col,t.row)&&this.getParentCellId(i.start.col,t.row)===this.getParentCellId(i.start.col,e.row)}moveHeaderPosition(t,e){var i,r;if((!(null==(i=this._table.options.dragOrder)?void 0:i.validateDragOrderOnEnd)||(null==(r=this._table.options.dragOrder)?void 0:r.validateDragOrderOnEnd(t,e)))&&this.canMoveHeaderPosition(t,e)){let i=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row)){let r,n=i.end.col-i.start.col+1,s=this.getCellRange(e.col,i.start.row);if((r=e.col>=t.col?s.end.col-n+1:s.start.col)===i.start.col)return null;for(let t=0;t<this._headerCellIds.length;t++){let e=this._headerCellIds[t].splice(i.start.col-this.leftRowSeriesNumberColumnCount,n);e.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._headerCellIds[t],e)}let l=this._columns.splice(i.start.col-this.leftRowSeriesNumberColumnCount,n);return l.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columns,l),this.columnTree.movePosition(i.start.row,i.start.col-this.leftRowSeriesNumberColumnCount,r-this.leftRowSeriesNumberColumnCount),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:i.start.col,targetIndex:r,sourceSize:n,targetSize:s.end.col-s.start.col+1,moveType:"column"}}if(this.isRowHeader(t.col,t.row)||this.isSeriesNumberInBody(t.col,t.row)&&this.transpose){let r;this.isSeriesNumberInBody(t.col,t.row)&&(i=this.getCellRange(t.col+this.leftRowSeriesNumberColumnCount,t.row));let n=i.end.row-i.start.row+1,s=this.getCellRange(i.start.col,e.row);if((r=e.row>=t.row?s.end.row-n+1:s.start.row)===i.start.row)return null;for(let t=0;t<this._headerCellIds.length;t++){let e=this._headerCellIds[t].splice(i.start.row,n);e.unshift(r,0),Array.prototype.splice.apply(this._headerCellIds[t],e)}let l=this._columns.splice(i.start.row,n);return l.unshift(r,0),Array.prototype.splice.apply(this._columns,l),this.columnTree.movePosition(i.start.col-this.leftRowSeriesNumberColumnCount,i.start.row,r+(e.row>t.row?i.end.row-i.start.row:0)),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:i.start.row,targetIndex:r,sourceSize:n,targetSize:s.end.row-s.start.row+1,moveType:"row"}}if(this.isSeriesNumberInBody(t.col,t.row))return{sourceIndex:t.row,targetIndex:e.row,sourceSize:1,targetSize:1,moveType:"row"}}return null}toggleHierarchyState(t){return{addCellPositions:t.add.map(t=>({col:0,row:this._table.columnHeaderLevelCount+t})),removeCellPositions:t.remove.map(t=>({col:0,row:this._table.columnHeaderLevelCount+t}))}}setChartInstance(t,e,i){let r=this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount];"function"!=typeof r.chartSpec&&(r.chartInstance=i)}getChartInstance(t,e){return(this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]).chartInstance}checkHasChart(){return(0,a.YL)(this)}getAxisConfigInPivotChart(t,e){}isEmpty(t,e){return!1}isAxisCell(t,e){return!1}getChartAxes(t,e){return[]}isShareChartSpec(t,e){let i=this.getBody(t,e);return"function"!=typeof(null==i?void 0:i.chartSpec)}isNoChartDataRenderNothing(t,e){let i=this.getBody(t,e);return(null==i?void 0:i.define).noDataRenderNothing}getChartSpec(t,e){return this.getRawChartSpec(t,e)}getRawChartSpec(t,e){let i=this.getBody(t,e),r=null==i?void 0:i.chartSpec;return"function"==typeof r?r({col:t,row:e,dataValue:this._table.getCellOriginValue(t,e)||"",value:this._table.getCellValue(t,e)||"",rect:this._table.getCellRangeRelativeRect(this._table.getCellRange(t,e)),table:this._table}):r}getChartDataId(t,e){return(0,a.py)(t,e,this)}release(){let t=this._table._getActiveChartInstance();null==t||t.release(),this.columnObjects.forEach(t=>{var e;null==(e=t.chartInstance)||e.release()})}clearCellRangeMap(){this._cellRangeMap.clear()}updateColumnTitle(t,e,i){let r=this._table.internalProps.layoutMap.getHeader(t,e);r.title=i,r.define.title=i}getColumnByField(t){var e;return null==(e=this.columnObjects)?void 0:e.reduce((e,i,r)=>(i.field===t&&e.push({col:r,columnDefine:i}),e),[])}getColumnByKey(t){var e;let i;return{columnDefine:null==(e=this.columnObjects)?void 0:e.find((e,r)=>{var n;return(null==(n=e.define)?void 0:n.key)===t&&(i=r+this.leftRowSeriesNumberColumnCount,!0)}),col:i}}getColumnDefine(t,e){if(t>=0)return t<this.leftRowSeriesNumberColumnCount?this.leftRowSeriesNumberColumn[t].define:this.transpose?this._columns[e].define:this._columns[t-this.leftRowSeriesNumberColumnCount].define}}var d=i(43735),c=i(59885),p=i(49746),g=i(99506),f=i(84375),m=i(85865),y=i(84826),v=i(7430),b=i(12588),_=i(30394),x=i(70656),C=i(81137),w=i(13844),S=i(58853);function A(t,e){return(0,S.Z)(t)?{groupByRules:[t],addRecordRule:e}:(0,d.Z)(t)?{groupByRules:t.map(t=>(0,S.Z)(t)?t:t.key),addRecordRule:e}:{addRecordRule:e}}var M=i(83922),k=i(92062),T=i(57657),R=i(58977);function B(t){let e=t.sortState;(e=!e||Array.isArray(e)?e:[e])&&(e=e.map(e=>{var i;return e.orderFn=null!=(i=t._getSortFuncFromHeaderOption(void 0,e.field))?i:b.K$,e}),t.dataSource.sort(e))}function P(t,e,i){let{checkedState:r}=t.stateManager;if(r)if("tree"===t.dataSource.rowHierarchyType){let t,n=(t=(0,R.Z)(e)?[e]:e).length,s=[];r.forEach((e,r)=>{var l;let a=r.split(",");if(a.length>=t.length)for(let o=0;o<a.length;o++){let h=null!=(l=t[o])?l:-1,u=Number(a[o]);if(!(h===u&&o<a.length-1)){if(h===u&&o===a.length-1||-1===h){s.push({originKey:r,value:e});break}h<u&&o===n-1&&(a[o]=(u-i).toString(),s.push({originKey:r,targetKey:a.toString(),value:e}));break}}}),s.sort((t,e)=>{let i=t.originKey.split(","),r=e.originKey.split(","),n=i.length,s=r.length,l=Math.min(n,s);for(let t=0;t<l;t++){let e=Number(i[t]),n=Number(r[t]);if(e!==n)return e-n}return n-s}),s.forEach(({originKey:t,targetKey:e,value:i})=>{r.delete(t),e&&r.set(e,i)})}else{let t=[],n=[];r.forEach((r,s)=>{let l=Number(s);!isNaN(l)&&l>=e&&(l===e?t.push(s):l>e&&n.push({originKey:s,targetKey:(l-i).toString(),value:r}))}),t.forEach(t=>r.delete(t)),n.forEach(({originKey:t,targetKey:e,value:i})=>{r.delete(t),r.set(e,i)})}}function E(t,e,i){let{checkedState:r}=t.stateManager;if(r)if("tree"===t.dataSource.rowHierarchyType){let t,n=(t=(0,R.Z)(e)?[e]:e).length,s=[];r.forEach((e,r)=>{var l;let a=r.split(",");if(a.length>=t.length)for(let o=0;o<a.length;o++){let h=null!=(l=t[o])?l:-1,u=Number(a[o]);if(h===u&&(o===a.length-1||o===n-1)){a[o]=(u+i).toString(),s.push({originKey:r,targetKey:a.toString(),value:e});break}if(!(h===u&&o<a.length-1)){h<u&&o===n-1&&(a[o]=(u+i).toString(),s.push({originKey:r,targetKey:a.toString(),value:e}));break}}}),s.sort((t,e)=>{let i=t.originKey.split(","),r=e.originKey.split(","),n=i.length,s=r.length,l=Math.min(n,s);for(let t=0;t<l;t++){let e=Number(i[t]),n=Number(r[t]);if(e!==n)return-e+n}return-n+s}),s.forEach(({originKey:t,targetKey:e,value:i})=>{r.delete(t),e&&r.set(e,i)})}else for(let t=r.size-1;t>=e;t--){let e=r.get(t.toString());r.delete(t.toString()),r.set((t+i).toString(),e)}}var I=i(79809),L=i(91254);class F extends p.D{constructor(t,e){var i,r,n,l,a,o,h,u;super(t,e),this.showHeader=!0,e=this.options;let d=this.internalProps;if(d.frozenColDragHeaderMode=null!=(r=null==(i=e.dragOrder)?void 0:i.frozenColDragHeaderMode)?r:e.frozenColDragHeaderMode,this.pagination=e.pagination,d.sortState=e.sortState,d.multipleSort=!!e.multipleSort,d.dataConfig=this.internalProps.groupBy?A(this.internalProps.groupBy,e.addRecordRule):{addRecordRule:e.addRecordRule},d.columns=e.columns?(0,x.u)(e.columns,["children"]):e.header?(0,x.u)(e.header,["children"]):[],(0,c.rQ)(this),d.enableTreeNodeMerge=null!=(l=null!=(n=e.enableTreeNodeMerge)?n:(0,s.Z)(this.internalProps.groupBy))&&l,this.internalProps.headerHelper.setTableColumnsEditor(),this.showHeader=null==(a=e.showHeader)||a,this.internalProps.columnWidthConfig=e.columnWidthConfig,this.transpose=null!=(o=e.transpose)&&o,"node"!==f.X.mode&&(this.editorManager=new y.$(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,e.dataSource?this.dataSource=e.dataSource:e.records?this.setRecords(e.records,{sortState:d.sortState}):this.setRecords([]),e.title&&(d.title=new(w.F.getComponent("title"))(e.title,this)),this.options.emptyTip)if(this.internalProps.emptyTip)null==(h=this.internalProps.emptyTip)||h.resetVisible();else{let t=w.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(u=this.internalProps.emptyTip)||u.resetVisible()}if(this.internalProps.enableTreeStickCell){let t=w.F.getComponent("listTreeStickCellPlugin");this.listTreeStickCellPlugin=new t(this)}setTimeout(()=>{this.isReleased||(this.resize(),this.fireListeners(g.B.INITIALIZED,null))},0)}isListTable(){return!0}isPivotTable(){return!1}isPivotChart(){return!1}get sortState(){return this.internalProps.sortState}get records(){var t;return null==(t=this.dataSource)?void 0:t.records}get recordsCount(){return this.dataSource.records.length}updateColumns(t,e){var i,r,n,s;this.scenegraph.clearCells();let l={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.columns=(0,x.u)(t,["children"]),(0,c.rQ)(this),(null==e?void 0:e.clearColWidthCache)&&this.internalProps._widthResizedColMap.clear(),this.options.columns=t,this.internalProps.headerHelper.setTableColumnsEditor(),this._hasAutoImageColumn=void 0,this.refreshHeader(),null==(r=(i=this.dataSource).updateColumns)||r.call(i,this.internalProps.columns),this.records&&(0,c.bW)(this.internalProps.columns)&&this.dataSource.processRecords(null!=(s=null==(n=this.dataSource.dataSourceObj)?void 0:n.records)?s:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(l.col,l.row),this.renderAsync(),this.eventManager.updateEventBinder()}_recreateSceneForStateChange(){var t,e;this.scenegraph.clearCells();let i={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this._hasAutoImageColumn=void 0,this.refreshHeader(),this.records&&(0,c.bW)(this.internalProps.columns)&&this.dataSource.processRecords(null!=(e=null==(t=this.dataSource.dataSourceObj)?void 0:t.records)?e:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this._updateSize(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(i.col,i.row),this.renderAsync(),this.eventManager.updateEventBinder()}addColumns(t,e,i=!0){let r=this.options.columns;if(void 0===e?(e=r.length,r.push(...t)):r.splice(e,0,...t),i){for(let t=0;t<r.length;t++)r[t].field=t;for(let i=0;i<this.records.length;i++){let r=this.records[i];Array.isArray(r)&&r.splice(e,0,...Array(t.length).fill(void 0))}}this.updateColumns(r),this.fireListeners(g.B.ADD_COLUMN,{columnIndex:e,columnCount:t.length,columns:r})}deleteColumns(t,e=!0){let i=this.options.columns;t.sort((t,e)=>e-t);for(let r=0;r<t.length;r++)if(i.splice(t[r],1),e)for(let e=0;e<this.records.length;e++){let i=this.records[e];Array.isArray(i)&&i.splice(t[r],1)}if(e)for(let t=0;t<i.length;t++)i[t].field=t;this.updateColumns(i),this.fireListeners(g.B.DELETE_COLUMN,{deleteColIndexs:t,columns:i})}get columns(){return this.internalProps.layoutMap.columnTree.getCopiedTree()}get header(){return this.internalProps.columns}set header(t){this.internalProps.columns=t,(0,c.rQ)(this),this.options.header=t,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.renderAsync()}get transpose(){var t;return null!=(t=this.internalProps.transpose)&&t}set transpose(t){this.internalProps.transpose!==t&&(this.internalProps.transpose=t,this.internalProps.layoutMap&&(this.internalProps.layoutMap.transpose=t,this.refreshRowColCount(),this._resetFrozenColCount(),this.renderAsync()))}getCellValue(t,e,i){var r;if(-1===t||-1===e)return null;if(!i){let i=this.getCustomMergeValue(t,e);if(i)return i}if(this.internalProps.layoutMap.isSeriesNumber(t,e)){let i;if(this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getSeriesNumberHeader(t,e);return i}if(this.internalProps.groupBy){let r=this.getCellRawRecord(t,e);if(null==r?void 0:r.vtableMerge)return"";this.internalProps.layoutMap.isAggregation(t,e)||(i=this.dataSource.getGroupSeriesNumber(e-this.columnHeaderLevelCount))}else{let n=this.getBodyColumnDefine(t,e),s=this.getFieldData(n.field,t,e);i=["number","string"].includes(typeof s)?s:(null==s?void 0:s.text)?null!=(r=s.text)?r:"":e-this.columnHeaderLevelCount+1}let{format:n}=this.internalProps.layoutMap.getSeriesNumberBody(t,e);return"function"==typeof n?n(t,e,this,i):i}if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}if(this.internalProps.layoutMap.isAggregation(t,e)){if(this.internalProps.layoutMap.isTopAggregation(t,e)){let i=this.internalProps.layoutMap.getAggregatorOnTop(t,e);return(null==i?void 0:i.formatValue)?i.formatValue(t,e,this):""}if(this.internalProps.layoutMap.isBottomAggregation(t,e)){let i=this.internalProps.layoutMap.getAggregatorOnBottom(t,e);return(null==i?void 0:i.formatValue)?i.formatValue(t,e,this):""}}let{field:n,fieldFormat:s}=this.internalProps.layoutMap.getBody(t,e);return this.getFieldData(s||n,t,e)}getCellOriginValue(t,e){if(-1===t||-1===e)return null;if(this.internalProps.layoutMap.isSeriesNumber(t,e)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getSeriesNumberHeader(t,e);return i}let{format:i}=this.internalProps.layoutMap.getSeriesNumberBody(t,e);return"function"==typeof i?i(t,e,this):e-this.columnHeaderLevelCount}if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}if(this.internalProps.layoutMap.isAggregation(t,e)){if(this.internalProps.layoutMap.isTopAggregation(t,e)){let i=this.internalProps.layoutMap.getAggregatorOnTop(t,e);return null==i?void 0:i.value()}if(this.internalProps.layoutMap.isBottomAggregation(t,e)){let i=this.internalProps.layoutMap.getAggregatorOnBottom(t,e);return null==i?void 0:i.value()}}let{field:i}=this.internalProps.layoutMap.getBody(t,e);return this.getFieldData(i,t,e)}getCellRawValue(t,e){if(-1===t||-1===e)return null;if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}let{field:i}=this.internalProps.layoutMap.getBody(t,e);return this.getRawFieldData(i,t,e)}getRecordShowIndexByCell(t,e){let{layoutMap:i}=this.internalProps;return i.getRecordShowIndexByCell(t,e)}getRecordIndexByCell(t,e){let{layoutMap:i}=this.internalProps,r=i.getRecordShowIndexByCell(t,e);return this.dataSource.getRecordIndexPaths(r)}getTableIndexByRecordIndex(t){return this.transpose?this.dataSource.getTableIndex(t)+this.rowHeaderLevelCount:this.dataSource.getTableIndex(t)+this.columnHeaderLevelCount}getTableIndexByField(t){let e=this.internalProps.layoutMap.columnObjects.find(e=>e.field===t);if(!e)return -1;let i=this.internalProps.layoutMap.getBodyLayoutRangeById(e.id);return this.transpose?i.start.row:i.start.col}getCellAddrByFieldRecord(t,e){return this.transpose?{col:this.getTableIndexByRecordIndex(e),row:this.getTableIndexByField(t)}:{col:this.getTableIndexByField(t),row:this.getTableIndexByRecordIndex(e)}}getCellOriginRecord(t,e){let i=this.getRecordShowIndexByCell(t,e);if(i>-1)return this.dataSource.get(i)}getCellRawRecord(t,e){let i=this.getRecordShowIndexByCell(t,e);if(i>-1)return this.dataSource.getRaw(i)}_canResizeColumn(t,e){let i=super._canResizeColumn(t,e);if(i&&!this.transpose){let i=this.internalProps.layoutMap.getBody(t,this.columnHeaderLevelCount),r=this.internalProps.layoutMap.isSeriesNumber(t,e);if((null==i?void 0:i.disableColumnResize)||r&&!0===this.internalProps.rowSeriesNumber.disableColumnResize)return!1}return i}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,n,l,a,o,h,u,d;let p=this.internalProps;if(super.updateOption(t,e),p.frozenColDragHeaderMode=null!=(r=null==(i=t.dragOrder)?void 0:i.frozenColDragHeaderMode)?r:t.frozenColDragHeaderMode,this.pagination=t.pagination,p.sortState=t.sortState,p.dataConfig=this.internalProps.groupBy?A(this.internalProps.groupBy,t.addRecordRule):{addRecordRule:t.addRecordRule},this.showHeader=null==(n=t.showHeader)||n,p.columns=t.columns?(0,x.u)(t.columns,["children"]):t.header?(0,x.u)(t.header,["children"]):[],(0,c.rQ)(this),p.enableTreeNodeMerge=null!=(a=null!=(l=t.enableTreeNodeMerge)?l:(0,s.Z)(this.internalProps.groupBy))&&a,this.internalProps.headerHelper.setTableColumnsEditor(),this.transpose=null!=(o=t.transpose)&&o,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.internalProps.columnWidthConfig=t.columnWidthConfig,p.releaseList)for(let t=p.releaseList.length-1;t>=0;t--){let e=p.releaseList[t];e instanceof M.o2?e.updateColumns(this.internalProps.columns):(null==(h=null==e?void 0:e.release)||h.call(e),p.releaseList.splice(t,1))}if(t.dataSource&&this.dataSource!==t.dataSource?this.dataSource=t.dataSource:t.records?this.setRecords(t.records,{sortState:t.sortState}):(this.refreshRowColCount(),this._resetFrozenColCount(),this.scenegraph.createSceneGraph(),this.render()),t.title&&(p.title=new(w.F.getComponent("title"))(t.title,this),this.scenegraph.resize()),this.options.emptyTip)if(this.internalProps.emptyTip)null==(u=this.internalProps.emptyTip)||u.resetVisible();else{let t=w.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(d=this.internalProps.emptyTip)||d.resetVisible()}return this.pluginManager.updatePlugins(t.plugins),setTimeout(()=>{this.fireListeners(g.B.UPDATED,null)},0),new Promise(t=>{setTimeout(t,0)})}updatePagination(t){this.pagination&&("number"==typeof t.currentPage&&t.currentPage>=0&&(this.pagination.currentPage=t.currentPage),t.perPageCount&&(this.pagination.perPageCount=t.perPageCount||this.pagination.perPageCount),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.dataSource.updatePagination(this.pagination),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.renderAsync())}refreshHeader(){var t;let e=this.internalProps,i=this.transpose,r=this.showHeader;(e.layoutMap=new u(this,null!=(t=e.columns)?t:[],r,this.options.hierarchyIndent)).transpose=i,i||this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y;let{layoutMap:v}=this.internalProps;if(!v)return;let b=null!=(e=null==(t=this.internalProps.dataSource)?void 0:t.length)?e:0;v.recordsCount=b+(b>0||this.options.showAggregationWhenEmpty?v.hasAggregationOnTopCount+v.hasAggregationOnBottomCount:0),this.transpose?(this.rowCount=null!=(i=v.rowCount)?i:0,this.colCount=null!=(r=v.colCount)?r:0,this.internalProps.frozenColCount=Math.max((null!=(n=v.headerLevelCount)?n:0)+v.leftRowSeriesNumberColumnCount,null!=(s=this.options.frozenColCount)?s:0),this.internalProps.frozenRowCount=null!=(l=this.options.frozenRowCount)?l:0,this.bottomFrozenRowCount!==(null!=(a=this.options.bottomFrozenRowCount)?a:0)&&(this.bottomFrozenRowCount=null!=(o=this.options.bottomFrozenRowCount)?o:0),this.rightFrozenColCount!==(null!=(h=this.options.rightFrozenColCount)?h:0)&&(this.rightFrozenColCount=null!=(u=this.options.rightFrozenColCount)?u:0)):(this.colCount=null!=(d=v.colCount)?d:0,this.rowCount=v.recordsCount*v.bodyRowSpanCount+v.headerLevelCount,this.internalProps.frozenColCount=null!=(c=this.options.frozenColCount)?c:0,this.options.frozenColCount>=this.colCount&&(this.internalProps.frozenColCount=0),this._setFrozenRowCount(Math.max(v.headerLevelCount,null!=(p=this.options.frozenRowCount)?p:0)),this.bottomFrozenRowCount!==(null!=(g=this.options.bottomFrozenRowCount)?g:0)&&(this.bottomFrozenRowCount=null!=(f=this.options.bottomFrozenRowCount)?f:0),this.rightFrozenColCount!==(null!=(m=this.options.rightFrozenColCount)?m:0)&&(this.rightFrozenColCount=null!=(y=this.options.rightFrozenColCount)?y:0)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}getFieldData(t,e,i){if(null===t||this.internalProps.layoutMap.isHeader(e,i))return null;let r=this.getRecordShowIndexByCell(this.transpose?e-this.internalProps.layoutMap.leftRowSeriesNumberColumnCount:e,i);return this.internalProps.dataSource.getField(r,t,e,i,this)}getRawFieldData(t,e,i){if(null===t||this.internalProps.layoutMap.isHeader(e,i))return null;let r=this.getRecordShowIndexByCell(e,i);return this.internalProps.dataSource.getRawField(r,t,e,i,this)}_moveHeaderPosition(t,e){let i=this.getCellRange(t.col,t.row),r=this.getCellRange(e.col,e.row),n=this.internalProps.layoutMap.moveHeaderPosition(t,e);return n?("column"===n.moveType?(this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,r.start.col,r.end.col-r.start.col+1,n.targetIndex),this.transpose||(this.colWidthsLimit={},this.setMinMaxLimitWidth())):n.targetIndex>n.sourceIndex?this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex+n.sourceSize-n.targetSize,n.targetSize,n.targetIndex):this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex,n.targetSize,n.targetIndex),n):null}changeRecordOrder(t,e){this.transpose?(t=this.getRecordShowIndexByCell(t,0),e=this.getRecordShowIndexByCell(e,0)):(t=this.getRecordShowIndexByCell(0,t),e=this.getRecordShowIndexByCell(0,e)),this.dataSource.changeOrder(t,e)}getCellAddress(t,e){let i;for(let e=0;e<this.internalProps.records.length;e++){let r=this.internalProps.records[e];if("function"==typeof t)t(r)&&(i=e);else{let n=!0;for(let e in t)if(r[e]!==t[e]){n=!1;break}n&&(i=e)}if((0,s.Z)(i))break}let r=this.getCellRangeByField(e,i);if(r)return{row:r.start.row,col:r.start.col}}getCellRangeByField(t,e){let{layoutMap:i}=this.internalProps,r=i.columnObjects.find(e=>e.field===t);if(r){let t,n=i.getBodyLayoutRangeById(r.id);return(0,s.Z)(e)&&(t=i.getRecordStartRowByRecordIndex(e)),this.transpose?{start:{row:n.start.row,col:(0,s.Z)(t)?t+n.start.col:void 0},end:{row:n.end.row,col:(0,s.Z)(t)?t+n.end.col:void 0}}:{start:{col:n.start.col,row:(0,s.Z)(t)?t+n.start.row:void 0},end:{col:n.end.col,row:(0,s.Z)(t)?t+n.end.row:void 0}}}return null}getHierarchyState(t,e){var i;if(this.isHeader(t,e))return null==(i=this._getHeaderLayoutMap(t,e))?void 0:i.hierarchyState;if((!this.internalProps.groupBy||(0,d.Z)(this.internalProps.groupBy)&&0===this.internalProps.groupBy.length)&&!this.getBodyColumnDefine(t,e).tree)return r.g.none;let n=this.getRecordShowIndexByCell(t,e);return this.dataSource.getHierarchyState(n)}getRecordHierarchyState(t,e){let i;return this.transpose?this.getRecordShowIndexByCell(t,0):i=this.getRecordShowIndexByCell(0,e),this.dataSource.getHierarchyState(i)}toggleHierarchyState(t,e,i=!0){this.stateManager.updateHoverIcon(t,e,void 0,void 0);let n=this.getHierarchyState(t,e);if(this.isHeader(t,e)){let i=this.internalProps.layoutMap.getHeader(t,e),{hierarchyState:s,define:l}=i;if(![r.g.collapse,r.g.expand].includes(s)||!l)return;let a=l.columns;if(Array.isArray(a)&&a.length>0){let t=s===r.g.expand?r.g.collapse:r.g.expand;i.hierarchyState=t,i.define.hierarchyState=t,this.updateColumns(this.internalProps.columns)}this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:n,originData:i,cellLocation:this.getCellLocation(t,e)})}else if(n===r.g.expand)this._refreshHierarchyState(t,e,i),this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:r.g.collapse});else if(n===r.g.collapse){let n=this.getCellOriginRecord(t,e);Array.isArray(n.children)&&this._refreshHierarchyState(t,e,i),this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:r.g.expand,originData:n})}}setLoadingHierarchyState(t,e){this.scenegraph.setLoadingHierarchyState(t,e)}_refreshHierarchyState(t,e,i=!0){var r,n;let s=!1,l=!1,a=this.internalProps.layoutMap.checkHasChart();a&&(this.autoFillWidth&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight));let o=this.getRecordShowIndexByCell(t,e),h=this.dataSource.toggleHierarchyState(o,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount,Math.max(this.scenegraph.proxy.rowEnd-this.columnHeaderLevelCount,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount+this.scenegraph.proxy.rowLimit-1)),u=this.internalProps.layoutMap.toggleHierarchyState(h);this.refreshRowColCount();for(let t=this.rowCount-this.bottomFrozenRowCount;t<this.rowCount;t++){let e=(0,v.P)(t,0,this.colCount-1,this);this._setRowHeight(t,e)}this.clearCellStyleCache(),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1;let{updateCells:d,addCells:c,removeCells:p}=function(t,e,i,r){let n=[{col:e,row:i}],s=[],l=[],{addCellPositions:a,removeCellPositions:o}=t,h=r.scenegraph.proxy,{rowStart:u,rowLimit:d}=h,{rowEnd:c}=h,p=1/0;for(let t=0;t<a.length;t++){let{row:i}=a[t];c-u+1===d?i>=u&&i<=c&&(p=Math.min(p,i)):(s.push({col:e,row:i}),c++)}let g=Math.min(u+d,r.rowCount-1-r.bottomFrozenRowCount),f=g<u+d;for(let t=0;t<o.length;t++){let{row:i}=o[o.length-t-1];i<u||i>c||(i>g||f?(l.push({col:e,row:i}),p--):p=Math.min(p,i))}if(p!==1/0)for(let t=p;t<=c;t++)n.push({col:e,row:t});return r.scenegraph.proxy.refreshRowCount(),{updateCells:n,addCells:s,removeCells:l}}(u,t,e,this);null==(r=this.reactCustomLayout)||r.clearCache(),this.scenegraph.updateRow(p,c,d,i,!0),null==(n=this.reactCustomLayout)||n.updateAllCustomCell(),a&&(this.autoFillWidth&&!s&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!l&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight),("adaptive"===this.widthMode||s||"adaptive"===this.heightMode||l)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}_hasHierarchyTreeHeader(){var t,e;return null==(e=null!=(t=this.options.columns)?t:this.options.header)?void 0:e.some((t,e)=>t.tree)}getMenuInfo(t,e,i){return{field:this.getHeaderField(t,e),value:this.getCellValue(t,e),cellLocation:this.getCellLocation(t,e),event:void 0}}_getSortFuncFromHeaderOption(t,e,i){if(t||(t=this.internalProps.columns),e&&t&&t.length>0)for(let r=0;r<t.length;r++){let n=t[r];if((i&&i===n.fieldKey||!i&&n.field===e)&&n.sort&&"function"==typeof n.sort)return n.sort;if(n.columns){let t=this._getSortFuncFromHeaderOption(n.columns,e,i);if(t)return t}}}updateSortState(t,e=!0){var i;if(t)this.internalProps.sortState=t;else if(this.internalProps.sortState)if(Array.isArray(this.internalProps.sortState))for(let e=0;e<this.internalProps.sortState.length;e++)(t=null==(i=this.internalProps.sortState)?void 0:i[e])&&(t.order="normal");else this.internalProps.sortState.order="normal",t=this.internalProps.sortState;(t=Array.isArray(t)?t:[t]).some(t=>t.field)&&e&&this.internalProps.layoutMap.headerObjects.some(t=>!1!==t.define.sort)&&(this.dataSource.sort(t.map(t=>{let e=this._getSortFuncFromHeaderOption(this.internalProps.columns,t.field);return this.internalProps.layoutMap.headerObjects.find(e=>e&&e.field===t.field),{field:t.field,order:t.order,orderFn:null!=e?e:b.K$}})),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.sortCell()),t.length&&this.stateManager.updateSortState(t)}updateFilterRules(t){this.scenegraph.clearCells(),this.sortState?(this.dataSource.updateFilterRulesForSorted(t),B(this)):this.dataSource.updateFilterRules(t),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.resize()}getFilteredRecords(){return this.dataSource.records}getCheckboxState(t){if(this.stateManager.checkedState.size<this.rowCount-this.columnHeaderLevelCount&&this.stateManager.initLeftRecordsCheckState(this.records),(0,s.Z)(t)){let e=Array.from(this.stateManager.checkedState.keys()).sort((t,e)=>{var i,r;let n=t.split(","),s=e.split(","),l=Math.max(n.length,s.length);for(let t=0;t<l;t++){let e=null!=(i=Number(n[t]))?i:0,l=null!=(r=Number(s[t]))?r:0;if(e!==l)return e-l}return 0}).map(t=>this.stateManager.checkedState.get(t));return this.options.groupBy&&(e=(0,C.aC)(this)),Array.from(e,e=>e&&e[t])}return Array(...this.stateManager.checkedState.values())}getCellCheckboxState(t,e){var i;let r=this.getBodyColumnDefine(t,e),n=null==r?void 0:r.field,l=this.getCellType(t,e);if((0,s.Z)(n)&&("checkbox"===l||"switch"===l)){let r=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)).toString();return null==(i=this.stateManager.checkedState.get(r))?void 0:i[n]}}getRadioState(t){return(0,s.Z)(t)?this.stateManager.radioState[t]:this.stateManager.radioState}getCellRadioState(t,e){return(0,_.Wg)(t,e,this)}setCellCheckboxState(t,e,i){(0,C.Jd)(t,e,i,this)}setCellRadioState(t,e,i){(0,_.vj)(t,e,i,this)}getSwitchState(t){return this.getCheckboxState(t)}getCellSwitchState(t,e){return this.getCellCheckboxState(t,e)}setCellSwitchState(t,e,i){this.setCellCheckboxState(t,e,i)}setRecords(t,e){var i,r,n,l;let a;(0,I.H6)(),null==(i=this.internalProps.dataSource)||i.release(),this.internalProps.releaseList=null==(r=this.internalProps.releaseList)?void 0:r.filter(t=>!t.dataSourceObj),this.internalProps.dataSource=null,Array.isArray(e)||(null==e?void 0:e.order)?a=e:e?a=e.sortState:null===e&&(a=null),"undefined"!=typeof window&&window.performance.now();let o={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};if(this.scenegraph.clearCells(),void 0!==a&&(null===a||!Array.isArray(a)&&(0,s.Z)(a.field)||Array.isArray(a))&&(this.internalProps.sortState=this.internalProps.multipleSort?Array.isArray(a)?a:[a]:a,this.stateManager.setSortState(this.sortState)),t){if((0,c.mP)(this,t),this.sortState){let t=Array.isArray(this.sortState)?this.sortState:[this.sortState];t.some(t=>t.order&&t.field&&"normal"!==t.order)&&this.internalProps.layoutMap.headerObjectsIncludeHided.some(t=>!1!==t.define.sort)&&this.dataSource.sort(t.map(t=>{let e=this._getSortFuncFromHeaderOption(void 0,t.field);return this.internalProps.layoutMap.headerObjectsIncludeHided.find(e=>e&&e.field===t.field),{field:t.field,order:t.order||"asc",orderFn:null!=e?e:b.K$}}))}this.refreshRowColCount()}else(0,c.mP)(this,t);if(this.stateManager.initCheckedState(t),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(o.col,o.row),this._updateSize(),this.internalProps.title&&!this.internalProps.title.isReleased&&this.internalProps.title.resize(),this.scenegraph.resize(),this.options.emptyTip)if(this.internalProps.emptyTip)null==(n=this.internalProps.emptyTip)||n.resetVisible();else{let t=w.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(l=this.internalProps.emptyTip)||l.resetVisible()}this.render(),(0,s.Z)(o.col)&&(0,s.Z)(o.row)&&o.col>=0&&o.row>=0&&setTimeout(()=>{var t;null==(t=this.internalProps)||t.tooltipHandler.showTooltip(o.col,o.row)},0)}setRecordChildren(t,e,i,r=!0){let n=this.getCellOriginRecord(e,i);n.children=t;let s=this.getRecordShowIndexByCell(e,i);this.dataSource.setRecord(n,s),this._refreshHierarchyState(e,i,r)}startEditCell(t,e,i){var r;if((0,s.Z)(t)&&(0,s.Z)(e))this.eventManager.isDraging=!1,this.selectCell(t,e),this.editorManager.startEditCell(t,e,i);else if(null==(r=this.stateManager.select)?void 0:r.cellPos){let{col:t,row:e}=this.stateManager.select.cellPos;(0,s.Z)(t)&&(0,s.Z)(e)&&this.editorManager.startEditCell(t,e,i)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(t,e){var i,r;let n=this.getBodyColumnDefine(t,e),s=this.isHeader(t,e)?null!=(i=null==n?void 0:n.headerEditor)?i:this.options.headerEditor:null!=(r=null==n?void 0:n.editor)?r:this.options.editor;return"function"==typeof s&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),"string"==typeof s?m.U(s):s}isHasEditorDefine(t,e){var i,r;let n=this.getBodyColumnDefine(t,e),l=this.isHeader(t,e)?null!=(i=null==n?void 0:n.headerEditor)?i:this.options.headerEditor:null!=(r=null==n?void 0:n.editor)?r:this.options.editor;return"function"==typeof l&&(l=l({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),(0,s.Z)(l)}changeCellValue(t,e,i,r=!1,n=!0){return function(t,e,i,r,n,s){if(r&&s.isHasEditorDefine(t,e)||!1===r){let r=s.getRecordShowIndexByCell(t,e),{field:l}=s.internalProps.layoutMap.getBody(t,e),a=s.getCellRawValue(t,e),o=s.getCellOriginValue(t,e);s.isHeader(t,e)?s.internalProps.layoutMap.updateColumnTitle(t,e,i):s.dataSource.changeFieldValue(i,r,l,t,e,s);let h=s.getCellRange(t,e),u=s.internalProps.layoutMap.getAggregatorsByCell(t,e);if(u){if(Array.isArray(u))for(let t=0;t<(null==u?void 0:u.length);t++)u[t].recalculate();else u.recalculate();let t=s.internalProps.layoutMap.getAggregatorCellAddress(h.start.col,h.start.row,h.end.col,h.end.row);for(let e=0;e<t.length;e++){let i=s.getCellRange(t[e].col,t[e].row);for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.row;e<=i.end.row;e++)s.scenegraph.updateCellContent(t,e)}}for(let t=h.start.col;t<=h.end.col;t++)for(let e=h.start.row;e<=h.end.row;e++)s.scenegraph.updateCellContent(t,e);if("adaptive"===s.widthMode||s.autoFillWidth&&s.getAllColsWidth()<=s.tableNoFrameWidth)0===s.internalProps._widthResizedColMap.size&&s.scenegraph.recalculateColWidths();else if(!s.internalProps._widthResizedColMap.has(t)){let e=s.getColWidth(t),i=(0,k.al)(t,0,s.rowCount-1,s,!1);i!==e&&s.scenegraph.updateColWidth(t,i-e)}if("adaptive"===s.heightMode||s.autoFillHeight&&s.getAllRowsHeight()<=s.tableNoFrameHeight)0===s.internalProps._heightResizedRowMap.size&&s.scenegraph.recalculateRowHeights();else if(s.isAutoRowHeight(e)&&!s.internalProps._heightResizedRowMap.has(e)){let t=s.getRowHeight(e),i=(0,v.P)(e,0,s.colCount-1,s);s.scenegraph.updateRowHeight(e,i-t)}let d=s.getCellOriginValue(t,e);o!==d&&n&&s.fireListeners(g.B.CHANGE_CELL_VALUE,{col:t,row:e,rawValue:a,currentValue:o,changedValue:d}),s.scenegraph.updateNextFrame()}}(t,e,i,r,n,this)}changeCellValues(t,e,i,r=!1,n=!0){return function(t,e,i,r,n,s){var l,a,o,h,u,d;return o=this,h=void 0,u=void 0,d=function*(){let o,h=[],u=t,d=e,c=[],p=[];for(let r=0;r<i.length&&!(e+r>s.rowCount-1);r++){let n=i[r],l=[],a=[];c.push(l),p.push(a);for(let i=0;i<n.length&&!(t+i>s.colCount-1);i++){o=function(t,e,i,r){if("group"===r||"sort"===r&&!i.internalProps.groupBy)return r;let n="normal";return i.internalProps.groupBy?n="group":!i.isHeader(t,e)&&i.dataSource.lastOrderField&&i.getBodyField(t,e)===i.dataSource.lastOrderField&&(n="sort"),n}(t+i,e+r,s,o);let n=s.getCellRawValue(t+i,e+r);l.push(n);let h=s.getCellOriginValue(t+i,e+r);a.push(h)}}for(let o=0;o<i.length&&!(e+o>s.rowCount-1);o++){h[o]=[],d=e+o;let f=i[o],m=t;for(let i=0;i<f.length&&!(t+i>s.colCount-1);i++){m=t+i;let u=!1;if(!1===r)u=!0;else if(s.isHasEditorDefine(t+i,e+o)){let r=s.getEditor(t+i,e+o),n=p[o][i],h=f[i],d=null==(a=null==(l=null==r?void 0:r.validateValue)?void 0:l.call(r,h,n,{col:t+i,row:e+o},s))||a;if((0,T.tI)(d)){let t=yield d;u=!0===t||"validate-exit"===t||"validate-not-exit"===t}else u=!0===d||"validate-exit"===d||"validate-not-exit"===d}if(u){h[o][i]=!0;let r=f[i],l=s.getRecordShowIndexByCell(t+i,e+o),{field:a}=s.internalProps.layoutMap.getBody(t+i,e+o),u=c[o][i],d=p[o][i];s.isHeader(t+i,e+o)?s.internalProps.layoutMap.updateColumnTitle(t+i,e+o,r):s.dataSource.changeFieldValue(r,l,a,t+i,e+o,s);let m=s.getCellOriginValue(t+i,e+o);d!==m&&n&&s.fireListeners(g.B.CHANGE_CELL_VALUE,{col:t+i,row:e+o,rawValue:u,currentValue:d,changedValue:m})}else h[o][i]=!1}u=Math.max(u,m)}let f=s.getCellRange(t,e),m=s.getCellRange(u,d),y=s.internalProps.layoutMap.getAggregatorsByCellRange(f.start.col,f.start.row,m.end.col,m.end.row);if(y){for(let t=0;t<(null==y?void 0:y.length);t++)y[t].recalculate();if("normal"===o){let t=s.internalProps.layoutMap.getAggregatorCellAddress(f.start.col,f.start.row,m.end.col,m.end.row);for(let e=0;e<t.length;e++){let i=s.getCellRange(t[e].col,t[e].row);for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.row;e<=i.end.row;e++)s.scenegraph.updateCellContent(t,e)}}}if("group"===o&&s.dataSource.updateRecordsForGroup([],[]),"sort"===o||"group"===o)return s.dataSource.sortedIndexMap.clear(),B(s),s.refreshRowColCount(),s.internalProps.layoutMap.clearCellRangeMap(),s.scenegraph.clearCells(),s.scenegraph.createSceneGraph(),h;for(let t=f.start.col;t<=m.end.col;t++)for(let e=f.start.row;e<=m.end.row;e++)s.scenegraph.updateCellContent(t,e);if("adaptive"===s.widthMode||s.autoFillWidth&&s.getAllColsWidth()<=s.tableNoFrameWidth)0===s.internalProps._widthResizedColMap.size&&s.scenegraph.recalculateColWidths();else for(let e=t;e<=m.end.col;e++)if(!s.internalProps._widthResizedColMap.has(e)){let t=s.getColWidth(e),i=(0,k.al)(e,0,s.rowCount-1,s,!1);i!==t&&s.scenegraph.updateColWidth(e,i-t)}if("adaptive"===s.heightMode||s.autoFillHeight&&s.getAllRowsHeight()<=s.tableNoFrameHeight)s.scenegraph.recalculateRowHeights();else if(s.isAutoRowHeight(e)){let t=[],i=[];for(let r=e;r<=m.end.row;r++)if(s.rowHeightsMap.get(r)){let e=s.getRowHeight(r),n=(0,v.P)(r,0,s.colCount-1,s);t.push(r),i.push(n-e)}s.scenegraph.updateRowsHeight(t,i)}return s.scenegraph.updateNextFrame(),h},new(u||(u=Promise))(function(t,e){function i(t){try{n(d.next(t))}catch(t){e(t)}}function r(t){try{n(d.throw(t))}catch(t){e(t)}}function n(e){var n;e.done?t(e.value):((n=e.value)instanceof u?n:new u(function(t){t(n)})).then(i,r)}n((d=d.apply(o,h||[])).next())})}(t,e,i,r,n,this)}addRecord(t,e){var i;let r=function(t,e,i){var r,n,s,l;try{if(!t)return!1;if(i.internalProps.groupBy)null==(n=(r=i.dataSource).addRecordsForGroup)||n.call(r,[t],e),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&B(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if("tree"===i.dataSource.rowHierarchyType)null==(l=(s=i.dataSource).addRecordsForTree)||l.call(s,[t],e),E(i,e,1),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&B(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if(i.sortState)i.dataSource.addRecordForSorted(t),i.stateManager.checkedState.clear(),B(i),i.refreshRowColCount(),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{(void 0===e||e>i.dataSource.sourceLength)&&(e=i.dataSource.sourceLength);let r=i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount;i.dataSource.addRecord(t,e),E(i,e,1);let n=i.rowCount;if(i.refreshRowColCount(),0===i.scenegraph.proxy.totalActualBodyRowCount)return i.scenegraph.clearCells(),i.scenegraph.createSceneGraph(),!0;let s=i.transpose?i.colCount:i.rowCount;if(i.pagination){let{perPageCount:t,currentPage:l}=i.pagination,a=t*(l||0)+t;if(e<a)if(e<a-t)i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{let l=e-(a-t)+r;if(n-r===i.pagination.perPageCount){let t=[];for(let e=l;e<s;e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],[],t):i.scenegraph.updateRow([],[],t)}else{let t=[];for(let e=l;e<Math.min(s,l+1);e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],t,[]):i.scenegraph.updateRow([],t,[])}}}else{let t=[];for(let n=e+r;n<e+r+1;n++)i.transpose?t.push({col:n,row:0}):t.push({col:0,row:n});let n=[],s=i.internalProps.layoutMap.hasAggregationOnTopCount,l=i.internalProps.layoutMap.hasAggregationOnBottomCount;for(let t=r;t<r+s;t++)i.transpose?n.push({col:t,row:0}):n.push({col:0,row:t});for(let t=(i.transpose?i.colCount:i.rowCount)-l;t<(i.transpose?i.colCount:i.rowCount);t++)i.transpose?n.push({col:t,row:0}):n.push({col:0,row:t});i.transpose?i.scenegraph.updateCol([],t,[]):i.scenegraph.updateRow([],t,[])}}return!0}catch(t){return!1}}(t,e,this);null==(i=this.internalProps.emptyTip)||i.resetVisible(),r&&this.fireListeners(g.B.ADD_RECORD,{records:[t],recordIndex:e,recordCount:1})}addRecords(t,e){var i;let r=function(t,e,i){var r,n,s,l;try{if(!t||0===t.length)return!1;if(i.internalProps.groupBy)null==(n=(r=i.dataSource).addRecordsForGroup)||n.call(r,t,e),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&B(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if("tree"===i.dataSource.rowHierarchyType)null==(l=(s=i.dataSource).addRecordsForTree)||l.call(s,t,e),E(i,e,t.length),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&B(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if(i.sortState)i.dataSource.addRecordsForSorted(t),B(i),i.refreshRowColCount(),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{void 0===e||e>i.dataSource.sourceLength?e=i.dataSource.sourceLength:e<0&&(e=0);let r=i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount;i.dataSource.addRecords(t,e),E(i,e,t.length);let n=i.transpose?i.colCount:i.rowCount;if(i.refreshRowColCount(),0===i.scenegraph.proxy.totalActualBodyRowCount)return i.scenegraph.clearCells(),i.scenegraph.createSceneGraph(),!0;let s=i.transpose?i.colCount:i.rowCount;if(i.pagination){let{perPageCount:l,currentPage:a}=i.pagination,o=l*(a||0)+l;if(e<o)if(e<o-l)i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{let a=e-(o-l)+r;if(n-r===i.pagination.perPageCount){let t=[];for(let e=a;e<s;e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],[],t):i.scenegraph.updateRow([],[],t)}else{let e=[];for(let r=a;r<Math.min(s,a+(Array.isArray(t)?t.length:1));r++)i.transpose?e.push({col:r,row:0}):e.push({col:0,row:r});i.transpose?i.scenegraph.updateCol([],e,[]):i.scenegraph.updateRow([],e,[])}}}else{let n=[];for(let s=e+r;s<e+r+(Array.isArray(t)?t.length:1);s++)i.transpose?n.push({col:s,row:0}):n.push({col:0,row:s});let s=i.internalProps.layoutMap.hasAggregationOnTopCount,l=i.internalProps.layoutMap.hasAggregationOnBottomCount,a=[];for(let t=r;t<r+s;t++)i.transpose?a.push({col:t,row:0}):a.push({col:0,row:t});for(let t=(i.transpose?i.colCount:i.rowCount)-l;t<(i.transpose?i.colCount:i.rowCount);t++)i.transpose?a.push({col:t,row:0}):a.push({col:0,row:t});i.transpose?i.scenegraph.updateCol([],n,a):i.scenegraph.updateRow([],n,a)}}return!0}catch(t){return!1}}(t,e,this);null==(i=this.internalProps.emptyTip)||i.resetVisible(),r&&this.fireListeners(g.B.ADD_RECORD,{records:t,recordIndex:e,recordCount:t.length})}deleteRecords(t){var e;(function(t,e){var i,r,n,s,l,a,o,h;if((null==t?void 0:t.length)>0)if(e.internalProps.groupBy)null==(r=(i=e.dataSource).deleteRecordsForGroup)||r.call(i,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&B(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if("tree"===e.dataSource.rowHierarchyType){let i=null==(s=(n=e.dataSource).deleteRecordsForTree)?void 0:s.call(n,t);if(0===i.length)return;for(let t=0;t<i.length;t++)P(e,i[t],1);e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&B(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph()}else if(e.sortState)e.dataSource.deleteRecordsForSorted(t),B(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{let i=e.dataSource.deleteRecords(t);if(0===i.length)return;for(let t=0;t<i.length;t++)P(e,i[t],1);let r=e.transpose?e.colCount:e.rowCount;e.refreshRowColCount();let n=e.transpose?e.colCount:e.rowCount,s=i.sort((t,e)=>t-e),u=s[0];if(e.pagination){let{perPageCount:t,currentPage:i}=e.pagination,s=t*(i||0)+t;if(u<s)if(u<s-t)e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{let i=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,o=e.internalProps.layoutMap.hasAggregationOnTopCount,h=[],d=[];for(let i=u-(s-t)+(e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount)+o;i<n;i++)e.transpose?h.push({col:i,row:0}):h.push({col:0,row:i});for(let t=i;t<i+o;t++)e.transpose?h.push({col:t,row:0}):h.push({col:0,row:t});if(n<r)for(let t=n;t<r;t++)e.transpose?d.push({col:t,row:0}):d.push({col:0,row:t});null==(l=e.reactCustomLayout)||l.clearCache(),e.transpose?e.scenegraph.updateCol(d,[],h):e.scenegraph.updateRow(d,[],h),null==(a=e.reactCustomLayout)||a.updateAllCustomCell()}}else{let t=[],i=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,r=e.internalProps.layoutMap.hasAggregationOnTopCount,n=e.internalProps.layoutMap.hasAggregationOnBottomCount;for(let n=0;n<s.length;n++){let l=s[n]+i+r;e.transpose?t.push({col:l,row:0}):t.push({col:0,row:l})}let l=[];for(let t=i;t<i+r;t++)e.transpose?l.push({col:t,row:0}):l.push({col:0,row:t});for(let t=(e.transpose?e.colCount:e.rowCount)-n;t<(e.transpose?e.colCount:e.rowCount);t++)e.transpose?l.push({col:t,row:0}):l.push({col:0,row:t});null==(o=e.reactCustomLayout)||o.clearCache(),e.transpose?e.scenegraph.updateCol(t,[],l):e.scenegraph.updateRow(t,[],l),null==(h=e.reactCustomLayout)||h.updateAllCustomCell()}}})(t,this),null==(e=this.internalProps.emptyTip)||e.resetVisible();let i=[];for(let e=0;e<t.length;e++)i.push(this.getBodyRowIndexByRecordIndex(t[e])+this.columnHeaderLevelCount);this.fireListeners(g.B.DELETE_RECORD,{recordIndexs:t,rowIndexs:i,deletedCount:(Array.isArray(t[0]),t.length)})}updateRecords(t,e){(function(t,e,i){var r,n,s,l;if((null==e?void 0:e.length)>0)if(i.internalProps.groupBy)null==(n=(r=i.dataSource).updateRecordsForGroup)||n.call(r,t,e),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&B(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if("tree"===i.dataSource.rowHierarchyType)null==(l=(s=i.dataSource).updateRecordsForTree)||l.call(s,t,e),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&B(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if(i.sortState)i.dataSource.updateRecordsForSorted(t,e),B(i),i.refreshRowColCount(),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{let r=i.dataSource.updateRecords(t,e);if(0===r.length)return;let n=r.map(t=>i.getBodyRowIndexByRecordIndex(t)).sort((t,e)=>t-e);if(i.pagination){let{perPageCount:t,currentPage:e}=i.pagination,r=i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount,s=i.internalProps.layoutMap.hasAggregationOnTopCount,l=t*(e||0)+t,a=[];for(let e=0;e<n.length;e++){let r=n[e];if(r<l&&r>=l-t){let e=r-(l-t)+(i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount)+s;a.push(e)}}if(a.length>=1){let t=[];for(let e=0;e<a.length;e++){let r=a[e];i.transpose?t.push({col:r,row:0}):t.push({col:0,row:r})}for(let e=r;e<r+s;e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],[],t):i.scenegraph.updateRow([],[],t)}}else{let t=[],e=i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount,r=i.internalProps.layoutMap.hasAggregationOnTopCount,s=i.internalProps.layoutMap.hasAggregationOnBottomCount;for(let s=0;s<n.length;s++){let l=n[s]+e+r;i.transpose?t.push({col:l,row:0}):t.push({col:0,row:l})}for(let n=e;n<e+r;n++)i.transpose?t.push({col:n,row:0}):t.push({col:0,row:n});for(let e=(i.transpose?i.colCount:i.rowCount)-s;e<(i.transpose?i.colCount:i.rowCount);e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],[],t):i.scenegraph.updateRow([],[],t)}}})(t,e,this),this.fireListeners(g.B.UPDATE_RECORD,{records:t,recordIndexs:e,updateCount:t.length})}_hasCustomRenderOrLayout(){var t,e,i,r;let{headerObjects:n}=this.internalProps.layoutMap;if(this.options.customRender)return!0;for(let s=0;s<n.length;s++){let l=n[s];if((null==(t=null==l?void 0:l.define)?void 0:t.customLayout)||(null==(e=null==l?void 0:l.define)?void 0:e.headerCustomLayout)||(null==(i=null==l?void 0:l.define)?void 0:i.customRender)||(null==(r=null==l?void 0:l.define)?void 0:r.headerCustomRender))return!0}return!1}getAggregateValuesByField(t){let e=this.internalProps.layoutMap.getColumnByField(t),i=[];for(let t=0;t<e.length;t++){let r=e[t].columnDefine.aggregator;if(delete e[t].columnDefine,r){let n={col:e[t].col,aggregateValue:null};if(n.aggregateValue=[],Array.isArray(r))for(let t=0;t<r.length;t++)n.aggregateValue.push({aggregationType:r[t].type,value:r[t].value()});else n.aggregateValue.push({aggregationType:r.type,value:r.value()});i.push(n)}}return i}isAggregation(t,e){return this.internalProps.layoutMap.isAggregation(t,e)}getGroupTitleLevel(t,e){var i;if(!this.internalProps.groupBy)return;let r=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)),n=null!=(i=this.dataSource.getGroupLength())?i:0,s=(0,d.Z)(r)?r.length-1:0;return n>0&&s===n&&(s=void 0),s}getBodyRowIndexByRecordIndex(t){return Array.isArray(t)&&1===t.length&&(t=t[0]),this.dataSource.getTableIndex(t)}release(){var t;null==(t=this.editorManager)||t.release(),super.release()}expandAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let t=!1;this.dataSource&&"function"==typeof this.dataSource.expandAllNodes&&(this.dataSource.expandAllNodes(),t=!0),t&&(this._recreateSceneForStateChange(),this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:r.g.expand,originData:{children:this.records}}))}collapseAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let t=!1;this.dataSource&&"function"==typeof this.dataSource.collapseAllNodes&&(this.dataSource.collapseAllNodes(),t=!0),t&&(this._recreateSceneForStateChange(),this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:r.g.collapse,originData:{children:this.records}}))}mergeCells(t,e,i,r){for(let n=t;n<=i;n++)for(let t=e;t<=r;t++){let e=this.getCellRange(n,t);if(e.start.col!==e.end.col||e.start.row!==e.end.row)return}this.options.customMergeCell?"function"==typeof this.options.customMergeCell&&(this.options.customMergeCell=[]):this.options.customMergeCell=[],this.options.customMergeCell.push({text:this.getCellValue(t,e),range:{start:{col:t,row:e},end:{col:i,row:r}}}),this.internalProps.customMergeCell=(0,L.k)(this.options.customMergeCell);for(let n=t;n<=i;n++)for(let t=e;t<=r;t++)this.scenegraph.updateCellContent(n,t);this.scenegraph.updateNextFrame()}unmergeCells(t,e,i,r){this.options.customMergeCell?"function"==typeof this.options.customMergeCell&&(this.options.customMergeCell=[]):this.options.customMergeCell=[],this.options.customMergeCell=this.options.customMergeCell.filter(n=>{let{start:s,end:l}=n.range;return s.col!==t||s.row!==e||l.col!==i||l.row!==r}),this.internalProps.customMergeCell=(0,L.k)(this.options.customMergeCell);for(let n=t;n<=i;n++)for(let t=e;t<=r;t++)this.scenegraph.updateCellContent(n,t);this.scenegraph.updateNextFrame()}}},31306:function(t,e,i){"use strict";i.d(e,{z:()=>A});var r=i(20595),n=i(82499),s=i(46894),l=i(57657),a=i(17072),o=i(59885),h=i(49746),u=i(92581),d=i(19465),c=i(43735),p=i(58977),g=i(99506),f=i(70656),m=i(10026),y=i(13455),v=i(62413),b=i(83906),_=i(13844),x=i(89082),C=i(26364),w=i(81774),S=i(79809);(0,x.R2)(),(0,x.Eg)(),(0,x.I)(),(0,x.FD)(),(0,x._t)(),(0,x.Mh)(),(0,x.ph)(),(0,C.LQ)(),(0,C.yR)(),(0,C.pk)(),(0,C.m4)(),(0,C.Jy)(),(0,C.dB)(),(0,C.ge)(),(0,C.au)();class A extends h.D{constructor(t,e){var i,r,s,l,o,h,u,p,y,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F;let O,D;super(t,e),this.layoutNodeId={seqId:0},this._selectedDataItemsInChart=[],this._selectedDimensionInChart=[],this._chartEventMap={},this._throttleTimer=null,this._latestFilterRules=null,(e=this.options).layout&&Object.assign(e,e.layout),this.internalProps.columns=(0,d.Z)(e.columns),this.internalProps.rows=(0,d.Z)(e.rows),this.internalProps.indicators=(0,f.u)(e.indicators),this.internalProps.columnTree=!e.indicatorsAsCol||(null==(i=e.columns)?void 0:i.length)||e.columnTree?(0,d.Z)(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||(null==(r=e.rows)?void 0:r.length)||e.rowTree?(0,d.Z)(e.rowTree):[],this.internalProps.records=e.records,this.setCustomStateNameToSpec(),this.internalProps.columnResizeType=null!=(o=null!=(l=null==(s=e.resize)?void 0:s.columnResizeType)?l:e.columnResizeType)?o:"column",this.internalProps.rowResizeType=null!=(p=null!=(u=null==(h=e.resize)?void 0:h.rowResizeType)?u:e.rowResizeType)?p:"row",this.internalProps.dataConfig={isPivotChart:!0},this.internalProps.columnWidthConfig=e.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=e.columnWidthConfigForRowHeader,this._axes=(0,c.Z)(e.axes)?e.axes:[],e.columnTree&&(!1!==e.indicatorsAsCol&&(this.internalProps.columnTree=(0,b.VN)(this.internalProps.columnTree,e.indicators)),O=new m.KO(null!=(y=this.internalProps.columnTree)?y:[],this.layoutNodeId)),e.rowTree&&(!1===e.indicatorsAsCol&&(this.internalProps.rowTree=(0,b.VN)(this.internalProps.rowTree,e.indicators)),D=new m.KO(null!=(x=this.internalProps.rowTree)?x:[],this.layoutNodeId));let H=(null==(C=null==D?void 0:D.dimensionKeys)?void 0:C.count)?D.dimensionKeys.valueArr():null!=(S=null==(w=e.rows)?void 0:w.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?S:[],z=(null==(A=null==O?void 0:O.dimensionKeys)?void 0:A.count)?O.dimensionKeys.valueArr():null!=(k=null==(M=e.columns)?void 0:M.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?k:[],W=null!=(R=null==(T=e.indicators)?void 0:T.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.indicatorKey),t),[]))?R:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(z,H),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new a.q(this.internalProps.dataConfig,H,z,W,this.internalProps.indicators,null==(B=e.indicatorsAsCol)||B,e.records,void 0,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&(0,v.eW)(this.internalProps.indicators)){let t=e=>{e.forEach(e=>{var i;(null==(i=e.children)?void 0:i.length)?t(e.children):e.children=[{dimensionKey:"axis",value:""}]})};(null==(P=this.dataset.rowHeaderTree)?void 0:P.length)?t(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(e.columnTree||!1!==e.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,b.VN)(this.dataset.colHeaderTree,e.indicators)),e.rowTree||!1===e.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,b.VN)(this.dataset.rowHeaderTree,e.indicators)),O=new m.KO(null!=(E=this.dataset.colHeaderTree)?E:[],this.layoutNodeId),D=new m.KO(null!=(I=this.dataset.rowHeaderTree)?I:[],this.layoutNodeId),this.internalProps.layoutMap=new n.z(this,this.dataset,O,D),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(),e.title){let t=_.F.getComponent("title");this.internalProps.title=new t(e.title,this)}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(L=this.internalProps.emptyTip)||L.resetVisible();else{let t=_.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(F=this.internalProps.emptyTip)||F.resetVisible()}setTimeout(()=>{this.isReleased||(this.resize(),this.fireListeners(g.B.INITIALIZED,null))},0)}static get EVENT_TYPE(){return s.Z}get pivotChartAxes(){return this._axes}get recordsCount(){var t;return null==(t=this.records)?void 0:t.length}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!0}_canResizeColumn(t,e){let i=super._canResizeColumn(t,e);if(i&&!this.internalProps.layoutMap.indicatorsAsCol){let e=this.internalProps.layoutMap.getBody(t,this.columnHeaderLevelCount);if(null==e?void 0:e.disableColumnResize)return!1}return i}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,s,l,o,h,u,p,y,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D;let H,z,W=this.internalProps;super.updateOption(t,e),this.layoutNodeId={seqId:0},this.internalProps.columns=(0,d.Z)(t.columns),this.internalProps.rows=(0,d.Z)(t.rows),this.internalProps.indicators=(null==(i=t.indicators)?void 0:i.length)?(0,f.u)(t.indicators):[],this.internalProps.columnTree=!t.indicatorsAsCol||(null==(r=t.columns)?void 0:r.length)||t.columnTree?(0,d.Z)(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||(null==(s=t.rows)?void 0:s.length)||t.rowTree?(0,d.Z)(t.rowTree):[],t.records&&(this.internalProps.records=t.records),this.setCustomStateNameToSpec(),this._selectedDataItemsInChart=[],W.columnResizeType=null!=(h=null!=(o=null==(l=t.resize)?void 0:l.columnResizeType)?o:t.columnResizeType)?h:"column",W.rowResizeType=null!=(y=null!=(p=null==(u=t.resize)?void 0:u.rowResizeType)?p:t.rowResizeType)?y:"row",W.dataConfig={isPivotChart:!0},this.internalProps.columnWidthConfig=t.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=t.columnWidthConfigForRowHeader,this._axes=(0,c.Z)(t.axes)?t.axes:[],t.columnTree&&(!1!==t.indicatorsAsCol&&(this.internalProps.columnTree=(0,b.VN)(this.internalProps.columnTree,t.indicators)),H=new m.KO(null!=(x=this.internalProps.columnTree)?x:[],this.layoutNodeId)),t.rowTree&&(!1===t.indicatorsAsCol&&(this.internalProps.rowTree=(0,b.VN)(this.internalProps.rowTree,t.indicators)),z=new m.KO(null!=(C=this.internalProps.rowTree)?C:[],this.layoutNodeId));let N=(null==(w=null==z?void 0:z.dimensionKeys)?void 0:w.count)?z.dimensionKeys.valueArr():null!=(A=null==(S=t.rows)?void 0:S.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?A:[],j=(null==(M=null==H?void 0:H.dimensionKeys)?void 0:M.count)?H.dimensionKeys.valueArr():null!=(T=null==(k=t.columns)?void 0:k.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?T:[],G=null!=(B=null==(R=t.indicators)?void 0:R.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.indicatorKey),t),[]))?B:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(j,N),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new a.q(this.internalProps.dataConfig,N,j,G,this.internalProps.indicators,null==(P=t.indicatorsAsCol)||P,null!=(E=t.records)?E:this.internalProps.records,void 0,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&(0,v.eW)(this.internalProps.indicators)){let t=e=>{e.forEach(e=>{var i;(null==(i=e.children)?void 0:i.length)?t(e.children):e.children=[{dimensionKey:"axis",value:""}]})};(null==(I=this.dataset.rowHeaderTree)?void 0:I.length)?t(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(t.columnTree||!1!==t.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,b.VN)(this.dataset.colHeaderTree,t.indicators)),t.rowTree||!1===t.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,b.VN)(this.dataset.rowHeaderTree,t.indicators)),H=new m.KO(null!=(L=this.dataset.colHeaderTree)?L:[],this.layoutNodeId),z=new m.KO(null!=(F=this.dataset.rowHeaderTree)?F:[],this.layoutNodeId),W.layoutMap=new n.z(this,this.dataset,H,z),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,W.releaseList&&(W.releaseList.forEach(t=>{var e;return null==(e=null==t?void 0:t.release)?void 0:e.call(t)}),W.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),t.title){let e=_.F.getComponent("title");this.internalProps.title=new e(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(O=this.internalProps.emptyTip)||O.resetVisible();else{let t=_.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(D=this.internalProps.emptyTip)||D.resetVisible()}return setTimeout(()=>{this.fireListeners(g.B.UPDATED,null)},0),new Promise(t=>{setTimeout(t,0)})}updatePagination(){}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var t,e,i,r,n,s,l,a;let{layoutMap:o}=this.internalProps;o&&(this.colCount=null!=(t=o.colCount)?t:0,this.rowCount=null!=(e=o.rowCount)?e:0,this.internalProps.frozenColCount=null!=(i=o.rowHeaderLevelCount)?i:0,this._setFrozenRowCount(Math.max(o.headerLevelCount,null!=(r=this.options.frozenRowCount)?r:0)),this.bottomFrozenRowCount!==(null!=(n=null==o?void 0:o.bottomFrozenRowCount)?n:0)&&(this.bottomFrozenRowCount=null!=(s=null==o?void 0:o.bottomFrozenRowCount)?s:0),this.rightFrozenColCount!==(null!=(l=null==o?void 0:o.rightFrozenColCount)?l:0)&&(this.rightFrozenColCount=null!=(a=null==o?void 0:o.rightFrozenColCount)?a:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(t,e,i){}syncHierarchyState(t,e){var i,r;t.value===e.value&&t.dimensionKey===e.dimensionKey&&(e.hierarchyState=null!=(i=e.hierarchyState)?i:(null==e?void 0:e.children)?t.hierarchyState:void 0,null==(r=null==e?void 0:e.children)||r.forEach((e,i)=>{var r;(null==(r=null==t?void 0:t.children)?void 0:r[i])&&e&&this.syncHierarchyState(t.children[i],e)}))}getRecordShowIndexByCell(t,e){}getTableIndexByRecordIndex(t){}getTableIndexByField(t){}getCellAddrByFieldRecord(t,e){}getBodyIndexByRow(t){let{layoutMap:e}=this.internalProps;return e.getBodyIndexByRow(t)}getBodyIndexByCol(t){let{layoutMap:e}=this.internalProps;return e.getBodyIndexByCol(t)}getCellValue(t,e,i){var r,n,s;if(!i){let i=this.getCustomMergeValue(t,e);if(i)return i}if(this.internalProps.layoutMap.isHeader(t,e)){if(this.internalProps.layoutMap.isBottomFrozenRow(t,e)||this.internalProps.layoutMap.isRightFrozenColumn(t,e)){let i,s=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(t,e);return null==s||s.forEach(t=>{let e=this.internalProps.layoutMap.getIndicatorInfo(t);e&&(i=e)}),null!=(n=null!=(r=null==i?void 0:i.title)?r:null==i?void 0:i.indicatorKey)?n:""}let{title:i,fieldFormat:s}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof s?s(i,t,e,this):i}if(this.dataset){let i,r=this.internalProps.layoutMap.getCellHeaderPaths(t,e),n=r.colHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),s=r.rowHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),l=this.dataset.getAggregator(s,n,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i);return l.value?l.value():void 0}let{fieldFormat:l}=this.internalProps.layoutMap.getBody(t,e),a=this.getBodyIndexByRow(e),o=this.getBodyIndexByCol(t),h=null==(s=this.records[a])?void 0:s[o];return"function"==typeof l?l(h,t,e,this):h}getCellOriginValue(t,e){var i,r,n;if(this.internalProps.layoutMap.isHeader(t,e)){if(this.internalProps.layoutMap.isBottomFrozenRow(t,e)||this.internalProps.layoutMap.isRightFrozenColumn(t,e)){let n,s=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(t,e);return null==s||s.forEach(t=>{let e=this.internalProps.layoutMap.getIndicatorInfo(t);e&&(n=e)}),null!=(r=null!=(i=null==n?void 0:n.title)?i:null==n?void 0:n.indicatorKey)?r:""}let{title:n}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof n?n():n}if(this.dataset){let i,r=this.internalProps.layoutMap.getCellHeaderPaths(t,e),n=r.colHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),s=r.rowHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),l=this.dataset.getAggregator(s,n,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i);return l.value?l.value():void 0}let s=this.getBodyIndexByRow(e),l=this.getBodyIndexByCol(t);return null==(n=this.records[s])?void 0:n[l]}getCellRawValue(t,e){return this.getCellOriginValue(t,e)}getCellOriginRecord(t,e){if(!this.internalProps.layoutMap.isHeader(t,e)&&this.dataset){let i,r=this.internalProps.layoutMap.getCellHeaderPaths(t,e),n=r.colHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),s=r.rowHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value});return this.dataset.getAggregator(s,n,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i).records}}getCellRawRecord(t,e){return this.getCellOriginRecord(t,e)}getPivotSortState(t,e){if(!this.pivotSortState)return;let i=this.getCellRange(t,e);for(let t=0;t<this.pivotSortState.length;t++){let{col:e,row:r,order:n}=this.pivotSortState[t];if((0,l._Z)(i,e,r))return n}}_moveHeaderPosition(t,e){var i,r,n,s;let l=this.internalProps.layoutMap.moveHeaderPosition(t,e);if(l){if("column"===l.moveType){if((null==(r=null==(i=this.options.records)?void 0:i[0])?void 0:r.constructor)===Array)for(let t=0;t<this.internalProps.records.length;t++){let e=this.internalProps.records[t].splice(l.sourceIndex-this.rowHeaderLevelCount,l.sourceSize);e.unshift(l.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[t],e)}this.colWidthsMap.adjustOrder(l.sourceIndex,l.targetIndex,l.sourceSize),this.setMinMaxLimitWidth()}else if("row"===l.moveType){if((null==(s=null==(n=this.options.records)?void 0:n[0])?void 0:s.constructor)===Array){let t=this.internalProps.records.splice(l.sourceIndex-this.columnHeaderLevelCount,l.sourceSize);t.unshift(l.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,t)}this.rowHeightsMap.adjustOrder(l.sourceIndex,l.targetIndex,l.sourceSize)}return l}return null}toggleHierarchyState(t,e,i=!0){}getHeaderCellAddressByPath(t){return this.internalProps.layoutMap.getPivotCellAdress(t)}getCellAddressByHeaderPaths(t){return this.internalProps.layoutMap.getCellAdressByHeaderPath(t)}getHeaderPathByXY(t){let e;return e=t?this.getCellAt(t.x+this.getFrozenColsWidth()+this.scrollLeft+1,t.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(e.col,e.row)}getHierarchyState(t,e){var i;return null==(i=this._getHeaderLayoutMap(t,e))?void 0:i.hierarchyState}getMenuInfo(t,e,i){let r=this.internalProps.layoutMap.getPivotDimensionInfo(t,e);return{dimensionKey:r[r.length-1].dimensionKey,value:this.getCellValue(t,e),cellLocation:this.getCellLocation(t,e),isPivotCorner:this.isCornerHeader(t,e),event:void 0}}_generateCollectValuesConfig(t,e){var i,r,n,s,l,a,h,u,d,c,p,g,f,m,v,b,_,x,C,S,A,M;t=t.filter(t=>t!==y.ek),e=e.filter(t=>t!==y.ek);let k=this.internalProps.indicators,T={};for(let y=0,R=null==k?void 0:k.length;y<R;y++)if("string"!=typeof k[y]&&k[y].chartSpec){if("pie"===(null==(i=k[y].chartSpec)?void 0:i.type)||"rose"===(null==(r=k[y].chartSpec)?void 0:r.type)||"funnel"===(null==(n=k[y].chartSpec)?void 0:n.type)||"radar"===(null==(s=k[y].chartSpec)?void 0:s.type)||"gauge"===(null==(l=k[y].chartSpec)?void 0:l.type)||"wordCloud"===(null==(a=k[y].chartSpec)?void 0:a.type)||"sunburst"===(null==(h=k[y].chartSpec)?void 0:h.type)||"treemap"===(null==(u=k[y].chartSpec)?void 0:u.type)||"sankey"===(null==(d=k[y].chartSpec)?void 0:d.type)||"circlePacking"===(null==(c=k[y].chartSpec)?void 0:c.type))continue;let R=k[y],B=R.chartSpec;if(!1===this.options.indicatorsAsCol)if(!1!==(null==B?void 0:B.stack)&&("bar"===(null==B?void 0:B.type)||"area"===(null==B?void 0:B.type))&&(B.stack=!0),"heatmap"!==(null==B?void 0:B.type)&&(T[R.indicatorKey]={by:e,range:!0,sumBy:"histogram"===B.type?t.concat(null==B?void 0:B.xField,null==B?void 0:B.x2Field):(null==B?void 0:B.stack)&&t.concat(null==B?void 0:B.xField)}),B.series)B.series.forEach(i=>{var r,n,s,l,a,h,u,d,c,p,g,f,m,y;let v="string"==typeof i.xField?i.xField:i.xField[0];T[v]={by:t,type:"horizontal"!==i.direction?"xField":void 0,range:(0,w.Wm)(i,this._axes,"horizontal"===i.direction,!0),sortBy:"horizontal"!==i.direction?null!=(l=null==(s=null==(n=null==(r=null==i?void 0:i.data)?void 0:r.fields)?void 0:n[v])?void 0:s.domain)?l:null==(u=null==(h=null==(a=null==B?void 0:B.data)?void 0:a.fields)?void 0:h[v])?void 0:u.domain:void 0};let b=i.yField;!1!==i.stack&&("bar"===i.type||"area"===i.type)&&(i.stack=!0),T[b]={by:e,range:(0,w.Wm)(i,this._axes,"horizontal"===i.direction,!1),sumBy:i.stack&&t.concat(null==i?void 0:i.xField),sortBy:"horizontal"===i.direction?null!=(g=null==(p=null==(c=null==(d=null==i?void 0:i.data)?void 0:d.fields)?void 0:c[b])?void 0:p.domain)?g:null==(y=null==(m=null==(f=null==B?void 0:B.data)?void 0:f.fields)?void 0:m[b])?void 0:y.domain:void 0,extendRange:(0,o.FJ)(B.markLine)}});else{let i="histogram"===B.type?B.x2Field:"string"==typeof B.xField?B.xField:B.xField[0];T[i]={by:t,type:"horizontal"!==B.direction?"xField":void 0,range:(0,w.Wm)(B,this._axes,"horizontal"===B.direction,!0),sortBy:"horizontal"!==B.direction?null==(f=null==(g=null==(p=null==B?void 0:B.data)?void 0:p.fields)?void 0:g[i])?void 0:f.domain:void 0},!1!==(null==B?void 0:B.stack)&&("bar"===(null==B?void 0:B.type)||"area"===(null==B?void 0:B.type))&&(B.stack=!0);let r=B.yField;T[r]={by:e,type:"horizontal"!==B.direction?"yField":void 0,range:(0,w.Wm)(B,this._axes,"horizontal"===B.direction,!1),sumBy:"histogram"===B.type?t.concat(null==B?void 0:B.xField,null==B?void 0:B.x2Field):B.stack&&t.concat(null==B?void 0:B.xField),sortBy:"horizontal"===B.direction?null==(b=null==(v=null==(m=null==B?void 0:B.data)?void 0:m.fields)?void 0:v[r])?void 0:b.domain:void 0,extendRange:(0,o.FJ)(B.markLine)}}else{let i=k[y];if(!1!==(null==B?void 0:B.stack)&&("bar"===(null==B?void 0:B.type)||"area"===(null==B?void 0:B.type))&&(B.stack=!0),"heatmap"!==(null==B?void 0:B.type)&&(T[i.indicatorKey]={by:t,range:!0,sumBy:(null==B?void 0:B.stack)&&e.concat(null==B?void 0:B.yField)}),B.series)B.series.forEach(i=>{var r,n,s,l,a,h,u,d,c,p,g,f,m,y;let v="string"==typeof i.yField?i.yField:i.yField[0];T[v]={by:e,type:"horizontal"===i.direction?"yField":void 0,range:(0,w.Wm)(i,this._axes,"horizontal"===i.direction,!1),sortBy:"horizontal"===i.direction?null!=(l=null==(s=null==(n=null==(r=null==i?void 0:i.data)?void 0:r.fields)?void 0:n[v])?void 0:s.domain)?l:null==(u=null==(h=null==(a=null==B?void 0:B.data)?void 0:a.fields)?void 0:h[v])?void 0:u.domain:void 0};let b=i.xField;!1!==i.stack&&("bar"===i.type||"area"===i.type)&&(i.stack=!0),T[b]={by:t,range:(0,w.Wm)(i,this._axes,"horizontal"===i.direction,!0),sumBy:i.stack&&e.concat(null==i?void 0:i.yField),sortBy:"horizontal"!==i.direction?null!=(g=null==(p=null==(c=null==(d=null==i?void 0:i.data)?void 0:d.fields)?void 0:c[b])?void 0:p.domain)?g:null==(y=null==(m=null==(f=null==B?void 0:B.data)?void 0:f.fields)?void 0:m[b])?void 0:y.domain:void 0,extendRange:(0,o.FJ)(B.markLine)}});else{let i="string"==typeof B.yField?B.yField:B.yField[0];T[i]={by:e,type:"horizontal"===B.direction?"yField":void 0,range:(0,w.Wm)(B,this._axes,"horizontal"===B.direction,!1),sortBy:"horizontal"===B.direction?null==(C=null==(x=null==(_=null==B?void 0:B.data)?void 0:_.fields)?void 0:x[i])?void 0:C.domain:void 0},!1!==(null==B?void 0:B.stack)&&("bar"===(null==B?void 0:B.type)||"area"===(null==B?void 0:B.type))&&(B.stack=!0);let r="histogram"===B.type?B.x2Field:B.xField;T[r]={by:t,type:"horizontal"===B.direction?"xField":void 0,range:(0,w.Wm)(B,this._axes,"horizontal"===B.direction,!0),sumBy:B.stack&&e.concat(null==B?void 0:B.yField),sortBy:"horizontal"!==B.direction?null==(M=null==(A=null==(S=null==B?void 0:B.data)?void 0:S.fields)?void 0:A[r])?void 0:M.domain:void 0,extendRange:(0,o.FJ)(B.markLine)}}}}return T}_generateAggregationRules(){var t;let e=[];return null==(t=this.internalProps.indicators)||t.forEach(t=>{var i,n;if("string"==typeof t)e.push({indicatorKey:t,field:t,aggregationType:r.E.RECORD});else if(null==(i=t.chartSpec)?void 0:i.series){let i=[];null==(n=t.chartSpec)||n.series.forEach(t=>{let e=!1===this.options.indicatorsAsCol?t.yField:t.xField;-1===i.indexOf(e)&&i.push(e)}),e.push({indicatorKey:t.indicatorKey,field:i,aggregationType:r.E.RECORD})}else{let i=!1===this.options.indicatorsAsCol?t.chartSpec.yField:t.chartSpec.xField;e.push({indicatorKey:t.indicatorKey,field:null!=i?i:t.indicatorKey,aggregationType:r.E.RECORD})}}),e}setCustomStateNameToSpec(){var t;let e=t=>{var e,i,r,n,s,l,a,o,h,u;(null==(i=null==(e=t.bar)?void 0:e.state)?void 0:i.selected)&&(t.bar.state.vtable_selected=t.bar.state.selected,t.bar.state.vtable_selected_reverse=t.bar.state.selected_reverse,delete t.bar.state.selected,delete t.bar.state.selected_reverse),(null==(n=null==(r=t.point)?void 0:r.state)?void 0:n.selected)&&(t.point.state.vtable_selected=t.point.state.selected,t.point.state.vtable_selected_reverse=t.point.state.selected_reverse,delete t.point.state.selected,delete t.point.state.selected_reverse),(null==(l=null==(s=t.line)?void 0:s.state)?void 0:l.selected)&&(t.line.state.vtable_selected=t.line.state.selected,t.line.state.vtable_selected_reverse=t.line.state.selected_reverse,delete t.line.state.selected,delete t.line.state.selected_reverse),(null==(o=null==(a=t.area)?void 0:a.state)?void 0:o.selected)&&(t.area.state.vtable_selected=t.area.state.selected,t.area.state.vtable_selected_reverse=t.area.state.selected_reverse,delete t.area.state.selected,delete t.area.state.selected_reverse),(null==(u=null==(h=t.pie)?void 0:h.state)?void 0:u.selected)&&(t.pie.state.vtable_selected=t.pie.state.selected,t.pie.state.vtable_selected_reverse=t.pie.state.selected_reverse,delete t.pie.state.selected,delete t.pie.state.selected_reverse)};null==(t=this.internalProps.indicators)||t.forEach(t=>{if(t.chartSpec){let i=t.chartSpec;i.series?i.series.forEach(t=>{e(t)}):e(i)}})}updateFilterRules(t){this._throttledUpdateFilterRules(t)}_throttledUpdateFilterRules(t){this._latestFilterRules=t,null===this._throttleTimer&&(this._executeFilterUpdate(t),this._throttleTimer=window.setTimeout(()=>{this._latestFilterRules!==t&&this._executeFilterUpdate(this._latestFilterRules),this._throttleTimer=null},200))}_executeFilterUpdate(t){this.internalProps.dataConfig.filterRules=t,this.dataset.updateFilterRules(t),(0,u.RW)(this.scenegraph),(0,u.zO)(this.scenegraph),this.render()}clearChartCacheImage(t,e){(0,p.Z)(t)&&(0,p.Z)(e)?(0,u.KP)(t,e,this.scenegraph):(0,u.RW)(this.scenegraph)}getLegendSelected(){var t;let e=[];return null==(t=this.internalProps.legends)||t.forEach(t=>{let i=t.legendComponent._getSelectedLegends().map(t=>t.label);e.push(...i)}),e}setLegendSelected(t){var e;null==(e=this.internalProps.legends)||e.forEach(e=>{e.legendComponent.setSelected(t)})}getChartDatumPosition(t,e){let{chartInstance:i,bounds:r}=this.getChartInstance(e);if(i){let e=i.convertDatumToPosition(t);return e?{x:Math.round(e.x+r.x1),y:Math.round(e.y+r.y1)}:null}return null}getCellAddressByRecord(t){let e=[],i=[],r={},n=[];for(let s in this.dataset.dataConfig.aggregationRules.forEach(t=>{if("string"==typeof t.field)r[t.field]=t.indicatorKey,n.push(t.field);else for(let e=0;e<t.field.length;e++)r[t.field[e]]=t.indicatorKey,n.push(t.field[e])}),t)this.dataset.rows.indexOf(s)>=0&&e.push({dimensionKey:s,value:t[s]}),this.dataset.columns.indexOf(s)>=0&&i.push({dimensionKey:s,value:t[s]}),n.indexOf(s)>=0&&(this.dataset.indicatorsAsCol?i.push({indicatorKey:r[s]}):e.push({indicatorKey:r[s]}));return this.getCellAddressByHeaderPaths({rowHeaderPaths:e,colHeaderPaths:i,cellLocation:"body"})}getChartInstance(t){var e,i,r,n,s;let l=this.getCellAddressByHeaderPaths(t);if(l){let t,a=this.getCellRelativeRect(l.col,l.row),o=this.scenegraph.getCell(l.col,l.row),h=null==(e=null==o?void 0:o.getChildren())?void 0:e[0];if(h.attribute.chartInstance){t=h.attribute.chartInstance;let{dataId:e,data:l,axes:a,spec:o}=h.attribute,u=h.getViewBox();null==a||a.forEach((e,i)=>{var r,n,s,l,a;"linear"===e.type?t.updateModelSpecSync({type:"axes",index:i},{min:null!=(n=null==(r=e.range)?void 0:r.min)?n:0,max:null!=(l=null==(s=e.range)?void 0:s.max)?l:0,tick:{tickMode:null==(a=e.tick)?void 0:a.tickMode}},!0):"band"===e.type&&t.updateModelSpec({type:"axes",index:i},{domain:e.domain.slice(0)},!0)}),t.updateViewBox({x1:0,x2:u.x2-u.x1,y1:0,y2:u.y2-u.y1},!1,!1);let d=t.getStage(),c=h.globalTransMatrix.clone(),p=h.stage.window.getViewBoxTransform();if(c.multiply(p.a,p.b,p.c,p.d,p.e,p.f),d.window.setViewBoxTransform&&d.window.setViewBoxTransform(c.a,c.b,c.c,c.d,c.e,c.f),"string"==typeof e)t.updateDataSync(e,null!=l?l:[]);else{let a=[];for(let s in e){let h=e[s],u=o.series.find(t=>{var e;return(null==(e=null==t?void 0:t.data)?void 0:e.id)===s});a.push({id:s,values:h?null!=(i=null==l?void 0:l.filter(t=>t.hasOwnProperty(h)))?i:[]:null!=l?l:[],fields:null==(r=null==u?void 0:u.data)?void 0:r.fields}),t.updateFullDataSync||t.updateDataSync(s,h?null!=(n=null==l?void 0:l.filter(t=>t.hasOwnProperty(h)))?n:[]:null!=l?l:[])}null==(s=t.updateFullDataSync)||s.call(t,a)}this.render()}return{chartInstance:t,bounds:a.bounds}}return{}}activateChartInstance(t){var e,i,r,n,s;let l=this.getCellAddressByHeaderPaths(t);if(l){let t=l.col,a=l.row,o=this.scenegraph.getCell(t,a),h=null==(e=null==o?void 0:o.getChildren())?void 0:e[0],u=this.scenegraph.activateChart(t,a),{dataId:d,data:c,axes:p,spec:g}=h.attribute,f=h.getViewBox();null==p||p.forEach((t,e)=>{var i,r,n,s,l;"linear"===t.type?u.updateModelSpecSync({type:"axes",index:e},{min:null!=(r=null==(i=t.range)?void 0:i.min)?r:0,max:null!=(s=null==(n=t.range)?void 0:n.max)?s:0,tick:{tickMode:null==(l=t.tick)?void 0:l.tickMode}},!0):"band"===t.type&&u.updateModelSpec({type:"axes",index:e},{domain:t.domain.slice(0)},!0)}),u.updateViewBox({x1:0,x2:f.x2-f.x1,y1:0,y2:f.y2-f.y1},!1,!1);let m=u.getStage();m.needRender=!0;let y=h.globalTransMatrix.clone(),v=h.stage.window.getViewBoxTransform().clone();if(v.multiply(y.a,y.b,y.c,y.d,y.e,y.f),m.window.setViewBoxTransform(v.a,v.b,v.c,v.d,v.e,v.f),"string"==typeof d)u.updateDataSync(d,null!=c?c:[]);else{let t=[];for(let e in d){let s=d[e],l=g.series.find(t=>{var i;return(null==(i=null==t?void 0:t.data)?void 0:i.id)===e});t.push({id:e,values:s?null!=(i=null==c?void 0:c.filter(t=>t.hasOwnProperty(s)))?i:[]:null!=c?c:[],fields:null==(r=null==l?void 0:l.data)?void 0:r.fields}),u.updateFullDataSync||u.updateDataSync(e,s?null!=(n=null==c?void 0:c.filter(t=>t.hasOwnProperty(s)))?n:[]:null!=c?c:[])}null==(s=u.updateFullDataSync)||s.call(u,t)}return u}}replaceChartCacheImage(t,e){var i;let r=this.getCellAddressByHeaderPaths(t);if(r){let t=this.scenegraph.getCell(r.col,r.row),n=null==(i=null==t?void 0:t.getChildren())?void 0:i[0];(0,S.Up)(e.getStage(),n)}}_getDimensionSortArray(){var t,e;if(null==(e=null==(t=this.options)?void 0:t.axes)?void 0:e.length){let t=this.options.indicatorsAsCol?"left":"bottom",e=this.options.axes.find(e=>e.orient===t);if(e&&(0,c.Z)(e.domain))return e.domain}}setRecords(t){var e,i;let r,s;this.internalProps.layoutMap.release(),(0,S.H6)();let l={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=t;let a=this.options,o=this.internalProps;this.dataset.setRecords(t),r=a.columnTree?o.layoutMap.columnDimensionTree:new m.KO(null!=(e=this.dataset.colHeaderTree)?e:[],this.layoutNodeId),s=a.rowTree?o.layoutMap.rowDimensionTree:new m.KO(null!=(i=this.dataset.rowHeaderTree)?i:[],this.layoutNodeId),o.layoutMap=new n.z(this,this.dataset,r,s),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(l.col,l.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder()}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;let{columnsDefine:t,rowsDefine:e,indicatorsDefine:i}=this.internalProps.layoutMap;for(let e=0;e<t.length;e++){let i=t[e];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let t=0;t<e.length;t++){let i=e[t];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let t=0;t<i.length;t++){let e=i[t];if("string"!=typeof e&&(e.customLayout||e.headerCustomLayout||e.customRender||e.headerCustomRender))return!0}return!1}changeRecordOrder(t,e){}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(t,e){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(t,e)}}},16380:function(t,e,i){"use strict";i.d(e,{I:()=>l});var r=i(8426),n=i(89082),s=i(26364);(0,n.R2)(),(0,n.Eg)(),(0,n.I)(),(0,n.FD)(),(0,n._t)(),(0,n.Mh)(),(0,n.ph)(),(0,s.yR)(),(0,s.pk)(),(0,s.m4)(),(0,s.Jy)(),(0,s.dB)(),(0,s.ge)(),(0,s.au)();class l extends r.Z{}},8426:function(t,e,i){"use strict";i.d(e,{Z:()=>M});var r=i(20595),n=i(73664),s=i(82499),l=i(18585);class a{constructor(t,e){this.tree={},this.beforeChangedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.dataConfig=t,e&&(this.records=e,"undefined"!=typeof window&&window.performance.now(),this.setRecords(e),"undefined"!=typeof window&&window.performance.now())}changeDataConfig(t){this.dataConfig=t}setRecords(t){this.processRecords()}processRecords(){for(let t=0,e=this.records.length;t<e;t++){let e=this.records[t];this.processRecord(e)}}processRecord(t){var e;let i=[],r=[];for(let e=0,i=this.dataConfig.rows.length;e<i;e++){let i=this.dataConfig.rows[e];void 0!==t[i]&&i!==this.dataConfig.indicatorDimensionKey&&r.push(t[i])}for(let e=0,r=this.dataConfig.columns.length;e<r;e++){let r=this.dataConfig.columns[e];void 0!==t[r]&&r!==this.dataConfig.indicatorDimensionKey&&i.push(t[r])}null==(e=this.dataConfig.indicators)||e.forEach(e=>{let n=t[e];void 0!==n&&(this.dataConfig.indicatorsAsCol?i.push(e):r.push(e));let s=r.join(this.stringJoinChar),l=i.join(this.stringJoinChar);0!==r.length&&(this.rowFlatKeys[s]||(this.rowFlatKeys[s]=1)),0!==i.length&&(this.colFlatKeys[l]||(this.colFlatKeys[l]=1)),0===i.length&&0===r.length||(this.tree[s]||(this.tree[s]={}),void 0!==n&&(this.tree[s][l]={value:n,record:t},this.dataConfig.indicatorsAsCol?i.pop():r.pop()))})}getTreeNode(t=[],e=[],i,r=!0){var n,s,a,o;let h,u;if("string"==typeof t)h=t;else{let e=!1;t.map((r,n)=>{r===i&&(t.splice(n,1),e=!0)}),e&&t.push(i),h=t.join(this.stringJoinChar)}if("string"==typeof e)u=e;else{let t=!1;e.map((r,n)=>{r===i&&(e.splice(n,1),t=!0)}),t&&e.push(i),u=e.join(this.stringJoinChar)}return r?null!=(a=null==(s=null==(n=this.tree)?void 0:n[h])?void 0:s[u])?a:void 0:(0,l.Z)(null==(o=this.beforeChangedTree[h])?void 0:o[u])?{value:this.beforeChangedTree[h][u].value,record:this.beforeChangedTree[h][u].record}:void 0}changeTreeNodeValue(t=[],e=[],i,r){var n,s,l,a,o,h,u;let d,c;if("string"==typeof t)d=t;else{let e=!1;t.map((r,n)=>{r===i&&(t.splice(n,1),e=!0)}),e&&t.push(i),d=t.join(this.stringJoinChar)}if("string"==typeof e)c=e;else{let t=!1;e.map((r,n)=>{r===i&&(e.splice(n,1),t=!0)}),t&&e.push(i),c=e.join(this.stringJoinChar)}let p=null==(s=null==(n=this.tree[d])?void 0:n[c])?void 0:s.value,g=Object.assign({},null==(a=null==(l=this.tree[d])?void 0:l[c])?void 0:a.record);(null==(h=null==(o=this.tree[d])?void 0:o[c])?void 0:h.record)?(this.tree[d][c].record[i]=r,this.tree[d][c].value=r):(this.tree[d]||(this.tree[d]={}),this.tree[d][c]={record:this._buildRecord(t,e,i,r),value:r}),(null==(u=this.beforeChangedTree[d])?void 0:u[c])||(this.beforeChangedTree[d]={},this.beforeChangedTree[d][c]={record:void 0,value:void 0},this.beforeChangedTree[d][c].record=g,this.beforeChangedTree[d][c].value=p)}_buildRecord(t=[],e=[],i,r){let n={},s=this.dataConfig.rows,l=this.dataConfig.columns;return s.forEach((e,i)=>{e!==this.dataConfig.indicatorDimensionKey&&(n[e]=t[i])}),l.forEach((t,i)=>{t!==this.dataConfig.indicatorDimensionKey&&(n[t]=e[i])}),n[i]=r,this.records.push(n),n}addRecords(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];this.processRecord(i)}this.records.push(t)}changeRecordFieldValue(t,e,i){let r=!1;for(let e=0;e<this.dataConfig.indicators.length;e++)this.dataConfig.indicators[e]===t&&(r=!0);if(!r){for(let r=0,n=this.records.length;r<n;r++){let n=this.records[r];n[t]===e&&(n[t]=i)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}}var o=i(46894),h=i(57657),u=i(17072),d=i(49746),c=i(19465),p=i(58977),g=i(84375),f=i(10026),m=i(99506),y=i(84826),v=i(85865),b=i(92062),_=i(7430),x=i(12588),C=i(70656),w=i(83906),S=i(13844),A=i(79809);class M extends d.D{constructor(t,e){var i,r,n,l,o,h,d,p,v,b,_,x,A,M,k,T,R,B,P,E,I,L,F,O;if(super(t,e),this.layoutNodeId={seqId:0},e=this.options){e.rowHierarchyType||(e.rowHierarchyType="grid"),e.columnHierarchyType||(e.columnHierarchyType="grid"),e.layout&&Object.assign(e,e.layout),this.internalProps.columns=(0,c.Z)(e.columns),this.internalProps.rows=(0,c.Z)(e.rows),this.internalProps.indicators=(0,C.u)(e.indicators),null==(i=e.indicators)||i.forEach((t,e)=>{"object"==typeof t&&(null==t?void 0:t.editor)&&(this.internalProps.indicators[e].editor=t.editor)}),this.internalProps.columnTree=!e.indicatorsAsCol||(null==(r=e.columns)?void 0:r.length)||e.columnTree?(0,c.Z)(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||(null==(n=e.rows)?void 0:n.length)||e.rowTree?(0,c.Z)(e.rowTree):[],this.internalProps.records=e.records,this.pagination=e.pagination,this.internalProps.columnResizeType=null!=(h=null!=(o=null==(l=e.resize)?void 0:l.columnResizeType)?o:e.columnResizeType)?h:"column",this.internalProps.rowResizeType=null!=(v=null!=(p=null==(d=e.resize)?void 0:d.rowResizeType)?p:e.rowResizeType)?v:"row",this.internalProps.dataConfig=(0,c.Z)(e.dataConfig),this.internalProps.columnWidthConfig=e.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=e.columnWidthConfigForRowHeader;let t=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(b=null==t?void 0:t[0])?void 0:b.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),!1===(null==(_=e.customConfig)?void 0:_.enableDataAnalysis)){let e=new f.KO(null!=(x=this.internalProps.columnTree)?x:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(A=this.options.columnExpandLevel)?A:1:void 0),i=new f.KO(null!=(M=this.internalProps.rowTree)?M:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(k=this.options.rowExpandLevel)?k:1:void 0);this.internalProps.layoutMap=new s.z(this,null,e,i),!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new a({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey},t))}else{let t=(0,w.Ul)(this,e),{rowKeys:i,columnKeys:r,indicatorKeys:n}=t,{columnDimensionTree:l,rowDimensionTree:a}=t;this.dataset=new u.q(this.internalProps.dataConfig,i,r,n,this.internalProps.indicators,null==(T=e.indicatorsAsCol)||T,e.records,e.rowHierarchyType,e.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!e.extensionRows,!!e.parseCustomTreeToMatchRecords),e.columnTree?l.hasHideNode&&((0,w.uu)(l.tree.children,e.indicators,!0,this),l.reset(l.tree.children)):(!1!==e.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,w.VN)(this.dataset.colHeaderTree,e.indicators)),!1!==e.indicatorsAsCol&&e.indicators&&this.dataset.colHeaderTree&&(0,w.uu)(this.dataset.colHeaderTree,e.indicators,!1,this),l=new f.KO(null!=(R=this.dataset.colHeaderTree)?R:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(B=this.options.columnExpandLevel)?B:1:void 0)),e.rowTree?a.hasHideNode&&((0,w.uu)(a.tree.children,e.indicators,!0,this),a.reset(a.tree.children)):(!1===e.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,w.VN)(this.dataset.rowHeaderTree,e.indicators)),!1===e.indicatorsAsCol&&this.dataset.rowHeaderTree&&e.indicators&&(0,w.uu)(this.dataset.rowHeaderTree,e.indicators,!1,this),a=new f.KO(null!=(P=this.dataset.rowHeaderTree)?P:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(E=this.options.rowExpandLevel)?E:1:void 0)),this.internalProps.layoutMap=new s.z(this,this.dataset,l,a)}if(this._changePivotSortStateBySortRules(),(null!=(L=null==(I=e.pivotSortState)?void 0:I.length)?L:0)>0&&(this.pivotSortState=[],this.pivotSortState=e.pivotSortState),"node"!==g.X.mode&&(this.editorManager=new y.$(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.stateManager.initCheckedState(t),this.scenegraph.createSceneGraph(),e.title){let t=S.F.getComponent("title");this.internalProps.title=new t(e.title,this)}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(F=this.internalProps.emptyTip)||F.resetVisible();else{let t=S.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(O=this.internalProps.emptyTip)||O.resetVisible()}setTimeout(()=>{this.isReleased||(this.resize(),this.fireListeners(m.B.INITIALIZED,null))},0)}}static get EVENT_TYPE(){return o.z}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!1}get recordsCount(){var t;return null==(t=this.records)?void 0:t.length}_canResizeColumn(t,e){let i=super._canResizeColumn(t,e);if(i){if(this.internalProps.layoutMap.isSeriesNumber(t,e)&&!0===this.internalProps.rowSeriesNumber.disableColumnResize)return!1;if(!this.internalProps.layoutMap.indicatorsAsCol){let e=this.internalProps.layoutMap.getBody(t,this.columnHeaderLevelCount);if(null==e?void 0:e.disableColumnResize)return!1}}return i}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,n,l,o,h,d,p,g,y,v,b,_,x,A,M,k,T,R,B,P,E,I,L,F,O;let D=this.internalProps;if(super.updateOption(t,e),t.rowHierarchyType||(t.rowHierarchyType="grid"),t.columnHierarchyType||(t.columnHierarchyType="grid"),this.layoutNodeId={seqId:0},this.internalProps.columns=(0,c.Z)(t.columns),this.internalProps.rows=(0,c.Z)(t.rows),this.internalProps.indicators=(null==(i=t.indicators)?void 0:i.length)?(0,C.u)(t.indicators):[],null==(r=t.indicators)||r.forEach((t,e)=>{"object"==typeof t&&(null==t?void 0:t.editor)&&(this.internalProps.indicators[e].editor=t.editor)}),this.internalProps.columnTree=!t.indicatorsAsCol||(null==(n=t.columns)?void 0:n.length)||t.columnTree?(0,c.Z)(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||(null==(l=t.rows)?void 0:l.length)||t.rowTree?(0,c.Z)(t.rowTree):[],t.records&&(this.internalProps.records=t.records),this.stateManager.initCheckedState(this.internalProps.records),this.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1),this.pagination=t.pagination,D.columnResizeType=null!=(d=null!=(h=null==(o=t.resize)?void 0:o.columnResizeType)?h:t.columnResizeType)?d:"column",D.rowResizeType=null!=(y=null!=(g=null==(p=t.resize)?void 0:p.rowResizeType)?g:t.rowResizeType)?y:"row",D.dataConfig=(0,c.Z)(t.dataConfig),this.internalProps.columnWidthConfig=t.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=t.columnWidthConfigForRowHeader,"grid"!==(null==t?void 0:t.rowHierarchyType)&&"grid"!==this.internalProps.layoutMap.rowHierarchyType&&this.internalProps.layoutMap.rowExpandLevel===(null==t?void 0:t.rowExpandLevel)){let t=this.internalProps.layoutMap.rowDimensionTree.tree.children;null==(v=this.internalProps.rowTree)||v.forEach((e,i)=>{let r=t.find(t=>t.dimensionKey===e.dimensionKey&&t.value===e.value);r&&this._syncHierarchyState(r,e)})}let H=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(b=null==H?void 0:H[0])?void 0:b.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),!1===(null==(_=t.customConfig)?void 0:_.enableDataAnalysis)){let e,i;t.columnTree&&(e=new f.KO(null!=(x=this.internalProps.columnTree)?x:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(A=this.options.columnExpandLevel)?A:1:void 0)),t.rowTree&&(i=new f.KO(null!=(M=this.internalProps.rowTree)?M:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(k=this.options.rowExpandLevel)?k:1:void 0)),D.layoutMap.clearHeaderPathCache(),D.layoutMap=new s.z(this,null,e,i),!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new a({rows:D.layoutMap.fullRowDimensionKeys,columns:D.layoutMap.colDimensionKeys,indicators:D.layoutMap.indicatorKeys,indicatorsAsCol:D.layoutMap.indicatorsAsCol,indicatorDimensionKey:D.layoutMap.indicatorDimensionKey},H))}else{let e=(0,w.Ul)(this,t),{rowKeys:i,columnKeys:r,indicatorKeys:n}=e,{columnDimensionTree:l,rowDimensionTree:a}=e;this.dataset=new u.q(D.dataConfig,i,r,n,this.internalProps.indicators,null==(T=t.indicatorsAsCol)||T,H,t.rowHierarchyType,t.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!t.extensionRows,!!t.parseCustomTreeToMatchRecords),t.columnTree?l.hasHideNode&&((0,w.uu)(l.tree.children,t.indicators,!0,this),l.reset(l.tree.children)):(!1!==t.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,w.VN)(this.dataset.colHeaderTree,t.indicators)),!1!==t.indicatorsAsCol&&t.indicators&&this.dataset.colHeaderTree&&(0,w.uu)(this.dataset.colHeaderTree,t.indicators,!1,this),l=new f.KO(null!=(R=this.dataset.colHeaderTree)?R:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(B=this.options.columnExpandLevel)?B:1:void 0)),t.rowTree?a.hasHideNode&&((0,w.uu)(a.tree.children,t.indicators,!0,this),a.reset(a.tree.children)):(!1===t.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,w.VN)(this.dataset.rowHeaderTree,t.indicators)),!1===t.indicatorsAsCol&&this.dataset.rowHeaderTree&&t.indicators&&(0,w.uu)(this.dataset.rowHeaderTree,t.indicators,!1,this),a=new f.KO(null!=(P=this.dataset.rowHeaderTree)?P:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(E=this.options.rowExpandLevel)?E:1:void 0)),D.layoutMap=new s.z(this,this.dataset,l,a)}if(this._changePivotSortStateBySortRules(),(null!=(L=null==(I=t.pivotSortState)?void 0:I.length)?L:0)>0&&(this.pivotSortState=[],this.pivotSortState=t.pivotSortState),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,D.releaseList&&(D.releaseList.forEach(t=>{var e;return null==(e=null==t?void 0:t.release)?void 0:e.call(t)}),D.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),t.title){let e=S.F.getComponent("title");this.internalProps.title=new e(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(F=this.internalProps.emptyTip)||F.resetVisible();else{let t=S.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(O=this.internalProps.emptyTip)||O.resetVisible()}return setTimeout(()=>{this.fireListeners(m.B.UPDATED,null)},0),new Promise(t=>{setTimeout(t,0)})}updatePagination(t){this.internalProps.layoutMap.clearHeaderPathCache(),t?(this.pagination||(this.pagination={currentPage:0,perPageCount:0}),"number"==typeof t.currentPage&&t.currentPage>=0&&(this.pagination.currentPage=t.currentPage),t.perPageCount&&(this.pagination.perPageCount=t.perPageCount||this.pagination.perPageCount),this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(this.pagination),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()):this.pagination&&(this.pagination=void 0,this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(void 0),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render())}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var t,e,i,r,n,s,l,a;let{layoutMap:o}=this.internalProps;o&&(this.colCount=null!=(t=o.colCount)?t:0,this.rowCount=null!=(e=o.rowCount)?e:0,this.internalProps.frozenColCount=this.options.frozenColCount?this.options.frozenColCount:(null!=(i=o.rowHeaderLevelCount)?i:0)+o.leftRowSeriesNumberColumnCount,this._setFrozenRowCount(Math.max(o.headerLevelCount,null!=(r=this.options.frozenRowCount)?r:0)),this.bottomFrozenRowCount!==(null!=(n=this.options.bottomFrozenRowCount)?n:0)&&(this.bottomFrozenRowCount=null!=(s=this.options.bottomFrozenRowCount)?s:0),this.rightFrozenColCount!==(null!=(l=this.options.rightFrozenColCount)?l:0)&&(this.rightFrozenColCount=null!=(a=this.options.rightFrozenColCount)?a:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount),this.stateManager.setFrozenRow(this.frozenRowCount))}_getSortFuncFromHeaderOption(t,e,i){}get rowHierarchyType(){return this.internalProps.layoutMap.rowHierarchyType}get columnHierarchyType(){return this.internalProps.layoutMap.columnHierarchyType}_syncHierarchyState(t,e){var i,r,n;t.value===e.value&&t.dimensionKey===e.dimensionKey&&(e.hierarchyState=null!=(i=e.hierarchyState)?i:(null==e?void 0:e.children)?t.hierarchyState:void 0,null==(n=null==(r=null==e?void 0:e.children)?void 0:r.forEach)||n.call(r,(e,i)=>{var r;if((null==(r=null==t?void 0:t.children)?void 0:r[i])&&e){let i=t.children.find(t=>t.dimensionKey===e.dimensionKey&&t.value===e.value);i&&this._syncHierarchyState(i,e)}}))}getRecordShowIndexByCell(t,e){}getTableIndexByRecordIndex(t){}getTableIndexByField(t){}getCellAddrByFieldRecord(t,e){}getBodyIndexByRow(t){let{layoutMap:e}=this.internalProps;return e.getBodyIndexByRow(t)}getBodyIndexByCol(t){let{layoutMap:e}=this.internalProps;return e.getBodyIndexByCol(t)}getFieldData(t,e,i){var r,n,s;if(!this.internalProps.layoutMap.isHeader(e,i)){if(this.internalProps.recordsIsTwoDimensionalArray){let t=this.getBodyIndexByRow(i),n=this.getBodyIndexByCol(e);return null==(r=this.records[t])?void 0:r[n]}if(this.dataset){let r=this.internalProps.layoutMap.getCellHeaderPaths(e,i);if(r){let l,a=null==(n=r.colHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var i;return t.indicatorKey&&(l={position:"col",index:e}),null!=(i=t.indicatorKey)?i:t.value}),o=null==(s=r.rowHeaderPaths)?void 0:s.filter(t=>!t.virtual).map((t,e)=>{var i;return t.indicatorKey&&(l={position:"row",index:e}),null!=(i=t.indicatorKey)?i:t.value}),h=this.dataset.getAggregator(o,a,this.internalProps.layoutMap.getIndicatorKey(e,i),!0,l);if(h.records&&h.records.length>=1)return h.records[0][t]}}else if(this.flatDataToObjects){let r=this.internalProps.layoutMap.getCellHeaderPaths(e,i),n=r.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),s=r.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),l=this.flatDataToObjects.getTreeNode(s,n,this.internalProps.layoutMap.getBody(e,i).indicatorKey,!1);if(null==l?void 0:l.record)return null==l?void 0:l.record[t]}}}getCellValue(t,e,i){var r,n,s,l,a,o,h;if(!i){let i=this.getCustomMergeValue(t,e);if(i)return i}if(this.internalProps.layoutMap.isSeriesNumber(t,e)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getSeriesNumberHeader(t,e);return i}let{format:i}=this.internalProps.layoutMap.getSeriesNumberBody(t,e);return"function"==typeof i?i(t,e,this):e-this.columnHeaderLevelCount+1}if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i,fieldFormat:r}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof r?r(i,t,e,this):i}if(this.internalProps.recordsIsTwoDimensionalArray){let{fieldFormat:i}=this.internalProps.layoutMap.getBody(t,e),n=this.getBodyIndexByRow(e),s=this.getBodyIndexByCol(t),l=null==(r=this.records[n])?void 0:r[s];return"function"==typeof i?i(l,t,e,this):l}if(this.dataset){let i,r=this.internalProps.layoutMap.getCellHeaderPaths(t,e),h=null==(s=null==(n=r.colHeaderPaths)?void 0:n.filter(t=>!t.virtual))?void 0:s.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),u=null==(a=null==(l=r.rowHeaderPaths)?void 0:l.filter(t=>!t.virtual))?void 0:a.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),d=this.dataset.getAggregator(u,h,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i),{fieldFormat:c}=this.internalProps.layoutMap.getBody(t,e);return d.formatValue?d.formatValue(t,e,this):"function"==typeof c?c(null==d?void 0:d.value(),t,e,this):null!=(o=null==d?void 0:d.value())?o:""}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),s=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey),{fieldFormat:l}=this.internalProps.layoutMap.getBody(t,e);return"function"==typeof l?l(null==s?void 0:s.value,t,e,this):null!=(h=null==s?void 0:s.value)?h:""}}getCellOriginValue(t,e){var i,r,n;if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}if(this.internalProps.recordsIsTwoDimensionalArray){let r=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);return null==(i=this.records[r])?void 0:i[n]}if(this.dataset){let i,s=this.internalProps.layoutMap.getCellHeaderPaths(t,e),l=null==(r=s.colHeaderPaths)?void 0:r.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),a=null==(n=s.rowHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),o=this.dataset.getAggregator(a,l,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i);return o.value?o.value():void 0}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),s=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey);return null==s?void 0:s.value}}getCellRawValue(t,e){var i,r,n;if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}if(this.internalProps.recordsIsTwoDimensionalArray){let r=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);return null==(i=this.records[r])?void 0:i[n]}if(this.dataset){let i,s=this.internalProps.layoutMap.getCellHeaderPaths(t,e),l=null==(r=s.colHeaderPaths)?void 0:r.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),a=null==(n=s.rowHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),o=this.dataset.getAggregator(a,l,this.internalProps.layoutMap.getIndicatorKey(t,e),!1,i);return o.value?o.value():void 0}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),s=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey,!1);return null==s?void 0:s.value}}getCellOriginRecord(t,e){var i,r,n;if(!this.internalProps.layoutMap.isHeader(t,e)){if(this.internalProps.recordsIsTwoDimensionalArray){let r=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);return null==(i=this.records[r])?void 0:i[n]}if(this.dataset){let i,s=this.internalProps.layoutMap.getCellHeaderPaths(t,e),l=null==(r=s.colHeaderPaths)?void 0:r.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),a=null==(n=s.rowHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value});return this.dataset.getAggregator(a,l,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i).records}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),s=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey);return null==s?void 0:s.record}}}getCellRawRecord(t,e){var i,r,n;if(!this.internalProps.layoutMap.isHeader(t,e)){if(this.internalProps.recordsIsTwoDimensionalArray){let r=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);return null==(i=this.records[r])?void 0:i[n]}if(this.dataset){let i,s=this.internalProps.layoutMap.getCellHeaderPaths(t,e),l=null==(r=s.colHeaderPaths)?void 0:r.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),a=null==(n=s.rowHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value});return this.dataset.getAggregator(a,l,this.internalProps.layoutMap.getIndicatorKey(t,e),!1,i).records}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),s=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey,!1);return null==s?void 0:s.record}}}updateSortRules(t,e,i){this.internalProps.dataConfig?this.internalProps.dataConfig.sortRules=t:this.internalProps.dataConfig={sortRules:t},this.dataset.updateSortRules(t),this._changePivotSortStateBySortRules();let{layoutMap:r}=this.internalProps;r.resetHeaderTree(),this.scenegraph.clearCells(),(0,p.Z)(e)&&(0,p.Z)(i)?(this.isRowHeader(e,i)?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):this.isCornerHeader(e,i)?"column"===r.cornerSetting.titleOnDimension?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):"row"===r.cornerSetting.titleOnDimension&&this.internalProps._heightResizedRowMap.clear():this.isColumnHeader(e,i)&&this.internalProps._heightResizedRowMap.clear(),this.refreshRowColCount()):this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(!0),this.render()}_changePivotSortStateBySortRules(){var t,e,i,n;this.pivotSortState=[];let s=null!=(e=null==(t=this.internalProps.dataConfig)?void 0:t.sortRules)?e:[];for(let t=0;t<s.length;t++){let e=s[t],l=[];if(e.sortByIndicator&&e.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])){for(let t=0;t<e.query.length;t++)l.push({dimensionKey:this.dataset.indicatorsAsCol?this.dataset.columns[t]:this.dataset.rows[t],value:e.query[t]});l.push({indicatorKey:e.sortByIndicator,value:null!=(n=null==(i=this.internalProps.layoutMap.getIndicatorInfo(e.sortByIndicator))?void 0:i.title)?n:e.sortByIndicator})}else l.push({dimensionKey:e.sortField,isPivotCorner:!0,value:e.sortField});let a=e.sortType?e.sortType.toUpperCase():"ASC";this.pivotSortState.push({dimensions:l,order:r.F[a]})}}updatePivotSortState(t){this.pivotSortState=t}sort(t,e,i){var n,s;let l;if(this.isCornerHeader(t,e)){let i=this.getHeaderDefine(t,e);l=[];let r={isPivotCorner:!0,dimensionKey:i.value,value:i.value};l.push(r)}else l=this.isColumnHeader(t,e)?this.getCellHeaderPaths(t,e).colHeaderPaths:this.getCellHeaderPaths(t,e).rowHeaderPaths;let a=l[l.length-1].indicatorKey,o=this.getHeaderDefine(t,e);if(o.sort){if(this.dataset.sortRules){let t={};for(let e=this.dataset.sortRules.length-1;e>=0;e--){let i=this.dataset.sortRules[e];(o.dimensionKey&&i.sortField===o.dimensionKey||a&&i.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1]))&&(t[i.sortField]=i,this.dataset.sortRules.splice(e,1))}if(a){let e=this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1];this.dataset.sortRules.push({sortField:e,sortType:r.F[i],sortByIndicator:a,query:l.reduce((t,e)=>(e.dimensionKey&&t.push(e.value),t),[]),sortFunc:null==(n=t[e])?void 0:n.sortFunc})}else this.dataset.sortRules.push(Object.assign(null!=(s=t[o.dimensionKey])?s:{},{sortField:o.dimensionKey,sortType:r.F[i]}))}else this.dataset.sortRules=a?[{sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:r.F[i],sortByIndicator:a,query:l.reduce((t,e)=>(e.dimensionKey&&t.push(e.value),t),[])}]:[{sortField:o.dimensionKey,sortType:r.F[i]}];this.updateSortRules(this.dataset.sortRules,t,e)}}getPivotSortState(t,e){if(!this.pivotSortState)return;let i=this.getCellRange(t,e);for(let t=0;t<this.pivotSortState.length;t++){let e=this.pivotSortState[t],r=e.dimensions,n=this.getCellAddressByHeaderPaths(r),s=e.order;if(n&&(0,h._Z)(i,n.col,n.row))return s}}_moveHeaderPosition(t,e){let i=this.getCellRange(t.col,t.row),r=this.getCellRange(e.col,e.row),n=this.internalProps.layoutMap.moveHeaderPosition(t,e);if(n){if("column"===n.moveType){if(this.internalProps.recordsIsTwoDimensionalArray)for(let t=0;t<this.internalProps.records.length;t++){let e=this.internalProps.records[t].splice(n.sourceIndex-this.rowHeaderLevelCount,n.sourceSize);e.unshift(n.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[t],e)}this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,r.start.col,r.end.col-r.start.col+1,n.targetIndex),this.setMinMaxLimitWidth()}else if("row"===n.moveType){if(this.internalProps.recordsIsTwoDimensionalArray){let t=this.internalProps.records.splice(n.sourceIndex-this.columnHeaderLevelCount,n.sourceSize);t.unshift(n.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,t)}n.targetIndex>n.sourceIndex?this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex+n.sourceSize-n.targetSize,n.targetSize,n.targetIndex):this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex,n.targetSize,n.targetIndex)}return n}return null}toggleHierarchyState(t,e,i=!0){this.internalProps.layoutMap.clearHeaderPathCache();let r=this.getHierarchyState(t,e);if(r===n.g.expand)this._refreshHierarchyState(t,e,i),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:n.g.collapse});else if(r===n.g.collapse){let r=this.internalProps.layoutMap.getHeadNode(t,e);Array.isArray(r.children)&&this._refreshHierarchyState(t,e,i),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:n.g.expand,originData:r})}}_refreshHierarchyState(t,e,i=!0,r){var n,s;this.frozenColCount,this.frozenRowCount;let l=this.getBodyVisibleRowRange().rowStart;this.internalProps._oldRowCount=this.rowCount,this.internalProps._oldColCount=this.colCount;let a=!1,o=!1;this.stateManager.updateHoverIcon(t,e,void 0,void 0);let h=this.internalProps.layoutMap.checkHasChart();h&&(this.autoFillWidth&&(a=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(o=this.getAllRowsHeight()<=this.tableNoFrameHeight));let u=this.internalProps.layoutMap.isRowHeader(t,e)?this.internalProps.layoutMap.toggleHierarchyState(t,e):this.internalProps.layoutMap.toggleHierarchyStateForColumnTree(t,e);r&&r(),this.refreshRowColCount(),this.frozenColCount,this.frozenRowCount,this.clearCellStyleCache(),"tree"===this.rowHierarchyType&&this.scenegraph.updateHierarchyIcon(t,e),null==(n=this.reactCustomLayout)||n.clearCache(),"grid-tree"!==this.rowHierarchyType&&"grid-tree"!==this.columnHierarchyType?this.scenegraph.updateRow(u.removeCellPositionsRowDirection,u.addCellPositionsRowDirection,u.updateCellPositionsRowDirection,i):(this.internalProps.stick.changedCells.clear(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.scrollToRow(l)),null==(s=this.reactCustomLayout)||s.updateAllCustomCell(),h&&(this.autoFillWidth&&!a&&(a=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!o&&(o=this.getAllRowsHeight()<=this.tableNoFrameHeight),("adaptive"===this.widthMode||a||"adaptive"===this.heightMode||o)&&this.scenegraph.updateChartSizeForResizeColWidth(-1)),this.internalProps._oldRowCount=void 0,this.internalProps._oldColCount=void 0}getHeaderCellAddressByPath(t){return this.internalProps.layoutMap.getPivotCellAdress(t)}getCellAddressByHeaderPaths(t){return this.internalProps.layoutMap.getCellAdressByHeaderPath(t)}getHeaderPathByXY(t){let e;return e=t?this.getCellAt(t.x+this.getFrozenColsWidth()+this.scrollLeft+1,t.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(e.col,e.row)}getHierarchyState(t,e){var i;return null==(i=this._getHeaderLayoutMap(t,e))?void 0:i.hierarchyState}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(t,e){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(t,e)}getMenuInfo(t,e,i){let r=this.internalProps.layoutMap.getPivotDimensionInfo(t,e);return{dimensionKey:r[r.length-1].dimensionKey,value:this.getCellValue(t,e),cellLocation:this.getCellLocation(t,e),isPivotCorner:this.isCornerHeader(t,e),event:void 0}}setRecords(t){var e,i,r,n,l,o,h,u;(0,A.H6)();let d={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=t,this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(e=null==t?void 0:t[0])?void 0:e.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0);let c=this.options,p=this.internalProps;if(!1===(null==(i=this.options.customConfig)?void 0:i.enableDataAnalysis))!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new a({rows:p.layoutMap.fullRowDimensionKeys,columns:p.layoutMap.colDimensionKeys,indicators:p.layoutMap.indicatorKeys,indicatorsAsCol:p.layoutMap.indicatorsAsCol,indicatorDimensionKey:p.layoutMap.indicatorDimensionKey},t));else{let e,i;this.dataset.setRecords(t),c.columnTree?e=p.layoutMap.columnDimensionTree:(!1!==c.indicatorsAsCol&&c.indicators&&this.dataset.colHeaderTree&&(0,w.uu)(this.dataset.colHeaderTree,c.indicators,!1,this),e=new f.KO(null!=(r=this.dataset.colHeaderTree)?r:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(n=this.options.columnExpandLevel)?n:1:void 0)),c.rowTree?i=p.layoutMap.rowDimensionTree:(!1===c.indicatorsAsCol&&this.dataset.rowHeaderTree&&c.indicators&&(0,w.uu)(this.dataset.rowHeaderTree,c.indicators,!1,this),i=new f.KO(null!=(l=this.dataset.rowHeaderTree)?l:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(o=this.options.rowExpandLevel)?o:1:void 0)),p.layoutMap=new s.z(this,this.dataset,e,i),this.pivotSortState=[],c.pivotSortState&&(this.pivotSortState=c.pivotSortState)}if(this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(d.col,d.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder(),this.options.emptyTip)if(this.internalProps.emptyTip)null==(h=this.internalProps.emptyTip)||h.resetVisible();else{let t=S.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(u=this.internalProps.emptyTip)||u.resetVisible()}}startEditCell(t,e,i){var r;if((0,l.Z)(t)&&(0,l.Z)(e))this.eventManager.isDraging=!1,this.selectCell(t,e),this.editorManager.startEditCell(t,e,i);else if(null==(r=this.stateManager.select)?void 0:r.cellPos){let{col:t,row:e}=this.stateManager.select.cellPos;(0,l.Z)(t)&&(0,l.Z)(e)&&this.editorManager.startEditCell(t,e,i)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(t,e){var i,r,n;let s;if(this.isCornerHeader(t,e)){let r=this.getHeaderDefine(t,e);s=null!=(i=null==r?void 0:r.headerEditor)?i:this.options.headerEditor}else if(this.isHeader(t,e)){let i=this.getHeaderDefine(t,e);s=null!=(r=null==i?void 0:i.headerEditor)?r:this.options.headerEditor}else{let i=this.getBodyColumnDefine(t,e);s=null!=(n=null==i?void 0:i.editor)?n:this.options.editor}return"function"==typeof s&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),"string"==typeof s?v.U(s):s}isHasEditorDefine(t,e){var i;let r=this.getBodyColumnDefine(t,e),n=null!=(i=null==r?void 0:r.editor)?i:this.options.editor;return"function"==typeof n&&(n=n({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),(0,l.Z)(n)}changeCellValue(t,e,i,r=!1){var n,s;if(r&&this.isHasEditorDefine(t,e)||!1===r){let r=i,l=this.getCellOriginValue(t,e),a=this.getCellRawValue(t,e);"number"==typeof a&&(0,x.Zf)(i)&&(r=parseFloat(i)),this._changeCellValueToDataSet(t,e,l,r);let o=this.getCellRange(t,e);for(let t=o.start.col;t<=o.end.col;t++)for(let e=o.start.row;e<=o.end.row;e++)this.scenegraph.updateCellContent(t,e);if(null!=(s=null==(n=this.options.dataConfig)?void 0:n.updateAggregationOnEditCell)&&s)for(let t=0;t<this.colCount;t++)for(let e=0;e<this.rowCount;e++)this.internalProps.layoutMap.isAggregation(t,e)&&this.scenegraph.updateCellContent(t,e);if("adaptive"===this.widthMode||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)0===this.internalProps._widthResizedColMap.size&&this.scenegraph.recalculateColWidths();else if(!this.internalProps._widthResizedColMap.has(t)){let e=this.getColWidth(t),i=(0,b.al)(t,0,this.rowCount-1,this,!1);i!==e&&this.scenegraph.updateColWidth(t,i-e)}if("adaptive"===this.heightMode||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)0===this.internalProps._heightResizedRowMap.size&&this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight(e)&&!this.internalProps._heightResizedRowMap.has(e)){let t=this.getRowHeight(e),i=(0,_.P)(e,0,this.colCount-1,this);this.scenegraph.updateRowHeight(e,i-t)}l!==r&&this.fireListeners(m.B.CHANGE_CELL_VALUE,{col:t,row:e,rawValue:a,currentValue:l,changedValue:r}),this.scenegraph.updateNextFrame()}}changeCellValues(t,e,i,r=!1){var n,s;let l=t,a=e,o=[],h=[];for(let r=0;r<i.length&&!(e+r>this.rowCount-1);r++){let n=i[r],s=[],l=[];o.push(s),h.push(l);for(let i=0;i<n.length&&!(t+i>this.colCount-1);i++){let n=this.getCellRawValue(t+i,e+r);s.push(n);let a=this.getCellOriginValue(t+i,e+r);l.push(a)}}for(let n=0;n<i.length&&!(e+n>this.rowCount-1);n++){a=e+n;let s=i[n],u=t;for(let i=0;i<s.length&&!(t+i>this.colCount-1);i++)if(u=t+i,r&&this.isHasEditorDefine(t+i,e+n)||!1===r){let r=s[i],l=r,a=h[n][i],u=o[n][i];"number"==typeof u&&(0,x.Zf)(r)&&(l=parseFloat(r)),this._changeCellValueToDataSet(t+i,e+n,a,l);let d=this.getCellOriginValue(t+i,e+n);d!==a&&this.fireListeners(m.B.CHANGE_CELL_VALUE,{col:t+i,row:e+n,rawValue:u,currentValue:a,changedValue:d})}l=Math.max(l,u)}let u=this.getCellRange(t,e),d=this.getCellRange(l,a);for(let t=u.start.col;t<=d.end.col;t++)for(let e=u.start.row;e<=d.end.row;e++)this.scenegraph.updateCellContent(t,e);if(null!=(s=null==(n=this.options.dataConfig)?void 0:n.updateAggregationOnEditCell)&&s)for(let t=0;t<this.colCount;t++)for(let e=0;e<this.rowCount;e++)this.internalProps.layoutMap.isAggregation(t,e)&&this.scenegraph.updateCellContent(t,e);if("adaptive"===this.widthMode||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)0===this.internalProps._widthResizedColMap.size&&this.scenegraph.recalculateColWidths();else for(let e=t;e<=d.end.col;e++)if(!this.internalProps._widthResizedColMap.has(e)){let t=this.getColWidth(e),i=(0,b.al)(e,0,this.rowCount-1,this,!1);i!==t&&this.scenegraph.updateColWidth(e,i-t)}if("adaptive"===this.heightMode||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight(e)){let t=[],i=[];for(let r=e;r<=d.end.row;r++)if(this.rowHeightsMap.get(r)){let e=this.getRowHeight(r),n=(0,_.P)(r,0,this.colCount-1,this);t.push(r),i.push(n-e)}this.scenegraph.updateRowsHeight(t,i)}this.scenegraph.updateNextFrame()}_changeCellValueToDataSet(t,e,i,r){var n,s,l,a,o,h,u,d;if(this.internalProps.recordsIsTwoDimensionalArray){let i=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);this.records[i][n]=r}else if(this.dataset){let h=this.internalProps.layoutMap.getCellHeaderPaths(t,e);if(this.isCornerHeader(t,e))this.internalProps.layoutMap.changeCornerTitle(t,e,r);else if(this.isHeader(t,e))this.internalProps.layoutMap.changeTreeNodeTitle(t,e,r),this.isCornerHeader(t,e)||this.dataset.changeRecordFieldValue((null==(n=h.colHeaderPaths)?void 0:n.length)?null!=(s=h.colHeaderPaths[h.colHeaderPaths.length-1].indicatorKey)?s:h.colHeaderPaths[h.colHeaderPaths.length-1].dimensionKey:null!=(l=h.rowHeaderPaths[h.rowHeaderPaths.length-1].indicatorKey)?l:h.rowHeaderPaths[h.rowHeaderPaths.length-1].dimensionKey,i,r);else{let i=null==(a=h.colHeaderPaths)?void 0:a.filter(t=>!t.virtual).map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=null==(o=h.rowHeaderPaths)?void 0:o.filter(t=>!t.virtual).map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value});this.dataset.changeTreeNodeValue(this.internalProps.layoutMap.indicatorsAsCol?n:n.slice(0,-1),this.internalProps.layoutMap.indicatorsAsCol?i.slice(0,-1):i,this.internalProps.layoutMap.getIndicatorKey(t,e),r)}}else if(this.flatDataToObjects){let n=this.internalProps.layoutMap.getCellHeaderPaths(t,e);if(this.isHeader(t,e))this.internalProps.layoutMap.changeTreeNodeTitle(t,e,r),this.isCornerHeader(t,e)||this.flatDataToObjects.changeRecordFieldValue((null==(h=n.colHeaderPaths)?void 0:h.length)?null!=(u=n.colHeaderPaths[n.colHeaderPaths.length-1].indicatorKey)?u:n.colHeaderPaths[n.colHeaderPaths.length-1].dimensionKey:null!=(d=n.rowHeaderPaths[n.rowHeaderPaths.length-1].indicatorKey)?d:n.rowHeaderPaths[n.rowHeaderPaths.length-1].dimensionKey,i,r);else{let i=n.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),s=n.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value});this.flatDataToObjects.changeTreeNodeValue(s,i,this.internalProps.layoutMap.getBody(t,e).indicatorKey,r)}}}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;let{columnsDefine:t,rowsDefine:e,indicatorsDefine:i}=this.internalProps.layoutMap;for(let e=0;e<t.length;e++){let i=t[e];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let t=0;t<e.length;t++){let i=e[t];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let t=0;t<i.length;t++){let e=i[t];if("string"!=typeof e&&(e.customLayout||e.headerCustomLayout||e.customRender||e.headerCustomRender))return!0}return!1}changeRecordOrder(t,e){}setTreeNodeChildren(t,e,i,r){this.flatDataToObjects?(this.internalProps.layoutMap.getHeadNode(i,r).children=t,this._refreshHierarchyState(i,r,!0,()=>{this.flatDataToObjects.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey}),this.flatDataToObjects.addRecords(e)})):(this.internalProps.layoutMap.getHeadNode(i,r).children=t,this._refreshHierarchyState(i,r,!0,()=>{this.dataset._rowTreeHasChanged(),this.dataset.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys}),this.dataset.addRecords(e)}))}updateFilterRules(t,e=!1){this.internalProps.dataConfig.filterRules=t,e?(this.dataset.updateFilterRules(t,!0),this.internalProps.layoutMap.resetHeaderTree()):this.dataset.updateFilterRules(t),this.renderWithRecreateCells()}getFilteredRecords(){var t;return null==(t=this.dataset)?void 0:t.filteredRecords}getCellPivotRole(t,e){let{cellLocation:i,colHeaderPaths:r,rowHeaderPaths:n}=this.getCellHeaderPaths(t,e),s=r.length?"normal":void 0,l=n.length?"normal":void 0;return r.forEach(t=>{"sub-total"===t.role?s="sub-total":"grand-total"===t.role&&(s="grand-total")}),n.forEach(t=>{"sub-total"===t.role?l="sub-total":"grand-total"===t.role&&(l="grand-total")}),{colRole:s,rowRole:l,cellLocation:i}}setLoadingHierarchyState(t,e){this.scenegraph.setLoadingHierarchyState(t,e)}expandAllForRowTree(){"tree"!==this.rowHierarchyType&&"grid-tree"!==this.rowHierarchyType||this.internalProps.layoutMap.rowDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.expandAllForRowDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:n.g.expand,changeAll:!0}))}collapseAllForRowTree(){"tree"!==this.rowHierarchyType&&"grid-tree"!==this.rowHierarchyType||this.internalProps.layoutMap.rowDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.collapseAllForRowDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:n.g.collapse,changeAll:!0}))}expandAllForColumnTree(){"grid-tree"===this.columnHierarchyType&&this.internalProps.layoutMap.columnDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.expandAllForColumnDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:n.g.expand,changeAll:!0}))}collapseAllForColumnTree(){"grid-tree"===this.columnHierarchyType&&this.internalProps.layoutMap.columnDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.collapseAllForColumnDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:n.g.collapse,changeAll:!0}))}release(){var t;this.internalProps.layoutMap.clearHeaderPathCache(),null==(t=this.editorManager)||t.release(),super.release()}}},43894:function(t,e,i){"use strict";i.d(e,{U:()=>l,f:()=>n});var r=i(57657);let n={},s={};function l(){return(0,r.l7)(s,n)}},94055:function(t,e,i){"use strict";i.d(e,{UP:()=>g,b8:()=>p,$M:()=>d,iR:()=>u,Zu:()=>c,sG:()=>f});var r=i(91212),n=i(29753),s=i(8287),l=i(58853),a=i(16369),o=i(67003);let h={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}},u="PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",d=14,c={FONT_FAMILY:u,LABEL_FONT_SIZE:14,MAP_LABEL_FONT_SIZE:10,TITLE_FONT_SIZE:18,AXIS_TICK_SIZE:4},p={domainLine:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,tickSize:c.AXIS_TICK_SIZE,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,tickSize:c.AXIS_TICK_SIZE/2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},label:{visible:!0,space:1,style:{fontSize:c.LABEL_FONT_SIZE,fill:"#89909D",fontWeight:"normal",fillOpacity:1},autoLimit:!0},title:{space:10,style:{fontSize:c.LABEL_FONT_SIZE,fill:"#333333",fontWeight:"normal",fillOpacity:1}}};function g(t){var e,i;return(null==(i=null==(e=null==t?void 0:t.colorScheme)?void 0:e.default)?void 0:i.palette)?(0,r.Z)({},p,{tick:{style:{stroke:t.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},subTick:{style:{stroke:t.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},label:{style:{fill:t.colorScheme.default.palette.axisLabelFontColor||"#89909D"}},title:{style:{fill:t.colorScheme.default.palette.secondaryFontColor||"#333333"}}}):p}function f(t){var e,i,u,d,c,p,g,f,m,y,v,b,_;let x=(0,r.Z)({},t),C,w=null!=(i=null==(e=x.title)?void 0:e.angle)?i:0;"left"!==x.orient&&"right"!==x.orient||(null==(u=x.title)?void 0:u.autoRotate)&&(0,n.Z)(x.title.angle)&&(w="left"===x.orient?-90:90,C=h[x.orient]);let S=function(t,e){if(!t||!(0,s.Z)(t))return t;let i={};return Object.keys(t).forEach(r=>{let n=t[r],s=!1;e.forEach(t=>{((0,l.Z)(t)&&t===r||t instanceof RegExp&&r.match(t))&&(s=!0)}),s||(i[r]=n)}),i}(x.label,["style","formatMethod","state"]);return{orient:x.orient,select:x.select,hover:x.hover,line:(0,o.lc)(x.domainLine),label:Object.assign({style:(0,o.h_)(x.label.style),formatMethod:x.label.formatMethod?(t,e,i)=>x.label.formatMethod(e.rawValue,e):null,state:(0,o.Zv)(x.label.state)},S),tick:{visible:x.tick.visible,length:x.tick.tickSize,inside:x.tick.inside,alignWithLabel:x.tick.alignWithLabel,style:(0,o.h_)(x.tick.style),state:(0,o.Zv)(x.tick.state),dataFilter:x.tick.dataFilter},subTick:{visible:x.subTick.visible,length:x.subTick.tickSize,inside:x.subTick.inside,count:x.subTick.tickCount,style:(0,o.h_)(x.subTick.style),state:(0,o.Zv)(x.subTick.state)},grid:{type:"line",visible:x.grid.visible,alternateColor:x.grid.alternateColor,alignWithLabel:x.grid.alignWithLabel,style:(0,o.h_)(x.grid.style)},subGrid:{type:"line",visible:x.subGrid.visible,alternateColor:x.subGrid.alternateColor,style:(0,o.h_)(x.subGrid.style)},title:{visible:x.title.visible,position:x.title.position,space:x.title.space,autoRotate:!1,angle:w?(0,a.M4)(w):null,textStyle:(0,r.Z)({},C,(0,o.h_)(x.title.style)),padding:x.title.padding,shape:{visible:null==(d=x.title.shape)?void 0:d.visible,space:null==(c=x.title.shape)?void 0:c.space,style:(0,o.h_)(null==(p=x.title.shape)?void 0:p.style)},background:{visible:null==(g=x.title.background)?void 0:g.visible,style:(0,o.h_)(null==(f=x.title.background)?void 0:f.style)},state:{text:(0,o.Zv)(x.title.state),shape:(0,o.Zv)(null==(m=x.title.shape)?void 0:m.state),background:(0,o.Zv)(null==(y=x.title.background)?void 0:y.state)}},panel:{visible:null==(v=x.background)?void 0:v.visible,style:(0,o.h_)(null==(b=x.background)?void 0:b.style),state:(0,o.Zv)(null==(_=x.background)?void 0:_.state)}}}},89082:function(t,e,i){"use strict";i.d(e,{Mh:()=>t7,Eg:()=>t4,ph:()=>et,FD:()=>t8,_t:()=>t9,R2:()=>t5,I:()=>t6});var r,n,s=i(13844),l=i(81774),a=i(91212),o=i(33657),h=i(29753),u=i(16369),d=i(84788),c=i(94055);function p(t){return"bottom"===t||"top"===t}var g=i(44787),f=i(43735);class m{constructor(){this._scale=new g.j,this._scales=[this._scale]}valueToPosition(t){return this._scale.scale(t)}getPosition(t){let e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{let r=Math.min(t.length,this._scales.length);for(let i=0;i<r;i++)e+=this._scales[i].scale(t[i]);i=this._scales[r-1]}return{position:e,bandScale:i}}calcScales(t,e){var i,r;let{bandPadding:n,paddingInner:s,paddingOuter:l}=this,a=(0,f.Z)(n),o=(0,f.Z)(s),h=(0,f.Z)(l);for(let u=0;u<this._scales.length;u++){let d=a?n[u]:n,c=o?s[u]:s,p=h?l[u]:l;this._scales[u].paddingInner(null!=(i=null!=c?c:d)?i:t,!0).paddingOuter(null!=(r=null!=p?p:d)?r:e)}}dataToPosition(t,e={}){var i;if(0===t.length||0===this._scales.length)return 0;let{position:r,bandScale:n}=this.getPosition(t);return r+n.bandwidth()*(null!=(i=e.bandPosition)?i:.5)}updateScaleDomain(t){for(let e=0;e<this._scales.length;e++)this._scales[e].domain(t)}updateRange(t){let[e,i]=this._scale.range();t[0]===e&&t[1]===i||this._scale.range(t)}}var y=i(21883),v=i.n(y),b=i(12709);let _="undefined"!=typeof console;function x(t,e,i){let r=[e].concat([].slice.call(i));_&&console[t].apply(console,r)}(r=n||(n={}))[r.None=0]="None",r[r.Error=1]="Error",r[r.Warn=2]="Warn",r[r.Info=3]="Info",r[r.Debug=4]="Debug";class C{static getInstance(t,e){return C._instance&&(0,b.Z)(t)?C._instance.level(t):C._instance||(C._instance=new C(t,e)),C._instance}static setInstance(t){return C._instance=t}static setInstanceLevel(t){C._instance?C._instance.level(t):C._instance=new C(t)}static clearInstance(){C._instance=null}constructor(t=n.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){let e=this._onErrorHandler.findIndex(e=>e===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=n.Info}canLogDebug(){return this._level>=n.Debug}canLogError(){return this._level>=n.Error}canLogWarn(){return this._level>=n.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=n.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):x(null!=(e=this._method)?e:"error","ERROR",t)),this}warn(...t){return this._level>=n.Warn&&x(this._method||"warn","WARN",t),this}info(...t){return this._level>=n.Info&&x(this._method||"log","INFO",t),this}debug(...t){return this._level>=n.Debug&&x(this._method||"log","DEBUG",t),this}}C._instance=null;var w=i(42769);class S{constructor(t){var e;let i;this.options=t,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new(v()),i=(null==t?void 0:t.name)?t.name:(0,w.F)("dataset"),this.name=i,this._logger=null!=(e=null==t?void 0:t.logger)?e:C.getInstance()}setLogger(t){this._logger=t}getDataView(t){return this.dataViewMap[t]}setDataView(t,e){var i;this.dataViewMap[t]&&(null==(i=this._logger)||i.error(`Error: dataView ${t} 之前已存在，请重新命名`)),this.dataViewMap[t]=e}removeDataView(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}registerParser(t,e){var i;this.parserMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.parserMap[t]=e}removeParser(t){this.parserMap[t]=null,delete this.parserMap[t]}getParser(t){return this.parserMap[t]||this.parserMap.default}registerTransform(t,e){var i;this.transformMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.transformMap[t]=e}removeTransform(t){this.transformMap[t]=null,delete this.transformMap[t]}getTransform(t){return this.transformMap[t]}multipleDataViewAddListener(t,e,i){this._callMap||(this._callMap=new Map);let r=this._callMap.get(i);r||(r=()=>{t.some(t=>t.isRunning)||i()}),t.forEach(t=>{t.target.addListener(e,r)}),this._callMap.set(i,r)}allDataViewAddListener(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}multipleDataViewRemoveListener(t,e,i){if(this._callMap){let r=this._callMap.get(i);r&&t.forEach(t=>{t.target.removeListener(e,r)}),this._callMap.delete(i)}}multipleDataViewUpdateInParse(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.parseNewData(t.data,t.options)})}multipleDataViewUpdateInRawData(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.updateRawData(t.data,t.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}var A=i(43286),M=i(83143),k=i(31943),T=i(94051),R=i(84964),B=i(5533);let P=(t,e)=>{if((0,M.z2)(t.type))return(0,k.m)(t,e);if((0,M.lK)(t.type)){if("cartesian"===e.coordinateType)return(0,T.U)(t,e);if("polar"===e.coordinateType&&"angle"===e.axisOrientType)return(0,R.t)(t,e)}return(0,B.KV)(t.domain())};var E=i(37352),I=i(25777),L=i(32889),F=i(18585),O=i(50071);let D=Math.sqrt(50),H=Math.sqrt(10),z=Math.sqrt(2);class W{constructor(t){this._extend={},this.type=null!=t?t:"linear",this._scale="log"===t?new E.Y:"symlog"===t?new I.g:new L.f,this._scales=[this._scale]}setExtraAttrFromSpec(t,e,i,r,n,s){this.nice=!1,this.zero=e,this.zero&&(i.min=Math.min(i.min,0),i.max=Math.max(i.max,0)),this.domain=i,this.expand=r,"log"===this.type?this._scale.base(null!=n?n:10):"symlog"===this.type&&this._scale.constant(null!=s?s:10)}transformScaleDomain(){"symlog"===this.type||"log"===this.type||this.setScaleNice()}setScaleNice(){"log"===this.type?this.setLogScaleNice():this.setLinearScaleNice()}setLogScaleNice(){var t,e,i,r,n,s;(0,h.Z)(null==(t=this.domain)?void 0:t.min)&&(0,h.Z)(null==(e=this.domain)?void 0:e.max)?this.nice&&this._scale.nice():(0,F.Z)(null==(i=this.domain)?void 0:i.min)&&(0,h.Z)(null==(r=this.domain)?void 0:r.max)?this.nice&&this._scale.niceMax():(0,h.Z)(null==(n=this.domain)?void 0:n.min)&&(0,F.Z)(null==(s=this.domain)?void 0:s.max)&&this.nice&&this._scale.niceMin()}setLinearScaleNice(){var t,e,i,r,n,s,l,a;let o=null!=(e=null!=(t=this.forceTickCount)?t:this.tickCount)?e:10;"accurateFirst"===this.niceType&&(o=Math.max(10,o)),(0,h.Z)(null==(i=this.domain)?void 0:i.min)&&(0,h.Z)(null==(r=this.domain)?void 0:r.max)?this.nice&&this._scale.nice(o):(0,F.Z)(null==(n=this.domain)?void 0:n.min)&&(0,h.Z)(null==(s=this.domain)?void 0:s.max)?this.nice&&this._scale.niceMax(o):(0,h.Z)(null==(l=this.domain)?void 0:l.min)&&(0,F.Z)(null==(a=this.domain)?void 0:a.max)?this.nice&&this._scale.niceMin(o):this.nice&&this._scale.nice(o)}dataToPosition(t){return this.valueToPosition(t[0])}valueToPosition(t){return this._scale.scale(t)}computeLinearDomain(t){let e=[];return t.forEach(t=>{let{min:i,max:r}=t;e[0]=void 0===e[0]?i:Math.min(e[0],i),e[1]=void 0===e[1]?r:Math.max(e[1],r)}),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e}expandDomain(t){if(!this.expand)return;let e=t[0],i=t[t.length-1];(0,F.Z)(this.expand.min)&&(t[0]=e-(i-e)*this.expand.min),(0,F.Z)(this.expand.max)&&(t[t.length-1]=i+(i-e)*this.expand.max)}niceDomain(t){if((0,F.Z)(t[0])||(0,F.Z)(t[1])||"linear"!==this.type)return t;if(1e-12>=Math.abs((0,O.iH)(t)-(0,O.CE)(t))){let e=t[0],i=e>=0?1:-1;if((e=Math.abs(e))<1)t[0]=0,t[1]=1;else{let i=e/5,r=Math.floor(Math.log(i)/Math.LN10),n=i/Math.pow(10,r);i=(n>=D?10:n>=H?5:n>=z?2:1)*Math.pow(10,r),t[0]=0,t[1]=10*i}i<0&&(t.reverse(),t[0]*=-1,t[1]*=-1)}return t}niceMinMax(){var t,e,i,r,n,s,l,a;if(this.nice){let o=null!=(e=null!=(t=this.forceTickCount)?t:this.tickCount)?e:10;"accurateFirst"===this.niceType&&(o=Math.max(10,o)),(0,h.Z)(null==(i=this.domain)?void 0:i.min)&&(0,h.Z)(null==(r=this.domain)?void 0:r.max)?this._scale.nice(o):(0,F.Z)(null==(n=this.domain)?void 0:n.min)&&(0,h.Z)(null==(s=this.domain)?void 0:s.max)?this._scale.niceMax(o):(0,h.Z)(null==(l=this.domain)?void 0:l.min)&&(0,F.Z)(null==(a=this.domain)?void 0:a.max)?this._scale.niceMin(o):this._scale.nice(o)}}includeZero(t){this.zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(t[t.length-1],0))}setExtendDomain(t,e){if(void 0===e)return void delete this._extend[t];this._extend[t]=e;let i=this._scale.domain();this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this.nice),this.niceMinMax()}extendDomain(t){let e,i=t.length-1,r=t[0]-t[i]>0,n=r?i:0,s=r?0:i;for(let i in this._extend)(e=this._extend[i])>t[s]&&(t[s]=e),e<t[n]&&(t[n]=e)}setDomainMinMax(t){if(!this.domain)return;let{min:e,max:i}=this.domain;(0,F.Z)(e)&&(t[0]=e),(0,F.Z)(i)&&(t[1]=i)}setZero(t){this.zero!==t&&(this.zero=t,this.updateScaleDomain())}updateScaleDomain(){let t=this.computeDomain([this.domain]);this.updateScaleDomainByModel(t)}computeDomain(t){return this.computeLinearDomain(t)}updateScaleDomainByModel(t){t=null!=t?t:this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this.nice),this.niceMinMax()}updateRange(t){let[e,i]=this._scale.range();t[0]===e&&t[1]===i||this._scale.range(t)}}var N=i(43572);function j(t,e){var i;let r=e.option;(0,N.Z)(t)||(null==(i=null==r?void 0:r.label)?void 0:i.flush)&&function(t,e){let{width:i,height:r}=e.getLayoutRect(),n=p(e.orient),s=!0===e.option.inverse,l=t[0],a=(0,O.Z$)(t);if(n)if(s){let t=l.AABBBounds.x2,e=a.AABBBounds.x1;t>i&&l.setAttributes({x:i,textAlign:"right"}),e<0&&a.setAttributes({x:0,textAlign:"left"})}else{let t=l.AABBBounds.x1,e=a.AABBBounds.x2;t<0&&l.setAttributes({x:0,textAlign:"left"}),e>i&&a.setAttributes({x:i,textAlign:"right"})}else if(s){let t=l.AABBBounds.y1,e=a.AABBBounds.y2;t<0&&l.setAttributes({y:0,textBaseline:"top"}),e>r&&a.setAttributes({y:r,textBaseline:"bottom"})}else{let t=l.AABBBounds.y2,e=a.AABBBounds.y1;t>r&&l.setAttributes({y:r,textBaseline:"bottom"}),e<0&&a.setAttributes({y:0,textBaseline:"top"})}}(t,e)}let G=t=>t;class V{constructor(t,e,i,r,n){var s,l,o,h,u;let d;(this.x=0,this.y=0,this.padding=r,this.table=n,this.orient=null!=(s=t.orient)?s:"left",this.type=null!=(l=t.type)?l:"band",this.option=(0,a.Z)({},(0,c.UP)(t.__vtableChartTheme),(h=this.orient,u=n.theme,"left"===h?d=u.axisStyle.leftAxisStyle:"right"===h?d=u.axisStyle.rightAxisStyle:"top"===h?d=u.axisStyle.topAxisStyle:"bottom"===h&&(d=u.axisStyle.bottomAxisStyle),(0,a.Z)({},u.axisStyle.defaultAxisStyle,d)),function(t,e,i){let r,n;if(!i)return{};let s=i.axis;return"linear"===e||"log"===e||"symlog"===e?r=i.axisLinear:"band"===e&&(r=i.axisBand),"top"===t||"bottom"===t?n=i.axisX:"left"!==t&&"right"!==t||(n=i.axisY),(0,a.Z)({},s,r,n)}(this.orient,this.type,t.__vtableChartTheme),t),"left"===this.orient||"right"===this.orient)?(this.width=e,this.height=i-r[0]-r[2]-0,this.y=r[0]+0):("top"===this.orient||"bottom"===this.orient)&&(this.width=e-r[1]-r[3]-0,this.height=i,this.x=r[3]+0),this.visible=null==(o=t.visible)||o,this.inverse="inverse"in t&&!!t.inverse,"band"===t.type&&(this.data=t.domain),this.initScale(),this.initData(),this.createComponent(),this.initEvent()}initScale(){let t=this.option;"band"===this.type||"point"===this.type?(this.scale=new m,this.scale.bandPadding=t.bandPadding,this.scale.paddingInner=t.paddingInner,this.scale.paddingOuter=t.paddingOuter,this.scale.calcScales(.1,.3),this.scale.updateScaleDomain(this.data),this.updateScaleRange()):"linear"!==this.type&&"time"!==this.type&&"log"!==this.type&&"symlog"!==this.type||(this.scale=new W(this.type),this.scale.setExtraAttrFromSpec(t.nice,t.zero,t.range,t.expand,t.base,t.constant),this.scale.transformScaleDomain(),this.scale.updateScaleDomain(),this.updateScaleRange())}initData(){var t,e,i,r;this.table._vDataSet||(this.table._vDataSet=new S),t=this.table._vDataSet,e="scale",t.getParser(e)||t.registerParser(e,G),i=this.table._vDataSet,r="ticks",i.getTransform(r)||i.registerTransform(r,P);let n=this.option.label||{},s=this.option.tick||{},l=new A.VO(this.table._vDataSet).parse(this.scale._scale,{type:"scale"}).transform({type:"ticks",options:{sampling:!1!==this.option.sampling,tickCount:s.tickCount,forceTickCount:s.forceTickCount,tickStep:s.tickStep,tickMode:s.tickMode,noDecimals:s.noDecimals,axisOrientType:this.orient,coordinateType:"cartesian",labelStyle:n.style,labelFormatter:n.formatMethod,labelGap:n.minGap,labelLastVisible:n.lastVisible,labelFlush:n.flush}},!1);this.tickData=l,this.computeData()}computeData(){this.tickData.reRunAllTransform()}initEvent(){}createComponent(){let t=(0,c.sG)(this.option),e=this.getUpdateAttribute();e.verticalFactor="top"===this.orient||"right"===this.orient?-1:1,this.component=new d.$((0,a.Z)({disableTriggerEvent:this.table.options.disableInteraction},t,e)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.component.originAxis=this}resize(t,e){this.width=t-("top"===this.orient||"bottom"===this.orient?this.padding[1]+this.padding[3]:0),this.height=e-("left"===this.orient||"right"===this.orient?this.padding[2]+this.padding[0]:0),this.updateScaleRange(),this.computeData();let i=(0,c.sG)(this.option),r=this.getUpdateAttribute();r.verticalFactor="top"===this.orient||"right"===this.orient?-1:1,this.component.setAttributes((0,a.Z)({},i,r)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.overlap()}overlap(){!function(t,e){let i=t.find(t=>"axis-label-container-layer-0"===t.name,!0),r=t.find(t=>"axis-label-container-layer-1"===t.name,!0);j(i?i.getChildren():[],e),j(r?r.getChildren():[],e)}(this.component,this)}getLayoutRect(){return{width:this.width,height:this.height}}getUpdateAttribute(){var t;this.table.tableNoFrameHeight,this.table.tableNoFrameWidth;let{width:e,height:i}=this.getLayoutRect(),r=p(this.orient),n="left"===(t=this.orient)||"right"===t,s={x:0,y:0},l=0;r?(s={x:e,y:0},l=e):n&&(s={x:0,y:i},l=i);let a="top"===this.orient||"bottom"===this.orient?i:e;return{start:{x:0,y:0},end:s,title:{text:this.option.title.text,maxWidth:this._getTitleLimit(r)},items:this.getLabelItems(l),verticalLimitSize:a,verticalMinSize:a}}getLabelItems(t){return[this.tickData.latestData.map(e=>({id:e.value,label:e.value,value:0===t?0:this.scale.dataToPosition([e.value])/t,rawValue:e.value})).filter(t=>t.value>=0&&t.value<=1)]}updateScaleRange(){var t,e,i,r,n,s,l,a;let h=null!=(e=null==(t=this.option.innerOffset)?void 0:t.right)?e:0,u=null!=(r=null==(i=this.option.innerOffset)?void 0:i.left)?r:0,d=null!=(s=null==(n=this.option.innerOffset)?void 0:n.top)?s:0,c=null!=(a=null==(l=this.option.innerOffset)?void 0:l.bottom)?a:0,{width:g,height:f}=this.getLayoutRect(),m=this.option.inverse||!1,y=[0,0];p(this.orient)?(0,o.Z)(g)&&(y=m?[g-h,u]:[u,g-h]):(0,o.Z)(f)&&(y=m?[d,f-c]:[f-c,d]),this.scale.updateRange(y)}setLayoutStartPosition(t){let{x:e,y:i}=t;return(0,o.Z)(e)&&(e+=Number("left"===this.orient)*this.getLayoutRect().width),(0,o.Z)(i)&&(i+=Number("top"===this.orient)*this.getLayoutRect().height),{x:e,y:i}}_getTitleLimit(t){var e,i,r;if(this.option.title.visible&&(0,h.Z)(null==(e=this.option.title.style)?void 0:e.maxLineWidth)){let e=(null==(i=this.option.title.style)?void 0:i.angle)||0;if((null==(r=this.option.title)?void 0:r.autoRotate)&&(0,h.Z)(this.option.title.angle)&&(e="left"===this.option.orient?-90:90),t){let t=this.getLayoutRect().width,i=Math.abs(Math.cos((0,u.M4)(e)));return i<1e-6?1/0:t/i}let n=this.getLayoutRect().height,s=Math.abs(Math.sin((0,u.M4)(e)));return s<1e-6?1/0:n/s}return null}getScale(){return this.scale._scale}getDomainSpec(){return this.scale.domain}}var Z=i(70506),U=i(58853);function K(t,e){var i,r,n,s,l,o,h,u,d,p,g,m,y,v,b,_,x,C;let w=(0,a.Z)({},c.b8,t),S=0;!1!==w.tick.visible&&(S=null!=(i=w.tick.width)?i:4);let A=0;if(w.label.visible){if("band"===w.type)w.domain.forEach(t=>{var i,r,n,s,l,a,o,h,u,d,p,g,f,m,y,v;w.label.formatMethod&&(t=w.label.formatMethod(t));let{width:b,height:_}=e.measureText(t,{fontSize:null!=(n=null==(r=null==(i=w.label)?void 0:i.style)?void 0:r.fontSize)?n:c.$M,fontWeight:null!=(a=null==(l=null==(s=w.label)?void 0:s.style)?void 0:l.fontWeight)?a:"normal",fontFamily:null!=(u=null==(h=null==(o=w.label)?void 0:o.style)?void 0:h.fontFamily)?u:c.iR}),x=(null==(p=null==(d=w.label)?void 0:d.style)?void 0:p.maxLineWidth)||1/0,C=(null!=(m=null==(f=null==(g=w.label)?void 0:g.style)?void 0:f.angle)?m:0)+90*("vertical"===(null==(v=null==(y=w.label)?void 0:y.style)?void 0:v.direction));A=Math.max(A,X(Math.min(b,x),_,C).width)});else{let i;if((null==(r=t.sync)?void 0:r.tickAlign)&&(0,Z.Z)(null==(n=t.tick)?void 0:n.tickMode))i=t.tick.tickMode();else if((0,f.Z)(t.__ticksForVTable))i=t.__ticksForVTable;else{let t=w.range,e=Math.abs(t.min)>1?Math.round(t.min):t.min,r=Math.abs(t.max)>1?Math.round(t.max):t.max;i=[Y(e),Y(r)]}i.forEach(t=>{var i,r,n,s,l,a,o,h,u,d,p,g,f,m,y,v;w.label.formatMethod&&(t=w.label.formatMethod(t));let{width:b,height:_}=e.measureText(t,{fontSize:null!=(n=null==(r=null==(i=w.label)?void 0:i.style)?void 0:r.fontSize)?n:c.$M,fontWeight:null!=(a=null==(l=null==(s=w.label)?void 0:s.style)?void 0:l.fontWeight)?a:"normal",fontFamily:null!=(u=null==(h=null==(o=w.label)?void 0:o.style)?void 0:h.fontFamily)?u:c.iR}),x=(null==(p=null==(d=w.label)?void 0:d.style)?void 0:p.maxLineWidth)||1/0,C=(null!=(m=null==(f=null==(g=w.label)?void 0:g.style)?void 0:f.angle)?m:0)+90*("vertical"===(null==(v=null==(y=w.label)?void 0:y.style)?void 0:v.direction));A=Math.max(A,X(Math.min(b,x),_,C).width)})}A+=null!=(s=w.label.space)?s:4}let M=0;if(w.title.visible&&(0,U.Z)(w.title.text)){let{width:i,height:r}=e.measureText(w.title.text,{fontSize:null!=(h=null==(o=null==(l=w.title)?void 0:l.style)?void 0:o.fontSize)?h:c.$M,fontWeight:null!=(p=null==(d=null==(u=w.title)?void 0:u.style)?void 0:d.fontWeight)?p:"normal",fontFamily:null!=(y=null==(m=null==(g=w.title)?void 0:g.style)?void 0:m.fontFamily)?y:c.iR}),n=X(Math.min(i,(null==(b=null==(v=w.label)?void 0:v.style)?void 0:b.maxLineWidth)||1/0),r,null==(x=null==(_=w.title)?void 0:_.style)?void 0:x.angle);M=(("left"===t.orient||"right"===t.orient)&&w.title.autoRotate?n.height:n.width)+(null!=(C=w.title.space)?C:4)}return Math.ceil(S+A+M+1)}function $(t,e){var i,r,n,s,l,o,h,u,d,p,g,m,y,v,b,_,x,C;let w=(0,a.Z)({},c.b8,t),S=0;!1!==w.tick.visible&&(S=null!=(i=w.tick.width)?i:4);let A=0;if(w.label.visible){if("band"===w.type)w.domain.forEach(t=>{var i,r,n,s,l,a,o,h,u,d,p,g,f,m,y,v;w.label.formatMethod&&(t=w.label.formatMethod(t));let{width:b,height:_}=e.measureText(t,{fontSize:null!=(n=null==(r=null==(i=w.label)?void 0:i.style)?void 0:r.fontSize)?n:c.$M,fontWeight:null!=(a=null==(l=null==(s=w.label)?void 0:s.style)?void 0:l.fontWeight)?a:"normal",fontFamily:null!=(u=null==(h=null==(o=w.label)?void 0:o.style)?void 0:h.fontFamily)?u:c.iR}),x=(null==(p=null==(d=w.label)?void 0:d.style)?void 0:p.maxLineWidth)||1/0,C=(null!=(m=null==(f=null==(g=w.label)?void 0:g.style)?void 0:f.angle)?m:0)+90*("vertical"===(null==(v=null==(y=w.label)?void 0:y.style)?void 0:v.direction));A=Math.max(A,X(Math.min(b,x),_,C).height)});else{let i;if((null==(r=t.sync)?void 0:r.tickAlign)&&(0,Z.Z)(null==(n=t.tick)?void 0:n.tickMode))i=t.tick.tickMode();else if((0,f.Z)(t.__ticksForVTable))i=t.__ticksForVTable;else{let t=w.range,e=Math.abs(t.min)>1?Math.round(t.min):t.min,r=Math.abs(t.max)>1?Math.round(t.max):t.max;i=[Y(e),Y(r)]}i.forEach(t=>{var i,r,n,s,l,a,o,h,u,d,p,g,f,m,y,v;w.label.formatMethod&&(t=w.label.formatMethod(t));let{width:b,height:_}=e.measureText(t,{fontSize:null!=(n=null==(r=null==(i=w.label)?void 0:i.style)?void 0:r.fontSize)?n:c.$M,fontWeight:null!=(a=null==(l=null==(s=w.label)?void 0:s.style)?void 0:l.fontWeight)?a:"normal",fontFamily:null!=(u=null==(h=null==(o=w.label)?void 0:o.style)?void 0:h.fontFamily)?u:c.iR}),x=(null==(p=null==(d=w.label)?void 0:d.style)?void 0:p.maxLineWidth)||1/0,C=(null!=(m=null==(f=null==(g=w.label)?void 0:g.style)?void 0:f.angle)?m:0)+90*("vertical"===(null==(v=null==(y=w.label)?void 0:y.style)?void 0:v.direction));A=Math.max(A,X(Math.min(b,x),_,C).height)})}A+=null!=(s=w.label.space)?s:4}let M=0;if(w.title.visible&&w.title.text){let{width:i,height:r}=e.measureText(w.title.text,{fontSize:null!=(h=null==(o=null==(l=w.title)?void 0:l.style)?void 0:o.fontSize)?h:c.$M,fontWeight:null!=(p=null==(d=null==(u=w.title)?void 0:u.style)?void 0:d.fontWeight)?p:"normal",fontFamily:null!=(y=null==(m=null==(g=w.title)?void 0:g.style)?void 0:m.fontFamily)?y:c.iR}),n=X(Math.min(i,(null==(b=null==(v=w.label)?void 0:v.style)?void 0:b.maxLineWidth)||1/0),r,null==(x=null==(_=w.title)?void 0:_.style)?void 0:x.angle);M=(("bottom"===t.orient||"top"===t.orient)&&w.title.autoRotate?n.width:n.height)+(null!=(C=w.title.space)?C:4)}return S+A+M+1}function Y(t){return"number"!=typeof t&&(t=Number(t)),Number(t.toPrecision(1)).toString()}function X(t,e,i=0){let r=i*Math.PI/180,n=-t/2,s=-e/2,l=t/2,a=-e/2,o=t/2,h=e/2,u=-t/2,d=e/2,c={x:n*Math.cos(r)-s*Math.sin(r),y:n*Math.sin(r)+s*Math.cos(r)},p={x:l*Math.cos(r)-a*Math.sin(r),y:l*Math.sin(r)+a*Math.cos(r)},g={x:o*Math.cos(r)-h*Math.sin(r),y:o*Math.sin(r)+h*Math.cos(r)},f={x:u*Math.cos(r)-d*Math.sin(r),y:u*Math.sin(r)+d*Math.cos(r)},m=Math.min(c.x,p.x,g.x,f.x),y=Math.max(c.x,p.x,g.x,f.x),v=Math.min(c.y,p.y,g.y,f.y);return{width:y-m,height:Math.max(c.y,p.y,g.y,f.y)-v}}var q=i(95950),J=i(74562),Q=i(77474),te=i(64103),ti=i(15589),tr=i(69877),tn=i(96628);(0,ti.M)(),(0,tr.g)(),(0,tn.i)();class ts extends J.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,q.Z)({},ts.defaultAttributes,t))}render(){this.removeAllChild(!0),this.renderIcon(),this.renderText(),this.layout()}renderIcon(){this._emptyTipIcon=new Q.E((0,q.Z)({image:this.attribute.icon.image},this.attribute.icon)),this.appendChild(this._emptyTipIcon)}renderText(){this._text=new te.x((0,q.Z)({wrap:!0},this.attribute.text)),this.appendChild(this._text)}layout(){let t=this.attribute.icon.height,e=this._text.AABBBounds.height(),i=this.attribute.icon.width,{width:r,height:n,spaceBetweenTextAndIcon:s}=this.attribute;this._emptyTipIcon.setAttribute("x",r/2-i/2),this._emptyTipIcon.setAttribute("y",n/2-t/2-e/2-s/2),this._text.setAttribute("x",r/2),this._text.setAttribute("textAlign","center"),this._text.setAttribute("y",n/2+t/2+s/2),this._text.setAttribute("textBaseline","middle")}}ts.defaultAttributes={spaceBetweenTextAndIcon:20,text:{text:"no data",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",pickable:!1},icon:{image:'<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>',width:100,height:100,pickable:!1}};var tl=i(8611),ta=i(22295);class to{constructor(t,e){this._emptyTipOption={spaceBetweenTextAndIcon:20,text:"no data",textStyle:{fontSize:14,color:"#000"},icon:{image:'<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>',width:100,height:100}},this.isReleased=!1,this.table=e,this._emptyTipOption=Object.assign(this._emptyTipOption,!0===t?{}:t),(0,F.Z)(this._emptyTipOption.displayMode)||(this.table.isListTable()?this._emptyTipOption.displayMode="basedOnTable":this._emptyTipOption.displayMode="basedOnContainer"),this._emptyTipComponent=this._createOrUpdateEmptyTipComponent(this._getEmptyTipAttrs())}_createOrUpdateEmptyTipComponent(t){if(this._emptyTipComponent)(0,tl.X)(t,this._cacheAttrs)||this._emptyTipComponent.setAttributes(t);else{let e=new ts(t);e.name="emptyTip",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._emptyTipComponent=e,this.bindEvents()}return this._emptyTipComponent}bindEvents(){this._emptyTipComponent.on("click",t=>{let e=new ta.FB;this._emptyTipComponent.forEachChildren(t=>{e.union(t.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_click",t)}),this._emptyTipComponent.on("dblclick",t=>{let e=new ta.FB;this._emptyTipComponent.forEachChildren(t=>{e.union(t.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_dblclick",t)})}resize(){var t;if(!this._emptyTipComponent)return;let{leftHeaderWidth:e,topHeaderHeight:i,width:r,height:n}=this.getWidthAndHeight();this._emptyTipComponent.setAttributes({spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+i,width:r,height:n,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:null==(t=this._emptyTipOption.textStyle)?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)})}release(){this._emptyTipComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent),this._emptyTipComponent=null,this.isReleased=!0}resetVisible(){(this.table.recordsCount&&0!==this.table.recordsCount||this.table.internalProps.layoutMap.rowCount!==this.table.internalProps.layoutMap.columnHeaderLevelCount)&&this.table.internalProps.layoutMap.colCount!==this.table.internalProps.layoutMap.rowHeaderLevelCount?this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent):this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)||this.table.scenegraph.stage.defaultLayer.appendChild(this._emptyTipComponent)}getWidthAndHeight(){let t=this.table.transpose||!1===this.table.options.indicatorsAsCol?this.table.getFrozenColsWidth():0,e=!this.table.transpose||this.table.options.indicatorsAsCol?this.table.getFrozenRowsHeight():0;return{leftHeaderWidth:t,topHeaderHeight:e,width:("basedOnContainer"!==this._emptyTipOption.displayMode&&this.table.columnHeaderLevelCount>0&&this.table.colCount>this.table.rowHeaderLevelCount?this.table.getDrawRange().width:this.table.tableNoFrameWidth)-t-this.table.getTheme().scrollStyle.width,height:("basedOnContainer"!==this._emptyTipOption.displayMode&&this.table.rowHeaderLevelCount>0&&this.table.rowCount>this.table.columnHeaderLevelCount?this.table.getDrawRange().height:this.table.tableNoFrameHeight)-e-this.table.getTheme().scrollStyle.width}}_getEmptyTipAttrs(){var t;let{leftHeaderWidth:e,topHeaderHeight:i,width:r,height:n}=this.getWidthAndHeight();return{spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+i,width:r,height:n,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:null==(t=this._emptyTipOption.textStyle)?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)}}}var th=i(19465);let tu=(t,e,i)=>{let r=(0,U.Z)(e)?e.split("."):e;for(let e=0;e<r.length;e++)t=t?t[r[e]]:void 0;return void 0===t?i:t};var td=i(48742),tc=i(35622),tp=i(16423),tg=i(67003),tf=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let tm={orient:"bottom",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fill:"#000000",fontWeight:"normal"},space:12},item:{visible:!0,spaceCol:10,spaceRow:10,padding:2,background:{state:{selectedHover:{fill:"gray",fillOpacity:.7},unSelectedHover:{fill:"gray",fillOpacity:.2}}},shape:{space:4,state:{unSelected:{fillOpacity:.5}}},label:{space:4,style:{fill:"#89909D",fontSize:14},state:{unSelected:{fillOpacity:.5}}}},allowAllCanceled:!0,visible:!0};var ty=i(99506),tv=i(14828);class tb{constructor(t,e){var i,r,n,s;this.table=e,this.option=(0,th.Z)(t),this.orient=null!=(i=t.orient)?i:"left",this.visible=null==(r=t.visible)||r,this.position=null!=(n=t.position)?n:"middle",this.selectedData=null!=(s=t.defaultSelected)?s:null,this.createComponent(),this.initEvent()}createComponent(){let t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),e=new td.W((0,a.Z)({},t,{defaultSelected:this.selectedData,disableTriggerEvent:this.table.options.disableInteraction}));e.name="legend",this.legendComponent=e,!1===this.visible&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){if(!this.legendComponent||!1===this.visible)return;let t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});this.legendComponent.setAttributes(t),this.adjustTableSize(this.legendComponent.attribute)}adjustTableSize(t){var e,i;if(!this.legendComponent||!1===this.visible)return;let r=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,n=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(r<=0||n<=0)return;let s=this.table.tableNoFrameWidth,l=this.table.tableNoFrameHeight,a=(0,tv.u)(null!=(i=null!=(e=t.padding)?e:this.option.padding)?i:10),o=0,h=0;"left"===this.orient?(o=a[3],h=0,r+=a[1]+a[3]):"top"===this.orient?(o=0,h=a[0],n+=a[0]+a[2]):"right"===this.orient?(o=s-r-a[1],h=0,r+=a[1]+a[3]):"bottom"===this.orient&&(o=0,h=l-n-a[2],n+=a[0]+a[2]);let u="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",d=this.position,c=0,p=0;"horizontal"===u?c="middle"===d?(s-r)/2:"end"===d?s-r-a[1]:a[3]:p="middle"===d?(l-n)/2:"end"===d?l-n-a[2]:a[0],this.legendComponent.setAttributes({dx:c,dy:p,x:o,y:h}),"left"===this.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r),this.table.tableX+=Math.ceil(r)):"top"===this.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n),this.table.tableY+=Math.ceil(n)):"right"===this.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r):"bottom"===this.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n))}getLegendAttributes(t){var e,i;let r="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",n=function(t,e){let i=(0,a.Z)({},tm,t),{title:r={},item:n={},pager:s={},background:l={},type:o,id:h,visible:u,orient:d,position:c,data:p,filter:g,regionId:f,regionIndex:m,seriesIndex:y,seriesId:v,padding:b}=i,_=tf(i,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return r.visible&&(_.title=(0,tg.qi)(r)),(0,N.Z)(n.focusIconStyle)||(0,tg.h_)(n.focusIconStyle),(0,tg.ro)(n.shape),(0,tg.ro)(n.label),(0,tg.ro)(n.value),(0,tg.ro)(n.background),(0,tp.hU)(n.maxWidth)&&(n.maxWidth=Number(n.maxWidth.substring(0,n.maxWidth.length-1))*e.width/100),(0,tp.hU)(n.width)&&(n.width=Number(n.width.substring(0,n.width.length-1))*e.width/100),(0,tp.hU)(n.height)&&(n.height=Number(n.height.substring(0,n.height.length-1))*e.width/100),_.item=n,(0,N.Z)(s.textStyle)||(0,tg.h_)(s.textStyle),(0,tg.ro)(s.handler),_.pager=s,l.visible&&!(0,N.Z)(l.style)&&((0,a.Z)(_,l.style),(0,F.Z)(l.padding)&&(_.padding=l.padding)),_}(this.option,t),s=(0,tv.u)(null!=(i=null!=(e=n.padding)?e:this.option.padding)?i:10);return Object.assign({layout:r,items:this.getLegendItems(),maxWidth:t.width-s[1]-s[3],maxHeight:t.height-s[0]-s[2]},n)}getLegendItems(){return this.option.data}initEvent(){this.legendComponent&&(this.legendComponent.addEventListener(tc.dk.legendItemClick,t=>{let e=tu(t,"detail.currentSelected");this.table.fireListeners(ty.B.LEGEND_ITEM_CLICK,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(tc.dk.legendItemHover,t=>{let e=tu(t,"detail");this.table.fireListeners(ty.B.LEGEND_ITEM_HOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(tc.dk.legendItemUnHover,t=>{let e=tu(t,"detail");this.table.fireListeners(ty.B.LEGEND_ITEM_UNHOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener("legendItemAttributeUpdate",t=>{this.table.scenegraph.updateNextFrame()}))}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}var t_=i(58183),tx=i(71149),tC=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let tw={orient:"right",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"titleFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},endText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},handlerText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}}},tS={horizontal:Object.assign(Object.assign({},tw),{rail:{width:200,height:8,style:{fill:"rgba(0,0,0,0.04)"}}}),vertical:Object.assign(Object.assign({},tw),{rail:{width:8,height:200,style:{fill:"rgba(0,0,0,0.04)"}}})},tA={horizontal:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:200,height:4,style:{fill:"rgba(0,0,0,0.04)"}}},tw),vertical:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:4,height:200,style:{fill:"rgba(0,0,0,0.04)"}}},tw)};class tM{constructor(t,e){var i,r,n,s;this.table=e,this.option=(0,th.Z)(t),this.orient=null!=(i=t.orient)?i:"left",this.visible=null==(r=t.visible)||r,this.position=null!=(n=t.position)?n:"middle",this.selectedData=null!=(s=t.defaultSelected)?s:null,this.createComponent(),this.initEvent()}createComponent(){let t,e=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});(t="color"===this.option.type?new t_.e((0,a.Z)({},e,{slidable:!0})):new tx.D((0,a.Z)({},e,{slidable:!0}))).name="legend",this.legendComponent=t,!1===this.visible&&(t.setAttributes({visible:!1,visibleAll:!1}),t.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(t),this.adjustTableSize(e)}resize(){this.legendComponent&&!1!==this.visible&&(this.legendComponent.setAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(t){var e,i;if(!this.legendComponent||!1===this.visible)return;let r=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,n=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(r<=0||n<=0)return;let s=this.table.tableNoFrameWidth,l=this.table.tableNoFrameHeight,a=(0,tv.u)(null!=(i=null!=(e=t.padding)?e:this.option.padding)?i:10),o=0,h=0;"left"===this.orient?(o=a[3],h=0,r+=a[1]+a[3]):"top"===this.orient?(o=0,h=a[0],n+=a[0]+a[2]):"right"===this.orient?(o=s-r-a[1],h=0,r+=a[1]+a[3]):"bottom"===this.orient&&(o=0,h=l-n-a[2],n+=a[0]+a[2]);let u="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",d=this.position,c=0,p=0;"horizontal"===u?c="middle"===d?(s-r)/2:"end"===d?s-r-a[1]:a[3]:p="middle"===d?(l-n)/2:"end"===d?l-n-a[2]:a[0],this.legendComponent.setAttributes({dx:c,dy:p,x:o,y:h}),"left"===this.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r),this.table.tableX+=Math.ceil(r)):"top"===this.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n),this.table.tableY+=Math.ceil(n)):"right"===this.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r):"bottom"===this.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n))}getLegendAttributes(t){let e="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",i="horizontal"===e?"bottom":this.orient;return Object.assign(Object.assign({},function(t,e){let i=(0,a.Z)({},("color"===t.type?tS:tA)["bottom"===t.orient||"top"===t.orient?"horizontal":"vertical"],t),{title:r={},handler:n={},rail:s={},track:l={},startText:o,endText:h,handlerText:u,sizeBackground:d,background:c={},type:p,id:g,visible:f,orient:m,position:y,data:v,defaultSelected:b,field:_,filter:x,regionId:C,regionIndex:w,seriesIndex:S,seriesId:A,padding:M}=i,k=tC(i,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return r.visible&&(k.title=(0,tg.qi)(r)),k.showHandler=!1!==n.visible,(0,N.Z)(n.style)||(k.handlerStyle=(0,tg.h_)(n.style)),(0,F.Z)(s.width)&&(k.railWidth=s.width),(0,F.Z)(s.height)&&(k.railHeight=s.height),(0,N.Z)(s.style)||(k.railStyle=(0,tg.h_)(s.style)),(0,N.Z)(l.style)||(k.trackStyle=(0,tg.h_)(l.style)),k.startText=(0,tg.ro)(o),k.endText=(0,tg.ro)(h),k.handlerText=(0,tg.ro)(u),(0,N.Z)(d)||(k.sizeBackground=(0,tg.h_)(d)),c.visible&&!(0,N.Z)(c.style)&&((0,a.Z)(k,c.style),(0,F.Z)(c.padding)&&(k.padding=c.padding)),k}(this.option,0)),{layout:e,align:i,min:this.option.min,max:this.option.max,value:this.option.value,["color"===this.option.type?"colors":"sizeRange"]:"color"===this.option.type?this.option.colors:this.option.sizeRange})}initEvent(){this.legendComponent&&this.legendComponent.addEventListener("change",t=>{let e=tu(t,"detail.value");this.table.fireListeners(ty.B.LEGEND_CHANGE,{model:this,value:e,event:t}),this.table.scenegraph.updateNextFrame()})}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}function tk(t,e){return"color"===t.type||"size"===t.type?new tM(t,e):new tb(t,e)}class tT{constructor(t){this._table=t}release(){this.unbindMenuElement(),this._menuElement&&this._menuElement.release(),this._menuElement=void 0}_getMenuElement(){return this._menuElement||(this._menuElement=this.createMenuElementInternal()),this._menuElement}bindMenuElement(t,e,i){return this._getMenuElement().bindToCell(this._table,t,e,i)}unbindMenuElement(){this._getMenuElement().unbindFromCell()}pointInMenuElement(t,e){return this._getMenuElement().pointInMenuElement(t,e)}getRootElement(){return this._getMenuElement().rootElement}}var tR=i(78287),tB=i(18844);let tP="vtable__menu-element",tE=`${tP}--hidden`,tI=`${tP}--shown`;class tL{constructor(t){var e,i,r;this._handler=new tR.b,this._rootElement=(0,tB.a)("div",[tP,tE]),this._rootElement.addEventListener("wheel",t=>{t.stopPropagation()}),null==(e=this._rootElement)||e.addEventListener("mousedown",t=>{t.stopPropagation(),t.preventDefault()}),null==(i=this._rootElement)||i.addEventListener("click",e=>{if(e.stopPropagation(),e.preventDefault(),this._rootElement.classList.contains(tE))return;let{col:i,row:r,dropDownIndex:n,menuKey:s,text:l,hasChildren:a}=e.target;if("number"!=typeof n||a)return void e.stopPropagation();let o=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(i,r):t.getHeaderField(i,r),h=t._dropDownMenuIsHighlight(i,r,n);t.fireListeners(ty.B.DROPDOWN_MENU_CLICK,{col:i,row:r,field:o,menuKey:s,text:l,highlight:h,cellLocation:t.getCellLocation(i,r),event:e}),t.fireListeners(ty.B.DROPDOWN_MENU_CLEAR,null),t.fireListeners(ty.B.HIDE_MENU,null),e.stopPropagation()}),null==(r=this._rootElement)||r.addEventListener("mousemove",t=>{this._rootElement.classList.contains(tE)||t.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();let t=this._rootElement;(null==t?void 0:t.parentElement)&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,i,r){let n=this._rootElement;if(this._menuInstanceInfo=r,null==n||n.classList.remove(tI),null==n||n.classList.add(tE),this._canBindToCell(t,e,i)){if(n.innerHTML="",n.appendChild(r.content),this._bindCell(t,e,i,r.position,r.referencePosition))return null==n||n.classList.add(tI),null==n||n.classList.remove(tE),!0}else this.unbindFromCell();return!1}unbindFromCell(){let t=this._rootElement;this._menuInstanceInfo=void 0,(null==t?void 0:t.parentElement)&&(t.classList.remove(tI),t.classList.add(tE))}_canBindToCell(t,e,i){var r;let n=t.getCellRangeRelativeRect({col:e,row:i}),s=null!=(r=t.internalProps.menu.parentElement)?r:t.getElement(),{top:l,bottom:a,left:o,right:h}=n;if(t.isFrozenCell(e,i))return!0;if(a<t.getFrozenRowsHeight()||h<t.getFrozenColsWidth()||o>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||l>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;let{offsetHeight:u,offsetWidth:d}=s;return!(u<l)&&!(d<o)}_bindCell(t,e,i,r,n){var s;let l=this._rootElement,a=null!=(s=t.internalProps.menu.parentElement)?s:t.getElement(),{width:o,height:h,left:u,top:d}=a.getBoundingClientRect();if(l){let e,i;l.parentElement!==a&&a.appendChild(l),l.style.left="0px",l.style.maxWidth=`${.8*o}px`;let s=l.clientWidth,c=l.clientHeight;r&&(e=r.x,i=r.y),n&&(e=n.rect.right-s,i=n.rect.bottom),i+c>h&&(i=h-c,e+=s-2),i<0&&(i/=2);let p=0,g=0;if(t.getElement()!==a){let{left:e,top:i}=t.getElement().getBoundingClientRect();p=i-d,g=e-u}return l.style.top=`${i+p}px`,e<0?e=0:e+s>o&&(e=o-s),l.style.left=`${e+g}px`,!0}return!1}pointInMenuElement(t,e){let{x:i,y:r,width:n,height:s}=this._rootElement.getBoundingClientRect();return t>i-5&&t<i+n+5&&e>r-5&&e<r+s+5}}var tF=i(53943);class tO extends tT{createMenuElementInternal(){return new tF.F(this._table)}}class tD extends tT{createMenuElementInternal(){return new tL(this._table)}}var tH=i(57657);let tz={"dropdown-menu":function(t){return new tO(t)},"context-menu":function(t){return new tO(t)},container:t=>new tD(t)};class tW{constructor(t){this._table=t,this._menuInstances={},this._bindTableEvent(t)}release(){let t=this._menuInstances;for(let e in t)t[e].release();delete this._menuInstances,this._attachInfo=null}_bindToCell(t,e,i,r){var n;let s=this._attachInfo,l=this._getMenuInstanceInfo(t,e,i,r);if(!s||l&&s.instance===l.instance||(null==(n=s.instance)||n.unbindMenuElement(),this._attachInfo=null),!l)return;let{instance:a,info:o}=l;if(a&&a.bindMenuElement(t,e,o)){let i=-1===t&&-1===e?{start:{col:-1,row:-1},end:{col:-1,row:-1}}:this._table.getCellRange(t,e);this._attachInfo={range:i,instance:a}}}_unbindFromCell(){let t=this._attachInfo;if(!t)return;let{instance:e}=t;null==e||e.unbindMenuElement(),this._attachInfo=null}_isBindToCell(t,e){let i=this._attachInfo;return!!i&&(0,tH._Z)(i.range,t,e)}pointInMenuElement(t,e){if(!this._attachInfo)return!1;let{instance:i}=this._attachInfo;return i.pointInMenuElement(t,e)}_bindTableEvent(t){t.on(ty.B.DROPDOWN_ICON_CLICK,t=>{this._attachInfo&&this._isBindToCell(t.col,t.row)?this._unbindFromCell():this._bindToCell(t.col,t.row,"dropdown-menu")}),t.on(ty.B.DROPDOWN_MENU_CLEAR,t=>{this._unbindFromCell()}),t.on(ty.B.CONTEXTMENU_CELL,e=>{var i,r,n,s;if("html"===(null==(i=t.internalProps.menu)?void 0:i.renderMode)){let i=t._getMouseAbstractPoint(e.event),l=null;i.inTable&&"function"==typeof(null==(r=t.internalProps.menu)?void 0:r.contextMenuItems)?l=t.internalProps.menu.contextMenuItems(t.getHeaderField(e.col,e.row),e.row,e.col,t):i.inTable&&Array.isArray(null==(n=t.internalProps.menu)?void 0:n.contextMenuItems)&&(l=null==(s=t.internalProps.menu)?void 0:s.contextMenuItems),this._bindToCell(e.col,e.row,"context-menu",{content:l,position:{x:i.x,y:i.y}})}}),t.on(ty.B.CONTEXTMENU_CANVAS,e=>{var i,r,n,s;if("html"===(null==(i=t.internalProps.menu)?void 0:i.renderMode)){let i=t._getMouseAbstractPoint(e.event),l=null;i.inTable&&"function"==typeof(null==(r=t.internalProps.menu)?void 0:r.contextMenuItems)?l=t.internalProps.menu.contextMenuItems(t.getHeaderField(e.col,e.row),e.row,e.col,t):i.inTable&&Array.isArray(null==(n=t.internalProps.menu)?void 0:n.contextMenuItems)&&(l=null==(s=t.internalProps.menu)?void 0:s.contextMenuItems),this._bindToCell(-1,-1,"context-menu",{content:l,position:{x:i.x,y:i.y}})}})}_getMenuInstanceInfo(t,e,i,r){let n=this._table,s=this._menuInstances,l=function(t,e,i,r,n){var s,l,a;if(-1===e&&-1===i&&"context-menu"===r)return(null==n?void 0:n.content)?{type:r,position:n.position,referencePosition:null!=(s=n.referencePosition)?s:{rect:{left:0,right:0,top:0,bottom:0,width:0,height:0}},content:n.content}:null;let{lineHeight:o,textBaseline:h,textStick:u}=t._getCellStyle(e,i),d=t.getCellRangeRelativeRect(t.getCellRange(e,i));u&&(d=t.getVisibleCellRangeRelativeRect({col:e,row:i}));let{left:c,right:p,bottom:g,top:f,width:m,height:y}=d;if(t.isHeader(e,i)&&({left:c,right:p,bottom:g,top:f,width:m,height:y}=t.internalProps.headerHelper.getDropDownIconRect(d,o,h||"middle")),null==n?void 0:n.content)return{type:r,position:n.position,referencePosition:null!=(l=n.referencePosition)?l:{rect:{left:c,right:p,top:f,bottom:g,width:m,height:y}},content:n.content};if("dropdown-menu"===r){let n=t.globalDropDownMenu,s=t._getHeaderLayoutMap(e,i);n=null!=(a=s.dropDownMenu)?a:n;let l=s.pivotInfo;return"function"==typeof n&&(n=n({row:i,col:e,table:t})),{type:r,referencePosition:{rect:{left:c,right:p,top:f,bottom:g,width:m,height:y}},content:n,pivotInfo:l}}return null}(n,t,e,i,r);return l?{instance:s&&s[i]||s&&(s[i]=tz[i](n)),type:i,info:l}:null}containElement(t){var e;for(let i in this._menuInstances)if(null==(e=this._menuInstances[i].getRootElement())?void 0:e.contains(t))return!0;return!1}}var tN=i(70830);class tj{constructor(t,e){this.isReleased=!1,this.table=e,this._titleOption=(0,a.Z)({orient:"top"},t),!1!==t.visible&&(this._titleComponent=this._createOrUpdateTitleComponent(this._getTitleAttrs()))}_createOrUpdateTitleComponent(t){if(this._titleComponent)(0,tl.X)(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{let e=new tN.D(t);e.name="title",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._titleComponent=e}return this._adjustTableSize(this._titleComponent.attribute),this._titleComponent}resize(){var t,e,i,r,n;if(!this._titleComponent)return;let s=(0,tv.u)(null!=(t=this._titleOption.padding)?t:10),l=null!=(e=this._titleOption.width)?e:("adaptive"===this.table.widthMode?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width))-s[1]-s[3],a=null!=(i=this._titleOption.height)?i:("adaptive"===this.table.heightMode?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height))-s[0]-s[2];this._titleComponent.setAttributes({x:(null!=(r=this._titleOption.x)?r:"right"===this._titleOption.orient)?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:(null!=(n=this._titleOption.y)?n:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:"top"===this._titleOption.orient||"bottom"===this._titleOption.orient?l:this._titleOption.width,height:"left"===this._titleOption.orient||"right"===this._titleOption.orient?a:this._titleOption.height,textStyle:Object.assign({width:l},this._titleOption.textStyle),subtextStyle:Object.assign({width:l},this._titleOption.subtextStyle)}),this._adjustTableSize(this._titleComponent.attribute)}_adjustTableSize(t){var e,i,r,n;let s=isFinite(null==(e=this._titleComponent)?void 0:e.AABBBounds.width())?this._titleComponent.AABBBounds.width():0,l=isFinite(null==(i=this._titleComponent)?void 0:i.AABBBounds.height())?this._titleComponent.AABBBounds.height():0;"left"===this._titleOption.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(s),this.table.tableX+=Math.ceil(s)):"top"===this._titleOption.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(l),this.table.tableY+=Math.ceil(l)):"right"===this._titleOption.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(s):"bottom"===this._titleOption.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(l)),this._cacheAttrs=t,"right"!==this._titleOption.orient&&"bottom"!==this._titleOption.orient||this._titleComponent.setAttributes({x:(null!=(r=this._titleOption.x)?r:"right"===this._titleOption.orient)?this.table.tableX+this.table.tableNoFrameWidth:this.table.tableX,y:(null!=(n=this._titleOption.y)?n:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY})}release(){this._titleComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._titleComponent),this._titleComponent=null,this.isReleased=!0}_getTitleAttrs(){var t,e,i,r,n,s,l,a,o,h,u;let d=this._titleOption.text||this._titleOption.subtext?10:0,c=(0,tv.u)(null!=(t=this._titleOption.padding)?t:d),p=null!=(e=this._titleOption.width)?e:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width)-c[1]-c[3],g=null!=(i=this._titleOption.height)?i:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height)-c[0]-c[2];return{text:null!=(r=this._titleOption.text)?r:"",subtext:null!=(n=this._titleOption.subtext)?n:"",x:(null!=(s=this._titleOption.x)?s:"right"===this._titleOption.orient)?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:(null!=(l=this._titleOption.y)?l:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:"top"===this._titleOption.orient||"bottom"===this._titleOption.orient?p:this._titleOption.width,height:"left"===this._titleOption.orient||"right"===this._titleOption.orient?g:this._titleOption.height,minWidth:this._titleOption.minWidth,maxWidth:this._titleOption.maxWidth,minHeight:this._titleOption.minHeight,maxHeight:this._titleOption.maxHeight,padding:this._titleOption.padding,align:null!=(a=this._titleOption.align)?a:"left",verticalAlign:null!=(o=this._titleOption.verticalAlign)?o:"top",textStyle:Object.assign({width:p},this._titleOption.textStyle),subtextStyle:Object.assign({width:p},this._titleOption.subtextStyle),dx:null!=(h=this._titleOption.dx)?h:0,dy:null!=(u=this._titleOption.dy)?u:0}}getComponentGraphic(){return this._titleComponent}}class tG{constructor(t){this._table=t}release(){var t,e;this.unbindTooltipElement(),this._tooltipElement&&(null==(e=(t=this._tooltipElement).release)||e.call(t)),this._tooltipElement=void 0}_getTooltipElement(){return this._tooltipElement||(this._tooltipElement=this.createTooltipElementInternal()),this._tooltipElement}bindTooltipElement(t,e,i,r){return this._getTooltipElement().bindToCell(this._table,t,e,i,r)}moveTooltipElement(t,e,i,r){this._getTooltipElement().move(this._table,t,e,i,r)}unbindTooltipElement(){this._getTooltipElement().unbindFromCell()}locateTooltipElement(t,e,i,r,n){this._getTooltipElement()._locate(this._table,t,e,i,r,n)}}var tV=i(73664),tZ=i(84375),tU=i(12588);!function(){if("node"===tZ.X.mode)return;let t=document.createElement("style");t.id="vtable-tooltip-styleSheet",t.textContent="\n@keyframes vtable__bubble-tooltip-element--shown-animation {\n	0% {\n		opacity: 0;\n	}\n	100% {\n		opacity: 1;\n	}\n}\n.vtable__bubble-tooltip-element {\n	position: absolute;\n	\n	// pointer-events: none;\n	//user-select: none;\n	max-width: 300px;\n	z-index: 99999;\n\n	background: #FFFFFF;\n    border: 1px solid #E6E8ED;\n    box-sizing: border-box;\n    border-radius: 4px;\n    box-shadow: 0px 2px 4px rgb(27 31 35 / 8%);\n    color: #141414;\n    font-size: 13px;\n}\n.vtable__bubble-tooltip-element--hidden {\n	opacity: 0;\n  pointer-events: none;\n	user-select: none;\n	/* transform: translate(-50%, -50%); */\n	transition: opacity 75ms linear;\n}\n.vtable__bubble-tooltip-element--shown {\n	opacity: 1;\n	/* transform: translate(-50%, -50%); */\n	animation: vtable__bubble-tooltip-element--shown-animation 150ms ease-out;\n}\n.vtable__bubble-tooltip-element__content {\n	/* font-size: .75rem; */\n	padding: 6px 8px;\n	min-height: 1em;\n	line-height: 1.5;\n	width: 100%;\n	display: block;\n	white-space: pre-wrap;\n	margin: 0;\n	box-sizing: border-box;\n	overflow: auto;\n	word-wrap: break-word;\n	position: relative;\n	background-color: #FFF;\n	z-index: 2;\n	border-radius: 4px;\n}\n/*  WebKit Microsoft Edge（新版）： */\n.vtable__bubble-tooltip-element__content::-webkit-scrollbar {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n/*  Opera Firefox  */\n.vtable__bubble-tooltip-element__content > scrollbar-track {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n/* Internet Explorer 11 和 Microsoft Edge（旧版） */\n.vtable__bubble-tooltip-element__content > scrollbar {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n.vtable__bubble-tooltip-element__triangle {\n	/* font-size: .75rem; */\n	position: absolute;\n	width: 10px;\n	height: 10px;\n	display: block;\n	transform: rotate(45deg);\n    transform-origin: 50% 50% 0;\n	z-index: 1;\n	background-color: #FFF;\n	border: 1px solid #E6E8ED;\n}\n",document.head.appendChild(t)}();let tK="vtable__bubble-tooltip-element",t$=`${tK}__content`,tY=`${tK}__triangle`,tX=`${tK}--hidden`,tq=`${tK}--shown`;class tJ{constructor(){this._handler=new tR.b;let t=this._rootElement=(0,tB.a)("div",[tK,tX]),e=(0,tB.a)("div",[t$]),i=(0,tB.a)("span",[tY]);t.appendChild(i),t.appendChild(e),this._messageElement=t.querySelector(`.${t$}`)||void 0,this._triangleElement=t.querySelector(`.${tY}`)||void 0,t.addEventListener("mousemove",()=>{this._disappearDelayId&&clearTimeout(this._disappearDelayId)}),t.addEventListener("mouseleave",()=>{this._disappearDelay=void 0,this.unbindFromCell()}),e.addEventListener("wheel",t=>{t.stopPropagation()}),e.addEventListener("copy",t=>{(0,tU.Ed)(e)&&t.stopPropagation()})}bindToCell(t,e,i,r,n){var s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w;this._disappearDelay=null==r?void 0:r.disappearDelay,this._disappearDelayId&&clearTimeout(this._disappearDelayId);let S=this._rootElement,A=this._messageElement,M=this._triangleElement;if(null==S||S.classList.remove(tq),null==S||S.classList.add(tX),this._canBindToCell(t,e,i)){if(A.setAttribute("style",""),M.setAttribute("style",""),(null==r?void 0:r.className)&&S.classList.add(r.className),(null==(s=null==r?void 0:r.style)?void 0:s.bgColor)&&(A.style.backgroundColor=null==(l=null==r?void 0:r.style)?void 0:l.bgColor),(null==(a=null==r?void 0:r.style)?void 0:a.bgColor)&&(M.style.backgroundColor=null==(o=null==r?void 0:r.style)?void 0:o.bgColor),M.style.display=!0===(null==(h=null==r?void 0:r.style)?void 0:h.arrowMark)?"block":"none",(null==(u=null==r?void 0:r.style)?void 0:u.fontSize)&&(A.style.fontSize=(null!=(c=null==(d=null==r?void 0:r.style)?void 0:d.fontSize)?c:12)+"px"),(null==(p=null==r?void 0:r.style)?void 0:p.fontFamily)&&(A.style.fontFamily=null==(g=null==r?void 0:r.style)?void 0:g.fontFamily),(null==(f=null==r?void 0:r.style)?void 0:f.color)&&(A.style.color=null==(m=null==r?void 0:r.style)?void 0:m.color),(null==(y=null==r?void 0:r.style)?void 0:y.padding)&&(A.style.padding=`${null==(v=null==r?void 0:r.style)?void 0:v.padding.join("px ")}px`),(null==(b=null==r?void 0:r.style)?void 0:b.maxHeight)&&(A.style.maxHeight=`${null==(_=null==r?void 0:r.style)?void 0:_.maxHeight}px`),(null==(x=null==r?void 0:r.style)?void 0:x.maxWidth)&&(A.style.maxWidth=`${null==(C=null==r?void 0:r.style)?void 0:C.maxWidth}px`),A&&(A.textContent=null==r?void 0:r.content),this._bindToCell(t,e,i,null==r?void 0:r.position,null==r?void 0:r.referencePosition,n,null==(w=null==r?void 0:r.style)?void 0:w.arrowMark))return null==S||S.classList.add(tq),null==S||S.classList.remove(tX),!0}else this.unbindFromCell();return!1}release(){var t,e;this.unbindFromCell();let i=this._rootElement;(null==i?void 0:i.parentElement)&&i.parentElement.removeChild(i),null==(e=null==(t=this._handler)?void 0:t.release)||e.call(t),delete this._rootElement,delete this._messageElement}move(t,e,i,r,n){let s=this._rootElement;this._canBindToCell(t,e,i)?(this._bindToCell(t,e,i,null==r?void 0:r.position,null==r?void 0:r.referencePosition,n),null==s||s.classList.add(tq),null==s||s.classList.remove(tX)):this.unbindFromCell()}unbindFromCell(){var t;if(this._disappearDelay)this._disappearDelayId=setTimeout(()=>{let t=this._rootElement;(null==t?void 0:t.parentElement)&&(t.classList.remove(tq),t.classList.add(tX))},null!=(t=this._disappearDelay)?t:0);else{let t=this._rootElement;(null==t?void 0:t.parentElement)&&(t.classList.remove(tq),t.classList.add(tX))}}_canBindToCell(t,e,i){let r=t.getCellRangeRelativeRect({col:e,row:i}),n=t.getElement(),{bottom:s,left:l,right:a,top:o}=r;if(t.isFrozenCell(e,i))return!0;if(s<t.getFrozenRowsHeight()||a<t.getFrozenColsWidth()||l>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||o>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;let{offsetHeight:h,offsetWidth:u}=n;return!(o>h)&&!(l>u)}_bindToCell(t,e,i,r,n,s,l){let a=this._rootElement,o=t.getCellRangeRelativeRect({col:e,row:i}),h=t.internalProps.tooltip.parentElement,u=t.internalProps.element.offsetWidth,{width:d}=o;if(a){let o,c;a.parentElement!==h&&h.appendChild(a),a.style.left="0px";let p=Math.min(.8*u,4*d);a.style.maxWidth=`${p}px`;let g=a.clientWidth,f=a.clientHeight;if(!r&&!n)return!1;{let a=this.getComputedPosition(t,e,i,r,n,s,l);c=a.x,o=a.y}a.style.left=`${c}px`,a.style.top=`${o}px`,(0,tU.tq)()&&(a.style.fontSize="11px");let{x1:m,x2:y,y1:v,y2:b}=t.stateManager.menu.bounds,_=c,x=o;return!(t.stateManager.menu.isShow&&m<_+g&&y>_&&b>x&&v<_+f)}return!1}getComputedPosition(t,e,i,r,n,s,l){var a;let o,h,u=this._rootElement,d=t.getCellRangeRelativeRect({col:e,row:i}),{x:c,y:p}=t.internalProps.tooltip.parentElement.getBoundingClientRect(),{width:g,height:f,x:m,y:y}=t.internalProps.element.getBoundingClientRect(),{width:v}=d,b=Math.min(.8*g,4*v);u.style.maxWidth=`${b}px`;let _=u.clientWidth,x=u.clientHeight,C=6*!!l;if(r)h=r.x,o=r.y+C,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px";else if(n){let t=null!=(a=n.placement)?a:tV.u.bottom,e=n.rect.left+n.rect.width/2,i=n.rect.top+n.rect.height/2,r=n.rect.top,l=n.rect.bottom,u=n.rect.left,d=n.rect.right,c=0,p=()=>{++c>=4||(this.removeStyleFromTriangle(),t===tV.u.top?(h=e-_/2,o=r-x-C,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.bottom="-5px",s&&o<0&&(t=tV.u.right,p())):t===tV.u.bottom?(h=e-_/2,o=l+C,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px",s&&o+x>f&&(t=tV.u.left,p())):t===tV.u.left?(o=i-x/2,h=u-_-C,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.right="-5px",s&&h<0&&(t=tV.u.top,p())):t===tV.u.right&&(o=i-x/2,h=d+C,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.left="-5px",s&&h+_>g&&(t=tV.u.bottom,p())))};p()}return s&&(h<0?h=0:h+u.offsetWidth>g&&(h=g-u.offsetWidth)),{x:h+m-c,y:o+y-p}}removeStyleFromTriangle(){this._triangleElement.style.left="",this._triangleElement.style.right="",this._triangleElement.style.top="",this._triangleElement.style.bottom="",this._triangleElement.style.marginLeft="",this._triangleElement.style.marginTop=""}_locate(t,e,i,r,n,s){let l=this.getComputedPosition(t,e,i,r,n,s),a=l.x,o=l.y;this._rootElement.style.left=`${a}px`,this._rootElement.style.top=`${o}px`}}class tQ extends tG{createTooltipElementInternal(){return new tJ}}let t0={"bubble-tooltip":function(t){return new tQ(t)}};class t1{constructor(t,e){this._table=t,this._tooltipInstances={},this._bindTableEvent(t),this.confine=e}release(){var t,e;let i=this._tooltipInstances;for(let r in i)null==(e=null==(t=i[r])?void 0:t.release)||e.call(t);delete this._tooltipInstances,this._attachInfo=null}_bindToCell(t,e,i){var r;let n=this._attachInfo,s=this._getTooltipInstanceInfo(t,e);if(!n||s&&n.instance===s||(null==(r=n.instance)||r.unbindTooltipElement(),this._attachInfo=null),s&&s&&s.bindTooltipElement(t,e,i,this.confine)){let r=this._table.getCellRange(t,e);this._attachInfo={range:r,instance:s,tooltipOptions:i}}}_move(t,e,i){let r=this._attachInfo;if(!r||!(0,tH._Z)(r.range,t,e))return;let{instance:n}=r;null==n||n.moveTooltipElement(t,e,i,this.confine)}moveToPosition(t,e,i,r){let n=this._attachInfo;if(!n||!(0,tH._Z)(n.range,t,e))return;let{instance:s}=n;this._attachInfo.tooltipOptions.position=i,this._attachInfo.tooltipOptions.referencePosition=r,null==s||s.locateTooltipElement(t,e,i,r,this.confine)}_unbindFromCell(){let t=this._attachInfo;if(!t)return;let{instance:e}=t;null==e||e.unbindTooltipElement(),this._attachInfo=null}_isBindCell(t,e){let i=this._attachInfo;return!!i&&(0,tH._Z)(i.range,t,e)}_bindTableEvent(t){t.on(ty.B.MOUSEENTER_CELL,e=>{if((0,tU.tq)())return;let{x1:i,x2:r,y1:n,y2:s}=t.stateManager.menu.bounds;if(t.stateManager.menu.isShow&&"number"==typeof e.x&&"number"==typeof e.y&&e.x>i&&e.x<r&&e.y>n&&e.y<s)return;let{col:l,row:a}=e;this.showTooltip(l,a)}),t.on(ty.B.MOUSEMOVE_CELL,e=>{var i,r;if(!(0,tU.tq)()){if(null==(r=null==(i=this._attachInfo)?void 0:i.tooltipOptions)?void 0:r.referencePosition){let i=this._attachInfo.tooltipOptions.referencePosition,{event:r}=e,{left:n,right:s,top:l,bottom:a}=i.rect,o=t._getMouseAbstractPoint(r);o.inTable&&o.x>=n-5&&o.x<=s+5&&o.y>=l-5&&o.y<=a+5||this._unbindFromCell()}this._attachInfo&&t.stateManager.menu.isShow&&this._bindToCell(e.col,e.row)}}),t.on(ty.B.MOUSELEAVE_CELL,t=>{this._unbindFromCell()}),t.on(ty.B.SELECTED_CELL,t=>{this._isBindCell(t.col,t.row)&&this._unbindFromCell()}),t.on(ty.B.MOUSELEAVE_TABLE,t=>{this._unbindFromCell()}),t.on(ty.B.SCROLL,t=>{this._unbindFromCell()})}showTooltip(t,e){var i,r,n;let s,l=this._table,a=l.getHeaderDescription(t,e);if(a){let r=l.getCellRangeRelativeRect({col:t,row:e});s={content:a,referencePosition:{placement:l.internalProps.tooltip.position,rect:r},disappearDelay:null!=(i=l.internalProps.tooltip.overflowTextTooltipDisappearDelay)?i:0,style:l.theme.tooltipStyle}}else if((0,Z.Z)(null==(r=l.internalProps.tooltip)?void 0:r.isShowOverflowTextTooltip)?l.internalProps.tooltip.isShowOverflowTextTooltip(t,e,l):l.internalProps.tooltip.isShowOverflowTextTooltip){let i=l.getCellOverflowText(t,e),r=l.getCellRangeRelativeRect({col:t,row:e});i&&(s={content:a?`${a}
  ${i}`:i,referencePosition:{placement:l.internalProps.tooltip.position,rect:r},disappearDelay:null!=(n=l.internalProps.tooltip.overflowTextTooltipDisappearDelay)?n:0,style:l.theme.tooltipStyle})}s?this._bindToCell(t,e,s):this._unbindFromCell()}_getTooltipInstanceInfo(t,e){let i=this._table,r=this._tooltipInstances;return r&&r["bubble-tooltip"]||r&&(r["bubble-tooltip"]=t0["bubble-tooltip"](i))}isBinded(t){var e;return JSON.stringify(t)===JSON.stringify(null==(e=this._attachInfo)?void 0:e.tooltipOptions)}}var t2=i(93431),t3=i(21964);let t5=()=>{s.F.registerComponent("axis",V),s.F.registerFunction("computeAxisComponentWidth",K),s.F.registerFunction("computeAxisComponentHeight",$),s.F.registerFunction("getAxisConfigInPivotChart",l.hZ)},t4=()=>{s.F.registerComponent("emptyTip",to)},t6=()=>{s.F.registerFunction("createLegend",tk)},t8=()=>{s.F.registerComponent("menuHandler",tW)},t9=()=>{s.F.registerComponent("title",tj)},t7=()=>{s.F.registerComponent("tooltipHandler",t1)},et=()=>{(0,t2.Hp)(),(0,t3.d)()}},53943:function(t,e,i){"use strict";i.d(e,{o:()=>A,F:()=>M});var r=i(78287),n=i(18844),s=i(84375),l=i(99506),a=i(57657),o=i(18585),h=i(13455);!function(){if("node"===s.X.mode)return;let t=document.createElement("style");t.id="vtable-menu-styleSheet",t.textContent="\n@keyframes vtable__menu-element--shown-animation {\n	0% {\n		opacity: 0;\n	}\n	100% {\n		opacity: 1;\n	}\n}\n.vtable__menu-element {\n	position: absolute;\n	box-sizing: border-box;\n	border-radius: 4px;\n	background-color: #fff;\n	padding: 6px 0;\n	/* pointer-events: none; */\n	user-select: none;\n	color: #000;\n	max-width: 300px;\n	z-index: 99999;\n	border: #CCC 0.5px solid;\n	cursor: default;\n	width: max-content;\n	box-shadow: 0px 8px 16px rgba(27, 31, 35, 0.12);\n  max-height: 100%;\n  overflow-y: auto;\n}\n.vtable__menu-element--hidden {\n	opacity: 0;\n	/* transform: translate(-50%, -50%); */\n	transition: opacity 75ms linear;\n	z-index: -9999;\n}\n.vtable__menu-element--shown {\n	opacity: 1;\n	/* transform: translate(-50%, -50%); */\n	animation: vtable__menu-element--shown-animation 150ms ease-out;\n}\n.vtable__menu-element__content {\n	font-family: Roboto;\n	font-size: 12px;\n	overflow: hidden;\n	display: inline-block;\n	/* height: 100%; */\n	line-height: 30px;\n}\n.vtable__menu-element__item {\n	height: 32px;\n	padding: 0px 12px;\n	cursor: pointer;\n	position: relative;\n	display: flex;\n	align-items: center;\n	justify-content: flex-start;\n}\n.vtable__menu-element__item:hover {\n	background-color: rgba(27, 31, 35, 0.06);\n}\n.vtable__menu-element__icon{\n	/* vertical-align: top; */\n	display: flex;\n	/* line-height: 30px; */\n	margin-right: 6px;\n}\n.vtable__menu-element__no-event {\n	pointer-events: none;\n}\n.vtable__menu-element--select {\n	color: #2E68CF;\n}\n.vtable__menu-element--normal {\n	color: rgba(20, 20, 20, 0.9);;\n}\n.vtable__menu-element__item-disabled {\n    color: rgba(0, 0, 0, 0.25);\n    cursor: not-allowed;\n	  background-color: #fff;\n}\n.vtable__menu-element__item-disabled:hover {\n	  background-color: #fff;\n}\n.vtable__menu-element__split {\n	height: 0px;\n	border: 1px solid rgb(209, 213, 218);\n	margin: 5px 0;\n}\n.vtable__menu-element__title {\n	color: rgb(149, 149, 149);\n}\n.vtable__menu-element__arrow {\n	position: absolute;\n	right: 3px;\n	font-weight: bold;\n	margin-top: 1px;\n}\n.vtable__menu-element__item-text {\n	margin-right: 15px;\n}\n",document.head.appendChild(t)}();let u="vtable__menu-element",d=`${u}__item`,c=`${u}__content`,p=`${u}--hidden`,g=`${u}--shown`,f=`${u}--normal`,m=`${u}--select`,y=`${u}__icon`,v=`${u}__split`,b=`${u}__title`,_=`${u}__arrow`,x=`${u}__no-event`,C=`${u}__item-text`,w=`${u}__item-disabled`;function S(){return(0,n.a)("div",[u,p])}function A(t,e,i,r,n,s){let l=t.getCellRange(r,n);for(let r=0;r<e.length;r++){let n=e[r],{col:s,row:h}=n,{field:u,menuKey:d}=n;if("number"!=typeof s||"number"!=typeof h)if(t.isPivotTable()&&(Array.isArray(u),1)){let e=t.internalProps.layoutMap.getPivotCellAdress(u);if(!e)continue;s=e.col,h=e.row}else{let e=t.internalProps.layoutMap.getHeaderCellAddressByField(u);if(!e)continue;s=e.col,h=e.row}if((0,o.Z)(s)&&(0,o.Z)(h)&&(0,a._Z)(l,s,h)&&i===d)return!0}return!1}class M{constructor(t){var e,i,n,s,a,o,h,u,d,c,f;this._handler=new r.b,this._rootElement=S(),this._secondElement=S(),this._secondElement.sub=!0,this._showChildrenIndex=-1,this._rootElement.addEventListener("wheel",t=>{t.stopPropagation()}),null==(e=this._rootElement)||e.addEventListener("mousedown",t=>{t.stopPropagation(),t.preventDefault()}),null==(i=this._rootElement)||i.addEventListener("contextmenu",t=>{t.stopPropagation(),t.preventDefault()}),null==(n=this._rootElement)||n.addEventListener("touchend",e=>{if(e.stopPropagation(),e.preventDefault(),e.target.classList.contains(w)||this._rootElement.classList.contains(p))return;let{col:i,row:r,dropDownIndex:n,menuKey:s,text:a,hasChildren:o}=e.target;if("number"!=typeof n||o)return void e.stopPropagation();let h=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(i,r):t.getHeaderField(i,r),u=t._dropDownMenuIsHighlight(i,r,n);t.fireListeners(l.B.DROPDOWN_MENU_CLICK,{col:i,row:r,field:h,menuKey:s,text:a,highlight:u,cellLocation:t.getCellLocation(i,r),event:e}),t.fireListeners(l.B.DROPDOWN_MENU_CLEAR,null),t.fireListeners(l.B.HIDE_MENU,null),e.stopPropagation()}),null==(s=this._rootElement)||s.addEventListener("click",e=>{if(e.stopPropagation(),e.preventDefault(),e.target.classList.contains(w)||this._rootElement.classList.contains(p))return;let{col:i,row:r,dropDownIndex:n,menuKey:s,text:a,hasChildren:o}=e.target;if("number"!=typeof n||o)return void e.stopPropagation();let h=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(i,r):t.getHeaderField(i,r),u=t._dropDownMenuIsHighlight(i,r,n);t.fireListeners(l.B.DROPDOWN_MENU_CLICK,{col:i,row:r,field:h,menuKey:s,text:a,highlight:u,cellLocation:t.getCellLocation(i,r),event:e}),t.fireListeners(l.B.DROPDOWN_MENU_CLEAR,null),t.fireListeners(l.B.HIDE_MENU,null),e.stopPropagation()}),null==(a=this._rootElement)||a.addEventListener("mousemove",e=>{var i,r;if(this._rootElement.classList.contains(p))return;e.stopPropagation();let{hasChildren:n,dropDownIndex:s,col:l,row:a,sub:o}=e.target;if(n){this._showChildrenIndex=s;let r=this._secondElement;null==r||r.classList.remove(p),null==r||r.classList.add(g),r.innerHTML="";let n=null==(i=this._menuInstanceInfo.content[s])?void 0:i.children;for(let e=0;e<n.length;e++){let i=n[e],s=k(i,!!t.stateManager.menu.dropDownMenuHighlight&&A(t,t.stateManager.menu.dropDownMenuHighlight,"object"==typeof i?(null==i?void 0:i.menuKey)||(null==i?void 0:i.text):i,l,a,e));s.col=l,s.row=a,s.dropDownIndex=e,"string"==typeof i?(s.text=i,s.menuKey=i):"object"==typeof i&&(s.text=i.text,s.menuKey=i.menuKey||i.text),s.sub=!0,s.sub=!0,r.appendChild(s)}let o=e.target.getBoundingClientRect();this._bindSecondElement(t,l,a,o.right,o.top)}else if(n&&this._showChildrenIndex===s){let t=this._secondElement;null==t||t.classList.remove(p),null==t||t.classList.add(g)}else!o&&(null==(r=this._secondElement)?void 0:r.classList.contains(g))&&setTimeout(()=>{if(!0!==this._mouseEnterSecondElement){this._showChildrenIndex=-1;let t=this._secondElement;null==t||t.classList.remove(g),null==t||t.classList.add(p)}},300)}),null==(o=this._secondElement)||o.addEventListener("wheel",t=>{t.stopPropagation()}),null==(h=this._secondElement)||h.addEventListener("mousemove",t=>{this._rootElement.classList.contains(p)||t.stopPropagation()}),null==(u=this._secondElement)||u.addEventListener("mouseenter",t=>{this._mouseEnterSecondElement=!0}),null==(d=this._secondElement)||d.addEventListener("mouseleave",t=>{this._mouseEnterSecondElement=!1}),null==(c=this._secondElement)||c.addEventListener("mousedown",t=>{t.stopPropagation(),t.preventDefault()}),null==(f=this._secondElement)||f.addEventListener("click",e=>{if(e.stopPropagation(),e.preventDefault(),e.target.classList.contains(w)||this._secondElement.classList.contains(p))return;let{col:i,row:r,dropDownIndex:n,menuKey:s,text:a,hasChildren:o}=e.target;if("number"!=typeof n||o)return void e.stopPropagation();let h=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(i,r):t.getHeaderField(i,r),u=!1;this._menuInstanceInfo.content.forEach((e,n)=>{if("object"==typeof e&&e.children&&e.children.length)for(let n=0;n<e.children.length;n++){let l=e.children[n];if(A(t,t.stateManager.menu.dropDownMenuHighlight,"object"==typeof l?null==l?void 0:l.menuKey:l,i,r,-1)&&s===("object"==typeof l?null==l?void 0:l.menuKey:l))return void(u=!0)}}),t.fireListeners(l.B.DROPDOWN_MENU_CLICK,{col:i,row:r,field:h,cellHeaderPaths:t.isPivotTable()?t.getCellHeaderPaths(i,r):void 0,menuKey:s,text:a,highlight:u,cellLocation:t.getCellLocation(i,r),event:e}),t.fireListeners(l.B.DROPDOWN_MENU_CLEAR,null),t.fireListeners(l.B.HIDE_MENU,null),e.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();let t=this._rootElement;(null==t?void 0:t.parentElement)&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,i,r){var n,s;let l=this._rootElement,a=this._secondElement;if(this._menuInstanceInfo=r,null==l||l.classList.remove(g),null==l||l.classList.add(p),null==a||a.classList.remove(g),null==a||a.classList.add(p),this._canBindToCell(t,e,i)){if(l.innerHTML="",Array.isArray(r.content)){let a=r.content;for(let r=0;n=r<(null==a?void 0:a.length),n;r++){let n=a[r],o=!!t.stateManager.menu.dropDownMenuHighlight&&A(t,t.stateManager.menu.dropDownMenuHighlight,"object"==typeof n?(null==n?void 0:n.menuKey)||(null==n?void 0:n.text):n,e,i,r);if(t.stateManager.menu.dropDownMenuHighlight&&"object"==typeof n&&Array.isArray(n.children)&&n.children.length)for(let r=0;r<n.children.length;r++){let s=n.children[r];if(A(t,t.stateManager.menu.dropDownMenuHighlight,"object"==typeof s?(null==s?void 0:s.menuKey)||(null==s?void 0:s.text):s,e,i,r)){o=!0;break}}let h=k(n,o);h.col=e,h.row=i,h.dropDownIndex=r,"string"==typeof n?(h.text=n,h.menuKey=n):"object"==typeof n&&(h.text=n.text,h.menuKey=n.menuKey||n.text,(null==(s=n.children)?void 0:s.length)&&(h.hasChildren=!0)),l.appendChild(h)}}if(this._bindToCell(t,e,i,r.position,r.referencePosition))return null==l||l.classList.add(g),null==l||l.classList.remove(p),!0}else this.unbindFromCell();return!1}unbindFromCell(){let t=this._rootElement,e=this._secondElement;this._menuInstanceInfo=void 0,(null==t?void 0:t.parentElement)&&(t.classList.remove(g),t.classList.add(p)),(null==e?void 0:e.parentElement)&&(e.classList.remove(g),e.classList.add(p))}_canBindToCell(t,e,i){var r;let n=t.getCellRangeRelativeRect({col:e,row:i}),s=null!=(r=t.internalProps.menu.parentElement)?r:t.getElement(),{top:l,bottom:a,left:o,right:h}=n;if(-1===e&&-1===i||t.isFrozenCell(e,i))return!0;if(a<t.getFrozenRowsHeight()||h<t.getFrozenColsWidth()||o>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||l>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;let{offsetHeight:u,offsetWidth:d}=s;return!(u<l)&&!(d<o)}_bindToCell(t,e,i,r,n){var s;let l=this._rootElement,a=null!=(s=t.internalProps.menu.parentElement)?s:t.getElement(),{width:o,height:h,left:u,top:d}=a.getBoundingClientRect();if(l){let e,i;l.parentElement!==a&&a.appendChild(l),l.style.left="0px",l.style.maxWidth=`${.8*o}px`;let s=l.offsetWidth,c=l.offsetHeight;r?(e=r.x,i=r.y):n&&(e=n.rect.right-s,i=n.rect.bottom);let p=a.getBoundingClientRect(),g=p.width/a.offsetWidth,f=p.height/a.offsetHeight;i*f+c>h&&(i=(h-c)/f),i<0&&(i/=2);let m=0,y=0;if(t.getElement()!==a){let{left:e,top:i}=t.getElement().getBoundingClientRect();m=i-d,y=e-u}return l.style.top=`${i+m}px`,e<0?e=0:e*g+s>o&&(e=(o-s)/g),l.style.left=`${e+y}px`,!0}return!1}_bindSecondElement(t,e,i,r,n){var s;let l=this._secondElement,a=this._rootElement,o=null!=(s=t.internalProps.menu.parentElement)?s:t.getElement(),{width:h,height:u,left:d,top:c}=o.getBoundingClientRect(),{x:p,y:g,width:f,height:m}=a.getBoundingClientRect();if(l){l.parentElement!==o&&o.appendChild(l),l.style.left="0px",l.style.maxWidth=`${.8*h}px`;let t=l.clientWidth,e=l.clientHeight,i=n-4-c;i+e>u&&(i=i-e+l.firstElementChild.clientHeight+4),l.style.top=`${i}px`;let s=r-d;return s+t>h?s=s-t-f:s+=4,l.style.left=`${s}px`,!0}return!1}pointInMenuElement(t,e){let{x:i,y:r,width:n,height:s}=this._rootElement.getBoundingClientRect();if(t>i-5&&t<i+n+5&&e>r-5&&e<r+s+5)return!0;let l=this._secondElement;if(l){let{x:i,y:r,width:n,height:s}=l.getBoundingClientRect();if(t>i-5&&t<i+n+5&&e>r-5&&e<r+s+5)return!0}return!1}}function k(t,e){var i,r,s;let l=(0,n.a)("div",[d,e?m:f]);if("object"==typeof t&&t.disabled&&l.classList.add(w),"string"==typeof t){let e=(0,n.a)("span",[c,x,C]);e.innerHTML=t,l.appendChild(e)}else if("object"==typeof t){let a=null!=(i=t.type)?i:"item";if("split"===a)return null==l||l.classList.add(v),l;if(null==(r=null==t?void 0:t.icon)?void 0:r.svg)if(h.tP.test(t.icon.svg)){let e=new Image;t.icon.width?e.style.width=t.icon.width.toString()+"px":e.style.width="16px",t.icon.height?e.style.height=t.icon.height.toString()+"px":e.style.height="16px",e.src=t.icon.svg,l.appendChild(e)}else{let i=(0,n.a)("span",[y,x]);i.innerHTML=e&&t.selectedIcon&&t.selectedIcon.svg?t.selectedIcon.svg:t.icon.svg,t.icon.width&&i.children[0].setAttribute("width",t.icon.width.toString()),t.icon.height&&i.children[0].setAttribute("height",t.icon.height.toString()),l.appendChild(i)}let o=(0,n.a)("span",[c,x,C]);if(o.innerHTML=t.text,l.appendChild(o),"title"===a)null==l||l.classList.add(x,b);else if(null==(s=null==t?void 0:t.children)?void 0:s.length){let t=(0,n.a)("span",[c,x,_]);t.innerHTML=e?'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#2E68CF" fill-opacity="0.65"></path></svg>':'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#141414" fill-opacity="0.65"></path></svg>',l.appendChild(t)}}return l}},29322:function(t,e,i){"use strict";i.d(e,{D:()=>n,Z:()=>s});var r=i(75485);function n(t){return{rootContainer:new r.ZA({}),renderDefault:!0}}class s{constructor(t){this.table=t,this.customLayoutFuncCache=new Map,this.reactRemoveGraphicCache=new Map,this.reactRemoveAllGraphicCache=new Map,this.headerCustomLayoutFuncCache=new Map,this.headerReactRemoveGraphicCache=new Map,this.headerReactRemoveAllGraphicCache=new Map}hasReactCreateGraphic(t,e){return e?this.headerCustomLayoutFuncCache.has(t):this.customLayoutFuncCache.has(t)}setReactCreateGraphic(t,e,i){i?this.headerCustomLayoutFuncCache.set(t,e):this.customLayoutFuncCache.set(t,e)}setReactRemoveGraphic(t,e,i){i?this.headerReactRemoveGraphicCache.set(t,e):this.reactRemoveGraphicCache.set(t,e)}setReactRemoveAllGraphic(t,e,i){i?this.headerReactRemoveAllGraphicCache.set(t,e):this.reactRemoveAllGraphicCache.set(t,e)}updateCustomCell(t,e){let i=this.table;if("autoWidth"===i.widthMode&&i.scenegraph.recalculateColWidths(),(i.isAutoRowHeight()||"auto"===i.internalProps.defaultRowHeight&&!e||"auto"===i.internalProps.defaultHeaderRowHeight&&e)&&i.scenegraph.recalculateRowHeights(),i.isPivotTable()){let r=function(t,e,i){let r=+!!e.internalProps.rowSeriesNumber,n=[],s=e.internalProps.layoutMap;if(i){let{headerObjects:e}=s,i=[];for(let r=0;r<e.length;r++){let n=e[r];n&&n.define.componentId===t&&i.push(n.id)}for(let t=0;t<i.length;t++){let e=i[t],r=s.getHeaderCellAdressById(e),l=s.getCellRange(r.col,r.row);n.push(l)}}else{let e,{columnObjects:i,indicatorsAsCol:l}=s;for(let r=0;r<i.length;r++)if(i[r].define.componentId===t){e=r;break}if(l)for(let t=s.rowHeaderLevelCount+e;t<s.colCount;t+=i.length){let e={start:{col:t+r,row:s.columnHeaderLevelCount},end:{col:t+r,row:s.rowCount-1}};n.push(e)}else for(let t=s.columnHeaderLevelCount+e;t<s.rowCount;t+=i.length){let e={start:{col:s.rowHeaderLevelCount+r,row:t},end:{col:s.colCount-1,row:t}};n.push(e)}}return n}(t,i,e);for(let t=0;t<r.length;t++){let e=r[t];for(let t=e.start.col;t<=e.end.col;t++)for(let r=e.start.row;r<=e.end.row;r++)i.scenegraph.updateCellContent(t,r)}}else{let r=function(t,e,i){let r=+!!e.internalProps.rowSeriesNumber;if(i){let i,r=e.internalProps.layoutMap,{headerObjects:n}=e.internalProps.layoutMap;for(let e=0;e<n.length;e++){let r=n[e];if(r.define.componentId===t){i=r.id;break}}let s=r.getHeaderCellAdressById(i);return r.getCellRange(s.col,s.row)}let{columnObjects:n}=e.internalProps.layoutMap;for(let i=0;i<n.length;i++)if(n[i].define.componentId===t)return{start:{col:r+i,row:e.columnHeaderLevelCount},end:{col:r+i,row:e.rowCount-1}};return{start:{col:0,row:0},end:{col:e.colCount-1,row:e.rowCount-1}}}(t,i,e);for(let t=r.start.col;t<=r.end.col;t++)for(let e=r.start.row;e<=r.end.row;e++)i.scenegraph.updateCellContent(t,e)}i.scenegraph.renderSceneGraph()}getCustomLayoutFunc(t,e){var i;if(this.table.isHeader(t,e)){let{componentId:r}=this.table.getHeaderDefine(t,e);return null!=(i=this.headerCustomLayoutFuncCache.get(r))?i:n}let{componentId:r}=this.table.getBodyColumnDefine(t,e);return this.customLayoutFuncCache.get(r)||n}removeCustomCell(t,e){let i;if(this.table.isHeader(t,e)){let{componentId:r}=this.table.getHeaderDefine(t,e);i=this.headerReactRemoveGraphicCache.get(r)}else{let{componentId:r}=this.table.getBodyColumnDefine(t,e);i=this.reactRemoveGraphicCache.get(r)}i&&i(t,e)}clearCache(){this.reactRemoveAllGraphicCache.forEach(t=>{t()}),this.headerReactRemoveAllGraphicCache.forEach(t=>{t()})}updateAllCustomCell(){this.customLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e)}),this.headerCustomLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e,!0)})}}},67003:function(t,e,i){"use strict";i.d(e,{Zv:()=>h,h_:()=>a,lc:()=>u,qi:()=>l,ro:()=>o});var r=i(43572),n=i(91212),s=i(16369);function l(t){var e,i;let s=Object.assign({},t);return(0,r.Z)(t.style)||(s.textStyle=a(t.style)),(0,r.Z)(t.textStyle)||(0,n.Z)(s.textStyle,a(t.textStyle)),(null==(e=t.shape)?void 0:e.style)&&a(s.shape.style),(null==(i=t.background)?void 0:i.style)&&a(s.background.style),s}function a(t){return(0,r.Z)(t)||t.angle&&(t.angle=(0,s.M4)(t.angle)),t}function o(t={}){return(0,r.Z)(t.style)||(t.style=a(t.style)),(0,r.Z)(t.state)||Object.keys(t.state).forEach(e=>{(0,r.Z)(t.state[e])||(t.state[e]=a(t.state[e]))}),t}function h(t){return(0,r.Z)(t)?null:(Object.keys(t).forEach(e=>{(0,r.Z)(t[e])||(t[e]=a(t[e]))}),t)}function u(t){return o(t),o(t.startSymbol),o(t.endSymbol),t}},49746:function(t,e,i){"use strict";let r,n,s,l,a,o,h,u,d,c,p,g;i.d(e,{D:()=>rQ});var f,m,y=i(18585),v=i(80747);let b={CHANGE_STYLE:"change_style"};class _ extends v.R{static get EVENT_TYPE(){return b}static get DEFAULT(){return r||(r=new _)}constructor(t={},e={}){var i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E;super(),this._defaultPadding=[10,16,10,16],this._textAlign=null!=(i=null==t?void 0:t.textAlign)?i:null==e?void 0:e.textAlign,this._textBaseline=null!=(r=null==t?void 0:t.textBaseline)?r:null==e?void 0:e.textBaseline,this._color=null!=(n=null==t?void 0:t.color)?n:null==e?void 0:e.color,this._strokeColor=null!=(s=null==t?void 0:t.strokeColor)?s:null==e?void 0:e.strokeColor,this._fontSize=null!=(l=t.fontSize)?l:null==e?void 0:e.fontSize,this._fontFamily=null!=(a=t.fontFamily)?a:null==e?void 0:e.fontFamily,this._fontWeight=null!=(o=t.fontWeight)?o:null==e?void 0:e.fontWeight,this._fontVariant=null!=(h=t.fontVariant)?h:null==e?void 0:e.fontVariant,this._fontStyle=null!=(u=t.fontStyle)?u:null==e?void 0:e.fontStyle,this._padding=null!=(c=null!=(d=null==t?void 0:t.padding)?d:null==e?void 0:e.padding)?c:this._defaultPadding,this._borderColor=null!=(p=null==t?void 0:t.borderColor)?p:null==e?void 0:e.borderColor,this._textOverflow=null!=(g=null==t?void 0:t.textOverflow)?g:null==e?void 0:e.textOverflow,this._textStick=null!=(m=null!=(f=t.textStick)?f:null==e?void 0:e.textStick)&&m,this._textStickBaseOnAlign=null!=(v=null!=(y=t.textStickBaseOnAlign)?y:null==e?void 0:e.textStickBaseOnAlign)&&v,this._bgColor=null!=(b=null==t?void 0:t.bgColor)?b:null==e?void 0:e.bgColor,this._lineHeight=null!=(_=null==t?void 0:t.lineHeight)?_:null==e?void 0:e.lineHeight,this._underline=null!=(x=null==t?void 0:t.underline)?x:null==e?void 0:e.underline,this._underlineColor=null!=(C=null==t?void 0:t.underlineColor)?C:null==e?void 0:e.underlineColor,this._underlineDash=null!=(w=null==t?void 0:t.underlineDash)?w:null==e?void 0:e.underlineDash,this._underlineOffset=null!=(S=null==t?void 0:t.underlineOffset)?S:null==e?void 0:e.underlineOffset,this._lineThrough=null!=(A=null==t?void 0:t.lineThrough)?A:null==e?void 0:e.lineThrough,this._lineThroughColor=null!=(M=null==t?void 0:t.lineThroughColor)?M:null==e?void 0:e.lineThroughColor,this._lineThroughDash=null!=(k=null==t?void 0:t.lineThroughDash)?k:null==e?void 0:e.lineThroughDash,this._linkColor=null!=(T=null==t?void 0:t.linkColor)?T:null==e?void 0:e.linkColor,this._cursor=null!=(R=t.cursor)?R:null==e?void 0:e.cursor,this._borderLineWidth=null!=(B=t.borderLineWidth)?B:null==e?void 0:e.borderLineWidth,this._borderLineDash=null!=(P=t.borderLineDash)?P:null==e?void 0:e.borderLineDash,this._marked=null!=(E=t.marked)?E:null==e?void 0:e.marked}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get padding(){return this._padding}set padding(t){this._padding=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}get marked(){return this._marked}set marked(t){this._marked=t}clone(){return new _(this,null)}}class x extends _{static get DEFAULT(){return n||(n=new x)}constructor(t={},e={},i={}){var r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S;super(t,e),this._size=(null!=(n=null!=(r=null==t?void 0:t.size)?r:null==e?void 0:e.size)?n:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(l=null!=(s=null==t?void 0:t.spaceBetweenTextAndIcon)?s:null==e?void 0:e.spaceBetweenTextAndIcon)?l:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(o=null==(a=null==t?void 0:t.checkboxStyle)?void 0:a.defaultFill)?o:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(u=null==(h=null==t?void 0:t.checkboxStyle)?void 0:h.defaultStroke)?u:null==i?void 0:i.defaultStroke,this._disableFill=null!=(c=null==(d=null==t?void 0:t.checkboxStyle)?void 0:d.disableFill)?c:null==i?void 0:i.disableFill,this._checkedFill=null!=(g=null==(p=null==t?void 0:t.checkboxStyle)?void 0:p.checkedFill)?g:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(m=null==(f=null==t?void 0:t.checkboxStyle)?void 0:f.checkedStroke)?m:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(v=null==(y=null==t?void 0:t.checkboxStyle)?void 0:y.disableCheckedFill)?v:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(_=null==(b=null==t?void 0:t.checkboxStyle)?void 0:b.disableCheckedStroke)?_:null==i?void 0:i.disableCheckedStroke,this._checkIconImage=null!=(C=null==(x=null==t?void 0:t.checkboxStyle)?void 0:x.checkIconImage)?C:null==i?void 0:i.checkIconImage,this._indeterminateIconImage=null!=(S=null==(w=null==t?void 0:t.checkboxStyle)?void 0:w.indeterminateIconImage)?S:null==i?void 0:i.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new x(t,this)}clone(){return new x(this)}}class C extends _{static get DEFAULT(){return s||(s=new C)}constructor(t={},e={},i={}){var r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M;super(t,e),this._size=(null!=(n=null!=(r=null==t?void 0:t.size)?r:null==e?void 0:e.size)?n:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(l=null!=(s=null==t?void 0:t.spaceBetweenTextAndIcon)?s:null==e?void 0:e.spaceBetweenTextAndIcon)?l:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._spaceBetweenRadio=(null!=(o=null!=(a=null==t?void 0:t.spaceBetweenRadio)?a:null==e?void 0:e.spaceBetweenRadio)?o:null==i?void 0:i.spaceBetweenRadio)||2,this._innerRadius=null!=(u=null==(h=null==t?void 0:t.radioStyle)?void 0:h.innerRadius)?u:null==i?void 0:i.innerRadius,this._outerRadius=null!=(c=null==(d=null==t?void 0:t.radioStyle)?void 0:d.outerRadius)?c:null==i?void 0:i.outerRadius,this._defaultFill=null!=(g=null==(p=null==t?void 0:t.radioStyle)?void 0:p.defaultFill)?g:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(m=null==(f=null==t?void 0:t.radioStyle)?void 0:f.defaultStroke)?m:null==i?void 0:i.defaultStroke,this._disableFill=null!=(v=null==(y=null==t?void 0:t.radioStyle)?void 0:y.disableFill)?v:null==i?void 0:i.disableFill,this._checkedFill=null!=(_=null==(b=null==t?void 0:t.radioStyle)?void 0:b.checkedFill)?_:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(C=null==(x=null==t?void 0:t.radioStyle)?void 0:x.checkedStroke)?C:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(S=null==(w=null==t?void 0:t.radioStyle)?void 0:w.disableCheckedFill)?S:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(M=null==(A=null==t?void 0:t.radioStyle)?void 0:A.disableCheckedStroke)?M:null==i?void 0:i.disableCheckedStroke}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get spaceBetweenRadio(){return this._spaceBetweenRadio}set spaceBetweenRadio(t){this._spaceBetweenRadio=t}get innerRadius(){return this._innerRadius}set innerRadius(t){this._innerRadius=t}get outerRadius(){return this._outerRadius}set outerRadius(t){this._outerRadius=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}getStyle(t){return new C(t,this)}clone(){return new C(this)}}class w extends _{static get DEFAULT(){return l||(l=new w)}constructor(t={},e={},i={}){var r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_;super(t,e),this._spaceBetweenTextAndCircle=(null!=(n=null!=(r=null==t?void 0:t.spaceBetweenTextAndCircle)?r:null==e?void 0:e.spaceBetweenTextAndCircle)?n:null==i?void 0:i.spaceBetweenTextAndCircle)||6,this._circleRadius=(null!=(l=null==(s=null==t?void 0:t.switchStyle)?void 0:s.circleRadius)?l:null==i?void 0:i.circleRadius)||8,this._boxWidth=(null!=(o=null==(a=null==t?void 0:t.switchStyle)?void 0:a.boxWidth)?o:null==i?void 0:i.boxWidth)||40,this._boxHeight=(null!=(u=null==(h=null==t?void 0:t.switchStyle)?void 0:h.boxHeight)?u:null==i?void 0:i.boxHeight)||24,this._checkedFill=(null!=(c=null==(d=null==t?void 0:t.switchStyle)?void 0:d.checkedFill)?c:null==i?void 0:i.checkedFill)||"#165DFF",this._uncheckedFill=(null!=(g=null==(p=null==t?void 0:t.switchStyle)?void 0:p.uncheckedFill)?g:null==i?void 0:i.uncheckedFill)||"#c9cdd4",this._disableCheckedFill=(null!=(m=null==(f=null==t?void 0:t.switchStyle)?void 0:f.disableCheckedFill)?m:null==i?void 0:i.disableCheckedFill)||"#94bfff",this._disableUncheckedFill=(null!=(v=null==(y=null==t?void 0:t.switchStyle)?void 0:y.disableUncheckedFill)?v:null==i?void 0:i.disableUncheckedFill)||"#f2f3f5",this._circleFill=(null!=(_=null==(b=null==t?void 0:t.switchStyle)?void 0:b.circleFill)?_:null==i?void 0:i.circleFill)||"#FFF"}get spaceBetweenTextAndCircle(){return this._spaceBetweenTextAndCircle}set spaceBetweenTextAndCircle(t){this._spaceBetweenTextAndCircle=t}get circleRadius(){return this._circleRadius}set circleRadius(t){this._circleRadius=t}get boxWidth(){return this._boxWidth}set boxWidth(t){this._boxWidth=t}get boxHeight(){return this._boxHeight}set boxHeight(t){this._boxHeight=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get uncheckedFill(){return this._uncheckedFill}set uncheckedFill(t){this._uncheckedFill=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableUncheckedFill(){return this._disableUncheckedFill}set disableUncheckedFill(t){this._disableUncheckedFill=t}get circleFill(){return this._circleFill}set circleFill(t){this._circleFill=t}getStyle(t){return new w(t,this)}clone(){return new w(this)}}class S extends _{static get DEFAULT(){return a||(a=new S)}constructor(t={},e={},i={}){var r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S;super(t,e),this._buttonColor=(null!=(n=null==(r=null==t?void 0:t.buttonStyle)?void 0:r.buttonColor)?n:null==i?void 0:i.buttonColor)||"#165DFF",this._buttonBorderColor=(null!=(l=null==(s=null==t?void 0:t.buttonStyle)?void 0:s.buttonBorderColor)?l:null==i?void 0:i.buttonBorderColor)||"#165DFF",this._buttonLineWidth=(null!=(o=null==(a=null==t?void 0:t.buttonStyle)?void 0:a.buttonLineWidth)?o:null==i?void 0:i.buttonLineWidth)||1,this._buttonBorderRadius=(null!=(u=null==(h=null==t?void 0:t.buttonStyle)?void 0:h.buttonBorderRadius)?u:null==i?void 0:i.buttonBorderRadius)||2,this._buttonHoverColor=(null!=(c=null==(d=null==t?void 0:t.buttonStyle)?void 0:d.buttonHoverColor)?c:null==i?void 0:i.buttonHoverColor)||"#4080FF",this._buttonHoverBorderColor=(null!=(g=null==(p=null==t?void 0:t.buttonStyle)?void 0:p.buttonHoverBorderColor)?g:null==i?void 0:i.buttonHoverBorderColor)||"#4080FF",this._buttonTextHoverColor=null!=(m=null==(f=null==t?void 0:t.buttonStyle)?void 0:f.buttonTextHoverColor)?m:null==i?void 0:i.buttonTextHoverColor,this._buttonDisableColor=(null!=(v=null==(y=null==t?void 0:t.buttonStyle)?void 0:y.buttonDisableColor)?v:null==i?void 0:i.buttonDisableColor)||"#94bfff",this._buttonDisableBorderColor=(null!=(_=null==(b=null==t?void 0:t.buttonStyle)?void 0:b.buttonDisableBorderColor)?_:null==i?void 0:i.buttonDisableBorderColor)||"#94bfff",this._buttonTextDisableColor=null!=(C=null==(x=null==t?void 0:t.buttonStyle)?void 0:x.buttonTextDisableColor)?C:null==i?void 0:i.buttonTextDisableColor,this._buttonPadding=(null!=(S=null==(w=null==t?void 0:t.buttonStyle)?void 0:w.buttonPadding)?S:null==i?void 0:i.buttonPadding)||10}get buttonColor(){return this._buttonColor}set buttonColor(t){this._buttonColor=t}get buttonBorderColor(){return this._buttonBorderColor}set buttonBorderColor(t){this._buttonBorderColor=t}get buttonLineWidth(){return this._buttonLineWidth}set buttonLineWidth(t){this._buttonLineWidth=t}get buttonBorderRadius(){return this._buttonBorderRadius}set buttonBorderRadius(t){this._buttonBorderRadius=t}get buttonHoverColor(){return this._buttonHoverColor}set buttonHoverColor(t){this._buttonHoverColor=t}get buttonHoverBorderColor(){return this._buttonHoverBorderColor}set buttonHoverBorderColor(t){this._buttonHoverBorderColor=t}get buttonTextHoverColor(){return this._buttonTextHoverColor}set buttonTextHoverColor(t){this._buttonTextHoverColor=t}get buttonDisableColor(){return this._buttonDisableColor}set buttonDisableColor(t){this._buttonDisableColor=t}get buttonDisableBorderColor(){return this._buttonDisableBorderColor}set buttonDisableBorderColor(t){this._buttonDisableBorderColor=t}get buttonTextDisableColor(){return this._buttonTextDisableColor}set buttonTextDisableColor(t){this._buttonTextDisableColor=t}get buttonTextHoverBorderColor(){return this._buttonTextHoverBorderColor}set buttonTextHoverBorderColor(t){this._buttonTextHoverBorderColor=t}get buttonPadding(){return this._buttonPadding}set buttonPadding(t){this._buttonPadding=t}getStyle(t){return new S(t,this)}clone(){return new S(this)}}let{EVENT_TYPE:A}=_;function M(t,e,i,r=_,n,s){var l,a,o,h;return t||e?t instanceof _?t:"function"==typeof t?M(t(i),e,i,r,n,s):(t||(t={}),n&&!(0,y.Z)(t.autoWrapText)&&(t.autoWrapText=!0),r===x?new x(null!=t?t:{},null!=e?e:{},null!=(l=s.checkboxStyle)?l:{}):r===C?new C(null!=t?t:{},null!=e?e:{},null!=(a=s.radioStyle)?a:{}):r===w?new w(null!=t?t:{},null!=e?e:{},null!=(o=s.switchStyle)?o:{}):r===S?new S(null!=t?t:{},null!=e?e:{},null!=(h=s.buttonStyle)?h:{}):new r(null!=t?t:{},null!=e?e:{})):r.DEFAULT}var k=i(84375),T=i(61482),R=i(73664),B=i(37902),P=i(57657),E=i(99506),I=i(78287),L=i(5723),F=i(28132),O=i(12588),D=i(42192),H=i(42517),z=i(91018),W=i(89983),N=i(34301),j=i(44186),G=i(74945),V=i(13844),Z=i(59885),U=i(76349),K=i(46312),$=i(42512),Y=i(67203),X=i(58977);function q(t){return!!("cell"===t.role&&(0,X.Z)(t.mergeStartCol)&&(0,X.Z)(t.mergeStartRow)&&(0,X.Z)(t.mergeEndCol)&&(0,X.Z)(t.mergeEndRow))}var J=i(14828),Q=i(40793),te=i(7430),ti=i(80852);function tr(t,e,i,r){!r&&i&&t.table._setRowHeight(e,t.table.getRowHeight(e)+i,!0);for(let r=0;r<t.table.colCount;r++){var n,s,l,a,o,h,u;let d=t.getCell(r,e);if("empty"===d.role)continue;let c=(0,G.Z)(t.table,r,e);c&&c.start.col!==r||(n=t,s=d,l=r,a=e,o=d.attribute.height+i,h=i,u=t.table.isHeader(r,e),s&&tn(n,s,l,a,o,h,u),t.updateCellContentWhileResize(r,e))}let d=0,c=0;e<t.table.frozenRowCount?(d=e+1,c=t.table.frozenRowCount-1):e>=t.table.rowCount-t.table.bottomFrozenRowCount?(d=e+1,c=t.table.rowCount-1):(d=e+1,c=Math.min(t.proxy.rowEnd,t.table.rowCount-t.table.bottomFrozenRowCount-1));for(let e=0;e<t.table.colCount;e++)for(let r=d;r<=c;r++){let n=t.highPerformanceGetCell(e,r);"cell"===n.role&&n.setAttribute("y",n.attribute.y+i)}}function tn(t,e,i,r,n,s,l){var a,o,h,u,d;if(e.attribute.height===n&&!e.needUpdateHeight)return;e.needUpdateHeight=!1,e.setAttribute("height",n);let c=null==(a=t.table.getCellRawRecord(i,r))?void 0:a.vtableMerge,p=!!t.table.getCustomMerge(i,r),g=c||p?"text":t.table.isHeader(i,r)?null!=(o=t.table._getHeaderLayoutMap(i,r).headerType)?o:"text":null!=(h=t.table.getBodyColumnType(i,r))?h:"text";if("progressbar"===g){let l,a=t.table.getBodyColumnDefine(i,r),o=t.table._getCellStyle(i,r),h=t.table.getCellValue(i,r),u=t.table.getCellOriginValue(i,r),d=(0,J.u)((0,Y.WJ)("padding",o,i,r,t.table));(null==a?void 0:a.mergeCell)&&(l=t.table.getCellRange(i,r));let c=V.F.getFunction("createProgressBarCell")(a,o,e.attribute.width,h,u,i,r,d,t.table,l),p=e.getChildByName("progress-bar");e.insertBefore(c,p),e.removeChild(p),p.removeAllChild(),p.release(),ts(e,n,s,t.table.isAutoRowHeight(r),!0,t.table)}else if("sparkline"===g){e.removeAllChild();let n=t.table._getCellStyle(i,r),s=(0,J.u)((0,Y.WJ)("padding",n,i,r,t.table));V.F.getFunction("createSparkLineCellGroup")(e,e.parent,e.attribute.x,e.attribute.y,i,r,e.attribute.width,e.attribute.height,s,t.table,(0,Z.RT)(n,t.table,i,r,Y.WJ).theme,!1)}else if("image"===g||"video"===g)(0,K.km)(e,i,r,0,s,t.table);else if("axis"===(null==(u=e.firstChild)?void 0:u.name))null==(d=e.firstChild)||d.originAxis.resize(e.attribute.width,e.attribute.height);else{let l=!0,a=e.getChildByName(U.FH)||e.getChildByName(U.cd);if(a){let n;e.removeChild(a);let s=(0,$.l7)(i,r,e,t.table);if(s)for(let e=s.start.row;e<=s.end.row;e++){if(e===r)continue;let n=t.getCell(i,e),s=n.getChildByName(U.FH)||n.getChildByName(U.cd);s.removeAllChild(),n.removeChild(s),(0,$.l7)(i,e,n,t.table)}else{let s,a,o=t.table.getCellLocation(i,r),{vtableMerge:h}=t.table.getCellRawRecord(i,r)||{};if(h&&t.table.internalProps.groupTitleCustomLayout)a=t.table.internalProps.groupTitleCustomLayout;else if("body"!==o){let e=t.table.getHeaderDefine(i,r);s=null==e?void 0:e.headerCustomRender,a=null==e?void 0:e.headerCustomLayout}else{let e=t.table.getBodyColumnDefine(i,r);s=(null==e?void 0:e.customRender)||t.table.customRender,a=null==e?void 0:e.customLayout}if((s||a)&&q(e))for(let i=e.mergeStartCol;i<=e.mergeEndCol;i++)for(let n=e.mergeStartRow;n<=e.mergeEndRow;n++)n!==r&&t.updateCellContent(i,n);if(a||s){let o=t.table._getCellStyle(i,r),h=(0,J.u)((0,Y.WJ)("padding",o,i,r,t.table)),u=e.attribute.width,d=e.attribute.height;q(e)&&(u=t.table.getColsWidth(e.mergeStartCol,e.mergeEndCol),d=t.table.getRowsHeight(e.mergeStartRow,e.mergeEndRow));let c=(0,U.ws)(a,s,i,r,u,d,!1,t.table.isAutoRowHeight(r),h,q(e)?{start:{col:e.mergeStartCol,row:e.mergeStartRow},end:{col:e.mergeEndCol,row:e.mergeEndRow}}:void 0,t.table);n=c.elementsGroup,l=c.renderDefault}e.childrenCount>0&&n?e.insertBefore(n,e.firstChild):n&&e.appendChild(n)}}ts(e,n,s,t.table.isAutoRowHeight(r),l,t.table)}}function ts(t,e,i,r,n,s){if(q(t)){e=0;for(let i=t.mergeStartRow;i<=t.mergeEndRow;i++)e+=s.getRowHeight(i);let{colStart:l,colEnd:a,rowStart:o,rowEnd:h}=(0,ti.e)(t,s.scenegraph);for(let u=l;u<=a;u++)for(let a=o;a<=h;a++){let h=s.scenegraph.getCell(u,a);if("cell"!==h.role)continue;if(h.forEachChildren(t=>{t.setAttributes({dx:0,dy:0})}),n){let t=s._getCellStyle(l,o),n=(0,J.u)((0,Y.WJ)("padding",t,u,a,s));(0,Q.Zl)(h,e,i,r,n,t.textAlign,t.textBaseline,s)}let d=s.getRowHeight(a),c=s.getColWidth(u);h.contentHeight=e;let{widthChange:p}=(0,$.NQ)(h,c,d,{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}},s);p&&(h.needUpdateWidth=!0)}}else{let n=s._getCellStyle(t.col,t.row),l=(0,J.u)((0,Y.WJ)("padding",n,t.col,t.row,s));(0,Q.Zl)(t,e,i,r,l,n.textAlign,n.textBaseline,s)}}var tl=i(52186);function ta(t,e,i,r){var n,s,l,a,o,h,u;let d=!1,c=null!=(n=null==t?void 0:t.attribute.width)?n:0;if(null==t||t.setAttribute("width",c+e),null==t||t.forEachChildren((t,n)=>{if(function(t,e,i,r,n,s,l,a,o){var h,u,d,c,p,g,f;if(e.attribute.width===s&&!e.needUpdateWidth)return!1;if(e.needUpdateWidth=!1,e.setAttribute("width",s),!e)return!1;let m=t.table.isAutoRowHeight(r),y=null==(h=t.table.getCellRawRecord(i,r))?void 0:h.vtableMerge,v=!!t.table.getCustomMerge(i,r),b=y||v?"text":t.table.isHeader(i,r)?null!=(u=t.table._getHeaderLayoutMap(i,r).headerType)?u:"text":null!=(d=t.table.getBodyColumnType(i,r))?d:"text",_=!1;if("progressbar"===b){let n,a=t.table.getBodyColumnDefine(i,r),o=t.table._getCellStyle(i,r),h=t.table.getCellValue(i,r),u=t.table.getCellOriginValue(i,r),d=(0,J.u)((0,Y.WJ)("padding",o,i,r,t.table));(null==a?void 0:a.mergeCell)&&(n=t.table.getCellRange(i,r));let c=V.F.getFunction("createProgressBarCell")(a,o,e.attribute.width,h,u,i,r,d,t.table,n),p=e.getChildByName("progress-bar");e.insertBefore(c,p),e.removeChild(p),p.removeAllChild(),p.release();let g=to(e,s,l,m,!0,t.table);_=_||g}else if("sparkline"===b){e.removeAllChild();let n=t.table._getCellStyle(i,r),s=(0,J.u)((0,Y.WJ)("padding",n,i,r,t.table));V.F.getFunction("createSparkLineCellGroup")(e,e.parent,e.attribute.x,e.attribute.y,i,r,e.attribute.width,e.attribute.height,s,t.table,(0,Z.RT)(n,t.table,i,r,Y.WJ).theme,!1)}else if("image"===b||"video"===b)(0,K.km)(e,i,r,l,0,t.table);else if("axis"===(null==(c=e.firstChild)?void 0:c.name)){let n=t.table.internalProps.layoutMap.getAxisConfigInPivotChart(i,r),s=t.table._getCellStyle(i,r),l=(0,J.u)((0,Y.WJ)("padding",s,i,r,t.table));if(n){let i=new(V.F.getComponent("axis"))(n,e.attribute.width,e.attribute.height,null!=(p=n.__vtablePadding)?p:l,t.table);e.clear(),e.appendChild(i.component),i.overlap()}}else if("axis"===(null==(g=e.firstChild)?void 0:g.name))null==(f=e.firstChild)||f.originAxis.resize(e.attribute.width,e.attribute.height);else{let n=!0,a=e.getChildByName(U.FH)||e.getChildByName(U.cd);if(a){let s;e.removeChild(a);let l=(0,$.l7)(i,r,e,t.table);if(l)for(let e=l.start.col;e<=l.end.col;e++){if(e===i)continue;let n=t.getCell(e,r),s=n.getChildByName(U.FH)||n.getChildByName(U.cd);s.removeAllChild(),n.removeChild(s),(0,$.l7)(e,r,n,t.table)}else{let l,a,o=t.table.getCellLocation(i,r),{vtableMerge:h}=t.table.getCellRawRecord(i,r)||{};if(h&&t.table.internalProps.groupTitleCustomLayout)a=t.table.internalProps.groupTitleCustomLayout;else if("body"!==o){let e=t.table.getHeaderDefine(i,r);l=null==e?void 0:e.headerCustomRender,a=null==e?void 0:e.headerCustomLayout}else{let e=t.table.getBodyColumnDefine(i,r);l=(null==e?void 0:e.customRender)||t.table.customRender,a=null==e?void 0:e.customLayout}if((l||a)&&q(e)){for(let r=e.mergeStartCol;r<=e.mergeEndCol;r++)if(r!==i)for(let i=e.mergeStartRow;i<=e.mergeEndRow;i++)t.updateCellContent(r,i)}if(a||l){let o=t.table._getCellStyle(i,r),h=(0,J.u)((0,Y.WJ)("padding",o,i,r,t.table)),u=e.attribute.width,d=e.attribute.height;q(e)&&(u=t.table.getColsWidth(e.mergeStartCol,e.mergeEndCol),d=t.table.getRowsHeight(e.mergeStartRow,e.mergeEndRow));let c=(0,U.ws)(a,l,i,r,u,d,!1,t.table.isAutoRowHeight(r),h,q(e)?{start:{col:e.mergeStartCol,row:e.mergeStartRow},end:{col:e.mergeEndCol,row:e.mergeEndRow}}:void 0,t.table);s=c.elementsGroup,n=c.renderDefault,_=!0}e.childrenCount>0&&s?e.insertBefore(s,e.firstChild):s&&e.appendChild(s)}}let o=to(e,s,l,m,n,t.table);_=_||o}return o||(o=t.table._getCellStyle(i,r).autoWrapText),!(!m||!o)&&_}(r,t,t.col,t.row,0,c+e,e,"row-body"!==i||(t.col,r.table.rowHeaderLevelCount),r.table.internalProps.autoWrapText)){let e=(0,G.Z)(r.table,t.col,t.row);if(e&&e.end.row-e.start.row)for(let t=e.start.row;t<=e.end.row;t++)th(r,t);else th(r,t.row);d=!0}}),d){let t,e,n,d=0;for(let c=0;c<r.table.colCount;c++){if("col-corner"===i?(n=0,t=r.getColGroup(c,!0),e=null!=(s=r.colHeaderGroup.attribute.height)?s:0):"row-body"===i?(n=r.table.frozenRowCount,t=r.getColGroup(c,!1),e=null!=(l=r.bodyGroup.attribute.height)?l:0):"bottom"===i?(n=r.table.rowCount-r.table.bottomFrozenRowCount,t=r.getColGroupInBottom(c),e=null!=(a=r.bottomFrozenGroup.attribute.height)?a:0):"left-bottom"===i?(n=r.table.rowCount-r.table.bottomFrozenRowCount,t=r.getColGroupInLeftBottomCorner(c),e=null!=(o=r.leftBottomCornerGroup.attribute.height)?o:0):"right-top"===i?(n=0,t=r.getColGroupInRightTopCorner(c),e=null!=(h=r.rightTopCornerGroup.attribute.height)?h:0):"right-bottom"===i&&(n=r.table.rowCount-r.table.bottomFrozenRowCount,t=r.getColGroupInRightBottomCorner(c),e=null!=(u=r.rightBottomCornerGroup.attribute.height)?u:0),!t)continue;let p=0;t.forEachChildren(t=>{var e;t.setAttribute("y",p),p+=null!=(e=r.table.getRowHeight(t.row))?e:0}),d=p}r.updateContainerHeight(n,d-e);for(let t=0;t<r.table.frozenColCount;t++){let e=r.getColGroupInLeftBottomCorner(t),i=0;null==e||e.forEachChildren(t=>{t.setAttribute("y",i),i+=r.table.getRowHeight(t.row)})}for(let t=r.table.colCount-r.table.rightFrozenColCount;t<r.table.colCount;t++){let e=r.getColGroupInRightBottomCorner(t),i=0;null==e||e.forEachChildren(t=>{t.setAttribute("y",i),i+=r.table.getRowHeight(t.row)})}for(let t=r.table.frozenColCount;t<r.table.colCount-r.table.rightFrozenColCount;t++){let e=r.getColGroupInBottom(t),i=0;null==e||e.forEachChildren(t=>{t.setAttribute("y",i),i+=r.table.getRowHeight(t.row)})}}}function to(t,e,i,r,n,s){if(q(t)){e=0;let l=!1;for(let i=t.mergeStartCol;i<=t.mergeEndCol;i++)e+=s.getColWidth(i);let a=0;for(let e=t.mergeStartRow;e<=t.mergeEndRow;e++)a+=s.getRowHeight(e);let{colStart:o,colEnd:h,rowStart:u,rowEnd:d}=(0,ti.e)(t,s.scenegraph);for(let c=o;c<=h;c++)for(let h=u;h<=d;h++){if(c===t.col&&h!==t.row)continue;let d=s.scenegraph.getCell(c,h);if("cell"!==d.role)continue;d.forEachChildren(t=>{t.setAttributes({dx:0,dy:0})});let p=!1;if(n){let t=s._getCellStyle(o,u),n=(0,J.u)((0,Y.WJ)("padding",t,c,h,s)),l=t.textAlign,g=t.textBaseline;p=(0,Q.qs)(d,e,a,i,r,n,l,g,s.scenegraph);let f=(0,tl.L)(d.col,d.row,s);if(f){let t=d.getChildByName("text"),e=d.getChildByName("expand")||d.getChildByName("collapse");"icon-left"!==(null==e?void 0:e.role)&&t&&t.setAttribute("dx",f)}}let g=s.getRowHeight(h),f=s.getColWidth(c);d.contentWidth=e;let{heightChange:m}=(0,$.NQ)(d,f,g,{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}},s);m&&(d.needUpdateHeight=!0),l=l||p}return l}let l=s._getCellStyle(t.col,t.row),a=(0,J.u)((0,Y.WJ)("padding",l,t.col,t.row,s)),o=l.textAlign,h=l.textBaseline;return(0,Q.qs)(t,e,s.getRowHeight(t.row),i,r,a,o,h,s.scenegraph)}function th(t,e){let i=Math.round((0,te.P)(e,0,t.table.colCount-1,t.table));t.table._setRowHeight(e,i,!0);for(let l=0;l<t.table.colCount;l++){var r,n,s;let a=t.highPerformanceGetCell(l,e);"empty"!==a.role&&(r=l,n=i-a.attribute.height,s=t.table.isHeader(l,e),a&&tn(t,a,r,e,i,n,s))}}var tu=i(32463),td=i(64103),tc=i(35953),tp=i(75485),tg=i(57823),tf=i(26771),tm=i(28996);(f=m||(m={})).dropDown="dropDown",f.contextmenu="contextmenu",f.custom="custom";let ty={fontSize:12,fontFamily:"Arial,sans-serif",color:"#000",highlightColor:"#2E68CF",hoverBgColor:"#EEE",lineHeight:30,bgColor:"#FFF",cornerRadius:4,borderWidth:.5,borderColor:"#CCC",menuPadding:6,menuItemPadding:9,maxLineWidth:200};class tv{constructor(t){this._table=t,this._menuInstance=new tf.Z({x:0,y:0,fill:ty.bgColor,stroke:ty.borderColor,cornerRadius:ty.cornerRadius,lineWidth:ty.borderWidth}),this._menuInfo={x:-1,y:-1,col:-1,row:-1,type:m.dropDown,menuInfo:[],highlightIndex:-1}}bindTableComponent(t){t.appendChild(this._menuInstance),this.bindEvent()}release(){}attach(t,e,i,r,n,s){if(n===m.dropDown&&this.checkDropDownMenuChange(i,r)){let t=this.getMenuInfo(i,r,n);if(!t)return;let{menuInfo:e,highlightIndex:s}=t;this.updateMenuInfo(i,r,n,e,s),this.updateMenuInstance(e,s)}else if(n===m.contextmenu&&this.checkContextMenuChange(t,e)){let t=this.getMenuInfo(i,r,n);if(!t)return;let{menuInfo:e,highlightIndex:s}=t;this.updateMenuInfo(i,r,n,e,s),this.updateMenuInstance(e,s)}this.updatePosition(t-this._table.scenegraph.x,e-this._table.scenegraph.y),this.addToScene()}updateMenuInfo(t,e,i,r,n){this._menuInfo.col=t,this._menuInfo.row=e,this._menuInfo.type=i,this._menuInfo.menuInfo=r,this._menuInfo.highlightIndex=n}checkDropDownMenuChange(t,e){let{type:i,col:r,row:n}=this._menuInfo;return i!==m.dropDown||t!==r||e!==n}checkContextMenuChange(t,e){var i;let{type:r,menuInfo:n}=this._menuInfo;return r!==m.contextmenu||n!==(null==(i=this._table.internalProps.menu)?void 0:i.contextMenuItems)}updateMenuInstance(t,e){this._menuInstance.removeAllChild();let i=ty.menuPadding,r=ty.menuPadding,n=0;t.forEach((t,s)=>{var l,a;let o,h,u=e===s;"string"==typeof t?h=t:"object"==typeof t&&(h=t.text,o=u?t.selectedIcon:t.icon);let d=new tf.Z({y:i,x:r,height:ty.lineHeight,fill:ty.bgColor});d.role="menu-item",this._menuInstance.appendChild(d),d.stateProxy=t=>"hover"===t?{fill:ty.hoverBgColor}:{fill:ty.bgColor},d.addEventListener("pointerenter",t=>{d.addState("hover",!0,!1),this._table.scenegraph.updateNextFrame()}),d.addEventListener("pointerleave",t=>{d.removeState("hover",!1),this._table.scenegraph.updateNextFrame()});let c=new td.x({x:ty.menuItemPadding,y:ty.menuItemPadding,fill:u?ty.highlightColor:ty.color,text:h,textBaseline:"top",fontSize:ty.fontSize,fontFamily:ty.fontFamily,pickable:!1,maxLineWidth:ty.maxLineWidth,ellipsis:"…"});if(d.addChild(c),o){c.AABBBounds.height();let t=null!=(l=o.width)?l:16,e=null!=(a=o.height)?a:16,i=new tm.J({x:ty.menuItemPadding,y:(ty.lineHeight-e)/2,width:t,height:e,image:o.svg,pickable:!1});i.role="menu-icon",d.insertBefore(i,c),c.setAttribute("x",t+ty.menuItemPadding)}n=Math.max(d.AABBBounds.width(),n),i+=ty.lineHeight}),this._menuInstance.setAttributes({width:n+2*ty.menuItemPadding+2*ty.menuPadding,height:i+ty.menuPadding}),this._menuInstance.forEachChildren(t=>{t.setAttribute("width",n+2*ty.menuItemPadding)})}updatePosition(t,e){this._menuInstance.setAttributes({x:this._menuInfo.type===m.dropDown?t-this._menuInstance.attribute.width:t,y:e}),this._menuInfo.x=m.dropDown?t-this._menuInstance.attribute.width:t,this._menuInfo.y=e}addToScene(){this._table.scenegraph.updateNextFrame()}detach(){this._menuInstance.setAttributes({x:-1e3,y:-1e3}),this._table.scenegraph.updateNextFrame()}getMenuInfo(t,e,i){var r;if(i===m.dropDown){let i=this._table.globalDropDownMenu;"function"==typeof(i=this._table._getHeaderLayoutMap(t,e).dropDownMenu)&&(i=i({row:e,col:t,table:this._table}));let r=-1;if(Array.isArray(i)){for(let n=0;n<i.length;n++)if(this._table._dropDownMenuIsHighlight(t,e,n)){r=n;break}}return{menuInfo:i,highlightIndex:r}}if(i===m.contextmenu){let i,n=null==(r=this._table.internalProps.menu)?void 0:r.contextMenuItems;if(Array.isArray(n))i=n;else if("function"==typeof n){let{field:r}=this._table.isHeader(t,e)?this._table.getHeaderDefine(t,e):this._table.getBodyColumnDefine(t,e);i=n(r,e,t)}return{menuInfo:i,highlightIndex:-1}}}bindEvent(){this._menuInstance.addEventListener("click",t=>{let{target:e}=t;if(e&&"menu-item"===e.role){let i=Object.assign(this.getEventInfo(e),this._table.getMenuInfo(this._menuInfo.col,this._menuInfo.row,this._menuInfo.type));i.event=t.nativeEvent,this._table.fireListeners(E.B.DROPDOWN_MENU_CLICK,i)}})}getEventInfo(t){let e=t.parent,i=0;e.forEachChildren((e,r)=>e===t&&(i=r-1,!0));let r="string"==typeof this._menuInfo.menuInfo[i]?this._menuInfo.menuInfo[i]:this._menuInfo.menuInfo[i].text,n="string"==typeof this._menuInfo.menuInfo[i]?r:this._menuInfo.menuInfo[i].menuKey||r;return{col:this._menuInfo.col,row:this._menuInfo.row,dropDownIndex:i,highlight:i===this._menuInfo.highlightIndex,text:r,menuKey:n}}get bounds(){return this._menuInstance.globalAABBBounds}}var tb=i(70107);let t_=tb.U2();class tx{constructor(){let t=t_.drillDown;this.icon=new tm.J({x:-1e3,y:-1e3,image:t.svg,width:t.width,height:t.height,dx:-t.width/2,dy:-t.height/2,visible:!1,funcType:t.funcType,cursor:t.cursor}),this.icon.role="icon-drill"}appand(t){t.appendChild(this.icon)}update(t,e,i,r,n,s){if(!t||r&&n)return this.icon.setAttributes({x:-1e3,y:-1e3,visible:!1}),void s.updateNextFrame();let l=t_.drillDown,a=t_.drillUp;this.icon.setAttributes({x:e,y:i,image:r?l.svg:a.svg,visible:!0}),this.icon.loadImage(this.icon.attribute.image),s.updateNextFrame()}}var tC=i(8042);class tw{constructor(t){let e=t.theme.dragHeaderSplitLine.lineWidth,i=t.theme.dragHeaderSplitLine.lineColor,r=t.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel=(0,tC.t)({visible:!1,pickable:!1,x:0,y:0,symbolType:"triangle",fill:i}),this.columnMoverLine=(0,tu.W)({visible:!1,pickable:!1,stroke:i,lineWidth:e,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnMoverBack=(0,tc.f)({visible:!1,pickable:!1,fill:r,x:0,y:0,width:0,height:0}),this.table=t}appand(t){t.appendChild(this.columnMoverLabel),t.appendChild(this.columnMoverLine),t.appendChild(this.columnMoverBack)}show(t,e,i){let r=this.table.getCellLocation(t,e),n=(0,G.Z)(this.table,t,e);n&&(t=n.start.col,e=n.start.row);let s=0,l=0,a=0,o=0,h=0,u=0,d=0,c=0,p=Math.PI,g=[];return"columnHeader"===r?(s=this.table.getColsWidth(0,t-1)-this.table.stateManager.scroll.horizontalBarPos,l=this.table.getRowsHeight(0,this.table.frozenRowCount-1),o=this.table.tableNoFrameHeight,a=n?this.table.getColsWidth(n.start.col,n.end.col):this.table.getColWidth(t),h=s-i,d=s+a,c=2,g.push({x:0,y:0}),g.push({x:0,y:this.table.tableNoFrameHeight})):("rowHeader"===r||this.table.internalProps.layoutMap.isSeriesNumberInBody(t,e))&&(l=this.table.getRowsHeight(0,e-1)-this.table.stateManager.scroll.verticalBarPos,s=this.table.getColsWidth(0,this.table.frozenColCount-1),a=this.table.tableNoFrameWidth,o=n?this.table.getRowsHeight(n.start.row,n.end.row):this.table.getRowHeight(e),u=l-i,d=2,c=l+o,p=Math.PI/2,g.push({x:0,y:0}),g.push({x:this.table.tableNoFrameWidth,y:0})),this.columnMoverBack.setAttributes({visible:!0,x:s-h,y:l-u,width:a,height:o,dx:h,dy:u}),this.columnMoverLine.setAttributes({x:d,y:c,visible:!0,points:g}),this.columnMoverLabel.setAttributes({visible:!0,x:d,y:c,angle:p}),{backX:s-h,lineX:d,backY:l-u,lineY:c}}hide(){this.columnMoverLabel.setAttribute("visible",!1),this.columnMoverLine.setAttribute("visible",!1),this.columnMoverBack.setAttribute("visible",!1)}update(t,e,i,r){"number"==typeof t&&"number"==typeof e?(this.columnMoverLabel.setAttribute("x",e),this.columnMoverLine.setAttribute("x",e),this.columnMoverBack.setAttribute("x",t)):"number"==typeof i&&"number"==typeof r&&(this.columnMoverLabel.setAttribute("y",r),this.columnMoverLine.setAttribute("y",r),this.columnMoverBack.setAttribute("y",i))}updateStyle(){let t=this.table.theme.dragHeaderSplitLine.lineWidth,e=this.table.theme.dragHeaderSplitLine.lineColor,i=this.table.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel.setAttributes({fill:e}),this.columnMoverLine.setAttributes({stroke:e,lineWidth:t}),this.columnMoverBack.setAttributes({fill:i})}}function tS(t,e,i){if(i)return Math.min(e.tableNoFrameWidth,e.getAllColsWidth())-e.getColsWidth(t,e.colCount-1);let r=e.getColsWidth(0,t);return t>=e.frozenColCount&&(r-=e.scrollLeft),r}function tA(t,e,i){if(i)return Math.min(e.tableNoFrameWidth,e.getAllRowsHeight())-e.getRowsHeight(t,e.rowCount-1);let r=e.getRowsHeight(0,t);return t>=e.frozenRowCount&&(r-=e.scrollTop),r}class tM{constructor(t){var e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b;this.table=t;let _=this.table.theme;this.createScrollBar();let x=null==(e=_.columnResize)?void 0:e.lineColor,C=null==(i=_.columnResize)?void 0:i.lineWidth,w=null==(r=_.columnResize)?void 0:r.bgColor,S=null==(n=_.columnResize)?void 0:n.width,A=null==(l=null==(s=_.columnResize)?void 0:s.labelVisible)||l,M=null==(a=_.columnResize)?void 0:a.labelColor,k=null==(o=_.columnResize)?void 0:o.labelFontSize,T=null==(h=_.columnResize)?void 0:h.labelFontFamily,R=null==(u=_.columnResize)?void 0:u.labelBackgroundFill,B=null==(d=_.columnResize)?void 0:d.labelBackgroundCornerRadius;this.labelVisible=A,this.columnResizeLine=(0,tu.W)({visible:!1,pickable:!1,stroke:x,lineWidth:C,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnResizeBgLine=(0,tu.W)({visible:!1,pickable:!1,stroke:w,lineWidth:S,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});let P=(0,td.r)({visible:!1,pickable:!1,x:0,y:0,fontSize:k,fill:M,fontFamily:T,text:"",textBaseline:"top",dx:16,dy:-k/2}),E=(0,tc.f)({visible:!1,pickable:!1,fill:R,x:0,y:0,width:5*k*.8,height:k+8,cornerRadius:B,dx:12,dy:-k/2-4});this.columnResizeLabel=(0,tp.sS)({visible:!1,pickable:!1,x:0,y:0}),this.columnResizeLabel.appendChild(E),this.columnResizeLabel.appendChild(P),this.rowResizeLine=(0,tu.W)({visible:!1,pickable:!1,stroke:x,lineWidth:C,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.rowResizeBgLine=(0,tu.W)({visible:!1,pickable:!1,stroke:w,lineWidth:S,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});let I=(0,td.r)({visible:!1,pickable:!1,x:0,y:0,fontSize:k,fill:M,fontFamily:T,text:"",textBaseline:"top",dx:16,dy:-k/2}),L=(0,tc.f)({visible:!1,pickable:!1,fill:R,x:0,y:0,width:5*k*.8,height:k+8,cornerRadius:B,dx:12,dy:-k/2-4});this.rowResizeLabel=(0,tp.sS)({visible:!1,pickable:!1,x:0,y:0}),this.rowResizeLabel.appendChild(L),this.rowResizeLabel.appendChild(I),this.cellMover=new tw(this.table);let F=null==(p=null==(c=_.frozenColumnLine)?void 0:c.shadow)?void 0:p.width,O=null==(f=null==(g=_.frozenColumnLine)?void 0:g.shadow)?void 0:f.startColor,D=null==(y=null==(m=_.frozenColumnLine)?void 0:m.shadow)?void 0:y.endColor,H=null==(b=null==(v=_.frozenColumnLine)?void 0:v.shadow)?void 0:b.visible;this.frozenShadowLine=(0,tc.f)({visible:"always"===H,pickable:!1,x:0,y:0,width:F,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:O,offset:0},{color:D,offset:1}]}}),this.rightFrozenShadowLine=(0,tc.f)({visible:"always"===H,pickable:!1,x:0,y:0,width:F,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:D,offset:0},{color:O,offset:1}]}}),this.menu=new tv(this.table),this.drillIcon=new tx}addToGroup(t){t.addChild(this.frozenShadowLine),t.addChild(this.rightFrozenShadowLine),t.addChild(this.columnResizeBgLine),t.addChild(this.columnResizeLine),t.addChild(this.columnResizeLabel),t.addChild(this.rowResizeBgLine),t.addChild(this.rowResizeLine),t.addChild(this.rowResizeLabel),this.table.theme.scrollStyle.hoverOn&&!this.table.theme.scrollStyle.barToSide?(t.addChild(this.hScrollBar),t.addChild(this.vScrollBar)):(t.stage.defaultLayer.addChild(this.hScrollBar),t.stage.defaultLayer.addChild(this.vScrollBar)),this.menu.bindTableComponent(t),this.drillIcon.appand(t),this.cellMover.appand(t)}createScrollBar(){var t,e,i,r,n,s;let l,a=this.table.theme,o=null==(t=a.scrollStyle)?void 0:t.scrollRailColor,h=null==(e=a.scrollStyle)?void 0:e.scrollSliderColor,u=null==(i=a.scrollStyle)?void 0:i.scrollSliderCornerRadius,d=null==(r=a.scrollStyle)?void 0:r.width,c=null==(n=a.scrollStyle)?void 0:n.horizontalPadding,p=null==(s=a.scrollStyle)?void 0:s.verticalPadding;l=(0,y.Z)(u)?{cornerRadius:u,fill:h}:{fill:h},this.hScrollBar=new tg.B({direction:"horizontal",x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:this.table.tableNoFrameWidth,height:d,padding:c,railStyle:{fill:o},sliderStyle:l,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new tg.B({direction:"vertical",x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:d,height:this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight(),padding:p,railStyle:{fill:o},sliderStyle:l,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}updateScrollBar(){var t,e,i,r,n,s,l,a,o;let h=this.table.stateManager.scroll.horizontalBarPos,u=this.table.stateManager.scroll.verticalBarPos,d=this.table.theme,c=null==(t=d.scrollStyle)?void 0:t.width,p=null==(e=d.scrollStyle)?void 0:e.visible,g=null!=(r=null==(i=d.scrollStyle)?void 0:i.horizontalVisible)?r:p,f=null!=(s=null==(n=d.scrollStyle)?void 0:n.verticalVisible)?s:p,m=Math.ceil(this.table.tableNoFrameWidth),y=Math.ceil(this.table.tableNoFrameHeight),v=this.table.getAllRowsHeight(),b=this.table.getAllColsWidth(),_=this.table.getFrozenRowsHeight(),x=this.table.getFrozenColsWidth(),C=this.table.getBottomFrozenRowsHeight(),w=this.table.getRightFrozenColsWidth(),S=this.table.theme.scrollStyle.hoverOn,A=+(null!=(l=this.table.options.customConfig)&&!!l._disableColumnAndRowSizeRound);if(b>m+A){let t=Math.min(y,v),e=Math.max(.05,(m-x)/(b-x)),i=0;i=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameHeight-(S?c:-this.table.scenegraph.tableGroup.attribute.y)+this.table.tableY:t-(S?c:-this.table.scenegraph.tableGroup.attribute.y);let r=x+(S?0:this.table.scenegraph.tableGroup.attribute.x),n=m-x-w;null!=(o=null==(a=this.table.theme.scrollStyle)?void 0:a.ignoreFrozenCols)&&o?(r=S?0:this.table.scenegraph.tableGroup.attribute.x,n=m):(r=x+(S?0:this.table.scenegraph.tableGroup.attribute.x),n=m-x-w),this.hScrollBar.setAttributes({x:r,y:i,width:n,range:[0,e],visible:"always"===g});let s=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:s.x1,y:s.y1},"always"===g&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:0,visible:!1});if(v>y+A){let t=Math.min(m,b),e=Math.max(.05,(y-_)/(v-_)),i=0;i=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameWidth-(S?c:-this.table.scenegraph.tableGroup.attribute.x)+this.table.tableX:t-(S?c:-this.table.scenegraph.tableGroup.attribute.x),this.vScrollBar.setAttributes({x:i,y:_+(S?0:this.table.scenegraph.tableGroup.attribute.y),height:y-_-C,range:[0,e],visible:"always"===f});let r=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:r.x1,y:r.y1},"always"===f&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),height:0,visible:!1});this.table.stateManager.setScrollLeft(h),this.table.stateManager.setScrollTop(u)}hideResizeCol(){this.columnResizeLine.setAttribute("visible",!1),this.columnResizeBgLine.setAttribute("visible",!1),this.columnResizeLabel.setAttribute("visible",!1),this.columnResizeLabel.hideAll()}showResizeCol(t,e,i){let r=tS(t,this.table,i);this.columnResizeLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.showAll(),this.columnResizeLabel.setAttributes({visible:!0,x:r,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${this.table.getColWidth(t)}px`))}updateResizeCol(t,e,i){let r=tS(t,this.table,i);this.columnResizeLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.setAttributes({x:r,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getColWidth(t))}px`))}hideResizeRow(){this.rowResizeLine.setAttribute("visible",!1),this.rowResizeBgLine.setAttribute("visible",!1),this.rowResizeLabel.setAttribute("visible",!1),this.rowResizeLabel.hideAll()}showResizeRow(t,e,i){let r=tA(t,this.table,i);this.rowResizeLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.showAll(),this.rowResizeLabel.setAttributes({visible:!0,y:r,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${this.table.getRowHeight(t)}px`))}updateResizeRow(t,e,i){let r=tA(t,this.table,i);this.rowResizeLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.setAttributes({y:r,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getRowHeight(t))}px`))}hideMoveCol(){this.cellMover.hide()}showMoveCol(t,e,i){return this.cellMover.show(t,e,i)}updateMoveCol(t,e,i,r){this.cellMover.update(t,e,i,r)}setFrozenColumnShadow(t,e){var i,r;let n=tS(t,this.table,e);t<0||"always"!==(null==(r=null==(i=this.table.theme.frozenColumnLine)?void 0:i.shadow)?void 0:r.visible)?this.frozenShadowLine.setAttributes({visible:!1,x:n,height:this.table.getDrawRange().height}):this.frozenShadowLine.setAttributes({visible:!0,x:n,height:this.table.getDrawRange().height})}setRightFrozenColumnShadow(t){var e,i;let r=tS(t,this.table,!0);t>=this.table.colCount||"always"!==(null==(i=null==(e=this.table.theme.frozenColumnLine)?void 0:e.shadow)?void 0:i.visible)?this.rightFrozenShadowLine.setAttributes({visible:!1,x:r-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height}):this.rightFrozenShadowLine.setAttributes({visible:!0,x:r-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height})}hideFrozenColumnShadow(){var t,e,i,r,n;let s=null==(e=null==(t=this.table.theme.frozenColumnLine)?void 0:t.shadow)?void 0:e.visible;"scrolling"===(null!=(n=null==(r=null==(i=this.table.theme.frozenColumnLine)?void 0:i.shadow)?void 0:r.visible)?n:s)&&(this.frozenShadowLine.setAttribute("visible",!1),this.rightFrozenShadowLine.setAttribute("visible",!1),this.table.scenegraph.updateNextFrame())}showFrozenColumnShadow(){var t,e,i,r,n;let s=null==(e=null==(t=this.table.theme.frozenColumnLine)?void 0:t.shadow)?void 0:e.visible;"scrolling"===(null!=(n=null==(r=null==(i=this.table.theme.frozenColumnLine)?void 0:i.shadow)?void 0:r.visible)?n:s)&&(this.frozenShadowLine.setAttribute("visible",!0),this.rightFrozenShadowLine.setAttribute("visible",!0),this.table.scenegraph.updateNextFrame())}hideVerticalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,i=null!=(t=this.table.theme.scrollStyle.verticalVisible)?t:e;"focus"!==i&&"scrolling"!==i||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showVerticalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,i=null!=(t=this.table.theme.scrollStyle.verticalVisible)?t:e;"focus"!==i&&"scrolling"!==i||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}hideHorizontalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,i=null!=(t=this.table.theme.scrollStyle.horizontalVisible)?t:e;"focus"!==i&&"scrolling"!==i||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showHorizontalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,i=null!=(t=this.table.theme.scrollStyle.horizontalVisible)?t:e;"focus"!==i&&"scrolling"!==i||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}updateVerticalScrollBarPos(t){let e=this.vScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.vScrollBar.setAttribute("range",[r,r+i]);let n=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:n.x1,y:n.y1}}updateHorizontalScrollBarPos(t){let e=this.hScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.hScrollBar.setAttribute("range",[r,r+i]);let n=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:n.x1,y:n.y1}}updateStyle(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,v,b,_,x,C,w;let S,A=this.table.theme,M=null==(t=A.scrollStyle)?void 0:t.scrollRailColor,k=null==(e=A.scrollStyle)?void 0:e.scrollSliderColor,T=null==(i=A.scrollStyle)?void 0:i.scrollSliderCornerRadius,R=null==(r=A.scrollStyle)?void 0:r.width,B=null==(n=A.scrollStyle)?void 0:n.horizontalPadding,P=null==(s=A.scrollStyle)?void 0:s.verticalPadding;S=(0,y.Z)(T)?{cornerRadius:T,fill:k}:{fill:k},this.hScrollBar.setAttributes({height:R,padding:B,railStyle:{fill:M},sliderStyle:S}),this.vScrollBar.setAttributes({width:R,padding:P,railStyle:{fill:M},sliderStyle:S});let E=null==(l=A.columnResize)?void 0:l.lineColor,I=null==(a=A.columnResize)?void 0:a.lineWidth,L=null==(o=A.columnResize)?void 0:o.bgColor,F=null==(h=A.columnResize)?void 0:h.width;this.columnResizeLine.setAttributes({stroke:E,lineWidth:I}),this.columnResizeBgLine=(0,tu.W)({stroke:L,lineWidth:F});let O=null==(u=A.columnResize)?void 0:u.labelColor,D=null==(d=A.columnResize)?void 0:d.labelFontSize,H=null==(c=A.columnResize)?void 0:c.labelFontFamily,z=null==(p=A.columnResize)?void 0:p.labelBackgroundFill,W=null==(g=A.columnResize)?void 0:g.labelBackgroundCornerRadius,N=null==(m=null==(f=A.columnResize)?void 0:f.labelVisible)||m;this.labelVisible=N,this.columnResizeLabel.lastChild.setAttributes({fontSize:D,fill:O,fontFamily:H,dy:-D/2}),this.columnResizeLabel.firstChild.setAttributes({fill:z,width:5*D*.8,height:D+8,cornerRadius:W,dy:-D/2-4}),this.rowResizeLabel.lastChild.setAttributes({fontSize:D,fill:O,fontFamily:H,dy:-D/2}),this.rowResizeLabel.firstChild.setAttributes({fill:z,width:5*D*.8,height:D+8,cornerRadius:W,dy:-D/2-4});let j=null==(b=null==(v=A.frozenColumnLine)?void 0:v.shadow)?void 0:b.width,G=null==(x=null==(_=A.frozenColumnLine)?void 0:_.shadow)?void 0:x.startColor,V=null==(w=null==(C=A.frozenColumnLine)?void 0:C.shadow)?void 0:w.endColor;this.frozenShadowLine.setAttributes({width:j,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:G,offset:0},{color:V,offset:1}]}}),this.rightFrozenShadowLine.setAttributes({width:j,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:V,offset:0},{color:G,offset:1}]}}),this.cellMover.updateStyle()}}var tk=i(43735);function tT(t,e,i,r,n){var s,l,a,o,h,u;if(!e)return;let d="table"===i,{shadowBlur:c,shadowOffsetX:p,shadowOffsetY:g,shadowColor:f,cornerRadius:m,borderColor:y,borderLineWidth:v,borderLineDash:b}=e,_=!1,x={},C={pickable:!1};c&&d&&(C.shadowBlur=c,C.shadowOffsetX=p,C.shadowOffsetY=g,C.shadowColor=f,C.stroke=!0,C.stroke=f,C.lineWidth=1,_=!0),v&&(C.stroke=!0,C.fill=!1,C.stroke=tB(null!=y?y:"#E1E4E8",r,v),C.lineWidth=v,b&&(C.lineDash=b),C.lineCap="butt"),Array.isArray(y)&&(C.strokeArrayColor=(0,J.u)(y)),Array.isArray(v)&&(C.strokeArrayWidth=(0,J.u)(v),C.lineWidth=1),m&&(C.cornerRadius=m,x.cornerRadius=m);let w=C.strokeArrayWidth?C.strokeArrayWidth[0]:null!=(s=C.lineWidth)?s:0,S=C.strokeArrayWidth?C.strokeArrayWidth[1]:null!=(l=C.lineWidth)?l:0,A=C.strokeArrayWidth?C.strokeArrayWidth[2]:null!=(a=C.lineWidth)?a:0,M=C.strokeArrayWidth?C.strokeArrayWidth[3]:null!=(o=C.lineWidth)?o:0;if(t.setAttributes(x),!n)if(C.stroke)if(C.x=M/2,C.y=w/2,C.pickable=!1,d){let i,r;if(m)if(Array.isArray(m)){let t=(0,J.u)(m);C.cornerRadius=t,x.cornerRadius=t,t[0]&&(t[0]=t[0]+Math.min(M,w)/2),t[1]&&(t[1]=t[1]+Math.min(w,S)/2),t[2]&&(t[2]=t[2]+Math.min(S,A)/2),t[3]&&(t[3]=t[3]+Math.min(A,M)/2)}else if((0,tk.Z)(v)){let t=[];C.cornerRadius=t,x.cornerRadius=t,t[0]=m+Math.min(M,w)/2,t[1]=m+Math.min(w,S)/2,t[2]=m+Math.min(S,A)/2,t[3]=m+Math.min(A,M)/2}else C.cornerRadius=m+(null!=(h=C.lineWidth)?h:0)/2,x.cornerRadius=m+(null!=(u=C.lineWidth)?u:0)/2;if(e.innerBorder?(C.x=t.attribute.x+M/2,C.y=t.attribute.y+w/2,C.width=t.attribute.width-M/2-S/2,C.height=t.attribute.height-w/2-A/2):(C.x=t.attribute.x-M/2,C.y=t.attribute.y-w/2,C.width=t.attribute.width+M/2+S/2,C.height=t.attribute.height+w/2+A/2),_){C.fill="white",C.notAdjustPos=!0,(r=(0,tp.sS)(C)).name="table-border-rect",i=(0,tc.f)({x:M/2,y:w/2,width:t.attribute.width,height:t.attribute.height,fill:"red",cornerRadius:t.attribute.cornerRadius,globalCompositeOperation:"destination-out"}),r.addChild(i);let e=(0,tc.f)({x:M/2,y:w/2,width:t.attribute.width,height:t.attribute.height,fill:"transparent",pickable:!1,globalCompositeOperation:"source-over"});r.addChild(e)}else(r=(0,tc.f)(C)).name="table-border-rect";e.innerBorder&&!_?t.parent.insertAfter(r,t):t.parent.insertBefore(r,t),t.border=r}else{C.width=t.attribute.width-M/2-S/2,C.height=t.attribute.height-w/2-A/2;let e=(0,tc.f)(C);e.name="border-rect",t.addChild(e),t.border=e}else{let e=(0,tc.f)({fill:!1,stroke:!1,pickable:!1,lineWidth:0});e.name="border-rect",t.addChild(e),t.border=e}}function tR(t,e,i){var r;if(!e)return;let{borderColor:n}=e;null==(r=t.border)||r.setAttribute("stroke",tB(n,i))}function tB(t,e,i){let r=!0;return!e&&!(0,tk.Z)(i)||(0,tk.Z)(t)?e?r=e:e||(0,tk.Z)(t)?(0,tk.Z)(t)&&(r=!0):r=t:r=(null!=e?e:i).map(e=>!!e&&t),r}function tP(t){var e,i,r,n;if(!t.border)return;let s=t.border.attribute.strokeArrayWidth?t.border.attribute.strokeArrayWidth[0]:null!=(e=t.border.attribute.lineWidth)?e:0,l=t.border.attribute.strokeArrayWidth?t.border.attribute.strokeArrayWidth[1]:null!=(i=t.border.attribute.lineWidth)?i:0,a=t.border.attribute.strokeArrayWidth?t.border.attribute.strokeArrayWidth[2]:null!=(r=t.border.attribute.lineWidth)?r:0,o=t.border.attribute.strokeArrayWidth?t.border.attribute.strokeArrayWidth[3]:null!=(n=t.border.attribute.lineWidth)?n:0;t.border.setAttributes({borderLeft:o,borderTop:s,borderRight:l,borderBottom:a,width:t.attribute.width-o/2-l/2,height:t.attribute.height-s/2-a/2}),"group"===t.border.type&&t.border.firstChild.setAttributes({width:t.attribute.width,height:t.attribute.height})}function tE(t,e){t.setAttribute("cornerRadius",e),t.border&&t.border.setAttribute("cornerRadius",e)}var tI=i(99262),tL=i(58276),tF=i(879),tO=i(28856),tD=i(47012),tH=i(12687),tz=i(34688),tW=i(4062),tN=i(26004),tj=i(55634),tG=i(79809);let tV=Symbol.for("ChartRender");Symbol.for("ChartRenderContribution");let tZ=class extends tz.Y{constructor(){super(...arguments),this.numberType=tj.e}drawShape(t,e,i,r,n,s,l,a){var o,h,u,d;let c=(0,tW.gh)(t,null==s?void 0:s.theme).group,{dataId:p,data:g,spec:f}=t.attribute,{width:m=c.width,height:y=c.height}=(t.getViewBox(),t.attribute),{table:v}=t.getRootNode(),{active:b,cacheCanvas:_,activeChartInstance:x}=t;if(!b&&_)(0,tk.Z)(_)?_.forEach(t=>{let{x:i,y:r,width:n,height:s,canvas:l}=t;e.drawImage(l,i,r,n,s)}):e.drawImage(_,i,r,m,y);else if(x){if(v.options.specFormat){let e=v.options.specFormat(t.attribute.spec,x,t);if(e.needFormatSpec&&e.spec){let t=e.spec;x.updateSpecSync(t,!1,{reuse:!1,morph:!1})}}let e=t.getViewBox();x.updateViewBox({x1:0,x2:e.x2-e.x1,y1:0,y2:e.y2-e.y1},!1,!1);let i=x.getStage();i.needRender=!0;let r=t.globalTransMatrix.clone(),n=t.stage.window.getViewBoxTransform().clone();if(n.multiply(r.a,r.b,r.c,r.d,r.e,r.f),i.window.setViewBoxTransform(n.a,n.b,n.c,n.d,n.e,n.f),"string"==typeof p)x.updateDataSync(p,null!=g?g:[]);else{let t=[];for(let e in p){let i=p[e],r=f.series.find(t=>{var i;return(null==(i=null==t?void 0:t.data)?void 0:i.id)===e});t.push({id:e,values:i?null!=(o=null==g?void 0:g.filter(t=>t.hasOwnProperty(i)))?o:[]:null!=g?g:[],fields:null==(h=null==r?void 0:r.data)?void 0:h.fields}),x.updateFullDataSync||x.updateDataSync(e,i?null!=(u=null==g?void 0:g.filter(t=>t.hasOwnProperty(i)))?u:[]:null!=g?g:[])}null==(d=x.updateFullDataSync)||d.call(x,t)}}else v.internalProps.renderChartAsync?(-1===tG.A8.indexOf(`${t.parent.col}+${t.parent.row}`)&&(tG.A8.push(`${t.parent.col}+${t.parent.row}`),tG.LO.push(t)),(0,tG.a5)()||(0,tG.eO)(v)):(0,tG.pF)(t)}draw(t,e,i,r){this._draw(t,{},!1,i,r)}};tZ=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,tN.b)()],tZ);var tU=i(17209),tK=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l};let t$=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{shape:p}=t.attribute;if("circle"===p){let{width:n=o.width,height:s=o.height}=t.attribute;e.beginPath(),e.arc(i+n/2,r+s/2,Math.min(n,s)/2,0,2*Math.PI),e.closePath(),e.save(),e.clip()}}};t$=tK([(0,tN.b)()],t$);let tY=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{shape:p}=t.attribute;"circle"===p&&e.restore()}};tY=tK([(0,tN.b)()],tY);let tX=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{isGif:p}=t.attribute;p&&t.playing&&(t.attribute.opacity=0)}};tX=tK([(0,tN.b)()],tX);let tq=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{isGif:p}=t.attribute;p&&t.playing&&(t.attribute.opacity=1,e.globalAlpha=t.attribute.opacity,t.renderFrame(e,i,r))}};tq=tK([(0,tN.b)()],tq);var tJ=i(2844),tQ=i(13222);function t0(t,e,i,r){var n;let s,{highlightInRange:l,disableHeader:a,ranges:o}=t.select,h=1===o.length&&((n=null==o?void 0:o[0]).start.col!==n.end.col||n.start.row!==n.end.row)&&l;if(h?1===(null==o?void 0:o.length)&&o[0].start&&o[0].end:1===(null==o?void 0:o.length)&&o[0].end.col===o[0].start.col&&o[0].end.row===o[0].start.row){if(t.table.isHeader(e,i)&&a)return;(s=h?function(t,e,i){let r,{highlightScope:n,cellPos:s,ranges:l}=t.select,a=l[0],o=Math.min(a.start.col,a.end.col),h=Math.max(a.start.col,a.end.col),u=Math.min(a.start.row,a.end.row),d=Math.max(a.start.row,a.end.row);return n===B.p.single&&s.col===e&&s.row===i?r="cellBgColor":n===B.p.column&&e>=o&&e<=h?r=(0,P._Z)(l[0],e,i)?"cellBgColor":"inlineColumnBgColor":n===B.p.row&&i>=u&&i<=d?r=(0,P._Z)(l[0],e,i)?"cellBgColor":"inlineRowBgColor":n===B.p.cross&&((0,P._Z)(l[0],e,i)?r="cellBgColor":e>=o&&e<=h?r="inlineColumnBgColor":i>=u&&i<=d&&(r="inlineRowBgColor")),r}(t,e,i):function(t,e,i){let r,{highlightScope:n,cellPos:s}=t.select;return n===B.p.single&&s.col===e&&s.row===i?r="cellBgColor":n===B.p.column&&s.col===e?r=s.col===e&&s.row===i?"cellBgColor":"inlineColumnBgColor":n===B.p.row&&s.row===i?r=s.col===e&&s.row===i?"cellBgColor":"inlineRowBgColor":n===B.p.cross&&(s.col===e&&s.row===i?r="cellBgColor":s.col===e?r="inlineColumnBgColor":s.row===i&&(r="inlineRowBgColor")),r}(t,e,i))&&t1(t.table,e,i)&&(s=void 0)}else if("replace"===t.table.theme.selectionStyle.selectionFillMode)for(let t=0;t<o.length;t++){let r=o[t],n=Math.min(r.start.col,r.end.col),l=Math.max(r.start.col,r.end.col),a=Math.min(r.start.row,r.end.row),h=Math.max(r.start.row,r.end.row);if(n<=e&&a<=i&&l>=e&&h>=i){s="cellBgColor";break}}return s}function t1(t,e,i){var r,n;let s=null==(r=t.options.select)?void 0:r.disableSelect;if("function"==typeof s?s(e,i,t):s)return!0;if(t.isHeader(e,i)){let r=null==(n=t.options.select)?void 0:n.disableHeaderSelect;if(r)return!0;let s=t.getHeaderDefine(e,i);if(r=null==s?void 0:s.disableHeaderSelect)return!0}else{let r=t.getBodyColumnDefine(e,i),n=null==r?void 0:r.disableSelect;if("function"==typeof n?n(e,i,t):n)return!0}return!1}var t2=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l};let t3=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{stroke:p=o.stroke,strokeArrayWidth:g=o.strokeArrayWidth,strokeArrayColor:f=o.strokeArrayColor}=t.attribute;p&&(Array.isArray(g)||Array.isArray(f))&&(c.doStroke=!1)}};t3=t2([(0,tN.b)()],t3);let t5=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){var c,p;let{stroke:g=o.stroke,strokeArrayColor:f=o.strokeArrayColor,strokeArrayWidth:m=o.strokeArrayWidth,lineWidth:y=o.lineWidth,strokeColor:v=o.stroke,cornerRadius:b=o.cornerRadius}=t.attribute,_,x,{width:C=o.width,height:w=o.height}=t.attribute;if(g&&(Array.isArray(m)||0!==y)&&(Array.isArray(f)||Array.isArray(m))){if("number"==typeof y&&1&y||Array.isArray(m)&&m.some(t=>1&t)){let e=t.stage.table;if(!e)return;let n="bottom-right"===(null==(c=null==e?void 0:e.theme)?void 0:c.cellBorderClipDirection);if(n){if(i=Math.floor(i)-.5,r=Math.floor(r)-.5,"cell"===t.role){let e=t.col,n=t.row;0===e&&(i+=1),0===n&&(r+=1)}}else i=Math.floor(i)+.5,r=Math.floor(r)+.5;(null==(p=e.options.customConfig)?void 0:p._disableColumnAndRowSizeRound)&&(C=Math.round(C),w=Math.round(w));let{width:s,height:l}=es(t,Math.ceil(C),Math.ceil(w),n);_=s,x=l}else _=Math.ceil(C),x=Math.ceil(w);0===b||(0,tk.Z)(b)&&b.every(t=>0===t)?t6(t,e,i,r,o,g,m||y,f||v,_,x):(e.beginPath(),(0,tJ.U)(e,i,r,_,x,b,!0,[,,,,].fill(0).map((n,s)=>(n,l,a,h)=>{eh(s,n,l,a,h,t,e,i,r,o,g,m||y,f||v,_,x)})),e.stroke())}}};function t4(t){let e;if(!Array.isArray(t))return{isSplitDraw:!1,width:t};for(let i=0;i<t.length;i++){let r=t[i];if(r)if(e){if(r!==e)return{isSplitDraw:!0}}else e=r}return{isSplitDraw:!1,width:e}}function t6(t,e,i,r,n,s,l,a,o,h,u,d){var c,p,g,f;let m=t4(l),y=!Array.isArray(l),v=!Array.isArray(s),b=Array.isArray(d),_=Array.isArray(a)||m.isSplitDraw;e.setStrokeStyle(t,t.attribute,i,r,n);let{lineDash:x=n.lineDash}=t.attribute,C=!1;x.length&&x.some(t=>Array.isArray(t))&&(C=!0),e.beginPath(),e.moveTo(i,r);let w=(v||s[0])&&(y||l[0]),S=(v||s[1])&&(y||l[1]),A=(v||s[2])&&(y||l[2]),M=(v||s[3])&&(y||l[3]);if(w){let t=(y?m.width:l[0])/2,n=(y?m.width:l[0])/2;b&&Array.isArray(d[0])?(e.moveTo(i-t+(o+t+n)*d[0][0],r),e.lineTo(i-t+(o+t+n)*(d[0][1]-d[0][0]),r),e.moveTo(i+o+n,r)):(e.moveTo(i-t,r),e.lineTo(i+o+n,r)),(_||C)&&(a&&a[0]?e.strokeStyle=a[0]:a&&!a[0]&&(e.strokeStyle="transparent"),y||(e.lineWidth=l[0]),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,C&&e.setLineDash(null!=(c=x[0])?c:[]),e.stroke(),e.beginPath(),e.moveTo(i+o,r))}else e.moveTo(i+o,r);if(S){let t=(y?m.width:l[1])/2,n=(y?m.width:l[1])/2;b&&Array.isArray(d[1])?(e.moveTo(i+o,r-t+h*d[1][0]),e.lineTo(i+o,r-t+(h+t+n)*(d[1][1]-d[1][0])),e.moveTo(i+o,r+h+n)):(e.moveTo(i+o,r-t),e.lineTo(i+o,r+h+n)),(_||C)&&(a&&a[1]?e.strokeStyle=a[1]:a&&!a[1]&&(e.strokeStyle="transparent"),y||(e.lineWidth=l[1]),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,C&&e.setLineDash(null!=(p=x[1])?p:[]),e.stroke(),e.beginPath(),e.moveTo(i+o,r+h))}else e.moveTo(i+o,r+h);if(A){let t=(y?m.width:l[2])/2,n=(y?m.width:l[2])/2;b&&Array.isArray(d[2])?(e.moveTo(i-t+(o+t+n)*d[2][0],r+h),e.lineTo(i-t+(o+t+n)*(d[2][1]-d[2][0]),r+h),e.moveTo(i-t,r+h)):(e.moveTo(i-t,r+h),e.lineTo(i+o+n,r+h)),(_||C)&&(a&&a[2]?e.strokeStyle=a[2]:a&&!a[2]&&(e.strokeStyle="transparent"),y||(e.lineWidth=l[2]),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,C&&e.setLineDash(null!=(g=x[2])?g:[]),e.stroke(),e.beginPath(),e.moveTo(i,r+h))}else e.moveTo(i,r+h);if(M){let t=(y?m.width:l[3])/2,n=(y?m.width:l[3])/2;b&&Array.isArray(d[3])?(e.moveTo(i,r-t+(h+t+n)*d[3][0]),e.lineTo(i,r-t+(h+t+n)*(d[3][1]-d[3][0])),e.moveTo(i,r-t)):(e.moveTo(i,r-t),e.lineTo(i,r+h+n)),(_||C)&&(a&&a[3]?e.strokeStyle=a[3]:a&&!a[3]&&(e.strokeStyle="transparent"),y||(e.lineWidth=l[3]),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,C&&e.setLineDash(null!=(f=x[3])?f:[]),e.stroke(),e.beginPath(),e.moveTo(i,r))}else e.moveTo(i,r);_||C||(!y&&m.width&&(e.lineWidth=m.width),e.stroke()),e.lineDashOffset=0,e.setLineDash([])}t5=t2([(0,tN.b)()],t5);let t8=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){var p;let{lineDash:g=o.lineDash,stroke:f=o.stroke,strokeArrayColor:m=o.strokeArrayColor,strokeArrayWidth:y=o.strokeArrayWidth}=t.attribute;f&&Array.isArray(g)&&g.length&&(null==(p=g[0])?void 0:p.length)&&!Array.isArray(m)&&!Array.isArray(y)&&(c.doStroke=!1)}};t8=t2([(0,tN.b)()],t8);let t9=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){var c,p,g,f,m,y,v;let{lineDash:b=o.lineDash,stroke:_=o.stroke,strokeArrayColor:x=o.strokeArrayColor,strokeArrayWidth:C=o.strokeArrayWidth,lineWidth:w=o.lineWidth}=t.attribute;if(!_||!(Array.isArray(b)&&b.length&&(null==(c=b[0])?void 0:c.length))||Array.isArray(x)||Array.isArray(C))return;let S=t.stage.table;if(!S)return;let A=(0,tk.Z)(b[0])?1===(v=b).length?[v[0],v[0],v[0],v[0]]:2===v.length?[v[0],v[1],v[0],v[1]]:v:[b,b,b,b],M,k,{width:T=o.width,height:R=o.height}=t.attribute;if((null==(p=S.options.customConfig)?void 0:p._disableColumnAndRowSizeRound)?(T=Math.round(T),R=Math.round(R)):(T=Math.ceil(T),R=Math.ceil(R)),1&w){let e="bottom-right"===S.theme.cellBorderClipDirection;e?(i=Math.floor(i)-.5,r=Math.floor(r)-.5,"cell"===t.role&&(0===t.col&&(i+=1),0===t.row&&(r+=1))):(i=Math.floor(i)+.5,r=Math.floor(r)+.5);let{width:n,height:s}=es(t,Math.ceil(T+0),Math.ceil(R+0),e);M=n,k=s}else M=Math.ceil(T),k=Math.ceil(R);e.setStrokeStyle(t,t.attribute,i,r,o),e.beginPath(),e.moveTo(i,r),e.lineTo(i+M,r),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,e.setLineDash(null!=(g=A[0])?g:[]),e.stroke(),e.beginPath(),e.moveTo(i+M,r),e.lineTo(i+M,r+k),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,e.setLineDash(null!=(f=A[1])?f:[]),e.stroke(),e.beginPath(),e.moveTo(i,r+k),e.lineTo(i+M,r+k),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,e.setLineDash(null!=(m=A[2])?m:[]),e.stroke(),e.beginPath(),e.moveTo(i,r),e.lineTo(i,r+k),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,e.setLineDash(null!=(y=A[3])?y:[]),e.stroke(),e.lineDashOffset=0,e.setLineDash([])}};t9=t2([(0,tN.b)()],t9);let t7=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{lineWidth:p=o.lineWidth,stroke:g=o.stroke,lineDash:f=o.lineDash,strokeArrayWidth:m=o.strokeArrayWidth,strokeArrayColor:y=o.strokeArrayColor,notAdjustPos:v}=t.attribute;!0!==v&&g&&Array.isArray(f)&&!f.length&&!Array.isArray(y)&&!Array.isArray(m)&&1&p&&(c.doStroke=!1)}};t7=t2([(0,tN.b)()],t7);let et=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){var c,p;let{lineWidth:g=o.lineWidth,stroke:f=o.stroke,lineDash:m=o.lineDash,strokeArrayWidth:y=o.strokeArrayWidth,strokeArrayColor:v=o.strokeArrayColor,notAdjustPos:b,cornerRadius:_=o.cornerRadius}=t.attribute,{width:x=o.width,height:C=o.height}=t.attribute;if(!0!==b&&f&&Array.isArray(m)&&!m.length&&!Array.isArray(v)&&!Array.isArray(y)&&1&g){let n=t.stage.table;if(!n)return;(null==(c=n.options.customConfig)?void 0:c._disableColumnAndRowSizeRound)&&(x=Math.round(x),C=Math.round(C)),e.beginPath();let s="bottom-right"===(null==(p=null==n?void 0:n.theme)?void 0:p.cellBorderClipDirection);s?(i=Math.floor(i)-.5,r=Math.floor(r)-.5,"cell"===t.role&&(0===t.col&&(i+=1),0===t.row&&(r+=1))):(i=Math.floor(i)+.5,r=Math.floor(r)+.5);let{width:l,height:a}=es(t,Math.ceil(x),Math.ceil(C),s);_?(0,tJ.U)(e,i,r,l+0,a+0,_):e.rect(i,r,l,a),e.setStrokeStyle(t,t.attribute,i,r,o),e.stroke()}}};et=t2([(0,tN.b)()],et);let ee=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){if("cell"===t.role){let e=t.stage.table;if(e){let i=function(t,e){var i,r,n,s,l,a,o,h,u,d,c;let p,g;if("cell"===t.role&&(0,y.Z)(t.mergeStartCol)&&(0,y.Z)(t.mergeStartRow)&&(0,y.Z)(t.mergeEndCol)&&(0,y.Z)(t.mergeEndRow)){let{colStart:i,colEnd:r,rowStart:n,rowEnd:s}=(0,ti.e)(t,e.scenegraph);for(let l=i;l<=r;l++)for(let i=n;i<=s;i++){let r=t0(e.stateManager,l,i,t);!r||p&&"cellBgColor"!==r||(p=r)}}else"cell"===t.role&&(p=t0(e.stateManager,t.col,t.row,t));if(!p)return;let f=e.internalProps.layoutMap;return f.isCornerHeader(t.col,t.row)?g=(null==(i=e.theme.cornerHeaderStyle)?void 0:i.select)||(null==(r=e.theme.headerStyle)?void 0:r.select):f.isColumnHeader(t.col,t.row)?g=null==(n=e.theme.headerStyle)?void 0:n.select:f.isRowHeader(t.col,t.row)?g=null==(s=e.theme.rowHeaderStyle)?void 0:s.select:f.isBottomFrozenRow(t.col,t.row)?g=(null==(l=e.theme.bottomFrozenStyle)?void 0:l.select)||(e.isListTable()?null==(a=e.theme.bodyStyle)?void 0:a.select:null==(o=e.theme.headerStyle)?void 0:o.select):f.isRightFrozenColumn(t.col,t.row)?g=(null==(h=e.theme.rightFrozenStyle)?void 0:h.select)||(e.isListTable()?null==(u=e.theme.bodyStyle)?void 0:u.select:null==(d=e.theme.rowHeaderStyle)?void 0:d.select):e.isHeader(t.col,t.row)||(g=null==(c=e.theme.bodyStyle)?void 0:c.select),(0,Y.WJ)(p,g,t.col,t.row,e)}(t,e);if(i)t.attribute._vtableHightLightFill=i;else if(e.stateManager.interactionState!==B.F.scrolling){let i=(0,tQ.J)(t,e);i&&(t.attribute._vtableHightLightFill=i)}}}}};ee=t2([(0,tN.b)()],ee);let ei=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){if(t.attribute._vtableHightLightFill){if(u);else if(l){let n=t.attribute.fill;t.attribute.fill=t.attribute._vtableHightLightFill,e.setCommonStyle(t,t.attribute,i,r,o),e.fill(),t.attribute.fill=n,t.attribute._vtableHightLightFill=void 0}}}};ei=t2([(0,tN.b)()],ei);let er=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){var p,g,f,m,y,v;let b=t.stage.table;b&&("body"===t.role?en(e,-(null!=(p=t.attribute.x)?p:0)+b.getFrozenColsWidth(),-(null!=(g=t.attribute.y)?g:0)+b.getFrozenRowsHeight(),t.parent.attribute.width-b.getFrozenColsWidth()-b.getRightFrozenColsWidth(),t.parent.attribute.height-b.getFrozenRowsHeight()-b.getBottomFrozenRowsHeight()):"row-header"===t.role?en(e,0,-(null!=(f=t.attribute.y)?f:0)+b.getFrozenRowsHeight(),b.getFrozenColsWidth(),t.parent.attribute.height-b.getFrozenRowsHeight()-b.getBottomFrozenRowsHeight()):"col-header"===t.role?en(e,-(null!=(m=t.attribute.x)?m:0)+b.getFrozenColsWidth(),0,t.parent.attribute.width-b.getFrozenColsWidth()-b.getRightFrozenColsWidth(),b.getFrozenRowsHeight()):"right-frozen"===t.role?en(e,0,-(null!=(y=t.attribute.y)?y:0)+b.getFrozenRowsHeight(),b.getRightFrozenColsWidth(),t.parent.attribute.height-b.getFrozenRowsHeight()-b.getBottomFrozenRowsHeight()):"bottom-frozen"===t.role?en(e,-(null!=(v=t.attribute.x)?v:0)+b.getFrozenColsWidth(),0,t.parent.attribute.width-b.getFrozenColsWidth()-b.getRightFrozenColsWidth(),b.getBottomFrozenRowsHeight()):"corner-header"===t.role?en(e,0,0,b.getFrozenColsWidth(),b.getFrozenRowsHeight()):"corner-right-top-header"===t.role?en(e,0,0,b.getRightFrozenColsWidth(),b.getFrozenRowsHeight()):"corner-right-bottom-header"===t.role?en(e,0,0,b.getRightFrozenColsWidth(),b.getBottomFrozenRowsHeight()):"corner-left-bottom-header"===t.role&&en(e,0,0,b.getFrozenColsWidth(),b.getBottomFrozenRowsHeight()))}};function en(t,e,i,r,n){t.beginPath();let s=t.applyedMatrix;Math.abs(s.f)>0x1000000||Math.abs(s.g)>0x1000000?t.rect(e-0x1000000,i-0x1000000,r+0x2000000,n+0x2000000):t.rect(e,i,r,n)}function es(t,e,i,r){var n,s;let l=t.stage.table;if(!l)return{width:e,height:i};if("cell"===t.role){let a=t.col,o=t.row,h=(0,G.Z)(l,a,o);h&&(a=h.end.col,o=h.end.row),r?(0===a&&(e-=1),0===o&&(i-=1)):((a===l.colCount-1||a===l.frozenColCount-1&&l.scrollLeft||(null==(n=l.containerFit)?void 0:n.width)&&l.rightFrozenColCount&&a===l.colCount-l.rightFrozenColCount-1)&&(e-=1),(o===l.rowCount-1||o===l.frozenRowCount-1&&l.scrollTop||(null==(s=l.containerFit)?void 0:s.height)&&l.bottomFrozenRowCount&&o===l.rowCount-l.bottomFrozenRowCount-1)&&(i-=1))}else"corner-frozen"===t.role&&(l.scrollLeft&&!r&&(e-=1),l.scrollTop&&!r&&(i-=1));return{width:e,height:i}}er=t2([(0,tN.b)()],er);var el=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l};let ea=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){let{stroke:p=o.stroke,strokeArrayWidth:g=o.strokeArrayWidth,strokeArrayColor:f=o.strokeArrayColor}=t.attribute;p&&(Array.isArray(p)||Array.isArray(g)||Array.isArray(f))&&(c.doStroke=!1)}};ea=el([(0,tN.b)()],ea);let eo=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d){let{width:c=o.width,height:p=o.height,stroke:g=o.stroke,strokeArrayColor:f=o.strokeArrayColor,strokeArrayWidth:m=o.strokeArrayWidth,lineWidth:y=o.lineWidth,strokeColor:v=o.stroke,cornerRadius:b=o.cornerRadius}=t.attribute;g&&(Array.isArray(m)||0!==y)&&(Array.isArray(g)||Array.isArray(f)||Array.isArray(m))&&("border-rect"!==t.name&&"table-border-rect"!==t.name&&("number"==typeof y&&1&y||Array.isArray(m)&&m.some(t=>1&t))&&(i=Math.floor(i)+.5,r=Math.floor(r)+.5),0===b||(0,tk.Z)(b)&&b.every(t=>0===t)?t6(t,e,i,r,o,g,m||y,f||v,"table-border-rect"!==t.name?Math.ceil(c+0):c+0,"table-border-rect"!==t.name?Math.ceil(p+0):p+0):(e.beginPath(),(0,tJ.U)(e,i,r,c,p,b,!0,[,,,,].fill(0).map((n,s)=>(n,l,a,h)=>{eh(s,n,l,a,h,t,e,i,r,o,g,m||y,f||v,Math.ceil(c+0),Math.ceil(p+0))})),e.stroke()))}};function eh(t,e,i,r,n,s,l,a,o,h,u,d,c,p,g){var f,m,y,v;let b=t4(d),_=!Array.isArray(d),x=!Array.isArray(u),C=Array.isArray(c)||b.isSplitDraw;l.stroke(),l.setStrokeStyle(s,s.attribute,a,o,h);let{lineDash:w=h.lineDash}=s.attribute,S=!1;w.length&&w.some(t=>Array.isArray(t))&&(S=!0),l.beginPath(),l.moveTo(a,o);let A=(x||u[0])&&(_||d[0]),M=(x||u[1])&&(_||d[1]),k=(x||u[2])&&(_||d[2]),T=(x||u[3])&&(_||d[3]);A&&0===t?(_?b.width:d[0],_?b.width:d[0],l.moveTo(e,i),l.lineTo(r,n),(C||S)&&(c&&c[0]?l.strokeStyle=c[0]:c&&!c[0]&&(l.strokeStyle="transparent"),_||(l.lineWidth=d[0]),l.lineDashOffset=l.currentMatrix.e/l.currentMatrix.a,S&&l.setLineDash(null!=(f=w[0])?f:[]),l.stroke(),l.beginPath())):0===t&&l.moveTo(a+p,o),M&&1===t?(_?b.width:d[1],_?b.width:d[1],l.moveTo(e,i),l.lineTo(r,n),(C||S)&&(c&&c[1]?l.strokeStyle=c[1]:c&&!c[1]&&(l.strokeStyle="transparent"),_||(l.lineWidth=d[1]),l.lineDashOffset=l.currentMatrix.f/l.currentMatrix.d,S&&l.setLineDash(null!=(m=w[1])?m:[]),l.stroke(),l.beginPath(),l.moveTo(a+p,o+g))):1===t&&l.moveTo(a+p,o+g),k&&2===t?(_?b.width:d[2],_?b.width:d[2],l.moveTo(e,i),l.lineTo(r,n),(C||S)&&(c&&c[2]?l.strokeStyle=c[2]:c&&!c[2]&&(l.strokeStyle="transparent"),_||(l.lineWidth=d[2]),l.lineDashOffset=l.currentMatrix.e/l.currentMatrix.a,S&&l.setLineDash(null!=(y=w[2])?y:[]),l.stroke(),l.beginPath(),l.moveTo(a,o+g))):2===t&&l.moveTo(a,o+g),T&&3===t?(_?b.width:d[3],_?b.width:d[3],l.moveTo(e,i),l.lineTo(r,n),(C||S)&&(c&&c[3]?l.strokeStyle=c[3]:c&&!c[3]&&(l.strokeStyle="transparent"),_||(l.lineWidth=d[3]),l.lineDashOffset=l.currentMatrix.f/l.currentMatrix.d,S&&l.setLineDash(null!=(v=w[3])?v:[]),l.stroke(),l.beginPath(),l.moveTo(a,o))):3===t&&l.moveTo(a,o),l.closePath(),C||S||(!_&&b.width&&(l.lineWidth=b.width),l.stroke()),l.lineDashOffset=0,l.setLineDash([]),l.beginPath()}eo=el([(0,tN.b)()],eo);var eu=i(77474),ed=i(9727);let ec,ep=class{constructor(){this.order=1,this.interceptors=[new eg]}afterDrawItem(t,e,i,r,n){for(let s=0;s<this.interceptors.length;s++)if(this.interceptors[s].afterDrawItem&&this.interceptors[s].afterDrawItem(t,e,i,r,n))return!0;return!1}beforeDrawItem(t,e,i,r,n){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let s=0;s<this.interceptors.length;s++)if(this.interceptors[s].beforeDrawItem&&this.interceptors[s].beforeDrawItem(t,e,i,r,n))return!0;return!1}};ep=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,tN.b)()],ep);class eg{constructor(){this.order=1}afterDrawItem(t,e,i,r,n){return"image"===t.type&&this.drawItem(t,e,i,r,n),!1}drawItem(t,e,i,r,n){let{image:s,gif:l}=t.attribute;if(l&&t.playing||!s||!t.resources)return!1;let a=t.resources.get(s);if(!a||"loading"!==a.state)return!1;if(!ec){let t=tb.U2(),e=t.loading_pic.svg,i=t.loading_pic.width,r=t.loading_pic.height;ec=(0,eu.B)({width:i,height:r,image:e})}let{image:o}=ec.attribute;if(!s||!ec.resources)return!1;let h=ec.resources.get(o);if("success"!==h.state)return!1;let{context:u}=i;u.highPerformanceSave(),t.parent&&u.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&u.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);let d=t.AABBBounds,{width:c,height:p}=(0,ed.f)(h.data.width,h.data.height,d.width(),d.height());return u.drawImage(h.data,d.x1+(d.width()-c)/2,d.y1+(d.height()-p)/2,c,p),u.highPerformanceRestore(),!0}}var ef=i(70749),em=i(38939),ey=i(58853),ev=i(11734);let eb=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,l,a,o,h,u,d,c){var p,g;let{text:f,underline:m=o.underline,lineThrough:y=o.lineThrough,direction:v=o.direction,whiteSpace:b=o.whiteSpace,fontSize:_=o.fontSize,verticalMode:x=o.verticalMode,ellipsis:C=o.ellipsis,textAlign:w=o.textAlign,textBaseline:S=o.textBaseline,x:A=o.x,y:M=o.y}=t.attribute,k=!1;if(Array.isArray(t)){let e=null==(p=t.cache)?void 0:p.layoutData;C&&e&&e.lines.every(t=>""===t.str)&&(k=!0)}else{let{cache:e}=t;C&&e&&""===e.clipedText&&0===e.clipedWidth&&(k=!0)}if(!k)return;let T=(0,ey.Z)(C)?C:"...",R=null!=(g=(0,ef.VA)(t.attribute.lineHeight,_))?g:_,B=0;R!==_&&("top"===S?B=(R-_)/2:"middle"===S||"bottom"===S&&(B=-(R-_)/2)),s&&(d?d(e,t.attribute,o):a&&(e.setStrokeStyle(t,t.attribute,A-i,M-r,o),e.strokeText(T,A,M+B))),n&&(u?u(e,t.attribute,o):l&&(e.setCommonStyle(t,t.attribute,A-i,M-r,o),e.fillText(T,A,M+B),this.drawUnderLine(m,y,t,A,M+B,0,o,e,T)))}drawUnderLine(t,e,i,r,n,s,l,a,o){if(e+t<=0)return;let{textAlign:h=l.textAlign,textBaseline:u=l.textBaseline,fontSize:d=l.fontSize,fontFamily:c=l.fontFamily,fontWeight:p=l.fontWeight,fontStyle:g=l.fontStyle,fill:f=l.fill,opacity:m=l.opacity,underlineOffset:y=l.underlineOffset,underlineDash:v=l.underlineDash,fillOpacity:b=l.fillOpacity}=i.attribute;if(!t&&!e)return;let _=ev.QC.measureTextWidth(o,{fontSize:d,fontFamily:c,fontWeight:p,fontStyle:g}),x=(0,em.js)(h,_),C=(0,em.nV)(u,d,d),w={lineWidth:0,stroke:f,opacity:m,strokeOpacity:b};if(t){w.lineWidth=t,a.setStrokeStyle(i,w,r,n,l),a.setLineDash(v),a.beginPath();let e=n+C+d+y;a.moveTo(r+x,e,s),a.lineTo(r+x+_,e,s),a.stroke()}if(e){w.lineWidth=e,a.setStrokeStyle(i,w,r,n,l),a.beginPath();let t=n+C+d/2;a.moveTo(r+x,t,s),a.lineTo(r+x+_,t,s),a.stroke()}}};eb=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,tN.b)()],eb);let e_=class{constructor(){this.type="chart",this.numberType=tj.e}contains(t,e,i){var r;if(t.attribute.detectPickChartItem){let i=t.activeChartInstance;if(!i)return!1;let n=i.getStage();null==(r=n.dirtyBounds)||r.clear();let s=n.pick(e.x,e.y);return(null!==s.graphic||"root"!==s.group.name)&&s}return!!t.AABBBounds.containsPoint(e)}};e_=function(t,e,i,r){var n,s=arguments.length,l=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(l=(s<3?n(l):s>3?n(e,i,l):n(e,i))||l);return s>3&&l&&Object.defineProperty(e,i,l),l}([(0,tN.b)()],e_);let ex=new tI.n((t,e,i,r)=>{i(tL.d4)?r(tL.d4).to(ea).inSingletonScope():(t(ea).toSelf().inSingletonScope(),t(tF.d5).toService(ea)),i(tL.Er)?r(tL.Er).to(eo).inSingletonScope():(t(eo).toSelf().inSingletonScope(),t(tF.d5).toService(eo)),t(tZ).toSelf().inSingletonScope(),t(tV).to(tZ),t(tO.uz).to(tZ),t(e_).toSelf().inSingletonScope(),t(tD.EL).toService(e_),t(t$).toSelf().inSingletonScope(),t(tF.JO).toService(t$),t(tY).toSelf().inSingletonScope(),t(tF.JO).toService(tY),t(tX).toSelf().inSingletonScope(),t(tF.JO).toService(tX),t(tq).toSelf().inSingletonScope(),t(tF.JO).toService(tq),t(ee).toSelf().inSingletonScope(),t(tF.jd).toService(ee),t(ei).toSelf().inSingletonScope(),t(tF.jd).toService(ei),t(t5).toSelf().inSingletonScope(),t(tF.jd).toService(t5),t(t3).toSelf().inSingletonScope(),t(tF.jd).toService(t3),t(t8).toSelf().inSingletonScope(),t(tF.jd).toService(t8),t(t9).toSelf().inSingletonScope(),t(tF.jd).toService(t9),t(t7).toSelf().inSingletonScope(),t(tF.jd).toService(t7),t(et).toSelf().inSingletonScope(),t(tF.jd).toService(et),t(er).toSelf().inSingletonScope(),t(tF.jd).toService(er),t(ep).toSelf().inSingletonScope(),t(tH.xL).toService(ep),t(eb).toSelf().inSingletonScope(),t(tF.$K).toService(eb)});var eC=i(92062);let ew=new tf.Z({});ew.role="empty";var eS=i(46936);function eA(t,e,i,r,n,s,l,a,o){var h,u;let d,c,p,g=0;t.lastChild&&t.lastChild.row===r-1?g=t.lastChild.attribute.y+t.lastChild.attribute.height:t.colHeight?g=t.colHeight:r>=a.columnHeaderLevelCount&&r<a.rowCount-a.bottomFrozenRowCount&&(g=a.getRowsHeight(a.columnHeaderLevelCount,r-1));for(let f=r;f<=n;f++){let n=f,m,y,v,b,_=a.getCellLocation(e,n),x=a.getCellValue(e,n),C=i,w=a.getRowHeight(n),S=!1;if(a.internalProps.customMergeCell){let t=a.getCustomMerge(e,n);if(t){let{range:e,text:i,style:l,customLayout:o,customRender:h}=t;if(y=(m=e).start.col!==m.end.col||m.start.row!==m.end.row){let t=ek(m,s,a,r>m.start.row);C=t.cellWidth,w=t.cellHeight}x=i,v=l,(o||h)&&(b=(0,U.ws)(o,h,e.start.col,e.start.row,a.getColsWidth(e.start.col,e.end.col),a.getRowsHeight(e.start.row,e.end.row),!1,a.isAutoRowHeight(n),[0,0,0,0],m,a)),S=!0}}let A,M=e,k=n;m&&(M=m.start.col,k=m.start.row),!a.isPivotTable()&&("columnHeader"===_||"cornerHeader"===_)&&n>=a.columnHeaderLevelCount&&(_="body"),A=!a.isPivotTable()&&a.isSeriesNumberInBody(e,n)?a.getBodyColumnDefine(M,k):"body"!==_?a.getHeaderDefine(M,k):a.getBodyColumnDefine(M,k);let T="isAggregation"in a.internalProps.layoutMap&&a.internalProps.layoutMap.isAggregation(e,n),R=a.internalProps.layoutMap.isSeriesNumber(e,n),B="body"!==_||((null==A?void 0:A.dragOrder)||!!(null==A?void 0:A.icon)||!!(null==A?void 0:A.tree))&&!(T&&R);if(!m&&(a.internalProps.enableTreeNodeMerge||"body"!==_||(null==A?void 0:A.mergeCell))&&(y=(m=a.getCellRange(e,n)).start.col!==m.end.col||m.start.row!==m.end.row)){let t=ek(m,s,a,r>m.start.row);C=t.cellWidth,w=t.cellHeight}let E=!1;if(a.internalProps.enableTreeNodeMerge&&y){let t=a.getCellRawRecord(m.start.col,m.start.row),{vtableMergeName:i,vtableMerge:r}=null!=t?t:{};E=r,r&&(B=!0,a.internalProps.groupTitleCustomLayout&&(b=(0,U.ws)(a.internalProps.groupTitleCustomLayout,void 0,m.start.col,m.start.row,a.getColsWidth(m.start.col,m.end.col),a.getRowsHeight(m.start.row,m.end.row),!1,a.isAutoRowHeight(n),[0,0,0,0],m,a)),a.internalProps.groupTitleFieldFormat?x=a.internalProps.groupTitleFieldFormat(t,e,n,a):void 0!==i&&(x=i))}let I=E||S?"text":null!=(u=a.isHeader(e,n)?null!=(h=a._getHeaderLayoutMap(e,n).headerType)?h:"text":a.getBodyColumnType(e,n))?u:"text";if((0,P.tI)(x)){(function(t,e,i,r,n,s,l){let a=new tf.Z({x:0,y:r,width:n,height:s});a.role="cell",a.col=t,a.row=e,l.addChild(a)})(e,n,0,g,C,w,t),(0,eS.K)(x,a,eM.bind(null,{type:I,value:x,define:A,table:a,col:e,row:n,colWidth:i,cellWidth:C,cellHeight:w,columnGroup:t,y:g,customStyle:v,mayHaveIcon:B,cellLocation:_,range:m,customResult:b,defaultRowHeight:l})),t.updateColumnRowNumber(n);let r=a.getRowHeight(n);t.updateColumnHeight(r),g+=r}else{let r=v||a._getCellStyle(m?m.start.col:e,m?m.start.row:n),s=(0,Z.RT)(r,a,m?m.start.col:e,m?m.start.row:n,Y.WJ).theme;s.group.cornerRadius=(0,Z.xv)(e,n,a),s.group.width=i,s.group.height=Array.isArray(l)?l[n]:l,s._vtable.padding&&(d=s._vtable.padding),s.text.textAlign&&(c=s.text.textAlign),s.text.textBaseline&&(p=s.text.textBaseline),"body"===_||s.group.fill||(s.group.fill="#fff");let o=(0,$.kE)(I,x,A,a,e,n,i,C,w,t,g,d,c,p,B,s,m,b);if(t.updateColumnRowNumber(n),y){let i=a.getRowHeight(n),{width:r}=(a.getColWidth(e),o.attribute),{height:s}=o.attribute;o.contentWidth=r,o.contentHeight=s,(0,$.pZ)(m,r,s,d,c,p,a),t.updateColumnHeight(i),g+=i}else t.updateColumnHeight(w),g+=w}if(o&&n>o)break}return t.setAttribute("width",i),{width:i,height:g}}function eM(t){let e,i,r,{type:n,value:s,define:l,table:a,col:o,row:h,colWidth:u,cellWidth:d,cellHeight:c,columnGroup:p,y:g,cellLocation:f,mayHaveIcon:m,customStyle:y,range:v,customResult:b,defaultRowHeight:_}=t,x=y||a._getCellStyle(v?v.start.col:o,v?v.start.row:h),C=(0,Z.RT)(x,a,v?v.start.col:o,v?v.start.row:h,Y.WJ).theme;C.group.cornerRadius=(0,Z.xv)(o,h,a),C.group.width=u,C.group.height=Array.isArray(_)?_[h]:_,C._vtable.padding&&(e=C._vtable.padding),C.text.textAlign&&(i=C.text.textAlign),C.text.textBaseline&&(r=C.text.textBaseline),"body"===f||C.group.fill||(C.group.fill="#fff"),(0,$.kE)(n,s,l,a,o,h,u,d,c,p,g,e,i,r,m,C,v,b)}function ek(t,e,i,r){let n=0,s=0,l=e.get(`${t.start.col},${t.start.row};${t.end.col},${t.end.row}`);if(!l||r){for(let e=t.start.col;e<=t.end.col;e++)n+=i.getColWidth(e);for(let e=t.start.row;e<=t.end.row;e++)s+=i.getRowHeight(e);e.set(`${t.start.col},${t.start.row};${t.end.col},${t.end.row}`,{cellWidth:n,cellHeight:s})}else n=l.cellWidth,s=l.cellHeight;return{cellWidth:n,cellHeight:s}}function eT(t,e,i,r,n,s,l,a,o,h){if(r>n||s>l)return;let{layoutMap:u,defaultHeaderRowHeight:d,defaultColWidth:c}=o.internalProps,p=o.defaultRowHeight,g=0,f=0;for(let u=r;u<=n;u++){let r=u,n=o.getColWidth(r),c=new tf.Z({x:e+g,y:i,width:n,height:0,clip:!1,pickable:!1});c.role="column",c.col=u,t.addChild(c);let{width:m,height:y}=eA(c,r,n,s,l,o.scenegraph.mergeMap,"columnHeader"===a&&(0,X.Z)(d)?d:p,o,h);g+=m,f=Math.max(f,y)}t.setAttribute("width",g),t.setAttribute("height",f)}function eR(t){let e=t.firstChild;for(;e&&"group"!==e.type;)e=e._next;return e}function eB(t){let e=t.lastChild;for(;e&&"group"!==e.type;)e=e._prev;return e}function eP(t,e,i,r="left"){for(let n=t;n<=e;n++){let t=i.scenegraph.getColGroup(n);t&&eE(t,i,r);let e=i.scenegraph.getColGroup(n,!0);e&&eE(e,i,r);let s=i.scenegraph.getColGroupInBottom(n);s&&eE(s,i,r)}let n=Math.min(i.scenegraph.proxy.colLimit,i.scenegraph.proxy.bodyRightCol-i.scenegraph.proxy.bodyLeftCol+1),s=i.getColsWidth(i.frozenColCount,i.frozenColCount+n),l=i.getColsWidth(i.frozenColCount,i.colCount-1);i.scenegraph.proxy.xLimitLeft=s/2,i.scenegraph.proxy.xLimitRight=l-s/2}function eE(t,e,i="left"){if("left"===i){let i,r=function(t){let e=t._prev;for(;e&&"group"!==e.type;)e=e._prev;return e}(t);i=r?r.attribute.x+e.getColWidth(t._prev.col):e.getColsWidth(e.frozenColCount,t.col-1),t.setAttribute("x",i)}else{let i,r=function(t){let e=t._next;for(;e&&"group"!==e.type;)e=e._next;return e}(t);i=r?r.attribute.x-e.getColWidth(t.col):e.getColsWidth(e.frozenColCount,t.col-1),t.setAttribute("x",i)}}var eI=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function l(t){try{o(r.next(t))}catch(t){s(t)}}function a(t){try{o(r.throw(t))}catch(t){s(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(l,a)}o((r=r.apply(t,e||[])).next())})};function eL(t,e,i,r,n,s){return eI(this,void 0,void 0,function*(){if("left"===e&&s.colEnd+t>s.bodyRightCol?t=s.bodyRightCol-s.colEnd:"right"===e&&s.colStart-t<s.bodyLeftCol&&(t=s.colStart-s.bodyLeftCol),0!==t)if(t<0&&(e="left"===e?"right":"left",t=-t),t<s.colEnd-s.colStart){let n="left"===e?s.colStart:s.colEnd-t+1,l="left"===e?s.colStart+t-1:s.colEnd,a="left"===e?s.colEnd+1:s.colStart-t,o="left"===e?s.colEnd+t:s.colStart-1;(0,eC.rj)(s.table,a,o),function(t,e,i,r){for(let n=t;n<=e;n++)r.table.scenegraph.bodyGroup.childrenCount>0&&"group"===r.table.scenegraph.bodyGroup.firstChild.type&&eD(r.table.scenegraph.bodyGroup,i,r),r.table.scenegraph.colHeaderGroup.childrenCount>0&&"group"===r.table.scenegraph.colHeaderGroup.firstChild.type&&eD(r.table.scenegraph.colHeaderGroup,i,r),r.table.scenegraph.bottomFrozenGroup.childrenCount>0&&"group"===r.table.scenegraph.bottomFrozenGroup.firstChild.type&&eD(r.table.scenegraph.bottomFrozenGroup,i,r)}(n,l,e,s),s.colStart="left"===e?s.colStart+t:s.colStart-t,s.colEnd="left"===e?s.colEnd+t:s.colEnd-t,eH(a,o,s),eP(a,o,s.table,e);let h=r-((s.table.scenegraph.getColGroup(i)||s.table.scenegraph.getColGroup(i,!0)).attribute.x+s.table.getFrozenColsWidth()+s.table.scenegraph.proxy.deltaX);s.table.scenegraph.proxy.deltaX+=h,s.currentCol="left"===e?s.currentCol+t:s.currentCol-t,s.totalCol=Math.max(0,Math.min(s.table.colCount-1,"left"===e?s.totalCol+t:s.totalCol-t)),s.referenceCol=s.colStart+Math.floor((s.colEnd-s.colStart)/2),s.colUpdatePos=a,s.colUpdateDirection=e,s.table.scenegraph.updateNextFrame()}else{var n,l,a,o;let i="left"===e?s.colStart+t:s.colStart-t,r="left"===e?s.colEnd+t:s.colEnd-t;(0,eC.rj)(s.table,i,r),n=s.table.getColsWidth(s.bodyLeftCol,i-1),l=t,a=e,(o=s).table.scenegraph.colHeaderGroup.forEachChildren((t,e)=>{"group"===t.type&&eF(t,"left"===a?t.col+l:t.col-l,0===e?n:t._prev.attribute.x+o.table.getColWidth(t._prev.col))}),o.table.scenegraph.bottomFrozenGroup.forEachChildren((t,e)=>{"group"===t.type&&eF(t,"left"===a?t.col+l:t.col-l,0===e?n:t._prev.attribute.x+o.table.getColWidth(t._prev.col))}),o.table.scenegraph.bodyGroup.forEachChildren((t,e)=>{"group"===t.type&&eF(t,"left"===a?t.col+l:t.col-l,0===e?n:t._prev.attribute.x+o.table.getColWidth(t._prev.col))}),s.colStart=i,s.colEnd=r,eH(i,r,s),eP(i,r,s.table,r>s.bodyRightCol-(s.colEnd-s.colStart+1)?"right":"left"),s.currentCol="left"===e?s.currentCol+t:s.currentCol-t,s.totalCol=Math.max(0,Math.min(s.table.colCount-1,"left"===e?s.totalCol+t:s.totalCol-t)),s.referenceCol=s.colStart+Math.floor((s.colEnd-s.colStart)/2),s.colUpdatePos=s.colStart,s.colUpdateDirection=r>s.bodyRightCol-(s.colEnd-s.colStart+1)?"right":"left",s.table.scenegraph.updateNextFrame()}})}function eF(t,e,i){t.col=e,t.forEachChildren(t=>{t.col=e,t.needUpdate=!0}),t.setAttribute("x",i),t.needUpdate=!0}function eO(t,e){if(!t)return;let i=t.firstChild;for(;i;)i=e.updateCellGroupContent(i)._next;t.needUpdate=!1,t.setAttribute("width",e.table.getColWidth(t.col))}function eD(t,e,i){if("left"===e){let e=eR(t),r=eB(t);eF(e,r.col+1,r.attribute.x+i.table.getColWidth(r.col)),t.appendChild(e),t.border&&t.appendChild(t.border)}else{let e=eB(t),r=eR(t);eF(e,r.col-1,r.attribute.x-i.table.getColWidth(r.col-1)),t.insertBefore(e,t.firstChild)}}function eH(t,e,i){for(let r=t;r<=e;r++){let t=i.table.scenegraph.getColGroup(r,!0);t&&eO(t,i);let e=i.table.scenegraph.getColGroupInBottom(r);e&&eO(e,i);let n=i.table.scenegraph.getColGroupInRightTopCorner(r);n&&eO(n,i);let s=i.table.scenegraph.getColGroupInRightBottomCorner(r);s&&eO(s,i);let l=i.table.scenegraph.getColGroup(r);l&&function(t,e){if(!t)return;let i=e.screenTopRow,r=Math.max(e.bodyTopRow,i-e.screenRowCount),n=Math.min(e.bodyBottomRow,i+2*e.screenRowCount,e.table.rowCount-1);for(let i=r;i<=n;i++){let r=e.highPerformanceGetCell(t.col,i,!0);e.updateCellGroupContent(r)}e.rowUpdatePos=e.rowStart,t.needUpdate=!1,t.setAttribute("width",e.table.getColWidth(t.col))}(l,i)}ez(i.table.scenegraph.colHeaderGroup),ez(i.table.scenegraph.bottomFrozenGroup),ez(i.table.scenegraph.bodyGroup),i.progress()}function ez(t){var e,i;let r=eB(t);if(r&&(t.setAttribute("width",r.attribute.x+r.attribute.width),t.border)){let n=t.border;n.setAttribute("width",r.attribute.x+r.attribute.width-(null!=(e=n.attribute.borderLeft)?e:0)/2-(null!=(i=n.attribute.borderRight)?i:0)/2)}}function eW(t,e,i,r,n,s="up",l){var a,o;if("up"===s)for(let s=t;s<=e;s++)for(let t=i;t<=r;t++){let e,i=n.scenegraph.highPerformanceGetCell(s,t,!0);if("cell"===i.role&&i.row){if(i._prev)e=(null==(a=i._prev)?void 0:a.attribute.y)+n.getRowHeight(i._prev.row);else if(l){let i=r===n.rowCount-n.bottomFrozenRowCount-1?r:r+1;if(e=n.scenegraph.highPerformanceGetCell(s,i,!0).attribute.y,(0,y.Z)(e))for(let r=t;r<i;r++)e-=n.getRowHeight(r)}else e=eN(i.row,n);(0,y.Z)(e)&&i.setAttribute("y",e)}}else for(let s=t;s<=e;s++)for(let t=r;t>=i;t--){let e,r=n.scenegraph.highPerformanceGetCell(s,t,!0);if("cell"===r.role&&r.row){if(r._next)e=(null==(o=r._next)?void 0:o.attribute.y)-n.getRowHeight(r.row);else if(l){let r=i<=n.frozenRowCount?n.frozenRowCount:i-1;e=i<=n.frozenRowCount?0:n.scenegraph.highPerformanceGetCell(s,r,!0).attribute.y;for(let i=r;i<t;i++)e+=n.getRowHeight(i)}else e=eN(r.row,n);(0,y.Z)(e)&&r.setAttribute("y",e)}}let h=Math.min(n.scenegraph.proxy.rowLimit,n.scenegraph.proxy.bodyBottomRow-n.scenegraph.proxy.bodyTopRow+1),u=n.getRowsHeight(n.frozenRowCount,n.frozenRowCount+h),d=n.getRowsHeight(n.frozenRowCount,n.rowCount-1);n.scenegraph.proxy.yLimitTop=u/2,n.scenegraph.proxy.yLimitBottom=d-u/2}function eN(t,e){return t<e.frozenRowCount?e.getRowsHeight(0,t-1):t>=e.rowCount-e.bottomFrozenRowCount?e.getRowsHeight(e.rowCount-e.bottomFrozenRowCount,t-1):e.getRowsHeight(e.frozenRowCount,t-1)}var ej=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function l(t){try{o(r.next(t))}catch(t){s(t)}}function a(t){try{o(r.throw(t))}catch(t){s(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(l,a)}o((r=r.apply(t,e||[])).next())})};function eG(t,e,i,r,n,s){return ej(this,void 0,void 0,function*(){if("up"===e&&s.rowEnd+t>s.bodyBottomRow?t=s.bodyBottomRow-s.rowEnd:"down"===e&&s.rowStart-t<s.bodyTopRow&&(t=s.rowStart-s.bodyTopRow),0!==t)if(t<0&&(e="up"===e?"down":"up",t=-t),t<s.rowEnd-s.rowStart){let r,n,l="up"===e?s.rowStart:s.rowEnd-t+1,a="up"===e?s.rowStart+t-1:s.rowEnd,o="up"===e?s.rowEnd+1:s.rowStart-t,h="up"===e?s.rowEnd+t:s.rowStart-1;s.table.isAutoRowHeight(l)?(r=o,n=h):(r=Math.max(s.bodyTopRow,i-s.screenRowCount),n=Math.min(s.bodyBottomRow,i+2*s.screenRowCount,s.table.rowCount-1)),(0,te.Y)(s.table,r,n,!1),function(t,e,i,r){for(let n=0;n<r.table.frozenColCount;n++){let s=r.table.scenegraph.getColGroup(n);if(s)for(let n=t;n<=e;n++)eV(s,i,r)}for(let n=r.table.colCount-r.table.rightFrozenColCount;n<r.table.colCount;n++){let s=r.table.scenegraph.getColGroup(n);if(s)for(let n=t;n<=e;n++)eV(s,i,r)}for(let n=r.bodyLeftCol;n<=r.bodyRightCol;n++){let s=r.table.scenegraph.getColGroup(n);if(s)for(let n=t;n<=e;n++)eV(s,i,r)}}(l,a,e,s),s.rowStart="up"===e?s.rowStart+t:s.rowStart-t,s.rowEnd="up"===e?s.rowEnd+t:s.rowEnd-t;let u=eZ(r,n,s,!0);s.table.isAutoRowHeight(l)&&(eW(s.bodyLeftCol,s.bodyRightCol,r,n,s.table,h>s.bodyBottomRow-(s.rowEnd-s.rowStart+1)?"down":"up",!0),eW(0,s.table.frozenColCount-1,r,n,s.table,h>s.bodyBottomRow-(s.rowEnd-s.rowStart+1)?"down":"up",!0),eW(s.table.colCount-s.table.rightFrozenColCount,s.table.colCount-1,r,n,s.table,h>s.bodyBottomRow-(s.rowEnd-s.rowStart+1)?"down":"up",!0)),s.currentRow="up"===e?s.currentRow+t:s.currentRow-t,s.totalRow=Math.max(0,Math.min(s.bodyBottomRow,"up"===e?s.totalRow+t:s.totalRow-t,s.table.rowCount-1)),s.referenceRow=s.rowStart+Math.floor((s.rowEnd-s.rowStart)/2),s.table.isAutoRowHeight(l)&&u?s.rowUpdatePos=Math.min(s.rowUpdatePos,s.rowEnd+1):s.rowUpdatePos=Math.min(s.rowUpdatePos,o),s.rowUpdateDirection=e,s.table.scenegraph.updateNextFrame(),yield s.progress()}else{let r,n,l="up"===e?s.rowStart+t:s.rowStart-t,a=Math.min(s.table.rowCount-1,"up"===e?s.rowEnd+t:s.rowEnd-t),o=s.table.getRowsHeight(s.bodyTopRow,l-1);s.table.isAutoRowHeight(l)?(r=l,n=a):(r=Math.max(s.bodyTopRow,i-s.screenRowCount),n=Math.min(s.bodyBottomRow,i+2*s.screenRowCount,s.table.rowCount-1)),(0,te.Y)(s.table,r,n,!1),function(t,e,i,r){for(let n=0;n<r.table.frozenColCount;n++){let s=r.table.scenegraph.getColGroup(n);null==s||s.forEachChildren((n,s)=>{r.updateCellGroupPosition(n,"up"===i?n.row+e:n.row-e,0===s?t:n._prev.attribute.y+r.table.getRowHeight(n._prev.row))})}for(let n=r.table.colCount-r.table.rightFrozenColCount;n<r.table.colCount;n++){let s=r.table.scenegraph.getColGroup(n);null==s||s.forEachChildren((n,s)=>{r.updateCellGroupPosition(n,"up"===i?n.row+e:n.row-e,0===s?t:n._prev.attribute.y+r.table.getRowHeight(n._prev.row))})}for(let n=r.bodyLeftCol;n<=r.bodyRightCol;n++){let s=r.table.scenegraph.getColGroup(n);null==s||s.forEachChildren((n,s)=>{r.updateCellGroupPosition(n,"up"===i?n.row+e:n.row-e,0===s?t:n._prev.attribute.y+r.table.getRowHeight(n._prev.row))})}}(o,t,e,s),s.rowStart=l,s.rowEnd=a;let h=eZ(r,n,s,!0);s.table.isAutoRowHeight(l)&&(eW(s.bodyLeftCol,s.bodyRightCol,r,n,s.table,a>s.bodyBottomRow-(s.rowEnd-s.rowStart+1)?"down":"up"),eW(0,s.table.frozenColCount-1,r,n,s.table,a>s.bodyBottomRow-(s.rowEnd-s.rowStart+1)?"down":"up"),eW(s.table.colCount-s.table.rightFrozenColCount,s.table.colCount-1,r,n,s.table,a>s.bodyBottomRow-(s.rowEnd-s.rowStart+1)?"down":"up")),s.currentRow="up"===e?s.currentRow+t:s.currentRow-t,s.totalRow=Math.max(0,Math.min(s.bodyBottomRow,"up"===e?s.totalRow+t:s.totalRow-t,s.table.rowCount-1)),s.referenceRow=s.rowStart+Math.floor((s.rowEnd-s.rowStart)/2),s.table.isAutoRowHeight(l)&&h?s.rowUpdatePos=s.rowEnd+1:s.rowUpdatePos=s.rowStart,s.rowUpdateDirection=a>s.bodyBottomRow-(s.rowEnd-s.rowStart+1)?"down":"up",s.table.scenegraph.updateNextFrame(),yield s.progress()}})}function eV(t,e,i){if(t.childrenCount>=1)if("up"===e){let e=t.firstChild;i.updateCellGroupPosition(e,t.lastChild.row+1,t.lastChild.attribute.y+i.table.getRowHeight(t.lastChild.row)),t.appendChild(e)}else{let e=t.lastChild;i.updateCellGroupPosition(e,t.firstChild.row-1,t.firstChild.attribute.y-i.table.getRowHeight(e.row)),t.insertBefore(e,t.firstChild)}}function eZ(t,e,i,r=!1){for(let r=0;r<i.table.frozenColCount;r++)for(let n=t;n<=e;n++){let t=i.highPerformanceGetCell(r,n,!0);i.updateCellGroupContent(t)}for(let r=i.table.colCount-i.table.rightFrozenColCount;r<i.table.colCount;r++)for(let n=t;n<=e;n++){let t=i.highPerformanceGetCell(r,n);i.updateCellGroupContent(t)}let n=i.bodyLeftCol,s=i.bodyRightCol,l=!0;if(r){let t=i.screenLeftCol;n=Math.max(i.bodyLeftCol,t-i.screenColCount),s=Math.min(i.bodyRightCol,t+2*i.screenColCount),n===i.bodyLeftCol&&s===i.bodyRightCol||(l=!1)}for(let r=n;r<=s;r++)for(let n=t;n<=e;n++){let t=i.highPerformanceGetCell(r,n);i.updateCellGroupContent(t)}return eU(i.table.scenegraph.rowHeaderGroup),eU(i.table.scenegraph.rightFrozenGroup),eU(i.table.scenegraph.bodyGroup),i.table.scenegraph.updateNextFrame(),l}function eU(t){var e,i;let r=eB(t);if(!r)return;let n=eB(r);if(n&&(t.setAttribute("height",n.attribute.y+n.attribute.height),t.border)){let r=t.border;r.setAttribute("height",n.attribute.y+n.attribute.height-(null!=(e=r.attribute.borderTop)?e:0)/2-(null!=(i=r.attribute.borderBottom)?i:0)/2)}}function eK(t){let{changedCells:e}=t.internalProps.stick;return e.forEach(e=>{t.scenegraph.getCell(e.col,e.row).forEachChildren(t=>{t.setAttributes({dx:e.dx,dy:e.dy})})}),e.clear(),e}function e$(t){let e=eK(t),{scrollTop:i,scrollLeft:r,frozenRowCount:n,frozenColCount:s}=t,l=t.getFrozenRowsHeight(),a=t.getFrozenColsWidth(),{row:o}=t.getRowAt(i+l+1),{col:h}=t.getColAt(r+a+1),u=Math.max(o,t.frozenRowCount),d=Math.max(h,t.frozenColCount),c=t.getAllRowsHeight()>t.tableNoFrameHeight?t.getRowAt(i+t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()-1).row:t.rowCount-t.bottomFrozenRowCount-1,p=t.getAllColsWidth()>t.tableNoFrameWidth?t.getColAt(r+t.tableNoFrameWidth-t.getRightFrozenColsWidth()-1).col:t.colCount-t.rightFrozenColCount-1;if(!(p<0||c<0)){for(let i=0;i<n&&!(p<d);i++)[d,p].forEach(r=>{let n=t._getCellStyle(r,i);(null==n?void 0:n.textStick)&&"vertical"!==(null==n?void 0:n.textStick)&&eq(t.scenegraph.getCell(r,i),a+t.tableX,t.tableNoFrameWidth-t.getRightFrozenColsWidth()+t.tableX,e,null==n?void 0:n.textStickBaseOnAlign,t)});for(let i=0;i<s&&!(c<u);i++)[u,c].forEach(r=>{let n=t._getCellStyle(i,r);(null==n?void 0:n.textStick)&&"horizontal"!==(null==n?void 0:n.textStick)&&eY(t.scenegraph.getCell(i,r),l+t.tableY,t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()+t.tableY,e,null==n?void 0:n.textStickBaseOnAlign,t)});for(let i=d;i<=p&&!(c<u);i++)[u,c].forEach(r=>{let n=t._getCellStyle(i,r);(null==n?void 0:n.textStick)&&"horizontal"!==(null==n?void 0:n.textStick)&&eY(t.scenegraph.getCell(i,r),l+t.tableY,t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()+t.tableY,e,null==n?void 0:n.textStickBaseOnAlign,t)});for(let i=u;i<=c&&!(p<d);i++)[d,p].forEach(r=>{let n=t._getCellStyle(r,i);(null==n?void 0:n.textStick)&&"vertical"!==(null==n?void 0:n.textStick)&&eq(t.scenegraph.getCell(r,i),a+t.tableX,t.tableNoFrameWidth-t.getRightFrozenColsWidth()+t.tableX,e,null==n?void 0:n.textStickBaseOnAlign,t)})}}function eY(t,e,i,r,n,s){if((0,X.Z)(t.mergeStartCol)&&(0,X.Z)(t.mergeStartRow)&&(0,X.Z)(t.mergeEndCol)&&(0,X.Z)(t.mergeEndRow)){let{colStart:l,colEnd:a,rowStart:o,rowEnd:h}=(0,ti.e)(t,s.scenegraph);for(let t=l;t<=a;t++)for(let l=o;l<=h;l++){let a=s.scenegraph.getCell(t,l);"cell"===a.role&&eX(a,e,i,r,n)}}else eX(t,e,i,r,n)}function eX(t,e,i,r,n){var s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x;let C=t.getChildByName("text",!0)||t.getChildByName("image",!0);if(!C)return;if("image"===C.type){let{image:t}=C.attribute;if(!t||!C.resources||"success"!==C.resources.get(t).state)return}let w=null!=(s=C.textBaseline)?s:"top";C.AABBBounds.width();let S=C.globalAABBBounds.y1,A=C.globalAABBBounds.y2;if("middle"===w&&n){let n=t.globalAABBBounds.y1+(null!=(a=null==(l=t.firstChild)?void 0:l.attribute.dy)?a:0),s=n+(null!=(h=null!=(o=t.contentHeight)?o:t.attribute.height)?h:0);if(n<e||s>i){let l=Math.max(n,e),a=Math.min(s,i),o=C.globalTransMatrix.f-(a+l)/2+C.AABBBounds.height()/2;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(d=null==(u=t.firstChild)?void 0:u.attribute.dx)?d:0,dy:null!=(p=null==(c=t.firstChild)?void 0:c.attribute.dy)?p:0}),t.forEachChildren(t=>{var e;t.setAttribute("dy",(null!=(e=t.attribute.dy)?e:0)-o+2)})}}else if(S<e){let i=S-e;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(f=null==(g=t.firstChild)?void 0:g.attribute.dx)?f:0,dy:null!=(y=null==(m=t.firstChild)?void 0:m.attribute.dy)?y:0}),t.forEachChildren(t=>{var e;t.setAttribute("dy",(null!=(e=t.attribute.dy)?e:0)-i+2)})}else if(A>i){let e=A-i;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(b=null==(v=t.firstChild)?void 0:v.attribute.dx)?b:0,dy:null!=(x=null==(_=t.firstChild)?void 0:_.attribute.dy)?x:0}),t.forEachChildren(t=>{var i;t.setAttribute("dy",(null!=(i=t.attribute.dy)?i:0)-e)})}}function eq(t,e,i,r,n,s){if((0,X.Z)(t.mergeStartCol)&&(0,X.Z)(t.mergeStartRow)&&(0,X.Z)(t.mergeEndCol)&&(0,X.Z)(t.mergeEndRow)){let{colStart:l,colEnd:a,rowStart:o,rowEnd:h}=(0,ti.e)(t,s.scenegraph);for(let t=l;t<=a;t++)for(let l=o;l<=h;l++){let a=s.scenegraph.getCell(t,l);"cell"===a.role&&eJ(a,e,i,r,n)}}else eJ(t,e,i,r,n)}function eJ(t,e,i,r,n){var s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C;let w=t.getChildByName("text",!0)||t.getChildByName("image",!0);if(!w)return;if("image"===w.type){let{image:t}=w.attribute;if(!t||!w.resources||"success"!==w.resources.get(t).state)return}let S=null!=(l=null!=(s=w.attribute.textAlign)?s:w.textAlign)?l:"left";w.AABBBounds.width();let A=w.globalAABBBounds.x1,M=w.globalAABBBounds.x2;if("center"===S&&n){let n=t.globalAABBBounds.x1+(null!=(o=null==(a=t.firstChild)?void 0:a.attribute.dx)?o:0),s=n+(null!=(u=null!=(h=t.contentWidth)?h:t.attribute.width)?u:0);if(n<e||s>i){let l=Math.max(n,e),a=Math.min(s,i),o=w.globalTransMatrix.e-(a+l)/2;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(c=null==(d=t.firstChild)?void 0:d.attribute.dx)?c:0,dy:null!=(g=null==(p=t.firstChild)?void 0:p.attribute.dy)?g:0}),t.forEachChildren(t=>{var e;t.setAttribute("dx",(null!=(e=t.attribute.dx)?e:0)-o+2)})}}else if(A<e){let i=A-e;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(m=null==(f=t.firstChild)?void 0:f.attribute.dx)?m:0,dy:null!=(v=null==(y=t.firstChild)?void 0:y.attribute.dy)?v:0}),t.forEachChildren(t=>{var e;t.setAttribute("dx",(null!=(e=t.attribute.dx)?e:0)-i+2)})}else if(M>i){let e=M-i;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(_=null==(b=t.firstChild)?void 0:b.attribute.dx)?_:0,dy:null!=(C=null==(x=t.firstChild)?void 0:x.attribute.dy)?C:0}),t.forEachChildren(t=>{var i;t.setAttribute("dx",(null!=(i=t.attribute.dx)?i:0)-e)})}}function eQ(t){var e,i;let r=t.internalProps.layoutMap.headerObjects,n=t.internalProps.layoutMap.columnObjects;for(let t=0;t<r.length;t++){let i=r[t];if(i&&(null==(e=i.style)?void 0:e.textStick))return!0}for(let t=0;t<n.length;t++){let e=n[t];if(e&&(null==(i=e.style)?void 0:i.textStick))return!0}return!!(t.theme.headerStyle.textStick||t.theme.rowHeaderStyle.textStick||t.theme.bodyStyle.textStick)}var e0=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function l(t){try{o(r.next(t))}catch(t){s(t)}}function a(t){try{o(r.throw(t))}catch(t){s(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(l,a)}o((r=r.apply(t,e||[])).next())})};class e1{constructor(t){this.isRelease=!1,this.mode="column",this.rowLimit=200,this.currentRow=0,this.rowStart=0,this.rowEnd=0,this.referenceRow=0,this.screenTopRow=0,this.deltaY=0,this.deltaHeight=0,this.colLimit=100,this.screenLeftCol=0,this.deltaX=0,this.deltaWidth=0,this.cellCache=new Map,this.table=t,this.table.isPivotChart()?(this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))):this.table.isAutoRowHeight(t.columnHeaderLevelCount)?this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)):("autoWidth"===this.table.widthMode||(this.rowLimit=Math.max(200,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight))),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))),this.table.internalProps.transpose?this.mode="row":this.table.isPivotTable()&&(this.mode="pivot"),this.table.options.maintainedDataCount&&(this.rowLimit=this.table.options.maintainedDataCount),this.table.options.maintainedColumnCount&&(this.colLimit=this.table.options.maintainedColumnCount),"adaptive"===this.table.heightMode&&(this.rowLimit=this.table.rowCount),"adaptive"===this.table.widthMode&&(this.colLimit=this.table.colCount)}get bodyLeftCol(){return this.table.frozenColCount}get bodyTopRow(){return this.table.frozenRowCount}setParamsForColumn(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;let t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol;let e=this.table.defaultColWidth;this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/e);let i=e*t,r=e*(this.bodyRightCol-this.bodyLeftCol+1);this.xLimitLeft=i/2,this.xLimitRight=r-i/2;let n=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/e),this.firstScreenColLimit=Math.max(15,this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(n/e))),this.colUpdatePos=this.bodyRightCol}setParamsForRow(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;let t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.bodyTopRow+t-1,this.rowStart=this.bodyTopRow,this.rowEnd=this.totalRow;let e=this.table.defaultRowHeight;this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/e);let i=e*t,r=e*(this.bodyBottomRow-this.bodyTopRow+1);this.yLimitTop=i/2,this.yLimitBottom=r-i/2;let n=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/e),this.firstScreenRowLimit=Math.max(30,this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(n/e))),this.rowUpdatePos=this.bodyBottomRow}refreshRowCount(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;let t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.rowStart+t-1}refreshColCount(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;let t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol}resize(){let t=this.table.defaultColWidth;this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/t);let e=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/t),this.firstScreenColLimit=this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(e/t));let i=this.table.defaultRowHeight;this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/i);let r=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/i),this.firstScreenRowLimit=this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(r/i))}createGroupForFirstScreen(t,e,i,r,n,s,l,a){!function(t,e,i,r,n,s,l,a,o){var h,u,d,c,p,g,f,m,y,v,b,_,x;let C,w,S,A,{table:M}=o,{leftBottomCornerGroup:k,rightTopCornerGroup:T,rightBottomCornerGroup:R}=M.scenegraph;o.setParamsForRow(),o.setParamsForColumn(),("adaptive"===M.widthMode||M.options.autoWrapText&&("adaptive"===M.heightMode||M.isAutoRowHeight(M.columnHeaderLevelCount)))&&(S=M.colCount-1),C=Math.min(o.firstScreenColLimit-1,M.colCount-1),"adaptive"===M.heightMode&&(A=M.rowCount-1),w=Math.min(o.firstScreenRowLimit-1,M.rowCount-1),0===M.internalProps._widthResizedColMap.size&&(0,eC.rj)(M,0,null!=S?S:C),0===M.internalProps._heightResizedRowMap.size&&(0,te.Y)(M,0,"auto"===M.options.canvasHeight||(null==(h=M.options.customConfig)?void 0:h.forceComputeAllRowHeight)?M.rowCount-1:null!=A?A:w),C<M.colCount-M.rightFrozenColCount&&M.colCount-M.rightFrozenColCount<=M.colCount-1&&(0,eC.rj)(M,M.colCount-M.rightFrozenColCount,M.colCount-1),w<M.rowCount-M.bottomFrozenRowCount&&M.rowCount-M.bottomFrozenRowCount<=M.rowCount-1&&(0,te.Y)(M,M.rowCount-M.bottomFrozenRowCount,M.rowCount-1),M.scenegraph.colHeaderGroup.setAttribute("x",M.getFrozenColsWidth()),M.scenegraph.rowHeaderGroup.setAttribute("y",M.getFrozenRowsHeight()),M.scenegraph.bottomFrozenGroup.setAttribute("x",M.getFrozenColsWidth()),M.scenegraph.rightFrozenGroup.setAttribute("y",M.getFrozenRowsHeight()),M.scenegraph.bodyGroup.setAttributes({x:M.getFrozenColsWidth(),y:M.getFrozenRowsHeight()}),eT(t,l,a,0,M.frozenColCount-1,0,M.frozenRowCount-1,M.isListTable()?"columnHeader":"cornerHeader",M),C-M.rightFrozenColCount>=M.frozenColCount&&eT(e,l,a,M.frozenColCount,C-M.rightFrozenColCount,0,M.frozenRowCount-1,"columnHeader",M),M.frozenColCount>0&&(M.leftRowSeriesNumberCount>0&&eT(i,l,a,0,M.leftRowSeriesNumberCount-1,M.frozenRowCount,w-M.bottomFrozenRowCount,"rowHeader",M),M.frozenColCount>M.leftRowSeriesNumberCount&&eT(i,l,a,M.leftRowSeriesNumberCount,Math.min(M.frozenColCount-1,M.rowHeaderLevelCount+M.leftRowSeriesNumberCount-1),M.frozenRowCount,w-M.bottomFrozenRowCount,"rowHeader",M),M.frozenColCount>M.rowHeaderLevelCount+M.leftRowSeriesNumberCount&&eT(i,l,a,M.rowHeaderLevelCount+M.leftRowSeriesNumberCount,M.frozenColCount-1,M.frozenRowCount,w-M.bottomFrozenRowCount,"body",M)),M.bottomFrozenRowCount>0&&(M.frozenColCount>0&&(M.leftRowSeriesNumberCount>0&&eT(k,l,a,0,M.leftRowSeriesNumberCount-1,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,"rowHeader",M),M.rowHeaderLevelCount>0&&eT(k,l,a,M.leftRowSeriesNumberCount,M.leftRowSeriesNumberCount+M.rowHeaderLevelCount-1,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,"rowHeader",M),M.frozenColCount>M.rowHeaderLevelCount+M.leftRowSeriesNumberCount&&eT(k,l,a,M.rowHeaderLevelCount+M.leftRowSeriesNumberCount,M.frozenColCount-1,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,"body",M)),C-M.rightFrozenColCount>=M.frozenColCount&&eT(n,l,a,M.frozenColCount,C-M.rightFrozenColCount,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,M.isPivotChart()?"rowHeader":"body",M)),M.rightFrozenColCount>0&&(eT(T,l,a,M.colCount-1-M.rightFrozenColCount+1,M.colCount-1,0,M.frozenRowCount-1,"columnHeader",M),eT(r,l,a,M.colCount-1-M.rightFrozenColCount+1,M.colCount-1,M.frozenRowCount,w-M.bottomFrozenRowCount,M.isPivotChart()?"rowHeader":"body",M)),M.bottomFrozenRowCount>0&&M.rightFrozenColCount>0&&eT(R,l,a,M.colCount-1-M.rightFrozenColCount+1,M.colCount-1,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,"body",M),C-M.rightFrozenColCount>=M.frozenColCount&&eT(s,l,a,M.frozenColCount,C-M.rightFrozenColCount,M.frozenRowCount,w-M.bottomFrozenRowCount,"body",M),s.firstChild||e.firstChild||t.firstChild||i.firstChild?(o.currentRow=null!=(p=null!=(d=null==(u=s.firstChild)?void 0:u.rowNumber)?d:null==(c=i.firstChild)?void 0:c.rowNumber)?p:o.totalRow,o.rowEnd=o.currentRow,o.rowUpdatePos=o.rowEnd+1,o.referenceRow=o.rowStart+Math.floor((o.rowEnd-o.rowStart)/2),o.currentCol=null!=(x=null!=(b=null!=(y=null!=(f=null==(g=s.lastChild)?void 0:g.col)?f:null==(m=e.lastChild)?void 0:m.col)?y:null==(v=i.lastChild)?void 0:v.col)?b:null==(_=t.lastChild)?void 0:_.col)?x:o.totalCol,o.colEnd=o.currentCol,o.colUpdatePos=o.colEnd+1,o.referenceCol=o.colStart+Math.floor((o.colEnd-o.colStart)/2),o.progress()):(o.currentRow=o.totalRow,o.rowEnd=o.currentRow,o.rowUpdatePos=o.rowEnd+1,o.referenceRow=o.rowStart+Math.floor((o.rowEnd-o.rowStart)/2),o.currentCol=o.totalCol,o.colEnd=o.currentCol,o.colUpdatePos=o.colEnd+1,o.referenceCol=o.colStart+Math.floor((o.colEnd-o.colStart)/2))}(t,e,i,r,n,s,l,a,this)}progress(){return e0(this,void 0,void 0,function*(){if(!this.isProgressing)return this.isProgressing=!0,new Promise((t,e)=>{setTimeout(()=>e0(this,void 0,void 0,function*(){this.isProgressing=!1,this.isRelease||(this.colUpdatePos<=this.colEnd?(yield this.updateColCellGroupsAsync(),yield this.progress()):this.rowUpdatePos<=this.rowEnd?(yield this.updateRowCellGroupsAsync(),yield this.progress()):this.currentCol<this.totalCol?(yield this.createCol(),yield this.progress()):this.currentRow<this.totalRow&&(yield this.createRow(),yield this.progress()),e$(this.table),this.table.scenegraph.updateNextFrame(),t())}),16)})})}createRow(){return e0(this,void 0,void 0,function*(){this.taskRowCount&&this.createRowCellGroup(this.taskRowCount)})}createCol(){return e0(this,void 0,void 0,function*(){this.taskColCount&&this.createColGroup(this.taskRowCount)})}createRowCellGroup(t){let e=Math.min(this.totalRow,this.currentRow+t);if("adaptive"!==this.table.heightMode&&(0,te.Y)(this.table,this.currentRow+1,e,!1),this.rowEnd=e,this.table.frozenColCount){let t=0;for(let i=0;i<this.table.frozenColCount;i++){let r=this.table.scenegraph.getColGroup(i),{height:n}=(this.table.isListTable(),eA(r,i,r.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));t=Math.max(t,n),this.table.scenegraph.rowHeaderGroup.setAttribute("height",t)}}if(this.table.rightFrozenColCount){let t=0;for(let i=this.table.colCount-this.table.rightFrozenColCount;i<this.table.colCount;i++){let r=this.table.scenegraph.getColGroup(i),{height:n}=(this.table.isPivotChart(),eA(r,i,r.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));t=Math.max(t,n),this.table.scenegraph.rightFrozenGroup.setAttribute("height",t)}}let i=0;for(let t=this.bodyLeftCol;t<=this.bodyRightCol;t++){let r=this.table.scenegraph.getColGroup(t);if(!r)continue;this.table.rowHeaderLevelCount;let{height:n}=eA(r,t,r.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table);i=Math.max(i,n)}this.table.scenegraph.bodyGroup.setAttribute("height",i),this.currentRow=e,this.rowUpdatePos=this.rowEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}createColGroup(t){let e=Math.min(this.totalCol,this.currentCol+t);"adaptive"!==this.table.widthMode&&(0,eC.rj)(this.table,this.currentCol+1,e),this.colEnd=e;for(let t=0;t<this.table.rowCount;t++){let e=this.highPerformanceGetCell(this.currentCol,t);"cell"===e.role&&(0,X.Z)(e.mergeStartCol)&&e.mergeStartCol>this.currentCol&&this.table.scenegraph.updateCellContent(e.col,e.row)}if(this.table.frozenRowCount){let t=this.table.scenegraph.colHeaderGroup.lastChild instanceof tf.Z?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev,i=t.attribute.x+t.attribute.width,r=t.attribute.y;eT(this.table.scenegraph.colHeaderGroup,i,r,this.currentCol+1,e,0,this.table.frozenRowCount-1,"columnHeader",this.table)}if(this.table.bottomFrozenRowCount){let t=this.table.scenegraph.bottomFrozenGroup.lastChild instanceof tf.Z?this.table.scenegraph.bottomFrozenGroup.lastChild:this.table.scenegraph.bottomFrozenGroup.lastChild._prev,i=t.attribute.x+t.attribute.width,r=t.attribute.y;eT(this.table.scenegraph.bottomFrozenGroup,i,r,this.currentCol+1,e,this.table.rowCount-this.table.bottomFrozenRowCount,this.table.rowCount-1,"columnHeader",this.table)}let i=this.table.scenegraph.bodyGroup.lastChild&&(this.table.scenegraph.bodyGroup.lastChild instanceof tf.Z?this.table.scenegraph.bodyGroup.lastChild:this.table.scenegraph.bodyGroup.lastChild._prev);i||(i=this.table.scenegraph.colHeaderGroup.lastChild&&(this.table.scenegraph.colHeaderGroup.lastChild instanceof tf.Z?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev));let r=i.attribute.x+i.attribute.width,n=i.attribute.y;eT(this.table.scenegraph.bodyGroup,r,n,this.currentCol+1,e,this.rowStart,this.rowEnd,"body",this.table),this.currentCol=e,this.colUpdatePos=this.colEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}setY(t,e=!1){return e0(this,void 0,void 0,function*(){let i=this.table.getRowsHeight(this.bodyTopRow,this.bodyTopRow+(this.rowEnd-this.rowStart+1))/2,r=this.table.getAllRowsHeight()-i,n=this.table.getTargetRowAt(t+this.table.scenegraph.colHeaderGroup.attribute.height);n&&(this.screenTopRow=n.row),t<i&&this.rowStart===this.bodyTopRow||t>r&&this.rowEnd===this.bodyBottomRow?(this.updateDeltaY(t),this.updateBody(t-this.deltaY)):this.table.scenegraph.bodyGroup.firstChild&&"group"===this.table.scenegraph.bodyGroup.firstChild.type&&0!==this.table.scenegraph.bodyGroup.firstChild.childrenCount||this.table.scenegraph.rowHeaderGroup.firstChild&&"group"===this.table.scenegraph.rowHeaderGroup.firstChild.type&&0!==this.table.scenegraph.rowHeaderGroup.firstChild.childrenCount?this.dynamicSetY(t,n,e):(this.updateDeltaY(t),this.updateBody(t-this.deltaY))})}setX(t,e=!1){return e0(this,void 0,void 0,function*(){let i=this.table.getColsWidth(this.bodyLeftCol,this.bodyLeftCol+(this.colEnd-this.colStart+1))/2,r=this.table.getAllColsWidth()-i,n=this.table.getTargetColAt(t+this.table.scenegraph.rowHeaderGroup.attribute.width);n&&(this.screenLeftCol=n.col),t<i&&this.colStart===this.bodyLeftCol||t>r&&this.colEnd===this.bodyRightCol||this.table.scenegraph.bodyGroup.firstChild&&"group"===this.table.scenegraph.bodyGroup.firstChild.type&&0===this.table.scenegraph.bodyGroup.firstChild.childrenCount?(this.updateDeltaX(t),this.table.scenegraph.setBodyAndColHeaderX(-t+this.deltaX)):this.dynamicSetX(t,n,e)})}dynamicSetY(t,e,i=!1){return e0(this,void 0,void 0,function*(){!function(t,e,i,r){ej(this,void 0,void 0,function*(){var n,s,l,a,o;if(!e)return;let h=e.row,u=e.top;if(n=i?r.bodyBottomRow-r.rowEnd:h-r.referenceRow,s=h,l=u,a=t,o=r,n>0?eG(n,"up",s,l,a,o):n<0&&eG(-n,"down",s,l,a,o),o.updateDeltaY(a,l,s),o.updateBody(a-o.deltaY),i){let e=r.table.scenegraph.highPerformanceGetCell(r.colStart,r.rowEnd,!0);if("cell"===e.role){let i=e.attribute.y+e.attribute.height-(r.table.tableNoFrameHeight-r.table.getFrozenRowsHeight()-r.table.getBottomFrozenRowsHeight())-t;r.deltaY=-i,r.updateBody(t-r.deltaY)}}})}(t,e,i,this)})}dynamicSetX(t,e,i=!1){return e0(this,void 0,void 0,function*(){!function(t,e,i,r){eI(this,void 0,void 0,function*(){var n,s,l,a,o;if(!e)return;let h=e.col,u=e.left;if(n=i?r.bodyRightCol-r.colEnd:r.screenLeftCol-r.referenceCol,s=h,l=u,a=t,o=r,n>0?eL(n,"left",o.screenLeftCol,l,a,o):n<0&&eL(-n,"right",o.screenLeftCol,l,a,o),o.updateDeltaX(a,l,s),o.table.scenegraph.setBodyAndColHeaderX(-a+o.deltaX),i){let e=r.table.scenegraph.getColGroup(r.colEnd);if(e){let i=e.attribute.x+e.attribute.width-(r.table.tableNoFrameWidth-r.table.getFrozenColsWidth()-r.table.getRightFrozenColsWidth())-t;r.deltaX=-i,r.table.scenegraph.setBodyAndColHeaderX(-t+r.deltaX)}}r.table.scenegraph.updateNextFrame()})}(t,e,i,this)})}updateBody(t){this.table.scenegraph.setBodyAndRowHeaderY(-t)}updateRowCellGroupsAsync(){return e0(this,void 0,void 0,function*(){this.updateCellGroups(this.taskRowCount)})}updateCellGroups(t){let e=Math.min(this.bodyBottomRow,this.rowUpdatePos+t);this.table.isAutoRowHeight(this.rowUpdatePos)&&(0,te.Y)(this.table,this.rowUpdatePos,e,!1),eZ(this.rowUpdatePos,e,this),this.table.isAutoRowHeight(this.rowUpdatePos)&&(eW(this.bodyLeftCol,this.bodyRightCol,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),eW(0,this.table.frozenColCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),eW(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0)),this.rowUpdatePos=e+1}updateBottomFrozenCellGroups(){let t=this.table.rowCount-this.table.bottomFrozenRowCount,e=this.table.rowCount-1;this.table.isAutoRowHeight(t)&&(0,te.Y)(this.table,t,e,!1),eZ(t,e,this),this.table.isAutoRowHeight(t)&&(eW(this.bodyLeftCol,this.bodyRightCol,t,e,this.table,this.rowUpdateDirection),eW(0,this.table.frozenColCount-1,t,e,this.table,this.rowUpdateDirection),eW(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,t,e,this.table,this.rowUpdateDirection))}updateRightFrozenCellGroups(){let t=this.table.colCount-this.table.rightFrozenColCount,e=this.table.colCount-1;"autoWidth"===this.table.widthMode&&(0,eC.rj)(this.table,t,e,!1),eH(t,e,this),this.table.isAutoRowHeight(this.rowStart)&&eP(t,e,this.table,this.colUpdateDirection)}updateColCellGroupsAsync(){return e0(this,void 0,void 0,function*(){this.updateColGroups(this.taskRowCount)})}updateColGroups(t){let e=Math.min(this.bodyRightCol,this.colUpdatePos+t);"autoWidth"===this.table.widthMode&&(0,eC.rj)(this.table,this.colUpdatePos,e),eH(this.colUpdatePos,e,this),this.colUpdatePos=e+1}updateCellGroupPosition(t,e,i){t.row=e,t.mergeStartCol=void 0,t.mergeStartRow=void 0,t.mergeEndCol=void 0,t.mergeEndRow=void 0,t.setAttribute("y",i),t.needUpdate=!0,t.needUpdateForAutoRowHeight=!0}updateCellGroupContent(t){if(!t.needUpdate||"cell"!==t.role)return t;let e=this.table.scenegraph.updateCellContent(t.col,t.row);return t.needUpdate=!1,e||t}sortCellVertical(){return e0(this,void 0,void 0,function*(){yield function(t){var e,i,r,n,s;return i=this,r=void 0,n=void 0,s=function*(){let i,r;t.table.scenegraph.bodyGroup.forEachChildren((t,e)=>{"group"===t.type&&(t.needUpdate=!0,null==t||t.forEachChildren(t=>{t.needUpdate=!0}))}),t.table.isAutoRowHeight(t.rowStart)?(i=t.rowStart,r=t.rowEnd):(i=Math.max(t.bodyTopRow,t.screenTopRow-t.screenRowCount),r=Math.min(t.bodyBottomRow,t.screenTopRow+2*t.screenRowCount,t.table.rowCount-1));let n=t.table.getAllRowsHeight();(0,te.Y)(t.table,i,r);let s=t.table.getAllRowsHeight();n!==s&&t.table.scenegraph.updateContainerHeight(t.table.frozenRowCount,s-n);for(let i=0;i<(null!=(e=t.table.frozenColCount)?e:0);i++){let e=t.table.scenegraph.getColGroup(i);null==e||e.setAttribute("chartInstance",void 0);for(let e=t.rowStart;e<=t.rowEnd;e++)t.table.scenegraph.updateCellContent(i,e);for(let e=t.table.rowCount-t.table.bottomFrozenRowCount;e<t.table.rowCount;e++)t.table.scenegraph.updateCellContent(i,e)}for(let e=t.colStart;e<=t.colEnd;e++){let i=t.table.scenegraph.getColGroup(e);null==i||i.setAttribute("chartInstance",void 0);for(let i=t.table.rowCount-t.table.bottomFrozenRowCount;i<t.table.rowCount;i++)t.table.scenegraph.updateCellContent(e,i)}for(let e=t.table.colCount-t.table.rightFrozenColCount;e<t.table.colCount;e++){let i=t.table.scenegraph.getColGroup(e);null==i||i.setAttribute("chartInstance",void 0);for(let i=t.rowStart;i<=t.rowEnd;i++)t.table.scenegraph.updateCellContent(e,i);for(let i=t.table.rowCount-t.table.bottomFrozenRowCount;i<t.table.rowCount;i++)t.table.scenegraph.updateCellContent(e,i)}eZ(i,r,t),t.table.isAutoRowHeight(i)&&eW(t.bodyLeftCol,t.bodyRightCol,i,r,t.table,t.rowEnd>t.bodyBottomRow-(t.rowEnd-t.rowStart+1)?"down":"up"),t.rowUpdatePos=t.rowStart,t.rowUpdateDirection=t.rowEnd>t.bodyBottomRow-(t.rowEnd-t.rowStart+1)?"down":"up",t.table.scenegraph.updateNextFrame(),t.table.isAutoRowHeight(t.rowStart)||(yield t.progress())},new(n||(n=Promise))(function(t,e){function l(t){try{o(s.next(t))}catch(t){e(t)}}function a(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(l,a)}o((s=s.apply(i,r||[])).next())})}(this)})}sortCellHorizontal(){return e0(this,void 0,void 0,function*(){yield function(t){var e,i,r,n;return e=this,i=void 0,r=void 0,n=function*(){t.table.scenegraph.bodyGroup.forEachChildren((t,e)=>{"group"===t.type&&(t.needUpdate=!0,null==t||t.forEachChildren(t=>{t.needUpdate=!0}))});let e=Math.max(t.bodyLeftCol,t.screenLeftCol-t.screenColCount),i=Math.min(t.bodyRightCol,t.screenLeftCol+2*t.screenColCount);(0,eC.rj)(t.table,e,i);for(let e=t.colStart;e<=t.colEnd;e++){let i=t.table.scenegraph.getColGroup(e);null==i||i.setAttribute("chartInstance",void 0);for(let i=t.table.rowCount-t.table.bottomFrozenRowCount;i<t.table.rowCount;i++)t.table.scenegraph.updateCellContent(e,i)}for(let e=t.table.colCount-t.table.rightFrozenColCount;e<t.table.colCount;e++){let i=t.table.scenegraph.getColGroup(e);null==i||i.setAttribute("chartInstance",void 0);for(let i=t.rowStart;i<=t.rowEnd;i++)t.table.scenegraph.updateCellContent(e,i);for(let i=t.table.rowCount-t.table.bottomFrozenRowCount;i<t.table.rowCount;i++)t.table.scenegraph.updateCellContent(e,i)}eH(e,i,t),t.colUpdatePos=t.colStart,t.colUpdateDirection=t.colEnd>t.bodyRightCol-(t.colEnd-t.colStart+1)?"right":"left",t.table.scenegraph.updateNextFrame(),yield t.progress()},new(r||(r=Promise))(function(t,s){function l(t){try{o(n.next(t))}catch(t){s(t)}}function a(t){try{o(n.throw(t))}catch(t){s(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(l,a)}o((n=n.apply(e,i||[])).next())})}(this)})}highPerformanceGetCell(t,e,i){if(e>=this.table.frozenRowCount&&e<this.table.rowCount-this.table.bottomFrozenRowCount&&(e<this.rowStart||e>this.rowEnd)||t>=this.table.frozenColCount&&t<this.table.colCount-this.table.rightFrozenColCount&&(t<this.colStart||t>this.colEnd))return ew;if(this.cellCache.get(t)){let r=this.cellCache.get(t);if((r._next||r._prev)&&Math.abs(r.row-e)<e){let n=function t(e,i){if(!e)return null;if(e.row===i)return e;let r=e._prev,n=e._next;return e.row>i&&r&&r.row===e.row-1?t(r,i):e.row<i&&n&&n.row===e.row+1?t(n,i):null}(r,e);return n&&(i||"shadow-cell"!==n.role)||(n=this.table.scenegraph.getCell(t,e,i)),n.row&&this.cellCache.set(t,n),n}let n=this.table.scenegraph.getCell(t,e,i);return n.col===t&&n.row&&this.cellCache.set(t,n),n}let r=this.table.scenegraph.getCell(t,e,i);return r.col===t&&r.row&&this.cellCache.set(t,r),r}updateDeltaY(t,e,i){if(this.rowStart===this.bodyTopRow){let t=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowStart,!0);if("cell"===t.role){let e=t.attribute.y;this.deltaY=-e}}else if(this.rowEnd===this.bodyBottomRow){let t=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowEnd,!0);if("cell"===t.role){let e=this.table.getRowHeight(this.rowEnd),i=t.attribute.y+e-(this.table.getAllRowsHeight()-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight());this.deltaY=-i}}else if((0,y.Z)(e)&&(0,y.Z)(i)){let r=this.table.scenegraph.highPerformanceGetCell(this.colStart,i,!0);"cell"!==r.role&&(r=this.table.scenegraph.highPerformanceGetCell(0,i,!0));let n=t-this.deltaY,s=e-n,l=r.attribute.y-n+this.table.getFrozenRowsHeight();this.deltaY=s-l}}updateDeltaX(t,e,i){if(this.colStart===this.bodyLeftCol){let t=this.table.scenegraph.getColGroup(this.colStart);if(t){let e=t.attribute.x;this.deltaX=-e}}else if(this.colEnd===this.bodyRightCol){let t=this.table.scenegraph.getColGroup(this.colEnd);if(t){let e=t.attribute.x+t.attribute.width-(this.table.getAllColsWidth()-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth());this.deltaX=-e}}else if((0,y.Z)(e)&&(0,y.Z)(i)){let r=this.table.scenegraph.getColGroup(i)||this.table.scenegraph.getColGroup(i,!0),n=t-this.deltaX,s=e-n,l=r.attribute.x-n+this.table.getFrozenColsWidth();this.deltaX=s-l}}release(){this.isRelease=!0}}var e2=i(35137);function e3(t){t.customSelectedRangeComponents.forEach((e,i)=>{e5(e,i,t)}),t.selectingRangeComponents.forEach((e,i)=>{e5(e,i,t)}),t.selectedRangeComponents.forEach((e,i)=>{e5(e,i,t)})}function e5(t,e,i){var r,n,s,l,a,o,h,u,d,c;let p=i.table,[g,f,m,y]=e.split("-"),v=parseInt(g,10),b=parseInt(f,10),_=parseInt(m,10),x=parseInt(y,10),C,w=v,S=b,A=_,M=x;switch(t.role){case"rowHeader":(C=p.getBodyVisibleRowRange())&&(S=Math.max(b,C.rowStart-1),M=Math.min(x,C.rowEnd+1));break;case"columnHeader":case"bottomFrozen":(C=p.getBodyVisibleCellRange())&&(w=Math.max(v,C.colStart-1),A=Math.min(_,C.colEnd+1));break;case"cornerHeader":case"rightTopCorner":case"leftBottomCorner":case"rightBottomCorner":break;case"rightFrozen":(C=p.getBodyVisibleCellRange())&&(S=Math.max(b,C.rowStart-1),M=Math.min(x,C.rowEnd+1));break;default:(C=p.getBodyVisibleCellRange())&&(S=Math.max(b,C.rowStart-1),M=Math.min(x,C.rowEnd+1),w=Math.max(v,C.colStart-1),A=Math.min(_,C.colEnd+1))}let k=p.getColsWidth(w,A),T=p.getRowsHeight(S,M),R=i.highPerformanceGetCell(w,S).globalAABBBounds;if(t.rect.setAttributes({x:R.x1-i.tableGroup.attribute.x,y:R.y1-i.tableGroup.attribute.y,width:k,height:T,visible:!0}),p.hasListeners(E.B.AFTER_UPDATE_SELECT_BORDER_HEIGHT)&&p.fireListeners(E.B.AFTER_UPDATE_SELECT_BORDER_HEIGHT,{startRow:S,endRow:M,currentHeight:T,selectComp:t}),t.fillhandle){let e=null==(r=i.table.options.excelOptions)?void 0:r.fillHandle,s,l,a=!0;"function"==typeof e&&(a=e({selectRanges:i.table.stateManager.select.ranges,table:i.table})),l=_<p.colCount-1?i.highPerformanceGetCell(_,x).globalAABBBounds.x2-i.tableGroup.attribute.x-3:0===v?i.highPerformanceGetCell(0,x).globalAABBBounds.x1-i.tableGroup.attribute.x:i.highPerformanceGetCell(v-1,x).globalAABBBounds.x2-i.tableGroup.attribute.x-3;let o=(x<p.rowCount-1?i.highPerformanceGetCell(_,x).globalAABBBounds:i.highPerformanceGetCell(_,b-1).globalAABBBounds).y2-i.tableGroup.attribute.y-3;null==(n=t.fillhandle)||n.setAttributes({x:l,y:o,width:6,height:6,visible:a})}let B=!!p.frozenColCount&&v===p.frozenColCount;!B&&p.frozenColCount&&p.scrollLeft>0&&v>=p.frozenColCount&&p.getColsWidth(0,v-1)-p.scrollLeft<p.getFrozenColsWidth()&&(B=!0);let P=!!p.rightFrozenColCount&&p.rightFrozenColCount>0&&_===p.colCount-p.rightFrozenColCount-1;!P&&p.rightFrozenColCount&&_<p.colCount-p.rightFrozenColCount&&p.getColsWidth(0,_)-p.scrollLeft>p.tableNoFrameWidth-p.getRightFrozenColsWidth()&&(P=!0);let I=!p.frozenRowCount||b===p.frozenRowCount;!I&&p.frozenRowCount&&p.scrollTop>0&&b>=p.frozenRowCount&&p.getRowsHeight(0,b-1)-p.scrollTop<p.getFrozenRowsHeight()&&(I=!0);let L=!!p.bottomFrozenRowCount&&x===p.rowCount-p.bottomFrozenRowCount-1;!L&&p.bottomFrozenRowCount&&x<p.rowCount-p.bottomFrozenRowCount&&p.getRowsHeight(0,x)-p.scrollTop>p.tableNoFrameHeight-p.getBottomFrozenRowsHeight()&&(L=!0);let{dynamicUpdateSelectionSize:F}=p.theme.selectionStyle;if(B&&(t.rect.attribute.stroke[3]||F)||P&&(t.rect.attribute.stroke[1]||F)||I&&(t.rect.attribute.stroke[0]||F)||L&&(t.rect.attribute.stroke[2]||F)){if(B&&t.rect.attribute.stroke[3]&&i.tableGroup.insertAfter(t.rect,"columnHeader"===t.role?i.cornerHeaderGroup:"bottomFrozen"===t.role?i.leftBottomCornerGroup:i.rowHeaderGroup),L&&t.rect.attribute.stroke[2]&&i.tableGroup.insertAfter(t.rect,"rowHeader"===t.role?i.leftBottomCornerGroup:"rightFrozen"===t.role?i.rightBottomCornerGroup:i.bottomFrozenGroup),I&&t.rect.attribute.stroke[0]&&i.tableGroup.insertAfter(t.rect,"rowHeader"===t.role?i.cornerHeaderGroup:"rightFrozen"===t.role?i.rightTopCornerGroup:i.colHeaderGroup),P&&t.rect.attribute.stroke[1]&&i.tableGroup.insertAfter(t.rect,"columnHeader"===t.role?i.rightTopCornerGroup:"bottomFrozen"===t.role?i.rightBottomCornerGroup:i.rightFrozenGroup),t.rect.attribute.x<p.getFrozenColsWidth()&&p.scrollLeft>0&&("body"===t.role||"columnHeader"===t.role||"bottomFrozen"===t.role)){let e=t.rect.attribute.width-(p.getFrozenColsWidth()-t.rect.attribute.x);t.rect.setAttributes({x:t.rect.attribute.x+(p.getFrozenColsWidth()-t.rect.attribute.x),width:e>0?e:0}),null==(s=t.fillhandle)||s.setAttributes({visible:e>0})}if(p.getRightFrozenColsWidth()>0&&i.rightFrozenGroup.attribute.height>0&&t.rect.attribute.x+t.rect.attribute.width>i.rightFrozenGroup.attribute.x&&("body"===t.role||"columnHeader"===t.role||"bottomFrozen"===t.role)){let e=i.rightFrozenGroup.attribute.x-t.rect.attribute.x;t.rect.setAttributes({x:t.rect.attribute.x,width:e>0?e:0}),null==(l=t.fillhandle)||l.setAttributes({visible:e-k>0})}if(t.rect.attribute.y<i.colHeaderGroup.attribute.height&&p.scrollTop>0&&("body"===t.role||"rowHeader"===t.role||"rightFrozen"===t.role)){let e=t.rect.attribute.height-(i.colHeaderGroup.attribute.height-t.rect.attribute.y);t.rect.setAttributes({y:t.rect.attribute.y+(i.colHeaderGroup.attribute.height-t.rect.attribute.y),height:e>0?e:0}),null==(a=t.fillhandle)||a.setAttributes({visible:e>0})}if(i.bottomFrozenGroup.attribute.width>0&&i.bottomFrozenGroup.attribute.height>0&&t.rect.attribute.y+t.rect.attribute.height>i.bottomFrozenGroup.attribute.y&&("body"===t.role||"rowHeader"===t.role||"rightFrozen"===t.role)){let e=i.bottomFrozenGroup.attribute.y-t.rect.attribute.y;t.rect.setAttributes({y:t.rect.attribute.y,height:e>0?e:0}),null==(o=t.fillhandle)||o.setAttributes({visible:e-T>0})}}else i.tableGroup.insertAfter(t.rect,"body"===t.role?i.bodyGroup:"columnHeader"===t.role?i.colHeaderGroup:"rowHeader"===t.role?i.rowHeaderGroup:"cornerHeader"===t.role?i.cornerHeaderGroup:"rightTopCorner"===t.role?i.rightTopCornerGroup:"rightFrozen"===t.role?i.rightFrozenGroup:"leftBottomCorner"===t.role?i.leftBottomCornerGroup:"bottomFrozen"===t.role?i.bottomFrozenGroup:i.rightBottomCornerGroup);let O=0;"number"==typeof t.rect.attribute.lineWidth&&(O=Math.ceil(t.rect.attribute.lineWidth/2)),_===p.colCount-1&&(Array.isArray(t.rect.attribute.lineWidth)&&(O=Math.ceil((null!=(h=t.rect.attribute.lineWidth[1])?h:0)/2)),t.rect.setAttributes({width:t.rect.attribute.width-O})),0===v&&(Array.isArray(t.rect.attribute.lineWidth)&&(O=Math.ceil((null!=(u=t.rect.attribute.lineWidth[3])?u:0)/2)),t.rect.setAttributes({x:t.rect.attribute.x+O,width:t.rect.attribute.width-O})),x===p.rowCount-1&&(Array.isArray(t.rect.attribute.lineWidth)&&(O=Math.ceil((null!=(d=t.rect.attribute.lineWidth[2])?d:0)/2)),t.rect.setAttributes({height:t.rect.attribute.height-O})),0===b&&(Array.isArray(t.rect.attribute.lineWidth)&&(O=Math.ceil((null!=(c=t.rect.attribute.lineWidth[0])?c:0)/2)),t.rect.setAttributes({y:t.rect.attribute.y+O,height:t.rect.attribute.height-O}))}function e4(t,e,i=!0){let r=t.table,n=e.start.col,s=e.start.row,l=e.end.col,a=e.end.row,o=e.skipBodyMerge,h=Math.max(Math.min(l,n),0),u=Math.max(Math.min(a,s),0),d=Math.min(Math.max(l,n),r.colCount-1),c=Math.min(Math.max(a,s),r.rowCount-1),p=()=>{let t=!1;for(let e=h;e<=d;e++){if(e===h)for(let i=u;i<=c;i++){if(!r.isHeader(e,i)&&o)continue;let n=(0,G.Z)(r,e,i);if(n&&n.start.col<h){h=n.start.col,t=!0;break}}if(!t&&e===d)for(let i=u;i<=c;i++){if(!r.isHeader(e,i)&&o)continue;let n=(0,G.Z)(r,e,i);if(n&&Math.min(n.end.col,r.colCount-1)>d){d=n.end.col,t=!0;break}}if(t)break}if(!t)for(let e=u;e<=c;e++){if(e===u)for(let i=h;i<=d;i++){if(!r.isHeader(i,e)&&o)continue;let n=(0,G.Z)(r,i,e);if(n&&n.start.row<u){u=n.start.row,t=!0;break}}if(!t&&e===c)for(let i=h;i<=d;i++){if(!r.isHeader(i,e)&&o)continue;let n=(0,G.Z)(r,i,e);if(n&&Math.min(n.end.row,r.rowCount-1)>c){c=n.end.row,t=!0;break}}if(t)break}t&&p()};i&&(p(),e.start.col>e.end.col?(e.start.col=Math.max(h,d),e.end.col=Math.min(h,d)):(e.start.col=Math.min(h,d),e.end.col=Math.max(h,d)),e.start.row>e.end.row?(e.start.row=Math.max(u,c),e.end.row=Math.min(u,c)):(e.start.row=Math.min(u,c),e.end.row=Math.max(u,c))),t.selectingRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),null==(i=t.fillhandle)||i.delete()}),t.selectingRangeComponents=new Map;let{needRowHeader:g,needRightRowHeader:f,needColumnHeader:m,needBottomColumnHeader:y,needBody:v,needCornerHeader:b,needRightTopCornerHeader:_,needLeftBottomCornerHeader:x,needRightBottomCornerHeader:C}=(0,e2.L)(h,u,d,c,r);if(b){let e=Math.min(d,r.frozenColCount-1),i=Math.min(c,r.frozenRowCount-1);t.createCellSelectBorder(h,u,e,i,"cornerHeader",`${h}${u}${d}${c}`,[!0,!m,!g,!0])}if(_){let e=Math.max(h,r.colCount-r.rightFrozenColCount),i=Math.min(c,r.frozenRowCount-1);t.createCellSelectBorder(e,u,d,i,"rightTopCorner",`${h}${u}${d}${c}`,[!0,!0,!f,!m])}if(x){let e=Math.min(d,r.frozenColCount-1),i=Math.max(u,r.rowCount-r.bottomFrozenRowCount);t.createCellSelectBorder(h,i,e,c,"leftBottomCorner",`${h}${u}${d}${c}`,[!g,!y,!0,!0])}if(C){let e=Math.max(h,r.colCount-r.rightFrozenColCount),i=Math.max(u,r.rowCount-r.bottomFrozenRowCount);t.createCellSelectBorder(e,i,d,c,"rightBottomCorner",`${h}${u}${d}${c}`,[!f,!0,!0,!y])}if(m){let e=Math.max(h,r.frozenColCount),i=Math.min(d,r.colCount-r.rightFrozenColCount-1),n=Math.min(c,r.frozenRowCount-1);t.createCellSelectBorder(e,u,i,n,"columnHeader",`${h}${u}${d}${c}`,[!0,!_,!v,!b])}if(y){let e=Math.max(h,r.frozenColCount),i=Math.min(d,r.colCount-r.rightFrozenColCount-1),n=Math.max(u,r.rowCount-r.bottomFrozenRowCount);t.createCellSelectBorder(e,n,i,c,"bottomFrozen",`${h}${u}${d}${c}`,[!v,!C,!0,!x])}if(g){let e=Math.max(u,r.frozenRowCount),i=Math.min(c,r.rowCount-r.bottomFrozenRowCount-1),n=Math.min(d,r.frozenColCount-1);t.createCellSelectBorder(h,e,n,i,"rowHeader",`${h}${u}${d}${c}`,[!b,!v,!x,!0])}if(f){let e=Math.max(u,r.frozenRowCount),i=Math.min(c,r.rowCount-r.bottomFrozenRowCount-1),n=Math.max(h,r.colCount-r.rightFrozenColCount);t.createCellSelectBorder(n,e,d,i,"rightFrozen",`${h}${u}${d}${c}`,[!_,!0,!C,!v])}if(v){let e=Math.max(h,r.frozenColCount),i=Math.max(u,r.frozenRowCount),n=Math.min(d,r.colCount-r.rightFrozenColCount-1),s=Math.min(c,r.rowCount-r.bottomFrozenRowCount-1);t.createCellSelectBorder(e,i,n,s,"body",`${h}${u}${d}${c}`,[!m,!f,!y,!g])}}function e6(t){t.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)}),t.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)})}function e8(t){t.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)}),t.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)})}function e9(t,e,i,r,n,s,l){if(!e)return;let a=Array.isArray(e)?e:[e,e,e,e],o=l.colCount-1,h=l.rowCount-1,u=[0,0,0,0],d=!1;return 0===i&&0===r?(u[0]=a[0],d=!0):n===o&&s===h?(u[2]=a[2],d=!0):0===i&&s===h?(u[3]=a[3],d=!0):n===o&&0===r&&(u[1]=a[1],d=!0),d?u:void 0}function e7(t){t.selectingRangeComponents.forEach((e,i)=>{var r;t.selectedRangeComponents.get(i)&&(t.selectingRangeComponents.get(i).rect.delete(),null==(r=t.selectingRangeComponents.get(i).fillhandle)||r.delete()),t.selectedRangeComponents.set(i,e)}),t.selectingRangeComponents=new Map,t.updateNextFrame()}function it(t){t.selectedRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),null==(i=t.fillhandle)||i.delete()}),t.selectedRangeComponents=new Map}function ie(t){t.selectingRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),null==(i=t.fillhandle)||i.delete()}),t.selectingRangeComponents=new Map}function ii(t,e){for(let i=0;i<e.table.colCount;i++){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(i),height:e.table.getRowHeight(t)});if(r.role="cell",r.col=i,r.row=t,r.needUpdate=!0,!r)continue;let n=e.getColGroup(i);if(n)if(n.firstChild&&t<n.firstChild.row)n.insertBefore(r,n.firstChild),n.firstChild.row=n.firstChild.row+1;else if(n.lastChild&&t>n.lastChild.row)n.appendChild(r);else{let s=e.highPerformanceGetCell(i,t,!0);s!==r&&(n.insertBefore(r,s),s&&(s.row=s.row+1),s!==n.lastChild&&n.lastChild&&(n.lastChild.row=n.lastChild.row+1))}}}function ir(t,e){for(let i=0;i<e.table.colCount;i++){let r,n=e.getColGroup(i,!1);n&&(n.forEachChildren(e=>e.row===t&&(r=e,!0)),r&&(n.updateColumnHeight(-r.attribute.height),n.removeChild(r)))}}function is(t,e,i){let r;for(let n=0;n<i.table.colCount;n++){let s,l=i.table.getCellRange(n,t);l.start.row<=t+1&&l.end.row>=t+1&&(ia(l,i),s=l.start.row);let a=i.table.getCellRange(n,e);a.start.row<=e+1&&a.end.row>=e+1&&(ia(a,i),s=a.start.row),(0,y.Z)(s)&&(r=(0,y.Z)(r)?Math.min(r,s):s)}return r}function il(t,e,i){let r;for(let n=0;n<i.table.colCount;n++){let s,l=i.highPerformanceGetCell(n,t);l.mergeStartRow&&l.mergeEndRow&&l.mergeEndRow>t&&(ia({start:{row:l.mergeStartRow,col:i.table.isAutoRowHeight(e)?0:l.mergeStartCol},end:{row:l.mergeEndRow,col:i.table.isAutoRowHeight(e)?i.table.colCount-1:l.mergeEndCol}},i),s=l.mergeStartRow);let a=i.highPerformanceGetCell(n,e);a.mergeStartRow&&a.mergeEndRow&&a.mergeStartRow<e&&(ia({start:{row:a.mergeStartRow,col:i.table.isAutoRowHeight(e)?0:a.mergeStartCol},end:{row:a.mergeEndRow,col:i.table.isAutoRowHeight(e)?i.table.colCount-1:a.mergeEndCol}},i),s=a.mergeStartRow),(0,y.Z)(s)&&(r=(0,y.Z)(r)?Math.min(r,s):s)}return r}function ia(t,e){let{start:i,end:r}=t;for(let t=i.col;t<=r.col;t++)for(let n=i.row;n<=r.row;n++){let i=e.highPerformanceGetCell(t,n,!0);i&&(i.needUpdate=!0)}}var io=i(75382);function ih(t){if(!t.table.reactCustomLayout)return;let{table:e,stage:i}=t,r=i.pluginService.findPluginsByName("ReactAttributePlugin")[0],{htmlMap:n,renderId:s}=r;for(let l in n){let a,o=n[l],{graphic:h,wrapContainer:u,renderId:d}=o;if(d===s){if(t.frozenColCount>e.frozenColCount){let i=(0,io.J$)(h);if(!i)continue;let{col:r,row:n}=i;n>=e.rowCount-e.bottomFrozenRowCount&&r<t.frozenColCount&&r>=e.frozenColCount&&h.attribute.react.container===e.frozenBottomDomContainer?a=e.bottomDomContainer:n>=e.frozenRowCount&&r<t.frozenColCount&&r>=e.frozenColCount&&h.attribute.react.container===e.frozenBodyDomContainer?a=e.bodyDomContainer:n<e.frozenRowCount&&r<t.frozenColCount&&r>=e.frozenColCount&&h.attribute.react.container===e.frozenHeaderDomContainer&&(a=e.headerDomContainer)}else if(t.frozenColCount<e.frozenColCount){let i=(0,io.J$)(h);if(!i)continue;let{col:r,row:n}=i;n>=e.rowCount-e.bottomFrozenRowCount&&r<e.frozenColCount&&r>=t.frozenColCount&&h.attribute.react.container===e.bottomDomContainer?a=e.frozenBottomDomContainer:n>=e.frozenRowCount&&r<e.frozenColCount&&r>=t.frozenColCount&&h.attribute.react.container===e.bodyDomContainer?a=e.frozenBodyDomContainer:n<e.frozenRowCount&&r<e.frozenColCount&&r>=t.frozenColCount&&h.attribute.react.container===e.headerDomContainer&&(a=e.frozenHeaderDomContainer)}a&&(a.appendChild(u),o.nativeContainer=a,o.container=a,h.attribute.react.container=a,r.updateStyleOfWrapContainer(h,i,u,a,h.attribute.react))}}}function iu(t){let e=t.bodyGroup.firstChild instanceof tf.Z?t.bodyGroup.firstChild:null;e&&(t.rowHeaderGroup.appendChild(e),t.rowHeaderGroup.setAttribute("width",t.rowHeaderGroup.attribute.width+e.attribute.width),t.bodyGroup.setAttribute("width",t.bodyGroup.attribute.width-e.attribute.width))}function id(t){let e=t.colHeaderGroup.firstChild instanceof tf.Z?t.colHeaderGroup.firstChild:null;e&&(t.cornerHeaderGroup.appendChild(e),t.cornerHeaderGroup.setAttribute("width",t.cornerHeaderGroup.attribute.width+e.attribute.width),t.colHeaderGroup.setAttribute("width",t.colHeaderGroup.attribute.width-e.attribute.width))}function ic(t){var e;let i=t.rowHeaderGroup.lastChild instanceof tf.Z?t.rowHeaderGroup.lastChild:null==(e=t.rowHeaderGroup.lastChild)?void 0:e._prev;i&&(iy(t.bodyGroup,i,t.bodyGroup.firstChild),t.bodyGroup.setAttribute("width",t.bodyGroup.attribute.width+i.attribute.width),t.rowHeaderGroup.setAttribute("width",t.rowHeaderGroup.attribute.width-i.attribute.width))}function ip(t){var e;let i=t.cornerHeaderGroup.lastChild instanceof tf.Z?t.cornerHeaderGroup.lastChild:null==(e=t.cornerHeaderGroup.lastChild)?void 0:e._prev;i&&(iy(t.colHeaderGroup,i,t.colHeaderGroup.firstChild),t.colHeaderGroup.setAttribute("width",t.colHeaderGroup.attribute.width+i.attribute.width),t.cornerHeaderGroup.setAttribute("width",t.cornerHeaderGroup.attribute.width-i.attribute.width))}function ig(t){let e=t.bottomFrozenGroup.firstChild instanceof tf.Z?t.bottomFrozenGroup.firstChild:null;e&&(t.leftBottomCornerGroup.appendChild(e),t.leftBottomCornerGroup.setAttribute("width",t.leftBottomCornerGroup.attribute.width+e.attribute.width),t.bottomFrozenGroup.setAttribute("width",t.bottomFrozenGroup.attribute.width-e.attribute.width),t.table.isPivotChart()&&e.forEachChildren(t=>{t.setAttributes({stroke:!1,fill:!1})}))}function im(t){var e;let i=t.leftBottomCornerGroup.lastChild instanceof tf.Z?t.leftBottomCornerGroup.lastChild:null==(e=t.leftBottomCornerGroup.lastChild)?void 0:e._prev;i&&(iy(t.bottomFrozenGroup,i,t.bottomFrozenGroup.firstChild),t.bottomFrozenGroup.setAttribute("width",t.bottomFrozenGroup.attribute.width+i.attribute.width),t.leftBottomCornerGroup.setAttribute("width",t.leftBottomCornerGroup.attribute.width-i.attribute.width),t.table.isPivotChart()&&i.forEachChildren(e=>{var i,r,n,s;let l=t.table._getCellStyle(e.col,e.row),a=t.table.getCellRange(e.col,e.row),o=(0,Z.RT)(l,t.table,a?a.start.col:e.col,a?a.start.row:e.row,Y.WJ).theme;e.setAttributes({fill:null!=(r=null==(i=null==o?void 0:o.group)?void 0:i.fill)?r:void 0,stroke:null!=(s=null==(n=null==o?void 0:o.group)?void 0:n.stroke)?s:void 0})}))}function iy(t,e,i){e&&t&&(i?t.insertBefore(e,i):t.appendChild(e))}function iv(t){return t instanceof tf.Z&&"table-border-rect"!==(null==t?void 0:t.name)}var ib=i(92581);function i_(t,e,i){return new tf.Z({x:0,y:0,width:t,height:e,clip:null!=i&&i,pickable:!1})}function ix(t,e){return t.forEachChildrenSkipChild((t,i)=>{t.setAttribute("x",e),e+=t.attribute.width}),e}function iC(t,e){return t.forEachChildrenSkipChild((t,i)=>{t.setAttribute("y",e),e+=t.attribute.height}),e}var iw=i(56306);function iS(t,e,i,r,n){let s=t.name;iM(i,r,t=>t.name===s,t=>{(0,Q.Bg)(e,t),t.name=e.name},n),n.updateNextFrame()}function iA(t,e,i){t&&"empty"!==t.role&&t.forEachChildren(t=>{"group"===t.type?iA(t,e,i):e(t)&&i(t)})}function iM(t,e,i,r,n){let s=n.getCell(t,e);if("cell"===s.role&&(0,y.Z)(s.mergeStartCol)&&(0,y.Z)(s.mergeStartRow)&&(0,y.Z)(s.mergeEndCol)&&(0,y.Z)(s.mergeEndRow)){let{colStart:t,colEnd:e,rowStart:l,rowEnd:a}=(0,ti.e)(s,n);for(let s=t;s<=e;s++)for(let t=l;t<=a;t++)iA(n.highPerformanceGetCell(s,t),i,r)}else iA(s,i,r)}function ik(t,e){let{bgColor:i,borderColor:r,borderLineWidth:n,borderLineDash:s}=e,l={x:0,y:0,width:0,height:0,visible:!1,pickable:!0,fill:i};return l.stroke=tB(r,void 0),l.lineWidth=n,s&&(l.lineDash=s),l.lineCap="butt",Array.isArray(r)&&(l.strokeArrayColor=(0,J.u)(r)),Array.isArray(n)&&(l.strokeArrayWidth=(0,J.u)(n),l.lineWidth=1),t.setAttributes(l),t.role="corner-frozen",t}function iT(t){let e=[];for(let i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}function iR(t){let e=t.bodyColStart;function i(i){i.col=e;let r=(0,G.Z)(t.table,i.col,i.row);r&&(i.mergeStartCol=r.start.col,i.mergeStartCol=r.start.col,i.mergeEndCol=r.end.col,i.mergeEndCol=r.end.col),i.role}t.bodyGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{i(t)}),e++}),e=t.bodyColStart,t.colHeaderGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{i(t)}),e++}),e=t.bodyColStart,t.bottomFrozenGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{i(t)}),e++})}function iB(t,e){if(e.colHeaderGroup&&e.table.columnHeaderLevelCount>0){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(t),height:0,clip:!1,pickable:!1});r.role="column",r.col=t;let n=e.getColGroup(t,!0);n?e.colHeaderGroup.insertBefore(r,n):e.colHeaderGroup.appendChild(r),i(r,t,0,e.table.columnHeaderLevelCount-1)}if(e.bodyGroup){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(t),height:0,clip:!1,pickable:!1});r.role="column",r.col=t;let n=e.getColGroup(t,!1);n?e.bodyGroup.insertBefore(r,n):e.bodyGroup.appendChild(r),i(r,t,e.bodyRowStart,e.bodyRowEnd)}if(e.bottomFrozenGroup&&e.table.bottomFrozenRowCount>0){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(t),height:0,clip:!1,pickable:!1});r.role="column",r.col=t;let n=e.getColGroupInBottom(t);n?e.bottomFrozenGroup.insertBefore(r,n):e.bottomFrozenGroup.appendChild(r),i(r,t,e.table.rowCount-e.table.bottomFrozenRowCount,e.table.rowCount-1)}function i(t,i,r,n){for(let s=r;s<=n;s++){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(i),height:e.table.getRowHeight(s)});r.role="cell",r.col=i,r.row=s,r.needUpdate=!0,t.appendChild(r)}}}(0,H.sTO)(),z.n.load(ex),z.n.load(ev.ZP);class iP{constructor(t){var e;let i,r;this._needUpdateContainer=!1,this.table=t,this.hasFrozen=!1,this.clear=!0,this.mergeMap=new Map,(0,iw.C)(this.table.theme.textPopTipStyle),"node"===k.X.mode?(W.rF.setEnv("node",t.options.modeParams),i=t.canvasWidth,r=t.canvasHeight):t.options.canvas&&t.options.viewBox?(W.rF.setEnv("browser"),i=t.options.viewBox.x2-t.options.viewBox.x1,r=t.options.viewBox.y2-t.options.viewBox.y1):(W.rF.setEnv("browser"),i=t.canvas.width,r=t.canvas.height),this.stage=(e=Object.assign({canvas:t.canvas,width:i,height:r,disableDirtyBounds:!1,background:t.theme.underlayBackgroundColor,dpr:t.internalProps.pixelRatio,enableLayout:!0,beforeRender:t=>{this.table.options.beforeRender&&this.table.options.beforeRender(t),this.table.animationManager.ticker.start()},afterRender:t=>{this.table.options.afterRender&&this.table.options.afterRender(t),this.table.fireListeners("after_render",null)},canvasControled:!t.options.canvas,viewBox:t.options.viewBox},t.options.renderOption),new N.H(e)),this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph(),this.stage.defaultLayer.add(this.tableGroup),this.stage.table=this.table,this.createComponent()}get width(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.width)?e:0}get height(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.height)?e:0}get x(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.x)?e:0}get y(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.y)?e:0}get bodyRowStart(){var t;return null!=(t=this.proxy.rowStart)?t:0}get bodyRowEnd(){var t;return null!=(t=this.proxy.rowEnd)?t:this.table.rowCount-1}get bodyColStart(){var t;return null!=(t=this.proxy.colStart)?t:0}get bodyColEnd(){var t;return null!=(t=this.proxy.colEnd)?t:this.table.colCount-1}initSceneGraph(){this.isPivot=this.table.isPivotTable(),function(t){let e=t.table.tableNoFrameWidth,i=t.table.tableNoFrameHeight;t.tableGroup=new tf.Z({x:0,y:0,width:e,height:i,clip:!0,pickable:!1}),t.tableGroup.role="table";let r=i_(0,0,!t.table.internalProps.enableTreeStickCell);r.role="col-header",t.colHeaderGroup=r;let n=i_(0,0,!t.table.options.enableTreeStickCell);n.role="corner-header",t.cornerHeaderGroup=n;let s=i_(0,0,!0);s.role="row-header",t.rowHeaderGroup=s;let l=i_(e,0,!0);l.role="body",t.bodyGroup=l;let a=i_(0,0,!0);a.role="right-frozen",t.rightFrozenGroup=a;let o=i_(0,0,!0);o.role="bottom-frozen",t.bottomFrozenGroup=o;let h=i_(0,0);h.role="component",t.componentGroup=h;let u=i_(0,0,!0);u.role="corner-right-top-header",t.rightTopCornerGroup=u;let d=i_(0,0,!0);d.role="corner-right-bottom-header",t.rightBottomCornerGroup=d;let c=i_(0,0,!0);c.role="corner-left-bottom-header",t.leftBottomCornerGroup=c,t.tableGroup.addChild(l),t.tableGroup.addChild(s),t.tableGroup.addChild(o),t.tableGroup.addChild(r),t.tableGroup.addChild(a),t.tableGroup.addChild(d),t.tableGroup.addChild(u),t.tableGroup.addChild(c),t.tableGroup.addChild(n),t.tableGroup.addChild(h)}(this)}canvasShowMenu(){this.stage.addEventListener("rightdown",t=>{let e=(0,io.RJ)(t);e.eventArgs||(this.table.stateManager.triggerContextMenu(-1,-1,e.abstractPos.x,e.abstractPos.y),this.table.fireListeners(E.B.CONTEXTMENU_CANVAS,{event:t,x:e.abstractPos.x,y:e.abstractPos.y,col:-1,row:-1,target:void 0}))})}clearCells(){var t,e;this.table.animationManager.clear(),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.findPluginsByName("poptipForText").forEach(t=>{t.deactivate(this.stage.pluginService)}),this.clear=!0,this.hasFrozen=!1,this.mergeMap.clear(),this.colHeaderGroup.clear(),delete this.colHeaderGroup.border,this.rowHeaderGroup.clear(),delete this.rowHeaderGroup.border,this.cornerHeaderGroup.clear(),delete this.cornerHeaderGroup.border,this.bodyGroup.clear(),delete this.bodyGroup.border,this.bottomFrozenGroup.clear(),delete this.bottomFrozenGroup.border,this.rightFrozenGroup.clear(),delete this.rightFrozenGroup.border,this.rightTopCornerGroup.clear(),delete this.rightTopCornerGroup.border,this.rightBottomCornerGroup.clear(),delete this.rightBottomCornerGroup.border,this.leftBottomCornerGroup.clear(),delete this.leftBottomCornerGroup.border,this.colHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rowHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.cornerHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bodyGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bottomFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightTopCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.leftBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.rightBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:0,height:0}),this.tableGroup.border&&(this.tableGroup.parent.removeChild(this.tableGroup.border),delete this.tableGroup.border),null==(t=this.proxy)||t.release(),null==(e=this.table.reactCustomLayout)||e.clearCache()}updateStageBackground(){this.stage.background=this.table.theme.underlayBackgroundColor,this.stage.renderNextFrame()}createComponent(){this.component=new tM(this.table),this.component.addToGroup(this.componentGroup),this.selectedRangeComponents=new Map,this.selectingRangeComponents=new Map,this.customSelectedRangeComponents=new Map}updateComponent(){this.component.updateStyle()}createSceneGraph(t=!1){t||(this.table.rowHeightsMap.clear(),this.table.internalProps.layoutMap.clearCellRangeMap()),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.autoEnablePlugins.getContributions().forEach(t=>{"poptipForText"===t.name&&this.stage.pluginService.register(t)}),this.clear=!1,this.frozenColCount=this.table.frozenColCount,this.frozenRowCount=this.table.frozenRowCount,this.proxy=new e1(this.table),tT(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0,!0),this.table.isPivotChart()&&(ik(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle||this.table.theme.cornerHeaderStyle||{}),ik(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle||this.table.theme.cornerHeaderStyle||{}),ik(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle||this.table.theme.cornerHeaderStyle||{})),this.proxy.createGroupForFirstScreen(this.cornerHeaderGroup,this.colHeaderGroup,this.rowHeaderGroup,this.rightFrozenGroup,this.bottomFrozenGroup,this.bodyGroup,0,0),this.afterScenegraphCreated()}renderSceneGraph(){this.stage.render()}getCell(t,e,i){var r,n,s,l,a,o;let h;if((h=this.table.rightFrozenColCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e<this.table.frozenRowCount?null==(r=this.rightTopCornerGroup.getColGroup(t))?void 0:r.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<this.table.frozenColCount?null==(n=this.leftBottomCornerGroup.getColGroup(t))?void 0:n.getRowGroup(e):this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e>=this.table.rowCount-this.table.bottomFrozenRowCount?null==(s=this.rightBottomCornerGroup.getColGroup(t))?void 0:s.getRowGroup(e):this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?null==(l=this.rightFrozenGroup.getColGroup(t))?void 0:l.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>this.table.rowCount-1-this.table.bottomFrozenRowCount?null==(a=this.bottomFrozenGroup.getColGroup(t))?void 0:a.getRowGroup(e):null==(o=this.getColGroup(t,e<this.frozenRowCount))?void 0:o.getRowGroup(e))&&"shadow-cell"===h.role&&!i){let i=this.table.getCellRange(t,e);i.start.col===t&&i.start.row===e||(h=this.getCell(i.start.col,i.start.row))}return h||ew}highPerformanceGetCell(t,e,i){return this.proxy.highPerformanceGetCell(t,e,i)}getColGroup(t,e=!1){return(t<this.frozenColCount&&e?this.cornerHeaderGroup.getColGroup(t):t<this.frozenColCount?this.rowHeaderGroup.getColGroup(t):e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightTopCornerGroup.getColGroup(t):!e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightFrozenGroup.getColGroup(t):e?this.colHeaderGroup.getColGroup(t):this.bodyGroup.getColGroup(t))||void 0}getColGroupInBottom(t,e=!1){var i;if(e){let e=null!=(i=this.getColGroupInLeftBottomCorner(t))?i:this.getColGroupInRightBottomCorner(t);if(e)return e}if(this.table.bottomFrozenRowCount>0)return this.bottomFrozenGroup.getColGroup(t)}getColGroupInLeftBottomCorner(t){if(this.table.bottomFrozenRowCount>0)return this.leftBottomCornerGroup.getColGroup(t)}getColGroupInRightTopCorner(t){if(this.table.rightFrozenColCount>0)return this.rightTopCornerGroup.getColGroup(t)}getColGroupInRightBottomCorner(t){if(this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0)return this.rightBottomCornerGroup.getColGroup(t)}getCellSize(t,e){let i=this.getCell(t,e),r=(0,G.Z)(this.table,t,e),n=i.attribute.width,s=i.attribute.height;return r&&(n/=r.end.col-r.start.col+1,s/=r.end.row-r.start.row+1),{width:n,height:s}}updateNextFrame(){this.updateContainerSync(),this.resetAllSelectComponent(),this.stage.renderNextFrame()}resetAllSelectComponent(){var t,e,i,r;((null==(e=null==(t=this.table.stateManager.select)?void 0:t.ranges)?void 0:e.length)>0||(null==(r=null==(i=this.table.stateManager.select)?void 0:i.customSelectRanges)?void 0:r.length)>0)&&e3(this)}hideHoverIcon(t,e){-1!==t&&-1!==e&&(iM(t,e,t=>"mouseenter_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",0);let e=t.parent.getChildByName("icon-back");e&&e.setAttribute("visible",!1)},this),this.updateNextFrame())}showHoverIcon(t,e){-1!==t&&-1!==e&&(iM(t,e,t=>"mouseenter_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",1)},this),this.updateNextFrame())}hideClickIcon(t,e){-1!==t&&-1!==e&&(iM(t,e,t=>"click_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",0)},this),this.updateNextFrame())}showClickIcon(t,e){-1!==t&&-1!==e&&(iM(t,e,t=>"click_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",1)},this),this.updateNextFrame())}getIcon(t,e,i,r){let n;return this.getCell(t,e).forEachChildren(t=>{t.role&&t.role.startsWith("icon")&&t.containsPoint(i,r,tU.LZ.GLOBAL)&&(n=t)}),n}setIconHoverStyle(t,e,i,r){!function(t,e,i,r,n){var s,l;if((t.attribute.backgroundColor||t.attribute.hoverImage)&&iM(e,i,e=>e.name===t.name,t=>{var e,i,r,n,s,l,a,o;if(t.attribute.backgroundColor){let h=t.parent.getChildByName("icon-back");h?h.setAttributes({x:(null!=(e=t.attribute.x)?e:0)+(t.AABBBounds.width()-t.backgroundWidth)/2,y:(null!=(i=t.attribute.y)?i:0)+(t.AABBBounds.height()-t.backgroundHeight)/2,dx:null!=(r=t.attribute.dx)?r:0,dy:null!=(n=t.attribute.dy)?n:0,width:t.backgroundWidth,height:t.backgroundHeight,fill:t.attribute.backgroundColor,cornerRadius:5,visible:!0}):(h=(0,tc.f)({x:(null!=(s=t.attribute.x)?s:0)+(t.AABBBounds.width()-t.backgroundWidth)/2,y:(null!=(l=t.attribute.y)?l:0)+(t.AABBBounds.height()-t.backgroundHeight)/2,dx:null!=(a=t.attribute.dx)?a:0,dy:null!=(o=t.attribute.dy)?o:0,width:t.backgroundWidth,height:t.backgroundHeight,fill:t.attribute.backgroundColor,cornerRadius:5,pickable:!1,visible:!0})).name="icon-back",t.parent.insertBefore(h,t)}t.attribute.hoverImage&&t.attribute.image!==t.attribute.hoverImage&&(t.image=t.attribute.hoverImage)},n),t.tooltip){let{x1:r,x2:a,y1:o,y2:h}=t.globalAABBBounds,u={content:t.tooltip.title,referencePosition:{rect:{left:r,right:a,top:o,bottom:h,width:t.globalAABBBounds.width(),height:t.globalAABBBounds.height()},placement:t.tooltip.placement},disappearDelay:t.tooltip.disappearDelay,style:Object.assign({},null==(s=n.table.internalProps.theme)?void 0:s.tooltipStyle,null==(l=t.tooltip)?void 0:l.style)};n.table.internalProps.tooltipHandler.isBinded(u)||n.table.showTooltip(e,i,u)}}(t,e,i,0,this)}updateSortIcon(t){let{col:e,row:i,iconMark:r,order:n,oldSortCol:s,oldSortRow:l,oldIconMark:a}=t;!function(t){let{col:e,row:i,iconMark:r,order:n,oldSortCol:s,oldSortRow:l,oldIconMark:a,scene:o}=t,h=o.table.internalProps.headerHelper.getSortIcon(n,o.table,e,i);if(r&&iS(r,h,e,i,o),!function(t,e,i,r,n){let s=n.getCellRange(t,e),l=n.getCellRange(i,r);return s.start.col===l.start.col&&s.start.row===l.start.row&&s.end.col===l.end.col&&s.end.row===l.end.row}(e,i,s,l,o.table)){let t=o.table.internalProps.headerHelper.getSortIcon("normal",o.table,s,l);a?iS(a,t,s,l,o):function(t,e,i,r){let n=r.getCell(t,e);if((0,y.Z)(n.mergeStartCol)&&(0,y.Z)(n.mergeStartRow)&&(0,y.Z)(n.mergeEndCol)&&(0,y.Z)(n.mergeEndRow))for(let t=n.mergeStartCol;t<=n.mergeEndCol;t++)for(let e=n.mergeStartRow;e<=n.mergeEndRow;e++){let n;r.getCell(t,e).forEachChildren(t=>"sort"===t.attribute.funcType&&(n=t,!0)),n&&((0,Q.Bg)(i,n),n.name=i.name)}else{let t;(0,O.yW)(n,"children",e=>"sort"===e.attribute.funcType&&(t=e,!0)),t&&((0,Q.Bg)(i,t),t.name=i.name)}}(s,l,t,o)}}({col:e,row:i,iconMark:r,order:n,oldSortCol:s,oldSortRow:l,oldIconMark:a,scene:this})}updateFrozenIcon(t,e){var i=this;for(let t=0;t<i.table.colCount;t++)for(let e=0;e<i.table.columnHeaderLevelCount;e++)iM(t,e,t=>"frozen"===t.attribute.funcType,r=>{let n=i.table.internalProps.headerHelper.getFrozenIcon(t,e);(0,Q.Bg)(n,r),r.name=n.name},i)}updateHierarchyIcon(t,e){let i;i=this.table.isHeader(t,e)?this.table.internalProps.headerHelper.getHierarchyIcon(t,e):this.table.internalProps.bodyHelper.getHierarchyIcon(t,e),iM(t,e,t=>t.attribute.funcType===j.cI.collapse||t.attribute.funcType===j.cI.expand,t=>{(0,Q.Bg)(i,t),t.name=null==i?void 0:i.name},this)}setIconNormalStyle(t,e,i){(t.attribute.backgroundColor||t.attribute.hoverImage)&&iM(e,i,e=>e.name===t.name,t=>{let e=t.parent.getChildByName("icon-back");e&&e.setAttribute("visible",!1),t.attribute.hoverImage&&t.attribute.image!==t.attribute.originImage&&(t.image=t.attribute.originImage)},this)}residentHoverIcon(t,e){iM(t,e,t=>t.attribute.funcType===j.cI.dropDown,t=>{t.oldVisibleTime=t.attribute.visibleTime,t.setAttribute("visibleTime","always"),t.setAttribute("opacity",1)},this)}resetResidentHoverIcon(t,e){iM(t,e,t=>t.attribute.funcType===j.cI.dropDown,t=>{t.oldVisibleTime&&t.setAttribute("visibleTime",t.oldVisibleTime),t.setAttribute("opacity",+("always"===t.attribute.visibleTime))},this)}deactivateChart(t,e){var i,r;if(-1===t||-1===e)return;let n=this.getCell(t,e);null==(r=null==(i=null==n?void 0:n.firstChild)?void 0:i.deactivate)||r.call(i)}activateChart(t,e){var i,r,n;if(-1===t||-1===e)return;let s=this.getCell(t,e);return null==(r=null==(i=null==s?void 0:s.firstChild)?void 0:i.activate)||r.call(i,this.table),null==(n=null==s?void 0:s.firstChild)?void 0:n.activeChartInstance}removeInteractionBorder(t,e){let i=this.getCell(t,e);i.setAttribute("highlightStroke",void 0),i.setAttribute("highlightStrokeArrayWidth",void 0),i.setAttribute("highlightStrokeArrayColor",void 0)}createCellSelectBorder(t,e,i,r,n,s,l){!function(t,e,i,r,n,s,l,a){var o,h,u,d,c,p,g,f,m;let y,v=!!(null==(o=t.table.options.excelOptions)?void 0:o.fillHandle);if((null==(h=t.table.stateManager.select.ranges)?void 0:h.length)>1)v=!1,t.removeFillHandleFromSelectComponents();else if(1===(null==(u=t.table.stateManager.select.ranges)?void 0:u.length)){let e=Math.max(t.table.stateManager.select.ranges[0].start.row,t.table.stateManager.select.ranges[0].end.row),i=Math.max(t.table.stateManager.select.ranges[0].start.col,t.table.stateManager.select.ranges[0].end.col);t.table.isHeader(i,e)&&(v=!1)}Array.isArray(a)&&(!1===a[1]||!1===a[2])&&(v=!1);let b=Math.min(e,r),_=Math.min(i,n),x=Math.max(e,r),C=Math.max(i,n),w=t.highPerformanceGetCell(b,_).globalAABBBounds,S=t.highPerformanceGetCell(x,C).globalAABBBounds,A=t.table.theme,M=null==(d=A.selectionStyle)?void 0:d.cellBorderColor,k=null==(c=A.selectionStyle)?void 0:c.cellBorderLineWidth,T=(0,tc.f)({pickable:!1,fill:"replace"!==(null==(p=A.selectionStyle)?void 0:p.selectionFillMode)&&(null!=(f=null==(g=A.selectionStyle)?void 0:g.cellBgColor)?f:"rgba(0, 0, 255,0.1)"),lineWidth:k,stroke:a.map(t=>!!t&&M),x:w.x1-t.tableGroup.attribute.x,y:w.y1-t.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:e9(s,null==(m=t.table.theme.frameStyle)?void 0:m.cornerRadius,e,i,r,n,t.table)});v&&(y=(0,tc.f)({pickable:!1,fill:M,stroke:M,x:S.x2-3,y:S.y2-3,width:6,height:6,visible:!0})),t.lastSelectId=l,t.selectingRangeComponents.set(`${b}-${_}-${x}-${C}-${l}`,{rect:T,fillhandle:y,role:s}),t.tableGroup.insertAfter(T,"body"===s?t.bodyGroup:"columnHeader"===s?t.colHeaderGroup:"rowHeader"===s?t.rowHeaderGroup:"cornerHeader"===s?t.cornerHeaderGroup:"rightTopCorner"===s?t.rightTopCornerGroup:"rightFrozen"===s?t.rightFrozenGroup:"leftBottomCorner"===s?t.leftBottomCornerGroup:"bottomFrozen"===s?t.bottomFrozenGroup:t.rightBottomCornerGroup),v&&t.tableGroup.insertAfter(y,"body"===s?t.bodyGroup:"columnHeader"===s?t.colHeaderGroup:"rowHeader"===s?t.rowHeaderGroup:"cornerHeader"===s?t.cornerHeaderGroup:"rightTopCorner"===s?t.rightTopCornerGroup:"rightFrozen"===s?t.rightFrozenGroup:"leftBottomCorner"===s?t.leftBottomCornerGroup:"bottomFrozen"===s?t.bottomFrozenGroup:t.rightBottomCornerGroup)}(this,t,e,i,r,n,s,l)}moveSelectingRangeComponentsToSelectedRangeComponents(){e7(this)}deleteLastSelectedRangeComponents(){var t;t=this,t.selectedRangeComponents.forEach((e,i)=>{var r;i.split("-")[4]===t.lastSelectId&&(e.rect.delete(),null==(r=e.fillhandle)||r.delete(),t.selectedRangeComponents.delete(i))})}deleteAllSelectBorder(){it(this),ie(this)}updateCellSelectBorder(t,e=!0){e4(this,t,e)}removeFillHandleFromSelectComponents(){this.selectedRangeComponents.forEach((t,e)=>{var i;null==(i=t.fillhandle)||i.delete(),t.fillhandle=void 0})}recreateAllSelectRangeComponents(){it(this),this.table.stateManager.select.ranges.forEach(t=>{e4(this,t),e7(this)})}updateColWidth(t,e,i,r){(function(t,e,i,r){r||t.table._setColWidth(e,t.table.getColWidth(e)+i,!0);let n=t.getColGroup(e,!0),s=t.getColGroupInRightTopCorner(e);n&&!s&&ta(n,i,"col-corner",t),s&&ta(s,i,"right-top",t);let l=t.getColGroup(e);l&&ta(l,i,"row-body",t);let a=t.getColGroupInLeftBottomCorner(e);a&&ta(a,i,"left-bottom",t);let o=t.getColGroupInBottom(e);o&&ta(o,i,"bottom",t);let h=t.getColGroupInRightBottomCorner(e);h&&ta(h,i,"right-bottom",t),e<t.frozenColCount?(t.cornerHeaderGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)}),t.rowHeaderGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)})):(t.colHeaderGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)}),t.bodyGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)})),a&&t.leftBottomCornerGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)}),o&&t.bottomFrozenGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)}),h&&t.rightBottomCornerGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)})})(this,t,Math.round(e),r),i||this.updateContainer({async:!0})}updateChartSizeForResizeColWidth(t){(0,ib.s9)(this,t)}updateChartSizeForResizeRowHeight(t){(0,ib.kl)(this,t)}updateChartState(t){this.table.isPivotChart()&&(0,ib.s8)(this,t)}updateCheckboxCellState(t,e,i){var r,n;if(this.table.transpose)null==(r=this.bodyGroup.children)||r.forEach(t=>{var r;null==(r=t.getChildAt(e))||r.getChildren().forEach(t=>{"checkbox"===t.name&&("indeterminate"===i?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",i))),"checkbox-content"===t.name&&("indeterminate"===i?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})});else{let e=this.getColGroup(t);null==(n=null==e?void 0:e.children)||n.forEach(t=>{t.getChildren().find(t=>{"checkbox"===t.name&&("indeterminate"===i?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",i))),"checkbox-content"===t.name&&("indeterminate"===i?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}}updateHeaderCheckboxCellState(t,e,i){var r,n;this.table.transpose?null==(r=this.rowHeaderGroup.children)||r.forEach(t=>{t.getChildAt(e).getChildren().forEach(t=>{"checkbox"===t.name&&("indeterminate"===i?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",i))),"checkbox-content"===t.name&&("indeterminate"===i?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})}):null==(n=this.getColGroup(t,!0).children)||n.forEach(t=>{t.getChildren().find(t=>{"checkbox"===t.name&&("indeterminate"===i?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",i))),"checkbox-content"===t.name&&("indeterminate"===i?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}updateAutoColWidth(t){this.table.internalProps._widthResizedColMap.delete(t);let e=this.table.getColWidth(t),i=(0,eC.al)(t,0,this.table.rowCount-1,this.table,!0);i!==e&&this.updateColWidth(t,i-e)}recalculateColWidths(){let t=this.table;"adaptive"===t.widthMode||t.autoFillWidth||t.internalProps.transpose?(0,eC.rj)(this.table,0,this.table.colCount-1,!0):(t._clearColRangeWidthsMap(),t.frozenColCount>0&&(0,eC.rj)(this.table,0,t.frozenColCount-1,!0),t.rightFrozenColCount>0&&(0,eC.rj)(this.table,t.rightFrozenColCount,t.colCount-1,!0),(0,eC.rj)(t,this.proxy.colStart,this.proxy.colEnd,!0))}recalculateRowHeights(){let t=this.table;t.internalProps.useOneRowHeightFillAll=!1,"adaptive"===t.heightMode||t.autoFillHeight?(0,te.Y)(this.table,0,this.table.rowCount-1,!0,!0):(t.frozenRowCount>0&&(0,te.Y)(this.table,0,t.frozenRowCount-1,!0,!0),t.bottomFrozenRowCount>0&&(0,te.Y)(this.table,t.bottomFrozenRowCount,t.rowCount-1,!0,!0),(0,te.Y)(t,this.proxy.rowStart,this.proxy.rowEnd,!0,!0))}resize(){var t,e;this.proxy.resize(),("adaptive"===this.table.widthMode||this.table.autoFillWidth)&&(0===this.table.internalProps._widthResizedColMap.size?this.recalculateColWidths():this.dealWidthMode()),"adaptive"===this.table.heightMode?0===this.table.internalProps._heightResizedRowMap.size?this.recalculateRowHeights():this.dealHeightMode():this.table.autoFillHeight&&this.dealHeightMode(),this.resetFrozen(),this.updateTableSize(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),("adaptive"===this.table.widthMode||"adaptive"===this.table.heightMode||this.table.autoFillWidth||this.table.autoFillHeight||(null==(t=this.table.containerFit)?void 0:t.width)||(null==(e=this.table.containerFit)?void 0:e.height))&&this.updateChartSizeForResizeColWidth(-1),this.proxy.progress(),this.updateNextFrame()}updateTableSize(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g;let f=Math.max(this.colHeaderGroup.attribute.width,this.bodyGroup.attribute.width,this.bottomFrozenGroup.attribute.width,0)+Math.max(this.cornerHeaderGroup.attribute.width,this.rowHeaderGroup.attribute.width,this.leftBottomCornerGroup.attribute.width,0)+Math.max(this.rightTopCornerGroup.attribute.width,this.rightFrozenGroup.attribute.width,this.rightBottomCornerGroup.attribute.width,0),m=Math.max(this.colHeaderGroup.attribute.height,this.cornerHeaderGroup.attribute.height,this.rightTopCornerGroup.attribute.height,0)+Math.max(this.rowHeaderGroup.attribute.height,this.bodyGroup.attribute.height,this.rightFrozenGroup.attribute.height,0)+Math.max(this.leftBottomCornerGroup.attribute.height,this.bottomFrozenGroup.attribute.height,this.rightBottomCornerGroup.attribute.height,0),y=f,v=m;if(y=(null==(t=this.table.containerFit)?void 0:t.width)?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,f),v=(null==(e=this.table.containerFit)?void 0:e.height)?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,m),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:y,height:v}),this.tableGroup.border){let t,e,f,m,y=null==(i=this.tableGroup.border)?void 0:i.attribute;(null==y?void 0:y.strokeArrayWidth)?(t=y.strokeArrayWidth?y.strokeArrayWidth[0]:null!=(r=y.lineWidth)?r:0,e=y.strokeArrayWidth?y.strokeArrayWidth[1]:null!=(n=y.lineWidth)?n:0,f=y.strokeArrayWidth?y.strokeArrayWidth[2]:null!=(s=y.lineWidth)?s:0,m=y.strokeArrayWidth?y.strokeArrayWidth[3]:null!=(l=y.lineWidth)?l:0):(t=null!=(a=null==y?void 0:y.lineWidth)?a:0,e=null!=(o=null==y?void 0:y.lineWidth)?o:0,f=null!=(h=null==y?void 0:y.lineWidth)?h:0,m=null!=(u=null==y?void 0:y.lineWidth)?u:0),"rect"===this.tableGroup.border.type?(null==(d=this.table.theme.frameStyle)?void 0:d.innerBorder)?this.tableGroup.border.setAttributes({x:this.table.tableX+m/2,y:this.table.tableY+t/2,width:this.tableGroup.attribute.width-m/2-e/2,height:this.tableGroup.attribute.height-t/2-f/2}):this.tableGroup.border.setAttributes({x:this.table.tableX-m/2,y:this.table.tableY-t/2,width:this.tableGroup.attribute.width+m/2+e/2,height:this.tableGroup.attribute.height+t/2+f/2}):"group"===this.tableGroup.border.type&&((null==(c=this.table.theme.frameStyle)?void 0:c.innerBorder)?(this.tableGroup.border.setAttributes({x:this.table.tableX+m/2,y:this.table.tableY+t/2,width:this.tableGroup.attribute.width-m/2-e/2,height:this.tableGroup.attribute.height-t/2-f/2}),null==(p=this.tableGroup.border.firstChild)||p.setAttributes({x:0,y:0,width:this.tableGroup.attribute.width-m/2-e/2,height:this.tableGroup.attribute.height-t/2-f/2})):(this.tableGroup.border.setAttributes({x:this.table.tableX-m/2,y:this.table.tableY-t/2,width:this.tableGroup.attribute.width+m/2+e/2,height:this.tableGroup.attribute.height+t/2+f/2}),null==(g=this.tableGroup.border.firstChild)||g.setAttributes({x:m/2,y:t/2,width:this.tableGroup.attribute.width,height:this.tableGroup.attribute.height})))}this.table.bottomFrozenRowCount>0&&(this.bottomFrozenGroup.setAttribute("y",this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight()),this.leftBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight(),width:this.table.getFrozenColsWidth()}),this.rightBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight()})),this.table.rightFrozenColCount>0&&(this.rightFrozenGroup.setAttribute("x",this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth()),this.rightTopCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth(),height:this.table.getFrozenRowsHeight()}),this.rightBottomCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth()})),this.updateDomContainer()}updateRowHeight(t,e,i){tr(this,t,e=Math.round(e),i),this.updateContainerHeight(t,e)}updateRowsHeight(t,e,i){for(let r=0;r<t.length;r++){let n=t[r];if(n>=this.proxy.rowStart&&n<=this.proxy.rowEnd){let t=e[r];tr(this,n,Math.round(t),i),this._updateContainerHeight(n,t)}}this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}updateContainerWidth(t,e){t<this.frozenColCount?(this.rowHeaderGroup.setDeltaWidth(e),this.cornerHeaderGroup.setDeltaWidth(e),this.colHeaderGroup.setDeltaX(e),this.bodyGroup.setDeltaX(e)):(this.colHeaderGroup.setDeltaWidth(e),this.bodyGroup.setDeltaWidth(e)),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}_updateContainerHeight(t,e){t<this.table.frozenRowCount?(this.colHeaderGroup.setDeltaHeight(e),this.cornerHeaderGroup.setDeltaHeight(e),this.rowHeaderGroup.setDeltaY(e),this.bodyGroup.setDeltaY(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaY(e)):t>=this.table.rowCount-this.table.bottomFrozenRowCount?(this.leftBottomCornerGroup.setDeltaHeight(e),this.bottomFrozenGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightBottomCornerGroup.setDeltaHeight(e)):(this.rowHeaderGroup.setDeltaHeight(e),this.bodyGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaHeight(e))}updateContainerHeight(t,e){this._updateContainerHeight(t,e),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}setColWidth(t,e){let i=this.table.getColWidth(t);i!==e&&(this.updateColWidth(t,e-i),this.table._clearColRangeWidthsMap(t))}setRowHeight(t,e){let i=this.table.getRowHeight(t);i!==e&&((t>=this.proxy.rowStart&&t<=this.proxy.rowEnd||t>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<=this.table.rowCount-1||t<this.table.frozenRowCount)&&this.updateRowHeight(t,e-i),this.table._clearRowRangeHeightsMap(t))}setX(t,e=!1){this.table.scenegraph.proxy.setX(-t,e)}setY(t,e=!1){this.table.scenegraph.proxy.setY(-t,e)}setBodyAndRowHeaderY(t){var e,i,r,n,s,l;let a=null!=(i=null==(e=this.bodyGroup.firstChild)?void 0:e.firstChild)?i:null==(r=this.rowHeaderGroup.firstChild)?void 0:r.firstChild,o=null!=(s=null==(n=this.bodyGroup.firstChild)?void 0:n.lastChild)?s:null==(l=this.rowHeaderGroup.firstChild)?void 0:l.lastChild;0===t&&a&&a.row===this.table.frozenRowCount&&a.attribute.y+t<0?t=-a.attribute.y:o&&this.table.tableNoFrameHeight<this.table.getAllRowsHeight()&&o.row===this.table.rowCount-this.table.bottomFrozenRowCount-1&&o.attribute.y+this.table.getRowHeight(o.row)+t<this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()&&(t=this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()-o.attribute.y-this.table.getRowHeight(o.row)),this.colHeaderGroup.attribute.height+t!==this.bodyGroup.attribute.y&&(this.bodyGroup.setAttribute("y",this.colHeaderGroup.attribute.height+t),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height+t),this.table.rightFrozenColCount>0&&this.rightFrozenGroup.setAttribute("y",this.rightTopCornerGroup.attribute.height+t),this.updateNextFrame())}setBodyAndColHeaderX(t){let e=this.bodyGroup.firstChild,i=this.bodyGroup.lastChild;0===t&&e&&e.col===this.table.frozenColCount&&e.attribute.x+t<0?t=-e.attribute.x:i&&this.table.tableNoFrameWidth<this.table.getAllColsWidth()&&i.col===this.table.colCount-this.table.rightFrozenColCount-1&&i.attribute.x+i.attribute.width+t<this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()&&(t=this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()-i.attribute.x-i.attribute.width),this.table.getFrozenColsWidth()+t!==this.bodyGroup.attribute.x&&(this.bodyGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.colHeaderGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.table.bottomFrozenRowCount>0&&this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.updateNextFrame())}afterScenegraphCreated(){var t;this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount?this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):this.component.setFrozenColumnShadow(-1):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.table.stateManager.checkFrozen(),this.updateContainer(),this.createFrameBorder(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),e$(this.table),this.table.options.animationAppear&&function(t){var e,i,r,n;let s,l,a,o;if(!t.options.animationAppear)return;!0===t.options.animationAppear?(s=500,l=0,a="one-by-one",o="column"):(s=null!=(e=t.options.animationAppear.duration)?e:500,l=null!=(i=t.options.animationAppear.delay)?i:0,a=null!=(r=t.options.animationAppear.type)?r:"one-by-one",o=null!=(n=t.options.animationAppear.direction)?n:"row");let{scenegraph:h,frozenColCount:u,frozenRowCount:d}=t,{colStart:c,colEnd:p,rowStart:g,rowEnd:f}=h.proxy;for(let t=0;t<=p;t++)for(let e=0;e<=f;e++){let i=h.highPerformanceGetCell(t,e);i&&"cell"===i.role&&i.forEachChildren(i=>{i.setAttribute("opacity",0),i.animate().wait("one-by-one"===a?("row"===o?e:t)*(s-l):l).to({opacity:1},s,"linear")})}}(this.table),!1===(null==(t=this.table.options.menu)?void 0:t.contextMenuWorkOnlyCell)&&this.canvasShowMenu(),this.updateNextFrame()}dealWidthMode(){let t=this.table;if("adaptive"===t.widthMode){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,i=0,r=0,n=t.colCount;if("only-body"===t.widthAdaptiveMode){for(let e=0;e<t.colCount;e++)(e<t.rowHeaderLevelCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(i+=t.getColWidth(e));r=t.rowHeaderLevelCount,n=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount}(0,eC.j8)(e-i,r,n,!1,[],t,!0)}else if(t.autoFillWidth){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,i=0,r=0;for(let e=0;e<t.colCount;e++){let n=t.getColWidth(e);(e<t.rowHeaderLevelCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(i+=n),r+=n}if(r<e&&r>i){let r=t.rowHeaderLevelCount,n=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount;(0,eC.j8)(e-i,r,n,!1,[],t,!0)}}let e=0;this.bodyGroup.forEachChildrenSkipChild(t=>{e+=t.attribute.width}),this.bodyGroup.setAttribute("width",e);let i=0;this.colHeaderGroup.forEachChildrenSkipChild(t=>{i+=t.attribute.width}),this.colHeaderGroup.setAttribute("width",i);let r=0;this.rowHeaderGroup.forEachChildrenSkipChild(t=>{r+=t.attribute.width}),this.rowHeaderGroup.setAttribute("width",r);let n=0;this.cornerHeaderGroup.forEachChildrenSkipChild(t=>{n+=t.attribute.width}),this.cornerHeaderGroup.setAttribute("width",n),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height),this.bodyGroup.setAttributes({x:this.rowHeaderGroup.attribute.width,y:this.colHeaderGroup.attribute.height})}dealHeightMode(){var t;let e=this.table;if("adaptive"===e.heightMode){e._clearRowRangeHeightsMap();let t=e.getRowsHeight(0,e.columnHeaderLevelCount-1),i=e.isPivotChart()?e.getBottomFrozenRowsHeight():0,r=e.tableNoFrameHeight-t-i,n=e.columnHeaderLevelCount,s=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,l=0;for(let t=n;t<s;t++)l+=e.getRowHeight(t);let a=r/l;for(let t=n;t<s;t++){let i;i=t===s-1?r-e.getRowsHeight(n,s-2):Math.round(e.getRowHeight(t)*a),this.setRowHeight(t,i)}}else if(e.autoFillHeight){e._clearRowRangeHeightsMap();let i=e.tableNoFrameHeight,r=0,n=0;for(let t=0;t<e.rowCount;t++){let i=e.getRowHeight(t);(t<e.columnHeaderLevelCount||e.isPivotChart()&&t>=e.rowCount-e.bottomFrozenRowCount)&&(n+=i),r+=i}if((null!=(t=this._dealAutoFillHeightOriginRowsHeight)?t:r)<i&&r-n>0){let t=e.columnHeaderLevelCount,s=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,l=(i-n)/(r-n);for(let r=t;r<s;r++){let a;a=r===s-1?i-n-e.getRowsHeight(t,s-2):Math.round(e.getRowHeight(r)*l),this.setRowHeight(r,a)}}}}dealFrozen(){!function(t){var e,i,r,n;if(t.table.frozenColCount>t.table.rowHeaderLevelCount){t.rowHeaderGroup.setAttribute("height",t.bodyGroup.attribute.height),t.rowHeaderGroup.setAttribute("y",t.bodyGroup.attribute.y),t.cornerHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height);for(let e=0;e<t.table.frozenColCount-t.table.rowHeaderLevelCount;e++)iu(t),id(t),ig(t)}else if(t.table.frozenColCount<t.table.rowHeaderLevelCount){t.bodyGroup.setAttribute("height",t.rowHeaderGroup.attribute.height),t.bodyGroup.setAttribute("y",t.rowHeaderGroup.attribute.y),t.colHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height);for(let e=0;e<t.table.rowHeaderLevelCount-t.table.frozenColCount;e++)ic(t),ip(t),im(t)}t.bodyGroup.setAttribute("x",t.rowHeaderGroup.attribute.width),t.colHeaderGroup.setAttribute("x",t.cornerHeaderGroup.attribute.width),t.updateContainer(),t.updateBorderSizeAndPosition(),t.isPivot||t.table.transpose?t.table.options.frozenColCount?t.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.frozenColCount&&t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):(t.component.setFrozenColumnShadow(t.table.frozenColCount-1),t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.hasFrozen=!0,t.frozenColCount=t.table.frozenColCount,t.frozenRowCount=null!=(n=null!=(i=null==(e=t.colHeaderGroup.firstChild)?void 0:e.childrenCount)?i:null==(r=t.cornerHeaderGroup.firstChild)?void 0:r.childrenCount)?n:t.table.frozenRowCount}(this)}resetFrozen(){!function(t){var e,i,r,n,s,l;if(t.frozenColCount>t.table.frozenColCount){t.bodyGroup.setAttribute("height",t.rowHeaderGroup.attribute.height),t.bodyGroup.setAttribute("y",t.rowHeaderGroup.attribute.y),t.colHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height);for(let e=0;e<t.frozenColCount-t.table.frozenColCount;e++)ic(t),ip(t),im(t)}else if(t.frozenColCount<t.table.frozenColCount){t.rowHeaderGroup.setAttribute("height",t.bodyGroup.attribute.height),t.rowHeaderGroup.setAttribute("y",t.bodyGroup.attribute.y),t.cornerHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height);for(let e=0;e<t.table.frozenColCount-t.frozenColCount;e++)iu(t),id(t),ig(t)}ih(t),t.recreateAllSelectRangeComponents(),t.frozenColCount=t.table.frozenColCount,t.frozenRowCount=null!=(n=null!=(i=null==(e=t.colHeaderGroup.firstChild)?void 0:e.childrenCount)?i:null==(r=t.cornerHeaderGroup.firstChild)?void 0:r.childrenCount)?n:t.table.frozenRowCount,t.proxy.colStart=null!=(l=null==(s=t.bodyGroup.firstChild)?void 0:s.col)?l:t.table.frozenColCount,t.bodyGroup.setAttribute("x",t.rowHeaderGroup.attribute.width),t.colHeaderGroup.setAttribute("x",t.cornerHeaderGroup.attribute.width),t.updateContainer(),t.updateBorderSizeAndPosition(),t.isPivot||t.table.transpose?t.table.options.frozenColCount?t.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.rightFrozenColCount&&t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):(t.component.setFrozenColumnShadow(t.table.frozenColCount-1),t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.hasFrozen=!0}(this)}resetRowFrozen(){!function(t){var e,i,r,n,s;if(t.frozenRowCount>t.table.frozenRowCount){t.bodyGroup.setAttribute("width",t.colHeaderGroup.attribute.width),t.bodyGroup.setAttribute("x",t.colHeaderGroup.attribute.x),t.rowHeaderGroup.setAttribute("width",t.cornerHeaderGroup.attribute.width);for(let e=0;e<t.frozenRowCount-t.table.frozenRowCount;e++)(function(t){let e=!1;for(let i=0;i<t.colHeaderGroup.childrenCount;i++){let r=t.colHeaderGroup.children[i];if(!iv(r))continue;let n=t.bodyGroup.children[i];if(!n)continue;let s=r.lastChild;iy(n,s,n.firstChild),e||(t.colHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height-s.attribute.height),t.bodyGroup.setAttribute("height",t.bodyGroup.attribute.height+s.attribute.height),e=!0)}})(t),function(t){let e=!1;for(let i=0;i<t.cornerHeaderGroup.childrenCount;i++){let r=t.cornerHeaderGroup.children[i];if(!iv(r))continue;let n=t.rowHeaderGroup.children[i];if(!n)continue;let s=r.lastChild;iy(n,s,n.firstChild),e||(t.cornerHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height-s.attribute.height),t.rowHeaderGroup.setAttribute("height",t.rowHeaderGroup.attribute.height+s.attribute.height),e=!0)}}(t),function(t){let e=!1;for(let i=0;i<t.rightTopCornerGroup.childrenCount;i++){let r=t.rightTopCornerGroup.children[i];if(!iv(r))continue;let n=t.rightFrozenGroup.children[i];if(!n)continue;let s=r.lastChild;iy(n,s,n.firstChild),e||(t.rightTopCornerGroup.setAttribute("height",t.rightTopCornerGroup.attribute.height-s.attribute.height),t.rightFrozenGroup.setAttribute("height",t.rightFrozenGroup.attribute.height+s.attribute.height),e=!0)}}(t)}else if(t.frozenRowCount<t.table.frozenRowCount){t.colHeaderGroup.setAttribute("width",t.bodyGroup.attribute.width),t.colHeaderGroup.setAttribute("x",t.bodyGroup.attribute.x),t.cornerHeaderGroup.setAttribute("width",t.rowHeaderGroup.attribute.width);for(let e=0;e<t.table.frozenRowCount-t.frozenRowCount;e++)(function(t){var e;let i=!1;for(let r=0;r<t.bodyGroup.childrenCount;r++){let n=t.bodyGroup.children[r];if(!iv(n))continue;let s=n.firstChild;t.colHeaderGroup.children[r]||eT(t.colHeaderGroup,0,0,s.col,s.col,0,0,"columnHeader",t.table),null==(e=t.colHeaderGroup.children[r])||e.appendChild(s),i||(t.colHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height+s.attribute.height),t.bodyGroup.setAttribute("height",t.bodyGroup.attribute.height-s.attribute.height),i=!0)}})(t),function(t){var e;let i=!1;for(let r=0;r<t.rowHeaderGroup.childrenCount;r++){let n=t.rowHeaderGroup.children[r];if(!iv(n))continue;let s=n.firstChild;t.cornerHeaderGroup.children[r]||eT(t.cornerHeaderGroup,0,0,s.col,s.col,0,0,t.table.isListTable()?"columnHeader":"cornerHeader",t.table),null==(e=t.cornerHeaderGroup.children[r])||e.appendChild(s),i||(t.cornerHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height+s.attribute.height),t.rowHeaderGroup.setAttribute("height",t.rowHeaderGroup.attribute.height-s.attribute.height),i=!0)}}(t),function(t){let e=!1;for(let i=0;i<t.rightFrozenGroup.childrenCount;i++){let r=t.rightFrozenGroup.children[i];if(!iv(r))continue;let n=r.firstChild;t.rightTopCornerGroup.children[i]||eT(t.rightTopCornerGroup,0,0,n.col,n.col,0,0,"columnHeader",t.table),t.rightTopCornerGroup.children[i].appendChild(n),e||(t.rightTopCornerGroup.setAttribute("height",t.rightTopCornerGroup.attribute.height+n.attribute.height),t.rightFrozenGroup.setAttribute("height",t.rightFrozenGroup.attribute.height-n.attribute.height),e=!0)}}(t)}ih(t),t.recreateAllSelectRangeComponents(),t.frozenRowCount=t.table.frozenRowCount,t.frozenColCount=null!=(i=null==(e=t.rowHeaderGroup)?void 0:e.childrenCount)?i:0,t.proxy.rowStart=null!=(s=null==(n=null==(r=t.bodyGroup.firstChild)?void 0:r.firstChild)?void 0:n.row)?s:t.table.frozenRowCount,t.bodyGroup.setAttribute("y",t.colHeaderGroup.attribute.height),t.rowHeaderGroup.setAttribute("y",t.cornerHeaderGroup.attribute.height),t.updateContainer({needUpdateCellY:!0}),t.updateBorderSizeAndPosition(),t.hasFrozen=!0}(this)}updateCellLayoutWidthCertainWidth(t,e,i){let r=t.attribute.width,n=!1;return t.forEachChildren((t,s)=>{s+=e;let l=(0,G.Z)(this.table,i,s);l?t=this.getCell(l.start.col,l.start.row):t.setAttribute("width",r);let a=this.table._getCellStyle(i,s),o=(0,J.u)((0,Y.WJ)("padding",a,i,s,this.table)),h=t.getChildByName("text"),u=0,d=0;if(h)u=h.AABBBounds.height()+(o[0]+o[2]),h.setAttribute("maxLineWidth",r-(o[1]+o[3])),d=h.AABBBounds.height()+(o[0]+o[2]);else{let e=t.getChildAt(1);u=e.AABBBounds.height()+(o[0]+o[2]),e._cellWidth=r-(o[1]+o[3]),e.layout(),d=e.AABBBounds.height()+(o[0]+o[2])}let c=this.table.getRowHeight(s);t.attribute.height!==d&&(t.setAttribute("height",d),(c===u||d>c)&&(n=!0))}),n}updateHeaderPosition(t,e,i,r,n){!function(t,e,i,r,n,s){let l=s.scenegraph;for(let i=t;i<=e;i++){let t=s.getColWidth(i),e=s.scenegraph.getColGroup(i,!0),r=s.scenegraph.getColGroup(i),n=s.scenegraph.getColGroupInBottom(i),l=s.scenegraph.getColGroupInLeftBottomCorner(i),a=s.scenegraph.getColGroupInRightBottomCorner(i);e&&(e.setAttribute("width",t),e.forEachChildren(e=>{e.setAttribute("width",t)})),r&&(r.setAttribute("width",t),r.forEachChildren(e=>{e.setAttribute("width",t)})),n&&(n.setAttribute("width",t),n.forEachChildren(e=>{e.setAttribute("width",t)})),a&&(a.setAttribute("width",t),a.forEachChildren(e=>{e.setAttribute("width",t)})),l&&(l.setAttribute("width",t),l.forEachChildren(e=>{e.setAttribute("width",t)}))}if(l.updateContainer(),"column"===n)for(let i=t;i<=e;i++){let t=s.scenegraph.getColGroup(i);null==t||t.setAttribute("chartInstance",void 0);for(let t=0;t<=s.frozenRowCount-1;t++)l.updateCellContent(i,t);for(let t=l.bodyRowStart;t<=l.bodyRowEnd;t++)l.updateCellContent(i,t);for(let t=s.rowCount-s.bottomFrozenRowCount;t<=s.rowCount-1;t++)l.updateCellContent(i,t)}else{for(let t=0;t<=s.frozenColCount-1;t++){let e=s.scenegraph.getColGroup(t);null==e||e.setAttribute("chartInstance",void 0);for(let e=i;e<=r;e++)l.updateCellContent(t,e)}for(let t=l.bodyColStart;t<=l.bodyColEnd;t++){let e=s.scenegraph.getColGroup(t);null==e||e.setAttribute("chartInstance",void 0);for(let e=i;e<=r;e++)l.updateCellContent(t,e)}for(let t=s.colCount-s.rightFrozenColCount;t<=s.colCount-1;t++){let e=s.scenegraph.getColGroup(t);null==e||e.setAttribute("chartInstance",void 0);for(let e=i;e<=r;e++)l.updateCellContent(t,e)}}}(t,e,i,r,n,this.table)}updateContainerAttrWidthAndX(){var t,e,i;let r=ix(this.cornerHeaderGroup,0),n=ix(this.rowHeaderGroup,0),s=this.colHeaderGroup.hasChildNodes()&&this.colHeaderGroup.firstChild?ix(this.colHeaderGroup,this.colHeaderGroup.firstChild.col>0?this.table.getColsWidth(null!=(t=this.table.frozenColCount)?t:0,this.colHeaderGroup.firstChild.col-1):0):0,l=this.bodyGroup.hasChildNodes()&&this.bodyGroup.firstChild?ix(this.bodyGroup,this.bodyGroup.firstChild.col>0?this.table.getColsWidth(null!=(e=this.table.frozenColCount)?e:0,this.bodyGroup.firstChild.col-1):0):0,a=ix(this.rightFrozenGroup.childrenCount>0?this.rightFrozenGroup:this.rightTopCornerGroup,0);this.bottomFrozenGroup.hasChildNodes()&&this.bottomFrozenGroup.firstChild&&ix(this.bottomFrozenGroup,this.bottomFrozenGroup.firstChild.col>0?this.table.getColsWidth(null!=(i=this.table.frozenColCount)?i:0,this.bottomFrozenGroup.firstChild.col-1):0),ix(this.leftBottomCornerGroup,0),ix(this.rightTopCornerGroup,0),ix(this.rightBottomCornerGroup,0),this.cornerHeaderGroup.setDeltaWidth(r-this.cornerHeaderGroup.attribute.width),this.leftBottomCornerGroup.setDeltaWidth(r-this.leftBottomCornerGroup.attribute.width),this.colHeaderGroup.setDeltaWidth(s-this.colHeaderGroup.attribute.width),this.rowHeaderGroup.setDeltaWidth(n-this.rowHeaderGroup.attribute.width),this.bottomFrozenGroup.setDeltaWidth(s-this.bottomFrozenGroup.attribute.width),this.rightFrozenGroup.setDeltaWidth(a-this.rightFrozenGroup.attribute.width),this.rightTopCornerGroup.setDeltaWidth(a-this.rightTopCornerGroup.attribute.width),this.rightBottomCornerGroup.setDeltaWidth(a-this.rightBottomCornerGroup.attribute.width),this.bodyGroup.setDeltaWidth(l-this.bodyGroup.attribute.width),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()),this.bodyGroup.setAttribute("x",this.rowHeaderGroup.attribute.width)}updateContainerAttrHeightAndY(){var t,e,i;for(let t=0;t<this.cornerHeaderGroup.children.length;t++)iC(this.cornerHeaderGroup.children[t],0);for(let t=0;t<this.colHeaderGroup.children.length;t++)iC(this.colHeaderGroup.children[t],0);for(let t=0;t<this.rightTopCornerGroup.children.length;t++)iC(this.rightTopCornerGroup.children[t],0);for(let e=0;e<this.rowHeaderGroup.children.length;e++)this.rowHeaderGroup.children[e].firstChild&&iC(this.rowHeaderGroup.children[e],this.rowHeaderGroup.children[e].firstChild.row>0?this.table.getRowsHeight(null!=(t=this.table.frozenRowCount)?t:0,this.rowHeaderGroup.children[e].firstChild.row-1):0);for(let t=0;t<this.bodyGroup.children.length;t++)this.bodyGroup.children[t].firstChild&&iC(this.bodyGroup.children[t],this.bodyGroup.children[t].firstChild.row>0?this.table.getRowsHeight(null!=(e=this.table.frozenRowCount)?e:0,this.bodyGroup.children[t].firstChild.row-1):0);for(let t=0;t<this.rightFrozenGroup.children.length;t++)this.rightFrozenGroup.children[t].firstChild&&iC(this.rightFrozenGroup.children[t],this.rightFrozenGroup.children[t].firstChild.row>0?this.table.getRowsHeight(null!=(i=this.table.frozenRowCount)?i:0,this.rightFrozenGroup.children[t].firstChild.row-1):0);for(let t=0;t<this.leftBottomCornerGroup.children.length;t++)iC(this.leftBottomCornerGroup.children[t],0);for(let t=0;t<this.bottomFrozenGroup.children.length;t++)iC(this.bottomFrozenGroup.children[t],0);for(let t=0;t<this.rightBottomCornerGroup.children.length;t++)iC(this.rightBottomCornerGroup.children[t],0)}updateContainer(t={async:!1,needUpdateCellY:!1}){var e;t.async?this._needUpdateContainer||(this._needUpdateContainer=!0,setTimeout(()=>{var e;this.updateContainerSync(null!=(e=t.needUpdateCellY)&&e)},0)):(this._needUpdateContainer=!0,this.updateContainerSync(null!=(e=t.needUpdateCellY)&&e))}updateContainerSync(t=!1){this._needUpdateContainer&&(this._needUpdateContainer=!1,this.updateContainerAttrWidthAndX(),t&&this.updateContainerAttrHeightAndY(),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame())}updateCellContentWhileResize(t,e){var i;let r=(null==(i=this.table.getCellRawRecord(t,e))?void 0:i.vtableMerge)?"text":this.table.isHeader(t,e)?this.table._getHeaderLayoutMap(t,e).headerType:this.table.getBodyColumnType(t,e),n=this.getCell(t,e);"image"!==r&&"video"!==r||(0,K.km)(n,t,e,0,0,this.table)}createFrameBorder(){var t,e,i,r,n;this.updateTableSize();let s=!this.isPivot&&!this.table.internalProps.transpose;tT(this.bodyGroup,this.table.theme.bodyStyle.frameStyle,this.bodyGroup.role,s?[!0,!0,!0,!1]:void 0),tT(this.rowHeaderGroup,this.isPivot||this.table.internalProps.transpose?this.table.theme.rowHeaderStyle.frameStyle:this.table.theme.bodyStyle.frameStyle,this.rowHeaderGroup.role,s?[!0,!1,!0,!0]:void 0),tT(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle,this.colHeaderGroup.role,s?[!0,!0,!0,!1]:void 0),tT(this.cornerHeaderGroup,this.isPivot?this.table.theme.cornerHeaderStyle.frameStyle:this.table.theme.headerStyle.frameStyle,this.cornerHeaderGroup.role,s?[!0,!1,!0,!0]:void 0),(null==(t=this.table.theme.cornerLeftBottomCellStyle)?void 0:t.frameStyle)&&tT(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle.frameStyle,this.leftBottomCornerGroup.role,s?[!0,!1,!0,!0]:void 0),(null==(e=this.table.theme.bottomFrozenStyle)?void 0:e.frameStyle)&&tT(this.bottomFrozenGroup,this.table.theme.bottomFrozenStyle.frameStyle,this.bottomFrozenGroup.role,s?[!0,!0,!0,!1]:void 0),(null==(i=this.table.theme.rightFrozenStyle)?void 0:i.frameStyle)&&tT(this.rightFrozenGroup,this.table.theme.rightFrozenStyle.frameStyle,this.rightFrozenGroup.role,void 0),(null==(r=this.table.theme.cornerRightTopCellStyle)?void 0:r.frameStyle)&&tT(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle.frameStyle,this.rightTopCornerGroup.role,void 0),(null==(n=this.table.theme.cornerRightBottomCellStyle)?void 0:n.frameStyle)&&tT(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle.frameStyle,this.rightBottomCornerGroup.role,void 0),tT(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0)}getResizeColAt(t,e,i){let r,n=this.table.theme.columnResize.resizeHotSpotSize/2;if(!i){let i=this.table.getDrawRange();return e>=i.top&&e<=i.bottom&&(r=this.table.getCellAtRelativePosition(t-n,e)).col===this.table.colCount-1?r:{col:-1,row:-1}}return i.stage?(t<i.globalAABBBounds.x1+n?r={col:i.col-1,row:i.row,x:i.globalAABBBounds.x1}:i.globalAABBBounds.x2-n<t&&(r={col:i.col,row:i.row,x:i.globalAABBBounds.x2}),r&&this.table.rightFrozenColCount>0&&r.col>=this.table.colCount-this.table.rightFrozenColCount-1&&this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()+this.table.scrollLeft<this.bodyGroup.attribute.width&&(r.col=r.col+1,r.rightFrozen=!0),r||{col:-1,row:-1}):{col:-1,row:-1}}getResizeRowAt(t,e,i){let r=this.table.theme.columnResize.resizeHotSpotSize/2;if(i){let t;if(e<i.globalAABBBounds.y1+r?t={col:i.col,row:i.row-1,y:i.globalAABBBounds.y1}:i.globalAABBBounds.y2-r<e&&(t={col:i.col,row:i.row,y:i.globalAABBBounds.y2}),t&&this.table.bottomFrozenRowCount>0&&t.row>=this.table.rowCount-this.table.bottomFrozenRowCount-1&&this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()+this.table.scrollTop<this.bodyGroup.attribute.height&&(t.row=t.row+1,t.bottomFrozen=!0),t)return t}return{col:-1,row:-1}}updateFrozen(){this.clear||(this.resetFrozen(),this.component.updateScrollBar())}updateRowFrozen(){this.clear||(this.resetRowFrozen(),this.component.updateScrollBar())}dealWidthRightFrozen(t){this.clear?this.table.internalProps.rightFrozenColCount=t:function(t,e){let{table:i,proxy:r,rightTopCornerGroup:n,rightFrozenGroup:s,rightBottomCornerGroup:l,bottomFrozenGroup:a,bodyGroup:o,colHeaderGroup:h}=e,u=e.table.rightFrozenColCount;if(t>u){for(let r=i.colCount-u-1;r>=i.colCount-t;r--)iy(s,e.getColGroup(r),s.firstChild),iy(n,e.getColGroup(r,!0),n.firstChild),iy(l,e.getColGroupInBottom(r),l.firstChild);let r=0;s.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width}),r=0,n.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width}),r=0,l.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width})}else if(t<u){for(let r=i.colCount-u;r<i.colCount-t;r++){let t=e.getColGroup(r);t.setAttribute("x",o.lastChild.attribute.x+i.getColWidth(o.lastChild.col)),o.appendChild(t);let n=e.getColGroupInRightTopCorner(r);n.setAttribute("x",h.lastChild.attribute.x+i.getColWidth(h.lastChild.col)),h.appendChild(n);let s=e.getColGroupInRightBottomCorner(r);s.setAttribute("x",a.lastChild.attribute.x+i.getColWidth(a.lastChild.col)),a.appendChild(s)}let r=0;s.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width}),r=0,n.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width}),r=0,l.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width})}s.setAttribute("width",i.getColsWidth(i.colCount-t,i.colCount-1)),n.setAttribute("width",i.getColsWidth(i.colCount-t,i.colCount-1)),l.setAttribute("width",i.getColsWidth(i.colCount-t,i.colCount-1)),i.internalProps.rightFrozenColCount=t,e.updateContainer(),e.component.updateScrollBar(),e.updateNextFrame()}(t,this)}dealWidthBottomFrozen(t){this.clear?this.table.internalProps.bottomFrozenRowCount=t:function(t,e){let{table:i,proxy:r,bottomFrozenGroup:n,leftBottomCornerGroup:s,rightBottomCornerGroup:l}=e;n.childrenCount||(r.table.isPivotChart()||(eT(s,0,0,0,i.frozenColCount-1,0,-1,"rowHeader",i),eT(l,0,0,i.colCount-i.rightFrozenColCount,i.colCount-1,0,-1,"body",i)),eT(n,0,0,r.colStart,r.colEnd,0,-1,"body",i));let a=e.table.bottomFrozenRowCount;if(t>a){for(let r=0;r<i.frozenColCount;r++){let n=e.getColGroupInLeftBottomCorner(r);for(let s=i.rowCount-a-1;s>=i.rowCount-t;s--)iy(n,e.getCell(r,s,!0),n.firstChild);let s=0;n.forEachChildren(t=>{t.setAttribute("y",s),s+=i.getRowHeight(t.row)})}for(let n=r.colStart;n<=r.colEnd;n++){let r=e.getColGroupInBottom(n);for(let s=i.rowCount-a-1;s>=i.rowCount-t;s--)iy(r,e.getCell(n,s,!0),r.firstChild);let s=0;r.forEachChildren(t=>{t.setAttribute("y",s),s+=i.getRowHeight(t.row)})}if(i.rightFrozenColCount>0)for(let r=i.colCount-i.rightFrozenColCount;r<i.colCount;r++){let n=e.getColGroupInRightBottomCorner(r);for(let s=i.rowCount-a-1;s>=i.rowCount-t;s--)iy(n,e.getCell(r,s,!0),n.firstChild);let s=0;n.forEachChildren(t=>{t.setAttribute("y",s),s+=i.getRowHeight(t.row)})}}else if(t<a){for(let r=0;r<i.rowHeaderLevelCount;r++){let n=e.getColGroup(r);for(let s=i.rowCount-a;s<i.rowCount-t;s++){let t=e.getCell(r,s,!0);t.setAttribute("y",n.lastChild.attribute.y+i.getRowHeight(n.lastChild.row)),n.appendChild(t)}let s=e.getColGroupInLeftBottomCorner(r),l=0;s.forEachChildren(t=>{t.setAttribute("y",l),l+=i.getRowHeight(t.row)})}for(let n=r.colStart;n<=r.colEnd;n++){let r=e.getColGroup(n);for(let s=i.rowCount-a;s<i.rowCount-t;s++){let t=e.getCell(n,s,!0);t.setAttribute("y",r.lastChild.attribute.y+i.getRowHeight(r.lastChild.row)),r.appendChild(t)}let s=e.getColGroupInBottom(n),l=0;s.forEachChildren(t=>{t.setAttribute("y",l),l+=i.getRowHeight(t.row)})}if(i.rightFrozenColCount>0)for(let r=i.colCount-i.rightFrozenColCount;r<i.colCount;r++){let n=e.getColGroup(r);for(let s=i.rowCount-a;s<i.rowCount-t;s++){let t=e.getCell(r,s,!0);t.setAttribute("y",n.lastChild.attribute.y+i.getRowHeight(n.lastChild.row)),n.appendChild(t)}let s=e.getColGroupInRightBottomCorner(r),l=0;s.forEachChildren(t=>{t.setAttribute("y",l),l+=i.getRowHeight(t.row)})}}n.setAttribute("height",i.getRowsHeight(i.rowCount-t,i.rowCount-1)),s.setAttribute("height",i.getRowsHeight(i.rowCount-t,i.rowCount-1)),l.setAttribute("height",i.getRowsHeight(i.rowCount-t,i.rowCount-1)),i.internalProps.bottomFrozenRowCount=t,e.updateContainer(),e.component.updateScrollBar(),e.updateNextFrame()}(t,this)}updateBorderSizeAndPosition(){this.bodyGroup.border&&(this.bodyGroup.appendChild(this.bodyGroup.border),tP(this.bodyGroup),this.rowHeaderGroup.attribute.width,tR(this.bodyGroup,this.table.theme.bodyStyle.frameStyle)),this.colHeaderGroup.border&&(this.colHeaderGroup.appendChild(this.colHeaderGroup.border),tP(this.colHeaderGroup),this.cornerHeaderGroup.attribute.width,tR(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle)),this.rowHeaderGroup.border&&(this.rowHeaderGroup.appendChild(this.rowHeaderGroup.border),tP(this.rowHeaderGroup)),this.cornerHeaderGroup.border&&(this.cornerHeaderGroup.appendChild(this.cornerHeaderGroup.border),tP(this.cornerHeaderGroup)),this.leftBottomCornerGroup.border&&(this.leftBottomCornerGroup.appendChild(this.leftBottomCornerGroup.border),tP(this.leftBottomCornerGroup)),this.bottomFrozenGroup.border&&(this.bottomFrozenGroup.appendChild(this.bottomFrozenGroup.border),tP(this.bottomFrozenGroup)),this.rightFrozenGroup.border&&(this.rightFrozenGroup.appendChild(this.rightFrozenGroup.border),tP(this.rightFrozenGroup)),this.rightTopCornerGroup.border&&(this.rightTopCornerGroup.appendChild(this.rightTopCornerGroup.border),tP(this.rightTopCornerGroup)),this.rightBottomCornerGroup.border&&(this.rightBottomCornerGroup.appendChild(this.rightBottomCornerGroup.border),tP(this.rightBottomCornerGroup)),function(t){if(!t.theme.frameStyle.cornerRadius)return;let e=t.theme.frameStyle.cornerRadius,{cornerHeaderGroup:i,colHeaderGroup:r,rowHeaderGroup:n,bodyGroup:s,rightTopCornerGroup:l,leftBottomCornerGroup:a,rightBottomCornerGroup:o,rightFrozenGroup:h,bottomFrozenGroup:u}=t.scenegraph;i.setAttribute("cornerRadius",0),r.setAttribute("cornerRadius",0),n.setAttribute("cornerRadius",0),s.setAttribute("cornerRadius",0),l.setAttribute("cornerRadius",0),a.setAttribute("cornerRadius",0),o.setAttribute("cornerRadius",0),h.setAttribute("cornerRadius",0),u.setAttribute("cornerRadius",0);let d=(0,P.JO)(e);i.attribute.width>0&&i.attribute.height>0?tE(i,[d[0],0,0,0]):r.attribute.height>0?tE(r,[d[0],0,0,0]):n.attribute.width>0?tE(n,[d[0],0,0,0]):tE(s,[d[0],0,0,0]),a.attribute.width>0&&a.attribute.height>0?tE(a,[0,0,0,d[3]]):u.attribute.height>0?tE(u,[0,0,0,d[3]]):n.attribute.width>0?tE(n,[0,0,0,d[3]]):tE(s,[0,0,0,d[3]]),l.attribute.width>0&&l.attribute.height>0?tE(l,[0,d[1],0,0]):r.attribute.height>0?tE(r,[0,d[1],0,0]):h.attribute.width>0?tE(h,[0,d[1],0,0]):tE(s,[0,d[1],0,0]),o.attribute.width>0&&o.attribute.height>0?tE(o,[0,0,d[2],0]):h.attribute.width>0?tE(h,[0,0,d[2],0]):u.attribute.height>0?tE(u,[0,0,d[2],0]):tE(s,[0,0,d[2],0])}(this.table)}sortCell(){this.isPivot||(this.table.transpose?this.proxy.sortCellHorizontal():this.proxy.sortCellVertical())}getCellOverflowText(t,e){let i=this.getCell(t,e).getChildByName("text",!0);if(i&&"text"===i.type){if(i.attribute.moreThanMaxCharacters||i.cliped)return this.table.getCellValue(t,e)}else if(i&&"richtext"===i.type&&i.attribute.ellipsis&&i._frameCache&&i.attribute.height<i._frameCache.actualHeight)return i.attribute.textConfig.find(t=>t.text),this.table.getCellValue(t,e);return null}updateDrill(t,e,i,r,n){this.component.drillIcon.update(t,e,i,r,n,this)}updateCellContent(t,e,i=!1){if(!this.clear)return(0,$.wW)(t,e,this.table,void 0,void 0,i)}setPixelRatio(t){this.stage.disableDirtyBounds(),this.stage.window.setDpr(t),this.stage.render(),this.stage.enableDirtyBounds()}updateRow(t,e,i=[],r=!0,n){this.table.internalProps.layoutMap.clearCellRangeMap(),this.table.internalProps.useOneRowHeightFillAll=!1;let s=(0,O.oM)(e.map(t=>t.row)).sort((t,e)=>t-e),l=(0,O.oM)(i.map(t=>t.row)).sort((t,e)=>t-e),a=this.table.getAllRowsHeight()-[...s,...l].reduce((t,e)=>t+this.table.getRowHeight(e),0)<=this.table.tableNoFrameHeight;if(function(t,e,i,r,n){let s,l;eQ(r)&&eK(r);let a=r.scenegraph,o=(0,O.oM)(t.map(t=>t.row)).sort((t,e)=>e-t),h=(0,O.oM)(e.map(t=>t.row)).sort((t,e)=>t-e),u=(0,O.oM)(i.map(t=>t.row)).sort((t,e)=>t-e);if(u.length&&(s=il(u[0]-1,u[u.length-1]+1,a)),h.length){let t=il(h[0]-1,h[h.length-1]+1,a);s=(0,y.Z)(s)?(0,y.Z)(t)?Math.min(s,t):s:t}if(o.length){let t=il(o[0]-1,o[o.length-1]+1,a);s=(0,y.Z)(s)?(0,y.Z)(t)?Math.min(s,t):s:t}o.forEach(t=>{var e=t,i=a,r=n;let s=i.proxy;if(e>=s.rowStart&&e<=s.rowEnd&&(ir(e,i),s.rowEnd--,s.currentRow--),!r){s.bodyBottomRow--;let t=Math.min(s.rowLimit,s.bodyBottomRow-s.bodyTopRow+1);s.totalActualBodyRowCount=t,s.totalRow=Math.min(s.table.rowCount-1,s.rowStart+t-1)}});let d=r.rowHeightsMap;if(o.forEach(t=>{d.delete(t)}),o.length){var c,p,g=a;function f(t,e){t.row=e;let i=(0,G.Z)(g.table,t.col,t.row);i?(t.mergeStartCol=i.start.col,t.mergeEndCol=i.end.col,t.mergeStartRow=i.start.row,t.mergeEndRow=i.end.row):(t.mergeStartCol=void 0,t.mergeEndCol=void 0,t.mergeStartRow=void 0,t.mergeEndRow=void 0)}g.bodyGroup.forEachChildren(t=>{let e=g.bodyRowStart;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.rowHeaderGroup.forEachChildren(t=>{let e=g.bodyRowStart;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.rightFrozenGroup.forEachChildren(t=>{let e=g.bodyRowStart;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.bottomFrozenGroup.forEachChildren(t=>{let e=g.table.rowCount-g.table.bottomFrozenRowCount;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.leftBottomCornerGroup.forEachChildren(t=>{let e=g.table.rowCount-g.table.bottomFrozenRowCount;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.rightBottomCornerGroup.forEachChildren(t=>{let e=g.table.rowCount-g.table.bottomFrozenRowCount;null==t||t.forEachChildren(t=>{f(t,e),e++})});let t=is(o[o.length-1]-1,o[0]-o.length+1,a);s=(0,y.Z)(s)?(0,y.Z)(t)?Math.min(s,t):s:t}if(a.table._clearRowRangeHeightsMap(),h.forEach(t=>{let e=function(t,e,i){let r=e.proxy;if(!i){r.bodyBottomRow++;let t=Math.min(r.rowLimit,r.bodyBottomRow-r.bodyTopRow+1);r.totalActualBodyRowCount=t,r.totalRow=r.rowStart+t-1}if(!(t<r.rowStart))return t>r.rowEnd?r.rowEnd-r.rowStart+1<r.rowLimit?(r.rowEnd++,r.currentRow++,ii(t,e),t):void 0:(r.rowEnd-r.rowStart+1<r.rowLimit&&(r.rowEnd++,r.currentRow++,ii(t,e)),t)}(t,a,n);l=null!=l?l:e,d.insert(t)}),function(t){function e(e,i,r){e.row=i,e.setAttribute("y",r);let n=(0,G.Z)(t.table,e.col,e.row);n?(e.mergeStartCol=n.start.col,e.mergeEndCol=n.end.col,e.mergeStartRow=n.start.row,e.mergeEndRow=n.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}t.bodyGroup.forEachChildren(i=>{let r=t.bodyRowStart,n=t.getCellGroupY(r);null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.rowHeaderGroup.forEachChildren(i=>{let r=t.bodyRowStart,n=t.getCellGroupY(r);null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.rightFrozenGroup.forEachChildren(i=>{let r=t.bodyRowStart,n=t.getCellGroupY(r);null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.bottomFrozenGroup.forEachChildren(i=>{let r=t.table.rowCount-t.table.bottomFrozenRowCount,n=0;null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.leftBottomCornerGroup.forEachChildren(i=>{let r=t.table.rowCount-t.table.bottomFrozenRowCount,n=0;null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.rightBottomCornerGroup.forEachChildren(i=>{let r=t.table.rowCount-t.table.bottomFrozenRowCount,n=0;null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})})}(a),h.length){let t=is(h[0]-1,h[h.length-1]+1,a);s=(0,y.Z)(s)?(0,y.Z)(t)?Math.min(s,t):s:t}let m=new Set;for(let t=0;t<r.colCount;t++)u.forEach(e=>{if(e<r.frozenRowCount){let i=(0,G.Z)(a.table,t,e);if(i)for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.row;e<=i.end.row;e++){let i=`${t}-${e}`;m.has(i)||((0,$.wW)(t,e,a.table,!1),m.add(i))}else(0,$.wW)(t,e,a.table,!1)}else if(e>r.rowCount-1||e<a.table.rowCount-a.table.bottomFrozenRowCount&&(e<a.proxy.rowStart||e>a.proxy.rowEnd))ir(e,a);else{let i=(0,G.Z)(a.table,t,e);if(i)for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.row;e<=i.end.row;e++){let i=`${t}-${e}`;m.has(i)||((0,$.wW)(t,e,a.table,!1),m.add(i))}else(0,$.wW)(t,e,a.table,!1)}});if(u.length){let t=is(u[0]-1,u[u.length-1]+1,a);s=(0,y.Z)(s)?(0,y.Z)(t)?Math.min(s,t):s:t}if((0,X.Z)(l)){for(let t=0;t<Math.max(r.colCount,null!=(c=r.internalProps._oldColCount)?c:r.colCount);t++)for(let e=l;e<Math.max(r.rowCount,null!=(p=r.internalProps._oldRowCount)?p:r.rowCount);e++){let i=a.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}s=(0,y.Z)(s)?(0,y.Z)(l)?Math.min(s,l):s:l}if((0,X.Z)(s)&&(a.proxy.rowUpdatePos=Math.min(a.proxy.rowUpdatePos,s)),h.length){if(!(0,X.Z)(l)){let t=Math.min(...h);a.proxy.rowUpdatePos=Math.min(t,a.proxy.rowUpdatePos)}a.proxy.rowUpdateDirection="up",a.proxy.updateCellGroups(2*a.proxy.screenRowCount),b()}else o.length&&(function(t,e){if(e.table.isHasSeriesNumber())for(let i=t;i<=e.table.rowCount-1;i++)(0,$.wW)(0,i,e.table,!1)}(o[o.length-1],a),a.proxy.updateCellGroups(2*a.proxy.screenRowCount),b());a.proxy.progress();let v=r.getRowsHeight(r.frozenRowCount,r.rowCount-1-r.bottomFrozenRowCount);function b(){if((null==h?void 0:h[(null==h?void 0:h.length)-1])>=r.rowCount-r.bottomFrozenRowCount||(null==u?void 0:u[(null==u?void 0:u.length)-1])>=r.rowCount-r.bottomFrozenRowCount||(null==o?void 0:o[0])>=r.rowCount-r.bottomFrozenRowCount){for(let t=0;t<r.colCount;t++)for(let e=r.rowCount-r.bottomFrozenRowCount;e<r.rowCount;e++){let i=a.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}a.proxy.updateBottomFrozenCellGroups()}}a.updateContainerHeight(a.table.frozenRowCount,v-a.bodyGroup.attribute.height)}(t,e,i,this.table,n),r&&this.recalculateColWidths(),"adaptive"===this.table.heightMode||this.table.autoFillHeight&&(this.table.getAllRowsHeight()<=this.table.tableNoFrameHeight||a))this.table.scenegraph.recalculateRowHeights();else if(this.table.isAutoRowHeight(this.table.columnHeaderLevelCount))for(let t=0;t<l.length;t++){let e=l[t],i=this.table.rowHeightsMap.get(e),r=(0,te.P)(e,0,this.table.colCount-1,this.table);(e>=this.proxy.rowStart&&e<=this.proxy.rowEnd||e>=this.table.rowCount-this.table.bottomFrozenRowCount&&e<=this.table.rowCount-1)&&this.table.scenegraph.updateRowHeight(e,r-i)}this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCol(t,e,i=[]){(function(t,e,i,r){var n,s;let l;eQ(r)&&eK(r);let a=r.scenegraph,o=iT(t.map(t=>t.col)).sort((t,e)=>e-t),h=iT(e.map(t=>t.col)).sort((t,e)=>t-e),u=iT(i.map(t=>t.col)).sort((t,e)=>t-e);o.forEach(t=>{!function(t,e){let i=e.proxy;if(t>=e.table.rowHeaderLevelCount)if(t>=e.table.colCount-e.table.rightFrozenColCount);else{let i=e.getColGroup(t,!1);i&&i.parent===e.bodyGroup&&e.bodyGroup.removeChild(i);let r=e.getColGroupInBottom(t);r&&r.parent===e.bottomFrozenGroup&&e.bottomFrozenGroup.removeChild(r);let n=e.getColGroup(t,!0);n&&n.parent===e.colHeaderGroup&&e.colHeaderGroup.removeChild(n)}t>=i.colStart&&t<=i.colEnd&&(i.colEnd--,i.currentCol--),i.bodyRightCol--;let r=Math.min(i.colLimit,i.bodyRightCol-i.bodyLeftCol+1);i.totalActualBodyColCount=r,i.totalCol=i.colStart+r-1}(t,a)});let d=r.colWidthsMap;o.forEach(t=>{d.delAndReorder(t)}),o.length&&iR(a),a.table._clearColRangeWidthsMap(),h.forEach(t=>{let e=function(t,e){let i=e.proxy;i.bodyRightCol++;let r=Math.min(i.colLimit,i.bodyRightCol-i.bodyLeftCol+1);if(i.totalActualBodyColCount=r,i.totalCol=i.colStart+r-1,!(t<i.colStart))return t>i.colEnd?i.colEnd-i.colStart+1<i.colLimit?(i.colEnd++,i.currentCol++,iB(t,e),t):void 0:(i.colEnd-i.colStart+1<i.colLimit&&(i.colEnd++,i.currentCol++,iB(t,e)),t)}(t,a);iR(a),l=null!=l?l:e,d.addAndReorder(t)}),function(t){let e=t.bodyColStart,i=t.getCellGroupX(e);function r(i){i.col=e;let r=(0,G.Z)(t.table,i.col,i.row);r&&(i.mergeStartCol=r.start.col,i.mergeStartCol=r.start.col,i.mergeEndCol=r.end.col,i.mergeEndCol=r.end.col),i.role}t.bodyGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.bodyColStart,i=t.getCellGroupX(e),t.colHeaderGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.bodyColStart,i=t.getCellGroupX(e),t.bottomFrozenGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.table.colCount-t.table.rightFrozenColCount,i=0,t.rightFrozenGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.table.colCount-t.table.rightFrozenColCount,i=0,t.rightTopCornerGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.table.colCount-t.table.rightFrozenColCount,i=0,t.rightBottomCornerGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++})}(a);let c=new Set;if(u.forEach(t=>{for(let e=0;e<r.rowCount;e++){let i=(0,G.Z)(a.table,t,e);if(i)for(let t=i.start.col;t<=i.end.col;t++)for(let t=i.start.col;t<=i.end.col;t++){let i=`${t}-${e}`;c.has(i)||((0,$.wW)(t,e,a.table,!1),c.add(i))}else(0,$.wW)(t,e,a.table,!1)}}),(0,X.Z)(l)){for(let t=l;t<Math.max(r.colCount,null!=(n=r.internalProps._oldColCount)?n:r.colCount);t++)for(let e=0;e<Math.max(r.rowCount,null!=(s=r.internalProps._oldRowCount)?s:r.rowCount);e++){let i=a.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}a.proxy.colUpdatePos=l}if(h.length){if(!(0,X.Z)(l)){let t=Math.min(...h);a.proxy.colUpdatePos=t}a.proxy.colUpdateDirection="left",a.proxy.updateColGroups(2*a.proxy.screenColCount),g(),a.proxy.progress()}else o.length&&(a.proxy.updateColGroups(2*a.proxy.screenColCount),g(),a.proxy.progress());let p=r.getColsWidth(r.frozenColCount,r.colCount-1);function g(){if((null==h?void 0:h[(null==h?void 0:h.length)-1])>=r.colCount-r.rightFrozenColCount||(null==u?void 0:u[(null==u?void 0:u.length)-1])>=r.colCount-r.rightFrozenColCount||(null==o?void 0:o[0])>=r.colCount-r.rightFrozenColCount){for(let t=r.colCount-r.rightFrozenColCount;t<r.colCount;t++)for(let e=0;e<r.rowCount;e++){let i=a.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}a.proxy.updateRightFrozenCellGroups()}}a.updateContainerWidth(a.table.frozenColCount,p-a.bodyGroup.attribute.width)})(t,e,i,this.table),this.recalculateColWidths(),this.recalculateRowHeights(),this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCornerHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=0;e<this.table.frozenRowCount;e++)(0,$.wW)(t,e,this.table,!1)}updateRowHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=this.table.frozenRowCount;e<this.table.rowCount;e++)(0,$.wW)(t,e,this.table,!1)}updateColumnHeaderCells(){for(let t=0;t<this.table.frozenRowCount;t++)for(let e=this.table.frozenColCount;e<this.table.colCount;e++)(0,$.wW)(e,t,this.table,!1)}getColumnGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupY(t){return t<this.table.frozenRowCount?this.table.getRowsHeight(0,t-1):t<this.table.rowCount-this.table.bottomFrozenRowCount?this.table.getRowsHeight(this.table.columnHeaderLevelCount,t-1):t<this.table.rowCount?this.table.getRowsHeight(this.table.rowCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.rightFrozenColCount,t-1):0}updateDomContainer(){!function(t){let{headerDomContainer:e,bodyDomContainer:i,frozenBodyDomContainer:r,frozenHeaderDomContainer:n,rightFrozenBodyDomContainer:s,rightFrozenHeaderDomContainer:l,bottomDomContainer:a,frozenBottomDomContainer:o,rightFrozenBottomDomContainer:h}=t.internalProps;if(!(e||i||r||n||s||l||a||o||h))return;let u=t.getAllColsWidth(),d=Math.min(u,t.tableNoFrameWidth),c=t.getFrozenColsWidth(),p=t.getRightFrozenColsWidth(),g=c+p,f=Math.min(u-g,d-g),m=t.getAllRowsHeight(),y=Math.min(m,t.tableNoFrameHeight),v=t.getFrozenRowsHeight(),b=t.getBottomFrozenRowsHeight(),_=v+b,x=Math.min(m-_,y-_);t.frozenColCount>0?(e.style.left=`${t.tableX+c}px`,i.style.left=`${t.tableX+c}px`,a.style.left=`${t.tableX+c}px`):0===t.frozenColCount&&(e.style.left=`${t.tableX}px`,i.style.left=`${t.tableX}px`,a.style.left=`${t.tableX}px`),r.style.left=`${t.tableX}px`,n.style.left=`${t.tableX}px`,e.style.width=`${f}px`,e.style.height=`${v}px`,i.style.top=`${t.tableY}px`,i.style.width=`${f}px`,i.style.height=`${x}px`,i.style.top=`${t.tableY+v}px`,r.style.width=`${c}px`,r.style.height=`${x}px`,r.style.top=`${t.tableY+v}px`,n.style.width=`${c}px`,n.style.height=`${v}px`,n.style.top=`${t.tableY}px`,s.style.width=`${p}px`,s.style.height=`${x}px`,s.style.top=`${t.tableY+v}px`,s.style.left=t.tableX+d-p+"px",l.style.width=`${p}px`,l.style.height=`${v}px`,l.style.top=`${t.tableY}px`,l.style.left=t.tableX+d-p+"px",a.style.width=`${f}px`,a.style.height=`${b}px`,a.style.top=t.tableY+y-b+"px",o.style.width=`${c}px`,o.style.height=`${b}px`,o.style.top=t.tableY+y-b+"px",h.style.width=`${p}px`,h.style.height=`${b}px`,h.style.top=t.tableY+y-b+"px",h.style.left=t.tableX+d-p+"px"}(this.table)}setLoadingHierarchyState(t,e){let i=this.getCell(t,e),r=i.getChildByName("collapse",!0)||i.getChildByName("expand",!0);if(r){let i=tb.U2()[j.up.loadingIconName];i&&(0,Q.Bg)(i,r,t,e)}}temporarilyUpdateSelectRectStyle(t){let{selectedRangeComponents:e}=this;e.forEach((e,i)=>{e.rect.setAttributes(t)}),this.updateNextFrame()}resetSelectRectStyle(){this.recreateAllSelectRangeComponents()}}function iE(t,e,i){let r=t.highPerformanceGetCell(e,i);if("cell"===r.role&&(0,y.Z)(r.mergeStartCol)&&(0,y.Z)(r.mergeStartRow)&&(0,y.Z)(r.mergeEndCol)&&(0,y.Z)(r.mergeEndRow)){let{colStart:e,colEnd:i,rowStart:n,rowEnd:s}=(0,ti.e)(r,t);for(let r=e;r<=i;r++)for(let e=n;e<=s;e++){let i=t.highPerformanceGetCell(r,e);"cell"===i.role&&i.addUpdateBoundTag()}}else r.addUpdateBoundTag()}function iI(t,e,i,r,n){let s=t.table;for(let i=0;i<s.columnHeaderLevelCount;i++)iE(t,e,i);let l=t.getColGroup(e);return null==l||l.addUpdateBoundTag(),!0}function iL(t,e,i,r,n,s){let l=t.table;for(let i=0;i<l.columnHeaderLevelCount;i++)iE(t,e,i);let a=t.getColGroup(e);return null==a||a.addUpdateBoundTag(),!0}function iF(t,e,i,r,n){let s=t.table;for(let e=0;e<s.colCount;e++)iE(t,e,i);return!0}function iO(t,e,i,r,n,s){let l=t.table;for(let e=0;e<l.colCount;e++)iE(t,e,i);return!0}function iD(t,e,i,r,n){return n._getLayoutCellId(t,e)===n._getLayoutCellId(i,r)}var iH=i(46894),iz=i(22295),iW=i(47e3);function iN(t,e,i,r,n){for(let i=t;i<=e;i++)n._clearColRangeWidthsMap(i);for(let t=i;t<=r;t++)n._clearRowRangeHeightsMap(t)}function ij(t){var e;if(!t)return;let i=(null==(e=t.role)?void 0:e.startsWith("icon"))?t:"richtext"===t.type?t._currentHoverIcon:void 0;return i?"richtext"===t.type?{icon:i,position:{left:t.globalAABBBounds.x1+i.globalAABBBounds.x1,right:t.globalAABBBounds.x1+i.globalAABBBounds.x2,top:t.globalAABBBounds.y1+i.globalAABBBounds.y1,bottom:t.globalAABBBounds.y1+i.globalAABBBounds.y2,width:i.globalAABBBounds.x2-i.globalAABBBounds.x1,height:i.globalAABBBounds.y2-i.globalAABBBounds.y1},type:"richtext-icon"}:{icon:i,position:{left:i.globalAABBBounds.x1,right:i.globalAABBBounds.x2,top:i.globalAABBBounds.y1,bottom:i.globalAABBBounds.y2,width:i.globalAABBBounds.x2-i.globalAABBBounds.x1,height:i.globalAABBBounds.y2-i.globalAABBBounds.y1},type:"icon"}:void 0}var iG=i(67283);function iV(t,e){"adaptive"===e.table.widthMode&&e.columnResize.col<e.table.colCount-1?(e.table.scenegraph.updateColWidth(e.columnResize.col,t),e.table.scenegraph.updateColWidth(e.columnResize.col+1,-t),e.table.internalProps._widthResizedColMap.add(e.columnResize.col),e.table.internalProps._widthResizedColMap.add(e.columnResize.col+1)):(e.table.scenegraph.updateColWidth(e.columnResize.col,t),e.table.internalProps._widthResizedColMap.add(e.columnResize.col))}var iZ=i(30394),iU=i(81137);function iK(t,e){"adaptive"===e.table.heightMode&&e.rowResize.row<e.table.rowCount-1?(e.table.scenegraph.updateRowHeight(e.rowResize.row,t),e.table.scenegraph.updateRowHeight(e.rowResize.row+1,-t),e.table.internalProps._heightResizedRowMap.add(e.rowResize.row),e.table.internalProps._heightResizedRowMap.add(e.rowResize.row+1)):(e.table.scenegraph.updateRowHeight(e.rowResize.row,t),e.table.internalProps._heightResizedRowMap.add(e.rowResize.row))}function i$(t,e,i,r,n,s,l,a,o){var h,u,d,c;let p=Math.min(e,r),g=Math.min(i,n),f=Math.max(e,r),m=Math.max(i,n),y=t.highPerformanceGetCell(p,g).globalAABBBounds,v=(0,tc.f)({pickable:!1,fill:null!=(h=o.cellBgColor)&&h,lineWidth:null!=(u=o.cellBorderLineWidth)?u:0,lineDash:null!=(d=o.cellBorderLineDash)?d:[],stroke:a.map(t=>!!t&&o.cellBorderColor),x:y.x1-t.tableGroup.attribute.x,y:y.y1-t.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:e9(s,null==(c=t.table.theme.frameStyle)?void 0:c.cornerRadius,e,i,r,n,t.table)});t.customSelectedRangeComponents.set(`${p}-${g}-${f}-${m}-${l}`,{rect:v,role:s}),t.tableGroup.insertAfter(v,"body"===s?t.bodyGroup:"columnHeader"===s?t.colHeaderGroup:"rowHeader"===s?t.rowHeaderGroup:"cornerHeader"===s?t.cornerHeaderGroup:"rightTopCorner"===s?t.rightTopCornerGroup:"rightFrozen"===s?t.rightFrozenGroup:"leftBottomCorner"===s?t.leftBottomCornerGroup:"bottomFrozen"===s?t.bottomFrozenGroup:t.rightBottomCornerGroup)}class iY{constructor(t){this.fastScrolling=!1,this.checkedState=new Map,this.headerCheckedState={},this._checkboxCellTypeFields=[],this._headerCheckFuncs={},this.radioState={},this.resetInteractionState=(0,iG.D)(t=>{this.updateInteractionState(null!=t?t:B.F.default)},100),this.table=t,this.initState(),this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this)}initState(){this._initState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}updateOptionSetState(){this._updateOptionSetState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}_updateOptionSetState(){this.interactionState=B.F.default,this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,rowSourceSize:0,rowTargetSize:0,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new iz.YZ,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}_initState(){this.interactionState=B.F.default,this.select={highlightScope:B.p.single,ranges:[],cellPos:{col:-1,row:-1},selecting:!1},this.fillHandle={isFilling:!1,startX:void 0,startY:void 0},this.hover={highlightScope:B.p.single,cellPos:{col:-1,row:-1}},this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,rowSourceSize:0,rowTargetSize:0,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new iz.YZ,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.scroll={horizontalBarPos:0,verticalBarPos:0},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}setHoverState(){var t;let{highlightMode:e,disableHover:i,disableHeaderHover:r}=null!=(t=this.table.options.hover)?t:{highlightMode:"cell"};i?this.hover.highlightScope=B.p.none:"cross"===e?this.hover.highlightScope=B.p.cross:"row"===e?this.hover.highlightScope=B.p.row:"column"===e?this.hover.highlightScope=B.p.column:"cell"===e&&(this.hover.highlightScope=B.p.single),this.hover.singleStyle=!i,this.hover.disableHeader=r,(this.hover.highlightScope===B.p.none||r)&&(this.hover.cellPosContainHeader={col:-1,row:-1})}setSelectState(){var t,e,i,r,n,s;let{headerSelectMode:l,disableSelect:a,disableHeaderSelect:o,highlightMode:h,highlightInRange:u}=Object.assign({},{headerSelectMode:"inline",disableSelect:!1,disableHeaderSelect:!1,highlightMode:"cell",highlightInRange:!1},this.table.options.select),d=(null==(t=this.table.options.select)?void 0:t.cornerHeaderSelectMode)?null==(e=this.table.options.select)?void 0:e.cornerHeaderSelectMode:"body"===(null==(i=this.table.options.select)?void 0:i.headerSelectMode)?null==(r=this.table.options.select)?void 0:r.headerSelectMode:"all";this.select.highlightScope=!0===a?B.p.none:"cross"===h?B.p.cross:"row"===h?B.p.row:"column"===h?B.p.column:B.p.single,this.select.singleStyle=!a,this.select.disableHeader=o,this.select.headerSelectMode=l,this.select.cornerHeaderSelectMode=d,this.select.highlightInRange=u,this.select.disableCtrlMultiSelect=!1===(null==(n=this.table.options.keyboardOptions)?void 0:n.ctrlMultiSelect),this.select.disableShiftMultiSelect=!1===(null==(s=this.table.options.keyboardOptions)?void 0:s.shiftMultiSelect)}isSelected(t,e){let i=!1;return this.select.ranges.forEach(r=>{(0,P._Z)(r,t,e)&&(i=!0)}),i}setSortState(t){let e=this,i=(t=!t||Array.isArray(t)?t:[t])&&t.reduce((t,i)=>{var r,n,s;let l=null==(r=function(t){let i=[];return function t(r,n=0){r.forEach(r=>{var s;let l=r.startInTotal?null!=(s=r.startInTotal+e.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?s:0:n;r.columns?t(r.columns,l):i.push(Object.assign(Object.assign({},r),{startIndex:l}))})}(t),i}(this.table.internalProps.columns))?void 0:r.find(t=>(null==t?void 0:t.field)===(null==i?void 0:i.field));return this.table.internalProps.transpose?t.push({field:i.field,order:i.order,row:null!=(n=(null==l?void 0:l.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?n:0,col:null==l?void 0:l.level}):t.push({field:i.field,order:i.order,col:null!=(s=(null==l?void 0:l.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?s:0,row:null==l?void 0:l.level}),t},[]);this.sort=i||[]}setFrozenState(){this.frozen.col=this.table.frozenColCount-1}updateInteractionState(t){if(this.interactionState===t)return;t===B.F.scrolling&&(this.interactionStateBeforeScroll=this.interactionState);let e=this.interactionState;this.interactionState=t,e===B.F.scrolling&&B.F.default}updateHoverhighlightScope(t){this.hover.highlightScope!==t&&(this.hover.highlightScope=t)}updateHoverPos(t,e){!function(t,e,i){var r;let{table:n}=t,{scenegraph:s}=n,{highlightScope:l,singleStyle:a,disableHeader:o,cellPos:h,cellPosContainHeader:u}=t.hover,d=h.col,c=h.row;if(l===B.p.none||o&&(u.col!==e||u.row!==i)){let t=u.col,r=u.row;s.hideHoverIcon(t,r),s.showHoverIcon(e,i),u.col=e,u.row=i}if((o&&n.isHeader(e,i)||l===B.p.none)&&(e=-1,i=-1),d===e&&c===i)return;h.col=e,h.row=i,(null==(r=t.table.options.customConfig)?void 0:r.disableBuildInChartActive)||(s.deactivateChart(d,c),s.activateChart(e,i));let p=!1,{ranges:g,highlightScope:f}=t.select;if(-1!==d&&-1!==c&&(p=function(t,e,i,r,n,s,l){let a=!1;return s===B.p.single?(iE(t,e,i),a=!0):s===B.p.row?a=!!iF(t,e,i,r,l)||a:s===B.p.column?a=!!iI(t,e,i,r,l)||a:s===B.p.cross&&(a=!!iF(t,e,i,r,l)||a,a=!!iI(t,e,i,r,l)||a),a}(s,d,c,g,0,l,f),o||s.hideHoverIcon(d,c)),-1===e||-1===i)return h.col=-1,h.row=-1,!p||d===e&&c===i||t.table.scenegraph.updateNextFrame();l===B.p.single?(iE(s,e,i),p=!0):l===B.p.row?p=!!iO(s,e,i,g,f,a)||p:l===B.p.column?p=!!iL(s,e,i,g,f,a)||p:l===B.p.cross&&(p=!!iO(s,e,i,g,f,a)||p,p=!!iL(s,e,i,g,f,a)||p),l===B.p.none||o||s.showHoverIcon(e,i),p&&t.table.scenegraph.updateNextFrame()}(this,t,e)}updateSelectPos(t,e,i=!1,r=!1,n=!1,s=!0,l=!1){-1!==e&&-1!==e&&(this.select.selecting=!0),t<0&&(t=-1),e<0&&(e=-1),t>this.table.colCount-1&&(t=this.table.colCount-1),e>this.table.rowCount-1&&(e=this.table.rowCount-1);let a=this.select.cellPos.col,o=this.select.cellPos.row;(function(t,e,i,r,n,s,l=!0,a=!1){var o,h;let{table:u,interactionState:d}=t,{scenegraph:c}=u,{cellPos:p}=t.select;if(t.select.isSelectAll=s,-1!==e&&-1!==i&&l&&u._makeVisibleCell(e,i),-1!==e&&-1!==i&&l)if(d===B.F.grabing&&t.select.ranges.length>0){let r=t.select.ranges[t.select.ranges.length-1];e>r.start.col&&e>r.end.col&&u._makeVisibleCell(e+1,i),i>r.start.row&&i>r.end.row&&u._makeVisibleCell(e,i+1),e<r.start.col&&e<r.end.col&&u._makeVisibleCell(e-1,i),i<r.start.row&&i<r.end.row&&u._makeVisibleCell(e,i-1)}else u._makeVisibleCell(e,i);if(s){t.select.ranges=[],c.deleteAllSelectBorder();let e=0,i=0,{disableHeaderSelect:r,disableRowSeriesNumberSelect:n}=(null==(o=u.options.keyboardOptions)?void 0:o.selectAllOnCtrlA)||{};r&&(e=u.rowHeaderLevelCount,i=u.columnHeaderLevelCount),(n||r&&u.transpose)&&u.options.rowSeriesNumber&&(e+=1),t.select.ranges.push({start:{col:e,row:i},end:{col:u.colCount-1,row:u.rowCount-1}});let s=t.select.ranges[t.select.ranges.length-1];c.updateCellSelectBorder(s,!1)}else if(-1===p.col||-1===p.row||-1!==e&&-1!==i)if(d!==B.F.default||u.eventManager.isDraging||u.stateManager.isResizeCol()){if((d===B.F.grabing||u.eventManager.isDraging)&&!u.stateManager.isResizeCol()){let r=!0;-1===p.col&&(p.col=e),-1===p.row&&(p.row=i),p.col=e,p.row=i;let n=t.select.ranges[t.select.ranges.length-1];if(n){if(u.internalProps.layoutMap.isSeriesNumberInBody(n.start.col,n.start.row))r=!1,n.end={col:u.colCount-1,row:i};else if(t.fillHandle.isFilling){if("top"===t.fillHandle.direction)if(i===t.fillHandle.beforeFillMinRow&&i===t.fillHandle.beforeFillMaxRow)n.start.row=n.end.row=i;else if(i<=t.fillHandle.beforeFillMinRow){if(n.start.row<n.end.row){let t=n.start.row;n.start.row=n.end.row,n.end.row=t}n.end.row=i}else i===t.fillHandle.beforeFillMaxRow&&(n.start.row>n.end.row?n.start.row=i:n.end.row=i);else if("bottom"===t.fillHandle.direction){if(i>=t.fillHandle.beforeFillMaxRow){if(n.start.row>n.end.row){let t=n.start.row;n.start.row=n.end.row,n.end.row=t}n.end.row=i}}else if("left"===t.fillHandle.direction)if(e===t.fillHandle.beforeFillMinCol&&e===t.fillHandle.beforeFillMaxCol)n.start.col=n.end.col=e;else if(e<=t.fillHandle.beforeFillMinCol){if(n.start.col<n.end.col){let t=n.start.col;n.start.col=n.end.col,n.end.col=t}n.end.col=e}else e===t.fillHandle.beforeFillMaxCol&&(n.start.col>n.end.col?n.start.col=e:n.end.col=e);else if("right"===t.fillHandle.direction&&e>=t.fillHandle.beforeFillMaxCol){if(n.start.col>n.end.col){let t=n.start.col;n.start.col=n.end.col,n.end.col=t}n.end.col=e}}else{n.end={col:e,row:i};let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:u.getCellRange(e,i);n.start.col<r.end.col?n.end.col=r.end.col:n.start.col>r.start.col&&(n.end.col=r.start.col),n.start.row<r.end.row?n.end.row=r.end.row:n.start.row>r.start.row&&(n.end.row=r.start.row),"body"===t.select.headerSelectMode&&(u.isRowHeader(e,i)?(n.start.col=u.rowHeaderLevelCount+u.leftRowSeriesNumberCount,n.end.col=u.colCount-1):u.isColumnHeader(e,i)?(n.start.row=u.columnHeaderLevelCount,n.end.row=u.rowCount-1):u.internalProps.layoutMap.isSeriesNumberInBody(e,i)?(n.start.col=u.leftRowSeriesNumberCount,n.end.col=u.colCount-1):u.isCornerHeader(e,i)?(n.start.col=u.rowHeaderLevelCount+u.leftRowSeriesNumberCount,n.start.row=u.columnHeaderLevelCount,n.end.col=u.colCount-1,n.end.row=u.rowCount-1):u.isSeriesNumber(e,i)&&(n.start.col=u.leftRowSeriesNumberCount,n.start.row=u.columnHeaderLevelCount,n.end.col=u.colCount-1,n.end.row=u.rowCount-1)),a&&(n.skipBodyMerge=!0)}n&&n.start.row<=u.rowCount-1&&n.end.row<=u.rowCount-1&&n.start.col<=u.colCount-1&&n.end.col<=u.colCount-1&&c.updateCellSelectBorder(n,r)}}}else{let s=t.select.ranges[t.select.ranges.length-1];if(r&&s){if("cell"!==t.select.headerSelectMode&&u.isColumnHeader(e,i)){let r=Math.min(s.start.col,s.end.col,e),n=Math.max(s.start.col,s.end.col,e),l=Math.min(s.start.row,s.end.row,i),a=u.rowCount-1;"body"===t.select.headerSelectMode?(s.start={col:r,row:u.columnHeaderLevelCount},s.end={col:n,row:u.rowCount-1}):(s.start={col:r,row:l},s.end={col:n,row:a})}else if("cell"!==t.select.headerSelectMode&&u.isRowHeader(e,i)){let r=Math.min(s.start.col,s.end.col,e),n=u.colCount-1,l=Math.min(s.start.row,s.end.row,i),a=Math.max(s.start.row,s.end.row,i);"body"===t.select.headerSelectMode?(s.start={col:u.leftRowSeriesNumberCount+u.rowHeaderLevelCount,row:l},s.end={col:u.colCount-1,row:a}):(s.start={col:r,row:l},s.end={col:n,row:a})}else if("cell"!==t.select.headerSelectMode&&u.isSeriesNumberInBody(e,i)){let r=Math.min(s.start.col,s.end.col,e),n=u.colCount-1,l=Math.min(s.start.row,s.end.row,i),a=Math.max(s.start.row,s.end.row,i);"body"===t.select.headerSelectMode?(s.start={col:u.leftRowSeriesNumberCount,row:l},s.end={col:u.colCount-1,row:a}):(s.start={col:r,row:l},s.end={col:n,row:a})}else s.end={col:e,row:i};r||(s.end=s.start),c.deleteLastSelectedRangeComponents(),c.updateCellSelectBorder(s)}else{let r=!0;if(-1===p.col||-1===p.row||n||(t.select.ranges=[],c.deleteAllSelectBorder()),"cell"!==t.select.headerSelectMode&&u.isColumnHeader(e,i)){let r=u.getCellRange(e,i);"body"===t.select.headerSelectMode?t.select.ranges.push({start:{col:r.start.col,row:u.columnHeaderLevelCount},end:{col:r.end.col,row:u.rowCount-1},skipBodyMerge:!0}):t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:u.rowCount-1},skipBodyMerge:!0})}else if("cell"!==t.select.headerSelectMode&&u.isRowHeader(e,i)){let r=u.getCellRange(e,i);"body"===t.select.headerSelectMode?t.select.ranges.push({start:{col:u.rowHeaderLevelCount+u.leftRowSeriesNumberCount,row:r.start.row},end:{col:u.colCount-1,row:r.end.row},skipBodyMerge:!0}):t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:u.colCount-1,row:r.end.row},skipBodyMerge:!0})}else if(u.internalProps.layoutMap.isSeriesNumberInHeader(e,i)){r=!1;let{cornerHeaderSelectMode:n}=t.select;if("body"===n)t.select.ranges.push({start:{col:u.leftRowSeriesNumberCount,row:u.columnHeaderLevelCount},end:{col:u.colCount-1,row:u.rowCount-1},skipBodyMerge:!0});else if("inline"===n){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:u.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:u.rowCount-1},skipBodyMerge:!0})}else if("cell"===n){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:u.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:r.end.row},skipBodyMerge:a||void 0})}else t.select.ranges.push({start:{col:0,row:0},end:{col:u.colCount-1,row:u.rowCount-1},skipBodyMerge:!0})}else if(u.internalProps.layoutMap.isSeriesNumberInBody(e,i))r=!1,"body"===t.select.headerSelectMode?t.select.ranges.push({start:{col:u.leftRowSeriesNumberCount,row:i},end:{col:u.colCount-1,row:i},skipBodyMerge:!0}):t.select.ranges.push({start:{col:e,row:i},end:{col:u.colCount-1,row:i},skipBodyMerge:!0});else if(u.internalProps.layoutMap.isCornerHeader(e,i)){r=!1;let{cornerHeaderSelectMode:n}=t.select;if("body"===n)t.select.ranges.push({start:{col:u.rowHeaderLevelCount+u.leftRowSeriesNumberCount,row:u.columnHeaderLevelCount},end:{col:u.colCount-1,row:u.rowCount-1},skipBodyMerge:!0});else if("cell"===n){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:u.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:r.end.row},skipBodyMerge:a||void 0})}else if("inline"===n){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:u.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:u.rowCount-1},skipBodyMerge:!0})}else t.select.ranges.push({start:{col:u.leftRowSeriesNumberCount,row:0},end:{col:u.colCount-1,row:u.rowCount-1},skipBodyMerge:!0})}else if(e>=0&&i>=0){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:u.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:r.end.row},skipBodyMerge:a||void 0})}p.col=e,p.row=i;let s=null==(h=t.select.ranges)?void 0:h[t.select.ranges.length-1];s&&s.start.row<=u.rowCount-1&&s.end.row<=u.rowCount-1&&s.start.col<=u.colCount-1&&s.end.col<=u.colCount-1&&c.updateCellSelectBorder(s,r)}}else p.col=-1,p.row=-1,t.select.ranges=[],c.deleteAllSelectBorder();c.updateNextFrame()})(this,t,e,i,r,n,s,l),this.table.hasListeners(E.B.SELECTED_CHANGED)&&(a!==t||o!==e)&&this.table.fireListeners(E.B.SELECTED_CHANGED,{ranges:this.select.ranges,col:t,row:e})}checkCellRangeInSelect(t,e){return function(t,e,i,r){for(let r=0;r<i.length;r++){let n=i[r];if((0,P.ib)(n,{start:t,end:e}))return!0}return!1}(t,e,this.select.ranges,this.select.highlightScope)}updateHoverIcon(t,e,i,r){var n,s,l,a,o,h,u,d,c;if((null==(n=this.residentHoverIcon)?void 0:n.icon)&&i===(null==(s=this.residentHoverIcon)?void 0:s.icon))return;let p=ij(i);if(p)if("richtext-icon"===p.type){let i=p.icon;if(this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(a=this.residentHoverIcon)?void 0:a.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame()),i.attribute.tooltip){let r={content:i.attribute.tooltip.title,referencePosition:{rect:p.position,placement:i.attribute.tooltip.placement},style:Object.assign({},null==(o=this.table.internalProps.theme)?void 0:o.tooltipStyle,null==(h=i.tooltip)?void 0:h.style,null==(d=null==(u=i.attribute)?void 0:u.tooltip)?void 0:d.style),disappearDelay:i.attribute.tooltip.disappearDelay};this.table.internalProps.tooltipHandler.isBinded(r)||this.table.showTooltip(t,e,r)}}else{let i=p.icon;i!==this.hoverIcon.icon&&(this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(c=this.residentHoverIcon)?void 0:c.icon)&&this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=t,this.hoverIcon.row=e,this.hoverIcon.icon=i,this.table.scenegraph.setIconHoverStyle(i,t,e,r),this.table.scenegraph.updateNextFrame())}else this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(l=this.residentHoverIcon)?void 0:l.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame())}isResizeCol(){return this.columnResize.resizing}isResizeRow(){return this.rowResize.resizing}isFillHandle(){return this.fillHandle.isFilling}isSelecting(){return this.select.selecting}endSelectCells(t=!0,e=!0){if(this.select.selecting){if(this.select.selecting=!1,0===this.select.ranges.length)return;let e=this.select.ranges[this.select.ranges.length-1];this.table.isSeriesNumber(this.select.cellPos.col,this.select.cellPos.row)||this.table.isHeader(this.select.cellPos.col,this.select.cellPos.row)||(0,ti.T)(e,this.table);let i=!1;for(let t=0;t<this.select.ranges.length-1;t++){let r=this.select.ranges[t];if(r&&r.start.col===e.start.col&&r.start.row===e.start.row&&r.end.col===e.end.col&&r.end.row===e.end.row){i=!0;break}}i?(this.select.ranges.pop(),ie(this.table.scenegraph),this.table.scenegraph.selectingRangeComponents.clear()):this.table.scenegraph.moveSelectingRangeComponentsToSelectedRangeComponents();let r=this.select.ranges[this.select.ranges.length-1].end.col,n=this.select.ranges[this.select.ranges.length-1].end.row;t&&this.table.fireListeners(E.B.SELECTED_CELL,{ranges:this.select.ranges,col:r,row:n})}else e&&0===this.select.ranges.length&&this.table.fireListeners(E.B.SELECTED_CLEAR,{})}endResizeCol(){setTimeout(()=>{this.columnResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeColWidth(this.columnResize.col),this.checkFrozen(),this.table.scenegraph.component.hideResizeCol(),this.table.scenegraph.updateNextFrame()}startResizeCol(t,e,i,r){this.columnResize.resizing=!0,this.columnResize.col=t,this.columnResize.x=e,this.columnResize.isRightFrozen=r,this.table.scenegraph.component.showResizeCol(t,i,r),this.table.scenegraph.updateNextFrame()}updateResizeCol(t,e){!function(t,e,i){t=Math.ceil(t),e=Math.ceil(e);let r=i.columnResize.isRightFrozen?i.columnResize.x-t:t-i.columnResize.x;if(1>Math.abs(r))return;let n=i.table.getColWidth(i.columnResize.col),s=n;s+=r;let l=i.table.getMinColWidth(i.columnResize.col),a=i.table.getMaxColWidth(i.columnResize.col);if(s<l||s>a){if(n===l||n===a)return;r=n-l>a-n?a-n:l-n}let o=i.table.getColWidth(i.columnResize.col)+r;if(o<i.table.internalProps.limitMinWidth&&(r=(o=i.table.internalProps.limitMinWidth)-i.table.getColWidth(i.columnResize.col)),"adaptive"===i.table.widthMode&&i.columnResize.col<i.table.colCount-1){let t=i.table.getColWidth(i.columnResize.col+1),e=i.table.getMinColWidth(i.columnResize.col+1),n=i.table.getMaxColWidth(i.columnResize.col+1),s=t;if((s-=r)<e||s>n){if(t===e||t===n)return;r=t-e>n-t?n-t:e-t}s-r<i.table.internalProps.limitMinWidth&&(r=s-i.table.internalProps.limitMinWidth)}r=Math.ceil(r),i.columnResize.col<i.table.rowHeaderLevelCount||i.columnResize.col>=i.table.colCount-i.table.rightFrozenColCount?iV(r,i):"indicator"===i.table.internalProps.columnResizeType?function(t,e){let i,r,n,s=e.table.internalProps.layoutMap;if(s.indicatorsAsCol)i=s.getIndicatorKey(e.columnResize.col,e.table.columnHeaderLevelCount);else{let t=s.getCellHeaderPaths(e.columnResize.col,e.table.columnHeaderLevelCount-1),i=t.colHeaderPaths[t.colHeaderPaths.length-1];r=i.dimensionKey,n=i.value}for(let l=e.table.rowHeaderLevelCount;l<e.table.colCount-e.table.rightFrozenColCount;l++){let a=s.getIndicatorKey(l,e.table.columnHeaderLevelCount);if(s.indicatorsAsCol&&a===i)e.table.scenegraph.updateColWidth(l,t),e.table.internalProps._widthResizedColMap.add(l);else if(!s.indicatorsAsCol){let i=s.getCellHeaderPaths(l,e.table.columnHeaderLevelCount-1),a=null==i?void 0:i.colHeaderPaths[i.colHeaderPaths.length-1];a&&r===a.dimensionKey&&n===a.value&&(e.table.scenegraph.updateColWidth(l,t),e.table.internalProps._widthResizedColMap.add(l))}}}(r,i):"indicatorGroup"===i.table.internalProps.columnResizeType?function(t,e){let i=e.table.internalProps.layoutMap,r=i.getCellHeaderPaths(e.columnResize.col,e.table.columnHeaderLevelCount),n=i.getHeadNodeByRowOrColDimensions(r.colHeaderPaths.slice(0,r.colHeaderPaths.length-1)),s=n.startInTotal+e.table.frozenColCount,l=n.startInTotal+e.table.frozenColCount+n.size-1,a=e.table.getColsWidth(s,l);for(let r=s;r<=l;r++){if(!(e.table.internalProps.transpose||e.table.isPivotTable()&&!i.indicatorsAsCol)){let t=i.getBody(r,e.table.columnHeaderLevelCount);if(null==t?void 0:t.disableColumnResize)continue}let n=e.table.getColWidth(r)/a*t;n>0&&n<.5?n=.5:n<0&&n>=-.5&&(n=-.5),e.table.scenegraph.updateColWidth(r,n),e.table.internalProps._widthResizedColMap.add(r)}}(r,i):"all"===i.table.internalProps.columnResizeType?function(t,e){let i=e.table.internalProps.layoutMap;for(let r=e.table.frozenColCount;r<e.table.colCount-e.table.rightFrozenColCount;r++){if(!(e.table.internalProps.transpose||e.table.isPivotTable()&&!i.indicatorsAsCol)){let t=i.getBody(r,e.table.columnHeaderLevelCount);if(null==t?void 0:t.disableColumnResize)continue}e.table.scenegraph.updateColWidth(r,t),e.table.internalProps._widthResizedColMap.add(r)}}(r,i):iV(r,i),i.columnResize.x=t,i.table.scenegraph.component.updateResizeCol(i.columnResize.col,e,i.columnResize.isRightFrozen),i.table._updateSize(),!(i.columnResize.col<i.table.frozenColCount)||i.table.isPivotTable()||i.table.transpose?i.table.options.frozenColCount&&i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1):i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1,i.columnResize.isRightFrozen),(i.columnResize.col>=i.table.colCount-i.table.rightFrozenColCount&&!i.table.isPivotTable()&&!i.table.transpose||i.table.options.rightFrozenColCount)&&i.table.scenegraph.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount),i.table.scenegraph.updateNextFrame()}(t,e,this)}endResizeRow(){setTimeout(()=>{this.rowResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeRowHeight(this.rowResize.row),this.table.scenegraph.component.hideResizeRow(),this.table.scenegraph.updateNextFrame()}startResizeRow(t,e,i,r){this.rowResize.resizing=!0,this.rowResize.row=t,this.rowResize.y=i,this.rowResize.isBottomFrozen=r,this.table.scenegraph.component.showResizeRow(t,e,r),this.table.scenegraph.updateNextFrame()}updateResizeRow(t,e){!function(t,e,i){t=Math.ceil(t),e=Math.ceil(e);let r=i.rowResize.isBottomFrozen?i.rowResize.y-e:e-i.rowResize.y;if(1>Math.abs(r))return;i.table.getRowHeight(i.rowResize.row);let n=i.table.getRowHeight(i.rowResize.row)+r;if(n<i.table.internalProps.limitMinHeight&&(r=(n=i.table.internalProps.limitMinHeight)-i.table.getRowHeight(i.rowResize.row)),"adaptive"===i.table.heightMode&&i.rowResize.row<i.table.rowCount-1){let t=i.table.getRowHeight(i.rowResize.row+1);(t-=r)-r<i.table.internalProps.limitMinHeight&&(r=t-i.table.internalProps.limitMinHeight)}r=Math.ceil(r),i.rowResize.row<i.table.columnHeaderLevelCount||i.rowResize.row>=i.table.rowCount-i.table.bottomFrozenRowCount?iK(r,i):"indicator"===i.table.internalProps.rowResizeType?function(t,e){var i,r;let n,s,l,a=e.table.internalProps.layoutMap;if(a.indicatorsAsCol){let t=a.getCellHeaderPaths(e.table.rowHeaderLevelCount-1,e.rowResize.row),r=null==(i=t.rowHeaderPaths)?void 0:i[t.rowHeaderPaths.length-1];s=null==r?void 0:r.dimensionKey,l=null==r?void 0:r.value}else n=a.getIndicatorKey(e.table.rowHeaderLevelCount,e.rowResize.row);for(let i=e.table.columnHeaderLevelCount;i<e.table.rowCount-e.table.bottomFrozenRowCount;i++){let o=a.getIndicatorKey(e.table.rowHeaderLevelCount,i);if(a.indicatorsAsCol||o!==n){if(a.indicatorsAsCol){let n=a.getCellHeaderPaths(e.table.rowHeaderLevelCount-1,i),o=null==(r=null==n?void 0:n.rowHeaderPaths)?void 0:r[n.rowHeaderPaths.length-1];o&&s===o.dimensionKey&&l===o.value&&(e.table.scenegraph.updateRowHeight(i,t),e.table.internalProps._heightResizedRowMap.add(i))}}else e.table.scenegraph.updateRowHeight(i,t),e.table.internalProps._heightResizedRowMap.add(i)}}(r,i):"indicatorGroup"===i.table.internalProps.rowResizeType?function(t,e){let i=e.table.internalProps.layoutMap,r=i.getCellHeaderPaths(e.table.rowHeaderLevelCount,e.rowResize.row),n=i.getHeadNodeByRowOrColDimensions(r.rowHeaderPaths.slice(0,r.rowHeaderPaths.length-1)),s=n.startInTotal+e.table.frozenRowCount,l=n.startInTotal+e.table.frozenRowCount+n.size-1,a=e.table.getRowsHeight(s,l);for(let i=s;i<=l;i++){let r=e.table.getRowHeight(i)/a*t;r>0&&r<.5?r=.5:r<0&&r>=-.5&&(r=-.51),e.table.scenegraph.updateRowHeight(i,r),e.table.internalProps._heightResizedRowMap.add(i)}}(r,i):"all"===i.table.internalProps.rowResizeType?function(t,e){for(let i=e.table.frozenRowCount;i<e.table.rowCount-e.table.bottomFrozenRowCount;i++)e.table.scenegraph.updateRowHeight(i,t),e.table.internalProps._heightResizedRowMap.add(i)}(r,i):iK(r,i),i.rowResize.y=e,i.table.scenegraph.component.updateResizeRow(i.rowResize.row,t,i.rowResize.isBottomFrozen),i.table._updateSize(),i.table.scenegraph.updateNextFrame()}(t,e,this)}startFillSelect(t,e){this.fillHandle.isFilling=!0,this.fillHandle.startX=t,this.fillHandle.startY=e;let i=this.select.ranges[this.select.ranges.length-1];this.fillHandle.beforeFillMinCol=Math.min(i.start.col,i.end.col),this.fillHandle.beforeFillMinRow=Math.min(i.start.row,i.end.row),this.fillHandle.beforeFillMaxCol=Math.max(i.start.col,i.end.col),this.fillHandle.beforeFillMaxRow=Math.max(i.start.row,i.end.row),this.table.fireListeners(E.B.MOUSEDOWN_FILL_HANDLE,{})}endFillSelect(){this.fillHandle.isFilling=!1,this.fillHandle.startX=void 0,this.fillHandle.startY=void 0,this.fillHandle.directionRow=void 0;let t=Math.min(this.select.ranges[0].start.col,this.select.ranges[0].end.col),e=Math.min(this.select.ranges[0].start.row,this.select.ranges[0].end.row),i=Math.max(this.select.ranges[0].start.col,this.select.ranges[0].end.col),r=Math.max(this.select.ranges[0].start.row,this.select.ranges[0].end.row);this.fillHandle.beforeFillMinCol===t&&this.fillHandle.beforeFillMinRow===e&&this.fillHandle.beforeFillMaxCol===i&&this.fillHandle.beforeFillMaxRow===r||this.table.eventManager.isDraging&&this.table.fireListeners(E.B.DRAG_FILL_HANDLE_END,{direction:this.fillHandle.direction}),this.fillHandle.beforeFillMaxCol=void 0,this.fillHandle.beforeFillMaxRow=void 0,this.fillHandle.beforeFillMinCol=void 0,this.fillHandle.beforeFillMinRow=void 0}startMoveCol(t,e,i,r,n){!function(t,e,i,r,n,s){var l;if(!("canMoveHeaderPosition"in n.table.internalProps.layoutMap))return;if(n.columnMove.moving=!0,n.columnMove.colSource=t,n.columnMove.rowSource=e,n.table.isListTable()){let i=n.table.getRecordIndexByCell(t,e),r=n.table.getRecordByCell(t,e),s=n.table.getRecordHierarchyState(t,e);n.columnMove.rowSourceSize=(0,O.pr)(i,s,r)+1}n.columnMove.x=i-n.table.tableX,n.columnMove.y=r-n.table.tableY;let a=n.table.getCellLocation(t,e),o="columnHeader"===a?n.columnMove.x:"rowHeader"===a||n.table.internalProps.layoutMap.isSeriesNumberInBody(t,e)?n.columnMove.y:0,{backX:h,lineX:u,backY:d,lineY:c}=n.table.scenegraph.component.showMoveCol(t,e,o);n.table.fireListeners(E.B.CHANGE_HEADER_POSITION_START,{col:t,row:e,x:i,y:r,backX:h,lineX:u,backY:d,lineY:c,event:s});let p=!!(null==(l=n.select.ranges)?void 0:l.length);n.table.stateManager.updateSelectPos(-1,-1),n.table.stateManager.endSelectCells(!0,p),n.table.scenegraph.updateNextFrame()}(t,e,i,r,this,n)}updateMoveCol(t,e,i,r,n){!function(t,e,i,r,n,s){if(!("canMoveHeaderPosition"in n.table.internalProps.layoutMap))return;let l=function(t,e,i){let r=i.getCellRange(t.col,t.row);if(i.isColumnHeader(t.col,t.row)){let n=i.getCellRange(e.col,r.start.row);e.row>=i.columnHeaderLevelCount&&(e.row=i.columnHeaderLevelCount-1),e.col>=t.col?e.col=n.end.col:e.col=n.start.col}else if(i.isRowHeader(t.col,t.row)){let n=i.internalProps.layoutMap,s=i.getCellRange(r.start.col,e.row);if(e.col>=i.rowHeaderLevelCount+n.leftRowSeriesNumberColumnCount&&(e.col=i.rowHeaderLevelCount+n.leftRowSeriesNumberColumnCount-1),"tree"===n.rowHierarchyType){let r=n.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,s=n.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths;if(r.length<=s.length){let n=s[r.length-1];n&&(e.row>=t.row?e.row=n.startInTotal+n.size-1+i.columnHeaderLevelCount:e.row=n.startInTotal+i.columnHeaderLevelCount)}}else e.row>=t.row?e.row=s.end.row:e.row=s.start.row}return e}({col:n.columnMove.colSource,row:n.columnMove.rowSource},{col:t,row:e},n.table);if(n.table.internalProps.layoutMap.canMoveHeaderPosition({col:n.columnMove.colSource,row:n.columnMove.rowSource},{col:l.col,row:l.row})){let a,o,h,u;if(n.columnMove.x=i-n.table.tableX,n.columnMove.y=r-n.table.tableY,n.columnMove.colTarget=l.col,n.columnMove.rowTarget=l.row,n.table.isListTable()){let t=n.table.getRecordIndexByCell(l.col,l.row),e=n.table.getRecordByCell(l.col,l.row),i=n.table.getRecordHierarchyState(l.col,l.row);n.columnMove.rowTargetSize=(0,O.pr)(t,i,e)+1}n.updateCursor("grabbing");let d=n.table.getCellLocation(n.columnMove.colSource,n.columnMove.rowSource);"columnHeader"===d?(o=n.columnMove.x,a=n.table.isLeftFrozenColumn(t)?n.columnMove.colTarget>=n.columnMove.colSource?n.table.getColsWidth(0,n.columnMove.colTarget):n.table.getColsWidth(0,n.columnMove.colTarget-1):n.table.isRightFrozenColumn(t)?n.table.tableNoFrameWidth-n.table.getColsWidth(l.col+1,n.table.colCount-1):(n.columnMove.colTarget>=n.columnMove.colSource?n.table.getColsWidth(0,n.columnMove.colTarget):n.table.getColsWidth(0,n.columnMove.colTarget-1))-n.table.stateManager.scroll.horizontalBarPos):("rowHeader"===d||n.table.internalProps.layoutMap.isSeriesNumberInBody(t,e))&&(u=n.columnMove.y,h=n.table.isFrozenRow(e)?n.columnMove.rowTarget>=n.columnMove.rowSource?n.table.getRowsHeight(0,n.columnMove.rowTarget):n.table.getRowsHeight(0,n.columnMove.rowTarget-1):n.table.isBottomFrozenRow(e)?n.table.tableNoFrameHeight-n.table.getRowsHeight(l.row+1,n.table.rowCount-1):(n.columnMove.rowTarget>=n.columnMove.rowSource?n.table.getRowsHeight(0,n.columnMove.rowTarget):n.table.getRowsHeight(0,n.columnMove.rowTarget-1))-n.table.stateManager.scroll.verticalBarPos),n.table.scenegraph.component.updateMoveCol(o,a,u,h),n.table.fireListeners(E.B.CHANGING_HEADER_POSITION,{col:t,row:e,x:i,y:r,backX:o,lineX:a,backY:u,lineY:h,event:s}),n.table.scenegraph.updateNextFrame()}else n.updateCursor("not-allowed"),n.columnMove.colTarget=n.columnMove.colSource,n.columnMove.rowTarget=n.columnMove.rowSource}(t,e,i,r,this,n)}isMoveCol(){return this.columnMove.moving}endMoveCol(){return function(t){var e,i;let r=!1;if("canMoveHeaderPosition"in t.table.internalProps.layoutMap&&t.columnMove.moving&&t.columnMove.colSource>=0&&t.columnMove.rowSource>=0&&t.columnMove.colTarget>=0&&t.columnMove.rowTarget>=0&&!0!==(null==(e=t.table.options.customConfig)?void 0:e.notUpdateInColumnRowMove)){let e=t.table.getCellRange(t.columnMove.colSource,t.columnMove.rowSource),i=t.table.getCellRange(t.columnMove.colTarget,t.columnMove.rowTarget),n=t.table._moveHeaderPosition({col:t.columnMove.colSource,row:t.columnMove.rowSource},{col:t.columnMove.colTarget,row:t.columnMove.rowTarget});if(!n||n.targetIndex===n.sourceIndex)return t.updateCursor(),t.columnMove.moving=!1,delete t.columnMove.colSource,delete t.columnMove.rowSource,delete t.columnMove.colTarget,delete t.columnMove.rowTarget,t.table.scenegraph.component.hideMoveCol(),t.table.scenegraph.updateNextFrame(),!1;{t.table.internalProps.useOneRowHeightFillAll=!1,t.table.internalProps.layoutMap.clearCellRangeMap();let s=t.table.getCellRange(t.columnMove.colSource,t.columnMove.rowSource),l=t.table.getCellRange(t.columnMove.colTarget,t.columnMove.rowTarget),a=Math.min(s.start.col,l.start.col,e.start.col,i.start.col),o=Math.max(s.end.col,l.end.col,e.end.col,i.end.col),h=Math.min(s.start.row,l.start.row,e.start.row,i.start.row),u=Math.max(s.end.row,l.end.row,e.end.row,i.end.row);"row"===n.moveType&&"tree"===t.table.internalProps.layoutMap.rowHierarchyType&&(u=n.targetIndex>n.sourceIndex?u+n.targetSize-1:u+n.sourceSize-1),!t.table.transpose&&t.table.internalProps.layoutMap.isSeriesNumberInBody(t.columnMove.colSource,t.columnMove.rowSource)&&(t.table.changeRecordOrder(n.sourceIndex,n.targetIndex),t.changeCheckboxAndRadioOrder(n.sourceIndex,n.targetIndex)),"column"===n.moveType?iN(a,o,0,-1,t.table):iN(0,-1,h,u,t.table),t.table.clearCellStyleCache(),t.table.internalProps.layoutMap.isSeriesNumberInBody(t.columnMove.colSource,t.columnMove.rowSource)?t.table.scenegraph.updateHeaderPosition(t.table.scenegraph.proxy.colStart,t.table.scenegraph.proxy.colEnd,t.table.scenegraph.proxy.rowStart,t.table.scenegraph.proxy.rowEnd,n.moveType):"column"===n.moveType?t.table.scenegraph.updateHeaderPosition(a,o,0,-1,n.moveType):t.table.scenegraph.updateHeaderPosition(0,-1,h,u,n.moveType),"adjustFrozenCount"===t.table.internalProps.frozenColDragHeaderMode&&t.table.isListTable()&&(t.table.isLeftFrozenColumn(t.columnMove.colTarget)&&!t.table.isLeftFrozenColumn(t.columnMove.colSource)?t.table.frozenColCount+=s.end.col-s.start.col+1:t.table.isLeftFrozenColumn(t.columnMove.colSource)&&!t.table.isLeftFrozenColumn(t.columnMove.colTarget)&&(t.table.frozenColCount-=s.end.col-s.start.col+1),t.table.isRightFrozenColumn(t.columnMove.colTarget)&&!t.table.isRightFrozenColumn(t.columnMove.colSource)?t.table.rightFrozenColCount+=s.end.col-s.start.col+1:t.table.isRightFrozenColumn(t.columnMove.colSource)&&!t.table.isRightFrozenColumn(t.columnMove.colTarget)&&(t.table.rightFrozenColCount-=s.end.col-s.start.col+1)),r=!0}}return t.columnMove.moving=!1,setTimeout(()=>{delete t.columnMove.colSource,delete t.columnMove.rowSource,delete t.columnMove.colTarget,delete t.columnMove.rowTarget},0),t.table.scenegraph.component.hideMoveCol(),!(t.columnResize.col<t.table.frozenColCount)||t.table.isPivotTable()||t.table.transpose?!(t.columnResize.col>=t.table.colCount-t.table.rightFrozenColCount)||t.table.isPivotTable()||t.table.transpose?t.table.options.frozenColCount?t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.rightFrozenColCount&&t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):(t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1,t.columnResize.isRightFrozen),t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.table.scenegraph.updateNextFrame(),!0===(null==(i=t.table.options.customConfig)?void 0:i.notUpdateInColumnRowMove)||r}(this)}checkFrozen(){var t;let e=this.table.options.frozenColCount?this.table.options.frozenColCount:this.table.isPivotTable()||this.table.isListTable()&&this.table.internalProps.transpose?(null!=(t=this.table.rowHeaderLevelCount)?t:0)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount:0;if(e){e=Math.min(e,this.table.colCount);let t=this.table.getContainer();if(t&&0===t.clientWidth){if(this._frozenObserver)return;return this._frozenObserver=new ResizeObserver(t=>{for(let e of t)if(e.contentRect.width>0)return this.clearFrozenObserver(),this.table.resize(),void setTimeout(()=>{this.checkFrozen()},0)}),void this._frozenObserver.observe(t)}if(this.table.getColsWidth(0,e-1)>this.table._getMaxFrozenWidth())if(this.table.internalProps.unfreezeAllOnExceedsMaxWidth)this.table._setFrozenColCount(0),this.setFrozenCol(-1);else{let t=this.table._getComputedFrozenColCount(e);this.table._setFrozenColCount(t),this.setFrozenCol(t)}else this.table.frozenColCount!==e&&(this.table._setFrozenColCount(e),this.setFrozenCol(e))}else this.clearFrozenObserver()}clearFrozenObserver(){this._frozenObserver&&(this._frozenObserver.disconnect(),this._frozenObserver=null)}setFrozenCol(t){t!==this.frozen.col&&(this.frozen.col=t,this.table.scenegraph.updateFrozen()),this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)}setFrozenRow(t){t!==this.frozen.row&&(this.frozen.row=t,this.table.scenegraph.updateRowFrozen())}checkVerticalScrollBarEnd(){var t,e;let i=this.table.getAllRowsHeight(),r=this.scroll.verticalBarPos,n=this.table.tableNoFrameHeight;r+n>=i&&this.table.fireListeners(E.B.SCROLL_VERTICAL_END,{scrollTop:r,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(t=this.table.theme.scrollStyle)?void 0:t.width,scrollWidth:null==(e=this.table.theme.scrollStyle)?void 0:e.width,viewHeight:n,viewWidth:this.table.tableNoFrameWidth})}checkHorizontalScrollBarEnd(){var t,e;let i=this.table.getAllColsWidth(),r=this.scroll.horizontalBarPos,n=this.table.tableNoFrameWidth;r+n>=i&&this.table.fireListeners(E.B.SCROLL_HORIZONTAL_END,{scrollTop:this.scroll.verticalBarPos,scrollLeft:r,scrollHeight:null==(t=this.table.theme.scrollStyle)?void 0:t.width,scrollWidth:null==(e=this.table.theme.scrollStyle)?void 0:e.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:n})}updateVerticalScrollBar(t){var e,i,r,n;let s=this.table.getAllRowsHeight(),l=this.scroll.verticalBarPos,a=Math.ceil(t*(s-this.table.scenegraph.height));(0,y.Z)(a)&&!isNaN(a)||(a=0);let o=a-this.table.scenegraph.proxy.deltaY-l;if(this.table.fireListeners(E.B.CAN_SCROLL,{event:void 0,scrollTop:a-this.table.scenegraph.proxy.deltaY,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(e=this.table.theme.scrollStyle)?void 0:e.width,scrollWidth:null==(i=this.table.theme.scrollStyle)?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:t,dy:o}).some(t=>!1===t)){let t=this.scroll.verticalBarPos/(s-this.table.scenegraph.height);this.table.scenegraph.component.updateVerticalScrollBarPos(t)}else this.scroll.verticalBarPos=a,this.table.scenegraph.setY(-this.scroll.verticalBarPos,1===t),this.scroll.verticalBarPos-=this.table.scenegraph.proxy.deltaY,this.table.scenegraph.proxy.deltaY=0,this.updateHoverPos(-1,-1),this.table.fireListeners(E.B.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(r=this.table.theme.scrollStyle)?void 0:r.width,scrollWidth:null==(n=this.table.theme.scrollStyle)?void 0:n.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:t,dy:o}),l!==this.scroll.verticalBarPos&&this.checkVerticalScrollBarEnd()}updateHorizontalScrollBar(t){var e,i,r,n;let s=this.table.getAllColsWidth(),l=this.scroll.horizontalBarPos,a=Math.ceil(t*(s-this.table.scenegraph.width));(0,y.Z)(a)&&!isNaN(a)||(a=0);let o=a-this.table.scenegraph.proxy.deltaX-l;if(this.table.fireListeners(E.B.CAN_SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:a-this.table.scenegraph.proxy.deltaX,scrollHeight:null==(e=this.table.theme.scrollStyle)?void 0:e.width,scrollWidth:null==(i=this.table.theme.scrollStyle)?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:t,dx:o}).some(t=>!1===t)){let t=this.scroll.horizontalBarPos/(s-this.table.scenegraph.width);this.table.scenegraph.component.updateHorizontalScrollBarPos(t)}else this.scroll.horizontalBarPos=a,this.table.scenegraph.setX(-this.scroll.horizontalBarPos,1===t),this.scroll.horizontalBarPos-=this.table.scenegraph.proxy.deltaX,this.table.scenegraph.proxy.deltaX=0,this.updateHoverPos(-1,-1),this.table.fireListeners(E.B.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(r=this.table.theme.scrollStyle)?void 0:r.width,scrollWidth:null==(n=this.table.theme.scrollStyle)?void 0:n.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:t,dx:o}),l!==this.scroll.horizontalBarPos&&this.checkHorizontalScrollBarEnd()}setScrollTop(t,e,i=!0){var r,n,s,l,a,o,h;let u=this.table.getAllRowsHeight(),d=+(null!=(r=this.table.options.customConfig)&&!!r._disableColumnAndRowSizeRound);t=Math.ceil(t=Math.max(0,Math.min(t,u-this.table.scenegraph.height-d)));let c=this.scroll.verticalBarPos,p=t/(u-this.table.scenegraph.height);if((c!==t||!0===(null==(s=null==(n=this.table.options)?void 0:n.customConfig)?void 0:s.scrollEventAlwaysTrigger))&&i){let i=t;(0,y.Z)(i)&&!isNaN(i)||(i=0);let r=i-c;if(this.table.fireListeners(E.B.CAN_SCROLL,{event:null==e?void 0:e.nativeEvent,scrollTop:i,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(l=this.table.theme.scrollStyle)?void 0:l.width,scrollWidth:null==(a=this.table.theme.scrollStyle)?void 0:a.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:p,dy:r}).some(t=>!1===t)){let t=this.scroll.verticalBarPos/(u-this.table.scenegraph.height);return void this.table.scenegraph.component.updateVerticalScrollBarPos(t)}}(t!==this.scroll.verticalBarPos||this.table.isPivotChart())&&this.updateHoverPos(-1,-1),this.scroll.verticalBarPos=t,(0,y.Z)(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this.table.scenegraph.setY(-t),this.table.scenegraph.component.updateVerticalScrollBarPos(p);let g=this.scroll.verticalBarPos-c;this.table.fireListeners(E.B.SCROLL,{event:null==e?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(o=this.table.theme.scrollStyle)?void 0:o.width,scrollWidth:null==(h=this.table.theme.scrollStyle)?void 0:h.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:p,dy:g}),c!==t&&i&&this.checkVerticalScrollBarEnd()}setScrollLeft(t,e,i=!0){var r,n,s,l,a,o,h;this.table.scrollLeft;let u=this.table.getAllColsWidth(),d=(this.table.getFrozenColsWidth(),+(null!=(r=this.table.options.customConfig)&&!!r._disableColumnAndRowSizeRound));t=Math.ceil(t=Math.max(0,Math.min(t,u-this.table.scenegraph.width-d)));let c=this.scroll.horizontalBarPos,p=t/(u-this.table.scenegraph.width);if((c!==t||!0===(null==(s=null==(n=this.table.options)?void 0:n.customConfig)?void 0:s.scrollEventAlwaysTrigger))&&i){let i=t;(0,y.Z)(i)&&!isNaN(i)||(i=0);let r=i-c;if(this.table.fireListeners(E.B.CAN_SCROLL,{event:null==e?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:i,scrollHeight:null==(l=this.table.theme.scrollStyle)?void 0:l.width,scrollWidth:null==(a=this.table.theme.scrollStyle)?void 0:a.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:p,dx:r}).some(t=>!1===t)){let t=this.scroll.horizontalBarPos/(u-this.table.scenegraph.width);return void this.table.scenegraph.component.updateHorizontalScrollBarPos(t)}}t!==this.scroll.horizontalBarPos&&this.updateHoverPos(-1,-1),this.scroll.horizontalBarPos=t,(0,y.Z)(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this.table.scenegraph.setX(-t),this.table.scenegraph.component.updateHorizontalScrollBarPos(p);let g=this.scroll.horizontalBarPos-c;this.table.fireListeners(E.B.SCROLL,{event:null==e?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(o=this.table.theme.scrollStyle)?void 0:o.width,scrollWidth:null==(h=this.table.theme.scrollStyle)?void 0:h.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:p,dx:g}),c!==t&&i&&this.checkHorizontalScrollBarEnd()}hideVerticalScrollBar(){this.table.scenegraph.component.hideVerticalScrollBar()}showVerticalScrollBar(t){this.table.scenegraph.component.showVerticalScrollBar(),t&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{var t;null==(t=this.table.scenegraph)||t.component.hideVerticalScrollBar()},1e3))}hideHorizontalScrollBar(){this.table.scenegraph.component.hideHorizontalScrollBar()}showHorizontalScrollBar(t){var e;this.table.scenegraph.component.showHorizontalScrollBar(),null==(e=this.table.scenegraph)||e.component.showFrozenColumnShadow(),t&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{var t,e;null==(t=this.table.scenegraph)||t.component.hideFrozenColumnShadow(),null==(e=this.table.scenegraph)||e.component.hideHorizontalScrollBar()},1e3))}triggerContextMenu(t,e,i,r){this.menu.isShow&&this.menu.x===i&&this.menu.y===r?this.hideMenu():this.showContextMenu(t,e,i,r)}showContextMenu(t,e,i,r){var n;(null==(n=this.table.internalProps.menu)?void 0:n.contextMenuItems)&&("html"===this.table.internalProps.menu.renderMode?this.menu.isShow=!0:(this.menu.isShow=!0,this.menu.x=i,this.menu.y=r,this.table.scenegraph.component.menu.attach(i,r,t,e,m.contextmenu)),this.table.fireListeners(E.B.SHOW_MENU,{x:i,y:r,col:t,row:e,type:"contextmenu"}))}triggerDropDownMenu(t,e,i,r,n){this.table.fireListeners(E.B.DROPDOWN_ICON_CLICK,{col:t,row:e,event:n}),this.menu.isShow?this.hideMenu():this.showDropDownMenu(t,e,i,r)}showDropDownMenu(t,e,i,r){let n;"html"===this.table.internalProps.menu.renderMode?this.menu.isShow=!0:(this.menu.isShow=!0,this.table.scenegraph.component.menu.attach(i,r,t,e,m.dropDown),this.menu.bounds=this.table.scenegraph.component.menu.bounds),this.table.fireListeners(E.B.SHOW_MENU,{x:i,y:r,col:t,row:e,type:"dropDown"}),this.residentHoverIcon&&this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row);let s=this.table.scenegraph.getCell(t,e);s.forEachChildren(t=>t.attribute.funcType===j.cI.dropDown&&(n=t,!0)),n&&(this.residentHoverIcon={col:t,row:e,icon:n},this.table.scenegraph.setIconHoverStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row,s),this.table.scenegraph.residentHoverIcon(t,e))}hideMenu(){this.menu.isShow&&(this.table.fireListeners(E.B.DROPDOWN_MENU_CLEAR,null),this.table.fireListeners(E.B.HIDE_MENU,null),this.menu.isShow=!1,this.table.scenegraph.component.menu.detach(),this.residentHoverIcon&&(this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row),this.table.scenegraph.resetResidentHoverIcon(this.residentHoverIcon.col,this.residentHoverIcon.row),this.residentHoverIcon=null))}setDropDownMenuHighlight(t){this.menu.dropDownMenuHighlight=t;for(let e=0;e<t.length;e++){let{col:i,row:r}=t[e],n=this.table.getCellRange(i,r);if(n)for(let t=n.start.col;t<=n.end.col;t++)for(let e=n.start.row;e<=n.end.row;e++)this.table.scenegraph.updateCellContent(t,e)}}dropDownMenuIsHighlight(t,e,i){let r=this.menu.dropDownMenuHighlight;if(Array.isArray(r))for(let n=0;n<r.length;n++){let s=r[n],{col:l,row:a}=s,{field:o,menuKey:h}=s;if("number"!=typeof l||"number"!=typeof a)if(this.table.isPivotTable()&&(Array.isArray(o),1)){let t=this.table.internalProps.layoutMap.getPivotCellAdress(o);if(!t)continue;l=t.col,a=t.row}else{let t=this.table.internalProps.layoutMap.getHeaderCellAddressByField(o);if(!t)continue;l=t.col,a=t.row}if((0,y.Z)(l)&&(0,y.Z)(a)&&this.table.isCellRangeEqual(t,e,l,a)){let r=this.table._getHeaderLayoutMap(null!=l?l:t,null!=a?a:e).dropDownMenu||this.table.globalDropDownMenu;if("function"==typeof r&&(r=r({row:a,col:l,table:this.table})),r)for(let t=0;t<r.length;t++){let e=r[t];if((0,iW.Z)(e)&&(e.menuKey||e.text)===(h||"")&&t===i||(0,ey.Z)(e)&&e===h&&t===i)return!0}}}return!1}triggerSort(t,e,i,r){if(this.table.isPivotTable()){let i=this.table.getPivotSortState(t,e),n=i?i.toUpperCase():"NORMAL";return this.table.sort(t,e,"ASC"===n?"DESC":"DESC"===n?"NORMAL":"ASC"),void this.table.fireListeners(iH.z.PIVOT_SORT_CLICK,{col:t,row:e,order:n||"normal",dimensionInfo:this.table.internalProps.layoutMap.getPivotDimensionInfo(t,e),cellLocation:this.table.getCellLocation(t,e),event:r})}let n=[...this.sort],s=this.table.internalProps.multipleSort||!n.length?null:this.sort[this.sort.length-1];!function(t,e,i,r){var n,s,l,a;let o,h=null,u=!1;if(Array.isArray(i.sortState))for(let r=0;r<i.sortState.length&&((o=i.sortState[r])&&(h=i._getHeaderCellBySortState(o)),h&&(u=iD(t,e,h.col,h.row,i)),!u);r++);else(o=i.sortState)&&(h=i._getHeaderCellBySortState(o)),h&&(u=iD(t,e,h.col,h.row,i));let d=i.getHeaderDefine(t,e);if(o&&u&&(null==d?void 0:d.sort)?o.order="asc"===o.order?"desc":"desc"===o.order?"normal":"asc":(null==d?void 0:d.sort)?o={field:i.getHeaderField(t,e),order:"asc"}:u&&(null==d?void 0:d.showSort)||(o={field:i.getHeaderField(t,e),order:"normal"}),o.event=r,i.fireListeners(E.B.SORT_CLICK,o).includes(!1))return;let c=!1,p=i.internalProps.sortState?Array.isArray(i.internalProps.sortState)&&(c=!0)?i.internalProps.sortState:[i.internalProps.sortState]:[];if(Array.isArray(p)){let t=p.findIndex(t=>t.field===o.field);t>=0?p[t]=o:p.push(o)}p=p.filter(t=>"normal"!==t.order),p=i.internalProps.multipleSort&&(c=!0)?p:p.splice(-1),p=c&&p.length?p:p[0],i.internalProps.sortState=p,i.stateManager.setSortState(p),(null==d?void 0:d.sort)&&(s=p,l=i,a=0,s=Array.isArray(s)||!s?s:[s],l.dataSource.sort((s||[]).map(t=>{var e,i;let r=l.internalProps.layoutMap.headerObjects.find(e=>e&&e.field===t.field);return{field:t.field,order:t.order||"asc",orderFn:"function"==typeof(null==(e=null==r?void 0:r.define)?void 0:e.sort)?null==(i=null==r?void 0:r.define)?void 0:i.sort:O.K$}}))),i.internalProps.useOneRowHeightFillAll=!1,i.internalProps.layoutMap.clearCellRangeMap(),i.scenegraph.sortCell();let g=!!(null==(n=i.stateManager.select.ranges)?void 0:n.length);i.stateManager.updateSelectPos(-1,-1),i.stateManager.endSelectCells(!0,g)}(t,e,this.table,r);let l=this.table.getCellRange(t,e),a=this.sort.find(t=>t.col===l.start.col&&t.row===l.start.row),o=this.table.internalProps.multipleSort||!s?null:s.col,h=this.table.internalProps.multipleSort||!s?null:s.row,u=n.findIndex(i=>i.col===t&&i.row===e);u>=0&&n.splice(u,1),this.table.scenegraph.updateSortIcon({col:t,row:e,iconMark:i,order:null==a?void 0:a.order,oldSortCol:o,oldSortRow:h,oldIconMark:null==s?void 0:s.icon}),a&&(a.icon=i),this.table.internalProps.multipleSort||n.forEach(t=>{this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:"normal",oldSortCol:t.col,oldSortRow:t.row,oldIconMark:null})}),this.table.fireListeners(iH.z.AFTER_SORT,{order:null==a?void 0:a.order,field:this.table.getHeaderField(t,e),event:r})}setSelectInline(t){this.select.selectInline=t}updateSortState(t){var e,i,r,n,s,l,a,o;t=Array.isArray(t)?t:[t];for(let o=0;o<t.length;o++){let h;if(t[o].field===(null==(e=this.sort[o])?void 0:e.field)&&t[t.length-1].order===(null==(i=this.sort[o])?void 0:i.order))return;let u=this.table.internalProps.multipleSort?null:(null==(r=this.sort[o])?void 0:r.col)||null,d=this.table.internalProps.multipleSort?null:(null==(n=this.sort[o])?void 0:n.row)||null;"asc"===(null==(s=this.sort[o])?void 0:s.order)||null==(l=this.sort[o])||l.order,this.setSortState(t.slice(0,o+1));let c=this.table.internalProps.layoutMap.getHeaderCellAddressByField(t[o].field);this.sort[o].col=c.col,this.sort[o].row=c.row;let p=this.table.scenegraph.getCell(this.sort[o].col,this.sort[o].row);(0,O.yW)(p,"children",t=>"sort"===t.attribute.funcType&&(h=t,!0)),this.table.scenegraph.updateSortIcon({col:this.sort[o].col,row:this.sort[o].row,iconMark:h,order:this.sort[o].order,oldSortCol:u,oldSortRow:d,oldIconMark:null==(a=this.sort[o])?void 0:a.icon})}let h=[];this.table.internalProps.layoutMap.columnTree.tree.children.forEach(e=>{t.some(t=>t.field===e.field)||h.push(e)});for(let t=0;t<h.length;t++){let e=h[t];this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:null,oldSortCol:null!=(o=e.startInTotal+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?o:0,oldSortRow:e.level,oldIconMark:null})}}triggerFreeze(t,e,i){if(!this.table.isPivotTable()&&!this.table.transpose){var r;if((r=this.table).frozenColCount>0?t!==r.frozenColCount-1?r.setFrozenColCount(t+1):r.setFrozenColCount(0):r.setFrozenColCount(t+1),this.table.hasListeners(iH.z.FREEZE_CLICK)){let i=this.table.internalProps.layoutMap.columnObjects.slice(0,t+1);this.table.fireListeners(iH.z.FREEZE_CLICK,{col:t,row:e,fields:i.reduce((t,e)=>t.concat(e.field),[]),colCount:this.table.frozenColCount})}this.frozen.icon=i}}updateCursor(t){var e;t||(t=null!=(e=this.table.options.defaultCursor)?e:"default"),this.table.getElement().style.cursor=t}updateDrillState(t,e,i,r,n,s){this.drill.dimensionKey=t,this.drill.title=e,this.drill.drillDown=i,this.drill.drillUp=r,this.drill.col=n,this.drill.row=s,function(t,e,i,r,n){let s=n.getCellLocation(t,e),l=0,a=0,o=!1;"columnHeader"===s?(l=n.getColsWidth(0,n.rowHeaderLevelCount-1)-(0===n.frozenColCount?n.scrollLeft:0),a=n.getRowsHeight(0,e-1)+n.getRowHeight(e)/2,o=!0):"rowHeader"===s&&(a=n.getRowsHeight(0,n.columnHeaderLevelCount-1),l=n.getColsWidth(0,t-1)+n.getColWidth(t)/2,o=!0),n.scenegraph.updateDrill(o,l,a,i,r)}(n,s,i,r,this.table)}updateSparklineHoverPose(t,e,i,r){-1!==this.sparkLine.col&&-1!==this.sparkLine.row&&function(t,e,i){let r=i.scenegraph.getCell(t,e).getChildByName("sparkline"),n=null==r?void 0:r.getChildByName("highlight-line"),s=null==r?void 0:r.getChildByName("highlight-symbol");n&&n.setAttributes({visible:!1,pickable:!1}),s&&s.setAttributes({visible:!1,pickable:!1}),i.scenegraph.updateNextFrame()}(this.sparkLine.col,this.sparkLine.row,this.table);let n=!1;-1!==t&&-1!==e&&(n=function(t,e,i,r,n){var s,l;let a,o=n.scenegraph.getCell(t,e).getChildByName("sparkline"),h=null==o?void 0:o.getChildByName("sparkline-line"),u=null==o?void 0:o.getChildByName("sparkline-symbol-group");if(!h)return!1;let d=h.bandwidth,c=h.min,p=h.max,g=h.attribute.points;i-=o.globalAABBBounds.x1,o.globalAABBBounds.y1;for(let t=0;t<g.length;t++){let{x:e,y:r,defined:n,rawData:f}=g[t];if(Math.abs(i-e)<d/2&&(a={point:g[t],points:g,pointsBandWidth:d,pointData:f},n)){let t=o.getChildByName("highlight-line");if(t)t.setAttributes({points:[{x:e,y:p},{x:e,y:c}],visible:!0,pickable:!0});else{let t=(0,tu.W)({points:[{x:e,y:p},{x:e,y:c}],lineWidth:null==(s=h.hover)?void 0:s.strokeWidth,stroke:null==(l=h.hover)?void 0:l.stroke});t.name="highlight-line",o.addChild(t)}let i=o.getChildByName("highlight-symbol");if(i)i.setAttributes({x:e,y:r,visible:!0,pickable:!0});else{let t=(0,tC.t)({x:e,y:r,stroke:u.hover.stroke,lineWidth:u.hover.strokeWidth,fill:u.hover.fill,size:2*u.hover.size,symbolType:"circle"});t.name="highlight-symbol",o.addChild(t)}break}}if(n.scenegraph.updateNextFrame(),a){let i={col:t,row:e,field:n.getHeaderField(t,e),value:n.getCellValue(t,e),dataValue:n.getCellOriginValue(t,e),cellHeaderPaths:n.internalProps.layoutMap.getCellHeaderPaths(t,e),title:n.getBodyColumnDefine(t,e).title,cellRange:n.getCellRelativeRect(t,e),sparkline:{pointData:a.pointData},scaleRatio:n.canvas.getBoundingClientRect().width/n.canvas.offsetWidth};n.fireListeners(E.B.MOUSEOVER_CHART_SYMBOL,i)}return!0}(t,e,i,0,this.table)),n?(this.sparkLine.col=t,this.sparkLine.row=e):(this.sparkLine.col=-1,this.sparkLine.row=-1)}setCheckedState(t,e,i,r){return(0,iU.Y)(t,e,i,r,this)}setHeaderCheckedState(t,e){return(0,iU.Vz)(t,e,this)}syncCheckedState(t,e,i,r){return(0,iU.GW)(t,e,i,r,this)}initCheckedState(t){return(0,iU.gs)(t,this)}updateHeaderCheckedState(t,e,i){return(0,iU.Pi)(t,this,e,i)}initLeftRecordsCheckState(t){return(0,iU.Bd)(t,this)}setRadioState(t,e,i,r,n){(0,iZ.Oq)(t,e,i,r,n,this)}syncRadioState(t,e,i,r,n,s){return(0,iZ.fM)(t,e,i,r,n,s,this)}changeCheckboxAndRadioOrder(t,e){this.checkedState.size&&(0,iU.hR)(t,e,this),this.radioState.length&&(0,iZ.tO)(t,e,this)}setCustomSelectRanges(t){var e;(function(t){let{customSelectedRangeComponents:e}=t.table.scenegraph;e.forEach((t,e)=>{t.rect.delete()}),e.clear(),t.select.customSelectRanges=[]})(this),e=this,t.forEach(t=>{!function(t,e,i){let r=t.table,n=e.start.col,s=e.start.row,l=e.end.col,a=e.end.row,o=(e.skipBodyMerge,Math.max(Math.min(l,n),0)),h=Math.max(Math.min(a,s),0),u=Math.min(Math.max(l,n),r.colCount-1),d=Math.min(Math.max(a,s),r.rowCount-1),{needRowHeader:c,needRightRowHeader:p,needColumnHeader:g,needBottomColumnHeader:f,needBody:m,needCornerHeader:y,needRightTopCornerHeader:v,needLeftBottomCornerHeader:b,needRightBottomCornerHeader:_}=(0,e2.L)(o,h,u,d,r);if(y&&i$(t,o,h,Math.min(u,r.frozenColCount-1),Math.min(d,r.frozenRowCount-1),"cornerHeader",`${o}${h}${u}${d}`,[!0,!g,!c,!0],i),v&&i$(t,Math.max(o,r.colCount-r.rightFrozenColCount),h,u,Math.min(d,r.frozenRowCount-1),"rightTopCorner",`${o}${h}${u}${d}`,[!0,!0,!p,!g],i),b){let e=Math.min(u,r.frozenColCount-1);i$(t,o,Math.max(h,r.rowCount-r.bottomFrozenRowCount),e,d,"leftBottomCorner",`${o}${h}${u}${d}`,[!c,!f,!0,!0],i)}if(_&&i$(t,Math.max(o,r.colCount-r.rightFrozenColCount),Math.max(h,r.rowCount-r.bottomFrozenRowCount),u,d,"rightBottomCorner",`${o}${h}${u}${d}`,[!p,!0,!0,!f],i),g&&i$(t,Math.max(o,r.frozenColCount),h,Math.min(u,r.colCount-r.rightFrozenColCount-1),Math.min(d,r.frozenRowCount-1),"columnHeader",`${o}${h}${u}${d}`,[!0,!v,!m,!y],i),f){let e=Math.max(o,r.frozenColCount),n=Math.min(u,r.colCount-r.rightFrozenColCount-1);i$(t,e,Math.max(h,r.rowCount-r.bottomFrozenRowCount),n,d,"bottomFrozen",`${o}${h}${u}${d}`,[!m,!_,!0,!b],i)}if(c){let e=Math.max(h,r.frozenRowCount),n=Math.min(d,r.rowCount-r.bottomFrozenRowCount-1);i$(t,o,e,Math.min(u,r.frozenColCount-1),n,"rowHeader",`${o}${h}${u}${d}`,[!y,!m,!b,!0],i)}if(p){let e=Math.max(h,r.frozenRowCount),n=Math.min(d,r.rowCount-r.bottomFrozenRowCount-1);i$(t,Math.max(o,r.colCount-r.rightFrozenColCount),e,u,n,"rightFrozen",`${o}${h}${u}${d}`,[!v,!0,!_,!m],i)}m&&i$(t,Math.max(o,r.frozenColCount),Math.max(h,r.frozenRowCount),Math.min(u,r.colCount-r.rightFrozenColCount-1),Math.min(d,r.rowCount-r.bottomFrozenRowCount-1),"body",`${o}${h}${u}${d}`,[!g,!p,!f,!c],i)}(e.table.scenegraph,t.range,t.style)}),e.select.customSelectRanges=t,e3(e.table.scenegraph),e.table.scenegraph.updateNextFrame()}}var iX=i(29559),iq=i(70506),iJ=i(13455);function iQ(t){if(t.eventManager.bindSparklineHoverEvent)return;let e=!1;(t.isPivotTable()?t.internalProps.layoutMap.indicatorsDefine.some(t=>"string"!=typeof t&&"sparkline"===t.cellType):t.internalProps.layoutMap.columnObjects.some(t=>"sparkline"===t.cellType||"function"==typeof t.cellType))&&(t.eventManager.bindSparklineHoverEvent=!0,t.on(E.B.MOUSEMOVE_CELL,e=>{let{col:i,row:r,x:n,y:s}=e;"sparkline"!==t.getBodyColumnType(i,r)&&t.stateManager.updateSparklineHoverPose(-1,-1,0,0),t.stateManager.updateSparklineHoverPose(i,r,n,s)}),t.on(E.B.MOUSELEAVE_TABLE,e=>{t.stateManager.updateSparklineHoverPose(-1,-1,0,0)}))}var i0=i(56447);function i1(t,e,i=!0){var r,n,s;let{deltaX:l,deltaY:a}=t;t.shiftKey&&t.deltaY&&(l=a,a=0);let[o,h]=function(t,e,i){var r,n;let s=Math.abs(t/e);return[Math.ceil((s<=.5?0:t)*(null!=(r=i.horizontal)?r:0)),Math.ceil((s>2?0:e)*(null!=(n=i.vertical)?n:0))]}(l,a,{horizontal:1,vertical:1});(o||h)&&e.interactionState!==B.F.scrolling&&e.updateInteractionState(B.F.scrolling);let u="scrolling"===(null==(n=null==(r=e.table.options.theme)?void 0:r.scrollStyle)?void 0:n.visible);o&&(e.setScrollLeft(e.scroll.horizontalBarPos+o,t),e.showHorizontalScrollBar(u)),h&&(e.setScrollTop(e.scroll.verticalBarPos+h,t),e.showVerticalScrollBar(u)),i&&e.resetInteractionState(e.interactionStateBeforeScroll),(null==(s=t.nativeEvent)?void 0:s.cancelable)&&("none"===e.table.internalProps.overscrollBehavior||Math.abs(a)>=Math.abs(l)&&0!==a&&i2(a,e)||Math.abs(a)<=Math.abs(l)&&0!==l&&i3(l,e))&&t.nativeEvent.preventDefault()}function i2(t,e){var i,r;return 0!=e.table.getAllRowsHeight()-e.table.scenegraph.height&&(i=t,0==(r=e).table.getAllRowsHeight()-r.table.scenegraph.height||!(i<=0)||!(r.scroll.verticalBarPos<1))&&!function(t,e){var i;let r=+(null!=(i=e.table.options.customConfig)&&!!i._disableColumnAndRowSizeRound),n=e.table.getAllRowsHeight()-e.table.scenegraph.height;return 0!==n&&t>=0&&Math.abs(e.scroll.verticalBarPos-n)<1+r}(t,e)}function i3(t,e){var i,r;return 0!=e.table.getAllColsWidth()-e.table.scenegraph.width&&(i=t,0==(r=e).table.getAllColsWidth()-r.table.scenegraph.width||!(i<=0)||!(r.scroll.horizontalBarPos<1))&&!function(t,e){var i;let r=+(null!=(i=e.table.options.customConfig)&&!!i._disableColumnAndRowSizeRound),n=e.table.getAllColsWidth()-e.table.scenegraph.width;return 0!==n&&t>=0&&Math.abs(e.scroll.horizontalBarPos-n)<1+r}(t,e)}class i5{constructor(t){this.stateManager=t}setScrollHandle(t){this.scrollHandle=t}startInertia(t,e,i){this.lastTime=Date.now(),this.speedX=t,this.speedY=e,this.friction=i,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var t;let e=Date.now(),i=e-this.lastTime,r=!0,n=Math.pow(this.friction,i/16),s=n*this.speedX,l=n*this.speedY,a=0,o=0;Math.abs(s)>.05&&(r=!1,a=(this.speedX+s)/2*i),Math.abs(l)>.05&&(r=!1,o=(this.speedY+l)/2*i),null==(t=this.scrollHandle)||t.call(this,a,o),r?this.runingId=null:(this.lastTime=e,this.speedX=s,this.speedY=l,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null}isInertiaScrolling(){return!!this.runingId}}function i4(t,e,i){var r,n,s,l,a,o,h,u;if(e&&-1!==(null==(r=t.stateManager.columnMove)?void 0:r.colSource)&&-1!==(null==(n=t.stateManager.columnMove)?void 0:n.rowSource)&&-1!==(null==(s=t.stateManager.columnMove)?void 0:s.colTarget)&&-1!==(null==(l=t.stateManager.columnMove)?void 0:l.rowTarget)){if(t.hasListeners(E.B.CHANGE_HEADER_POSITION)){let{colSource:e,rowSource:r,colTarget:n,rowTarget:s}=t.stateManager.columnMove,l=null!=(a=t.stateManager.columnMove.rowSourceSize)?a:0,h=null!=(o=t.stateManager.columnMove.rowTargetSize)?o:0;t.fireListeners(E.B.CHANGE_HEADER_POSITION,{target:{col:n,row:s+h-l},source:{col:e,row:r},event:i})}}else if(!e&&t.hasListeners(E.B.CHANGE_HEADER_POSITION_FAIL)){let e=null!=(h=t.stateManager.columnMove.rowSourceSize)?h:0,r=null!=(u=t.stateManager.columnMove.rowTargetSize)?u:0;t.fireListeners(E.B.CHANGE_HEADER_POSITION_FAIL,{target:{col:t.stateManager.columnMove.colTarget,row:t.stateManager.columnMove.rowTarget+r-e},source:{col:t.stateManager.columnMove.colSource,row:t.stateManager.columnMove.rowSource},event:i})}}function i6(t){t.stateManager.endResizeCol();let e=[];for(let i=0;i<t.colCount;i++)e.push(t.getColWidth(i));t.fireListeners(E.B.RESIZE_COLUMN_END,{col:t.stateManager.columnResize.col,colWidths:e})}function i8(t){t.stateManager.endResizeRow(),t.fireListeners(E.B.RESIZE_ROW_END,{row:t.stateManager.rowResize.row,rowHeight:t.getRowHeight(t.stateManager.rowResize.row)})}let i9=1;function i7(){return P.UG?i9=1:(i9=Math.ceil(window.devicePixelRatio||1))>1&&i9%2!=0&&(i9+=1),i9}i7();var rt=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function l(t){try{o(r.next(t))}catch(t){s(t)}}function a(t){try{o(r.throw(t))}catch(t){s(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(l,a)}o((r=r.apply(t,e||[])).next())})};function re(t){return!!t.changedTouches}function ri(t,e,i){if(i.indicatorsAsCol){if(i.hasTwoIndicatorAxes&&e===i.columnHeaderLevelCount-1&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount)return"top";if(e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount)return"bottom";if(t===i.rowHeaderLevelCount-1&&e>=i.rowHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return"left"}else{if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return"left";if(t===i.colCount-i.rightFrozenColCount&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return"right";e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&(i.colCount,i.rightFrozenColCount)}return"bottom"}function rr(t,e,i,r,n,s,l){var a;let o=l||"_vtable_rowSeries_number",h=e+1;for(;(0,tk.Z)(r[h])&&(null==(a=r[h])?void 0:a.length)>i.length;){let e=n.columnHeaderLevelCount+h;n.stateManager.setCheckedState(s,e,o,t),(0,iU.r5)(s,e,t,n),h++}}function rn(t,e,i,r,n,s){var l;let a=e.length-1;if(a>0){let e=t-1;for(;a>0&&e>=0;)((0,tk.Z)(i[e])&&(null==(l=i[e])?void 0:l.length)===a||1===a&&(0,X.Z)(i[e]))&&(function(t,e,i,r,n){let{checkedState:s}=r.stateManager,l=i.toString(),a=n||"_vtable_rowSeries_number";(0,tk.Z)(i)&&i.length;let o=!1,h=[],u=Array.from(s.keys()).sort((t,e)=>{var i,r;let n=t.split(","),s=e.split(","),l=Math.max(n.length,s.length);for(let t=0;t<l;t++){let e=null!=(i=Number(n[t]))?i:0,l=null!=(r=Number(s[t]))?r:0;if(e!==l)return e-l}return 0}),d=u.map(t=>s.get(t)),c=u.filter(t=>t.startsWith(l+",")&&t!==l);if(d.forEach((t,e)=>{let i=u[e],r=c.includes(i);o&&(r?h.push(t[a]):o=!1),i===l&&(o=!0)}),0===h.length)return;let p=h.every(t=>!!t),g=h.every(t=>!t);p?(r.stateManager.setCheckedState(t,e,a,!0),(0,iU.r5)(t,e,!0,r)):g?(r.stateManager.setCheckedState(t,e,a,!1),(0,iU.r5)(t,e,!1,r)):(r.stateManager.setCheckedState(t,e,a,"indeterminate"),(0,iU.r5)(t,e,"indeterminate",r))}(n,r.columnHeaderLevelCount+e,i[e],r,s),a--),e--}}function rs(t,e,i,r){let{checkedState:n}=i.stateManager,s=e.toString();(0,tk.Z)(e)&&e.length;let l=!1,a=Array.from(n.keys()).sort((t,e)=>{var i,r;let n=t.split(","),s=e.split(","),l=Math.max(n.length,s.length);for(let t=0;t<l;t++){let e=null!=(i=Number(n[t]))?i:0,l=null!=(r=Number(s[t]))?r:0;if(e!==l)return e-l}return 0}),o=a.filter(t=>t.startsWith(s+",")&&t!==s);a.map(t=>n.get(t)).forEach((e,i)=>{let n=a[i],h=0!==o.length&&o.includes(n);l&&(h?e[r]=t:l=!1),n===s&&(l=!0)})}function rl(t,e,i){let r=t.getRecordShowIndexByCell(e,i);return t.dataSource.getHierarchyState(r)}var ra=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function l(t){try{o(r.next(t))}catch(t){s(t)}}function a(t){try{o(r.throw(t))}catch(t){s(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(l,a)}o((r=r.apply(t,e||[])).next())})};class ro{constructor(t){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._enableTableScroll=!0,this.cutWaitPaste=!1,this.clipboardCheckTimer=null,this.cutOperationTime=0,this.lastClipboardContent="",this.cutCellRange=null,this.table=t,this.handleTextStickBindId=[],this.inertiaScroll=new i5(t.stateManager),"node"===k.X.mode||t.options.disableInteraction||(this.bindOuterEvent(),setTimeout(()=>{this.bindSelfEvent()},0))}bindOuterEvent(){(function(t){let e=t.table,i=e.stateManager;e.scenegraph.tableGroup.addEventListener("pointermove",r=>{var n,s,l,a,o,h,u,d,c,p,g,f,m,v,b,_,x,C;let w=null!=(s=null==(n=e.eventManager.LastPointerXY)?void 0:n.x)?s:r.x,S=null!=(a=null==(l=e.eventManager.LastPointerXY)?void 0:l.y)?a:r.y;e.eventManager.LastPointerXY={x:r.x,y:r.y},t.touchSetTimeout&&(clearTimeout(t.touchSetTimeout),t.touchSetTimeout=void 0);let A=(0,io.RJ)(r);if(A.eventArgs&&e.hasListeners(E.B.MOUSEMOVE_TABLE)&&e.fireListeners(E.B.MOUSEMOVE_TABLE,{col:A.eventArgs.col,row:A.eventArgs.row,x:A.abstractPos.x,y:A.abstractPos.y,event:r.nativeEvent,target:null==(o=null==A?void 0:A.eventArgs)?void 0:o.target,mergeCellInfo:null==(h=A.eventArgs)?void 0:h.mergeInfo}),i.interactionState===B.F.grabing)return void(Math.abs(w-r.x)+Math.abs(S-r.y)>=1&&(i.isResizeCol()||i.isResizeRow()||(i.isMoveCol()?t.dealColumnMover(A):i.isFillHandle()?t.dealFillSelect(A,!0):(null==(u=e.options.select)?void 0:u.disableDragSelect)||t.dealTableSelect(A,!0))));!(null==(d=e.options.select)?void 0:d.disableDragSelect)&&e.eventManager.isDraging&&i.isSelecting()&&!(null==(c=e.editorManager)?void 0:c.editingEditor)&&t.dealTableSelect(A,!0);let M=r.path.find(t=>"cell"===t.role);if(e.hasListeners(E.B.MOUSELEAVE_CELL)&&(-1===e.stateManager.hover.cellPos.col||-1===e.stateManager.hover.cellPos.row||(null==M?void 0:M.col)===e.stateManager.hover.cellPos.col&&(null==M?void 0:M.row)===e.stateManager.hover.cellPos.row||e.fireListeners(E.B.MOUSELEAVE_CELL,{col:e.stateManager.hover.cellPos.col,row:e.stateManager.hover.cellPos.row,cellRange:e.getCellRangeRelativeRect({col:e.stateManager.hover.cellPos.col,row:e.stateManager.hover.cellPos.row}),scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,event:r.nativeEvent,target:null==(p=null==A?void 0:A.eventArgs)?void 0:p.target})),e.hasListeners(E.B.MOUSEENTER_CELL)&&"cell"===(null==M?void 0:M.role)&&(0,y.Z)(M.col)&&(0,y.Z)(M.row)&&(M.col!==e.stateManager.hover.cellPos.col||M.row!==e.stateManager.hover.cellPos.row)&&(M.col!==(null==(g=e.stateManager.hover.cellPosContainHeader)?void 0:g.col)||M.row!==(null==(f=e.stateManager.hover.cellPosContainHeader)?void 0:f.row))&&e.fireListeners(E.B.MOUSEENTER_CELL,{col:M.col,row:M.row,cellRange:e.getCellRangeRelativeRect({col:M.col,row:M.row}),scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,event:r.nativeEvent,target:null==(m=null==A?void 0:A.eventArgs)?void 0:m.target,mergeCellInfo:null==(v=A.eventArgs)?void 0:v.mergeInfo}),t.dealIconHover(A),t.dealTableHover(A),e.theme.columnResize.visibleOnHover&&t.checkColumnResize(A,!0),A.eventArgs&&e.hasListeners(E.B.MOUSEMOVE_CELL)){let t,i;if(null==(b=A.eventArgs)?void 0:b.target){let e=ij(null==(_=A.eventArgs)?void 0:_.target);e&&(t=e.icon,i=e.position)}e.fireListeners(E.B.MOUSEMOVE_CELL,{col:A.eventArgs.col,row:A.eventArgs.row,x:A.abstractPos.x,y:A.abstractPos.y,event:r.nativeEvent,targetIcon:t?{name:t.name,position:i,funcType:t.attribute.funcType}:void 0,target:null==(x=null==A?void 0:A.eventArgs)?void 0:x.target,mergeCellInfo:null==(C=A.eventArgs)?void 0:C.mergeInfo})}}),e.scenegraph.tableGroup.addEventListener("pointerout",e=>{var i;let r=(0,io.RJ)(e),n=null==(i=null==r?void 0:r.eventArgs)?void 0:i.target;"table"===(null==n?void 0:n.role)&&t.dealTableHover()}),e.scenegraph.tableGroup.addEventListener("pointerover",t=>{var i,r;let n=(0,io.RJ)(t),s=null==(i=null==n?void 0:n.eventArgs)?void 0:i.target;if(s&&e.hasListeners(E.B.MOUSEOVER_CHART_SYMBOL)&&"symbol"===s.type){let i=t.composedPath().find(t=>"cell"===t.roll);if(i){let{col:s,row:l}=i,a={col:s,row:l,field:e.getHeaderField(s,l),value:e.getCellValue(s,l),dataValue:e.getCellOriginValue(s,l),cellHeaderPaths:e.internalProps.layoutMap.getCellHeaderPaths(s,l),title:e.getBodyColumnDefine(s,l).title,cellRange:e.getCellRelativeRect(s,l),event:t.nativeEvent,sparkline:{pointData:void 0},scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,target:null==(r=null==n?void 0:n.eventArgs)?void 0:r.target};e.fireListeners(E.B.MOUSEOVER_CHART_SYMBOL,a)}}}),e.scenegraph.tableGroup.addEventListener("pointerenter",t=>{(e.theme.scrollStyle.horizontalVisible&&"focus"===e.theme.scrollStyle.horizontalVisible||!e.theme.scrollStyle.horizontalVisible&&"focus"===e.theme.scrollStyle.visible)&&i.showHorizontalScrollBar(),(e.theme.scrollStyle.verticalVisible&&"focus"===e.theme.scrollStyle.verticalVisible||!e.theme.scrollStyle.verticalVisible&&"focus"===e.theme.scrollStyle.visible)&&i.showVerticalScrollBar(),e.hasListeners(E.B.MOUSEENTER_TABLE)&&e.fireListeners(E.B.MOUSEENTER_TABLE,{event:t.nativeEvent})}),e.scenegraph.tableGroup.addEventListener("pointerleave",r=>{i.isResizeCol()||i.isResizeRow()||i.isMoveCol()||i.isSelecting()||(i.updateInteractionState(B.F.default),i.updateCursor()),(e.theme.scrollStyle.horizontalVisible&&"focus"===e.theme.scrollStyle.horizontalVisible||!e.theme.scrollStyle.horizontalVisible&&"focus"===e.theme.scrollStyle.visible)&&i.hideHorizontalScrollBar(),(e.theme.scrollStyle.verticalVisible&&"focus"===e.theme.scrollStyle.verticalVisible||!e.theme.scrollStyle.verticalVisible&&"focus"===e.theme.scrollStyle.visible)&&i.hideVerticalScrollBar(),e.hasListeners(E.B.MOUSELEAVE_CELL)&&-1!==e.stateManager.hover.cellPos.col&&-1!==e.stateManager.hover.cellPos.row&&e.fireListeners(E.B.MOUSELEAVE_CELL,{col:e.stateManager.hover.cellPos.col,row:e.stateManager.hover.cellPos.row,cellRange:e.getCellRangeRelativeRect({col:e.stateManager.hover.cellPos.col,row:e.stateManager.hover.cellPos.row}),scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,event:r.nativeEvent,target:void 0}),t.dealTableHover();let n=r.target;n&&!n.isDescendantsOf(e.scenegraph.tableGroup)&&e.fireListeners(E.B.MOUSELEAVE_TABLE,{event:r.nativeEvent})}),e.scenegraph.tableGroup.addEventListener("pointerdown",r=>{var n,s,l,a,o;if(e.hasListeners(E.B.MOUSEDOWN_TABLE)&&e.fireListeners(E.B.MOUSEDOWN_TABLE,{event:r.nativeEvent}),(0,k.u)(),e.eventManager.isDown=!0,e.eventManager.LastBodyPointerXY={x:r.x,y:r.y},e.eventManager.LastPointerXY={x:r.x,y:r.y},0!==r.button)return;let h=(0,io.RJ)(r);if(t.downIcon=void 0,i.interactionState!==B.F.default||(e.isPivotChart()&&"chart"!==(null==(n=null==h?void 0:h.eventArgs)?void 0:n.target.type)&&e.scenegraph.updateChartState(null),(null==(s=h.eventArgs)?void 0:s.target)!==(null==(l=i.residentHoverIcon)?void 0:l.icon)&&i.hideMenu(),"chart"===(null==(a=null==h?void 0:h.eventArgs)?void 0:a.target.type)))return;let u=null==(o=e.editorManager)?void 0:o.completeEdit(r.nativeEvent);(0,P.NC)(u,n=>{var s,l,a,o,u,d,c,p,g,f,m,v;if(!(null==(s=e.options.customConfig)?void 0:s.selectCellWhenCellEditorNotExists)&&!1===n)return;let b=(null==(o=null==(a=null==(l=null==h?void 0:h.eventArgs)?void 0:l.target)?void 0:a.role)?void 0:o.startsWith("icon"))?h.eventArgs.target:(null==(u=r.target.role)?void 0:u.startsWith("icon"))?r.target:void 0;if(t.downIcon=b,b&&!1!==b.attribute.interactive)b.attribute.funcType===j.cI.dragReorder&&(i.startMoveCol(h.eventArgs.col,h.eventArgs.row,h.abstractPos.x,h.abstractPos.y,null==(m=null==(f=h.eventArgs)?void 0:f.event)?void 0:m.nativeEvent),i.updateInteractionState(B.F.grabing));else{if(t.cellIsHeaderCheck(h))return;if("touch"===r.pointerType){if(t.touchEnd=!1,t.touchSetTimeout=setTimeout(()=>{t.isTouchdown=!1,t.isLongTouch=!0,!t.touchEnd&&(t.checkColumnResize(h,!0)||t.checkRowResize(h,!0))||!t.touchEnd&&t.checkColumnMover(h)?i.updateInteractionState(B.F.grabing):t.dealTableSelect(h)&&!t.touchEnd&&i.updateInteractionState(B.F.grabing)},500),e.hasListeners(E.B.MOUSEENTER_CELL)){let t=r.path.find(t=>"cell"===t.role);"cell"===(null==t?void 0:t.role)&&(0,y.Z)(t.col)&&(0,y.Z)(t.row)&&(t.col!==e.stateManager.hover.cellPos.col||t.row!==e.stateManager.hover.cellPos.row)&&(t.col!==(null==(d=e.stateManager.hover.cellPosContainHeader)?void 0:d.col)||t.row!==(null==(c=e.stateManager.hover.cellPosContainHeader)?void 0:c.row))&&e.fireListeners(E.B.MOUSEENTER_CELL,{col:t.col,row:t.row,cellRange:e.getCellRangeRelativeRect({col:t.col,row:t.row}),scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,event:r.nativeEvent,target:null==(p=null==h?void 0:h.eventArgs)?void 0:p.target,mergeCellInfo:null==(g=h.eventArgs)?void 0:g.mergeInfo})}t.dealTableHover(h)}else{if(!t.checkCellFillhandle(h)&&(t.checkColumnResize(h,!0)||t.checkRowResize(h,!0)))return e.scenegraph.updateChartState(null),void i.updateInteractionState(B.F.grabing);if(t.checkColumnMover(h)||t.checkCellFillhandle(h,!0)&&t.dealFillSelect(h))return void i.updateInteractionState(B.F.grabing);t.dealTableSelect(h)&&i.updateInteractionState(B.F.grabing)}}if(e.hasListeners(E.B.MOUSEDOWN_CELL)){let t=(0,io.RJ)(r);t.eventArgs&&e.fireListeners(E.B.MOUSEDOWN_CELL,{col:t.eventArgs.col,row:t.eventArgs.row,event:r.nativeEvent,target:null==(v=null==t?void 0:t.eventArgs)?void 0:v.target,mergeCellInfo:t.eventArgs.mergeInfo})}})}),e.scenegraph.tableGroup.addEventListener("pointerup",r=>{var n,s,l,a,o,h,u,d;if(0===r.button){if("grabing"===i.interactionState){if(i.updateInteractionState(B.F.default),i.isResizeCol())i6(e);else if(i.isResizeRow())i8(e);else if(i.isMoveCol()){let t=e.stateManager.endMoveCol();i4(e,t,r.nativeEvent)}else if(i.isSelecting()){e.stateManager.endSelectCells(),e.stateManager.isFillHandle()&&e.stateManager.endFillSelect();let t=(0,io.RJ)(r);if(e.eventManager.isDraging&&t.eventArgs&&e.hasListeners(E.B.DRAG_SELECT_END)){let i={event:r.nativeEvent,cells:[],col:t.eventArgs.target.col,row:t.eventArgs.target.row,scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,target:null==(n=null==t?void 0:t.eventArgs)?void 0:n.target,mergeCellInfo:null==(s=t.eventArgs)?void 0:s.mergeInfo};i.cells=e.getSelectedCellInfos(),e.fireListeners(E.B.DRAG_SELECT_END,i)}}}else i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default);if(!e.eventManager.isDraging){let i=(0,io.RJ)(r);if(!t.isTouchMove&&0===r.button&&i.eventArgs&&e.hasListeners(E.B.CLICK_CELL)){let t,n,{col:s,row:u}=i.eventArgs,d=e.getCellInfo(s,u);if(null==(l=i.eventArgs)?void 0:l.target){let e=ij(null==(a=i.eventArgs)?void 0:a.target);e&&(t=e.icon,n=e.position)}let c=Object.assign(Object.assign({},d),{event:r.nativeEvent,federatedEvent:r,cells:[],targetIcon:t?{name:t.name,position:n,funcType:t.attribute.funcType}:void 0,target:null==(o=null==i?void 0:i.eventArgs)?void 0:o.target,mergeCellInfo:null==(h=i.eventArgs)?void 0:h.mergeInfo});e.fireListeners(E.B.CLICK_CELL,c)}}if(e.hasListeners(E.B.MOUSEUP_CELL)){let t=(0,io.RJ)(r);t.eventArgs&&e.fireListeners(E.B.MOUSEUP_CELL,{col:t.eventArgs.col,row:t.eventArgs.row,event:r.nativeEvent,target:null==(u=null==t?void 0:t.eventArgs)?void 0:u.target,mergeCellInfo:null==(d=t.eventArgs)?void 0:d.mergeInfo})}setTimeout(()=>{t.isDown=!1,t.isTouchdown=!1,t.isTouchMove=!1,t.isDraging=!1,t.touchMovePoints=[]},0)}}),e.scenegraph.tableGroup.addEventListener("rightdown",t=>{var r,n,s,l,a,o,h;let u=(0,io.RJ)(t);if(u.eventArgs){i.triggerContextMenu(u.eventArgs.col,u.eventArgs.row,u.abstractPos.x,u.abstractPos.y);let{col:d,row:c}=u.eventArgs;if(d>=0&&c>=0){let i=e.getSelectedCellRanges(),p=!1;if(i.length>0)for(let t=0;t<i.length;t++){let e=i[t],r=e.start.col,n=e.end.col,s=e.start.row,l=e.end.row;if(d>=r&&d<=n&&c>=s&&c<=l||d>=n&&d<=r&&c>=l&&c<=s||d>=r&&d<=n&&c>=l&&c<=s||d>=n&&d<=r&&c>=s&&c<=l){p=!0;break}}let g=null==(r=e.options.select)?void 0:r.disableSelectOnContextMenu;if(p||g||e.selectCell(d,c),e.hasListeners(E.B.CONTEXTMENU_CELL)){let i,r,p=e.getCellInfo(d,c);if(null==(n=u.eventArgs)?void 0:n.target){let t=ij(null==(s=u.eventArgs)?void 0:s.target);t&&(i=t.icon,r=t.position)}let g=Object.assign(Object.assign({},p),{event:t.nativeEvent,cells:[],targetIcon:i?{name:i.name,position:r,funcType:i.attribute.funcType}:void 0,target:null==(l=null==u?void 0:u.eventArgs)?void 0:l.target,mergeCellInfo:null==(a=u.eventArgs)?void 0:a.mergeInfo});(null==(h=null==(o=e.options.eventOptions)?void 0:o.contextmenuReturnAllSelectedCells)||h)&&((0,P.yD)(e.stateManager.select.ranges,d,c)?g.cells=e.getSelectedCellInfos():g.cells=[[p]]),e.fireListeners(E.B.CONTEXTMENU_CELL,g)}}}}),e.scenegraph.tableGroup.addEventListener("pointertap",r=>{var n;if(e.stateManager.columnResize.resizing)return;let s=(0,io.RJ)(r);if(!e.stateManager.columnResize.resizing&&!e.stateManager.columnMove.moving&&(t.dealIconClick(r,s),(null==s?void 0:s.eventArgs)&&t.touchSetTimeout&&"touch"===r.pointerType)){let e=(0,io.RJ)(r);if(t.touchSetTimeout){clearTimeout(t.touchSetTimeout);let r=!!(null==(n=i.select.ranges)?void 0:n.length);t.dealTableSelect(e),i.endSelectCells(!0,r),t.touchSetTimeout=void 0}}}),e.scenegraph.stage.addEventListener("pointerdown",r=>{var n,s,l,a;let o=(0,io.RJ)(r);(null==(n=o.eventArgs)?void 0:n.target)&&(null==(s=o.eventArgs)?void 0:s.target)===(null==(l=i.residentHoverIcon)?void 0:l.icon)||i.hideMenu();let h=!1,u=r.target;u===e.scenegraph.tableGroup||u.isDescendantsOf(e.scenegraph.tableGroup)||(h=null==(a=e.editorManager)?void 0:a.completeEdit(r.nativeEvent)),(0,P.NC)(h,n=>{var s,l;if(!(null==(s=e.options.customConfig)?void 0:s.selectCellWhenCellEditorNotExists)&&!1===n)return;let a=(null==(l=r.target.role)?void 0:l.startsWith("icon"))?r.target:void 0;if(t.downIcon=a,"touch"===r.pointerType||a||t.checkCellFillhandle(o)||i.columnResize.resizing||!t.checkColumnResize(o,!0));else{e.scenegraph.updateChartState(null),i.updateInteractionState(B.F.grabing);let{eventArgs:t}=o;!(null==t?void 0:t.targetCell)&&e.getCellAt(o.abstractPos.x-e.theme.columnResize.resizeHotSpotSize/2,o.abstractPos.y)&&e.hasListeners(E.B.MOUSEDOWN_TABLE)&&e.fireListeners(E.B.MOUSEDOWN_TABLE,{event:r.nativeEvent})}})}),e.scenegraph.stage.addEventListener("pointerup",t=>{"grabing"===i.interactionState&&(i.updateInteractionState(B.F.default),i.isResizeCol()?i6(e):i.isResizeRow()&&i8(e))}),e.scenegraph.stage.addEventListener("pointertap",r=>{var n,s,l,a,o;let h=r.target;if(e.eventManager.isDraging||!h||!h.isDescendantsOf(e.scenegraph.stage)&&h.stage!==h||h.isDescendantsOf(e.scenegraph.tableGroup))e.eventManager.isDraging&&i.isSelecting()&&i.endSelectCells();else{i.updateInteractionState(B.F.default),t.dealTableHover();let h=!!(null==(n=i.select.ranges)?void 0:n.length);(null==(s=e.options.customConfig)?void 0:s.cancelSelectCellHook)?(null==(l=e.options.customConfig)?void 0:l.cancelSelectCellHook(r))&&t.dealTableSelect():(null==(o=null==(a=e.options.select)?void 0:a.blankAreaClickDeselect)||o)&&t.dealTableSelect(),i.endSelectCells(!0,h),i.updateCursor(),e.scenegraph.updateChartState(null)}}),e.scenegraph.stage.addEventListener("pointermove",r=>{var n,s,l;let a=(0,io.RJ)(r);null!=(l=null==(s=null==(n=r.target)?void 0:n.isDescendantsOf)?void 0:s.call(n,e.scenegraph.tableGroup))&&l&&(i.isResizeCol()||t.checkColumnResize(a)?e.stateManager.select&&t.checkCellFillhandle(a)?i.updateCursor("crosshair"):i.updateCursor("col-resize"):i.isResizeRow()||t.checkRowResize(a)?e.stateManager.select&&t.checkCellFillhandle(a)?i.updateCursor("crosshair"):i.updateCursor("row-resize"):i.isMoveCol()||i.updateCursor())}),e.scenegraph.tableGroup.addEventListener("checkbox_state_change",t=>{var i,r;let n=(0,io.RJ)(t),{col:s,row:l}=n.eventArgs,a=e.getCellInfo(s,l),o=(0,G.Z)(e,s,l);if(o)for(let i=o.start.col;i<=o.end.col;i++)for(let r=o.start.row;r<=o.end.row;r++)e.scenegraph.getCell(i,r).forEachChildren(e=>{"checkbox"===e.name&&e.setAttributes({checked:t.target.attribute.checked,indeterminate:t.target.attribute.indeterminate})});let h=Object.assign(Object.assign({},a),{event:t.nativeEvent,target:null==(i=null==n?void 0:n.eventArgs)?void 0:i.target,mergeCellInfo:null==(r=null==n?void 0:n.eventArgs)?void 0:r.mergeInfo,checked:t.detail.checked});if(e.isHeader(s,l))e.stateManager.setHeaderCheckedState(a.field,t.detail.checked),e.internalProps.enableHeaderCheckboxCascade&&"checkbox"===e.getCellType(s,l)&&e.scenegraph.updateCheckboxCellState(s,l,t.detail.checked);else if(e.stateManager.setCheckedState(s,l,a.field,t.detail.checked),e.internalProps.enableCheckboxCascade&&"checkbox"===e.getCellType(s,l)){let t=e.stateManager.headerCheckedState[a.field],i=e.stateManager.updateHeaderCheckedState(a.field,s,l);t!==i&&e.scenegraph.updateHeaderCheckboxCellState(s,l,i)}e.fireListeners(E.B.CHECKBOX_STATE_CHANGE,h),e.scenegraph.updateNextFrame()}),e.scenegraph.tableGroup.addEventListener("radio_checked",t=>{var i,r,n;let s=(0,io.RJ)(t),{col:l,row:a,target:o}=s.eventArgs,h=e.getCellInfo(l,a),u=null==(i=io.xD.exec(o.id))?void 0:i[1],d=(0,G.Z)(e,l,a);if(d)for(let t=d.start.col;t<=d.end.col;t++)for(let i=d.start.row;i<=d.end.row;i++)e.scenegraph.getCell(t,i).forEachChildren(t=>{"radio"===t.name&&t.id===o.id&&t.setAttributes({checked:!0})});let c=e.getBodyColumnDefine(l,a).radioCheckType||"column";if("cell"===c)if(d)for(let t=d.start.col;t<=d.end.col;t++)for(let i=d.start.row;i<=d.end.row;i++)e.scenegraph.getCell(t,i).forEachChildren(t=>{"radio"===t.name&&t.id!==o.id&&t.setAttributes({checked:!1})});else e.scenegraph.getCell(l,a).forEachChildren(t=>{"radio"===t.name&&t.id!==o.id&&t.setAttributes({checked:!1})});else"column"===c&&e.scenegraph.getColGroup(l).forEachChildren(t=>{t.forEachChildren(t=>{"radio"===t.name&&t.id!==o.id&&t.setAttributes({checked:!1})})});let p=u?Number(u):void 0;e.stateManager.setRadioState(l,a,h.field,c,p);let g=Object.assign(Object.assign({},h),{event:t.nativeEvent,target:null==(r=null==s?void 0:s.eventArgs)?void 0:r.target,mergeCellInfo:null==(n=null==s?void 0:s.eventArgs)?void 0:n.mergeInfo,radioIndexInCell:p});e.fireListeners(E.B.RADIO_STATE_CHANGE,g),e.scenegraph.updateNextFrame()}),e.scenegraph.tableGroup.addEventListener("switch_state_change",t=>{var i,r;let n=(0,io.RJ)(t),{col:s,row:l,target:a}=n.eventArgs,o=e.getCellInfo(s,l),h=(0,G.Z)(e,s,l);if(h)for(let i=h.start.col;i<=h.end.col;i++)for(let r=h.start.row;r<=h.end.row;r++)e.scenegraph.getCell(i,r).forEachChildren(e=>{"switch"===e.name&&e.setAttributes({checked:t.target.attribute.checked})});let u=Object.assign(Object.assign({},o),{event:t.nativeEvent,target:null==(i=null==n?void 0:n.eventArgs)?void 0:i.target,mergeCellInfo:null==(r=null==n?void 0:n.eventArgs)?void 0:r.mergeInfo,checked:t.detail.checked});e.stateManager.setCheckedState(s,l,o.field,t.detail.checked),e.fireListeners(E.B.SWITCH_STATE_CHANGE,u),e.scenegraph.updateNextFrame()}),e.scenegraph.stage.addEventListener("wheel",t=>{var r;t.path.find(t=>"legend"===t.name)||(null==(r=e.editorManager)||r.completeEdit(),e.eventManager._enableTableScroll&&i1(t,i))})})(this),function(t){let e=t.table,i=e.stateManager,r=e.internalProps.handler;function n(t){var i;if(e.hasListeners(E.B.KEYDOWN)){let r={keyCode:null!=(i=t.keyCode)?i:t.which,code:t.code,event:t,scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth};e.fireListeners(E.B.KEYDOWN,r)}}r.on(e.getElement(),"blur",e=>{t.dealTableHover()}),r.on(e.getElement(),"keydown",r=>{var s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,I,L,F,O,D,H,z;let W={keyCode:null!=(s=r.keyCode)?s:r.which,code:r.code,event:r};if(e.fireListeners(E.B.BEFORE_KEYDOWN,W),"a"===r.key&&(r.ctrlKey||r.metaKey))(null==(l=e.keyboardOptions)?void 0:l.selectAllOnCtrlA)&&(r.preventDefault(),t.deelTableSelectAll());else if(i.select.cellPos.col>=0&&i.select.cellPos.row>=0&&("ArrowUp"===r.key||"ArrowDown"===r.key||"ArrowLeft"===r.key||"ArrowRight"===r.key)){let t,n;if((null==(o=null==(a=e.options.keyboardOptions)?void 0:a.moveEditCellOnArrowKeys)||!o)&&(null==(h=e.editorManager)?void 0:h.editingEditor)||!1===(null==(u=e.options.keyboardOptions)?void 0:u.moveSelectedCellOnArrowKeys)||(r.preventDefault(),r.stopPropagation(),"ArrowUp"===r.key?r.ctrlKey||r.metaKey?(t=i.select.cellPos.col,n=0):(r.shiftKey,t=i.select.cellPos.col,n=Math.min(e.rowCount-1,Math.max(0,i.select.cellPos.row-1))):"ArrowDown"===r.key?r.ctrlKey||r.metaKey?(t=i.select.cellPos.col,n=e.rowCount-1):(r.shiftKey,t=i.select.cellPos.col,n=Math.min(e.rowCount-1,Math.max(0,i.select.cellPos.row+1))):"ArrowLeft"===r.key?r.ctrlKey||r.metaKey?(t=0,n=i.select.cellPos.row):(r.shiftKey,n=i.select.cellPos.row,t=Math.min(e.colCount-1,Math.max(0,i.select.cellPos.col-1))):"ArrowRight"===r.key&&(r.ctrlKey||r.metaKey?(t=e.colCount-1,n=i.select.cellPos.row):(r.shiftKey,n=i.select.cellPos.row,t=Math.min(e.colCount-1,Math.max(0,i.select.cellPos.col+1)))),t1(e,t,n)))return;let s=null==(c=null==(d=e.options.keyboardOptions)?void 0:d.shiftMultiSelect)||c;e.selectCell(t,n,r.shiftKey&&s),null!=(g=null==(p=e.options.keyboardOptions)?void 0:p.moveEditCellOnArrowKeys)&&g&&(null==(f=e.editorManager)?void 0:f.editingEditor)&&(null==(m=e.editorManager)||m.completeEdit(),e.getElement().focus(),e.getEditor(t,n)&&(null==(y=e.editorManager)||y.startEditCell(t,n)))}else if("Escape"===r.key)null==(v=e.editorManager)||v.cancelEdit(),e.getElement().focus();else if("Enter"===r.key){if(null==(b=e.editorManager)?void 0:b.editingEditor){if(n(r),null==(_=e.editorManager)||_.completeEdit(),e.getElement().focus(),!0===(null==(x=e.options.keyboardOptions)?void 0:x.moveFocusCellOnEnter)){let t=i.select.cellPos.col,n=Math.min(e.rowCount-1,Math.max(0,i.select.cellPos.row+1));if(t1(e,t,n))return;let s=null==(w=null==(C=e.options.keyboardOptions)?void 0:C.shiftMultiSelect)||w;e.selectCell(t,n,r.shiftKey&&s)}return}if(!0===(null==(S=e.options.keyboardOptions)?void 0:S.moveFocusCellOnEnter)){let t=i.select.cellPos.col,n=Math.min(e.rowCount-1,Math.max(0,i.select.cellPos.row+1));if(t1(e,t,n))return;let s=null==(M=null==(A=e.options.keyboardOptions)?void 0:A.shiftMultiSelect)||M;e.selectCell(t,n,r.shiftKey&&s)}else if((null==(T=null==(k=e.options.keyboardOptions)?void 0:k.editCellOnEnter)||T)&&1===(null!=(B=null==(R=e.stateManager.select.ranges)?void 0:R.length)?B:0)){let t=e.stateManager.select.ranges[0].start.col,i=e.stateManager.select.ranges[0].start.row,r=e.stateManager.select.ranges[0].end.col,n=e.stateManager.select.ranges[0].end.row;t===r&&i===n&&e.getEditor(t,i)&&(null==(P=e.editorManager)||P.startEditCell(t,i))}}else if("Tab"===r.key){if((null==(L=null==(I=e.options.keyboardOptions)?void 0:I.moveFocusCellOnTab)||L)&&i.select.cellPos.col>=0&&i.select.cellPos.row>=0){let t,n;if(i.select.cellPos.col===e.colCount-1&&i.select.cellPos.row===e.rowCount-1||(r.preventDefault(),i.select.cellPos.col===e.colCount-1?(n=Math.min(e.rowCount-1,i.select.cellPos.row+1),t=e.rowHeaderLevelCount):(n=i.select.cellPos.row,t=i.select.cellPos.col+1),t1(e,t,n)))return;e.selectCell(t,n),(null==(F=e.editorManager)?void 0:F.editingEditor)&&(null==(O=e.editorManager)||O.completeEdit(),e.getElement().focus(),e.getEditor(t,n)&&(null==(D=e.editorManager)||D.startEditCell(t,n)))}}else if(!r.ctrlKey&&!r.metaKey){let t=e.options.editCellTrigger;("keydown"===t||Array.isArray(t)&&t.includes("keydown"))&&!(null==(H=e.editorManager)?void 0:H.editingEditor)&&r.key.match(/^[a-zA-Z0-9+\-*\/%=.,\s]$/)&&(e.editorManager&&(e.editorManager.beginTriggerEditCellMode="keydown"),null==(z=e.editorManager)||z.startEditCell(i.select.cellPos.col,i.select.cellPos.row,""))}n(r)}),r.on(e.getElement(),"copy",i=>rt(this,void 0,void 0,function*(){var r;(null==(r=e.keyboardOptions)?void 0:r.copySelected)&&t.handleCopy(i)})),r.on(e.getElement(),"cut",i=>rt(this,void 0,void 0,function*(){var r;(null==(r=e.keyboardOptions)?void 0:r.cutSelected)&&t.handleCut(i)})),r.on(e.getElement(),"paste",i=>rt(this,void 0,void 0,function*(){var r;(null==(r=e.keyboardOptions)?void 0:r.pasteValueToCell)&&t.handlePaste(i)})),r.on(e.getElement(),"contextmenu",t=>{var i;!1!==(null==(i=e.eventOptions)?void 0:i.preventDefaultContextMenu)?t.preventDefault():l(t)}),e.options.canvas||r.on(e.getContainer(),"resize",t=>{var i;e.isReleased||0===t.width&&0===t.height||((e.autoFillWidth||e.autoFillHeight)&&(null==(i=e.editorManager)||i.completeEdit()),(0,y.Z)(e.options.pixelRatio)||e.setPixelRatio(i7()),t.windowSizeNotChange||e.resize())});let s=r=>{var n;if(e.isReleased)return;e.eventManager.LastBodyPointerXY={x:r.x,y:r.y},e.eventManager.isDown=!0;let s=r.target;if(!e.getElement().contains(s)&&!e.internalProps.menuHandler.containElement(s)){let s=null==(n=e.editorManager)?void 0:n.completeEdit(r);(0,P.NC)(s,r=>{var n,s;if(!1!==r&&(null==(n=e.options.select)?void 0:n.outsideClickDeselect)){let e=!!(null==(s=i.select.ranges)?void 0:s.length);t.dealTableSelect(),i.endSelectCells(!0,e)}})}};t.globalEventListeners.push({name:"pointerdown",env:"vglobal",callback:s}),W.rF.addEventListener("pointerdown",s);let l=r=>{var n,s;if(e.isReleased)return;let l=r.target;if(l!==e.canvas&&(t=>{var r,n;if(i.menu.isShow&&setTimeout(()=>{e.internalProps.menuHandler.pointInMenuElement(t.clientX,t.clientY)||i.menu.isShow&&i.hideMenu()},0),i.isResizeCol())i6(e);else if(i.isResizeRow())i8(e);else if(i.isMoveCol()){let i=e.stateManager.endMoveCol();i4(e,i,t)}else if(i.isSelecting()&&(null==(n=null==(r=e.stateManager.select)?void 0:r.ranges)?void 0:n.length)){let i=e.stateManager.select.ranges[e.stateManager.select.ranges.length-1].end.col,r=e.stateManager.select.ranges[e.stateManager.select.ranges.length-1].end.row;if(e.stateManager.endSelectCells(),e.hasListeners(E.B.DRAG_SELECT_END)){let n={event:t,cells:[],col:i,row:r,scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,target:void 0};n.cells=e.getSelectedCellInfos(),e.fireListeners(E.B.DRAG_SELECT_END,n)}}})(r),e.eventManager.LastBodyPointerXY=null,e.eventManager.isDown=!1,e.eventManager.isDraging=!1,e.eventManager.inertiaScroll.endInertia(),"grabing"===i.interactionState&&i.isResizeCol())i6(e);else if("grabing"===i.interactionState&&i.isResizeRow())i8(e);else if(i.isMoveCol()){let t=e.stateManager.endMoveCol();i4(e,t,r)}else if((null==(n=e.editorManager)?void 0:n.editingEditor)&&!e.getElement().contains(l)){let n=null==(s=e.editorManager)?void 0:s.completeEdit(r);(0,P.NC)(n,e=>{!1!==e&&(i.updateInteractionState(B.F.default),t.dealTableHover())})}i.updateInteractionState(B.F.default)};t.globalEventListeners.push({name:"pointerup",env:"vglobal",callback:l}),W.rF.addEventListener("pointerup",l);let a=r=>{var n,s,l,a,o;if(e.eventManager.isDown&&e.eventManager.LastBodyPointerXY){let t=null!=(s=null==(n=e.eventManager.LastBodyPointerXY)?void 0:n.x)?s:r.x,i=null!=(a=null==(l=e.eventManager.LastBodyPointerXY)?void 0:l.y)?a:r.y;(Math.abs(t-r.x)>1||Math.abs(i-r.y)>1)&&(e.eventManager.isDraging=!0)}let{x:h,y:u}=e._getMouseAbstractPoint(r);i.interactionState===B.F.grabing&&(i.isResizeCol()?(t.dealColumnResize(h,u),e.hasListeners(E.B.RESIZE_COLUMN)&&e.fireListeners(E.B.RESIZE_COLUMN,{col:e.stateManager.columnResize.col,colWidth:e.getColWidth(e.stateManager.columnResize.col)})):i.isResizeRow()&&(t.dealRowResize(h,u),e.hasListeners(E.B.RESIZE_ROW)&&e.fireListeners(E.B.RESIZE_ROW,{row:e.stateManager.rowResize.row,rowHeight:e.getRowHeight(e.stateManager.rowResize.row)})));let d=e.stateManager.isSelecting();if(t._enableTableScroll&&t.isDraging&&d&&(null==(o=e.stateManager.select.ranges)?void 0:o.length)>0){let t=e.getDrawRange(),i=e.getFrozenRowsHeight(),r=e.getBottomFrozenRowsHeight(),n=e.getFrozenColsWidth(),s=e.getRightFrozenColsWidth(),l=e.stateManager.select.ranges[e.stateManager.select.ranges.length-1].start;if(e.isSeriesNumber(l.col,l.row))return;let a=e.stateManager.select.ranges[e.stateManager.select.ranges.length-1].end,o=(!1===e.isFrozenRow(l.row)||!1===e.isFrozenRow(a.row))&&e.getAllRowsHeight()>e.tableNoFrameHeight,d=(!1===e.isFrozenColumn(l.col)||!1===e.isFrozenColumn(a.col))&&e.getAllColsWidth()>e.tableNoFrameWidth;if((u>t.bottom-r||u<t.top+i)&&o||(h>t.right-s||h<t.left+n)&&d){e.eventManager.scrollXSpeed=0,e.eventManager.scrollYSpeed=0;let l=!1,a=!1,c=!1,p=!1;u>t.bottom-r&&o&&e.scrollTop+e.tableNoFrameHeight<e.getAllRowsHeight()?(l=!0,e.eventManager.scrollYSpeed=-(u-t.bottom+r)/50):u<t.top+i&&o&&e.scrollTop>0&&(a=!0,e.eventManager.scrollYSpeed=-(u-t.top-i)/50),h>t.right-s&&d&&e.scrollLeft+e.tableNoFrameWidth<e.getAllColsWidth()?(c=!0,e.eventManager.scrollXSpeed=-(h-t.right+s)/50):h<t.left+n&&d&&e.scrollLeft>0&&(p=!0,e.eventManager.scrollXSpeed=-(h-t.left-n)/50),e.eventManager.inertiaScroll.startInertia(e.eventManager.scrollXSpeed,e.eventManager.scrollYSpeed,1),e.eventManager.inertiaScroll.setScrollHandle((o,d)=>{var g;let f,m;i1({deltaX:-o,deltaY:-d},e.stateManager,!1),l?m=e.scrollTop+t.height-r-20:a&&(m=e.scrollTop+i+20),c?f=e.scrollLeft+t.width-s-20:p&&(f=e.scrollLeft+n+20);let v=!1,b=!1;c||p||(h>e.tableNoFrameWidth-e.getRightFrozenColsWidth()&&h<e.tableNoFrameWidth||h>0&&h<e.getFrozenColsWidth()?(f=h,b=!0):f=e.scrollLeft+h),l||a||(u>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()&&u<e.tableNoFrameHeight||u>0&&u<e.getFrozenRowsHeight()?(m=u,v=!0):m=e.scrollTop+u),e.stateManager.updateInteractionState(B.F.grabing);let _=e.getTargetColAtConsiderRightFrozen(f,b),x=e.getTargetRowAtConsiderBottomFrozen(m,v);!(null==(g=e.options.select)?void 0:g.disableDragSelect)&&(0,y.Z)(_)&&(0,y.Z)(x)&&e.stateManager.updateSelectPos("row"===e.stateManager.select.selectInline?e.colCount-1:_.col,"col"===e.stateManager.select.selectInline?e.rowCount-1:x.row,!1,!1,!1,!1)})}else e.eventManager.inertiaScroll.isInertiaScrolling()?e.eventManager.inertiaScroll.endInertia():e.eventManager.scrollYSpeed=0}};t.globalEventListeners.push({name:"pointermove",env:"vglobal",callback:a}),W.rF.addEventListener("pointermove",a)}(this),function(t){let e=t.table,i=e.stateManager,r=e.scenegraph;r.component.vScrollBar.addEventListener("pointerover",t=>{i.showVerticalScrollBar()}),r.component.hScrollBar.addEventListener("pointerover",t=>{i.showHorizontalScrollBar()}),r.component.vScrollBar.addEventListener("pointerout",t=>{i.interactionState!==B.F.scrolling&&i.hideVerticalScrollBar()}),r.component.hScrollBar.addEventListener("pointerout",t=>{i.interactionState!==B.F.scrolling&&i.hideHorizontalScrollBar()}),r.component.vScrollBar.addEventListener("pointermove",t=>{r.table.stateManager.updateCursor("default"),t.stopPropagation()}),r.component.vScrollBar.addEventListener("pointerdown",t=>{t.stopPropagation(),r.table.hasListeners(E.B.MOUSEDOWN_TABLE)&&r.table.fireListeners(E.B.MOUSEDOWN_TABLE,{event:t.nativeEvent})}),r.component.vScrollBar.addEventListener("scrollDown",t=>{var e;r.table.eventManager.LastBodyPointerXY={x:t.x,y:t.y},r.table.eventManager.isDown=!0,i.interactionState!==B.F.scrolling&&i.updateInteractionState(B.F.scrolling),r.table.stateManager.hideMenu(),null==(e=r.table.editorManager)||e.completeEdit(),r.table.hasListeners(E.B.MOUSEDOWN_TABLE)&&r.table.fireListeners(E.B.MOUSEDOWN_TABLE,{event:t.nativeEvent})}),r.component.vScrollBar.addEventListener("pointerup",()=>{i.fastScrolling=!1,r.table.eventManager.isDraging=!1,i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default)}),r.component.vScrollBar.addEventListener("pointerupoutside",()=>{i.fastScrolling=!1,i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default)}),r.component.vScrollBar.addEventListener("scrollUp",t=>{r.table.eventManager.isDraging=!1}),r.component.hScrollBar.addEventListener("pointermove",t=>{r.table.stateManager.updateCursor(),t.stopPropagation()}),r.component.hScrollBar.addEventListener("pointerdown",t=>{t.stopPropagation(),r.table.hasListeners(E.B.MOUSEDOWN_TABLE)&&r.table.fireListeners(E.B.MOUSEDOWN_TABLE,{event:t.nativeEvent})}),r.component.hScrollBar.addEventListener("scrollDown",t=>{var e;r.table.eventManager.LastBodyPointerXY={x:t.x,y:t.y},r.table.eventManager.isDown=!0,i.interactionState!==B.F.scrolling&&i.updateInteractionState(B.F.scrolling),r.table.stateManager.hideMenu(),null==(e=r.table.editorManager)||e.completeEdit(),r.table.hasListeners(E.B.MOUSEDOWN_TABLE)&&r.table.fireListeners(E.B.MOUSEDOWN_TABLE,{event:t.nativeEvent})}),r.component.hScrollBar.addEventListener("pointerup",()=>{i.fastScrolling=!1,r.table.eventManager.isDraging=!1,i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default)}),r.component.hScrollBar.addEventListener("pointerupoutside",()=>{i.fastScrolling=!1,i.interactionState===B.F.scrolling&&i.updateInteractionState(B.F.default)}),r.component.hScrollBar.addEventListener("scrollUp",t=>{r.table.eventManager.isDraging=!1});let n=(0,O.P2)(i.updateVerticalScrollBar,20),s=(0,O.P2)(i.updateHorizontalScrollBar,20);r.component.vScrollBar.addEventListener("scrollDrag",t=>{r.table.eventManager.isDown&&(r.table.eventManager.isDraging=!0),i.fastScrolling=!0,i.interactionState!==B.F.scrolling&&i.updateInteractionState(B.F.scrolling),n(t.detail.value[0]/(1-t.detail.value[1]+t.detail.value[0]),t)}),r.component.hScrollBar.addEventListener("scrollDrag",t=>{r.table.eventManager.isDown&&(r.table.eventManager.isDraging=!0),i.fastScrolling=!0,i.interactionState!==B.F.scrolling&&i.updateInteractionState(B.F.scrolling),s(t.detail.value[0]/(1-t.detail.value[1]+t.detail.value[0]))})}(this),function(t){let e=t.table,i=e.stateManager,r=e.scenegraph;if(!1===W.rF.envContribution.supportsTouchEvents)return;W.rF.addEventListener("contextmenu",t=>{t.stopPropagation(),t.preventDefault()},{capture:!0}),t.touchMovePoints=[],e.scenegraph.tableGroup.addEventListener("touchstart",i=>{var n,s,l,a,o,h,u,d;if(i.target.isChildOf(r.component.vScrollBar)||i.target.isChildOf(r.component.vScrollBar))return;t.isTouchdown=!0;let c=i.nativeEvent;t.touchMovePoints.push({x:e.rotateDegree?null!=(l=null==(s=null==(n=c.changedTouches)?void 0:n[0])?void 0:s._canvasX)?l:null==(a=i.canvas)?void 0:a.x:i.page.x,y:e.rotateDegree?null!=(u=null==(h=null==(o=c.changedTouches)?void 0:o[0])?void 0:h._canvasY)?u:null==(d=i.canvas)?void 0:d.y:i.page.y,timestamp:Date.now()})});let n=r=>{var n,s;if(t.isLongTouch&&r.preventDefault(),t.isTouchdown&&re(r)){if(t.isTouchMove=!0,(null==(s=null==(n=t.downIcon)?void 0:n.attribute)?void 0:s.funcType)===j.cI.dragReorder)r.preventDefault();else if(t.touchMovePoints.length>4&&t.touchMovePoints.shift(),t.touchMovePoints.push({x:e.rotateDegree?r.changedTouches[0]._canvasX:r.changedTouches[0].pageX,y:e.rotateDegree?r.changedTouches[0]._canvasY:r.changedTouches[0].pageY,timestamp:Date.now()}),t._enableTableScroll){let n=-t.touchMovePoints[t.touchMovePoints.length-1].x+t.touchMovePoints[t.touchMovePoints.length-2].x,s=-t.touchMovePoints[t.touchMovePoints.length-1].y+t.touchMovePoints[t.touchMovePoints.length-2].y;i1({deltaX:n,deltaY:s},i),r.cancelable&&("none"===e.internalProps.overscrollBehavior||Math.abs(s)>=Math.abs(n)&&0!==s&&i2(s,i)||Math.abs(s)<=Math.abs(n)&&0!==n&&i3(n,i))&&r.preventDefault()}}};W.rF.addEventListener("touchmove",n,{passive:!1}),t.globalEventListeners.push({name:"touchmove",env:"vglobal",callback:n});let s=i=>{var r,n,s,l;if(t.touchEnd=!0,t.isLongTouch=!1,t.isTouchdown&&re(i)){if((null==(n=null==(r=t.downIcon)?void 0:r.attribute)?void 0:n.funcType)===j.cI.dragReorder)i.preventDefault();else if((null==(s=t.touchMovePoints)?void 0:s.length)&&(t.touchMovePoints.length>4&&t.touchMovePoints.shift(),t.touchMovePoints.push({x:e.rotateDegree?i.changedTouches[0]._canvasX:i.changedTouches[0].pageX,y:e.rotateDegree?i.changedTouches[0]._canvasY:i.changedTouches[0].pageY,timestamp:Date.now()}),t._enableTableScroll)){let i=t.touchMovePoints[0],r=t.touchMovePoints[(null==(l=t.touchMovePoints)?void 0:l.length)-1],n=(r.x-i.x)/(r.timestamp-i.timestamp),s=(r.y-i.y)/(r.timestamp-i.timestamp);t.inertiaScroll.startInertia(n,s,.95),e.eventManager.inertiaScroll.setScrollHandle((t,i)=>{i1({deltaX:-t,deltaY:-i},e.stateManager)})}t.isTouchdown=!1,t.isTouchMove=!1,t.isDraging=!1,t.touchMovePoints=[]}};W.rF.addEventListener("touchend",s),t.globalEventListeners.push({name:"touchend",env:"vglobal",callback:s});let l=e=>{t.touchEnd=!0,t.isLongTouch=!1,t.isTouchdown&&(t.isTouchdown=!1,t.isTouchMove=!1,t.touchMovePoints=[],t.isDraging=!1)};W.rF.addEventListener("touchcancel",l),t.globalEventListeners.push({name:"touchcancel",env:"vglobal",callback:l})}(this),function(t){let e=t.table;t.gesture=new i0.o(e.scenegraph.tableGroup,{tap:{interval:300}}),t.gesture.on("doubletap",t=>{!function(t,e){var i,r,n,s,l,a;let o=(0,io.RJ)(t),h=-1,u=-1;o.eventArgs&&(h=o.eventArgs.col,u=o.eventArgs.row);let d=e.getCellValue(h,u),c=null==(r=null==(i=o.eventArgs)?void 0:i.targetCell)?void 0:r.globalAABBBounds;if(c&&e.internalProps.focusControl.setFocusRect(new F.U(c.x1+e.scrollLeft,c.y1+e.scrollTop,c.x2-c.x1,c.y2-c.y1),d),e.hasListeners(E.B.DBLCLICK_CELL)){let i,r,d=e.getCellInfo(h,u);if(null==(n=o.eventArgs)?void 0:n.target){let t=ij(null==(s=o.eventArgs)?void 0:s.target);t&&(i=t.icon,r=t.position)}let c=Object.assign(Object.assign({},d),{event:t.nativeEvent,federatedEvent:t,cells:[],targetIcon:i?{name:i.name,position:r,funcType:i.attribute.funcType}:void 0,target:null==(l=null==o?void 0:o.eventArgs)?void 0:l.target,mergeCellInfo:null==(a=null==o?void 0:o.eventArgs)?void 0:a.mergeInfo});e.fireListeners(E.B.DBLCLICK_CELL,c)}}(t,e)})}(this)}updateEventBinder(){setTimeout(()=>{var t;this.table.isReleased||(eQ(this.table)&&0===(null==(t=this.handleTextStickBindId)?void 0:t.length)?(this.handleTextStickBindId.push(this.table.on(E.B.SCROLL,t=>{e$(this.table)})),this.handleTextStickBindId.push(this.table.on(E.B.RESIZE_COLUMN_END,t=>{e$(this.table)})),this.handleTextStickBindId.push(this.table.on(E.B.RESIZE_ROW_END,t=>{e$(this.table)}))):!eQ(this.table)&&this.handleTextStickBindId&&(this.handleTextStickBindId.forEach(t=>{this.table.off(t)}),this.handleTextStickBindId=[]),iQ(this.table))},0)}bindSelfEvent(){var t,e,i,r,n,s,l,a,o,h,u;this.table.isReleased||((t=this.table).on(E.B.ICON_CLICK,e=>{var i;let{col:r,row:n,x:s,y:l,funcType:a,icon:o,event:h}=e,{stateManager:u}=t;if(a===j.cI.dropDown)u.triggerDropDownMenu(r,n,s,l,h);else if(a===j.cI.sort)u.triggerSort(r,n,o,h);else if(a===j.cI.frozen)u.triggerFreeze(r,n,o);else if(a===j.cI.drillDown)t.fireListeners(iH.z.DRILLMENU_CLICK,t.stateManager.drill);else if(a===j.cI.collapse||a===j.cI.expand){let e=!!(null==(i=u.select.ranges)?void 0:i.length);u.updateSelectPos(-1,-1),u.endSelectCells(!0,e),t.toggleHierarchyState(r,n)}}),(e=this.table).on(E.B.DROPDOWN_MENU_CLICK,()=>{e.stateManager.hideMenu()}),e.on(E.B.SCROLL,()=>{e.stateManager.hideMenu()}),this.updateEventBinder(),i=this.table,"browser"===k.X.mode&&i.on(E.B.CLICK_CELL,t=>{let e,{col:r,row:n}=t;if("image"===t.target.type&&t.target.role&&t.target.role.startsWith("icon"))return;e=i.internalProps.layoutMap.isHeader(r,n)?i.isPivotTable()?i._getHeaderLayoutMap(r,n).headerType:i.getHeaderDefine(r,n).headerType:i.getBodyColumnType(r,n);let s=i.isHeader(r,n)?i.getHeaderDefine(r,n):i.getBodyColumnDefine(r,n),l=i.getCellValue(r,n),a=i.getCellOriginValue(r,n);if("link"===e){let t=(0,P.vi)(s.linkJump,{col:r,row:n,table:i,value:l,dataValue:a,cellHeaderPaths:void 0});if(!(t=!1!==t))return;let e=s.templateLink,o,h=(0,P.vi)(s.linkDetect,{col:r,row:n,table:i,value:l,dataValue:a,cellHeaderPaths:void 0});if(h=!1!==h,e){let t=i.getCellOriginRecord(r,n);if(t&&t.vtableMerge)return;let s=Object.assign({__value:l,__dataValue:a},t);o=(0,iq.Z)(e)?e(s,r,n,i):e.replace(/\{\s*(\S+?)\s*\}/g,(t,e)=>s[e])}else if(h){if(!iJ.tP.test(l))return;o=l}else o=l;if(!o)return;let u=s.linkTarget,d=s.linkWindowFeatures;window.open(o,u,d)}else if("image"===e){let{clickToPreview:t}=s;if(!1===t)return;let e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.backgroundColor="rgba(30, 30, 30, 0.4)",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.overflow="hidden",e.style.zIndex="9999",e.addEventListener("click",t=>{t.target===e&&document.body.removeChild(e)});let i=new Image;i.src=l,i.style.maxWidth="80%",i.style.maxHeight="80%",e.appendChild(i),document.body.appendChild(e)}else if("video"===e){let{clickToPreview:t}=s;if(!1===t)return;let e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.backgroundColor="rgba(30, 30, 30, 0.4)",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.overflow="hidden",e.style.zIndex="9999",e.addEventListener("click",t=>{t.target===e&&document.body.removeChild(e)});let i=document.createElement("video");i.src=l,i.style.maxWidth="80%",i.style.maxHeight="80%",i.setAttribute("preload","auto"),i.setAttribute("controls","true"),e.appendChild(i),document.body.appendChild(e)}}),(r=this.table).on(E.B.DBLCLICK_CELL,t=>{var e,i,n;if(t.federatedEvent){let s=(0,io.RJ)(t.federatedEvent),l=r.scenegraph.getResizeColAt(s.abstractPos.x,s.abstractPos.y,null==(e=s.eventArgs)?void 0:e.targetCell),a=null!=(i=r.options.disableDblclickAutoResizeColWidth)?i:null==(n=r.options.resize)?void 0:n.disableDblclickAutoResizeColWidth;if(r.eventManager.checkCellFillhandle(s))r.fireListeners(E.B.DBLCLICK_FILL_HANDLE,{});else if(r._canResizeColumn(l.col,l.row)&&l.col>=0&&!a){r.scenegraph.updateAutoColWidth(l.col),r.internalProps._widthResizedColMap.add(l.col),r.scenegraph.updateChartSizeForResizeColWidth(l.col);let t=r.stateManager;!(t.columnResize.col<t.table.frozenColCount)||t.table.isPivotTable()||t.table.transpose||t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1,t.columnResize.isRightFrozen),(t.columnResize.col>=t.table.colCount-t.table.rightFrozenColCount&&!t.table.isPivotTable()&&!t.table.transpose||t.table.options.rightFrozenColCount)&&t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount);let e=[];for(let t=0;t<r.colCount;t++)e.push(r.getColWidth(t));r.fireListeners(E.B.RESIZE_COLUMN_END,{col:l.col,colWidths:e})}}}),this.table.isPivotTable()&&function(t){let e=t.internalProps.layoutMap.rowsDefine,i=t.internalProps.layoutMap.columnsDefine;for(let t=0;t<e.length;t++){let i=e[t];if("string"!=typeof i&&(i.drillDown||i.drillUp))return!0}for(let t=0;t<i.length;t++){let e=i[t];if("string"!=typeof e&&(e.drillDown||e.drillUp))return!0}return!1}(this.table)&&((n=this.table).on(E.B.MOUSEENTER_CELL,t=>{let{col:e,row:i}=t;if(-1===e||-1===i)return;let r=n.internalProps.layoutMap.getHeaderDimension(e,i);(null==r?void 0:r.drillDown)||(null==r?void 0:r.drillUp)?n.stateManager.updateDrillState(r.dimensionKey,r.title,r.drillDown,r.drillUp,e,i):n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)}),n.on(E.B.MOUSELEAVE_TABLE,t=>{n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)})),iQ(this.table),(s=this.table).isPivotChart()&&s.scenegraph.tableGroup.addEventListener("click",t=>{var e;if(!s.stateManager.columnMove.moving&&!s.stateManager.columnResize.resizing)if("axis-label"===t.target.name){let e,i,{col:r,row:n}=(0,io.RJ)(t).eventArgs,l=s.internalProps.layoutMap;l.indicatorsAsCol?(e=l.getDimensionKeyInChartSpec(l.rowHeaderLevelCount,n),i=l.getCellHeaderPaths(l.rowHeaderLevelCount-2,n).rowHeaderPaths):(e=l.getDimensionKeyInChartSpec(r,l.columnHeaderLevelCount),i=l.getCellHeaderPaths(r,l.columnHeaderLevelCount-1).colHeaderPaths);let a=i.map(t=>({key:t.dimensionKey,value:t.value})).filter(t=>t.key);if(a.push({key:e,value:t.target.attribute.text}),s._selectedDimensionInChart.length&&function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i].key!==e[i].key||t[i].value!==e[i].value)return!1;return!0}(s._selectedDimensionInChart,a))return;s._selectedDimensionInChart=a,l.updateDataStateToChartInstance(),(0,ib.RW)(s.scenegraph),s.scenegraph.updateNextFrame()}else(null==(e=s._selectedDimensionInChart)?void 0:e.length)&&(s._selectedDimensionInChart.length=0,s.internalProps.layoutMap.updateDataStateToChartInstance(),(0,ib.RW)(s.scenegraph),s.scenegraph.updateNextFrame())}),(l=this.table).isPivotChart()&&(l.on(E.B.MOUSEENTER_CELL,t=>{l.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if("axis"===e.name){let e=ri(t.col,t.row,l.internalProps.layoutMap);t.axisPosition=e,l.fireListeners(E.B.MOUSEENTER_AXIS,t)}})}),l.on(E.B.MOUSELEAVE_CELL,t=>{l.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if("axis"===e.name){let e=ri(t.col,t.row,l.internalProps.layoutMap);t.axisPosition=e,l.fireListeners(E.B.MOUSELEAVE_AXIS,t)}})})),(a=this.table).on("checkbox_state_change",t=>{var e;let{col:i,row:r,checked:n,field:s}=t;if(!a.internalProps.layoutMap.isSeriesNumber(i,r)||!0!==a.internalProps.enableCheckboxCascade||a.isHeader(i,r))return;let l=a.getCellOriginRecord(i,r),o=a.dataSource.currentPagerIndexedData,h=a.getRecordShowIndexByCell(i,r),u=o[h];if((0,X.Z)(u)&&(u=[u]),l.vtableMerge||(null==(e=l.children)?void 0:e.length))if(n)rl(a,i,r)===R.g.collapse?rs(!0,u,a,s):rr(!0,h,u,o,a,i),rn(h,u,o,a,i);else{rl(a,i,r)===R.g.collapse?rs(!1,u,a,s):rr(!1,h,u,o,a,i),rn(h,u,o,a,i);let t=a.stateManager.headerCheckedState._vtable_rowSeries_number,e=a.stateManager.updateHeaderCheckedState("_vtable_rowSeries_number",i,r);t!==e&&a.scenegraph.updateHeaderCheckboxCellState(i,r,e)}else rn(h,u,o,a,i)}),(o=this.table).on("checkbox_state_change",t=>{var e;if(!0!==o.internalProps.enableCheckboxCascade)return;let{col:i,row:r,checked:n,field:s}=t,l=o.internalProps.columns.some(t=>t.tree);if(o.internalProps.enableCheckboxCascade,!l||o.isHeader(i,r))return;let a=o.getCellOriginRecord(i,r),h=o.dataSource.currentPagerIndexedData,u=o.getRecordShowIndexByCell(i,r),d=h[u];if((0,X.Z)(d)&&(d=[d]),a.vtableMerge||(null==(e=a.children)?void 0:e.length))if(n)rl(o,i,r)===R.g.collapse?rs(!0,d,o,s):rr(!0,u,d,h,o,i,s),rn(u,d,h,o,i,s);else{rl(o,i,r)===R.g.collapse?rs(!1,d,o,s):rr(!1,u,d,h,o,i,s),rn(u,d,h,o,i,s);let t=o.stateManager.headerCheckedState._vtable_rowSeries_number,e=o.stateManager.updateHeaderCheckedState(s,i,r);t!==e&&o.scenegraph.updateHeaderCheckboxCellState(i,r,e)}else rn(u,d,h,o,i,s)}),(h=this.table).on("checkbox_state_change",t=>{if(!0!==h.internalProps.enableHeaderCheckboxCascade)return;let{col:e,row:i,checked:r,field:n}=t;if(h.isHeader(e,i))h.stateManager.setHeaderCheckedState(n,r),"checkbox"===h.getCellType(e,i)&&h.scenegraph.updateCheckboxCellState(e,i,r);else if(h.stateManager.setCheckedState(e,i,n,r),"checkbox"===h.getCellType(e,i)){let t=h.stateManager.headerCheckedState[n],r=h.stateManager.updateHeaderCheckedState(n,e,i);t!==r&&h.scenegraph.updateHeaderCheckboxCellState(e,i,r)}}),(u=this.table).on(E.B.CLICK_CELL,t=>{let{col:e,row:i,target:r}=t;"button"!==r.name||r.attribute.disable||u.hasListeners(E.B.BUTTON_CLICK)&&u.fireListeners(E.B.BUTTON_CLICK,{col:e,row:i,event:t.event})}))}dealTableHover(t){if(!t)return void this.table.stateManager.updateHoverPos(-1,-1);let{eventArgs:e}=t;e?this.table.stateManager.updateHoverPos(e.col,e.row):this.table.stateManager.updateHoverPos(-1,-1)}dealIconHover(t){let{eventArgs:e}=t;e?this.table.stateManager.updateHoverIcon(e.col,e.row,e.target,e.targetCell):this.table.stateManager.updateHoverIcon(-1,-1,void 0,void 0)}dealMenuHover(t){}dealTableSelect(t,e){var i,r,n,s,l,a,o,h,u;if(!t)return this.table.stateManager.updateSelectPos(-1,-1),!1;let{eventArgs:d}=t;if(d){if("checkbox"===d.target.name||"radio"===d.target.name||"switch"===d.target.name||"button"===d.target.name)return!1;if(this.table.isHeader(d.col,d.row)&&t1(this.table,d.col,d.row))return e||this.table.stateManager.updateSelectPos(-1,-1),!1;if(!this.table.isHeader(d.col,d.row)&&t1(this.table,d.col,d.row)){if(!e){let t=!!(null==(i=this.table.stateManager.select.ranges)?void 0:i.length);this.table.stateManager.updateSelectPos(-1,-1),t&&this.table.stateManager.endSelectCells(!0,t)}return!1}if(this.table.isPivotChart()&&("axis-label"===(null==(r=null==t?void 0:t.eventArgs)?void 0:r.target.name)||"chart"===(null==(n=null==t?void 0:t.eventArgs)?void 0:n.target.type)))return this.table.stateManager.updateSelectPos(-1,-1),!1;let c=null==(l=null==(s=this.table.keyboardOptions)?void 0:s.shiftMultiSelect)||l,p=null==(o=null==(a=this.table.keyboardOptions)?void 0:a.ctrlMultiSelect)||o;return this.table.stateManager.updateSelectPos("row"===this.table.stateManager.select.selectInline?this.table.colCount-1:d.col,"col"===this.table.stateManager.select.selectInline?this.table.rowCount-1:d.row,d.event.shiftKey&&c,(d.event.ctrlKey||d.event.metaKey)&&p,!1,!e&&(null==(u=null==(h=this.table.options.select)?void 0:h.makeSelectCellVisible)||u)),!0}return!1}dealFillSelect(t,e){var i,r,n,s,l,a,o,h;let{eventArgs:u}=t;if(u){if((null==(r=null==(i=this.table.stateManager.select)?void 0:i.ranges)?void 0:r.length)&&this.table.stateManager.isFillHandle()){let i,r,l=this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1];e&&((0,y.Z)(this.table.stateManager.fillHandle.directionRow)||(Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.directionRow=!0:this.table.stateManager.fillHandle.directionRow=!1),Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.startY-t.abstractPos.y>0?this.table.stateManager.fillHandle.direction="top":this.table.stateManager.fillHandle.direction="bottom":this.table.stateManager.fillHandle.startX-t.abstractPos.x>0?this.table.stateManager.fillHandle.direction="left":this.table.stateManager.fillHandle.direction="right",this.table.stateManager.fillHandle.directionRow?(i=u.row,r=l.end.col):(i=l.end.row,r=u.col));let a=null==(s=null==(n=this.table.keyboardOptions)?void 0:n.ctrlMultiSelect)||s;this.table.stateManager.updateSelectPos(e?r:l.end.col,e?i:l.end.row,!0,(u.event.ctrlKey||u.event.metaKey)&&a,!1,!e)}else{let t=null==(a=null==(l=this.table.keyboardOptions)?void 0:l.shiftMultiSelect)||a,i=null==(h=null==(o=this.table.keyboardOptions)?void 0:o.ctrlMultiSelect)||h;this.table.stateManager.updateSelectPos(u.col,u.row,u.event.shiftKey&&t,(u.event.ctrlKey||u.event.metaKey)&&i,!1,!e)}return!0}return!1}deelTableSelectAll(){this.table.stateManager.updateSelectPos(-1,-1,!1,!1,!0),this.table.fireListeners(E.B.SELECTED_CELL,{ranges:this.table.stateManager.select.ranges,col:0,row:0})}dealMenuSelect(t){}checkColumnResize(t,e){let{eventArgs:i}=t;if(this.table.internalProps.enableTreeStickCell&&!i)return!1;let r=this.table.scenegraph.getResizeColAt(t.abstractPos.x,t.abstractPos.y,null==i?void 0:i.targetCell);return this.table._canResizeColumn(r.col,r.row)&&r.col>=0?(e&&this.table.stateManager.startResizeCol(r.col,t.abstractPos.x,t.abstractPos.y,r.rightFrozen),!0):(this.table.stateManager.isResizeCol()&&this.table.stateManager.endResizeCol(),!1)}checkRowResize(t,e){let{eventArgs:i}=t;if(i){let r=this.table.scenegraph.getResizeRowAt(t.abstractPos.x,t.abstractPos.y,i.targetCell);if(this.table._canResizeRow(r.col,r.row)&&r.row>=0)return e&&this.table.stateManager.startResizeRow(r.row,t.abstractPos.x,t.abstractPos.y,r.bottomFrozen),!0}return!1}cellIsHeaderCheck(t,e){let{eventArgs:i}=t,{col:r,row:n,target:s}=i;return!!this.table.isHeader(r,n)&&"checkbox"===this.table.getCellType(i.col,i.row)&&"checkbox"===s.name}checkCellFillhandle(t,e){var i,r,n,s,l;if("function"==typeof(null==(i=this.table.options.excelOptions)?void 0:i.fillHandle)?this.table.options.excelOptions.fillHandle({selectRanges:this.table.stateManager.select.ranges,table:this.table}):null==(r=this.table.options.excelOptions)?void 0:r.fillHandle){let{eventArgs:i}=t;if(i&&(null==(s=null==(n=this.table.stateManager.select)?void 0:n.ranges)?void 0:s.length)){let i,r,n=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),s=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row),a=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),o=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row);i=n<this.table.colCount-1?this.table.scenegraph.highPerformanceGetCell(n,s).globalAABBBounds.x2:0===a?this.table.scenegraph.highPerformanceGetCell(0,s).globalAABBBounds.x1:this.table.scenegraph.highPerformanceGetCell(a-1,s).globalAABBBounds.x2;let h=Math.abs(t.abstractPos.x-i);r=s<this.table.rowCount-1?this.table.scenegraph.highPerformanceGetCell(n,s).globalAABBBounds.y2:this.table.scenegraph.highPerformanceGetCell(n,o-1).globalAABBBounds.y2;let u=Math.abs(t.abstractPos.y-r);if((null==(l=this.table.stateManager.fillHandle)?void 0:l.isFilling)||h<=9&&u<=9)return e&&this.table.stateManager.startFillSelect(t.abstractPos.x,t.abstractPos.y),!0}}return!1}dealColumnResize(t,e){this.table.stateManager.updateResizeCol(t,e)}dealRowResize(t,e){this.table.stateManager.updateResizeRow(t,e)}checkColumnMover(t){var e;let{eventArgs:i}=t;return!(!i||!this.table._canDragHeaderPosition(i.col,i.row))&&(this.table.stateManager.startMoveCol(i.col,i.row,t.abstractPos.x,t.abstractPos.y,null==(e=null==i?void 0:i.event)?void 0:e.nativeEvent),!0)}dealColumnMover(t){var e;let{eventArgs:i}=t;(0,y.Z)(i.col)&&(0,y.Z)(i.row)&&this.table.stateManager.updateMoveCol(i.col,i.row,t.abstractPos.x,t.abstractPos.y,null==(e=null==i?void 0:i.event)?void 0:e.nativeEvent)}startColumnResize(t){}dealIconClick(t,e){let{eventArgs:i}=e,{target:r,event:n,col:s,row:l}=i||{target:t.target,event:t,col:-1,row:-1};if(r.role&&r.role.startsWith("icon-"))return this.table.fireListeners(E.B.ICON_CLICK,{name:r.name,x:(r.globalAABBBounds.x1+r.globalAABBBounds.x2)/2,y:r.globalAABBBounds.y2,col:s,row:l,funcType:r.attribute.funcType,icon:r,event:n}),!0;if(r instanceof iX.H){let t=r.pickIcon(n.global);if(t)return this.table.fireListeners(E.B.ICON_CLICK,{name:t.attribute.id,x:t.globalX+t.globalAABBBounds.width()/2,y:t.globalY+t.AABBBounds.height(),col:s,row:l,funcType:t.attribute.funcType,icon:t,event:n}),!0}return!1}release(){var t;null==(t=this.gesture)||t.release(),this.globalEventListeners.forEach(t=>{"document"===t.env?document.removeEventListener(t.name,t.callback):"body"===t.env?document.body.removeEventListener(t.name,t.callback):"window"===t.env?window.removeEventListener(t.name,t.callback):"vglobal"===t.env&&W.rF.removeEventListener(t.name,t.callback)}),this.globalEventListeners=[]}enableScroll(){this._enableTableScroll=!0}disableScroll(){this._enableTableScroll=!1}handleCopy(t,e=!1){var i,r;return ra(this,void 0,void 0,function*(){let n=this.table;e||(this.cutWaitPaste=!1);let s=this.table.getCopyValue();if((0,y.Z)(s)){t.preventDefault();let r=yield navigator.permissions.query({name:"clipboard-write"});if((null==(i=navigator.clipboard)?void 0:i.write)&&"granted"===r.state){let t=(t=>{let e=["<table>"],i=t.split("\r\n");return i.forEach(function(t,r){let n=t.split("	"),s=[];0===r&&e.push("<tbody>"),n.forEach(function(t,e){let i=t?t.toString().replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`).replace(/\t/gi,"&#9;"):" ";s.push(`<td>${i}</td>`)}),e.push("<tr>",...s,"</tr>"),r===i.length-1&&e.push("</tbody>")}),e.push("</table>"),['<meta name="author" content="Visactor"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>',e.join("")].join("")})(s);navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([t],{type:"text/html"}),"text/plain":new Blob([s],{type:"text/plain"})})])}else P.Xh.IE?window.clipboardData.setData("Text",s):t.clipboardData.setData("text/plain",s);n.fireListeners(E.B.COPY_DATA,{cellRange:n.stateManager.select.ranges,copyData:s,isCut:e})}(null==(r=n.keyboardOptions)?void 0:r.showCopyCellBorder)&&((0,T.NR)(n),n.clearSelected())})}handleCut(t){return ra(this,void 0,void 0,function*(){this.handleCopy(t,!0),this.cutWaitPaste=!0,this.cutCellRange=this.table.getSelectedCellInfos(),this.clipboardCheckTimer&&clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=window.setTimeout(()=>{this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer=null)},3e4),this.saveClipboardContent()})}handlePaste(t){this.cutWaitPaste?this.checkClipboardChanged().then(e=>{this.executePaste(t),e||this.clearCutArea(this.table),this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer&&(clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=null))}).catch(()=>{this.executePaste(t),this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer&&(clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=null))}):this.executePaste(t)}executePaste(t){var e,i,r,n;return ra(this,void 0,void 0,function*(){let s=this.table;if(s.changeCellValues){if(null==(e=s.editorManager)?void 0:e.editingEditor)return;if((null==(i=s.stateManager.select.ranges)?void 0:i.length)>0)if(null==(r=navigator.clipboard)?void 0:r.read)navigator.clipboard.read().then(t=>{for(let e of t)e.types.includes("text/html")?this.pasteHtmlToTable(e):1===e.types.length&&"text/plain"===e.types[0]&&this.pasteTextToTable(e)});else{let e=s.stateManager.select.ranges,i=Math.min(e[0].start.col,e[0].end.col),r=Math.min(e[0].start.row,e[0].end.row),n=(t.clipboardData||window.Clipboard).getData("text").split("\n"),l=[];n.forEach(function(t,e){let i=t.split("	"),r=[];l.push(r),i.forEach(function(t,e){e===i.length-1&&(t=t.trim()),r.push(t)})});let a=yield s.changeCellValues(i,r,l,!0);s.hasListeners(E.B.PASTED_DATA)&&s.fireListeners(E.B.PASTED_DATA,{col:i,row:r,pasteData:l,changedCellResults:a})}}(null==(n=s.keyboardOptions)?void 0:n.showCopyCellBorder)&&(0,T.Z7)(s)})}clearCutArea(t){try{let e=this.cutCellRange;if(!e||0===e.length)return;for(let i=0;i<e.length;i++)for(let r=0;r<e[i].length;r++)e[i][r]&&t.changeCellValue(e[i][r].col,e[i][r].row,void 0)}catch(t){}}checkClipboardChanged(){return ra(this,void 0,void 0,function*(){if(!navigator.clipboard||!navigator.clipboard.readText)return!1;try{return(yield navigator.clipboard.readText())!==this.lastClipboardContent}catch(t){return!1}})}saveClipboardContent(){navigator.clipboard&&navigator.clipboard.readText&&setTimeout(()=>{navigator.clipboard.readText().then(t=>{this.lastClipboardContent=t}).catch(t=>{})},50)}pasteHtmlToTable(t){let e=/<tr[^>]*>([\s\S]*?)<\/tr>/g,i=/<td[^>]*>([\s\S]*?)<\/td>/g,r=this.table,n=r.stateManager.select.ranges,s=n.length,l=Math.min(n[s-1].start.col,n[s-1].end.col),a=Math.min(n[s-1].start.row,n[s-1].end.row),o=Math.max(n[s-1].start.col,n[s-1].end.col),h=Math.max(n[s-1].start.row,n[s-1].end.row),u=0,d=0,c=[];t.getType("text/html").then(t=>{t.text().then(t=>ra(this,void 0,void 0,function*(){var n,s;if(t&&/(<table)|(<TABLE)/g.test(t)){for(let r of Array.from(t.matchAll(e))){let t=Array.from(r[1].matchAll(i)).map(t=>t[1].replace(/(<(?!br)([^>]+)>)/gi,"").replace(/<br(\s*|\/)>[\r\n]?/gim,"\n").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#9;/gi,"	").replace(/&nbsp;/g," "));c.push(t),u=Math.max(u,null!=(n=null==t?void 0:t.length)?n:0)}d=null!=(s=c.length)?s:0,c=this.handlePasteValues(c,d,u,h-a+1,o-l+1);let p=yield r.changeCellValues(l,a,c,!0);r.hasListeners(E.B.PASTED_DATA)&&r.fireListeners(E.B.PASTED_DATA,{col:l,row:a,pasteData:c,changedCellResults:p})}else navigator.clipboard.read().then(t=>{for(let e of t)e.types.includes("text/plain")&&e.getType("text/plain").then(t=>{t.text().then(t=>this._pasteValue(t))})})}))})}_pasteValue(t){var e;return ra(this,void 0,void 0,function*(){let i=this.table,r=i.stateManager.select.ranges,n=r.length,s=Math.min(r[n-1].start.col,r[n-1].end.col),l=Math.min(r[n-1].start.row,r[n-1].end.row),a=Math.max(r[n-1].start.col,r[n-1].end.col),o=Math.max(r[n-1].start.row,r[n-1].end.row),h=0,u=0,d=[];t.split("\n").forEach(function(t,e){var i;let r=t.split("	"),n=[];d.push(n),r.forEach(function(t,e){e===r.length-1&&(t=t.trim()),n.push(t)}),h=Math.max(h,null!=(i=null==n?void 0:n.length)?i:0)}),u=null!=(e=d.length)?e:0,d=this.handlePasteValues(d,u,h,o-l+1,a-s+1);let c=yield i.changeCellValues(s,l,d,!0);i.hasListeners(E.B.PASTED_DATA)&&i.fireListeners(E.B.PASTED_DATA,{col:s,row:l,pasteData:d,changedCellResults:c})})}pasteTextToTable(t){let e=this.table,i=e.stateManager.select.ranges,r=i.length,n=Math.min(i[r-1].start.col,i[r-1].end.col),s=Math.min(i[r-1].start.row,i[r-1].end.row),l=Math.max(i[r-1].start.col,i[r-1].end.col),a=Math.max(i[r-1].start.row,i[r-1].end.row),o=0,h=0;t.getType("text/plain").then(t=>{t.text().then(t=>ra(this,void 0,void 0,function*(){var i;let r=t.replace(/\r(?!\n)/g,"\r\n").split("\r\n"),u=[];r.length>1&&""===r[r.length-1]&&r.pop(),r.forEach(function(t,e){var i;let r=t.split("	"),n=[];u.push(n),r.forEach(function(t,e){t.includes("\n")&&(t=t.replace(/^"(.*)"$/,"$1").replace(/["]*/g,t=>Array(Math.floor(t.length/2)).fill('"').join(""))),n.push(t)}),o=Math.max(o,null!=(i=null==n?void 0:n.length)?i:0)}),h=null!=(i=u.length)?i:0,u=this.handlePasteValues(u,h,o,a-s+1,l-n+1);let d=yield e.changeCellValues(n,s,u,!0);e.hasListeners(E.B.PASTED_DATA)&&e.fireListeners(E.B.PASTED_DATA,{col:n,row:s,pasteData:u,changedCellResults:d})}))})}handlePasteValues(t,e,i,r,n){if((n>i||r>e)&&n%i==0&&r%e==0){let s=[];for(let l=0;l<r;l++){let r=[];s.push(r);for(let s=0;s<n;s++){let n=l%e,a=s%i;r.push(t[n][a])}}return s}return t}}class rh extends _{static get DEFAULT(){return o||(o=new rh)}constructor(t={},e={}){var i,r;super(t,e),this._autoWrapText=null!=(i=null==t?void 0:t.autoWrapText)?i:null==e?void 0:e.autoWrapText,this._lineClamp=null!=(r=null==t?void 0:t.lineClamp)?r:null==e?void 0:e.lineClamp}clone(){return new rh(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}let ru=t=>{let e=t.value;return Number(e)>80?"#20a8d8":Number(e)>50?"#4dbd74":Number(e)>20?"#ffc107":"#f86c6b"};class rd extends _{static get DEFAULT(){return h||(h=new rd)}constructor(t={},e={}){var i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y;super(t,e),this._showBar=null==(i=t.showBar)||i,this._barColor=null!=(r=t.barColor)?r:ru,this._barPositiveColor=null!=(n=t.barPositiveColor)?n:"#4dbd74",this._barNegativeColor=null!=(s=t.barNegativeColor)?s:"#f86c6b",this._barAxisColor=null!=(l=t.barAxisColor)?l:"black",this._barBgColor=t.barBgColor,this._barHeight=null!=(a=t.barHeight)?a:3,this._barHeight=null!=(o=t.barHeight)?o:3,this._barBottom=null!=(h=t.barBottom)?h:0,this._barPadding=null!=(u=t.barPadding)?u:[0,0,0,0],this._showBarMark=null!=(d=t.showBarMark)&&d,this._barMarkPositiveColor=null!=(c=t.barMarkPositiveColor)?c:"#4dbd74",this._barMarkNegativeColor=null!=(p=t.barMarkNegativeColor)?p:"#f86c6b",this._barMarkWidth=null!=(g=t.barMarkWidth)?g:2,this._barMarkPosition=null!=(f=t.barMarkPosition)?f:"right",this._barRightToLeft=null!=(m=t.barRightToLeft)&&m,this._barMarkInBar=null==(y=t.barMarkInBar)||y}get showBar(){return this._showBar}set showBar(t){this._showBar=t}get barColor(){return this._barColor}set barColor(t){this._barColor=t}get barBgColor(){return this._barBgColor}set barBgColor(t){this._barBgColor=t}get barHeight(){return this._barHeight}set barHeight(t){this._barHeight=t}get barBottom(){return this._barBottom}set barBottom(t){this._barBottom=t}get barPositiveColor(){return this._barPositiveColor}set barPositiveColor(t){this._barPositiveColor=t}get barNegativeColor(){return this._barNegativeColor}set barNegativeColor(t){this._barNegativeColor=t}get barAxisColor(){return this._barAxisColor}set barAxisColor(t){this._barAxisColor=t}get barPadding(){return this._barPadding}set barPadding(t){this._barPadding=t}get showBarMark(){return this._showBarMark}set showBarMark(t){this._showBarMark=t}get barMarkPositiveColor(){return this._barMarkPositiveColor}set barMarkPositiveColor(t){this._barMarkPositiveColor=t}get barMarkNegativeColor(){return this._barMarkNegativeColor}set barMarkNegativeColor(t){this._barMarkNegativeColor=t}get barMarkWidth(){return this._barMarkWidth}set barMarkWidth(t){this._barMarkWidth=t}get barMarkPosition(){return this._barMarkPosition}set barMarkPosition(t){this._barMarkPosition=t}get barRightToLeft(){return this._barRightToLeft}set barRightToLeft(t){this._barRightToLeft=t}get barMarkInBar(){return this._barMarkInBar}set barMarkInBar(t){this._barMarkInBar=t}clone(){return new rd(this,null)}}class rc extends _{static get DEFAULT(){return u||(u=new rc)}constructor(t={},e={}){super(t,e)}clone(){return new rc(this,null)}}let rp=["type","content","style","color","width","height","marginRight","marginLeft","src","svg","name","path","positionType","tooltip","hover","cursor","shape","interactive","isGif"];class rg{constructor(t){this._table=t;let e=tb.U2();this.expandIcon=e[j.up.expandIconName],this.collapseIcon=e[j.up.collapseIconName]}getIcons(t,e,i,r,n){let s=[],l=this.getHierarchyIcon(t,e);l&&s.push(l);let{icon:a}=this._table.getBodyColumnDefine(t,e);if(a){let n;n="function"==typeof a?a({col:t,row:e,value:i,dataValue:r,table:this._table}):a;let l=tb.U2(),o=t=>{let e;(e="string"==typeof t?l[t]:t)&&s.push(e)};Array.isArray(n)?n.forEach((t,e)=>{o(t)}):o(n)}return n&&s.forEach((i,r)=>{(i.content||i.src)&&(s[r]=this.getCellIconFromRecordValue(i,t,e))}),s}getStyleClass(t){switch(t){case"text":case"link":break;case"image":case"video":return rc;case"chart":case"sparkline":return _;case"progressbar":return rd;case"checkbox":return x;case"radio":return C;case"switch":return w;case"button":return S}return rh}getCellIconFromRecordValue(t,e,i){if(Array.isArray(t))return t.map(t=>this.getCellIconFromRecordValue(t,e,i));if(!P.j6.isObject(t)||"function"==typeof t)return this._table.getFieldData(t,e,i);let r={};return rp.forEach(n=>{var s,l;if(void 0!==t[n]){let a=this._table.getFieldData(t[n],e,i);(0,y.Z)(a)?r[n]=a:(null==(l=(s=this._table)._hasField)?void 0:l.call(s,t[n],e,i))||(r[n]=t[n])}}),r}getHierarchyIcon(t,e){let i=this._table.getHierarchyState(t,e);return i===R.g.expand?this.expandIcon:i===R.g.collapse?this.collapseIcon:void 0}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+(null!=(t=this.expandIcon.marginLeft)?t:0)+(null!=(e=this.expandIcon.marginRight)?e:0)}}var rf=i(53943);let rm={CHANGE_STYLE:"change_style"};class ry extends v.R{static get EVENT_TYPE(){return rm}static get DEFAULT(){return d||(d=new ry)}constructor(t={},e={}){var i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I;super(),this._defaultPadding=[10,16,10,16],this._color=null!=(i=t.color)?i:null==e?void 0:e.color,this._strokeColor=null!=(r=null==t?void 0:t.strokeColor)?r:null==e?void 0:e.strokeColor,this._fontSize=null!=(n=t.fontSize)?n:null==e?void 0:e.fontSize,this._fontFamily=null!=(s=t.fontFamily)?s:null==e?void 0:e.fontFamily,this._fontWeight=null!=(l=t.fontWeight)?l:null==e?void 0:e.fontWeight,this._fontVariant=null!=(a=t.fontVariant)?a:null==e?void 0:e.fontVariant,this._fontStyle=null!=(o=t.fontStyle)?o:null==e?void 0:e.fontStyle,this._textOverflow=(null!=(h=t.textOverflow)?h:null==e?void 0:e.textOverflow)||"ellipsis",this._textStick=null!=(d=null!=(u=t.textStick)?u:null==e?void 0:e.textStick)&&d,this._textStickBaseOnAlign=null!=(p=null!=(c=t.textStickBaseOnAlign)?c:null==e?void 0:e.textStickBaseOnAlign)&&p,this._marked=null!=(f=null!=(g=t.marked)?g:null==e?void 0:e.marked)&&f,this._textAlign=(null!=(m=t.textAlign)?m:null==e?void 0:e.textAlign)||"left",this._textBaseline=(null!=(y=t.textBaseline)?y:null==e?void 0:e.textBaseline)||"middle",this._bgColor=null!=(v=t.bgColor)?v:null==e?void 0:e.bgColor,this._padding=null!=(_=null!=(b=t.padding)?b:null==e?void 0:e.padding)?_:this._defaultPadding,this._borderColor=null!=(x=t.borderColor)?x:null==e?void 0:e.borderColor,this._lineHeight=null!=(C=t.lineHeight)?C:null==e?void 0:e.lineHeight,this._underline=null!=(w=t.underline)?w:null==e?void 0:e.underline,this._underlineColor=null!=(S=t.underlineColor)?S:null==e?void 0:e.underlineColor,this._underlineDash=null!=(A=t.underlineDash)?A:null==e?void 0:e.underlineDash,this._underlineOffset=null!=(M=t.underlineOffset)?M:null==e?void 0:e.underlineOffset,this._lineThrough=null!=(k=t.lineThrough)?k:null==e?void 0:e.lineThrough,this._lineThroughColor=null!=(T=t.lineThroughColor)?T:null==e?void 0:e.lineThroughColor,this._lineThroughDash=null!=(R=t.lineThroughDash)?R:null==e?void 0:e.lineThroughDash,this._linkColor=null!=(B=t.linkColor)?B:null==e?void 0:e.linkColor,this._cursor=null!=(P=t.cursor)?P:null==e?void 0:e.cursor,this._borderLineWidth=null!=(E=t.borderLineWidth)?E:null==e?void 0:e.borderLineWidth,this._borderLineDash=null!=(I=t.borderLineDash)?I:null==e?void 0:e.borderLineDash}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get padding(){var t;return null!=(t=this._padding)?t:this._defaultPadding}set padding(t){this._padding=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get marked(){return this._marked}set marked(t){this._marked=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}clone(){return new ry(this)}}class rv extends ry{static get DEFAULT(){return c||(c=new rv)}constructor(t={},e={}){var i;super(t,e),this.textAlign=(null!=(i=t.textAlign)?i:null==e?void 0:e.textAlign)||"center"}clone(){return new rv(this)}}class rb extends ry{static get DEFAULT(){return p||(p=new rb)}constructor(t={},e=null){var i,r;super(t,e),this._autoWrapText=null!=(i=null==t?void 0:t.autoWrapText)?i:null==e?void 0:e.autoWrapText,this._lineClamp=null!=(r=null==t?void 0:t.lineClamp)?r:null==e?void 0:e.lineClamp}clone(){return new rb(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}class r_ extends ry{static get DEFAULT(){return g||(g=new r_)}constructor(t={},e={},i={}){var r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S;super(t,e),this._size=(null!=(n=null!=(r=null==t?void 0:t.size)?r:null==e?void 0:e.size)?n:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(l=null!=(s=null==t?void 0:t.spaceBetweenTextAndIcon)?s:null==e?void 0:e.spaceBetweenTextAndIcon)?l:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(o=null==(a=null==t?void 0:t.checkboxStyle)?void 0:a.defaultFill)?o:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(u=null==(h=null==t?void 0:t.checkboxStyle)?void 0:h.defaultStroke)?u:null==i?void 0:i.defaultStroke,this._disableFill=null!=(c=null==(d=null==t?void 0:t.checkboxStyle)?void 0:d.disableFill)?c:null==i?void 0:i.disableFill,this._checkedFill=null!=(g=null==(p=null==t?void 0:t.checkboxStyle)?void 0:p.checkedFill)?g:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(m=null==(f=null==t?void 0:t.checkboxStyle)?void 0:f.checkedStroke)?m:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(v=null==(y=null==t?void 0:t.checkboxStyle)?void 0:y.disableCheckedFill)?v:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(_=null==(b=null==t?void 0:t.checkboxStyle)?void 0:b.disableCheckedStroke)?_:null==i?void 0:i.disableCheckedStroke,this._checkIconImage=null!=(C=null==(x=null==t?void 0:t.checkboxStyle)?void 0:x.checkIconImage)?C:null==i?void 0:i.checkIconImage,this._indeterminateIconImage=null!=(S=null==(w=null==t?void 0:t.checkboxStyle)?void 0:w.indeterminateIconImage)?S:null==i?void 0:i.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new r_(t,this)}clone(){return new r_(this)}}class rx{constructor(t){this._table=t;let e=tb.U2();this.freezeIcon=e[j.up.freezeIconName],this.frozenIcon=e[j.up.frozenIconName],this.frozenCurrentIcon=e[j.up.frozenCurrentIconName],this.normalIcon=e[j.up.normalIconName],this.upIcon=e[j.up.upwardIconName],this.downIcon=e[j.up.downwardIconName],this.dropDownAbsoluteIcon=e[j.up.dropdownIconName],this.expandIcon=e[j.up.expandIconName],this.collapseIcon=e[j.up.collapseIconName]}getIcons(t,e){let i=[];if(this._table.isPivotTable()){let{showSort:r,sort:n}=this._table.internalProps.layoutMap.getHeader(t,e);if("function"==typeof r?r({col:t,row:e,table:this._table}):r){let r=this._table.getPivotSortState(t,e);r&&(r=r.toUpperCase());let n="ASC"===r?this.upIcon:"DESC"===r?this.downIcon:this.normalIcon;n&&i.push(n)}else if(n){let r=this.getSortIconForPivotTable(this._table.getPivotSortState(t,e),this._table,t,e);r&&i.push(r)}}else{let r,n=this._table.sortState;r=void 0;let s=this._table.getCellRange(t,e);if(n)if(Array.isArray(n))for(let t=0;t<n.length;t++){let e=n[t],i=this._table._getHeaderCellBySortState(e);if(i&&(0,P._Z)(s,i.col,i.row)){({order:r}=e);break}}else{let t=this._table._getHeaderCellBySortState(n);t&&(0,P._Z)(s,t.col,t.row)&&({order:r}=n)}let l=this.getSortIcon(r,this._table,t,e);l&&i.push(l)}if(this._table.showFrozenIcon&&t<this._table.allowFrozenColCount){let r=this.getFrozenIcon(t,e);r&&i.push(r)}if(this.checkDropDownIcon(this._table,t,e)){let t=this.dropDownAbsoluteIcon;i.push(t)}let r=this.getDropDownStateIcons(this._table,t,e);r.length&&i.push(...r);let{headerIcon:n}=this._table._getHeaderLayoutMap(t,e),s=this.getHierarchyIcon(t,e);if(s&&i.push(s),n){let r;r="function"==typeof n?n({col:t,row:e,value:this._table.getCellValue(t,e),dataValue:this._table.getCellOriginValue(t,e),table:this._table}):n;let s=tb.U2(),l=t=>{let e;(e="string"==typeof t?s[t]:t)&&i.push(e)};Array.isArray(r)?r.forEach((t,e)=>{l(t)}):l(r)}return i}getFrozenIcon(t,e){if(this._table.isPivotTable()||this._table.transpose||this._table.rightFrozenColCount&&t>=this._table.colCount-this._table.rightFrozenColCount)return null;let i=this._table.getHeaderDefine(t,e);if(i.columns&&i.columns.length>0)return null;let r=this.freezeIcon;return this._table.options.frozenColCount-1>t?r=this.frozenIcon:this._table.options.frozenColCount-1===t&&(r=this.frozenCurrentIcon),r}getSortIcon(t,e,i,r){let n,s="asc"===t?this.upIcon:"desc"===t?this.downIcon:this.normalIcon,l=e.getHeaderDefine(i,r);return l&&(n="function"==typeof l.showSort?l.showSort({col:i,row:r,table:this._table}):l.showSort),l&&!1!==n&&((0,y.Z)(n)||l.sort)&&(!l.columns||!(l.columns.length>0))?s:null}getSortIconForPivotTable(t,e,i,r){let n,s=e.getHeaderDefine(i,r);return(s&&(n="function"==typeof s.showSort?s.showSort({col:i,row:r,table:this._table}):s.showSort),s&&!1!==n&&((0,y.Z)(n)||s.sort)&&(!s.columns||!(s.columns.length>0)))?"ASC"===(null==t?void 0:t.toUpperCase())?this.upIcon:"DESC"===(null==t?void 0:t.toUpperCase())?this.downIcon:this.normalIcon:null}getDropDownStateIcons(t,e,i){var r,n,s;let l=t.getHeaderDefine(e,i),{dropDownMenu:a}=t._getHeaderLayoutMap(e,i);"function"==typeof a&&(a=a({row:i,col:e,table:t}));let o=t.globalDropDownMenu;"function"==typeof o&&(o=o({row:i,col:e,table:t}));let h=[];if(Array.isArray(a)&&a.length||Array.isArray(o)&&o.length&&!(null==(r=null==l?void 0:l.columns)?void 0:r.length)){let r=a||o,l=-1,u=-1;for(let a=0;a<r.length;a++){let o=r[a];if("object"==typeof o&&o.children&&o.children.length)for(let r=0;r<o.children.length;r++){let h=o.children[r];if((null==(n=t.stateManager.menu)?void 0:n.dropDownMenuHighlight)&&(0,rf.o)(t,null==(s=t.stateManager.menu)?void 0:s.dropDownMenuHighlight,"object"==typeof h?null==h?void 0:h.menuKey:h,e,i,a)){l=a,u=r;break}}if(t._dropDownMenuIsHighlight(e,i,a)){l=a;break}}if(-1!==l){let t;(t=-1!==u?r[l].children[u]:r[l]).stateIcon&&(t.stateIcon.svg?h.push({type:"svg",name:t.stateIcon.src||t.stateIcon.svg,width:t.stateIcon.width||22,height:t.stateIcon.height||22,svg:t.stateIcon.svg,positionType:j.q0.right,marginRight:0,funcType:j.cI.dropDownState,interactive:!1}):t.stateIcon.src&&h.push({type:"image",name:t.stateIcon.src||t.stateIcon.svg,width:t.stateIcon.width||22,height:t.stateIcon.height||22,src:t.stateIcon.src,positionType:j.q0.right,marginRight:0,funcType:j.cI.dropDownState,interactive:!1}))}}return h}getDropDownIconRect(t,e,i){var r,n,s,l,a,o,h,u;let d,c=null!=(l=null!=(n=null==(r=this.downIcon.hover)?void 0:r.width)?n:null==(s=this.downIcon)?void 0:s.width)?l:0,p=null!=(u=null!=(o=null==(a=this.downIcon.hover)?void 0:a.height)?o:null==(h=this.downIcon)?void 0:h.height)?u:0,g=t.right-2-c;return{left:g,right:t.right-2,top:d="middle"===i?t.top+t.height/2-c/2:"top"===i?t.top+e/2:"bottom"===i?t.bottom-2*e:t.top,bottom:p+d,width:c,height:p}}getHierarchyIcon(t,e){let{hierarchyState:i}=this._table._getHeaderLayoutMap(t,e);if(i){if(i===R.g.expand)return this.expandIcon;if(i===R.g.collapse)return this.collapseIcon}}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+(null!=(t=this.expandIcon.marginLeft)?t:0)+(null!=(e=this.expandIcon.marginRight)?e:0)}checkDropDownIcon(t,e,i){var r;if(t.isPivotTable()){let r=t._getHeaderLayoutMap(e,i).dropDownMenu;if("function"==typeof r&&(r=r({row:i,col:e,table:t})),Array.isArray(r)&&r.length)return!0}else{let n=t.getHeaderDefine(e,i),s=n.dropDownMenu,l=t.globalDropDownMenu;if("function"==typeof l&&(l=l({row:i,col:e,table:t})),Array.isArray(s)&&s.length||(!Array.isArray(n.dropDownMenu)||0!==n.dropDownMenu.length)&&Array.isArray(l)&&l.length&&!(null==(r=null==n?void 0:n.columns)?void 0:r.length))return!0}return!1}getStyleClass(t){switch(t){case"text":case"link":return rb;case"image":case"video":return rv;case"checkbox":return r_}}setTableColumnsEditor(){let t=(e,i)=>{null==e||e.forEach((e,r)=>{e.editor&&(i[r].editor=e.editor),e.columns&&t(e.columns,i[r].columns)})};t(this._table.options.columns,this._table.internalProps.columns)}}var rC=i(47105),rw=i(19465);class rS extends EventTarget{constructor(t,e){if(super(),this._table=t,"node"===k.X.mode)return;let i=document.createElement("div");i.style.opacity="0",i.dataset.vtable="vtable",i.style.pointerEvents="none",i.classList.add("input-container");let r=this._input=document.createElement("input");i.appendChild(r),r.classList.add("table-focus-control"),r.dataset.vtable="vtable",r.readOnly=!0,e.appendChild(i),this._container=i}focus(){this._input.focus({preventScroll:!0})}setFocusRect(t,e){let i=this._input;i.value=e,i.select();let r=t.top-this._table.scrollTop,n=t.left-this._table.scrollLeft;i.style.top=`${r.toFixed()}px`,i.style.left=`${n.toFixed()}px`,i.style.width=`${t.width.toFixed()}px`,i.style.height=`${t.height.toFixed()}px`}get input(){return this._input}release(){var t;null==(t=this._container.parentElement)||t.removeChild(this._container)}}class rA{constructor(t){this.isUpdate=!1,this._keys=[],this._sorted=!1,this.data=new Map,this._keys.length=0,this.cumulativeSum=new Map,this.difference=new Map,this.totalSum=0,this.table=t}get length(){return this.data.size}clear(){this._keys=[],this.data.clear(),this.cumulativeSum.clear(),this.difference.clear(),this.totalSum=0}clearRange(){this.cumulativeSum.clear(),this.difference.clear()}add(t,e){if(!(0,y.Z)(e))return;let i=this.table.getRowHeight(t);this.data.has(t)||(this._keys.push(t),this._sorted=!1),this.data.set(t,e),this.totalSum+=e,this.updateDifference(t,e-i)}remove(t){if(this.data.has(t)){let e=this.data.get(t);this.data.delete(t);let i=this._keys.indexOf(t);-1!==i&&this._keys.splice(i,1),this.totalSum-=e;let r=this.table.getRowHeight(t);this.updateDifference(t,r-e)}}put(t,e){if((0,y.Z)(e))if(this.data.has(t)){let i=this.data.get(t);if(i===e)return;this.data.set(t,e);let r=e-i;this.totalSum+=r,this.updateDifference(t,r)}else this.add(t,e)}get(t){return this.data.get(t)}has(t){return this.data.has(t)}_sort(){let{_keys:t}=this;this._sorted||(t.sort((t,e)=>t<e?-1:+(t>e)),this._sorted=!0)}updateDifference(t,e){var i;let r=null!=(i=this.difference.get(t))?i:0;this.difference.set(t,r+e),this.update()}getSumInRange(t,e){return this.calculatePrefixSum(e)-this.calculatePrefixSum(t-1)}updateCumulativeSum(t,e){for(let[i,r]of this.cumulativeSum)i>=t&&this.cumulativeSum.set(i,r+e)}calculatePrefixSum(t){if(t<0)return 0;if(this.cumulativeSum.has(t)){let e=this.cumulativeSum.get(t);for(let[i,r]of this.difference)i<=t&&(e+=r);return e}return this.dealDiffenence(),this.getCumulativeSum(t)}getCumulativeSum(t){var e,i;let r=0,n=0,s=!1,l=this.table.rowCount>0&&this.table.bottomFrozenRowCount>0?this.table.rowCount-this.table.bottomFrozenRowCount:-1;for(let i=t;i>=0;i--){if(this.cumulativeSum.has(i)){r+=this.cumulativeSum.get(i);break}r+=null!=(e=this.data.get(i))?e:this.table.getRowHeight(i),i>=l&&-1!==l&&(n=r,s=i===l)}if(s&&(null==(i=this.table.containerFit)?void 0:i.height)&&this.table.bottomFrozenRowCount){let t=this.table.tableNoFrameHeight||0;r<t&&(r=t-this.table.getBottomFrozenRowsHeight()+n)}return this.cumulativeSum.set(t,r),r}update(){this.isUpdate||(this.isUpdate=!0,setTimeout(()=>{this.dealDiffenence(),this.isUpdate=!1},0))}dealDiffenence(){for(let[t]of this.cumulativeSum)for(let[e,i]of this.difference)if(t>=e){let e=this.cumulativeSum.get(t);this.cumulativeSum.set(t,e+i)}this.difference.clear()}insert(t,e){for(let e=t;e<=this.getLastIndex();e++)this.cumulativeSum.delete(e);let i=this.getLastIndex()+1;this.adjustOrder(t,t+1,i-t),(0,y.Z)(e)&&this.put(t,e)}getLastIndex(){return this._sort(),this._keys[this._keys.length-1]}delLast(){let t=this.getLastIndex();this.remove(t)}delete(t){if(!this.has(t))return;for(let e=t;e<=this.getLastIndex();e++)this.cumulativeSum.delete(e);let e=this.getLastIndex();this.adjustOrder(t+1,t,e-t),this.delLast()}adjustOrder(t,e,i){this.clearRange(),this._sort();let{_keys:r}=this;if(t>e){let n=[];for(let s=rM(r,t+i-1);s>=0;s--){let l=r[s];if(l>=t)n.push(this.get(l));else if(e<=l&&l<t)this.put(l+i,this.get(l));else if(l<e)break}for(let t=0;t<i;t++)this.put(e+t,n[i-1-t])}let{length:n}=r;if(t<e){let s=[];for(let l=rM(r,t);l<n;l++){let n=r[l];if(n>=t&&n<t+i)s.push(this.get(n));else if(t+i<=n&&n<=e)this.put(n-i,this.get(n));else if(n>e)break}for(let t=0;t<i;t++)this.put(e+t,s[t])}}exchangeOrder(t,e,i,r,n){let{_keys:s}=this;if(this._sorted||(s.sort((t,e)=>t<e?-1:+(t>e)),this._sorted=!0),t>i){let r=[],l=[];for(let n=rM(s,i);n<rM(s,t)+e;n++){let i=s[n];i>=t&&i<t+e?l.push(this.get(i)):r.push(this.get(i))}for(let t=0;t<e;t++)this.put(n+t,l[t]);for(let t=0;t<r.length;t++)this.put(n+e+t,r[t])}else{let l=[],a=[];for(let n=rM(s,t);n<rM(s,i)+r;n++){let i=s[n];i>=t&&i<t+e?a.push(this.get(i)):l.push(this.get(i))}for(let t=0;t<e;t++)this.put(n+t,a[t]);for(let e=0;e<l.length;e++)this.put(t+e,l[e])}}}function rM(t,e){let i=0,r=t.length-1;for(;i<=r;){let n=Math.floor((i+r)/2);if(t[n]===e)return n;t[n]>e?r=n-1:i=n+1}return r<0?0:r}class rk{constructor(t){this._table=t;let e=tb.U2();this.dragReorderIconName=e[j.up.dragReorderIconName]}getIcons(t,e){return[this.dragReorderIconName]}}var rT=i(29322),rR=i(83906);function rB(t,e){var i;return(0,Z.ke)(e,t)||(null!=(i=rI(t,e))?i:{top:-1,row:-1,bottom:-1,height:-1})}function rP(t,e){var i;return(0,Z.sQ)(e,t)||(null!=(i=rE(t,e))?i:{left:-1,col:-1,right:-1,width:1})}function rE(t,e){if(0===t)return{left:0,col:0,right:0,width:0};let i=function(t,e){if(e._colRangeWidthsMap.get("$0$"+(e.colCount-1))){let i=0,r=e.colCount-1;for(;r-i>1;){let n=Math.floor((i+r)/2);if(t<e._colRangeWidthsMap.get(`$0$${n}`))r=n;else{if(!(t>e._colRangeWidthsMap.get(`$0$${n}`)))return n;i=n}}return r}return Math.min(Math.ceil(t/e.internalProps.defaultColWidth),e.colCount-1)}(t,e),r=e.getColsWidth(0,i);return t>=r?((i,r)=>{let n=r-e.getColWidth(i),{colCount:s}=e.internalProps;for(let r=i;r<s;r++){let i=e.getColWidth(r),s=n+i;if(Math.round(n)<=t&&t<Math.round(s))return{left:n,col:r,right:s,width:i};n=s}return null})(i,r):((i,r)=>{let n=r;for(let r=i;r>=0;r--){let i=e.getColWidth(r),s=n-i;if(Math.round(s)<=t&&t<Math.round(n))return{left:s,col:r,right:n,width:i};n=s}return null})(i,r)}function rI(t,e){var i,r,n;let s;if(0===t)return{top:0,row:0,bottom:0,height:0};let l=!0===(null==(i=e.options.customConfig)?void 0:i._disableColumnAndRowSizeRound)?Math.floor:Math.round,a=(r=t,s=(n=e).defaultRowHeight,n._rowRangeHeightsMap.get("$0$"+(n.rowCount-1))&&(s=n._rowRangeHeightsMap.get("$0$"+(n.rowCount-1))/n.rowCount),Math.min(Math.ceil(r/s),n.rowCount-1)),o=e.getRowsHeight(0,a);return t>=o?((i,r)=>{let n=r-e.getRowHeight(i),{rowCount:s}=e.internalProps;for(let r=i;r<s;r++){let i=e.getRowHeight(r),s=n+i;if(l(n)<=l(t)&&l(t)<l(s))return{top:n,row:r,bottom:s,height:i};n=s}return null})(a,o):((i,r)=>{let n=r;for(let r=i;r>=0;r--){let i=e.getRowHeight(r),s=n-i;if(l(s)<=l(t)&&l(t)<l(n))return{top:s,row:r,bottom:n,height:i};n=s}return null})(a,o)}function rL(t,e,i){if(0===t)return{left:0,col:0,right:0,width:0};if(t-=i.tableX,e&&t>i.tableNoFrameWidth-i.getRightFrozenColsWidth()&&t<i.tableNoFrameWidth&&t<=i.getAllColsWidth()){for(let e=0;e<i.rightFrozenColCount;e++)if(t>i.tableNoFrameWidth-i.getColsWidth(i.colCount-e-1,i.colCount-1))return{col:i.colCount-e-1,left:void 0,right:void 0,width:void 0}}return rE(t,i)}function rF(t,e,i){if(0===t)return{top:0,row:0,bottom:0,height:0};if(t-=i.tableY,e&&t>i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()&&t<i.tableNoFrameHeight){for(let e=0;e<i.rightFrozenColCount;e++)if(t>i.tableNoFrameHeight-i.getRowsHeight(i.rowCount-e-1,i.rowCount-1))return{row:i.rowCount-e-1,top:void 0,bottom:void 0,height:void 0}}return rI(t,i)}var rO=i(81774);function rD(t,e,i,r,n,s){var l;return t||e?t instanceof ry?t:"function"==typeof t?rD(t(i),e,i,r,n,s):(t||(t={}),n&&!(0,y.Z)(t.autoWrapText)&&(t.autoWrapText=!0),r===r_?new r_(null!=t?t:{},null!=e?e:{},null!=(l=s.checkboxStyle)?l:{}):new r(null!=t?t:{},null!=e?e:{})):r.DEFAULT}var rH=i(97257);let rz={};var rW=i(43682),rN=i(32190),rj=i(60831),rG=i(88764),rV=i(40398);function rZ(t){return Math.floor(t)===t}class rU extends rW.rd{onUpdate(t,e,i){if(this.from.x!==this.to.x){let i=t?this.to.x:this.from.x+Math.floor((this.to.x-this.from.x)*e);this.params.table.scrollLeft=i}if(this.from.y!==this.to.y){let i=t?this.to.y:this.from.y+Math.floor((this.to.y-this.from.y)*e);this.params.table.scrollTop=i}}}class rK{constructor(t){this.table=t,this.timeline=new rN.L,this.ticker=new rj.H(this.table.scenegraph.stage),this.ticker.addTimeline(this.timeline),this.ticker.setFPS(60),this.tempGraphic=(0,tc.f)({})}scrollTo(t,e){var i,r;let n={x:this.table.scrollLeft,y:this.table.scrollTop},{col:s,row:l}=t,a,o,h=s,u=l;(0,X.Z)(s)&&!rZ(s)&&(h=Math.floor(s),a=s-h),(0,X.Z)(l)&&!rZ(l)&&(u=Math.floor(l),o=l-u);let d=this.table.getCellRect(null!=h?h:0,null!=u?u:0),{left:c,top:p}=d;a&&(c+=a*d.width),o&&(p+=o*d.height);let g={x:(0,X.Z)(s)?c-this.table.getFrozenColsWidth():this.table.scrollLeft,y:(0,X.Z)(l)?p-this.table.getFrozenRowsHeight():this.table.scrollTop},f=(0,rC.Z)(e)?3e3*!!e:null!=(i=null==e?void 0:e.duration)?i:3e3,m=(0,rC.Z)(e)?e?"linear":"":null!=(r=null==e?void 0:e.easing)?r:"linear";new rG.r(rV.R.GenAutoIncrementId(),this.timeline).bind(this.tempGraphic).play(new rU(n,g,f,m,{graphic:this.tempGraphic,table:this.table})),this.ticker.start()}clear(){this.timeline.clear(),this.ticker.stop()}}var r$=i(91254),rY=i(29812);let{toBoxArray:rX}=P.oB,{isTouchEvent:rq}=P.B,rJ=/^\$(\d+)\$(\d+)$/;!function(){if("node"===k.X.mode)return;let t=document.createElement("style");t.id="vtable-style-styleSheet",t.textContent="\n.vtable .input-container {\n	position: absolute;\n	top:0px;\n}\n.vtable .table-scrollable {\n	position: absolute;\n	overflow: scroll;\n}\n.vtable .table-scrollable::-webkit-scrollbar-button{\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-track-piece{\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-corner {\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-thumb {\n	border-radius      : 4px;\n	background-color   : rgba(100, 100, 100, .5);\n}\n\n.vtable .table-scroll-end-point {\n	opacity: 0;\n	position: relative;\n}\n.vtable {\n	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */\n	/* overflow: auto; */\n	position: relative;\n	width: 100%;\n	height: 100%;\n	text-align: left;\n  -webkit-font-smoothing:auto;\n\n  overflow: hidden; // for react-vtable dom custom element\n}\n\n.vtable-gantt {\n	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */\n	/* overflow: auto; */\n	position: absolute;\n	width: 100%;\n	height: 100%;\n	text-align: left;\n  -webkit-font-smoothing:auto;\n\n  overflow: hidden; // for react-vtable dom custom element\n}\n.vtable .table-component-container {\n  pointer-events: none;\n  overflow: hidden;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n}\n.vtable > canvas {\n	position: absolute;\n	width: 0;\n	height: 0;\n}\n.vtable .table-focus-control {\n	position: relative !important;\n	width: 1px;\n	height: 1px;\n	opacity: 0;\n	padding: 0;\n	margin: 0;\n	box-sizing: border-box;\n	pointer-events: none;\n	max-width: 500px;\n	max-height: 500px;\n	float: none !important;\n}\n.vtable input.table-focus-control::-ms-clear {\n	visibility: hidden;\n}\n.vtable input.table-focus-control.composition {\n	opacity: 1;\n	max-width: none;\n	max-height: none;\n}\n",document.head.appendChild(t)}();class rQ extends v.R{static get EVENT_TYPE(){return E.B}constructor(t,e={}){var i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,v,b,_,x,C,w,S,A,M;if(super(),this.showFrozenIcon=!0,this.version="1.22.0",this.id=`VTable${Date.now()}`,this.isReleased=!1,this._chartEventMap={},this.throttleInvalidate=(0,O.E5)(this.render.bind(this),200),"node"===k.X.mode?(e=t,t=null):t instanceof HTMLElement||(e=t,t=t.container?t.container:null),!t&&"node"!==e.mode&&!e.canvas)throw Error("vtable's container is undefined");this.pluginManager=new rY.Q(this,e),this.fireListeners(E.B.BEFORE_INIT,{options:e,container:t}),t=e.container&&e.container instanceof HTMLElement?e.container:t,!1===(null==(i=e.customConfig)?void 0:i.imageAnonymous)&&(W.rF.isImageAnonymous=!1);let{frozenColCount:T=0,unfreezeAllOnExceedsMaxWidth:B,frozenRowCount:P,defaultRowHeight:F=40,defaultHeaderRowHeight:H,defaultColWidth:z=80,defaultHeaderColWidth:N,widthMode:j="standard",heightMode:G="standard",autoFillWidth:U=!1,autoFillHeight:K=!1,containerFit:$={width:!1,height:!1},widthAdaptiveMode:Y="only-body",heightAdaptiveMode:q="only-body",keyboardOptions:J,eventOptions:Q,rowSeriesNumber:te,enableCheckboxCascade:ti,enableHeaderCheckboxCascade:tr,columnResizeMode:tn,rowResizeMode:ts="none",resize:tl,dragHeaderMode:ta,dragOrder:to,showFrozenIcon:th,allowFrozenColCount:tu,padding:td,hover:tc,menu:tp,select:tg,customRender:tf,pixelRatio:tm=i9,renderChartAsync:ty,renderChartAsyncBatchCount:tv,mode:t_,modeParams:tx,canvasWidth:tC,canvasHeight:tw,contentOffsetX:tS,contentOffsetY:tA,overscrollBehavior:tM,limitMinWidth:tk,limitMinHeight:tT,clearDOM:tR=!0}=e,{groupConfig:tB,groupBy:tP,groupTitleFieldFormat:tE,groupTitleCustomLayout:tI,enableTreeStickCell:tL}=e;this.container=t,this.options=e,this._widthMode=j,this._heightMode=G,this._widthAdaptiveMode=Y,this._heightAdaptiveMode=q,this._autoFillWidth=U,this._autoFillHeight=K,void 0!==$&&(this._containerFit="boolean"==typeof $?{width:$,height:$}:$&&"object"==typeof $?{width:null==(r=$.width)||r,height:null==(n=$.height)||n}:{width:!1,height:!1}),this.customRender=tf,this.padding={top:0,right:0,left:0,bottom:0},td&&("number"==typeof td?(this.padding.top=td,this.padding.left=td,this.padding.bottom=td,this.padding.right=td):(td.top&&(this.padding.top=td.top),td.bottom&&(this.padding.bottom=td.bottom),td.left&&(this.padding.left=td.left),td.right&&(this.padding.right=td.right))),((0,y.Z)(tw)||(0,y.Z)(tC))&&(this.canvasSizeSeted=!0),this.tableNoFrameWidth=0,this.tableNoFrameHeight=0,this.contentOffsetX=null!=tS?tS:0,this.contentOffsetY=null!=tA?tA:0,this.canvasWidth=(0,X.Z)(tC)?tC:void 0,this.canvasHeight=(0,X.Z)(tw)?tw:void 0,this.columnWidthComputeMode=null!=(s=e.columnWidthComputeMode)?s:"normal";let tF=this.internalProps={};void 0!==th&&(this.showFrozenIcon=th),"number"==typeof tu&&tu<=0&&(this.showFrozenIcon=!1),this.options.canvas?("node"!==k.X.mode&&(tF.element=this.options.canvas.parentElement,tF.element.style.position="relative"),tF.focusControl=new rS(this,tF.element),tF.canvas=this.options.canvas,tF.context=tF.canvas.getContext("2d")):"node"!==k.X.mode&&(tF.element=(0,Z._I)(this.padding),tF.focusControl=new rS(this,tF.element),tF.canvas=document.createElement("canvas"),tF.element.appendChild(tF.canvas),tF.context=tF.canvas.getContext("2d"),(null==(l=e.customConfig)?void 0:l.createReactContainer)&&function(t){let{internalProps:e}=t;e.bodyDomContainer=document.createElement("div"),e.bodyDomContainer.id="vtable-body-dom-container",e.bodyDomContainer.classList.add("table-component-container"),e.element.appendChild(e.bodyDomContainer),e.headerDomContainer=document.createElement("div"),e.headerDomContainer.id="vtable-header-dom-container",e.headerDomContainer.classList.add("table-component-container"),e.element.appendChild(e.headerDomContainer),e.frozenBodyDomContainer=document.createElement("div"),e.frozenBodyDomContainer.id="vtable-frozen-body-dom-container",e.frozenBodyDomContainer.classList.add("table-component-container"),e.element.appendChild(e.frozenBodyDomContainer),e.frozenHeaderDomContainer=document.createElement("div"),e.frozenHeaderDomContainer.id="vtable-frozen-header-dom-container",e.frozenHeaderDomContainer.classList.add("table-component-container"),e.element.appendChild(e.frozenHeaderDomContainer),e.rightFrozenBodyDomContainer=document.createElement("div"),e.rightFrozenBodyDomContainer.id="vtable-right-frozen-body-dom-container",e.rightFrozenBodyDomContainer.classList.add("table-component-container"),e.element.appendChild(e.rightFrozenBodyDomContainer),e.rightFrozenHeaderDomContainer=document.createElement("div"),e.rightFrozenHeaderDomContainer.id="vtable-right-frozen-header-dom-container",e.rightFrozenHeaderDomContainer.classList.add("table-component-container"),e.element.appendChild(e.rightFrozenHeaderDomContainer),e.frozenBottomDomContainer=document.createElement("div"),e.frozenBottomDomContainer.id="vtable-frozen-bottom-dom-container",e.frozenBottomDomContainer.classList.add("table-component-container"),e.element.appendChild(e.frozenBottomDomContainer),e.bottomDomContainer=document.createElement("div"),e.bottomDomContainer.id="vtable-bottom-dom-container",e.bottomDomContainer.classList.add("table-component-container"),e.element.appendChild(e.bottomDomContainer),e.rightFrozenBottomDomContainer=document.createElement("div"),e.rightFrozenBottomDomContainer.id="vtable-right-frozen-bottom-dom-container",e.rightFrozenBottomDomContainer.classList.add("table-component-container"),e.element.appendChild(e.rightFrozenBottomDomContainer)}(this)),tF.handler=new I.b,(0,X.Z)(this.options.resizeTime)&&(tF.handler.resizeTime=this.options.resizeTime),tF.pixelRatio=tm,tF.frozenColCount=T,tF.frozenRowCount=P,tF.unfreezeAllOnExceedsMaxWidth=null==B||B,tF.defaultRowHeight=F,tF.defaultHeaderRowHeight=null!=H?H:F,tF.defaultColWidth=z,tF.defaultHeaderColWidth=null!=N?N:z,tF.keyboardOptions=J,tF.eventOptions=Q,tF.rowSeriesNumber=te,tF.enableCheckboxCascade=null==(a=null!=ti?ti:null==te?void 0:te.enableTreeCheckbox)||a,tF.enableHeaderCheckboxCascade=ti||null==tr||tr,tF.columnResizeMode=null!=(o=null==tl?void 0:tl.columnResizeMode)?o:tn,tF.rowResizeMode=null!=(h=null==tl?void 0:tl.rowResizeMode)?h:ts,tF.dragHeaderMode=null!=(d=null!=(u=null==to?void 0:to.dragHeaderMode)?u:ta)?d:"none",tF.renderChartAsync=ty,(0,tG.Ry)(tv),tF.overscrollBehavior=null!=tM?tM:"auto",tF.groupBy=null!=(c=null==tB?void 0:tB.groupBy)?c:tP,tF.groupTitleCheckbox=null!=(p=null==tB?void 0:tB.titleCheckbox)?p:!!(null==te?void 0:te.enableTreeCheckbox),tF.groupTitleFieldFormat=null!=(g=null==tB?void 0:tB.titleFieldFormat)?g:tE,tF.groupTitleCustomLayout=null!=(f=null==tB?void 0:tB.titleCustomLayout)?f:tI,tF.enableTreeStickCell=null!=(m=null==tB?void 0:tB.enableTreeStickCell)?m:tL,tF._rowHeightsMap=new rA(this),tF._rowRangeHeightsMap=new Map,tF._colRangeWidthsMap=new Map,tF._widthResizedColMap=new Set,tF._heightResizedRowMap=new Set,this.colWidthsMap=new L.B,this.colContentWidthsMap=new L.B,this.colWidthsLimit={};let tO=this;if(tF.calcWidthContext={_:tF,get full(){var tD,tH;return"node"===k.X.mode?tO.canvasWidth/(null!=tm?tm:1):this._.canvas.width/(null!=(tH=null!=(tD=this._.context.pixelRatio)?tD:tO.internalProps.pixelRatio)?tH:window.devicePixelRatio)}},tF.cellTextOverflows={},tF.focusedTable=!1,tF.theme=D.default.of(null!=(v=e.theme)?v:D.default.DEFAULT),tF.theme.isPivot=this.isPivotTable(),(0,tb.E6)(tF.theme.functionalIconsStyle),t&&(tR&&(t.innerHTML=""),t.appendChild(tF.element)),this._updateSize(),tF.bodyHelper=new rg(this),tF.headerHelper=new rx(this),tF.rowSeriesNumberHelper=new rk(this),tF.autoWrapText=e.autoWrapText,tF.enableLineBreak=e.enableLineBreak,tF.allowFrozenColCount=null!=(b=e.allowFrozenColCount)?b:0,tF.limitMaxAutoWidth=null!=(_=e.limitMaxAutoWidth)?_:450,tF.limitMinWidth=null!=tk?"number"==typeof tk?tk:10*!!tk:10,tF.limitMinHeight=null!=tT?"number"==typeof tT?tT:10*!!tT:10,this.scenegraph=new iP(this),this.stateManager=new iY(this),this.eventManager=new ro(this),this.animationManager=new rK(this),e.legends){tF.legends=[];let t=V.F.getFunction("createLegend");if(Array.isArray(e.legends)){for(let i=0;i<e.legends.length;i++)tF.legends.push(t(e.legends[i],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else tF.legends.push(t(e.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if(tF.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:R.u.bottom},e.tooltip),"html"===tF.tooltip.renderMode){let t=V.F.getComponent("tooltipHandler");t&&(tF.tooltipHandler=new t(this,tF.tooltip.confine))}tF.menu=Object.assign({renderMode:"html"},e.menu),Array.isArray(null==(x=e.menu)?void 0:x.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(C=e.menu)?void 0:C.dropDownMenuHighlight),(Array.isArray(null==(w=e.menu)?void 0:w.defaultHeaderMenuItems)||"function"==typeof(null==(S=e.menu)?void 0:S.defaultHeaderMenuItems))&&(this.globalDropDownMenu=e.menu.defaultHeaderMenuItems),"html"===tF.menu.renderMode&&(tF.menuHandler=new(V.F.getComponent("menuHandler"))(this)),this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyMergeTitleCache=new Map,this.bodyBottomStyleCache=new Map,tF.stick={changedCells:new Map},tF.customMergeCell=(0,r$.k)(e.customMergeCell);let tz=V.F.getComponent("customCellStylePlugin");tz&&(this.customCellStylePlugin=new tz(this,null!=(A=e.customCellStyle)?A:[],null!=(M=e.customCellStyleArrangement)?M:[])),this._adjustCanvasSizeByOption()}_adjustCanvasSizeByOption(){"auto"!==this.options.canvasHeight&&"auto"!==this.options.canvasWidth||setTimeout(()=>{var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w;let S,A;if("auto"===this.options.canvasHeight){let c=0;if(null==(t=this.theme.frameStyle)?void 0:t.innerBorder)c+=null!=(r=rX(null!=(i=null==(e=this.internalProps.theme.frameStyle)?void 0:e.shadowBlur)?i:[0])[1])?r:0;else if(this.theme.frameStyle){let t=rX(null!=(s=null==(n=this.internalProps.theme.frameStyle)?void 0:n.borderLineWidth)?s:[null]),e=rX(null!=(a=null==(l=this.internalProps.theme.frameStyle)?void 0:l.shadowBlur)?a:[0]);c+=(null!=(o=t[0])?o:0)+(null!=(h=e[0])?h:0)+((null!=(u=t[2])?u:0)+(null!=(d=e[2])?d:0))}A=Math.min(this.options.maxCanvasHeight?this.options.maxCanvasHeight-c:2e4,this.getAllRowsHeight())+c}else A=this.canvasHeight;if("auto"===this.options.canvasWidth){let t=0;if(null==(c=this.theme.frameStyle)?void 0:c.innerBorder)t+=null!=(f=rX(null!=(g=null==(p=this.internalProps.theme.frameStyle)?void 0:p.shadowBlur)?g:[0])[2])?f:0;else if(this.theme.frameStyle){let e=rX(null!=(y=null==(m=this.internalProps.theme.frameStyle)?void 0:m.borderLineWidth)?y:[null]),i=rX(null!=(b=null==(v=this.internalProps.theme.frameStyle)?void 0:v.shadowBlur)?b:[0]);t+=(null!=(_=e[1])?_:0)+(null!=(x=i[1])?x:0)+((null!=(C=e[3])?C:0)+(null!=(w=i[3])?w:0))}S=Math.min(this.options.maxCanvasWidth?this.options.maxCanvasWidth-t:2e4,this.getAllColsWidth())+t}else S=this.canvasWidth;this.setCanvasSize(S,A)},0)}getContainer(){return this.container}getElement(){return this.internalProps.element}get canvas(){return this.internalProps.canvas}setCanvasSize(t,e){this.canvasWidth=t,this.canvasHeight=e,this.options.canvasHeight=e,this.options.canvasWidth=t,this.resize()}setContentInsetXY(t,e){this.contentOffsetX=t,this.contentOffsetY=e,this.options.contentOffsetX=t,this.options.contentOffsetY=e,this.resize()}resize(){var t;this._updateSize(),null==(t=this.internalProps.legends)||t.forEach(t=>{null==t||t.resize()}),this.internalProps.title&&this.internalProps.title.resize(),this.internalProps.emptyTip&&this.internalProps.emptyTip.resize(),this.scenegraph.resize()}get rowCount(){return this.internalProps.rowCount}set rowCount(t){this.internalProps.rowCount=t}get colCount(){var t;return null!=(t=this.internalProps.colCount)?t:0}set colCount(t){this.internalProps.colCount=t}get frozenColCount(){var t,e,i,r,n;return null!=(n=null!=(i=null==(e=null==(t=this.internalProps)?void 0:t.layoutMap)?void 0:e.frozenColCount)?i:null==(r=this.internalProps)?void 0:r.frozenColCount)?n:0}set frozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;let e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{let e=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=e}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;let e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{let e=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=e}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}_setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t}_resetFrozenColCount(){this.options.frozenColCount&&(this.tableNoFrameWidth-this.getColsWidth(0,this.options.frozenColCount-1)<=120?this._setFrozenColCount(0):this.frozenColCount!==this.options.frozenColCount&&this._setFrozenColCount(this.options.frozenColCount))}get frozenRowCount(){var t,e,i,r,n;return null!=(n=null!=(i=null==(e=null==(t=this.internalProps)?void 0:t.layoutMap)?void 0:e.frozenRowCount)?i:null==(r=this.internalProps)?void 0:r.frozenRowCount)?n:0}set frozenRowCount(t){this.internalProps.frozenRowCount=t,this.options.frozenRowCount=t,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}_setFrozenRowCount(t){this.internalProps.frozenRowCount=t,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}get rightFrozenColCount(){var t,e,i,r,n;return null!=(n=null!=(i=null==(e=null==(t=this.internalProps)?void 0:t.layoutMap)?void 0:e.rightFrozenColCount)?i:null==(r=this.internalProps)?void 0:r.rightFrozenColCount)?n:0}set rightFrozenColCount(t){this.scenegraph.dealWidthRightFrozen(t)}get bottomFrozenRowCount(){var t,e,i,r,n;return null!=(n=null!=(i=null==(e=null==(t=this.internalProps)?void 0:t.layoutMap)?void 0:e.bottomFrozenRowCount)?i:null==(r=this.internalProps)?void 0:r.bottomFrozenRowCount)?n:0}set bottomFrozenRowCount(t){this.scenegraph.dealWidthBottomFrozen(t)}get defaultRowHeight(){return(0,X.Z)(this.internalProps.defaultRowHeight)?this.internalProps.defaultRowHeight:40}set defaultRowHeight(t){this.internalProps.defaultRowHeight=t,this.options.defaultRowHeight=t}get defaultHeaderRowHeight(){return this.internalProps.defaultHeaderRowHeight}set defaultHeaderRowHeight(t){this.internalProps.defaultHeaderRowHeight=t,this.options.defaultHeaderRowHeight=t}get defaultColWidth(){return this.internalProps.defaultColWidth}set defaultColWidth(t){this.internalProps.defaultColWidth=t,this.options.defaultColWidth=t}get defaultHeaderColWidth(){return this.internalProps.defaultHeaderColWidth}set defaultHeaderColWidth(t){this.internalProps.defaultHeaderColWidth=t,this.options.defaultHeaderColWidth=t}get colWidthsMap(){return this.internalProps._colWidthsMap}set colWidthsMap(t){this.internalProps._colWidthsMap=t}get colContentWidthsMap(){return this.internalProps._colContentWidthsMap}set colContentWidthsMap(t){this.internalProps._colContentWidthsMap=t}get _colRangeWidthsMap(){return this.internalProps._colRangeWidthsMap}set _colRangeWidthsMap(t){this.internalProps._colRangeWidthsMap=t}get _rowRangeHeightsMap(){return this.internalProps._rowRangeHeightsMap}set _rowRangeHeightsMap(t){this.internalProps._rowRangeHeightsMap=t}get rowHeightsMap(){return this.internalProps._rowHeightsMap}set rowHeightsMap(t){this.internalProps._rowHeightsMap=t}get colWidthsLimit(){return this.internalProps._colWidthsLimit}set colWidthsLimit(t){this.internalProps._colWidthsLimit=t}get keyboardOptions(){var t;return null!=(t=this.internalProps.keyboardOptions)?t:null}set keyboardOptions(t){this.internalProps.keyboardOptions=null!=t?t:void 0}get eventOptions(){var t;return null!=(t=this.internalProps.eventOptions)?t:null}set eventOptions(t){this.internalProps.eventOptions=null!=t?t:void 0}get widthMode(){return this._widthMode}set widthMode(t){t!==this._widthMode&&(this._widthMode=t,this.options.widthMode=t)}get heightMode(){return this._heightMode}set heightMode(t){t!==this._heightMode&&(this._heightMode=t,this.options.heightMode=t)}get autoFillWidth(){return this._autoFillWidth}set autoFillWidth(t){t!==this._autoFillWidth&&(this._autoFillWidth=t)}get autoFillHeight(){return this._autoFillHeight}set autoFillHeight(t){t!==this._autoFillHeight&&(this._autoFillHeight=t)}get widthAdaptiveMode(){return this._widthAdaptiveMode}set widthAdaptiveMode(t){t!==this._widthAdaptiveMode&&(this._widthAdaptiveMode=t)}get heightAdaptiveMode(){return this._heightAdaptiveMode}set heightAdaptiveMode(t){t!==this._heightAdaptiveMode&&(this._heightAdaptiveMode=t)}_colWidthDefineToPxWidth(t){return"auto"===t?0:(0,Z.qf)(this,t)}_getMaxFrozenWidth(){var t;let e=null!=(t=this.options.maxFrozenWidth)?t:"80%";return(0,Z.qf)(this,e)}_getComputedFrozenColCount(t){let e=this._getMaxFrozenWidth(),i=t;for(;this.getColsWidth(0,i-1)>e&&!(--i<=0););return i}_getColWidthLimits(t){let e=this.colWidthsLimit[t];if(!e)return null;let i={};return e.min&&(i.min=(0,Z.qf)(this,e.min),i.minDef=e.min),e.max&&(i.max=(0,Z.qf)(this,e.max),i.maxDef=e.max),i}_adjustColWidth(t,e){let i=this._getColWidthLimits(t);return Math.max((0,Z.AS)(i,e),0)}get pixelRatio(){return this.internalProps.pixelRatio}setPixelRatio(t){var e;if(t!==(null==(e=this.internalProps)?void 0:e.pixelRatio)){this.internalProps.pixelRatio=t;let e=this,n=this.canvasWidth;this.internalProps.calcWidthContext={_:this.internalProps,get full(){var i,r;return"node"===k.X.mode?n/(null!=t?t:1):this._.canvas.width/(null!=(r=null!=(i=this._.context.pixelRatio)?i:e.internalProps.pixelRatio)?r:window.devicePixelRatio)}},this.scenegraph.setPixelRatio(t)}}_updateSize(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,v,b,_,x,C,w,S,A,M,R,B,P,E;let{padding:I}=this,L=0,F=0;if(this.tableX=this.contentOffsetX,this.tableY=this.contentOffsetY,this.options.canvas&&this.options.viewBox)L=this.options.viewBox.x2-this.options.viewBox.x1,F=this.options.viewBox.y2-this.options.viewBox.y1,(null==(t=null==this?void 0:this.scenegraph)?void 0:t.stage)&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(L,F));else if("browser"===k.X.mode){let t=this.getElement(),u=0,d=0,c=(0,y.Z)(this.canvasWidth),p=(0,y.Z)(this.canvasHeight);if(this.canvasSizeSeted&&(c&&(u=this.canvasWidth),p&&(d=this.canvasHeight)),(!c||!p)&&t.parentElement){let e=t.parentElement.style||window.getComputedStyle(t.parentElement);c||(u=t.parentElement.offsetWidth-(parseInt(e.paddingLeft,10)||0)-(parseInt(e.paddingRight,10)||0)),p||(d=t.parentElement.offsetHeight-parseInt(e.paddingTop||"0px",10)-parseInt(e.paddingBottom||"0px",20)),u=(null!=u?u:1)-!!this.options.tableSizeAntiJitter,d=(null!=d?d:1)-!!this.options.tableSizeAntiJitter}t.style.width=u&&u-I.left-I.right+"px"||"0px",t.style.height=d&&d-I.top-I.bottom+"px"||"0px";let{canvas:g}=this.internalProps;L=(null!=(i=null==(e=g.parentElement)?void 0:e.offsetWidth)?i:1)-!!this.options.tableSizeAntiJitter,F=(null!=(n=null==(r=g.parentElement)?void 0:r.offsetHeight)?n:1)-!!this.options.tableSizeAntiJitter,(null==(s=null==this?void 0:this.scenegraph)?void 0:s.stage)?(null==(l=this.options)?void 0:l.viewBox)&&!(null==(a=this.options)?void 0:a.canvas)&&this.scenegraph.stage.resize(L,F):(g.style.width="",g.style.height="",g.width=L,g.height=F,g.style.width=`${L}px`,g.style.height=`${F}px`),(null==(o=this.options)?void 0:o.viewBox)&&(L=this.options.viewBox.x2-this.options.viewBox.x1,F=this.options.viewBox.y2-this.options.viewBox.y1),(null==(h=null==this?void 0:this.scenegraph)?void 0:h.stage)&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(L,F))}else"node"===k.X.mode&&(L=this.canvasWidth-1,F=this.canvasHeight-1);let O=this.getTheme().scrollStyle,D=0,H=0;D=this.shouldVScrollBarWidthShow(L,F,O)?T.Iv(O):0,H=this.shouldHScrollBarWidthShow(L,F,O)?T.vP(O):0;let z=Math.floor(L-D),W=Math.floor(F-H);if(null==(u=this.internalProps.theme)?void 0:u.frameStyle){let t=rX(null!=(c=null==(d=this.internalProps.theme.frameStyle)?void 0:d.borderLineWidth)?c:[null]),e=rX(null!=(g=null==(p=this.internalProps.theme.frameStyle)?void 0:p.shadowBlur)?g:[0]);if(null==(f=this.theme.frameStyle)?void 0:f.innerBorder)this.tableX+=this.contentOffsetX,this.tableY+=this.contentOffsetY,this.tableNoFrameWidth=z-(null!=(m=e[1])?m:0)-this.contentOffsetX,this.tableNoFrameHeight=W-(null!=(v=e[2])?v:0)-this.contentOffsetY;else{this.tableX+=(null!=(b=t[3])?b:0)+(null!=(_=e[3])?_:0),this.tableY+=(null!=(x=t[0])?x:0)+(null!=(C=e[0])?C:0);let i=(null!=(w=t[1])?w:0)+(null!=(S=e[1])?S:0);this.tableNoFrameWidth=z-(i>D?i-D:0)-((null!=(A=t[3])?A:0)+(null!=(M=e[3])?M:0))-this.contentOffsetX;let r=(null!=(R=t[2])?R:0)+(null!=(B=e[2])?B:0);this.tableNoFrameHeight=W-(r>H?r-H:0)-((null!=(P=t[0])?P:0)+(null!=(E=e[0])?E:0))-this.contentOffsetY}}this._clearColRangeWidthsMap(),this._clearRowRangeHeightsMap()}shouldVScrollBarWidthShow(t,e,i){if(i.hoverOn||"none"===i.visible)return!1;let r=this.getAllRowsHeight(),n=i.visible?T.vP(i):0;if(r>e-n&&r<=e){let e=this.getAllColsWidth(),r=i.visible?T.Iv(i):0;if(e>t-r&&e<=t)return!1;if(e>t)return!0;if(e<=t-r)return!1}return!(r<=e-n)}shouldHScrollBarWidthShow(t,e,i){if(i.hoverOn||"none"===i.visible)return!1;let r=this.getAllColsWidth(),n=i.visible?T.Iv(i):0;if(r>t-n&&r<=t){let t=this.getAllRowsHeight(),r=i.visible?T.vP(i):0;if(t>e-r&&t<=e)return!1;if(t>e)return!0;if(t<=e-r)return!1}return!(r<=t-n)}updateViewBox(t){var e,i,r,n,s,l,a,o,h,u,d,c;let p=(null!=(r=null==(i=null==(e=this.options)?void 0:e.viewBox)?void 0:i.x2)?r:0)-(null!=(l=null==(s=null==(n=this.options)?void 0:n.viewBox)?void 0:s.x1)?l:0),g=(null!=(h=null==(o=null==(a=this.options)?void 0:a.viewBox)?void 0:o.y2)?h:0)-(null!=(c=null==(d=null==(u=this.options)?void 0:u.viewBox)?void 0:d.y1)?c:0),f=t.x2-t.x1,m=t.y2-t.y1;this.options.viewBox=t,p!==f||g!==m?this.resize():this.scenegraph.stage.setViewBox(this.options.viewBox,!0)}setViewBoxTransform(t,e,i,r,n,s){this.internalProps.modifiedViewBoxTransform=!0,this.scenegraph.stage.window.setViewBoxTransform(t,e,i,r,n,s)}get rowHierarchyType(){return this.dataSource.rowHierarchyType}getColsWidth(t,e){var i;if(t>e)return 0;t=Math.max(t,0),e=Math.min(e,(null!=(i=this.colCount)?i:1/0)-1);let r=this._colRangeWidthsMap.get(`$${t}$${e}`);if(null!=r)return r;let n=this._colRangeWidthsMap.get(`$${t}$${e-1}`);if(null!=n){let i=n+this.getColWidth(e);return this.rightFrozenColCount>0&&e===this.colCount-this.rightFrozenColCount&&(i=this._getRangeSizeForContainerFit(t,e,i,"col")),t>=0&&e>=0&&!Number.isNaN(i)&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(i)),Math.round(i)}let s=0;for(let i=t;i<=e;i++)s+=this.getColWidth(i);return s=this._getRangeSizeForContainerFit(t,e,s,"col"),t>=0&&e>=0&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(s)),Math.round(s)}getRowHeight(t){var e;if((0,y.Z)(this.rowHeightsMap.get(t))){if(null==(e=this.options.customConfig)?void 0:e._disableColumnAndRowSizeRound){let e,i=this.rowHeightsMap.get(t);return Number.isInteger(Number((t<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,t):t>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(t,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,t)).toFixed(2)))?Math.ceil(i):Math.floor(i)}return this.rowHeightsMap.get(t)}let i=this.getDefaultRowHeight(t);return(0,X.Z)(i)?i:this.defaultRowHeight}getDefaultColumnWidth(t){var e,i;return this.isRowHeader(t,0)||this.isCornerHeader(t,0)?Array.isArray(this.defaultHeaderColWidth)?null!=(e=this.defaultHeaderColWidth[t])?e:this.defaultColWidth:this.defaultHeaderColWidth:this.isRightFrozenColumn(t,this.columnHeaderLevelCount)&&this.isPivotTable()?Array.isArray(this.defaultHeaderColWidth)?null!=(i=this.defaultHeaderColWidth[this.rowHeaderLevelCount-this.rightFrozenColCount])?i:this.defaultColWidth:this.defaultHeaderColWidth:this.defaultColWidth}getDefaultRowHeight(t){var e,i;return this.isColumnHeader(0,t)||this.isCornerHeader(0,t)||this.isSeriesNumberInHeader(0,t)?Array.isArray(this.defaultHeaderRowHeight)?null!=(e=this.defaultHeaderRowHeight[t])?e:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.isBottomFrozenRow(t)?Array.isArray(this.defaultHeaderRowHeight)?null!=(i=this.defaultHeaderRowHeight[this.columnHeaderLevelCount>0?this.columnHeaderLevelCount-this.bottomFrozenRowCount:0])?i:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.internalProps.defaultRowHeight}_setRowHeight(t,e,i){var r;this.rowHeightsMap.put(t,(null==(r=this.options.customConfig)?void 0:r._disableColumnAndRowSizeRound)?e:Math.round(e)),i&&this._clearRowRangeHeightsMap(t)}setRowHeight(t,e){this.scenegraph.setRowHeight(t,e),this.scenegraph.updateChartSizeForResizeRowHeight(t),this.internalProps._heightResizedRowMap.add(t)}getRowsHeight(t,e){var i,r;if(t>e||0===this.rowCount)return 0;t=Math.max(t,0),e=Math.min(e,(null!=(i=this.rowCount)?i:1/0)-1);let n=0,s="auto"===this.options.defaultRowHeight;if("standard"!==this.heightMode||this.options.customComputeRowHeight||this.autoFillHeight||!this.internalProps.layoutMap||this.hasAutoImageColumn()||s||0!==this.internalProps._heightResizedRowMap.size){if(null==(r=this.options.customConfig)?void 0:r._disableColumnAndRowSizeRound){let i,r=this.rowHeightsMap.getSumInRange(t,e);return Number.isInteger(Number((e<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,e):e>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(e,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,e)).toFixed(2)))?Math.ceil(r):Math.floor(r)}n=this.rowHeightsMap.getSumInRange(t,e)}else{let i=this.rowCount-this.bottomFrozenRowCount;for(let i=t;i<Math.min(e+1,this.columnHeaderLevelCount);i++)n+=this.getRowHeight(i);e>=this.columnHeaderLevelCount&&(n+=this.defaultRowHeight*(Math.min(e,i-1)-Math.max(this.columnHeaderLevelCount,t)+1));let r=0;for(let t=i;t<e+1;t++)r+=this.getRowHeight(t);n=this._getRangeSizeForContainerFit(t,e,n+r,"row")}return Math.round(n)}_getRangeSizeForContainerFit(t,e,i,r="col"){var n;if(!isFinite(t)||!isFinite(e))return i;let s="col"===r?{totalCount:"colCount",frozenCount:"rightFrozenColCount",fitType:"width",tableSize:"tableNoFrameWidth",getSize:"getColWidth"}:{totalCount:"rowCount",frozenCount:"bottomFrozenRowCount",fitType:"height",tableSize:"tableNoFrameHeight",getSize:"getRowHeight"},l=this[s.tableSize];if(i>=l)return i;let a=this[s.totalCount]-this[s.frozenCount];if(!isFinite(this[s.totalCount])||this[s.frozenCount]<=0||a<0||t>a||e<a||t===e||!(null==(n=this.containerFit)?void 0:n[s.fitType]))return i;let o=this[s.totalCount]-1,h=l;if(t>0){for(let e=0;e<t;e++)if((h-=this[s.getSize](e))<=0)return i}if(e!==o){for(let t=e+1;t<=o;t++)if((h-=this[s.getSize](t))<=0)return i}return h}getColWidthDefined(t){var e;let{layoutMap:i}=this.internalProps;if("autoWidth"===this.widthMode)return"auto";let{width:r}=null!=(e=null==i?void 0:i.getColumnWidthDefined(t))?e:{};return"number"==typeof r&&r<=0?0:r||this.getDefaultColumnWidth(t)}getColWidthDefinedNumber(t){let e=this.getColWidthDefined(t);return this._adjustColWidth(t,this._colWidthDefineToPxWidth(e))}isAutoRowHeight(t){return"autoHeight"===this.heightMode||!!this.options.customComputeRowHeight||(t>=0&&t<this.columnHeaderLevelCount?"auto"===this.getDefaultRowHeight(t):"auto"===this.internalProps.defaultRowHeight)}getColWidth(t){var e;let i=null!=(e=this.colWidthsMap.get(t))?e:this.getDefaultColumnWidth(t);return"adaptive"===this.widthMode&&"number"==typeof i||this.transpose&&"number"==typeof i?this._colWidthDefineToPxWidth(i):this._adjustColWidth(t,this._colWidthDefineToPxWidth(i))}_setColWidth(t,e,i,r){this.colWidthsMap.put(t,"number"==typeof e?Math.round(e):e),i&&this._clearColRangeWidthsMap(t),r||this.stateManager.checkFrozen()}setColWidth(t,e){this.scenegraph.setColWidth(t,e),this.scenegraph.updateChartSizeForResizeColWidth(t),this.internalProps._widthResizedColMap.add(t)}_clearColRangeWidthsMap(t){if("number"!=typeof t)this._colRangeWidthsMap.clear();else for(let e of this._colRangeWidthsMap.keys()){let i=rJ.exec(e);if(i){let r=Number(i[1]),n=Number(i[2]);t>=r&&t<=n&&this._colRangeWidthsMap.delete(e)}}}_clearRowRangeHeightsMap(t){this.rowHeightsMap.clearRange()}_getColContentWidth(t){return Number(this.colContentWidthsMap.get(t))}_setColContentWidth(t,e){this.colContentWidthsMap.put(t,e)}getAllRowsHeight(){return this.internalProps.rowCount<=0?0:this.getRowsHeight(0,this.internalProps.rowCount-1)}getAllColsWidth(){return this.internalProps.colCount<=0?0:this.getColsWidth(0,this.internalProps.colCount-1)}getColsWidths(){let t=this.colCount,e=[];for(let i=0;i<t;i++)e.push(this.getColWidth(i));return e}getMaxColWidth(t){var e;let i=this.colWidthsLimit[t],r=null!=(e=i&&i.max)?e:1/0;return"string"==typeof r&&(r=(0,Z.qf)(this,r)),r}setMaxColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).max=e}getMinColWidth(t){var e;let i=this.colWidthsLimit[t],r=null!=(e=i&&i.min)?e:0;return"string"==typeof r&&(r=(0,Z.qf)(this,r)),r}setMinColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).min=e}getCellRect(t,e){var i,r;let n,s,l=this.isFrozenCell(t,e),a=this.getColWidth(t);n=l&&l.col&&this.isRightFrozenColumn(t,e)?this.getAllColsWidth()<=this.tableNoFrameWidth?this.getColsWidth(0,t-1)||0:this.tableNoFrameWidth-(null!=(i=this.getColsWidth(t,this.colCount-1))?i:0):this.getColsWidth(0,t-1)||0;let o=this.getRowHeight(e);return s=l&&l.row&&this.isBottomFrozenRow(t,e)?this.getAllRowsHeight()<=this.tableNoFrameHeight?this.getRowsHeight(0,e-1):this.tableNoFrameHeight-(null!=(r=this.getRowsHeight(e,this.rowCount-1))?r:0):this.getRowsHeight(0,e-1),new F.U(Math.round(n),Math.round(s),Math.round(a),Math.round(o))}getMergeCellRect(t,e){let i=this.getCellRange(t,e),r=this.getColsWidth(0,i.start.col-1)||0,n=this.getColsWidth(i.start.col,i.end.col),s=this.getRowsHeight(0,i.start.row-1)||0,l=this.getRowsHeight(i.start.row,i.end.row);return new F.U(Math.round(r),Math.round(s),Math.round(n),Math.round(l))}getCellRelativeRect(t,e){let i=this.isFrozenCell(t,e),r=!0,n=!0;(null==i?void 0:i.col)&&(null==i?void 0:i.row)?(r=!1,n=!1):(null==i?void 0:i.col)?r=!1:(null==i?void 0:i.row)&&(n=!1);let s=this.getCellRect(t,e);return this._toRelativeRect(s,r,n)}getCellRangeRelativeRect(t){if(t.start){let e=this.isFrozenCell(t.start.col,t.start.row),i=!0,r=!0;return(null==e?void 0:e.col)&&(null==e?void 0:e.row)?(i=!1,r=!1):(null==e?void 0:e.col)?i=!1:(null==e?void 0:e.row)&&(r=!1),this._toRelativeRect(this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row),i,r)}let e=this.getCellRange(t.col,t.row),i=this.isFrozenCell(t.col,t.row),r=!0,n=!0;return(null==i?void 0:i.col)&&(null==i?void 0:i.row)?(r=!1,n=!1):(null==i?void 0:i.col)?r=!1:(null==i?void 0:i.row)&&(n=!1),this._toRelativeRect(this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row),r,n)}getVisibleCellRangeRelativeRect(t){let e;return e=t.start?t:this.getCellRange(t.col,t.row),this._getVisiableRect(this.getCellRangeRelativeRect(t),e)}_getVisiableRect(t,e){let i=e.start.col>=this.frozenColCount?Math.max(t.left,this.frozenColCount>=1?this.getColsWidth(0,this.frozenColCount-1):0):t.left,r=Math.min(t.right,this.tableNoFrameWidth),n=t.copy();n.left=i,n.right=r;let s=e.start.row>=this.frozenRowCount?Math.max(t.top,this.frozenRowCount>=1?this.getRowsHeight(0,this.frozenRowCount-1):0):t.top,l=Math.min(t.bottom,this.tableNoFrameHeight);return n.top=s,n.bottom=l,n}getCellsRect(t,e,i,r){var n,s,l,a,o,h;let u=this.getColsWidth(0,t-1)||0,d=this.getColsWidth(t,i),c=this.scrollLeft,p=Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),g=Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());this.isLeftFrozenColumn(t)&&this.isRightFrozenColumn(i)?d=this.tableNoFrameWidth-(null!=(n=this.getColsWidth(t+1,this.colCount-1))?n:0)-u:this.isLeftFrozenColumn(t)&&!this.isLeftFrozenColumn(i)?d=Math.max(d-c,this.getColsWidth(t,this.frozenColCount-1)):!this.isRightFrozenColumn(t)&&this.isRightFrozenColumn(i)?(u=Math.min(u-c,p-this.getRightFrozenColsWidth()),d=p-(null!=(s=this.getColsWidth(t+1,this.colCount-1))?s:0)-u):this.isRightFrozenColumn(t)&&(u=p-(null!=(l=this.getColsWidth(t,this.colCount-1))?l:0));let f=this.getRowsHeight(0,e-1),m=this.getRowsHeight(e,r),y=this.scrollTop;return this.isTopFrozenRow(e)&&this.isBottomFrozenRow(r)?m=this.tableNoFrameHeight-(null!=(a=this.getRowsHeight(e+1,this.rowCount-1))?a:0)-f:this.isTopFrozenRow(e)&&!this.isTopFrozenRow(r)?m=Math.max(m-y,this.getRowsHeight(e,this.frozenRowCount-1)):!this.isBottomFrozenRow(e)&&this.isBottomFrozenRow(r)?(f=Math.min(f-y,g-this.getBottomFrozenRowsHeight()),m=g-(null!=(o=this.getRowsHeight(e+1,this.rowCount-1))?o:0)-f):this.isBottomFrozenRow(e)&&(f=g-(null!=(h=this.getRowsHeight(e,this.rowCount-1))?h:0)),new F.U(Math.round(u),Math.round(f),Math.round(d),Math.round(m))}getCellsRectWidth(t,e,i,r){let n=this.isFrozenCell(t,e),s=this.isFrozenCell(i,r),l=this.getColsWidth(t,i);if(n&&n.col){let e=this.scrollLeft;s&&s.col||(l-=e,l=Math.max(l,this.getColsWidth(t,this.frozenColCount-1)))}return l}getCellRangeRect(t){if(t.start)return this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row);let e=this.getCellRange(t.col,t.row);return this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row)}getCellRangeRectWidth(t){if(t.start)return this.getCellsRectWidth(t.start.col,t.start.row,t.end.col,t.end.row);let e=this.getCellRange(t.col,t.row);return this.getCellsRectWidth(e.start.col,e.start.row,e.end.col,e.end.row)}isFrozenCell(t,e){let i=this.isFrozenRow(e),r=this.isFrozenColumn(t);return i||r?{row:i,col:r}:null}getRowAt(t){return rB(t,this)}getColAt(t){return rP(t,this)}getCellAt(t,e){let{row:i,top:r,bottom:n,height:s}=rB(e,this),{col:l,left:a,right:o,width:h}=rP(t,this);return{row:i,col:l,rect:{left:a,right:o,top:r,bottom:n,width:h,height:s}}}getCellAtRelativePosition(t,e){return function(t,e,i){t-=i.tableX;let r=!1;(e-=i.tableY)>0&&e<i.getFrozenRowsHeight()&&(r=!0);let n=!1;t>0&&t<i.getFrozenColsWidth()&&(n=!0);let s=!1;e>i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()&&e<i.tableNoFrameHeight&&e<=i.getAllRowsHeight()&&(s=!0);let l=!1;t>i.tableNoFrameWidth-i.getRightFrozenColsWidth()&&t<i.tableNoFrameWidth&&t<=i.getAllColsWidth()&&(l=!0);let a=rL((n||l?t:t+i.scrollLeft)+i.tableX,l,i),o=rF((r||s?e:e+i.scrollTop)+i.tableY,s,i);if(a&&o){let{row:t,top:e,bottom:i,height:r}=o,{col:n,left:s,right:l,width:h}=a;return{row:t,col:n,rect:{left:s,right:l,top:e,bottom:i,width:h,height:r}}}return{col:-1,row:-1}}(t,e,this)}_checkRowCol(t,e){return t>=0&&t<this.colCount&&e>=0&&e<this.rowCount}_makeVisibleCell(t,e){if(this._checkRowCol(t,e)){let i=this.isFrozenCell(t,e);if(i&&i.col&&i.row)return;let r=this.getCellRect(t,e),n=(0,Z.VN)(this);!n.contains(r)&&(i&&i.col||this.getColsWidth(0,this.frozenColCount-1)+r.width>this.canvas.width||(r.left<n.left?this.scrollLeft-=n.left-r.left:n.right<r.right&&(this.scrollLeft-=n.right-r.right)),i&&i.row||this.getRowsHeight(0,this.frozenRowCount-1)+r.height>this.canvas.height||(r.top<n.top?this.scrollTop-=n.top-r.top:n.bottom<r.bottom&&(this.scrollTop-=n.bottom-r.bottom)))}}render(){this.scenegraph.renderSceneGraph()}renderAsync(){return this.scenegraph.updateNextFrame(),new Promise((t,e)=>{setTimeout(()=>{t()},0)})}_toRelativeRect(t,e=!0,i=!0){var r,n,s,l;let a=t.copy(),o=this.getVisibleRect();return a.offsetLeft(this.tableX-(e?o.left:0)),a.offsetTop(this.tableY-(i?o.top:0)),a.offsetLeft(null!=(n=null==(r=this.options.viewBox)?void 0:r.x1)?n:0),a.offsetTop(null!=(l=null==(s=this.options.viewBox)?void 0:s.y1)?l:0),a}getVisibleRect(){let{scrollTop:t,scrollLeft:e}=this,i=this.tableNoFrameWidth,r=this.tableNoFrameHeight;return new F.U(e,t,i,r)}get visibleRowCount(){let{frozenRowCount:t}=this,e=this.getVisibleRect(),i=t>0?e.top+this.getRowsHeight(0,t-1):e.top,r=this.getTargetRowAt(i);if(!r)return 0;let n=Math.max(r.top>=i?r.row:r.row+1,t),s=this.getRowsHeight(0,n-1),l=0,{rowCount:a}=this;for(let t=n;t<a;t++){let i=s+this.getRowHeight(t);if(e.bottom<i)break;l++,s=i}return l}getBodyVisibleCellRange(){let{scrollTop:t,scrollLeft:e}=this,i=this.getFrozenRowsHeight(),r=this.getFrozenColsWidth(),n=this.getBottomFrozenRowsHeight(),s=this.getRightFrozenColsWidth(),{row:l}=this.getRowAt(t+i+1),{col:a}=this.getColAt(e+r+1),o=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(t+this.tableNoFrameHeight-1-n).row:this.rowCount-1,h=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(e+this.tableNoFrameWidth-1-s).col:this.colCount-1;return h<0||o<0?null:{rowStart:l,colStart:a,rowEnd:o,colEnd:h}}getBodyVisibleRowRange(){let{scrollTop:t}=this,e=this.getFrozenRowsHeight(),i=this.getBottomFrozenRowsHeight(),{row:r}=this.getRowAt(t+e+1),n=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(t+this.tableNoFrameHeight-1-i).row:this.rowCount-1;return n<0?null:{rowStart:r,rowEnd:n}}getBodyVisibleColRange(){let{scrollLeft:t}=this,e=this.getFrozenColsWidth(),i=this.getRightFrozenColsWidth(),{col:r}=this.getColAt(t+e+1),n=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(t+this.tableNoFrameWidth-1-i).col:this.colCount-1;return n<0?null:{colStart:r,colEnd:n}}get visibleColCount(){let{frozenColCount:t}=this,e=this.getVisibleRect(),i=t>0?e.left+this.getColsWidth(0,t-1):e.left,r=this.getTargetColAt(i);if(!r)return 0;let n=Math.max(r.left>=i?r.col:r.col+1,t),s=this.getColsWidth(0,n-1),l=0,{colCount:a}=this;for(let t=n;t<a;t++){let i=s+this.getColWidth(t);if(e.right<i)break;l++,s=i}return l}get scrollTop(){return this.stateManager.scroll.verticalBarPos}set scrollTop(t){this.stateManager.setScrollTop(t)}get scrollLeft(){return this.stateManager.scroll.horizontalBarPos}set scrollLeft(t){this.stateManager.setScrollLeft(t)}getScrollLeft(){return this.scrollLeft}getScrollTop(){return this.scrollTop}setScrollLeft(t){this.scrollLeft=Math.ceil(t)}setScrollTop(t){this.scrollTop=Math.ceil(t)}getCellOverflowText(t,e){return this.scenegraph.getCellOverflowText(t,e)}addReleaseObj(t){if(!t||!t.release||"function"!=typeof t.release)throw Error("not releaseObj!");(this.internalProps.releaseList=this.internalProps.releaseList||[]).push(t)}dispose(){this.release()}release(){var t,e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m;let y=this.internalProps;if(this.isReleased)return;null==(e=null==(t=y.tooltipHandler)?void 0:t.release)||e.call(t),null==(r=null==(i=y.menuHandler)?void 0:i.release)||r.call(i),null==(n=super.release)||n.call(this),this.pluginManager.release(),null==(l=null==(s=y.handler)?void 0:s.release)||l.call(s),this.eventManager.release(),null==(o=null==(a=y.focusControl)?void 0:a.release)||o.call(a),null==(h=y.legends)||h.forEach(t=>{null==t||t.release()}),null==(u=y.title)||u.release(),y.title=null,null==(d=y.emptyTip)||d.release(),y.emptyTip=null,y.layoutMap.release(),y.releaseList&&(y.releaseList.forEach(t=>{var e;return null==(e=null==t?void 0:t.release)?void 0:e.call(t)}),y.releaseList=null),this.scenegraph.stage.release(),this.scenegraph.proxy.release(),y.focusControl.release();let v=null==(c=y.element)?void 0:c.parentElement;v&&!this.options.canvas&&v.removeChild(y.element),null==(f=null==(g=null==(p=this.editorManager)?void 0:p.editingEditor)?void 0:g.onEnd)||f.call(g),this.isReleased=!0,this.scenegraph=null,this.internalProps=null,null==(m=this.reactCustomLayout)||m.clearCache(),(0,tG.H6)()}fireListeners(t,e){return super.fireListeners(t,e)}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,T;this.fireListeners(E.B.BEFORE_UPDATE_OPTION,{options:t,container:this.container}),null==(i=this.editorManager)||i.cancelEdit(),this.options=t,this._hasAutoImageColumn=void 0;let{frozenColCount:B=0,unfreezeAllOnExceedsMaxWidth:P,defaultRowHeight:I=40,defaultHeaderRowHeight:F,defaultColWidth:O=80,defaultHeaderColWidth:H=80,keyboardOptions:z,eventOptions:W,rowSeriesNumber:N,enableCheckboxCascade:j,enableHeaderCheckboxCascade:G,columnResizeMode:U,rowResizeMode:K="none",resize:$,dragHeaderMode:Y,dragOrder:q,showFrozenIcon:J,allowFrozenColCount:Q,padding:te,hover:ti,menu:tr,select:tn,pixelRatio:ts,widthMode:tl,heightMode:ta,autoFillWidth:to,autoFillHeight:th,containerFit:tu,widthAdaptiveMode:td,heightAdaptiveMode:tc,customRender:tp,renderChartAsync:tg,renderChartAsyncBatchCount:tf,canvasWidth:tm,canvasHeight:ty,contentOffsetX:tv=0,contentOffsetY:t_=0,overscrollBehavior:tx,limitMinWidth:tC,limitMinHeight:tw}=t,{groupConfig:tS,groupBy:tA,groupTitleFieldFormat:tM,groupTitleCustomLayout:tk,enableTreeStickCell:tT}=t;ts&&ts!==this.internalProps.pixelRatio&&(this.internalProps.pixelRatio=ts),te&&("number"==typeof te?(this.padding.top=te,this.padding.left=te,this.padding.bottom=te,this.padding.right=te):(te.top&&(this.padding.top=te.top),te.bottom&&(this.padding.bottom=te.bottom),te.left&&(this.padding.left=te.left),te.right&&(this.padding.right=te.right))),this.showFrozenIcon="boolean"!=typeof J||J,"number"==typeof Q&&Q<=0&&(this.showFrozenIcon=!1),this.widthMode=null!=tl?tl:"standard",this.heightMode=null!=ta?ta:"standard",this._widthAdaptiveMode=null!=td?td:"only-body",this._heightAdaptiveMode=null!=tc?tc:"only-body",this.autoFillWidth=null!=to&&to,this.autoFillHeight=null!=th&&th,void 0!==tu&&(this._containerFit="boolean"==typeof tu?{width:tu,height:tu}:tu&&"object"==typeof tu?{width:null==(r=tu.width)||r,height:null==(n=tu.height)||n}:{width:!1,height:!1}),this.customRender=tp,this.contentOffsetX=null!=tv?tv:0,this.contentOffsetY=null!=t_?t_:0,this.canvasWidth=(0,X.Z)(tm)?tm:void 0,this.canvasHeight=(0,X.Z)(ty)?ty:void 0;let tR=this.internalProps;if("node"===k.X.mode||t.canvas||(0,Z.gX)(tR.element,this.padding),this.columnWidthComputeMode=null!=(s=t.columnWidthComputeMode)?s:"normal",tR.frozenColCount=B,tR.unfreezeAllOnExceedsMaxWidth=null==P||P,tR.defaultRowHeight=I,tR.defaultHeaderRowHeight=null!=F?F:I,tR.defaultColWidth=O,tR.defaultHeaderColWidth=null!=H?H:O,tR.keyboardOptions=z,tR.eventOptions=W,tR.rowSeriesNumber=N,tR.enableCheckboxCascade=null==(l=null!=j?j:null==N?void 0:N.enableTreeCheckbox)||l,tR.enableHeaderCheckboxCascade=j||null==G||G,tR.columnResizeMode=null!=(a=null==$?void 0:$.columnResizeMode)?a:U,tR.rowResizeMode=null!=(o=null==$?void 0:$.rowResizeMode)?o:K,tR.dragHeaderMode=null!=(u=null!=(h=null==q?void 0:q.dragHeaderMode)?h:Y)?u:"none",tR.renderChartAsync=tg,(0,tG.Ry)(tf),tR.overscrollBehavior=null!=tx?tx:"auto",tR.cellTextOverflows={},tR.groupBy=null!=(d=null==tS?void 0:tS.groupBy)?d:tA,tR.groupTitleCheckbox=null==tS?void 0:tS.titleCheckbox,tR.groupTitleFieldFormat=null!=(c=null==tS?void 0:tS.titleFieldFormat)?c:tM,tR.groupTitleCustomLayout=null!=(p=null==tS?void 0:tS.titleCustomLayout)?p:tk,tR.enableTreeStickCell=null!=(g=null==tS?void 0:tS.enableTreeStickCell)?g:tT,(null==e?void 0:e.clearColWidthCache)&&(tR._widthResizedColMap.clear(),this.colWidthsMap=new L.B,this.colContentWidthsMap=new L.B,this.colWidthsLimit={}),(null==e?void 0:e.clearRowHeightCache)&&(tR._heightResizedRowMap.clear(),tR._rowHeightsMap=new rA(this),tR._rowRangeHeightsMap=new Map,tR._colRangeWidthsMap=new Map),tR.stick.changedCells.clear(),tR.theme=D.default.of(null!=(f=t.theme)?f:D.default.DEFAULT),tR.theme.isPivot=this.isPivotTable(),(0,tb.E6)(tR.theme.functionalIconsStyle),this.scenegraph.updateStageBackground(),tR.autoWrapText=t.autoWrapText,tR.enableLineBreak=t.enableLineBreak,tR.allowFrozenColCount=null!=(m=t.allowFrozenColCount)?m:0,tR.limitMaxAutoWidth=null!=(y=t.limitMaxAutoWidth)?y:450,tR.limitMinWidth=null!=tC?"number"==typeof tC?tC:10*!!tC:10,tR.limitMinHeight=null!=tw?"number"==typeof tw?tw:10*!!tw:10,null==(v=tR.legends)||v.forEach(t=>{null==t||t.release()}),null==(b=tR.title)||b.release(),tR.title=null,null==(_=tR.emptyTip)||_.release(),tR.emptyTip=null,tR.layoutMap.release(),(0,tG.H6)(),this.scenegraph.clearCells(),this.scenegraph.updateComponent(),this.stateManager.updateOptionSetState(),this._updateSize(),this.eventManager.updateEventBinder(),t.legends){tR.legends=[];let e=V.F.getFunction("createLegend");if(Array.isArray(t.legends)){for(let i=0;i<t.legends.length;i++)tR.legends.push(e(t.legends[i],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else tR.legends.push(e(t.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}tR.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:R.u.bottom},t.tooltip),"html"!==tR.tooltip.renderMode||tR.tooltipHandler||(tR.tooltipHandler=new(V.F.getComponent("tooltipHandler"))(this,tR.tooltip.confine)),tR.menu=Object.assign({renderMode:"html"},t.menu),Array.isArray(null==(x=t.menu)?void 0:x.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(C=t.menu)?void 0:C.dropDownMenuHighlight),(Array.isArray(null==(w=t.menu)?void 0:w.defaultHeaderMenuItems)||"function"==typeof(null==(S=t.menu)?void 0:S.defaultHeaderMenuItems))&&(this.globalDropDownMenu=t.menu.defaultHeaderMenuItems),"html"!==tR.menu.renderMode||tR.menuHandler||(tR.menuHandler=new(V.F.getComponent("menuHandler"))(this)),this.clearCellStyleCache(),(null==e?void 0:e.clearColWidthCache)&&this.clearColWidthCache(),(null==e?void 0:e.clearRowHeightCache)&&this.clearRowHeightCache(),tR.customMergeCell=(0,r$.k)(t.customMergeCell),null==(A=this.customCellStylePlugin)||A.updateCustomCell(null!=(M=t.customCellStyle)?M:[],null!=(T=t.customCellStyleArrangement)?T:[]),this._adjustCanvasSizeByOption()}renderWithRecreateCells(){this.internalProps.stick.changedCells.clear();let t={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(t.col,t.row),this.render()}getFrozenRowsHeight(){return this.getRowsHeight(0,this.frozenRowCount-1)}getFrozenColsWidth(){return this.getColsWidth(0,this.frozenColCount-1)}getBottomFrozenRowsHeight(){if(this.bottomFrozenRowCount>0){let t=0;for(let e=this.rowCount-this.bottomFrozenRowCount;e<=this.rowCount-1;e++)t+=this.getRowHeight(e);return t}return 0}getRightFrozenColsWidth(){if(this.rightFrozenColCount>0){let t=0;for(let e=this.colCount-this.rightFrozenColCount;e<=this.colCount-1;e++)t+=this.getColWidth(e);return t}return 0}getDrawRange(){var t,e;let i=(null==(t=this.containerFit)?void 0:t.width)?this.tableNoFrameWidth:Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),r=(null==(e=this.containerFit)?void 0:e.height)?this.tableNoFrameHeight:Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());return new F.U(this.tableX,this.tableY,i,r)}_getMouseAbstractPoint(t){var e,i,r,n,s,l,a,o;let h;if(!t)return{inTable:!1,x:void 0,y:void 0};let u=(h=rq(t)?t.changedTouches[0]:t).clientX||h.pageX+window.scrollX,d=h.clientY||h.pageY+window.scrollY,c=this.internalProps.canvas.getBoundingClientRect(),p=!0;c.right<=u&&(p=!1),c.bottom<=d&&(p=!1);let g=c.width,f=g/((90===this.rotateDegree?this.canvas.offsetHeight:this.canvas.offsetWidth)||g),m=c.height,y=m/((90===this.rotateDegree?this.canvas.offsetWidth:this.canvas.offsetHeight)||m),v=this.pluginManager.getPluginByName("Rotate Table");if(v&&90===this.rotateDegree){let t={x:u/f-(null!=(i=null==(e=this.options.viewBox)?void 0:e.x1)?i:0),y:d/y-(null!=(n=null==(r=this.options.viewBox)?void 0:r.y1)?n:0),inTable:p};return v.matrix.transformPoint(t,t),t}let b={x:(u-c.left)/f-(null!=(l=null==(s=this.options.viewBox)?void 0:s.x1)?l:0),y:(d-c.top)/y-(null!=(o=null==(a=this.options.viewBox)?void 0:a.y1)?o:0),inTable:p};return this.internalProps.modifiedViewBoxTransform&&this.scenegraph.stage.window.getViewBoxTransform()&&this.scenegraph.stage.window.getViewBoxTransform().transformPoint(b,b),b}getTheme(){return this.internalProps.theme}getTargetColAt(t){return rE(t,this)}getTargetRowAt(t){let e=rI(t,this);return e&&(e.row=Math.min(e.row,this.rowCount-1)),e}getTargetColAtConsiderRightFrozen(t,e){return rL(t,e,this)}getTargetRowAtConsiderBottomFrozen(t,e){return rF(t,e,this)}clearSelected(){this.stateManager.updateSelectPos(-1,-1)}selectCell(t,e,i,r,n,s=!1){var l,a,o;let h=!!(null==(l=this.stateManager.select.ranges)?void 0:l.length);this.stateManager.updateSelectPos(t,e,i,r,!1,null==(o=null!=n?n:null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||o,s),this.stateManager.endSelectCells(!0,h)}selectCells(t){let{scrollLeft:e,scrollTop:i}=this;t.forEach((t,e)=>{var i,r,n,s,l,a;let o=t.start.row,h=t.start.col,u=t.end.row,d=t.end.col;h===d&&o===u?this.stateManager.updateSelectPos(h,o,!1,e>=1,!1,null==(r=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||r,!0):(this.stateManager.updateSelectPos(h,o,!1,e>=1,!1,null==(s=null==(n=this.options.select)?void 0:n.makeSelectCellVisible)||s,!0),this.stateManager.updateInteractionState(B.F.grabing),this.stateManager.updateSelectPos(d,u,!1,e>=1,!1,null==(a=null==(l=this.options.select)?void 0:l.makeSelectCellVisible)||a,!0)),this.stateManager.endSelectCells(!1,!1),this.stateManager.updateInteractionState(B.F.default)}),this.setScrollTop(i),this.setScrollLeft(e)}selectRow(t,e,i){let r=this.stateManager.select.ranges;if(e)r.push({start:{col:0,row:t},end:{col:this.colCount-1,row:t}}),this.selectCells(r);else if(i){let e=r[r.length-1];e&&(e.end.row=t),this.selectCells(r)}else this.selectCells([{start:{col:0,row:t},end:{col:this.colCount-1,row:t}}])}selectCol(t,e,i){let r=this.stateManager.select.ranges;if(e)r.push({start:{col:t,row:0},end:{col:t,row:this.rowCount-1}}),this.selectCells(r);else if(i){let e=r[r.length-1];e&&(e.end.col=t),this.selectCells(r)}else this.selectCells([{start:{col:t,row:0},end:{col:t,row:this.rowCount-1}}])}startDragSelectCol(t,e,i){var r,n,s,l,a,o;let h=this.stateManager.select.ranges[this.stateManager.select.ranges.length-1],u=i&&(null==(r=null==h?void 0:h.start)?void 0:r.col)?null==(n=null==h?void 0:h.start)?void 0:n.col:t,d=this.rowCount-1;this.stateManager.updateSelectPos(u,0,i,e,!1,null==(l=null==(s=this.options.select)?void 0:s.makeSelectCellVisible)||l,!0),this.stateManager.updateInteractionState(B.F.grabing),this.stateManager.updateSelectPos(t,d,i,e,!1,null==(o=null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||o,!0)}dragSelectCol(t,e){var i,r;let n=this.stateManager.select.ranges,s=n[n.length-1];s&&(s.end.col=t),this.stateManager.updateSelectPos(t,this.rowCount-1,!1,e,!1,null==(r=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||r,!0)}endDragSelect(){this.stateManager.updateInteractionState(B.F.default),this.stateManager.endSelectCells(!1,!1)}startDragSelectRow(t,e,i){var r,n,s,l,a,o;let h=this.stateManager.select.ranges[this.stateManager.select.ranges.length-1],u=i&&(null==(r=null==h?void 0:h.start)?void 0:r.row)?null==(n=null==h?void 0:h.start)?void 0:n.row:t,d=this.colCount-1;this.stateManager.updateSelectPos(0,u,i,e,!1,null==(l=null==(s=this.options.select)?void 0:s.makeSelectCellVisible)||l,!0),this.stateManager.updateInteractionState(B.F.grabing),this.stateManager.updateSelectPos(d,t,i,e,!1,null==(o=null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||o,!0)}dragSelectRow(t,e){var i,r;let n=this.stateManager.select.ranges,s=n[n.length-1];s&&(s.end.row=t),this.stateManager.updateSelectPos(this.colCount-1,t,!1,e,!1,null==(r=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||r,!0)}get recordsCount(){var t;return null==(t=this.records)?void 0:t.length}get allowFrozenColCount(){return this.internalProps.allowFrozenColCount}get rowHeaderLevelCount(){return this.internalProps.layoutMap.rowHeaderLevelCount}get columnHeaderLevelCount(){return this.internalProps.layoutMap.columnHeaderLevelCount}get records(){return this.internalProps.records}get dataSource(){return this.internalProps.dataSource}set dataSource(t){this.scenegraph.clearCells(),(0,Z.x6)(this,t),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()}get autoWrapText(){return this.internalProps.autoWrapText}set autoWrapText(t){this.internalProps.autoWrapText=t,this.options.autoWrapText=t}get enableLineBreak(){return this.internalProps.enableLineBreak}set enableLineBreak(t){this.internalProps.enableLineBreak=t,this.options.enableLineBreak=t}updateAutoWrapText(t){this.internalProps.autoWrapText!==t&&(this.internalProps.autoWrapText=t,this.options.autoWrapText=t,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.render())}get theme(){return this.internalProps.theme}set theme(t){this.internalProps.theme=D.default.of(null!=t?t:D.default.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),this.options.theme=t,(0,tb.E6)(this.internalProps.theme.functionalIconsStyle)}updateTheme(t){let e={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.theme=D.default.of(null!=t?t:D.default.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),(0,tb.E6)(this.internalProps.theme.functionalIconsStyle),this.options.theme=t,this.scenegraph.updateComponent(),this.scenegraph.updateStageBackground(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(e.col,e.row),this.render()}getBodyField(t,e){return this.internalProps.layoutMap.getBody(t,e).field}getBodyColumnDefine(t,e){let i=this.internalProps.layoutMap.getBody(t,e);return null==i?void 0:i.define}getBodyColumnType(t,e){var i,r;let n=null!=(r=null==(i=this.internalProps.layoutMap.getBody(t,e))?void 0:i.cellType)?r:"text";return(0,Y.WJ)("cellType",{cellType:n},t,e,this)}getCellType(t,e){let i;return this.isSeriesNumberInHeader(t,e)?this.internalProps.layoutMap.getSeriesNumberHeader(t,e).cellType:(i=this.isHeader(t,e)?this.internalProps.layoutMap.getHeader(t,e).headerType:this.internalProps.layoutMap.getBody(t,e).cellType,(0,Y.WJ)("cellType",{cellType:i},t,e,this))}getHeaderField(t,e){return this.internalProps.layoutMap.getHeaderField(t,e)}getHeaderDefine(t,e){let i=this.internalProps.layoutMap.getHeader(t,e);return null==i?void 0:i.define}getCellLocation(t,e){return this.internalProps.layoutMap.getCellLocation(t,e)}getCellHeaderPaths(t,e){return this.internalProps.layoutMap.getCellHeaderPaths(t,e)}getHeadersDefine(t,e){let i=[];for(;;){let r=this.getHeaderDefine(t,e);if(!r||!r.field&&!r.columns)break;i.push(r),e++}return i}_getHeaderLayoutMap(t,e){return this.internalProps.layoutMap.getHeader(t,e)}_getBodyLayoutMap(t,e){return this.internalProps.layoutMap.getBody(t,e)}getContext(){return this.internalProps.context}getRecordByCell(t,e){if(!this.internalProps.layoutMap.isHeader(t,e))return this.getCellOriginRecord(t,e)}getRecordByRowCol(t,e){return this.getRecordByCell(t,e)}getRecordStartRowByRecordIndex(t){return this.internalProps.layoutMap.getRecordStartRowByRecordIndex(t)}_getHeaderCellBySortState(t){let{layoutMap:e}=this.internalProps,i=e.headerObjects.find(e=>e&&e.field===t.field);if(i)return e.getHeaderCellAdressById(i.id)}getCellRange(t,e){var i;if(this.internalProps.customMergeCell){let i=this.internalProps.customMergeCell(t,e,this);if(i&&i.range&&((0,y.Z)(i.text)||i.customLayout||i.customRender))return{start:{col:Math.max(i.range.start.col,0),row:Math.max(i.range.start.row,0)},end:{col:Math.min(i.range.end.col,this.colCount-1),row:Math.min(i.range.end.row,this.rowCount-1)},isCustom:!0}}return null==(i=this.internalProps.layoutMap)?void 0:i.getCellRange(t,e)}hasCustomMerge(){return!!this.internalProps.customMergeCell}getCustomMerge(t,e){if(this.internalProps.customMergeCell){let i=this.internalProps.customMergeCell(t,e,this);if(i&&i.range&&((0,y.Z)(i.text)||i.customLayout||this.customRender)){if(i.style){let r=this.internalProps.bodyHelper.getStyleClass("text"),n=M(i.style,this.theme.bodyStyle,{col:t,row:e,table:this,value:i.text,dataValue:this.getCellOriginValue(t,e),cellHeaderPaths:this.getCellHeaderPaths(t,e)},r,this.options.autoWrapText,this.theme);i.style=n}return i.range={start:{col:Math.max(i.range.start.col,0),row:Math.max(i.range.start.row,0)},end:{col:Math.min(i.range.end.col,this.colCount-1),row:Math.min(i.range.end.row,this.rowCount-1)},isCustom:!0},i}}}isCellRangeEqual(t,e,i,r){return this.internalProps.layoutMap.isCellRangeEqual(t,e,i,r)}_getLayoutCellId(t,e){return this.internalProps.layoutMap.getCellId(t,e)}getHeaderDescription(t,e){var i;let r=this._getHeaderLayoutMap(t,e),n=null==r?void 0:r.define,s=null!=(i=null==n?void 0:n.description)?i:null==r?void 0:r.description;return"function"==typeof s?s({col:t,row:e,value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e)}):s}setDropDownMenuHighlight(t){this.stateManager.setDropDownMenuHighlight(t)}_dropDownMenuIsHighlight(t,e,i){return this.stateManager.dropDownMenuIsHighlight(t,e,i)}isSeriesNumberInBody(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInBody(t,e)}isSeriesNumberInHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)}isHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isHeader(t,e)}isColumnHeader(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isColumnHeader(t,e)}isRowHeader(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isRowHeader(t,e)}isCornerHeader(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isCornerHeader(t,e)}isFrozenColumn(t,e){return this.isLeftFrozenColumn(t,e)||this.isRightFrozenColumn(t,e)}isLeftFrozenColumn(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isFrozenColumn(t,e)}isRightFrozenColumn(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isRightFrozenColumn(t,e)}isFrozenRow(t,e){return this.isTopFrozenRow(t,e)||this.isBottomFrozenRow(t,e)}isTopFrozenRow(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isFrozenRow(t,e)}isBottomFrozenRow(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isBottomFrozenRow(t,e)}getCellInfo(t,e){if(t>=0&&e>=0){let i=this.isHeader(t,e)?this.getHeaderDefine(t,e):this.getBodyColumnDefine(t,e);return{col:t,row:e,field:this.getHeaderField(t,e),cellHeaderPaths:this.internalProps.layoutMap.getCellHeaderPaths(t,e),title:null==i?void 0:i.title,cellType:this.getCellType(t,e),originData:this.getCellOriginRecord(t,e),cellRange:this.getCellRangeRelativeRect({col:t,row:e}),value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e),cellLocation:this.getCellLocation(t,e),scaleRatio:this.canvas.getBoundingClientRect().width/this.canvas.offsetWidth}}}_hasField(t,e,i){var r;if(null===t||this.internalProps.layoutMap.isHeader(e,i))return!1;let n=this.getRecordShowIndexByCell(e,i);return null==(r=this.internalProps.dataSource)?void 0:r.hasField(n,t)}_getCellStyle(t,e){return function(t,e,i){var r,n,s,l,a,o,h,u,d,c;let p,g,f,m=null==(r=i.customCellStylePlugin)?void 0:r.getCustomCellStyle(t,e),{layoutMap:y}=i.internalProps;if(y.isHeader(t,e)){let r,o;if(!i.isPivotTable()||i.isBottomFrozenRow(e)||i.isRightFrozenColumn(t))r=`${t}-${e}`;else{let n=i.getHeaderDefine(t,e),s=i.isCornerHeader(t,e);r=(null==n?void 0:n.dimensionKey)?s?`dim-cor-${n.dimensionKey}`:`dim-${n.dimensionKey}`:(null==n?void 0:n.indicatorKey)?`ind-${n.indicatorKey}`:`${t}-${e}`}let h=i.headerStyleCache.get(r);if(h)return m?(0,rH.wh)(h,m):h;let u=y.getHeader(t,e);if(i.isPivotChart()&&(0,rO.Vp)(t,e,y)&&y.isAxisCell(t,e)?o=null!=(s=null==(n=y.getBody(t,i.rowHeaderLevelCount).style)?void 0:n.padding)?s:i.theme.bodyStyle.padding:i.isPivotChart()&&(0,rO.iN)(t,e,y)&&y.isAxisCell(t,e)&&(o=null!=(a=null==(l=y.getBody(i.columnHeaderLevelCount,e).style)?void 0:l.padding)?a:i.theme.bodyStyle.padding),(!u||u.isEmpty)&&(y.isLeftBottomCorner(t,e)||y.isRightBottomCorner(t,e)||y.isCornerHeader(t,e)||y.isRightTopCorner(t,e)))return rz;let d=i.internalProps.headerHelper.getStyleClass((null==u?void 0:u.headerType)||"text");if(y.isBottomFrozenRow(t,e)&&i.theme.bottomFrozenStyle)h=rD(o?{padding:o}:{},i.theme.bottomFrozenStyle,{col:t,row:e,table:i,value:i.getCellValue(t,e),dataValue:i.getCellOriginValue(t,e),cellHeaderPaths:i.getCellHeaderPaths(t,e)},d,i.options.autoWrapText,i.theme);else if(y.isRightFrozenColumn(t,e)&&i.theme.rightFrozenStyle)h=rD(o?{padding:o}:{},i.theme.rightFrozenStyle,{col:t,row:e,table:i,value:i.getCellValue(t,e),dataValue:i.getCellOriginValue(t,e),cellHeaderPaths:i.getCellHeaderPaths(t,e)},d,i.options.autoWrapText,i.theme);else{let r=(null==u?void 0:u.style)||{};o&&(r.padding=o),h=rD(r,y.isColumnHeader(t,e)||y.isBottomFrozenRow(t,e)?i.theme.headerStyle:y.isRowHeader(t,e)||y.isRightFrozenColumn(t,e)?i.theme.rowHeaderStyle:i.theme.cornerHeaderStyle,{col:t,row:e,table:i,value:i.getCellValue(t,e),dataValue:i.getCellOriginValue(t,e),cellHeaderPaths:i.getCellHeaderPaths(t,e)},d,i.options.autoWrapText,i.theme)}return i.headerStyleCache.set(r,h),m?(0,rH.wh)(h,m):h}(null==(h=null==(o=i.internalProps)?void 0:o.dataConfig)?void 0:h.mappingRules)&&!i.isHeader(t,e)&&(null==(c=null==(d=null==(u=i.internalProps)?void 0:u.dataConfig)?void 0:d.mappingRules)||c.forEach((r,n)=>{r.bgColor&&i.internalProps.layoutMap.getIndicatorKey(t,e)===r.bgColor.indicatorKey&&(p=r.bgColor.mapping)}));let v=i.getCellType(t,e),b=i.getCellOriginRecord(t,e);if(g=(null==b?void 0:b.vtableMerge)?"merge-title":i.isSeriesNumberInBody(t,e)?`${t}-series-`+v:i.isListTable()&&!i.transpose||i.isPivotTable()&&i.internalProps.layoutMap.indicatorsAsCol?t+v:e+v,f=(null==b?void 0:b.vtableMerge)?i.bodyMergeTitleCache.get(g):y.isBottomFrozenRow(e)?i.bodyBottomStyleCache.get(g):i.bodyStyleCache.get(g))return m?(0,rH.wh)(f,m):f;let _=y.getBody(t,e),x=i.internalProps.bodyHelper.getStyleClass(i.getCellType(t,e)),C=null==_?void 0:_.style;return f=M(C,(null==b?void 0:b.vtableMerge)&&i.theme.groupTitleStyle?i.theme.groupTitleStyle:y.isBottomFrozenRow(e)&&i.theme.bottomFrozenStyle?i.theme.bottomFrozenStyle:y.isRightFrozenColumn(t)&&i.theme.rightFrozenStyle?i.theme.rightFrozenStyle:i.theme.bodyStyle,{col:t,row:e,table:i,value:i.getCellValue(t,e),dataValue:i.getCellOriginValue(t,e),cellHeaderPaths:i.getCellHeaderPaths(t,e)},x,i.options.autoWrapText,i.theme),p&&(f=(0,rH.wh)(f,{bgColor:p})),(0,iq.Z)(C)||(y.isBottomFrozenRow(e)?i.bodyBottomStyleCache.set(g,f):i.bodyStyleCache.set(g,f)),m?(0,rH.wh)(f,m):f}(t,e,this)}clearCellStyleCache(){this.headerStyleCache.clear(),this.bodyStyleCache.clear(),this.bodyMergeTitleCache.clear(),this.bodyBottomStyleCache.clear()}clearRowHeightCache(){this.internalProps._rowHeightsMap.clear(),this._clearRowRangeHeightsMap()}clearColWidthCache(){this.internalProps._colWidthsMap.clear(),this._clearColRangeWidthsMap()}_canResizeColumn(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t+1,e)||"none"===this.internalProps.columnResizeMode)return!1;if("header"===this.internalProps.columnResizeMode){if(!this.isHeader(t,e))return!1}else if("body"===this.internalProps.columnResizeMode&&this.isHeader(t,e))return!1;let i=this.colWidthsLimit[t];return!(i&&i.min&&i.max)||i.max!==i.min}_canResizeRow(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t,e+1)||"none"===this.internalProps.rowResizeMode)return!1;if("header"===this.internalProps.rowResizeMode){if(!this.isHeader(t,e))return!1}else if("body"===this.internalProps.rowResizeMode&&this.isHeader(t,e))return!1;return!0}_canDragHeaderPosition(t,e){var i;if(this.isHeader(t,e)&&(this.stateManager.isSelected(t,e)||"body"===(null==(i=this.options.select)?void 0:i.headerSelectMode)&&function(t,e,i){for(let r=0;r<i.length;r++){let n=i[r];if((0,P._Z)(n,t,e))return!0}return!1}(t,e,[this.getCellRange(this.stateManager.select.cellPos.col,this.stateManager.select.cellPos.row)])||t1(this,t,e))){if("disabled"===this.internalProps.frozenColDragHeaderMode&&this.isFrozenColumn(t))return!1;if(this.stateManager.isSelected(t,e)){let i=this.stateManager.select.ranges[0];if(this.isColumnHeader(t,e)){if(i.end.row!==this.rowCount-1)return!1}else if(!this.isRowHeader(t,e)||i.end.col!==this.colCount-1)return!1}let i=this.getHeaderDefine(t,e);if(!i)return!1;if(void 0===i.dragHeader){if("all"===this.internalProps.dragHeaderMode)return!0;if("column"===this.internalProps.dragHeaderMode){if(this.isColumnHeader(t,e))return!0}else if("row"===this.internalProps.dragHeaderMode&&this.isRowHeader(t,e))return!0;return!1}return i.dragHeader}return!1}getCellIcons(t,e){var i,r,n;let s;if(this.isHeader(t,e))s=this.internalProps.headerHelper.getIcons(t,e);else if(this.internalProps.layoutMap.isSeriesNumber(t,e)){this.internalProps.groupBy&&(null==(i=this.getCellRawRecord(t,e))?void 0:i.vtableMerge)||null==(n=null==(r=this.internalProps.layoutMap.getSeriesNumberBody(t,e))?void 0:r.define)||!n.dragOrder||(s=this.internalProps.rowSeriesNumberHelper.getIcons(t,e));let l=this.getCellValue(t,e),a=this.getCellOriginValue(t,e),o=this.internalProps.context,h=this.internalProps.bodyHelper.getIcons(t,e,l,a,o);(null==s?void 0:s.length)>0?s=s.concat(h):(null==h?void 0:h.length)>0&&(s=h)}else{let i=this.getCellValue(t,e),r=this.getCellOriginValue(t,e),n=this.internalProps.context;s=this.internalProps.bodyHelper.getIcons(t,e,i,r,n)}return s}showDropDownMenu(t,e,i){let r="dropdown-menu";i&&(r=Array.isArray(i.content)?"dropdown-menu":"container"),"html"===this.internalProps.menu.renderMode&&(this.stateManager.menu.isShow=!0,this.internalProps.menuHandler._bindToCell(t,e,r,i))}showTooltip(t,e,i){"html"===this.internalProps.tooltip.renderMode&&this.internalProps.tooltipHandler._bindToCell(t,e,i)}getCellStyle(t,e){let i=this._getCellStyle(t,e),r=(0,Z.RT)(i,this,t,e,Y.WJ).theme,{autoWrapText:n,lineClamp:s,textOverflow:l}=i;return{textAlign:r.text.textAlign,textBaseline:r.text.textBaseline,bgColor:(0,rC.Z)(r.group.fill)?(0,Y.WJ)("bgColor",i,t,e,this):r.group.fill,color:(0,rC.Z)(r.text.fill)?(0,Y.WJ)("color",i,t,e,this):r.text.fill,strokeColor:(0,rC.Z)(r.text.stroke)?(0,Y.WJ)("strokeColor",i,t,e,this):r.text.stroke,fontFamily:r.text.fontFamily,fontSize:r.text.fontSize,fontWeight:r.text.fontWeight,fontVariant:r.text.fontVariant,fontStyle:r.text.fontStyle,lineHeight:r.text.lineHeight,autoWrapText:null!=n&&n,lineClamp:null!=s?s:"auto",textOverflow:l,borderColor:(0,rC.Z)(r.group.stroke)?(0,Y.WJ)("borderColor",i,t,e,this):r.group.stroke,borderLineWidth:r.group.lineWidth,borderLineDash:r.group.lineDash,underline:!!r.text.underline,underlineDash:r.text.underlineDash,underlineOffset:r.text.underlineOffset,lineThrough:!!r.text.lineThrough,padding:r._vtable.padding,underlineWidth:r.text.underline,lineThroughLineWidth:r.text.lineThrough,_strokeArrayWidth:r.group.strokeArrayWidth,_strokeArrayColor:r.group.strokeArrayColor,_linkColor:(0,Y.WJ)("linkColor",i,t,e,this)}}getAllBodyCells(t,e){let i=this.rowHeaderLevelCount,r=this.columnHeaderLevelCount,n=this.colCount-1;return Array(Math.min(null!=e?e:2e3,this.rowCount-1-r+1,this.rowCount)).fill(0).map((e,s)=>Array(Math.min(null!=t?t:2e3,n-i+1,this.colCount)).fill(0).map((t,e)=>this.getCellInfo(e+i,s+r)))}getAllCells(t,e){let i=this.colCount-1;return Array(Math.min(null!=e?e:2e3,this.rowCount-1-0+1,this.rowCount)).fill(0).map((e,r)=>Array(Math.min(null!=t?t:2e3,i-0+1,this.colCount)).fill(0).map((t,e)=>this.getCellInfo(e+0,r+0)))}getAllColumnHeaderCells(){let t=this.rowHeaderLevelCount,e=this.colCount-1;return Array(this.columnHeaderLevelCount-1-0+1).fill(0).map((i,r)=>Array(e-t+1).fill(0).map((e,i)=>this.getCellInfo(i+t,r+0)))}getAllRowHeaderCells(){let t=this.columnHeaderLevelCount,e=this.rowHeaderLevelCount-1;return Array(this.rowCount-1-t+1).fill(0).map((i,r)=>Array(e-0+1).fill(0).map((e,i)=>this.getCellInfo(i+0,r+t)))}getCopyValue(){var t,e,i;if((null==(e=null==(t=this.stateManager.select)?void 0:t.ranges)?void 0:e.length)>0){let t=this.stateManager.select.ranges,e=Math.min(t[0].start.col,t[0].end.col),r=Math.max(t[0].start.col,t[0].end.col),n=Math.min(t[0].start.row,t[0].end.row),s=Math.max(t[0].start.row,t[0].end.row);t.forEach(t=>{e=Math.min(e,t.start.col,t.end.col),r=Math.max(r,t.start.col,t.end.col),n=Math.min(n,t.start.row,t.end.row),s=Math.max(s,t.start.row,t.end.row)});let l=e=>{let i=!1;return t.forEach(t=>{let r=Math.min(t.start.row,t.end.row),n=Math.max(t.start.row,t.end.row);r<=e&&n>=e&&(i=!0)}),i},a=e=>{let i=!1;return t.forEach(t=>{let r=Math.min(t.start.col,t.end.col),n=Math.max(t.start.col,t.end.col);r<=e&&n>=e&&(i=!0)}),i},o=(e,i)=>{let r;return t.forEach(t=>{let n=Math.min(t.start.row,t.end.row),s=Math.max(t.start.row,t.end.row),l=Math.min(t.start.col,t.end.col),a=Math.max(t.start.col,t.end.col);l<=e&&a>=e&&n<=i&&s>=i&&(r=t)}),r},h=(t,e,i)=>{let r=this.getCellRange(t,e),n=r.start.col,s=r.start.row;if(i){let t=Math.min(i.start.col,i.end.col),e=Math.min(i.start.row,i.end.row);n=Math.max(t,r.start.col),s=Math.max(e,r.start.row)}return n!==t||s!==e?"":this.getCellValue(t,e)},u="";for(let t=n;t<=s;t++)if(l(t)){for(let i=e;i<=r;i++)if(a(i)){let e=o(i,t);if(e){let n=h(i,t,e);if("undefined"!=typeof Promise&&n instanceof Promise);else{let t=(0,y.Z)(n)?`${n}`:"";/^\[object .*\]$/.exec(t)||(u+=t)}(i<e.end.col||i<r)&&(u+="	")}else u+="	"}t<s&&(u+="\r\n")}return(null==(i=this.options)?void 0:i.formatCopyValue)&&(u=this.options.formatCopyValue(u)),u}return""}getSelectedCellInfos(){var t;if(!(null==(t=this.stateManager.select)?void 0:t.ranges))return null;let e=this.stateManager.select.ranges;if(!e.length)return[];let i=Math.min(e[0].start.col,e[0].end.col),r=Math.max(e[0].start.col,e[0].end.col),n=Math.min(e[0].start.row,e[0].end.row),s=Math.max(e[0].start.row,e[0].end.row);e.forEach(t=>{i=Math.min(i,t.start.col,t.end.col),r=Math.max(r,t.start.col,t.end.col),n=Math.min(n,t.start.row,t.end.row),s=Math.max(s,t.start.row,t.end.row)});let l=t=>{let i=!1;return e.forEach(e=>{let r=Math.min(e.start.row,e.end.row),n=Math.max(e.start.row,e.end.row);r<=t&&n>=t&&(i=!0)}),i},a=t=>{let i=!1;return e.forEach(e=>{let r=Math.min(e.start.col,e.end.col),n=Math.max(e.start.col,e.end.col);r<=t&&n>=t&&(i=!0)}),i},o=(t,i)=>{let r;return e.forEach(e=>{let n=Math.min(e.start.row,e.end.row),s=Math.max(e.start.row,e.end.row),l=Math.min(e.start.col,e.end.col),a=Math.max(e.start.col,e.end.col);l<=t&&a>=t&&n<=i&&s>=i&&(r=e)}),r},h=[];for(let t=n;t<=s;t++)if(l(t)){let e=[];for(let n=i;n<=r;n++)if(a(n)&&o(n,t)){let i=this.getCellInfo(n,t);e.push(i)}h.push(e)}return h}getSelectedCellRanges(){let t=this.stateManager.select.ranges;return t.length?(0,rw.Z)(t):[]}measureText(t,e){return ev.QC.measureText(t,e)}measureTextBounds(t){return(0,ev.Rc)(t)}getCustomRender(t,e){let i;if("body"!==this.getCellLocation(t,e)){let r=this.getHeaderDefine(t,e);i=null==r?void 0:r.headerCustomRender}else{let r=this.getBodyColumnDefine(t,e);i=(null==r?void 0:r.customRender)||this.customRender}return i}getCustomLayout(t,e){let i;if("body"!==this.getCellLocation(t,e)){let r=this.getHeaderDefine(t,e);i=null==r?void 0:r.headerCustomLayout}else{let r=this.getBodyColumnDefine(t,e);i=null==r?void 0:r.customLayout}return i}hasAutoImageColumn(){return void 0===this._hasAutoImageColumn&&(this._hasAutoImageColumn=(0,rR.N3)(this)),this._hasAutoImageColumn}_getActiveChartInstance(){var t,e,i,r,n,s;let l=this.scenegraph.getCell(null==(e=null==(t=this.stateManager.hover)?void 0:t.cellPos)?void 0:e.col,null==(r=null==(i=this.stateManager.hover)?void 0:i.cellPos)?void 0:r.row);return"chart"===(null==(s=null==(n=null==l?void 0:l.getChildren())?void 0:n[0])?void 0:s.type)?l.getChildren()[0].activeChartInstance:null}cellIsInVisualView(t,e){var i,r,n,s;let l,a,o,h,u=this.getDrawRange(),d=this.getCellRelativeRect(t,e);return!!(t<this.frozenColCount&&e<this.frozenRowCount||(this.frozenRowCount>=1&&(l=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}})),this.frozenColCount>=1&&(a=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.frozenColCount-1,row:this.rowCount-1}})),this.bottomFrozenRowCount>=1&&(o=this.getCellRangeRelativeRect({start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}})),this.rightFrozenColCount>=1&&(h=this.getCellRangeRelativeRect({start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.rowCount-1}})),d.top>=u.top&&d.bottom<=u.bottom&&d.left>=u.left&&d.right<=u.right&&(this.isFrozenCell(t,e)||d.top>=(null!=(i=null==l?void 0:l.bottom)?i:d.top)&&d.left>=(null!=(r=null==a?void 0:a.right)?r:d.left)&&d.bottom<=(null!=(n=null==o?void 0:o.top)?n:d.bottom)&&d.right<=(null!=(s=null==h?void 0:h.left)?s:d.right))))||!1}getCustomMergeValue(t,e){if(this.internalProps.customMergeCell){let i=this.getCustomMerge(t,e);if(i){let{text:t}=i;return t}}}exportImg(){return this.scenegraph.stage.toCanvas().toDataURL()}exportCellImg(t,e,i){var r,n,s,l;let a,o,h=this.cellIsInVisualView(t,e),{scrollTop:u,scrollLeft:d}=this;h||this.scrollToCell({col:t,row:e});let c=this.getCellRelativeRect(t,e);(null==(n=null==(r=this.stateManager.select)?void 0:r.ranges)?void 0:n.length)>0&&e6(this.scenegraph);let{col:p,row:g}=this.stateManager.hover.cellPos;if(this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.tableGroup.border.setAttribute("visible",!1),null==i?void 0:i.disableBackground){let i=this.scenegraph.getCell(t,e);a=i.attribute.fill,i.setAttribute("fill","transparent")}if(null==i?void 0:i.disableBorder){let i=this.scenegraph.getCell(t,e);o=i.attribute.stroke,i.setAttribute("stroke",!1)}this.scenegraph.renderSceneGraph();let f=0;"bottom-right"===this.theme.cellBorderClipDirection&&(f=1);let m=this.scenegraph.stage.toCanvas(!1,(new iz.FB).set(c.left+this.tableX+1,c.top+this.tableY+1,c.right+this.tableX-f,c.bottom+this.tableY-f));return h||(this.setScrollTop(u),this.setScrollLeft(d)),this.scenegraph.tableGroup.border.setAttribute("visible",!0),a&&this.scenegraph.getCell(t,e).setAttribute("fill",a),o&&this.scenegraph.getCell(t,e).setAttribute("stroke",o),(null==(l=null==(s=this.stateManager.select)?void 0:s.ranges)?void 0:l.length)>0&&e8(this.scenegraph),this.stateManager.updateHoverPos(p,g),this.scenegraph.updateNextFrame(),m.toDataURL()}exportCellRangeImg(t){var e,i,r,n;let{scrollTop:s,scrollLeft:l}=this,a=Math.min(t.start.col,t.end.col),o=Math.min(t.start.row,t.end.row),h=Math.max(t.start.col,t.end.col),u=Math.max(t.start.row,t.end.row),d=this.cellIsInVisualView(a,o),c=this.cellIsInVisualView(h,u);d&&c||this.scrollToCell({col:a,row:o});let p=this.getCellRangeRelativeRect({start:{col:a,row:o},end:{col:h,row:u}});(null==(i=null==(e=this.stateManager.select)?void 0:e.ranges)?void 0:i.length)>0&&e6(this.scenegraph);let{col:g,row:f}=this.stateManager.hover.cellPos;this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.renderSceneGraph();let m=this.scenegraph.stage.toCanvas(!1,(new iz.FB).set(p.left+this.tableX+1,p.top+this.tableY+1,p.right+this.tableX,p.bottom+this.tableY)).toDataURL();return d&&c||(this.setScrollTop(s),this.setScrollLeft(l)),(null==(n=null==(r=this.stateManager.select)?void 0:r.ranges)?void 0:n.length)>0&&e8(this.scenegraph),this.stateManager.updateHoverPos(g,f),m}exportCanvas(){return this.scenegraph.stage.toCanvas()}getImageBuffer(t="image/png"){if("node"!==this.options.mode)return;this.render();let e=this.scenegraph.stage;if(e){let i=this.tableX+this.getAllColsWidth(),r=this.tableY+this.getAllRowsHeight();return(this.internalProps.legends&&this.internalProps.legends.forEach(t=>{"right"===t.orient?i=Math.max(i,t.legendComponent.globalAABBBounds.x2):"bottom"===t.orient&&(r=Math.max(r,t.legendComponent.globalAABBBounds.y2))}),this.internalProps.title&&("right"===this.internalProps.title._titleOption.orient?i=Math.max(i,this.internalProps.title.getComponentGraphic().globalAABBBounds.x2):"bottom"===this.internalProps.title._titleOption.orient&&(r=Math.max(r,this.internalProps.title.getComponentGraphic().globalAABBBounds.y2))),i>=this.canvasWidth&&r>=this.canvasHeight)?(e.render(),e.window.getImageBuffer(t)):this.scenegraph.stage.toCanvas(!1,(new iz.FB).set(0,0,Math.min(this.canvasWidth,i),Math.min(this.canvasHeight,r))).toBuffer(t)}return null}getBodyIndexByTableIndex(t,e){return{col:t-this.rowHeaderLevelCount-this.leftRowSeriesNumberCount,row:e-this.columnHeaderLevelCount}}getTableIndexByBodyIndex(t,e){return{col:t+this.rowHeaderLevelCount+this.leftRowSeriesNumberCount,row:e+this.columnHeaderLevelCount}}onVChartEvent(t,e,i){this._chartEventMap[t]||(this._chartEventMap[t]=[]),"function"==typeof e?this._chartEventMap[t].push({callback:e}):this._chartEventMap[t].push({callback:i,query:e})}offVChartEvent(t,e){this._chartEventMap[t]&&(this._chartEventMap[t]=e?this._chartEventMap[t].filter(t=>t.callback!==e):[])}_bindChartEvent(t){if(t)for(let e in this._chartEventMap)(this._chartEventMap[e]||[]).forEach(i=>{i.query?t.on(e,i.query,i.callback):t.on(e,i.callback)})}changeRecordOrder(t,e){}hasCustomCellStyle(t){var e;return null==(e=this.customCellStylePlugin)?void 0:e.hasCustomCellStyle(t)}registerCustomCellStyle(t,e){var i;null==(i=this.customCellStylePlugin)||i.registerCustomCellStyle(t,e)}arrangeCustomCellStyle(t,e,i){var r;null==(r=this.customCellStylePlugin)||r.arrangeCustomCellStyle(t,e,i)}isSeriesNumber(t,e){return this.internalProps.layoutMap.isSeriesNumber(t,e)}isHasSeriesNumber(){var t;return(null==(t=this.internalProps.layoutMap)?void 0:t.leftRowSeriesNumberColumnCount)>0}get leftRowSeriesNumberCount(){var t,e;return null!=(e=null==(t=this.internalProps.layoutMap)?void 0:t.leftRowSeriesNumberColumnCount)?e:0}setMinMaxLimitWidth(t=!1){var e,i;let r=this.internalProps;for(let n=0;n<r.layoutMap.columnWidths.length;n++){if(this.internalProps._widthResizedColMap.has(n))continue;let{width:s,minWidth:l,maxWidth:a}=null!=(i=null==(e=r.layoutMap.columnWidths)?void 0:e[n])?i:{};t&&s&&("string"==typeof s&&"auto"!==s||"number"==typeof s&&s>0)&&this._setColWidth(n,s),l&&("number"==typeof l&&l>0||"string"==typeof l)&&this.setMinColWidth(n,l),a&&("number"==typeof a&&a>0||"string"==typeof a)&&this.setMaxColWidth(n,a)}}setSortedIndexMap(t,e){var i;null==(i=this.dataSource)||i.setSortedIndexMap(t,e)}checkReactCustomLayout(){this.reactCustomLayout||(this.reactCustomLayout=new rT.Z(this))}get bodyDomContainer(){return this.internalProps.bodyDomContainer}get headerDomContainer(){return this.internalProps.headerDomContainer}get frozenBodyDomContainer(){return this.internalProps.frozenBodyDomContainer}get frozenHeaderDomContainer(){return this.internalProps.frozenHeaderDomContainer}get rightFrozenBodyDomContainer(){return this.internalProps.rightFrozenBodyDomContainer}get rightFrozenHeaderDomContainer(){return this.internalProps.rightFrozenHeaderDomContainer}get frozenBottomDomContainer(){return this.internalProps.frozenBottomDomContainer}get bottomDomContainer(){return this.internalProps.bottomDomContainer}get rightFrozenBottomDomContainer(){return this.internalProps.rightFrozenBottomDomContainer}showMoverLine(t,e){this.scenegraph.component.showMoveCol(t,e,0),this.scenegraph.renderSceneGraph()}hideMoverLine(t,e){this.scenegraph.component.hideMoveCol(),this.scenegraph.renderSceneGraph()}disableScroll(){this.eventManager.disableScroll()}enableScroll(){this.eventManager.enableScroll()}getGroupTitleLevel(t,e){}scrollToRow(t,e){e?this.animationManager.scrollTo({row:t},e):this.scrollToCell({row:t})}scrollToCol(t,e){e?this.animationManager.scrollTo({col:t},e):this.scrollToCell({col:t})}scrollToCell(t,e){if(e)return void this.animationManager.scrollTo(t,e);let i=this.getDrawRange();if((0,y.Z)(t.col)&&t.col>=this.frozenColCount){let e=this.getFrozenColsWidth(),r=this.getColsWidth(0,t.col-1);this.scrollLeft=Math.min(r-e,this.getAllColsWidth()-i.width)}if((0,y.Z)(t.row)&&t.row>=this.frozenRowCount){let e=this.getFrozenRowsHeight(),r=this.getRowsHeight(0,t.row-1);this.scrollTop=Math.min(r-e,this.getAllRowsHeight()-i.height)}this.render()}checkHasColumnAutoWidth(){return(0,Z.MO)(this)}get containerFit(){return this._containerFit}set containerFit(t){var e,i;this._containerFit="boolean"==typeof t?{width:t,height:t}:t&&"object"==typeof t?{width:null==(e=t.width)||e,height:null==(i=t.height)||i}:{width:!1,height:!1}}}},99506:function(t,e,i){"use strict";i.d(e,{B:()=>r});let r={CLICK_CELL:"click_cell",DBLCLICK_CELL:"dblclick_cell",MOUSEDOWN_CELL:"mousedown_cell",MOUSEUP_CELL:"mouseup_cell",SELECTED_CELL:"selected_cell",SELECTED_CLEAR:"selected_clear",BEFORE_KEYDOWN:"before_keydown",KEYDOWN:"keydown",MOUSEENTER_TABLE:"mouseenter_table",MOUSELEAVE_TABLE:"mouseleave_table",MOUSEDOWN_TABLE:"mousedown_table",MOUSEMOVE_TABLE:"mousemove_table",MOUSEMOVE_CELL:"mousemove_cell",MOUSEENTER_CELL:"mouseenter_cell",MOUSELEAVE_CELL:"mouseleave_cell",CONTEXTMENU_CELL:"contextmenu_cell",CONTEXTMENU_CANVAS:"contextmenu_canvas",RESIZE_COLUMN:"resize_column",RESIZE_COLUMN_END:"resize_column_end",RESIZE_ROW:"resize_row",RESIZE_ROW_END:"resize_row_end",CHANGE_HEADER_POSITION_START:"change_header_position_start",CHANGE_HEADER_POSITION:"change_header_position",CHANGING_HEADER_POSITION:"changing_header_position",CHANGE_HEADER_POSITION_FAIL:"change_header_position_fail",SORT_CLICK:"sort_click",AFTER_SORT:"after_sort",FREEZE_CLICK:"freeze_click",SCROLL:"scroll",CAN_SCROLL:"can_scroll",SCROLL_HORIZONTAL_END:"scroll_horizontal_end",SCROLL_VERTICAL_END:"scroll_vertical_end",DROPDOWN_MENU_CLICK:"dropdown_menu_click",MOUSEOVER_CHART_SYMBOL:"mouseover_chart_symbol",DRAG_SELECT_END:"drag_select_end",SELECTED_CHANGED:"selected_changed",COPY_DATA:"copy_data",DROPDOWN_ICON_CLICK:"dropdown_icon_click",DROPDOWN_MENU_CLEAR:"dropdown_menu_clear",TREE_HIERARCHY_STATE_CHANGE:"tree_hierarchy_state_change",SHOW_MENU:"show_menu",HIDE_MENU:"hide_menu",ICON_CLICK:"icon_click",LEGEND_ITEM_CLICK:"legend_item_click",LEGEND_ITEM_HOVER:"legend_item_hover",LEGEND_ITEM_UNHOVER:"legend_item_unHover",LEGEND_CHANGE:"legend_change",MOUSEENTER_AXIS:"mouseenter_axis",MOUSELEAVE_AXIS:"mouseleave_axis",CHECKBOX_STATE_CHANGE:"checkbox_state_change",RADIO_STATE_CHANGE:"radio_state_change",SWITCH_STATE_CHANGE:"switch_state_change",BEFORE_SET_SIZE:"before_set_size",BEFORE_INIT:"before_init",BEFORE_UPDATE_OPTION:"before_update_option",AFTER_RENDER:"after_render",INITIALIZED:"initialized",UPDATED:"updated",AFTER_UPDATE_CELL_CONTENT_WIDTH:"after_update_cell_content_width",AFTER_UPDATE_SELECT_BORDER_HEIGHT:"after_update_select_border_height",CHANGE_CELL_VALUE:"change_cell_value",DRAG_FILL_HANDLE_END:"drag_fill_handle_end",MOUSEDOWN_FILL_HANDLE:"mousedown_fill_handle",DBLCLICK_FILL_HANDLE:"dblclick_fill_handle",EMPTY_TIP_CLICK:"empty_tip_click",EMPTY_TIP_DBLCLICK:"empty_tip_dblclick",BUTTON_CLICK:"button_click",BEFORE_CACHE_CHART_IMAGE:"before_cache_chart_image",PASTED_DATA:"pasted_data",PLUGIN_EVENT:"plugin_event",ADD_RECORD:"add_record",DELETE_RECORD:"delete_record",UPDATE_RECORD:"update_record",ADD_COLUMN:"add_column",DELETE_COLUMN:"delete_column"}},13844:function(t,e,i){"use strict";i.d(e,{F:()=>r});class r{static registerComponent(t,e){r._components[t]=e}static getComponent(t){return r._components[t]}static registerFunction(t,e){r._functions[t]=e}static getFunction(t){return r._functions[t]}static registerCellType(t,e){r._cellTypes[t]=e}static getCellType(t){return r._cellTypes[t]}}r._components={},r._functions={},r._cellTypes={}},59885:function(t,e,i){"use strict";i.d(e,{bW:()=>k,FJ:()=>A,x6:()=>y,sQ:()=>b,qf:()=>_,_I:()=>c,ke:()=>v,mP:()=>f,RT:()=>w,gX:()=>p,AS:()=>x,MO:()=>T,VN:()=>C,rQ:()=>M,xv:()=>S});var r=i(83922),n=i(56162),s=i(78596),l=i.n(s),a=i(14828),o=i(28132),h=i(16423),u=i(43735),d=i(18585);function c(t,e="vtable"){var i,r;let n=document.createElement("div");n.setAttribute("tabindex","0"),n.classList.add(e),n.style.outline="none",n.style.margin=`${t.top}px ${t.right}px ${t.bottom}px ${t.left}px`;let s=(n.offsetWidth||(null==(i=n.parentElement)?void 0:i.offsetWidth)||1)-1,l=(n.offsetHeight||(null==(r=n.parentElement)?void 0:r.offsetHeight)||1)-1;return n.style.width=s&&s-t.left-t.right+"px"||"0px",n.style.height=l&&l-t.top-t.bottom+"px"||"0px",n}function p(t,e){var i,r;t.style.margin=`${e.top}px ${e.right}px ${e.bottom}px ${e.left}px`;let n=(t.offsetWidth||(null==(i=t.parentElement)?void 0:i.offsetWidth)||1)-1,s=(t.offsetHeight||(null==(r=t.parentElement)?void 0:r.offsetHeight)||1)-1;t.style.width=n&&n-e.left-e.right+"px"||"0px",t.style.height=s&&s-e.top-e.bottom+"px"||"0px"}function g(t,e){let{dataSourceEventIds:i}=t.internalProps;i&&i.forEach(e=>t.internalProps.handler.off(e)),e(t),t.internalProps.dataSourceEventIds=[t.internalProps.handler.on(t.internalProps.dataSource,r.o2.EVENT_TYPE.CHANGE_ORDER,()=>{t.dataSource.hierarchyExpandLevel&&t.refreshRowColCount(),t.render()})]}function f(t,e=[]){g(t,()=>{var i;t.internalProps.records=e;let r=t.internalProps.layoutMap.rowHierarchyType;(0,u.Z)(null==(i=t.internalProps.dataConfig)?void 0:i.groupByRules)&&(r="tree"),t.pluginManager.getPluginByName("Master Detail Plugin")&&(r="grid");let s=t.internalProps.dataSource=n.Z.ofArray(e,t.internalProps.dataConfig,t.pagination,t.internalProps.columns,r,m(t));t.addReleaseObj(s)})}function m(t){var e;return t.options.hierarchyExpandLevel?t.options.hierarchyExpandLevel:t.internalProps.groupBy?1/0:(null==(e=t._hasHierarchyTreeHeader)?void 0:e.call(t))?1:void 0}function y(t,e){g(t,()=>{t.internalProps.dataSource&&t.internalProps.releaseList.forEach(e=>{e instanceof r.o2&&(e.release(),t.internalProps.releaseList.splice(t.internalProps.releaseList.indexOf(e),1))}),e?e instanceof r.o2?(t.internalProps.dataSource=e,t.internalProps.dataSource.supplementConfig(t.pagination,t.options.columns,t.internalProps.layoutMap.rowHierarchyType,m(t))):t.internalProps.dataSource=new n.Z(e):t.internalProps.dataSource=r.o2.EMPTY,t.addReleaseObj(t.internalProps.dataSource),t.internalProps.records=null})}function v(t,e){if(!t.internalProps.frozenRowCount)return null;let{scrollTop:i}=t,r=t.internalProps.frozenRowCount;for(let n=0;n<r;n++){let r=t.getRowHeight(n),s=i+r;if(s>e)return{top:i,row:n,bottom:s,height:r};i=s}return null}function b(t,e){if(!t.internalProps.frozenColCount)return null;let{scrollLeft:i}=t,r=t.internalProps.frozenColCount;for(let n=0;n<r;n++){let r=t.getColWidth(n),s=i+r;if(s>e)return{left:i,col:n,right:s,width:r};i=s}return null}function _(t,e){return Math.round(h.aR(e,t.internalProps.calcWidthContext))}function x(t,e){return t?t.min&&t.min>e?t.min:t.max&&t.max<e?t.max:e:e}function C(t){let e=0,i=0;t.frozenColCount>0&&(e=t.getFrozenColsWidth()),t.rightFrozenColCount>0&&(i=t.getRightFrozenColsWidth());let r=0,n=0;return t.frozenRowCount>0&&(r=t.getFrozenRowsHeight()),t.bottomFrozenRowCount>0&&(n=t.getBottomFrozenRowsHeight()),new o.U(t.scrollLeft+e,t.scrollTop+r,t.tableNoFrameWidth-e-i,t.tableNoFrameHeight-r-n)}function w(t,e,i,r,n,s=!0){let o,h,u,c,p,g=(0,a.u)(n("padding",t,i,r,e)),f=n("bgColor",t,i,r,e),m=n("font",t,i,r,e);if(m){let{family:t,size:e,weight:i,style:r,variant:n}=l()(m);o=t.join(" "),h=e,u=i,c=r,c=n}else o=n("fontFamily",t,i,r,e),h=n("fontSize",t,i,r,e),u=n("fontWeight",t,i,r,e),c=n("fontStyle",t,i,r,e),p=n("fontVariant",t,i,r,e);let y=n("textAlign",t,i,r,e),v=n("textBaseline",t,i,r,e),b=n("color",t,i,r,e),_=n("strokeColor",t,i,r,e),x=n("lineHeight",t,i,r,e),C=n("underline",t,i,r,e),S=n("underlineDash",t,i,r,e),A=n("underlineOffset",t,i,r,e),M=n("lineThrough",t,i,r,e),k=Math.max(1,Math.floor(h/10)),T=n("textOverflow",t,i,r,e),R=n("borderColor",t,i,r,e),B=n("borderLineWidth",t,i,r,e),P=n("borderLineDash",t,i,r,e),E=n("marked",t,i,r,e),I=n("cursor",t,i,r,e),L=!(g&&f&&m&&y&&v&&b&&T&&R&&B&&P&&"boolean"==typeof C&&"boolean"==typeof M&&"boolean"==typeof E);if(!s)return{hasFunctionPros:L};let F={text:{fontFamily:o,fontSize:h,fontWeight:u,fontStyle:c,fontVariant:p,fill:b,stroke:null!=_&&_,textAlign:y,textBaseline:v,lineHeight:null!=x?x:h,underline:C?k:void 0,underlineDash:S,underlineOffset:A,lineThrough:M?k:void 0,ellipsis:"clip"===T?"":"ellipsis"===T?"...":(0,d.Z)(T)?T:void 0},group:{fill:f,lineDash:P,lineWidth:B,stroke:R,cursor:"auto"===I||"default"===I?void 0:I},_vtable:{padding:g,marked:E}};if(Array.isArray(B)&&(F.group.strokeArrayWidth=(0,a.u)(B)),Array.isArray(R)){let t=(0,a.u)(R);F.group.stroke=!t.every(t=>!t)&&t,F.group.strokeArrayColor=(0,a.u)(R)}return{theme:F,hasFunctionPros:L}}function S(t,e,i){let r=i.theme.frameStyle.cornerRadius;if(i.theme.cellInnerBorder){if(Array.isArray(r)){let n=[0,0,0,0];return 0===t&&0===e&&(n[0]=r[0]),t===i.colCount-1&&0===e&&(n[1]=r[1]),0===t&&e===i.rowCount-1&&(n[3]=r[3]),t===i.colCount-1&&e===i.rowCount-1&&(n[2]=r[2]),n}if(r){let n=[0,0,0,0];return 0===t&&0===e&&(n[0]=r),t===i.colCount-1&&0===e&&(n[1]=r),0===t&&e===i.rowCount-1&&(n[3]=r),t===i.colCount-1&&e===i.rowCount-1&&(n[2]=r),n}}return 0}function A(t){var e,i,r,n;if(t){if(Array.isArray(t)){let s;for(let l=0;l<t.length;l++)if(t[l].autoRange){if("sum"===t[l].y||"sum"===t[l].x||"sum"===t[l].y1||"sum"===t[l].x1)return"sum";"max"!==t[l].y&&"max"!==t[l].x&&"max"!==t[l].y1&&"max"!==t[l].x1||(s="max"),"number"==typeof t[l].y&&"number"==typeof(null!=s?s:0)&&(s=Math.max(null!=(e=s)?e:0,t[l].y)),"number"==typeof t[l].x&&"number"==typeof(null!=s?s:0)&&(s=Math.max(null!=(i=s)?i:0,t[l].x)),"number"==typeof t[l].y1&&"number"==typeof(null!=s?s:0)&&(s=Math.max(null!=(r=s)?r:0,t[l].y1)),"number"==typeof t[l].x1&&"number"==typeof(null!=s?s:0)&&(s=Math.max(null!=(n=s)?n:0,t[l].x1))}return s}if(t.autoRange){if("sum"===t.y||"sum"===t.x||"sum"===t.y1||"sum"===t.x1)return"sum";if("max"===t.y||"max"===t.x||"max"===t.y1||"max"===t.x1)return"max";if("number"==typeof t.y)return t.y;if("number"==typeof t.x)return t.x;if("number"==typeof t.y1)return t.y1;if("number"==typeof t.x1)return t.x1}}}function M(t){for(let e=0;e<t.internalProps.columns.length;e++){let i=t.internalProps.columns[e];if(i.aggregation);else if(t.options.aggregation){let r;if(r="function"==typeof t.options.aggregation?t.options.aggregation({col:e,field:i.field}):t.options.aggregation)if(Array.isArray(r)){let t=[];r.forEach(e=>{t.push(Object.assign({showOnTop:!1},e))}),i.aggregation=t}else i.aggregation=Object.assign({showOnTop:!1},r)}}}function k(t){for(let e=0;e<t.length;e++)if(t[e].aggregation)return!0;return!1}function T(t){if("autoWidth"===t.options.widthMode||"auto"===t.options.defaultHeaderColWidth||Array.isArray(t.options.defaultHeaderColWidth)&&t.options.defaultHeaderColWidth.includes("auto"))return!0;let e=t.internalProps.layoutMap.columnObjects;for(let t=0;t<e.length;t++)if("auto"===e[t].width)return!0;return!1}},91254:function(t,e,i){"use strict";i.d(e,{k:()=>s});var r=i(70506),n=i(43735);function s(t){return(0,r.Z)(t)?t:(0,n.Z)(t)?(e,i)=>t.find(t=>t.range.start.col<=e&&t.range.end.col>=e&&t.range.start.row<=i&&t.range.end.row>=i):void 0}},56162:function(t,e,i){"use strict";i.d(e,{Z:()=>d});var r=i(43735),n=i(58977),s=i(18585),l=i(19465),a=i(20595),o=i(83922),h=i(13546),u=i.n(h);class d extends o.o2{static get EVENT_TYPE(){return o.o2.EVENT_TYPE}static ofArray(t,e,i,r,n,s){return new d({get:e=>t[e],length:t.length,records:t},e,i,r,n,s)}constructor(t,e,i,n,s,l){let a;(0,r.Z)(null==e?void 0:e.groupByRules)&&(a=!0),super(t,e,i,n,s,l),this._isGrouped=a,this._recordCache=[],this._fieldCache={}}getOriginalRecord(t){return(0,n.Z)(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:super.getOriginalRecord(t)}getRawRecord(t){var e,i,r,l;let a,h;if(this._isGrouped){if(a=this.getOriginRecordIndexForGroup(t),(0,s.Z)(a)&&(null==(e=this.beforeChangedRecordsMap)?void 0:e.has(a.toString())))return null==(i=this.beforeChangedRecordsMap)?void 0:i.get(a.toString())}else if(null==(r=this.beforeChangedRecordsMap)?void 0:r.has(t.toString()))return null==(l=this.beforeChangedRecordsMap)?void 0:l.get(t.toString());return(0,n.Z)(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:(h=this.dataSourceObj.records?Array.isArray(t)?(0,o.UN)(this.records,t):this.records[t]:this._get(t),(0,o.NA)(h,e=>{this.recordPromiseCallBack(t,e)}))}getOriginalField(t,e,i,r,n){let s=this._fieldCache&&this._fieldCache[t];if(s){let t=s.get(e);if(t)return t}return super.getOriginalField(t,e,i,r,n)}clearCache(){this._recordCache&&(this._recordCache=[]),this._fieldCache&&(this._fieldCache={})}fieldPromiseCallBack(t,e,i){var r;r=this._fieldCache,(r[t]||(r[t]=new Map)).set(e,i)}recordPromiseCallBack(t,e){this._recordCache&&(this._recordCache[t]=e)}get records(){return Array.isArray(this._recordCache)&&this._recordCache.length>0?this._recordCache:super.records}release(){var t;null==(t=super.release)||t.call(this),this._recordCache=null,this._fieldCache=null}_generateFieldAggragations(){var t;if(super._generateFieldAggragations(),(0,r.Z)(null==(t=this.dataConfig)?void 0:t.groupByRules)){let t=this.dataConfig.groupByRules;this.groupAggregator=new this.registedAggregators[a.E.CUSTOM]({field:"",aggregationFun:(e,i,r)=>{let n=new Map,l=[];for(let e=0;e<i.length;e++)!function t(e,i,r,n,l){let a=n[l];if(!(0,s.Z)(a))return void i.push(e);let o=u()(e,a);if(void 0!==o){if(r.has(o)){let s=r.get(o);return t(e,i[s].children,i[s].map,n,l+1)}return r.set(o,i.length),i.push({vtableMerge:!0,vtableMergeName:o,children:[],map:new Map}),t(e,i[i.length-1].children,i[i.length-1].map,n,l+1)}}(i[e],l,n,t,0);return l}}),this.fieldAggregators.push(this.groupAggregator)}}processRecords(t){var e;let i=super.processRecords(t);return(null==(e=this.groupAggregator)?void 0:e.value())||i}getGroupLength(){var t,e,i;return null!=(i=null==(e=null==(t=this.dataConfig)?void 0:t.groupByRules)?void 0:e.length)?i:0}updateGroup(){var t,e,i;this.clearCache();let n=this.source;this._source=this.processRecords(null!=(e=null==(t=this.dataSourceObj)?void 0:t.records)?e:this.dataSourceObj),n&&function t(e,i,n,l){if(!n){n=new Map;for(let t=0;t<e.length;t++){let i=e[t];i.vtableMerge&&n.set(i.vtableMergeName,t)}}if(!l){l=new Map;for(let t=0;t<i.length;t++){let e=i[t];e.vtableMerge&&l.set(e.vtableMergeName,t)}}for(let n=0;n<e.length;n++){let a=e[n],o=i[l.get(a.vtableMergeName)];(0,s.Z)(o)&&(o.hierarchyState=e[n].hierarchyState),(0,r.Z)(null==a?void 0:a.children)&&(0,r.Z)(null==o?void 0:o.children)&&0!==a.map.size&&0!==o.map.size&&t(a.children,o.children,a.map,o.map)}}(n,this.source),this.sourceLength=(null==(i=this.source)?void 0:i.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this.sourceLength},(t,e)=>e),this.userPagination||(this.pagination.perPageCount=this.sourceLength,this.pagination.totalCount=this.sourceLength),this.initTreeHierarchyState(),this.updatePagerData()}getOriginRecordIndexForGroup(t){let e=this.getOriginalRecord(t);if((0,s.Z)(e)&&!(e.children&&e.children.length>0)){for(let t=0;t<this.dataSourceObj.records.length;t++)if(this.dataSourceObj.records[t]===e)return t}}addRecordsForGroup(t,e){if(!(0,r.Z)(t)||0===t.length)return;let i=this.getOriginRecordIndexForGroup(e);(void 0===i||i>this.dataSourceObj.records)&&(i=this.dataSourceObj.records.length),this.dataSourceObj.records.splice(i,0,...t),this.adjustBeforeChangedRecordsMap(i,t.length),this.updateGroup()}deleteRecordsForGroup(t){if(!(0,r.Z)(t)||0===t.length)return;let e=(0,o.pY)(t,-1);for(let t=0;t<e.length;t++){let i=e[t];if((0,n.Z)(i)&&(i>=this.sourceLength||i<0))continue;let r=this.getOriginRecordIndexForGroup(i);this.beforeChangedRecordsMap.delete(r.toString()),this.dataSourceObj.records.splice(r,1),this.sourceLength-=1,this.adjustBeforeChangedRecordsMap(r,1,"delete")}this.updateGroup()}updateRecordsForGroup(t,e){for(let i=0;i<e.length;i++){let r=e[i];if((0,n.Z)(r)&&(r>=this.sourceLength||r<0))continue;let s=this.getOriginRecordIndexForGroup(r);this.beforeChangedRecordsMap.delete(s.toString()),this.dataSourceObj.records[s]=t[i]}this.updateGroup()}addRecordsForTree(t,e){if((0,r.Z)(t)&&0!==t.length){if(this.adjustBeforeChangedRecordsMap(e,t.length),(0,n.Z)(e))this.dataSourceObj.records.splice(e,0,...t);else{let i=[...e],r=i.pop(),n=this.getOriginalRecord(i);n.children?n.children.splice(r,0,...t):n.children=t}this.initTreeHierarchyState(),this.updatePagination()}}deleteRecordsForTree(t){if(!(0,r.Z)(t)||0===t.length)return[];let e=(0,o.pY)(t,-1),i=[];for(let t=0;t<e.length;t++){let r=e[t];if(!(0,n.Z)(r)||!(r>=this.sourceLength||r<0)){if(this.beforeChangedRecordsMap.delete(r.toString()),(0,n.Z)(r))this.dataSourceObj.records.splice(r,1);else{let t=[...r],e=t.pop();this.getOriginalRecord(t).children.splice(e,1)}this.adjustBeforeChangedRecordsMap(r,1,"delete"),i.push(r)}}return this.initTreeHierarchyState(),this.updatePagination(),i}updateRecordsForTree(t,e){for(let i=0;i<e.length;i++){let r=e[i],s=t[i];if(!(0,n.Z)(r)||!(r>=this.sourceLength||r<0))if(this.beforeChangedRecordsMap.delete(r.toString()),(0,n.Z)(r))this.dataSourceObj.records.splice(r,1,s);else{let t=[...r],e=t.pop();this.getOriginalRecord(t).children.splice(e,1,s)}}this.initTreeHierarchyState(),this.updatePagerData()}adjustBeforeChangedRecordsMap(t,e,i="add"){if("tree"===this.rowHierarchyType){let r;r=(0,n.Z)(t)?[t]:t;let s=[];this.beforeChangedRecordsMap.forEach((t,n)=>{var l,a;let o=n.split(","),h=Math.max(o.length,r.length);for(let u=0;u<h;u++){let h=null!=(l=r[u])?l:-1,d=null!=(a=Number(o[u]))?a:-1;if(h<d||h===d&&u===o.length-1&&u===r.length-1)return o[u]=(d+("add"===i?e:-e)).toString(),void s.push({originKey:n,targetKey:o.toString(),value:t})}}),s.forEach(({originKey:t,targetKey:e,value:i})=>{this.beforeChangedRecordsMap.delete(t),this.beforeChangedRecordsMap.set(e,i)})}else super.adjustBeforeChangedRecordsMap(t,e,i)}cacheBeforeChangedRecord(t,e){var i;let r=this.getOriginalRecord(t);e.internalProps.groupBy&&(t=this.getOriginRecordIndexForGroup(t)),this.beforeChangedRecordsMap.has(t.toString())||this.beforeChangedRecordsMap.set(t.toString(),null!=(i=(0,l.Z)(r,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))?i:{})}getGroupSeriesNumber(t){let e=this.dataSource.currentIndexedData[t],i=e.length-1,r=e.length,s=1;for(;r>i;s++){let e=this.dataSource.currentIndexedData[t-s];r=(0,n.Z)(e)?1:e.length}return s-1}}},83922:function(t,e,i){"use strict";i.d(e,{o2:()=>v,UN:()=>b,pY:()=>_,NA:()=>f});var r=i(73664),n=i(20595),s=i(57657),l=i(80747),a=i(12588),o=i(18585),h=i(47e3),u=i(50071),d=i(19465),c=i(58977),p=i(39940);let g={SOURCE_LENGTH_UPDATE:"source_length_update",CHANGE_ORDER:"change_order"};function f(t,e){let i=(0,s.vi)(t);if((0,s.tI)(i)){let t=i.then(t=>(e(t),t));return e(t),t}return i}function m(t,e,i,r,n,l){var u;if(null==t)return;if((0,s.tI)(t))return t.then(t=>m(t,e,i,r,n,l));let d=(u=e,!(s.j6.isObject(u)&&(0,o.Z)(u.get)&&(0,o.Z)(u.set))&&1)?e:e.get;if((void 0===d||""===d)&&Array.isArray(t))return t[i-n.leftRowSeriesNumberCount];if((0,h.Z)(t)&&d in t)return f(t[d],l);if("function"==typeof d)return f(d(t,i,r,n),l);if(Array.isArray(d))return f((0,a.MU)(t,[...d]),l);let c=`${d}`.split(".");return c.length<=1?f(t[d],l):f((0,s.vl)(t,(t,e)=>m(t,e,i,r,n,s.nO),...c),l)}function y(t,e){if(!t)return e;let i=t[e];return(0,o.Z)(i)?i:e}class v extends l.R{static get EVENT_TYPE(){return g}constructor(t,e,i,r,n,s){var l;super(),this.addRecordRule="Object",this.currentIndexedData=[],this.hierarchyExpandLevel=0,this.hasHierarchyStateExpand=!1,this.beforeChangedRecordsMap=new Map,this.registedAggregators={},this.rowHierarchyType="grid",this.fieldAggregators=[],this.addRecordRule=(null==e?void 0:e.addRecordRule)||"Object",this.registerAggregators(),this.dataSourceObj=t,this.dataConfig=e,this._get=null==t?void 0:t.get,this.columns=r,this._source=(null==t?void 0:t.records)?this.processRecords(null==t?void 0:t.records):t,this._sourceLength=(null==(l=this._source)?void 0:l.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=i,this.pagination=i||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},s>=1&&(this.hierarchyExpandLevel=s),this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e),"tree"===n&&this.initTreeHierarchyState(),this.rowHierarchyType=n,this.updatePagerData()}initTreeHierarchyState(){var t,e;this._sourceLength=(null==(t=this._source)?void 0:t.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e);let i=this._sourceLength;for(let t=0;t<i;t++){let n=this.currentIndexedData[t],s=this.getOriginalRecord(n);if(!s)continue;let l=null!=(e=s.filteredChildren)?e:s.children;if((null==l?void 0:l.length)>0){if(this.hierarchyExpandLevel>1?s.hierarchyState||(s.hierarchyState=r.g.expand):s.hierarchyState||(s.hierarchyState=r.g.collapse),this.hasHierarchyStateExpand=!0,s.hierarchyState===r.g.collapse)continue;let e=this.initChildrenNodeHierarchy(n,this.hierarchyExpandLevel,2,s);t+=e,i+=e}else!0!==s.children||s.hierarchyState||(s.hierarchyState=r.g.collapse)}}supplementConfig(t,e,i,r){var n;this.columns=e,this._sourceLength=(null==(n=this._source)?void 0:n.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=t,this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},r>=1&&(this.hierarchyExpandLevel=r),this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e),"tree"===i&&this.initTreeHierarchyState(),this.rowHierarchyType=i,this.updatePagerData()}registerAggregator(t,e){this.registedAggregators[t]=e}registerAggregators(){this.registerAggregator(n.E.RECORD,p.hT),this.registerAggregator(n.E.SUM,p.__),this.registerAggregator(n.E.COUNT,p.ZP),this.registerAggregator(n.E.MAX,p.Fn),this.registerAggregator(n.E.MIN,p.NF),this.registerAggregator(n.E.AVG,p.ky),this.registerAggregator(n.E.NONE,p.ld),this.registerAggregator(n.E.CUSTOM,p.Js)}updateColumns(t){this.columns=t}_generateFieldAggragations(){let t=this.columns;this.fieldAggregators=[];let e=t=>{delete t.vtable_aggregator;let e=t.field,i=t.aggregation;if(i)if(Array.isArray(i))for(let r of i){let i=new this.registedAggregators[r.aggregationType]({field:e,formatFun:r.formatFun,isRecord:!0,aggregationFun:r.aggregationFun});this.fieldAggregators.push(i),t.vtable_aggregator||(t.vtable_aggregator=[]),t.vtable_aggregator.push(i)}else{let r=new this.registedAggregators[i.aggregationType]({field:e,formatFun:i.formatFun,isRecord:!0,aggregationFun:i.aggregationFun});this.fieldAggregators.push(r),t.vtable_aggregator=r}},i=t=>{if(t&&0!==t.length)for(let r of t)e(r),r.columns&&i(r.columns)};i(t)}processRecords(t){var e,i,r,n,s,l,a,o;this._generateFieldAggragations();let h=[],u=this.fieldAggregators.length>=1;if((null==(i=null==(e=this.dataConfig)?void 0:e.filterRules)?void 0:i.length)>=1||(null==(r=this.lastFilterRules)?void 0:r.length)>=1||u){for(let e=0,i=t.length;e<i;e++){let i=t[e];null!=i&&((null==(s=null==(n=this.dataConfig)?void 0:n.filterRules)?void 0:s.length)>=1?this.filterRecord(i)&&(h.push(i),"tree"===this.rowHierarchyType&&i.children&&(i.filteredChildren=this.filteredChildren(i.children)),u&&this.processRecord(i)):((null==(l=this.lastFilterRules)?void 0:l.length)>=1&&this.clearFilteredChildren(i),u&&this.processRecord(i)))}if((null==(o=null==(a=this.dataConfig)?void 0:a.filterRules)?void 0:o.length)>=1)return h}return t}filteredChildren(t){let e=[];for(let i=0,r=t.length;i<r;i++){let r=t[i];this.filterRecord(r)&&(e.push(r),r.children&&(r.filteredChildren=this.filteredChildren(r.children)))}return e}processRecord(t){for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].push(t)}initChildrenNodeHierarchy(t,e,i,n){var s,l,a;let o=0,h=n.filteredChildren?n.filteredChildren.length:null!=(l=null==(s=n.children)?void 0:s.length)?l:0;for(let s=0;s<h;s++){(i<=e||n.hierarchyState===r.g.expand)&&(o+=1);let l=n.filteredChildren?n.filteredChildren[s]:n.children[s],h=Array.isArray(t)?t.concat(s):[t,s];(i<=e||n.hierarchyState===r.g.expand)&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+o,0,h),(l.filteredChildren?l.filteredChildren.length>0:(null==(a=l.children)?void 0:a.length)>0)&&(i<e||l.hierarchyState===r.g.expand?(l.hierarchyState||(l.hierarchyState=r.g.expand),this.hasHierarchyStateExpand=!0):l.hierarchyState||(l.hierarchyState=r.g.collapse)),l.hierarchyState===r.g.expand&&(o+=this.initChildrenNodeHierarchy(h,e,i+1,l)),!0!==l.children||l.hierarchyState||(l.hierarchyState=r.g.collapse)}return o}updatePagination(t){this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},this.updatePagerData()}updatePagerData(){let{currentIndexedData:t}=this,{perPageCount:e,currentPage:i}=this.pagination,r=e*(i||0),n=r+e;if(this._currentPagerIndexedData.length=0,t&&t.length>0){let e=-1;for(let i=0;i<t.length;i++)if((Array.isArray(t[i])&&1===t[i].length||!Array.isArray(t[i]))&&e++,e>=r&&e<n)this._currentPagerIndexedData.push(t[i]);else if(e>=n)break}else if(this._sourceLength>0)throw Error("currentIndexedData should has values!")}getRecordIndexPaths(t){return this._currentPagerIndexedData[t]}get records(){return Array.isArray(this._source)?this._source:[]}get source(){return this._source}get(t){return this.getOriginalRecord(y(this.currentPagerIndexedData,t))}getRaw(t){return this.getRawRecord(y(this.currentPagerIndexedData,t))}getIndexKey(t){return y(this.currentPagerIndexedData,t)}getTableIndex(t){return Array.isArray(t)?"tree"===this.rowHierarchyType?this.currentPagerIndexedData.findIndex(e=>(0,u.h6)(e,t)):this.currentPagerIndexedData.findIndex(e=>e===t[0]):this.currentPagerIndexedData.findIndex(e=>e===t)}getField(t,e,i,r,n){return this.getOriginalField(y(this.currentPagerIndexedData,t),e,i,r,n)}getRawField(t,e,i,r,n){return this.getRawFieldData(y(this.currentPagerIndexedData,t),e,i,r,n)}hasField(t,e){return this.hasOriginalField(y(this.currentPagerIndexedData,t),e)}getHierarchyState(t){var e;let i=this.getOriginalRecord(this.currentPagerIndexedData[t]);if(null==i?void 0:i.hierarchyState){let t=i.hierarchyState;if((null==(e=i.children)?void 0:e.length)>0||!0===i.children)return t}return null}toggleHierarchyState(t,e,i){let n=this.currentIndexedData.slice(0),s=this.getIndexKey(t),l=this.getHierarchyState(t),o=this.getOriginalRecord(s);if(this.clearSortedIndexMap(),l===r.g.collapse)o.hierarchyState=r.g.expand,this.pushChildrenNode(s,r.g.expand,o),this.hasHierarchyStateExpand=!0;else if(l===r.g.expand){let t=(0,a.pr)(s,l,o);this.currentIndexedData.splice(this.currentIndexedData.indexOf(s)+1,t),o.hierarchyState=r.g.collapse}this.updatePagerData();let h=[],u=[];if(l===r.g.collapse){let e=this.currentIndexedData.length-n.length;for(let i=0;i<e;i++)h.push(t+i+1)}else if(l===r.g.expand){let e=n.length-this.currentIndexedData.length;for(let i=0;i<e;i++)u.push(t+i+1)}return{add:h,remove:u}}pushChildrenNode(t,e,i){var n,s;if(!e||e===r.g.collapse||e===r.g.none)return 0;let l=0,a=i.filteredChildren?i.filteredChildren:i.children;if(a){let e=Array.from({length:a.length},(t,e)=>e);null==(n=this.lastSortStates)||n.forEach(i=>{"normal"!==i.order&&function(t,e,i,r,n,s){let l=function(t,e){let i=Array(e);for(let r=0;r<e;r++)i[r]=t(r);return i}(t,i);l.sort((t,e)=>r(s(t),s(e),n));for(let t=0;t<i;t++)e(t,l[t])}(t=>(0,o.Z)(e[t])?e[t]:e[t]=t,(t,i)=>{e[t]=i},a.length,i.orderFn,i.order,e=>this.getOriginalField(Array.isArray(t)?t.concat([e]):[t,e],i.field))});for(let i=0;i<e.length;i++){l+=1;let n=Array.isArray(t)?t.concat([e[i]]):[t,e[i]];this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+l,0,n);let o=this.getOriginalRecord(n);!o.hierarchyState&&(null!=(s=o.filteredChildren)?s:o.children)&&(o.hierarchyState=r.g.collapse),l+=this.pushChildrenNode(n,o.hierarchyState,a[e[i]])}}return l}changeFieldValue(t,e,i,r,n,l){var o;if(null!==i&&e>=0){let n=this.getIndexKey(e);if(this.cacheBeforeChangedRecord(n,l),void 0!==i&&""!==i||(i=r-l.leftRowSeriesNumberCount),"string"==typeof i||"number"==typeof i){let e=null==(o=this.beforeChangedRecordsMap.get(n.toString()))?void 0:o[i],r=this.getOriginalRecord(n),l=t;"number"==typeof e&&(0,a.Zf)(t)&&(l=parseFloat(t)),(0,s.tI)(r)?r.then(t=>{t[i]=l}).catch(t=>{}):r?r[i]=l:(this.records[n]="Array"===this.addRecordRule?[]:{},this.records[n][i]=l)}}}cacheBeforeChangedRecord(t,e){var i;if(!this.beforeChangedRecordsMap.has(t.toString())){let e=this.getOriginalRecord(t);this.beforeChangedRecordsMap.set(t.toString(),null!=(i=(0,d.Z)(e,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))?i:{})}}setRecord(t,e){var i,r;let n=!0;if((null==(r=null==(i=this.dataConfig)?void 0:i.filterRules)?void 0:r.length)>=1&&(this.filterRecord(t)?"tree"===this.rowHierarchyType&&t.children&&(t.filteredChildren=this.filteredChildren(t.children)):n=!1),n&&Array.isArray(this.records)){let i=this.getIndexKey(e);Array.isArray(i)||this.records.splice(i,1,t)}}addRecord(t,e){var i;if(Array.isArray(this.records)){this.records.splice(e,0,t),this.adjustBeforeChangedRecordsMap(e,1),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1;for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].push(t);if("tree"===this.rowHierarchyType&&this.initTreeHierarchyState(),this.userPagination){this.pagination.totalCount=this._sourceLength;let{perPageCount:t,currentPage:i}=this.pagination;e<t*(i||0)+t&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();(null==(i=this.dataSourceObj)?void 0:i.added)&&this.dataSourceObj.added(e,1)}}addRecords(t,e){var i;if(Array.isArray(this.records)){if(Array.isArray(t)){this.records.splice(e,0,...t),this.adjustBeforeChangedRecordsMap(e,t.length);for(let e=0;e<t.length;e++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length;for(let e=0;e<this.fieldAggregators.length;e++)for(let i=0;i<t.length;i++)this.fieldAggregators[e].push(t[i])}if(this.userPagination){this.pagination.totalCount=this._sourceLength;let{perPageCount:t,currentPage:i}=this.pagination;e<t*(i||0)+t&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();(null==(i=this.dataSourceObj)?void 0:i.added)&&this.dataSourceObj.added(e,t.length)}}addRecordForSorted(t){Array.isArray(this.records)&&(this.beforeChangedRecordsMap.clear(),this.records.push(t),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1,this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength))}addRecordsForSorted(t){if(Array.isArray(this.records)){if(this.beforeChangedRecordsMap.clear(),Array.isArray(t)){this.records.push(...t);for(let e=0;e<t.length;e++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length,this.sortedIndexMap.clear()}this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}}adjustBeforeChangedRecordsMap(t,e,i="add"){for(let r=this.beforeChangedRecordsMap.size-1;r>=t;r--){let t=this.beforeChangedRecordsMap.get(r.toString());this.beforeChangedRecordsMap.delete(r.toString()),this.beforeChangedRecordsMap.set((r+("add"===i?e:-e)).toString(),t)}}deleteRecords(t){var e;if(Array.isArray(this.records)){let i=[],r=t.sort((t,e)=>e-t);for(let t=0;t<r.length;t++){let e=r[t];if(e>=this._sourceLength||e<0)continue;this.adjustBeforeChangedRecordsMap(e,1,"delete"),i.push(e);let n=this.records[e];for(let t=0;t<this.fieldAggregators.length;t++)this.fieldAggregators[t].deleteRecord(n);this.records.splice(e,1),this.currentIndexedData.pop(),this._sourceLength-=1}return this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.updatePagerData(),(null==(e=this.dataSourceObj)?void 0:e.deleted)&&this.dataSourceObj.deleted(i),i}return[]}deleteRecordsForSorted(t){if(Array.isArray(this.records)){let e=t.sort((t,e)=>e-t);for(let t=0;t<e.length;t++){let i=e[t];if(i>=this._sourceLength||i<0)continue;let r=this.currentIndexedData[i];this.records.splice(r,1),this._sourceLength-=1}this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.beforeChangedRecordsMap.clear()}}updateRecords(t,e){let i=[];for(let r=0;r<e.length;r++){let n=e[r];if(Array.isArray(n))this.beforeChangedRecordsMap.delete(n.toString()),i.push(n),n.slice(0,-1).reduce((t,e)=>(void 0===t[e]&&(t[e]={}),t[e].children),this.records)[n[n.length-1]]=t[r];else{if(n>=this._sourceLength||n<0)continue;this.beforeChangedRecordsMap.delete(n.toString()),i.push(n);for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].updateRecord(this.records[n],t[r]);this.records[n]=t[r]}}return this.userPagination&&this.updatePagerData(),i}updateRecordsForSorted(t,e){let i=[];for(let r=0;r<e.length;r++){let n=e[r];if(n>=this._sourceLength||n<0)continue;let s=this.currentIndexedData[n];if("number"!=typeof s)return;this.beforeChangedRecordsMap.delete(s.toString()),i.push(n),this.records[s]=t[r]}this.sortedIndexMap.clear()}sort(t){t=(Array.isArray(t)?t:[t]).filter(t=>{let e=this.columns.find(e=>e.field===t.field);return!1!==(null==e?void 0:e.sort)&&"normal"!==t.order}),this.lastSortStates=t;let e=t.map(t=>this.sortedIndexMap.get(null==t?void 0:t.field)||{asc:[],desc:[],normal:[]}),i=null;if(e.length>0&&(i=t.reduce((t,i,r)=>{var n;let s=null==(n=e[r])?void 0:n[i.order];return s&&s.length>0?s:t},null))&&i.length>0)return this.currentIndexedData=i,this.updatePagerData(),void this.fireListeners(g.CHANGE_ORDER,null);let r=Array.from({length:this._sourceLength},(t,e)=>e);if(r.sort((e,i)=>{let r=this.getOriginalRecord(e),n=this.getOriginalRecord(i),s=null==r||"object"==typeof r&&0===Object.keys(r).length,l=null==n||"object"==typeof n&&0===Object.keys(n).length;return t.reduce((t,r)=>{if(0!==t)return t;if("asc"===r.order||"desc"===r.order){if(s&&!l)return 1;if(!s&&l)return -1;if(s&&l)return e-i}else if(s||l)return e-i;return(r.orderFn||("desc"!==r.order?(t,e)=>t===e?0:t>e?1:-1:(t,e)=>t===e?0:t<e?1:-1))(this.getOriginalField(e,r.field),this.getOriginalField(i,r.field),r.order)},0)}),this.currentIndexedData=r,this.hierarchyExpandLevel){let t=r.length;for(let e=0;e<t;e++){let i=this.getOriginalRecord(r[e]),n=this.pushChildrenNode(r[e],i.hierarchyState,this.getOriginalRecord(r[e]));t+=n,e+=n}}if(!e.length){e=t.map(()=>({asc:[],desc:[],normal:[]}));for(let i=0;i<t.length;i++)this.sortedIndexMap.set(t[i].field,e[i])}t.forEach((t,i)=>{e[i][t.order]=r.slice()}),this.updatePagerData(),this.fireListeners(g.CHANGE_ORDER,null)}setSortedIndexMap(t,e){this.sortedIndexMap.set(t,e)}clearFilteredChildren(t){var e,i;t.filteredChildren=void 0;for(let r=0;r<(null!=(i=null==(e=t.children)?void 0:e.length)?i:0);r++)this.clearFilteredChildren(t.children[r])}filterRecord(t){var e,i,r;let n=!0;for(let s=0;s<(null==(e=this.dataConfig.filterRules)?void 0:e.length);s++){let e=null==(i=this.dataConfig)?void 0:i.filterRules[s];if(e.filterKey){let i=t[e.filterKey];if(-1===e.filteredValues.indexOf(i)){n=!1;break}}else if(!(null==(r=e.filterFunc)?void 0:r.call(e,t))){n=!1;break}}return n}updateFilterRulesForSorted(t){var e,i,r;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords(null!=(i=null==(e=this.dataSourceObj)?void 0:e.records)?i:this.dataSourceObj),this._sourceLength=(null==(r=this._source)?void 0:r.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e),"tree"===this.rowHierarchyType&&this.initTreeHierarchyState(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}updateFilterRules(t){var e,i,r;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords(null!=(i=null==(e=this.dataSourceObj)?void 0:e.records)?i:this.dataSourceObj),this._sourceLength=(null==(r=this._source)?void 0:r.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,"tree"===this.rowHierarchyType&&this.initTreeHierarchyState()),this.updatePagerData()}clearSortedIndexMap(){this.lastSortStates&&this.lastSortStates.length>0&&this.sortedIndexMap.forEach((t,e)=>{this.lastSortStates.some(t=>t.field===e)?this.lastSortStates.forEach(e=>{"asc"===e.order?(t.desc=[],t.normal=[]):"desc"===e.order?(t.asc=[],t.normal=[]):(t.asc=[],t.desc=[])}):this.sortedIndexMap.delete(e)})}get sourceLength(){return this._sourceLength}set sourceLength(t){this._sourceLength!==t&&(this._sourceLength=t,this.fireListeners(g.SOURCE_LENGTH_UPDATE,this._sourceLength))}get length(){return this.currentPagerIndexedData.length}get dataSource(){return this}get currentPagerIndexedData(){return this._currentPagerIndexedData.length>0?this._currentPagerIndexedData:[]}release(){var t;null==(t=super.release)||t.call(this),this.lastFilterRules=null,this.clearSortedMap(),this.clearCurrentIndexedData(),this.currentPagerIndexedData.length=0}clearSortedMap(){this.currentIndexedData&&(this.currentIndexedData.length=0),this.currentIndexedData=null,this.sortedIndexMap.forEach(t=>{t.asc&&(t.asc.length=0),t.desc&&(t.desc.length=0)}),this.sortedIndexMap.clear()}clearCurrentIndexedData(){this.currentIndexedData=null,this.currentPagerIndexedData.length=0}getOriginalRecord(t){return f(this.dataSourceObj.records?Array.isArray(t)?b(this.records,t):this.records[t]:this._get(t),e=>{this.recordPromiseCallBack(t,e)})}getRawRecord(t){var e,i;return(null==(e=this.beforeChangedRecordsMap)?void 0:e.has(t.toString()))?null==(i=this.beforeChangedRecordsMap)?void 0:i.get(t.toString()):f(this.dataSourceObj.records?Array.isArray(t)?b(this.records,t):this.records[t]:this._get(t),e=>{this.recordPromiseCallBack(t,e)})}getOriginalField(t,e,i,r,n){if(null!==e)return m(this.getOriginalRecord(t),e,i,r,n,i=>{this.fieldPromiseCallBack(t,e,i)})}getRawFieldData(t,e,i,r,n){if(null!==e)return m(this.getRawRecord(t),e,i,r,n,i=>{this.fieldPromiseCallBack(t,e,i)})}hasOriginalField(t,e){if(null===e)return!1;if("function"==typeof e)return!0;let i=this.getOriginalRecord(t);return!!(i&&e in i)}fieldPromiseCallBack(t,e,i){}recordPromiseCallBack(t,e){}canChangeOrder(t,e){var i;if(null==(i=this.dataSourceObj)?void 0:i.canChangeOrder)return this.dataSourceObj.canChangeOrder(t,e);if(this.hasHierarchyStateExpand){let i=this.currentPagerIndexedData[t],r=this.currentPagerIndexedData[e];if(i=Array.isArray(i)?[...i]:[i],r=Array.isArray(r)?[...r]:[r],e>t&&r.length>i.length){let t=this.currentPagerIndexedData[e+1];(t=Array.isArray(t)?[...t]:[t]).length<r.length&&r.splice(r.length-1,1)}if(i.length===r.length){for(let t=0;t<=i.length-2;t++)if(i[t]!==r[t])return!1;return!0}return!1}return!0}changeOrder(t,e){var i,r,n;if(null==(i=this.dataSourceObj)?void 0:i.changeOrder)this.dataSourceObj.changeOrder(t,e);else if(!(null==(r=this.lastSortStates)?void 0:r.some(t=>"asc"===t.order||"desc"===t.order))&&this.canChangeOrder(t,e))if(this.hasHierarchyStateExpand){let i,r,s=this.currentPagerIndexedData[t],l=this.currentPagerIndexedData[e];if(s=Array.isArray(s)?[...s]:[s],l=Array.isArray(l)?[...l]:[l],s.length>1||l.length>1){if(e>t&&l.length>s.length){let t=this.currentPagerIndexedData[e+1];(t=Array.isArray(t)?[...t]:[t]).length<l.length&&l.splice(l.length-1,1)}if(i=s.splice(s.length-1,1)[0],r=l.splice(l.length-1,1)[0],s.length>=1){let t=this.getOriginalRecord(s);if(t){let e=t.filteredChildren?t.filteredChildren.splice(i,1):t.children.splice(i,1);e.unshift(r,0),Array.prototype.splice.apply(null!=(n=t.filteredChildren)?n:t.children,e)}}else{let t=this.records.splice(i,1);t.unshift(r,0),Array.prototype.splice.apply(this.records,t)}}else this.exchangeRecordData(t,e);this.restoreTreeHierarchyState(),this.updatePagerData()}else this.exchangeRecordData(t,e)}exchangeRecordData(t,e){let i=this.getRecordIndexPaths(t),r=this.getRecordIndexPaths(e),n=this.records.splice(i,1);n.unshift(r,0),Array.prototype.splice.apply(this.records,n)}restoreTreeHierarchyState(){var t,e;if(this.hierarchyExpandLevel){for(let e=0;e<this._sourceLength;e++){let i=this.getOriginalRecord(e);i&&(null!=(t=i.filteredChildren)?t:i.children)&&!i.hierarchyState&&(i.hierarchyState=r.g.collapse)}this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e);let i=this._sourceLength;for(let t=0;t<i;t++){let n=this.currentIndexedData[t],s=this.getOriginalRecord(n);if(!s)continue;let l=null!=(e=s.filteredChildren)?e:s.children;if((null==l?void 0:l.length)>0&&s.hierarchyState===r.g.expand){this.hasHierarchyStateExpand=!0;let e=this.restoreChildrenNodeHierarchy(n,s);t+=e,i+=e}else!0!==s.children||s.hierarchyState||(s.hierarchyState=r.g.collapse)}}}restoreChildrenNodeHierarchy(t,e){var i,n;let s=0,l=null!=(i=e.filteredChildren)?i:e.children,a=null!=(n=null==l?void 0:l.length)?n:0;for(let i=0;i<a;i++){e.hierarchyState===r.g.expand&&(s+=1);let n=l[i],a=Array.isArray(t)?t.concat(i):[t,i];e.hierarchyState===r.g.expand&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+s,0,a),s+=this.restoreChildrenNodeHierarchy(a,n)}return s}_setNodeStateRecursive(t,e){var i;if(!t)return;let r=null!=(i=t.filteredChildren)?i:t.children;if(r&&(Array.isArray(r)?r.length>0:!0===r)&&(t.hierarchyState=e),r&&Array.isArray(r))for(let t of r)this._setNodeStateRecursive(t,e)}expandAllNodes(){if(Array.isArray(this._source)){for(let t of this._source)this._setNodeStateRecursive(t,r.g.expand);this.hasHierarchyStateExpand=!0,this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}collapseAllNodes(){if(Array.isArray(this._source)){for(let t of this._source)this._setNodeStateRecursive(t,r.g.collapse);this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}}function b(t,e){var i;let r=t;for(let t=0;t<e.length;t++){let n=e[t];if(!r[n])return;let s=null!=(i=(r=r[n]).filteredChildren)?i:null==r?void 0:r.children;s&&t+1<e.length&&(r=s)}return r}function _(t,e){return t.sort((t,i)=>{var r,n;(0,c.Z)(t)&&(t=[t]),(0,c.Z)(i)&&(i=[i]);let s=Math.max(t.length,i.length);for(let l=0;l<s;l++){let s=null!=(r=t[l])?r:-1,a=null!=(n=i[l])?n:-1;if(s!==a)return 1===e?s-a:a-s}return 0})}v.EMPTY=new v({get(){},length:0})},17072:function(t,e,i){"use strict";i.d(e,{q:()=>o});var r=i(18585),n=i(20595),s=i(39940),l=i(13455);function a(t,e){let i="";for(let r=0;r<t.length;r++)i+=t[r],r!==t.length-1&&(i+=e);return i}class o{constructor(t,e,i,r,n,s,l,a,o,h,u,d,c,p){var g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X,q;this.tree={},this.changedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.colKeys_normal=[],this.rowKeys_normal=[],this.rowOrder="key_a_to_z",this.colOrder="key_a_to_z",this.sorted=!1,this.indicatorStatistics=[],this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.registerAggregators(),this.dataConfig=t,this.filterRules=null==(g=this.dataConfig)?void 0:g.filterRules,this.rowHierarchyType=null!=a?a:"grid",this.columnHierarchyType=null!=o?o:"grid",this.sortRules=null==(f=this.dataConfig)?void 0:f.sortRules,this.aggregationRules=null==(m=this.dataConfig)?void 0:m.aggregationRules,this.derivedFieldRules=null==(y=this.dataConfig)?void 0:y.derivedFieldRules,this.mappingRules=null==(v=this.dataConfig)?void 0:v.mappingRules,this.calculatedFieldRules=null==(b=this.dataConfig)?void 0:b.calculatedFieldRules,this.calculatedFiledKeys=null!=(x=null==(_=this.calculatedFieldRules)?void 0:_.map(t=>t.key))?x:[],this.calculatedFieldDependIndicatorKeys=null!=(w=null==(C=this.calculatedFieldRules)?void 0:C.reduce((t,e)=>{for(let i=0;i<e.dependIndicatorKeys.length;i++)-1===t.indexOf(e.dependIndicatorKeys[i])&&t.push(e.dependIndicatorKeys[i]);return t},[]))?w:[],this.totals=null==(S=this.dataConfig)?void 0:S.totals,this.rows=e,this.columns=i,this.indicatorKeys=r,this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys=[...r];for(let t=0;t<this.calculatedFieldDependIndicatorKeys.length;t++)-1===this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(this.calculatedFieldDependIndicatorKeys[t])&&this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.push(this.calculatedFieldDependIndicatorKeys[t]);if(this.indicatorsAsCol=s,this.indicators=n,this.customColTree=h,this.customRowTree=u,this.hasExtensionRowTree=c,this.parseCustomTreeToMatchRecords=p,this.parseCustomTreeToMatchRecords&&(this.customColTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customColTree,"col"),this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))),this.colGrandTotalLabel=null!=(k=null==(M=null==(A=this.totals)?void 0:A.column)?void 0:M.grandTotalLabel)?k:"总计",this.colSubTotalLabel=null!=(B=null==(R=null==(T=this.totals)?void 0:T.column)?void 0:R.subTotalLabel)?B:"小计",this.rowGrandTotalLabel=null!=(I=null==(E=null==(P=this.totals)?void 0:P.row)?void 0:E.grandTotalLabel)?I:"总计",this.rowSubTotalLabel=null!=(O=null==(F=null==(L=this.totals)?void 0:L.row)?void 0:F.subTotalLabel)?O:"小计",this.collectValuesBy=null==(D=this.dataConfig)?void 0:D.collectValuesBy,this.needSplitPositiveAndNegative=null!=d&&d,this.rowsIsTotal=Array(null!=(z=null==(H=this.rows)?void 0:H.length)?z:0).fill(!1),this.colsIsTotal=Array(null!=(N=null==(W=this.columns)?void 0:W.length)?N:0).fill(!1),(null==(j=this.totals)?void 0:j.row)&&!1!==this.totals.row.showSubTotals&&this.totals.row.subTotalsDimensions)for(let t=0,e=null!=(U=null==(Z=null==(V=null==(G=this.totals)?void 0:G.row)?void 0:V.subTotalsDimensions)?void 0:Z.length)?U:0;t<e;t++){let e=this.totals.row.subTotalsDimensions[t],i=this.rows.indexOf(e);this.rowsIsTotal[i]=!0}if((null==(K=this.totals)?void 0:K.column)&&!1!==this.totals.column.showSubTotals&&this.totals.column.subTotalsDimensions)for(let t=0,e=null!=(q=null==(X=null==(Y=null==($=this.totals)?void 0:$.column)?void 0:Y.subTotalsDimensions)?void 0:X.length)?q:0;t<e;t++){let e=this.totals.column.subTotalsDimensions[t],i=this.columns.indexOf(e);this.colsIsTotal[i]=!0}this.setRecords(l)}setRecords(t){var e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C;this.records=t,this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.tree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.rowsHasValue=[],this.columnsHasValue=[],this.sorted=!1,t&&(this.records=t,"undefined"!=typeof window&&window.performance.now(),this.processRecords(),this.processCollectedValuesWithSumBy(),this.generateCollectedValuesSortRule(),this.processCollectedValuesWithSortBy(),"undefined"!=typeof window&&window.performance.now(),"undefined"!=typeof window&&window.performance.now(),this.totalStatistics(),"undefined"!=typeof window&&window.performance.now(),this.rowKeys_normal=this.rowKeys.slice(),this.colKeys_normal=this.colKeys.slice(),"undefined"!=typeof window&&window.performance.now(),this.sortKeys(),"undefined"!=typeof window&&window.performance.now(),"undefined"!=typeof window&&window.performance.now(),this.customRowTree?this.rowHeaderTree=this.customRowTree:"tree"===this.rowHierarchyType?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((t,e)=>this.rowsHasValue[e]),this.indicatorsAsCol?void 0:this.indicators,(null==(i=null==(e=this.totals)?void 0:e.row)?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,null!=(s=null==(n=null==(r=this.totals)?void 0:r.row)?void 0:n.showGrandTotalsOnTop)&&s):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((t,e)=>this.rowsHasValue[e]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,(null==(a=null==(l=this.totals)?void 0:l.row)?void 0:a.showGrandTotals)||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,this.rowSubTotalLabel,null!=(u=null==(h=null==(o=this.totals)?void 0:o.row)?void 0:h.showGrandTotalsOnTop)&&u,null!=(p=null==(c=null==(d=this.totals)?void 0:d.row)?void 0:c.showSubTotalsOnTop)&&p),this.customColTree?this.colHeaderTree=this.customColTree:this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((t,e)=>this.columnsHasValue[e]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,(null==(f=null==(g=this.totals)?void 0:g.column)?void 0:f.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length,this.colGrandTotalLabel,this.colSubTotalLabel,null!=(v=null==(y=null==(m=this.totals)?void 0:m.column)?void 0:y.showGrandTotalsOnLeft)&&v,null!=(x=null==(_=null==(b=this.totals)?void 0:b.column)?void 0:_.showSubTotalsOnLeft)&&x),"undefined"!=typeof window&&window.performance.now(),(null==(C=this.dataConfig)?void 0:C.isPivotChart)&&this.cacheDeminsionCollectedValues())}registerAggregator(t,e){s.YJ[t]=e}registerAggregators(){this.registerAggregator(n.E.RECORD,s.hT),this.registerAggregator(n.E.SUM,s.__),this.registerAggregator(n.E.COUNT,s.ZP),this.registerAggregator(n.E.MAX,s.Fn),this.registerAggregator(n.E.MIN,s.NF),this.registerAggregator(n.E.AVG,s.ky),this.registerAggregator(n.E.NONE,s.ld),this.registerAggregator(n.E.RECALCULATE,s.U4),this.registerAggregator(n.E.CUSTOM,s.Js)}processCollectedValuesWithSumBy(){var t,e,i,r,n,s;for(let l in this.collectedValues)if(null==(e=null==(t=this.collectValuesBy)?void 0:t[l])?void 0:e.sumBy)for(let t in this.collectedValues[l]){let e,a,o;"sum"===(null==(i=this.collectValuesBy[l])?void 0:i.extendRange)?(e=Object.values(this.collectedValues[l][t]).reduce((t,e)=>t+e.value(),0),e+=Math.round(e/20)):(e=Object.values(this.collectedValues[l][t]).reduce((t,e)=>e.value()>t?e.value():t,Number.MIN_SAFE_INTEGER),"max"===(null==(r=this.collectValuesBy[l])?void 0:r.extendRange)?e+=Math.round(e/20):"number"==typeof(null==(n=this.collectValuesBy[l])?void 0:n.extendRange)&&(e=Math.max(e,null==(s=this.collectValuesBy[l])?void 0:s.extendRange)));let h=Object.values(this.collectedValues[l][t]).reduce((t,e)=>e.value()<t?e.value():t,Number.MAX_SAFE_INTEGER);this.needSplitPositiveAndNegative&&(a=Object.values(this.collectedValues[l][t]).reduce((t,e)=>e.positiveValue()>t?e.positiveValue():t,Number.MIN_SAFE_INTEGER),o=Object.values(this.collectedValues[l][t]).reduce((t,e)=>e.negativeValue()<t?e.negativeValue():t,Number.MAX_SAFE_INTEGER)),this.collectedValues[l][t]={},this.collectedValues[l][t].max=e,this.collectedValues[l][t].min=h,this.needSplitPositiveAndNegative&&(this.collectedValues[l][t].positiveMax=a,this.collectedValues[l][t].negativeMin=o)}}processCollectedValuesWithSortBy(){var t,e;let i=this;for(let r in this.collectedValues)if(null==(e=null==(t=this.collectValuesBy)?void 0:t[r])?void 0:e.sortBy)for(let t in this.collectedValues[r])this.collectedValues[r][t]=this.collectedValues[r][t].sort((t,e)=>{var n,s,l,a;return(null!=(s=null==(n=i.collectValuesBy[r].sortBy)?void 0:n.indexOf(t))?s:-1)-(null!=(a=null==(l=i.collectValuesBy[r].sortBy)?void 0:l.indexOf(e))?a:-1)})}generateCollectedValuesSortRule(){for(let t in this.collectedValues)if(this.collectValuesBy&&this.collectValuesBy[t]&&!this.collectValuesBy[t].sortBy){let e=[];for(let i in this.collectedValues[t])Array.isArray(this.collectedValues[t][i])&&(e.push(...this.collectedValues[t][i]),e=Array.from(new Set(e)));e.length>0&&(this.collectValuesBy[t].sortBy=e)}}processRecords(){var t,e;let i=!1;if((null!=(e=null==(t=this.filterRules)?void 0:t.length)?e:0)>=1&&(i=!0),Array.isArray(this.records)){this.filteredRecords||(this.filteredRecords=[]);for(let t=0,e=this.records.length;t<e;t++){let e=this.records[t];i&&!this.filterRecord(e)||(this.filteredRecords.push(e),e&&this.processRecord(e))}}else for(let t in this.filteredRecords||(this.filteredRecords={}),this.records)for(let e=0,r=this.records[t].length;e<r;e++){let r=this.records[t][e];i&&!this.filterRecord(r)||(this.filteredRecords[t]||(this.filteredRecords[t]=[]),this.filteredRecords[t].push(r),this.processRecord(r,t))}this.rowFlatKeys={},this.colFlatKeys={}}filterRecord(t){var e,i;let r=!0;if(this.filterRules)for(let n=0;n<this.filterRules.length;n++){let s=this.filterRules[n];if(s.filterKey){let i=t[s.filterKey];if(-1===(null==(e=s.filteredValues)?void 0:e.indexOf(i))){r=!1;break}}else if(!(null==(i=s.filterFunc)?void 0:i.call(s,t))){r=!1;break}}return r}processRecord(t,e){var i,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X,q,J,Q,te,ti,tr,tn,ts,tl,ta,to,th,tu,td,tc,tp,tg,tf,tm,ty,tv;for(let e in null==(i=this.derivedFieldRules)||i.forEach((e,i)=>{e.fieldName&&e.derivedFunc&&(t[e.fieldName]=e.derivedFunc(t))}),this.collectValuesBy)if((0,r.Z)(t[e])){this.collectedValues[e]||(this.collectedValues[e]={});let i=this.collectValuesBy[e].by.map(e=>t[e]).join(this.stringJoinChar);if(this.collectedValues[e][i]||(this.collectValuesBy[e].sumBy?this.collectedValues[e][i]={}:this.collectValuesBy[e].range?this.collectedValues[e][i]={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}:this.collectedValues[e][i]=[]),this.collectValuesBy[e].sumBy){let r=null==(a=this.collectValuesBy[e].sumBy)?void 0:a.map(e=>t[e]).join(this.stringJoinChar);this.collectedValues[e][i][r]||(this.collectedValues[e][i][r]=new s.YJ[n.E.SUM]({key:e,field:e,isRecord:void 0,needSplitPositiveAndNegative:this.needSplitPositiveAndNegative})),this.collectedValues[e][i][r].push(t)}else if(this.collectValuesBy[e].range){let r=this.collectedValues[e][i],n=Math.max(t[e],r.max),s=Math.min(t[e],r.min);isNaN(n)||(r.max=n,r.min=s)}else{let r=this.collectedValues[e][i];-1===r.indexOf(t[e])&&r.push(t[e])}}let tb=!1,t_=[],tx=[];if(!this.parseCustomTreeToMatchRecords||(null==(o=this.dataConfig)?void 0:o.isPivotChart)||!(null==(h=this.customRowTree)?void 0:h.length)||e||this.hasExtensionRowTree){let i=[];tx.push({rowKey:i,indicatorKey:e});for(let e=0,r=this.rows.length;e<r;e++){let r=this.rows[e];if(r in t)this.rowsHasValue[e]=!0,i.push(t[r]);else if(r!==l.ek){if((null==(c=null==(d=null==(u=this.dataConfig)?void 0:u.totals)?void 0:d.row)?void 0:c.showGrandTotals)&&0===e&&!this.rows.find(e=>e in t)){i.push(this.rowGrandTotalLabel),tb=!0;break}if((null==(f=null==(g=null==(p=this.dataConfig)?void 0:p.totals)?void 0:g.row)?void 0:f.subTotalsDimensions)&&(null==(v=null==(y=null==(m=this.dataConfig)?void 0:m.totals)?void 0:y.row)?void 0:v.subTotalsDimensions.indexOf(this.rows[e-1]))>=0){"tree"!==this.rowHierarchyType&&i.push(this.rowSubTotalLabel),tb=!0;break}}}}else{let e=this.getFieldMatchRowDimensionPaths(t);if(e.length>0)for(let t=0,i=e.length;t<i;t++){let i,n=e[t],s=[];for(let t=0,e=n.length;t<e;t++)(0,r.Z)(n[t].indicatorKey)?i=n[t].indicatorKey:s.push(n[t].value);tx.push({rowKey:s,indicatorKey:i})}}if(!this.parseCustomTreeToMatchRecords||(null==(b=this.dataConfig)?void 0:b.isPivotChart)||!(null==(_=this.customColTree)?void 0:_.length)||e||this.hasExtensionRowTree){let i=[];t_.push({colKey:i,indicatorKey:e});for(let e=0,r=this.columns.length;e<r;e++){let r=this.columns[e];if(r in t)this.columnsHasValue[e]=!0,i.push(t[r]);else if(r!==l.ek){if((null==(w=null==(C=null==(x=this.dataConfig)?void 0:x.totals)?void 0:C.column)?void 0:w.showGrandTotals)&&0===e&&!this.columns.find(e=>e in t)){i.push(this.colGrandTotalLabel),tb=!0;break}if((null==(M=null==(A=null==(S=this.dataConfig)?void 0:S.totals)?void 0:A.column)?void 0:M.subTotalsDimensions)&&(null==(R=null==(T=null==(k=this.dataConfig)?void 0:k.totals)?void 0:T.column)?void 0:R.subTotalsDimensions.indexOf(this.columns[e-1]))>=0){i.push(this.colSubTotalLabel),tb=!0;break}}}}else{let e=this.getFieldMatchColDimensionPaths(t);if(e.length>0)for(let t=0,i=e.length;t<i;t++){let i,n=e[t],s=[];for(let t=0,e=n.length;t<e;t++)(0,r.Z)(n[t].indicatorKey)?i=n[t].indicatorKey:s.push(n[t].value);t_.push({colKey:s,indicatorKey:i})}}for(let i=0;i<tx.length;i++){let r,l=tx[i].rowKey;this.indicatorsAsCol||(r=tx[i].indicatorKey);for(let i=0;i<t_.length;i++){let a=t_[i].colKey;this.indicatorsAsCol&&(r=t_[i].indicatorKey);let o=l.join(this.stringJoinChar),h=a.join(this.stringJoinChar);if(tb){this.totalRecordsTree[o]||(this.totalRecordsTree[o]={}),this.totalRecordsTree[o][h]||(this.totalRecordsTree[o][h]=[]);let e=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let i=0;i<e.length;i++)if(this.calculatedFiledKeys.indexOf(e[i])>=0){let r=null==(B=this.calculatedFieldRules)?void 0:B.find(t=>t.key===e[i]);(null==(E=null==(P=this.totalRecordsTree[o])?void 0:P[h])?void 0:E[i])||(this.totalRecordsTree[o][h][i]=new s.YJ[n.E.RECALCULATE]({key:e[i],field:e[i],isRecord:!0,formatFun:null==(L=null==(I=this.indicators)?void 0:I.find(t=>"string"!=typeof t&&t.indicatorKey===e[i]))?void 0:L.format,calculateFun:null==r?void 0:r.calculateFun,dependAggregators:this.totalRecordsTree[o][h],dependIndicatorKeys:null==r?void 0:r.dependIndicatorKeys})),e[i]in t&&(null==(O=null==(F=this.totalRecordsTree[o])?void 0:F[h])||O[i].push(t))}else{let r=this.getAggregatorRule(e[i]);(null==(H=null==(D=this.totalRecordsTree[o])?void 0:D[h])?void 0:H[i])||(this.totalRecordsTree[o][h][i]=new s.YJ[null!=(z=null==r?void 0:r.aggregationType)?z:n.E.SUM]({key:e[i],field:null!=(W=null==r?void 0:r.field)?W:e[i],aggregationFun:null==r?void 0:r.aggregationFun,formatFun:null!=(N=null==r?void 0:r.formatFun)?N:null==(G=null==(j=this.indicators)?void 0:j.find(t=>"string"!=typeof t&&t.indicatorKey===e[i]))?void 0:G.format})),e[i]in t&&(null==(Z=null==(V=this.totalRecordsTree[o])?void 0:V[h])||Z[i].push(t))}return}0!==l.length&&(this.rowFlatKeys[o]||(this.rowKeys.push(l),this.rowFlatKeys[o]=1)),0!==a.length&&(this.colFlatKeys[h]||(this.colKeys.push(a),this.colFlatKeys[h]=1)),this.tree[o]||(this.tree[o]={}),(null==(U=this.tree[o])?void 0:U[h])||(this.tree[o][h]=[]);let u=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let i=0;i<u.length;i++)if(this.calculatedFiledKeys.indexOf(u[i])>=0){let e=null==(K=this.calculatedFieldRules)?void 0:K.find(t=>t.key===u[i]);(null==(Y=null==($=this.tree[o])?void 0:$[h])?void 0:Y[i])||(this.tree[o][h][i]=new s.YJ[n.E.RECALCULATE]({key:u[i],field:u[i],isRecord:!0,formatFun:null==(q=null==(X=this.indicators)?void 0:X.find(t=>"string"!=typeof t&&t.indicatorKey===u[i]))?void 0:q.format,calculateFun:null==e?void 0:e.calculateFun,dependAggregators:this.tree[o][h],dependIndicatorKeys:null==e?void 0:e.dependIndicatorKeys})),null==(Q=null==(J=this.tree[o])?void 0:J[h])||Q[i].push(t)}else{let l=this.getAggregatorRule(u[i]),a=!1;r?e===r?u[i]===r&&(a=!0):u[i]===r&&u[i]in t&&(a=!0):(null==l?void 0:l.field)?"string"==typeof(null==l?void 0:l.field)?(null==l?void 0:l.field)in t&&(a=!0):(null==l?void 0:l.field.find(e=>e in t))&&(a=!0):u[i]in t&&(a=!0),(null==(ti=null==(te=this.tree[o])?void 0:te[h])?void 0:ti[i])||!a||(this.tree[o][h][i]=new s.YJ[null!=(tr=null==l?void 0:l.aggregationType)?tr:n.E.SUM]({key:u[i],field:null!=(tn=null==l?void 0:l.field)?tn:u[i],aggregationFun:null==l?void 0:l.aggregationFun,formatFun:null!=(ts=null==l?void 0:l.formatFun)?ts:null==(ta=null==(tl=this.indicators)?void 0:tl.find(t=>"string"!=typeof t&&t.indicatorKey===u[i]))?void 0:ta.format})),a&&(null==(th=null==(to=this.tree[o])?void 0:to[h])||th[i].push(t))}if(this.mappingRules)for(let e=0;e<this.indicatorKeys.length;e++){if(!this.indicatorStatistics[e]){let t=this.getAggregatorRule(this.indicatorKeys[e]);this.indicatorStatistics[e]={max:new s.YJ[n.E.MAX]({key:this.indicatorKeys[e],field:this.indicatorKeys[e]}),min:new s.YJ[n.E.MIN]({key:this.indicatorKeys[e],field:this.indicatorKeys[e]}),total:new s.YJ[null!=(tu=null==t?void 0:t.aggregationType)?tu:n.E.SUM]({key:this.indicatorKeys[e],field:null!=(td=null==t?void 0:t.field)?td:this.indicatorKeys[e],aggregationFun:null==t?void 0:t.aggregationFun,formatFun:null!=(tc=null==t?void 0:t.formatFun)?tc:null==(tg=null==(tp=this.indicators)?void 0:tp.find(t=>"string"!=typeof t&&t.indicatorKey===this.indicatorKeys[e]))?void 0:tg.format})}}this.indicatorStatistics[e].max.push(null==(tm=null==(tf=this.tree[o])?void 0:tf[h])?void 0:tm[e].value()),this.indicatorStatistics[e].min.push(null==(tv=null==(ty=this.tree[o])?void 0:ty[h])?void 0:tv[e].value()),this.indicatorStatistics[e].total.push(t)}}}}updateSortRules(t){var e,i,r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x;this.sorted=!1,this.sortRules=t,this.sortKeys(),this.customRowTree||("tree"===this.rowHierarchyType?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((t,e)=>this.rowsHasValue[e]),this.indicatorsAsCol?void 0:this.indicators,(null==(i=null==(e=this.totals)?void 0:e.row)?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,null!=(s=null==(n=null==(r=this.totals)?void 0:r.row)?void 0:n.showGrandTotalsOnTop)&&s):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((t,e)=>this.rowsHasValue[e]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,(null==(a=null==(l=this.totals)?void 0:l.row)?void 0:a.showGrandTotals)||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,this.rowSubTotalLabel,null!=(u=null==(h=null==(o=this.totals)?void 0:o.row)?void 0:h.showGrandTotalsOnTop)&&u,null!=(p=null==(c=null==(d=this.totals)?void 0:d.row)?void 0:c.showSubTotalsOnTop)&&p)),this.customColTree||(this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((t,e)=>this.columnsHasValue[e]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,(null==(f=null==(g=this.totals)?void 0:g.column)?void 0:f.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length,this.colGrandTotalLabel,this.colSubTotalLabel,null!=(v=null==(y=null==(m=this.totals)?void 0:m.column)?void 0:y.showGrandTotalsOnLeft)&&v,null!=(x=null==(_=null==(b=this.totals)?void 0:b.column)?void 0:_.showSubTotalsOnLeft)&&x))}updateFilterRules(t,e=!1){var i,r;if(this.filterRules=t,this.filteredRecords=void 0,e)return this.setRecords(this.records);for(let t in this.tree)for(let e in this.tree[t])for(let r=0;r<this.tree[t][e].length;r++)null==(i=this.tree[t][e][r])||i.reset();this.collectedValues={},this.processRecords(),this.processCollectedValuesWithSumBy(),this.processCollectedValuesWithSortBy(),this.totalStatistics(),(null==(r=this.dataConfig)?void 0:r.isPivotChart)&&this.cacheDeminsionCollectedValues()}getAggregatorRule(t){var e;return null==(e=this.aggregationRules)?void 0:e.find((e,i)=>t===e.indicatorKey)}getAggregator(t=[],e=[],i,n=!0,s){var l,o,h,u,d,c,p,g,f,m,y,v,b,_;let x,C,w=this.indicatorKeys.indexOf(i);"string"==typeof t?x=t:(s&&"row"!==s.position||t.map((e,n)=>{e!==i||(0,r.Z)(null==s?void 0:s.index)&&n!==s.index||t.splice(n,1)}),t.length<this.rows.length&&"grid-tree"===this.rowHierarchyType&&(t[0]===this.rowGrandTotalLabel||(null==(o=null==(l=this.totals)?void 0:l.row)?void 0:o.subTotalsDimensions)&&(null==(d=null==(u=null==(h=this.totals)?void 0:h.row)?void 0:u.subTotalsDimensions)?void 0:d.length)>=1&&t[t.length-1]!==this.rowSubTotalLabel&&t.push(this.rowSubTotalLabel)),x=a(t,this.stringJoinChar)),"string"==typeof e?C=e:(s&&"col"!==s.position||e.map((t,n)=>{t!==i||(0,r.Z)(null==s?void 0:s.index)&&n!==s.index||e.splice(n,1)}),e.length<this.columns.length&&"grid-tree"===this.columnHierarchyType&&(e[0]===this.colGrandTotalLabel||(null==(p=null==(c=this.totals)?void 0:c.column)?void 0:p.subTotalsDimensions)&&(null==(m=null==(f=null==(g=this.totals)?void 0:g.column)?void 0:f.subTotalsDimensions)?void 0:m.length)>=1&&e[e.length-1]!==this.colSubTotalLabel&&e.push(this.colSubTotalLabel)),C=a(e,this.stringJoinChar));let S=null==(v=null==(y=this.tree[x])?void 0:y[C])?void 0:v[w];if(n&&(0,r.Z)(null==(_=null==(b=this.changedTree[x])?void 0:b[C])?void 0:_[w])){let t=this.changedTree[x][C][w];return S?{value:()=>t,formatValue:S.formatValue,formatFun:S.formatFun,records:S.records,recalculate(){},push(){},deleteRecord(){},updateRecord(){},clearCacheValue(){},reset(){}}:{records:[],value:()=>t,push(){},deleteRecord(){},updateRecord(){},recalculate(){},formatValue:()=>t,clearCacheValue(){},reset(){}}}return S||{records:[],push(){},deleteRecord(){},updateRecord(){},recalculate(){},value:()=>null,clearCacheValue(){},reset(){}}}sortKeys(){if(this.colKeys=this.colKeys_normal.slice(),this.rowKeys=this.rowKeys_normal.slice(),!this.sorted){this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rows,!0));let t=this.arrSort(this.columns,!1);this.colKeys.sort(t)}}arrSort(t,e){let i,r=this,n=(function(n){let s=[];for(let n=0,l=t.length;n<l;n++)if(i=t[n],r.sortRules)for(let t=0,l=r.sortRules.length;t<l;t++)r.sortRules[t].sortField===i&&s.push({field:i,fieldIndex:n,sortRule:r.sortRules[t],func:r.getSort(r.sortRules[t],e)});return s}).call(this);return function(i,s){var l,a,o,h;let u,d;for(let c=0;c<n.length;c++){if(null==(l=(d=n[c]).sortRule)?void 0:l.sortByIndicator){let n=i,l=s;d.fieldIndex<t.length-1&&(n=i.slice(0,d.fieldIndex+1),"grid"===r.rowHierarchyType&&e?n.push(r.rowSubTotalLabel):e||n.push(r.colSubTotalLabel),l=s.slice(0,d.fieldIndex+1),"grid"===r.rowHierarchyType&&e?l.push(r.rowSubTotalLabel):e||l.push(r.colSubTotalLabel)),u=d.func(n,l,null==(a=d.sortRule)?void 0:a.sortType)}else u=null==(o=d.func)?void 0:o.call(d,i[d.fieldIndex],s[d.fieldIndex],null==(h=d.sortRule)?void 0:h.sortType);if(0!==u)return u}return 0}}getSort(t,e){let i=this;return t.sortByIndicator?(r,n,l)=>{let a=function(e,r){return"grid"===i.rowHierarchyType&&e.length<i.rows.length&&e[e.length-1]!==i.rowSubTotalLabel&&e[e.length-1]!==i.rowGrandTotalLabel&&e.push(i.rowSubTotalLabel),r.length<i.columns.length&&r[r.length-1]!==i.colSubTotalLabel&&r[r.length-1]!==i.colGrandTotalLabel&&r.push(i.colSubTotalLabel),i.getAggregator(e,r,t.sortByIndicator).value()};return e?t.sortFunc?t.sortFunc(a(r,t.query),a(n,t.query),r,n,l):(0,s.SL)(a(r,t.query),a(n,t.query),l):t.sortFunc?t.sortFunc(a(t.query,r),a(t.query,n),r,n,l):(0,s.SL)(a(t.query,r),a(t.query,n),l)}:t.sortBy?(0,s.MR)(t.sortBy):t.sortFunc?t.sortFunc:t.sortType?s.y4:s.SL}totalStatistics(){var t,e,i,r,l,a,o,h,u,d,c,p,g,f;let m=this,y=(t,e)=>{var i,r,l,a,o,h,u,d,c,p,g,f,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X,q,J,Q,te;if(null==(r=null==(i=this.totalRecordsTree)?void 0:i[t])?void 0:r[e])return this.tree[t]||(this.tree[t]={}),void(this.tree[t][e]=null==(a=null==(l=this.totalRecordsTree)?void 0:l[t])?void 0:a[e]);let ti=e.split(this.stringJoinChar);if((null==(h=null==(o=m.totals)?void 0:o.column)?void 0:h.subTotalsDimensions)&&(null==(c=null==(d=null==(u=m.totals)?void 0:u.column)?void 0:d.subTotalsDimensions)?void 0:c.length)>0&&!1!==m.totals.column.showSubTotals)for(let i=0,r=null==(f=null==(g=null==(p=m.totals)?void 0:p.column)?void 0:g.subTotalsDimensions)?void 0:f.length;i<r;i++){let r=m.totals.column.subTotalsDimensions[i],l=m.columns.indexOf(r);if(l>=0){let i=ti.slice(0,l+1);i.push(m.colSubTotalLabel);let r=i.join(this.stringJoinChar);if(null==(v=null==(y=this.totalRecordsTree)?void 0:y[t])?void 0:v[r])return void(this.tree[t][r]=null==(_=null==(b=this.totalRecordsTree)?void 0:b[t])?void 0:_[r]);this.tree[t][r]||(this.tree[t][r]=[]);let a=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let i=0;i<a.length;i++)if(this.calculatedFiledKeys.indexOf(a[i])>=0){let l=null==(x=this.calculatedFieldRules)?void 0:x.find(t=>t.key===a[i]);(null==(w=null==(C=this.tree[t])?void 0:C[r])?void 0:w[i])||(this.tree[t][r][i]=new s.YJ[n.E.RECALCULATE]({key:a[i],field:a[i],isRecord:!0,formatFun:null==(A=null==(S=this.indicators)?void 0:S.find(t=>"string"!=typeof t&&t.indicatorKey===a[i]))?void 0:A.format,calculateFun:null==l?void 0:l.calculateFun,dependAggregators:this.tree[t][r],dependIndicatorKeys:null==l?void 0:l.dependIndicatorKeys})),r!==e&&this.tree[t][r][i].push(null==(k=null==(M=m.tree[t])?void 0:M[e])?void 0:k[i])}else{if(!this.tree[t][r][i]){let e=this.getAggregatorRule(a[i]);this.tree[t][r][i]=new s.YJ[null!=(T=null==e?void 0:e.aggregationType)?T:n.E.SUM]({key:a[i],field:null!=(R=null==e?void 0:e.field)?R:a[i],aggregationFun:null==e?void 0:e.aggregationFun,formatFun:null!=(B=null==e?void 0:e.formatFun)?B:null==(E=null==(P=this.indicators)?void 0:P.find(t=>"string"!=typeof t&&t.indicatorKey===a[i]))?void 0:E.format})}r!==e&&this.tree[t][r][i].push(null==(L=null==(I=m.tree[t])?void 0:I[e])?void 0:L[i])}}}if((null==(O=null==(F=m.totals)?void 0:F.column)?void 0:O.showGrandTotals)||0===this.rows.length){let i=m.colGrandTotalLabel;if(null==(H=null==(D=this.totalRecordsTree)?void 0:D[t])?void 0:H[i])return void(this.tree[t][i]=null==(W=null==(z=this.totalRecordsTree)?void 0:z[t])?void 0:W[i]);this.tree[t][i]||(this.tree[t][i]=[]);let r=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let l=0;l<r.length;l++)if(this.calculatedFiledKeys.indexOf(r[l])>=0){let a=null==(N=this.calculatedFieldRules)?void 0:N.find(t=>t.key===r[l]);(null==(G=null==(j=this.tree[t])?void 0:j[i])?void 0:G[l])||(this.tree[t][i][l]=new s.YJ[n.E.RECALCULATE]({key:r[l],field:r[l],isRecord:!0,formatFun:null==(Z=null==(V=this.indicators)?void 0:V.find(t=>"string"!=typeof t&&t.indicatorKey===r[l]))?void 0:Z.format,calculateFun:null==a?void 0:a.calculateFun,dependAggregators:this.tree[t][i],dependIndicatorKeys:null==a?void 0:a.dependIndicatorKeys})),i!==e&&this.tree[t][i][l].push(null==(K=null==(U=m.tree[t])?void 0:U[e])?void 0:K[l])}else{if(!this.tree[t][i][l]){let e=this.getAggregatorRule(r[l]);this.tree[t][i][l]=new s.YJ[null!=($=null==e?void 0:e.aggregationType)?$:n.E.SUM]({key:r[l],field:null!=(Y=null==e?void 0:e.field)?Y:r[l],formatFun:null!=(X=null==e?void 0:e.formatFun)?X:null==(J=null==(q=this.indicators)?void 0:q.find(t=>"string"!=typeof t&&t.indicatorKey===r[l]))?void 0:J.format})}i!==e&&this.tree[t][i][l].push(null==(te=null==(Q=m.tree[t])?void 0:Q[e])?void 0:te[l])}}};if((null==(e=null==(t=null==m?void 0:m.totals)?void 0:t.column)?void 0:e.subTotalsDimensions)&&(null==(l=null==(r=null==(i=null==m?void 0:m.totals)?void 0:i.column)?void 0:r.subTotalsDimensions)?void 0:l.length)>=1||(null==(o=null==(a=null==m?void 0:m.totals)?void 0:a.row)?void 0:o.subTotalsDimensions)&&(null==(d=null==(u=null==(h=null==m?void 0:m.totals)?void 0:h.row)?void 0:u.subTotalsDimensions)?void 0:d.length)>=1||(null==(p=null==(c=null==m?void 0:m.totals)?void 0:c.column)?void 0:p.showGrandTotals)||(null==(f=null==(g=null==m?void 0:m.totals)?void 0:g.row)?void 0:f.showGrandTotals)){let t=[];Object.keys(m.tree).forEach(e=>{let i=e.split(this.stringJoinChar);Object.keys(m.tree[e]).forEach(r=>{var l,a,o,h,u,d,c,p,g,f,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D;if((null==(a=null==(l=m.totals)?void 0:l.row)?void 0:a.subTotalsDimensions)&&(null==(u=null==(h=null==(o=m.totals)?void 0:o.row)?void 0:h.subTotalsDimensions)?void 0:u.length)>0&&!1!==m.totals.row.showSubTotals)for(let l=0,a=null==(p=null==(c=null==(d=m.totals)?void 0:d.row)?void 0:c.subTotalsDimensions)?void 0:p.length;l<a;l++){let a=m.totals.row.subTotalsDimensions[l],o=m.rows.indexOf(a);if(o>=0&&o<m.rows.length-1){let l=i.slice(0,o+1);"tree"!==this.rowHierarchyType&&l.push(m.rowSubTotalLabel);let a=l.join(this.stringJoinChar);this.tree[a]||(this.tree[a]={},t.push(a)),this.tree[a][r]||(this.tree[a][r]=[]);let h=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<h.length;t++){if(!this.tree[a][r][t])if(this.calculatedFiledKeys.indexOf(h[t])>=0){let e=null==(g=this.calculatedFieldRules)?void 0:g.find(e=>e.key===h[t]);this.tree[a][r][t]=new s.YJ[n.E.RECALCULATE]({key:h[t],field:h[t],isRecord:!0,formatFun:null==(v=null==(f=this.indicators)?void 0:f.find(e=>"string"!=typeof e&&e.indicatorKey===h[t]))?void 0:v.format,calculateFun:null==e?void 0:e.calculateFun,dependAggregators:this.tree[a][r],dependIndicatorKeys:null==e?void 0:e.dependIndicatorKeys})}else{let e=this.getAggregatorRule(h[t]);this.tree[a][r][t]=new s.YJ[null!=(b=null==e?void 0:e.aggregationType)?b:n.E.SUM]({key:h[t],field:null!=(_=null==e?void 0:e.field)?_:h[t],formatFun:null!=(x=null==e?void 0:e.formatFun)?x:null==(w=null==(C=this.indicators)?void 0:C.find(e=>"string"!=typeof e&&e.indicatorKey===h[t]))?void 0:w.format})}a!==e&&this.tree[a][r][t].push(null==(A=null==(S=m.tree[e])?void 0:S[r])?void 0:A[t])}}}if((null==(k=null==(M=m.totals)?void 0:M.row)?void 0:k.showGrandTotals)||0===this.columns.length){let i=m.rowGrandTotalLabel;this.tree[i]||(this.tree[i]={},t.push(i)),this.tree[i][r]||(this.tree[i][r]=[]);let l=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<l.length;t++){if(!this.tree[i][r][t])if(this.calculatedFiledKeys.indexOf(l[t])>=0){let e=null==(T=this.calculatedFieldRules)?void 0:T.find(e=>e.key===l[t]);this.tree[i][r][t]=new s.YJ[n.E.RECALCULATE]({key:l[t],field:l[t],isRecord:!0,formatFun:null==(B=null==(R=this.indicators)?void 0:R.find(e=>"string"!=typeof e&&e.indicatorKey===l[t]))?void 0:B.format,calculateFun:null==e?void 0:e.calculateFun,dependAggregators:this.tree[i][r],dependIndicatorKeys:null==e?void 0:e.dependIndicatorKeys})}else{let e=this.getAggregatorRule(l[t]);this.tree[i][r][t]=new s.YJ[null!=(P=null==e?void 0:e.aggregationType)?P:n.E.SUM]({key:l[t],field:null!=(E=null==e?void 0:e.field)?E:l[t],formatFun:null!=(I=null==e?void 0:e.formatFun)?I:null==(F=null==(L=this.indicators)?void 0:L.find(e=>"string"!=typeof e&&e.indicatorKey===l[t]))?void 0:F.format})}i!==e&&this.tree[i][r][t].push(null==(D=null==(O=m.tree[e])?void 0:O[r])?void 0:D[t])}}y(e,r)})}),t.forEach(t=>{Object.keys(m.tree[t]).forEach(e=>{y(t,e)})})}for(let t in m.totalRecordsTree)for(let e in m.totalRecordsTree[t])y(t,e)}ArrToTree1(t,e,i,r,n,s){let l=[],a=this.stringJoinChar,o=new Map;function h(t,r){let n,h=[];t.forEach((u,d)=>{var c;h.push(u);let p=h.join(a),g=o.get(p);g||(g={value:u,dimensionKey:e[d],children:d===t.length-1&&(null!=(c=null==i?void 0:i.length)?c:0)>=1?null==i?void 0:i.map(t=>"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:t.title}):[]},o.set(p,g),n?n.children.push(g):s&&r?l.unshift(g):l.push(g)),n=g})}return t.forEach(t=>h(t,!1)),r&&h([n],r),l}ArrToTree(t,e,i,r,n,s,l,a,o){var h;let u=[],d=this.stringJoinChar,c=new Map;if((null==t?void 0:t.length)?t.forEach(t=>(function(t){let n,s=[];t.forEach((a,h)=>{var p,g,f,m;s.push(a);let y=s.join(d),v=c.get(y);if(!v){if(v={value:a,dimensionKey:e[h],children:h===t.length-1&&(null!=(p=null==i?void 0:i.length)?p:0)>=1?null==i?void 0:i.map(t=>"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:t.title}):[]},r[h]){let t=null!=(g=v.children)?g:[],n={value:l,dimensionKey:e[h+1],levelSpan:r.length-h-1,children:(null!=(f=null==i?void 0:i.length)?f:0)>=1?null==i?void 0:i.map(t=>"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:t.title}):[],role:"sub-total"};t.push(n),t=null!=(m=n.children)?m:[]}c.set(y,v),n?r[h-1]&&!o?n.children.splice(n.children.length-1,0,v):n.children.push(v):u.push(v)}n=v})})(t)):i&&(u=null==i?void 0:i.map(t=>{var e;return"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:null!=(e=t.title)?e:t.indicatorKey}})),n&&(null==t?void 0:t.length)){let t={value:s,dimensionKey:e[0],levelSpan:r.length,children:null!=(h=null==i?void 0:i.map(t=>"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:t.title}))?h:[],role:"grand-total"};a?u.unshift(t):u.push(t)}return u}cacheDeminsionCollectedValues(){for(let t in this.collectValuesBy)"xField"!==this.collectValuesBy[t].type&&"yField"!==this.collectValuesBy[t].type||(this.dataConfig.dimensionSortArray?this.cacheCollectedValues[t]=function(t,e){return t.sort((t,i)=>{let r=e.indexOf(t),n=e.indexOf(i);return r<n?-1:+(r>n)})}(this.collectedValues[t],this.dataConfig.dimensionSortArray):this.cacheCollectedValues[t]=this.collectedValues[t])}changeTreeNodeValue(t=[],e=[],i,r){var n,l,a,o,h;let u,d,c=this.indicatorKeys.indexOf(i);u="string"==typeof t?t:t.join(this.stringJoinChar),d="string"==typeof e?e:e.join(this.stringJoinChar),"string"==typeof r&&(isNaN(parseFloat(r))||(r=parseFloat(r))),(null==(n=this.changedTree[u])?void 0:n[d])||(this.changedTree[u]||(this.changedTree[u]={}),this.changedTree[u][d]=[]),this.changedTree[u][d][c]=r;let p=null==(a=null==(l=this.tree[u])?void 0:l[d])?void 0:a[c];if(1===(null==p?void 0:p.records.length)&&(p.records[0][this.indicatorKeys[c]]=r),null!=(h=null==(o=this.dataConfig)?void 0:o.updateAggregationOnEditCell)&&h)if(p)p.changedValue=r,this.recalculateTotals(t,e,i);else{let n=new s.__({key:i,field:i,isRecord:!0});n.changedValue=r,this.recalculateTotals(t,e,i,n)}}recalculateTotals(t=[],e=[],i,r){var n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D,H,z;if(!this.totals||0===Object.keys(this.tree).length||!((null==(n=this.totals.row)?void 0:n.showGrandTotals)||(null==(s=this.totals.row)?void 0:s.subTotalsDimensions)&&this.totals.row.subTotalsDimensions.length>0&&!1!==this.totals.row.showSubTotals)&&!((null==(l=this.totals.column)?void 0:l.showGrandTotals)||(null==(a=this.totals.column)?void 0:a.subTotalsDimensions)&&this.totals.column.subTotalsDimensions.length>0&&!1!==this.totals.column.showSubTotals))return;let W=Array.isArray(t)?t.join(this.stringJoinChar):t,N=Array.isArray(e)?e.join(this.stringJoinChar):e,j=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(i),G=new Set,V=new Set,Z=W.split(this.stringJoinChar),U=N.split(this.stringJoinChar),K=(t,e,i)=>{t&&(e!==W||i!==N)&&(G.add(t),e!==W&&i!==N||V.add(t))};if((null==(h=null==(o=this.totals)?void 0:o.row)?void 0:h.subTotalsDimensions)&&!1!==this.totals.row.showSubTotals)for(let t=0;t<this.totals.row.subTotalsDimensions.length;t++){let e=this.totals.row.subTotalsDimensions[t],i=this.rows.indexOf(e);if(i>=0&&i<Z.length){let t=Z.slice(0,i+1);"tree"!==this.rowHierarchyType&&t.push(this.rowSubTotalLabel);let e=t.join(this.stringJoinChar);if((null==(d=null==(u=this.tree[e])?void 0:u[N])?void 0:d[j])&&K(this.tree[e][N][j],e,N),(null==(p=null==(c=this.totals)?void 0:c.column)?void 0:p.subTotalsDimensions)&&!1!==this.totals.column.showSubTotals)for(let t=0;t<this.totals.column.subTotalsDimensions.length;t++){let i=this.totals.column.subTotalsDimensions[t],r=this.columns.indexOf(i);if(r>=0&&r<U.length){let t=U.slice(0,r+1);t.push(this.colSubTotalLabel);let i=t.join(this.stringJoinChar);(null==(f=null==(g=this.tree[e])?void 0:g[i])?void 0:f[j])&&K(this.tree[e][i][j],e,i)}}(null==(y=null==(m=this.totals)?void 0:m.column)?void 0:y.showGrandTotals)&&(null==(b=null==(v=this.tree[e])?void 0:v[this.colGrandTotalLabel])?void 0:b[j])&&K(this.tree[e][this.colGrandTotalLabel][j],e,this.colGrandTotalLabel)}}if(null==(x=null==(_=this.totals)?void 0:_.row)?void 0:x.showGrandTotals){if(null==(w=null==(C=this.tree[this.rowGrandTotalLabel])?void 0:C[N])?void 0:w[j]){if(K(this.tree[this.rowGrandTotalLabel][N][j],this.rowGrandTotalLabel,N),(null==(A=null==(S=this.totals)?void 0:S.column)?void 0:A.subTotalsDimensions)&&!1!==this.totals.column.showSubTotals)for(let t=0;t<this.totals.column.subTotalsDimensions.length;t++){let e=this.totals.column.subTotalsDimensions[t],i=this.columns.indexOf(e);if(i>=0&&i<U.length){let t=U.slice(0,i+1);t.push(this.colSubTotalLabel);let e=t.join(this.stringJoinChar);(null==(k=null==(M=this.tree[this.rowGrandTotalLabel])?void 0:M[e])?void 0:k[j])&&K(this.tree[this.rowGrandTotalLabel][e][j],this.rowGrandTotalLabel,e)}}(null==(R=null==(T=this.totals)?void 0:T.column)?void 0:R.showGrandTotals)&&(null==(P=null==(B=this.tree[this.rowGrandTotalLabel])?void 0:B[this.colGrandTotalLabel])?void 0:P[j])&&K(this.tree[this.rowGrandTotalLabel][this.colGrandTotalLabel][j],this.rowGrandTotalLabel,this.colGrandTotalLabel)}if((null==(I=null==(E=this.totals)?void 0:E.column)?void 0:I.subTotalsDimensions)&&!1!==this.totals.column.showSubTotals)for(let t=0;t<this.totals.column.subTotalsDimensions.length;t++){let e=this.totals.column.subTotalsDimensions[t],i=this.columns.indexOf(e);if(i>=0&&i<U.length){let t=U.slice(0,i+1);t.push(this.colSubTotalLabel);let e=t.join(this.stringJoinChar);(null==(F=null==(L=this.tree[W])?void 0:L[e])?void 0:F[j])&&K(this.tree[W][e][j],W,e)}}(null==(D=null==(O=this.totals)?void 0:O.column)?void 0:D.showGrandTotals)&&(null==(z=null==(H=this.tree[W])?void 0:H[this.colGrandTotalLabel])?void 0:z[j])&&K(this.tree[W][this.colGrandTotalLabel][j],W,this.colGrandTotalLabel),G.forEach(t=>{r&&V.has(t)&&t.push(r),t.recalculate()})}}changeRecordFieldValue(t,e,i){let r=!1;for(let e=0;e<this.indicatorKeys.length;e++)this.indicatorKeys[e]===t&&(r=!0);if(!r){if(Array.isArray(this.records))for(let r=0,n=this.records.length;r<n;r++){let n=this.records[r];n[t]===e&&(n[t]=i)}else for(let r in this.records)for(let n=0,s=this.records[r].length;n<s;n++){let s=this.records[r][n];s[t]===e&&(s[t]=i)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}_rowTreeHasChanged(){this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))}changeDataConfig(t){this.rows=t.rows,this.columns=t.columns}addRecords(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];this.processRecord(i)}Array.isArray(this.records)&&this.records.push(t)}customTreeToDimensionPathArr(t,e){let i=[],n=this;return null==t||t.forEach(t=>(function t(s,l){var a,o,h;s.virtual||((null==(a=l[l.length-1])?void 0:a.childKeys)&&s.dimensionKey&&-1===l[l.length-1].childKeys.indexOf(s.dimensionKey)&&s.dimensionKey!==l[l.length-1].dimensionKey&&l[l.length-1].childKeys.push(s.dimensionKey),l.push({dimensionKey:(0,r.Z)(s.indicatorKey)?void 0:s.dimensionKey,value:s.value,indicatorKey:s.indicatorKey,virtual:s.virtual})),(null==(o=s.children)?void 0:o.length)>0?("tree"===n.rowHierarchyType&&"row"===e&&(l[l.length-1].childKeys=[],i.push([...l])),null==(h=s.children)||h.forEach(e=>t(e,[...l]))):i.push(l)})(t,[])),i}getFieldMatchColDimensionPaths(t){var e,i;let r=[];for(let n=0;n<(null!=(i=null==(e=this.customColTreeDimensionPaths)?void 0:e.length)?i:0);n++){let e=this.customColTreeDimensionPaths[n],i=!0;for(let r=0;r<e.length;r++){let n=e[r];if(n.dimensionKey&&t[n.dimensionKey]!==n.value||n.indicatorKey&&void 0===t[n.indicatorKey]){i=!1;break}}i&&r.push(e)}return r}getFieldMatchRowDimensionPaths(t){var e,i;let n=[];for(let s=0;s<(null!=(i=null==(e=this.customRowTreeDimensionPaths)?void 0:e.length)?i:0);s++){let e=this.customRowTreeDimensionPaths[s],i=!0;for(let n=0;n<e.length;n++){let s=e[n];if(s.dimensionKey&&t[s.dimensionKey]!==s.value||s.indicatorKey&&void 0===t[s.indicatorKey]||s.childKeys&&n===e.length-1&&s.childKeys.length>0&&s.childKeys.find(e=>(0,r.Z)(t[e]))){i=!1;break}}i&&(this.indicatorsAsCol||"tree"!==this.rowHierarchyType||e.find(t=>t.indicatorKey)||(i=!1)),i&&n.push(e)}return n}}},84826:function(t,e,i){"use strict";i.d(e,{$:()=>a});var r=i(99506),n=i(75382),s=i(57657),l=i(18585);class a{constructor(t){this.isValidatingValue=!1,this.listenersId=[],this.table=t,this.bindEvent()}bindEvent(){let t=this.table,e=t.on(r.B.DBLCLICK_CELL,e=>{var i,r,s;let{editCellTrigger:l="doubleclick"}=t.options;if(!l.includes("doubleclick"))return;let{col:a,row:o}=e,h=(0,n.RJ)(e.federatedEvent),u=t.scenegraph.getResizeColAt(h.abstractPos.x,h.abstractPos.y,null==(i=h.eventArgs)?void 0:i.targetCell);t._canResizeColumn(u.col,u.row)&&u.col>=0||(null==(s=null==(r=e.target)?void 0:r.attribute)?void 0:s.funcType)||(this.beginTriggerEditCellMode="doubleclick",this.startEditCell(a,o))}),i=t.on(r.B.CLICK_CELL,e=>{var i,r;let{editCellTrigger:n="doubleclick"}=t.options;if("click"===n||Array.isArray(n)&&n.includes("click")){if(null==(r=null==(i=e.target)?void 0:i.attribute)?void 0:r.funcType)return;this.beginTriggerEditCellMode="click";let{col:t,row:n}=e;this.startEditCell(t,n)}});this.listenersId.push(e,i)}startEditCell(t,e,i){var r,n,s,a,o,h,u,d,c;if(this.editingEditor)return;let p=this.table.getEditor(t,e);if(p){if(null==(n=null==(r=this.table.internalProps.layoutMap)?void 0:r.isAggregation)?void 0:n.call(r,t,e)){let t=null==(a=(s=this.table).isPivotTable)?void 0:a.call(s),e=!!t&&(null==(h=null==(o=this.table.internalProps)?void 0:o.dataConfig)?void 0:h.updateAggregationOnEditCell);if(!t||t&&e)return}let g=this.table.getCellRawRecord(t,e);if(null==g?void 0:g.vtableMerge)return;this.editingEditor||(this.editCell={col:t,row:e}),this.table._makeVisibleCell(t,e),this.editingEditor=p;let f=(0,l.Z)(i)?i:this.table.getCellOriginValue(t,e),m=this.table.getCellRangeRelativeRect(this.table.getCellRange(t,e)),y={rect:{left:m.left,top:m.top,width:m.width,height:m.height}};t===this.table.colCount-1?y.rect.width=m.width-1:y.rect.width=m.width+1,e===this.table.rowCount-1?y.rect.height=m.height-1:y.rect.height=m.height+1,p.beginEditing,null==(u=p.beginEditing)||u.call(p,this.table.getElement(),y,f),p.bindSuccessCallback,null==(d=p.bindSuccessCallback)||d.call(p,()=>{this.completeEdit()}),null==(c=p.onStart)||c.call(p,{value:f,endEdit:()=>{this.completeEdit()},referencePosition:y,container:this.table.getElement(),col:t,row:e,table:this.table})}}completeEdit(t){var e,i;if(!this.editingEditor)return!0;if(this.isValidatingValue)return!1;let r=null==t?void 0:t.target,{editingEditor:n}=this;if(r){if(n.targetIsOnEditor){if(n.targetIsOnEditor(r))return!1}else if(!n.isEditorElement||n.isEditorElement(r))return!1}if(this.editingEditor.getValue,this.editingEditor.validateValue){this.isValidatingValue=!0;let r=this.editingEditor.getValue(),n=this.table.getCellOriginValue(this.editCell.col,this.editCell.row),l=null==t?void 0:t.target,a=null==(i=(e=this.editingEditor).validateValue)?void 0:i.call(e,r,n,this.editCell,this.table,!!this.table.getElement().contains(l));return(0,s.tI)(a)?(this.isValidatingValue=!0,new Promise((t,e)=>{a.then(e=>{o(e,this,n,t)}).catch(t=>{this.isValidatingValue=!1,e(t)})})):o(a,this,n)}return this.doExit(),!0}doExit(){var t,e,i,r,n,s,l,a;let o=null==(e=(t=this.editingEditor).getValue)?void 0:e.call(t),h=this.table.getCellRange(this.editCell.col,this.editCell.row),u=[];for(let t=h.start.row;t<=h.end.row;t++){let t=[];for(let e=h.start.col;e<=h.end.col;e++)t.push(o);u.push(t)}null==(r=(i=this.editingEditor).beforeEnd)||r.call(i),this.table.changeCellValues(h.start.col,h.start.row,u),this.editingEditor.exit,null==(s=(n=this.editingEditor).exit)||s.call(n),null==(a=(l=this.editingEditor).onEnd)||a.call(l),this.editingEditor=null,this.isValidatingValue=!1,this.beginTriggerEditCellMode=null}cancelEdit(){var t,e,i,r;this.editingEditor&&(null==(e=(t=this.editingEditor).exit)||e.call(t),null==(r=(i=this.editingEditor).onEnd)||r.call(i),this.editingEditor=null)}release(){this.listenersId.forEach(t=>{this.table.off(t)})}}function o(t,e,i,r){return e.isValidatingValue=!1,"validate-exit"===t?(e.doExit(),null==r||r(!0),!0):"invalidate-exit"===t?(e.editingEditor.setValue(i),e.doExit(),null==r||r(!0),!0):"validate-not-exit"===t||"invalidate-not-exit"===t?(null==r||r(!1),!1):!0===t?(e.doExit(),null==r||r(!0),!0):(null==r||r(!1),!1)}},85865:function(t,e,i){"use strict";i.d(e,{U:()=>n,X:()=>r});let r={};function n(t){if(r[t])return r[t]}},78287:function(t,e,i){"use strict";i.d(e,{b:()=>a});var r=i(67283),n=i(84375);let s=1;class l{constructor(t,e,i){var n;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{let t=this.getSize(),e=!1;t.width===this.lastSize.width&&t.height===this.lastSize.height&&(e=!0),this.lastSize=t,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:e}))},this.onResize=()=>{this.callBackDebounce()},this.element=t,this.cb=e,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=(0,r.D)(this.callBack,this.resizeTime),null==window||window.addEventListener("resize",this.onResize),"ResizeObserver"in window){let t=window.ResizeObserver;this.observer=new t(this.mutationResize),null==(n=this.observer)||n.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(t){this.lastSize=t}checkSize(){let t=this.getSize();return t.width!==this.lastSize.width||t.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}}class a{constructor(){this.listeners={},this.reseizeListeners={}}on(t,e,i,...r){if("node"===n.X.mode)return -1;let a=s++;if(null==t?void 0:t.addEventListener)if("resize"!==e||t===window)null==t||t.addEventListener(e,i,...r);else{let e=new l(t,i,this.resizeTime);this.reseizeListeners[a]=e}return this.listeners[a]={target:t,type:e,listener:i,options:r},a}once(t,e,i,...r){if("node"===n.X.mode)return -1;let s=this.on(t,e,(...t)=>{this.off(s),i(...t)},...r);return s}off(t){var e;if("node"===n.X.mode||null===t)return;let i=null==(e=this.listeners)?void 0:e[t];i&&(delete this.listeners[t],i.target.removeEventListener&&i.target.removeEventListener(i.type,i.listener,...i.options))}fire(t,e,...i){if("node"!==n.X.mode)for(let r in this.listeners){let n=this.listeners[r];n.target===t&&n.type===e&&n.listener.call(n.target,...i)}}hasListener(t,e){if("node"===n.X.mode)return!1;let i=!1;for(let r in this.listeners){let n=this.listeners[r];n.target===t&&n.type===e&&(i=!0)}return i}clear(){if("node"!==n.X.mode){for(let t in this.listeners){let e=this.listeners[t];e.target.removeEventListener&&e.target.removeEventListener(e.type,e.listener,...e.options)}for(let t in this.reseizeListeners){let e=this.reseizeListeners[t];null==e||e.disConnect()}this.listeners={}}}release(){"node"!==n.X.mode&&(this.clear(),this.listeners={})}}},80747:function(t,e,i){"use strict";i.d(e,{R:()=>s});var r=i(18585);let n=1;class s{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(t,e){let i=this.listenersData.listeners[t]||(this.listenersData.listeners[t]=[]);i.push(e);let r=n++;return this.listenersData.listenerData[r]={type:t,listener:e,remove:()=>{delete this.listenersData.listenerData[r];let n=i.indexOf(e);i.splice(n,1),this.listenersData.listeners[t].length||delete this.listenersData.listeners[t]}},r}off(t,e){var i;if(e)this.removeEventListener(t,e);else{if(!this.listenersData)return;null==(i=this.listenersData.listenerData[t])||i.remove()}}addEventListener(t,e,i){this.on(t,e)}removeEventListener(t,e){if(this.listenersData)for(let i in this.listenersData.listenerData){let r=this.listenersData.listenerData[i];r.type===t&&r.listener===e&&this.off(i)}}hasListeners(t){return!!this.listenersData&&!!this.listenersData.listeners[t]}fireListeners(t,e){if(!this.listenersData)return[];let i=this.listenersData.listeners[t];return i?i.map(t=>t.call(this,e)).filter(t=>(0,r.Z)(t)):[]}release(){delete this.listenersData}}},75382:function(t,e,i){"use strict";i.d(e,{J$:()=>s,RJ:()=>n,xD:()=>l});var r=i(18585);function n(t){let e={abstractPos:{x:t.viewport.x,y:t.viewport.y}},i=s(t.target);return i&&(e.eventArgs={col:i.col,row:i.row,event:t,targetCell:i,mergeInfo:function(t){if((0,r.Z)(t.mergeStartCol)&&(0,r.Z)(t.mergeStartRow)&&(0,r.Z)(t.mergeEndCol)&&(0,r.Z)(t.mergeEndRow))return{colStart:t.mergeStartCol,colEnd:t.mergeEndCol,rowStart:t.mergeStartRow,rowEnd:t.mergeEndRow}}(i),target:t.target}),e}function s(t){for(;t&&t.parent;){if("cell"===t.role)return t;t=t.parent}return null}let l=/radio-\d+-\d+-(\d+)/},70107:function(t,e,i){"use strict";let r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M;i.d(e,{E6:()=>P,U2:()=>L,ci:()=>I});var k=i(44186),T=i(57657),R=i(70107),B=i(13455);function P(t){var e,i,k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$;r=null!=(e=null==t?void 0:t.sort_color)?e:"#282F38",n=null!=(i=null==t?void 0:t.sort_color_opacity)?i:"0.35",s=null!=(k=null==t?void 0:t.sort_color_2)?k:"#416EFF",l=null!=(T=null==t?void 0:t.sort_color_opacity_2)?T:"1",a=null!=(R=null==t?void 0:t.sort_size)?R:16,o=null!=(B=null==t?void 0:t.sort_size_2)?B:22,h=null!=(P=null==t?void 0:t.frozen_color)?P:"#282F38",u=null!=(E=null==t?void 0:t.frozen_color_opacity)?E:"0.35",d=null!=(I=null==t?void 0:t.frozen_color_opacity)?I:"0.2",c=null!=(L=null==t?void 0:t.frozen_color_2)?L:"#416EFF",p=null!=(F=null==t?void 0:t.frozen_color_opacity_2)?F:"1",g=null!=(O=null==t?void 0:t.frozen_size)?O:22,f=null!=(D=null==t?void 0:t.frozen_size_2)?D:22,m=null!=(H=null==t?void 0:t.collapse_color)?H:"#141414",y=null!=(z=null==t?void 0:t.collapse_color_opacity)?z:"0.65",v=null!=(W=null==t?void 0:t.collapse_size)?W:16,b=null!=(N=null==t?void 0:t.frozen_size_2)?N:22,_=null!=(j=null==t?void 0:t.expand_color)?j:"#141414",x=null!=(G=null==t?void 0:t.expand_color_opacity)?G:"0.65",C=null!=(V=null==t?void 0:t.expand_size)?V:16,w=null!=(Z=null==t?void 0:t.expand_size_2)?Z:22,S=null!=(U=null==t?void 0:t.dragReorder_color)?U:"#666666",A=null!=(K=null==t?void 0:t.dragReorder_color_opacity)?K:"1",M=null!=($=null==t?void 0:t.dragReorder_size)?$:20}let E={get sort_downward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${s}"  fill-opacity="${l}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${r}" fill-opacity="${n}"/></svg> `,width:a,height:a,funcType:k.cI.sort,name:"sort_downward",positionType:k.q0.contentRight,marginLeft:3,hover:{width:o,height:o,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_upward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${r}"  fill-opacity="${n}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${s}"  fill-opacity="${l}"/> </svg>`,width:a,height:a,funcType:k.cI.sort,positionType:k.q0.contentRight,name:"sort_upward",marginLeft:3,hover:{width:o,height:o,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_normal(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${r}" fill-opacity="${n}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${r}" fill-opacity="${n}"/></svg> `,width:a,height:a,funcType:k.cI.sort,positionType:k.q0.contentRight,name:"sort_normal",marginLeft:3,hover:{width:o,height:o,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get freeze(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path d="M17.1313 8.42047C17.1932 8.48238 17.2423 8.55587 17.2759 8.63676C17.3094 8.71764 17.3266 8.80434 17.3266 8.89189C17.3266 8.97944 17.3094 9.06613 17.2759 9.14702C17.2423 9.2279 17.1932 9.3014 17.1313 9.3633L13.3843 13.1103C13.7007 14.3048 13.5305 15.4443 12.8388 16.2395C12.8104 16.2781 12.7778 16.3136 12.7417 16.3451L12.712 16.3755C12.6501 16.4374 12.5766 16.4865 12.4957 16.52C12.4148 16.5535 12.3281 16.5707 12.2406 16.5707C12.153 16.5707 12.0663 16.5535 11.9854 16.52C11.9046 16.4865 11.8311 16.4374 11.7692 16.3755L9.17633 13.7826L6.05316 16.9058L5.11983 17.0925C5.09291 17.0979 5.06508 17.0965 5.03881 17.0886C5.01254 17.0806 4.98863 17.0663 4.96923 17.0469C4.94982 17.0275 4.9355 17.0036 4.92755 16.9773C4.9196 16.951 4.91827 16.9232 4.92366 16.8963L5.11033 15.963L8.23333 12.8396L5.64066 10.2471C5.57875 10.1852 5.52964 10.1117 5.49614 10.0309C5.46263 9.94997 5.44539 9.86327 5.44539 9.77572C5.44539 9.68817 5.46263 9.60148 5.49614 9.52059C5.52964 9.43971 5.57875 9.36621 5.64066 9.3043C5.65066 9.2943 5.66066 9.2843 5.67099 9.27464C5.70266 9.2383 5.73833 9.20547 5.77766 9.17664C6.57283 8.48564 7.71199 8.31564 8.90599 8.63197L12.6528 4.88497C12.7147 4.82306 12.7882 4.77395 12.8691 4.74045C12.95 4.70694 13.0367 4.6897 13.1242 4.6897C13.2118 4.6897 13.2985 4.70694 13.3794 4.74045C13.4603 4.77395 13.5338 4.82306 13.5957 4.88497L17.1312 8.42047H17.1313ZM15.7172 8.8918L13.1243 6.29914L9.56483 9.8588C9.47574 9.94788 9.36323 10.0099 9.24034 10.0376C9.11746 10.0654 8.98922 10.0578 8.87049 10.0156C8.22783 9.78764 7.63899 9.7553 7.17749 9.89814L12.1182 14.8388C12.261 14.3771 12.2287 13.7885 12.0007 13.146C11.9585 13.0272 11.9509 12.899 11.9787 12.7761C12.0064 12.6532 12.0684 12.5407 12.1575 12.4516L15.7172 8.89164V8.8918Z" fill="${h}" fill-opacity="${d}"/></g><defs><clipPath id="clip0"><rect width="22" height="22" fill="white"/></clipPath></defs></svg>`,width:g,height:g,name:"freeze",funcType:k.cI.frozen,positionType:k.q0.right,marginRight:0,hover:{width:f,height:f,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozen(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z" fill="${h}" fill-opacity="${u}"/></svg>`,width:g,height:g,name:"frozen",funcType:k.cI.frozen,positionType:k.q0.right,marginRight:0,hover:{width:f,height:f,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozenCurrent(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z"  fill="${c}" fill-opacity="${p}"/></svg>`,width:g,height:g,funcType:k.cI.frozen,positionType:k.q0.right,name:"frozenCurrent",marginRight:0,hover:{width:f,height:f,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get dropdownIcon(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="white"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#959DA5"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="#4F5965"/></svg>',width:24,height:24,funcType:k.cI.dropDown,positionType:k.q0.absoluteRight,name:"dropdownIcon",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)",image:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="#1E54C9"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#141414" stroke-opacity="0.2"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="white"/></svg>'},cursor:"pointer",visibleTime:"mouseenter_cell"}},get play(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01" /><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /><path d="M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /></svg>',width:24,height:24,funcType:k.cI.play,positionType:k.q0.right,name:"play",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get damage_pic(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 10V38C5 39.1046 5.89543 40 7 40H14H18L15 29L22 27L21 20L29 16L27 13L30 8H7C5.89543 8 5 8.89543 5 10Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M43 38V10C43 8.89543 42.1046 8 41 8H38L34 14L37 19L28 23L29 31L22 33L24 40H41C42.1046 40 43 39.1046 43 38Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 18C15.3284 18 16 17.3284 16 16.5C16 15.6716 15.3284 15 14.5 15C13.6716 15 13 15.6716 13 16.5C13 17.3284 13.6716 18 14.5 18Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',width:24,height:24,funcType:k.cI.damagePic,positionType:k.q0.left,name:"damage_pic",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get loading_pic(){return{type:"svg",svg:'<svg viewBox="0 0 400 300" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="50" y="65" width="301" height="170"><path d="M350.3 65H50v169.8h300.3V65Z" fill="#fff"/></mask><g mask="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M58.3 233.2h32.8v-36.8H58.3v36.8Z" fill="#C7DEFF"/><path d="M91.1 224.5v8.8H58.3M82.4 196.2H58.3" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M305.4 182.5s-2.7 12.6 0 17.4c2.7 4.8 8.3 6.7 12.4 4.4 4.2-2.4 5.3-8.1 2.6-12.9-2.7-4.8-15-8.9-15-8.9ZM336 204.7c4.3 2 9.7-.4 12-5.4 2.3-5-1.5-17.3-1.5-17.3s-11.8 5.1-14.1 10.1c-2.3 5-.7 10.6 3.6 12.6Z" fill="#00E4E5"/><path fill-rule="evenodd" clip-rule="evenodd" d="M326.7 174s-10 11.8-10 18.6c0 6.7 4.5 12.2 10 12.2s10-5.5 10-12.3c0-6.8-10-18.5-10-18.5Z" fill="#00E4E5"/><path d="M332.3 181.5c2.3 3.6 4.4 7.8 4.4 10.9M316.7 192.5c0-3.1 2.1-7.2 4.3-10.8" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M343.1 227.3v-9.7h-34v9.7c0 3.7 3 6.6 6.6 6.6h20.9c3.6 0 6.5-2.9 6.5-6.6Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M350.4 220.8V198H302v22.8c0 5.9 4.8 10.7 10.7 10.7h26.9c5.9 0 10.7-4.8 10.8-10.7Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M331.7 74.2H117.8L87.4 203h213.8l30.5-128.8Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M337 74.2h-6.2l-30.6 129.2h6.2L337 74.2Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M303.8 203.5h2.4l30.7-129.3h-1.8l-31.3 129.3Z" fill="#C7DEFF"/><path d="m337 74.2-30.6 129.2h-5.9" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M229.9 202.1h-47.6l2 9.6h47.3l-1.7-9.6Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path d="M138.5 74.2h193.2l-23.4 98.6M94.5 172.7l11-46.3M104.8 155.4l-2.3 11.5h6.7M316 112.1l1.1-4.5" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M148.3 138.1h97V119h-97v19.1Z" fill="#00E4E5"/><path d="M303.1 80.6h20.3l-4.6 19.6M228.3 234.3c3.6 0 6.3-3.2 5.7-6.8l-4.1-24.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M226.2 229.5h-68.9v1.2c0 2 1.6 3.7 3.7 3.7h60.1c2.8 0 5-2.2 5.1-4.9Z" fill="#C7DEFF"/><path d="M180.699 226.8h-19.9c-2.8 0-4.6 3-3.3 5.5m0 0c.6 1.2 1.9 2 3.3 2h57.8M175.9 203.4l3.6 17.6M241.2 234.3h65.1M104.6 234.3h41.3" stroke="#071F4D"/><path d="M206.2 234.3h14.9c3.1 0 5.5-2.8 5-5.9l-4.3-24.9M160.7 226.8h46M62.2 226.1h-9.5c-1.2 0-2.2-1-2.2-2.2v-18.3c0-1.2 1-2.2 2.2-2.2h9.5" stroke="#071F4D"/><path d="M53.4 171.7H68c2.1 0 3.7 1.7 3.7 3.7v16.1M79.1 192v-21.8c0-2.5 2-4.6 4.6-4.6h2.2c2.5 0 4.5-2 4.5-4.5m0 0c0-2.5-2-4.5-4.5-4.5H56.1c-2.4 0-4.3-1.9-4.3-4.3V148M71.2 165.2h-18M64 181.7v10.1" stroke="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.7 120H124c4.3 0 7.7-3.5 7.7-7.7V65.5H94.2c-4.7 0-8.5 4.9-8.5 11V120Z" fill="#C7DEFF"/><path d="M85.7 110.7V73c0-4.1 3.4-7.5 7.5-7.5h38.5M146.2 73.8v-2.5c0-3.2-2-5.8-5.8-5.8-2.8 0-6 1.1-6 5.8v42.4c0 4.7-3.8 8.5-8.5 8.5h-15.6" stroke="#071F4D"/><path d="M119.7 122.3H87c-6.1 0-11.1-5-11.1-11.1m0 0h39M126.1 122.3c-6.1 0-11.1-5-11.1-11.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.4 122.1h37.2c-6.5-1.8-8-10.5-8-10.5H76.2c.6 8.8 9.2 10.5 9.2 10.5Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M95.8 102.9h4.8V83.6h-4.8v19.3ZM106.6 102.9h4.8V77.6h-4.8v25.3ZM117.3 102.9h4.8V89.1h-4.8v13.8Z" fill="#fff"/><path d="M273.2 195.9h16.9M261.2 195.9h5" stroke="#fff"/><path d="M62.4 201.9v2.9M62.4 224.5v2.9" stroke="#071F4D"/><path d="m153.6 138.1 9.7-19.1M168.8 138.1l9.7-19.1M184.1 138.1l9.7-19.1M199.4 138.1l9.7-19.1M214.6 138.1l9.8-19.1M229.9 138.1l9.7-19.1" stroke="#fff"/><path d="M148.3 138.1h121.6V119H148.3v19.1Z" stroke="#071F4D"/></g></svg>',width:400,height:300,name:"loading_pic",positionType:k.q0.left}},get expand(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M4.64988 6.81235C4.38797 6.48497 4.62106 6 5.04031 6L10.9597 6C11.3789 6 11.612 6.48497 11.3501 6.81235L8.39043 10.512C8.19027 10.7622 7.80973 10.7622 7.60957 10.512L4.64988 6.81235Z" fill="${_}" fill-opacity="${x}"/>
      </svg>`,width:C,height:C,funcType:k.cI.expand,name:"expand",positionType:k.q0.contentLeft,marginLeft:0,marginRight:4,hover:{width:w,height:w,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get collapse(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M5.81235 11.3501C5.48497 11.612 5 11.3789 5 10.9597L5 5.04031C5 4.62106 5.48497 4.38797 5.81235 4.64988L9.51196 7.60957C9.76216 7.80973 9.76216 8.19027 9.51196 8.39044L5.81235 11.3501Z"  fill="${m}" fill-opacity="${y}"/>
      </svg>`,width:v,height:v,funcType:k.cI.collapse,name:"collapse",positionType:k.q0.contentLeft,marginLeft:0,marginRight:4,hover:{width:b,height:b,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get drillDown(){return{name:"drillDown",type:"svg",positionType:k.q0.absolute,funcType:k.cI.drillDown,svg:B.gm,width:13,height:13,cursor:"pointer"}},get drillUp(){return{name:"drillUp",type:"svg",positionType:k.q0.absolute,funcType:k.cI.drillUp,svg:B.Zj,width:13,height:13,cursor:"pointer"}},get dragReorder(){return{type:"svg",svg:`<svg t="1710129136961" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5166" width="200" height="200"><path d="M362.666667 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5167"></path><path d="M661.333333 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5168"></path><path d="M362.666667 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5169"></path><path d="M661.333333 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5170"></path><path d="M362.666667 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5171"></path><path d="M661.333333 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5172"></path></svg>`,width:M,height:M,funcType:k.cI.dragReorder,positionType:k.q0.left,name:"dragReorder",marginLeft:-10,marginRight:10,cursor:"grab"}}},I={};function L(){return(0,T.l7)(E,R.ci)}},81774:function(t,e,i){"use strict";i.d(e,{iN:()=>S,Wm:()=>A,hZ:()=>_,Vp:()=>w,dK:()=>x,V4:()=>T});var r,n,s=i(58977),l=i(91212),a=i(43735),o=i(18585),h=i(33657);function u(t){return 2===t.length&&(0,h.Z)(t[0])&&(0,h.Z)(t[1])&&t[1]>=t[0]}function d(t){let e=t[1]-t[0],i=t[1]*t[0]<0,r=t[0]<=0?0-t[0]:0,n=t[1]>0?t[1]-0:0;return 0===e?t[0]<0?(r=1,n=0):t[0]>0&&(r=0,n=1):(r/=e,n/=e),{total:e,negative:r,positive:n,includeZero:i,domain:t,extendable_min:!0,extendable_max:!0}}function c(t,e){let{positive:i,negative:r,extendable_min:n,extendable_max:s,domain:l}=t,{positive:a,negative:o,extendable_min:h,extendable_max:u,domain:d}=e;if(a>0){if(!h)return!1;let t=r/i;s&&(t=r/Math.max(i,a),l[1]=-l[0]/t),d[0]=-d[1]*t}else if(o>0){if(!u)return!1;let t=i/r;n&&(t=i/Math.max(r,r),l[0]=-l[1]/t),d[1]=-d[0]*t}return!0}function p(t,e){let{extendable_min:i,extendable_max:r,domain:n}=t,{positive:s,negative:l,domain:a}=e;return(0!==s||0!==l)&&!(s>0&&!r)&&!(l>0&&!i)&&(n[0]=a[0],n[1]=a[1],!0)}function g(t,e){let{positive:i,negative:r,extendable_max:n,domain:s}=t,{positive:l,negative:a,extendable_min:o,domain:h}=e;if(n&&o){let t=Math.max(r,a)/Math.max(i,l);s[1]=-s[0]/t,h[0]=-h[1]*t}else if(o)h[0]=-h[1]*(r/i);else{if(!n)return!1;s[1]=-s[0]/(a/l)}return!0}function f(t,e){let{extendable_min:i,domain:r}=t,{extendable_max:n,domain:s}=e;return!(!i||!n)&&(r[0]=-r[1],s[1]=-s[0],!0)}var m=i(13844),y=i(14828),v=i(67203),b=i(91304);function _(t,e,i){var r,n,h,u,d,c,p,g,f,m,_,C,w,S,A,k;if(i._table.isPivotChart())if(i.indicatorsAsCol){if(i.hasTwoIndicatorAxes&&e===i.columnHeaderLevelCount-1&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount){let r=M("top",t,e+1,t,i.columnHeaderLevelCount-1,t,e,1,i);if(!r)return;let n=i._table._getCellStyle(t,e+1),a=(0,y.u)((0,v.WJ)("padding",n,t,e+1,i._table)),{range:o,ticks:h,axisOption:u,targetTicks:d,targetRange:c,index:p,theme:g}=r;return(0,s.Z)(null==u?void 0:u.min)&&(o.min=u.min,o.min>0&&(u.zero=!1)),(0,s.Z)(null==u?void 0:u.max)&&(o.max=u.max,o.max<0&&(u.zero=!1)),(0,l.Z)({range:o},u,{orient:"top",type:(null==u?void 0:u.type)||"linear",label:{flush:!0},tick:{tickMode:(0,b.h)(d,c,o,p)},__ticksForVTable:h,__vtableChartTheme:g,__vtablePadding:a})}if(e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount){let a=i.getIndicatorKeyInChartSpec(t,e),o=null;null==a||a.forEach(t=>{let e=i.getIndicatorInfo(t);e&&(o=e)});let h=M("bottom",t,e-1,t,e,t,e,0,i),{chartType:u}=x(t,e-1,"bottom",i);if(!h)return;let d=i._table._getCellStyle(t,e-1),c=(0,y.u)((0,v.WJ)("padding",d,t,e-1,i._table)),{range:p,ticks:g,axisOption:f,index:m,targetTicks:_,targetRange:C,theme:w}=h;(0,s.Z)(null==f?void 0:f.min)&&(p.min=f.min,p.min>0&&(f.zero=!1)),(0,s.Z)(null==f?void 0:f.max)&&(p.max=f.max,p.max<0&&(f.zero=!1));let S=[];if("heatmap"===u){let s=i.getDimensionKeyInChartSpec(t,i.rowCount-i.bottomFrozenRowCount-1,"xField"),l=null!=(r=i.dataset.collectedValues[s])?r:[],a=i.getColKeysPath(t,e);S=null!=(n=null==l?void 0:l[null!=a?a:""])?n:[]}return(0,l.Z)({title:{visible:!0,text:null==o?void 0:o.title},range:p,domain:"linear"===(null==f?void 0:f.type)?void 0:Array.from(S)},f,{orient:"bottom",type:(null==f?void 0:f.type)||"linear",label:{flush:!0},tick:{tickMode:(0,b.h)(_,C,p,m)},__ticksForVTable:g,__vtableChartTheme:w,__vtablePadding:c})}if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount){let r,n=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,e);(0,a.Z)(n)&&(n=n[0]);let s=null!=(h=i.dataset.collectedValues[n])?h:[],p=i.getRowKeysPath(t,e),g=null!=(u=s[null!=p?p:""])?u:[],{axisOption:f,theme:m,chartType:b}=x(t+1,e,"left",i);if(!1===(null==f?void 0:f.visible))return;let _=i._table._getCellStyle(t+1,e),C=(0,y.u)((0,v.WJ)("padding",_,t+1,e,i._table)),w=i.getRawChartSpec(t+1,e);return(0,l.Z)({domain:"linear"===(null==f?void 0:f.type)?void 0:Array.from(g),range:"linear"===(null==f?void 0:f.type)?g:void 0,title:{autoRotate:!0}},f,{orient:"left",type:null!=(d=null==f?void 0:f.type)?d:"band",__vtableChartTheme:m,inverse:(S=f,A="horizontal"===(null!=(c=null==w?void 0:w.direction)?c:"scatter"===b?"vertical":"horizontal"),r=null==S?void 0:S.inverse,A&&"bottom"!==(k=null==S?void 0:S.orient)&&"top"!==k&&(r=!(0,o.Z)(null==S?void 0:S.inverse)||!(null==S?void 0:S.inverse)),r),__vtablePadding:C})}}else{if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount){let r=i.getIndicatorKeyInChartSpec(t,e),n=null;null==r||r.forEach(t=>{let e=i.getIndicatorInfo(t);e&&(n=e)});let a=M("left",t+1,e,t,e,t,e,0,i),{chartType:o}=x(t+1,e,"left",i);if(!a)return;let h=i._table._getCellStyle(t+1,e),u=(0,y.u)((0,v.WJ)("padding",h,t+1,e,i._table)),{range:d,ticks:c,axisOption:f,index:m,targetTicks:_,targetRange:C,theme:w}=a;(0,s.Z)(null==f?void 0:f.min)&&(d.min=f.min,d.min>0&&(f.zero=!1)),(0,s.Z)(null==f?void 0:f.max)&&(d.max=f.max,d.max<0&&(f.zero=!1));let S=[];if("heatmap"===o){let r=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,e,"yField"),n=null!=(p=i.dataset.collectedValues[r])?p:[],s=i.getRowKeysPath(t,e);S=null!=(g=null==n?void 0:n[null!=s?s:""])?g:[]}return(0,l.Z)({title:{visible:!0,text:null==n?void 0:n.title,autoRotate:!0},range:d,domain:"linear"===(null==f?void 0:f.type)?void 0:Array.from(S)},f,{orient:"left",type:(null==f?void 0:f.type)||"linear",label:{flush:!0},tick:{tickMode:(0,b.h)(_,C,d,m)},__ticksForVTable:c,__vtableChartTheme:w,__vtablePadding:u})}if(t===i.colCount-i.rightFrozenColCount&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount){let r=M("right",t-1,e,i.rowHeaderLevelCount-1,e,t,e,1,i),{chartType:n}=x(t-1,e,"right",i);if(!r)return;let a=i._table._getCellStyle(t-1,e),o=(0,y.u)((0,v.WJ)("padding",a,t-1,e,i._table)),{range:h,ticks:u,axisOption:d,index:c,targetTicks:p,targetRange:g,theme:_}=r;(0,s.Z)(null==d?void 0:d.min)&&(h.min=d.min,h.min>0&&(d.zero=!1)),(0,s.Z)(null==d?void 0:d.max)&&(h.max=d.max,h.max<0&&(d.zero=!1));let C=[];if("heatmap"===n){let r=i.getDimensionKeyInChartSpec(i.colCount-i.rightFrozenColCount-1,e,"yField"),n=null!=(f=i.dataset.collectedValues[r])?f:[],s=i.getRowKeysPath(t,e);C=null!=(m=null==n?void 0:n[null!=s?s:""])?m:[]}return(0,l.Z)({range:h,title:{autoRotate:!0},domain:"linear"===(null==d?void 0:d.type)?void 0:Array.from(C)},d,{orient:"right",type:(null==d?void 0:d.type)||"linear",label:{flush:!0},tick:{tickMode:(0,b.h)(p,g,h,c)},__ticksForVTable:u,__vtableChartTheme:_,__vtablePadding:o})}if(e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount){let r=i.getDimensionKeyInChartSpec(t,i.columnHeaderLevelCount);(0,a.Z)(r)&&(r=r[0]);let n=null!=(_=i.dataset.collectedValues[r])?_:[],s=i.getColKeysPath(t,e),o=null!=(C=null==n?void 0:n[null!=s?s:""])?C:[],{axisOption:h,isPercent:u,theme:d,chartType:c}=x(t,e-1,"bottom",i);if(!1===(null==h?void 0:h.visible))return;let p=i._table._getCellStyle(t,e-1),g=(0,y.u)((0,v.WJ)("padding",p,t,e-1,i._table));return(0,l.Z)({domain:"linear"===(null==h?void 0:h.type)?void 0:Array.from(o),range:"linear"===(null==h?void 0:h.type)?o:void 0},h,{orient:"bottom",type:null!=(w=null==h?void 0:h.type)?w:"band",__vtableChartTheme:d,__vtablePadding:g})}}}function x(t,e,i,r){var n,s;let l=r.getRawChartSpec(t,e),h=null!=(n=l.axes)?n:[];if(r._table.pivotChartAxes.forEach(t=>{-1===h.findIndex(e=>t.orient===e.orient)&&h.push(t)}),l&&(0,a.Z)(h)){let t=h.find(t=>t.orient===i);if(t){let e,n,{seriesIndex:h,seriesId:u}=t;(0,o.Z)(u)&&(0,a.Z)(l.series)?e=((0,a.Z)(u)?u:[u]).map(t=>{let e=l.series.findIndex(e=>e.id===t);return e>=0&&(n=l.series[e]),e}):(0,o.Z)(h)&&(0,a.Z)(l.series)&&(e=h);let{isZeroAlign:d,isTickAlign:c}=C(l,i,r);return{axisOption:t,isPercent:l.percent,isZeroAlign:d,isTickAlign:c,seriesIndice:e,theme:l.theme,chartType:null!=(s=null==n?void 0:n.type)?s:l.type}}}let u=r._table.pivotChartAxes.find(t=>t.orient===i),{isZeroAlign:d,isTickAlign:c}=C(l,i,r);return{axisOption:u,isPercent:!1,isZeroAlign:d,isTickAlign:c,theme:l.theme,chartType:l.type}}function C(t,e,i){let r,n=[];"left"===e||"right"===e?n.push("left","right"):"top"!==e&&"bottom"!==e||n.push("top","bottom"),r=t&&(0,a.Z)(t.axes)?t.axes:i._table.pivotChartAxes;let s=!1,l=!1;if((0,a.Z)(r)){let t=[];r.forEach(e=>{n.includes(e.orient)&&t.push(e)});for(let e=0;e<t.length;e++){let i=t[e];i.sync&&i.sync.axisId&&t.find(t=>t.id===i.sync.axisId)&&(s=s||i.sync.zeroAlign,l=l||i.sync.tickAlign)}}return{isZeroAlign:s,isTickAlign:l}}function w(t,e,i){if(!i._table.isPivotChart())return!1;if(i.indicatorsAsCol){if(i.hasTwoIndicatorAxes&&e===i.columnHeaderLevelCount-1&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount||e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount)return!0}else if(e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount)return!0;return!1}function S(t,e,i){if(!i._table.isPivotChart())return!1;if(i.indicatorsAsCol){if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return!0}else if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount||t===i.colCount-i.rightFrozenColCount&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return!0;return!1}function A(t,e,i,r){if(!((0,a.Z)(t.axes)&&0!==t.axes.length||(0,a.Z)(e)&&0!==e.length))return i&&r||!i&&!r;if((0,a.Z)(t.axes)&&t.axes.length>0)for(let e=0;e<t.axes.length;e++){let n=t.axes[e];if(!i&&r&&"bottom"===n.orient){if("heatmap"===t.type)return"linear"===n.type;if("linear"===n.type)return!0}if(i&&r&&"bottom"===n.orient){if("heatmap"===t.type)return"linear"===n.type;if("linear"!==n.type)return!0}if(!i&&!r&&"left"===n.orient){if("heatmap"===t.type)return"linear"===n.type;if("linear"!==n.type)return!0}if(i&&!r&&"left"===n.orient){if("heatmap"===t.type)return"linear"===n.type;if("linear"===n.type)return!0}}if((0,a.Z)(e)&&e.length>0)for(let n=0;n<e.length;n++){let s=e[n];if(!i&&r&&"bottom"===s.orient){if("heatmap"===t.type)return"linear"===s.type;if("linear"===s.type)return!0}if(i&&r&&"bottom"===s.orient){if("heatmap"===t.type)return"linear"===s.type;if("linear"!==s.type)return!0}if(!i&&!r&&"left"===s.orient){if("heatmap"===t.type)return"linear"===s.type;if("linear"!==s.type)return!0}if(i&&!r&&"left"===s.orient){if("heatmap"===t.type)return"linear"===s.type;if("linear"===s.type)return!0}}return i&&r||!i&&!r}function M(t,e,i,r,n,s,l,a,o){let h,u=o.getIndicatorKeyInChartSpec(r,n);h="top"===t||"bottom"===t?o.getColKeysPath(s,l):o.getRowKeysPath(s,l);let d=k(e,i,a,t,u,h,o);if(!d)return;let c="bottom"===t?"top":"top"===t?"bottom":"left"===t?"right":"left",{targetRange:p,targetTicks:g}=R(e,i,d.index,d.isZeroAlign,d.isTickAlign,d.range,u,c,h,o);if(0!==d.index&&g){let{range:e,ticks:i}=m.F.getFunction("getAxisDomainRangeAndLabels")(d.range.min,d.range.max,d.axisOption,d.isZeroAlign,"bottom"===t||"top"===t?o._table.getColWidth(s)||o._table.tableNoFrameWidth:o._table.getRowHeight(l)||o._table.tableNoFrameHeight,{targetTicks:g,targetRange:p});d.range.min=e[0],d.range.max=e[1],d.ticks=i}return d.targetRange=p,d.targetTicks=g,d}function k(t,e,i,r,n,o,h){let{axisOption:u,isPercent:d,isZeroAlign:c,isTickAlign:p,seriesIndice:g,theme:f,chartType:y}=x(t,e,r,h),v=function t(e,i,r,n,s){var o;if((0,a.Z)(s)){let l={min:1/0,max:-1/0};for(let a=0;a<s.length;a++){let o=t(e,i,r,n,s[a]);o&&(l.min=Math.min(l.min,o.min),l.max=Math.max(l.max,o.max))}return isFinite(l.min)&&isFinite(l.max)?l:null}let h=null==i?void 0:i[s];if((0,a.Z)(h)&&(h=h[0]),!h)return null;let u=e[h],d=(0,l.Z)({},null!=(o=null==u?void 0:u[null!=n?n:""])?o:{min:0,max:1});return d.positiveMax&&d.positiveMax>d.max&&(d.max=d.positiveMax),d.negativeMin&&d.negativeMin<d.min&&(d.min=d.negativeMin),d.min===d.max&&(d.min>0?d.min=0:d.max=0),d}(h.dataset.collectedValues,n,c,o,null!=g?g:i);if(!v)return;d&&(v.min=v.min<0?-1:0,v.max=+(v.max>0)),((null==u?void 0:u.zero)||v.min===v.max)&&(v.min=Math.min(v.min,0),v.max=Math.max(v.max,0));let{range:b,ticks:_}=m.F.getFunction("getAxisDomainRangeAndLabels")(v.min,v.max,u,c,"bottom"===r||"top"===r?h._table.getColWidth(t)||h._table.tableNoFrameWidth:h._table.getRowHeight(e)||h._table.tableNoFrameHeight);return(null==u?void 0:u.nice)&&(v.min=b[0],v.max=b[1]),(0,s.Z)(null==u?void 0:u.min)&&(v.min=u.min),(0,s.Z)(null==u?void 0:u.max)&&(v.max=u.max),{index:null!=g?g:i,range:v,ticks:_,isZeroAlign:c,isTickAlign:p,axisOption:u,theme:f,chartType:y}}function T(t,e,i,r,n,s,a,o){let{range:h,isZeroAlign:u,isTickAlign:d,axisOption:c}=k(t,e,i,r,s,a,o),{targetRange:p,targetTicks:g}=R(t,e,i,u,d,h,s,n,a,o);if(0!==i&&g){let{range:i,ticks:n}=m.F.getFunction("getAxisDomainRangeAndLabels")(h.min,h.max,(0,l.Z)({},c,{nice:!0,tick:{forceTickCount:g.length}}),u,"bottom"===r||"top"===r?o._table.getColWidth(t)||o._table.tableNoFrameWidth:o._table.getRowHeight(e)||o._table.tableNoFrameHeight,{targetTicks:g,targetRange:p});h.min=i[0],h.max=i[1]}return{axisOption:c,range:h,targetTicks:g,targetRange:p}}function R(t,e,i,r,n,s,l,a,o,h){let m,y;if(!r&&!n)return{targetTicks:m,targetRange:y};let v=k(t,e,l.length-1-i,a,l,o,h);if(v){let{range:l,ticks:o}=v;if(y=l,r){let t=function(t,e){let i=[t.min,t.max],r=[e.min,e.max];if(!u(i)||!u(r))return;let n=d(i),s=d(r),{positive:l,negative:a,extendable_min:o,extendable_max:h,includeZero:m}=n,{positive:y,negative:v,extendable_min:b,extendable_max:_,includeZero:x}=s;if(0===l&&0===a){if(!p(n,s))return}else if(0===y&&0===v){if(!p(s,n))return}else if(m||x)if(m&&!x){if(!c(n,s))return}else if(x&&!m){if(!c(s,n))return}else{if(a===v)return;if(a>v){if(!g(n,s))return}else if(!g(s,n))return}else{if(0===a&&0===y){if(!f(n,s))return}else if(0===v&&0===l&&!f(s,n))return;if(0===a&&0===v)if(0===i[0]&&r[0]>0){if(!b)return;r[0]=0}else{if(!(0===r[0]&&i[0]>0)||!o)return;i[0]=0}if(0===l&&0===y)if(0===i[1]&&r[1]>0){if(!_)return;r[1]=0}else{if(!(0===r[1]&&i[1]>0)||!h)return;i[1]=0}}return{range1:i,range2:r}}(s,l);t&&(s.min=t.range1[0],s.max=t.range1[1],y.min=t.range2[0],y.max=t.range2[1])}n&&(m=r?(0,b.r)(y,t,e,i,a,h):o)}return{targetTicks:m,targetRange:y}}(r=n||(n={})).vertical="vertical",r.horizontal="horizontal"},62413:function(t,e,i){"use strict";i.d(e,{K0:()=>y,TF:()=>c,TQ:()=>v,VR:()=>f,YL:()=>_,aw:()=>m,eW:()=>g,ed:()=>d,f_:()=>p,py:()=>b});var r=i(43735),n=i(58977),s=i(91212),l=i(81774),a=i(70656),o=i(94055),h=i(91304);let u="NO_AXISID_FRO_VTABLE";function d(t,e,i){var r,n;let s,l=i.getCellHeaderPaths(t,e);if(i.indicatorsAsCol){let t=null==(r=l.colHeaderPaths.find(t=>t.indicatorKey))?void 0:r.indicatorKey;s=i.columnObjects.find(e=>e.indicatorKey===t)}else{let t=null==(n=l.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:n.indicatorKey;s=i.columnObjects.find(e=>e.indicatorKey===t)}let a=null==s?void 0:s.chartSpec;return"function"==typeof a?a({col:t,row:e,dataValue:i._table.getCellOriginValue(t,e)||"",value:i._table.getCellValue(t,e)||"",rect:i._table.getCellRangeRelativeRect(i._table.getCellRange(t,e)),table:i._table}):a}function c(t,e,i){var r,n;let s,l=i.getCellHeaderPaths(t,e);if(i.indicatorsAsCol){let t=null==(r=l.colHeaderPaths.find(t=>t.indicatorKey))?void 0:r.indicatorKey;s=i.columnObjects.find(e=>e.indicatorKey===t)}else{let t=null==(n=l.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:n.indicatorKey;s=i.columnObjects.find(e=>e.indicatorKey===t)}return"function"!=typeof(null==s?void 0:s.chartSpec)}function p(t,e,i){var r,n;let s,l=i.getCellHeaderPaths(t,e);if(i.indicatorsAsCol){let t=null==(r=l.colHeaderPaths.find(t=>t.indicatorKey))?void 0:r.indicatorKey;s=i.columnObjects.find(e=>e.indicatorKey===t)}else{let t=null==(n=l.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:n.indicatorKey;s=i.columnObjects.find(e=>e.indicatorKey===t)}return null==s?void 0:s.noDataRenderNothing}function g(t){let e=!1;for(let i=0;i<t.length;i++){let r=t[i];if(r.chartSpec&&"wordCloud"!==r.chartSpec.type&&"radar"!==r.chartSpec.type&&"gauge"!==r.chartSpec.type&&"pie"!==r.chartSpec.type&&"funnel"!==r.chartSpec.type&&"rose"!==r.chartSpec.type&&"sunburst"!==r.chartSpec.type&&"treemap"!==r.chartSpec.type&&"sankey"!==r.chartSpec.type&&"circlePacking"!==r.chartSpec.type){e=!0;break}}return e}function f(t,e,i){let r=!0,n=i.getRawChartSpec(t,e);return n&&"pie"!==n.type&&"radar"!==n.type&&"gauge"!==n.type&&"wordCloud"!==n.type&&"funnel"!==n.type&&"rose"!==n.type&&"sunburst"!==n.type&&"treemap"!==n.type&&"sankey"!==n.type&&"circlePacking"!==n.type||(r=!1),r}function m(t,e,i,r){let n=!1;if(r.indicatorsAsCol&&"row"===i||!r.indicatorsAsCol&&"col"===i)for(let t=0;t<r.indicatorsDefine.length;t++){let e=r.indicatorsDefine[t];if(e.chartSpec&&"pie"!==e.chartSpec.type&&"wordCloud"!==e.chartSpec.type&&"radar"!==e.chartSpec.type&&"gauge"!==e.chartSpec.type&&"funnel"!==e.chartSpec.type&&"rose"!==e.chartSpec.type&&"sunburst"!==e.chartSpec.type&&"treemap"!==e.chartSpec.type&&"sankey"!==e.chartSpec.type&&"circlePacking"!==e.chartSpec.type){n=!0;break}}else{let i=r.getRawChartSpec(t,e);i?"pie"!==i.type&&"radar"!==i.type&&"gauge"!==i.type&&"wordCloud"!==i.type&&"funnel"!==i.type&&"rose"!==i.type&&"sunburst"!==i.type&&"treemap"!==i.type&&"sankey"!==i.type&&"circlePacking"!==i.type&&(n=!0):n=!1}return n}function y(t,e,i){let n=i.getRawChartSpec(t,e);return n?(i._table.isPivotChart()&&((n=(0,a.u)(n)).sortDataByAxis=!0,(0,r.Z)(n.series)&&n.series.forEach(t=>{t.sortDataByAxis=!0}),"pie"!==n.type&&"radar"!==n.type&&"gauge"!==n.type&&"wordCloud"!==n.type&&"funnel"!==n.type&&"rose"!==n.type&&"sunburst"!==n.type&&"treemap"!==n.type&&"sankey"!==n.type&&"circlePacking"!==n.type&&(n.axes=i.getChartAxes(t,e)),n.padding=0,n.dataZoom=[]),n):null}function v(t,e,i){var a,d,c;let p=[];if(i.indicatorsAsCol){let d=i.getIndicatorKeyInChartSpec(t,e),c=i.getColKeysPath(t,e);d.forEach((r,a)=>{let{range:g,targetTicks:f,targetRange:m,axisOption:y}=(0,l.V4)(t,e,a,0===a?"bottom":"top",0===a?"top":"bottom",d,c,i);(0,n.Z)(null==y?void 0:y.min)&&(g.min=y.min),(0,n.Z)(null==y?void 0:y.max)&&(g.max=y.max),x(y,p)||p.push((0,s.Z)({range:g,label:{style:{fontSize:o.$M}}},y,{type:(null==y?void 0:y.type)||"linear",orient:0===a?"bottom":"top",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:(null==y?void 0:y.seriesId)?void 0:a,tick:{tickMode:(0,h.h)(f,m,g,a)},sync:{axisId:u}}))});let g=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,e);(0,r.Z)(g)&&(g=g[0]);let f=i.dataset.cacheCollectedValues[g]||i.dataset.collectedValues[g]||[],m=i.getRowKeysPath(t,e),y=f[null!=m?m:""],{axisOption:v,isPercent:b,chartType:_}=(0,l.dK)(t,e,"left",i);p.push((0,s.Z)({domain:"linear"!==(null==v?void 0:v.type)||Array.isArray(y)?Array.from(null!=y?y:[]):void 0,range:"linear"!==(null==v?void 0:v.type)||Array.isArray(y)?void 0:y,label:{style:{fontSize:o.$M}}},v,{type:null!=(a=null==v?void 0:v.type)?a:"band",orient:"left",label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}else{let a=i.getIndicatorKeyInChartSpec(t,e),g=i.getRowKeysPath(t,e);a.forEach((r,d)=>{var c,f;let{range:m,targetTicks:y,targetRange:v,axisOption:b}=(0,l.V4)(t,e,d,0===d?"left":"right",0===d?"right":"left",a,g,i);if((0,n.Z)(null==b?void 0:b.min)&&(m.min=b.min),(0,n.Z)(null==b?void 0:b.max)&&(m.max=b.max),x(b,p))return;let{chartType:_}=(0,l.dK)(t,e,0===d?"left":"right",i),C=[];if("heatmap"===_){let r=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,e,"yField"),n=null!=(c=i.dataset.collectedValues[r])?c:[],s=i.getRowKeysPath(t,e);C=null!=(f=null==n?void 0:n[null!=s?s:""])?f:[]}p.push((0,s.Z)({range:m,label:{style:{fontSize:o.$M}},domain:"linear"===(null==b?void 0:b.type)?void 0:Array.from(C)},b,{type:(null==b?void 0:b.type)||"linear",orient:0===d?"left":"right",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:(null==b?void 0:b.seriesId)?void 0:d,tick:{tickMode:(0,h.h)(y,v,m,d),visible:!1},sync:{axisId:u}}))});let f=i.getDimensionKeyInChartSpec(t,i.columnHeaderLevelCount);(0,r.Z)(f)&&(f=f[0]);let m=i.dataset.cacheCollectedValues[f]||i.dataset.collectedValues[f]||[],y=i.getColKeysPath(t,e),v=null!=(d=null==m?void 0:m[null!=y?y:""])?d:[],{axisOption:b,isPercent:_,chartType:C}=(0,l.dK)(t,e,"bottom",i);p.push((0,s.Z)({domain:"linear"!==(null==b?void 0:b.type)||Array.isArray(v)?Array.from(null!=v?v:[]):void 0,range:"linear"!==(null==b?void 0:b.type)||Array.isArray(v)?void 0:v,label:{style:{fontSize:o.$M}}},b,{type:null!=(c=null==b?void 0:b.type)?c:"band",orient:"bottom",visible:!0,label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}return p}function b(t,e,i){var r;let n=i.getRawChartSpec(t,e);if(null==n?void 0:n.series){let t={};return(null==(r=n.data)?void 0:r.id)&&(t[n.data.id]=void 0),null==n||n.series.forEach(e=>{var i,r,s,l,a,o,h,u,d,c,p;if(!(null==(i=e.data)?void 0:i.fromDataId))if(null==(r=e.data)?void 0:r.transforms)t[null!=(p=null!=(d=null==(u=e.data)?void 0:u.id)?d:null==(c=n.data)?void 0:c.id)?p:"data"]=void 0;else{let i="horizontal"===e.direction?e.xField:e.yField;t[null!=(o=null!=(l=null==(s=e.data)?void 0:s.id)?l:null==(a=n.data)?void 0:a.id)?o:"data"]=(null==(h=e.data)?void 0:h.id)?i:void 0}}),t}return n.data.id}function _(t){let e=!1;for(let i=0;i<t.columnObjects.length;i++)if(t.columnObjects[i].chartSpec){e=!0;break}return e}function x(t,e){return!!(t&&(0,r.Z)(t.seriesId))&&!!(t.seriesId.length>0)&&!!(e.filter(e=>!(e.orient!==t.orient||!e.seriesId||e.seriesId.length!==t.seriesId.length||!e.seriesId.every((e,i)=>e===t.seriesId[i]))).length>0)}},91304:function(t,e,i){"use strict";i.d(e,{h:()=>l,r:()=>s});var r=i(13844),n=i(81774);function s(t,e,i,s,l,a){let o=r.F.getFunction("getAxisDomainRangeAndLabels"),{axisOption:h,isZeroAlign:u}=(0,n.dK)(e,i,0===s?"right":"left",a),{ticks:d}=o(t.min,t.max,h,u,"bottom"===l||"top"===l?a._table.getColWidth(e)||a._table.tableNoFrameWidth:a._table.getRowHeight(i)||a._table.tableNoFrameHeight);return d}function l(t,e,i,r){return 0!==r&&t?()=>t.map(t=>{let r=(t-e.min)/(e.max-e.min);return Math.round(100*((i.max-i.min)*r+i.min))/100}):void 0}},83906:function(t,e,i){"use strict";i.d(e,{C1:()=>u,MP:()=>a,N3:()=>d,OT:()=>o,Ul:()=>c,VN:()=>p,WM:()=>h,uu:()=>g});var r=i(43735),n=i(58853),s=i(20595),l=i(10026);function a(t){let e=t.columnObjects;for(let t=0;t<e.length;t++){let i=e[t];if(null==i?void 0:i.aggregation)return!0}return!1}function o(t){let e=t.columnObjects,i=0;for(let t=0;t<e.length;t++){let r=e[t];(null==r?void 0:r.aggregation)&&(Array.isArray(null==r?void 0:r.aggregation)?i=Math.max(i,r.aggregation.filter(t=>t.showOnTop).length):r.aggregation.showOnTop&&(i=Math.max(i,1)))}return i}function h(t){let e=t.columnObjects,i=0;for(let t=0;t<e.length;t++){let r=e[t];(null==r?void 0:r.aggregation)&&(Array.isArray(null==r?void 0:r.aggregation)?i=Math.max(i,r.aggregation.filter(t=>!t.showOnTop).length):r.aggregation.showOnTop||(i=Math.max(i,1)))}return i}function u(t){if(t._table.internalProps.groupBy)return!0;let{columns:e}=t._table.options;if((0,r.Z)(e)&&e.length>0)for(let t=0;t<e.length;t++){let i=e[t];if(!(0,n.Z)(i)&&i.tree)return!0}return!1}function d(t){let{columns:e,rows:i,indicators:s}=t.options;if(t.isPivotTable()){if((0,r.Z)(e)&&e.length>0)for(let t=0;t<e.length;t++){let i=e[t];if(!(0,n.Z)(i)&&("image"===i.headerType||"video"===i.headerType||"function"==typeof i.headerType)&&i.imageAutoSizing)return!0}if((0,r.Z)(i)&&i.length>0)for(let t=0;t<i.length;t++){let e=i[t];if(!(0,n.Z)(e)&&("image"===e.headerType||"video"===e.headerType||"function"==typeof e.headerType)&&e.imageAutoSizing)return!0}if((0,r.Z)(s)&&s.length>0)for(let t=0;t<s.length;t++){let e=s[t];if(!(0,n.Z)(e)&&(("image"===e.cellType||"video"===e.cellType||"function"==typeof e.cellType)&&e.imageAutoSizing||("image"===e.headerType||"video"===e.headerType||"function"==typeof e.headerType)&&e.imageAutoSizing))return!0}}else if((0,r.Z)(e)&&e.length>0)for(let t=0;t<e.length;t++){let i=e[t];if(("image"===i.cellType||"video"===i.cellType||"function"==typeof i.cellType)&&i.imageAutoSizing||("image"===i.headerType||"video"===i.headerType||"function"==typeof i.headerType)&&i.imageAutoSizing)return!0}return!1}function c(t,e){var i,r,n,a,o,h,u,d,c,g,f,m,y,v,b;let _,x;e.columnTree&&(!1!==t.options.indicatorsAsCol&&!1!==t.options.supplementIndicatorNodes&&(t.internalProps.columnTree=p(t.internalProps.columnTree,e.indicators)),_=new l.KO(null!=(i=t.internalProps.columnTree)?i:[],t.layoutNodeId,t.options.columnHierarchyType,"grid"!==t.options.columnHierarchyType?null!=(r=t.options.columnExpandLevel)?r:1:void 0)),e.rowTree&&(!1===t.options.indicatorsAsCol&&!1!==t.options.supplementIndicatorNodes&&(t.internalProps.rowTree=p(t.internalProps.rowTree,e.indicators)),x=new l.KO(null!=(n=t.internalProps.rowTree)?n:[],t.layoutNodeId,t.options.rowHierarchyType,"grid"!==t.options.rowHierarchyType?null!=(a=t.options.rowExpandLevel)?a:1:void 0));let C=(null==(o=null==x?void 0:x.dimensionKeys)?void 0:o.count)?x.dimensionKeys.valueArr():null!=(u=null==(h=e.rows)?void 0:h.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?u:[],w=(null==(d=null==_?void 0:_.dimensionKeys)?void 0:d.count)?_.dimensionKeys.valueArr():null!=(g=null==(c=e.columns)?void 0:c.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?g:[],S=null!=(m=null==(f=e.indicators)?void 0:f.reduce((e,i)=>{var r;return"string"==typeof i?e.push(i):(e.push(i.indicatorKey),(i.chartSpec||i.sparklineSpec)&&((null==(r=t.internalProps.dataConfig)?void 0:r.aggregationRules)?t.internalProps.dataConfig.aggregationRules.find(t=>t.indicatorKey===i.indicatorKey)||t.internalProps.dataConfig.aggregationRules.push({field:i.indicatorKey,indicatorKey:i.indicatorKey,aggregationType:s.E.NONE}):t.internalProps.dataConfig?t.internalProps.dataConfig.aggregationRules=[{field:i.indicatorKey,indicatorKey:i.indicatorKey,aggregationType:s.E.NONE}]:t.internalProps.dataConfig={aggregationRules:[{field:i.indicatorKey,indicatorKey:i.indicatorKey,aggregationType:s.E.NONE}]})),e},[]))?m:[];return"grid"!==e.rowHierarchyType&&(null!=(v=null==(y=e.extensionRows)?void 0:y.length)?v:0)>=1&&(null==(b=e.extensionRows)||b.forEach(t=>{let e=[];t.rows.forEach(t=>{"string"==typeof t?e.push(t):e.push(t.dimensionKey)}),C.push(...e)})),{rowKeys:C,columnKeys:w,indicatorKeys:S,columnDimensionTree:_,rowDimensionTree:x}}function p(t,e){let i=(t,r)=>{t.forEach(t=>{var n;t.indicatorKey||r||(null==(n=t.children)?void 0:n.length)&&t.children?t.children&&Array.isArray(t.children)&&i(t.children,r||!!t.indicatorKey):t.children=null==e?void 0:e.map(t=>{var e;return"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:null!=(e=t.title)?e:t.indicatorKey}})})};return(null==t?void 0:t.length)?i(t,!1):t=null==e?void 0:e.map(t=>{var e;return"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:null!=(e=t.title)?e:t.indicatorKey}}),t}function g(t,e,i,r){let n=[];for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t];(null==i?void 0:i.hide)&&n.push(i)}(n.length||i)&&(0,l.gD)(t,[],n,i,r)}},82499:function(t,e,i){"use strict";i.d(e,{z:()=>g});var r=i(12588),n=i(73664),s=i(13455),l=i(62413),a=i(10026),o=i(43735),h=i(19465),u=i(18585),d=i(14828),c=i(13844);let p={startInTotal:0,afterSpanLevel:0};class g{constructor(t,e,i,n){var l,a,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k;this.colIndex=0,this._showHeader=!0,this.columnHeaderObjs=[],this.rowHeaderObjs=[],this._cornerHeaderCellFullPathIds=[],this._columnHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds_FULL=[],this._cornerHeaderCellIds=[],this._columnHeaderCellIds=[],this._rowHeaderCellIds=[],this._rowHeaderCellIds_FULL=[],this._columnWidths=[],this.columnPaths=[],this._headerObjects=[],this._headerObjectMap={},this._indicators=[],this.indicatorsAsCol=!0,this.hideIndicatorName=!1,this._showRowHeader=!0,this._showColumnHeader=!0,this._indicatorShowType="column",this.rowHierarchyTextStartAlignment=!1,this.rowDimensionKeys=[],this.colDimensionKeys=[],this.indicatorKeys=[],this.indicatorDimensionKey=s.ek,this._rowHeaderExtensionTree={},this._extensionRowDimensionKeys=[],this.fullRowDimensionKeys=[],this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this._useGetBodyCache=!1,this._getBodyCache=new Map,this._useHeaderPathCache=!1,this._colHeaderPathCache=new Map,this._rowHeaderPathCache=new Map,this.sharedVar=t.layoutNodeId,this._table=t,"tree"===t.options.rowHierarchyType&&(this.extensionRows=t.options.extensionRows),this.dataset=e,this._largeCellRangeCache=[],this._CellHeaderPathMap=new Map,this.rowTree=t.internalProps.rowTree,this.columnTree=t.internalProps.columnTree,this.rowsDefine=null!=(l=t.internalProps.rows)?l:[],this.columnsDefine=null!=(a=t.internalProps.columns)?a:[],this.indicatorsDefine=null!=(h=t.internalProps.indicators)?h:[],this.indicatorTitle=t.options.indicatorTitle,this.indicatorsAsCol=null==(u=t.options.indicatorsAsCol)||u,this.hideIndicatorName=null!=(d=t.options.hideIndicatorName)&&d,this.showRowHeader=null==(c=t.options.showRowHeader)||c,this.showColumnHeader=null==(p=t.options.showColumnHeader)||p,this.rowHeaderTitle=t.options.rowHeaderTitle,this.columnHeaderTitle=t.options.columnHeaderTitle,this.rowHierarchyType=null!=(g=t.options.rowHierarchyType)?g:"grid",this.columnHierarchyType=null!=(f=t.options.columnHierarchyType)?f:"grid",this.rowExpandLevel=null!=(m=t.options.rowExpandLevel)?m:1,this.columnExpandLevel=null!=(y=t.options.columnExpandLevel)?y:1,this.rowHierarchyIndent=null!=(v=t.options.rowHierarchyIndent)?v:20,this.rowHierarchyTextStartAlignment=t.options.rowHierarchyTextStartAlignment,this.cornerSetting=Object.assign({titleOnDimension:"column",forceShowHeader:!1},t.options.corner),(null==(_=null==(b=this._table.options)?void 0:b.customConfig)?void 0:_.enablePivotPathCache)&&(this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()),e&&(this.rowTree=e.rowHeaderTree,this.columnTree=e.colHeaderTree),null==(x=this.indicatorsDefine)||x.forEach(t=>{"string"==typeof t?this.indicatorKeys.push(t):this.indicatorKeys.push(t.indicatorKey)}),this.columnDimensionTree=i,this.rowDimensionTree=n,this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this.resetRowHeaderLevelCount(),this._table.isPivotChart()&&(this.hasTwoIndicatorAxes=this.indicatorsDefine.some(t=>{var e,i;if(t.chartSpec&&t.chartSpec.series&&t.chartSpec.series.length>1){let r=null!=(i=null!=(e=t.chartSpec.axes)?e:this._table.pivotChartAxes)?i:[];if(!r.length||r.every(t=>t.orient!==(this.indicatorsAsCol?"top":"right")||!1!==t.visible))return!0}return!1})),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=(0,r.p4)(this._rowHeaderCellFullPathIds_FULL),"tree"===t.options.rowHierarchyType&&(null==(C=this.extensionRows)?void 0:C.length)>=1&&(this.generateExtensionRowTree(),this.extensionRows.forEach(t=>{let e=[];t.rows.forEach(t=>{"string"==typeof t?e.push(t):e.push(t.dimensionKey)}),this._extensionRowDimensionKeys.push(e),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(e)})),this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let T,R=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr();!this.dataset||this._table.isPivotChart()||0!==(null!=(S=null==(w=this.dataset.records)?void 0:w.length)?S:0)||this.dataset.customColTree||(R=this.columnsDefine.map(t=>"string"==typeof t?t:t.dimensionKey),this.indicatorsAsCol&&R.push(this.indicatorDimensionKey)),R=this.columnHeaderTitle?[""].concat(R):R;let B=[];if("tree"===this.rowHierarchyType&&(null==(A=this.extensionRows)?void 0:A.length)>=1){let t=[];t.push(this.rowDimensionKeys[0]),this._extensionRowDimensionKeys.forEach(e=>{t.push(e[0])}),B=this.extensionRows.reduce((t,e)=>t.concat(e.rows),[]),T=this.rowHeaderTitle?[""].concat(t):t}else T=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),!this.dataset||this._table.isPivotChart()||0!==(null!=(k=null==(M=this.dataset.records)?void 0:M.length)?k:0)||this.dataset.customRowTree||(T=this.rowsDefine.map(t=>"string"==typeof t?t:t.dimensionKey),this.indicatorsAsCol||T.push(this.indicatorDimensionKey)),T=this.rowHeaderTitle?[""].concat(T):T;this.cornerHeaderObjs=this._addCornerHeaders(R,T,this.columnsDefine.concat(...this.rowsDefine,...B)),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this.indicatorsAsCol&&!this.hideIndicatorName?this._indicatorShowType="column":this.indicatorsAsCol||this.hideIndicatorName?this._indicatorShowType="none":this._indicatorShowType="row",this.generateCellIdsConsiderHideHeader(),this.setPagination(t.options.pagination),this._table.isPivotChart()&&(this._chartItemSpanSize=0,this._chartItemBandSize=0,this._indicators.find(t=>{var e,i,r,n,s,l,a,h;(null==(e=null==t?void 0:t.style)?void 0:e.padding)&&(this._chartPadding=t.style.padding),(null==(i=t.chartSpec)?void 0:i.barWidth)&&"number"==typeof t.chartSpec.barWidth&&(this._chartItemSpanSize=null==(r=t.chartSpec)?void 0:r.barWidth);let u=null==(s=null==(n=t.chartSpec)?void 0:n.axes)?void 0:s.find(t=>"band"===t.type);return(null==u?void 0:u.bandSize)&&(this._chartItemBandSize=null==u?void 0:u.bandSize,this._chartPaddingInner=null!=(l=(0,o.Z)(u.paddingInner)?u.paddingInner[0]:u.paddingInner)?l:0,this._chartPaddingOuter=null!=(a=(0,o.Z)(u.paddingOuter)?u.paddingOuter[0]:u.paddingOuter)?a:0),this._chartItemSpanSize>0||(null==(h=t.chartSpec.series)||h.find(t=>(t.barWidth&&"number"==typeof t.barWidth&&(this._chartItemSpanSize=t.barWidth),this._chartItemSpanSize>0)),!1)})),this.handleRowSeriesNumber(t.internalProps.rowSeriesNumber),this.setColumnWidths()}handleRowSeriesNumber(t){var e;t&&(Array.isArray(t)?this.rowSeriesNumberColumn=t.map(t=>{var e;return{id:"",title:t.title,define:t,cellType:null!=(e=t.cellType)?e:"text",headerType:t.cellType&&"radio"!==t.cellType?t.cellType:"text",width:t.width,style:t.style,format:t.format,field:t.field,icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:"",title:t.title,define:t,cellType:null!=(e=t.cellType)?e:"text",headerType:t.cellType&&"radio"!==t.cellType?t.cellType:"text",style:t.style,width:t.width,format:t.format,field:"",icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(t=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(t=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}_generateColHeaderIds(){var t,e,i,r,n,s,l,a;if((null==(t=this.columnDimensionTree.tree.children)?void 0:t.length)>=1)if("grid-tree"===this.columnHierarchyType)this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1);else{let t=0;if(this.dataset&&!this._table.isPivotChart()&&0===(null!=(i=null==(e=this.dataset.records)?void 0:e.length)?i:0)&&!this.dataset.customColTree&&!this.dataset.customRowTree&&this.indicatorsAsCol&&this._getColumnHeaderTreeExpandedMaxLevelCount()<this.columnHeaderLevelCount){t=this.columnHeaderLevelCount-this._getColumnHeaderTreeExpandedMaxLevelCount();for(let e=0;e<t;e++)this._columnHeaderCellFullPathIds.unshift([])}this._addHeaders(this._columnHeaderCellFullPathIds,t,this.columnDimensionTree.tree.children,[],this.columnHeaderObjs)}if(this.columnHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let t=++this.sharedVar.seqId,e=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(t);this._columnHeaderCellFullPathIds.unshift(e);let i={id:t,title:"string"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(n=null==(r=this.columnHeaderTitle)?void 0:r.headerType)?n:"text",style:null==(s=this.columnHeaderTitle)?void 0:s.headerStyle,define:{id:t,disableHeaderHover:!!(null==(l=this.columnHeaderTitle)?void 0:l.disableHeaderHover),disableHeaderSelect:!!(null==(a=this.columnHeaderTitle)?void 0:a.disableHeaderSelect)}};this.columnHeaderObjs.push(i),this._headerObjects[t]=i}}_generateRowHeaderIds(){var t,e,i,r,n,s,l,a,o,h;if((null==(t=this.rowDimensionTree.tree.children)?void 0:t.length)>=1)if("tree"===this.rowHierarchyType)this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs);else if("grid-tree"===this.rowHierarchyType)this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0);else{let t=0;if(this.dataset&&!this._table.isPivotChart()&&0===(null!=(i=null==(e=this.dataset.records)?void 0:e.length)?i:0)&&!this.dataset.customColTree&&!this.dataset.customRowTree&&!this.indicatorsAsCol&&this._getRowHeaderTreeExpandedMaxLevelCount()<this.rowHeaderLevelCount){t=this.rowHeaderLevelCount-this._getRowHeaderTreeExpandedMaxLevelCount();for(let e=0;e<t;e++)this._rowHeaderCellFullPathIds_FULL.unshift([])}this._addHeaders(this._rowHeaderCellFullPathIds_FULL,t,this.rowDimensionTree.tree.children,[],this.rowHeaderObjs)}if(this.rowHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let t=++this.sharedVar.seqId,e=Array(null!=(n=null==(r=this._rowHeaderCellFullPathIds_FULL[0])?void 0:r.length)?n:this.rowDimensionTree.tree.size).fill(t);this._rowHeaderCellFullPathIds_FULL.unshift(e);let i={id:t,title:"string"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(l=null==(s=this.rowHeaderTitle)?void 0:s.headerType)?l:"text",style:null==(a=this.rowHeaderTitle)?void 0:a.headerStyle,define:{id:t,disableHeaderHover:!!(null==(o=this.rowHeaderTitle)?void 0:o.disableHeaderHover),disableHeaderSelect:!!(null==(h=this.rowHeaderTitle)?void 0:h.disableHeaderSelect)}};this.rowHeaderObjs.push(i),this._headerObjects[t]=i}}_getRowHeaderTreeExpandedMaxLevelCount(){return"tree"===this.rowHierarchyType?1:"grid-tree"===this.rowHierarchyType?"row"===this.cornerSetting.titleOnDimension?this.rowDimensionTree.totalLevel:this.indicatorsAsCol?this.rowDimensionTree.expandedMaxLevel:this.rowDimensionTree.expandedMaxLevel+1:this.rowDimensionTree.totalLevel}_getColumnHeaderTreeExpandedMaxLevelCount(){return"grid-tree"===this.columnHierarchyType?"column"===this.cornerSetting.titleOnDimension?this.columnDimensionTree.totalLevel:!1===this.indicatorsAsCol?this.columnDimensionTree.expandedMaxLevel:this.columnDimensionTree.expandedMaxLevel+1:this.columnDimensionTree.totalLevel}_addHeaders(t,e,i,r,n){let s=this;t[e]||function(e){let i=t[e]=[];if(0===s.colIndex)return;let r=t[e-1];for(let t=0;t<(null==r?void 0:r.length);t++)i[t]=r[t]}(e);for(let s=0;s<i.length;s++){let l=i[s];(0,a.g3)(l,t,n,r,e,this)}}_addHeadersForTreeMode(t,e,i,r,n,s,l,o){let h=this;t[e]||function(e){let i=t[e]=[];if(0===h.colIndex)return;let r=t[e-1];for(let t=0;t<(null==r?void 0:r.length);t++)i[t]=r[t]}(e);for(let h=0;h<i.length;h++){let u=i[h];(0,a.py)(u,t,o,r,e,n,s,l,this)}}_addHeadersForGridTreeMode(t,e,i,r,n,s,l,o,h,u){let d=this;t[e]||function(e){let i=t[e]=[];if(0===d.colIndex)return;let r=t[e-1];for(let t=0;t<(null==r?void 0:r.length);t++)i[t]=r[t]}(e);for(let d=0;d<i.length;d++){let c=i[d];(0,a.jS)(c,t,h,r,e,n,s,l,o,u,this.indicatorsAsCol,this)}}_addCornerHeaders(t,e,i){var r,n,s,l,a,o,h,u,d,c;this._cornerHeaderCellFullPathIds=[];let p=[],g="grid-tree"===this.columnHierarchyType&&this._getColumnHeaderTreeExpandedMaxLevelCount()||this.columnHeaderLevelCount,f="grid-tree"===this.rowHierarchyType&&this._getRowHeaderTreeExpandedMaxLevelCount()||this.rowHeaderLevelCount;if(0===g||0===f)return p;if("all"===this.cornerSetting.titleOnDimension)if(this.indicatorsAsCol){if(t)for(let e=0;e<g;e++){let s=t[e],l=++this.sharedVar.seqId,a=i.find(t=>"string"!=typeof t&&t.dimensionKey===s),o={id:l,title:s===this.indicatorDimensionKey?this.indicatorTitle:a?a.title:"axis"===s?"":s,field:s,style:this.cornerSetting.headerStyle,headerType:null!=(r=this.cornerSetting.headerType)?r:"text",showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,define:{showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,dimensionKey:s,id:l,value:s,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==a?void 0:a.cornerDropDownMenu,headerIcon:null==a?void 0:a.cornerHeaderIcon,pivotInfo:{value:null!=(n=null==a?void 0:a.title)?n:"",dimensionKey:s,isPivotCorner:!0},description:null==a?void 0:a.cornerDescription};p[l]=o,this._headerObjects[l]=o,this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]);for(let t=0;t<f;t++)this._cornerHeaderCellFullPathIds[e][t]=l}if(e)for(let t=0;t<f;t++){let r=e[t],n=++this.sharedVar.seqId,a=i.find(t=>"string"!=typeof t&&t.dimensionKey===r),o={id:n,title:r===this.indicatorDimensionKey?this.indicatorTitle:a?a.title:"axis"===r?"":r,field:r,style:this.cornerSetting.headerStyle,headerType:null!=(s=this.cornerSetting.headerType)?s:"text",showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,define:{showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,dimensionKey:r,id:n,value:r,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==a?void 0:a.cornerDropDownMenu,headerIcon:null==a?void 0:a.cornerHeaderIcon,pivotInfo:{value:null!=(l=null==a?void 0:a.title)?l:"",dimensionKey:r,isPivotCorner:!0},description:null==a?void 0:a.cornerDescription};p[n]=o,this._headerObjects[n]=o,this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]||(this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]=[]),this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1][t]=n}}else{if(e)for(let t=0;t<f;t++){let r=e[t],n=++this.sharedVar.seqId,s=i.find(t=>"string"!=typeof t&&t.dimensionKey===r),l={id:n,title:r===this.indicatorDimensionKey?this.indicatorTitle:s?s.title:"axis"===r?"":r,field:r,style:this.cornerSetting.headerStyle,headerType:null!=(a=this.cornerSetting.headerType)?a:"text",showSort:null==s?void 0:s.showSortInCorner,sort:null==s?void 0:s.sort,define:{showSort:null==s?void 0:s.showSortInCorner,sort:null==s?void 0:s.sort,dimensionKey:r,id:n,value:r,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==s?void 0:s.cornerDropDownMenu,headerIcon:null==s?void 0:s.cornerHeaderIcon,pivotInfo:{value:null!=(o=null==s?void 0:s.title)?o:"",dimensionKey:r,isPivotCorner:!0},description:null==s?void 0:s.cornerDescription};p[n]=l,this._headerObjects[n]=l;for(let e=0;e<g;e++)this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]),this._cornerHeaderCellFullPathIds[e][t]=n}if(t)for(let e=0;e<g;e++){let r=t[e],n=++this.sharedVar.seqId,s=i.find(t=>"string"!=typeof t&&t.dimensionKey===r),l={id:n,title:r===this.indicatorDimensionKey?this.indicatorTitle:s?s.title:"axis"===r?"":r,field:r,style:this.cornerSetting.headerStyle,headerType:null!=(h=this.cornerSetting.headerType)?h:"text",showSort:null==s?void 0:s.showSortInCorner,sort:null==s?void 0:s.sort,define:{showSort:null==s?void 0:s.showSortInCorner,sort:null==s?void 0:s.sort,dimensionKey:r,id:n,value:r,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==s?void 0:s.cornerDropDownMenu,headerIcon:null==s?void 0:s.cornerHeaderIcon,pivotInfo:{value:null!=(u=null==s?void 0:s.title)?u:"",dimensionKey:r,isPivotCorner:!0},description:null==s?void 0:s.cornerDescription};p[n]=l,this._headerObjects[n]=l,this._cornerHeaderCellFullPathIds[e][this._cornerHeaderCellFullPathIds[e].length-1]=n}}else if("row"===this.cornerSetting.titleOnDimension||"column"===this.cornerSetting.titleOnDimension){let r="row"===(null==(d=this.cornerSetting)?void 0:d.titleOnDimension)?e:t;r&&r.forEach((t,e)=>{var r,n;let s=++this.sharedVar.seqId,l=i.find(e=>"string"!=typeof e&&e.dimensionKey===t),a={id:s,title:t===this.indicatorDimensionKey?this.indicatorTitle:l?l.title:"axis"===t?"":t,field:t,style:this.cornerSetting.headerStyle,headerType:null!=(r=this.cornerSetting.headerType)?r:"text",showSort:null==l?void 0:l.showSortInCorner,sort:null==l?void 0:l.sort,define:{showSort:null==l?void 0:l.showSortInCorner,sort:null==l?void 0:l.sort,dimensionKey:t,id:s,value:t,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==l?void 0:l.cornerDropDownMenu,headerIcon:null==l?void 0:l.cornerHeaderIcon,pivotInfo:{value:null!=(n=null==l?void 0:l.title)?n:"",dimensionKey:t,isPivotCorner:!0},description:null==l?void 0:l.cornerDescription};if(p[s]=a,this._headerObjects[s]=a,"column"===this.cornerSetting.titleOnDimension){this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]);for(let t=0;t<this.rowHeaderLevelCount;t++)this._cornerHeaderCellFullPathIds[e][t]=s}else if("row"===this.cornerSetting.titleOnDimension)for(let t=0;t<this.columnHeaderLevelCount;t++)this._cornerHeaderCellFullPathIds[t]||(this._cornerHeaderCellFullPathIds[t]=[]),this._cornerHeaderCellFullPathIds[t][e]=s})}else{let t=++this.sharedVar.seqId,e={id:t,title:"",field:"维度名称",style:this.cornerSetting.headerStyle,headerType:null!=(c=this.cornerSetting.headerType)?c:"text",define:{dimensionKey:"维度名称",id:t,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect}};p[t]=e,this._headerObjects[t]=e;for(let e=0;e<this.columnHeaderLevelCount;e++)for(let i=0;i<this.rowHeaderLevelCount;i++)this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]),this._cornerHeaderCellFullPathIds[e][i]=t}return p}generateExtensionRowTree(){this.extensionRows.forEach((t,e)=>{let i=this._rowHeaderCellFullPathIds_FULL;this._rowHeaderCellFullPathIds_FULL=[],i.forEach((e,i)=>{let r,n,s=e[e.length-1];if(this.colIndex=0,"function"==typeof t.rowTree){let i=this.findFullCellIds(e);r=t.rowTree(i.map(t=>({dimensionKey:this._headerObjects[t].field,value:this._headerObjects[t].title})))}else r=(0,h.Z)(t.rowTree);this._rowHeaderExtensionTree[s]?(this._rowHeaderExtensionTree[s].reset(this._rowHeaderExtensionTree[s].tree.children),n=this._rowHeaderExtensionTree[s]):(n=new a.KO(null!=r?r:[],this.sharedVar,this.rowHierarchyType,void 0),this._rowHeaderExtensionTree[s]=n);let l=[];this._addHeadersForTreeMode(l,0,n.tree.children,[],n.totalLevel,!0,t.rows,this.rowHeaderObjs);for(let t=0;t<l[0].length;t++)this._rowHeaderCellFullPathIds_FULL.push(e.concat(l[0][t]))})})}setColumnWidths(){var t,e,i;let r=Array(this.colCount).fill(void 0);if(this.leftRowSeriesNumberColumnCount&&(r[0]=this.leftRowSeriesNumberColumn[0]),this.showHeader&&this.showRowHeader)if(this.rowHeaderTitle&&(r[0+this.leftRowSeriesNumberColumnCount]={}),"tree"===this.rowHierarchyType){let i=this.rowDimensionKeys[0];if(i){let e=null==(t=this.rowsDefine)?void 0:t.find(t=>"string"!=typeof t&&t.dimensionKey===i);e&&(r[0+ +!!this.rowHeaderTitle+this.leftRowSeriesNumberColumnCount]={width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth})}null==(e=this._extensionRowDimensionKeys)||e.forEach((t,e)=>{var i;let n=t[0];if(n){let t=null==(i=this.extensionRows[e].rows)?void 0:i.find(t=>"string"!=typeof t&&t.dimensionKey===n);t&&(r[e+1+ +!!this.rowHeaderTitle+this.leftRowSeriesNumberColumnCount]={width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth})}})}else(this.rowDimensionTree.totalLevel>0?this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr():this.rowsDefine.map(t=>"string"==typeof t?t:t.dimensionKey)).forEach((t,e)=>{var i;let n=null==(i=this.rowsDefine)?void 0:i.find(e=>"string"!=typeof e&&e.dimensionKey===t);n&&(r[e+ +!!this.rowHeaderTitle+this.leftRowSeriesNumberColumnCount]={width:n.width,minWidth:n.minWidth,maxWidth:n.maxWidth})});if(this.indicatorsAsCol)for(let t=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;t<this.colCount;t++){let e=this.getBody(t,this.columnHeaderLevelCount);r[t]={width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,maxWidth:null==e?void 0:e.maxWidth}}else{let t,e,n,s=0;null==(i=this._indicators)||i.forEach((i,r)=>{var l,a;"number"==typeof i.width?s=Math.max(i.width,s):"auto"===i.width&&(n=!0),"number"==typeof i.minWidth&&(e=Math.max(i.minWidth,null!=(l=e)?l:0)),"number"==typeof i.maxWidth&&(t=Math.min(i.maxWidth,null!=(a=t)?a:Number.MAX_VALUE))}),s=s>0?s:n?"auto":void 0,r.fill({width:s,minWidth:e,maxWidth:t},this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,this.colCount-this.rightFrozenColCount)}this._columnWidths=r}get columnWidths(){return this._columnWidths}getColumnWidthDefined(t){return this._columnWidths[t]}get showHeader(){return this._showHeader}set showHeader(t){this._showHeader=t}get showColumnHeader(){return this._showColumnHeader}set showColumnHeader(t){this._showColumnHeader=t}get showRowHeader(){return this._showRowHeader}set showRowHeader(t){this._showRowHeader=t}get columnHeaderTitle(){return this._columnHeaderTitle}set columnHeaderTitle(t){this._columnHeaderTitle=t}get rowHeaderTitle(){return this._rowHeaderTitle}set rowHeaderTitle(t){this._rowHeaderTitle=t}getHeaderFieldKey(t,e){}getCellLocation(t,e){return this.isCornerHeader(t,e)?"cornerHeader":this.isColumnHeader(t,e)?"columnHeader":this.isRowHeader(t,e)?"rowHeader":"body"}isHeader(t,e){return t>=this.leftRowSeriesNumberColumnCount&&t<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||e>=0&&e<this.columnHeaderLevelCount||t>=this.colCount-this.rightHeaderColCount||e>=this.rowCount-this.bottomHeaderRowCount}isCornerHeader(t,e){return t>=0&&t<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&e>=0&&e<this.columnHeaderLevelCount}isColumnHeader(t,e){return t>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&e>=0&&e<this.columnHeaderLevelCount}isRowHeader(t,e){return t>=this.leftRowSeriesNumberColumnCount&&t<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&e>=this.columnHeaderLevelCount}isFrozen(t,e){return this.isFrozenColumn(t)||this.isRightFrozenColumn(t)||this.isBottomFrozenRow(e)||this.isFrozenRow(e)||this.isSeriesNumberInBody(t,e)||this.isSeriesNumberInHeader(t,e)}isFrozenColumn(t,e){if((0,u.Z)(e)){if(t>=0&&t<this.frozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&t>=0&&t<this.frozenColCount)return!0;return!1}isRightFrozenColumn(t,e){if((0,u.Z)(e)){if(t>=this.colCount-this.rightFrozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&t>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(t,e){if((0,u.Z)(e)){if(e>=0&&e<this.frozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.frozenRowCount>0&&e>=0&&e<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(t,e){if((0,u.Z)(e)){if(e>=this.rowCount-this.bottomFrozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.bottomFrozenRowCount>0&&e>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=0&&e<this.frozenRowCount}isLeftBottomCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=0&&e<this.frozenRowCount}isRightBottomCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}getColumnHeaderRange(){return{start:{col:this.rowHeaderLevelCount,row:0},end:{col:this.colCount-1,row:this.columnHeaderLevelCount-1}}}getRowHeaderRange(){return{start:{col:0,row:this.columnHeaderLevelCount},end:{col:this.rowHeaderLevelCount-1,row:this.rowCount-1}}}getCornerHeaderRange(){return{start:{col:0,row:0},end:{col:this.rowHeaderLevelCount-1,row:this.columnHeaderLevelCount-1}}}getBodyRange(){return{start:{col:this.rowHeaderLevelCount,row:this.columnHeaderLevelCount},end:{col:this.colCount-1,row:this.rowCount-1}}}resetCellIds(){}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get headerLevelCount(){return this.columnHeaderLevelCount}resetColumnHeaderLevelCount(){var t,e,i,r,n,s,a,o,h,u,d;if(this.showHeader&&this.showColumnHeader){if(this._table.isPivotChart()&&this.indicatorsAsCol&&!(null==(e=null==(t=this.dataset)?void 0:t.colKeys)?void 0:e.length)&&0===(null==(r=null==(i=this.columnDimensionTree)?void 0:i.tree)?void 0:r.level)&&!this.hasTwoIndicatorAxes)return void(this.columnHeaderLevelCount=0);let c=this._getColumnHeaderTreeExpandedMaxLevelCount();return this.indicatorsAsCol&&this.hideIndicatorName&&this.colDimensionKeys[this.colDimensionKeys.length-1]===this.indicatorDimensionKey&&c--,0!==c||!this.dataset||(null==(n=this.dataset.customColTree)?void 0:n.length)?!this.dataset||this._table.isPivotChart()||0!==(null!=(u=null==(h=this.dataset.records)?void 0:h.length)?u:0)||this.dataset.customColTree||"column"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(c=null!=(d=this.columnsDefine.length)?d:0,!this.hideIndicatorName&&this.indicatorsAsCol&&c++):("row"===this.cornerSetting.titleOnDimension||"all"===this.cornerSetting.titleOnDimension)&&this.cornerSetting.forceShowHeader?c=1:this._table.isPivotChart()||0!==(null!=(a=null==(s=this.dataset.records)?void 0:s.length)?a:0)||"column"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(c=null!=(o=this.columnsDefine.length)?o:0),this.columnHeaderTitle&&(c+=1),this._table.isPivotChart()&&this.indicatorsAsCol&&!this.hasTwoIndicatorAxes&&(0,l.eW)(this.indicatorsDefine)&&(c-=1),void(this.columnHeaderLevelCount=c)}this.columnHeaderLevelCount=this.indicatorsAsCol?+!this.hideIndicatorName:0}resetRowHeaderLevelCount(){var t,e,i,r,n,s,l,a;if(this.showHeader&&this.showRowHeader){if("tree"===this.rowHierarchyType){let i=null!=(e=null==(t=this.extensionRows)?void 0:t.length)?e:0;return this.rowHeaderTitle?void(this.rowHeaderLevelCount=1+ +!!this.rowDimensionTree.totalLevel+i):void(this.rowHeaderLevelCount=+!!this.rowDimensionTree.totalLevel+i)}let o=this._getRowHeaderTreeExpandedMaxLevelCount(),h=o;return 0!==h||!this.dataset||(null==(i=this.dataset.customRowTree)?void 0:i.length)?!this.dataset||this._table.isPivotChart()||0!==(null!=(a=null==(l=this.dataset.records)?void 0:l.length)?a:0)||this.dataset.customRowTree||"row"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(h=this.rowsDefine.length,this.hideIndicatorName||this.indicatorsAsCol||h++):("column"===this.cornerSetting.titleOnDimension||"all"===this.cornerSetting.titleOnDimension)&&this.cornerSetting.forceShowHeader?h=1:this._table.isPivotChart()||0!==(null!=(n=null==(r=this.dataset.records)?void 0:r.length)?n:0)||"row"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(h=null!=(s=this.rowsDefine.length)?s:0),!this.indicatorsAsCol&&this.hideIndicatorName&&this.rowDimensionKeys[this.rowDimensionKeys.length-1]===this.indicatorDimensionKey&&(h=o-1),this.rowHeaderTitle&&(h+=1),void(this.rowHeaderLevelCount=h)}this.rowHeaderLevelCount=this.indicatorsAsCol||this.hideIndicatorName?0:1}get columnHeaderLevelCount(){return this._columnHeaderLevelCount}set columnHeaderLevelCount(t){this._columnHeaderLevelCount=t}get rowHeaderLevelCount(){return this._rowHeaderLevelCount}set rowHeaderLevelCount(t){this._rowHeaderLevelCount=t}get colCount(){var t,e,i,r;return(this._getColumnHeaderTreeExpandedMaxLevelCount()>0||this._table.isPivotChart()||(null==(t=this.dataset.records)?void 0:t.length)>0||this.dataset.records&&!Array.isArray(this.dataset.records)?(null!=(i=null==(e=this._columnHeaderCellIds[0])?void 0:e.length)?i:this.columnDimensionTree.tree.size)||+((null==(r=this._indicators)?void 0:r.length)>0):0)+this.rowHeaderLevelCount+this.rightHeaderColCount+this.leftRowSeriesNumberColumnCount}get rowCount(){var t,e,i,r;return((this._table.records||this.dataset.records)&&(!Array.isArray(this._table.records)||this._table.records.length>0)&&(null==(t=this._indicators)?void 0:t.length)>0&&!(null==(e=this._rowHeaderCellIds)?void 0:e.length)?1:null!=(r=null==(i=this._rowHeaderCellIds)?void 0:i.length)?r:0)+this.columnHeaderLevelCount+this.bottomHeaderRowCount}get bodyRowSpanCount(){return this.rowDimensionTree.tree.size}get bottomFrozenRowCount(){if(!this._table.isPivotChart())return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0;if(this.indicatorKeys.length>=1&&(0,l.eW)(this.indicatorsDefine)){let t=this._table.pivotChartAxes.find(t=>"bottom"===t.orient);return!1===(null==t?void 0:t.visible)?0:(this.indicatorsAsCol,1)}return 0}get rightFrozenColCount(){if(!this._table.isPivotChart())return this._table.internalProps.rightFrozenColCount?this.colCount-this.rowHeaderLevelCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:this.colCount-this.rowHeaderLevelCount:0;let t=this._table.pivotChartAxes.find(t=>"right"===t.orient);return!1===(null==t?void 0:t.visible)||this.indicatorsAsCol?0:+!!this.hasTwoIndicatorAxes}get bodyRowCount(){return this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount}get headerObjects(){return this._headerObjects}get columnObjects(){return this._indicators}getCellId(t,e){var i,r,n,s,l;if(e>=0&&t>=0){if(this.isSeriesNumber(t,e))return"";if(this.isCornerHeader(t,e))return null==(i=this._cornerHeaderCellIds[e])?void 0:i[t-this.leftRowSeriesNumberColumnCount];if(this.isColumnHeader(t,e))return null==(r=this._columnHeaderCellIds[e])?void 0:r[t-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount];if(this.isRowHeader(t,e))return null==(n=this._rowHeaderCellIds[e-this.columnHeaderLevelCount])?void 0:n[t-this.leftRowSeriesNumberColumnCount];if(this.isRightFrozenColumn(t,e))return null==(s=this._rowHeaderCellIds[e-this.columnHeaderLevelCount])?void 0:s[this.rowHeaderLevelCount-1];if(this.isBottomFrozenRow(t,e))return null==(l=this._columnHeaderCellIds[this.columnHeaderLevelCount-1])?void 0:l[t-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount]}}getHeader(t,e){var i;if(this.isSeriesNumberInHeader(t,e))return this.getSeriesNumberHeader(t,e);let r=this.getCellId(t,e);return null!=(i=this._headerObjectMap[r])?i:{id:void 0,field:"",headerType:"text",define:void 0}}getHeaderField(t,e){var i,r;let n=this.getCellId(t,e);return(null==(i=this._headerObjectMap[n])?void 0:i.field)||(null==(r=this.getBody(t,e))?void 0:r.field)}getHeaderCellAdressById(t){for(let e=0;e<this._columnHeaderCellIds.length;e++){let i=this._columnHeaderCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return{col:r+this._table.frozenColCount,row:e}}for(let e=0;e<this._rowHeaderCellIds.length;e++){let i=this._rowHeaderCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return{col:r,row:e+this._table.frozenRowCount}}for(let e=0;e<this._cornerHeaderCellIds.length;e++){let i=this._cornerHeaderCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return{col:r,row:e}}}getHeaderCellAddressByField(t){let e=this.headerObjects.find(e=>e&&e.field===t);return e&&this.getHeaderCellAdressById(e.id)}getBody(t,e){var i,r,n,s,l,a,o,h,d,c;let p=this.getBodyWidthCache(t,e);if(p)return p;if(this.isSeriesNumber(t,e)){let i=this.getSeriesNumberBody(t,e);return this.setBodyWidthCache(t,e,i),i}let g=this.getCellHeaderPaths(t,e);if(this.indicatorsAsCol){let a=null==(r=null==(i=g.colHeaderPaths)?void 0:i.find(t=>t.indicatorKey))?void 0:r.indicatorKey,o=(0,u.Z)(a)&&null!=(l=null!=(s=null==(n=this._indicators)?void 0:n.find(t=>t.indicatorKey===a))?s:this._indicators[0])?l:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(t,e,o),o}let f=null==(o=null==(a=g.rowHeaderPaths)?void 0:a.find(t=>t.indicatorKey))?void 0:o.indicatorKey,m=(0,u.Z)(f)&&null!=(c=null!=(d=null==(h=this._indicators)?void 0:h.find(t=>t.indicatorKey===f))?d:this._indicators[0])?c:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(t,e,m),m}getCellRange(t,e){var i,r;let n={start:{col:t,row:e},end:{col:t,row:e}};if(!this.isHeader(t,e)||-1===t||-1===e||this.isRightFrozenColumn(t,e)||this.isBottomFrozenRow(t,e))return n;if(this._table.isPivotChart()){if(this.isLeftBottomCorner(t,e))return{start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.frozenColCount-1,row:this.rowCount-1}};if(this.isRightTopCorner(t,e))return{start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}};if(this.isRightBottomCorner(t,e))return{start:{col:this.colCount-this.rightFrozenColCount,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}}}for(let i=0;i<this._largeCellRangeCache.length;i++){let r=this._largeCellRangeCache[i];if(t>=r.start.col&&t<=r.end.col&&e>=r.start.row&&e<=r.end.row)return r}if(this.isHeader(t,e)&&-1!==t&&-1!==e){let s=this.getCellId(t,e);for(let i=t-1;i>=0&&s===this.getCellId(i,e);i--)n.start.col=i;for(let r=t+1;r<(null!=(i=this.colCount)?i:0)&&s===this.getCellId(r,e);r++)n.end.col=r;for(let i=e-1;i>=0&&s===this.getCellId(t,i);i--)n.start.row=i;for(let i=e+1;i<(null!=(r=this.rowCount)?r:0)&&!(s!==this.getCellId(t,i)||this.isSeriesNumberInHeader(t,e)&&i>=this.columnHeaderLevelCount);i++)n.end.row=i}return(n.end.col-n.start.col>100||n.end.row-n.start.row>100)&&this._largeCellRangeCache.push(n),n}isCellRangeEqual(t,e,i,r){let n=this.getCellRange(t,e),s=this.getCellRange(i,r);return n.start.col===s.start.col&&n.end.col===s.end.col&&n.start.row===s.start.row&&n.end.row===s.end.row}getBodyIndexByRow(t){return t<this.columnHeaderLevelCount||t>=this.rowCount-this.bottomHeaderRowCount?-1:t-this.columnHeaderLevelCount}get bottomHeaderRowCount(){return this._table.isPivotChart()?this.bottomFrozenRowCount:0}get rightHeaderColCount(){return this._table.isPivotChart()?this.rightFrozenColCount:0}getBodyIndexByCol(t){return t<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||t>=this.colCount-this.rightHeaderColCount?-1:t-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount}getRecordStartRowByRecordIndex(t){return this.columnHeaderLevelCount+t}getRecordShowIndexByCell(t,e){}getCellHeaderPathsWithTreeNode(t,e){for(let i=0;i<this._largeCellRangeCache.length;i++){let r=this._largeCellRangeCache[i];if(t>=r.start.col&&t<=r.end.col&&e>=r.start.row&&e<=r.end.row)break}let i=this.getColHeaderPathCache(t,e),r=this.getRowHeaderPathCache(t,e),n=this.getBodyIndexByCol(t),s=this.getBodyIndexByRow(e)+this.currentPageStartIndex;if(!i&&e>=0&&n>=0){if(i=[],"grid-tree"===this.columnHierarchyType){let t=[];this._columnHeaderCellFullPathIds.map(e=>{t.push(e[n])});let e=this.getTreePathByCellIds(t);i.push(...e)}else i=this.columnDimensionTree.getTreePath(n,this.showHeader&&this.showColumnHeader?e-!!this.columnHeaderTitle:this.columnDimensionTree.totalLevel);this.setColHeaderPathCache(t,e,i)}if(!r&&t>=0&&s>=0){if(r=[],"tree"===this.rowHierarchyType){let t=this._rowHeaderCellFullPathIds[s],e=this.rowDimensionTree,i=0;for(;e&&t;){let n=[],s=t[i];for(n.push(s);;){let t=this._headerObjectMap[s];if(!(null==t?void 0:t.parentCellId))break;n.unshift(t.parentCellId),s=t.parentCellId}let l=this.getTreePathByCellIds(n);r.push(...l),e=this._rowHeaderExtensionTree[t[i]],i++}}else if("grid-tree"===this.rowHierarchyType){let t=this._rowHeaderCellFullPathIds[s],e=this.getTreePathByCellIds(t);r.push(...e)}else r=this.rowDimensionTree.getTreePath(s,this.showHeader&&this.showRowHeader?t-!!this.rowHeaderTitle-this.leftRowSeriesNumberColumnCount:this.rowDimensionTree.totalLevel);this.setRowHeaderPathCache(t,e,r)}return{colHeaderPaths:i,rowHeaderPaths:r,cellLocation:this.getCellLocation(t,e)}}getTreePathByCellIds(t){let e=[];for(let i=0;i<t.length;i++){let r=t[i];if(i>0&&r===t[i-1])continue;let n=this._headerObjects[r];(null==n?void 0:n.define)&&e.push(n.define)}return e}getCellHeaderPaths(t,e){var i,r;let n=this.getCellHeaderPathsWithTreeNode(t,e),s={colHeaderPaths:[],rowHeaderPaths:[],cellLocation:n.cellLocation};return null==(i=n.colHeaderPaths)||i.forEach(t=>{var e,i,r;let n={};n.dimensionKey=t.dimensionKey,n.indicatorKey=t.indicatorKey,n.value=null!=(r=null!=(e=t.value)?e:null==(i=this.getIndicatorInfoByIndicatorKey(t.indicatorKey))?void 0:i.title)?r:"",n.virtual=t.virtual,n.role=t.role,s.colHeaderPaths.push(n)}),null==(r=n.rowHeaderPaths)||r.forEach(t=>{var e,i,r;if("axis"!==t.dimensionKey){let n={};n.dimensionKey=t.dimensionKey,n.indicatorKey=t.indicatorKey,n.value=null!=(r=null!=(e=t.value)?e:null==(i=this.getIndicatorInfoByIndicatorKey(t.indicatorKey))?void 0:i.title)?r:"",n.virtual=t.virtual,n.role=t.role,s.rowHeaderPaths.push(n)}}),s}getIndicatorInfoByIndicatorKey(t){var e;return null==(e=this.indicatorsDefine)?void 0:e.find(e=>"string"!=typeof e&&!!t&&e.indicatorKey===t)}findFullCellIds(t){let e=[];for(let i=0;i<t.length;i++){let r=t[i];for(e.push(r);;){let t=this._headerObjectMap[r];if(!(null==t?void 0:t.parentCellId))break;e.unshift(t.parentCellId),r=t.parentCellId}}return e}getHeaderDimension(t,e){var i,r,n;if(this.isHeader(t,e)){let s=this.getHeader(t,e);return null!=(r=null==(i=this.rowsDefine)?void 0:i.find(t=>"string"!=typeof t&&t.dimensionKey===s.field))?r:null==(n=this.columnsDefine)?void 0:n.find(t=>"string"!=typeof t&&t.dimensionKey===s.field)}}isColumnIndicatorHeader(t,e){return"column"===this._indicatorShowType&&e===this.columnHeaderLevelCount-1&&t>=this.rowHeaderLevelCount}isRowIndicatorHeader(t,e){return"row"===this._indicatorShowType&&t===this.rowHeaderLevelCount-1&&e>=this.columnHeaderLevelCount}isIndicatorHeader(t,e){return this.isColumnIndicatorHeader(t,e)||this.isRowIndicatorHeader(t,e)}_rebuildRowLayout(){var t,e,i,n,s,l;if(this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this.resetRowHeaderLevelCount(),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[...this.rowDimensionKeys],"tree"===this.rowHierarchyType?this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs):"grid-tree"===this.rowHierarchyType&&(this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.rowHeaderTitle){let r=++this.sharedVar.seqId,l=Array(this.rowCount-this.columnHeaderLevelCount).fill(r);this._rowHeaderCellFullPathIds_FULL.unshift(l);let a={id:r,title:"string"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(e=null==(t=this.rowHeaderTitle)?void 0:t.headerType)?e:"text",style:null==(i=this.rowHeaderTitle)?void 0:i.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(null==(n=this.rowHeaderTitle)?void 0:n.disableHeaderHover),disableHeaderSelect:!!(null==(s=this.rowHeaderTitle)?void 0:s.disableHeaderSelect)}};this.rowHeaderObjs.push(a),this._headerObjects[r]=a}this._rowHeaderCellFullPathIds_FULL=(0,r.p4)(this._rowHeaderCellFullPathIds_FULL),"tree"===this.rowHierarchyType&&(null==(l=this.extensionRows)?void 0:l.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),"grid-tree"===this.rowHierarchyType&&this.setColumnWidths()}_rebuildColumnLayout(){var t,e,i,r,n;if(this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this.resetColumnHeaderLevelCount(),this._columnHeaderCellFullPathIds=[],this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),"grid-tree"===this.columnHierarchyType&&(this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.columnHeaderTitle){let s=++this.sharedVar.seqId,l=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(s);this._columnHeaderCellFullPathIds.unshift(l);let a={id:s,title:"string"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(e=null==(t=this.columnHeaderTitle)?void 0:t.headerType)?e:"text",style:null==(i=this.columnHeaderTitle)?void 0:i.headerStyle,define:{id:s,disableHeaderHover:!!(null==(r=this.columnHeaderTitle)?void 0:r.disableHeaderHover),disableHeaderSelect:!!(null==(n=this.columnHeaderTitle)?void 0:n.disableHeaderSelect)}};this.columnHeaderObjs.push(a),this._headerObjects[s]=a}this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),"grid-tree"===this.columnHierarchyType&&this.setColumnWidths()}toggleHierarchyState(t,e){var i,s,l,a,o,h,u;let d;this.colIndex=0;let c=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount,p=this._rowHeaderCellFullPathIds_FULL.slice(0),g=p.map((e,i)=>({col:t,row:i+this.columnHeaderLevelCount})),f=this.getHeader(t,e);if((f.define.hierarchyState=f.define.hierarchyState===n.g.collapse?n.g.expand:n.g.collapse,this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this.resetRowHeaderLevelCount(),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[],this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),"tree"===this.rowHierarchyType)?((null==(i=this.extensionRows)?void 0:i.length)>0&&this.extensionRows.forEach(t=>{var e;let i=(null==(e=t.rows)?void 0:e.map(t=>"string"==typeof t?t:t.dimensionKey))||[];this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(i)}),this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs)):"grid-tree"===this.rowHierarchyType&&(this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.rowHeaderTitle){let t=++this.sharedVar.seqId,e=Array(this.rowCount-this.columnHeaderLevelCount).fill(t);this._rowHeaderCellFullPathIds_FULL.unshift(e);let i={id:t,title:"string"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(l=null==(s=this.rowHeaderTitle)?void 0:s.headerType)?l:"text",style:null==(a=this.rowHeaderTitle)?void 0:a.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(null==(o=this.rowHeaderTitle)?void 0:o.disableHeaderHover),disableHeaderSelect:!!(null==(h=this.rowHeaderTitle)?void 0:h.disableHeaderSelect)}};this.rowHeaderObjs.push(i),this._headerObjects[t]=i}if(this._rowHeaderCellFullPathIds_FULL=(0,r.p4)(this._rowHeaderCellFullPathIds_FULL),"tree"===this.rowHierarchyType&&(null==(u=this.extensionRows)?void 0:u.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,"tree"===this.rowHierarchyType)d=function(t,e,i,r,n,s){let l=s.columnHeaderLevelCount,a=[],o=[];for(let t=0;t<i.length;t++)r.includes(i[t])||o.push(n[t]);for(let e=0;e<r.length;e++)if(!i.includes(r[e])){let i={col:t,row:l+e};a.push(i)}let h=s.getParentCellId(t,e),u=s.getRowHeaderCellAddressByCellId(h),d=[];for(u&&d.push(u);h;)(h=s.getParentCellId(u.col,u.row))&&d.push(u=s.getRowHeaderCellAddressByCellId(h));return d.some(i=>i.col===t&&i.row===e)||d.push({col:t,row:e}),{addCellPositionsRowDirection:a,removeCellPositionsRowDirection:o,updateCellPositionsRowDirection:d}}(t,e,p.map(e=>e[t-this.leftRowSeriesNumberColumnCount]),this._rowHeaderCellFullPathIds_FULL.map(e=>e[t-this.leftRowSeriesNumberColumnCount]),g,this);else{let i=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount;d=function(t,e,i,r,n,s){let l=s.columnHeaderLevelCount,a=[],o=[];for(let t=0;t<i.length;t++)r.includes(i[t])||o.push(n[t]);for(let e=0;e<r.length;e++)if(!i.includes(r[e])){let i={col:t,row:l+e};a.push(i)}let h=s.getParentCellId(t,e),u=s.getRowHeaderCellAddressByCellId(h),d=[];for(u&&d.push(u);h;)(h=s.getParentCellId(u.col,u.row))&&d.push(u=s.getRowHeaderCellAddressByCellId(h));let c=[],p=[];if("grid-tree"===s.rowHierarchyType&&"column"===s.cornerSetting.titleOnDimension&&s.rowHeaderLevelCount!==s._cornerHeaderCellIds[0].length)if(s.rowHeaderLevelCount>s._cornerHeaderCellIds[0].length)for(let t=s._cornerHeaderCellIds[0].length;t<s.rowHeaderLevelCount;t++)c.push({col:t,row:e});else for(let t=s.rowHeaderLevelCount;t<s._cornerHeaderCellIds[0].length;t++)p.push({col:t,row:e});return{addCellPositionsRowDirection:a,removeCellPositionsRowDirection:o,updateCellPositionsRowDirection:d,addCellPositionsColumnDirection:c,removeCellPositionsColumnDirection:p}}(t,e,p.map(t=>t[c]),this._rowHeaderCellFullPathIds_FULL.map(t=>t[i]),g,this)}return this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),"grid-tree"===this.rowHierarchyType&&this.setColumnWidths(),d}toggleHierarchyStateForColumnTree(t,e){var i,r,s,l,a;this.colIndex=0;let o=this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1,h=this._columnHeaderCellFullPathIds.slice(0),u=h[this.columnHeaderLevelCount-1].map((t,i)=>({col:i+this.rowHeaderLevelCount,row:e})),d=this.getHeader(t,e);if(d.define.hierarchyState=d.define.hierarchyState===n.g.collapse?n.g.expand:n.g.collapse,this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this.resetColumnHeaderLevelCount(),this._columnHeaderCellFullPathIds=[],this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),"grid-tree"===this.columnHierarchyType&&(this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.columnHeaderTitle){let t=++this.sharedVar.seqId,e=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(t);this._columnHeaderCellFullPathIds.unshift(e);let n={id:t,title:"string"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(r=null==(i=this.columnHeaderTitle)?void 0:i.headerType)?r:"text",style:null==(s=this.columnHeaderTitle)?void 0:s.headerStyle,define:{id:t,disableHeaderHover:!!(null==(l=this.columnHeaderTitle)?void 0:l.disableHeaderHover),disableHeaderSelect:!!(null==(a=this.columnHeaderTitle)?void 0:a.disableHeaderSelect)}};this.columnHeaderObjs.push(n),this._headerObjects[t]=n}this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0;let c=this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1,p=function(t,e,i,r,n,s){let l=s.rowHeaderLevelCount,a=[],o=[];for(let t=0;t<i.length;t++)r.includes(i[t])||o.push(n[t]);for(let t=0;t<r.length;t++)if(!i.includes(r[t])){let i={col:l+t,row:e};a.push(i)}let h=s.getParentCellId(t,e),u=s.getRowHeaderCellAddressByCellId(h),d=[];for(u&&d.push(u);u&&h;)(h=s.getParentCellId(u.col,u.row))&&d.push(u=s.getRowHeaderCellAddressByCellId(h));let c=[],p=[];if("grid-tree"===s.columnHierarchyType&&"row"===s.cornerSetting.titleOnDimension&&s.columnHeaderLevelCount!==s._cornerHeaderCellIds.length)if(s.columnHeaderLevelCount>s._cornerHeaderCellIds.length)for(let e=s._cornerHeaderCellIds.length;e<s.columnHeaderLevelCount;e++)c.push({col:t,row:e});else for(let e=s.columnHeaderLevelCount;e<s._cornerHeaderCellIds.length;e++)p.push({col:t,row:e});return{addCellPositionsColumnDirection:a,removeCellPositionsColumnDirection:o,updateCellPositionsColumnDirection:d,addCellPositionsRowDirection:c,removeCellPositionsRowDirection:p}}(t,e,h[o],this._columnHeaderCellFullPathIds[c],u,this);return this.generateCellIdsConsiderHideHeader(),"grid-tree"===this.columnHierarchyType&&this.setColumnWidths(),p}isHeaderForColWidth(t,e){return this.isHeader(t,e)}getHeaderForColWidth(t,e){return this.getHeader(t,e)}getPivotCellAdress(t){var e;if(!Array.isArray(t))return;let i,r,n=this.rowTree,s=this.columnTree;for(let l=0;l<t.length;l++){let a=t[l];if((a.isPivotCorner||!(0,u.Z)(a.value))&&l===t.length-1){if("row"===(null==(e=null==this?void 0:this.cornerSetting)?void 0:e.titleOnDimension)){let t=0;return"grid"===this.rowHierarchyType&&(t=this.rowDimensionKeys.indexOf(a.dimensionKey)),-1===t?void 0:{col:(this.rowHeaderTitle?t+1:t)+this.leftRowSeriesNumberColumnCount,row:0}}let t=this.colDimensionKeys.indexOf(a.dimensionKey);return -1===t?void 0:{col:0+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderTitle?t+1:t}}let o=!1;for(let t=0;t<s.length;t++){let e=s[t];if(((0,u.Z)(a.dimensionKey)&&e.dimensionKey===a.dimensionKey||(0,u.Z)(a.indicatorKey)&&e.indicatorKey===a.indicatorKey)&&e.value===a.value){s=e.children,r=e,o=!0;break}}if(!o)for(let t=0;t<n.length;t++){let e=n[t];if(((0,u.Z)(a.dimensionKey)&&e.dimensionKey===a.dimensionKey||(0,u.Z)(a.indicatorKey)&&e.indicatorKey===a.indicatorKey)&&e.value===a.value){n=e.children,i=e;break}}}let l=0,a=0;if(i){a=this.columnHeaderLevelCount;let{startInTotal:t,afterSpanLevel:e}=i;return a+=t,{col:l="grid"===this.rowHierarchyType?(this.rowHeaderTitle?e+1:e)+this.leftRowSeriesNumberColumnCount:0+this.leftRowSeriesNumberColumnCount,row:a}}if(r){l=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;let{startInTotal:t,afterSpanLevel:e}=r;return{col:l+=t,row:a=this.columnHeaderTitle?e+1:e}}}getPivotDimensionInfo(t,e){var i;let{colHeaderPaths:r,rowHeaderPaths:n}=this.getCellHeaderPaths(t,e),s=[];return r.length?r.forEach((t,e)=>{s.push({dimensionKey:t.dimensionKey,value:t.value,isPivotCorner:!1,indicatorKey:t.indicatorKey})}):n.length?n.forEach((t,e)=>{s.push({dimensionKey:t.dimensionKey,value:t.value,isPivotCorner:!1,indicatorKey:t.indicatorKey})}):this.isCornerHeader(t,e)&&("row"===(null==(i=null==this?void 0:this.cornerSetting)?void 0:i.titleOnDimension)?s.push({dimensionKey:this.rowDimensionKeys[(this.rowHeaderTitle?t-1:t)-this.leftRowSeriesNumberColumnCount],isPivotCorner:!0}):s.push({dimensionKey:this.colDimensionKeys[this.columnHeaderTitle?e-1:e],isPivotCorner:!0})),s}getIndicatorKey(t,e){var i;return null==(i=this.getBody(t,e))?void 0:i.indicatorKey}getParentCellId(t,e){if(0!==e)return this.isColumnHeader(t,e)?this.getCellId(t,e-1):this.isRowHeader(t,e)?this.getCellId(t-1,e):void 0}getRowHeaderCellAddressByCellId(t){let e,i;if(this._rowHeaderCellIds.find((r,n)=>!!r.find((i,r)=>i===t&&(e=r,!0))&&(i=n,!0)),(0,u.Z)(e)&&(0,u.Z)(i))return{col:e,row:i+this.columnHeaderLevelCount}}canMoveHeaderPosition(t,e){if(this.isSeriesNumberInHeader(e.col,e.row)||this.isSeriesNumberInHeader(t.col,t.row)||this.isCornerHeader(e.col,e.row)||t.col<0||t.row<0||e.col<0||e.row<0)return!1;this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)&&(t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1);let i=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row))return this.getParentCellId(t.col,i.start.row)===this.getParentCellId(e.col,i.start.row);if(this.isRowHeader(t.col,t.row)){if("tree"!==this.rowHierarchyType)return this.getParentCellId(i.start.col,t.row)===this.getParentCellId(i.start.col,e.row);{let i=(0,h.Z)(this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths),r=(0,h.Z)(this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths);if(i.pop(),r.pop(),i.length<=r.length){if(i.length===r.length)return!i.find((t,e)=>t.dimensionKey!==r[e].dimensionKey||t.value!==r[e].value);if(i.length>0){for(let t=0;t<i.length;t++)if(i[t].startInTotal!==r[t].startInTotal)return!1}return!0}}}return!1}moveHeaderPosition(t,e){var i,r;if((!(null==(i=this._table.options.dragOrder)?void 0:i.validateDragOrderOnEnd)||(null==(r=this._table.options.dragOrder)?void 0:r.validateDragOrderOnEnd(t,e)))&&this.canMoveHeaderPosition(t,e)&&!this.isCellRangeEqual(t.col,t.row,e.col,e.row)){let i=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row)){let r,n=i.end.col-i.start.col+1,s=this.getCellRange(e.col,i.start.row);if((r=e.col>=t.col?s.end.col-n+1:s.start.col)===i.start.col)return null;for(let t=0;t<this._columnHeaderCellFullPathIds.length;t++){let e=this._columnHeaderCellFullPathIds[t].splice(i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,n);e.unshift(r-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnHeaderCellFullPathIds[t],e)}let l=this._columnWidths.splice(i.start.col-this.leftRowSeriesNumberColumnCount,n);return l.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnWidths,l),this.columnDimensionTree.movePosition(this.getCellHeaderPathsWithTreeNode(t.col,t.row).colHeaderPaths.length-1,i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,s.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount),this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.col,targetIndex:r,sourceSize:n,targetSize:s.end.col-s.start.col+1,moveType:"column"}}if(this.isRowHeader(t.col,t.row)){let r,n=this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,s=this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,l=n[n.length-1],a=s[n.length-1],o=l.size;if((r=e.row>=t.row?a.startInTotal+a.size-o:a.startInTotal)===i.start.row-this.columnHeaderLevelCount)return null;let h=this._rowHeaderCellIds.splice(i.start.row-this.columnHeaderLevelCount,o);h.unshift(r-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellIds,h);let u=this._rowHeaderCellFullPathIds.splice(i.start.row-this.columnHeaderLevelCount,o);u.unshift(r-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds,u);let d=this._rowHeaderCellIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,o);d.unshift(r,0),Array.prototype.splice.apply(this._rowHeaderCellIds_FULL,d);let c=this._rowHeaderCellFullPathIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,o);return c.unshift(r,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds_FULL,c),this.rowDimensionTree.movePosition(n.length-1,i.start.row-this.columnHeaderLevelCount,r+(e.row>t.row?l.size-1:0)),this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.row,targetIndex:r+this.columnHeaderLevelCount,sourceSize:o,targetSize:a.size,moveType:"row"}}}return null}getCellAdressByHeaderPath(t){var e,i,r,n,s,l,a,o;let h,d,c=!1,g=!1;if(Array.isArray(t)){if(t.length>this.rowDimensionKeys.length+this.colDimensionKeys.length)return;h=t.filter(t=>this.colDimensionKeys.indexOf(t.dimensionKey)>=0||this.colDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&t.indicatorKey),d=t.filter(t=>this.rowDimensionKeys.indexOf(t.dimensionKey)>=0||this.rowDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&t.indicatorKey)}else h=t.colHeaderPaths,d=t.rowHeaderPaths,"body"===(null==t?void 0:t.cellLocation)&&this._table.isPivotTable()&&(g=!0);if(!Array.isArray(h)&&!Array.isArray(d))return;if(null==h||h.sort((t,e)=>{var i,r;return this.colDimensionKeys.indexOf(null!=(i=t.dimensionKey)?i:this.indicatorDimensionKey)-this.colDimensionKeys.indexOf(null!=(r=e.dimensionKey)?r:this.indicatorDimensionKey)}),null==d||d.sort((t,e)=>{var i,r;return this.fullRowDimensionKeys.indexOf(null!=(i=t.dimensionKey)?i:this.indicatorDimensionKey)-this.fullRowDimensionKeys.indexOf(null!=(r=e.dimensionKey)?r:this.indicatorDimensionKey)}),null==h||h.forEach(t=>{t.isPivotCorner&&(c=!0)}),null==d||d.forEach(t=>{t.isPivotCorner&&(c=!0)}),c){if("all"===this.cornerSetting.titleOnDimension&&this.indicatorsAsCol&&0===h.length){for(let t=0;t<this.rowDimensionKeys.length;t++)if((null==(e=d[0])?void 0:e.dimensionKey)===this.rowDimensionKeys[t])return{col:t+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderLevelCount-1}}else if("all"!==this.cornerSetting.titleOnDimension||this.indicatorsAsCol||0!==d.length){if("row"!==this.cornerSetting.titleOnDimension&&("all"!==this.cornerSetting.titleOnDimension||this.indicatorsAsCol)){for(let t=0;t<this.colDimensionKeys.length;t++)if((null==(n=h[0])?void 0:n.dimensionKey)===this.colDimensionKeys[t])return{col:0,row:t}}else for(let t=0;t<this.rowDimensionKeys.length;t++)if((null==(r=d[0])?void 0:r.dimensionKey)===this.rowDimensionKeys[t])return{col:t+this.leftRowSeriesNumberColumnCount,row:0}}else for(let t=0;t<this.colDimensionKeys.length;t++)if((null==(i=h[0])?void 0:i.dimensionKey)===this.colDimensionKeys[t])return{col:this.rowHeaderLevelCount-1,row:t}}let f,m,y,v,b=!1,_=!1;(null==h?void 0:h.length)>=1&&(null==d?void 0:d.length)>=1&&(b=!0,_=!0),null!=(s=null==h?void 0:h.length)&&s&&h.length>=this._getColumnHeaderTreeExpandedMaxLevelCount()&&(b=!0),null!=(l=null==d?void 0:d.length)&&l&&d.length>=this._getRowHeaderTreeExpandedMaxLevelCount()&&(_=!0);let x,C,w=this.rowTree,S=this.columnTree;if(h)for(let t=0;t<h.length;t++){let e=h[t];for(let t=0;t<S.length;t++){let i=S[t];if(!(0,u.Z)(e.indicatorKey)&&i.dimensionKey===e.dimensionKey&&i.value===e.value||(0,u.Z)(e.indicatorKey)&&i.indicatorKey===e.indicatorKey&&((0,u.Z)(i.value)&&(0,u.Z)(e.value)&&e.value===i.value||!(0,u.Z)(i.value)||!(0,u.Z)(e.value))){S=i.children,(!b||(null==S?void 0:S.length))&&b||(C=i);break}}}if((null==d?void 0:d.length)>=1)if("tree"===this.rowHierarchyType){let t=d[d.length-1],e=this.headerObjects.filter(e=>((null==e?void 0:e.field)===t.dimensionKey||(null==e?void 0:e.field)===t.indicatorKey)&&(null==e?void 0:e.title)===t.value).map(t=>t.id),i=this._rowHeaderCellIds.filter(t=>e.indexOf(t[t.length-1])>=0).find(t=>{let e=this.findFullCellIds(t);return e.length===d.length&&e.every(t=>{let e=this._headerObjectMap[t];return d.find(t=>t.dimensionKey===e.field&&t.value===e.title)})});m=this._rowHeaderCellIds.indexOf(i)+this.columnHeaderLevelCount}else for(let t=0;t<d.length;t++){let e=d[t];for(let t=0;t<w.length;t++){let i=w[t];if(!(0,u.Z)(e.indicatorKey)&&i.dimensionKey===e.dimensionKey&&i.value===e.value||(0,u.Z)(e.indicatorKey)&&i.indicatorKey===e.indicatorKey&&(!(0,u.Z)(e.value)||i.value===e.value)){w=i.children,(!_||(null==w?void 0:w.length)&&!w.some(t=>"axis"===t.dimensionKey))&&_||(x=i);break}}}if(g||!b||!_||(x||(0,u.Z)(m))&&C){if(x||g){m=this.columnHeaderLevelCount;let{startInTotal:t,afterSpanLevel:e}=null!=(a=x)?a:p;m+=null!=t?t:0,y="grid"===this.rowHierarchyType?(this.rowHeaderTitle?e+1:e)+this.leftRowSeriesNumberColumnCount:0}if(C||g){f=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;let{startInTotal:t,afterSpanLevel:e}=null!=(o=C)?o:p;f+=null!=t?t:0,v=this.columnHeaderTitle?e+1:e}return(0,u.Z)(f)||(0,u.Z)(m)?{col:null!=f?f:y,row:null!=m?m:v}:void 0}}setChartInstance(t,e,i){var r,n,s,l;let a,o=this.getCellHeaderPaths(t,e);if(this.indicatorsAsCol){let t=null==(r=o.colHeaderPaths.find(t=>t.indicatorKey))?void 0:r.indicatorKey;a=null==(n=this._indicators)?void 0:n.find(e=>e.indicatorKey===t)}else{let t=null==(s=o.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:s.indicatorKey;a=null==(l=this._indicators)?void 0:l.find(e=>e.indicatorKey===t)}"function"!=typeof(null==a?void 0:a.chartSpec)&&a&&(a.chartInstance=i)}getChartInstance(t,e){var i,r,n,s;let l,a=this.getCellHeaderPaths(t,e);if(this.indicatorsAsCol){let t=null==(i=a.colHeaderPaths.find(t=>t.indicatorKey))?void 0:i.indicatorKey;l=null==(r=this._indicators)?void 0:r.find(e=>e.indicatorKey===t)}else{let t=null==(n=a.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:n.indicatorKey;l=null==(s=this._indicators)?void 0:s.find(e=>e.indicatorKey===t)}return null==l?void 0:l.chartInstance}checkHasChart(){return(0,l.YL)(this)}getDimension(t,e){var i,r;return"column"===e?null==(i=this.columnsDefine)?void 0:i.find(e=>"string"!=typeof e&&e.dimensionKey===t):"row"===e?null==(r=this.rowsDefine)?void 0:r.find(e=>"string"!=typeof e&&e.dimensionKey===t):void 0}getAxisConfigInPivotChart(t,e){if((this.isFrozenColumn(t,e)||this.isRightFrozenColumn(t,e))&&(0,l.aw)(t,e,"row",this)||(this.isFrozenRow(t,e)||this.isBottomFrozenRow(t,e))&&(0,l.aw)(t,e,"col",this)){let i=c.F.getFunction("getAxisConfigInPivotChart")(t,e,this);if(!1!==(null==i?void 0:i.visible))return i}}isEmpty(t,e){return!!this._table.isPivotChart()&&(!!this.isLeftBottomCorner(t,e)||!!this.isRightBottomCorner(t,e)||!!this.isRightTopCorner(t,e))}isAxisCell(t,e){return!!this._table.isPivotChart()&&(!!(this.indicatorKeys.length>=1&&(0,l.eW)(this.indicatorsDefine)&&(this.isBottomFrozenRow(t,e)&&(0,l.aw)(t,e,"col",this)||this.isRightFrozenColumn(t,e)&&(0,l.aw)(t,e,"row",this)||this.isRowHeader(t,e)&&t===this.rowHeaderLevelCount-1&&(0,l.aw)(t,e,"row",this)||this.hasTwoIndicatorAxes&&this.indicatorsAsCol&&e===this.columnHeaderLevelCount-1&&(0,l.aw)(t,e,"col",this)))||!1)}getChartAxes(t,e){if((0,l.VR)(t,e,this)||this.isAxisCell(t,e))return(0,l.TQ)(t,e,this)}getRawChartSpec(t,e){return(0,l.ed)(t,e,this)}getChartSpec(t,e){return(0,l.K0)(t,e,this)}isShareChartSpec(t,e){return(0,l.TF)(t,e,this)}getChartDataId(t,e){return(0,l.py)(t,e,this)}isNoChartDataRenderNothing(t,e){return(0,l.f_)(t,e,this)}setPagination(t){var e,i,r,n,s,l,a;if(this.clearCellRangeMap(),this._table.internalProps.useOneRowHeightFillAll=!1,this.pagination=t,"grid"===this.rowHierarchyType&&(0,u.Z)(null==(e=this.pagination)?void 0:e.perPageCount)&&(0,u.Z)(null==(i=this.pagination)?void 0:i.currentPage)){!1===this.indicatorsAsCol&&(this.pagination.perPageCount=Math.ceil(this.pagination.perPageCount/this.indicatorKeys.length)*this.indicatorKeys.length);let{perPageCount:t,currentPage:e}=this.pagination;this.currentPageStartIndex=t*(e||0),this.currentPageEndIndex=this.currentPageStartIndex+t,this._rowHeaderCellIds=null==(r=this._rowHeaderCellIds_FULL)?void 0:r.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=null==(n=this._rowHeaderCellFullPathIds_FULL)?void 0:n.slice(this.currentPageStartIndex,this.currentPageEndIndex)}else this.currentPageStartIndex=0,this.currentPageEndIndex=this._rowHeaderCellIds_FULL.length,this._rowHeaderCellIds=null==(s=this._rowHeaderCellIds_FULL)?void 0:s.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=null==(l=this._rowHeaderCellFullPathIds_FULL)?void 0:l.slice(this.currentPageStartIndex,this.currentPageEndIndex);this.pagination&&(this.pagination.totalCount=null==(a=this._rowHeaderCellIds_FULL)?void 0:a.length)}release(){var t;let e=this._table._getActiveChartInstance();null==e||e.release(),null==(t=this._indicators)||t.forEach(t=>{var e;null==(e=t.chartInstance)||e.release()})}getHeadNode(t,e){var i,r,n;let s,l=this.getCellHeaderPaths(t,e);return l.rowHeaderPaths&&(null!=(r=null==(i=l.rowHeaderPaths)?void 0:i.length)?r:0)>0?s=null==(n=l.rowHeaderPaths)?void 0:n.slice(0,l.rowHeaderPaths.length):l.colHeaderPaths&&l.colHeaderPaths.length>0&&(s=l.colHeaderPaths.slice(0,l.colHeaderPaths.length)),this.getHeadNodeByRowOrColDimensions(s,t,e)}getHeadNodeByRowOrColDimensions(t,e,i){var r;if(!Array.isArray(t))return;let n,s,l=this.rowTree,a=this.columnTree;if((0,u.Z)(i)&&(0,u.Z)(e)&&"tree"===this.rowHierarchyType&&this.extensionRows&&e>=1+this.leftRowSeriesNumberColumnCount){let t=this.getCellId(e-1,i);l=this._rowHeaderExtensionTree[t].tree.children}for(let e=0;e<t.length;e++){let i=t[e];if((i.isPivotCorner||!(0,u.Z)(i.value))&&e===t.length-1)return;let o=!1;for(let t=0;t<a.length;t++){let e=a[t];if((0,u.Z)(i.dimensionKey)&&e.dimensionKey===i.dimensionKey&&e.value===i.value||(0,u.Z)(i.indicatorKey)&&e.indicatorKey===i.indicatorKey&&(e.value===i.value||!(0,u.Z)(i.value)||!(0,u.Z)(e.value))){a=e.children,s=e,o=!0;break}}if(!o)for(let t=0;t<(null!=(r=null==l?void 0:l.length)?r:0);t++){let e=l[t];if((0,u.Z)(i.dimensionKey)&&e.dimensionKey===i.dimensionKey&&e.value===i.value||(0,u.Z)(i.indicatorKey)&&e.indicatorKey===i.indicatorKey&&(e.value===i.value||!(0,u.Z)(i.value)||!(0,u.Z)(e.value))){l=e.children,n=e;break}}}return n||s||void 0}clearCellRangeMap(){this._largeCellRangeCache.length=0,this._CellHeaderPathMap=new Map}getDimensionKeyInChartSpec(t,e,i){var r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M;let k;if(!1===this.indicatorsAsCol){let f=this.getRawChartSpec(t,e);if(f&&(k="yField"===i?null!=(r=f.yField)?r:null==(s=null==(n=null==f?void 0:f.series)?void 0:n[0])?void 0:s.yField:"histogram"===f.type?f.x2Field:null!=(l=f.xField)?l:null==(o=null==(a=null==f?void 0:f.series)?void 0:a[0])?void 0:o.xField))return k;for(let t=0;t<this.indicatorsDefine.length;t++){let e=this.indicatorsDefine[t].chartSpec;if(e&&(k="yField"===i?null!=(h=e.yField)?h:null==(d=null==(u=null==e?void 0:e.series)?void 0:u[0])?void 0:d.yField:"histogram"===e.type?e.x2Field:null!=(c=e.xField)?c:null==(g=null==(p=null==e?void 0:e.series)?void 0:p[0])?void 0:g.xField))return k}}else{let r=this.getRawChartSpec(t,e);if(r&&(k="xField"===i?"histogram"===r.type?r.x2Field:null!=(f=r.xField)?f:null==(y=null==(m=null==r?void 0:r.series)?void 0:m[0])?void 0:y.xField:null!=(v=r.yField)?v:null==(_=null==(b=null==r?void 0:r.series)?void 0:b[0])?void 0:_.yField))return k;for(let t=0;t<this.indicatorsDefine.length;t++){let e=this.indicatorsDefine[t].chartSpec;if(e&&(k="xField"===i?"histogram"===e.type?e.x2Field:null!=(x=e.xField)?x:null==(w=null==(C=null==e?void 0:e.series)?void 0:C[0])?void 0:w.xField:null!=(S=e.yField)?S:null==(M=null==(A=null==e?void 0:e.series)?void 0:A[0])?void 0:M.yField))return k}}return null}_generateChartState(){return{vtable_selected:{filter:t=>{var e;return this._table._selectedDataItemsInChart.length>=1?!!this._table._selectedDataItemsInChart.find(e=>{for(let i in e)if("object"!=typeof e[i]&&e[i]!==t[i])return!1;return!0}):null!=(e=this._table._selectedDimensionInChart)&&!!e.length&&!!this._table._selectedDimensionInChart.every(e=>"object"==typeof e.value||t[e.key]===e.value)}},vtable_selected_reverse:{filter:t=>{var e;return this._table._selectedDataItemsInChart.length>=1?!this._table._selectedDataItemsInChart.find(e=>{for(let i in e)if("object"!=typeof e[i]&&e[i]!==t[i])return!1;return!0}):null!=(e=this._table._selectedDimensionInChart)&&!!e.length&&!this._table._selectedDimensionInChart.every(e=>"object"==typeof e.value||t[e.key]===e.value)}}}}updateDataStateToChartInstance(t){var e;if(!1!==(null==(e=null==t?void 0:t.getSpec().select)?void 0:e.enable)){t||(t=this._table._getActiveChartInstance());let e=this._generateChartState();this._indicators.forEach(t=>{var i;let r=t.chartInstance;!1!==(null==(i=t.chartSpec.select)?void 0:i.enable)&&r.updateState(e)}),null==t||t.updateState(e)}}updateDataStateToActiveChartInstance(t){var e;if(!1!==(null==(e=null==t?void 0:t.getSpec().select)?void 0:e.enable)){t||(t=this._table._getActiveChartInstance());let e=this._generateChartState();null==t||t.updateState(e)}}getIndicatorKeyInChartSpec(t,e){let i=this.getRawChartSpec(t,e),r=[];if(i){if(i.series||i.xField||i.yField)return!1===this.indicatorsAsCol?i.series?i.series.forEach(t=>{let e=t.yField;r.push(e)}):r.push(i.yField):i.series?i.series.forEach(t=>{let e=t.xField;r.push(e)}):r.push(i.xField),r;if(i.valueField&&r.push(i.valueField),r.length>=1)return r}return null}getOptimunHeightForChart(t,e){var i,r,n,s,l;let a,o,h=this.getCellHeaderPaths(this.rowHeaderLevelCount,t).rowHeaderPaths;for(let t in e&&h[h.length-1].indicatorKey&&h.pop(),this.dataset.collectValuesBy)if("yField"===this.dataset.collectValuesBy[t].type&&!this.dataset.collectValuesBy[t].range){a=null==(i=this.dataset.collectedValues[t])?void 0:i[h.map(t=>t.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)o=f(null!=(r=null==a?void 0:a.length)?r:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{let t=this._chartItemSpanSize||25;o=(null!=(n=null==a?void 0:a.length)?n:0)*(t+(e?0:t/3))}let u=(0,d.u)(null!=(l=null!=(s=this._chartPadding)?s:this._table.theme.bodyStyle.padding)?l:0);return o+u[0]+u[2]}getOptimunWidthForChart(t,e){var i,r,n,s,l;let a,o,h=this.getCellHeaderPaths(t,this.columnHeaderLevelCount).colHeaderPaths;for(let t in this.dataset.collectValuesBy)if("xField"===this.dataset.collectValuesBy[t].type&&!this.dataset.collectValuesBy[t].range){a=null==(i=this.dataset.collectedValues[t])?void 0:i[h.map(t=>t.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)o=f(null!=(r=null==a?void 0:a.length)?r:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{let t=this._chartItemSpanSize||25;o=(null!=(n=null==a?void 0:a.length)?n:0)*(t+(e?0:t/3))}let u=(0,d.u)(null!=(l=null!=(s=this._chartPadding)?s:this._table.theme.bodyStyle.padding)?l:0);return o+u[1]+u[3]}get leftAxesCount(){if(!this._table.isPivotChart())return 0;let t=this._table.pivotChartAxes.find(t=>"left"===t.orient);return!1===(null==t?void 0:t.visible)?0:(this.indicatorsAsCol,1)}get topAxesCount(){if(!this._table.isPivotChart())return 0;let t=this._table.pivotChartAxes.find(t=>"top"===t.orient);return!1===(null==t?void 0:t.visible)?0:this.indicatorsAsCol&&this.hasTwoIndicatorAxes?1:0}get rightAxesCount(){return this.rightFrozenColCount}get bottomAxesCount(){return this.bottomFrozenRowCount}getColKeysPath(t,e){let i=this.getCellHeaderPaths(t,e),r=[];return i.colHeaderPaths.length&&i.colHeaderPaths.forEach(t=>{t.dimensionKey&&r.push(t.value)}),null==r?void 0:r.join(this.dataset.stringJoinChar)}getRowKeysPath(t,e){let i=this.getCellHeaderPaths(t,e),r=[];return i.rowHeaderPaths.length&&i.rowHeaderPaths.forEach(t=>{t.dimensionKey&&r.push(t.value)}),null==r?void 0:r.join(this.dataset.stringJoinChar)}getIndicatorInfo(t,e=""){var i;return null==(i=this.indicatorsDefine)?void 0:i.find(i=>"string"!=typeof i&&(t?i.indicatorKey===t:!!e&&i.title===e))}getLayoutColumnTree(){let t=[],e=this.columnDimensionTree.tree.children;return(0,a.LC)(t,e),t}getLayoutRowTree(){let t=[],e=this.rowDimensionTree.tree.children;return(0,a.LC)(t,e),t}getLayoutColumnTreeCount(){let t=this.columnDimensionTree.tree.children;return(0,a.p$)(t,"tree"===this.rowHierarchyType)}getLayoutRowTreeCount(){var t;let e=this.rowDimensionTree.tree.children,i=(0,a.p$)(e,"tree"===this.rowHierarchyType);return null==(t=this.extensionRows)||t.forEach(t=>{if("function"!=typeof t.rowTree){let e=(0,a.p$)(t.rowTree,!0);i*=e}}),i}resetHeaderTree(){var t,e,i;this.colIndex=0,this._rowHeaderCellFullPathIds_FULL=[],this._columnHeaderCellFullPathIds=[],this._columnHeaderCellIds=[];let n=this.dataset;this.rowTree=n.rowHeaderTree,this.columnTree=n.colHeaderTree;let s=this.rowDimensionTree.tree.children;null==(t=this.rowTree)||t.forEach((t,e)=>{let i=s.find(e=>e.dimensionKey===t.dimensionKey&&e.value===t.value);i&&this._table._syncHierarchyState(i,t)}),this.columnDimensionTree=new a.KO(null!=(e=this.columnTree)?e:[],this.sharedVar,this.columnHierarchyType,"grid"!==this.columnHierarchyType?this.columnExpandLevel:void 0),this.rowDimensionTree=new a.KO(null!=(i=this.rowTree)?i:[],this.sharedVar,this.rowHierarchyType,"grid"!==this.rowHierarchyType?this.rowExpandLevel:void 0),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=(0,r.p4)(this._rowHeaderCellFullPathIds_FULL),this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination)}isSeriesNumberInHeader(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount&&e<this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e<this.headerLevelCount}isSeriesNumberInBody(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&e>=this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e>=this.headerLevelCount}isSeriesNumber(t,e){return!!((0,u.Z)(t)&&(0,u.Z)(e))&&(!!(this.leftRowSeriesNumberColumnCount>0)&&!!(t>=0)&&!!(e>=0)&&!!(t<this.leftRowSeriesNumberColumnCount)||!!(this.rightRowSeriesNumberColumnCount>0)&&!!(e>=0)&&!!(t>=this.colCount-this.rightRowSeriesNumberColumnCount))||!1}getSeriesNumberHeader(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&e<this.headerLevelCount?Object.assign({},this.leftRowSeriesNumberColumn[t],{style:Object.assign({},this._table.internalProps.theme.cornerHeaderStyle,this._table.internalProps.rowSeriesNumber.headerStyle)}):this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e<this.headerLevelCount&&e<this.headerLevelCount?this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}getSeriesNumberBody(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&e>=this.headerLevelCount?this.leftRowSeriesNumberColumn[t]:this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e>=this.headerLevelCount?this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}changeTreeNodeTitle(t,e,i){this.getHeadNode(t,e).value=i;let r=this.getCellId(t,e);this._headerObjectMap[r].title=i}changeCornerTitle(t,e,i){if(this.isCornerHeader(t,e)){let r=this.getCellId(t,e);this._headerObjectMap[r].title=i}}generateCellIdsConsiderHideHeader(){var t,e,i,r;if(this._columnHeaderCellIds=this._columnHeaderCellFullPathIds.slice(),!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){let t=this.colDimensionKeys.indexOf(s.ek),e=this._columnHeaderCellIds.splice(t,1);this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length),this._columnHeaderCellIds.push(e[0])}else this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length);if(this._rowHeaderCellIds_FULL=this._rowHeaderCellFullPathIds_FULL.slice(),!this.showRowHeader)if(this.indicatorsAsCol||this.hideIndicatorName)this._rowHeaderCellIds_FULL.forEach((t,e)=>{let i=t.slice();i.splice(0,i.length),this._rowHeaderCellIds_FULL[e]=i});else{let t=this.rowDimensionKeys.indexOf(s.ek);this._rowHeaderCellIds_FULL.forEach((e,i)=>{let r=e.slice(),n=r.splice(t,1);r.splice(0,r.length),r.push(n[0]),this._rowHeaderCellIds_FULL[i]=r})}if(this._rowHeaderCellIds=this._rowHeaderCellIds_FULL.slice(),this._cornerHeaderCellIds=this._cornerHeaderCellFullPathIds.slice(),0===this.rowHeaderLevelCount||0===this.columnHeaderLevelCount)this._cornerHeaderCellIds=[];else if("row"!==this.cornerSetting.titleOnDimension||this.showRowHeader){if("column"===this.cornerSetting.titleOnDimension&&!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){let t=this.colDimensionKeys.indexOf(s.ek),e=this._cornerHeaderCellIds.splice(t,1);this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length),this._cornerHeaderCellIds.push(e[0])}else this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length)}else if(this.indicatorsAsCol||this.hideIndicatorName)this._cornerHeaderCellIds.forEach((t,e)=>{let i=t.slice();i.splice(0,i.length),this._cornerHeaderCellIds[e]=i});else{let t=this.rowDimensionKeys.indexOf(s.ek);this._cornerHeaderCellIds.forEach((e,i)=>{let r=e.slice(),n=r.splice(t,1);r.splice(0,r.length),r.push(n[0]),this._cornerHeaderCellIds[i]=r})}if("grid-tree"===this.rowHierarchyType&&"column"===this.cornerSetting.titleOnDimension)this._cornerHeaderCellIds[0].length<this._rowHeaderCellIds[0].length?this._cornerHeaderCellIds.forEach((t,e)=>{let i=t.length;t.length=this._rowHeaderCellIds[0].length,t.fill(t[0],i)}):this._cornerHeaderCellIds[0].length>this._rowHeaderCellIds[0].length&&this._cornerHeaderCellIds.forEach((t,e)=>{t.length=this._rowHeaderCellIds[0].length});else if("grid-tree"===this.columnHierarchyType&&"row"===this.cornerSetting.titleOnDimension)if((null==(t=this._cornerHeaderCellIds)?void 0:t.length)<(null==(e=this._columnHeaderCellIds)?void 0:e.length)){let t=this._cornerHeaderCellIds.length;this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length,this._cornerHeaderCellIds.fill(this._cornerHeaderCellIds[0],t)}else(null==(i=this._cornerHeaderCellIds)?void 0:i.length)>(null==(r=this._columnHeaderCellIds)?void 0:r.length)&&(this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length)}enableUseGetBodyCache(){this._useGetBodyCache=!0,this._getBodyCache.clear()}disableUseGetBodyCache(){this._useGetBodyCache=!1,this._getBodyCache.clear()}enableUseHeaderPathCache(){var t,e;(null==(e=null==(t=this._table.options)?void 0:t.customConfig)?void 0:e.enablePivotPathCache)?this._useHeaderPathCache=!0:(this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear())}disableUseHeaderPathCache(){var t,e;(null==(e=null==(t=this._table.options)?void 0:t.customConfig)?void 0:e.enablePivotPathCache)?this._useHeaderPathCache=!0:(this._useHeaderPathCache=!1,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear())}getBodyWidthCache(t,e){if(this._useGetBodyCache&&!this.isHeader(t,e)&&!this.isSeriesNumber(t,e))return this.indicatorsAsCol&&this._getBodyCache.has(t)?this._getBodyCache.get(t):!this.indicatorsAsCol&&this._getBodyCache.has(e)?this._getBodyCache.get(e):void 0}setBodyWidthCache(t,e,i){!this._useGetBodyCache||this.isHeader(t,e)||this.isSeriesNumber(t,e)||(this.indicatorsAsCol?this._getBodyCache.set(t,i):this._getBodyCache.set(e,i))}getColHeaderPathCache(t,e){if(this._useHeaderPathCache&&!this.isHeader(t,e)&&!this.isSeriesNumber(t,e)&&this._colHeaderPathCache.has(t))return this._colHeaderPathCache.get(t)}setColHeaderPathCache(t,e,i){!this._useHeaderPathCache||this.isHeader(t,e)||this.isSeriesNumber(t,e)||this._colHeaderPathCache.set(t,i)}getRowHeaderPathCache(t,e){if(this._useHeaderPathCache&&!this.isHeader(t,e)&&!this.isSeriesNumber(t,e)&&this._rowHeaderPathCache.has(e))return this._rowHeaderPathCache.get(e)}setRowHeaderPathCache(t,e,i){!this._useHeaderPathCache||this.isHeader(t,e)||this.isSeriesNumber(t,e)||this._rowHeaderPathCache.set(e,i)}clearHeaderPathCache(){this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}isAggregation(t,e){if(this.isHeader(t,e))return!1;let i=this.getCellHeaderPaths(t,e);for(let t of i.colHeaderPaths)if("sub-total"===t.role||"grand-total"===t.role)return!0;for(let t of i.rowHeaderPaths)if("sub-total"===t.role||"grand-total"===t.role)return!0;return!1}expandAllForRowDimensionTree(){this.rowDimensionTree&&(this.rowDimensionTree.setAllNodesState(n.g.expand),this._rebuildRowLayout())}collapseAllForRowDimensionTree(){this.rowDimensionTree&&(this.rowDimensionTree.setAllNodesState(n.g.collapse),this._rebuildRowLayout())}expandAllForColumnDimensionTree(){this.columnDimensionTree&&(this.columnDimensionTree.setAllNodesState(n.g.expand),this._rebuildColumnLayout())}collapseAllForColumnDimensionTree(){this.columnDimensionTree&&(this.columnDimensionTree.setAllNodesState(n.g.collapse),this._rebuildColumnLayout())}}function f(t,e,i,r){var n,s,l;let a;1===i&&(i=0);let o=(n=t,s=i,l=r,a=1===n?n+2*l:n-s+2*l,n?a>0?a:1:0);return Math.ceil(e/(1-i)*o)}},10026:function(t,e,i){"use strict";i.d(e,{KO:()=>o,LC:()=>function t(e,i){Array.isArray(i)&&(null==i||i.forEach(i=>{var r,n;let s={dimensionKey:i.dimensionKey,indicatorKey:i.indicatorKey,value:i.value,hierarchyState:i.hierarchyState,children:void 0,virtual:null!=(r=i.virtual)&&r,levelSpan:null!=(n=i.levelSpan)?n:1};e.push(s),i.children&&(s.children=[],t(s.children,i.children))}))},g3:()=>h,gD:()=>function t(e,i,r,n,s){var l;for(let a=e.length-1;a>=0;a--){let o=e[a];if(i.push(o),n&&o.hide)e.splice(a,1);else if(o.indicatorKey){let t=null==(l=null==r?void 0:r.find(t=>t.indicatorKey===o.indicatorKey))?void 0:l.hide;"function"==typeof t?t({dimensionPaths:i,table:s})&&e.splice(a,1):t&&e.splice(a,1)}else o.children&&o.children.length>0&&t(o.children,i,r,n,s);i.pop()}},jS:()=>u,p$:()=>function t(e,i){let r=0;return null==e||e.forEach(e=>{i?r++:e.children&&0!==e.children.length||r++,e.children&&(r+=t(e.children,i))}),r},py:()=>d});var r=i(19465),n=i(18585),s=i(5723),l=i(13455),a=i(73664);class o{constructor(t,e,i="grid",r){this.hasHideNode=!1,this.sizeIncludeParent=!1,this.tree={id:0,dimensionKey:"",value:"",children:[],level:-1,afterSpanLevel:-1,levelSpan:1,startIndex:0,size:0,startInTotal:0,hierarchyState:void 0},this.totalLevel=0,this.expandedMaxLevel=0,this.dimensionKeys=new s.B,this.dimensionKeysIncludeVirtual=new s.B,this.cache=new Map,this.sizeIncludeParent=null!=r,this.setExpandLevel=r,this.hierarchyType=i,this.sharedVar=e,this.reset(t)}reset(t){this.totalLevel=0,this.expandedMaxLevel=0,this.hasHideNode=!1,this.cache.clear(),this.dimensionKeys=new s.B,this.dimensionKeysIncludeVirtual=new s.B,this.tree.children=t,this.setTreeNode(this.tree,0,this.tree)}setTreeNode(t,e,i){var r,n,s,o;t.startIndex=e,t.startInTotal=(null!=(r=i.startInTotal)?r:0)+t.startIndex,t.hide&&(this.hasHideNode=!0),(null!=(n=t.dimensionKey)?n:t.indicatorKey)&&(t.virtual||this.dimensionKeys.contain(t.indicatorKey?l.ek:t.dimensionKey)||this.dimensionKeys.put(t.level,t.indicatorKey?l.ek:t.dimensionKey),this.dimensionKeysIncludeVirtual.contain(t.indicatorKey?l.ek:t.dimensionKey)||this.dimensionKeysIncludeVirtual.put(t.level,t.indicatorKey?l.ek:t.dimensionKey),t.id||(t.id=++this.sharedVar.seqId));let h=t.dimensionKey&&this.sizeIncludeParent?1:0,u=t.children||t.columns;return"grid"===this.hierarchyType||null===this.hierarchyType?(null==u?void 0:u.length)>=1?u.forEach(e=>{var i,r,n;e.level=(null!=(i=t.level)?i:0)+1,"grid"===this.hierarchyType&&(e.afterSpanLevel=(null!=(r=t.afterSpanLevel)?r:0)+(null!=(n=t.levelSpan)?n:1)),this.totalLevel=Math.max(this.totalLevel,e.level+1),h+=this.setTreeNode(e,h,t)}):h=+(-1!==t.level):t.hierarchyState===a.g.expand&&(null==u?void 0:u.length)>=1?u.forEach(e=>{var i;e.level=(null!=(i=t.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,e.level+1),h+=this.setTreeNode(e,h,t)}):t.hierarchyState===a.g.collapse&&(null==u?void 0:u.length)>=1?u.forEach(e=>{var i;e.level=(null!=(i=t.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.setTreeNode(e,h,t)}):!t.hierarchyState&&t.level+1<this.setExpandLevel&&((null==u?void 0:u.length)>=1||!0===u)?((null==(s=u[0])?void 0:s.indicatorKey)&&"grid-tree"===this.hierarchyType||(t.hierarchyState=a.g.expand),(null==u?void 0:u.length)>=1&&u.forEach(e=>{var i;e.level=(null!=(i=t.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,e.level+1),h+=this.setTreeNode(e,h,t)})):(null==u?void 0:u.length)>=1||!0===u?((null==(o=u[0])?void 0:o.indicatorKey)&&"grid-tree"===this.hierarchyType||(t.hierarchyState=a.g.collapse),(null==u?void 0:u.length)>=1&&u.forEach(e=>{var i;e.level=(null!=(i=t.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.setTreeNode(e,h,t)})):(t.hierarchyState=a.g.none,h=+(-1!==t.level)),t.size=h,h}getTreePath(t,e=30){let i=[];return this.searchPath(t,this.tree,i,e),i.shift(),i}findNodeById(t,e){return t.find(t=>t.id===e)}searchPath(t,e,i,r){if(!e||t<e.startIndex||t>=e.startIndex+e.size||(i.push(e),!e.children||0===e.children.length||e.level>=r))return;let n=t-e.startIndex;if(this.cache.has(e.level+1)){let t=this.cache.get(e.level+1);if(n>=t.startIndex&&n<t.startIndex+t.size)return void this.searchPath(n,t,i,r)}let s=0,l=e.children.length-1;for(;s<=l;){let t=Math.floor((s+l)/2),a=e.children[t];if(n>=a.startIndex&&n<a.startIndex+a.size){this.cache.set(a.level,a);let t=[];this.cache.forEach((e,i)=>{i>a.level&&t.push(i)}),t.forEach(t=>{this.cache.delete(t)}),this.searchPath(n,a,i,r);break}n<a.startIndex?l=t-1:s=t+1}}movePosition(t,e,i){let r,n,s,l=(a,o)=>{if(void 0!==n&&void 0!==s)return;a.level===t&&(a.startInTotal===e&&(n=o),a.startInTotal<=i&&i<=a.startInTotal+a.size-1&&(s=o));let h=a.children||a.columns;if(h&&a.level<t){r=a;for(let t=0;t<h.length;t++)(e>=h[t].startInTotal&&e<=h[t].startInTotal+h[t].size||i>=h[t].startInTotal&&i<=h[t].startInTotal+h[t].size)&&l(h[t],t)}};l(this.tree,0);let a=r.children||r.columns,o=a.splice(n,1);o.unshift(s,0),Array.prototype.splice.apply(a,o)}getCopiedTree(){let t=(0,r.Z)(this.tree.children);return function t(e){for(let i=0;i<e.length;i++){let r=e[i];delete r.level,delete r.startIndex,delete r.id,delete r.levelSpan,delete r.size,delete r.startInTotal;let n=r.children||r.columns;n&&t(n)}}(t),t}setAllNodesState(t){this._updateNodeHierarchyState(this.tree,t)}_updateNodeHierarchyState(t,e){t.children&&t.children.length>0&&t.children[0].dimensionKey?(-1!==t.level&&(t.hierarchyState=e),t.children.forEach(t=>{this._updateNodeHierarchyState(t,e)})):t.hierarchyState=a.g.none}}function h(t,e,i,r,s,l){var a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B;let P=t.id,E=null!=(o=null==(a=l.rowsDefine)?void 0:a.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey))?o:null==(h=l.columnsDefine)?void 0:h.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey),I=null==(u=l.indicatorsDefine)?void 0:u.find(e=>"string"!=typeof e&&(t.indicatorKey?e.indicatorKey===t.indicatorKey:e.title===t.value&&!t.dimensionKey)),L={id:P,title:null!=(d=t.value)?d:null==I?void 0:I.title,field:t.dimensionKey,style:"function"==typeof(null==(c=null!=I?I:E)?void 0:c.headerStyle)?null==(p=null!=I?I:E)?void 0:p.headerStyle:Object.assign({},null==(g=null!=I?I:E)?void 0:g.headerStyle),headerType:null!=(m=null!=(f=null==I?void 0:I.headerType)?f:null==E?void 0:E.headerType)?m:"text",headerIcon:null!=(y=null==I?void 0:I.headerIcon)?y:null==E?void 0:E.headerIcon,define:Object.assign({},t,null!=I?I:Object.assign({},E,{sort:void 0})),fieldFormat:null!=(v=null==I?void 0:I.headerFormat)?v:null==E?void 0:E.headerFormat,dropDownMenu:null!=(b=null==I?void 0:I.dropDownMenu)?b:null==E?void 0:E.dropDownMenu,pivotInfo:{value:t.value,dimensionKey:t.dimensionKey,isPivotCorner:!1},width:null==E?void 0:E.width,minWidth:null==E?void 0:E.minWidth,maxWidth:null==E?void 0:E.maxWidth,showSort:null!=(_=null==I?void 0:I.showSort)?_:null==E?void 0:E.showSort,sort:null==I?void 0:I.sort,description:null==E?void 0:E.description};I?(I.customRender&&(t.customRender=I.customRender),(0,n.Z)(null==(x=l._indicators)?void 0:x.find(t=>t.indicatorKey===I.indicatorKey))||null==(C=l._indicators)||C.push({id:++l.sharedVar.seqId,indicatorKey:I.indicatorKey,field:I.indicatorKey,fieldFormat:null==I?void 0:I.format,cellType:null!=(S=null!=(w=null==I?void 0:I.cellType)?w:null==I?void 0:I.columnType)?S:"text",chartModule:"chartModule"in I?I.chartModule:null,chartSpec:"chartSpec"in I?I.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in I&&I.noDataRenderNothing,sparklineSpec:"sparklineSpec"in I?I.sparklineSpec:null,style:null==I?void 0:I.style,icon:null==I?void 0:I.icon,define:Object.assign({},t,I,{dragHeader:null==E?void 0:E.dragHeader}),width:null==I?void 0:I.width,minWidth:null==I?void 0:I.minWidth,maxWidth:null==I?void 0:I.maxWidth,disableColumnResize:null==I?void 0:I.disableColumnResize})):t.indicatorKey&&((0,n.Z)(null==(A=l._indicators)?void 0:A.find(e=>e.indicatorKey===t.indicatorKey))||null==(M=l._indicators)||M.push({id:++l.sharedVar.seqId,indicatorKey:t.indicatorKey,field:t.indicatorKey,cellType:"text",define:Object.assign({},t)})),i[P]=L,l._headerObjects[P]=L;for(let t=s-1;t>=0;t--)e[t][l.colIndex]=r[t];if(e[s][l.colIndex]=P,t.levelSpan>1)for(let i=1;i<t.levelSpan;i++){if(!e[s+i]){e[s+i]=[];for(let t=0;t<l.colIndex;t++)e[s+i][t]=e[s][t]}e[s+i][l.colIndex]=P}if((null==(k=t.children)?void 0:k.length)>=1)l._addHeaders(e,s+(null!=(T=t.levelSpan)?T:1),null!=(R=t.children)?R:[],[...r,...Array(null!=(B=t.levelSpan)?B:1).fill(P)],i);else{for(let t=s+1;t<e.length;t++)e[t][l.colIndex]=P;l.colIndex++}}function u(t,e,i,r,s,l,o,h,u,d,c,p){var g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X,q,J;let Q=t.id,te=null!=(f=null==(g=p.rowsDefine)?void 0:g.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey))?f:null==(m=p.columnsDefine)?void 0:m.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey),ti=null==(y=p.indicatorsDefine)?void 0:y.find(e=>"string"!=typeof e&&(t.indicatorKey?e.indicatorKey===t.indicatorKey:e.title===t.value&&!t.dimensionKey)),tr={id:Q,title:null!=(v=t.value)?v:null==ti?void 0:ti.title,field:t.dimensionKey,style:"function"==typeof(null==(b=null!=ti?ti:te)?void 0:b.headerStyle)?null==(_=null!=ti?ti:te)?void 0:_.headerStyle:Object.assign({},null==(x=null!=ti?ti:te)?void 0:x.headerStyle),headerType:null!=(w=null!=(C=null==ti?void 0:ti.headerType)?C:null==te?void 0:te.headerType)?w:"text",headerIcon:null!=(S=null==ti?void 0:ti.headerIcon)?S:null==te?void 0:te.headerIcon,define:Object.assign(t,{linkJump:null==(A=null!=ti?ti:te)?void 0:A.linkJump,linkDetect:null==(M=null!=ti?ti:te)?void 0:M.linkDetect,templateLink:null==(k=null!=ti?ti:te)?void 0:k.templateLink,keepAspectRatio:null!=(R=null==(T=null!=ti?ti:te)?void 0:T.keepAspectRatio)&&R,imageAutoSizing:null==(B=null!=ti?ti:te)?void 0:B.imageAutoSizing,headerCustomRender:null==(P=null!=ti?ti:te)?void 0:P.headerCustomRender,headerCustomLayout:null==(E=null!=ti?ti:te)?void 0:E.headerCustomLayout,dragHeader:null==te?void 0:te.dragHeader,disableHeaderHover:!!(null==(I=null!=ti?ti:te)?void 0:I.disableHeaderHover),disableHeaderSelect:!!(null==(L=null!=ti?ti:te)?void 0:L.disableHeaderSelect),showSort:null!=(F=null==ti?void 0:ti.showSort)?F:null==te?void 0:te.showSort,hide:null==ti?void 0:ti.hide}),fieldFormat:null!=(O=null==ti?void 0:ti.headerFormat)?O:null==te?void 0:te.headerFormat,dropDownMenu:null!=(D=null==ti?void 0:ti.dropDownMenu)?D:null==te?void 0:te.dropDownMenu,pivotInfo:{value:t.value,dimensionKey:t.dimensionKey,isPivotCorner:!1},hierarchyLevel:t.level,dimensionTotalLevel:l,hierarchyState:t.hierarchyState,width:null==te?void 0:te.width,minWidth:null==te?void 0:te.minWidth,maxWidth:null==te?void 0:te.maxWidth,showSort:null!=(H=null==ti?void 0:ti.showSort)?H:null==te?void 0:te.showSort,sort:null==ti?void 0:ti.sort,description:null==te?void 0:te.description,parentCellId:r[r.length-1]};ti?(ti.customRender&&(t.customRender=ti.customRender),(0,n.Z)(null==(z=p._indicators)?void 0:z.find(t=>t.indicatorKey===ti.indicatorKey))||null==(W=p._indicators)||W.push({id:++p.sharedVar.seqId,indicatorKey:ti.indicatorKey,field:ti.indicatorKey,fieldFormat:null==ti?void 0:ti.format,cellType:null!=(j=null!=(N=null==ti?void 0:ti.cellType)?N:null==ti?void 0:ti.columnType)?j:"text",chartModule:"chartModule"in ti?ti.chartModule:null,chartSpec:"chartSpec"in ti?ti.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in ti&&ti.noDataRenderNothing,sparklineSpec:"sparklineSpec"in ti?ti.sparklineSpec:null,style:null==ti?void 0:ti.style,icon:null==ti?void 0:ti.icon,define:Object.assign({},t,ti,{dragHeader:null==te?void 0:te.dragHeader}),width:null==ti?void 0:ti.width,minWidth:null==ti?void 0:ti.minWidth,maxWidth:null==ti?void 0:ti.maxWidth,disableColumnResize:null==ti?void 0:ti.disableColumnResize})):t.indicatorKey&&((0,n.Z)(null==(G=p._indicators)?void 0:G.find(e=>e.indicatorKey===t.indicatorKey))||null==(V=p._indicators)||V.push({id:++p.sharedVar.seqId,indicatorKey:t.indicatorKey,field:t.indicatorKey,cellType:"text",define:Object.assign({},t)})),i[Q]=tr,p._headerObjects[Q]=tr;for(let t=s-1;t>=0;t--)e[t][p.colIndex]=r[t];e[s][p.colIndex]=Q;let tn=Math.min((d?c:!c)?o:o-1,null!=(Z=t.levelSpan)?Z:1e3);if(tn>0)for(let t=s+1;t<tn;t++){if(!e[t]){e[t]=[];for(let i=0;i<p.colIndex;i++)e[t][i]=e[s][i]}e[t][p.colIndex]=Q}if((null==(U=(t.hierarchyState===a.g.expand&&t).children)?void 0:U.length)>=1)p._addHeadersForGridTreeMode(e,s+(null!=(K=t.levelSpan)?K:1),null!=($=t.children)?$:[],[...r,...Array(null!=(Y=t.levelSpan)?Y:1).fill(Q)],l,o,h&&t.hierarchyState===a.g.expand,u,i,d);else{let n=(d?c:!c)?o:o-1;for(let t=s+1;t<n;t++)e[t]||(e[t]=[]),e[t][p.colIndex]=Q;if(s<=n-1&&(d&&!1===c||!d&&!0===c)){let a=t;for(;a&&!(null==(X=a.children)?void 0:X[0].indicatorKey);)a=a.children[0];p._addHeadersForGridTreeMode(e,o-1,null!=(q=a.children)?q:[],[...r,...Array(Math.max(n-s,null!=(J=t.levelSpan)?J:1)).fill(Q)],l,o,!0,u,i,d)}else p.colIndex++}}function d(t,e,i,r,s,l,o,h,u){var d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D,H,z;let W=t.id,N=h.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey),j=null==(d=u.indicatorsDefine)?void 0:d.find(e=>"string"!=typeof e&&(t.indicatorKey?e.indicatorKey===t.indicatorKey:e.title===t.value)),G={id:W,title:null!=(c=t.value)?c:j.title,field:t.dimensionKey,style:t.level+1===l||"function"==typeof(null==(p=null!=j?j:N)?void 0:p.headerStyle)?null==(g=null!=j?j:N)?void 0:g.headerStyle:Object.assign({},null==(f=null!=j?j:N)?void 0:f.headerStyle,{textAlign:"left"}),headerType:null!=(y=null!=(m=null==j?void 0:j.headerType)?m:null==N?void 0:N.headerType)?y:"text",headerIcon:null!=(v=null==j?void 0:j.headerIcon)?v:null==N?void 0:N.headerIcon,define:Object.assign(t,{linkJump:null==(b=null!=j?j:N)?void 0:b.linkJump,linkDetect:null==(_=null!=j?j:N)?void 0:_.linkDetect,templateLink:null==(x=null!=j?j:N)?void 0:x.templateLink,keepAspectRatio:null!=(w=null==(C=null!=j?j:N)?void 0:C.keepAspectRatio)&&w,imageAutoSizing:null==(S=null!=j?j:N)?void 0:S.imageAutoSizing,headerCustomRender:null==(A=null!=j?j:N)?void 0:A.headerCustomRender,headerCustomLayout:null==(M=null!=j?j:N)?void 0:M.headerCustomLayout,dragHeader:null==N?void 0:N.dragHeader,disableHeaderHover:!!(null==(k=null!=j?j:N)?void 0:k.disableHeaderHover),disableHeaderSelect:!!(null==(T=null!=j?j:N)?void 0:T.disableHeaderSelect),showSort:null!=(R=null==j?void 0:j.showSort)?R:null==N?void 0:N.showSort,hide:null==j?void 0:j.hide}),fieldFormat:null!=(B=null==j?void 0:j.headerFormat)?B:null==N?void 0:N.headerFormat,dropDownMenu:null!=(P=null==j?void 0:j.dropDownMenu)?P:null==N?void 0:N.dropDownMenu,pivotInfo:{value:t.value,dimensionKey:t.dimensionKey,isPivotCorner:!1},hierarchyLevel:t.level,dimensionTotalLevel:l,hierarchyState:t.hierarchyState,width:null==N?void 0:N.width,minWidth:null==N?void 0:N.minWidth,maxWidth:null==N?void 0:N.maxWidth,parentCellId:r[r.length-1]};j?(j.customRender&&(t.customRender=j.customRender),(0,n.Z)(null==(E=u._indicators)?void 0:E.find(t=>t.indicatorKey===j.indicatorKey))||null==(I=u._indicators)||I.push({id:++u.sharedVar.seqId,indicatorKey:j.indicatorKey,field:j.indicatorKey,fieldFormat:null==j?void 0:j.format,cellType:null!=(F=null!=(L=null==j?void 0:j.cellType)?L:null==j?void 0:j.columnType)?F:"text",chartModule:"chartModule"in j?j.chartModule:null,chartSpec:"chartSpec"in j?j.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in j&&j.noDataRenderNothing,sparklineSpec:"sparklineSpec"in j?j.sparklineSpec:null,style:null==j?void 0:j.style,icon:null==j?void 0:j.icon,define:Object.assign({},t,j,{dragHeader:null==N?void 0:N.dragHeader}),width:null==j?void 0:j.width,minWidth:null==j?void 0:j.minWidth,maxWidth:null==j?void 0:j.maxWidth,disableColumnResize:null==j?void 0:j.disableColumnResize})):t.indicatorKey&&((0,n.Z)(null==(O=u._indicators)?void 0:O.find(e=>e.indicatorKey===t.indicatorKey))||null==(D=u._indicators)||D.push({id:++u.sharedVar.seqId,indicatorKey:t.indicatorKey,field:t.indicatorKey,cellType:"text",define:Object.assign({},t)})),i[W]=G,u._headerObjects[W]=G,e[s][u.colIndex]=W;for(let t=s-1;t>=0;t--)e[t][u.colIndex]=r[t];if(t.hierarchyState===a.g.expand&&(null==(H=t.children)?void 0:H.length)>=1)o&&u.colIndex++,u._addHeadersForTreeMode(e,s,null!=(z=t.children)?z:[],[...r,W],l,o&&t.hierarchyState===a.g.expand,h,i);else{o&&u.colIndex++;for(let t=s+1;t<e.length;t++)e[t][u.colIndex]=W}}},97257:function(t,e,i){"use strict";i.d(e,{Wg:()=>o,wh:()=>h,zf:()=>u});var r=i(70506),n=i(91212),s=i(18585),l=i(83093),a=i(13844);class o{constructor(t,e,i){this.table=t,this.customCellStyle=e,this.customCellStyleArrangement=i}getCustomCellStyle(t,e){let i=this.getCustomCellStyleIds(t,e);if(i.length){let s=[];return i.forEach(i=>{let n=this.getCustomCellStyleOption(i);if((0,r.Z)(null==n?void 0:n.style)){let i=n.style({col:t,row:e,table:this.table,value:this.table.getCellValue(t,e),dataValue:this.table.getCellOriginValue(t,e),cellHeaderPaths:this.table.getCellHeaderPaths(t,e)});s.push(i)}else(null==n?void 0:n.style)&&s.push(n.style)}),(0,n.Z)({},...s)}}getCustomCellStyleIds(t,e){let i=[],r=this.table.getCellRange(t,e);for(let t=r.start.col;t<=r.end.col;t++)for(let e=r.start.row;e<=r.end.row;e++)this.customCellStyleArrangement.forEach(r=>{r.cellPosition.range?r.cellPosition.range.start.col<=t&&r.cellPosition.range.end.col>=t&&r.cellPosition.range.start.row<=e&&r.cellPosition.range.end.row>=e&&i.push(r.customStyleId):r.cellPosition.col===t&&r.cellPosition.row===e&&i.push(r.customStyleId)});return i}getCustomCellStyleOption(t){return this.customCellStyle.find(e=>e.id===t)}registerCustomCellStyle(t,e){let i=this.customCellStyle.findIndex(e=>e.id===t);-1===i?this.customCellStyle.push({id:t,style:e}):this.customCellStyle[i]={id:t,style:e},this.customCellStyleArrangement.forEach(e=>{let i=e.cellPosition;if(e.customStyleId===t)if(i.range)for(let t=Math.max(0,i.range.start.col);t<=Math.min(this.table.colCount-1,i.range.end.col);t++)for(let e=Math.max(0,i.range.start.row);e<=Math.min(this.table.rowCount-1,i.range.end.row);e++)this.table.scenegraph.updateCellContent(t,e);else this.table.scenegraph.updateCellContent(i.col,i.row)}),this.table.scenegraph.updateNextFrame()}arrangeCustomCellStyle(t,e,i){var r;let n=this.customCellStyleArrangement.findIndex(e=>e.cellPosition.range&&t.range?e.cellPosition.range.start.col===t.range.start.col&&e.cellPosition.range.start.row===t.range.start.row&&e.cellPosition.range.end.col===t.range.end.col&&e.cellPosition.range.end.row===t.range.end.row:e.cellPosition.col===t.col&&e.cellPosition.row===t.row);if(-1===n&&!e)return;if(-1===n&&e)this.customCellStyleArrangement.push({cellPosition:{col:t.col,row:t.row,range:t.range},customStyleId:e});else{if(this.customCellStyleArrangement[n].customStyleId===e)return;e?this.customCellStyleArrangement[n].customStyleId=e:this.customCellStyleArrangement.splice(n,1)}let s=null==(r=this.getCustomCellStyleOption(e))?void 0:r.style;if(s){for(let t in i=!0,s)if(-1===l.n.indexOf(t)){i=!1;break}}if(t.range)for(let e=Math.max(0,t.range.start.col);e<=Math.min(this.table.colCount-1,t.range.end.col);e++)for(let r=Math.max(0,t.range.start.row);r<=Math.min(this.table.rowCount-1,t.range.end.row);r++){let t=this.table.getCellRange(e,r);for(let e=t.start.col;e<=t.end.col;e++)for(let r=t.start.row;r<=t.end.row;r++)this.table.scenegraph.updateCellContent(e,r,i)}else this.table.scenegraph.updateCellContent(t.col,t.row,i);this.table.scenegraph.updateNextFrame()}updateCustomCell(t,e){this.customCellStyle.length=0,this.customCellStyleArrangement.length=0,t.forEach(t=>{this.registerCustomCellStyle(t.id,t.style)}),e.forEach(t=>{this.arrangeCustomCellStyle(t.cellPosition,t.customStyleId)})}hasCustomCellStyle(t){return this.customCellStyle.some(e=>e.id===t)}}function h(t,e){for(let i in t=t.clone(),e){let r=e[i];(0,s.Z)(r)&&(t[`_${i}`]=r)}return t}let u=()=>{a.F.registerComponent("customCellStylePlugin",o)}},29812:function(t,e,i){"use strict";i.d(e,{Q:()=>r});class r{constructor(t,e){var i;this.plugins=new Map,this.table=t,null==(i=e.plugins)||i.map(t=>{this.register(t),this._bindTableEventForPlugin(t)})}register(t){this.plugins.set(t.id,t)}registerAll(t){t.forEach(t=>this.register(t))}getPlugin(t){return this.plugins.get(t)}getPluginByName(t){return Array.from(this.plugins.values()).find(e=>e.name===t)}_bindTableEventForPlugin(t){var e;null==(e=t.runTime)||e.forEach(e=>{this.table.on(e,(...i)=>{var r;null==(r=t.run)||r.call(t,...i,e,this.table)})})}updatePlugins(t){Array.from(this.plugins.values()).filter(e=>!(null==t?void 0:t.some(t=>t.id===e.id))).forEach(t=>{this.release(),this.plugins.delete(t.id)}),this.plugins.forEach(t=>{t.update&&t.update()});let e=null==t?void 0:t.filter(t=>!this.plugins.has(t.id));null==e||e.forEach(t=>{this.register(t),this._bindTableEventForPlugin(t)})}release(){this.plugins.forEach(t=>{var e;null==(e=t.release)||e.call(t,this.table)})}}},10315:function(t,e,i){"use strict";i.r(e),i.d(e,{aggregator:()=>p,chartModule:()=>d,clearAll:()=>f,editor:()=>c,icon:()=>u,theme:()=>h});var r=i(70107),n=i(47191),s=i(43894),l=i(85865),a=i(39940);function o(t,e,i){let r=t[e];return t[e]=i,r}function h(t,e){return null!=e?o(n.n,t,e):n.n[t]}function u(t,e){return null!=e?o(r.ci,t,e):r.ci[t]}function d(t,e){return null!=e?o(s.f,t,e):s.f[t]}function c(t,e){return null!=e?o(l.X,t,e):l.X[t]}function p(t,e){null!=e&&o(a.YJ,t,e)}function g(t){for(let e in t)delete t[e]}function f(){g(n.n),g(r.ci),g(s.f),g(l.X),g(a.YJ)}},76349:function(t,e,i){"use strict";i.d(e,{FH:()=>b,Jp:()=>w,cd:()=>_,nH:()=>S,ws:()=>x});var r=i(75485),n=i(41035),s=i(35953),l=i(64103),a=i(11089),o=i(32463),h=i(21093),u=i(70506),d=i(18585),c=i(58853),p=i(47e3),g=i(43735),f=i(28996),m=i(29322),y=i(75382);let v="_custom_",b="custom-container",_=v+"_0";function x(t,e,i,h,p,g,y,_,x,M,k){var T,R,B;let P,E,I,L,F=!0,O=!1;if("react-custom-layout"===t&&(t=(null==(T=k.reactCustomLayout)?void 0:T.getCustomLayoutFunc(i,h))||m.D),"function"==typeof t){let e=t({col:null!=(R=null==M?void 0:M.start.col)?R:i,row:null!=(B=null==M?void 0:M.start.row)?B:h,dataValue:k.getCellOriginValue(i,h),value:k.getCellValue(i,h)||"",rect:{left:0,top:0,right:p,bottom:g,width:p,height:g},table:k,originCol:i,originRow:h});if(!e)return{renderDefault:!0};e.rootContainer&&(e.rootContainer=S(e.rootContainer,k.animationManager.timeline)),e.rootContainer instanceof r.ZA&&((L=e.rootContainer).name=b,L.col=i,L.row=h),F=e.renderDefault,O=e.enableCellPadding}else if("function"==typeof e){let t=e({col:i,row:h,dataValue:k.getCellOriginValue(i,h),value:k.getCellValue(i,h)||"",rect:{left:0,top:0,right:p,bottom:g,width:p,height:g},table:k});t&&(I=t.elements,F=t.renderDefault,P=t.expectedWidth,E=t.expectedHeight)}else e&&(P=e.expectedWidth,E=e.expectedHeight,I=e.elements,F=e.renderDefault);return I&&(L=function(t,e,i,h){let p=new r.ZA({x:0,y:0,width:e,height:i,fill:!1,stroke:!1,pickable:!1});return p.name=b,(function(t,e,i,r){let n=[];for(let s=0;s<t.length;s++){let l=Object.assign({},t[s]);for(let t in l)l.hasOwnProperty(t)&&(0,u.Z)(l[t])&&(l[t]=l[t](r));(0,d.Z)(l.x)&&(l.x=(0,c.Z)(l.x)?C(l.x,e-0):Number(l.x)),(0,d.Z)(l.y)&&(l.y=(0,c.Z)(l.y)?C(l.y,i-0):Number(l.y)),"width"in l&&(l.width=(0,c.Z)(l.width)?C(l.width,e-0):Number(l.width)),"height"in l&&(l.height=(0,c.Z)(l.height)?C(l.height,i-0):Number(l.height)),"radius"in l&&(l.radius=(0,c.Z)(l.radius)?C(l.radius,Math.min(e-0,i-0)):Number(l.radius)),"hover"in l&&(l.hover.x=(0,c.Z)(l.hover.x)?C(l.hover.x,e-0):Number(l.hover.x),l.hover.y=(0,c.Z)(l.hover.y)?C(l.hover.y,i-0):Number(l.hover.y),l.hover.width=(0,c.Z)(l.hover.width)?C(l.hover.width,e-0):Number(l.hover.width),l.hover.height=(0,c.Z)(l.hover.height)?C(l.hover.height,i-0):Number(l.hover.height),l.hover.x+=0,l.hover.y+=0),l.x=l.x+0,l.y=l.y+0,n.push(l)}return n})(t,e,i,h).forEach(t=>{var e,i,r,h,u,d,c,g,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F;switch(t.clickable&&(t.pickable=t.clickable),t.type){case"arc":let O=(0,n.Q)({x:t.x,y:t.y,dx:null!=(e=t.dx)?e:0,dy:null!=(i=t.dy)?i:0,fill:t.fill,stroke:t.stroke,outerRadius:t.radius,startAngle:t.startAngle,endAngle:t.endAngle,pickable:!!t.pickable,cursor:t.cursor});O.name=t.name,p.appendChild(O);break;case"text":if(t.background){let e=null!=(h=null==(r=t.background)?void 0:r.expandX)?h:0,i=null!=(d=null==(u=t.background)?void 0:u.expandY)?d:0,n=(0,s.f)({x:t.x-e,y:t.y-i,dx:null!=(c=t.dx)?c:0,dy:null!=(g=t.dy)?g:0,width:t.width+2*e,height:t.height+2*i,cornerRadius:null!=(y=null==(m=t.background)?void 0:m.cornerRadius)?y:0,fill:null!=(b=null==(v=t.background)?void 0:v.fill)?b:"#888"});p.appendChild(n)}let D=new l.x(Object.assign({pickable:!!t.pickable,fill:null!=(_=t.color)?_:t.fill},t));D.name=t.name,p.appendChild(D);break;case"rect":let H=(0,s.f)({x:t.x,y:t.y,dx:null!=(x=t.dx)?x:0,dy:null!=(C=t.dy)?C:0,width:t.width,height:t.height,cornerRadius:t.radius,fill:t.fill,stroke:t.stroke,pickable:!!t.pickable,cursor:t.cursor});H.name=t.name,p.appendChild(H);break;case"circle":let z=(0,a.y)({x:t.x,y:t.y,dx:null!=(w=t.dx)?w:0,dy:null!=(S=t.dy)?S:0,radius:t.radius,fill:t.fill,stroke:t.stroke,pickable:!!t.pickable,cursor:t.cursor});z.name=t.name,p.appendChild(z);break;case"icon":let W=new f.J({x:t.x,y:t.y,dx:null!=(A=t.dx)?A:0,dy:null!=(M=t.dy)?M:0,width:t.width,height:t.height,image:t.svg,backgroundWidth:t.hover?null!=(k=t.hover.width)?k:t.width:void 0,backgroundHeight:t.hover?null!=(T=t.hover.width)?T:t.width:void 0,backgroundColor:t.hover?null!=(R=t.hover.bgColor)?R:"rgba(22,44,66,0.2)":void 0,pickable:!!t.pickable,cursor:t.cursor});W.name=t.name,W.role="icon-custom",p.appendChild(W);break;case"image":let N=new f.J({x:t.x,y:t.y,dx:null!=(B=t.dx)?B:0,dy:null!=(P=t.dy)?P:0,width:t.width,height:t.height,image:t.src,backgroundWidth:t.hover?null!=(E=t.hover.width)?E:t.width:void 0,backgroundHeight:t.hover?null!=(I=t.hover.width)?I:t.width:void 0,backgroundColor:t.hover?null!=(L=t.hover.bgColor)?L:"rgba(22,44,66,0.2)":void 0,pickable:!!t.pickable,cursor:t.cursor,shape:t.shape});N.name=t.name,N.role="image-custom",p.appendChild(N);break;case"line":let j=(0,o.W)({points:t.points,lineWidth:null!=(F=t.lineWidth)?F:1,stroke:t.stroke,pickable:!!t.pickable,cursor:t.cursor});j.name=t.name,p.appendChild(j)}}),p}(I,y?P:p,_?E:g,k.getCellValue(i,h))),O&&L.setAttributes({x:x[3],y:x[0],width:p-x[1]-x[3],height:g-x[0]-x[2]}),w(L,p,g),M&&(M.start.col!==M.end.col||M.start.row!==M.end.row)&&function t(e,i,r,n,s){e&&(e.name=`${v}${null!=s?s:""}_${n}`,e.onBeforeAttributeUpdate=A,"group"===e.type&&e.childrenCount&&e.forEachChildren((e,l)=>{t(e,i,r,l,(null!=s?s:"")+"_"+n)}))}(L,i,h,0),{elementsGroup:L,renderDefault:F}}function C(t,e){return t.endsWith("px")?parseInt(t,10):t.endsWith("%")&&e?parseInt(t,10)/100*e:parseInt(t,10)}function w(t,e,i){t&&t.forEachChildren(t=>{var r,n;t&&((0,p.Z)(t.attribute.width)&&t.attribute.width.percent&&t.setAttribute("width",Math.max(0,t.attribute.width.percent/100*e+(null!=(r=t.attribute.width.delta)?r:0))),t.attribute.width<0&&t.setAttribute("width",0),(0,p.Z)(t.attribute.height)&&t.attribute.height.percent&&t.setAttribute("height",Math.max(0,t.attribute.height.percent/100*i+(null!=(n=t.attribute.height.delta)?n:0))),t.attribute.height<0&&t.setAttribute("height",0),"group"===t.type&&w(t,t.attribute.width,t.attribute.height))})}function S(t,e){if(!t||!(0,d.Z)(t.$$typeof)&&!(0,d.Z)(t.vtype))return t;let i=t.type,{attribute:r,children:n,stateProxy:s,animation:l}=t.props,a=i({attribute:r});if(function(t,e){let i=!1;switch(t.type){case"richtext":case"rich/image":break;default:i=!0}i&&Object.keys(e).forEach(i=>{let r=h.Nv[i];r&&t.on(r,e[i])})}(a,t.props),s&&(a.stateProxy=s),a.id=r.id,a.name=r.name,(0,g.Z)(n)?n.forEach(t=>{let i=S(t,e);i&&i.type&&a.add(i)}):n&&a.add(S(n,e)),(0,g.Z)(l)&&e){let t=a.animate();t.setTimeline(e),l.forEach(e=>{t[e[0]](...e.slice(1))})}return a}function A(t,e){if(this.skipMergeUpdate)return;let i=(0,y.J$)(this);if(!i||!i.stage)return;let r=i.stage.table;this.skipAttributeUpdate=!0;let{mergeStartCol:n,mergeEndCol:s,mergeStartRow:l,mergeEndRow:a}=i;if((0,d.Z)(n)&&(0,d.Z)(s)&&(0,d.Z)(l)&&(0,d.Z)(a)&&(n!==s||l!==a)){for(let e=n;e<=s;e++)for(let n=l;n<=a;n++){if(e===i.col&&n===i.row)continue;let s=r.scenegraph.highPerformanceGetCell(e,n);if("cell"===s.role){let e=s.getChildByName(this.name,!0);if(!e||e.skipAttributeUpdate)continue;for(let i in t)t[i]!==e.attribute[i]&&"dx"!==i&&"dy"!==i&&e.setAttribute(i,t[i])}}this.skipAttributeUpdate=void 0}}},55634:function(t,e,i){"use strict";i.d(e,{e:()=>o,k:()=>h});var r=i(72790),n=i(35953),s=i(91212),l=i(22295),a=i(13222);let o=(0,r.Gg)();class h extends n.U{constructor(t,e){if(super(e),this.type="chart",this.numberType=o,this.isShareChartSpec=t,e.chartInstance)this.chartInstance=e.chartInstance;else{let t=this.chartInstance=new e.ClassType(e.spec,(0,s.Z)({},this.attribute.tableChartOption,{renderCanvas:e.canvas,mode:"node"===this.attribute.mode?"node":"desktop-browser",modeParams:this.attribute.modeParams,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:e.dpr,interactive:!1,animation:!1,autoFit:!1}));t.renderSync(),t.getStage().enableDirtyBounds(),e.chartInstance=this.chartInstance=t}}activate(t){var e,i,r,n;this.active=!0;let{col:o,row:u}=this.parent,d=(0,a.J)(this.parent,t),{x1:c,y1:p,x2:g,y2:f}=this.getViewBox(),m=(function(t,e,i){var r,n,s,a,o,h,u,d;let{layoutMap:c}=i.internalProps,p=new l.YZ,g=i.scenegraph.tableGroup.globalAABBBounds;return p.x1=g.x1,p.x2=g.x2,p.y1=g.y1,p.y2=g.y2,c.isLeftBottomCorner(t,e)||c.isRightTopCorner(t,e)||c.isLeftTopCorner(t,e)||c.isRightBottomCorner(t,e)||(c.isFrozenColumn(t,e)?(p.y1=g.y1+i.getFrozenRowsHeight(),p.y2=g.y2-i.getBottomFrozenRowsHeight()):c.isFrozenRow(t,e)?(p.x1=g.x1+i.getFrozenColsWidth(),p.x2=g.x2-i.getRightFrozenColsWidth()):c.isRightFrozenColumn(t,e)?(p.y1=g.y1+i.getFrozenRowsHeight(),p.y2=g.y2-i.getBottomFrozenRowsHeight()):c.isBottomFrozenRow(t,e)?(p.x1=g.x1+i.getFrozenColsWidth(),p.x2=g.x2-i.getRightFrozenColsWidth()):c.isFrozenColumn(t,e)||c.isRightFrozenColumn(t,e)||(p.x1=g.x1+i.getFrozenColsWidth(),p.x2=g.x2-i.getRightFrozenColsWidth(),p.y1=g.y1+i.getFrozenRowsHeight(),p.y2=g.y2-i.getBottomFrozenRowsHeight())),p.x1=p.x1+(null!=(n=null==(r=i.options.viewBox)?void 0:r.x1)?n:0),p.x2=p.x2+(null!=(a=null==(s=i.options.viewBox)?void 0:s.x1)?a:0),p.y1=p.y1+(null!=(h=null==(o=i.options.viewBox)?void 0:o.y1)?h:0),p.y2=p.y2+(null!=(d=null==(u=i.options.viewBox)?void 0:u.y1)?d:0),p})(o,u,t).intersect({x1:c-t.scrollLeft,x2:g-t.scrollLeft,y1:p-t.scrollTop,y2:f-t.scrollTop});null==(e=this.activeChartInstance)||e.release(),this.activeChartInstance=new this.attribute.ClassType(this.attribute.spec,(0,s.Z)({},this.attribute.tableChartOption,{renderCanvas:this.attribute.canvas,mode:"desktop-browser",canvasControled:!1,viewBox:{x1:0,x2:g-c,y1:0,y2:f-p},dpr:t.internalProps.pixelRatio,animation:!1,interactive:!0,autoFit:!1,beforeRender:e=>{let i=this.stage,r=e.window.getContext(),n=i.window.getViewBoxTransform(),s=i.window.getViewBox();r.inuse=!0,r.clearMatrix(),r.setTransform(n.a,n.b,n.c,n.d,n.e,n.f,!0),r.translate(s.x1,s.y1),r.setTransformForCurrent(!0),r.beginPath(),r.rect(m.x1,m.y1,m.x2-m.x1,m.y2-m.y1),r.clip(),r.clearMatrix(),t.options.canvas&&!e.needRender&&(e.pauseRender(),t.scenegraph.stage.dirtyBounds.union(this.globalAABBBounds),t.scenegraph.updateNextFrame())},afterRender(t){t.window.getContext().inuse=!1,t.needRender=!1,y.resumeRender()},renderHooks:{afterClearRect(t){let{context:e,layer:i,viewBox:r}=t;i.main&&t.clear&&d&&(e.beginPath(),e.fillStyle=d,e.rect(r.x1,r.y1,r.x2-r.x1,r.y2-r.y1),e.fill())}}}));let y=this.activeChartInstance.getStage(),v=this.globalTransMatrix.clone(),b=this.stage.window.getViewBoxTransform();v.multiply(b.a,b.b,b.c,b.d,b.e,b.f),y.window.setViewBoxTransform&&y.window.setViewBoxTransform(v.a,v.b,v.c,v.d,v.e,v.f),this.activeChartInstance.renderSync(),null==(r=null==(i=t.internalProps.layoutMap)?void 0:i.updateDataStateToActiveChartInstance)||r.call(i,this.activeChartInstance),this.activeChartInstance.on("click",e=>{var i;!1===(null==(i=this.attribute.spec.select)?void 0:i.enable)?t.scenegraph.updateChartState(null):h.temp&&t.scenegraph.updateChartState(null==e?void 0:e.datum)}),this.activeChartInstance.on("brushEnd",e=>{var i;t.scenegraph.updateChartState(null==(i=null==e?void 0:e.value)?void 0:i.inBrushData),h.temp=0,setTimeout(()=>{h.temp=1},0)}),null==(n=t._bindChartEvent)||n.call(t,this.activeChartInstance)}deactivate(){var t,e;this.active=!1,null==(t=this.activeChartInstance)||t.updateViewBox({x1:-1e3,x2:-800,y1:-1e3,y2:-800},!1,!1),null==(e=this.activeChartInstance)||e.release(),this.activeChartInstance=null}updateData(t){this.attribute.data=t}getViewBox(){var t,e,i,r,n,s,l,a;let o=this.parent,h=this.attribute.cellPadding,u=this.stage.table,{x1:d,y1:c,x2:p,y2:g}=o.globalAABBBounds;return{x1:Math.ceil(d+h[3]+u.scrollLeft+(null!=(e=null==(t=u.options.viewBox)?void 0:t.x1)?e:0)),x2:Math.ceil(d+o.attribute.width-h[1]+u.scrollLeft+(null!=(r=null==(i=u.options.viewBox)?void 0:i.x1)?r:0)),y1:Math.ceil(c+h[0]+u.scrollTop+(null!=(s=null==(n=u.options.viewBox)?void 0:n.y1)?s:0)),y2:Math.ceil(c+o.attribute.height-h[2]+u.scrollTop+(null!=(a=null==(l=u.options.viewBox)?void 0:l.y1)?a:0))}}}h.temp=1},79809:function(t,e,i){"use strict";i.d(e,{A8:()=>a,H6:()=>p,LO:()=>o,Ry:()=>c,Up:()=>m,a5:()=>g,eO:()=>function t(e){d=!0,o.length>0?h=requestAnimationFrame(()=>{let i=o.splice(0,u);a.splice(0,u),i.forEach(t=>{f(t),t.addUpdateBoundTag()}),e.render(),t(e)}):d=!1},pF:()=>f});var r=i(91018),n=i(56488),s=i(18585),l=i(22295);let a=[],o=[],h,u=5,d=!1;function c(t){(0,s.Z)(t)&&(u=t)}function p(){a=[],o=[],d=!1,cancelAnimationFrame(h)}function g(){return d}function f(t){var e,i,r,n,s,l,a;let{axes:o,dataId:h,data:u,spec:d,ClassType:c,canvas:p,mode:g,modeParams:f,dpr:y}=t.attribute,{chartInstance:v}=t;v||((v=new c(d,{renderCanvas:p,mode:"node"===g?"node":"desktop-browser",modeParams:f,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:y,interactive:!1,animation:!1,autoFit:!1})).renderSync(),t.chartInstance=v);let b=t.getViewBox();b.x2<=b.x1&&(b.x2=b.x1+1),b.y2<=b.y1&&(b.y2=b.y1+1),v.updateViewBox({x1:0,x2:b.x2-b.x1,y1:0,y2:b.y2-b.y1},!1,!1);let _=v.getStage(),x=t.globalTransMatrix,C=t.stage.window.getViewBoxTransform().clone();C.multiply(x.a,x.b,x.c,x.d,x.e,x.f),_.window.setViewBoxTransform&&_.window.setViewBoxTransform(C.a,C.b,C.c,C.d,C.e,C.f);let{table:w}=t.getRootNode(),S=!1;if(w.options.specFormat){let i=w.options.specFormat(t.attribute.spec,v,t);if(i.needFormatSpec&&i.spec){let t=i.spec;v.updateSpecSync(t,!1,{reuse:!1,morph:!1}),S=null==(e=i.updateSpec)||e}}if(!S)if(null==o||o.forEach((t,e)=>{var i,r,n,s,l;"band"===t.type?v.updateModelSpec({type:"axes",index:e},{domain:t.domain.slice(0)},!0):v.updateModelSpecSync({type:"axes",index:e},{min:null!=(r=null==(i=t.range)?void 0:i.min)?r:0,max:null!=(s=null==(n=t.range)?void 0:n.max)?s:0,tick:{tickMode:null==(l=t.tick)?void 0:l.tickMode}},!0)}),null==(r=null==(i=w.internalProps.layoutMap)?void 0:i.updateDataStateToActiveChartInstance)||r.call(i,v),"string"==typeof h)v.updateDataSync(h,null!=u?u:[]);else{let t=[];for(let e in h){let i=h[e],r=d.series.find(t=>{var i;return(null==(i=null==t?void 0:t.data)?void 0:i.id)===e});t.push({id:e,values:i?null!=(n=null==u?void 0:u.filter(t=>t.hasOwnProperty(i)))?n:[]:null!=u?u:[],fields:null==(s=null==r?void 0:r.data)?void 0:s.fields}),v.updateFullDataSync||v.updateDataSync(e,i?null!=(l=null==u?void 0:u.filter(t=>t.hasOwnProperty(i)))?l:[]:null!=u?u:[])}null==(a=v.updateFullDataSync)||a.call(v,t)}w.fireListeners("before_cache_chart_image",{chartInstance:v}),m(v.getStage(),t)}function m(t,e){var i;let{viewWidth:r,viewHeight:n}=t;if(r<2e3&&n<2e3)return e.cacheCanvas=y(t),void(e.isShareChartSpec||(null==(i=e.chartInstance)||i.release(),e.chartInstance=null,e.setAttribute("chartInstance",null)));let s=Math.ceil(n/2e3),a=Math.ceil(r/2e3),o=[];for(let e=0;e<s;e++)for(let i=0;i<a;i++){let s=2e3*i,a=2e3*e,h=s+2e3>r?r:s+2e3,u=a+2e3>n?n:a+2e3,d=h-s,c=u-a,p=new l.YZ;p.setValue(s,a,h,u);let g=y(t,!1,p);o.push({canvas:g,x:s,y:a,width:d,height:c})}e.cacheCanvas=o}function y(t,e=!0,i){if("released"===t.releaseStatus)return null;let s=(function(t,e=!0,i){let s=t.window.getViewBoxTransform(),l=r.n.get(n.Oo),a=i?-i.x1:0,o=i?-i.y1:0,h=i?i.x2:t.viewWidth,u=i?i.y2:t.viewHeight,d=i?i.width():t.viewWidth,c=i?i.height():t.viewHeight;return l.create({viewBox:{x1:a,y1:o,x2:h,y2:u},width:d*s.a,height:c*s.d,dpr:t.window.dpr,canvasControled:!0,offscreen:!0,title:""}),l.setViewBoxTransform(s.a,s.b,s.c,s.d,0,0),t.renderTo(l),l})(t,e,i).getNativeHandler();return s.nativeCanvas?s.nativeCanvas:null}},26771:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(75485);class n extends r.ZA{clear(){this.removeAllChild()}getChildByName(t,e){let i=null;return this.forEachChildren(e=>e.name===t&&(i=e,!0)),e&&this.forEachChildren(e=>{if(e.getChildByName){let r=e.getChildByName(t,!0);if(r)return i=r,!0}return!1}),i}get width(){var t;let e=this.AABBBounds.width();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,null!=(t=this.attribute.width)?t:0)}get height(){var t;let e=this.AABBBounds.height();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,null!=(t=this.attribute.height)?t:0)}setDeltaWidth(t){var e;0!==t&&(this.setAttribute("width",(null!=(e=this.attribute.width)?e:0)+t),this.border&&(this.border.setAttribute("width",this.border.attribute.width+t),"group"===this.border.type&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.width+t)))}setDeltaHeight(t){var e;0!==t&&(this.setAttribute("height",(null!=(e=this.attribute.height)?e:0)+t),this.border&&(this.border.setAttribute("height",this.border.attribute.height+t),"group"===this.border.type&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.height+t)))}setDeltaX(t){0!==t&&this.setAttribute("x",this.attribute.x+t)}setDeltaY(t){0!==t&&this.setAttribute("y",this.attribute.y+t)}forEachChildrenSkipChild(t,e="border-rect",i=!1){if(i){let i=this._lastChild,r=0;for(;i;){if(i.name!==e&&t(i,r++))return;i=i._prev}}else{let i=this._firstChild,r=0;for(;i;){if(i.name!==e&&t(i,r++))return;i=i._next}}}getColGroup(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<this.childrenCount;i++){if(e.col===t)return e;e=e._next}return null}getRowGroup(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<this.childrenCount;i++){if(e.row===t)return e;e=e._next}return null}addCellGroup(t){if(0===this.childrenCount||this.lastChild.row===t.row-1)this.addChild(t);else{let e=this._firstChild;for(let i=0;i<this.childrenCount;i++){if(e.row===t.row-1)return void this.insertAfter(t,e);e=e._next}this.addChild(t)}}getChildAt(t){let e=super.getChildAt(t);return e&&"border-rect"===e.name?e._next:e}tryUpdateAABBBounds(){if("cell"===this.role){var t,e;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;let i=this.shouldSelfChangeUpdateAABBBounds(),r=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),t=this,e=i,t.stage&&t.stage.dirtyBounds&&t.stage.renderCount&&(t.isContainer&&!e||t.stage.dirty(t.globalAABBBounds)),r}return super.tryUpdateAABBBounds()}doUpdateAABBBounds(){if("cell"===this.role){let{x:t,y:e,width:i,height:r}=this.attribute;return this._AABBBounds.setValue(t,e,t+i,e+r),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds}return"body"===this.role||"row-header"===this.role||"col-header"===this.role||"right-frozen"===this.role||"bottom-frozen"===this.role||"corner-header"===this.role||"corner-right-top-header"===this.role||"corner-right-bottom-header"===this.role||"corner-left-bottom-header"===this.role?(this._AABBBounds.setValue(-1/0,-1/0,1/0,1/0),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds):super.doUpdateAABBBounds()}updateColumnRowNumber(t){this.rowNumber?this.rowNumber=Math.max(this.rowNumber,t):this.rowNumber=t}updateColumnHeight(t){this.colHeight?this.colHeight+=t:this.colHeight=t}}},28996:function(t,e,i){"use strict";i.d(e,{J:()=>o,V:()=>h});var r=i(77474),n=i(20842),s=i(64103),l=i(29216),a=i(70107);class o extends r.E{constructor(t){super(t),this.failCallback=()=>{let{svg:t,src:e}=a.U2().damage_pic||{},i=t||e;i&&(super.image=i)},"mouseenter_cell"!==this.attribute.visibleTime&&"click_cell"!==this.attribute.visibleTime||(this.attribute.opacity=0),this.attribute.hoverImage&&(this.attribute.originImage=this.attribute.image),this.attribute.isGif&&this.attribute.gif&&this.loadGif()}loadGif(){this.playing=!1,n.h.GetFile(this.attribute.gif+"?role=gif"+`&radom=${Math.random()}`,"arrayBuffer").then(t=>{let e=(0,l.parseGIF)(t),i=(0,l.decompressFrames)(e,!0);this.renderGIF(i),this.resources.set(this.attribute.image,{state:"success",data:this.gifCanvas})}).catch(t=>{})}get backgroundWidth(){var t,e;return null!=(e=null!=(t=this.attribute.backgroundWidth)?t:this.attribute.width)?e:0}get backgroundHeight(){var t,e;return null!=(e=null!=(t=this.attribute.backgroundHeight)?t:this.attribute.height)?e:0}renderGIF(t){this.loadedFrames=t,this.frameIndex=0,this.tempCanvas||(this.tempCanvas=document.createElement("canvas"),this.tempCtx=this.tempCanvas.getContext("2d")),this.gifCanvas||(this.gifCanvas=document.createElement("canvas"),this.gifCtx=this.gifCanvas.getContext("2d")),this.gifCanvas.width=t[0].dims.width,this.gifCanvas.height=t[0].dims.height,this.playing=!0,this.lastTime=(new Date).getTime(),this.animate().to({},1e3,"linear").loop(1/0)}renderFrame(t,e,i){let r=this.loadedFrames[this.frameIndex||0];2===r.disposalType&&this.gifCtx.clearRect(0,0,this.gifCanvas.width,this.gifCanvas.height),this.drawPatch(r),this.manipulate(t,e,i);let n=(new Date).getTime()-this.lastTime;r.delay<n&&(this.frameIndex++,this.lastTime=(new Date).getTime()),this.frameIndex>=this.loadedFrames.length&&(this.frameIndex=0)}drawPatch(t){let e=t.dims;this.frameImageData&&e.width===this.frameImageData.width&&e.height===this.frameImageData.height||(this.tempCanvas.width=e.width,this.tempCanvas.height=e.height,this.frameImageData=this.tempCtx.createImageData(e.width,e.height)),this.frameImageData.data.set(t.patch),this.tempCtx.putImageData(this.frameImageData,0,0),this.gifCtx.drawImage(this.tempCanvas,e.left,e.top)}manipulate(t,e,i){t.drawImage(this.gifCanvas,0,0,this.gifCanvas.width,this.gifCanvas.height,e,i,this.attribute.width,this.attribute.height)}setAttribute(t,e,i,r){super.setAttribute(t,e,i,r),"gif"===t&&this.loadGif()}setAttributes(t,e,i){super.setAttributes(t,e,i),t.gif&&this.loadGif()}}class h extends s.x{constructor(t){var e,i,r,n,s;t.fill=null!=(e=t.fill)?e:"#00F",t.fontSize=null!=(i=t.fontSize)?i:12,t.underline=null!=(r=t.underline)?r:1,t.textBaseline=null!=(n=t.textBaseline)?n:"top",t.cursor=null!=(s=t.cursor)?s:"pointer",super(t)}}},42512:function(t,e,i){"use strict";i.d(e,{pZ:()=>S,l7:()=>M,kE:()=>b,NQ:()=>A,wW:()=>x});var r=i(13455),n=i(76349),s=i(67203),l=i(59885),a=i(57657),o=i(46936),h=i(13844),u=i(52186),d=i(14828),c=i(40793),p=i(58977),g=i(43735),f=i(3687),m=i(18585);function y(t,e){var i,r;if(this.shadowRoot&&this.shadowRoot.childrenCount&&((0,m.Z)(t.width)||(0,m.Z)(t.height))){let e=this.shadowRoot.findChildrenByName("shadow-rect")[0];e&&e.setAttributes({width:null!=(i=t.width)?i:e.attribute.width,height:null!=(r=t.height)?r:e.attribute.height})}}var v=i(55675);function b(t,e,i,n,l,o,u,d,c,p,g,f,m,v,b,x,C,w){var S,A;let M,k=!1;if((0,a.tI)(e)){if("cell"!==n.scenegraph.highPerformanceGetCell(l,o).role)return M;e=n.getCellValue(l,o),k=!0}if("checkbox"===t&&i.tree)M=h.F.getFunction("createCheckboxCellGroup")(null,p,0,g,l,o,u,d,c,f,m,v,b,n,x,i,C,k,!0);else if("text"===t||"link"===t||w){if("link"===t){let h=e,u=n.getCellOriginValue(l,o),d=n._getCellStyle(l,o);"link"===t&&("templateLink"in i&&i.templateLink||!("linkDetect"in i)||!(0,a.vi)(i.linkDetect,{col:l,row:o,table:n,value:h,dataValue:u,cellHeaderPaths:void 0})||r.tP.test(h))&&(x?(x.text.fill=(0,s.WJ)("linkColor",d,l,o,n),x.group.cursor="pointer"):x={text:{fill:(0,s.WJ)("linkColor",d,l,o,n)},group:{cursor:"pointer"}})}let{customElementsGroup:y,renderDefault:A}=_(n,i,l,o,d,c,f,C,w);M=h.F.getFunction("createTextCellGroup")(n,e,p,0,g,l,o,u,d,c,f,m,v,b,y,A,x,C,k);let T=n.internalProps.layoutMap.getAxisConfigInPivotChart(l,o);if(T){let t=new(h.F.getComponent("axis"))(T,M.attribute.width,M.attribute.height,null!=(S=T.__vtablePadding)?S:f,n);M.clear(),M.appendChild(t.component),t.overlap()}else n.internalProps.layoutMap.isEmpty(l,o)?(M.setAttributes({fill:!1,stroke:!1}),M.clear()):n.internalProps.layoutMap.isAxisCell(l,o)&&M.clear()}else if("image"===t)M=h.F.getFunction("createImageCellGroup")(p,0,g,l,o,d,c,i.keepAspectRatio,i.imageAutoSizing,f,m,v,b,n,x,C,k);else if("video"===t)M=h.F.getFunction("createVideoCellGroup")(p,0,g,l,o,d,c,i.keepAspectRatio,i.imageAutoSizing,f,m,v,b,n,x,C,k);else if("chart"===t){let t=n.internalProps.layoutMap.getChartInstance(l,o);M=h.F.getFunction("createChartCellGroup")(null,p,0,g,l,o,d,c,f,e,i.chartModule,n.internalProps.layoutMap.getChartSpec(l,o),t,null!=(A=n.internalProps.layoutMap.getChartDataId(l,o))?A:"data",n,x,n.internalProps.layoutMap.isShareChartSpec(l,o),k,n.internalProps.layoutMap.isNoChartDataRenderNothing(l,o))}else if("progressbar"===t){let{customElementsGroup:t,renderDefault:r}=_(n,i,l,o,d,c,f,C,w),s=n._getCellStyle(l,o),a=n.getCellOriginValue(l,o);M=h.F.getFunction("createTextCellGroup")(n,e,p,0,g,l,o,u,d,c,f,m,v,b,t,r,x,C,k);let y=h.F.getFunction("createProgressBarCell")(i,s,u,e,a,l,o,f,n,C);M.firstChild?M.insertBefore(y,M.firstChild):M.appendChild(y)}else if("sparkline"===t)M=h.F.getFunction("createSparkLineCellGroup")(null,p,0,g,l,o,d,c,f,n,x,k);else if("checkbox"===t){let t="isAggregation"in n.internalProps.layoutMap&&n.internalProps.layoutMap.isAggregation(l,o),r=n.internalProps.layoutMap.isSeriesNumber(l,o);M=t&&r?h.F.getFunction("createTextCellGroup")(n,e,p,0,g,l,o,u,d,c,f,m,v,!1,void 0,!0,x,C,k):h.F.getFunction("createCheckboxCellGroup")(null,p,0,g,l,o,u,d,c,f,m,v,b,n,x,i,C,k,!1)}else"radio"===t?M=h.F.getFunction("createRadioCellGroup")(null,p,0,g,l,o,u,d,c,f,m,v,n,x,i,C):"switch"===t?M=h.F.getFunction("createSwitchCellGroup")(null,p,0,g,l,o,u,d,c,f,m,v,b,n,x,i,C,k):"button"===t&&(M=h.F.getFunction("createButtonCellGroup")(null,p,0,g,l,o,u,d,c,f,m,v,b,n,x,i,C,k));return M.onBeforeAttributeUpdate=y,M}function _(t,e,i,r,s,l,a,o,h){let u,d=!0;if(h)u=h.elementsGroup,d=h.renderDefault;else if((null==o?void 0:o.isCustom)&&!t.isCornerHeader(i,r));else{let h,c;if("body"!==t.getCellLocation(i,r)?(h=null==e?void 0:e.headerCustomRender,c=null==e?void 0:e.headerCustomLayout):(h=(null==e?void 0:e.customRender)||t.customRender,c=null==e?void 0:e.customLayout),c||h){let e=(0,n.ws)(c,h,i,r,s,l,!1,t.isAutoRowHeight(r),a,o,t);u=e.elementsGroup,d=e.renderDefault}}return{customElementsGroup:u,renderDefault:d}}function x(t,e,i,r,h,p){var g,m,y,b,_,x,M,k,T,R,B,P,E,I,L,F,O,D;let H,z,W,N=i.scenegraph.highPerformanceGetCell(t,e,!0);if("cell"!==N.role&&!r)return;let j=i.getCellLocation(t,e),G,V,Z,U,K=i.getCellValue(t,e),$=!1;if(i.internalProps.customMergeCell){let r=i.getCustomMerge(t,e);if(r){let{range:t,text:s,style:l,customLayout:a,customRender:o}=r;G=(V=t).start.col!==V.end.col||V.start.row!==V.end.row,K=s,Z=l,(a||o)&&(U=(0,n.ws)(a,o,t.start.col,t.start.row,i.getColsWidth(t.start.col,t.end.col),i.getRowsHeight(t.start.row,t.end.row),!1,i.isAutoRowHeight(e),[0,0,0,0],V,i)),$=!0}}let Y=t,X=e;V&&(Y=V.start.col,X=V.start.row);let q="body"!==j?i.getHeaderDefine(Y,X):i.getBodyColumnDefine(Y,X),J="body"!==j||(null==q?void 0:q.dragOrder)||!!(null==q?void 0:q.icon)||!!(null==q?void 0:q.tree);!V&&(i.internalProps.enableTreeNodeMerge||"body"!==j||(null==q?void 0:q.mergeCell))&&(G=(V=i.getCellRange(t,e)).start.col!==V.end.col||V.start.row!==V.end.row);let Q=!1;if(i.internalProps.enableTreeNodeMerge&&G){let r=i.getCellRawRecord(V.start.col,V.start.row),{vtableMergeName:s,vtableMerge:l}=null!=r?r:{};Q=l,l&&(J=!0,i.internalProps.groupTitleCustomLayout&&(U=(0,n.ws)(i.internalProps.groupTitleCustomLayout,void 0,V.start.col,V.start.row,i.getColsWidth(V.start.col,V.end.col),i.getRowsHeight(V.start.row,V.end.row),!1,i.isAutoRowHeight(e),[0,0,0,0],V,i)),i.internalProps.groupTitleFieldFormat?K=i.internalProps.groupTitleFieldFormat(r,t,e,i):void 0!==s&&(K=s))}let te=Z||i._getCellStyle(V?V.start.col:t,V?V.start.row:e),ti=null!=(g=te.autoWrapText)?g:i.internalProps.autoWrapText,tr=(0,l.RT)(te,i,G?V.start.col:t,G?V.start.row:e,s.WJ).theme;if(tr.group.cornerRadius=(0,l.xv)(t,e,i),!r&&!G&&!((null==q?void 0:q.customLayout)||(null==q?void 0:q.customRender)||(null==q?void 0:q.headerCustomLayout)||(null==q?void 0:q.headerCustomRender))&&(p||function(t,e,i,r,n,s){var l;let o=s.getBodyColumnType(t,e),h=s.isAutoRowHeight(e),u=s.getCellValue(t,e);return!(s.isHeader(t,e)||"cell"!==i.role||"text"!==o||r||h||n||"text"!==(null==(l=i.firstChild)?void 0:l.type)||(0,a.tI)(u))}(t,e,N,ti,J,i))){let r=i.getColWidth(t),n=i.getRowHeight(e),l=(0,v.d)(t,e,tr,i);N.setAttributes({width:r,height:n,lineWidth:null!=(y=null==(m=null==tr?void 0:tr.group)?void 0:m.lineWidth)?y:void 0,fill:null!=(_=null==(b=null==tr?void 0:tr.group)?void 0:b.fill)?_:void 0,stroke:null!=(M=null==(x=null==tr?void 0:tr.group)?void 0:x.stroke)?M:void 0,strokeArrayWidth:null!=l?l:void 0,strokeArrayColor:null!=(T=null==(k=null==tr?void 0:tr.group)?void 0:k.strokeArrayColor)?T:void 0,cursor:null!=(B=null==(R=null==tr?void 0:tr.group)?void 0:R.cursor)?B:void 0,cornerRadius:null!=(E=null==(P=null==tr?void 0:tr.group)?void 0:P.cornerRadius)?E:0,lineDash:null!=(L=null==(I=null==tr?void 0:tr.group)?void 0:I.lineDash)?L:void 0,y:i.scenegraph.getCellGroupY(e)}),N.mergeStartCol=void 0,N.mergeStartRow=void 0,N.mergeEndCol=void 0,N.mergeEndRow=void 0,N.forEachChildren(t=>{t.setAttributes({dx:0,dy:0})});let a=N.getChildByName("text");if(p&&a){let r=tr.text.textAlign,n=(0,u.L)(t,e,i),s={textBaseline:"top",dx:"left"===r?n:0};a.setAttributes(tr.text?Object.assign({},tr.text,s):s)}else if(a){let l=i.getCellValue(t,e),{text:o,moreThanMaxCharacters:h}=(0,f.$)(l,i),c=(0,u.L)(t,e,i),p=te.lineClamp,g=null!=(F=(0,d.u)((0,s.WJ)("padding",te,t,e,i)))?F:[0,0,0,0],m=tr.text.textAlign,y=0;y="center"===m?g[3]+(r-(g[1]+g[3]))/2:"right"===m?g[3]+r-(g[1]+g[3]):g[3];let v={text:1!==o.length||ti?o:o[0],moreThanMaxCharacters:h,maxLineWidth:r-(g[1]+g[3]+c),textBaseline:"top",autoWrapText:ti,lineClamp:p,wordBreak:"break-word",heightLimit:n-Math.floor(g[0]+g[2]),pickable:!1,dx:"left"===m?c:0,x:y};if(a.setAttributes(tr.text?Object.assign({},tr.text,v):v),a.attribute.text){let t=tr.text.textBaseline,e=n-(g[0]+g[2]),i=0;i="middle"===t?g[0]+(e-a.AABBBounds.height())/2:"bottom"===t?g[0]+e-a.AABBBounds.height():g[0],a.setAttributes({y:i})}}return N}if(!r&&"empty"===N.role)return;let tn=Q||$?"text":i.isHeader(t,e)?null!=(O=i._getHeaderLayoutMap(t,e).headerType)?O:"text":null!=(D=i.getBodyColumnType(t,e))?D:"text",ts=tr._vtable.padding,tl=tr.text.textAlign,ta=tr.text.textBaseline;if(V?(z=i.getColsWidth(V.start.col,V.end.col),W=i.getRowsHeight(V.start.row,V.end.row)):(z=i.getColWidth(t),W=i.getRowHeight(e)),(0,a.tI)(K)?(N.removeAllChild(),(0,o.K)(K,i,w.bind(null,{type:tn,value:K,define:q,table:i,col:t,row:e,cellWidth:z,cellHeight:W,oldCellGroup:N,padding:ts,textAlign:tl,textBaseline:ta,mayHaveIcon:J,addNew:r,range:V,customResult:U,customStyle:Z}))):H=C(tn,K,q,i,t,e,z,W,N,ts,tl,ta,J,r,tr,V,U),G){let{width:t}=H.attribute,{height:e}=H.attribute;H.contentWidth=t,H.contentHeight=e,h?function(t,e,i,r,n,s,l,a){let{col:o,row:h}=a;t.start.row!==t.end.row&&a.contentHeight!==i&&(0,c.Zl)(a,i,i,l.isAutoRowHeight(h),r,n,s,l),t.start.col!==t.end.col&&a.contentWidth!==e&&(0,c.qs)(a,e,i,0,l.isAutoRowHeight(h),r,n,s,l.scenegraph),a.contentWidth=e,a.contentHeight=i;let u=l.getRowHeight(h);A(a,l.getColWidth(o),u,t,l)}(V,z,W,ts,tl,ta,i,H):S(V,z,W,ts,tl,ta,i)}return H}function C(t,e,i,r,n,s,l,o,h,u,d,c,g,f,m,y,v){var _,x;if((0,a.tI)(e)&&(e=r.getCellValue(n,s)),!f&&(h.row!==s||h.col!==n))return null;if(!f&&h.parent&&r.reactCustomLayout){let t=h.getChildByName("custom-container");if(t){let{col:e,row:i}=t;(0,p.Z)(e)&&(0,p.Z)(i)&&r.reactCustomLayout.removeCustomCell(e,i)}}let C=b(t,e,i,r,n,s,r.getColWidth(n),l,o,f?r.scenegraph.getColGroup(n):h.parent,f?0:r.scenegraph.getCellGroupY(s),u,d,c,g,m,y,v);return!f&&h.parent&&(h.parent.insertAfter(C,h),h.parent.removeChild(h),h.release(!0),(null==(_=r.scenegraph)?void 0:_.proxy.cellCache.get(n))&&(null==(x=r.scenegraph)||x.proxy.cellCache.set(n,C))),C}function w(t){let{type:e,value:i,define:r,table:n,col:a,row:o,cellWidth:h,cellHeight:u,oldCellGroup:d,padding:c,textAlign:p,textBaseline:g,mayHaveIcon:f,addNew:m,range:y,customResult:v,customStyle:b}=t,_=b||n._getCellStyle(y?y.start.col:a,y?y.start.row:o),x=(0,l.RT)(_,n,y?y.start.col:a,y?y.start.row:o,s.WJ).theme;x.group.cornerRadius=(0,l.xv)(a,o,n),C(e,i,r,n,a,o,h,u,d,c,p,g,f,m,x,y,v)}function S(t,e,i,r,n,s,l){for(let a=t.start.col;a<=t.end.col;a++)for(let o=t.start.row;o<=t.end.row;o++){let h=l.scenegraph.highPerformanceGetCell(a,o,!0);if("cell"!==h.role)continue;t.start.row!==t.end.row&&h.contentHeight!==i&&(0,c.Zl)(h,i,i,l.isAutoRowHeight(o),r,n,s,l),t.start.col!==t.end.col&&h.contentWidth!==e&&(0,c.qs)(h,e,i,0,l.isAutoRowHeight(o),r,n,s,l.scenegraph),h.contentWidth=e,h.contentHeight=i;let u=l.getRowHeight(o);A(h,l.getColWidth(a),u,t,l)}}function A(t,e,i,r,n){var s,l;let{col:a,row:o}=t,h=-n.getColsWidth(r.start.col,a-1),u=0;if(null==(s=n.options.customConfig)?void 0:s._disableColumnAndRowSizeRound)for(let t=r.start.row;t<=o-1;t++)u-=n.getRowHeight(t);else u=-n.getRowsHeight(r.start.row,o-1);t.forEachChildren(t=>{var e,i,r,n,s,l;"number"==typeof t._dx?(t.skipMergeUpdate=!0,t.setAttributes({dx:(null!=(e=t._dx)?e:0)+h})):(t._dx=null!=(i=t.attribute.dx)?i:0,t.skipMergeUpdate=!0,t.setAttributes({dx:(null!=(r=t.attribute.dx)?r:0)+h})),t.skipMergeUpdate=!1,"number"==typeof t._dy?(t.skipMergeUpdate=!0,t.setAttributes({dy:(null!=(n=t._dy)?n:0)+u})):(t._dy=null!=(s=t.attribute.dy)?s:0,t.skipMergeUpdate=!0,t.setAttributes({dy:(null!=(l=t.attribute.dy)?l:0)+u})),t.skipMergeUpdate=!1});let d=null!=(l=t.attribute.strokeArrayWidth)?l:t.attribute.lineWidth,c=(0,g.Z)(d),p=[0,0,0,0];a===r.start.col&&(p[3]=c?d[3]:d),o===r.start.row&&(p[0]=c?d[0]:d),a===r.end.col&&(p[1]=c?d[1]:d),o===r.end.row&&(p[2]=c?d[2]:d);let f=e!==t.attribute.width,m=i!==t.attribute.height;return t.skipMergeUpdate=!0,t.setAttributes({width:e,height:i,strokeArrayWidth:p}),t.skipMergeUpdate=!1,t.mergeStartCol=r.start.col,t.mergeStartRow=r.start.row,t.mergeEndCol=r.end.col,t.mergeEndRow=r.end.row,{widthChange:f,heightChange:m}}function M(t,e,i,r){if(r.internalProps.customMergeCell){let s=r.getCustomMerge(t,e);if(s){let{range:l,text:a,style:o,customLayout:h,customRender:u}=s;if(h||u){let s=(0,n.ws)(h,u,l.start.col,l.start.row,r.getColsWidth(l.start.col,l.end.col),r.getRowsHeight(l.start.row,l.end.row),!1,r.isAutoRowHeight(e),[0,0,0,0],l,r).elementsGroup;i.childrenCount>0&&s?i.insertBefore(s,i.firstChild):s&&i.appendChild(s);let a=r.getRowHeight(e),o=r.getColWidth(t),{width:d}=i.attribute,{height:c}=i.attribute;return i.contentWidth=d,i.contentHeight=c,A(i,o,a,l,r),l}}}}},46312:function(t,e,i){"use strict";i.d(e,{Gb:()=>y,LP:()=>g,SI:()=>m,Ui:()=>p,km:()=>f});var r=i(77474),n=i(70107),s=i(26771),l=i(9727),a=i(35137),o=i(67203),h=i(18585),u=i(14828),d=i(55675),c=i(40793);function p(t,e,i,l,a,p,g,m,y,b,_,x,C,w,S,A,M){var k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X,q,J,Q,te,ti,tr;let tn,ts,tl=w._getCellStyle(l,a),ta=(0,o.vp)("padding",tl,l,a,w);(null==(k=w.options.customConfig)?void 0:k.imageMargin)?b=(0,u.u)(null==(T=w.options.customConfig)?void 0:T.imageMargin):(0,h.Z)(ta)&&(b=ta),(null==(R=null==S?void 0:S.text)?void 0:R.textAlign)&&(_=null==(B=null==S?void 0:S.text)?void 0:B.textAlign),(null==(P=null==S?void 0:S.text)?void 0:P.textBaseline)&&(x=null==(E=null==S?void 0:S.text)?void 0:E.textBaseline);let to=(0,d.d)(l,a,S,w);if(M&&(tn=w.scenegraph.highPerformanceGetCell(l,a,!0))&&"cell"===tn.role&&tn.setAttributes({x:e,y:i,width:p,height:g,lineWidth:null!=(L=null==(I=null==S?void 0:S.group)?void 0:I.lineWidth)?L:void 0,fill:null!=(O=null==(F=null==S?void 0:S.group)?void 0:F.fill)?O:void 0,stroke:null!=(H=null==(D=null==S?void 0:S.group)?void 0:D.stroke)?H:void 0,strokeArrayWidth:null!=to?to:void 0,strokeArrayColor:null!=(W=null==(z=null==S?void 0:S.group)?void 0:z.strokeArrayColor)?W:void 0,cursor:null!=(j=null==(N=null==S?void 0:S.group)?void 0:N.cursor)?j:void 0,lineDash:null!=(V=null==(G=null==S?void 0:S.group)?void 0:G.lineDash)?V:void 0,lineCap:"butt",clip:!0,cornerRadius:S.group.cornerRadius}),tn&&"cell"===tn.role||((tn=new s.Z({x:e,y:i,width:p,height:g,lineWidth:null!=(U=null==(Z=null==S?void 0:S.group)?void 0:Z.lineWidth)?U:void 0,fill:null!=($=null==(K=null==S?void 0:S.group)?void 0:K.fill)?$:void 0,stroke:null!=(X=null==(Y=null==S?void 0:S.group)?void 0:Y.stroke)?X:void 0,strokeArrayWidth:null!=to?to:void 0,strokeArrayColor:null!=(J=null==(q=null==S?void 0:S.group)?void 0:q.strokeArrayColor)?J:void 0,cursor:null!=(te=null==(Q=null==S?void 0:S.group)?void 0:Q.cursor)?te:void 0,lineDash:null!=(tr=null==(ti=null==S?void 0:S.group)?void 0:ti.lineDash)?tr:void 0,lineCap:"butt",clip:!0,cornerRadius:S.group.cornerRadius})).role="cell",tn.col=l,tn.row=a,null==t||t.addCellGroup(tn)),C){let t=l,e=a;A&&(t=A.start.col,e=A.start.row),ts=w.getCellIcons(t,e)}let th=0,tu=0,td=0;if(Array.isArray(ts)&&0!==ts.length){let{leftIconWidth:t,rightIconWidth:e,absoluteLeftIconWidth:i,absoluteRightIconWidth:r}=(0,c.M4)(ts,tn,A,w);th=t+e,tu=t,td=e,tn.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+b[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+p-e-b[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+p-r-b[1])}),tn.forEachChildren(t=>{"middle"===x?t.setAttribute("y",(g-t.AABBBounds.height())/2):"bottom"===x?t.setAttribute("y",g-t.AABBBounds.height()-b[2]):t.setAttribute("y",b[0])}),tn._cellLeftIconWidth=tu,tn._cellRightIconWidth=td}let tc=w.getCellValue(l,a),tp=(0,r.B)({x:b[3],y:b[0],width:p-b[1]-b[3]-th,height:g-b[0]-b[2],image:tc,cursor:"pointer"});return tp.name="image",tp.keepAspectRatio=m,tp.textAlign=_,tp.textBaseline=x,m||y?tp.resources&&tp.resources.has(tp.attribute.image)&&"success"===tp.resources.get(tp.attribute.image).state?(tp.setAttribute("opacity",0),setTimeout(()=>{tp.setAttribute("opacity",1),v(y,m,b,_,x,tp,tn,w),w.scenegraph.updateNextFrame()},0)):tp.successCallback=()=>{v(y,m,b,_,x,tp,tn,w),w.scenegraph.updateNextFrame()}:tp.resources&&tp.resources.has(tp.attribute.image)&&"success"===tp.resources.get(tp.attribute.image).state?f(tn,l,a,0,0,w):tp.successCallback=()=>{f(tn,l,a,0,0,w)},tp.failCallback=()=>{tp.image=n.U2().damage_pic.svg},tn.appendChild(tp),tn}function g(t,e,i,r,n,s,l){let a=!1,o=null,h=null,{width:u,height:d,isMerge:c}=m(l,n.table);if(u<i+s[1]+s[3]&&(o=i+s[1]+s[3],a=!0),d<r+s[2]+s[0]&&(h=r+s[2]+s[0],a=!0),a){if("number"==typeof o)if(c)for(let t=l.mergeStartCol;t<=l.mergeEndCol;t++)n.setColWidth(t,o/(l.mergeEndCol-l.mergeStartCol+1));else n.setColWidth(t,o);if("number"==typeof h)if(c)for(let t=l.mergeStartRow;t<=l.mergeEndRow;t++)n.setRowHeight(t,h/(l.mergeEndRow-l.mergeStartRow+1));else n.setRowHeight(e,h);return n.component.updateScrollBar(),!0}return!1}function f(t,e,i,r,n,s){var h,d,c,p,g,f,v,b,_,x,C,w;let S,A=t.getChildByName("image");if(!A)return;let M="string"!=typeof A.attribute.image&&A.attribute.image||(null==(h=A.resources)?void 0:h.get(A.attribute.image).data);if(!M)return;let k=s._getCellStyle(e,i),T=null!=(d=(0,o.WJ)("textAlign",k,e,i,s))?d:"left",R=null!=(c=(0,o.WJ)("textBaseline",k,e,i,s))?c:"middle";S=(null==(p=s.options.customConfig)?void 0:p.imageMargin)?(0,u.u)(null==(g=s.options.customConfig)?void 0:g.imageMargin):null!=(f=(0,u.u)((0,o.WJ)("padding",k,e,i,s)))?f:[0,0,0,0];let{width:B,height:P,isMerge:E}=m(t,s),I=null!=(v=t.mergeStartCol)?v:t.col,L=null!=(b=t.mergeStartRow)?b:t.row,F=null!=(_=t.mergeEndCol)?_:t.col,O=null!=(x=t.mergeEndCol)?x:t.row,D=null!=(C=t._cellLeftIconWidth)?C:0,H=null!=(w=t._cellRightIconWidth)?w:0;if(A.keepAspectRatio){let{width:t,height:e}=(0,l.f)(M.width||M.videoWidth,M.height||M.videoHeight,B-(S[1]+S[3]),P-(S[0]+S[2])),i=(0,a.W)(0,0,B,P,t,e,T,R,S);for(let r=I;r<=F;r++)for(let n=L;n<=O;n++){let l=s.scenegraph.getCell(r,n).getChildByName("image");null==l||l.setAttributes({x:i.x,y:i.y,width:t,height:e})}}else for(let t=I;t<=F;t++)for(let e=L;e<=O;e++){let i=s.scenegraph.getCell(t,e).getChildByName("image");null==i||i.setAttributes({x:D+S[3],y:S[0],width:B-S[1]-S[3]-H-D,height:P-S[0]-S[2]})}if(t.getChildByName("play-icon")){let{width:e,height:i}=m(t,s),r=Math.floor(Math.min(e-S[1]-S[3],i-S[2]-S[0])/2),n=0+(e>A.attribute.width?A.attribute.x-0+A.attribute.width/2:e/2),l=0+(i>A.attribute.height?A.attribute.y-0+A.attribute.height/2:i/2);for(let t=I;t<=F;t++)for(let e=L;e<=O;e++)s.scenegraph.getCell(t,e).getChildByName("play-icon").setAttributes({x:n-r/2,y:l-r/2,width:r,height:r})}t.forEachChildren(t=>{"icon-left"===t.role||("icon-right"===t.role||"icon-absolute-right"===t.role)&&t.setAttribute("x",t.attribute.x+r)}),t.forEachChildren(t=>{("rect"===t.type||t.role&&t.role.startsWith("icon"))&&("middle"===R?t.setAttribute("y",S[0]+(P-S[0]-S[2]-t.AABBBounds.height())/2):"bottom"===R?t.setAttribute("y",S[0]+P-S[0]-S[2]-t.AABBBounds.height()):t.setAttribute("y",S[0]))}),E&&y(t.mergeStartCol,t.mergeEndCol,t.mergeStartRow,t.mergeEndRow,s)}function m(t,e){return"cell"===t.role&&(0,h.Z)(t.mergeStartCol)&&(0,h.Z)(t.mergeEndCol)&&(0,h.Z)(t.mergeStartRow)&&(0,h.Z)(t.mergeEndRow)?{width:e.getColsWidth(t.mergeStartCol,t.mergeEndCol),height:e.getRowsHeight(t.mergeStartRow,t.mergeEndRow),isMerge:!0}:{width:t.attribute.width,height:t.attribute.height,isMerge:!1}}function y(t,e,i,r,n){for(let s=t;s<=e;s++)for(let t=i;t<=r;t++){let e=n.scenegraph.getCell(s,t);if(e){let i=e.getChildByName("image");i&&i.setAttributes({dx:-n.getColsWidth(e.mergeStartCol,s-1),dy:-n.getRowsHeight(e.mergeStartRow,t-1)});let r=e.getChildByName("play-icon");r&&r.setAttributes({dx:-n.getColsWidth(e.mergeStartCol,s-1),dy:-n.getRowsHeight(e.mergeStartRow,t-1)})}}}function v(t,e,i,r,n,s,o,h){let u=s.resources.get(s.attribute.image).data,{col:d,row:c}=o;if(t&&!b(s)&&g(d,c,u.width,u.height,h.scenegraph,i,o),e||b(s)){let{width:t,height:e,isMerge:d}=m(o,h),{width:c,height:p}=(0,l.f)(u.width,u.height,t-i[1]-i[3],e-i[0]-i[2]),g=(0,a.W)(0,0,t,e,c,p,r,n,i);s.setAttributes({x:g.x,y:g.y,width:c,height:p}),d&&y(o.mergeStartCol,o.mergeEndCol,o.mergeStartRow,o.mergeEndRow,h)}}function b(t){let e=n.U2();return t.attribute.image===e.damage_pic.svg}},26364:function(t,e,i){"use strict";i.d(e,{LQ:()=>tv,dB:()=>tA,ge:()=>tM,ah:()=>tS,Jy:()=>tC,yR:()=>tb,pk:()=>t_,VT:()=>tw,au:()=>tk,m4:()=>tx});var r=i(13844),n=i(26771),s=i(55634),l=i(43894),a=i(67203),o=i(18585),h=i(55675);function u(t,e,i,r,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S){var A,M,k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X;let q=l.U()[m],J=_._getCellStyle(u,d),Q=(0,a.vp)("padding",J,u,d,_);if((0,o.Z)(Q)&&(g=Q),!t){let s=(0,h.d)(u,d,x,_);w&&(t=_.scenegraph.highPerformanceGetCell(u,d,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:c,height:p,lineWidth:null!=(M=null==(A=null==x?void 0:x.group)?void 0:A.lineWidth)?M:void 0,fill:null!=(T=null==(k=null==x?void 0:x.group)?void 0:k.fill)?T:void 0,stroke:null!=(B=null==(R=null==x?void 0:x.group)?void 0:R.stroke)?B:void 0,strokeArrayWidth:s,strokeArrayColor:null!=(E=null==(P=null==x?void 0:x.group)?void 0:P.strokeArrayColor)?E:void 0,cursor:null!=(L=null==(I=null==x?void 0:x.group)?void 0:I.cursor)?L:void 0,lineDash:null!=(O=null==(F=null==x?void 0:x.group)?void 0:F.lineDash)?O:void 0,lineCap:"butt",clip:!0,cornerRadius:x.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:c,height:p,lineWidth:null!=(H=null==(D=null==x?void 0:x.group)?void 0:D.lineWidth)?H:void 0,fill:null!=(W=null==(z=null==x?void 0:x.group)?void 0:z.fill)?W:void 0,stroke:null!=(j=null==(N=null==x?void 0:x.group)?void 0:N.stroke)?j:void 0,strokeArrayWidth:s,strokeArrayColor:null!=(V=null==(G=null==x?void 0:x.group)?void 0:G.strokeArrayColor)?V:void 0,cursor:null!=(U=null==(Z=null==x?void 0:x.group)?void 0:Z.cursor)?U:void 0,lineDash:null!=($=null==(K=null==x?void 0:x.group)?void 0:K.lineDash)?$:void 0,lineCap:"butt",clip:!0,cornerRadius:x.group.cornerRadius})).role="cell",t.col=u,t.row=d,null==e||e.addCellGroup(t))}if(t.AABBBounds.width(),S&&Array.isArray(_.getCellValue(u,d))||!S){let e=new s.k(C,{stroke:!1,x:g[3],y:g[0],canvas:null!=(Y=_.canvas)?Y:_.scenegraph.stage.window.getContext().canvas,mode:_.options.mode,modeParams:_.options.modeParams,spec:_.options.specTransformInCell?_.options.specTransformInCell(y,u,d):y,ClassType:q,width:c-g[3]-g[1],height:p-g[2]-g[0],chartInstance:v,dataId:b,data:_.getCellValue(u,d)||[],cellPadding:g,dpr:_.internalProps.pixelRatio,detectPickChartItem:null==(X=_.options.customConfig)?void 0:X.detectPickChartItem,axes:_.isPivotChart()?_.internalProps.layoutMap.getChartAxes(u,d):[],tableChartOption:_.options.chartOption,col:u,row:d});t.appendChild(e),_.internalProps.layoutMap.setChartInstance(u,d,e.chartInstance)}return t}var d=i(44186),c=i(47e3),p=i(29539),g=i(52186),f=i(57657),m=i(40793);class y extends n.Z{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new n.Z({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new n.Z({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._checkboxGroup=new n.Z({pickable:!1,fill:!1,stroke:!1}),this._checkboxGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._checkboxGroup)}addLeftOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._leftGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth((null!=(i=t.attribute.marginLeft)?i:0)+(null!=(r=t.attribute.marginRight)?r:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._rightGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth((null!=(i=t.attribute.marginLeft)?i:0)+(null!=(r=t.attribute.marginRight)?r:0)+t.attribute.width)}addCheckbox(t){this._checkboxGroup.appendChild(t)}setCheckboxContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){let i=this._checkboxGroup.width;this._cellWidth=t+e+i,this.setAttribute("width",this._cellWidth)}else{let i=this._cellWidth-t-e;this.updateCenterLayout(i);let r=this._checkboxGroup.width;this._cellWidth=t+e+r,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();let i=this._leftGroup.height,r=this._rightGroup.height,n=this._checkboxGroup.height;this._cellHeight=Math.max(i,r,n),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._checkboxGroup.forEachChildren(t=>{t instanceof p.J&&(e-=t.AABBBounds.width())});let i=this._checkboxGroup.getChildByName("checkbox-content");i instanceof p.J&&i.setAttribute("width",e);let r=0;this._checkboxGroup.forEachChildren(t=>{t.setAttribute("x",r),r+=t.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._checkboxGroup.setAttribute("x",4),"left"===this._align||"start"===this._align?this.setAttribute("dx",0):"center"===this._align?this.setAttribute("dx",-this.attribute.width/2):"right"!==this._align&&"end"!==this._align||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){"top"===this._baseline?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._checkboxGroup.setAttribute("y",0)):"middle"===this._baseline?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._checkboxGroup.setAttribute("y",this._cellHeight/2-this._checkboxGroup.height/2)):"bottom"===this._baseline&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._checkboxGroup.setAttribute("y",this._cellHeight-this._checkboxGroup.height))}}var v=i(76349);function b(t,e,i,r,s,l,o,u,b,_,x,C,w,S,A,M,k,T,R){var B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X,q,J,Q;let te;if(!t){let a=(0,h.d)(s,l,A,S);T&&(t=S.scenegraph.highPerformanceGetCell(s,l,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:u,height:b,lineWidth:null!=(P=null==(B=null==A?void 0:A.group)?void 0:B.lineWidth)?P:void 0,fill:null!=(I=null==(E=null==A?void 0:A.group)?void 0:E.fill)?I:void 0,stroke:null!=(F=null==(L=null==A?void 0:A.group)?void 0:L.stroke)?F:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(D=null==(O=null==A?void 0:A.group)?void 0:O.strokeArrayColor)?D:void 0,cursor:null!=(z=null==(H=null==A?void 0:A.group)?void 0:H.cursor)?z:void 0,lineDash:null!=(N=null==(W=null==A?void 0:A.group)?void 0:W.lineDash)?N:void 0,lineCap:"butt",clip:!0,cornerRadius:A.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:u,height:b,lineWidth:null!=(G=null==(j=null==A?void 0:A.group)?void 0:j.lineWidth)?G:void 0,fill:null!=(Z=null==(V=null==A?void 0:A.group)?void 0:V.fill)?Z:void 0,stroke:null!=(K=null==(U=null==A?void 0:A.group)?void 0:U.stroke)?K:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(Y=null==($=null==A?void 0:A.group)?void 0:$.strokeArrayColor)?Y:void 0,cursor:null!=(q=null==(X=null==A?void 0:A.group)?void 0:X.cursor)?q:void 0,lineDash:null!=(Q=null==(J=null==A?void 0:A.group)?void 0:J.lineDash)?Q:void 0,lineCap:"butt",clip:!0,cornerRadius:A.group.cornerRadius})).role="cell",t.col=s,t.row=l,null==e||e.addCellGroup(t))}if(w){let t=s,e=l;k&&(t=k.start.col,e=k.start.row),te=S.getCellIcons(t,e)}let ti=0,tr=0,tn=0,ts=0,tl=[];if(Array.isArray(te)&&0!==te.length){let{leftIconWidth:e,rightIconWidth:i,contentLeftIcons:r,contentRightIcons:n,absoluteLeftIconWidth:s,absoluteRightIconWidth:l}=(0,m.M4)(te,t,k,S);ti=e+i,tr=e,tn=i,tl=r,ts=l,t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+_[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+u-i-_[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+u-l-_[1])}),t.forEachChildren(t=>{"middle"===C?t.setAttribute("y",(b-t.AABBBounds.height())/2):"bottom"===C?t.setAttribute("y",b-t.AABBBounds.height()-_[2]):t.setAttribute("y",_[0])})}let ta=function(t,e,i,r,n,s,l,o,h,u){var d,m,y;let v=h._getCellStyle(t,e),b=(0,a.WJ)("size",v,t,e,h),_=(0,a.WJ)("spaceBetweenTextAndIcon",v,t,e,h),x=(0,a.WJ)("defaultFill",v,t,e,h),C=(0,a.WJ)("defaultStroke",v,t,e,h),w=(0,a.WJ)("disableFill",v,t,e,h),S=(0,a.WJ)("checkedFill",v,t,e,h),A=(0,a.WJ)("checkedStroke",v,t,e,h),M=(0,a.WJ)("disableCheckedFill",v,t,e,h),k=(0,a.WJ)("disableCheckedStroke",v,t,e,h),T=(0,a.WJ)("checkIconImage",v,t,e,h),R=(0,a.WJ)("indeterminateIconImage",v,t,e,h),B=h.getCellValue(t,e),P=h.getCellOriginValue(t,e),E,I,L=null!=B?B:"";if((0,c.Z)(B)?(E=B.checked,I=B.disable,L=null!=(d=B.text)?d:""):"boolean"==typeof B&&(E=B,L=""),h.internalProps.layoutMap.isSeriesNumber(t,e)){let i=h.getFieldData(o.field,t,e);i&&("string"==typeof i||("object"==typeof i?(E=i.checked,I=i.disable):"boolean"==typeof i&&(E=i)))}E=h.stateManager.syncCheckedState(t,e,o.field,E);let F=(0,g.L)(t,e,h),O=h._getCellStyle(t,e),D=null!=(m=O.autoWrapText)?m:h.internalProps.autoWrapText,{lineClamp:H}=O,{checked:z,disable:W}=o;if(null==E||"function"==typeof E){let i=(0,f.vi)(z,{col:t,row:e,table:h,context:null,value:B,dataValue:P});E=h.stateManager.syncCheckedState(t,e,o.field,i)}let N=(0,f.vi)(W,{col:t,row:e,table:h,context:null,value:B,dataValue:P}),j=h.isAutoRowHeight(e),G={text:1===L.length?L[0]:L,maxLineWidth:"auto"===i?1/0:r-(s[1]+s[3]+F)-b-_,textAlign:"left",textBaseline:"top",autoWrapText:D,lineClamp:H,wordBreak:"break-word",heightLimit:j?-1:n-Math.floor(s[0]+s[2]),pickable:!1,dx:u?0:F,whiteSpace:1!==L.length||D?"normal":"no-wrap"},V={x:0,y:0,text:l.text?Object.assign({},l.text,G):G,icon:{width:Math.floor(b/1.4),height:Math.floor(b/1.4)},box:{width:b,height:b},dx:u?F:0,spaceBetweenTextAndIcon:_,disabled:null!=(y=null!=I?I:N)&&y};"indeterminate"===E?(V.checked=void 0,V.indeterminate=!0):(V.checked=E,V.indeterminate=void 0),x&&(V.box.fill=x),C&&(V.box.stroke=C),w&&(V.box.disableFill=w),S&&(V.box.checkedFill=S),A&&(V.box.checkedStroke=A),M&&(V.box.disableCheckedFill=M),k&&(V.box.disableCheckedStroke=k),T&&(V.icon.checkIconImage=T),R&&(V.icon.indeterminateIconImage=R);let Z=new p.J(V);return Z.name="checkbox",Z}(s,l,o-ti,u,b,_,A,M,S,R);if(1!==tl.length||tl[0].name!==d.up.expandIconName&&tl[0].name!==d.up.collapseIconName)ta&&t.appendChild(ta),ta.render();else{let e=new y({x:0,y:0,fill:!1,stroke:!1,pickable:!1});e.name="checkbox-content",e.setCheckboxContentOption({autoWidth:!1,autoHeight:!1,cellWidth:u-(_[1]+_[3]),cellHeight:b-_[0]-_[2],align:x,baseline:C});let i={addedHierarchyOffset:0};tl.forEach(r=>{let n=(0,m.Bg)(r,void 0,t.col,t.row,k,S,i);n.role="icon-content-left",n.name=r.name,e.addLeftOccupyingIcon(n)}),ta&&e.addCheckbox(ta),t.appendChild(e),e.layout(),e.AABBBounds.width(),e.AABBBounds.height();let r=u-(_[1]+_[3]),n=b-(_[0]+_[2]);t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+_[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+r-tn+_[3]):"icon-absolute-right"===t.role?t.setAttribute("x",t.attribute.x+r-ts+_[3]+_[1]):"content"!==t.name&&"checkbox-content"!==t.name||("center"===x&&"richtext"!==t.type?t.setAttribute("x",_[3]+tr+(r-tr-tn)/2):"right"===x&&"richtext"!==t.type?t.setAttribute("x",_[3]+r-tn):t.setAttribute("x",_[3]+tr))}),t.forEachChildren(t=>{t.name!==v.FH&&("middle"===C?(null==t?void 0:t._checkboxGroup)&&t._leftGroup.setAttribute("y",_[0]+(n-t._checkboxGroup.AABBBounds.height())/2):"bottom"===C?t.setAttribute("y",_[0]+n-t.AABBBounds.height()):t.setAttribute("y",_[0]))})}return u-=_[1]+_[3]+ti,b-=_[0]+_[2],"center"===x?ta.setAttribute("x",_[3]+tr+(u-ta.AABBBounds.width())/2):"right"===x?ta.setAttribute("x",_[3]+tr+u-ta.AABBBounds.width()):ta.setAttribute("x",_[3]+tr),"middle"===C?ta.setAttribute("y",_[0]+(b-ta.AABBBounds.height())/2):"bottom"===C?ta.setAttribute("y",_[0]+b-ta.AABBBounds.height()):ta.setAttribute("y",_[0]),t}var _=i(46312),x=i(58977),C=i(43735),w=i(47105),S=i(91212),A=i(42857);function M(t,e,i,r,s,l,o,u,d,c,p,f,m,y,v,b){var _,w,S,A,M,T,R,B,P,E,I,L;if(!t){let a=(0,h.d)(s,l,y,m);(t=new n.Z({x:i,y:r,width:u,height:d,lineWidth:null!=(w=null==(_=null==y?void 0:y.group)?void 0:_.lineWidth)?w:void 0,fill:null!=(A=null==(S=null==y?void 0:y.group)?void 0:S.fill)?A:void 0,stroke:null!=(T=null==(M=null==y?void 0:y.group)?void 0:M.stroke)?T:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(B=null==(R=null==y?void 0:y.group)?void 0:R.strokeArrayColor)?B:void 0,cursor:null!=(E=null==(P=null==y?void 0:y.group)?void 0:P.cursor)?E:void 0,lineDash:null!=(L=null==(I=null==y?void 0:y.group)?void 0:I.lineDash)?L:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius})).role="cell",t.col=s,t.row=l,null==e||e.addCellGroup(t)}let{width:F,height:O}=function(t,e,i,r,n,s,l,o,h,u,d){var c,p,f,m;let y=d._getCellStyle(t,e),v=(0,a.WJ)("size",y,t,e,d),b=(0,a.WJ)("innerRadius",y,t,e,d),_=(0,a.WJ)("outerRadius",y,t,e,d),w=(0,a.WJ)("spaceBetweenTextAndIcon",y,t,e,d),S=(0,a.WJ)("spaceBetweenRadio",y,t,e,d),A=(0,a.WJ)("defaultFill",y,t,e,d),M=(0,a.WJ)("defaultStroke",y,t,e,d),T=(0,a.WJ)("disableFill",y,t,e,d),R=(0,a.WJ)("checkedFill",y,t,e,d),B=(0,a.WJ)("checkedStroke",y,t,e,d),P=(0,a.WJ)("disableCheckedFill",y,t,e,d),E=(0,a.WJ)("disableCheckedStroke",y,t,e,d);(0,x.Z)(_)?v=2*_:_=Math.round(v/2),(!(0,x.Z)(b)||b<0)&&(b=Math.round(_/7*3));let I=d.getCellValue(t,e),L=d.getCellOriginValue(t,e),F=(0,g.L)(t,e,d),O=d._getCellStyle(t,e),D=null!=(c=O.autoWrapText)?c:d.internalProps.autoWrapText,{lineClamp:H}=O,z=d.isAutoRowHeight(e),W={maxLineWidth:"auto"===i?1/0:r-(s[1]+s[3]+F)-v-w,textAlign:"left",textBaseline:"top",autoWrapText:D,lineClamp:H,wordBreak:"break-word",heightLimit:z?-1:n-Math.floor(s[0]+s[2]),pickable:!1,dx:F},N={x:0,y:0,text:l.text?Object.assign({},l.text,W):W,circle:{innerRadius:b,outerRadius:_},spaceBetweenTextAndIcon:w};A&&(N.circle.fill=A),M&&(N.circle.stroke=M),T&&(N.circle.disableFill=T),R&&(N.circle.checkedFill=R),B&&(N.circle.checkedStroke=B),P&&(N.circle.disableCheckedFill=P),E&&(N.circle.disableCheckedStroke=E);let j=0,G=0,V=null!=(p=o.radioDirectionInCell)?p:"vertical";if((0,C.Z)(I))I.forEach((i,r)=>{var n,s;let l=k(i,L,r,t,e,o,D,N,d);l&&h.appendChild(l),l.id=`radio-${null!=(n=null==u?void 0:u.start.col)?n:t}-${null!=(s=null==u?void 0:u.start.row)?s:e}-${r}`,l.render();let a=l.AABBBounds;"vertical"===V?(l.setAttribute("y",G),G+=a.height()+(r!==I.length-1?S:0),j=Math.max(j,a.width())):"horizontal"===V&&(l.setAttribute("x",j),j+=a.width()+(r!==I.length-1?S:0),G=Math.max(G,a.height()))});else{let i=k(I,L,void 0,t,e,o,D,N,d);i&&h.appendChild(i),i.id=`radio-${null!=(f=null==u?void 0:u.start.col)?f:t}-${null!=(m=null==u?void 0:u.start.row)?m:e}`,i.render();let r=i.AABBBounds;j=r.width(),G=r.height()}return{width:j,height:G}}(s,l,o,u,d,c,y,v,t,b,m);return u-=c[1]+c[3],d-=c[0]+c[2],t.forEachChildren(t=>{"center"===p?t.setAttribute("x",c[3]+t.attribute.x+(u-F)/2):"right"===p?t.setAttribute("x",c[3]+t.attribute.x+u-F):t.setAttribute("x",c[3]+t.attribute.x),"middle"===f?t.setAttribute("y",c[0]+t.attribute.y+(d-O)/2):"bottom"===f?t.setAttribute("y",c[0]+t.attribute.y+d-O):t.setAttribute("y",c[0]+t.attribute.y)}),t}function k(t,e,i,r,n,s,l,a,o){let h=function(t,e,i,r,n,s,l){var a,o;let h,u,d=null!=(a=s.radioCheckType)?a:"column";return(0,c.Z)(t)?h=t.checked:"boolean"==typeof t&&(h=t),null!=(h=l.stateManager.syncRadioState(r,n,s.field,d,i,h))&&"function"!=typeof h||(u=(0,f.vi)(s.checked,{col:r,row:n,table:l,context:null,value:t,dataValue:e}),h=l.stateManager.syncRadioState(r,n,s.field,d,i,u)),null!=(o=null!=h?h:u)&&o}(t,e,i,r,n,s,o),u=function(t,e,i,r,n,s){var l;let a;(0,c.Z)(t)&&(a=t.disable);let o=(0,f.vi)(n.disable,{col:i,row:r,table:s,context:null,value:t,dataValue:e});return null!=(l=null!=a?a:o)&&l}(t,e,r,n,s,o),d=(0,c.Z)(t)?t.text:(0,w.Z)(t)?"":null!=t?t:"",p=(0,S.Z)({},a,{checked:h,disabled:u,text:{text:1===d.length?d[0]:d,whiteSpace:1!==d.length||l?"normal":"no-wrap"},boundsPadding:0}),g=new A.Y(p);return g.name="radio",g}var T=i(95950),R=i(74562),B=i(35953),P=i(11089),E=i(64103),I=i(15589),L=i(86972),F=i(69877),O=i(51619),D=i(14135);(0,I.M)(),(0,L.k)(),(0,F.g)(),(0,O.f)();class H extends R.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,T.Z)({},H.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?this.setAttribute("checked",!1):this.setAttribute("checked",!0),this._dispatchEvent("switch_state_change",{eventType:"switch_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(t,e,i)=>{"interactive"in t&&this.setAttribute("pickable",t.interactive),"disabled"in t&&this.setAttribute("cursor",t.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderCircle(),this.renderText(),this.layout()}renderBox(){this._box=new B.U((0,T.Z)({},this.attribute.box)),this.attribute.disabled&&this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill}):this.attribute.disabled&&!this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableUncheckedFill}):this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.checkedFill}):this._box.setAttributes({fill:this.attribute.box.uncheckedFill}),this.appendChild(this._box)}renderCircle(){this._circle=new P.C((0,T.Z)({},this.attribute.circle)),this.appendChild(this._circle)}renderText(){var t,e,i;this._text=new E.x((0,T.Z)({},null!=(t=this.attribute.text)?t:{})),this.attribute.checked&&(null==(e=this.attribute.text)?void 0:e.checkedText)?this._text.setAttributes({text:this.attribute.text.checkedText}):(null==(i=this.attribute.text)?void 0:i.uncheckedText)&&this._text.setAttributes({text:this.attribute.text.uncheckedText}),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){var t,e,i,r,n,s,l,a,o,h;let u=this.attribute.spaceBetweenTextAndCircle,d=this.attribute.circle.radius,c=this.attribute.box.height,p=2*d,g=this._text.AABBBounds.height(),f=Math.max(c,p,g),m=this.attribute.box.width,y=2*d,v=(0,D.fe)((null!=(i=null==(e=null==(t=this.attribute.text)?void 0:t.checkedText)?void 0:e.length)?i:0)>(null!=(s=null==(n=null==(r=this.attribute.text)?void 0:r.uncheckedText)?void 0:n.length)?s:0)?null!=(a=null==(l=this.attribute.text)?void 0:l.checkedText)?a:"":null!=(h=null==(o=this.attribute.text)?void 0:o.uncheckedText)?h:"",this._text.attribute).width,b=Math.max(m,y+v+3*u),_=c/2-y/2+d,x=_+d+u;this._box.setAttributes({width:b,height:f}),this._circle.setAttributes({y:f/2-p/2+d,x:this.attribute.checked?b-_:_}),this._text.setAttributes({x:this.attribute.checked?b-x-v:x,y:f/2-g/2})}initAttributes(t,e){t=(null==e?void 0:e.skipDefault)?t:(0,T.Z)({},H.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}function z(t,e,i,r,s,l,o,u,d,p,y,v,b,_,x,C,w,S){var A,M,k,T,R,B,P,E,I,L,F,O,D,z,W,N,j,G,V,Z,U,K,$,Y;let X;if(!t){let a=(0,h.d)(s,l,x,_);S&&(t=_.scenegraph.highPerformanceGetCell(s,l,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:u,height:d,lineWidth:null!=(M=null==(A=null==x?void 0:x.group)?void 0:A.lineWidth)?M:void 0,fill:null!=(T=null==(k=null==x?void 0:x.group)?void 0:k.fill)?T:void 0,stroke:null!=(B=null==(R=null==x?void 0:x.group)?void 0:R.stroke)?B:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(E=null==(P=null==x?void 0:x.group)?void 0:P.strokeArrayColor)?E:void 0,cursor:null!=(L=null==(I=null==x?void 0:x.group)?void 0:I.cursor)?L:void 0,lineDash:null!=(O=null==(F=null==x?void 0:x.group)?void 0:F.lineDash)?O:void 0,lineCap:"butt",clip:!0,cornerRadius:x.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:u,height:d,lineWidth:null!=(z=null==(D=null==x?void 0:x.group)?void 0:D.lineWidth)?z:void 0,fill:null!=(N=null==(W=null==x?void 0:x.group)?void 0:W.fill)?N:void 0,stroke:null!=(G=null==(j=null==x?void 0:x.group)?void 0:j.stroke)?G:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(Z=null==(V=null==x?void 0:x.group)?void 0:V.strokeArrayColor)?Z:void 0,cursor:null!=(K=null==(U=null==x?void 0:x.group)?void 0:U.cursor)?K:void 0,lineDash:null!=(Y=null==($=null==x?void 0:x.group)?void 0:$.lineDash)?Y:void 0,lineCap:"butt",clip:!0,cornerRadius:x.group.cornerRadius})).role="cell",t.col=s,t.row=l,null==e||e.addCellGroup(t))}if(b){let t=s,e=l;w&&(t=w.start.col,e=w.start.row),X=_.getCellIcons(t,e)}let q=0,J=0;if(Array.isArray(X)&&0!==X.length){let{leftIconWidth:e,rightIconWidth:i,absoluteLeftIconWidth:r,absoluteRightIconWidth:n}=(0,m.M4)(X,t,w,_);q=e+i,J=e,t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+p[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+u-i-p[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+u-n-p[1])}),t.forEachChildren(t=>{"middle"===v?t.setAttribute("y",(d-t.AABBBounds.height())/2):"bottom"===v?t.setAttribute("y",d-t.AABBBounds.height()-p[2]):t.setAttribute("y",p[0])})}let Q=function(t,e,i,r,n,s,l,o,h){var u,d,p;let m=h._getCellStyle(t,e),y=(0,a.WJ)("spaceBetweenTextAndCircle",m,t,e,h),v=(0,a.WJ)("circleRadius",m,t,e,h),b=(0,a.WJ)("boxWidth",m,t,e,h),_=(0,a.WJ)("boxHeight",m,t,e,h),x=(0,a.WJ)("checkedFill",m,t,e,h),C=(0,a.WJ)("uncheckedFill",m,t,e,h),w=(0,a.WJ)("disableCheckedFill",m,t,e,h),S=(0,a.WJ)("disableUncheckedFill",m,t,e,h),A=(0,a.WJ)("circleFill",m,t,e,h),M=h.getCellValue(t,e),k=h.getCellOriginValue(t,e),T,R,B=null!=M?M:"";(0,c.Z)(M)?(T=M.checked,R=M.disable,B=null!=(u=M.text)?u:""):"boolean"==typeof M&&(T=M,B=""),T=h.stateManager.syncCheckedState(t,e,o.field,T);let P=(0,g.L)(t,e,h),E=h._getCellStyle(t,e),I=null!=(d=E.autoWrapText)?d:h.internalProps.autoWrapText,{lineClamp:L}=E,{checked:F,disable:O,uncheckedText:D,checkedText:z}=o;if(null==T||"function"==typeof T){let i=(0,f.vi)(F,{col:t,row:e,table:h,context:null,value:M,dataValue:k});T=h.stateManager.syncCheckedState(t,e,o.field,i)}let W=(0,f.vi)(O,{col:t,row:e,table:h,context:null,value:M,dataValue:k}),N=(0,f.vi)(z,{col:t,row:e,table:h,context:null,value:M,dataValue:k}),j=(0,f.vi)(D,{col:t,row:e,table:h,context:null,value:M,dataValue:k}),G=h.isAutoRowHeight(e),V={text:1===B.length?B[0]:B,maxLineWidth:"auto"===i?1/0:r-(s[1]+s[3]+P)-2*v-y,textAlign:"left",textBaseline:"top",autoWrapText:I,lineClamp:L,wordBreak:"break-word",heightLimit:G?-1:n-Math.floor(s[0]+s[2]),pickable:!1,dx:P,whiteSpace:1!==B.length||I?"normal":"no-wrap",checkedText:N,uncheckedText:j},Z={x:0,y:0,text:l.text?Object.assign({},l.text,V):V,circle:{radius:v},box:{width:b,height:_},spaceBetweenTextAndCircle:y,disabled:null!=(p=null!=R?R:W)&&p};Z.checked=T,C&&(Z.box.uncheckedFill=C),S&&(Z.box.disableUncheckedFill=S),x&&(Z.box.checkedFill=x),w&&(Z.box.disableCheckedFill=w),A&&(Z.circle.fill=A);let U=new H(Z);return U.name="switch",U}(s,l,o-q,u,d,p,x,C,_);return Q&&t.appendChild(Q),Q.render(),u-=p[1]+p[3]+q,d-=p[0]+p[2],"center"===y?Q.setAttribute("x",p[3]+J+(u-Q.AABBBounds.width())/2):"right"===y?Q.setAttribute("x",p[3]+J+u-Q.AABBBounds.width()):Q.setAttribute("x",p[3]+J),"middle"===v?Q.setAttribute("y",p[0]+(d-Q.AABBBounds.height())/2):"bottom"===v?Q.setAttribute("y",p[0]+d-Q.AABBBounds.height()):Q.setAttribute("y",p[0]),t}H.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",circle:{radius:8,fill:"#FFF",pickable:!1},box:{width:40,height:24,cornerRadius:12,uncheckedFill:"rgb(201,205,212)",checkedFill:"#165DFF",disableUncheckedFill:"rgb(242,243,245)",disableCheckedFill:"rgb(148,191,255)",pickable:!1},text:{textAlign:"left",textBaseline:"top",pickable:!1},spaceBetweenTextAndCircle:6};var W=i(8042),N=i(32463),j=i(84168),G=i(44787);class V extends G.j{constructor(t){super(!1),this.type=j._f.Point,this._padding=0,this.paddingInner(1,t),this.padding=this.paddingOuter,this.paddingInner=void 0,this.paddingOuter=void 0}}var Z=i(32889);let U=new V,K=new Z.f;function $(t,e,i,r,s,l,a,u,d,c,p,g){var f,m,y,v,b,_,x,C,w,S,A,M,k,T,R,B,P,E,I,L,F,O,D,H;if(!t){let o=(0,h.d)(s,l,p,c);g&&(t=c.scenegraph.highPerformanceGetCell(s,l,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:a,height:u,lineWidth:null!=(m=null==(f=null==p?void 0:p.group)?void 0:f.lineWidth)?m:void 0,fill:null!=(v=null==(y=null==p?void 0:p.group)?void 0:y.fill)?v:void 0,stroke:null!=(_=null==(b=null==p?void 0:p.group)?void 0:b.stroke)?_:void 0,strokeArrayWidth:o,strokeArrayColor:null!=(C=null==(x=null==p?void 0:p.group)?void 0:x.strokeArrayColor)?C:void 0,cursor:null!=(S=null==(w=null==p?void 0:p.group)?void 0:w.cursor)?S:void 0,lineDash:null!=(M=null==(A=null==p?void 0:p.group)?void 0:A.lineDash)?M:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:a,height:u,lineWidth:null!=(T=null==(k=null==p?void 0:p.group)?void 0:k.lineWidth)?T:void 0,fill:null!=(B=null==(R=null==p?void 0:p.group)?void 0:R.fill)?B:void 0,stroke:null!=(E=null==(P=null==p?void 0:p.group)?void 0:P.stroke)?E:void 0,strokeArrayWidth:o,strokeArrayColor:null!=(L=null==(I=null==p?void 0:p.group)?void 0:I.strokeArrayColor)?L:void 0,cursor:null!=(O=null==(F=null==p?void 0:p.group)?void 0:F.cursor)?O:void 0,lineDash:null!=(H=null==(D=null==p?void 0:p.group)?void 0:D.lineDash)?H:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius})).role="cell",t.col=s,t.row=l,null==e||e.addCellGroup(t))}let z=function(t,e,i,r,n,s){let l,a,h,u,d=s.internalProps.layoutMap.getBody(t,e).sparklineSpec,c=s.getCellValue(t,e);if(!Array.isArray(c))return;let p=n[3],g=n[0];i-=n[1]+n[3];let f=r-=n[0]+n[2];"function"==typeof d?a=Y(l=d({col:t,row:e,dataValue:s.getCellOriginValue(t,e)||"",value:s.getCellValue(t,e)||"",rect:s.getCellRangeRelativeRect(s.getCellRange(t,e)),table:s}),p,g,i,r):(l=d,a=Y(d,p,g,i,r));let m=[],y=[];if("object"==typeof l.xField)U.domain(l.xField.domain),h=l.xField.field;else if("string"==typeof l.xField){let t=c.map(t=>t[l.xField]);U.domain(t),h=l.xField}else Array.isArray(c)&&(U.domain(Array.from({length:c.length},(t,e)=>e)),h=l.xField);if(U.range([0,i]),"object"==typeof l.yField)K.domain(l.yField.domain),u=l.yField.field;else if("string"==typeof l.yField){let t=X(c,l.yField);K.domain([Math.min(...t),Math.max(...t)]),u=l.yField}else if(Array.isArray(c)){let t=X(c);K.domain([Math.min(...t),Math.max(...t)]),u=l.yField}if(K.range([0,r]),"object"==typeof l.xField&&Array.isArray(l.xField.domain)){let t=c.map(t=>t[l.xField.field]),e=l.xField.domain;for(let i=0;i<e.length;i++){let r=!1;for(let n=0;n<t.length;n++)if(e[i]===t[n]){let t=c[n];if(!(0,o.Z)(t[h])||!(0,o.Z)(t[u]))break;m.push({x:0+U.scale(t[h]),y:f-K.scale(t[u]),defined:(0,o.Z)(t[u])}),y.push(t),r=!0;break}r||(m.push({x:0+U.scale(e[i]),y:0,defined:!1}),y.push({[h]:e[i],[u]:null}))}}else for(let t=0;t<c.length;t++){let e=c[t];m.push({x:0+U.scale(h?e[h]:t),y:f-K.scale(u?e[u]:e),defined:(0,o.Z)(u?e[u]:e),rawData:e}),y.push(e)}let v=a.getChildByName("sparkline-line");v&&v.setAttribute("points",m),v.bandwidth=U.step(),v.min=K.range()[0],v.max=K.range()[1];let b=a.getChildByName("sparkline-symbol-group");if(b){let t="isolatedPoint"===l.pointShowRule;if("all"===l.pointShowRule)for(let t=0;t<m.length;t++){let{x:e,y:i,defined:r}=m[t];if(r){let t=(0,W.t)({x:e,y:i});b.appendChild(t)}}else if(t)for(let t=0;t<m.length;t++){let{x:e,y:i,defined:r}=m[t];if(r&&(!m[t-1]||!m[t-1].defined)&&(!m[t+1]||!m[t+1].defined)){let t=(0,W.t)({x:e,y:i});b.appendChild(t)}}}return a}(s,l,a,u,d,c);return z&&t.appendChild(z),t}function Y(t,e,i,r,s){var l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C,w,S,A,M,k;let T;T="function"==typeof t?t(null):t;let R=new n.Z({x:e,y:i,width:r,height:s,stroke:!1,fill:!1});if(R.name="sparkline","line"===T.type){let t=(0,N.W)({x:0,y:0,curveType:T.smooth?"monotoneX":"linear",stroke:null!=(o=null==(a=null==(l=T.line)?void 0:l.style)?void 0:a.stroke)?o:"blue",lineWidth:null!=(d=null==(u=null==(h=T.line)?void 0:h.style)?void 0:u.strokeWidth)?d:2});t.name="sparkline-line",R.addChild(t),T.crosshair&&(t.hover=null!=(p=null==(c=T.crosshair)?void 0:c.style)?p:{stroke:"#000",interpolate:"linear"});let e=new n.Z({x:0,y:0,width:r,height:s,stroke:!1,fill:!1});e.name="sparkline-symbol-group",e.setTheme({symbol:{stroke:null!=(m=null==(f=null==(g=T.point)?void 0:g.style)?void 0:f.stroke)?m:"#000",lineWidth:null!=(b=null==(v=null==(y=T.point)?void 0:y.style)?void 0:v.strokeWidth)?b:1,fill:null!=(C=null==(x=null==(_=T.point)?void 0:_.style)?void 0:x.fill)?C:"#000",size:2*(null!=(A=null==(S=null==(w=T.point)?void 0:w.style)?void 0:S.size)?A:3),symbolType:"circle"}}),R.addChild(e),e.hover=null!=(k=null==(M=T.point)?void 0:M.hover)&&k}return R}function X(t,e){let i=[];for(let r=0;r<t.length;r++){let n=t[r];(0,o.Z)(e)&&(0,o.Z)(n[e])?i.push(n[e]):!(0,o.Z)(e)&&(0,o.Z)(n)&&i.push(n)}return i}var q=i(77474),J=i(70107),Q=i(9727),te=i(28996),ti=i(35137),tr=i(14828);let tn=J.U2();function ts(t,e,i,r,s,l,u,d,c,p,g,f,y,v,b,x,C){var w,S,A,M,k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X,J,ts;let tl,ta,to=v._getCellStyle(r,s),th=(0,a.vp)("padding",to,r,s,v);(null==(w=v.options.customConfig)?void 0:w.imageMargin)?p=(0,tr.u)(null==(S=v.options.customConfig)?void 0:S.imageMargin):(0,o.Z)(th)&&(p=th),(null==(A=null==b?void 0:b.text)?void 0:A.textAlign)&&(g=null==(M=null==b?void 0:b.text)?void 0:M.textAlign),(null==(k=null==b?void 0:b.text)?void 0:k.textBaseline)&&(f=null==(T=null==b?void 0:b.text)?void 0:T.textBaseline);let tu=(0,h.d)(r,s,b,v);if(C&&(tl=v.scenegraph.highPerformanceGetCell(r,s,!0))&&"cell"===tl.role&&tl.setAttributes({x:e,y:i,width:l,height:u,lineWidth:null!=(B=null==(R=null==b?void 0:b.group)?void 0:R.lineWidth)?B:void 0,fill:null!=(E=null==(P=null==b?void 0:b.group)?void 0:P.fill)?E:void 0,stroke:null!=(L=null==(I=null==b?void 0:b.group)?void 0:I.stroke)?L:void 0,strokeArrayWidth:tu,strokeArrayColor:null!=(O=null==(F=null==b?void 0:b.group)?void 0:F.strokeArrayColor)?O:void 0,cursor:null!=(H=null==(D=null==b?void 0:b.group)?void 0:D.cursor)?H:void 0,lineDash:null!=(W=null==(z=null==b?void 0:b.group)?void 0:z.lineDash)?W:void 0,lineCap:"butt",clip:!0,cornerRadius:b.group.cornerRadius}),tl&&"cell"===tl.role||((tl=new n.Z({x:e,y:i,width:l,height:u,lineWidth:null!=(j=null==(N=null==b?void 0:b.group)?void 0:N.lineWidth)?j:void 0,fill:null!=(V=null==(G=null==b?void 0:b.group)?void 0:G.fill)?V:void 0,stroke:null!=(U=null==(Z=null==b?void 0:b.group)?void 0:Z.stroke)?U:void 0,strokeArrayWidth:tu,strokeArrayColor:null!=($=null==(K=null==b?void 0:b.group)?void 0:K.strokeArrayColor)?$:void 0,cursor:null!=(X=null==(Y=null==b?void 0:b.group)?void 0:Y.cursor)?X:void 0,lineDash:null!=(ts=null==(J=null==b?void 0:b.group)?void 0:J.lineDash)?ts:void 0,lineCap:"butt",clip:!0,cornerRadius:b.group.cornerRadius})).role="cell",tl.col=r,tl.row=s,null==t||t.addCellGroup(tl)),y){let t=r,e=s;x&&(t=x.start.col,e=x.start.row),ta=v.getCellIcons(t,e)}let td=0,tc=0;if(Array.isArray(ta)&&0!==ta.length){let{leftIconWidth:t,rightIconWidth:e,absoluteLeftIconWidth:i,absoluteRightIconWidth:r}=(0,m.M4)(ta,tl,x,v);td=t,tc=e,tl.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+p[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+l-e-p[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+l-r-p[1])}),tl.forEachChildren(t=>{"middle"===f?t.setAttribute("y",(u-t.AABBBounds.height())/2):"bottom"===f?t.setAttribute("y",u-t.AABBBounds.height()-p[2]):t.setAttribute("y",p[0])}),tl._cellLeftIconWidth=td,tl._cellRightIconWidth=tc}let tp=v.getCellValue(r,s),tg=document.createElement("video");tg.addEventListener("loadeddata",()=>{c&&(0,_.LP)(r,s,tg.videoWidth,tg.videoHeight,v.scenegraph,p,tl);let{width:t,height:e,isMerge:i}=(0,_.SI)(tl,v);if(d){let{width:i,height:r}=(0,Q.f)(tg.videoWidth,tg.videoHeight,t-p[1]-p[3],e-p[0]-p[2]),n=(0,ti.W)(0,0,t,e,i,r,g,f,p);tf.setAttributes({width:i,height:r,x:n.x,y:n.y,dx:0})}else tf.setAttributes({x:p[3],y:p[0],width:t-p[1]-p[3],height:e-p[2]-p[0],dy:0});i&&(0,_.Gb)(tl.mergeStartCol,tl.mergeEndCol,tl.mergeStartRow,tl.mergeEndRow,v);let{width:n,height:l}=(0,_.SI)(tl,v),a=Math.floor(Math.min(n-p[1]-p[3],l-p[2]-p[0])/2),o=0+(n>tf.attribute.width?tf.attribute.x-0+tf.attribute.width/2:n/2),h=0+(l>tf.attribute.height?tf.attribute.y-0+tf.attribute.height/2:l/2),{dx:u,dy:m}=tl.getChildByName("image",!0).attribute,y=new te.J({x:o-a/2,y:h-a/2,width:a,height:a,image:tn.play.svg,cursor:tn.play.cursor,dx:u,dy:m});y.name="play-icon",tl.appendChild(y),v.scenegraph.updateNextFrame()}),tg.onerror=()=>{tf.image=tn.damage_pic.svg},tg.src=tp,tg.setAttribute("preload","auto");let tf=(0,q.B)({x:p[3],y:p[0],width:l-p[1]-p[3],height:u-p[2]-p[0],image:tg,cursor:"pointer"});return tf.name="image",tf.keepAspectRatio=d,tf.textAlign=g,tf.textBaseline=f,tl.appendChild(tf),tl}var tl=i(41035),ta=i(26854);function to(t,e,i,r,s,l,u,d,c,p,g,f,y,v,b,_,x,C,w){var S,A,M,k,T,R,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K,$,Y,X,q,J,Q,te,ti,tr,tn;let ts,to=t._getCellStyle(l,u),th=(0,a.vp)("padding",to,l,u,t);(0,o.Z)(th)&&(g=th),(null==(S=null==x?void 0:x.text)?void 0:S.textAlign)&&(f=null==(A=null==x?void 0:x.text)?void 0:A.textAlign),(null==(M=null==x?void 0:x.text)?void 0:M.textBaseline)&&(y=null==(k=null==x?void 0:x.text)?void 0:k.textBaseline);let tu=t.isAutoRowHeight(u),td=null!=(T=to.autoWrapText)?T:t.internalProps.autoWrapText,tc=to.lineClamp,tp=(0,h.d)(l,u,x,t);if(w&&(ts=t.scenegraph.getCell(l,u,!0))&&"cell"===ts.role&&ts.setAttributes({x:r,y:s,width:c,height:p,lineWidth:null!=(P=null==(R=null==x?void 0:x.group)?void 0:R.lineWidth)?P:void 0,fill:null!=(I=null==(E=null==x?void 0:x.group)?void 0:E.fill)?I:void 0,stroke:null!=(F=null==(L=null==x?void 0:x.group)?void 0:L.stroke)?F:void 0,strokeArrayWidth:null!=tp?tp:void 0,strokeArrayColor:null!=(D=null==(O=null==x?void 0:x.group)?void 0:O.strokeArrayColor)?D:void 0,cursor:null!=(z=null==(H=null==x?void 0:x.group)?void 0:H.cursor)?z:void 0,lineDash:null!=(N=null==(W=null==x?void 0:x.group)?void 0:W.lineDash)?N:void 0,lineCap:"butt",clip:!0,cornerRadius:x.group.cornerRadius}),ts&&"cell"===ts.role||((ts=new n.Z({x:r,y:s,width:c,height:p,lineWidth:null!=(G=null==(j=null==x?void 0:x.group)?void 0:j.lineWidth)?G:void 0,fill:null!=(Z=null==(V=null==x?void 0:x.group)?void 0:V.fill)?Z:void 0,stroke:null!=(K=null==(U=null==x?void 0:x.group)?void 0:U.stroke)?K:void 0,strokeArrayWidth:null!=tp?tp:void 0,strokeArrayColor:null!=(Y=null==($=null==x?void 0:x.group)?void 0:$.strokeArrayColor)?Y:void 0,cursor:null!=(q=null==(X=null==x?void 0:x.group)?void 0:X.cursor)?q:void 0,lineDash:null!=(Q=null==(J=null==x?void 0:x.group)?void 0:J.lineDash)?Q:void 0,lineCap:"butt",clip:!0,cornerRadius:x.group.cornerRadius})).role="cell",ts.col=l,ts.row=u,null==i||i.addCellGroup(ts)),b&&ts.appendChild(b),_){let i;if(v){let e=l,r=u;C&&(e=C.start.col,r=C.start.row),i=t.getCellIcons(e,r)}(0,m.Rd)(ts,i,e,g,"auto"===d,tu,td,"number"==typeof tc?tc:void 0,ts.attribute.width,ts.attribute.height,f,y,t,x,C),(null==(te=null==x?void 0:x._vtable)?void 0:te.marked)&&function(t,e,i){if("boolean"==typeof t){let t=(0,tl.Q)({x:e.attribute.width,y:0,startAngle:Math.PI/2,endAngle:Math.PI,outerRadius:6,fill:"#3073F2",pickable:!1});t.name="mark",e.appendChild(t)}else{let i,r,n,s,l,a,{bgColor:o="#3073F2",shape:h="sector",position:u="right-top",size:d=10,offset:c=0}=t;if("sector"===h)"right-top"===u?(i=e.attribute.width-c,r=c,n=Math.PI/2,s=Math.PI):"left-top"===u?(i=c,r=c,n=0,s=Math.PI/2):"right-bottom"===u?(i=e.attribute.width-c,r=e.attribute.height-c,n=Math.PI,s=Math.PI/2*3):"left-bottom"===u&&(i=c,r=e.attribute.height-c,n=Math.PI/2*3,s=2*Math.PI),l=o,a=(0,tl.Q)({x:i,y:r,startAngle:n,endAngle:s,outerRadius:d,fill:l,pickable:!1});else if("triangle"===h){let t,n,s,h;"right-top"===u?(i=e.attribute.width-c,r=c,t=i-d,n=r,s=i,h=r+d):"left-top"===u?(i=c,r=c,t=i+d,n=r,s=i,h=r+d):"right-bottom"===u?(i=e.attribute.width-c,r=e.attribute.height-c,t=i-d,n=r,s=i,h=r-d):"left-bottom"===u&&(i=c,r=e.attribute.height-c,t=i+d,n=r,s=i,h=r-d),l=o,a=(0,ta.p)({points:[{x:i,y:r},{x:t,y:n},{x:s,y:h}],fill:l,pickable:!1})}else"rect"===h&&("right-top"===u?(i=e.attribute.width-d-c,r=c):"left-top"===u?(i=c,r=c):"right-bottom"===u?(i=e.attribute.width-d-c,r=e.attribute.height-d-c):"left-bottom"===u&&(i=c,r=e.attribute.height-d-c),l=o,a=(0,B.f)({x:i,y:r,width:d,height:d,fill:l,pickable:!1}));a.name="mark",e.appendChild(a)}}(null==(ti=null==x?void 0:x._vtable)?void 0:ti.marked,ts,0)}return b&&ts.setAttributes({width:Math.max(ts.attribute.width,null!=(tr=b.attribute.width)?tr:0),height:Math.max(ts.attribute.height,null!=(tn=b.attribute.height)?tn:0)}),ts}function th(t,e,i,r,s,l,o,h,u,d){var c,p,g,m,y,v;if(t.dependField){let e=(0,f.vi)(t.dependField,{col:l,row:o,table:u,value:r,dataValue:s,cellHeaderPaths:void 0});s=null!=(p=null==(c=u.getCellOriginRecord(l,o))?void 0:c[e])?p:s}let b=null!=(g=(0,f.vi)(t.barType,{col:l,row:o,table:u,value:r,dataValue:s,cellHeaderPaths:void 0}))?g:"default",_=null!=(m=(0,f.vi)(t.min,{col:l,row:o,table:u,value:r,dataValue:s,cellHeaderPaths:void 0}))?m:0,C=null!=(y=(0,f.vi)(t.max,{col:l,row:o,table:u,value:r,dataValue:s,cellHeaderPaths:void 0}))?y:_+100,w=0;if(w=d?u.getRowsHeight(d.start.row,d.end.row):u.getRowHeight(o),u.pluginManager&&u.pluginManager.getPluginByName("Master Detail Plugin")){let t=o-u.columnHeaderLevelCount,e=u.internalProps,i=null==(v=null==e?void 0:e.originalRowHeights)?void 0:v.get(t);void 0!==i&&i>0&&(w=i)}let S=i,A=w,M=0;(0,x.Z)(u.theme._contentOffset)&&(M=u.theme._contentOffset);let k=new n.Z({x:-M,y:-M,width:S,height:A});k.name="progress-bar";let{showBar:T,barColor:R,barBgColor:P,barPositiveColor:E,barNegativeColor:I,barAxisColor:L,barRightToLeft:F,showBarMark:O,barMarkPositiveColor:D,barMarkNegativeColor:H,barMarkWidth:z,barMarkPosition:W,barMarkInBar:j}=e,{barHeight:G,barBottom:V,barPadding:Z}=e;1===Z.length?Z=[Z[0],Z[0],Z[0],Z[0]]:2===Z.length?Z=[Z[0],Z[1],Z[0],Z[1]]:3===Z.length&&(Z=[Z[0],Z[1],Z[2],Z[1]]),Z=Z.map((t,e)=>{if("string"==typeof t&&f.Bd.endsWith(t,"%")){let r=Number(t.substr(0,t.length-1));return 0===e||2===e?w*r/100:i*r/100}return Number(t)});let U=(0,tr.u)((0,a.WJ)("borderLineWidth",e,l,o,u)),K=Math.max(Z[0],Math.ceil(U[0]/2)),$=Math.max(Z[1],Math.floor(U[1]/2)),Y=Math.max(Z[2],Math.floor(U[2]/2)),X=Math.max(Z[3],Math.ceil(U[3]/2));O&&z>0&&"right"===W&&!1===j&&($+=z,X+=z),S-=$+X,A-=Y+K,o===u.rowCount-1&&[0,"0"].includes(V)&&(A-=1);let q=X,J=S;if(G="string"==typeof G&&f.Bd.endsWith(G,"%")?A*(G=Number(G.substr(0,G.length-1)))/100:Number(G),V="string"==typeof V&&f.Bd.endsWith(V,"%")?A*(V=Number(V.substr(0,V.length-1)))/100:Number(V),(0,f.vi)(T,{col:l,row:o,table:u,context:null,value:r,dataValue:s})){let t=`${s}`;f.Bd.endsWith(t,"%")&&(t=t.substr(0,t.length-1));let e=Number(t);if(isNaN(e))return k;if("default"===(null!=b?b:"default")){let t=e<_?0:e>C?1:(e-_)/(C-_),i=S,n=K+A-G-V,a=Math.min(i*t,i),h=F?q+J-a:q;l!==u.colCount-1||1!==t||F||(a-=1);let d=(0,f.vi)(P,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:t});if(d){let t=(0,B.f)({x:h,y:n,width:i,height:G,fill:d});k.addChild(t)}let c=(0,f.vi)(R,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:t})||"#20a8d8",p=(0,B.f)({x:h,y:n,width:a,height:G,fill:c});k.addChild(p)}else if("negative"===b){let t=_<0?-_:0,i=C>0?C:0,n=t/(t+i),a=1-n,h=e>0?e/i:0,d=e<0?-e/t:0,c=S,p=K+A-G-V,g=(0,f.vi)(P,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:h});if(g){let t=(0,B.f)({x:q,y:p,width:c,height:G,fill:g});k.addChild(t)}let m=F?a*c:n*c,y=Math.min(c*n*d,c),v=F?{left:q+m,top:p,width:y,height:G}:{left:q+m-y,top:p,width:y,height:G},b=(0,f.vi)(I,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:d})||"#20a8d8",x=(0,B.f)({x:v.left,y:v.top,width:v.width,height:v.height,fill:b});k.addChild(x);let M=Math.min(c*a*h,c);l!==u.colCount-1||1!==h||F||(M-=1);let T=F?{left:q+m-M,top:p,width:M,height:G}:{left:q+m,top:p,width:M,height:G},R=(0,f.vi)(E,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:h})||"#20a8d8",Z=(0,B.f)({x:T.left,y:T.top,width:T.width,height:T.height,fill:R});k.addChild(Z);let U=F?v.left:T.left,$=(0,f.vi)(L,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:h}),Y=(0,N.W)({x:0,y:0,stroke:$,lineWidth:1,lineDash:[2,2],points:[{x:U,y:0},{x:U,y:w}]});if(k.addChild(Y),O&&(h||d)){let t,e=[];if(h>0)if(t=(0,f.vi)(D,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:h})||"#20a8d8","right"===W){let t=F?T.left+z/2:T.left+T.width+(j?-z/2:z/2);e.push({x:t,y:T.top}),e.push({x:t,y:T.top+T.height})}else"bottom"===W&&(e.push({x:T.left,y:T.top+T.height-z/2}),e.push({x:T.left+T.width,y:T.top+T.height-z/2}));else if(d>0)if(t=(0,f.vi)(H,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:d})||"#20a8d8","right"===W){let t=F?v.left+v.width-z/2:v.left+z/2;e.push({x:t,y:v.top}),e.push({x:t,y:v.top+v.height})}else"bottom"===W&&(e.push({x:v.left,y:v.top+v.height-z/2}),e.push({x:v.left+v.width,y:v.top+v.height-z/2}));let i=(0,N.W)({x:0,y:0,stroke:t,lineWidth:z,points:e});k.addChild(i)}}else if("negative_no_axis"===b){let t,i=Math.max(_<0?-_:0,C>0?C:0),n=0===i?0:Math.abs(e)/i,a=S,h=Math.min(a*n,a);l!==u.colCount-1||1!==n||F||(h-=1);let d=K+A-G-V,c=F?q+J-h:q,p=(0,f.vi)(P,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:n});if(p){let t=(0,B.f)({x:c,y:d,width:a,height:G,fill:p});k.addChild(t)}let g={left:c,top:d,width:h,height:G};t=e>=0?(0,f.vi)(E,{col:l,row:o,table:u,context:null,value:r,percentile:n,dataValue:s})||"#20a8d8":(0,f.vi)(I,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:n})||"#20a8d8";let m=(0,B.f)({x:g.left,y:g.top,width:g.width,height:g.height,fill:t});if(k.addChild(m),O&&e){let t,i=[];if(t=e>=0?(0,f.vi)(D,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:n})||"#20a8d8":(0,f.vi)(H,{col:l,row:o,table:u,context:null,value:r,dataValue:s,percentile:n})||"#20a8d8","right"===W){let t=F?g.left+z/2:g.left+g.width-z/2;i.push({x:t,y:g.top}),i.push({x:t,y:g.top+g.height})}else"bottom"===W&&(i.push({x:g.left,y:g.top+g.height-z/2}),i.push({x:g.left+g.width,y:g.top+g.height-z/2}));let a=(0,N.W)({x:0,y:0,stroke:t,lineWidth:z,points:i});k.addChild(a)}}}return k}var tu=i(37352),td=i(25777),tc=i(70506),tp=i(29753),tg=i(94055);function tf(t,e,i,r,n,s){var l,a,h,u,d,c,p,g,f,m,y,v,b,_,C,w,S,A;let M,k;if((null==i?void 0:i.zero)&&(t=Math.min(t,0),e=Math.max(e,0)),null==i?void 0:i.expand){let r=t,n=e;(0,o.Z)(i.expand.min)&&(t=r-(n-r)*i.expand.min),(0,o.Z)(i.expand.max)&&(e=n+(n-r)*i.expand.max)}if((0,x.Z)(null==i?void 0:i.min)&&(t=i.min),(0,x.Z)(null==i?void 0:i.max)&&(e=i.max),"log"===(null==i?void 0:i.type)?(M=new tu.Y).base(null!=(l=null==i?void 0:i.base)?l:10):"symlog"===(null==i?void 0:i.type)?(M=new td.g).constant(null!=(a=null==i?void 0:i.constant)?a:10):M=new Z.f,M.domain([t,e],!!(null==i?void 0:i.nice)),s){S=M,A=s,S.niceMax(A.targetTicks.length)}else if(null==i?void 0:i.nice){let t=null!=(c=null!=(u=null==(h=i.tick)?void 0:h.forceTickCount)?u:null==(d=i.tick)?void 0:d.tickCount)?c:10;(0,tc.Z)(t)&&(t=t({axisLength:n,labelStyle:null!=(g=null==(p=null==i?void 0:i.label)?void 0:p.style)?g:{fontSize:tg.Zu.LABEL_FONT_SIZE}})),"accurateFirst"===i.niceType&&(t=Math.max(10,t)),(0,tp.Z)(i.min)&&(0,tp.Z)(i.max)?M.nice(t):(0,o.Z)(i.min)&&(0,tp.Z)(i.max)?M.niceMax(t):(0,tp.Z)(i.min)&&(0,o.Z)(i.max)&&M.niceMin(t)}return delete M._niceType,k=(null!=(m=null==(f=null==s?void 0:s.targetTicks)?void 0:f.length)?m:null==(y=null==i?void 0:i.tick)?void 0:y.forceTickCount)?M.forceTicks(null!=(b=null==(v=null==s?void 0:s.targetTicks)?void 0:v.length)?b:null==(_=null==i?void 0:i.tick)?void 0:_.forceTickCount):M.ticks((0,x.Z)(null==(C=null==i?void 0:i.tick)?void 0:C.tickCount)?i.tick.tickCount:5,{noDecimals:null==(w=null==i?void 0:i.tick)?void 0:w.noDecimals}),{range:M.domain(),ticks:k}}var tm=i(52404);function ty(t,e,i,r,s,l,o,u,d,c,p,y,v,b,_,x,C,w){var S,A,M,k,T,R,B,P,E,I,L,F,O,D,H,z,W,N,j,G,V,Z,U,K;let $;if(!t){let a=(0,h.d)(s,l,_,b);w&&(t=b.scenegraph.highPerformanceGetCell(s,l,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:u,height:d,lineWidth:null!=(A=null==(S=null==_?void 0:_.group)?void 0:S.lineWidth)?A:void 0,fill:null!=(k=null==(M=null==_?void 0:_.group)?void 0:M.fill)?k:void 0,stroke:null!=(R=null==(T=null==_?void 0:_.group)?void 0:T.stroke)?R:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(P=null==(B=null==_?void 0:_.group)?void 0:B.strokeArrayColor)?P:void 0,cursor:null!=(I=null==(E=null==_?void 0:_.group)?void 0:E.cursor)?I:void 0,lineDash:null!=(F=null==(L=null==_?void 0:_.group)?void 0:L.lineDash)?F:void 0,lineCap:"butt",clip:!0,cornerRadius:_.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:u,height:d,lineWidth:null!=(D=null==(O=null==_?void 0:_.group)?void 0:O.lineWidth)?D:void 0,fill:null!=(z=null==(H=null==_?void 0:_.group)?void 0:H.fill)?z:void 0,stroke:null!=(N=null==(W=null==_?void 0:_.group)?void 0:W.stroke)?N:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(G=null==(j=null==_?void 0:_.group)?void 0:j.strokeArrayColor)?G:void 0,cursor:null!=(Z=null==(V=null==_?void 0:_.group)?void 0:V.cursor)?Z:void 0,lineDash:null!=(K=null==(U=null==_?void 0:_.group)?void 0:U.lineDash)?K:void 0,lineCap:"butt",clip:!0,cornerRadius:_.group.cornerRadius})).role="cell",t.col=s,t.row=l,null==e||e.addCellGroup(t))}if(v){let t=s,e=l;C&&(t=C.start.col,e=C.start.row),$=b.getCellIcons(t,e)}let Y=0,X=0;if(Array.isArray($)&&0!==$.length){let{leftIconWidth:e,rightIconWidth:i,absoluteLeftIconWidth:r,absoluteRightIconWidth:n}=(0,m.M4)($,t,C,b);Y=e+i,X=e,t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+c[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+u-i-c[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+u-n-c[1])}),t.forEachChildren(t=>{"middle"===y?t.setAttribute("y",(d-t.AABBBounds.height())/2):"bottom"===y?t.setAttribute("y",d-t.AABBBounds.height()-c[2]):t.setAttribute("y",c[0])})}let q=function(t,e,i,r,n,s,l,o,h){var u,d;let c=h._getCellStyle(t,e),p=(0,a.WJ)("buttonColor",c,t,e,h),m=(0,a.WJ)("buttonBorderColor",c,t,e,h),y=(0,a.WJ)("buttonLineWidth",c,t,e,h),v=(0,a.WJ)("buttonBorderRadius",c,t,e,h),b=(0,a.WJ)("buttonHoverColor",c,t,e,h),_=(0,a.WJ)("buttonHoverBorderColor",c,t,e,h),x=(0,a.WJ)("buttonPadding",c,t,e,h),C=(0,a.WJ)("buttonTextHoverColor",c,t,e,h),w=(0,a.WJ)("buttonDisableColor",c,t,e,h),S=(0,a.WJ)("buttonDisableBorderColor",c,t,e,h),A=(0,a.WJ)("buttonTextDisableColor",c,t,e,h),M=h.getCellValue(t,e),k=h.getCellOriginValue(t,e),T=(0,g.L)(t,e,h),R=h._getCellStyle(t,e),B=null!=(u=R.autoWrapText)?u:h.internalProps.autoWrapText,{lineClamp:P}=R,E=h.isAutoRowHeight(e),{disable:I,text:L}=o,F=(0,f.vi)(I,{col:t,row:e,table:h,context:null,value:M,dataValue:k}),O=(0,f.vi)(L,{col:t,row:e,table:h,context:null,value:M,dataValue:k}),D=null!=(d=null!=O?O:M)?d:"",H={maxLineWidth:"auto"===i?1/0:r-(s[1]+s[3]+T),textAlign:"left",textBaseline:"top",autoWrapText:B,lineClamp:P,wordBreak:"break-word",heightLimit:E?-1:n-Math.floor(s[0]+s[2]),pickable:!1,dx:T,whiteSpace:1!==D.length||B?"normal":"no-wrap"},z=l.text?Object.assign({},l.text,H):H,W={x:0,y:0,cursor:F?"not-allowed":"pointer",disable:F,childrenPickable:!1,text:1===D.length?D[0]:D,textStyle:z,padding:x,panel:{visible:!0,fill:F?w:p,stroke:F?S:m,lineWidth:y,cornerRadius:v},state:{text:{hover:{}},panel:{hover:{fill:b,stroke:_}}}};A&&(W.state.text.fill=A),C&&(W.state.text.hover.fill=C);let N=new tm.V(W);return N.name="button",F||(N.addEventListener("mouseenter",()=>{N.addState("hover",!0,!1),N.stage.renderNextFrame()}),N.addEventListener("mouseleave",()=>{N.removeState("hover",!1),N.stage.renderNextFrame()})),N}(s,l,o-Y,u,d,c,_,x,b);return q&&t.appendChild(q),u-=c[1]+c[3]+Y,d-=c[0]+c[2],"center"===p?q.setAttribute("x",c[3]+X+(u-q.AABBBounds.width())/2):"right"===p?q.setAttribute("x",c[3]+X+u-q.AABBBounds.width()):q.setAttribute("x",c[3]+X),"middle"===y?q.setAttribute("y",c[0]+(d-q.AABBBounds.height())/2):"bottom"===y?q.setAttribute("y",c[0]+d-q.AABBBounds.height()):q.setAttribute("y",c[0]),t}let tv=()=>{r.F.registerFunction("createChartCellGroup",u),r.F.registerFunction("getAxisDomainRangeAndLabels",tf)},tb=()=>{r.F.registerFunction("createCheckboxCellGroup",b)},t_=()=>{r.F.registerFunction("createImageCellGroup",_.Ui)},tx=()=>{r.F.registerFunction("createProgressBarCell",th)},tC=()=>{r.F.registerFunction("createRadioCellGroup",M)},tw=()=>{r.F.registerFunction("createSwitchCellGroup",z)},tS=()=>{r.F.registerFunction("createButtonCellGroup",ty)},tA=()=>{r.F.registerFunction("createSparkLineCellGroup",$)},tM=()=>{r.F.registerFunction("createTextCellGroup",to)},tk=()=>{r.F.registerFunction("createVideoCellGroup",ts)}},92062:function(t,e,i){"use strict";i.d(e,{al:()=>v,j8:()=>_,rj:()=>y});var r=i(73664),n=i(44186),s=i(14828),l=i(67203),a=i(13844),o=i(18585),h=i(70506),u=i(47e3),d=i(43735),c=i(58977),p=i(76349),g=i(3687),f=i(29322),m=i(57657);function y(t,e,i,r){var n,s,l,a,o,h,u,d,c,p;t.internalProps.columnWidthConfig&&(c=t,p=t.internalProps.columnWidthConfig,c.isPivotTable()?function(t,e){for(let i=0;i<(null==e?void 0:e.length);i++){let r=e[i],n=r.dimensions,s=r.width,l=t.getCellAddressByHeaderPaths(n);if(l&&l.col>=t.rowHeaderLevelCount){let e=t.getCellHeaderPaths(l.col,t.columnHeaderLevelCount);if(e.colHeaderPaths.length===n.length){let i=!0;for(let t=0;t<n.length;t++){let r=n[t];if(0>e.colHeaderPaths.findIndex((t,e)=>t.indicatorKey===r.indicatorKey||t.dimensionKey===r.dimensionKey&&t.value===r.value)){i=!1;break}}i&&!t.internalProps._widthResizedColMap.has(l.col)&&(t._setColWidth(l.col,s),t.internalProps._widthResizedColMap.add(l.col))}}else l&&l.col<t.rowHeaderLevelCount&&(t.internalProps._widthResizedColMap.has(l.col)||(t._setColWidth(l.col,s),t.internalProps._widthResizedColMap.add(l.col)))}}(c,p):c.isListTable()&&function(t,e){for(let i=0;i<(null==e?void 0:e.length);i++){let r=e[i],n=r.key,s=r.width,l=t.internalProps.layoutMap.getColumnByKey(n);if(l.columnDefine){let{col:e}=l;t.internalProps._widthResizedColMap.has(e)||(t._setColWidth(e,s),t.internalProps._widthResizedColMap.add(e))}}}(c,p)),t.isPivotTable()&&t.internalProps.columnWidthConfigForRowHeader&&function(t,e){for(let i=0;i<(null==e?void 0:e.length);i++){let r=e[i],n=r.dimensions,s=r.width,l=t.getCellAddressByHeaderPaths(n);l&&l.col<t.rowHeaderLevelCount&&(t.internalProps._widthResizedColMap.has(l.col)||(t._setColWidth(l.col,s),t.internalProps._widthResizedColMap.add(l.col)))}}(t,t.internalProps.columnWidthConfigForRowHeader),e=null!=e?e:0,i=null!=i?i:t.colCount-1,0===e&&i===t.colCount-1&&t._clearColRangeWidthsMap();let g=t.internalProps.layoutMap;t.isPivotTable()&&(g.enableUseGetBodyCache(),g.enableUseHeaderPathCache());let f=[],m=[];if(r)for(let e=0;e<t.colCount;e++)f[e]=t.getColWidth(e);for(let o=e;o<=i;o++){let e;if(!t.internalProps.transpose&&("only-header"===(null==(s=null==(n=t.internalProps.layoutMap.columnObjects)?void 0:n[o])?void 0:s.columnWidthComputeMode)||"only-header"===t.columnWidthComputeMode)&&"showHeader"in t.internalProps.layoutMap){let i=t.internalProps.layoutMap.showHeader;t.internalProps.layoutMap.showHeader=!0,e=v(o,0,t.internalProps.layoutMap.headerLevelCount-1,t),t.internalProps.layoutMap.showHeader=i}else e=t.internalProps.transpose||"only-body"!==(null==(a=null==(l=t.internalProps.layoutMap.columnObjects)?void 0:l[o])?void 0:a.columnWidthComputeMode)&&"only-body"!==t.columnWidthComputeMode?v(o,0,t.rowCount-1,t):v(o,t.internalProps.layoutMap.getBodyRange().start.row,t.internalProps.layoutMap.getBodyRange().end.row,t);t._setColContentWidth(o,e),t.getColWidth(o)!==e&&t._clearColRangeWidthsMap(o),r?m[o]=Math.round(t._adjustColWidth(o,e)):t._setColWidth(o,t._adjustColWidth(o,e),!1,!0)}if("adaptive"===t.widthMode){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,i=0,n=0,s=t.colCount;if("only-body"===t.widthAdaptiveMode){for(let e=0;e<t.colCount;e++){let n=r&&null!=(o=m[e])?o:t.getColWidth(e);(e<t.rowHeaderLevelCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(i+=n)}n=t.rowHeaderLevelCount,s=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount}_(e-i,n,s,r,m,t)}else if(t.autoFillWidth){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,i=0,n=0;for(let e=0;e<t.colCount;e++){let s=r&&null!=(h=m[e])?h:t.getColWidth(e);(e<t.rowHeaderLevelCount+t.leftRowSeriesNumberCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(i+=s),n+=s}n<e&&n>i&&_(e-i,t.rowHeaderLevelCount+t.leftRowSeriesNumberCount,t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount,r,m,t)}if(r){for(let e=0;e<t.colCount;e++){let i=null!=(d=null!=(u=m[e])?u:t.getColWidth(e))?d:t.getColWidth(e);i!==f[e]&&t._setColWidth(e,i,!1,!0)}t.stateManager.checkFrozen();for(let e=0;e<t.colCount;e++){let i=t.getColWidth(e);i!==f[e]&&t.scenegraph.updateColWidth(e,i-f[e],!0,!0)}t.scenegraph.updateContainer({async:!0})}t.isPivotTable()&&(g.disableUseGetBodyCache(),g.disableUseHeaderPathCache())}function v(t,e,i,r,n=!1){let s=function(t,e){let i=e.getColWidthDefined(t);return e.internalProps._widthResizedColMap.has(t)?e.getColWidth(t):i}(t,r);return r.internalProps.transpose&&"auto"===s&&("only-header"===r.columnWidthComputeMode&&t>=r.rowHeaderLevelCount||"only-body"===r.columnWidthComputeMode&&t<r.rowHeaderLevelCount)&&(s=r.getDefaultColumnWidth(t)),n&&!r.internalProps.transpose?b(s,t,e,i,n,r):"number"==typeof s?s:"auto"!==s&&"string"==typeof s?r._adjustColWidth(t,r._colWidthDefineToPxWidth(s)):b(s,t,e,i,n,r)}function b(t,e,i,y,v,b){var _,x,C,w,S;let A=0,M=1,k=1;if(y-i>5e3&&(k=Math.ceil((y-i)/5e3)),b.isPivotChart()&&e>=b.rowHeaderLevelCount&&e<b.colCount-b.rightFrozenColCount){if(b.internalProps.layoutMap.indicatorsAsCol)return b.defaultColWidth;{let t=!1;"heatmap"===b.internalProps.layoutMap.getChartSpec(e,b.columnHeaderLevelCount).type&&(t=!0);let i=b.internalProps.layoutMap.getOptimunWidthForChart(e,t);if(i>0)return i}}for(let T=i;T<=y;T+=M){if(b.isPivotChart()){let t=b.internalProps.layoutMap,i=t.getAxisConfigInPivotChart(e,T);if(i){let t=a.F.getFunction("computeAxisComponentWidth")(i,b);if("number"==typeof t){A=Math.max(t,A);continue}}else if(t.isLeftBottomCorner(e,T)||t.isRightTopCorner(e,T)||t.isRightBottomCorner(e,T))continue}let i=function(t,e,i){var r,n,a,o,u,d,c,g,m,y;let v=i.getCustomRender(t,e),b=i.getCustomLayout(t,e);if(v||b){let _,x=1,C=0,w=!1,S=!1;(i.isHeader(t,e)||(null==(r=i.getBodyColumnDefine(t,e))?void 0:r.mergeCell)||i.hasCustomMerge())&&(x=(_=i.getCellRange(t,e)).end.col-_.start.col+1);let A={col:null!=(n=null==_?void 0:_.start.col)?n:t,row:null!=(a=null==_?void 0:_.start.row)?a:e,dataValue:i.getCellOriginValue(t,e),value:i.getCellValue(t,e)||"",rect:(g=t,m=e,{left:0,top:0,right:(y=i).getColWidth(g),bottom:y.getRowHeight(m),width:null,height:null}),table:i,originCol:t,originRow:e,forComputation:!0};if("react-custom-layout"===b&&(b=(null==(o=i.reactCustomLayout)?void 0:o.getCustomLayoutFunc(t,e))||f.D),(0,h.Z)(b)){let t=b(A);if(t.rootContainer){t.rootContainer=(0,p.nH)(t.rootContainer),(0,p.Jp)(t.rootContainer,0,i.getRowHeight(e));let r=t.rootContainer.attribute.width;t.rootContainer.setStage(i.scenegraph.stage),C=r>0?r:null!=(u=t.rootContainer.AABBBounds.width())?u:0,w=t.renderDefault,S=t.enableCellPadding}else C=0,w=t.renderDefault,S=t.enableCellPadding}else if("function"==typeof v){let t=v(A);C=null!=(d=null==t?void 0:t.expectedWidth)?d:0,w=null==t?void 0:t.renderDefault}else C=null!=(c=null==v?void 0:v.expectedWidth)?c:0,w=null==v?void 0:v.renderDefault;if(C=Math.ceil(C),S){let r=i._getCellStyle(t,e),n=(0,s.u)((0,l.WJ)("padding",r,t,e,i));C+=n[1]+n[3]}return{width:C/x,renderDefault:w}}}(e,T,b);if(i&&(A=Math.max(i.width,A),!i.renderDefault))continue;if("number"==typeof t&&"standard"===b.widthMode&&!v){A=Math.max(t,A);continue}let y=b.isHeader(e,T)?null==(_=b._getHeaderLayoutMap(e,T))?void 0:_.headerType:b.getBodyColumnType(e,T);if((0,o.Z)(y)&&"text"!==y&&"link"!==y&&"progressbar"!==y&&"checkbox"!==y&&"radio"!==y&&"switch"!==y&&"button"!==y){A=Math.max(A,b.getColWidthDefinedNumber(e)||0);continue}let R=0,B=b.internalProps.layoutMap;if(B.isHeader(e,T)){let t=B.getHeader(e,T);if("only-body"===(null==(x=null==t?void 0:t.define)?void 0:x.columnWidthComputeMode))continue;(0,o.Z)(null==t?void 0:t.hierarchyLevel)&&(R=(null!=(C=t.hierarchyLevel)?C:0)*("tree"===B.rowHierarchyType&&null!=(w=B.rowHierarchyIndent)?w:0),B.rowHierarchyTextStartAlignment&&!b.internalProps.headerHelper.getHierarchyIcon(e,T)&&(R+=b.internalProps.headerHelper.getHierarchyIconWidth()))}else if(b.isListTable()){M=k;let t=b.getBodyColumnDefine(e,T);if(null==t?void 0:t.tree){let t=b.dataSource.getIndexKey(b.getRecordShowIndexByCell(e,T));R=Array.isArray(t)&&b.getHierarchyState(e,T)!==r.g.none?(t.length-1)*(null!=(S=B.hierarchyIndent)?S:0):0,B.hierarchyTextStartAlignment&&!b.internalProps.bodyHelper.getHierarchyIcon(e,T)&&(R+=b.internalProps.headerHelper.getHierarchyIconWidth())}}A=Math.max(function(t,e,i,r){var a,o,h,p;let f,y=0,v=r.getCellValue(t,e),b=r._getCellStyle(t,e),_=0,x=!1;if("body"!==r.getCellLocation(t,e))x=!0;else{let i=r.getBodyColumnDefine(t,e);x=!!(null==i?void 0:i.icon)||!!(null==i?void 0:i.tree)||(null==i?void 0:i.dragOrder)}if(x){let i=r.getCellIcons(t,e);null==i||i.forEach(t=>{var e,i,r;t.positionType!==n.q0.absoluteRight&&(_+=(null!=(e=t.width)?e:0)+(null!=(i=t.marginLeft)?i:0)+(null!=(r=t.marginRight)?r:0))})}let C=1;if(r.isHeader(t,e)||(null==(a=r.getBodyColumnDefine(t,e))?void 0:a.mergeCell)||r.hasCustomMerge()){let i=r.getCellRange(t,e);C=i.end.col-i.start.col+1}let w=(0,s.u)((0,l.WJ)("padding",b,t,e,r)),S=w[1]+w[3],A=(0,l.WJ)("fontSize",b,t,e,r),M=(0,l.WJ)("fontFamily",b,t,e,r),k=(0,l.WJ)("fontWeight",b,t,e,r);if("checkbox"===i)f=(0,u.Z)(v)?v.text:v;else if("radio"===i)if((0,d.Z)(v)){f="";let i=r.getBodyColumnDefine(t,e),n=null!=(o=null==i?void 0:i.radioDirectionInCell)?o:"vertical";"vertical"===n?v.forEach(t=>{f+=((0,u.Z)(t)?t.text:t).toString()+"\n"}):"horizontal"===n&&v.forEach(t=>{f+=((0,u.Z)(t)?t.text:t).toString()})}else f=(0,u.Z)(v)?v.text:v;else if("button"===i){let i=r.getBodyColumnDefine(t,e),n=(0,m.vi)(i.text,{col:t,row:e,table:r,context:null,value:v,dataValue:r.getCellOriginValue(t,e)});f=null!=(h=null!=n?n:v)?h:""}else f=v;let T=(0,g.$)(f,r).text;if(T.length>=1&&(1!==T.length||""!==T[0])?T.forEach(t=>{y=Math.max((r.measureText(t,{fontSize:A,fontFamily:M,fontWeight:k}).width+S+4+_)/C,y)}):y=Math.max((S+4+_)/C,y),!1!==r.internalProps.limitMaxAutoWidth&&(y=Math.min("number"==typeof r.internalProps.limitMaxAutoWidth?r.internalProps.limitMaxAutoWidth:450,y)),"checkbox"===i){let i=(0,l.WJ)("size",b,t,e,r);if(y+=i,f){let i=(0,l.WJ)("spaceBetweenTextAndIcon",b,t,e,r);y+=i}}else if("radio"===i){let i=(0,l.WJ)("size",b,t,e,r),n=(0,l.WJ)("outerRadius",b,t,e,r),s=(0,c.Z)(n)?2*n:i,a=(0,l.WJ)("spaceBetweenTextAndIcon",b,t,e,r);if((0,d.Z)(v)){let i=r.getBodyColumnDefine(t,e),n=(0,l.WJ)("spaceBetweenRadio",b,t,e,r),o=null!=(p=null==i?void 0:i.radioDirectionInCell)?p:"vertical";"vertical"===o?(y+=s,y+=a):"horizontal"===o&&(y+=(s+a)*v.length,y+=n*(v.length-1))}else y+=s,f&&(y+=a)}else if("switch"===i)y=(0,l.WJ)("boxWidth",b,t,e,r);else if("button"===i){let i=(0,l.WJ)("buttonPadding",b,t,e,r);y+=2*i}return y}(e,T,y,b)+R,A),M>1&&b.bottomFrozenRowCount>0&&T<b.rowCount-b.bottomFrozenRowCount&&T+M>=b.rowCount-b.bottomFrozenRowCount&&(T=b.rowCount-b.bottomFrozenRowCount-M,M=1,k=1)}let T=b.getMinColWidth(e),R=b.getMaxColWidth(e);return A<T?T:A>R?R:(A<=0&&(A=b.defaultColWidth),A)}function _(t,e,i,r,n,s,l){var a,o,h,u;let d=0,c=[],p=[],g=0,f=new Map,m=new Map;for(let t=e;t<i;t++){let e=r&&null!=(a=n[t])?a:s.getColWidth(t),i=s.getMaxColWidth(t),l=s.getMinColWidth(t);d+=e,c.push(t),i===e?f.set(t,e):l===e&&m.set(t,e),(null==(o=s.options.customConfig)?void 0:o.shrinkSparklineFirst)&&"sparkline"===s.getBodyColumnType(t,0)&&(p.push({col:t,width:e}),g+=e-s.defaultColWidth)}if(d>t)for(let[e,i]of m){t-=i,d-=i;let r=c.indexOf(e);-1!==r&&c.splice(r,1)}else if(d<t)for(let[e,i]of f){t-=i,d-=i;let r=c.indexOf(e);-1!==r&&c.splice(r,1)}let y=t/d;if((null==(h=s.options.customConfig)?void 0:h.shrinkSparklineFirst)&&y<1&&d-t<g)for(let e=0;e<p.length;e++){let{col:i,width:a}=p[e],o=Math.floor(a-(d-t)/p.length);r?n[i]=s._adjustColWidth(i,o):l?s.scenegraph.setColWidth(i,s._adjustColWidth(i,o)):s._setColWidth(i,s._adjustColWidth(i,o),!1,!0)}else for(let e=0;e<c.length;e++){let i,a=c[e];i=e===c.length-1?t-c.reduce((t,e,i)=>{var l;return e!==a?t+(r?null!=(l=n[e])?l:s.getColWidth(a):s.getColWidth(e)):t},0):Math.round((r&&null!=(u=n[a])?u:s.getColWidth(a))*y),r?n[a]=s._adjustColWidth(a,i):l?s.scenegraph.setColWidth(a,s._adjustColWidth(a,i)):s._setColWidth(a,s._adjustColWidth(a,i),!1,!0)}}},7430:function(t,e,i){"use strict";i.d(e,{P:()=>B,Y:()=>R});var r=i(29559),n=i(44186),s=i(67203),l=i(14828),a=i(40793),o=i(13844),h=i(43735),u=i(18585),d=i(58977),c=i(70506),p=i(76349),g=i(74945),f=i(52186),m=i(47e3),y=i(12588),v=i(29539),b=i(42857),_=i(52404);let x=new v.J({}),C=new b.Y({}),w=new _.V({});function S(t,e,i,r,n,l,a,o,h,u,c,p,g,f,v){let b=(0,m.Z)(t)?t.text:t,_=(0,y.cw)(b).split("\n")||[],x=v.getColsWidth(e,r),w=(0,s.WJ)("size",n,e,i,v),S=(0,s.WJ)("outerRadius",n,e,i,v),A=(0,d.Z)(S)?2*S:w,M=0;if(l){let t=(0,s.WJ)("spaceBetweenTextAndIcon",n,e,i,v),r=x-(f[1]+f[3])-a-A-t;(0,d.Z)(S)||(S=Math.round(w/2)),C.setAttributes({text:{maxLineWidth:r,text:_,fontSize:o,fontStyle:h,fontWeight:u,fontFamily:c,lineHeight:p,wordBreak:"break-word",lineClamp:g},circle:{outerRadius:S},spaceBetweenTextAndIcon:t}),C.render(),M=C.AABBBounds.height()}else M=Math.max(w,_.length*p);return M}var A=i(11734),M=i(3687),k=i(29322);let T=new r.H({width:0,height:0,textConfig:[]});function R(t,e,i,r=!0,n){var s,l,a,o,d,c,p,f,m,y,v;"undefined"!=typeof window&&window.performance.now();let b=[],_=[];if(n)for(let r=e;r<=i;r++)b[r]=t.getRowHeight(r);let x=t.internalProps.layoutMap;t.isPivotTable()&&(x.enableUseGetBodyCache(),x.enableUseHeaderPathCache()),t.defaultHeaderRowHeight,t.defaultHeaderColWidth;let C="auto"===t.defaultHeaderRowHeight||(0,h.Z)(t.defaultHeaderRowHeight)&&t.defaultHeaderRowHeight.some(t=>"auto"===t),w=t.isAutoRowHeight(e)||"adaptive"===t.heightMode&&!1!==t.options.autoHeightInAdaptiveMode,S="auto"===t.options.defaultRowHeight;if(w||C||S){e=null!=e?e:0,i=null!=i?i:t.rowCount-1,(0===e&&i===t.rowCount-1||r)&&t._clearRowRangeHeightsMap();for(let i=e;i<t.columnHeaderLevelCount;i++){let e=0,r=t.colCount-1;if((t.isPivotTable()&&!t.isPivotChart()||t.isPivotChart()&&!t.internalProps.layoutMap.indicatorsAsCol)&&function(t,e){var i,r,n;let{layoutMap:s}=t.internalProps;if(t.internalProps.autoWrapText&&(t.isAutoRowHeight(e)||"adaptive"===t.options.heightMode))return!1;let l=s.getHeader(t.rowHeaderLevelCount,e);if("function"==typeof l.style||"function"==typeof l.icons||(null==(i=l.define)?void 0:i.headerCustomRender)||(null==(r=l.define)?void 0:r.headerCustomLayout)||"function"==typeof(null==(n=l.define)?void 0:n.icon))return!1;let a=t._getCellStyle(t.rowHeaderLevelCount,e);return"function"!=typeof a.padding&&"function"!=typeof a.fontSize&&"function"!=typeof a.lineHeight&&!0!==a.autoWrapText}(t,i)&&!(0,g.Z)(t,t.rowHeaderLevelCount,i)&&(e=0,r=t.rowHeaderLevelCount),w||"auto"===t.getDefaultRowHeight(i)){let s=B(i,e,r,t);_[i]=Math.round(s),"only-body"!==t.heightAdaptiveMode&&n||t._setRowHeight(i,s)}}for(let e=t.rowCount-t.bottomFrozenRowCount;e<=i;e++)if(w||"auto"===t.getDefaultRowHeight(e)){let i=B(e,0,t.colCount-1,t);n?_[e]=Math.round(i):t._setRowHeight(e,i)}if(!(i<t.columnHeaderLevelCount)&&(w||S))if(t.internalProps.transpose||t.isPivotTable()&&!t.internalProps.layoutMap.indicatorsAsCol||t.options.customComputeRowHeight||!function(t,e){var i,r,n;let{layoutMap:s}=t.internalProps,l=t.columnHeaderLevelCount;if((t.internalProps.autoWrapText||t.internalProps.enableLineBreak||t.isPivotChart())&&(t.isAutoRowHeight(e)||"adaptive"===t.options.heightMode))return!1;for(let e=0;e<t.colCount;e++){let a=s.getBody(e,l);if("radio"===a.cellType||"function"==typeof a.style||"function"==typeof a.icon||(null==(i=a.define)?void 0:i.customRender)||(null==(r=a.define)?void 0:r.customLayout)||"function"==typeof(null==(n=a.define)?void 0:n.icon))return!1;let o=t._getCellStyle(e,l);if("function"==typeof o.padding||"function"==typeof o.fontSize||"function"==typeof o.lineHeight||!0===o.autoWrapText)return!1}return!0}(t,e))if(t.internalProps.transpose||t.isPivotTable()&&!t.internalProps.layoutMap.indicatorsAsCol)for(let r=Math.max(e,t.columnHeaderLevelCount);r<=i;r++){let e;e=!function(t,e){var i,r,n;let{layoutMap:s}=t.internalProps;if((t.internalProps.autoWrapText||t.internalProps.enableLineBreak)&&(t.isAutoRowHeight(e)||"adaptive"===t.options.heightMode))return!1;let l=s.getBody(t.rowHeaderLevelCount,e);if("function"==typeof l.style||"function"==typeof l.icon||(null==(i=l.define)?void 0:i.customRender)||(null==(r=l.define)?void 0:r.customLayout)||"function"==typeof(null==(n=l.define)?void 0:n.icon))return!1;let a=t._getCellStyle(t.rowHeaderLevelCount,e);return"function"!=typeof a.padding&&"function"!=typeof a.fontSize&&"function"!=typeof a.lineHeight&&!0!==a.autoWrapText}(t,r)?B(r,0,t.colCount-1,t):B(r,0,t.rowHeaderLevelCount,t),n?_[r]=Math.round(e):t._setRowHeight(r,e)}else for(let r=Math.max(e,t.columnHeaderLevelCount);r<=i;r++){let e=B(r,0,t.colCount-1,t);n?_[r]=Math.round(e):t._setRowHeight(r,e)}else{!function(t,e,i,r,n){if(!r.internalProps.useOneRowHeightFillAll){for(let s=e;s<=i;s++)n?n[s]=t:r._setRowHeight(s,t);r.internalProps.useOneRowHeightFillAll=!0}}(B(t.columnHeaderLevelCount,0,t.colCount-1,t),t.columnHeaderLevelCount,t.rowCount-1-t.bottomFrozenRowCount,t,n?_:void 0);for(let e=t.rowCount-t.bottomFrozenRowCount;e<=i;e++){let i=B(e,0,t.colCount-1,t);n?_[e]=Math.round(i):t._setRowHeight(e,i)}}}else if(("adaptive"===t.heightMode||t.autoFillHeight)&&t.clearRowHeightCache(),n)for(let r=e;r<=i;r++)_[r]=t.getRowHeight(r);if((0===e&&i===t.rowCount-1||r)&&t._clearRowRangeHeightsMap(),"adaptive"===t.heightMode){t._clearRowRangeHeightsMap();let e=t.tableNoFrameHeight,i=0,r=t.rowCount;if("only-body"===t.heightAdaptiveMode){let n=t.getRowsHeight(0,t.columnHeaderLevelCount-1),s=t.isPivotChart()?t.getBottomFrozenRowsHeight():0;e=t.tableNoFrameHeight-n-s,i=t.columnHeaderLevelCount,r=t.isPivotChart()?t.rowCount-t.bottomFrozenRowCount:t.rowCount}let a=0;for(let e=i;e<r;e++)a+=n&&null!=(s=_[e])?s:t.getRowHeight(e);let o=e/a;for(let s=i;s<r;s++){let a;a=s===r-1?e-(n?_.reduce((t,e,n)=>n>=i&&n<=r-2?t+e:t,0):t.getRowsHeight(i,r-2)):Math.round((n&&null!=(l=_[s])?l:t.getRowHeight(s))*o),n?_[s]=a:t._setRowHeight(s,a,!1)}}else if(t.autoFillHeight){t._clearRowRangeHeightsMap();let e=t.tableNoFrameHeight,i=0,r=0;for(let e=0;e<t.rowCount;e++){let s=n&&null!=(a=_[e])?a:t.getRowHeight(e);(e<t.columnHeaderLevelCount||t.isPivotChart()&&e>=t.rowCount-t.bottomFrozenRowCount)&&(r+=s),i+=s}if(t.scenegraph._dealAutoFillHeightOriginRowsHeight=i,i<e&&i-r>0){let s=t.columnHeaderLevelCount,l=t.isPivotChart()?t.rowCount-t.bottomFrozenRowCount:t.rowCount,a=(e-r)/(i-r);for(let i=s;i<l;i++){let h;h=i===l-1?e-r-(n?_.reduce((t,e,i)=>i>=s&&i<=l-2?t+e:t,0):t.getRowsHeight(s,l-2)):Math.round((n&&null!=(o=_[i])?o:t.getRowHeight(i))*a),n?_[i]=h:t._setRowHeight(i,h,!1)}}}if(n){for(let r=e;r<=i;r++){let e=null!=(d=_[r])?d:t.getRowHeight(r);(0,u.Z)(e)&&t._setRowHeight(r,e)}for(let e=0;e<=t.frozenRowCount-1;e++){let i=t.getRowHeight(e);i!==(null!=(c=b[e])?c:t.getRowHeight(e))&&t.scenegraph.updateRowHeight(e,i-(null!=(p=b[e])?p:t.getRowHeight(e)),!0)}for(let e=t.rowCount-t.bottomFrozenRowCount;e<=t.rowCount-1;e++){let i=t.getRowHeight(e);i!==(null!=(f=b[e])?f:t.getRowHeight(e))&&t.scenegraph.updateRowHeight(e,i-(null!=(m=b[e])?m:t.getRowHeight(e)),!0)}for(let e=t.scenegraph.proxy.rowStart;e<=t.scenegraph.proxy.rowEnd;e++){let i=t.getRowHeight(e);i!==(null!=(y=b[e])?y:t.getRowHeight(e))&&t.scenegraph.updateRowHeight(e,i-(null!=(v=b[e])?v:t.getRowHeight(e)),!0)}}t.isPivotTable()&&(x.disableUseGetBodyCache(),x.disableUseHeaderPathCache())}function B(t,e,i,r){var g;let v;if(!(r.isAutoRowHeight(t)||"adaptive"===r.heightMode&&!1!==r.options.autoHeightInAdaptiveMode)&&"auto"!==r.getDefaultRowHeight(t))return r.getDefaultRowHeight(t);if(r.options.customComputeRowHeight){let e=r.options.customComputeRowHeight({row:t,table:r});if("number"==typeof e)return e;if("auto"!==e)return r.getDefaultRowHeight(t)}if(r.isPivotChart()&&t>=r.columnHeaderLevelCount&&t<r.rowCount-r.bottomFrozenRowCount){let e=r.internalProps.layoutMap.indicatorsAsCol,i=!1;if(r.internalProps.layoutMap.indicatorsAsCol||"heatmap"!==r.internalProps.layoutMap.getChartSpec(r.rowHeaderLevelCount,t).type||(i=!0,e=!0),e){let e=r.internalProps.layoutMap.getOptimunHeightForChart(t,i);if(e>0)return e}else{let e=r.getDefaultRowHeight(t);if((0,d.Z)(e))return e}}for(let d=e;d<=i;d++){let e=function(t,e,i){var r,n,a,o,h,u,d,g,f,m;let y=i.getCustomRender(t,e),v=i.getCustomLayout(t,e);if(y||v){let b,_=1,x=0,C=!1,w=!1;(i.isHeader(t,e)||(null==(r=i.getBodyColumnDefine(t,e))?void 0:r.mergeCell)||i.hasCustomMerge())&&(_=(b=i.getCellRange(t,e)).end.row-b.start.row+1);let S={col:null!=(n=null==b?void 0:b.start.col)?n:t,row:null!=(a=null==b?void 0:b.start.row)?a:e,dataValue:i.getCellOriginValue(t,e),value:i.getCellValue(t,e)||"",rect:(g=t,f=e,{left:0,top:0,right:(m=i).getColWidth(g),bottom:m.getRowHeight(f),width:m.getColWidth(g),height:0}),table:i,originCol:t,originRow:e,forComputation:!0};if("react-custom-layout"===v&&(v=(null==(o=i.reactCustomLayout)?void 0:o.getCustomLayoutFunc(t,e))||k.D),(0,c.Z)(v)){let e=v(S);e.rootContainer?(e.rootContainer=(0,p.nH)(e.rootContainer),(0,p.Jp)(e.rootContainer,i.getColWidth(t),0),e.rootContainer.setStage(i.scenegraph.stage),x=null!=(h=e.rootContainer.AABBBounds.height())?h:0):x=0,C=e.renderDefault,w=e.enableCellPadding}else if("function"==typeof y){let t=y(S);x=null!=(u=null==t?void 0:t.expectedHeight)?u:0,C=null==t?void 0:t.renderDefault}else x=null!=(d=null==y?void 0:y.expectedHeight)?d:0,C=null==y?void 0:y.renderDefault;if(w){let r=i._getCellStyle(t,e),n=(0,l.u)((0,s.WJ)("padding",r,t,e,i));x+=n[0]+n[2]}return{height:x/_,renderDefault:C}}}(d,t,r);if(e&&(v=(0,u.Z)(v)?Math.max(e.height,v):e.height,!e.renderDefault))continue;if(r.isPivotChart()){let e=r.internalProps.layoutMap.getAxisConfigInPivotChart(d,t);if(e){let t=o.F.getFunction("computeAxisComponentHeight")(e,r);if("number"==typeof t){v=(0,u.Z)(v)?Math.max(t,v):t;continue}}}if(r.isPivotChart()&&(r.isLeftFrozenColumn(d)&&r.isBottomFrozenRow(t)||r.isRightFrozenColumn(d)&&r.isBottomFrozenRow(t)))continue;let i=function(t,e,i,r){var o,u,d,c,p;let g=0,v=r.getCellValue(t,e),b=r._getCellStyle(t,e),_=0,k=0,R=[],B=0,P=[],E=0,I=!1;if("body"!==r.getCellLocation(t,e))I=!0;else{let i=r.getBodyColumnDefine(t,e);I=!!(null==i?void 0:i.icon)||!!(null==i?void 0:i.tree)||(null==i?void 0:i.dragOrder)}if(I){let i=r.getCellIcons(t,e);null==i||i.forEach(t=>{var e,i,r,s,l,a,o,h,u,d;t.positionType!==n.q0.absoluteRight&&t.positionType!==n.q0.inlineFront&&t.positionType!==n.q0.inlineEnd?(k+=(null!=(e=t.width)?e:0)+(null!=(i=t.marginLeft)?i:0)+(null!=(r=t.marginRight)?r:0),_=Math.max(_,null!=(s=t.height)?s:0)):t.positionType===n.q0.inlineFront?(R.push(t),B=Math.max(B,(null!=(l=t.height)?l:0)+(null!=(a=t.marginLeft)?a:0)+(null!=(o=t.marginRight)?o:0))):t.positionType===n.q0.inlineEnd&&(P.push(t),E=Math.max(E,(null!=(h=t.height)?h:0)+(null!=(u=t.marginLeft)?u:0)+(null!=(d=t.marginRight)?d:0)))})}let L=1,F=t;if(r.isHeader(t,e)||(null==(o=r.getBodyColumnDefine(t,e))?void 0:o.mergeCell)||r.hasCustomMerge()){let i=r.getCellRange(t,e);L=i.end.row-i.start.row+1,t=i.start.col,F=i.end.col}let O=(0,l.u)((0,s.WJ)("padding",b,t,e,r)),D=(0,s.WJ)("fontSize",b,t,e,r),H=(0,s.WJ)("fontStyle",b,t,e,r),z=(0,s.WJ)("fontWeight",b,t,e,r),W=null!=(u=(0,s.WJ)("lineHeight",b,t,e,r))?u:D,N=(0,s.WJ)("fontFamily",b,t,e,r),j=(0,s.WJ)("autoWrapText",b,t,e,r),G=(0,s.WJ)("lineClamp",b,t,e,r),V=(0,s.WJ)("underline",b,t,e,r),Z=null!=(d=(0,s.WJ)("underlineOffset",b,t,e,r))?d:0;if("text"!==i&&"link"!==i&&"progressbar"!==i&&"checkbox"!==i&&"radio"!==i&&"switch"!==i&&"button"!==i)g=W;else if("checkbox"===i)g=function(t,e,i,r,n,l,a,o,h,u,d,c,p,g,f){let v=(0,m.Z)(t)?t.text:t,b=(0,y.cw)(v).split("\n")||[],_=f.getColsWidth(e,r),C=(0,s.WJ)("size",n,e,i,f),w=0;if(l){let t=(0,s.WJ)("spaceBetweenTextAndIcon",n,e,i,f),r=_-(g[1]+g[3])-a-C-t;x.setAttributes({text:{maxLineWidth:r,text:b,fontSize:o,fontStyle:h,fontWeight:u,fontFamily:d,lineHeight:c,wordBreak:"break-word",lineClamp:p},icon:{width:Math.floor(C/1.4),height:Math.floor(C/1.4)},box:{width:C,height:C},spaceBetweenTextAndIcon:t}),x.render(),w=x.AABBBounds.height()}else w=Math.max(C,b.length*c);return w}(v,t,e,F,b,j,k,D,H,z,N,W,G,O,r);else if("radio"===i)g=function(t,e,i,r,n,l,a,o,u,d,c,p,g,f,m){var y;if((0,h.Z)(t)){let h=0,v=m.getBodyColumnDefine(e,i),b=(0,s.WJ)("spaceBetweenRadio",n,e,i,m),_=null!=(y=null==v?void 0:v.radioDirectionInCell)?y:"vertical";return"vertical"===_?t.forEach((s,y)=>{let v=S(s,e,i,r,n,l,a,o,u,d,c,p,g,f,m);h+=v,y!==t.length-1&&(h+=b)}):"horizontal"===_&&t.forEach(t=>{h=Math.max(S(t,e,i,r,n,l,a,o,u,d,c,p,g,f,m),h)}),h}return S(t,e,i,r,n,l,a,o,u,d,c,p,g,f,m)}(v,t,e,F,b,j,k,D,H,z,N,W,G,O,r);else if("switch"===i)p=t,g=(0,s.WJ)("boxWidth",b,p,e,r);else if("button"===i)g=function(t,e,i,r,n,l,a,o,h,u,d,c,p,g,f){let v=(0,m.Z)(t)?t.text:t,b=(0,y.cw)(v).split("\n")||[],_=f.getColsWidth(e,r),x=(0,s.WJ)("buttonPadding",n,e,i,f),S=(0,s.WJ)("buttonLineWidth",n,e,i,f),A=0;if(l){let t=_-(g[1]+g[3]);w.setAttributes({text:b,textStyle:{maxLineWidth:t,fontSize:o,fontStyle:h,fontWeight:u,fontFamily:d,lineHeight:c,wordBreak:"break-word",lineClamp:p},padding:x,panel:{visible:!0,fill:"red",stroke:"red",lineWidth:S}}),C.render(),A=C.AABBBounds.height()}else A=b.length*c+2*x;return A}(v,t,e,F,b,j,0,D,H,z,N,W,G,O,r);else{let i=(0,M.$)(v,r).text,n=r.getColsWidth(t,F);if(R.length||P.length)if(j){let t=Object.assign({text:null==v?void 0:v.toString(),fontFamily:N,fontSize:D,fontStyle:H,fontWeight:z,lineHeight:W});t.textBaseline="middle";let e=[...R.map(t=>(0,a.vQ)(t)),t,...P.map(t=>(0,a.vQ)(t))];T.setAttributes({width:n-(O[1]+O[3])-k,height:0,textConfig:e}),g=T.AABBBounds.height()}else g=0,i.forEach((t,e)=>{var n;(null==(n=r.options.customConfig)?void 0:n.multilinesForXTable)&&0!==e||(0===e&&R.length?g+=Math.max(W,B):e===i.length-1&&P.length?g+=Math.max(W,E):g+=W)});else if(j){let s=(0,f.L)(t,e,r),l=n-(O[1]+O[3])-k-s;g=((0,A.Rc)({maxLineWidth:l,text:i,fontSize:D,fontStyle:H,fontWeight:z,fontFamily:N,lineHeight:W,wordBreak:"break-word",whiteSpace:1!==i.length||j?"normal":"no-wrap",lineClamp:G}).height()||("number"==typeof W?W:D))+(V?Z:0)}else g=(null==(c=r.options.customConfig)?void 0:c.multilinesForXTable)?W:i.length*W}return(Math.max(g,_)+O[0]+O[2])/L}(d,t,r.isHeader(d,t)?null==(g=r._getHeaderLayoutMap(d,t))?void 0:g.headerType:r.getBodyColumnType(d,t),r);v=(0,u.Z)(v)?Math.max(i,v):i}if((0,u.Z)(v))return v;let b=r.getDefaultRowHeight(t);return(0,d.Z)(b)?b:r.defaultRowHeight}},92581:function(t,e,i){"use strict";i.d(e,{KP:()=>u,RW:()=>h,kl:()=>o,s8:()=>c,s9:()=>a,zO:()=>d});var r=i(8611),n=i(13844),s=i(14828),l=i(67203);function a(t,e){let{table:i}=t,r=i.internalProps.layoutMap,n=-1===e?"all":i.internalProps.columnResizeType;if("column"===n){let r=t.getColGroup(e),n=t.getColGroup(e,!0),s=t.getColGroupInBottom(e,!0);if(null==r||r.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==n||n.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==s||s.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),"adaptive"===i.widthMode&&e<i.colCount-1){let r=t.getColGroup(e+1),n=t.getColGroup(e+1,!0),s=t.getColGroupInBottom(e+1,!0);null==r||r.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==n||n.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==s||s.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))})}}else{let s,l,a,o=i.rowHeaderLevelCount,h=i.colCount-1;if("indicator"===n)if(r.indicatorsAsCol)s=r.getIndicatorKey(e,i.columnHeaderLevelCount);else{let t=r.getCellHeaderPaths(e,i.columnHeaderLevelCount-1),n=t.colHeaderPaths[t.colHeaderPaths.length-1];l=n.dimensionKey,a=n.value}else if("indicatorGroup"===n){let t=i.internalProps.layoutMap,e=t.getCellHeaderPaths(i.stateManager.columnResize.col,i.columnHeaderLevelCount),r=t.getHeadNodeByRowOrColDimensions(e.colHeaderPaths.slice(0,e.colHeaderPaths.length-1));o=r.startInTotal+i.frozenColCount,h=r.startInTotal+i.frozenColCount+r.size-1}for(let e=o;e<=h;e++){let o=t.getColGroup(e),h=t.getColGroup(e,!0),u=t.getColGroupInBottom(e,!0);if(o){if("indicator"===n){let t=r.getIndicatorKey(e,i.columnHeaderLevelCount);if(r.indicatorsAsCol&&t!==s)continue;if(!r.indicatorsAsCol){let t=r.getCellHeaderPaths(e,i.columnHeaderLevelCount-1),n=null==t?void 0:t.colHeaderPaths[t.colHeaderPaths.length-1];if(!n||l!==n.dimensionKey||a!==n.value)continue}}o.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==h||h.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==u||u.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))})}}}}function o(t,e){var i;let{table:r}=t,n=r.internalProps.layoutMap,s=r.stateManager,l=-1===e?"all":r.internalProps.rowResizeType,a,o,h,u=r.columnHeaderLevelCount,d=r.rowCount-1;if("indicator"===l)if(n.indicatorsAsCol){let t=n.getCellHeaderPaths(r.rowHeaderLevelCount-1,e),s=null==(i=t.rowHeaderPaths)?void 0:i[t.rowHeaderPaths.length-1];o=null==s?void 0:s.dimensionKey,h=null==s?void 0:s.value}else a=n.getIndicatorKey(r.rowHeaderLevelCount,e);else if("indicatorGroup"===l){let t=r.internalProps.layoutMap,i=t.getCellHeaderPaths(r.rowHeaderLevelCount,e),n=t.getHeadNodeByRowOrColDimensions(i.rowHeaderPaths.slice(0,i.rowHeaderPaths.length-1));u=n.startInTotal+r.frozenRowCount,d=n.startInTotal+r.frozenRowCount+n.size-1}let c=[{startCol:t.proxy.colStart,endCol:t.proxy.colEnd}];r.frozenColCount&&c.push({startCol:0,endCol:r.frozenColCount-1}),r.rightFrozenColCount&&c.push({startCol:r.colCount-r.rightFrozenColCount,endCol:r.colCount-1}),c.forEach(({startCol:i,endCol:c})=>{for(let p=i;p<=c;p++)if("row"===l){let i=t.highPerformanceGetCell(p,e);if("cell"!==i.role)continue;if(g(i,r.getColWidth(i.col),r.getRowHeight(i.row)),"adaptive"===r.heightMode&&e<r.rowCount-1){let i=t.highPerformanceGetCell(p,e+1);g(i,r.getColWidth(i.col),r.getRowHeight(i.row))}}else for(let e=u;e<=d;e++){if("indicator"===l){let t=n.getIndicatorKey(s.table.rowHeaderLevelCount,e);if(!n.indicatorsAsCol&&t!==a)continue;if(n.indicatorsAsCol){let t=n.getCellHeaderPaths(s.table.rowHeaderLevelCount-1,e),i=null==t?void 0:t.rowHeaderPaths[t.rowHeaderPaths.length-1];if(!i||o!==i.dimensionKey||h!==i.value)continue}}let i=t.highPerformanceGetCell(p,e);"cell"===i.role&&g(i,r.getColWidth(i.col),r.getRowHeight(i.row))}})}function h(t){var e;for(let i=t.proxy.colStart;i<=t.proxy.colEnd;i++){let r=t.getColGroup(i);null==(e=null==r?void 0:r.getChildren())||e.forEach(t=>{t.children.forEach(t=>{"chart"===t.type&&(t.cacheCanvas=null,t.addUpdateBoundTag())})})}}function u(t,e,i){i.getCell(t,e).children.forEach(t=>{"chart"===t.type&&(t.cacheCanvas=null,t.addUpdateBoundTag())})}function d(t){var e;let i=t.table;for(let r=t.proxy.colStart;r<=t.proxy.colEnd;r++){let n=t.getColGroup(r);null==(e=null==n?void 0:n.getChildren())||e.forEach(t=>{let e=t.col,r=t.row;t.children.forEach(t=>{if("chart"===t.type){t.updateData(i.getCellValue(e,r));let n=t.attribute.spec,s=n.type;if("gauge"!==s&&"rose"!==s&&"radar"!==s){let s=i.internalProps.layoutMap.getChartAxes(e,r);t.setAttribute("axes",s),n.axes=s}t.setAttribute("spec",n)}})})}p(t.rowHeaderGroup,t.table),p(t.colHeaderGroup,t.table),p(t.rightFrozenGroup,t.table),p(t.bottomFrozenGroup,t.table)}function c(t,e){let i=t.table;if(i.isPivotChart()){let n=i._selectedDataItemsInChart.length;if((null===e||0===(null==e?void 0:e.length)||0===Object.keys(e).length)&&0===n)return;let s=[];if(Array.isArray(e))e.forEach(t=>{if(t&&0!==t.key&&Object.keys(t).length>0){let e={};for(let i in t)i.startsWith("VGRAMMAR_")||i.startsWith("__VCHART")||(e[i]=t[i]);s.push(e)}});else if(e&&0!==e.key&&Object.keys(e).length>0){let t={};for(let i in e)i.startsWith("VGRAMMAR_")||i.startsWith("__VCHART")||(t[i]=e[i]);s.push(t)}(0,r.X)(i._selectedDataItemsInChart,s)||(i._selectedDataItemsInChart=s,i.internalProps.layoutMap.updateDataStateToChartInstance(),h(t),i.scenegraph.updateNextFrame())}}function p(t,e){t.forEachChildren(t=>{"column"===t.role&&t.forEachChildren(t=>{var i;if("cell"===t.role){let r=!1;if(t.forEachChildren(t=>"axis"===t.name&&(r=!0,!0)),r){let r=e.internalProps.layoutMap.getAxisConfigInPivotChart(t.col,t.row),a=e._getCellStyle(t.col,t.row),o=(0,s.u)((0,l.WJ)("padding",a,t.col,t.row,e)),h=new(n.F.getComponent("axis"))(r,t.attribute.width,t.attribute.height,null!=(i=r.__vtablePadding)?i:o,e);t.clear(),t.appendChild(h.component),h.overlap()}}})})}function g(t,e,i){t.forEachChildren(t=>{"chart"===t.type&&(t.cacheCanvas=null,t.setAttributes({width:Math.ceil(e-t.attribute.cellPadding[3]-t.attribute.cellPadding[1]),height:Math.ceil(i-t.attribute.cellPadding[0]-t.attribute.cellPadding[2])}))})}},3687:function(t,e,i){"use strict";i.d(e,{$:()=>s});var r=i(58853),n=i(12588);function s(t,e){var i,s;let l,a=!1;for((0,r.Z)(t)&&t.length>(e.options.maxCharactersNumber||200)&&(t=t.slice(0,e.options.maxCharactersNumber||200)+"…",a=!0),l=e.internalProps.enableLineBreak||(null==(i=e.options.customConfig)?void 0:i.multilinesForXTable)?(0,n.m7)(t).replace(/\r?\n/g,"\n").replace(/\r/g,"\n").split("\n")||[]:[(0,n.m7)(t)];l.length&&l.length>1&&!l[l.length-1];)l.pop();if((null==(s=e.options.customConfig)?void 0:s.multilinesForXTable)&&!e.internalProps.autoWrapText)for(;l.length&&l.length>1&&!l[0];)l.shift();return{text:l,moreThanMaxCharacters:a}}},55675:function(t,e,i){"use strict";i.d(e,{d:()=>n});var r=i(61482);function n(t,e,i,n){var s,l,a,o,h,u,d,c,p,g,f,m,y,v,b,_,x,C;let w=null!=(l=null==(s=null==i?void 0:i.group)?void 0:s.strokeArrayWidth)?l:void 0;return n.theme.cellInnerBorder||!(0,r.z5)(n.theme.frameStyle.borderLineWidth)||(0,r.KV)(n.theme.frameStyle.borderLineWidth)||(0===t&&((w=null!=w?w:[null==(a=null==i?void 0:i.group)?void 0:a.lineWidth,null==(o=null==i?void 0:i.group)?void 0:o.lineWidth,null==(h=null==i?void 0:i.group)?void 0:h.lineWidth,null==(u=null==i?void 0:i.group)?void 0:u.lineWidth])[3]=0),t===n.colCount-1&&((w=null!=w?w:[null==(d=null==i?void 0:i.group)?void 0:d.lineWidth,null==(c=null==i?void 0:i.group)?void 0:c.lineWidth,null==(p=null==i?void 0:i.group)?void 0:p.lineWidth,null==(g=null==i?void 0:i.group)?void 0:g.lineWidth])[1]=0),0===e&&((w=null!=w?w:[null==(f=null==i?void 0:i.group)?void 0:f.lineWidth,null==(m=null==i?void 0:i.group)?void 0:m.lineWidth,null==(y=null==i?void 0:i.group)?void 0:y.lineWidth,null==(v=null==i?void 0:i.group)?void 0:v.lineWidth])[0]=0),e===n.rowCount-1&&((w=null!=w?w:[null==(b=null==i?void 0:i.group)?void 0:b.lineWidth,null==(_=null==i?void 0:i.group)?void 0:_.lineWidth,null==(x=null==i?void 0:i.group)?void 0:x.lineWidth,null==(C=null==i?void 0:i.group)?void 0:C.lineWidth])[2]=0)),w}},35137:function(t,e,i){"use strict";function r(t,e,i,n,s,l,a="left",o="middle",h=[0,0,0,0],u=0,d=0,c=0,p=0){let g=t+h[3]+u;"right"===a||"end"===a?g=t+i-s-h[1]-d:"center"===a&&(g=t+(i-s+u-d)/2);let f=e+h[0]+c;return"bottom"===o||"alphabetic"===o||"ideographic"===o?f=e+n-l-h[2]-p:"middle"===o&&(f=e+(n-l+c-p)/2),{x:g,y:f}}function n(t,e,i,r,n){let s=!1,l=!1,a=!1,o=!1,h=!1,u=!1,d=!1,c=!1,p=!1;return t<=n.frozenColCount-1&&e<=n.frozenRowCount-1&&(u=!0),i>=n.colCount-n.rightFrozenColCount&&e<=n.frozenRowCount-1&&(d=!0),t<=n.frozenColCount-1&&r>=n.rowCount-n.bottomFrozenRowCount&&(p=!0),i>=n.colCount-n.rightFrozenColCount&&r>=n.rowCount-n.bottomFrozenRowCount&&(c=!0),t<=n.frozenColCount-1&&r>=n.frozenRowCount&&e<=n.rowCount-n.bottomFrozenRowCount-1&&(s=!0),i>=n.colCount-n.rightFrozenColCount&&r>=n.frozenRowCount&&e<=n.rowCount-n.bottomFrozenRowCount-1&&(l=!0),e<=n.frozenRowCount-1&&i>=n.frozenColCount&&t<=n.colCount-n.rightFrozenColCount-1&&(a=!0),r>=n.rowCount-n.bottomFrozenRowCount&&i>=n.frozenColCount&&t<=n.colCount-n.rightFrozenColCount-1&&(o=!0),t<=n.colCount-n.rightFrozenColCount-1&&i>=n.frozenColCount&&e<=n.rowCount-n.bottomFrozenRowCount-1&&r>=n.frozenRowCount&&(h=!0),{needRowHeader:s,needRightRowHeader:l,needColumnHeader:a,needBottomColumnHeader:o,needBody:h,needCornerHeader:u,needRightTopCornerHeader:d,needLeftBottomCornerHeader:p,needRightBottomCornerHeader:c}}i.d(e,{L:()=>n,W:()=>r})},46936:function(t,e,i){"use strict";function r(t,e,i){t.then(()=>{i(),e.scenegraph.updateNextFrame()}).catch(t=>{})}i.d(e,{K:()=>r})},74945:function(t,e,i){"use strict";function r(t,e,i){var r;if(t.internalProps.customMergeCell){let r=t.getCustomMerge(e,i);if(r)return r.range}if(!t.internalProps.enableTreeNodeMerge&&!t.isHeader(e,i)&&!(null==(r=t.getBodyColumnDefine(e,i))?void 0:r.mergeCell))return!1;let n=t.getCellRange(e,i);return(n.start.col!==n.end.col||n.start.row!==n.end.row)&&n}i.d(e,{Z:()=>r})},52186:function(t,e,i){"use strict";i.d(e,{L:()=>l});var r=i(18585),n=i(43735),s=i(73664);function l(t,e,i){var l,a,o,h,u;let d=0,c=i.internalProps.layoutMap;if(c.isHeader(t,e)){let n=c.getHeader(t,e);(0,r.Z)(null==n?void 0:n.hierarchyLevel)&&(d=(null!=(l=n.hierarchyLevel)?l:0)*("tree"===c.rowHierarchyType&&null!=(a=c.rowHierarchyIndent)?a:0),c.rowHierarchyTextStartAlignment&&!i.internalProps.headerHelper.getHierarchyIcon(t,e)&&(d+=i.internalProps.headerHelper.getHierarchyIconWidth()))}else if(i.internalProps.groupBy||(null==(o=i.getBodyColumnDefine(t,e))?void 0:o.tree)){let r=i.dataSource.getIndexKey(i.getRecordShowIndexByCell(t,e)),l=null!=(h=i.dataSource.getGroupLength())?h:0,a=(0,n.Z)(r)?r.length-1:0;l>0&&a===l&&(a=0),d=Array.isArray(r)&&i.getHierarchyState(t,e)!==s.g.none?a*(null!=(u=c.hierarchyIndent)?u:0):0,c.hierarchyTextStartAlignment&&!i.internalProps.bodyHelper.getHierarchyIcon(t,e)&&(d+=i.internalProps.bodyHelper.getHierarchyIconWidth())}return d}},67203:function(t,e,i){"use strict";i.d(e,{WJ:()=>n,vp:()=>s});var r=i(18585);function n(t,e,i,n,s){let l=e&&(0,r.Z)(e[t])?e[t]:void 0;return"function"==typeof l?l({col:i,row:n,table:s,value:s.getCellValue(i,n),dataValue:s.getCellOriginValue(i,n),cellHeaderPaths:s.getCellHeaderPaths(i,n)}):l}function s(t,e,i,n,s){let l=e&&(0,r.Z)(e[t])?e[t]:void 0;if("function"==typeof l)return l({col:i,row:n,table:s,value:s.getCellValue(i,n),dataValue:s.getCellOriginValue(i,n),cellHeaderPaths:s.getCellHeaderPaths(i,n)})}},9727:function(t,e,i){"use strict";function r(t,e,i,r){let n,s,l=t/e;return l>i/r?(r-(s=(n=i)/l))/2:(i-(n=(s=r)*l))/2,{width:n,height:s}}i.d(e,{f:()=>r})},14828:function(t,e,i){"use strict";i.d(e,{u:()=>a});var r=i(70749),n=i(58977),s=i(58853),l=i(43735);function a(t){var e,i,a,o;if((0,n.Z)(t)||(0,s.Z)(t)||(0,l.Z)(t)){let e=(0,r.dj)(t);return"number"==typeof e||"string"==typeof e?e=[e,e,e,e]:Array.isArray(e)&&(e=e.slice(0)),e}return t&&(isFinite(t.bottom)||isFinite(t.left)||isFinite(t.right)||isFinite(t.top))?[null!=(e=t.top)?e:0,null!=(i=t.right)?i:0,null!=(a=t.bottom)?a:0,null!=(o=t.left)?o:0]:[0,0,0,0]}},40793:function(t,e,i){"use strict";i.d(e,{vQ:()=>x,qs:()=>C,M4:()=>S,Zl:()=>w,Bg:()=>_,Rd:()=>b});var r=i(64103),n=i(29559),s=i(44186),l=i(26771),a=i(28996);class o extends l.Z{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new l.Z({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new l.Z({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._centerGroup=new l.Z({pickable:!1,fill:!1,stroke:!1}),this._centerGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._centerGroup)}setCellContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}addLeftOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._leftGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth((null!=(i=t.attribute.marginLeft)?i:0)+(null!=(r=t.attribute.marginRight)?r:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._rightGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth((null!=(i=t.attribute.marginLeft)?i:0)+(null!=(r=t.attribute.marginRight)?r:0)+t.attribute.width)}addContent(t){let e=this._centerGroup.lastChild;e&&t.setAttributes({x:e.attribute.x+e.AABBBounds.width()}),this._centerGroup.appendChild(t),t instanceof r.x&&(this._centerGroup.setAttribute("pickable",!1),t.setAttribute("textAlign","left"))}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){let i=this._centerGroup.width;this._cellWidth=t+e+i,this.setAttribute("width",this._cellWidth)}else{let i=this._cellWidth-t-e;this.updateCenterLayout(i);let r=this._centerGroup.width;this._cellWidth=t+e+r,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();let i=this._leftGroup.height,r=this._rightGroup.height,n=this._centerGroup.height;this._cellHeight=Math.max(i,r,n),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._centerGroup.forEachChildren(t=>{(t instanceof a.J||t instanceof a.V)&&(e-=t.AABBBounds.width())});let i=this._centerGroup.getChildByName("text");i instanceof n.H?i.setAttribute("width",e):i instanceof r.x&&i.setAttribute("maxLineWidth",e);let s=0;this._centerGroup.forEachChildren(t=>{t.setAttribute("x",s),s+=t.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._centerGroup.setAttribute("x",this._leftGroup.width),"left"===this._align||"start"===this._align?this.setAttribute("dx",0):"center"===this._align?this.setAttribute("dx",-this.attribute.width/2):"right"!==this._align&&"end"!==this._align||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){"top"===this._baseline?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._centerGroup.setAttribute("y",0)):"middle"===this._baseline?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._centerGroup.setAttribute("y",this._cellHeight/2-this._centerGroup.height/2)):"bottom"===this._baseline&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._centerGroup.setAttribute("y",this._cellHeight-this._centerGroup.height))}updateWidth(t){this._cellWidth=t,this._originCellWidth=t,this.layout()}updateHeight(t){this._cellHeight=t,this._cellWidth=this._originCellWidth;let e=this.getChildByName("text",!0);e&&e.setAttribute("heightLimit",t),this.layout()}}var h=i(74945),u=i(52186),d=i(58977),c=i(18585),p=i(91212),g=i(33657),f=i(3687),m=i(76349),y=i(75382),v=i(99506);function b(t,e,i,s,l,a,h,p,g,y,v,b,C,w,M){var k,T,R,B,P,E,I,L,F;let O,D=0,H=0,z=0;if(Array.isArray(e)&&0!==e.length){let c,{inlineFrontIcons:m,inlineEndIcons:k,contentLeftIcons:T,contentRightIcons:R,leftIconWidth:W,rightIconWidth:N,absoluteRightIconWidth:j}=S(e,t,M,C);if(D=W,H=N,z=j,0===m.length&&0===k.length){let e=0;(0,d.Z)(C.theme._contentOffset)&&("left"===v?e=C.theme._contentOffset:"right"===v&&(e=-C.theme._contentOffset));let n=M?(0,u.L)(M.start.col,M.start.row,C):(0,u.L)(t.col,t.row,C),{text:o,moreThanMaxCharacters:m}=(0,f.$)(i,C),b={text:1===o.length?o[0]:o,moreThanMaxCharacters:m,maxLineWidth:l?1/0:g-(s[1]+s[3])-D-H-n,textBaseline:"top",heightLimit:!1!==(null==(B=C.options.customConfig)?void 0:B.limitContentHeight)&&(!a||(null==(P=C.options.customConfig)?void 0:P.multilinesForXTable))?y-Math.floor(s[0]+s[2]):-1,pickable:!1,autoWrapText:h,lineClamp:p,wordBreak:"break-word",whiteSpace:!1===(null==(E=C.options.customConfig)?void 0:E.limitContentHeight)||1!==o.length||h?"normal":"no-wrap",dx:("left"===v?T.length?0:n:0)+e,keepCenterInLine:!0},_=new r.x(w.text?Object.assign({},w.text,b):b);_.name="text",c=_}else{let e=Object.assign({text:null==i?void 0:i.toString()},(null==(F=null==(L=null==(I=t.parent)?void 0:I.theme)?void 0:L.userTheme)?void 0:F.text)||{});w.text&&Object.assign(e,w.text),e.textBaseline="middle";let r=[...m.map(t=>x(t)),e,...k.map(t=>x(t))];r[0].textAlign=v;let o=new n.H({width:l?0:g-(s[1]+s[3])-D-H,height:a&&h?0:Math.ceil(y-(s[0]+s[2])),textConfig:r,verticalDirection:a&&h?"top":b,ellipsis:e.ellipsis});o.name="text",c=o,o.bindIconEvent(),M&&(M.start.col!==M.end.col||M.start.row!==M.end.row)&&(o.onBeforeAttributeUpdate=A)}if(0!==T.length||0!==R.length){let e=new o({x:0,y:0,fill:!1,stroke:!1,pickable:!1});e.name="content",e.setCellContentOption({autoWidth:l,autoHeight:a,cellWidth:g-(s[1]+s[3])-D-H,cellHeight:y-(s[0]+s[2]),align:v,baseline:b});let i={addedHierarchyOffset:0};T.forEach(r=>{let n=_(r,void 0,t.col,t.row,M,C,i);n.role="icon-content-left",n.name=r.name,e.addLeftOccupyingIcon(n)}),R.forEach(r=>{let n=_(r,void 0,t.col,t.row,M,C,i);n.role="icon-content-right",n.name=r.name,e.addRightOccupyingIcon(n)}),e.addContent(c),t.appendChild(e),e.layout(),O=e.AABBBounds.width(),e.AABBBounds.height()}else t.firstChild?t.insertBefore(c,t.firstChild):t.appendChild(c),O=c.AABBBounds.width(),c.AABBBounds.height()}else if((0,c.Z)(i)){let{text:e,moreThanMaxCharacters:n}=(0,f.$)(i,C),o=M?(0,u.L)(M.start.col,M.start.row,C):(0,u.L)(t.col,t.row,C),c=0;(0,d.Z)(C.theme._contentOffset)&&("left"===v?c=C.theme._contentOffset:"right"===v&&(c=-C.theme._contentOffset));let m={text:1===e.length?e[0]:e,moreThanMaxCharacters:n,maxLineWidth:l?1/0:g-(s[1]+s[3]+o),textBaseline:"top",autoWrapText:h,lineClamp:p,wordBreak:"break-word",heightLimit:!1!==(null==(k=C.options.customConfig)?void 0:k.limitContentHeight)&&(!a||(null==(T=C.options.customConfig)?void 0:T.multilinesForXTable))?y-Math.floor(s[0]+s[2]):-1,pickable:!1,dx:("left"===v?o:0)+c,whiteSpace:!1===(null==(R=C.options.customConfig)?void 0:R.limitContentHeight)||1!==e.length||h?"normal":"no-wrap",keepCenterInLine:!0},_=new r.x(w.text?Object.assign({},w.text,m):m);_.name="text",_.textBaseline=b,t.appendChild(_),O=_.AABBBounds.width(),_.AABBBounds.height()}let W=l?D+O+H:g-(s[1]+s[3]),N=y-(s[0]+s[2]);t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+s[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+W-H+s[3]):"icon-absolute-right"===t.role?t.setAttribute("x",t.attribute.x+W-z+s[3]+s[1]):"content"!==t.name&&"text"!==t.name||("center"===v&&"richtext"!==t.type?t.setAttribute("x",s[3]+D+(W-D-H)/2):"right"===v&&"richtext"!==t.type?t.setAttribute("x",s[3]+W-H):t.setAttribute("x",s[3]+D))}),t.forEachChildren(t=>{t.name!==m.FH&&("middle"===b?t.setAttribute("y",s[0]+(N-t.AABBBounds.height())/2):"bottom"===b?t.setAttribute("y",s[0]+N-t.AABBBounds.height()):t.setAttribute("y",s[0]))}),t.setAttributes({width:W+s[1]+s[3],height:N+s[0]+s[2]})}function _(t,e,i,r,n,l,o){var h,c,g,f,m,y;if(!t)return;let v={};"image"===t.type?(t.isGif&&(v.gif=t.src),v.image=t.src):("svg"===t.type||"svg"in t)&&(v.image=t.svg),v.width=t.width,v.height=t.height,v.visibleTime=null!=(h=t.visibleTime)?h:"always",v.funcType=t.funcType,v.interactive=t.interactive,v.isGif=t.isGif;let b,_=0;return(!o||0===(null==o?void 0:o.addedHierarchyOffset))&&(0,d.Z)(i)&&(0,d.Z)(r)&&l&&(t.funcType===s.cI.collapse||t.funcType===s.cI.expand||t.positionType===s.q0.contentLeft||t.positionType===s.q0.contentRight)&&(_=n?(0,u.L)(n.start.col,n.start.row,l):(0,u.L)(i,r,l),o&&(o.addedHierarchyOffset=1)),v.marginLeft=(null!=(c=t.marginLeft)?c:0)+_,v.marginRight=null!=(g=t.marginRight)?g:0,!1===t.interactive&&(v.pickable=!1),t.hover&&(v.backgroundWidth=null!=(f=t.hover.width)?f:t.width,v.backgroundHeight=null!=(m=t.hover.width)?m:t.width,v.backgroundColor=null!=(y=t.hover.bgColor)?y:"rgba(22,44,66,0.2)",v.hoverImage=t.hover.image),t.cursor&&(v.cursor=t.cursor),"shape"in t&&"circle"===t.shape&&(v.shape=t.shape),e?(e.setAttributes(v),e.loadImage(v.image),e.tooltip=t.tooltip,e.name=t.name,e):("text"===t.type?(v.text=t.content,(0,p.Z)(v,t.style),(b=new a.V(v)).tooltip=t.tooltip):(b=new a.J(v)).tooltip=t.tooltip,b.name=t.name,b)}function x(t){var e,i,r,n,s,l;let a={};return"image"===t.type?a.image=t.src:("svg"===t.type||"svg"in t)&&(a.image=t.svg),a.visibleTime=null!=(e=t.visibleTime)?e:"always",a.funcType=t.funcType,a.id=t.name,a.width=t.width,a.height=t.height,(t.marginRight||t.marginLeft)&&(a.margin=[0,null!=(i=t.marginRight)?i:0,0,null!=(r=t.marginLeft)?r:0]),t.hover&&(a.backgroundWidth=null!=(n=t.hover.width)?n:t.width,a.backgroundHeight=null!=(s=t.hover.height)?s:t.height,a.backgroundShowMode="hover",a.hoverImage=t.hover.image,a.backgroundStroke=!1,a.backgroundFill=null!=(l=t.hover.bgColor)?l:"rgba(22,44,66,0.2)"),t.cursor&&(a.cursor=t.cursor),a.tooltip=t.tooltip,a}function C(t,e,i,s,l,a,o,u,d){var c,p,f,y;let b;(0,g.Z)(t.contentWidth)&&(s=e-(null!=(c=t.contentWidth)?c:t.attribute.width));let _,x=0,C=0,w=0,S=0;t.forEachChildren(t=>{var e,i,r,n;"icon-left"===t.role?(x+=t.AABBBounds.width()+(null!=(e=t.attribute.marginLeft)?e:0)+(null!=(i=t.attribute.marginRight)?i:0),C=Math.max(C,t.AABBBounds.height())):"icon-right"===t.role&&(w+=t.AABBBounds.width()+(null!=(r=t.attribute.marginLeft)?r:0)+(null!=(n=t.attribute.marginRight)?n:0),S=Math.max(S,t.AABBBounds.height()))});let A=t.getChildByName("text"),M=t.getChildByName("content");A instanceof r.x?(_=A.AABBBounds.height(),A.setAttribute("maxLineWidth",e-x-w-(a[1]+a[3])-(null!=(p=A.attribute.dx)?p:0)-(null!=(f=d.table.theme._contentOffset)?f:0)),b=A.AABBBounds.height()):A instanceof n.H?(_=A.AABBBounds.height(),A.setAttribute("width",e-x-w-(a[1]+a[3])),b=A.AABBBounds.height()):M&&(_=M.AABBBounds.height(),M.updateWidth(e-x-w-(a[1]+a[3])),b=M.AABBBounds.height());let k=Math.round(Math.max(C,S,_)+a[0]+a[2]);if(t.forEachChildren(i=>{var r;if("icon-left"===i.role);else if("icon-right"===i.role)i.setAttribute("x",i.attribute.x+s);else if("icon-absolute-right"===i.role)i.setAttribute("x",i.attribute.x+s);else if("content"===i.name||"text"===i.name&&"richtext"!==i.type){let t=null!=(r=i.attribute.textAlign)?r:o;"center"===t?i.setAttribute("x",a[3]+x+(e-(a[1]+a[3])-x-w)/2):"right"===t&&i.setAttribute("x",a[3]+e-(a[1]+a[3])-w)}else"mark"===i.name&&i.setAttribute("x",t.attribute.width)}),l){let e=Math.max(C,b,S);if(function(t,e,i,r){let n=t.table,s=(0,h.Z)(n,e.col,e.row);if(s&&s.end.row-s.start.row){r/=s.end.row-s.start.row+1,i/=s.end.row-s.start.row+1;for(let t=s.start.row;t<=s.end.row;t++){let e=n.getRowHeight(t);if(e===r&&i!==e||i>e)return!0}}else{let t=n.getRowHeight(e.row);if(t===r&&i!==t||i>t)return!0}return!1}(d,t,Math.round(e+a[0]+a[2]),k))return d.table.hasListeners(v.B.AFTER_UPDATE_CELL_CONTENT_WIDTH)&&d.table.fireListeners(v.B.AFTER_UPDATE_CELL_CONTENT_WIDTH,{col:t.col,row:t.row,cellHeight:i,cellGroup:t,padding:a,textBaseline:u}),!0;e=(null!=(y=t.contentHeight)?y:i)-(a[0]+a[2]),t.forEachChildren(t=>{"rect"!==t.type&&"chart"!==t.type&&t.name!==m.FH&&("mark"===t.name?t.setAttribute("y",0):"middle"===u?t.setAttribute("y",a[0]+(e-t.AABBBounds.height())/2):"bottom"===u?t.setAttribute("y",a[0]+e-t.AABBBounds.height()):t.setAttribute("y",a[0]))})}else"middle"!==u&&"bottom"!==u||t.forEachChildren(t=>{"rect"!==t.type&&"chart"!==t.type&&t.name!==m.FH&&("mark"===t.name?t.setAttribute("y",0):"middle"===u?t.setAttribute("y",(i-a[2]+a[0]-t.AABBBounds.height())/2):"bottom"===u?t.setAttribute("y",i-t.AABBBounds.height()-a[2]):t.setAttribute("y",a[0]))});return d.table.hasListeners(v.B.AFTER_UPDATE_CELL_CONTENT_WIDTH)&&d.table.fireListeners(v.B.AFTER_UPDATE_CELL_CONTENT_WIDTH,{col:t.col,row:t.row,cellHeight:i,cellGroup:t,padding:a,textBaseline:u}),!1}function w(t,e,i,s,l,a,o,h){var u;let d=e-Math.floor(l[0]+l[2]),c=t.getChildByName("text");c instanceof r.x&&!s?c.setAttributes({heightLimit:!1===(null==(u=h.options.customConfig)?void 0:u.limitContentHeight)?-1:d}):c instanceof n.H&&!s?c.setAttributes({height:d}):t.getChildByName("content")&&t.getChildByName("content").updateHeight(d),t.forEachChildren(t=>{t.setAttribute("dy",0),"rect"===t.type||"chart"===t.type||t.name===m.FH||("mark"===t.name?t.setAttribute("y",0):"middle"===o?t.setAttribute("y",l[0]+(d-t.AABBBounds.height())/2):"bottom"===o?t.setAttribute("y",l[0]+d-t.AABBBounds.height()):t.setAttribute("y",l[0]))})}function S(t,e,i,r){let n=[],l=[],a=[],o=[],h=[],u=[],d=[],c=[],p=0,g=0,f=0,m=0,y=0,v=0;return t.forEach(t=>{switch(t.positionType){case s.q0.left:n.push(t);break;case s.q0.right:l.push(t);break;case s.q0.contentLeft:a.push(t);break;case s.q0.contentRight:o.push(t);break;case s.q0.absoluteRight:c.push(t);break;case s.q0.inlineFront:h.push(t);break;case s.q0.inlineEnd:u.push(t)}}),n.forEach(t=>{var n,s,l;let a=_(t,void 0,e.col,e.row,i,r);a.role="icon-left",a.name=t.name,a.setAttribute("x",p+(null!=(n=a.attribute.marginLeft)?n:0)),p+=a.AABBBounds.width()+(null!=(s=a.attribute.marginLeft)?s:0)+(null!=(l=a.attribute.marginRight)?l:0),g=Math.max(g,a.AABBBounds.height()),e.appendChild(a)}),l.forEach(t=>{var n,s,l;let a=_(t,void 0,e.col,e.row,i,r);a.role="icon-right",a.name=t.name,a.setAttribute("x",f+(null!=(n=a.attribute.marginLeft)?n:0)),f+=a.AABBBounds.width()+(null!=(s=a.attribute.marginLeft)?s:0)+(null!=(l=a.attribute.marginRight)?l:0),m=Math.max(m,a.AABBBounds.height()),e.appendChild(a)}),d.forEach(t=>{var n,s,l;let a=_(t,void 0,e.col,e.row,i,r);a.role="icon-absolute-left",a.name=t.name,a.setAttribute("x",y+(null!=(n=a.attribute.marginLeft)?n:0)),y+=a.AABBBounds.width()+(null!=(s=a.attribute.marginLeft)?s:0)+(null!=(l=a.attribute.marginRight)?l:0),e.appendChild(a)}),c.forEach(t=>{var n,s,l;let a=_(t,void 0,e.col,e.row,i,r);a.role="icon-absolute-right",a.name=t.name,a.setAttribute("x",v+(null!=(n=a.attribute.marginLeft)?n:0)),v+=a.AABBBounds.width()+(null!=(s=a.attribute.marginLeft)?s:0)+(null!=(l=a.attribute.marginRight)?l:0),e.appendChild(a)}),{leftIcons:n,rightIcons:l,contentLeftIcons:a,contentRightIcons:o,inlineFrontIcons:h,inlineEndIcons:u,absoluteLeftIcons:d,absoluteRightIcons:c,leftIconWidth:p,leftIconHeight:g,rightIconWidth:f,rightIconHeight:m,absoluteLeftIconWidth:y,absoluteRightIconWidth:v}}function A(t,e){if(t.hasOwnProperty("hoverIconId")){if(this.skipMergeUpdate)return;let e=(0,y.J$)(this);if(!e||!e.stage)return;let i=e.stage.table;this.skipAttributeUpdate=!0;let{mergeStartCol:r,mergeEndCol:n,mergeStartRow:s,mergeEndRow:l}=e;if((0,c.Z)(r)&&(0,c.Z)(n)&&(0,c.Z)(s)&&(0,c.Z)(l)&&(r!==n||s!==l)){for(let a=r;a<=n;a++)for(let r=s;r<=l;r++){if(a===e.col&&r===e.row){if(t.hoverIconId!==this.attribute.hoverIconId){let e=this._frameCache.icons.get(t.hoverIconId);this.updateHoverIconState(e)}continue}let n=i.scenegraph.highPerformanceGetCell(a,r);if("cell"===n.role){let e=n.getChildByName(this.name,!0);if(!e||e.skipAttributeUpdate)continue;t.hoverIconId!==e.attribute.hoverIconId&&(e.setAttribute("hoverIconId",t.hoverIconId),n.addUpdateBoundTag())}}this.skipAttributeUpdate=void 0}}}},11734:function(t,e,i){"use strict";i.d(e,{QC:()=>w,ZP:()=>b,Rc:()=>k,sb:()=>A,fg:()=>S});var r=i(99262),n=i(46919),s=i(36081),l=i(25496),a=i(91018),o=i(64103),h=i(18585),u=i(29753),d=i(58853),c=i(43735);let p=t=>{let e=t.charCodeAt(0),i=2===t.length?t.charCodeAt(1):0,r=e;return 55296<=e&&e<=56319&&56320<=i&&i<=57343&&(e&=1023,i&=1023,r=(e<<10|i)+65536),12288===r||65281<=r&&r<=65376||65504<=r&&r<=65510?"F":8361===r||65377<=r&&r<=65470||65474<=r&&r<=65479||65482<=r&&r<=65487||65490<=r&&r<=65495||65498<=r&&r<=65500||65512<=r&&r<=65518?"H":4352<=r&&r<=4447||4515<=r&&r<=4519||4602<=r&&r<=4607||9001<=r&&r<=9002||11904<=r&&r<=11929||11931<=r&&r<=12019||12032<=r&&r<=12245||12272<=r&&r<=12283||12289<=r&&r<=12350||12353<=r&&r<=12438||12441<=r&&r<=12543||12549<=r&&r<=12589||12593<=r&&r<=12686||12688<=r&&r<=12730||12736<=r&&r<=12771||12784<=r&&r<=12830||12832<=r&&r<=12871||12880<=r&&r<=13054||13056<=r&&r<=19903||19968<=r&&r<=42124||42128<=r&&r<=42182||43360<=r&&r<=43388||44032<=r&&r<=55203||55216<=r&&r<=55238||55243<=r&&r<=55291||63744<=r&&r<=64255||65040<=r&&r<=65049||65072<=r&&r<=65106||65108<=r&&r<=65126||65128<=r&&r<=65131||110592<=r&&r<=110593||127488<=r&&r<=127490||127504<=r&&r<=127546||127552<=r&&r<=127560||127568<=r&&r<=127569||131072<=r&&r<=194367||177984<=r&&r<=196605||196608<=r&&r<=262141?"W":32<=r&&r<=126||162<=r&&r<=163||165<=r&&r<=166||172===r||175===r||10214<=r&&r<=10221||10629<=r&&r<=10630?"Na":161===r||164===r||167<=r&&r<=168||170===r||173<=r&&r<=174||176<=r&&r<=180||182<=r&&r<=186||188<=r&&r<=191||198===r||208===r||215<=r&&r<=216||222<=r&&r<=225||230===r||232<=r&&r<=234||236<=r&&r<=237||240===r||242<=r&&r<=243||247<=r&&r<=250||252===r||254===r||257===r||273===r||275===r||283===r||294<=r&&r<=295||299===r||305<=r&&r<=307||312===r||319<=r&&r<=322||324===r||328<=r&&r<=331||333===r||338<=r&&r<=339||358<=r&&r<=359||363===r||462===r||464===r||466===r||468===r||470===r||472===r||474===r||476===r||593===r||609===r||708===r||711===r||713<=r&&r<=715||717===r||720===r||728<=r&&r<=731||733===r||735===r||768<=r&&r<=879||913<=r&&r<=929||931<=r&&r<=937||945<=r&&r<=961||963<=r&&r<=969||1025===r||1040<=r&&r<=1103||1105===r||8208===r||8211<=r&&r<=8214||8216<=r&&r<=8217||8220<=r&&r<=8221||8224<=r&&r<=8226||8228<=r&&r<=8231||8240===r||8242<=r&&r<=8243||8245===r||8251===r||8254===r||8308===r||8319===r||8321<=r&&r<=8324||8364===r||8451===r||8453===r||8457===r||8467===r||8470===r||8481<=r&&r<=8482||8486===r||8491===r||8531<=r&&r<=8532||8539<=r&&r<=8542||8544<=r&&r<=8555||8560<=r&&r<=8569||8585===r||8592<=r&&r<=8601||8632<=r&&r<=8633||8658===r||8660===r||8679===r||8704===r||8706<=r&&r<=8707||8711<=r&&r<=8712||8715===r||8719===r||8721===r||8725===r||8730===r||8733<=r&&r<=8736||8739===r||8741===r||8743<=r&&r<=8748||8750===r||8756<=r&&r<=8759||8764<=r&&r<=8765||8776===r||8780===r||8786===r||8800<=r&&r<=8801||8804<=r&&r<=8807||8810<=r&&r<=8811||8814<=r&&r<=8815||8834<=r&&r<=8835||8838<=r&&r<=8839||8853===r||8857===r||8869===r||8895===r||8978===r||9312<=r&&r<=9449||9451<=r&&r<=9547||9552<=r&&r<=9587||9600<=r&&r<=9615||9618<=r&&r<=9621||9632<=r&&r<=9633||9635<=r&&r<=9641||9650<=r&&r<=9651||9654<=r&&r<=9655||9660<=r&&r<=9661||9664<=r&&r<=9665||9670<=r&&r<=9672||9675===r||9678<=r&&r<=9681||9698<=r&&r<=9701||9711===r||9733<=r&&r<=9734||9737===r||9742<=r&&r<=9743||9748<=r&&r<=9749||9756===r||9758===r||9792===r||9794===r||9824<=r&&r<=9825||9827<=r&&r<=9829||9831<=r&&r<=9834||9836<=r&&r<=9837||9839===r||9886<=r&&r<=9887||9918<=r&&r<=9919||9924<=r&&r<=9933||9935<=r&&r<=9953||9955===r||9960<=r&&r<=9983||10045===r||10071===r||10102<=r&&r<=10111||11093<=r&&r<=11097||12872<=r&&r<=12879||57344<=r&&r<=63743||65024<=r&&r<=65039||65533===r||127232<=r&&r<=127242||127248<=r&&r<=127277||127280<=r&&r<=127337||127344<=r&&r<=127386||917760<=r&&r<=917999||983040<=r&&r<=1048573||1048576<=r&&r<=1114109?"A":"N"};class g{constructor(t,e){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet="-/: .,@%'\"~",this._option=t,this._userSpec=null!=e?e:{},this.textSpec=this._initSpec(),(0,h.Z)(t.specialCharSet)&&(this.specialCharSet=t.specialCharSet),this._standardMethod=(0,h.Z)(t.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if((0,u.Z)(this._canvas)&&((0,h.Z)(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),(0,u.Z)(this._canvas)&&"undefined"!=typeof window&&void 0!==window.document&&globalThis&&(0,h.Z)(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),(0,u.Z)(this._context)&&(0,h.Z)(this._canvas)){let t=this._canvas.getContext("2d");(0,h.Z)(t)&&(t.save(),t.font=function(t,e={},i){i||(i=1);let{fontStyle:r=e.fontStyle,fontVariant:n=e.fontVariant,fontWeight:s=e.fontWeight,fontSize:l=e.fontSize,fontFamily:a=e.fontFamily}=t;return(r?r+" ":"")+(n?n+" ":"")+(s?s+" ":"")+l*i+"px "+(a||"sans-serif")}(this.textSpec),this._contextSaved=!0,this._context=t)}return!(0,u.Z)(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var t,e,i;let{defaultFontParams:r={}}=this._option,{fontStyle:n=r.fontStyle,fontVariant:s=r.fontVariant,fontWeight:l=null!=(t=r.fontWeight)?t:"normal",fontSize:a=null!=(e=r.fontSize)?e:12,fontFamily:o=null!=(i=r.fontFamily)?i:"sans-serif",align:h,textAlign:u=null!=h?h:"center",baseline:c,textBaseline:p=null!=c?c:"middle",ellipsis:g,limit:f}=this._userSpec,{lineHeight:m=a}=this._userSpec;return(0,d.Z)(m)&&"%"===m[m.length-1]&&(m=a*(Number.parseFloat(m.substring(0,m.length-1))/100)),{fontStyle:n,fontVariant:s,fontFamily:o,fontSize:a,fontWeight:l,textAlign:u,textBaseline:p,ellipsis:g,limit:f,lineHeight:m}}measure(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}fullMeasure(t){let e;if((0,u.Z)(t))return{width:0,height:0};if((0,u.Z)(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);let{fontFamily:i,fontSize:r,fontWeight:n,textAlign:s,textBaseline:l,ellipsis:a,limit:o,lineHeight:h}=this.textSpec;try{let u=this._option.getTextBounds({text:t,fontFamily:i,fontSize:r,fontWeight:n,textAlign:s,textBaseline:l,ellipsis:!!a,maxLineWidth:o||1/0,lineHeight:h});e={width:u.width(),height:u.height()}}catch(i){this._notSupportVRender=!0,e=this.measureWithNaiveCanvas(t)}return e}measureWithNaiveCanvas(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(t){if(!this.initContext())return this._quickMeasureWithoutCanvas(t);let e=this._context.measureText(t),{fontSize:i,lineHeight:r}=this.textSpec;return{width:e.width,height:null!=r?r:i,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}quickMeasure(t){return this._measureReduce(t,this._quickMeasure.bind(this))}_quickMeasure(t){let e={width:0,height:0};for(let i=0;i<t.length;i++){let r=t[i],n=this._measureSpecialChar(r);(0,u.Z)(n)&&g.NUMBERS_CHAR_SET.includes(r)&&(n=this._measureNumberChar()),(0,u.Z)(n)&&["F","W"].includes(p(r))&&(n=this._measureFullSizeChar()),(0,u.Z)(n)&&(n=this._measureLetterChar()),e.width+=n.width,e.height=Math.max(e.height,n.height),(0,u.Z)(n.fontBoundingBoxAscent)||(e.fontBoundingBoxAscent=n.fontBoundingBoxAscent),(0,u.Z)(n.fontBoundingBoxDescent)||(e.fontBoundingBoxDescent=n.fontBoundingBoxDescent)}return e}quickMeasureWithoutCanvas(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(t){let e={width:0,height:0},{fontSize:i,lineHeight:r}=this.textSpec;for(let r=0;r<t.length;r++){let n=["F","W"].includes(p(t[r]))?1:.53;e.width+=n*i}return e.height=null!=r?r:i,e}_measureReduce(t,e){let{fontSize:i,lineHeight:r}=this.textSpec,n={width:0,height:0};if((0,u.Z)(t))return n;if((0,c.Z)(t)){let s=t.filter(h.Z).map(t=>t.toString());return 0===s.length?n:1===s.length?e(s[0]):{width:s.reduce((t,i)=>Math.max(t,e(i).width),0),height:s.length*((null!=r?r:i)+1)+1}}return e(t.toString())}_measureNumberChar(){if((0,u.Z)(this._numberCharSize)){let t=this._standardMethod(g.NUMBERS_CHAR_SET);this._numberCharSize={width:t.width/g.NUMBERS_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return(0,u.Z)(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(g.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if((0,u.Z)(this._letterCharSize)){let t=this._standardMethod(g.ALPHABET_CHAR_SET);this._letterCharSize={width:t.width/g.ALPHABET_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(t){return(0,h.Z)(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}release(){(0,h.Z)(this._canvas)&&(this._canvas=null),(0,h.Z)(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}g.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",g.NUMBERS_CHAR_SET="0123456789",g.FULL_SIZE_CHAR="字";let f="",m="quick",y=new r.n((t,e,i,r)=>{i(n.j)?r(n.j).to(C).inSingletonScope():t(n.j).to(C).inSingletonScope()}),v=new r.n((t,e,i,r)=>{i(n.j)?r(n.j).to(n.f).inSingletonScope():t(n.j).to(n.f).inSingletonScope()}),b=y,_=new Map;function x(t,e,i,r="normal"){var n,a,o;let h=`${t}-${e}-${i}-${r}`,u=_.get(h);if(u)return u;let d=(n={fontSize:t,fontFamily:i,fontWeight:e,fontStyle:r},new g(Object.assign({defaultFontParams:{fontFamily:s.q9.fontFamily,fontSize:s.q9.fontSize},getTextBounds:o?void 0:l.o,specialCharSet:`{}()//&-/: .,@%'"~…=——${g.ALPHABET_CHAR_SET}${g.ALPHABET_CHAR_SET.toUpperCase()}0123456789${f}`},null!=a?a:{}),n));return _.set(h,d),d}class C extends n.f{_fastMeasure(t,e){let{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:n="normal",fontStyle:s="normal"}=e,l=x(i,n,r,s).measure(t,m);if(!(0,h.Z)(l.fontBoundingBoxAscent)&&!(0,h.Z)(l.fontBoundingBoxDescent)){let{ascent:t,descent:i}=this.measureTextBoundADscentEstimate(e);l.fontBoundingBoxAscent=t,l.fontBoundingBoxDescent=i}return l}measureTextWidth(t,e){return this._fastMeasure(t,e).width}measureText(t,e){return this._fastMeasure(t,e)}_measureTextWithoutAlignBaseline(t,e,i){return this._fastMeasure(t,e)}_measureTextWithAlignBaseline(t,e,i){return this._fastMeasure(t,e)}}let w=new class{measureText(t,e){let{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:n="normal",fontStyle:s="normal"}=e;return x(i,n,r,s).measure(t,m)}measureTextWidth(t,e){let{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:n="normal",fontStyle:s="normal"}=e;return x(i,n,r,s).measure(t,m).width}clipText(t,e,i){if(0===t.length)return{str:"",width:0};let r=this.measureTextWidth(t,e);return r<=i?{str:t,width:r}:(r=this.measureTextWidth(t[0],e))>i?{str:"",width:0}:this._clipText(t,e,i,0,t.length-1)}_clipText(t,e,i,r,n){let s,l=Math.floor((r+n)/2),a=t.substring(0,l+1),o=this.measureTextWidth(a,e);if(o>i){if(a.length<=1)return{str:"",width:0};let n=t.substring(0,l);return(s=this.measureTextWidth(n,e))<=i?{str:n,width:s}:this._clipText(t,e,i,r,l)}if(o<i){if(l>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};let r=t.substring(0,l+2);return(s=this.measureTextWidth(r,e))>=i?{str:a,width:o}:this._clipText(t,e,i,l,n)}return{str:a,width:o}}clipTextWithSuffix(t,e,i,r){if(""===r)return this.clipText(t,e,i);if(0===t.length)return{str:"",width:0};let n=this.measureTextWidth(t,e);if(n<=i)return{str:t,width:n};let s=this.measureTextWidth(r,e);if(s>i)return{str:"",width:0};i-=s;let l=this._clipText(t,e,i,0,t.length-1);return l.str+=r,l.width+=s,l}};function S(t){f=t,_.clear()}function A(){m="canvas",a.n.load(v)}let M=new o.x({ignoreBuf:!0});function k(t){return M.initAttributes(Object.assign(Object.assign({},t),{ignoreBuf:!0})),M.AABBBounds}},81137:function(t,e,i){"use strict";i.d(e,{Bd:()=>f,GW:()=>c,Jd:()=>m,Pi:()=>g,Vz:()=>d,Y:()=>h,aC:()=>b,gs:()=>p,hR:()=>v,r5:()=>y});var r=i(18585),n=i(70506),s=i(47e3),l=i(58977),a=i(43735),o=i(57657);function h(t,e,i,r,n){let s=n.table.getCellRange(t,e);if(s.start.col!==s.end.col||s.start.row!==s.end.row)for(let t=s.start.col;t<=s.end.col;t++)for(let e=s.start.row;e<=s.end.row;e++)u(t,e,i,r,n);else u(t,e,i,r,n)}function u(t,e,i,r,n){let s=n.table.getRecordShowIndexByCell(t,e);if(s>=0){let t=n.table.dataSource.getIndexKey(s).toString();n.checkedState.get(t)?n.checkedState.get(t)[i]=r:n.checkedState.set(t,{[i]:r})}}function d(t,e,i){var r;i.headerCheckedState[t]=e,i.table.internalProps.enableCheckboxCascade&&(null==(r=i.checkedState)||r.forEach(i=>{i[t]=e}))}function c(t,e,i,n,s){var l,a;if(s.table.isHeader(t,e)){if((0,r.Z)(s.headerCheckedState[i]))return s.headerCheckedState[i];if("function"==typeof n)return;if((0,r.Z)(n))s.headerCheckedState[i]=n;else if((null==(l=s.checkedState)?void 0:l.size)>0)return s.updateHeaderCheckedState(i,t,e);return s.headerCheckedState[i]}let o=s.table.getRecordShowIndexByCell(t,e);if(o>=0){let t=s.table.dataSource.getIndexKey(o).toString();if((0,r.Z)(null==(a=s.checkedState.get(t))?void 0:a[i]))return s.checkedState.get(t)[i];if(s.checkedState.get(t))s.checkedState.get(t)[i]=n;else if(s.table.internalProps.enableCheckboxCascade&&t.includes(",")){let e=t.split(",").slice(0,-1).join(",");s.checkedState.has(e)&&!0===s.checkedState.get(e)[i]?s.checkedState.set(t,{[i]:!0}):s.checkedState.set(t,{[i]:n})}else s.checkedState.set(t,{[i]:n})}return n}function p(t,e){e.checkedState.clear(),e.headerCheckedState={},e.radioState={};let i=!1;if(e._checkboxCellTypeFields=[],e._headerCheckFuncs={},e.table.internalProps.layoutMap.headerObjects.forEach((t,r)=>{if("checkbox"===t.headerType){let r=t.define.checked;null==r||"function"==typeof r?(i=!0,"function"==typeof r&&(e._headerCheckFuncs[t.field]=r)):e.headerCheckedState[t.field]=r,"checkbox"!==t.define.cellType&&!(0,n.Z)(t.define.cellType)||t.fieldFormat||e._checkboxCellTypeFields.push(t.field)}}),1===e.table.leftRowSeriesNumberCount)e.headerCheckedState._vtable_rowSeries_number=!1,e._checkboxCellTypeFields.push("_vtable_rowSeries_number"),i=!0;else if(e.table.leftRowSeriesNumberCount>1){for(let t=0;t<e.table.leftRowSeriesNumberCount;t++)e.headerCheckedState[`_vtable_rowSeries_number_${t}`]=!1,e._checkboxCellTypeFields.push(`_vtable_rowSeries_number_${t}`);i=!0}i&&function(t,e){let i=e.table,r=i.isPivotTable()?0:i.internalProps.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount,n=i.isPivotTable()?(0,a.Z)(t)?t.length:0:i.internalProps.transpose?i.colCount:i.rowCount;for(let l=0;l+r<n;l++){let r=i.isPivotTable()?t[l]:i.dataSource.get(l);e._checkboxCellTypeFields.forEach(t=>{let n,a=r&&r[t];if((0,s.Z)(a)?n=a.checked:"boolean"==typeof a&&(n=a),null==n){let i=e._headerCheckFuncs[t];if(i){let r=e.table.getCellAddrByFieldRecord(t,l);n=(0,o.vi)(i,{col:r.col,row:r.row,table:e.table,context:null,value:a})}}let h=i.isPivotTable()?l.toString():e.table.dataSource.getIndexKey(l).toString();e.checkedState.get(h)||e.checkedState.set(h,{}),e.checkedState.get(h)[t]=n})}}(t,e)}function g(t,e,i,r){let n=!0,s=!0,l=!1;return e.checkedState.forEach((a,o)=>{var h;o=o.includes(",")?o.split(",").map(t=>Number(t)):Number(o);let u=e.table.getTableIndexByRecordIndex(o),d=e.table.transpose?e.table.getCustomMerge(u,r):e.table.getCustomMerge(i,u),c=null==(h=e.table.dataSource)?void 0:h.get(o);d||!e.table.internalProps.enableCheckboxCascade&&(null==c?void 0:c.vtableMerge)||(!0!==(null==a?void 0:a[t])?n=!1:(s=!1,l=!0))}),n?(e.headerCheckedState[t]=!0,n):s?(e.headerCheckedState[t]=!1,!1):!!l&&(e.headerCheckedState[t]="indeterminate","indeterminate")}function f(t,e){for(let i=e.checkedState.size;i<t.length;i++){let r=t[i];e._checkboxCellTypeFields.forEach(t=>{let n,l=r[t];(0,s.Z)(l)?n=l.checked:"boolean"==typeof l&&(n=l);let a=i.toString();e.checkedState.get(a)||e.checkedState.set(a,{}),e.checkedState.get(a)[t]=n})}}function m(t,e,i,r){var n,s;let l=r.scenegraph.getCell(t,e),a=(null==l?void 0:l.getChildByName("checkbox"))||(null==(s=null==(n=null==l?void 0:l.getChildByName("checkbox-content"))?void 0:n._checkboxGroup)?void 0:s.getChildByName("checkbox"));if(!a){let n=r.getHeaderField(t,e);if(r.isHeader(t,e))r.stateManager.setHeaderCheckedState(n,i),"checkbox"===r.getCellType(t,e)&&r.scenegraph.updateCheckboxCellState(t,e,i);else if(r.stateManager.setCheckedState(t,e,n,i),"checkbox"===r.getCellType(t,e)){let i=r.stateManager.headerCheckedState[n],s=r.stateManager.updateHeaderCheckedState(n,t,e);i!==s&&r.scenegraph.updateHeaderCheckboxCellState(t,e,s)}return}let{checked:o,indeterminate:h}=a.attribute;h?(i||a._handlePointerUp(),a._handlePointerUp()):o?i||a._handlePointerUp():i&&a._handlePointerUp()}function y(t,e,i,r){var n,s;let l=r.scenegraph.getCell(t,e),a=(null==l?void 0:l.getChildByName("checkbox"))||(null==(s=null==(n=null==l?void 0:l.getChildByName("checkbox-content"))?void 0:n._checkboxGroup)?void 0:s.getChildByName("checkbox"));a&&("indeterminate"===i?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",i)))}function v(t,e,i){let r,n,{checkedState:s,table:o}=i;if(o.internalProps.transpose?(t=o.getRecordShowIndexByCell(t,0),e=o.getRecordShowIndexByCell(e,0)):(r=o.isPivotTable()?void 0:o.getRecordIndexByCell(0,t),n=o.isPivotTable()?void 0:o.getRecordIndexByCell(0,e)),(0,l.Z)(r)&&(0,l.Z)(n)){if((t=r)>(e=n)){let i=s.get(t.toString());for(let i=t;i>e;i--)s.set(i.toString(),s.get((i-1).toString()));s.set(e.toString(),i)}else if(t<e){let i=s.get(t.toString());for(let i=t;i<e;i++)s.set(i.toString(),s.get((i+1).toString()));s.set(e.toString(),i)}}else if((0,a.Z)(r)&&(0,a.Z)(n)){if((t=r[r.length-1])>(e=n[n.length-1])){let i=s.get(r.toString());for(let i=t;i>e;i--){let t=[...r];t[t.length-1]=i;let e=[...r];e[e.length-1]=i-1,s.set(t.toString(),s.get(e.toString()))}s.set(n.toString(),i)}else if(t<e){let i=s.get(r.toString());for(let i=t;i<e;i++){let t=[...r];t[t.length-1]=i;let e=[...r];e[e.length-1]=i+1,s.set(t.toString(),s.get(e.toString()))}s.set(n.toString(),i)}}}function b(t){let e=[],i=t.dataSource,r=i.dataConfig.groupByRules.length+1;return i.currentIndexedData.forEach((n,s)=>{(0,a.Z)(n)&&n.length===r&&(e[i.getOriginRecordIndexForGroup(n)]=t.stateManager.checkedState.get(n.toString()))}),e}},13222:function(t,e,i){"use strict";i.d(e,{J:()=>a});var r=i(67203),n=i(37902),s=i(18585),l=i(80852);function a(t,e){var i,n,a,h,u,d,c,p,g,f,m;let y,v;if("cell"===t.role&&(0,s.Z)(t.mergeStartCol)&&(0,s.Z)(t.mergeStartRow)&&(0,s.Z)(t.mergeEndCol)&&(0,s.Z)(t.mergeEndRow)){let{colStart:i,colEnd:r,rowStart:n,rowEnd:s}=(0,l.e)(t,e.scenegraph);for(let l=i;l<=r;l++)for(let i=n;i<=s;i++){let r=o(e.stateManager,l,i,t);!r||y&&"cellBgColor"!==r||(y=r)}}else"cell"===t.role&&(y=o(e.stateManager,t.col,t.row,t));if(!y)return;let b=e.internalProps.layoutMap;return b.isCornerHeader(t.col,t.row)?v=(null==(i=e.theme.cornerHeaderStyle)?void 0:i.hover)||(null==(n=e.theme.headerStyle)?void 0:n.hover):b.isColumnHeader(t.col,t.row)?v=null==(a=e.theme.headerStyle)?void 0:a.hover:b.isRowHeader(t.col,t.row)?v=null==(h=e.theme.rowHeaderStyle)?void 0:h.hover:b.isBottomFrozenRow(t.col,t.row)?v=(null==(u=e.theme.bottomFrozenStyle)?void 0:u.hover)||(e.isListTable()?null==(d=e.theme.bodyStyle)?void 0:d.hover:null==(c=e.theme.headerStyle)?void 0:c.hover):b.isRightFrozenColumn(t.col,t.row)?v=(null==(p=e.theme.rightFrozenStyle)?void 0:p.hover)||(e.isListTable()?null==(g=e.theme.bodyStyle)?void 0:g.hover:null==(f=e.theme.rowHeaderStyle)?void 0:f.hover):e.isHeader(t.col,t.row)||(v=null==(m=e.theme.bodyStyle)?void 0:m.hover),(0,r.WJ)(y,v,t.col,t.row,e)}function o(t,e,i,r){var s;let l,{highlightScope:a,disableHeader:o,cellPos:h}=t.hover,u=t.table,d=u.isHeader(e,i);if(!d||!o){if(a===n.p.single&&h.col===e&&h.row===i?l="cellBgColor":a===n.p.column&&h.col===e?l=h.col===e&&h.row===i?"cellBgColor":"inlineColumnBgColor":a===n.p.row&&h.row===i?l=h.col===e&&h.row===i?"cellBgColor":"inlineRowBgColor":a===n.p.cross&&(h.col===e&&h.row===i?l="cellBgColor":h.col===e?l="inlineColumnBgColor":h.row===i&&(l="inlineRowBgColor")),l){let t;if(d){let n=u.getHeaderDefine(e,i);t=null==n?void 0:n.disableHeaderHover,r.firstChild&&"axis"===r.firstChild.name&&(null==(s=u.options.hover)?void 0:s.disableAxisHover)&&(t=!0)}else{let r=u.getBodyColumnDefine(e,i);t=null==r?void 0:r.disableHover}t&&(l=void 0)}return l}}},30394:function(t,e,i){"use strict";i.d(e,{Oq:()=>a,Wg:()=>o,fM:()=>h,tO:()=>d,vj:()=>u});var r=i(58977),n=i(18585),s=i(47e3),l=i(47105);function a(t,e,i,n,s,l){let a=l.table.getRecordShowIndexByCell(t,e);if(a>=0){let t=l.table.dataSource.getIndexKey(a);"column"===n?(0,r.Z)(s)?(l.radioState[i]={},l.radioState[i][t]=s):l.radioState[i]=t:(l.radioState[i]||(l.radioState[i]={}),(0,r.Z)(s)?l.radioState[i][t]=s:l.radioState[i][t]=!0)}}function o(t,e,i){var l;let a=i.getBodyColumnDefine(t,e),o=null==a?void 0:a.field,h=i.getCellType(t,e);if((0,n.Z)(o)&&"radio"===h){let n=i.dataSource.getIndexKey(i.getRecordShowIndexByCell(t,e)),a=null==(l=i.stateManager.radioState)?void 0:l[o];if((0,r.Z)(a)){if(a===n)return!0}else if((0,s.Z)(a)){let t=a[n];if((0,r.Z)(t))return t}}return!1}function h(t,e,i,a,o,h,u){var d,c,p,g,f;let m=u.table.getRecordShowIndexByCell(t,e);if(m>=0){let t=u.table.dataSource.getIndexKey(m);if("column"===a){if(!(0,n.Z)(u.radioState[i])&&h)return(0,r.Z)(o)?(u.radioState[i]={},u.radioState[i][t]=o):u.radioState[i]=t,!0;if((0,r.Z)(u.radioState[i])&&!(0,r.Z)(o))return u.radioState[i]===t;if((0,r.Z)(u.radioState[i])&&(0,r.Z)(o)||(0,s.Z)(u.radioState[i])&&!(0,r.Z)(o))return!1;if((0,s.Z)(u.radioState[i])&&(0,r.Z)(o))return u.radioState[i][t]===o}else if("cell"===a){if(!(0,n.Z)(u.radioState[i])&&h)return u.radioState[i]={},(0,r.Z)(o)?u.radioState[i][t]=o:u.radioState[i][t]=!0,!0;if(!(0,n.Z)(null==(d=u.radioState[i])?void 0:d[t])&&h)return(0,r.Z)(o)?u.radioState[i][t]=o:u.radioState[i][t]=!0,!0;if((0,l.Z)(null==(c=u.radioState[i])?void 0:c[t])&&!(0,r.Z)(o))return u.radioState[i][t];if((0,l.Z)(null==(p=u.radioState[i])?void 0:p[t])&&(0,r.Z)(o)||(0,r.Z)(null==(g=u.radioState[i])?void 0:g[t])&&!(0,r.Z)(o))return!1;if((0,r.Z)(null==(f=u.radioState[i])?void 0:f[t])&&(0,r.Z)(o))return u.radioState[i][t]===o}}return h}function u(t,e,i,n){let s=n.scenegraph.getCell(t,e);if(s)if((0,r.Z)(i)){let t=s.getChildAt(i);null==t||t._handlePointerUp()}else{let t=s.getChildByName("radio");null==t||t._handlePointerUp()}}function d(t,e,i){let{radioState:r,table:n}=i;if(n.internalProps.transpose?(t=n.getRecordShowIndexByCell(t,0),e=n.getRecordShowIndexByCell(e,0)):(t=n.getRecordShowIndexByCell(0,t),e=n.getRecordShowIndexByCell(0,e)),t>e){let i=r[t];for(let i=t;i>e;i--)r[i]=r[i-1];r[e]=i}else if(t<e){let i=r[t];for(let i=t;i<e;i++)r[i]=r[i+1];r[e]=i}}},42192:function(t,e,i){"use strict";i.r(e),i.d(e,{DEFAULT:()=>b,SIMPLIFY:()=>_,BRIGHT:()=>y,DARK:()=>m,default:()=>A,ARCO:()=>v,TableTheme:()=>g,get:()=>S,of:()=>w,theme:()=>C});var r=i(57657);let n={name:"DARK",underlayBackgroundColor:"transparent",defaultStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},headerStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},rowHeaderStyle:{},cornerHeaderStyle:{},bodyStyle:{color:"#e5e7ea",bgColor:function(t){let{row:e,table:i}=t;return 1&e-i.frozenRowCount?"#282a2e":"#2d3137"},fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#29364D"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:10,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(255, 255, 255, 0.1)",cellBorderColor:"#4284FF",cellBorderLineWidth:2},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"},functionalIconsStyle:{sort_color:"#FFFFFF",sort_color_opacity:"0.75",sort_color_2:"#416EFF",sort_color_opacity_2:"1",frozen_color:"#FFFFFF",frozen_color_opacity:"0.75",collapse_color:"#FFF",collapse_color_opacity:"0.75",expand_color:"#FFF",expand_color_opacity:"0.75",dragReorder_color:"#FFF",dragReorder_color_opacity:"0.75"}},s={name:"BRIGHT",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#5286FA",hover:{cellBgColor:"#2E67E3"}},headerStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#A1C1FF",hover:{cellBgColor:"#2E67E3"}},bodyStyle:{color:"#000",bgColor:function(t){let{row:e,table:i}=t;return 1&e-i.frozenRowCount?"#FFF":"#F4F8FF"},borderColor:"#E0EAFE",hover:{cellBgColor:"#E9EFFD"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"#CBDCFE",endColor:"#CBDCFE",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},l={name:"ARCO",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12]},headerStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},rowHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},cornerHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},bodyStyle:{padding:[8,12,8,12],color:"#141414",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:400,textAlign:"left",bgColor:function(t){let{row:e,table:i}=t;return 1&e-i.frozenRowCount?"#fbfbfc":"#FFF"},borderColor:"#e1e4e8",lineHeight:14,hover:{cellBgColor:"#F7F8FA",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:4,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#3073f2"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},a={name:"DEFAULT",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:"#E1E4E8",color:"#000",bgColor:"#ECF1F5"},headerStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},rowHeaderStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},cornerHeaderStyle:{fontSize:16,fontWeight:"bold"},bodyStyle:{fontSize:14,bgColor:function(t){let{row:e,table:i}=t;return 1&e-i.frozenRowCount?"#FDFDFD":"#FAF9FB"},hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"rgba(225, 228, 232, 0.6)",endColor:"rgba(225, 228, 232, 0.6)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#0000ff"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},o={name:"SIMPLIFY",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:function(t){let{col:e,table:i}=t,{colCount:r,frozenColCount:n}=i,s="#ccc7c7";return n-1===e||r-1===e?[s,"#f2f2f2","#ccc7c7",null]:[s,null,"#ccc7c7",null]},hover:{cellBorderColor:"#0000FF",cellBgColor:"#D0E0E3"},bgColor:"#FFF"},headerStyle:{color:"rgba(0, 0, 0, 0.87)",borderColor:function(t){let{row:e,table:{frozenRowCount:i}}=t;return i-1===e?["#f2f2f2","#f2f2f2","#ccc7c7","#f2f2f2"]:["#f2f2f2"]}},bodyStyle:{color:"rgba(0, 0, 0, 0.87)"},frameStyle:{borderColor:"#f2f2f2",borderLineWidth:1},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF"},selectionStyle:{cellBorderColor:"#FD5",cellBgColor:"rgba(111, 168, 220, 0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};var h=i(47191),u=i(12588),d=i(13455);let c={visible:!0,position:"auto",padding:8,titleStyle:{fontSize:12,fontWeight:"bold",fill:"#4E5969"},contentStyle:{fontSize:12,fill:"#4E5969"},panel:{visible:!0,fill:"#fff",stroke:"#ffffff",lineWidth:0,cornerRadius:3,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:"rgba(0, 0, 0, 0.1)",size:0,space:12}};function p(t,e,i,n){var s,l,a;return null!=(a=null!=(l=null!=(s=(0,r.TS)(t,...i))?s:(0,r.TS)(e,...i))?l:n&&(0,r.TS)(t,...n))?a:n&&(0,r.TS)(e,...n)}class g{constructor(t,e){this._defaultStyle=null,this._header=null,this._cornerHeader=null,this._cornerRightTopCell=null,this._cornerLeftBottomCell=null,this._cornerRightBottomCell=null,this._rightFrozen=null,this._bottomFrozen=null,this._rowHeader=null,this._body=null,this._groupTitle=null,this._scroll=null,this._tooltip=null,this._frameStyle=null,this._columnResize=null,this._dragHeaderSplitLine=null,this._frozenColumnLine=null,this._selectionStyle=null,this._axisStyle=null,this._checkboxStyle=null,this._radioStyle=null,this._switchStyle=null,this._buttonStyle=null,this._textPopTipStyle=null,this._internalIconsStyle=null,this.isPivot=!1,this.name="",this.internalTheme={obj:t,superTheme:e},this.name=p(t,e,["name"])}getExtendTheme(){return this.internalTheme.obj}clearBodyStyleCache(){this._body=null}get font(){let{obj:t,superTheme:e}=this.internalTheme;return p(t,e,["font"],["bodyStyle","font"])}get underlayBackgroundColor(){let{obj:t,superTheme:e}=this.internalTheme;return p(t,e,["underlayBackgroundColor"])}get cellInnerBorder(){var t;let{obj:e,superTheme:i}=this.internalTheme;return null==(t=p(e,i,["cellInnerBorder"]))||t}get cellBorderClipDirection(){var t;let{obj:e,superTheme:i}=this.internalTheme;return null!=(t=p(e,i,["cellBorderClipDirection"]))?t:"top-left"}get _contentOffset(){var t;let{obj:e,superTheme:i}=this.internalTheme;return null!=(t=p(e,i,["_contentOffset"]))?t:0}get defaultStyle(){let t=this;if(!this._defaultStyle){let{obj:U,superTheme:K}=this.internalTheme,$=(0,u.je)({},K.defaultStyle,U.defaultStyle);this._defaultStyle={get fontSize(){var e;return null!=(e=$.fontSize)?e:d.ho},get fontFamily(){var i;return null!=(i=$.fontFamily)?i:d.Rk},get fontWeight(){return $.fontWeight},get fontVariant(){return $.fontVariant},get fontStyle(){return $.fontStyle},get bgColor(){var r;return null!=(r=$.bgColor)?r:d.aE},get color(){var n;return null!=(n=$.color)?n:d.yZ},get borderColor(){var s;return null!=(s=$.borderColor)?s:d.cT},get borderLineWidth(){var l;return null!=(l=$.borderLineWidth)?l:d.zY},get borderLineDash(){var a;return null!=(a=$.borderLineDash)?a:d.z8},get hover(){if($.hover)return{get cellBgColor(){var o,h;return null!=(h=null==(o=$.hover)?void 0:o.cellBgColor)?h:void 0},get inlineColumnBgColor(){var c,p,g,f,m,y;return null!=(y=null!=(p=null==(c=$.hover)?void 0:c.inlineColumnBgColor)?p:(null==(g=$.hover)?void 0:g.cellBgColor)&&"string"==typeof(null==(f=$.hover)?void 0:f.cellBgColor)?(0,u.zX)(null==(m=$.hover)?void 0:m.cellBgColor,.1,!1):void 0)?y:void 0},get inlineRowBgColor(){var v,b,_,x,C,w;return null!=(w=null!=(b=null==(v=$.hover)?void 0:v.inlineRowBgColor)?b:(null==(_=$.hover)?void 0:_.cellBgColor)&&"string"==typeof(null==(x=$.hover)?void 0:x.cellBgColor)?(0,u.zX)(null==(C=$.hover)?void 0:C.cellBgColor,.1,!1):void 0)?w:void 0}}},get select(){if($.select)return{get inlineColumnBgColor(){var S,A,M,k,T,R;return null!=(R=null!=(k=null!=(A=null==(S=$.select)?void 0:S.inlineColumnBgColor)?A:null==(M=t.selectionStyle)?void 0:M.inlineColumnBgColor)?k:(null==(T=t.selectionStyle)?void 0:T.cellBgColor)&&"string"==typeof t.selectionStyle.cellBgColor?(0,u.zX)(t.selectionStyle.cellBgColor,.1,!1):void 0)?R:void 0},get inlineRowBgColor(){var B,P,E,I,L;return null!=(L=null!=(E=null!=(P=null==(B=$.select)?void 0:B.inlineRowBgColor)?P:t.selectionStyle.inlineRowBgColor)?E:(null==(I=t.selectionStyle)?void 0:I.cellBgColor)&&"string"==typeof t.selectionStyle.cellBgColor?(0,u.zX)(t.selectionStyle.cellBgColor,.1,!1):void 0)?L:void 0}}},get padding(){var F;return null!=(F=$.padding)?F:[10,16,10,16]},get textAlign(){var O;return null!=(O=$.textAlign)?O:"left"},get textBaseline(){var D;return null!=(D=$.textBaseline)?D:"middle"},get textOverflow(){var H;return null!=(H=$.textOverflow)?H:"ellipsis"},get lineHeight(){return $.lineHeight},get autoWrapText(){var z;return null!=(z=$.autoWrapText)&&z},get lineClamp(){var W;return null!=(W=$.lineClamp)?W:"auto"},get linkColor(){var N;return null!=(N=$.linkColor)?N:"#3772ff"},get cursor(){var j;return null!=(j=$.cursor)?j:"auto"},get marked(){var G;return null!=(G=$.marked)&&G},get underline(){var V;return null!=(V=$.underline)&&V},get underlineColor(){return $.underlineColor},get underlineDash(){return $.underlineDash},get underlineOffset(){return $.underlineOffset},get lineThrough(){var Z;return null!=(Z=$.lineThrough)&&Z},get lineThroughColor(){return $.lineThroughColor},get lineThroughDash(){return $.lineThroughDash}}}return this._defaultStyle}get cornerHeaderStyle(){if(!this._cornerHeader){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},this.defaultStyle,e.cornerHeaderStyle,t.cornerHeaderStyle);this._cornerHeader=this.getStyle(i)}return this._cornerHeader}get cornerRightTopCellStyle(){if(!this._cornerRightTopCell){let{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightTopCellStyle&&!t.cornerRightTopCellStyle)return this._cornerRightTopCell;let i=(0,u.je)({},this.defaultStyle,e.cornerRightTopCellStyle,t.cornerRightTopCellStyle);this._cornerRightTopCell=this.getStyle(i)}return this._cornerRightTopCell}get cornerLeftBottomCellStyle(){if(!this._cornerLeftBottomCell){let{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerLeftBottomCellStyle&&!t.cornerLeftBottomCellStyle)return this._cornerLeftBottomCell;let i=(0,u.je)({},this.defaultStyle,e.cornerLeftBottomCellStyle,t.cornerLeftBottomCellStyle);this._cornerLeftBottomCell=this.getStyle(i)}return this._cornerLeftBottomCell}get cornerRightBottomCellStyle(){if(!this._cornerRightBottomCell){let{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightBottomCellStyle&&!t.cornerRightBottomCellStyle)return this._cornerRightBottomCell;let i=(0,u.je)({},this.defaultStyle,e.cornerRightBottomCellStyle,t.cornerRightBottomCellStyle);this._cornerRightBottomCell=this.getStyle(i)}return this._cornerRightBottomCell}get rightFrozenStyle(){if(!this._rightFrozen){let{obj:t,superTheme:e}=this.internalTheme;if(!e.rightFrozenStyle&&!t.rightFrozenStyle)return this._rightFrozen;let i=(0,u.je)({},this.defaultStyle,this.rowHeaderStyle,e.rightFrozenStyle,t.rightFrozenStyle);this._rightFrozen=this.getStyle(i)}return this._rightFrozen}get bottomFrozenStyle(){if(!this._bottomFrozen){let{obj:t,superTheme:e}=this.internalTheme;if(!e.bottomFrozenStyle&&!t.bottomFrozenStyle)return this._bottomFrozen;let i=(0,u.je)({},this.defaultStyle,this.headerStyle,e.bottomFrozenStyle,t.bottomFrozenStyle);this._bottomFrozen=this.getStyle(i)}return this._bottomFrozen}get rowHeaderStyle(){var t;if(!this._rowHeader){let{obj:e,superTheme:i}=this.internalTheme,r=(0,u.je)({},this.defaultStyle,i.rowHeaderStyle,null!=(t=e.rowHeaderStyle)?t:this.isPivot?null:e.headerStyle);this._rowHeader=this.getStyle(r)}return this._rowHeader}get headerStyle(){if(!this._header){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},this.defaultStyle,e.headerStyle,t.headerStyle);this._header=this.getStyle(i)}return this._header}get bodyStyle(){if(!this._body){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},this.defaultStyle,e.bodyStyle,t.bodyStyle);this._body=this.getStyle(i)}return this._body}get groupTitleStyle(){if(!this._groupTitle){let{obj:t,superTheme:e}=this.internalTheme;if(!e.groupTitleStyle&&!t.groupTitleStyle)return this._groupTitle;let i=(0,u.je)({},this.defaultStyle,e.groupTitleStyle,t.groupTitleStyle);this._groupTitle=this.getStyle(i)}return this._groupTitle}get frameStyle(){if(!this._frameStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},e.frameStyle,t.frameStyle);this._frameStyle={get borderColor(){return i.borderColor},get borderLineWidth(){return i.borderLineWidth},get borderLineDash(){return i.borderLineDash},get innerBorder(){return i.innerBorder},get shadowBlur(){return i.shadowBlur},get shadowColor(){return i.shadowColor},get shadowOffsetX(){return i.shadowOffsetX},get shadowOffsetY(){return i.shadowOffsetY},get cornerRadius(){return i.cornerRadius}}}return this._frameStyle}get scrollStyle(){if(!this._scroll){let{obj:o,superTheme:h}=this.internalTheme,d=(0,u.je)({},h.scrollStyle,o.scrollStyle);this._scroll={get scrollSliderColor(){var t;return null!=(t=d.scrollSliderColor)?t:"#C0C0C0"},get scrollSliderCornerRadius(){return d.scrollSliderCornerRadius},get scrollRailColor(){return d.scrollRailColor},get visible(){var e;return null!=(e=d.visible)?e:"scrolling"},get verticalVisible(){return d.verticalVisible},get horizontalVisible(){return d.horizontalVisible},get width(){var i;return null!=(i=d.width)?i:7},get hoverOn(){var r;return null==(r=d.hoverOn)||r},get barToSide(){var n;return null!=(n=d.barToSide)&&n},get horizontalPadding(){var s;return null!=(s=d.horizontalPadding)?s:0},get verticalPadding(){var l;return null!=(l=d.verticalPadding)?l:0},get ignoreFrozenCols(){var a;return null!=(a=d.ignoreFrozenCols)&&a}}}return this._scroll}get tooltipStyle(){if(!this._tooltip){let{obj:s,superTheme:l}=this.internalTheme,a=(0,u.je)({},l.tooltipStyle,s.tooltipStyle);this._tooltip={get fontFamily(){var t;return null!=(t=a.fontFamily)?t:d.Rk},get fontSize(){var e;return null!=(e=a.fontSize)?e:d.ho},get bgColor(){var i;return null!=(i=a.bgColor)?i:"#000"},get padding(){var r;return null!=(r=a.padding)?r:[6,8]},get color(){var n;return null!=(n=a.color)?n:"#FFF"},get maxWidth(){return a.maxWidth},get maxHeight(){return a.maxHeight}}}return this._tooltip}get columnResize(){if(!this._columnResize){let{obj:p,superTheme:g}=this.internalTheme,f=(0,u.je)({},g.columnResize,p.columnResize);this._columnResize={get lineColor(){var t;return null!=(t=f.lineColor)?t:"#416EFF"},get bgColor(){var e;return null!=(e=f.bgColor)?e:"#D9E2FF"},get lineWidth(){var i;return null!=(i=f.lineWidth)?i:1},get width(){var r;return null!=(r=f.width)?r:f.lineWidth+2},get resizeHotSpotSize(){var n;return null!=(n=f.resizeHotSpotSize)?n:16},get labelColor(){var s;return null!=(s=f.labelColor)?s:"#FFF"},get labelFontSize(){var l;return null!=(l=f.labelFontSize)?l:10},get labelFontFamily(){var a;return null!=(a=f.labelFontFamily)?a:"sans-serif"},get labelBackgroundFill(){var o;return null!=(o=f.labelBackgroundFill)?o:"#3073F2"},get labelBackgroundCornerRadius(){var h;return null!=(h=f.labelBackgroundCornerRadius)?h:5},get labelVisible(){var d;return null==(d=f.labelVisible)||d},get visibleOnHover(){var c;return null!=(c=f.visibleOnHover)&&c}}}return this._columnResize}get dragHeaderSplitLine(){if(!this._dragHeaderSplitLine){let{obj:r,superTheme:n}=this.internalTheme,s=(0,u.je)({},n.dragHeaderSplitLine,r.dragHeaderSplitLine);this._dragHeaderSplitLine={get lineColor(){var t;return null!=(t=s.lineColor)?t:"blue"},get lineWidth(){var e;return null!=(e=s.lineWidth)?e:2},get shadowBlockColor(){var i;return null!=(i=s.shadowBlockColor)?i:"rgba(204,204,204,0.3)"}}}return this._dragHeaderSplitLine}get frozenColumnLine(){if(!this._frozenColumnLine){let{obj:x,superTheme:C}=this.internalTheme,w=(0,u.je)({},C.frozenColumnLine,x.frozenColumnLine);this._frozenColumnLine={get shadow(){if(w.shadow)return{get width(){var t,e;return null!=(e=null==(t=w.shadow)?void 0:t.width)?e:24},get startColor(){var i,r;return null!=(r=null==(i=w.shadow)?void 0:i.startColor)?r:"rgba(00, 24, 47, 0.06)"},get endColor(){var n,s;return null!=(s=null==(n=w.shadow)?void 0:n.endColor)?s:"rgba(00, 24, 47, 0)"},get visible(){var l,a;return null!=(a=null==(l=w.shadow)?void 0:l.visible)?a:"always"}}},get border(){if(w.border)return{get lineColor(){var o,h;return null!=(h=null==(o=w.border)?void 0:o.lineColor)?h:"rgba(00, 24, 47, 0.06)"},get bgColor(){var d,c,p,g;return null!=(g=null!=(c=null==(d=w.border)?void 0:d.bgColor)?c:null==(p=w.border)?void 0:p.lineColor)?g:"rgba(00, 24, 47, 0.06)"},get lineWidth(){var f,m;return null!=(m=null==(f=w.border)?void 0:f.lineWidth)?m:4},get width(){var y,v,b,_;return null!=(_=null!=(v=null==(y=w.border)?void 0:y.width)?v:null==(b=w.border)?void 0:b.lineWidth)?_:4}}}}}return this._frozenColumnLine}get selectionStyle(){if(!this._selectionStyle){let{obj:s,superTheme:l}=this.internalTheme,a=(0,u.je)({},l.selectionStyle,s.selectionStyle);this._selectionStyle={get cellBgColor(){var t;return null!=(t=null==a?void 0:a.cellBgColor)?t:"rgba(0, 0, 255,0.1)"},get cellBorderColor(){var e;return null!=(e=null==a?void 0:a.cellBorderColor)?e:"#3073f2"},get cellBorderLineWidth(){var i;return null!=(i=null==a?void 0:a.cellBorderLineWidth)?i:2},get inlineColumnBgColor(){return null==a?void 0:a.inlineColumnBgColor},get inlineRowBgColor(){return null==a?void 0:a.inlineRowBgColor},get selectionFillMode(){var r;return null!=(r=null==a?void 0:a.selectionFillMode)?r:"overlay"},get dynamicUpdateSelectionSize(){var n;return null!=(n=null==a?void 0:a.dynamicUpdateSelectionSize)&&n}}}return this._selectionStyle}get axisStyle(){if(!this._axisStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},e.axisStyle,t.axisStyle);this._axisStyle={defaultAxisStyle:i.defaultAxisStyle||{},leftAxisStyle:i.leftAxisStyle||{},rightAxisStyle:i.rightAxisStyle||{},topAxisStyle:i.topAxisStyle||{},bottomAxisStyle:i.bottomAxisStyle||{}}}return this._axisStyle}get checkboxStyle(){if(!this._checkboxStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},e.checkboxStyle,t.checkboxStyle);this._checkboxStyle=i}return this._checkboxStyle}get radioStyle(){if(!this._radioStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},e.radioStyle,t.radioStyle);this._radioStyle=i}return this._radioStyle}get switchStyle(){if(!this._switchStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},e.switchStyle,t.switchStyle);this._switchStyle=i}return this._switchStyle}get buttonStyle(){if(!this._buttonStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},e.buttonStyle,t.buttonStyle);this._buttonStyle=i}return this._buttonStyle}get textPopTipStyle(){if(!this._textPopTipStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},c,e.textPopTipStyle,t.textPopTipStyle);this._textPopTipStyle=i}return this._textPopTipStyle}get functionalIconsStyle(){if(!this._internalIconsStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,u.je)({},e.functionalIconsStyle,t.functionalIconsStyle);this._internalIconsStyle=i}return this._internalIconsStyle}hasProperty(t){let{obj:e,superTheme:i}=this.internalTheme;return f(e,t)||f(i,t)}extends(t){return new g((0,u.je)({},t),(0,u.je)({},this.internalTheme.superTheme,this.internalTheme.obj))}getStyle(t){let e=this;return{get fontSize(){return t.fontSize},get fontFamily(){return t.fontFamily},get fontWeight(){return t.fontWeight},get fontVariant(){return t.fontVariant},get fontStyle(){return t.fontStyle},get bgColor(){return t.bgColor},get color(){return t.color},get strokeColor(){return t.strokeColor},get borderColor(){return t.borderColor},get borderLineWidth(){return t.borderLineWidth},get borderLineDash(){return t.borderLineDash},get hover(){if(t.hover)return{get cellBgColor(){var i,r;return null!=(r=null==(i=t.hover)?void 0:i.cellBgColor)?r:void 0},get inlineColumnBgColor(){var n,s,l,a,o,h;return null!=(h=null!=(s=null==(n=t.hover)?void 0:n.inlineColumnBgColor)?s:(null==(l=t.hover)?void 0:l.cellBgColor)&&"string"==typeof(null==(a=t.hover)?void 0:a.cellBgColor)?(0,u.zX)(null==(o=t.hover)?void 0:o.cellBgColor,.1,!1):void 0)?h:void 0},get inlineRowBgColor(){var d,c,p,g,f,m;return null!=(m=null!=(c=null==(d=t.hover)?void 0:d.inlineRowBgColor)?c:(null==(p=t.hover)?void 0:p.cellBgColor)&&"string"==typeof(null==(g=t.hover)?void 0:g.cellBgColor)?(0,u.zX)(null==(f=t.hover)?void 0:f.cellBgColor,.1,!1):void 0)?m:void 0}}},get select(){return{get inlineColumnBgColor(){var y,v,b,_,x,C;return null!=(C=null!=(_=null!=(v=null==(y=t.select)?void 0:y.inlineColumnBgColor)?v:null==(b=e.selectionStyle)?void 0:b.inlineColumnBgColor)?_:(null==(x=e.selectionStyle)?void 0:x.cellBgColor)&&"string"==typeof e.selectionStyle.cellBgColor?(0,u.zX)(e.selectionStyle.cellBgColor,.1,!1):void 0)?C:void 0},get inlineRowBgColor(){var w,S,A,M,k;return null!=(k=null!=(A=null!=(S=null==(w=t.select)?void 0:w.inlineRowBgColor)?S:e.selectionStyle.inlineRowBgColor)?A:(null==(M=e.selectionStyle)?void 0:M.cellBgColor)&&"string"==typeof e.selectionStyle.cellBgColor?(0,u.zX)(e.selectionStyle.cellBgColor,.1,!1):void 0)?k:void 0},get cellBgColor(){var T,R,B;if("replace"===e.selectionStyle.selectionFillMode)return null!=(B=null!=(R=null==(T=t.select)?void 0:T.cellBgColor)?R:e.selectionStyle.cellBgColor)?B:void 0}}},get frameStyle(){if(t.frameStyle)return{get borderColor(){var P,E;return null!=(E=null==(P=t.frameStyle)?void 0:P.borderColor)?E:void 0},get borderLineWidth(){var I,L;return null!=(L=null==(I=t.frameStyle)?void 0:I.borderLineWidth)?L:void 0},get borderLineDash(){var F,O;return null!=(O=null==(F=t.frameStyle)?void 0:F.borderLineDash)?O:void 0}}},get padding(){return t.padding},get textAlign(){return t.textAlign},get textBaseline(){return t.textBaseline},get textOverflow(){return t.textOverflow},get lineHeight(){return t.lineHeight},get autoWrapText(){return t.autoWrapText},get lineClamp(){return t.lineClamp},get linkColor(){return t.linkColor},get cursor(){return t.cursor},get textStick(){return t.textStick},get marked(){return t.marked},get underline(){var D;return null!=(D=t.underline)&&D},get underlineColor(){return t.underlineColor},get underlineDash(){return t.underlineDash},get underlineOffset(){return t.underlineOffset},get lineThrough(){var H;return null!=(H=t.lineThrough)&&H},get lineThroughColor(){return t.lineThroughColor},get lineThroughDash(){return t.lineThroughDash}}}}function f(t,e){if(t instanceof g)return t.hasProperty(e);let i=t;if(!i)return!1;for(let t=0;t<e.length;t++)if(!(i=i[e[t]]))return!1;return!!i}let m=new g(n,n),y=new g(s,s),v=new g(l,l),b=new g(a,a),_=new g(o,o),x={DEFAULT:b,SIMPLIFY:_,ARCO:v,DARK:m,BRIGHT:y},C={TableTheme:g};function w(t){if(!t)return null;if("string"==typeof t){let e=(0,r.I0)(S(),t);return e?e instanceof g?e:new g(e,e):null}return t instanceof g?t:new g(t,t)}function S(){return(0,r.l7)(x,h.n)}let A={DARK:m,BRIGHT:y,ARCO:v,DEFAULT:b,SIMPLIFY:_,theme:C,of:w,get:S}},47191:function(t,e,i){"use strict";i.d(e,{n:()=>r});let r={}},5723:function(t,e,i){"use strict";i.d(e,{B:()=>s});var r=i(18585);let n=(t,e)=>{let i=0,r=t.length-1;for(;i<=r;){let n=Math.floor((i+r)/2);if(t[n]===e)return n;t[n]>e?r=n-1:i=n+1}return r<0?0:r};class s{constructor(){this._keys=[],this._vals={},this._sorted=!1}count(){return this._keys.length}values(){return this._vals}valueArr(){return Object.values(this._vals)}adjustOrder(t,e,i){let{_keys:r}=this;if(this._sorted||(r.sort((t,e)=>t<e?-1:+(t>e)),this._sorted=!0),t>e){let s=[];for(let l=n(r,t+i-1);l>=0;l--){let n=r[l];if(n>=t)s.push(this.get(n));else if(e<=n&&n<t)this.put(n+i,this.get(n));else if(n<e)break}for(let t=0;t<i;t++)this.put(e+t,s[i-1-t])}let{length:s}=r;if(t<e){let l=[];for(let a=n(r,t);a<s;a++){let n=r[a];if(n>=t&&n<t+i)l.push(this.get(n));else if(t+i<=n&&n<=e)this.put(n-i,this.get(n));else if(n>e)break}for(let t=0;t<i;t++)this.put(e+t,l[t])}}exchangeOrder(t,e,i,r,s){let{_keys:l}=this;if(this._sorted||(l.sort((t,e)=>t<e?-1:+(t>e)),this._sorted=!0),t>i){let r=[],a=[];for(let s=n(l,i);s<n(l,t)+e;s++){let i=l[s];i>=t&&i<t+e?a.push(this.get(i)):r.push(this.get(i))}for(let t=0;t<e;t++)this.put(s+t,a[t]);for(let t=0;t<r.length;t++)this.put(s+e+t,r[t])}else{let a=[],o=[];for(let s=n(l,t);s<n(l,i)+r;s++){let i=l[s];i>=t&&i<t+e?o.push(this.get(i)):a.push(this.get(i))}for(let t=0;t<e;t++)this.put(s+t,o[t]);for(let e=0;e<a.length;e++)this.put(t+e,a[e])}}del(t){delete this._vals[t];let e=this._keys.indexOf(t);-1!==e&&this._keys.splice(e,1)}put(t,e){t in this._vals||(this._keys.push(t),this._sorted=!1),this._vals[t]=e}get(t){return this._vals[t]}has(t){return(0,r.Z)(this._vals[t])}contain(t){return Object.values(this._vals).indexOf(t)>=0}each(t,e,i){let{_keys:r}=this,{length:s}=r;this._sorted||(r.sort((t,e)=>t<e?-1:+(t>e)),this._sorted=!0);for(let l=n(r,t);l<s;l++){let n=r[l];if(t<=n&&n<=e){if(!1===i(this.get(n),n))break}else if(e<n)return}}clear(){this._keys.length=0,this._vals={},this._sorted=!1}getLastIndex(){return this._keys[this._keys.length-1]}delLast(){let t=this.getLastIndex();this.del(t)}delAndReorder(t){if(!this.has(t))return;let e=this.getLastIndex();this.adjustOrder(t+1,t,e-t),this.delLast()}addAndReorder(t,e){if((0,r.Z)(e)){let i=this.getLastIndex();this.adjustOrder(t,t+1,i-t),this.put(t,e)}}}},28132:function(t,e,i){"use strict";i.d(e,{U:()=>n});var r=i(22295);class n{constructor(t,e,i,n){this.bounds=new r.YZ,this.bounds.set(t,e,t+i,e+n)}static bounds(t,e,i,r){return new n(t,e,Math.round(i-t),Math.round(r-e))}get left(){return this.bounds.x1}set left(t){this.bounds.x1=t}get top(){return this.bounds.y1}set top(t){this.bounds.y1=t}get right(){return this.bounds.x2}set right(t){this.bounds.x2=t}get bottom(){return this.bounds.y2}set bottom(t){this.bounds.y2=t}get width(){return this.bounds.width()}set width(t){this.bounds.x2=this.bounds.x1+t}get height(){return this.bounds.height()}set height(t){this.bounds.y2=this.bounds.y1+t}offsetLeft(t){this.bounds.translate(t,0)}offsetTop(t){this.bounds.translate(0,t)}copy(){return new n(this.left,this.top,this.width,this.height)}contains(t){return this.bounds.encloses(t.bounds)}inPoint(t,e){return this.bounds.contains(t,e)}}},16423:function(t,e,i){"use strict";i.d(e,{aR:()=>d,hU:()=>c});var r=i(29753),n=i(58977),s=i(58853),l=i(57657);function a(t){return t>=48&&t<=57}function o(t){return t>=97&&t<=122||t>=65&&t<=90||37===t}function h(t){return Error(`calc parse error: ${t}`)}let u={"*":3,"/":3,"+":2,"-":2};function d(t,e){var i;return"string"==typeof t?(i=t.trim(),function t(e,i){if(11===e.nodeType){let r=t(e.left,i),n=t(e.right,i);switch(e.op.value){case"+":return r+n;case"-":return r-n;case"*":return r*n;case"/":return r/n;default:throw Error(`calc error. unknown operator: ${e.op.value}`)}}if(10===e.nodeType)switch(e.unit){case"%":return e.value*i.full/100;case"px":return e.value;default:throw Error(`calc error. unknown unit: ${e.unit}`)}if(12===e.nodeType)return e.value;throw Error("calc error.")}(function t(e,i){function r(t){let e=t.pop(),r=t.pop(),n=t.pop();if(!(n&&n.nodeType&&r&&2===r.type&&e&&e.nodeType))throw h(i);return{nodeType:11,left:n,op:r,right:e}}let n=[];for(;e.length;){let s=e.shift();if(0===s.type&&"("===s.value){let r=0,s=l.IX.findIndex(e,t=>{if(0===t.type&&"("===t.value)r++;else if(0===t.type&&")"===t.value){if(!r)return!0;r--}return!1});if(-1===s)throw h(i);n.push(t(e.splice(0,s),i)),e.shift()}else if(2===s.type){if(n.length>=3){let t=n[n.length-2].value;u[s.value]<=u[t]&&n.push(r(n))}n.push(s)}else if(1===s.type){let{value:t,unit:e}=s;n.push({nodeType:10,value:t,unit:e})}else 3===s.type&&n.push({nodeType:12,value:s.value})}for(;n.length>1;)n.push(r(n));return n[0]}(function(t){let e=t.replace(/calc\(/g,"(").trim(),i=[],r=e.length;for(let s=0;s<r;s++){let l=e[s],o=l.charCodeAt(0);if("("===l||")"===l)i.push({value:l,type:0});else if("*"===l||"/"===l)i.push({value:l,type:2});else if("+"===l||"-"===l)s=function(t,s){if(s<r){let i=e[s],r=i.charCodeAt(0);if(a(r)||46===r)return n(t+i,s+1)}return i.push({value:t,type:2}),s}(l,s+1)-1;else if(a(o)||46===o)s=n(l,s+1)-1;else if(9!==o&&10!==o&&12!==o&&13!==o&&32!==o)throw h(t)}function n(n,s){let l=s;for(;l<r;l++){let s=e[l],u=s.charCodeAt(0);if(a(u))n+=s;else{if("."!==s){if(o(u))return function(t,n,s){let l=s;for(;l<r;l++){let t=e[l];if(!o(t.charCodeAt(0)))break;n+=t}return i.push({value:parseFloat(t),unit:n,type:1}),l}(n,s,l+1);break}if(n.indexOf(".")>=0)throw h(t);n+=s}}if("."===n)throw h(t);return i.push({value:parseFloat(n),type:3}),l}return i}(i),i),e)):t-0}function c(t){var e;return!!(0,s.Z)(t)&&!!t.endsWith("%")&&(e=t.substring(0,t.length-1),!(0,r.Z)(e)&&(!!(0,n.Z)(e)||+e==+e))}},67283:function(t,e,i){"use strict";i.d(e,{D:()=>l});let r=t=>{switch(Object.prototype.toString.call(t)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},n=(t,e)=>r(t)===e,s=t=>n(t,"object");function l(t,e,i){let r,n,l,a,o,h,u=0,d=!1,c=!1,p=!0,g=!e&&0!==e&&"function"==typeof requestAnimationFrame;if("function"!=typeof t)throw TypeError("Expected a function");function f(e){let i=r,s=n;return n=void 0,r=void 0,u=e,a=t.apply(s,i)}function m(t,e){return g?requestAnimationFrame(t):setTimeout(t,e)}function y(t){let i=t-h;return void 0===h||i>=e||i<0||d&&t-u>=l}function v(){let t=Date.now();if(y(t))return o=void 0,p&&r?f(t):(n=void 0,r=void 0,a);o=m(v,function(t){let i=t-u,r=e&&-(t-h);return d?Math.min(r,l-i):r}(t))}return e=+e||0,s(i)&&(c=!!i.leading,(d="maxWait"in i)&&(l=Math.max(+i.maxWait||0,e)),p="trailing"in i?!!i.trailing:p),function(...t){let i=Date.now(),s=y(i);if(r=t,n=this,h=i,s){if(void 0===o){var l;return u=l=h,o=m(v,e),c?f(l):a}if(d)return o=m(v,e),f(h)}return void 0===o&&(o=m(v,e)),a}}},18844:function(t,e,i){"use strict";function r(t,e){let i=document.createElement(t);return e&&i.classList.add(...e),i}i.d(e,{a:()=>r})},84375:function(t,e,i){"use strict";i.d(e,{X:()=>r,u:()=>n});class r{static get mode(){return r._mode||(r._mode=function(){let t="browser";try{"node"===window.type?t="node":"undefined"==typeof window||window.performance?"undefined"==typeof window&&(t="node"):t="miniApp"}catch(e){t="node"}return t}()),r._mode}static set mode(t){r._mode=t}static RegisterCreateCanvas(t){r.CreateCanvas=t}static RegisterLoadImage(t){r.LoadImage=t}static GetCreateCanvasFunc(){return r.CreateCanvas?r.CreateCanvas:"worker"===r.mode?(t=200,e=200)=>new OffscreenCanvas(t,e):void 0}static RegisterRequestAnimationFrame(t){r.RequestAnimationFrame=t()}static GetRequestAnimationFrame(){if(r.RequestAnimationFrame)return r.RequestAnimationFrame}static RegisterCancelAnimationFrame(t){r.CancelAnimationFrame=t()}static GetCancelAnimationFrame(){if(r.CancelAnimationFrame)return r.CancelAnimationFrame}}function n(){try{let t=window.getSelection();if(t){if("function"==typeof t.removeAllRanges)return void t.removeAllRanges();if("function"==typeof t.empty)return void t.empty();if("function"==typeof t.collapse)return void t.collapse(document.body,0)}}catch(t){}}r.dpr=0},13455:function(t,e,i){"use strict";i.d(e,{Rk:()=>n,Zj:()=>p,aE:()=>s,cT:()=>l,ek:()=>d,gm:()=>c,hW:()=>g,ho:()=>r,tP:()=>u,yZ:()=>h,z8:()=>o,zY:()=>a});let r=16,n="Arial,sans-serif",s="#FFF",l="#000",a=1,o=[],h="#000",u=/^(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/,d="$$indicator$$",c='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path  d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM549.333333 288a5.333333 5.333333 0 0 1 5.333334 5.333333V469.333333h176a5.333333 5.333333 0 0 1 5.333333 5.333334v74.666666a5.333333 5.333333 0 0 1-5.333333 5.333334H554.666667v176a5.333333 5.333333 0 0 1-5.333334 5.333333h-74.666666a5.333333 5.333333 0 0 1-5.333334-5.333333V554.666667H293.333333a5.333333 5.333333 0 0 1-5.333333-5.333334v-74.666666a5.333333 5.333333 0 0 1 5.333333-5.333334H469.333333V293.333333a5.333333 5.333333 0 0 1 5.333334-5.333333h74.666666z"></path></svg>',p='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM693.333333 469.333333a42.666667 42.666667 0 1 1 0 85.333334H330.666667a42.666667 42.666667 0 1 1 0-85.333334h362.666666z"></path></svg>',g={type:"line"}},57657:function(t,e,i){"use strict";let r,n;i.d(e,{B:()=>T,Bd:()=>k,I0:()=>b,IX:()=>a,JO:()=>_,NC:()=>v,TS:()=>f,UG:()=>l,Xh:()=>A,_Z:()=>x,ib:()=>S,j6:()=>M,l7:()=>p,nO:()=>B,oB:()=>R,tI:()=>y,vi:()=>m,vl:()=>g,yD:()=>C});var s=i(12588);let l="undefined"==typeof window||void 0===window.window,a={get find(){return r||(r=Array.prototype.find?(t,e)=>Array.prototype.find.call(t,e):(t,e)=>{let i=a.findIndex(t,e);return i>=0?t[i]:void 0})},get findIndex(){return n||(n=Array.prototype.findIndex?(t,e)=>Array.prototype.findIndex.call(t,e):(t,e)=>{let{length:i}=t;for(let r=0;r<i;r++)if(e(t[r],r,t))return r;return -1})}},{IE:o,Chrome:h,Firefox:u,Edge:d,Safari:c}=function(){if(l)return{IE:!1,Edge:!1,Chrome:!1,Firefox:!1,Safari:!1};let t=window.navigator.userAgent.toLowerCase();return{IE:!!/(msie|trident)/.exec(t),Edge:t.indexOf("edge")>-1,Chrome:t.indexOf("chrome")>-1&&-1===t.indexOf("edge"),Firefox:t.indexOf("firefox")>-1,Safari:t.indexOf("safari")>-1&&-1===t.indexOf("edge")}}();function p(...t){let e={};return t.forEach(t=>{for(let i in t)Object.defineProperty(e,i,{get:()=>t[i],set(e){t[i]=e},configurable:!0,enumerable:!0})}),e}function g(t,e,...i){let r=t;for(let t=0;t<i.length&&null!=r;t++)r=e(r,i[t]);return r}function f(t,...e){return g(t,(t,e)=>t[e],...e)}function m(t,...e){return"function"==typeof t?t(...e):t}function y(t){return!!(t&&"function"==typeof t.then)}function v(t,e){y(t)?t.then(t=>{e(t)}).catch(t=>{}):e(t)}function b(t,e){if(t[e])return t[e];let i=e.toLowerCase();if(t[i])return t[i];let r=e.toLowerCase();if(t[r])return t[r];for(let e in t)if(e.toLowerCase()===i)return t[e]}function _(t){return Array.isArray(t)?3===t.length?[t[0],t[1],t[2],t[1]]:2===t.length?[t[0],t[1],t[0],t[1]]:1===t.length?[t[0],t[0],t[0],t[0]]:[t[0],t[1],t[2],t[3]]:[t,t,t,t]}function x(t,e,i){return t.start.col<=e&&e<=t.end.col&&t.start.row<=i&&i<=t.end.row||t.end.col<=e&&e<=t.start.col&&t.end.row<=i&&i<=t.start.row||t.end.col<=e&&e<=t.start.col&&t.start.row<=i&&i<=t.end.row||t.start.col<=e&&e<=t.end.col&&t.end.row<=i&&i<=t.start.row}function C(t,e,i){for(let r=0;r<t.length;r++){let n=t[r],s=Math.min(n.start.col,n.end.col),l=Math.max(n.start.col,n.end.col),a=Math.min(n.start.row,n.end.row),o=Math.max(n.start.row,n.end.row);if(s<=e&&e<=l&&a<=i&&i<=o||l<=e&&e<=s&&o<=i&&i<=a)return!0}return!1}function w(t){return{start:{col:Math.min(t.start.col,t.end.col),row:Math.min(t.start.row,t.end.row)},end:{col:Math.max(t.start.col,t.end.col),row:Math.max(t.start.row,t.end.row)}}}function S(t,e){let i=w(t),r=w(e);return!!(Math.max(i.start.col,r.start.col)<=Math.min(i.end.col,r.end.col)&&Math.max(i.start.row,r.start.row)<=Math.min(i.end.row,r.end.row))}let A={IE:o,Edge:d,Chrome:h,Firefox:u,Safari:c,heightLimit:h?0x1ffffff:u?0x11110a4:0xa3d719},M={isObject:function(t){return t===Object(t)}},k={endsWith:function(t,e,i){let r=(0,s.cw)(t);("number"!=typeof i||!isFinite(i)||Math.floor(i)!==i||i>r.length)&&(i=r.length),i-=e.length;let n=r.lastIndexOf(e,i);return -1!==n&&n===i}},T={isTouchEvent:function(t){return!!t.changedTouches}},R={toBoxArray:_},B=Function.prototype},80852:function(t,e,i){"use strict";function r(t,e){if(!e||!e.proxy)return{colStart:0,colEnd:0,rowStart:0,rowEnd:0};let{mergeStartCol:i,mergeEndCol:r,mergeStartRow:n,mergeEndRow:s,col:l,row:a}=t;return{colStart:i,colEnd:r,rowStart:n,rowEnd:s}}function n(t,e){let i=t.start.col,r=t.end.col,n=t.start.row,s=t.end.row,l=i,a=r,o=n,h=s;for(let t=i;t<=r;t++)for(let i=n;i<=s;i++){let r=e.getCellRange(t,i);r&&(l=Math.min(l,r.start.col),a=Math.max(a,r.end.col),o=Math.min(o,r.start.row),h=Math.max(h,r.end.row))}return t.start.col=l,t.end.col=a,t.start.row=o,t.end.row=h,t}i.d(e,{T:()=>n,e:()=>r})},61482:function(t,e,i){"use strict";i.d(e,{Iv:()=>l,KV:()=>o,NR:()=>h,Z7:()=>u,vP:()=>s,z5:()=>a});var r=i(18585),n=i(43735);function s(t){var e;return(null==t?void 0:t.hoverOn)||(null==t?void 0:t.horizontalVisible)&&"none"===(null==t?void 0:t.horizontalVisible)||!(null==t?void 0:t.horizontalVisible)&&"none"===(null==t?void 0:t.visible)?0:null!=(e=null==t?void 0:t.width)?e:7}function l(t){var e;return(null==t?void 0:t.hoverOn)||(null==t?void 0:t.verticalVisible)&&"none"===(null==t?void 0:t.verticalVisible)||!(null==t?void 0:t.verticalVisible)&&"none"===(null==t?void 0:t.visible)?0:null!=(e=null==t?void 0:t.width)?e:7}function a(t){return!!(0,r.Z)(t)&&(!(0,n.Z)(t)||t.some(t=>(0,r.Z)(t)))}function o(t){return 0===t||(0,n.Z)(t)&&t.every(t=>0===t)}function h(t){let e=t.stateManager.select.ranges,i=[];for(let t=0;t<e.length;t++){let r=e[t];i.push({range:r,style:{cellBorderColor:"blue",cellBorderLineWidth:2,cellBorderLineDash:[5,5]}})}t.stateManager.setCustomSelectRanges(i)}function u(t){t.stateManager.setCustomSelectRanges([])}},12588:function(t,e,i){"use strict";i.d(e,{E5:()=>g,Ed:()=>w,K$:()=>b,MU:()=>_,P2:()=>p,Zf:()=>x,cw:()=>y,je:()=>function t(e,...i){if(!i.length)return e||{};let r=i.shift();if(a(e)&&a(r))for(let i in r)a(r[i])?(e[i]||Object.assign(e,{[i]:{}}),a(e[i])||Object.assign(e,{[i]:r[i]}),t(e[i],r[i])):null!==r[i]&&void 0!==r[i]&&Object.assign(e,{[i]:r[i]});return t(e,...i)},m7:()=>d,oM:()=>C,p4:()=>c,pr:()=>function t(e,i,r){let s=0;if(!i||i===n.g.collapse||i===n.g.none)return s;let l=r.filteredChildren?r.filteredChildren:r.children;if(l)for(let i=0;i<l.length;i++)s+=1,s+=t(Array.isArray(e)?e.concat([i]):[e,i],l[i].hierarchyState,l[i]);return s},tq:()=>v,yW:()=>function t(e,i,r){r(e),(null==e?void 0:e[i])&&Array.isArray(null==e?void 0:e[i])&&e[i].forEach(e=>t(e,i,r))},zX:()=>m});var r=i(18585),n=i(73664);let s=t=>{switch(Object.prototype.toString.call(t)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},l=(t,e)=>s(t)===e,a=t=>l(t,"object"),o=t=>l(t,"string"),h=t=>l(t,"number"),u=t=>l(t,"boolean");function d(t){return"function"==typeof t&&(t=t()),(0,r.Z)(t)?`${t}`:""}function c(t){if((null==t?void 0:t.length)<=0)return t;let e=t.length,i=t[0].length,r=Array(i);for(let n=0;n<e;n++)for(let s=0;s<i;s++)r[s]||(r[s]=Array(e)),r[s][n]=t[n][s];return r}function p(t,e){let i=null;return function(...r){i||(t.apply(this,r),i=setTimeout(()=>{i=null},e))}}function g(t,e){let i=null;return function(...r){i||(i=setTimeout(()=>{t.apply(this,r),i=null},e))}}function f(t,e){for(t=`${t}`;t.length<e;)t="0"+t;return t}function m(t,e,i){t=(t=t.replace(/^\s*|\s*$/,"")).replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3");let n=Math.round(256*e)*(i?-1:1),s=t.match(RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),l=s&&(0,r.Z)(s[4])?s[4]:null,a=s?[s[1],s[2],s[3]]:t.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return`${parseInt(arguments[1],16)},${parseInt(arguments[2],16)},${parseInt(arguments[3],16)}`}).split(/,/);return s?`rgb${null!==l?"a":""}(${Math[i?"max":"min"](parseInt(a[0],10)+n,255*!i)}, ${Math[i?"max":"min"](parseInt(a[1],10)+n,255*!i)}, ${Math[i?"max":"min"](parseInt(a[2],10)+n,255*!i)}${null!==l?`, ${l}`:""})`:["#",f(Math[i?"max":"min"](parseInt(a[0],10)+n,255*!i).toString(16),2),f(Math[i?"max":"min"](parseInt(a[1],10)+n,255*!i).toString(16),2),f(Math[i?"max":"min"](parseInt(a[2],10)+n,255*!i).toString(16),2)].join("")}function y(t){return o(t)||h(t)||u(t)?t.toString():""}function v(){return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)}function b(t,e,i){return"desc"!==i?t===e?0:t>e?1:-1:t===e?0:t<e?1:-1}function _(t,e){let i,r=t;for(;(i=e.shift())&&(r=r[i]););return r}function x(t){return/^-?\d+(\.\d+)?$/.test(t)}function C(t){let e=[];for(let i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}function w(t){let e=window.getSelection();if(e.rangeCount){let i=e.getRangeAt(0);return i.endOffset>i.startOffset&&t.contains(i.commonAncestorContainer)}return!1}},83093:function(t,e,i){"use strict";i.d(e,{n:()=>r});let r=["bgColor","color","strokeColor","borderColor","linkColor"]},37902:function(t,e,i){"use strict";var r,n,s,l;i.d(e,{F:()=>r,p:()=>n}),(s=r||(r={})).default="default",s.grabing="grabing",s.scrolling="scrolling",(l=n||(n={})).single="single",l.column="column",l.row="row",l.cross="cross",l.none="none"},39940:function(t,e,i){"use strict";i.d(e,{Fn:()=>g,Js:()=>h,MR:()=>b,NF:()=>f,SL:()=>v,U4:()=>u,YJ:()=>s,ZP:()=>c,__:()=>d,hT:()=>a,jk:()=>l,ky:()=>p,ld:()=>o,vg:()=>m,y4:()=>y});var r=i(18585),n=i(20595);let s={};class l{constructor(t){var e;this.isAggregator=!0,this.isRecord=!0,this.records=[],this.children=[],this.key=t.key,this.field=t.field,this.formatFun=t.formatFun,this.isRecord=null!=(e=t.isRecord)?e:this.isRecord}clearCacheValue(){this._formatedValue=void 0}formatValue(t,e,i){return this._formatedValue||(this.formatFun?this._formatedValue=this.formatFun(this.value(),t,e,i):this._formatedValue=this.value()),this._formatedValue}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.clearCacheValue()}}class a extends l{constructor(){super(...arguments),this.type=n.E.RECORD,this.isRecord=!0}push(t){t&&this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children&&this.children.push(t),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t))),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.clearCacheValue())}value(){var t;return null!=(t=this.changedValue)?t:this.records}reset(){this.children=[],this.changedValue=void 0,this.records=[]}recalculate(){}}class o extends l{constructor(){super(...arguments),this.type=n.E.NONE,this.isRecord=!0}push(t){t&&(this.isRecord&&(this.records=[t]),t.isAggregator&&this.children&&(this.children=[t]),this.field&&(this.fieldValue=t[this.field])),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field]),this.clearCacheValue())}value(){var t;return null!=(t=this.changedValue)?t:this.fieldValue}reset(){this.children=[],this.changedValue=void 0,this.records=[],this.fieldValue=void 0}recalculate(){}}class h extends l{constructor(t){super(t),this.type=n.E.CUSTOM,this.isRecord=!0,this.values=[],this.aggregationFun=t.aggregationFun}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children&&this.children.push(t),this.field&&this.values.push(t[this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.field&&this.records.length&&(this.values=this.records.map(t=>t[this.field])),this.clearCacheValue())}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.field&&this.records.length&&(this.values=this.records.map(t=>t[this.field]))),this.clearCacheValue()}value(){var t,e;return this.fieldValue||(this.fieldValue=null==(t=this.aggregationFun)?void 0:t.call(this,this.values,this.records,this.field)),null!=(e=this.changedValue)?e:this.fieldValue}reset(){this.records=[],this.children=[],this.changedValue=void 0,this.fieldValue=void 0}recalculate(){this.fieldValue=void 0,this._formatedValue=void 0}}class u extends l{constructor(t){super(t),this.type=n.E.RECALCULATE,this.isRecord=!0,this.calculateFun=t.calculateFun,this.dependAggregators=t.dependAggregators,this.dependIndicatorKeys=t.dependIndicatorKeys}push(t){t&&this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),this.children&&t.isAggregator&&this.children.push(t),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t))),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.clearCacheValue())}value(){var t,e;if(!this.fieldValue){let e=function(t,e){let i={};for(let r=0;r<(null==e?void 0:e.length);r++){let n=t.find(t=>(null==t?void 0:t.key)===e[r]);n&&(i[n.key]=null==n?void 0:n.value())}return i}(this.dependAggregators,this.dependIndicatorKeys);this.fieldValue=null==(t=this.calculateFun)?void 0:t.call(this,e,this.records,this.field)}return null!=(e=this.changedValue)?e:this.fieldValue}reset(){this.records=[],this.children=[],this.changedValue=void 0,this.fieldValue=void 0}recalculate(){}}class d extends l{constructor(t){var e;super(t),this.type=n.E.SUM,this.sum=0,this.positiveSum=0,this.nagetiveSum=0,this.needSplitPositiveAndNegativeForSum=!1,this.needSplitPositiveAndNegativeForSum=null!=(e=t.needSplitPositiveAndNegative)&&e}push(t){if(t){if(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children){this.children.push(t);let e=t.value();this.sum+=null!=e?e:0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){let e=parseFloat(t[this.field]);this.sum+=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}}this.clearCacheValue()}deleteRecord(t){if(t){if(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children){this.children=this.children.filter(e=>e!==t);let e=t.value();this.sum-=null!=e?e:0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){let e=parseFloat(t[this.field]);this.sum-=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}}this.clearCacheValue()}updateRecord(t,e){if(t&&e){if(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&this.children){let i=t.value();this.children=this.children.filter(e=>e!==t);let r=e.value();this.children.push(e),this.sum+=r-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),r>0?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){let i=parseFloat(t[this.field]),r=parseFloat(e[this.field]);this.sum+=r-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),r>0?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r))}this.clearCacheValue()}}value(){var t,e;return null!=(t=this.changedValue)?t:(null==(e=this.records)?void 0:e.length)>=1?this.sum:void 0}positiveValue(){return this.positiveSum}negativeValue(){return this.nagetiveSum}reset(){super.reset(),this.records=[],this.sum=0}recalculate(){if(this.sum=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator){let t=e.value();this.sum+=null!=t?t:0,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))}}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];if(e.isAggregator){let t=e.value();this.sum+=null!=t?t:0,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))}else if(this.field&&!isNaN(parseFloat(e[this.field]))){let t=parseFloat(e[this.field]);this.sum+=t,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))}}}}class c extends l{constructor(){super(...arguments),this.type=n.E.COUNT,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.count+=t.value()):this.count++),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator?(this.children&&(this.children=this.children.filter(e=>e!==t)),this.count-=t.value()):this.count--),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&(this.count+=e.value()-t.value()),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)))}value(){var t;return null!=(t=this.changedValue)?t:this.count}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.count=0}recalculate(){if(this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator){let t=e.value();this.count+=null!=t?t:0}else this.count++}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];e.isAggregator?this.count+=e.value():this.count++}}}class p extends l{constructor(){super(...arguments),this.type=n.E.AVG,this.sum=0,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&t.type===n.E.AVG?(this.children&&this.children.push(t),this.sum+=t.sum,this.count+=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(t[this.field]),this.count++)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&t.type===n.E.AVG?(this.children&&(this.children=this.children.filter(e=>e!==t)),this.sum-=t.sum,this.count-=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum-=parseFloat(t[this.field]),this.count--)),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&t.type===n.E.AVG?(this.children&&e.isAggregator&&(this.children=this.children.map(i=>i===t?e:i)),this.sum+=e.sum-t.sum,this.count+=e.count-t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(e[this.field])-parseFloat(t[this.field])),this.clearCacheValue())}value(){var t,e;return null!=(t=this.changedValue)?t:(null==(e=this.records)?void 0:e.length)>=1?this.sum/this.count:void 0}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.sum=0,this.count=0}recalculate(){if(this.sum=0,this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator&&e.type===n.E.AVG){let t=e.value();this.sum+=t*e.count,this.count+=e.count}}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];e.isAggregator&&e.type===n.E.AVG?(this.sum+=e.sum,this.count+=e.count):this.field&&!isNaN(parseFloat(e[this.field]))&&(this.sum+=parseFloat(e[this.field]),this.count++)}}}class g extends l{constructor(){super(...arguments),this.type=n.E.MAX,this.max=Number.MIN_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.max=t.max>this.max?t.max:this.max):"number"==typeof t?this.max=t>this.max?t:this.max:this.field&&"number"==typeof t[this.field]?this.max=t[this.field]>this.max?t[this.field]:this.max:this.field&&!isNaN(t[this.field])&&(this.max=parseFloat(t[this.field])>this.max?parseFloat(t[this.field]):this.max)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.recalculate())}value(){var t,e;return null!=(t=this.changedValue)?t:(null==(e=this.records)?void 0:e.length)>=1?this.max:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.max=Number.MIN_SAFE_INTEGER}recalculate(){if(this.max=Number.MIN_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator){let t=e.value();this.max=Math.max(this.max,t)}}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];e.isAggregator?this.max=e.max>this.max?e.max:this.max:"number"==typeof e?this.max=e>this.max?e:this.max:this.field&&"number"==typeof e[this.field]?this.max=e[this.field]>this.max?e[this.field]:this.max:this.field&&!isNaN(e[this.field])&&(this.max=parseFloat(e[this.field])>this.max?parseFloat(e[this.field]):this.max)}}}class f extends l{constructor(){super(...arguments),this.type=n.E.MIN,this.min=Number.MAX_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.min=t.min<this.min?t.min:this.min):"number"==typeof t?this.min=t<this.min?t:this.min:this.field&&"number"==typeof t[this.field]?this.min=t[this.field]<this.min?t[this.field]:this.min:this.field&&!isNaN(t[this.field])&&(this.min=parseFloat(t[this.field])<this.min?parseFloat(t[this.field]):this.min)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.recalculate())}value(){var t,e;return null!=(t=this.changedValue)?t:(null==(e=this.records)?void 0:e.length)>=1?this.min:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.min=Number.MAX_SAFE_INTEGER}recalculate(){if(this.min=Number.MAX_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator){let t=e.value();this.min=Math.min(this.min,t)}}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];e.isAggregator?this.min=e.min<this.min?e.min:this.min:"number"==typeof e?this.min=e<this.min?e:this.min:this.field&&"number"==typeof e[this.field]?this.min=e[this.field]<this.min?e[this.field]:this.min:this.field&&!isNaN(e[this.field])&&(this.min=parseFloat(e[this.field])<this.min?parseFloat(e[this.field]):this.min)}}}function m(t,e){return t&&e?t.toString().localeCompare(e.toString(),"zh"):t?1:-1}function y(t,e,i){if(i===n.F.NORMAL||i===n.F.normal)return 0;let r=i===n.F.DESC||i===n.F.desc?-1:1;return t&&e?t.toString().localeCompare(e.toString(),"zh")*r:t?+r:-1*r}function v(t,e,i){if(i===n.F.NORMAL||i===n.F.normal)return 0;let r=/(\d+)|(\D+)/g,s=/\d/,l=/^0/,a,o,h,u,d=0,c=0,p=i===n.F.DESC||i===n.F.desc?-1:1;if(null!==e&&null===t)return -1*p;if(null!==t&&null===e)return+p;if("number"==typeof t&&isNaN(t))return -1*p;if("number"==typeof e&&isNaN(e))return+p;if((d=+t)<(c=+e))return -1*p;if(d>c)return+p;if("number"==typeof t&&"number"!=typeof e)return -1*p;if("number"==typeof e&&"number"!=typeof t)return+p;if("number"==typeof t&&"number"==typeof e)return 0;if(isNaN(c)&&!isNaN(d))return -1*p;if(isNaN(d)&&!isNaN(c))return+p;if((a=String(t))===(h=String(e)))return 0;if(!s.test(a)||!s.test(h))return(a>h?1:-1)*p;for(a=a.match(r),h=h.match(r);a.length&&h.length;)if((o=a.shift())!==(u=h.shift()))return s.test(o)&&s.test(u)?(o.replace(l,".0")-u.replace(l,".0"))*p:(o>u?1:-1)*p;return(a.length-h.length)*p}function b(t){let e,i={},s={};for(let r=0;r<t.length;r++)i[e=t[r]]=r,"string"==typeof e&&(s[e.toLowerCase()]=r);return function(t,e,l){let a;if(l===n.F.NORMAL||l===n.F.normal)return 0;let o=l===n.F.DESC||l===n.F.desc?-1:1;return null!==i[t]&&void 0!==i[t]&&null!==i[e]&&void 0!==i[e]?a=i[t]-i[e]:null!==i[t]&&void 0!==i[t]?a=-1:null!==i[e]&&void 0!==i[e]?a=1:null!==s[t]&&void 0!==i[t]&&null!==s[e]&&void 0!==i[e]?a=s[t]-s[e]:null===s[t]||void 0===i[t]||null===s[e]||void 0===i[e]?a=0:null!==s[t]&&void 0!==i[t]?a=-1:null!==s[e]&&void 0!==i[e]&&(a=1),(0,r.Z)(a)?a*o:v(t,e,l)}}},44186:function(t,e,i){"use strict";var r,n,s,l,a,o;i.d(e,{cI:()=>n,q0:()=>r,up:()=>s}),(l=r||(r={})).inlineFront="inlineFront",l.inlineEnd="inlineEnd",l.left="left",l.right="right",l.absoluteRight="absoluteRight",l.contentLeft="contentLeft",l.contentRight="contentRight",l.absolute="absolute",(a=n||(n={})).frozen="frozen",a.sort="sort",a.dropDown="dropDown",a.dropDownState="dropDownState",a.play="play",a.damagePic="damagePic",a.expand="expand",a.collapse="collapse",a.drillDown="drillDown",a.drillUp="drillUp",a.dragReorder="dragReorder",(o=s||(s={})).upwardIconName="sort_upward",o.downwardIconName="sort_downward",o.normalIconName="sort_normal",o.freezeIconName="freeze",o.frozenIconName="frozen",o.frozenCurrentIconName="frozenCurrent",o.dropdownIconName="dropdownIcon",o.expandIconName="expand",o.collapseIconName="collapse",o.dragReorderIconName="dragReorder",o.loadingIconName="loading"},20595:function(t,e,i){"use strict";var r,n,s,l;i.d(e,{E:()=>r,F:()=>n}),(s=r||(r={})).RECORD="RECORD",s.NONE="NONE",s.SUM="SUM",s.MIN="MIN",s.MAX="MAX",s.AVG="AVG",s.COUNT="COUNT",s.CUSTOM="CUSTOM",s.RECALCULATE="RECALCULATE",(l=n||(n={})).ASC="ASC",l.DESC="DESC",l.NORMAL="NORMAL",l.desc="desc",l.asc="asc",l.normal="normal"},46894:function(t,e,i){"use strict";i.d(e,{Z:()=>l,z:()=>s});var r=i(99506),n=i(57657);let s=(0,n.l7)(r.B,{PIVOT_SORT_CLICK:"pivot_sort_click",DRILLMENU_CLICK:"drillmenu_click"}),l=(0,n.l7)(r.B,{VCHART_EVENT_TYPE:"vchart_event_type"})},73664:function(t,e,i){"use strict";var r,n,s,l;i.d(e,{g:()=>n,u:()=>r}),(s=r||(r={})).top="top",s.bottom="bottom",s.left="left",s.right="right",(l=n||(n={})).expand="expand",l.collapse="collapse",l.none="none",l.loading="loading"},42517:function(t,e,i){"use strict";i.d(e,{sTO:()=>k});var r=i(1788),n=i(89983),s=i(27865),l=i(91018),a=i(4062),o=i(40398),h=i(76620),u=i(9911);let d=new h.FB;class c{constructor(){this.name="FlexLayoutPlugin",this.activeEvent="onRegister",this.id=o.R.GenAutoIncrementId(),this.key=this.name+this.id,this.tempBounds=new h.FB}pauseLayout(t){this.pause=t}tryLayoutChildren(t){t.firstChild&&this.tryLayout(t.firstChild)}tryLayout(t,e=!0){if(this.pause)return;let i=t.parent;if(!(e||i&&t.needUpdateLayout()))return;let r=(0,a.gh)(i).group,{display:n=r.display}=i.attribute;if("flex"!==n)return;let{flexDirection:s=r.flexDirection,flexWrap:l=r.flexWrap,alignItems:o=r.alignItems,clip:h=r.clip}=i.attribute,{alignContent:u=null!=o?o:r.alignContent}=i.attribute,{width:d,height:c,justifyContent:p=r.justifyContent}=i.attribute,g=i.getChildren();if(null==d||null==c){let t=0,e=0,i=0;if(g.forEach(r=>{let n=this.getAABBBounds(r);n.empty()||("column"===s||"column-reverse"===s?(e+=n.height(),t=Math.max(t,n.width())):(t+=n.width(),e=Math.max(e,n.height())),i+=n.x1,i+=n.y1,i+=n.x2,i+=n.y2)}),!isFinite(i))return;d=t,c=e}null==i.attribute.width?i.attribute.width=d:d=i.attribute.width,null==i.attribute.height?i.attribute.height=c:c=i.attribute.height,this.tempBounds.copy(i._AABBBounds);let f={main:{len:d,field:"x"},cross:{len:c,field:"y"}},m=f.main,y=f.cross;"column"!==s&&"column-reverse"!==s||(m.len=c,y.len=d,m.field="y",y.field="x"),"row-reverse"!==s&&"column-reverse"!==s||("flex-start"===p?p="flex-end":"flex-end"===p?p="flex-start":g.reverse());let v=0,b=0,_=[];g.forEach(t=>{let e=this.getAABBBounds(t);if(e.empty())return;let i="x"===m.field?e.width():e.height(),r="x"===y.field?e.width():e.height();_.push({mainLen:i,crossLen:r}),v+=i,b=Math.max(b,r)});let x=[];if(v>m.len&&"wrap"===l){let t=0,e=0;_.forEach(({mainLen:i,crossLen:r},n)=>{t+i>m.len?0===t?(x.push({idx:n,mainLen:t+i,crossLen:r}),t=0,e=0):(x.push({idx:n-1,mainLen:t,crossLen:e}),t=i,e=r):(t+=i,e=Math.max(e,r))}),x.push({idx:_.length-1,mainLen:t,crossLen:e})}else x.push({idx:_.length-1,mainLen:v,crossLen:b});let C=0;if(x.forEach(t=>{this.layoutMain(i,g,p,m,_,C,t),C=t.idx+1}),b=x.reduce((t,e)=>t+e.crossLen,0),1===x.length){let t={"flex-start":0,"flex-end":y.len,center:y.len/2};this.layoutCross(g,o,y,t,_,x[0],0)}else if("flex-start"===u){C=0;let t=0;x.forEach((e,i)=>{let r={"flex-start":t,"flex-end":t+e.crossLen,center:t+e.crossLen/2};this.layoutCross(g,"flex-start",y,r,_,x[i],C),C=e.idx+1,t+=e.crossLen})}else if("center"===u){C=0;let t=Math.max(0,(y.len-b)/2);x.forEach((e,i)=>{let r={"flex-start":t,"flex-end":t+e.crossLen,center:t+e.crossLen/2};this.layoutCross(g,"center",y,r,_,x[i],C),C=e.idx+1,t+=e.crossLen})}else if("space-around"===u){C=0;let t=Math.max(0,(y.len-b)/x.length/2),e=t;x.forEach((i,r)=>{let n={"flex-start":e,"flex-end":e+i.crossLen,center:e+i.crossLen/2};this.layoutCross(g,"flex-start",y,n,_,x[r],C),C=i.idx+1,e+=i.crossLen+2*t})}else if("space-between"===u){C=0;let t=Math.max(0,(y.len-b)/(2*x.length-2)),e=0;x.forEach((i,r)=>{let n={"flex-start":e,"flex-end":e+i.crossLen,center:e+i.crossLen/2};this.layoutCross(g,"flex-start",y,n,_,x[r],C),C=i.idx+1,e+=i.crossLen+2*t})}g.forEach((t,e)=>{t.addUpdateBoundTag(),t.addUpdatePositionTag(),t.clearUpdateLayoutTag()}),i.addUpdateLayoutTag();let w=this.getAABBBounds(i);h||this.tempBounds.equals(w)||this.tryLayout(i,!1)}getAABBBounds(t){this.skipBoundsTrigger=!0;let e=t.AABBBounds;return this.skipBoundsTrigger=!1,e}updateChildPos(t,e,i){return t+(null!=e?e:0)-i}layoutMain(t,e,i,r,n,s,l){var a,o,h,u,d,c,p,g,f,m,y,v,b,_;if("flex-start"===i){let t=0;for(let i=s;i<=l.idx;i++){let s=t+(a=e[i],o=r.field,0),l=this.getAABBBounds(e[i]);l.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],l[`${r.field}1`])),t+=n[i].mainLen}}else if("flex-end"===i){let t=r.len;for(let i=l.idx;i>=s;i--){let s=(t-=n[i].mainLen)+(h=e[i],u=r.field,0),l=this.getAABBBounds(e[i]);l.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],l[`${r.field}1`]))}}else if("space-around"===i)if(l.mainLen>=r.len){let t=0;for(let i=s;i<=l.idx;i++){let s=t+(d=e[i],c=r.field,0),l=this.getAABBBounds(e[i]);l.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],l[`${r.field}1`])),t+=n[i].mainLen}}else{let t=l.idx-s+1,i=(r.len-l.mainLen)/t/2,a=i;for(let t=s;t<=l.idx;t++){let s=a+(p=e[t],g=r.field,0),l=this.getAABBBounds(e[t]);l.empty()||(e[t].attribute[r.field]=this.updateChildPos(s,e[t].attribute[r.field],l[`${r.field}1`])),a+=n[t].mainLen+2*i}}else if("space-between"===i)if(l.mainLen>=r.len){let t=0;for(let i=s;i<=l.idx;i++){let s=t+(f=e[i],m=r.field,0),l=this.getAABBBounds(e[i]);l.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],l[`${r.field}1`])),t+=n[i].mainLen}}else{let t=l.idx-s+1,i=(r.len-l.mainLen)/(2*t-2),a=0;for(let t=s;t<=l.idx;t++){let s=a+(y=e[t],v=r.field,0),l=this.getAABBBounds(e[t]);l.empty()||(e[t].attribute[r.field]=this.updateChildPos(s,e[t].attribute[r.field],l[`${r.field}1`])),a+=n[t].mainLen+2*i}}else if("center"===i){let t=(r.len-l.mainLen)/2;for(let i=s;i<=l.idx;i++){let s=t+(b=e[i],_=r.field,0),l=this.getAABBBounds(e[i]);l.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],l[`${r.field}1`])),t+=n[i].mainLen}}}layoutCross(t,e,i,r,n,s,l){var a,o,h,u,d,c,p;for(let g=l;g<=s.idx;g++){let s=t[g],{alignSelf:l}=s.attribute;l&&"auto"!==l||(l=e);let f=this.getAABBBounds(s),m=null!=(a=r[l])?a:r["flex-start"];"flex-end"===l?f.empty()||(s.attribute[i.field]=this.updateChildPos(m-n[g].crossLen+(o=0,h=i.field,0),s.attribute[i.field],f[`${i.field}1`])):"center"===l?f.empty()||(s.attribute[i.field]=this.updateChildPos(m-n[g].crossLen/2+(u=0,d=i.field,0),s.attribute[i.field],f[`${i.field}1`])):f.empty()||(s.attribute[i.field]=this.updateChildPos(m+(c=0,p=i.field,0),s.attribute[i.field],f[`${i.field}1`]))}}activate(t){this.pluginService=t;let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,t=>{t.glyphHost&&(t=t.glyphHost),t.stage&&t.stage===this.pluginService.stage&&this.tryLayout(t,!1)}),e.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(t,e,i,r)=>{t.glyphHost&&(t=t.glyphHost),e&&e===this.pluginService.stage&&t.isContainer&&!this.skipBoundsTrigger&&d.copy(r)}),e.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(t,e,i,r,n)=>{e&&e===this.pluginService.stage&&t.isContainer&&!this.skipBoundsTrigger&&(d.equals(i)||this.tryLayout(t,!1))}),e.graphicService.hooks.onSetStage.tap(this.key,t=>{t.glyphHost&&(t=t.glyphHost),this.tryLayout(t,!1)}))}deactivate(t){let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.taps=e.graphicService.hooks.onAttributeUpdate.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.beforeUpdateAABBBounds.taps=e.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.afterUpdateAABBBounds.taps=e.graphicService.hooks.afterUpdateAABBBounds.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.onSetStage.taps=e.graphicService.hooks.onSetStage.taps.filter(t=>t.name!==this.key))}}let p=()=>{u.F.registerPlugin("FlexLayoutPlugin",c)};var g=i(59526),f=i(37438),m=i(16483),y=i(51619),v=i(15589),b=i(96628),_=i(79134),x=i(86972),C=i(840),w=i(96531),S=i(95694),A=i(69877);let M=!1;function k(){M||(M=!0,(0,n.VJ)(),(0,s.kP)()?(0,g.Ns)(l.n):(0,s.KV)()&&(0,f.sn)(l.n),(0,m.x)(),(0,y.f)(),(0,v.M)(),(0,b.i)(),(0,_.N)(),(0,x.k)(),(0,C.v)(),(0,w.W)(),(0,S.k)(),(0,A.g)(),p(),(0,r.C)(),p())}},70656:function(t,e,i){"use strict";i.d(e,{u:()=>function t(e,i=["data"]){let u;if(!(0,r.Z)(e)||"object"!=typeof e||(0,h.vI)(e)||function(t){try{return t instanceof Element}catch(i){let e=Object.keys(t);return["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"].every(t=>e.includes(t))}}(e))return e;let d=(0,n.Z)(e),c=e.length;u=d?Array(c):"object"==typeof e?{}:(0,s.Z)(e)||(0,l.Z)(e)||(0,a.Z)(e)?e:(0,o.Z)(e)?new Date(+e):void 0;let p=d?void 0:Object.keys(Object(e)),g=-1;if(u)for(;++g<(p||e).length;){let r=p?p[g]:g,n=e[r];(null==i?void 0:i.includes(r.toString()))?u[r]=n:u[r]=t(n,i)}return u}});var r=i(84148),n=i(19159),s=i(7610),l=i(12709),a=i(6946),o=i(82904),h=i(43286)},16487:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=function(t,e,i){return t<e?e:t>i?i:t}},34638:function(t,e,i){"use strict";function r(t,e){let i;return t>e&&(i=t,t=e,e=i),i=>Math.max(t,Math.min(e,i))}i.d(e,{i:()=>r})},19159:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(84326);let n=t=>Array.isArray?Array.isArray(t):(0,r.Z)(t,"Array")},7610:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(84326);let n=(t,e=!1)=>e?"boolean"==typeof t:!0===t||!1===t||(0,r.Z)(t,"Boolean")},82904:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(84326);let n=t=>(0,r.Z)(t,"Date")},53908:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>null==t},12709:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(84326);let n=(t,e=!1)=>{let i=typeof t;return e?"number"===i:"number"===i||(0,r.Z)(t,"Number")}},6946:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(84326);let n=(t,e=!1)=>{let i=typeof t;return e?"string"===i:"string"===i||(0,r.Z)(t,"String")}},84326:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=(t,e)=>Object.prototype.toString.call(t)===`[object ${e}]`},84148:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>null!=t},94904:function(t,e,i){"use strict";function r(t,e,i=!0){if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames){let r=Object.getOwnPropertyNames(e);for(let n=0;n<r.length;n++){let s=r[n];"constructor"!==s&&(i?null!=e[s]:null==t[s])&&(t[s]=e[s])}}else{var n=t,s=e,l=i;let r=function(t){if(!t)return[];if(Object.keys)return Object.keys(t);let e=[];for(let i in t)t.hasOwnProperty(i)&&e.push(i);return e}(s);for(let t=0;t<r.length;t++){let e=r[t];(l?null!=s[e]:null==n[e])&&(n[e]=s[e])}}}i.d(e,{jB:()=>r})},6594:function(t,e,i){"use strict";function r(t){return Number(t)}i.d(e,{H:()=>r})},16369:function(t,e,i){"use strict";function r(t){return Math.PI/180*t}i.d(e,{M4:()=>r})},50071:function(t,e,i){"use strict";i.d(e,{CE:()=>l,Z$:()=>s,h6:()=>o,iH:()=>a});var r=i(43735),n=i(84091);function s(t){if((0,n.Z)(t))return t[t.length-1]}let l=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let n=1;n<t.length;n++){let s=t[n];(null!=(i=null==e?void 0:e(s,r))?i:s-r)>0&&(r=s)}return r},a=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let n=1;n<t.length;n++){let s=t[n];(null!=(i=null==e?void 0:e(s,r))?i:s-r)<0&&(r=s)}return r};function o(t,e){if(!(0,r.Z)(t)||!(0,r.Z)(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}},19465:function(t,e,i){"use strict";i.d(e,{Z:()=>function t(e,i,s){let u;if(!(0,h.Z)(e)||"object"!=typeof e||i&&i(e))return e;let d=(0,r.Z)(e),c=e.length;u=d?Array(c):"object"==typeof e?{}:(0,n.Z)(e)||(0,a.Z)(e)||(0,o.Z)(e)?e:l(e)?new Date(+e):void 0;let p=d?void 0:Object.keys(Object(e)),g=-1;if(u)for(;++g<(p||e).length;){let r=p?p[g]:g,n=e[r];s&&s.includes(r.toString())?u[r]=n:u[r]=t(n,i,s)}return u}});var r=i(43735),n=i(47105),s=i(4453);let l=t=>(0,s.Z)(t,"Date");var a=i(58977),o=i(58853),h=i(18585)},43735:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(4453);let n=t=>Array.isArray?Array.isArray(t):(0,r.Z)(t,"Array")},84091:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)}},47105:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(4453);let n=(t,e=!1)=>e?"boolean"==typeof t:!0===t||!1===t||(0,r.Z)(t,"Boolean")},43572:function(t,e,i){"use strict";i.d(e,{Z:()=>h});var r=i(29753),n=i(84091);let s=t=>({}).toString.call(t).replace(/^\[object /,"").replace(/]$/,""),l=Object.prototype,a=function(t){let e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||l)},o=Object.prototype.hasOwnProperty,h=function(t){if((0,r.Z)(t))return!0;if((0,n.Z)(t))return!t.length;let e=s(t);if("Map"===e||"Set"===e)return!t.size;if(a(t))return!Object.keys(t).length;for(let e in t)if(o.call(t,e))return!1;return!0}},8611:function(t,e,i){"use strict";i.d(e,{X:()=>function t(e,i,o){if(e===i)return!0;if(typeof e!=typeof i||null==e||null==i)return!1;if(Number.isNaN(e)&&Number.isNaN(i))return!0;if(l(e)!==l(i))return!1;if((0,n.Z)(e))return!!(null==o?void 0:o.skipFunction);if("object"!=typeof e)return!1;if((0,r.Z)(e)){if(e.length!==i.length)return!1;for(let r=e.length-1;r>=0;r--)if(!t(e[r],i[r],o))return!1;return!0}if(!(0,s.Z)(e))return!1;let h=a(e),u=a(i);if(h.length!==u.length)return!1;h.sort(),u.sort();for(let t=h.length-1;t>=0;t--)if(h[t]!=u[t])return!1;for(let r=h.length-1;r>=0;r--){let n=h[r];if(!t(e[n],i[n],o))return!1}return!0}});var r=i(43735),n=i(70506),s=i(8287);function l(t){return Object.prototype.toString.call(t)}function a(t){return Object.keys(t)}},70506:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>"function"==typeof t},29753:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>null==t},58977:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(4453);let n=(t,e=!1)=>{let i=typeof t;return e?"number"===i:"number"===i||(0,r.Z)(t,"Number")}},47e3:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>{let e=typeof t;return null!==t&&"object"===e||"function"===e}},8287:function(t,e,i){"use strict";i.d(e,{Z:()=>s});let r=t=>"object"==typeof t&&null!==t;var n=i(4453);let s=function(t){if(!r(t)||!(0,n.Z)(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}},58853:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(4453);let n=(t,e=!1)=>{let i=typeof t;return e?"string"===i:"string"===i||(0,r.Z)(t,"String")}},4453:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=(t,e)=>Object.prototype.toString.call(t)===`[object ${e}]`},18585:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>null!=t},33657:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(58977);let n=t=>(0,r.Z)(t)&&Number.isFinite(t)},91212:function(t,e,i){"use strict";i.d(e,{Z:()=>o});var r=i(43735),n=i(84091),s=i(8287),l=i(18585);function a(t,e,i){var r,n;(void 0===i||(r=t[e],r===(n=i)||Number.isNaN(r)&&Number.isNaN(n)))&&(void 0!==i||e in t)||(t[e]=i)}function o(t,...e){let i=-1,h=e.length;for(;++i<h;)!function t(e,i,o=!1,h=!1){if(i&&e!==i&&(0,l.Z)(i)&&"object"==typeof i){let u=Object(i),d=[];for(let t in u)d.push(t);let{length:c}=d,p=-1;for(;c--;){let c=d[++p];!(0,l.Z)(u[c])||"object"!=typeof u[c]||h&&(0,r.Z)(e[c])?a(e,c,u[c]):function(e,i,l,o=!1,h=!1){let u=e[l],d=i[l],c=i[l],p=!0;if((0,r.Z)(d)){if(o)c=[];else if((0,r.Z)(u))c=u;else if((0,n.Z)(u)){c=Array(u.length);let t=-1,e=u.length;for(;++t<e;)c[t]=u[t]}}else(0,s.Z)(d)?(c=null!=u?u:{},"function"!=typeof u&&"object"==typeof u||(c={})):p=!1;p&&t(c,d,o,h),a(e,l,c)}(e,i,c,o,h)}}}(t,e[i],!0);return t}},22295:function(t,e,i){"use strict";i.d(e,{FB:()=>a,YZ:()=>l});var r,n,s=i(43735);i(16369),(r=n||(n={}))[r.NONE=0]="NONE",r[r.BBOX1=1]="BBOX1",r[r.BBOX2=2]="BBOX2";class l{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new l(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return(0,s.Z)(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){let r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){let n=this.scalePoints(t,e,i,r);return this.clear().add(n[0],n[1]).add(n[2],n[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return function(t,e,i){let{x1:r,y1:n,x2:s,y2:l}=e;i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f)):(t.clear(),t.add(i.a*r+i.c*n+i.e,i.b*r+i.d*n+i.f),t.add(i.a*s+i.c*n+i.e,i.b*s+i.d*n+i.f),t.add(i.a*s+i.c*l+i.e,i.b*s+i.d*l+i.f),t.add(i.a*r+i.c*l+i.e,i.b*r+i.d*l+i.f))}(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){let{x1:r,y1:n,x2:s,y2:l}=this,a=Math.cos(t),o=Math.sin(t),h=e-e*a+i*o,u=i-e*o-i*a;return[a*r-o*n+h,o*r+a*n+u,a*r-o*l+h,o*r+a*l+u,a*s-o*n+h,o*s+a*n+u,a*s-o*l+h,o*s+a*l+u]}scalePoints(t,e,i,r){let{x1:n,y1:s,x2:l,y2:a}=this;return[t*n+(1-t)*i,e*s+(1-e)*r,t*l+(1-t)*i,e*a+(1-e)*r]}}class a extends l{}},98706:function(t,e,i){"use strict";i.d(e,{Dt:()=>s,LW:()=>h,M4:()=>n,Oy:()=>o,gt:()=>l,op:()=>a,tc:()=>u});var r=i(88504);function n(t){return Math.PI/180*t}function s(t){return 180*t/Math.PI}let l=(t=0)=>{if(t<0)for(;t<-r.BZ;)t+=r.BZ;else if(t>0)for(;t>r.BZ;)t-=r.BZ;return t};function a(t,e,i){return e?{x:t.x+e*Math.cos(i),y:t.y+e*Math.sin(i)}:{x:t.x,y:t.y}}function o(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function h(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function u(t){return(t=h(t))>0&&t<=Math.PI/2?2:t>Math.PI/2&&t<=Math.PI?3:t>Math.PI&&t<=3*Math.PI/2?4:1}},14925:function(t,e,i){"use strict";i.d(e,{eX:()=>b,Il:()=>v});var r=i(45273),n=i(31535),s=i(21777),l=i(35652),a=i(21648);function o(t,e,i){let r=(1-Math.abs(2*(i/=100)-1))*(e/=100),n=r*(1-Math.abs(t/60%2-1)),s=i-r/2,l=0,a=0,o=0;return 0<=t&&t<60?(l=r,a=n,o=0):60<=t&&t<120?(l=n,a=r,o=0):120<=t&&t<180?(l=0,a=r,o=n):180<=t&&t<240?(l=0,a=n,o=r):240<=t&&t<300?(l=n,a=0,o=r):300<=t&&t<360&&(l=r,a=0,o=n),{r:l=Math.round(255*(l+s)),g:a=Math.round(255*(a+s)),b:o=Math.round(255*(o+s))}}function h(t,e,i){t/=255;let r=Math.min(t,e/=255,i/=255),n=Math.max(t,e,i),s=n-r,l=0,a=0,o=0;return(l=Math.round(60*(l=0===s?0:n===t?(e-i)/s%6:n===e?(i-t)/s+2:(t-e)/s+4)))<0&&(l+=360),o=(n+r)/2,{h:l,s:a=+(100*(a=0===s?0:s/(1-Math.abs(2*o-1)))).toFixed(1),l:o=+(100*o).toFixed(1)}}let u=/^#([0-9a-f]{3,8})$/,d={transparent:0xffffff00},c={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function p(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function g(t){return(0,r.Z)(t)?new b(t>>16,t>>8&255,255&t,1):(0,n.Z)(t)?new b(t[0],t[1],t[2]):new b(255,255,255)}function f(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function m(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let y=(t,e)=>{let i=u.exec(t);if(e||i){let t=parseInt(i[1],16),e=i[1].length;return 3===e?new b((t>>8&15)+((t>>8&15)<<4),(t>>4&15)+((t>>4&15)<<4),(15&t)+((15&t)<<4),1):6===e?g(t):8===e?new b(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):null}};class v{static Brighter(t,e=1){return 1===e?t:new v(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return 1===e?t:new v(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){let i=t instanceof v?t:new v(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3();case"wcag":return i.getLuminanceWCAG()}}static parseColorString(t){if((0,s.Z)(d[t])){var e;return e=d[t],(0,r.Z)(e)?new b(e>>>24,e>>>16&255,e>>>8&255,255&e):(0,n.Z)(e)?new b(e[0],e[1],e[2],e[3]):new b(255,255,255,1)}if((0,s.Z)(c[t]))return g(c[t]);let i=`${t}`.trim().toLowerCase(),l=y(i);if(void 0!==l)return l;if(/^(rgb|RGB|rgba|RGBA)/.test(i)){let t=i.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new b(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),parseFloat(t[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(i)){let t=i.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),e=o(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));return new b(e.r,e.g,e.b,parseFloat(t[3]))}}constructor(t){let e=v.parseColorString(t);e?this.color=e:(console.warn(`Warn: 传入${t}无法解析为Color`),this.color=new b(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){let{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){let r=this.color.opacity,n=h(this.color.r,this.color.g,this.color.b),s=o((0,l.Z)(t)?n.h:(0,a.Z)(t,0,360),(0,l.Z)(e)?n.s:e>=0&&e<=1?100*e:e,(0,l.Z)(i)?n.l:i<=1&&i>=0?100*i:i);return this.color=new b(s.r,s.g,s.b,r),this}setRGB(t,e,i){return(0,l.Z)(t)||(this.color.r=t),(0,l.Z)(e)||(this.color.g=e),(0,l.Z)(i)||(this.color.b=i),this}setHex(t){let e=y(`${t}`.trim().toLowerCase(),!0);return null!=e?e:this}setColorName(t){let e=c[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}getLuminanceWCAG(){let t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;return .2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))}clone(){return new v(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){let i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=f(t.color.r),this.color.g=f(t.color.g),this.color.b=f(t.color.b),this}copyLinearToSRGB(t){return this.color.r=m(t.color.r),this.color.g=m(t.color.g),this.color.b=m(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class b{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),(0,s.Z)(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${p(this.r)+p(this.g)+p(this.b)+(1===this.opacity?"":p(255*this.opacity))}`}formatRgb(){let t=this.opacity;return`${1===t?"rgb(":"rgba("}${this.r},${this.g},${this.b}${1===t?")":`,${t})`}`}formatHsl(){let t=this.opacity,{h:e,s:i,l:r}=h(this.r,this.g,this.b);return`${1===t?"hsl(":"hsla("}${e},${i}%,${r}%${1===t?")":`,${t})`}`}toString(){return this.formatHex()}}},88663:function(t,e,i){"use strict";i.d(e,{CE:()=>o,IX:()=>l,VF:()=>function t(e){if(!(0,r.Z)(e))return[e];let i=[];for(let r of e)i.push(...t(r));return i},Z$:()=>a,h6:()=>u,iH:()=>h});var r=i(31535),n=i(40851),s=i(21777);function l(t){return(0,s.Z)(t)?(0,r.Z)(t)?t:[t]:[]}function a(t){if((0,n.Z)(t))return t[t.length-1]}let o=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let n=1;n<t.length;n++){let s=t[n];(null!=(i=null==e?void 0:e(s,r))?i:s-r)>0&&(r=s)}return r},h=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let n=1;n<t.length;n++){let s=t[n];(null!=(i=null==e?void 0:e(s,r))?i:s-r)<0&&(r=s)}return r};function u(t,e){if(!(0,r.Z)(t)||!(0,r.Z)(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}},45103:function(t,e,i){"use strict";i.d(e,{o0:()=>s,b4:()=>n});var r=i(35652);function n(t,e,i=0,s){for((0,r.Z)(s)&&(s=t.length);i<s;){var l;let r=i+s>>>1;((l=t[r])<e?-1:l>e?1:l>=e?0:NaN)>0?s=r:i=r+1}return i}let s=(t,e,i)=>{let r=t,n=e;for(;r<n;){let t=Math.floor((r+n)/2);i(t)>=0?n=t:r=t+1}return r}},21648:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=function(t,e,i){return t<e?e:t>i?i:t}},12319:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=(t,e,i)=>{let[r,n]=t;n<r&&(r=t[1],n=t[0]);let s=n-r;return s>=i-e?[e,i]:[r=Math.min(Math.max(r,e),i-s),r+s]}},92493:function(t,e,i){"use strict";i.d(e,{Z:()=>function t(e,i,s){let u;if(!(0,h.Z)(e)||"object"!=typeof e||i&&i(e))return e;let d=(0,r.Z)(e),c=e.length;u=d?Array(c):"object"==typeof e?{}:(0,n.Z)(e)||(0,a.Z)(e)||(0,o.Z)(e)?e:l(e)?new Date(+e):void 0;let p=d?void 0:Object.keys(Object(e)),g=-1;if(u)for(;++g<(p||e).length;){let r=p?p[g]:g,n=e[r];s&&s.includes(r.toString())?u[r]=n:u[r]=t(n,i,s)}return u}});var r=i(31535),n=i(61868),s=i(93918);let l=t=>(0,s.Z)(t,"Date");var a=i(45273),o=i(30756),h=i(21777)},10391:function(t,e,i){"use strict";i.d(e,{Z:()=>l});var r=i(43562),n=i(70501);let s=!1;try{s="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame}catch(t){s=!1}s=!1;let l=function(t,e,i){let l,a,o,h,u,d,c=0,p=!1,g=!1,f=!0,m=!e&&0!==e&&s;if("function"!=typeof t)throw TypeError("Expected a function");function y(e){let i=l,r=a;return l=a=void 0,c=e,h=t.apply(r,i)}function v(t,e){return m?(cancelAnimationFrame(u),requestAnimationFrame(t)):setTimeout(t,e)}function b(t){let i=t-d;return void 0===d||i>=e||i<0||g&&t-c>=o}function _(){let t=Date.now();if(b(t))return x(t);u=v(_,function(t){let i=t-c,r=e-(t-d);return g?Math.min(r,o-i):r}(t))}function x(t){return u=void 0,f&&l?y(t):(l=a=void 0,h)}function C(...t){let i=Date.now(),r=b(i);if(l=t,a=this,d=i,r){if(void 0===u){var n;return c=n=d,u=v(_,e),p?y(n):h}if(g)return u=v(_,e),y(d)}return void 0===u&&(u=v(_,e)),h}return e=+e||0,(0,r.Z)(i)&&(p=!!i.leading,(g="maxWait"in i)&&(o=Math.max((0,n.Z)(i.maxWait)?i.maxWait:0,e)),f="trailing"in i?!!i.trailing:f),C.cancel=function(){void 0!==u&&function(t){if(m)return cancelAnimationFrame(t);clearTimeout(t)}(u),c=0,l=d=a=u=void 0},C.flush=function(){return void 0===u?h:x(Date.now())},C.pending=function(){return void 0!==u},C}},59225:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(30756);let n=(t,e,i)=>{let n=(0,r.Z)(e)?e.split("."):e;for(let e=0;e<n.length;e++)t=t?t[n[e]]:void 0;return void 0===t?i:t}},31535:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(93918);let n=t=>Array.isArray?Array.isArray(t):(0,r.Z)(t,"Array")},40851:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)}},61868:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(93918);let n=(t,e=!1)=>e?"boolean"==typeof t:!0===t||!1===t||(0,r.Z)(t,"Boolean")},47704:function(t,e,i){"use strict";i.d(e,{Z:()=>h});var r=i(35652),n=i(40851);let s=t=>({}).toString.call(t).replace(/^\[object /,"").replace(/]$/,""),l=Object.prototype,a=function(t){let e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||l)},o=Object.prototype.hasOwnProperty,h=function(t){if((0,r.Z)(t))return!0;if((0,n.Z)(t))return!t.length;let e=s(t);if("Map"===e||"Set"===e)return!t.size;if(a(t))return!Object.keys(t).length;for(let e in t)if(o.call(t,e))return!1;return!0}},98116:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>"function"==typeof t},35652:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>null==t},45273:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(93918);let n=(t,e=!1)=>{let i=typeof t;return e?"number"===i:"number"===i||(0,r.Z)(t,"Number")}},43562:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>{let e=typeof t;return null!==t&&"object"===e||"function"===e}},80875:function(t,e,i){"use strict";i.d(e,{Z:()=>s});let r=t=>"object"==typeof t&&null!==t;var n=i(93918);let s=function(t){if(!r(t)||!(0,n.Z)(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}},30756:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(93918);let n=(t,e=!1)=>{let i=typeof t;return e?"string"===i:"string"===i||(0,r.Z)(t,"String")}},93918:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=(t,e)=>Object.prototype.toString.call(t)===`[object ${e}]`},21777:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>null!=t},70501:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(45273);let n=t=>(0,r.Z)(t)&&Number.isFinite(t)},95950:function(t,e,i){"use strict";i.d(e,{Z:()=>o});var r=i(31535),n=i(40851),s=i(80875),l=i(21777);function a(t,e,i){var r,n;(void 0===i||(r=t[e],r===(n=i)||Number.isNaN(r)&&Number.isNaN(n)))&&(void 0!==i||e in t)||(t[e]=i)}function o(t,...e){let i=-1,h=e.length;for(;++i<h;)!function t(e,i,o=!1,h=!1){if(i&&e!==i&&(0,l.Z)(i)&&"object"==typeof i){let u=Object(i),d=[];for(let t in u)d.push(t);let{length:c}=d,p=-1;for(;c--;){let c=d[++p];!(0,l.Z)(u[c])||"object"!=typeof u[c]||h&&(0,r.Z)(e[c])?a(e,c,u[c]):function(e,i,l,o=!1,h=!1){let u=e[l],d=i[l],c=i[l],p=!0;if((0,r.Z)(d)){if(o)c=[];else if((0,r.Z)(u))c=u;else if((0,n.Z)(u)){c=Array(u.length);let t=-1,e=u.length;for(;++t<e;)c[t]=u[t]}}else(0,s.Z)(d)?(c=null!=u?u:{},"function"!=typeof u&&"object"==typeof u||(c={})):p=!1;p&&t(c,d,o,h),a(e,l,c)}(e,i,c,o,h)}}}(t,e[i],!0);return t}},87986:function(t,e,i){"use strict";function r(t,e,i=!0){if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames){let r=Object.getOwnPropertyNames(e);for(let n=0;n<r.length;n++){let s=r[n];"constructor"!==s&&(i?null!=e[s]:null==t[s])&&(t[s]=e[s])}}else{var n=t,s=e,l=i;let r=function(t){if(!t)return[];if(Object.keys)return Object.keys(t);let e=[];for(let i in t)t.hasOwnProperty(i)&&e.push(i);return e}(s);for(let t=0;t<r.length;t++){let e=r[t];(l?null!=s[e]:null==n[e])&&(n[e]=s[e])}}}i.d(e,{jB:()=>r})},25258:function(t,e,i){"use strict";function r(t,e,i=1e-10,n=1e-10){let s=i*Math.max(t,e);return Math.abs(t-e)<=Math.max(n,s)}function n(t,e,i,n){return t>e&&!r(t,e,i,n)}function s(t,e,i,n){return t<e&&!r(t,e,i,n)}i.d(e,{SQ:()=>s,Vy:()=>n,Yt:()=>r})},70527:function(t,e,i){"use strict";i.d(e,{Z:()=>s});var r=i(10391),n=i(43562);let s=function(t,e,i){let s=!0,l=!0;if("function"!=typeof t)throw TypeError("Expected a function");return(0,n.Z)(i)&&(s="leading"in i?!!i.leading:s,l="trailing"in i?!!i.trailing:l),(0,r.Z)(t,e,{leading:s,trailing:l,maxWait:e})}},76620:function(t,e,i){"use strict";i.d(e,{FB:()=>a,YZ:()=>l,a5:()=>o,n2:()=>s});var r=i(31535),n=i(33049);function s(t,e,i){let{x1:r,y1:n,x2:s,y2:l}=e;return i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f)):(t.clear(),t.add(i.a*r+i.c*n+i.e,i.b*r+i.d*n+i.f),t.add(i.a*s+i.c*n+i.e,i.b*s+i.d*n+i.f),t.add(i.a*s+i.c*l+i.e,i.b*s+i.d*l+i.f),t.add(i.a*r+i.c*l+i.e,i.b*r+i.d*l+i.f)),e}class l{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new l(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return(0,r.Z)(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){let r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){let n=this.scalePoints(t,e,i,r);return this.clear().add(n[0],n[1]).add(n[2],n[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return s(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){let{x1:r,y1:n,x2:s,y2:l}=this,a=Math.cos(t),o=Math.sin(t),h=e-e*a+i*o,u=i-e*o-i*a;return[a*r-o*n+h,o*r+a*n+u,a*r-o*l+h,o*r+a*l+u,a*s-o*n+h,o*s+a*n+u,a*s-o*l+h,o*s+a*l+u]}scalePoints(t,e,i,r){let{x1:n,y1:s,x2:l,y2:a}=this;return[t*n+(1-t)*i,e*s+(1-e)*r,t*l+(1-t)*i,e*a+(1-e)*r]}}class a extends l{}class o extends l{constructor(t,e=0){var i;super(t),t&&(this.angle=null!=(i=t.angle)?i:e)}intersects(t){return(0,n.nn)(this,t)}setValue(t=0,e=0,i=0,r=0,n=0){return super.setValue(t,e,i,r),this.angle=n,this}clone(){return new o(this)}getRotatedCorners(){let t={x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2};return[(0,n.xj)({x:this.x1,y:this.y1},this.angle,t),(0,n.xj)({x:this.x2,y:this.y1},this.angle,t),(0,n.xj)({x:this.x1,y:this.y2},this.angle,t),(0,n.xj)({x:this.x2,y:this.y2},this.angle,t)]}}},8992:function(t,e,i){"use strict";i.d(e,{X:()=>l,y:()=>s});var r=i(98706),n=i(88504);class s{constructor(t=1,e=0,i=0,r=1,n=0,s=0){this.a=t,this.b=e,this.c=i,this.d=r,this.e=n,this.f=s}equalToMatrix(t){return this.e===t.e&&this.f===t.f&&this.a===t.a&&this.d===t.d&&this.b===t.b&&this.c===t.c}equalTo(t,e,i,r,n,s){return this.e===n&&this.f===s&&this.a===t&&this.d===r&&this.b===e&&this.c===i}setValue(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.e=n,this.f=s,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){let t=this.a,e=this.b,i=this.c,r=this.d,n=this.e,l=this.f,a=new s,o=t*r-e*i;return a.a=r/o,a.b=-e/o,a.c=-i/o,a.d=t/o,a.e=(i*l-r*n)/o,a.f=-(t*l-e*n)/o,a}rotate(t){let e=Math.cos(t),i=Math.sin(t),r=this.a*e+this.c*i,n=this.b*e+this.d*i,s=-(this.a*i)+this.c*e,l=-(this.b*i)+this.d*e;return this.a=r,this.b=n,this.c=s,this.d=l,this}rotateByCenter(t,e,i){let r=Math.cos(t),n=Math.sin(t),s=r*this.a-n*this.b,l=n*this.a+r*this.b,a=r*this.c-n*this.d,o=n*this.c+r*this.d,h=r*this.e-n*this.f+((1-r)*e+n*i),u=n*this.e+r*this.f+((1-r)*i-n*e);return this.a=s,this.b=l,this.c=a,this.d=o,this.e=h,this.f=u,this}scale(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}setScale(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}transform(t,e,i,r,n,s){return this.multiply(t,e,i,r,n,s),this}translate(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}transpose(){let{a:t,b:e,c:i,d:r,e:n,f:s}=this;return this.a=e,this.b=t,this.c=r,this.d=i,this.e=s,this.f=n,this}multiply(t,e,i,r,n,s){let l=this.a,a=this.b,o=this.c,h=this.d,u=l*n+o*s+this.e,d=a*n+h*s+this.f;return this.a=l*t+o*e,this.b=a*t+h*e,this.c=l*i+o*r,this.d=a*i+h*r,this.e=u,this.f=d,this}interpolate(t,e){let i=new s;return i.a=this.a+(t.a-this.a)*e,i.b=this.b+(t.b-this.b)*e,i.c=this.c+(t.c-this.c)*e,i.d=this.d+(t.d-this.d)*e,i.e=this.e+(t.e-this.e)*e,i.f=this.f+(t.f-this.f)*e,i}transformPoint(t,e){let{a:i,b:r,c:n,d:s,e:l,f:a}=this,o=i*s-r*n,{x:h,y:u}=t;e.x=s/o*h+-n/o*u+(n*a-s*l)/o,e.y=-r/o*h+i/o*u+-(i*a-r*l)/o}onlyTranslate(t=1){return this.a===t&&0===this.b&&0===this.c&&this.d===t}clone(){return new s(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){let t=this.a,e=this.b,i=this.c,n=this.d,s=t*n-e*i,l={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){let r=Math.sqrt(t*t+e*e);l.rotateDeg=e>0?Math.acos(t/r):-Math.acos(t/r),l.scaleX=r,l.scaleY=s/r,l.skewX=(t*i+e*n)/s,l.skewY=0}else if(0!==i||0!==n){let r=Math.sqrt(i*i+n*n);l.rotateDeg=Math.PI/2-(n>0?Math.acos(-i/r):-Math.acos(i/r)),l.scaleX=s/r,l.scaleY=r,l.skewX=0,l.skewY=(t*i+e*n)/s}return l.rotateDeg=(0,r.Dt)(l.rotateDeg),l}}function l(t,e,i,r,s,l,a,o){let h,u,d=e.a,c=e.b,p=e.c,g=e.d,f=e.e,m=e.f,y=(0,n.mC)(a),v=(0,n.O$)(a);o?(h=o[0],u=o[1]):(h=i,u=r);let b=h-i,_=u-r,x=d*y+p*v,C=c*y+g*v,w=p*y-d*v,S=g*y-c*v;t.a=s*x,t.b=s*C,t.c=l*w,t.d=l*S,t.e=f+d*h+p*u-x*b-w*_,t.f=m+c*h+g*u-C*b-S*_}},41457:function(t,e,i){"use strict";i.d(e,{E9:()=>s,HL:()=>l});var r=i(45273),n=i(88504);class s{constructor(t=0,e=0,i,r){this.x=0,this.y=0,this.x=t,this.y=e,this.x1=i,this.y1=r}clone(){return new s(this.x,this.y)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}set(t,e){return this.x=t,this.y=e,this}add(t){return(0,r.Z)(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}sub(t){return(0,r.Z)(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}multi(t){throw Error("暂不支持")}div(t){throw Error("暂不支持")}}class l{static distancePP(t,e){return(0,n._b)((0,n.sQ)(t.x-e.x,2)+(0,n.sQ)(t.y-e.y,2))}static distanceNN(t,e,i,r){return(0,n._b)((0,n.sQ)(t-i,2)+(0,n.sQ)(e-r,2))}static distancePN(t,e,i){return(0,n._b)((0,n.sQ)(e-t.x,2)+(0,n.sQ)(i-t.y,2))}static pointAtPP(t,e,i){return new s((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}},97424:function(t,e,i){"use strict";i.d(e,{Z2:()=>n,wv:()=>r});let r=(t="")=>{let e={};return t.split(";").forEach(t=>{if(t){let i=t.split(":");if(2===i.length){let t=i[0].trim(),r=i[1].trim();t&&r&&(e[t]=r)}}}),e},n=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase()},33049:function(t,e,i){"use strict";i.d(e,{Jz:()=>o,RA:()=>d,SX:()=>c,di:()=>h,nn:()=>v,qr:()=>p,xj:()=>f});var r,n,s=i(98706),l=i(88504);function a(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1]}function o(t,e,i,r){let n,s,o,h;if(n=t[0],s=e[0],o=i[0],h=r[0],s<n&&([n,s]=[s,n]),h<o&&([h,o]=[o,h]),s<o||h<n||(n=t[1],s=e[1],o=i[1],h=r[1],s<n&&([n,s]=[s,n]),h<o&&([h,o]=[o,h]),s<o||h<n))return!1;let u=[0,0],d=[0,0],c=[0,0];if(a(u,e,t),a(d,r,i),(0,l.Bw)(u,d))return!0;a(c,i,t);let p=(0,l.ir)(c,d)/(0,l.ir)(u,d);return p>=0&&p<=1&&[t[0]+u[0]*p,t[1]+u[1]*p]}function h(t,e,i){if(null===t)return e;if(null===e)return t;let{x11:r,x12:n,y11:s,y12:l,x21:a,x22:o,y21:h,y22:d}=u(t,e,i);return r>=o||n<=a||s>=d||l<=h?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(r,a),y1:Math.max(s,h),x2:Math.min(n,o),y2:Math.min(l,d)}}(r=n||(n={}))[r.NONE=0]="NONE",r[r.BBOX1=1]="BBOX1",r[r.BBOX2=2]="BBOX2";let u=(t,e,i)=>{let r=t.x1,n=t.x2,s=t.y1,l=t.y2,a=e.x1,o=e.x2,h=e.y1,u=e.y2;return i&&(r>n&&([r,n]=[n,r]),s>l&&([s,l]=[l,s]),a>o&&([a,o]=[o,a]),h>u&&([h,u]=[u,h])),{x11:r,x12:n,y11:s,y12:l,x21:a,x22:o,y21:h,y22:u}};function d(t,e,i){if(!t||!e)return n.NONE;let{x11:r,x12:s,y11:l,y12:a,x21:o,x22:h,y21:d,y22:c}=u(t,e,i);return r>o&&s<h&&l>d&&a<c?n.BBOX1:o>r&&h<s&&d>l&&c<a?n.BBOX2:n.NONE}function c(t,e,i){if(t&&e){if(!i)return!(t.x1>e.x2||t.x2<e.x1||t.y1>e.y2||t.y2<e.y1);let{x11:r,x12:n,y11:s,y12:l,x21:a,x22:o,y21:h,y22:d}=u(t,e,!0);return!(r>o||n<a||s>d||l<h)}return!0}function p(t,e,i){if(!e)return!0;if(!i)return t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2;let r=e.x1,n=e.x2,s=e.y1,l=e.y2;return r>n&&([r,n]=[n,r]),s>l&&([s,l]=[l,s]),t.x>=r&&t.x<=n&&t.y>=s&&t.y<=l}function g(t,e){return Math.abs(e[0]*t[0]+e[1]*t[1])}function f({x:t,y:e},i,r={x:0,y:0}){return{x:(t-r.x)*Math.cos(i)-(e-r.y)*Math.sin(i)+r.x,y:(t-r.x)*Math.sin(i)+(e-r.y)*Math.cos(i)+r.y}}function m(t){return{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2}}function y(t,e){let i=e?(0,s.M4)(t.angle):t.angle,r=m(t);return[f({x:t.x1,y:t.y1},i,r),f({x:t.x2,y:t.y1},i,r),f({x:t.x2,y:t.y2},i,r),f({x:t.x1,y:t.y2},i,r)]}function v(t,e,i=!1){let r=y(t,i),n=y(e,i),a=(t,e)=>[e.x-t.x,e.y-t.y],o=a(m(t),m(e)),h=a(r[0],r[1]),u=a(r[1],r[2]),d=a(n[0],n[1]),c=a(n[1],n[2]),p=i?(0,s.M4)(t.angle):t.angle,f=i?(0,s.M4)(90-t.angle):t.angle+l.ou,b=i?(0,s.M4)(e.angle):e.angle,_=i?(0,s.M4)(90-e.angle):e.angle+l.ou;f>l.f7&&(f-=l.f7),_>l.f7&&(_-=l.f7);let x=(t,e,i,r)=>{let n=[Math.cos(e),Math.sin(e)];return t+(g(n,i)+g(n,r))/2>g(n,o)};return x((t.x2-t.x1)/2,p,d,c)&&x((t.y2-t.y1)/2,f,d,c)&&x((e.x2-e.x1)/2,b,h,u)&&x((e.y2-e.y1)/2,_,h,u)}},70016:function(t,e,i){"use strict";i.d(e,{YB:()=>n,up:()=>s,v1:()=>r});let r=(t,e)=>{let{x1:i,x2:r,y1:n,y2:s}=t,l=Math.abs(r-i),a=Math.abs(s-n),o=(i+r)/2,h=(n+s)/2,u=0,d=0;switch(e){case"top":case"inside-top":d=-.5;break;case"bottom":case"inside-bottom":d=.5;break;case"left":case"inside-left":u=-.5;break;case"right":case"inside-right":u=.5;break;case"top-right":u=.5,d=-.5;break;case"top-left":u=-.5,d=-.5;break;case"bottom-right":u=.5,d=.5;break;case"bottom-left":u=-.5,d=.5}return{x:o+=u*l,y:h+=d*a}},n=(t,e)=>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),s=(t,e)=>{let i=[{x:Math.cos(t.angle),y:Math.sin(t.angle)},{x:-Math.sin(t.angle),y:Math.cos(t.angle)},{x:Math.cos(e.angle),y:Math.sin(t.angle)},{x:-Math.sin(e.angle),y:Math.cos(t.angle)}];function r(t,e,i){let r=t.getRotatedCorners().map(t=>t.x*e+t.y*i);return{min:Math.min(...r),max:Math.max(...r)}}let n=0;for(let s of i){let i=r(t,s.x,s.y),l=r(e,s.x,s.y);n=Math.max(n,i.max<l.min?l.min-i.max:l.max<i.min?i.min-l.max:0)}return n}},6201:function(t,e,i){"use strict";function r(t,e,i){let r=0,l=t[0];if(!l)return!1;for(let s=1;s<t.length;s++){let a=t[s];r+=n(l.x,l.y,a.x,a.y,e,i),l=a}let a=t[0];return s(l.x,a.x)&&s(l.y,a.y)||(r+=n(l.x,l.y,a.x,a.y,e,i)),0!==r}function n(t,e,i,r,n,s){if(s>e&&s>r||s<e&&s<r||r===e)return 0;let l=(s-e)/(r-e),a=r<e?1:-1;1!==l&&0!==l||(a=r<e?.5:-.5);let o=l*(i-t)+t;return o===n?1/0:o>n?a:0}function s(t,e){return 1e-8>Math.abs(t-e)}i.d(e,{N0:()=>n,O0:()=>r})},21728:function(t,e,i){"use strict";i.d(e,{e:()=>h});var r=i(21777),n=i(35652),s=i(30756),l=i(31535);let a=t=>{let e=t.charCodeAt(0),i=2===t.length?t.charCodeAt(1):0,r=e;return 55296<=e&&e<=56319&&56320<=i&&i<=57343&&(e&=1023,i&=1023,r=(e<<10|i)+65536),12288===r||65281<=r&&r<=65376||65504<=r&&r<=65510?"F":8361===r||65377<=r&&r<=65470||65474<=r&&r<=65479||65482<=r&&r<=65487||65490<=r&&r<=65495||65498<=r&&r<=65500||65512<=r&&r<=65518?"H":4352<=r&&r<=4447||4515<=r&&r<=4519||4602<=r&&r<=4607||9001<=r&&r<=9002||11904<=r&&r<=11929||11931<=r&&r<=12019||12032<=r&&r<=12245||12272<=r&&r<=12283||12289<=r&&r<=12350||12353<=r&&r<=12438||12441<=r&&r<=12543||12549<=r&&r<=12589||12593<=r&&r<=12686||12688<=r&&r<=12730||12736<=r&&r<=12771||12784<=r&&r<=12830||12832<=r&&r<=12871||12880<=r&&r<=13054||13056<=r&&r<=19903||19968<=r&&r<=42124||42128<=r&&r<=42182||43360<=r&&r<=43388||44032<=r&&r<=55203||55216<=r&&r<=55238||55243<=r&&r<=55291||63744<=r&&r<=64255||65040<=r&&r<=65049||65072<=r&&r<=65106||65108<=r&&r<=65126||65128<=r&&r<=65131||110592<=r&&r<=110593||127488<=r&&r<=127490||127504<=r&&r<=127546||127552<=r&&r<=127560||127568<=r&&r<=127569||131072<=r&&r<=194367||177984<=r&&r<=196605||196608<=r&&r<=262141?"W":32<=r&&r<=126||162<=r&&r<=163||165<=r&&r<=166||172===r||175===r||10214<=r&&r<=10221||10629<=r&&r<=10630?"Na":161===r||164===r||167<=r&&r<=168||170===r||173<=r&&r<=174||176<=r&&r<=180||182<=r&&r<=186||188<=r&&r<=191||198===r||208===r||215<=r&&r<=216||222<=r&&r<=225||230===r||232<=r&&r<=234||236<=r&&r<=237||240===r||242<=r&&r<=243||247<=r&&r<=250||252===r||254===r||257===r||273===r||275===r||283===r||294<=r&&r<=295||299===r||305<=r&&r<=307||312===r||319<=r&&r<=322||324===r||328<=r&&r<=331||333===r||338<=r&&r<=339||358<=r&&r<=359||363===r||462===r||464===r||466===r||468===r||470===r||472===r||474===r||476===r||593===r||609===r||708===r||711===r||713<=r&&r<=715||717===r||720===r||728<=r&&r<=731||733===r||735===r||768<=r&&r<=879||913<=r&&r<=929||931<=r&&r<=937||945<=r&&r<=961||963<=r&&r<=969||1025===r||1040<=r&&r<=1103||1105===r||8208===r||8211<=r&&r<=8214||8216<=r&&r<=8217||8220<=r&&r<=8221||8224<=r&&r<=8226||8228<=r&&r<=8231||8240===r||8242<=r&&r<=8243||8245===r||8251===r||8254===r||8308===r||8319===r||8321<=r&&r<=8324||8364===r||8451===r||8453===r||8457===r||8467===r||8470===r||8481<=r&&r<=8482||8486===r||8491===r||8531<=r&&r<=8532||8539<=r&&r<=8542||8544<=r&&r<=8555||8560<=r&&r<=8569||8585===r||8592<=r&&r<=8601||8632<=r&&r<=8633||8658===r||8660===r||8679===r||8704===r||8706<=r&&r<=8707||8711<=r&&r<=8712||8715===r||8719===r||8721===r||8725===r||8730===r||8733<=r&&r<=8736||8739===r||8741===r||8743<=r&&r<=8748||8750===r||8756<=r&&r<=8759||8764<=r&&r<=8765||8776===r||8780===r||8786===r||8800<=r&&r<=8801||8804<=r&&r<=8807||8810<=r&&r<=8811||8814<=r&&r<=8815||8834<=r&&r<=8835||8838<=r&&r<=8839||8853===r||8857===r||8869===r||8895===r||8978===r||9312<=r&&r<=9449||9451<=r&&r<=9547||9552<=r&&r<=9587||9600<=r&&r<=9615||9618<=r&&r<=9621||9632<=r&&r<=9633||9635<=r&&r<=9641||9650<=r&&r<=9651||9654<=r&&r<=9655||9660<=r&&r<=9661||9664<=r&&r<=9665||9670<=r&&r<=9672||9675===r||9678<=r&&r<=9681||9698<=r&&r<=9701||9711===r||9733<=r&&r<=9734||9737===r||9742<=r&&r<=9743||9748<=r&&r<=9749||9756===r||9758===r||9792===r||9794===r||9824<=r&&r<=9825||9827<=r&&r<=9829||9831<=r&&r<=9834||9836<=r&&r<=9837||9839===r||9886<=r&&r<=9887||9918<=r&&r<=9919||9924<=r&&r<=9933||9935<=r&&r<=9953||9955===r||9960<=r&&r<=9983||10045===r||10071===r||10102<=r&&r<=10111||11093<=r&&r<=11097||12872<=r&&r<=12879||57344<=r&&r<=63743||65024<=r&&r<=65039||65533===r||127232<=r&&r<=127242||127248<=r&&r<=127277||127280<=r&&r<=127337||127344<=r&&r<=127386||917760<=r&&r<=917999||983040<=r&&r<=1048573||1048576<=r&&r<=1114109?"A":"N"};var o=i(28504);class h{constructor(t,e){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet="-/: .,@%'\"~",this._option=t,this._userSpec=null!=e?e:{},this.textSpec=this._initSpec(),(0,r.Z)(t.specialCharSet)&&(this.specialCharSet=t.specialCharSet),this._standardMethod=(0,r.Z)(t.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if((0,n.Z)(this._canvas)&&((0,r.Z)(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),(0,n.Z)(this._canvas)&&"undefined"!=typeof window&&void 0!==window.document&&globalThis&&(0,r.Z)(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),(0,n.Z)(this._context)&&(0,r.Z)(this._canvas)){let t=this._canvas.getContext("2d");(0,r.Z)(t)&&(t.save(),t.font=(0,o.U)(this.textSpec),this._contextSaved=!0,this._context=t)}return!(0,n.Z)(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var t,e,i;let{defaultFontParams:r={}}=this._option,{fontStyle:n=r.fontStyle,fontVariant:l=r.fontVariant,fontWeight:a=null!=(t=r.fontWeight)?t:"normal",fontSize:o=null!=(e=r.fontSize)?e:12,fontFamily:h=null!=(i=r.fontFamily)?i:"sans-serif",align:u,textAlign:d=null!=u?u:"center",baseline:c,textBaseline:p=null!=c?c:"middle",ellipsis:g,limit:f}=this._userSpec,{lineHeight:m=o}=this._userSpec;return(0,s.Z)(m)&&"%"===m[m.length-1]&&(m=o*(Number.parseFloat(m.substring(0,m.length-1))/100)),{fontStyle:n,fontVariant:l,fontFamily:h,fontSize:o,fontWeight:a,textAlign:d,textBaseline:p,ellipsis:g,limit:f,lineHeight:m}}measure(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}fullMeasure(t){let e;if((0,n.Z)(t))return{width:0,height:0};if((0,n.Z)(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);let{fontFamily:i,fontSize:r,fontWeight:s,textAlign:l,textBaseline:a,ellipsis:o,limit:h,lineHeight:u}=this.textSpec;try{let n=this._option.getTextBounds({text:t,fontFamily:i,fontSize:r,fontWeight:s,textAlign:l,textBaseline:a,ellipsis:!!o,maxLineWidth:h||1/0,lineHeight:u});e={width:n.width(),height:n.height()}}catch(i){this._notSupportVRender=!0,e=this.measureWithNaiveCanvas(t)}return e}measureWithNaiveCanvas(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(t){if(!this.initContext())return this._quickMeasureWithoutCanvas(t);let e=this._context.measureText(t),{fontSize:i,lineHeight:r}=this.textSpec;return{width:e.width,height:null!=r?r:i,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}quickMeasure(t){return this._measureReduce(t,this._quickMeasure.bind(this))}_quickMeasure(t){let e={width:0,height:0};for(let i=0;i<t.length;i++){let r=t[i],s=this._measureSpecialChar(r);(0,n.Z)(s)&&h.NUMBERS_CHAR_SET.includes(r)&&(s=this._measureNumberChar()),(0,n.Z)(s)&&["F","W"].includes(a(r))&&(s=this._measureFullSizeChar()),(0,n.Z)(s)&&(s=this._measureLetterChar()),e.width+=s.width,e.height=Math.max(e.height,s.height),(0,n.Z)(s.fontBoundingBoxAscent)||(e.fontBoundingBoxAscent=s.fontBoundingBoxAscent),(0,n.Z)(s.fontBoundingBoxDescent)||(e.fontBoundingBoxDescent=s.fontBoundingBoxDescent)}return e}quickMeasureWithoutCanvas(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(t){let e={width:0,height:0},{fontSize:i,lineHeight:r}=this.textSpec;for(let r=0;r<t.length;r++){let n=["F","W"].includes(a(t[r]))?1:.53;e.width+=n*i}return e.height=null!=r?r:i,e}_measureReduce(t,e){let{fontSize:i,lineHeight:s}=this.textSpec,a={width:0,height:0};if((0,n.Z)(t))return a;if((0,l.Z)(t)){let n=t.filter(r.Z).map(t=>t.toString());return 0===n.length?a:1===n.length?e(n[0]):{width:n.reduce((t,i)=>Math.max(t,e(i).width),0),height:n.length*((null!=s?s:i)+1)+1}}return e(t.toString())}_measureNumberChar(){if((0,n.Z)(this._numberCharSize)){let t=this._standardMethod(h.NUMBERS_CHAR_SET);this._numberCharSize={width:t.width/h.NUMBERS_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return(0,n.Z)(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(h.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if((0,n.Z)(this._letterCharSize)){let t=this._standardMethod(h.ALPHABET_CHAR_SET);this._letterCharSize={width:t.width/h.ALPHABET_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(t){return(0,r.Z)(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}release(){(0,r.Z)(this._canvas)&&(this._canvas=null),(0,r.Z)(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}h.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",h.NUMBERS_CHAR_SET="0123456789",h.FULL_SIZE_CHAR="字"},28504:function(t,e,i){"use strict";function r(t,e={},i){i||(i=1);let{fontStyle:n=e.fontStyle,fontVariant:s=e.fontVariant,fontWeight:l=e.fontWeight,fontSize:a=e.fontSize,fontFamily:o=e.fontFamily}=t;return(n?n+" ":"")+(s?s+" ":"")+(l?l+" ":"")+a*i+"px "+(o||"sans-serif")}i.d(e,{U:()=>r})},30943:function(t,e,i){"use strict";i.d(e,{Y:()=>o});var r,n,s=i(45273);let l="undefined"!=typeof console;function a(t,e,i){let r=[e].concat([].slice.call(i));l&&console[t].apply(console,r)}(r=n||(n={}))[r.None=0]="None",r[r.Error=1]="Error",r[r.Warn=2]="Warn",r[r.Info=3]="Info",r[r.Debug=4]="Debug";class o{static getInstance(t,e){return o._instance&&(0,s.Z)(t)?o._instance.level(t):o._instance||(o._instance=new o(t,e)),o._instance}static setInstance(t){return o._instance=t}static setInstanceLevel(t){o._instance?o._instance.level(t):o._instance=new o(t)}static clearInstance(){o._instance=null}constructor(t=n.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){let e=this._onErrorHandler.findIndex(e=>e===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=n.Info}canLogDebug(){return this._level>=n.Debug}canLogError(){return this._level>=n.Error}canLogWarn(){return this._level>=n.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=n.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):a(null!=(e=this._method)?e:"error","ERROR",t)),this}warn(...t){return this._level>=n.Warn&&a(this._method||"warn","WARN",t),this}info(...t){return this._level>=n.Info&&a(this._method||"log","INFO",t),this}debug(...t){return this._level>=n.Debug&&a(this._method||"log","DEBUG",t),this}}o._instance=null},88504:function(t,e,i){"use strict";i.d(e,{BZ:()=>l,Bw:()=>_,Fp:()=>d,Ho:()=>r,KU:()=>v,Kh:()=>m,O$:()=>p,VV:()=>c,Wn:()=>o,ZR:()=>y,_b:()=>g,f7:()=>a,fv:()=>h,ir:()=>b,mC:()=>u,ou:()=>s,pi:()=>n,sQ:()=>f});let r=1e-12,n=Math.PI,s=n/2,l=2*n,a=2*Math.PI,o=Math.abs,h=Math.atan2,u=Math.cos,d=Math.max,c=Math.min,p=Math.sin,g=Math.sqrt,f=Math.pow;function m(t){return t>1?0:t<-1?n:Math.acos(t)}function y(t){return t>=1?s:t<=-1?-s:Math.asin(t)}function v(t,e,i,r,n){let s=i,l=r;return"number"==typeof t&&"number"==typeof i&&(s=(1-n)*t+n*i),"number"==typeof e&&"number"==typeof r&&(l=(1-n)*e+n*r),{x:s,y:l}}function b(t,e){return t[0]*e[1]-t[1]*e[0]}function _(t,e){return o(t[0]-e[0])+o(t[1]-e[1])<1e-12}},11681:function(t,e,i){"use strict";i.d(e,{o:()=>l});var r=i(70501),n=i(31535),s=i(43562);function l(t){if((0,r.Z)(t))return[t,t,t,t];if((0,n.Z)(t)){let e=t.length;if(1===e){let e=t[0];return[e,e,e,e]}if(2===e){let[e,i]=t;return[e,i,e,i]}if(3===e){let[e,i,r]=t;return[e,i,r,i]}if(4===e)return t}if((0,s.Z)(t)){let{top:e=0,right:i=0,bottom:r=0,left:n=0}=t;return[e,i,r,n]}return[0,0,0,0]}},78596:function(t){var e={},i=RegExp("^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$","i"),r=["style","variant","weight","size","lineHeight","family"],n=/([\.0-9]+)(.*)/,s=function(t,e,i){var r=t.match(n);if(r){t=parseFloat(r[1]);var s=r[2].toLowerCase().trim(),l=Math.round(t);switch(l===t&&(t=l),s){case"em":if(null===e)return;return t*e;case"px":return t;case"pt":return t/(72/i);case"pc":return t/(6/i);case"mm":return i/25.4*t;case"cm":return i/2.54*t;case"in":return t*i;case"%":if(null===e)return;return t/100*e}}},l={size:s,lineHeight:s},a={serif:1,"sans-serif":1,cursive:1,fantasy:1,monospace:1},o=t.exports=function(t,n,s){var h=t+"-"+(n||"null")+"@"+s;if(s=s||96,void 0!==e[h])return e[h];if(n&&(n=o(n,null,s)),"inherit"===t)return n;var u=i.exec(t);if(!u){e[h]=null;return}u.shift();for(var d={},c=0;c<u.length;c++){var p=r[c],g=u[c];if(l[p]&&g){var f=n&&n[p]||null,m=l[p](g,f,s);g=void 0===m&&"lineHeight"===p&&g?d.size*parseFloat(g):m}if(g&&"normal"!==g){if("inherit"===g){if(!n)return;g=n[p]}g.trim&&(g=g.trim()),d[p]=g}}Object.keys(d).length||(d=null),e[h]=d;var y=[];d.style&&y.push(d.style),d.variant&&y.push(d.variant),d.weight&&"400"!==d.weight&&"normal"!==d.weight&&y.push(d.weight),y.push(d.size+"px"),d.lineHeight&&(y[y.length-1]+="/"+d.lineHeight+"px");var v=d.family.split(",");return d.family=v.map(function(t){return a[(t=t.trim()).toLowerCase()]&&(t=t.toLowerCase()),t}),y.push(d.family),Object.defineProperty(d,"toString",{value:function(){return y.map(function(t){return Array.isArray(t)?t.map(function(t){return t.indexOf(" ")>-1?'"'+t.replace(/["']/g,"")+'"':t}).join(", "):t}).join(" ")}}),d};t.exports.generics=a},21883:function(t){"use strict";var e=Object.prototype.hasOwnProperty,i="~";function r(){}function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,r,s,l){if("function"!=typeof r)throw TypeError("The listener must be a function");var a=new n(r,s||t,l),o=i?i+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],a]:t._events[o].push(a):(t._events[o]=a,t._eventsCount++),t}function l(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(i=!1)),a.prototype.eventNames=function(){var t,r,n=[];if(0===this._eventsCount)return n;for(r in t=this._events)e.call(t,r)&&n.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},a.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,l=Array(s);n<s;n++)l[n]=r[n].fn;return l},a.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,n,s,l){var a=i?i+t:t;if(!this._events[a])return!1;var o,h,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,n),!0;case 5:return u.fn.call(u.context,e,r,n,s),!0;case 6:return u.fn.call(u.context,e,r,n,s,l),!0}for(h=1,o=Array(d-1);h<d;h++)o[h-1]=arguments[h];u.fn.apply(u.context,o)}else{var c,p=u.length;for(h=0;h<p;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),d){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,r);break;case 4:u[h].fn.call(u[h].context,e,r,n);break;default:if(!o)for(c=1,o=Array(d-1);c<d;c++)o[c-1]=arguments[c];u[h].fn.apply(u[h].context,o)}}return!0},a.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},a.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},a.prototype.removeListener=function(t,e,r,n){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return l(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||n&&!a.once||r&&a.context!==r||l(this,s);else{for(var o=0,h=[],u=a.length;o<u;o++)(a[o].fn!==e||n&&!a[o].once||r&&a[o].context!==r)&&h.push(a[o]);h.length?this._events[s]=1===h.length?h[0]:h:l(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&l(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,t.exports=a},50958:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deinterlace=void 0,e.deinterlace=function(t,e){for(var i=Array(t.length),r=t.length/e,n=[0,4,2,1],s=[8,8,4,2],l=0,a=0;a<4;a++)for(var o=n[a];o<r;o+=s[a])!function(r,n){var s=t.slice(n*e,(n+1)*e);i.splice.apply(i,[r*e,e].concat(s))}(o,l),l++;return i}},29216:function(t,e,i){"use strict";e.decompressFrames=e.parseGIF=void 0;var r,n=(r=i(95205))&&r.__esModule?r:{default:r},s=i(74223),l=i(4545),a=i(50958),o=i(11783);e.parseGIF=function(t){var e=new Uint8Array(t);return(0,s.parse)((0,l.buildStream)(e),n.default)};var h=function(t){for(var e=t.pixels.length,i=new Uint8ClampedArray(4*e),r=0;r<e;r++){var n=4*r,s=t.pixels[r],l=t.colorTable[s]||[0,0,0];i[n]=l[0],i[n+1]=l[1],i[n+2]=l[2],i[n+3]=255*(s!==t.transparentIndex)}return i},u=function(t,e,i){if(!t.image)return void console.warn("gif frame does not have associated image.");var r=t.image,n=r.descriptor.width*r.descriptor.height,s=(0,o.lzw)(r.data.minCodeSize,r.data.blocks,n);r.descriptor.lct.interlaced&&(s=(0,a.deinterlace)(s,r.descriptor.width));var l={pixels:s,dims:{top:t.image.descriptor.top,left:t.image.descriptor.left,width:t.image.descriptor.width,height:t.image.descriptor.height}};return r.descriptor.lct&&r.descriptor.lct.exists?l.colorTable=r.lct:l.colorTable=e,t.gce&&(l.delay=10*(t.gce.delay||10),l.disposalType=t.gce.extras.disposal,t.gce.extras.transparentColorGiven&&(l.transparentIndex=t.gce.transparentColorIndex)),i&&(l.patch=h(l)),l};e.decompressFrames=function(t,e){return t.frames.filter(function(t){return t.image}).map(function(i){return u(i,t.gct,e)})}},11783:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.lzw=void 0,e.lzw=function(t,e,i){var r,n,s,l,a,o,h,u,d,c,p,g,f,m,y,v=Array(i),b=Array(4096),_=Array(4096),x=Array(4097);for(u=0,a=(n=1<<t)+1,r=n+2,h=-1,s=(1<<(l=t+1))-1;u<n;u++)b[u]=0,_[u]=u;for(d=0,c=p=g=f=m=y=0;d<i;){if(0===f){if(p<l){c+=e[y]<<p,p+=8,y++;continue}if(u=c&s,c>>=l,p-=l,u>r||u==a)break;if(u==n){s=(1<<(l=t+1))-1,r=n+2,h=-1;continue}if(-1==h){x[f++]=_[u],h=u,g=u;continue}for(o=u,u==r&&(x[f++]=g,u=h);u>n;)x[f++]=_[u],u=b[u];g=255&_[u],x[f++]=g,r<4096&&(b[r]=h,_[r]=g,(++r&s)==0&&r<4096&&(l++,s+=r)),h=o}f--,v[m++]=x[f],d++}for(d=m;d<i;d++)v[d]=0;return v}},74223:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loop=e.conditional=e.parse=void 0,e.parse=function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;if(Array.isArray(i))i.forEach(function(i){return t(e,i,r,n)});else if("function"==typeof i)i(e,r,n,t);else{var s=Object.keys(i)[0];Array.isArray(i[s])?(n[s]={},t(e,i[s],r,n[s])):n[s]=i[s](e,r,n,t)}return r},e.conditional=function(t,e){return function(i,r,n,s){e(i,r,n)&&s(i,t,r,n)}},e.loop=function(t,e){return function(i,r,n,s){for(var l=[],a=i.pos;e(i,r,n);){var o={};if(s(i,t,r,o),i.pos===a)break;a=i.pos,l.push(o)}return l}}},4545:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.readBits=e.readArray=e.readUnsigned=e.readString=e.peekBytes=e.readBytes=e.peekByte=e.readByte=e.buildStream=void 0,e.buildStream=function(t){return{data:t,pos:0}};var i=function(){return function(t){return t.data[t.pos++]}};e.readByte=i,e.peekByte=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e){return e.data[e.pos+t]}};var r=function(t){return function(e){return e.data.subarray(e.pos,e.pos+=t)}};e.readBytes=r,e.peekBytes=function(t){return function(e){return e.data.subarray(e.pos,e.pos+t)}},e.readString=function(t){return function(e){return Array.from(r(t)(e)).map(function(t){return String.fromCharCode(t)}).join("")}},e.readUnsigned=function(t){return function(e){var i=r(2)(e);return t?(i[1]<<8)+i[0]:(i[0]<<8)+i[1]}},e.readArray=function(t,e){return function(i,n,s){for(var l="function"==typeof e?e(i,n,s):e,a=r(t),o=Array(l),h=0;h<l;h++)o[h]=a(i);return o}};var n=function(t,e,i){for(var r=0,n=0;n<i;n++)r+=t[e+n]&&Math.pow(2,i-n-1);return r};e.readBits=function(t){return function(e){for(var r=i()(e),s=Array(8),l=0;l<8;l++)s[7-l]=!!(r&1<<l);return Object.keys(t).reduce(function(e,i){var r=t[i];return r.length?e[i]=n(s,r.index,r.length):e[i]=s[r.index],e},{})}}},95205:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(74223),n=i(4545),s={blocks:function(t){for(var e=[],i=t.data.length,r=0,s=(0,n.readByte)()(t);0!==s&&s;s=(0,n.readByte)()(t)){if(t.pos+s>=i){var l=i-t.pos;e.push((0,n.readBytes)(l)(t)),r+=l;break}e.push((0,n.readBytes)(s)(t)),r+=s}for(var a=new Uint8Array(r),o=0,h=0;h<e.length;h++)a.set(e[h],o),o+=e[h].length;return a}},l=(0,r.conditional)({gce:[{codes:(0,n.readBytes)(2)},{byteSize:(0,n.readByte)()},{extras:(0,n.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,n.readUnsigned)(!0)},{transparentColorIndex:(0,n.readByte)()},{terminator:(0,n.readByte)()}]},function(t){var e=(0,n.peekBytes)(2)(t);return 33===e[0]&&249===e[1]}),a=(0,r.conditional)({image:[{code:(0,n.readByte)()},{descriptor:[{left:(0,n.readUnsigned)(!0)},{top:(0,n.readUnsigned)(!0)},{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{lct:(0,n.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,r.conditional)({lct:(0,n.readArray)(3,function(t,e,i){return Math.pow(2,i.descriptor.lct.size+1)})},function(t,e,i){return i.descriptor.lct.exists}),{data:[{minCodeSize:(0,n.readByte)()},s]}]},function(t){return 44===(0,n.peekByte)()(t)}),o=(0,r.conditional)({text:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{preData:function(t,e,i){return(0,n.readBytes)(i.text.blockSize)(t)}},s]},function(t){var e=(0,n.peekBytes)(2)(t);return 33===e[0]&&1===e[1]}),h=(0,r.conditional)({application:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{id:function(t,e,i){return(0,n.readString)(i.blockSize)(t)}},s]},function(t){var e=(0,n.peekBytes)(2)(t);return 33===e[0]&&255===e[1]}),u=(0,r.conditional)({comment:[{codes:(0,n.readBytes)(2)},s]},function(t){var e=(0,n.peekBytes)(2)(t);return 33===e[0]&&254===e[1]});e.default=[{header:[{signature:(0,n.readString)(3)},{version:(0,n.readString)(3)}]},{lsd:[{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{gct:(0,n.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,n.readByte)()},{pixelAspectRatio:(0,n.readByte)()}]},(0,r.conditional)({gct:(0,n.readArray)(3,function(t,e){return Math.pow(2,e.lsd.gct.size+1)})},function(t,e){return e.lsd.gct.exists}),{frames:(0,r.loop)([l,h,u,a,o],function(t){var e=(0,n.peekByte)()(t);return 33===e||44===e})}]},85208:function(t,e,i){var r=i(34440),n=i(84108),s=i(61085),l=i(77706),a=i(8636);function o(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}o.prototype.clear=r,o.prototype.delete=n,o.prototype.get=s,o.prototype.has=l,o.prototype.set=a,t.exports=o},81998:function(t,e,i){var r=i(90266),n=i(42875),s=i(45828),l=i(24115),a=i(67690);function o(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}o.prototype.clear=r,o.prototype.delete=n,o.prototype.get=s,o.prototype.has=l,o.prototype.set=a,t.exports=o},72887:function(t,e,i){t.exports=i(65234)(i(83250),"Map")},95678:function(t,e,i){var r=i(39016),n=i(62363),s=i(64348),l=i(53062),a=i(30262);function o(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}o.prototype.clear=r,o.prototype.delete=n,o.prototype.get=s,o.prototype.has=l,o.prototype.set=a,t.exports=o},70861:function(t,e,i){t.exports=i(83250).Symbol},29233:function(t){t.exports=function(t,e){for(var i=-1,r=null==t?0:t.length,n=Array(r);++i<r;)n[i]=e(t[i],i,t);return n}},18498:function(t,e,i){var r=i(58260);t.exports=function(t,e){for(var i=t.length;i--;)if(r(t[i][0],e))return i;return -1}},40548:function(t,e,i){var r=i(24007),n=i(86040);t.exports=function(t,e){e=r(e,t);for(var i=0,s=e.length;null!=t&&i<s;)t=t[n(e[i++])];return i&&i==s?t:void 0}},69823:function(t,e,i){var r=i(70861),n=i(91339),s=i(25151),l=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":l&&l in Object(t)?n(t):s(t)}},99817:function(t,e,i){var r=i(45563),n=i(28597),s=i(93702),l=i(55784),a=/^\[object .+?Constructor\]$/,o=Object.prototype,h=Function.prototype.toString,u=o.hasOwnProperty,d=RegExp("^"+h.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!s(t)||n(t))&&(r(t)?d:a).test(l(t))}},86245:function(t,e,i){var r=i(70861),n=i(29233),s=i(55589),l=i(52624),a=1/0,o=r?r.prototype:void 0,h=o?o.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(s(e))return n(e,t)+"";if(l(e))return h?h.call(e):"";var i=e+"";return"0"==i&&1/e==-a?"-0":i}},24007:function(t,e,i){var r=i(55589),n=i(5130),s=i(44041),l=i(99835);t.exports=function(t,e){return r(t)?t:n(t,e)?[t]:s(l(t))}},1622:function(t,e,i){t.exports=i(83250)["__core-js_shared__"]},20302:function(t,e,i){t.exports="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g},77570:function(t,e,i){var r=i(58949);t.exports=function(t,e){var i=t.__data__;return r(e)?i["string"==typeof e?"string":"hash"]:i.map}},65234:function(t,e,i){var r=i(99817),n=i(67736);t.exports=function(t,e){var i=n(t,e);return r(i)?i:void 0}},91339:function(t,e,i){var r=i(70861),n=Object.prototype,s=n.hasOwnProperty,l=n.toString,a=r?r.toStringTag:void 0;t.exports=function(t){var e=s.call(t,a),i=t[a];try{t[a]=void 0;var r=!0}catch(t){}var n=l.call(t);return r&&(e?t[a]=i:delete t[a]),n}},67736:function(t){t.exports=function(t,e){return null==t?void 0:t[e]}},34440:function(t,e,i){var r=i(24545);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},84108:function(t){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=!!e,e}},61085:function(t,e,i){var r=i(24545),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return n.call(e,t)?e[t]:void 0}},77706:function(t,e,i){var r=i(24545),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:n.call(e,t)}},8636:function(t,e,i){var r=i(24545);t.exports=function(t,e){var i=this.__data__;return this.size+=+!this.has(t),i[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},5130:function(t,e,i){var r=i(55589),n=i(52624),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var i=typeof t;return!!("number"==i||"symbol"==i||"boolean"==i||null==t||n(t))||l.test(t)||!s.test(t)||null!=e&&t in Object(e)}},58949:function(t){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},28597:function(t,e,i){var r,n=i(1622),s=(r=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!s&&s in t}},90266:function(t){t.exports=function(){this.__data__=[],this.size=0}},42875:function(t,e,i){var r=i(18498),n=Array.prototype.splice;t.exports=function(t){var e=this.__data__,i=r(e,t);return!(i<0)&&(i==e.length-1?e.pop():n.call(e,i,1),--this.size,!0)}},45828:function(t,e,i){var r=i(18498);t.exports=function(t){var e=this.__data__,i=r(e,t);return i<0?void 0:e[i][1]}},24115:function(t,e,i){var r=i(18498);t.exports=function(t){return r(this.__data__,t)>-1}},67690:function(t,e,i){var r=i(18498);t.exports=function(t,e){var i=this.__data__,n=r(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this}},39016:function(t,e,i){var r=i(85208),n=i(81998),s=i(72887);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(s||n),string:new r}}},62363:function(t,e,i){var r=i(77570);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=!!e,e}},64348:function(t,e,i){var r=i(77570);t.exports=function(t){return r(this,t).get(t)}},53062:function(t,e,i){var r=i(77570);t.exports=function(t){return r(this,t).has(t)}},30262:function(t,e,i){var r=i(77570);t.exports=function(t,e){var i=r(this,t),n=i.size;return i.set(t,e),this.size+=+(i.size!=n),this}},32924:function(t,e,i){var r=i(67997);t.exports=function(t){var e=r(t,function(t){return 500===i.size&&i.clear(),t}),i=e.cache;return e}},24545:function(t,e,i){t.exports=i(65234)(Object,"create")},25151:function(t){var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},83250:function(t,e,i){var r=i(20302),n="object"==typeof self&&self&&self.Object===Object&&self;t.exports=r||n||Function("return this")()},44041:function(t,e,i){var r=i(32924),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g;t.exports=r(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(n,function(t,i,r,n){e.push(r?n.replace(s,"$1"):i||t)}),e})},86040:function(t,e,i){var r=i(52624),n=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-n?"-0":e}},55784:function(t){var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},58260:function(t){t.exports=function(t,e){return t===e||t!=t&&e!=e}},13546:function(t,e,i){var r=i(40548);t.exports=function(t,e,i){var n=null==t?void 0:r(t,e);return void 0===n?i:n}},55589:function(t){t.exports=Array.isArray},45563:function(t,e,i){var r=i(69823),n=i(93702);t.exports=function(t){if(!n(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},93702:function(t){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},50440:function(t){t.exports=function(t){return null!=t&&"object"==typeof t}},52624:function(t,e,i){var r=i(69823),n=i(50440);t.exports=function(t){return"symbol"==typeof t||n(t)&&"[object Symbol]"==r(t)}},67997:function(t,e,i){var r=i(95678);function n(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var i=function(){var r=arguments,n=e?e.apply(this,r):r[0],s=i.cache;if(s.has(n))return s.get(n);var l=t.apply(this,r);return i.cache=s.set(n,l)||s,l};return i.cache=new(n.Cache||r),i}n.Cache=r,t.exports=n},99835:function(t,e,i){var r=i(86245);t.exports=function(t){return null==t?"":r(t)}},30939:function(t,e,i){var r=i(25666);function n(e,i){var r=e.geometry,n=r.type;if("LineString"===n)r.coordinates=t.exports.simplify(r.coordinates,i);else if("Polygon"===n||"MultiLineString"===n)for(var s=0;s<r.coordinates.length;s++)r.coordinates[s]=t.exports.simplify(r.coordinates[s],i);else if("MultiPolygon"===n)for(var l=0;l<r.coordinates.length;l++)for(var a=0;a<r.coordinates[l].length;a++)r.coordinates[l][a]=t.exports.simplify(r.coordinates[l][a],i);return e}t.exports=function(t,e,i){return(i||(t=JSON.parse(JSON.stringify(t))),t.features)?function(t,e){for(var i=0;i<t.features.length;i++)t.features[i]=n(t.features[i],e);return t}(t,e):t.type&&"Feature"===t.type?n(t,e):Error("FeatureCollection or individual Feature required")},t.exports.simplify=function(t,e){return r(t,e)}},25666:function(t,e,i){var r=i(45549),n=function(t,e){for(var i=0,s=0,l=1;l<=t.length-2;l++){var a=new r(t[0],t[t.length-1]).perpendicularDistance(t[l]);a>i&&(s=l,i=a)}if(i>e)var o=n(t.slice(0,s),e),h=n(t.slice(s,t.length),e),u=o.concat(h);else u=t.length>1?[t[0],t[t.length-1]]:[t[0]];return u};t.exports=n},45549:function(t){var e=function(t,e){this.p1=t,this.p2=e};e.prototype.rise=function(){return this.p2[1]-this.p1[1]},e.prototype.run=function(){return this.p2[0]-this.p1[0]},e.prototype.slope=function(){return this.rise()/this.run()},e.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},e.prototype.isVertical=function(){return!isFinite(this.slope())},e.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},e.prototype._perpendicularDistanceHorizontal=function(t){return Math.abs(this.p1[1]-t[1])},e.prototype._perpendicularDistanceVertical=function(t){return Math.abs(this.p1[0]-t[0])},e.prototype._perpendicularDistanceHasSlope=function(t){var e=this.slope(),i=this.yIntercept();return Math.abs(e*t[0]-t[1]+i)/Math.sqrt(Math.pow(e,2)+1)},e.prototype.perpendicularDistance=function(t){return this.isVertical()?this._perpendicularDistanceVertical(t):this.isHorizontal()?this._perpendicularDistanceHorizontal(t):this._perpendicularDistanceHasSlope(t)},t.exports=e},84086:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(65751);function n(...t){return(0,r.a)(s,t)}function s(t,e){let i={};for(let r of e)r in t&&(i[r]=t[r]);return i}},83671:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(25441);function n(t,...e){let i=t,s=e.map(t=>"lazy"in t?function(t){let{lazy:e,lazyArgs:i}=t;return Object.assign(e(...i),{isSingle:e.single??!1,index:0,items:[]})}(t):void 0),l=0;for(;l<e.length;){var a;if(void 0===s[l]||!("string"==typeof(a=i)||"object"==typeof a&&null!==a&&Symbol.iterator in a)){i=(0,e[l])(i),l+=1;continue}let t=[];for(let i=l;i<e.length;i++){let e=s[i];if(void 0===e||(t.push(e),e.isSingle))break}let n=[];for(let e of i)if(function t(e,i,n){if(0===n.length)return i.push(e),!1;let s=e,l=r.a,a=!1;for(let[e,r]of n.entries()){let{index:o,items:h}=r;if(h.push(s),l=r(s,o,h),r.index+=1,l.hasNext){if(l.hasMany){for(let r of l.next)if(t(r,i,n.slice(e+1)))return!0;return a}s=l.next}if(!l.hasNext)break;l.done&&(a=!0)}return l.hasNext&&i.push(s),a}(e,n,t))break;let{isSingle:o}=t.at(-1);i=o?n[0]:n,l+=t.length}return i}},94321:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(65751);function n(...t){return(0,r.a)(s,t)}function s(t,e){let i={};for(let[r,n]of Object.entries(t)){let s=e(n,r,t);i[r]=s}return i}},57969:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(65751);function n(...t){return(0,r.a)(s,t)}var s=(t,e)=>({...t,...e})},36922:function(t,e,i){"use strict";function r(t){return"number"==typeof t&&!Number.isNaN(t)}i.d(e,{a:()=>r})},36628:function(t,e,i){"use strict";i.d(e,{a:()=>s});var r=i(12437),n=i(25441);function s(...t){return(0,r.a)(l,t)}function l(t){let e=new Set;return(i,r,s)=>{let l=t(i,r,s);return e.has(l)?n.a:(e.add(l),{done:!1,hasNext:!0,next:i})}}},25441:function(t,e,i){"use strict";i.d(e,{a:()=>r});var r={done:!1,hasNext:!1}},51560:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(65751);function n(...t){return(0,r.a)(function t(e,i=[],r=[]){if("function"==typeof e)return e;if("object"!=typeof e||null===e)return structuredClone(e);let n=Object.getPrototypeOf(e);if(!Array.isArray(e)&&null!==n&&n!==Object.prototype)return structuredClone(e);let s=i.indexOf(e);return -1!==s?r[s]:(i.push(e),Array.isArray(e)?function(e,i,r){let n=[];for(let[s,l]of(r.push(n),e.entries()))n[s]=t(l,i,r);return n}(e,i,r):function(e,i,r){let n={};for(let[s,l]of(r.push(n),Object.entries(e)))n[s]=t(l,i,r);return n}(e,i,r))},t)}},16304:function(t,e,i){"use strict";function r(t){return Array.isArray(t)}i.d(e,{a:()=>r})},6070:function(t,e,i){"use strict";function r(t){if("object"!=typeof t||null===t)return!1;let e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}i.d(e,{a:()=>r})},24922:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(65751);function n(...t){return(0,r.a)(function t(e,i){if(e===i||Object.is(e,i))return!0;if("object"!=typeof e||"object"!=typeof i||null===e||null===i||Object.getPrototypeOf(e)!==Object.getPrototypeOf(i))return!1;if(Array.isArray(e)){var r=e,n=i;if(r.length!==n.length)return!1;for(let[e,i]of r.entries())if(!t(i,n[e]))return!1;return!0}if(e instanceof Map){var s=e,l=i;if(s.size!==l.size)return!1;for(let[e,i]of s.entries())if(!l.has(e)||!t(i,l.get(e)))return!1;return!0}if(e instanceof Set){var a=e,o=i;if(a.size!==o.size)return!1;let r=[...o];for(let e of a){let i=!1;for(let[n,s]of r.entries())if(t(e,s)){i=!0,r.splice(n,1);break}if(!i)return!1}return!0}if(e instanceof Date)return e.getTime()===i.getTime();if(e instanceof RegExp)return e.toString()===i.toString();if(Object.keys(e).length!==Object.keys(i).length)return!1;for(let[r,n]of Object.entries(e))if(!(r in i)||!t(n,i[r]))return!1;return!0},t)}},83498:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(65751);function n(...t){return(0,r.a)(s,t)}var s=(t,e)=>{let i=Object.create(null);for(let r=0;r<t.length;r++){let n=t[r],s=e(n,r,t);if(void 0!==s){let t=i[s];void 0===t?i[s]=[n]:t.push(n)}}return Object.setPrototypeOf(i,Object.prototype),i}},12341:function(t,e,i){"use strict";function r(t){return null==t}i.d(e,{a:()=>r})},24356:function(t,e,i){"use strict";i.d(e,{a:()=>l});var r=i(65751);function n(...t){return(0,r.a)(s,t)}var s=(t,e)=>t.length>=e;function l(...t){return(0,r.a)(a,t)}function a(t,e){if(!n(e,1))return{...t};if(!n(e,2)){let{[e[0]]:i,...r}=t;return r}let i={...t};for(let t of e)delete i[t];return i}},12437:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(83671);function n(t,e){let i=e.length-t.length;if(1===i){let[i,...n]=e;return(0,r.a)(i,{lazy:t,lazyArgs:n})}if(0===i){let i={lazy:t,lazyArgs:e};return Object.assign(t=>(0,r.a)(t,i),i)}throw Error("Wrong number of arguments")}},34712:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(65751);function n(...t){return(0,r.a)(s,t)}function s(t,e){let i=[...t];return i.sort(e),i}},62443:function(t,e,i){"use strict";function r(t){return"object"==typeof t&&null!==t}i.d(e,{a:()=>r})},41514:function(t,e,i){"use strict";i.d(e,{a:()=>s});var r=i(6070),n=i(65751);function s(...t){return(0,n.a)(function t(e,i){let n={...e,...i};for(let s in i){if(!(s in e))continue;let{[s]:l}=e;if(!(0,r.a)(l))continue;let{[s]:a}=i;(0,r.a)(a)&&(n[s]=t(l,a))}return n},t)}},40160:function(t,e,i){"use strict";i.d(e,{a:()=>s});var r=i(12437),n=i(25441);function s(...t){return(0,r.a)(l,t)}function l(){let t=new Set;return e=>t.has(e)?n.a:(t.add(e),{done:!1,hasNext:!0,next:e})}},53126:function(t,e,i){"use strict";function r(t){return"string"==typeof t}i.d(e,{a:()=>r})},60647:function(t,e,i){"use strict";function r(t){return void 0===t||("string"==typeof t||Array.isArray(t)?0===t.length:0===Object.keys(t).length)}i.d(e,{a:()=>r})},65751:function(t,e,i){"use strict";function r(t,e,i){let r=t.length-e.length;if(0===r)return t(...e);if(1===r){let r;return r=i=>t(i,...e),void 0===i?r:Object.assign(r,{lazy:i,lazyArgs:e})}throw Error("Wrong number of arguments")}i.d(e,{a:()=>r})}}]);
//# sourceMappingURL=9881.fe8e42b4.js.map