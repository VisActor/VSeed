"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["5761"],{49474:function(e,t,r){r.d(t,{Z:()=>t4});var o,i,n,l,s,a={};r.r(a),r.d(a,{AggregationType:()=>H.E,Aggregator:()=>A.jk,AvgAggregator:()=>A.ky,CountAggregator:()=>A.ZP,CustomAggregator:()=>A.Js,HierarchyState:()=>T.g,HighlightScope:()=>R.p,IconFuncTypeEnum:()=>M.cI,IconPosition:()=>M.q0,InteractionState:()=>R.F,InternalIconName:()=>M.up,MaxAggregator:()=>A.Fn,MinAggregator:()=>A.NF,NoneAggregator:()=>A.ld,Placement:()=>T.u,RecalculateAggregator:()=>A.U4,RecordAggregator:()=>A.hT,SortType:()=>H.F,SumAggregator:()=>A.__,cellStyleKeys:()=>S.n,indicatorSort:()=>A.vg,naturalSort:()=>A.SL,registeredAggregators:()=>A.YJ,sortBy:()=>A.MR,typeSort:()=>A.y4});var u={};r.r(u),r.d(u,{BaseTable:()=>x.D});var h={};r.r(h),r.d(h,{CachedDataSource:()=>I.Z,DataSource:()=>_.o2});var d={};r.r(d),r.d(d,{dateFormat:()=>N,numberFormat:()=>B});var c={};r.r(c),r.d(c,{CustomCellStylePlugin:()=>z.Wg,PluginManager:()=>L.Q});var p={};r.r(p),r.d(p,{Arc:()=>eW,CheckBox:()=>eJ.J,Circle:()=>eF,Container:()=>eE,Group:()=>e$,GroupElement:()=>eB,Icon:()=>eL,Image:()=>ez,Line:()=>eq.x,Radio:()=>eY.Y,Rect:()=>eD,Tag:()=>eG,Text:()=>eK,percentCalc:()=>ej});var g={};r.r(g),r.d(g,{CustomLayout:()=>p,DataStatistics:()=>d,EventTarget:()=>e8.R,Icon:()=>e9.J,ListTable:()=>ew,ListTableSimple:()=>ev,PIVOT_CHART_EVENT_TYPE:()=>eR.Z,PIVOT_TABLE_EVENT_TYPE:()=>eR.z,PivotChart:()=>e_.z,PivotTable:()=>eA,PivotTableSimple:()=>ex,TABLE_EVENT_TYPE:()=>q.B,TYPES:()=>a,VArc:()=>eX.NP,VArea:()=>eX.q_,VCheckBox:()=>e3,VCircle:()=>eX.uU,VGlyph:()=>eX.rE,VGroup:()=>eX.qP,VImage:()=>eX.rV,VLine:()=>eX.EG,VPath:()=>eX.VA,VPolygon:()=>eX.sg,VRadio:()=>e6,VRect:()=>eX.bZ,VSymbol:()=>eX.p8,VTag:()=>e7,VText:()=>eX.Jj,clearGlobal:()=>tr,core:()=>u,data:()=>h,getDataCellPath:()=>eQ,getIcons:()=>tt,getTargetCell:()=>U.J$,graphicUtil:()=>b.WN,jsx:()=>e5,plugins:()=>c,register:()=>O,registerAnimation:()=>ep.ph,registerAxis:()=>ep.R2,registerButtonCell:()=>ey.ah,registerChartCell:()=>ey.LQ,registerCheckboxCell:()=>ey.yR,registerEmptyTip:()=>ep.Eg,registerImageCell:()=>ey.pk,registerLegend:()=>ep.I,registerMenu:()=>ep.FD,registerProgressBarCell:()=>ey.m4,registerRadioCell:()=>ey.Jy,registerSparkLineCell:()=>ey.dB,registerSwitchCell:()=>ey.VT,registerTextCell:()=>ey.ge,registerTitle:()=>ep._t,registerTooltip:()=>ep.Mh,registerVideoCell:()=>ey.au,renderChart:()=>ed.pF,restoreMeasureText:()=>eU.sb,setCustomAlphabetCharSet:()=>eU.fg,textMeasure:()=>eU.QC,themes:()=>E,toBoxArray:()=>Q.JO,updateCell:()=>eC.wW,version:()=>te});var C=r(31549),f=r(59944),m=r(44194),y=r.t(m,2),w=r(91021),v=r(25546),P=r(59480),b=r(91925),R=r(5021),S=r(60072),H=r(21264),T=r(12348),M=r(27695),A=r(61763),x=r(56616),_=r(80983),I=r(56359),F=r(4234),O=r(94751),E=r(28399);function B(e){return e=Object.assign({},{digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:""},e),function(t){if(isNaN(t)||!isFinite(t))return"";let r=function(e,t,r){var o,i;let n=(e+="").split("."),l=n[0],s=n.length>1?r+n[1]:"";return o=l,i=t,(l=o.replace(/\d+/,function(e){return e.replace(/(\d)(?=(\d{3})+$)/g,function(e){return`${e}${i}`})}))+s}((e.scaler*t).toFixed(e.digitsAfterDecimal),e.thousandsSep,e.decimalSep);return`${e.prefix}${r}${e.suffix}`}}function N(e,t,r,o,i){null==r&&(r=!1),null==o&&(o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),null==i&&(i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);let n=r?"UTC":"",l=function(e){return`0${e}`.substring(0,2)};return function(r){let s=new Date(Date.parse(r[e]));return t.replace(/%(.)/g,function(e,t){switch(t){case"y":return s[`get${n}FullYear`]();case"m":return l(s[`get${n}Month`]()+1);case"n":return o[s[`get${n}Month`]()];case"d":return l(s[`get${n}Date`]());case"w":return i[s[`get${n}Day`]()];case"x":return s[`get${n}Day`]();case"H":return l(s[`get${n}Hours`]());case"M":return l(s[`get${n}Minutes`]());case"S":return l(s[`get${n}Seconds`]());default:return`%${t}`}})}}var L=r(61240),z=r(52110),D=r(91212),V=r(18585),K=r(90251),j=r(61768),k=r(43221),W=r(20901);class Z{constructor(e,t,r,o){var i,n;this.seqId=0,this._columnMaxDepth=0,this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this.bodyRowSpanCount=1,this._transpose=!1,this._showHeader=!0,this._recordsCount=0,this._hasAggregation=!1,this._hasAggregationOnTopCount=0,this._hasAggregationOnBottomCount=0,this._cellRangeMap=new Map,this._showHeader=r,this._table=e,this._columns=[],this._columnsIncludeHided=[],this._headerCellIds=[],this._columnMaxDepth=this._calculateMaxDepth(t),this.hierarchyIndent=null!=o?o:20,this.hierarchyTextStartAlignment=e.options.hierarchyTextStartAlignment,this.columnHierarchyType=e.options.headerHierarchyType,this.columnExpandLevel=null!=(i=e.options.headerExpandLevel)?i:1,this.columnTree=new W.KO(t,{seqId:0},null!=(n=this.columnHierarchyType)?n:null,"grid-tree"===this.columnHierarchyType?this.columnExpandLevel:void 0),this._headerObjectsIncludeHided=this._addHeaders(0,t,[]),this._headerObjects=this._headerObjectsIncludeHided.filter(e=>!0!==e.define.hide),this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this.rowHierarchyType=(0,k.C1)(this)?"tree":"grid",this._hasAggregation=(0,k.MP)(this),this._hasAggregationOnBottomCount=(0,k.WM)(this),this._hasAggregationOnTopCount=(0,k.OT)(this),this.handleRowSeriesNumber(e.internalProps.rowSeriesNumber)}handleRowSeriesNumber(e){var t,r,o;e&&(Array.isArray(e)?this.rowSeriesNumberColumn=e.map((e,t)=>{var r,o;return{id:this.seqId++,title:e.title,define:(0,D.Z)({field:"_vtable_rowSeries_number_"+t},e),cellType:null!=(r=e.cellType)?r:"text",headerType:"checkbox"===e.cellType?"checkbox":"text",style:e.style,width:e.width,format:e.format,field:null!=(o=e.field)?o:"_vtable_rowSeries_number_"+t,icon:e.icon,headerIcon:e.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:this.seqId++,title:e.title,define:(0,D.Z)({field:"_vtable_rowSeries_number"},e),cellType:null!=(t=e.cellType)?t:"text",headerType:null!=(r=e.headerType)?r:"checkbox"===e.cellType?"checkbox":"text",style:e.style,width:e.width,format:e.format,field:null!=(o=e.field)?o:"_vtable_rowSeries_number",icon:e.icon,headerIcon:e.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(e=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(e=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}get transpose(){return this._transpose}set transpose(e){this._transpose=e}get showHeader(){return this._showHeader}set showHeader(e){this._showHeader=e}isSeriesNumberInHeader(e,t){if(this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount){if(this.transpose)return!1;if(t<this.headerLevelCount)return!0}if(this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return!1;if(t<this.headerLevelCount)return!0}return!1}isSeriesNumberInBody(e,t){return!!(this.leftRowSeriesNumberColumnCount>0)&&!!(e>=0)&&!!(e<this.leftRowSeriesNumberColumnCount)&&(!!this.transpose||!!(t>=this.headerLevelCount))||!!(this.rightRowSeriesNumberColumnCount>0)&&!!(e>=this.colCount-this.rightRowSeriesNumberColumnCount)&&(!!this.transpose||!!(t>=this.headerLevelCount))||!1}isSeriesNumber(e,t){return!!((0,V.Z)(e)&&(0,V.Z)(t))&&(!!(this.leftRowSeriesNumberColumnCount>0)&&!!(e>=0)&&!!(t>=0)&&!!(e<this.leftRowSeriesNumberColumnCount)||!!(this.rightRowSeriesNumberColumnCount>0)&&!!(t>=0)&&!!(e>=this.colCount-this.rightRowSeriesNumberColumnCount))||!1}getSeriesNumberHeader(e,t){if(this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount){if(this.transpose)return;if(t<this.headerLevelCount)return Object.assign({},this.leftRowSeriesNumberColumn[e],{style:Object.assign({},this._table.transpose?this._table.internalProps.theme.rowHeaderStyle:this._table.internalProps.theme.headerStyle,this._table.internalProps.rowSeriesNumber.headerStyle)})}if(this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount){if(this.transpose)return;if(t<this.headerLevelCount)return this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]}}getSeriesNumberBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&(this.transpose||t>=this.headerLevelCount)?this.leftRowSeriesNumberColumn[e]:this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&(this.transpose||t>=this.headerLevelCount)?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}isHeader(e,t){return!!(this.transpose&&e>=this.leftRowSeriesNumberColumnCount&&e<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)||!this.transpose&&t>=0&&t<this.headerLevelCount}isAggregation(e,t){if(this.hasAggregation){if(this.hasAggregationOnBottomCount){if(this.transpose){if(e>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(t>=this.rowCount-this.hasAggregationOnBottomCount)return!0}if(this.hasAggregationOnTopCount){if(this.transpose){if(e>=this.rowHeaderLevelCount&&e<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(t>=this.columnHeaderLevelCount&&t<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}}return!1}isTopAggregation(e,t){if(this.hasAggregationOnTopCount){if(this.transpose){if(e>=this.rowHeaderLevelCount&&e<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(t>=this.columnHeaderLevelCount&&t<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}return!1}isBottomAggregation(e,t){if(this.hasAggregationOnBottomCount){if(this.transpose){if(e>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(t>=this.rowCount-this.hasAggregationOnBottomCount)return!0}return!1}get hasAggregation(){return this._hasAggregation}get hasAggregationOnTopCount(){return this._hasAggregationOnTopCount}get hasAggregationOnBottomCount(){return this._hasAggregationOnBottomCount}getAggregatorsByCell(e,t){return this.getColumnDefine(e,t).vtable_aggregator}getAggregatorsByCellRange(e,t,r,o){let i=[];if(!this.transpose){for(let o=e;o<=r;o++){let e=this.getColumnDefine(o,t);e.vtable_aggregator&&(i=i.concat(Array.isArray(e.vtable_aggregator)?e.vtable_aggregator:[e.vtable_aggregator]))}return i}for(let r=t;r<=o;r++){let t=this.getColumnDefine(e,r);t.vtable_aggregator&&(i=i.concat(Array.isArray(t.vtable_aggregator)?t.vtable_aggregator:[t.vtable_aggregator]))}return[]}getAggregatorOnTop(e,t){let r=this.getColumnDefine(e,t),o=r.vtable_aggregator,i=r.aggregation;if(Array.isArray(i)){let r=i.reduce((e,t,r)=>(t.showOnTop&&e.push(r),e),[]).map(e=>o[e]);return this.transpose?r[e-this.rowHeaderLevelCount]:r[t-this.columnHeaderLevelCount]}return this.transpose&&e-this.rowHeaderLevelCount==0?(null==i?void 0:i.showOnTop)?o:null:this.transpose||t-this.columnHeaderLevelCount!=0?null:(null==i?void 0:i.showOnTop)?o:null}getAggregatorOnBottom(e,t){let r=this.getColumnDefine(e,t),o=r.vtable_aggregator,i=r.aggregation;if(Array.isArray(i)){let r=i.reduce((e,t,r)=>(t.showOnTop||e.push(r),e),[]).map(e=>o[e]);return this.transpose?r[e-(this.colCount-this.hasAggregationOnBottomCount)]:r[t-(this.rowCount-this.hasAggregationOnBottomCount)]}return this.transpose&&e-(this.colCount-this.hasAggregationOnBottomCount)==0?(null==i?void 0:i.showOnTop)?null:o:this.transpose||t-(this.rowCount-this.hasAggregationOnBottomCount)!=0||(null==i?void 0:i.showOnTop)?null:o}getAggregatorCellAddress(e,t,r,o){let i=[],n=this.hasAggregationOnTopCount,l=this.hasAggregationOnBottomCount;if(this.transpose){for(let r=t;r<=o;r++)if(this.getColumnDefine(e,r).vtable_aggregator){for(let e=0;e<n;e++)i.push({col:this.headerLevelCount+e,row:r});for(let e=0;e<l;e++)i.push({col:this.rowCount-l+e,row:r})}}else for(let o=e;o<=r;o++)if(this.getColumnDefine(o,t).vtable_aggregator){for(let e=0;e<n;e++)i.push({col:o,row:this.headerLevelCount+e});for(let e=0;e<l;e++)i.push({col:o,row:this.rowCount-l+e})}return i}getCellLocation(e,t){return this.isHeader(e,t)?this.transpose?"rowHeader":"columnHeader":"body"}isRowHeader(e,t){return!!(this.transpose&&e>=this.leftRowSeriesNumberColumnCount&&e<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)}isColumnHeader(e,t){return!this.transpose&&t>=0&&t<=this.headerLevelCount-1&&e>=this.leftRowSeriesNumberColumnCount&&e<this.colCount-this.rightRowSeriesNumberColumnCount}isFrozenColumn(e,t){if((0,V.Z)(t)){if(e>=0&&e<this.frozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&e>=0&&e<this.frozenColCount)return!0;return!1}isRightFrozenColumn(e,t){if((0,V.Z)(t)){if(e>=this.colCount-this.rightFrozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&e>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(e,t){if((0,V.Z)(t)){if(t>=0&&t<this.frozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.frozenRowCount>0&&t>=0&&t<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(e,t){if((0,V.Z)(t)){if(t>=this.rowCount-this.bottomFrozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.bottomFrozenRowCount>0&&t>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=0&&t<this.frozenRowCount}isLeftBottomCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=0&&t<this.frozenRowCount}isRightBottomCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}isCornerHeader(e,t){return!1}getColumnHeaderRange(){var e,t;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:(null!=(e=this.rowCount)?e:0)-1}}:{start:{col:0,row:0},end:{col:(null!=(t=this.colCount)?t:0)-1,row:this._headerCellIds.length-1}}}getRowHeaderRange(){var e,t;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:(null!=(e=this.rowCount)?e:0)-1}}:{start:{col:0,row:0},end:{col:(null!=(t=this.colCount)?t:0)-1,row:this._headerCellIds.length-1}}}getCornerHeaderRange(){}getBodyRange(){var e,t,r,o;return this.transpose?{start:{col:this.headerLevelCount,row:0},end:{col:(null!=(e=this.colCount)?e:0)-1,row:(null!=(t=this.rowCount)?t:0)-1}}:{start:{col:0,row:this.headerLevelCount},end:{col:(null!=(r=this.colCount)?r:0)-1,row:(null!=(o=this.rowCount)?o:0)-1}}}get headerLevelCount(){return this.showHeader?this._headerCellIds.length:0}get columnHeaderLevelCount(){return this.transpose?0:this.headerLevelCount}get rowHeaderLevelCount(){return this.transpose?this.headerLevelCount:0}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get bottomFrozenRowCount(){return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0}get rightFrozenColCount(){return this._table.internalProps.rightFrozenColCount?this.colCount-this.frozenColCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:Math.max(0,this.colCount-this.frozenColCount):0}get colCount(){return this.transpose?this.headerLevelCount+this.recordsCount+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount:this._columns.length+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount}get rowCount(){return this.transpose?this._columns.length:this.headerLevelCount+this.recordsCount}get bodyRowCount(){return this.transpose?this._columns.length:this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.transpose?this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount:this._columns.length}get recordsCount(){return this._recordsCount}set recordsCount(e){this._recordsCount=e}get headerObjects(){return this._headerObjects}get columnObjects(){return this._columns}get headerObjectsIncludeHided(){return this._headerObjectsIncludeHided}get columnWidths(){if(this.leftRowSeriesNumberColumnCount){let e=this.leftRowSeriesNumberColumn.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}));return e.push(...this._columns.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}))),e}return this._columns.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}))}getColumnWidthDefined(e){var t;if(e>=0){if(e<this.leftRowSeriesNumberColumnCount)return this.leftRowSeriesNumberColumn[e];if(this.transpose){let r,o,i=0;if(e>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount){let e;return this.columnObjects.forEach((t,n)=>{"number"==typeof t.width?i=Math.max(t.width,i):"auto"===t.width&&(e=!0),"number"==typeof t.minWidth&&(o=Math.max(t.minWidth,o)),"number"==typeof t.maxWidth&&(r=Math.max(t.maxWidth,r))}),{width:i=i>0?i:e?"auto":void 0,minWidth:o,maxWidth:r}}if(this.isRowHeader(e,0)){let r=Array.isArray(this._table.defaultHeaderColWidth)?null!=(t=this._table.defaultHeaderColWidth[e])?t:this._table.defaultColWidth:this._table.defaultHeaderColWidth;return"auto"===r?{width:"auto"}:{width:r}}}return this._columns[e-this.leftRowSeriesNumberColumnCount]}}getCellId(e,t){var r,o,i,n;return this.transpose?e>=this.headerLevelCount+this.leftRowSeriesNumberColumnCount?null==(r=this._columns[t])?void 0:r.id:this.isSeriesNumber(e,t)?t+"_series_number":null==(o=this._headerCellIds[e-this.leftRowSeriesNumberColumnCount])?void 0:o[t]:this.isSeriesNumber(e,t)?this.rowSeriesNumberColumn[e].id:this.headerLevelCount<=t?null==(i=this._columns[e-this.leftRowSeriesNumberColumnCount])?void 0:i.id:null==(n=this._headerCellIds[t])?void 0:n[e-this.leftRowSeriesNumberColumnCount]}getHeader(e,t){if(this.isSeriesNumberInHeader(e,t))return this.getSeriesNumberHeader(e,t);let r=this.getCellId(e,t);return this._headerObjectMap[r]}getHeaderField(e,t){var r,o,i;if(this.isSeriesNumberInHeader(e,t))return null==(r=this.getSeriesNumberHeader(e,t))?void 0:r.field;if(this.isSeriesNumberInBody(e,t))return null==(o=this.getSeriesNumberBody(e,t))?void 0:o.field;let n=this.getCellId(e,t);return(null==(i=this._headerObjectMap[n])?void 0:i.field)||(this.transpose?this._columns[t]&&this._columns[t].field:this._columns[e-this.leftRowSeriesNumberColumnCount]&&this._columns[e-this.leftRowSeriesNumberColumnCount].field)}getHeaderCellAdressById(e){for(let t=0;t<this._headerCellIds.length;t++){let r=this._headerCellIds[t];for(let o=0;o<r.length;o++)if(r[o]===e)return this.transpose?{col:t,row:o}:{col:o+this.leftRowSeriesNumberColumnCount,row:t}}}getHeaderCellAddressByField(e){let t=this.headerObjects.find(t=>t&&t.field===e);return t&&this.getHeaderCellAdressById(t.id)}getBody(e,t){return this.isSeriesNumber(e,t)?this.getSeriesNumberBody(e,t):this.transpose?this._columns[t]:this._columns[e-this.leftRowSeriesNumberColumnCount]}getBodyLayoutRangeById(e){var t,r;if(this.transpose){for(let r=0;r<(null!=(t=this.rowCount)?t:0);r++)if(e===this._columns[r].id)return{start:{col:0,row:r},end:{col:0,row:r}}}else for(let t=this.leftRowSeriesNumberColumnCount;t<(null!=(r=this.colCount)?r:0);t++)if(e===this._columns[t-this.leftRowSeriesNumberColumnCount].id)return{start:{col:t,row:0},end:{col:t,row:0}};return{start:{col:-1,row:-1},end:{col:-1,row:-1}}}getCellRange(e,t){return function(e,t,r){var o,i,n;if(-1===e||-1===t)return{start:{col:e,row:t},end:{col:e,row:t}};if(r._cellRangeMap.has(`$${e}$${t}`))return r._cellRangeMap.get(`$${e}$${t}`);let l={start:{col:e,row:t},end:{col:e,row:t}};if(r.transpose)l=function(e,t,r){var o,i,n,l;let s={start:{col:e,row:t},end:{col:e,row:t}};if(r.headerLevelCount+r.leftRowSeriesNumberColumnCount<=e||-1===e&&-1===t){if(r.headerLevelCount+r.leftRowSeriesNumberColumnCount<=e&&(null==(i=null==(o=r.columnObjects[t])?void 0:o.define)?void 0:i.mergeCell)){let o=r._table.getCellValue(e,t);for(let i=e-1;i>=r.headerLevelCount+r.leftRowSeriesNumberColumnCount;i--){let n=r._table.getCellValue(i,t);if("boolean"==typeof r.columnObjects[t].define.mergeCell){if(o!==n)break}else if(!r.columnObjects[t].define.mergeCell(o,n,{source:{col:e,row:t},target:{col:i,row:t},table:r._table}))break;s.start.col=i}for(let i=e+1;i<(null!=(n=r.colCount)?n:0);i++){let n=r._table.getCellValue(i,t);if("boolean"==typeof r.columnObjects[t].define.mergeCell){if(o!==n)break}else if(!r.columnObjects[t].define.mergeCell(o,n,{source:{col:e,row:t},target:{col:i,row:t},table:r._table}))break;s.end.col=i}}return s}let a=r.getCellId(e,t);for(let o=t-1;o>=0&&a===r.getCellId(e,o);o--)s.start.row=o;for(let o=t+1;o<(null!=(l=r.rowCount)?l:0)&&a===r.getCellId(e,o);o++)s.end.row=o;for(let o=e-1;o>=0&&a===r.getCellId(o,t);o--)s.start.col=o;for(let o=e+1;o<r.headerLevelCount+r.leftRowSeriesNumberColumnCount&&a===r.getCellId(o,t);o++)s.end.col=o;return s}(e,t,r);else if(r.headerLevelCount<=t){if(r.headerLevelCount<=t&&(null==(i=null==(o=r.columnObjects[e-r.leftRowSeriesNumberColumnCount])?void 0:o.define)?void 0:i.mergeCell)){let o=r._table.getCellValue(e,t);for(let i=t-1;i>=r.headerLevelCount;i--){let n=r._table.getCellValue(e,i);if("boolean"==typeof r.columnObjects[e-r.leftRowSeriesNumberColumnCount].define.mergeCell){if(o!==n)break}else if(!r.columnObjects[e-r.leftRowSeriesNumberColumnCount].define.mergeCell(o,n,{source:{col:e,row:t},target:{col:e,row:i},table:r._table}))break;l.start.row=i}for(let i=t+1;i<r.rowCount;i++){let n=r._table.getCellValue(e,i);if("boolean"==typeof r.columnObjects[e-r.leftRowSeriesNumberColumnCount].define.mergeCell){if(o!==n)break}else if(!r.columnObjects[e-r.leftRowSeriesNumberColumnCount].define.mergeCell(o,n,{source:{col:e,row:t},target:{col:e,row:i},table:r._table}))break;l.end.row=i}}!function(e,t,r,o){if("tree"!==o.rowHierarchyType)return;let i=o._table.getCellRawRecord(e,t);o._table.internalProps.groupTitleCheckbox&&o._table.internalProps.rowSeriesNumber?(null==i?void 0:i.vtableMerge)&&e>=o.leftRowSeriesNumberColumnCount&&(r.start.col=o.rowHeaderLevelCount+o.leftRowSeriesNumberColumnCount,r.end.col=o.colCount-1,r.start.row=r.end.row=t):(null==i?void 0:i.vtableMerge)&&(r.start.col=o.rowHeaderLevelCount,r.end.col=o.colCount-1,r.start.row=r.end.row=t)}(e,t,l,r)}else{let o=r.getCellId(e,t);for(let i=e-1;i>=0&&o===r.getCellId(i,t);i--)l.start.col=i;for(let i=e+1;i<(null!=(n=r.colCount)?n:0)&&o===r.getCellId(i,t);i++)l.end.col=i;for(let i=t-1;i>=0&&o===r.getCellId(e,i);i--)l.start.row=i;for(let i=t+1;i<r.headerLevelCount&&o===r.getCellId(e,i);i++)l.end.row=i}return r._cellRangeMap.set(`$${e}$${t}`,l),l}(e,t,this)}isCellRangeEqual(e,t,r,o){let i=this.getCellRange(e,t),n=this.getCellRange(r,o);return i.start.col===n.start.col&&i.end.col===n.end.col&&i.start.row===n.start.row&&i.end.row===n.end.row}getRecordShowIndexByCell(e,t){let r=this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount;return this.transpose?e<r?-1:e-r:t<r?-1:t-r}getRecordStartRowByRecordIndex(e){return(this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount)+e}_calculateMaxDepth(e,t=0){let r=t;return e.forEach(e=>{if(e.columns&&e.columns.length>0){let o=this._calculateMaxDepth(e.columns,t+1);o>r&&(r=o)}}),r}_addHeaders(e,t,r,o,i){let n=[],l=this._newRow(e,o);return t.forEach(t=>{var s,a,u,h;let d=this._columns.length,c=this.seqId++,p={id:c,title:null!=(s=t.title)?s:t.caption,headerIcon:t.headerIcon,field:t.field,style:t.headerStyle,headerType:null!=(a=t.headerType)?a:"text",dropDownMenu:t.dropDownMenu,define:t,hierarchyState:t.hierarchyState,columnWidthComputeMode:t.columnWidthComputeMode};n[c]=p;let g=e;if(t.levelSpan){g=Math.min(e+t.levelSpan-1,this._columnMaxDepth-1);for(let t=e;t<=g;t++)this._headerCellIds[t]||(this._headerCellIds[t]=[]),void 0===this._headerCellIds[t][d]&&(this._headerCellIds[t][d]=c)}if(i)for(let e=g-1;e>=0;e--)this._headerCellIds[e]&&void 0===this._headerCellIds[e][d]&&void 0!==r[g-i]&&(this._headerCellIds[e][d]=r[g-i]);else for(let e=g-1;e>=0;e--)this._headerCellIds[e]&&void 0===this._headerCellIds[e][d]&&void 0!==r[e]&&(this._headerCellIds[e][d]=r[e]);o?this._headerCellIds[e-1]&&void 0!==this._headerCellIds[e-1][d]&&(l[d]=this._headerCellIds[e-1][d]):l[d]=c;let C=!t.hierarchyState||t.hierarchyState===T.g.expand;if(t.columns&&C)t.columns.every(e=>e.hide)||this._addHeaders(g+1,t.columns,[...r,c],t.hideColumnsSubHeader||o,t.levelSpan).forEach(e=>n.push(e));else{let r={id:this.seqId++,field:t.field,fieldFormat:t.fieldFormat,width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth,icon:t.icon,cellType:null!=(h=null!=(u=t.cellType)?u:t.columnType)?h:"text",chartModule:"chartModule"in t?t.chartModule:null,chartSpec:"chartSpec"in t?t.chartSpec:null,sparklineSpec:"sparklineSpec"in t?t.sparklineSpec:K.hW,style:t.style,define:t,columnWidthComputeMode:t.columnWidthComputeMode,disableColumnResize:null==t?void 0:t.disableColumnResize,aggregation:t.aggregation,isChildNode:e>=1};if(this._columnsIncludeHided.push(r),!0!==t.hide){this._columns.push(r);for(let t=e+1;t<this._headerCellIds.length;t++)this._headerCellIds[t][d]=c}}}),n}_newRow(e,t=!1){if(this._headerCellIds[e]){let t=this._headerCellIds[e-1];if(t.length>this._headerCellIds[e].length)for(let r=this._headerCellIds[e].length;r<t.length;r++)this._headerCellIds[e][r]=t[r];return this._headerCellIds[e]}if(t)return[];let r=this._headerCellIds[e]=[];if(!this._columns.length)return r;let o=this._headerCellIds[e-1];for(let e=0;e<o.length;e++)r[e]=o[e];return r}getCellHeaderPaths(e,t){if(this.isSeriesNumber(e,t))return;let r=[],o=[];return this.transpose?o=[{field:this._columns[t].field}]:r=[{field:this._columns[e-this.leftRowSeriesNumberColumnCount].field}],{colHeaderPaths:r,rowHeaderPaths:o,cellLocation:this.getCellLocation(e,t)}}getParentCellId(e,t){if(0!==t){if(this.isColumnHeader(e,t))return this.getCellId(e,t-1);if(this.isRowHeader(e,t)){if(this.isSeriesNumberInBody(e-1,t))return;return this.getCellId(e-1,t)}}}canMoveHeaderPosition(e,t){if(this.isSeriesNumberInHeader(t.col,t.row)||this.isSeriesNumberInHeader(e.col,e.row))return!1;if(!this.transpose&&this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)){let r=this.getRecordShowIndexByCell(0,e.row),o=this.getRecordShowIndexByCell(0,t.row);return this._table.dataSource.canChangeOrder(r,o)}if(this.transpose&&this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)&&(this.getBody(e.col+this.leftRowSeriesNumberColumnCount,e.row).isChildNode&&this.getBody(t.col+this.leftRowSeriesNumberColumnCount,t.row).isChildNode?(e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1):(e.col=e.col+this.leftRowSeriesNumberColumnCount,t.col=t.col+this.leftRowSeriesNumberColumnCount)),e.col<0||e.row<0||t.col<0||t.row<0||"disabled"===this._table.internalProps.frozenColDragHeaderMode&&this._table.isFrozenColumn(t.col))return!1;let r=this.getCellRange(e.col,e.row);return this.isColumnHeader(e.col,e.row)?this.getParentCellId(e.col,r.start.row)===this.getParentCellId(t.col,r.start.row):!!this.isRowHeader(e.col,e.row)&&this.getParentCellId(r.start.col,e.row)===this.getParentCellId(r.start.col,t.row)}moveHeaderPosition(e,t){var r,o;if((!(null==(r=this._table.options.dragOrder)?void 0:r.validateDragOrderOnEnd)||(null==(o=this._table.options.dragOrder)?void 0:o.validateDragOrderOnEnd(e,t)))&&this.canMoveHeaderPosition(e,t)){let r=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row)){let o,i=r.end.col-r.start.col+1,n=this.getCellRange(t.col,r.start.row);if((o=t.col>=e.col?n.end.col-i+1:n.start.col)===r.start.col)return null;for(let e=0;e<this._headerCellIds.length;e++){let t=this._headerCellIds[e].splice(r.start.col-this.leftRowSeriesNumberColumnCount,i);t.unshift(o-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._headerCellIds[e],t)}let l=this._columns.splice(r.start.col-this.leftRowSeriesNumberColumnCount,i);return l.unshift(o-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columns,l),this.columnTree.movePosition(r.start.row,r.start.col-this.leftRowSeriesNumberColumnCount,o-this.leftRowSeriesNumberColumnCount),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:r.start.col,targetIndex:o,sourceSize:i,targetSize:n.end.col-n.start.col+1,moveType:"column"}}if(this.isRowHeader(e.col,e.row)||this.isSeriesNumberInBody(e.col,e.row)&&this.transpose){let o;this.isSeriesNumberInBody(e.col,e.row)&&(r=this.getCellRange(e.col+this.leftRowSeriesNumberColumnCount,e.row));let i=r.end.row-r.start.row+1,n=this.getCellRange(r.start.col,t.row);if((o=t.row>=e.row?n.end.row-i+1:n.start.row)===r.start.row)return null;for(let e=0;e<this._headerCellIds.length;e++){let t=this._headerCellIds[e].splice(r.start.row,i);t.unshift(o,0),Array.prototype.splice.apply(this._headerCellIds[e],t)}let l=this._columns.splice(r.start.row,i);return l.unshift(o,0),Array.prototype.splice.apply(this._columns,l),this.columnTree.movePosition(r.start.col-this.leftRowSeriesNumberColumnCount,r.start.row,o+(t.row>e.row?r.end.row-r.start.row:0)),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:r.start.row,targetIndex:o,sourceSize:i,targetSize:n.end.row-n.start.row+1,moveType:"row"}}if(this.isSeriesNumberInBody(e.col,e.row))return{sourceIndex:e.row,targetIndex:t.row,sourceSize:1,targetSize:1,moveType:"row"}}return null}toggleHierarchyState(e){return{addCellPositions:e.add.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e})),removeCellPositions:e.remove.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e}))}}setChartInstance(e,t,r){let o=this.transpose?this._columns[t]:this._columns[e-this.leftRowSeriesNumberColumnCount];"function"!=typeof o.chartSpec&&(o.chartInstance=r)}getChartInstance(e,t){return(this.transpose?this._columns[t]:this._columns[e-this.leftRowSeriesNumberColumnCount]).chartInstance}checkHasChart(){return(0,j.YL)(this)}getAxisConfigInPivotChart(e,t){}isEmpty(e,t){return!1}isAxisCell(e,t){return!1}getChartAxes(e,t){return[]}isShareChartSpec(e,t){let r=this.getBody(e,t);return"function"!=typeof(null==r?void 0:r.chartSpec)}isNoChartDataRenderNothing(e,t){let r=this.getBody(e,t);return(null==r?void 0:r.define).noDataRenderNothing}getChartSpec(e,t){return this.getRawChartSpec(e,t)}getRawChartSpec(e,t){let r=this.getBody(e,t),o=null==r?void 0:r.chartSpec;return"function"==typeof o?o({col:e,row:t,dataValue:this._table.getCellOriginValue(e,t)||"",value:this._table.getCellValue(e,t)||"",rect:this._table.getCellRangeRelativeRect(this._table.getCellRange(e,t)),table:this._table}):o}getChartDataId(e,t){return(0,j.py)(e,t,this)}release(){let e=this._table._getActiveChartInstance();null==e||e.release(),this.columnObjects.forEach(e=>{var t;null==(t=e.chartInstance)||t.release()})}clearCellRangeMap(){this._cellRangeMap.clear()}updateColumnTitle(e,t,r){let o=this._table.internalProps.layoutMap.getHeader(e,t);o.title=r,o.define.title=r}getColumnByField(e){var t;return null==(t=this.columnObjects)?void 0:t.reduce((t,r,o)=>(r.field===e&&t.push({col:o,columnDefine:r}),t),[])}getColumnByKey(e){var t;let r;return{columnDefine:null==(t=this.columnObjects)?void 0:t.find((t,o)=>{var i;return(null==(i=t.define)?void 0:i.key)===e&&(r=o+this.leftRowSeriesNumberColumnCount,!0)}),col:r}}getColumnDefine(e,t){if(e>=0)return e<this.leftRowSeriesNumberColumnCount?this.leftRowSeriesNumberColumn[e].define:this.transpose?this._columns[t].define:this._columns[e-this.leftRowSeriesNumberColumnCount].define}}var G=r(43735),$=r(50071),q=r(83847),J=r(27180),Y=r(62482),U=r(63388),Q=r(77597);class X{constructor(e){this.isValidatingValue=!1,this.listenersId=[],this.table=e,this.bindEvent()}bindEvent(){let e=this.table,t=e.on(q.B.DBLCLICK_CELL,t=>{var r,o,i;let{editCellTrigger:n="doubleclick"}=e.options;if(!n.includes("doubleclick"))return;let{col:l,row:s}=t,a=(0,U.RJ)(t.federatedEvent),u=e.scenegraph.getResizeColAt(a.abstractPos.x,a.abstractPos.y,null==(r=a.eventArgs)?void 0:r.targetCell);e._canResizeColumn(u.col,u.row)&&u.col>=0||(null==(i=null==(o=t.target)?void 0:o.attribute)?void 0:i.funcType)||(this.beginTriggerEditCellMode="doubleclick",this.startEditCell(l,s))}),r=e.on(q.B.CLICK_CELL,t=>{var r,o;let{editCellTrigger:i="doubleclick"}=e.options;if("click"===i||Array.isArray(i)&&i.includes("click")){if(null==(o=null==(r=t.target)?void 0:r.attribute)?void 0:o.funcType)return;this.beginTriggerEditCellMode="click";let{col:e,row:i}=t;this.startEditCell(e,i)}});this.listenersId.push(t,r)}startEditCell(e,t,r){var o,i,n,l,s,a,u,h,d;if(this.editingEditor)return;let c=this.table.getEditor(e,t);if(c){if(null==(i=null==(o=this.table.internalProps.layoutMap)?void 0:o.isAggregation)?void 0:i.call(o,e,t)){let e=null==(l=(n=this.table).isPivotTable)?void 0:l.call(n),t=!!e&&(null==(a=null==(s=this.table.internalProps)?void 0:s.dataConfig)?void 0:a.updateAggregationOnEditCell);if(!e||e&&t)return}let p=this.table.getCellRawRecord(e,t);if(null==p?void 0:p.vtableMerge)return;this.editingEditor||(this.editCell={col:e,row:t}),this.table._makeVisibleCell(e,t),this.editingEditor=c;let g=(0,V.Z)(r)?r:this.table.getCellOriginValue(e,t),C=this.table.getCellRangeRelativeRect(this.table.getCellRange(e,t)),f={rect:{left:C.left,top:C.top,width:C.width,height:C.height}};e===this.table.colCount-1?f.rect.width=C.width-1:f.rect.width=C.width+1,t===this.table.rowCount-1?f.rect.height=C.height-1:f.rect.height=C.height+1,c.beginEditing,null==(u=c.beginEditing)||u.call(c,this.table.getElement(),f,g),c.bindSuccessCallback,null==(h=c.bindSuccessCallback)||h.call(c,()=>{this.completeEdit()}),null==(d=c.onStart)||d.call(c,{value:g,endEdit:()=>{this.completeEdit()},referencePosition:f,container:this.table.getElement(),col:e,row:t,table:this.table})}}completeEdit(e){var t,r;if(!this.editingEditor)return!0;if(this.isValidatingValue)return!1;let o=null==e?void 0:e.target,{editingEditor:i}=this;if(o){if(i.targetIsOnEditor){if(i.targetIsOnEditor(o))return!1}else if(!i.isEditorElement||i.isEditorElement(o))return!1}if(this.editingEditor.getValue,this.editingEditor.validateValue){this.isValidatingValue=!0;let e=this.editingEditor.getValue(),o=this.table.getCellOriginValue(this.editCell.col,this.editCell.row),i=null==(r=(t=this.editingEditor).validateValue)?void 0:r.call(t,e,o,this.editCell,this.table);return(0,Q.tI)(i)?(this.isValidatingValue=!0,new Promise((e,t)=>{i.then(t=>{ee(t,this,o,e)}).catch(e=>{this.isValidatingValue=!1,t(e)})})):ee(i,this,o)}return this.doExit(),!0}doExit(){var e,t,r,o,i,n;let l=null==(t=(e=this.editingEditor).getValue)?void 0:t.call(e),s=this.table.getCellRange(this.editCell.col,this.editCell.row),a=[];for(let e=s.start.row;e<=s.end.row;e++){let e=[];for(let t=s.start.col;t<=s.end.col;t++)e.push(l);a.push(e)}this.table.changeCellValues(s.start.col,s.start.row,a),this.editingEditor.exit,null==(o=(r=this.editingEditor).exit)||o.call(r),null==(n=(i=this.editingEditor).onEnd)||n.call(i),this.editingEditor=null,this.isValidatingValue=!1,this.beginTriggerEditCellMode=null}cancelEdit(){var e,t,r,o;this.editingEditor&&(null==(t=(e=this.editingEditor).exit)||t.call(e),null==(o=(r=this.editingEditor).onEnd)||o.call(r),this.editingEditor=null)}release(){this.listenersId.forEach(e=>{this.table.off(e)})}}function ee(e,t,r,o){return t.isValidatingValue=!1,"validate-exit"===e?(t.doExit(),null==o||o(!0),!0):"invalidate-exit"===e?(t.editingEditor.setValue(r),t.doExit(),null==o||o(!0),!0):"validate-not-exit"===e||"invalidate-not-exit"===e?(null==o||o(!1),!1):!0===e?(t.doExit(),null==o||o(!0),!0):(null==o||o(!1),!1)}var et=r(9649),er=r(28071),eo=r(45847),ei=r(70656),en=r(65962),el=r(75025),es=r(58853);function ea(e){return(0,es.Z)(e)?{groupByRules:[e]}:(0,G.Z)(e)?{groupByRules:e.map(e=>(0,es.Z)(e)?e:e.key)}:{}}var eu=r(78958);function eh(e){let t=e.sortState;(t=!t||Array.isArray(t)?t:[t])&&(t=t.map(t=>{var r;return t.orderFn=null!=(r=e._getSortFuncFromHeaderOption(void 0,t.field))?r:er.K$,t}),e.dataSource.sort(t))}var ed=r(62727);class ec extends x.D{constructor(e,t){var r,o,i,n,l,s,a,u;super(e,t),this.showHeader=!0,t=this.options;let h=this.internalProps;if(h.frozenColDragHeaderMode=null!=(o=null==(r=t.dragOrder)?void 0:r.frozenColDragHeaderMode)?o:t.frozenColDragHeaderMode,this.pagination=t.pagination,h.sortState=t.sortState,h.multipleSort=!!t.multipleSort,h.dataConfig=this.internalProps.groupBy?ea(this.internalProps.groupBy):{},h.columns=t.columns?(0,ei.u)(t.columns,["children"]):t.header?(0,ei.u)(t.header,["children"]):[],(0,$.rQ)(this),h.enableTreeNodeMerge=null!=(n=null!=(i=t.enableTreeNodeMerge)?i:(0,V.Z)(this.internalProps.groupBy))&&n,this.internalProps.headerHelper.setTableColumnsEditor(),this.showHeader=null==(l=t.showHeader)||l,this.internalProps.columnWidthConfig=t.columnWidthConfig,this.transpose=null!=(s=t.transpose)&&s,"node"!==J.X.mode&&(this.editorManager=new X(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,t.dataSource?this.dataSource=t.dataSource:t.records?this.setRecords(t.records,{sortState:h.sortState}):this.setRecords([]),t.title&&(h.title=new(el.F.getComponent("title"))(t.title,this),this.scenegraph.resize()),this.options.emptyTip)if(this.internalProps.emptyTip)null==(a=this.internalProps.emptyTip)||a.resetVisible();else{let e=el.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(u=this.internalProps.emptyTip)||u.resetVisible()}if(this.internalProps.enableTreeStickCell){let e=el.F.getComponent("listTreeStickCellPlugin");this.listTreeStickCellPlugin=new e(this)}setTimeout(()=>{this.fireListeners(q.B.INITIALIZED,null)},0)}isListTable(){return!0}isPivotTable(){return!1}isPivotChart(){return!1}get sortState(){return this.internalProps.sortState}get records(){var e;return null==(e=this.dataSource)?void 0:e.records}get recordsCount(){return this.dataSource.records.length}updateColumns(e,t){var r,o,i,n;this.scenegraph.clearCells();let l={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.columns=(0,ei.u)(e,["children"]),(0,$.rQ)(this),(null==t?void 0:t.clearColWidthCache)&&this.internalProps._widthResizedColMap.clear(),this.options.columns=e,this.internalProps.headerHelper.setTableColumnsEditor(),this._hasAutoImageColumn=void 0,this.refreshHeader(),null==(o=(r=this.dataSource).updateColumns)||o.call(r,this.internalProps.columns),this.records&&(0,$.bW)(this.internalProps.columns)&&this.dataSource.processRecords(null!=(n=null==(i=this.dataSource.dataSourceObj)?void 0:i.records)?n:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(l.col,l.row),this.renderAsync(),this.eventManager.updateEventBinder()}_recreateSceneForStateChange(){var e,t;this.scenegraph.clearCells();let r={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this._hasAutoImageColumn=void 0,this.refreshHeader(),this.records&&(0,$.bW)(this.internalProps.columns)&&this.dataSource.processRecords(null!=(t=null==(e=this.dataSource.dataSourceObj)?void 0:e.records)?t:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(r.col,r.row),this.renderAsync(),this.eventManager.updateEventBinder()}addColumn(e){let t=this.options.columns;t.push(e),this.updateColumns(t)}get columns(){return this.internalProps.layoutMap.columnTree.getCopiedTree()}get header(){return this.internalProps.columns}set header(e){this.internalProps.columns=e,(0,$.rQ)(this),this.options.header=e,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.renderAsync()}get transpose(){var e;return null!=(e=this.internalProps.transpose)&&e}set transpose(e){this.internalProps.transpose!==e&&(this.internalProps.transpose=e,this.internalProps.layoutMap&&(this.internalProps.layoutMap.transpose=e,this.refreshRowColCount(),this._resetFrozenColCount(),this.renderAsync()))}getCellValue(e,t,r){var o;if(-1===e||-1===t)return null;if(!r){let r=this.getCustomMergeValue(e,t);if(r)return r}if(this.internalProps.layoutMap.isSeriesNumber(e,t)){let r;if(this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)){let{title:r}=this.internalProps.layoutMap.getSeriesNumberHeader(e,t);return r}if(this.internalProps.groupBy){let o=this.getCellRawRecord(e,t);if(null==o?void 0:o.vtableMerge)return"";this.internalProps.layoutMap.isAggregation(e,t)||(r=this.dataSource.getGroupSeriesNumber(t-this.columnHeaderLevelCount))}else{let i=this.getBodyColumnDefine(e,t),n=this.getFieldData(i.field,e,t);r="string"==typeof n?n:(null==n?void 0:n.text)?null!=(o=n.text)?o:"":t-this.columnHeaderLevelCount+1}let{format:i}=this.internalProps.layoutMap.getSeriesNumberBody(e,t);return"function"==typeof i?i(e,t,this,r):r}if(this.internalProps.layoutMap.isHeader(e,t)){let{title:r}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof r?r():r}if(this.internalProps.layoutMap.isAggregation(e,t)){if(this.internalProps.layoutMap.isTopAggregation(e,t)){let r=this.internalProps.layoutMap.getAggregatorOnTop(e,t);return(null==r?void 0:r.formatValue)?r.formatValue(e,t,this):""}if(this.internalProps.layoutMap.isBottomAggregation(e,t)){let r=this.internalProps.layoutMap.getAggregatorOnBottom(e,t);return(null==r?void 0:r.formatValue)?r.formatValue(e,t,this):""}}let{field:i,fieldFormat:n}=this.internalProps.layoutMap.getBody(e,t);return this.getFieldData(n||i,e,t)}getCellOriginValue(e,t){if(-1===e||-1===t)return null;if(this.internalProps.layoutMap.isSeriesNumber(e,t)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)){let{title:r}=this.internalProps.layoutMap.getSeriesNumberHeader(e,t);return r}let{format:r}=this.internalProps.layoutMap.getSeriesNumberBody(e,t);return"function"==typeof r?r(e,t,this):t-this.columnHeaderLevelCount}if(this.internalProps.layoutMap.isHeader(e,t)){let{title:r}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof r?r():r}if(this.internalProps.layoutMap.isAggregation(e,t)){if(this.internalProps.layoutMap.isTopAggregation(e,t)){let r=this.internalProps.layoutMap.getAggregatorOnTop(e,t);return null==r?void 0:r.value()}if(this.internalProps.layoutMap.isBottomAggregation(e,t)){let r=this.internalProps.layoutMap.getAggregatorOnBottom(e,t);return null==r?void 0:r.value()}}let{field:r}=this.internalProps.layoutMap.getBody(e,t);return this.getFieldData(r,e,t)}getCellRawValue(e,t){if(-1===e||-1===t)return null;if(this.internalProps.layoutMap.isHeader(e,t)){let{title:r}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof r?r():r}let{field:r}=this.internalProps.layoutMap.getBody(e,t);return this.getRawFieldData(r,e,t)}getRecordShowIndexByCell(e,t){let{layoutMap:r}=this.internalProps;return r.getRecordShowIndexByCell(e,t)}getRecordIndexByCell(e,t){let{layoutMap:r}=this.internalProps,o=r.getRecordShowIndexByCell(e,t);return this.dataSource.getRecordIndexPaths(o)}getTableIndexByRecordIndex(e){return this.transpose?this.dataSource.getTableIndex(e)+this.rowHeaderLevelCount:this.dataSource.getTableIndex(e)+this.columnHeaderLevelCount}getTableIndexByField(e){let t=this.internalProps.layoutMap.columnObjects.find(t=>t.field===e);if(!t)return -1;let r=this.internalProps.layoutMap.getBodyLayoutRangeById(t.id);return this.transpose?r.start.row:r.start.col}getCellAddrByFieldRecord(e,t){return this.transpose?{col:this.getTableIndexByRecordIndex(t),row:this.getTableIndexByField(e)}:{col:this.getTableIndexByField(e),row:this.getTableIndexByRecordIndex(t)}}getCellOriginRecord(e,t){let r=this.getRecordShowIndexByCell(e,t);if(r>-1)return this.dataSource.get(r)}getCellRawRecord(e,t){let r=this.getRecordShowIndexByCell(e,t);if(r>-1)return this.dataSource.getRaw(r)}_canResizeColumn(e,t){let r=super._canResizeColumn(e,t);if(r&&!this.transpose){let r=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount),o=this.internalProps.layoutMap.isSeriesNumber(e,t);if((null==r?void 0:r.disableColumnResize)||o&&!0===this.internalProps.rowSeriesNumber.disableColumnResize)return!1}return r}updateOption(e){var t,r,o,i,n,l,s,a,u;let h=this.internalProps;if(super.updateOption(e),h.frozenColDragHeaderMode=null!=(r=null==(t=e.dragOrder)?void 0:t.frozenColDragHeaderMode)?r:e.frozenColDragHeaderMode,this.pagination=e.pagination,h.sortState=e.sortState,h.dataConfig=this.internalProps.groupBy?ea(this.internalProps.groupBy):{},this.showHeader=null==(o=e.showHeader)||o,h.columns=e.columns?(0,ei.u)(e.columns,["children"]):e.header?(0,ei.u)(e.header,["children"]):[],(0,$.rQ)(this),h.enableTreeNodeMerge=null!=(n=null!=(i=e.enableTreeNodeMerge)?i:(0,V.Z)(this.internalProps.groupBy))&&n,this.internalProps.headerHelper.setTableColumnsEditor(),this.transpose=null!=(l=e.transpose)&&l,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.internalProps.columnWidthConfig=e.columnWidthConfig,h.releaseList)for(let e=h.releaseList.length-1;e>=0;e--){let t=h.releaseList[e];t instanceof _.o2?t.updateColumns(this.internalProps.columns):(null==(s=null==t?void 0:t.release)||s.call(t),h.releaseList.splice(e,1))}if(e.dataSource&&this.dataSource!==e.dataSource?this.dataSource=e.dataSource:e.records?this.setRecords(e.records,{sortState:e.sortState}):(this.refreshRowColCount(),this._resetFrozenColCount(),this.scenegraph.createSceneGraph(),this.render()),e.title&&(h.title=new(el.F.getComponent("title"))(e.title,this),this.scenegraph.resize()),this.options.emptyTip)if(this.internalProps.emptyTip)null==(a=this.internalProps.emptyTip)||a.resetVisible();else{let e=el.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(u=this.internalProps.emptyTip)||u.resetVisible()}return this.pluginManager.updatePlugins(e.plugins),new Promise(e=>{setTimeout(e,0)})}updatePagination(e){this.pagination&&("number"==typeof e.currentPage&&e.currentPage>=0&&(this.pagination.currentPage=e.currentPage),e.perPageCount&&(this.pagination.perPageCount=e.perPageCount||this.pagination.perPageCount),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.dataSource.updatePagination(this.pagination),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.renderAsync())}refreshHeader(){var e;let t=this.internalProps,r=this.transpose,o=this.showHeader;(t.layoutMap=new Z(this,null!=(e=t.columns)?e:[],o,this.options.hierarchyIndent)).transpose=r,r||this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,r,o,i,n,l,s,a,u,h,d,c,p,g,C,f,m;let{layoutMap:y}=this.internalProps;if(!y)return;let w=null!=(t=null==(e=this.internalProps.dataSource)?void 0:e.length)?t:0;y.recordsCount=w+(w>0||this.options.showAggregationWhenEmpty?y.hasAggregationOnTopCount+y.hasAggregationOnBottomCount:0),this.transpose?(this.rowCount=null!=(r=y.rowCount)?r:0,this.colCount=null!=(o=y.colCount)?o:0,this.internalProps.frozenColCount=Math.max((null!=(i=y.headerLevelCount)?i:0)+y.leftRowSeriesNumberColumnCount,null!=(n=this.options.frozenColCount)?n:0),this.internalProps.frozenRowCount=null!=(l=this.options.frozenRowCount)?l:0,this.bottomFrozenRowCount!==(null!=(s=this.options.bottomFrozenRowCount)?s:0)&&(this.bottomFrozenRowCount=null!=(a=this.options.bottomFrozenRowCount)?a:0),this.rightFrozenColCount!==(null!=(u=this.options.rightFrozenColCount)?u:0)&&(this.rightFrozenColCount=null!=(h=this.options.rightFrozenColCount)?h:0)):(this.colCount=null!=(d=y.colCount)?d:0,this.rowCount=y.recordsCount*y.bodyRowSpanCount+y.headerLevelCount,this.internalProps.frozenColCount=null!=(c=this.options.frozenColCount)?c:0,this.frozenRowCount=Math.max(y.headerLevelCount,null!=(p=this.options.frozenRowCount)?p:0),this.bottomFrozenRowCount!==(null!=(g=this.options.bottomFrozenRowCount)?g:0)&&(this.bottomFrozenRowCount=null!=(C=this.options.bottomFrozenRowCount)?C:0),this.rightFrozenColCount!==(null!=(f=this.options.rightFrozenColCount)?f:0)&&(this.rightFrozenColCount=null!=(m=this.options.rightFrozenColCount)?m:0)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}getFieldData(e,t,r){if(null===e||this.internalProps.layoutMap.isHeader(t,r))return null;let o=this.getRecordShowIndexByCell(this.transpose?t-this.internalProps.layoutMap.leftRowSeriesNumberColumnCount:t,r);return this.internalProps.dataSource.getField(o,e,t,r,this)}getRawFieldData(e,t,r){if(null===e||this.internalProps.layoutMap.isHeader(t,r))return null;let o=this.getRecordShowIndexByCell(t,r);return this.internalProps.dataSource.getRawField(o,e,t,r,this)}_moveHeaderPosition(e,t){let r=this.getCellRange(e.col,e.row),o=this.getCellRange(t.col,t.row),i=this.internalProps.layoutMap.moveHeaderPosition(e,t);return i?("column"===i.moveType?(this.colWidthsMap.exchangeOrder(r.start.col,r.end.col-r.start.col+1,o.start.col,o.end.col-o.start.col+1,i.targetIndex),this.transpose||(this.colWidthsLimit={},this.setMinMaxLimitWidth())):i.targetIndex>i.sourceIndex?this.rowHeightsMap.exchangeOrder(i.sourceIndex,i.sourceSize,i.targetIndex+i.sourceSize-i.targetSize,i.targetSize,i.targetIndex):this.rowHeightsMap.exchangeOrder(i.sourceIndex,i.sourceSize,i.targetIndex,i.targetSize,i.targetIndex),i):null}changeRecordOrder(e,t){this.transpose?(e=this.getRecordShowIndexByCell(e,0),t=this.getRecordShowIndexByCell(t,0)):(e=this.getRecordShowIndexByCell(0,e),t=this.getRecordShowIndexByCell(0,t)),this.dataSource.changeOrder(e,t)}getCellAddress(e,t){let r;for(let t=0;t<this.internalProps.records.length;t++){let o=this.internalProps.records[t];if("function"==typeof e)e(o)&&(r=t);else{let i=!0;for(let t in e)if(o[t]!==e[t]){i=!1;break}i&&(r=t)}if((0,V.Z)(r))break}let o=this.getCellRangeByField(t,r);if(o)return{row:o.start.row,col:o.start.col}}getCellRangeByField(e,t){let{layoutMap:r}=this.internalProps,o=r.columnObjects.find(t=>t.field===e);if(o){let e,i=r.getBodyLayoutRangeById(o.id);return(0,V.Z)(t)&&(e=r.getRecordStartRowByRecordIndex(t)),this.transpose?{start:{row:i.start.row,col:(0,V.Z)(e)?e+i.start.col:void 0},end:{row:i.end.row,col:(0,V.Z)(e)?e+i.end.col:void 0}}:{start:{col:i.start.col,row:(0,V.Z)(e)?e+i.start.row:void 0},end:{col:i.end.col,row:(0,V.Z)(e)?e+i.end.row:void 0}}}return null}getHierarchyState(e,t){var r;if(this.isHeader(e,t))return null==(r=this._getHeaderLayoutMap(e,t))?void 0:r.hierarchyState;if((!this.internalProps.groupBy||(0,G.Z)(this.internalProps.groupBy)&&0===this.internalProps.groupBy.length)&&!this.getBodyColumnDefine(e,t).tree)return T.g.none;let o=this.getRecordShowIndexByCell(e,t);return this.dataSource.getHierarchyState(o)}getRecordHierarchyState(e,t){let r;return this.transpose?this.getRecordShowIndexByCell(e,0):r=this.getRecordShowIndexByCell(0,t),this.dataSource.getHierarchyState(r)}toggleHierarchyState(e,t,r=!0){this.stateManager.updateHoverIcon(e,t,void 0,void 0);let o=this.getHierarchyState(e,t);if(this.isHeader(e,t)){let r=this.internalProps.layoutMap.getHeader(e,t),{hierarchyState:i,define:n}=r;if(![T.g.collapse,T.g.expand].includes(i)||!n)return;let l=n.columns;if(Array.isArray(l)&&l.length>0){let e=i===T.g.expand?T.g.collapse:T.g.expand;r.hierarchyState=e,r.define.hierarchyState=e,this.updateColumns(this.internalProps.columns)}this.fireListeners(q.B.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:o,originData:r,cellLocation:this.getCellLocation(e,t)})}else if(o===T.g.expand)this._refreshHierarchyState(e,t,r),this.fireListeners(q.B.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:T.g.collapse});else if(o===T.g.collapse){let o=this.getCellOriginRecord(e,t);Array.isArray(o.children)&&this._refreshHierarchyState(e,t,r),this.fireListeners(q.B.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:T.g.expand,originData:o})}}setLoadingHierarchyState(e,t){this.scenegraph.setLoadingHierarchyState(e,t)}_refreshHierarchyState(e,t,r=!0){var o,i;let n=!1,l=!1,s=this.internalProps.layoutMap.checkHasChart();s&&(this.autoFillWidth&&(n=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight));let a=this.getRecordShowIndexByCell(e,t),u=this.dataSource.toggleHierarchyState(a,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount,Math.max(this.scenegraph.proxy.rowEnd-this.columnHeaderLevelCount,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount+this.scenegraph.proxy.rowLimit-1)),h=this.internalProps.layoutMap.toggleHierarchyState(u);this.refreshRowColCount();for(let e=this.rowCount-this.bottomFrozenRowCount;e<this.rowCount;e++){let t=(0,et.P)(e,0,this.colCount-1,this);this._setRowHeight(e,t)}this.clearCellStyleCache(),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1;let{updateCells:d,addCells:c,removeCells:p}=function(e,t,r,o){let i=[{col:t,row:r}],n=[],l=[],{addCellPositions:s,removeCellPositions:a}=e,u=o.scenegraph.proxy,{rowStart:h,rowLimit:d}=u,{rowEnd:c}=u,p=1/0;for(let e=0;e<s.length;e++){let{row:r}=s[e];c-h+1===d?r>=h&&r<=c&&(p=Math.min(p,r)):(n.push({col:t,row:r}),c++)}let g=Math.min(h+d,o.rowCount-1-o.bottomFrozenRowCount),C=g<h+d;for(let e=0;e<a.length;e++){let{row:r}=a[a.length-e-1];r<h||r>c||(r>g||C?(l.push({col:t,row:r}),p--):p=Math.min(p,r))}if(p!==1/0)for(let e=p;e<=c;e++)i.push({col:t,row:e});return o.scenegraph.proxy.refreshRowCount(),{updateCells:i,addCells:n,removeCells:l}}(h,e,t,this);null==(o=this.reactCustomLayout)||o.clearCache(),this.scenegraph.updateRow(p,c,d,r,!0),null==(i=this.reactCustomLayout)||i.updateAllCustomCell(),s&&(this.autoFillWidth&&!n&&(n=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!l&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight),("adaptive"===this.widthMode||n||"adaptive"===this.heightMode||l)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}_hasHierarchyTreeHeader(){var e,t;return null==(t=null!=(e=this.options.columns)?e:this.options.header)?void 0:t.some((e,t)=>e.tree)}getMenuInfo(e,t,r){return{field:this.getHeaderField(e,t),value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),event:void 0}}_getSortFuncFromHeaderOption(e,t,r){if(e||(e=this.internalProps.columns),t&&e&&e.length>0)for(let o=0;o<e.length;o++){let i=e[o];if((r&&r===i.fieldKey||!r&&i.field===t)&&i.sort&&"function"==typeof i.sort)return i.sort;if(i.columns){let e=this._getSortFuncFromHeaderOption(i.columns,t,r);if(e)return e}}}updateSortState(e,t=!0){var r;if(e)this.internalProps.sortState=e;else if(this.internalProps.sortState)if(Array.isArray(this.internalProps.sortState))for(let t=0;t<this.internalProps.sortState.length;t++)(e=null==(r=this.internalProps.sortState)?void 0:r[t])&&(e.order="normal");else this.internalProps.sortState.order="normal",e=this.internalProps.sortState;(e=Array.isArray(e)?e:[e]).some(e=>e.field)&&t&&this.internalProps.layoutMap.headerObjects.some(e=>!1!==e.define.sort)&&(this.dataSource.sort(e.map(e=>{let t=this._getSortFuncFromHeaderOption(this.internalProps.columns,e.field);return this.internalProps.layoutMap.headerObjects.find(t=>t&&t.field===e.field),{field:e.field,order:e.order,orderFn:null!=t?t:er.K$}})),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.sortCell()),e.length&&this.stateManager.updateSortState(e)}updateFilterRules(e){this.scenegraph.clearCells(),this.sortState?(this.dataSource.updateFilterRulesForSorted(e),eh(this)):this.dataSource.updateFilterRules(e),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph()}getCheckboxState(e){if(this.stateManager.checkedState.size<this.rowCount-this.columnHeaderLevelCount&&this.stateManager.initLeftRecordsCheckState(this.records),(0,V.Z)(e)){let t=Array.from(this.stateManager.checkedState.keys()).sort((e,t)=>{var r,o;let i=e.split(","),n=t.split(","),l=Math.max(i.length,n.length);for(let e=0;e<l;e++){let t=null!=(r=Number(i[e]))?r:0,l=null!=(o=Number(n[e]))?o:0;if(t!==l)return t-l}return 0}).map(e=>this.stateManager.checkedState.get(e));return this.options.groupBy&&(t=(0,en.aC)(this)),Array.from(t,t=>t&&t[e])}return Array(...this.stateManager.checkedState.values())}getCellCheckboxState(e,t){var r;let o=this.getBodyColumnDefine(e,t),i=null==o?void 0:o.field,n=this.getCellType(e,t);if((0,V.Z)(i)&&("checkbox"===n||"switch"===n)){let o=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(e,t)).toString();return null==(r=this.stateManager.checkedState.get(o))?void 0:r[i]}}getRadioState(e){return(0,V.Z)(e)?this.stateManager.radioState[e]:this.stateManager.radioState}getCellRadioState(e,t){return(0,eo.Wg)(e,t,this)}setCellCheckboxState(e,t,r){(0,en.Jd)(e,t,r,this)}setCellRadioState(e,t,r){(0,eo.vj)(e,t,r,this)}getSwitchState(e){return this.getCheckboxState(e)}getCellSwitchState(e,t){return this.getCellCheckboxState(e,t)}setCellSwitchState(e,t,r){this.setCellCheckboxState(e,t,r)}setRecords(e,t){var r,o,i,n;let l;(0,ed.H6)(),null==(r=this.internalProps.dataSource)||r.release(),this.internalProps.releaseList=null==(o=this.internalProps.releaseList)?void 0:o.filter(e=>!e.dataSourceObj),this.internalProps.dataSource=null,Array.isArray(t)||(null==t?void 0:t.order)?l=t:t?l=t.sortState:null===t&&(l=null),"undefined"!=typeof window&&window.performance.now();let s={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};if(this.scenegraph.clearCells(),void 0!==l&&(null===l||!Array.isArray(l)&&(0,V.Z)(l.field)||Array.isArray(l))&&(this.internalProps.sortState=this.internalProps.multipleSort?Array.isArray(l)?l:[l]:l,this.stateManager.setSortState(this.sortState)),e){if((0,$.mP)(this,e),this.sortState){let e=Array.isArray(this.sortState)?this.sortState:[this.sortState];e.some(e=>e.order&&e.field&&"normal"!==e.order)&&this.internalProps.layoutMap.headerObjectsIncludeHided.some(e=>!1!==e.define.sort)&&this.dataSource.sort(e.map(e=>{let t=this._getSortFuncFromHeaderOption(void 0,e.field);return this.internalProps.layoutMap.headerObjectsIncludeHided.find(t=>t&&t.field===e.field),{field:e.field,order:e.order||"asc",orderFn:null!=t?t:er.K$}}))}this.refreshRowColCount()}else(0,$.mP)(this,e);if(this.stateManager.initCheckedState(e),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(s.col,s.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.options.emptyTip)if(this.internalProps.emptyTip)null==(i=this.internalProps.emptyTip)||i.resetVisible();else{let e=el.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(n=this.internalProps.emptyTip)||n.resetVisible()}this.render(),(0,V.Z)(s.col)&&(0,V.Z)(s.row)&&s.col>=0&&s.row>=0&&setTimeout(()=>{var e;null==(e=this.internalProps)||e.tooltipHandler.showTooltip(s.col,s.row)},0)}setRecordChildren(e,t,r,o=!0){let i=this.getCellOriginRecord(t,r);i.children=e;let n=this.getRecordShowIndexByCell(t,r);this.dataSource.setRecord(i,n),this._refreshHierarchyState(t,r,o)}startEditCell(e,t,r){var o;if((0,V.Z)(e)&&(0,V.Z)(t))this.eventManager.isDraging=!1,this.selectCell(e,t),this.editorManager.startEditCell(e,t,r);else if(null==(o=this.stateManager.select)?void 0:o.cellPos){let{col:e,row:t}=this.stateManager.select.cellPos;(0,V.Z)(e)&&(0,V.Z)(t)&&this.editorManager.startEditCell(e,t,r)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(e,t){var r,o;let i=this.getBodyColumnDefine(e,t),n=this.isHeader(e,t)?null!=(r=null==i?void 0:i.headerEditor)?r:this.options.headerEditor:null!=(o=null==i?void 0:i.editor)?o:this.options.editor;return"function"==typeof n&&(n=n({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),"string"==typeof n?Y.U(n):n}isHasEditorDefine(e,t){var r,o;let i=this.getBodyColumnDefine(e,t),n=this.isHeader(e,t)?null!=(r=null==i?void 0:i.headerEditor)?r:this.options.headerEditor:null!=(o=null==i?void 0:i.editor)?o:this.options.editor;return"function"==typeof n&&(n=n({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),(0,V.Z)(n)}changeCellValue(e,t,r,o=!1,i=!0){return function(e,t,r,o,i,n){if(o&&n.isHasEditorDefine(e,t)||!1===o){let o=n.getRecordShowIndexByCell(e,t),{field:l}=n.internalProps.layoutMap.getBody(e,t),s=n.getCellRawValue(e,t),a=n.getCellOriginValue(e,t);n.isHeader(e,t)?n.internalProps.layoutMap.updateColumnTitle(e,t,r):n.dataSource.changeFieldValue(r,o,l,e,t,n);let u=n.getCellRange(e,t),h=n.internalProps.layoutMap.getAggregatorsByCell(e,t);if(h){if(Array.isArray(h))for(let e=0;e<(null==h?void 0:h.length);e++)h[e].recalculate();else h.recalculate();let e=n.internalProps.layoutMap.getAggregatorCellAddress(u.start.col,u.start.row,u.end.col,u.end.row);for(let t=0;t<e.length;t++){let r=n.getCellRange(e[t].col,e[t].row);for(let e=r.start.col;e<=r.end.col;e++)for(let t=r.start.row;t<=r.end.row;t++)n.scenegraph.updateCellContent(e,t)}}for(let e=u.start.col;e<=u.end.col;e++)for(let t=u.start.row;t<=u.end.row;t++)n.scenegraph.updateCellContent(e,t);if("adaptive"===n.widthMode||n.autoFillWidth&&n.getAllColsWidth()<=n.tableNoFrameWidth)0===n.internalProps._widthResizedColMap.size&&n.scenegraph.recalculateColWidths();else if(!n.internalProps._widthResizedColMap.has(e)){let t=n.getColWidth(e),r=(0,eu.al)(e,0,n.rowCount-1,n,!1);r!==t&&n.scenegraph.updateColWidth(e,r-t)}if("adaptive"===n.heightMode||n.autoFillHeight&&n.getAllRowsHeight()<=n.tableNoFrameHeight)0===n.internalProps._heightResizedRowMap.size&&n.scenegraph.recalculateRowHeights();else if(n.isAutoRowHeight(t)&&!n.internalProps._heightResizedRowMap.has(t)){let e=n.getRowHeight(t),r=(0,et.P)(t,0,n.colCount-1,n);n.scenegraph.updateRowHeight(t,r-e)}let d=n.getCellOriginValue(e,t);a!==d&&i&&n.fireListeners(q.B.CHANGE_CELL_VALUE,{col:e,row:t,rawValue:s,currentValue:a,changedValue:d}),n.scenegraph.updateNextFrame()}}(e,t,r,o,i,this)}changeCellValues(e,t,r,o=!1,i=!0){return function(e,t,r,o,i,n){var l,s,a,u,h,d;return a=this,u=void 0,h=void 0,d=function*(){let a,u=[],h=e,d=t,c=[],p=[];for(let o=0;o<r.length&&!(t+o>n.rowCount-1);o++){let i=r[o],l=[],s=[];c.push(l),p.push(s);for(let r=0;r<i.length&&!(e+r>n.colCount-1);r++){a=function(e,t,r,o){if("group"===o||"sort"===o&&!r.internalProps.groupBy)return o;let i="normal";return r.internalProps.groupBy?i="group":!r.isHeader(e,t)&&r.dataSource.lastOrderField&&r.getBodyField(e,t)===r.dataSource.lastOrderField&&(i="sort"),i}(e+r,t+o,n,a);let i=n.getCellRawValue(e+r,t+o);l.push(i);let u=n.getCellOriginValue(e+r,t+o);s.push(u)}}for(let a=0;a<r.length&&!(t+a>n.rowCount-1);a++){u[a]=[],d=t+a;let g=r[a],C=e;for(let r=0;r<g.length&&!(e+r>n.colCount-1);r++){C=e+r;let h=!1;if(!1===o)h=!0;else if(n.isHasEditorDefine(e+r,t+a)){let o=n.getEditor(e+r,t+a),i=p[a][r],u=g[r],d=null==(s=null==(l=null==o?void 0:o.validateValue)?void 0:l.call(o,u,i,{col:e+r,row:t+a},n))||s;if((0,Q.tI)(d)){let e=yield d;h=!0===e||"validate-exit"===e||"validate-not-exit"===e}else h=!0===d||"validate-exit"===d||"validate-not-exit"===d}if(h){u[a][r]=!0;let o=g[r],l=n.getRecordShowIndexByCell(e+r,t+a),{field:s}=n.internalProps.layoutMap.getBody(e+r,t+a),h=c[a][r],d=p[a][r];n.isHeader(e+r,t+a)?n.internalProps.layoutMap.updateColumnTitle(e+r,t+a,o):n.dataSource.changeFieldValue(o,l,s,e+r,t+a,n);let C=n.getCellOriginValue(e+r,t+a);d!==C&&i&&n.fireListeners(q.B.CHANGE_CELL_VALUE,{col:e+r,row:t+a,rawValue:h,currentValue:d,changedValue:C})}else u[a][r]=!1}h=Math.max(h,C)}let g=n.getCellRange(e,t),C=n.getCellRange(h,d),f=n.internalProps.layoutMap.getAggregatorsByCellRange(g.start.col,g.start.row,C.end.col,C.end.row);if(f){for(let e=0;e<(null==f?void 0:f.length);e++)f[e].recalculate();if("normal"===a){let e=n.internalProps.layoutMap.getAggregatorCellAddress(g.start.col,g.start.row,C.end.col,C.end.row);for(let t=0;t<e.length;t++){let r=n.getCellRange(e[t].col,e[t].row);for(let e=r.start.col;e<=r.end.col;e++)for(let t=r.start.row;t<=r.end.row;t++)n.scenegraph.updateCellContent(e,t)}}}if("group"===a&&n.dataSource.updateRecordsForGroup([],[]),"sort"===a||"group"===a)return n.dataSource.sortedIndexMap.clear(),eh(n),n.refreshRowColCount(),n.internalProps.layoutMap.clearCellRangeMap(),n.scenegraph.clearCells(),n.scenegraph.createSceneGraph(),u;for(let e=g.start.col;e<=C.end.col;e++)for(let t=g.start.row;t<=C.end.row;t++)n.scenegraph.updateCellContent(e,t);if("adaptive"===n.widthMode||n.autoFillWidth&&n.getAllColsWidth()<=n.tableNoFrameWidth)0===n.internalProps._widthResizedColMap.size&&n.scenegraph.recalculateColWidths();else for(let t=e;t<=C.end.col;t++)if(!n.internalProps._widthResizedColMap.has(t)){let e=n.getColWidth(t),r=(0,eu.al)(t,0,n.rowCount-1,n,!1);r!==e&&n.scenegraph.updateColWidth(t,r-e)}if("adaptive"===n.heightMode||n.autoFillHeight&&n.getAllRowsHeight()<=n.tableNoFrameHeight)n.scenegraph.recalculateRowHeights();else if(n.isAutoRowHeight(t)){let e=[],r=[];for(let o=t;o<=C.end.row;o++)if(n.rowHeightsMap.get(o)){let t=n.getRowHeight(o),i=(0,et.P)(o,0,n.colCount-1,n);e.push(o),r.push(i-t)}n.scenegraph.updateRowsHeight(e,r)}return n.scenegraph.updateNextFrame(),u},new(h||(h=Promise))(function(e,t){function r(e){try{i(d.next(e))}catch(e){t(e)}}function o(e){try{i(d.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):((i=t.value)instanceof h?i:new h(function(e){e(i)})).then(r,o)}i((d=d.apply(a,u||[])).next())})}(e,t,r,o,i,this)}addRecord(e,t){var r;(function(e,t,r){var o,i,n,l;if(r.internalProps.groupBy)null==(i=(o=r.dataSource).addRecordsForGroup)||i.call(o,[e],t),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&eh(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if("tree"===r.dataSource.rowHierarchyType)null==(l=(n=r.dataSource).addRecordsForTree)||l.call(n,[e],t),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&eh(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if(r.sortState)r.dataSource.addRecordForSorted(e),eh(r),r.refreshRowColCount(),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else{(void 0===t||t>r.dataSource.sourceLength)&&(t=r.dataSource.sourceLength);let o=r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount;r.dataSource.addRecord(e,t);let i=r.rowCount;if(r.refreshRowColCount(),0===r.scenegraph.proxy.totalActualBodyRowCount)return r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();let n=r.transpose?r.colCount:r.rowCount;if(r.pagination){let{perPageCount:e,currentPage:l}=r.pagination,s=e*(l||0)+e;if(t<s)if(t<s-e)r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else{let l=t-(s-e)+o;if(i-o===r.pagination.perPageCount){let e=[];for(let t=l;t<n;t++)r.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});r.transpose?r.scenegraph.updateCol([],[],e):r.scenegraph.updateRow([],[],e)}else{let e=[];for(let t=l;t<Math.min(n,l+1);t++)r.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});r.transpose?r.scenegraph.updateCol([],e,[]):r.scenegraph.updateRow([],e,[])}}}else{let e=[];for(let i=t+o;i<t+o+1;i++)r.transpose?e.push({col:i,row:0}):e.push({col:0,row:i});let i=[],n=r.internalProps.layoutMap.hasAggregationOnTopCount,l=r.internalProps.layoutMap.hasAggregationOnBottomCount;for(let e=o;e<o+n;e++)r.transpose?i.push({col:e,row:0}):i.push({col:0,row:e});for(let e=(r.transpose?r.colCount:r.rowCount)-l;e<(r.transpose?r.colCount:r.rowCount);e++)r.transpose?i.push({col:e,row:0}):i.push({col:0,row:e});r.transpose?r.scenegraph.updateCol([],e,[]):r.scenegraph.updateRow([],e,[])}}})(e,t,this),null==(r=this.internalProps.emptyTip)||r.resetVisible()}addRecords(e,t){var r;(function(e,t,r){var o,i,n,l;if(r.internalProps.groupBy)null==(i=(o=r.dataSource).addRecordsForGroup)||i.call(o,e,t),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&eh(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if("tree"===r.dataSource.rowHierarchyType)null==(l=(n=r.dataSource).addRecordsForTree)||l.call(n,e,t),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&eh(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if(r.sortState)r.dataSource.addRecordsForSorted(e),eh(r),r.refreshRowColCount(),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else{void 0===t||t>r.dataSource.sourceLength?t=r.dataSource.sourceLength:t<0&&(t=0);let o=r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount;r.dataSource.addRecords(e,t);let i=r.transpose?r.colCount:r.rowCount;if(r.refreshRowColCount(),0===r.scenegraph.proxy.totalActualBodyRowCount)return r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();let n=r.transpose?r.colCount:r.rowCount;if(r.pagination){let{perPageCount:l,currentPage:s}=r.pagination,a=l*(s||0)+l;if(t<a)if(t<a-l)r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else{let s=t-(a-l)+o;if(i-o===r.pagination.perPageCount){let e=[];for(let t=s;t<n;t++)r.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});r.transpose?r.scenegraph.updateCol([],[],e):r.scenegraph.updateRow([],[],e)}else{let t=[];for(let o=s;o<Math.min(n,s+(Array.isArray(e)?e.length:1));o++)r.transpose?t.push({col:o,row:0}):t.push({col:0,row:o});r.transpose?r.scenegraph.updateCol([],t,[]):r.scenegraph.updateRow([],t,[])}}}else{let i=[];for(let n=t+o;n<t+o+(Array.isArray(e)?e.length:1);n++)r.transpose?i.push({col:n,row:0}):i.push({col:0,row:n});let n=r.internalProps.layoutMap.hasAggregationOnTopCount,l=r.internalProps.layoutMap.hasAggregationOnBottomCount,s=[];for(let e=o;e<o+n;e++)r.transpose?s.push({col:e,row:0}):s.push({col:0,row:e});for(let e=(r.transpose?r.colCount:r.rowCount)-l;e<(r.transpose?r.colCount:r.rowCount);e++)r.transpose?s.push({col:e,row:0}):s.push({col:0,row:e});r.transpose?r.scenegraph.updateCol([],i,s):r.scenegraph.updateRow([],i,s)}}})(e,t,this),null==(r=this.internalProps.emptyTip)||r.resetVisible()}deleteRecords(e){var t;(function(e,t){var r,o,i,n,l,s,a,u;if((null==e?void 0:e.length)>0)if(t.internalProps.groupBy)null==(o=(r=t.dataSource).deleteRecordsForGroup)||o.call(r,e),t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&eh(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else if("tree"===t.dataSource.rowHierarchyType)null==(n=(i=t.dataSource).deleteRecordsForTree)||n.call(i,e),t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&eh(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else if(t.sortState)t.dataSource.deleteRecordsForSorted(e),eh(t),t.refreshRowColCount(),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{let r=t.dataSource.deleteRecords(e);if(0===r.length)return;let o=t.transpose?t.colCount:t.rowCount;t.refreshRowColCount();let i=t.transpose?t.colCount:t.rowCount,n=r.sort((e,t)=>e-t),h=n[0];if(t.pagination){let{perPageCount:e,currentPage:r}=t.pagination,n=e*(r||0)+e;if(h<n)if(h<n-e)t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{let r=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,a=t.internalProps.layoutMap.hasAggregationOnTopCount,u=[],d=[];for(let r=h-(n-e)+(t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount)+a;r<i;r++)t.transpose?u.push({col:r,row:0}):u.push({col:0,row:r});for(let e=r;e<r+a;e++)t.transpose?u.push({col:e,row:0}):u.push({col:0,row:e});if(i<o)for(let e=i;e<o;e++)t.transpose?d.push({col:e,row:0}):d.push({col:0,row:e});null==(l=t.reactCustomLayout)||l.clearCache(),t.transpose?t.scenegraph.updateCol(d,[],u):t.scenegraph.updateRow(d,[],u),null==(s=t.reactCustomLayout)||s.updateAllCustomCell()}}else{let e=[],r=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,o=t.internalProps.layoutMap.hasAggregationOnTopCount,i=t.internalProps.layoutMap.hasAggregationOnBottomCount;for(let i=0;i<n.length;i++){let l=n[i]+r+o;t.transpose?e.push({col:l,row:0}):e.push({col:0,row:l})}let l=[];for(let e=r;e<r+o;e++)t.transpose?l.push({col:e,row:0}):l.push({col:0,row:e});for(let e=(t.transpose?t.colCount:t.rowCount)-i;e<(t.transpose?t.colCount:t.rowCount);e++)t.transpose?l.push({col:e,row:0}):l.push({col:0,row:e});null==(a=t.reactCustomLayout)||a.clearCache(),t.transpose?t.scenegraph.updateCol(e,[],l):t.scenegraph.updateRow(e,[],l),null==(u=t.reactCustomLayout)||u.updateAllCustomCell()}}})(e,this),null==(t=this.internalProps.emptyTip)||t.resetVisible()}updateRecords(e,t){!function(e,t,r){var o,i,n,l;if((null==t?void 0:t.length)>0)if(r.internalProps.groupBy)null==(i=(o=r.dataSource).updateRecordsForGroup)||i.call(o,e,t),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&eh(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if("tree"===r.dataSource.rowHierarchyType)null==(l=(n=r.dataSource).updateRecordsForTree)||l.call(n,e,t),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&eh(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if(r.sortState)r.dataSource.updateRecordsForSorted(e,t),eh(r),r.refreshRowColCount(),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else{let o=r.dataSource.updateRecords(e,t);if(0===o.length)return;let i=o.map(e=>r.getBodyRowIndexByRecordIndex(e)).sort((e,t)=>e-t);if(r.pagination){let{perPageCount:e,currentPage:t}=r.pagination,o=r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount,n=r.internalProps.layoutMap.hasAggregationOnTopCount,l=e*(t||0)+e,s=[];for(let t=0;t<i.length;t++){let o=i[t];if(o<l&&o>=l-e){let t=o-(l-e)+(r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount)+n;s.push(t)}}if(s.length>=1){let e=[];for(let t=0;t<s.length;t++){let o=s[t];r.transpose?e.push({col:o,row:0}):e.push({col:0,row:o})}for(let t=o;t<o+n;t++)r.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});r.transpose?r.scenegraph.updateCol([],[],e):r.scenegraph.updateRow([],[],e)}}else{let e=[],t=r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount,o=r.internalProps.layoutMap.hasAggregationOnTopCount,n=r.internalProps.layoutMap.hasAggregationOnBottomCount;for(let n=0;n<i.length;n++){let l=i[n]+t+o;r.transpose?e.push({col:l,row:0}):e.push({col:0,row:l})}for(let i=t;i<t+o;i++)r.transpose?e.push({col:i,row:0}):e.push({col:0,row:i});for(let t=(r.transpose?r.colCount:r.rowCount)-n;t<(r.transpose?r.colCount:r.rowCount);t++)r.transpose?e.push({col:t,row:0}):e.push({col:0,row:t});r.transpose?r.scenegraph.updateCol([],[],e):r.scenegraph.updateRow([],[],e)}}}(e,t,this)}_hasCustomRenderOrLayout(){var e,t,r,o;let{headerObjects:i}=this.internalProps.layoutMap;if(this.options.customRender)return!0;for(let n=0;n<i.length;n++){let l=i[n];if((null==(e=null==l?void 0:l.define)?void 0:e.customLayout)||(null==(t=null==l?void 0:l.define)?void 0:t.headerCustomLayout)||(null==(r=null==l?void 0:l.define)?void 0:r.customRender)||(null==(o=null==l?void 0:l.define)?void 0:o.headerCustomRender))return!0}return!1}getAggregateValuesByField(e){let t=this.internalProps.layoutMap.getColumnByField(e),r=[];for(let e=0;e<t.length;e++){let o=t[e].columnDefine.aggregator;if(delete t[e].columnDefine,o){let i={col:t[e].col,aggregateValue:null};if(i.aggregateValue=[],Array.isArray(o))for(let e=0;e<o.length;e++)i.aggregateValue.push({aggregationType:o[e].type,value:o[e].value()});else i.aggregateValue.push({aggregationType:o.type,value:o.value()});r.push(i)}}return r}isAggregation(e,t){return this.internalProps.layoutMap.isAggregation(e,t)}getGroupTitleLevel(e,t){var r;if(!this.internalProps.groupBy)return;let o=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(e,t)),i=null!=(r=this.dataSource.getGroupLength())?r:0,n=(0,G.Z)(o)?o.length-1:0;return i>0&&n===i&&(n=void 0),n}getBodyRowIndexByRecordIndex(e){return Array.isArray(e)&&1===e.length&&(e=e[0]),this.dataSource.getTableIndex(e)}_parseColumnWidthConfig(e){for(let t=0;t<(null==e?void 0:e.length);t++){let r=e[t],o=r.key,i=r.width,n=this.internalProps.layoutMap.getColumnByKey(o);if(n.columnDefine){let{col:e}=n;this.internalProps._widthResizedColMap.has(e)||(this._setColWidth(e,i),this.internalProps._widthResizedColMap.add(e))}}}release(){this.editorManager.release(),super.release()}expandAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let e=!1;this.dataSource&&"function"==typeof this.dataSource.expandAllNodes&&(this.dataSource.expandAllNodes(),e=!0),e&&(this._recreateSceneForStateChange(),this.fireListeners(q.B.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:T.g.expand,originData:{children:this.records}}))}collapseAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let e=!1;this.dataSource&&"function"==typeof this.dataSource.collapseAllNodes&&(this.dataSource.collapseAllNodes(),e=!0),e&&(this._recreateSceneForStateChange(),this.fireListeners(q.B.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:T.g.collapse,originData:{children:this.records}}))}}var ep=r(50173),eg=r(38512),eC=r(17097),ef=r(28651);function em(e,t){let r=t.getDrawRange();if((0,V.Z)(e)&&e>=t.frozenRowCount){let o=t.getFrozenRowsHeight(),i=t.getRowsHeight(0,e-1);t.scrollTop=Math.min(i-o,t.getAllRowsHeight()-r.height)-1}t.scenegraph.updateNextFrame()}var ey=r(66209);(0,ep.R2)(),(0,ep.Eg)(),(0,ep.I)(),(0,ep.FD)(),(0,ep._t)(),(0,ep.Mh)(),el.F.registerComponent("listTreeStickCellPlugin",class e{constructor(e){this.titleRows=[],this.showedTitleRows=[],this.rowNow=-1,this.skipStartRow=-1,this.skipEndRow=-1,this.table=e,this.table.on("scroll",e=>{"vertical"===e.scrollDirection&&this.updateGroupTitle()}),this.table.on("tree_hierarchy_state_change",e=>{this.updateGroupTitle()}),this.table.on("resize_column",e=>{this.updateGroupTitle()})}updateGroupTitle(){0===this.table.scrollTop?(this.titleRows=[],this.showedTitleRows=[]):-1!==this.skipStartRow&&-1!==this.skipEndRow&&this.skipStartRow!==this.table.scenegraph.proxy.bodyTopRow-1?(this.table.scenegraph.proxy.screenTopRow<=this.skipStartRow||this.table.scenegraph.proxy.screenTopRow>=this.skipEndRow)&&(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()):(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()),this.updateScenegraph()}updateGroupTitleInfo(){this.rowNow=this.table.scenegraph.proxy.screenTopRow+this.titleRows.length;let e=this.table.getRecordIndexByCell(0,this.rowNow),t=this.table.getRecordIndexByCell(0,this.rowNow+1);this.getTitleRowsByRecordIndex(e,t)}getTitleRowsByRecordIndex(e,t){let r=[];(0,G.Z)(e)||(e=[e]),(0,G.Z)(t)||(t=[t]);for(let t=0;t<e.length;t++){let o=e.slice(0,t+1),i=this.table.dataSource.getRaw(o);r.push(i)}let o=[],i=t.length===e.length+1,n=e.slice(0,i?e.length:e.length-1),l=this.table.dataSource.currentIndexedData;for(let t=this.rowNow-this.table.columnHeaderLevelCount;t>=0;t--){let r=l[t];if((0,G.Z)(r)&&n.length===r.length){let e=!0;for(let t=0;t<r.length;t++)if(r[t]!==n[t]){e=!1;break}e&&(o.push(t+this.table.columnHeaderLevelCount),n=n.slice(0,n.length-1))}else if(r===e[0]){o.push(t+this.table.columnHeaderLevelCount);break}}this.titleRows=o.reverse()}updateScenegraph(){let{table:e}=this,{shadowGroup:t,shadowGroupFrozen:r}=function(e){let t=e.scenegraph.colHeaderGroup,r=e.scenegraph.cornerHeaderGroup;if(!t.border){let r=(0,ef.f)({x:0,y:0,width:0,height:0,cursor:"pointer"});t.add(r),t.border=r,r.attachShadow(r.shadowRoot),r.name="border-rect",r.addEventListener("click",t=>{let r=e.listTreeStickCellPlugin.titleRows,{shadowTarget:o}=t.pickParams,{col:i,row:n}=(0,U.J$)(o);em(n-r.indexOf(n),e)})}if(!r.border){let t=(0,ef.f)({x:0,y:0,width:0,height:0,cursor:"pointer"});r.add(t),r.border=t,t.attachShadow(t.shadowRoot),t.name="border-rect",t.addEventListener("click",t=>{let r=e.listTreeStickCellPlugin.titleRows,{shadowTarget:o}=t.pickParams,{col:i,row:n}=(0,U.J$)(o);em(n-r.indexOf(n),e)})}let o=t.border.shadowRoot,i=r.border.shadowRoot;return o.removeAllChild(),i.removeAllChild(),{shadowGroup:o,shadowGroupFrozen:i}}(e);this.showedTitleRows.length=0;let o=0;for(let a=0;a<e.colCount;a++){let u;a<e.frozenColCount?(u=new eg.Z({x:e.getColsWidth(0,a-1),y:e.getFrozenRowsHeight()}),r.add(u)):(u=new eg.Z({x:e.getColsWidth(e.frozenColCount,a-1),y:e.getFrozenRowsHeight()}),t.add(u)),u.col=a;for(let t=0;t<this.titleRows.length;t++){var i,n,l,s;let r=this.titleRows[t];if(i=r,n=this.rowNow,l=e.scenegraph.proxy.screenTopRow,s=this.titleRows,i===n&&i!==l+s.length-1||i===l+s.indexOf(i)+1&&i<n){0===a&&o++;continue}0===a&&this.showedTitleRows.push(r);let h=e.scenegraph.getCell(a,r);if("cell"===h.role){let e=function e(t){let r=t.clone();if(r.role=t.role,r.col=t.col,r.row=t.row,r.mergeStartCol=t.mergeStartCol,r.mergeStartRow=t.mergeStartRow,r.mergeEndCol=t.mergeEndCol,r.mergeEndRow=t.mergeEndRow,r.contentWidth=t.contentWidth,r.contentHeight=t.contentHeight,"cell"===r.role){let e=(0,ef.f)({x:0,y:0,width:r.attribute.width,height:r.attribute.height});r.add(e)}return"group"===t.type&&t.forEachChildren(t=>{let o=e(t);r.add(o)}),r}(h);e.setAttributes({y:40*t}),u.add(e)}else{let o=(0,eC.wW)(a,r,e,!0,!0);o.setAttributes({y:40*t}),u.add(o)}}}o>0&&-1===this.skipStartRow&&-1===this.skipEndRow&&(this.skipStartRow=e.scenegraph.proxy.screenTopRow-1,this.skipEndRow=e.scenegraph.proxy.screenTopRow+1)}}),(0,z.zf)(),(0,ep.ph)(),(0,ey.LQ)(),(0,ey.yR)(),(0,ey.pk)(),(0,ey.m4)(),(0,ey.Jy)(),(0,ey.VT)(),(0,ey.ah)(),(0,ey.dB)(),(0,ey.ge)(),(0,ey.au)();class ew extends ec{}(0,ey.ge)();class ev extends ec{}var eP=r(2714);class eb{constructor(e,t){this.tree={},this.beforeChangedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.dataConfig=e,t&&(this.records=t,"undefined"!=typeof window&&window.performance.now(),this.setRecords(t),"undefined"!=typeof window&&window.performance.now())}changeDataConfig(e){this.dataConfig=e}setRecords(e){this.processRecords()}processRecords(){for(let e=0,t=this.records.length;e<t;e++){let t=this.records[e];this.processRecord(t)}}processRecord(e){var t;let r=[],o=[];for(let t=0,r=this.dataConfig.rows.length;t<r;t++){let r=this.dataConfig.rows[t];void 0!==e[r]&&r!==this.dataConfig.indicatorDimensionKey&&o.push(e[r])}for(let t=0,o=this.dataConfig.columns.length;t<o;t++){let o=this.dataConfig.columns[t];void 0!==e[o]&&o!==this.dataConfig.indicatorDimensionKey&&r.push(e[o])}null==(t=this.dataConfig.indicators)||t.forEach(t=>{let i=e[t];void 0!==i&&(this.dataConfig.indicatorsAsCol?r.push(t):o.push(t));let n=o.join(this.stringJoinChar),l=r.join(this.stringJoinChar);0!==o.length&&(this.rowFlatKeys[n]||(this.rowFlatKeys[n]=1)),0!==r.length&&(this.colFlatKeys[l]||(this.colFlatKeys[l]=1)),0===r.length&&0===o.length||(this.tree[n]||(this.tree[n]={}),void 0!==i&&(this.tree[n][l]={value:i,record:e},this.dataConfig.indicatorsAsCol?r.pop():o.pop()))})}getTreeNode(e=[],t=[],r,o=!0){var i,n,l,s;let a,u;if("string"==typeof e)a=e;else{let t=!1;e.map((o,i)=>{o===r&&(e.splice(i,1),t=!0)}),t&&e.push(r),a=e.join(this.stringJoinChar)}if("string"==typeof t)u=t;else{let e=!1;t.map((o,i)=>{o===r&&(t.splice(i,1),e=!0)}),e&&t.push(r),u=t.join(this.stringJoinChar)}return o?null!=(l=null==(n=null==(i=this.tree)?void 0:i[a])?void 0:n[u])?l:void 0:(0,V.Z)(null==(s=this.beforeChangedTree[a])?void 0:s[u])?{value:this.beforeChangedTree[a][u].value,record:this.beforeChangedTree[a][u].record}:void 0}changeTreeNodeValue(e=[],t=[],r,o){var i,n,l,s,a,u,h;let d,c;if("string"==typeof e)d=e;else{let t=!1;e.map((o,i)=>{o===r&&(e.splice(i,1),t=!0)}),t&&e.push(r),d=e.join(this.stringJoinChar)}if("string"==typeof t)c=t;else{let e=!1;t.map((o,i)=>{o===r&&(t.splice(i,1),e=!0)}),e&&t.push(r),c=t.join(this.stringJoinChar)}let p=null==(n=null==(i=this.tree[d])?void 0:i[c])?void 0:n.value,g=Object.assign({},null==(s=null==(l=this.tree[d])?void 0:l[c])?void 0:s.record);(null==(u=null==(a=this.tree[d])?void 0:a[c])?void 0:u.record)?(this.tree[d][c].record[r]=o,this.tree[d][c].value=o):(this.tree[d]||(this.tree[d]={}),this.tree[d][c]={record:this._buildRecord(e,t,r,o),value:o}),(null==(h=this.beforeChangedTree[d])?void 0:h[c])||(this.beforeChangedTree[d]={},this.beforeChangedTree[d][c]={record:void 0,value:void 0},this.beforeChangedTree[d][c].record=g,this.beforeChangedTree[d][c].value=p)}_buildRecord(e=[],t=[],r,o){let i={},n=this.dataConfig.rows,l=this.dataConfig.columns;return n.forEach((t,r)=>{t!==this.dataConfig.indicatorDimensionKey&&(i[t]=e[r])}),l.forEach((e,r)=>{e!==this.dataConfig.indicatorDimensionKey&&(i[e]=t[r])}),i[r]=o,this.records.push(i),i}addRecords(e){for(let t=0,r=e.length;t<r;t++){let r=e[t];this.processRecord(r)}this.records.push(e)}changeRecordFieldValue(e,t,r){let o=!1;for(let t=0;t<this.dataConfig.indicators.length;t++)this.dataConfig.indicators[t]===e&&(o=!0);if(!o){for(let o=0,i=this.records.length;o<i;o++){let i=this.records[o];i[e]===t&&(i[e]=r)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}}var eR=r(53372),eS=r(9284),eH=r(19465),eT=r(58977);class eM extends x.D{constructor(e,t){var r,o,i,n,l,s,a,u,h,d,c,p,g,C,f,m,y,w,v,P,b,R,S,H;if(super(e,t),this.layoutNodeId={seqId:0},t=this.options){t.rowHierarchyType||(t.rowHierarchyType="grid"),t.columnHierarchyType||(t.columnHierarchyType="grid"),t.layout&&Object.assign(t,t.layout),this.internalProps.columns=(0,eH.Z)(t.columns),this.internalProps.rows=(0,eH.Z)(t.rows),this.internalProps.indicators=(0,ei.u)(t.indicators),null==(r=t.indicators)||r.forEach((e,t)=>{"object"==typeof e&&(null==e?void 0:e.editor)&&(this.internalProps.indicators[t].editor=e.editor)}),this.internalProps.columnTree=!t.indicatorsAsCol||(null==(o=t.columns)?void 0:o.length)||t.columnTree?(0,eH.Z)(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||(null==(i=t.rows)?void 0:i.length)||t.rowTree?(0,eH.Z)(t.rowTree):[],this.internalProps.records=t.records,this.pagination=t.pagination,this.internalProps.columnResizeType=null!=(s=null!=(l=null==(n=t.resize)?void 0:n.columnResizeType)?l:t.columnResizeType)?s:"column",this.internalProps.rowResizeType=null!=(h=null!=(u=null==(a=t.resize)?void 0:a.rowResizeType)?u:t.rowResizeType)?h:"row",this.internalProps.dataConfig=(0,eH.Z)(t.dataConfig),this.internalProps.columnWidthConfig=t.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=t.columnWidthConfigForRowHeader;let e=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(d=null==e?void 0:e[0])?void 0:d.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),!1===(null==(c=t.customConfig)?void 0:c.enableDataAnalysis)){let t=new W.KO(null!=(p=this.internalProps.columnTree)?p:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(g=this.options.columnExpandLevel)?g:1:void 0),r=new W.KO(null!=(C=this.internalProps.rowTree)?C:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(f=this.options.rowExpandLevel)?f:1:void 0);this.internalProps.layoutMap=new eP.z(this,null,t,r),!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new eb({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey},e))}else{let e=(0,k.Ul)(this,t),{rowKeys:r,columnKeys:o,indicatorKeys:i}=e,{columnDimensionTree:n,rowDimensionTree:l}=e;this.dataset=new eS.q(this.internalProps.dataConfig,r,o,i,this.internalProps.indicators,null==(m=t.indicatorsAsCol)||m,t.records,t.rowHierarchyType,t.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!t.extensionRows,!!t.parseCustomTreeToMatchRecords),t.columnTree?n.hasHideNode&&((0,k.uu)(n.tree.children,t.indicators,!0,this),n.reset(n.tree.children)):(!1!==t.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,k.VN)(this.dataset.colHeaderTree,t.indicators)),!1!==t.indicatorsAsCol&&t.indicators&&this.dataset.colHeaderTree&&(0,k.uu)(this.dataset.colHeaderTree,t.indicators,!1,this),n=new W.KO(null!=(y=this.dataset.colHeaderTree)?y:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(w=this.options.columnExpandLevel)?w:1:void 0)),t.rowTree?l.hasHideNode&&((0,k.uu)(l.tree.children,t.indicators,!0,this),l.reset(l.tree.children)):(!1===t.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,k.VN)(this.dataset.rowHeaderTree,t.indicators)),!1===t.indicatorsAsCol&&this.dataset.rowHeaderTree&&t.indicators&&(0,k.uu)(this.dataset.rowHeaderTree,t.indicators,!1,this),l=new W.KO(null!=(v=this.dataset.rowHeaderTree)?v:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(P=this.options.rowExpandLevel)?P:1:void 0)),this.internalProps.layoutMap=new eP.z(this,this.dataset,n,l)}if(this._changePivotSortStateBySortRules(),(null!=(R=null==(b=t.pivotSortState)?void 0:b.length)?R:0)>0&&(this.pivotSortState=[],this.pivotSortState=t.pivotSortState),"node"!==J.X.mode&&(this.editorManager=new X(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.stateManager.initCheckedState(e),this.scenegraph.createSceneGraph(),t.title){let e=el.F.getComponent("title");this.internalProps.title=new e(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(S=this.internalProps.emptyTip)||S.resetVisible();else{let e=el.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(H=this.internalProps.emptyTip)||H.resetVisible()}setTimeout(()=>{this.fireListeners(q.B.INITIALIZED,null)},0)}}static get EVENT_TYPE(){return eR.z}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!1}get recordsCount(){var e;return null==(e=this.records)?void 0:e.length}_canResizeColumn(e,t){let r=super._canResizeColumn(e,t);if(r){if(this.internalProps.layoutMap.isSeriesNumber(e,t)&&!0===this.internalProps.rowSeriesNumber.disableColumnResize)return!1;if(!this.internalProps.layoutMap.indicatorsAsCol){let t=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(null==t?void 0:t.disableColumnResize)return!1}}return r}updateOption(e){var t,r,o,i,n,l,s,a,u,h,d,c,p,g,C,f,m,y,w,v,P,b,R,S,H,T;let M=this.internalProps;if(super.updateOption(e),e.rowHierarchyType||(e.rowHierarchyType="grid"),e.columnHierarchyType||(e.columnHierarchyType="grid"),this.layoutNodeId={seqId:0},this.internalProps.columns=(0,eH.Z)(e.columns),this.internalProps.rows=(0,eH.Z)(e.rows),this.internalProps.indicators=(null==(t=e.indicators)?void 0:t.length)?(0,ei.u)(e.indicators):[],null==(r=e.indicators)||r.forEach((e,t)=>{"object"==typeof e&&(null==e?void 0:e.editor)&&(this.internalProps.indicators[t].editor=e.editor)}),this.internalProps.columnTree=!e.indicatorsAsCol||(null==(o=e.columns)?void 0:o.length)||e.columnTree?(0,eH.Z)(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||(null==(i=e.rows)?void 0:i.length)||e.rowTree?(0,eH.Z)(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.stateManager.initCheckedState(this.internalProps.records),this.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1),this.pagination=e.pagination,M.columnResizeType=null!=(s=null!=(l=null==(n=e.resize)?void 0:n.columnResizeType)?l:e.columnResizeType)?s:"column",M.rowResizeType=null!=(h=null!=(u=null==(a=e.resize)?void 0:a.rowResizeType)?u:e.rowResizeType)?h:"row",M.dataConfig=(0,eH.Z)(e.dataConfig),this.internalProps.columnWidthConfig=e.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=e.columnWidthConfigForRowHeader,"grid"!==(null==e?void 0:e.rowHierarchyType)&&"grid"!==this.internalProps.layoutMap.rowHierarchyType&&this.internalProps.layoutMap.rowExpandLevel===(null==e?void 0:e.rowExpandLevel)){let e=this.internalProps.layoutMap.rowDimensionTree.tree.children;null==(d=this.internalProps.rowTree)||d.forEach((t,r)=>{let o=e.find(e=>e.dimensionKey===t.dimensionKey&&e.value===t.value);o&&this._syncHierarchyState(o,t)})}let A=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(c=null==A?void 0:A[0])?void 0:c.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),!1===(null==(p=e.customConfig)?void 0:p.enableDataAnalysis)){let t,r;e.columnTree&&(t=new W.KO(null!=(g=this.internalProps.columnTree)?g:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(C=this.options.columnExpandLevel)?C:1:void 0)),e.rowTree&&(r=new W.KO(null!=(f=this.internalProps.rowTree)?f:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(m=this.options.rowExpandLevel)?m:1:void 0)),M.layoutMap.clearHeaderPathCache(),M.layoutMap=new eP.z(this,null,t,r),!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new eb({rows:M.layoutMap.fullRowDimensionKeys,columns:M.layoutMap.colDimensionKeys,indicators:M.layoutMap.indicatorKeys,indicatorsAsCol:M.layoutMap.indicatorsAsCol,indicatorDimensionKey:M.layoutMap.indicatorDimensionKey},A))}else{let t=(0,k.Ul)(this,e),{rowKeys:r,columnKeys:o,indicatorKeys:i}=t,{columnDimensionTree:n,rowDimensionTree:l}=t;this.dataset=new eS.q(M.dataConfig,r,o,i,this.internalProps.indicators,null==(y=e.indicatorsAsCol)||y,A,e.rowHierarchyType,e.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!e.extensionRows,!!e.parseCustomTreeToMatchRecords),e.columnTree?n.hasHideNode&&((0,k.uu)(n.tree.children,e.indicators,!0,this),n.reset(n.tree.children)):(!1!==e.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,k.VN)(this.dataset.colHeaderTree,e.indicators)),!1!==e.indicatorsAsCol&&e.indicators&&this.dataset.colHeaderTree&&(0,k.uu)(this.dataset.colHeaderTree,e.indicators,!1,this),n=new W.KO(null!=(w=this.dataset.colHeaderTree)?w:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(v=this.options.columnExpandLevel)?v:1:void 0)),e.rowTree?l.hasHideNode&&((0,k.uu)(l.tree.children,e.indicators,!0,this),l.reset(l.tree.children)):(!1===e.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,k.VN)(this.dataset.rowHeaderTree,e.indicators)),!1===e.indicatorsAsCol&&this.dataset.rowHeaderTree&&e.indicators&&(0,k.uu)(this.dataset.rowHeaderTree,e.indicators,!1,this),l=new W.KO(null!=(P=this.dataset.rowHeaderTree)?P:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(b=this.options.rowExpandLevel)?b:1:void 0)),M.layoutMap=new eP.z(this,this.dataset,n,l)}if(this._changePivotSortStateBySortRules(),(null!=(S=null==(R=e.pivotSortState)?void 0:R.length)?S:0)>0&&(this.pivotSortState=[],this.pivotSortState=e.pivotSortState),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,M.releaseList&&(M.releaseList.forEach(e=>{var t;return null==(t=null==e?void 0:e.release)?void 0:t.call(e)}),M.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){let t=el.F.getComponent("title");this.internalProps.title=new t(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(H=this.internalProps.emptyTip)||H.resetVisible();else{let e=el.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(T=this.internalProps.emptyTip)||T.resetVisible()}return new Promise(e=>{setTimeout(e,0)})}updatePagination(e){this.internalProps.layoutMap.clearHeaderPathCache(),e?(this.pagination||(this.pagination={currentPage:0,perPageCount:0}),"number"==typeof e.currentPage&&e.currentPage>=0&&(this.pagination.currentPage=e.currentPage),e.perPageCount&&(this.pagination.perPageCount=e.perPageCount||this.pagination.perPageCount),this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(this.pagination),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()):this.pagination&&(this.pagination=void 0,this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(void 0),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render())}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,r,o,i,n,l,s;let{layoutMap:a}=this.internalProps;a&&(this.colCount=null!=(e=a.colCount)?e:0,this.rowCount=null!=(t=a.rowCount)?t:0,this.internalProps.frozenColCount=this.options.frozenColCount?this.options.frozenColCount:(null!=(r=a.rowHeaderLevelCount)?r:0)+a.leftRowSeriesNumberColumnCount,this.frozenRowCount=Math.max(a.headerLevelCount,null!=(o=this.options.frozenRowCount)?o:0),this.bottomFrozenRowCount!==(null!=(i=this.options.bottomFrozenRowCount)?i:0)&&(this.bottomFrozenRowCount=null!=(n=this.options.bottomFrozenRowCount)?n:0),this.rightFrozenColCount!==(null!=(l=this.options.rightFrozenColCount)?l:0)&&(this.rightFrozenColCount=null!=(s=this.options.rightFrozenColCount)?s:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount),this.stateManager.setFrozenRow(this.frozenRowCount))}_getSortFuncFromHeaderOption(e,t,r){}get rowHierarchyType(){return this.internalProps.layoutMap.rowHierarchyType}get columnHierarchyType(){return this.internalProps.layoutMap.columnHierarchyType}_syncHierarchyState(e,t){var r,o;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=null!=(r=t.hierarchyState)?r:(null==t?void 0:t.children)?e.hierarchyState:void 0,null==(o=null==t?void 0:t.children)||o.forEach((t,r)=>{var o;if((null==(o=null==e?void 0:e.children)?void 0:o[r])&&t){let r=e.children.find(e=>e.dimensionKey===t.dimensionKey&&e.value===t.value);r&&this._syncHierarchyState(r,t)}}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){let{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){let{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getFieldData(e,t,r){var o,i,n;if(!this.internalProps.layoutMap.isHeader(t,r)){if(this.internalProps.recordsIsTwoDimensionalArray){let e=this.getBodyIndexByRow(r),i=this.getBodyIndexByCol(t);return null==(o=this.records[e])?void 0:o[i]}if(this.dataset){let o=this.internalProps.layoutMap.getCellHeaderPaths(t,r);if(o){let l,s=null==(i=o.colHeaderPaths)?void 0:i.filter(e=>!e.virtual).map((e,t)=>{var r;return e.indicatorKey&&(l={position:"col",index:t}),null!=(r=e.indicatorKey)?r:e.value}),a=null==(n=o.rowHeaderPaths)?void 0:n.filter(e=>!e.virtual).map((e,t)=>{var r;return e.indicatorKey&&(l={position:"row",index:t}),null!=(r=e.indicatorKey)?r:e.value}),u=this.dataset.getAggregator(a,s,this.internalProps.layoutMap.getIndicatorKey(t,r),!0,l);if(u.records&&u.records.length>=1)return u.records[0][e]}}else if(this.flatDataToObjects){let o=this.internalProps.layoutMap.getCellHeaderPaths(t,r),i=o.colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=o.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),l=this.flatDataToObjects.getTreeNode(n,i,this.internalProps.layoutMap.getBody(t,r).indicatorKey,!1);if(null==l?void 0:l.record)return null==l?void 0:l.record[e]}}}getCellValue(e,t,r){var o,i,n,l,s,a,u;if(!r){let r=this.getCustomMergeValue(e,t);if(r)return r}if(this.internalProps.layoutMap.isSeriesNumber(e,t)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)){let{title:r}=this.internalProps.layoutMap.getSeriesNumberHeader(e,t);return r}let{format:r}=this.internalProps.layoutMap.getSeriesNumberBody(e,t);return"function"==typeof r?r(e,t,this):t-this.columnHeaderLevelCount+1}if(this.internalProps.layoutMap.isHeader(e,t)){let{title:r,fieldFormat:o}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof o?o(r,e,t,this):r}if(this.internalProps.recordsIsTwoDimensionalArray){let{fieldFormat:r}=this.internalProps.layoutMap.getBody(e,t),i=this.getBodyIndexByRow(t),n=this.getBodyIndexByCol(e),l=null==(o=this.records[i])?void 0:o[n];return"function"==typeof r?r(l,e,t,this):l}if(this.dataset){let r,o=this.internalProps.layoutMap.getCellHeaderPaths(e,t),u=null==(n=null==(i=o.colHeaderPaths)?void 0:i.filter(e=>!e.virtual))?void 0:n.map((e,t)=>{var o;return e.indicatorKey&&(r={position:"col",index:t}),null!=(o=e.indicatorKey)?o:e.value}),h=null==(s=null==(l=o.rowHeaderPaths)?void 0:l.filter(e=>!e.virtual))?void 0:s.map((e,t)=>{var o;return e.indicatorKey&&(r={position:"row",index:t}),null!=(o=e.indicatorKey)?o:e.value}),d=this.dataset.getAggregator(h,u,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,r),{fieldFormat:c}=this.internalProps.layoutMap.getBody(e,t);return d.formatValue?d.formatValue(e,t,this):"function"==typeof c?c(null==d?void 0:d.value(),e,t,this):null!=(a=null==d?void 0:d.value())?a:""}if(this.flatDataToObjects){let r=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=r.colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),i=r.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=this.flatDataToObjects.getTreeNode(i,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey),{fieldFormat:l}=this.internalProps.layoutMap.getBody(e,t);return"function"==typeof l?l(null==n?void 0:n.value,e,t,this):null!=(u=null==n?void 0:n.value)?u:""}}getCellOriginValue(e,t){var r,o,i;if(this.internalProps.layoutMap.isHeader(e,t)){let{title:r}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof r?r():r}if(this.internalProps.recordsIsTwoDimensionalArray){let o=this.getBodyIndexByRow(t),i=this.getBodyIndexByCol(e);return null==(r=this.records[o])?void 0:r[i]}if(this.dataset){let r,n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=null==(o=n.colHeaderPaths)?void 0:o.filter(e=>!e.virtual).map((e,t)=>{var o;return e.indicatorKey&&(r={position:"col",index:t}),null!=(o=e.indicatorKey)?o:e.value}),s=null==(i=n.rowHeaderPaths)?void 0:i.filter(e=>!e.virtual).map((e,t)=>{var o;return e.indicatorKey&&(r={position:"row",index:t}),null!=(o=e.indicatorKey)?o:e.value}),a=this.dataset.getAggregator(s,l,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,r);return a.value?a.value():void 0}if(this.flatDataToObjects){let r=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=r.colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),i=r.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=this.flatDataToObjects.getTreeNode(i,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return null==n?void 0:n.value}}getCellRawValue(e,t){var r,o,i;if(this.internalProps.layoutMap.isHeader(e,t)){let{title:r}=this.internalProps.layoutMap.getHeader(e,t);return"function"==typeof r?r():r}if(this.internalProps.recordsIsTwoDimensionalArray){let o=this.getBodyIndexByRow(t),i=this.getBodyIndexByCol(e);return null==(r=this.records[o])?void 0:r[i]}if(this.dataset){let r,n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=null==(o=n.colHeaderPaths)?void 0:o.filter(e=>!e.virtual).map((e,t)=>{var o;return e.indicatorKey&&(r={position:"col",index:t}),null!=(o=e.indicatorKey)?o:e.value}),s=null==(i=n.rowHeaderPaths)?void 0:i.filter(e=>!e.virtual).map((e,t)=>{var o;return e.indicatorKey&&(r={position:"row",index:t}),null!=(o=e.indicatorKey)?o:e.value}),a=this.dataset.getAggregator(s,l,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,r);return a.value?a.value():void 0}if(this.flatDataToObjects){let r=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=r.colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),i=r.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=this.flatDataToObjects.getTreeNode(i,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return null==n?void 0:n.value}}getCellOriginRecord(e,t){var r,o,i;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){let o=this.getBodyIndexByRow(t),i=this.getBodyIndexByCol(e);return null==(r=this.records[o])?void 0:r[i]}if(this.dataset){let r,n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=null==(o=n.colHeaderPaths)?void 0:o.filter(e=>!e.virtual).map((e,t)=>{var o;return e.indicatorKey&&(r={position:"col",index:t}),null!=(o=e.indicatorKey)?o:e.value}),s=null==(i=n.rowHeaderPaths)?void 0:i.filter(e=>!e.virtual).map((e,t)=>{var o;return e.indicatorKey&&(r={position:"row",index:t}),null!=(o=e.indicatorKey)?o:e.value});return this.dataset.getAggregator(s,l,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,r).records}if(this.flatDataToObjects){let r=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=r.colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),i=r.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=this.flatDataToObjects.getTreeNode(i,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return null==n?void 0:n.record}}}getCellRawRecord(e,t){var r,o,i;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){let o=this.getBodyIndexByRow(t),i=this.getBodyIndexByCol(e);return null==(r=this.records[o])?void 0:r[i]}if(this.dataset){let r,n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),l=null==(o=n.colHeaderPaths)?void 0:o.filter(e=>!e.virtual).map((e,t)=>{var o;return e.indicatorKey&&(r={position:"col",index:t}),null!=(o=e.indicatorKey)?o:e.value}),s=null==(i=n.rowHeaderPaths)?void 0:i.filter(e=>!e.virtual).map((e,t)=>{var o;return e.indicatorKey&&(r={position:"row",index:t}),null!=(o=e.indicatorKey)?o:e.value});return this.dataset.getAggregator(s,l,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,r).records}if(this.flatDataToObjects){let r=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=r.colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),i=r.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=this.flatDataToObjects.getTreeNode(i,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return null==n?void 0:n.record}}}updateSortRules(e,t,r){this.internalProps.dataConfig?this.internalProps.dataConfig.sortRules=e:this.internalProps.dataConfig={sortRules:e},this.dataset.updateSortRules(e),this._changePivotSortStateBySortRules();let{layoutMap:o}=this.internalProps;o.resetHeaderTree(),this.scenegraph.clearCells(),(0,eT.Z)(t)&&(0,eT.Z)(r)?(this.isRowHeader(t,r)?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):this.isCornerHeader(t,r)?"column"===o.cornerSetting.titleOnDimension?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):"row"===o.cornerSetting.titleOnDimension&&this.internalProps._heightResizedRowMap.clear():this.isColumnHeader(t,r)&&this.internalProps._heightResizedRowMap.clear(),this.refreshRowColCount()):this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(!0),this.render()}_changePivotSortStateBySortRules(){var e,t,r,o;this.pivotSortState=[];let i=null!=(t=null==(e=this.internalProps.dataConfig)?void 0:e.sortRules)?t:[];for(let e=0;e<i.length;e++){let t=i[e],n=[];if(t.sortByIndicator&&t.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])){for(let e=0;e<t.query.length;e++)n.push({dimensionKey:this.dataset.indicatorsAsCol?this.dataset.columns[e]:this.dataset.rows[e],value:t.query[e]});n.push({indicatorKey:t.sortByIndicator,value:null!=(o=null==(r=this.internalProps.layoutMap.getIndicatorInfo(t.sortByIndicator))?void 0:r.title)?o:t.sortByIndicator})}else n.push({dimensionKey:t.sortField,isPivotCorner:!0,value:t.sortField});let l=t.sortType?t.sortType.toUpperCase():"ASC";this.pivotSortState.push({dimensions:n,order:H.F[l]})}}_parseColumnWidthConfig(e){for(let t=0;t<(null==e?void 0:e.length);t++){let r=e[t],o=r.dimensions,i=r.width,n=this.getCellAddressByHeaderPaths(o);if(n&&n.col>=this.rowHeaderLevelCount){let e=this.getCellHeaderPaths(n.col,this.columnHeaderLevelCount);if(e.colHeaderPaths.length===o.length){let t=!0;for(let r=0;r<o.length;r++){let i=o[r];if(0>e.colHeaderPaths.findIndex((e,t)=>e.indicatorKey===i.indicatorKey||e.dimensionKey===i.dimensionKey&&e.value===i.value)){t=!1;break}}t&&!this.internalProps._widthResizedColMap.has(n.col)&&(this._setColWidth(n.col,i),this.internalProps._widthResizedColMap.add(n.col))}}else n&&n.col<this.rowHeaderLevelCount&&(this.internalProps._widthResizedColMap.has(n.col)||(this._setColWidth(n.col,i),this.internalProps._widthResizedColMap.add(n.col)))}}_parseColumnWidthConfigForRowHeader(e){for(let t=0;t<(null==e?void 0:e.length);t++){let r=e[t],o=r.dimensions,i=r.width,n=this.getCellAddressByHeaderPaths(o);n&&n.col<this.rowHeaderLevelCount&&(this.internalProps._widthResizedColMap.has(n.col)||(this._setColWidth(n.col,i),this.internalProps._widthResizedColMap.add(n.col)))}}updatePivotSortState(e){this.pivotSortState=e}sort(e,t,r){var o,i;let n;if(this.isCornerHeader(e,t)){let r=this.getHeaderDefine(e,t);n=[];let o={isPivotCorner:!0,dimensionKey:r.value,value:r.value};n.push(o)}else n=this.isColumnHeader(e,t)?this.getCellHeaderPaths(e,t).colHeaderPaths:this.getCellHeaderPaths(e,t).rowHeaderPaths;let l=n[n.length-1].indicatorKey,s=this.getHeaderDefine(e,t);if(s.sort){if(this.dataset.sortRules){let e={};for(let t=this.dataset.sortRules.length-1;t>=0;t--){let r=this.dataset.sortRules[t];(s.dimensionKey&&r.sortField===s.dimensionKey||l&&r.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1]))&&(e[r.sortField]=r,this.dataset.sortRules.splice(t,1))}if(l){let t=this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1];this.dataset.sortRules.push({sortField:t,sortType:H.F[r],sortByIndicator:l,query:n.reduce((e,t)=>(t.dimensionKey&&e.push(t.value),e),[]),sortFunc:null==(o=e[t])?void 0:o.sortFunc})}else this.dataset.sortRules.push(Object.assign(null!=(i=e[s.dimensionKey])?i:{},{sortField:s.dimensionKey,sortType:H.F[r]}))}else this.dataset.sortRules=l?[{sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:H.F[r],sortByIndicator:l,query:n.reduce((e,t)=>(t.dimensionKey&&e.push(t.value),e),[])}]:[{sortField:s.dimensionKey,sortType:H.F[r]}];this.updateSortRules(this.dataset.sortRules,e,t)}}getPivotSortState(e,t){if(!this.pivotSortState)return;let r=this.getCellRange(e,t);for(let e=0;e<this.pivotSortState.length;e++){let t=this.pivotSortState[e],o=t.dimensions,i=this.getCellAddressByHeaderPaths(o),n=t.order;if(i&&(0,Q._Z)(r,i.col,i.row))return n}}_moveHeaderPosition(e,t){let r=this.getCellRange(e.col,e.row),o=this.getCellRange(t.col,t.row),i=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(i){if("column"===i.moveType){if(this.internalProps.recordsIsTwoDimensionalArray)for(let e=0;e<this.internalProps.records.length;e++){let t=this.internalProps.records[e].splice(i.sourceIndex-this.rowHeaderLevelCount,i.sourceSize);t.unshift(i.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[e],t)}this.colWidthsMap.exchangeOrder(r.start.col,r.end.col-r.start.col+1,o.start.col,o.end.col-o.start.col+1,i.targetIndex),this.setMinMaxLimitWidth()}else if("row"===i.moveType){if(this.internalProps.recordsIsTwoDimensionalArray){let e=this.internalProps.records.splice(i.sourceIndex-this.columnHeaderLevelCount,i.sourceSize);e.unshift(i.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,e)}i.targetIndex>i.sourceIndex?this.rowHeightsMap.exchangeOrder(i.sourceIndex,i.sourceSize,i.targetIndex+i.sourceSize-i.targetSize,i.targetSize,i.targetIndex):this.rowHeightsMap.exchangeOrder(i.sourceIndex,i.sourceSize,i.targetIndex,i.targetSize,i.targetIndex)}return i}return null}toggleHierarchyState(e,t,r=!0){this.internalProps.layoutMap.clearHeaderPathCache();let o=this.getHierarchyState(e,t);if(o===T.g.expand)this._refreshHierarchyState(e,t,r),this.fireListeners(eR.z.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:T.g.collapse});else if(o===T.g.collapse){let o=this.internalProps.layoutMap.getHeadNode(e,t);Array.isArray(o.children)&&this._refreshHierarchyState(e,t,r),this.fireListeners(eR.z.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:T.g.expand,originData:o})}}_refreshHierarchyState(e,t,r=!0,o){var i,n;this.frozenColCount,this.frozenRowCount;let l=this.getBodyVisibleRowRange().rowStart;this.internalProps._oldRowCount=this.rowCount,this.internalProps._oldColCount=this.colCount;let s=!1,a=!1;this.stateManager.updateHoverIcon(e,t,void 0,void 0);let u=this.internalProps.layoutMap.checkHasChart();u&&(this.autoFillWidth&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(a=this.getAllRowsHeight()<=this.tableNoFrameHeight));let h=this.internalProps.layoutMap.isRowHeader(e,t)?this.internalProps.layoutMap.toggleHierarchyState(e,t):this.internalProps.layoutMap.toggleHierarchyStateForColumnTree(e,t);o&&o(),this.refreshRowColCount(),this.frozenColCount,this.frozenRowCount,this.clearCellStyleCache(),"tree"===this.rowHierarchyType&&this.scenegraph.updateHierarchyIcon(e,t),null==(i=this.reactCustomLayout)||i.clearCache(),"grid-tree"!==this.rowHierarchyType&&"grid-tree"!==this.columnHierarchyType?this.scenegraph.updateRow(h.removeCellPositionsRowDirection,h.addCellPositionsRowDirection,h.updateCellPositionsRowDirection,r):(this.internalProps.stick.changedCells.clear(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.scrollToRow(l)),null==(n=this.reactCustomLayout)||n.updateAllCustomCell(),u&&(this.autoFillWidth&&!s&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!a&&(a=this.getAllRowsHeight()<=this.tableNoFrameHeight),("adaptive"===this.widthMode||s||"adaptive"===this.heightMode||a)&&this.scenegraph.updateChartSizeForResizeColWidth(-1)),this.internalProps._oldRowCount=void 0,this.internalProps._oldColCount=void 0}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var r;return null==(r=this._getHeaderLayoutMap(e,t))?void 0:r.hierarchyState}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}getMenuInfo(e,t,r){let o=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:o[o.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}setRecords(e){var t,r,o,i,n,l,s,a;(0,ed.H6)();let u={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e,this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(t=null==e?void 0:e[0])?void 0:t.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0);let h=this.options,d=this.internalProps;if(!1===(null==(r=this.options.customConfig)?void 0:r.enableDataAnalysis))!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new eb({rows:d.layoutMap.fullRowDimensionKeys,columns:d.layoutMap.colDimensionKeys,indicators:d.layoutMap.indicatorKeys,indicatorsAsCol:d.layoutMap.indicatorsAsCol,indicatorDimensionKey:d.layoutMap.indicatorDimensionKey},e));else{let t,r;this.dataset.setRecords(e),h.columnTree?t=d.layoutMap.columnDimensionTree:(!1!==h.indicatorsAsCol&&h.indicators&&this.dataset.colHeaderTree&&(0,k.uu)(this.dataset.colHeaderTree,h.indicators,!1,this),t=new W.KO(null!=(o=this.dataset.colHeaderTree)?o:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(i=this.options.columnExpandLevel)?i:1:void 0)),h.rowTree?r=d.layoutMap.rowDimensionTree:(!1===h.indicatorsAsCol&&this.dataset.rowHeaderTree&&h.indicators&&(0,k.uu)(this.dataset.rowHeaderTree,h.indicators,!1,this),r=new W.KO(null!=(n=this.dataset.rowHeaderTree)?n:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(l=this.options.rowExpandLevel)?l:1:void 0)),d.layoutMap=new eP.z(this,this.dataset,t,r),this.pivotSortState=[],h.pivotSortState&&(this.pivotSortState=h.pivotSortState)}if(this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(u.col,u.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder(),this.options.emptyTip)if(this.internalProps.emptyTip)null==(s=this.internalProps.emptyTip)||s.resetVisible();else{let e=el.F.getComponent("emptyTip");this.internalProps.emptyTip=new e(this.options.emptyTip,this),null==(a=this.internalProps.emptyTip)||a.resetVisible()}}startEditCell(e,t,r){var o;if((0,V.Z)(e)&&(0,V.Z)(t))this.eventManager.isDraging=!1,this.selectCell(e,t),this.editorManager.startEditCell(e,t,r);else if(null==(o=this.stateManager.select)?void 0:o.cellPos){let{col:e,row:t}=this.stateManager.select.cellPos;(0,V.Z)(e)&&(0,V.Z)(t)&&this.editorManager.startEditCell(e,t,r)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(e,t){var r,o,i;let n;if(this.isCornerHeader(e,t)){let o=this.getHeaderDefine(e,t);n=null!=(r=null==o?void 0:o.headerEditor)?r:this.options.headerEditor}else if(this.isHeader(e,t)){let r=this.getHeaderDefine(e,t);n=null!=(o=null==r?void 0:r.headerEditor)?o:this.options.headerEditor}else{let r=this.getBodyColumnDefine(e,t);n=null!=(i=null==r?void 0:r.editor)?i:this.options.editor}return"function"==typeof n&&(n=n({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),"string"==typeof n?Y.U(n):n}isHasEditorDefine(e,t){var r;let o=this.getBodyColumnDefine(e,t),i=null!=(r=null==o?void 0:o.editor)?r:this.options.editor;return"function"==typeof i&&(i=i({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),(0,V.Z)(i)}changeCellValue(e,t,r,o=!1){var i,n;if(o&&this.isHasEditorDefine(e,t)||!1===o){let o=r,l=this.getCellOriginValue(e,t),s=this.getCellRawValue(e,t);"number"==typeof s&&(0,er.Zf)(r)&&(o=parseFloat(r)),this._changeCellValueToDataSet(e,t,l,o);let a=this.getCellRange(e,t);for(let e=a.start.col;e<=a.end.col;e++)for(let t=a.start.row;t<=a.end.row;t++)this.scenegraph.updateCellContent(e,t);if(null!=(n=null==(i=this.options.dataConfig)?void 0:i.updateAggregationOnEditCell)&&n)for(let e=0;e<this.colCount;e++)for(let t=0;t<this.rowCount;t++)this.internalProps.layoutMap.isAggregation(e,t)&&this.scenegraph.updateCellContent(e,t);if("adaptive"===this.widthMode||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)0===this.internalProps._widthResizedColMap.size&&this.scenegraph.recalculateColWidths();else if(!this.internalProps._widthResizedColMap.has(e)){let t=this.getColWidth(e),r=(0,eu.al)(e,0,this.rowCount-1,this,!1);r!==t&&this.scenegraph.updateColWidth(e,r-t)}if("adaptive"===this.heightMode||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)0===this.internalProps._heightResizedRowMap.size&&this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight(t)&&!this.internalProps._heightResizedRowMap.has(t)){let e=this.getRowHeight(t),r=(0,et.P)(t,0,this.colCount-1,this);this.scenegraph.updateRowHeight(t,r-e)}l!==o&&this.fireListeners(q.B.CHANGE_CELL_VALUE,{col:e,row:t,rawValue:s,currentValue:l,changedValue:o}),this.scenegraph.updateNextFrame()}}changeCellValues(e,t,r,o=!1){var i,n;let l=e,s=t,a=[],u=[];for(let o=0;o<r.length&&!(t+o>this.rowCount-1);o++){let i=r[o],n=[],l=[];a.push(n),u.push(l);for(let r=0;r<i.length&&!(e+r>this.colCount-1);r++){let i=this.getCellRawValue(e+r,t+o);n.push(i);let s=this.getCellOriginValue(e+r,t+o);l.push(s)}}for(let i=0;i<r.length&&!(t+i>this.rowCount-1);i++){s=t+i;let n=r[i],h=e;for(let r=0;r<n.length&&!(e+r>this.colCount-1);r++)if(h=e+r,o&&this.isHasEditorDefine(e+r,t+i)||!1===o){let o=n[r],l=o,s=u[i][r],h=a[i][r];"number"==typeof h&&(0,er.Zf)(o)&&(l=parseFloat(o)),this._changeCellValueToDataSet(e+r,t+i,s,l);let d=this.getCellOriginValue(e+r,t+i);d!==s&&this.fireListeners(q.B.CHANGE_CELL_VALUE,{col:e+r,row:t+i,rawValue:h,currentValue:s,changedValue:d})}l=Math.max(l,h)}let h=this.getCellRange(e,t),d=this.getCellRange(l,s);for(let e=h.start.col;e<=d.end.col;e++)for(let t=h.start.row;t<=d.end.row;t++)this.scenegraph.updateCellContent(e,t);if(null!=(n=null==(i=this.options.dataConfig)?void 0:i.updateAggregationOnEditCell)&&n)for(let e=0;e<this.colCount;e++)for(let t=0;t<this.rowCount;t++)this.internalProps.layoutMap.isAggregation(e,t)&&this.scenegraph.updateCellContent(e,t);if("adaptive"===this.widthMode||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)0===this.internalProps._widthResizedColMap.size&&this.scenegraph.recalculateColWidths();else for(let t=e;t<=d.end.col;t++)if(!this.internalProps._widthResizedColMap.has(t)){let e=this.getColWidth(t),r=(0,eu.al)(t,0,this.rowCount-1,this,!1);r!==e&&this.scenegraph.updateColWidth(t,r-e)}if("adaptive"===this.heightMode||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight(t)){let e=[],r=[];for(let o=t;o<=d.end.row;o++)if(this.rowHeightsMap.get(o)){let t=this.getRowHeight(o),i=(0,et.P)(o,0,this.colCount-1,this);e.push(o),r.push(i-t)}this.scenegraph.updateRowsHeight(e,r)}this.scenegraph.updateNextFrame()}_changeCellValueToDataSet(e,t,r,o){var i,n,l,s,a,u,h,d;if(this.internalProps.recordsIsTwoDimensionalArray){let r=this.getBodyIndexByRow(t),i=this.getBodyIndexByCol(e);this.records[r][i]=o}else if(this.dataset){let u=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isCornerHeader(e,t))this.internalProps.layoutMap.changeCornerTitle(e,t,o);else if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,o),this.isCornerHeader(e,t)||this.dataset.changeRecordFieldValue((null==(i=u.colHeaderPaths)?void 0:i.length)?null!=(n=u.colHeaderPaths[u.colHeaderPaths.length-1].indicatorKey)?n:u.colHeaderPaths[u.colHeaderPaths.length-1].dimensionKey:null!=(l=u.rowHeaderPaths[u.rowHeaderPaths.length-1].indicatorKey)?l:u.rowHeaderPaths[u.rowHeaderPaths.length-1].dimensionKey,r,o);else{let r=null==(s=u.colHeaderPaths)?void 0:s.filter(e=>!e.virtual).map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),i=null==(a=u.rowHeaderPaths)?void 0:a.filter(e=>!e.virtual).map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value});this.dataset.changeTreeNodeValue(this.internalProps.layoutMap.indicatorsAsCol?i:i.slice(0,-1),this.internalProps.layoutMap.indicatorsAsCol?r.slice(0,-1):r,this.internalProps.layoutMap.getIndicatorKey(e,t),o)}}else if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,o),this.isCornerHeader(e,t)||this.flatDataToObjects.changeRecordFieldValue((null==(u=i.colHeaderPaths)?void 0:u.length)?null!=(h=i.colHeaderPaths[i.colHeaderPaths.length-1].indicatorKey)?h:i.colHeaderPaths[i.colHeaderPaths.length-1].dimensionKey:null!=(d=i.rowHeaderPaths[i.rowHeaderPaths.length-1].indicatorKey)?d:i.rowHeaderPaths[i.rowHeaderPaths.length-1].dimensionKey,r,o);else{let r=i.colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=i.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value});this.flatDataToObjects.changeTreeNodeValue(n,r,this.internalProps.layoutMap.getBody(e,t).indicatorKey,o)}}}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;let{columnsDefine:e,rowsDefine:t,indicatorsDefine:r}=this.internalProps.layoutMap;for(let t=0;t<e.length;t++){let r=e[t];if("string"!=typeof r&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let e=0;e<t.length;e++){let r=t[e];if("string"!=typeof r&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let e=0;e<r.length;e++){let t=r[e];if("string"!=typeof t&&(t.customLayout||t.headerCustomLayout||t.customRender||t.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}setTreeNodeChildren(e,t,r,o){this.flatDataToObjects?(this.internalProps.layoutMap.getHeadNode(r,o).children=e,this._refreshHierarchyState(r,o,!0,()=>{this.flatDataToObjects.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey}),this.flatDataToObjects.addRecords(t)})):(this.internalProps.layoutMap.getHeadNode(r,o).children=e,this._refreshHierarchyState(r,o,!0,()=>{this.dataset._rowTreeHasChanged(),this.dataset.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys}),this.dataset.addRecords(t)}))}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),this.renderWithRecreateCells()}getFilteredRecords(){var e;return null==(e=this.dataset)?void 0:e.filterRules}getCellPivotRole(e,t){let{cellLocation:r,colHeaderPaths:o,rowHeaderPaths:i}=this.getCellHeaderPaths(e,t),n=o.length?"normal":void 0,l=i.length?"normal":void 0;return o.forEach(e=>{"sub-total"===e.role?n="sub-total":"grand-total"===e.role&&(n="grand-total")}),i.forEach(e=>{"sub-total"===e.role?l="sub-total":"grand-total"===e.role&&(l="grand-total")}),{colRole:n,rowRole:l,cellLocation:r}}setLoadingHierarchyState(e,t){this.scenegraph.setLoadingHierarchyState(e,t)}expandAllForRowTree(){"tree"!==this.rowHierarchyType&&"grid-tree"!==this.rowHierarchyType||this.internalProps.layoutMap.rowDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.expandAllForRowDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(eR.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:T.g.expand,changeAll:!0}))}collapseAllForRowTree(){"tree"!==this.rowHierarchyType&&"grid-tree"!==this.rowHierarchyType||this.internalProps.layoutMap.rowDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.collapseAllForRowDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(eR.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:T.g.collapse,changeAll:!0}))}expandAllForColumnTree(){"grid-tree"===this.columnHierarchyType&&this.internalProps.layoutMap.columnDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.expandAllForColumnDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(eR.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:T.g.expand,changeAll:!0}))}collapseAllForColumnTree(){"grid-tree"===this.columnHierarchyType&&this.internalProps.layoutMap.columnDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.collapseAllForColumnDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(eR.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:T.g.collapse,changeAll:!0}))}release(){this.internalProps.layoutMap.clearHeaderPathCache(),this.editorManager.release(),super.release()}}(0,ep.R2)(),(0,ep.Eg)(),(0,ep.I)(),(0,ep.FD)(),(0,ep._t)(),(0,ep.Mh)(),(0,ep.ph)(),(0,ey.yR)(),(0,ey.pk)(),(0,ey.m4)(),(0,ey.Jy)(),(0,ey.dB)(),(0,ey.ge)(),(0,ey.au)();class eA extends eM{}(0,ey.ge)();class ex extends eM{}var e_=r(75747),eI=r(21054);class eF extends eI.C{constructor(e){var t,r,o,i,n,l,s,a,u,h;let d=(0,G.Z)(e.boundsPadding),c=[null!=(r=null!=(t=e.marginTop)?t:d?e.boundsPadding[0]:e.boundsPadding)?r:0,null!=(i=null!=(o=e.marginRight)?o:d?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(s=null!=(n=e.marginBottom)?n:d?null!=(l=e.boundsPadding[2])?l:e.boundsPadding[0]:e.boundsPadding)?s:0,null!=(h=null!=(a=e.marginLeft)?a:d?null!=(u=e.boundsPadding[3])?u:e.boundsPadding[1]:e.boundsPadding)?h:0];e.boundsPadding=c,super(e)}}var eO=r(53068);class eE extends eO.ZA{constructor(e){var t,r,o,i,n,l,s,a,u,h,d,c,p,g;e.direction&&(e.flexDirection=e.direction),e.justifyContent&&("start"===e.justifyContent||"end"===e.justifyContent)&&(e.justifyContent="flex-"+e.justifyContent),e.alignItems&&("start"===e.alignItems||"end"===e.alignItems)&&(e.alignItems="flex-"+e.alignItems),e.alignContent&&("start"===e.alignContent||"end"===e.alignContent)&&(e.alignContent="flex-"+e.alignContent),e.display="flex",e.flexDirection||(e.flexDirection="row"),e.clip=!0,e.fill=null==(t=null==e?void 0:e.background)?void 0:t.fill,e.stroke=null==(r=null==e?void 0:e.background)?void 0:r.stroke,e.lineWidth=null==(o=null==e?void 0:e.background)?void 0:o.lineWidth,e.cornerRadius=null==(i=null==e?void 0:e.background)?void 0:i.cornerRadius;let C=(0,G.Z)(e.boundsPadding),f=[null!=(l=null!=(n=e.marginTop)?n:C?e.boundsPadding[0]:e.boundsPadding)?l:0,null!=(a=null!=(s=e.marginRight)?s:C?e.boundsPadding[1]:e.boundsPadding)?a:0,null!=(d=null!=(u=e.marginBottom)?u:C?null!=(h=e.boundsPadding[2])?h:e.boundsPadding[0]:e.boundsPadding)?d:0,null!=(g=null!=(c=e.marginLeft)?c:C?null!=(p=e.boundsPadding[3])?p:e.boundsPadding[1]:e.boundsPadding)?g:0];e.boundsPadding=f,super(e)}}class eB extends eE{constructor(e){e.flexWrap="nowrap",super(e)}}var eN=r(19427);class eL extends eN.E{constructor(e){var t,r,o,i,n,l,s,a,u,h,d,c;let p;(0,es.Z)(e.iconName)&&(p=F.U2()[e.iconName])&&(e.width=null!=(t=e.width)?t:p.width,e.height=null!=(r=e.height)?r:p.height,e.svg=p.svg,e.cursor=p.cursor),e.svg&&(e.image=e.svg);let g=(0,G.Z)(e.boundsPadding),C=[null!=(i=null!=(o=e.marginTop)?o:g?e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(l=null!=(n=e.marginRight)?n:g?e.boundsPadding[1]:e.boundsPadding)?l:0,null!=(u=null!=(s=e.marginBottom)?s:g?null!=(a=e.boundsPadding[2])?a:e.boundsPadding[0]:e.boundsPadding)?u:0,null!=(c=null!=(h=e.marginLeft)?h:g?null!=(d=e.boundsPadding[3])?d:e.boundsPadding[1]:e.boundsPadding)?c:0];e.boundsPadding=C,super(e),this.cache=p}}class ez extends eN.E{constructor(e){var t,r,o,i,n,l,s,a,u,h;e.src&&(e.image=e.src),"circle"===e.shape&&(e.cornerRadius=e.width/2);let d=(0,G.Z)(e.boundsPadding),c=[null!=(r=null!=(t=e.marginTop)?t:d?e.boundsPadding[0]:e.boundsPadding)?r:0,null!=(i=null!=(o=e.marginRight)?o:d?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(s=null!=(n=e.marginBottom)?n:d?null!=(l=e.boundsPadding[2])?l:e.boundsPadding[0]:e.boundsPadding)?s:0,null!=(h=null!=(a=e.marginLeft)?a:d?null!=(u=e.boundsPadding[3])?u:e.boundsPadding[1]:e.boundsPadding)?h:0];e.boundsPadding=c,super(e)}}class eD extends ef.U{constructor(e){var t,r,o,i,n,l,s,a,u,h;let d=(0,G.Z)(e.boundsPadding),c=[null!=(r=null!=(t=e.marginTop)?t:d?e.boundsPadding[0]:e.boundsPadding)?r:0,null!=(i=null!=(o=e.marginRight)?o:d?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(s=null!=(n=e.marginBottom)?n:d?null!=(l=e.boundsPadding[2])?l:e.boundsPadding[0]:e.boundsPadding)?s:0,null!=(h=null!=(a=e.marginLeft)?a:d?null!=(u=e.boundsPadding[3])?u:e.boundsPadding[1]:e.boundsPadding)?h:0];e.boundsPadding=c,super(e)}}var eV=r(29411);class eK extends eV.x{constructor(e){var t,r,o,i,n,l,s,a,u,h,d;e.textBaseline||(e.textBaseline="top");let c=(0,G.Z)(e.boundsPadding),p=[null!=(r=null!=(t=e.marginTop)?t:c?e.boundsPadding[0]:e.boundsPadding)?r:0,null!=(i=null!=(o=e.marginRight)?o:c?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(s=null!=(n=e.marginBottom)?n:c?null!=(l=e.boundsPadding[2])?l:e.boundsPadding[0]:e.boundsPadding)?s:0,null!=(h=null!=(a=e.marginLeft)?a:c?null!=(u=e.boundsPadding[3])?u:e.boundsPadding[1]:e.boundsPadding)?h:0];e.boundsPadding=p,e.fill=null!=(d=e.fill)?d:"#000",super(e)}getSize(e){this.AABBBounds.width()}}function ej(e,t=0){return{percent:e,delta:t}}var ek=r(11971);class eW extends ek.w{constructor(e){var t,r,o,i,n,l,s,a,u,h;let d=(0,G.Z)(e.boundsPadding),c=[null!=(r=null!=(t=e.marginTop)?t:d?e.boundsPadding[0]:e.boundsPadding)?r:0,null!=(i=null!=(o=e.marginRight)?o:d?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(s=null!=(n=e.marginBottom)?n:d?null!=(l=e.boundsPadding[2])?l:e.boundsPadding[0]:e.boundsPadding)?s:0,null!=(h=null!=(a=e.marginLeft)?a:d?null!=(u=e.boundsPadding[3])?u:e.boundsPadding[1]:e.boundsPadding)?h:0];e.boundsPadding=c,super(e)}}var eZ=r(46293);class eG extends eZ.V{constructor(e){var t,r,o,i,n,l,s,a,u,h;let d=(0,G.Z)(e.boundsPadding),c=[null!=(r=null!=(t=e.marginTop)?t:d?e.boundsPadding[0]:e.boundsPadding)?r:0,null!=(i=null!=(o=e.marginRight)?o:d?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(s=null!=(n=e.marginBottom)?n:d?null!=(l=e.boundsPadding[2])?l:e.boundsPadding[0]:e.boundsPadding)?s:0,null!=(h=null!=(a=e.marginLeft)?a:d?null!=(u=e.boundsPadding[3])?u:e.boundsPadding[1]:e.boundsPadding)?h:0];e.boundsPadding=c,super(e)}getSize(e){this.AABBBounds.width()}}class e$ extends eO.ZA{constructor(e){var t,r,o,i,n,l,s,a,u,h;let d=(0,G.Z)(e.boundsPadding),c=[null!=(r=null!=(t=e.marginTop)?t:d?e.boundsPadding[0]:e.boundsPadding)?r:0,null!=(i=null!=(o=e.marginRight)?o:d?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(s=null!=(n=e.marginBottom)?n:d?null!=(l=e.boundsPadding[2])?l:e.boundsPadding[0]:e.boundsPadding)?s:0,null!=(h=null!=(a=e.marginLeft)?a:d?null!=(u=e.boundsPadding[3])?u:e.boundsPadding[1]:e.boundsPadding)?h:0];e.boundsPadding=c,super(e)}}var eq=r(73208),eJ=r(74294),eY=r(66707),eU=r(85021);function eQ(e,t,r){var o,i;let n=function(e){var t,r,o,i,n,l,s,a,u,h,d;let c,p,g,C,f={seqId:0},m={isPivotChart:!0};e.columnTree&&(!1!==e.indicatorsAsCol&&(g=(0,k.VN)(e.columnTree,e.indicators)),c=new W.KO(null!=(t=e.columnTree)?t:[],f)),e.rowTree&&(!1===e.indicatorsAsCol&&(C=(0,k.VN)(e.rowTree,e.indicators)),p=new W.KO(null!=(r=e.rowTree)?r:[],f));let y=(null==(o=p.dimensionKeys)?void 0:o.count)?p.dimensionKeys.valueArr():null!=(n=null==(i=e.rows)?void 0:i.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?n:[],w=(null==(l=c.dimensionKeys)?void 0:l.count)?c.dimensionKeys.valueArr():null!=(a=null==(s=e.columns)?void 0:s.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?a:[],v=null!=(h=null==(u=e.indicators)?void 0:u.reduce((e,t)=>("string"==typeof t?e.push(t):e.push(t.indicatorKey),e),[]))?h:[];return m.collectValuesBy=function(e,t,r){var o,i,n,l,s,a,u,h,d,c,p,g,C,f,m,y,w,v,P,b,R,S,H;let T={};for(let M=0,A=null==(o=e.indicators)?void 0:o.length;M<A;M++)if("string"!=typeof e.indicators[M]&&e.indicators[M].chartSpec)if(!1===e.indicatorsAsCol){let o=e.indicators[M];if(T[o.indicatorKey]={by:r,range:!0,sumBy:!1!==(null==(i=o.chartSpec)?void 0:i.stack)&&t.concat(null==(n=o.chartSpec)?void 0:n.xField)},o.chartSpec.series)o.chartSpec.series.forEach(e=>{var i,n,l,s,a,u,h,d,c,p,g,C,f,m,y,w;let v="string"==typeof e.xField?e.xField:e.xField[0];T[v]={by:t,type:"horizontal"!==e.direction?"xField":void 0,range:"horizontal"===e.direction,sortBy:"horizontal"!==e.direction?null!=(s=null==(l=null==(n=null==(i=null==e?void 0:e.data)?void 0:i.fields)?void 0:n[v])?void 0:l.domain)?s:null==(d=null==(h=null==(u=null==(a=o.chartSpec)?void 0:a.data)?void 0:u.fields)?void 0:h[v])?void 0:d.domain:void 0};let P=e.yField;T[P]={by:r,range:"horizontal"!==e.direction,sumBy:!1!==e.stack&&t.concat(null==e?void 0:e.xField),sortBy:"horizontal"===e.direction?null!=(C=null==(g=null==(p=null==(c=null==e?void 0:e.data)?void 0:c.fields)?void 0:p[P])?void 0:g.domain)?C:null==(w=null==(y=null==(m=null==(f=o.chartSpec)?void 0:f.data)?void 0:m.fields)?void 0:y[P])?void 0:w.domain:void 0}});else{let i="string"==typeof o.chartSpec.xField?o.chartSpec.xField:o.chartSpec.xField[0];T[i]={by:t,type:"horizontal"!==o.chartSpec.direction?"xField":void 0,range:"horizontal"===o.chartSpec.direction,sortBy:"horizontal"!==o.chartSpec.direction?null==(u=null==(a=null==(s=null==(l=o.chartSpec)?void 0:l.data)?void 0:s.fields)?void 0:a[i])?void 0:u.domain:void 0};let n=o.chartSpec.yField;T[n]={by:r,range:"horizontal"!==e.indicators[M].chartSpec.direction,sumBy:!1!==o.chartSpec.stack&&t.concat(null==(h=o.chartSpec)?void 0:h.xField),sortBy:"horizontal"===o.chartSpec.direction?null==(g=null==(p=null==(c=null==(d=o.chartSpec)?void 0:d.data)?void 0:c.fields)?void 0:p[n])?void 0:g.domain:void 0}}}else{let o=e.indicators[M];if(T[o.indicatorKey]={by:t,range:!0,sumBy:!1!==(null==(C=o.chartSpec)?void 0:C.stack)&&r.concat(null==(f=o.chartSpec)?void 0:f.yField)},o.chartSpec.series)o.chartSpec.series.forEach(e=>{var i,n,l,s,a,u,h,d,c,p,g,C,f,m,y,w;let v="string"==typeof e.yField?e.yField:e.yField[0];T[v]={by:r,type:"horizontal"===e.direction?"yField":void 0,range:"horizontal"!==e.direction,sortBy:"horizontal"===e.direction?null!=(s=null==(l=null==(n=null==(i=null==e?void 0:e.data)?void 0:i.fields)?void 0:n[v])?void 0:l.domain)?s:null==(d=null==(h=null==(u=null==(a=o.chartSpec)?void 0:a.data)?void 0:u.fields)?void 0:h[v])?void 0:d.domain:void 0};let P=e.xField;T[P]={by:t,range:"horizontal"===e.direction,sumBy:!1!==e.stack&&r.concat(null==e?void 0:e.yField),sortBy:"horizontal"!==e.direction?null!=(C=null==(g=null==(p=null==(c=null==e?void 0:e.data)?void 0:c.fields)?void 0:p[P])?void 0:g.domain)?C:null==(w=null==(y=null==(m=null==(f=o.chartSpec)?void 0:f.data)?void 0:m.fields)?void 0:y[P])?void 0:w.domain:void 0}});else{let i="string"==typeof o.chartSpec.yField?o.chartSpec.yField:o.chartSpec.yField[0];T[i]={by:r,type:"horizontal"===o.chartSpec.direction?"yField":void 0,range:"horizontal"!==o.chartSpec.direction,sortBy:"horizontal"===o.chartSpec.direction?null==(v=null==(w=null==(y=null==(m=o.chartSpec)?void 0:m.data)?void 0:y.fields)?void 0:w[i])?void 0:v.domain:void 0};let n=o.chartSpec.xField;T[n]={by:t,range:"horizontal"===e.indicators[M].chartSpec.direction,sumBy:!1!==o.chartSpec.stack&&r.concat(null==(P=o.chartSpec)?void 0:P.yField),sortBy:"horizontal"!==o.chartSpec.direction?null==(H=null==(S=null==(R=null==(b=o.chartSpec)?void 0:b.data)?void 0:R.fields)?void 0:S[n])?void 0:H.domain:void 0}}}return T}(e,w,y),m.aggregationRules=function(e){var t;let r=[];return null==(t=e.indicators)||t.forEach(t=>{var o,i;if("string"==typeof t)r.push({indicatorKey:t,field:t,aggregationType:H.E.RECORD});else if(null==(o=t.chartSpec)?void 0:o.series){let o=[];null==(i=t.chartSpec)||i.series.forEach(t=>{let r=!1===e.indicatorsAsCol?t.yField:t.xField;-1===o.indexOf(r)&&o.push(r)}),r.push({indicatorKey:t.indicatorKey,field:o,aggregationType:H.E.RECORD})}else{let o=!1===e.indicatorsAsCol?t.chartSpec.yField:t.chartSpec.xField;r.push({indicatorKey:t.indicatorKey,field:null!=o?o:t.indicatorKey,aggregationType:H.E.RECORD})}}),r}(e),{dataset:new eS.q(m,y,w,v,e.indicators,null==(d=e.indicatorsAsCol)||d,e.records,void 0,void 0,g||e.columnTree,C||e.rowTree,!0),columnDimensionTree:c,rowDimensionTree:p,layoutNodeId:f}}(e),l=n.columnDimensionTree,s=n.rowDimensionTree,a=!1,u=!1;e.columnTree&&e.indicatorsAsCol&&!l.dimensionKeys.contain(K.ek)&&(a=!0),e.rowTree&&(e.indicatorsAsCol||s.dimensionKeys.contain(K.ek)||(u=!0));let{dataset:h,layoutNodeId:d}=n;e.columnTree&&!a||(l=new W.KO(null!=(o=h.colHeaderTree)?o:[],d)),e.rowTree&&!u||(s=new W.KO(null!=(i=h.rowHeaderTree)?i:[],d));let c=new eP.z({options:e,layoutNodeId:d,internalProps:e,isPivotChart:()=>!0,pivotChartAxes:[],_selectedDataItemsInChart:[],_getActiveChartInstance:()=>({updateState:()=>{}})},h,l,s);for(let e=0;e<c.colCount;e++)for(let o=0;o<c.rowCount;o++){if(c.isHeader(e,o))continue;let i=c.getCellHeaderPaths(e,o),n=i.colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),l=i.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),s=h.getAggregator(c.indicatorsAsCol?l:l.slice(0,-1),c.indicatorsAsCol?n.slice(0,-1):n,c.getIndicatorKey(e,o)),a=function(e,t,r,o,i,n){if((0,G.Z)(e))for(let a=0;a<e.length;a++){var l,s;if(n?n(e[a],t):(l=e[a],s=t,JSON.stringify(l)===JSON.stringify(s)))return i.getCellHeaderPaths(r,o)}}(s.value?s.value():void 0,t,e,o,c,r);if(a)return a}}var eX=r(52812),e0=r(31535),e1=r(30756),e2=r(20672),e4=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&0>t.indexOf(o)&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)0>t.indexOf(o[i])&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(r[o[i]]=e[o[i]])}return r};function e5(e,t,...r){let o=t||{},{key:i,name:n,id:l,attribute:s,stateProxy:a,animation:u,timeline:h}=o,d=e4(o,["key","name","id","attribute","stateProxy","animation","timeline"]),c=e;(0,e1.Z)(e)&&(c=e2.i[e]);let p=[];r.length&&function e(t,r){if((0,e0.Z)(t))return t.forEach(t=>e(t,r));r.push(t)}(1===r.length?r[0]:r,p);let g="Group"===c.name?new c(s):c(t);if(function(e,t,r){let o,i=!1;switch(e.type){case"richtext":case"rich/image":break;case"rich/text":o=e.attribute||{},t[0]&&(o.text=t[0]);break;default:i=!0}i?(t.forEach(t=>{t&&e.add(t)}),Object.keys(r).forEach(t=>{let o=eX.Nv[t];o&&e.on(o,r[t])})):"richtext"===e.type&&(e.attribute.textConfig=t.map(e=>e.attribute).filter(e=>e))}(g,p,d),a&&(g.stateProxy=a),n&&(g.name=n),(0,e0.Z)(u)){let e=g.animate();h&&e.setTimeline(h),u.forEach(t=>{e[t[0]](...t.slice(1))})}return g}function e7(e){return new eZ.V(e?e.attribute:{})}function e3(e){return new eJ.J(e?e.attribute:{})}function e6(e){return new eY.Y(e?e.attribute:{})}var e9=r(1669),e8=r(31150);(0,P.sTO)();let te="1.19.4";function tt(){return F.U2()}function tr(){O.clearAll()}H.E;let to=new Map;to.set("react",y),to.set("@visactor/vchart",w),to.set("@visactor/vseed",v),to.set("@visactor/vtable",g);let ti=function(e,t){if(!to.has(e))throw Error("Module "+e+" not found");let r=to.get(e);return t&&"object"==typeof r&&r.default||r};function tn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function tl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(r),!0).forEach(function(t){var o;o=r[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tn(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}function ta(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function tu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ta(Object(r),!0).forEach(function(t){var o;o=r[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ta(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function th(e){return function t(){for(var r=this,o=arguments.length,i=Array(o),n=0;n<o;n++)i[n]=arguments[n];return i.length>=e.length?e.apply(this,i):function(){for(var e=arguments.length,o=Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.apply(r,[].concat(i,o))}}}function td(e){return({}).toString.call(e).includes("Object")}function tc(e){return"function"==typeof e}var tp=th(function(e,t){throw Error(e[t]||e.default)})({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),tg=function(e,t){return td(t)||tp("changeType"),Object.keys(t).some(function(t){return!Object.prototype.hasOwnProperty.call(e,t)})&&tp("changeField"),t},tC=function(e){tc(e)||tp("selectorType")},tf=function(e){tc(e)||td(e)||tp("handlerType"),td(e)&&Object.values(e).some(function(e){return!tc(e)})&&tp("handlersType")},tm=function(e){e||tp("initialIsRequired"),td(e)||tp("initialType"),Object.keys(e).length||tp("initialContent")};function ty(e,t){return tc(t)?t(e.current):t}function tw(e,t){return e.current=tu(tu({},e.current),t),t}function tv(e,t,r){return tc(t)?t(e.current):Object.keys(r).forEach(function(r){var o;return null==(o=t[r])?void 0:o.call(t,e.current[r])}),r}var tP={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},tb=(l=function(e,t){throw Error(e[t]||e.default)},function e(){for(var t=this,r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return o.length>=l.length?l.apply(this,o):function(){for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];return e.apply(t,[].concat(o,i))}})(tP);let tR=function(e){return(e||tb("configIsRequired"),({}).toString.call(e).includes("Object")||tb("configType"),e.urls)?(console.warn(tP.deprecation),{paths:{vs:e.urls.monacoBase}}):e},tS=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}};var tH={type:"cancelation",msg:"operation is manually canceled"};let tT=function(e){var t=!1,r=new Promise(function(r,o){e.then(function(e){return t?o(tH):r(e)}),e.catch(o)});return r.cancel=function(){return t=!0},r};var tM=function(e){if(Array.isArray(e))return e}(s=({create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};tm(e),tf(t);var r={current:e},o=th(tv)(r,t),i=th(tw)(r),n=th(tg)(e),l=th(ty)(r);return[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return tC(e),e(r.current)},function(e){(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}})(o,i,n,l)(e)}]}}).create({config:{paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}},isInitialized:!1,resolve:null,reject:null,monaco:null}))||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],o=!0,i=!1,n=void 0;try{for(var l,s=e[Symbol.iterator]();!(o=(l=s.next()).done)&&(r.push(l.value),r.length!==t);o=!0);}catch(e){i=!0,n=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw n}}return r}}(s,2)||function(e,t){if(e){if("string"==typeof e)return ts(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ts(e,t)}}(s,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),tA=tM[0],tx=tM[1];function t_(e){return document.body.appendChild(e)}function tI(e){var t,r,o=tA(function(e){return{config:e.config,reject:e.reject}}),i=(t="".concat(o.config.paths.vs,"/loader.js"),r=document.createElement("script"),t&&(r.src=t),r);return i.onload=function(){return e()},i.onerror=o.reject,i}function tF(){var e=tA(function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(t){tO(t),e.resolve(t)},function(t){e.reject(t)})}function tO(e){tA().monaco||tx({monaco:e})}var tE=new Promise(function(e,t){return tx({resolve:e,reject:t})});let tB=function(){var e=tA(function(e){return{monaco:e.monaco,isInitialized:e.isInitialized,resolve:e.resolve}});if(!e.isInitialized){if(tx({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),tT(tE);if(window.monaco&&window.monaco.editor)return tO(window.monaco),e.resolve(window.monaco),tT(tE);tS(t_,tI)(tF)}return tT(tE)};var tN={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},tL={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},tz=function({children:e}){return m.createElement("div",{style:tL},e)},tD=(0,m.memo)(function({width:e,height:t,isEditorReady:r,loading:o,_ref:i,className:n,wrapperProps:l}){return m.createElement("section",{style:{...tN.wrapper,width:e,height:t},...l},!r&&m.createElement(tz,null,o),m.createElement("div",{ref:i,style:{...tN.fullWidth,...!r&&tN.hide},className:n}))}),tV=function(e){(0,m.useEffect)(e,[])},tK=function(e,t,r=!0){let o=(0,m.useRef)(!0);(0,m.useEffect)(o.current||!r?()=>{o.current=!1}:e,t)};function tj(){}function tk(e,t,r,o){var i,n,l,s,a,u;return i=e,n=o,i.editor.getModel(tW(i,n))||(l=e,s=t,a=r,u=o,l.editor.createModel(s,a,u?tW(l,u):void 0))}function tW(e,t){return e.Uri.parse(t)}(0,m.memo)(function({original:e,modified:t,language:r,originalLanguage:o,modifiedLanguage:i,originalModelPath:n,modifiedModelPath:l,keepCurrentOriginalModel:s=!1,keepCurrentModifiedModel:a=!1,theme:u="light",loading:h="Loading...",options:d={},height:c="100%",width:p="100%",className:g,wrapperProps:C={},beforeMount:f=tj,onMount:y=tj}){let[w,v]=(0,m.useState)(!1),[P,b]=(0,m.useState)(!0),R=(0,m.useRef)(null),S=(0,m.useRef)(null),H=(0,m.useRef)(null),T=(0,m.useRef)(y),M=(0,m.useRef)(f),A=(0,m.useRef)(!1);tV(()=>{let e=tB();return e.then(e=>(S.current=e)&&b(!1)).catch(e=>e?.type!=="cancelation"&&console.error("Monaco initialization: error:",e)),()=>{let t;return R.current?(t=R.current?.getModel(),void(s||t?.original?.dispose(),a||t?.modified?.dispose(),R.current?.dispose())):e.cancel()}}),tK(()=>{if(R.current&&S.current){let t=R.current.getOriginalEditor(),i=tk(S.current,e||"",o||r||"text",n||"");i!==t.getModel()&&t.setModel(i)}},[n],w),tK(()=>{if(R.current&&S.current){let e=R.current.getModifiedEditor(),o=tk(S.current,t||"",i||r||"text",l||"");o!==e.getModel()&&e.setModel(o)}},[l],w),tK(()=>{let e=R.current.getModifiedEditor();e.getOption(S.current.editor.EditorOption.readOnly)?e.setValue(t||""):t!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),e.pushUndoStop())},[t],w),tK(()=>{R.current?.getModel()?.original.setValue(e||"")},[e],w),tK(()=>{let{original:e,modified:t}=R.current.getModel();S.current.editor.setModelLanguage(e,o||r||"text"),S.current.editor.setModelLanguage(t,i||r||"text")},[r,o,i],w),tK(()=>{S.current?.editor.setTheme(u)},[u],w),tK(()=>{R.current?.updateOptions(d)},[d],w);let x=(0,m.useCallback)(()=>{if(!S.current)return;M.current(S.current);let s=tk(S.current,e||"",o||r||"text",n||""),a=tk(S.current,t||"",i||r||"text",l||"");R.current?.setModel({original:s,modified:a})},[r,t,i,e,o,n,l]),_=(0,m.useCallback)(()=>{!A.current&&H.current&&(R.current=S.current.editor.createDiffEditor(H.current,{automaticLayout:!0,...d}),x(),S.current?.editor.setTheme(u),v(!0),A.current=!0)},[d,u,x]);return(0,m.useEffect)(()=>{w&&T.current(R.current,S.current)},[w]),(0,m.useEffect)(()=>{P||w||_()},[P,w,_]),m.createElement(tD,{width:p,height:c,isEditorReady:w,loading:h,_ref:H,className:g,wrapperProps:C})});var tZ=function(e){let t=(0,m.useRef)();return(0,m.useEffect)(()=>{t.current=e},[e]),t.current},tG=new Map,t$=(0,m.memo)(function({defaultValue:e,defaultLanguage:t,defaultPath:r,value:o,language:i,path:n,theme:l="light",line:s,loading:a="Loading...",options:u={},overrideServices:h={},saveViewState:d=!0,keepCurrentModel:c=!1,width:p="100%",height:g="100%",className:C,wrapperProps:f={},beforeMount:y=tj,onMount:w=tj,onChange:v,onValidate:P=tj}){let[b,R]=(0,m.useState)(!1),[S,H]=(0,m.useState)(!0),T=(0,m.useRef)(null),M=(0,m.useRef)(null),A=(0,m.useRef)(null),x=(0,m.useRef)(w),_=(0,m.useRef)(y),I=(0,m.useRef)(),F=(0,m.useRef)(o),O=tZ(n),E=(0,m.useRef)(!1),B=(0,m.useRef)(!1);tV(()=>{let e=tB();return e.then(e=>(T.current=e)&&H(!1)).catch(e=>e?.type!=="cancelation"&&console.error("Monaco initialization: error:",e)),()=>M.current?void(I.current?.dispose(),c?d&&tG.set(n,M.current.saveViewState()):M.current.getModel()?.dispose(),M.current.dispose()):e.cancel()}),tK(()=>{let l=tk(T.current,e||o||"",t||i||"",n||r||"");l!==M.current?.getModel()&&(d&&tG.set(O,M.current?.saveViewState()),M.current?.setModel(l),d&&M.current?.restoreViewState(tG.get(n)))},[n],b),tK(()=>{M.current?.updateOptions(u)},[u],b),tK(()=>{M.current&&void 0!==o&&(M.current.getOption(T.current.editor.EditorOption.readOnly)?M.current.setValue(o):o!==M.current.getValue()&&(B.current=!0,M.current.executeEdits("",[{range:M.current.getModel().getFullModelRange(),text:o,forceMoveMarkers:!0}]),M.current.pushUndoStop(),B.current=!1))},[o],b),tK(()=>{let e=M.current?.getModel();e&&i&&T.current?.editor.setModelLanguage(e,i)},[i],b),tK(()=>{void 0!==s&&M.current?.revealLine(s)},[s],b),tK(()=>{T.current?.editor.setTheme(l)},[l],b);let N=(0,m.useCallback)(()=>{if(!(!A.current||!T.current)&&!E.current){_.current(T.current);let a=n||r,c=tk(T.current,o||e||"",t||i||"",a||"");M.current=T.current?.editor.create(A.current,{model:c,automaticLayout:!0,...u},h),d&&M.current.restoreViewState(tG.get(a)),T.current.editor.setTheme(l),void 0!==s&&M.current.revealLine(s),R(!0),E.current=!0}},[e,t,r,o,i,n,u,h,d,l,s]);return(0,m.useEffect)(()=>{b&&x.current(M.current,T.current)},[b]),(0,m.useEffect)(()=>{S||b||N()},[S,b,N]),F.current=o,(0,m.useEffect)(()=>{b&&v&&(I.current?.dispose(),I.current=M.current?.onDidChangeModelContent(e=>{B.current||v(M.current.getValue(),e)}))},[b,v]),(0,m.useEffect)(()=>{if(b){let e=T.current.editor.onDidChangeMarkers(e=>{let t=M.current.getModel()?.uri;if(t&&e.find(e=>e.path===t.path)){let e=T.current.editor.getModelMarkers({resource:t});P?.(e)}});return()=>{e?.dispose()}}return()=>{}},[b,P]),m.createElement(tD,{width:p,height:g,isEditorReady:b,loading:a,_ref:A,className:C,wrapperProps:f})});function tq(e){let{options:t,className:r="",theme:o,...i}=e||{},n=(0,f.e7)(),l=(0,m.useMemo)(()=>o||(n?"vs-dark":"light"),[o,n]);return(0,C.jsx)("div",{className:`rspress-playground-editor ${r}`,children:(0,C.jsx)(t$,{...i,theme:l,options:{minimap:{enabled:!0,autohide:!0},fontSize:14,lineNumbersMinChars:7,scrollBeyondLastLine:!1,automaticLayout:!0,wordBasedSuggestions:!0,quickSuggestions:!0,scrollbar:{verticalScrollbarSize:8,horizontalScrollbarSize:8},scrollPredominantAxis:!1,...t}})})}function tJ(e,t){return{type:"VariableDeclaration",declarations:[{type:"VariableDeclarator",id:"string"==typeof e?{type:"Identifier",name:e}:e,init:t}],kind:"const"}}function tY(e){return{type:"Identifier",name:e}}function tU(e,t){return{type:"ObjectProperty",key:tY(e),computed:!1,shorthand:e===t,value:tY(t)}}function tQ(e,t){return{type:"CallExpression",callee:{type:"Identifier",name:"__get_import"},arguments:[{type:"StringLiteral",value:e},{type:"BooleanLiteral",value:!!t}]}}async function tX(){let e=await fetch("https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.22.20/babel.min.js"),t=await e.text(),r=Function("exports","module","require",`with(exports, module, require) {${t}}`),o={};return r(o,{exports:o},()=>{}),o}i=(o=tR({paths:{vs:"https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.43.0/min/vs"}})).monaco,n=function(e,t){if(null==e)return{};var r,o,i=function(e,t){if(null==e)return{};var r,o,i={},n=Object.keys(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)r=n[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(o,["monaco"]),tx(function(e){return{config:function e(t,r){return Object.keys(r).forEach(function(o){r[o]instanceof Object&&t[o]&&Object.assign(r[o],e(t[o],r[o]))}),tl(tl({},t),r)}(e.config,n),monaco:i}});let t0=null;async function t1(){if(window.Babel)return window.Babel;if(t0)return t0;t0=tX();try{let e=await t0;return window.Babel=e,e}catch(e){throw t0=null,e}}class t2 extends m.Component{static getDerivedStateFromError(e){return{error:e,comp:null}}waitCompile(e){this.timer&&clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.timer=null,this.doCompile(e)},800)}async doCompile(e){let{language:t,getImport:r}=this.props,o=await t1();try{let i=[[o.availablePresets.react],[o.availablePresets.env,{modules:"commonjs"}]];("tsx"===t||"ts"===t)&&i.unshift([o.availablePresets.typescript,{allExtensions:!0,isTSX:"tsx"===t}]);let n=o.transform(e,{sourceType:"module",sourceMaps:"inline",presets:i,plugins:[{pre(){this.hasReactImported=!1},visitor:{ImportDeclaration(e){let t=e.node.source.value,r=[],o=[];for(let i of e.node.specifiers)"React"===i.local.name&&(this.hasReactImported=!0),"ImportDefaultSpecifier"===i.type&&r.push(tJ(i.local.name,tQ(t,!0))),"ImportNamespaceSpecifier"===i.type&&r.push(tJ(i.local.name,tQ(t))),"ImportSpecifier"===i.type&&("name"in i.imported&&i.imported.name!==i.local.name?o.push([i.imported.name,i.local.name]):o.push(i.local.name));o.length>0&&r.push(tJ({type:"ObjectPattern",properties:o.map(e=>Array.isArray(e)?tU(e[0],e[1]):tU(e,e))},tQ(t))),e.replaceWithMultiple(r)}},post(e){this.hasReactImported||e.ast.program.body.unshift(tJ("React",tQ("react",!0)))}}]});if(e!==this.props.code||!n||!n.code)return;let l={};if(Function("__get_import","exports",n.code)(r,l),l.default)return void this.setState({error:void 0,comp:m.createElement(l.default)});this.setState({error:Error("No default export")})}catch(t){if(e!==this.props.code)return;console.error(t),this.setState({error:t})}}componentDidCatch(e,t){console.error(e),console.error(t)}componentDidMount(){this.doCompile(this.props.code)}componentDidUpdate(e){e.code!==this.props.code&&this.waitCompile(this.props.code)}render(){let{className:e="",code:t,language:r,getImport:o,...i}=this.props,{error:n,comp:l}=this.state;return(0,C.jsxs)("div",{className:`rspress-playground-runner ${e}`,...i,children:[l,n&&(0,C.jsx)("pre",{className:"rspress-playground-error",children:n.message})]})}constructor(e){var t;super(e),(t="timer")in this?Object.defineProperty(this,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[t]=null,this.state={error:void 0,comp:null},this.doCompile=this.doCompile.bind(this),this.waitCompile=this.waitCompile.bind(this)}}function t4(e){let{code:t,language:r,className:o="",direction:i,editorPosition:n,renderChildren:l,...s}=e,a=function(e){let{page:t}=(0,f.Vi)(),{frontmatter:r={}}=t,{playgroundDirection:o}=r;return e.direction?e.direction:o?o:"horizontal"}(e),[u,h]=(0,m.useState)(t),d=(0,m.useCallback)(e=>{h(e||"")},[]),c="horizontal"===a&&"left"===n,p=["rspress-playground",`rspress-playground-${a}`,`rspress-playground-reverse-${c?"y":"n"}`,o].join(" ");return(0,C.jsxs)("div",{className:p,...s,children:[(0,C.jsx)(t2,{language:r,code:u,getImport:ti}),(0,C.jsx)(tq,{value:u,onChange:d,language:"tsx"===r||"ts"===r?"typescript":"javascript",beforeMount:e=>{e.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!0,noSuggestionDiagnostics:!0})}}),null==l?void 0:l(e,u,a)]})}}}]);