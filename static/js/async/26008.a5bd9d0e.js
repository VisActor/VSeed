"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["26008"],{38953:function(e,s,n){n.r(s),n.d(s,{default:()=>c});var d=n(31549),i=n(6603);function r(e){let s=Object.assign({h1:"h1",a:"a",h2:"h2",div:"div",p:"p",strong:"strong",code:"code",h3:"h3",ul:"ul",li:"li",pre:"pre",blockquote:"blockquote",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td"},(0,i.ah)(),e.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(s.h1,{id:"测试",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#测试",children:"#"}),"测试"]}),"\n",(0,d.jsxs)(s.h2,{id:"测试的意义",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#测试的意义",children:"#"}),"测试的意义"]}),"\n",(0,d.jsxs)(s.div,{className:"rspress-directive info",children:[(0,d.jsx)(s.div,{className:"rspress-directive-title",children:"一、提前发现不符合预期的变化"}),(0,d.jsx)(s.div,{className:"rspress-directive-content",children:(0,d.jsxs)(s.p,{children:["\n如果我们的改动会导致pipeline输出结果变化, ",(0,d.jsxs)(s.strong,{children:["通过快照可以轻松的捕捉到每一行代码对最终结果的影响, 可以轻松提前发现",(0,d.jsx)(s.code,{children:"不符合预期"}),"的变化"]})]})})]}),"\n",(0,d.jsxs)(s.div,{className:"rspress-directive info",children:[(0,d.jsx)(s.div,{className:"rspress-directive-title",children:"二、大型重构的基石"}),(0,d.jsx)(s.div,{className:"rspress-directive-content",children:(0,d.jsxs)(s.p,{children:["\n反之, 如果确定代码不会改变pipeline的输出结果, 例如一个大型重构, ",(0,d.jsx)(s.strong,{children:"就可以安心的进行大刀阔斧的调整代码逻辑, 每一个测试用例都是大型重构的基石"})]})})]}),"\n",(0,d.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,d.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,d.jsx)(s.div,{className:"rspress-directive-content",children:(0,d.jsx)(s.p,{children:"\n鼓励用多个小的commit, 代替一个大的commit, 否则快照变化会庞大到无法review"})})]}),"\n",(0,d.jsxs)(s.h2,{id:"测试分类",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#测试分类",children:"#"}),"测试分类"]}),"\n",(0,d.jsx)(s.p,{children:"VSeed 的测试分为两类："}),"\n",(0,d.jsxs)(s.h3,{id:"单元测试unit-tests",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#单元测试unit-tests",children:"#"}),"单元测试（Unit Tests）"]}),"\n",(0,d.jsxs)(s.p,{children:["位于 ",(0,d.jsx)(s.code,{children:"packages/vseed/tests/unit/"})," 目录下，针对独立函数、工具类、管道函数等进行单元级别的测试。"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"特点："})}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsx)(s.li,{children:"测试粒度细，专注单一功能"}),"\n",(0,d.jsx)(s.li,{children:"运行速度快"}),"\n",(0,d.jsx)(s.li,{children:"无需依赖完整的 VSeed 配置"}),"\n",(0,d.jsx)(s.li,{children:"易于定位问题"}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"运行命令："})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"# 运行所有单元测试\npnpm test:unit\n\n# 运行单元测试并生成覆盖率报告\npnpm test:unit:coverage\n"})}),"\n",(0,d.jsxs)(s.h3,{id:"集成测试integration-tests",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#集成测试integration-tests",children:"#"}),"集成测试（Integration Tests）"]}),"\n",(0,d.jsxs)(s.p,{children:["位于 ",(0,d.jsx)(s.code,{children:"packages/vseed/tests/integration"})," 目录下，基于完整的 VSeed 配置进行端到端测试。"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"特点："})}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsx)(s.li,{children:"测试完整的数据流转和图表生成"}),"\n",(0,d.jsx)(s.li,{children:"通过快照验证最终输出"}),"\n",(0,d.jsx)(s.li,{children:"覆盖真实使用场景"}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"运行命令："})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"# 运行所有集成测试\npnpm test:integration\n\n# 运行集成测试并更新快照\npnpm test:integration:update\n\n# 运行集成测试并生成覆盖率报告\npnpm test:integration:coverage\n"})}),"\n",(0,d.jsxs)(s.h2,{id:"集成测试用例",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#集成测试用例",children:"#"}),"集成测试用例"]}),"\n",(0,d.jsxs)(s.p,{children:["在目录",(0,d.jsx)(s.code,{children:"packages/vseed/tests/integration"}),"内包含所有的集成测试用例"]}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["每个用例是一个",(0,d.jsx)(s.code,{children:"json"}),"文件, 包含一个完整的 ",(0,d.jsx)(s.code,{children:"vseed"})," 配置"]}),"\n",(0,d.jsxs)(s.li,{children:["每个",(0,d.jsx)(s.code,{children:"json"}),"文件的文件名即为测试用例的名称"]}),"\n",(0,d.jsxs)(s.li,{children:["每个 ",(0,d.jsx)(s.code,{children:"*.test.ts"})," 文件均为自动生成, 请勿手动维护"]}),"\n",(0,d.jsxs)(s.li,{children:["修改任何",(0,d.jsx)(s.code,{children:"json"}),"文件, 请重新执行 ",(0,d.jsx)(s.code,{children:"pnpm run build:canvasTest"})]}),"\n"]}),"\n",(0,d.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,d.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,d.jsx)(s.div,{className:"rspress-directive-content",children:(0,d.jsxs)(s.p,{children:["\n仅维护 ",(0,d.jsx)(s.code,{children:"json"}),"配置, 极大的提升测试用例的可维护性, 并降低测试用例的编写成本"]})})]}),"\n",(0,d.jsxs)(s.h2,{id:"单元测试用例",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#单元测试用例",children:"#"}),"单元测试用例"]}),"\n",(0,d.jsxs)(s.p,{children:["在目录 ",(0,d.jsx)(s.code,{children:"packages/vseed/tests/unit/"})," 内包含所有的单元测试用例"]}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsx)(s.li,{children:"每个测试文件手动编写，针对特定函数或模块"}),"\n",(0,d.jsxs)(s.li,{children:["测试文件命名为 ",(0,d.jsx)(s.code,{children:"*.test.ts"})]}),"\n",(0,d.jsx)(s.li,{children:"使用 Vitest 测试框架"}),"\n",(0,d.jsx)(s.li,{children:"专注于测试独立功能，不依赖完整配置"}),"\n"]}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.strong,{children:"目录结构："})}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{children:"tests/unit/\n├── pipes/          # 管道函数测试\n│   └── dual/\n│       └── dualChartType.test.ts\n└── utils/          # 工具函数测试\n    ├── checkVSeed.test.ts\n    ├── createFormatterByMeasure.test.ts\n    ├── findFunctions.test.ts\n    └── measures.test.ts\n"})}),"\n",(0,d.jsxs)(s.h2,{id:"buildtest",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#buildtest",children:"#"}),"build:test"]}),"\n",(0,d.jsxs)(s.p,{children:["根据每一个",(0,d.jsx)(s.code,{children:"vseed"}),", 生成测试用例, 每个用例包含",(0,d.jsx)(s.code,{children:"spec"})," 和 ",(0,d.jsx)(s.code,{children:"advancedVseed"})," 的快照"]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",meta:'title="source: scripts/build-tests.mjs"',children:"pnpm run build:canvasTest\n"})}),"\n",(0,d.jsxs)(s.h2,{id:"buildcanvastest",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#buildcanvastest",children:"#"}),"build:canvasTest"]}),"\n",(0,d.jsxs)(s.p,{children:["根据每一个vseed dsl, 生成测试用例, 每个用例包含",(0,d.jsx)(s.code,{children:"spec"})," 和 ",(0,d.jsx)(s.code,{children:"advancedVseed"})," 的快照, 并创建图表实例, 获得更高的测试覆盖率"]}),"\n",(0,d.jsxs)(s.blockquote,{children:["\n",(0,d.jsx)(s.p,{children:"spec 内存在一些回调函数, 创建图表实例, 才能触发回调函数"}),"\n"]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",meta:'title="source: scripts/build-tests-with-canvas.mjs"',children:"pnpm run build:canvasTest\n"})}),"\n",(0,d.jsxs)(s.h2,{id:"测试覆盖率",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#测试覆盖率",children:"#"}),"测试覆盖率"]}),"\n",(0,d.jsx)(s.p,{children:"运行测试并生成覆盖率报告后, 会自动生成覆盖率徽章到README.md文件, 并打开覆盖率报告页面"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"# 所有测试的覆盖率\npnpm test:coverage\n\n# 仅单元测试的覆盖率\npnpm test:unit:coverage\n\n# 仅集成测试的覆盖率\npnpm test:integration:coverage\n"})}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.strong,{children:"HTML 报告"}),": ",(0,d.jsx)(s.code,{children:"packages/vseed/coverage/index.html"})]}),"\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.strong,{children:"JSON 数据"}),": ",(0,d.jsx)(s.code,{children:"packages/vseed/coverage/coverage-summary.json"})]}),"\n",(0,d.jsxs)(s.li,{children:[(0,d.jsx)(s.strong,{children:"徽章"}),": README.md 文件顶部的覆盖率徽章"]}),"\n"]}),"\n",(0,d.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,d.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,d.jsxs)(s.div,{className:"rspress-directive-content",children:[(0,d.jsx)(s.p,{children:"\n徽章使用 shields.io 动态生成，格式为："}),(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",meta:'title="source: scripts/build-coverage-badge.mjs"',children:"https://img.shields.io/badge/Coverage-{percentage}%-{color}.svg\n"})})]})]}),"\n",(0,d.jsxs)(s.h2,{id:"测试命令总览",children:[(0,d.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#测试命令总览",children:"#"}),"测试命令总览"]}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"命令"}),(0,d.jsx)(s.th,{children:"说明"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"pnpm test"})}),(0,d.jsx)(s.td,{children:"运行所有测试（单元测试 + 集成测试）"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"pnpm test:unit"})}),(0,d.jsx)(s.td,{children:"仅运行单元测试"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"pnpm test:unit:coverage"})}),(0,d.jsx)(s.td,{children:"运行单元测试并生成覆盖率报告"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"pnpm test:integration"})}),(0,d.jsx)(s.td,{children:"仅运行集成测试"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"pnpm test:integration:update"})}),(0,d.jsx)(s.td,{children:"运行集成测试并更新快照"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"pnpm test:integration:coverage"})}),(0,d.jsx)(s.td,{children:"运行集成测试并生成覆盖率报告"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"pnpm test:update"})}),(0,d.jsx)(s.td,{children:"运行所有测试并更新快照"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"pnpm test:coverage"})}),(0,d.jsx)(s.td,{children:"运行所有测试并生成覆盖率报告"})]})]})]})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.ah)(),e.components);return s?(0,d.jsx)(s,Object.assign({},e,{children:(0,d.jsx)(r,e)})):r(e)}let c=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["zh-CN%2Fdevelopment%2FdevProgress%2Ftests.md"]={toc:[{id:"测试的意义",text:"测试的意义",depth:2},{id:"测试分类",text:"测试分类",depth:2},{id:"单元测试unit-tests",text:"单元测试（Unit Tests）",depth:3},{id:"集成测试integration-tests",text:"集成测试（Integration Tests）",depth:3},{id:"集成测试用例",text:"集成测试用例",depth:2},{id:"单元测试用例",text:"单元测试用例",depth:2},{id:"buildtest",text:"build:test",depth:2},{id:"buildcanvastest",text:"build:canvasTest",depth:2},{id:"测试覆盖率",text:"测试覆盖率",depth:2},{id:"测试命令总览",text:"测试命令总览",depth:2}],title:"测试",headingTitle:"测试",frontmatter:{}}}}]);
//# sourceMappingURL=26008.a5bd9d0e.js.map