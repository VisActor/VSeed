import type { PivotChartSpecPipeline, VChartSpecPipeline } from 'src/types'
import {
  xBand,
  backgroundColor,
  discreteLegend,
  color,
  initPivot,
  datasetPivot,
  pivotDiscreteLegend,
  pivotIndicators,
  pivotAdapter,
  pivotIndicatorsAsRow,
  pivotGridStyle,
  pivotColumnDimensions,
  pivotRowDimensions,
  annotationVerticalLine,
  annotationHorizontalLine,
  pointStyle,
  lineStyle,
  pointStateDimensionHover,
  progressive,
  datasetPrimary,
  datasetSecondary,
  areaStyle,
  barStyle,
  verticalCrosshairRect,
  yLinearSecondary,
  initDualAxisPrimary,
  initDualAxisSecondary,
  labelPrimary,
  labelSecondary,
  tooltipPrimary,
  tooltipSecondary,
  yLinearPrimary,
  dualChartTypePrimary,
  dualChartTypeSecondary,
  seriesDualAxis,
  series,
  colorBarStyleFill,
  colorPointStyleFill,
  colorLineStyleFill,
  colorAreaStyleFill,
  linearColor,
  colorAdapter,
  colorLegend,
  pivotColorLegend,
  linearColorForDualAxis,
  annotationAreaBand,
  barMaxWidth,
  barGapInGroup,
  stackCornerRadius,
  pivotTitle,
  pivotAxisStyle,
  dimensionLinkage,
  annotationPointOfDualAxis,
  barStyleFilter,
  pointStyleFilter,
  lineStyleFilter,
  areaStyleFilter,
} from '../pipes'

const dualAxis: VChartSpecPipeline = [
  seriesDualAxis(
    [
      initDualAxisPrimary,
      dualChartTypePrimary,
      datasetPrimary,
      labelPrimary,
      tooltipPrimary,
      progressive,

      barMaxWidth,
      barGapInGroup,
      stackCornerRadius,

      barStyleFilter(colorBarStyleFill(barStyle)),
      pointStyleFilter(colorPointStyleFill(pointStyle)),
      pointStyleFilter(pointStateDimensionHover),
      lineStyleFilter(colorLineStyleFill(lineStyle)),
      areaStyleFilter(colorAreaStyleFill(areaStyle)),
    ],
    [
      initDualAxisSecondary,
      dualChartTypeSecondary,
      datasetSecondary,
      labelSecondary,
      tooltipSecondary,
      progressive,

      barMaxWidth,
      barGapInGroup,
      stackCornerRadius,

      barStyleFilter(colorBarStyleFill(barStyle)),
      pointStyleFilter(colorPointStyleFill(pointStyle)),
      pointStyleFilter(pointStateDimensionHover),
      lineStyleFilter(colorLineStyleFill(lineStyle)),
      areaStyleFilter(colorAreaStyleFill(areaStyle)),
    ],
  ),
  xBand,
  yLinearPrimary,
  yLinearSecondary,

  colorAdapter(color, linearColorForDualAxis),
  colorAdapter(discreteLegend, colorLegend),

  backgroundColor,

  verticalCrosshairRect,
  annotationPointOfDualAxis,
  annotationVerticalLine,
  annotationHorizontalLine,
  annotationAreaBand,
]

const pivotDualAxis: PivotChartSpecPipeline = [
  initPivot,
  pivotGridStyle,
  pivotIndicatorsAsRow,
  datasetPivot,
  pivotIndicators([
    series(
      [
        initDualAxisPrimary,
        dualChartTypePrimary,
        datasetPrimary,
        labelPrimary,
        tooltipPrimary,
        progressive,

        stackCornerRadius,
        barMaxWidth,
        barGapInGroup,

        colorBarStyleFill(barStyle),
        colorPointStyleFill(pointStyle),
        pointStateDimensionHover,
        colorLineStyleFill(lineStyle),
        colorAreaStyleFill(areaStyle),
      ],
      [
        initDualAxisSecondary,
        dualChartTypeSecondary,
        datasetSecondary,
        labelSecondary,
        tooltipSecondary,
        progressive,

        stackCornerRadius,
        barMaxWidth,
        barGapInGroup,

        colorBarStyleFill(barStyle),
        colorPointStyleFill(pointStyle),
        pointStateDimensionHover,
        colorLineStyleFill(lineStyle),
        colorAreaStyleFill(areaStyle),
      ],
    ),
    xBand,
    yLinearPrimary,
    pivotAxisStyle(yLinearSecondary),
    colorAdapter(color, linearColor),
    backgroundColor,
    verticalCrosshairRect,
    annotationPointOfDualAxis,
    annotationVerticalLine,
    annotationHorizontalLine,
    annotationAreaBand,
  ]),
  pivotRowDimensions,
  pivotColumnDimensions,
  pivotTitle,
  colorAdapter(pivotDiscreteLegend, pivotColorLegend),
  dimensionLinkage,
]

export const dualAxisSpecPipeline = [pivotAdapter(dualAxis, pivotDualAxis)]
