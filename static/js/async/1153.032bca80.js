"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["1153"],{96013:function(t,e,i){let r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w;i.r(e),i.d(e,{warn:()=>hO,yearField:()=>j0,isValueInScaleDomain:()=>pO,findZeroOfFunction:()=>x1.Hr,getArcsFromPath:()=>zc,PolarBandAxis:()=>T6,millisecondsGetterName:()=>jF,utcYearFloor:()=>j1,isProgressiveDataColorScheme:()=>h0,PolarMarkLine:()=>Oc,flattenNodes:()=>PT.bp,CircularProgressSeries:()=>k5,loadImage:()=>Nl.p,registerSunburstChart:()=>Pj,SEGMENT_FIELD_START:()=>ux,TextMark:()=>kO,imagecloudTransform:()=>Ng,isObjectLike:()=>NP.Z,BasePolygonMark:()=>R$,isNil:()=>nB.Z,createLine:()=>_I,ThemeManager:()=>dm,hourField:()=>Gg,maxInArray:()=>a1.CE,findMarkGraphic:()=>dT,formatNodeRect:()=>ZW,registerDimensionTooltipProcessor:()=>AX,MOSAIC_CAT_START_PERCENT:()=>u_,MediaQuery:()=>z6,queryColorFromColorScheme:()=>hq,RadarChart:()=>k_,getGroupAnimationParams:()=>_m,registerMarkLine:()=>Oh,registerMarkPoint:()=>Hl,regressionPolynomial:()=>js.N,secondsGetterName:()=>jL,LayoutLevel:()=>ta,BasePieChart:()=>TE,lengthFromPointToLine:()=>ik.Ct,DEFAULT_SERIES_STYLE_NAME:()=>us,dataScheme:()=>hz,GroupMark:()=>gV,crossProductPoint:()=>ik.i1,ImageCloudGridLayout:()=>Nc,PolarSeries:()=>Tl,deviation:()=>NV,registerSankeyChart:()=>IF,stackOffsetSilhouette:()=>bE,registerArcAnimation:()=>v2,utcMonthOffset:()=>Gt,vglobal:()=>hd,circlePackingTransform:()=>Zz,RGB:()=>ju.RGB,InnerBBox:()=>aj.EU,simpleField:()=>I2.RF,getTheme:()=>du,PieChart:()=>TL,STACK_FIELD_KEY:()=>ua,DimensionEventEnum:()=>tq,memoize:()=>Nq.H,registerScaleInOutAnimation:()=>vX,CartesianMarkArea:()=>OC,minuteOffset:()=>Gb,registerRangeColumnSeries:()=>Pf,stackMosaicTotal:()=>bB,registerScrollBar:()=>LN,registerComponentMark:()=>xG,valueInScaleRange:()=>pF,dayFloor:()=>Gr,isColorKey:()=>hQ,asin:()=>ik.ZR,STACK_FIELD_TOTAL:()=>ug,minInArray:()=>a1.iH,throttle:()=>dw.Z,piePresetAnimation:()=>Tf,getSpecInfo:()=>bW,normalizeLayoutPaddingSpec:()=>hM,SUBDIVISION_PRECISION:()=>ik.lE,computeActualDataScheme:()=>h$,eachAfter:()=>PT.Ye,findBoundaryAngles:()=>iH.NC,getDimensionInfoByValue:()=>AL,registerRectAnimation:()=>v1,secondCount:()=>GT,yearCount:()=>jQ,sqrt:()=>ik._b,randomOpacity:()=>We,binaryFuzzySearch:()=>x1.lo,SankeySeries:()=>IA,fakeRandom:()=>ji,getIntervalOptions:()=>GD,registerAllMarks:()=>DD,registerElementHighlightByLegend:()=>DA,utcMinuteFloor:()=>Gx,MarkTypeEnum:()=>eN,SankeyLayout:()=>Ir.V,BaseSeriesSpecTransformer:()=>_c,columnRightToLeft:()=>Wr,createPyramid3d:()=>Zr,registerHistogramChart:()=>k$,sunburstTransform:()=>ZX,lineIntersectPolygon:()=>r2.yB,FunnelSeries:()=>R1,HeatmapChart:()=>IJ,registerCartesianTimeAxis:()=>Ec,pieDisappear:()=>Tg,registerWordCloudChart:()=>RF,isNumeric:()=>MI.Z,isHTMLElement:()=>ax.Re,registerReactAttributePlugin:()=>yg,alternatingWave:()=>Wu,hoursGetterName:()=>jI,isZAxis:()=>C1,DEFAULT_DATA_SERIES_FIELD:()=>ul,ImageMark:()=>DO,registerElementHighlight:()=>ba,registerVennSeries:()=>zV,sortDataInAxisHelper:()=>_f,vennMarkTransform:()=>zN,visitPoints:()=>bm.tF,lowerFirst:()=>N7,registerViewTransform3dPlugin:()=>Zc,lookup:()=>MK,toNumber:()=>N4.H,generateStepInterval:()=>GH,StreamLight:()=>DZ,WORDCLOUD_SHAPE_HOOK_EVENT:()=>Z9.Hr,registerBarAnimation:()=>Mv,registerCartesianLogAxis:()=>Ef,registerMediaQuery:()=>z7,wordcloudShapeTransform:()=>RP.v,dotProduct:()=>ik.Ih,BaseArcMark:()=>Tx,registerStateTransition:()=>W3,STACK_FIELD_START_PERCENT:()=>ud,DEFAULT_LAYOUT_RECT_LEVEL_MIN:()=>pn,barGrowOut:()=>Mg,Segment:()=>So,STACK_FIELD_END:()=>uh,PathMark:()=>Mq,getter:()=>I2.Yn,registerTreemapChart:()=>Bl,RadarSeries:()=>ky,NEWTON_MIN_SLOPE:()=>ik.el,calculateMaxRadius:()=>iH.Re,hexToRgb:()=>ju.hexToRgb,polygonContainPoint:()=>r2.O0,isRegExp:()=>NL,AttributeLevel:()=>to,abs:()=>ik.Wn,spirals:()=>Na.$,WaterfallSeries:()=>BM,graphicCreator:()=>ak,utcSecondOffset:()=>GP,isBoolean:()=>nD.Z,PREFIX:()=>d9,STACK_FIELD_END_PERCENT:()=>uu,Layout:()=>pA,STACK_FIELD_START:()=>uo,defaultThemeName:()=>dl,max:()=>ik.Fp,TransformLevel:()=>ti,pointInRect:()=>aj.qr,clampAngleByDegree:()=>iH.sO,registerLiquidSeries:()=>D3,DEFAULT_MAP_LOOK_UP_KEY:()=>uA,utcMonthFloor:()=>j9,vennTransform:()=>zZ,bisect:()=>x1.b4,CorrelationSeries:()=>Es,RuleMark:()=>kT,registerTreemapSeries:()=>Bi,registerPieSeries:()=>TP,BaseWordCloudChart:()=>Rv,MapSeries:()=>Tt,isPercent:()=>hC,median:()=>bf.C,minutesGetterName:()=>jE,min:()=>ik.VV,RangeAreaChart:()=>IZ,WaterfallChart:()=>BR,CartesianSymlogAxis:()=>Ey,PolarMarkArea:()=>OS,isString:()=>nI.Z,registerRect:()=>c7,getOBBFromLine:()=>jy,createRect:()=>cN,utcMinuteOffset:()=>Gw,parseUint8ToImageData:()=>jc,registerTitle:()=>Om,TotalLabel:()=>O6,registerContinuousLegend:()=>EQ,WordcloudGridLayout:()=>Z8.M,getCartesianCrosshairRect:()=>AW,getColorSchemeBySeries:()=>h2,registerSankeySeries:()=>IM,utcMonthCount:()=>Ge,RoseSeries:()=>kt,DEFAULT_MEASURE_CANVAS_ID:()=>ui,registerVRenderAnimate:()=>yL,YEAR:()=>j$,CartesianLinearAxis:()=>SK,SymbolMark:()=>CU,array:()=>a1.IX,registerCirclePackingChart:()=>P0,STACK_FIELD_TOTAL_PERCENT:()=>uf,createArc:()=>w6,registerHarmonyEnv:()=>yn,registerPolarBandAxis:()=>T7,shuffleArray:()=>a1.Sy,centerToCorner:()=>Wv,substitute:()=>N9,BoxPlotSeries:()=>B7,utcYearCount:()=>j3,registerMarkArea:()=>Ox,styleStringToObject:()=>ax.wv,ecdf:()=>jo.L,DEFAULT_DATA_KEY:()=>un,crossProduct:()=>ik.ir,registerNodeEnv:()=>yt,functionTransform:()=>hg,obbSeparation:()=>yd.up,registerIndicator:()=>L$,registerCorrelationChart:()=>Ed,formatLinkPath:()=>ZN,quantileSorted:()=>Nj.s,SeriesTypeEnum:()=>Y,precisionSub:()=>ik.f2,registerGeoCoordinate:()=>M8,VennChart:()=>zK,barGrowIn:()=>Mp,registerGeoMarkPoint:()=>Hh,registerRangeColumnChart:()=>Pv,STACK_FIELD_START_OffsetSilhouette:()=>uc,WordCloudChart:()=>RL,ManualTicker:()=>DW,calculateNodeValue:()=>PT.Ch,AnimateExecutor:()=>yv,binaryFuzzySearchInNumberRange:()=>x1.o0,Tooltip:()=>E7,getScaleY:()=>ax.LM,registerAnimate:()=>v6,registerBrush:()=>Hg,registerDirectionalLight:()=>Zo,registerPyramid3d:()=>ZP,registerGroupMark:()=>gU,ScrollBar:()=>LZ,WordcloudCloudLayout:()=>Z6.X,mergeAABB:()=>jm,LiquidChart:()=>D5,registerMosaicSeries:()=>zq,CartesianMarkLine:()=>Oo,Stack:()=>Au,CommonChart:()=>kw,getDiffAttributesOfGraphic:()=>dk,shouldMarkDoMorph:()=>_h,epanechnikov:()=>ja.Y7,unionAABB:()=>jf,utcYearField:()=>j5,DataZoom:()=>Lz,GaugePointerSeries:()=>Ro,ComponentMark:()=>xj,builtinThemes:()=>dn,minuteCount:()=>G_,monthGetterName:()=>jP,regressionLinear:()=>bm.fw,Color:()=>ju.Color,fixPrecision:()=>ik.l7,registerArcMark:()=>TS,registerDataZoom:()=>LW,getCombinedSizeOfRegions:()=>x$,getRegionStackGroup:()=>bk,ContinuousLegend:()=>EJ,GraphicUtil:()=>jM,pick:()=>NH,shapes:()=>Nf.JZ,isNumber:()=>n4.Z,cloneDeep:()=>dz.Z,monthFloor:()=>j4,CirclePackingSeries:()=>P$,isLess:()=>ng.SQ,isNull:()=>NR,registerImageMark:()=>DH,registerLabel:()=>O4,rectInsideAnotherRect:()=>aj.RA,pointBetweenLine:()=>jA,registerLineChart:()=>A0,registerPoptip:()=>HL,calcLayoutNumber:()=>hw,AreaSeries:()=>Ma,CartesianBandAxis:()=>SB,getElementRelativePosition:()=>ax.Kj,getRectIntersect:()=>aj.di,rotationScan:()=>Wo,diagonalCenterToEdge:()=>Ws,getFieldAlias:()=>bT,interpolateDate:()=>N2.NW,boundsInRect:()=>hA,isBase64:()=>nL.Z,CorrelationChart:()=>Eh,fuzzyEqualNumber:()=>ik.U4,WordcloudFastLayout:()=>Z7.x,CircularProgressChart:()=>k8,isCollectionMark:()=>dA,pulseWave:()=>Wb,zeros:()=>GY,registerBarChart:()=>MB,transformBoundsWithMatrix:()=>iI.n2,isPointInLine:()=>r2.N0,keys:()=>yf.XP,registerLarkEnv:()=>m8,tickStep:()=>NY,AreaMark:()=>Me,BaseChart:()=>Ah,getElementAbsolutePosition:()=>ax.to,registerMosaicChart:()=>zQ,ImageCloudSpiralLayout:()=>No,PolygonMark:()=>Rq,polarToCartesian:()=>iH.op,calcPadding:()=>hS,millisecondsFloor:()=>GI,registerLinearProgressSeries:()=>Pr,version:()=>DN,utcHourField:()=>Gy,LinearProgressChart:()=>Pl,SunburstSeries:()=>Pz,getScale:()=>ax.yZ,registerLynxEnv:()=>m9,containedInCircles:()=>GG,uuid:()=>N1,norm2:()=>Gq,get:()=>dx.Z,registerLineSeries:()=>S9,setDefaultCrosshairForCartesianChart:()=>c8,LiquidSeries:()=>D2,registerSunBurstSeries:()=>PW,STACK_FIELD_TOTAL_BOTTOM:()=>uy,toDate:()=>N5,getContextFont:()=>uz.U,circleOverlap:()=>GU,LinkSeries:()=>kB,BaseSeries:()=>_p,registerRoseChart:()=>ka,createRect3d:()=>Zs,formatTypes:()=>Da.wG,BoxPlotChart:()=>Ie,BaseWordCloudChartSpecTransformer:()=>Ry,MapChart:()=>Tr,formatNumerals:()=>Da.BG,getScrollTop:()=>ax.cx,isNumberClose:()=>ng.Yt,isValidNumber:()=>hy.Z,Logger:()=>iR.Y,clamp:()=>yj.Z,BaseWordCloudSeries:()=>RM,BaseHistogramChart:()=>kU,CartesianTimeAxis:()=>Eu,FunnelChart:()=>R5,MOSAIC_CAT_END_PERCENT:()=>uC,SankeyChart:()=>IL,lightTheme:()=>hZ,millisecondsSetterName:()=>jN,NumberUtil:()=>Da.C6,polygonIntersectPolygon:()=>r2.iO,ascending:()=>NN.j,mergeFields:()=>bM,precisionAdd:()=>ik.hY,columnEdgeToCenter:()=>Wg,radianToDegree:()=>iH.Dt,pow:()=>ik.sQ,registerAllEnv:()=>m6,pad:()=>NQ,queryToken:()=>yl,destination:()=>GZ,registerGaugeSeries:()=>Rp,registerLinearProgressChart:()=>Ps,getMergedTheme:()=>dg,registerPolarLinearAxis:()=>T9,Event:()=>dv,DEFAULT_SMOOTH_INTERPOLATE:()=>_v,ChartResizeZoomPlugin:()=>z8,PointService:()=>iN.HL,debounce:()=>dS.Z,millisecondsOffset:()=>GE,getCartesianDimensionInfo:()=>AI,createSymbol:()=>oI,registerBoxplotChart:()=>Ii,registerTaroEnv:()=>ye,tau:()=>ik.BZ,scaleAndMiddleShape:()=>Nn.Qn,degreeToRadian:()=>iH.M4,registerWaterfallSeries:()=>BT,clampRadian:()=>iH.Zj,stackMosaic:()=>bI,transformBounds:()=>iI.sT,RoseLikeSeries:()=>TN,registerRoseSeries:()=>ke,BaseComponent:()=>xZ,FormatterPlugin:()=>Dp,defaults:()=>yf.ce,registerLinkSeries:()=>kI,hoursSetterName:()=>jz,AxisSyncPlugin:()=>xd,STATE_VALUE_ENUM:()=>td,formatSpecifier:()=>Do.YQ,getCenter:()=>GX,flattenTreeLinks:()=>ZY,STACK_FIELD_TOTAL_TOP:()=>um,normalizeAngle:()=>iH.LW,pi2:()=>ik.f7,BasePieChartSpecTransformer:()=>TI,registerOrthoCamera:()=>Zd,dateSetterName:()=>jD,registerElementActive:()=>Dy,registerPolarCrossHair:()=>Lg,BaseMark:()=>gW,isRotateAABBIntersect:()=>aj.nn,rowTopToBottom:()=>Wn,TreemapChart:()=>Bn,registerPolarMarkPoint:()=>Ha,CommonChartSpecTransformer:()=>kx,BandAxisMixin:()=>x0,SECOND:()=>jV,SEGMENT_FIELD_END:()=>uw,isPercentOffset:()=>hx,normalTransform:()=>iT.X,registerFunnelSeries:()=>R2,spiralEffect:()=>Wc,toCamelCase:()=>ax.zW,scale:()=>GJ,treemapTransform:()=>Z4,MosaicChart:()=>zJ,variance:()=>NG,WordCloudSeries:()=>RB,minuteField:()=>GC,CartesianSeries:()=>_y,dayField:()=>Gs,createGroup:()=>sG,transformColorSchemeToStandardStruct:()=>h1,CartesianChartSpecTransformer:()=>Ar,pieExit:()=>Tp,CirclePackingChart:()=>PQ,pointInAABB:()=>jg,eachBefore:()=>PT.R$,registerDimensionHover:()=>Af,isEqual:()=>uL.X,registerCustomMark:()=>Hm,epsilon:()=>ik.Ho,rowCenterToEdge:()=>Wf,flattenArray:()=>a1.VF,registerDataSetInstanceTransform:()=>dL,createPath:()=>wP,AreaChart:()=>Md,Brush:()=>Hp,rSquared:()=>bm.xP,isXAxis:()=>CQ,randomLCG:()=>je,registerAreaMark:()=>Mi,registerHtmlAttributePlugin:()=>yc,Player:()=>O$,dayCount:()=>Gl,GaugeSeries:()=>Rc,generateCardioidPoints:()=>Nn.ee,DEFAULT_LINEAR_INTERPOLATE:()=>_b,PolarLinearAxis:()=>T8,getBoundsOfNodes:()=>Zj,getScrollLeft:()=>ax.vj,hslToRgb:()=>ju.hslToRgb,registerElementHighlightByName:()=>DR,registerGroupTooltipProcessor:()=>AJ,registerTooltip:()=>E8,ACustomAnimate:()=>gg,kde:()=>ja.RJ,generateCount:()=>GO,registerElementHighlightByGroup:()=>DI,LRU:()=>g9.L,interpolateNumber:()=>N2.k4,secondFloor:()=>GA,registerRangeAreaChart:()=>IN,utcMonthField:()=>Gi,secondsSetterName:()=>jZ,registerHeatmapSeries:()=>I$,eastAsianCharacterInfo:()=>jk.F,DEFAULT_ANIMATION_CONFIG:()=>vV,GridLayout:()=>Hy,clampAngleByRadian:()=>iH.gt,rgbToHsl:()=>ju.rgbToHsl,ScatterSeries:()=>MN,conjugateGradient:()=>G2,stackTotal:()=>bP,isFunction:()=>nz.Z,registerCircularProgressSeries:()=>k4,columnLeftToRight:()=>Wi,themes:()=>ds,isObject:()=>nF.Z,truncate:()=>N0,yearFloor:()=>jq,registerElementActiveByLegend:()=>DC,registerAreaChart:()=>Mu,cos:()=>ik.mC,CompilableData:()=>pV,calculateAnchorOfBounds:()=>yd.v1,Matrix:()=>iT.y,PieSeriesSpecTransformer:()=>TM,PolarAxis:()=>TU,acos:()=>ik.Kh,createRichText:()=>Cm,Bounds:()=>iI.YZ,formatLinkPolygon:()=>ZZ,pointInOBB:()=>j_,DEFAULT_DATA_INDEX:()=>ur,registerCirclePackingSeries:()=>Pq,registerCircularProgressChart:()=>k9,registerDimensionEvents:()=>AM,RenderModeEnum:()=>oJ,Factory:()=>h9,registerMapChart:()=>Tn,registerPolygonMark:()=>RJ,registerVennChart:()=>zX,GlyphMark:()=>Bj,registerBoxplotSeries:()=>B8,toPercent:()=>I1.y,TextMeasure:()=>r1.e,cornerToCenter:()=>Wy,gemv:()=>G0,registerFormatPlugin:()=>Dg,RangeAreaSeries:()=>ID,transformToGraphic:()=>xg,generatePoints:()=>Nn._y,getTimeFormatter:()=>jG,isRectIntersect:()=>aj.SX,Direction:()=>ej,registerRangeAreaSeries:()=>Iz,RangeColumnSeries:()=>Pg,SeriesMarkNameEnum:()=>$,generateIsEmptyPixel:()=>Nn.at,ordinaryLeastSquares:()=>bm.Pe,SunburstLayout:()=>PR.p,GaugeChart:()=>Rf,Indicator:()=>LY,LineChart:()=>AQ,calculateAnchorOfArc:()=>jT,registerCartesianCrossHair:()=>La,registerMapSeries:()=>Te,registerCustomAnimate:()=>W2,registerMarkFilterTransform:()=>P7,getPathFromArcs:()=>zu,HistogramChartSpecTransformer:()=>kK,registerWXEnv:()=>yi,getActualNumValue:()=>hk,PieSeries:()=>TR,BasePieSeries:()=>Tk,RotateBySphereAnimate:()=>Zp,fuzzyEqualVec:()=>ik.Bw,drawRegularPolygon:()=>Nn.dm,ImageCloudStackLayout:()=>Np,intersectionArea:()=>Gj,isArray:()=>rD.Z,DEFAULT_KEY:()=>uS,circleCircleIntersection:()=>GK,EventEmitter:()=>nH(),isSpecValueWithScale:()=>pH,monthCount:()=>j7,registerBarSeries:()=>Mk,registerWordCloudSeries:()=>RI,DomTooltipHandler:()=>H3,arrayEqual:()=>a1.h6,secondOffset:()=>GM,MONTH:()=>jY,themeExist:()=>dp,isGreater:()=>ng.Vy,PolarPoint:()=>iN.D6,halfPi:()=>ik.ou,millisecondsCount:()=>GL,interpolateNumberRound:()=>N2.OD,registerSymbolMark:()=>CK,toValidNumber:()=>N6,baseMerge:()=>h3.p,removeBorder:()=>Nn.tc,registerCartesianLinearAxis:()=>SX,OBBBounds:()=>iI.a5,registerCartesianSymlogAxis:()=>Ev,getFormatFromValue:()=>jj,baseSeriesMark:()=>b7,isArrayLike:()=>NI.Z,constant:()=>N$,rowBottomToTop:()=>Wl,snakeWave:()=>Wd,registerGesturePlugin:()=>v8,token:()=>hW,BaseComponentSpecTransformer:()=>xz,DimensionHoverEvent:()=>AS,HOUR:()=>jK,DimensionClickEvent:()=>AA,registerDotSeries:()=>kW,registerMarkMapTransform:()=>P8,registerPolygonAnimation:()=>v5,registerRectMark:()=>Mw,getScaleX:()=>ax.Wf,registerRuleMark:()=>kk,BarChart:()=>MP,LineMark:()=>CG,aabbSeparation:()=>yd.YB,getActualColor:()=>hJ,registerRadarSeries:()=>kv,registerSequentialAnimate:()=>W9,rowEdgeToCenter:()=>Wm,getContainerSize:()=>ax.Op,circleArea:()=>GV,Title:()=>Of,treeTransform:()=>Z5,RectMark:()=>Mx,RoseChart:()=>ks,uniqArray:()=>a1.V4,TreemapSeries:()=>Be,darkTheme:()=>hN,isIntersect:()=>aj.Kj,hourCount:()=>Gp,interpolateString:()=>N2.IT,isYAxis:()=>C0,GeoSeries:()=>MX,pickWithout:()=>xN.Z,SMALL:()=>GN,registerArc3d:()=>ZC,cartesianToPolar:()=>iH.Jl,monthField:()=>j8,utcHourFloor:()=>Gf,ArcMark:()=>Tw,LineSeries:()=>S8,FunnelChartSpecTransformer:()=>R3,SequenceChart:()=>kj,registerSequenceChart:()=>kG,utcDayOffset:()=>Go,registerFunnelChart:()=>R4,DEFAULT_LAYOUT_RECT_LEVEL:()=>pr,USER_LAYOUT_RECT_LEVEL:()=>pi,CartesianCrossHair:()=>Ls,utcDayFloor:()=>Ga,registerDomTooltipHandler:()=>H5,sin:()=>ik.O$,normalizePadding:()=>wj.o,fullYearSetterName:()=>jO,zerosM:()=>G$,registerScatterSeries:()=>Mj,field:()=>I2.EP,sortStackValueGroup:()=>bR,svgParser:()=>Nw,userAnimationConfig:()=>_s,extent:()=>I3.W,VennSeries:()=>zG,utcMinuteField:()=>GS,DEFAULT_CHART_HEIGHT:()=>ue,isValid:()=>aw.Z,HeatmapSeries:()=>IY,VChart:()=>bg,getAABBFromPoints:()=>jp,hasParentElement:()=>ax.cY,TreemapLayout:()=>P9.j,lowerCamelCaseToMiddle:()=>ax.Z2,monthSetterName:()=>jH,getCirclesFromArcs:()=>zp,pieEnter:()=>Tc,registerScatterChart:()=>MU,stack:()=>bL,wordcloudTransform:()=>RR.v,secondField:()=>Gk,registerTotalLabel:()=>O7,registerCartesianBandAxis:()=>SI,getShapeFunction:()=>Nf.jc,CartesianLogAxis:()=>Eg,DotSeries:()=>kz,createArc3d:()=>Ze,registerRadarChart:()=>kC,CustomMark:()=>Hf,pointAt:()=>ik.KU,HistogramChart:()=>kY,numberSpecifierReg:()=>Do.DC,dayOffset:()=>Gn,registerCanvasTooltipHandler:()=>Ds,registerGlyphMark:()=>BG,scott:()=>ja.LQ,FormatSpecifier:()=>Do.vr,PositionEnum:()=>eG,convertPoint:()=>hT,generateMaskCanvas:()=>Nn.rp,Label:()=>O5,silverman:()=>ja.ed,regressionLowess:()=>jl.Q,AbstractComponent:()=>CB,registerShadowRoot:()=>gG,HashTable:()=>jd,isTokenKey:()=>ys,registerTTEnv:()=>yr,ChartEvent:()=>J,sankeyTransform:()=>ZK,TimeUtil:()=>bH.k,ColorUtil:()=>ju,registerPathMark:()=>MJ,registerPolarMarkArea:()=>OA,PolarCrossHair:()=>Lp,isUndefined:()=>dU.Z,getDecimalPlaces:()=>ik.i4,computeQuadrant:()=>iH.tc,exponent:()=>Da.ts,BarSeriesSpecTransformer:()=>MM,CartesianAxis:()=>xQ,registerLiquidChart:()=>D4,isPointInPolygon:()=>GW,registerMarkTooltipProcessor:()=>A$,gaussian:()=>ja.Um,stringWidth:()=>jk.Z,utcSecondField:()=>GB,BarSeries:()=>MT,ScatterChart:()=>MV,getPolarDimensionInfo:()=>kl,MINUTE:()=>jU,registerDataSetInstanceParser:()=>dF,RippleMark:()=>Ee,CirclePackingLayout:()=>PG.l,createScaleWithSpec:()=>pL,columnCenterToEdge:()=>Wp,registerLineMark:()=>CV,hourFloor:()=>Gu,DataSet:()=>eY.q,clampRange:()=>Ik.Z,DEFAULT_CHART_WIDTH:()=>ut,ElementHighlight:()=>bs,TooltipResult:()=>eK,getDatumOfGraphic:()=>dM,SunburstChart:()=>PN,isValidUrl:()=>nE.Z,last:()=>a1.Z$,DiscreteLegend:()=>EL,isEmpty:()=>uF.Z,measureText:()=>g6,getDataScheme:()=>hY,SUBDIVISION_MAX_ITERATIONS:()=>ik.qQ,minutesSetterName:()=>jW,LinearProgressSeries:()=>Pi,monthOffset:()=>j6,nelderMead:()=>G1,registerTextMark:()=>kH,registerTheme:()=>dd,specTransform:()=>hp,GeoCoordinate:()=>M7,mixin:()=>yf.jB,rippleEffect:()=>Wh,segmentation:()=>Nn.Sl,Point:()=>iN.E9,span:()=>a1.yP,ElementSelect:()=>bh,BaseChartSpecTransformer:()=>Ai,getAngleByPoint:()=>iH.Oy,isPlainObject:()=>hc.Z,clamper:()=>Rd.i,drawCardioid:()=>Nn.q7,minuteFloor:()=>Gv,particleEffect:()=>W_,isShallowEqual:()=>NW,DAY:()=>jX,getIntersectPoint:()=>aj.Jz,loadImages:()=>Nl.l,pi:()=>ik.pi,registerBrowserEnv:()=>m7,DataView:()=>eq.V,registerCommonChart:()=>kS,RangeColumnSeriesSpecTransformer:()=>Pp,createScale:()=>pE,registerDragPlugin:()=>v7,registerGaugeChart:()=>Rm,registerWordCloudShapeChart:()=>RO,BasePlugin:()=>xh,regressionLogistic:()=>jn.g,BaseSeriesTooltipHelper:()=>bY,yearOffset:()=>jJ,barPresetAnimation:()=>My,hourOffset:()=>Gc,LinearAxisMixin:()=>SZ,fullYearGetterName:()=>jR,interpolateRgb:()=>ju.interpolateRgb,generateCeil:()=>GF,CartesianMarkPoint:()=>Hn,SeriesTypeForThemeEnum:()=>eU,createArea:()=>A3,createImage:()=>Ch,NEWTON_ITERATIONS:()=>ik.Nb,diagonalTopLeftToBottomRight:()=>Wa,MosaicSeries:()=>z$,hasThemeMerged:()=>dh,isPolarAxisSeries:()=>_g,isType:()=>NB.Z,merge:()=>h3.Z,FunnelSeriesSpecTransformer:()=>R0,DEFAULT_COLORS:()=>ju.DEFAULT_COLORS,PolarMarkPoint:()=>Hs,isDate:()=>NE.Z,getAlignStartTexts:()=>ZV,isValidOrient:()=>h_,registerChartPlugin:()=>Dh,registerElementHighlightByKey:()=>DF,registerLine:()=>_W,utcHourOffset:()=>Gm,weightedSum:()=>GQ,zero:()=>jr,upperFirst:()=>N8,registerDiscreteLegend:()=>EF,registerAreaSeries:()=>Mo,registerWaterfallChart:()=>BP,LayoutZIndex:()=>ts,clampDegree:()=>iH.SJ,atan2:()=>ik.fv,DEFAULT_CLOSE_STROKE_JOIN:()=>__,clone:()=>NF,getFunnelTheme:()=>di,registerElementSelect:()=>bd,removeTheme:()=>dc,utcSecondFloor:()=>GR,getMaxRadiusAndCenter:()=>Nf.nf,TreeLayout:()=>Z3,utcYearOffset:()=>j2,has:()=>dV.Z,registerGridLayout:()=>Hb,registerPieChart:()=>TF,AABBBounds:()=>iI.FB,getArcsFromCircles:()=>zd,StackChartMixin:()=>Ac,MOSAIC_VALUE_END_PERCENT:()=>ub,getAlignEndTexts:()=>ZU,RangeColumnChart:()=>Py,utcDayCount:()=>Gh,ProgressLikeSeries:()=>kJ,dateGetterName:()=>jB,CanvasTooltipHandler:()=>Dl,LoggerLevel:()=>iR.h,pointInLine:()=>jC,default:()=>G3,registerChartResizeZoomPlugin:()=>z9,registerHeatmapChart:()=>IQ,registerPlayer:()=>Oq,rotatePoint:()=>aj.xj,GeoMarkPoint:()=>Ho,STACK_FIELD_END_OffsetSilhouette:()=>up,HashValue:()=>jh,range:()=>NZ.w,MOSAIC_VALUE_START_PERCENT:()=>uv,animationConfig:()=>_l,createText:()=>uj,registerPolarMarkLine:()=>Op,registerRect3d:()=>ZD,BarChartSpecTransformer:()=>MR,registerRippleMark:()=>Ei,rgbToHex:()=>ju.rgbToHex,seedRandom:()=>jt,MarkPoint:()=>Ht,registerGaugePointerSeries:()=>Rh,stackGroup:()=>bF,utcDayField:()=>Gd});let S=t=>t;(ew=oJ||(oJ={}))["desktop-browser"]="desktop-browser",ew["mobile-browser"]="mobile-browser",ew.node="node",ew.worker="worker",ew.miniApp="miniApp",ew.wx="wx",ew.tt="tt",ew.harmony="harmony",ew["desktop-miniApp"]="desktop-miniApp",ew.lynx="lynx",(eS=oQ||(oQ={})).cartesianAxis="cartesianAxis",eS.cartesianBandAxis="cartesianAxis-band",eS.cartesianLinearAxis="cartesianAxis-linear",eS.cartesianTimeAxis="cartesianAxis-time",eS.cartesianLogAxis="cartesianAxis-log",eS.cartesianSymlogAxis="cartesianAxis-symlog",eS.polarAxis="polarAxis",eS.polarBandAxis="polarAxis-band",eS.polarLinearAxis="polarAxis-linear",eS.crosshair="crosshair",eS.cartesianCrosshair="cartesianCrosshair",eS.polarCrosshair="polarCrosshair",eS.dataZoom="dataZoom",eS.geoCoordinate="geoCoordinate",eS.indicator="indicator",eS.discreteLegend="discreteLegend",eS.continuousLegend="continuousLegend",eS.colorLegend="colorLegend",eS.sizeLegend="sizeLegend",eS.markLine="markLine",eS.markArea="markArea",eS.markPoint="markPoint",eS.polarMarkLine="polarMarkLine",eS.polarMarkArea="polarMarkArea",eS.polarMarkPoint="polarMarkPoint",eS.geoMarkPoint="geoMarkPoint",eS.tooltip="tooltip",eS.title="title",eS.player="player",eS.scrollBar="scrollBar",eS.label="label",eS.totalLabel="totalLabel",eS.brush="brush",eS.poptip="poptip",eS.customMark="customMark";var A,M,T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X,Y,$,q,J,Q,te,ti,tr,tn,tl,ts,ta,to,th,td,tu,tc,tp,tg,tf,tm,ty,tv,tb,t_,tC,tx,tw,tS,tA,tM,tT,tk,tR,tP,tB,tI,tE,tL,tF,tO,tH,tD,tz,tW,tZ,tN,tj,tG,tV,tU,tK,tX,tY,t$,tq,tJ,tQ,t0,t1,t2,t3,t5,t4,t6,t7,t8,t9,et,ee,ei,er,en,el,es,ea,eo,eh,ed,eu,ec,ep,eg,ef,em,ey,ev,eb,e_,eC,ex,ew,eS,eA,eM,eT,ek,eR,eP,eB,eI,eE,eL,eF,eO,eH,eD,ez,eW,eZ,eN,ej,eG,eV,eU,eK,eX,eY=i(99127),e$=i(74230),eq=i(28919);class eJ{static GenAutoIncrementId(){return eJ.auto_increment_id++}}eJ.auto_increment_id=0;class eQ{constructor(t){this.id=eJ.GenAutoIncrementId(),this.registry=t}}let e0="named",e1="inject",e2="multi_inject",e3="inversify:tagged",e5="inversify:paramtypes",e4=(oz={},function(t){Object.prototype.hasOwnProperty;let e="function"==typeof Symbol,i=e&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=(e&&void 0!==Symbol.iterator&&Symbol.iterator,Object.create,Object.getPrototypeOf(Function)),n=("object"==typeof process&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL,Map),l=new WeakMap;function s(t,e,i){let r=l.get(t);if(o(r)){if(!i)return;r=new n,l.set(t,r)}let s=r.get(e);if(o(s)){if(!i)return;s=new n,r.set(e,s)}return s}function a(t,e,i){let r=s(e,i,!1);return!o(r)&&!!r.has(t)}function o(t){return void 0===t}function h(t){return null===t}function d(t){return"object"==typeof t?null!==t:"function"==typeof t}function u(t){let e=function(t,e){switch(function(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}let r="string",n=function(t,e){let i=t[e];if(null!=i){if(!c(i))throw TypeError();return i}}(t,i);if(void 0!==n){let e=n.call(t,r);if(d(e))throw TypeError();return e}return function(t,e){if("string"===e){let e=t.toString;if(c(e)){let i=e.call(t);if(!d(i))return i}let i=t.valueOf;if(c(i)){let e=i.call(t);if(!d(e))return e}}else{let e=t.valueOf;if(c(e)){let i=e.call(t);if(!d(i))return i}let i=t.toString;if(c(i)){let e=i.call(t);if(!d(e))return e}}throw TypeError()}(t,r)}(t,0);return"symbol"==typeof e?e:""+e}function c(t){return"function"==typeof t}function p(t){let e=Object.getPrototypeOf(t);if("function"!=typeof t||t===r||e!==r)return e;let i=t.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return e;let l=n.constructor;return"function"!=typeof l||l===t?e:l}t("defineMetadata",function(t,e,i,r){var n,l;if(!d(i))throw TypeError();return n=t,l=e,void s(i,r,!0).set(n,l)}),t("hasMetadata",function(t,e,i){if(!d(e))throw TypeError();return o(i)||(i=u(i)),function t(e,i,r){if(a(e,i,r))return!0;let n=p(i);return null!==n&&t(e,n,r)}(t,e,i)}),t("hasOwnMetadata",function(t,e,i){if(!d(e))throw TypeError();return o(i)||(i=u(i)),a(t,e,i)}),t("getMetadata",function(t,e,i){if(!d(e))throw TypeError();return o(i)||(i=u(i)),function t(e,i,r){if(a(e,i,r)){var n=e,l=i,h=r;let t=s(l,h,!1);return o(t)?void 0:t.get(n)}let d=p(i);return null===d?void 0:t(e,d,r)}(t,e,i)})}(function(t,e){"function"!=typeof oz[t]&&Object.defineProperty(oz,t,{configurable:!0,writable:!0,value:e}),oW&&oW(t,e)}),oz);function e6(){return function(t){return e4.defineMetadata(e5,null,t),t}}class e7{constructor(t,e){this.key=t,this.value=e}toString(){return this.key===e0?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}function e8(t){return(e,i,r)=>{var n;let l,s;n=r.toString(),l={},e4.hasOwnMetadata(e3,e)&&(l=e4.getMetadata(e3,e)),void 0===(s=l[n])&&(s=[]),s.push(t),l[n]=s,e4.defineMetadata(e3,l,e)}}function e9(t){return e=>(i,r,n)=>e8(new e7(t,e))(i,r,n)}let it=e9(e1);function ie(t){return e8(new e7(e0,t))}let ii=Symbol("ContributionProvider");class ir{constructor(t,e){this.serviceIdentifier=t,this.container=e,is.setStore(this.serviceIdentifier,this)}getContributions(){return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier))),this.caches}refresh(){this.caches&&(this.caches.length=0,this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier)))}}function il(t,e){t(ii).toDynamicValue(({container:t})=>new ir(e,t)).inSingletonScope().whenTargetNamed(e)}class is{static getStore(t){return this.store.get(t)}static setStore(t,e){this.store.set(t,e)}static refreshAllContributions(){this.store.forEach(t=>{t.refresh()})}}is.store=new Map;class ia{constructor(t,e){this._args=t,this.name=e,this.taps=[]}tap(t,e){this._tap("sync",t,e)}unTap(t,e){let i="string"==typeof t?t.trim():t.name;i&&(this.taps=this.taps.filter(t=>!(t.name===i&&(!e||t.fn===e))))}_parseOptions(t,e,i){let r;if("string"==typeof e)r={name:e.trim()};else if("object"!=typeof e||null===e)throw Error("Invalid tap options");if("string"!=typeof r.name||""===r.name)throw Error("Missing name for tap");return Object.assign({type:t,fn:i},r)}_tap(t,e,i){this._insert(this._parseOptions(t,e,i))}_insert(t){let e;"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));let i=0;"number"==typeof t.stage&&(i=t.stage);let r=this.taps.length;for(;r>0;){r--;let t=this.taps[r];this.taps[r+1]=t;let n=t.stage||0;if(e){if(e.has(t.name)){e.delete(t.name);continue}if(e.size>0)continue}if(!(n>i)){r++;break}}this.taps[r]=t}}class io extends ia{call(...t){this.taps.map(t=>t.fn).forEach(e=>e(...t))}}let ih=Symbol.for("EnvContribution"),id=Symbol.for("VGlobal"),iu={Singleton:"Singleton",Transient:"Transient"},ic={ConstantValue:"ConstantValue",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid"};class ip{constructor(t,e){this.id=eJ.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=ic.Invalid,this.constraint=t=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}clone(){let t=new ip(this.serviceIdentifier,this.scope);return t.activated=t.scope===iu.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.provider=this.provider,t.constraint=this.constraint,t.cache=this.cache,t}}class ig{getConstructorMetadata(t){return{compilerGeneratedMetadata:e4.getMetadata(e5,t),userGeneratedMetadata:e4.getMetadata(e3,t)||{}}}getPropertiesMetadata(t){throw Error("暂未实现")}}let im=t=>{let e=e=>{if(null==e)return!1;if(e.key===e0&&e.value===t)return!0;if(null==e.constructorArgsMetadata)return!1;let i=e.constructorArgsMetadata;for(let e=0;e<i.length;e++)if(i[e].key===e0&&i[e].value===t)return!0;return!1};return e.metaData=new e7(e0,t),e};class iy{constructor(t){this._binding=t}inRequestScope(){throw Error("暂未实现")}inSingletonScope(){return this._binding.scope=iu.Singleton,this}inTransientScope(){return this._binding.scope=iu.Transient,this}whenTargetNamed(t){return this._binding.constraint=im(t),this}}class iv{constructor(t){this._binding=t}to(t){return this._binding.type=ic.Instance,this._binding.implementationType=t,new iy(this._binding)}toSelf(){let t=this._binding.serviceIdentifier;return this.to(t)}toDynamicValue(t){return this._binding.type=ic.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new iy(this._binding)}toConstantValue(t){return this._binding.type=ic.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=iu.Singleton,new iy(this._binding)}toFactory(t){return this._binding.type=ic.Factory,this._binding.factory=t,this._binding.scope=iu.Singleton,new iy(this._binding)}toService(t){this.toDynamicValue(e=>e.container.get(t))}}let ib=new class{constructor(t){let e=t||{};e.defaultScope=e.defaultScope||iu.Transient,this.options=e,this.id=eJ.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new ig}load(t){let e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}get(t){let e=this._getNotAllArgs(t,!1);return this._get(e)}getAll(t){let e=this._getAllArgs(t);return this._get(e)}getTagged(t,e,i){let r=this._getNotAllArgs(t,!1,e,i);return this._get(r)}getNamed(t,e){return this.getTagged(t,e0,e)}isBound(t){return this._bindingDictionary.has(t)}bind(t){let e=new ip(t,this.options.defaultScope),i=this._bindingDictionary.get(t)||[];return i.push(e),this._bindingDictionary.set(t,i),new iv(e)}unbind(t){this._bindingDictionary.delete(t)}rebind(t){return this.unbind(t),this.bind(t)}_getContainerModuleHelpersFactory(){let t=(t,e)=>{t._binding.moduleId=e},e=e=>i=>{let r=this.bind(i);return t(r,e),r},i=()=>t=>this.unbind(t),r=()=>t=>this.isBound(t),n=e=>i=>{let r=this.rebind(i);return t(r,e),r};return t=>({bindFunction:e(t),isboundFunction:r(),rebindFunction:n(t),unbindFunction:i(),unbindAsyncFunction:t=>null})}_getNotAllArgs(t,e,i,r){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:r}}_getAllArgs(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}_get(t){let e=[];return this._bindingDictionary.get(t.serviceIdentifier).filter(e=>e.constraint(t)).forEach(t=>{e.push(this._resolveFromBinding(t))}),t.isMultiInject||1!==e.length?e:e[0]}_getChildRequest(t){let e=t.implementationType,{userGeneratedMetadata:i}=this._metadataReader.getConstructorMetadata(e),r=Object.keys(i),n=[];for(let t=0;t<r.length;t++){let e=i[t],r={};e.forEach(t=>{r[t.key]=t.value});let l={inject:r[e1],multiInject:r[e2]},s=l.inject||l.multiInject,a={serviceIdentifier:s,constructorArgsMetadata:e},o=(this._bindingDictionary.get(s)||[]).filter(t=>t.constraint(a));if(o.length){let t={injectIdentifier:s,metadata:e,bindings:o};n.push(t)}}return n}_resolveFromBinding(t){let e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}_getResolvedFromBinding(t){let e;switch(t.type){case ic.ConstantValue:case ic.Function:e=t.cache;break;case ic.Instance:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}_resolveInstance(t,e){if(t.activated)return t.cache;let i=this._getChildRequest(t);return this._createInstance(e,i)}_createInstance(t,e){return e.length?new t(...this._resolveRequests(e)):new t}_resolveRequests(t){return t.map(t=>t.bindings.length>1?t.bindings.map(t=>this._resolveFromBinding(t)):this._resolveFromBinding(t.bindings[0]))}_saveToScope(t,e){t.scope===iu.Singleton&&(t.cache=e,t.activated=!0)}},i_=Symbol.for("RenderService");Symbol.for("BeforeRenderConstribution");let iC=new class{get renderService(){return this._renderService||(this._renderService=ib.get(i_)),this._renderService}},ix=0;class iw{constructor(){this.nextAnimationFrameCbs=new Map,this._rafHandle=null,this.runAnimationFrame=t=>{this._rafHandle=null;let e=this.nextAnimationFrameCbs;this.nextAnimationFrameCbs=new Map,e.forEach(e=>e(t))},this.tryRunAnimationFrameNextFrame=()=>{null===this._rafHandle&&0!==this.nextAnimationFrameCbs.size&&(this._rafHandle=iC.global.getRequestAnimationFrame()(this.runAnimationFrame))}}addAnimationFrameCb(t){return this.nextAnimationFrameCbs.set(++ix,t),this.tryRunAnimationFrameNextFrame(),ix}removeAnimationFrameCb(t){return!!this.nextAnimationFrameCbs.has(t)&&(this.nextAnimationFrameCbs.delete(t),!0)}}class iS{constructor(){this._listenerMap=new Map,this._eventListenerTransformer=t=>t}setEventListenerTransformer(t){this._eventListenerTransformer=t||(t=>t)}addEventListener(t,e,i){if(!e)return;let r=t=>{let i=this._eventListenerTransformer(t);"function"==typeof e?e(i):e.handleEvent&&e.handleEvent(i)};this._listenerMap.has(t)||this._listenerMap.set(t,new Map),this._listenerMap.get(t).set(e,r),this._nativeAddEventListener(t,r,i)}removeEventListener(t,e,i){var r;if(!e)return;let n=null==(r=this._listenerMap.get(t))?void 0:r.get(e);n&&(this._nativeRemoveEventListener(t,n,i),this._listenerMap.get(t).delete(e),0===this._listenerMap.get(t).size&&this._listenerMap.delete(t))}dispatchEvent(t){return this._nativeDispatchEvent(t)}clearAllEventListeners(){this._listenerMap.forEach((t,e)=>{t.forEach((t,i)=>{this._nativeRemoveEventListener(e,t,void 0)})}),this._listenerMap.clear()}_nativeAddEventListener(t,e,i){throw Error("_nativeAddEventListener must be implemented by derived classes")}_nativeRemoveEventListener(t,e,i){throw Error("_nativeRemoveEventListener must be implemented by derived classes")}_nativeDispatchEvent(t){throw Error("_nativeDispatchEvent must be implemented by derived classes")}}var iA=function(t,e){return function(i,r){e(i,r,t)}};let iM=class extends iS{get env(){return this._env}get isImageAnonymous(){return this._isImageAnonymous}set isImageAnonymous(t){this._isImageAnonymous=t}get devicePixelRatio(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}get supportEvent(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent}set supportEvent(t){this._env||this.setEnv("browser"),this.envContribution.supportEvent=t}get supportsTouchEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents}set supportsTouchEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=t}get supportsPointerEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents}set supportsPointerEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=t}get supportsMouseEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents}set supportsMouseEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=t}get applyStyles(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles}set applyStyles(t){this._env||this.setEnv("browser"),this.envContribution.applyStyles=t}constructor(t){super(),this.contributions=t,this._isImageAnonymous=!0,this._performanceRAFList=[],this.eventListenerTransformer=t=>t,this.id=eJ.GenAutoIncrementId(),this.hooks={onSetEnv:new io(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}_nativeAddEventListener(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(t,e,i)}_nativeRemoveEventListener(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(t,e,i)}_nativeDispatchEvent(t){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(t)}bindContribution(t){let e=[];if(this.contributions.getContributions().forEach(i=>{let r=i.configure(this,t);r&&r.then&&e.push(r)}),e.length)return Promise.all(e)}getDynamicCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}getStaticCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}setEnv(t,e){if(e&&!0===e.force||this._env!==t)return this.deactiveCurrentEnv(),this.activeEnv(t,e)}deactiveCurrentEnv(){this.envContribution&&this.envContribution.release()}activeEnv(t,e){let i=this._env;this._env=t;let r=this.bindContribution(e);if(r&&r.then)return r.then(()=>{this.envParams=e,this.hooks.onSetEnv.call(i,t,this)});this.envParams=e,this.hooks.onSetEnv.call(i,t,this)}setActiveEnvContribution(t){this.envContribution=t}createCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(t)}createOffscreenCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(t)}releaseCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(t)}getRequestAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}getSpecifiedRequestAnimationFrame(t){this._env||this.setEnv("browser"),this._performanceRAFList[t]||(this._performanceRAFList[t]=new iw);let e=this._performanceRAFList[t];return t=>e.addAnimationFrameCb(t)}getSpecifiedCancelAnimationFrame(t){if(this._env||this.setEnv("browser"),!this._performanceRAFList[t])return()=>!1;let e=this._performanceRAFList[t];return t=>e.removeAnimationFrameCb(t)}getCancelAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}getElementById(t){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(t):null}getRootElement(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}getDocument(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}mapToCanvasPoint(t,e){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(t,e):null}loadImage(t){return this._env||this.setEnv("browser"),this.envContribution.loadImage(t)}loadSvg(t){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(t)}loadJson(t){return this._env||this.setEnv("browser"),this.envContribution.loadJson(t)}loadArrayBuffer(t){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(t)}loadBlob(t){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(t)}loadFont(t,e,i){var r,n,l,s;return r=this,n=void 0,l=void 0,s=function*(){return this._env||this.setEnv("browser"),this.envContribution.loadFont(t,e,i)},new(l||(l=Promise))(function(t,e){function i(t){try{o(s.next(t))}catch(t){e(t)}}function a(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof l?r:new l(function(t){t(r)})).then(i,a)}o((s=s.apply(r,n||[])).next())})}isChrome(){return null!=this._isChrome||(this._env||this.setEnv("browser"),this._isChrome="browser"===this._env&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}isSafari(){return null!=this._isSafari||(this._env||this.setEnv("browser"),this._isSafari="browser"===this._env&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}getNativeAABBBounds(t){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(t)}removeDom(t){return this._env||this.setEnv("browser"),this.envContribution.removeDom(t)}createDom(t){return this._env||this.setEnv("browser"),this.envContribution.createDom(t)}updateDom(t,e){return this._env||this.setEnv("browser"),this.envContribution.updateDom(t,e)}getElementTop(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTop(t,e)}getElementLeft(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(t,e)}getElementTopLeft(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(t,e)}isMacOS(){return this._env||this.setEnv("browser"),this.envContribution.isMacOS()}copyToClipBoard(t){return this._env||this.setEnv("browser"),this.envContribution.copyToClipBoard(t)}};iM=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),iA(0,it(ii)),iA(0,ie(ih)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],iM),(oZ=o0||(o0={}))[oZ.estimate=0]="estimate",oZ[oZ.actualBounding=1]="actualBounding",oZ[oZ.fontBounding=2]="fontBounding";var iT=i(69182),ik=i(8830),iR=i(85476);let iP=ik.BZ-1e-8;class iB{constructor(t){this.init(t)}init(t){this.bounds=t}arc(t,e,i,r,n,l){if(Math.abs(n-r)>iP)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);let s,a,o,h,d=1/0,u=-1/0,c=1/0,p=-1/0;function g(t){o=i*Math.cos(t),h=i*Math.sin(t),o<d&&(d=o),o>u&&(u=o),h<c&&(c=h),h>p&&(p=h)}if(g(r),g(n),n!==r)if((r%=ik.BZ)<0&&(r+=ik.BZ),(n%=ik.BZ)<0&&(n+=ik.BZ),n<r&&(l=!l,s=r,r=n,n=s),l)for(n-=ik.BZ,s=r-r%ik.ou,a=0;a<4&&s>n;++a,s-=ik.ou)g(s);else for(s=r-r%ik.ou+ik.ou,a=0;a<4&&s<n;++a,s+=ik.ou)g(s);this.bounds.add(t+d,e+c),this.bounds.add(t+u,e+p)}arcTo(t,e,i,r,n){this.bounds.add(t,e)}bezierCurveTo(t,e,i,r,n,l){this.bounds.add(t,e),this.bounds.add(i,r),this.bounds.add(n,l)}closePath(){}ellipse(){throw Error("不支持ellipse")}lineTo(t,e){this.bounds.add(t,e)}moveTo(t,e){this.bounds.add(t,e)}quadraticCurveTo(t,e,i,r){this.bounds.add(t,e),this.bounds.add(i,r)}rect(t,e,i,r){this.bounds.add(t,e),this.bounds.add(t+i,e+r)}clear(){this.bounds.clear()}release(...t){}}var iI=i(63401);class iE{constructor(){this._curves=[],this.bounds=new iI.FB}get curves(){return this._curves}getCurveLengths(){return this._curves.map(t=>t.getLength())}getPointAt(t){return{x:0,y:0}}getLength(){return 0}getBounds(){return this.bounds}}let iL=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,iF={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},iO={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};(oN=o1||(o1={}))[oN.NONE=0]="NONE",oN[oN.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",oN[oN.UPDATE_SHAPE=2]="UPDATE_SHAPE",oN[oN.CLEAR_SHAPE=253]="CLEAR_SHAPE",oN[oN.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",oN[oN.INIT=179]="INIT",oN[oN.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",oN[oN.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",oN[oN.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",oN[oN.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",oN[oN.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",oN[oN.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",oN[oN.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",oN[oN.CLEAR_LAYOUT=127]="CLEAR_LAYOUT",(oj=o2||(o2={}))[oj.GLOBAL=1]="GLOBAL",oj[oj.LOCAL=16]="LOCAL",oj[oj.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",oj[oj.LOCAL_ACCURATE=48]="LOCAL_ACCURATE",(oG=o3||(o3={}))[oG.INIT=0]="INIT",oG[oG.DEFAULT=1]="DEFAULT",oG[oG.STATE=2]="STATE",oG[oG.ANIMATE_BIND=10]="ANIMATE_BIND",oG[oG.ANIMATE_PLAY=11]="ANIMATE_PLAY",oG[oG.ANIMATE_START=12]="ANIMATE_START",oG[oG.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",oG[oG.ANIMATE_END=14]="ANIMATE_END",oG[oG.TRANSLATE=20]="TRANSLATE",oG[oG.TRANSLATE_TO=21]="TRANSLATE_TO",oG[oG.SCALE=22]="SCALE",oG[oG.SCALE_TO=23]="SCALE_TO",oG[oG.ROTATE=24]="ROTATE",oG[oG.ROTATE_TO=25]="ROTATE_TO",(oV=o5||(o5={}))[oV.ROW=1]="ROW",oV[oV.COLUMN=2]="COLUMN",(oU=o4||(o4={}))[oU.CubicBezierCurve=0]="CubicBezierCurve",oU[oU.QuadraticBezierCurve=1]="QuadraticBezierCurve",oU[oU.ArcCurve=2]="ArcCurve",oU[oU.LineCurve=3]="LineCurve",oU[oU.EllipseCurve=4]="EllipseCurve",oU[oU.MoveCurve=5]="MoveCurve",(oK=o6||(o6={}))[oK.beforeFillStroke=0]="beforeFillStroke",oK[oK.afterFillStroke=1]="afterFillStroke";var iH=i(9762);function iD(t,e,i,r){let n=function(t,e,i,r,n,l,s,a,o){let h=(0,iH.M4)(s),d=Math.sin(h),u=Math.cos(h),c=u*(a-t)*.5+d*(o-e)*.5,p=u*(o-e)*.5-d*(a-t)*.5,g=c*c/((i=Math.abs(i))*i)+p*p/((r=Math.abs(r))*r);g>1&&(i*=g=Math.sqrt(g),r*=g);let f=u/i,m=d/i,y=-d/r,v=u/r,b=f*a+m*o,_=y*a+v*o,C=f*t+m*e,x=y*t+v*e,w=1/((C-b)*(C-b)+(x-_)*(x-_))-.25;w<0&&(w=0);let S=Math.sqrt(w);l===n&&(S=-S);let A=.5*(b+C)-S*(x-_),M=.5*(_+x)+S*(C-b),T=Math.atan2(_-M,b-A),k=Math.atan2(x-M,C-A)-T;k<0&&1===l?k+=ik.BZ:k>0&&0===l&&(k-=ik.BZ);let R=Math.ceil(Math.abs(k/(ik.ou+.001))),P=[];for(let t=0;t<R;++t){let e=T+t*k/R,n=T+(t+1)*k/R;P[t]=[A,M,e,n,i,r,d,u]}return P}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,i);for(let e=0;e<n.length;++e){let i=function(t){let e=t[0],i=t[1],r=t[2],n=t[3],l=t[4],s=t[5],a=t[6],o=t[7],h=o*l,d=-a*s,u=a*l,c=o*s,p=Math.cos(r),g=Math.sin(r),f=Math.cos(n),m=Math.sin(n),y=.5*(n-r),v=Math.sin(.5*y),b=8/3*v*v/Math.sin(y),_=e+p-b*g,C=i+g+b*p,x=e+f,w=i+m,S=x+b*m,A=w-b*f;return[h*_+d*C,u*_+c*C,h*S+d*A,u*S+c*A,h*x+d*w,u*x+c*w]}(n[e]);t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5])}}let iz=(t,e,i,r,n,l,s,a=!1)=>{let o=2*Math.PI,h=(e%o+o)%o,d,u=(i%o+o)%o;a?u>=h&&(u-=o):u<=h&&(u+=o);let c=Math.ceil(Math.abs(d=u-h)/(.5*Math.PI)),p=d/c;for(let e=0;e<c;e++){let i=h+p*e,o=h+p*(e+1),d=4/3*Math.tan(Math.abs(p)/4),u=Math.cos(i),c=Math.sin(i),g=Math.cos(o),f=Math.sin(o),m=u*l+r,y=c*s+n,v=g*l+r,b=f*s+n,_=a?-1:1,C=l*d*_,x=s*d*_;t.push(m-C*c,y+x*u,v+C*f,b-x*g,v,b)}},iW=[(t,e,i,r,n,l,s)=>e.arc(t[1]*n+i,t[2]*l+r,t[3]*(n+l)/2,t[4],t[5],t[6],s),(t,e,i,r,n,l,s)=>e.arcTo(t[1]*n+i,t[2]*l+r,t[3]*n+i,t[4]*l+r,t[5]*(n+l)/2,s),(t,e,i,r,n,l,s)=>e.bezierCurveTo(t[1]*n+i,t[2]*l+r,t[3]*n+i,t[4]*l+r,t[5]*n+i,t[6]*l+r,s),(t,e,i,r)=>e.closePath(),(t,e,i,r,n,l)=>e.ellipse(t[1]*n+i,t[2]*l+r,t[3]*n,t[4]*l,t[5],t[6],t[7],t[8]),(t,e,i,r,n,l,s)=>e.lineTo(t[1]*n+i,t[2]*l+r,s),(t,e,i,r,n,l,s)=>e.moveTo(t[1]*n+i,t[2]*l+r,s),(t,e,i,r,n,l,s)=>e.quadraticCurveTo(t[1]*n+i,t[2]*l+r,t[3]*n+i,t[4]*l+r,s),(t,e,i,r,n,l,s)=>e.rect(t[1]*n+i,t[2]*l+r,t[3]*n,t[4]*l,s)];function iZ(t,e,i=0,r=0,n=1,l=1,s){for(let a=0;a<t.length;a++){let o=t[a];iW[o[0]](o,e,i,r,n,l,s)}}var iN=i(19498);class ij{getLength(t){return null!=t?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}function iG(t,e){let{p0:i,p1:r}=t,n=iN.HL.pointAtPP(i,r,e);return[new iV(i,n),new iV(n,r)]}class iV extends ij{constructor(t,e){super(),this.type=o4.LineCurve,this.p0=t,this.p1=e}getPointAt(t){if(!1!==this.defined)return iN.HL.pointAtPP(this.p0,this.p1,t);throw Error("defined为false的点不能getPointAt")}getAngleAt(t){return null==this.angle&&(this.angle=(0,ik.fv)(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}calcLength(){return this._validPoint()?iN.HL.distancePP(this.p0,this.p1):60}calcProjLength(t){return t===o5.ROW?(0,ik.Wn)(this.p0.x-this.p1.x):t===o5.COLUMN?(0,ik.Wn)(this.p0.y-this.p1.y):0}draw(t,e,i,r,n,l){if(t.moveTo(this.p0.x*r+e,this.p0.y*n+i),l>=1)t.lineTo(this.p1.x*r+e,this.p1.y*n+i);else if(l>0){let s=this.getPointAt(l);t.lineTo(s.x*r+e,s.y*n+i)}}includeX(t){return t>=this.p0.x&&t<=this.p1.x||t>=this.p1.x&&t<=this.p0.x}getYAt(t){if(this.includeX(t)){let e=this.p0,i=this.p1;this.p0.x>this.p1.x&&(e=this.p1,i=this.p0);let r=(t-e.x)/(i.x-e.x);return e.y+r*(i.y-e.y)}return 1/0}}function iU(t,e){let i=0,r=t.length;for(let n=0;n<r;n++){let l=t[n],s=e[n],a=t[(n+1)%r],o=e[(n+1)%r];i+=iN.HL.distanceNN(l,s,a,o)}return i/2}function iK(t,e,i,r,n){let l=1-n;return l*l*l*t+3*e*n*l*l+3*i*n*n*l+r*n*n*n}function iX(t,e,i,r,n){let l=iK(t.x,e.x,i.x,r.x,n),s=iK(t.y,e.y,i.y,r.y,n);return new iN.E9(l,s)}function iY(t,e,i,r){let n=1-r;return n*n*t+2*n*r*e+r*r*i}function i$(t,e,i,r){let n=iY(t.x,e.x,i.x,r),l=iY(t.y,e.y,i.y,r);return new iN.E9(n,l)}function iq(t,e){let{p0:i,p1:r,p2:n,p3:l}=t,s=iX(i,r,n,l,e),a=iN.HL.pointAtPP(i,r,e),o=iN.HL.pointAtPP(r,n,e),h=iN.HL.pointAtPP(n,l,e),d=iN.HL.pointAtPP(a,o,e),u=iN.HL.pointAtPP(o,h,e);return[new iJ(i,a,d,s),new iJ(s,u,h,l)]}class iJ extends ij{constructor(t,e,i,r){super(),this.type=o4.CubicBezierCurve,this.p0=t,this.p1=e,this.p2=i,this.p3=r}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}getPointAt(t){if(!1!==this.defined)return iX(this.p0,this.p1,this.p2,this.p3,t);throw Error("defined为false的点不能getPointAt")}calcLength(){var t,e,i,r;return this._validPoint()?(t=this.p0,e=this.p1,i=this.p2,r=this.p3,iU([t.x,e.x,i.x,r.x],[t.y,e.y,i.y,r.y])):60}calcProjLength(t){return t===o5.ROW?(0,ik.Wn)(this.p0.x-this.p3.x):t===o5.COLUMN?(0,ik.Wn)(this.p0.y-this.p3.y):0}getAngleAt(t){let e=(0,ik.Fp)(t-.01,0),i=(0,ik.VV)(t+.01,1),r=this.getPointAt(e),n=this.getPointAt(i);return(0,ik.fv)(n.y-r.y,n.x-r.x)}draw(t,e,i,r,n,l){if(t.moveTo(this.p0.x*r+e,this.p0.y*n+i),l>=1)t.bezierCurveTo(this.p1.x*r+e,this.p1.y*n+i,this.p2.x*r+e,this.p2.y*n+i,this.p3.x*r+e,this.p3.y*n+i);else if(l>0){let[s]=iq(this,l);t.bezierCurveTo(s.p1.x*r+e,s.p1.y*n+i,s.p2.x*r+e,s.p2.y*n+i,s.p3.x*r+e,s.p3.y*n+i)}}includeX(t){let e=(0,ik.VV)(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(0,ik.Fp)(this.p0.x,this.p1.x,this.p2.x,this.p3.x);return t>=e&&t<=i}getYAt(t){let e=(0,ik.VV)(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(t-e)/((0,ik.Fp)(this.p0.x,this.p1.x,this.p2.x,this.p3.x)-e);return this.getPointAt(i).y}}class iQ extends ij{constructor(t,e,i){super(),this.type=o4.QuadraticBezierCurve,this.p0=t,this.p1=e,this.p2=i}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y)}getPointAt(t){if(!1!==this.defined)return i$(this.p0,this.p1,this.p2,t);throw Error("defined为false的点不能getPointAt")}calcLength(){var t,e,i;return this._validPoint()?(t=this.p0,e=this.p1,i=this.p2,iU([t.x,e.x,i.x],[t.y,e.y,i.y])):60}calcProjLength(t){return t===o5.ROW?(0,ik.Wn)(this.p0.x-this.p2.x):t===o5.COLUMN?(0,ik.Wn)(this.p0.y-this.p2.y):0}getAngleAt(t){let e=(0,ik.Fp)(t-.01,0),i=(0,ik.VV)(t+.01,1),r=this.getPointAt(e),n=this.getPointAt(i);return(0,ik.fv)(n.y-r.y,n.x-r.x)}draw(t,e,i,r,n,l){if(t.moveTo(this.p0.x*r+e,this.p0.y*n+i),l>=1)t.quadraticCurveTo(this.p1.x*r+e,this.p1.y*n+i,this.p2.x*r+e,this.p2.y*n+i);else if(l>0){let[s]=function(t,e){let{p0:i,p1:r,p2:n}=t,l=i$(i,r,n,e),s=iN.HL.pointAtPP(i,r,e),a=iN.HL.pointAtPP(r,n,e);return[new iQ(i,s,l),new iQ(l,a,n)]}(this,l);t.quadraticCurveTo(s.p1.x*r+e,s.p1.y*n+i,s.p2.x*r+e,s.p2.y*n+i)}}getYAt(t){throw Error("QuadraticBezierCurve暂不支持getYAt")}includeX(t){throw Error("QuadraticBezierCurve暂不支持includeX")}}class i0{constructor(t){this.path=t,this._lastX=this._lastY=this._startX=this._startY=0}moveTo(t,e){return this._lastX=this._startX=t,this._lastY=this._startY=e,this}lineTo(t,e){let i=this.addLinearCurve(t,e);this.path.addCurve(i),this._lastX=t,this._lastY=e}addLinearCurve(t,e){return new iV(new iN.E9(this._lastX,this._lastY),new iN.E9(t,e))}quadraticCurveTo(t,e,i,r){let n=new iQ(new iN.E9(this._lastX,this._lastY),new iN.E9(t,e),new iN.E9(i,r));this.path.addCurve(n),this._lastX=i,this._lastY=r}bezierCurveTo(t,e,i,r,n,l){let s=new iJ(new iN.E9(this._lastX,this._lastY),new iN.E9(t,e),new iN.E9(i,r),new iN.E9(n,l));this.path.addCurve(s),this._lastX=n,this._lastY=l}arcTo(t,e,i,r,n){throw Error("CurveContext不支持调用arcTo")}ellipse(t,e,i,r,n,l,s,a){throw Error("CurveContext不支持调用ellipse")}rect(t,e,i,r){throw Error("CurveContext不支持调用rect")}arc(t,e,i,r,n,l){throw Error("CurveContext不支持调用arc")}closePath(){this.path.curves.length<2||this.lineTo(this._startX,this._startY)}}class i1{get endX(){return this._lastX}get endY(){return this._lastY}constructor(t,e){this.init(t,e)}init(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}bezierCurveTo(t,e,i,r,n,l,s,a){let o=new iJ(new iN.E9(this._lastX,this._lastY),new iN.E9(t,e),new iN.E9(i,r),new iN.E9(n,l));o.originP1=this._lastOriginP,o.originP2=a,o.defined=s,this.curves.push(o),this._lastX=n,this._lastY=l,this._lastOriginP=a}closePath(){if(this.curves.length<2)return;let t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}ellipse(){throw Error("SegContext不支持调用ellipse")}lineTo(t,e,i,r){let n=this.addLinearCurve(t,e,i,this._lastOriginP,r);this.curves.push(n),this._lastX=t,this._lastY=e,this._lastOriginP=r}moveTo(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}quadraticCurveTo(t,e,i,r){throw Error("SegContext不支持调用quadraticCurveTo")}clear(){this.curves=[],this.length=NaN}tryUpdateLength(t){return this.getLength(t)}addLinearCurve(t,e,i,r,n){let l=new iV(new iN.E9(this._lastX,this._lastY),new iN.E9(t,e));return l.originP1=r,l.originP2=n,l.defined=i,l}getPointAt(t){throw Error("暂未实现")}getCurveLengths(){return[]}getLength(t){var e,i;if(t===o5.COLUMN){if(!this.curves.length)return 0;let t=this.curves[0],i=this.curves[this.curves.length-1],r=null!=(e=i.p3)?e:i.p1;return(0,ik.Wn)(t.p0.y-r.y)}if(t===o5.ROW){if(!this.curves.length)return 0;let t=this.curves[0],e=this.curves[this.curves.length-1],r=null!=(i=e.p3)?i:e.p1;return(0,ik.Wn)(t.p0.x-r.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((t,e)=>t+e.getLength(),0)),this.length}}class i2 extends i1{bezierCurveTo(t,e,i,r,n,l,s,a){return super.bezierCurveTo(e,t,r,i,l,n,s,a)}lineTo(t,e,i,r){return super.lineTo(e,t,i,r)}moveTo(t,e,i){return super.moveTo(e,t,i)}clear(){return super.clear()}}function i3(t,e,i=1){let r=!1;for(let i=0,n=e.length;i<=n;i++)i>=n===r&&((r=!r)?t.lineStart():t.lineEnd()),r&&t.point(e[i])}function i5(t,e,i){let r=null!=e?e:(0,ik.Wn)(i[i.length-1].x-i[0].x)>(0,ik.Wn)(i[i.length-1].y-i[0].y)?o5.ROW:o5.COLUMN;return"monotoneY"===t?new i2(t,r):new i1(t,r)}class i4{constructor(t,e){this.context=t,e&&(this.startPoint=e)}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t)}this._lastDefined=t.defined}tryUpdateLength(){return this.context.tryUpdateLength()}}function i6(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;let n=i5("linear",i,t);return i3(new i4(n,r),t,1),n}function i7(t,e,i,r,n){t.context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+i)/6,r,t.lastPoint1)}class i8{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){2===this._point&&i7(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:i7(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function i9(t,e,i){let r=t._x1-t._x0,n=e-t._x1,l=(t._y1-t._y0)/(r||Number(n<0&&-0)),s=(i-t._y1)/(n||Number(r<0&&-0));return((l<0?-1:1)+(s<0?-1:1))*Math.min(Math.abs(l),Math.abs(s),.5*Math.abs((l*n+s*r)/(r+n)))||0}function rt(t,e){let i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function re(t,e,i,r,n){let l=t._x0,s=t._y0,a=t._x1,o=t._y1,h=(a-l)/3;t.context.bezierCurveTo(l+h,s+h*e,a-h,o-h*i,a,o,r,t.lastPoint1)}class ri{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:re(this,this._t0,rt(this,this._t0),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1)}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=NaN,i=t.x,r=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,r,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(i,r,t);break;case 1:this._point=2;break;case 2:this._point=3,re(this,rt(this,e=i9(this,i,r)),e,!1!==this._lastDefined1&&!1!==this._lastDefined2,t);break;default:re(this,this._t0,e=i9(this,i,r),!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=r,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=!1!==t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class rr extends ri{constructor(t,e){super(t,e)}point(t){return super.point({y:t.x,x:t.y,defined:t.defined})}}class rn{constructor(t,e=.5,i){this.context=t,this._t=e,this.startPoint=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){0<this._t&&this._t<1&&2===this._point&&this.context.lineTo(this._x,this._y,!1!==this._lastDefined,this.lastPoint),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t);else{let r=this._x*(1-this._t)+e*this._t;.5===this._t?this.context.lineTo(r,this._y,!1!==this._lastDefined,this.lastPoint):this.context.lineTo(r,this._y,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(r,i,!1!==this._lastDefined&&!1!==t.defined,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class rl extends rn{lineEnd(){this.context.closePath()}}function rs(t,e,i={}){let{direction:r,startPoint:n}=i;if(t.length<2-Number(!!n))return null;let l=new i1("step",null!=r?r:(0,ik.Wn)(t[t.length-1].x-t[0].x)>(0,ik.Wn)(t[t.length-1].y-t[0].y)?o5.ROW:o5.COLUMN);return i3(new rn(l,e,n),t,1),l}class ra extends i4{lineEnd(){this.context.closePath()}}function ro(t,e,i,r,n){let l=t._x1,s=t._y1,a=t._x2,o=t._y2;if(t._l01_a>ik.Ho){let e=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,i=3*t._l01_a*(t._l01_a+t._l12_a);l=(l*e-t._x0*t._l12_2a+t._x2*t._l01_2a)/i,s=(s*e-t._y0*t._l12_2a+t._y2*t._l01_2a)/i}if(t._l23_a>ik.Ho){let r=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,n=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*r+t._x1*t._l23_2a-e*t._l12_2a)/n,o=(o*r+t._y1*t._l23_2a-i*t._l12_2a)/n}t.context.bezierCurveTo(l,s,a,o,t._x2,t._y2,r,t.lastPoint1)}function rh(t,e){return function(i,r,n={}){let{direction:l,startPoint:s}=n;if(i.length<2-Number(!!s))return null;if(i.length<3-Number(!!s))return i6(i,n);let a=i5(t,l,i);return i3(new e(a,r,s),i,2),a}}let rd=rh("catmullRom",class{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let{x:e,y:i}=t;if(this._point){let t=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2):this.context.moveTo(e,i);break;case 1:this._point=2;break;case 2:this._point=3;default:ro(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}),ru=rh("catmullRomClosed",class{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}point(t){let{x:e,y:i}=t;if(this._point){let t=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=i;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=i,t);break;case 2:this._point=3,this._x5=e,this._y5=i;break;default:ro(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}});function rc(t,e,i){var r,n;switch(e){case"linear":default:return i6(t,i);case"basis":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return i6(t,e);let n=i5("basis",i,t);return i3(new i8(n,r),t,2),n}(t,i);case"monotoneX":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return i6(t,e);let n=i5("monotoneX",i,t);return i3(new ri(n,r),t,2),n}(t,i);case"monotoneY":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return i6(t,e);let n=i5("monotoneY",i,t);return i3(new rr(n,r),t,2),n}(t,i);case"step":return rs(t,.5,i);case"stepClosed":return function(t,e,i={}){let{direction:r,startPoint:n}=i;if(t.length<2-Number(!!n))return null;let l=new i1("step",null!=r?r:(0,ik.Wn)(t[t.length-1].x-t[0].x)>(0,ik.Wn)(t[t.length-1].y-t[0].y)?o5.ROW:o5.COLUMN);return i3(new rl(l,.5,n),t,1),l}(t,0,i);case"stepBefore":return rs(t,0,i);case"stepAfter":return rs(t,1,i);case"catmullRom":return rd(t,null!=(r=null==i?void 0:i.curveTension)?r:.5,i);case"catmullRomClosed":return ru(t,null!=(n=null==i?void 0:i.curveTension)?n:.5,i);case"linearClosed":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;let n=i5("linear",i,t);return i3(new ra(n,r),t,1),n}(t,i)}}class rp extends iE{constructor(t){super(),this.commandList=[],t&&(this._ctx=t),this._boundsContext=new iB(this.bounds)}get curves(){return this.tryBuildCurves()}setCtx(t){this._ctx=t}moveTo(t,e){return this.commandList.push([iO.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}lineTo(t,e){return this.commandList.push([iO.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}quadraticCurveTo(t,e,i,r){return this.commandList.push([iO.Q,t,e,i,r]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,r),this}bezierCurveTo(t,e,i,r,n,l){return this.commandList.push([iO.C,t,e,i,r,n,l]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,r,n,l),this}arcTo(t,e,i,r,n){return this.commandList.push([iO.AT,t,e,i,r,n]),this._ctx&&this._ctx.arcTo(t,e,i,r,n),this}ellipse(t,e,i,r,n,l,s,a){return this.commandList.push([iO.E,t,e,i,r,n,l,s,a]),this._ctx&&this._ctx.ellipse(t,e,i,r,n,l,s,a),this}rect(t,e,i,r){return this.commandList.push([iO.R,t,e,i,r]),this._ctx&&this._ctx.rect(t,e,i,r),this}arc(t,e,i,r,n,l){return this.commandList.push([iO.A,t,e,i,r,n,l]),this._ctx&&this._ctx.arc(t,e,i,r,n,l),this}closePath(){return this.commandList.push([iO.Z]),this._ctx&&this._ctx.closePath(),this}addCurve(t){this._curves.push(t)}clear(){this.transformCbList=null,this.commandList.length=0,this._curves.length=0}beginPath(){this.clear()}tryBuildCurves(){if(!this._curves||!this._curves.length){let t=new i0(this);iZ(this.commandList,t,0,0,1,1)}return this._curves}toString(){if(!this.toStringCbList){let t=[];t[iO.M]=t=>`M${t[1]} ${t[2]}`,t[iO.L]=t=>`L${t[1]} ${t[2]}`,t[iO.Q]=t=>`Q${t[1]} ${t[2]} ${t[3]} ${t[4]}`,t[iO.C]=t=>`C${t[1]} ${t[2]} ${t[3]} ${t[4]} ${t[5]} ${t[6]}`,t[iO.A]=t=>{let e=[],i=t[1],r=t[2],n=t[3],l=t[4];iz(e,l,t[5],i,r,n,n,t[6]);let s="";for(let t=0;t<e.length;t+=6)s+=`C${e[t]} ${e[t+1]} ${e[t+2]} ${e[t+3]} ${e[t+4]} ${e[t+5]}`;return s},t[iO.R]=t=>`M${t[1]} ${t[2]} h${t[3]} v${t[4]} H${t[1]}Z`,t[iO.Z]=t=>"Z",this.toStringCbList=t}let t=this.toStringCbList,e="";return this.commandList.forEach(i=>{e+=t[i[0]](i)}),e}fromString(t,e,i,o,h){this.clear();let d=function(t){let e,i;if(!t)return[];let o=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(null===o)return[];let h=[];for(let t=0,d=o.length;t<d;t++)if(n=(r=o[t]).slice(1),e=[l=r[0]],null!==(i=n.match(iL))){for(let t=0,r=i.length;t<r;t++)Number.isNaN(s=parseFloat(i[t]))||e.push(s);if(a=iF[l],e.length-1>a){let t,i=l;for(let r=1,n=e.length;r<n;r+=a){t=[i];for(let i=r,n=r+a;i<n;i++)t.push(e[i]);h.push(t),"m"===i?i="l":"M"===i&&(i="L")}}else h.push(e)}else h.push(e);return h}(t);return this._runCommandStrList(d,e,i,o,h),this._updateBounds(),this}fromLine(t){let{points:e,curveType:i,clipRangeByDimension:r}=t.attribute;if(!e)return;let n=rc(e,i);"x"===r?this.direction=o5.ROW:"y"===r?this.direction=o5.COLUMN:"auto"===r&&(this.direction=n.direction),this._curves=n.curves}fromCustomPath2D(t,e,i,r,n){return this.clear(),this._runCommandList(t.commandList,e,i,r,n),this._updateBounds(),this}transform(t,e,i,r){let n=this.commandList;if(!this.transformCbList){let t=[];t[iO.M]=this.moveToTransform,t[iO.L]=this.lineToTransform,t[iO.Q]=this.quadraticCurveToTransform,t[iO.C]=this.bezierCurveToTransform,t[iO.AT]=this.arcToTransform,t[iO.E]=this.ellipseTransform,t[iO.R]=this.rectTransform,t[iO.A]=this.arcTransform,t[iO.Z]=this.closePathTransform,this.transformCbList=t}n.forEach(n=>{this.transformCbList[n[0]](n,t,e,i,r)}),this._updateBounds()}moveToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i}lineToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i}quadraticCurveToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r+e,t[4]=t[4]*n+i}bezierCurveToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r+e,t[4]=t[4]*n+i,t[5]=t[5]*r+e,t[6]=t[6]*n+i}arcToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r+e,t[4]=t[4]*n+i,t[5]=t[5]*(r+n)/2}ellipseTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r,t[4]=t[4]*n}rectTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r,t[4]=t[4]*n}arcTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*(r+n)/2}closePathTransform(){}_runCommandStrList(t,e=0,i=0,r=1,n=1){let l,s,a,o,h,d=null,u=0,c=0,p=0,g=0;for(let f=0,m=t.length;f<m;++f){switch(l=t[f],1===r&&1===n||(l=function(t,e,i){let r=rg[0]=t[0];if("a"===r||"A"===r)rg[1]=e*t[1],rg[2]=i*t[2],rg[3]=t[3],rg[4]=t[4],rg[5]=t[5],rg[6]=e*t[6],rg[7]=i*t[7];else if("h"===r||"H"===r)rg[1]=e*t[1];else if("v"===r||"V"===r)rg[1]=i*t[1];else for(let r=1,n=t.length;r<n;++r)rg[r]=(r%2==1?e:i)*t[r];return rg}(l,r,n)),l[0]){case"l":u+=l[1],c+=l[2],this.lineTo(u+e,c+i);break;case"L":u=l[1],c=l[2],this.lineTo(u+e,c+i);break;case"h":u+=l[1],this.lineTo(u+e,c+i);break;case"H":u=l[1],this.lineTo(u+e,c+i);break;case"v":c+=l[1],this.lineTo(u+e,c+i);break;case"V":c=l[1],this.lineTo(u+e,c+i);break;case"m":u+=l[1],c+=l[2],this.moveTo(u+e,c+i);break;case"M":u=l[1],c=l[2],this.moveTo(u+e,c+i);break;case"c":s=u+l[5],a=c+l[6],p=u+l[3],g=c+l[4],this.bezierCurveTo(u+l[1]+e,c+l[2]+i,p+e,g+i,s+e,a+i),u=s,c=a;break;case"C":u=l[5],c=l[6],p=l[3],g=l[4],this.bezierCurveTo(l[1]+e,l[2]+i,p+e,g+i,u+e,c+i);break;case"s":s=u+l[3],a=c+l[4],null===d[0].match(/[CcSs]/)?(p=u,g=c):(p=2*u-p,g=2*c-g),o=u+l[1],h=c+l[2],this.bezierCurveTo(p+e,g+i,o+e,h+i,s+e,a+i),p=o,g=h,u=s,c=a;break;case"S":s=l[3],a=l[4],null===d[0].match(/[CcSs]/)?(p=u,g=c):(p=2*u-p,g=2*c-g),o=l[1],h=l[2],this.bezierCurveTo(p+e,g+i,o+e,h+i,s+e,a+i),p=o,g=h,u=s,c=a;break;case"q":s=u+l[3],a=c+l[4],p=u+l[1],g=c+l[2],this.quadraticCurveTo(p+e,g+i,s+e,a+i),u=s,c=a;break;case"Q":s=l[3],a=l[4],this.quadraticCurveTo(l[1]+e,l[2]+i,s+e,a+i),u=s,c=a,p=l[1],g=l[2];break;case"t":s=u+l[1],a=c+l[2],null===d[0].match(/[QqTt]/)?(p=u,g=c):"t"===d[0]?(p=2*u-o,g=2*c-h):"q"===d[0]&&(p=2*u-p,g=2*c-g),o=p,h=g,this.quadraticCurveTo(p+e,g+i,s+e,a+i),u=s,c=a,p=u+l[1],g=c+l[2];break;case"T":s=l[1],a=l[2],p=2*u-p,g=2*c-g,this.quadraticCurveTo(p+e,g+i,s+e,a+i),u=s,c=a;break;case"a":iD(this,u+e,c+i,[l[1],l[2],l[3],l[4],l[5],l[6]+u+e,l[7]+c+i]),u+=l[6],c+=l[7];break;case"A":iD(this,u+e,c+i,[l[1],l[2],l[3],l[4],l[5],l[6]+e,l[7]+i]),u=l[6],c=l[7];break;case"z":case"Z":this.closePath()}d=l}}_runCommandList(t,e=0,i=0,r=1,n=1){if(0!==e||0!==i||1!==r||1!==n)for(let l=0,s=t.length;l<s;++l){let s=t[l].slice();switch(s[0]){case iO.L:this.lineToTransform(s,e,i,r,n);break;case iO.M:this.moveToTransform(s,e,i,r,n);break;case iO.C:this.bezierCurveToTransform(s,e,i,r,n);break;case iO.Q:this.quadraticCurveToTransform(s,e,i,r,n);break;case iO.A:this.arcToTransform(s,e,i,r,n);break;case iO.E:this.ellipseTransform(s,e,i,r,n);break;case iO.R:this.rectTransform(s,e,i,r,n);break;case iO.AT:this.arcToTransform(s,e,i,r,n);break;case iO.Z:this.closePath()}}else this.commandList=t.map(t=>t.slice())}_updateBounds(){this.bounds.clear(),iZ(this.commandList,this._boundsContext)}release(){this.commandList=[],this._boundsContext=null,this._ctx=null}getLength(){if(this.direction===o5.COLUMN){if(!this._curves.length)return 0;let t=this._curves[0],e=this._curves[this._curves.length-1];return(0,ik.Wn)(t.p0.y-e.p1.y)}if(this.direction===o5.ROW){if(!this._curves.length)return 0;let t=this._curves[0],e=this._curves[this._curves.length-1];return(0,ik.Wn)(t.p0.x-e.p1.x)}return this._curves.reduce((t,e)=>t+e.getLength(),0)}getYAt(t){if(!this.curves)return 1/0;for(let e=0;e<this.curves.length;e++){let i=this.curves[e];if(i.includeX(t))return i.getYAt(t)}return 1/0}getAttrAt(t){if(!this._curves)return{pos:{x:0,y:0},angle:0};let e,i=0;for(let r=0;r<this._curves.length;r++){let n=(e=this._curves[r]).getLength(this.direction);if(i+n>=t)break;i+=n}let r=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(r),angle:e.getAngleAt(r)}}drawWithClipRange(t,e,i,r,n){this.tryBuildCurves();let l=this.getLength()*n,s=0;for(let n=0;n<this._curves.length;n++){let a=this._curves[n],o=a.getLength(this.direction);if(!(s+o<=l)){let n=1-(s+o-l)/o;a.draw(t,i,r,e,e,n);break}a.draw(t,i,r,e,e,1),s+=o}}}let rg=["l",0,0,0,0,0,0,0],rf={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new iT.y},rm={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},ry={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},rv=Object.assign({outerBorder:Object.assign(Object.assign({},ry),{distance:0}),innerBorder:Object.assign(Object.assign({},ry),{distance:0})},ry),rb={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:"PingFang SC,Microsoft Yahei,system-ui,'-apple-system',segoe ui,\n    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",fontWeight:"",ellipsis:"…",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:o0.fontBounding,keepCenterInLine:!1},r_=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,autoAnimateTexture:!1,textureRatio:1,textureOptions:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,backgroundKeepAspectRatio:!1,backgroundClip:!0,backgroundScale:1,backgroundOffsetX:0,backgroundOffsetY:0,blur:0,filter:"",cursor:null,html:null,react:null,vue:null},rm),rv),{alignSelf:"auto"}),{pickStrokeBuffer:0}),rC={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},rx=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1,clipConfig:null,roughStyle:null},{_debug_bounds:!1}),r_),rf),rw=Object.assign(Object.assign({},rx),{startAngle:0,endAngle:ik.f7,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),rS=Object.assign(Object.assign(Object.assign({},rx),rC),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),rA=Object.assign(Object.assign({},rx),{radius:1,startAngle:0,endAngle:ik.f7}),rM=Object.assign(Object.assign({},rx),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1,cornerType:"round"}),rT=Object.assign(Object.assign({},rx),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),rk=Object.assign(Object.assign(Object.assign({},rx),rC),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),rR=Object.assign(Object.assign({},rx),{path:new rp,fillStrokeOrder:1,clipRange:1,customPath:()=>{iR.Y.getInstance().warn("空函数")}}),rP=Object.assign(Object.assign({},rx),{points:[],cornerRadius:0,closePath:!0}),rB=Object.assign(Object.assign({},rx),{width:100,height:100,spikes:5,thickness:.5}),rI=Object.assign(Object.assign({},rx),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0,cornerType:"round",drawStrokeWhenZeroWH:!1});Object.assign(Object.assign({},rx),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0,cornerType:"round",drawStrokeWhenZeroWH:!1});let rE=Object.assign(Object.assign({},rx),{symbolType:"circle",size:10,keepDirIn3d:!0,clipRange:1}),rL=Object.assign(Object.assign(Object.assign({},rx),rb),{strokeBoundsBuffer:0,keepDirIn3d:!0}),rF=Object.assign(Object.assign(Object.assign({},rx),rb),{upgradeAttrs:null,editable:!1,editOptions:null,ascentDescentMode:"actual",width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),rO=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0,maxWidth:500,maxHeight:500},rx),{fill:!0,cornerRadius:0,cornerType:"round"}),rH=Object.assign(Object.assign({},rO),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1});var rD=i(95723);let rz=function(){let t={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i},e="";function i(t){let i=Error(e+": "+t);throw i.source=e,i}function r(){return n("linear",t.linearGradient,l)||n("radial",t.radialGradient,a)||n("conic",t.conicGradient,s)}function n(e,r,n){let l=y(r);if(l){y(t.startCall)||i("Missing (");let r=function(r){let l=n();return l&&(y(t.comma)||i("Missing comma before color stops")),{type:e,orientation:l,colorStops:c(p)}}(0);return y(t.endCall)||i("Missing )"),r}}function l(){return m("directional",t.sideOrCorner,1)||m("angular",t.angleValue,1)}function s(){return m("angular",t.fromAngleValue,1)}function a(){let i,r,n=o();return n&&((i=[]).push(n),r=e,y(t.comma)&&((n=o())?i.push(n):e=r)),i}function o(){let t=function(){let t=m("shape",/^(circle)/i,0);return t&&(t.style=f()||h()),t}()||function(){let t=m("shape",/^(ellipse)/i,0);return t&&(t.style=g()||h()),t}();if(t)t.at=d();else{let e=h();if(e){t=e;let i=d();i&&(t.at=i)}else{let e=u();e&&(t={type:"default-radial",at:e})}}return t}function h(){return m("extent-keyword",t.extentKeywords,1)}function d(){if(m("position",/^at/,0)){let t=u();return t||i("Missing positioning value"),t}}function u(){let t={x:g(),y:g()};if(t.x||t.y)return{type:"position",value:t}}function c(e){let r=e(),n=[];if(r)for(n.push(r);y(t.comma);)(r=e())?n.push(r):i("One extra comma");return n}function p(){let e=m("hex",t.hexColor,1)||m("rgba",t.rgbaColor,1)||m("rgb",t.rgbColor,1)||m("literal",t.literalColor,0);return e||i("Expected color definition"),e.length=g(),e}function g(){return m("%",t.percentageValue,1)||m("position-keyword",t.positionKeywords,1)||f()}function f(){return m("px",t.pixelValue,1)||m("em",t.emValue,1)}function m(t,e,i){let r=y(e);if(r)return{type:t,value:r[i]}}function y(t){let i=/^[\n\r\t\s]+/.exec(e);i&&v(i[0].length);let r=t.exec(e);return r&&v(r[0].length),r}function v(t){e=e.substr(t)}return function(t){return e=t.toString(),function(){let t=c(r);return e.length>0&&i("Invalid input not EOF"),t}()}}();class rW{static IsGradient(t){return!("string"==typeof t&&!t.includes("gradient"))}static IsGradientStr(t){return"string"==typeof t&&t.includes("gradient")}static Parse(t){if(rW.IsGradientStr(t))try{let e=rz(t)[0];if(e){if("linear"===e.type)return rW.ParseLinear(e);if("radial"===e.type)return rW.ParseRadial(e);if("conic"===e.type)return rW.ParseConic(e)}}catch(t){}return t}static processColorStops(t){if(!t||0===t.length)return[];if(t.some(t=>t.length)){let e=t.map(t=>({color:t.value,offset:t.length?parseFloat(t.length.value)/100:-1}));e[0].offset<0&&(e[0].offset=0),e[e.length-1].offset<0&&(e[e.length-1].offset=1);for(let t=1;t<e.length-1;t++)if(e[t].offset<0){let i=t-1,r=t+1;for(;r<e.length&&e[r].offset<0;)r++;let n=e[i].offset,l=e[r].offset,s=r-i;for(let t=1;t<s;t++)e[i+t].offset=n+(l-n)*t/s;t=r-1}return e}return t.map((e,i)=>{let r=t.length>1?i/(t.length-1):0;return{color:e.value,offset:r}})}static ParseConic(t){let{orientation:e,colorStops:i=[]}=t,r=ik.pi/2,n=parseFloat(e.value)/180*ik.pi-r;return{gradient:"conical",x:.5,y:.5,startAngle:n,endAngle:n+ik.f7,stops:rW.processColorStops(i)}}static ParseRadial(t){let{colorStops:e=[]}=t;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:rW.processColorStops(e)}}static ParseLinear(t){let{orientation:e,colorStops:i=[]}=t,r=ik.pi/2,n="angular"===e.type?parseFloat(e.value)/180*ik.pi:0;for(;n<0;)n+=ik.f7;for(;n>=ik.f7;)n-=ik.f7;let l=0,s=0,a=0,o=0;return n<r?(l=0,s=1,a=Math.sin(n),o=s-Math.cos(n)):n<ik.pi?(l=0,s=0,a=Math.cos(n-r),o=Math.sin(n-r)):n<ik.pi+r?(s=0,a=(l=1)-Math.sin(n-ik.pi),o=Math.cos(n-ik.pi)):(a=(l=1)-Math.cos(n-r-ik.pi),o-=Math.sin(n-r-ik.pi)),{gradient:"linear",x0:l,y0:s,x1:a,y1:o,stops:rW.processColorStops(i)}}}function rZ(t,e,i){let r=e,{a:n,b:l,c:s,d:a}=t.currentMatrix,o=Math.sign(n)*Math.sqrt(n*n+l*l),h=Math.sign(a)*Math.sqrt(s*s+a*a);return o+h===0?0:r=r/Math.abs(o+h)*2*i}function rN(t,e,i,r=0,n=0){var l,s,a,o;let h,d;if(!e||!0===e)return"black";if((0,rD.Z)(e))for(let t=0;t<e.length&&!(d=e[t]);t++);else d=e;if("string"==typeof(d=rW.Parse(d)))return d;if(i.AABBBounds&&(!i.attribute||0!==i.attribute.scaleX||0!==i.attribute.scaleY)){let e=i.AABBBounds,u=e.x2-e.x1,c=e.y2-e.y1,p=e.x1-r,g=e.y1-n;if(i.attribute){let{scaleX:t=1,scaleY:e=1,angle:r=0}=i.attribute;u/=t,c/=e,p/=t,g/=e,(r||1!==t||1!==e)&&(p=null!=(l=i.x1WithoutTransform)?l:0,g=null!=(s=i.y1WithoutTransform)?s:0,u=null!=(a=i.widthWithoutTransform)?a:u,c=null!=(o=i.heightWithoutTransform)?o:c)}"linear"===d.gradient?h=function(t,e,i,r,n,l){var s,a,o,h;let d=t.createLinearGradient(i+(null!=(s=e.x0)?s:0)*n,r+(null!=(a=e.y0)?a:0)*l,i+(null!=(o=e.x1)?o:1)*n,r+(null!=(h=e.y1)?h:0)*l);return e.stops.forEach(t=>{d.addColorStop(t.offset,t.color)}),d}(t,d,p,g,u,c):"conical"===d.gradient?h=function(t,e,i,r,n,l){var s,a;let o=t.createConicGradient(i+(null!=(s=e.x)?s:0)*n,r+(null!=(a=e.y)?a:0)*l,e.startAngle,e.endAngle);return e.stops.forEach(t=>{o.addColorStop(t.offset,t.color)}),o.GetPattern?o.GetPattern(n+i,l+r,void 0):o}(t,d,p,g,u,c):"radial"===d.gradient&&(h=function(t,e,i,r,n,l){var s,a,o,h,d,u;let c=t.createRadialGradient(i+(null!=(s=e.x0)?s:.5)*n,r+(null!=(a=e.y0)?a:.5)*l,Math.max(n,l)*(null!=(o=e.r0)?o:0),i+(null!=(h=e.x1)?h:.5)*n,r+(null!=(d=e.y1)?d:.5)*l,Math.max(n,l)*(null!=(u=e.r1)?u:.5));return e.stops.forEach(t=>{c.addColorStop(t.offset,t.color)}),c}(t,d,p,g,u,c))}return h||"orange"}let rj={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},rG={fill:!0,stroke:!1};String.fromCharCode(160);let rV=/\w|\(|\)|-/,rU=/[.?!,;:/，。？！、；：]/,rK=/\S/,rX=(t,e)=>{let i=e.fontSize||16;switch(e.script){case"super":case"sub":i*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:i,fontFamily:e.fontFamily})};function rY(t,e,i,r,n){if(t.length<=1||!e||e<=0)return 0;let l=iC.graphicUtil.textMeasure,s=r,a=t.slice(0,s),o=Math.floor(l.measureText(a,i).width),h=t.slice(0,s+1),d=Math.floor(l.measureText(h,i).width);for(;o>e||d<=e;){if(o>e?s--:s++,s>t.length){s=t.length;break}if(s<0){s=0;break}a=t.slice(0,s),o=Math.floor(l.measureText(a,i).width),h=t.slice(0,s+1),d=Math.floor(l.measureText(h,i).width)}return n&&(s=r$(t,s)),s}function r$(t,e,i=!1){let r=e;for(;rV.test(t[r-1])&&rV.test(t[r])||rU.test(t[r]);)if(--r<=0)return i?function(t,e){let i=e;for(;rV.test(t[i+1])&&rV.test(t[i])||rU.test(t[i]);)if(++i>=t.length)return i;return i+1}(t,e):e;return r}function rq(t,e,i="actual"){var r;if(""===t)return{ascent:0,height:0,descent:0,width:0};let n=iC.graphicUtil.textMeasure.measureText(t,e),l={ascent:0,height:0,descent:0,width:0},s="actual"===i?n.actualBoundingBoxAscent:n.fontBoundingBoxAscent,a="actual"===i?n.actualBoundingBoxDescent:n.fontBoundingBoxDescent;"number"!=typeof s||"number"!=typeof a?(l.width=Math.floor(n.width),l.height=e.fontSize||0,l.ascent=l.height,l.descent=0):(l.width=Math.floor(n.width),l.height=Math.floor(s+a),l.ascent=Math.floor(s),l.descent=l.height-l.ascent);let o=null!=(r=e.space)?r:0;return l.width+=o,l}let rJ=class{constructor(){this.id="ATextMeasure"}configure(t,e){this.canvas=t.canvas,this.context=t.context,t.bindTextMeasure(this)}_measureTextWithoutAlignBaseline(t,e,i){this.context.setTextStyleWithoutAlignBaseline(e);let r=this.context.measureText(t);return i?this.compatibleMetrics(r,e):r}_measureTextWithAlignBaseline(t,e,i){this.context.setTextStyle(e);let r=this.context.measureText(t);return i?this.compatibleMetrics(r,e):r}compatibleMetrics(t,e){if(null==t.actualBoundingBoxAscent||null==t.actualBoundingBoxDescent||null==t.fontBoundingBoxAscent||null==t.fontBoundingBoxDescent){t={width:t.width};let{ascent:i,descent:r}=this.measureTextBoundADscentEstimate(e);t.actualBoundingBoxAscent=i,t.actualBoundingBoxDescent=r,t.fontBoundingBoxAscent=i,t.fontBoundingBoxDescent=r}if(null==t.actualBoundingBoxLeft||null==t.actualBoundingBoxRight){t={width:t.width,actualBoundingBoxAscent:t.actualBoundingBoxAscent,actualBoundingBoxDescent:t.actualBoundingBoxDescent,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent};let{left:i,right:r}=this.measureTextBoundLeftRightEstimate(e);t.actualBoundingBoxLeft=i,t.actualBoundingBoxRight=r}return t}estimate(t,{fontSize:e=rL.fontSize}){let i=0,r=0;for(let e=0;e<t.length;e++)128>t.charCodeAt(e)?i++:r++;return{width:~~(.8*i*e+r*e),height:e}}measureTextWidth(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}measureTextBoundsWidth(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}measureTextBoundsLeftRight(t,e,i){return this.context?{left:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxLeft,right:i.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(e)}measureTextPixelHeight(t,e,i){var r;return this.context?Math.abs((i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0)).actualBoundingBoxAscent-i.actualBoundingBoxDescent):null!=(r=e.fontSize)?r:rb.fontSize}measureTextPixelADscent(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}measureTextBoundHieght(t,e,i){var r;return this.context?Math.abs((i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0)).fontBoundingBoxAscent-i.fontBoundingBoxDescent):null!=(r=e.fontSize)?r:rb.fontSize}measureTextBoundADscent(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).fontBoundingBoxAscent,descent:i.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}measureTextBoundADscentEstimate(t){var e;let i=null!=(e=t.fontSize)?e:rb.fontSize;return{ascent:.79*i,descent:.21*i}}measureTextBoundLeftRightEstimate(t){var e;let i=null!=(e=t.fontSize)?e:rb.fontSize,{textAlign:r}=t;return"center"===r?{left:i/2,right:i/2}:"right"===r||"end"===r?{left:i,right:0}:{left:0,right:i}}measureTextPixelADscentAndWidth(t,e,i){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:this.estimate(t,e).width});let r=this._measureTextWithoutAlignBaseline(t,e,!0);if(i===o0.actualBounding)return{ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,width:r.width};if(i===o0.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:r.width});if(i===o0.fontBounding){let t=r.fontBoundingBoxAscent,e=r.fontBoundingBoxDescent;if(r.actualBoundingBoxDescent&&e<r.actualBoundingBoxDescent){let i=r.actualBoundingBoxDescent-e;e+=i,t-=i}else if(r.actualBoundingBoxAscent&&t<r.actualBoundingBoxAscent){let i=r.actualBoundingBoxAscent-t;t+=i,e-=i}return{ascent:t,descent:e,width:r.width}}return{ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,width:r.width}}measureText(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t)):this.estimate(t,e)}clipTextVertical(t,e,i,r){if(0===t.length)return{verticalList:t,width:0};let{fontSize:n=12}=e;t.forEach(t=>{t.width=0===t.direction?n:this.measureTextWidth(t.text,e)});let l=[],s=0,a=0;for(;a<t.length&&s+t[a].width<i;a++)s+=t[a].width,l.push(t[a]);if(t[a]&&t[a].text.length>1){let n=this._clipText(t[a].text,e,i-s,0,t[a].text.length-1,"end",!1);if(r&&n.str!==t[a].text){let i="",r=0;for(let e=0;e<a;e++){let n=t[e];i+=n.text,r+=n.text.length}i+=t[a].text;let l=r$(i,r+n.str.length);(l-=r)!=n.str.length-1&&(n.str=n.str.substring(0,l),n.width=this.measureTextWidth(n.str,e))}l.push(Object.assign(Object.assign({},t[a]),{text:n.str,width:n.width})),s+=n.width}return{verticalList:l,width:s}}clipText(t,e,i,r,n){if(0===t.length)return{str:"",width:0};let l=this.measureTextWidth(t,e);if(l<=i)return{str:t,width:l};if((l=this.measureTextWidth(t[0],e))>i)return{str:"",width:0};let s=this._clipText(t,e,i,0,t.length-1,"end",!1);if(r&&s.str!==t){let i=r$(t,s.str.length,n);i!==s.str.length&&(i>s.str.length&&(s.wordBreaked=i,i=s.str.length),s.str=t.substring(0,i),s.width=this.measureTextWidth(s.str,e))}return s}_clipText(t,e,i,r,n,l,s){let a;if("start"===l)a=this._clipTextStart(t,e,i,r,n),s&&(a.result=s+a.str);else if("middle"===l){let r=this._clipTextMiddle(t,e,i,"","",0,0,1);a={str:"none",width:r.width,result:r.left+s+r.right}}else a=this._clipTextEnd(t,e,i,r,n),s&&(a.result=a.str+s);return a}_clipTextEnd(t,e,i,r,n){let l;if(r===n){iR.Y.getInstance().warn(`【_clipTextEnd】不应该走到这里${t}, ${r}, ${n}`);let i=t.substring(0,n+1);return{str:i,width:this.measureTextWidth(i,e)}}let s=Math.floor((r+n)/2),a=t.substring(0,s+1),o=this.measureTextWidth(a,e);if(o>i){if(a.length<=1)return{str:"",width:0};let n=t.substring(0,s);return(l=this.measureTextWidth(n,e))<=i?{str:n,width:l}:this._clipTextEnd(t,e,i,r,s)}if(o<i){if(s>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};let r=t.substring(0,s+2);return(l=this.measureTextWidth(r,e))>=i?{str:a,width:o}:this._clipTextEnd(t,e,i,s,n)}return{str:a,width:o}}_clipTextStart(t,e,i,r,n){let l,s=Math.ceil((r+n)/2),a=t.substring(s-1,t.length),o=this.measureTextWidth(a,e);if(o>i){if(a.length<=1)return{str:"",width:0};let r=t.substring(s,t.length);return(l=this.measureTextWidth(r,e))<=i?{str:r,width:l}:this._clipTextStart(t,e,i,s,t.length)}if(o<i){if(s<=0)return{str:t,width:this.measureTextWidth(t,e)};let n=t.substring(s-2,t.length);return(l=this.measureTextWidth(n,e))>=i?{str:a,width:o}:this._clipTextStart(t,e,i,r,s)}return{str:a,width:o}}_clipTextMiddle(t,e,i,r,n,l,s,a){let o=t.substring(0,a),h=this.measureTextWidth(o,e);if(h+s>i)return{left:r,right:n,width:l+s};let d=t.substring(t.length-a,t.length),u=this.measureTextWidth(d,e);return h+u>i?{left:o,right:n,width:h+s}:this._clipTextMiddle(t,e,i,o,d,h,u,a+1)}clipTextWithSuffixVertical(t,e,i,r,n,l){let s;if(""===r)return this.clipTextVertical(t,e,i,n);if(0===t.length)return{verticalList:t,width:0};let a=this.clipTextVertical(t,e,i,n);if(a.verticalList.length===t.length&&a.verticalList[a.verticalList.length-1].width===t[t.length-1].width)return a;let o=this.measureTextWidth(r,e);if(o>i)return a;if(i-=o,"start"===l){let l=this.revertVerticalList(t);s=this.clipTextVertical(l,e,i,n);let a=this.revertVerticalList(s.verticalList);a.unshift({text:r,direction:1,width:o}),s.verticalList=a}else if("middle"===l){let l=this.clipTextVertical(t,e,i/2,n),a=this.revertVerticalList(t),h=this.clipTextVertical(a,e,i/2,n);l.verticalList.push({text:r,direction:1,width:o}),this.revertVerticalList(h.verticalList).forEach(t=>l.verticalList.push(t)),s={verticalList:l.verticalList,width:l.width+h.width}}else(s=this.clipTextVertical(t,e,i,n)).verticalList.push({text:r,direction:1,width:o});return s.width+=o,s}revertVerticalList(t){return t.reverse().map(t=>{let e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})})}clipTextWithSuffix(t,e,i,r,n,l,s=!1){if(""===r)return this.clipText(t,e,i,n);if(0===t.length)return{str:"",width:0};let a=this.measureTextWidth(t,e);if(!s&&a<=i)return{str:t,width:a};let o=this.measureTextWidth(r,e);if(o>i)return{str:"",width:0};if(s&&a+o<=i)return{str:t+r,width:a+o};i-=o;let h=this._clipText(t,e,i,0,t.length-1,l,r);if(n&&h.str!==t){let i=r$(t,h.str.length);i!==h.str.length&&(h.result=t.substring(0,i),h.width=this.measureTextWidth(h.str,e))}else s&&h.str===t&&(h.result=t+r);return h.str=h.result,h.width+=o,h}};rJ=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],rJ);let rQ=Symbol.for("TextMeasureContribution"),r0=class extends rJ{constructor(){super(...arguments),this.id="DefaultTextMeasureContribution"}};r0=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],r0);var r1=i(64449),r2=i(42708);let r3=Symbol.for("CanvasFactory"),r5=Symbol.for("Context2dFactory");function r4(t){return ib.getNamed(r3,iC.global.env)(t)}let r6=Math.sqrt(3),r7=1/3;function r8(t){return t>-na&&t<na}let r9=[0,0],nt=[0,0],ne=[0,0];function ni(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function nr(t,e,i,r){let n=1-r;return n*(n*t+2*r*e)+r*r*i}function nn(t,e,i,r,n){let l=1-n;return l*l*(l*t+3*n*e)+n*n*(n*r+3*l*i)}function nl(t){return(t%=ik.f7)<0&&(t+=ik.f7),t}function ns(t,e,i,r,n,l,s){if(0===n)return!1;let a=n/2,o=0,h=t;if(s>e+a&&s>r+a||s<e-a&&s<r-a||l>t+a&&l>i+a||l<t-a&&l<i-a)return!1;if(t===i)return Math.abs(l-t)<=n/2;let d=(o=(e-r)/(t-i))*l-s+(t*r-i*e)/(t-i);return d*d/(o*o+1)<=n/2*n/2}let na=1e-4,no=[-1,-1,-1],nh=[-1,-1];function nd(t){return Math.round(t/ik.pi*1e8)/1e8%2*ik.pi}let nu=[0,0];function nc(t,e,i,r,n){let l=t.length,s,a,o=0,h=0,d=0,u=0,c=0;for(let y=0;y<l;y++){var p,g,f,m;let l=t[y],v=0===y;l[0]===iO.M&&y>1&&(i||(o+=(0,r2.N0)(h,d,u,c,r,n))),v&&(h=l[1],d=l[2],u=h,c=d);let b=l[0],_=l[1],C=l[2],x=l[3],w=l[4],S=l[5],A=l[6],M=w,T=S;nu[0]=M,nu[1]=T,function(t,e){let i=nd(t[0]);i<0&&(i+=ik.f7);let r=i-t[0],n=t[1];n+=r,!e&&n-i>=ik.f7?n=i+ik.f7:e&&i-n>=ik.f7?n=i-ik.f7:!e&&i>n?n=i+(ik.f7-nd(i-n)):e&&i<n&&(n=i-(ik.f7-nd(n-i))),t[0]=i,t[1]=n}(nu,!!l[6]),M=nu[0],T=nu[1];let k=M,R=T-M,P=!!(1-!l[6]),B=(r-_)*x/x+_;switch(b){case iO.M:u=_,c=C,h=u,d=c;break;case iO.L:if(i){if(ns(h,d,_,C,e,r,n))return!0}else o+=(0,r2.N0)(h,d,_,C,r,n)||0;h=_,d=C;break;case iO.C:if(i){if(p=h,g=d,0!==e&&(!(n>g+e)||!(n>C+e)||!(n>w+e)||!(n>A+e))&&(!(n<g-e)||!(n<C-e)||!(n<w-e)||!(n<A-e))&&(!(r>p+e)||!(r>_+e)||!(r>x+e)||!(r>S+e))&&(!(r<p-e)||!(r<_-e)||!(r<x-e)||!(r<S-e))&&function(t,e,i,r,n,l,s,a,o,h,d){let u,c,p,g,f=0,m=.005,y=1/0;r9[0]=o,r9[1]=h;for(let o=0;o<1;o+=.05)nt[0]=nn(t,i,n,s,o),nt[1]=nn(e,r,l,a,o),(p=ni(r9,nt))<y&&(f=o,y=p);y=1/0;for(let o=0;o<32&&!(m<1e-4);o++)u=f-m,c=f+m,nt[0]=nn(t,i,n,s,u),nt[1]=nn(e,r,l,a,u),p=ni(nt,r9),u>=0&&p<y?(f=u,y=p):(ne[0]=nn(t,i,n,s,c),ne[1]=nn(e,r,l,a,c),g=ni(ne,r9),c<=1&&g<y?(f=c,y=g):m*=.5);return Math.sqrt(y)}(p,g,_,C,x,w,S,A,r,n,0)<=e/2)return!0}else o+=function(t,e,i,r,n,l,s,a,o,h){if(h>e&&h>r&&h>l&&h>a||h<e&&h<r&&h<l&&h<a)return 0;let d=function(t,e,i,r,n,l){let s=r+3*(e-i)-t,a=3*(i-2*e+t),o=3*(e-t),h=t-n,d=a*a-3*s*o,u=a*o-9*s*h,c=o*o-3*a*h,p=0;if(r8(d)&&r8(u))if(r8(a))l[0]=0;else{let t=-o/a;t>=0&&t<=1&&(l[p++]=t)}else{let t=u*u-4*d*c;if(r8(t)){let t=u/d,e=-a/s+t,i=-t/2;e>=0&&e<=1&&(l[p++]=e),i>=0&&i<=1&&(l[p++]=i)}else if(t>0){let e=Math.sqrt(t),i=d*a+1.5*s*(-u+e),r=d*a+1.5*s*(-u-e),n=(-a-((i=i<0?-Math.pow(-i,r7):Math.pow(i,r7))+(r=r<0?-Math.pow(-r,r7):Math.pow(r,r7))))/(3*s);n>=0&&n<=1&&(l[p++]=n)}else{let t=Math.acos((2*d*a-3*s*u)/(2*Math.sqrt(d*d*d)))/3,e=Math.sqrt(d),i=Math.cos(t),r=(-a-2*e*i)/(3*s),n=(-a+e*(i+r6*Math.sin(t)))/(3*s),o=(-a+e*(i-r6*Math.sin(t)))/(3*s);r>=0&&r<=1&&(l[p++]=r),n>=0&&n<=1&&(l[p++]=n),o>=0&&o<=1&&(l[p++]=o)}}return p}(e,r,l,a,h,no);if(0===d)return 0;let u=0,c=-1,p=0,g=0;for(let h=0;h<d;h++){let d=no[h],f=0===d||1===d?.5:1;nn(t,i,n,s,d)<o||(c<0&&(c=function(t,e,i,r,n){let l=6*i-12*e+6*t,s=9*e+3*r-3*t-9*i,a=3*e-3*t,o=0;if(r8(s)){if(l>na||l<-na){let t=-a/l;t>=0&&t<=1&&(n[o++]=t)}}else{let t=l*l-4*s*a;if(r8(t))n[0]=-l/(2*s);else if(t>0){let e=Math.sqrt(t),i=(-l+e)/(2*s),r=(-l-e)/(2*s);i>=0&&i<=1&&(n[o++]=i),r>=0&&r<=1&&(n[o++]=r)}}return o}(e,r,l,a,nh),nh[1]<nh[0]&&c>1&&function(){let t=nh[0];nh[0]=nh[1],nh[1]=t}(),p=nn(e,r,l,a,nh[0]),c>1&&(g=nn(e,r,l,a,nh[1]))),2===c?d<nh[0]?u+=p<e?f:-f:d<nh[1]?u+=g<p?f:-f:u+=a<g?f:-f:d<nh[0]?u+=p<e?f:-f:u+=a<p?f:-f)}return u}(h,d,_,C,x,w,S,A,r,n)||0;h=S,d=A;break;case iO.Q:if(i){if(f=h,m=d,0!==e&&(!(n>m+e)||!(n>C+e)||!(n>w+e))&&(!(n<m-e)||!(n<C-e)||!(n<w-e))&&(!(r>f+e)||!(r>_+e)||!(r>x+e))&&(!(r<f-e)||!(r<_-e)||!(r<x-e))&&function(t,e,i,r,n,l,s,a,o){let h=0,d=.005,u=1/0;r9[0]=s,r9[1]=a;for(let s=0;s<1;s+=.05){nt[0]=nr(t,i,n,s),nt[1]=nr(e,r,l,s);let a=ni(r9,nt);a<u&&(h=s,u=a)}u=1/0;for(let s=0;s<32&&!(d<1e-4);s++){let s=h-d,a=h+d;nt[0]=nr(t,i,n,s),nt[1]=nr(e,r,l,s);let o=ni(nt,r9);if(s>=0&&o<u)h=s,u=o;else{ne[0]=nr(t,i,n,a),ne[1]=nr(e,r,l,a);let s=ni(ne,r9);a<=1&&s<u?(h=a,u=s):d*=.5}}return Math.sqrt(u)}(f,m,_,C,x,w,r,n,0)<=e/2)return!0}else o+=function(t,e,i,r,n,l,s,a){if(a>e&&a>r&&a>l||a<e&&a<r&&a<l)return 0;let o=function(t,e,i,r,n){let l=t-2*e+i,s=2*(e-t),a=t-r,o=0;if(r8(l)){if(s>na||s<-na){let t=-a/s;t>=0&&t<=1&&(n[o++]=t)}}else{let t=s*s-4*l*a;if(r8(t)){let t=-s/(2*l);t>=0&&t<=1&&(n[o++]=t)}else if(t>0){let e=Math.sqrt(t),i=(-s+e)/(2*l),r=(-s-e)/(2*l);i>=0&&i<=1&&(n[o++]=i),r>=0&&r<=1&&(n[o++]=r)}}return o}(e,r,l,a,no);if(0===o)return 0;let h=function(t,e,i){let r=t+i-2*e;return 0===r?.5:(t-e)/r}(e,r,l);if(h>=0&&h<=1){let a=0,d=nr(e,r,l,h);for(let r=0;r<o;r++){let o=0===no[r]||1===no[r]?.5:1;nr(t,i,n,no[r])<s||(no[r]<h?a+=d<e?o:-o:a+=l<d?o:-o)}return a}let d=0===no[0]||1===no[0]?.5:1;return nr(t,i,n,no[0])<s?0:l<e?d:-d}(h,d,_,C,x,w,r,n)||0;h=x,d=w;break;case iO.A:if(s=Math.cos(k)*x+_,a=Math.sin(k)*x+C,v?(u=s,c=a):o+=(0,r2.N0)(h,d,s,a,r,n),i){if(function(t,e,i,r,n,l,s,a,o){if(0===s)return!1;let h=Math.sqrt((a-=t)*a+(o-=e)*o);if(h-s>i||h+s<i)return!1;if(Math.abs(r-n)%ik.f7<1e-4)return!0;if(l){let t=r;r=nl(n),n=nl(t)}else r=nl(r),n=nl(n);r>n&&(n+=ik.f7);let d=Math.atan2(o,a);return d<0&&(d+=ik.f7),d>=r&&d<=n||d+ik.f7>=r&&d+ik.f7<=n}(_,C,x,k,k+R,P,e,B,n))return!0}else o+=function(t,e,i,r,n,l,s,a){if((a-=e)>i||a<-i)return 0;let o=Math.sqrt(i*i-a*a);no[0]=-o,no[1]=o;let h=Math.abs(r-n);if(h<1e-4)return 0;if(h>=ik.f7-1e-4)return r=0,n=ik.f7,s>=no[0]+t&&s<=no[1]+t?l?1:-1:0;if(r>n){let t=r;r=n,n=t}r<0&&(r+=ik.f7,n+=ik.f7);let d=0;for(let e=0;e<2;e++){let i=no[e];if(i+t>s){let t=Math.atan2(a,i),e=l?1:-1;t<0&&(t=ik.f7+t),(t>=r&&t<=n||t+ik.f7>=r&&t+ik.f7<=n)&&(t>ik.pi/2&&t<1.5*ik.pi&&(e=-e),d+=e)}}return d}(_,C,x,k,k+R,P,B,n);h=Math.cos(k+R)*x+_,d=Math.sin(k+R)*x+C;break;case iO.R:if(u=h=_,c=d=C,s=u+x,a=c+w,i){if(ns(u,c,s,c,e,r,n)||ns(s,c,s,a,e,r,n)||ns(s,a,u,a,e,r,n)||ns(u,a,u,c,e,r,n))return!0}else o+=(0,r2.N0)(s,c,s,a,r,n),o+=(0,r2.N0)(u,a,u,c,r,n);break;case iO.Z:if(i){if(ns(h,d,u,c,e,r,n))return!0}else o+=(0,r2.N0)(h,d,u,c,r,n);h=u,d=c}}return i||Math.abs(d-c)<na||(o+=(0,r2.N0)(h,d,u,c,r,n)||0),0!==o}let np=new class{constructor(){this.pools=[],this.allocatedCanvas=[]}shareCanvas(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}getCommonCanvas(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}allocate(t){if(!this.pools.length){let e=r4(Object.assign({nativeCanvas:iC.global.createCanvas(t)},t));return this.allocatedCanvas.push(e),e}let e=this.pools.pop();return e.resize(t.width,t.height),e.dpr=t.dpr,e}allocateByObj(t){if(!this.pools.length){let e={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},i=r4(Object.assign({nativeCanvas:iC.global.createCanvas(e)},e));return this.allocatedCanvas.push(i),i}let e=this.pools.pop();return e.width=t.width,e.height=t.height,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}};var ng=i(36163);let nf=Symbol.for("VWindow"),nm=Symbol.for("WindowHandlerContribution"),ny=class extends iS{get width(){if(this._handler){let t=this._handler.getWH();return this._width=t.width}return this._width}get height(){if(this._handler){let t=this._handler.getWH();return this._height=t.height}return this._height}get dpr(){return this._handler.getDpr()}constructor(){super(),this.hooks={onChange:new io(["x","y","width","height"])},this.active=()=>{let t=this.global;t.env&&!this.actived&&(ib.getNamed(nm,t.env).configure(this,t),this.actived=!0)},this._uid=eJ.GenAutoIncrementId(),this.global=iC.global,this.postInit()}_nativeAddEventListener(t,e,i){return this._handler.addEventListener(t,e,i)}_nativeRemoveEventListener(t,e,i){return this._handler.removeEventListener(t,e,i)}_nativeDispatchEvent(t){return this._handler.dispatchEvent(t)}postInit(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}get style(){var t;return null!=(t=this._handler.getStyle())?t:{}}set style(t){this._handler.setStyle(t)}create(t){var e,i;this._handler.createWindow(t);let r=this._handler.getWH();this._width=r.width,this._height=r.height,t.viewBox?this.setViewBox(t.viewBox):!1!==t.canvasControled?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:null!=(e=t.width)?e:this._width,y2:null!=(i=t.height)?i:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}setWindowHandler(t){this._handler=t}setDpr(t){return this._handler.setDpr(t)}resize(t,e){return this._handler.resizeWindow(t,e)}configure(){throw Error("暂不支持")}release(){return this.global.hooks.onSetEnv.unTap("window",this.active),this.clearAllEventListeners(),this._handler.releaseWindow()}getContext(){return this._handler.getContext()}getNativeHandler(){return this._handler.getNativeHandler()}getImageBuffer(t){return this._handler.getImageBuffer?this._handler.getImageBuffer(t):null}getBoundingClientRect(){return this._handler.getBoundingClientRect()}getContainer(){return this._handler.container}clearViewBox(t){this._handler.clearViewBox(t)}setViewBox(t){this._handler.setViewBox(t)}setViewBoxTransform(t,e,i,r,n,l){this._handler.setViewBoxTransform(t,e,i,r,n,l)}getViewBox(){return this._handler.getViewBox()}getViewBoxTransform(){return this._handler.getViewBoxTransform()}pointTransform(t,e){let i=this._handler.getViewBox(),r={x:t,y:e};return this._handler.getViewBoxTransform().transformPoint({x:t,y:e},r),r.x-=i.x1,r.y-=i.y1,r}hasSubView(){let t=this._handler.getViewBox();return!(0===t.x1&&0===t.y1&&(0,ng.Yt)(this.width,t.width())&&(0,ng.Yt)(this.height,t.height()))}isVisible(t){return this._handler.isVisible(t)}onVisibleChange(t){return this._handler.onVisibleChange(t)}getTopLeft(t){return this._handler.getTopLeft(t)}};ny=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],ny);var nv=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s},nb=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},n_=function(t,e){return function(i,r){e(i,r,t)}};let nC=class{get canvas(){return this.tryInitCanvas(),this._canvas}get context(){return this.tryInitCanvas(),this._context}constructor(t){this.contributions=t,this.configured=!1,this.global=iC.global,this._textMeasureMap=new Map,this.global.hooks.onSetEnv.tap("graphic-util",(t,e,i)=>{this.configured=!1,this.configure(i,e)})}get textMeasure(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}getTextMeasureInstance(t){return t&&this._textMeasureMap.get(t)||this.textMeasure}configure(t,e){this.configured||(this.contributions.getContributions().forEach(t=>{t.configure(this,e)}),this.configured=!0)}tryInitCanvas(){if(!this._canvas){let t=np.shareCanvas();this._canvas=t,this._context=t.getContext("2d")}}bindTextMeasure(t){this._textMeasure&&"DefaultTextMeasureContribution"!==t.id||(this._textMeasure=t),this._textMeasureMap.has(t.id)||this._textMeasureMap.set(t.id,t)}measureText(t,e,i="native"){var r;this.configure(this.global,this.global.env);let n=this.global.measureTextMethod;this.global.measureTextMethod=i;let l={width:this._textMeasure.measureTextWidth(t,e),height:null!=(r=e.fontSize)?r:rb.fontSize};return this.global.measureTextMethod=n,l}createTextMeasureInstance(t,e,i){return this.configure(this.global,this.global.env),new r1.e(Object.assign({defaultFontParams:{fontFamily:rb.fontFamily,fontSize:rb.fontSize},getCanvasForMeasure:i||(()=>this.canvas),getTextBounds:void 0,specialCharSet:"-/: .,@%'\"~"+r1.e.ALPHABET_CHAR_SET+r1.e.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)}drawGraphicToCanvas(t,e,i){if(!e.defaultLayer)return null;let r=ib.get(nf),n=t.AABBBounds,l=n.width(),s=n.height(),a=-n.x1,o=-n.y1;r.create({viewBox:{x1:a,y1:o,x2:n.x2,y2:n.y2},width:l,height:s,canvas:i,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""});let h=e.params.optimize.disableCheckGraphicWidthOutRange;e.params.optimize.disableCheckGraphicWidthOutRange=!0,e.defaultLayer.getNativeHandler().drawTo(r,[t],{transMatrix:r.getViewBoxTransform(),viewBox:r.getViewBox(),stage:e,layer:e.defaultLayer,renderService:e.renderService,background:"transparent",clear:!0,updateBounds:!1}),e.params.optimize.disableCheckGraphicWidthOutRange=h;let d=r.getNativeHandler();return d.nativeCanvas?d.nativeCanvas:null}};nC=nv([e6(),n_(0,it(ii)),n_(0,ie(rQ)),nb("design:paramtypes",[Object])],nC),(oX=o7||(o7={}))[oX.transform=0]="transform",oX[oX.matrix=1]="matrix";let nx=new iT.y,nw=class{constructor(){this.matrix=new iT.y}init(t){return this.mode=o7.transform,this.originTransform=t,this.matrix.reset(),this}fromMatrix(t,e){return this.mode=o7.matrix,this.outSourceMatrix=t,this.outTargetMatrix=e,this}scaleMatrix(t,e,i){let r=this.outSourceMatrix;if(nx.setValue(r.a,r.b,r.c,r.d,r.e,r.f),this.outTargetMatrix.reset(),i){let{x:r,y:n}=i;this.outTargetMatrix.translate(r,n),this.outTargetMatrix.scale(t,e),this.outTargetMatrix.translate(-r,-n)}else this.outTargetMatrix.scale(t,e);return this.outTargetMatrix.multiply(nx.a,nx.b,nx.c,nx.d,nx.e,nx.f),this}rotateMatrix(t,e){let i=this.outSourceMatrix;if(nx.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){let{x:i,y:r}=e;this.outTargetMatrix.translate(i,r),this.outTargetMatrix.rotate(t),this.outTargetMatrix.translate(-i,-r)}else this.outTargetMatrix.rotate(t);return this.outTargetMatrix.multiply(nx.a,nx.b,nx.c,nx.d,nx.e,nx.f),this}scale(t,e,i){return this.mode===o7.matrix?this.scaleMatrix(t,e,i):this}rotate(t,e){return this.mode===o7.matrix?this.rotateMatrix(t,e):this}translateMatrix(t,e){let i=this.outSourceMatrix;return nx.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(t,e),this.outTargetMatrix.multiply(nx.a,nx.b,nx.c,nx.d,nx.e,nx.f),this}translate(t,e){return this.mode===o7.matrix?this.translateMatrix(t,e):this}simplify(t){return this.mode===o7.matrix?this.simplifyMatrix(t):this}simplifyMatrix(t){return this}};nw=nv([e6(),nb("design:paramtypes",[])],nw);let nS={arc:rw,area:rS,circle:rA,line:rk,path:rR,symbol:rE,text:rL,rect:rI,polygon:rP,star:rB,richtext:rF,richtextIcon:rH,image:rO,group:rM,glyph:rT},nA=Object.keys(nS);function nM(t,e){Object.keys(e).forEach(i=>{t[i]=e[i]})}let nT={arc:Object.assign({},nS.arc),area:Object.assign({},nS.area),circle:Object.assign({},nS.circle),line:Object.assign({},nS.line),path:Object.assign({},nS.path),symbol:Object.assign({},nS.symbol),text:Object.assign({},nS.text),rect:Object.assign({},nS.rect),polygon:Object.assign({},nS.polygon),star:Object.assign({},nS.star),richtext:Object.assign({},nS.richtext),richtextIcon:Object.assign({},nS.richtextIcon),image:Object.assign({},nS.image),group:Object.assign({},nS.group),glyph:Object.assign({},nS.glyph)};class nk{constructor(){this.initTheme(),this.dirty=!1}initTheme(){this._defaultTheme={},nA.forEach(t=>{this._defaultTheme[t]=Object.create(nT[t])}),this.combinedTheme=this._defaultTheme}getTheme(t){if(!t||!this.dirty)return this.combinedTheme;let e={},i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}getParentWithTheme(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}applyTheme(t,e,i=!1){if(this.dirty){let r=this.getParentWithTheme(t);if(r){let t=r.theme;(t.dirty||i)&&t.applyTheme(r,e,!0)}this.userTheme?this.doCombine(r&&r.theme.combinedTheme):(r?this.combinedTheme=r.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,iR.Y.getInstance().warn("未知错误，走到不应该走的区域里")),this.dirty=!1)}return this.combinedTheme}doCombine(t){let e=this.userTheme,i=this.combinedTheme;nA.forEach(r=>{let n=Object.create(nT[r]);t&&t[r]&&nM(n,t[r]),i[r]&&nM(n,i[r]),e[r]&&nM(n,e[r]),this.combinedTheme[r]=n}),e.common&&nA.forEach(t=>{nM(this.combinedTheme[t],e.common)}),this.dirty=!1}setTheme(t,e){let i=this.userTheme;i?Object.keys(t).forEach(e=>{i[e]?Object.assign(i[e],t[e]):i[e]=Object.assign({},t[e])}):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}resetTheme(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}dirtyChildren(t){t.forEachChildren(t=>{t.isContainer&&(t.theme&&(t.theme.dirty=!0),this.dirtyChildren(t))})}}let nR=new nk;function nP(t,e){return t.glyphHost?nP(t.glyphHost):e?(t.isContainer,e):function(t){let e;if(e=t.isContainer?t:t.parent){for(;e&&!e.theme;)e=e.parent;return e?(e.theme||e.createTheme(),e.theme.getTheme(e)):nR.getTheme()}return null}(t)||t.attachedThemeGraphic&&nP(t.attachedThemeGraphic)||nR.getTheme()}var nB=i(54326),nI=i(83624),nE=i(36410),nL=i(6761),nF=i(80971),nO=i(21883),nH=i.n(nO),nD=i(63778),nz=i(96241);class nW extends nH(){get previousSibling(){return this._prev}get nextSibling(){return this._next}get children(){return this.getChildren()}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}get count(){return this._count}get childrenCount(){return this._idMap?this._idMap.size:0}constructor(){super(),this._uid=eJ.GenAutoIncrementId(),this._firstChild=null,this._lastChild=null,this.parent=null,this._count=1}forEachChildren(t,e=!1){if(e){let e=this._lastChild,i=0;for(;e;){if(t(e,i++))return;e=e._prev}}else{let e=this._firstChild,i=0;for(;e;){if(t(e,i++))return;e=e._next}}}forEachChildrenAsync(t,e=!1){var i,r,n,l;return i=this,r=void 0,n=void 0,l=function*(){if(e){let e=this._lastChild,i=0;for(;e;){let r=t(e,i++);if(r.then&&(r=yield r),r)return;e=e._prev}}else{let e=this._firstChild,i=0;for(;e;){let r=t(e,i++);if(r.then&&(r=yield r),r)return;e=e._next}}},new(n||(n=Promise))(function(t,e){function s(t){try{o(l.next(t))}catch(t){e(t)}}function a(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(s,a)}o((l=l.apply(i,r||[])).next())})}forEach(t){return this.forEachChildren(t)}appendChild(t,e=!0){if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw Error("【Node::appendChild】不能将父辈元素append为子元素");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}appendChildArrHighPerformance(t,e=!1){return console.error("暂不支持该函数"),t}insertBefore(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw Error("【Node::insertBefore】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertAfter(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw Error("【Node::insertAfter】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertInto(t,e){if(!this._ignoreWarn&&this._nodeList&&iR.Y.getInstance().warn("insertIntoKeepIdx和insertInto混用可能会存在错误"),e>=this.childrenCount)return this.appendChild(t);if(this===t)return null;if(t.isAncestorsOf(this))throw Error("【Node::insertBefore】不能将父辈元素insert为子元素");if(t.parent&&t.parent.removeChild(t),t.parent=this,0===e)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{let i=this._firstChild;for(let t=0;t<e;t++){if(!i)return null;t>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}insertIntoKeepIdx(t,e){let i;if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){let i=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,i)}this._nodeList[e]=t;for(let t=e-1;t>=0&&!(i=this._nodeList[t]);t--);if(i)return i._next?this.insertBefore(t,i._next):this.appendChild(t);this._ignoreWarn=!0;let r=this.insertInto(t,0);return this._ignoreWarn=!1,r}removeChild(t){if(!this._idMap||!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){let e=this._nodeList.findIndex(e=>e===t);e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}delete(){this.parent&&this.parent.removeChild(this)}removeAllChild(t){if(!this._idMap)return;this._nodeList&&(this._nodeList.length=0);let e=this._firstChild;for(;e;){let t=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=t}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}replaceChild(t,e){throw Error("暂不支持")}find(t,e=!1){let i=null;return this.forEachChildren((e,r)=>!(e===this||!t(e,r))&&(i=e,!0)),e&&this.forEachChildren(e=>{if(e.isContainer){let r=e.find(t,!0);if(r)return i=r,!0}return!1}),i}findAll(t,e=!1){let i=[];return this.forEachChildren((e,r)=>{e!==this&&t(e,r)&&i.push(e)}),e&&this.forEachChildren(e=>{if(e.isContainer){let r=e.findAll(t,!0);r.length&&(i=i.concat(r))}}),i}getElementById(t){return this.find(e=>e.id===t,!0)}findChildById(t){return this.getElementById(t)}findChildByUid(t){return this._idMap&&this._idMap.get(t)||null}getElementsByName(t){return this.findAll(e=>e.name===t,!0)}findChildrenByName(t){return this.getElementsByName(t)}getElementsByType(t){return this.findAll(e=>e.type===t,!0)}getChildByName(t,e=!1){return this.find(e=>e.name===t,e)}getChildAt(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}at(t){return this.getChildAt(t)}containNode(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;let e=this._firstChild;for(;e;){if(e.containNode(t))return!0;e=e._next}return!1}getRootNode(){let t=this.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t||this}hasChildNodes(){return null!==this._firstChild}addChild(t){return this.appendChild(t)}add(t){return this.appendChild(t)}getChildren(){let t=[],e=this._firstChild;for(;e;)t.push(e),e=e._next;return t}isChildOf(t){return!!this.parent&&this.parent._uid===t._uid}isParentOf(t){return t.isChildOf(this)}isDescendantsOf(t){let e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(null!==e);return!1}isAncestorsOf(t){return t.isDescendantsOf(this)}getAncestor(t){throw Error("暂不支持")}setAllDescendantsProps(t,e){let i=this._firstChild;for(;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}setCount(t){this._count+=t;let e=this.parent;if(e)do e._count+=t,e=e.parent;while(null!==e)}clone(){throw Error("暂不支持")}cloneTo(t){throw Error("暂不支持")}getParent(){return this.parent}del(t){return this.removeChild(t)}addEventListener(t,e,i){let r=(0,nD.Z)(i,!0)&&i||(0,nF.Z)(i)&&i.capture,n=(0,nF.Z)(i)&&i.once,l=(0,nz.Z)(e)?void 0:e;return t=r?`${t}capture`:t,e=(0,nz.Z)(e)?e:e.handleEvent,n?super.once(t,e,l):super.on(t,e,l),this}on(t,e,i){return this.addEventListener(t,e,i)}removeEventListener(t,e,i){let r=(0,nD.Z)(i,!0)&&i||(0,nF.Z)(i)&&i.capture,n=(0,nz.Z)(e)?void 0:e;t=r?`${t}capture`:t,e=(0,nz.Z)(e)?e:e.handleEvent;let l=(0,nF.Z)(i)&&i.once;return super.off(t,e,n,l),this}off(t,e,i){return this.removeEventListener(t,e,i)}once(t,e,i){return(0,nF.Z)(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}removeAllEventListeners(){return super.removeAllListeners(),this}removeAllListeners(){return this.removeAllEventListeners()}dispatchEvent(t,...e){return super.emit(t.type,t,...e),!t.defaultPrevented}emit(t,e){return this.dispatchEvent(t,e)}release(){this.removeAllListeners()}}class nZ{get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get x(){return this.canvas.x}get y(){return this.canvas.y}get canvasX(){return this.canvas.x}get canvasY(){return this.canvas.y}get viewX(){return this.viewport.x}get viewY(){return this.viewport.y}constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=nZ.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}composedDetailPath(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}_composedDetailPath(t){if(t&&t.graphic){let e=t.graphic;if(e.stage){let i=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(i),this._composedDetailPath(t.params)}}}preventDefault(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch(t){this.nativeEvent.preventDefault&&(0,nz.Z)(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch(t){this.nativeEvent.stopPropagation&&(0,nz.Z)(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}initEvent(){}initUIEvent(){}clone(){throw Error("Method not implemented.")}}class nN extends nZ{constructor(t,e){super(),this.type=t,this.detail=e}}class nj{static GetImage(t,e){var i;let r=nj.cache.get(t);r?"fail"===r.loadState?iC.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):"init"===r.loadState||"loading"===r.loadState?null==(i=r.waitingMark)||i.push(e):e&&e.imageLoadSuccess(t,r.data):nj.loadImage(t,e)}static GetSvg(t,e){var i;let r=nj.cache.get(t);r?"fail"===r.loadState?iC.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):"init"===r.loadState||"loading"===r.loadState?null==(i=r.waitingMark)||i.push(e):e&&e.imageLoadSuccess(t,r.data):(r={type:"image",loadState:"init"},nj.cache.set(t,r),r.dataPromise=iC.global.loadSvg(t),r.dataPromise?(r.waitingMark=[e],r.dataPromise.then(e=>{var i;r.loadState=(null==e?void 0:e.data)?"success":"fail",r.data=null==e?void 0:e.data,null==(i=r.waitingMark)||i.map((i,n)=>{(null==e?void 0:e.data)?(r.loadState="success",r.data=e.data,i.imageLoadSuccess(t,e.data)):(r.loadState="fail",i.imageLoadFail(t))}),r.waitingMark&&(r.waitingMark=[])})):(r.loadState="fail",e.imageLoadFail(t)))}static GetFile(t,e){let i=nj.cache.get(t);return i?"fail"===i.loadState?Promise.reject():"init"===i.loadState||"loading"===i.loadState?i.dataPromise.then(t=>t.data):Promise.resolve(i.data):(i={type:e,loadState:"init"},nj.cache.set(t,i),"arrayBuffer"===e?i.dataPromise=iC.global.loadArrayBuffer(t):"blob"===e?i.dataPromise=iC.global.loadBlob(t):"json"===e&&(i.dataPromise=iC.global.loadJson(t)),i.dataPromise.then(t=>t.data))}static loading(){setTimeout(()=>{if(!nj.isLoading&&nj.toLoadAueue.length){nj.isLoading=!0;let t=nj.toLoadAueue.splice(0,10),e=[];t.forEach(t=>{let{url:i,marks:r}=t,n={type:"image",loadState:"init"};if(nj.cache.set(i,n),n.dataPromise=iC.global.loadImage(i),n.dataPromise){n.waitingMark=r;let t=n.dataPromise.then(t=>{var e;n.loadState=(null==t?void 0:t.data)?"success":"fail",n.data=null==t?void 0:t.data,null==(e=n.waitingMark)||e.map((e,r)=>{(null==t?void 0:t.data)?(n.loadState="success",n.data=t.data,e.imageLoadSuccess(i,t.data)):(n.loadState="fail",e.imageLoadFail(i))}),n.waitingMark&&(n.waitingMark=[])});e.push(t)}else n.loadState="fail",r.forEach(t=>t.imageLoadFail(i))}),Promise.all(e).then(()=>{nj.isLoading=!1,this.onLoadSuccessCb.forEach(t=>t()),nj.loading()}).catch(t=>{console.error(t),nj.isLoading=!1,this.onLoadSuccessCb.forEach(t=>t()),nj.loading()})}},0)}static loadImage(t,e){let i=nG(t,nj.toLoadAueue);if(-1!==i)return nj.toLoadAueue[i].marks.push(e),void nj.loading();nj.toLoadAueue.push({url:t,marks:[e]}),nj.loading()}static improveImageLoading(t){let e=nG(t,nj.toLoadAueue);if(-1!==e){let t=nj.toLoadAueue.splice(e,1);nj.toLoadAueue.unshift(t[0])}}static onLoadSuccess(t){this.onLoadSuccessCb.push(t)}}function nG(t,e){for(let i=0;i<e.length;i++)if(e[i].url===t)return i;return -1}nj.cache=new Map,nj.isLoading=!1,nj.toLoadAueue=[],nj.onLoadSuccessCb=[],(oY=o8||(o8={}))[oY.Top=1]="Top",oY[oY.Right=2]="Right",oY[oY.Bottom=4]="Bottom",oY[oY.Left=8]="Left",oY[oY.ALL=15]="ALL";let nV=[!1,!1,!1,!1],nU=t=>{var e;let i=!0;if((0,nD.Z)(t,!0)){for(let r=0;r<4;r++)nV[r]=t,i&&(i=!(null!=(e=nV[r])&&!e));i=t}else if(Array.isArray(t))for(let e=0;e<4;e++)nV[e]=!!t[e],i&&(i=!!nV[e]);else nV[0]=!1,nV[1]=!1,nV[2]=!1,nV[3]=!1;return{isFullStroke:i,stroke:nV}},nK=[0,0,0,0],nX=t=>t?(0,rD.Z)(t)?0===t.length?0:1===t.length?t[0]:2===t.length?(nK[0]=t[0],nK[2]=t[0],nK[1]=t[1],nK[3]=t[1],nK):t:t:0,nY=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],n$=[1,2,3,0,1,2,3,0];function nq(t,e,i,r){for(;t>=ik.f7;)t-=ik.f7;for(;t<0;)t+=ik.f7;for(;t>e;)e+=ik.f7;nY[0].x=i,nY[1].y=i,nY[2].x=-i,nY[3].y=-i;let n=Math.ceil(t/ik.ou)%4,l=Math.ceil(e/ik.ou)%4;if(r.add((0,ik.mC)(t)*i,(0,ik.O$)(t)*i),r.add((0,ik.mC)(e)*i,(0,ik.O$)(e)*i),n!==l||e-t>ik.pi){let t=!1;for(let e=0;e<n$.length;e++)if(t||n!==n$[e]){if(t&&l===n$[e])break;if(t){let t=nY[n$[e]];r.add(t.x,t.y)}}else{t=!0;let e=nY[n];r.add(e.x,e.y)}}}function nJ(t,e,i){let{x:r,y:n}=(0,ik.KU)(t.x,t.y,e.x,e.y,i),{x:l,y:s}=(0,ik.KU)(t.x1,t.y1,e.x1,e.y1,i),a=new iN.E9(r,n,l,s);return a.defined=e.defined,a}function nQ(t,e,i){if(!t||!e)return[];Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);let r=[];if(t.length>e.length){r=e.map(t=>{let e=new iN.E9(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e});for(let n=0;n<e.length;n++)r[n]=nJ(t[n],e[n],i)}else{r=e.map(t=>{let e=new iN.E9(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e});for(let n=0;n<t.length;n++)r[n]=nJ(t[n],e[n],i)}return r}function n0(t,e){if((0,rD.Z)(t)){let i;for(let r=0;r<t.length&&void 0===i;r++)i=t[r][e];return i}return t[e]}class n1{constructor(t=n1.TimeOut){this.durations=[],this.timeout=t,this.lastDate=0,this.durationsListThreshold=30}call(t){return this.lastDate=Date.now(),setTimeout(()=>{this.appendDuration(Date.now()-this.lastDate),t(0)},this.timeout,!0)}clear(t){clearTimeout(t)}appendDuration(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((t,e)=>t+e,0)/this.durations.length,1e3/60),1e3/30)}}n1.TimeOut=1e3/60;let n2=new n1,n3=(t,e)=>(0,nI.Z)(t)&&"%"===t[t.length-1]?e*(Number.parseFloat(t.substring(0,t.length-1))/100):t,n5=(t,e)=>{let i=n3(t,e);return isNaN(i)?i:Math.max(e,i)};var n4=i(4654);class n6{bounds(t,e){if((0,n4.Z)(t)){let i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}parseSize(t){return(0,n4.Z)(t)?t:Math.min(t[0],t[1])}}function n7(t,e,i,r,n){return n?t.arc(i,r,e,0,ik.BZ,!1,n):t.arc(i,r,e,0,ik.BZ),!1}let n8=new class extends n6{constructor(){super(...arguments),this.type="circle",this.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0"}draw(t,e,i,r,n){return n7(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,l){return n7(t,this.parseSize(e)/2+n,i,r,l)}drawToSvgPath(t,e,i,r){let n=this.parseSize(t)/2;return`M ${e-n}, ${i} a ${n},${n} 0 1,0 ${2*n},0 a ${n},${n} 0 1,0 -${2*n},0`}},n9=new class extends n6{constructor(){super(...arguments),this.type="cross",this.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z"}draw(t,e,i,r,n){var l;return l=this.parseSize(e)/6,t.moveTo(-3*l+i,-l+r,n),t.lineTo(-l+i,-l+r,n),t.lineTo(-l+i,-3*l+r,n),t.lineTo(l+i,-3*l+r,n),t.lineTo(l+i,-l+r,n),t.lineTo(3*l+i,-l+r,n),t.lineTo(3*l+i,l+r,n),t.lineTo(l+i,l+r,n),t.lineTo(l+i,3*l+r,n),t.lineTo(-l+i,3*l+r,n),t.lineTo(-l+i,l+r,n),t.lineTo(-3*l+i,l+r,n),t.closePath(),!0}drawOffset(t,e,i,r,n,l){var s;return s=this.parseSize(e)/6,t.moveTo(-3*s+i-n,-s+r-n,l),t.lineTo(-s+i-n,-s+r-n,l),t.lineTo(-s+i-n,-3*s+r-n,l),t.lineTo(s+i+n,-3*s+r-n,l),t.lineTo(s+i+n,-s+r-n,l),t.lineTo(3*s+i+n,-s+r-n,l),t.lineTo(3*s+i+n,s+r+n,l),t.lineTo(s+i+n,s+r+n,l),t.lineTo(s+i+n,3*s+r+n,l),t.lineTo(-s+i-n,3*s+r+n,l),t.lineTo(-s+i-n,s+r+n,l),t.lineTo(-3*s+i-n,s+r+n,l),t.closePath(),!0}};function lt(t,e,i,r,n){return t.moveTo(i,r-e,n),t.lineTo(e+i,r,n),t.lineTo(i,r+e,n),t.lineTo(i-e,r,n),t.closePath(),!0}let le=new class extends n6{constructor(){super(...arguments),this.type="diamond",this.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z"}draw(t,e,i,r,n){return lt(t,this.parseSize(e)/2,i,r,n)}drawFitDir(t,e,i,r,n){return lt(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,l){return lt(t,this.parseSize(e)/2+n,i,r,l)}};function li(t,e,i,r){let n=2*e;return t.rect(i-e,r-e,n,n),!1}let lr=new class extends n6{constructor(){super(...arguments),this.type="square",this.pathStr="M-0.5,-0.5h1v1h-1Z"}draw(t,e,i,r){return li(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return li(t,this.parseSize(e)/2+n,i,r)}};function ln(t,e,i,r,n=0){return t.moveTo(i+e+2*n,e+r+n),t.lineTo(i-e-2*n,e+r+n),t.lineTo(i,r-e-2*n),t.closePath(),!0}class ll extends n6{constructor(){super(...arguments),this.type="triangleUp",this.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z"}draw(t,e,i,r){return ln(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return ln(t,this.parseSize(e)/2,i,r,n)}}let ls=new ll,la=new class extends ll{constructor(){super(...arguments),this.type="triangle"}},lo=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),lh=Math.sin(ik.BZ/10)*lo,ld=-Math.cos(ik.BZ/10)*lo;function lu(t,e,i,r){let n=lh*e,l=ld*e;t.moveTo(i,-e+r),t.lineTo(n+i,l+r);for(let s=1;s<5;++s){let a=ik.BZ*s/5,o=Math.cos(a),h=Math.sin(a);t.lineTo(h*e+i,-o*e+r),t.lineTo(o*n-h*l+i,h*n+o*l+r)}return t.closePath(),!0}let lc=new class extends n6{constructor(){super(...arguments),this.type="star",this.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z"}draw(t,e,i,r){return lu(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return lu(t,this.parseSize(e)/2+n,i,r)}},lp=(0,ik._b)(3);function lg(t,e,i,r){let n=e/lp,l=n/5;return t.moveTo(0+i,-e+r),t.lineTo(n/2+i,r),t.lineTo(l/2+i,r),t.lineTo(l/2+i,e+r),t.lineTo(-l/2+i,e+r),t.lineTo(-l/2+i,r),t.lineTo(-n/2+i,r),t.closePath(),!0}let lf=new class extends n6{constructor(){super(...arguments),this.type="arrow",this.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z"}draw(t,e,i,r){return lg(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return lg(t,this.parseSize(e)/2+n,i,r)}};function lm(t,e,i,r){let n=2*e;return t.moveTo(i,-e+r),t.lineTo(n/3/2+i,e+r),t.lineTo(-n/3/2+i,e+r),t.closePath(),!0}let ly=new class extends n6{constructor(){super(...arguments),this.type="wedge",this.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z"}draw(t,e,i,r){return lm(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return lm(t,this.parseSize(e)/2+n,i,r)}};function lv(t,e,i,r){return t.moveTo(-e+i,r),t.lineTo(i,e+r),!1}let lb=new class extends n6{constructor(){super(...arguments),this.type="stroke",this.pathStr=""}draw(t,e,i,r){return lv(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return lv(t,this.parseSize(e)/2+n,i,r)}},l_=(0,ik._b)(3)/2,lC=1/(0,ik._b)(12);function lx(t,e,i,r){let n=e/2,l=e*lC,s=e*lC+e,a=-n;return t.moveTo(n+i,l+r),t.lineTo(n+i,s+r),t.lineTo(a+i,s+r),t.lineTo(-.5*n-l_*l+i,l_*n+-.5*l+r),t.lineTo(-.5*n-l_*s+i,l_*n+-.5*s+r),t.lineTo(-.5*a-l_*s+i,l_*a+-.5*s+r),t.lineTo(-.5*n+l_*l+i,-.5*l-l_*n+r),t.lineTo(-.5*n+l_*s+i,-.5*s-l_*n+r),t.lineTo(-.5*a+l_*s+i,-.5*s-l_*a+r),t.closePath(),!1}let lw=new class extends n6{constructor(){super(...arguments),this.type="wye",this.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z"}draw(t,e,i,r){return lx(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return lx(t,this.parseSize(e)/2+n,i,r)}};function lS(t,e,i,r,n){return t.moveTo(-e+i-2*n,r),t.lineTo(e+i+n,e+r+2*n),t.lineTo(e+i+n,r-e-2*n),t.closePath(),!0}let lA=new class extends n6{constructor(){super(...arguments),this.type="triangleLeft",this.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z"}draw(t,e,i,r){return lS(t,this.parseSize(e)/2,i,r,0)}drawOffset(t,e,i,r,n){return lS(t,this.parseSize(e)/2,i,r,n)}};function lM(t,e,i,r,n=0){return t.moveTo(i-e-n,e+r+2*n),t.lineTo(e+i+2*n,r),t.lineTo(i-e-n,r-e-2*n),t.closePath(),!0}let lT=new class extends n6{constructor(){super(...arguments),this.type="triangleRight",this.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z"}draw(t,e,i,r){return lM(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return lM(t,this.parseSize(e)/2,i,r,n)}};function lk(t,e,i,r,n=0){return t.moveTo(i-e-2*n,r-e-n),t.lineTo(i+e+2*n,r-e-n),t.lineTo(i,r+e+2*n),t.closePath(),!0}let lR=new class extends n6{constructor(){super(...arguments),this.type="triangleDown",this.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z"}draw(t,e,i,r){return lk(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,n){return lk(t,this.parseSize(e)/2,i,r,n)}},lP=(0,ik._b)(3);function lB(t,e,i,r){let n=e*lP;return t.moveTo(i,r+-n/3*2),t.lineTo(e+i,r+n),t.lineTo(i-e,r+n),t.closePath(),!0}let lI=new class extends n6{constructor(){super(...arguments),this.type="thinTriangle",this.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z"}draw(t,e,i,r){return lB(t,this.parseSize(e)/2/lP,i,r)}drawOffset(t,e,i,r,n){return lB(t,this.parseSize(e)/2/lP+n,i,r)}};function lE(t,e,i,r){let n=2*e;return t.moveTo(e+i,r-n),t.lineTo(i-e,r),t.lineTo(e+i,n+r),!0}let lL=new class extends n6{constructor(){super(...arguments),this.type="arrow2Left",this.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5"}draw(t,e,i,r){return lE(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,n){return lE(t,this.parseSize(e)/4+n,i,r)}};function lF(t,e,i,r){let n=2*e;return t.moveTo(i-e,r-n),t.lineTo(i+e,r),t.lineTo(i-e,n+r),!0}let lO=new class extends n6{constructor(){super(...arguments),this.type="arrow2Right",this.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5"}draw(t,e,i,r){return lF(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,n){return lF(t,this.parseSize(e)/4+n,i,r)}};function lH(t,e,i,r){let n=2*e;return t.moveTo(i-n,r+e),t.lineTo(i,r-e),t.lineTo(i+n,r+e),!0}let lD=new class extends n6{constructor(){super(...arguments),this.type="arrow2Up",this.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25"}draw(t,e,i,r){return lH(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,n){return lH(t,this.parseSize(e)/4+n,i,r)}};function lz(t,e,i,r){let n=2*e;return t.moveTo(i-n,r-e),t.lineTo(i,r+e),t.lineTo(i+n,r-e),!0}let lW=new class extends n6{constructor(){super(...arguments),this.type="arrow2Down",this.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25"}draw(t,e,i,r){return lz(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,n){return lz(t,this.parseSize(e)/4+n,i,r)}};function lZ(t,e,i,r,n){return t.moveTo(i,r-e),t.lineTo(i,r+e),!0}let lN=new class extends n6{constructor(){super(...arguments),this.type="lineV",this.pathStr="M0,-0.5L0,0.5"}draw(t,e,i,r,n){return lZ(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,l){return lZ(t,this.parseSize(e)/2+n,i,r,l)}drawToSvgPath(t,e,i,r){let n=this.parseSize(t)/2;return`M ${e}, ${i-n} L ${e},${i+n}`}};function lj(t,e,i,r,n){return t.moveTo(i-e,r),t.lineTo(i+e,r),!0}let lG=new class extends n6{constructor(){super(...arguments),this.type="lineH",this.pathStr="M-0.5,0L0.5,0"}draw(t,e,i,r,n){return lj(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,l){return lj(t,this.parseSize(e)/2+n,i,r,l)}drawToSvgPath(t,e,i,r){let n=this.parseSize(t)/2;return`M ${e-n}, ${i} L ${e+n},${i}`}};function lV(t,e,i,r,n){return t.moveTo(i-e,r-e),t.lineTo(i+e,r+e),t.moveTo(i+e,r-e),t.lineTo(i-e,r+e),!0}let lU=new class extends n6{constructor(){super(...arguments),this.type="close",this.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5"}draw(t,e,i,r,n){return lV(t,this.parseSize(e)/2,i,r,n)}drawOffset(t,e,i,r,n,l){return lV(t,this.parseSize(e)/2+n,i,r,l)}drawToSvgPath(t,e,i,r){let n=this.parseSize(t)/2;return`M ${e-n}, ${i-n} L ${e+n},${i+n} M ${e+n}, ${i-n} L ${e-n},${i+n}`}};function lK(t,e,i,r){return t.rect(i-e[0]/2,r-e[1]/2,e[0],e[1]),!1}function lX(t,e,i,r){let n=e/2;return t.rect(i-e/2,r-n/2,e,n),!1}let lY=new class extends n6{constructor(){super(...arguments),this.type="rect",this.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z"}draw(t,e,i,r){return(0,n4.Z)(e)?lX(t,e,i,r):lK(t,e,i,r)}drawWithClipRange(t,e,i,r,n,l,s){(0,n4.Z)(e)&&(e=[e,e/2]);let a=2*(e[0]+e[1])*n,o=[{x:i+e[0]/2,y:r-e[1]/2},{x:i+e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r-e[1]/2}],h=0,d=o[3];t.moveTo(d.x,d.y);for(let e=0;e<o.length;e++){let i=o[e],r=Math.sqrt((i.x-d.x)*(i.x-d.x)+(i.y-d.y)*(i.y-d.y));if(h+r>a){let e=(i.x-d.x)*(a-h)/r,n=(i.y-d.y)*(a-h)/r;t.lineTo(d.x+e,d.y+n);break}t.lineTo(i.x,i.y),d=i,h+=r}return!1}drawOffset(t,e,i,r,n){return(0,n4.Z)(e)?lX(t,e+2*n,i,r):lK(t,[e[0]+2*n,e[1]+2*n],i,r)}},l$={};[n8,n9,le,lr,lI,la,lc,lf,ly,lb,lw,lA,lT,ls,lR,lL,lO,lD,lW,lY,lN,lG,lU].forEach(t=>{l$[t.type]=t});let lq={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"},lJ=new iI.FB;class lQ{constructor(t,e,i=!1){this.pathStr="",this.type=t,(0,rD.Z)(e)?this.svgCache=e:this.path=e,this.isSvg=i}drawOffset(t,e,i,r,n,l,s){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(n=>{t.beginPath(),iZ(n.path.commandList,t,i,r,e,e),s&&s(n.path,n.attribute)}),!1):(iZ(this.path.commandList,t,i,r,e+n,e+n),!1)}draw(t,e,i,r,n,l){return e=this.parseSize(e),this.drawOffset(t,e,i,r,0,n,l)}parseSize(t){return(0,n4.Z)(t)?t:Math.min(t[0],t[1])}drawWithClipRange(t,e,i,r,n,l,s){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(l=>{l.path.drawWithClipRange(t,e,i,r,n),s&&s(l.path,l.attribute)}),!1):(this.path.drawWithClipRange(t,e,i,r,n),!1)}bounds(t,e){if(t=this.parseSize(t),this.isSvg){if(!this.svgCache)return;return e.clear(),void this.svgCache.forEach(({path:i})=>{lJ.x1=i.bounds.x1*t,lJ.y1=i.bounds.y1*t,lJ.x2=i.bounds.x2*t,lJ.y2=i.bounds.y2*t,e.union(lJ)})}this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}class l0{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}function l1(t,e,i,r){let n=t.indexOf(e,i);if(-1===n)throw Error(r);return n+e.length-1}function l2(t,e,i,r=">"){let n=function(t,e,i=">"){let r,n="";for(let l=e;l<t.length;l++){let e=t[l];if(r)e===r&&(r="");else if('"'===e||"'"===e)r=e;else if(e===i[0]){if(!i[1]||t[l+1]===i[1])return{data:n,index:l}}else"	"===e&&(e=" ");n+=e}}(t,e+1,r);if(!n)return;let l=n.data,s=n.index,a=l.search(/\s/),o=l,h=!0;-1!==a&&(o=l.substr(0,a).replace(/\s\s*$/,""),l=l.substr(a+1));let d=o;if(i){let t=o.indexOf(":");-1!==t&&(h=(o=o.substr(t+1))!==n.data.substr(t+1))}return{tagName:o,tagExp:l,closeIndex:s,attrExpPresent:h,rawTagName:d}}let l3=RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");class l5{constructor(t){this.currentNode=null,this.options=t,this.tagsNodeStack=[],this.docTypeEntities={}}addChild(t,e,i){let r=e.tagname;"string"==typeof r&&(e.tagname=r),t.addChild(e)}buildAttributesMap(t,e,i){let r={};if(!t)return;let n=function(t,e){let i=[],r=e.exec(t);for(;r;){let n=[];n.startIndex=e.lastIndex-r[0].length;let l=r.length;for(let t=0;t<l;t++)n.push(r[t]);i.push(n),r=e.exec(t)}return i}(t,l3),l=n.length;for(let t=0;t<l;t++){let e=n[t][1],i=n[t][4];e&&(r[e]=void 0===i||(isNaN(i)?i:Number(i)))}return r}parseXml(t){t=t.replace(/\r\n?/g,"\n");let e=new l0("!xml"),i=e,r="",n="";for(let l=0;l<t.length;l++)if("<"===t[l])if("/"===t[l+1]){let e=l1(t,">",l,"Closing Tag is not closed."),s=n.lastIndexOf(".");n=n.substring(0,s),(i=this.tagsNodeStack.pop())&&i.child&&r&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=r),r="",l=e}else if("?"===t[l+1])l=l2(t,l,!1,"?>").closeIndex+1;else if("!--"===t.substr(l+1,3))l=l1(t,"--\x3e",l+4,"Comment is not closed.");else{let s=l2(t,l,!1),a=s.tagName,o=s.tagExp,h=s.attrExpPresent,d=s.closeIndex;if(a!==e.tagname&&(n+=n?"."+a:a),o.length>0&&o.lastIndexOf("/")===o.length-1){"/"===a[a.length-1]?(a=a.substr(0,a.length-1),n=n.substr(0,n.length-1),o=a):o=o.substr(0,o.length-1);let t=new l0(a);a!==o&&h&&(t[":@"]=this.buildAttributesMap(o,n,a)),this.addChild(i,t,n),n=n.substr(0,n.lastIndexOf("."))}else{let t=new l0(a);this.tagsNodeStack.push(i),a!==o&&h&&(t[":@"]=this.buildAttributesMap(o,n,a)),this.addChild(i,t,n),i=t}r="",l=d}else r+=t[l];return e.child}}class l4{constructor(t){this.options=Object.assign({},l4.defaultOptions,t)}valid(t){return t.startsWith("<")}parse(t){var e,i;return!!this.valid&&(e=new l5(this.options).parseXml(t),this.options,function t(e,i){let r={};for(let n=0;n<e.length;n++){let l=e[n],s=function(t){let e=Object.keys(t);for(let t=0;t<e.length;t++){let i=e[t];if(":@"!==i)return i}}(l),a="";if(a=void 0===i?s:i+"."+s,void 0!==s&&l[s]){let e=t(l[s],a);Object.keys(e).length,l[":@"]&&function(t,e,i){if(e){let i=Object.keys(e),r=i.length;for(let n=0;n<r;n++){let r=i[n];t[r]=e[r]}}}(e,l[":@"],0),void 0!==r[s]&&r.hasOwnProperty(s)?(Array.isArray(r[s])||(r[s]=[r[s]]),r[s].push(e)):r[s]=e}}return r}(e))}}function l6(t,e,i,r=0){var n,l;return t.expand(e+(r/2+(i?(n=i,l=e,n?l:0):0))),t}l4.defaultOptions={};let l7=0;function l8(){return l7++}(o$=o9||(o9={}))[o$.HORIZONTAL=0]="HORIZONTAL",o$[o$.VERTICAL=1]="VERTICAL";let l9=new Map;["…","（","）","—","【","】","「","」","《","》"].forEach(t=>l9.set(t,!0));let st=new Map;[""].forEach(t=>st.set(t,!0));let se=l8(),si=l8(),sr=l8(),sn=l8(),sl=l8(),ss=l8(),sa=l8(),so=l8(),sh=l8(),sd=l8(),su=l8(),sc=l8(),sp=l8(),sg=l8();l8();let sf=l8(),sm=l8(),sy=Symbol.for("GraphicService"),sv=Symbol.for("GraphicCreator"),sb={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},s_=Object.keys(sb),sC={duration:200,easing:"cubicOut"};function sx(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sw(t,e,i){let r,n,l,s,a,o,h,d,u,c,p,g,f=i[0],m=i[1],y=i[2];return e===t?(t[12]=e[0]*f+e[4]*m+e[8]*y+e[12],t[13]=e[1]*f+e[5]*m+e[9]*y+e[13],t[14]=e[2]*f+e[6]*m+e[10]*y+e[14],t[15]=e[3]*f+e[7]*m+e[11]*y+e[15]):(r=e[0],n=e[1],l=e[2],s=e[3],a=e[4],o=e[5],h=e[6],d=e[7],u=e[8],c=e[9],p=e[10],g=e[11],t[0]=r,t[1]=n,t[2]=l,t[3]=s,t[4]=a,t[5]=o,t[6]=h,t[7]=d,t[8]=u,t[9]=c,t[10]=p,t[11]=g,t[12]=r*f+a*m+u*y+e[12],t[13]=n*f+o*m+c*y+e[13],t[14]=l*f+h*m+p*y+e[14],t[15]=s*f+d*m+g*y+e[15]),t}function sS(t,e){t[0]=e.a,t[1]=e.b,t[2]=0,t[3]=0,t[4]=e.c,t[5]=e.d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e.e,t[13]=e.f,t[14]=0,t[15]=1}function sA(t,e,i){let r=e[0],n=e[1],l=e[2],s=e[3],a=e[4],o=e[5],h=e[6],d=e[7],u=e[8],c=e[9],p=e[10],g=e[11],f=e[12],m=e[13],y=e[14],v=e[15],b=i[0],_=i[1],C=i[2],x=i[3];return t[0]=b*r+_*a+C*u+x*f,t[1]=b*n+_*o+C*c+x*m,t[2]=b*l+_*h+C*p+x*y,t[3]=b*s+_*d+C*g+x*v,b=i[4],_=i[5],C=i[6],x=i[7],t[4]=b*r+_*a+C*u+x*f,t[5]=b*n+_*o+C*c+x*m,t[6]=b*l+_*h+C*p+x*y,t[7]=b*s+_*d+C*g+x*v,b=i[8],_=i[9],C=i[10],x=i[11],t[8]=b*r+_*a+C*u+x*f,t[9]=b*n+_*o+C*c+x*m,t[10]=b*l+_*h+C*p+x*y,t[11]=b*s+_*d+C*g+x*v,b=i[12],_=i[13],C=i[14],x=i[15],t[12]=b*r+_*a+C*u+x*f,t[13]=b*n+_*o+C*c+x*m,t[14]=b*l+_*h+C*p+x*y,t[15]=b*s+_*d+C*g+x*v,t}function sM(t,e,i){let r=e[0],n=e[1],l=e[2],s=i[3]*r+i[7]*n+i[11]*l+i[15];return s=s||1,t[0]=(i[0]*r+i[4]*n+i[8]*l+i[12])/s,t[1]=(i[1]*r+i[5]*n+i[9]*l+i[13])/s,t[2]=(i[2]*r+i[6]*n+i[10]*l+i[14])/s,t}function sT(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Symbol.for("MatrixAllocate"),Symbol.for("Mat4Allocate");class sk{constructor(){this.pools=[]}static identity(t){return sx(t)}allocate(){if(!this.pools.length)return sT();let t=this.pools.pop();return sk.identity(t),t}allocateByObj(t){let e;e=this.pools.length?this.pools.pop():sT();for(let i=0;i<e.length;i++)e[i]=t[i];return e}free(t){t&&this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}let sR=new class{constructor(){this.pools=[]}allocate(t,e,i,r,n,l){if(!this.pools.length)return new iT.y(t,e,i,r,n,l);let s=this.pools.pop();return s.a=t,s.b=e,s.c=i,s.d=r,s.e=n,s.f=l,s}allocateByObj(t){if(!this.pools.length)return new iT.y(t.a,t.b,t.c,t.d,t.e,t.f);let e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}},sP=new sk,sB=new iT.y(1,0,0,1,0,0),sI={x:0,y:0},sE=class{get nativeContext(){return this.path}constructor(t,e){this.matrix=new iT.y(1,0,0,1,0,0),this.stack=[],this.dpr=e,this.applyedMatrix=new iT.y(1,0,0,1,0,0),this.path=new rp,this._clearMatrix=new iT.y(1,0,0,1,0,0)}getCanvas(){throw Error("不支持getCanvas")}getContext(){throw Error("不支持getContext")}setTransformForCurrent(t=!1){!t&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix=this.cloneMatrix(this.matrix))}get currentMatrix(){return this.matrix}cloneMatrix(t){return sR.allocateByObj(t)}clear(){this.save(),this.resetTransform(),this.restore()}reset(){this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new iT.y(1,0,0,1,0,0),this.stack.length=0}restore(){this.stack.length>0&&(sR.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent())}highPerformanceRestore(){this.stack.length>0&&(sR.free(this.matrix),this.matrix=this.stack.pop())}rotate(t,e=!0){this.matrix.rotate(t),e&&this.setTransformForCurrent()}save(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}highPerformanceSave(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}scale(t,e,i=!0){this.matrix.scale(t,e),i&&this.setTransformForCurrent()}setScale(t,e,i=!0){this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}scalePoint(t,e,i,r,n=!0){this.translate(i,r,!1),this.scale(t,e,!1),this.translate(-i,-r,!1),n&&this.setTransformForCurrent()}setTransform(t,e,i,r,n,l,s=!0,a=this.dpr){this.matrix.setValue(a*t,a*e,a*i,a*r,a*n,a*l),s&&this.setTransformForCurrent()}setTransformFromMatrix(t,e=!0,i=this.dpr){this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}resetTransform(t=!0,e=this.dpr){this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}transform(t,e,i,r,n,l,s=!0){this.matrix.multiply(t,e,i,r,n,l),s&&this.setTransformForCurrent()}transformFromMatrix(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}translate(t,e,i=!0){this.matrix.translate(t,e),i&&this.setTransformForCurrent()}rotateDegrees(t,e=!0){let i=t*Math.PI/180;this.rotate(i,e)}rotateAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}rotateDegreesAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}beginPath(){this.path.clear()}clip(t,e){}arc(t,e,i,r,n,l){this.path.arc(t,e,i,r,n,l)}arcTo(t,e,i,r,n){this.path.arcTo(t,e,i,r,n)}bezierCurveTo(t,e,i,r,n,l){this.path.bezierCurveTo(t,e,i,r,n,l)}closePath(){this.path.closePath()}ellipse(t,e,i,r,n,l,s,a){}lineTo(t,e){this.path.lineTo(t,e)}moveTo(t,e){this.path.moveTo(t,e)}quadraticCurveTo(t,e,i,r){this.path.quadraticCurveTo(t,e,i,r)}rect(t,e,i,r){this.path.rect(t,e,i,r)}createImageData(t,e){return null}createLinearGradient(t,e,i,r){throw Error("不支持createLinearGradient")}createPattern(t,e){throw Error("不支持createPattern")}createRadialGradient(t,e,i,r,n,l){throw Error("不支持createRadialGradient")}createConicGradient(t,e,i,r){return null}fill(t,e){}fillRect(t,e,i,r){this.path.rect(t,e,i,r)}clearRect(t,e,i,r){}fillText(t,e,i){}getImageData(t,e,i,r){return null}getLineDash(){return[]}isPointInPath(t,e){return this.matrix.transformPoint({x:t,y:e},sI),nc(this.path.commandList,0,!1,sI.x,sI.y)}isPointInStroke(t,e){var i;if(!this.lineWidth)return!1;this.matrix.transformPoint({x:t,y:e},sI);let r=rZ(this,this.lineWidth,this.dpr);return i=this.path.commandList,nc(i,r,!0,sI.x,sI.y)}measureText(t){throw Error("不支持measureText")}putImageData(t,e,i){throw Error("不支持measureText")}setLineDash(t){}stroke(t){}strokeRect(t,e,i,r){this.path.rect(t,e,i,r)}strokeText(t,e,i){}drawImage(){}setCommonStyle(t,e,i,r,n){}_setCommonStyle(t,e,i,r){}setStrokeStyle(t,e,i,r,n){}_setStrokeStyle(t,e,i,r){}setTextStyleWithoutAlignBaseline(t,e){}setTextStyle(t,e){}draw(){}clearMatrix(t=!0,e=this.dpr){this.setTransformFromMatrix(sB,t,e)}setClearMatrix(t,e,i,r,n,l){this._clearMatrix.setValue(t,e,i,r,n,l)}onlyTranslate(t=this.dpr){return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}release(...t){this.stack.forEach(t=>sR.free(t)),this.stack.length=0}};sE=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],sE);let sL=new iI.FB,sF=new iT.y;new iI.FB;let sO=["lineWidth","scaleX","scaleY","angle","anchor","visible"],sH=["x","y"],sD=["scaleX","scaleY"],sz=["angle"],sW=new iN.E9,sZ={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1};class sN extends nW{static mixin(t){let e=Object.keys(t);for(let i=0;i<e.length;++i){let r=e[i];Object.defineProperty(sN.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get AABBBounds(){return this.tryUpdateAABBBounds()}get OBBBounds(){return this.tryUpdateOBBBounds()}get globalAABBBounds(){return this.tryUpdateGlobalAABBBounds()}get transMatrix(){return this.tryUpdateLocalTransMatrix(!0)}get globalTransMatrix(){return this.tryUpdateGlobalTransMatrix(!0)}constructor(t={}){var e;super(),this._AABBBounds=new iI.FB,this._updateTag=o1.INIT,this.attribute=t,this.valid=this.isValid(),this.updateAABBBoundsStamp=0,t.background?this.loadImage(null!=(e=t.background.background)?e:t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic)}getGraphicService(){var t,e;return null!=(e=null==(t=this.stage)?void 0:t.graphicService)?e:iC.graphicService}getAttributes(){return this.attribute}setMode(t){"3d"===t?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}getOffsetXY(t,e=!1){var i,r;let{dx:n=t.dx,dy:l=t.dy}=this.attribute;if(e&&this.parent){let t=this.parent.attribute;sW.x=n+(null!=(i=t.scrollX)?i:0),sW.y=l+(null!=(r=t.scrollY)?r:0)}else sW.x=n,sW.y=l;return sW}onAnimateBind(t){this._emitCustomEvent("animate-bind",t)}tryUpdateAABBBounds(){let t="imprecise"===this.attribute.boundsMode;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);let e=this.doUpdateAABBBounds(t);return this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),"empty"===this.attribute.boundsMode&&e.clear(),e}tryUpdateOBBBounds(){return(this._OBBBounds||(this._OBBBounds=new iI.a5),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp)?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid)?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds)}combindShadowAABBBounds(t){if(this.shadowRoot){let e=this.shadowRoot.AABBBounds.clone();t.union(e)}}doUpdateOBBBounds(){return this._OBBBounds}getClipPath(){let{clipConfig:t}=this.attribute;if(!t)return null;this.clipPathMap||(this.clipPathMap=new Map);let{shape:e}=t,i=this.clipPathMap.get(e)||null;return i||(this.clipPathMap.size>10&&this.clipPathMap.clear(),(i=this.parsePath(e))&&this.clipPathMap.set(e,i)),i}parsePath(t){var e;if(!t)return null;let i=l$[t];if(i||(i=sN.userSymbolMap[t]))return i;if(!0===((e=t=lq[t]||t).startsWith("<svg")||e.startsWith("<?xml"))){let{svg:e}=(new l4).parse(t);if(!e)return null;let i=(0,rD.Z)(e.path)?e.path:[e.path];sL.clear();let r=[];i.forEach(t=>{let e=(new rp).fromString(t.d),i={};s_.forEach(e=>{t[e]&&(i[sb[e]]=t[e])}),r.push({path:e,attribute:i}),sL.union(e.bounds)});let n=sL.width(),l=sL.height(),s=1/(0,ik.Fp)(n,l);r.forEach(t=>t.path.transform(0,0,s,s));let a=new lQ(t,r,!0);return sN.userSymbolMap[t]=a,a}let r=(new rp).fromString(t),n=r.bounds.width(),l=r.bounds.height(),s=1/(0,ik.Fp)(n,l);r.transform(0,0,s,s);let a=new lQ(t,r);return sN.userSymbolMap[t]=a,a}doUpdateAABBBounds(t){this.updateAABBBoundsStamp++;let e=this.getGraphicTheme();this._AABBBounds.clear();let i=this.attribute,r=this.updateAABBBounds(i,e,this._AABBBounds,t),{boundsPadding:n=e.boundsPadding}=i,l=nX(n);return l&&r.expand(l),this.clearUpdateBoundTag(),r}updatePathProxyAABBBounds(t){let e="function"==typeof this.pathProxy?this.pathProxy(this.attribute):this.pathProxy;if(!e)return!1;let i=new iB(t);return iZ(e.commandList,i,0,0),!0}tryUpdateGlobalAABBBounds(){let t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}tryUpdateGlobalTransMatrix(t=!0){if(this._globalTransMatrix){if(this.parent){let t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!0}tryUpdateLocalTransMatrix(t=!0){return this._transMatrix||(this._transMatrix=new iT.y),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}shouldUpdateAABBBounds(){return this.shadowRoot?(!!(this._updateTag&o1.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&o1.UPDATE_BOUNDS)&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}shouldSelfChangeUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&o1.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&o1.UPDATE_BOUNDS)}shouldUpdateLocalMatrix(){return!!(this._updateTag&o1.UPDATE_LOCAL_MATRIX)}isValid(){var t,e;let i=this.attribute;return Number.isFinite((null!=(t=i.x)?t:0)+(null!=(e=i.y)?e:0))}_validNumber(t){return null==t||Number.isFinite(t)}shouldUpdateShape(){return!!(this._updateTag&o1.UPDATE_SHAPE)}clearUpdateShapeTag(){this._updateTag&=o1.CLEAR_SHAPE}containsPoint(t,e,i,r){if(!r)return!1;if(i===o2.GLOBAL){let i=new iN.E9(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(i,i),t=i.x,e=i.y}return r.containsPoint(this,{x:t,y:e})}setWidthHeightWithoutTransform(t){this.widthWithoutTransform=t.x2-t.x1,this.heightWithoutTransform=t.y2-t.y1}setAttributesAndPreventAnimate(t,e=!1,i,r){this.setAttributes(t,e,i),this.animates&&this.animates.forEach(e=>{(e.priority!==1/0||r)&&Object.keys(t).forEach(t=>{e.preventAttr(t)})})}setAttributes(t,e=!1,i){t&&((t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,i))}_setAttributes(t,e=!1,i){let r=Object.keys(t);for(let e=0;e<r.length;e++){let i=r[e];this.attribute[i]=t[i]}this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(e||this.needUpdateTags(r))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}setAttribute(t,e,i,r){var n;let l=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);l?this._setAttributes(l,i,r):(0,nB.Z)(null==(n=this.normalAttrs)?void 0:n[t])?(this.attribute[t]=e,this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(i||this.needUpdateTag(t))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)):this.normalAttrs[t]=e,"background"===t?this.loadImage(e,!0):"shadowGraphic"===t&&this.setShadowGraphic(e)}needUpdateTags(t,e=sO){for(let i=0;i<e.length;i++){let r=e[i];if(-1!==t.indexOf(r))return!0}return!1}needUpdateTag(t,e=sO){for(let i=0;i<e.length;i++)if(t===e[i])return!0;return!1}initAttributes(t){let e={type:o3.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=o1.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}translate(t,e){var i,r;if(0===t&&0===e)return this;let n={type:o3.TRANSLATE},l=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,sH,n);l&&(t=l.x,e=l.y,delete l.x,delete l.y,this._setAttributes(l));let s=this.attribute,a=s.postMatrix;return a?iC.transformUtil.fromMatrix(a,a).translate(t,e):(s.x=(null!=(i=s.x)?i:rf.x)+t,s.y=(null!=(r=s.y)?r:rf.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this}translateTo(t,e){let i=this.attribute;if(i.x===t&&i.y===e)return this;let r={type:o3.TRANSLATE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,sH,r);return n?this._setAttributes(n,!1,r):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)),this}scale(t,e,i){var r,n;if(1===t&&1===e)return this;let l={type:o3.SCALE},s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,sD,l);s&&(t=s.scaleX,e=s.scaleY,delete s.scaleX,delete s.scaleY,this._setAttributes(s));let a=this.attribute;if(i){let{postMatrix:r}=this.attribute;r||(a.postMatrix=r=new iT.y),iC.transformUtil.fromMatrix(r,r).scale(t,e,i)}else a.scaleX=(null!=(r=a.scaleX)?r:rf.scaleX)*t,a.scaleY=(null!=(n=a.scaleY)?n:rf.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(l),this}scaleTo(t,e){let i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;let r={type:o3.SCALE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,sD,r);return n?this._setAttributes(n,!1,r):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)),this}rotate(t,e){var i;if(0===t)return this;let r={type:o3.ROTATE},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,sz,r);n&&(delete n.angle,this._setAttributes(n,!1,r));let l=this.attribute;if(e){let{postMatrix:i}=this.attribute;i||(l.postMatrix=i=new iT.y),iC.transformUtil.fromMatrix(i,i).rotate(t,e)}else l.angle=(null!=(i=l.angle)?i:rf.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}rotateTo(t){let e=this.attribute;if(e.angle===t)return this;let i={type:o3.ROTATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,sz,i);return r?this._setAttributes(r,!1,i):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)),this}skewTo(t,e){return this}onAttributeUpdate(t){t&&t.skipUpdateCallback||(this.getGraphicService().onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}update(t){t?(t.bounds&&this.tryUpdateAABBBounds(),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(),this.tryUpdateLocalTransMatrix())}hasState(t){return!(!this.currentStates||!this.currentStates.length)&&(!!(0,nB.Z)(t)||this.currentStates.includes(t))}getState(t){var e;return null==(e=this.states)?void 0:e[t]}applyStateAttrs(t,e,i,r){var n,l;if(i){let e,i=Object.keys(t),s=this.getNoWorkAnimateAttr(),a={};i.forEach(i=>{s[i]?(e||(e={}),e[i]=t[i]):a[i]=r&&void 0===t[i]?this.getDefaultAttribute(i):t[i]});let o=null!=(l=null!=(n=this.context&&this.context.stateAnimateConfig)?n:this.stateAnimateConfig)?l:sC;this.applyAnimationState(["state"],[{name:"state",animation:{type:"state",to:a,duration:o.duration,easing:o.easing}}]),e&&this.setAttributesAndPreventAnimate(e,!1,{type:o3.STATE}),this.finalAttribute&&Object.assign(this.finalAttribute,t)}else this.stopStateAnimates(),this.setAttributesAndPreventAnimate(t,!1,{type:o3.STATE}),this.finalAttribute&&Object.assign(this.finalAttribute,t);this._emitCustomEvent("afterStateUpdate",{type:o3.STATE})}updateNormalAttrs(t){let e={};this.normalAttrs?(Object.keys(t).forEach(t=>{t in this.normalAttrs?(e[t]=this.normalAttrs[t],delete this.normalAttrs[t]):e[t]=this.getNormalAttribute(t)}),Object.keys(this.normalAttrs).forEach(e=>{t[e]=this.normalAttrs[e]})):Object.keys(t).forEach(t=>{e[t]=this.getNormalAttribute(t)}),this.normalAttrs=e}stopStateAnimates(t="end"){this.animates&&this.animates.forEach(e=>{e.stateNames&&(e.stop(t),this.animates.delete(e.id))})}getNormalAttribute(t){var e,i;let r=this.attribute[t];return this.animates&&this.animates.size?null==(e=this.finalAttribute)?void 0:e[t]:null!=r?r:null==(i=this.finalAttribute)?void 0:i[t]}clearStates(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}removeState(t,e){if(this.currentStates){let i=(0,rD.Z)(t)?e=>!t.includes(e):e=>e!==t,r=this.currentStates.filter(i);r.length!==this.currentStates.length&&this.useStates(r,e)}}toggleState(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){let i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}addState(t,e,i){var r;if(this.currentStates&&this.currentStates.includes(t)&&(e||1===this.currentStates.length))return;let n=e&&(null==(r=this.currentStates)?void 0:r.length)?this.currentStates.concat([t]):[t];this.useStates(n,i)}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!((null==(i=this.currentStates)?void 0:i.length)!==t.length||t.some((t,e)=>this.currentStates[e]!==t)))return;let r={};t.forEach(e=>{var i;let n=this.stateProxy?this.stateProxy(e,t):null==(i=this.states)?void 0:i[e];n&&Object.assign(r,n)}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}addUpdateBoundTag(){this._updateTag|=o1.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}addUpdateShapeTag(){this._updateTag|=o1.UPDATE_SHAPE}addUpdateShapeAndBoundsTag(){this._updateTag|=o1.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}updateShapeAndBoundsTagSetted(){return(this._updateTag&o1.UPDATE_SHAPE_AND_BOUNDS)===o1.UPDATE_SHAPE_AND_BOUNDS}clearUpdateBoundTag(){this._updateTag&=o1.CLEAR_BOUNDS}addUpdatePositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=o1.UPDATE_GLOBAL_LOCAL_MATRIX}addUpdateGlobalPositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=o1.UPDATE_GLOBAL_MATRIX}clearUpdateLocalPositionTag(){this._updateTag&=o1.CLEAR_LOCAL_MATRIX}clearUpdateGlobalPositionTag(){this._updateTag&=o1.CLEAR_GLOBAL_MATRIX}addUpdateLayoutTag(){this._updateTag|=o1.UPDATE_LAYOUT}clearUpdateLayoutTag(){this._updateTag&=o1.CLEAR_LAYOUT}needUpdateLayout(){return!!(this._updateTag&o1.UPDATE_LAYOUT)}getAnchor(t,e,i){let r=[0,0],n=()=>{if(e.b)return e.b;let t=this.clone();return t.attribute.angle=0,t.attribute.scaleCenter=null,i&&(t.attribute.scaleX=1,t.attribute.scaleY=1),e.b=t.AABBBounds,e.b};if("string"==typeof t[0]){let e=parseFloat(t[0])/100,i=n();r[0]=i.x1+(i.x2-i.x1)*e}else r[0]=t[0];if("string"==typeof t[1]){let e=parseFloat(t[1])/100,i=n();r[1]=i.y1+(i.y2-i.y1)*e}else r[1]=t[1];return r}doUpdateLocalMatrix(){let{x:t=rf.x,y:e=rf.y,scaleX:i=rf.scaleX,scaleY:r=rf.scaleY,angle:n=rf.angle,scaleCenter:l,anchor:s,postMatrix:a}=this.attribute,o=[0,0],h={};if(s&&n&&(o=this.getAnchor(s,h)),l&&(1!==i||1!==r)){let s=this._transMatrix;s.reset(),s.translate(o[0],o[1]),s.rotate(n),s.translate(-o[0],-o[1]),s.translate(t,e),o=this.getAnchor(l,h,!0),iC.transformUtil.fromMatrix(s,s).scale(i,r,{x:o[0],y:o[1]})}else(0,iT.X)(this._transMatrix,this._transMatrix.reset(),t,e,i,r,n,s&&o);let d=this.getOffsetXY(rf);if(this._transMatrix.e+=d.x,this._transMatrix.f+=d.y,a){let t=sF.setValue(a.a,a.b,a.c,a.d,a.e,a.f),e=this._transMatrix;t.multiply(e.a,e.b,e.c,e.d,e.e,e.f),e.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}doUpdateGlobalMatrix(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);let{scrollX:t=0,scrollY:e=0}=this.parent.attribute;this._globalTransMatrix.translate(t,e)}}setStage(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){let e=t.getTimeline();this.animates.forEach(t=>{t.timeline.isGlobal&&(t.setTimeline(e),e.addAnimate(t))})}this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t)}}setStageToShadowRoot(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}onAddStep(t){}onStop(t){t&&this.setAttributes(t,!1,{type:o3.ANIMATE_END})}getDefaultAttribute(t){return this.getGraphicTheme()[t]}getComputedAttribute(t){var e;return null!=(e=this.attribute[t])?e:this.getDefaultAttribute(t)}onSetStage(t,e=!1){this._onSetStage=t,e&&this.stage&&t(this,this.stage)}attachShadow(t){return t&&(t.shadowHost=this),this.shadowRoot=null!=t?t:iC.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}detachShadow(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot.release(!0),this.shadowRoot=null)}toJson(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map(t=>t.toJson())}}createPathProxy(t){return(0,nI.Z)(t,!0)?this.pathProxy=(new rp).fromString(t):this.pathProxy=new rp,this.pathProxy}loadImage(t,e=!1){var i;if(!t||e&&!(!(i=t).fill&&!i.stroke))return;this.resources||(this.resources=new Map);let r={data:"init",state:null};this.resources.set(t,r),"string"==typeof t?(r.state="loading",t.startsWith("<svg")?(nj.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):((0,nE.Z)(t)||t.includes("/")||(0,nL.Z)(t))&&(nj.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):(0,nF.Z)(t)?(r.state="success",r.data=t,this.backgroundImg=this.backgroundImg||e):r.state="fail"}setShadowGraphic(t){t?this.attachShadow().add(t):this.detachShadow()}imageLoadSuccess(t,e,i){if(!this.resources)return;let r=this.resources.get(t);r&&(r.state="success",r.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}imageLoadFail(t,e){if(!this.resources)return;let i=this.resources.get(t);i&&(i.state="fail",e&&e())}_stopAnimates(t){t&&t.forEach(t=>{t.stop()})}stopAnimates(t=!1){this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren(e=>{e.stopAnimates(t)})}release(){this.releaseStatus="released",this.stopAnimates(),iC.graphicService.onRelease(this)}_emitCustomEvent(t,e){var i,r;if(this._events&&t in this._events){let n=new nN(t,e);n.bubbles=!1,n.manager=null==(r=null==(i=this.stage)?void 0:i.eventSystem)?void 0:r.manager,this.dispatchEvent(n)}}toCustomPath(){var t,e,i;let r=null==(i=null==(e=(null==(t=this.stage)?void 0:t.renderService)||iC.renderService)?void 0:e.drawContribution)?void 0:i.getRenderContribution(this);if(r){let t=new sE(null,1);return r.drawShape(this,t,0,0,{},{}),t.path}return null}}sN.userSymbolMap={},sN.mixin({dispatchEvent(t){var e;if(!(t instanceof nZ))throw Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=[],t.detailPath&&(t.detailPath=[]),t.target=this,null==(e=null==t?void 0:t.manager)||e.dispatchEvent(t),!t.defaultPrevented},emit(t,e){return this.dispatchEvent(new nN(t,e))}}),(oq=ht||(ht={}))[oq.LESS_GROUP=0]="LESS_GROUP",oq[oq.MORE_GROUP=1]="MORE_GROUP";class sj extends sN{constructor(t){super(t),this.type="group",this.parent=null,this.isContainer=!0,this.numberType=ss,this._childUpdateTag=o1.UPDATE_BOUNDS}setMode(t){"3d"===t?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}setTheme(t){return this.theme||(this.theme=new nk),this.theme.setTheme(t,this)}createTheme(){this.theme||(this.theme=new nk)}visibleAll(t){this.setAttribute("visible",t),this.forEachChildren(e=>{e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute("visible",t)})}hideAll(){this.visibleAll(!1)}showAll(){this.visibleAll(!0)}containsPoint(t,e,i){if(i===o2.GLOBAL){let i=new iN.E9(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(i,i),this.AABBBounds.contains(i.x,i.y)}return this.AABBBounds.contains(t,e)}shouldUpdateAABBBounds(){return!!super.shouldUpdateAABBBounds()||!!(this._childUpdateTag&o1.UPDATE_BOUNDS)}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);let t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),"empty"===this.attribute.boundsMode&&e.clear(),e}doUpdateLocalMatrix(){let{x:t=rf.x,y:e=rf.y,dx:i=rf.dx,dy:r=rf.dy,scaleX:n=rf.scaleX,scaleY:l=rf.scaleY,angle:s=rf.angle,postMatrix:a}=this.attribute;if(0!==t||0!==e||0!==i||0!==r||1!==n||1!==l||0!==s||a)return super.doUpdateLocalMatrix();this._transMatrix.reset()}getGraphicTheme(){return nP(this).group}updateAABBBounds(t,e,i){let r=i;i=i.clone();let{width:n,height:l,path:s,clip:a=e.clip}=t;if(s&&s.length?s.forEach(t=>{i.union(t.AABBBounds)}):null!=n&&null!=l&&i.set(0,0,Math.max(0,n),Math.max(0,l)),!a){this.forEachChildren(t=>{i.union(t.AABBBounds)});let{scrollX:e=0,scrollY:r=0}=t;i.translate(e,r)}return iC.graphicService.updateTempAABBBounds(i),iC.graphicService.transformAABBBounds(t,i,e,!1,this),r.copy(i),r}doUpdateAABBBounds(){this.updateAABBBoundsStamp++;let t=super.doUpdateAABBBounds();return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),t}clearUpdateBoundTag(){this._updateTag&=o1.CLEAR_BOUNDS,this._childUpdateTag&=o1.CLEAR_BOUNDS}addUpdateBoundTag(){this._updateTag|=o1.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}addChildUpdateBoundTag(){this._childUpdateTag&o1.UPDATE_BOUNDS||(this._childUpdateTag|=o1.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}getTheme(){return this.theme.getTheme(this)}incrementalAppendChild(t){let e=super.appendChild(t);return this.stage&&e&&(e.stage=this.stage,e.layer=this.layer),this.addUpdateBoundTag(),this.getGraphicService().onAddIncremental(t,this,this.stage),e}incrementalClearChild(){super.removeAllChild(),this.addUpdateBoundTag(),this.getGraphicService().onClearIncremental(this,this.stage)}_updateChildToStage(t){return this.stage&&t&&t.setStage(this.stage,this.layer),this.addUpdateBoundTag(),t}appendChild(t,e=!0){let i=super.appendChild(t);return e&&this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}insertBefore(t,e){return this._updateChildToStage(super.insertBefore(t,e))}insertAfter(t,e){return this._updateChildToStage(super.insertAfter(t,e))}insertInto(t,e){return this._updateChildToStage(super.insertInto(t,e))}removeChild(t){let e=super.removeChild(t);return this.getGraphicService().onRemove(t),t.stage=null,this.addUpdateBoundTag(),e}removeAllChild(t=!1){this.forEachChildren(e=>{this.getGraphicService().onRemove(e),t&&e.isContainer&&e.removeAllChild(t)}),super.removeAllChild(),this.addUpdateBoundTag()}setStage(t,e){this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t),this.forEachChildren(e=>{e.setStage(t,this.layer)}))}addUpdatePositionTag(){super.addUpdatePositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}addUpdateGlobalPositionTag(){super.addUpdateGlobalPositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){let t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!!(this._updateTag&o1.UPDATE_GLOBAL_MATRIX)}_getChildByName(t,e){return this.find(e=>e.name===t,e)}createOrUpdateChild(t,e,i){let r=this._getChildByName(t);return r?r.setAttributes(e):((r=iC.graphicService.creator[i](e)).name=t,this.add(r)),r}clone(){return new sj(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return sj.NOWORK_ANIMATE_ATTR}release(t){t&&this.forEachChildren(e=>{e.release(t)}),super.release()}}function sG(t){return new sj(t)}sj.NOWORK_ANIMATE_ATTR=sZ;class sV extends sj{get offscreen(){return this.layerHandler.offscreen}get layerMode(){return this.layerHandler.type}get width(){return this.stage?this.stage.width:0}get height(){return this.stage?this.stage.height:0}get viewWidth(){return this.stage?this.stage.viewWidth:0}get viewHeight(){return this.stage?this.stage.viewHeight:0}get dirtyBound(){throw Error("暂不支持")}get dpr(){return this._dpr}constructor(t,e,i,r){var n;super({}),this.stage=t,this.global=e,this.window=i,this.main=r.main,this.layerHandler=r.layerHandler,this.layerHandler.init(this,i,{main:r.main,canvasId:r.canvasId,width:this.viewWidth,height:this.viewHeight,zIndex:null!=(n=r.zIndex)?n:0}),this.layer=this,this.subLayers=new Map,this.theme=new nk,this.background="rgba(0, 0, 0, 0)",this.afterDrawCbs=[]}combineSubLayer(t=!0){let e=Array.from(this.subLayers.values()).sort((t,e)=>t.zIndex-e.zIndex);this.layerHandler.merge(e.map(e=>(e.layer.subLayers.size&&e.layer.combineSubLayer(t),e.layer.getNativeHandler()))),t&&e.forEach(t=>{t.group&&(t.group.incremental=0)}),e.forEach(t=>{iC.layerService.releaseLayer(this.stage,t.layer)}),this.subLayers.clear()}getNativeHandler(){return this.layerHandler}setStage(t,e){super.setStage(t,this)}pick(t,e){throw Error("暂不支持")}tryRenderSecondaryLayer(t,e){this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach(i=>{i.layer.renderCount=this.renderCount,i.layer.render(t,e)})}render(t,e){var i;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:null!=(i=t.background)?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach(t=>t(this)),this.tryRenderSecondaryLayer(t,e)}resize(t,e){this.layerHandler.resize(t,e)}resizeView(t,e){this.layerHandler.resizeView(t,e)}setDpr(t){this.layerHandler.setDpr(t)}afterDraw(t){this.afterDrawCbs.push(t)}startAnimate(t){throw Error("暂不支持")}setToFrame(t){throw Error("暂不支持")}prepare(t,e){}release(){super.release(),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach(t=>{iC.layerService.releaseLayer(this.stage,t.layer)})}drawTo(t,e){var i;this.layerHandler.drawTo(t,[this],Object.assign({background:null!=(i=e.background)?i:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach(t=>t(this))}}let sU=Symbol.for("TransformUtil"),sK=Symbol.for("GraphicUtil"),sX=Symbol.for("LayerService"),sY=Symbol.for("StaticLayerHandlerContribution"),s$=Symbol.for("DynamicLayerHandlerContribution"),sq=Symbol.for("VirtualLayerHandlerContribution"),sJ=he=class{static GenerateLayerId(){return`${he.idprefix}_${he.prefix_count++}`}constructor(){this.layerMap=new Map,this.global=iC.global}tryInit(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}getStageLayer(t){return this.layerMap.get(t)}getRecommendedLayerType(t){return t||(0!==this.staticLayerCountInEnv?"static":0!==this.dynamicLayerCountInEnv?"dynamic":"virtual")}getLayerHandler(t){return"static"===t?ib.get(sY):"dynamic"===t?ib.get(s$):ib.get(sq)}createLayer(t,e={main:!1}){var i;this.tryInit();let r=this.getRecommendedLayerType(e.layerMode);r=e.main||e.canvasId?"static":r;let n=this.getLayerHandler(r),l=new sV(t,this.global,t.window,Object.assign(Object.assign({main:!1},e),{layerMode:r,canvasId:null!=(i=e.canvasId)?i:he.GenerateLayerId(),layerHandler:n})),s=this.layerMap.get(t)||[];return s.push(l),this.layerMap.set(t,s),this.staticLayerCountInEnv--,l}prepareStageLayer(t){let e;t.forEachChildren(t=>{let i=t.getNativeHandler();"virtual"===i.type?(i.mainHandler=e,e.secondaryHandlers.push(i)):(e=i).secondaryHandlers=[]})}releaseLayer(t,e){e.release();let i=this.layerMap.get(t)||[];this.layerMap.set(t,i.filter(t=>t!==e))}layerCount(t){return(this.layerMap.get(t)||[]).length}restLayerCount(t){return 10*("browser"===this.global.env)}releaseStage(t){this.layerMap.delete(t)}};sJ.idprefix="visactor_layer",sJ.prefix_count=0,sJ=he=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],sJ);let sQ=new eQ(t=>{t(id).to(iM).inSingletonScope(),t(nf).to(ny),t(sK).to(nC).inSingletonScope(),t(sU).to(nw).inSingletonScope(),t(sX).to(sJ).inSingletonScope()}),s0=Symbol.for("IncrementalDrawContribution"),s1=Symbol.for("ArcRender"),s2=Symbol.for("Arc3dRender"),s3=Symbol.for("AreaRender"),s5=Symbol.for("CircleRender"),s4=Symbol.for("GraphicRender"),s6=Symbol.for("GroupRender"),s7=Symbol.for("LineRender"),s8=Symbol.for("PathRender"),s9=Symbol.for("PolygonRender"),at=Symbol.for("RectRender"),ae=Symbol.for("Rect3DRender"),ai=Symbol.for("SymbolRender"),ar=Symbol.for("TextRender"),an=Symbol.for("RichTextRender"),al=Symbol.for("Pyramid3dRender"),as=Symbol.for("GlyphRender"),aa=Symbol.for("ImageRender");Symbol.for("RenderSelector");let ao=Symbol.for("DrawContribution");Symbol.for("StarRender");let ah=class{constructor(t){this.drawContribution=t}prepare(t){t&&this.renderTreeRoots.forEach(e=>{this._prepare(e,t)})}_prepare(t,e){t.forEachChildren(t=>{this._prepare(t,e)}),t.update({bounds:e,trans:!0})}prepareRenderList(){}beforeDraw(t){}draw(t){this.drawContribution.draw(this,Object.assign({},this.drawParams))}afterDraw(t){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}reInit(){this.drawContribution.reInit()}render(t,e){this.renderTreeRoots=t,this.drawParams=e;let i=e.updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(e),this.draw(e),this.afterDraw(e),this.drawParams=null}};ah=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(hi=it(ao),function(t,e){hi(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],ah);let ad=new eQ(t=>{t(i_).to(ah)});Symbol.for("GraphicPicker");let au=Symbol.for("PickerService");Symbol.for("BoundsPicker");let ac=Symbol.for("GlobalPickerService"),ap=Symbol.for("PickItemInterceptor"),ag=Symbol.for("PickServiceInterceptor"),af=(t,e,i,r)=>{let n,l=!1,s=!1;if(e.forEachChildren(t=>!(l=t.numberType===si)),e.forEachChildren(t=>!(s=!!t.findFace)),l){let t=e.getChildren(),a=[...t];a.sort((t,e)=>{var i,r,n,l;let s=(null!=(r=null!=(i=t.attribute.startAngle)?i:0+t.attribute.endAngle)?r:0)/2,a=(null!=(l=null!=(n=e.attribute.startAngle)?n:0+e.attribute.endAngle)?l:0)/2;for(;s<0;)s+=ik.f7;for(;a<0;)a+=ik.f7;return a-s}),a.forEach(t=>{t._next=null,t._prev=null}),e.removeAllChild(),e.update(),a.forEach(t=>{e.appendChild(t)}),r.hack_pieFace="outside",(n=i(l,s))&&n.graphic||(r.hack_pieFace="inside",n=i(l,s)),n&&n.graphic||(r.hack_pieFace="top",n=i(l,s)),e.removeAllChild(),t.forEach(t=>{t._next=null,t._prev=null}),t.forEach(t=>{e.appendChild(t)})}else if(s){let r=e.getChildren(),a=r.map(e=>({ave_z:e.findFace().vertices.map(i=>{var r;return t.view(i[0],i[1],null!=(r=i[2]+e.attribute.z)?r:0)[2]}).reduce((t,e)=>t+e,0),g:e}));a.sort((t,e)=>e.ave_z-t.ave_z),e.removeAllChild(),a.forEach(t=>{t.g._next=null,t.g._prev=null}),e.update(),a.forEach(t=>{e.add(t.g)}),n=i(l,s),e.removeAllChild(),r.forEach(t=>{t._next=null,t._prev=null}),e.update(),r.forEach(t=>{e.add(t)})}else n=i(l,s);return n};var am=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s};let ay=class{constructor(){this.order=1}afterPickItem(t,e,i,r,n){if(t.graphic){let e=t.graphic;for(;e.parent;)e=e.parent;e.shadowHost&&(t.params={shadowTarget:t.graphic},t.graphic=e.shadowHost)}return t}};ay=am([e6()],ay);let av=class{constructor(){this.order=1}afterPickItem(t,e,i,r,n){return t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx?this._pickItem(t,e,i,r,n):null}beforePickItem(t,e,i,r,n){return t.attribute.shadowRootIdx<0?this._pickItem(t,e,i,r,n):null}_pickItem(t,e,i,r,n){var l;if(!t.shadowRoot)return null;let{parentMatrix:s}=n||{};if(!s)return null;let a=e.pickContext;a.highPerformanceSave();let o=null==(l=nP(t))?void 0:l[t.type],{shadowPickMode:h=null==o?void 0:o.shadowPickMode}=t.attribute,d=t.shadowRoot,u=sR.allocateByObj(s),c=new iN.E9(u.a*i.x+u.c*i.y+u.e,u.b*i.x+u.d*i.y+u.f),p=e.pickGroup(d,c,u,r);return a.highPerformanceRestore(),!p.graphic&&p.group&&"full"===h&&(p.graphic=p.group),p}};av=am([e6()],av);let ab=class{constructor(){this.order=1}beforePickItem(t,e,i,r,n){let l=t.baseGraphic;if(l&&l.parent){let t=new iN.E9(i.x,i.y),n=e.pickContext;n.highPerformanceSave();let s=l.parent.globalTransMatrix;s.transformPoint(t,t);let a=l.isContainer?e.pickGroup(l,t.clone(),s,r):e.pickItem(l,t.clone(),s,r);return n.highPerformanceRestore(),a}return null}};ab=am([e6()],ab);let a_=class{constructor(){this.order=1}beforePickItem(t,e,i,r,n){if(!t.in3dMode||r.in3dInterceptor)return null;let l=e.pickContext,s=t.stage;if(!l||!s)return null;if(r.in3dInterceptor=!0,l.save(),this.initCanvasCtx(l),l.camera=s.camera,t.isContainer){let s=af(l,t,()=>e.pickGroup(t,i,n.parentMatrix,r),r);return l.camera=null,r.in3dInterceptor=!1,l.restore(),s}return l.restore(),null}initCanvasCtx(t){t.setTransformForCurrent()}};a_=am([e6()],a_);let aC=new eQ((t,e,i)=>{i(au)||(t(ac).toSelf(),t(au).toService(ac)),t(a_).toSelf().inSingletonScope(),t(ap).toService(a_),t(av).toSelf().inSingletonScope(),t(ap).toService(av),t(ab).toSelf().inSingletonScope(),t(ap).toService(ab),il(t,ap),t(ay).toSelf().inSingletonScope(),t(ag).toService(ay),il(t,ag)});var ax=i(96766),aw=i(64776);function aS(t,e){return"end"===t||"right"===t?-e:"center"===t?-e/2:0}function aA(t,e,i,r=0){return"middle"===t?-e/2:"top"===t?0:"bottom"===t?r-e:t&&"alphabetic"!==t?0:(i||(i=e),-(e-i)/2-.79*i)}function aM(t,e,i){var r;let{x:n=i.x,y:l=i.y,z:s=i.z,dx:a=i.dx,dy:o=i.dy,dz:h=i.dz,scaleX:d=i.scaleX,scaleY:u=i.scaleY,scaleZ:c=i.scaleZ,alpha:p=i.alpha,beta:g=i.beta,angle:f=i.angle,anchor3d:m=e.attribute.anchor,anchor:y}=e.attribute,v=[0,0,0];if(m){if("string"==typeof m[0]){let t=parseFloat(m[0])/100,i=e.AABBBounds;v[0]=i.x1+(i.x2-i.x1)*t}else v[0]=m[0];if("string"==typeof m[1]){let t=parseFloat(m[1])/100,i=e.AABBBounds;v[1]=i.x1+(i.x2-i.x1)*t}else v[1]=m[1];v[2]=null!=(r=m[2])?r:0}if(sx(t),sw(t,t,[n+a,l+o,s+h]),sw(t,t,[v[0],v[1],v[2]]),function(t,e,i){let r=Math.sin(i),n=Math.cos(i),l=e[4],s=e[5],a=e[6],o=e[7],h=e[8],d=e[9],u=e[10],c=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=l*n+h*r,t[5]=s*n+d*r,t[6]=a*n+u*r,t[7]=o*n+c*r,t[8]=h*n-l*r,t[9]=d*n-s*r,t[10]=u*n-a*r,t[11]=c*n-o*r}(t,t,g),function(t,e,i){let r=Math.sin(i),n=Math.cos(i),l=e[0],s=e[1],a=e[2],o=e[3],h=e[8],d=e[9],u=e[10],c=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*n-h*r,t[1]=s*n-d*r,t[2]=a*n-u*r,t[3]=o*n-c*r,t[8]=l*r+h*n,t[9]=s*r+d*n,t[10]=a*r+u*n,t[11]=o*r+c*n}(t,t,p),sw(t,t,[-v[0],-v[1],v[2]]),function(t,e,i){let r=i[0],n=i[1],l=i[2];t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*l,t[9]=e[9]*l,t[10]=e[10]*l,t[11]=e[11]*l,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(t,t,[d,u,c]),f){let i=sP.allocate(),r=[0,0];if(y){if("string"==typeof m[0]){let t=parseFloat(m[0])/100,i=e.AABBBounds;r[0]=i.x1+(i.x2-i.x1)*t}else r[0]=m[0];if("string"==typeof m[1]){let t=parseFloat(m[1])/100,i=e.AABBBounds;r[1]=i.x1+(i.x2-i.x1)*t}else r[1]=m[1]}sw(i,i,[r[0],r[1],0]),function(t,e,i){let r=Math.sin(i),n=Math.cos(i),l=e[0],s=e[1],a=e[2],o=e[3],h=e[4],d=e[5],u=e[6],c=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*n+h*r,t[1]=s*n+d*r,t[2]=a*n+u*r,t[3]=o*n+c*r,t[4]=h*n-l*r,t[5]=d*n-s*r,t[6]=u*n-a*r,t[7]=c*n-o*r}(i,i,f),sw(i,i,[-r[0],-r[1],0]),sA(t,t,i)}}let aT=class{constructor(t){this.creator=t,this.hooks={onAttributeUpdate:new io(["graphic"]),onSetStage:new io(["graphic","stage"]),onRemove:new io(["graphic"]),onRelease:new io(["graphic"]),onAddIncremental:new io(["graphic","group","stage"]),onClearIncremental:new io(["graphic","group","stage"]),beforeUpdateAABBBounds:new io(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new io(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new io(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new iI.FB,this.tempAABBBounds2=new iI.FB}onAttributeUpdate(t){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(t)}onSetStage(t,e){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(t,e)}onRemove(t){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(t)}onRelease(t){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(t)}onAddIncremental(t,e,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(t,e,i)}onClearIncremental(t,e){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(t,e)}beforeUpdateAABBBounds(t,e,i,r){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(t,e,i,r)}afterUpdateAABBBounds(t,e,i,r,n){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(t,e,i,r,n)}clearAABBBounds(t,e,i){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(t,e,i)}updatePathProxyAABBBounds(t,e){let i="function"==typeof e.pathProxy?e.pathProxy(e.attribute):e.pathProxy;if(!i)return!1;let r=new iB(t);return iZ(i.commandList,r,0,0),!0}updateHTMLTextAABBBounds(t,e,i,r){let{textAlign:n,textBaseline:l}=t;if(null!=t.forceBoundsHeight){let e=(0,n4.Z)(t.forceBoundsHeight)?t.forceBoundsHeight:t.forceBoundsHeight(),r=aA(l,e,e);i.set(i.x1,r,i.x2,r+e)}if(null!=t.forceBoundsWidth){let e=(0,n4.Z)(t.forceBoundsWidth)?t.forceBoundsWidth:t.forceBoundsWidth(),r=aS(n,e);i.set(r,i.y1,r+e,i.y2)}}combindShadowAABBBounds(t,e){if(e&&e.shadowRoot){let i=e.shadowRoot.AABBBounds;t.union(i)}}transformAABBBounds(t,e,i,r,n){if(!e.empty()){let{scaleX:n=i.scaleX,scaleY:l=i.scaleY,stroke:s=i.stroke,shadowBlur:a=i.shadowBlur,lineWidth:o=i.lineWidth,pickStrokeBuffer:h=i.pickStrokeBuffer,strokeBoundsBuffer:d=i.strokeBoundsBuffer}=t,u=this.tempAABBBounds1,c=this.tempAABBBounds2;if(s&&o&&(l6(u,(o+h)/Math.abs(n+l),r,d),e.union(u),u.setValue(c.x1,c.y1,c.x2,c.y2)),a){let{shadowOffsetX:r=i.shadowOffsetX,shadowOffsetY:s=i.shadowOffsetY}=t;l6(u,a/Math.abs(n+l)*2,!1,d+1),u.translate(r,s),e.union(u)}}if(this.combindShadowAABBBounds(e,n),e.empty())return;let l=!0,s=n.transMatrix;n&&n.isContainer&&(l=1!==s.a||0!==s.b||0!==s.c||1!==s.d||0!==s.e||0!==s.f),l&&(0,iI.n2)(e,e,s)}validCheck(t,e,i,r){if(!r||null!=t.forceBoundsHeight||null!=t.forceBoundsWidth||r.shadowRoot||r.isContainer)return!0;let{visible:n=e.visible}=t;return!(!r.valid||!n)||(i.empty()||(r.parent&&i.transformWithMatrix(r.parent.globalTransMatrix),this.clearAABBBounds(r,r.stage,i),i.clear()),!1)}updateTempAABBBounds(t){let e=this.tempAABBBounds1,i=this.tempAABBBounds2;return e.setValue(t.x1,t.y1,t.x2,t.y2),i.setValue(t.x1,t.y1,t.x2,t.y2),{tb1:e,tb2:i}}};aT=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(hr=it(sv),function(t,e){hr(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],aT);let ak=new class{constructor(){this.store=new Map}RegisterGraphicCreator(t,e){this.store.set(t,e),this[t]=e}CreateGraphic(t,e){let i=this.store.get(t);return i?i(e):null}},aR=new eQ(t=>{t(sy).to(aT),t(sv).toConstantValue(ak)}),aP=Symbol.for("AutoEnablePlugins"),aB=Symbol.for("PluginService");var aI=function(t,e){return function(i,r){e(i,r,t)}};let aE=class{constructor(t){this.autoEnablePlugins=t,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}active(t,e){this.stage=t,this.actived=!0;let{pluginList:i}=e;i&&ib.isBound(aP)&&this.autoEnablePlugins.getContributions().forEach(t=>{i.includes(t.name)&&this.register(t)})}findPluginsByName(t){let e=[];return this.onStartupFinishedPlugin.forEach(i=>{i.name===t&&e.push(i)}),this.onRegisterPlugin.forEach(i=>{i.name===t&&e.push(i)}),e}register(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.push(t):"onRegister"===t.activeEvent&&(this.onRegisterPlugin.push(t),t.activate(this))}unRegister(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1):"onRegister"===t.activeEvent&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1),t.deactivate(this)}release(...t){this.onStartupFinishedPlugin.forEach(t=>{t.deactivate(this)}),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach(t=>{t.deactivate(this)}),this.onRegisterPlugin=[]}};aE=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),aI(0,it(ii)),aI(0,ie(aP)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],aE);let aL=new eQ(t=>{t(aB).to(aE),t(ii).toDynamicValue(({container:t})=>new ir(aP,t)).whenTargetNamed(aP)}),aF=new eQ(t=>{il(t,ih)}),aO=new eQ(t=>{t(rQ).to(r0).inSingletonScope(),il(t,rQ)}),aH=class{constructor(){this.type="static",this.offscreen=!1,this.global=iC.global}setDpr(t){this.canvas.dpr=t}init(t,e,i){if(this.layer=t,this.window=e,i.main)this.main=!0,this.context=e.getContext(),this.canvas=this.context.getCanvas();else{let t;this.main=!1,i.canvasId&&(t=this.global.getElementById(i.canvasId)),t||(t=this.global.createCanvas({width:e.width,height:e.height})),t.style&&(t.style["pointer-events"]="none");let r=e.getContext().getCanvas().nativeCanvas,n=r4({nativeCanvas:t,width:e.width,height:e.height,dpr:e.dpr,id:i.canvasId,canvasControled:!0,container:e.getContainer(),x:r.offsetLeft,y:r.offsetTop});n.applyPosition(),this.canvas=n,this.context=n.getContext()}}resize(t,e){this.canvas.resize(t,e)}resizeView(t,e){}render(t,e,i){var r;if(!this.main){let t=this.window.getContext().getCanvas().nativeCanvas;t&&(this.canvas.x!==t.offsetLeft||this.canvas.y!==t.offsetTop)&&(this.canvas.x=t.offsetLeft,this.canvas.y=t.offsetTop,this.canvas.applyPosition())}e.renderService.render(t,Object.assign(Object.assign({context:this.context,clear:null!=(r=e.background)?r:"#ffffff"},e),i))}merge(t){t.forEach(t=>{let e=t.getContext().canvas.nativeCanvas;this.context.drawImage(e,0,0)})}prepare(t,e){}drawTo(t,e,i){var r;let n=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:n},i),{clear:i.clear?null!=(r=i.background)?r:"#fff":void 0}))}getContext(){return this.context}release(){this.canvas.release()}};aH=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],aH);let aD=new eQ(t=>{t(aH).toSelf(),t(sY).toService(aH)}),az=e9(e2);function aW(t,e,i){let r={},n=[];return t.forEachChildren(t=>{let{zIndex:i=e}=t.attribute;r[i]?r[i].push(t):(r[i]=[t],n.push(i))},i),n.sort((t,e)=>i?e-t:t-e),{childMap:r,zIdxArray:n}}function aZ(t,e,i,r=!1,n=!1){let l=!1;if(n)l=!0;else{let i;t.forEachChildren((t,r)=>{let{zIndex:n=e}=t.attribute;if(0===r)i=n;else if(i!==n)return l=!0,!0;return!1},r)}if(l){let{childMap:l,zIdxArray:s}=aW(t,e,r),a=!1;for(let t=0;t<s.length&&!a;t++){let e=l[s[t]];n&&e.sort((t,e)=>{var i,n;return(r?-1:1)*((null!=(i=e.attribute.z)?i:0)-(null!=(n=t.attribute.z)?n:0))});for(let t=0;t<e.length;t++)if(i(e[t],t)){a=!0;break}}}else t.forEachChildren(i,r)}function aN(t,e,i,r=!1){var n,l,s,a;return n=this,l=void 0,s=void 0,a=function*(){yield t.forEachChildrenAsync(i,r)},new(s||(s=Promise))(function(t,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(e){var n;e.done?t(e.value):((n=e.value)instanceof s?n:new s(function(t){t(n)})).then(i,r)}o((a=a.apply(n,l||[])).next())})}var aj=i(19273);let aG=Symbol.for("DrawItemInterceptor"),aV=new iI.FB,aU=new iI.FB;class aK{constructor(){this.order=1}afterDrawItem(t,e,i,r,n){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,i,r,n),!1}beforeDrawItem(t,e,i,r,n){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,i,r,n),!1}drawItem(t,e,i,r,n){if(!t.shadowRoot)return!1;let{context:l}=i;if(l.highPerformanceSave(),l.transformFromMatrix(t.transMatrix,!0),r.dirtyBounds&&r.backupDirtyBounds){aV.copy(r.dirtyBounds),aU.copy(r.backupDirtyBounds);let e=t.globalTransMatrix.getInverse();r.dirtyBounds.copy(r.backupDirtyBounds).transformWithMatrix(e),r.backupDirtyBounds.copy(r.dirtyBounds)}return r.renderGroup(t.shadowRoot,i,sR.allocate(1,0,0,1,0,0)),l.highPerformanceRestore(),r.dirtyBounds&&r.backupDirtyBounds&&(r.dirtyBounds.copy(aV),r.backupDirtyBounds.copy(aU)),!0}}class aX{constructor(){this.order=1}afterDrawItem(t,e,i,r,n){return t.attribute._debug_bounds&&this.drawItem(t,e,i,r,n),!1}drawItem(t,e,i,r,n){if(!t.attribute._debug_bounds)return!1;let{context:l}=i;l.highPerformanceSave(),t.parent&&l.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&l.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);let s=t.AABBBounds;return!0!==t.attribute._debug_bounds&&t.attribute._debug_bounds(l,t),l.strokeRect(s.x1,s.y1,s.width(),s.height()),l.highPerformanceRestore(),!0}}let aY=class{constructor(){this.order=1,this.interceptors=[new aK,new aq,new a$,new aX]}afterDrawItem(t,e,i,r,n){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let l=0;l<this.interceptors.length;l++)if(this.interceptors[l].afterDrawItem&&this.interceptors[l].afterDrawItem(t,e,i,r,n))return!0;return!1}beforeDrawItem(t,e,i,r,n){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let l=0;l<this.interceptors.length;l++)if(this.interceptors[l].beforeDrawItem&&this.interceptors[l].beforeDrawItem(t,e,i,r,n))return!0;return!1}};aY=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],aY);class a${constructor(){this.order=1}beforeDrawItem(t,e,i,r,n){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,r,n):this.beforeSetInteractive(t,e,i,r,n))}beforeSetInteractive(t,e,i,r,n){let l=t.interactiveGraphic;if(t.attribute.globalZIndex){l||(l=t.clone(),t.interactiveGraphic=l,l.baseGraphic=t),l.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();let e=i.stage.getLayer("_builtin_interactive");return e&&this.getShadowRoot(e).add(l),!0}if(l){i.stage.tryInitInteractiveLayer();let e=i.stage.getLayer("_builtin_interactive");e&&this.getShadowRoot(e).removeChild(l),t.interactiveGraphic=null,l.baseGraphic=null}return!1}beforeDrawInteractive(t,e,i,r,n){let l=t.baseGraphic,s=!!l.stage,a=l.parent;for(;s&&a&&a.stage!==a;)s=!!a.stage,a=a.parent;if(!s){let e=i.stage.getLayer("_builtin_interactive");return e&&this.getShadowRoot(e).removeChild(t),!0}if(l){this.processing=!0;let{context:t}=i;return t.highPerformanceSave(),t.setTransformFromMatrix(l.parent.globalTransMatrix,!0),l.isContainer?r.renderGroup(l,i,l.parent.globalTransMatrix):r.renderItem(l,i),t.highPerformanceRestore(),this.processing=!1,!0}return!1}getShadowRoot(t){var e;let i=t.getElementById("_interactive_group");return i||((i=ak.CreateGraphic("group",{})).id="_interactive_group",t.add(i)),null!=(e=i.shadowRoot)?e:i.attachShadow()}}class aq{constructor(){this.order=1}beforeDrawItem(t,e,i,r,n){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;let{context:l,stage:s}=e.drawParams;l.canvas,l.save(),this.initCanvasCtx(l),l.camera=s.camera;let a=l.currentMatrix;a.a/=l.dpr,a.b/=l.dpr,a.c/=l.dpr,a.d/=l.dpr,a.e/=l.dpr,a.f/=l.dpr;let o=sP.allocate();sS(o,a);let h=l.modelMatrix;return h?o&&(l.modelMatrix=sA(sP.allocate(),h,o)):l.modelMatrix=o,l.setTransform(1,0,0,1,0,0,!0),t.isContainer?af(l,t,(e,n)=>r.renderGroup(t,i,t.parent.globalTransMatrix,!e&&n),i):r.renderItem(t,i),l.camera=null,l.restore(),l.modelMatrix!==h&&sP.free(l.modelMatrix),l.modelMatrix=h,i.in3dInterceptor=!1,!0}initCanvasCtx(t){t.setTransformForCurrent()}}Symbol.for("BoundsAllocate");let aJ=new class{constructor(){this.pools=[];for(let t=0;t<10;t++)this.pools.push(new iI.FB)}allocate(t,e,i,r){if(!this.pools.length)return(new iI.FB).setValue(t,e,i,r);let n=this.pools.pop();return n.x1=t,n.y1=e,n.x2=i,n.y2=r,n}allocateByObj(t){if(!this.pools.length)return new iI.FB(t);let e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}};var aQ=function(t,e){return function(i,r){e(i,r,t)}};let a0=class{constructor(t,e){this.contributions=t,this.drawItemInterceptorContributions=e,this._renderInGroup=(t,e,i,r)=>{var n;t?e.forEachChildren(t=>{i.break||(t.isContainer?this.renderGroup(t,i,r):this.renderItem(t,i))}):aZ(e,rx.zIndex,t=>{i.break||(t.isContainer?this.renderGroup(t,i,r):this.renderItem(t,i))},!1,!!(null==(n=i.context)?void 0:n.camera))},this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new iI.YZ,this.backupDirtyBounds=new iI.YZ,this.global=iC.global,this.layerService=iC.layerService,(0,rD.Z)(this.contributions)||(this.contributions=[this.contributions]),this.init()}reInit(){this.init(),this.contributions.forEach(t=>{t.reInit()})}init(){this.contributions.forEach(t=>{if(t.style){let e=this.styleRenderMap.get(t.style)||new Map;e.set(t.numberType,t),this.styleRenderMap.set(t.style,e)}else this.defaultRenderMap.set(t.numberType,t)}),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order)}prepareForDraw(t,e){e.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!e.stage.params.optimize.disableCheckGraphicWidthOutRange}draw(t,e){var i;this.prepareForDraw(t,e),e.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(e.renderStyle)||this.defaultRenderMap,this.currentRenderService=t;let{context:r,stage:n,viewBox:l,transMatrix:s}=e;if(!r)return;let a=this.dirtyBounds.setValue(0,0,l.width(),l.height());if(n.dirtyBounds&&!n.dirtyBounds.empty()){let t=(0,aj.di)(a,n.dirtyBounds,!1);a.x1=Math.floor(t.x1),a.y1=Math.floor(t.y1),a.x2=Math.ceil(t.x2),a.y2=Math.ceil(t.y2)}let o=r.dpr%1;(o||.5!==o)&&(a.x1=Math.floor(a.x1*r.dpr)/r.dpr,a.y1=Math.floor(a.y1*r.dpr)/r.dpr,a.x2=Math.ceil(a.x2*r.dpr)/r.dpr,a.y2=Math.ceil(a.y2*r.dpr)/r.dpr),this.backupDirtyBounds.copy(a),r.reset(!1),r.save(),r.setClearMatrix(s.a,s.b,s.c,s.d,s.e,s.f),r.clearMatrix(!1),r.translate(l.x1,l.y1,!0),r.beginPath(),r.rect(a.x1,a.y1,a.width(),a.height()),r.clip(),n.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(t,r,e),(null==(i=t.drawParams)?void 0:i.stage)&&t.drawParams.stage.hooks.afterClearScreen.call(t.drawParams),t.renderTreeRoots.sort((t,e)=>{var i,r;return(null!=(i=t.attribute.zIndex)?i:rx.zIndex)-(null!=(r=e.attribute.zIndex)?r:rx.zIndex)}).forEach(t=>{t.isContainer?this.renderGroup(t,e,sR.allocate(1,0,0,1,0,0)):this.renderItem(t,e)}),r.restore(),r.draw()}doRegister(){throw Error("暂不支持")}_findNextGraphic(t){let e=t.parent,i=t._uid;for(;e;){let t=function(t,e,i,r=!1){let n=!1;t.forEachChildren((t,e)=>{let{zIndex:r=i}=t.attribute;if(0===e);else if(void 0!==r)return n=!0,!0;return!1},r);let l=null,s=!1;if(n){let{childMap:n,zIdxArray:a}=aW(t,i,r),o=!1;for(let t=0;t<a.length&&!o;t++){let i=n[a[t]];for(let t=0;t<i.length;t++){if(s){o=!0,l=i[t];break}i[t]._uid!==e||(s=!0)}}}else t.forEachChildren(t=>s?(l=t,!0):(t._uid===e&&(s=!0),!1),r);return l}(e,i,rx.zIndex);if(t)return t;i=e._uid,e=e.parent}return null}renderGroup(t,e,i,r){if(e.break||!1===t.attribute.visibleAll)return;if(t.incremental&&(null==e.startAtId||e.startAtId===t._uid))return e.break=!0,void this._increaseRender(t,e);if(this.useDirtyBounds&&!(0,aj.SX)(t.AABBBounds,this.dirtyBounds,!1)&&"empty"!==t.attribute.boundsMode)return;let n,l=i;if(this.useDirtyBounds){n=aJ.allocateByObj(this.dirtyBounds);let e=t.transMatrix;l=sR.allocateByObj(i).multiply(e.a,e.b,e.c,e.d,e.e,e.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(l.getInverse())}e.isGroupScroll=!(!t.attribute.scrollX&&!t.attribute.scrollY),this.renderItem(t,e,{renderInGroupParams:{skipSort:r,nextM:l},renderInGroup:this._renderInGroup}),this.useDirtyBounds&&(this.dirtyBounds.copy(n),aJ.free(n),sR.free(l))}_increaseRender(t,e){let{layer:i,stage:r}=e,{subLayers:n}=i,l=n.get(t._uid);l||(l={layer:this.layerService.createLayer(r),zIndex:n.size,group:t},n.set(t._uid,l));let s=l.layer.getNativeHandler().getContext(),a=l.drawContribution||ib.get(s0);a.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:a,clear:"transparent",layer:l.layer,context:s,startAtId:t._uid,break:!1})),l.drawContribution=a;let o=this._findNextGraphic(t);if(o)if(o.isContainer&&o.incremental)this._increaseRender(o,e);else{let t=n.get(o._uid);t||(t={layer:this.layerService.createLayer(r),zIndex:n.size},n.set(o._uid,t));let i=t.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:a,clear:"transparent",layer:t.layer,context:i,startAtId:o._uid,break:!1}))}}getRenderContribution(t){let e;return e||(e=this.selectRenderByNumberType(t.numberType,t)),e||(e=this.selectRenderByType(t.type)),e}renderItem(t,e,i){if(this.InterceptorContributions.length)for(let r=0;r<this.InterceptorContributions.length;r++){let n=this.InterceptorContributions[r];if(n.beforeDrawItem&&n.beforeDrawItem(t,this.currentRenderService,e,this,i))return}let r=this.getRenderContribution(t);if(!r)return;let n,l=!1;if(e.isGroupScroll){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;l=!0,this.scrollMatrix||(this.scrollMatrix=sR.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-e,-i)}if(l&&(n=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),this.useDirtyBounds&&!t.isContainer&&"empty"!==t.attribute.boundsMode&&!(0,aj.SX)(t.AABBBounds,null!=n?n:this.dirtyBounds,!1)){if(l&&t.parent){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(e,i)}return}let s=null!=e.startAtId&&t._uid!==e.startAtId;if(t._uid===e.startAtId&&(e.startAtId=null),i&&(i.skipDraw=s),s?t.isContainer&&r.draw(t,this.currentRenderService,e,i):r.draw(t,this.currentRenderService,e,i),l&&t.parent){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(e,i)}if(this.InterceptorContributions.length)for(let i=0;i<this.InterceptorContributions.length;i++){let r=this.InterceptorContributions[i];if(r.afterDrawItem&&r.afterDrawItem(t,this.currentRenderService,e,this))return}}selectRenderByType(t){return iR.Y.getInstance().warn("未知错误，不应该走到这里"),null}selectRenderByNumberType(t,e){let i;if(e.attribute.renderStyle){let r=this.styleRenderMap.get(e.attribute.renderStyle);i=r&&r.get(t)}return i||this.currentRenderMap.get(t)||this.defaultRenderMap.get(t)}clearScreen(t,e,i){var r,n,l;let{clear:s,viewBox:a}=i,o=a.width(),h=a.height();if(s){e.clearRect(0,0,o,h),(null==(r=t.drawParams)?void 0:r.stage)&&t.drawParams.stage.hooks.afterClearRect.call(t.drawParams);let i=null==(n=t.drawParams)?void 0:n.stage;if(i&&(e.globalAlpha=null!=(l=i.attribute.opacity)?l:1),i&&i.backgroundImg&&i.resources){let t=i.resources.get(s);t&&"success"===t.state&&t.data&&e.drawImage(t.data,0,0,o,h)}else e.fillStyle=rN(e,s,{AABBBounds:{x1:0,y1:0,x2:0+o,y2:0+h}},0,0),e.fillRect(0,0,o,h)}}afterDraw(t,e){}};a0=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),aQ(0,az(s4)),aQ(1,it(ii)),aQ(1,ie(aG)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Array,Object])],a0);var a1=i(99051);let a2=ik.pi/2;function a3(t,e,i,r,n,l,s=!0,a){let o;if(Array.isArray(s)&&(a=s,s=!0),r<0&&(e+=r,r=-r),n<0&&(i+=n,n=-n),(0,n4.Z)(l,!0))o=[l=(0,ik.Wn)(l),l,l,l];else if(Array.isArray(l)){let t,e,i=l;switch(i.length){case 0:o=[0,0,0,0];break;case 1:o=[t=(0,ik.Wn)(i[0]),t,t,t];break;case 2:case 3:o=[t=(0,ik.Wn)(i[0]),e=(0,ik.Wn)(i[1]),t,e];break;default:(o=i)[0]=(0,ik.Wn)(o[0]),o[1]=(0,ik.Wn)(o[1]),o[2]=(0,ik.Wn)(o[2]),o[3]=(0,ik.Wn)(o[3])}}else o=[0,0,0,0];if(r<0||o[0]+o[1]+o[2]+o[3]<1e-12)return t.rect(e,i,r,n);let[h,d,u,c]=[[e,i],[e+r,i],[e+r,i+n],[e,i+n]],p=Math.min(r/2,n/2),g=[Math.min(p,o[0]),Math.min(p,o[1]),Math.min(p,o[2]),Math.min(p,o[3])],f=[h[0]+g[0],h[1]],m=[h[0],h[1]+g[0]],y=[d[0]-g[1],d[1]],v=[d[0],d[1]+g[1]],b=[u[0]-g[2],u[1]],_=[u[0],u[1]-g[2]],C=[c[0]+g[3],c[1]],x=[c[0],c[1]-g[3]];if(t.moveTo(f[0],f[1]),s){if(a&&a[0]?a[0](f[0],f[1],y[0],y[1]):t.lineTo(y[0],y[1]),!(0,a1.h6)(y,v)){a&&a[0]&&t.moveTo(y[0],y[1]);let e=y[0],i=y[1]+g[1];t.arc(e,i,g[1],-a2,0,!1)}if(a&&a[1]?a[1](v[0],v[1],_[0],_[1]):t.lineTo(_[0],_[1]),!(0,a1.h6)(b,_)){let e=_[0]-g[2],i=_[1];a&&a[1]&&t.moveTo(_[0],_[1]),t.arc(e,i,g[2],0,a2,!1)}if(a&&a[2]?a[2](b[0],b[1],C[0],C[1]):t.lineTo(C[0],C[1]),!(0,a1.h6)(C,x)){let e=C[0],i=C[1]-g[3];a&&a[2]&&t.moveTo(C[0],C[1]),t.arc(e,i,g[3],a2,ik.pi,!1)}if(a&&a[3]?a[3](x[0],x[1],m[0],m[1]):t.lineTo(m[0],m[1]),!(0,a1.h6)(f,m)){let e=f[0],i=f[1]+g[0];a&&a[3]&&t.moveTo(m[0],m[1]),t.arc(e,i,g[0],ik.pi,ik.pi+a2,!1)}}else a&&a[0]?a[0](f[0],f[1],y[0],y[1]):t.lineTo(y[0],y[1]),a&&a[1]?a[1](y[0],y[1],b[0],b[1]):t.lineTo(b[0],b[1]),a&&a[2]?a[2](b[0],b[1],C[0],C[1]):t.lineTo(C[0],C[1]),a&&a[2]?a[2](C[0],C[1],f[0],f[1]):t.lineTo(f[0],f[1]);return a||t.closePath(),t}function a5(t,e){return((0,rD.Z)(t)?t.some(t=>t||void 0===t):!!t)&&e>0}function a4(t,e,i){return i&&t*e>0}function a6(t,e,i,r,n){return n&&t*e>0&&0!==i&&0!==r}function a7(t,e,i,r,n){return n?t*e>0:t*e>0&&0!==i&&0!==r}function a8(t,e,i,r,n,l,s){let a=t-i,o=e-r,h=(s?l:-l)/Math.sqrt(a*a+o*o),d=h*o,u=-h*a,c=t+d,p=e+u,g=i+d,f=r+u,m=(c+g)/2,y=(p+f)/2,v=g-c,b=f-p,_=v*v+b*b,C=n-l,x=c*f-g*p,w=(b<0?-1:1)*Math.sqrt(Math.max(0,C*C*_-x*x)),S=(x*b-v*w)/_,A=(-x*v-b*w)/_,M=(x*b+v*w)/_,T=(-x*v+b*w)/_,k=S-m,R=A-y,P=M-m,B=T-y;return k*k+R*R>P*P+B*B&&(S=M,A=T),{cx:S,cy:A,x01:-d,y01:-u,x11:S*(n/C-1),y11:A*(n/C-1)}}function a9(t,e,i,r,n){let l,s,a,o,h=(0,ik.Wn)(i-e),d=t.getParsedCornerRadius(),u=(0,rD.Z)(d),{outerDeltaAngle:c,innerDeltaAngle:p,outerStartAngle:g,outerEndAngle:f,innerEndAngle:m,innerStartAngle:y}=t.getParsePadAngle(e,i),v=u?d[0]:d,b=u?d[1]:d,_=u?d[2]:d,C=u?d[3]:d,x=Math.max(b,v),w=Math.max(_,C),S=x,A=w,M=n*(0,ik.mC)(g),T=n*(0,ik.O$)(g),k=r*(0,ik.mC)(m),R=r*(0,ik.O$)(m);if((w>ik.Ho||x>ik.Ho)&&(l=n*(0,ik.mC)(f),s=n*(0,ik.O$)(f),a=r*(0,ik.mC)(y),o=r*(0,ik.O$)(y),h<ik.pi)){let t=function(t,e,i,r,n,l,s,a){let o=i-t,h=r-e,d=s-n,u=a-l,c=u*o-d*h;return c*c<ik.Ho?[]:(c=(d*(e-l)-u*(t-n))/c,[t+c*o,e+c*h])}(M,T,a,o,l,s,k,R);if(t){let e=M-t[0],i=T-t[1],a=l-t[0],o=s-t[1],h=1/(0,ik.O$)((0,ik.Kh)((e*a+i*o)/((0,ik._b)(e*e+i*i)*(0,ik._b)(a*a+o*o)))/2),d=(0,ik._b)(t[0]*t[0]+t[1]*t[1]);A=(0,ik.VV)(w,(r-d)/(h-1)),S=(0,ik.VV)(x,(n-d)/(h+1))}}return{outerDeltaAngle:c,xors:M,yors:T,xirs:a,yirs:o,xore:l,yore:s,xire:k,yire:R,limitedOcr:S,limitedIcr:A,outerCornerRadiusStart:v,outerCornerRadiusEnd:b,maxOuterCornerRadius:x,maxInnerCornerRadius:w,outerStartAngle:g,outerEndAngle:f,innerDeltaAngle:p,innerEndAngle:m,innerStartAngle:y,innerCornerRadiusStart:C,innerCornerRadiusEnd:_}}function ot(t,e,i,r,n,l,s){let{startAngle:a,endAngle:o}=t.getParsedAngle(),h=(0,ik.Wn)(o-a),d=o>a,u=!1;if(n<l){let t=n;n=l,l=t}if(n<=ik.Ho)e.moveTo(i,r);else if(h>=ik.f7-ik.Ho)e.moveTo(i+n*(0,ik.mC)(a),r+n*(0,ik.O$)(a)),e.arc(i,r,n,a,o,!d),l>ik.Ho&&(e.moveTo(i+l*(0,ik.mC)(o),r+l*(0,ik.O$)(o)),e.arc(i,r,l,o,a,d));else{let{outerDeltaAngle:h,xors:c,yors:p,xirs:g,yirs:f,limitedOcr:m,outerCornerRadiusStart:y,outerCornerRadiusEnd:v,maxOuterCornerRadius:b,xore:_,yore:C,xire:x,yire:w,outerStartAngle:S,outerEndAngle:A,limitedIcr:M,innerDeltaAngle:T,innerEndAngle:k,innerStartAngle:R,innerCornerRadiusStart:P,innerCornerRadiusEnd:B,maxInnerCornerRadius:I}=a9(t,a,o,l,n);if(h<.001)s&&(s[3]||s[1])&&e.moveTo(i+c,r+p),u=!0;else if(m>ik.Ho){let t=(0,ik.VV)(y,m),l=(0,ik.VV)(v,m),a=a8(g,f,c,p,n,t,Number(d)),o=a8(_,C,x,w,n,l,Number(d));m<b&&t===l?!s||s[0]?(e.moveTo(i+a.cx+a.x01,r+a.cy+a.y01),e.arc(i+a.cx,r+a.cy,m,(0,ik.fv)(a.y01,a.x01),(0,ik.fv)(o.y01,o.x01),!d)):e.moveTo(i+a.cx+m*(0,ik.mC)((0,ik.fv)(o.y01,o.x01)),r+a.cy+m*(0,ik.O$)((0,ik.fv)(o.y01,o.x01))):!s||s[0]?(e.moveTo(i+a.cx+a.x01,r+a.cy+a.y01),t>0&&e.arc(i+a.cx,r+a.cy,t,(0,ik.fv)(a.y01,a.x01),(0,ik.fv)(a.y11,a.x11),!d),e.arc(i,r,n,(0,ik.fv)(a.cy+a.y11,a.cx+a.x11),(0,ik.fv)(o.cy+o.y11,o.cx+o.x11),!d),l>0&&e.arc(i+o.cx,r+o.cy,l,(0,ik.fv)(o.y11,o.x11),(0,ik.fv)(o.y01,o.x01),!d)):l>0?e.moveTo(i+o.cx+l*(0,ik.mC)((0,ik.fv)(o.y01,o.x01)),r+o.cy+l*(0,ik.O$)((0,ik.fv)(o.y01,o.x01))):e.moveTo(i+_,r+n*(0,ik.O$)(A))}else!s||s[0]?(e.moveTo(i+c,r+p),e.arc(i,r,n,S,A,!d)):e.moveTo(i+n*(0,ik.mC)(A),r+n*(0,ik.O$)(A));if(!(l>ik.Ho)||T<.001)!s||s[1]?e.lineTo(i+x,r+w):e.moveTo(i+x,r+w),u=!0;else if(M>ik.Ho){let t=(0,ik.VV)(P,M),n=(0,ik.VV)(B,M),a=a8(x,w,_,C,l,-n,Number(d)),o=a8(c,p,g,f,l,-t,Number(d));if(!s||s[1]?e.lineTo(i+a.cx+a.x01,r+a.cy+a.y01):e.moveTo(i+a.cx+a.x01,r+a.cy+a.y01),M<I&&t===n){let t=(0,ik.fv)(o.y01,o.x01);!s||s[2]?e.arc(i+a.cx,r+a.cy,M,(0,ik.fv)(a.y01,a.x01),t,!d):e.moveTo(i+a.cx+(0,ik.mC)(t),r+a.cy+(0,ik.O$)(t))}else!s||s[2]?(n>0&&e.arc(i+a.cx,r+a.cy,n,(0,ik.fv)(a.y01,a.x01),(0,ik.fv)(a.y11,a.x11),!d),e.arc(i,r,l,(0,ik.fv)(a.cy+a.y11,a.cx+a.x11),(0,ik.fv)(o.cy+o.y11,o.cx+o.x11),d),t>0&&e.arc(i+o.cx,r+o.cy,t,(0,ik.fv)(o.y11,o.x11),(0,ik.fv)(o.y01,o.x01),!d)):t>0?e.moveTo(i+o.cx+t*(0,ik.mC)((0,ik.fv)(o.y01,o.x01)),r+o.cy+t*(0,ik.O$)((0,ik.fv)(o.y01,o.x01))):e.moveTo(i+g,r+f)}else!s||s[1]?e.lineTo(i+x,r+w):e.moveTo(i+x,r+w),!s||s[2]?e.arc(i,r,l,k,R,d):e.moveTo(i+l*(0,ik.mC)(R),r+l*(0,ik.O$)(R))}return s?s[3]&&e.lineTo(i+n*(0,ik.mC)(a),r+n*(0,ik.O$)(a)):e.closePath(),u}let oe=Symbol.for("ArcRenderContribution"),oi=Symbol.for("AreaRenderContribution"),or=Symbol.for("CircleRenderContribution"),on=Symbol.for("GroupRenderContribution"),ol=Symbol.for("ImageRenderContribution"),os=Symbol.for("PathRenderContribution"),oa=Symbol.for("PolygonRenderContribution"),oo=Symbol.for("RectRenderContribution"),oh=Symbol.for("SymbolRenderContribution"),od=Symbol.for("TextRenderContribution");Symbol.for("StarRenderContribution"),Symbol.for("CommonRenderContribution");let ou=Symbol.for("InteractiveSubRenderContribution");var oc=function(t,e){return function(i,r){e(i,r,t)}};class op{constructor(){this.time=o6.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){var p;let{background:g,backgroundOpacity:f=null!=(p=t.attribute.fillOpacity)?p:o.backgroundOpacity,opacity:m=o.opacity,backgroundMode:y=o.backgroundMode,backgroundFit:v=o.backgroundFit,backgroundKeepAspectRatio:b=o.backgroundKeepAspectRatio,backgroundScale:_=o.backgroundScale,backgroundOffsetX:C=o.backgroundOffsetX,backgroundOffsetY:x=o.backgroundOffsetY,backgroundClip:w=o.backgroundClip}=t.attribute;if(g)if(t.backgroundImg&&t.resources){let n=t.resources.get(g);if("success"!==n.state||!n.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){let i=nP(t.parent).group,{scrollX:r=i.scrollX,scrollY:n=i.scrollY}=t.parent.attribute;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(r,n)}w&&e.clip();let l=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,r,o),e.globalAlpha=f*m,this.doDrawImage(e,n.data,l,{backgroundMode:y,backgroundFit:v,backgroundKeepAspectRatio:b,backgroundScale:_,backgroundOffsetX:C,backgroundOffsetY:x}),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,o),e.globalAlpha=f*m,e.fillStyle=g,e.fill(),e.highPerformanceRestore()}doDrawImage(t,e,i,r){let{backgroundMode:n,backgroundFit:l,backgroundKeepAspectRatio:s,backgroundScale:a=1,backgroundOffsetX:o=0,backgroundOffsetY:h=0}=r,d=i.width(),u=i.height(),c=d,p=u;if("no-repeat"===n)if(l)if(s){let r=Math.max(d/e.width,u/e.height);t.drawImage(e,i.x1+o,i.y1+h,e.width*r*a,e.height*r*a)}else t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{let r=e.width*a,n=e.height*a;t.drawImage(e,i.x1+o,i.y1+h,r,n)}else{if(l&&"repeat"!==n&&(e.width||e.height)){let i=e.width,r=e.height;"repeat-x"===n?(c=u/r*i,p=u):"repeat-y"===n&&(p=d/i*r,c=d);let l=t.dpr,s=np.allocate({width:c,height:p,dpr:l}),a=s.getContext("2d");a&&(a.inuse=!0,a.clearMatrix(),a.setTransformForCurrent(!0),a.clearRect(0,0,c,p),a.drawImage(e,0,0,c,p),e=s.nativeCanvas),np.free(s)}let r=t.dpr,s=t.createPattern(e,n);s.setTransform&&s.setTransform(new DOMMatrix([1/r,0,0,1/r,0,0])),t.fillStyle=s,t.translate(i.x1,i.y1),t.fillRect(0,0,d,u),t.translate(-i.x1,-i.y1)}}}let og=new op,of=class{constructor(t){this.subRenderContribitions=t,this.time=o6.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach(p=>{p.render(t,e,i,r,n,l,s,a,o,h,d,u,c)})}};of=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),oc(0,it(ii)),oc(0,ie(ou)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],of);let om=new class{constructor(){this.time=o6.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){var p,g;let{clipConfig:f}=t.attribute;if(!f)return;let m=t.getClipPath();if(!m)return;let y=!(d||u),v=t.AABBBounds,b=null!=(p=t.attribute.width)?p:v.width(),_=null!=(g=t.attribute.height)?g:v.height();y&&e.save(),e.beginPath(),!1===m.draw(e,[b,_],i+b/2,r+_/2,0)&&e.closePath(),d&&d(e,t.attribute,o,!0),y&&e.clip()}},oy=new class{constructor(){this.time=o6.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{clipConfig:p}=t.attribute;p&&t.getClipPath()&&(d||u||e.restore())}},ov=new class extends op{constructor(){super(...arguments),this.time=o6.beforeFillStroke}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){let{background:c,backgroundMode:p=o.backgroundMode,backgroundFit:g=o.backgroundFit,backgroundKeepAspectRatio:f=o.backgroundKeepAspectRatio,backgroundScale:m=o.backgroundScale,backgroundOffsetX:y=o.backgroundOffsetX,backgroundOffsetY:v=o.backgroundOffsetY}=t.attribute;if(c)if(t.backgroundImg&&t.resources){let i=t.resources.get(c);if("success"!==i.state||!i.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);let r=t.AABBBounds;this.doDrawImage(e,i.data,r,{backgroundMode:p,backgroundFit:g,backgroundKeepAspectRatio:f,backgroundScale:m,backgroundOffsetX:y,backgroundOffsetY:v}),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=c,e.fill(),e.highPerformanceRestore()}};var ob=function(t,e){return function(i,r){e(i,r,t)}};let o_=class{constructor(t){this.groupRenderContribitions=t,this.numberType=ss}reInit(){this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(ov)}drawShape(t,e,i,r,n,l,s,a,o){let{clip:h,fill:d,stroke:u,background:c}=t.attribute;if(!(h||d||u||c))return;o=null!=o?o:nP(t,null==l?void 0:l.theme).group;let{opacity:p=o.opacity,width:g=o.width,height:f=o.height,fillOpacity:m=o.fillOpacity,strokeOpacity:y=o.strokeOpacity,cornerRadius:v=o.cornerRadius,path:b=o.path,lineWidth:_=o.lineWidth,visible:C=o.visible,fillStrokeOrder:x=o.fillStrokeOrder,cornerType:w=o.cornerType,x:S=o.x,y:A=o.y}=t.attribute,M=a6(p,m,g,f,d),T=a7(p,y,g,f),k=!(!d&&!c),R=a5(u,_);if(!t.valid||!C||!h&&(!k&&!R||!(M||T||s||a||c)))return;if(b&&b.length&&n.drawContribution){let t=e.disableFill,i=e.disableStroke,r=e.disableBeginPath;e.disableFill=!0,e.disableStroke=!0,e.disableBeginPath=!0,b.forEach(t=>{n.drawContribution.getRenderContribution(t).draw(t,n.renderService,n,l)}),e.disableFill=t,e.disableStroke=i,e.disableBeginPath=r}else 0===v||(0,rD.Z)(v)&&v.every(t=>0===t)?(e.beginPath(),e.rect(i,r,g,f)):(e.beginPath(),a3(e,i,r,g,f,v,"bevel"!==w));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(ov));let P={doFill:k,doStroke:R};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this._groupRenderContribitions.forEach(l=>{l.time===o6.beforeFillStroke&&l.drawShape(t,e,i,r,k,R,M,T,o,n,s,a,P)}),h&&e.clip();let B=()=>{P.doFill&&(s?s(e,t.attribute,o):M&&(e.setCommonStyle(t,t.attribute,S-i,A-r,o),e.fill()))},I=()=>{P.doStroke&&(a?a(e,t.attribute,o):T&&(e.setStrokeStyle(t,t.attribute,S-i,A-r,o),e.stroke()))};x?(I(),B()):(B(),I()),this._groupRenderContribitions.forEach(l=>{l.time===o6.afterFillStroke&&l.drawShape(t,e,i,r,k,R,M,T,o,n,s,a)})}draw(t,e,i,r){var n,l;let s,{context:a}=i;if(!a)return;let{clip:o,baseOpacity:h=1,drawMode:d}=t.attribute,u=a.nativeContext,c=a.canvas.nativeCanvas;if(d>0){let{x:e,y:i,width:r,height:n}=t.attribute,l=a.canvas,s=iC.global.createCanvas({width:l.width,height:l.height,dpr:1}),o=s.getContext("2d"),h=a.nativeContext.getTransform();o.setTransform(h.a,h.b,h.c,h.d,h.e,h.f),1===d&&(o.save(),o.clearRect(0,0,l.width,l.height),o.beginPath(),o.rect(e,i,r,n),o.clip(),o.drawImage(l.nativeCanvas,0,0,l.width,l.height,0,0,l.displayWidth,l.displayHeight),o.restore()),a.nativeContext=o,l.nativeCanvas=s}o?a.save():a.highPerformanceSave();let p=a.baseGlobalAlpha;a.baseGlobalAlpha*=h;let g=a.modelMatrix;if(a.camera){let e=nP(t,null==r?void 0:r.theme).group,i=sP.allocate(),n=sP.allocate();aM(n,t,e),sA(i,g||i,n),a.modelMatrix=i,sP.free(n),a.setTransform(1,0,0,1,0,0,!0)}else a.transformFromMatrix(t.transMatrix,!0);a.beginPath(),r.skipDraw?this.drawShape(t,a,0,0,i,r,()=>!1,()=>!1):this.drawShape(t,a,0,0,i,null,null,null);let{scrollX:f,scrollY:m}=t.attribute;if((f||m)&&a.translate(f,m),r&&r.renderInGroup&&(s=r.renderInGroup(null==(n=r.renderInGroupParams)?void 0:n.skipSort,t,i,null==(l=r.renderInGroupParams)?void 0:l.nextM)),a.modelMatrix!==g&&sP.free(a.modelMatrix),a.modelMatrix=g,a.baseGlobalAlpha=p,d>0){let{x:e,y:i,width:r,height:n}=t.attribute,l=a.nativeContext,s=a.canvas.nativeCanvas;u.save(),u.setTransform(a.dpr,0,0,a.dpr,0,0,!0),1===d&&l.rect(e,i,r,n),u.drawImage(s,0,0,s.width,s.height,0,0,a.canvas.displayWidth,a.canvas.displayHeight);let o=l.getTransform();u.setTransform(o.a,o.b,o.c,o.d,o.e,o.f),a.nativeContext=u,a.canvas.nativeCanvas=c,u.restore()}s&&s.then?s.then(()=>{o?a.restore():a.highPerformanceRestore()}):o?a.restore():a.highPerformanceRestore()}};o_=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),ob(0,it(ii)),ob(0,ie(on)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],o_);let oC={x:0,y:0,z:0,lastModelMatrix:null};class ox{init(t){t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions||(this.builtinContributions=[]),this.builtinContributions.push(om),this.builtinContributions.push(oy),this.builtinContributions.forEach(t=>this._renderContribitions.push(t)),this._renderContribitions.length&&(this._renderContribitions.sort((t,e)=>e.order-t.order),this._beforeRenderContribitions=this._renderContribitions.filter(t=>t.time===o6.beforeFillStroke),this._afterRenderContribitions=this._renderContribitions.filter(t=>t.time===o6.afterFillStroke))}reInit(){this.init(this.graphicRenderContributions)}beforeRenderStep(t,e,i,r,n,l,s,a,o,h,d,u,c){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach(p=>{(!p.supportedAppName||!t.stage||!t.stage.params||!t.stage.params.context||!t.stage.params.context.appName||(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName))&&p.drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c)})}afterRenderStep(t,e,i,r,n,l,s,a,o,h,d,u,c){this._afterRenderContribitions&&this._afterRenderContribitions.forEach(p=>{(!p.supportedAppName||!t.stage||!t.stage.params||!t.stage.params.context||!t.stage.params.context.appName||(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName))&&p.drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c)})}drawPathProxy(t,e,i,r,n,l,s,a){if(!t.pathProxy)return!1;let o=nP(t,null==l?void 0:l.theme)[t.type.replace("3d","")],{fill:h=o.fill,stroke:d=o.stroke,opacity:u=o.opacity,fillOpacity:c=o.fillOpacity,lineWidth:p=o.lineWidth,strokeOpacity:g=o.strokeOpacity,visible:f=o.visible,x:m=o.x,y:y=o.y}=t.attribute,v=h&&u*c>0,b=u*g>0,_=!!h,C=a5(d,p);return!f||!_&&!C||!v&&!b&&!s&&!a||(e.beginPath(),iZ(("function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy).commandList,e,i,r),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,_,C,v,b,o,n,s,a),C&&(a?a(e,t.attribute,o):b&&(e.setStrokeStyle(t,t.attribute,i-m,r-y,o),e.stroke())),_&&(s?s(e,t.attribute,o):v&&(e.setCommonStyle(t,t.attribute,i-m,r-y,o),e.fill())),this.afterRenderStep(t,e,i,r,_,C,v,b,o,n,s,a),!0)}valid(t,e,i,r){let{fill:n=e.fill,background:l,stroke:s=e.stroke,opacity:a=e.opacity,fillOpacity:o=e.fillOpacity,lineWidth:h=e.lineWidth,strokeOpacity:d=e.strokeOpacity,visible:u=e.visible}=t.attribute,c=n&&a*o>0,p=a*d>0,g=!(!n&&!l),f=a5(s,h);return!(!t.valid||!u)&&!(!g&&!f)&&!!(c||p||i||r||l)&&{fVisible:c,sVisible:p,doFill:g,doStroke:f}}transform(t,e,i,r=!1){let{x:n=e.x,y:l=e.y,z:s=e.z,scaleX:a=e.scaleX,scaleY:o=e.scaleY,angle:h=e.angle,postMatrix:d}=t.attribute,u=i.modelMatrix,c=i.camera;oC.x=n,oC.y=l,oC.z=s,oC.lastModelMatrix=u;let p=c&&(r||function(t){let{alpha:e,beta:i}=t.attribute;return e||i}(t)),g=p?t.transMatrix.onlyTranslate()&&!d:1===a&&1===o&&0===h&&!d;if(p){let r=sP.allocate(),n=sP.allocate();aM(n,t,e),sA(r,u||r,n),oC.x=0,oC.y=0,oC.z=0,i.modelMatrix=r,i.setTransform(1,0,0,1,0,0,!0),sP.free(n)}if(g&&!u){let r=t.getOffsetXY(e);oC.x+=r.x,oC.y+=r.y,oC.z=s,i.setTransformForCurrent()}else if(p)oC.x=0,oC.y=0,oC.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(c&&i.project){let r=t.getOffsetXY(e);oC.x+=r.x,oC.y+=r.y,this.transformWithoutTranslate(i,oC.x,oC.y,oC.z,a,o,h)}else i.transformFromMatrix(t.transMatrix,!0),oC.x=0,oC.y=0,oC.z=0;return oC}transformUseContext2d(t,e,i,r){let n=r.camera;if(this.camera=n,n){let e=t.AABBBounds,n=e.x2-e.x1,l=e.y2-e.y1,s=r.project(0,0,i),a=r.project(n,0,i),o=r.project(n,l,i),h={x:0,y:0},d={x:n,y:0},u={x:n,y:l};r.camera=null;let c=1/(h.x*(u.y-d.y)-d.x*u.y+u.x*d.y+(d.x-u.x)*h.y),p=-(h.y*(o.x-a.x)-d.y*o.x+u.y*a.x+(d.y-u.y)*s.x)*c,g=(d.y*o.y+h.y*(a.y-o.y)-u.y*a.y+(u.y-d.y)*s.y)*c,f=(h.x*(o.x-a.x)-d.x*o.x+u.x*a.x+(d.x-u.x)*s.x)*c,m=-(d.x*o.y+h.x*(a.y-o.y)-u.x*a.y+(u.x-d.x)*s.y)*c,y=(h.x*(u.y*a.x-d.y*o.x)+h.y*(d.x*o.x-u.x*a.x)+(u.x*d.y-d.x*u.y)*s.x)*c,v=(h.x*(u.y*a.y-d.y*o.y)+h.y*(d.x*o.y-u.x*a.y)+(u.x*d.y-d.x*u.y)*s.y)*c;r.setTransform(p,g,f,m,y,v,!0)}}restoreTransformUseContext2d(t,e,i,r){this.camera&&(r.camera=this.camera)}transformWithoutTranslate(t,e,i,r,n,l,s){let a=t.project(e,i,r);t.translate(a.x,a.y,!1),t.scale(n,l,!1),t.rotate(s,!1),t.translate(-a.x,-a.y,!1),t.setTransformForCurrent()}_draw(t,e,i,r,n,l){let{context:s}=r;if(!s)return;let{renderable:a}=t.attribute;if(!1===a)return;s.highPerformanceSave();let{x:o,y:h,z:d,lastModelMatrix:u}=this.transform(t,e,s,i);this.z=d,this.drawPathProxy(t,s,o,h,r,n)||(this.drawShape(t,s,o,h,r,n,null,null,l),this.z=0,s.modelMatrix!==u&&sP.free(s.modelMatrix),s.modelMatrix=u),s.highPerformanceRestore()}}function ow(t,e,i,r){if(!e.p1)return;let{offsetX:n=0,offsetY:l=0,offsetZ:s=0}=r||{};if(1===i)e.p2&&e.p3?t.bezierCurveTo(n+e.p1.x,l+e.p1.y,n+e.p2.x,l+e.p2.y,n+e.p3.x,l+e.p3.y,s):t.lineTo(n+e.p1.x,l+e.p1.y,s);else if(e.p2&&e.p3){let[r]=iq(e,i);t.bezierCurveTo(n+r.p1.x,l+r.p1.y,n+r.p2.x,l+r.p2.y,n+r.p3.x,l+r.p3.y,s)}else{let r=e.getPointAt(i);t.lineTo(n+r.x,l+r.y,s)}}function oS(t,e,i,r,n,l,s){var a;let o=e.p0,h=r;if(i&&i.originP1===i.originP2&&(o=i.p0),e.defined)r||(t.lineTo(o.x+n,o.y+l,s),h=!r);else{let d,{originP1:u,originP2:c}=e;if(u&&!1!==u.defined&&!i?d=o:u&&!1!==c.defined&&(d=null!=(a=e.p3)?a:e.p1),r){h=!r;let i=d?d.x:e.p0.x,a=d?d.y:e.p0.y;t.moveTo(i+n,a+l,s)}else d&&(h=!r,t.lineTo(d.x+n,d.y+l,s))}return h}function oA(t,e,i,r,n){let l,{offsetX:s=0,offsetY:a=0,offsetZ:o=0,mode:h="none",drawConnect:d=!1}=n||{};if(d&&"none"===h||!e)return;let u=!0,{curves:c}=e;if(i>=1){if(d){let e,i=!0;c.forEach((r,n)=>{r.originP1!==r.originP2&&(i=oS(t,r,e,i,s,a,o)),e=r})}else c.forEach(e=>{e.defined?(u&&t.moveTo(e.p0.x+s,e.p0.y+a,o),ow(t,e,1,n),u=!1):u=!0});return}if(i<=0)return;"x"===r?l=o5.ROW:"y"===r?l=o5.COLUMN:"auto"===r&&(l=e.direction);let p=i*e.tryUpdateLength(l),g=0,f=!0,m=null;for(let e=0,i=c.length;e<i;e++){let i=c[e],r=i.getLength(l),h=(p-g)/r;if(g+=r,h<0)break;if(d){if(i.originP1===i.originP2){m=i;continue}f=oS(t,i,m,f,s,a,o),m=i}else{if(!i.defined){u=!0;continue}u&&t.moveTo(i.p0.x+s,i.p0.y+a,o),ow(t,i,(0,ik.VV)(h,1),n),u=!1}}}let oM=class extends ox{constructor(){super(...arguments),this.numberType=so}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).line;this._draw(t,n,!1,i,r)}drawSegmentItem(t,e,i,r,n,l,s,a,o,h,d,u,c,p,g){var f;if(!e)return;t.beginPath(),oA(t,e,o,h,{offsetX:d,offsetY:u,offsetZ:null!=(f=this.z)?f:0}),c.cache&&!(0,rD.Z)(c.cache)&&c.cache.curves.every(t=>t.defined)&&c.attribute.curveType&&c.attribute.curveType.includes("Closed")&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(c,s,a);let{x:m=0,x:y=0}=s;return!1!==i&&(p?p(t,s,a):n&&(t.setCommonStyle(c,s,m-d,y-u,a),t.fill())),!1!==r&&(g?g(t,s,a):l&&(t.setStrokeStyle(c,s,m-d,y-u,a),t.stroke())),!1}drawLinearLineHighPerformance(t,e,i,r,n,l,s,a,o,h,d,u,c){var p;e.beginPath();let g=null!=(p=this.z)?p:0,{points:f}=t.attribute,m=f[0];e.moveTo(m.x+s,m.y+a,g);for(let t=1;t<f.length;t++){let i=f[t];e.lineTo(i.x+s,i.y+a,g)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o);let{x:y=0,x:v=0}=t.attribute;!1!==i&&(u?u(e,t.attribute,o):n&&(e.setCommonStyle(t,t.attribute,y-s,v-a,o),e.fill())),!1!==r&&(c?c(e,t.attribute,o):l&&(e.setStrokeStyle(t,t.attribute,y-s,v-a,o),e.stroke()))}drawShape(t,e,i,r,n,l,s,a){let o=nP(t,null==l?void 0:l.theme).line,{fill:h=o.fill,stroke:d=o.stroke,fillOpacity:u=o.fillOpacity,strokeOpacity:c=o.strokeOpacity,segments:p,points:g,closePath:f,curveTension:m=o.curveTension,connectedType:y=o.connectedType}=t.attribute;if(!this.valid(t,o,s,a))return;let{curveType:v=o.curveType}=t.attribute;f&&"linear"===v&&(v="linearClosed");let{clipRange:b=o.clipRange,clipRangeByDimension:_=o.clipRangeByDimension}=t.attribute;if(1===b&&!p&&!g.some(t=>!1===t.defined)&&"linear"===v)return this.drawLinearLineHighPerformance(t,e,!!h,!!d,u,c,i,r,o,n,l,s,a);function C(t,e){return"none"===e?t:t.filter(t=>!1!==t.defined)}if(t.shouldUpdateShape()){let{points:e,segments:i}=t.attribute;if(i&&i.length){let e,r;if(t.cache=i.map((t,i)=>{if(t.points.length<=1&&0===i)return t.points[0]&&(r={endX:t.points[0].x,endY:t.points[0].y,curves:[{defined:!1!==t.points[0].defined}]}),null;1===i?e={x:r.endX,y:r.endY,defined:r.curves[r.curves.length-1].defined}:i>1&&(e.x=r.endX,e.y=r.endY,e.defined=r.curves[r.curves.length-1].defined);let n=rc(C(t.points,y),v,{startPoint:e,curveTension:m});return r=n,n}).filter(t=>!!t),"linearClosed"===v){let e;for(let i=0;i<t.cache.length;i++){let r=t.cache[i];for(let t=0;t<r.curves.length;t++)if(r.curves[t].defined){e=r.curves[t].p0;break}if(e)break}t.cache[t.cache.length-1]&&t.cache[t.cache.length-1].lineTo(e.x,e.y,!0)}}else{if(!e||!e.length)return t.cache=null,void t.clearUpdateShapeTag();t.cache=rc(C(e,y),v,{curveTension:m})}t.clearUpdateShapeTag()}if(Array.isArray(t.cache)){let n=t.attribute.segments.filter(t=>t.points.length);if(1===n[0].points.length&&n.shift(),1===b){let l=!1;t.cache.forEach((p,g)=>{l||(l=this.drawSegmentItem(e,p,!!h,!!d,u,c,n[g],[o,t.attribute],b,_,i,r,t,s,a))})}else{let l=b*t.cache.reduce((t,e)=>t+e.getLength(),0),p=0,g=!1;t.cache.forEach((f,m)=>{if(g)return;let y=f.getLength(),v=(l-p)/y;p+=y,v>0&&(g=this.drawSegmentItem(e,f,!!h,!!d,u,c,n[m],[o,t.attribute],(0,ik.VV)(v,1),_,i,r,t,s,a))})}}else this.drawSegmentItem(e,t.cache,!!h,!!d,u,c,t.attribute,o,b,_,i,r,t,s,a)}};oM=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],oM);let oT=class extends oM{constructor(){super(...arguments),this.numberType=so}drawShape(t,e,i,r,n,l,s,a){if(t.incremental&&n.multiGraphicOptions){let{startAtIdx:e,length:l}=n.multiGraphicOptions,{segments:o=[]}=t.attribute;if(e>o.length)return;let h=nP(t).line,{fill:d=h.fill,stroke:u=h.stroke,opacity:c=h.opacity,fillOpacity:p=h.fillOpacity,strokeOpacity:g=h.strokeOpacity,lineWidth:f=h.lineWidth,visible:m=h.visible}=t.attribute,y=a5(u,f);if(!t.valid||!m||!d&&!y||!(d&&c*p>0||c*g>0||s||a))return;let{context:v}=n;for(let n=e;n<e+l;n++)this.drawIncreaseSegment(t,v,o[n-1],o[n],t.attribute.segments[n],[h,t.attribute],i,r)}else super.drawShape(t,e,i,r,n,l,s,a)}drawIncreaseSegment(t,e,i,r,n,l,s,a){r&&(e.beginPath(),function(t,e,i,r){let{offsetX:n=0,offsetY:l=0}=r||{},s=e?e.points[e.points.length-1]:i.points[0];t.moveTo(s.x+n,s.y+l),i.points.forEach(e=>{!1!==e.defined?t.lineTo(e.x+n,e.y+l):t.moveTo(e.x+n,e.y+l)})}(e.nativeContext,i,r,{offsetX:s,offsetY:a}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,n,l),e.setStrokeStyle(t,n,s,a,l),e.stroke())}};function ok(t,e,i,r){let{offsetX:n=0,offsetY:l=0,offsetZ:s=0}=r||{},a=!0;e.forEach(e=>{e.defined?(a&&t.moveTo(e.p0.x+n,e.p0.y+l,s),ow(t,e,1,r),a=!1):a=!0}),a=!0;for(let e=i.length-1;e>=0;e--){let o=i[e];o.defined?(a&&t.lineTo(o.p0.x+n,o.p0.y+l,s),ow(t,o,1,r),a=!1):a=!0}t.closePath()}oT=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],oT);let oR=(t,e,i)=>{let{outerBorder:r,shadowBlur:n=e.shadowBlur,strokeBoundsBuffer:l=e.strokeBoundsBuffer}=t;if(r){let t=e.outerBorder,{distance:s=t.distance,lineWidth:a=t.lineWidth}=r;l6(i,s+(n+a)/2,!0,l)}return i},oP=["symbolType","size",...sO];class oB extends sN{constructor(t={symbolType:"circle"}){super(t),this.type="symbol",this.numberType=sf}getParsedPath(){return this.shouldUpdateShape()&&(this._parsedPath=this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}getParsedPath2D(t=0,e=0,i=1){let r=null;try{r=new Path2D}catch(t){return null}let n=this.getParsedPath();if(!n)return null;n.draw(r,i,t,e)}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{size:t}=this.attribute;return(0,rD.Z)(t)?2===t.length&&t.every(this._validNumber):this._validNumber(t)}doUpdateParsedPath(){let{symbolType:t="circle"}=this.attribute;return super.parsePath(t)}getGraphicTheme(){return nP(this).symbol}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateSymbolAABBBoundsImprecise(t,e,i):this.updateSymbolAABBBoundsAccurate(t,e,i));let{tb1:n,tb2:l}=iC.graphicService.updateTempAABBBounds(i);oR(t,e,n),i.union(n),n.setValue(l.x1,l.y1,l.x2,l.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,this.x1WithoutTransform=i.x1,this.y1WithoutTransform=i.y1;let{lineJoin:s=e.lineJoin}=t;return iC.graphicService.transformAABBBounds(t,i,e,"miter"===s,this),i}updateSymbolAABBBoundsImprecise(t,e,i){let{size:r=e.size}=t;if((0,rD.Z)(r))i.set(-r[0]/2,-r[1]/2,r[0]/2,r[1]/2);else{let t=r/2;i.set(-t,-t,t,t)}return i}updateSymbolAABBBoundsAccurate(t,e,i){let{size:r=e.size}=t,n=this.getParsedPath();return n&&n.bounds(r,i),i}needUpdateTags(t){return super.needUpdateTags(t,oP)}needUpdateTag(t){return super.needUpdateTag(t,oP)}toCustomPath(){let t=this.getParsedPath();if(!t)return null;let e=this.attribute.size,i=(0,rD.Z)(e)?e:[e,e];return t.path?(new rp).fromCustomPath2D(t.path,0,0,i[0],i[1]):(new rp).fromString(t.pathStr,0,0,i[0],i[1])}clone(){return new oB(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return oB.NOWORK_ANIMATE_ATTR}}function oI(t){return new oB(t)}oB.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},sZ);class oE{constructor(){this.time=o6.afterFillStroke,this.useStyle=!0,this.order=10,this._tempSymbolGraphic=null}createCommonPattern(t,e,i,r,n){let l=(t-2*e)/2,s=r.dpr,a=np.allocate({width:t,height:t,dpr:s}),o=a.getContext("2d");if(!o)return null;o.inuse=!0,o.clearMatrix(),o.setTransformForCurrent(!0),o.clearRect(0,0,t,t),n(l,o);let h=r.createPattern(a.nativeCanvas,"repeat");return h.setTransform&&h.setTransform(new DOMMatrix([1/s,0,0,1/s,0,0])),np.free(a),h}createCirclePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,e)=>{e.fillStyle=i,e.arc(t,t,t,0,ik.f7),e.fill()})}createDiamondPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{let n=t/2;r.fillStyle=i,r.moveTo(n,n-e),r.lineTo(e+n,n),r.lineTo(n,n+e),r.lineTo(n-e,n),r.closePath(),r.fill()})}createRectPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,r)=>{r.fillStyle=i,r.fillRect(e,e,2*t,2*t)})}createVerticalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(r,n)=>{n.fillStyle=i,n.fillRect(e,0,2*r,t)})}createHorizontalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(r,n)=>{n.fillStyle=i,n.fillRect(0,e,t,2*r)})}createBiasLRLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{r.strokeStyle=i,r.lineWidth=e,r.moveTo(0,0),r.lineTo(t,t);let n=t/2,l=-n;r.moveTo(n,l),r.lineTo(n+t,l+t),r.moveTo(-n,-l),r.lineTo(-n+t,-l+t),r.stroke()})}createBiasRLLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{r.strokeStyle=i,r.lineWidth=e,r.moveTo(t,0),r.lineTo(0,t);let n=t/2;r.moveTo(t+n,n),r.lineTo(n,n+t),r.moveTo(t-n,-n),r.lineTo(-n,-n+t),r.stroke()})}createGridPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,r)=>{r.fillStyle=i,r.fillRect(e,e,t,t),r.fillRect(e+t,e+t,t,t)})}initTextureMap(t,e){this.textureMap=new Map}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){this.textureMap||this.initTextureMap(e,t.stage);let{texture:p=o.texture,textureColor:g=o.textureColor,textureSize:f=o.textureSize,texturePadding:m=o.texturePadding}=t.attribute;p&&this.drawTexture(p,t,e,i,r,o,g,f,m)}drawTexture(t,e,i,r,n,l,s,a,o){var h;let{textureRatio:d=l.textureRatio,textureOptions:u=null}=e.attribute,c=this.textureMap.get(t);if(!c)switch(t){case"circle":c=this.createCirclePattern(a,o,s,i);break;case"diamond":c=this.createDiamondPattern(a,o,s,i);break;case"rect":c=this.createRectPattern(a,o,s,i);break;case"vertical-line":c=this.createVerticalLinePattern(a,o,s,i);break;case"horizontal-line":c=this.createHorizontalLinePattern(a,o,s,i);break;case"bias-lr":c=this.createBiasLRLinePattern(a,o,s,i);break;case"bias-rl":c=this.createBiasRLLinePattern(a,o,s,i);break;case"grid":c=this.createGridPattern(a,o,s,i)}if(u&&u.dynamicTexture){let c,{gridConfig:p={},useNewCanvas:g}=u,f=e.AABBBounds;r=f.x1,n=f.y1;let m=i;if(g){let t=(c=np.allocate({width:f.width(),height:f.height(),dpr:i.dpr})).getContext("2d");t.clearRect(0,0,f.width(),f.height()),r=0,n=0,i=t}if(m.save(),e.parent&&!e.transMatrix.onlyTranslate()){let{scrollX:t=0,scrollY:i=0}=e.parent.attribute;m.setTransformFromMatrix(e.parent.globalTransMatrix),m.translate(t,i,!0)}m.setCommonStyle(e,e.attribute,r,n,l),m.clip();let y=f.width(),v=f.height(),b=p.columns?p.columns:Math.ceil(y/a),_=p.rows?p.rows:Math.ceil(v/a),C=p.gutterColumn?p.gutterColumn:2*o,x=p.gutterRow?p.gutterRow:2*o;this._tempSymbolGraphic||(this._tempSymbolGraphic=oI({}));let w=p.columns?y/p.columns:a,S=p.rows?v/p.rows:a;this._tempSymbolGraphic.setAttributes({size:[w-C,S-x],symbolType:t});let A=this._tempSymbolGraphic.getParsedPath();for(let t=0;t<_;t++)for(let l=0;l<b;l++){let o=r+a/2+l*a,c=n+a/2+t*a;null==(h=u.beforeDynamicTexture)||h.call(u,i,t,l,_,b,d,e,f.width(),f.height()),i.beginPath(),!1===A.draw(i,Math.min(w-C,S-x),o,c,0)&&i.closePath(),i.fillStyle=s,u.dynamicTexture(i,t,l,_,b,d,e,f.width(),f.height())}g&&(m.globalAlpha=1,m.drawImage(c.nativeCanvas,0,0,c.nativeCanvas.width,c.nativeCanvas.height,f.x1,f.y1,f.width()*m.dpr,f.height()*m.dpr)),m.restore()}else if(c)i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,r,n,l),i.fillStyle=c,i.fill(),i.highPerformanceRestore();else if("wave"===t){i.save(),i.setCommonStyle(e,e.attribute,r,n,l),i.clip();let t=e.AABBBounds;(function(t,e,i,r,n,l,s){let{fill:a="orange",percent:o=.6,frequency:h=4,opacity:d,phi:u=0}=n,{amplitude:c=10}=n;c*=e<=.5?4*e-1:-4*e+3;let p=r*(1-o),g=Math.max(Math.round(i/70),2);t.beginPath(),t.moveTo(0+l,r+s),t.lineTo(0+l,p+s);let f=i/h*e,m=i/Math.PI/(2*h);for(let e=0;e<i;e+=g){let i=c*Math.sin((e+f+u)/m+u);t.lineTo(e+l,p+i+s)}t.lineTo(i+l,r+s),t.closePath(),t.fillStyle=a,isFinite(d)&&(t.globalAlpha=d),t.fill()})(i,d,t.width(),t.height(),Object.assign(Object.assign({},u||{}),{fill:s}),r+t.x1-r,n+t.y1-n),i.restore()}}}let oL=new oE,oF=new class extends oE{constructor(){super(...arguments),this.time=o6.afterFillStroke}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){var p,g,f,m;this.textureMap||this.initTextureMap(e,t.stage);let{attribute:y=t.attribute}=c||{},{texture:v=null!=(p=t.attribute.texture)?p:n0(o,"texture"),textureColor:b=null!=(g=t.attribute.textureColor)?g:n0(o,"textureColor"),textureSize:_=null!=(f=t.attribute.textureSize)?f:n0(o,"textureSize"),texturePadding:C=null!=(m=t.attribute.texturePadding)?m:n0(o,"texturePadding")}=y;v&&this.drawTexture(v,t,e,i,r,o,b,_,C)}};var oO=function(t,e){return function(i,r){e(i,r,t)}};let oH=class extends ox{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=sr,this.builtinContributions=[oF,og],this.init(t)}drawLinearAreaHighPerformance(t,e,i,r,n,l,s,a,o,h,d,u,c){var p,g,f;let{points:m}=t.attribute;if(m.length<2)return;e.beginPath();let y=null!=(p=this.z)?p:0,v=m[0];e.moveTo(v.x+s,v.y+a,y);for(let t=1;t<m.length;t++){let i=m[t];e.lineTo(i.x+s,i.y+a,y)}for(let t=m.length-1;t>=0;t--){let i=m[t];e.lineTo((null!=(g=i.x1)?g:i.x)+s,(null!=(f=i.y1)?f:i.y)+a,y)}e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,s,a,!!n,!1,i,!1,o,h,u,null,{attribute:t.attribute});let{x:b=0,x:_=0}=t.attribute;!1!==i&&(u?u(e,t.attribute,o):n&&(e.setCommonStyle(t,t.attribute,b-s,_-a,o),e.fill())),this.afterRenderStep(t,e,s,a,!!n,!1,i,!1,o,h,u,null,{attribute:t.attribute}),(()=>{var i,n;if(r){let{stroke:r=o&&o.stroke}=t.attribute;if((0,rD.Z)(r)&&(r[0]||r[2])&&!1===r[1]){if(e.beginPath(),r[0]){e.moveTo(v.x+s,v.y+a,y);for(let t=1;t<m.length;t++){let i=m[t];e.lineTo(i.x+s,i.y+a,y)}}else if(r[2]){let t=m[m.length-1];e.moveTo(t.x+s,t.y+a,y);for(let t=m.length-2;t>=0;t--){let r=m[t];e.lineTo((null!=(i=r.x1)?i:r.x)+s,(null!=(n=r.y1)?n:r.y)+a,y)}}}c?c(e,t.attribute,o):(e.setStrokeStyle(t,t.attribute,b-s,_-a,o),e.stroke())}})()}drawShape(t,e,i,r,n,l,s,a){var o,h,d,u,c,p;let g=nP(t,null==l?void 0:l.theme).area,{fill:f=g.fill,stroke:m=g.stroke,fillOpacity:y=g.fillOpacity,z:v=g.z,strokeOpacity:b=g.strokeOpacity,curveTension:_=g.curveTension,connectedType:C=g.connectedType}=t.attribute,x=this.valid(t,g,s,a);if(!x)return;let{doFill:w}=x,S=x.doStroke&&x.sVisible,{clipRange:A=g.clipRange,closePath:M,points:T,segments:k}=t.attribute,{curveType:R=g.curveType}=t.attribute;function P(t,e){return"connect"!==e?t:t.filter(t=>!1!==t.defined)}if(M&&"linear"===R&&(R="linearClosed"),1===A&&!k&&!T.some(t=>!1===t.defined)&&"linear"===R)return this.drawLinearAreaHighPerformance(t,e,!!f,S,y,b,i,r,g,n,l,s,a);if(t.shouldUpdateShape()){if(k&&k.length){let e,i,r,n=k.map((t,r)=>{if(t.points.length<=1&&0===r)return t.points[0]&&(i={endX:t.points[0].x,endY:t.points[0].y}),null;1===r?e={x:i.endX,y:i.endY}:r>1&&(e.x=i.endX,e.y=i.endY);let n=rc(P(t.points,C),R,{startPoint:e,curveTension:_});return i=n,n}).filter(t=>!!t),l=[];for(let t=k.length-1;t>=0;t--){let e=k[t].points,i=[];for(let t=e.length-1;t>=0;t--)i.push({x:null!=(o=e[t].x1)?o:e[t].x,y:null!=(h=e[t].y1)?h:e[t].y});if(0!==t){let e=k[t-1].points,r=e[e.length-1];r&&i.push({x:null!=(d=r.x1)?d:r.x,y:null!=(u=r.y1)?u:r.y})}i.length>1&&(r=rc(P(i,C),"stepBefore"===R?"stepAfter":"stepAfter"===R?"stepBefore":R,{curveTension:_}),l.unshift(r))}t.cacheArea=l.map((t,e)=>({top:n[e],bottom:t}))}else{if(!T||!T.length)return t.cacheArea=null,void t.clearUpdateShapeTag();{let e=P(T,C),i=[];for(let t=e.length-1;t>=0;t--)i.push({x:null!=(c=e[t].x1)?c:e[t].x,y:null!=(p=e[t].y1)?p:e[t].y});t.cacheArea={top:rc(e,R,{curveTension:_}),bottom:rc(i,"stepBefore"===R?"stepAfter":"stepAfter"===R?"stepBefore":R,{curveTension:_})}}}t.clearUpdateShapeTag()}if(Array.isArray(t.cacheArea)){let l=t.attribute.segments.filter(t=>t.points.length);if(1===l[0].points.length&&l.shift(),1===A){let o=!1;t.cacheArea.forEach((h,d)=>{o||(o=this.drawSegmentItem(e,h,w,y,S,b,l[d],[g,t.attribute],A,i,r,v,t,n,s,a))})}else{let o=A*t.cacheArea.reduce((t,e)=>t+e.top.getLength(),0),h=0,d=!1;t.cacheArea.forEach((u,c)=>{if(d)return;let p=u.top.getLength(),f=(o-h)/p;h+=p,f>0&&(d=this.drawSegmentItem(e,u,w,y,S,b,l[c],[g,t.attribute],(0,ik.VV)(f,1),i,r,v,t,n,s,a))})}}else this.drawSegmentItem(e,t.cacheArea,w,y,S,b,t.attribute,g,A,i,r,v,t,n,s,a)}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).area;this._draw(t,n,!1,i,r)}drawSegmentItem(t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f){return this._drawSegmentItem(t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f)}_drawSegmentItem(t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f){if(!(e&&e.top&&e.bottom&&e.top.curves&&e.top.curves.length&&e.bottom.curves&&e.bottom.curves.length))return;t.beginPath();let{points:m,segments:y}=c.attribute,v,b,_=o5.ROW;if(y){let t=y[y.length-1];b=y[0].points[0],v=t.points[t.points.length-1]}else b=m[0],v=m[m.length-1];let C=(0,ik.Wn)(v.x-b.x),x=(0,ik.Wn)(v.y-b.y);(function(t,e,i,r){var n;let{top:l,bottom:s}=e;if(l.curves.length!==s.curves.length)return;if(i>=1){let e=[],i=[],n=!0;for(let a=0,o=l.curves.length;a<o;a++){let h=l.curves[a];n!==h.defined?(n?(ok(t,e,i,r),e.length=0,i.length=0):(e.push(h),i.push(s.curves[o-a-1])),n=!n):n&&(e.push(h),i.push(s.curves[o-a-1]))}return ok(t,e,i,r)}if(i<=0)return;let{direction:a}=r||{},{curves:o}=l,h=null!=(n=o[o.length-1].p3)?n:o[o.length-1].p1,d=(0,ik.Wn)(h.x-o[0].p0.x),u=(0,ik.Wn)(h.y-o[0].p0.y);a=null!=a?a:d>u?o5.ROW:o5.COLUMN,Number.isFinite(d)||(a=o5.COLUMN),Number.isFinite(u)||(a=o5.ROW);let c=i*(a===o5.ROW?d:u),p=0,g=!0,f=[],m=[];for(let e=0,i=l.curves.length;e<i;e++){let n=l.curves[e],o=n.getLength(a),h=(c-p)/o;if(h<0)break;p+=o;let d=null,u=null;g!==n.defined?(g?(ok(t,f,m,r),f.length=0,m.length=0):(d=n,u=s.curves[i-e-1]),g=!g):g&&(d=n,u=s.curves[i-e-1]),d&&u&&(h<1&&(d=d.p2&&d.p3?iq(d,h)[0]:iG(d,h)[0],u=u.p2&&u.p3?iq(u,1-h)[1]:iG(u,1-h)[1]),d.defined=g,u.defined=g,f.push(d),m.push(u)),d=null,u=null}ok(t,f,m,r)})(t,e,o,{offsetX:h,offsetY:d,offsetZ:u,direction:_=null==v.x1?o5.ROW:null==v.y1?o5.COLUMN:Number.isFinite(C+x)?C>x?o5.ROW:o5.COLUMN:o5.ROW}),this.beforeRenderStep(c,t,h,d,!!r,!1,i,!1,a,p,g,null,{attribute:s}),t.setShadowBlendStyle&&t.setShadowBlendStyle(c,s,a);let{x:w=0,x:S=0}=s;return!1!==i&&(g?g(t,s,a):r&&(t.setCommonStyle(c,s,w-h,S-d,a),t.fill())),this.afterRenderStep(c,t,h,d,!!r,!1,i,!1,a,p,g,null,{attribute:s}),(()=>{if(!1!==n)if(f)f(t,s,a);else{let{stroke:i=a&&a[1]&&a[1].stroke}=s;(0,rD.Z)(i)&&(i[0]||i[2])&&!1===i[1]&&(t.beginPath(),oA(t,i[0]?e.top:e.bottom,o,_===o5.ROW?"x":"y",{offsetX:h,offsetY:d,offsetZ:u})),t.setStrokeStyle(c,s,w-h,S-d,a),t.stroke()}})(),!1}};oH=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),oO(0,it(ii)),oO(0,ie(oi)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],oH);let oD=class extends oH{constructor(){super(...arguments),this.numberType=sr}drawShape(t,e,i,r,n,l,s){if(t.incremental&&n.multiGraphicOptions){let{startAtIdx:l,length:a}=n.multiGraphicOptions,{segments:o=[]}=t.attribute;if(l>o.length)return;let h=nP(t).area,{fill:d=h.fill,fillOpacity:u=h.fillOpacity,opacity:c=h.opacity,visible:p=h.visible}=t.attribute;if(t.valid&&p&&d&&(d&&c*u>0||s))for(let n=l;n<l+a;n++)this.drawIncreaseSegment(t,e,o[n-1],o[n],t.attribute.segments[n],[h,t.attribute],i,r)}else super.drawShape(t,e,i,r,n,l,s)}drawIncreaseSegment(t,e,i,r,n,l,s,a){r&&(e.beginPath(),function(t,e,i,r){let{offsetX:n=0,offsetY:l=0}=r||{},{points:s}=i,a=[],o=0;for(let t=0;t<s.length;t++)!1===s[t].defined&&(o+1!==t&&a.slice(o,t),o=t);a.push(s),a.forEach((i,r)=>{var s,a,o,h;let d=e&&0===r?e.points[e.points.length-1]:i[0];t.moveTo(d.x+n,d.y+l),i.forEach(e=>{!1!==e.defined?t.lineTo(e.x+n,e.y+l):t.moveTo(e.x+n,e.y+l)});for(let e=i.length-1;e>=0;e--){let r=i[e];t.lineTo(null!=(s=r.x1)?s:r.x,null!=(a=r.y1)?a:r.y)}t.lineTo(null!=(o=d.x1)?o:d.x,null!=(h=d.y1)?h:d.y),t.closePath()})}(e.camera?e:e.nativeContext,i,r,{offsetX:s,offsetY:a}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,n,l),e.setCommonStyle(t,n,s,a,l),e.fill())}};oD=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],oD);var oz,oW,oZ,oN,oj,oG,oV,oU,oK,oX,oY,o$,oq,oJ,oQ,o0,o1,o2,o3,o5,o4,o6,o7,o8,o9,ht,he,hi,hr,hn,hl=function(t,e){return function(i,r){e(i,r,t)}},hs=function(t,e,i,r){return new(i||(i=Promise))(function(n,l){function s(t){try{o(r.next(t))}catch(t){l(t)}}function a(t){try{o(r.throw(t))}catch(t){l(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(s,a)}o((r=r.apply(t,e||[])).next())})};(A=hn||(hn={}))[A.NORMAL=0]="NORMAL",A[A.STOP=1]="STOP";let ha=class extends a0{constructor(t,e,i,r){super(t,r),this.contributions=t,this.lineRender=e,this.areaRender=i,this.drawItemInterceptorContributions=r,this.rendering=!1,this.currFrameStartAt=0,this.currentIdx=0,this.status=hn.NORMAL,this.checkingForDrawPromise=null,this.hooks={completeDraw:new io([])},this.defaultRenderMap.set(this.lineRender.numberType,this.lineRender),this.defaultRenderMap.set(this.areaRender.numberType,this.areaRender)}draw(t,e){return hs(this,void 0,void 0,function*(){if(this.checkingForDrawPromise)return;this.lastRenderService=t,this.lastDrawContext=e,this.checkingForDrawPromise=this.checkForDraw(e);let i=yield this.checkingForDrawPromise;if(this.checkingForDrawPromise=null,i)return;this.currentRenderService=t;let{context:r,viewBox:n}=e;r&&(r.inuse=!0,r.clearMatrix(),r.setTransformForCurrent(!0),r.save(),e.restartIncremental&&this.clearScreen(this.currentRenderService,r,e),r.translate(n.x1,n.y1,!0),r.save(),t.renderTreeRoots.sort((t,e)=>{var i,r;return(null!=(i=t.attribute.zIndex)?i:rx.zIndex)-(null!=(r=e.attribute.zIndex)?r:rx.zIndex)}).forEach(t=>{this.renderGroup(t,e)}),this.hooks.completeDraw.tap("top-draw",()=>{r.restore(),r.restore(),r.draw(),r.inuse=!1,this.rendering=!1}))})}_increaseRender(t,e){return hs(this,void 0,void 0,function*(){this.rendering=!0,yield this._renderIncrementalGroup(t,e)})}_renderIncrementalGroup(t,e){return hs(this,void 0,void 0,function*(){this.count=t.count,yield new Promise(i=>{this.renderItem(t,e,{drawingCb:()=>hs(this,void 0,void 0,function*(){if(2!==t.count)yield aN(t,rx.zIndex,(i,r)=>{if(this.status===hn.STOP)return!0;if(i.isContainer||r<this.currentIdx)return!1;let n=this.currFrameStartAt+t.incremental;return r<n&&(this.currentIdx=r+1,this.renderItem(i,e)),r===n-1&&(this.currFrameStartAt=this.currentIdx,this.waitToNextFrame())}),i(!1);else{let r=t.getChildAt(0);if(r.incremental&&r.attribute.segments)for(r.incrementalAt||(r.incrementalAt=0);r.incrementalAt<r.attribute.segments.length;)e.multiGraphicOptions={startAtIdx:r.incrementalAt,length:r.incremental},this.renderItem(r,e),r.incrementalAt+=r.incremental,yield this.waitToNextFrame();else this.renderItem(r,e);i(!1)}})})}),this.hooks.completeDraw.call()})}waitToNextFrame(){return hs(this,void 0,void 0,function*(){return new Promise(t=>{this.global.getRequestAnimationFrame()(()=>{t(!1)})})})}checkForDraw(t){return hs(this,void 0,void 0,function*(){let e=this.rendering;return t.restartIncremental&&(e=!1,yield this.forceStop(),this.resetToInit()),e})}forceStop(){return hs(this,void 0,void 0,function*(){this.rendering&&(this.status=hn.STOP,yield new Promise(t=>{this.hooks.completeDraw.tap("stopCb",()=>{this.status=hn.NORMAL,this.hooks.completeDraw.taps=this.hooks.completeDraw.taps.filter(t=>"stopCb"!==t.name),t(!1)})}))})}resetToInit(){this.currFrameStartAt=0,this.currentIdx=0}renderGroup(t,e){return hs(this,void 0,void 0,function*(){if(!e.break&&!1!==t.attribute.visibleAll)return t.incremental&&e.startAtId===t._uid?(yield this._increaseRender(t,e),void(e.break=!0)):void(yield new Promise(i=>{this.renderItem(t,e,{drawingCb:()=>hs(this,void 0,void 0,function*(){yield aN(t,rx.zIndex,t=>hs(this,void 0,void 0,function*(){e.break||t.isContainer&&(yield this.renderGroup(t,e))})),i(!1)})})}))})}};ha=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),hl(0,az(s4)),hl(1,it(oT)),hl(2,it(oD)),hl(3,it(ii)),hl(3,ie(aG)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Array,Object,Object,Object])],ha);let ho=new eQ(t=>{t(op).toSelf().inSingletonScope(),t(oE).toSelf().inSingletonScope(),t(ao).to(a0),t(s0).to(ha),t(s6).to(o_).inSingletonScope(),t(s4).toService(s6),il(t,on),t(of).toSelf().inSingletonScope(),il(t,ou),il(t,s4),t(aY).toSelf().inSingletonScope(),t(aG).toService(aY),il(t,aG)});function hh(){hh.__loaded||(hh.__loaded=!0,ib.load(sQ),ib.load(aR),ib.load(ad),ib.load(aC),ib.load(aL),ib.load(aF),ib.load(aO),ib.load(aD),ib.load(ho))}hh.__loaded=!1,hh();let hd=ib.get(id);function hu(t){return function(e){return(0,rD.Z)(t)?t.reduce((t,e)=>null==t?void 0:t[e],e):null==e?void 0:e[t]}}iC.global=hd,iC.graphicUtil=ib.get(sK),iC.transformUtil=ib.get(sU),iC.graphicService=ib.get(sy),iC.layerService=ib.get(sX);var hc=i(26001);function hp(t,e={data:t=>t}){if(!t)return t;if(t.constructor===Object){let i={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e[r]){i[r]=e[r](t[r]);continue}i[r]=hp(t[r],e)}return i}return(0,rD.Z)(t)?t.map(t=>hp(t,e)):t}function hg(t,e){if(!t)return t;if((0,hc.Z)(t)){let i={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if((0,nI.Z)(t[r])&&e.getFunction(t[r])){i[r]=e.getFunction(t[r]);continue}i[r]=hg(t[r],e)}return i}return(0,rD.Z)(t)?t.map(t=>hg(t,e)):t}let hf=0;function hm(){return hf>=9999999&&(hf=0),hf++}var hy=i(89530);function hv(t){return null!=t&&""!==t&&(!!(0,n4.Z)(t)||+t==+t)}function hb(t){return!(!t||0===t.length)&&!(0,nB.Z)(t[0])&&!(0,nB.Z)(t[0].dataId)&&(0,rD.Z)(t[0].fields)}function h_(t){switch(t){case"left":case"right":case"top":case"bottom":return!0;default:return!1}}function hC(t){return!!(0,nI.Z)(t)&&!!t.endsWith("%")&&hv(t.substring(0,t.length-1))}function hx(t){return!!(0,nF.Z)(t)&&("percent"in t||"offset"in t)}function hw(t,e,i,r=0){var n,l;return(0,n4.Z)(t)?t:hC(t)?Number(t.substring(0,t.length-1))*e/100:(0,nz.Z)(t)?t(i):(0,nF.Z)(t)?e*(null!=(n=t.percent)?n:0)+(null!=(l=t.offset)?l:0):r}function hS(t,e,i){var r,n,l,s;let a={top:0,bottom:0,left:0,right:0};return Object.values(t).every(t=>(0,n4.Z)(t))?(a.top=null!=(r=t.top)?r:0,a.right=null!=(n=t.right)?n:0,a.bottom=null!=(l=t.bottom)?l:0,a.left=null!=(s=t.left)?s:0):[{orients:["left","right"],size:e.width},{orients:["top","bottom"],size:e.height}].forEach(e=>{e.orients.forEach(r=>{a[r]=hw(t[r],e.size,i)})}),a}function hA(t,e){return t?{width:Math.ceil(Math.min(t.x2-t.x1,e.width)),height:Math.ceil(Math.min(t.y2-t.y1,e.height))}:{width:0,height:0}}function hM(t){let e={};return(0,rD.Z)(t)?((0,nB.Z)(t[0])||(e.top=e.left=e.bottom=e.right=t[0]),(0,nB.Z)(t[1])||(e.left=e.right=t[1]),(0,nB.Z)(t[2])||(e.bottom=t[2]),(0,nB.Z)(t[3])||(e.left=t[3]),e):(0,n4.Z)(t)||hC(t)||(0,nz.Z)(t)||hx(t)?(e.top=e.left=e.bottom=e.right=t,e):(0,nF.Z)(t)?e=Object.assign({},t):e}function hT(t,e,i){return i?{x:t.x+e.x,y:t.y+e.y}:t}let hk=(t,e)=>{let i=Number(t),r=t.toString();return isNaN(i)&&"%"===r[r.length-1]?e*(Number(r.slice(0,r.length-1))/100):i};function hR(){if(null==o)try{let t=document.createElement("canvas"),e=t.getContext("2d");(o=!!(window&&t.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&e&&e.isPointInPath&&e.isPointInStroke))&&(o=!!document.createElement)}catch(t){o=!1}let t=iC.global&&iC.global.env;return t?"browser"===t:o}let hP=hR(),hB=hP&&globalThis?globalThis.document:void 0;function hI(t){return("desktop-browser"===t||"mobile-browser"===t)&&hP}function hE(t){return hL(t)||"mobile-browser"===t}function hL(t){return t.includes("miniApp")||"lynx"===t||"wx"===t||"harmony"===t}let hF=(t,...e)=>hD.silent?null:iR.Y.getInstance().info(`[VChart log]: ${t}`,...e),hO=(t,e)=>((0,nz.Z)(hD.warnHandler)&&hD.warnHandler.call(null,t,e),e?iR.Y.getInstance().warn(`[VChart warn]: ${t}`,e):iR.Y.getInstance().warn(`[VChart warn]: ${t}`)),hH=(t,e,i)=>{if(!hD.silent){if(!(0,nz.Z)(hD.errorHandler))throw Error(t);hD.errorHandler.call(null,t,e)}},hD={silent:!1,warnHandler:!1,errorHandler:!1},hz=[{maxDomainLength:10,scheme:["#1664FF","#1AC6FF","#FF8A00","#3CC780","#7442D4","#FFC400","#304D77","#B48DEB","#009488","#FF7DDA"]},{scheme:["#1664FF","#B2CFFF","#1AC6FF","#94EFFF","#FF8A00","#FFCE7A","#3CC780","#B9EDCD","#7442D4","#DDC5FA","#FFC400","#FAE878","#304D77","#8B959E","#B48DEB","#EFE3FF","#009488","#59BAA8","#FF7DDA","#FFCFEE"]}],hW={fontFamily:"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,'-apple-system',segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",fontSize:14,l1FontSize:32,l1LineHeight:"150%",l2FontSize:20,l2LineHeight:"140%",l3FontSize:16,l3LineHeight:"150%",l4FontSize:14,l4LineHeight:"150%",l5FontSize:12,l5LineHeight:"130%",l6FontSize:10,l6LineHeight:"120%"},hZ={name:"light",background:{type:"palette",key:"backgroundColor"},padding:20,fontFamily:{type:"token",key:"fontFamily"},colorScheme:{default:{dataScheme:hz,palette:{backgroundColor:"#ffffff",borderColor:"#e3e5e8",shadowColor:"rgba(33,37,44,0.1)",hoverBackgroundColor:"#f1f2f5",sliderRailColor:"#f1f3f4",sliderHandleColor:"#ffffff",sliderTrackColor:"#0040ff",popupBackgroundColor:"#ffffff",primaryFontColor:"#21252c",secondaryFontColor:"#606773",tertiaryFontColor:"#89909d",axisLabelFontColor:"#89909d",disableFontColor:"#bcc1cb",axisMarkerFontColor:"#ffffff",axisGridColor:"#f1f2f5",axisDomainColor:"#d9dde4",dataZoomHandleStrokeColor:"#aeb5be",dataZoomChartColor:"#c9ced8",playerControllerColor:"#0040ff",scrollBarSliderColor:"rgba(0,0,0,0.3)",axisMarkerBackgroundColor:"#21252c",markLabelBackgroundColor:"#f1f2f5",markLineStrokeColor:"#606773",dangerColor:"#e33232",warningColor:"#ffc528",successColor:"#07a35a",infoColor:"#3073f2",discreteLegendPagerTextColor:"rgb(51, 51, 51)",discreteLegendPagerHandlerColor:"rgb(47, 69, 84)",discreteLegendPagerHandlerDisableColor:"rgb(170, 170, 170)",emptyCircleColor:"#e3e5e8",linearProgressTrackColor:"#E7EBED"}}},token:hW,component:{poptip:{visible:!0,position:"auto",padding:8,titleStyle:{fontSize:{type:"token",key:"l5FontSize"},fontWeight:"bold",fill:{type:"palette",key:"primaryFontColor"}},contentStyle:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"primaryFontColor"}},panel:{visible:!0,fill:{type:"palette",key:"popupBackgroundColor"},cornerRadius:3,lineWidth:0,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"},size:0,space:12}}},mark:{text:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1}}},markByName:{label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1,lineJoin:"bevel"}},area:{style:{fillOpacity:.2}},line:{style:{lineWidth:2,lineCap:"round",lineJoin:"round"}},point:{style:{size:8,stroke:{type:"palette",key:"backgroundColor"},lineWidth:1,fillOpacity:1}},word:{style:{fontWeight:null,fontSize:null}},fillingWord:{style:{fontWeight:null,fontSize:null}},barBackground:{visible:!1,style:{fill:{type:"palette",key:"primaryFontColor",a:.06},stroke:"transparent"}}},animationThreshold:2e3},hN={name:"dark",colorScheme:{default:{dataScheme:hz,palette:{backgroundColor:"#202226",borderColor:"#404349",shadowColor:"rgba(0,0,0,0.1)",hoverBackgroundColor:"#404349",sliderRailColor:"#404349",sliderHandleColor:"#202226",sliderTrackColor:"#4284FF",popupBackgroundColor:"#404349",primaryFontColor:"#fdfdfd",secondaryFontColor:"#bbbdc3",tertiaryFontColor:"#888c93",axisLabelFontColor:"#888c93",disableFontColor:"#55595f",axisMarkerFontColor:"#202226",axisGridColor:"#404349",axisDomainColor:"#4b4f54",dataZoomHandleStrokeColor:"#bbbdc3",dataZoomChartColor:"#55595F",playerControllerColor:"#4284FF",scrollBarSliderColor:"rgba(255,255,255,0.3)",axisMarkerBackgroundColor:"#fdfdfd",markLabelBackgroundColor:"#404349",markLineStrokeColor:"#bbbdc3",dangerColor:"#eb4b4b",warningColor:"#f0bd30",successColor:"#14b267",infoColor:"#4284ff",discreteLegendPagerTextColor:"#BBBDC3",discreteLegendPagerHandlerColor:"#BBBDC3",discreteLegendPagerHandlerDisableColor:"#55595F",emptyCircleColor:"#bbbdc3",linearProgressTrackColor:"#404349"}}},component:{dataZoom:{selectedBackground:{style:{fillOpacity:.4,outerBorder:{strokeOpacity:.4}}}}}};var hj=i(60692),hG=i(53026),hV=i(12317);function hU(t){var e,i;let{type:r}=t;return r===Y.sankey?null!=(e=t.direction)?e:"horizontal":null!=(i=t.direction)?i:"vertical"}(M=Y||(Y={})).area="area",M.line="line",M.bar="bar",M.rangeColumn="rangeColumn",M.rangeArea="rangeArea",M.dot="dot",M.geo="geo",M.link="link",M.map="map",M.pie="pie",M.radar="radar",M.rose="rose",M.scatter="scatter",M.circularProgress="circularProgress",M.wordCloud="wordCloud",M.funnel="funnel",M.linearProgress="linearProgress",M.boxPlot="boxPlot",M.sankey="sankey",M.gaugePointer="gaugePointer",M.gauge="gauge",M.treemap="treemap",M.sunburst="sunburst",M.circlePacking="circlePacking",M.waterfall="waterfall",M.heatmap="heatmap",M.correlation="correlation",M.liquid="liquid",M.venn="venn",M.mosaic="mosaic",M.pictogram="pictogram",(T=$||($={})).label="label",T.point="point",T.line="line",T.area="area",T.bar="bar",T.boxPlot="boxPlot",T.outlier="outlier",T.circlePacking="circlePacking",T.group="group",T.gridBackground="gridBackground",T.grid="grid",T.dot="dot",T.title="title",T.subTitle="subTitle",T.symbol="symbol",T.funnel="funnel",T.transform="transform",T.transformLabel="transformLabel",T.outerLabel="outerLabel",T.outerLabelLine="outerLabelLine",T.pin="pin",T.pinBackground="pinBackground",T.pointer="pointer",T.segment="segment",T.track="track",T.cell="cell",T.cellBackground="cellBackground",T.link="link",T.arrow="arrow",T.pie="pie",T.labelLine="labelLine",T.progress="progress",T.minLabel="minLabel",T.maxLabel="maxLabel",T.rose="rose",T.node="node",T.sunburst="sunburst",T.nonLeaf="nonLeaf",T.leaf="leaf",T.nonLeafLabel="nonLeafLabel",T.leaderLine="leaderLine",T.stackLabel="stackLabel",T.word="word",T.fillingWord="fillingWord",T.wordMask="wordMask",T.nodePoint="nodePoint",T.ripplePoint="ripplePoint",T.centerPoint="centerPoint",T.centerLabel="centerLabel",T.barBackground="barBackground",T.lineLabel="lineLabel",T.areaLabel="areaLabel",T.liquidGroup="liquidGroup",T.liquid="liquid",T.liquidBackground="liquidBackground",T.liquidOutline="liquidOutline",T.circle="circle",T.overlap="overlap",T.overlapLabel="overlapLabel";let hK={primaryFontColor:"titleFontColor",tertiaryFontColor:"labelFontColor",axisLabelFontColor:"axisFontColor",axisMarkerFontColor:"labelReverseFontColor",dataZoomHandleStrokeColor:"dataZoomHandlerStrokeColor",sliderHandleColor:"dataZoomHandlerFillColor",sliderRailColor:"dataZoomBackgroundColor",sliderTrackColor:"dataZoomSelectedColor",playerControllerColor:"dataZoomSelectedColor",popupBackgroundColor:"tooltipBackgroundColor",hoverBackgroundColor:"axisGridColor"},hX={titleFontColor:"primaryFontColor",labelFontColor:"tertiaryFontColor",axisFontColor:"axisLabelFontColor",labelReverseFontColor:"axisMarkerFontColor",dataZoomHandlerStrokeColor:"dataZoomHandleStrokeColor",dataZoomHandlerFillColor:"sliderHandleColor",dataZoomBackgroundColor:"sliderRailColor",dataZoomSelectedColor:"sliderTrackColor",tooltipBackgroundColor:"popupBackgroundColor"};function hY(t,e){if(!t)return[];let i=h2(t,e);if(!i||(0,rD.Z)(i))return null!=i?i:[];if((0,nF.Z)(i)){let{dataScheme:r}=i;return r?h0(r)?r.map(i=>Object.assign(Object.assign({},i),{scheme:i.scheme.map(i=>hQ(i)?hq(t,i,e):i).filter(aw.Z)})):r.map(i=>hQ(i)?hq(t,i,e):i).filter(aw.Z):[]}return[]}function h$(t,e){var i,r;return h0(t)?null!=(r=null==(i=t.find(t=>(0,aw.Z)(t.isAvailable)?(0,nz.Z)(t.isAvailable)?t.isAvailable(e):!!t.isAvailable:!(0,aw.Z)(t.maxDomainLength)||(null==e?void 0:e.length)<=t.maxDomainLength))?void 0:i.scheme)?r:t[t.length-1].scheme:t}function hq(t,e,i){var r;let n,l=h2(t,i);if(!l)return;let{palette:s}=l;if((0,nF.Z)(s)&&(n=null!=(r=function(t,e){let i=hK[e];if(i&&t[i])return t[i];if(t[e])return t[e];let r=hX[e];return r?t[r]:void 0}(s,e.key))?r:e.default),!n)return;if((0,nB.Z)(e.a)&&(0,nB.Z)(e.l)||!(0,nI.Z)(n))return n;let a=new hj.Il(n);if((0,aw.Z)(e.l)){let{r:t,g:i,b:r}=a.color,{h:n,s:l}=(0,hG.Z)(t,i,r),s=(0,hV.Z)(n,l,e.l),o=new hj.Il(`rgb(${s.r}, ${s.g}, ${s.b})`);o.setOpacity(a.color.opacity),a=o}return(0,aw.Z)(e.a)&&a.setOpacity(e.a),a.toRGBA()}let hJ=(t,e)=>{if(e&&hQ(t)){let i=hq(e,t);if(i)return i}return t};function hQ(t){return t&&"palette"===t.type&&!!t.key}function h0(t){return!(!(0,rD.Z)(t)||0===t.length)&&t.every(t=>(0,aw.Z)(t.scheme))}function h1(t){return(0,rD.Z)(t)?{dataScheme:t}:t}function h2(t,e){var i,r;let n,{type:l}=null!=e?e:{};if(!e||(0,nB.Z)(l))n=null==t?void 0:t.default;else{let s=hU(e);n=null!=(r=null!=(i=null==t?void 0:t[`${l}_${s}`])?i:null==t?void 0:t[l])?r:null==t?void 0:t.default}return n}var h3=i(20408);function h5(t,...e){let i=-1,r=e.length;for(;++i<r;){let r=e[i];(0,h3.p)(t,r,!0,!0)}return t}var h4=i(52536),h6=i(33141),h7=i(7187),h8=i(17721);class h9{static registerChart(t,e){h9._charts[t]=e}static registerSeries(t,e){h9._series[t]=e}static registerComponent(t,e,i,r){h9._components[t]={cmp:e,alwaysCheck:i,createOrder:null!=r?r:0}}static registerGraphicComponent(t,e){h9._graphicComponents[t]=e}static createGraphicComponent(t,e,i){let r=h9._graphicComponents[t];return r?r(e,i):null}static registerMark(t,e){h9._marks[t]=e}static registerRegion(t,e){h9._regions[t]=e}static registerTransform(t,e){h9.transforms[t]=e}static registerGrammarTransform(t,e){h9._grammarTransforms[t]=e}static getGrammarTransform(t){return h9._grammarTransforms[t]}static registerLayout(t,e){h9._layout[t]=e}static registerAnimation(t,e){h9._animations[t]=e}static registerImplement(t,e){h9._implements[t]=e}static registerChartPlugin(t,e){h9._chartPlugin[t]=e}static registerVChartPlugin(t,e){h9._vChartPlugin[t]=e}static registerComponentPlugin(t,e){h9._componentPlugin[t]=e}static createChart(t,e,i){return h9._charts[t]?new(0,h9._charts[t])(e,i):null}static getChart(t){return h9._charts[t]}static createChartSpecTransformer(t,e){if(!h9._charts[t])return null;let i=h9._charts[t];return new(0,i.transformerConstructor)(Object.assign({seriesType:i.seriesType},e))}static createRegion(t,e,i){return h9._regions[t]?new(0,h9._regions[t])(e,i):null}static createRegionSpecTransformer(t,e){return h9._regions[t]?new(0,h9._regions[t].transformerConstructor)(e):null}static createSeries(t,e,i){return h9._series[t]?new(0,h9._series[t])(e,i):null}static createSeriesSpecTransformer(t,e){return h9._series[t]?new(0,h9._series[t].transformerConstructor)(e):null}static createMark(t,e,i){if(!h9._marks[t])return null;let r=new(0,h9._marks[t])(e,i);return"group"===r.type&&r.setMarkConfig({interactive:!1}),r}static getComponents(){return Object.values(h9._components)}static getComponentInKey(t){return h9._components[t].cmp}static getLayout(){return Object.values(h9._layout)}static getLayoutInKey(t){return h9._layout[t]}static getSeries(){return Object.values(h9._series)}static getSeriesInType(t){return h9._series[t]}static getRegionInType(t){return h9._regions[t]}static getAnimationInKey(t){return h9._animations[t]}static getImplementInKey(t){return h9._implements[t]}static getSeriesMarkMap(t){return h9._series[t]?h9._series[t].mark:{}}static getSeriesBuiltInTheme(t){for(let e in h9._series){let i=h9._series[e];if(i&&i.builtInTheme&&i.builtInTheme[t])return i.builtInTheme[t]}return null}static getComponentBuiltInTheme(t){for(let e in h9._components){let i=h9._components[e];if(i&&i.cmp&&i.cmp.builtInTheme&&i.cmp.builtInTheme[t])return i.cmp.builtInTheme[t]}return null}static getChartPlugins(){return Object.values(h9._chartPlugin)}static getVChartPlugins(){return Object.values(h9._vChartPlugin)}static getComponentPlugins(){return Object.values(h9._componentPlugin)}static getComponentPluginInType(t){return h9._componentPlugin[t]}static registerFormatter(t){this._formatter=t}static getFormatter(){return this._formatter}static createInteractionTrigger(t,e){let i=h9._interactionTriggers[t];return i?new i(e):null}static hasInteractionTrigger(t){return!!h9._interactionTriggers[t]}static getComposedEvent(t){return h9._composedEventMap[t]}}function dt(t,...e){return h5(de(t),...e.map(de))}function de(t){var e,i;if(!t)return t;let r=((i=t.colorScheme)&&(i=Object.keys(i).reduce((t,e)=>{let r=i[e];return t[e]=h1(r),t},{})),i);return Object.assign({},t,{colorScheme:r,token:null!=(e=t.token)?e:{},series:Object.assign({},t.series)})}h9._charts={},h9._series={},h9._components={},h9._graphicComponents={},h9._marks={},h9._regions={},h9._animations={},h9._implements={},h9._chartPlugin={},h9._vChartPlugin={},h9._componentPlugin={},h9.transforms={fields:h4.X,filter:h6.h,fold:h7.g},h9.dataParser={csv:h8.UI,dsv:h8.$W,tsv:h8.mK},h9._layout={},h9._grammarTransforms={},h9._stageEventPlugins={},h9.registerStageEventPlugin=(t,e)=>{h9._stageEventPlugins[t]=e},h9.getStageEventPlugin=t=>h9._stageEventPlugins[t],h9._interactionTriggers={},h9.registerInteractionTrigger=(t,e)=>{h9._interactionTriggers[t]=e},h9._composedEventMap={},h9.registerComposedEvent=(t,e)=>{h9._composedEventMap[t]=e},h9._tooltipProcessors={},h9.registerTooltipProcessor=(t,e)=>{h9._tooltipProcessors[t]=e},h9.createTooltipProcessor=(t,e)=>{let i=h9._tooltipProcessors[t];return i?new i(e):null};let di=t=>{let e={label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"}},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle"}}};return e[t?"transform3d":"transform"]={style:{fill:{type:"palette",key:"axisGridColor"}}},e},dr=di(),dn={[hZ.name]:hZ},dl=hZ.name,ds=new Map(Object.keys(dn).map(t=>[t,dn[t]])),da=new Map,dh=new Map(Object.keys(dn).map(t=>[t,t===dl])),dd=(t,e)=>{if(!t)return;let i=dg(e);ds.set(t,i),dh.set(t,!0)},du=(t=dl)=>(dh.has(t)&&!dh.get(t)&&dd(t,ds.get(t)),ds.get(t)),dc=t=>ds.delete(t)&&da.delete(t)&&dh.delete(t),dp=t=>!!(0,nI.Z)(t)&&ds.has(t),dg=t=>{var e;return dt({},du(null!=(e=t.type)?e:dl),t)};class df{static registerInstance(t){df.instances.set(t.id,t)}static unregisterInstance(t){df.instances.delete(t.id)}static getInstance(t){return df.instances.get(t)}static instanceExist(t){return df.instances.has(t)}static forEach(t,e=[],i){let r=(0,a1.IX)(e);return df.instances.forEach((e,i,n)=>{r.includes(i)||t(e,i,n)},i)}}df.instances=new Map;class dm{static registerTheme(t,e){dd(t,e)}static getTheme(t,e=!1){return du(t)}static removeTheme(t){return dc(t)}static themeExist(t){return dp(t)}static getDefaultTheme(){return dm.themes.get(dl)}static setCurrentTheme(t){dm.themeExist(t)&&(dm._currentThemeName=t,df.forEach(e=>null==e?void 0:e.setCurrentTheme(t)))}static getCurrentTheme(t=!1){return dm.getTheme(dm._currentThemeName,t)}static getCurrentThemeName(){return dm._currentThemeName}}function dy(t){return(0,nI.Z)(t)?dm.themeExist(t)?dm.getTheme(t):{}:(0,nF.Z)(t)?t:{}}dm.themes=ds,dm._currentThemeName=dl;class dv{getComposedEventMap(){return this._composedEventMap}constructor(t,e){this._composedEventMap=new Map,this._eventDispatcher=t,this._mode=e}on(t,e,i){let r="function"==typeof e?{query:null,callback:e}:{query:e,callback:i},n=h9.getComposedEvent(t);if(n){let e=new n(this._eventDispatcher,this._mode);e.register(t,r),this._composedEventMap.set(r.callback,{eventType:t,event:e})}else this._eventDispatcher.register(t,r);return this}off(t,e,i){var r,n;let l=null!=i?i:e;if(h9.getComposedEvent(t))if(l)null==(r=this._composedEventMap.get(l))||r.event.unregister(),this._composedEventMap.delete(l);else for(let e of this._composedEventMap.entries())e[1].eventType===t&&(null==(n=this._composedEventMap.get(e[0]))||n.event.unregister(),this._composedEventMap.delete(e[0]));else if(l){let i={callback:l,query:null,filter:{nodeName:null,type:t,level:null,source:e.source,markName:null,filter:null,userId:null}};this._eventDispatcher.unregister(t,i)}else this._eventDispatcher.unregister(t);return this}emit(t,e,i){return this._eventDispatcher.dispatch(t,e,i),this}prevent(t,e){return this._eventDispatcher.prevent(t,e),this}allow(t){return this._eventDispatcher.allow(t),this}release(){this._eventDispatcher.clear(),this._composedEventMap.clear()}}(k=q||(q={})).BEFORE_EVALUATE_DATA="beforeEvaluateData",k.AFTER_EVALUATE_DATA="afterEvaluateData",k.BEFORE_EVALUATE_SCALE="beforeEvaluateScale",k.AFTER_EVALUATE_SCALE="afterEvaluateScale",k.BEFORE_PARSE_VIEW="beforeParseView",k.AFTER_PARSE_VIEW="afterParseView",k.BEFORE_TRANSFORM="beforeTransform",k.AFTER_TRANSFORM="afterTransform",k.BEFORE_CREATE_VRENDER_STAGE="beforeCreateVRenderStage",k.AFTER_CREATE_VRENDER_STAGE="afterCreateVRenderStage",k.BEFORE_CREATE_VRENDER_LAYER="beforeCreateVRenderLayer",k.AFTER_CREATE_VRENDER_LAYER="afterCreateVRenderLayer",k.BEFORE_STAGE_RESIZE="beforeStageResize",k.AFTER_STAGE_RESIZE="afterStageResize",k.BEFORE_VRENDER_DRAW="beforeVRenderDraw",k.AFTER_VRENDER_DRAW="afterVRenderDraw",k.BEFORE_MARK_JOIN="beforeMarkJoin",k.AFTER_MARK_JOIN="afterMarkJoin",k.BEFORE_MARK_UPDATE="beforeMarkUpdate",k.AFTER_MARK_UPDATE="afterMarkUpdate",k.BEFORE_MARK_STATE="beforeMarkState",k.AFTER_MARK_STATE="afterMarkState",k.BEFORE_MARK_ENCODE="beforeMarkEncode",k.AFTER_MARK_ENCODE="afterMarkEncode",k.BEFORE_DO_LAYOUT="beforeDoLayout",k.AFTER_DO_LAYOUT="afterDoLayout",k.BEFORE_MARK_LAYOUT_END="beforeMarkLayoutEnd",k.AFTER_MARK_LAYOUT_END="afterMarkLayoutEnd",k.BEFORE_DO_RENDER="beforeDoRender",k.AFTER_DO_RENDER="afterDoRender",k.BEFORE_MARK_RENDER_END="beforeMarkRenderEnd",k.AFTER_MARK_RENDER_END="afterMarkRenderEnd",k.BEFORE_CREATE_VRENDER_MARK="beforeCreateVRenderMark",k.AFTER_CREATE_VRENDER_MARK="afterCreateVRenderMark",k.BEFORE_ADD_VRENDER_MARK="beforeAddVRenderMark",k.AFTER_ADD_VRENDER_MARK="afterAddVRenderMark",k.AFTER_VRENDER_NEXT_RENDER="afterVRenderNextRender",k.BEFORE_ELEMENT_UPDATE_DATA="beforeElementUpdateData",k.AFTER_ELEMENT_UPDATE_DATA="afterElementUpdateData",k.BEFORE_ELEMENT_STATE="beforeElementState",k.AFTER_ELEMENT_STATE="afterElementState",k.BEFORE_ELEMENT_ENCODE="beforeElementEncode",k.AFTER_ELEMENT_ENCODE="afterElementEncode",k.ANIMATION_START="animationStart",k.ANIMATION_END="animationEnd",k.ELEMENT_ANIMATION_START="elementAnimationStart",k.ELEMENT_ANIMATION_END="elementAnimationEnd",k.ALL_ANIMATION_START="allAnimationStart",k.ALL_ANIMATION_END="allAnimationEnd";let db=["pointerdown","pointerup","pointerupoutside","pointertap","pointerover","pointermove","pointerenter","pointerleave","pointerout","mousedown","mouseup","mouseupoutside","rightdown","rightup","rightupoutside","click","dblclick","mousemove","mouseover","mouseout","mouseenter","mouseleave","wheel","touchstart","touchend","touchendoutside","touchmove","touchcancel","tap","dragstart","drag","dragenter","dragleave","dragover","dragend","drop","pan","panstart","panend","press","pressup","pressend","pinch","pinchstart","pinchend","swipe"];(R=J||(J={})).initialized="initialized",R.rendered="rendered",R.renderFinished="renderFinished",R.animationFinished="animationFinished",R.regionSeriesDataFilterOver="regionSeriesDataFilterOver",R.afterInitData="afterInitData",R.afterInitEvent="afterInitEvent",R.afterInitMark="afterInitMark",R.rawDataUpdate="rawDataUpdate",R.viewDataFilterOver="viewDataFilterOver",R.viewDataUpdate="viewDataUpdate",R.viewDataStatisticsUpdate="viewDataStatisticsUpdate",R.markDeltaYUpdate="markDeltaYUpdate",R.viewDataLabelUpdate="viewDataLabelUpdate",R.scaleDomainUpdate="scaleDomainUpdate",R.scaleRawDomainUpdate="scaleRawDomainUpdate",R.scaleUpdate="scaleUpdate",R.dataZoomChange="dataZoomChange",R.drill="drill",R.layoutStart="layoutStart",R.layoutEnd="layoutEnd",R.layoutRectUpdate="layoutRectUpdate",R.playerPlay="playerPlay",R.playerPause="playerPause",R.playerEnd="playerEnd",R.playerChange="playerChange",R.playerForward="playerForward",R.playerBackward="playerBackward",R.scrollBarChange="scrollBarChange",R.brushStart="brushStart",R.brushChange="brushChange",R.brushEnd="brushEnd",R.brushClear="brushClear",R.brushActive="brushActive",R.legendSelectedDataChange="legendSelectedDataChange",R.legendFilter="legendFilter",R.legendItemClick="legendItemClick",R.legendItemHover="legendItemHover",R.legendItemUnHover="legendItemUnHover",R.tooltipShow="tooltipShow",R.tooltipHide="tooltipHide",R.tooltipRelease="tooltipRelease",R.afterResize="afterResize",R.afterRender="afterRender",R.afterLayout="afterLayout",R.afterMarkLayoutEnd="afterMarkLayoutEnd",R.afterWordcloudShapeDraw="afterWordcloudShapeDraw",(P=Q||(Q={})).chart="chart",P.window="window",P.canvas="canvas",(B=te||(te={})).vchart="vchart",B.chart="chart",B.model="model",B.mark="mark";let d_=[te.mark,te.model,te.chart,te.vchart];class dC{constructor(){this._map=new Map,this._levelNodes=new Map,this._levelNodes.set(te.vchart,[]),this._levelNodes.set(te.chart,[]),this._levelNodes.set(te.model,[]),this._levelNodes.set(te.mark,[])}addHandler(t,e){var i;let r={level:e,handler:t};return null==(i=this._levelNodes.get(e))||i.push(r),this._map.set(t.callback,r),this}removeHandler(t){let e=this._map.get(t.callback);if(!e)return this;this._map.delete(t.callback);let i=this._levelNodes.get(e.level),r=null==i?void 0:i.findIndex(e=>e.handler.callback===t.callback);return void 0!==r&&r>=0&&(null==i||i.splice(r,1)),this}preventHandler(t){return t&&(t.prevented=!0),this}allowHandler(t){return t&&(t.prevented=!1),this}getHandlers(t){var e;return(null==(e=this._levelNodes.get(t))?void 0:e.map(t=>t.handler))||[]}getAllHandlers(){return Array.from(this._map.values()).map(t=>t.handler)||[]}getCount(){return this._map.size}release(){this._map.clear(),this._levelNodes.clear()}}var dx=i(25397),dw=i(49275),dS=i(80204);let dA=t=>"line"===t||"area"===t,dM=t=>{if(!t||!t.context)return null;let{data:e,markType:i}=t.context;return"line"===i||"area"===i?e:null==e?void 0:e[0]},dT=(t,e)=>{let i=e;for(;(null==i?void 0:i.parent)&&i.parent!==t;)if((i=i.parent).context)return i;return null},dk=(t,e)=>{let i=t.getAttributes(!0),r={};return Object.keys(e).forEach(t=>{i[t]!==e[t]&&(r[t]=e[t])}),r},dR={cartesianAxis:"axis","cartesianAxis-band":"axis","cartesianAxis-linear":"axis","cartesianAxis-time":"axis",polarAxis:"axis","polarAxis-band":"axis","polarAxis-linear":"axis",discreteLegend:"legend",continuousLegend:"legend",colorLegend:"legend",sizeLegend:"legend"};class dP{constructor(t,e){this._viewBubbles=new Map,this._windowBubbles=new Map,this._canvasBubbles=new Map,this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this._onDelegate=t=>{var e;let i=this.globalInstance.getChart(),r=(0,aw.Z)(t.modelId)&&(null==i?void 0:i.getModelById(t.modelId))||void 0,n=(0,aw.Z)(t.markId)&&(null==i?void 0:i.getMarkById(t.markId))||null,l=(0,dx.Z)(t.event,"target"),s=t.datum;r&&"component"===r.modelType&&(s=null!=(e=r.getDatum(l))?e:s);let a={event:t.event,item:t.item,source:t.source,datum:s,chart:i,model:r,mark:null!=n?n:void 0,node:l};this.dispatch(t.type,a)},this._onDelegateInteractionEvent=t=>{let e=this.globalInstance.getChart(),i=t.event,r=null;i.graphics&&(r=i.graphics);let n={event:t.event,chart:e,graphics:r,datums:r&&r.map(t=>dM(t))};this.dispatch(t.type,n)},this.globalInstance=t,this._compiler=e}register(t,e){var i,r,n,l,s;this._parseQuery(e);let a=this.getEventBubble((null==(i=e.filter)?void 0:i.source)||Q.chart),o=this.getEventListeners((null==(r=e.filter)?void 0:r.source)||Q.chart);if(a.get(t)||a.set(t,new dC),a.get(t).addHandler(e,null==(n=e.filter)?void 0:n.level),this._isValidEvent(t)&&!o.has(t)){let i=this._onDelegate.bind(this);this._compiler.addEventListener(null==(l=e.filter)?void 0:l.source,t,i),o.set(t,i)}else if(this._isInteractionEvent(t)&&!o.has(t)){let i=this._onDelegateInteractionEvent.bind(this);this._compiler.addEventListener(null==(s=e.filter)?void 0:s.source,t,i),o.set(t,i)}return this}unregister(t,e){var i,r,n,l;let s=!1,a=this.getEventBubble((null==(i=null==e?void 0:e.filter)?void 0:i.source)||Q.chart),o=this.getEventListeners((null==(r=null==e?void 0:e.filter)?void 0:r.source)||Q.chart);if(e){let i=a.get(t);null==i||i.removeHandler(e),0===(null==i?void 0:i.getCount())&&(null==i||i.release(),a.delete(t),s=!0),(null==(n=null==e?void 0:e.wrappedCallback)?void 0:n.cancel)&&e.wrappedCallback.cancel()}else{let e=a.get(t);null==e||e.release(),a.delete(t),s=!0}if(s&&this._isValidEvent(t)){let i=o.get(t);this._compiler.removeEventListener((null==(l=null==e?void 0:e.filter)?void 0:l.source)||Q.chart,t,i),o.delete(t)}return this}dispatch(t,e,i){let r=this.getEventBubble(e.source||Q.chart).get(t);if(!r)return this;let n=!1;if(i){let l=r.getHandlers(i);n=this._invoke(l,t,e)}else{let i=0;for(;!n&&i<d_.length;)n=this._invoke(r.getHandlers(d_[i]),t,e),i++}return this}prevent(t,e){return["canvas","chart","window"].forEach(i=>{let r=this.getEventBubble(i).get(t);r&&r.getAllHandlers().forEach(t=>{e?d_.indexOf(t.filter.level)<d_.indexOf(e.level)&&t.callback!==e.handler&&r.preventHandler(t):r.preventHandler(t)})}),this}allow(t){return["canvas","chart","window"].forEach(e=>{let i=this.getEventBubble(e).get(t);i&&i.getAllHandlers().forEach(t=>i.allowHandler(t))}),this}clear(){[Q.chart,Q.window,Q.canvas].forEach(t=>{let e=this.getEventListeners(t);for(let i of e.entries())this._compiler.removeEventListener(t,i[0],i[1]);e.clear()}),[this._viewBubbles,this._windowBubbles,this._canvasBubbles].forEach(t=>{for(let e of t.values())e.release();t.clear()})}release(){this.clear(),this.globalInstance=null,this._compiler=null}_filter(t,e,i){var r,n,l;if((0,nz.Z)(t.filter)&&!t.filter(i)||t.nodeName&&(0,dx.Z)(i,"node.name")!==t.nodeName||t.markName&&(null==(r=null==i?void 0:i.mark)?void 0:r.name)!==t.markName)return!1;let s=null==(n=i.model)?void 0:n.type;return dR[s]&&(s=dR[s]),(!t.type||s===t.type)&&!("mark"===t.level&&!t.type&&!(null==i?void 0:i.mark))&&!("model"===t.level&&!t.type&&!(null==i?void 0:i.model))&&(!(0,aw.Z)(t.userId)||(null==(l=i.model)?void 0:l.userId)===t.userId)}_invoke(t,e,i){return t.map(t=>{var r,n,l;let s=t.filter;if(!t.prevented&&(!t.query||this._filter(s,e,i))){let e=(t.wrappedCallback||t.callback).call(null,Object.assign({},i)),s=null!=e?e:null==(r=t.query)?void 0:r.consume;return s&&(null==(n=i.event)||n.stopPropagation(),null==(l=i.event)||l.preventDefault()),!!s}}).some(t=>!0===t)}_getQueryLevel(t){return t?t.level?t.level:(0,aw.Z)(t.id)?te.model:te.vchart:te.vchart}_parseQuery(t){var e;let i=t.query;(null==i?void 0:i.throttle)?t.wrappedCallback=(0,dw.Z)(t.callback,i.throttle):(null==i?void 0:i.debounce)&&(t.wrappedCallback=(0,dS.Z)(t.callback,i.debounce));let r=this._getQueryLevel(i),n=null,l=Q.chart,s=null,a=null,o=null;return(null==i?void 0:i.nodeName)&&(s=i.nodeName),(null==i?void 0:i.markName)&&(a=i.markName),(null==i?void 0:i.type)&&(r===te.model||r===te.mark)&&(n=i.type),(null==i?void 0:i.source)&&(l=i.source),(0,aw.Z)(null==i?void 0:i.id)&&(o=null==i?void 0:i.id,r=te.model),t.filter={level:r,markName:a,type:n,source:l,nodeName:s,userId:o,filter:null!=(e=null==i?void 0:i.filter)?e:null},t}getEventBubble(t){switch(t){case Q.chart:return this._viewBubbles;case Q.window:return this._windowBubbles;case Q.canvas:return this._canvasBubbles;default:return this._viewBubbles}}getEventListeners(t){switch(t){case Q.chart:return this._viewListeners;case Q.window:return this._windowListeners;case Q.canvas:return this._canvasListeners;default:return this._viewListeners}}_isValidEvent(t){return db.includes(t)||Object.values(q).includes(t)}_isInteractionEvent(t){let e;return t&&(e=t.split(":")[0])&&h9.hasInteractionTrigger(e)}}var dB=i(58809),dI=i(26665),dE=i(49527);function dL(t,e,i){t.getTransform(e)||t.registerTransform(e,i)}function dF(t,e,i){t.getParser(e)||t.registerParser(e,i)}let dO=new Map;function dH(t,e,i={type:"geojson",centroid:!0}){dO.has(t)&&hO(`map type of '${t}' already exists, will be overwritten.`),h||(dF(h=new eY.q,"geojson",dB.bL),dF(h,"topojson",dI.Q),dL(h,"simplify",dE.o));let r=new eq.V(h),n=(0,h3.Z)({},{centroid:!0,simplify:!1},i);"topojson"===i.type?r.parse(e,{type:"topojson",options:n}):r.parse(e,{type:"geojson",options:n});let{simplify:l}=i;!0===l?r.transform({type:"simplify"}):(0,nF.Z)(l)&&r.transform({type:"simplify",options:l}),dO.set(t,r)}function dD(t){dO.has(t)?dO.delete(t):hO(`map type of '${t}' does not exists.`)}var dz=i(65755);function dW(t,e=!1){let i=e;return t.latestData instanceof eq.V&&(i=!1),i?(0,dz.Z)(t.latestData):t.latestData&&t.latestData.slice()}let dZ=(t,e)=>0===t.length?[]:1===t.length?dW(t[0],null==e?void 0:e.deep):t.map(t=>dW(t,null==e?void 0:e.deep));function dN(t,e,i){dL(e=e instanceof eY.q?e:t.dataSet,"copyDataView",dZ);let r=new eq.V(e,i);return r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView",level:ti.copyDataView}),r}function dj(t,e,i=[]){let r;if(t instanceof eq.V)return t;let{id:n,values:l=[],fromDataIndex:s,fromDataId:a,transforms:o=[]}=t,h=t.parser?(0,dz.Z)(t.parser):{clone:!0},d=(0,dz.Z)(t.fields);h.clone=!1!==h.clone;let u=i.find(t=>t.name===n);if(u)r=u;else{let t={name:n};if(d&&(t.fields=d),r=new eq.V(e,t),"string"==typeof a){let t=i.find(t=>t.name===a);if(!t)return hO(`no data matches fromDataId ${a}`),null;r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView"})}else if("number"==typeof s){let t=i[s];if(!t)return hO(`no data matches fromDataIndex ${s}`),null;r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView"})}else Array.isArray(l)?r.parse(l,h):(0,nI.Z)(l)&&(!h||["csv","dsv","tsv"].includes(h.type))?r.parse(l,null!=h?h:{type:"csv"}):(r.parse([]),hO("values should be array"));o&&o.length&&o.forEach(t=>{e.getTransform(t.type)&&r.transform(t)})}return r}function dG(t,e,i){t&&(e.fields&&t.setFields(e.fields,i),t.parseNewData(e.values,e.parser))}(I=ti||(ti={}))[I.copyDataView=-10]="copyDataView",I[I.treemapFilter=-8]="treemapFilter",I[I.treemapFlatten=-7]="treemapFlatten",I[I.dotObjFlat=-7]="dotObjFlat",I[I.linkDotInfo=-7]="linkDotInfo",I[I.sankeyLayout=-7]="sankeyLayout",I[I.dataZoomFilter=-6]="dataZoomFilter",I[I.legendFilter=-5]="legendFilter",(E=tr||(tr={})).appear="appear",E.disappear="disappear",E.enter="enter",E.update="update",E.state="state",E.exit="exit",E.normal="normal",E.none="none",(L=tn||(tn={})).before="before",L.layouting="layouting",L.reevaluate="reevaluate",L.after="after";var dV=i(36123),dU=i(56073);class dK extends nZ{constructor(){super(...arguments),this.client={x:0,y:0},this.movement={x:0,y:0},this.offset={x:0,y:0},this.global={x:0,y:0},this.screen={x:0,y:0}}get clientX(){return this.client.x}get clientY(){return this.client.y}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,r,n,l,s,a,o,h,d,u,c,p,g){throw Error("Method not implemented.")}}class dX extends dK{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw Error("getPredictedEvents is not supported!")}clone(){var t,e,i;let r=new dX(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null==(t=this.manager)||t.copyPointerData(this,r),null==(e=this.manager)||e.copyMouseData(this,r),null==(i=this.manager)||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();let n=this.composedDetailPath();return r.detailPath=n&&n.slice(),r.type=this.type,r}}class dY extends dK{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}clone(){var t,e,i;let r=new dY(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null==(t=this.manager)||t.copyWheelData(this,r),null==(e=this.manager)||e.copyMouseData(this,r),null==(i=this.manager)||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();let n=this.composedDetailPath();return r.detailPath=n&&n.slice(),r.type=this.type,r}}dY.DOM_DELTA_PIXEL=0,dY.DOM_DELTA_LINE=1,dY.DOM_DELTA_PAGE=2;let d$="object"==typeof performance&&performance.now?performance:Date;function dq(t){return"mouse"===t||"pen"===t}class dJ{constructor(t,e){this.dispatch=new(nH()),this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=(t,e)=>{if(!(t instanceof dX))return void iR.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.createPointerEvent(t,t.type,e);if(this.dispatchEvent(i,"pointerdown"),"touch"===i.pointerType)this.dispatchEvent(i,"touchstart");else if(dq(i.pointerType)){let t=2===i.button;this.dispatchEvent(i,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=i.composedPath(),this.freeEvent(i)},this.onPointerMove=(t,e)=>{var i,r;if(!(t instanceof dX))return void iR.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let n=this.createPointerEvent(t,t.type,e),l=dq(n.pointerType),s=this.trackingData(t.pointerId),a=this.findMountedTarget(s.overTargets);if(s.overTargets&&a&&a!==this.rootTarget&&a!==n.target){let e="mousemove"===t.type?"mouseout":"pointerout",i=this.createPointerEvent(t,e,a||void 0);if(this.dispatchEvent(i,"pointerout"),l&&this.dispatchEvent(i,"mouseout"),!n.composedPath().includes(a)){let e=this.createPointerEvent(t,"pointerleave",a||void 0);for(e.eventPhase=e.AT_TARGET;e.target&&!n.composedPath().includes(e.target);)e.currentTarget=e.target,this.notifyTarget(e),l&&this.notifyTarget(e,"mouseleave"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(i)}if(a!==n.target){let e="mousemove"===t.type?"mouseover":"pointerover",i=this.clonePointerEvent(n,e);this.dispatchEvent(i,"pointerover"),l&&this.dispatchEvent(i,"mouseover");let r=null==a?void 0:a.parent;for(;r&&r!==this.rootTarget.parent&&r!==n.target;)r=r.parent;if(!r||r===this.rootTarget.parent){let t=this.clonePointerEvent(n,"pointerenter");t.eventPhase=t.AT_TARGET;let e=t.target,i=new Set,r=a;for(;r&&r!==this.rootTarget;)i.add(r),r=r.parent;for(;e&&e!==a&&e!==this.rootTarget.parent;)i.has(e)||(t.currentTarget=e,this.notifyTarget(t),l&&this.notifyTarget(t,"mouseenter")),e=e.parent;this.freeEvent(t)}this.freeEvent(i)}this.dispatchEvent(n,"pointermove"),"touch"===n.pointerType&&this.dispatchEvent(n,"touchmove"),l&&(this.dispatchEvent(n,"mousemove"),this.cursorTarget=n.target,this.cursor=(null==(r=null==(i=n.target)?void 0:i.attribute)?void 0:r.cursor)||this.rootTarget.getCursor()),s.overTargets=n.composedPath(),this.freeEvent(n)},this.onPointerOver=(t,e)=>{var i,r;if(!(t instanceof dX))return void iR.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let n=this.trackingData(t.pointerId),l=this.createPointerEvent(t,t.type,e),s=dq(l.pointerType);this.dispatchEvent(l,"pointerover"),s&&this.dispatchEvent(l,"mouseover"),"mouse"===l.pointerType&&(this.cursorTarget=l.target,this.cursor=(null==(r=null==(i=l.target)?void 0:i.attribute)?void 0:r.cursor)||this.rootTarget.getCursor());let a=this.clonePointerEvent(l,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),s&&this.notifyTarget(a,"mouseenter"),a.target=a.target.parent;n.overTargets=l.composedPath(),this.freeEvent(l),this.freeEvent(a)},this.onPointerOut=(t,e)=>{if(!(t instanceof dX))return void iR.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.trackingData(t.pointerId);if(i.overTargets){let e=dq(t.pointerType),r=this.findMountedTarget(i.overTargets),n=this.createPointerEvent(t,"pointerout",r||void 0);this.dispatchEvent(n),e&&this.dispatchEvent(n,"mouseout");let l=this.createPointerEvent(t,"pointerleave",r||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==this.rootTarget.parent;)l.currentTarget=l.target,this.notifyTarget(l),e&&this.notifyTarget(l,"mouseleave"),l.target=l.target.parent;i.overTargets=[],this.freeEvent(n),this.freeEvent(l)}this.cursorTarget=null,this.cursor=""},this.onPointerUp=(t,e)=>{var i;if(!(t instanceof dX))return void iR.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let r=d$.now(),n=this.createPointerEvent(t,t.type,e);if(this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)this.dispatchEvent(n,"touchend");else if(dq(n.pointerType)){let t=2===n.button;this.dispatchEvent(n,t?"rightup":"mouseup")}let l=this.trackingData(t.pointerId),s=this.findMountedTarget(l.pressTargetsByButton[t.button]),a=s;if(s&&!n.composedPath().includes(s)){let e=s;for(;e&&!n.composedPath().includes(e);){if(n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)this.notifyTarget(n,"touchendoutside");else if(dq(n.pointerType)){let t=2===n.button;this.notifyTarget(n,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete l.pressTargetsByButton[t.button],a=e}if(a){let e=this.clonePointerEvent(n,"click");e.target=a,e.path=[],e.detailPath=[],l.clicksByButton[t.button]||(l.clicksByButton[t.button]={clickCount:0,target:e.target,timeStamp:r});let s=l.clicksByButton[t.button];s.target===e.target&&r-s.timeStamp<(null!=(i=this._config.clickInterval)?i:200)?++s.clickCount:s.clickCount=1,s.target=e.target,s.timeStamp=r,e.detail=s.clickCount,dq(e.pointerType)?(this.dispatchEvent(e,"click"),2===s.clickCount&&this.dispatchEvent(e,"dblclick")):"touch"===e.pointerType&&this._config.supportsTouchEvents&&(this.dispatchEvent(e,"tap"),2===s.clickCount&&this.dispatchEvent(e,"dbltap")),this.dispatchEvent(e,"pointertap"),this.freeEvent(e)}this.freeEvent(n)},this.onPointerUpOutside=(t,e)=>{if(!(t instanceof dX))return void iR.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.trackingData(t.pointerId),r=this.findMountedTarget(i.pressTargetsByButton[t.button]),n=this.createPointerEvent(t,t.type,e);if(r){let e=r;for(;e;)n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):dq(n.pointerType)&&this.notifyTarget(n,2===n.button?"rightupoutside":"mouseupoutside"),e=e.parent;delete i.pressTargetsByButton[t.button]}this.freeEvent(n)},this.onWheel=(t,e)=>{if(!(t instanceof dY))return void iR.Y.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event");let i=this.createWheelEvent(t,e);this.dispatchEvent(i),this.freeEvent(i)},this.rootTarget=t,this.mappingTable={},this._config=Object.assign({clickInterval:200},e),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((t,e)=>t.priority-e.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){var e,i,r,n,l,s,a;let o;if(!this.rootTarget)return;let h=this.mappingTable[t.type],d=`${t.canvasX}-${t.canvasY}`;if((null==(e=this._prePointTargetCache)?void 0:e[d])&&(null==(r=null==(i=this._prePointTargetCache)?void 0:i[d])?void 0:r.stage)&&(null==(l=null==(n=this._prePointTargetCache)?void 0:n[d])?void 0:l.stage.renderCount)===(null==(s=this._prePointTargetCache)?void 0:s.stageRenderCount)?o=this._prePointTargetCache[d]:(o=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache={[d]:o,stageRenderCount:null!=(a=null==o?void 0:o.stage.renderCount)?a:-1})),h)for(let e=0,i=h.length;e<i;e++)h[e].fn(t,o);else iR.Y.getInstance().warn(`[EventManager]: Event mapping not defined for ${t.type}`)}propagate(t,e){if(!t.target)return;let i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,n=i.length-1;r<n;r++)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}propagationPath(t){let e=[t];for(let i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}notifyTarget(t,e){if(this.pauseNotify)return;e=null!=e?e:t.type;let i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){var r,n;let l=this.allocateEvent(dX);return this.copyPointerData(t,l),this.copyMouseData(t,l),this.copyData(t,l),l.nativeEvent=t.nativeEvent,l.originalEvent=t,l.target=i||this.pickTarget(null!=(r=l.viewX)?r:l.global.x,null!=(n=l.viewY)?n:l.global.y,l),"string"==typeof e&&(l.type=e),l}createWheelEvent(t,e){var i,r;let n=this.allocateEvent(dY);return this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=e||this.pickTarget(null!=(i=n.viewX)?i:n.global.x,null!=(r=n.viewY)?r:n.global.y,n),n}clonePointerEvent(t,e){let i=this.allocateEvent(dX);i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice();let r=t.composedDetailPath();return i.detailPath=r&&r.slice(),i.type=null!=e?e:i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof dX&&e instanceof dX&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof dK&&e instanceof dK&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach(i=>{e[i].x=t[i].x,e[i].y=t[i].y}))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=d$.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);let i=(null==(e=this.eventPool.get(t))?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.detailPath=[],i.target=null,i}freeEvent(t){var e;if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventManager!");let i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),null==(e=this.eventPool.get(i))||e.push(t)}notifyListeners(t,e){let i=t.currentTarget._events[e];if(i)if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(let r=0,n=i.length;r<n&&!t.propagationImmediatelyStopped;r++)i[r].once&&t.currentTarget.removeEventListener(e,i[r].fn,{once:!0}),i[r].fn.call(i[r].context,t);this.emitDelegation(t,e)}emitDelegation(t,e){let i=t.currentTarget._events["*"];if(i)if("fn"in i)i.fn.call(i.context,t,e);else for(let r=0,n=i.length;r<n&&!t.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,t,e)}pickTarget(t,e,i){let r,n=this.rootTarget.pick(t,e);return r=n&&n.graphic?n.graphic:n&&n.group?n.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=n.params),r}release(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}}let dQ={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class d0{constructor(t){this.resolution=1,this.onPointerDown=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(!t.cancelable&&"cancelable"in t||t.preventDefault());for(let t=0,i=e.length;t<i;t++){let i=e[t],r=this.bootstrapEvent(this.rootPointerEvent,i);this.manager.mapEvent(r)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerMove=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType||this.isEventOutsideOfTargetElement(t))return;let e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){let i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.manager.mapEvent(i)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerUp=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.isEventOutsideOfTargetViewPort(t)?"outside":"",i=this.normalizeToPointerData(t);for(let t=0,r=i.length;t<r;t++){let r=this.bootstrapEvent(this.rootPointerEvent,i[t]);r.type+=e,this.manager.mapEvent(r)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerOverOut=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){let i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.manager.mapEvent(i)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onWheel=t=>{let e=this.normalizeWheelEvent(t);this.manager.mapEvent(e)};let{targetElement:e,resolution:i,rootNode:r,global:n,autoPreventDefault:l=!1,clickInterval:s,supportsTouchEvents:a=n.supportsTouchEvents,supportsPointerEvents:o=n.supportsPointerEvents}=t;this.manager=new dJ(r,{clickInterval:s,supportsTouchEvents:a}),this.globalObj=n,this.supportsPointerEvents=o,this.supportsTouchEvents=a,this.supportsMouseEvents=n.supportsMouseEvents,this.applyStyles=n.applyStyles,this.autoPreventDefault=l,this.eventsAdded=!1,this.rootPointerEvent=new dX,this.rootWheelEvent=new dY,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=i,this.setTargetElement(e)}release(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}setCursor(t,e){if(!e&&!this.manager.rootTarget.window._handler.canvas.controled)return;t||(t="default");let{applyStyles:i,domElement:r}=this;if(this.currentCursor===t)return;this.currentCursor=t;let n=this.cursorStyles[t];n?"string"==typeof n&&i?r.style.cursor=n:"function"==typeof n?n(t):"object"==typeof n&&i&&Object.assign(r.style,n):i&&(0,nI.Z)(t)&&!(0,dV.Z)(this.cursorStyles,t)&&(r.style.cursor=t)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;let{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.addEventListener("pointermove",this.onPointerMove,!0),t.addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.addEventListener("mousemove",this.onPointerMove,!0),t.addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;let{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.removeEventListener("pointermove",this.onPointerMove,!0),t.removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.removeEventListener("mousemove",this.onPointerMove,!0),t.removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapToViewportPoint(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}mapToCanvasPoint(t){var e,i;let r=null==(e=this.globalObj)?void 0:e.mapToCanvasPoint(t,this.domElement);if(r)return r;let n=0,l=0;if(t.changedTouches){let e=null!=(i=t.changedTouches[0])?i:{};n=e.clientX||0,l=e.clientY||0}else n=t.clientX||0,l=t.clientY||0;let s=this.domElement.getBoundingClientRect();return{x:n-s.left,y:l-s.top}}normalizeToPointerData(t){let e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(let i=0,r=t.changedTouches.length;i<r;i++){let r=t.changedTouches[i];(0,dU.Z)(r.button)&&(r.button=0),(0,dU.Z)(r.buttons)&&(r.buttons=1),(0,dU.Z)(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,dU.Z)(r.width)&&(r.width=r.radiusX||1),(0,dU.Z)(r.height)&&(r.height=r.radiusY||1),(0,dU.Z)(r.tiltX)&&(r.tiltX=0),(0,dU.Z)(r.tiltY)&&(r.tiltY=0),(0,dU.Z)(r.pointerType)&&(r.pointerType="touch"),(0,dU.Z)(r.pointerId)&&(r.pointerId=r.identifier||0),(0,dU.Z)(r.pressure)&&(r.pressure=r.force||.5),(0,dU.Z)(r.twist)&&(r.twist=0),(0,dU.Z)(r.tangentialPressure)&&(r.tangentialPressure=0),(0,dU.Z)(r.layerX)&&(r.layerX=r.offsetX=r.clientX),(0,dU.Z)(r.layerY)&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else this.globalObj.supportsMouseEvents&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof PointerEvent)||((0,dU.Z)(t.isPrimary)&&(t.isPrimary=!0),(0,dU.Z)(t.width)&&(t.width=1),(0,dU.Z)(t.height)&&(t.height=1),(0,dU.Z)(t.tiltX)&&(t.tiltX=0),(0,dU.Z)(t.tiltY)&&(t.tiltY=0),(0,dU.Z)(t.pointerType)&&(t.pointerType="mouse"),(0,dU.Z)(t.pointerId)&&(t.pointerId=1),(0,dU.Z)(t.pressure)&&(t.pressure=.5),(0,dU.Z)(t.twist)&&(t.twist=0),(0,dU.Z)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),e.push(t);return e}normalizeWheelEvent(t){let e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;let{x:i,y:r}=this.mapToCanvasPoint(t);e.canvas.x=i,e.canvas.y=r,e.global.x=i,e.global.y=r,e.offset.x=i,e.offset.y=r;let{x:n,y:l}=this.mapToViewportPoint(e);return e.viewport.x=n,e.viewport.y=l,e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);let{x:i,y:r}=this.mapToCanvasPoint(e);t.canvas.x=i,t.canvas.y=r,t.global.x=i,t.global.y=r,t.offset.x=i,t.offset.y=r;let{x:n,y:l}=this.mapToViewportPoint(t);return t.viewport.x=n,t.viewport.y=l,t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=dQ[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=d$.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}isEventOutsideOfTargetViewPort(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){let e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),i=this.domElement.getViewBox(),r=i.width(),n=i.height();return!(e.x<r&&e.y<n&&e.x>0&&e.y>0)}return!1}isEventOutsideOfTargetElement(t){let e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}pauseTriggerEvent(){this.manager.pauseNotify=!0}resumeTriggerEvent(){this.manager.pauseNotify=!1}}class d1{constructor(){this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=eJ.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t;let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),e.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),e.graphicService.hooks.onRemove.tap(this.key,this.handleChange))}deactivate(t){let e=t=>t.filter(t=>t.name!==this.key),i=this.pluginService.stage;i&&(i.graphicService.hooks.onAttributeUpdate.taps=e(i.graphicService.hooks.onAttributeUpdate.taps),i.graphicService.hooks.onSetStage.taps=e(i.graphicService.hooks.onSetStage.taps),i.graphicService.hooks.onRemove.taps=e(i.graphicService.hooks.onRemove.taps))}}class d2{constructor(){this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=eJ.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t,this.dpr=iC.global.devicePixelRatio,this.refresh()}refresh(){this._refreshByMediaQuery()||this._refreshByRaf()}_refreshByRaf(){let t=iC.global.getRequestAnimationFrame();this.rafId=t(()=>{iC.global.devicePixelRatio!==this.dpr&&(this.dpr=iC.global.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0)),this.refresh()})}_refreshByMediaQuery(){try{let t=`(resolution: ${window.devicePixelRatio}dppx)`,e=()=>{window.devicePixelRatio!==this.dpr&&(this.dpr=window.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0))},i=matchMedia(t);i&&i.addEventListener("change",e),this.autoRefreshCbs||(this.autoRefreshCbs=[]),this.autoRefreshCbs.push(()=>{i&&i.removeEventListener("change",e)})}catch(t){return!1}return!0}deactivate(t){var e;let i=iC.global.getCancelAnimationFrame();i&&this.rafId&&i(this.rafId),null==(e=this.autoRefreshCbs)||e.forEach(t=>{t()}),this.autoRefreshCbs=void 0}}class d3{constructor(){this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=eJ.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t;let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.tap(this.key,(e,i,r)=>{e.glyphHost&&(e=e.glyphHost),e.stage===t.stage&&null!=e.stage&&(this.nextUserParams.startAtId=i._uid,this.renderNextFrame(i))}),e.graphicService.hooks.onClearIncremental.tap(this.key,(e,i)=>{e.stage===t.stage&&null!=e.stage&&(this.nextUserParams.startAtId=e._uid,this.nextUserParams.restartIncremental=!0,this.renderNextFrame(e))}))}deactivate(t){let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.taps=e.graphicService.hooks.onAddIncremental.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.onClearIncremental.taps=e.graphicService.hooks.onClearIncremental.taps.filter(t=>t.name!==this.key))}renderNextFrame(t){this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,iC.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){let t=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach(e=>{let i=e.layer;if(!i||!e.layer.subLayers)return;let r=e.layer.subLayers.get(e._uid);r&&r.drawContribution&&r.drawContribution.draw(t.renderService,Object.assign({stage:t,layer:i,viewBox:t.window.getViewBox(),transMatrix:t.window.getViewBoxTransform(),clear:"transparent",renderService:t.renderService,updateBounds:!1,startAtId:e._uid,context:r.layer.getNativeHandler().getContext()},this.nextUserParams))}),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}let d5=new iI.FB;class d4{constructor(){this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=eJ.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,t=>{t&&t===this.pluginService.stage&&t.dirtyBounds.clear()});let e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(t,e,i,r)=>{t.glyphHost&&(t=t.glyphHost),e&&e===this.pluginService.stage&&e.renderCount&&(t.isContainer&&!t.shouldSelfChangeUpdateAABBBounds()||i&&(d5.setValue(r.x1,r.y1,r.x2,r.y2),e.dirty(d5,t.parent&&t.parent.globalTransMatrix)))}),e.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(t,e,i,r,n)=>{e&&e===this.pluginService.stage&&e.renderCount&&(t.isContainer&&!n||e.dirty(r.globalAABBBounds))}),e.graphicService.hooks.clearAABBBounds.tap(this.key,(t,e,i)=>{e&&e===this.pluginService.stage&&e.renderCount&&e&&e.dirty(i)}),e.graphicService.hooks.onRemove.tap(this.key,t=>{let e=t.stage;e&&e===this.pluginService.stage&&e.renderCount&&e&&e.dirty(t.globalAABBBounds)}))}deactivate(t){let e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.taps=e.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.afterUpdateAABBBounds.taps=e.graphicService.hooks.afterUpdateAABBBounds.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.clearAABBBounds.taps=e.graphicService.hooks.clearAABBBounds.taps.filter(t=>t.name!==this.key),e.hooks.afterRender.taps=e.hooks.afterRender.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.onRemove.taps=e.graphicService.hooks.onRemove.taps.filter(t=>t.name!==this.key))}}class d6{static registerPlugin(t,e){d6._pluginClasses[t]=e}static getPlugin(t){return d6._pluginClasses[t]}}d6._pluginClasses={};let d7={BACKGROUND:"white"};class d8 extends sj{set viewBox(t){this.window.setViewBox(t)}get viewBox(){return this.window.getViewBox()}get x(){return this.window.getViewBox().x1}set x(t){let e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}get y(){return this.window.getViewBox().y1}set y(t){let e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}get width(){return this.window.width}set width(t){this.resize(t,this.height)}get viewWidth(){return this.window.getViewBox().width()}set viewWidth(t){this.resizeView(t,this.viewHeight)}get viewHeight(){return this.window.getViewBox().height()}set viewHeight(t){this.resizeView(this.viewWidth,t)}get height(){return this.window.height}set height(t){this.resize(this.width,t)}get dpr(){return this.window.dpr}set dpr(t){this.setDpr(t)}get background(){var t;return null!=(t=this._background)?t:d7.BACKGROUND}set background(t){this._background=t}get defaultLayer(){return this.at(0)}get eventSystem(){return this._eventSystem}get ticker(){return this._ticker}set ticker(t){t.bindStage(this),this._ticker&&this._ticker.removeListener("tick",this.afterTickCb),t.addTimeline(this.timeline),this._ticker=t,this._ticker.on("tick",this.afterTickCb)}constructor(t={}){var e,i;super({}),this.tickedBeforeRender=!0,this._onVisibleChange=t=>{if(!(this._skipRender<0))if(t){if(this.dirtyBounds){let t=this.window.getViewBox();this.dirtyBounds.setValue(t.x1,t.y1,t.width(),t.height())}this._skipRender>1&&this.renderNextFrame(),this._skipRender=0}else this._skipRender=1},this.beforeRender=t=>{this._beforeRenderList.forEach(e=>e(t))},this.afterClearScreen=t=>{this._afterClearScreen&&this._afterClearScreen(t)},this.afterClearRect=t=>{this._afterClearRect&&this._afterClearRect(t)},this.afterRender=t=>{this.renderCount++,this._afterRenderList.forEach(e=>e(t)),this._afterNextRenderCbs&&this._afterNextRenderCbs.forEach(e=>e(t)),this._afterNextRenderCbs=null,this.tickedBeforeRender=!1},this.afterTickCb=()=>{this.tickedBeforeRender=!0,"rendering"!==this.state&&this.renderNextFrame()},this.params=t,this.theme=new nk,this.hooks={beforeRender:new io(["stage"]),afterRender:new io(["stage"]),afterClearScreen:new io(["stage"]),afterClearRect:new io(["stage"])},this.global=iC.global,!this.global.env&&hR()&&this.global.setEnv("browser"),this.window=ib.get(nf),this.renderService=ib.get(i_),this.pluginService=ib.get(aB),this.layerService=ib.get(sX),this.graphicService=ib.get(sy),this.pluginService.active(this,t),this._beforeRenderList=[],this._afterRenderList=[],this.window.create({width:t.width,height:t.height,viewBox:t.viewBox,container:t.container,dpr:t.dpr||this.global.devicePixelRatio,canvasControled:!1!==t.canvasControled,title:t.title||"",canvas:t.canvas}),this.state="normal",this.renderCount=0,this.tryInitEventSystem(),this._background=null!=(e=t.background)?e:d7.BACKGROUND,this.appendChild(this.layerService.createLayer(this,{main:!0})),this.nextFrameRenderLayerSet=new Set,this.willNextFrameRender=!1,this.stage=this,this.renderStyle=t.renderStyle,t.autoRender&&this.enableAutoRender(),t.autoRefresh&&this.enableAutoRefresh(),!1===t.disableDirtyBounds&&this.enableDirtyBounds(),t.enableHtmlAttribute&&this.enableHtmlAttribute(t.enableHtmlAttribute),t.ReactDOM&&this.enableReactAttribute(t.ReactDOM),t.enableLayout&&this.enableLayout(),this.hooks.beforeRender.tap("constructor",this.beforeRender),this.hooks.afterRender.tap("constructor",this.afterRender),t.beforeRender&&this._beforeRenderList.push(t.beforeRender),t.afterRender&&this._afterRenderList.push(t.afterRender),this.hooks.afterClearScreen.tap("constructor",this.afterClearScreen),this.hooks.afterClearRect.tap("constructor",this.afterClearRect),this._afterClearScreen=t.afterClearScreen,this._afterClearRect=t.afterClearRect,this.supportInteractiveLayer=!1!==t.interactiveLayer,t.optimize||(t.optimize={tickRenderMode:"effect"}),this.optmize(t.optimize),t.background&&(0,nI.Z)(this._background)&&this._background.includes("/")&&this.setAttributes({background:this._background}),this.initAnimate(t),this.rafId=null!=(i=t.rafId)?i:Math.floor(6*Math.random())}initAnimate(t){var e;this.createTicker&&this.createTimeline&&(this._ticker=t.ticker||this.createTicker(this),this._ticker.bindStage(this),"performance"===(null==(e=this.params.optimize)?void 0:e.tickRenderMode)&&this._ticker.setFPS(30),this.timeline=this.createTimeline(),this._ticker.addTimeline(this.timeline),this._ticker.on("tick",this.afterTickCb))}startAnimate(){this._ticker&&this.timeline&&(this._ticker.start(),this.timeline.resume())}pauseRender(t=-1){this._skipRender=t}resumeRender(){this._skipRender=0}tryInitEventSystem(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new d0(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}preventRender(t){t?this._skipRender=-1/0:!1!==this.params.optimize.skipRenderWithOutRange?this._skipRender=+!this.window.isVisible():this._skipRender=0}optmize(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}optmizeRender(t=!1){t&&(this._skipRender=this._skipRender<0?this._skipRender:+!this.window.isVisible(),this.window.onVisibleChange(this._onVisibleChange))}getTimeline(){return this.timeline}get3dOptions(t){let{center:e={x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0},light:i={},alpha:r=0,beta:n=0,camera:l,fieldRatio:s=1,fieldDepth:a}=t;return Object.assign(Object.assign({},t),{center:e,light:i,alpha:r,beta:n,camera:l,fieldRatio:s,fieldDepth:a})}set3dOptions(t){var e,i,r,n,l,s;this.option3d=t;let{light:a,center:o,camera:h,alpha:d,beta:u,fieldRatio:c,fieldDepth:p}=this.get3dOptions(t),{dir:g=[1,1,-1],color:f="white",ambient:m}=a,y=(null!=(e=o.x)?e:this.width/2)+(null!=(i=o.dx)?i:0),v=(null!=(r=o.y)?r:this.height/2)+(null!=(n=o.dy)?n:0),b=[y,v,(null!=(l=o.z)?l:0)+(null!=(s=o.dz)?s:0)],_=0,C=0,x=0;h||(_=Math.sin(d)+y,C=Math.sin(u)+v,x=Math.cos(d)*Math.cos(u)*1);let w=d6.getPlugin("DirectionalLight");w&&(this.light=new w(g,f,m));let S={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:c,fieldDepth:p,viewParams:{pos:[_,C,x],center:b,up:[0,1,0]}};if(this.camera)this.camera.params=S;else{let t=d6.getPlugin("OrthoCamera");t&&(this.camera=new t(S))}t.enableView3dTransform&&this.enableView3dTransform()}setBeforeRender(t){this._beforeRenderList.push(t)}removeBeforeRender(t){this._beforeRenderList=this._beforeRenderList.filter(e=>e!==t)}setAfterRender(t){this._afterRenderList.push(t)}removeAfterRender(t){this._afterRenderList=this._afterRenderList.filter(e=>e!==t)}afterNextRender(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}enableView3dTransform(){if(this.view3dTranform)return;this.view3dTranform=!0;let t=d6.getPlugin("ViewTransform3dPlugin");t&&this.pluginService.register(new t)}disableView3dTranform(){this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRender(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new d1))}disableAutoRender(){this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRefresh(){this.autoRefresh||"node"===this.global.env||(this.autoRefresh=!0,this.pluginService.register(new d2))}disableAutoRefresh(){this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableIncrementalAutoRender(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new d3))}disableIncrementalAutoRender(){this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableDirtyBounds(){if(this.dirtyBounds)return;this.dirtyBounds=new iI.YZ;let t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new d4,this.pluginService.register(t))}disableDirtyBounds(){this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableLayout(){if(this._enableLayout)return;this._enableLayout=!0;let t=d6.getPlugin("FlexLayoutPlugin");t&&this.pluginService.register(new t)}disableLayout(){this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableHtmlAttribute(t){if(this.htmlAttribute)return;let e=d6.getPlugin("HtmlAttributePlugin");e&&(this.htmlAttribute=t,this.pluginService.register(new e))}disableHtmlAttribute(){this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableReactAttribute(t){if(this.reactAttribute)return;let e=d6.getPlugin("ReactAttributePlugin");e&&(this.reactAttribute=t,this.pluginService.register(new e))}disableReactAttribute(){this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}getPluginsByName(t){return this.pluginService.findPluginsByName(t)}tryUpdateAABBBounds(){let t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}combineLayer(t,e){throw Error("暂不支持")}createLayer(t,e){if("released"===this.releaseStatus)return;let i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}sortLayer(t){let e=this.children;e.sort(t),this.removeAllChild(),e.forEach(t=>{this.appendChild(t)})}removeLayer(t){return this.removeChild(this.findChildByUid(t))}tryInitInteractiveLayer(){"released"!==this.releaseStatus&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}clearViewBox(t){this.window.clearViewBox(t)}render(t,e){if("released"===this.releaseStatus)return;this.startAnimate();let i=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}combineLayersToWindow(){if("harmony"===this.global.env){let t=this.window.getContext().nativeContext;this.forEachChildren((e,i)=>{if(i>0){let i=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(i)}})}}renderNextFrame(t,e){this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach(t=>{this.nextFrameRenderLayerSet.add(t)}),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getSpecifiedRequestAnimationFrame(this.rafId)(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){if("released"===this.releaseStatus)return;this.startAnimate();let t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}renderLayerList(t,e){let i=[];for(let e=0;e<t.length;e++){let r=t[e];"virtual"===r.layerMode&&(r=r.getNativeHandler().mainHandler.layer),i.includes(r)||i.push(r)}i.forEach(t=>{t.renderCount>this.renderCount||(t.renderCount=this.renderCount+1,t===this.interactiveLayer&&this.dirtyBounds&&this.dirtyBounds.clear(),t.render({renderService:this.renderService,background:t===this.defaultLayer?this.background:void 0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}resizeWindow(t,e,i=!0){this.window.resize(t,e),i&&this.render()}resize(t,e,i=!0){"released"!==this.releaseStatus&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren(i=>{i.resize(t,e)}),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render())}resizeView(t,e,i=!0){"released"!==this.releaseStatus&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren(i=>{i.resizeView(t,e)}),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render())}setViewBox(t,e,i,r,n){let l=!0;"object"==typeof t?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),!1===e&&(l=!1)):(this.viewBox.setValue(t,e,t+i,e+r),!1===n&&(l=!1)),this.forEachChildren(t=>{t.resizeView(this.viewBox.width(),this.viewBox.height())}),l&&this.render()}setDpr(t,e=!0){this.forEachChildren(e=>{e.setDpr(t)}),e&&this.render()}setOrigin(t,e){throw Error("暂不支持")}export(t){throw Error("暂不支持")}pick(t,e){if("released"===this.releaseStatus)return;let i=this.getPickerService().pick(this.children,new iN.E9(t,e),{bounds:this.AABBBounds});return!(!(null==i?void 0:i.graphic)&&!(null==i?void 0:i.group))&&i}setToFrame(t){throw Error("暂不支持")}release(){var t,e;super.release(),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach(t=>{t.release()}),this.interactiveLayer&&(this.interactiveLayer.forEachChildren(t=>{t.setStage&&t.setStage(null,null),this.interactiveLayer.removeChild(t)}),this.interactiveLayer.release()),this.window.release(),null==(t=this._ticker)||t.remTimeline(null==this?void 0:this.timeline),null==(e=this._ticker)||e.removeListener("tick",this.afterTickCb),this.renderService.renderTreeRoots=[]}setStage(t){}dirty(t,e){"released"!==this.releaseStatus&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}getLayer(t){return this.children.filter(e=>e.name===t)[0]}renderTo(t){"released"!==this.releaseStatus&&this.forEachChildren((e,i)=>{e.drawTo(t,{renderService:this.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:e===this.defaultLayer?this.background:void 0,clear:0===i,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())})})}renderToNewWindow(t=!0,e){if("released"===this.releaseStatus)return;let i=ib.get(nf),r=e?-e.x1:0,n=e?-e.y1:0,l=e?e.x2:this.viewWidth,s=e?e.y2:this.viewHeight,a=e?e.width():this.viewWidth,o=e?e.height():this.viewHeight;return i.create({viewBox:{x1:r,y1:n,x2:l,y2:s},width:a,height:o,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(i),i}toCanvas(t=!0,e){if("released"===this.releaseStatus)return;let i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}setCursor(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}getCursor(){return this._cursor}eventPointTransform(t){let e=this.global.mapToCanvasPoint(t,this.window);return this.stage.window.pointTransform(e.x,e.y)}pauseTriggerEvent(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}resumeTriggerEvent(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}getPickerService(){return this.pickerService||(this.pickerService=ib.get(au)),this.pickerService}reInit(){this.renderService.reInit(),this.pickerService.reInit()}}let d9="__VCHART",ut=500,ue=500,ui=`${d9}_MEASURE_CANVAS_ID`,ur=`${d9}_DEFAULT_DATA_INDEX`,un=`${d9}_DEFAULT_DATA_KEY`,ul=`${d9}_DEFAULT_DATA_SERIES_FIELD`,us=`${d9}_DEFAULT_SERIES_STYLE_NAME`,ua=`${d9}_STACK_KEY`,uo=`${d9}_STACK_START`,uh=`${d9}_STACK_END`,ud=`${d9}_STACK_START_PERCENT`,uu=`${d9}_STACK_END_PERCENT`,uc=`${d9}_STACK_START_OffsetSilhouette`,up=`${d9}_STACK_END_OffsetSilhouette`,ug=`${d9}_STACK_TOTAL`,uf=`${d9}_STACK_TOTAL_PERCENT`,um=`${d9}_STACK_TOTAL_TOP`,uy=`${d9}_STACK_TOTAL_BOTTOM`,uv=`${d9}_MOSAIC_VALUE_START_PERCENT`,ub=`${d9}_MOSAIC_VALUE_END_PERCENT`,u_=`${d9}_MOSAIC_CAT_START_PERCENT`,uC=`${d9}_MOSAIC_CAT_END_PERCENT`,ux=`${d9}_SEGMENT_START`,uw=`${d9}_SEGMENT_END`,uS=`${d9}_KEY`,uA=`${d9}_MAP_LOOK_UP_KEY`,uM=["line","area","trail"];function uT(t,e,i){let r=new Map;if(!t||0===t.length)return{keys:[],data:r};if(!e)return r.set(uS,i?t.slice().sort(i):t.slice()),{keys:[uS],data:r};if(1===t.length){let i=e(t[0],0);return r.set(i,[t[0]]),{keys:[i],data:r}}let n=new Set;return t.forEach((t,i)=>{var l;let s=e(t,i),a=null!=(l=r.get(s))?l:[];a.push(t),r.set(s,a),n.add(s)}),i&&n.forEach(t=>{r.get(t).sort(i)}),{keys:Array.from(n),data:r}}let uk=(t,e,i={})=>(t&&Object.keys(t).forEach(r=>{i[r]=t[r](e)}),i);function uR(t,e,i,r,n){let l=t=>{if(!r&&t&&(!i||i(t))){let i=e.call(null,t);if(n&&i)return i}if("group"===t.type){let e=t.getMarks();if(e)for(let t=0;t<e.length;t++){let i=l(e[t]);if(i&&n)return i}}if(r&&t&&(!i||i(t))){let i=e.call(null,t);if(i&&n)return i}};return l(t)}function uP(t){let e=[];return t.forEach(t=>{uR(t,t=>{"group"!==t.type&&"component"!==t.type&&e.push(t)})}),e}function uB(t,e,i,r){let n=uT(t,t=>i(t)),l=uT(e,t=>r(t)),s=t,a=e,o=[];return l.keys.forEach(t=>{if(!(0,nB.Z)(t)){let e=n.data.get(t),i=l.data.get(t);e&&i&&(o.push({prev:e,next:i}),s=s.filter(t=>!e.includes(t)),a=a.filter(t=>!i.includes(t)))}}),{prev:s,next:a,update:o}}let uI=`${d9}_BuiltIn_CallBack_Disappear`;(F=tl||(tl={})).render="render",F.disappear="disappear";class uE{get stateAnimationConfig(){return this._stateAnimationConfig}getRootGroup(){return this._rootGroup}getOption(){return this._option}constructor(t,e){this._count=0,this._rootMarks=[],this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.isInited=!1,this._released=!1,this._compileChart=null,this.handleLayoutEnd=()=>{var t,e;null==(e=null==(t=this._compileChart)?void 0:t.getEvent())||e.emit(J.afterMarkLayoutEnd,{chart:this._compileChart})},this.handleStageRender=()=>{var t,e;null==(e=null==(t=this._compileChart)?void 0:t.getEvent())||e.emit(J.afterRender,{chart:this._compileChart})},this._handleAfterNextRender=()=>{var t,e,i,r;this._stage&&!this._option.disableDirtyBounds&&this._stage.enableDirtyBounds(),this._compileChart&&(null==(t=this._compileChart.getEvent())||t.emit(J.renderFinished,{chart:this._compileChart,vchart:null==(e=this._compileChart.getOption())?void 0:e.globalInstance})),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterVRenderDraw)||r.call(i,this._compileChart.getOption().globalInstance)},this.handleProgressiveFrame=()=>{this._progressiveMarks.length&&this._progressiveMarks.forEach(t=>{t.isDoingProgressive()&&t.renderProgressive()}),this.doPreProgressive()},this._container=t,this._option=e}getChart(){return this._compileChart}getCanvas(){var t;return null==(t=this._stage)?void 0:t.window.getNativeHandler().nativeCanvas}getStage(){return this._stage}initView(){var t,e,i,r;if(this._released||(this.isInited=!0,this._stage))return;let{autoRefreshDpr:n,dpr:l,mode:s,modeParams:a,gestureConfig:o,interactive:h,clickInterval:d,autoPreventDefault:u,background:c}=this._option;hd.setEnv(function(t){switch(t){case oJ["desktop-browser"]:case oJ["mobile-browser"]:break;case oJ.node:case oJ.worker:return"node";case oJ.miniApp:case oJ["desktop-miniApp"]:return"feishu";case oJ.lynx:return"lynx";case oJ.wx:return"wx";case oJ.tt:return"tt";case oJ.harmony:return"harmony"}return"browser"}(s),null!=a?a:{}),this._stage=null!=(t=this._option.stage)?t:new d8(Object.assign({background:c,width:this._width,height:this._height,container:null!=(e=this._container.dom)?e:null,canvas:null!=(i=this._container.canvas)?i:null,dpr:l,viewBox:this._option.viewBox,canvasControled:this._option.canvasControled,beforeRender:t=>{var e,i,r;null==(e=this._compileChart)||e.onBeforeRender(),null==(r=(i=this._option).beforeRender)||r.call(i,t)},afterRender:this._option.afterRender,disableDirtyBounds:!0,autoRender:!0,ticker:this._option.ticker,pluginList:this._option.pluginList,enableHtmlAttribute:this._option.enableHtmlAttribute,optimize:this._option.optimize,supportsTouchEvents:this._option.supportsTouchEvents,supportsPointerEvents:this._option.supportsPointerEvents,event:{clickInterval:d,autoPreventDefault:u},ReactDOM:this._option.ReactDOM,autoRefresh:(0,aw.Z)(n)?n:!(0,aw.Z)(l)},null!=(r=this._option.renderHooks)?r:{})),this._stage.enableIncrementalAutoRender(),this._stage.setTheme({symbol:{shape:"circle",size:8},text:{fontSize:14,fill:"#000000"}});let p=sG({x:0,y:0,width:this._width,height:this._height});p.name="root",this._stage.defaultLayer.appendChild(p),this._rootGroup=p;let g=((0,aw.Z)(o)?o:hE(s))&&!1!==h&&h9.getStageEventPlugin("gesture");g&&(this._gestureController=new g(this._stage,(0,nF.Z)(o)?o:{})),this._setCanvasStyle(),this.getStage().hooks.afterRender.tap("chart-event",this.handleStageRender),!1!==h&&this._viewListeners.forEach(t=>{})}getLayoutState(){return this._layoutState}updateLayoutTag(){this._layoutState=tn.before}_setCanvasStyle(){if(this._stage&&this._container.dom&&!(0,nI.Z)(this._container.dom)){this._container.dom.style.display="block",this._container.dom.style.position="relative";let t=this.getCanvas();t&&(t.style.display="block")}}compile(t,e){if(this._released)return;let{chart:i}=t;this._compileChart=i,this.initView(),this._stage&&("render"!==(null==e?void 0:e.actionSource)&&this._cachedMarks&&(this.reuseOrMorphing(e.morphConfig),this._cachedMarks=null),i.compile(),i.afterCompile())}clearNextRender(){return!!this._nextRafId&&(hd.getSpecifiedCancelAnimationFrame(10)(this._nextRafId),this._nextRafId=null,!0)}clear(t){let{chart:e}=t;this.clearNextRender(),e.clear()}renderNextTick(t){this._released||(this._nextRafId&&this.clearNextRender(),this._nextRafId=hd.getSpecifiedRequestAnimationFrame(10)(()=>{this._nextRafId=null,this.render(t)}))}_commitedAll(){return this._rootMarks.some(t=>uR(t,t=>t.commit()))}_hasCommitedMark(){return this._rootMarks.some(t=>uR(t,t=>t.isCommited(),null,null,!0))}_doRender(t){var e,i,r,n,l,s;null==(i=null==(e=this._option.performanceHook)?void 0:e.beforeDoRender)||i.call(e,this._compileChart.getOption().globalInstance),this._stage&&(this._rootMarks.forEach(t=>{uR(t,t=>{t.needClear&&(this._progressiveMarks||t.runAnimation(),t.clearExitGraphics(),t.needClear=!1)},null,!0)}),null==(n=null==(r=this._option.performanceHook)?void 0:r.beforeVRenderDraw)||n.call(r,this._compileChart.getOption().globalInstance),this._stage.disableDirtyBounds(),this._stage.afterNextRender(this._handleAfterNextRender),t&&(this._stage.render(),null==(s=null==(l=this._option.performanceHook)?void 0:l.afterVRenderDraw)||s.call(l,this._compileChart.getOption().globalInstance)))}renderMarks(){var t;this._hasCommitedMark()&&(hF(`--- start of renderMarks(${this._count}) ---`),this.clearProgressive(),this._rootMarks.forEach(t=>{t.render()}),this._layoutState===tn.before&&(this._layoutState=tn.layouting,null==(t=this._compileChart)||t.onLayout(),this._layoutState=tn.reevaluate,this._hasCommitedMark()&&this._rootMarks.forEach(t=>{t.render()}),this.handleLayoutEnd()),this.findProgressiveMarks(),this.updateStateAnimation(),this._doRender(!0),this.doPreProgressive(),hF(`--- start of renderMarks(${this._count}) ---`),this._count++)}reuseOrMorphing(t={}){let{reuse:e=!0,morph:i=!0,morphAll:r=!1,animation:n={},enableExitAnimation:l=!1}=t,s=uP(this._rootMarks),{update:a,exit:o}=function(t,e,i){let r={enter:[],exit:[],update:[]},n=[],l=[];t.forEach(t=>{i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?n.push(t):r.exit.push({prev:[t]})}),e.forEach(t=>{i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?l.push(t):r.enter.push({next:[t]})});let s=uB(n,l,t=>t.getMarkConfig().morphKey,t=>t.getMarkConfig().morphKey);n=s.prev,l=s.next,r.update=r.update.concat(s.update);let a=uB(n,l,t=>`${t.getUserId()}`,t=>`${t.getUserId()}`);n=a.prev,l=a.next,r.update=r.update.concat(a.update);let o=uT(n,t=>{var e,i;return null==(i=null==(e=t.group)?void 0:e.id)?void 0:i.call(e)}),h=uT(l,t=>{var e,i;return null==(i=null==(e=t.group)?void 0:e.id)?void 0:i.call(e)});return Object.keys(h).forEach(t=>{let e=o.data.get(t),i=h.data.get(t);if(e&&i){for(let t=0;t<Math.max(e.length,i.length);t+=1){let n=e[t],l=i[t];n&&l?r.update.push({prev:[n],next:[l]}):n?r.exit.push({prev:[n]}):l&&r.enter.push({next:[l]})}n=n.filter(t=>!e.includes(t)),l=l.filter(t=>!i.includes(t))}}),n.forEach(t=>r.exit.push({prev:[t]})),l.forEach(t=>r.enter.push({next:[t]})),r}(this._cachedMarks,s,{morph:i,morphAll:r,reuse:e});a.forEach(({prev:t,next:i})=>{if(e&&1===t.length&&1===i.length&&t[0].type===i[0].type)i[0].reuse(t[0]);else{let e=t.filter(t=>t.getMarkConfig().morph)[0];e&&i.forEach(t=>{t.getMarkConfig().morph&&t.prepareMorph(e)})}}),o.forEach(({prev:t})=>{t.forEach(t=>{t.removeProduct()})})}render(t){if(this._released||(this.clearNextRender(),this.initView(),!this._stage))return;let{width:e,height:i}=this._rootGroup.attribute;this._width===e&&this._height===i||this._rootGroup.setAttributes({width:this._width,height:this._height}),this.renderMarks(),this.clearNextRender()&&this.renderMarks()}setStageAnimationConfig(t){let e={};Object.keys(t).forEach(i=>{let r=t[i];(0,rD.Z)(r)?e[i]="disappear"===i?r.map(t=>{var e;return"function"==typeof(e=t.callBack)&&/^class\s/.test(e.toString())?Object.assign(Object.assign({},t),{custom:t.callBack}):Object.assign(Object.assign({},t),{type:uI,customParameters:{callBack:t.callBack}})}):r.map(t=>{var e;let i=null!=(e=t.options)?e:{};return Object.assign(Object.assign({},t),{options:(...t)=>Object.assign({},"function"==typeof i?i(...t):i)})}):e[i]=Object.assign({},t[i])}),this._stateAnimationConfig=e}updateStateAnimation(){let t=[];this._rootMarks.forEach(e=>{uR(e,e=>{t.push(e)})});let e=t.map(t=>t.getAnimationState()),i=e.every(t=>t===tr.appear)?tr.appear:e.every(t=>t===tr.disappear)?tr.disappear:tr.none;this._stage.context||(this._stage.context={}),this._stage.context.animationState=i}updateViewBox(t,e=!0){if(!this._stage)return;let i=this._stage.viewBox;!t||i&&i.x1===t.x1&&i.y1===t.y1&&i.x2===t.x2&&i.y2===t.y2||this._stage.setViewBox(t,e)}resize(t,e,i=!0){if(!this._stage)return;let r=this._width!==t||this._height!==e;this._width=t,this._height=e,r&&(this._stage.resize(t,e),this._commitedAll(),i&&this.render({morph:!1}))}setBackground(t){this._stage&&(this._stage.background=t)}setSize(t,e){this._width=t,this._height=e,this._stage}setViewBox(t,e=!0){this.updateViewBox(t,e)}addEventListener(t,e,i){var r,n;if(!1!==this._option.interactive){if(t===Q.chart){let n=this.getRootGroup(),l=(function(r){var l;let s=r.target,a=null;s&&(a=(0,aw.Z)(s.context)?s:dT(n,s));let o=null!=(l=null==a?void 0:a.context)?l:{},h=(0,aw.Z)(o.markId)?o.markId:null,d=(0,aw.Z)(o.modelId)?o.modelId:null,u=(0,aw.Z)(o.modelUserId)?o.modelUserId:null,c=(0,aw.Z)(o.markUserId)?o.markUserId:null,p={event:r,type:e,source:t,item:a,datum:dM(a),markId:h,modelId:d,markUserId:c,modelUserId:u};i.call(null,p)}).bind(this);this._viewListeners.set(i,{type:e,callback:l}),null==(r=this._stage)||r.addEventListener(e,l)}else if(t===Q.window){let r=(function(r){i.call(null,{event:r,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null})}).bind(this);this._windowListeners.set(i,{type:e,callback:r});let n=this._getGlobalThis();null==n||n.addEventListener(e,r)}else if(t===Q.canvas){let r=(function(r){i.call(null,{event:r,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null})}).bind(this);this._canvasListeners.set(i,{type:e,callback:r});let l=null==(n=this.getStage())?void 0:n.window;null==l||l.addEventListener(e,r)}}}removeEventListener(t,e,i){var r,n,l,s,a;if(!1!==this._option.interactive){if(t===Q.chart){let t=null==(r=this._viewListeners.get(i))?void 0:r.callback;t&&(null==(n=this._stage)||n.removeEventListener(e,t)),this._viewListeners.delete(i)}else if(t===Q.window){let t=this._getGlobalThis(),r=null==(l=this._windowListeners.get(i))?void 0:l.callback;r&&(null==t||t.removeEventListener(e,r)),this._windowListeners.delete(i)}else if(t===Q.canvas){let t=null==(s=this.getStage())?void 0:s.window,r=null==(a=this._canvasListeners.get(i))?void 0:a.callback;t&&r&&(null==t||t.removeEventListener(e,r)),this._canvasListeners.delete(i)}}}releaseEvent(){let t=this.getStage();t&&t.hooks.afterRender.unTap("chart-event",this.handleStageRender),this._viewListeners.clear(),this._windowListeners.clear(),this._canvasListeners.clear()}release(){var t;this.clearNextRender(),this.releaseEvent(),this._option=this._container=null,this.releaseGrammar(!0),this._stage!==(null==(t=this._option)?void 0:t.stage)&&this._stage.release(),this._stage=null,this.isInited=!1,this._compileChart=null,this._released=!0}releaseGrammar(t=!1){t?this._rootMarks.forEach(t=>{uR(t,t=>{t.removeProduct()},null,!0)}):this._cachedMarks=uP(this._rootMarks),this._rootMarks=[]}addRootMark(t){this._rootMarks.includes(t)||this._rootMarks.push(t)}getRootMarks(){return this._rootMarks}removeRootMark(t){let e=this._rootMarks.findIndex(e=>e===t);return e>=0&&(this._rootMarks.splice(e,1),!0)}_getGlobalThis(){var t;return hI(this._option.mode)?globalThis:null==(t=this.getStage())?void 0:t.window}_combineIncrementalLayers(){this._stage&&(function(t){var e,i,r,n;return e=this,i=void 0,r=void 0,n=function*(){let e=[],i=t.getChildren();yield new Promise(t=>{iC.global.getRequestAnimationFrame()(()=>{t(null)})}),i.forEach(t=>{t.subLayers.size&&t.subLayers.forEach(t=>{t.drawContribution&&t.drawContribution.hooks&&t.drawContribution.rendering&&e.push(new Promise(e=>{t.drawContribution.hooks.completeDraw.tap("outWait",()=>{t.drawContribution.hooks.completeDraw.taps=t.drawContribution.hooks.completeDraw.taps.filter(t=>"outWait"!==t.name),e(null)})}))})}),yield Promise.all(e)},new(r||(r=Promise))(function(t,l){function s(t){try{o(n.next(t))}catch(t){l(t)}}function a(t){try{o(n.throw(t))}catch(t){l(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(s,a)}o((n=n.apply(e,i||[])).next())})})(this._stage).then(()=>{this._stage&&this._stage.defaultLayer.combineSubLayer()})}findProgressiveMarks(){let t=[];return this._rootMarks.forEach(e=>{uR(e,e=>{e.isProgressive()&&t.push(e)})}),t.length?(this._progressiveMarks=t,this._combineIncrementalLayers(),t):(this._progressiveMarks=null,null)}doPreProgressive(){if(this._progressiveMarks&&this._progressiveMarks.some(t=>t.isDoingProgressive())){let t=hd.getSpecifiedRequestAnimationFrame(10);this._progressiveRafId=t(this.handleProgressiveFrame)}else this._progressiveMarks&&this._progressiveMarks.every(t=>t.canAnimateAfterProgressive())?this._progressiveMarks.forEach(t=>{t.runAnimation()}):this._progressiveMarks&&(this._progressiveMarks=null)}clearProgressive(){this._progressiveRafId&&hd.getSpecifiedCancelAnimationFrame(10)(this._progressiveRafId),this._progressiveMarks&&this._progressiveMarks.length&&(this._progressiveMarks.forEach(t=>{t.clearProgressive()}),this._progressiveMarks=null)}}var uL=i(75133),uF=i(44843);let uO={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},uH={poptip:(0,h3.Z)({},uO)};function uD(){uD.__loaded||(uD.__loaded=!0,ak.RegisterGraphicCreator("group",sG))}uD.__loaded=!1;var uz=i(90180);class uW{constructor(t,e,i){this.fontFamily=t,this.textOptions=e,this.textMeasure=i}LayoutBBox(t,e,i,r){if(t.xOffset="left"===e||"start"===e?0:"center"===e?-(t.width/2):"right"===e||"end"===e?-t.width:0,"top"===i)t.yOffset=0;else if("middle"===i)t.yOffset=-(t.height/2);else if("alphabetic"===i){let e=.79;if(1===r.length){let t=r[0];e=t.ascent/(t.ascent+t.descent)}t.yOffset=-(t.height*e)}else t.yOffset=-t.height;return t}GetLayoutByLines(t,e,i,r,n="",l,s){let{lineWidth:a,suffixPosition:o="end",measureMode:h=o0.actualBounding,keepCenterInLine:d=!1}=null!=s?s:{};t=t.map(t=>t.toString());let u=[],c=[0,0];if("number"==typeof a&&a!==1/0){let e;for(let i=0,r=t.length;i<r;i++){let r=this.textMeasure.measureTextPixelADscentAndWidth(t[i],this.textOptions,h),s=t[i].toString();if(r.width>a){let r=this.textMeasure.clipTextWithSuffix(t[i],this.textOptions,a,n,l,o);s=r.str,e=r.width}else e=r.width;u.push({str:s,width:e,ascent:r.ascent,descent:r.descent,keepCenterInLine:d})}c[0]=a}else{let e,i,r=0;for(let n=0,l=t.length;n<l;n++){i=t[n];let l=this.textMeasure.measureTextPixelADscentAndWidth(t[n],this.textOptions,h);r=Math.max(r,e=l.width),u.push({str:i,width:e,ascent:l.ascent,descent:l.descent,keepCenterInLine:d})}c[0]=r}c[1]=u.length*r,c[0]=u.reduce((t,e)=>Math.max(t,e.width),0);let p={xOffset:0,yOffset:0,width:c[0],height:c[1]};return this.LayoutBBox(p,e,i,u),this.layoutWithBBox(p,u,e,i,r)}layoutWithBBox(t,e,i,r,n){let l=[0,0],s=e.length*n;"top"===r||("middle"===r?l[1]=(t.height-s)/2:"bottom"===r&&(l[1]=t.height-s));for(let s=0;s<e.length;s++)this.lineOffset(t,e[s],i,r,n,l);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:n,textAlign:i,textBaseline:r}}lineOffset(t,e,i,r,n,l){if("left"===i||"start"===i?e.leftOffset=0:"center"===i?e.leftOffset=(t.width-e.width)/2:"right"!==i&&"end"!==i||(e.leftOffset=t.width-e.width),e.topOffset=n/2+(e.ascent-e.descent)/2+l[1],!e.keepCenterInLine){let t=e.ascent+e.descent+0;if(t<n-0&&("bottom"===r?e.topOffset+=(n-t)/2:"top"===r&&(e.topOffset-=(n-t)/2)),"alphabetic"===r){let t=n/(e.ascent+e.descent);e.topOffset=n/2+(e.ascent-e.descent)/2*t+l[1]}}return l[1]+=n,e}}let uZ=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp",...sO];class uN extends sN{get font(){let t=this.getGraphicTheme();return this._font||(this._font=(0,uz.U)(this.attribute,t)),this._font}get clipedText(){var t;let e=this.attribute,i=this.getGraphicTheme();return Number.isFinite(this.getMaxWidth(i))?(this.tryUpdateAABBBounds(),this.cache.clipedText):(null!=(t=e.text)?t:i.text).toString()}get clipedWidth(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}get cliped(){var t,e;let i=this.getGraphicTheme(),r=this.attribute;if(!Number.isFinite(this.getMaxWidth(i)))return!1;let{text:n}=this.attribute;if(this.tryUpdateAABBBounds(),null==(e=null==(t=this.cache)?void 0:t.layoutData)?void 0:e.lines){let t="";return this.cache.layoutData.lines.forEach(e=>{t+=e.str}),(Array.isArray(n)?n.join(""):n).toString()!==t}return"vertical"===r.direction&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map(t=>t.text).join("")!==r.text.toString():null!=this.clipedText&&this.clipedText!==r.text.toString()}get multilineLayout(){return this.tryUpdateAABBBounds(),this.cache.layoutData}get isMultiLine(){return Array.isArray(this.attribute.text)||"normal"===this.attribute.whiteSpace}constructor(t={text:"",fontSize:16}){super(t),this.type="text",this.numberType=sm,this.cache={}}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{text:t}=this.attribute;return(0,rD.Z)(t)?!t.every(t=>null==t||""===t):null!=t&&""!==t}getGraphicTheme(){return nP(this).text}doUpdateOBBBounds(){let t=this.getGraphicTheme();this._OBBBounds.clear();let e=this.attribute,{angle:i=t.angle}=e;if(!i){let t=this.AABBBounds;return this._OBBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._OBBBounds}this.obbText||(this.obbText=new uN({})),this.obbText.setAttributes(Object.assign(Object.assign({},e),{angle:0}));let r=this.obbText.AABBBounds,{x:n,y:l}=e,s={x:(r.x1+r.x2)/2,y:(r.y1+r.y2)/2},a=(0,aj.xj)(s,i,{x:n,y:l});return this._OBBBounds.copy(r),this._OBBBounds.translate(a.x-s.x,a.y-s.y),this._OBBBounds.angle=i,this._OBBBounds}updateAABBBounds(t,e,i){let{text:r=e.text}=this.attribute;Array.isArray(r)?this.updateMultilineAABBBounds(r):this.updateSingallineAABBBounds(r);let{tb1:n}=iC.graphicService.updateTempAABBBounds(i),{scaleX:l=e.scaleX,scaleY:s=e.scaleY,shadowBlur:a=e.shadowBlur,strokeBoundsBuffer:o=e.strokeBoundsBuffer}=t;return a&&(l6(n,a/Math.abs(l+s),!0,o),i.union(n)),iC.graphicService.combindShadowAABBBounds(i,this),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||iC.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,(0,iI.n2)(i,i,this.transMatrix),i}updateSingallineAABBBounds(t){this.updateMultilineAABBBounds([t]);let e=this.cache.layoutData;if(e&&e.lines&&e.lines.length){let t=e.lines[0];this.cache.clipedText=t.str,this.cache.clipedWidth=t.width}return this._AABBBounds}updateMultilineAABBBounds(t){let e=this.getGraphicTheme(),{direction:i=e.direction,underlineOffset:r=e.underlineOffset}=this.attribute,n="horizontal"===i?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return"horizontal"===i&&r&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+r),n}guessLineHeightBuf(t){return t?.1*t:0}updateHorizontalMultilineAABBBounds(t){var e,i;let r=this.getGraphicTheme(),n=this.attribute,{fontFamily:l=r.fontFamily,textAlign:s=r.textAlign,textBaseline:a=r.textBaseline,fontSize:o=r.fontSize,fontWeight:h=r.fontWeight,ellipsis:d=r.ellipsis,maxLineWidth:u,stroke:c=r.stroke,wrap:p=r.wrap,measureMode:g=r.measureMode,lineWidth:f=r.lineWidth,whiteSpace:m=r.whiteSpace,suffixPosition:y=r.suffixPosition,ignoreBuf:v=r.ignoreBuf,keepCenterInLine:b=r.keepCenterInLine}=n,_=v?0:this.guessLineHeightBuf(o),C=this.getLineHeight(n,r,_);if("normal"===m||p)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(null==(e=this.cache)?void 0:e.layoutData)){let t=this.cache.layoutData.bbox;return this._AABBBounds.set(t.xOffset,t.yOffset,t.xOffset+t.width,t.yOffset+t.height),c&&this._AABBBounds.expand(f/2),this._AABBBounds}let x=new uW(l,{fontSize:o,fontWeight:h,fontFamily:l,lineHeight:C},iC.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null==(i=this.stage)?void 0:i.textMeasureId))).GetLayoutByLines(t,s,a,C,!0===d?r.ellipsis:d||void 0,!1,{lineWidth:u,suffixPosition:y,measureMode:g,keepCenterInLine:b}),{bbox:w}=x;return this.cache.layoutData=x,this.clearUpdateShapeTag(),this._AABBBounds.set(w.xOffset,w.yOffset,w.xOffset+w.width,w.yOffset+w.height),c&&this._AABBBounds.expand(f/2),this._AABBBounds}updateWrapAABBBounds(t){var e,i,r,n;let l=this.getGraphicTheme(),{fontFamily:s=l.fontFamily,textAlign:a=l.textAlign,textBaseline:o=l.textBaseline,fontSize:h=l.fontSize,ellipsis:d=l.ellipsis,maxLineWidth:u,stroke:c=l.stroke,lineWidth:p=l.lineWidth,wordBreak:g=l.wordBreak,fontWeight:f=l.fontWeight,ignoreBuf:m=l.ignoreBuf,measureMode:y=l.measureMode,suffixPosition:v=l.suffixPosition,heightLimit:b=0,lineClamp:_,keepCenterInLine:C=l.keepCenterInLine}=this.attribute,x=m?0:this.guessLineHeightBuf(h),w=this.getLineHeight(this.attribute,l,x);if(!this.shouldUpdateShape()&&(null==(e=this.cache)?void 0:e.layoutData)){let t=this.cache.layoutData.bbox;return this._AABBBounds.set(t.xOffset,t.yOffset,t.xOffset+t.width,t.yOffset+t.height),c&&this._AABBBounds.expand(p/2),this._AABBBounds}let S=iC.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null==(i=this.stage)?void 0:i.textMeasureId)),A={fontSize:h,fontWeight:f,fontFamily:s,lineHeight:w},M=new uW(s,A,S),T=(0,rD.Z)(t)?t.map(t=>t.toString()):[t.toString()],k=[],R=[0,0],P=1/0;if(b>0&&(P=Math.max(Math.floor(b/w),1)),_&&(P=Math.min(P,_)),"number"==typeof u&&u!==1/0){if(u>0)for(let t=0;t<T.length;t++){let e=T[t],i=!0;if(t===P-1){let i=S.clipTextWithSuffix(e,A,u,d,!1,v,t!==T.length-1),r=S.measureTextPixelADscentAndWidth(i.str,A,y);k.push({str:i.str,width:i.width,ascent:r.ascent,descent:r.descent,keepCenterInLine:C});break}let l=S.clipText(e,A,u,"break-all"!==g,"keep-all"===g);if(""!==e&&""===l.str||l.wordBreaked){if(d){let t=S.clipTextWithSuffix(e,A,u,d,!1,v);l.str=null!=(r=t.str)?r:"",l.width=null!=(n=t.width)?n:0}else l.str="",l.width=0;i=!1}let s=S.measureTextPixelADscentAndWidth(l.str,A,y);k.push({str:l.str,width:l.width,ascent:s.ascent,descent:s.descent,keepCenterInLine:C});let a=l.str.length;if(l.wordBreaked&&(""===e||""!==l.str)&&(i=!0,a=l.wordBreaked),l.str.length===e.length);else if(i){let i=e.substring(a);"keep-all"===g&&(i=i.replace(/^\s+/g,"")),T.splice(t+1,0,i)}}let t=0;k.forEach(e=>{t=Math.max(t,e.width)}),R[0]=t}else{let t,e,i=0;for(let r=0,n=T.length;r<n;r++){if(r===P-1){let t=S.clipTextWithSuffix(T[r],A,u,d,!1,v),e=S.measureTextPixelADscentAndWidth(t.str,A,y);k.push({str:t.str,width:t.width,ascent:e.ascent,descent:e.descent,keepCenterInLine:C}),i=Math.max(i,t.width);break}e=T[r],i=Math.max(i,t=S.measureTextWidth(e,A));let n=S.measureTextPixelADscentAndWidth(e,A,y);k.push({str:e,width:t,ascent:n.ascent,descent:n.descent,keepCenterInLine:C})}R[0]=i}R[1]=k.length*w;let B={xOffset:0,yOffset:0,width:R[0],height:R[1]};M.LayoutBBox(B,a,o,k);let I=M.layoutWithBBox(B,k,a,o,w);return this.cache.layoutData=I,this.clearUpdateShapeTag(),this._AABBBounds.set(B.xOffset,B.yOffset,B.xOffset+B.width,B.yOffset+B.height),c&&this._AABBBounds.expand(p/2),this._AABBBounds}updateVerticalMultilineAABBBounds(t){var e,i,r;let n,l=this.getGraphicTheme(),s=iC.graphicUtil.getTextMeasureInstance(this.textMeasureId||(null==(e=this.stage)?void 0:e.textMeasureId)),a=this.attribute,{maxLineWidth:o=l.maxLineWidth,ellipsis:h=l.ellipsis,fontFamily:d=l.fontFamily,fontSize:u=l.fontSize,fontWeight:c=l.fontWeight,stroke:p=l.stroke,lineWidth:g=l.lineWidth,verticalMode:f=l.verticalMode,suffixPosition:m=l.suffixPosition}=a,y=this.getLineHeight(a,l,0),{textAlign:v=l.textAlign,textBaseline:b=l.textBaseline}=a;if(!f){let t=v;v=null!=(i=uN.baselineMapAlign[b])?i:"left",b=null!=(r=uN.alignMapBaseline[t])?r:"top"}if(n=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach(t=>{let e=t.reduce((t,e)=>t+e.width,0);n=(0,ik.Fp)(e,n)});let t=aS(v,n),e=this.cache.verticalList.length*y,i=aA(b,e,u);return this._AABBBounds.set(i,t,i+e,t+n),p&&this._AABBBounds.expand(g/2),this._AABBBounds}let _=t.map(t=>(function(t){let e=[],i=0,r="";for(let n=0;n<t.length;n++)!function(t){if(l9.has(t))return!0;if(st.has(t))return!1;let e=!1;return 256>t.codePointAt(0)&&(e=!0),e}(t[n])?(i&&(e.push({text:r,direction:o9.VERTICAL}),r="",i=0),e.push({text:t[n],direction:o9.HORIZONTAL})):i?r+=t[n]:(i=1,r=t[n]);return r&&e.push({text:r,direction:o9.VERTICAL}),e})(t.toString()));_.forEach((t,e)=>{if(Number.isFinite(o))if(h){let i=!0===h?l.ellipsis:h,r=s.clipTextWithSuffixVertical(t,{fontSize:u,fontWeight:c,fontFamily:d},o,i,!1,m);_[e]=r.verticalList,n=r.width}else{let i=s.clipTextVertical(t,{fontSize:u,fontWeight:c,fontFamily:d},o,!1);_[e]=i.verticalList,n=i.width}else n=0,t.forEach(t=>{let e=t.direction===o9.HORIZONTAL?u:s.measureTextWidth(t.text,{fontSize:u,fontWeight:c,fontFamily:d});n+=e,t.width=e})}),this.cache.verticalList=_,this.clearUpdateShapeTag(),this.cache.verticalList.forEach(t=>{let e=t.reduce((t,e)=>t+e.width,0);n=(0,ik.Fp)(e,n)});let C=aS(v,n),x=this.cache.verticalList.length*y,w=aA(b,x,u);return this._AABBBounds.set(w,C,w+x,C+n),p&&this._AABBBounds.expand(g/2),this._AABBBounds}getMaxWidth(t){var e,i;let r=this.attribute;return null!=(i=null!=(e=r.maxLineWidth)?e:r.maxWidth)?i:t.maxWidth}getLineHeight(t,e,i){var r;return null!=(r=n5(t.lineHeight,t.fontSize||e.fontSize))?r:(t.fontSize||e.fontSize)+i}needUpdateTags(t,e=uZ){return super.needUpdateTags(t,e)}needUpdateTag(t,e=uZ){return super.needUpdateTag(t,e)}_interpolate(t,e,i,r,n){"text"===t&&(n.text=r)}clone(){return new uN(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return uN.NOWORK_ANIMATE_ATTR}getBaselineMapAlign(){return uN.baselineMapAlign}getAlignMapBaseline(){return uN.alignMapBaseline}}function uj(t){return new uN(t)}function uG(t){return d||(d=ak.CreateGraphic("text",{})),d.initAttributes(t),d.AABBBounds}uN.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},sZ),uN.baselineMapAlign={top:"left",bottom:"right",middle:"center"},uN.alignMapBaseline={left:"top",right:"bottom",center:"middle"};let uV=new class extends op{constructor(){super(...arguments),this.time=o6.beforeFillStroke}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){var c,p,g,f,m,y,v,b,_,C;let x,{backgroundMode:w=o.backgroundMode,backgroundFit:S=o.backgroundFit,backgroundKeepAspectRatio:A=o.backgroundKeepAspectRatio}=t.attribute,M,{background:T}=t.attribute;if(!T)return;let k=()=>{"richtext"===t.type&&(e.restore(),e.save(),M&&e.setTransformFromMatrix(M,!0,1))};"richtext"===t.type&&(M=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());let R=(0,nF.Z)(T)&&T.background,P=t.transMatrix.onlyTranslate();if(R){let e=t.AABBBounds,i=(null!=(c=T.x)?c:e.x1)+(null!=(p=T.dx)?p:0),r=(null!=(g=T.y)?g:e.y1)+(null!=(f=T.dy)?f:0),n=null!=(m=T.width)?m:e.width(),l=null!=(y=T.height)?y:e.height();if(x=aJ.allocate(i,r,i+n,r+l),T=T.background,!P){let t=x.width(),e=x.height();x.set((null!=(v=T.x)?v:0)+(null!=(b=T.dx)?b:0),(null!=(_=T.y)?_:0)+(null!=(C=T.dy)?C:0),t,e)}}else x=t.AABBBounds,P||(x=uG(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){let n=t.resources.get(T);if("success"!==n.state||!n.data)return void k();e.highPerformanceSave(),P&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,r,o),this.doDrawImage(e,n.data,x,{backgroundMode:w,backgroundFit:S,backgroundKeepAspectRatio:A}),e.highPerformanceRestore(),e.setTransformForCurrent()}else{let{backgroundCornerRadius:n}=t.attribute;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,o),e.fillStyle=T,n?(a3(e,x.x1,x.y1,x.width(),x.height(),n,!0),e.fill()):e.fillRect(x.x1,x.y1,x.width(),x.height()),e.highPerformanceRestore()}R&&aJ.free(x),k()}};var uU=function(t,e){return function(i,r){e(i,r,t)}};let uK=class extends ox{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=sm,this.builtinContributions=[uV],this.init(t)}drawShape(t,e,i,r,n,l,s,a){var o,h,d;let u=nP(t,null==l?void 0:l.theme).text,{text:c,underline:p=u.underline,lineThrough:g=u.lineThrough,keepDirIn3d:f=u.keepDirIn3d,direction:m=u.direction,fontSize:y=u.fontSize,verticalMode:v=u.verticalMode,x:b=u.x,y:_=u.y}=t.attribute,C=null!=(o=n5(t.attribute.lineHeight,y))?o:y,x=this.valid(t,u,s,a);if(!x)return;let{fVisible:w,sVisible:S,doFill:A,doStroke:M}=x,T=!f,k=this.z||0;e.beginPath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),this.beforeRenderStep(t,e,i,r,A,M,w,S,u,n,s,a),T&&this.transformUseContext2d(t,u,k,e);let R=(n,l,o,h)=>{let d=i+l,c=r+o;if(h){e.highPerformanceSave(),d+=y;let t=sR.allocate(1,0,0,1,0,0);t.rotateByCenter(Math.PI/2,d,c),e.transformFromMatrix(t,!0),sR.free(t)}M&&(a?a(e,t.attribute,u):S&&(e.setStrokeStyle(t,t.attribute,b-i,_-r,u),e.strokeText(n,d,c,k))),A&&(s?s(e,t.attribute,u):w&&(e.setCommonStyle(t,t.attribute,b-i,_-r,u),e.fillText(n,d,c,k))),h&&(e.highPerformanceRestore(),e.setTransformForCurrent())};if(e.setTextStyleWithoutAlignBaseline(t.attribute,u,k),"horizontal"===m){let{multilineLayout:n}=t;if(!n)return void e.highPerformanceRestore();let{xOffset:l,yOffset:o}=n.bbox;M&&(a?a(e,t.attribute,u):S&&(e.setStrokeStyle(t,t.attribute,b-i,_-r,u),n.lines.forEach(t=>{e.strokeText(t.str,(t.leftOffset||0)+l+i,(t.topOffset||0)+o+r,k)}))),A&&(s?s(e,t.attribute,u):w&&(e.setCommonStyle(t,t.attribute,b-i,_-r,u),n.lines.forEach(n=>{e.fillText(n.str,(n.leftOffset||0)+l+i,(n.topOffset||0)+o+r,k),this.drawUnderLine(p,g,t,(n.leftOffset||0)+l+i,(n.topOffset||0)+o+r,n.descent,(n.descent-n.ascent)/2,k,u,e,{width:n.width})})))}else{let{textAlign:i=u.textAlign,textBaseline:r=u.textBaseline}=t.attribute;if(!v){let e=i;i=null!=(h=t.getBaselineMapAlign()[r])?h:"left",r=null!=(d=t.getAlignMapBaseline()[e])?d:"top"}t.tryUpdateAABBBounds();let{verticalList:n}=t.cache;e.textAlign="left",e.textBaseline="top";let l=C*n.length,s=0;n.forEach(t=>{let e=t.reduce((t,e)=>t+(e.width||0),0);s=(0,ik.Fp)(e,s)});let a=0,o=0;"bottom"===r?o=-l:"middle"===r&&(o=-l/2),"center"===i?a-=s/2:"right"===i&&(a-=s),n.forEach((t,e)=>{let r=t.reduce((t,e)=>t+(e.width||0),0),n=s-r,h=a;"center"===i?h+=n/2:"right"===i&&(h+=n),t.forEach(t=>{let{text:i,width:r,direction:n}=t;R(i,l-(e+1)*C+o,h,n),h+=r})})}T&&this.restoreTransformUseContext2d(t,u,k,e),this.afterRenderStep(t,e,i,r,A,M,w,S,u,n,s,a)}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).text,{keepDirIn3d:l=n.keepDirIn3d}=t.attribute;this._draw(t,n,!l,i,r)}drawUnderLine(t,e,i,r,n,l,s,a,o,h,d){if(e+t<=0)return;let{textAlign:u=o.textAlign,fill:c=o.fill,opacity:p=o.opacity,underlineOffset:g=o.underlineOffset,underlineDash:f=o.underlineDash,fillOpacity:m=o.fillOpacity}=i.attribute,y=!(0,nB.Z)(d),v=y?d.width:i.clipedWidth,b=y?0:aS(u,v),_={lineWidth:0,stroke:c,opacity:p,strokeOpacity:m};if(t){_.lineWidth=t,h.setStrokeStyle(i,_,r,n,o),f&&h.setLineDash(f),h.beginPath();let e=n+l+g;h.moveTo(r+b,e,a),h.lineTo(r+b+v,e,a),h.stroke()}if(e){_.lineWidth=e,h.setStrokeStyle(i,_,r,n,o),h.beginPath();let t=n+s;h.moveTo(r+b,t,a),h.lineTo(r+b+v,t,a),h.stroke()}}};uK=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),uU(0,it(ii)),uU(0,ie(od)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],uK);let uX=!1,uY=new eQ(t=>{uX||(uX=!0,t(ar).to(uK).inSingletonScope(),t(s4).toService(ar),t(od).toService(of),il(t,od))}),u$=hR(),uq=Symbol.for("MathPickerContribution"),uJ=Symbol.for("MathArcPicker"),uQ=Symbol.for("MathAreaPicker"),u0=Symbol.for("MathCirclePicker"),u1=Symbol.for("MathImagePicker"),u2=Symbol.for("MathLinePicker"),u3=Symbol.for("MathPathPicker"),u5=Symbol.for("MathRectPicker"),u4=Symbol.for("MathSymbolPicker"),u6=Symbol.for("MathTextPicker"),u7=Symbol.for("MathPolygonPicker"),u8=Symbol.for("MathGlyphPicker"),u9=Symbol.for("CanvasArcPicker"),ct=Symbol.for("CanvasArc3dPicker"),ce=Symbol.for("CanvasAreaPicker"),ci=Symbol.for("CanvasCirclePicker"),cr=Symbol.for("CanvasImagePicker");Symbol.for("CanvasGifImagePicker");let cn=Symbol.for("CanvasLinePicker");Symbol.for("CanvasLottiePicker");let cl=Symbol.for("CanvasPathPicker"),cs=Symbol.for("CanvasRectPicker"),ca=Symbol.for("CanvasRect3dPicker"),co=Symbol.for("CanvasSymbolPicker"),ch=Symbol.for("CanvasTextPicker"),cd=Symbol.for("CanvasPolygonPicker"),cu=Symbol.for("CanvasPyramid3dPicker"),cc=Symbol.for("CanvasRichTextPicker"),cp=Symbol.for("CanvasGlyphPicker"),cg=Symbol.for("CanvasGroupPicker");Symbol.for("CanvasStarPicker");let cf=Symbol.for("CanvasPickerContribution");class cm extends ox{contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.getGraphicTheme();r.highPerformanceSave();let{x:l,y:s,z:a,lastModelMatrix:o}=this.transform(t,n,r),h=e;if(r.camera){h=e.clone();let i=t.parent.globalTransMatrix;h.x=i.a*e.x+i.c*e.y+i.e,h.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=a;let d=!1;return this.canvasRenderer.drawShape(t,r,l,s,i,null,(t,e,i)=>!!d||(d=t.isPointInPath(h.x,h.y))),this.canvasRenderer.z=0,r.modelMatrix!==o&&sP.free(r.modelMatrix),r.modelMatrix=o,r.highPerformanceRestore(),d}}let cy=class extends cm{constructor(t){super(),this.canvasRenderer=t,this.type="text",this.numberType=sm}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.AABBBounds;if(!r.camera)return!!n.containsPoint(e);r.highPerformanceSave();let l=t.getGraphicTheme(),{keepDirIn3d:s=l.keepDirIn3d}=t.attribute,{x:a,y:o,z:h,lastModelMatrix:d}=this.transform(t,l,r,!s);this.canvasRenderer.z=h;let u=e;if(r.camera){u=e.clone();let i=t.parent.globalTransMatrix;u.x=i.a*e.x+i.c*e.y+i.e,u.y=i.b*e.x+i.d*e.y+i.f}let c=!1;return this.canvasRenderer.drawShape(t,r,a,o,{},null,(e,i,r)=>{if(c)return!0;let{fontSize:n=l.fontSize,textBaseline:s=l.textBaseline,textAlign:d=l.textAlign}=t.attribute,p=t.AABBBounds,g=p.height(),f=p.width(),m=aA(s,g,n),y=aS(d,f);return e.rect(y+a,m+o,f,g,h),c=e.isPointInPath(u.x,u.y)},(t,e,i)=>c),this.canvasRenderer.z=0,r.modelMatrix!==d&&sP.free(r.modelMatrix),r.modelMatrix=d,r.highPerformanceRestore(),c}};cy=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(O=it(ar),function(t,e){O(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],cy);let cv=!1,cb=new eQ((t,e,i,r)=>{cv||(cv=!0,t(ch).to(cy).inSingletonScope(),t(cf).toService(ch))}),c_=class{constructor(){this.type="text",this.numberType=sm}contains(t,e,i){return!!t.AABBBounds.containsPoint(e)}};c_=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],c_);let cC=!1,cx=new eQ((t,e,i,r)=>{cC||(cC=!0,t(u6).to(c_).inSingletonScope(),t(uq).toService(u6))});function cw(){cw.__loaded||(cw.__loaded=!0,ak.RegisterGraphicCreator("text",uj),ib.load(uY),ib.load(u$?cb:cx))}cw.__loaded=!1;let cS=new class{constructor(){this.time=o6.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){let c=t.getParsedPath();if(!c)return;let{outerBorder:p,innerBorder:g}=t.attribute,f=p&&!1!==p.visible,m=g&&!1!==g.visible;if(!f&&!m)return;let{size:y=o.size,opacity:v=o.opacity,x:b=o.x,y:_=o.y,scaleX:C=o.scaleX,scaleY:x=o.scaleY,keepStrokeScale:w=o.keepStrokeScale}=t.attribute,S=(n,l)=>{let s=!(!n||!n.stroke),{distance:a=o[l].distance}=n,h=w?a:rZ(e,a,e.dpr);if(e.beginPath(),!1===c.drawOffset(e,y,i,r,("outerBorder"===l?1:-1)*h)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),u)u(e,n,o[l]);else if(s){let s=o[l].opacity;o[l].opacity=v,e.setStrokeStyle(t,n,(b-i)/C,(_-r)/x,o[l]),o[l].opacity=s,e.stroke()}};f&&S(p,"outerBorder"),m&&S(g,"innerBorder")}},cA=new class{constructor(){this.time=o6.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{clipRange:p=o.clipRange,x:g=o.x,y:f=o.y,z:m=o.z,size:y=o.size,scaleX:v=o.scaleX,scaleY:b=o.scaleY}=t.attribute,_=t.getParsedPath();_&&p<1&&p>0&&(e.beginPath(),_.drawWithClipRange&&_.drawWithClipRange(e,y,i,r,p,m,(n,l)=>{var s,h,d,c;if(t._parsedPath.svgCache){let e=Object.assign({},l);e.fill=null!=(s=l.fill)?s:t.attribute.fill,e.opacity=null!=(h=l.opacity)?h:t.attribute.opacity,e.fillOpacity=t.attribute.fillOpacity,e.stroke=null!=(d=l.stroke)?d:t.attribute.stroke,e.lineWidth=null!=(c=l.lineWidth)?c:t.attribute.lineWidth,l=e}l.stroke&&(u?u(e,t.attribute,o):a&&(e.setStrokeStyle(t,l,(g-i)/v,(f-r)/b,o),e.stroke()))}),l&&!_.isSvg&&(u?u(e,t.attribute,o):a&&(e.setStrokeStyle(t,t.attribute,(g-i)/v,(f-r)/b,o),e.stroke())))}};var cM=function(t,e){return function(i,r){e(i,r,t)}};let cT=class extends ox{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=sf,this.builtinContributions=[cS,og,oL,cA],this.init(t)}drawShape(t,e,i,r,n,l,s,a,o){var h;o=null!=o?o:nP(t,null==l?void 0:l.theme).symbol;let{size:d=o.size,x:u=o.x,y:c=o.y,scaleX:p=o.scaleX,scaleY:g=o.scaleY,fillStrokeOrder:f=o.fillStrokeOrder,clipRange:m=o.clipRange}=t.attribute,y=this.valid(t,o,s,a);if(!y)return;let{fVisible:v,sVisible:b,doFill:_,doStroke:C}=y,x=t.getParsedPath();if(!x)return;let{keepDirIn3d:w=o.keepDirIn3d}=t.attribute,S=null!=(h=this.z)?h:0;e.beginPath();let A=i,M=r,T=S,k=e.camera;if(w&&k&&e.project){let t=e.project(i,r,S);e.camera=null,(0,rD.Z)(d)&&(d[0],d[1]),A=t.x,M=t.y,T=void 0}!1===x.draw(e,d,A,M,T,(n,l)=>{var h,d,y,v;if(t._parsedPath.svgCache){let e=Object.assign({},l);e.fill=null!=(h=l.fill)?h:t.attribute.fill,e.opacity=null!=(d=l.opacity)?d:t.attribute.opacity,e.fillOpacity=t.attribute.fillOpacity,e.stroke=null!=(y=l.stroke)?y:t.attribute.stroke,e.lineWidth=null!=(v=l.lineWidth)?v:t.attribute.lineWidth,l=e}let _=()=>{l.fill&&(s?s(e,t.attribute,o):(e.setCommonStyle(t,l,u-i,c-r,o),e.fill()))},C=()=>{l.stroke&&(a?a(e,t.attribute,o):b&&m>=1&&(e.setStrokeStyle(t,l,(u-i)/p,(c-r)/g,o),e.stroke()))};f?(C(),_()):(_(),C())})&&e.closePath(),e.camera=k,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,_,C,v,b,o,n,s,a),f?(this._runStroke(t,e,i,r,o,C,b,u,c,x,m,p,g,a),this._runFill(t,e,i,r,o,_,v,u,c,x,s)):(this._runFill(t,e,i,r,o,_,v,u,c,x,s),this._runStroke(t,e,i,r,o,C,b,u,c,x,m,p,g,a)),this.afterRenderStep(t,e,i,r,_,C,v,b,o,n,s,a)}_runFill(t,e,i,r,n,l,s,a,o,h,d){l&&!h.isSvg&&(d?d(e,t.attribute,n):s&&(e.setCommonStyle(t,t.attribute,a-i,o-r,n),e.fill()))}_runStroke(t,e,i,r,n,l,s,a,o,h,d,u,c,p){l&&!h.isSvg&&(p?p(e,t.attribute,n):s&&d>=1&&(e.setStrokeStyle(t,t.attribute,(a-i)/u,(o-r)/c,n),e.stroke()))}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).symbol;this._draw(t,n,!1,i,r)}};cT=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),cM(0,it(ii)),cM(0,ie(oh)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],cT);let ck=!1,cR=new eQ(t=>{ck||(ck=!0,t(cT).toSelf().inSingletonScope(),t(ai).to(cT).inSingletonScope(),t(s4).toService(ai),t(oh).toService(of),il(t,oh))}),cP=class extends cm{constructor(t){super(),this.canvasRenderer=t,this.type="symbol",this.numberType=sf}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.getParsedPath();if(!r.camera){if(!t.AABBBounds.containsPoint(e))return!1;if(n.isSvg||"imprecise"===t.attribute.pickMode)return!0}r.highPerformanceSave();let l=t.getGraphicTheme(),{x:s,y:a,z:o,lastModelMatrix:h}=this.transform(t,l,r),d=e;if(r.camera){d=e.clone();let i=t.parent.globalTransMatrix;d.x=i.a*e.x+i.c*e.y+i.e,d.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let u=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,e,i)=>!!u||(u=t.isPointInPath(d.x,d.y)),(t,e,i)=>{if(u)return!0;let n=e.lineWidth||i.lineWidth,l=e.pickStrokeBuffer||i.pickStrokeBuffer;return r.lineWidth=e.keepStrokeScale||i.keepStrokeScale?n+l:rZ(r,n+l,r.dpr),u=t.isPointInStroke(d.x,d.y)}),this.canvasRenderer.z=0,r.modelMatrix!==h&&sP.free(r.modelMatrix),r.modelMatrix=h,r.highPerformanceRestore(),u}};cP=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(H=it(ai),function(t,e){H(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],cP);let cB=!1,cI=new eQ((t,e,i,r)=>{cB||(cB=!0,t(co).to(cP).inSingletonScope(),t(cf).toService(co))});class cE{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode||!this.canvasRenderer)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.getGraphicTheme();r.highPerformanceSave();let{x:l=n.x,y:s=n.y}=t.attribute;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);l+=e.x,s+=e.y,r.setTransformForCurrent()}else l=0,s=0,r.transformFromMatrix(t.transMatrix,!0);let a=!1,o=!1;return this.canvasRenderer.drawShape(t,r,l,s,{},null,(t,i,r,n)=>!(!a&&!o)||(a=t.isPointInPath(e.x,e.y),o=n||o,a),(t,i,n,l)=>{if(a||o)return!0;let s=i.lineWidth||n.lineWidth,h=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=i.keepStrokeScale||n.keepStrokeScale?s+h:rZ(r,s+h,r.dpr),a=t.isPointInStroke(e.x,e.y),o=l||o,a}),r.highPerformanceRestore(),a}}let cL=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="symbol",this.numberType=sf}};cL=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(D=it(ai),function(t,e){D(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],cL);let cF=!1,cO=new eQ((t,e,i,r)=>{cF||(cF=!0,t(u4).to(cL).inSingletonScope(),t(uq).toService(u4))});function cH(){cH.__loaded||(cH.__loaded=!0,ak.RegisterGraphicCreator("symbol",oI),ib.load(cR),ib.load(u$?cI:cO))}cH.__loaded=!1;let cD=t=>{if(!t)return{x:0,y:0,width:0,height:0};let e=(0,nB.Z)(t.width)?t.x1-t.x:t.width,i=(0,nB.Z)(t.height)?t.y1-t.y:t.height,r=0,n=0;return e<0?(r=e,e=-e):Number.isNaN(e)&&(e=0),i<0?(n=i,i=-i):Number.isNaN(i)&&(i=0),{x:r,y:n,width:e,height:i}},cz=(t,e,i)=>{let{outerBorder:r,shadowBlur:n=e.shadowBlur}=t;if(r){let t=e.outerBorder,{distance:l=t.distance,lineWidth:s=t.lineWidth}=r;i.expand(l+(n+s)/2)}return i},cW=["width","x1","y1","height","cornerRadius",...sO];class cZ extends sN{constructor(t){super(t),this.type="rect",this.numberType=sc}isValid(){return super.isValid()&&this._isValid()}_isValid(){return!0}getGraphicTheme(){return nP(this).rect}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let{width:e,height:r}=t,{x1:n,y1:l,x:s,y:a}=t;e=null!=e?e:n-s,r=null!=r?r:l-a,(isFinite(e)||isFinite(r)||isFinite(s)||isFinite(a))&&i.set(0,0,e||0,r||0)}let{tb1:r,tb2:n}=iC.graphicService.updateTempAABBBounds(i);return cz(t,e,r),i.union(r),r.setValue(n.x1,n.y1,n.x2,n.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,iC.graphicService.transformAABBBounds(t,i,e,!1,this),i}needUpdateTags(t){return super.needUpdateTags(t,cW)}needUpdateTag(t){return super.needUpdateTag(t,cW)}toCustomPath(){let t=super.toCustomPath();if(t)return t;let{x:e,y:i,width:r,height:n}=cD(this.attribute);return(t=new rp).moveTo(e,i),t.rect(e,i,r,n),t}clone(){return new cZ(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return cZ.NOWORK_ANIMATE_ATTR}}function cN(t){return new cZ(t)}cZ.NOWORK_ANIMATE_ATTR=sZ;var cj=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s};class cG{constructor(){this.time=o6.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{cornerRadius:m=o.cornerRadius,cornerType:y=o.cornerType,opacity:v=o.opacity,x:b=o.x,y:_=o.y,scaleX:C=o.scaleX,scaleY:x=o.scaleY,x1:w,y1:S,keepStrokeScale:A=o.keepStrokeScale}=t.attribute,{width:M,height:T}=t.attribute;M=(null!=M?M:w-i)||0,T=(null!=T?T:S-r)||0;let k=(n,l)=>{let s=!(!n||!n.stroke),a="outerBorder"===l?-1:1,{distance:h=o[l].distance}=n,d=A?h:rZ(e,h,e.dpr),c=i+a*d,p=r+a*d,g=2*d;if(0===m||(0,rD.Z)(m)&&m.every(t=>0===t)?(e.beginPath(),e.rect(c,p,M-a*g,T-a*g)):(e.beginPath(),a3(e,c,p,M-a*g,T-a*g,m,"bevel"!==y)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),u)u(e,n,o[l]);else if(s){let s=o[l].opacity;o[l].opacity=v,e.setStrokeStyle(t,n,(b-i)/C,(_-r)/x,o[l]),o[l].opacity=s,e.stroke()}};g&&k(c,"outerBorder"),f&&k(p,"innerBorder")}}let cV=class{constructor(){this.time=o6.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{stroke:p=o.stroke}=t.attribute;Array.isArray(p)&&p.some(t=>!1===t)&&(c.doStroke=!1)}};cV=cj([e6()],cV);let cU=class{constructor(){this.time=o6.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){let{x1:c,y1:p,x:g=o.x,y:f=o.y,stroke:m=o.stroke,cornerRadius:y=o.cornerRadius,cornerType:v=o.cornerType}=t.attribute,{width:b,height:_}=t.attribute;if(b=(null!=b?b:c-g)||0,_=(null!=_?_:p-f)||0,Array.isArray(m)&&m.some(t=>!1===t)){if(e.setStrokeStyle(t,t.attribute,i,r,o),!(0===y||(0,rD.Z)(y)&&y.every(t=>0===t))){let n,l=0;return a3(e,i,r,b,_,y,"bevel"!==v,[,,,,].fill(0).map((s,a)=>(s,h,d,u)=>{m[a]&&(l===a-1&&m[a]===n||(e.setStrokeStyle(t,Object.assign(Object.assign({},t.attribute),{stroke:m[a]}),i,r,o),e.beginPath(),e.moveTo(s,h),n=m[a]),l=a,e.lineTo(d,u),e.stroke(),3===a&&e.beginPath())})),void e.stroke()}if(e.beginPath(),e.moveTo(i,r),m[0]?e.lineTo(i+b,r):e.moveTo(i+b,r),m[1]?e.lineTo(i+b,r+_):e.moveTo(i+b,r+_),m[2]?e.lineTo(i,r+_):e.moveTo(i,r+_),m[3]){let t=m[0]?r-e.lineWidth/2:r;e.lineTo(i,t)}else e.moveTo(i,r);e.stroke()}}};cU=cj([e6()],cU);let cK=new cG;var cX=function(t,e){return function(i,r){e(i,r,t)}};let cY=class extends ox{constructor(t){super(),this.graphicRenderContributions=t,this.type="rect",this.numberType=sc,this.builtinContributions=[cK,og,oL],this.init(t)}drawShape(t,e,i,r,n,l,s,a,o){o=null!=o?o:nP(t,null==l?void 0:l.theme).rect;let{fill:h=o.fill,background:d,stroke:u=o.stroke,cornerRadius:c=o.cornerRadius,cornerType:p=o.cornerType,opacity:g=o.opacity,fillOpacity:f=o.fillOpacity,lineWidth:m=o.lineWidth,strokeOpacity:y=o.strokeOpacity,visible:v=o.visible,x1:b,y1:_,x:C=o.x,y:x=o.y,fillStrokeOrder:w=o.fillStrokeOrder,drawStrokeWhenZeroWH:S=o.drawStrokeWhenZeroWH}=t.attribute,{width:A,height:M}=t.attribute,T=a6(g,f,A=(null!=A?A:b-C)||0,M=(null!=M?M:_-x)||0,h),k=a7(g,y,A,M,S),R=!(!h&&!d),P=a5(u,m);if(!t.valid||!v||!R&&!P||!(T||k||s||a||d))return;0===c||(0,rD.Z)(c)&&c.every(t=>0===t)?(e.beginPath(),e.rect(i,r,A,M)):(e.beginPath(),a3(e,i,r,A,M,c,"bevel"!==p));let B={doFill:R,doStroke:P};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,R,P,T,k,o,n,s,a,B),w?(this._runStroke(t,e,i,r,o,B,k,C,x,a),this._runFill(t,e,i,r,o,B,T,C,x,s)):(this._runFill(t,e,i,r,o,B,T,C,x,s),this._runStroke(t,e,i,r,o,B,k,C,x,a)),this.afterRenderStep(t,e,i,r,R,P,T,k,o,n,s,a)}_runFill(t,e,i,r,n,l,s,a,o,h){l.doFill&&(h?h(e,t.attribute,n):s&&(e.setCommonStyle(t,t.attribute,a-i,o-r,n),e.fill()))}_runStroke(t,e,i,r,n,l,s,a,o,h){l.doStroke&&(h?h(e,t.attribute,n):s&&(e.setStrokeStyle(t,t.attribute,a-i,o-r,n),e.stroke()))}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).rect;this._draw(t,n,!1,i,r,n)}};cY=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),cX(0,it(ii)),cX(0,ie(oo)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],cY);let c$=!1,cq=new eQ(t=>{c$||(c$=!0,t(cY).toSelf().inSingletonScope(),t(at).to(cY).inSingletonScope(),t(s4).toService(at),t(cU).toSelf(),t(cV).toSelf(),t(oo).toService(cU),t(oo).toService(cV),t(oo).toService(of),il(t,oo))}),cJ=new iI.FB;class cQ{constructor(){this.type="rect",this.numberType=sc}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.getGraphicTheme(),{cornerRadius:l=n.cornerRadius}=t.attribute,{x:s=n.x,y:a=n.y}=t.attribute;r.highPerformanceSave();let o=!0;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,o=!1,r.transformFromMatrix(t.transMatrix,!0);let h=!0;if(!o||t.shadowRoot||(0,n4.Z)(l,!0)&&0!==l||(0,rD.Z)(l)&&l.some(t=>0!==t))h=!1,this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,i,r)=>!!h||(h=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(h)return!0;let l=i.lineWidth||n.lineWidth,s=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=i.keepStrokeScale||n.keepStrokeScale?l+s:rZ(r,l+s,r.dpr),h=t.isPointInStroke(e.x,e.y)});else{let{fill:i=n.fill,stroke:r=n.stroke,lineWidth:l=n.lineWidth}=t.attribute;if(i)h=!0;else if(r){let i=t.AABBBounds;cJ.setValue(i.x1,i.y1,i.x2,i.y2),cJ.expand(-l/2),h=!cJ.containsPoint(e)}}return r.highPerformanceRestore(),h}}let c0=class extends cQ{constructor(t){super(),this.canvasRenderer=t}};c0=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(z=it(at),function(t,e){z(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],c0);let c1=!1,c2=new eQ((t,e,i,r)=>{c1||(c1=!0,t(cs).to(c0).inSingletonScope(),t(cf).toService(cs))}),c3=class extends cQ{constructor(t){super(),this.canvasRenderer=t}};c3=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(W=it(at),function(t,e){W(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],c3);let c5=!1,c4=new eQ((t,e,i,r)=>{c5||(c5=!0,t(u5).to(c3).inSingletonScope(),t(uq).toService(u5))});function c6(){c6.__loaded||(c6.__loaded=!0,ak.RegisterGraphicCreator("rect",cN),ib.load(cq),ib.load(u$?c2:c4))}c6.__loaded=!1;let c7=c6;function c8(t){t.crosshair=(0,a1.IX)(t.crosshair||{}).map(e=>h5({["horizontal"===t.direction?"yField":"xField"]:{visible:!0,line:{visible:!0,type:"rect"}}},e))}function c9(t,e,i){var r;let{width:n,height:l}=t;if((0,aw.Z)(n)&&(0,aw.Z)(l))return{width:n,height:l};let s=i.width,a=i.height,o=e.container,h=e.canvas;if(o){let{width:t,height:e}=(0,ax.Op)(o,i.width,i.height);s=t,a=e}else if(h&&hI(e.mode)){let t;t=(0,nI.Z)(h)?hd.getElementById(h):h;let{width:e,height:r}=(0,ax.Op)(t,i.width,i.height);s=e,a=r}else if(hL(e.mode)&&(null==(r=e.modeParams)?void 0:r.domref)){let t=e.modeParams.domref;s=t.width,a=t.height}return{width:s=null!=n?n:s,height:a=null!=l?l:a}}function pt(t,...e){let i=i=>e.reduce((t,e)=>t||(null==e?void 0:e[i]),t[i]);return Object.assign(t,{change:i("change"),reCompile:i("reCompile"),reMake:i("reMake"),reRender:i("reRender"),reSize:i("reSize"),reTransformSpec:i("reTransformSpec"),changeTheme:i("changeTheme"),changeBackground:i("changeBackground")}),t}function pe(t,e){return"line"===t||"area"===t||"common"===t&&e.series.every(t=>"area"===t.type||"line"===t.type)?{paddingInner:1,paddingOuter:0}:{paddingOuter:0}}let pi=9,pr=0,pn=-1;(Z=ts||(ts={}))[Z.SeriesGroup=0]="SeriesGroup",Z[Z.Axis_Grid=50]="Axis_Grid",Z[Z.CrossHair_Grid=100]="CrossHair_Grid",Z[Z.Region=450]="Region",Z[Z.Mark=300]="Mark",Z[Z.Node=400]="Node",Z[Z.Axis=100]="Axis",Z[Z.MarkLine=500]="MarkLine",Z[Z.MarkArea=100]="MarkArea",Z[Z.MarkPoint=500]="MarkPoint",Z[Z.DataZoom=500]="DataZoom",Z[Z.ScrollBar=500]="ScrollBar",Z[Z.Player=500]="Player",Z[Z.Legend=500]="Legend",Z[Z.CrossHair=500]="CrossHair",Z[Z.Indicator=500]="Indicator",Z[Z.Title=500]="Title",Z[Z.Label=500]="Label",Z[Z.Brush=500]="Brush",Z[Z.CustomMark=500]="CustomMark",Z[Z.Interaction=700]="Interaction",(N=ta||(ta={}))[N.Indicator=10]="Indicator",N[N.Region=20]="Region",N[N.Axis=30]="Axis",N[N.DataZoom=40]="DataZoom",N[N.Player=40]="Player",N[N.ScrollBar=40]="ScrollBar",N[N.Legend=50]="Legend",N[N.Title=70]="Title",N[N.CustomMark=70]="CustomMark",(j=to||(to={}))[j.Default=0]="Default",j[j.Theme=1]="Theme",j[j.Chart=2]="Chart",j[j.Base_Series=3]="Base_Series",j[j.Series=4]="Series",j[j.Mark=5]="Mark",j[j.User_Chart=6]="User_Chart",j[j.User_Series=7]="User_Series",j[j.User_Mark=8]="User_Mark",j[j.User_SeriesStyle=9]="User_SeriesStyle",j[j.Built_In=99]="Built_In";class pl{constructor(){this._children=[],this._markNameMap={},this._infoMap=new Map}getMarkNameMap(){return this._markNameMap}addMark(t,e){(0,nB.Z)(t)||(this._children.push(t),this._markNameMap[t.name]=t,this._infoMap.set(t,(0,h3.Z)({},pl.defaultMarkInfo,e)))}removeMark(t){let e=this._children.findIndex(e=>e.name===t);e>=0&&(this._infoMap.delete(this._children[e]),delete this._markNameMap[t],this._children.splice(e,1))}clear(){this._children=[],this._markNameMap={},this._infoMap.clear()}forEach(t){this._children.forEach(t)}includes(t,e){return this._children.includes(t,e)}get(t){return isNaN(Number(t))?this._markNameMap[t]:this._children[t]}getMarks(){return this._children.slice()}getMarksInType(t){let e=(0,a1.IX)(t);return this._children.filter(t=>e.includes(t.type))}getMarkInId(t){return this._children.find(e=>e.id===t)}getMarkWithInfo(t){return this._children.find(e=>Object.keys(t).every(i=>t[i]===this._infoMap.get(e)[i]))}}pl.defaultMarkInfo={};class ps{getOption(){return this._option}constructor(t){this._option=t,this.getCompiler=this._option.getCompiler}getStage(){var t;return null==(t=this.getCompiler())?void 0:t.getStage()}release(){this._option=null,this.getCompiler=null}}class pa{constructor(t){this._option=t,this.type=t.type}_initTheme(t,e){return this._theme=this.getTheme(t,e),this._mergeThemeToSpec(t,e)}getTheme(t,e){}transformSpec(t,e,i){this._transformSpecBeforeMergingTheme(t,e,i);let r=this._initTheme(t,e);return this._transformSpecAfterMergingTheme(r.spec,e,i),r}_transformSpecBeforeMergingTheme(t,e,i){}_transformSpecAfterMergingTheme(t,e,i){}_mergeThemeToSpec(t,e){let i=this._theme;if(this._shouldMergeThemeToSpec()){let r=this._getDefaultSpecFromChart(e),n=t=>h5({},i,r,t);return(0,rD.Z)(t)?{spec:t.map(t=>n(t)),theme:i}:{spec:n(t),theme:i}}return{spec:t,theme:i}}_shouldMergeThemeToSpec(){return!0}_getDefaultSpecFromChart(t){}}let po=(t,e)=>t===e||!(0,nz.Z)(t)&&!(0,nz.Z)(e)&&((0,rD.Z)(t)&&(0,rD.Z)(e)?e.every(e=>t.some(t=>po(t,e))):!(!(0,nF.Z)(t)||!(0,nF.Z)(e))&&Object.keys(e).every(i=>po(t[i],e[i]))),ph=(t,e,i)=>{if((0,nB.Z)(e))return t;let r=e[0];return(0,nB.Z)(r)?t:1===e.length?(t[r]=i,t):((0,nB.Z)(t[r])&&("number"==typeof e[1]?t[r]=[]:t[r]={}),ph(t[r],e.slice(1),i))},pd=(t,e,i)=>{if(!(0,nB.Z)(e))return(0,dx.Z)(t,e,i)};var pu=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class pc extends ps{getSpec(){return this._spec||{}}getSpecPath(){var t;return null==(t=this._option)?void 0:t.specPath}getSpecInfoPath(){var t,e,i;return null!=(e=null==(t=this._option)?void 0:t.specInfoPath)?e:null==(i=this._option)?void 0:i.specPath}getData(){return this._data}get layout(){return this._layout}getOption(){return this._option}getMarks(){var t,e;return null!=(e=null==(t=this._marks)?void 0:t.getMarks())?e:[]}getMarkNameMap(){var t;return null==(t=this._marks)?void 0:t.getMarkNameMap()}getMarkSet(){return this._marks}getChart(){return this._option.getChart()}get _theme(){var t;return null==(t=this.getSpecInfo())?void 0:t.theme}constructor(t,e){var i;super(e),this.transformerConstructor=pa,this.type="null",this.modelType="null",this.userId=void 0,this._data=null,this._layout=null,this.specKey="",this._marks=new pl,this._lastLayoutRect=null,this.id=hm(),this.userId=t.id,this._spec=t,this.effect={},this.event=new dv(e.eventDispatcher,e.mode),null==(i=e.map)||i.set(this.id,this)}_releaseEvent(){this.event.release()}created(){this.setAttrFromSpec()}init(t){}afterInit(){}getVisible(){var t;return!1!==(null==(t=this._spec)?void 0:t.visible)}onLayoutStart(t,e){var i;null==(i=this._layout)||i.onLayoutStart(t,e)}onLayoutEnd(){var t;null==(t=this._layout)||t.onLayoutEnd(),this.getMarks().forEach(t=>t.commit(!1,!0))}onEvaluateEnd(t){}onBeforeRender(){}onDataUpdate(){}beforeRelease(){}clear(){this.getMarks().forEach(t=>{var e;return null==(e=t.clear)?void 0:e.call(t)})}release(){var t;this._releaseEvent(),this._spec=void 0,this.getMarks().forEach(t=>t.release()),null==(t=this._data)||t.release(),this._data=null,this._marks.clear(),super.release()}updateSpec(t){var e;let i=this._compareSpec(t,this._spec);return(i.reRender||i.reMake||i.reCompile)&&(null==(e=this._layout)||e.setWillLayoutTag()),this._spec=t,i}_compareSpec(t,e){return{change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1}}reInit(t){t&&(this._spec=t),this.setAttrFromSpec()}updateLayoutAttribute(){}setAttrFromSpec(){var t;null==(t=this._layout)||t.setAttrFromSpec(this._spec,this._option.getChartViewRect())}_convertMarkStyle(t){return Object.assign({},t)}setMarkStyle(t,e,i,r){(0,aw.Z)(t)&&(0,aw.Z)(e)&&t.setStyle(this._convertMarkStyle(e),i,r)}initMarkStyleWithSpec(t,e){if(!(0,aw.Z)(t)||!(0,aw.Z)(e))return;let{style:i,state:r}=e,n=Object.assign({},e);i&&(n.style=this._convertMarkStyle(i)),r&&(n.state={},Object.keys(r).forEach(t=>{n.state[t]=this._convertMarkStyle(r[t])})),t.initStyleWithSpec(n)}stateKeyToSignalName(t,e){let i=`${d9}_${this.modelType}_${this.type}_${this.id}_${t}`;return e&&(i+=`_${e}`),i}compileData(){var t;null==(t=this._data)||t.compile()}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t})})}_createMark(t,e={},i){let{type:r,name:n}=t,{parent:l}=e,s=pu(e,["parent"]),a=h9.createMark(r,n,Object.assign({model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._option.globalScale},s));return l?l.addMark(a):this.getCompiler().addRootMark(a),a&&(a.created(),i&&a.setMarkConfig(i)),a}_getDataIdKey(){}getColorScheme(){var t,e;return null==(e=(t=this._option).getTheme)?void 0:e.call(t,"colorScheme")}getSpecInfo(){var t,e,i;return pd(null!=(i=null==(e=(t=this._option).getSpecInfo)?void 0:e.call(t))?i:{},this.getSpecInfoPath())}getSpecIndex(){let t=this.getSpecPath();if(!(null==t?void 0:t.length))return 0;let e=Number(t[t.length-1]);return isNaN(e)?0:e}updateAnimateStateCallback(t){this._aniamtionStateCallback=t}getAnimationStateCallback(){return this._aniamtionStateCallback}}class pp{getSpec(){return this._spec||{}}getLayoutStartPoint(){return this._layoutStartPoint}get layoutRectLevelMap(){return this._layoutRectLevelMap}get minWidth(){return this._minWidth}set minWidth(t){this._minWidth=t}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth=t}get minHeight(){return this._minHeight}set minHeight(t){this._minHeight=t}get maxHeight(){return this._maxHeight}set maxHeight(t){this._maxHeight=t}get lastComputeRect(){return this._lastComputeRect}getLastComputeOutBounds(){return this._lastComputeOutBounds}get layoutOrient(){return this._layoutOrient}set layoutOrient(t){this._layoutOrient=t}get model(){return this._model}get type(){return this._model.type}get willLayoutTag(){return this._willLayoutTag}constructor(t,e){var i;this.layoutClip=!1,this.autoIndent=!1,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:0,height:0},this._layoutRectLevelMap={width:pr,height:pr},this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._lastComputeRect=null,this._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0},this.getLayoutRect=()=>this._layoutRect,this.layoutType="normal",this._layoutOrient="left",this.layoutPaddingLeft=0,this.layoutPaddingTop=0,this.layoutPaddingRight=0,this.layoutPaddingBottom=0,this.layoutOffsetX=0,this.layoutOffsetY=0,this.layoutLevel=ta.Region,this._willLayoutTag=!0,this._model=t,this._option=e,this.layoutLevel=e.layoutLevel,this.layoutType=e.layoutType,e.layoutOrient&&(this.layoutOrient=e.layoutOrient),this._spec=null==(i=null==t?void 0:t.getSpec)?void 0:i.call(t)}_setLayoutAttributeFromSpec(t,e){var i,r,n,l;if(this._spec&&!1!==this._spec.visible){let s=hS(hM(t.padding),e,e);this._option.transformLayoutPadding&&(s=this._option.transformLayoutPadding(s)),this.layoutPaddingLeft=s.left,this.layoutPaddingRight=s.right,this.layoutPaddingTop=s.top,this.layoutPaddingBottom=s.bottom,this._minHeight=(0,nB.Z)(t.minHeight)?null!=(i=this._minHeight)?i:null:hw(t.minHeight,e.height,e),this._maxHeight=(0,nB.Z)(t.maxHeight)?null!=(r=this._maxHeight)?r:null:hw(t.maxHeight,e.height,e),this._minWidth=(0,nB.Z)(t.minWidth)?null!=(n=this._minWidth)?n:null:hw(t.minWidth,e.width,e),this._maxWidth=(0,nB.Z)(t.maxWidth)?null!=(l=this._maxWidth)?l:null:hw(t.maxWidth,e.width,e),t.width&&this.setLayoutRect({width:hw(t.width,e.width,e)},{width:pi}),t.height&&this.setLayoutRect({height:hw(t.height,e.height,e)},{height:pi}),(0,nB.Z)(t.offsetX)||(this.layoutOffsetX=hw(t.offsetX,e.width,e)),(0,nB.Z)(t.offsetY)||(this.layoutOffsetY=hw(t.offsetY,e.height,e)),t.alignSelf&&(this.alignSelf=t.alignSelf)}}setAttrFromSpec(t,e){var i,r,n,l;this._spec=t,this.layoutType=null!=(i=t.layoutType)?i:this.layoutType,this.layoutLevel=null!=(r=t.layoutLevel)?r:this.layoutLevel,this.layoutOrient=null!=(n=t.orient)?n:this.layoutOrient,this._setLayoutAttributeFromSpec(t,e),this.layoutClip=null!=(l=t.clip)?l:this.layoutClip}onLayoutStart(t,e){this._setLayoutAttributeFromSpec(this._spec,e)}onLayoutEnd(){}_getAbsoluteSpecValue(t){let e={top:null,bottom:null,left:null,right:null};return["top","bottom","left","right"].forEach(i=>{(0,nB.Z)(this._spec[i])||(e[i]=hw(this._spec[i],"top"===i||"bottom"===i?t.height:t.width,t))}),e}absoluteLayoutInRect(t){let{top:e,bottom:i,left:r,right:n}=this._getAbsoluteSpecValue(t),l={width:t.width-this.layoutPaddingLeft-this.layoutPaddingRight,height:t.height-this.layoutPaddingTop-this.layoutPaddingBottom};(0,nB.Z)(r)||(l.width-=r),(0,nB.Z)(n)||(l.width-=n),(0,nB.Z)(e)||(l.height-=e),(0,nB.Z)(i)||(l.height-=i),this.setLayoutRect(l);let{width:s,height:a}=this.computeBoundsInRect(this.getLayoutRect());this.setLayoutRect({width:s,height:a});let o={x:t.x,y:t.y};!0===this._spec.center?(o.x=t.x+.5*t.width-.5*s,o.y=t.y+.5*t.height-.5*a):((0,nB.Z)(r)?(0,nB.Z)(n)||(o.x=t.x+t.width-this.layoutPaddingRight-n-s):o.x=t.x+r+this.layoutPaddingLeft,(0,nB.Z)(e)?(0,nB.Z)(i)||(o.y=t.y+t.height-this.layoutPaddingBottom-i-a):o.y=t.y+e+this.layoutPaddingTop),this.setLayoutStartPosition(o)}setLayoutStartPosition(t){var e,i;this._option.transformLayoutPosition&&(t=this._option.transformLayoutPosition(t)),(0,hy.Z)(t.x)&&(this._layoutStartPoint.x=t.x),(0,hy.Z)(t.y)&&(this._layoutStartPoint.y=t.y),null==(i=(e=this._model).afterSetLayoutStartPoint)||i.call(e,this._layoutStartPoint)}setLayoutRect({width:t,height:e},i){var r,n,l,s;(0,hy.Z)(t)&&(null!=(r=null==i?void 0:i.width)?r:pr)>=this._layoutRectLevelMap.width&&(this._layoutRect.width=t,this._layoutRectLevelMap.width=null!=(n=null==i?void 0:i.width)?n:pr),(0,hy.Z)(e)&&(null!=(l=null==i?void 0:i.height)?l:pr)>=this._layoutRectLevelMap.height&&(this._layoutRect.height=e,this._layoutRectLevelMap.height=null!=(s=null==i?void 0:i.height)?s:pr),this.setRectInSpec(this._layoutRect)}getLayout(){return{x:this._layoutStartPoint.x,y:this._layoutStartPoint.y,width:this._layoutRect.width,height:this._layoutRect.height}}mergeLayoutRect({width:t,height:e}){let i={width:t,height:e};return this._layoutRectLevelMap.width>pr&&(i.width=this._layoutRect.width),this._layoutRectLevelMap.height>pr&&(i.height=this._layoutRect.height),i}getOrientPosAttribute(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"x":"y"}getOrientSizeAttribute(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"width":"height"}changeBoundsBySetting(t){return this._layoutRectLevelMap.width>pr&&(t.x2=t.x1+this._layoutRect.width),this._layoutRectLevelMap.height>pr&&(t.y2=t.y1+this._layoutRect.height),t.x1-=this._layoutStartPoint.x,t.x2-=this._layoutStartPoint.x,t.y1-=this._layoutStartPoint.y,t.y2-=this._layoutStartPoint.y,t}setRectInSpec(t){let e=Object.assign({},t);return this._layoutRectLevelMap.width<pi?((0,nB.Z)(this._minWidth)||(e.width=Math.max(e.width,this._minWidth)),(0,nB.Z)(this._maxWidth)||(e.width=Math.min(e.width,this._maxWidth))):e.width=this._layoutRect.width,this._layoutRectLevelMap.height<pi?((0,nB.Z)(this._minHeight)||(e.height=Math.max(e.height,this._minHeight)),(0,nB.Z)(this._maxHeight)||(e.height=Math.min(e.height,this._maxHeight))):e.height=this._layoutRect.height,e}computeBoundsInRect(t){if(this._lastComputeRect=t,("region-relative"===this.layoutType||"region-relative-overlap"===this.layoutType)&&(this._layoutRectLevelMap.width===pi&&("left"===this.layoutOrient||"right"===this.layoutOrient)||this._layoutRectLevelMap.height===pi&&("bottom"===this.layoutOrient||"top"===this.layoutOrient)))return this._layoutRect;let e=Object.assign({},this._model.getBoundsInRect(this.setRectInSpec(t),t));this.changeBoundsBySetting(e),this.autoIndent&&e.x2-e.x1>0&&e.y2-e.y1>0&&(this._lastComputeOutBounds.x1=Math.ceil(-e.x1),this._lastComputeOutBounds.x2=Math.ceil(e.x2-t.width),this._lastComputeOutBounds.y1=Math.ceil(-e.y1),this._lastComputeOutBounds.y2=Math.ceil(e.y2-t.height));let i=this.setRectInSpec(hA(e,t));return this._option.transformLayoutRect&&(i=this._option.transformLayoutRect(i)),i}getModelId(){return this._model.id}getModelVisible(){return this._model.getVisible()}setWillLayoutTag(){this._willLayoutTag=!0}clearWillLayoutTag(){this._willLayoutTag=!1}}class pg extends pc{constructor(){super(...arguments),this.layoutType="normal",this.layoutLevel=0,this.layoutZIndex=0,this._forceLayoutTag=!1,this._layout=null,this._orient=null,this._layoutRect={width:0,height:0},this._layoutStartPos={x:0,y:0},this._isLayout=!0,this.getGraphicBounds=()=>this._layout?{x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}:{x1:0,x2:0,y1:0,y2:0},this._transformLayoutRect=null,this._transformLayoutPosition=null,this._transformLayoutPadding=null}get layoutOrient(){return this._orient}set layoutOrient(t){this._orient=t,this._layout&&(this._layout.layoutOrient=t)}initLayout(){"none"!==this.layoutType&&(this._layout=new pp(this,{layoutType:this.layoutType,layoutLevel:this.layoutLevel,layoutOrient:this._orient,transformLayoutRect:this._transformLayoutRect,transformLayoutPosition:this._transformLayoutPosition,transformLayoutPadding:this._transformLayoutPadding}),this._orient&&"radius"!==this._orient&&"angle"!==this._orient&&this._layout&&(this._layout.layoutOrient=this._orient))}onLayoutStart(t,e){this._isLayout=!0,super.onLayoutStart(t,e)}onLayoutEnd(){super.onLayoutEnd(),this.updateLayoutAttribute();let t=this.getLayoutRect();!this._forceLayoutTag&&(0,uL.X)(this._lastLayoutRect,t)||(this._lastLayoutRect=Object.assign({},t)),this._forceLayoutTag=!1,this._isLayout=!1}afterSetLayoutStartPoint(t){}_forceLayout(){var t,e;this._isLayout||(null==(t=this._layout)||t.setWillLayoutTag(),this._forceLayoutTag=!0,null==(e=this._option.globalInstance.getChart())||e.setLayoutTag(!0))}getLayoutStartPoint(){return this._layout?this._layout.getLayoutStartPoint():this._layoutStartPos}setLayoutStartPosition(t){return this._layout?this._layout.setLayoutStartPosition(t):this._layoutStartPos=(0,h3.Z)(this._layoutStartPos,t)}getLayoutRect(){return this._layout?this._layout.getLayoutRect():this._layoutRect}setLayoutRect(t,e){return this._layout?this._layout.setLayoutRect(t):this._lastLayoutRect=(0,h3.Z)(this._layoutRect,t)}getLastComputeOutBounds(){var t;return null==(t=this._layout)?void 0:t.getLastComputeOutBounds()}setAttrFromSpec(){var t,e,i,r,n;super.setAttrFromSpec(),this.layoutClip=null!=(t=this._spec.clip)?t:this.layoutClip,this.layoutZIndex=null!=(e=this._spec.zIndex)?e:this.layoutZIndex,this.layoutType=null!=(i=this._spec.layoutType)?i:this.layoutType,this._orient=null!=(r=this._spec.orient)?r:this._orient,this.layoutLevel=null!=(n=this._spec.layoutLevel)?n:this.layoutLevel}}class pf extends pa{_initTheme(t,e){return{spec:t,theme:this._theme}}}class pm extends pg{getMaxWidth(){return this._layout.maxWidth}setMaxWidth(t){this._layout.maxWidth=t}getMaxHeight(){return this._layout.maxHeight}setMaxHeight(t){this._layout.maxHeight=t}getGroupMark(){return this._groupMark}getInteractionMark(){return this._interactionMark}getStackInverse(){return!0===this._spec.stackInverse}getStackSort(){return!0===this._spec.stackSort}constructor(t,e){var i;super(t,e),this.transformerConstructor=pf,this.modelType="region",this.specKey="region",this.type=pm.type,this._series=[],this.layoutType="region",this.layoutZIndex=ts.Region,this.seriesDataFilterOver=()=>{this.event.emit(J.regionSeriesDataFilterOver,{model:this,chart:this.getChart()}),this._series.forEach(t=>{t.getViewDataFilter()&&t.reTransformViewData()})},this.getBoundsInRect=()=>({x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}),this.userId=t.id,this.coordinate=null!=(i=t.coordinate)?i:"cartesian"}_getClipDefaultValue(){var t,e,i,r;let n=this._option.getChart().getSpec(),l=null==(e=null==(t=n.dataZoom)?void 0:t.some)?void 0:e.call(t,t=>{var e;return"axis"===(null!=(e=t.filterMode)?e:"filter")}),s=null==(r=null==(i=n.scrollBar)?void 0:i.some)?void 0:r.call(i,t=>{var e;return"axis"===(null!=(e=t.filterMode)?e:"axis")});return!(!l&&!s)||this._layout.layoutClip}created(){var t,e;this.initLayout(),super.created();let i=null!=(t=this._spec.clip)?t:this._getClipDefaultValue();this._groupMark=this._createGroupMark("regionGroup",this.userId,this.layoutZIndex),this._spec.roam&&this._groupMark.setMarkConfig({interactive:!0}),this._interactionMark=this._createGroupMark("regionInteractionGroup",(null!=(e=this.userId)?e:this.type)+"_interaction",ts.Interaction),(0,uF.Z)(this._spec.style)||(this._backgroundMark=this._createMark({type:"rect",name:"regionBackground"},{parent:this._groupMark}),i&&(this._foregroundMark=this._createMark({type:"rect",name:"regionForeground"},{parent:this._groupMark})),[this._backgroundMark,this._foregroundMark].forEach(t=>{t&&(t.created(),this.setMarkStyle(t,{width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height},"normal",to.Built_In),this._groupMark.addMark(t))}),this._backgroundMark&&this._backgroundMark.setMarkConfig({zIndex:ts.SeriesGroup-1}),this._foregroundMark&&this._foregroundMark.setMarkConfig({zIndex:ts.Mark+1}))}_createGroupMark(t,e,i){var r,n;let l=this._createMark({type:"group",name:t});l.setUserId(e),l.setMarkConfig({zIndex:i});let s=null!=(r=this._spec.clip)?r:this._getClipDefaultValue();return this.setMarkStyle(l,{x:()=>this.getLayoutStartPoint().x,y:()=>this.getLayoutStartPoint().y,width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height,clip:s},"normal",to.Built_In),this.setMarkStyle(l,{cornerRadius:null==(n=this._spec.style)?void 0:n.cornerRadius},"normal",to.User_Mark),this._marks.addMark(l),l}init(t){super.init(t),this.initMark(),this.initSeriesDataflow()}initMark(){this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}_initBackgroundMarkStyle(){var t,e;this._backgroundMark&&(this.setMarkStyle(this._backgroundMark,Object.assign({fillOpacity:+(null!=(t=this._spec.style)&&!!t.fill)},this._spec.style),"normal",to.User_Mark),(null!=(e=this._spec.clip)?e:this._getClipDefaultValue())&&this.setMarkStyle(this._backgroundMark,{strokeOpacity:0},"normal",to.Built_In))}_initForegroundMarkStyle(){this._foregroundMark&&this.setMarkStyle(this._foregroundMark,Object.assign(Object.assign({},this._spec.style),{fillOpacity:0,pickable:!1}),"normal",to.User_Mark)}_compareSpec(t,e){let i=super._compareSpec(t,e);return(0,uL.X)(null==e?void 0:e.style,null==t?void 0:t.style)||(i.reMake=!0),i}reInit(t){super.reInit(t),this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}addSeries(t){t&&(this._series.includes(t)||this._series.push(t))}removeSeries(t){if(!t)return;let e=this._series.findIndex(e=>e===t);e>=0&&this._series.splice(e,1)}getSeries(t={}){return this._series.filter(e=>{var i,r;return(!t.name||(null==e?void 0:e.name)===t.name)&&(!t.userId||(0,a1.IX)(t.userId).includes(e.userId))&&(!(0,aw.Z)(t.specIndex)||(0,a1.IX)(t.specIndex).includes(e.getSpecIndex()))&&(!t.id||e.id===t.id)&&(!t.type||e.type===t.type)&&(!t.coordinateType||e.coordinate===t.coordinateType)&&(!t.dataName||(null==(r=null==(i=e.getRawData)?void 0:i.call(e))?void 0:r.name)===t.dataName)})}getSeriesInName(t){return this.getSeries({name:t})[0]}getSeriesInUserId(t){return this.getSeries({userId:t})[0]}getSeriesInId(t){return this.getSeries({id:t})[0]}getSeriesInType(t){return this.getSeries({type:t})}getSeriesInCoordinateType(t){return this.getSeries({coordinateType:t})}getSeriesInDataName(t){return this.getSeries({dataName:t})}initSeriesDataflow(){let t=this._series.map(t=>{var e;return null!=(e=t.getViewDataFilter())?e:t.getViewData()}).filter(t=>!!t);this._option.dataSet.multipleDataViewAddListener(t,"change",this.seriesDataFilterOver)}release(){super.release(),this._series=[]}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t,context:{model:this}})})}compile(){this.compileMarks()}onLayoutEnd(){this._series.forEach(t=>t.onLayoutEnd()),super.onLayoutEnd()}}function py(t){let e=[],i=[],r=[];return t.forEach(t=>{(0,nB.Z)(t.getSpec().position)||"start"===t.getSpec().position?e.push(t):"middle"===t.getSpec().position?i.push(t):"end"===t.getSpec().position&&r.push(t)}),{startItems:e,endItems:r,middleItems:i}}function pv(t,e,i){e?t.forEach(t=>{let e=(0,a1.Z$)(t),r=(i-(e.getLayoutStartPoint().y+e.getLayoutRect().height-t[0].getLayoutStartPoint().y))/2;t.forEach(t=>{t.setLayoutStartPosition({x:t.getLayoutStartPoint().x,y:t.getLayoutStartPoint().y+r})})}):t.forEach(t=>{let e=(0,a1.Z$)(t),r=(i-(e.getLayoutStartPoint().x+e.getLayoutRect().width-t[0].getLayoutStartPoint().x))/2;t.forEach(t=>{t.setLayoutStartPosition({x:t.getLayoutStartPoint().x+r,y:t.getLayoutStartPoint().y})})})}function pb(t,e,i,r){let n;t.forEach((t,l)=>{t.length>1&&(n=i[l],t.forEach(t=>{if(!t.alignSelf||"start"===t.alignSelf)return;let i=t.getLayoutStartPoint(),l="middle"===t.alignSelf?.5:1,s=e?n-(t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight):n-(t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom);e?t.setLayoutStartPosition({x:i.x+r*s*l,y:i.y}):t.setLayoutStartPosition({x:i.x,y:i.y+r*s*l})}))})}function p_(t,e,i,r,n,l){if(t.length){let s=0,a="right"===n,o=a?-1:1,h=a?e.rightCurrent:e.leftCurrent,d=e.topCurrent,u=[],c=[],p=[];t.forEach(t=>{let{rect:r}=pS(t,e,l),n=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=a?-r.width-t.layoutPaddingRight:t.layoutPaddingLeft;t.setLayoutStartPosition({x:h+t.layoutOffsetX+f,y:d+t.layoutOffsetY+t.layoutPaddingTop}),(d+=n)>i&&c.length?(p.push(s),h+=o*s,s=g,d=e.topCurrent+n,t.setLayoutStartPosition({x:h+t.layoutOffsetX+f,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),u.push(c),c=[t]):(s=Math.max(s,g),c.push(t))}),p.push(s),u.push(c),pb(u,!0,p,o),r&&pv(u,!0,i),a?e.rightCurrent=h+o*s:e.leftCurrent=h+o*s}}function pC(t,e,i,r,n){if(t.length){let i=0,l="right"===r,s=l?-1:1,a=l?e.rightCurrent:e.leftCurrent,o=e.bottomCurrent,h=[],d=[],u=[];t.forEach(t=>{let{rect:r}=pS(t,e,n),c=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,p=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,g=l?-r.width-t.layoutPaddingRight:t.layoutPaddingLeft;o<c&&d.length?(u.push(i),a+=s*i,i=p,o=e.bottomCurrent,t.setLayoutStartPosition({x:a+t.layoutOffsetX+g,y:o+t.layoutOffsetY-r.height-t.layoutPaddingBottom}),h.push(d),d=[t]):(t.setLayoutStartPosition({x:a+t.layoutOffsetX+g,y:o+t.layoutOffsetY-r.height-t.layoutPaddingBottom}),i=Math.max(i,p),o-=c,d.push(t))}),u.push(i),h.push(d),pb(h,!0,u,s),l?e.rightCurrent=a+s*i:e.leftCurrent=a+s*i}}function px(t,e,i,r,n,l){if(t.length){let s="top"===n,a=s?1:-1,o=0,h=e.leftCurrent,d=s?e.topCurrent:e.bottomCurrent,u=[],c=[],p=[];t.forEach(t=>{let{rect:r}=pS(t,e,l),n=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=s?t.layoutPaddingTop:-r.height-t.layoutPaddingBottom;t.setLayoutStartPosition({x:h+t.layoutOffsetX+t.layoutPaddingLeft,y:d+t.layoutOffsetY+f}),(h+=g)>i&&c.length?(p.push(o),h=e.leftCurrent+g,d+=a*o,o=n,t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:d+t.layoutOffsetY+f}),u.push(c),c=[t]):(o=Math.max(o,n),c.push(t))}),p.push(o),u.push(c),pb(u,!1,p,a),r&&pv(u,!1,i),s?e.topCurrent=d+a*o:e.bottomCurrent=d+a*o}}function pw(t,e,i,r,n){if(t.length){let i="top"===r,l=i?1:-1,s=0,a=e.rightCurrent,o=i?e.topCurrent:e.bottomCurrent,h=[],d=[],u=[];t.forEach(t=>{let{layoutTag:r,layoutRect:u,rect:c}=pS(t,e,n),p=c.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=c.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=i?t.layoutPaddingTop:-c.height-t.layoutPaddingBottom;a<g&&d.length?(a=e.rightCurrent,o+=l*s,s=p,t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-c.width-t.layoutPaddingRight,y:o+t.layoutOffsetY+f}),h.push(d),d=[t]):(d.push(t),t.setLayoutStartPosition({x:a+t.layoutOffsetX-c.width-t.layoutPaddingRight,y:o+t.layoutOffsetY+f}),s=Math.max(s,p),a-=g)}),u.push(s),h.push(d),pb(h,!1,u,l),i?e.topCurrent=o+l*s:e.bottomCurrent=o+l*s}}function pS(t,e,i,r=!0){let n,l,s="recomputeHeight",a="recomputeWidth",o="width";"top"!==t.layoutOrient&&"bottom"!==t.layoutOrient||(s="recomputeWidth",a="recomputeHeight",o="height");let h=!(!t.willLayoutTag&&!1===i[s]);if(h){let s=Object.assign({},t.getLayoutRect()),d=t.lastComputeRect;n=e.getItemComputeLayoutRect(t),!t.willLayoutTag&&(0,uL.X)(n,d)?(h=!1,l=t.getLayoutRect()):(l=t.computeBoundsInRect(n),(0,uL.X)(s[o],l[o])?h=!1:(r&&t.setLayoutRect(l),i[a]=!0))}else n=t.getLastComputeOutBounds(),l=t.getLayoutRect();return{layoutRect:n,rect:l,layoutTag:h}}pm.type="region",pm.transformerConstructor=pf,pm.specKey="region";class pA{constructor(t,e){this.leftCurrent=0,this.topCurrent=0,this.rightCurrent=0,this.bottomCurrent=0,this.recomputeWidth=!1,this.recomputeHeight=!1,this._onError=null==e?void 0:e.onError}_layoutInit(t,e,i,r){this._chartLayoutRect=i,this._chartViewBox=r,this.leftCurrent=i.x,this.topCurrent=i.y,this.rightCurrent=i.x+i.width,this.bottomCurrent=i.height+i.y,this.recomputeWidth=!1,this.recomputeHeight=!1,e.sort((t,e)=>e.layoutLevel-t.layoutLevel)}_layoutNormalItems(t,e){this.layoutNormalInlineItems(t.filter(t=>"normal-inline"===t.layoutType),e),this.layoutNormalItems(t.filter(t=>"normal"===t.layoutType),e)}_groupItems(t){let e=t.filter(t=>"region"===t.layoutType),i=t.filter(t=>"region-relative"===t.layoutType),r=t.filter(t=>"region-relative-overlap"===t.layoutType),n=i.concat(r),l={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}};return r.forEach(t=>{l[t.layoutOrient].items.push(t)}),{regionItems:e,relativeItems:i,relativeOverlapItems:r,allRelatives:n,overlapItems:l}}layoutItems(t,e,i,r){var n,l,s;this._layoutInit(t,e,i,r);let a={recomputeWidth:this.recomputeWidth,recomputeHeight:this.recomputeHeight},o=null!=(s=null==(l=null==(n=null==t?void 0:t.getSpec())?void 0:n.layout)?void 0:l.secondLayoutLeftRight)&&s;this._layoutNormalItems(e,a);let h={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},{regionItems:d,relativeItems:u,relativeOverlapItems:c,allRelatives:p,overlapItems:g}=this._groupItems(e);this.layoutRegionItems(d,u,c,g,a,o),this._processAutoIndent(d,u,c,g,p,h,a,o),this.layoutAbsoluteItems(e.filter(t=>"absolute"===t.layoutType)),e.forEach(t=>{t.clearWillLayoutTag()})}_processAutoIndent(t,e,i,r={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}},n,l,s,a=!1){if(n.some(t=>t.autoIndent)){let{top:o,bottom:h,left:d,right:u}=this._checkAutoIndent(n,l);(o||h||d||u)&&(this.topCurrent=l.top+o,this.bottomCurrent=l.bottom-h,this.leftCurrent=l.left+d,this.rightCurrent=l.right-u,this.layoutRegionItems(t,e,i,r,s,a))}}layoutNormalItems(t,e){t.forEach(t=>{let{rect:i}=pS(t,this,e);"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"top"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"right"===t.layoutOrient?(t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX-i.width-t.layoutPaddingRight,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"bottom"===t.layoutOrient&&(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingRight,y:this.bottomCurrent+t.layoutOffsetY-i.height-t.layoutPaddingBottom}),this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom)})}layoutNormalInlineItems(t,e){let i=t.filter(t=>"left"===t.layoutOrient),r=t.filter(t=>"right"===t.layoutOrient),n=t.filter(t=>"top"===t.layoutOrient),l=t.filter(t=>"bottom"===t.layoutOrient),s=this._chartLayoutRect.width+this._chartLayoutRect.x,a=this._chartLayoutRect.height+this._chartLayoutRect.y;return i.length&&function(t,e,i,r){let{startItems:n,middleItems:l,endItems:s}=py(t);n.length&&p_(n,e,i,!1,"left",r),l.length&&p_(l,e,i,!0,"left",r),s.length&&pC(s,e,i,"left",r)}(i,this,a,e),n.length&&function(t,e,i,r){let{startItems:n,middleItems:l,endItems:s}=py(t);n.length&&px(n,e,i,!1,"top",r),l.length&&px(l,e,i,!0,"top",r),s.length&&pw(s,e,i,"top",r)}(n,this,s,e),r.length&&function(t,e,i,r){let{startItems:n,middleItems:l,endItems:s}=py(t);n.length&&p_(n,e,i,!1,"right",r),l.length&&p_(l,e,i,!0,"right",r),s.length&&pC(s,e,i,"right",r)}(r,this,a,e),l.length&&function(t,e,i,r){let{startItems:n,middleItems:l,endItems:s}=py(t);n.length&&px(n,e,i,!1,"bottom",r),l.length&&px(l,e,i,!0,"bottom",r),s.length&&pw(s,e,i,"bottom",r)}(l,this,s,e),!0}_layoutRelativeOverlap(t,e,i){e.items.forEach(t=>{let{rect:r}=pS(t,this,i);e.rect.width=Math.max(r.width+t.layoutPaddingLeft+t.layoutPaddingRight,e.rect.width),e.rect.height=Math.max(r.height+t.layoutPaddingTop+t.layoutPaddingBottom,e.rect.height)}),e.items.forEach(i=>{(0,uL.X)(i.getLayoutRect(),e.rect)||i.setLayoutRect(e.rect),"left"===t?i.setLayoutStartPosition({x:this.leftCurrent+i.layoutOffsetX}):"right"===t?i.setLayoutStartPosition({x:this.rightCurrent-e.rect.width+i.layoutOffsetX}):"top"===t?i.setLayoutStartPosition({x:this.topCurrent+i.layoutOffsetY}):i.setLayoutStartPosition({x:this.bottomCurrent-e.rect.height+i.layoutOffsetY})}),"left"===t?this.leftCurrent+=e.rect.width:"right"===t?this.rightCurrent-=e.rect.width:"top"===t?this.topCurrent+=e.rect.height:this.bottomCurrent-=e.rect.height}_layoutRelativeItem(t,e){let{rect:i}=pS(t,this,e,!1);"left"===t.layoutOrient||"right"===t.layoutOrient?t.setLayoutRect({width:i.width}):t.setLayoutRect({height:i.height}),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"right"===t.layoutOrient?(this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX+t.layoutPaddingLeft})):"top"===t.layoutOrient?(t.setLayoutStartPosition({y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"bottom"===t.layoutOrient&&(this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,t.setLayoutStartPosition({y:this.bottomCurrent+t.layoutOffsetY+t.layoutPaddingTop}))}_layoutRegionItem(t,e,i){let r=Math.max(Math.min(e,...t.map(t=>{var e;return null!=(e=t.maxWidth)?e:Number.MAX_VALUE})),0),n=Math.max(Math.min(i,...t.map(t=>{var e;return null!=(e=t.maxHeight)?e:Number.MAX_VALUE})),0);return t.forEach(t=>{let e=r-t.layoutPaddingLeft-t.layoutPaddingRight,i=n-t.layoutPaddingTop-t.layoutPaddingBottom;t.setLayoutRect({width:e,height:i}),t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop})}),{regionHeight:n,regionWidth:r}}layoutRegionItems(t,e,i,r={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}},n,l=!1){let s=this.leftCurrent,a=this.rightCurrent,o=this.rightCurrent-this.leftCurrent,h=this.bottomCurrent-this.topCurrent;e.filter(t=>"left"===t.layoutOrient||"right"===t.layoutOrient).forEach(t=>{this._layoutRelativeItem(t,n)}),this._layoutRelativeOverlap("left",r.left,n),this._layoutRelativeOverlap("right",r.right,n),o=this.rightCurrent-this.leftCurrent,e.filter(t=>"top"===t.layoutOrient||"bottom"===t.layoutOrient).forEach(t=>{this._layoutRelativeItem(t,n)}),this._layoutRelativeOverlap("top",r.top,n),this._layoutRelativeOverlap("bottom",r.bottom,n),h=this.bottomCurrent-this.topCurrent,l&&(this.leftCurrent=s,this.rightCurrent=a,e.filter(t=>"left"===t.layoutOrient||"right"===t.layoutOrient).forEach(t=>{this._layoutRelativeItem(t,n)}),o=this.rightCurrent-this.leftCurrent);let{regionWidth:d,regionHeight:u}=this._layoutRegionItem(t,o,h);e.concat(i).forEach(e=>{if(["left","right"].includes(e.layoutOrient)){let i=this.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({height:i.getLayoutRect().height}),e.setLayoutStartPosition({y:i.getLayoutStartPoint().y+e.layoutOffsetY+e.layoutPaddingTop}),"right"===e.layoutOrient&&e.setLayoutStartPosition({x:e.getLayoutStartPoint().x+d-o})}else if(["top","bottom"].includes(e.layoutOrient)){let i=this.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({width:i.getLayoutRect().width}),e.setLayoutStartPosition({x:i.getLayoutStartPoint().x+e.layoutOffsetX+e.layoutPaddingLeft}),"bottom"===e.layoutOrient&&e.setLayoutStartPosition({y:e.getLayoutStartPoint().y+u-h})}})}layoutAbsoluteItems(t){t.forEach(t=>{t.willLayoutTag&&t.absoluteLayoutInRect(this._chartLayoutRect)})}filterRegionsWithID(t,e){var i;let r=t.find(t=>t.getModelId()===e);return r||(null!=(i=this._onError)?i:hH)("can not find target region item, invalid id"),r}getItemComputeLayoutRect(t){return{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight,height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom}}_checkAutoIndent(t,e){let i={top:0,left:0,bottom:0,right:0};return t.forEach(t=>{if(!t.getModelVisible()||!t.autoIndent)return;let r="left"===t.layoutOrient||"right"===t.layoutOrient,n=t.getLastComputeOutBounds(),l=this._getOutInLayout(n,t,e);r?(i.top=Math.max(i.top,l.top),i.bottom=Math.max(i.bottom,l.bottom)):(i.left=Math.max(i.left,l.left),i.right=Math.max(i.right,l.right))}),i}_getOutInLayout(t,e,i){let{x:r,y:n}=e.getLayoutStartPoint(),{width:l,height:s}=e.getLayoutRect();return{left:i.left-(r-t.x1),right:r+l+t.x2-i.right,top:i.top-(n-t.y1),bottom:n+s+t.y2-i.bottom}}}pA.type="base",(G=th||(th={})).enter="enter",G.update="update",G.exit="exit",G.unChange="unChange",(V=td||(td={})).STATE_NORMAL="normal",V.STATE_HOVER="hover",V.STATE_HOVER_REVERSE="hover_reverse",V.STATE_DIMENSION_HOVER="dimension_hover",V.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",V.STATE_SELECTED="selected",V.STATE_SELECTED_REVERSE="selected_reverse",V.STATE_SANKEY_EMPHASIS="selected",V.STATE_SANKEY_EMPHASIS_REVERSE="blur",V.STATE_HIGHLIGHT="highlight",V.STATE_BLUR="blur",V.STATE_ACTIVE="active",(U=tu||(tu={})).STATE_HOVER_REVERSE="hover_reverse",U.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",U.STATE_SELECTED_REVERSE="selected_reverse";var pM=i(10145),pT=i(68390),pk=i(6119),pR=i(11809),pP=i(71881);class pB extends pR.J{range(t){return t?(this._range=t,this._resetRange(),this):super.range()}domain(t){return t?(super.domain(t),this._resetRange(),this):super.domain()}_resetRange(){if(!h0(this._range))return void super.range(this._range);let t=h$(this._range,this._domain);super.range(t)}}let pI={linear:pM.f,band:pT.j,point:pk.Y,ordinal:pR.J,threshold:pP.v,colorOrdinal:pB};function pE(t){let e=pI[t];return e?new e:null}function pL(t,e){var i,r;if("scale"in t&&t.scale)return(0,nI.Z)(t.scale)&&(null==e?void 0:e.globalScale)?e.globalScale.registerMarkAttributeScale(t,e.seriesId):t.scale;let n=pE(t.type);return n&&(i=n,r=t,i&&r&&(r.domain&&i.domain(r.domain),r.range&&i.range(r.range),r.specified&&i.specified&&i.specified(r.specified),r.clamp&&i.clamp&&i.clamp(r.clamp))),n}function pF(t,e,i){if(!e)return t;let r=e.range(),n=i&&e._calculateWholeRange?e._calculateWholeRange(r):e.range();return Math.min(Math.max(Math.min(n[0],n[n.length-1]),t),Math.max(n[0],n[n.length-1]))}function pO(t,e,i){if(!e)return!0;let r=e.range(),n=(i&&e._calculateWholeRange?e._calculateWholeRange(r):e.range()).map(t=>e.invert(t)),l=Math.min(n[0],n[n.length-1]),s=Math.max(n[0],n[n.length-1]);return Array.isArray(t)?t.every(t=>t>=l&&t<=s):t>=l&&t<=s}function pH(t){return(0,aw.Z)(null==t?void 0:t.field)&&(0,aw.Z)(null==t?void 0:t.scale)}let pD=["linear","radial","conical"],pz={linear:{x0:0,y0:0,x1:1,y1:1},radial:{x0:0,y0:0,x1:1,y1:1,r0:0,r1:1},conical:{x:.5,y:.5,startAngle:0,endAngle:2*Math.PI}};var pW=i(37196);let pZ={};Object.values(td).forEach(t=>{pZ[t]=!0}),td.STATE_HOVER,td.STATE_HOVER_REVERSE,td.STATE_SELECTED,td.STATE_SELECTED_REVERSE,td.STATE_DIMENSION_HOVER,td.STATE_DIMENSION_HOVER_REVERSE;class pN extends ps{compile(){}getStateMap(){return this._stateMap}_getDefaultStateMap(){return{}}constructor(t){super(t),this.initStateMap()}initStateMap(t){this._stateMap=null!=t?t:this._getDefaultStateMap()}updateState(t,e){if(t&&((0,h3.Z)(this._stateMap,t),!e))return this.getCompiler().renderNextTick()}}class pj extends pN{getStateInfoList(){return this._stateInfoList}constructor(t,e){super(t),this._stateInfoList=[],this._mark=e}_getDefaultStateMap(){return{markUpdateRank:1}}getStateInfo(t){return this._stateInfoList.find(e=>e.stateValue===t)}addStateInfo(t){if(this.getStateInfo(t.stateValue))return;t.level=t.level||0;let e=!0;for(let i=0;i<this._stateInfoList.length;i++){let r=this._stateInfoList[i].level;if(r&&r>t.level){this._stateInfoList.splice(i,0,t),e=!1;break}}e&&this._stateInfoList.push(t)}_clearStateBeforeSet(t){t.datums=null,t.items=null,t.fields=null,t.filter=null}changeStateInfo(t){let e=this.getStateInfo(t.stateValue);if(e){if(void 0!==t.datums&&(this._clearStateBeforeSet(e),e.datums=t.datums,e.datumKeys=t.datumKeys),void 0!==t.items&&(this._clearStateBeforeSet(e),e.items=t.items),void 0!==t.fields)if(this._clearStateBeforeSet(e),null===t.fields)e.fields=t.fields;else for(let i in e.fields=e.fields||{},t.fields){let r=t.fields[i];e.fields[i]=e.fields[i]||{};let n=e.fields[i];(0,aw.Z)(r.domain)&&(n.domain=r.domain),(0,aw.Z)(r.type)&&(n.type=r.type)}t.filter&&(this._clearStateBeforeSet(e),e.filter=t.filter)}else this.addStateInfo(t)}clearStateInfo(t){t.forEach(t=>{this.getStateInfo(t)&&this.changeStateInfo({stateValue:t,datumKeys:null,datums:null,fields:null,items:null,filter:null,cache:{}})})}_isMultiMark(){var t;return!this._mark||(t=this._mark.type,uM.includes(t))}checkOneState(t,e,i){var r;let n=!1,l=!1;if((0,aw.Z)(i.datums)&&i.datums.length>0)n=this.checkDatumState(i,e),l=!0;else if(i.items)n=null!=(r=this.checkItemsState(i,t))&&r,l=!0;else if(i.fields)n=this.checkFieldsState(i,e,t),l=!0;else if(!n&&i.filter){let r={mark:this._mark,renderNode:t,type:this._mark.type};n=i.filter(null==e?void 0:e[0],r),l=!0}return l?n?"in":"out":"skip"}checkState(t,e){var i;let r=(null!=(i=t.context.states)?i:[]).filter(t=>!!pZ[t]).map(t=>[t,10]);for(let i=0;i<this._stateInfoList.length;i++){let n=this._stateInfoList[i],l=this.checkOneState(t,e,n);"skip"!==l&&"in"===l&&r.push([n.stateValue,n.level])}return r.map(t=>t[0])}checkDatumState(t,e){let i=!1,r=e[0];if((0,rD.Z)(t.datums)){let e=this._isMultiMark(),n=t.datumKeys||Object.keys(t.datums[0]).filter(t=>!t.startsWith(d9));i=t.datums.some(t=>e&&(0,rD.Z)(null==t?void 0:t.items)?n.every(e=>{var i,n;return(null==(n=null==(i=null==t?void 0:t.items)?void 0:i[0])?void 0:n[e])===(null==r?void 0:r[e])}):n.every(e=>(null==t?void 0:t[e])===(null==r?void 0:r[e])))}else if((0,nF.Z)(t.datums)){let e=t.datumKeys||Object.keys(t.datums).filter(t=>!t.startsWith(d9)),n=this._isMultiMark();i=e.every(e=>{var i,l;return n?(null==(i=t.datums.items)?void 0:i[0][e])===r[e]:(null==(l=t.datums)?void 0:l[e])===r[e]})}else i=e===t.datums;return i}checkItemsState(t,e){var i;return null==(i=t.items)?void 0:i.includes(e)}checkFieldsState(t,e,i){var r;let n=!0;for(let l in t.fields){let s=t.fields[l],a=s.type,o=s.domain,h=null==(r=e[0])?void 0:r[l];if((0,pW.z2)(a)&&o.length>1){if(this.checkLinearFieldState(o,l,e,i)){n=!1;break}n=!0}else{if(!o.some(t=>t===h)){n=!1;break}n=!0}}return n}checkLinearFieldState(t,e,i,r){var n;let l=this._isMultiMark()?null==(n=i[0])?void 0:n[e]:i[e];return l<t[0]||l>t[t.length-1]}release(){}}class pG extends ps{constructor(){super(...arguments),this.id=hm(),this._compiledProductId=null}getProductId(){var t;return null!=(t=this._compiledProductId)?t:this.generateProductId()}compile(t){this._compileProduct(t)}setTransform(t){this._transform=t}runTransforms(t,e){if(!t||!t.length)return e;let i=e;return t.forEach(t=>{var e;i=null==(e=h9.getGrammarTransform(t.type))?void 0:e.transform(t,i)}),i}}class pV extends pG{getProduct(){return this._product||(this._product=this.runTransforms(this._transform,this.getLatestData())),this._product}getDataView(){return this._data}setDataView(t){this._data=t}getLatestData(){var t;return null==(t=this._data)?void 0:t.latestData}constructor(t,e){super(t),this._data=null,this._data=e}removeProduct(){this._product=null,this._prevProduct=null,this._compiledProductId=null}release(){this.removeProduct(),super.release(),this._data=null}addRelatedMark(t){this._relatedMarks||(this._relatedMarks={}),this._relatedMarks[t.id]=t}updateData(t){if(this._compileProduct(),this._relatedMarks){let e=!1;if(Object.keys(this._relatedMarks).forEach(t=>{this._relatedMarks[t]&&(e=!0,this._relatedMarks[t].commit())}),!t&&e)return this.getCompiler().renderNextTick()}}_compileProduct(){this._prevProduct=this._product,this._product=null}generateProductId(){var t;return`${null==(t=this.getDataView())?void 0:t.name}`}}(K=tc||(tc={}))[K.Color255=0]="Color255",K[K.Color1=1]="Color1";class pU{static Get(t,e=tc.Color1,i=[0,0,0,1]){if(e===tc.Color1){let e=pU.store1[t];if(e)return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i;let r=hj.Il.parseColorString(t);if(r){let e=[r.r/255,r.g/255,r.b/255,r.opacity];pU.store1[t]=e,pU.store255[t]=[r.r,r.g,r.b,r.opacity],i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]}return i}let r=pU.store255[t];if(r)return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i;let n=hj.Il.parseColorString(t);return n&&(pU.store1[t]=[n.r/255,n.g/255,n.b/255,n.opacity],pU.store255[t]=[n.r,n.g,n.b,n.opacity],i[0]=n.r,i[1]=n.g,i[2]=n.b,i[3]=n.opacity),i}static Set(t,e,i){if(e===tc.Color1)pU.store1[t]||(pU.store1[t]=i,pU.store255[t]=[Math.floor(255*i[0]),Math.floor(255*i[1]),Math.floor(255*i[2]),Math.floor(255*i[3])]);else{if(pU.store255[t])return;pU.store255[t]=i,pU.store1[t]=[i[0]/255,i[1]/255,i[2]/255,i[3]]}}}function pK(t,e=!1){return Array.isArray(t)&&(0,n4.Z)(t[0])?e?`rgb(${Math.round(t[0])},${Math.round(t[1])},${Math.round(t[2])},${t[3].toFixed(2)})`:`rgb(${Math.round(t[0])},${Math.round(t[1])},${Math.round(t[2])})`:t}function pX(t,e,i,r,n){return Array.isArray(t)&&!(0,n4.Z)(t[0])||Array.isArray(e)&&!(0,n4.Z)(e[0])?[,,,,].fill(0).map((n,l)=>{var s,a;return pY((0,rD.Z)(t)?null!=(s=t[l])?s:t[0]:t,(0,rD.Z)(e)?null!=(a=e[l])?a:e[0]:e,i,r)}):pY(t,e,i,r,n)}function pY(t,e,i,r,n){if(!t||!e)return t&&pK(t)||e&&pK(e)||!1;let l,s,a=!1,o=!1;if(Array.isArray(t)?l=t:"string"==typeof t?l=pU.Get(t,tc.Color255):a=!0,Array.isArray(e)?s=e:"string"==typeof e?s=pU.Get(e,tc.Color255):o=!0,a!==o){let l=a?t:e,s=a?e:t,o=Object.assign(Object.assign({},l),{stops:l.stops.map(t=>Object.assign(Object.assign({},t),{color:pK(s)}))});return a?pX(l,o,i,r,n):pX(o,l,i,r,n)}if(a){if(t.gradient===e.gradient){let r=t.stops,n=e.stops;if(r.length!==n.length)return!1;if("linear"===t.gradient){var h,d,u,c=t,p=e,g=i;let r=c.stops,n=p.stops;return{gradient:"linear",x0:c.x0+(p.x0-c.x0)*g,x1:c.x1+(p.x1-c.x1)*g,y0:c.y0+(p.y0-c.y0)*g,y1:c.y1+(p.y1-c.y1)*g,stops:Array(r.length).fill(0).map((t,e)=>({color:pQ(r[e].color,n[e].color,g),offset:r[e].offset+(n[e].offset-r[e].offset)*g}))}}if("radial"===t.gradient){var f=t,m=e,y=i;let r=f.stops,n=m.stops;return{gradient:"radial",x0:f.x0+(m.x0-f.x0)*y,x1:f.x1+(m.x1-f.x1)*y,y0:f.y0+(m.y0-f.y0)*y,y1:f.y1+(m.y1-f.y1)*y,r0:f.r0+(m.r0-f.r0)*y,r1:f.r1+(m.r1-f.r1)*y,stops:Array(r.length).fill(0).map((t,e)=>({color:pQ(r[e].color,n[e].color,y),offset:r[e].offset+(n[e].offset-r[e].offset)*y}))}}if("conical"===t.gradient){var v=t,b=e,_=i;let r=v.stops,n=b.stops;return{gradient:"conical",startAngle:v.startAngle+(b.startAngle-v.startAngle)*_,endAngle:v.endAngle+(b.endAngle-v.endAngle)*_,x:v.x+(b.x-v.x)*_,y:v.y+(b.y-v.y)*_,stops:Array(r.length).fill(0).map((t,e)=>({color:pQ(r[e].color,n[e].color,_),offset:r[e].offset+(n[e].offset-r[e].offset)*_}))}}}return!1}return n&&n(l,s),pK((h=l,d=s,u=i,[h[0]+(d[0]-h[0])*u,h[1]+(d[1]-h[1])*u,h[2]+(d[2]-h[2])*u,h[3]+(d[3]-h[3])*u]),r)}function p$(t,e,i){return`rgba(${t[0]+(e[0]-t[0])*i},${t[1]+(e[1]-t[1])*i},${t[2]+(e[2]-t[2])*i},${t[3]+(e[3]-t[3])*i})`}pU.store255={},pU.store1={};let pq=[0,0,0,0],pJ=[0,0,0,0];function pQ(t,e,i){return pU.Get(t,tc.Color255,pq),pU.Get(e,tc.Color255,pJ),`rgba(${Math.round(pq[0]+(pJ[0]-pq[0])*i)},${Math.round(pq[1]+(pJ[1]-pq[1])*i)},${Math.round(pq[2]+(pJ[2]-pq[2])*i)},${pq[3]+(pJ[3]-pq[3])*i})`}function p0(t,e,i,r,n,l){let s=(e-t)*n+t,a=(i-e)*n+e,o=(r-i)*n+i,h=(a-s)*n+s,d=(o-a)*n+a,u=(d-h)*n+h;l[0]=t,l[1]=s,l[2]=h,l[3]=u,l[4]=u,l[5]=d,l[6]=o,l[7]=r}function p1(t,e){let i=t||e,r=i.length,n=i[r-2],l=i[r-1],s=[];for(let t=0;t<e.length;t+=2)s[t]=n,s[t+1]=l;return s}function p2(t){let e=0,i=0,r=0,n=t.length;for(let l=0,s=n-2;l<n;s=l,l+=2){let n=t[s],a=t[s+1],o=t[l],h=t[l+1],d=n*h-o*a;e+=d,i+=(n+o)*d,r+=(a+h)*d}return 0===e?[t[0]||0,t[1]||0,0]:[i/e/3,r/e/3,e]}function p3(t){let e=new rp,i=t.toString();if(!i)return[];e.fromString(i);let r=e.tryBuildCurves();if(!r||0===r.length)return[];let n=[],l=null;l=[];let s=0,a=0,o=0,h=0,d=!0;for(let t=0;t<r.length;t++){let e=r[t];if(d&&(s=e.p0.x,a=e.p0.y,o=s,h=a,l=[s,a],n.push(l),d=!1),e.p1&&e.p2&&e.p3)l.push(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y),o=e.p3.x,h=e.p3.y;else if(e.p1&&e.p2){let t=e.p1.x,i=e.p1.y,r=e.p2.x,n=e.p2.y;l.push(o+2/3*(t-o),h+2/3*(i-h),r+2/3*(t-r),n+2/3*(i-n),r,n),o=r,h=n}else if(e.p1){let t=e.p1.x,i=e.p1.y;1e-10>Math.abs(o-t)&&1e-10>Math.abs(h-i)||l.push(o,h,t,i,t,i),o=t,h=i}if(r.length,t<r.length-1){let e=r[t+1];(Math.abs(o-e.p0.x)>1e-10||Math.abs(h-e.p0.y)>1e-10)&&(d=!0)}}let u=n.filter(t=>t.length>2);return 1===u.length?[u[0]]:u}function p5(t,e){for(let i=0;i<t.length;i++){let r=t[i];for(let t=0;t<r.length;t+=2){let i=r[t],n=r[t+1],l={x:i,y:n};e.transformPoint({x:i,y:n},l),r[t]=l.x,r[t+1]=l.y}}}function p4(t,e,i){let r,n,l=t/e;t>=e?(n=Math.ceil(Math.sqrt(i*l)),0===(r=Math.floor(i/n))&&(r=1,n=i)):(r=Math.ceil(Math.sqrt(i/l)),0===(n=Math.floor(i/r))&&(n=1,r=i));let s=[];for(let t=0;t<r;t++)s.push(n);let a=i-r*n;if(a>0)for(let t=0;t<a;t+=n)t+n<a?s.push(n):s.push(a-t);return s}let p6=(t,e)=>{let{width:i,height:r}=cD(t.attribute),n=p4(i,r,e),l=[],s=r/n.length;for(let t=0,e=n.length;t<e;t++){let e=n[t],r=i/e;for(let i=0;i<e;i++)l.push({x:0+i*r,y:0+t*s,width:r,height:s})}return l},p7=(t,e)=>{let i=t.getParsedAngle(),r=i.startAngle,n=i.endAngle,l=t.getComputedAttribute("innerRadius"),s=t.getComputedAttribute("outerRadius"),a=Math.abs(r-n),o=Math.abs(s-l),h=p4(a*(l+s)/2,o,e),d=[],u=o/h.length,c=s>=l?1:-1,p=n>=r?1:-1;for(let t=0,e=h.length;t<e;t++){let e=h[t],i=a/e;for(let n=0;n<e;n++)d.push({innerRadius:s-u*t*c,outerRadius:s-u*(t+1)*c,startAngle:r+i*n*p,endAngle:r+i*(n+1)*p})}return d},p8=(t,e)=>{let i=t.getComputedAttribute("startAngle"),r=t.getComputedAttribute("endAngle"),n=t.getComputedAttribute("radius"),l=Math.abs(i-r),s=p4(l*n,n,e),a=[],o=l/s[0],h=n/s.length,d=r>=i?1:-1;for(let t=0,e=s.length;t<e;t++)for(let e=0,r=s[t];e<r;e++)a.push({innerRadius:h*t,outerRadius:h*(t+1),startAngle:i+o*e*d,endAngle:i+o*(e+1)*d});return a},p9=(t,e)=>{let i=t.filter(t=>!1!==t.defined&&(0,n4.Z)(t.x)&&(0,n4.Z)(t.y));if(0===i.length)return[];if(1===i.length)return Array(e).fill(0).map(t=>i[0]);let r=[];if(e<=i.length){let t=i.length/e,n=0,l=0;for(;n<e;)r.push(i[Math.floor(l)]),l+=t,n++;return r}let n=e-i.length,l=1/(n/(i.length-1)+1),s=0;for(let e=0,i=t.length;e<i;e++)if(r.push(t[e]),e<i-1){let i=l,a=t[e].x,o=t[e].y,h=t[e+1].x,d=t[e+1].y;for(;i<1&&s<n;)r.push({x:a+(h-a)*i,y:o+(d-o)*i}),i+=l,s+=1}return r},gt=(t,e)=>{var i,r;let n=t.attribute,l=n.points,s=n.segments;l||(l=s.reduce((t,e)=>{var i;return t.concat(null!=(i=e.points)?i:[])},[]));let a=l.filter(t=>!1!==t.defined&&(0,n4.Z)(t.x)&&(0,n4.Z)(t.y));if(!a.length)return[];let o=[];a.forEach(t=>{o.push({x:t.x,y:t.y})});for(let t=a.length-1;t>=0;t--){let e=a[t];o.push({x:null!=(i=e.x1)?i:e.x,y:null!=(r=e.y1)?r:e.y})}let h=[];return gl(o,e,h),h},ge=(t,e)=>{let i=t.attribute,r=i.points;return r?p9(r,e):i.segments?p9(i.segments.reduce((t,e)=>{var i;return t.concat(null!=(i=e.points)?i:[])},[]),e):[]},gi=t=>t.map(t=>({x:t.x,y:t.y})),gr=(t,e,i)=>{let r=t.length,n=[];for(let a=0;a<r;a++){var l,s;let o=t[a],h=a===r-1?t[0]:t[a+1],d=(0,aj.Jz)([e.x,e.y],[i.x,i.y],[o.x,o.y],[h.x,h.y]);d&&"boolean"!=typeof d&&n.push({dot:(l=[d[0]-e.x,d[1]-e.x],s=[i.x-e.x,i.y-e.x],l[0]*s[1]-l[1]*s[0]),point:{x:d[0],y:d[1]},edgeIndex:a})}if(n.length<2)return[gi(t),gi(t)];n.sort((t,e)=>t.dot-e.dot);let a=n[0],o=n[n.length-1];a.edgeIndex>o.edgeIndex&&([a,o]=[o,a]);let h=a.point,d=o.point,u=[{x:h.x,y:h.y}];for(let e=a.edgeIndex+1;e<=o.edgeIndex;e++)u.push({x:t[e].x,y:t[e].y});u.push({x:d.x,y:d.y});let c=[{x:d.x,y:d.y}];for(let e=o.edgeIndex+1,i=a.edgeIndex+r;e<=i;e++){let i=t[e%r];c.push({x:i.x,y:i.y})}return c.push({x:h.x,y:h.y}),[u,c]},gn=t=>{let e=new iI.YZ;t.forEach(t=>{e.add(t.x,t.y)});let i=e.width(),r=e.height();if(i>=r){let r=e.x1+i/2;return gr(t,{x:r,y:e.y1},{x:r,y:e.y2})}let n=e.y1+r/2;return gr(t,{x:e.x1,y:n},{x:e.x2,y:n})},gl=(t,e,i)=>{if(1===e)i.push({points:t});else{let r=Math.floor(e/2),n=gn(t);gl(n[0],r,i),gl(n[1],e-r,i)}},gs=(t,e)=>{let i=t.attribute.points;if(!i||!i.length)return[];if(1===e)return[{points:gi(i)}];let r=[];return gl(i,e,r),r},ga=(t,e)=>{let i=p3(t.getParsedPathShape());if(!i.length||e<0)return[];let r=i.length;if(i.length>=e){let t=[],n=Math.floor(i.length/e);for(let l=0;l<e;l++){let s=i.slice(l*n,l===e-1?r:(l+1)*n);t.push({path:function(t){let e=new rp;for(let i=0;i<t.length;i++){let r=t[i];if(r.length>2){e.moveTo(r[0],r[1]);for(let t=2;t<r.length;t+=6)e.bezierCurveTo(r[t],r[t+1],r[t+2],r[t+3],r[t+4],r[t+5])}}return e}(s)})}return t}let n=[],l=Math.floor(e/r),s=e;for(let t=0;t<r;t++){let e=[];for(let r=2,n=i[t].length;r<n;r+=2)e.push({x:i[0][r],y:i[0][r+1]});gl(e,t===r-1?s:l,n),s-=l}return n};class go{constructor(){}static linear(t){return t}static none(){return this.linear}static get(t){return t<-1?t=-1:t>1&&(t=1),function(e){return 0===t?e:t<0?e*(-(e*t)+1+t):e*((2-e)*t+(1-t))}}static getPowIn(t){return function(e){return Math.pow(e,t)}}static getPowOut(t){return function(e){return 1-Math.pow(1-e,t)}}static getPowInOut(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}static getBackIn(t){return function(e){return e*e*((t+1)*e-t)}}static getBackOut(t){return function(e){return--e*e*((t+1)*e+t)+1}}static getBackInOut(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}static sineIn(t){return 1-Math.cos(t*Math.PI/2)}static sineOut(t){return Math.sin(t*Math.PI/2)}static sineInOut(t){return-(Math.cos(Math.PI*t)-1)/2}static expoIn(t){return 0===t?0:Math.pow(2,10*t-10)}static expoOut(t){return 1===t?1:1-Math.pow(2,-10*t)}static expoInOut(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}static circIn(t){return-(Math.sqrt(1-t*t)-1)}static circOut(t){return Math.sqrt(1- --t*t)}static circInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}static bounceOut(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}static bounceIn(t){return 1-go.bounceOut(1-t)}static bounceInOut(t){return t<.5?.5*go.bounceIn(2*t):.5*go.bounceOut(2*t-1)+.5}static getElasticIn(t,e){return function(i){if(0===i||1===i)return i;let r=e/ik.f7*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*ik.f7/e)}}static getElasticOut(t,e){return function(i){if(0===i||1===i)return i;let r=e/ik.f7*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-r)*ik.f7/e)+1}}static getElasticInOut(t,e){return function(i){let r=e/ik.f7*Math.asin(1/t);return(i*=2)<1?-(t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*ik.f7/e)*.5):t*Math.pow(2,-10*(i-=1))*Math.sin((i-r)*ik.f7/e)*.5+1}}static registerFunc(t,e){go[t]=e}}go.quadIn=go.getPowIn(2),go.quadOut=go.getPowOut(2),go.quadInOut=go.getPowInOut(2),go.cubicIn=go.getPowIn(3),go.cubicOut=go.getPowOut(3),go.cubicInOut=go.getPowInOut(3),go.quartIn=go.getPowIn(4),go.quartOut=go.getPowOut(4),go.quartInOut=go.getPowInOut(4),go.quintIn=go.getPowIn(5),go.quintOut=go.getPowOut(5),go.quintInOut=go.getPowInOut(5),go.backIn=go.getBackIn(1.7),go.backOut=go.getBackOut(1.7),go.backInOut=go.getBackInOut(1.7),go.elasticIn=go.getElasticIn(1,.3),go.elasticOut=go.getElasticOut(1,.3),go.elasticInOut=go.getElasticInOut(1,.3*1.5),go.easeInOutQuad=t=>(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2),go.easeOutElastic=t=>{let e=2*Math.PI/3;return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1},go.easeInOutElastic=t=>{let e=2*Math.PI/4.5;return 0===t?0:1===t?1:t<.5?-Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*e)/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*e)/2+1};for(let t=0;t<10;t++)go[`flicker${t}`]=e=>(function(t,e){let i=1/e,r=1;for(;t>i;)t-=i,r*=-1;let n=r*t/i;return n>0?n:1+n})(e,t);for(let t=2;t<10;t++)go[`aIn${t}`]=e=>t*e*e+(1-t)*e;let gh=new class{constructor(){this.opacity=(t,e,i,r,n,l)=>{l.attribute.opacity=e+(i-e)*r},this.baseOpacity=(t,e,i,r,n,l)=>{l.attribute.baseOpacity=e+(i-e)*r},this.fillOpacity=(t,e,i,r,n,l)=>{l.attribute.fillOpacity=e+(i-e)*r},this.strokeOpacity=(t,e,i,r,n,l)=>{l.attribute.strokeOpacity=e+(i-e)*r},this.zIndex=(t,e,i,r,n,l)=>{l.attribute.zIndex=e+(i-e)*r},this.backgroundOpacity=(t,e,i,r,n,l)=>{l.attribute.backgroundOpacity=e+(i-e)*r},this.shadowOffsetX=(t,e,i,r,n,l)=>{l.attribute.shadowOffsetX=e+(i-e)*r},this.shadowOffsetY=(t,e,i,r,n,l)=>{l.attribute.shadowOffsetY=e+(i-e)*r},this.shadowBlur=(t,e,i,r,n,l)=>{l.attribute.shadowBlur=e+(i-e)*r},this.fill=(t,e,i,r,n,l)=>{l.attribute.fill=pX(e,i,r,!1)},this.fillPure=(t,e,i,r,n,l)=>{l.attribute.fill=n.fromParsedProps.fill?p$(n.fromParsedProps.fill,n.toParsedProps.fill,r):n.toParsedProps.fill},this.stroke=(t,e,i,r,n,l)=>{l.attribute.stroke=pX(e,i,r,!1)},this.strokePure=(t,e,i,r,n,l)=>{l.attribute.stroke=n.fromParsedProps.stroke?p$(n.fromParsedProps.stroke,n.toParsedProps.stroke,r):n.toParsedProps.stroke},this.width=(t,e,i,r,n,l)=>{l.attribute.width=e+(i-e)*r,l.addUpdateBoundTag()},this.height=(t,e,i,r,n,l)=>{l.attribute.height=e+(i-e)*r,l.addUpdateBoundTag()},this.x=(t,e,i,r,n,l)=>{l.attribute.x=e+(i-e)*r,l.addUpdateBoundTag(),l.addUpdatePositionTag()},this.y=(t,e,i,r,n,l)=>{l.attribute.y=e+(i-e)*r,l.addUpdateBoundTag(),l.addUpdatePositionTag()},this.dx=(t,e,i,r,n,l)=>{l.attribute.dx=e+(i-e)*r,l.addUpdateBoundTag(),l.addUpdatePositionTag()},this.dy=(t,e,i,r,n,l)=>{l.attribute.dy=e+(i-e)*r,l.addUpdateBoundTag(),l.addUpdatePositionTag()},this.angle=(t,e,i,r,n,l)=>{l.attribute.angle=e+(i-e)*r,l.addUpdateBoundTag(),l.addUpdatePositionTag()},this.scaleX=(t,e,i,r,n,l)=>{l.attribute.scaleX=e+(i-e)*r,l.addUpdateBoundTag(),l.addUpdatePositionTag()},this.scaleY=(t,e,i,r,n,l)=>{l.attribute.scaleY=e+(i-e)*r,l.addUpdateBoundTag(),l.addUpdatePositionTag()},this.lineWidth=(t,e,i,r,n,l)=>{l.attribute.lineWidth=e+(i-e)*r,l.addUpdateBoundTag()},this.startAngle=(t,e,i,r,n,l)=>{l.attribute.startAngle=e+(i-e)*r,l.addUpdateBoundTag()},this.endAngle=(t,e,i,r,n,l)=>{l.attribute.endAngle=e+(i-e)*r,l.addUpdateBoundTag()},this.radius=(t,e,i,r,n,l)=>{l.attribute.radius=e+(i-e)*r,l.addUpdateBoundTag()},this.outerRadius=(t,e,i,r,n,l)=>{l.attribute.outerRadius=e+(i-e)*r,l.addUpdateBoundTag()},this.innerRadius=(t,e,i,r,n,l)=>{l.attribute.innerRadius=e+(i-e)*r,l.addUpdateBoundTag()},this.size=(t,e,i,r,n,l)=>{l.attribute.size=e+(i-e)*r,l.addUpdateBoundTag()},this.points=(t,e,i,r,n,l)=>{l.attribute.points=nQ(e,i,r),l.addUpdateBoundTag()}}};function gd(t,e,i,r,n,l){if(Number.isFinite(i)&&Number.isFinite(e))return l.attribute[t]=e+(i-e)*r,!0;if(Array.isArray(i)&&Array.isArray(e)&&i.length===e.length){let n=[],s=!0;for(let t=0;t<i.length;t++){let l=e[t],a=l+(i[t]-l)*r;if(!Number.isFinite(a)){s=!1;break}n.push(a)}return s&&(l.attribute[t]=n),!0}return!1}function gu(){}class gc{constructor(t,e,i,r){var n;this._startTime=0,this._hasFirstRun=!1,this._syncAttributeUpdate=()=>{this.target.setAttributes(this.target.attribute)},this.type=t,this.props=e,this.duration=i,this.easing=r?"function"==typeof r?r:null!=(n=go[r])?n:go.linear:go.linear,"wait"===t&&(this.onUpdate=gu),this.id=eJ.GenAutoIncrementId(),this.syncAttributeUpdate=gu}bind(t,e){this.target=t,this.animate=e,this.onBind(),this.syncAttributeUpdate()}append(t){this.next=t,t.prev=this,t.setStartTime(this.getStartTime()+this.duration,!1)}updateDownstreamStartTimes(){let t=this.next,e=this._startTime+this.duration;for(;t;)t.setStartTime(e,!1),e+=t.duration,t=t.next;this.animate.updateDuration()}getLastProps(){return this.prev?this.prev.props||{}:this.animate.getStartProps()}setDuration(t,e=!0){this.duration=t,e&&this.updateDownstreamStartTimes()}getDuration(){return this.duration}determineInterpolateUpdateFunction(){if(!this.props)return;let t=[];this.propKeys.forEach(e=>{if("fill"===e||"stroke"===e){let i=this.fromProps[e],r=this.props[e];if((0,nI.Z)(i)&&(0,nI.Z)(r)){let n=pU.Get(i,tc.Color255),l=pU.Get(r,tc.Color255);this.fromParsedProps||(this.fromParsedProps={}),this.toParsedProps||(this.toParsedProps={}),this.fromParsedProps[e]=n,this.toParsedProps[e]=l,t.push(gh["fill"===e?"fillPure":"strokePure"])}else gh[e]?t.push(gh[e]):t.push(gd)}else gh[e]?t.push(gh[e]):t.push(gd)}),this.interpolateUpdateFunctions=t}setStartTime(t,e=!0){this._startTime=t,e&&this.updateDownstreamStartTimes()}getStartTime(){return this._startTime}onBind(){"glyph"===this.target.type&&(this.syncAttributeUpdate=this._syncAttributeUpdate)}onFirstRun(){}onStart(){if(!this._hasFirstRun){this._hasFirstRun=!0,this.fromProps=this.getLastProps();let t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.fromProps[e]=null!=(i=this.fromProps[e])?i:t[e]}),this.determineInterpolateUpdateFunction(),this.tryPreventConflict(),this.trySyncStartProps(),this.onFirstRun()}}tryPreventConflict(){let t=this.animate;this.target.animates.forEach(e=>{if(e===t||e.priority>t.priority||e.priority===1/0)return;let i=e.getStartProps();this.propKeys.forEach(t=>{null!=i[t]&&e.preventAttr(t)})})}deleteSelfAttr(t){var e;delete this.props[t],this.fromProps&&delete this.fromProps[t];let i=this.propKeys.indexOf(t);-1!==i&&(this.propKeys.splice(i,1),null==(e=this.interpolateUpdateFunctions)||e.splice(i,1))}trySyncStartProps(){this.propKeys.forEach(t=>{this.fromProps[t]=this.animate.target.getComputedAttribute(t)})}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.fromProps[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}onUpdate(t,e,i){}onEnd(t){this.target.setAttributes(this.props),t?this._endCb=t:this._endCb&&this._endCb(this.animate,this)}getEndProps(){return this.props}getFromProps(){return this.fromProps}getMergedEndProps(){return this.getEndProps()}stop(){}release(){}}class gp extends gc{constructor(t,e,i,r){super(t,e,i,r)}onStart(){super.onStart();let t=this.getFromProps();this.target.setAttributes(t)}update(t,e,i){this.onStart()}determineInterpolateUpdateFunction(){}}class gg extends gc{constructor(t,e,i,r,n){super("customAnimate",e,i,r),this.type="customAnimate",this.customFrom=t,this.params=n,this.from=t,this.to=e}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.onUpdate(t,r,i),this.syncAttributeUpdate()}setProps(t){this.props=t,this.propKeys=Object.keys(t),this.animate.reSyncProps()}}class gf extends gg{completeBind(t){this.setStartTime(0),this._animator&&this._animator.start(),this.setDuration(t.getDuration())}stop(){this._animator&&this._animator.stop()}}class gm extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.willCallBeforeStageRender=!0,this.willCallAfterStageRender=!0,this._beforeStageRender=()=>{if(!this.willCallBeforeStageRender)return;this.willCallBeforeStageRender=!1;let t=this.target.stage,e=t.window.getContext().canvas.nativeCanvas,i=this.beforeStageRender(t,e);i&&this.renderToStage(t,i)},this._afterStageRender=()=>{if(!this.willCallAfterStageRender)return;this.willCallAfterStageRender=!1;let t=this.target.stage,e=t.window.getContext().canvas.nativeCanvas,i=this.afterStageRender(t,e);i&&this.renderToStage(t,i)},this.props={}}beforeStageRender(t,e){return!1}afterStageRender(t,e){return!1}onFirstRun(){super.onFirstRun(),this.target.stage.setBeforeRender(this._beforeStageRender),this.target.stage.setAfterRender(this._afterStageRender),this.target.stage.disableDirtyBounds()}stop(){super.stop(),this.target.stage.removeBeforeRender(this._beforeStageRender),this.target.stage.removeAfterRender(this._afterStageRender)}onUpdate(t,e,i){super.onUpdate(t,e,i),this.willCallBeforeStageRender=!0,this.willCallAfterStageRender=!0}renderToStage(t,e){let i=t.window.getContext().canvas.nativeCanvas,r=i.getContext("2d");return!!r&&(r.clearRect(0,0,i.width,i.height),r.drawImage(e,0,0),i)}}let gy={duration:1e3,easing:"quadInOut"},gv=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","scrollX","scrollY"],gb=t=>gv.includes(t),g_=(t,e,i)=>{t.forEach(t=>{if(Number.isFinite(t.to))e[t.key]=t.from+(t.to-t.from)*i;else if("fill"===t.key||"stroke"===t.key){let r=pX(t.from,t.to,i,!1);r&&(e[t.key]=r)}})},gC=(t,e,i)=>{let r=[],n=[];e.clear();for(let l=0;l<t.length;l++){let s=t[l],a=s.from,o=s.to,h=s.rotation*i,d=s.fromCp,u=s.toCp,c=Math.sin(h),p=Math.cos(h);n[0]=d[0]+(u[0]-d[0])*i,n[1]=d[1]+(u[1]-d[1])*i;for(let t=0;t<a.length;t+=2){let e=a[t],l=a[t+1],s=e*(1-i)+o[t]*i,h=l*(1-i)+o[t+1]*i;r[t]=s*p-h*c+n[0],r[t+1]=s*c+h*p+n[1]}let g=r[0],f=r[1];e.moveTo(g,f);for(let t=2;t<a.length;t+=6){let i=r[t],n=r[t+1],l=r[t+2],s=r[t+3],a=r[t+4],o=r[t+5];g===i&&f===n&&l===a&&s===o?e.lineTo(a,o):e.bezierCurveTo(i,n,l,s,a,o),g=a,f=o}}},gx=(t,e,i)=>{let r=t?p3(t):[],n=p3(e);i&&r&&(i.fromTransform&&p5(r,i.fromTransform.clone().getInverse()),p5(r,i.toTransfrom));let[l,s]=function(t,e){let i,r,n=[],l=[];for(let s=0;s<Math.max(t.length,e.length);s++){let a,o,h=t[s],d=e[s];h?d?([a,o]=function(t,e){let i=t.length,r=e.length;if(i===r)return[t,e];let n=[],l=[],s=i<r?t:e,a=Math.min(i,r),o=Math.abs(r-i)/6,h=Math.ceil(o/((a-2)/6)),d=[s[0],s[1]],u=o;for(let t=2;t<a;t+=6){let e=s[t-2],i=s[t-1],r=s[t],a=s[t+1],o=s[t+2],c=s[t+3],p=s[t+4],g=s[t+5];if(u<=0){d.push(r,a,o,c,p,g);continue}let f=Math.min(u,h)+1;for(let t=1;t<=f;t++){let s=t/f;p0(e,r,o,p,s,n),p0(i,a,c,g,s,l),e=n[3],i=l[3],d.push(n[1],l[1],n[2],l[2],e,i),r=n[5],a=l[5],o=n[6],c=l[6]}u-=f-1}return s===t?[d,e]:[t,d]}(h,d),i=a,r=o):(o=p1(r,h),a=h):(a=p1(i,d),o=d),n.push(a),l.push(o)}return[n,l]}(r,n);return t?function(t,e,i,r){let n,l=[];for(let i=0;i<t.length;i++){let s=t[i],a=e[i],o=p2(s),h=p2(a);null==n&&(n=o[2]<0!=h[2]<0);let d=[],u=[],c=0,p=1/0,g=[],f=s.length;n&&(s=function(t){let e=[],i=t.length;for(let r=0;r<i;r+=2)e[r]=t[i-r-2],e[r+1]=t[i-r-1];return e}(s));let m=6*function(t,e,i,r){let n=(t.length-2)/6,l=1/0,s=0,a=t.length,o=a-2;for(let h=0;h<n;h++){let n=6*h,d=0;for(let l=0;l<a;l+=2){let s=0===l?n:(n+l-2)%o+2,a=t[s]-i[0],h=t[s+1]-i[1],u=e[l]-r[0]-a,c=e[l+1]-r[1]-h;d+=u*u+c*c}d<l&&(l=d,s=h)}return s}(s,a,o,h),y=f-2;for(let t=0;t<y;t+=2){let e=(m+t)%y+2;d[t+2]=s[e]-o[0],d[t+3]=s[e+1]-o[1]}d[0]=s[m]-o[0],d[1]=s[m+1]-o[1];{let t=r/10;for(let e=-r/2;e<=r/2;e+=t){let t=Math.sin(e),i=Math.cos(e),r=0;for(let e=0;e<s.length;e+=2){let n=d[e],l=d[e+1],s=a[e]-h[0],o=a[e+1]-h[1],u=s*i-o*t,c=s*t+o*i;g[e]=u,g[e+1]=c;let p=u-n,f=c-l;r+=p*p+f*f}if(r<p){p=r,c=e;for(let t=0;t<g.length;t++)u[t]=g[t]}}}l.push({from:d,to:u,fromCp:o,toCp:h,rotation:-c})}return l}(l,s,10,Math.PI):s.map((t,e)=>({from:l[e],to:t,fromCp:[0,0],toCp:[0,0],rotation:0}))},gw=["fill","fillOpacity","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","lineDashOffset"],gS=(t,e)=>{if(!t||!e)return null;let i=[],r=!1;return Object.keys(t).forEach(n=>{if(!gw.includes(n))return;let l=e[n];if(!(0,nB.Z)(l)&&!(0,nB.Z)(t[n])&&l!==t[n]){if("fill"===n||"stroke"===n){let e=t=>"string"==typeof t?pU.Get(t,tc.Color255):t;i.push({from:(0,rD.Z)(t[n])?t[n].map(e):e(t[n]),to:(0,rD.Z)(l)?l.map(e):e(l),key:n})}else i.push({from:t[n],to:l,key:n});r=!0}}),r?i:null};class gA extends gg{constructor(t,e,i){super({},{},e,i),this.morphingData=t.morphingData,this.otherAttrs=t.otherAttrs,this.saveOnEnd=t.saveOnEnd}getEndProps(){return{}}onBind(){this.target.createPathProxy(),this.onUpdate(!1,0,this.target.attribute)}onEnd(){}onUpdate(t,e,i){let r=this.target,n="function"==typeof r.pathProxy?r.pathProxy(r.attribute):r.pathProxy;gC(this.morphingData,n,e),this.otherAttrs&&this.otherAttrs.length&&g_(this.otherAttrs,i,e),this.target.setAttributes(i),t&&!this.saveOnEnd&&(this.target.pathProxy=null)}}let gM=(t,e,i,r)=>{var n,l,s;if(t&&(!t.valid||!t.toCustomPath))return __DEV__&&console.error(t," is not validate"),null;if(!e.valid||!e.toCustomPath)return __DEV__&&console.error(e," is not validate"),null;let a=null==t?void 0:t.globalTransMatrix;r&&a&&(a=r.clone().multiply(a.a,a.b,a.c,a.d,a.e,a.f));let o=gx(null==(n=null==t?void 0:t.toCustomPath)?void 0:n.call(t),e.toCustomPath(),{fromTransform:a,toTransfrom:e.globalTransMatrix}),h=gS(null==t?void 0:t.attribute,e.attribute),d=e.animate(i);(null==i?void 0:i.delay)&&d.wait(i.delay);let u=new gA({morphingData:o,otherAttrs:h},null!=(l=null==i?void 0:i.duration)?l:gy.duration,null!=(s=null==i?void 0:i.easing)?s:gy.easing);return d.play(u),d},gT=(t,e,i)=>{var r;let n=e.filter(t=>t&&t.toCustomPath&&t.valid);n.length||__DEV__&&console.error(n," is not validate"),t.valid&&t.toCustomPath||__DEV__&&console.error(t," is not validate");let l=("clone"===(null==i?void 0:i.splitPath)?gB:null!=(r=null==i?void 0:i.splitPath)?r:gI)(t,n.length,!1),s=null==i?void 0:i.onEnd,a=n.length,o=()=>{0==--a&&s&&s()};n.forEach((e,r)=>{var s;let a=l[r],h=(null!=(s=null==i?void 0:i.delay)?s:0)+((null==i?void 0:i.individualDelay)?i.individualDelay(r,n.length,a,e):0);gM(a,e,Object.assign({},i,{onEnd:o,delay:h}),t.globalTransMatrix)})};class gk extends gg{constructor(t,e,i){super({},{},e,i),this.morphingData=t.morphingData,this.otherAttrs=t.otherAttrs}getEndProps(){return{}}onBind(){this.addPathProxy()}addPathProxy(){this.target.shadowRoot.forEachChildren(t=>{t.createPathProxy()}),this.onUpdate(!1,0,this.target.attribute)}clearPathProxy(){this.target.shadowRoot.forEachChildren(t=>{t.pathProxy=null})}onEnd(){}onUpdate(t,e,i){this.target.shadowRoot.forEachChildren((t,i)=>{var r;gC(this.morphingData[i],"function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy,e),(null==(r=this.otherAttrs)?void 0:r[i])&&this.otherAttrs[i].length&&g_(this.otherAttrs[i],t.attribute,e)}),t&&(this.clearPathProxy(),this.morphingData=null)}}let gR=t=>{let e={};return Object.keys(t).forEach(i=>{gb(i)||(e[i]=t[i])}),e},gP=(t,e,i)=>{let r=gR(t.attribute),n=t.attachShadow();if(e.length)n.setTheme({[e[0].type]:r}),e.forEach(t=>{t.setAttributes({pickable:!1}),n.appendChild(t)});else{let l=t.AABBBounds,s=l.width(),a=l.height();n.setTheme({rect:r}),Array(i).fill(0).forEach(t=>{let i=iC.graphicService.creator.rect({x:0,y:0,width:s,height:a,pickable:!1});n.appendChild(i),e.push(i)})}},gB=(t,e,i)=>{let r=[],n=i?null:gR(t.attribute),l=t.toCustomPath();for(let t=0;t<e;t++){let t={path:(new rp).fromCustomPath2D(l)};r.push(iC.graphicService.creator.path(i?t:Object.assign({},n,t)))}return i&&gP(t,r,e),r},gI=(t,e,i)=>{let r=[],n=i?null:gR(t.attribute);if("rect"===t.type)p6(t,e).forEach(t=>{r.push(iC.graphicService.creator.rect(i?t:Object.assign({},n,t)))});else if("arc"===t.type)p7(t,e).forEach(t=>{r.push(iC.graphicService.creator.arc(i?t:Object.assign({},n,t)))});else if("circle"===t.type)p8(t,e).forEach(t=>{r.push(iC.graphicService.creator.arc(i?t:Object.assign({},n,t)))});else if("line"===t.type){let l=ge(t,e),s={size:10,symbolType:"circle"};l.forEach(t=>{r.push(iC.graphicService.creator.symbol(i?Object.assign({},t,s):Object.assign({},n,t,s)))})}else"polygon"===t.type?gs(t,e).forEach(t=>{r.push(iC.graphicService.creator.polygon(i?t:Object.assign({},n,t)))}):"area"===t.type?gt(t,e).forEach(t=>{r.push(iC.graphicService.creator.polygon(i?t:Object.assign({},n,t)))}):"path"===t.type&&ga(t,e).forEach(t=>{"path"in t?r.push(iC.graphicService.creator.path(i?t:Object.assign({},n,t))):r.push(iC.graphicService.creator.polygon(i?t:Object.assign({},n,t)))});return i&&gP(t,r,e),r},gE=(t,e,i)=>{var r,n,l;let s=t.filter(t=>t.toCustomPath&&t.valid);s.length||__DEV__&&console.error(t," is not validate"),e.valid&&e.toCustomPath||__DEV__&&console.error(e," is not validate");let a=("clone"===(null==i?void 0:i.splitPath)?gB:null!=(r=null==i?void 0:i.splitPath)?r:gI)(e,s.length,!0),o=e.attribute;e.setAttribute("visible",!1);let h=s.map((t,e)=>gx(t.toCustomPath(),a[e].toCustomPath(),{fromTransform:t.globalTransMatrix,toTransfrom:a[e].globalTransMatrix})),d=s.map((t,e)=>gS(t.attribute,o));if(null==i?void 0:i.individualDelay){let r=i.onEnd,n=s.length,l=()=>{0==--n&&(e.setAttributes({visible:!0,ratio:null},!1,{type:o3.ANIMATE_END}),e.detachShadow(),r&&r())};a.forEach((e,r)=>{var n,a,o;let u=(null!=(n=i.delay)?n:0)+i.individualDelay(r,s.length,t[r],e),c=e.animate(Object.assign({},i,{onEnd:l}));c.wait(u),c.play(new gA({morphingData:h[r],saveOnEnd:!0,otherAttrs:d[r]},null!=(a=i.duration)?a:gy.duration,null!=(o=i.easing)?o:gy.easing))})}else{let t=null==i?void 0:i.onEnd,r=i?Object.assign({},i):{};r.onEnd=()=>{e.setAttribute("visible",!0,!1,{type:o3.ANIMATE_END}),e.detachShadow(),t&&t()};let s=e.animate(r);(null==i?void 0:i.delay)&&s.wait(i.delay),s.play(new gk({morphingData:h,otherAttrs:d},null!=(n=null==i?void 0:i.duration)?n:gy.duration,null!=(l=null==i?void 0:i.easing)?l:gy.easing))}},gL=(t,e,i,r)=>"function"==typeof t?t(e,i,r):t,gF=(t,e,i,r,n)=>{var l;let s={prev:t.map(t=>{var e,i;return null==(i=null==(e=t.context)?void 0:e.data)?void 0:i[0]}),next:e.map(t=>{var e,i;return null==(i=null==(e=t.context)?void 0:e.data)?void 0:i[0]})},a={prev:t.slice(),next:e.slice()},o=null!=(l=i.animation)?l:{},h=o.easing,d=gL(o.delay,n,s,a),u=gL(o.duration,n,s,a),c=gL(o.oneByOne,n,s,a),p=gL(o.splitPath,n,s,a),g=(0,hy.Z)(c)&&c>0?t=>(0,n4.Z)(c)?t*c:!0===c?t*u:0:void 0;1!==t.length&&0!==t.length||1!==e.length?1===t.length&&e.length>1?gT(t[0],e,{delay:d,duration:u,easing:h,onEnd:r,individualDelay:g,splitPath:p}):t.length>1&&1===e.length&&gE(t,e[0],{delay:d,duration:u,easing:h,onEnd:r,individualDelay:g,splitPath:p}):gM(t[0],e[0],{delay:d,duration:u,easing:h,onEnd:r})},gO=(t,e)=>{let i=Math.floor(t.length/e);return Array(e).fill(0).map((r,n)=>t.slice(i*n,n===e-1?t.length:i*(n+1)))},gH=t=>{let e=t.getMarkConfig();(0,aw.Z)(e.morphElementKey)&&t.getGraphics().forEach(t=>{var i,r;let n=null==(r=null==(i=t.context)?void 0:i.data)?void 0:r[0];n&&(t.context.morphKey=n[e.morphElementKey])})},gD=(t,e,i={})=>{let r=[],n=[];t.forEach(t=>{gH(t),r.push(...t.getGraphics())}),e.forEach(t=>{gH(t),n.push(...t.getGraphics())});let l=t=>{var e,i,r;return null!=(i=null==(e=t.context)?void 0:e.morphKey)?i:null==(r=t.context)?void 0:r.key},s=new Map,a=new Map;if(r.forEach(t=>{let e=l(t);e&&(s.has(e)||s.set(e,[]),s.get(e).push(t))}),n.forEach(t=>{let e=l(t);e&&(a.has(e)||a.set(e,[]),a.get(e).push(t))}),s.size!==a.size||!Array.from(s.keys()).every(t=>a.has(t)))return!1;let o=[...new Set([...s.keys()].filter(t=>a.has(t)))],h=[...a.keys()].filter(t=>!s.has(t)),d=0,u=()=>{0==(d-=1)&&e.forEach(t=>{})};return h.forEach(t=>{gF([],a.get(t),i,u,{}),d+=1}),o.forEach(t=>{let e=s.get(t),r=a.get(t),n=Math.min(e.length,r.length);if(n>0){let t=gO(e,n),l=gO(r,n);for(let e=0;e<n;e++)gF(t[e],l[e],i,u,{}),d+=1}}),0===d&&u(),!0};var gz=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class gW extends pG{commit(t,e){e&&this.getMarks().length>0&&this.getMarks().forEach(t=>t.commit(!1,e)),this._isCommited=!0,t&&this.getCompiler().renderNextTick()}uncommit(){this._isCommited=!1}isCommited(){return this._isCommited}getMarkConfig(){return this._markConfig}setMarkConfig(t){Object.keys(t).forEach(e=>{this._markConfig[e]=t[e]})}getVisible(){return this._visible}setVisible(t){this._visible=t}getUserId(){return this._userId}setUserId(t){(0,aw.Z)(t)&&(this._userId=t)}getDataView(){var t;return null==(t=this._data)?void 0:t.getDataView()}setDataView(t){(0,nB.Z)(this._data)&&this.initMarkData(this._option),this._data.setDataView(t)}getData(){return this._data}setData(t){this._data=t,t&&t.addRelatedMark(this)}hasState(t){return t in this.state.getStateMap()}getState(t){return this.state.getStateMap()[t]}getAnimationConfig(){return this._animationConfig}setAnimationConfig(t){let e="group"===this.type?{selfOnly:!0}:{},i=t=>{var i;let r=null!=(i=t.options)?i:{};return Object.assign(Object.assign(Object.assign({},e),t),{options:(t,e,i)=>{var n,l;let s="function"==typeof r?r(t,e,i):r;if(e&&e.context&&e.context.compiler&&(0,aw.Z)(e.context.modelId)){let t=null==(n=e.context.compiler.getChart())?void 0:n.getModelById(e.context.modelId);return Object.assign(Object.assign({},s),{layoutRect:null==(l=null==t?void 0:t.getLayoutRect)?void 0:l.call(t)})}return Object.assign({},s)}})},r={};Object.keys(t).forEach(e=>{let n=t[e];(0,rD.Z)(n)?r[e]=n.map(i):(0,aw.Z)(n)&&(r[e]=i(n))}),this._animationConfig=r}disableAnimationByState(t){let e=(0,a1.IX)(t);this._disabledAnimationStates=[...new Set([...this._disabledAnimationStates,...e])]}enableAnimationByState(t){let e=(0,a1.IX)(t);this._disabledAnimationStates=this._disabledAnimationStates.filter(t=>!e.includes(t))}setSkipBeforeLayouted(t){this._skipBeforeLayouted=t}setGroupKey(t){this._groupKey=t}getProduct(){return this._product}initMarkData(t){this._data=new pV(t),this._data.addRelatedMark(this)}_compileProduct(t){this.commit(),this._context=null==t?void 0:t.context;let e=this.getProduct();if(this._visible){if((0,aw.Z)(e))t.group&&e.parent!==t.group&&t.group.appendChild(e);else{if(!this.getCompiler().isInited)return;this._initProduct(null==t?void 0:t.group)}(0,nB.Z)(this._product)||(this.compileData(),this.compileState(),this.compileEncode())}else(0,aw.Z)(e)&&this.removeProduct()}_initProduct(t){var e;if(!this.getStage())return;let i=this.getProductId();this._product=sG("group"!==this.type?{pickable:!1,zIndex:this._markConfig.zIndex,overflow:this._markConfig.overflow}:{}),this._product.name=i,this._product.mark=this,(null!=t?t:null==(e=this.getCompiler())?void 0:e.getRootGroup()).appendChild(this._product),this._compiledProductId=i}generateProductId(){return this._userId?`${this._userId}`:`${this.name}_${this.id}`}layout(t){}compileData(){(0,nB.Z)(this._data)||this._data.compile()}compileEncode(){}compileState(){}compileAnimation(){}compileContext(t){this._context=Object.assign({markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId},t)}getContext(){return this._context}compileTransform(){}updateState(t,e){return this.commit(),this.state.updateState(t,e)}getMarks(){return[]}runAnimationByState(t){}stopAnimationByState(t){}pauseAnimationByState(t){}resumeAnimationByState(t){}removeProduct(){this._product&&this._product.parent&&this._product.parent.removeChild(this._product),this._product=null,this._compiledProductId=null}release(){this.state.release(),super.release(),this._lastMark=null}setSimpleStyle(t){this._simpleStyle=t}getSimpleStyle(){return this._simpleStyle}constructor(t,e){var i;super(e),this.type=void 0,this.name="mark",this._markConfig={zIndex:ts.Mark,morph:!1},this._visible=!0,this.stateStyle={},this._unCompileChannel={},this._disabledAnimationStates=[],this._skipBeforeLayouted=!1,this._extensionChannel={},this._computeExChannel={},this._graphicMap=new Map,this._graphics=[],this._getEncoderOfStyle=(t,e)=>{if(e&&t){let i={};return Object.keys(e).forEach(e=>{this._unCompileChannel[e]||(i[e]=this._computeAttribute(e,t))}),i}return null},this._setGraphicFromMarkConfig=t=>{let{setCustomizedShape:e,graphicName:i}=this._markConfig;e&&(t.pathProxy=i=>e(t.context.data,i,new rp)),i&&((0,nz.Z)(i)?t.name=i(t):t.name=i)},this._setStateOfGraphic=(t,e)=>{t.clearStates(),t.stateProxy=null,t.context.diffState!==th.enter&&t.context.diffState!==th.update||(t.stateProxy=(e,i)=>{var r;return this._runEncoderOfGraphic(null==(r=this._encoderOfState)?void 0:r[e],t)},t.context.states&&t.useStates(t.context.states,e))},this.name=t,this.model=e.model,this.key=e.key,this.state=new pj(e,this),this._attributeContext=e.attributeContext,null==(i=e.map)||i.set(this.id,this)}created(){this._initStyle()}initStyleWithSpec(t){t&&((0,aw.Z)(t.id)&&(this._userId=t.id),(0,nD.Z)(t.interactive)&&(this._markConfig.interactive=t.interactive),(0,aw.Z)(t.zIndex)&&(this._markConfig.zIndex=t.zIndex),(0,nD.Z)(t.visible)&&this.setVisible(t.visible),this._markConfig.setCustomizedShape=t.customShape,this._stateSort=t.stateSort,this._initSpecStyle(t))}_transformStyleValue(t,e){if(t.scale){let i=t.scale,r=i.range();return i.range(r.map(e)),t}return"function"==typeof t?(...i)=>e(t(...i)):e(t)}convertAngleToRadian(t){return this._transformStyleValue(t,iH.M4)}isUserLevel(t){return[to.User_Mark,to.User_Series,to.User_Chart,to.User_SeriesStyle].includes(t)}setStyle(t,e="normal",i=0){if((0,nB.Z)(t))return;void 0===this.stateStyle[e]&&(this.stateStyle[e]={});let r=this.isUserLevel(i);Object.keys(t).forEach(n=>{let l=t[n];(0,nB.Z)(l)||(l=this._filterAttribute(n,l,e,i,r),this.setAttribute(n,l,e,i))})}getStyle(t,e="normal"){var i;return null==(i=this.stateStyle[e][t])?void 0:i.style}_filterAttribute(t,e,i,r,n){let l=this._styleConvert(e);if(n)switch(t){case"angle":l=this.convertAngleToRadian(l);break;case"innerPadding":case"outerPadding":l=this._transformStyleValue(l,t=>-t);break;case"curveType":l=this._transformStyleValue(l,t=>{var e;return e=this._option.model.direction,"monotone"===t?"horizontal"===e?"monotoneY":"monotoneX":t})}return l}setReferer(t,e,i){var r;if(t)if(e&&i){let n=null!=(r=this.stateStyle[i])?r:{[e]:{}};this.stateStyle[i][e]=Object.assign(Object.assign({},n[e]),{referer:t})}else Object.entries(this.stateStyle).forEach(([e,i])=>{Object.entries(i).forEach(([i,r])=>{this.stateStyle[e][i].referer=t})})}setPostProcess(t,e,i="normal"){var r;(null==(r=this.stateStyle[i])?void 0:r[t])&&(this.stateStyle[i][t].postProcess=e)}getAttribute(t,e,i="normal"){return this._computeAttribute(t,i)(e)}getAttributesOfState(t,e="normal"){let i=this.stateStyle[e];if(i){let r={};return Object.keys(i).forEach(i=>{this._unCompileChannel[i]||(r[i]=this._computeAttribute(i,e)(t))}),r}}setAttribute(t,e,i="normal",r=0){var n;void 0===this.stateStyle[i]&&(this.stateStyle[i]={}),void 0===this.stateStyle[i][t]&&(this.stateStyle[i][t]={level:r,style:e,referer:void 0});let l=null==(n=this.stateStyle[i][t])?void 0:n.level;(0,aw.Z)(l)&&l<=r&&h5(this.stateStyle[i][t],{style:e,level:r}),"normal"!==i&&t in this._extensionChannel&&this._extensionChannel[t].forEach(t=>{void 0===this.stateStyle[i][t]&&(this.stateStyle[i][t]=this.stateStyle.normal[t])})}_getDefaultStyle(){return{visible:!0,x:0,y:0}}_styleConvert(t){if(!t)return t;if((0,pW.dx)(t.type)||t.scale){let e=pL(t,{globalScale:this._option.globalScale,seriesId:this._option.seriesId});if(e)return{scale:e,field:t.field,changeDomain:t.changeDomain}}return t}_computeAttribute(t,e){var i;let r=null==(i=this.stateStyle[e])?void 0:i[t];r||(r=this.stateStyle.normal[t]);let n=this._computeStateAttribute(r,t,e),l=(0,nz.Z)(null==r?void 0:r.postProcess),s=t in this._computeExChannel;if(l&&s){let i=this._computeExChannel[t];return l=>{let s=n(l);return s=r.postProcess(s,l,this._attributeContext,this.getDataView()),i(t,l,e,s)}}if(l)return t=>r.postProcess(n(t),t,this._attributeContext,this.getDataView());if(s){let i=this._computeExChannel[t];return r=>i(t,r,e,n(r))}return n}_computeStateAttribute(t,e,i){var r;return t?t.referer?t.referer._computeAttribute(e,i):t.style?"function"==typeof t.style?e=>t.style(e,this._attributeContext,{mark:this},this.getDataView()):pD.includes(t.style.gradient)?this._computeGradientAttr(t.style):["outerBorder","innerBorder"].includes(e)?this._computeBorderAttr(t.style):(0,pW.dx)(null==(r=t.style.scale)?void 0:r.type)?e=>{let i=e;return"series"===this.model.modelType&&this.model.getMarkData&&(i=this.model.getMarkData(e)),t.style.scale.scale(i[t.style.field])}:e=>t.style:e=>t.style:t=>{}}_initStyle(){let t=this._getDefaultStyle();this.setStyle(t,"normal",0)}_initSpecStyle(t){t.style&&this.setStyle(t.style,"normal",to.User_Mark);let e=t.state;e&&Object.keys(e).forEach(t=>{let i=e[t];if("style"in i){let e=i.style,r={stateValue:t};"level"in i&&(r.level=i.level),"filter"in i&&(r=(0,nz.Z)(i.filter)?Object.assign({filter:i.filter},r):Object.assign(Object.assign({},i.filter),r)),this.state.addStateInfo(r),this.setStyle(e,t,to.User_Mark)}else this.setStyle(i,t,to.User_Mark)})}_computeGradientAttr(t){var e,i;let{gradient:r,scale:n,field:l}=t,s=gz(t,["gradient","scale","field"]),a=n,o=l;if(!(n&&l||"series"!==this.model.modelType)){let{scale:t,field:e}=this.model.getColorAttribute();n||(a=t),o||(o=e)}let h=h$(hY(this.model.getColorScheme(),"series"===this.model.modelType?null==(i=(e=this.model).getSpec)?void 0:i.call(e):void 0),this.model.getDefaultColorDomain()),d=Object.assign(Object.assign({},pz[r]),s);return t=>{let e={},i=this.getDataView();return Object.keys(d).forEach(r=>{let n=d[r];"stops"===r?e.stops=n.map(e=>{let{opacity:r,color:n,offset:l}=e,s=null!=n?n:null==a?void 0:a.scale(t[o]);return(0,nz.Z)(n)&&(s=n(t,this._attributeContext,i)),(0,aw.Z)(r)&&(s=hj.Il.SetOpacity(s,r)),{offset:(0,nz.Z)(l)?l(t,this._attributeContext,i):l,color:s||h[0]}}):(0,nz.Z)(n)?e[r]=n(t,this._attributeContext,i):e[r]=n}),e.gradient=r,e}}_computeBorderAttr(t){let{scale:e,field:i}=t,r=gz(t,["scale","field"]);return t=>{var n,l,s;let a={};if(Object.keys(r).forEach(e=>{let i=r[e];(0,nz.Z)(i)?a[e]=i(t,this._attributeContext,this.getDataView()):a[e]=i}),"stroke"in a)pD.includes(null==(s=r.stroke)?void 0:s.gradient)&&(a.stroke=this._computeGradientAttr(r.stroke)(t));else{let r=h$(hY(this.model.getColorScheme(),"series"===this.model.modelType?null==(l=(n=this.model).getSpec)?void 0:l.call(n):void 0),this.model.getDefaultColorDomain()),s=e,o=i;if(!(e&&i||"series"!==this.model.modelType)){let{scale:i,field:n}=this.model.getColorAttribute();e||(s=i),o||(o=n),a.stroke=(null==s?void 0:s.scale(t[o]))||r[0]}}return a}}_getDataByKey(t){return uT(t,(t,e)=>{var i;return`${this._groupKeyGetter(t)}_${null!=(i=this._keyGetter(t))?i:e}`})}_getCommonContext(){return{compiler:this.getCompiler(),markType:this.type,markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId}}prepareMorph(t){this._lastMark=t}reuse(t){this.type===t.type&&(this._product=t.getProduct(),this._graphics=t.getGraphics(),this._graphicMap=t._graphicMap,this._graphicMap.forEach(t=>{t.context=Object.assign(Object.assign({},t.context),this._getCommonContext())}),this._dataByKey=t._dataByKey,this._prevDataByKey=t._prevDataByKey,this.needClear=t.needClear)}_parseProgressiveContext(t){let e=this._markConfig.progressiveStep>0&&this._markConfig.progressiveThreshold>0&&this._markConfig.progressiveStep<this._markConfig.progressiveThreshold,i=this._markConfig.large&&this._markConfig.largeThreshold>0&&t.length>=this._markConfig.largeThreshold;if(e){let e=this._dataByGroup;return e&&e.keys&&e.keys.some(t=>e.data.get(t).length>this._markConfig.progressiveThreshold)?{large:i,progressive:{data:t,step:this._markConfig.progressiveStep,currentIndex:0,totalStep:e.keys.reduce((t,i)=>Math.max(Math.ceil(e.data.get(i).length/this._markConfig.progressiveStep),t),1),groupedData:e.data}}:{large:i}}return{large:i}}getGraphics(){return this._graphics}_createGraphic(t={}){return h9.createGraphicComponent(this.type,t)}_runGroupData(t){this._keyGetter=(0,nz.Z)(this.key)?this.key:(0,aw.Z)(this.key)?t=>null==t?void 0:t[this.key]:t=>null==t?void 0:t[un],this._groupKeyGetter=(0,aw.Z)(this._groupKey)?t=>`${null==t?void 0:t[this._groupKey]}`:()=>"key",this._dataByGroup=uT(t,this._groupKeyGetter)}getAnimationState(){let t=this._graphics.map(t=>t.context.animationState),e=t.every(t=>t===tr.appear)?tr.appear:t.every(t=>t===tr.disappear)?tr.disappear:t[0];return null!=e?e:tr.none}createAnimationStateList(t,e){var i;let r=e[t];return r&&Array.isArray(r)&&(r=1===r.length?r[0]:r),Array.isArray(r)?r.map((t,e)=>{var i;return Object.assign(Object.assign({},t),{priority:null!=(i=t.priority)?i:1/0})}):r?Object.assign(Object.assign({},r),{priority:"normal"===t?null!=(i=r.priority)?i:1/0:r.priority}):r}tryRunMorphing(t){if(this._lastMark){t.forEach(t=>{"appear"!==t.context.animationState&&"enter"!==t.context.animationState||t.setAttributes(t.getAttributes(!0))});let e=gD([this._lastMark],[this],{});return this._lastMark=null,e}return!1}_runStateAnimation(t){var e,i;if(!this._animationConfig||0===t.length||this.tryRunMorphing(t))return;let r=this.getAnimationConfig();if(null!=(e=this._markConfig.useSequentialAnimation)&&e&&this._runSequentialAnimations)return void this._runSequentialAnimations(t);let n=t.every(t=>"appear"===t.context.animationState),l=this.createAnimationStateList("appear",r);if(n&&this._product){let t=l?["appear"]:[],e=l?[{name:"appear",animation:l}]:[];if(r.normal){t.push("normal");let i={name:"normal",animation:this.createAnimationStateList("normal",r)};e.push(i)}this._product.applyAnimationState(t,e)}let s=!1;if(t.forEach(t=>{let e=t.context.animationState;if("appear"===e)return;let i=r[e];if(i&&i.length>0){let r=i.map((t,i)=>({name:`${e}_${i}`,animation:t}));r.forEach(e=>{e.animation.customParameters=t.context});let n=[e];t.applyAnimationState(n,[1===r.length?r[0]:r])}"enter"===e&&r.normal&&(s=!0)}),s&&this._product&&(null==(i=r.normal)?void 0:i.length)){this._product.stopAnimationState("normal","start");let t={name:"normal",animation:this.createAnimationStateList("normal",r)};this._product.applyAnimationState(["normal"],[t])}}_setAnimationState(t){var e,i,r;let n=(("component"===this.type?this.model.getAnimationStateCallback():null==(r=null==(i=(e=this.model).getRegion)?void 0:i.call(e))?void 0:r.getAnimationStateCallback())||(t=>{var e;let i=null==(e=t.context)?void 0:e.diffState;return i===tr.exit?tr.exit:i===tr.update?tr.update:tr.appear}))(t);t.context.animationState=null!=n?n:t.context.diffState,t.context.animationState===th.exit&&(t.context.reusing=!0,t.animates&&t.animates.forEach(t=>t.stop()))}_runJoin(t){let e=this._getDataByKey(t),i=this._prevDataByKey,r=[],n=new Set(this._graphics.filter(t=>t.context.diffState===th.enter)),l=(t,e,i)=>{var l,s,a,o,h,d,u,c,p;let g,f;return(0,nB.Z)(e)?(g=this._graphicMap.get(t))&&(f=th.exit):(0,nB.Z)(i)?(g=this._graphicMap.has(t)?this._graphicMap.get(t):{},f=th.enter,g.isExiting=!1,this._graphicMap.set(t,g),r.push(g)):(g=this._graphicMap.get(t))&&(f=th.update,r.push(g)),g&&(n.delete(g),g.context=Object.assign(Object.assign({},this._getCommonContext()),{diffState:f,reusing:null==(l=g.context)?void 0:l.reusing,originalFieldX:null==(s=g.context)?void 0:s.originalFieldX,originalFieldY:null==(a=g.context)?void 0:a.originalFieldY,fieldX:null==(o=g.context)?void 0:o.fieldX,fieldY:null==(h=g.context)?void 0:h.fieldY,data:null!=e?e:null==(d=g.context)?void 0:d.data,uniqueKey:t,key:e?this._keyGetter(e[0]):null==(u=g.context)?void 0:u.key,groupKey:e?this._groupKeyGetter(e[0]):null==(c=g.context)?void 0:c.groupKey,indexKey:"__VCHART_DEFAULT_DATA_INDEX",stateAnimateConfig:null==(p=this.getAnimationConfig())?void 0:p.state}),this._setAnimationState(g)),g};if(i&&e){let t=new Map(i.data);e.keys.forEach(i=>{l(i,e.data.get(i),t.get(i)),t.delete(i)}),i.keys.forEach(e=>{t.has(e)&&l(e,null,t.get(e))})}else e?e.keys.forEach(t=>{let i=l(t,e.data.get(t),null);i&&(i.context.animationState=tr.appear)}):i&&i.keys.forEach(t=>{l(t,null,i.data.get(t)).context.animationState=tr.disappear});n.forEach(t=>{this._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release()});let s=r.length;r.forEach((t,e)=>{t.context.graphicCount=s,t.context.graphicIndex=e}),this._dataByKey=e,this._graphics=r,this.needClear=!0}_runEncoderOfGraphic(t,e,i={}){return uk(t,e.context.data[0],i)}_runGroupEncoder(t){if(!this._dataByGroup)return null;let e={};return this._dataByGroup.keys.forEach(i=>{e[i]=uk(t,this._dataByGroup.data.get(i)[0])}),this._attrsByGroup=e,e}_transformGraphicAttributes(t,e,i){return Object.assign(Object.assign({},i),e)}_separateNormalStyle(t){let e={},i={};return Object.keys(t).forEach(r=>{this._unCompileChannel[r]||(this._option.noSeparateStyle||function(t,e,i){var r,n,l;let s=null==(r=e[t])?void 0:r.style;return n=t,l=s,!!(("fill"===n||"stroke"===n)&&(null==l?void 0:l.gradient)&&(null==l?void 0:l.stops)||(0,nz.Z)(s))||!(!(null==s?void 0:s.scale)||s.field===i)}(r,t,this._groupKey)?e[r]=t[r]:i[r]=t[r])}),{updateStyles:e,groupStyles:i}}_addProgressiveGraphic(t,e){t.incrementalAppendChild(e)}_runEncoder(t,e){var i;let r=e?null:this._runGroupEncoder(null==(i=this._encoderOfState)?void 0:i.group);t.forEach((t,e)=>{var i;let n=this._runEncoderOfGraphic(null==(i=this._encoderOfState)?void 0:i.update,t);(0,nB.Z)(this._markConfig.interactive)||(n.pickable=this._markConfig.interactive);let l=this._transformGraphicAttributes(t,n,null==r?void 0:r[t.context.groupKey]);t.context.finalAttrs=l})}_runApplyGraphic(t){let e=this.hasAnimation();t.forEach((i,r)=>{var n,l;let s=i.context.finalAttrs,a=this.hasAnimationByState(i.context.animationState);if(i.setAttributes){let t=dk(i,s);i.context.diffAttrs=t,i.context.reusing?(i.context.lastAttrs=i.attribute,i.initAttributes({}),i.context.reusing=!1):a||(e?i.setAttributesAndPreventAnimate(t):i.setAttributes(t)),e&&i.setFinalAttributes(s)}else{let a=i;i=this._createGraphic(s),e&&(null==(n=i.setFinalAttributes)||n.call(i,s)),i.context=a.context,i.context.diffAttrs=s;let o=this._graphics===t?r:r+this._graphics.length-t.length;if(o>=0&&(this._graphics[o]=i),null==(l=this.renderContext)?void 0:l.progressive){let t=this._dataByGroup?this._dataByGroup.keys.indexOf(i.context.groupKey):0,e=t>=0?this._product.getChildAt(t):null;e&&this._addProgressiveGraphic(e,i)}else this._product.appendChild(i),this._graphicMap.set(i.context.uniqueKey,i)}this._setStateOfGraphic(i,a),this._setGraphicFromMarkConfig(i)})}_updateEncoderByState(){let t={};Object.keys(this.stateStyle).forEach(e=>{if(e===td.STATE_NORMAL){let{groupStyles:i,updateStyles:r}=this._separateNormalStyle(this.stateStyle[e]);t.group=this._getEncoderOfStyle(e,i),t.update=this._getEncoderOfStyle(e,r)}else t[e]=this._getEncoderOfStyle(e,this.stateStyle[e])}),this._encoderOfState=t}_runState(t){t.forEach(t=>{var e;let i=[...(null!=(e=t.currentStates)?e:[]).filter(t=>!this.state.getStateInfo(t)),...this.state.checkState(t,t.context.data)];this._stateSort&&i.length&&i.sort(this._stateSort),t.context.states=i})}_getAttrsFromConfig(t={}){let{zIndex:e,clip:i,clipPath:r,overflow:n}=this._markConfig;if((0,nB.Z)(e)||(t.zIndex=e),(0,nB.Z)(i)||(t.clip=i),!(0,nB.Z)(r)){let e=(0,rD.Z)(r)?r:r(this._graphics);e&&e.length||(t.clip=!1),t.path=e}return(0,nB.Z)(n)||(t.overflow=n),t}_updateAttrsOfGroup(){var t;let e=this._getAttrsFromConfig();null==(t=this._product)||t.setAttributes(e),this._markConfig.support3d&&this._product&&this._product.setMode("3d")}_runBeforeTransform(t){var e;let i=null==(e=this._transform)?void 0:e.filter(t=>{if(t.type){let e=h9.getGrammarTransform(t.type);return e&&(!e.runType||"beforeJoin"===e.runType)}return!1});return this.runTransforms(i,t)}_runEncoderTransform(t,e){var i;let r=null==(i=this._transform)?void 0:i.filter(t=>{if(t.type){let i=h9.getGrammarTransform(t.type);return i&&"afterEncode"===i.runType&&!!i.canProgressive===e}return!1});return this.runTransforms(r,t)}renderInner(){var t,e,i;let r;this._updateEncoderByState();let n=null!=(e=null==(t=this._data)?void 0:t.getProduct())?e:[{}],l=this._runBeforeTransform(n);if(null==l?void 0:l.progressive){this.renderContext={beforeTransformProgressive:l.progressive};let t=l.progressive;if(t.canAnimate&&t.canAnimate()&&t.unfinished())return void this._updateAttrsOfGroup();r=t.output()}else r=(0,a1.IX)(l),this._runGroupData(r),this.renderContext=this._parseProgressiveContext(r);(null==(i=this.renderContext)?void 0:i.progressive)?(this._graphicMap.clear(),this._runProgressiveStep()):(this._runJoin(r),this._runState(this._graphics),this._runEncoder(this._graphics),this._runEncoderTransform(this._graphics,!1),this._runApplyGraphic(this._graphics)),this._updateAttrsOfGroup()}render(){this.isCommited()&&(!this.getVisible()||this._skipBeforeLayouted&&this.getCompiler().getLayoutState()===tn.before||(hF(`render mark: ${this.getProductId()}, type is ${this.type}`),this.renderInner()),this.uncommit())}updateMarkState(t){if(!this._product)return;let e=this.state.getStateInfo(t);this._graphics.forEach(i=>{"in"===this.state.checkOneState(i,i.context.data,e)?i.addState(t,!0,this.hasAnimationByState("state")):i.removeState(t,this.hasAnimationByState("state"))})}clearExitGraphics(){this._prevDataByKey=this._dataByKey;let t=(t,e)=>{this._graphicMap.delete(e),t.parent&&t.parent.removeChild(t),t.release&&t.release()};this._graphicMap.forEach((e,i)=>{if(e.context.diffState===th.exit&&!e.isExiting)if(e.context.animationState===th.exit&&this.hasAnimationByState("exit")){e.isExiting=!0;let r=this.getAnimationConfig();if(r.exit&&r.exit.length){let n=r.exit.map((t,i)=>({name:`exit_${i}`,animation:Object.assign(Object.assign({},t),{customParameters:e.context})}));e.applyAnimationState(["exit"],[1===n.length?n[0]:n],()=>{t(e,i)})}}else t(e,i)})}isProgressive(){return this.renderContext&&(!!this.renderContext.progressive||!!this.renderContext.beforeTransformProgressive)}canAnimateAfterProgressive(){var t,e;return this.renderContext&&this.renderContext.beforeTransformProgressive&&(null==(e=(t=this.renderContext.beforeTransformProgressive).canAnimate)?void 0:e.call(t))}isDoingProgressive(){return this.renderContext&&(this.renderContext.progressive&&this.renderContext.progressive.currentIndex<this.renderContext.progressive.totalStep||this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.unfinished())}clearProgressive(){this.renderContext&&this.renderContext.progressive&&(this._graphics=[],this._product.children.forEach(t=>{t.incrementalClearChild()}),this._product.removeAllChild()),this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.release(),this.renderContext=null}restartProgressive(){this.renderContext&&this.renderContext.progressive&&(this.renderContext.progressive.currentIndex=0)}_runBeforeProgressive(){var t;let e=this.renderContext.beforeTransformProgressive;e.progressiveRun();let i=e.output();if(null==(t=e.canAnimate)?void 0:t.call(e)){if(e.unfinished())return;this._runGroupData(i),this._runJoin(i),this._runState(this._graphics),this._runEncoder(this._graphics),this._runApplyGraphic(this._graphics)}}_runProgressiveJoin(){let t=this.renderContext.progressive.currentIndex,e=[],i={};return this._dataByGroup.keys.forEach(r=>{let n=this.renderContext.progressive.groupedData.get(r),l=this.renderContext.progressive.step,s=n.slice(t*l,(t+1)*l),a=[];s.forEach((i,n)=>{let s=this._keyGetter(i),o={context:Object.assign(Object.assign({},this._getCommonContext()),{diffState:th.enter,data:[i],uniqueKey:`${r}_${null!=s?s:t*l+n}`,key:s,groupKey:r})};a.push(o),e.push(o)}),i[r]=a}),{graphicsByGroup:i,graphics:e,needUpdate:!0}}_createIncrementalGraphics(){this._product.removeAllChild(),this._dataByGroup.keys.forEach(t=>{let e=sG({pickable:!1,zIndex:this._markConfig.zIndex});e.incremental=this.renderContext.progressive.step,this._product.appendChild(e)})}_setCommonAttributesToTheme(t){var e,i,r;if(this._attrsByGroup&&t){let n=t.parent;n&&(null==(e=this._attrsByGroup)?void 0:e[null==(i=t.context)?void 0:i.groupKey])&&n.setTheme({common:this._attrsByGroup[null==(r=t.context)?void 0:r.groupKey]})}}_runProgressiveEncoder(t){0===this.renderContext.progressive.currentIndex?this._runEncoder(t):this._runEncoder(t,!0)}_runProgressiveApplyGraphic(t){0===this.renderContext.progressive.currentIndex?(this._runApplyGraphic(t),this._setCommonAttributesToTheme(t[0])):this._runApplyGraphic(t)}_runProgressiveStep(){let{graphics:t,graphicsByGroup:e,needUpdate:i}=this._runProgressiveJoin();0===this.renderContext.progressive.currentIndex?(this._createIncrementalGraphics(),this._graphics=t):i&&t.forEach(t=>{this._graphics.push(t)}),this._runState(t),Object.keys(e).forEach(t=>{this._runProgressiveEncoder(e[t])}),this._runEncoderTransform(this._graphics,!0),Object.keys(e).forEach(t=>{this._runProgressiveApplyGraphic(e[t])}),this.renderContext.progressive.currentIndex+=1}renderProgressive(){var t;(null==(t=this.renderContext)?void 0:t.beforeTransformProgressive)?this._runBeforeProgressive():this.renderContext.progressive&&this._runProgressiveStep()}hasAnimationByState(t){if(!t||!this._animationConfig||!this._animationConfig[t]||this._disabledAnimationStates.includes(t))return!1;let e=this._animationConfig[t];return e.length>0||(0,nF.Z)(e)}hasAnimation(){return!!this._animationConfig&&Object.keys(this._animationConfig).length>0}runAnimation(){this._runStateAnimation(this.getGraphics())}}class gZ extends sj{constructor(t){super({x:0,y:0}),this.type="shadowroot",this.shadowHost=t}clearUpdateBoundTag(){super.clearUpdateBoundTag(),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}addUpdateBoundTag(){super.addUpdateBoundTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}addUpdateShapeAndBoundsTag(){super.addUpdateShapeAndBoundsTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){let e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}doUpdateGlobalMatrix(){if(this.shadowHost){let t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}tryUpdateGlobalAABBBounds(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}function gN(t){return new gZ(t)}function gj(){gj.__loaded||(gj.__loaded=!0,ak.RegisterGraphicCreator("shadowRoot",gN))}gj.__loaded=!1;let gG=gj;class gV extends gW{constructor(){super(...arguments),this.type=gV.type,this._marks=[],this._diffState=th.enter}getMarks(){return this._marks}isMarkExist(t){return void 0!==this._marks.find(e=>e.id===t.id)}addMark(t){return this.isMarkExist(t)?(hO("Mark already exists, add mark failed."),!1):(this._marks.push(t),!0)}removeMark(t){let e=this._marks.findIndex(e=>e.id===t.id||e.name===t.name);return -1===e?(hO("Mark does not exists, removeMark failed."),!1):(this._marks.splice(e,1),!0)}getMarkInType(t){return this._marks.filter(e=>e.type===t)}getMarkInId(t){return this._marks.find(e=>e.id===t)}getMarkInUserId(t){let e;return uR(this,t=>{e=t},e=>e.getUserId()===t,null,!0),e}getMarkInName(t){return this._marks.filter(e=>e.name===t)}_compileProduct(t){super._compileProduct(t),this.getMarks().forEach(t=>{t.compile({group:this._product})})}_getAttrsFromConfig(t={}){let e=super._getAttrsFromConfig(t);return(0,nB.Z)(this._markConfig.interactive)||(e.pickable=this._markConfig.interactive),t}getGraphics(){return[this._product]}renderInner(){var t;if(!this._product)return;let e=null!=(t=this._simpleStyle)?t:this.getAttributesOfState({});this._product.context=Object.assign(Object.assign(Object.assign({},this._product.context),this._getCommonContext()),{diffState:this._diffState}),this._setAnimationState(this._product);let i=this._getAttrsFromConfig(e);if(this._product.context.diffState===th.update){let t=this.hasAnimation(),e=dk(this._product,i);this._product.context.diffAttrs=e,this.hasAnimationByState(this._product.context.animationState)||(t?this._product.setAttributesAndPreventAnimate(e):this._product.setAttributes(e)),t&&this._product.setFinalAttributes(i)}else this._product.setAttributes(i);this.needClear=!0}clearExitGraphics(){this._diffState=th.update}render(){this._isCommited&&(hF(`render mark: ${this.getProductId()}, type is ${this.type}`),this.renderInner(),this.uncommit()),this.getMarks().forEach(t=>{t.render()})}release(){super.release(),this.removeProduct()}}gV.type="group";let gU=()=>{gG(),uD(),h9.registerMark(gV.type,gV)},gK=-.5*Math.PI,gX=1.5*Math.PI,gY="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol";(X=tp||(tp={})).selected="selected",X.selectedReverse="selected_reverse",X.hover="hover",X.hoverReverse="hover_reverse";let g$={[tp.selectedReverse]:{},[tp.selected]:{},[tp.hover]:{},[tp.hoverReverse]:{}},gq={container:"",width:30,height:30,style:{}},gJ="scrollDrag",gQ=(t,e,i,r)=>new r1.e(Object.assign({defaultFontParams:Object.assign({fontFamily:gY,fontSize:14},r),getTextBounds:i?void 0:uG,specialCharSet:"-/: .,@%'\"~"+r1.e.ALPHABET_CHAR_SET+r1.e.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t);function g0(t,e,i={}){if(!t)return{width:0,height:0};let r=uG({text:t,fontFamily:e.fontFamily||i.fontFamily||gY,fontSize:e.fontSize||i.fontSize||12,fontWeight:e.fontWeight||i.fontWeight,textAlign:e.textAlign||"center",textBaseline:e.textBaseline,ellipsis:!!e.ellipsis,maxLineWidth:e.maxLineWidth||1/0,lineHeight:e.fontSize||i.fontSize||12});return{width:r.width(),height:r.height()}}function g1(t,e="type"){var i,r;return(0,nF.Z)(t.text)&&"type"in t.text?null!=(i=t.text.type)?i:"text":e in t&&null!=(r=t[e])?r:"text"}function g2(t){var e,i;return(0,aw.Z)(t.maxLineWidth)&&(t.maxWidth=t.maxLineWidth,delete t.maxLineWidth),t.width=null!=(e=t.width)?e:0,t.height=null!=(i=t.height)?i:0,t.textConfig=t.text.text||t.text,t}function g3(t,e="type"){let i=g1(t,e);return"rich"===i?ak.richtext(g2(t)):("html"===i?t=function(t){let{text:e,_originText:i}=t,{text:r}=e;return t.html=r,t.text=i,t.renderable=!1,t}(t):"react"===i&&(t=function(t){let{text:e,_originText:i}=t,{text:r}=e;return t.react=r,t.text=i,t.renderable=!1,t}(t)),ak.text(t))}function g5(t,e,i,r,n){"right"===t?"center"===i?e.setAttribute("x",r-n/2):"right"===i||"end"===i?e.setAttribute("x",r):e.setAttribute("x",r-n):"center"===i?e.setAttribute("x",r+n/2):"right"===i||"end"===i?e.setAttribute("x",r+n):e.setAttribute("x",r)}let g4=(t,e,i)=>gQ(t,e,i,{fontFamily:hW.fontFamily,fontSize:hW.fontSize}),g6=(t,e,i,r)=>g4(e,i,r).measure(t);class g7{static instance(){return g7.instance_||(g7.instance_=new g7),g7.instance_}constructor(){this.functions={}}registerFunction(t,e){t&&e&&(this.functions[t]=e)}unregisterFunction(t){t&&delete this.functions[t]}getFunction(t){return this.functions[t]||null}getFunctionNameList(){return Object.keys(this.functions)}}class g8{get displayWidth(){return this._pixelWidth/this._dpr}get displayHeight(){return this._pixelHeight/this._dpr}get id(){return this._id}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get nativeCanvas(){return this._nativeCanvas}set nativeCanvas(t){this._nativeCanvas=t}get width(){return this._pixelWidth}set width(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}get height(){return this._pixelHeight}set height(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}getContext(t){return this._context}get visiable(){return this._visiable}set visiable(t){this._visiable=t,t?this.show():this.hide()}get dpr(){return this._dpr}set dpr(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}constructor(t){var e;let{nativeCanvas:i,width:r=500,height:n=500,dpr:l=1,x:s,y:a,id:o,canvasControled:h=!0}=t;this._x=null!=s?s:0,this._y=null!=a?a:0,this._pixelWidth=r*l,this._pixelHeight=n*l,this._visiable=!1!==t.visiable,this.controled=h,this._displayWidth=r,this._displayHeight=n,this._dpr=l,this._nativeCanvas=i,this._id=null!=(e=i.id)?e:o,o&&(i.id=o),this.init(t)}getNativeCanvas(){return this._nativeCanvas}hide(){}show(){}applyPosition(){}resetStyle(t){}resize(t,e){}toDataURL(t,e){return""}readPixels(t,e,i,r){return this._context.getImageData(t,e,i,r)}convertToBlob(t){throw Error("暂未实现")}transferToImageBitmap(){throw Error("暂未实现")}release(...t){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}g8.env="browser";var g9=i(31982);class ft{static GetCanvas(){try{return ft.canvas||(ft.canvas=iC.global.createCanvas({})),ft.canvas}catch(t){return null}}static GetCtx(){if(!ft.ctx){let t=ft.GetCanvas();ft.ctx=t.getContext("2d")}return ft.ctx}}class fe extends g9.L{static getInstance(){return fe._instance||(fe._instance=new fe),fe._instance}constructor(t=[],e=100){super(),this.cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},this.dataMap=new Map;let i=ft.GetCanvas(),r=ft.GetCtx();if(i.width=e,i.height=1,!r)return;if(r.translate(0,0),!r)throw Error("获取ctx发生错误");let n=r.createLinearGradient(0,0,e,0);t.forEach(t=>{n.addColorStop(t[0],t[1])}),r.fillStyle=n,r.fillRect(0,0,e,1),this.rgbaSet=r.getImageData(0,0,e,1).data}getColor(t){let e=this.rgbaSet.slice(4*t,4*t+4);return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]/255})`}GetOrCreate(t,e,i,r,n=[],l=100){let s=`${t}${e}${i}${r}`;n.forEach(t=>s+=t.join()),s+=l;let a=this.dataMap.get(s);return a||(a={data:new fe(n,l),timestamp:[]},this.addLimitedTimestamp(a,Date.now(),{}),this.dataMap.set(s,a)),this.clearCache(this.dataMap,this.cacheParams),a.data}}class fi{static GetSize(t){for(let e=0;e<fi.ImageSize.length;e++)if(fi.ImageSize[e]>=t)return fi.ImageSize[e];return t}static Get(t,e,i,r,n,l,s){let a=fi.GenKey(t,e,i,r,n),o=fi.cache[a];if(!o||0===o.length)return null;for(let t=0;t<o.length;t++)if(o[t].width>=l&&o[t].height>=s)return o[t].pattern;return null}static Set(t,e,i,r,n,l,s,a){let o=fi.GenKey(t,e,i,r,n);fi.cache[o]?fi.cache[o].push({width:s,height:a,pattern:l}):fi.cache[o]=[{width:s,height:a,pattern:l}]}static GenKey(t,e,i,r,n){return`${e},${i},${r},${n},${t.join()}`}}fi.cache={},fi.ImageSize=[20,40,80,160,320,640,1280,2560];let fr=[0,0,0],fn=(t,e,i,r,n,l,s,a)=>{if(a)for(;i>e;)i-=ik.f7;else for(;i<e;)i+=ik.f7;let o=ik.pi/3*(i>e?1:-1),h=e,d=h;for(;d!==i;){let e=4*Math.tan(Math.abs((d=o>0?Math.min(d+o,i):Math.max(d+o,i))-h)/4)/3,a=d<h?-1:1,u=Math.cos(h),c=Math.sin(h),p=Math.cos(d),g=Math.sin(d),f=u*l+r,m=c*s+n,y=p*l+r,v=g*s+n,b=l*e*a,_=s*e*a;t.push([f-b*c,m+_*u,y+b*g,v-_*p,y,v]),h=d}},fl=class{set fillStyle(t){this.nativeContext.fillStyle=t}get fillStyle(){return this.nativeContext.fillStyle}set font(t){t!==this._font&&(this._font=t,this.nativeContext.font=t)}get font(){var t;return null!=(t=this._font)?t:this.nativeContext.font}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha}get globalAlpha(){return this.nativeContext.globalAlpha}set lineCap(t){this.nativeContext.lineCap=t}get lineCap(){return this.nativeContext.lineCap}set lineDashOffset(t){this.nativeContext.lineDashOffset=t}get lineDashOffset(){return this.nativeContext.lineDashOffset}set lineJoin(t){this.nativeContext.lineJoin=t}get lineJoin(){return this.nativeContext.lineJoin}set lineWidth(t){this.nativeContext.lineWidth=t}get lineWidth(){return this.nativeContext.lineWidth}set miterLimit(t){this.nativeContext.miterLimit=t}get miterLimit(){return this.nativeContext.miterLimit}set shadowBlur(t){this.nativeContext.shadowBlur=t}get shadowBlur(){return this.nativeContext.shadowBlur}set shadowColor(t){this.nativeContext.shadowColor=t}get shadowColor(){return this.nativeContext.shadowColor}set shadowOffsetX(t){this.nativeContext.shadowOffsetX=t}get shadowOffsetX(){return this.nativeContext.shadowOffsetX}set shadowOffsetY(t){this.nativeContext.shadowOffsetY=t}get shadowOffsetY(){return this.nativeContext.shadowOffsetY}set strokeStyle(t){this.nativeContext.strokeStyle=t}get strokeStyle(){return this.nativeContext.strokeStyle}set textAlign(t){this.nativeContext.textAlign=t}get textAlign(){return this.nativeContext.textAlign}set textBaseline(t){this.nativeContext.textBaseline=t}get textBaseline(){return this.nativeContext.textBaseline}get inuse(){return!!this._inuse}set inuse(t){!!this._inuse!==t&&(this._inuse=t,t?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}constructor(t,e){this.fillAttributes=Object.assign(Object.assign({},rm),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},rv),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},rb),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;let i=t.nativeCanvas.getContext("2d");if(!i)throw Error("发生错误，获取2d上下文失败");this.nativeContext=i,this.canvas=t,this.matrix=new iT.y(1,0,0,1,0,0),this.stack=[],this.dpr=e,this.applyedMatrix=new iT.y(1,0,0,1,0,0),this._clearMatrix=new iT.y(1,0,0,1,0,0),this.baseGlobalAlpha=1}reset(t=!0){this.stack.length&&iR.Y.getInstance().warn("可能存在bug，matrix没有清空"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new iT.y(1,0,0,1,0,0),this.stack.length=0,t&&this.nativeContext.setTransform(1,0,0,1,0,0)}getCanvas(){return this.canvas}getContext(){return this.nativeContext}setTransformForCurrent(t=!1){!t&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}get currentMatrix(){return this.matrix}cloneMatrix(t){return sR.allocateByObj(t)}clear(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}restore(){this.nativeContext.restore(),this.stack.length>0&&(sR.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0)),this.font="",this._clearFilterStyle=!1,this._clearShadowStyle=!1}highPerformanceRestore(){this.stack.length>0&&(sR.free(this.matrix),this.matrix=this.stack.pop())}rotate(t,e=!0){this.matrix.rotate(t),e&&this.setTransformForCurrent()}save(){let t=this.cloneMatrix(this.matrix);this.stack.push(t),this.nativeContext.save()}highPerformanceSave(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}scale(t,e,i=!0){this.matrix.scale(t,e),i&&this.setTransformForCurrent()}setScale(t,e,i=!0){this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}scalePoint(t,e,i,r,n=!0){this.translate(i,r,!1),this.scale(t,e,!1),this.translate(-i,-r,!1),n&&this.setTransformForCurrent()}setTransform(t,e,i,r,n,l,s=!0,a=this.dpr){this.matrix.setValue(a*t,a*e,a*i,a*r,a*n,a*l),s&&this.setTransformForCurrent()}setTransformFromMatrix(t,e=!0,i=this.dpr){this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}resetTransform(t=!0,e=this.dpr){this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}transform(t,e,i,r,n,l,s=!0){this.matrix.multiply(t,e,i,r,n,l),s&&this.setTransformForCurrent()}transformFromMatrix(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}translate(t,e,i=!0){this.matrix.translate(t,e),i&&this.setTransformForCurrent()}rotateDegrees(t,e=!0){let i=t*Math.PI/180;this.rotate(i,e)}rotateAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}rotateDegreesAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}beginPath(){this.disableBeginPath||this.nativeContext.beginPath()}clip(t,e){t?"string"==typeof t?this.nativeContext.clip(t):this.nativeContext.clip(t,e):this.nativeContext.clip()}arc(t,e,i,r,n,l,s){if(s=s||0,this.camera){let a=[];fn(a,r,n,t,e,i,i,l);for(let t=0;t<a.length;++t){let e=a[t];this.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5],s)}}else this.nativeContext.arc(t,e,Math.max(0,i),r,n,l)}arcTo(t,e,i,r,n){this.nativeContext.arcTo(t,e,i,r,n)}bezierCurveTo(t,e,i,r,n,l,s){if(s=s||0,this.camera){let a=s,o=s;this.modelMatrix&&(sM(fr,[t,e,s],this.modelMatrix),t=fr[0],e=fr[1],a=fr[2],sM(fr,[i,r,s],this.modelMatrix),i=fr[0],r=fr[1],o=fr[2],sM(fr,[n,l,s],this.modelMatrix),n=fr[0],l=fr[1],s=fr[2]);let h=this.camera.vp(n,l,s);n=h.x,l=h.y,t=(h=this.camera.vp(t,e,a)).x,e=h.y,i=(h=this.camera.vp(i,r,o)).x,r=h.y}this.nativeContext.bezierCurveTo(t,e,i,r,n,l)}closePath(){this.nativeContext.closePath()}ellipse(t,e,i,r,n,l,s,a){null==a?this.nativeContext.ellipse(t,e,i,r,n,l,s):this.nativeContext.ellipse(t,e,i,r,n,l,s,a)}lineTo(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(sM(fr,[t,e,i],this.modelMatrix),t=fr[0],e=fr[1],i=fr[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.lineTo(t,e)}moveTo(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(sM(fr,[t,e,i],this.modelMatrix),t=fr[0],e=fr[1],i=fr[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.moveTo(t,e)}quadraticCurveTo(t,e,i,r,n){if(n=n||0,this.camera){let l=n;this.modelMatrix&&(sM(fr,[t,e,n],this.modelMatrix),t=fr[0],e=fr[1],l=fr[2],sM(fr,[i,r,n],this.modelMatrix),i=fr[0],r=fr[1],n=fr[2]);let s=this.camera.vp(i,r,n);i=s.x,r=s.y,t=(s=this.camera.vp(t,e,l)).x,e=s.y}this.nativeContext.quadraticCurveTo(t,e,i,r)}rect(t,e,i,r,n){n=n||0,this.camera?(this.moveTo(t,e,n),this.lineTo(t+i,e,n),this.lineTo(t+i,e+r,n),this.lineTo(t,e+r,n),this.closePath()):this.nativeContext.rect(t,e,i,r)}createImageData(){let t=arguments;return 2===t.length?this.nativeContext.createImageData(t[0],t[1]):1===t.length?this.nativeContext.createImageData(t[0]):null}createLinearGradient(t,e,i,r){return isFinite(t+e+i+r)||(t=0,e=0,i=0,r=0),this.nativeContext.createLinearGradient(t,e,i,r)}createPattern(t,e){return 0===t.width||0===t.height?null:this.nativeContext.createPattern(t,e)}createRadialGradient(t,e,i,r,n,l){return this.nativeContext.createRadialGradient(t,e,i,r,n,l)}createConicGradient(t,e,i,r){if(this.nativeContext.createConicGradient&&.001>Math.abs(r-i-2*Math.PI))return this.nativeContext.createConicGradient(i,t,e);let n,l=!1,s=this;return{stops:[],addColorStop(t,e){this.stops.push([t,e]),l=!0},GetPattern(a,o,h){return l&&(h||(h=r-i),n=function(t,e,i,r,n,l,s,a,o){let h=Math.floor(180*n/Math.PI),d=ft.GetCanvas(),u=ft.GetCtx();if(!u)return null;let c=fi.GetSize(a),p=fi.GetSize(o),g=fi.Get(e,i,r,l,s,c,p);if(g)return g;let f=Math.sqrt(Math.max(Math.max(Math.pow(i,2)+Math.pow(r,2),Math.pow(c-i,2)+Math.pow(r,2)),Math.max(Math.pow(c-i,2)+Math.pow(p-r,2),Math.pow(i,2)+Math.pow(p-r,2)))),m=h+1,y=n/Math.max(1,m-1),v=fe.getInstance().GetOrCreate(i,r,c,p,e,m),b=2*Math.PI*f/360;d.width=c,d.height=p,u.setTransform(1,0,0,1,0,0),u.clearRect(0,0,c,p),u.translate(i,r),u.rotate(l);for(let t=0,e=m-1;t<e&&!(l+t*y>s);t++){let e=v.getColor(t);u.beginPath(),u.rotate(y),u.moveTo(0,0),u.lineTo(f,-2*b),u.lineTo(f,0),u.fillStyle=e,u.closePath(),u.fill()}let _=u.getImageData(0,0,c,p);return d.width=_.width,d.height=_.height,u.putImageData(_,0,0),(g=t.createPattern(d,"no-repeat"))&&fi.Set(e,i,r,l,s,g,c,p),g}(s,this.stops,t,e,h,i,r,a,o),l=!1),n}}}fill(t,e){this.disableFill||(t?this.nativeContext.fill(t):this.nativeContext.fill())}fillRect(t,e,i,r){this.nativeContext.fillRect(t,e,i,r)}clearRect(t,e,i,r){this.nativeContext.clearRect(t,e,i,r)}project(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(sM(fr,[t,e,i],this.modelMatrix),t=fr[0],e=fr[1],i=fr[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}return{x:t,y:e}}view(t,e,i){return i=i||0,this.camera?(this.modelMatrix&&(sM(fr,[t,e,i],this.modelMatrix),t=fr[0],e=fr[1],i=fr[2]),this.camera.view(t,e,i)):[t,e,i]}fillText(t,e,i,r){if(r=r||0,this.camera){this.modelMatrix&&(sM(fr,[e,i,r],this.modelMatrix),e=fr[0],i=fr[1],r=fr[2]);let t=this.camera.vp(e,i,r);e=t.x,i=t.y}this.nativeContext.fillText(t,e,i)}getImageData(t,e,i,r){return this.nativeContext.getImageData(t,e,i,r)}getLineDash(){return this.nativeContext.getLineDash()}isPointInPath(t,e){return this.nativeContext.isPointInPath(t,e)}isPointInStroke(t,e){return this.nativeContext.isPointInStroke(t,e)}measureText(t,e=iC.global.measureTextMethod){var i,r;if(!e||"native"===e)return this.nativeContext.measureText(t);this.mathTextMeasure||(this.mathTextMeasure=iC.graphicUtil.createTextMeasureInstance({},{},()=>this.canvas.nativeCanvas));let n=null!=(i=this.fontFamily)?i:rb.fontFamily,l=null!=(r=this.fontSize)?r:rb.fontSize;return this.mathTextMeasure.textSpec.fontFamily===n&&this.mathTextMeasure.textSpec.fontSize===l||(this.mathTextMeasure.textSpec.fontFamily=n,this.mathTextMeasure.textSpec.fontSize=l,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(t,e)}putImageData(t,e,i){this.nativeContext.putImageData(t,e,i)}setLineDash(t){let e=arguments,i=this.nativeContext;this.nativeContext.setLineDash?e[0]&&i.setLineDash(e[0]):"mozDash"in i?i.mozDash=e[0]:"webkitLineDash"in i&&(i.webkitLineDash=e[0])}stroke(t){this.disableStroke||(t?this.nativeContext.stroke(t):this.nativeContext.stroke())}strokeRect(t,e,i,r){this.nativeContext.strokeRect(t,e,i,r)}strokeText(t,e,i,r){if(r=r||0,this.camera){this.modelMatrix&&(sM(fr,[e,i,r],this.modelMatrix),e=fr[0],i=fr[1],r=fr[2]);let t=this.camera.vp(e,i,r);e=t.x,i=t.y}this.nativeContext.strokeText(t,e,i)}drawImage(){let t=this.nativeContext,e=arguments;3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}setCommonStyle(t,e,i,r,n){if(Array.isArray(n)){if(n.length<=1)return this._setCommonStyle(t,e,i,r,n[0]);let l=Object.create(n[0]);return n.forEach((t,e)=>{0!==e&&Object.assign(l,t)}),this._setCommonStyle(t,e,i,r,l)}return this._setCommonStyle(t,e,i,r,n)}_setCommonStyle(t,e,i,r,n){let l=this.nativeContext;n||(n=this.fillAttributes);let{fillOpacity:s=n.fillOpacity,opacity:a=n.opacity,fill:o=n.fill}=e;l.globalAlpha=s*a*this.baseGlobalAlpha,s>1e-12&&a>1e-12&&(l.fillStyle=rN(this,o,t,i,r))}setShadowBlendStyle(t,e,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(t,i[0]);let r=Object.create(i[0]);return i.forEach((t,e)=>{0!==e&&Object.assign(r,t)}),this._setShadowBlendStyle(t,e,r)}return this._setShadowBlendStyle(t,e,i)}_setShadowBlendStyle(t,e,i){let r=this.nativeContext;i||(i=this.fillAttributes);let{opacity:n=i.opacity,shadowBlur:l=i.shadowBlur,shadowOffsetX:s=i.shadowOffsetX,shadowOffsetY:a=i.shadowOffsetY,blur:o=i.blur,globalCompositeOperation:h=i.globalCompositeOperation}=e;if(!(n<=1e-12)){if(s||a||l){let{shadowColor:t=i.shadowColor,shadowOffsetX:n=i.shadowOffsetX,shadowOffsetY:s=i.shadowOffsetY}=e;r.shadowBlur=l*this.dpr,r.shadowColor=t,r.shadowOffsetX=n*this.dpr,r.shadowOffsetY=s*this.dpr,this._clearShadowStyle=!0}else this._clearShadowStyle&&(r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0);o?(r.filter=`blur(${o}px)`,this._clearFilterStyle=!0):this._clearFilterStyle&&(r.filter="blur(0px)",this._clearFilterStyle=!1),h?(r.globalCompositeOperation=h,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(r.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1)}}setStrokeStyle(t,e,i,r,n){if(Array.isArray(n)){if(n.length<=1)return this._setStrokeStyle(t,e,i,r,n[0]);let l=Object.create(n[0]);return n.forEach((t,e)=>{0!==e&&Object.assign(l,t)}),this._setStrokeStyle(t,e,i,r,l)}return this._setStrokeStyle(t,e,i,r,n)}_setStrokeStyle(t,e,i,r,n){let l=this.nativeContext;n||(n=this.strokeAttributes);let{strokeOpacity:s=n.strokeOpacity,opacity:a=n.opacity}=e;if(l.globalAlpha=s*a*this.baseGlobalAlpha,s>1e-12&&a>1e-12){let{lineWidth:s=n.lineWidth,stroke:a=n.stroke,lineJoin:o=n.lineJoin,lineDash:h=n.lineDash,lineDashOffset:d=n.lineDashOffset,lineCap:u=n.lineCap,miterLimit:c=n.miterLimit,keepStrokeScale:p=n.keepStrokeScale}=e;l.lineWidth=p?s:rZ(this,s,this.dpr),l.strokeStyle=rN(this,a,t,i,r),l.lineJoin=o,h&&(l.setLineDash(h),l.lineDashOffset=d),l.lineCap=u,l.miterLimit=c}}setTextStyleWithoutAlignBaseline(t,e,i){let r=this.nativeContext;e||(e=this.textAttributes);let{scaleIn3d:n=e.scaleIn3d}=t;t.font?this.font=t.font:this.font=(0,uz.U)(t,e,n&&this.camera&&this.camera.getProjectionScale(i));let{fontFamily:l=e.fontFamily,fontSize:s=e.fontSize}=t;this.fontFamily=l,this.fontSize=s,r.textAlign="left",r.textBaseline="alphabetic"}setTextStyle(t,e,i){var r,n;let l=this.nativeContext;e||(e=this.textAttributes),t.font?this.font=t.font:this.font=(0,uz.U)(t,e,this.camera&&this.camera.getProjectionScale(i));let{fontFamily:s=e.fontFamily,fontSize:a=e.fontSize}=t;this.fontFamily=s,this.fontSize=a,l.textAlign=null!=(r=t.textAlign)?r:e.textAlign,l.textBaseline=null!=(n=t.textBaseline)?n:e.textBaseline}draw(){}clearMatrix(t=!0,e=this.dpr){this.setTransformFromMatrix(this._clearMatrix,t,e)}setClearMatrix(t,e,i,r,n,l){this._clearMatrix.setValue(t,e,i,r,n,l)}onlyTranslate(t=this.dpr){return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}release(...t){this.stack.forEach(t=>sR.free(t)),this.stack.length=0}};fl.env="browser",fl=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],fl);let fs=class extends g8{constructor(t){super(t)}init(t){let{container:e}=t;if("string"==typeof e){let t=iC.global.getElementById(e);t&&(this._container=t)}else this._container=e;this._context=new fl(this,this._dpr),this.initStyle()}initStyle(){if(!this.controled)return;let{nativeCanvas:t}=this;t.width=this._pixelWidth,t.height=this._pixelHeight,t.style&&this.setCanvasStyle(t,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(t),this.visiable||this.hide()}hide(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}show(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}applyPosition(){let t=this._nativeCanvas;t.style.position="absolute",t.style.top=`${this._y}px`,t.style.left=`${this._x}px`}resetStyle(t){if(!this.controled)return;let{width:e=this._displayWidth,height:i=this._displayHeight,dpr:r=this._dpr,x:n=this._x,y:l=this._y}=t,{nativeCanvas:s}=this;s.width=e*r,s.height=i*r,s.style&&this.setCanvasStyle(s,n,l,e,i),t.id&&(s.id=t.id),this.visiable||this.hide()}setCanvasStyle(t,e,i,r,n){this.controled&&(t.style.width=`${r}px`,t.style.height=`${n}px`)}toDataURL(t,e){return"image/jpeg"===t?this._nativeCanvas.toDataURL(t,e):"image/png"===t?this._nativeCanvas.toDataURL(t):this._nativeCanvas.toDataURL(t,e)}resize(t,e){this.controled&&(this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.style&&(this._nativeCanvas.style.width=`${t}px`,this._nativeCanvas.style.height=`${e}px`),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}};function fa(t,e){return new eQ(i=>{i(r3).toDynamicValue(()=>e=>new t(e)).whenTargetNamed(t.env),i(r5).toDynamicValue(()=>(t,i)=>new e(t,i)).whenTargetNamed(e.env)})}fs.env="browser";let fo=fa(fs=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],fs),fl);var fh=function(t,e){return function(i,r){e(i,r,t)}};let fd=class{constructor(t,e){this.pickItemInterceptorContributions=t,this.pickServiceInterceptorContributions=e,this.type="default",this.global=iC.global}reInit(){this._init()}_init(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order),this.pickerServiceInterceptorContributions=this.pickServiceInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order)}pick(t,e,i){let r,n={graphic:null,group:null};i.pickerService=this;let l=i.bounds.width(),s=i.bounds.height();if(!(new iI.FB).setValue(0,0,l,s).containsPoint(e))return n;this.pickContext&&(this.pickContext.inuse=!0),i.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);let a=new iT.y(1,0,0,1,0,0);for(let l=t.length-1;l>=0&&!(n=t[l].isContainer?this.pickGroup(t[l],e,a,i):this.pickItem(t[l],e,a,i)).graphic;l--)r||(r=n.group);if(n.graphic||(n.group=r),this.pickContext&&(this.pickContext.inuse=!1),this.pickerServiceInterceptorContributions.length)for(let t=0;t<this.pickerServiceInterceptorContributions.length;t++){let r=this.pickerServiceInterceptorContributions[t];r.afterPickItem&&(n=r.afterPickItem(n,this,e,i,{parentMatrix:a}))}return n}containsPoint(t,e,i){var r;return!!(null==(r=this.pickItem(t,e,null,null!=i?i:{pickContext:this.pickContext,pickerService:this}))?void 0:r.graphic)}pickGroup(t,e,i,r){let n={group:null,graphic:null};if(!1===t.attribute.visibleAll)return n;let l=r.pickContext,s=l.modelMatrix;if(l.camera){let e=t.transMatrix,i=sP.allocate();(sS(i,e),s)?i&&(l.modelMatrix=sA(sP.allocate(),s,i),sP.free(i)):(sS(i,t.globalTransMatrix),l.modelMatrix=i)}if(this.InterceptorContributions.length)for(let n=0;n<this.InterceptorContributions.length;n++){let a=this.InterceptorContributions[n];if(a.beforePickItem){let n=a.beforePickItem(t,this,e,r,{parentMatrix:i});if(n)return l.modelMatrix!==s&&sP.free(l.modelMatrix),l.modelMatrix=s,n}}let a=t.transMatrix,o=sR.allocateByObj(i),h=new iN.E9(e.x,e.y);o.transformPoint(h,h);let d=t.AABBBounds.containsPoint(h);if(!d&&!t.stage.camera)return n;let u=this.pickItem(t,h.clone(),i,r);u&&u.graphic&&(n.graphic=u.graphic,n.params=u.params);let c=!1!==t.attribute.pickable&&d;return o.multiply(a.a,a.b,a.c,a.d,a.e,a.f),!1===t.attribute.childrenPickable||u&&u.graphic||aZ(t,rx.zIndex,l=>{if(l.isContainer){let i=new iN.E9(e.x,e.y),s=nP(t).group,{scrollX:a=s.scrollX,scrollY:h=s.scrollY}=t.attribute;i.x-=a,i.y-=h,n=this.pickGroup(l,i,o,r)}else{let s=new iN.E9(e.x,e.y);o.transformPoint(s,s);let a=nP(t).group,{scrollX:h=a.scrollX,scrollY:d=a.scrollY}=t.attribute;s.x-=h,s.y-=d;let u=this.pickItem(l,s,i,r);u&&u.graphic&&(n.graphic=u.graphic,n.params=u.params)}return!!n.graphic||!!n.group},!0,!!l.camera),l.modelMatrix!==s&&sP.free(l.modelMatrix),l.modelMatrix=s,n.graphic||n.group||!c||t.stage.camera||(n.group=t),sR.free(o),n}selectPicker(t){return this.pickerMap.get(t.numberType)||null}};fd=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),fh(0,it(ii)),fh(0,ie(ap)),fh(1,it(ii)),fh(1,ie(ag)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object])],fd);var fu=function(t,e){return function(i,r){e(i,r,t)}};let fc=class extends fd{constructor(t,e,i,r){super(i,r),this.contributions=t,this.drawContribution=e,this.pickItemInterceptorContributions=i,this.pickServiceInterceptorContributions=r,this.global.hooks.onSetEnv.tap("canvas-picker-service",(t,e,i)=>{this.configure(i,e)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(t=>{this.pickerMap.set(t.numberType,t)}),super._init()}configure(t,e){this.pickCanvas=np.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}pickItem(t,e,i,r){if(!1===t.attribute.pickable)return null;if(this.InterceptorContributions.length)for(let n=0;n<this.InterceptorContributions.length;n++){let l=this.InterceptorContributions[n];if(l.beforePickItem){let n=l.beforePickItem(t,this,e,r,{parentMatrix:i});if(n)return n}}let n=this.pickerMap.get(t.numberType);if(!n)return null;let l=n.contains(t,e,r),s=l?t:null,a={graphic:s,params:l};if(s)return a;if(this.InterceptorContributions.length)for(let n=0;n<this.InterceptorContributions.length;n++){let l=this.InterceptorContributions[n];if(l.afterPickItem){let n=l.afterPickItem(t,this,e,r,{parentMatrix:i});if(n)return n}}return a}};fc=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),fu(0,it(ii)),fu(0,ie(cf)),fu(1,it(ao)),fu(2,it(ii)),fu(2,ie(ap)),fu(3,it(ii)),fu(3,ie(ag)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object,Object,Object])],fc);let fp=class{constructor(){this.type="group",this.numberType=ss}contains(t,e,i){return!1}};fp=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],fp);let fg=new eQ((t,e,i,r)=>{fg.__vloaded||(fg.__vloaded=!0,t(cg).to(fp).inSingletonScope(),t(cf).toService(cg),il(t,cf))});fg.__vloaded=!1;let ff=new eQ((t,e,i,r)=>{i(fc)||t(fc).toSelf().inSingletonScope(),i(au)?r(au).toService(fc):t(au).toService(fc)});function fm(t){t.load(fg),t.load(ff)}let fy=class{constructor(){this._uid=eJ.GenAutoIncrementId(),this.viewBox=new iI.FB,this.modelMatrix=new iT.y(1,0,0,1,0,0)}onChange(t){this._onChangeCb=t}configure(t,e){e.env===this.type&&t.setWindowHandler(this)}release(...t){this.releaseWindow()}isVisible(t){return!0}onVisibleChange(t){}getTopLeft(t){return{top:0,left:0}}setViewBox(t){this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2)}getViewBox(){return this.viewBox}setViewBoxTransform(t,e,i,r,n,l){this.modelMatrix.setValue(t,e,i,r,n,l)}getViewBoxTransform(){return this.modelMatrix}};fy=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],fy);let fv=tg=class extends fy{get container(){return this.canvas.nativeCanvas.parentElement}static GenerateCanvasId(){return`${tg.idprefix}_${tg.prefix_count++}`}constructor(){super(),this.type="browser",this._canvasIsIntersecting=!0,this.global=iC.global,this.viewBox=new iI.FB,this.modelMatrix=new iT.y(1,0,0,1,0,0)}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return this.canvas.nativeCanvas.getBoundingClientRect()}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t),this.postInit()}postInit(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch(t){console.error("发生错误，该环境不存在IntersectionObserver")}}isElementVisible(t){let e=t.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight;return!(e.right<0||e.bottom<0||e.left>i||e.top>r)}observerCanvas(){this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);let t=new IntersectionObserver((t,e)=>{t.forEach(t=>{this._canvasIsIntersecting!==t.isIntersecting?(this._canvasIsIntersecting=t.isIntersecting,this._onVisibleChangeCb&&this._onVisibleChangeCb(t.isIntersecting)):this._canvasIsIntersecting=t.isIntersecting})});t&&t.observe(this.canvas.nativeCanvas)}createWindowByConfig(t){let e,i=this.global.createCanvas({width:t.width,height:t.height});if(!(e="string"==typeof t.container?this.global.getElementById(t.container):t.container?t.container:this.global.getRootElement()))throw Error("发生错误，containerId可能传入有误");t.offscreen?e=null:e.appendChild(i);let r={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:i,container:e,id:tg.GenerateCanvasId(),canvasControled:!0};this.canvas=new fs(r)}createWindowByCanvas(t){var e;let i;if("string"==typeof t.canvas){if(!(i=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else i=t.canvas;if(!i)throw Error("发生错误，传入的canvas不正确");let r=t.width,n=t.height;if(null==r||null==n||!t.canvasControled){let t=i.getBoundingClientRect();r=t.width,n=t.height}let l=t.dpr;null==l&&(l=null!=(e=i.getContext("2d").pixelRatio)?e:i.width/r),this.canvas=new fs({width:r,height:n,dpr:l,nativeCanvas:i,canvasControled:t.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e,i){return this.canvas.nativeCanvas.addEventListener(t,e,i)}removeEventListener(t,e,i){return this.canvas.nativeCanvas.removeEventListener(t,e,i)}dispatchEvent(t){return this.canvas.nativeCanvas.dispatchEvent(t)}getStyle(){var t;return null!=(t=this.canvas.nativeCanvas.style)?t:{}}setStyle(t){this.canvas.nativeCanvas.style=t}getBoundingClientRect(){let t=this.canvas.nativeCanvas,e=this.getWH();return t.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:e.width,height:e.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}isVisible(t){return this._canvasIsIntersecting}onVisibleChange(t){this._onVisibleChangeCb=t}getTopLeft(t){return this.global.getElementTopLeft(this.canvas.nativeCanvas,t)}};fv.env="browser",fv.idprefix="visactor_window",fv.prefix_count=0,fv=tg=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],fv);let fb=new eQ(t=>{t(fv).toSelf(),t(nm).toDynamicValue(t=>t.container.get(fv)).whenTargetNamed(fv.env)}),f_=class{configure(t,...e){t.env===this.type&&t.setActiveEnvContribution(this)}getNativeAABBBounds(t){return new iI.FB}removeDom(t){return!1}createDom(t){return null}updateDom(t,e){return!1}getDynamicCanvasCount(){return 999}getStaticCanvasCount(){return 999}getElementById(t){return document.getElementById(t)}getRootElement(){return document.body}loadJson(t){let e=fetch(t).then(t=>t.json());return e.then(t=>({data:t,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(t){return fetch(t).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadBlob(t){return fetch(t).then(t=>t.blob()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}getElementTop(t,e){return 0}getElementLeft(t,e){return 0}getElementTopLeft(t,e){return{top:0,left:0}}loadFont(t,e,i){var r,n,l,s;return r=this,n=void 0,s=function*(){return{loadState:"fail"}},new(l=void 0,l=Promise)(function(t,e){function i(t){try{o(s.next(t))}catch(t){e(t)}}function a(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof l?r:new l(function(t){t(r)})).then(i,a)}o((s=s.apply(r,n||[])).next())})}isMacOS(){return!1}copyToClipBoard(t){return Promise.resolve(null)}};f_=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],f_);class fC{get x1(){return this.dom.getBoundingClientRect().left}get x2(){return this.dom.getBoundingClientRect().right}get y1(){return this.dom.getBoundingClientRect().top}get y2(){return this.dom.getBoundingClientRect().bottom}get width(){return this.dom.getBoundingClientRect().width}get height(){return this.dom.getBoundingClientRect().height}constructor(t){this.dom=t}}function fx(t,e=!1){let i=document.createElement("img");if(iC.global.isImageAnonymous&&(i.crossOrigin="anonymous"),e){let e=new Blob([t],{type:"image/svg+xml"});t=window.URL.createObjectURL(e)}return(i.src=t,i.complete)?Promise.resolve(i):new Promise((t,e)=>{i.onload=()=>{t(i)},i.onerror=()=>{e(Error("加载失败"))}})}let fw=class extends f_{constructor(){super(),this.type="browser",this.supportEvent=!0;try{this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsTouchEvents=!1,this.supportsPointerEvents=!1,this.supportsPointerEvents=!1}this.applyStyles=!0}mapToCanvasPoint(t,e){var i,r;let n=0,l=0,s=0,a=0;if(t.changedTouches){let e=null!=(i=t.changedTouches[0])?i:{};n=e.clientX||0,l=e.clientY||0,s=n,a=l}else n=t.clientX||0,l=t.clientY||0,s=t.offsetX||0,a=t.offsetY||0;if(e){let t,i,s=n,a=l,o=e.getBoundingClientRect(),h=null==(r=e.getNativeHandler)?void 0:r.call(e).nativeCanvas;return h&&(t=o.width/h.offsetWidth,i=o.height/h.offsetHeight),{x:(s-o.left)/((0,hy.Z)(t)?t:1),y:(a-o.top)/((0,hy.Z)(i)?i:1)}}return{x:s,y:a}}getNativeAABBBounds(t){let e=t;return("string"==typeof t&&(e=(new DOMParser).parseFromString(t,"text/html").firstChild).lastChild&&(e=e.lastChild.firstChild),e.getBoundingClientRect)?new fC(e.getBoundingClientRect()):new iI.FB}removeDom(t){return t.parentElement.removeChild(t),!0}updateDom(t,e){let{width:i,height:r,style:n}=e;return n&&((0,nI.Z)(n)?t.setAttribute("style",n):Object.keys(n).forEach(e=>{t.style[e]=n[e]})),null!=i&&(t.style.width=`${i}px`),null!=r&&(t.style.height=`${r}px`),!0}createDom(t){let{tagName:e="div",parent:i}=t,r=document.createElement(e);if(this.updateDom(r,t),i){let t=(0,nI.Z)(i)?this.getElementById(i):i;t&&t.appendChild&&t.appendChild(r)}return r}loadImage(t){return fx(t,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(t){return fx(t,!0).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}createCanvas(t){var e,i;let r=document.createElement("canvas");t.id&&(r.id=null!=(e=t.id)?e:eJ.GenAutoIncrementId().toString());let n=null!=(i=t.dpr)?i:window.devicePixelRatio;return t.width&&t.height&&(r.style.width=`${t.width}px`,r.style.height=`${t.height}px`,r.width=t.width*n,r.height=t.height*n),r}createOffscreenCanvas(t){var e;let i=null!=(e=t.dpr)?e:window.devicePixelRatio;return new OffscreenCanvas(t.width*i,t.height*i)}releaseCanvas(t){let e;(e="string"==typeof t?document.getElementById(t):t)&&e.parentElement&&e.parentElement.removeChild(e)}getDevicePixelRatio(){return window.devicePixelRatio}getRequestAnimationFrame(){return window.requestAnimationFrame}getCancelAnimationFrame(){return window.cancelAnimationFrame}addEventListener(t,e,i){return document.addEventListener(t,e,i)}removeEventListener(t,e,i){return document.removeEventListener(t,e,i)}dispatchEvent(t){return document.dispatchEvent(t)}getElementById(t){return document.getElementById(t)}getRootElement(){return document.body}getDocument(){return document}release(...t){}getElementTop(t,e){let i=t.offsetTop,r=t.offsetParent;for(;null!==r;)i+=r.offsetTop,r=r.offsetParent;return i}getElementLeft(t,e){let i=t.offsetLeft,r=t.offsetParent;for(;null!==r;)i+=r.offsetLeft,r=r.offsetParent;return i}getElementTopLeft(t,e){let i=t.offsetTop,r=t.offsetLeft,n=t.offsetParent;for(;null!==n;)i+=n.offsetTop,r+=n.offsetLeft,n=n.offsetParent;return{top:i,left:r}}loadFont(t,e,i){var r,n,l,s;return r=this,n=void 0,l=void 0,s=function*(){return new FontFace(t,(0,nI.Z)(e)?`url(${e})`:e,i).load().then(function(t){return document.fonts.add(t),{loadState:"success"}}).catch(function(t){return console.error("Failed to load font:",t),{loadState:"fail"}})},new(l||(l=Promise))(function(t,e){function i(t){try{o(s.next(t))}catch(t){e(t)}}function a(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof l?r:new l(function(t){t(r)})).then(i,a)}o((s=s.apply(r,n||[])).next())})}isMacOS(){if(void 0===this._isMacOS)try{this._isMacOS=navigator.platform.toUpperCase().indexOf("MAC")>=0}catch(t){this._isMacOS=!1}return this._isMacOS}copyToClipBoard(t){return navigator.clipboard.writeText(t).then(()=>{}).catch(t=>{})}};fw=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],fw);let fS=new eQ(t=>{fS.isBrowserBound||(fS.isBrowserBound=!0,t(fw).toSelf().inSingletonScope(),t(ih).toService(fw))});function fA(t,e=!0){fA.__loaded||(fA.__loaded=!0,t.load(fS),t.load(fo),t.load(fb),e&&fm(t))}fS.isBrowserBound=!1,fA.__loaded=!1;let fM=class extends fl{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}getImageData(t,e,i,r){return new Promise((n,l)=>{var s;try{tt.canvasGetImageData({canvasId:null!=(s=this.canvas.nativeCanvas.id)?s:this.canvas.id,x:t,y:e,width:i,height:r,success(t){n(t)}})}catch(t){l(t)}})}draw(){let t=this.nativeContext;t.draw&&(this.drawPromise=new Promise(e=>{t.draw(!0,()=>{this.drawPromise=null,e(null)})}))}createPattern(t,e){return null}};fM.env="feishu",fM=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],fM);let fT=class extends g8{constructor(t){super(t)}init(){this._context=new fM(this,this._dpr)}release(...t){}};fT.env="feishu";let fk=fa(fT=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],fT),fM);class fR{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let fP=class extends fy{get container(){return null}constructor(t){super(),this.global=t,this.type="feishu",this.eventManager=new fR}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:eJ.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new fT(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new fT({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};fP.env="feishu",fP=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tf=it(id),function(t,e){tf(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],fP);let fB=new eQ(t=>{t(fP).toSelf(),t(nm).toDynamicValue(t=>t.container.get(fP)).whenTargetNamed(fP.env)});var fI=function(t,e){return function(i,r){e(i,r,t)}};let fE=class extends fd{constructor(t,e,i){super(e,i),this.contributions=t,this.pickItemInterceptorContributions=e,this.pickServiceInterceptorContributions=i,this.global.hooks.onSetEnv.tap("math-picker-service",(t,e,i)=>{this.configure(i,e)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(t=>{this.pickerMap.set(t.numberType,t)}),super._init()}configure(t,e){this.pickContext=new sE(null,1)}pickItem(t,e,i,r){if(!1===t.attribute.pickable)return null;let n=this.pickerMap.get(t.numberType);if(!n)return null;let l=n.contains(t,e,r),s=l?t:null;return s?{graphic:s,params:l}:null}};fE=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),fI(0,it(ii)),fI(0,ie(uq)),fI(1,it(ii)),fI(1,ie(ap)),fI(2,it(ii)),fI(2,ie(ag)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object,Object])],fE);let fL=new eQ(t=>{fL.__vloaded||(fL.__vloaded=!0,il(t,uq))});fL.__vloaded=!1;let fF=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="arc",this.numberType=se}};fF=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tm=it(s1),function(t,e){tm(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],fF);let fO=!1,fH=new eQ((t,e,i,r)=>{fO||(fO=!0,t(uJ).to(fF).inSingletonScope(),t(uq).toService(uJ))}),fD=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="area",this.numberType=sr}};fD=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(ty=it(s3),function(t,e){ty(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],fD);let fz=!1,fW=new eQ((t,e,i,r)=>{fz||(fz=!0,t(uQ).to(fD).inSingletonScope(),t(uq).toService(uQ))}),fZ=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="circle",this.numberType=sn}};fZ=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tv=it(s5),function(t,e){tv(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],fZ);let fN=!1,fj=new eQ((t,e,i,r)=>{fN||(fN=!0,t(u0).to(fZ).inSingletonScope(),t(uq).toService(u0))});class fG{constructor(){this.type="glyph",this.numberType=sl}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=null==i?void 0:i.pickerService;if(n){let r=!1;return t.getSubGraphic().forEach(t=>{if(r)return;let l=n.pickItem(t,e,null,i);r=!(!l||!l.graphic)}),r}return!1}}let fV=class extends fG{constructor(t){super(),this.canvasRenderer=t}};fV=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tb=it(as),function(t,e){tb(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],fV);let fU=!1,fK=new eQ((t,e,i,r)=>{fU||(fU=!0,t(u8).to(fV).inSingletonScope(),t(fV).toService(u8))}),fX=class{constructor(){this.type="image",this.numberType=sa}contains(t,e,i){let{pickContext:r}=null!=i?i:{};return!!r&&!!t.AABBBounds.containsPoint(e)}};fX=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],fX);let fY=!1,f$=new eQ((t,e,i,r)=>{fY||(fY=!0,t(u1).to(fX).inSingletonScope(),t(fX).toService(u1))}),fq=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="line",this.numberType=so}};fq=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(t_=it(s7),function(t,e){t_(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],fq);let fJ=!1,fQ=new eQ((t,e,i,r)=>{fJ||(fJ=!0,t(u2).to(fq).inSingletonScope(),t(uq).toService(u2))}),f0=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="polygon",this.numberType=sd}};f0=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tC=it(s9),function(t,e){tC(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],f0);let f1=!1,f2=new eQ((t,e,i,r)=>{f1||(f1=!0,t(u7).to(f0).inSingletonScope(),t(uq).toService(u7))}),f3=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="path",this.numberType=sh}};f3=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tx=it(s8),function(t,e){tx(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],f3);let f5=!1,f4=new eQ((t,e,i,r)=>{f5||(f5=!0,t(u3).to(f3).inSingletonScope(),t(uq).toService(u3))}),f6=!1,f7=new eQ((t,e,i,r)=>{f6||(f6=!0,t(u1).to(fX).inSingletonScope(),t(fX).toService(u1))}),f8=new eQ((t,e,i,r)=>{i(fE)||t(fE).toSelf().inSingletonScope(),i(au)?r(au).toService(fE):t(au).toService(fE)});function f9(t){t.load(fL),t.load(f8),t.load(fH),t.load(fW),t.load(fj),t.load(fK),t.load(f$),t.load(fQ),t.load(f2),t.load(f4),t.load(c4),t.load(f7),t.load(cO),t.load(cx)}class mt{get width(){return this._w*this.dpr}set width(t){}get height(){return this._h*this.dpr}set height(t){}get offsetWidth(){return this._w}set offsetWidth(t){}get offsetHeight(){return this._h}set offsetHeight(t){}constructor(t,e,i,r,n,l){this.nativeCanvas=t,this.ctx=e,this._w=r,this._h=n,this.id=l,t.id=l,this.dpr=i}getContext(){return this.ctx}getBoundingClientRect(){return{width:this._w,height:this._h}}}class me{get width(){return this._w*this.dpr}set width(t){this._w=t/this.dpr,this.nativeCanvas.width=t}get height(){return this._h*this.dpr}set height(t){this._h=t/this.dpr,this.nativeCanvas.height=t}get offsetWidth(){return this._w}set offsetWidth(t){this._w=t,this.nativeCanvas.width=t*this.dpr}get offsetHeight(){return this._h}set offsetHeight(t){this._h=t,this.nativeCanvas.height=t*this.dpr}constructor(t,e,i,r,n,l){this.nativeCanvas=t,this.ctx=e,this._w=r,this._h=n,this.id=l,t.id=l,this.dpr=i}getContext(){return this.ctx}getBoundingClientRect(){return{width:this._w,height:this._h}}}let mi=class extends f_{constructor(){super(),this.type="feishu",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}getDynamicCanvasCount(){return this.freeCanvasList.length}getStaticCanvasCount(){return 9999}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),function(t,e,i,r,n,l){let s=null!=l?l:tt.getSystemInfoSync().pixelRatio;e.forEach((e,l)=>{let a=tt.createCanvasContext(e),o=new mt(a.canvas||{},a,s,t.width,t.height,e);a.canvas=o,i.set(e,o),l>=r&&n.push(o)})}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.pixelRatio))}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return tt.getSystemInfoSync().pixelRatio}getRequestAnimationFrame(){return function(t){return n2.call(t)}}getCancelAnimationFrame(){return t=>{n2.clear(t)}}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}};mi=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],mi);let mr=new eQ(t=>{mr.isFeishuBound||(mr.isFeishuBound=!0,t(mi).toSelf().inSingletonScope(),t(ih).toService(mi))});function mn(t,e=!0){mn.__loaded||(mn.__loaded=!0,t.load(mr),t.load(fk),t.load(fB),e&&f9(t))}mr.isFeishuBound=!1,mn.__loaded=!1;let ml=class extends fl{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}setLineDash(t){let e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){let t=e[0];if(0===t[0]&&0===t[1])return;t&&i.setLineDash(t)}}_setStrokeStyle(t,e,i,r,n){let l=this.nativeContext;n||(n=this.strokeAttributes);let{strokeOpacity:s=n.strokeOpacity,opacity:a=n.opacity}=e;if(s>1e-12&&a>1e-12){let{lineWidth:o=n.lineWidth,stroke:h=n.stroke,lineJoin:d=n.lineJoin,lineDash:u=n.lineDash,lineCap:c=n.lineCap,miterLimit:p=n.miterLimit,keepStrokeScale:g=n.keepStrokeScale,lineDashOffset:f=n.lineDashOffset}=e;l.globalAlpha=s*a*this.baseGlobalAlpha,l.lineWidth=g?o:rZ(this,o,this.dpr),l.strokeStyle=rN(this,h,t,i,r),l.lineJoin=d,(0!==u[0]||0!==u[1])&&u&&(l.setLineDash(u),l.lineDashOffset=f),l.lineCap=c,l.miterLimit=p}}measureText(t,e=iC.global.measureTextMethod){return this.setTransform(1,0,0,1,0,0,!0,iC.global.devicePixelRatio),{width:super.measureText(t,e).width,fontBoundingBoxDescent:void 0,fontBoundingBoxAscent:void 0,actualBoundingBoxAscent:void 0,actualBoundingBoxDescent:void 0}}createPattern(t,e){return null}draw(){let t=this.nativeContext;t.draw&&(this.drawPromise=new Promise(e=>{t.draw(!0,()=>{this.drawPromise=null,e(null)})}))}};ml.env="lynx",ml=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],ml);let ms=class extends g8{constructor(t){super(t)}init(){this._context=new ml(this,this._dpr)}resize(t,e){this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._nativeCanvas.nativeCanvas&&(this._nativeCanvas.nativeCanvas.width=this._pixelWidth,this._nativeCanvas.nativeCanvas.height=this._pixelHeight),this._context.dpr=this._dpr}release(...t){}};ms.env="lynx",ms=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],ms);class ma{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let mo=class extends fy{get container(){return null}constructor(t){super(),this.global=t,this.type="lynx",this.eventManager=new ma}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:eJ.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new ms(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new ms({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};mo.env="lynx",mo=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tw=it(id),function(t,e){tw(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mo);let mh=new eQ(t=>{t(mo).toSelf(),t(nm).toDynamicValue(t=>t.container.get(mo)).whenTargetNamed(mo.env)}),md=fa(ms,ml),mu=!1;try{mu=!!lynx.createCanvasNG}catch(t){}let mc=class extends f_{constructor(){super(),this.type="lynx",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),function(t,e,i,r,n,l,s){let a=null!=s?s:SystemInfo.pixelRatio;if(e.forEach((e,s)=>{let o;l?o=lynx.createOffscreenCanvas():(o=mu?lynx.createCanvasNG(e):lynx.createCanvas(e),mu&&o.attachToCanvasView(e)),o.width=t.width*a,o.height=t.height*a;let h=o.getContext("2d"),d=new me(o,h,a,t.width,t.height,e);i.set(e,d),s>r&&n.push(d)}),!n.length&&lynx.createOffscreenCanvas){let e=lynx.createOffscreenCanvas();e.width=t.width*a,e.height=t.height*a;let r=e.getContext("2d"),l=Math.random().toString(),s=new me(e,r,a,t.width,t.height,l);i.set(l,s),n.push(s)}}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,!!e.offscreen,e.pixelRatio))}getDynamicCanvasCount(){return this.freeCanvasList.length}getStaticCanvasCount(){return 9999}loadImage(t){return(function(t,e=!1){if(e)return Promise.reject();let i=lynx.createImage(t);return new Promise((t,e)=>{i.onload=()=>{t(i)},i.onerror=()=>{e(Error("加载失败"))}})})(t,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return SystemInfo.pixelRatio}getRequestAnimationFrame(){return function(t){return n2.call(t)}}getCancelAnimationFrame(){return t=>{n2.clear(t)}}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}};mc=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],mc);let mp=new eQ(t=>{mp.isLynxBound||(mp.isLynxBound=!0,t(mc).toSelf().inSingletonScope(),t(ih).toService(mc))});function mg(t,e=!0){mg.__loaded||(mg.__loaded=!0,t.load(mp),t.load(md),t.load(mh),e&&f9(t))}mp.isLynxBound=!1,mg.__loaded=!1;let mf=class extends fl{constructor(t,e){super(t,e);let i=t.nativeCanvas.getContext("2d");if(!i)throw Error("发生错误，获取2d上下文失败");this.nativeContext=i,this.canvas=t,this.matrix=new iT.y(1,0,0,1,0,0),this.stack=[],this.dpr=null!=e?e:1}release(...t){}};mf.env="node",mf=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],mf);let mm=class extends g8{constructor(t){super(t)}init(){this._context=new mf(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}release(...t){this._nativeCanvas.release&&(0,nz.Z)(this._nativeCanvas.release)&&this._nativeCanvas.release()}};mm.env="node";let my=fa(mm=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mm),mf),mv=class extends fy{get container(){return null}constructor(t){super(),this.global=t,this.type="node"}getTitle(){return""}getWH(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:eJ.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new mm(i)}createWindowByCanvas(t){var e;let i=t.canvas,r=null!=(e=t.dpr)?e:1,n=t.width,l=t.height;null!=n&&null!=l&&t.canvasControled||(n=i.width/r,l=i.height/r),this.canvas=new mm({width:n,height:l,dpr:r,nativeCanvas:i,canvasControled:t.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}getImageBuffer(t="image/png"){return this.canvas.nativeCanvas.toBuffer(t)}addEventListener(t,e,i){}dispatchEvent(t){return!0}removeEventListener(t,e,i){}getStyle(){}setStyle(t){}getBoundingClientRect(){return null}clearViewBox(t){}};mv.env="node",mv=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tS=it(id),function(t,e){tS(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mv);let mb=new eQ(t=>{t(mv).toSelf(),t(nm).toDynamicValue(t=>t.container.get(mv)).whenTargetNamed(mv.env)}),m_=class extends f_{constructor(){super(...arguments),this.type="node",this._lastTime=0,this.supportEvent=!1}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),this.pkg=e)}getDynamicCanvasCount(){return 0}getStaticCanvasCount(){return 999}loadJson(t){let e=fetch(t).then(t=>t.json());return e.then(t=>({data:t,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(t){return fetch(t).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadImage(t){let{loadImage:e}=this.pkg;return e?e(t).then(t=>({loadState:t?"success":"fail",data:t})).catch(()=>({loadState:"fail",data:null})):Promise.reject(Error("node-canvas loadImage could not be found!"))}loadSvg(t){let e=this.pkg.Resvg;if(!e)return Promise.reject(Error("@resvg/resvg-js svgParser could not be found!"));let i=new e(t).render().asPng();return this.loadImage(i)}createCanvas(t){return this.pkg.createCanvas(t.width,t.height)}releaseCanvas(t){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return function(t){return n2.call(t)}}getCancelAnimationFrame(){return t=>{n2.clear(t)}}addEventListener(t,e,i){}removeEventListener(t,e,i){}getElementById(t){return null}getRootElement(){return null}dispatchEvent(t){}release(...t){}createOffscreenCanvas(t){}};m_=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],m_);let mC=new eQ(t=>{mC.isNodeBound||(mC.isNodeBound=!0,t(m_).toSelf().inSingletonScope(),t(ih).toService(m_))});function mx(t,e=!0){mx.__loaded||(mx.__loaded=!0,t.load(mC),t.load(my),t.load(mb))}mC.isNodeBound=!1,mx.__loaded=!1;let mw=class extends fl{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.setGlobalAlpha(t),this._globalAlpha=t}draw(){this.nativeContext.draw()}strokeText(t,e,i){}_setCommonStyle(t,e,i,r,n){let l=this.nativeContext;n||(n=this.fillAttributes);let{fillOpacity:s=n.fillOpacity,opacity:a=n.opacity,fill:o=n.fill}=e;s>1e-12&&a>1e-12&&(l.setGlobalAlpha(s*a),l.setFillStyle(rN(this,o,t,i,r)))}_setStrokeStyle(t,e,i,r,n){let l=this.nativeContext;n||(n=this.strokeAttributes);let{strokeOpacity:s=n.strokeOpacity,opacity:a=n.opacity}=e;if(s>1e-12&&a>1e-12){let{lineWidth:o=n.lineWidth,stroke:h=n.stroke,lineJoin:d=n.lineJoin,lineDash:u=n.lineDash,lineDashOffset:c=n.lineDashOffset,lineCap:p=n.lineCap,miterLimit:g=n.miterLimit,keepStrokeScale:f=n.keepStrokeScale}=e;l.setGlobalAlpha(s*a),l.setLineWidth(f?o:rZ(this,o,this.dpr)),l.setStrokeStyle(rN(this,h,t,i,r)),l.setLineJoin(d),u&&(l.setLineDash(u),l.lineDashOffset=c),l.setLineCap(p),l.setMiterLimit(g)}}setTextStyleWithoutAlignBaseline(t,e){var i;let r=this.nativeContext;e||(e=this.textAttributes),t.font?r.font=t.font:r.font=(0,uz.U)(t,e),r.setFontSize(null!=(i=t.fontSize)?i:e.fontSize)}setTextStyle(t,e){var i,r;let n=this.nativeContext;e||(e=this.textAttributes),t.font?n.font=t.font:n.font=(0,uz.U)(t,e),n.setTextAlign(null!=(i=t.textAlign)?i:e.textAlign),n.setTextBaseline(null!=(r=t.textBaseline)?r:e.textBaseline)}createConicGradient(t,e,i,r){return null}createPattern(t,e){return null}getImageData(t,e,i,r){let n=this.nativeContext,l=n.taro;if(n&&l)return!n.getImageData&&l.canvasGetImageData?new Promise((n,s)=>{try{l.canvasGetImageData({canvasId:this.canvas.nativeCanvas.id,sx:t,sy:e,sw:i,sh:r,success(t){n(t)}})}catch(t){s(t)}}):void 0}createRadialGradient(t,e,i,r,n,l){return this.nativeContext.createCircularGradient&&this.nativeContext.createCircularGradient(t,e,i,r,n,l)}};mw.env="taro",mw=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],mw);let mS=class extends g8{constructor(t){super(t)}init(){this._context=new mw(this,this._dpr)}release(...t){}};mS.env="taro";let mA=fa(mS=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mS),mw);class mM{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let mT=class extends fy{get container(){return null}constructor(t){super(),this.global=t,this.type="taro",this.eventManager=new mM}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:eJ.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new mS(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new mS({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches.length>0&&(t.changedTouches.forEach((e,i)=>{t.changedTouches[i]=Object.assign(Object.assign({},t.changedTouches[i]),{offsetX:e.x,offsetY:e.y})}),t.offsetX=t.changedTouches[0].offsetX,t.offsetY=t.changedTouches[0].offsetY),t.touches.length>0&&t.touches.forEach((e,i)=>{t.touches[i]=Object.assign(Object.assign({},t.touches[i]),{offsetX:e.x,offsetY:e.y})}),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};mT.env="taro",mT=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tA=it(id),function(t,e){tA(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mT);let mk=new eQ(t=>{t(mT).toSelf(),t(nm).toDynamicValue(t=>t.container.get(mT)).whenTargetNamed(mT.env)}),mR=class extends f_{constructor(){super(),this.type="taro",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}getDynamicCanvasCount(){return this.freeCanvasList.length}getStaticCanvasCount(){return 9999}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}configure(t,e){var i,r,n,l,s,a,o;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,r=e.canvasIdLists,n=this.canvasMap,l=e.freeCanvasIdx,s=this.freeCanvasList,a=e.taro,o=e.pixelRatio,r.forEach((t,e)=>{let r=a.createCanvasContext(t),h=new mt(r.canvas||{},r,o,i.width,i.height,t);return r.canvas=h,n.set(t,h),e>=l&&s.push(h),h}),this.taro=e.taro,this.pixelRatio=e.pixelRatio)}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){let e=window||globalThis;if(e.DOMParser){let i=(new e.DOMParser).parseFromString(t,"image/svg+xml").children[0],r=(new XMLSerializer).serializeToString(i);return Promise.resolve({data:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(r)}`,loadState:"success"})}if(e.Blob){let i=new e.Blob([t],{type:"image/svg+xml"});return Promise.resolve({data:e.URL.createObjectURL(i),loadState:"success"})}return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return this.pixelRatio}getRequestAnimationFrame(){return requestAnimationFrame}getCancelAnimationFrame(){return cancelAnimationFrame}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}};mR=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],mR);let mP=new eQ(t=>{mP.isTaroBound||(mP.isTaroBound=!0,t(mR).toSelf().inSingletonScope(),t(ih).toService(mR))});function mB(t,e=!0){mB.__loaded||(mB.__loaded=!0,t.load(mP),t.load(mA),t.load(mk),e&&f9(t))}mP.isTaroBound=!1,mB.__loaded=!1;let mI=class extends fl{draw(){}createPattern(t,e){return null}};mI.env="wx",mI=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],mI);let mE=class extends g8{constructor(t){super(t)}init(){this._context=new mI(this,this._dpr)}release(...t){}};mE.env="wx";let mL=fa(mE=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mE),mI);class mF{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let mO=class extends fy{get container(){return null}constructor(t){super(),this.global=t,this.type="wx",this.eventManager=new mF}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:eJ.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new mE(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new mE({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){var e,i,r,n;let{type:l}=t;return!!this.eventManager.cache[l]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=null!=(e=t.changedTouches[0].x)?e:t.changedTouches[0].pageX,t.changedTouches[0].clientX=null!=(i=t.changedTouches[0].x)?i:t.changedTouches[0].pageX,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=null!=(r=t.changedTouches[0].y)?r:t.changedTouches[0].pageY,t.changedTouches[0].clientY=null!=(n=t.changedTouches[0].y)?n:t.changedTouches[0].pageY),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[l].listener&&this.eventManager.cache[l].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};mO.env="wx",mO=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tM=it(id),function(t,e){tM(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mO);let mH=new eQ(t=>{t(mO).toSelf(),t(nm).toDynamicValue(t=>t.container.get(mO)).whenTargetNamed(mO.env)}),mD=class extends f_{constructor(){super(),this.type="wx",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}configure(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),(function(t,e,i,r,n,l,s){var a,o,h,d;return a=this,o=void 0,h=void 0,d=function*(){let t=wx.getSystemInfoSync().pixelRatio;for(let a=0;a<e.length;a++){let o=e[a];!s&&i.has(o)||(yield new Promise(e=>{let s=wx.createSelectorQuery();l&&(s=s.in(l)),s.select(`#${o}`).fields({node:!0,size:!0}).exec(l=>{if(!l[0])return;let s=l[0].node,h=l[0].width,d=l[0].height;s.width=h*t,s.height=d*t,i.set(o,s),a>=r&&n.push(s),e(null)})}))}},new(h||(h=Promise))(function(t,e){function i(t){try{n(d.next(t))}catch(t){e(t)}}function r(t){try{n(d.throw(t))}catch(t){e(t)}}function n(e){var n;e.done?t(e.value):((n=e.value)instanceof h?n:new h(function(t){t(n)})).then(i,r)}n((d=d.apply(a,o||[])).next())})})(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component,e.forceUpdate).then(()=>{})}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return wx.getSystemInfoSync().pixelRatio}getRequestAnimationFrame(){return function(t){return n2.call(t)}}getCancelAnimationFrame(){return t=>{n2.clear(t)}}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}};mD=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],mD);let mz=new eQ(t=>{mz._isWxBound||(mz._isWxBound=!0,t(mD).toSelf().inSingletonScope(),t(ih).toService(mD))});function mW(t,e=!0){mW.__loaded||(mW.__loaded=!0,t.load(mz),t.load(mL),t.load(mH),e&&f9(t))}function mZ(t){mZ.__loaded||(mZ.__loaded=!0,fA(t,!1),mn(t,!1),mg(t,!1),mx(t,!1),mB(t,!1),mW(t,!1),fm(t),hd.hooks.onSetEnv.tap("loadMathPicker",(e,i)=>{"browser"!==i&&f9(t)}))}mz._isWxBound=!1,mW.__loaded=!1,mZ.__loaded=!1;let mN=class extends fM{};mN.env="tt",mN=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],mN);let mj=class extends g8{constructor(t){super(t)}init(){this._context=new mN(this,this._dpr)}release(...t){}};mj.env="tt";let mG=fa(mj=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mj),mN);class mV{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let mU=class extends fy{get container(){return null}constructor(t){super(),this.global=t,this.type="tt",this.eventManager=new mV}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:eJ.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new mj(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let n=t.dpr;null==n&&(n=e.width/i),this.canvas=new mj({width:i,height:r,dpr:n,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};mU.env="tt",mU=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tT=it(id),function(t,e){tT(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mU);let mK=new eQ(t=>{t(mU).toSelf(),t(nm).toDynamicValue(t=>t.container.get(mU)).whenTargetNamed(mU.env)}),mX=class extends f_{constructor(){super(),this.type="tt",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}configure(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),(function(t,e,i,r,n,l){var s,a,o,h;return s=this,a=void 0,o=void 0,h=function*(){let t=tt.getSystemInfoSync().pixelRatio;for(let s=0;s<e.length;s++){let a=e[s];yield new Promise(e=>{let o=tt.createSelectorQuery();l&&(o=o.in(l)),o.select(`#${a}`).node().exec(l=>{let o=l[0].node,h=o.width,d=o.height;o.width=h*t,o.height=d*t,i.set(a,o),s>=r&&n.push(o),e(null)})})}},new(o||(o=Promise))(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){var n;e.done?t(e.value):((n=e.value)instanceof o?n:new o(function(t){t(n)})).then(i,r)}n((h=h.apply(s,a||[])).next())})})(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component).then(()=>{})}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return tt.getSystemInfoSync().pixelRatio}getRequestAnimationFrame(){return function(t){return n2.call(t)}}getCancelAnimationFrame(){return t=>{n2.clear(t)}}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}};mX=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],mX);let mY=new eQ(t=>{mY.isTTBound||(mY.isTTBound=!0,t(mX).toSelf().inSingletonScope(),t(ih).toService(mX))});function m$(t,e=!0){m$.__loaded||(m$.__loaded=!0,t.load(mY),t.load(mG),t.load(mK),e&&f9(t))}mY.isTTBound=!1,m$.__loaded=!1;let mq=class extends fl{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}setLineDash(t){let e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){let t=e[0];if(0===t[0]&&0===t[1])return;t&&i.setLineDash(t)}}_setStrokeStyle(t,e,i,r,n){let l=this.nativeContext;n||(n=this.strokeAttributes);let{strokeOpacity:s=n.strokeOpacity,opacity:a=n.opacity}=e;if(s>1e-12&&a>1e-12){let{lineWidth:o=n.lineWidth,stroke:h=n.stroke,lineJoin:d=n.lineJoin,lineDash:u=n.lineDash,lineCap:c=n.lineCap,miterLimit:p=n.miterLimit,keepStrokeScale:g=n.keepStrokeScale,lineDashOffset:f=n.lineDashOffset}=e;l.globalAlpha=s*a*this.baseGlobalAlpha,l.lineWidth=g?o:rZ(this,o,this.dpr),l.strokeStyle=rN(this,h,t,i,r),l.lineJoin=d,0===u[0]&&0===u[1]||(u&&l.setLineDash(u),l.lineDashOffset=f),l.lineCap=c,l.miterLimit=p}}measureText(t,e=iC.global.measureTextMethod){return this.setTransform(1,0,0,1,0,0,!0,iC.global.devicePixelRatio),super.measureText(t,e)}setTextStyleWithoutAlignBaseline(t,e,i){let r=this.nativeContext;e||(e=this.textAttributes);let{scaleIn3d:n=e.scaleIn3d}=t,l="";r.font=((t.font?t.font:(0,uz.U)(t,e,n&&this.camera&&this.camera.getProjectionScale(i)))||"").replace("px","vp");let{fontFamily:s=e.fontFamily,fontSize:a=e.fontSize}=t;this.fontFamily=s,this.fontSize=a,r.textAlign="left",r.textBaseline="alphabetic"}setTextStyle(t,e,i){var r,n;let l=this.nativeContext;e||(e=this.textAttributes);let s="";l.font=((t.font?t.font:(0,uz.U)(t,e,this.camera&&this.camera.getProjectionScale(i)))||"").replace("px","vp");let{fontFamily:a=e.fontFamily,fontSize:o=e.fontSize}=t;this.fontFamily=a,this.fontSize=o,l.textAlign=null!=(r=t.textAlign)?r:e.textAlign,l.textBaseline=null!=(n=t.textBaseline)?n:e.textBaseline}createPattern(t,e){return null}drawImage(){let t=this.nativeContext,e=arguments;e[0].drawImage&&(e[0]=e[0].transferToImageBitmap()),3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}draw(){}};mq.env="harmony",mq=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],mq);let mJ=class extends g8{constructor(t){super(t)}init(){this._context=new mq(this,this._dpr)}resize(t,e){}release(...t){}};mJ.env="harmony",mJ=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mJ);class mQ{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let m0=class extends fy{get container(){return null}constructor(t){super(),this.global=t,this.type="harmony",this.eventManager=new mQ}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:eJ.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new mJ(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}this.canvas=new mJ({width:i,height:r,dpr:1,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};m0.env="harmony",m0=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tk=it(id),function(t,e){tk(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],m0);let m1=new eQ(t=>{t(m0).toSelf(),t(nm).toDynamicValue(t=>t.container.get(m0)).whenTargetNamed(m0.env)}),m2=fa(mJ,mq),m3=class extends f_{constructor(){super(),this.type="harmony",this.supportEvent=!0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0,this.rafSTO=new n1(0)}configure(t,e){t.env===this.type&&t.setActiveEnvContribution(this)}getDynamicCanvasCount(){return 9999}getStaticCanvasCount(){return 9999}loadImage(t){}loadSvg(t){return Promise.reject()}createCanvas(t){return function(t,e,i){let r=new OffscreenCanvas(t,e),n=r.getContext("2d");return new mt({width:t,height:e,context:n,_c:r,getBoundingClientRect:()=>({width:t,height:e}),getContext:()=>n},n,1,t,e,i)}(t.width,t.height,t.id)}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return t=>this.rafSTO.call(t)}getCancelAnimationFrame(){return t=>{this.rafSTO.clear(t)}}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return null}getRootElement(){return null}getDocument(){return null}release(...t){}};m3=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],m3);let m5=new eQ(t=>{m5.isHarmonyBound||(m5.isHarmonyBound=!0,t(m3).toSelf().inSingletonScope(),t(ih).toService(m3))});function m4(t,e=!0){m4.__loaded||(m4.__loaded=!0,t.load(m5),t.load(m2),t.load(m1),e&&f9(t))}m5.isHarmonyBound=!1,m4.__loaded=!1;let m6=()=>{mZ(ib)},m7=()=>{fA(ib)},m8=()=>{mn(ib)},m9=()=>{mg(ib)},yt=()=>{mx(ib)},ye=()=>{mB(ib)},yi=()=>{mW(ib)},yr=()=>{m$(ib)},yn=()=>{m4(ib)};function yl(t,e){return t&&e.key in t?t[e.key]:e.default}function ys(t){return t&&"token"===t.type&&!!t.key}let ya=["animationThreshold","colorScheme","name","padding"];class yo{constructor(){this.id=hm(),this._plugins=[]}add(t){if(!t||0===t.length)return null;let e=[];return t.forEach(t=>{this._plugins.find(e=>e.id===t.id)?hO("不要重复添加相同的plugin"):(this._plugins.push(t),e.push(t),t.onAdd&&t.onAdd(this))}),e}load(t){let e=this.add(t);e&&e.length&&this.activate(t)}activate(t){t.length&&t.forEach(t=>{t.init&&t.init()})}get(t){return this._plugins.find(e=>e.id===t)}getAll(){return this._plugins.slice()}release(t){let e=this.get(t);e&&(e.release(this),this._plugins=this._plugins.filter(t=>t!==e))}releaseAll(){this._plugins.forEach(t=>{t.release(this)}),this._plugins=[]}clear(t){let e=this.get(t);e&&e.clear(this)}clearAll(){this._plugins.forEach(t=>{var e;null==(e=t.clear)||e.call(t,this)})}}class yh extends yo{constructor(t){super(),this.globalInstance=t}onInit(t){this._plugins.forEach(e=>{e.onInit&&e.onInit(this,t)})}onBeforeResize(t,e){this._plugins.forEach(i=>{i.onBeforeResize&&i.onBeforeResize(this,t,e)})}onAfterChartSpecTransform(t,e){this._plugins.forEach(i=>{i.onAfterChartSpecTransform&&i.onAfterChartSpecTransform(this,t,e)})}onAfterModelSpecTransform(t,e,i){this._plugins.forEach(r=>{r.onAfterModelSpecTransform&&r.onAfterModelSpecTransform(this,t,e,i)})}onBeforeInitChart(t,e){this._plugins.forEach(i=>{i.onBeforeInitChart&&i.onBeforeInitChart(this,t,e)})}onAfterInitChart(t,e){this._plugins.forEach(i=>{i.onAfterInitChart&&i.onAfterInitChart(this,t,e)})}releaseAll(){super.releaseAll(),this.globalInstance=null}}var yd=i(48393);class yu{constructor(){this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=eJ.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={},this.renderId=0,this.onWheel=t=>{try{let e=new t.constructor(t.type,t);this.pluginService.stage.window.getContext().getCanvas().nativeCanvas.dispatchEvent(e)}catch(t){return}}}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,e=>{e&&e===this.pluginService.stage&&this.drawHTML([...t.stage.getChildren()])})}deactivate(t){t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter(t=>t.name!==this.key),this.release()}getWrapContainer(t,e,i){let r;return r=e?"string"==typeof e?iC.global.getElementById(e):e:t.window.getContainer(),{wrapContainer:iC.global.createDom(Object.assign({tagName:"div",parent:r},i)),nativeContainer:r}}parseDefaultStyleFromGraphic(t){var e="text"===t.type&&t.attribute?t.attribute:nP(t).text;let i={},r=t=>/^\d+(\.\d+)?$/.test(`${t}`)?`${t}px`:`${t}`;return["textAlign","fontFamily","fontVariant","fontStyle","fontWeight"].forEach(t=>{e[t]&&(i[(0,ax.Z2)(t)]=e[t])}),["fontSize","lineHeight"].forEach(t=>{let n=(0,ax.Z2)(t);(0,nB.Z)(e[t])||(i[n]=r(e[t]))}),(0,aw.Z)(e.maxLineWidth)&&(i["max-width"]=r(e.maxLineWidth)),e.underline?i["text-decoration"]="underline":e.lineThrough&&(i["text-decoration"]="line-through"),e.fill&&(0,nI.Z)(e.fill)&&(i.color=e.fill),i}getTransformOfText(t){let e=nP(t).text,{textAlign:i=e.textAlign,textBaseline:r=e.textBaseline}=t.attribute,{rotateDeg:n,scaleX:l,scaleY:s}=t.globalTransMatrix.toTransformAttrs(),a={left:"0",start:"0",end:"-100%",center:"-50%",right:"-100%",top:"0",middle:"-50%",bottom:"-100%",alphabetic:"-79%"},o={left:"0",start:"0",end:"100%",center:"50%",right:"100%",top:"0",middle:"50%",bottom:"100%",alphabetic:"79%"};return{textAlign:i,transform:`translate(${a[i]},${a[r]}) rotate(${n}deg) scaleX(${l}) scaleY(${s})`,transformOrigin:`${o[i]} ${o[r]}`}}updateStyleOfWrapContainer(t,e,i,r,n){let{pointerEvents:l,penetrateEventList:s=[]}=n,a=this.parseDefaultStyleFromGraphic(t);a.display=!1!==t.attribute.visible?"block":"none",a.pointerEvents=!0===l?"all":l||"none","none"!==a.pointerEvents&&(this.removeWrapContainerEventListener(i),s.forEach(t=>{"wheel"===t&&i.addEventListener("wheel",this.onWheel)})),i.style.position||(i.style.position="absolute",r.style.position="relative");let o=0,h=0,d=t.globalAABBBounds,u=n.anchorType;if((0,nB.Z)(u)&&(u="text"===t.type?"position":"boundsLeftTop"),"boundsLeftTop"===u&&(u="top-left"),"position"===u||d.empty()){let e=t.globalTransMatrix;o=e.e,h=e.f}else{let t=(0,yd.v1)(d,u);o=t.x,h=t.y}let c=iC.global.getElementTopLeft(r,!1),p=e.window.getTopLeft(!1),g=e.viewBox,f=o+p.left-c.left+g.x1,m=h+p.top-c.top+g.y1;if(a.left=`${f}px`,a.top=`${m}px`,"text"===t.type&&"position"===u&&(a=Object.assign(Object.assign({},a),this.getTransformOfText(t))),(0,nz.Z)(n.style)){let e=n.style({top:m,left:f,width:d.width(),height:d.height()},t,i);e&&(a=Object.assign(Object.assign({},a),e))}else(0,nF.Z)(n.style)?a=Object.assign(Object.assign({},a),n.style):(0,nI.Z)(n.style)&&n.style&&(a=Object.assign(Object.assign({},a),(0,ax.wv)(n.style)));iC.global.updateDom(i,{width:n.width,height:n.height,style:a})}clearCacheContainer(){this.htmlMap&&Object.keys(this.htmlMap).forEach(t=>{this.htmlMap[t]&&this.htmlMap[t].renderId!==this.renderId&&this.removeElement(t)}),this.renderId+=1}drawHTML(t){"browser"===iC.global.env&&(t.sort((t,e)=>{var i,r;return(null!=(i=t.attribute.zIndex)?i:rx.zIndex)-(null!=(r=e.attribute.zIndex)?r:rx.zIndex)}).forEach(t=>{this.renderGroupHTML(t)}),this.clearCacheContainer())}renderGroupHTML(t){this.renderGraphicHTML(t),t.forEachChildren(t=>{t.isContainer?this.renderGroupHTML(t):this.renderGraphicHTML(t)})}removeElement(t){if(!this.htmlMap||!this.htmlMap[t])return;let{wrapContainer:e}=this.htmlMap[t];e&&iC.global.removeDom(e),this.htmlMap[t]=null}removeWrapContainerEventListener(t){t.removeEventListener("wheel",this.onWheel)}renderGraphicHTML(t){var e;let{html:i}=t.attribute;if(!i)return;let r=t.stage;if(!r)return;let{dom:n,container:l}=i;if(!n)return;let s=(0,nB.Z)(i.id)?`${null!=(e=t.id)?e:t._uid}_react`:i.id;if(this.htmlMap&&this.htmlMap[s]&&l&&l!==this.htmlMap[s].container&&this.removeElement(s),this.htmlMap&&this.htmlMap[s])"string"==typeof n?this.htmlMap[s].wrapContainer.innerHTML=n:n!==this.htmlMap[s].wrapContainer.firstChild&&(this.htmlMap[s].wrapContainer.removeChild(this.htmlMap[s].wrapContainer.firstChild),this.htmlMap[s].wrapContainer.appendChild(n));else{let{wrapContainer:t,nativeContainer:e}=this.getWrapContainer(r,l);t&&("string"==typeof n?t.innerHTML=n:t.appendChild(n),this.htmlMap||(this.htmlMap={}),this.htmlMap[s]={wrapContainer:t,nativeContainer:e,container:l,renderId:this.renderId})}if(!this.htmlMap||!this.htmlMap[s])return;let{wrapContainer:a,nativeContainer:o}=this.htmlMap[s];this.updateStyleOfWrapContainer(t,r,a,o,i),this.htmlMap[s].renderId=this.renderId}release(){"browser"===iC.global.env&&this.removeAllDom(this.pluginService.stage.defaultLayer)}removeAllDom(t){this.htmlMap&&(Object.keys(this.htmlMap).forEach(t=>{this.removeElement(t)}),this.htmlMap=null)}}let yc=()=>{d6.registerPlugin("HtmlAttributePlugin",yu)};class yp extends yu{constructor(){super(...arguments),this.name="ReactAttributePlugin",this.activeEvent="onRegister",this._uid=eJ.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={}}removeElement(t){if(!this.htmlMap||!this.htmlMap[t])return;let{root:e,wrapContainer:i,unmount:r}=this.htmlMap[t];e?iC.global.getRequestAnimationFrame()(()=>{e.unmount()}):r&&r(),i&&iC.global.removeDom(i),this.htmlMap[t]=null}renderGraphicHTML(t){var e;let{react:i}=t.attribute;if(!i)return;let r=t.stage;if(!r)return;let n=r.params.ReactDOM,{element:l,container:s}=i;if(!l||!n||!n.createRoot&&!n.render)return;let a=(0,nB.Z)(i.id)?`${null!=(e=t.id)?e:t._uid}_react`:i.id;if(this.htmlMap&&this.htmlMap[a]&&s&&s!==this.htmlMap[a].container&&this.removeElement(a),this.htmlMap&&this.htmlMap[a])n.createRoot?this.htmlMap[a].root.render(l):n.render(l,this.htmlMap[a].wrapContainer);else{let{wrapContainer:t,nativeContainer:e}=this.getWrapContainer(r,s);if(t)if(this.htmlMap||(this.htmlMap={}),n.createRoot){let i=n.createRoot(t);i.render(l),this.htmlMap[a]={root:i,wrapContainer:t,nativeContainer:e,container:s,renderId:this.renderId}}else n.render(l,t),this.htmlMap[a]={wrapContainer:t,nativeContainer:e,container:s,renderId:this.renderId,unmount:()=>{n.unmountComponentAtNode(t)}}}if(!this.htmlMap||!this.htmlMap[a])return;let{wrapContainer:o,nativeContainer:h}=this.htmlMap[a];this.updateStyleOfWrapContainer(t,r,o,h,i),this.htmlMap[a].renderId=this.renderId}}let yg=()=>{d6.registerPlugin("ReactAttributePlugin",yp)};var yf=i(12430);class ym{constructor(){this.transitions=new Map,this.registerDefaultTransitions()}static getInstance(){return ym.instance||(ym.instance=new ym),ym.instance}registerDefaultTransitions(){this.registerTransition("appear","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("appear","appear",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("appear","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("appear","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("normal","normal",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("normal","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("exit","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","enter",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","exit",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("enter","enter",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("enter","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("disappear","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("disappear","appear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("update","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("state","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","exit",()=>({allowTransition:!0,stopOriginalTransition:!0}))}isTransitionAllowed(t,e,i){var r,n,l,s;let a=null==(r=this.transitions.get(t))?void 0:r.get(e);return a||(a=null==(n=this.transitions.get(t))?void 0:n.get("*"))||(a=null==(l=this.transitions.get("*"))?void 0:l.get(e))||(a=null==(s=this.transitions.get("*"))?void 0:s.get("*"))?a(i,t):{allowTransition:!0,stopOriginalTransition:!0}}registerTransition(t,e,i){let r=this.transitions.get(t);r||(r=new Map,this.transitions.set(t,r)),r.set(e,i)}}function yy(t){if(!t||!(0,nz.Z)(t))return 0;let e=Function.prototype.toString.call(t);if(/^class\s/.test(e))return 1;if(!t.prototype)return 2;if(t.prototype.constructor===t){let e=Object.getOwnPropertyDescriptor(t,"prototype");if(e&&!e.writable)return 1}return 2}ym.getInstance(),(tR=tX||(tX={})).wait="wait",tR.from="from",tR.to="to",tR.customAnimate="customAnimate",(tP=tY||(tY={}))[tP.INITIAL=0]="INITIAL",tP[tP.RUNNING=1]="RUNNING",tP[tP.PAUSED=2]="PAUSED",tP[tP.END=3]="END";class yv{static registerBuiltInAnimate(t,e){yv.builtInAnimateMap[t]=e}constructor(t){this._animates=[],this._startCallbacks=[],this._endCallbacks=[],this._started=!1,this._activeCount=0,this._target=t}get started(){return this._started}onStart(t){t?(this._startCallbacks.push(t),this._started&&this._activeCount>0&&t()):this._startCallbacks.forEach(t=>{t()})}onEnd(t){t?this._endCallbacks.push(t):this._endCallbacks.forEach(t=>{t()})}_trackAnimation(t){this._animates.push(t),this._activeCount++,1!==this._activeCount||this._started||(this._started=!0,this.onStart()),t.onEnd(()=>{this._activeCount--;let e=this._animates.indexOf(t);e>=0&&this._animates.splice(e,1),0===this._activeCount&&this._started&&(this._started=!1,this.onEnd())})}parseParams(t,e,i){var r,n;let l=this.resolveValue(t.totalTime,void 0,void 0),s=this.resolveValue(t.startTime,void 0,0),a=Object.assign({},t);a.oneByOneDelay=0,a.startTime=s,a.totalTime=l;let o=this.resolveValue(t.oneByOne,i,!1);if(e){let t=a.timeSlices;(0,rD.Z)(t)||(a.timeSlices=[t]);let e=0;a.timeSlices=a.timeSlices.map(t=>{let r=this.resolveValue(t.delay,i,0),n=this.resolveValue(t.delayAfter,i,0),l=this.resolveValue(t.duration,i,300);return e+=r+l+n,Object.assign(Object.assign({},t),{delay:r,delayAfter:n,duration:l})});let r=0;o&&(r="number"==typeof o?o:o?e:0),a.oneByOneDelay=r;let n=1;if(l){let t=e+r*(this._target.count-2);n=l?l/t:1}a.timeSlices=a.timeSlices.map(t=>{let e=t.effects;return Array.isArray(e)||(e=[e]),Object.assign(Object.assign({},t),{delay:t.delay*n,delayAfter:t.delayAfter*n,duration:t.duration*n,effects:e.map(t=>{var e,i;let r=null!=(e=t.custom)?e:yv.builtInAnimateMap[null!=(i=t.type)?i:"fromTo"],n=yy(r);return Object.assign(Object.assign({},t),{custom:r,customType:n})})})}),a.oneByOneDelay=r*n,a.startTime=s*n}else{let e=this.resolveValue(t.delay,i,0),h=this.resolveValue(t.delayAfter,i,0),d=this.resolveValue(t.duration,i,300),u=0;o&&(u="number"==typeof o?o:o?e+h+d:0),a.oneByOneDelay=u,a.custom=null!=(r=t.custom)?r:yv.builtInAnimateMap[null!=(n=t.type)?n:"fromTo"];let c=yy(a.custom);if(a.customType=c,l){let t=e+h+d+u*(this._target.count-2),i=l?l/t:1;a.delay=e*i,a.delayAfter=h*i,a.duration=d*i,a.oneByOneDelay=u*i,a.startTime=s}}return a}execute(t){Array.isArray(t)?t.forEach(t=>this._execute(t)):this._execute(t)}_execute(t){let e;if(t.selfOnly)return this._executeItem(t,this._target,0,1);let i="timeSlices"in t;i&&t.partitioner&&(e=(null!=e?e:this._target.getChildren()).filter(e=>{var i,r;return t.partitioner(null==(r=null==(i=e.context)?void 0:i.data)?void 0:r[0],e,{})})),i&&t.sort&&(e=null!=e?e:this._target.getChildren()).sort((e,i)=>{var r,n,l,s;return t.sort(null==(n=null==(r=e.context)?void 0:r.data)?void 0:n[0],null==(s=null==(l=i.context)?void 0:l.data)?void 0:s[0],e,i,{})});let r=i?(e,r,n)=>{let l=this.parseParams(t,i,e),s=this.executeTimelineItem(l,e,r,n);s&&this._trackAnimation(s)}:(e,r,n)=>{let l=this.parseParams(t,i,e),s=this.executeTypeConfigItem(l,e,r,n);s&&this._trackAnimation(s)};e?e.forEach((t,i)=>r(t,i,e.length)):this._target.count<=1?r(this._target,0,1):this._target.forEachChildren((t,e)=>r(t,e,this._target.count-1))}executeTypeConfigItem(t,e,i,r){var n,l,s,a,o,h,d,u;let{type:c="fromTo",channel:p,customParameters:g,easing:f="linear",delay:m=0,delayAfter:y=0,duration:v=300,startTime:b=0,oneByOneDelay:_=0,loop:C,bounce:x,priority:w=0,options:S,custom:A,customType:M,controlOptions:T}=t,k=e.animate();k.priority=w;let R=(0,nz.Z)(m)?m(null==(l=null==(n=e.context)?void 0:n.data)?void 0:l[0],e,{}):m,P=null==(a=null==(s=e.context)?void 0:s.data)?void 0:a[0],B=null==(o=e.context)?void 0:o.indexKey;P&&B&&(i=null!=(h=P[B])?h:i),k.startAt(b);let I=i*_+R;I>0&&k.wait(I);let E=null,L=t.to,F=t.from;L||(E||(E=this.createPropsFromChannel(p,e)),L=E.props),F||(E||(E=this.createPropsFromChannel(p,e)),F=E.from),this._handleRunAnimate(k,A,M,F,L,v,f,g,T,S,c,e);let O=0;_&&(O=_*(r-i-1));let H=(0,nz.Z)(y)?y(null==(u=null==(d=e.context)?void 0:d.data)?void 0:u[0],e,{}):y;return H>0&&(O+=H),O>0&&k.wait(O),C&&C>0&&k.loop(C),x&&k.bounce(!0),k}_handleRunAnimate(t,e,i,r,n,l,s,a,o,h,d,u){var c,p,g,f,m,y,v,b;if(e&&i){i=yy(e);let d=this.resolveValue(a,u);"function"==typeof d&&(d=d(null==(p=null==(c=u.context)?void 0:c.data)?void 0:p[0],u,{})),d=Object.assign({width:(null==(g=u.stage)?void 0:g.width)||0,height:(null==(f=u.stage)?void 0:f.height)||0,group:this._target.parent},d);let _=(0,nz.Z)(h)?h.call(null,null!=(y=d&&(null==(m=d.data)?void 0:m[0]))?y:null==(b=null==(v=u.context)?void 0:v.data)?void 0:b[0],u,d):h;d.options=_,d.controlOptions=o,1===i?this.createCustomAnimation(t,e,r,n,l,s,d):2===i&&this.createCustomInterpolatorAnimation(t,e,n,l,s,d)}else"to"===d?t.to(n,l,s):"from"===d&&t.from(n,l,s)}executeTimelineItem(t,e,i,r){var n,l,s,a;let{timeSlices:o,startTime:h=0,loop:d,bounce:u,oneByOneDelay:c,priority:p,controlOptions:g}=t,f=null==(l=null==(n=e.context)?void 0:n.data)?void 0:l[0],m=null==(s=e.context)?void 0:s.indexKey;f&&m&&(i=null!=(a=f[m])?a:i);let y=e.animate();return y.priority=p,y.startAt(h),y.wait(i*c),d&&d>0&&y.loop(d),u&&y.bounce(!0),(Array.isArray(o)?o:[o]).forEach(t=>{this.applyTimeSliceToAnimate(t,y,e,g)}),c&&y.wait(c*(r-i-1)),y}applyTimeSliceToAnimate(t,e,i,r){var n,l,s,a;let{effects:o,duration:h=300,delay:d=0,delayAfter:u=0}=t,c=(0,nz.Z)(d)?d(null==(l=null==(n=i.context)?void 0:n.data)?void 0:l[0],i,{}):d,p=(0,nz.Z)(u)?u(null==(a=null==(s=i.context)?void 0:s.data)?void 0:a[0],i,{}):u;c>0&&e.wait(c),(Array.isArray(o)?o:[o]).forEach(t=>{var n;let{type:l="fromTo",channel:s,customParameters:a,easing:o="linear",options:d}=t,u=null,c=t.to,p=t.from;c||(u||(u=this.createPropsFromChannel(s,i)),c=u.props),p||(u||(u=this.createPropsFromChannel(s,i)),p=u.from);let g=null!=(n=t.custom)?n:yv.builtInAnimateMap[l],f=t.custom?t.customType:yy(g);this._handleRunAnimate(e,g,f,p,c,h,o,a,r,d,l,i)}),p>0&&e.wait(p)}createCustomInterpolatorAnimation(t,e,i,r,n,l){let s={};Object.keys(i).forEach(e=>{s[e]=t.target.getComputedAttribute(e)}),t.interpolateUpdateFunction=(i,r,n,s,a)=>{e(n,i,r,s,a,t.target,l)},t.to(i,r,n)}createCustomAnimation(t,e,i,r,n,l,s){let a=new e(i,r,n,l,s);t.play(a)}createPropsFromChannel(t,e){let i={},r=null;return t&&(Array.isArray(t)?t.forEach(t=>{var r,n;let l=null==(n=null==(r=e.context)?void 0:r.diffAttrs)?void 0:n[t];void 0!==l&&(i[t]=l)}):Object.keys(t).forEach(n=>{var l,s,a,o;let h=t[n];void 0!==h.to&&("function"==typeof h.to?i[n]=h.to(null==(s=null==(l=e.context)?void 0:l.data)?void 0:s[0],e,{}):i[n]=h.to),void 0!==h.from&&(r||(r={}),"function"==typeof h.from?r[n]=h.from(null==(o=null==(a=e.context)?void 0:a.data)?void 0:o[0],e,{}):r[n]=h.from)})),{from:r,props:i}}resolveValue(t,e,i){var r,n;return void 0===t?i:"function"==typeof t&&e?t(null==(n=null==(r=e.context)?void 0:r.data)?void 0:n[0],e,{}):t}executeItem(t,e,i=0,r=1){return Array.isArray(t)?t.map(t=>this._executeItem(t,e,i,r)).filter(Boolean):[this._executeItem(t,e,i,r)].filter(Boolean)}_executeItem(t,e,i=0,r=1){if(!e)return null;let n="timeSlices"in t,l=null,s=this.parseParams(t,n);return(l=n?this.executeTimelineItem(s,e,i,r):this.executeTypeConfigItem(s,e,i,r))&&this._trackAnimation(l),l}stop(t,e=!0){for(;this._animates.length>0;){let i=this._animates.pop();!1===e&&(i.status=tY.END),null==i||i.stop(t)}this._animates=[],this._activeCount=0,this._started&&(this._started=!1,e&&this.onEnd())}}yv.builtInAnimateMap={};let yb="appear",y_="disappear",yC="update",yx="highlight",yw="unhighlight";class yS{constructor(t){this.graphic=t}registerState(t){this.states||(this.states=new Map),this.states.set(t.name,t)}clearStates(){var t;null==(t=this.states)||t.clear()}}class yA{constructor(t){this.stateList=null,this.graphic=t}applyState(t,e,i){let r=ym.getInstance(),n=[],l=[];if(this.stateList&&this.stateList.length?t.forEach((t,i)=>{let s={allowTransition:!0};this.stateList.forEach(e=>{let i=r.isTransitionAllowed(e.state,t,this.graphic);s.allowTransition=s.allowTransition&&i.allowTransition}),s.allowTransition&&(l.push({state:t,animationConfig:(0,rD.Z)(e[i])?e[i].map(t=>t.animation):e[i].animation,executor:new yv(this.graphic)}),this.stateList.forEach(e=>{r.isTransitionAllowed(e.state,t,this.graphic).stopOriginalTransition&&n.push(e)}))}):t.forEach((t,i)=>{l.push({state:t,animationConfig:(0,rD.Z)(e[i])?e[i].map(t=>t.animation):e[i].animation,executor:new yv(this.graphic)})}),n.forEach(t=>{t.executor.stop(null,!1)}),l.length){l[0].executor.execute(l[0].animationConfig);for(let t=0;t<l.length;t++){let e=l[t+1],r=l[t];r.executor.onEnd(()=>{e&&e.executor.execute(e.animationConfig),this.stateList=this.stateList.filter(t=>t!==r),t===l.length-1&&i&&i(!1)})}}else i&&i(!0);this.stateList?this.stateList=this.stateList.filter(t=>!n.includes(t)):this.stateList=[],this.stateList.push(...l)}applyAppearState(t,e){this.applyState([yb],[{name:yb,animation:t}],e)}applyDisappearState(t,e){this.applyState([y_],[{name:y_,animation:t}],e)}applyUpdateState(t,e){this.applyState([yC],[{name:yC,animation:t}],e)}applyHighlightState(t,e){this.applyState([yx],[{name:yx,animation:t}],e)}applyUnhighlightState(t,e){this.applyState([yw],[{name:yw,animation:t}],e)}stopState(t,e){var i;let r=null==(i=this.stateList)?void 0:i.find(e=>e.state===t);r&&r.executor.stop(e)}clearState(){var t;null==(t=this.stateList)||t.forEach(t=>{t.executor.stop(null,!1)}),this.stateList=null}reApplyState(t){var e;let i=null==(e=this.stateList)?void 0:e.find(e=>e.state===t);if(i&&i.executor.started){let t=this.stateList.slice();i.executor.stop(),this.stateList=t,i.executor.execute(i.animationConfig)}}}class yM{_getAnimationStateManager(t){return t._animationStateManager||(t._animationStateManager=new yA(t)),t._animationStateManager}_getAnimationStateStore(t){return t._animationStateStore||(t._animationStateStore=new yS(t)),t._animationStateStore}registerAnimationState(t){return this._getAnimationStateStore(this).registerState(t),this}applyAnimationState(t,e,i){return this._getAnimationStateManager(this).applyState(t,e,i),this}applyAppearState(t,e){return this._getAnimationStateManager(this).applyAppearState(t,e),this}applyDisappearState(t,e){return this._getAnimationStateManager(this).applyDisappearState(t,e),this}applyUpdateState(t,e){return this._getAnimationStateManager(this).applyUpdateState(t,e),this}applyHighlightState(t,e){return this._getAnimationStateManager(this).applyHighlightState(t,e),this}applyUnhighlightState(t,e){return this._getAnimationStateManager(this).applyUnhighlightState(t,e),this}stopAnimationState(t,e,i=!1){return this._getAnimationStateManager(this).stopState(t,e),i&&this.isContainer&&this.forEachChildren(r=>{r.stopAnimationState(t,e,i)}),this}clearAnimationStates(){let t=this._animationStateManager;return t&&t.clearState(),this}reApplyAnimationState(t,e=!1){let i=this._animationStateManager;return i&&i.reApplyState(t),e&&this.isContainer&&this.forEachChildren(i=>{i.reApplyAnimationState(t,e)}),this}static extend(t){return(new yM)._getAnimationStateManager(t),t}}class yT extends nH(){get animateCount(){return this._animateCount}constructor(){super(),this.head=null,this.tail=null,this.animateMap=new Map,this._animateCount=0,this._playSpeed=1,this._totalDuration=0,this._startTime=0,this._currentTime=0,this._animationEndFlag=!0,this.id=eJ.GenAutoIncrementId(),this.paused=!1}isRunning(){return!this.paused&&this._animateCount>0}forEachAccessAnimate(t){let e=this.head,i=0;for(;e;){let r=e.next;t(e.animate,i),i++,e=r}}addAnimate(t){let e={animate:t,next:null,prev:null};this.head?this.tail&&(this.tail.next=e,e.prev=this.tail,this.tail=e):(this.head=e,this.tail=e),this.animateMap.set(t,e),this._animateCount++,this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())}pause(){this.paused=!0}resume(){this.paused=!1}tick(t){if(this.paused)return;this._animationEndFlag&&(this._animationEndFlag=!1,this.emit("animationStart"));let e=t*this._playSpeed;this._currentTime+=e,this.forEachAccessAnimate((t,i)=>{t.status===tY.END?this.removeAnimate(t,!0):t.status!==tY.RUNNING&&t.status!==tY.INITIAL||t.advance(e)}),0===this._animateCount&&(this._animationEndFlag=!0,this.emit("animationEnd"))}clear(){this.forEachAccessAnimate(t=>{t.release()}),this.head=null,this.tail=null,this.animateMap.clear(),this._animateCount=0,this._totalDuration=0}removeAnimate(t,e=!0){let i=this.animateMap.get(t);i&&(e&&(t._onRemove&&t._onRemove.forEach(t=>t()),t.release()),i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev,this.animateMap.delete(t),this._animateCount--,t.getStartTime()+t.getDuration()>=this._totalDuration&&this.recalculateTotalDuration())}recalculateTotalDuration(){this._totalDuration=0,this.forEachAccessAnimate(t=>{this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())})}getTotalDuration(){return this._totalDuration}getPlaySpeed(){return this._playSpeed}setPlaySpeed(t){this._playSpeed=t}getPlayState(){return this.paused?"paused":0===this.animateCount?"stopped":"playing"}setStartTime(t){this._startTime=t}getStartTime(){return this._startTime}getCurrentTime(){return this._currentTime}setCurrentTime(t){this._currentTime=t}}let yk=new yT;yk.isGlobal=!0;class yR{constructor(t=eJ.GenAutoIncrementId(),e=yk,i){this.id=t,this.status=tY.INITIAL,this._timeline=e,e.addAnimate(this),this.slience=i,this._startTime=0,this._duration=0,this._totalDuration=0,this._loopCount=0,this._currentLoop=0,this._bounce=!1,this._firstStep=null,this._lastStep=null,this._startProps={},this._endProps={},this._preventAttrs=new Set,this.currentTime=0,this.interpolateUpdateFunction=null,this.priority=0}getStartProps(){return this._startProps}getEndProps(){return this._endProps}setTimeline(t){this._timeline=t}getTimeline(){return this._timeline}get timeline(){return this._timeline}bind(t){return this.target=t,this.target.animates||(this.target.animates=new Map),this.target.animates.set(this.id,this),this.onRemove(()=>{this.stop(),this.target.animates.delete(this.id)}),this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.target.animationAttribute||(this.target.animationAttribute={}),this}to(t,e=300,i="linear"){let r=new gc(tX.to,t,e,i);return r.bind(this.target,this),this.updateStepAfterAppend(r),this}wait(t){let e=new gp(tX.wait,{},t,"linear");return e.bind(this.target,this),this.updateStepAfterAppend(e),this}updateStepAfterAppend(t){this._firstStep?this._lastStep.append(t):this._firstStep=t,this._lastStep=t,this.parseStepProps(t),this.updateDuration()}parseStepProps(t){this._lastStep&&(t.propKeys=t.propKeys||Object.keys(t.props),Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=null!=(i=t.props[e])?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}))}reSyncProps(){if(!this._lastStep)return;this._endProps={};let t=this._firstStep;for(;t;)Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=null!=(i=t.props[e])?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}),t=t.next}from(t,e=300,i="linear"){let r=new gc(tX.from,t,e,i);return this._firstStep?this._lastStep.append(r):this._firstStep=r,this._lastStep=r,this.updateDuration(),this}play(t){return t.bind(this.target,this),this.updateStepAfterAppend(t),this}pause(){this.status===tY.RUNNING&&(this.status=tY.PAUSED)}resume(){this.status===tY.PAUSED&&(this.status=tY.RUNNING)}onStart(t){var e;t?(this._onStart||(this._onStart=[]),this._onStart.push(t)):(null==(e=this._onStart)||e.forEach(t=>t()),Object.keys(this._endProps).forEach(t=>{this._startProps[t]=this.target.getComputedAttribute(t)}))}onEnd(t){var e;t?(this._onEnd||(this._onEnd=[]),this._onEnd.push(t)):null==(e=this._onEnd)||e.forEach(t=>t())}onFrame(t){t&&(this._onFrame||(this._onFrame=[]),this._onFrame.push(t))}onRemove(t){var e;t?(this._onRemove||(this._onRemove=[]),this._onRemove.push(t)):null==(e=this._onRemove)||e.forEach(t=>t())}preventAttr(t){this._preventAttrs.add(t),delete this._startProps[t],delete this._endProps[t];let e=this._firstStep;for(;e;)e.deleteSelfAttr(t),e=e.next}preventAttrs(t){t.forEach(t=>this._preventAttrs.add(t))}validAttr(t){return!this._preventAttrs.has(t)}runCb(t){var e;return null==(e=this._lastStep)||e.onEnd(t),this}startAt(t){return this._startTime=t,this}customInterpolate(t,e,i,r,n,l){return!1}getFromValue(){return this._startProps}getToValue(){return this._endProps}stop(t){let e=this._firstStep;for(;e;)e.stop(),e=e.next;this.status!==tY.END&&this.onEnd(),this.status=tY.END,this.target&&("start"===t?this.target.setAttributes(this._startProps):"end"===t?this.target.setAttributes(this._endProps):t&&this.target.setAttributes(t))}release(){this.status=tY.END,this._onRemove&&this._onRemove.forEach(t=>t()),this._onStart=[],this._onFrame=[],this._onEnd=[],this._onRemove=[],this.forEachStep(t=>{t.release()})}getDuration(){return this._duration}getStartTime(){return this._startTime}afterAll(t){if(!t||0===t.length)return this;let e=0;return t.forEach(t=>{let i=t.getStartTime()+t.getTotalDuration();e=Math.max(e,i)}),this.startAt(e)}after(t){if(!t)return this;let e=t.getStartTime()+t.getTotalDuration();return this.startAt(e)}parallel(t){return t&&this.startAt(t.getStartTime()),this}loop(t){return!0===t?t=1/0:!1===t&&(t=0),this._loopCount=t,this.updateDuration(),this}bounce(t){return this._bounce=t,this}advance(t){var e,i,r;if(this.status===tY.END)return void console.warn("aaa 动画已经结束，不能推进");let n=this.currentTime+t;if(n<this._startTime)return void(this.currentTime=n);if(n>=this._startTime+this._totalDuration)return null==(e=this._lastStep)||e.onUpdate(!0,1,{}),null==(i=this._lastStep)||i.onEnd(),this.onEnd(),void(this.status=tY.END);this.status=tY.RUNNING,this.currentTime<=this._startTime&&this.onStart(),this.currentTime=n;let l=n-this._startTime,s=!1,a=!1;if(this._loopCount>0){l=(n-this._startTime)%this._duration;let t=Math.floor((n-this._startTime)/this._duration);s=t>this._currentLoop,this._currentLoop=t,(a=this._bounce&&t%2==1)&&(l=this._duration-l)}s&&!a&&this.target.setAttributes(this._startProps);let o=null;if(this._lastStep===this._firstStep)o=this._firstStep;else{let t=this._firstStep;for(;t;){let e=t.getStartTime(),i=t.getDuration();if(l>=e&&l<=e+i){o=t;break}t=t.next}}if(!o)return;o!==this.lastRunStep&&(null==(r=this.lastRunStep)||r.onEnd()),this.lastRunStep=o;let h=(l-o.getStartTime())/o.getDuration(),d=h>=1;o.update(d,h,{}),d&&(o.onEnd(),this.lastRunStep=null)}updateDuration(){this._lastStep?(this._duration=this._lastStep.getStartTime()+this._lastStep.getDuration(),this._totalDuration=this._duration*(this._loopCount+1)):this._duration=0}getTotalDuration(){return this._totalDuration}getLoop(){return this._loopCount}forEachStep(t){let e=this._firstStep;for(;e;)t(e),e=e.next}}(tB=t$||(t$={}))[tB.INITIAL=0]="INITIAL",tB[tB.RUNNING=1]="RUNNING",tB[tB.PAUSE=2]="PAUSE";let yP=new iw;class yB{constructor(){this.released=!1}tick(t,e){yP.addAnimationFrameCb(()=>{if(!this.released)return e(this)})}release(){this.released=!0}getTime(){return Date.now()}}class yI extends nH(){constructor(t){super(),this.timelines=[],this.frameTimeHistory=[],this.handleTick=(t,e)=>{let{once:i=!1}=null!=e?e:{};if(this.ifCanStop())return this.stop(),!1;let r=t.getTime();this._lastTickTime=r,this.lastFrameTime<0&&(this.lastFrameTime=r-this.interval+this.timeOffset,this.frameTimeHistory.push(this.lastFrameTime));let n=r-this.lastFrameTime,l=this.checkSkip(n);return l||(this._handlerTick(n),this.lastFrameTime=r,this.frameTimeHistory.push(this.lastFrameTime)),i||t.tick(this.interval,this.handleTick),!l},this._handlerTick=t=>{this.status===t$.RUNNING&&(this.tickCounts++,this.timelines.forEach(e=>{e.tick(t)}),this.emit("tick",t))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.stage=t,this.autoStop=!0,this.interval=16,this.computeTimeOffsetAndJitter()}bindStage(t){this.stage=t}computeTimeOffsetAndJitter(){this.timeOffset=Math.floor(Math.random()*this.interval),this._jitter=Math.min(Math.max(.2*this.interval,6),.7*this.interval)}init(){this.interval=16,this.status=t$.INITIAL,iC.global.hooks.onSetEnv.tap("graph-ticker",()=>{this.initHandler(!1)}),iC.global.env&&this.initHandler(!1)}addTimeline(t){this.timelines.push(t)}remTimeline(t){this.timelines=this.timelines.filter(e=>e!==t)}getTimelines(){return this.timelines}initHandler(t=!1){this.setupTickHandler(t)}setupTickHandler(t=!1){if(!t&&this.tickerHandler)return!0;let e=new yB;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=e,!0}setInterval(t){this.interval=t,this.computeTimeOffsetAndJitter()}getInterval(){return this.interval}setFPS(t){this.setInterval(Math.floor(1e3/t))}getFPS(){return 1e3/this.interval}tick(t){this.tickerHandler.tick(t,t=>this.handleTick(t,{once:!0}))}tickTo(t){this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,t=>{this.handleTick(t,{once:!0})})}pause(){return this.status!==t$.INITIAL&&(this.status=t$.PAUSE,!0)}resume(){return this.status!==t$.INITIAL&&(this.status=t$.RUNNING,!0)}ifCanStop(){return!!(this.autoStop&&(!this.timelines.length||this.timelines.every(t=>!t.isRunning())))||!1}start(t=!1){return!(this.status===t$.RUNNING||!this.tickerHandler||!t&&(this.status===t$.PAUSE||this.ifCanStop()))&&(this.status=t$.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0)}stop(){this.status=t$.INITIAL,this.setupTickHandler(!0),this.lastFrameTime=-1}trySyncTickStatus(){this.status===t$.INITIAL&&this.timelines.some(t=>t.isRunning())?this.start():this.status===t$.RUNNING&&this.timelines.every(t=>!t.isRunning())&&this.stop()}release(){var t;this.stop(),this.timelines=[],null==(t=this.tickerHandler)||t.release(),this.tickerHandler=null,this.lastFrameTime=-1}checkSkip(t){var e,i,r;return"performance"!==(null==(r=null==(i=null==(e=this.stage)?void 0:e.params)?void 0:i.optimize)?void 0:r.tickRenderMode)&&t<this.interval+2*(Math.random()-.5)*this._jitter}}class yE{getAttributes(t=!1){return t&&this.finalAttribute?this.finalAttribute:this.attribute}animate(t){var e,i,r;let n=new yR(null==t?void 0:t.id,null!=(i=null!=(e=null==t?void 0:t.timeline)?e:this.stage&&this.stage.getTimeline())?i:yk,null==t?void 0:t.slience);if(n.bind(this),t){let{onStart:e,onEnd:i,onRemove:r}=t;null!=e&&n.onStart(e),null!=i&&n.onEnd(i),null!=r&&n.onRemove(r)}return null==(r=this.stage)||r.ticker.start(),n}createTimeline(){return new yT}createTicker(t){return new yI(t)}setFinalAttributes(t){this.finalAttribute||(this.finalAttribute={}),Object.assign(this.finalAttribute,t)}initFinalAttributes(t){this.finalAttribute=t}initAnimateExecutor(){this._animateExecutor||(this._animateExecutor=new yv(this))}executeAnimation(t){return this.initAnimateExecutor(),this._animateExecutor.execute(t),this}executeAnimations(t){return this.initAnimateExecutor(),t.forEach(t=>{this._animateExecutor.execute(t)}),this}getFinalAttribute(){return this.finalAttribute}getGraphicAttribute(t,e=!1){return!e&&this.finalAttribute?this.finalAttribute[t]:this.attribute[t]}pauseAnimation(t=!1){this.animates&&this.animates.forEach(t=>t.pause()),t&&this.isContainer&&this.forEachChildren(e=>{e.pauseAnimation(t)})}resumeAnimation(t=!1){this.animates&&this.animates.forEach(t=>t.resume()),t&&this.isContainer&&this.forEachChildren(e=>{e.resumeAnimation(t)})}stopAnimation(t=!1){this.animates&&this.animates.forEach(t=>t.stop()),t&&this.isContainer&&this.forEachChildren(e=>{e.stopAnimation(t)})}}function yL(){(0,yf.jB)(sN,yM),(0,yf.jB)(sN,yE)}class yF{constructor(t){this.onPointerDown=t=>{let e=t.target,i=this.rootNode,r=e===i;if(e&&!r){let l,s=!1;function n(t){if(s||(t.type="dragstart",null==e||e.dispatchEvent(t),s=!0),t.type="drag",null==e||e.dispatchEvent(t),!r){e.attribute.pickable=!1;let r=(null==i?void 0:i.pick(t.global.x,t.global.y)).graphic;e.attribute.pickable=!0,l!==r&&(l&&(t.type="dragleave",t.target=l,l.dispatchEvent(t)),r&&(t.type="dragenter",t.target=r,r.dispatchEvent(t)),(l=r)&&(t.type="dragover",t.target=l,l.dispatchEvent(t)))}}null==i||i.addEventListener("pointermove",n);let a=function(){s&&(l&&(t.type="drop",t.target=l,l.dispatchEvent(t)),t.type="dragend",e.dispatchEvent(t),s=!1),null==i||i.removeEventListener("pointermove",n)};e.addEventListener("pointerup",a,{once:!0}),e.addEventListener("pointerupoutside",a,{once:!0})}},this.rootNode=t,this.initEvents()}initEvents(){var t;null==(t=this.rootNode)||t.addEventListener("pointerdown",this.onPointerDown)}removeEvents(){var t;null==(t=this.rootNode)||t.removeEventListener("pointerdown",this.onPointerDown)}release(){this.removeEvents(),this.rootNode=null}}let yO=(t,e)=>{let i=e.x-t.x,r=e.y-t.y;return Math.abs(i)>Math.abs(r)?i>0?"right":"left":r>0?"down":"up"},yH=(t,e)=>{let i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return Math.sqrt(i*i+r*r)},yD=t=>{let e=t.length;if(1===e)return{x:Math.round(t[0].x),y:Math.round(t[0].y)};let i=0,r=0,n=0;for(;n<e;)i+=t[n].x,r+=t[n].y,n++;return{x:Math.round(i/e),y:Math.round(r/e)}};class yz extends nH(){constructor(t,e={}){var i,r,n,l,s,a,o,h,d,u;super(),this.cachedEvents=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this.lastTapTarget=null,this.onStart=t=>{this.startTime=d$.now();let{cachedEvents:e,startPoints:i}=this;t&&e.push(t.clone()),i.length=e.length;for(let t=0;t<e.length;t++){let{x:r,y:n}=e[t],l={x:r,y:n};i[t]=l}if(1!==i.length)this.startDistance=yH(i[0],i[1]),this.center=yD([i[0],i[1]]);else{let t=e[0];this.pressTimeout=setTimeout(()=>{t.direction="none",t.deltaX=0,t.deltaY=0,t.points=i,this.triggerStartEvent("press",t),this.triggerEvent("press",t),this.eventType="press",this.direction="none",this.pressTimeout=null},this.config.press.time)}},this.onMove=t=>{this.clearPressTimeout();let{startPoints:e,cachedEvents:i}=this;if(!e.length)return;let r=t.clone(),{x:n,y:l,pointerId:s}=r;for(let t=0,e=i.length;t<e;t++)if(s===i[t].pointerId){i[t]=r;break}let a={x:n,y:l},o=i.map(t=>({x:t.x,y:t.y})),h=d$.now();if(this.prevMoveTime=this.lastMoveTime,this.prevMovePoint=this.lastMovePoint,this.lastMoveTime=h,this.lastMovePoint=a,1===e.length){let t=e[0],i=n-t.x,s=l-t.y,h=this.direction||yO(t,a);this.direction=h;let d=this.getEventType(a);return r.direction=h,r.deltaX=i,r.deltaY=s,r.points=o,this.triggerStartEvent(d,r),void this.triggerEvent(d,r)}let{startDistance:d}=this;r.scale=yH(o[0],o[1])/d,r.center=this.center,r.points=o,this.triggerStartEvent("pinch",r),this.triggerEvent("pinch",r)},this.onEnd=t=>{let e=t.clone(),{cachedEvents:i,startPoints:r}=this;if(e.points=i.map(t=>({x:t.x,y:t.y})),this.triggerEndEvent(e),1===i.length){let i=d$.now(),n=this.lastMoveTime;if(i-n<100){let t=n-(this.prevMoveTime||this.startTime);if(t>0){let i=this.prevMovePoint||r[0],n=this.lastMovePoint||r[0],l=yH(i,n),s=l/t;if(s>this.config.swipe.velocity&&l>this.config.swipe.threshold)return e.velocity=s,e.direction=yO(i,n),this.triggerEvent("swipe",e),this.cachedEvents=[],this.startPoints=[],void this.reset()}}i-this.startTime<this.config.press.time&&(i-this.lastTapTime<this.config.tap.interval&&t.target===this.lastTapTarget?this.tapCount++:this.tapCount=1,this.lastTapTime=i,this.lastTapTarget=t.target,1===this.tapCount?this.triggerEvent("tap",e):2===this.tapCount&&(this.triggerEvent("doubletap",e),this.tapCount=0))}for(let t=0,n=i.length;t<n;t++)if(i[t].pointerId===e.pointerId){i.splice(t,1),r.splice(t,1);break}this.reset(),i.length>0&&this.onStart()},this.element=t,this.tapCount=0,this.lastTapTime=0,this.config={press:{time:null!=(r=null==(i=null==e?void 0:e.press)?void 0:i.time)?r:251,threshold:null!=(l=null==(n=null==e?void 0:e.press)?void 0:n.threshold)?l:9},swipe:{threshold:null!=(a=null==(s=null==e?void 0:e.swipe)?void 0:s.threshold)?a:10,velocity:null!=(h=null==(o=null==e?void 0:e.swipe)?void 0:o.velocity)?h:.3},tap:{interval:null!=(u=null==(d=null==e?void 0:e.tap)?void 0:d.interval)?u:300}},this.initEvents()}initEvents(){let{element:t}=this;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerleave",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}removeEvents(){let{element:t}=this;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerleave",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}release(){this.removeEvents(),this.element=null}getEventType(t){let e,{eventType:i,startTime:r,startPoints:n}=this;return"press"===i?i:(e=d$.now()-r>this.config.press.time&&yH(n[0],t)<this.config.press.threshold?"press":"pan",this.eventType=e,e)}enable(t){this.processEvent[t]=!0}isProcess(t){return this.processEvent[t]}pushEvent(t,e){let{emitThrottles:i}=this,r={type:t,ev:e};for(let e=0,n=i.length;e<n;e++)if(i[e].type===t)return void i.splice(e,1,r);i.push(r)}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}reset(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}triggerEvent(t,e){this.pushEvent(t,e);let{throttleTimer:i,emitThrottles:r}=this;i||(this.throttleTimer=iC.global.getRequestAnimationFrame()(()=>{iC.global.getCancelAnimationFrame()(this.throttleTimer),this.throttleTimer=null;for(let t=0,e=r.length;t<e;t++){let{type:e,ev:i}=r[t];this.emitEvent(e,i)}this.emitThrottles.length=0}))}triggerStartEvent(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent(`${t}start`,e))}triggerEndEvent(t){let e=this.processEvent;Object.keys(e).forEach(i=>{this.triggerEvent(`${i}end`,t),"press"===i&&this.triggerEvent(`${i}up`,t),delete e[i]})}emitEvent(t,e){if(!this.element)return;let i=this.element._events;this._callListeners(t,e,i["*"]),this._callListeners(t,e,i[t]),this.emit(t,e)}_callListeners(t,e,i){if(i)if("fn"in i)i.fn.call(i.context,e,t);else for(let r=0,n=i.length;r<n&&!e.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,e,t)}}class yW extends gg{constructor(t,e,i,r,n){super(null,{},i,r,n),this.clipFromAttribute=t,this.clipToAttribute=e,this._group=null==n?void 0:n.group,this._clipGraphic=null==n?void 0:n.clipGraphic}onBind(){super.onBind(),this._group&&this._clipGraphic&&(this._lastClip=this._group.attribute.clip,this._lastPath=this._group.attribute.path,this._group.setAttributes({clip:!0,path:[this._clipGraphic]},!1,{type:o3.ANIMATE_BIND}))}onEnd(){this._group&&this._group.setAttributes({clip:this._lastClip,path:this._lastPath},!1,{type:o3.ANIMATE_END})}onUpdate(t,e,i){if(!this._clipGraphic)return;let r={};Object.keys(this.clipFromAttribute).forEach(t=>{r[t]=this.clipFromAttribute[t]+(this.clipToAttribute[t]-this.clipFromAttribute[t])*e}),this._clipGraphic.setAttributes(r,!1,{type:o3.ANIMATE_UPDATE,animationState:{ratio:e,end:t}})}}class yZ extends yW{constructor(t,e,i,r,n){var l,s,a,o,h,d,u,c,p,g,f,m;let y,v,b=null!=(s=null==(l=null==n?void 0:n.group)?void 0:l.attribute)?s:{},_=null!=(a=b.width)?a:0,C=null!=(o=b.height)?o:0,x=null!=(h=null==n?void 0:n.animationType)?h:"in",w=null!=(d=null==n?void 0:n.startAngle)?d:0,S=null!=(u=null==n?void 0:n.orient)?u:"clockwise",A=0,M=0;"anticlockwise"===S?(M="in"===x?w+2*Math.PI:w,M=w+2*Math.PI):(A=w,M="out"===x?w+2*Math.PI:w);let T=iC.graphicService.creator.arc({x:null!=(p=null==(c=null==n?void 0:n.center)?void 0:c.x)?p:_/2,y:null!=(f=null==(g=null==n?void 0:n.center)?void 0:g.y)?f:C/2,outerRadius:null!=(m=null==n?void 0:n.radius)?m:(_+C)/2,innerRadius:0,startAngle:A,endAngle:M,fill:!0});"anticlockwise"===S?(y={startAngle:w+2*Math.PI},v={startAngle:w}):(y={endAngle:w},v={endAngle:w+2*Math.PI}),super("in"===x?y:v,"in"===x?v:y,i,r,{group:null==n?void 0:n.group,clipGraphic:T})}}class yN extends yW{constructor(t,e,i,r,n){var l,s,a,o,h,d,u,c,p;let g=null!=(s=null==(l=null==n?void 0:n.group)?void 0:l.attribute)?s:{},f=null!=(o=null!=(a=null==n?void 0:n.width)?a:g.width)?o:0,m=null!=(d=null!=(h=null==n?void 0:n.height)?h:g.height)?d:0,y=null!=(u=null==n?void 0:n.animationType)?u:"in",v=null!=(c=null==n?void 0:n.direction)?c:"x",b=null!=(p=null==n?void 0:n.orient)?p:"positive",_=iC.graphicService.creator.rect({x:0,y:0,width:"in"===y&&"x"===v?0:f,height:"in"===y&&"y"===v?0:m,fill:!0}),C={},x={};"y"===v?"negative"===b?(C={y:m,height:0},x={y:0,height:m}):(C={height:0},x={height:m}):"negative"===b?(C={x:f,width:0},x={x:0,width:f}):(C={width:0},x={width:f}),super("in"===y?C:x,"in"===y?x:C,i,r,{group:null==n?void 0:n.group,clipGraphic:_})}}var yj=i(94030);class yG extends gg{constructor(t,e,i,r,n){var l,s;super(t,e,i,r,n),this.newPointAnimateType=null!=(l=null==n?void 0:n.newPointAnimateType)?l:"grow",this.clipRangeByDimension=null!=(s=null==n?void 0:n.clipRangeByDimension)?s:"x"}getPoints(t,e=!1){if(t.points)return t.points;if(t.segments){let i=[];return this.segmentsCache||(this.segmentsCache=[]),t.segments.map(t=>{var r,n;t.points&&i.push(...t.points),e&&this.segmentsCache.push(null!=(n=null==(r=t.points)?void 0:r.length)?n:0)}),i}return[]}onBind(){super.onBind();let{points:t,segments:e}=this.target.attribute,{points:i,segments:r}=this.target.getFinalAttribute();this.from={points:t,segments:e},this.to={points:i,segments:r},this.props=this.to;let n=this.getPoints(this.from),l=this.getPoints(this.to,!0);this.fromPoints=n?Array.isArray(n)?n:[n]:[],this.toPoints=l?Array.isArray(l)?l:[l]:[];let s=new Map;this.fromPoints.forEach(t=>{t.context&&s.set(t.context,t)});let a,o,h=1/0,d=-1/0;for(let t=0;t<this.toPoints.length;t+=1)if(s.has(this.toPoints[t].context)){h=t,a=s.get(this.toPoints[t].context);break}for(let t=this.toPoints.length-1;t>=0;t-=1)if(s.has(this.toPoints[t].context)){d=t,o=s.get(this.toPoints[t].context);break}"clip"===this.newPointAnimateType&&0!==this.toPoints.length&&(Number.isFinite(d)?(this.clipRange=this.toPoints[d][this.clipRangeByDimension]/this.toPoints[this.toPoints.length-1][this.clipRangeByDimension],1===this.clipRange&&(this.shrinkClipRange=this.toPoints[d][this.clipRangeByDimension]/this.fromPoints[this.fromPoints.length-1][this.clipRangeByDimension]),(0,hy.Z)(this.clipRange)?this.clipRange=(0,yj.Z)(this.clipRange,0,1):this.clipRange=0):this.clipRange=0);let u=this.toPoints[0];this.interpolatePoints=this.toPoints.map((t,e)=>{let i=s.get(t.context);return i?(u=i,[i,t]):"appear"===this.newPointAnimateType||"clip"===this.newPointAnimateType?[t,t]:e<h&&a?[a,t]:e>d&&o?[o,t]:[u,t]}),this.points=this.interpolatePoints.map(t=>{let e=t[0],i=t[1],r=new iN.E9(e.x,e.y,e.x1,e.y1);return r.defined=i.defined,r.context=i.context,r})}onFirstRun(){let t=this.target.attribute.clipRange;(0,hy.Z)(t*this.clipRange)&&(this.clipRange*=t)}onUpdate(t,e,i){if(t)return Object.keys(this.to).forEach(t=>{this.target.attribute[t]=this.to[t]}),this.target.addUpdatePositionTag(),void this.target.addUpdateShapeAndBoundsTag();if(this.points=this.points.map((t,i)=>{let r=nJ(this.interpolatePoints[i][0],this.interpolatePoints[i][1],e);return r.context=t.context,r}),this.clipRange){if(this.shrinkClipRange)return void(t?(i.points=this.toPoints,i.clipRange=1):(i.points=this.fromPoints,i.clipRange=this.clipRange-(this.clipRange-this.shrinkClipRange)*e));this.target.setAttributes({clipRange:this.clipRange+(1-this.clipRange)*e})}if(this.segmentsCache&&this.to.segments){let t=0,e=this.to.segments.map((e,i)=>{let r=t+this.segmentsCache[i],n=this.points.slice(t,r);return t=r,Object.assign(Object.assign({},e),{points:n})});this.target.attribute.segments=e}else this.target.attribute.points=this.points;this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class yV extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n,l,s,a,o,h,d;let u,c;super.onBind();let p=this.target.getFinalAttribute(),g=null!=(t=this.target.attribute)?t:{};switch(null==(e=this.params)?void 0:e.direction){case"x":u={scaleX:null!=(i=g.scaleX)?i:0},c={scaleX:null!=(r=null==p?void 0:p.scaleX)?r:1},this._updateFunction=this.updateX;break;case"y":u={scaleY:null!=(n=g.scaleY)?n:0},c={scaleY:null!=(l=null==p?void 0:p.scaleY)?l:1},this._updateFunction=this.updateY;break;default:u={scaleX:null!=(s=g.scaleX)?s:0,scaleY:null!=(a=g.scaleY)?a:0},c={scaleX:null!=(o=null==p?void 0:p.scaleX)?o:1,scaleY:null!=(h=null==p?void 0:p.scaleY)?h:1},this._updateFunction=this.updateXY}let f=this.target.getFinalAttribute();f&&this.target.setAttributes(f),this.props=c,this.from=u,this.to=c,!1!==(null==(d=this.params.controlOptions)?void 0:d.immediatelyApply)&&this.target.setAttributes(u)}onEnd(t){super.onEnd(t)}updateX(t){this.target.attribute.scaleX=this.from.scaleX+(this.to.scaleX-this.from.scaleX)*t}updateY(t){this.target.attribute.scaleY=this.from.scaleY+(this.to.scaleY-this.from.scaleY)*t}updateXY(t){this.updateX(t),this.updateY(t)}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];let e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateXY:"scaleX"===this.propKeys[0]?this._updateFunction=this.updateX:"scaleY"===this.propKeys[0]?this._updateFunction=this.updateY:this._updateFunction=null}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag())}}class yU extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n;let l,s;super.onBind();let a=this.target.attribute;switch(null==(t=this.params)?void 0:t.direction){case"x":l={scaleX:null!=(e=null==a?void 0:a.scaleX)?e:1},s={scaleX:0};break;case"y":l={scaleY:null!=(i=null==a?void 0:a.scaleY)?i:1},s={scaleY:0};break;default:l={scaleX:null!=(r=null==a?void 0:a.scaleX)?r:1,scaleY:null!=(n=null==a?void 0:a.scaleY)?n:1},s={scaleX:0,scaleY:0}}this.props=s,this.from=l,this.to=s}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}}class yK extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i;super.onBind();let r=this.target.getFinalAttribute(),n=null!=(t=this.target.attribute)?t:{},l={},s=null!=(e=this.from)?e:{};this.keys.forEach(t=>{var e,i,a;l[t]=null!=(e=null==r?void 0:r[t])?e:1,s[t]=null!=(a=null!=(i=s[t])?i:n[t])?a:0});let a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),this.props=l,this.propKeys=this.keys,this.from=s,this.to=l,!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(s)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class yX extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){super.onBind();let t=this.target.attribute,e={},i={};this.keys.forEach(r=>{var n;e[r]=0,i[r]=null!=(n=t[r])?n:1}),this.props=e,this.propKeys=this.keys,this.from=i,this.to=e,Object.assign(this.target.attribute,i),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class yY extends yK{constructor(t,e,i,r,n){super(t,e,i,r,n),this.keys=["opacity","fillOpacity","strokeOpacity"],this.from={opacity:0,fillOpacity:0,strokeOpacity:0}}}class y$ extends yX{constructor(t,e,i,r,n){super(t,e,i,r,n),this.keys=["opacity","fillOpacity","strokeOpacity"]}}let yq=(t,e,i)=>{var r,n,l,s;let{offset:a=0,orient:o,direction:h,point:d,excludeChannels:u=[],layoutRect:c={}}=null!=e?e:{},p=0,g=0;"negative"===o&&(p=null!=(r=c.width)?r:t.stage.viewWidth,g=null!=(n=c.height)?n:t.stage.viewHeight),p+=a,g+=a;let f=(0,nz.Z)(d)?d.call(null,null==(s=null==(l=t.context)?void 0:l.data)?void 0:s[0],t,i):d,m=t.getGraphicAttribute("x"),y=t.getGraphicAttribute("y"),v=u.includes("x")?m:f&&(0,hy.Z)(f.x)?f.x:p,b=u.includes("y")?y:f&&(0,hy.Z)(f.y)?f.y:g;switch(h){case"x":return{from:{x:u.includes("x")?m:v},to:{x:m}};case"y":return{from:{y:b},to:{y:y}};default:return{from:{x:v,y:b},to:{x:m,y:y}}}},yJ=(t,e,i)=>{var r,n,l,s;let{offset:a=0,orient:o,direction:h,point:d}=null!=e?e:{},u=i.group?i.group.AABBBounds:null,c=null!=(r=u.width())?r:i.width,p=null!=(n=u.height())?n:i.height,g=(0,nz.Z)(d)?d.call(null,null==(s=null==(l=t.context)?void 0:l.data)?void 0:s[0],t,i):d,f=g&&(0,hy.Z)(g.x)?g.x:("negative"===o?c:0)+a,m=g&&(0,hy.Z)(g.y)?g.y:("negative"===o?p:0)+a;switch(h){case"x":return{from:{x:t.getGraphicAttribute("x")},to:{x:f}};case"y":return{from:{y:t.getGraphicAttribute("y")},to:{y:m}};default:return{from:{x:t.getGraphicAttribute("x"),y:t.getGraphicAttribute("y")},to:{x:f,y:m}}}};class yQ extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class y0 extends yQ{onBind(){var t;super.onBind();let{from:e,to:i}=yq(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}}class y1 extends yQ{onBind(){super.onBind();let{from:t,to:e}=yJ(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(t=>null!=e[t]),this.from=t,this.to=e}}let y2=(t,e)=>{var i;let r=null!=(i=t.getFinalAttribute().angle)?i:0,n=0;return{from:{angle:(0,ng.Yt)(r/(2*Math.PI),0)?Math.round(r/(2*Math.PI))*Math.PI*2:(0,hy.Z)(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(r/(2*Math.PI))*Math.PI*2:Math.floor(r/(2*Math.PI))*Math.PI*2},to:{angle:r}}},y3=(t,e)=>{var i;let r=null!=(i=t.getFinalAttribute().angle)?i:0,n=0;return n=(0,ng.Yt)(r/(2*Math.PI),0)?Math.round(r/(2*Math.PI))*Math.PI*2:(0,hy.Z)(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(r/(2*Math.PI))*Math.PI*2:Math.floor(r/(2*Math.PI))*Math.PI*2,{from:{angle:r},to:{angle:n}}};class y5 extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class y4 extends y5{onBind(){var t;super.onBind();let{from:e,to:i}=y2(this.target,this.params.options);this.props=i,this.propKeys=["angle"],this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}}class y6 extends y5{onBind(){super.onBind();let{from:t,to:e}=y3(this.target,this.params.options);this.props=e,this.propKeys=["angle"],this.from=t,this.to=e}}class y7 extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e;super.onBind();let{diffAttrs:i={}}=null!=(t=this.target.context)?t:{},{options:r}=this.params;i=Object.assign({},i),(null==(e=null==r?void 0:r.excludeChannels)?void 0:e.length)&&r.excludeChannels.forEach(t=>{delete i[t]}),this.props=i}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.fromProps[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i)}}class y8 extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.fromProps[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}class y9 extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.from=null!=t?t:{}}onBind(){var t,e;super.onBind(),Object.keys(this.from).forEach(t=>{null==this.props[t]&&(this.props[t]=this.target.getGraphicAttribute(t))});let i=this.target.getFinalAttribute();"appear"===(null==(t=this.target.context)?void 0:t.animationState)&&i&&this.target.setAttributes(i),!1!==(null==(e=this.params.controlOptions)?void 0:e.immediatelyApply)&&this.target.setAttributes(this.from)}onFirstRun(){this.from=Object.assign(Object.assign({},this.getLastProps()),this.from);let t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.from[e]=null!=(i=this.from[e])?i:t[e]}),this.target.setAttributes(this.from)}deleteSelfAttr(t){super.deleteSelfAttr(t),delete this.from[t]}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.from,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.from[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}let vt=(t,e,i)=>{var r;return!1!==(null!=(r=null==e?void 0:e.overall)&&r)?function(t,e,i){var r,n,l;let s,a=t.getFinalAttribute(),o=a.y,h=a.y1,d=a.height;return e&&"negative"===e.orient?(0,n4.Z)(e.overall)?s=e.overall:i.group?(s=null!=(l=null!=(r=i.groupHeight)?r:null==(n=e.layoutRect)?void 0:n.height)?l:i.group.getBounds().height(),i.groupHeight=s):s=i.height:s=(0,n4.Z)(null==e?void 0:e.overall)?e.overall:0,{from:{y:s,y1:(0,nB.Z)(h)?void 0:s,height:(0,nB.Z)(d)?void 0:0},to:{y:o,y1:h,height:d}}}(t,e,i):function(t,e,i){let r=t.getFinalAttribute(),n=r.y,l=r.y1,s=r.height;if(e&&"negative"===e.orient){let t=(0,aw.Z)(s)?Math.max(n,n+s):Math.max(n,l);return{from:{y:t,y1:(0,nB.Z)(l)?void 0:t,height:(0,nB.Z)(s)?void 0:0},to:{y:n,y1:l,height:s}}}let a=(0,aw.Z)(s)?Math.min(n,n+s):Math.min(n,l);return{from:{y:a,y1:(0,nB.Z)(l)?void 0:a,height:(0,nB.Z)(s)?void 0:0},to:{y:n,y1:l,height:s}}}(t,e,0)};class ve extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i;super.onBind();let{from:r,to:n}=vt(this.target,this.params.options,this.params),l=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=l,this.to=n;let s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(l)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class vi extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r;super.onBind();let{from:n,to:l}=(t=this.target,e=this.params.options,i=this.params,!1!==(null!=(r=null==e?void 0:e.overall)&&r)?function(t,e,i){var r,n,l;let s,a=t.getFinalAttribute(),o=a.y1,h=a.height;return e&&"negative"===e.orient?(0,n4.Z)(e.overall)?s=e.overall:i.group?(s=null!=(l=null!=(r=i.groupHeight)?r:null==(n=e.layoutRect)?void 0:n.height)?l:i.group.getBounds().height(),i.groupHeight=s):s=i.height:s=(0,n4.Z)(null==e?void 0:e.overall)?e.overall:0,{to:{y:s,y1:(0,nB.Z)(o)?void 0:s,height:(0,nB.Z)(h)?void 0:0}}}(t,e,i):function(t,e,i){let r=t.getFinalAttribute(),n=r.y,l=r.y1,s=r.height;if(e&&"negative"===e.orient){let t=(0,aw.Z)(s)?Math.max(n,n+s):Math.max(n,l);return{to:{y:t,y1:(0,nB.Z)(l)?void 0:t,height:(0,nB.Z)(s)?void 0:0}}}let a=(0,aw.Z)(s)?Math.min(n,n+s):Math.min(n,l);return{to:{y:a,y1:(0,nB.Z)(l)?void 0:a,height:(0,nB.Z)(s)?void 0:0}}}(t,e,0));this.props=l,this.propKeys=Object.keys(l).filter(t=>null!=l[t]),this.from=null!=n?n:this.target.attribute,this.to=l}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}let vr=(t,e,i)=>{var r;return!1!==(null!=(r=null==e?void 0:e.overall)&&r)?function(t,e,i){var r;let n,l=t.getFinalAttribute(),s=l.x,a=l.x1,o=l.width;return e&&"negative"===e.orient?(0,n4.Z)(e.overall)?n=e.overall:i.group?(n=null!=(r=i.groupWidth)?r:i.group.getBounds().width(),i.groupWidth=n):n=i.width:n=(0,n4.Z)(null==e?void 0:e.overall)?null==e?void 0:e.overall:0,{from:{x:n,x1:(0,nB.Z)(a)?void 0:n,width:(0,nB.Z)(o)?void 0:0},to:{x:s,x1:a,width:o}}}(t,e,i):function(t,e,i){let r=t.getFinalAttribute(),n=r.x,l=r.x1,s=r.width;if(e&&"negative"===e.orient){let t=(0,aw.Z)(s)?Math.max(n,n+s):Math.max(n,l);return{from:{x:t,x1:(0,nB.Z)(l)?void 0:t,width:(0,nB.Z)(s)?void 0:0},to:{x:n,x1:l,width:s}}}let a=(0,aw.Z)(s)?Math.min(n,n+s):Math.min(n,l);return{from:{x:a,x1:(0,nB.Z)(l)?void 0:a,width:(0,nB.Z)(s)?void 0:0},to:{x:n,x1:l,width:s}}}(t,e,0)};class vn extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i;super.onBind();let{from:r,to:n}=vr(this.target,this.params.options,this.params),l=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=l,this.to=n;let s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(l)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class vl extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r;super.onBind();let{from:n,to:l}=(t=this.target,e=this.params.options,i=this.params,!1!==(null!=(r=null==e?void 0:e.overall)&&r)?function(t,e,i){var r;let n,l=t.getFinalAttribute(),s=l.x1,a=l.width;return e&&"negative"===e.orient?(0,n4.Z)(e.overall)?n=e.overall:i.group?(n=null!=(r=i.groupWidth)?r:i.group.getBounds().width(),i.groupWidth=n):n=i.width:n=(0,n4.Z)(null==e?void 0:e.overall)?e.overall:0,{to:{x:n,x1:(0,nB.Z)(s)?void 0:n,width:(0,nB.Z)(a)?void 0:0}}}(t,e,i):function(t,e,i){let r=t.getFinalAttribute(),n=r.x,l=r.x1,s=r.width;if(e&&"negative"===e.orient){let t=(0,aw.Z)(s)?Math.max(n,n+s):Math.max(n,l);return{to:{x:t,x1:(0,nB.Z)(l)?void 0:t,width:(0,nB.Z)(s)?void 0:0}}}let a=(0,aw.Z)(s)?Math.min(n,n+s):Math.min(n,l);return{to:{x:a,x1:(0,nB.Z)(l)?void 0:a,width:(0,nB.Z)(s)?void 0:0}}}(t,e,0));this.props=l,this.propKeys=Object.keys(l).filter(t=>null!=l[t]),this.from=null!=n?n:this.target.attribute,this.to=l}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}let vs=(t,e,i)=>{let r=t.getFinalAttribute();switch(null==e?void 0:e.direction){case"x":{let t=r.x,e=r.x1,i=r.width;return{from:(0,aw.Z)(i)?{x:t+i/2,x1:void 0,width:0}:{x:(t+e)/2,x1:(t+e)/2,width:void 0},to:{x:t,x1:e,width:i}}}case"y":{let t=r.y,e=r.y1,i=r.height;return{from:(0,aw.Z)(i)?{y:t+i/2,y1:void 0,height:0}:{y:(t+e)/2,y1:(t+e)/2,height:void 0},to:{y:t,y1:e,height:i}}}default:{let t=r.x,e=r.x1,i=r.width,n=r.y,l=r.y1,s=r.height,a={};return(0,aw.Z)(i)?(a.x=t+i/2,a.width=0,a.x1=void 0):(a.x=(t+e)/2,a.x1=(t+e)/2,a.width=void 0),(0,aw.Z)(s)?(a.y=n+s/2,a.height=0,a.y1=void 0):(a.y=(n+l)/2,a.y1=(n+l)/2,a.height=void 0),{from:a,to:{x:t,y:n,x1:e,y1:l,width:i,height:s}}}}},va=(t,e,i)=>{let r=t.attribute;switch(null==e?void 0:e.direction){case"x":{let t=r.x,e=r.x1,i=r.width;return{to:(0,aw.Z)(i)?{x:t+i/2,x1:void 0,width:0}:{x:(t+e)/2,x1:(t+e)/2,width:void 0}}}case"y":{let t=r.y,e=r.y1,i=r.height;return{to:(0,aw.Z)(i)?{y:t+i/2,y1:void 0,height:0}:{y:(t+e)/2,y1:(t+e)/2,height:void 0}}}default:{let t=r.x,e=r.y,i=r.x1,n=r.y1,l=r.width,s=r.height,a={};return(0,aw.Z)(l)?(a.x=t+l/2,a.width=0,a.x1=void 0):(a.x=(t+i)/2,a.x1=(t+i)/2,a.width=void 0),(0,aw.Z)(s)?(a.y=e+s/2,a.height=0,a.y1=void 0):(a.y=(e+n)/2,a.y1=(e+n)/2,a.height=void 0),{to:a}}}};class vo extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i;super.onBind();let{from:r,to:n}=vs(this.target,this.params.options,this.params),l=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=l,this.to=n;let s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(l)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class vh extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){super.onBind();let{from:t,to:e}=va(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(t=>null!=e[t]),this.from=null!=t?t:this.target.attribute,this.to=e}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}let vd=(t,e,i)=>{let r=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==r?void 0:r.outerRadius},to:{innerRadius:null==r?void 0:r.innerRadius}}:{from:{outerRadius:null==r?void 0:r.innerRadius},to:{outerRadius:null==r?void 0:r.outerRadius}}},vu=(t,e,i)=>{let r=t.getFinalAttribute(),n=(0,n4.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:n,outerRadius:n},to:{innerRadius:null==r?void 0:r.innerRadius,outerRadius:null==r?void 0:r.outerRadius}}},vc=(t,e,i)=>{var r;return!1!==(null!=(r=null==e?void 0:e.overall)&&r)?vu(t,e):vd(t,e)},vp=(t,e,i)=>{let r=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==r?void 0:r.innerRadius},to:{innerRadius:null==r?void 0:r.outerRadius}}:{from:{outerRadius:null==r?void 0:r.outerRadius},to:{outerRadius:null==r?void 0:r.innerRadius}}},vg=(t,e,i)=>{let r=t.getFinalAttribute(),n=(0,n4.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:null==r?void 0:r.innerRadius,outerRadius:null==r?void 0:r.outerRadius},to:{innerRadius:n,outerRadius:n}}};class vf extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class vm extends vf{onBind(){var t,e,i;super.onBind();let{from:r,to:n}=vc(this.target,this.params.options,this.params),l=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=l,this.to=n;let s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(l)}}class vy extends vf{onBind(){var t,e,i;super.onBind();let{to:r}=(t=this.target,e=this.params.options,this.params,!1!==(null!=(i=null==e?void 0:e.overall)&&i)?vg(t,e):vp(t,e));this.props=r,this.propKeys=Object.keys(r).filter(t=>null!=r[t]),this.from=this.target.attribute,this.to=r}}let vv=(t,e,i)=>{let r=t.getFinalAttribute();return e&&"anticlockwise"===e.orient?{from:{startAngle:null==r?void 0:r.endAngle},to:{startAngle:null==r?void 0:r.startAngle}}:{from:{endAngle:null==r?void 0:r.startAngle},to:{endAngle:null==r?void 0:r.endAngle}}},vb=(t,e,i)=>{let r=t.getFinalAttribute();if(e&&"anticlockwise"===e.orient){let t=(0,n4.Z)(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:t,endAngle:t},to:{startAngle:null==r?void 0:r.startAngle,endAngle:null==r?void 0:r.endAngle}}}let n=(0,n4.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:n,endAngle:n},to:{startAngle:null==r?void 0:r.startAngle,endAngle:null==r?void 0:r.endAngle}}},v_=(t,e,i)=>{var r;return!1!==(null!=(r=null==e?void 0:e.overall)&&r)?vb(t,e):vv(t,e)},vC=(t,e,i)=>{let r=t.attribute;return e&&"anticlockwise"===e.orient?{from:{startAngle:r.startAngle},to:{startAngle:null==r?void 0:r.endAngle}}:{from:{endAngle:r.endAngle},to:{endAngle:null==r?void 0:r.startAngle}}},vx=(t,e,i)=>{let r=t.attribute;if(e&&"anticlockwise"===e.orient){let t=(0,n4.Z)(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:r.startAngle,endAngle:r.endAngle},to:{startAngle:t,endAngle:t}}}let n=(0,n4.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:r.startAngle,endAngle:r.endAngle},to:{startAngle:n,endAngle:n}}};class vw extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}determineUpdateFunction(){this.propKeys?this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this.valid=!1:this.valid=!1}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];let e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this._updateFunction=null}updateStartAngle(t){this.target.attribute.startAngle=this.from.startAngle+(this.to.startAngle-this.from.startAngle)*t}updateEndAngle(t){this.target.attribute.endAngle=this.from.endAngle+(this.to.endAngle-this.from.endAngle)*t}updateAngle(t){this.updateStartAngle(t),this.updateEndAngle(t)}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdateShapeAndBoundsTag())}}class vS extends vw{onBind(){var t,e,i;super.onBind();let{from:r,to:n}=v_(this.target,this.params.options,this.params),l=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=l,this.to=n;let s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(l),this.determineUpdateFunction()}}class vA extends vw{onBind(){var t,e,i;super.onBind();let{from:r,to:n}=(t=this.target,e=this.params.options,this.params,!1!==(null!=(i=null==e?void 0:e.overall)&&i)?vx(t,e):vC(t,e));this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=null!=r?r:this.target.attribute,this.to=n,this.determineUpdateFunction()}}let vM=(t,e,i)=>{let r=t.getFinalAttribute().points,n={x:0,y:0};return r.forEach(t=>{n.x+=t.x,n.y+=t.y}),n.x/=r.length,n.y/=r.length,e&&e.center&&((0,hy.Z)(e.center.x)&&(n.x=e.center.x),(0,hy.Z)(e.center.y)&&(n.y=e.center.y)),"area"===t.type&&(n.x1=n.x,n.y1=n.y),r.map(t=>Object.assign({},t,n))},vT=(t,e,i)=>{let r=t.getFinalAttribute();return{from:{points:vM(t,e)},to:{points:r.points}}};class vk extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onUpdate(t,e,i){var r,n;let l=null==(r=this.from)?void 0:r.points,s=null==(n=this.to)?void 0:n.points;l&&s&&(this.target.attribute.points=l.map((t,i)=>nJ(l[i],s[i],e)),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag())}}class vR extends vk{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:e,to:i}=vT(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}else this.valid=!1}}class vP extends vk{onBind(){var t,e;if(super.onBind(),["area","line"].includes(this.target.type)){let i=this.target.getFinalAttribute(),{from:r,to:n}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:vM(t,e)}});this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=r||i,this.to=n}else this.valid=!1}}let vB=(t,e,i)=>t.getFinalAttribute().points.map(i=>{if(e&&"negative"===e.orient){let e=t.stage.viewWidth;return t.parent.parent.parent&&(e=t.parent.parent.parent.AABBBounds.width()),Object.assign(Object.assign({},i),{x:e,y:i.y,x1:e,y1:i.y1,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:0,y:i.y,x1:0,y1:i.y1,defined:!1!==i.defined})}),vI=(t,e,i)=>{let r=t.getFinalAttribute();return{from:{points:vB(t,e)},to:{points:r.points}}};class vE extends vk{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:e,to:i}=vI(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}else this.valid=!1}}class vL extends vk{onBind(){var t,e;if(super.onBind(),["area","line"].includes(this.target.type)){let i=this.target.getFinalAttribute(),{from:r,to:n}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:vB(t,e)}});this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.from=r||i,this.to=n}else this.valid=!1}}let vF=(t,e,i)=>t.getFinalAttribute().points.map(i=>{if(e&&"negative"===e.orient){let e=t.stage.viewHeight;return t.parent.parent.parent&&(e=t.parent.parent.parent.AABBBounds.height()),Object.assign(Object.assign({},i),{x:i.x,y:e,x1:i.x1,y1:e,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:i.x,y:0,x1:i.x1,y1:0,defined:!1!==i.defined})}),vO=(t,e,i)=>{let r=t.getFinalAttribute();return{from:{points:vF(t,e)},to:{points:r.points}}};class vH extends vk{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:e,to:i}=vO(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}else this.valid=!1}}class vD extends vk{onBind(){var t,e;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:i,to:r}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:vF(t,e)}});this.props=r,this.propKeys=Object.keys(r).filter(t=>null!=r[t]),this.from=null!=i?i:this.target.attribute,this.to=r}else this.valid=!1}}class vz extends yK{constructor(t,e,i,r,n){super(t,e,i,r,n),this.keys=["clipRange"],this.from={clipRange:0}}onFirstRun(){var t;super.onFirstRun();let{clipDimension:e}=(null==(t=this.params)?void 0:t.options)||{};e&&(this.target.attribute.clipRangeByDimension=e)}}class vW extends yX{constructor(t,e,i,r,n){super(t,e,i,r,n),this.keys=["clipRange"]}}let vZ=t=>({type:"clipIn",options:{clipDimension:"horizontal"===t.direction?"y":"x"}}),vN={type:"fadeIn"},vj=t=>({type:"horizontal"===t.direction?"growPointsXIn":"growPointsYIn",options:{orient:"horizontal"===t.direction?"positive":"negative"}});class vG extends gm{constructor(t,e,i,r,n){super(t,e,i,r,n),this.currentAnimationRatio=0,this.animationTime=0}onUpdate(t,e,i){super.onUpdate(t,e,i),this.currentAnimationRatio=e,this.animationTime=e*Math.PI*2}getAnimationTime(){return this.currentAnimationRatio>0?this.animationTime:Date.now()/1e3}afterStageRender(t,e){var i,r;return null==(r=null==(i=this.params)?void 0:i.callBack)?void 0:r.call(i,t,e,this.currentAnimationRatio,this.animationTime)}}let vV={appear:{duration:1e3,easing:"cubicOut"},update:{type:"update",duration:300,easing:"linear"},enter:{duration:300,easing:"linear"},exit:{duration:300,easing:"linear"},disappear:{duration:500,easing:"cubicIn"},state:{duration:300,easing:"linear"}},vU={appear:{type:"scaleIn"},enter:{type:"scaleIn"},exit:{type:"scaleOut"}},vK={appear:{type:"fadeIn"},enter:{type:"fadeIn"},exit:{type:"fadeOut"}},vX=()=>{h9.registerAnimation("scaleInOut",()=>vU)},vY=()=>{h9.registerAnimation("fadeInOut",()=>vK)},v$=()=>{h9.registerAnimation("cartesianGroupClip",t=>({appear:{custom:yN,customParameters:(e,i)=>({animationType:"in",group:i,direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()})}}))},vq=(t,e)=>({appear:function(t,e){switch(e){case"grow":return vj(t);case"fadeIn":return vN;default:return vZ(t)}}(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},update:[{type:"update",options:{excludeChannels:["points","defined","segments"]}},{channel:["points","segments"],custom:yG,duration:vV.update.duration,easing:vV.update.easing,customParameters:{clipRangeByDimension:"horizontal"===t.direction?"y":"x"}}]}),vJ=()=>{h9.registerAnimation("line",vq)},vQ=()=>{h9.registerAnimation("area",vq)},v0=()=>{yv.registerBuiltInAnimate("scaleIn",yV),yv.registerBuiltInAnimate("scaleOut",yU),yv.registerBuiltInAnimate("fadeIn",yY),yv.registerBuiltInAnimate("fadeOut",y$),yv.registerBuiltInAnimate("moveIn",y0),yv.registerBuiltInAnimate("moveOut",y1),yv.registerBuiltInAnimate("rotateIn",y4),yv.registerBuiltInAnimate("rotateOut",y6),yv.registerBuiltInAnimate("update",y7),yv.registerBuiltInAnimate("state",y8),yv.registerBuiltInAnimate("fromTo",y9)},v1=()=>{yv.registerBuiltInAnimate("growHeightIn",ve),yv.registerBuiltInAnimate("growHeightOut",vi),yv.registerBuiltInAnimate("growWidthIn",vn),yv.registerBuiltInAnimate("growWidthOut",vl),yv.registerBuiltInAnimate("growCenterIn",vo),yv.registerBuiltInAnimate("growCenterOut",vh)},v2=()=>{yv.registerBuiltInAnimate("growRadiusIn",vm),yv.registerBuiltInAnimate("growRadiusOut",vy),yv.registerBuiltInAnimate("growAngleIn",vS),yv.registerBuiltInAnimate("growAngleOut",vA)},v3=()=>{yv.registerBuiltInAnimate("growPointsIn",vR),yv.registerBuiltInAnimate("growPointsOut",vP),yv.registerBuiltInAnimate("growPointsXIn",vE),yv.registerBuiltInAnimate("growPointsXOut",vL),yv.registerBuiltInAnimate("growPointsYIn",vH),yv.registerBuiltInAnimate("growPointsYOut",vD),yv.registerBuiltInAnimate("clipIn",vz),yv.registerBuiltInAnimate("clipOut",vW)},v5=()=>{yv.registerBuiltInAnimate("growPointsOut",vP)},v4=()=>{yv.registerBuiltInAnimate(uI,vG)},v6=()=>{yL(),v0(),v4()},v7=()=>{h9.registerStageEventPlugin("drag",yF)},v8=()=>{h9.registerStageEventPlugin("gesture",yz)},v9=t=>{let e=(0,a1.IX)(t),i=[],r=[];return e.forEach(t=>{"empty"===t?i.push("view"):(0,nI.Z)(t)&&"none"!==t?t.includes("view:")?(r.push(t.replace("view:","")),i.push("view")):(r.push(t),i.push("self")):(0,n4.Z)(t)&&i.push("timeout")}),{eventNames:r,resetType:i}},bt=(t,e)=>{if(!e||!t)return null;let i={};return t.forEach(t=>{let r=t.stateStyle;r&&e.forEach(e=>{e&&r[e]&&(i[e]||(i[e]=[]),i[e].push(t.id))})}),i},be=(t,e)=>{if(!e||!e.length)return[];let i=[];return t.markIds?e.filter(e=>{t.markIds.includes(e.getProductId())&&i.push(e)}):t.markNames?e.forEach(e=>{t.markNames.includes(e.name)&&i.push(e)}):e.forEach(t=>{i.push(t)}),i},bi=t=>t.filterField?e=>{var i;return null==(i=dM(e))?void 0:i[t.filterField]}:e=>e.context[t.filterType],br={highlightState:td.STATE_HIGHLIGHT,blurState:td.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"};class bn{constructor(t){this._markSet=new pl,this.options=t,t.marks&&t.marks.length&&t.marks.forEach(t=>{this.registerMark(t)})}getMarks(){return this._markSet.getMarks()}getMarksByState(t){if(this._markIdByState&&this._markSet){let e=this._markIdByState[t];return e?this.getMarks().filter(t=>t&&e.includes(t.id)):[]}return[]}registerMark(t){(0,rD.Z)(t)?t.forEach(t=>{this._markSet.addMark(t)}):this._markSet.addMark(t)}updateMarkIdByState(t){this._markIdByState=bt(this.getMarks(),t)}getMarkIdByState(){var t;return null!=(t=this._markIdByState)?t:{}}isGraphicInStateMark(t,e){var i;let r=this.getMarkIdByState();return r&&r[e]&&r[e].includes(null==(i=t.context)?void 0:i.markId)}isGraphicInMark(t){var e;return!!this._markSet.getMarkInId(null==(e=t.context)?void 0:e.markId)}getStartState(){return null}getResetState(){return null}init(){let t=this.getEvents();t&&this.options.event&&t.forEach(t=>{t.type&&t.handler&&((0,rD.Z)(t.type)?t.type.forEach(e=>{e&&"none"!==e&&this.options.event.on(e,t.handler)}):"none"!==t.type&&this.options.event.on(t.type,t.handler))})}release(){let t=this.getEvents();t&&this.options.event&&(null!=t?t:[]).forEach(t=>{t.type&&t.handler&&((0,rD.Z)(t.type)?t.type.forEach(e=>{e&&"none"!==e&&this.options.event.on(e,t.handler)}):"none"!==t.type&&this.options.event.off(t.type,t.handler))})}start(t){}reset(t){}dispatchEvent(t,e){this.options.event&&(this.options.event.emit(`${this.type}:${t}`,e),"start"===t&&this.options.onStart?this.options.onStart(e):"reset"===t&&this.options.onReset?this.options.onReset(e):"update"===t&&this.options.onUpdate?this.options.onUpdate(e):"end"===t&&this.options.onEnd&&this.options.onEnd(e))}}let bl={highlightState:td.STATE_HIGHLIGHT,blurState:td.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"};class bs extends bn{constructor(t){super(t),this.type="element-highlight",this.resetAll=()=>{let{highlightState:t,blurState:e,interaction:i}=this.options;this._lastGraphic&&(i.clearAllStatesOfTrigger(this,t,e),this.dispatchEvent("reset",{graphics:[this._lastGraphic],options:this.options}),this._lastGraphic=null,i.setStatedGraphics(this,[]))},this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{let{interaction:e}=this.options,i=e.getStatedGraphics(this);if(!i||!i.length)return;let r=t.item,n=r&&this._markSet.getMarkInId(r.context.markId);(this._resetType.includes("view")&&!n||this._resetType.includes("self")&&n)&&this.resetAll()},this.options=Object.assign({},bl,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){let t=this.options.triggerOff,e=[{type:this.options.trigger,handler:this.handleStart}],i=t;return(0,nI.Z)(t)&&t.includes("view:")?(i=t.replace("view:",""),this._resetType="view"):this._resetType="self",e.push({type:i,handler:this.handleReset}),e}start(t){if(t&&this._markSet.getMarkInId(t.context.markId)){let{highlightState:e,blurState:i,interaction:r}=this.options;if(this._lastGraphic===t)return;let n=r.updateStates(this,[t],r.getStatedGraphics(this),e,i);r.setStatedGraphics(this,n),this._lastGraphic=t,this.dispatchEvent("start",{graphics:n,options:this.options})}else this._lastGraphic&&"view"===this._resetType&&this.resetAll()}reset(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}bs.type="element-highlight",bs.defaultOptions=bl;let ba=()=>{h9.registerInteractionTrigger(bs.type,bs)},bo={state:td.STATE_SELECTED,trigger:"click"};class bh extends bn{constructor(t){super(t),this.type="element-select",this._resetType=[],this.resetAll=()=>{let{state:t,reverseState:e,interaction:i}=this.options,r=i.getStatedGraphics(this);r&&r.length&&(i.clearAllStatesOfTrigger(this,t,e),this.dispatchEvent("reset",{graphics:r,options:this.options}),i.setStatedGraphics(this,[]))},this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{let{interaction:e}=this.options,i=e.getStatedGraphics(this);if(!i||!i.length)return;let r=t.item,n=r&&this._markSet.getMarkInId(r.context.markId);(this._resetType.includes("view")&&!n||this._resetType.includes("self")&&n)&&this.resetAll()},this.options=Object.assign({},bo,t),this.updateMarkIdByState([this.options.state,this.options.reverseState])}getStartState(){return this.options.state}getResetState(){return this.options.reverseState}getEvents(){let t=this.options.triggerOff,e=this.options.trigger,i=[{type:e,handler:this.handleStart}],{eventNames:r,resetType:n}=v9(t);return r.forEach(t=>{t&&((0,rD.Z)(e)?!e.includes(t):t!==e)&&i.push({type:t,handler:this.handleReset})}),this._resetType=n,i}start(t){let{state:e,reverseState:i,isMultiple:r,interaction:n}=this.options,l=n.getStatedGraphics(this);if(t&&this._markSet.getMarkInId(t.context.markId))if(t.hasState(e)){if(this._resetType.includes("self")){let r=l&&l.filter(e=>e!==t);r&&r.length?n.setStatedGraphics(this,n.updateStates(this,r,l,e,i)):this.resetAll()}}else{this._timer&&clearTimeout(this._timer),t.addState(e,!0);let s=this.options.interaction.updateStates(this,r&&l?[...l,t]:[t],l,e,i);n.setStatedGraphics(this,s),this.dispatchEvent("start",{graphics:s,options:this.options}),this._resetType.includes("timeout")&&(this._timer=setTimeout(()=>{this.resetAll()},this.options.triggerOff))}else this._resetType.includes("view")&&l&&l.length&&this.resetAll()}reset(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.state,this.options.reverseState]):this.resetAll()}}bh.type="element-select",bh.defaultOptions=bo;let bd=()=>{h9.registerInteractionTrigger(bh.type,bh)};class bu extends yo{constructor(t){super(),this.globalInstance=t}onInit(){this._plugins.forEach(t=>{t.onInit&&t.onInit(this)})}releaseAll(){super.releaseAll(),this.globalInstance=null}}var bc=function(t,e,i,r){return new(i||(i=Promise))(function(n,l){function s(t){try{o(r.next(t))}catch(t){l(t)}}function a(t){try{o(r.throw(t))}catch(t){l(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(s,a)}o((r=r.apply(t,e||[])).next())})},bp=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class bg{static useRegisters(t){t.forEach(t=>{"function"==typeof t?t():console.error("Invalid function:",t)})}static useChart(t){t.forEach(t=>h9.registerChart(t.type,t))}static useSeries(t){t.forEach(t=>h9.registerSeries(t.type,t))}static useComponent(t){t.forEach(t=>h9.registerComponent(t.type,t))}static useMark(t){t.forEach(t=>{var e;return h9.registerMark(null!=(e=t.constructorType)?e:t.type,t)})}static useLayout(t){t.forEach(t=>h9.registerLayout(t.type,t))}static registerDataSetTransform(t,e){h9.registerTransform(t,e)}static registerFunction(t,e){t&&e&&g7.instance().registerFunction(t,e)}static unregisterFunction(t){t&&g7.instance().unregisterFunction(t)}static getFunction(t){return t?g7.instance().getFunction(t):null}static getFunctionList(){return g7.instance().getFunctionNameList()}static registerMap(t,e,i){let r=h9.getImplementInKey("registerMap");r&&r(t,e,i)}static unregisterMap(t){let e=h9.getImplementInKey("unregisterMap");e&&e(t)}static getMap(t){return dO.get(t)}static registerSVG(t,e,i){let r=h9.getImplementInKey("registerSVG");r&&r(t,e,i)}static unregisterSVG(t){let e=h9.getImplementInKey("unregisterSVG");e&&e(t)}static hideTooltip(t=[]){df.forEach(t=>{var e;return null==(e=null==t?void 0:t.hideTooltip)?void 0:e.call(t)},t)}static getLogger(){return iR.Y.getInstance()}getSpec(){return this._spec}getSpecInfo(){return this._specInfo}get event(){return this._event}getDataSet(){return this._dataSet}constructor(t,e){var i,r,n,l,s,a,o,h,d;this.id=hm(),this._userEvents=[],this._autoSize=!0,this._option={mode:oJ["desktop-browser"],onError:t=>{throw Error(t)},optimize:{disableCheckGraphicWidthOutRange:!0}},this._observer=null,this._context={},this._renderState=tl.render,this._disableDimensionHoverEvent=!1,this._doResize=()=>{let{width:t,height:e}=this.getCurrentSize();this._currentSize.width===t&&this._currentSize.height===e||(this._currentSize={width:t,height:e},this.resizeSync(t,e))},this._renderSync=(t={})=>{var e;return this._beforeRender(t)&&(null==(e=this._compiler)||e.render(t.morphConfig),this._updateAnimateState(!1),this._afterRender()),this},this._updateSpec=(t,e=!1,i)=>{var r;this._reSetRenderState();let n=this._spec,l={changeBackground:!1,reTransformSpec:!1,change:!1,reMake:!1,reCompile:!1,reSize:!1,changeTheme:!1};if(!this._setNewSpec(t,e))return;if((0,uL.X)(n.theme,this._spec.theme)?(0,uL.X)(this._spec.background,n.background)||(l.reMake=!0,l.changeBackground=!0):l.changeTheme=!0,l.reSize=this._shouldChartResize(n),this._spec.type!==n.type)return null==(r=this._compiler)||r.updateLayoutTag(),l.reMake=!0,l.reTransformSpec=!0,l.change=!0,l.changeTheme=!0,l;this._initChartSpec(this._spec,"updateSpec");let s=pt(this._chart.updateSpec(this._spec),l);return i?Object.assign(Object.assign({},s),i):s},this.getTheme=(...t)=>{if(!this._currentTheme||!t||!t.length)return;this._cachedProcessedTheme||(this._cachedProcessedTheme={});let e=t.join(".");if(this._cachedProcessedTheme[e])return this._cachedProcessedTheme[e];let i=this._currentTheme;return t.forEach((e,r)=>{if(1!==r||"series"!==t[0]&&"component"!==t[0])i=null==i?void 0:i[e];else{let r="series"===t[0]?h9.getSeriesBuiltInTheme(e):h9.getComponentBuiltInTheme(e);i=i?h5({},r,i[e]):r}r===t.length-1&&(0,aw.Z)(i)&&(i=function t(e,i,r){if(!e)return e;i||(i=e.colorScheme),r||(r=e.token);let n={};return Object.keys(e).forEach(l=>{let s=e[l];ya.includes(l)?n[l]=s:(0,hc.Z)(s)?hQ(s)?n[l]=hJ(s,i):ys(s)?n[l]=yl(r,s):n[l]=t(s,i,r):n[l]=s}),n}({[e]:i},this._currentTheme.colorScheme,this._currentTheme.token)[e])}),this._cachedProcessedTheme[e]=i,i},function t(e,i=!1){if(null===e||"object"!=typeof e)return e;for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(void 0===e[r]){delete e[r];continue}i&&t(e[r],i)}}(e),this._option=Object.assign(Object.assign({},this._option),e),(null==e?void 0:e.optimize)&&(this._option.optimize=Object.assign(Object.assign({},this._option.optimize),e.optimize)),this._onError=null==(i=this._option)?void 0:i.onError;let u=this._option,{dom:c,renderCanvas:p,mode:g,stage:f,poptip:m}=u,y=bp(u,["dom","renderCanvas","mode","stage","poptip"]),v=hI(g);if(v?m7():"node"===g&&yt(),v&&c&&(this._container=(0,nI.Z)(c)?hd.getElementById(c):c),p&&(this._canvas=p),f&&(this._stage=f),"node"!==g&&!this._container&&!this._canvas&&!this._stage)return void(null==(r=this._option)||r.onError("please specify container or renderCanvas!"));this._viewBox=this._option.viewBox,this._currentThemeName=dm.getCurrentThemeName(),this._setNewSpec(t),this._updateCurrentTheme(),this._currentSize=this.getCurrentSize();let b=[];!1!==m&&b.push("poptipForText"),"sankey"===t.type&&b.push("scrollbar");let _=new iR.Y(null!=(n=this._option.logLevel)?n:iR.h.Error);iR.Y.setInstance(_),(null==(l=this._option)?void 0:l.onError)&&_.addErrorHandler((...t)=>{var e,i;null==(i=null==(e=this._option)?void 0:e.onError)||i.call(e,...t)}),this._compiler=new uE({dom:null!=(s=this._container)?s:"none",canvas:p},Object.assign(Object.assign({mode:this._option.mode,stage:f,pluginList:b},y),{background:this._getBackground(),onError:this._onError})),this._compiler.setSize(this._currentSize.width,this._currentSize.height),this._eventDispatcher=new dP(this,this._compiler),this._event=new dv(this._eventDispatcher,g),this._compiler.initView(),this._compiler.updateLayoutTag(),this._setFontFamilyTheme(this.getTheme("fontFamily")),this._initDataSet(this._option.dataSet),this._autoSize=!!v&&(null==(o=null!=(a=t.autoFit)?a:this._option.autoFit)||o),this._bindResizeEvent(),this._bindViewEvent(),this._initChartPlugin(),df.registerInstance(this),null==(d=null==(h=this._option.performanceHook)?void 0:h.afterCreateVChart)||d.call(h,this)}_setNewSpec(t,e){return!!t&&((0,nI.Z)(t)&&(t=JSON.parse(t)),e&&this._originalSpec&&(t=h5({},this._originalSpec,t)),this._originalSpec=t,this._spec=this._getSpecFromOriginalSpec(),!0)}_getSpecFromOriginalSpec(){var t;let e=hp(this._originalSpec);return e.data=null!=(t=e.data)?t:[],e}_initChartSpec(t,e){var i,r;bg.getFunctionList()&&bg.getFunctionList().length&&(t=hg(t,bg)),this._spec=t,this._chartSpecTransformer||(this._chartSpecTransformer=h9.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),null==(i=this._chartSpecTransformer)||i.transformSpec(this._spec),this._chartPluginApply("onAfterChartSpecTransform",this._spec,e),this._specInfo=null==(r=this._chartSpecTransformer)?void 0:r.transformModelSpec(this._spec),this._chartPluginApply("onAfterModelSpecTransform",this._spec,this._specInfo,e)}_updateSpecInfo(){var t;this._chartSpecTransformer||(this._chartSpecTransformer=h9.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),this._specInfo=null==(t=this._chartSpecTransformer)?void 0:t.createSpecInfo(this._spec)}_initChart(t){var e,i,r;if(!this._compiler)return void(null==(e=this._option)||e.onError("compiler is not initialized"));if(this._chart)return void(null==(i=this._option)||i.onError("chart is already initialized"));let n=h9.createChart(t.type,t,this._getChartOption(t.type));n?(this._chart=n,this._chart.setCanvasRect(this._currentSize.width,this._currentSize.height),this._chart.created(this._chartSpecTransformer),this._chart.init(),this._event.emit(J.initialized,{chart:n,vchart:this})):null==(r=this._option)||r.onError("init chart fail")}_releaseData(){this._dataSet&&(this._dataSet.dataViewMap={},this._dataSet=null)}_bindViewEvent(){var t,e;this._compiler&&(null==(e=null==(t=this._compiler.getStage())?void 0:t.getTimeline())||e.on("animationEnd",()=>{this._event.emit(J.animationFinished,{chart:this._chart,vchart:this})}))}_bindResizeEvent(){var t,e;if(this._autoSize){if(this._onResize=(0,dw.Z)(this._doResize,null!=(t=this._option.resizeDelay)?t:100),this._container){let t=window.ResizeObserver;t&&(this._observer=new t(this._onResize),null==(e=this._observer)||e.observe(this._container))}window.addEventListener("resize",this._onResize)}}_unBindResizeEvent(){this._autoSize&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))}getCurrentSize(){var t,e,i,r;return c9(this._spec,{container:this._container,canvas:this._canvas,mode:this._getMode(),modeParams:this._option.modeParams},{width:null!=(e=null==(t=this._currentSize)?void 0:t.width)?e:ut,height:null!=(r=null==(i=this._currentSize)?void 0:i.height)?r:ue})}_initDataSet(t){for(let e in this._dataSet=t instanceof eY.q?t:new eY.q,dF(this._dataSet,"dataview",e$.i),dF(this._dataSet,"array",S),dL(this._dataSet,"copyDataView",dZ),h9.transforms)dL(this._dataSet,e,h9.transforms[e]);for(let t in h9.dataParser)dF(this._dataSet,t,h9.dataParser[t])}updateCustomConfigAndRerender(t,e,i={}){if(!this._isReleased&&t)return(0,nz.Z)(t)&&(t=t()),t.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._reCompile(t),e?this._renderSync(i):this._renderAsync(i)}_updateCustomConfigAndRecompile(t,e={}){return!!t&&(this._reCompile(t),this._beforeRender(e))}_reCompile(t,e){var i,r,n,l,s,a,o;if(t.reMake&&(this._releaseData(),this._initDataSet(),null==(i=this._chart)||i.release(),this._chart=null),t.reTransformSpec&&(this._chartSpecTransformer=null),t.changeTheme?(this._setCurrentTheme(),this._setFontFamilyTheme(this.getTheme("fontFamily"))):t.changeBackground&&(null==(r=this._compiler)||r.setBackground(this._getBackground())),t.reMake?(null==(n=this._compiler)||n.releaseGrammar(),this._userEvents.forEach(t=>{var e;return null==(e=this._event)?void 0:e.on(t.eType,t.query,t.handler)})):t.reCompile&&(null==(l=this._compiler)||l.clear({chart:this._chart,vChart:this}),null==(s=this._compiler)||s.compile({chart:this._chart,vChart:this})),t.reSize){let{width:t,height:e}=this.getCurrentSize();this._currentSize={width:t,height:e},null==(a=this._chart)||a.onResize(t,e,!1),null==(o=this._compiler)||o.resize(t,e,!1)}}_beforeRender(t={}){var e,i,r,n,l,s,a,o;if(this._isReleased)return!1;if(this._chart)return!0;let{transformSpec:h,actionSource:d}=t;return h&&this._initChartSpec(this._spec,"render"),this._chartPluginApply("onBeforeInitChart",this._spec,d),null==(i=null==(e=this._option.performanceHook)?void 0:e.beforeInitializeChart)||i.call(e,this),this._initChart(this._spec),null==(n=null==(r=this._option.performanceHook)?void 0:r.afterInitializeChart)||n.call(r,this),!(!this._chart||!this._compiler)&&(this._chartPluginApply("onAfterInitChart",this._spec,d),null==(s=null==(l=this._option.performanceHook)?void 0:l.beforeCompileToVGrammar)||s.call(l,this),this._compiler.compile({chart:this._chart,vChart:this},t),null==(o=null==(a=this._option.performanceHook)?void 0:a.afterCompileToVGrammar)||o.call(a,this),!0)}_afterRender(){return!this._isReleased&&(this._event.emit(J.rendered,{chart:this._chart,vchart:this}),!0)}renderSync(t){return this._renderSync({morphConfig:t,transformSpec:!0,actionSource:"render"})}renderAsync(t){return bc(this,void 0,void 0,function*(){return this._renderAsync({morphConfig:t,transformSpec:!0,actionSource:"render"})})}_renderAsync(t={}){return bc(this,void 0,void 0,function*(){return this._renderSync(t)})}_updateAnimateState(t){var e,i;if(this.isAnimationEnable()){let r=e=>{var i;let r=null==(i=e.context)?void 0:i.diffState;return t?"exit"===r?tr.none:tr.appear:r};null==(e=this._chart)||e.getAllRegions().forEach(t=>{t.updateAnimateStateCallback(r)}),null==(i=this._chart)||i.getAllComponents().forEach(t=>{t.updateAnimateStateCallback(r)})}}release(){var t,e,i,r;(null==(t=this._onResize)?void 0:t.cancel)&&this._onResize.cancel(),this._chartPluginApply("releaseAll"),this._chartPlugin=null,this._chartSpecTransformer=null,null==(e=this._chart)||e.release(),null==(i=this._eventDispatcher)||i.release(),null==(r=this._compiler)||r.release(),this._unBindResizeEvent(),this._releaseData(),this._onError=null,this._onResize=null,this._container=null,this._currentTheme=null,this._cachedProcessedTheme=null,this._option=null,this._chart=null,this._compiler=null,this._spec=null,this._specInfo=null,this._originalSpec=null,this._userEvents=null,this._event=null,this._eventDispatcher=null,this._isReleased=!0,df.unregisterInstance(this)}updateData(t,e,i,r){return bc(this,void 0,void 0,function*(){return this.updateDataSync(t,e,i,r)})}_updateDataById(t,e,i){let r=this._spec.data.find(e=>e.name===t||e.id===t);r?r.id===t?r.values=e:r.name===t&&r.parse(e,i):(0,rD.Z)(e)?this._spec.data.push({id:t,values:e}):this._spec.data.push(e)}updateDataInBatches(t){return bc(this,void 0,void 0,function*(){return this._chart?(this._chart.updateFullData(t.map(({id:t,data:e,options:i})=>({id:t,values:e,parser:i}))),this._chart.updateGlobalScaleDomain(),this._compiler.render()):(this._spec.data=(0,a1.IX)(this._spec.data),t.forEach(({id:t,data:e,options:i})=>{this._updateDataById(t,e,i)})),this})}updateDataSync(t,e,i,r){return this._reSetRenderState(),(0,nB.Z)(this._dataSet)||(this._chart?(this._chart.updateData(t,e,!0,i),(null==r?void 0:r.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render()):(this._spec.data=(0,a1.IX)(this._spec.data),this._updateDataById(t,e,i))),this}updateFullDataSync(t,e=!0,i){if(this._reSetRenderState(),this._chart)return this._chart.updateFullData(t),e&&((null==i?void 0:i.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render()),this;let r=(0,a1.IX)(this._spec.data);return(0,a1.IX)(t).forEach(t=>{let{id:e,values:i,parser:n,fields:l}=t,s=r.find(t=>t.name===e);if(s)s instanceof eq.V?(s.setFields((0,dz.Z)(l)),s.parse(i,(0,dz.Z)(n))):(s.values=i,(0,aw.Z)(n)&&(s.parser=n),(0,aw.Z)(l)&&(s.fields=l));else{let e=dj(t,this._dataSet,r);(0,rD.Z)(this._spec.data)&&this._spec.data.push(e)}}),this}updateFullData(t,e=!0){return bc(this,void 0,void 0,function*(){return this.updateFullDataSync(t,e)})}updateSpec(t,e=!1,i,r){return bc(this,void 0,void 0,function*(){let n=this._updateSpec(t,e,r);return n&&(yield this.updateCustomConfigAndRerender(n,!1,{morphConfig:i,transformSpec:n.reTransformSpec,actionSource:"updateSpec"})),this})}updateSpecSync(t,e=!1,i,r){let n=this._updateSpec(t,e,r);return n&&this.updateCustomConfigAndRerender(n,!0,{morphConfig:i,transformSpec:n.reTransformSpec,actionSource:"updateSpec"}),this}updateSpecAndRecompile(t,e=!1,i={}){let r=this._updateSpec(t,e);return this._updateCustomConfigAndRecompile(r,Object.assign({actionSource:"updateSpecAndRecompile"},i))}updateModelSpec(t,e,i=!1,r){return bc(this,void 0,void 0,function*(){return this.updateModelSpecSync(t,e,i,r)})}updateModelSpecSync(t,e,i=!1,r){var n,l;if(!e||!this._spec)return this;if((0,nI.Z)(e)&&(e=JSON.parse(e)),(0,nz.Z)(t)||(n=this._spec,l=e,Object.keys(n).forEach(e=>{if((0,nF.Z)(t))t.type===e&&((0,rD.Z)(n[e])?n[e].length>=t.index&&(n[e][t.index]=i?h5({},n[e][t.index],l):l):n[e]=i?h5({},n[e],l):l);else if((0,rD.Z)(n[e])){let r=n[e].findIndex(e=>e.id===t);r>=0&&(n[e][r]=i?h5({},n[e][r],l):l)}else n.id===t&&(n[e]=i?h5({},n[e],l):l)})),this._chart){let n=this._chart.getModelInFilter(t);if(n)return this._updateModelSpec(n,e,!0,i,r)}return this}_updateModelSpec(t,e,i=!1,r=!1,n){r&&(e=h5({},t.getSpec(),e));let l=t.updateSpec(e);return t.reInit(e),(l.change||l.reCompile||l.reMake||l.reSize||l.reRender)&&this._chart.reDataFlow(),this.updateCustomConfigAndRerender(l,i,{morphConfig:n,transformSpec:!1,actionSource:"updateModelSpec"})}resize(t,e){return bc(this,void 0,void 0,function*(){return this.resizeSync(t,e)})}resizeSync(t,e){var i,r;return this._beforeResize(t,e)?(null==(r=(i=this._compiler).resize)||r.call(i,t,e),this._afterResize()):this}_beforeResize(t,e){var i,r,n,l;if(!this._chart||!this._compiler)return!1;let s=this._chart.getCanvasRect();return(!s||s.width!==t||s.height!==e)&&(this._chartPluginApply("onBeforeResize",t,e),null==(r=null==(i=this._option.performanceHook)?void 0:i.beforeResizeWithUpdate)||r.call(i,this),this._chart.onResize(t,e,!1),null==(l=null==(n=this._option.performanceHook)?void 0:n.afterResizeWithUpdate)||l.call(n,this),!0)}_afterResize(){return this._isReleased||this._event.emit(J.afterResize,{chart:this._chart}),this}updateViewBox(t,e=!0,i=!0){return this._chart&&this._compiler&&(this._viewBox=t,this._chart.updateViewBox(t,i),i&&(this._compiler.render(),this._chart.onEvaluateEnd()),this._compiler.updateViewBox(t,e)),this}on(t,e,i){var r;this._userEvents&&(this._userEvents.push({eType:t,query:"function"==typeof e?null:e,handler:"function"==typeof e?e:i}),null==(r=this._event)||r.on(t,e,i))}off(t,e){var i;if(this._userEvents&&0!==this._userEvents.length)if(e){let r=this._userEvents.findIndex(i=>i.eType===t&&i.handler===e);r>=0&&(this._userEvents.splice(r,1),null==(i=this._event)||i.off(t,e))}else this._userEvents.forEach(e=>{var i;e.eType===t&&(null==(i=this._event)||i.off(t,e.handler))}),this._userEvents=this._userEvents.filter(e=>e.eType!==t)}updateState(t,e){this._chart&&this._chart.updateState(t,e)}setSelected(t,e,i){this._chart&&this._chart.setSelected(t,e,i)}setHovered(t,e,i){this._chart&&this._chart.setHovered(t,e,i)}clearState(t){this._chart&&this._chart.clearState(t)}clearAllStates(){this._chart&&this._chart.clearAllStates()}clearSelected(){this._chart&&this._chart.clearSelected()}clearHovered(){this._chart&&this._chart.clearHovered()}_updateCurrentTheme(t){var e,i,r,n;let l,s=this._option.theme,a=null==(e=this._spec)?void 0:e.theme,o=null==(i=this._spec)?void 0:i.type;t&&(this._currentThemeName=t);let h=(t,e)=>{var i;return(null==(i=e.chart)?void 0:i[t])&&(e=dt({},e,e.chart[t])),e};if((0,uF.Z)(s)&&(0,uF.Z)(a))l=dy(this._currentThemeName),this._currentTheme=h(o,l);else if((0,nI.Z)(s)&&(!a||(0,nI.Z)(a))||(0,nI.Z)(a)&&(!s||(0,nI.Z)(s))){let t=dt({},dy(this._currentThemeName),dy(s),dy(a));this._currentTheme=h(o,t)}else{let t=dt({},dy(this._currentThemeName),dy(s),dy(a));this._currentTheme=h(o,t)}this._cachedProcessedTheme=null,n=this.getTheme("component","poptip"),(0,h3.Z)(uH.poptip,uO,n),null==(r=this._compiler)||r.setBackground(this._getBackground())}_shouldChartResize(t){var e,i;let r=!1;(0,nB.Z)(this._spec.width)?(0,nB.Z)(t.width)||(this._spec.width=t.width):this._spec.width!==t.width&&(r=!0),(0,nB.Z)(this._spec.height)?(0,nB.Z)(t.height)||(this._spec.height=t.height):this._spec.height!==t.height&&(r=!0);let n=this._autoSize;return this._autoSize=!!hI(this._option.mode)&&(null==(i=null!=(e=this._spec.autoFit)?e:this._option.autoFit)||i),this._autoSize!==n&&(r=!0),r}_getBackground(){return("string"==typeof this._spec.background||(0,nF.Z)(this._spec.background)&&this._spec.background.gradient?this._spec.background:null)||this.getTheme("background")||this._option.background}getCurrentTheme(){return dy(this._currentThemeName)}getCurrentThemeName(){return this._currentThemeName}setCurrentTheme(t){return bc(this,void 0,void 0,function*(){return this.setCurrentThemeSync(t)})}setCurrentThemeSync(t){if(!dm.themeExist(t))return this;let e=this._setCurrentTheme(t);return this._setFontFamilyTheme(this.getTheme("fontFamily")),this.updateCustomConfigAndRerender(e,!0,{transformSpec:!1,actionSource:"setCurrentTheme"}),this}_setCurrentTheme(t){var e;return this._updateCurrentTheme(t),this._initChartSpec(this._getSpecFromOriginalSpec(),"setCurrentTheme"),null==(e=this._chart)||e.setCurrentTheme(),{change:!0,reMake:!1}}_setFontFamilyTheme(t){var e;t&&(null==(e=this.getStage())||e.setTheme({text:{fontFamily:t},richtext:{fontFamily:t}}))}_getTooltipComponent(){var t;return null==(t=this._chart)?void 0:t.getComponentsByType(oQ.tooltip)[0]}setTooltipHandler(t){var e,i;this._context.tooltipHandler=t;let r=this._getTooltipComponent();r&&(null==(i=null==(e=r.tooltipHandler)?void 0:e.release)||i.call(e),r.tooltipHandler=t)}getTooltipHandlerByUser(){var t;return null==(t=this._context)?void 0:t.tooltipHandler}getTooltipHandler(){let t=this._getTooltipComponent();return t?t.tooltipHandler:this._context.tooltipHandler}showTooltip(t,e){var i;let r=this._getTooltipComponent();return null!=(i=(0,aw.Z)(t)&&"none"!==(null==r?void 0:r.showTooltip(t,e)))&&i}hideTooltip(){var t;let e=this._getTooltipComponent();return null!=(t=null==e?void 0:e.hideTooltip())&&t}getLegendDataById(t){var e;let i=null==(e=this._chart)?void 0:e.getComponentByUserId(t);return i?i.getLegendData():[]}getLegendDataByIndex(t=0){var e;let i=null==(e=this._chart)?void 0:e.getComponentsByType(oQ.discreteLegend);return i&&i[t]?i[t].getLegendData():[]}getLegendSelectedDataById(t){var e;let i=null==(e=this._chart)?void 0:e.getComponentByUserId(t);return i?i.getSelectedData():[]}getLegendSelectedDataByIndex(t=0){var e;let i=null==(e=this._chart)?void 0:e.getComponentsByType(oQ.discreteLegend);return i&&i[t]?i[t].getSelectedData():[]}setLegendSelectedDataById(t,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentByUserId(t);r&&r.setSelectedData(e)}setLegendSelectedDataByIndex(t=0,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentsByType(oQ.discreteLegend);r&&r[t]&&r[t].setSelectedData(e)}getDataURL(){var t;return bc(this,void 0,void 0,function*(){let e=this.getStage();if(this._chart&&e){e.render();let t=this._chart.getCanvas();return yield function(t,e){var i,r,n,l,s;return r=this,n=void 0,l=void 0,s=function*(){if(!t)return"";try{if(void 0!==OffscreenCanvas&&t instanceof OffscreenCanvas)return new Promise(e=>{t.convertToBlob().then(t=>{let i=new FileReader;i.readAsDataURL(t),i.onload=()=>{e(i.result)}})})}catch(t){(null!=(i=null==e?void 0:e.onError)?i:hH)(`getCanvasDataURL error : ${t.toString()}`)}return t.toDataURL()},new(l||(l=Promise))(function(t,e){function i(t){try{o(s.next(t))}catch(t){e(t)}}function a(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof l?r:new l(function(t){t(r)})).then(i,a)}o((s=s.apply(r,n||[])).next())})}(t,{onError:this._onError})}return null==(t=this._option)||t.onError(ReferenceError("render is not defined")),null})}exportImg(t){var e,i;return bc(this,void 0,void 0,function*(){if(!hI(this._option.mode))return void(null==(e=this._option)||e.onError(TypeError("non-browser environment can not export img")));let r=yield this.getDataURL();r?function(t="vchart",e){let i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank"),i.setAttribute("download",`${t}.png`),i.dispatchEvent(new MouseEvent("click"))}(t,r):null==(i=this._option)||i.onError(ReferenceError("render is not defined"))})}exportCanvas(){var t;let e=this.getStage();if(this._chart&&e)return e.toCanvas();null==(t=this._option)||t.onError(ReferenceError("render is not defined"))}getImageBuffer(){var t,e;if("node"!==this._option.mode)return void(null==(t=this._option)||t.onError(TypeError("getImageBuffer() now only support node environment.")));let i=this.getStage();return i?(i.render(),i.window.getImageBuffer()):(null==(e=this._option)||e.onError(ReferenceError("render is not defined")),null)}setLayout(t){var e;this._option.layout=t,null==(e=this._chart)||e.setLayout(t)}reLayout(){var t;this._chart.resetLayoutItemTag(),null==(t=this._chart)||t.setLayoutTag(!0)}getCompiler(){return this._compiler}getChart(){return this._chart}getStage(){return this._compiler.getStage()}getCanvas(){var t;return null==(t=this._compiler)?void 0:t.getCanvas()}getContainer(){var t;let e;return(0,aw.Z)(this._container)?this._container:(e=(0,nI.Z)(this._canvas)?hd.getElementById(this._canvas):this._canvas,(0,aw.Z)(e)?e.parentElement:null==(t=this.getCanvas())?void 0:t.parentElement)}getComponents(){return this._chart.getAllComponents()}getScale(t){var e;let i=null==(e=this._chart)?void 0:e.getGlobalScale();return null==i?void 0:i.getScale(t)}setDimensionIndex(t,e={}){var i;return null==(i=this._chart)?void 0:i.setDimensionIndex(t,e)}disableDimensionHoverEvent(t){return void 0!==t&&(this._disableDimensionHoverEvent=t),this._disableDimensionHoverEvent}disableCrossHair(t=!0){this.getChart().getComponentsByKey("crosshair").forEach(e=>e.enable=!t)}disableTooltip(t=!0){this.getChart().getComponentsByKey("tooltip").forEach(e=>e.enable=!t)}showCrosshair(t){var e;null==(e=this._chart)||e.showCrosshair(t)}stopAnimation(){var t;null==(t=this.getStage())||t.stopAnimation(!0)}reRunNormalAnimation(){var t;null==(t=this.getStage())||t.reApplyAnimationState("normal",!0)}pauseAnimation(){var t;null==(t=this.getStage())||t.pauseAnimation(!0)}resumeAnimation(){var t;null==(t=this.getStage())||t.resumeAnimation(!0)}convertDatumToPosition(t,e={},i=!1,r){var n;let l;if(!this._chart||(0,uF.Z)(t))return null;let{seriesId:s,seriesIndex:a=0}=e;if((0,aw.Z)(s)?l=this._chart.getSeriesInUserId(s):(0,aw.Z)(a)&&(l=null==(n=this._chart.getSeriesInIndex([a]))?void 0:n[0]),l){let e,n=Object.keys(t),s=l.getViewData().latestData.find(e=>n.every(i=>e[i]==t[i])),a=l.getRegion().getLayoutStartPoint();return(e=s?l.dataToPosition(s,r):l.dataToPosition(t,r))?hT(e,a,i):null}return null}convertValueToPosition(t,e,i=!1){var r,n;let l;if(!this._chart||(0,nB.Z)(t)||(0,uF.Z)(e))return null;if(!(0,rD.Z)(t)){let n,{axisId:l,axisIndex:s}=e;if((0,aw.Z)(l)?n=this._chart.getComponentsByKey("axes").find(t=>t.userId===l):(0,aw.Z)(s)&&(n=null==(r=this._chart.getComponentsByKey("axes"))?void 0:r[s]),!n)return hO("Please check whether the `axisId` or `axisIndex` is set!"),null;let a=null==n?void 0:n.valueToPosition(t);if(i){let t=n.getLayoutStartPoint(),e=n.getOrient();return a+("bottom"===e||"top"===e?t.x:t.y)}return a}let{seriesId:s,seriesIndex:a}=e;return(0,aw.Z)(s)?l=this._chart.getSeriesInUserId(s):(0,aw.Z)(a)&&(l=null==(n=this._chart.getSeriesInIndex([a]))?void 0:n[0]),l?hT(l.valueToPosition(t[0],t[1]),l.getRegion().getLayoutStartPoint(),i):(hO("Please check whether the `seriesId` or `seriesIndex` is set!"),null)}getFunction(t){return g7.instance().getFunction(t)}registerFunction(t,e){t&&e&&g7.instance().registerFunction(t,e)}unregisterFunction(t){t&&g7.instance().unregisterFunction(t)}getFunctionList(){return g7.instance().getFunctionNameList()}setRuntimeSpec(t){this._spec=t,this._updateSpecInfo()}updateIndicatorDataById(t,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentByUserId(t);r&&r.updateDatum(e)}updateIndicatorDataByIndex(t=0,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentsByType(oQ.indicator);r&&r[t]&&r[t].updateDatum(e)}geoZoomByIndex(t=0,e,i){this._geoZoomByQuery({regionIndex:t},e,i)}geoZoomById(t,e,i){this._geoZoomByQuery({regionId:t},e,i)}_geoZoomByQuery(t,e,i){var r,n;let l=null==(r=this._chart)?void 0:r.getRegionsInQuerier(t)[0],s=null==(n=this._chart)?void 0:n.getComponentsByType(oQ.geoCoordinate),a=null==s?void 0:s.find(t=>{var e;return null==(e=t.getRegions())?void 0:e.includes(l)});a&&a.dispatchZoom(e,i)}_initChartPlugin(){let t=h9.getChartPlugins();t.length>0&&(this._chartPlugin=new yh(this),this._chartPlugin.load(t.map(t=>new t)),this._chartPluginApply("onInit",this._spec));let e=h9.getVChartPlugins();e.length>0&&(this._vChartPlugin=new bu(this),this._vChartPlugin.load(e.map(t=>new t)),this._vChartPlugin.onInit())}_chartPluginApply(t,...e){this._chartPlugin&&this._chartPlugin[t]&&this._chartPlugin[t].apply(this._chartPlugin,e)}_getMode(){return this._option.mode||oJ["desktop-browser"]}isAnimationEnable(){return"animation"in this._option?!!this._option.animation:!1!==this._spec.animation}_getChartOption(t){return{type:t,globalInstance:this,eventDispatcher:this._eventDispatcher,dataSet:this._dataSet,container:this._container,canvas:this._canvas,map:new Map,mode:this._getMode(),modeParams:this._option.modeParams,getCompiler:()=>this._compiler,viewBox:this._viewBox,getTheme:this.getTheme,getSpecInfo:()=>{var t;return null!=(t=this._specInfo)?t:{}},layout:this._option.layout,onError:this._onError,disableTriggerEvent:!0===this._option.disableTriggerEvent,componentShowContent:this._option.componentShowContent}}runDisappearAnimation(){this._renderState=tl.disappear,this.getStage().eventSystem.pauseTriggerEvent(),this.getStage().applyAnimationState(["disappear"],[{name:"disappear",animation:this._compiler.stateAnimationConfig.disappear}])}_reSetRenderState(){this._renderState=tl.render,this.getStage().eventSystem.resumeTriggerEvent()}}bg.InstanceManager=df,bg.ThemeManager=dm,bg.globalConfig={uniqueTooltip:!0},bg.Utils={measureText:g6},bg.vglobal=hd,h9.registerRegion("region",pm),h9.registerLayout("base",pA),gU(),v8(),ba(),bd(),dd(hN.name,hN);var bf=i(93651),bm=i(34276);let by=ng.Yt;function bv(t,e){let i=[];return t.forEach(t=>{let r=+t[e];(0,hy.Z)(r)&&i.push(r)}),0===i.length?null:(0,a1.iH)(i)}function bb(t,e){let i=[];return t.forEach(t=>{let r=+t[e];(0,hy.Z)(r)&&i.push(r)}),0===i.length?null:(0,a1.CE)(i)}function b_(t,e){return t.reduce((t,i)=>{let r=e?+i[e]:+i;return(0,hy.Z)(r)&&(t+=r),t},0)}function bC(t,e){let i=0,r=0;return t.forEach(t=>{let n=e?+t[e]:+t;(0,hy.Z)(n)&&(i+=n,r++)}),i/r}function bx(t,e){let i=bC(t,e);return t.length<=1?0:t.reduce((t,r)=>t+(e?+r[e]:r-i)**2,0)/(t.length-1)}function bw(t,e){let i=bS(t),r=bS(e),n=Math.asin((t.x*e.y-e.x*t.y)/i/r),l=Math.acos((t.x*e.x+t.y*e.y)/i/r);return n<0?-l:l}function bS(t,e={x:0,y:0}){return iN.HL.distancePP(t,e)}function bA(t){return(0,hy.Z)(t.x)&&(0,hy.Z)(t.y)}function bM(t,e){for(let i=0;i<e.length;i++){let r=e[i],n=function(t,e){return t.find(t=>t.key===e)}(t,r.key);n?n.operations=[...new Set(n.operations.concat(r.operations))]:t.push(r)}return t}function bT(t,e){var i;if(!t)return null!=e?e:null;let r=t.getFields();return r&&r[e]?null!=(i=r[e].alias)?i:e:null!=e?e:null}function bk(t,e,i){let r=t.getStackSort(),n={},l=null;return r&&(l={},t.getSeries().forEach(t=>{let e=t.getSeriesField();if(e){let i=t.getRawDataStatisticsByField(e);i.values&&(l[e]||(l[e]={lastIndex:0,sort:{}}),i.values.forEach((t,i)=>{t in l[e].sort||(l[e].sort[t]=l[e].lastIndex,l[e].lastIndex++)}))}})),t.getSeries().forEach(t=>{var r;let s=t.getStackData(),a=t.getStackValue(),o=t.getStackValueField(),h=!i||i(t);s&&o&&h&&(n[a]=null!=(r=n[a])?r:{groupField:s.groupField,nodes:{}},bF(t,s,n[a],o,e,l))}),r?bR(n,l):n}function bR(t,e){var i;for(let r in t)(null==(i=t[r].sortDatums)?void 0:i.length)?(t[r].sortDatums.sort((t,e)=>t.index-e.index),t[r].values=t[r].sortDatums.map(t=>t.datum)):bR(t[r].nodes,e);return t}function bP(t,e){if("values"in t&&t.values.length){let i=b_(t.values,e),r=bb(t.values,uu);t.values.forEach(t=>{t[ug]=i,t[uf]=r})}else for(let i in t.nodes)bP(t.nodes[i],e)}function bB(t,e){var i,r;if("values"in t&&t.values.length)(0,aw.Z)(null==(i=t.values[0])?void 0:i[ug])?t.total=null==(r=t.values[0])?void 0:r[ug]:t.total=b_(t.values,e);else{for(let i in t.nodes)bB(t.nodes[i],e);t.nodes&&(t.total=b_(Object.keys(t.nodes).map(e=>t.nodes[e]),"total"))}}function bI(t,e,i){var r;if(e.groupField&&e.nodes){let i=(null==(r=t.getRawDataStatisticsByField(e.groupField,!1))?void 0:r.values)||[],n={key:`${e.groupField}`,values:i.map(i=>{var r,n;let l,s=e.nodes[i];return{groupValue:i,value:l=t.bandWidthField&&null!=(n=null==(r=s.values.find(e=>(0,aw.Z)(e[t.bandWidthField])))?void 0:r[t.bandWidthField])?n:s.total,end:l}})};bL(n,!1,!0,!1,{key:"groupField",start:"start",end:"end",startPercent:"startPercent",endPercent:"endPercent"}),n.values.forEach(t=>{e.nodes[t.groupValue].mosaicData=t})}else if("values"in e&&e.values.length&&i&&i.length){let t=i.length,r=0,n=1,l=0,s=1;for(let e=0;e<t;e++)if(e%2==0){let t=n-r;n=r+i[e].endPercent*t,r+=i[e].startPercent*t}else{let t=s-l;s=l+i[e].endPercent*t,l+=i[e].startPercent*t}t%2==0?e.values.forEach(t=>{let e=n-r;t[uC]=r+e*t[uu],t[u_]=r+e*t[ud],t[ub]=s,t[uv]=l}):e.values.forEach(t=>{let e=s-l;t[ub]=l+e*t[uu],t[uv]=l+e*t[ud],t[uC]=n,t[u_]=r})}for(let r in e.nodes)bI(t,e.nodes[r],e.nodes[r].mosaicData?i?[...i,e.nodes[r].mosaicData]:[e.nodes[r].mosaicData]:null)}function bE(t){if(!t.values.length)return;let e=t.values[t.values.length-1][uh]/2;for(let i=0;i<t.values.length;i++)t.values[i][uc]=t.values[i][uo]-e,t.values[i][up]=t.values[i][uh]-e}function bL(t,e,i,r,n={key:ua,start:uo,end:uh,startPercent:ud,endPercent:uu,max:um,min:uy}){let l=r&&(0,aw.Z)(n.min),s=r&&(0,aw.Z)(n.max);if(t.values.length>0){let r=0,a=0,o=1,h=0,d=null,u=null,c=t.values.length;for(let i=0;i<c;i++){let o=t.values[e?c-1-i:i];(h=o[n.end])>=0?(o[n.start]=r,r+=o[n.end],o[n.end]=r):(o[n.start]=a,a+=o[n.end],o[n.end]=a),o[n.key]=t.key,s&&(delete o[n.max],(!u||o[n.end]>u[n.end])&&(u=o)),l&&(delete o[n.min],(!d||o[n.start]<d[n.start])&&(d=o))}if(s&&u&&(u[n.max]=!0),l&&d&&(d[n.min]=!0),i)for(let i=0;i<c;i++){let l=t.values[e?c-1-i:i],s=(h=l[n.end])>=0?r:a;o=h>=0?1:-1,l[n.startPercent]=0===s?0:Math.min(1,l[n.start]/s)*o,l[n.endPercent]=0===s?0:Math.min(1,l[n.end]/s)*o}}for(let l in t.nodes)bL(t.nodes[l],e,i,r,n)}function bF(t,e,i,r,n,l,s){var a;if("values"in e)if(n&&e.values.forEach(t=>t[uh]=function(t){if((0,hy.Z)(t))return t;let e=+t;return(0,hy.Z)(e)?e:0}(t[r])),i.series.push({s:t,values:e.values}),l){let r=t.getSeriesField();e.values.forEach(e=>{i.sortDatums.push({series:t,datum:e,index:r?l[r].sort[e[r]]:0})})}else i.values.push(...e.values);else for(let o in e.nodes){let h=s?`${s}_${o}`:o;i.nodes[o]||(i.nodes[o]={values:[],series:[],nodes:{},sortDatums:[],key:h},(0,aw.Z)(null==(a=e.nodes[o])?void 0:a.groupField)&&(i.nodes[o].groupField=e.nodes[o].groupField)),bF(t,e.nodes[o],i.nodes[o],r,n,l,h)}}let bO=(t,e)=>{let i=e.beforeCall();return t&&t.forEach((t,r)=>e.call(t,r,i)),i.keyMap&&(i.keyMap.clear(),i.keyMap=null),t};var bH=i(13339);function bD(t,e){return e("component",t)}function bz(t,e,i,r){if(t)return{formatFunc:t,args:[i,r]};let n=h9.getFormatter();return e&&n?{formatFunc:n,args:[i,r,e]}:{}}let bW=(t,e,i,r)=>{if((0,nB.Z)(t[e]))return;let n=(0,rD.Z)(t[e]),l=n?t[e]:[t[e]],s=[];return l.forEach((t,l)=>{t&&(!r||r(t))&&s.push({spec:t,specPath:n?[e,l]:[e],specInfoPath:["component",e,l],type:i})}),s},bZ=(t,e,i,r)=>{let n;if(n=(0,nz.Z)(t)?t(e,i):(0,hc.Z)(t)&&(0,aw.Z)(t.field)?(0,dx.Z)(e,t.field):t,r){let{formatFunc:i,args:l}=bz(void 0,r,t,e);i&&l&&(n=i(...l))}return n},bN=(t,e,i)=>(0,nB.Z)(t)?t:(0,nz.Z)(t)?t(e,i):t;var bj=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let bG=t=>{var e,i,r;if(!1===(null==t?void 0:t.visible))return[];let n={mark:!1!==(null==(e=null==t?void 0:t.mark)?void 0:e.visible),dimension:!1!==(null==(i=null==t?void 0:t.dimension)?void 0:i.visible),group:!1!==(null==(r=null==t?void 0:t.group)?void 0:r.visible)};return(0,aw.Z)(null==t?void 0:t.activeType)&&Object.keys(n).forEach(e=>{var i;n[e]=null==(i=null==t?void 0:t.activeType)?void 0:i.includes(e)}),Object.keys(n).filter(t=>n[t])},bV=(t,e)=>!e||!1!==e.visible&&(!e[t]||!1!==e[t].visible)&&!(e.activeType&&!((0,rD.Z)(e.activeType)?e.activeType.includes(t):e.activeType===t));function bU(t,e,i,r,n,l){let s=e=>{if(e){let s={datum:n},a=(0,nB.Z)(e.key)&&(0,nB.Z)(e.value)&&!(0,uF.Z)(e)?Object.assign(Object.assign(Object.assign({},r),i),e):Object.assign(Object.assign({},r),e),{key:o,keyFormatter:h,keyTimeFormat:d,keyTimeFormatMode:u,value:c,valueFormatter:p,valueTimeFormat:g,valueTimeFormatMode:f}=a,m=bj(a,["key","keyFormatter","keyTimeFormat","keyTimeFormatMode","value","valueFormatter","valueTimeFormat","valueTimeFormatMode"]);s.key=bX(bZ(o,n,l,h),d,u),s.value=bX(bZ(c,n,l,p),g,f),Object.keys(m).forEach(t=>{s[t]=bZ(a[t],n,l)}),!1!==s.visible&&((0,aw.Z)(s.key)||(0,aw.Z)(s.value))&&t.push(s)}};(0,rD.Z)(e)?e.forEach(t=>{s(t)}):s(e)}function bK(t,e,i,r,n,l,s){(0,nz.Z)(e)?bU(t,e(n,s),i,r,l,s):e&&bU(t,e,i,r,l,s)}let bX=(t,e,i)=>{if(!e&&!i)return"object"!=typeof t?null==t?void 0:t.toString():t;let r=bH.k.getInstance();return e=e||"%Y%m%d",("local"===(i=i||"local")?r.timeFormat:r.timeUTCFormat)(e,t)};class bY{constructor(t){this.activeTriggerSet={mark:new Set,group:new Set},this.ignoreTriggerSet={mark:new Set},this._getSeriesCacheInfo=()=>{var t,e,i;let{series:r}=this,n=r.getSeriesField();return{seriesFields:(0,aw.Z)(n)?(0,a1.IX)(n):null!=(t=r.getSeriesKeys())?t:[],dimensionFields:null!=(e=r.getDimensionField())?e:[],measureFields:null!=(i=r.getMeasureField())?i:[],type:r.type}},this._getDimensionData=t=>{let{dimensionFields:e}=this._seriesCacheInfo;return e[0]&&(null==t?void 0:t[e[0]])},this._getMeasureData=t=>{let{measureFields:e}=this._seriesCacheInfo;return e[0]&&(null==t?void 0:t[e[0]])},this._getSeriesFieldData=t=>{let{dimensionFields:e,seriesFields:i}=this._seriesCacheInfo;if((0,aw.Z)(i[0])&&(null==t?void 0:t[i[0]]))return null==t?void 0:t[i[0]];let r=e[e.length-1];return e.length>1&&(0===i.length||this.series.getSeriesKeys().length),null==t?void 0:t[r]},this._getSeriesStyle=(t,e,i)=>{var r;for(let i of(0,a1.IX)(e)){let e=null==(r=this.series.getSeriesStyle(t))?void 0:r(i);if((0,aw.Z)(e))return e}return i},this.markTooltipKeyCallback=(t,e)=>this._getSeriesFieldData(t),this.markTooltipValueCallback=(t,e)=>this._getMeasureData(t),this.shapeTypeCallback=(t,e)=>{var i;return null!=(i=this._getSeriesStyle(t,"shape",null))?i:this._getSeriesStyle(t,"symbolType",this.series.getDefaultShapeType())},this.shapeColorCallback=(t,e)=>this._getSeriesStyle(t,["fill","stroke"]),this.shapeStrokeCallback=(t,e)=>this._getSeriesStyle(t,["stroke","fill"]),this.dimensionTooltipTitleCallback=(t,e)=>this._getDimensionData(t),this.groupTooltipTitleCallback=(t,e)=>this._getSeriesFieldData(t),this.groupTooltipKeyCallback=(t,e)=>{let{seriesFields:i}=this._seriesCacheInfo,r=this._seriesCacheInfo.dimensionFields;return i[0]&&(r=r.filter(t=>t!==i[0])),r.map(e=>null==t?void 0:t[e]).join("-")},this.getHasShape=t=>!!t,this.series=t,this.updateTooltipSpec()}updateTooltipSpec(){var t;let e=null==(t=this.series.getSpec())?void 0:t.tooltip;this.spec=e,this._seriesCacheInfo=this._getSeriesCacheInfo()}getShapeAttrs(t,e,i){var r,n,l,s,a,o,h,d,u,c,p,g;let f=e?"content":"title",m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},null==(r=null==i?void 0:i.style)?void 0:r.shape),null==i?void 0:i[t]),null==(n=null==i?void 0:i[t])?void 0:n[f]),null==(l=this.spec)?void 0:l[t]),null==(a=null==(s=this.spec)?void 0:s[t])?void 0:a[f]);return{shapeType:null!=(o=m.shapeType)?o:this.shapeTypeCallback,shapeFill:null!=(d=null!=(h=m.shapeFill)?h:m.shapeColor)?d:this.shapeColorCallback,shapeStroke:null!=(u=m.shapeStroke)?u:this.shapeStrokeCallback,shapeHollow:null!=(c=m.shapeHollow)&&c,shapeLineWidth:m.shapeLineWidth,shapeSize:null!=(p=m.shapeSize)?p:m.size,hasShape:null!=(g=m.hasShape)?g:this.getHasShape(e)}}enableByType(t){return!0}getDefaultContentList(t){return[this.getDefaultContentPattern(t)]}getContentList(t,e,i,r,n,l){var s;return function(t,e,i,r,n,l){if(n&&n.length){let s=[];return n.forEach(n=>{(0,rD.Z)(t)?t.forEach(t=>{bK(s,t,e,i,r,n,l)}):(0,nz.Z)(t)?bK(s,t,e,i,r,n,l):t&&bU(s,t,e,i,n,l)}),s}return null}(null!=(s=null==e?void 0:e.content)?s:this.getDefaultContentList(t),this.getDefaultContentPattern(t),i,r,n,l)}getTitleResult(t,e,i,r,n){let l=(0,nz.Z)(e)?e(r,n):e;if(l?(0,nB.Z)(l.value)&&(l=Object.assign(Object.assign({},this.getDefaultTitlePattern(t)),l)):l=this.getDefaultTitlePattern(t),l&&!1!==l.visible){let t=function(t){var e;for(let{data:i}of(null==(e=t[0])?void 0:e.series)?[{data:t,value:""}]:t)for(let{datum:t}of i)for(let e of null!=t?t:[])if(e)return e}(r),e={visible:bZ(l.visible,t,n),value:bX(bZ(l.value,t,n,l.valueFormatter),l.valueTimeFormat,l.valueTimeFormatMode),valueStyle:bZ(l.valueStyle,t,n),hasShape:l.hasShape};return Object.keys(i).forEach(r=>{e[r]=bZ(i[r],t,n)}),e}return{hasShape:!1,visible:!1}}getTooltipData(t,e,i,r,n){var l,s;let a;if(!(this.enableByType(t)&&bV(t,this.spec)&&("dimension"!==t||r&&r.length)))return null;let o=null!=(s=null==(l=this.spec)?void 0:l[t])?s:null==e?void 0:e[t],h=this.getShapeAttrs(t,!0,e),d=this.getShapeAttrs(t,!1,e);return"dimension"===t?(a=[],this.getContentList(t,o,h,i,r,n).forEach(t=>{a.push(t)})):a=this.getContentList(t,o,h,i,r,n),{visible:!0,activeType:t,data:i,title:this.getTitleResult(t,null==o?void 0:o.title,d,i,n),content:a}}getDefaultTitlePattern(t){return{key:void 0,value:"group"===t?this.groupTooltipTitleCallback:this.dimensionTooltipTitleCallback}}getDefaultContentPattern(t){return{seriesId:this.series.id,key:"group"===t?this.groupTooltipKeyCallback:this.markTooltipKeyCallback,value:this.markTooltipValueCallback}}}let b$={min:t=>t.length?(0,a1.iH)(t.map(t=>+t)):0,max:t=>t.length?(0,a1.CE)(t.map(t=>+t)):0,"array-min":t=>t.length?(0,a1.iH)(t.map(t=>+t)):0,"array-max":t=>t.length?(0,a1.CE)(t.map(t=>+t)):0,values:t=>{let e={},i=[];for(let r of t)e[r]||(i.push(r),e[r]=1);return i}},bq=(t,e)=>{var i,r;let n=e.fields;if((0,nz.Z)(n)&&(n=n()),!(null==n?void 0:n.length)||!(null==t?void 0:t.length))return{};n=bM([],n);let l="parser"===e.target?"parserData":"latestData";return bJ(t[0][l]?t[0][l]:t||[],n,null==(r=(i=t[0]).getFields)?void 0:r.call(i))},bJ=(t,e,i)=>{let r={},n=[],l=[];return e.forEach(e=>{let s=e.key;r[s]={};let a=null==i?void 0:i[s],o=e.operations,h=o.some(t=>"min"===t||"max"===t||"allValid"===t),d=!0;n.length=0,t&&t.forEach(t=>{t&&n.push(t[s])});let u=n.length;if(h){l.length=0,n.forEach((t,e)=>{hv(t)&&l.push(t)});let t=n;n=l,l=t,d=n.length===u}else n=o.some(t=>"array-min"===t||"array-max"===t)?n.reduce((t,e)=>(e&&e.forEach(e=>{hv(e)&&t.push(e)}),t),[]):n.filter(t=>void 0!==t);e.filter&&(n=n.filter(e.filter)),o.forEach(t=>{if(e.customize)r[s][t]=e.customize;else{if(a&&!0===a.lockStatisticsByDomain&&!(0,nB.Z)(a.domain)){if("values"===t)return void(r[s][t]=a.domain.slice())}else if("allValid"===t)return;r[s][t]=b$[t](n),"array-max"===t&&(r[s].max=r[s][t]),"array-min"===t&&(r[s].min=r[s][t])}}),h&&(r[s].allValid=d)}),r},bQ=(t,e)=>{let{config:i}=e;if(!i)return t;let{invalidType:r,checkField:n}=i();return"zero"!==r||n&&n.length&&t.forEach(t=>{n.forEach(e=>{hv(t[e])||(t[e]=0)})}),t},b0=`${d9}_HIERARCHY_DEPTH`,b1=`${d9}_HIERARCHY_ROOT`,b2=`${d9}_HIERARCHY_ROOT_INDEX`;function b3(){return{keyMap:new Map,needDefaultSeriesField:!this._seriesField,defaultSeriesField:this._seriesField?null:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey)}}function b5(t,e,i){t&&(i.needDefaultSeriesField&&(t[ul]=i.defaultSeriesField),t[ur]=e,t[un]=i.getKey(t,e,i))}function b4(){return{keyMap:new Map,needDefaultSeriesField:!0,defaultSeriesField:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey),categoryField:this.getCategoryField()}}function b6(t,e,i,r=0,n,l){void 0===l&&(l=e),b5(t,e,i),t[b0]=r,t[b1]=n||t[i.categoryField],t[b2]=l,t.children&&t.children.length&&t.children.forEach((e,r)=>b6(e,r,i,t[b0]+1,t[b1],l))}let b7={label:{name:"label",type:"text"}},b8=`${d9}_rect_x`,b9=`${d9}_rect_x1`,_t=`${d9}_rect_y`,_e=`${d9}_rect_y1`,_i={data:!0},_r={invalidType:!0,animation:!0,animationAppear:!0,animationEnter:!0,animationUpdate:!0,animationExit:!0,animationNormal:!0},_n=[...Object.keys(vV),"normal"];function _l(t={},e,i){let r={};for(let n=0;n<_n.length;n++){let l,s,a=_n[n],o=e?e[a]:void 0;if(!1!==o){if("normal"===a){o&&(r.normal=o);continue}if("state"===a){!1!==o&&(r.state=null!=o?o:vV.state);continue}("update"===a||o||t[a])&&((l=(0,rD.Z)(t[a])?t[a]:[Object.assign(Object.assign({},vV[a]),t[a])],"exit"===a&&l.forEach(t=>{t.controlOptions={stopWhenStateChange:!0}}),o)?(s=(0,rD.Z)(o)?o.map((t,e)=>{var r;let n=t;return _d(n)&&delete n.type,n.oneByOne&&(n=_a(n,null!=(r=null==i?void 0:i.dataIndex)?r:_o,null==i?void 0:i.dataCount)),n}):l.map((t,e)=>{var r;let n=h5({},l[e],o);return _d(n)&&delete n.type,n.oneByOne&&(n=_a(n,null!=(r=null==i?void 0:i.dataIndex)?r:_o,null==i?void 0:i.dataCount)),n}),r[a]=s):r[a]=l)}}return r}function _s(t,e,i){var r,n,l,s,a,o;let h={};return(0,aw.Z)(e.animationAppear)&&(h.appear=null!=(r=e.animationAppear[t])?r:e.animationAppear),(0,aw.Z)(e.animationDisappear)&&(h.disappear=null!=(n=e.animationDisappear[t])?n:e.animationDisappear),(0,aw.Z)(e.animationEnter)&&(h.enter=null!=(l=e.animationEnter[t])?l:e.animationEnter),(0,aw.Z)(e.animationExit)&&(h.exit=null!=(s=e.animationExit[t])?s:e.animationExit),(0,aw.Z)(e.animationUpdate)&&(h.update=null!=(a=e.animationUpdate[t])?a:e.animationUpdate),(0,aw.Z)(e.animationState)&&(h.state=null!=(o=e.animationState[t])?o:e.animationState),e.animationNormal&&e.animationNormal[t]&&(h.normal=e.animationNormal[t]),function(t,e){if(!t)return t;let i=["custom","customParameters"];return function t(e,i,r=[]){if((0,rD.Z)(e))e.forEach((n,l)=>{e[l]=i(e[l],l),t(e[l],i,r)});else if((0,nF.Z)(e)&&"function"!=typeof e)for(let n in e)r.includes(n)||(e[n]=i(e[n],n),t(e[n],i,r))}(t=(0,dz.Z)(t,null,i),t=>{var i;return(0,nz.Z)(t)&&(null==(i=t.prototype)?void 0:i.constructor)!==t?(...i)=>t(...i,e):t},i),t}(h,i)}function _a(t,e,i){let{oneByOne:r,duration:n,delay:l,delayAfter:s}=t;return t.delay=(t,i,s)=>{let a=e(t,s),o=(0,nz.Z)(n)?n(t,i,s):(0,hy.Z)(n)?n:0,h=(0,nz.Z)(l)?l(t,i,s):(0,hy.Z)(l)?l:0,d=(0,nz.Z)(r)?r(t,i,s):r;return!1===d?h:h+a*(o+(d=!0===d?0:d))},t.delayAfter=(t,l,a)=>{let o=e(t,a),h=(0,nz.Z)(n)?n(t,l,a):(0,hy.Z)(n)?n:0,d=(0,nz.Z)(s)?s(t,l,a):(0,hy.Z)(s)?s:0,u=(0,nz.Z)(r)?r(t,l,a):r;return!1===u?d:(u=!0===u?0:u,d+((i?i():l.parent.count-1)-o)*(h+u))},delete t.oneByOne,t}function _o(t,e){var i;return null!=(i=null==t?void 0:t[ur])?i:e.context.graphicIndex}function _h(t,e){var i,r,n,l,s;if(!1===t.animation||!1===(null==(i=t.morph)?void 0:i.enable))return!1;let a=!1!==(null!=(n=null==(r=t.animationAppear)?void 0:r[e])?n:t.animationAppear),o=!1!==(null!=(s=null==(l=t.animationUpdate)?void 0:l[e])?s:t.animationUpdate);return!(!a||!o)}function _d(t){return!(0,aw.Z)(t.timeSlices)&&(0,aw.Z)(t.channel)}function _u(t){var e,i,r,n,l,s;let a=t.getSpec();if(!1===a.animation||!1===(null==(i=null==(e=t.getOption())?void 0:e.globalInstance)?void 0:i.isAnimationEnable()))return!1;let o=null!=(r=a.animationThreshold)?r:Number.MAX_SAFE_INTEGER;return null==(n=t.getMarks())||n.forEach(t=>{let e=t.getMarkConfig();e&&(e.large&&e.largeThreshold&&(o=Math.min(o,e.largeThreshold)),e.progressiveThreshold&&(o=Math.min(o,e.progressiveThreshold)))}),!((null==(s=null==(l=t.getRawData())?void 0:l.latestData)?void 0:s.length)>=o)}class _c extends pa{constructor(){super(...arguments),this.markLabelSpec={}}getLabelSpec(t){return this.markLabelSpec[t]}setLabelSpec(t,e){this.markLabelSpec[t]=(0,a1.IX)(e)}addLabelSpec(t,e,i=!1){this.markLabelSpec[t]||(this.markLabelSpec[t]=[]),i?this.markLabelSpec[t].unshift(e):this.markLabelSpec[t].push(e)}getTheme(t,e){var i,r,n;let l=hU(t),s=null==(i=this._option)?void 0:i.getTheme,a=this._option.type,o=h9.getSeriesMarkMap(a)?function(t,e,i){let r=h9.getSeriesMarkMap(e);if(!r)return t;let n={};return Object.values(r).forEach(({type:e,name:r})=>{n[r]=h5({},i("mark",(0,a1.IX)(e)[0]),i("markByName",r),null==t?void 0:t[r])}),Object.assign(Object.assign({},t),n)}(s("series",a),a,s):{},h=s("series",`${a}_${l}`),d=(null!=(n=null!=(r=this.stack)?r:null==h?void 0:h.stack)?n:null==o?void 0:o.stack)?s("series",`${a}_stack`):void 0;return h5({},o,h,d)}transformSpec(t,e,i){this._transformStack(t);let r=super.transformSpec(t,e,i);return this._transformLabelSpec(r.spec),Object.assign(Object.assign({},r),{markLabelSpec:this.markLabelSpec,stack:this.stack})}_transformLabelSpec(t){}_transformStack(t){(0,nD.Z)(t.stack)&&(this.stack=t.stack),(0,nD.Z)(t.percent)&&(this.stack=t.percent||this.stack),(0,nB.Z)(this.stack)&&this._supportStack&&t.seriesField&&(this.stack=!0)}_addMarkLabelSpec(t,e,i="label",r="initLabelMarkStyle",n=!0,l){t&&(0,a1.IX)(t[i]).forEach(i=>{var s,a,o;if(i&&i.visible){let{animation:h=!0,animationUpdate:d=!0,animationEnter:u=!0,animationExit:c=!0}=i,{animationUpdate:p=!0,animationEnter:g=!0,animationExit:f=!0}=t,m=!!(null!=(o=null!=(a=null==(s=this._option.globalInstance)?void 0:s.isAnimationEnable())?a:t.animation)?o:i.animation)&&!!n;this.addLabelSpec((0,nz.Z)(e)?e(i):e,Object.assign(Object.assign({},i),{animation:!!m&&h,animationUpdate:!!(m&&p&&d)&&p,animationEnter:!!(m&&g&&u)&&g,animationExit:!!(m&&g&&c)&&f,getStyleHandler:t=>{var e;return null==(e=t[r])?void 0:e.bind(t)}}),l)}})}_getDefaultSpecFromChart(t){var e;let i=null!=(e=super._getDefaultSpecFromChart(t))?e:{},{outerRadius:r,innerRadius:n,direction:l}=t;return(0,aw.Z)(r)&&(i.outerRadius=r),(0,aw.Z)(n)&&(i.innerRadius=n),(0,aw.Z)(l)&&(i.direction=l),Object.keys(i).length>0?i:void 0}_mergeThemeToSpec(t,e){let i=this._theme;if(this._shouldMergeThemeToSpec()){let r=this._getDefaultSpecFromChart(e),n=t=>{let e=h5({},i,r,t),n=i.label;return n&&(0,nF.Z)(n)&&(0,rD.Z)(e.label)&&(e.label=e.label.map(t=>h5({},n,t))),e};return(0,rD.Z)(t)?{spec:t.map(t=>n(t)),theme:i}:{spec:n(t),theme:i}}return{spec:t,theme:i}}}class _p extends pc{getRegion(){return this._region}getLayoutStartPoint(){return this._region.getLayoutStartPoint()}getRootMark(){return this._rootMark}getSeriesMark(){return this._seriesMark}getRawData(){return this._rawData}getViewDataFilter(){return this._viewDataFilter}getViewData(){var t;return null==(t=this._data)?void 0:t.getDataView()}getViewDataProductId(){var t;return null==(t=this._data)?void 0:t.getProductId()}getViewDataStatistics(){return this._viewDataStatistics}getViewStackData(){return this._viewStackData}getSeriesField(){return this._seriesField}setSeriesField(t){(0,aw.Z)(t)&&(this._seriesField=t)}getGroups(){return this._groups}getStack(){var t;return null==(t=this.getSpecInfo())?void 0:t.stack}getStackValue(){var t;return null!=(t=this._spec.stackValue)?t:`${d9}_series_${this.type}`}getPercent(){return this._spec.percent}getStackOffsetSilhouette(){return this._spec.stackOffsetSilhouette}get tooltipHelper(){return this._tooltipHelper||this.initTooltip(),this._tooltipHelper}getInvalidType(){return this._invalidType}setInvalidType(t){var e;this._invalidType=t,null==(e=this.getViewData())||e.reRunAllTransform()}getMarkAttributeContext(){return this._markAttributeContext}constructor(t,e){var i;super(t,e),this.specKey="series",this.type="series",this.layoutType="absolute",this.modelType="series",this.name=void 0,this.transformerConstructor=_c,this.coordinate="none",this._region=null,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:null,height:null},this.getLayoutRect=()=>{var t,e;return{width:null!=(t=this._layoutRect.width)?t:this._region.getLayoutRect().width,height:null!=(e=this._layoutRect.height)?e:this._region.getLayoutRect().height}},this._rootMark=null,this._seriesMark=null,this._viewDataMap=new Map,this._viewDataFilter=null,this._data=null,this.layoutZIndex=ts.SeriesGroup,this._invalidType="break",this._region=e.region,this._dataSet=e.dataSet,(null==(i=this._spec)?void 0:i.name)&&(this.name=this._spec.name)}created(){super.created(),this._buildMarkAttributeContext(),this.initData(),this.initGroups(),this.initStatisticalData(),this.event.emit(J.afterInitData,{model:this}),this.initRootMark(),this.initMark();let t=_u(this);this._initExtensionMark({hasAnimation:t}),this.initMarkStyle(),this.initMarkState(),t&&this.initAnimation(),this.afterInitMark(),this.initEvent(),this.event.emit(J.afterInitEvent,{model:this})}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(t,e)=>{var i;return null==(i=this._option.globalScale.getScale(t))?void 0:i.scale(e)},seriesColor:t=>{var e;return(0,nB.Z)(t)&&(t=this.getSeriesKeys()[0]),null==(e=this._option.globalScale.getScale("color"))?void 0:e.scale(t)},getRegion:()=>this._region}}setAttrFromSpec(){super.setAttrFromSpec(),this.setSeriesField(this._spec.seriesField),(0,aw.Z)(this._spec.invalidType)&&(this._invalidType=this._spec.invalidType)}getInvalidCheckFields(){return[this.getStackValueField()]}initInvalidDataTransform(){var t,e;"zero"===this._invalidType&&(null==(t=this._rawData)?void 0:t.dataSet)&&(dL(this._rawData.dataSet,"invalidTravel",bQ),null==(e=this._rawData)||e.transform({type:"invalidTravel",options:{config:()=>({invalidType:this._invalidType,checkField:this.getInvalidCheckFields()})}},!1))}initData(){var t,e,i;let r=null!=(t=this._spec.data)?t:this._option.getSeriesData(this._spec.dataId,this._spec.dataIndex);if(r&&(this._rawData=dj(r,this._dataSet,this._option.sourceDataList)),null==(i=null==(e=this._rawData)?void 0:e.target)||i.addListener("change",this.rawDataUpdate.bind(this)),this._addDataIndexAndKey(),this._rawData){this.getStack()&&(this._viewDataFilter=dN(this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewDataFilter`}));let t=dN(this.getStack()?this._viewDataFilter:this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewData`});this._data=new pV(this._option,t),this.getStack()&&this._viewDataFilter.target.removeListener("change",t.reRunAllTransform)}this.initInvalidDataTransform()}initGroups(){let t=this.getGroupFields();t&&t.length&&(this._groups={fields:t})}initStatisticalData(){this._data&&this._statisticViewData()}getRawDataStatisticsByField(t,e){var i,r,n;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]||e&&((0,nB.Z)(this._rawStatisticsCache[t].min)||(0,nB.Z)(this._rawStatisticsCache[t].max))||!e&&(0,nB.Z)(this._rawStatisticsCache[t].values)){if(this._viewDataStatistics&&(!this._viewDataFilter||this._viewDataFilter.transformsArr.length<=1)&&this.getViewData().transformsArr.length<=1&&(null==(i=this._viewDataStatistics.latestData)?void 0:i[t]))this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t];else if(this._rawData){let i=null==(r=this._rawData.getFields())?void 0:r[t];if(i&&i.lockStatisticsByDomain&&i.domain)this._rawStatisticsCache[t]={},e?(this._rawStatisticsCache[t].min=(0,a1.iH)(i.domain),this._rawStatisticsCache[t].max=(0,a1.CE)(i.domain)):this._rawStatisticsCache[t].values=i.domain;else{let i=bJ(this._rawData.latestData,[{key:t,operations:e?["min","max"]:["values"]}])[t];this._rawStatisticsCache[t]=(0,h3.Z)(null!=(n=this._rawStatisticsCache[t])?n:{},i)}}}return this._rawStatisticsCache[t]}_statisticViewData(){dL(this._dataSet,"dimensionStatistics",bq);let t=`${this.type}_${this.id}_viewDataStatic`;this._viewDataStatistics=new eq.V(this._dataSet,{name:t}),this._viewDataStatistics.parse([this._data.getDataView()],{type:"dataview"}),this._viewDataStatistics.transform({type:"dimensionStatistics",options:{fields:()=>{let t=this.getStatisticFields();return this._seriesField&&bM(t,[{key:this._seriesField,operations:["values"]}]),t},target:"latest"}},!1),this._data.getDataView().target.removeListener("change",this._viewDataStatistics.reRunAllTransform),this.getStack()&&this.createdStackData()}createStatisticalData(t,e,i){dL(this._dataSet,"dimensionStatistics",bq);let r=new eq.V(this._dataSet,{name:t});return r.parse([e],{type:"dataview"}),r.transform({type:"dimensionStatistics",options:{operations:["max","min","values"],fields:()=>{var t;let r=bM(this.getStatisticFields(),null!=(t=null==i?void 0:i(e.name))?t:[]);return this._seriesField&&bM(r,[{key:this._seriesField,operations:["values"]}]),r},target:"latest"}},!1),r}createdStackData(){let t=`${this.type}_${this.id}_viewStackData`;this._viewStackData=new eq.V(this._dataSet,{name:t}),this._viewStackData.parse([this._viewDataFilter],{type:"dataview"}),this._viewStackData.transform({type:"stackSplit",options:{fields:this.getStackGroupFields()}},!1)}_noAnimationDataKey(t,e){return e}generateDefaultDataKey(t){var e;return(0,nB.Z)(t)?(t,e,i)=>{if(!1===this._spec.animation){let i=this._noAnimationDataKey(t,e);if(void 0!==i)return i}let{keyMap:r}=i,n=this._getSeriesDataKey(t);return void 0===r.get(n)?(r.set(n,0),n):(r.set(n,r.get(n)+1),`${n}_${r.get(n)}`)}:(0,nI.Z)(t)?e=>e[t]:(0,rD.Z)(t)&&t.every(t=>(0,nI.Z)(t))?e=>t.map(t=>e[t]).join("-"):(0,nz.Z)(t)?(e,i)=>t(e,i):(null==(e=this._option)||e.onError(`invalid dataKey: ${t}`),(t,e)=>{})}_addDataIndexAndKey(){var t;(null==(t=this._rawData)?void 0:t.dataSet)&&(dL(this._rawData.dataSet,"addVChartProperty",bO),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:b3.bind(this),call:b5}},!1))}updateRawData(t){this._rawData&&this._rawData.updateRawData(t)}rawDataUpdate(t){var e;null==(e=this._rawDataStatistics)||e.reRunAllTransform(),this._rawStatisticsCache=null,this.event.emit(J.rawDataUpdate,{model:this})}viewDataFilterOver(t){this.event.emit(J.viewDataFilterOver,{model:this})}viewDataUpdate(t){var e;this.event.emit(J.viewDataUpdate,{model:this}),null==(e=this._data)||e.updateData(),this._viewDataStatistics&&this._viewDataStatistics.reRunAllTransform()}viewDataStatisticsUpdate(t){this.event.emit(J.viewDataStatisticsUpdate,{model:this})}getDatumPositionValue(t,e){return!t||(0,nB.Z)(e)?null:t[e]}getDatumPositionValues(t,e){return!t||(0,nB.Z)(e)?[]:(0,nI.Z)(e)?[t[e]]:e.map(e=>t[e])}setValueFieldToStack(){}setValueFieldToPercent(){}setValueFieldToStackOffsetSilhouette(){}initRootMark(){var t,e,i;this._rootMark=this._createMark({type:"group",name:`seriesGroup_${this.type}_${this.id}`},{parent:null==(e=(t=this._region).getGroupMark)?void 0:e.call(t),dataView:!1}),this._rootMark.setMarkConfig({zIndex:null!=(i=this._spec.zIndex)?i:this.layoutZIndex})}_getExtensionMarkNamePrefix(){return`${this.type}_${this.id}_extensionMark`}_initExtensionMark(t){var e;this._spec.extensionMark&&(null==(e=this._spec.extensionMark)||e.forEach((e,i)=>{this._createExtensionMark(e,null,this._getExtensionMarkNamePrefix(),i,t)}))}_createExtensionMark(t,e,i,r,n){var l;let s=this._createMark({type:t.type,name:(0,aw.Z)(t.name)?`${t.name}`:`${i}_${r}`},{skipBeforeLayouted:!0,markSpec:t,parent:e,dataView:!1,componentType:t.componentType,key:t.dataKey});if(s){if((0,aw.Z)(t.id)&&s.setUserId(t.id),n.hasAnimation&&!1!==t.animation){let e=_l({},_s(t.type,t,this._markAttributeContext));s.setAnimationConfig(e)}if("group"===t.type&&(i=`${i}_${r}`,null==(l=t.children)||l.forEach((t,e)=>{this._createExtensionMark(t,s,i,e,n)})),!(0,nB.Z)(t.dataId)||!(0,nB.Z)(t.dataIndex)){let e=this._option.getSeriesData(t.dataId,t.dataIndex);e===this._rawData?s.setData(this._data):(s.setDataView(e),e.target.addListener("change",()=>{s.getData().updateData()}))}}}_updateExtensionMarkSpec(){var t;null==(t=this._spec.extensionMark)||t.forEach((t,e)=>{let i=this._marks.getMarkWithInfo({name:(0,aw.Z)(t.name)?`${t.name}`:`${this._getExtensionMarkNamePrefix()}_${e}`});i&&(this.initMarkStyleWithSpec(i,t),i.commit(!1,!0))})}getStackData(){var t;return null==(t=this._viewStackData)?void 0:t.latestData}_parseDefaultInteractionConfig(t){var e;if(!(null==t?void 0:t.length))return[];let i=(e=this._option.mode)===oJ["desktop-browser"]||e===oJ["desktop-miniApp"]?{hover:{enable:!0,trigger:"pointermove",triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"pointertap"}}:hE(e)||hL(e)?{hover:{enable:!0,trigger:["pointerdown","pointermove"],triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"tap"}}:null,r=Object.assign({},null==i?void 0:i.hover),n=Object.assign({},null==i?void 0:i.select),l=this._spec.hover;(0,nD.Z)(l)?r.enable=l:(0,nF.Z)(l)&&(r.enable=!0,r=h5(r,l));let s=this._spec.select;(0,nD.Z)(s)?n.enable=s:(0,nF.Z)(s)&&(n.enable=!0,n=h5(n,s));let a=[{trigger:{type:"dimension-hover"},marks:t}];if(r.enable){let e=be(r,t);e.length&&a.push({trigger:this._defaultHoverConfig(r),marks:e})}if(n.enable){let e=be(n,t);e.length&&a.push({trigger:this._defaultSelectConfig(n),marks:e})}return a}_defaultHoverConfig(t){return{type:"element-highlight",trigger:t.trigger,triggerOff:t.triggerOff,blurState:td.STATE_HOVER_REVERSE,highlightState:td.STATE_HOVER}}_defaultSelectConfig(t){let e="multiple"===t.mode,i=(0,aw.Z)(t.triggerOff)?t.triggerOff:e?["empty"]:["empty",t.trigger];return{type:"element-select",trigger:t.trigger,triggerOff:i,reverseState:td.STATE_SELECTED_REVERSE,state:td.STATE_SELECTED,isMultiple:e}}_parseInteractionConfig(t){let{interactions:e}=this._spec,i=this._parseDefaultInteractionConfig(t);return e&&e.length&&e.forEach(t=>{let e=be(t,this.getMarks());e.length&&i.push({trigger:t,marks:e})}),i}getInteractionTriggers(){if(!0!==this._option.disableTriggerEvent){let t=this.getMarksWithoutRoot();return this._parseInteractionConfig(t)}return[]}initAnimation(){}initMarkState(){this.initSeriesStyleState()}initSeriesStyleState(){var t;let e=this._spec.seriesStyle;if(!e||!e.length)return;let i=null!=(t=this._seriesField)?t:ul;this.getMarksWithoutRoot().forEach(t=>{let r={},n={},l={};e.forEach(e=>{var i;let s=null==(i=e[t.name])?void 0:i.style;s&&(r[e.name]=!0,l[e.name]=l[e.name]||{},Object.keys(s).forEach(t=>{n[t]=!0,l[e.name][t]=s[t]}))}),t.state.addStateInfo({stateValue:us,level:-1,filter:t=>Array.isArray(t)?0!==t.length&&!0===r[t[0][i]]:!0===r[t[i]]});let s={};Object.keys(n).forEach(e=>{s[e]=r=>{var n,s;let a;if(Array.isArray(r)){if(0===r.length)return;a=null==(n=l[r[0][i]])?void 0:n[e]}return a=null==(s=l[r[i]])?void 0:s[e],(0,aw.Z)(a)?a:t.getAttribute(e,r)}}),this.setMarkStyle(t,s,us,to.User_SeriesStyle)})}afterInitMark(){this.event.emit(J.afterInitMark,{model:this}),this.setSeriesField(this._spec.seriesField),this.getMarks().forEach(t=>{var e,i;(null==(i=null==(e=t.stateStyle)?void 0:e.normal)?void 0:i.lineWidth)&&t.setAttribute("stroke",this.getColorAttribute(),"normal",to.Base_Series)})}getMarksWithoutRoot(){return this.getMarks().filter(t=>{var e;return!(null==(e=t.name)?void 0:e.includes("seriesGroup"))})}getMarksInType(t){return this._marks.getMarksInType(t)}getMarkInName(t){return this._marks.get(t)}getMarkInId(t){return this.getMarks().find(e=>e.id===t)}initEvent(){var t,e,i;null==(e=null==(t=this._data)?void 0:t.getDataView())||e.target.addListener("change",this.viewDataUpdate.bind(this)),null==(i=this._viewDataStatistics)||i.target.addListener("change",this.viewDataStatisticsUpdate.bind(this))}_releaseEvent(){super._releaseEvent()}initTooltip(){this._tooltipHelper=new bY(this)}_compareExtensionMarksSpec(t,e,i){t.length!==e.length||e.some((e,i)=>e.type!==t[i].type||e.id!==t[i].id||e.name!==t[i].name)?i.reMake=!0:e.some((e,i)=>e.visible!==t[i].visible)&&(i.reCompile=!0)}_compareLabelSpec(t,e,i){t.length!==e.length||e.some((e,i)=>e.labelLayout!==t[i].labelLayout||e.visible!==t[i].visible)?i.reMake=!0:!i.reCompile&&e.some((e,i)=>!(0,uL.X)(e,t[i]))&&(i.reCompile=!0)}_compareSpec(t,e,i){let r=super._compareSpec(t,e),n=Object.keys(e||{}).sort(),l=Object.keys(t||{}).sort();if(!(0,uL.X)(n,l))return r.reMake=!0,r;let s=Object.assign(Object.assign(Object.assign(Object.assign({},_i),_r),i),{extensionMark:!0,label:!0,totalLabel:!0});return this._compareExtensionMarksSpec((0,a1.IX)(t.extensionMark),(0,a1.IX)(e.extensionMark),r),r.reMake||this._compareLabelSpec((0,a1.IX)(t.label),(0,a1.IX)(e.label),r),r.reMake||this._compareLabelSpec((0,a1.IX)(t.totalLabel),(0,a1.IX)(e.totalLabel),r),r.reMake||(!r.reCompile&&this._marks.getMarks().some(i=>{var r,n;return s[i.name]=!0,(null==(r=e[i.name])?void 0:r.visible)!==(null==(n=t[i.name])?void 0:n.visible)})&&(r.reCompile=!0),!r.reCompile&&n.some(i=>_r[i]&&!(0,uL.X)(t[i],e[i]))&&(r.reCompile=!0),n.some(i=>!s[i]&&!(0,uL.X)(t[i],e[i]))&&(r.reMake=!0)),r}_updateSpecData(){!this._rawData||!this._spec.data||this._spec.data instanceof eq.V||dG(this._rawData,this._spec.data,!0)}reInit(t){super.reInit(t);let e=this.getMarksWithoutRoot();e.forEach(t=>{this._spec[t.name]&&this.initMarkStyleWithSpec(t,this._spec[t.name])}),this.initMarkStyle(),e.forEach(t=>{t.commit(!1)}),this._updateExtensionMarkSpec(),this._updateSpecData(),this._tooltipHelper&&this._tooltipHelper.updateTooltipSpec(),_u(this)&&this.initAnimation()}onEvaluateEnd(t){this._data.updateData()}release(){var t,e;super.release(),this._viewDataMap.clear();let i=null==(e=null==(t=this._rawData)?void 0:t.transformsArr)?void 0:e.findIndex(t=>"addVChartProperty"===t.type);i>=0&&this._rawData.transformsArr.splice(i,1),this._dataSet=this._data=this._rawData=this._rawDataStatistics=this._spec=this._region=this._viewDataStatistics=this._viewStackData=null}setLayoutStartPosition(t){(0,hy.Z)(t.x)&&(this._layoutStartPoint.x=t.x),(0,hy.Z)(t.y)&&(this._layoutStartPoint.y=t.y)}setLayoutRect({width:t,height:e},i){(0,hy.Z)(t)&&(this._layoutRect.width=t),(0,hy.Z)(e)&&(this._layoutRect.height=e)}getSeriesKeys(){var t,e;return this._seriesField?null!=(e=null==(t=this.getRawDataStatisticsByField(this._seriesField))?void 0:t.values)?e:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}getSeriesStyle(t){return e=>{var i,r;return null!=(r=null==(i=this._seriesMark)?void 0:i.getAttribute(e,t))?r:void 0}}_getSeriesInfo(t,e){let i=this.getDefaultShapeType();return e.map(e=>({key:e,originalKey:e,style:this.getSeriesStyle({[t]:e}),shapeType:i}))}getSeriesInfoInField(t){var e,i;return this._getSeriesInfo(t,null!=(i=null==(e=this.getRawDataStatisticsByField(t))?void 0:e.values)?i:[])}getSeriesInfoList(){var t;return this._getSeriesInfo(null!=(t=this._seriesField)?t:ul,this.getSeriesKeys())}_getDefaultColorScale(){var t,e;let i=this.getDefaultColorDomain(),r=this._getDataScheme();return null==(e=(t=(new pB).domain(i)).range)?void 0:e.call(t,r)}_getDataScheme(){return hY(this.getColorScheme(),this.type)}getDefaultColorDomain(){var t,e;return this._seriesField?null==(e=null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._seriesField])?void 0:e.values:[]}getColorAttribute(){var t,e;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:null!=(e=this._seriesField)?e:ul}}getDimensionField(){return[]}getMeasureField(){return[]}onMarkPositionUpdate(){this.onMarkTreePositionUpdate(this.getMarksWithoutRoot())}onMarkTreePositionUpdate(t){}_createMark(t,e={},i={}){var r,n,l,s,a;let{key:o,groupKey:h,skipBeforeLayouted:d,themeSpec:u={},markSpec:c,dataView:p,parent:g,isSeriesMark:f,noSeparateStyle:m=!1}=e,y=super._createMark(t,{key:null!=o?o:this._getDataIdKey(),seriesId:this.id,attributeContext:this._markAttributeContext,componentType:e.componentType,noSeparateStyle:m,parent:!1!==g?null!=g?g:this._rootMark:null});if((0,aw.Z)(y)){let e=this.getSpec()||{};this._marks.addMark(y,{name:t.name}),f&&(this._seriesMark=y),(0,nB.Z)(p)?y.setData(this._data):!1!==p&&y.setDataView(p),y.setSkipBeforeLayouted(!1!==d),(0,nB.Z)(h)||y.setGroupKey(h);let o=Object.assign(Object.assign({},i),{progressiveStep:e.progressiveStep,progressiveThreshold:e.progressiveThreshold,large:e.large,largeThreshold:e.largeThreshold,morph:null!=(r=i.morph)&&r,useSequentialAnimation:e.useSequentialAnimation,support3d:null!=(n=i.support3d)?n:e.support3d||!!e.zField,morphKey:(null==(l=e.morph)?void 0:l.morphKey)||`${this.getSpecIndex()}_${this.getMarks().length}`,morphElementKey:null!=(a=null==(s=e.morph)?void 0:s.morphElementKey)?a:i.morphElementKey});y.setMarkConfig(o),this.initMarkStyleWithSpec(y,h5({},u,c||e[y.name]))}return y}_getDataIdKey(){var t;return null!=(t=super._getDataIdKey())?t:un}_getSeriesDataKey(t){let e="";if(!t)return e;let i=this.getDimensionField();e=i.map(e=>t[e]).join("_");let r=this.getSeriesField();return r&&!i.includes(r)&&(e+=`_${t[r]}`),e}addViewDataFilter(t){var e,i;null==(i=null!=(e=this._viewDataFilter)?e:this.getViewData())||i.transform(t,!1)}reFilterViewData(){var t,e;null==(e=null!=(t=this._viewDataFilter)?t:this.getViewData())||e.reRunAllTransform()}reTransformViewData(){var t,e;null==(e=null==(t=this._data)?void 0:t.getDataView())||e.reRunAllTransform()}fillData(){var t;null==(t=this.getRawData())||t.reRunAllTransform()}compile(){this.compileData()}getDefaultShapeType(){return"circle"}getFieldAlias(t){var e;return t!==uh&&t!==uu&&t!==uo&&t!==ud||(t=this.getStackValueField()),null!=(e=bT(this.getRawData(),t))?e:t}_getInvalidConnectType(){return"zero"===this._invalidType?"zero":"link"===this._invalidType?"connect":"none"}_getInvalidDefined(t){let e=this.getInvalidCheckFields();return!e.length||e.every(e=>hv(t[e]))}_getRelatedComponentSpecInfo(t){var e;let i=this.getSpecIndex(),r=null==(e=this._option.getSpecInfo().component[t])?void 0:e.filter(t=>t.seriesIndexes.includes(i));return null!=r?r:[]}_forEachStackGroup(t,e){var i,r;(e=null!=e?e:null==(i=this._viewStackData)?void 0:i.latestData)&&((null==(r=e.values)?void 0:r.length)?t(e):e.nodes&&Object.values(e.nodes).forEach(e=>{this._forEachStackGroup(t,e)}))}isDatumInViewData(t){if(!t)return!1;let e=this.getViewData().latestData;return!!e&&(!!e.includes(t)||e.some(e=>Object.keys(t).every(i=>t[i]===e[i])))}getSeriesFieldValue(t,e){var i;return t[null!=(i=null!=e?e:this.getSeriesField())?i:ul]}}function _g(t){return[Y.rose,Y.radar,Y.circularProgress].includes(t)}function _f(t,e,i){let r=t.getScale(0),n="isInverse"in t&&t.isInverse();(0,pW.z2)(r.type)?i.sort((t,i)=>(t[e]-i[e])*(n?-1:1)):i.sort((t,i)=>(r.index(t[e])-r.index(i[e]))*(n?-1:1))}function _m(t){return{dataIndex:e=>{var i,r;let n="horizontal"===t.direction?t.fieldY[0]:t.fieldX[0],l=null==e?void 0:e[n],s="horizontal"===t.direction?t.scaleY:t.scaleX;return(null!=(r=null==(i=null==s?void 0:s.domain)?void 0:i.call(s))?r:[]).indexOf(l)||0},dataCount:()=>{var e,i,r;let n="horizontal"===t.direction?t.scaleY:t.scaleX;return null!=(r=(null!=(i=null==(e=null==n?void 0:n.domain)?void 0:e.call(n))?i:[]).length)?r:0}}}_p.mark=b7,_p.transformerConstructor=_c;class _y extends _p{constructor(){super(...arguments),this.coordinate="cartesian",this._bandPosition=.5,this._scaleConfig={bandPosition:this._bandPosition},this._direction="vertical",this._sortDataByAxis=!1,this._getPositionXEncoder=()=>{var t;return null==(t=this._positionXEncoder)?void 0:t.bind(this)},this._setPositionXEncoder=t=>{this._positionXEncoder=t.bind(this)},this._getPositionYEncoder=()=>{var t;return null==(t=this._positionYEncoder)?void 0:t.bind(this)},this._setPositionYEncoder=t=>{this._positionYEncoder=t.bind(this)}}_buildScaleConfig(){this._scaleConfig={bandPosition:this._bandPosition}}get fieldX(){return this._fieldX}setFieldX(t){this._fieldX=(0,a1.IX)(t)}get fieldY(){return this._fieldY}setFieldY(t){this._fieldY=(0,a1.IX)(t)}get fieldZ(){return this._fieldZ}setFieldZ(t){this._fieldZ=t&&(0,a1.IX)(t)}get fieldX2(){return this._fieldX2}setFieldX2(t){this._fieldX2=t}get fieldY2(){return this._fieldY2}setFieldY2(t){this._fieldY2=t}get direction(){return this._direction}get scaleX(){return this._scaleX}setScaleX(t){this._scaleX=t}get scaleY(){return this._scaleY}setScaleY(t){this._scaleY=t}get scaleZ(){return this._scaleZ}setScaleZ(t){this._scaleZ=t}getXAxisHelper(){return this._xAxisHelper}setXAxisHelper(t){this._xAxisHelper=t,this.onXAxisHelperUpdate()}getYAxisHelper(){return this._yAxisHelper}setYAxisHelper(t){this._yAxisHelper=t,this.onYAxisHelperUpdate()}getZAxisHelper(){return this._zAxisHelper}setZAxisHelper(t){this._zAxisHelper=t,this.onYAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}getStatisticFields(){let t=[];return[{axisHelper:this.getXAxisHelper(),fields:this._fieldX2?[...this._fieldX,this._fieldX2]:this._fieldX},{axisHelper:this.getYAxisHelper(),fields:this._fieldY2?[...this._fieldY,this._fieldY2]:this._fieldY},{axisHelper:this.getZAxisHelper(),fields:this._fieldZ}].forEach(e=>{e.axisHelper&&e.axisHelper.getScale&&e.fields&&e.fields.forEach(i=>{let r={key:i,operations:[]},n=e.axisHelper.getScale(0);(0,pW.z2)(n.type)?(r.operations=["max","min"],"log"===n.type&&(r.filter=t=>t>0)):r.operations=["values"],t.push(r)})}),this.getStack()&&t.push({key:this.getStackValueField(),operations:["allValid"]}),t}getGroupFields(){return"vertical"===this.direction?this._fieldX:this._fieldY}getStackGroupFields(){return this.getGroupFields()}getStackValue(){var t,e;let i=null==(t="horizontal"===this.direction?this.getXAxisHelper():this.getYAxisHelper())?void 0:t.getAxisId();return null!=(e=this._spec.stackValue)?e:`${d9}_series_${this.type}_${i}`}getStackValueField(){return"horizontal"===this.direction?(0,a1.IX)(this._spec.xField)[0]:(0,a1.IX)(this._spec.yField)[0]}setValueFieldToStack(){"horizontal"===this.direction?(this.setFieldX(uh),this.setFieldX2(uo)):(this.setFieldY(uh),this.setFieldY2(uo))}setValueFieldToPercent(){"horizontal"===this.direction?(this.setFieldX(uu),this.setFieldX2(ud)):(this.setFieldY(uu),this.setFieldY2(ud))}setValueFieldToStackOffsetSilhouette(){"horizontal"===this.direction?(this.setFieldX(up),this.setFieldX2(uc)):(this.setFieldY(up),this.setFieldY2(uc))}onXAxisHelperUpdate(){this.onMarkPositionUpdate()}onYAxisHelperUpdate(){this.onMarkPositionUpdate()}onZAxisHelperUpdate(){this.onMarkPositionUpdate()}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.setFieldX(this._spec.xField),this.setFieldY(this._spec.yField),this.setFieldZ(this._spec.zField),this._specXField=(0,a1.IX)(this._spec.xField),this._specYField=(0,a1.IX)(this._spec.yField),(0,aw.Z)(this._spec.direction)&&(this._direction=this._spec.direction),this.setFieldX2(null==(t=this._spec)?void 0:t.x2Field),this.setFieldY2(null==(e=this._spec)?void 0:e.y2Field),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent(),this.getStackOffsetSilhouette()&&this.setValueFieldToStackOffsetSilhouette(),(0,aw.Z)(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)}dataToPosition(t,e){return t?e&&!this.isDatumInViewData(t)?null:{x:this.dataToPositionX(t),y:this.dataToPositionY(t)}:null}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToX=this.valueToPositionX.bind(this),this._markAttributeContext.valueToY=this.valueToPositionY.bind(this),this._markAttributeContext.xBandwidth=(t=0)=>{var e,i,r;return null!=(r=null==(i=(e=this.getXAxisHelper()).getBandwidth)?void 0:i.call(e,t))?r:0},this._markAttributeContext.yBandwidth=(t=0)=>{var e,i,r;return null!=(r=null==(i=(e=this.getYAxisHelper()).getBandwidth)?void 0:i.call(e,t))?r:0},this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)}valueToPosition(t,e){return{x:this.valueToPositionX(t),y:this.valueToPositionY(e)}}_axisPosition(t,e,i){return this._scaleConfig.datum=i,t.isContinuous?t.valueToPosition(e,this._scaleConfig):t.dataToPosition((0,a1.IX)(e),this._scaleConfig)}valueToPositionX(t,e){return this._axisPosition(this._xAxisHelper,t,e)}valueToPositionY(t,e){return this._axisPosition(this._yAxisHelper,t,e)}_dataToPosition(t,e,i,r,n,l){let s=n();if(s)return s(t);if(!e)return l(t=>Number.NaN),Number.NaN;let a=(e.getFields?e.getFields():i).slice(0,r);return a&&0!==a.length?(e.isContinuous?l(t=>(this._scaleConfig.datum=t,e.valueToPosition(this.getDatumPositionValue(t,a[0]),this._scaleConfig))):l(t=>(this._scaleConfig.datum=t,e.dataToPosition((0,a1.IX)(this.getDatumPositionValues(t,a)),this._scaleConfig))),n()(t)):(l(t=>null),null)}dataToPositionX(t){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,void 0,this._getPositionXEncoder,this._setPositionXEncoder)}dataToPositionY(t){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,void 0,this._getPositionYEncoder,this._setPositionYEncoder)}dataToPositionZ(t){if(!this._zAxisHelper)return Number.NaN;let{dataToPosition:e}=this._zAxisHelper;return e(this.getDatumPositionValues(t,this._fieldZ),{bandPosition:this._bandPosition})}dataToPositionX1(t){return this._xAxisHelper?this._fieldX2&&this._fieldX2 in t?this.valueToPositionX(this.getDatumPositionValues(t,this._fieldX2)):this.valueToPositionX(0):Number.NaN}dataToPositionY1(t){return this._yAxisHelper?this._fieldY2&&this._fieldY2 in t?this.valueToPositionY(this.getDatumPositionValues(t,this._fieldY2)):this.valueToPositionY(0):Number.NaN}positionToData(t){return t?{x:this.positionToDataX(t.x),y:this.positionToDataY(t.y)}:null}positionToDataX(t){return this._scaleX?this._scaleX.invert(t):null}positionToDataY(t){return this._scaleY?this._scaleY.invert(t):null}getRegionRectLeft(){if(!this._xAxisHelper)return Number.NaN;let{getScale:t}=this._xAxisHelper;return t(0).range()[0]}getRegionRectRight(){if(!this._xAxisHelper)return Number.NaN;let{getScale:t}=this._xAxisHelper;return t(0).range()[1]}afterInitMark(){super.afterInitMark(),this.setFieldX(this._fieldX),this.setFieldY(this._fieldY),this._buildScaleConfig()}getDimensionField(){return"horizontal"===this._direction?this._specYField:this._specXField}getDimensionContinuousField(){return"horizontal"===this._direction?[this.fieldY[0],this.fieldY2]:[this.fieldX[0],this.fieldX2]}getMeasureField(){return"horizontal"===this._direction?this._specXField:this._specYField}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(J.scaleDomainUpdate,{filter:t=>{var e;return t.model.id===(null==(e="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper)?void 0:e.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var t,e,i;(null==(e=null==(t=this.getViewData())?void 0:t.latestData)?void 0:e.length)&&(_f("horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,"horizontal"===this._direction?this._fieldY[0]:this._fieldX[0],this.getViewData().latestData),null==(i=this._data)||i.updateData(!0))}getInvalidCheckFields(){let t=[];return this._xAxisHelper&&this._xAxisHelper.isContinuous&&this._xAxisHelper.getAxisType()!==oQ.geoCoordinate&&(this._xAxisHelper.getFields?this._xAxisHelper.getFields():this._specXField).forEach(e=>{t.push(e)}),this._yAxisHelper&&this._yAxisHelper.isContinuous&&this._yAxisHelper.getAxisType()!==oQ.geoCoordinate&&(this._yAxisHelper.getFields?this._yAxisHelper.getFields():this._specYField).forEach(e=>{t.push(e)}),t}reInit(t){this._positionXEncoder&&(this._positionXEncoder=null),this._positionYEncoder&&(this._positionYEncoder=null),super.reInit(t)}}let _v="monotone",_b="linear",__="bevel";(tI=tq||(tq={})).dimensionHover="dimensionHover",tI.dimensionClick="dimensionClick";let _C={point:{name:"point",type:"symbol"},line:{name:"line",type:"line"}};class _x{addSamplingCompile(){if(this._spec.sampling){let{width:t,height:e}=this._region.getLayoutRect(),i=this._fieldY,r=this._fieldX;this._data&&this._data.setTransform([{type:"dataSampling",size:"horizontal"===this._direction?e:t,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?r[0]:i[0],groupBy:this._seriesField,mode:this._spec.sampling}])}}addOverlapCompile(){var t;if(this._spec.markOverlap){let e=[];e.push({type:"symbolOverlap",direction:"horizontal"===this._direction&&"cartesian"===this.coordinate?2:1,delta:this._spec.pointDis,deltaMul:this._spec.pointDisMul,groupBy:this._seriesField}),null==(t=this._symbolMark)||t.setTransform(e)}}reCompileSampling(){this._spec.sampling&&this.compile()}initLineMark(t){return this._lineMark=this._createMark(_C.line,{groupKey:this._seriesField,isSeriesMark:null==t||t},{morphElementKey:this.getDimensionField()[0]}),this._lineMark}initLineMarkStyle(t,e){var i,r;let n=this._lineMark;if(n){if(this.setMarkStyle(n,{stroke:this.getColorAttribute()},"normal",to.Series),"zero"!==this._invalidType&&this.setMarkStyle(n,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",to.Series),this.event.on(J.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(n,"defined")}),"polar"===this.coordinate)this.setMarkStyle(n,{lineJoin:__,curveType:_b,closePath:!0},"normal",to.Series);else{let l=null!=e?e:null==(r=null==(i=this.getSpec().line)?void 0:i.style)?void 0:r.curveType;this.setMarkStyle(n,{curveType:l===_v?"horizontal"===t?"monotoneY":"monotoneX":l},"normal",to.Built_In)}this.setMarkStyle(n,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",to.Series)}return n}_getEventElement(t,e=!1){let i=[];return t.dimensionInfo.some(t=>(t.data.some(t=>t.series===this&&(i=t.datum,!0)),!i.length)),i}_dimensionTrigger(t){let e=this._getEventElement(t);switch(t.action){case"enter":this._symbolActiveMark.getDataView().parse(e),this._symbolActiveMark.getData().updateData(!1);break;case"leave":this._symbolActiveMark.getDataView().parse([]),this._symbolActiveMark.getData().updateData(!1)}}initSymbolMark(t){if(!1!==(this._spec.point||{}).visible&&(this._symbolMark=this._createMark(_C.point,{groupKey:this._seriesField,isSeriesMark:!!t},{morph:_h(this._spec,_C.point.name),morphElementKey:this.getDimensionField()[0]})),!0===this._spec.activePoint){let t=new eq.V(this._option.dataSet,{name:`${d9}_series_${this.id}_active_point`});t.parse([]),this._symbolActiveMark=this._createMark({name:`active_point_${this.id}`,type:"symbol"},{groupKey:this._seriesField,isSeriesMark:!1,dataView:t,parent:this._region.getInteractionMark()},{morph:!1}),this._symbolActiveMark.setVisible(!1)}return this._symbolMark}initSymbolMarkStyle(){let t=this._symbolMark;if(!t)return this._initSymbolActiveMarkAlone(),t;if(this._initSymbolMark(t),this._symbolActiveMark&&this._symbolMark.stateStyle.dimension_hover){for(let e in this._symbolActiveMark.setVisible(!0),this.event.on(tq.dimensionHover,this._dimensionTrigger.bind(this)),this._symbolMark.stateStyle)for(let i in this._symbolActiveMark.stateStyle[e]={},this._symbolMark.stateStyle[e])"visible"!==i&&(this._symbolActiveMark.stateStyle[e][i]={style:null,level:to.Series,referer:t});this._symbolActiveMark.state.changeStateInfo({stateValue:td.STATE_DIMENSION_HOVER,filter:()=>!0})}return t}_initSymbolMark(t){t&&(this.setMarkStyle(t,{fill:this.getColorAttribute()},"normal",to.Series),this.setMarkStyle(t,{x:t=>"zero"===this._invalidType||this._getInvalidDefined(t)?this.dataToPositionX(t):Number.NaN,y:t=>"zero"===this._invalidType||this._getInvalidDefined(t)?this.dataToPositionY(t):Number.NaN,z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",to.Series))}_initSymbolActiveMarkAlone(){var t,e;let i=this._symbolActiveMark;i&&(this._initSymbolMark(i),i&&(null==(e=null==(t=this._spec[_C.point.name])?void 0:t.state)?void 0:e.dimension_hover)&&(i.setVisible(!0),this.event.on(tq.dimensionHover,this._dimensionTrigger.bind(this)),this.initMarkStyleWithSpec(i,h5({},this._spec[_C.point.name],{visible:!0})),this._symbolActiveMark.state.changeStateInfo({stateValue:td.STATE_DIMENSION_HOVER,filter:()=>!0})))}initLabelMarkStyle(t){var e;t&&("symbol"!==(null==(e=t.getTarget())?void 0:e.type)&&t.setRule("line-data"),this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null}),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},"normal",to.Series),this.event.on(J.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(t,"visible")}))}initLineLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>{var e;return null!=(e=t[this.getSeriesField()])?e:this.getSeriesKeys()[0]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})}encodeDefined(t,e){var i,r,n,l;if(!t)return;let s=this._isFieldAllValid();if("zero"===this._invalidType||s){if(!0===(null==(r=null==(i=t.stateStyle.normal)?void 0:i[e])?void 0:r.style))return;this.setMarkStyle(t,{[e]:!0},"normal",to.Series)}else{if(!0!==(null==(l=null==(n=t.stateStyle.normal)?void 0:n[e])?void 0:l.style))return;this.setMarkStyle(t,{[e]:this._getInvalidDefined.bind(this)},"normal",to.Series)}t.compileEncode()}_isFieldAllValid(){let t=this.getViewDataStatistics(),e=this.getStackValueField();return!!(t&&t.latestData&&e)&&t.latestData[e]&&t.latestData[e].allValid}}let _w=Object.assign(Object.assign({},b7),_C),_S=(t,e)=>{var i,r;if(t===e)return!0;let n=null!=(i=t&&t.length)?i:0;return n===(null!=(r=e&&e.length)?r:0)&&0!==n&&t.every((t,i)=>!t&&!e[i]||t&&e[i]&&t.color===e[i].color&&t.offset===e[i].offset)},_A=(t,e)=>{if(t===e)return!0;if(typeof t!=typeof e||(0,nI.Z)(t))return!1;if((0,rD.Z)(t))return t.length===e.length&&t.every((t,i)=>_A(t,e[i]));if(t.gradient!==e.gradient)return!1;let i=Object.keys(t),r=Object.keys(e);return i.length===r.length&&i.every(i=>"stops"===i?_S(t[i],e[i]):t[i]===e[i])},_M=(t,e)=>t.length===e.length&&t.join("-")===e.join("-"),_T=(t,e,i)=>!(!(0,nB.Z)(t)||!(0,nB.Z)(e))||!(0,nB.Z)(t)&&!(0,nB.Z)(e)&&("lineDash"===i?_M(t,e):"stroke"===i||"fill"===i?_A(t,e):t===e),_k=["stroke","strokeOpacity","lineDash","lineDashOffset","lineCap","lineJoin","lineWidth","miterLimit"];class _R extends gW{constructor(){super(...arguments),this._segmentStyleKeys=[],this._isValidPointChannel=t=>["x","y","defined"].includes(t)}_getSegmentAttributes(){return _k}initStyleWithSpec(t){this._segmentStyleKeys=[],super.initStyleWithSpec(t)}setStyle(t,e="normal",i=0){if((0,nB.Z)(t))return;void 0===this.stateStyle[e]&&(this.stateStyle[e]={});let r=this._getIgnoreAttributes(),n=this._getSegmentAttributes(),l=this.isUserLevel(i);Object.keys(t).forEach(s=>{let a=t[s];if((0,nB.Z)(a)||r.includes(s))return;l&&n.includes(s)&&((0,pW.dx)(null==a?void 0:a.type)||(null==a?void 0:a.scale)||(0,nz.Z)(a))&&(this._segmentStyleKeys.includes(s)||this._segmentStyleKeys.push(s));let o=this._filterAttribute(s,a,e,i,l);this.setAttribute(s,o,e,i)})}_getLineSegments(t,e){if(!this._segmentStyleKeys||!this._segmentStyleKeys.length)return null;let i=[],r=null;return t.forEach((t,e)=>{r&&this._segmentStyleKeys.every(e=>_T(r[e],t[e],e))||(i.length&&(i[i.length-1].endIndex=e),r=t,i.push({attrs:r,startIndex:e}))}),i.length>=2?i.map(t=>Object.assign(Object.assign({},t.attrs),{points:e.slice(t.startIndex,(0,nB.Z)(t.endIndex)?e.length:t.endIndex)})):null}_getPrevPoints(t){let{points:e,segments:i}=t.attribute;return null!=e?e:i?i.reduce((t,e)=>(e.points&&e.points.forEach(e=>{t.push(e)}),t),[]):null}_runPointsEncoder(t,e,i={}){var r,n,l;let s=e.context.data,a=[],o=[],h={},d=null==(r=this.renderContext)?void 0:r.progressive,u=d&&0===d.currentIndex;if(s.forEach((e,i)=>{var r;o[i]={},a[i]={},Object.keys(t).forEach(r=>{this._isValidPointChannel(r)?o[i][r]=t[r](e):this._segmentStyleKeys.includes(r)&&!d?a[i][r]=t[r](e):0!==i||d&&!u||(h[r]=t[r](e))}),o[i].context=null!=(r=this._keyGetter(e))?r:i}),d){let t=null!=(l=null==(n=e.attribute)?void 0:n.segments)?l:[];return t.push({points:o}),u?Object.assign(Object.assign({},h),{segments:t}):{segments:t}}if(this._segmentStyleKeys&&this._segmentStyleKeys.length){let t=this._getLineSegments(a,o);if(t)return Object.assign(Object.assign(Object.assign({},h),a[0]),{segments:t,points:null})}return Object.assign(Object.assign(Object.assign({},h),a[0]),{points:o,segments:null})}_runEncoderOfGraphic(t,e,i={}){let r=e.context.data;return t&&Object.keys(t).some(this._isValidPointChannel)&&r&&r.length?this._runPointsEncoder(t,e,i):super._runEncoderOfGraphic(t,e,i)}_getDataByKey(t){return this._dataByGroup}_runProgressiveJoin(){let t=this.renderContext.progressive.currentIndex,e=[];this._dataByGroup.keys.forEach((i,r)=>{let n=this.renderContext.progressive.groupedData.get(i),l=this.renderContext.progressive.step,s=n.slice(t*l,(t+1)*l);if(0===t){let t={context:Object.assign(Object.assign({},this._getCommonContext()),{diffState:th.enter,data:s,uniqueKey:i,key:i,groupKey:i})};e.push(t)}else this._graphics[r].context.data=s});let i=0===t?e:this._graphics;return{graphicsByGroup:{[un]:i},graphics:i,needUpdate:!1}}_setCommonAttributesToTheme(t){}_addProgressiveGraphic(t,e){e.incremental=1,t.appendChild(e)}}let _P=["segments","points","curveType","curveTension",...sO];class _B extends sN{constructor(t={}){super(t),this.type="line",this.numberType=so}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;let{points:t,segments:e}=this.attribute;return e?0!==e.length:!!t&&!(t.length<=1)}_interpolate(t,e,i,r,n){"points"===t&&(n.points=nQ(i,r,e))}getGraphicTheme(){return nP(this).line}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i):this.updateLineAABBBoundsByPoints(t,e,i)),iC.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;let{lineJoin:r=e.lineJoin}=t;return iC.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}updateLineAABBBoundsByPoints(t,e,i,r){let{points:n=e.points,connectedType:l}=t;return n.forEach(t=>{!1===t.defined&&"connect"!==l||i.add(t.x,t.y)}),i}updateLineAABBBoundsBySegments(t,e,i,r){let{segments:n=e.segments,connectedType:l}=t;return n.forEach(t=>{t.points.forEach(t=>{!1===t.defined&&"connect"!==l||i.add(t.x,t.y)})}),i}needUpdateTags(t){return super.needUpdateTags(t,_P)}needUpdateTag(t){return super.needUpdateTag(t,_P)}toCustomPath(){let t=super.toCustomPath();if(t)return t;let e=this.attribute;t=new rp;let i=e.segments,r=e=>{if(e&&e.length){let i=!0;e.forEach(e=>{!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),i=!1)})}};return i&&i.length?i.forEach(t=>{r(t.points)}):e.points&&r(e.points),t}clone(){return new _B(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return _B.NOWORK_ANIMATE_ATTR}}function _I(t){return new _B(t)}_B.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},sZ);let _E=!1,_L=new eQ(t=>{_E||(_E=!0,t(oM).toSelf().inSingletonScope(),t(oT).toSelf().inSingletonScope(),t(s7).to(oM).inSingletonScope(),t(s4).toService(s7))});class _F extends ox{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;r.highPerformanceSave();let n=t.getGraphicTheme(),{x:l,y:s,z:a,lastModelMatrix:o}=this.transform(t,n,r),h=e;if(r.camera){h=e.clone();let i=t.parent.globalTransMatrix;h.x=i.a*e.x+i.c*e.y+i.e,h.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=a;let d=!1;return this.canvasRenderer.drawShape(t,r,l,s,{},null,t=>!!d||(d=t.isPointInPath(h.x,h.y)),(t,e,i)=>{if(d)return!0;let n=e.lineWidth||i.lineWidth,l=e.pickStrokeBuffer||i.pickStrokeBuffer;return r.lineWidth=e.keepStrokeScale||i.keepStrokeScale?n+l:rZ(r,n+l,r.dpr),d=t.isPointInStroke(h.x,h.y)}),this.canvasRenderer.z=0,r.modelMatrix!==o&&sP.free(r.modelMatrix),r.modelMatrix=o,r.highPerformanceRestore(),d}}let _O=class extends _F{constructor(t){super(),this.canvasRenderer=t,this.type="line",this.numberType=so}};_O=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tE=it(s7),function(t,e){tE(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],_O);let _H=!1,_D=new eQ((t,e,i,r)=>{_H||(_H=!0,t(cn).to(_O).inSingletonScope(),t(cf).toService(cn))});function _z(){_z.__loaded||(_z.__loaded=!0,ak.RegisterGraphicCreator("line",_I),ib.load(_L),ib.load(u$?_D:fQ))}_z.__loaded=!1;let _W=_z;var _Z=i(56874);let _N=["#ffffff","#000000"];function _j(t,e,i,r,n,l){if("string"!=typeof t||"string"!=typeof e)return t;let s=new hj.Il(t).toHex(),a=new hj.Il(e).toHex();return _G(s,a,i,r,l)?s:function(t,e,i,r,n,l){let s=[];for(let a of(n&&(n instanceof Array?s.push(...n):s.push(n)),s.push(..._N),s))if(t!==a&&_G(a,e,i,r,l))return a}(s,a,i,r,n,l)}function _G(t,e,i,r,n){if("lightness"===n){let i=hj.Il.getColorBrightness(new hj.Il(e));return .5>hj.Il.getColorBrightness(new hj.Il(t))?i>=.5:i<.5}return r?_V(t,e)>r:"largeText"===i?_V(t,e)>3:_V(t,e)>4.5}function _V(t,e){let i=_U(t),r=_U(e);return((i>r?i:r)+.05)/((i>r?r:i)+.05)}function _U(t){let e=(0,_Z.Z)(t),i=e[0]/255,r=e[1]/255,n=e[2]/255;return .2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))}function _K(t,e,i,r){let n;switch(t){case"base":n=e;break;case"invertBase":n=i;break;case"similarBase":n=r}return n}function _X(t,e){t.forEachChildren(t=>{let i=e(t);t.isContainer&&!i&&_X(t,e)})}let _Y=t=>!(0,nB.Z)(t)&&!1!==t.visible;function _$(t){return t>=0&&t<Math.PI/2||t>3*Math.PI/2&&t<=2*Math.PI}function _q(t,e,i){return Math.abs(t-e)<i}function _J(t,e,i){return t?{textAlign:"right",textBaseline:"middle"}:{textAlign:e<Math.PI&&i.toLocaleLowerCase().includes("top")||e>Math.PI&&i.toLocaleLowerCase().includes("bottom")?"left":e<Math.PI&&i.toLocaleLowerCase().includes("bottom")||e>Math.PI&&i.toLocaleLowerCase().includes("top")?"right":"center",textBaseline:e<Math.PI&&i.includes("inside")||e>Math.PI&&!i.includes("inside")?"bottom":"top"}}let _Q=new Uint32Array(33),_0=new Uint32Array(33);_0[0]=0,_Q[0]=~_0[0];for(let t=1;t<=32;++t)_0[t]=_0[t-1]<<1|1,_Q[t]=~_0[t];function _1(t,e,i={top:0,left:0,right:0,bottom:0}){let{top:r=0,left:n=0,right:l=0,bottom:s=0}=i,a=Math.max(1,Math.sqrt(t*e/1e6)),o=~~((t+n+l+a)/a),h=~~((e+r+s+a)/a),d=t=>~~(t/a);return d.bitmap=()=>(function(t,e){let i=new Uint32Array(~~((t*e+32)/32));return{array:i,get:(e,r)=>{let n=r*t+e;return i[n>>>5]&1<<(31&n)},set:(e,r)=>{let n=r*t+e;i[n>>>5]|=1<<(31&n)},clear:(e,r)=>{let n=r*t+e;i[n>>>5]&=~(1<<(31&n))},getRange:({x1:r,y1:n,x2:l,y2:s})=>{if(l<0||s<0||r>t||n>e)return!0;let a,o,h,d,u=s;for(;u>=n;--u)if(a=u*t+r,o=u*t+l,(h=a>>>5)==(d=o>>>5)){if(i[h]&_Q[31&a]&_0[1+(31&o)])return!0}else{if(i[h]&_Q[31&a]||i[d]&_0[1+(31&o)])return!0;for(let t=h+1;t<d;++t)if(i[t])return!0}return!1},setRange:({x1:r,y1:n,x2:l,y2:s})=>{var a,o,h,d;let u,c,p,g,f;if(!(l<0)&&!(s<0)&&!(r>t)&&!(n>e))for(;n<=s;++n)if(u=n*t+r,c=n*t+l,(p=u>>>5)==(g=c>>>5))a=_Q[31&u]&_0[1+(31&c)],i[p]|=a;else for(o=_Q[31&u],i[p]|=o,h=_0[1+(31&c)],i[g]|=h,f=p+1;f<g;++f)d=f,i[d]|=0xffffffff},clearRange:({x1:e,y1:r,x2:n,y2:l})=>{var s,a,o,h;let d,u,c,p,g;for(;r<=l;++r)if(d=r*t+e,u=r*t+n,(c=d>>>5)==(p=u>>>5))s=_0[31&d]|_Q[1+(31&u)],i[c]&=s;else for(a=_0[31&d],i[c]&=a,o=_Q[1+(31&u)],i[p]&=o,g=c+1;g<p;++g)h=g,i[h]&=0},outOfBounds:({x1:i,y1:r,x2:n,y2:l})=>i<0||r<0||l>=e||n>=t,toImageData:r=>{let n=r.createImageData(t,e),l=n.data;for(let r=0;r<e;++r)for(let e=0;e<t;++e){let n=r*t+e,s=4*n,a=i[n>>>5]&1<<(31&n);l[s+0]=255*a,l[s+1]=255*a,l[s+2]=255*a,l[s+3]=31}return n}}})(o,h),d.x=t=>~~((t+n)/a),d.y=t=>~~((t+r)/a),d.ratio=a,d.padding=i,d.width=t,d.height=e,d}function _2(t,e){let{x1:i,x2:r,y1:n,y2:l}=e,{top:s=0,left:a=0,right:o=0,bottom:h=0}=t.padding,d=(0,yj.Z)(i,-a,t.width+o),u=(0,yj.Z)(r,-a,t.width+o),c=(0,yj.Z)(n,-s,t.height+h),p=(0,yj.Z)(l,-s,t.height+h);return{x1:t.x(d),x2:t.x(u),y1:t.y(c),y2:t.y(p)}}function _3(t,e,i=!1){return i?_2(t,e):{x1:t.x(e.x1),x2:t.x(e.x2),y1:t.y(e.y1),y2:t.y(e.y2)}}function _5(t,e,i,r=!0,n=0){let l=i;n>0&&(l={x1:i.x1-n,x2:i.x2+n,y1:i.y1-n,y2:i.y2+n}),l=_3(t,l);let s=e.outOfBounds(l);return(!r||!s)&&(s&&(l=_2(t,l)),!e.getRange(l))}function _4(t,e,i,r=[],n=!0,l=0,s=!1){var a,o,h,d;let u,c=r.filter(t=>(0,aw.Z)(t)),p=null!=(a=i.attribute.x)?a:0,g=null!=(o=i.attribute.y)?o:0,f=i.AABBBounds,m={x1:f.x1,x2:f.x2,y1:f.y1,y2:f.y2};for(let i=0;i<c.length;i++){let r=c[i];u=r;let s=(null!=(h=r.x)?h:p)-p,a=(null!=(d=r.y)?d:g)-g;if(m.x1=f.x1+s,m.x2=f.x2+s,m.y1=f.y1+a,m.y2=f.y2+a,_5(t,e,m,n,l))return e.setRange(_3(t,m,!0)),r}return s&&u&&i.setAttributes(u),!1}let _6=["top","bottom","right","left","top-right","bottom-right","top-left","bottom-left"],_7=["top","inside-top","inside"];function _8(t,e,i,r={}){let{x1:n,x2:l,y1:s,y2:a}=t.AABBBounds,{top:o=0,left:h=0,right:d=0,bottom:u=0}=r,c=Math.min(n,l),p=Math.max(n,l),g=Math.min(s,a),f=Math.max(s,a),m=e+d,y=i+u,v=0,b=0;return c<0-h?v=-c:p>m&&(v=m-p),g<0-o?b=-g:f>y&&(b=y-f),{dx:v,dy:b}}let _9={mode:"same-time",duration:300,easing:"linear"};function Ct(t){return 3===t||4===t}let Ce=(t,e,i="top",r=0)=>{if(!t)return;let{x1:n,y1:l,x2:s,y2:a}=t,o=Math.abs(s-n),h=Math.abs(a-l),d=(e.x1+e.x2)/2,u=(e.y1+e.y2)/2,c=0,p=0,g=0,f=0;e&&(g=Math.abs(e.x1-e.x2)/2,f=Math.abs(e.y1-e.y2)/2);let m={"top-right":-235,"top-left":235,"bottom-right":45,"bottom-left":-45};switch(i){case"top":p=-1;break;case"bottom":p=1;break;case"left":c=-1;break;case"right":c=1;break;case"bottom-left":case"bottom-right":case"top-left":case"top-right":c=Math.sin(m[i]*(Math.PI/180)),p=Math.cos(m[i]*(Math.PI/180));break;case"center":c=0,p=0}return{x:d+c*(r+g)+o/2*Math.sign(c),y:u+p*(r+f)+h/2*Math.sign(p)}},Ci=t=>{if(!t||!t.attribute)return[];let{points:e,segments:i}=t.attribute;if(i&&i.length){let t=[];return i.forEach(e=>{e.points.forEach(e=>{t.push(e)})}),t}return e};function Cr(t,e,i,r,n,l){return Math.abs(e/t)<l/n?{x:i+(t>0?n:-n),y:r+e*n/Math.abs(t)}:{x:i+t*l/Math.abs(e),y:r+(e>0?l:-l)}}class Cn{constructor(t,e,i,r,n,l,s,a,o,h,d,u,c,p){this.left=t,this.top=e,this.width=i,this.height=r,this.actualHeight=0,this.bottom=e+r,this.right=t+i,this.ellipsis=n,this.wordBreak=l,this.verticalDirection=s,this.lines=[],this.globalAlign=a,this.globalBaseline=o,this.layoutDirection=h,this.directionKey=rj[this.layoutDirection],this.isWidthMax=d,this.isHeightMax=u,this.singleLine=c,p?(p.clear(),this.icons=p):this.icons=new Map}draw(t,e){let{width:i,height:r}=this.getActualSize(),n=this.isWidthMax?Math.min(this.width,i):this.width||i||0,l=this.isHeightMax?Math.min(this.height,r):this.height||r||0;l=Math.min(l,r);let s=0;switch(this.globalBaseline){case"top":s=0;break;case"middle":s=-l/2;break;case"bottom":s=-l}let a=0;"right"===this.globalAlign||"end"===this.globalAlign?a=-n:"center"===this.globalAlign&&(a=-n/2);let o=this[this.directionKey.height];this.singleLine&&(o=this.lines[0].height+1);let h=!1;if("middle"===this.verticalDirection)if(this.actualHeight>=o&&0!==o)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i];if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+o)break;let l=!1;this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+o&&(l=!0,h=!0),this.lines[i].draw(t,l,this.lines[i][this.directionKey.left]+a,this.lines[i][this.directionKey.top]+s,this.ellipsis,e)}else{let i=Math.floor((o-this.actualHeight)/2);"vertical"===this.layoutDirection?a+=i:s+=i;for(let i=0;i<this.lines.length;i++)this.lines[i].draw(t,!1,this.lines[i][this.directionKey.left]+a,this.lines[i][this.directionKey.top]+s,this.ellipsis,e)}else if("bottom"===this.verticalDirection&&"vertical"!==this.layoutDirection)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i],l=o-this.lines[i].top-this.lines[i].height;if(0===o)this.lines[i].draw(t,!1,a,l+s,this.ellipsis,e);else{if(l+n>this[this.directionKey.top]+o||l<this[this.directionKey.top])return h;{let r=!1;this.ellipsis&&this.lines[i+1]&&l-this.lines[i+1].height<this[this.directionKey.top]&&(r=!0,h=!0),this.lines[i].draw(t,r,a,l+s,this.ellipsis,e)}}}else{"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&this.singleLine&&this.isWidthMax&&(a+=this.lines[0].height+1);for(let i=0;i<this.lines.length;i++){"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&(a-=this.lines[i].height+this.lines[i].top);let{top:r,height:n}=this.lines[i];if(0===o)this.lines[i].draw(t,!1,this.lines[i][this.directionKey.left]+a,this.lines[i][this.directionKey.top]+s,this.ellipsis,e);else{if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+o)return h;{let r=!1;this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+o&&(r=!0,h=!0),this.lines[i].draw(t,r,this.lines[i][this.directionKey.left]+a,this.lines[i][this.directionKey.top]+s,this.ellipsis,e)}}}}return h}getActualSize(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}getRawActualSize(){let t=0,e=0;for(let i=0;i<this.lines.length;i++){let r=this.lines[i];r.actualWidth>t&&(t=r.actualWidth),e+=r.height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}getActualSizeWidthEllipsis(){let t=0,e=0,{width:i,height:r}=this.getRawActualSize();this.width;let n=this.height||r||0;n=Math.min(n,r);let l=this[this.directionKey.height];if(this.singleLine&&(l=this.lines[0].height+1),"middle"===this.verticalDirection)if(this.actualHeight>=l&&0!==l)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i];if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+l);else if(this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+l){let r=!0===this.ellipsis?"...":this.ellipsis||"",n=this.lines[i].getWidthWithEllips(r);n>t&&(t=n),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else{this.actualHeight;for(let i=0;i<this.lines.length;i++)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else if("bottom"===this.verticalDirection)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i],s=l-this.lines[i].top-this.lines[i].height;if(0===l)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height;else if(s+n>this[this.directionKey.top]+l||s<this[this.directionKey.top]);else if(this.ellipsis&&this.lines[i+1]&&s-this.lines[i+1].height<this[this.directionKey.top]){let r=!0===this.ellipsis?"...":this.ellipsis||"",n=this.lines[i].getWidthWithEllips(r);n>t&&(t=n),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i];if(0===l)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height;else if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+l);else if(this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+l){let r=!0===this.ellipsis?"...":this.ellipsis||"",n=this.lines[i].getWidthWithEllips(r);n>t&&(t=n),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}}function Cl(t,e,i,r){let n=Math.round(t),l=Math.round(i),s=Math.round(e),a=Math.round(r);return{left:t>n?n:n-.5,top:i>l?l:l-.5,right:s>e?s:s+.5,bottom:a>r?a:a+.5}}class Cs{constructor(t,e,i,r){var n,l;this.fontSize=i.fontSize||16,this.textBaseline=i.textBaseline||"alphabetic",this.ascentDescentMode=r;let s=n5(i.lineHeight,this.fontSize);this.lineHeight="number"==typeof s?s>this.fontSize?s:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;let{ascent:a,height:o,descent:h,width:d}=rq(t,i,this.ascentDescentMode),u=0,c=0,p=0;this.height>o&&(c=Math.ceil(u=(this.height-o)/2),p=Math.floor(u)),"top"===this.textBaseline?(this.ascent=u,this.descent=o-u):"bottom"===this.textBaseline?(this.ascent=o-u,this.descent=u):"middle"===this.textBaseline?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=a+c,this.descent=h+p),this.length=t.length,this.width=d||0,this.text=t||"",this.newLine=e||!1,this.character=i,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,this.space=i.space,this.dx=null!=(n=i.dx)?n:0,this.dy=null!=(l=i.dy)?l:0,"vertical"===i.direction&&(this.direction=i.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}updateWidth(){let{width:t}=rq(this.text,this.character,this.ascentDescentMode);this.width=t,"vertical"===this.direction&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}drawBackground(t,e,i,r,n,l,s){if(""===this.text||"\n"===this.text||!this.character.background||this.character.backgroundOpacity&&!(this.character.backgroundOpacity>0))return;let a=e+i,o=this.text,h=this.left+r;a+=this.top;let d=this.direction;if(this.verticalEllipsis)o=this.ellipsisStr,d="vertical",a-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)o+=this.ellipsisStr,"right"!==l&&"end"!==l||(h-=this.ellipsisWidth);else if("replace"===this.ellipsis){let t=rY(o,("vertical"===d?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,o.length-1);if(o=o.slice(0,t)+this.ellipsisStr,"right"===l||"end"===l)if("vertical"===d);else{let{width:e}=rq(this.text.slice(t),this.character,this.ascentDescentMode);h-=this.ellipsisWidth-e}}}return Object.assign(Object.assign({},Cl(h,h+(this.widthOrigin||this.width),e,e+s)),{fillStyle:this.character.background,globalAlpha:this.character.backgroundOpacity})}draw(t,e,i,r,n,l,s){var a;let o=e+i,h=this.text,d=this.left+r+(null!=(a=this.space)?a:0)/2;o+=this.top;let u=this.direction;if(this.verticalEllipsis)h=this.ellipsisStr,u="vertical",o-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)h+=this.ellipsisStr,"right"!==l&&"end"!==l||(d-=this.ellipsisWidth);else if("replace"===this.ellipsis){let t=rY(h,("vertical"===u?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,h.length-1);if(h=h.slice(0,t)+this.ellipsisStr,"right"===l||"end"===l)if("vertical"===u);else{let{width:e}=rq(this.text.slice(t),this.character,this.ascentDescentMode);d-=this.ellipsisWidth-e}}}switch(this.character.script){case"super":o-=this.ascent*(1/3);break;case"sub":o+=this.descent/2}"vertical"===u&&(t.save(),t.rotateAbout(Math.PI/2,d,o),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(d,o),d=0,o=0);let{lineWidth:c=1}=this.character;if(this.character.stroke&&c&&t.strokeText(h,d+this.dx,o+this.dy),this.character.fill&&t.fillText(h,d+this.dx,o+this.dy),this.character.fill){if(this.character.lineThrough||this.character.underline){if(this.character.underline){let e=1+o,i=Cl(d,d+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+o,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}if(this.character.lineThrough){let e=1+o-this.ascent/2,i=Cl(d,d+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+o-this.ascent/2,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}else if("underline"===this.character.textDecoration){let e=1+o,i=Cl(d,d+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+o,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}else if("line-through"===this.character.textDecoration){let e=1+o-this.ascent/2,i=Cl(d,d+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+o-this.ascent/2,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}"vertical"===u&&t.restore()}getWidthWithEllips(t){let e=this.text,i="vertical"===t?this.height:this.width;if("hide"===this.ellipsis)return i;if("add"===this.ellipsis)return i+this.ellipsisWidth;if("replace"===this.ellipsis){let t=rY(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,t)+this.ellipsisStr;let{width:r}=rq(this.text.slice(t),this.character,this.ascentDescentMode);return i+this.ellipsisWidth-r}return i}}let Ca=["width","height","image",...sO];class Co extends sN{constructor(t){super(t),this.type="image",this.numberType=sa,this.loadImage(this.attribute.image)}getImageElement(){let{image:t}=this.attribute;if(!t||!this.resources)return null;let e=this.resources.get(t);return"success"!==e.state?null:e.data}get width(){return this.tryUpdateAABBBounds(),this._actualWidth}get height(){return this.tryUpdateAABBBounds(),this._actualHeight}get repeatX(){var t;return null!=(t=this.attribute.repeatX)?t:"no-repeat"}set repeatX(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}get repeatY(){var t;return null!=(t=this.attribute.repeatY)?t:"no-repeat"}set repeatY(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}get image(){return this.attribute.image}set image(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}imageLoadSuccess(t,e,i){super.imageLoadSuccess(t,e,()=>{this.successCallback&&this.successCallback()}),this.addUpdateBoundTag()}imageLoadFail(t,e){super.imageLoadFail(t,()=>{this.failCallback&&this.failCallback()})}setAttributes(t,e,i){return t.image&&this.loadImage(t.image),super.setAttributes(t,e,i)}setAttribute(t,e,i,r){return"image"===t&&this.loadImage(e),super.setAttribute(t,e,i,r)}getGraphicTheme(){return nP(this).image}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let{maxWidth:r=e.maxWidth,maxHeight:n=e.maxHeight}=t,{width:l,height:s}=t;if(null==l||null==s){let t=this.getImageElement();if(t){let e=t.width,i=t.height;if(null!=l)s=i/e*l;else if(null!=s)l=e/i*s;else{let t=e/i;t>r/n?(l=r,s=r/t):(s=n,l=n*t)}}else l=r,s=n}this._actualWidth=l,this._actualHeight=s,i.set(0,0,l,s)}let{tb1:r,tb2:n}=iC.graphicService.updateTempAABBBounds(i);return cz(t,e,r),i.union(r),r.setValue(n.x1,n.y1,n.x2,n.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,iC.graphicService.transformAABBBounds(t,i,e,!1,this),i}getDefaultAttribute(t){return rO[t]}needUpdateTags(t){return super.needUpdateTags(t,Ca)}needUpdateTag(t){return super.needUpdateTag(t,Ca)}clone(){return new Co(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Co.NOWORK_ANIMATE_ATTR}}function Ch(t){return new Co(t)}Co.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},sZ);class Cd extends Co{constructor(t){if(super(t),this._x=0,this._y=0,this._hovered=!1,this._marginArray=[0,0,0,0],"always"===t.backgroundShowMode&&(this._hovered=!0),t.margin){let e=nX(t.margin);this._marginArray="number"==typeof e?[e,e,e,e]:e}this.onBeforeAttributeUpdate=(t,e,i)=>{if((0,rD.Z)(i)&&-1!==i.indexOf("margin")||"margin"===i)if(e.margin){let t=nX(e.margin);this._marginArray="number"==typeof t?[t,t,t,t]:t}else this._marginArray=[0,0,0,0]}}get width(){var t;return(null!=(t=this.attribute.width)?t:0)+this._marginArray[1]+this._marginArray[3]}get height(){var t;return(null!=(t=this.attribute.height)?t:0)+this._marginArray[0]+this._marginArray[2]}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();let{width:t=rO.width,height:e=rO.height}=this.attribute,{backgroundWidth:i=t,backgroundHeight:r=e}=this.attribute;return this._AABBBounds.expand([0,(i-t)/2*2,(r-e)/2*2,0]),this._AABBBounds}setHoverState(t){"hover"===this.attribute.backgroundShowMode&&this._hovered!==t&&(this._hovered=t)}}class Cu{constructor(t,e,i,r,n,l,s,a){this.left=t,this.width=e,this.baseline=i,this.ascent=r,this.descent=n,this.top=i-r,this.paragraphs=l.map(t=>t),this.textAlign=(this.paragraphs[0]instanceof Cd?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=s,this.directionKey=rj[this.direction],this.actualWidth=0;let o=0;this.paragraphs.forEach((t,e)=>{if(0===e&&t instanceof Cs){let e=rK.exec(t.text);0!==(null==e?void 0:e.index)&&(t.text=t.text.slice(null==e?void 0:e.index),t.updateWidth())}this.actualWidth+=t[this.directionKey.width],o=Math.max(t[this.directionKey.height],o)}),this.height=o,this.blankWidth=a?0:this.width-this.actualWidth,this.calcOffset(e,a)}calcOffset(t,e){let i=this.directionKey,r=this.height,n=this.left,l=0;this.actualWidth<t&&!e&&("right"===this.textAlign||"end"===this.textAlign?n=t-this.actualWidth:"center"===this.textAlign?n=(t-this.actualWidth)/2:"justify"===this.textAlign&&(this.paragraphs.length<2?n=(t-this.actualWidth)/2:l=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map(function(t){t instanceof Cd?(t["_"+i.x]=n,n+=t[i.width]+l,t["_"+i.y]="top"===t.attribute.textBaseline?0:"bottom"===t.attribute.textBaseline?r-t.height:(r-t.height)/2):(t[i.left]=n,n+=t[i.width]+l)})}draw(t,e,i,r,n,l){if(n&&(e||this.paragraphs.some(t=>t.overflow))){let t=!0,i=!1;for(let e=this.paragraphs.length-1;e>=0;e--){let r=this.paragraphs[e];if(r.overflow)t=t&&""===r.text;else if(t){i=!0;break}}let r=0;if(!i)for(let t=this.paragraphs.length-1;t>=0;t--){let i=this.paragraphs[t];if(i.overflow){if(""===i.text)break;continue}if(i instanceof Cd)break;if("vertical"===this.direction&&"vertical"!==i.direction){i.verticalEllipsis=!0;break}let l=!0===n?"...":n||"";i.ellipsisStr=l;let{width:s}=rq(l,i.character,i.ascentDescentMode),a=s||0;if(a<=this.blankWidth+r){e&&(i.ellipsis="add");break}if(a<=this.blankWidth+r+i.width){i.ellipsis="replace",i.ellipsisWidth=a,i.ellipsisOtherParagraphWidth=this.blankWidth+r;break}i.ellipsis="hide",r+=i.width}}let s="",a=-1,o=[],h=[o];this.paragraphs.forEach((e,n)=>{if(e instanceof Cd)return;let l=e.drawBackground(t,r,this.ascent,i,0===n,this.textAlign,this.height);l&&(s===l.fillStyle&&a===l.globalAlpha||(o=[],h.push(o),s=l.fillStyle,a=l.globalAlpha),o.push(l))}),h.forEach(e=>{if(0===e.length)return;let i=e[0],r=e[e.length-1];t.fillStyle=i.fillStyle,t.globalAlpha=i.globalAlpha,t.fillRect(i.left,i.top,r.right-i.left,r.bottom-i.top)}),this.paragraphs.forEach((e,n)=>{if(e instanceof Cd)return e.setAttributes({x:i+e._x,y:r+e._y}),void l(e,t,i+e._x,r+e._y,this.ascent);let s={x1:this.left,y1:this.top,x2:this.left+this.actualWidth,y2:this.top+this.height};(function(t,e){let i=e&&e.stroke||rG.stroke;if(!i)return t.globalAlpha=0;let{strokeOpacity:r=1,opacity:n=1}=e;t.globalAlpha=r*n,t.lineWidth=e&&"number"==typeof e.lineWidth?e.lineWidth:1,t.strokeStyle=i,rX(t,e)})(t,e.character),function(t,e,i){let r=e&&e.fill||rG.fill;if(!r)return t.globalAlpha=0;let{fillOpacity:n=1,opacity:l=1}=e;t.globalAlpha=n*l,t.fillStyle=i?rN(t,r,{AABBBounds:i}):r,rX(t,e)}(t,e.character,s),e.draw(t,r,this.ascent,i,0===n,this.textAlign,this.height)})}getWidthWithEllips(t){let e=0;for(let i=this.paragraphs.length-1;i>=0;i--){let r=this.paragraphs[i];if(r instanceof Cd)break;let{width:n}=rq(t,r.character,r.ascentDescentMode),l=n||0;if(l<=this.blankWidth+e){r.ellipsis="add",r.ellipsisWidth=l;break}if(l<=this.blankWidth+e+r.width){r.ellipsis="replace",r.ellipsisWidth=l,r.ellipsisOtherParagraphWidth=this.blankWidth+e;break}r.ellipsis="hide",e+=r.width}let i=0;return this.paragraphs.forEach((t,e)=>{i+=t instanceof Cd?t.width:t.getWidthWithEllips(this.direction)}),i}}class Cc{constructor(t){this.frame=t,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=t.layoutDirection,this.directionKey=rj[this.direction]}store(t){if(t instanceof Cd){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];let e=0,i=0;"top"===t.attribute.textBaseline?(e=0,i=t.height):"bottom"===t.attribute.textBaseline?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),0!==t.text.length?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}send(){if(0===this.lineBuffer.length)return;let t=0===this.maxAscent?this.maxAscentForBlank:this.maxAscent,e=0===this.maxDescent?this.maxDescentForBlank:this.maxDescent,i=new Cu(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,"horizontal"===this.direction?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}deal(t,e=!1){t instanceof Cd?"horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):0===this.lineBuffer.length?(this.store(t),this.send()):(this.send(),this.deal(t)):"number"!=typeof this.width||this.width<0||(t.newLine&&this.send(),(0!==t.text.length||this.newLine)&&("horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t,e)))}cut(t,e){let i=this[this.directionKey.width]-this.lineWidth||0,r=Math.ceil(i/t[this.directionKey.width]*t.length)||0,n=rY(t.text,i,t.character,r,"break-word"===this.frame.wordBreak);if(0!==n){let[i,r]=function(t,e){let i=t.text.slice(0,e),r=t.text.slice(e);return[new Cs(i,t.newLine,t.character,t.ascentDescentMode),new Cs(r,!0,t.character,t.ascentDescentMode)]}(t,n);this.store(i),e?this.send():this.deal(r)}else 0!==this.lineBuffer.length&&(this.send(),this.deal(t))}}let Cp=!1;try{Cp=Intl&&"function"==typeof Intl.Segmenter}catch(t){Cp=!1}let Cg=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity",...sO];class Cf extends sN{constructor(t){super(t),this.type="richtext",this._currentHoverIcon=null,this.numberType=sg,this.onBeforeAttributeUpdate=(t,e,i)=>{for(let i in t)if("hoverIconId"===i){if(t[i]===e[i])continue;let r=this._frameCache.icons.get(t[i]);this.updateHoverIconState(r)}}}get width(){var t;return null!=(t=this.attribute.width)?t:rF.width}set width(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}get height(){var t;return null!=(t=this.attribute.height)?t:rF.height}set height(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}get maxWidth(){return this.attribute.maxWidth}set maxWidth(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}get maxHeight(){return this.attribute.maxHeight}set maxHeight(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}get ellipsis(){var t;return null!=(t=this.attribute.ellipsis)?t:rF.ellipsis}set ellipsis(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}get wordBreak(){var t;return null!=(t=this.attribute.wordBreak)?t:rF.wordBreak}set wordBreak(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}get verticalDirection(){var t;return null!=(t=this.attribute.verticalDirection)?t:rF.verticalDirection}set verticalDirection(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}get textAlign(){var t;return null!=(t=this.attribute.textAlign)?t:rF.textAlign}set textAlign(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}get textBaseline(){var t;return null!=(t=this.attribute.textBaseline)?t:rF.textBaseline}set textBaseline(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}get textConfig(){var t;return null!=(t=this.attribute.textConfig)?t:rF.textConfig}set textConfig(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}getGraphicTheme(){return nP(this).richtext}static AllSingleCharacter(t){return t.lines?t.lines.every(t=>t.paragraphs.every(t=>!(t.text&&(0,nI.Z)(t.text)&&Cf.splitText(t.text).length>1))):t.every(t=>t.isComposing||!(t.text&&(0,nI.Z)(t.text)&&Cf.splitText(t.text).length>1))}static splitText(t){if(Cp){let e=new Intl.Segmenter(void 0,{granularity:"grapheme"}),i=[];for(let{segment:r}of e.segment(t))i.push(r);return i}return Array.from(t)}static TransformTextConfig2SingleCharacter(t){let e=[];return t.forEach(t=>{let i=Cf.splitText(t.text.toString());if((0,nI.Z)(t.text)&&i.length>1)for(let r=0;r<i.length;r++){let n=i[r];e.push(Object.assign(Object.assign({},t),{text:n}))}else e.push(t)}),e}updateAABBBounds(t,e,i){var r,n,l,s;let{width:a=e.width,height:o=e.height,maxWidth:h=e.maxWidth,maxHeight:d=e.maxHeight,textAlign:u=e.textAlign,textBaseline:c=null!=(n=null!=(r=t.textBaseline)?r:e.textBaseline)?n:"top",editOptions:p}=t;if(a>0&&o>0)i.set(0,0,a,o);else{let{width:t,height:e}=this.getFrameCache().getActualSize(),r=a||t||0,n=o||e||0;n="number"==typeof d&&n>d?d:n||0,r="number"==typeof h&&r>h?h:r||0,i.set(0,0,r,n)}!p||!p.keepHeightWhileEmpty||i.height()||(null==(l=t.textConfig)?void 0:l.length)||(i.y2=i.y1+(null!=(s=t.fontSize)?s:12),i.x2=i.x1+2);let g=0;switch(c){case"top":g=0;break;case"middle":g=-i.height()/2;break;case"bottom":g=-i.height()}let f=0;switch(u){case"left":f=0;break;case"center":f=-i.width()/2;break;case"right":f=-i.width()}return o||("middle"===this.verticalDirection?g-=i.height()/2:"bottom"===this.verticalDirection&&(g-=i.height())),i.translate(f,g),iC.graphicService.updateTempAABBBounds(i),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||iC.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,iC.graphicService.transformAABBBounds(t,i,e,!1,this),0===i.width()&&0===i.height()&&i.clear(),i}needUpdateTags(t){return super.needUpdateTags(t,Cg)}needUpdateTag(t){return super.needUpdateTag(t,Cg)}getFrameCache(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}get cliped(){let t=this.getFrameCache();if(t.actualHeight>t.height)return!0;let{disableAutoWrapLine:e}=this.attribute;if(e)for(let e=0;e<t.lines.length;e++){let i=t.lines[e];for(let t=0;t<i.paragraphs.length;t++){let e=i.paragraphs[t];if(e.overflow&&""!==e.text)return!0}}return!1}combinedStyleToCharacter(t){let{fill:e,stroke:i,fontSize:r,fontFamily:n,fontStyle:l,fontWeight:s,lineWidth:a,opacity:o,fillOpacity:h,lineHeight:d,strokeOpacity:u,upgradeAttrs:c}=this.attribute,p=Object.assign({fill:e,stroke:i,fontSize:r,fontFamily:n,fontStyle:l,fontWeight:s,lineWidth:a,opacity:o,fillOpacity:h,strokeOpacity:u},t);return(null==c?void 0:c.lineHeight)&&(p.lineHeight=d),p}doUpdateFrameCache(t){var e;let{maxWidth:i,maxHeight:r,width:n,height:l,ellipsis:s,wordBreak:a,verticalDirection:o,textAlign:h,textBaseline:d,layoutDirection:u,singleLine:c,disableAutoWrapLine:p,editable:g,ascentDescentMode:f,upgradeAttrs:m}=this.attribute,y=m&&m.multiBreakLine,{textConfig:v=[]}=this.attribute;g&&v.length>0&&!Cf.AllSingleCharacter(v)&&(v=Cf.TransformTextConfig2SingleCharacter(v),this.attribute.textConfig=v);let b=[],_=null!=t?t:v;for(let t=0;t<_.length;t++)if("image"in _[t]){let e=this.combinedStyleToCharacter(_[t]);e.lineWidth=void 0;let i=e.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(e.id);if(i)b.push(i);else{let t=new Cd(e);t.successCallback=()=>{var t;this.addUpdateBoundTag(),null==(t=this.stage)||t.renderNextFrame()},t.richtextId=e.id,b.push(t)}}else{let e=this.combinedStyleToCharacter(_[t]);if((0,n4.Z)(e.text)&&(e.text=`${e.text}`),e.text&&e.text.includes("\n")){let i=e.text.split("\n");for(let r=0;r<i.length;r++)if(0===r)b.push(new Cs(i[r],!1,e,f));else if(i[r]||t===_.length-1)b.push(new Cs(i[r],!0,e,f));else{let e=this.combinedStyleToCharacter(_[t+1]);b.push(new Cs(i[r],!0,e,f))}}else e.text&&b.push(new Cs(e.text,!1,e,f))}let C="number"==typeof i&&Number.isFinite(i)&&i>0,x="number"==typeof r&&Number.isFinite(r)&&r>0,w="number"==typeof n&&Number.isFinite(n)&&n>0&&(!C||n<=i),S="number"==typeof l&&Number.isFinite(l)&&l>0&&(!x||l<=r),A=new Cn(0,0,(w?n:C?i:0)||0,(S?l:x?r:0)||0,s,a,o,h,d,u||"horizontal",!w&&C,!S&&x,c||!1,null==(e=this._frameCache)?void 0:e.icons),M=new Cc(A);if(M.newLine=y,p){let t=0,e=!1;for(let i=0;i<b.length;i++){let r=b[i];e?(r.overflow=!0,r.left=1/0,r.top=1/0,r.newLine||A.lines[A.lines.length-1].paragraphs.push(r)):M.deal(r,!0),A.lines.length!==t&&(t=A.lines.length,M.lineBuffer.length=0,r.overflow=!0,r.left=1e3,r.top=1e3,A.lines[A.lines.length-1].paragraphs.push(r),e=!0),r.newLine&&(e=!1,M.lineWidth=0),M.send()}}else for(let t=0;t<b.length;t++)M.deal(b[t]);if(M.send(),!("horizontal"===A.layoutDirection?w:S)){let t=A.getActualSizeWidthEllipsis(),e="horizontal"===A.layoutDirection?t.width:t.height;("horizontal"===A.layoutDirection?C:x)&&(e=Math.min(e,"horizontal"===A.layoutDirection?i:r)),A.lines.forEach(function(t){t.calcOffset(e,!1)})}y&&A.lines.forEach(t=>{let e=t.paragraphs;t.paragraphs=t.paragraphs.filter(t=>""!==t.text),0===t.paragraphs.length&&e.length&&(e[0].text="\n",t.paragraphs.push(e[0]))}),this._frameCache=A}clone(){return new Cf(Object.assign({},this.attribute))}setStage(t,e){super.setStage(t,e),this.getFrameCache().icons.forEach(i=>{i.setStage(t,e)})}bindIconEvent(){this.addEventListener("pointermove",t=>{let e=this.pickIcon(t.global);e&&e===this._currentHoverIcon||(e?this.setAttribute("hoverIconId",e.richtextId):!e&&this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0))}),this.addEventListener("pointerleave",t=>{this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0)})}updateHoverIconState(t){var e,i,r,n,l;t?(null==(e=this._currentHoverIcon)||e.setHoverState(!1),this._currentHoverIcon=t,this._currentHoverIcon.setHoverState(!0),null==(i=this.stage)||i.setCursor(t.attribute.cursor),null==(r=this.stage)||r.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,null==(n=this.stage)||n.setCursor(),null==(l=this.stage)||l.renderNextFrame())}pickIcon(t){let e,i=this.getFrameCache(),{e:r,f:n}=this.globalTransMatrix;return i.icons.forEach((i,l)=>{var s,a;let o=i.AABBBounds.clone();o.translate(i._marginArray[3],i._marginArray[0]),o.containsPoint({x:t.x-r,y:t.y-n})&&((e=i).globalX=(null!=(s=e.attribute.x)?s:0)+r+i._marginArray[3],e.globalY=(null!=(a=e.attribute.y)?a:0)+n+i._marginArray[0])}),e}getNoWorkAnimateAttr(){return Cf.NOWORK_ANIMATE_ATTR}}function Cm(t){return new Cf(t)}Cf.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},sZ);let Cy=class extends ox{constructor(){super(),this.numberType=sg,this.builtinContributions=[uV],this.init()}drawShape(t,e,i,r,n){let l=nP(t).richtext,{strokeOpacity:s=l.strokeOpacity,opacity:a=l.opacity,fillOpacity:o=l.fillOpacity,visible:h=l.visible}=t.attribute;if(!t.valid||!h)return;let d=a*o>0,u=a*s>0;d&&(e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),e.translate(i,r),this.beforeRenderStep(t,e,i,r,d,u,d,u,l,n),t.getFrameCache().draw(e,this.drawIcon),this.afterRenderStep(t,e,i,r,d,u,d,u,l,n))}drawIcon(t,e,i,r,n){var l;let s=nP(t).richtextIcon,{width:a=s.width,height:o=s.height,opacity:h=s.opacity,image:d,backgroundFill:u=s.backgroundFill,backgroundFillOpacity:c=s.backgroundFillOpacity,backgroundStroke:p=s.backgroundStroke,backgroundStrokeOpacity:g=s.backgroundStrokeOpacity,backgroundRadius:f=s.backgroundRadius,margin:m}=t.attribute,{backgroundWidth:y=a,backgroundHeight:v=o}=t.attribute;if(m&&(i+=t._marginArray[3],r+=t._marginArray[0]),t._hovered){let t=(y-a)/2,n=(v-o)/2;0===f?(e.beginPath(),e.rect(i-t,r-n,y,v)):(e.beginPath(),a3(e,i-t,r-n,y,v,f,!0)),u&&(e.globalAlpha=c,e.fillStyle=u,e.fill()),p&&(e.globalAlpha=g,e.strokeStyle=p,e.stroke())}let b=d&&(null==(l=null==t?void 0:t.resources)?void 0:l.get(d));b&&"success"===b.state&&(e.globalAlpha=h,e.drawImage(b.data,i,r,a,o))}draw(t,e,i){let r=nP(t).richtext;this._draw(t,r,!1,i)}};Cy=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],Cy);let Cv=!1,Cb=new eQ(t=>{Cv||(Cv=!0,t(an).to(Cy).inSingletonScope(),t(s4).toService(an))}),C_=class{constructor(t){this.canvasRenderer=t,this.type="richtext",this.numberType=sg}contains(t,e,i){return!!t.AABBBounds.containsPoint(e)}};C_=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tL=it(an),function(t,e){tL(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],C_);let CC=!1,Cx=new eQ((t,e,i,r)=>{CC||(CC=!0,t(cc).to(C_).inSingletonScope(),t(cf).toService(cc))});function Cw(){Cw.__loaded||(Cw.__loaded=!0,ak.RegisterGraphicCreator("richtext",Cm),ib.load(Cb),ib.load(u$?Cx:f7))}Cw.__loaded=!1;class CS{constructor(t){this.tasks=[],this.started=!1,this.completed=0,this.totalDuration=0,this.onStartCallbacks=[],this.onEndCallbacks=[],this.onUpdateCallbacks=[],this.component=t}animate(t,e){return this.started?console.warn("Cannot add animations after animation has started"):this.tasks.push({graphic:t,config:e}),this}onStart(t){return this.onStartCallbacks.push(t),this}onEnd(t){return this.onEndCallbacks.push(t),this}onUpdate(t){return this.onUpdateCallbacks.push(t),this}start(){return this.started?console.warn("Animation has already started"):(this.started=!0,this.completed=0,this.onStartCallbacks.forEach(t=>t()),0===this.tasks.length?setTimeout(()=>{this.onEndCallbacks.forEach(t=>t())},0):this.tasks.forEach(t=>{let e=new yv(t.graphic);e.onEnd(()=>{this.completed++,this.completed===this.tasks.length&&this.onEndCallbacks.forEach(t=>t())});let i=e.executeItem(t.config,t.graphic);t.animate=i,i.forEach(t=>{this.totalDuration=Math.max(this.totalDuration,t.getStartTime()+t.getDuration())})})),this}deleteSelfAttr(t){this.tasks.forEach(e=>{e.animate&&e.animate.forEach(e=>e.preventAttr(t))})}stop(t){return this.tasks.forEach(e=>{e.animate&&e.animate.forEach(e=>e.stop(t))}),this.started&&this.completed!==this.tasks.length&&(this.onEndCallbacks.forEach(t=>t()),this.completed=this.tasks.length),this}getDuration(){return this.totalDuration}}function CA(t){return new CS(t)}class CM extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.formatTemplate=null,this.decimalLength=null==n?void 0:n.decimalLength,(null==n?void 0:n.formatTemplate)&&n.formatTemplate.includes("{{var}}")&&(this.formatTemplate=n.formatTemplate)}onFirstRun(){var t,e,i;let r=this.getLastProps(),n=this.getEndProps(),l=null!=(t=r.text)?t:0,s=null!=(e=n.text)?e:0;this.valid=!0;let a=0,o=0,h="",d="",u=0;if("number"==typeof l)a=l,u=Math.max(u,(l.toString().split(".")[1]||"").length);else{if("string"!=typeof l)return void(this.valid=!1);if(l.endsWith("%")){h="%";let t=l.substring(0,l.length-1).replace(/,/g,"");if(isNaN(a=parseFloat(t)/100))return void(this.valid=!1);u=Math.max(u,(t.split(".")[1]||"").length+2)}else{let t=l.replace(/,/g,"");if(isNaN(a=parseFloat(t)))return void(this.valid=!1);l.includes(",")&&(h=","),u=Math.max(u,(t.split(".")[1]||"").length)}}if("number"==typeof s)o=s,u=Math.max(u,(s.toString().split(".")[1]||"").length);else{if("string"!=typeof s)return void(this.valid=!1);if(s.endsWith("%")){d="%";let t=s.substring(0,s.length-1).replace(/,/g,"");if(isNaN(o=parseFloat(t)/100))return void(this.valid=!1);u=Math.max(u,(t.split(".")[1]||"").length+2)}else{let t=s.replace(/,/g,"");if(isNaN(o=parseFloat(t)))return void(this.valid=!1);s.includes(",")&&(d=","),u=Math.max(u,(t.split(".")[1]||"").length)}}if(null==(i=this.params)?void 0:i.format){switch(this.params.format){case"percent":this.format="%";break;case"thousandth":this.format=",";break;case"none":this.format="";break;default:this.format=d||h}"%"===this.format&&"%"!==d&&"%"!==h&&void 0===this.decimalLength&&(this.decimalLength=2),"%"===this.format||"%"!==d&&"%"!==h||(a*=100,o*=100)}else this.format=d||h;this.fromNumber=a,this.toNumber=o,void 0===this.decimalLength&&(this.decimalLength=u)}onEnd(t){super.onEnd(t),t||this.props&&this.target.setAttributes(this.props)}onUpdate(t,e,i){if(!this.valid)return;let r=this.fromNumber+(this.toNumber-this.fromNumber)*e,n="",l=this.format,s=("%"===l?100*r:r).toFixed(this.decimalLength),a,o=s;if(parseFloat(s)===Math.floor(parseFloat(s))&&(o=Math.floor(parseFloat(s))),"%"===l)a=`${o}%`;else if(","===l){let t=o.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),a=t.join(".")}else a=o;n=this.formatTemplate?this.formatTemplate.replace("{{var}}",a.toString()):a,this.target.setAttribute("text",n)}}var CT=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let Ck=(t,e)=>Math.ceil(t)>Math.floor(e),CR=([t,e],[i,r])=>r>t&&e>i,CP=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"];class CB extends sj{constructor(t,e){super(t),this._skipRenderAttributes=CP,(null==e?void 0:e.mode)&&(this.mode=e.mode,this.setMode(e.mode)),(null==e?void 0:e.skipDefault)&&(this.skipDefault=!0),this.setTheme({common:{strokeBoundsBuffer:0}}),this.attribute=t,this.onSetStage(()=>{this.render(),this.bindEvents()})}setAttribute(t,e,i,r){let n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);if(n)return this._setAttributes(n,i);(0,hc.Z)(this.attribute[t])&&(0,hc.Z)(e)&&!(0,nz.Z)(this.attribute[t])&&!(0,nz.Z)(e)?(0,h3.Z)(this.attribute[t],e):this.attribute[t]=e,this._skipRenderAttributes.includes(t)||this.render(),this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(i||this.needUpdateTag(t))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}setAttributes(t,e,i){return t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t,this._setAttributes(t,e)}_setAttributes(t,e){let i=Object.keys(t);this._mergeAttributes(t,i),i.every(t=>this._skipRenderAttributes.includes(t))||this.render(),this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(e||this.needUpdateTags(i))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}_mergeAttributes(t,e){(0,nB.Z)(e)&&(e=Object.keys(t));for(let i=0;i<e.length;i++){let r=e[i];!(0,hc.Z)(this.attribute[r])||(0,nz.Z)(this.attribute[r])||(0,nz.Z)(t[r])?this.attribute[r]=t[r]:(0,h3.Z)(this.attribute[r],t[r])}}bindEvents(){}_getNodeId(t){var e;return`${null!=(e=this.id)?e:this._uid}-${this.name}-${t}`}_dispatchEvent(t,e){var i;let r=new nN(t,e);r.manager=null==(i=this.stage)?void 0:i.eventSystem.manager,this.dispatchEvent(r)}eventPosToStagePos(t){var e,i;let r={x:0,y:0},n=null!=(i=null==(e=this.stage)?void 0:e.eventPointTransform(t))?i:{x:0,y:0};return this.globalTransMatrix.transformPoint(n,r),r}}class CI extends CB{_prepareAnimate(t){if(!1!==this.attribute.animation){let{animation:e,animationEnter:i,animationExit:r,animationUpdate:n}=this.attribute,l=(0,nF.Z)(e)?e:{};this._animationConfig={enter:!1!==i&&(0,h3.Z)({},t,l,null!=i?i:{}),exit:!1!==r&&(0,h3.Z)({},t,l,null!=r?r:{}),update:!1!==n&&((0,rD.Z)(n)?n:(0,h3.Z)({},t,l,null!=n?n:{}))}}else this._animationConfig={enter:!1,exit:!1,update:!1}}}var CE=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};uD(),cw(),Cw(),_W(),yv.registerBuiltInAnimate("increaseCount",CM),yv.registerBuiltInAnimate("labelUpdate",class t extends gf{onBind(){let t=CA(this.target);this._animator=t;let e=this.duration,i=this.easing,{prevText:r,curText:n,prevLabelLine:l,curLabelLine:s,increaseEffect:a=!0}=this.params,o={};for(let t in n.attribute)r.attribute[t]!==n.attribute[t]&&(o[t]=n.attribute[t]);let{text:h}=o,d=CT(o,["text"]);t.animate(r,{type:"to",to:d,duration:e,easing:i}),!1!==a&&t.animate(r,{type:"increaseCount",to:{text:n.attribute.text},duration:e,easing:i}),l&&t.animate(l,{type:"to",to:s.attribute,duration:e,easing:i}),this.completeBind(t)}tryPreventConflict(){}}),yv.registerBuiltInAnimate("labelEnter",class t extends gf{onBind(){let t=CA(this.target);this._animator=t;let e=this.duration,i=this.easing,{relatedGraphic:r,relatedGraphics:n,config:l}=this.params,{mode:s,type:a="fadeIn"}=l,o=this.target,h=0;"after"===s?r.animates&&r.animates.forEach(t=>{h=Math.max(h,t.getStartTime()+t.getTotalDuration())}):"after-all"===s?n&&n.forEach(t=>{t.animates&&t.animates.forEach(t=>{h=Math.max(h,t.getStartTime()+t.getTotalDuration())})}):r.animates&&r.animates.forEach(t=>{h=Math.max(h,t.getStartTime())}),t.animate(o,Object.assign(Object.assign({},l),{duration:e,easing:i,startTime:h,type:a})),this.completeBind(t)}tryPreventConflict(){}});class CL extends CI{setBitmap(t){this._bitmap=t}setBitmapTool(t){this._bmpTool=t}constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,h3.Z)({},CL.defaultAttributes,CE(t,["data"])))),this.name="label",this._onHover=t=>{let e=t.target;e===this._lastHover||(0,uF.Z)(e.states)||(e.addState(tp.hover,!0),_X(this,t=>{t===e||(0,uF.Z)(t.states)||t.addState(tp.hoverReverse,!0)}),this._lastHover=e)},this._onUnHover=t=>{this._lastHover&&(_X(this,t=>{(0,uF.Z)(t.states)||(t.removeState(tp.hoverReverse),t.removeState(tp.hover))}),this._lastHover=null)},this._onClick=t=>{let e=t.target;if(this._lastSelect===e&&e.hasState("selected"))return this._lastSelect=null,void _X(this,t=>{(0,uF.Z)(t.states)||(t.removeState(tp.selectedReverse),t.removeState(tp.selected))});(0,uF.Z)(e.states)||(e.addState(tp.selected,!0),_X(this,t=>{t===e||(0,uF.Z)(t.states)||t.addState(tp.selectedReverse,!0)}),this._lastSelect=e)},this._handleRelatedGraphicSetState=t=>{var e,i,r,n,l;if((null==(e=t.detail)?void 0:e.type)===o3.STATE||(null==(i=t.detail)?void 0:i.type)===o3.ANIMATE_UPDATE&&(null==(r=t.detail.animationState)?void 0:r.isFirstFrameOfStep)){let e=null!=(l=null==(n=t.target)?void 0:n.currentStates)?l:[],i=this._isCollectionBase?[...this._graphicToText.values()]:[this._graphicToText.get(t.target)];this.updateStatesOfLabels(i,e)}}}labeling(t,e,i,r){}_getLabelLinePoints(t,e){return function(t,e){if(!t||!e||(0,aj.SX)(t,e,!0))return;let i=Math.min(t.x1,t.x2),r=Math.min(t.y1,t.y2),n=Math.min(e.x1,e.x2),l=Math.min(e.y1,e.y2),s=Math.abs(t.x2-i)/2,a=Math.abs(t.y2-r)/2,o=Math.abs(e.x2-n)/2,h=Math.abs(e.y2-l)/2,d=i+s,u=r+a,c=n+o,p=l+h,g=c-d,f=p-u;return[Cr(g,f,d,u,s,a),Cr(-g,-f,c,p,o,h)]}(t.AABBBounds,null==e?void 0:e.AABBBounds)}_createLabelLine(t,e){let i=this._getLabelLinePoints(t,e);if(i){let r=ak.line({points:i}),{line:n={}}=t.attribute;if(n.customShape){let i=n.customShape;r.pathProxy=r=>i({text:t,baseMark:e},r,new rp)}return e&&e.getAttributes(!0).fill&&r.setAttribute("stroke",e.getAttributes(!0).fill),this.attribute.line&&!(0,uF.Z)(this.attribute.line.style)&&r.setAttributes(this.attribute.line.style),this._setStatesOfLabelLine(r),r}}render(){if(this._prepare(),(0,nB.Z)(this._idToGraphic)||this._isCollectionBase&&(0,nB.Z)(this._idToPoint))return;let t=[];!1!==this._enableAnimation&&this._baseMarks.forEach(e=>{t.push(e.attribute),e.initAttributes(e.getAttributes(!0))});let{overlap:e,smartInvert:i,dataFilter:r,customLayoutFunc:n,customOverlapFunc:l}=this.attribute,s=this.attribute.data;if((0,nz.Z)(r)&&(s=r(s)),s&&s.length){let t=new Set;s=s.filter(e=>!t.has(e.id)&&t.add(e.id))}let a=this._initText(s);a=(0,nz.Z)(n)?n(s,a,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null,this):this._layout(a);let o=[],h=a;if(!(0,nD.Z)(e)&&(0,nz.Z)(null==e?void 0:e.filterBeforeOverlap)){let t=this.getRelatedGraphic.bind(this);a.forEach(i=>{e.filterBeforeOverlap(i,t,this)?h.push(i):o.push(i)})}(0,nz.Z)(l)?a=l(h,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null,this).concat(o):!1!==e&&(a=this._overlapping(h).concat(o)),(0,nz.Z)(this.attribute.onAfterOverlapping)&&this.attribute.onAfterOverlapping(a,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null,this),a&&a.length&&a.forEach(t=>{this._bindEvent(t),this._setStatesOfText(t)}),!1!==i&&this._smartInvert(a),this._renderLabels(a),!1!==this._enableAnimation&&this._baseMarks.forEach((e,i)=>{e.initAttributes(t[i])})}_bindEvent(t){if(this.attribute.disableTriggerEvent||!t)return;let{hover:e,select:i}=this.attribute;e&&(t.addEventListener("pointermove",this._onHover),t.addEventListener("pointerout",this._onUnHover)),i&&t.addEventListener("pointerdown",this._onClick)}_setStatesOfText(t){if(!t)return;let e=this.attribute.state;e&&!(0,uF.Z)(e)&&(t.states=e)}_setStatesOfLabelLine(t){if(!t)return;let e=this.attribute.labelLineState;e&&!(0,uF.Z)(e)&&(t.states=e)}_createLabelText(t){var e,i;return g3(Object.assign(Object.assign({},null==(i=null==(e=this.stage)?void 0:e.getTheme())?void 0:i.text),t),"textType")}_prepare(){var t,e;let i=[];if(((0,nz.Z)(this.attribute.getBaseMarks)?this.attribute.getBaseMarks():function(t,e){if(!e)return[];let i=t.find(t=>t.name===e,!0);return i?i.getChildren():[]}(this.getRootNode(),this.attribute.baseMarkGroupName)).forEach(t=>{"willRelease"!==t.releaseStatus&&i.push(t)}),null==(t=this._idToGraphic)||t.clear(),null==(e=this._idToPoint)||e.clear(),this._baseMarks=i,this._isCollectionBase="line-data"===this.attribute.type,!i||0===i.length)return;let{data:r}=this.attribute;if(r&&0!==r.length){if(this._idToGraphic||(this._idToGraphic=new Map),this._isCollectionBase){this._idToPoint||(this._idToPoint=new Map);let t=0;for(let e=0;e<i.length;e++){let n=i[e],l=Ci(n);if(l&&l.length)for(let e=0;e<l.length;e++){let i=r[t];i&&l[e]&&((0,aw.Z)(i.id)||(i.id=`vrender-component-${this.name}-${t}`),this._idToPoint.set(i.id,l[e]),this._idToGraphic.set(i.id,n)),t++}}}else for(let t=0;t<i.length;t++){let e=r[t],n=i[t];e&&n&&((0,aw.Z)(e.id)||(e.id=`vrender-component-${this.name}-${t}`),this._idToGraphic.set(e.id,n))}this._prepareAnimate(_9)}}getRelatedGraphic(t){return this._idToGraphic.get(t.id)}_initText(t=[]){let{textStyle:e={}}=this.attribute,i=[];for(let r=0;r<t.length;r++){let n=t[r],l=this.getRelatedGraphic(n);if(!l)continue;let s=l.getAttributes(!0),a=Object.assign(Object.assign({fill:this._isCollectionBase?(0,rD.Z)(s.stroke)?s.stroke.find(t=>!!t&&!0!==t):s.stroke:s.fill},e),n),o=this._createLabelText(a);i.push(o)}return i}_layout(t){let{position:e,offset:i}=this.attribute;for(let r=0;r<t.length;r++){let n=t[r];if(!n)return[];let l=n.attribute,s=this.getRelatedGraphic(l);if(!s)continue;n.attachedThemeGraphic=this;let a=this.getGraphicBounds(n);n.attachedThemeGraphic=null;let o=(0,nz.Z)(e)?e(l):e,h=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(l.id),o):this.getGraphicBounds(s,{x:l.x,y:l.y},o),d=this.labeling(a,h,o,i);d&&n.setAttributes(d)}return t}_overlapping(t){var e,i,r;if(0===t.length)return[];let n=(0,nF.Z)(this.attribute.overlap)?this.attribute.overlap:{},l=this.getBaseMarkGroup(),s=null!=(e=n.size)?e:{width:null!=(i=null==l?void 0:l.AABBBounds.width())?i:0,height:null!=(r=null==l?void 0:l.AABBBounds.height())?r:0};if(0===s.width||0===s.height)return t;let{strategy:a,priority:o}=n,h=this._bmpTool||_1(s.width,s.height),d=this._bitmap||h.bitmap();return o&&(t=t.sort((t,e)=>o(e.attribute.data)-o(t.attribute.data))),"shiftY"===(null==a?void 0:a.type)?this._overlapGlobal(t,n,h,d):this._overlapByStrategy(t,n,h,d)}_overlapGlobal(t,e,i,r){let n=t.filter(t=>t.attribute.visible&&0!==t.attribute.opacity&&this.isMarkInsideRect(this.getRelatedGraphic(t.attribute),i)),{clampForce:l=!0,hideOnHit:s=!0,hideOnOverflow:a=!1,overlapPadding:o,strategy:h}=e;if(l||a)for(let e=0;e<n.length;e++){let r=t[e],{dx:n=0,dy:l=0}=_8(r,i.width,i.height,i.padding);0===n&&0===l||(a?r.setAttributes({visible:!1}):(r.setAttributes({x:r.attribute.x+n,y:r.attribute.y+l}),r._isClamped=!0))}n=function(t,e){let{maxY:i=Number.MAX_VALUE,labelling:r,globalShiftY:n={enable:!0,maxIterations:10,maxError:.1,padding:1}}=e,l=t.length;if(l<=1)return t;let s=new Map,a=new Map,o=t=>a.get(t).y1Initial,h=t=>a.get(t).height,d=t=>a.get(t).y1,u=t=>a.get(t).x,c=t=>a.get(t).x1,p=t=>a.get(t).x2,g=t=>a.get(t).attempts,f=(t,e)=>{a.get(t).y1=e},m=(t,e)=>{a.get(t).attempts=e};for(let e of(t.sort((t,e)=>t.attribute.x-e.attribute.x),t)){let{y1:t,y2:i,x1:r,x2:n}=e.AABBBounds,{x:l,y:o}=e.attribute;a.set(e,{y1Initial:t,y1:t,y2:i,y:o,height:i-t,x1:r,x2:n,x:l,attempts:0});let h=!1;for(let[t,i]of s){let{start:a,end:o}=t;if(r>=a&&n<=o)i.push(e),h=!0;else if((0,ng.Yt)(l,u(i[0]),void 0,5)){let l={start:Math.min(a,r),end:Math.max(o,n)};i.push(e),s.set(l,i),s.delete(t),h=!0}else if(function(t,e){let[i,r]=t,[n,l]=e;return Math.max(0,Math.min(r,l)-Math.max(i,n))}([a,o],[r,n])/(o-a)>.5){let l={start:Math.min(a,r),end:Math.max(o,n)};i.push(e),s.set(l,i),s.delete(t),h=!0}if(h)break}h||s.set({start:r,end:n},[e])}for(let t of s.values())t.sort((t,e)=>o(t)-o(e)),function(t){for(let e=t.length-1;e>=0;e--){let n=t[e],l=t[e-1],s=t[e+1];if(l&&Ck(d(l)+h(l),d(n))||0===d(n)&&n._isClamped){let{y:t}=r(n);s&&Ck(t+h(n)/2,d(s))||t+h(n)/2<=i&&f(n,d(n)+t-a.get(n).y)}}}(t);if(!1!==n.enable){let{maxIterations:e=10,maxError:r=.1,padding:s=1,maxAttempts:a=1e3,deltaYTolerance:u=Number.MAX_VALUE}=n;for(let n=0;n<e;n++){t.sort((t,e)=>o(t)-o(e));let e=0;for(let r=0;r<l-1;r++){let n=t[r];if(g(n)>=a)continue;let l,y=r+1;for(;(l=t[y])&&!CR([c(n),p(n)],[c(l),p(l)]);)y+=1;if(l){let t=d(n),r=h(n),a=d(l),c=a-(t+r);if(c<s){let r=(s-c)/2;if(e=Math.max(e,r),t+r+h(l)>i){let e=t-(s-c);Math.abs(o(n)-e)<=u&&(f(n,e),m(n,g(n)+1))}else if(t-r<0){let t=a+(s-c);Math.abs(o(l)-t)<=u&&(f(l,t),m(l,g(l)+1))}else{let e=t-r,i=o(n)-e,s=a+r,h=o(l)-s;Math.abs(i)<=u&&Math.abs(h)<=u&&(f(n,e),f(l,s),m(n,g(n)+1),m(l,g(l)+1))}}}}if(e<r)break}}for(let e of t){let t=e.attribute.y+d(e)-o(e);e.setAttribute("y",t)}let y=[];t.sort((t,e)=>t.attribute.x-e.attribute.x);let v=0,b=t.length-1;for(;v<=b;)v===b?y.push(t[v]):(y.push(t[v]),y.push(t[b])),v++,b--;return y}(n,Object.assign(Object.assign({maxY:i.height},h),{labelling:t=>{let e=this.getRelatedGraphic(t.attribute),i=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t.attribute.id)):this.getGraphicBounds(e,t);return this.labeling(t.AABBBounds,i,"bottom",this.attribute.offset)}}));for(let t=0;t<n.length;t++){let e=n[t],h=e.AABBBounds,d=_3(i,h,!0);if(_5(i,r,h,l||a,o))r.setRange(d);else{if(a){if(this._processHideOnOverflow(e,i))continue}else if(l&&this._processClampForce(e,i,r,o))continue;s?e.setAttributes({visible:!1}):r.setRange(d)}}return n}_processHideOnOverflow(t,e){let{dy:i=0,dx:r=0}=_8(t,e.width,e.height,e.padding);return 0===r&&0===i||(t.setAttributes({visible:!1}),!1)}_processClampForce(t,e,i,r=0){let{dy:n=0,dx:l=0}=_8(t,e.width,e.height,e.padding);if(0===l&&0===n){if(_5(e,i,t.AABBBounds,!1,r))return i.setRange(_3(e,t.AABBBounds,!0)),!0}else if(_5(e,i,{x1:t.AABBBounds.x1+l,x2:t.AABBBounds.x2+l,y1:t.AABBBounds.y1+n,y2:t.AABBBounds.y2+n}))return t.setAttributes({x:t.attribute.x+l,y:t.attribute.y+n}),i.setRange(_3(e,t.AABBBounds,!0)),!0;return!1}_overlapByStrategy(t,e,i,r){var n;let{avoidBaseMark:l,strategy:s=[],hideOnHit:a=!0,clampForce:o=!0,avoidMarks:h=[],overlapPadding:d,hideOnOverflow:u=!1}=e,c=[],p=s.some(t=>"bound"===t.type);l&&(null==(n=this._baseMarks)||n.forEach(t=>{t.AABBBounds&&r.setRange(_3(i,t.AABBBounds,!0))})),h.length>0&&h.forEach(t=>{(0,nI.Z)(t)?(function(t,e){if(!e)return[];let i=t.find(t=>t.name===e,!0);return i?i.findAll(t=>"group"!==t.type,!0):[]})(this.getRootNode(),t).forEach(t=>{t.AABBBounds&&r.setRange(_3(i,t.AABBBounds,!0))}):t.AABBBounds&&r.setRange(_3(i,t.AABBBounds,!0))});for(let e=0;e<t.length;e++){if(!1===t[e].attribute.visible)continue;let n=t[e],l=this.getRelatedGraphic(n.attribute);if(n.update(),!this.isMarkInsideRect(l,i))continue;if(_5(i,r,n.AABBBounds,o||u,d)&&(!p||p&&l&&l.AABBBounds&&this._canPlaceInside(n.AABBBounds,l.AABBBounds))){r.setRange(_3(i,n.AABBBounds,!0)),c.push(n);continue}let h=!1;for(let a=0;a<s.length;a++)if(!1!==(h=function(t,e,i,r,n,l,s){var a,o;let h=null==(a=r.overlap)?void 0:a.clampForce,d=null==(o=r.overlap)?void 0:o.overlapPadding;if("bound"===i.type||"position"===i.type){if((0,nz.Z)(s)){let a=(((0,nz.Z)(i.position)?i.position(n.attribute):i.position)||("rect"===r.type?_7:_6)).map(t=>s(n.AABBBounds,l,t,r.offset));return _4(t,e,n,a,h,d,!1===i.restorePosition)}return!1}if("moveY"===i.type){let r=(i.offset?(0,nz.Z)(i.offset)?i.offset(n.attribute):i.offset:[]).map(t=>({x:n.attribute.x,y:n.attribute.y+t}));return _4(t,e,n,r,h,d)}if("moveX"===i.type){let r=(i.offset?(0,nz.Z)(i.offset)?i.offset(n.attribute):i.offset:[]).map(t=>({x:n.attribute.x+t,y:n.attribute.y}));return _4(t,e,n,r,h,d)}return!1}(i,r,s[a],this.attribute,n,this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t[e].attribute.id)):this.getGraphicBounds(l,t[e].attribute),this.labeling))&&(n.setAttributes({x:h.x,y:h.y}),!u||this._processHideOnOverflow(n,i))){c.push(n);break}if(!h){if(u&&!this._processHideOnOverflow(n,i))continue;if(o&&this._processClampForce(n,i,r,d)){c.push(n);continue}}h||a||c.push(n)}return c}isMarkInsideRect(t,e){let{left:i,right:r,top:n,bottom:l}=e.padding,s={x1:-i,x2:e.width+r,y1:-n,y2:e.height+l},a=t.AABBBounds;if(0!==a.width()&&0!==a.height())return(0,aj.SX)(t.AABBBounds,s,!0);let{attribute:o}=t;if("rect"===t.type){let{x:t,x1:e,y:i,y1:r}=o;return(0,aj.qr)({x:null!=t?t:e,y:null!=i?i:r},s,!0)}return"x"in o&&"y"in o&&(0,aj.qr)({x:o.x,y:o.y},s,!0)}getBaseMarkGroup(){let{baseMarkGroupName:t}=this.attribute;if(t)return this.getRootNode().find(e=>e.name===t,!0)}getGraphicBounds(t,e={},i){var r;if(t){if(!1!==t.attribute.visible){if(null==(r=t.context)?void 0:r.animationState){let e=t.clone();return Object.assign(e.attribute,t.getAttributes(!0)),e.AABBBounds}return t.AABBBounds}let{x:e,y:i}=t.attribute;return{x1:e,x2:e,y1:i,y2:i}}if(e&&i&&"inside-middle"===i){let{x:t,y:i,x1:r=t,y1:n=i}=e;return{x1:(t+r)/2,x2:(t+r)/2,y1:(i+n)/2,y2:(i+n)/2}}let{x:n,y:l}=e;return{x1:n,x2:n,y1:l,y2:l}}_renderLabels(t){var e;let{syncState:i}=this.attribute,r=new Map,n=this._graphicToText||new Map,l=[],s=[],{visible:a}=null!=(e=this.attribute.line)?e:{};t&&t.forEach((t,e)=>{var o;let h,d=this.getRelatedGraphic(t.attribute),u=this._isCollectionBase?t.attribute.id:d,c=(null==n?void 0:n.get(u))?"update":"enter";a&&(h=this._createLabelLine(t,d));let p=h?{text:t,labelLine:h}:{text:t};if(i&&this.updateStatesOfLabels([p],null!=(o=d.currentStates)?o:[]),"enter"===c)l.push(t),r.set(u,p),this._addLabel(p,l,s,e);else if("update"===c){let t=n.get(u);n.delete(u),r.set(u,t),this._updateLabel(t,p)}}),this._removeLabel(n),this._graphicToText=r}runEnterAnimation(t,e){if(!1===this._enableAnimation||!this._animationConfig.enter)return;let i=this.getRelatedGraphic(t.attribute),{enter:r}=this._animationConfig;[t,e].filter(Boolean).forEach(e=>{var n;null==(n=e.setFinalAttributes)||n.call(e,e.attribute),e.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r),{type:"labelEnter",selfOnly:!0,customParameters:{relatedGraphic:i,relatedGraphics:this._idToGraphic,config:Object.assign(Object.assign({},r),{type:e===t?r.type:"fadeIn"})}})}])})}_runUpdateAnimation(t,e){let{text:i,labelLine:r}=t,{text:n,labelLine:l}=e;i.applyAnimationState(["update"],[{name:"update",animation:{type:"labelUpdate",customParameters:Object.assign(Object.assign({},this._animationConfig.update),{prevText:i,curText:n,prevLabelLine:r,curLabelLine:l})}}])}_syncStateWithRelatedGraphic(t){this.attribute.syncState&&t&&t.on("afterStateUpdate",this._handleRelatedGraphicSetState)}_addLabel(t,e,i,r){let{text:n,labelLine:l}=t,s=this.getRelatedGraphic(n.attribute);this._syncStateWithRelatedGraphic(s),n&&this.add(n),l&&this.add(l),this.runEnterAnimation(n,l)}_updateLabel(t,e){let{text:i,labelLine:r}=t,{text:n,labelLine:l}=e;!1===this._enableAnimation||!1===this._animationConfig.update?(t.text.setAttributes(n.attribute),r&&l&&t.labelLine.setAttributes(l.attribute)):this._runUpdateAnimation(t,e)}_removeLabel(t){let e=t=>{this.removeChild(t.text),t.labelLine&&this.removeChild(t.labelLine)};!1!==this._enableAnimation&&!1!==this._animationConfig.exit?t.forEach(t=>{var i;t.text.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},this._animationConfig.exit),{type:"fadeOut"})}],()=>{e(t)}),null==(i=t.labelLine)||i.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},this._animationConfig.exit),{type:"fadeOut"})}],()=>{})}):t.forEach(t=>{e(t)})}updateStatesOfLabels(t,e){t.forEach(t=>{t&&(t.text&&t.text.useStates(e),t.labelLine&&t.labelLine.useStates(e))})}_smartInvert(t){var e,i,r,n,l,s,a;let o=(0,nF.Z)(this.attribute.smartInvert)?this.attribute.smartInvert:{},{textType:h,contrastRatiosThreshold:d,alternativeColors:u,mode:c,interactInvertType:p}=o,g=null!=(e=o.fillStrategy)?e:"invertBase",f=null!=(i=o.strokeStrategy)?i:"base",m=null!=(r=o.brightColor)?r:"#ffffff",y=null!=(n=o.darkColor)?n:"#000000",v=null!=(l=o.outsideEnable)&&l;if("null"!==g||"null"!==f)for(let e=0;e<t.length;e++){let i=t[e];if(!i)continue;let r=this.getRelatedGraphic(i.attribute),n=r.getAttributes(!0).fill,l=i.attribute.fill;if((0,nF.Z)(n)&&n.gradient){let t=null==(a=null==(s=n.stops)?void 0:s[0])?void 0:a.color;t&&(n=t,l=t)}let o=_j(l,n,h,d,u,c),b=_G(o,m)?m:y,_=this._canPlaceInside(i.AABBBounds,r.AABBBounds),C=!_&&i.AABBBounds&&r.AABBBounds&&r.AABBBounds.intersects(i.AABBBounds);if(_||v||C&&"inside"===p){let t=_K(g,n,o,b);if(t&&i.setAttributes({fill:t}),0===i.attribute.lineWidth||0===i.attribute.strokeOpacity)continue;let e=_K(f,n,o,b);e&&i.setAttributes({stroke:e})}else if(C&&"none"!==p){if(0===i.attribute.lineWidth||0===i.attribute.strokeOpacity)continue;if(i.attribute.stroke){i.setAttributes({fill:_j(i.attribute.fill,i.attribute.stroke,h,d,u,c)});continue}let t=_K(g,n,o,b);t&&i.setAttributes({fill:t});let e=_K(f,n,o,b);e&&i.setAttributes({stroke:e})}}}_canPlaceInside(t,e){return!(!t||!e)&&e.encloses(t)}setLocation(t){this.translateTo(t.x,t.y)}disableAnimation(){this._enableAnimation=!1}enableAnimation(){this._enableAnimation=!0}}CL.defaultAttributes={textStyle:{fontSize:12,textAlign:"center",textBaseline:"middle",boundsPadding:[-2,-1,-2,-1]},offset:0,pickable:!1};let CF={},CO=(t,e)=>{CF[t]=e},CH=t=>CF[t];var CD=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Cz extends CL{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,h3.Z)({},Cz.defaultAttributes,CD(t,["data"])))),this.name="line-label"}getGraphicBounds(t,e={},i="end"){if(!t||"line"!==t.type&&"area"!==t.type)return super.getGraphicBounds(t,e);let r=t.attribute.points,n=t.attribute.segments;!r&&n&&n.length&&(r=n.reduce((t,e)=>{var i;return t.concat(null!=(i=e.points)?i:[])},[])),r&&0!==r.length||(r=[e]);let l="start"===i?0:r.length-1;return r[l]?{x1:r[l].x,x2:r[l].x,y1:r[l].y,y2:r[l].y}:void 0}labeling(t,e,i="end",r=0){return function(t,e,i="end",r=0){if(!t||!e)return{x:1/0,y:1/0};let{x1:n,x2:l}=t,s=Math.abs(l-n),a=e.x1,o=a;return"end"===i?o=a+s/2+r:"start"===i&&(o=a-s/2-r),{x:o,y:e.y1}}(t,e,i,r)}}Cz.defaultAttributes={textStyle:{fill:"#000"},position:"end",offset:6};let CW=()=>{CO("line",Cz),CO("area",Cz)};var CZ=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class CN extends CL{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,h3.Z)({},CN.defaultAttributes,CZ(t,["data"])))),this.name="symbol-label"}labeling(t,e,i="top",r=0){return Ce(t,e,i,r)}}CN.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};let Cj=()=>{CO("symbol",CN),CO("line-data",CN)};class CG extends _R{constructor(){super(...arguments),this.type=CG.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:1})}_getIgnoreAttributes(){var t,e;return(null==(t=this.model)?void 0:t.type)===Y.radar&&"polar"===(null==(e=this.model)?void 0:e.coordinate)?[]:["fill","fillOpacity"]}}CG.type="line";let CV=()=>{h9.registerMark(CG.type,CG),gG(),_W(),CW(),Cj(),v3(),h9.registerGraphicComponent("line",_I)};class CU extends gW{constructor(){super(...arguments),this.type=CU.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{size:1,symbolType:"circle",fill:void 0,lineWidth:0})}_transformGraphicAttributes(t,e,i){var r,n,l;let s=super._transformGraphicAttributes(t,e,i),a=null!=(n=null!=(r=s.shape)?r:s.symbolType)?n:null==(l=t.attribute)?void 0:l.symbolType;return(0,nB.Z)(a)?s.symbolType="circle":s.symbolType=a,s}}CU.type="symbol";let CK=()=>{h9.registerMark(CU.type,CU),gG(),cH(),Cj(),h9.registerGraphicComponent("symbol",oI)};class CX extends _c{_transformLabelSpec(t){var e,i,r;!1!==(null==(e=t.point)?void 0:e.visible)&&!1!==(null==(r=null==(i=t.point)?void 0:i.style)?void 0:r.visible)?this._addMarkLabelSpec(t,"point"):this._addMarkLabelSpec(t,"line"),this._addMarkLabelSpec(t,"line","lineLabel","initLineLabelMarkStyle",void 0,!0)}}var CY=i(18181);function C$(t,e,i){let r=!1;if(e&&(0,nz.Z)(e)){for(let n of t)for(let t of n.getSeries(i))if(r=!!e.call(null,t))return r}return r}function Cq(t,e){let i=[];for(let r of t)for(let t of r.getSeries(e))i.push(t);return i}let CJ=(t,e)=>{for(let i=0;i<t.length;i++){let r=t[i].getSeries();for(let t=0;t<r.length;t++){let i=r[t];if(e&&i&&i.coordinate===e||!e&&i)return i}}return null};function CQ(t){return"bottom"===t||"top"===t}function C0(t){return"left"===t||"right"===t}function C1(t){return"z"===t}function C2(t,e){return h_(t.orient)||e&&e.includes(t.orient)?t.orient:"left"}function C3(t){return"top"===t||"bottom"===t?"horizontal":"vertical"}function C5(t,e){var i,r;let n=null!=(i=t.type)?i:(r=t.orient,e?CQ(r)?"linear":"band":CQ(r)?"band":"linear");return{axisType:n,componentName:`${oQ.cartesianAxis}-${n}`}}let C4=(t,e,i)=>{var r;let n=null!=(r="band"===e?bD("axisBand",i):["linear","log","symlog"].includes(e)?bD("axisLinear",i):{})?r:{},l=CQ(t)?bD("axisX",i):C0(t)?bD("axisY",i):bD("axisZ",i);return h5({},bD("axis",i),n,l)};function C6(t){return t.length>=2&&(0,hy.Z)(t[0])&&(0,hy.Z)((0,a1.Z$)(t))&&(0,a1.Z$)(t)>=t[0]}function C7(t,e){var i;let r=(0,a1.Z$)(e)-e[0],n=(0,a1.Z$)(e)*e[0]<0,l=e[0]<=0?0-e[0]:0,s=(0,a1.Z$)(e)>0?(0,a1.Z$)(e)-0:0;0===r?e[0]<0?(l=1,s=0):e[0]>0&&(l=0,s=1):(l/=r,s/=r);let a=t.getDomainSpec(),o={total:r,negative:l,positive:s,includeZero:n,domain:e,extendable_min:!(0,hy.Z)(a.min),extendable_max:!(0,hy.Z)(a.max)};if(null==(i=t._break)?void 0:i.scope){let i,r,n=e.findIndex(t=>t>=0);0===n?(i=t._break.scope[n],r=[e[0],e[1]],o.positive=1,o.negative=0):0>=(0,a1.Z$)(e)?(o.positive=0,o.negative=1,r=[e[e.length-2],e[e.length-1]]):(i=t._break.scope[n-1],r=[e[n-1],e[n]],o.negative=i[0]+(0-r[0])/(r[1]-r[0])*(i[1]-i[0]),o.positive=1-o.negative),o.break=!0,o.extendable_max=!1,o.extendable_min=!1,o.domain=r}return o}function C8(t,e){let{positive:i,negative:r,extendable_min:n,extendable_max:l,domain:s}=t,{positive:a,negative:o,extendable_min:h,extendable_max:d,domain:u}=e;if(a>0){if(!h)return!1;let t=r/i;l&&(t=r/Math.max(i,a),s[1]=-s[0]/t),u[0]=-u[1]*t}else if(o>0){if(!d)return!1;let t=i/r;n&&(t=i/Math.max(r,r),s[0]=-s[1]/t),u[1]=-u[0]*t}return!0}function C9(t,e){let{extendable_min:i,extendable_max:r,domain:n}=t,{positive:l,negative:s,domain:a}=e;return(0!==l||0!==s)&&!(l>0&&!r)&&!(s>0&&!i)&&(n[0]=a[0],n[1]=a[1],!0)}function xt(t,e){let{positive:i,negative:r,extendable_max:n,domain:l}=t,{positive:s,negative:a,extendable_min:o,domain:h}=e;if(n&&o){let t=Math.max(r,a)/Math.max(i,s);l[1]=-l[0]/t,h[0]=-h[1]*t}else if(o)h[0]=-h[1]*(r/i);else{if(!n)return!1;l[1]=-l[0]/(a/s)}return!0}function xe(t,e){let{extendable_min:i,domain:r}=t,{extendable_max:n,domain:l}=e;return!(!i||!n)&&(r[0]=-r[1],l[1]=-l[0],!0)}let xi=(t,e)=>{var i,r,n,l;let s=t.getScale(),a=e.getScale();if(!s||!a)return;let o=null!=(r=null==(i=t.getDomainAfterSpec)?void 0:i.call(t))?r:[0,1],h=null!=(l=null==(n=e.getDomainAfterSpec)?void 0:n.call(e))?l:[0,1];if(!(o&&h&&C6(o)&&C6(h)))return;let d=C7(t,o),u=C7(e,h);if(!0===d.break&&!0===u.break)return;let{positive:c,negative:p,extendable_min:g,extendable_max:f,includeZero:m}=d,{positive:y,negative:v,extendable_min:b,extendable_max:_,includeZero:C}=u;if(0===c&&0===p){if(!C9(d,u))return}else if(0===y&&0===v){if(!C9(u,d))return}else if(m||C)if(m&&!C){if(!C8(d,u))return}else if(C&&!m){if(!C8(u,d))return}else{if(p===v)return;if(p>v){if(!xt(d,u))return}else if(!xt(u,d))return}else{if(0===p&&0===y){if(!xe(d,u))return}else if(0===v&&0===c&&!xe(u,d))return;if(0===p&&0===v)if(0===o[0]&&h[0]>0){if(!b)return;h[0]=0}else{if(!(0===h[0]&&o[0]>0)||!g)return;o[0]=0}if(0===c&&0===y)if(0===o[1]&&h[1]>0){if(!_)return;h[1]=0}else{if(!(0===h[1]&&o[1]>0)||!f)return;o[1]=0}}s.domain(o),a.domain(h)},xr=t=>t.map((t,e)=>({index:e,value:t})),xn=(t,e,i=0)=>{let r=new iI.FB(t).expand(i/2),n=new iI.FB(e).expand(i/2);return r.intersects(n)},xl=(t,e,i,r)=>i<t?Math.max(t-e/2,i):i>t?Math.min(t-e/2,i-e):i<r?i:i-e,xs=(t,e,i)=>{var r,n,l;let{labelStyle:s,axisOrientType:a,labelFlush:o,labelFormatter:h,startAngle:d=0}=i,u=null!=(r=s.angle)?r:0;"vertical"===s.direction&&(u+=(0,iH.M4)(90));let c=["bottom","top"].includes(a),p=["left","right"].includes(a),g=1,f=0;c||(p?(g=0,f=1):d&&(g=Math.cos(d),f=-Math.sin(d)));let m=gQ(s),y=t.range(),v=[];for(let i=0;i<e.length;i++){let r=e[i],a=h?h(r):`${r}`;if((0,hc.Z)(a)){v=void 0;break}let{width:d,height:b}=m.quickMeasure(a),_=Math.max(d,12),C=Math.max(b,12),x=t.scale(r),w=g*x,S=f*x,A,M,T=w,k=S;o&&c&&0===i?T=xl(w,_,y[0],y[y.length-1]):o&&c&&i===e.length-1?T=xl(w,_,y[y.length-1],y[0]):A=null!=(n=s.textAlign)?n:"center","right"===A?T-=_:"center"===A&&(T-=_/2),o&&p&&0===i?k=xl(S,C,y[0],y[y.length-1]):o&&p&&i===e.length-1?k=xl(S,C,y[y.length-1],y[0]):M=null!=(l=s.textBaseline)?l:"middle","bottom"===M?k-=C:"middle"===M&&(k-=C/2);let R=(new iI.FB).set(T,k,T+_,k+C);u&&R.rotate(u,w,S),v.push(R)}return v},xa=t=>["bottom","top","z"].includes(t),xo=(t,e)=>{var i,r,n,l,s;if(!t)return t;let a=null==(i=null==e?void 0:e.targetAxis)?void 0:i.call(e);if(!a)return t;let o=null==(r=null==e?void 0:e.currentAxis)?void 0:r.call(e);if(!o)return t;let h=null==(n=o.getTickData())?void 0:n.getDataView();if(!h||!h.transformsArr.find(t=>t.type.includes("ticks")))return t;let d=o.getScale();if(!d)return t;let u=null==(s=null==(l=a.getTickData())?void 0:l.getDataView())?void 0:s.latestData;if(!(null==u?void 0:u.length))return t;let c=a.getScale();if(!c)return t;let p=c.domain(),g=(0,a1.Z$)(p)-p[0];if(0===g)return t;let f=d.domain(),m=(0,a1.Z$)(f)-f[0];return 0===g?t:xr(u.map(t=>(function(t,e,i,r,n){let l=(0,ik.f2)(t,e),s=Math.max((0,ik.i4)(i),(0,ik.i4)(l));return Math.round(l*10**s)/Math.round(i*10**s)*n+r})(t.value,p[0],g,f[0],m)))};class xh{constructor(t){this.id=hm(),this.name=`${t}_${this.id}`}onAdd(t){this.service=t}release(){this.service=null}}class xd extends xh{constructor(){super(xd.type),this.type="AxisSyncPlugin"}_checkEnableSync(t){if(!(0,pW.z2)(t.getScale().type))return!1;let e=t.getSpec().sync;return!!(null==e?void 0:e.axisId)&&e}_getTargetAxis(t,e){let i=t.getOption().getChart().getComponentByUserId(e.axisId);return(null==i?void 0:i.type.startsWith("cartesianAxis"))?i:null}onInit(t,e){let i=this._checkEnableSync(e);if(!i||!i.zeroAlign)return;let r=this._getTargetAxis(e,i);r&&e.event.on(J.scaleDomainUpdate,{filter:({model:t})=>t.id===e.id||t.id===r.id},()=>{xi(r,e)})}onDidCompile(t,e){var i;let r=this._checkEnableSync(e);if(!r)return;let n=this._getTargetAxis(e,r);if(n&&r.tickAlign){dL(e.getOption().dataSet,"tickAlign",xo);let t=null==(i=n.getTickData())?void 0:i.getDataView();t&&t.target.addListener("change",()=>{var t,i;null==(i=null==(t=e.getTickData())?void 0:t.getDataView())||i.reRunAllTransform({skipEqual:!0})}),e.addTransformToTickData({type:"tickAlign",options:{targetAxis:()=>n,currentAxis:()=>e},level:Number.MAX_SAFE_INTEGER},!1)}}}function xu(t={}){let e=Object.assign({},t);if((0,nz.Z)(t.style)?e.style=(e,i,r,n)=>xg(t.style(e,i,r,n)):(0,uF.Z)(t.style)||(e.style=xg(t.style)),!(0,uF.Z)(t.state)){let i={};Object.keys(t.state).forEach(e=>{(0,nz.Z)(t.state[e])?i[e]=(i,r,n,l)=>xg(t.state[e](i,r,n,l)):(0,uF.Z)(t.state[e])||(i[e]=xg(t.state[e]))}),e.state=i}return e}function xc(t){if((0,uF.Z)(t))return null;let e={};return Object.keys(t).forEach(i=>{(0,nz.Z)(t[i])?e[i]=(e,r,n,l)=>xg(t[i](e,r,n,l)):(0,uF.Z)(t[i])||(e[i]=xg(t[i]))}),e}function xp(t,e){if((0,uF.Z)(t))return null;let i={};return Object.keys(t).forEach(r=>{(0,nz.Z)(t[r])?i[r]=t[r](e):i[r]=t[r]}),xg(i)}function xg(t){return(null==t?void 0:t.angle)?Object.assign(Object.assign({},t),{angle:(0,iH.M4)(t.angle)}):t}xd.pluginType="component",xd.type="AxisSyncPlugin";let xf={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}};function xm(t){let e=0;return(0,dx.Z)(t,"tick.visible")&&(e+=(0,dx.Z)(t,"tick.tickSize")),(0,dx.Z)(t,"label.visible")&&(e+=(0,dx.Z)(t,"label.space")),e}function xy(t,e){var i,r,n,l,s,a;return{min:null!=(n=null!=(i=t.min)?i:null==(r=t.range)?void 0:r.min)?n:null==e?void 0:e.min,max:null!=(a=null!=(l=t.max)?l:null==(s=t.range)?void 0:s.max)?a:null==e?void 0:e.max}}function xv(t){let e=null==t?void 0:t.orient;return"top"===e||"bottom"===e||"left"===e||"right"===e||"z"===e}let xb=t=>"band"===t||"ordinal"===t||"point"===t;function x_(t,e){return{id:t,label:t,value:e,rawValue:t}}function xC(t,e,i){return i||!t||t.getAxisId()===e.getAxisId()}class xx extends yo{constructor(t){super(),this.component=t}releaseAll(){super.releaseAll(),this.component=null}}let xw=`${d9}_ARC_TRANSFORM_VALUE`,xS=`${d9}_ARC_RATIO`,xA=`${d9}_ARC_START_ANGLE`,xM=`${d9}_ARC_END_ANGLE`,xT=`${d9}_ARC_K`,xk=`${d9}_ARC_MIDDLE_ANGLE`,xR=`${d9}_ARC_QUADRANT`,xP=`${d9}_ARC_RADIAN`,xB=-Math.PI/2,xI=3*Math.PI/2,xE=(t,e)=>{var i,r,n,l,s,a;let o=null!=(i=t.type)?i:"angle"===t.orient?"band":"linear",h=`${oQ.polarAxis}-${o}`,d=null!=(r=t.startAngle)?r:e.startAngle,u=null!=(n=t.endAngle)?n:e.endAngle;return{axisType:o,componentName:h,startAngle:null!=d?d:-90,endAngle:null!=u?u:(0,aw.Z)(d)?d+360:270,center:(0,aw.Z)(e.center)?e.center:(0,aw.Z)(null==e?void 0:e.centerX)||(0,aw.Z)(null==e?void 0:e.centerY)?{x:null==e?void 0:e.centerX,y:null==e?void 0:e.centerY}:void 0,outerRadius:null!=(a=null!=(s=null!=(l=t.outerRadius)?l:t.radius)?s:e.outerRadius)?a:e.radius,layoutRadius:e.layoutRadius}},xL=(t,e,i,r)=>{let n=t();if((0,n4.Z)(n))return n;if((0,nz.Z)(n))return n(e(),i());let l=e();if("auto"===n&&l.width>0&&l.height>0){let{startAngle:t=0,endAngle:e=2*Math.PI}=r();return(0,iH.Re)(l,i(),t,e)}return Math.min(l.width/2,l.height/2)},xF=(t,e,i)=>{var r;let n=null!=(r="band"===e?bD("axisBand",i):"linear"===e?bD("axisLinear",i):{})?r:{},l=bD("angle"===t?"axisAngle":"axisRadius",i);return h5({},bD("axis",i),n,l)},xO=(t,e)=>{var i,r;let n,l=(0,a1.IX)(null!=(i=e.axes)?i:[]),{bandField:s,linearField:a,xField:o,yField:h,trigger:d,triggerOff:u}=null!=(r=bD(oQ.crosshair,t))?r:{},c=l.find(t=>CQ(t.orient));n=(0,aw.Z)(c)?h5({},xb(c.type)?s:a,o):o;let p=l.find(t=>C0(t.orient));return{xField:n,yField:(0,aw.Z)(p)?h5({},(0,pW.lK)(p.type)?s:a,h):h,trigger:d,triggerOff:u}},xH=(t,e)=>{var i,r;let n,l=(0,a1.IX)(null!=(i=e.axes)?i:[]),{bandField:s,linearField:a,categoryField:o,valueField:h,trigger:d,triggerOff:u}=null!=(r=bD(oQ.crosshair,t))?r:{},c=l.find(t=>"angle"===t.orient);n=(0,aw.Z)(c)?h5({},xb(c.type)?s:a,o):o;let p=l.find(t=>"radius"===t.orient);return{categoryField:n,valueField:(0,aw.Z)(p)?h5({},(0,pW.lK)(p.type)?s:a,h):h,trigger:d,triggerOff:u}},xD=(t,e)=>{var i;let r=null!=(i=t.orient)?i:e.orient,n=e[C3(r)],l=h5({},e,n);return delete l.horizontal,delete l.vertical,l};class xz extends pa{getTheme(t,e){var i=this.type,r=this._option.getTheme;switch(i){case oQ.cartesianBandAxis:return C4(C2(t,["z"]),"band",r);case oQ.cartesianLinearAxis:return C4(C2(t,["z"]),"linear",r);case oQ.cartesianLogAxis:return C4(C2(t,["z"]),"log",r);case oQ.cartesianSymlogAxis:return C4(C2(t,["z"]),"symlog",r);case oQ.cartesianAxis:case oQ.cartesianTimeAxis:return C4(C2(t),void 0,r);case oQ.polarBandAxis:return xF(t.orient,"band",r);case oQ.polarLinearAxis:return xF(t.orient,"linear",r);case oQ.polarAxis:return xF(t.orient,void 0,r);case oQ.cartesianCrosshair:return xO(r,e);case oQ.polarCrosshair:return xH(r,e);case oQ.colorLegend:case oQ.sizeLegend:case oQ.discreteLegend:case oQ.dataZoom:case oQ.scrollBar:return xD(t,bD(i,r));default:return bD(i,r)}}_mergeThemeToSpec(t,e){let{spec:i,theme:r}=super._mergeThemeToSpec(t,e);return this._adjustPadding(i),{spec:i,theme:r}}_adjustPadding(t){let{padding:e,noOuterPadding:i=!0,orient:r}=t;i&&e&&r&&(t.padding=Object.assign(Object.assign({},hM(e)),{[r]:0}))}}var xW=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class xZ extends pg{constructor(){super(...arguments),this.name="component",this.modelType="component",this.transformerConstructor=xz,this._delegateEvent=(t,e,i,r=null,n=null)=>{var l,s;e instanceof nN||this.event.emit(i,{model:this,node:t,event:e,item:r,datum:n,source:Q.chart,chart:null==(s=null==(l=this._option)?void 0:l.globalInstance)?void 0:s.getChart()},"model")}}static createComponent(t,e){let{spec:i}=t,r=xW(t,["spec"]);return new this(i,Object.assign(Object.assign({},e),r))}getRegions(){return this._regions}created(){super.created(),this.initLayout(),this.pluginService=new xx(this)}initLayout(){var t;super.initLayout(),this._regions=null!=(t=this._regions)?t:this._option.getRegionsInIndex(),this._layout&&(this._layout.layoutBindRegionID=this._regions.map(t=>null==t?void 0:t.id))}_getNeedClearVRenderComponents(){return[]}getVRenderComponents(){return this._getNeedClearVRenderComponents()}callPlugin(t){this.pluginService&&this.pluginService.getAll().forEach(e=>t(e))}getContainer(){var t;return this._container||(this._container=null==(t=this._option)?void 0:t.globalInstance.getStage().find(t=>"root"===t.name,!0)),this._container}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reMake=["seriesId","seriesIndex","regionId","regionIndex"].some(i=>!(0,uL.X)(null==e?void 0:e[i],t[i]))),(null==e?void 0:e.visible)!==t.visible&&(i.reCompile=!0),i}release(){var t;super.release(),this.clear(),null==(t=this.pluginService)||t.releaseAll(),this.pluginService=null}clear(){var t;let e=this._getNeedClearVRenderComponents();e&&e.length&&e.forEach(t=>{var e;t&&(null==(e=this.getContainer())||e.removeChild(t),t=null)}),this._container=null,null==(t=this.pluginService)||t.clearAll()}compile(){this.compileMarks(),this.reAppendComponents()}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t,context:{model:this}})})}reAppendComponents(){let t=this._getNeedClearVRenderComponents();t&&t.length&&t.forEach(t=>{var e;t&&!t.stage&&(null==(e=this.getContainer())||e.appendChild(t))})}getBoundsInRect(t,e){return{x1:0,x2:0,y1:0,y2:0}}getDatum(t){}}xZ.transformerConstructor=xz,(tF=tJ||(tJ={})).lineAxis="lineAxis",tF.circleAxis="circleAxis",(tO=tQ||(tQ={})).lineAxisGrid="lineAxisGrid",tO.circleAxisGrid="circleAxisGrid";var xN=i(15215);class xj extends gW{constructor(t,e){super(t,e),this.type="component",this._componentType=e.componentType,this._mode=e.mode}_getDefaultStyle(){return{}}getComponent(){return this._component}clearComponent(){this._component&&(this._component.parent&&this._component.parent.removeChild(this._component),this._component=null)}_getAttrsFromConfig(t={}){let e=super._getAttrsFromConfig(t);return(0,nB.Z)(this._markConfig.interactive)||(e.pickable=this._markConfig.interactive),t}setAttributeTransform(t){this._attributesTransform=t}renderInner(){var t;let e=null!=(t=this._simpleStyle)?t:this.getAttributesOfState({}),i=this._getAttrsFromConfig(e);this._attributesTransform&&(i=this._attributesTransform(i)),this._animationConfig&&(i=Object.assign(Object.assign({},i),{animation:!0,animationAppear:this._animationConfig.appear?Array.isArray(this._animationConfig.appear)?this._animationConfig.appear[0]:this._animationConfig.appear:void 0,animationEnter:this._animationConfig.enter?Array.isArray(this._animationConfig.enter)?this._animationConfig.enter[0]:this._animationConfig.enter:void 0,animationUpdate:this._animationConfig.update?Array.isArray(this._animationConfig.update)?this._animationConfig.update[0]:this._animationConfig.update:void 0,animationExit:this._animationConfig.exit?Array.isArray(this._animationConfig.exit)?this._animationConfig.exit[0]:this._animationConfig.exit:void 0})),this._component?this._component.setAttributes(i):(this._component=h9.createGraphicComponent(this._componentType,i,{mode:this._mode,skipDefault:this._markConfig.skipTheme}),this._component&&this._product.appendChild(this._component)),this._component&&(this._component.context=this._getCommonContext()),this._markConfig.support3d&&this._product&&this._product.setMode("3d"),this.model.event.emit(q.AFTER_ELEMENT_ENCODE,{mark:this,model:this.model}),this.needClear=!0}release(){super.release(),this.removeProduct()}}xj.type="component";let xG=()=>{h9.registerMark(xj.type,xj)};(tH=t0||(t0={})).innerView="inner-view",tH.axisContainer="axis-container",tH.labelContainer="axis-label-container",tH.tickContainer="axis-tick-container",tH.tick="axis-tick",tH.subTick="axis-sub-tick",tH.label="axis-label",tH.title="axis-title",tH.labelHoverOnAxis="axis-label-hover-on-axis",tH.gridContainer="axis-grid-container",tH.grid="axis-grid",tH.gridRegion="axis-grid-region",tH.line="axis-line",tH.background="axis-background",tH.axisLabelBackground="axis-label-background",tH.axisBreak="axis-break",tH.axisBreakSymbol="axis-break-symbol",(tD=t1||(t1={})).selected="selected",tD.selectedReverse="selected_reverse",tD.hover="hover",tD.hoverReverse="hover_reverse";let xV={[t1.selectedReverse]:{},[t1.selected]:{},[t1.hover]:{},[t1.hoverReverse]:{}},xU=t=>t;var xK=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class xX extends xZ{getOrient(){return this._orient}getScale(){return this._scale}getScales(){return this._scales}getTickData(t=0){return this._tickData[t]}get visible(){return this._visible}getInverse(){return this._inverse}getCoordinateType(){return this._coordinateType}constructor(t,e){var i;super(t,e),this.specKey="axes",this._scales=[],this._tickData=[],this._visible=!0,this._tick=void 0,this._onTickDataChange=t=>{this._forceLayout(),null==t||t.updateData()},this._visible=null==(i=t.visible)||i,this._coordinateType="none"}getVRenderComponents(){var t,e;return[null==(t=this._axisMark)?void 0:t.getProduct(),null==(e=this._gridMark)?void 0:e.getProduct()].filter(aw.Z)}created(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v;if(super.created(),this.setSeriesAndRegionsFromSpec(),this.initEvent(),this.initScales(),this.updateSeriesScale(),this._shouldComputeTickData()&&this._initData(),this._visible){let b=this._createMark({type:"component",name:`axis-${this.getOrient()}`},{componentType:"angle"===this.getOrient()?tJ.circleAxis:tJ.lineAxis,mode:this._spec.mode},{skipTheme:!0});if(this._updateTickDataMarks(b),this._axisMark=b,b.setMarkConfig({zIndex:this.layoutZIndex}),(0,aw.Z)(this._spec.id)&&b.setUserId(this._spec.id),b.setMarkConfig({interactive:null!=(t=this._spec.interactive)?t:this.getDefaultInteractive()}),this._marks.addMark(b),null==(e=this._spec.grid)?void 0:e.visible){let t=this._createMark({type:"component",name:`axis-${this.getOrient()}-grid`},{componentType:"angle"===this.getOrient()?tQ.circleAxisGrid:tQ.lineAxisGrid,mode:this._spec.mode},{skipTheme:!0});this._updateTickDataMarks(t),t.setMarkConfig({zIndex:null!=(s=null!=(n=null==(r=null==(i=this._spec.grid)?void 0:i.style)?void 0:r.zIndex)?n:null==(l=this._spec.grid)?void 0:l.zIndex)?s:ts.Axis_Grid,interactive:!1}),this._marks.addMark(t),this._gridMark=t}if((null==(a=this._option.globalInstance)?void 0:a.isAnimationEnable())&&!1!==(0,dx.Z)(this._option.getChart().getSpec(),"animation")&&!0===this._spec.animation){let t=_l(null==(o=h9.getAnimationInKey("axis"))?void 0:o(),{appear:null!=(d=null!=(h=this._spec.animationAppear)?h:(0,dx.Z)(this._option.getChart().getSpec(),"animationAppear.axis"))?d:(0,dx.Z)(this._option.getChart().getSpec(),"animationAppear"),disappear:null!=(c=null!=(u=this._spec.animationDisappear)?u:(0,dx.Z)(this._option.getChart().getSpec(),"animationDisappear.axis"))?c:(0,dx.Z)(this._option.getChart().getSpec(),"animationDisappear"),enter:null!=(g=null!=(p=this._spec.animationEnter)?p:(0,dx.Z)(this._option.getChart().getSpec(),"animationEnter.axis"))?g:(0,dx.Z)(this._option.getChart().getSpec(),"animationEnter"),exit:null!=(m=null!=(f=this._spec.animationExit)?f:(0,dx.Z)(this._option.getChart().getSpec(),"animationExit.axis"))?m:(0,dx.Z)(this._option.getChart().getSpec(),"animationExit"),update:null!=(v=null!=(y=this._spec.animationUpdate)?y:(0,dx.Z)(this._option.getChart().getSpec(),"animationUpdate.axis"))?v:(0,dx.Z)(this._option.getChart().getSpec(),"animationUpdate")});t.enter&&(t.update[0].customParameters={enter:t.enter[0]}),this._marks.forEach(e=>e.setAnimationConfig(t))}}}_shouldComputeTickData(){return this.getVisible()||this._spec.forceInitTick}_initData(){let t=this._initTickDataSet(this._tickTransformOption()),e=new pV(this._option,t);this._tickData=[e],t.target.addListener("change",()=>{this._onTickDataChange(e)})}collectData(t,e){let i=[];return C$(this._regions,r=>{var n;let l=this.collectSeriesField(t,r);if(l=(0,rD.Z)(l)?(0,pW.z2)(this._scale.type)?l:[l[0]]:[l],t||(this._dataFieldText=r.getFieldAlias(l[0])),l){let t=r.getViewData();if(e)l.forEach(t=>{i.push(r.getRawDataStatisticsByField(t,!!(0,pW.z2)(this._scale.type)))});else if(t&&t.latestData&&t.latestData.length){let e=null==(n=r.getViewDataStatistics)?void 0:n.call(r),s=this.type===oQ.cartesianLinearAxis&&this._spec.breaks&&this._spec.breaks.length;l.forEach(r=>{var n;(null==(n=null==e?void 0:e.latestData)?void 0:n[r])&&(s?i.push(Object.assign(Object.assign({},e.latestData[r]),{values:t.latestData.map(t=>t[r])})):i.push(e.latestData[r]))})}}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),i}isSeriesDataEnable(){let t=!0;return C$(this._regions,e=>{var i;(0,rD.Z)(null==(i=e.getViewDataStatistics())?void 0:i.latestData)&&(t=!1)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),t}setSeriesAndRegionsFromSpec(){let{seriesId:t,seriesIndex:e,regionId:i,regionIndex:r}=this._spec;(0,aw.Z)(t)&&(this._seriesUserId=(0,a1.IX)(t)),(0,aw.Z)(i)&&(this._regionUserId=(0,a1.IX)(i)),(0,aw.Z)(e)&&(this._seriesIndex=(0,a1.IX)(e)),(0,aw.Z)(r)&&(this._regionIndex=(0,a1.IX)(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionIndex),this.layout.layoutBindRegionID=this._regions.map(t=>t.id)}getBindSeriesFilter(){return{userId:this._seriesUserId,specIndex:this._seriesIndex}}initEvent(){this.event.on(J.scaleUpdate,{filter:({model:t})=>(null==t?void 0:t.id)===this.id},this.effect.scaleUpdate.bind(this));let t=Cq(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}).map(t=>t.getViewDataStatistics()).filter(t=>!!t);t.length>1?this._option.dataSet.multipleDataViewAddListener(t,"change",()=>{this.updateScaleDomain()}):1===t.length&&t[0].target.addListener("change",()=>{this.updateScaleDomain()}),C$(this._regions,t=>{t.event.on(J.rawDataUpdate,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>{this._clearRawDomain()})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}updateScaleDomain(){}_clearRawDomain(){}onLayoutEnd(){this.updateScaleRange(),this.event.emit(J.scaleUpdate,{model:this,value:"range"}),super.onLayoutEnd()}computeData(t){"force"!==t||this._tickData&&this._tickData.length?!this._tickData||!this._tickData.length||"force"!==t&&(0,uL.X)(this._scale.range(),[0,1])||this._tickData.forEach(t=>{t.getDataView().reRunAllTransform({skipEqual:!0})}):C$(this._regions,t=>{var e;null==(e=t.getViewData())||e.reRunAllTransform()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_updateTickDataMarks(t){this._tickData&&this._tickData.forEach(e=>{e.addRelatedMark(t)})}initScales(){this._scales=[this._scale];let t=[];if(C$(this._regions,e=>{let i=e.getGroups();i&&t.push(i)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),0!==t.length){let e=(0,a1.CE)(t.map(t=>t.fields.length));for(let t=1;t<e;t++){let t=this._scale.clone();this._scales.push(t)}}}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reRender=!0,(null==e?void 0:e.type)!==(null==t?void 0:t.type)||(null==e?void 0:e.visible)!==(null==t?void 0:t.visible)?i.reMake=!0:i.reMake=["grid","subGrid","tick","subTick","label","domainLine","title"].some(i=>{var r,n;return(null==(r=null==e?void 0:e[i])?void 0:r.visible)!==(null==(n=null==t?void 0:t[i])?void 0:n.visible)})),i}_getAxisAttributes(){var t;let e=this._spec,i={orient:this.getOrient(),select:!0!==this._option.disableTriggerEvent&&e.select,hover:!0!==this._option.disableTriggerEvent&&e.hover};if((e.domainLine&&e.domainLine.visible?((t=xu(t=e.domainLine)).startSymbol=xu(t.startSymbol),t.endSymbol=xu(t.endSymbol),i.line=t):i.line={visible:!1},e.label&&e.label.visible)?(i.label=(0,xN.Z)(e.label,["style","formatMethod","state"]),e.label.style&&(i.label.style=(0,nz.Z)(e.label.style)?(t,i,r,n)=>{var l;let s=e.label.style(t.rawValue,i,t,r,n);return xg(h5({},null==(l=this._theme.label)?void 0:l.style,s))}:xg(e.label.style)),(e.label.formatMethod||e.label.formatter)&&(i.label.formatMethod=this._getLabelFormatMethod()),e.label.state&&(i.label.state=function(t){if((0,uF.Z)(t))return null;let e={};return Object.keys(t).forEach(i=>{(0,nz.Z)(t[i])?e[i]=(e,r,n,l)=>xg(t[i](e.rawValue,r,e,n,l)):(0,uF.Z)(t[i])||(e[i]=xg(t[i]))}),e}(e.label.state)),(0,nz.Z)(e.label.dataFilter)&&(i.label.dataFilter=(t,i)=>e.label.dataFilter(t,i,{vchart:this._option.globalInstance}))):i.label={visible:!1},e.tick&&e.tick.visible?(i.tick={visible:e.tick.visible,length:e.tick.tickSize,inside:e.tick.inside,alignWithLabel:e.tick.alignWithLabel,dataFilter:(0,nz.Z)(e.tick.dataFilter)?t=>e.tick.dataFilter(t,{vchart:this._option.globalInstance}):void 0},e.tick.style&&(i.tick.style=(0,nz.Z)(e.tick.style)?(t,i,r,n)=>{var l;let s=e.tick.style(t,i,r,n);return xg(h5({},null==(l=this._theme.tick)?void 0:l.style,s))}:xg(e.tick.style)),e.tick.state&&(i.tick.state=xc(e.tick.state))):i.tick={visible:!1},e.subTick&&e.subTick.visible?(i.subTick={visible:e.subTick.visible,length:e.subTick.tickSize,inside:e.subTick.inside,count:e.subTick.tickCount},e.subTick.style&&(i.subTick.style=(0,nz.Z)(e.subTick.style)?(t,i,r,n)=>{var l;let s=e.subTick.style(t,i,r,n);return xg(h5({},null==(l=this._theme.subTick)?void 0:l.style,s))}:xg(e.subTick.style)),e.subTick.state&&(i.subTick.state=xc(e.subTick.state))):i.subTick={visible:!1},e.title&&e.title.visible){let t=e.title,{autoRotate:r,angle:n,style:l={},background:s,state:a,shape:o}=t,h=xK(t,["autoRotate","angle","style","background","state","shape"]),d,u=n;"left"!==e.orient&&"right"!==e.orient||r&&(0,nB.Z)(u)&&(u="left"===e.orient?-90:90,d=xf[e.orient]),i.title=Object.assign(Object.assign({},h),{autoRotate:!1,angle:u?(0,iH.M4)(u):null,textStyle:h5({},d,xg(l)),pickable:!1!==l.pickable,childrenPickable:!1!==l.pickable,state:{}}),o&&o.visible?(i.title.shape=Object.assign(Object.assign({},o),{style:xg(o.style)}),o.state&&(i.title.state.shape=xc(o.state))):i.title.shape={visible:!1},s&&s.visible?(i.title.background=Object.assign(Object.assign({},s),{style:xg(s.style)}),s.state&&(i.title.state.background=xc(s.state))):i.title.background={visible:!1},a&&(i.title.state.text=xc(a))}else i.title={visible:!1};return e.background&&e.background.visible?(i.panel={visible:!0},e.background.style&&(i.panel.style=xg(e.background.style)),e.background.state&&(i.panel.state=xc(e.background.state))):i.panel={visible:!1},i}_getGridAttributes(){let t=this._spec;return{alternateColor:t.grid.alternateColor,alignWithLabel:t.grid.alignWithLabel,style:(0,nz.Z)(t.grid.style)?(e,i)=>{var r,n;let l=t.grid.style(null==(r=e.datum)?void 0:r.rawValue,i,e.datum);return xg(h5({},null==(n=this._theme.grid)?void 0:n.style,l))}:xg(t.grid.style),subGrid:!1===t.subGrid.visible?{visible:!1}:{type:"line",visible:t.subGrid.visible,alternateColor:t.subGrid.alternateColor,style:xg(t.subGrid.style)}}}_getLabelFormatMethod(){let{formatMethod:t,formatter:e}=this._spec.label,{formatFunc:i}=bz(t,e);return i?(t,r,n)=>i(r.rawValue,r,e):null}_initTickDataSet(t,e=0){dF(this._option.dataSet,"scale",xU);let i=this.registerTicksTransform();return new eq.V(this._option.dataSet,{name:`${this.type}_${this.id}_ticks_${e}`}).parse(this._scales[e],{type:"scale"}).transform({type:i,options:t},!1)}_tickTransformOption(){let t=this._tick||{},e=this._spec.label||{},{tickCount:i,forceTickCount:r,tickStep:n,tickMode:l}=t,{style:s,formatMethod:a,minGap:o}=e;return{sampling:!1!==this._spec.sampling,tickCount:i,forceTickCount:r,tickStep:n,tickMode:l,axisOrientType:this._orient,coordinateType:this._coordinateType,labelStyle:s,labelFormatter:a,labelGap:o}}addTransformToTickData(t,e){this._tickData.forEach(i=>{var r;null==(r=null==i?void 0:i.getDataView())||r.transform(t,e)})}dataToPosition(t){return this._scale.scale(t)}getDatum(t){var e;return t&&t.name===t0.label?t.data:this._axisMark?null==(e=this._axisMark.getComponent())?void 0:e.attribute.items:void 0}scaleRangeFactor(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactor(t,e,i)}scaleRangeFactorEnd(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorEnd(t,e)}scaleRangeFactorStart(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorStart(t,e)}}xX.specKey="axes";let xY=()=>{xG(),h9.registerAnimation("axis",()=>({appear:{type:"fadeIn"},enter:{type:"fadeIn"},update:{type:"update"},exit:{type:"fadeOut"}}))},x$=t=>{let{x:e,y:i}=t[0].getLayoutStartPoint(),r=e+t[0].getLayoutRect().width,n=i+t[0].getLayoutRect().height;for(let l=1;l<t.length;l++){let s=t[l],{x:a,y:o}=s.getLayoutStartPoint(),{width:h,height:d}=s.getLayoutRect();e=Math.min(e,a),r=Math.max(r,h+a),i=Math.min(i,o),n=Math.max(n,d+o)}return{width:Math.abs(r-e),height:Math.abs(n-i)}};var xq=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let xJ=[xd];class xQ extends xX{getOrient(){return this._orient}getDefaultInteractive(){return!0}set autoIndentOnce(t){this._autoIndentOnce=t}getScales(){return this._scales}getInnerOffset(){return this._innerOffset}constructor(t,e){super(t,e),this.type=oQ.cartesianAxis,this.name=oQ.cartesianAxis,this._defaultBandPosition=.5,this._defaultBandInnerPadding=.1,this._defaultBandOuterPadding=.3,this.layoutType="region-relative",this.layoutZIndex=ts.Axis,this.layoutLevel=ta.Axis,this._orient="left",this._autoIndentOnce=!1,this._hasAutoIndent=!1,this._scales=[],this._tick=void 0,this._layoutCache={width:0,height:0,_lastComputeOutBounds:{x1:0,x2:0,y1:0,y2:0}},this._innerOffset={top:0,bottom:0,left:0,right:0},this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),C$(this._regions,t=>{let e=this.getOrient();CQ(e)?xC(t.getXAxisHelper(),this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&t.setXAxisHelper(this.axisHelper()):C0(e)?xC(t.getYAxisHelper(),this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&t.setYAxisHelper(this.axisHelper()):C1(e)&&xC(t.getZAxisHelper(),this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&t.setZAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=t=>{let{x:e,y:i}=t;return(0,hy.Z)(e)&&(e+=Number("left"===this._orient)*this.getLayoutRect().width),(0,hy.Z)(i)&&(i+=Number("top"===this._orient)*this.getLayoutRect().height),{x:e,y:i}},this._transformLayoutRect=t=>{if(!this._visible)return t;let e=this._latestBounds.clone().translate(-this.getLayoutStartPoint().x,-this.getLayoutStartPoint().y);switch(this._layout.layoutOrient){case"left":this._layout.layoutRectLevelMap.width===pr&&(t.width=e.x1<0?-e.x1:0);break;case"right":this._layout.layoutRectLevelMap.width===pr&&(t.width=e.x2>0?e.x2:0);break;case"top":this._layout.layoutRectLevelMap.height===pr&&(t.height=e.y1<0?-e.y1:0);break;case"bottom":this._layout.layoutRectLevelMap.height===pr&&(t.height=e.y2>0?e.y2:0)}return t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),this._layout.setRectInSpec(this._layoutCacheProcessing(t))},this._transformLayoutPadding=t=>("left"===this.layoutOrient||"right"===this.layoutOrient?(t.top=0,t.bottom=0):"top"!==this.layoutOrient&&"bottom"!==this.layoutOrient||(t.left=0,t.right=0),t),this._updateAxisLayout=()=>{let t=this.getLayoutStartPoint(),e=this._getUpdateAttribute(!1),{grid:i}=e,r=xq(e,["grid"]),n=h5({x:t.x,y:t.y},this._axisStyle,r);this._axisMark.setSimpleStyle(n),this._gridMark&&this._gridMark.setSimpleStyle(h5({x:t.x,y:t.y},this._getGridAttributes(),i))},this._fixAxisOnZero=()=>{let{onZero:t,visible:e}=this._spec.domainLine;if(this.visible&&t&&!1!==e){let{onZeroAxisId:t,onZeroAxisIndex:e}=this._spec.domainLine,i=this._option.getComponentsByKey("axes"),r=CQ(this.getOrient()),n=t=>{var e;return(r?!CQ(t.getOrient()):CQ(t.getOrient()))&&(0,pW.z2)(t.getScale().type)&&(t.getTickData()?null==(e=t.getTickData().getLatestData())?void 0:e.find(t=>0===t.value):t.getScale().domain()[0]<=0&&(0,a1.Z$)(t.getScale().domain())>=0)},l=i.filter(t=>n(t));if(l.length){let s;if((0,aw.Z)(t))s=l.find(e=>e.id===t);else if((0,aw.Z)(e)){let t=i[e];n(t)&&(s=t)}else s=l[0];if(s){let t=this._axisMark,e=s.valueToPosition(0);r?t.setSimpleStyle(Object.assign(Object.assign({},t.getSimpleStyle()),{line:Object.assign(Object.assign({},this._axisStyle.line),{dy:"bottom"===this._orient?-((s.getInverse()?s.getScale().range()[1]:s.getScale().range()[0])-e):e})})):t.setSimpleStyle(Object.assign(Object.assign({},t.getSimpleStyle()),{line:Object.assign(Object.assign({},this._axisStyle.line),{dx:"left"===this._orient?e:-((s.getInverse()?s.getScale().range()[0]:s.getScale().range()[1])-e)})}))}}}},this._orient=C2(t,["z"]),C1(this._orient)&&(this.layoutType="absolute"),this._dataSet=e.dataSet,this._coordinateType="cartesian"}static getSpecInfo(t){let e=t[this.specKey];if(!e)return null;let i="horizontal"===t.direction;if(!(0,rD.Z)(e)){if(!xv(e))return null;let{axisType:t,componentName:r}=C5(e,i);return e.type=t,[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:r}]}let r=!0;if(e.filter(t=>"z"===t.orient)[0]){let t=e.filter(t=>"bottom"===t.orient)[0],i=e.filter(t=>C0(t.orient))[0];r=3===e.length&&t&&i}let n=e.map((t,e)=>({spec:t,index:e}));r||(n=n.filter(({spec:t})=>"z"!==t.orient));let l=[];return n.forEach(({spec:t,index:e})=>{if(!xv(t))return;let{axisType:r,componentName:n}=C5(t,i);t.type=r,l.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:n})}),l}static createComponent(t,e){let{spec:i}=t,r=xq(t,["spec"]),n=h9.getComponentInKey(r.type);return n?new n(i,Object.assign(Object.assign({},e),r)):(e.onError(`Component ${r.type} not found`),null)}initLayout(){super.initLayout(),this._layout.autoIndent=!1!==this._spec.autoIndent,this._layout.layoutOrient=this._orient}getNewScaleRange(){let{width:t,height:e}=this.getLayoutRect(),{left:i,right:r,top:n,bottom:l}=this._innerOffset,s=[];return CQ(this.getOrient())?(0,hy.Z)(t)&&(s=this._inverse?[t-r,i]:[i,t-r]):C1(this.getOrient())?(0,hy.Z)(t)&&(s=this._inverse?[t-r,i]:[i,t-r],this._scale.range(s)):(0,hy.Z)(e)&&(s=this._inverse?[n,e-l]:[e-l,n]),s}updateScaleRange(){let t=!1,e=this.getNewScaleRange(),i=this._scale.range();return e.length===i.length&&e.every((t,e)=>t===i[e])?t=!1:(t=!0,this._scale.range(e)),t}init(t){var e;super.init(t),null==(e=this.pluginService)||e.load(xJ.map(t=>new t)),this.callPlugin(t=>{this.pluginService&&t.onInit&&t.onInit(this.pluginService,this)})}setAttrFromSpec(){var t,e,i;let r;if(super.setAttrFromSpec(),this.visible){CQ(this.getOrient())?(0,dU.Z)(this._spec.maxHeight)&&(this._spec.maxHeight="30%"):(0,dU.Z)(this._spec.maxWidth)&&(this._spec.maxWidth="30%");let t=this._getAxisAttributes();t.label.formatMethod=this._getLabelFormatMethod(),t.verticalFactor="top"===this.getOrient()||"right"===this.getOrient()?-1:1,this._axisStyle=t}this._tick=this._spec.tick;let n=null==(t=this._option.getChart())?void 0:t.getSpec();this._inverse=(e=this._spec,i="horizontal"===(null==n?void 0:n.direction),r=e.inverse,i&&!CQ(e.orient)&&(r=!(0,aw.Z)(e.inverse)||!e.inverse),r)}onLayoutStart(t,e){if(super.onLayoutStart(t,e),!C1(this.getOrient())&&this._spec.innerOffset){let t=this._spec;C0(this.getOrient())?["top","bottom"].forEach(i=>{this._innerOffset[i]=hw(t.innerOffset[i],e.height,e)}):["left","right"].forEach(i=>{this._innerOffset[i]=hw(t.innerOffset[i],e.width,e)})}}getSeriesStatisticsField(t){let e;return e=CQ(this.getOrient())?t.fieldX:C1(this.getOrient())?t.fieldZ:t.fieldY,(0,pW.z2)(this._scale.type)?e:[e[0]]}_tickTransformOption(){var t,e,i,r;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimals:null==(t=this._tick)?void 0:t.noDecimals,labelLastVisible:null==(e=this._spec.label)?void 0:e.lastVisible,labelFirstVisible:null==(i=this._spec.label)?void 0:i.firstVisible,labelFlush:null==(r=this._spec.label)?void 0:r.flush})}axisHelper(){return{isContinuous:(0,pW.z2)(this._scale.type),dataToPosition:this.dataToPosition.bind(this),getScale:(t=0)=>this._scales[t],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!0===this._inverse,getSpec:()=>this._spec}}afterCompile(){var t;(null==(t=this._axisMark)?void 0:t.getProduct())&&this.event.on(q.AFTER_ELEMENT_ENCODE,({mark:t})=>{if(t===this._axisMark&&!1===this._isLayout&&(CQ(this.getOrient())?this.callPlugin(t=>{this.pluginService&&t.onDidLayoutHorizontal&&t.onDidLayoutHorizontal(this.pluginService,this)}):this.callPlugin(t=>{this.pluginService&&t.onDidLayoutVertical&&t.onDidLayoutVertical(this.pluginService,this)}),this._unitText)){let{x:t,y:e}=this.getLayoutStartPoint(),i=CQ(this._orient)?{x:(0,a1.CE)(this._scale.range())+t,y:e}:{x:t,y:(0,a1.iH)(this._scale.range())+e};this._unitText.setAttributes(i)}}),this.callPlugin(t=>{this.pluginService&&t.onDidCompile&&t.onDidCompile(this.pluginService,this)})}collectScale(){let t=[];return C$(this._regions,e=>{t.push("left"===this.getOrient()||"right"===this.getOrient()?e.scaleY:e.scaleX)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),t}collectSeriesField(t,e){var i,r;return t>0?null==(r=null==(i=e.getGroups())?void 0:i.fields)?void 0:r[t]:CQ(this.getOrient())?e.getSpec().x2Field?[...e.fieldX,e.fieldX2]:e.fieldX:C1(this.getOrient())?e.fieldZ:e.getSpec().y2Field?[...e.fieldY,e.fieldY2]:e.fieldY}updateSeriesScale(){let t=this.getOrient();C$(this._regions,e=>{CQ(t)?xC(e.getXAxisHelper(),this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&(e.setScaleX(this._scale),e.setXAxisHelper(this.axisHelper())):C0(t)?xC(e.getYAxisHelper(),this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&(e.setScaleY(this._scale),e.setYAxisHelper(this.axisHelper())):C1(t)&&xC(e.getZAxisHelper(),this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&(e.setScaleZ(this._scale),e.setZAxisHelper(this.axisHelper()))},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getBoundsInRect(t){var e;let i={x1:0,y1:0,x2:0,y2:0};if(!this._visible)return i;this._verticalLimitSize=CQ(this.getOrient())?t.height:t.width,this.setLayoutRect(t),!this.updateScaleRange()&&(0,rD.Z)(null==(e=this.getTickData())?void 0:e.getLatestData())||this.computeData("range");let r={skipLayout:!1},n=CQ(this.getOrient());this.pluginService&&(n?this.callPlugin(t=>{t.onWillLayoutHorizontal&&t.onWillLayoutHorizontal(this.pluginService,r,this)}):this.callPlugin(t=>{t.onWillLayoutVertical&&t.onWillLayoutVertical(this.pluginService,r,this)}));let l=this._axisMark.getProduct(),s=!1;if(!r.skipLayout){let t=this._getUpdateAttribute(!0),e=this._axisMark.getComponent(),r=h5(Object.assign({},this.getLayoutStartPoint()),this._axisStyle,t,{line:{visible:!1}}),l=null==e?void 0:e.getBoundsWithoutRender(r);l&&!l.empty()||(l=(new iI.YZ).set(r.x,r.y,r.x,r.y)),s=!0,this._latestBounds=l,i=this._appendAxisUnit(l,n)}return s||(this._latestBounds=l.AABBBounds),i}positionToData(t,e){let i=CQ(this.getOrient());e&&(t-=i?this.getLayoutStartPoint().x:this.getLayoutStartPoint().y),this._innerOffset&&(t=i?(0,yj.Z)(t,this._innerOffset.left,this.getLayoutRect().width-this._innerOffset.right):(0,yj.Z)(t,this._innerOffset.top,this.getLayoutRect().height-this._innerOffset.bottom));let r=this._scale.range();return(t-r[0])*(t-(0,a1.Z$)(r))>0?null:this._scale.invert(t)}_getTitleLimit(t){var e,i,r,n,l;let s=this._spec.title;if(s.visible&&(0,nB.Z)(null==(e=s.style)?void 0:e.maxLineWidth)){let e=null!=(l=null!=(r=null==(i=this._axisStyle.title)?void 0:i.angle)?r:null==(n=s.style)?void 0:n.angle)?l:0;if(t){let t=this.getLayoutRect().width,i=Math.abs(Math.cos(e));return i<1e-6?1/0:t/i}let a=this.getLayoutRect().height,o=Math.abs(Math.sin(e));return o<1e-6?1/0:a/o}return null}_getUpdateAttribute(t){let e=0,i=0;if(!t){let t=x$(this.getRegions());i=t.width,e=t.height}let{width:r,height:n}=this.getLayoutRect(),l=CQ(this._orient),s=C0(this._orient),a={x:0,y:0},o=e,h=r;l?a={x:r,y:0}:s&&(a={x:0,y:n},o=i,h=n);let d=this.getLabelItems(h),u={start:{x:0,y:0},end:a,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(l)},items:d,scale:this._scale.clone(),maxWidth:this._layout.maxWidth,minWidth:this._layout.minWidth,width:this._spec.width?this.getLayoutRect().width:void 0};t||(u.grid={type:"line",start:{x:0,y:0},end:a,items:d[0],verticalFactor:this._axisStyle.verticalFactor,length:o});let c=l?this.layout.minHeight:this.layout.minWidth;return(l&&this._layout.layoutRectLevelMap.height===pi||s&&this._layout.layoutRectLevelMap.width===pi)&&(c=this._verticalLimitSize),u.verticalLimitSize=this._verticalLimitSize,u.verticalMinSize=c,u.label={overflowLimitLength:this._getLabelOverflowLimit(l)},this._afterUpdateAttribute?this._afterUpdateAttribute(u,t):u}getLabelItems(t){var e;let i=null==(e=this.getTickData())?void 0:e.getLatestData();return i&&i.length?[i.map(e=>{let i=this._getNormalizedValue([e.value],t);return x_(e.value,i)}).filter(t=>{let{value:e,rawValue:i}=t,r=this._scale.domain();return"log"===this.getSpec().type?e>=0&&e<=1:(0,pW.z2)(this._scale.type)?i>=r[0]&&i<=(0,a1.Z$)(r):r.includes(i)})]:[]}initEvent(){super.initEvent(),this.visible&&(this.event.on(J.layoutEnd,this._updateAxisLayout),this.event.on(J.layoutEnd,this._fixAxisOnZero),this.event.on(J.layoutRectUpdate,()=>{this._clearLayoutCache()}))}_getNormalizedValue(t,e){return 0===e?0:this.dataToPosition(t)/e}_layoutCacheProcessing(t){return["width","height"].forEach(e=>{t[e]<this._layoutCache[e]?t[e]=this._layoutCache[e]:this._layoutCache[e]=t[e]}),this._autoIndentOnce&&this._hasAutoIndent?["x1","x2","y1","y2"].forEach(t=>{this.layout.getLastComputeOutBounds()[t]=this._layoutCache._lastComputeOutBounds[t]}):(this._hasAutoIndent=!0,["x1","x2","y1","y2"].forEach(t=>{this.layout.getLastComputeOutBounds()[t]<this._layoutCache._lastComputeOutBounds[t]?this.layout.getLastComputeOutBounds()[t]=this._layoutCache._lastComputeOutBounds[t]:this._layoutCache._lastComputeOutBounds[t]=this.layout.getLastComputeOutBounds()[t]})),t}reInit(t){super.reInit(t),this._clearLayoutCache()}_clearLayoutCache(){this._hasAutoIndent=!1,this._layoutCache.width=0,this._layoutCache.height=0,this._layoutCache._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0}}onDataUpdate(){this._clearLayoutCache()}_appendAxisUnit(t,e){var i;if(this._spec.unit&&this._spec.unit.visible){let r,n,{text:l,style:s}=this._spec.unit,{x:a,y:o}=this.getLayoutStartPoint();e?(r={x:(0,a1.CE)(this._scale.range())+a,y:o},n={textAlign:"left",textBaseline:"middle"}):(r={x:a,y:(0,a1.iH)(this._scale.range())+o},n={textAlign:"left"===this._orient?"left":"right",textBaseline:"bottom"}),n=Object.assign(Object.assign(Object.assign({},n),s),{x:r.x,y:r.y,text:l}),this._unitText?this._unitText.setAttributes(n):(this._unitText=uj(n),this._unitText.name="axis-unit",null==(i=this.getContainer())||i.add(this._unitText));let h=this._unitText.AABBBounds;e?(t.x2+=h.x2>t.x2?h.x2-t.x2:0,t.y2+=h.y2>t.y2?h.y2-t.y2:0):(t.x1+=h.x1<t.x1?h.x1-t.x1:0,t.y1+=h.y1<t.y1?h.y1-t.y1:0)}return t}_getNeedClearVRenderComponents(){return this._unitText?[this._unitText]:[]}_getLabelOverflowLimit(t){var e,i;if(t&&!1!==(null==(e=this._spec.label)?void 0:e.visible)&&!0===(null==(i=this._spec.label)?void 0:i.autoLimit)){let t=this._option.getComponentsByKey("axes"),e=this.getRegions(),i=t.filter(t=>{let i=t.getOrient();return("left"===i||"right"===i)&&t.getRegions().some(t=>e.includes(t))}),r=0,n=0,l=this.getLayoutStartPoint().x,s=l+this.getLayoutRect().width;return i.forEach(t=>{let e=t.getLayoutStartPoint().x;if("left"===t.getOrient()&&e===l){let e=t.getLayoutRect().width;r=Math.max(r,e)}else if(e===s){let e=t.getLayoutRect().width;n=Math.max(n,e)}}),{left:r,right:n}}}}xQ.type=oQ.cartesianAxis,xQ.specKey="axes";class x0{constructor(){this._rawDomainIndex=[],this._rawDomain=[]}_initData(){var t;if(this._spec.showAllGroupLayers&&this._scales.length>1)for(let e=0;e<this._scales.length;e++){let i=(null!=(t=this._spec.layers)?t:[])[this._scales.length-1-e]||{};if(!1!==i.visible&&0!==i.tickCount&&0!==i.forceTickCount){let t=this._initTickDataSet(Object.assign(Object.assign({},this._tickTransformOption()),i),e),r=new pV(this._option,t);this._tickData.push(r),t.target.addListener("change",()=>{this._onTickDataChange(r)}),this._tickDataMap||(this._tickDataMap={}),this._tickDataMap[e]=r}}else{let t=this._initTickDataSet(this._tickTransformOption()),e=new pV(this._option,t);t.target.addListener("change",()=>{this._onTickDataChange(e)}),this._tickData=[e],this._tickDataMap={0:e}}}_updateData(){var t,e,i;let r=this.registerTicksTransform();if(this._spec.showAllGroupLayers&&this._scales.length>1){let e=null!=(t=this._spec.layers)?t:[];Object.keys(this._tickDataMap).forEach(t=>{let i=e[this._scales.length-1-t]||{},n=this._tickDataMap[t],l=null==n?void 0:n.getDataView().transformsArr.find(t=>t.type===r);l&&(l.options=Object.assign(Object.assign({},this._tickTransformOption()),i))})}else{let t=null==(i=null==(e=this._tickData)?void 0:e[0])?void 0:i.getDataView().transformsArr.find(t=>t.type===r);t&&(t.options=this._tickTransformOption())}}getRawDomain(){return this._rawDomain}dataToPosition(t,e={}){var i,r;if(0===t.length||0===this._scales.length)return 0;let{position:n,bandScale:l}=this.getPosition(t);return n+l.bandwidth()*(null!=(r=null!=(i=e.bandPosition)?i:this._spec.bandPosition)?r:this._defaultBandPosition)}valueToPosition(t){return this._scale.scale(t)}updateGroupScaleRange(){let t=this._scale;this._scales.forEach((e,i)=>{i>0&&(e.range([0,t.bandwidth()]),t=e)})}getPosition(t){let e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{let r=Math.min(t.length,this._scales.length);for(let i=0;i<r;i++)e+=this._scales[i].scale(t[i]);i=this._scales[r-1]}return{position:e,bandScale:i}}calcScales(t,e){var i,r;let{bandPadding:n,paddingInner:l,paddingOuter:s}=this._spec,a=(0,rD.Z)(n),o=(0,rD.Z)(l),h=(0,rD.Z)(s);for(let d=0;d<this._scales.length;d++){let u=a?n[d]:n,c=o?l[d]:l,p=h?s[d]:s;this._scales[d].paddingInner(null!=(i=null!=c?c:u)?i:t,!0).paddingOuter(null!=(r=null!=p?p:u)?r:e,!0)}}computeBandDomain(t){if(!t.length)return[];if(1===t.length)return t[0].values;let e=new Set;for(let i=0;i<t.length;i++)for(let r=0;r<t[i].values.length;r++)e.add(t[i].values[r]);return Array.from(e)}updateScaleDomain(){var t;if(!this.isSeriesDataEnable())return;(null==(t=this._rawDomainIndex)?void 0:t.length)||!this._scales.length||this._updateRawDomain();let e=this._spec.domain;for(let t=0;t<this._scales.length;t++)if(e&&e.length&&0===t)this._scales[t].domain(e);else{let e=this.collectData(t),i=this.computeBandDomain(e);this._scales[t].domain(i.sort((e,i)=>this._rawDomainIndex[t][e]-this._rawDomainIndex[t][i]))}this.transformScaleDomain(),this.event.emit(J.scaleDomainUpdate,{model:this}),this.event.emit(J.scaleUpdate,{model:this,value:"domain"})}getLabelItems(t){let e=[],i=[];return(this._spec.showAllGroupLayers?this._scales:[this._scales[0]]).forEach((r,n)=>{var l;let s=this._tickDataMap[n],a=null==(l=null==s?void 0:s.getLatestData())?void 0:l.length,o=a?s.getLatestData().map(t=>t.value):r.domain();if(o&&o.length)if(i&&i.length){let r=[],n=[];i.forEach(e=>{o.forEach(i=>{let l=(0,a1.IX)(e).concat(i);if(n.push(l),a){let e=x_(i,this._getNormalizedValue(l,t));r.push(e)}})}),a&&e.push(r.filter(t=>t.value>=0&&t.value<=1)),i=n}else o.forEach(t=>{i.push(t)}),a&&e.push(s.getLatestData().map(e=>x_(e.value,this._getNormalizedValue([e.value],t))).filter(t=>t.value>=0&&t.value<=1))}),e.reverse()}_updateRawDomain(){this._rawDomainIndex=[],this._rawDomain=[];let t=this._spec.domain;for(let e=0;e<this._scales.length;e++)if(t&&t.length&&0===e)this._scales[e].domain(t);else{let t=this.collectData(e,!0),i=this.computeBandDomain(t);this._rawDomainIndex[e]={},this._rawDomain[e]=i,i.forEach((t,i)=>this._rawDomainIndex[e][t]=i)}this.event.emit(J.scaleRawDomainUpdate,{model:this})}_clearRawDomain(){this._rawDomainIndex=[],this._rawDomain=[]}}var x1=i(51400);let x2=(t,e,i,r)=>{let n=xs(t,e,i);return n&&n.map(t=>r?[t.x1,t.x2,t.width()]:[t.y1,t.y2,t.height()])},x3=(t,e,i=0)=>Math.max(t[0],e[0])-i/2<=Math.min(t[1],e[1])+i/2,x5=(t,e)=>t[1]<e[0]?e[0]-t[1]:e[1]<t[0]?t[0]-e[1]:0,x4=(t,e)=>{var i;let r,n=t.domain();if(!n.length)return[];let{tickCount:l,forceTickCount:s,tickStep:a,labelGap:o=4,axisOrientType:h,labelStyle:d}=e,u=xa(h),c=t.range(),p=t.calculateWholeRangeSize();if(p<2)return e.labelLastVisible?xr([n[n.length-1]]):xr([n[0]]);if((0,aw.Z)(a))r=t.stepTicks(a);else if((0,aw.Z)(s))r=t.forceTicks(s);else if((0,aw.Z)(l)){let e=(0,nz.Z)(l)?l({axisLength:p,labelStyle:d}):l;r=t.ticks(e)}else if(e.sampling){let l=(null!=(i=e.labelStyle.fontSize)?i:12)+2,s=(0,a1.iH)(c),a=(0,a1.CE)(c);if(n.length<=p/l){let i=x2(t,n,e,u);if(i){let l=Math.min(...i.map(t=>t[2])),h=(a-s)/n.length,d=x6(n,i,o,e.labelLastVisible,Math.floor(l/h),!1);r=t.stepTicks(d.step),e.labelLastVisible&&(d.delCount&&(r=r.slice(0,r.length-d.delCount)),r.push(n[n.length-1]))}}else{let i=x2(t,[n[0],n[Math.floor(n.length/2)],n[n.length-1]],e,u);if(i){let l=null;i.forEach(t=>{l?l[2]<t[2]&&(l=t):l=t});let h=a-s-o>0?Math.ceil(n.length*(o+l[2])/(a-s-o)):n.length-1;r=t.stepTicks(h),!e.labelLastVisible||r.length&&r[r.length-1]===n[n.length-1]||(r.length&&Math.abs(t.scale(r[r.length-1])-t.scale(n[n.length-1]))<l[2]&&(r=r.slice(0,-1)),r.push(n[n.length-1]))}}}return(0,nB.Z)(r)&&(r=t.domain()),xr(r)},x6=(t,e,i,r,n,l)=>{let s=0,a=0,o=-1,h=Number.MAX_VALUE,d=r=>{let n=!0,l=0;do l+r<t.length&&x3(e[l],e[l+r],i)&&(n=!1),l+=r;while(n&&l<t.length);return n},u=(0,x1.o0)(n,t.length,t=>d(t)?1:-1),c=u;do if(!(c>u)||l||d(c)){if(!r){a=c;break}{let r=t.length-1,n,l=0;n=t.length%c>0?t.length-t.length%c+c:t.length;do{if((n-=c)!==r&&!x3(e[n],e[r],i))break;l++}while(n>0);if(n===r){a=c,s=l;break}{let i=Math.floor(t.length/c)-l+1;if(i<o)break;{o=i;let t=x5(e[n],e[r]),d=n-c>=0?x5(e[n-c],e[n]):t,u=Math.abs(t-d);if(u<h&&(h=u,a=c,s=l),t<=d)break}}}c++}else c++;while(c<=t.length);return{step:a,delCount:s}};function x7(t,e){return[t[0]*e,t[1]*e]}function x8(t){let[e,i]=t;return Math.sqrt(e*e+i*i)}function x9(t,e,i){let r=function(t,e){let[i,r]=t,[n,l]=e,s=Math.sqrt((i*i+r*r)*(n*n+l*l));return Math.acos(Math.min(Math.max(s&&(i*n+r*l)/s,-1),1))}(t,e),n=(0,ik.ir)(t,e)>=0;return i?n?2*Math.PI-r:r:n?r:2*Math.PI-r}let wt={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},labelHoverOnAxis:{visible:!1,space:7,padding:2,position:0,autoRotate:!1,textStyle:{fontSize:12,fill:"red",fontWeight:"normal",fillOpacity:1},background:{visible:!0,style:{cornerRadius:2,fill:"black"}}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},we={size:8,stroke:"#000",lineWidth:1,zIndex:1},wi=Math.sin(Math.PI/10);function wr(t,e=wi){let i=!(0,nB.Z)(t)&&0!==t,r=i?Math.cos(t):1;return i&&Math.abs(r)<=e}function wn(t,e=wi){let i=!(0,nB.Z)(t)&&0!==t,r=i?Math.sin(t):0;return!i||Math.abs(r)<=e}function wl(t){let e={};return _X(t,t=>{"group"!==t.type&&t.id&&(e[t.id]=t)}),e}function ws(t,e){return{x:t.x+e[0],y:t.y+e[1]}}function wa(t,e,i,r=!1,n=!1){let l=[e.x-i.x,e.y-i.y];return x7(l,(r?-1:1)*(n?-1:1)*t/x8(l))}function wo(t,e,i,r,n){let l=[],s=n-r;for(let n=0;n<e;n++){let a=r+n*s/e;l.push((0,iH.op)(t,i,a))}return l}function wh(t,e){let i="";return 0===t.length||(t.forEach((t,e)=>{0===e?i=`M${t.x},${t.y}`:i+=`L${t.x},${t.y}`}),e&&(i+="Z")),i}function wd(t,e,i){var r;if(wn(null==(r=t.attribute)?void 0:r.angle,Number.EPSILON))return i>(0,yd.YB)(t.AABBBounds,e.AABBBounds);let n=t.OBBBounds,l=e.OBBBounds;return!n||!l||n.empty()||l.empty()?i>(0,yd.YB)(t.AABBBounds,e.AABBBounds):n.intersects(l)||i>(0,yd.up)(n,l)}function wu(t,e){for(let i,r=1,n=t.length,l=t[0];r<n;l=i,++r)if(wd(l,i=t[r],e))return!0;return!1}function wc(t,e,i,r){let n="";if(!t||0===e.length)return n;let l=e[0],s=iN.HL.distancePP(t,l),a=+!i;return r?n+=`M${t.x},${t.y-s}A${s},${s},0,0,${a},${t.x},${t.y+s}A${s},${s},0,0,${a},${t.x},${t.y-s}Z`:e.forEach((t,e)=>{0===e?n=`M${t.x},${t.y}`:n+=`A${s},${s},0,0,${a},${t.x},${t.y}`}),n}class wp extends CB{constructor(){super(...arguments),this.name="axis-grid",this.data=[]}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}render(){this._prevInnerView=this._innerView&&wl(this._innerView),this.removeAllChild(!0),this._innerView=ak.group({x:0,y:0,pickable:!1}),this.add(this._innerView);let{items:t,visible:e}=this.attribute;t&&t.length&&!1!==e&&(this.data=this._transformItems(t),this._renderGrid(this._innerView))}getVerticalCoord(t,e,i){return ws(t,this.getVerticalVector(e,i,t))}_transformItems(t){let e=[];return t.forEach(t=>{var i;e.push(Object.assign(Object.assign({},t),{point:this.getTickCoord(t.value),id:null!=(i=t.id)?i:t.label}))}),e}_renderGrid(t){let{visible:e}=this.attribute.subGrid||{};e&&this._renderGridByType(!0,t),this._renderGridByType(!1,t)}_renderGridByType(t,e){let i=(0,h3.Z)({},this.attribute,this.getGridAttribute(t)),{type:r,items:n,style:l,closed:s,alternateColor:a,depth:o=0}=i,h=t?`${t0.grid}-sub`:`${t0.grid}`;if(n.forEach((t,i)=>{let{id:n,points:a}=t,d="";if("line"===r||"polygon"===r)d=wh(a,!!s);else if("circle"===r){let{center:t}=this.attribute;d=wc(t,a,!1,!!s)}let u=ak.path(Object.assign({path:d,z:o},(0,nz.Z)(l)?(0,h3.Z)({},this.skipDefault?null:wp.defaultAttributes.style,l(t,i)):l));u.name=`${h}-line`,u.id=this._getNodeId(`${h}-path-${n}`),e.add(u)}),o&&"line"===r&&n.forEach((t,i)=>{let{id:r,points:n}=t,a=[];a.push(n[0]);let d=n[1].x-n[0].x,u=n[1].y-n[0].y,c=o/Math.sqrt(d*d+u*u);a.push({x:n[0].x+d*c,y:n[0].y+u*c});let p=wh(a,!!s),g=(0,ik.Wn)(a[0].x-a[1].x),f=(0,ik.Wn)(a[0].y-a[1].y),m=ak.path(Object.assign({path:p,z:0,alpha:g>f?(n[1].x-n[0].x>0?-1:1)*ik.pi/2:0,beta:g<f?-ik.pi/2:0,anchor3d:g>f?[a[0].x,0]:[0,a[0].y]},(0,nz.Z)(l)?(0,h3.Z)({},this.skipDefault?null:wp.defaultAttributes.style,l(t,i)):l));m.name=`${h}-line`,m.id=this._getNodeId(`${h}-path-${r}`),e.add(m)}),n.length>1&&a){let t=(0,rD.Z)(a)?a:[a,"transparent"],r=e=>t[e%t.length],l=this.attribute.items,s=l[0],o=l[l.length-1],d=!(0,ng.Yt)(s.value,0)&&!(0,ng.Yt)(o.value,0),u=!(0,ng.Yt)(s.value,1)&&!(0,ng.Yt)(o.value,1),c=[],p=s.value>o.value;(p&&u||!p&&d)&&c.push(this.getGridPointsByValue(+!!p)),n.forEach(t=>{c.push(t.points)}),(p&&d||!p&&u)&&c.push(this.getGridPointsByValue(+!p));for(let t=0;t<c.length-1;t++){let n=function(t,e,i){let{type:r,closed:n}=i,l=e.slice(0).reverse(),s="",a="";if("line"===r&&i.smoothLink&&i.center){let e=t[0],r=l[0],o=i.center;s=wh(t,!!n),a=wh(l,!!n);let h=iN.HL.distancePP(r,o),d=iN.HL.distancePP(e,o);s+=`A${h},${h},0,0,1,${r.x},${r.y}L${r.x},${r.y}`,a+=`A${d},${d},0,0,0,${e.x},${e.y}`}else if("circle"===r){let{center:e}=i;s=wc(e,t,!1,!!n),a=wc(e,l,!0,!!n)}else"line"!==r&&"polygon"!==r||(s=wh(t,!!n),a=wh(l,!!n));return n?s+=a:(s+=a="L"+a.substring(1),s+="Z"),s}(c[t],c[t+1],i),l=ak.path({path:n,fill:r(t)});l.name=`${h}-region`,l.id=this._getNodeId(`${h}-region-${t}`),e.add(l)}}}_getNodeId(t){return`${this.id}-${t}`}_parseTickSegment(){let t=1;return this.data.length>=2&&(t=this.data[1].value-this.data[0].value),t}_getPointsOfSubGrid(t,e){let i=this.data.length,r=[];return i>=2&&this.data.forEach(i=>{let n=i.value;if(!e){let e=i.value-t/2;if(this.isInValidValue(e))return;n=e}r.push({value:n})}),r}release(){super.release(),this._prevInnerView=null,this._innerView=null}}wp.defaultAttributes={style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]}}};class wg{isInValidValue(t){return t<0||t>1}getTickCoord(t){let{start:e}=this.attribute,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}getRelativeVector(t){let{start:e,end:i}=this.attribute;return[i.x-e.x,i.y-e.y]}getVerticalVector(t,e=!1,i){var r;let n,{verticalFactor:l=1}=this.attribute,s=((n=x8(r=this.getRelativeVector()))>0&&(n=1/n),[r[0]*n,r[1]*n]);return x7([s[1],-1*s[0]],t*(e?1:-1)*l)}}let wf=["radius","startAngle","endAngle",...sO];class wm extends sN{constructor(t={radius:1}){super(t),this.type="circle",this.numberType=sn}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{startAngle:t,endAngle:e,radius:i}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)}getGraphicTheme(){return nP(this).circle}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateCircleAABBBoundsImprecise(t,e,i):this.updateCircleAABBBoundsAccurate(t,e,i));let{tb1:n,tb2:l}=iC.graphicService.updateTempAABBBounds(i);return cz(t,e,n),i.union(n),n.setValue(l.x1,l.y1,l.x2,l.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,iC.graphicService.transformAABBBounds(t,i,e,!1,this),i}updateCircleAABBBoundsImprecise(t,e,i){let{radius:r=e.radius}=t;return i.set(-r,-r,r,r),i}updateCircleAABBBoundsAccurate(t,e,i){let{startAngle:r=e.startAngle,endAngle:n=e.endAngle,radius:l=e.radius}=t;return n-r>ik.f7-ik.Ho?i.set(-l,-l,l,l):nq(r,n,l,i),i}needUpdateTags(t){return super.needUpdateTags(t,wf)}needUpdateTag(t){return super.needUpdateTag(t,wf)}toCustomPath(){var t,e,i;let r=super.toCustomPath();if(r)return r;let n=this.attribute,l=null!=(t=n.radius)?t:this.getDefaultAttribute("radius"),s=null!=(e=n.startAngle)?e:this.getDefaultAttribute("startAngle"),a=null!=(i=n.endAngle)?i:this.getDefaultAttribute("endAngle");return(r=new rp).arc(0,0,l,s,a),r}clone(){return new wm(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return wm.NOWORK_ANIMATE_ATTR}}function wy(t){return new wm(t)}wm.NOWORK_ANIMATE_ATTR=sZ;let wv=new class{constructor(){this.time=o6.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{radius:m=o.radius,startAngle:y=o.startAngle,endAngle:v=o.endAngle,opacity:b=o.opacity,x:_=o.x,y:C=o.y,scaleX:x=o.scaleX,scaleY:w=o.scaleY,keepStrokeScale:S=o.keepStrokeScale}=t.attribute,A=(n,l)=>{let s=!(!n||!n.stroke),{distance:a=o[l].distance}=n,h=S?a:rZ(e,a,e.dpr);if(e.beginPath(),e.arc(i,r,m+("outerBorder"===l?1:-1)*h,y,v),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),u)u(e,n,o[l]);else if(s){let s=o[l].opacity;o[l].opacity=b,e.setStrokeStyle(t,n,(_-i)/x,(C-r)/w,o[l]),o[l].opacity=s,e.stroke()}};g&&A(c,"outerBorder"),f&&A(p,"innerBorder")}};var wb=function(t,e){return function(i,r){e(i,r,t)}};let w_=class extends ox{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=sn,this.builtinContributions=[wv,og,oL],this.init(t)}drawShape(t,e,i,r,n,l,s,a){let o=nP(t,null==l?void 0:l.theme).circle,{radius:h=o.radius,startAngle:d=o.startAngle,endAngle:u=o.endAngle,x:c=o.x,y:p=o.y,fillStrokeOrder:g=o.fillStrokeOrder}=t.attribute,f=this.valid(t,o,s,a);if(!f)return;let{fVisible:m,sVisible:y,doFill:v,doStroke:b}=f;e.beginPath(),e.arc(i,r,h,d,u),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,v,b,m,y,o,n,s,a);let _=()=>{v&&(s?s(e,t.attribute,o):m&&(e.setCommonStyle(t,t.attribute,c-i,p-r,o),e.fill()))},C=()=>{b&&(a?a(e,t.attribute,o):y&&(e.setStrokeStyle(t,t.attribute,c-i,p-r,o),e.stroke()))};g?(C(),_()):(_(),C()),this.afterRenderStep(t,e,i,r,v,b,m,y,o,n,s,a)}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).circle;this._draw(t,n,!1,i,r)}};w_=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),wb(0,it(ii)),wb(0,ie(or)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],w_);let wC=!1,ww=new eQ(t=>{wC||(wC=!0,t(w_).toSelf().inSingletonScope(),t(s5).to(w_).inSingletonScope(),t(s4).toService(s5),t(or).toService(of),il(t,or))}),wS=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="circle",this.numberType=sn}};wS=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tz=it(s5),function(t,e){tz(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],wS);let wA=!1,wM=new eQ((t,e,i,r)=>{wA||(wA=!0,t(ci).to(wS).inSingletonScope(),t(cf).toService(ci))});function wT(){wT.__loaded||(wT.__loaded=!0,ak.RegisterGraphicCreator("circle",wy),ib.load(ww),ib.load(u$?wM:fj))}wT.__loaded=!1;let wk=["path","customPath",...sO];class wR extends sN{constructor(t){super(t),this.type="path",this.numberType=sh}get pathShape(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{path:t}=this.attribute;return null!=t&&""!==t}getParsedPathShape(){let t=this.getGraphicTheme();if(!this.valid)return t.path;let e=this.attribute;return e.path instanceof rp?e.path:((0,nB.Z)(this.cache)&&this.doUpdatePathShape(),this.cache instanceof rp?this.cache:t.path)}getGraphicTheme(){return nP(this).path}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let t=this.getParsedPathShape();i.union(t.getBounds())}let{tb1:r,tb2:n}=iC.graphicService.updateTempAABBBounds(i);cz(t,e,r),i.union(r),r.setValue(n.x1,n.y1,n.x2,n.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;let{lineJoin:l=e.lineJoin}=t;return iC.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}doUpdateAABBBounds(t){return this.doUpdatePathShape(),super.doUpdateAABBBounds(t)}doUpdatePathShape(){let t=this.attribute;(0,nI.Z)(t.path,!0)?this.cache=(new rp).fromString(t.path):t.customPath&&(this.cache=new rp,t.customPath(this.cache,this))}needUpdateTags(t){return super.needUpdateTags(t,wk)}needUpdateTag(t){return super.needUpdateTag(t,wk)}toCustomPath(){return(new rp).fromCustomPath2D(this.getParsedPathShape(),0,0)}clone(){return new wR(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return wR.NOWORK_ANIMATE_ATTR}}function wP(t){return new wR(t)}wR.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},sZ);var wB=function(t,e){return function(i,r){e(i,r,t)}};let wI=class extends ox{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=sh,this.builtinContributions=[og,oL],this.init(t)}drawShape(t,e,i,r,n,l,s,a){var o,h,d;let u=null!=(o=this.tempTheme)?o:nP(t,null==l?void 0:l.theme).path,{x:c=u.x,y:p=u.y,fillStrokeOrder:g=u.fillStrokeOrder}=t.attribute,f=null!=(h=this.z)?h:0,m=this.valid(t,u,s,a);if(!m)return;let{fVisible:y,sVisible:v,doFill:b,doStroke:_}=m;(e.beginPath(),t.pathShape)?iZ(t.pathShape.commandList,e,i,r,1,1,f):iZ((null!=(d=t.attribute.path)?d:u.path).commandList,e,i,r,1,1,f),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),this.beforeRenderStep(t,e,i,r,b,_,y,v,u,n,s,a);let C=()=>{_&&(a?a(e,t.attribute,u):v&&(e.setStrokeStyle(t,t.attribute,c-i,p-r,u),e.stroke()))},x=()=>{b&&(s?s(e,t.attribute,u):y&&(e.setCommonStyle(t,t.attribute,c-i,p-r,u),e.fill()))};g?(C(),x()):(x(),C()),this.afterRenderStep(t,e,i,r,b,_,y,v,u,n,s,a)}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).path;this.tempTheme=n,this._draw(t,n,!1,i,r),this.tempTheme=null}};wI=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),wB(0,it(ii)),wB(0,ie(os)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],wI);let wE=!1,wL=new eQ(t=>{wE||(wE=!0,t(wI).toSelf().inSingletonScope(),t(s8).to(wI).inSingletonScope(),t(s4).toService(s8),t(os).toService(of),il(t,os))}),wF=class extends _F{constructor(t){super(),this.canvasRenderer=t,this.type="path",this.numberType=sh}};wF=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tW=it(s8),function(t,e){tW(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],wF);let wO=!1,wH=new eQ((t,e,i,r)=>{wO||(wO=!0,t(cl).to(wF).inSingletonScope(),t(cf).toService(cl))});function wD(){wD.__loaded||(wD.__loaded=!0,ak.RegisterGraphicCreator("path",wP),ib.load(wL),ib.load(u$?wH:f4))}wD.__loaded=!1;class wz extends gf{onBind(){var t;let e=CA(this.target);this._animator=e;let i=this.duration,r=this.easing,{config:n,lastScale:l,getTickCoord:s}=this.params,a=1,o=this.target.data;if(l&&s&&o){a=.7;let t=s(l.scale(o.rawValue)),n=this.target.attribute.x,h=this.target.attribute.y;this.target.setAttributes({x:t.x,y:t.y}),e.animate(this.target,{type:"to",to:{x:n,y:h},duration:i,easing:r})}e.animate(this.target,{type:null!=(t=n.type)?t:"fadeIn",to:n.to,duration:i*a,easing:r}),this.completeBind(e)}}class wW extends gf{onBind(){let t=CA(this.target);this._animator=t;let e=this.duration,i=this.easing,{config:r,diffAttrs:n}=this.params;t.animate(this.target,{type:"to",to:Object.assign({},n),duration:e,easing:i,customParameters:{diffAttrs:Object.assign({},n)}}),this.completeBind(t)}deleteSelfAttr(t){super.deleteSelfAttr(t),this._animator.deleteSelfAttr(t)}tryPreventConflict(){}}function wZ(){uD(),_W(),Cw(),cw(),yv.registerBuiltInAnimate("axisEnter",wz),yv.registerBuiltInAnimate("axisUpdate",wW)}uD(),wD();class wN extends wp{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},wp.defaultAttributes,t),e)}_getGridPoint(t,e){let i;if("line"===t){let{length:t}=this.attribute;i=[e,this.getVerticalCoord(e,t,!0)]}else if("circle"===t||"polygon"===t){let{center:t,sides:r=6,startAngle:n=gK,endAngle:l=gX}=this.attribute,s=iN.HL.distancePP(t,e);i=wo(t,r,s,n,l)}return i}getGridPointsByValue(t){let e=this.getTickCoord(t);return this._getGridPoint(this.attribute.type,e)}getGridAttribute(t){let{type:e,alignWithLabel:i=!0}=this.attribute,r=this._parseTickSegment(),n,l=[];if(t){n=(0,h3.Z)({},this.attribute,this.attribute.subGrid);let t=[],{count:e=4}=n;if(this.data.length>=2){let n=this._getPointsOfSubGrid(r,i);for(let i=0;i<n.length-1;i++){let r=n[i],l=n[i+1];t.push({id:`sub-${i}-0`,points:this.getGridPointsByValue(r.value),datum:{}});for(let n=0;n<e;n++){let s=(n+1)/(e+1),a=(1-s)*r.value+s*l.value;t.push({id:`sub-${i}-${n+1}`,points:this.getGridPointsByValue(a),datum:{}})}i===n.length-2&&t.push({id:`sub-${i}-${e+1}`,points:this.getGridPointsByValue(l.value),datum:{}})}l=t}}else{n=this.attribute;let t=[];this.data.forEach(n=>{let{point:l}=n;if(!i){let t=n.value-r/2;if(this.isInValidValue(t))return;l=this.getTickCoord(t)}t.push({id:n.label,datum:n,points:this._getGridPoint(e,l)})}),l=t}return Object.assign(Object.assign({},n),{items:l})}}(0,yf.jB)(wN,wg);var wj=i(64639);let wG=["points","cornerRadius",...sO];class wV extends sN{constructor(t){super(t),this.type="polygon",this.numberType=sd}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{points:t}=this.attribute;return t&&t.length>=2}getGraphicTheme(){return nP(this).polygon}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||this.updatePolygonAABBBoundsImprecise(t,e,i),iC.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;let{lineJoin:r=e.lineJoin}=t;return iC.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}updatePolygonAABBBoundsImprecise(t,e,i){let{points:r=e.points}=t;return r.forEach(t=>{i.add(t.x,t.y)}),i}_interpolate(t,e,i,r,n){"points"===t&&(n.points=nQ(i,r,e))}needUpdateTags(t){return super.needUpdateTags(t,wG)}needUpdateTag(t){return super.needUpdateTag(t,wG)}toCustomPath(){let t=super.toCustomPath();if(t)return t;let e=this.attribute.points;return t=new rp,e.forEach((e,i)=>{0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)}),t.closePath(),t}clone(){return new wV(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return wV.NOWORK_ANIMATE_ATTR}}function wU(t){return new wV(t)}function wK(t,e,i,r){if(e&&e.length){t.moveTo(e[0].x+i,e[0].y+r);for(let n=1;n<e.length;n++)t.lineTo(e[n].x+i,e[n].y+r)}}function wX(t,e){return Math.sqrt(t*t+e*e)}function wY(t,e,i,r,n){let l=e/i;return{x:t.x-r*l,y:t.y-n*l}}wV.NOWORK_ANIMATE_ATTR=sZ;var w$=function(t,e){return function(i,r){e(i,r,t)}};let wq=class extends ox{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=sd,this.builtinContributions=[og,oL],this.init(t)}drawShape(t,e,i,r,n,l,s,a){let o=nP(t,null==l?void 0:l.theme).polygon,{points:h=o.points,cornerRadius:d=o.cornerRadius,x:u=o.x,y:c=o.y,closePath:p=o.closePath,fillStrokeOrder:g=o.fillStrokeOrder}=t.attribute,f=this.valid(t,o,s,a);if(!f)return;let{fVisible:m,sVisible:y,doFill:v,doStroke:b}=f;e.beginPath(),d<=0||(0,rD.Z)(d)&&d.every(t=>0===t)?wK(e.camera?e:e.nativeContext,h,i,r):function(t,e,i,r,n,l=!0){var s;if(e.length<3)return wK(t,e,i,r);let a=0,o=e.length-1;l||(a+=1,o-=1,t.moveTo(e[0].x+i,e[0].y+r));for(let l=a;l<=o;l++){let a=e[0===l?o:(l-1)%e.length],h=e[l%e.length],d=e[(l+1)%e.length],u=h.x-a.x,c=h.y-a.y,p=h.x-d.x,g=h.y-d.y,f=Math.abs(Math.tan((Math.atan2(c,u)-Math.atan2(g,p))/2)),m=Array.isArray(n)?null!=(s=n[l%e.length])?s:0:n,y=m/f,v=wX(u,c),b=wX(p,g),_=Math.min(v,b);y>_&&(y=_,m=_*f);let C=wY(h,y,v,u,c),x=wY(h,y,b,p,g),w=2*h.x-C.x-x.x,S=2*h.y-C.y-x.y,A=wX(w,S),M=wY(h,wX(y,m),A,w,S),T=Math.atan2(C.y-M.y,C.x-M.x),k=Math.atan2(x.y-M.y,x.x-M.x),R=k-T;R<0&&(T=k,R=-R),R>Math.PI&&(R-=Math.PI),0===l?t.moveTo(C.x+i,C.y+r):t.lineTo(C.x+i,C.y+r),R&&t.arcTo(h.x+i,h.y+r,x.x+i,x.y+r,m),t.lineTo(x.x+i,x.y+r)}l||t.lineTo(e[o+1].x+i,e[o+1].y+r)}(e.camera?e:e.nativeContext,h,i,r,d,p),p&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,v,b,m,y,o,n,s,a);let _=()=>{v&&(s?s(e,t.attribute,o):m&&(e.setCommonStyle(t,t.attribute,u-i,c-r,o),e.fill()))},C=()=>{b&&(a?a(e,t.attribute,o):y&&(e.setStrokeStyle(t,t.attribute,u-i,c-r,o),e.stroke()))};g?(C(),_()):(_(),C()),this.afterRenderStep(t,e,i,r,v,b,m,y,o,n,s,a)}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).polygon;this._draw(t,n,!1,i,r)}};wq=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),w$(0,it(ii)),w$(0,ie(oa)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],wq);let wJ=!1,wQ=new eQ(t=>{wJ||(wJ=!0,t(s9).to(wq).inSingletonScope(),t(s4).toService(s9),t(oa).toService(of),il(t,oa))}),w0=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="polygon",this.numberType=sd}};w0=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tZ=it(s9),function(t,e){tZ(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],w0);let w1=!1,w2=new eQ((t,e,i,r)=>{w1||(w1=!0,t(cd).to(w0).inSingletonScope(),t(cf).toService(cd))});function w3(){w3.__loaded||(w3.__loaded=!0,ak.RegisterGraphicCreator("polygon",wU),ib.load(wQ),ib.load(u$?w2:f2))}w3.__loaded=!1;let w5=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap",...sO];class w4 extends sN{constructor(t){super(t),this.type="arc",this.numberType=se}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{startAngle:t,endAngle:e,outerRadius:i,innerRadius:r}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)&&this._validNumber(r)}getParsedCornerRadius(){let t=this.getGraphicTheme(),{cornerRadius:e=t.cornerRadius,innerPadding:i=t.innerPadding,outerPadding:r=t.outerPadding}=this.attribute,{outerRadius:n=t.outerRadius,innerRadius:l=t.innerRadius}=this.attribute;if(n+=r,l-=i,0===e||"0%"===e)return 0;let s=Math.abs(n-l),a=t=>Math.min((0,n4.Z)(t,!0)?t:s*parseFloat(t)/100,s/2);if((0,rD.Z)(e)){let t=e.map(t=>a(t)||0);return 0===t.length?[t[0],t[0],t[0],t[0]]:2===t.length?[t[0],t[1],t[0],t[1]]:(3===t.length&&t.push(0),t)}return a(e)}getParsedAngle(){let t=this.getGraphicTheme(),{startAngle:e=t.startAngle,endAngle:i=t.endAngle}=this.attribute,{cap:r=t.cap}=this.attribute,n=i-e>=0?1:-1,l=i-e;if(i=(e=(0,iH.gt)(e))+l,r&&(0,ik.Wn)(l)<ik.f7-ik.Ho){let l=1,s=1;r.length&&(l=Number(r[0]),s=Number(r[1]));let{outerRadius:a=t.outerRadius,innerRadius:o=t.innerRadius}=this.attribute,{outerPadding:h=t.outerPadding,innerPadding:d=t.innerPadding}=this.attribute,u=Math.abs((a+=h)-(o-=d))/2,c=u/a;if(u>ik.Ho&&a>ik.Ho)return{startAngle:e-n*c*l,endAngle:i+n*c*s,sc:n*c*l,ec:n*c*s}}return{startAngle:e,endAngle:i}}getParsePadAngle(t,e){let i=this.getGraphicTheme(),{innerPadding:r=i.innerPadding,outerPadding:n=i.outerPadding,padAngle:l=i.padAngle}=this.attribute,{outerRadius:s=i.outerRadius,innerRadius:a=i.innerRadius}=this.attribute;s+=n,a-=r;let{padRadius:o=(0,ik._b)(s*s+a*a)}=this.attribute,h=(0,ik.Wn)(e-t),d=t,u=e,c=t,p=e,g=l/2,f=h,m=h;if(g>ik.Ho&&o>ik.Ho){let i=e>t?1:-1,r=(0,ik.ZR)(Number(o)/a*(0,ik.O$)(g)),n=(0,ik.ZR)(Number(o)/s*(0,ik.O$)(g));return(f-=2*r)>ik.Ho?(r*=i,c+=r,p-=r):(f=0,c=p=(t+e)/2),(m-=2*n)>ik.Ho?(n*=i,d+=n,u-=n):(m=0,d=u=(t+e)/2),{outerStartAngle:d,outerEndAngle:u,innerStartAngle:c,innerEndAngle:p,innerDeltaAngle:f,outerDeltaAngle:m}}return{outerStartAngle:d,outerEndAngle:u,innerStartAngle:c,innerEndAngle:p,innerDeltaAngle:f,outerDeltaAngle:m}}getGraphicTheme(){return nP(this).arc}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateArcAABBBoundsImprecise(t,e,i):this.updateArcAABBBoundsAccurate(t,e,i));let{tb1:n,tb2:l}=iC.graphicService.updateTempAABBBounds(i);cz(t,e,n),i.union(n),n.setValue(l.x1,l.y1,l.x2,l.y2),this.setWidthHeightWithoutTransform(i);let{lineJoin:s=e.lineJoin}=t;return iC.graphicService.transformAABBBounds(t,i,e,"miter"===s,this),i}updateArcAABBBoundsImprecise(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:n=e.innerRadius}=t,{outerPadding:l=e.outerPadding,innerPadding:s=e.innerPadding}=t;return(r+=l)<(n-=s)&&(r=n),i.set(-r,-r,r,r),i}updateArcAABBBoundsAccurate(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:n=e.innerRadius}=t,{outerPadding:l=e.outerPadding,innerPadding:s=e.innerPadding}=t;if((r+=l)<(n-=s)){let t=r;r=n,n=t}let{endAngle:a=e.endAngle,startAngle:o=e.startAngle}=t;if(o>a){let t=o;o=a,a=t}return r<=ik.Ho?i.set(0,0,0,0):Math.abs(a-o)>ik.f7-ik.Ho?i.set(-r,-r,r,r):(nq(o,a,r,i),nq(o,a,n,i)),i}needUpdateTags(t){return super.needUpdateTags(t,w5)}needUpdateTag(t){return super.needUpdateTag(t,w5)}toCustomPath(){var t,e,i,r;let n=super.toCustomPath();if(n)return n;let l=this.attribute,{startAngle:s,endAngle:a}=this.getParsedAngle(),o=(null!=(t=l.innerRadius)?t:0)-(null!=(e=l.innerPadding)?e:0),h=(null!=(i=l.outerRadius)?i:0)-(null!=(r=l.outerPadding)?r:0),d=(0,ik.Wn)(a-s),u=a>s;if(h<o){let t=h;h=o,o=t}if(n=new rp,h<=ik.Ho)n.moveTo(0,0);else if(d>=ik.f7-ik.Ho)n.moveTo(0+h*(0,ik.mC)(s),0+h*(0,ik.O$)(s)),n.arc(0,0,h,s,a,!u),o>ik.Ho&&(n.moveTo(0+o*(0,ik.mC)(a),0+o*(0,ik.O$)(a)),n.arc(0,0,o,a,s,u));else{let t=h*(0,ik.mC)(s),e=h*(0,ik.O$)(s),i=o*(0,ik.mC)(a),r=o*(0,ik.O$)(a);n.moveTo(0+t,0+e),n.arc(0,0,h,s,a,!u),n.lineTo(0+i,0+r),n.arc(0,0,o,a,s,u),n.closePath()}return n}clone(){return new w4(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return w4.NOWORK_ANIMATE_ATTR}}function w6(t){return new w4(t)}w4.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},sZ);let w7=new class{constructor(){this.time=o6.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{innerPadding:m=o.innerPadding,outerPadding:y=o.outerPadding,startAngle:v=o.startAngle,endAngle:b=o.endAngle,opacity:_=o.opacity,x:C=o.x,y:x=o.y,scaleX:w=o.scaleX,scaleY:S=o.scaleY,keepStrokeScale:A=o.keepStrokeScale}=t.attribute,{innerRadius:M=o.innerRadius,outerRadius:T=o.outerRadius}=t.attribute;T+=y,M-=m;let k=(n,l)=>{let s=!(!n||!n.stroke),{distance:a=o[l].distance}=n,h=A?a:rZ(e,a,e.dpr),d=a/T,c="outerBorder"===l?1:-1;if(t.setAttributes({outerRadius:T+c*h,innerRadius:M-c*h,startAngle:v-c*d,endAngle:b+c*d}),e.beginPath(),ot(t,e,i,r,T+c*h,M-c*h),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),u)u(e,n,o[l]);else if(s){let s=o[l].opacity;o[l].opacity=_,e.setStrokeStyle(t,n,(C-i)/w,(x-r)/S,o[l]),o[l].opacity=s,e.stroke()}};g&&k(c,"outerBorder"),f&&k(p,"innerBorder"),t.setAttributes({outerRadius:T,innerRadius:M,startAngle:v,endAngle:b})}};var w8=function(t,e){return function(i,r){e(i,r,t)}};let w9=class extends ox{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=se,this.builtinContributions=[w7,og,oL],this.init(t)}drawArcTailCapPath(t,e,i,r,n,l,s,a){let o=a-s,h=t.getParsedAngle(),d=h.startAngle,u=h.endAngle;u=a,(0,ik.Wn)(u-d);let c=u>d,p=!1;if(n<l){let t=n;n=l,l=t}let{outerDeltaAngle:g,xors:f,yors:m,xirs:y,yirs:v,limitedOcr:b,outerCornerRadiusStart:_,outerCornerRadiusEnd:C,maxOuterCornerRadius:x,xore:w,yore:S,xire:A,yire:M,limitedIcr:T,innerDeltaAngle:k,innerStartAngle:R,innerCornerRadiusStart:P,innerCornerRadiusEnd:B,maxInnerCornerRadius:I}=a9(t,d,u,l,n);if(b>ik.Ho){let t=(0,ik.VV)(_,b),l=(0,ik.VV)(C,b),s=a8(y,v,f,m,n,t,Number(c)),a=a8(w,S,A,M,n,l,Number(c));if(b<x&&t===l)e.moveTo(i+s.cx+s.x01,r+s.cy+s.y01),e.arc(i+s.cx,r+s.cy,b,(0,ik.fv)(s.y01,s.x01),(0,ik.fv)(a.y01,a.x01),!c);else{let t=u-o-.03,s=(0,ik.fv)(a.y11,a.x11);e.arc(i,r,n,t,s,!c),l>0&&e.arc(i+a.cx,r+a.cy,l,(0,ik.fv)(a.y11,a.x11),(0,ik.fv)(a.y01,a.x01),!c)}}else e.moveTo(i+f,r+m);if(!(l>ik.Ho)||k<.001)e.lineTo(i+A,r+M),p=!0;else if(T>ik.Ho){let t=(0,ik.VV)(P,T),n=(0,ik.VV)(B,T),s=a8(A,M,w,S,l,-n,Number(c)),a=a8(f,m,y,v,l,-t,Number(c));if(e.lineTo(i+s.cx+s.x01,r+s.cy+s.y01),T<I&&t===n){let t=(0,ik.fv)(a.y01,a.x01);e.arc(i+s.cx,r+s.cy,T,(0,ik.fv)(s.y01,s.x01),t,!c)}else{n>0&&e.arc(i+s.cx,r+s.cy,n,(0,ik.fv)(s.y01,s.x01),(0,ik.fv)(s.y11,s.x11),!c);let t=(0,ik.fv)(s.cy+s.y11,s.cx+s.x11),a=u-o-.03;e.arc(i,r,l,t,a,c)}}else e.lineTo(i+l*(0,ik.mC)(R),r+l*(0,ik.O$)(R));return p}drawShape(t,e,i,r,n,l,s,a,o){o=null!=o?o:nP(t,null==l?void 0:l.theme).arc;let{fill:h=o.fill,stroke:d=o.stroke,x:u=o.x,y:c=o.y,fillStrokeOrder:p=o.fillStrokeOrder}=t.attribute,g=this.valid(t,o,s,a);if(!g)return;let{fVisible:f,sVisible:m,doFill:y,doStroke:v}=g,{outerPadding:b=o.outerPadding,innerPadding:_=o.innerPadding,cap:C=o.cap,forceShowCap:x=o.forceShowCap}=t.attribute,{outerRadius:w=o.outerRadius,innerRadius:S=o.innerRadius}=t.attribute;w+=b,S-=_;let A=0,M=((0,nD.Z)(C)&&C||C[0])&&"conical"===h.gradient;if(M){let{sc:e,startAngle:i,endAngle:r}=t.getParsedAngle();(0,ik.Wn)(r-i)<ik.f7-ik.Ho&&(A=e||0,h.startAngle-=A,h.endAngle-=A)}let T=!1,{isFullStroke:k,stroke:R}=nU(d);if((y||k)&&(e.beginPath(),ot(t,e,i,r,w,S),T=!0,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,y,v,f,m,o,n,s,a),p?(this._runStroke(t,e,i,r,o,v,k,m,a),this._runFill(t,e,i,r,o,y,f,u,c,s)):(this._runFill(t,e,i,r,o,y,f,u,c,s),this._runStroke(t,e,i,r,o,v,k,m,a))),!k&&v&&(e.beginPath(),ot(t,e,i,r,w,S,R),T||this.beforeRenderStep(t,e,i,r,y,v,f,m,o,n,s,a),a?a(e,t.attribute,o):m&&(e.setStrokeStyle(t,t.attribute,i,r,o),e.stroke())),((0,nD.Z)(C)&&C||C[1])&&x){let{startAngle:l,endAngle:h}=t.getParsedAngle();if((0,ik.Wn)(h-l)>=ik.f7-ik.Ho){e.beginPath();let l=Math.abs(w-S)/2/w,{endAngle:h=o.endAngle,fill:d=o.fill}=t.attribute;this.drawArcTailCapPath(t,e,i,r,w,S,h,h+l),T||this.beforeRenderStep(t,e,i,r,y,v,f,m,o,n,s,a),(()=>{if(y&&"conical"===d.gradient){let n=function(t,e,i,r){let{stops:n,startAngle:l,endAngle:s}=r;for(;i<0;)i+=ik.f7;for(;i>ik.f7;)i-=ik.f7;if(i<l||i>s)return n[0].color;let a,o,h=(i-l)/(s-l);for(let t=0;t<n.length;t++)if(n[t].offset>=h){a=n[t-1],o=n[t];break}return h=(h-a.offset)/(o.offset-a.offset),pX(a.color,o.color,h,!1)}(0,0,h,d);s||a4&&(e.setCommonStyle(t,t.attribute,i,r,o),e.fillStyle=n,e.fill())}})(),v&&(a||m&&(e.setStrokeStyle(t,t.attribute,i,r,o),e.stroke()))}}this.afterRenderStep(t,e,i,r,y,v,f,m,o,n,s,a),M&&(h.startAngle+=A,h.endAngle+=A)}_runFill(t,e,i,r,n,l,s,a,o,h){l&&(h?h(e,t.attribute,n):s&&(e.setCommonStyle(t,t.attribute,a-i,o-r,n),e.fill()))}_runStroke(t,e,i,r,n,l,s,a,o){l&&s&&(o?o(e,t.attribute,n):a&&(e.setStrokeStyle(t,t.attribute,i,r,n),e.stroke()))}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).arc;this._draw(t,n,!1,i,r,n)}};w9=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),w8(0,it(ii)),w8(0,ie(oe)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],w9);let St=!1,Se=new eQ(t=>{St||(St=!0,t(w9).toSelf().inSingletonScope(),t(s1).to(w9).inSingletonScope(),t(s4).toService(s1),t(oe).toService(of),il(t,oe))}),Si=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="arc",this.numberType=se}};Si=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tN=it(s1),function(t,e){tN(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Si);let Sr=!1,Sn=new eQ((t,e,i,r)=>{Sr||(Sr=!0,t(u9).to(Si).inSingletonScope(),t(cf).toService(u9))});function Sl(){Sl.__loaded||(Sl.__loaded=!0,ak.RegisterGraphicCreator("arc",w6),ib.load(Se),ib.load(u$?Sn:fH))}function Ss(){uD(),_W(),w3(),cH()}function Sa(){uD(),_W(),Sl(),cH()}Sl.__loaded=!1,Ss();class So extends CB{getStartAngle(){return(0,iH.LW)(this._startAngle)}getEndAngle(){return(0,iH.LW)(this._endAngle)}getMainSegmentPoints(){return this._mainSegmentPoints}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},So.defaultAttributes,t)),this.name="segment",this.key="segment",this.lines=[]}render(){this.removeAllChild(!0),this._reset();let{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:n=!0,multiSegment:l,mainSegmentIndex:s}=this.attribute;if(!n)return;this._computeLineAngle();let a=this._getMainSegmentPoints(),o=this._renderSymbol(t,a,"start"),h=this._renderSymbol(e,a,"end");if(this.startSymbol=o,this.endSymbol=h,l){let t=[...this.attribute.points];if((0,hy.Z)(s))t[s]=this._clipPoints(t[s]);else{let e=this._clipPoints((0,a1.VF)(t));t[0][0]=e[0],t[t.length-1][t[t.length-1].length-1]=e[e.length-1]}t.forEach((t,e)=>{var n,l;let s=ak.line(Object.assign(Object.assign({points:t},(0,rD.Z)(i)?null!=(n=i[e])?n:i[i.length-1]:i),{fill:!1}));s.name=`${this.name}-line`,s.id=this._getNodeId("line"+e),(0,uF.Z)(null==r?void 0:r.line)||(s.states=(0,rD.Z)(r.line)?null!=(l=r.line[e])?l:r.line[r.line.length-1]:r.line),this.add(s),this.lines.push(s)})}else{let t=ak.line;(0,a1.IX)(i)[0].cornerRadius&&(t=ak.polygon);let e=t(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},(0,a1.IX)(i)[0]),{fill:!1,closePath:!1}));e.name=`${this.name}-line`,e.id=this._getNodeId("line"),(0,uF.Z)(null==r?void 0:r.line)||(e.states=[].concat(r.line)[0]),this.add(e),this.lines.push(e)}}_computeStartRotate(t){return t+Math.PI/2}_computeEndRotate(t){return t+Math.PI/2}_renderSymbol(t,e,i){let r;if(!e.length)return;let{autoRotate:n=!0}=t;if(t&&t.visible){let l,s,a=this.getStartAngle(),o=this.getEndAngle(),{state:h}=this.attribute,d=e[0],u=e[e.length-1],{refX:c=0,refY:p=0,refAngle:g=0,style:f,symbolType:m,size:y=12}=t;"start"===i?(l={x:d.x+((0,hy.Z)(a)?c*Math.cos(a)+p*Math.cos(a-Math.PI/2):0),y:d.y+((0,hy.Z)(a)?c*Math.sin(a)+p*Math.sin(a-Math.PI/2):0)},s=this._computeStartRotate(this._startAngle)):(l={x:u.x+((0,hy.Z)(o)?c*Math.cos(o)+p*Math.cos(o-Math.PI/2):0),y:u.y+((0,hy.Z)(o)?c*Math.sin(o)+p*Math.sin(o-Math.PI/2):0)},s=this._computeEndRotate(this._endAngle)),(r=ak.symbol(Object.assign(Object.assign(Object.assign({},l),{symbolType:m,size:y,angle:n?s+g:0,strokeBoundsBuffer:0}),f))).name=`${this.name}-${i}-symbol`,r.id=this._getNodeId(`${i}-symbol`),(0,uF.Z)(null==h?void 0:h.symbol)||(r.states=h.symbol),"start"===i?(0,uF.Z)(null==h?void 0:h.startSymbol)||(r.states=h.startSymbol):(0,uF.Z)(null==h?void 0:h.endSymbol)||(r.states=h.endSymbol),this.add(r)}return r}_getMainSegmentPoints(){let t;if(this._mainSegmentPoints)return this._mainSegmentPoints;let{points:e,multiSegment:i,mainSegmentIndex:r}=this.attribute;return t=i?(0,hy.Z)(r)?e[r]:(0,a1.VF)(e):e,this._mainSegmentPoints=t,t}_clipPoints(t){let{startSymbol:e={},endSymbol:i={}}=this.attribute,r=t;if(e.visible){let i=e.clip?e.size||10:0;r=[{x:t[0].x-i/2*(Math.cos(this._startAngle)||0),y:t[0].y-i/2*(Math.sin(this._startAngle)||0)},...r.slice(1)]}if(i.visible){let e=i.clip?i.size||10:0,n={x:t[t.length-1].x-e/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-e/2*(Math.sin(this._endAngle)||0)};r=[...r.slice(0,r.length-1),n]}return r}_computeLineAngle(){let t=this._getMainSegmentPoints();if(t.length<=1)return;let e=t[0],i=t[1],r=t[t.length-2],n=t[t.length-1],l=[e.x-i.x,e.y-i.y],s=Math.atan2(l[1],l[0]),a=[n.x-r.x,n.y-r.y],o=Math.atan2(a[1],a[0]);this._startAngle=s,this._endAngle=o}_reset(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}function Sh(){uD(),c7(),cH(),Cw(),cw()}So.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}};var Sd=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};Sh();class Su extends CB{getBgRect(){return this._bgRect}getTextShape(){return this._textShape}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Su.defaultAttributes,t)),this.name="tag",this._tagStates=[],this._rectStates=[],this._symbolStates=[],this._textStates=[]}render(){var t,e,i;let r,n,l;this.cacheStates();let{text:s="",textStyle:a={},shape:o={},panel:h={},space:d=4,minWidth:u,maxWidth:c,padding:p=4,visible:g,state:f,type:m,textAlwaysCenter:y,containerTextAlign:v}=this.attribute,b=(0,wj.o)(p),_=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group"),C,x=-b[3],w=-b[0],S=b[1]+b[3],A=b[0]+b[2],M=0,T=0,{visible:k}=o,R=Sd(o,["visible"]);if((0,nD.Z)(k)){let t=(null==R?void 0:R.size)||10,e=(0,n4.Z)(t)?t:Math.max(t[0],t[1]);C=_.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:t,strokeBoundsBuffer:0},R),{visible:k,x:e/2,y:e/2}),"symbol"),(0,uF.Z)(null==f?void 0:f.shape)||(C.states=f.shape),k&&(T=e+d)}if(S+=T,M+=T,function(t,e="type"){return"rich"===g1(t,e)}({text:s})||"rich"===m){let t=Object.assign(Object.assign(Object.assign({},g2(Object.assign({type:m,text:s},a))),a),{visible:(0,aw.Z)(s)&&!1!==g,x:M,y:0});(0,nB.Z)(t.lineHeight)&&(t.lineHeight=a.fontSize),n=(r=_.createOrUpdateChild("tag-text",t,"richtext")).AABBBounds.width(),l=r.AABBBounds.height()}else{let i=Object.assign(Object.assign({text:(0,nF.Z)(s)&&"type"in s&&"text"===s.type?s.text:s,visible:(0,aw.Z)(s)&&!1!==g,lineHeight:null==a?void 0:a.fontSize},a),{x:M,y:0});(0,nB.Z)(i.lineHeight)&&(i.lineHeight=a.fontSize),r=_.createOrUpdateChild("tag-text",i,"text");let o=g0(i.text,a,null==(e=null==(t=this.stage)?void 0:t.getTheme())?void 0:e.text);n=o.width,l=o.height}S+=n;let P=null!=(i=o.size)?i:10,B=(0,n4.Z)(P)?P:Math.max(P[0],P[1]);A+=Math.max(l,o.visible?B:0);let{textAlign:I,textBaseline:E}=a;((0,aw.Z)(u)||(0,aw.Z)(c))&&((0,aw.Z)(u)&&S<u&&(S=u),(0,aw.Z)(c)&&S>c&&(S=c,r.setAttribute("maxLineWidth",c-b[1]-b[2]))),x=0,w=0;let L=0;"left"===I||"start"===I?L=1:"right"===I||"end"===I?L=-1:"center"===I&&(L=0),L?L<0?(x-=S,C&&C.setAttribute("x",(C.attribute.x||0)-n),_.setAttribute("x",-b[1]-T)):L>0&&_.setAttribute("x",b[3]):(x-=S/2,C&&C.setAttribute("x",(C.attribute.x||0)-n/2),_.setAttribute("x",-T/2));let F=(t,e)=>{"richtext"===r.type?r.setAttributes({x:t,textAlign:e,textConfig:(0,a1.IX)(r.attribute.textConfig).map(t=>Object.assign(Object.assign({},t),{textAlign:e}))}):r.setAttributes({x:t,textAlign:e})};if((v?"center"===v:y)&&L){let t=S-b[1]-b[3],e=n+T,i=1===L?(t-e)/2+T+n/2:b[0]+T-(S/2+e/2-T)+n/2;if(F(i,"center"),C){let t=i-n/2-T+B/2;C.setAttributes({x:t})}}if(("left"===v||"start"===v)&&1!==L){let t=S-b[1]-b[3],e=0===L?-t/2+T/2:-S+b[3]+b[1]+T;F(e+T,"left"),C&&C.setAttributes({x:e+B/2})}if(("right"===v||"end"===v)&&-1!==L){let t=S-b[1]-b[3],e=0===L?t/2+T/2:t;if(F(e,"right"),C){let t=e-n-T+B/2;C.setAttributes({x:t})}}"middle"===E?(w-=A/2,C&&C.setAttribute("y",0)):"bottom"===E?(w-=A,C&&C.setAttribute("y",-l/2),_.setAttribute("y",-b[2])):"top"===E&&(_.setAttribute("y",b[0]),C&&C.setAttribute("y",l/2)),(0,uF.Z)(null==f?void 0:f.text)||(r.states=f.text);let{visible:O}=h,H=Sd(h,["visible"]);if(g&&(0,nD.Z)(O)){let t=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},H),{visible:O&&!!s,width:S,height:A,x:x,y:w}),"rect");if((0,uF.Z)(null==f?void 0:f.panel)||(t.states=f.panel),H.customShape){let e=H.customShape;t.pathProxy=t=>e(this,t,new rp)}this._bgRect=t}this._textShape=r,this._symbol=C,this.resetStates()}initAttributes(t,e){t=(null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Su.defaultAttributes,t),super.initAttributes(t),this.render()}addState(t,e,i){super.addState(t,e,i),this._textShape&&this._textShape.addState(t,e,i),this._bgRect&&this._bgRect.addState(t,e,i),this._symbol&&this._symbol.addState(t,e,i)}removeState(t,e){super.removeState(t,e),this._textShape&&this._textShape.removeState(t,e),this._bgRect&&this._bgRect.removeState(t,e),this._symbol&&this._symbol.removeState(t,e)}cacheStates(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p;this._tagStates=null!=(e=null==(t=this.currentStates)?void 0:t.slice())?e:[],this._rectStates=null!=(n=null==(r=null==(i=this._bgRect)?void 0:i.currentStates)?void 0:r.slice())?n:[],this._symbolStates=null!=(a=null==(s=null==(l=this._symbol)?void 0:l.currentStates)?void 0:s.slice())?a:[],this._textStates=null!=(d=null==(h=null==(o=this._textShape)?void 0:o.currentStates)?void 0:h.slice())?d:[],this.clearStates(),null==(u=this._bgRect)||u.clearStates(),null==(c=this._symbol)||c.clearStates(),null==(p=this._textShape)||p.clearStates()}resetStates(){var t,e,i;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&(null==(t=this._bgRect)||t.useStates(this._rectStates)),this._symbolStates.length&&(null==(e=this._symbol)||e.useStates(this._symbolStates)),this._textStates.length&&(null==(i=this._textShape)||i.useStates(this._textStates))}}Su.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};let Sc=(t,e,i)=>{let r=t.target;return r!==i&&r.name&&!(0,uF.Z)(r.states)?(r.addState(tp.hover,!0),_X(e,t=>{t!==r&&t.name&&!(0,uF.Z)(t.states)&&t.addState(tp.hoverReverse,!0)}),r):i},Sp=(t,e,i)=>i?(_X(e,t=>{t.name&&!(0,uF.Z)(t.states)&&(t.removeState(tp.hoverReverse),t.removeState(tp.hover))}),null):i,Sg=(t,e,i)=>{let r=t.target;return i===r&&r.hasState(tp.selected)?(_X(e,t=>{t.name&&!(0,uF.Z)(t.states)&&(t.removeState(tp.selectedReverse),t.removeState(tp.selected))}),null):r.name&&!(0,uF.Z)(r.states)?(r.addState(tp.selected,!0),_X(e,t=>{t!==r&&t.name&&!(0,uF.Z)(t.states)&&t.addState(tp.selectedReverse,!0)}),r):i},Sf={type:"default",duration:300,easing:"linear"};class Sm extends CI{constructor(){super(...arguments),this.name="axis",this.data=[],this.tickLineItems=[],this.subTickLineItems=[],this.axisLabelLayerSize={},this.axisLabelsContainer=null,this._onHover=t=>{this._lastHover=Sc(t,this.axisContainer,this._lastHover)},this._onUnHover=t=>{this._lastHover=Sp(t,this.axisContainer,this._lastHover)},this._onClick=t=>{this._lastSelect=Sg(t,this.axisContainer,this._lastSelect)}}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}getBoundsWithoutRender(t){let e=(0,dz.Z)(this.attribute);e.scale=this.attribute.scale,this.attribute=t;let i=ak.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}render(){this._prepare(),this._prevInnerView=this._innerView&&wl(this._innerView),this.removeAllChild(!0),this._innerView=ak.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent(),this.runAnimation()}_prepare(){this._prepareAnimate(Sf)}_bindEvent(){if(this.attribute.disableTriggerEvent)return;let{hover:t,select:e}=this.attribute;t&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),e&&this._innerView.addEventListener("pointerdown",this._onClick)}_renderInner(t){let{title:e,label:i,tick:r,line:n,items:l}=this.attribute,s=ak.group({x:0,y:0,zIndex:1,pickable:!1});if(s.name=t0.axisContainer,s.id=this._getNodeId("container"),s.setMode(this.mode),this.axisContainer=s,t.add(s),n&&n.visible&&this.renderLine(s),l&&l.length&&(this.data=this._transformItems(l[0]),r&&r.visible&&this.renderTicks(s),i&&i.visible)){let t=ak.group({x:0,y:0,pickable:!1});t.name=t0.labelContainer,t.id=this._getNodeId("label-container"),this.axisLabelsContainer=t,s.add(t),l.forEach((e,i)=>{let r=this.renderLabels(t,e,i),n=r.getChildren();this.beforeLabelsOverlap(n,e,r,i,l.length),this.handleLabelsOverlap(n,e,r,i,l.length),this.afterLabelsOverlap(n,e,r,i,l.length);let s=0,a=0,o="center",h="middle",d=0;n.forEach((t,e)=>{var i;let r=t.attribute,n=null!=(i=r.angle)?i:0,l=t.AABBBounds,u=l.width(),c=l.height();n&&(u=Math.abs(u*Math.cos(n)),c=Math.abs(c*Math.sin(n))),s=Math.max(s,u),a=Math.max(a,c),o=r.textAlign,h=r.textBaseline,0===e&&(d=r.x)}),this.axisLabelLayerSize[i]={width:s,height:a,labelPos:d,textAlign:o,textBaseline:h}})}e&&e.visible&&this.renderTitle(s)}renderTicks(t){let e=this.getTickLineItems(),i=ak.group({x:0,y:0,pickable:!1});i.name=t0.tickContainer,i.id=this._getNodeId("tick-container"),t.add(i),e.forEach((t,r)=>{var n;let l=ak.line(Object.assign({},this._getTickLineAttribute("tick",t,r,e)));if(l.name=t0.tick,l.id=this._getNodeId(t.id),(0,uF.Z)(null==(n=this.attribute.tick)?void 0:n.state))l.states=g$;else{let t=this.data[r],e=(0,h3.Z)({},g$,this.attribute.tick.state);Object.keys(e).forEach(i=>{(0,nz.Z)(e[i])&&(e[i]=e[i](t.rawValue,r,t,this.data))}),l.states=e}i.add(l)}),this.tickLineItems=e;let{subTick:r}=this.attribute;if(r&&r.visible){let t=this.getSubTickLineItems();t.length&&t.forEach((t,n)=>{let l=ak.line(Object.assign({},this._getTickLineAttribute("subTick",t,n,e)));if(l.name=t0.subTick,l.id=this._getNodeId(`${n}`),(0,uF.Z)(r.state))l.states=g$;else{let i=(0,h3.Z)({},g$,r.state);Object.keys(i).forEach(r=>{(0,nz.Z)(i[r])&&(i[r]=i[r](t.value,n,t,e))}),l.states=i}i.add(l)}),this.subTickLineItems=t}}renderLabels(t,e,i){let{dataFilter:r}=this.attribute.label;r&&(0,nz.Z)(r)&&(e=r(e,i));let n=this._transformItems(e),l=ak.group({x:0,y:0,pickable:!1});return l.name=`${t0.labelContainer}-layer-${i}`,l.id=this._getNodeId(`label-container-layer-${i}`),t.add(l),n.forEach((t,e)=>{var r;let s=g3(this._getLabelAttribute(t,e,n,i));if(s.name=t0.label,s.id=this._getNodeId(`layer${i}-label-${t.id}`),(0,uF.Z)(null==(r=this.attribute.label)?void 0:r.state))s.states=g$;else{let r=(0,h3.Z)({},g$,this.attribute.label.state);Object.keys(r).forEach(l=>{(0,nz.Z)(r[l])&&(r[l]=r[l](t,e,n,i))}),s.states=r}s.data=Object.assign(Object.assign({},t),{index:e,layer:i}),l.add(s)}),l}renderTitle(t){let e=new Su(Object.assign({},this.getTitleAttribute()));e.name=t0.title,e.id=this._getNodeId("title"),t.add(e)}getVerticalCoord(t,e,i){return ws(t,this.getVerticalVector(e,i,t))}getTickLineItems(){let{tick:t}=this.attribute,e=this.data,i=[],{alignWithLabel:r,inside:n=!1,length:l,dataFilter:s}=t,a=1;return e.length>=2&&(a=e[1].value-e[0].value),(s&&(0,nz.Z)(s)?s(e):e).forEach(t=>{let e=t.point,s=t.value;if(!r){let i=t.value-a/2;if(this.isInValidValue(i))return;e=this.getTickCoord(i),s=i}let o=this.getVerticalCoord(e,l,n);if("3d"===this.mode){let r=this.getVerticalVector(l,n,e),a=0,h=0;(0,ik.Wn)(r[0])>(0,ik.Wn)(r[1])?a=ik.pi/2*(o.x>e.x?1:-1):h=ik.pi/2*(o.y>e.y?-1:1),i.push({start:e,end:o,value:s,id:`tick-${t.id}`,anchor:[e.x,e.y],alpha:a,beta:h})}else i.push({start:e,end:o,value:s,id:`tick-${t.id}`})}),i}getSubTickLineItems(){let{subTick:t}=this.attribute,e=[],{count:i=4,inside:r=!1,length:n=2}=t,l=this.tickLineItems,s=l.length;if(s>=2)for(let t=0;t<s-1;t++){let s=l[t],a=l[t+1];for(let t=0;t<i;t++){let l=(t+1)/(i+1),o=(1-l)*s.value+l*a.value,h=this.getTickCoord(o),d=this.getVerticalCoord(h,n,r);e.push({start:h,end:d,value:o,id:`sub-tick-${o}`})}}return e}_getTickLineAttribute(t,e,i,r){let n=(0,dx.Z)(this.attribute,`${t}.style`),l=this.data[i];n=(0,nz.Z)(n)?(0,h3.Z)({},(0,dx.Z)(wt,`${t}.style`),"tick"===t?n(l.rawValue,i,l,this.data):n(e.value,i,e,r)):n;let{start:s,end:a,anchor:o,alpha:h,beta:d}=e;return Object.assign({points:[s,a],anchor:o,alpha:h,beta:d},n)}_getLabelAttribute(t,e,i,r){var n,l;let{space:s=4,inside:a=!1,formatMethod:o,type:h="text",text:d}=this.attribute.label,u=s,c=0;(null==(n=this.attribute.tick)?void 0:n.visible)&&this.attribute.tick.inside===a&&(c=this.attribute.tick.length||4),(null==(l=this.attribute.subTick)?void 0:l.visible)&&this.attribute.subTick.inside===a&&(c=Math.max(c,this.attribute.subTick.length||2)),u+=c;let p=this.getRelativeVector(t.point);r>0&&(0===p[1]?u+=(this.axisLabelLayerSize[r-1].height+(0,dx.Z)(this.attribute,"label.space",4))*r:u+=(this.axisLabelLayerSize[r-1].width+(0,dx.Z)(this.attribute,"label.space",4))*r);let g=this.getVerticalCoord(t.point,u,a),f=this.getVerticalVector(u||1,a,g),m=o?o(`${t.label}`,t,e,i,r):t.label,{style:y}=this.attribute.label;y=(0,nz.Z)(y)?(0,h3.Z)({},wt.label.style,y(t,e,i,r)):y;let v=this.getLabelAlign(f,a,y.angle);return y=(0,h3.Z)(v,y),(0,nz.Z)(y.text)&&(y.text=y.text({label:t.label,value:t.rawValue,index:t.index,layer:r})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(g,f,m,y)),{text:null!=d?d:m,_originText:t.label,lineHeight:null==y?void 0:y.fontSize,type:h}),y)}getLabelPosition(t,e,i,r){return t}_transformItems(t){let e=[];return t.forEach(t=>{var i;e.push(Object.assign(Object.assign({},t),{point:this.getTickCoord(t.value),id:null!=(i=t.id)?i:t.label}))}),e}runAnimation(){let t=this.lastScale;if(this.attribute.scale){let t=this.attribute.scale;this.lastScale=t.clone(),this.lastScale.range([0,1])}if(this.attribute.animation&&this.applyAnimationState){let e=this.getInnerView(),i=this.getPrevInnerView();if(!i)return;let r=this._animationConfig;this._newElementAttrMap={},_X(e,e=>{var n;if("group"!==e.type&&e.id){let l=i[e.id];if(e.setFinalAttributes(e.attribute),l){l.release();let i=l.attribute,s=e.getFinalAttribute(),a=function(t,e,i){let r={};for(let i in e)i in t&&(0,uL.X)(t[i],e[i])||(r[i]=e[i]);return r}(i,s),o=Object.keys(a).length>0;if("opacity"in i&&s.opacity!==i.opacity&&(a.opacity=null!=(n=s.opacity)?n:1,o=!0),r.update&&o){this._newElementAttrMap[e.id]={state:"update",node:e,attrs:e.attribute};let i=l.attribute;e.setAttributes(i),e.applyAnimationState(["update"],[{name:"update",animation:Object.assign(Object.assign({selfOnly:!0},r.update),{type:"axisUpdate",customParameters:{config:r.update,diffAttrs:a,lastScale:t}})}])}}else r.enter&&(this._newElementAttrMap[e.id]={state:"enter",node:e,attrs:e.attribute},e.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r.enter),{type:"axisEnter",selfOnly:!0,customParameters:{config:r.enter,lastScale:t,getTickCoord:this.getTickCoord.bind(this)}})}]))}})}}release(){super.release(),this._prevInnerView=null,this._innerView=null}}let Sy={parity:function(t){return t.filter((t,e)=>e%2?t.setAttribute("opacity",0):1)},greedy:function(t,e){let i;return t.filter((t,r)=>r&&wd(i,t,e)?t.setAttribute("opacity",0):(i=t,1))}};function Sv(t){let e;return(e=t.OBBBounds.empty()?t.AABBBounds:t.OBBBounds).width()>1&&e.height()>1}function Sb(t,e,i,r,n=!1){if(i&&!t.attribute.opacity){let i=e.length;if(i>1){t.setAttribute("opacity",1);for(let t=0;t<i;t++){let l=n?e[i-1-t]:e[t];if(!r(l))break;l.setAttribute("opacity",0)}}}}function S_(t,e){let i;if((0,uF.Z)(t))return;let r=t.filter(Sv);if((0,uF.Z)(r))return;r.forEach(t=>t.setAttribute("opacity",1)),i=r;let{method:n="parity",separation:l=0}=e,s=(0,nz.Z)(n)?n:Sy[n]||Sy.parity;if(i.length>=3&&wu(i,l)){do i=s(i,l);while(i.length>=3&&wu(i,l));let t=(t,e,i=!0)=>i&&t<3||e,n=t(i.length,e.firstVisible,!1),a=t(i.length,e.lastVisible),o=r[0],h=(0,a1.Z$)(r);wd(o,h,l)&&n&&a&&(h.setAttribute("opacity",0),a=!1),Sb(o,i,n,t=>wd(t,o,l)),Sb(h,i,a,t=>wd(t,h,l)||!(!n||t===o)&&wd(t,o,l),!0)}r.forEach(t=>{t.setAttribute("visible",!!t.attribute.opacity)})}function SC(t=0){if(t<0)for(;t<0;)t+=2*Math.PI;if(t>0)for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function Sx(t,e=0){let i,r=["center","left","left","left","center","right","right","right","left"],n=["top","top","middle","bottom","bottom","bottom","middle","top","top"];"top"===t&&(r=["center","right","right","right","center","left","left","left","right"],n=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);let l=(e=SC(e))/(.5*Math.PI);return{textAlign:r[i=l===Math.floor(l)?2*Math.floor(l):2*Math.floor(l)+1],textBaseline:n[i]}}function Sw(t,e=0){let i,r=["right","right","center","left","left","left","center","right","right"],n=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];"right"===t&&(r=["left","left","center","right","right","right","center","left","left"],n=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);let l=(e=SC(e))/(.5*Math.PI);return{textAlign:r[i=l===Math.floor(l)?2*Math.floor(l):2*Math.floor(l)+1],textBaseline:n[i]}}function SS(t,e,i){let r;return(0,hy.Z)(e)&&(r=Math.abs(e-t)),(0,hy.Z)(i)&&(r=(0,hy.Z)(r)?Math.min(Math.abs(t-i),r):Math.abs(t-i)),r}var SA=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};wZ(),c7();class SM extends Sm{constructor(t,e){var i;if(t.labelHoverOnAxis&&(t.labelHoverOnAxis.textStyle=Object.assign({},t.label.style,t.labelHoverOnAxis.textStyle),void 0===t.labelHoverOnAxis.space)){let{padding:e=2}=t.labelHoverOnAxis,r=(0,wj.o)(e),n="bottom"===t.orient?r[0]:"left"===t.orient?r[1]:"top"===t.orient?r[2]:r[3],l=(null!=(i=t.label.space)?i:SM.defaultAttributes.label.space)-n;t.labelHoverOnAxis.space=l}super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},SM.defaultAttributes,t),e),this.labelHoverOnAxisGroup=null}_renderInner(t){var e;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){let t=[];for(let e=0;e<this.attribute.breaks.length;e++){let{range:i,breakSymbol:r,rawRange:n}=this.attribute.breaks[e];t.push({startPoint:this.getTickCoord(i[0]),endPoint:this.getTickCoord(i[1]),range:i,breakSymbol:r,rawRange:n})}this._breaks=t}super._renderInner(t),this._breaks&&this._breaks.length&&this._breaks.forEach((e,i)=>{let{startPoint:r,endPoint:n,breakSymbol:l,rawRange:s}=e;if(!1!==(null==l?void 0:l.visible)){let e=ak.group({zIndex:999});e.name=t0.axisBreak,e.id=this._getNodeId(`${t0.axisBreak}-${i}`),e.data=s;let a=function(t={}){var e,i;let{style:r={},angle:n=.5*Math.PI}=t,l=(0,h3.Z)({},we,r),s=null!=(e=l.size)?e:we.size;return Object.assign(Object.assign({},l),{symbolType:null!=(i=l.symbolType)?i:`M ${-s/2} ${s*Math.sin(n)} L ${s/2} ${-s*Math.sin(n)}`,symbolSize:s})}(l),o=ak.symbol(Object.assign({x:r.x,y:r.y},a));o.name=t0.axisBreakSymbol;let h=ak.symbol(Object.assign({x:n.x,y:n.y},a));h.name=t0.axisBreakSymbol,e.add(o),e.add(h),t.add(e)}});let{panel:i}=this.attribute;if(i&&i.visible){let t=this.axisContainer,r=t.AABBBounds,n=ak.rect(Object.assign({x:r.x1,y:r.y1,width:r.width(),height:r.height()},i.style));n.name=t0.background,n.id=this._getNodeId("background"),n.states=(0,h3.Z)({},xV,null!=(e=i.state)?e:{}),t.insertBefore(n,t.firstChild)}let{labelHoverOnAxis:r}=this.attribute;r&&r.visible&&this.renderLabelHoverOnAxis()}renderLabelHoverOnAxis(){let t=new Su(Object.assign({},this.getLabelHoverOnAxisAttribute()));t.name=t0.title,t.id=this._getNodeId("hover-on-label"),this.labelHoverOnAxisGroup=t,this.axisContainer.add(t)}renderLine(t){let{start:e,end:i,line:r}=this.attribute,{startSymbol:n,endSymbol:l,style:s,state:a}=r,o=Object.assign({startSymbol:n,endSymbol:l,lineStyle:s},SA(r,["startSymbol","endSymbol","style","state"]));if(this._breaks&&this._breaks.length){let t=[],r=e;this._breaks.forEach(e=>{let{startPoint:i,endPoint:n}=e;t.push([r,i]),r=n}),t.push([r,i]),o.points=t,o.multiSegment=!0}else o.points=[e,i];(0,uF.Z)(a)||(o.state={line:(0,h3.Z)({},xV,a),symbol:(0,h3.Z)({},xV,a)});let h=new So(o);h.name=t0.line,h.id=this._getNodeId("line"),t.add(h)}getTextAlign(t){let e="center";return(0,ng.Yt)(t[0],0)?(0,ng.Yt)(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}getTitleAttribute(){var t,e,i;let r=this.attribute.title,{position:n="middle",space:l=4,textStyle:s={},autoRotate:a=!0,shape:o,background:h,state:d={},maxWidth:u}=r,c=SA(r,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]),p=.5;"start"===n?p=0:"end"===n&&(p=1);let{verticalFactor:g=1}=this.attribute,f=this.getTickCoord(p),m=this.getRelativeVector(),y=0;if((null==(t=this.attribute.label)?void 0:t.visible)&&!1===this.attribute.label.inside){let t=+(0,dx.Z)(this.attribute,"label.space",4);y+=t;let e=Object.keys(this.axisLabelLayerSize).length;if(0===m[1]){let i=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(i)?y+=i+(e-1)*t:y=0}else if(0===m[0])if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){let i=this.axisLabelLayerSize[0].labelPos,r=this.axisLabelsContainer.AABBBounds;y+=(1==-1*g?r.x2>i?Math.min(r.x2-i,r.width()):0:r.x1<i?Math.min(i-r.x1,r.width()):0)+(e-1)*t}else y=0;else Object.keys(this.axisLabelLayerSize).forEach((e,i)=>{y+=this.axisLabelLayerSize[e].width+(i>0?t:0)})}let v=0;(null==(e=this.attribute.tick)?void 0:e.visible)&&!1===this.attribute.tick.inside&&(v=this.attribute.tick.length||4),(null==(i=this.attribute.subTick)?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(v=Math.max(v,this.attribute.subTick.length||2));let b=v+y+l,_=this.getActualOffset(b),C=this.getVerticalCoord(f,_,!1),x=this.getVerticalVector(_,!1,{x:0,y:0}),w,S,{angle:A}=c;if(w="start"===n?"start":"end"===n?"end":"center",(0,nB.Z)(A)&&a){A=x9(m,[1,0],!0);let{verticalFactor:t=1}=this.attribute;S=1==-1*t?"bottom":"top"}else w=this.getTextAlign(x),S=this.getTextBaseline(x,!1);let M=u;if((0,nB.Z)(M)){let{verticalLimitSize:t,verticalMinSize:e,orient:i}=this.attribute,r=Math.min(t||1/0,e||1/0);if((0,hy.Z)(r))if("bottom"===i||"top"===i)if(A!==Math.PI/2){let t=Math.abs(Math.cos(null!=A?A:0));M=t<1e-6?1/0:this.attribute.end.x/t}else M=r-_;else if(A&&0!==A){let t=Math.abs(Math.sin(A));M=t<1e-6?1/0:this.attribute.end.y/t}else M=r-_}let T=Object.assign(Object.assign(Object.assign({},C),c),{maxWidth:M,textStyle:Object.assign({textAlign:w,textBaseline:S},s),state:{text:(0,h3.Z)({},xV,d.text),shape:(0,h3.Z)({},xV,d.shape),panel:(0,h3.Z)({},xV,d.background)}});return T.angle=A,o&&o.visible&&(T.shape=Object.assign({visible:!0},o.style),o.space&&(T.space=o.space)),h&&h.visible&&(T.panel=Object.assign({visible:!0},h.style)),T}getLabelHoverOnAxisAttribute(){var t,e;let{orient:i}=this.attribute,r=this.attribute.labelHoverOnAxis,{position:n=0,space:l=4,autoRotate:s=!0,textStyle:a={},background:o={},formatMethod:h,text:d="",maxWidth:u}=r,c=SA(r,["position","space","autoRotate","textStyle","background","formatMethod","text","maxWidth"]),p=this.getTickCoord(0);"bottom"===i||"top"===i?p.x=n:p.y=n;let g=0;(null==(t=this.attribute.tick)?void 0:t.visible)&&!1===this.attribute.tick.inside&&(g=this.attribute.tick.length||4),(null==(e=this.attribute.subTick)?void 0:e.visible)&&!1===this.attribute.subTick.inside&&(g=Math.max(g,this.attribute.subTick.length||2));let f=g+0+l,m=this.getVerticalCoord(p,f,!1),y=this.getVerticalVector(f,!1,{x:0,y:0}),v,{angle:b}=c,_="center";if((0,nB.Z)(b)&&s){b=x9(this.getRelativeVector(),[1,0],!0);let{verticalFactor:t=1}=this.attribute;v=1==-1*t?"bottom":"top"}else{let{textAlign:t,textBaseline:e}=this.getLabelAlign(y,!1,a.angle);_=t,v=e}let C=h?h(d):d,x=Object.assign(Object.assign(Object.assign({},m),c),{maxWidth:u,textStyle:Object.assign({textAlign:_,textBaseline:v},a),text:C});return x.angle=b,o&&o.visible&&(x.panel=Object.assign(Object.assign({visible:!0},c.panel),o.style)),x}getTextBaseline(t,e){let i="middle",{verticalFactor:r=1}=this.attribute;return(0,ng.Yt)(t[1],0)?i=!(0,ng.Yt)(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":1==(e?1:-1)*r?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}getLabelAlign(t,e,i){let r=this.attribute.orient;if(["top","bottom","right","left"].includes(r)||0===t[0]&&0===t[1]){if("top"===r||"bottom"===r)return Sx(e?"bottom"===r?"top":"bottom":r,i);if("left"===r||"right"===r)return Sw(e?"left"===r?"right":"left":r,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}beforeLabelsOverlap(t,e,i,r,n){var l,s,a,o;let{flush:h=!1}=this.attribute.label||{};if(h&&t.length){let{orient:e,start:i,end:r}=this.attribute,n="bottom"===e||"top"===e,h=t[0],d=(0,a1.Z$)(t),u=n?h.attribute.x>d.attribute.x:h.attribute.y<d.attribute.y;if(n){let t=u?d:h,e=u?h:d,n=i.x,a=r.x,o=t.AABBBounds.x1,c=e.AABBBounds.x2;o<n&&(t.attribute.angle?t.setAttributes({dx:(null!=(l=t.attribute.dx)?l:0)+n-o}):t.setAttributes({x:n,textAlign:"left"})),c>a&&(e.attribute.angle?e.setAttributes({dx:(null!=(s=e.attribute.dx)?s:0)+a-c}):e.setAttributes({x:a,textAlign:"right"}))}else{let t=u?d:h,e=u?h:d,n=t.AABBBounds.y2,l=e.AABBBounds.y1,s=i.y,c=r.y;l<s&&(e.attribute.angle?e.setAttributes({dy:(null!=(a=e.attribute.dy)?a:0)+s-l}):e.setAttributes({y:s,textBaseline:"top"})),n>c&&(t.attribute.angle?t.setAttributes({dy:(null!=(o=t.attribute.dy)?o:0)+c-n}):t.setAttributes({y:c,textBaseline:"bottom"}))}}}handleLabelsOverlap(t,e,i,r,n){if((0,uF.Z)(t))return;let{verticalLimitSize:l,label:s,orient:a}=this.attribute,o=this._getAxisLabelLimitLength(l,n),{layoutFunc:h,autoRotate:d,autoRotateAngle:u,autoLimit:c,limitEllipsis:p,autoHide:g,autoHideMethod:f,autoHideSeparation:m,lastVisible:y,firstVisible:v,autoWrap:b,overflowLimitLength:_}=s;if((0,nz.Z)(h))h(t,e,r,this);else{if(d)!function(t,e){if((0,uF.Z)(t))return;let{orient:i,labelRotateAngle:r=[0,45,90]}=e;if(0===r.length||t.some(t=>!!t.attribute.angle))return;let n=0,l=0,s=r;for(t.length>2&&("bottom"===i||"top"===i?Math.abs(t[1].attribute.x-t[0].attribute.x)<t[0].attribute.fontSize/2&&(s=[r[r.length-1]]):Math.abs(t[1].attribute.y-t[0].attribute.y)<t[0].attribute.fontSize/2&&(s=[r[r.length-1]])),s&&s.length>0&&(l=s.length);n<l;){var a,o;let e=s[n++];if(t.forEach(t=>{t.attribute.angle=(0,iH.M4)(e)}),a=i,o=t,"bottom"!==a&&"top"!==a||function(t,e){e.forEach(e=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},Sx(t,e.attribute.angle)),{angle:SC(e.attribute.angle)}))})}(a,o),"left"!==a&&"right"!==a||function(t,e){e.forEach((e,i)=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},Sw(t,e.attribute.angle)),{angle:SC(e.attribute.angle)}))})}(a,o),o.forEach(t=>{if(t.rotatedBounds||!t.attribute.angle)return;let e=function(t){let e=t.AABBBounds;return{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,centerX:t.attribute.x,centerY:t.attribute.y,angle:t.attribute.angle}}(t),i=(0,aj.xj)({x:t.attribute.x,y:t.attribute.y},e.angle,{x:e.centerX,y:e.centerY}),r=i.x-e.centerX,n=i.y-e.centerY;e.x1+=r,e.x2+=r,e.y1+=n,e.y2+=n,e.centerX+=r,e.centerY+=n,t.rotatedBounds=e}),!function(t){for(let e=1;e<t.length;e++)if(function(t,e){var i,r;return(null==(i=t.OBBBounds)?void 0:i.empty())||(null==(r=e.OBBBounds)?void 0:r.empty())?(0,aj.SX)(t.AABBBounds,e.AABBBounds,!1)&&(!t.rotatedBounds||!e.rotatedBounds||(0,aj.nn)(t.rotatedBounds,e.rotatedBounds,!0)):t.OBBBounds.intersects(e.OBBBounds)}(t[e-1],t[e]))return!0;return!1}(t))break}}(t,{labelRotateAngle:u,orient:a});else if(b){let e="left"===a||"right"===a?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x);!function(t,e){let{limitLength:i,axisLength:r,ellipsis:n="...",orient:l}=e;if((0,uF.Z)(t)||!(0,hy.Z)(i))return;let s=t[0].attribute.angle,a=wn(s),o=wr(s),h="top"===l||"bottom"===l,d=r/t.length;t.forEach((e,r)=>{var l,s,u,c,p;if(h){if(o&&Math.floor(e.AABBBounds.height())<=i)return;if(a){let i=SS(e.attribute.x,null==(l=t[r+1])?void 0:l.attribute.x,null==(s=t[r-1])?void 0:s.attribute.x);(0,hy.Z)(i)&&(d=(0,ik.VV)(d,i))}}else{if(o){let i=SS(e.attribute.y,null==(u=t[r+1])?void 0:u.attribute.y,null==(c=t[r-1])?void 0:c.attribute.y);(0,hy.Z)(i)&&(d=(0,ik.VV)(d,i))}if(a&&Math.floor(e.AABBBounds.width())<=i)return}let g=null,f=null;h?o?(g=i,f=d):(g=d,f=i):o?(g=d,f=i):(g=i,f=d),e.setAttributes({maxLineWidth:g,ellipsis:null!=(p=e.attribute.ellipsis)?p:n,whiteSpace:"normal",heightLimit:f})})}(t,{orient:a,limitLength:o,axisLength:e,ellipsis:p})}if(!b&&c&&(0,hy.Z)(o)&&o>0){let e="left"===a||"right"===a,i=e?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x),r=e?i/t.length:g||d?1/0:i/t.length;!function(t,e){var i;let{limitLength:r,verticalLimitLength:n,ellipsis:l="...",orient:s,axisLength:a}=e;if((0,uF.Z)(t)||!(0,hy.Z)(r))return;let o=(i=e.overflowLimitLength,(0,hy.Z)(i)?{left:i,right:i}:(0,nF.Z)(i)?{left:i.left||0,right:i.right||0}:{left:0,right:0}),h=t[0],d=h.attribute.angle,u=!(0,nB.Z)(d),c=u?Math.cos(d):1,p=u?Math.sin(d):0,g=wn(d),f=wr(d),m="top"===s||"bottom"===s,y=h.attribute.direction,v=!g&&!f&&m&&(t.length<2||t.some(t=>Math.abs(t.AABBBounds.width()-h.AABBBounds.width())>=2))&&h.AABBBounds.width()>Math.abs(r/p);t.forEach(t=>{var e;if(m&&(f&&Math.floor(t.AABBBounds.height())<=r||g&&Math.floor(t.AABBBounds.width())<=n))return;if(!m&&("vertical"===y&&Math.floor(t.AABBBounds.height())<=n||"vertical"!==y&&(g&&Math.floor(t.AABBBounds.width())<=r||f&&Math.floor(t.AABBBounds.height())<=n)))return;let i=null;if(g||f)i=m?g?n:r:"vertical"===y||f?n:r;else if(m){let{x1:e,x2:n}=t.AABBBounds,l=p/c,s=Math.abs(r/p);i=v&&l>0&&e<=a+o.right&&r/l+e>a+o.right?Math.min((a-e+o.right)/Math.abs(c),s):v&&l<0&&n>=-o.left&&r/l+n<-o.left?Math.min((n+o.left)/Math.abs(c),s):s}else i=Math.abs(r/c);(0,hy.Z)(t.attribute.maxLineWidth)&&(i=(0,hy.Z)(i)?Math.min(t.attribute.maxLineWidth,i):t.attribute.maxLineWidth),t.setAttributes({maxLineWidth:i,ellipsis:null!=(e=t.attribute.ellipsis)?e:l})})}(t,{limitLength:o,verticalLimitLength:r,ellipsis:p,orient:a,axisLength:i,overflowLimitLength:_})}g&&S_(t,{orient:a,method:f,separation:m,lastVisible:y,firstVisible:v})}}afterLabelsOverlap(t,e,i,r,n){let{verticalLimitSize:l,orient:s}=this.attribute,a="bottom"===s||"top"===s,o=i.AABBBounds,h=a?o.height():o.width(),{verticalMinSize:d}=this.attribute;if((0,hy.Z)(d)&&(!(0,hy.Z)(l)||d<=l)){let t,e;h=Math.max(h,this._getAxisLabelLimitLength(d,n)),"left"===s?(t=o.x2-h,e=o.y1):"right"===s?(t=o.x1,e=o.y1):"top"===s?(t=o.x1,e=o.y2-h):"bottom"===s&&(t=o.x1,e=o.y1);let r=ak.rect({x:t,y:e,width:a?o.width():h,height:a?h:o.height(),pickable:!1});r.name=t0.axisLabelBackground,r.id=this._getNodeId("axis-label-background"),i.insertBefore(r,i.firstChild)}if((0,aw.Z)(this.attribute.label.containerAlign)){var u,c,p;let e;"left"===s?e=o.x2-h:"right"===s?e=o.x1:"top"===s?e=o.y2-h:"bottom"===s&&(e=o.y1),u=e,c=h,p=this.attribute.label.containerAlign,"left"===s||"right"===s?"left"===p?t.forEach(t=>{var e;t.setAttributes({dx:(null!=(e=t.attribute.dx)?e:0)+u-t.AABBBounds.x1})}):"right"===p?t.forEach(t=>{var e;t.setAttributes({dx:(null!=(e=t.attribute.dx)?e:0)+u+c-t.AABBBounds.x2})}):"center"===p&&t.forEach(t=>{var e;t.setAttributes({dx:(null!=(e=t.attribute.dx)?e:0)+u+c/2-(t.AABBBounds.x1+t.AABBBounds.x2)/2})}):"bottom"!==s&&"top"!==s||("top"===p?t.forEach(t=>{var e;t.setAttributes({dy:(null!=(e=t.attribute.dy)?e:0)+u-t.AABBBounds.y1})}):"bottom"===p?t.forEach(t=>{var e;t.setAttributes({dy:(null!=(e=t.attribute.dy)?e:0)+u+c-t.AABBBounds.y2})}):"middle"===p&&t.forEach(t=>{var e;t.setAttributes({dy:(null!=(e=t.attribute.dy)?e:0)+u+c/2-(t.AABBBounds.y1+t.AABBBounds.y2)/2})}))}}_getAxisLabelLimitLength(t,e){var i,r,n,l,s;let{label:a,title:o,line:h,tick:d}=this.attribute,u=null!=(i=a.space)?i:4,c=t,p=0,g=0,f=h&&h.visible?null!=(r=h.style.lineWidth)?r:1:0,m=d&&d.visible?null!=(n=d.length)?n:4:0;if(o&&o.visible&&"string"==typeof o.text){p=g0(o.text,o.textStyle,null==(s=null==(l=this.stage)?void 0:l.getTheme())?void 0:s.text).height;let t=(0,wj.o)(o.padding);g=o.space+t[0]+t[2]}return c&&(c=(c-u-g-p-f-m)/e),c}showLabelHoverOnAxis(t,e,i=!0){if(this.attribute.labelHoverOnAxis){let r=this.axisContainer.AABBBounds,n=r.width(),l=r.height(),s=r.x1,a=r.y1,o=r.x2,h=r.y2;if(this.labelHoverOnAxisGroup){let{formatMethod:i}=this.attribute.labelHoverOnAxis,r=i?i(e):e;this.labelHoverOnAxisGroup.setAttribute("text",r),this.labelHoverOnAxisGroup.setAttribute("visible",!0),this.labelHoverOnAxisGroup.setAttribute("visibleAll",!0),"left"===this.attribute.orient||"right"===this.attribute.orient?this.labelHoverOnAxisGroup.setAttributes({y:t}):this.labelHoverOnAxisGroup.setAttributes({x:t})}else this.attribute.labelHoverOnAxis.visible=!0,this.attribute.labelHoverOnAxis.position=t,this.attribute.labelHoverOnAxis.text=e,this.renderLabelHoverOnAxis();if(i){let i=this.axisContainer.AABBBounds,r=i.width()-n,d=i.height()-l;r>0&&("top"===this.attribute.orient||"bottom"===this.attribute.orient)&&(i.x1<s?this.showLabelHoverOnAxis(t+r,e,!1):i.x2>o&&this.showLabelHoverOnAxis(t-r,e,!1)),d>0&&("left"===this.attribute.orient||"right"===this.attribute.orient)&&(i.y1<a?this.showLabelHoverOnAxis(t+d,e,!1):i.y2>h&&this.showLabelHoverOnAxis(t-d,e,!1))}}}hideLabelHoverOnAxis(){this.attribute.labelHoverOnAxis&&this.labelHoverOnAxisGroup&&this.labelHoverOnAxisGroup.setAttributes({visible:!1,visibleAll:!1})}getActualOffset(t){let e=this.attribute.orient;return"left"===e||"right"===e?this.attribute.width?this.attribute.width:(this.attribute.maxWidth&&(t=Math.min(t,this.attribute.maxWidth)),this.attribute.minWidth&&(t=Math.max(t,this.attribute.minWidth)),t):t}release(){super.release(),this._breaks=null}}SM.defaultAttributes=wt,(0,yf.jB)(SM,wg);let ST={domainLine:{visible:!0},grid:{visible:!1},subGrid:{visible:!1},tick:{visible:!0},subTick:{visible:!1}},Sk={domainLine:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,inside:!1,tickSize:4,alignWithLabel:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},subTick:{visible:!1,tickSize:2,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},label:{visible:!0,inside:!1,space:10,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}},title:{space:10,padding:0,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor"},fontWeight:"normal",fillOpacity:1}}},SR={label:{space:8},title:{space:8},maxHeight:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},SP={label:{space:12,autoLimit:!0},title:{space:12,autoRotate:!0},maxWidth:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}};class SB extends xQ{constructor(){super(...arguments),this.type=oQ.cartesianBandAxis,this._scale=new pT.j}computeDomain(t){return this.computeBandDomain(t)}updateScaleRange(){let t=super.updateScaleRange();return this.updateGroupScaleRange(),t}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}axisHelper(){let t=(t=0)=>this._scales[t];return{isContinuous:!1,dataToPosition:this.dataToPosition.bind(this),getScale:t,getBandwidth:(e=0)=>t(e).bandwidth(),getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>this._inverse,getSpec:()=>this._spec}}registerTicksTransform(){let t=`${this.type}-ticks`;return dL(this._option.dataSet,t,x4),t}transformScaleDomain(){this.updateFixedWholeLength()}updateFixedWholeLength(){if(this._scale){let{bandSize:t,maxBandSize:e,minBandSize:i}=this._getOuterBandSizeFromSpec();if(t&&this._scale.bandwidth(t),e&&this._scale.maxBandwidth(e),i&&this._scale.minBandwidth(i),this._scale.isBandwidthFixed()&&this._spec.autoRegionSize&&(t||e)){let i=(0,CY.$l)(this._scale.domain().length,null!=t?t:e,this._scale.paddingInner(),this._scale.paddingOuter());["bottom","top"].includes(this._orient)?this._regions.forEach(t=>t.setMaxWidth(i)):["left","right"].includes(this._orient)&&this._regions.forEach(t=>t.setMaxHeight(i))}}}_getOuterBandSizeFromSpec(){var t;let{bandSize:e,maxBandSize:i,minBandSize:r,bandSizeLevel:n=0}=this._spec,{gap:l,extend:s=0}=null!=(t=this._spec.bandSizeExtend)?t:{};n=Math.min(n,this._scales.length-1);for(let t=n;t>0;t--){let a=this._scales[t],o=a.domain(),h=a.paddingInner(),d=a.paddingOuter(),u=e=>{let i=t===n?s:0;return(0,nB.Z)(l)||t<n?(0,CY.$l)(o.length,e,h,d)+i:(e+((0,nI.Z)(l)?e*(Number(l.substring(0,l.length-1))/100):l))*o.length/(this._scales[t-1].paddingInner()+1)+i};(0,aw.Z)(e)&&(e=u(e)),(0,aw.Z)(i)&&(i=u(i)),(0,aw.Z)(r)&&(r=u(r))}return{bandSize:e,maxBandSize:i,minBandSize:r}}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(null==e?void 0:e.showAllGroupLayers)===(null==t?void 0:t.showAllGroupLayers)&&(0,uL.X)(null==e?void 0:e.layers,null==t?void 0:t.layers)||(i.reMake=!0),i}reInit(t){super.reInit(),null==this||this._updateData()}}SB.type=oQ.cartesianBandAxis,SB.specKey="axes",SB.builtInTheme={axis:Sk,axisBand:ST,axisX:SR,axisY:SP},(0,yf.jB)(SB,x0);let SI=()=>{h9.registerGraphicComponent(tJ.lineAxis,(t,e)=>new SM(t,e)),h9.registerGraphicComponent(tQ.lineAxisGrid,(t,e)=>new wN(t,e)),xY(),h9.registerComponent(SB.type,SB,!1)};function SE(t){let e=[];for(let i=0;i<t.length;i++){let r=t[i];0!==i&&r[0]===e[e.length-1]||e.push(r[0]),e.push(r[1])}return e}function SL(t,e,i){let r=t.indexOf(e),n=t.indexOf(i);r>=0&&n>=0&&r<n&&(t.splice(r,1),t.splice(n,0,e))}let SF=(t,e,i)=>i.reduce((t,r,n)=>(t.push([r,i.length===n+1?e:i[n+1]]),t),[[t,i[0]]]),SO=(t,e)=>t-e,SH=(t,e)=>{let i=[{count:0,sub:[],max:e[0],min:e[0]}],r=0,n=0;for(;r<e.length;)t[n]<=e[r]?(i[r].count+=1,i[r].sub.push(t[n]),n+=1):i[r+=1]={count:0,sub:[],max:e[r],min:e[r]};i.forEach(t=>{t.count&&(t.min=Math.min.apply(null,t.sub))});let l=t.slice(n);return i[r]={count:l.length,sub:l,min:e[e.length-1],max:Math.max.apply(null,l)},i},SD=Math.sqrt(50),Sz=Math.sqrt(10),SW=Math.sqrt(2);class SZ{constructor(){this._extend={},this._rawDomain=[],this.niceLabelFormatter=null}getRawDomain(){return this._rawDomain}setExtraAttrFromSpec(){(0,aw.Z)(this._spec.nice)&&(this._nice=this._spec.nice),(0,aw.Z)(this._spec.zero)&&(this._zero=this._spec.zero),this._expand=this._spec.expand,this._domain=xy(this._spec)}transformScaleDomain(){this.setScaleNice()}setLinearScaleNice(){var t;if(!this._nice)return!1;let e=5,i=this._spec.tick||{};if((0,hy.Z)(i.forceTickCount))e=i.forceTickCount;else if((0,nz.Z)(i.tickCount)){let t=this._scale.range(),r=Math.abs((0,a1.Z$)(t)-t[0]);1===r&&this._option&&(r=CQ(this._orient)?this._option.getChartViewRect().width:this._option.getChartViewRect().height),e=i.tickCount({axisLength:r,labelStyle:this._spec.label&&this._spec.label.style})}else e=(0,hy.Z)(i.tickCount)?i.tickCount:5;"accurateFirst"===this._spec.niceType&&(e=Math.max(5,e));let{min:r,max:n}=null!=(t=this._domain)?t:{};return(0,nB.Z)(r)&&(0,nB.Z)(n)&&(0,nB.Z)(this._softMaxValue)&&(0,nB.Z)(this._softMinValue)?this._scale.nice(e):((0,aw.Z)(r)||(0,aw.Z)(this._softMinValue))&&(0,nB.Z)(n)&&(0,nB.Z)(this._softMaxValue)?this._scale.niceMax(e):!(!(0,nB.Z)(r)||!(0,nB.Z)(this._softMinValue)||!(0,aw.Z)(n)&&!(0,aw.Z)(this._softMaxValue))&&this._scale.niceMin(e)}setLogScaleNice(){var t;if(!this._nice)return!1;let{min:e,max:i}=null!=(t=this._domain)?t:{};return(0,nB.Z)(e)&&(0,nB.Z)(i)&&(0,nB.Z)(this._softMaxValue)&&(0,nB.Z)(this._softMinValue)?this._scale.nice():((0,aw.Z)(e)||(0,aw.Z)(this._softMinValue))&&(0,nB.Z)(i)&&(0,nB.Z)(this._softMaxValue)?this._scale.niceMax():!(!(0,nB.Z)(e)||!(0,nB.Z)(this._softMinValue)||!(0,aw.Z)(i)&&!(0,aw.Z)(this._softMaxValue))&&this._scale.niceMin()}setScaleNice(){return"log"===this._spec.type?this.setLogScaleNice():this.setLinearScaleNice()}dataToPosition(t,e){return this.valueToPosition(t[0])}valueToPosition(t){return this._scale.scale(t)}computeLinearDomain(t){let e=[];if(t.length){let l=this._spec.breaks&&this._spec.breaks.length,s,a,o=[];if(t.forEach(t=>{let{min:e,max:i}=t;s=void 0===s?e:Math.min(s,e),a=void 0===a?i:Math.max(a,i),l&&(o=o.concat(t.values))}),l){let t=[],l=[],h=(0,nB.Z)(this._domain.max)?a:this._domain.max;for(let e=0;e<this._spec.breaks.length;e++){let{range:i}=this._spec.breaks[e];i[0]<=i[1]&&i[1]<=h&&(t.push(i),l.push(this._spec.breaks[e]))}if(t.sort((t,e)=>t[0]-e[0]),t.length){var i,r,n;let{domain:s,scope:a}=(i=o,r=SE(t),n=this._spec.breaks[0].scopeType,i.sort(SO),r.sort(SO),{domain:function(t,e){let i=t[0],r=t[t.length-1],n=e.filter(t=>t>i&&t<r);return 0===n.length?[[i,r]]:SF(i,r,n)}(i,r),scope:function(t,e,i="count"){let r=SH(t,e),n="count"===i?t.length:r.reduce((t,e,i)=>e.count>0?t+e.max-e.min:t,0),l=[],s=0,a=0;return r.forEach((t,e)=>{if(0===n)l.push([0,e/r.length-1]);else{let o="count"===i?t.count:t.max-t.min,h=l[a-1]?l[a-1][1]:0,d=e===r.length-1?1:Math.min((s+o)/n,1);(h!==d||0!==h&&1!==h)&&(a+=1,l.push([h,d]),s+=o)}}),l}(i,r,n)});e=SE(s),this._break={domain:s,scope:a,breakDomains:t,breaks:l}}else e=[s,a]}else e=[s,a]}else e[0]=0,e[1]=0;return this.setSoftDomainMinMax(e),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e}expandDomain(t){if(!this._expand)return;let e=t[0],i=(0,a1.Z$)(t);e===i&&(0===i?i=1:i>0?e=0:i<0&&(i=0)),(0,aw.Z)(this._expand.min)&&(t[0]=e-(i-e)*this._expand.min),(0,aw.Z)(this._expand.max)&&(t[t.length-1]=i+(i-e)*this._expand.max)}niceDomain(t){let{min:e,max:i}=xy(this._spec);if((0,aw.Z)(e)||(0,aw.Z)(i)||"linear"!==this._spec.type)return t;if(1e-12>=Math.abs((0,a1.iH)(t)-(0,a1.CE)(t))){let e=t[0],i=e>=0?1:-1;if((e=Math.abs(e))<1)t[0]=0,t[t.length-1]=1;else{let i=e/5,r=Math.floor(Math.log(i)/Math.LN10),n=i/Math.pow(10,r);i=(n>=SD?10:n>=Sz?5:n>=SW?2:1)*Math.pow(10,r),t[0]=0,t[t.length-1]=10*i}i<0&&(t.reverse(),t[0]*=-1,t[t.length-1]*=-1)}return t}includeZero(t){this._zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max((0,a1.Z$)(t),0))}setExtendDomain(t,e){if(void 0===e)return void delete this._extend[t];this._extend[t]=e;let i=this._scale.domain();this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this._nice),this._nice&&(this.setScaleNice()||this._scale.rescale()),this.event.emit(J.scaleUpdate,{model:this,value:"domain"})}extendDomain(t){let e,i=t.length-1,r=t[0]-t[i]>0,n=r?i:0,l=r?0:i;for(let i in this._extend)(e=this._extend[i])>t[l]&&(t[l]=e),e<t[n]&&(t[n]=e)}getDomainSpec(){return this._domain}setDomainMinMax(t){if(!this._domain)return;let{min:e,max:i}=this._domain;(0,aw.Z)(e)&&(t[0]=e),(0,aw.Z)(i)&&(t[t.length-1]=i)}setSoftDomainMinMax(t){let{softMin:e,softMax:i}=this._spec;if((0,aw.Z)(e)){let i=(0,nz.Z)(e)?e(t):e;(0,nB.Z)(i)&&(i=t[0]),i<=t[0]&&(t[0]=i,this._softMinValue=i)}if((0,aw.Z)(i)){let e=(0,nz.Z)(i)?i(t):i;(0,nB.Z)(e)&&(e=(0,a1.Z$)(t)),e>=(0,a1.Z$)(t)&&(t[t.length-1]=e),this._softMaxValue=e}}setZero(t){this._zero!==t&&(this._zero=t,this.updateScaleDomain())}updateScaleDomain(){var t;if(!this.isSeriesDataEnable())return;(null==(t=this._rawDomain)?void 0:t.length)||!this._scale||this._updateRawDomain();let e=this.collectData(),i=this.computeLinearDomain(e);this.updateScaleDomainByModel(i)}updateScaleDomainByModel(t){t=null!=t?t:this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this._nice),this._nice&&(this.setScaleNice()||this._scale.rescale()),this._updateNiceLabelFormatter(t),this._domainAfterSpec=this._scale.domain(),this.event.emit(J.scaleDomainUpdate,{model:this}),this.event.emit(J.scaleUpdate,{model:this,value:"domain"})}getDomainAfterSpec(){return this._domainAfterSpec}_updateNiceLabelFormatter(t){let e=Math.pow(10,Math.max(-Math.floor(Math.log10(Math.abs((0,a1.Z$)(t)-t[0]))),0)+2);this.niceLabelFormatter=t=>(0,hy.Z)(+t)?Math.round(t*e)/e:t}_updateRawDomain(){let t=this.collectData(0,!0),e=this.computeLinearDomain(t);this._rawDomain=e,this.event.emit(J.scaleRawDomainUpdate,{model:this})}_clearRawDomain(){this._rawDomain=[]}}function SN(t,e,i,r){let n,{breakData:l}=t;if(l&&l()){let{breakDomains:t}=l(),s=e.domain();n=[];for(let e=0;e<s.length-1;e++)r(i,[s[e],s[e+1]]).forEach(e=>{t.some(t=>e>=t[0]&&e<=t[1])||n.push(e)});e.domain(s)}else n=r(i);return n}function Sj(t,e,i,r,n=!1){if(i&&!e.includes(t)){let i=e.length;if(i>1){n?e.push(t):e.unshift(t);for(let t=0;t<i;t++){let l=n?i-1-t:t;if(!r(e[l]))break;e.splice(l,1),t--,i--}}}}let SG=(t,e)=>{var i,r,n,l,s,a;let o;if(!(0,pW.z2)(t.type))return xr(t.domain());let h=t.range(),d=Math.abs(h[h.length-1]-h[0]);if(d<2)return xr([t.domain()[0]]);let{tickCount:u,forceTickCount:c,tickStep:p,noDecimals:g=!1,labelStyle:f,breakData:m}=e;if((0,aw.Z)(p))s=t.stepTicks(p),o=(a=m&&m()?m().breakDomains:null)&&a.length?s.filter(t=>a.every(e=>t<e[0]||t>e[1])):s;else if((0,aw.Z)(c))o=SN(e,t,c,(e,i)=>i&&i.length?t.domain(i,!0).forceTicks(e):t.forceTicks(e));else if("d3"===e.tickMode)o=SN(e,t,null!=(i=(0,nz.Z)(u)?u({axisLength:d,labelStyle:f}):u)?i:5,(e,i)=>i&&i.length?t.domain(i,!0).d3Ticks(e,{noDecimals:g}):t.d3Ticks(e,{noDecimals:g}));else{let i=null!=(r=(0,nz.Z)(u)?u({axisLength:d,labelStyle:f}):u)?r:5,n=(0,nz.Z)(e.tickMode)?e.tickMode:void 0;o=SN(e,t,i,(e,i)=>i&&i.length?t.domain(i,!0).ticks(e,{noDecimals:g,customTicks:n}):t.ticks(e,{noDecimals:g,customTicks:n}))}let y=t.domain();if(e.labelFirstVisible&&y[0]!==o[0]&&!o.includes(y[0])&&o.unshift(y[0]),e.labelLastVisible&&y[y.length-1]!==o[o.length-1]&&!o.includes(y[y.length-1])&&o.push(y[y.length-1]),e.sampling&&o.length>1&&("cartesian"===e.coordinateType||"polar"===e.coordinateType&&"radius"===e.axisOrientType)){let i,{labelGap:r=4,labelFlush:s}=e;if(6*o.length>d){let r=[],l=Math.floor(6*o.length/d);o.forEach((t,e)=>{e%l!=0&&e!==o.length-1||r.push(t)}),i=null==(n=xs(t,r,e))?void 0:n.map((t,e)=>({AABBBounds:t,value:r[e]}))}else i=null==(l=xs(t,o,e))?void 0:l.map((t,e)=>({AABBBounds:t,value:o[e]}));if(i){let t=i[0],n=(0,a1.Z$)(i),l=m&&m()?SV.greedy:SV.parity;for(;i.length>=3&&wu(i,r);)i=l(i,r);let a=e.labelFirstVisible,h=e.labelLastVisible;wd(t,n,r)&&i.includes(n)&&i.length>1&&a&&h&&(i.splice(i.indexOf(n),1),h=!1),Sj(t,i,a,e=>wd(e,t,r)),Sj(n,i,h,e=>wd(e,n,r)||!(!a||e===t)&&wd(e,t,r),!0);let d=i.map(t=>t.value);d.length<3&&s&&(d.length>1&&d.pop(),(0,a1.Z$)(d)!==(0,a1.Z$)(o)&&d.push((0,a1.Z$)(o))),o=d}}return xr(o)},SV={parity:function(t){return t.filter((t,e)=>e%2==0)},greedy:function(t,e){let i;return t.filter((t,r)=>(!r||!wd(i,t,e))&&(i=t,!0))}},SU={domainLine:{visible:!1},grid:{visible:!0},subGrid:{visible:!1},tick:{visible:!1},subTick:{visible:!1}};class SK extends xQ{constructor(){super(...arguments),this.type=oQ.cartesianLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new pM.f}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.setExtraAttrFromSpec();let i=null==(e=null==(t=this._tickData)?void 0:t[0])?void 0:e.getDataView().transformsArr.find(t=>t.type===this.registerTicksTransform());i&&(i.options=this._tickTransformOption())}initScales(){var t,e;super.initScales();let i=[0,1];(0,aw.Z)(null==(t=this._domain)?void 0:t.min)&&(i[0]=this._domain.min),(0,aw.Z)(null==(e=this._domain)?void 0:e.max)&&(i[1]=this._domain.max),this._scale.domain(i)}_tickTransformOption(){var t;return Object.assign(Object.assign({},super._tickTransformOption()),{breakData:(null==(t=this._spec.breaks)?void 0:t.length)?()=>this._break:null})}_getUpdateAttribute(t){var e,i;let r=super._getUpdateAttribute(t);if(!C1(this._orient)&&(null==(i=null==(e=this._break)?void 0:e.breaks)?void 0:i.length)){let{width:t,height:e}=this.getLayoutRect(),i=CQ(this._orient),n=i?t:e;r.breaks=this._break.breaks.map(t=>{let e,{range:r,breakSymbol:l,gap:s=6}=t,a=this.valueToPosition((r[0]+r[1])/2)/n;e=hC(s)?Number(s.substring(0,s.length-1))/100:s/n;let o=(0,hy.Z)(null==l?void 0:l.angle)?l.angle:i?60:15;return{range:[a-e/2,a+e/2],breakSymbol:Object.assign(Object.assign({visible:!0},l),{angle:o*Math.PI/180}),rawRange:r}})}return r}getNewScaleRange(){var t,e;let i=super.getNewScaleRange();return(null==(t=this._spec.breaks)?void 0:t.length)&&(null==(e=this._break)?void 0:e.scope)&&(i=SE(this._break.scope).map(t=>i[0]+((0,a1.Z$)(i)-i[0])*t)),i}computeDomain(t){return this.computeLinearDomain(t)}axisHelper(){let t=super.axisHelper();return t.setExtendDomain=this.setExtendDomain.bind(this),t.valueToPosition=this.valueToPosition.bind(this),t}registerTicksTransform(){let t=`${this.type}-ticks`;return dL(this._option.dataSet,t,SG),t}}SK.type=oQ.cartesianLinearAxis,SK.specKey="axes",SK.builtInTheme={axis:Sk,axisLinear:SU,axisX:SR,axisY:SP},(0,yf.jB)(SK,SZ);let SX=()=>{h9.registerGraphicComponent(tJ.lineAxis,(t,e)=>new SM(t,e)),h9.registerGraphicComponent(tQ.lineAxisGrid,(t,e)=>new wN(t,e)),xY(),h9.registerComponent(SK.type,SK)},SY=`${d9}_hide_`;function S$(t,e){t.context.finalAttrs&&(t.context.finalAttrs.visible=e)}let Sq=(t,e)=>{if(!e||0===e.length)return e;let{direction:i,delta:r,deltaMul:n=1,groupBy:l}=t,s=e=>{e.forEach(t=>{t[SY]&&(S$(t,!0),t[SY]=!1)});let l=t.sort?e.slice().sort((t,e)=>t.context.finalAttrs.x-e.context.finalAttrs.x):e;0===i?function(t,e,i){let r=-1/0,n=0,l=0,s=(0,nB.Z)(e),a=e;t.forEach(t=>{if(!1===t.context.finalAttrs.visible)return;let e=t.context.finalAttrs.size/2,{x:l,y:o}=t.context.finalAttrs;s&&(a=(e+n)*i),(-1/0-l)**2+(r-o)**2<(a+n+e)**2?t.context.finalAttrs.forceShow||(t[SY]=!0,S$(t,!1)):r=o,n=e})}(l,r,n):1===i?function(t,e,i){let r=-1/0,n=0,l=(0,nB.Z)(e),s=e;t.forEach(t=>{if(!1===t.context.finalAttrs.visible)return;let e=t.context.finalAttrs.size/2,a=t.context.finalAttrs.x;l&&(s=(e+n)*i),Math.abs(a-r)<s+n+e?t.context.finalAttrs.forceShow||(t[SY]=!0,S$(t,!1)):r=a,n=e})}(l,r,n):function(t,e,i){let r=-1/0,n=0,l=(0,nB.Z)(e),s=e;t.forEach(t=>{if(!1===t.context.finalAttrs.visible)return;let e=t.context.finalAttrs.size/2,a=t.context.finalAttrs.y;l&&(s=(e+n)*i),Math.abs(a-r)<s+n+e?t.context.finalAttrs.forceShow||(t[SY]=!0,S$(t,!1)):r=a,n=e})}(l,r,n)};if(l){let t=e.reduce((t,e)=>{var i,r;let n=null==(r=null==(i=e.context.data)?void 0:i[0])?void 0:r[l];return t[n]?t[n].push(e):t[n]=[e],t},{});Object.keys(t).forEach(e=>{s(t[e])})}else s(e);return e},SJ=()=>{h9.registerGrammarTransform("symbolOverlap",{transform:Sq,runType:"afterEncode"})},SQ={min:a1.iH,max:a1.CE,average:bC,sum:b_};function S0(t,e,i,r){let n=Math.floor(e.length/t),l=[],s=e.length,a,o,h,d=0,u=0;l[u++]=d;for(let t=1;t<s-1;t+=n){let i=Math.min(t+n,s-1),c=Math.min(t+2*n,s),p=(c+i)/2,g=0;for(let t=i;t<c;t++){let i=e[t][r];Number.isNaN(i)||(g+=i)}g/=c-i;let f=t,m=Math.min(t+n,s),y=t-1,v=e[d][r];a=-1,h=f;for(let t=f;t<m;t++){let i=e[t][r];Number.isNaN(r)||(o=Math.abs((y-p)*(i-v)-(y-t)*(g-v)))>a&&(a=o,h=t)}l[u++]=h,d=h}return l[u-1]!==s-1&&(l[u++]=s-1),l.map(t=>i?e[t].i:t)}function S1(t,e,i,r,n){let l=Math.floor(e.length/t),s=[],a=e.length,o=0,h=[];s.push(o),e[o][n]=e[o][n];for(let t=1;t<a-1;t+=l){l>a-t&&(l=a-t,h.length=l),h=[];for(let i=0;i<l;i++)h.push(e[t+i][n]);let i=SQ[r](h);e[o=Math.min(Math.round(t+h.length/2)||0,a-1)][n]=i,s.push(o)}return s.map(t=>i?e[t].i:t)}function S2(t,e,i,r){return S1(t,e,i,"min",r)}function S3(t,e,i,r){return S1(t,e,i,"max",r)}function S5(t,e,i,r){return S1(t,e,i,"average",r)}function S4(t,e,i,r){return S1(t,e,i,"sum",r)}let S6=(t,e)=>{let i=(0,nz.Z)(t.size)?t.size():t.size,r=t.factor||1;if(Array.isArray(i)&&(i=Math.floor(i[1]-i[0])),(i*=r)<=0)return[];if(e.length<=i)return e;if(t.skipfirst)return e.slice(0,1);let{mode:n,yfield:l,groupBy:s}=t,a=null!=l?l:"y",o=S0;if("min"===n?o=S2:"max"===n?o=S3:"average"===n?o=S5:"sum"===n&&(o=S4),e.length){let t={};if(s){for(let i=0,r=e.length;i<r;i++){let r=e[i],n=r[s];t[n]||(t[n]=[]),t[n].push({[a]:r[a],i:i})}let r=[];return Object.keys(t).forEach(n=>{let l=t[n];if(l.length<=i){let t=l.map(t=>t.i);r=r.concat(t)}else{let t=o(i,l,!0,a);r=r.concat(t),l.forEach(t=>e[t.i][a]=t[a])}}),r.sort((t,e)=>t-e),r.map(t=>e[t])}return o(i,e,!1,a).map(t=>e[t])}return[]},S7=()=>{h9.registerGrammarTransform("dataSampling",{transform:S6})};class S8 extends _y{constructor(){super(...arguments),this.type=Y.line,this.transformerConstructor=CX,this._sortDataByAxis=!1}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}initMark(){var t;let e=null!=(t=this._spec.seriesMark)?t:"line";this.initLineMark("line"===e),this.initSymbolMark("point"===e)}initTooltip(){super.initTooltip();let{group:t,mark:e}=this._tooltipHelper.activeTriggerSet;this._lineMark&&t.add(this._lineMark),this._symbolMark&&(e.add(this._symbolMark),t.add(this._symbolMark))}initMarkStyle(){this.initLineMarkStyle(this._direction),this.initSymbolMarkStyle()}initAnimation(){var t,e,i,r;let n={direction:this.direction},l=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;if(this._lineMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("line"))?void 0:i(n,l),_s("line",this._spec,this._markAttributeContext))),this._symbolMark){let t=_m(this);this._symbolMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("scaleInOut"))?void 0:r(),_s("point",this._spec,this._markAttributeContext),t))}}onLayoutEnd(){super.onLayoutEnd(),this.reCompileSampling()}getSeriesStyle(t){var e;let i="point"!==(null==(e=this._spec)?void 0:e.seriesMark);return e=>{var r,n;return i&&"fill"===e&&(e="stroke"),null!=(n=null==(r=this._seriesMark)?void 0:r.getAttribute(e,t))?n:void 0}}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._lineMark,this._symbolMark]}}S8.type=Y.line,S8.mark=_w,S8.builtInTheme={line:{label:{visible:!1,position:"top",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}}},S8.transformerConstructor=CX,(0,yf.jB)(S8,_x);let S9=()=>{S7(),SJ(),CV(),CK(),vJ(),vX(),SI(),SX(),h9.registerSeries(S8.type,S8)},At=(t,e)=>{var i;let{regionId:r,regionIndex:n}=t.spec;if((0,aw.Z)(r)){let t=(0,a1.IX)(r);return null==(i=e.region)?void 0:i.filter(({spec:e})=>t.includes(e.id))}if((0,aw.Z)(n))return(0,a1.IX)(n).map(t=>{var i;return null==(i=e.region)?void 0:i[t]}).filter(aw.Z)},Ae=(t,e)=>{var i;let{seriesId:r,seriesIndex:n}=t.spec;if((0,aw.Z)(r)){let t=(0,a1.IX)(r);return null==(i=e.series)?void 0:i.filter(({spec:e})=>t.includes(e.id))}if((0,aw.Z)(n))return(0,a1.IX)(n).map(t=>{var i;return null==(i=e.series)?void 0:i[t]}).filter(aw.Z)};class Ai{constructor(t){this._option=t,this.type=t.type,this.seriesType=t.seriesType}initChartSpec(t){return this.transformSpec(t),this.transformModelSpec(t)}transformSpec(t){t.region&&0!==t.region.length||(t.region=[{}]),void 0===t.tooltip&&(t.tooltip={}),(0,aw.Z)(t.stackInverse)&&t.region.forEach(e=>{(0,aw.Z)(e.stackInverse)||(e.stackInverse=t.stackInverse)}),(0,aw.Z)(t.stackSort)&&t.region.forEach(e=>{(0,aw.Z)(e.stackSort)||(e.stackSort=t.stackSort)})}generateTransform(t,e){return(i,r,n)=>{let{spec:l,specPath:s,specInfoPath:a,type:o}=r,h=new i.transformerConstructor(Object.assign(Object.assign({},this._option),{type:o})),d=h.transformSpec(l,t,n),u=Object.assign(Object.assign({},r),d);e?u.theme=h.getTheme(l,t):ph(t,s,d.spec),ph(n,null!=a?a:s,u)}}transformModelSpec(t){return this.createSpecInfo(t,this.generateTransform(t,!1))}createSpecInfo(t,e){var i,r;e||(e=this.generateTransform(t,!0));let n={};return this.forEachRegionInSpec(t,e,n),this.forEachSeriesInSpec(t,e,n),null==(i=n.series)||i.forEach((t,e)=>{var i,r;let l=(null!=(r=null!=(i=At(t,n))?i:n.region)?r:[])[0];l&&(l.seriesIndexes||(l.seriesIndexes=[]),l.seriesIndexes.push(e),t.regionIndexes=l.regionIndexes.slice())}),this.forEachComponentInSpec(t,e,n),Object.values(null!=(r=n.component)?r:{}).forEach(t=>t.forEach((t,e)=>{var i,r,l;if(t){if(!t.regionIndexes){let e=null!=(r=null!=(i=At(t,n))?i:n.region)?r:[];t.regionIndexes=e.map(t=>t.regionIndexes[0])}if(!t.seriesIndexes){let e=Ae(t,n);if(e)t.seriesIndexes=e.map(({seriesIndexes:t})=>t[0]);else{let e=new Set;(null!=(l=t.regionIndexes)?l:[]).forEach(t=>{var i,r;let l=null==(i=n.region)?void 0:i[t];null==(r=null==l?void 0:l.seriesIndexes)||r.forEach(t=>e.add(t))}),t.seriesIndexes=Array.from(e)}}}})),n}_isValidSeries(t){return!0}_getDefaultSeriesSpec(t,e,i){var r,n,l,s,a;let o={dataKey:t.dataKey,hover:t.hover,select:t.select,label:t.label,seriesStyle:t.seriesStyle,animation:null!=(r=t.animation)?r:null==(n=this._option.globalInstance)?void 0:n.isAnimationEnable(),animationThreshold:null!=(l=t.animationThreshold)?l:null==(a=(s=this._option).getTheme)?void 0:a.call(s,"animationThreshold"),animationAppear:t.animationAppear,animationDisappear:t.animationDisappear,animationEnter:t.animationEnter,animationUpdate:t.animationUpdate,animationExit:t.animationExit,animationNormal:t.animationNormal,animationState:t.animationState,extensionMark:t.extensionMark,large:t.large,largeThreshold:t.largeThreshold,progressiveStep:t.progressiveStep,progressiveThreshold:t.progressiveThreshold,background:t.seriesBackground,invalidType:t.invalidType,seriesField:t.seriesField,morph:t.morph,interactions:t.interactions},h=this.seriesType;return h&&(o.type=h,o[h]=t[h]),e&&e.length&&e.forEach(e=>{o[e]=t[e]}),i&&i.length&&i.forEach(e=>{o[e]=t[e]}),o}forEachRegionInSpec(t,e,i){var r;return(null!=(r=t.region)?r:[]).map((t,r)=>e(h9.getRegionInType("region"),{spec:t,specPath:["region",r],type:"region",regionIndexes:[r]},i))}forEachSeriesInSpec(t,e,i){var r;return(null!=(r=t.series)?r:[]).map((t,r)=>e(h9.getSeriesInType(t.type),{spec:t,specPath:["series",r],type:t.type,seriesIndexes:[r]},i))}forEachComponentInSpec(t,e,i){var r,n,l;let s,a,o,h,d=[],u=h9.getComponents(),c=[];for(let e=0;e<u.length;e++){let{cmp:i,alwaysCheck:n}=u[e];i.type.startsWith(oQ.cartesianAxis)?s=i:i.type.startsWith(oQ.polarAxis)?a=i:i.type===oQ.geoCoordinate?o=i:(n||t[null!=(r=i.specKey)?r:i.type])&&(i.type===oQ.tooltip?h=i:c.push(u[e]))}let p=!1;if(s){let r=s.getSpecInfo(t,i);(null==r?void 0:r.length)>0&&(p=!0,r.forEach(t=>{let r=h9.getComponentInKey(t.type);d.push(e(r,t,i))}))}if(a&&!p){let r=a.getSpecInfo(t,i);(null==r?void 0:r.length)>0&&(p=!0,r.forEach(t=>{let r=h9.getComponentInKey(t.type);d.push(e(r,t,i))}))}return o&&!p&&(null==(n=o.getSpecInfo(t,i))||n.forEach(t=>{d.push(e(o,t,i))})),c.sort((t,e)=>t.createOrder-e.createOrder),c.forEach(({cmp:r})=>{var n;null==(n=r.getSpecInfo?r.getSpecInfo(t,i):bW(t,r.specKey,r.type))||n.forEach(t=>{d.push(e(r,t,i))})}),h&&(null==(l=bW(t,h.specKey,h.type))||l.forEach(t=>{d.push(e(h,t,i))})),d}transformSeriesSpec(t){let e=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}):t.series=[e]}_findBandAxisBySeries(t,e,i){let r="horizontal"===(null==t?void 0:t.direction)?["left","right"]:["top","bottom"];return i.find(i=>!!r.includes(i.orient)&&((0,aw.Z)(i.seriesId)?(0,a1.IX)(i.seriesId).includes(null==t?void 0:t.id):(0,aw.Z)(i.seriesIndex)?(0,a1.IX)(i.seriesIndex).includes(e):i.type,!0))}_applyAxisBandSize(t,e,i){let{barMaxWidth:r,barMinWidth:n,barWidth:l,barGapInGroup:s}=i,a=!1;(0,n4.Z)(n)?(t.minBandSize=n,a=!0):(0,n4.Z)(l)?(t.minBandSize=l,a=!0):(0,n4.Z)(r)&&(t.minBandSize=r,a=!0),a&&(t.bandSizeLevel=Number.MAX_VALUE,t.bandSizeExtend={extend:e,gap:(0,rD.Z)(s)?s[s.length-1]:s})}}class Ar extends Ai{needAxes(){return!0}_isValidSeries(t){return!this.seriesType||t===this.seriesType}_getDefaultSeriesSpec(t,e){return super._getDefaultSeriesSpec(t,["xField","yField","zField","direction","stack","percent","stackOffsetSilhouette","totalLabel","sortDataByAxis"],e)}transformSpec(t){super.transformSpec(t),super.transformSeriesSpec(t),this._transformAxisSpec(t)}_setDefaultXAxisSpec(t){return{orient:"bottom"}}_setDefaultYAxisSpec(t){return{orient:"left"}}_setDefaultZAxisSpec(t){return{orient:"z"}}_transformAxisSpec(t){if(this.needAxes()){t.axes||(t.axes=[]);let e={x:!1,y:!1,z:!1};t.axes.forEach(i=>{let{orient:r}=i,n=null;"top"!==r&&"bottom"!==r||(e.x=!0,n=this._setDefaultXAxisSpec(t)),"left"!==r&&"right"!==r||(e.y=!0,n=this._setDefaultYAxisSpec(t)),"z"===r&&(e.z=!0,n=this._setDefaultZAxisSpec(t)),n&&Object.keys(n).forEach(t=>{(0,nB.Z)(i[t])&&(i[t]=n[t])}),(0,dx.Z)(i,"trimPadding")&&h5(i,pe(this.type,t))}),e.x||t.axes.push(this._setDefaultXAxisSpec(t)),e.y||t.axes.push(this._setDefaultYAxisSpec(t)),t.zField&&!e.z&&t.axes.push(this._setDefaultZAxisSpec(t))}}}class An extends Ar{_getDefaultSeriesSpec(t){var e;let i=super._getDefaultSeriesSpec(t,["point","line","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","lineLabel"]);return i.seriesMark=null!=(e=t.seriesMark)?e:"line",i}transformSpec(t){super.transformSpec(t),c8(t)}}class Al{get dataList(){return this._dataArr}constructor(t){this._dataArr=[],this._dataSet=t}parseData(t){this._dataArr=[];let e=(0,a1.IX)(t);for(let t=0;t<e.length;t++)this._dataArr.push(dj(e[t],this._dataSet,this._dataArr))}updateData(t,e=!1,i=!0){let r=(0,a1.IX)(t);return(!e||r.length===this._dataArr.length)&&(this._dataValueForEach(r,(t,e)=>{e.markRunning()}),this._dataValueForEach(r,(t,e)=>{dG(e,t,i)}),!0)}_dataValueForEach(t,e){t.forEach((t,i)=>{if(t instanceof eq.V)return;let r=this.getSeriesData(t.id,i);r&&e(t,r,i)})}getSeriesData(t,e){if(!this._dataArr.length)return null;if("string"==typeof t){let e=this._dataArr.filter(e=>e.name===t);if(e[0])return e[0];hO(`no data matches dataId ${t}!`)}if("number"==typeof e){if(this._dataArr[e])return this._dataArr[e];hO(`no data matches dataIndex ${e}!`)}return this._dataArr[0]}}class As{constructor(t,e){this._scaleSpecMap=new Map,this._scaleMap=new Map,this._modelScaleSpecMap=new Map,this._markAttributeScaleMap=new Map,this._spec=null,this._chart=null,this.getStatisticalFields=t=>{let e=[];return this._scaleSpecMap.forEach((i,r)=>{hb(i.domain)&&i.domain.forEach(r=>{r.dataId===t&&r.fields.forEach(t=>{bM(e,[{key:t,operations:(0,pW.z2)(i.type)?["max","min"]:["values"]}])})})}),this._markAttributeScaleMap.forEach((i,r)=>{let n=this.getScale(r);i.forEach(i=>{this._getSeriesBySeriesId(i.seriesId).getRawData().name===t&&i.field&&bM(e,[{key:i.field,operations:(0,pW.z2)(n.type)?["max","min"]:["values"]}])})}),e},this._spec=t,this._chart=e,this._setAttrFromSpec()}_createFromSpec(t){if(!t.id)return null;let e=this._scaleMap.get(t.id);return e||(e="ordinal"===t.type&&"color"===t.id?pE("colorOrdinal"):pE(t.type)),e?((0,rD.Z)(t.range)&&e.range(t.range),(0,rD.Z)(t.domain)&&(hb(t.domain)||e.domain(t.domain)),t.specified&&e.specified&&e.specified(t.specified),t.clamp&&e.clamp&&e.clamp(t.clamp),e):null}_setAttrFromSpec(){var t;if(!(null==(t=this._spec)?void 0:t.length))return;let e=new Map,i=new Map;this._spec.forEach(t=>{let r=this._createFromSpec(t);r&&(e.set(t.id,r),i.set(t.id,t))}),this._modelScaleSpecMap.forEach(t=>{let r=this._createFromSpec(t);r&&(e.set(t.id,r),i.set(t.id,t))}),this._scaleSpecMap=i,this._scaleMap=e}updateSpec(t){let e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if((0,uL.X)(t,this._spec))return e;e.change=!0;for(let i=0;i<t.length;i++){let r=t[i],n=this._scaleMap.get(r.id);if(!n)return e.reMake=!0,e;let l=this._spec.find(t=>t.id===r.id);if(!l.id||l.type!==r.type||!(0,uL.X)(l.specified,r.specified))return e.reMake=!0,e;r.range&&!(0,uL.X)(r.range,n.range())&&(n.range(r.range),e.reRender=!0),hb(r.domain)?e.reRender=!0:(0,uL.X)(r.domain,n.domain())||(n.domain(r.domain),e.reRender=!0),this._scaleSpecMap.set(r.id,r)}return this._spec=t,e}registerModelScale(t){let e=this._createFromSpec(t);e&&(this._modelScaleSpecMap.set(t.id,t),this._scaleSpecMap.set(t.id,t),this._scaleMap.set(t.id,e))}removeModelScale(t){this._modelScaleSpecMap.forEach(e=>{t(e)&&(this._modelScaleSpecMap.delete(e.id),this._scaleSpecMap.delete(e.id),this._scaleMap.delete(e.id))})}getScale(t){return this._scaleMap.get(t)}getScaleSpec(t){return this._scaleSpecMap.get(t)}_getSeriesByRawDataId(t){let e=this._chart.getAllSeries();for(let i=0;i<e.length;i++){let r=e[i];if(r.getRawData().name===t)return r}return null}_getSeriesBySeriesId(t){let e=this._chart.getAllSeries();for(let i=0;i<e.length;i++){let r=e[i];if(r.id===t)return r}return null}updateScaleDomain(t){this._scaleSpecMap.forEach((e,i)=>{let r,n=this._scaleMap.get(i);if(!n)return;if(!hb(e.domain))return e.domain&&0!==e.domain.length||n.domain(t),void this._updateMarkScale(i,n,n.domain().slice());r=(0,pW.z2)(e.type)?[null,null]:new Set,e.domain.forEach(t=>{let i=this._getSeriesByRawDataId(t.dataId);if(!i)return;let n=(0,pW.z2)(e.type);t.fields.forEach(t=>{let e=i.getRawDataStatisticsByField(t,n);e&&(n?((0,nB.Z)(r[0])?r[0]=e.min:r[0]=Math.min(e.min,r[0]),(0,nB.Z)(r[1])?r[1]=e.max:r[1]=Math.max(e.max,r[1])):e.values.forEach(t=>{r.add(t)}))})});let l=r;(0,pW.z2)(e.type)||(r=Array.from(r)),n.domain(r),this._updateMarkScale(i,n,l)})}_updateMarkScale(t,e,i){let r=this._markAttributeScaleMap.get(t);r&&0!==r.length&&r.forEach(t=>{if(!t.field||!t.markScale||t.markScale===e)return;if((0,nB.Z)(t.changeDomain)||"none"===t.changeDomain||(0,nB.Z)(t.seriesId))return void((0,pW.z2)(e.type)?t.markScale.domain(i):e.domain(Array.from(i)));let r=this._getSeriesBySeriesId(t.seriesId),n=(0,pW.z2)(e.type),l=r.getRawDataStatisticsByField(t.field,n);if(!(0,uF.Z)(l))return"expand"===t.changeDomain?(n?(i[0]=Math.min(i[0],l.min),i[1]=Math.max(i[1],l.max)):(l.values.forEach(t=>{i.add(t)}),i=Array.from(i)),void t.markScale.domain(i)):void("replace"!==t.changeDomain||(n?t.markScale.domain([l.min,l.max]):t.markScale.domain(l.values)));(0,pW.z2)(e.type)?t.markScale.domain(i):e.domain(Array.from(i))})}registerMarkAttributeScale(t,e){let i=this._scaleMap.get(t.scale),r=this._markAttributeScaleMap.get(t.scale);r||(r=[],this._markAttributeScaleMap.set(t.scale,r));let n=i;return!(0,nB.Z)(t.field)&&((0,nB.Z)(t.changeDomain)||"none"===t.changeDomain||(0,nB.Z)(e))||(n=i.clone()),r.push(Object.assign(Object.assign({},t),{seriesId:e,markScale:n})),n}}class Aa{constructor(){this._stateGraphicsByTrigger=new Map,this._disableTriggerEvent=!1,this._triggerMapByState=new Map}setDisableActiveEffect(t){this._disableTriggerEvent=t}addTrigger(t){t&&[t.getStartState(),t.getResetState()].forEach(e=>{if(e){let i=this._triggerMapByState.get(e);i?i.includes(t)||i.push(t):this._triggerMapByState.set(e,[t])}})}setStatedGraphics(t,e){this._stateGraphicsByTrigger.set(t,e)}getStatedGraphics(t){return this._stateGraphicsByTrigger.get(t)}updateStates(t,e,i,r,n){return this._disableTriggerEvent?[]:e&&e.length?(r&&n?i&&i.length?(this.toggleReverseStateOfGraphics(t,e,i,n),this.toggleStateOfGraphics(t,e,i,r)):this.addBothStateOfGraphics(t,e,r,n):r&&(i&&i.length?this.toggleStateOfGraphics(t,e,i,r):this.addStateOfGraphics(t,e,r)),e):[]}toggleReverseStateOfGraphics(t,e,i,r){let n=t.getMarkIdByState();i.forEach(t=>{var e;if(r&&n[r]&&n[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,n=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(r,!0,n)}}),e.forEach(t=>{var e;if(r&&n[r]&&n[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,n=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(r,n)}})}toggleStateOfGraphics(t,e,i,r){let n=t.getMarkIdByState();i.forEach(t=>{var e;if(r&&n[r]&&n[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,n=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(r,n)}}),e.forEach(t=>{var e;if(r&&n[r]&&n[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,n=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(r,!0,n)}})}addBothStateOfGraphics(t,e,i,r){let n=t.getMarks(),l=t.getMarkIdByState();n.forEach(t=>{var n;let s=r&&l[r]&&l[r].includes(t.id),a=i&&l[i]&&l[i].includes(t.id);if(!s&&!a)return;let o=t.hasAnimationByState&&t.hasAnimationByState("state");null==(n=t.getGraphics())||n.forEach(t=>{e&&e.includes(t)?a&&t.addState(i,!0,o):s&&t.addState(r,!0,o)})})}addStateOfGraphics(t,e,i){let r=t.getMarks(),n=t.getMarkIdByState();r.forEach(t=>{var r;let l=i&&n[i]&&n[i].includes(t.id);if(!l)return;let s=t.hasAnimationByState&&t.hasAnimationByState("state");null==(r=t.getGraphics())||r.forEach(t=>{e&&e.includes(t)&&l&&t.addState(i,!0,s)})})}clearAllStatesOfTrigger(t,e,i){if(this._disableTriggerEvent)return;let r=this.getStatedGraphics(t);if(!r||!r.length)return;let n=t.getMarks(),l=t.getMarkIdByState();n.forEach(t=>{if(t){let n=t.getGraphics(),s=t.hasAnimationByState&&t.hasAnimationByState("state");n&&n.length&&(i&&l[i]&&l[i].includes(t.id)&&n.forEach(t=>{t.removeState(i,s)}),e&&l[e]&&l[e].includes(t.id)&&n.forEach(t=>{r.includes(t)&&t.removeState(e,s)}))}})}clearAllStates(){this._disableTriggerEvent||this._triggerMapByState.forEach((t,e)=>{t.forEach(t=>{this.clearAllStatesOfTrigger(t,e,t.getResetState())})})}clearByState(t){if(this._disableTriggerEvent)return;let e=this._triggerMapByState.get(t);e&&e.length&&e.forEach(e=>{this.clearAllStatesOfTrigger(e,t,e.getResetState()),this.setStatedGraphics(e,[])})}updateStateOfGraphics(t,e){if(this._disableTriggerEvent)return;let i=this._triggerMapByState.get(t);i&&i.length&&i.forEach(t=>{let i=e.filter(e=>t.getMarks().some(t=>{let i=t&&t.getGraphics();return i&&i.includes(e)}));this.updateStates(t,i,this.getStatedGraphics(t),t.getStartState(),t.getResetState()),this.setStatedGraphics(t,i)})}}var Ao=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Ah extends ps{getSpec(){return this._spec}setSpec(t){this._spec=t}getOption(){return this._option}getLayoutRect(){return this._layoutRect}getViewRect(){return this._viewRect}getLayoutTag(){return this._layoutTag}setLayoutTag(t,e,i=!0){this._layoutTag=t;let r=this.getCompiler();return r&&(r.updateLayoutTag(),t&&i&&r.renderNextTick(e)),this._layoutTag}resetLayoutItemTag(){this.getLayoutElements().forEach(t=>t.setWillLayoutTag())}getModelOption(){return this._modelOption}getGlobalScale(){return this._globalScale}getEvent(){return this._event}get chartData(){return this._chartData}_setModelOption(){}constructor(t,e){var i,r,n,l;super(e),this.type="chart",this.id=hm(),this._regions=[],this._series=[],this._components=[],this._layoutRect={x:0,y:0,width:ut,height:ue},this._viewRect={width:ut,height:ue},this._viewBox={x1:0,y1:0,x2:ut,y2:ue},this._layoutTag=!0,this._idMap=new Map,this.state={layoutUpdateRank:1},this.padding={top:0,left:0,right:0,bottom:0},this.getAllSeries=()=>{var t;return null!=(t=this._series)?t:[]},this.getRegionsInIndex=t=>t&&0!==t.length?this._regions.filter((e,i)=>t.includes(i)):[this._regions[0]],this.getAllRegions=()=>this._regions,this.getRegionsInIds=t=>t?this._regions.filter(e=>t.includes(e.id)):[],this.getRegionsInQuerier=t=>t?this._regions.filter((e,i)=>(0,a1.IX)(t).some(t=>(0,aw.Z)(t.regionId)&&t.regionId===e.userId||t.regionIndex===i)):this._regions,this.getRegionsInUserId=t=>{if(t)return this._regions.find(e=>e.userId===t)},this.getRegionsInUserIdOrIndex=(t,e)=>this.getAllRegions().filter(i=>(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())),this.getComponents=()=>this._components,this.getSeriesInIndex=t=>t&&0!==t.length?this._series.filter((e,i)=>t.includes(i)):[this._series[0]],this.getSeriesInIds=t=>t?this._series.filter(e=>t.includes(e.id)):[],this.getSeriesInUserId=t=>{if(t)return this._series.find(e=>e.userId===t)},this.getSeriesInUserIdOrIndex=(t,e)=>this.getAllSeries().filter(i=>(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())),this.getComponentByIndex=(t,e)=>{let i=this._components.filter(e=>(e.specKey||e.type)===t);if(i&&0!==i.length)return i[e]},this.getComponentsByKey=t=>this._components.filter(e=>(e.specKey||e.type)===t),this.getComponentByUserId=t=>{let e=this._components.find(e=>e.userId===t);if(e)return e},this.getComponentsByType=t=>this._components.filter(e=>e.type===t),this._paddingSpec=hM(null!=(i=t.padding)?i:e.getTheme("padding")),this._event=new dv(e.eventDispatcher,e.mode),this._dataSet=e.dataSet,this._chartData=new Al(this._dataSet),this._modelOption=Object.assign(Object.assign({},e),{mode:this._option.mode,map:this._idMap,getChartLayoutRect:()=>this._layoutRect,getChartViewRect:()=>this._viewRect,getChart:()=>this,globalScale:this._globalScale,onError:null==(r=this._option)?void 0:r.onError,disableTriggerEvent:!0===(null==(n=this._option)?void 0:n.disableTriggerEvent),componentShowContent:null==(l=this._option)?void 0:l.componentShowContent,getSeriesData:this._chartData.getSeriesData.bind(this._chartData),dispatchEvent:(t,e)=>this._option.globalInstance.event.emit(t,e)}),this._setModelOption&&this._setModelOption(),this._spec=t}created(t){this._chartData.parseData(this._spec.data),this._createGlobalScale(),this._createBackground(),this._createLayout(),t.forEachRegionInSpec(this._spec,this._createRegion.bind(this)),t.forEachSeriesInSpec(this._spec,this._createSeries.bind(this)),t.forEachComponentInSpec(this._spec,this._createComponent.bind(this),this._option.getSpecInfo())}_initInteractions(){if(this._option.disableTriggerEvent)return;this._interaction=new Aa;let t=this.getAllSeries(),e=[],i={};t.forEach(t=>{let r=t.getInteractionTriggers();if(r&&r.length){let n=t.getRegion().id;r.forEach(({trigger:t,marks:r})=>{let l=`${n}-${t.type}`;i[l]?r.forEach(t=>{i[l].marks.push(t)}):(i[l]=Object.assign(Object.assign({},t),{marks:r}),e.push(i[l]))})}}),e.forEach(t=>{let e=h9.createInteractionTrigger(t.type,Object.assign(Object.assign({},t),{event:this._event,interaction:this._interaction}));e&&(e.init(),this._interaction.addTrigger(e))})}init(){var t,e;null==(t=this._beforeInit)||t.call(this),this._regions.forEach(t=>t.init({})),this._series.forEach(t=>t.init({})),this._components.forEach(t=>t.init({dataSet:this._dataSet})),this._initEvent(),null==(e=this._initStack)||e.call(this),this.reDataFlow(),this._initInteractions(),this.initStageAnimation()}initStageAnimation(){let t=this._option.getCompiler();(null==t?void 0:t.setStageAnimationConfig)&&t.setStageAnimationConfig(_l({},_s("stage",this._spec,{}),null))}reDataFlow(){this._series.forEach(t=>{var e;return null==(e=t.getRawData())?void 0:e.markRunning()}),this._series.forEach(t=>t.fillData()),this.updateGlobalScaleDomain()}onResize(t,e,i=!0){this._canvasRect={width:t,height:e},this._updateLayoutRect(this._option.viewBox),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,i)}updateViewBox(t,e){this._option.viewBox=t,this._updateLayoutRect(t),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,e)}_createBackground(){let t=this._spec.background;if(!t||"object"!=typeof t||(0,aw.Z)(t.gradient))return;let e=(0,xN.Z)(t,["x","y","width","height","x1","y1","image"]);e.background=t.image,this._backgroundMark=h9.createMark("group","chart-background",{model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._globalScale}),this._backgroundMark.created(),this._backgroundMark.setStyle(Object.assign(Object.assign({},e),{x:()=>this._viewBox.x1,y:()=>this._viewBox.y1,width:()=>this._viewBox.x2-this._viewBox.x1,height:()=>this._viewBox.y2-this._viewBox.y1})),this._backgroundMark.setMarkConfig({zIndex:ts.SeriesGroup-2}),this.getCompiler().addRootMark(this._backgroundMark)}_createRegion(t,e){if(!t)return;let{spec:i}=e,r=Ao(e,["spec"]),n=new t(i,Object.assign(Object.assign({},this._modelOption),r));n&&(n.created(),this._regions.push(n))}_createSeries(t,e){let i;if(!t)return;let{spec:r}=e,n=Ao(e,["spec"]);if((0,aw.Z)(r.regionId)?i=this.getRegionsInUserId(r.regionId):(0,aw.Z)(r.regionIndex)&&(i=this.getRegionsInIndex([r.regionIndex])[0]),!i&&!(i=this._regions[0]))return;let l=new t(r,Object.assign(Object.assign(Object.assign({},this._modelOption),n),{type:r.type,region:i,globalScale:this._globalScale,sourceDataList:this._chartData.dataList}));l&&(l.created(),this._series.push(l),i.addSeries(l))}getSeriesById(t){return this._series.find(e=>e.id===t)}_createComponent(t,e){let i=t.createComponent(e,Object.assign(Object.assign({},this._modelOption),{type:t.type,getAllRegions:this.getAllRegions,getRegionsInIndex:this.getRegionsInIndex,getRegionsInIds:this.getRegionsInIds,getRegionsInUserIdOrIndex:this.getRegionsInUserIdOrIndex,getAllSeries:this.getAllSeries,getSeriesInIndex:this.getSeriesInIndex,getSeriesInIds:this.getSeriesInIds,getSeriesInUserIdOrIndex:this.getSeriesInUserIdOrIndex,getAllComponents:this.getComponents,getComponentByIndex:this.getComponentByIndex,getComponentByUserId:this.getComponentByUserId,getComponentsByKey:this.getComponentsByKey,getComponentsByType:this.getComponentsByType}));i&&(i.created(),this._components.push(i))}getAllComponents(){return this._components}getAllModels(){return[].concat(this.getAllSeries(),this.getAllComponents(),this.getAllRegions())}getModelInFilter(t){if((0,nI.Z)(t))return this.getAllModels().find(e=>e.userId===t);if((0,nz.Z)(t))return this.getAllModels().find(e=>t(e));let e=0;return this.getAllModels().find(i=>{var r;if((null!=(r=i.specKey)?r:i.type)===t.type){if(e===t.index)return!0;e++}return!1})}_createLayout(){this._updateLayoutRect(this._option.viewBox),this._initLayoutFunc()}setLayout(t){this._option.layout=t,this._initLayoutFunc()}_initLayoutFunc(){var t,e,i;if(this._layoutFunc=this._option.layout,!this._layoutFunc){let r=h9.getLayoutInKey(null!=(e=null==(t=this._spec.layout)?void 0:t.type)?e:"base");if(r){let t=new r(this._spec.layout,{onError:null==(i=this._option)?void 0:i.onError});this._layoutFunc=t.layoutItems.bind(t)}}}layout(){var t,e,i,r;if(null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeLayoutWithSceneGraph)||e.call(t,this._option.globalInstance),this.getLayoutTag()){this._event.emit(J.layoutStart,{chart:this,vchart:this._option.globalInstance}),this.onLayoutStart();let t=this.getLayoutElements();this._layoutFunc(this,t,this._layoutRect,this._viewBox),this._event.emit(J.afterLayout,{elements:t,chart:this}),this.setLayoutTag(!1),this.onLayoutEnd(),this._event.emit(J.layoutEnd,{chart:this,vchart:this._option.globalInstance})}null==(r=null==(i=this._option.performanceHook)?void 0:i.afterLayoutWithSceneGraph)||r.call(i,this._option.globalInstance)}onLayoutStart(){this.getAllModels().forEach(t=>t.onLayoutStart(this._layoutRect,this._viewRect))}onLayoutEnd(){this.getAllModels().forEach(t=>{"series"!==t.modelType&&t.onLayoutEnd()})}onEvaluateEnd(t){[...this._components,...this._regions,...this._series].forEach(e=>e.onEvaluateEnd(t))}onBeforeRender(){[...this._components,...this._regions,...this._series].forEach(t=>t.onBeforeRender())}getLayoutElements(){return this.getAllModels().map(t=>t.layout).filter(t=>!!t)}getModelById(t){let e=this._idMap.get(t);if(e&&e instanceof pc)return e}getModelByUserId(t){let e=this.getSeriesInUserId(t);if(e)return e;let i=this.getRegionsInUserId(t);return i||this.getComponentByUserId(t)||void 0}getAllMarks(){return Array.from(this._idMap.values()).filter(t=>t&&t instanceof gW)}getMarkById(t){let e=this._idMap.get(t);if(e&&e instanceof gW)return e}getMarkByUserName(t){return this.getAllMarks().filter(e=>e.name&&e.name===t)}updateData(t,e,i=!0,r){let n=this._dataSet.getDataView(t);n&&(n.markRunning(),n.parseNewData(e,r)),i&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(t=>t.onDataUpdate())}updateFullData(t,e=!0){(0,a1.IX)(t).forEach(t=>{let e=this._dataSet.getDataView(t.id);e&&e.markRunning()}),(0,a1.IX)(t).forEach(t=>{let e=this._dataSet.getDataView(t.id);e&&dG(e,t,!0)}),e&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(t=>t.onDataUpdate())}setCanvasRect(t,e){this._canvasRect={width:t,height:e}}getCanvasRect(){return this._canvasRect||(this._canvasRect=c9(this._spec,this._option,{width:ut,height:ue})),this._canvasRect}getSeriesData(t,e){return this._chartData.getSeriesData(t,e)}_transformSpecScale(){var t;let e=this._spec.scales?[...this._spec.scales]:[],i=e.find(t=>"color"===t.id),r=this.getColorScheme();if(!i&&(i={type:"ordinal",id:"color",domain:null,range:null},e.push(i),this._spec.color)){let t=this._spec.color;(0,rD.Z)(t)?i.range=t:(Object.prototype.hasOwnProperty.call(t,"type")&&(i.type=t.type),Object.prototype.hasOwnProperty.call(t,"domain")&&(i.domain=t.domain),Object.prototype.hasOwnProperty.call(t,"range")&&(i.range=t.range),Object.prototype.hasOwnProperty.call(t,"specified")&&(i.specified=t.specified),Object.prototype.hasOwnProperty.call(t,"clamp")&&(i.clamp=t.clamp))}return(null==(t=i.range)?void 0:t.length)||(i.range=hY(r),i.rangeTheme=!0),e}_createGlobalScale(){this._globalScale=new As(this._transformSpecScale(),this),this._modelOption.globalScale=this._globalScale}updateGlobalScaleDomain(){let t=new Set;this._series.forEach(e=>{let i=e.getSeriesKeys();i&&i.forEach(e=>t.add(e))});let e=Array.from(t);this._globalScale.updateScaleDomain(e)}updateGlobalScale(t){pt(t,this._globalScale.updateSpec(this._transformSpecScale()))}updateGlobalScaleTheme(){let t=this._globalScale.getScaleSpec("color"),e=this.getColorScheme();t.rangeTheme&&(t.range=hY(e),this._globalScale.getScale("color").range(t.range))}_getSpecKeys(t){let e={width:!0,height:!0};return Object.keys(t).filter(t=>!e[t]).sort()}updateSpec(t){let e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(this.setLayoutTag(!0,null,!1),t.type!==this.type)return e.reMake=!0,e;let i=this._getSpecKeys(this._spec),r=this._getSpecKeys(t);if(!(0,uL.X)(i,r))return e.reMake=!0,e;for(let r=0;r<i.length;r++){let n=i[r];if((0,rD.Z)(this._spec[n])&&this._spec[n].length!==(0,a1.IX)(t[n]).length)return e.reMake=!0,e}let n=this._spec;return this._spec=t,this.updateChartConfig(e,n),e.reMake||(this.updateGlobalScale(e),e.reMake||(this.updateRegionSpec(e),e.reMake||(this.updateComponentSpec(e),e.reMake||(this.updateSeriesSpec(e),e.reMake||(this.reInit(),this.updateDataSpec(),this.updateGlobalScaleDomain()))))),e}updateChartConfig(t,e){var i,r;this._paddingSpec=hM(null!=(i=this._spec.padding)?i:null==(r=this._option)?void 0:r.getTheme("padding")),this._updateLayoutRect(this._viewBox)}updateDataSpec(){this._spec.data&&this._chartData.updateData(this._spec.data,!1,!0)}updateRegionSpec(t){var e;(null==(e=this._spec)?void 0:e.region)&&(this._spec.region.length===this._regions.length?this._regions.forEach(e=>{pt(t,e.updateSpec(this._spec.region[e.getSpecIndex()]))}):t.reMake=!0)}updateComponentSpec(t){let e={},i={[oQ.title]:!0,[oQ.brush]:!0,[oQ.indicator]:!0};for(let r in this._components.forEach(r=>{var n,l;if(r.type===oQ.label||r.type===oQ.totalLabel)return;i[r.type]&&(i[r.type]=!1);let s=r.specKey||r.type,a=null!=(n=this._spec[s])?n:{};(0,rD.Z)(a)?(e[s]=e[s]||{specCount:a.length,componentCount:0},e[s].componentCount++,pt(t,r.updateSpec(null!=(l=a[r.getSpecIndex()])?l:{},a))):pt(t,r.updateSpec(a))}),e)if(Object.prototype.hasOwnProperty.call(e,r)){let i=e[r];i.componentCount!==i.specCount&&(t.reMake=!0)}let r=t=>t&&!1!==t.visible;Object.keys(i).forEach(e=>{if(i[e]){let i=this._spec[e];((0,rD.Z)(i)?i.some(r):r(i))&&(t.reMake=!0)}})}updateSeriesSpec(t){this._spec.series.length===this._series.length?this._series.forEach(e=>{let i=this._spec.series[e.getSpecIndex()];pt(t,e.updateSpec(i))}):t.reMake=!0}getCanvas(){var t,e;return null!=(e=null==(t=this.getCompiler())?void 0:t.getCanvas())?e:null}_updateLayoutRect(t){let e=this.getCanvasRect();if(t){this._viewBox=t;let{x1:i=0,y1:r=0,x2:n,y2:l}=t;e={width:n-i,height:l-r}}else this._viewBox={x1:0,y1:0,x2:e.width,y2:e.height};this._viewRect=e,this.padding=hS(this._paddingSpec,e,e),this._layoutRect.width=e.width-this.padding.left-this.padding.right,this._layoutRect.height=e.height-this.padding.top-this.padding.bottom,this._layoutRect.x=this.padding.left,this._layoutRect.y=this.padding.top,this._event.emit(J.layoutRectUpdate,{chart:this})}setCurrentTheme(){this.updateChartConfig({change:!0,reMake:!1},this._spec),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,!1),this.updateGlobalScaleTheme(),this.reInit()}reInit(){[...this._regions,...this._series,...this._components].forEach(t=>{let e=t.getSpecInfo();e&&e.spec&&t.reInit(e.spec)})}clear(){this.getAllModels().forEach(t=>{var e;return null==(e=t.clear)?void 0:e.call(t)})}compile(){this.compileBackground(),this.compileLayout(),this.compileRegions(),this.compileSeries(),this.compileComponents()}afterCompile(){this.getAllRegions().forEach(t=>{var e;null==(e=t.afterCompile)||e.call(t)}),this.getAllSeries().forEach(t=>{var e;null==(e=t.afterCompile)||e.call(t)}),this.getAllComponents().forEach(t=>{var e;null==(e=t.afterCompile)||e.call(t)})}compileLayout(){let{width:t,height:e}=this.getCanvasRect();this.getCompiler().setSize(t,e)}compileBackground(){this._backgroundMark&&this._backgroundMark.compile()}compileRegions(){var t,e,i,r;null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeRegionCompile)||e.call(t,this._option.globalInstance),this.getAllRegions().forEach(t=>{t.compile()}),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterRegionCompile)||r.call(i,this._option.globalInstance)}compileSeries(){var t,e,i,r;null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeSeriesCompile)||e.call(t,this._option.globalInstance),this.getAllSeries().forEach(t=>{t.compile()}),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterSeriesCompile)||r.call(i,this._option.globalInstance)}compileComponents(){var t,e,i,r;null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeComponentCompile)||e.call(t,this._option.globalInstance),this.getAllComponents().forEach(t=>{t.compile()}),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterComponentCompile)||r.call(i,this._option.globalInstance)}release(){[...this._components,...this._regions,...this._series].forEach(t=>{t.beforeRelease()}),super.release(),this.clear(),[...this._components,...this._regions,...this._series].forEach(t=>{t.release()}),this._components=this._regions=this._series=[],this._spec={},this._dataSet=this._globalScale=this._layoutFunc=null,this._layoutTag=!1,this._idMap.clear()}onLayout(){this.layout()}updateState(t,e){let i=this.getAllSeries();for(let r in t){if((0,uF.Z)(t[r]))continue;let n=t[r],l={stateValue:r};l=(0,nz.Z)(n.filter)?Object.assign({filter:n.filter},l):Object.assign(Object.assign({},n.filter),l),n.level&&(l.level=n.level),i.forEach(t=>{t.getMarks().forEach(i=>{i.stateStyle[r]&&(e&&!e(t,i,r)||(i.state.changeStateInfo(l),i.updateMarkState(r)))})})}}setSelected(t,e,i){this._setStateInDatum(td.STATE_SELECTED,t,e,i)}setHovered(t,e,i){this._setStateInDatum(td.STATE_HOVER,t,e,i)}clearState(t){this._interaction.clearByState(t)}clearAllStates(){this._interaction.clearAllStates()}clearSelected(){this.clearState(td.STATE_SELECTED)}clearHovered(){this.clearState(td.STATE_HOVER)}_initEvent(){[J.dataZoomChange,J.scrollBarChange].forEach(t=>{this._event.on(t,({value:t})=>{this._disableMarkAnimation(["exit","update"]);let e=()=>{this._enableMarkAnimation(["exit","update"]),this._event.off(q.AFTER_MARK_RENDER_END,e)};this._event.on(q.AFTER_MARK_RENDER_END,e)})})}_enableMarkAnimation(t){this.getAllMarks().forEach(e=>e.enableAnimationByState(t))}_disableMarkAnimation(t){this.getAllMarks().forEach(e=>e.disableAnimationByState(t))}filterGraphicsByDatum(t,e={}){var i;let r=(t=t?(0,a1.IX)(t):null)?Object.keys(t[0]):null,n=[],l=null!=(i=e.getDatum)?i:dM;return this.getRegionsInQuerier(e.region).forEach(i=>{let s=[];t&&i.getSeries().forEach(a=>{a.getMarks().forEach(o=>{let h=o.getGraphics();if(h&&h.length&&(!e.filter||(0,nz.Z)(e.filter)&&e.filter(a,o)))if(dA(o.type))h.filter(h=>{let d=l(h,o,a,i);d&&t.every((t,e)=>r.every(i=>t[i]==d[e][i]))&&(s.push(h),n.push(h),e.callback&&e.callback(h,o,a,i))});else if(t.length>1){let d=t.slice();h.forEach(t=>{let h=l(t,o,a,i),u=h&&d.findIndex(t=>r.every(e=>t[e]==h[e]));u>=0&&(d.splice(u,1),s.push(t),n.push(t),e.callback&&e.callback(t,o,a,i))})}else{let d=h.find(e=>{let n=l(e,o,a,i);return n&&r.every(e=>t[0][e]==n[e])});d&&(s.push(d),n.push(d),e.callback&&e.callback(d,o,a,i))}})}),e.regionCallback&&e.regionCallback(s,i)}),n}_setStateInDatum(t,e,i,r){if(!e)return void this._interaction.clearByState(t);let n=this.filterGraphicsByDatum(e,{filter:i,region:r});this._interaction.updateStateOfGraphics(t,n)}setDimensionIndex(t,e){var i;let r=null;Array.from(this._event.getComposedEventMap().values()).forEach(i=>{let{eventType:n,event:l}=i;if(n===tq.dimensionHover||n===tq.dimensionClick){let i=l.dispatch(t,e);(null==i?void 0:i.length)&&(r=i)}});let n=(0,nB.Z)(t)||!r||r.every(t=>(0,pW.lK)(t.axis.getScale().type)&&(0,nB.Z)(t.index)),l=n||r.every(t=>(0,pW.lK)(t.axis.getScale().type)&&t.data.every(t=>0===t.datum.length));if(!1!==e.tooltip){let t=this.getComponentsByType(oQ.tooltip)[0];if(null==t?void 0:t.getVisible())if(n||l)null==(i=t.hideTooltip)||i.call(t);else{let i={};r.forEach(t=>{let{axis:e,value:r,data:n}=t,l="left"===e.getOrient()||"right"===e.getOrient();n.forEach(t=>{var e,n,s;let a=l?t.series.fieldY[0]:t.series.fieldX[0];i[a]=null!=(s=null==(n=null==(e=t.datum)?void 0:e[0])?void 0:n[a])?s:r})}),t.showTooltip(i,e.showTooltipOption)}}if(!1!==e.crosshair){let t=this.getComponentsByType(oQ.cartesianCrosshair)[0];t&&t.clearAxisValue&&t.setAxisValue&&(n?t.hideCrosshair():t.showCrosshair(r))}}showCrosshair(t){var e;let i=null!=(e=this.getComponentsByType(oQ.cartesianCrosshair)[0])?e:this.getComponentsByType(oQ.polarCrosshair)[0];if(!i)return;let r=this.getComponentsByKey("axes"),n=[];r.forEach(e=>{let i=t(e);!1!==i&&n.push({axis:e,value:i})}),i.showCrosshair(n)}getColorScheme(){var t,e;return null==(e=(t=this._option).getTheme)?void 0:e.call(t,"colorScheme")}}let Ad=(t,e)=>{let i={nodes:{}},{fields:r}=e;if(!(null==r?void 0:r.length))return i;let n=r.length-1,l,s=i;return t.forEach(t=>{t.latestData&&t.latestData.forEach(t=>{s=i;for(let e=0;e<r.length;e++){let i=r[e],a=t[i];if((0,nB.Z)(a))break;s.groupField=i,s.nodes[a]||(e===n?s.nodes[a]={values:[]}:(l={nodes:{}},s.nodes[a]=l)),e===n?s.nodes[a].values.push(t):s=s.nodes[a]}})}),i};class Au{constructor(t,e){this.stackRegion=({model:t})=>{var e;let i=t.getSeries();if(!i.some(t=>t.getStack()))return;let r=i.some(t=>{var e,i,r,n;return!!(null==(i=null==(e=t.getSpec())?void 0:e.totalLabel)?void 0:i.alwayCalculateTotal)||(null==(n=null==(r=t.getSpec())?void 0:r.totalLabel)?void 0:n.visible)}),n=r||i.some(t=>t.getPercent()),l=i.some(t=>t.getStackOffsetSilhouette()),s=bk(t,!0);for(let e in s)for(let i in s[e].nodes)bL(s[e].nodes[i],t.getStackInverse(),n,r);if(l)for(let t in s)for(let e in s[t].nodes)bE(s[t].nodes[e]);r&&t.getSeries().forEach(t=>{let e=t.getStackData(),i=t.getStackValue(),r=t.getStackValueField();e&&r&&bP(s[i],r)}),(null==(e=this._options)?void 0:e.afterStackRegion)&&this._options.afterStackRegion(t,s)},this._chart=t,this._options=e}init(){this._chart.getAllRegions().forEach(t=>{t.event.on(J.regionSeriesDataFilterOver,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},this.stackRegion)})}stackAll(){this._chart.getAllRegions().forEach(t=>{this.stackRegion({model:t})})}}class Ac{_beforeInit(){this._dataSet&&dL(this._dataSet,"stackSplit",Ad)}_initStack(){this._stack=new Au(this),this._stack.init()}}let Ap={state:td.STATE_DIMENSION_HOVER,reverseState:td.STATE_DIMENSION_HOVER_REVERSE,trigger:tq.dimensionHover};class Ag extends bn{constructor(t){super(t),this.type="dimension-hover",this._resetType=[],this.resetAll=()=>{let{state:t,reverseState:e,interaction:i}=this.options,r=i.getStatedGraphics(this);r&&r.length&&(i.clearAllStatesOfTrigger(this,t,e),this.dispatchEvent("reset",{graphics:r,options:this.options}),i.setStatedGraphics(this,[]))},this.handleStart=t=>{let e=this.options.interaction;switch(t.action){case"enter":let i=this.getStatedGraphics(t);e.updateStates(this,this.getStatedGraphics(t),e.getStatedGraphics(this),this.options.state,this.options.reverseState),e.setStatedGraphics(this,i);break;case"leave":e.clearAllStatesOfTrigger(this,this.options.state,this.options.reverseState),e.setStatedGraphics(this,[])}},this.options=Object.assign({},Ap,t),this.updateMarkIdByState([this.options.state,this.options.reverseState])}getStartState(){return this.options.state}getResetState(){return this.options.reverseState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart}]}getStatedGraphics(t,e=!1){let i=this.getMarksByState(e?this.options.reverseState:this.options.state),r=[];return t.dimensionInfo.forEach(t=>{t.data.forEach(t=>{i.filter(e=>e.model===t.series&&e.getVisible()).forEach(i=>{let n=i.getGraphics();if(!n||!n.length)return;let l=n.filter(i=>{let r,n=dM(i);return r=(0,rD.Z)(n)?n.every((e,i)=>e===t.datum[i]):t.datum.some(t=>t===n),e?!r:r});r.push(...l)})})}),r}}Ag.type="dimension-hover",Ag.defaultOptions=Ap;let Af=()=>{h9.registerInteractionTrigger(Ag.type,Ag)};class Am{constructor(t,e){this._eventDispatcher=t,this._mode=e}get chart(){var t,e;return this._chart||(this._chart=null==(e=(t=this._eventDispatcher.globalInstance).getChart)?void 0:e.call(t)),this._chart}register(t,e){var i,r;(null!=(r=null==(i=this.chart)?void 0:i.getOption().onError)?r:hH)("Method not implemented.")}unregister(){var t,e;(null!=(e=null==(t=this.chart)?void 0:t.getOption().onError)?e:hH)("Method not implemented.")}getTargetDimensionInfo(t,e){var i,r,n;let l=null!=(n=null==(r=(i=this.chart.getModelOption()).getDimensionInfo)?void 0:r.call(i,this.chart,{x:t,y:e}))?n:[];return 0===l.length?null:l}dispatch(t,e){var i,r;let n=null==(i=this.chart)?void 0:i.getAllComponents().filter(t=>"axes"===t.specKey&&(!(null==e?void 0:e.filter)||e.filter(t))),l=n.filter(t=>{let e=t.getScale();return(0,pW.lK)(e.type)}),s=l.length?l:n.filter(t=>{let e=t.getOrient();return CQ(e)||"angle"===e}),a=[],o=null==(r=this.chart)?void 0:r.getModelOption().getDimensionInfoByValue;return o&&s.forEach(e=>{let i=o(e,t);i&&a.push(i)}),this._callback.call(null,{action:"enter",dimensionInfo:a}),a}}let Ay=(t,e,i)=>t.x>=e.x&&t.x<=i.x&&t.y>=e.y&&t.y<=i.y,Av=(t,e,i)=>{let r=t.getRegionsInIds((0,a1.IX)(e.layout.layoutBindRegionID));return null==r?void 0:r.some(t=>{let e=t.getLayoutRect(),r=t.getLayoutStartPoint();return Ay(i,{x:r.x,y:r.y},{x:e.width+r.x,y:e.height+r.y})})},Ab=(t,e)=>{var i,r;return t===e||!(0,nB.Z)(t)&&!(0,nB.Z)(e)&&t.value===e.value&&(null==(i=t.axis)?void 0:i.id)===(null==(r=e.axis)?void 0:r.id)},A_=(t,e)=>{let i=t.tooltipFilterRange,r="function"==typeof i?i({scale:e}):i;return(0,hy.Z)(r)?[-r,r]:r},AC=(t,e,i,r)=>{var n;let l=e.getScale(),s=(0,pW.lK)(l.type),a=[];for(let o of e.getOption().getChart().getSeriesInIndex(e.getSpecInfo().seriesIndexes))if(o.coordinate===i){let i=(0,a1.IX)(r(o)),h=null==(n=o.getViewData())?void 0:n.latestData;if(i&&h)if(s){let e=[],r=[];h.forEach((n,l)=>{var s;(null==(s=n[i[0]])?void 0:s.toString())===(null==t?void 0:t.toString())&&(e.push(n),r.push(l))}),a.push({series:o,datum:e,key:Ax(o,r)})}else if((0,aw.Z)(i[1])){let e=[],r=[];h.forEach((n,l)=>{var s;((null==(s=n[i[0]])?void 0:s.toString())===(null==t?void 0:t.toString())||(0,aw.Z)(n[i[0]])&&(0,aw.Z)(n[i[1]])&&t>=n[i[0]]&&t<n[i[1]])&&(e.push(n),r.push(l))}),a.push({series:o,datum:e,key:Ax(o,r)})}else{let r=A_(e.getSpec(),l),n=[],s=[];if(r)h.forEach((e,l)=>{if((0,aw.Z)(e[i[0]])){let a=e[i[0]]-t;a>=r[0]&&a<=r[1]&&(n.push(e),s.push(l))}});else{let e=1/0,r=0;h.forEach((l,a)=>{if((0,aw.Z)(l[i[0]])){let o=Math.abs(l[i[0]]-t),h=Math.sign(l[i[0]]-t);o<e?(e=o,n=[l],s=[a],r=h):o===e&&h===r&&(n.push(l),s.push(a))}})}a.push({series:o,datum:n,key:Ax(o,s)})}}return a},Ax=(t,e)=>`${t.id}_${e.join("_")}`,Aw=(t,e,i)=>{let r=t.getAllComponents().filter(r=>"axes"===r.specKey&&e(r)&&Av(t,r,i));return r.length?r:null};class AS extends Am{constructor(){super(...arguments),this._cacheDimensionInfo=null,this.onMouseMove=t=>{var e,i,r,n;if(!t||(null==(n=null==(r=null==(i=null==(e=t.chart)?void 0:e.getOption())?void 0:i.globalInstance)?void 0:r.disableDimensionHoverEvent)?void 0:n.call(r)))return;let l=t.event.viewX,s=t.event.viewY,a=this.getTargetDimensionInfo(l,s);null===a&&null!==this._cacheDimensionInfo?(this._callback.call(null,Object.assign(Object.assign({},t),{action:"leave",dimensionInfo:this._cacheDimensionInfo.slice()})),this._cacheDimensionInfo=a):null!==a&&(null===this._cacheDimensionInfo||a.length!==this._cacheDimensionInfo.length||a.some((t,e)=>!Ab(t,this._cacheDimensionInfo[e])))?(this._callback.call(null,Object.assign(Object.assign({},t),{action:"enter",dimensionInfo:a.slice()})),this._cacheDimensionInfo=a):null!==a&&this._callback.call(null,Object.assign(Object.assign({},t),{action:"move",dimensionInfo:a.slice()}))},this.onMouseOut=t=>{var e,i,r,n;!t||(null==(n=null==(r=null==(i=null==(e=t.chart)?void 0:e.getOption())?void 0:i.globalInstance)?void 0:r.disableDimensionHoverEvent)?void 0:n.call(r))||(this._callback.call(null,Object.assign(Object.assign({},t),{action:"leave",dimensionInfo:this._cacheDimensionInfo?this._cacheDimensionInfo.slice():[]})),this._cacheDimensionInfo=null)}}register(t,e){this._callback=e.callback,this._eventDispatcher.register("pointermove",{query:Object.assign(Object.assign({},e.query),{source:Q.chart}),callback:this.onMouseMove}),this._eventDispatcher.register("pointerout",{query:Object.assign(Object.assign({},e.query),{source:Q.canvas}),callback:this.onMouseOut}),hE(this._mode)&&this._eventDispatcher.register("pointerdown",{query:Object.assign(Object.assign({},e.query),{source:Q.chart}),callback:this.onMouseMove})}unregister(){this._eventDispatcher.unregister("pointermove",{query:null,callback:this.onMouseMove}),hE(this._mode)&&this._eventDispatcher.unregister("pointerdown",{query:null,callback:this.onMouseMove})}}class AA extends Am{constructor(){super(...arguments),this.onClick=t=>{if(!t)return;let e=t.event.viewX,i=t.event.viewY,r=this.getTargetDimensionInfo(e,i);r&&this._callback.call(null,Object.assign(Object.assign({},t),{action:"click",dimensionInfo:r.slice()}))}}register(t,e){this._callback=e.callback,this._eventDispatcher.register("pointertap",{query:Object.assign(Object.assign({},e.query),{source:Q.chart}),callback:this.onClick})}unregister(){this._eventDispatcher.unregister("pointertap",{query:null,callback:this.onClick})}}let AM=()=>{h9.registerComposedEvent(tq.dimensionHover,AS),h9.registerComposedEvent(tq.dimensionClick,AA)},AT=t=>t.fieldX[0],Ak=t=>t.fieldY[0],AR=t=>{var e;return[t.fieldX[0],null!=(e=t.fieldX2)?e:t.fieldX[1]]},AP=t=>{var e;return[t.fieldY[0],null!=(e=t.fieldY2)?e:t.fieldY[1]]},AB=(t,e)=>t?e?AT:AR:e?Ak:AP,AI=(t,e,i)=>{var r,n;if(!t)return null;let{x:l,y:s}=e,a=null!=(r=Aw(t,t=>CQ(t.getOrient()),e))?r:[],o=null!=(n=Aw(t,t=>C0(t.getOrient()),e))?n:[];if(!a.length&&!o.length)return null;let h=new Set,d=new Set,u=new Set;[a,o].forEach(t=>t.forEach(t=>{(0,pW.lK)(t.getScale().type)?h.add(t):d.add(t),i&&t.getSpec().hasDimensionTooltip&&u.add(t)}));let c=[],p=t=>{let e="x"===t,i=e?l:s;(e?a:o).forEach(t=>{if(u.size>0){if(u.has(t)){let r=AE(t,i,AB(e,(0,pW.lK)(t.getScale().type)));r&&c.push(r)}}else{let r=h.size>0;if((r?h:d).has(t)){let n=AE(t,i,AB(e,r));n&&c.push(n)}}})};return"horizontal"===t.getSpec().direction?(p("y"),0===c.length&&p("x")):(p("x"),0===c.length&&p("y")),c.length?c:null},AE=(t,e,i)=>{let r=t.positionToData(e,!0);return(0,nB.Z)(r)?null:AL(t,r,i)},AL=(t,e,i)=>{let r=t.getScale();if((0,nB.Z)(e))return null;let n=r.domain().findIndex(t=>(null==t?void 0:t.toString())===e.toString());n<0&&(n=void 0);let l=AC(e,t,"cartesian",null!=i?i:CQ(t.getOrient())?AT:Ak);return{index:n,value:e,position:r.scale(e),axis:t,data:l}},AF=(t,e,i,r=!1)=>(i||(i={x:0,y:0}),Object.keys(t).forEach(n=>{var l,s,a,o,h,d;let u,{currentValue:c,cacheInfo:p,labelsComp:g,attributes:f,coordKey:m}=t[n],y=null,v=0,b=null;if(c.size){let t=Array.from(c.values())[0];v=t.axis.getScale().scale(t.datum)+t.axis.getLayoutStartPoint()[m]-i[m],b=null==(d=null==(h=null==(o=null==(a=null==(s=null==(l=(y=t.axis).getVRenderComponents()[0])?void 0:l.children[0])?void 0:s.children[0])?void 0:a.children[0])?void 0:o.getChildByName("axis-label-container"))?void 0:h.getChildByName("axis-label-container-layer-0"))?void 0:d.children[0]}let _=!!c.size&&Number.isFinite(v)&&!Number.isNaN(v),C=r&&!_&&(0,aw.Z)(p),x=C?p:{coordRange:[0,0],sizeRange:[0,0],coord:v,labelsTextStyle:{},labels:g?Object.keys(g).reduce((t,e)=>(t[e]={visible:!1,text:"",dx:0,dy:0},t),{}):null,visible:_,axis:y,axisLabel:b};x&&(x._isCache=C);let w=0;if(f&&c.forEach(({axis:t,datum:i=""})=>{var r,l,s,a,o,h,d,c,p,g;let m=null,y=t.getScale();if((0,pW.lK)(y.type))0===(u=y.bandwidth())&&y.step&&(w=y.step());else if((0,pW.z2)(y.type)){let r="xField"===n?e.fieldX[0]:e.fieldY[0],l="xField"===n?e.fieldX2:e.fieldY2,s=function(t,e,i,r){for(let n=0,l=t.length;n<l;n++){let l=t[n];if(l){let t=l[i],n=l[r||i];if(t<=e&&n>=e)return l}}return null}(e.getViewData().latestData,+i,r,l);if(s){let t="xField"===n?e.dataToPositionX(s):e.dataToPositionY(s);l?(u=Math.abs(t-("xField"===n?e.dataToPositionX1(s):e.dataToPositionY1(s))),i=`${s[r]} ~ ${s[l]}`):u=1,v=t}m=t.niceLabelFormatter}if(x&&(null==(r=f.label)?void 0:r.visible)&&!C){let e=xm(t.getSpec()),r=t.getOrient(),n=null==(l=f.label)?void 0:l.syncAxisLabelAngle;x.labels[r]&&(x.labels[r].visible=!0,x.labels[r].text=i,"left"===r?(x.labels[r].dx=-e,x.labelsTextStyle[r]={textAlign:n&&b&&null!=(s=b.attribute.textAlign)?s:"right",textBaseline:n&&b&&null!=(a=b.attribute.textBaseline)?a:"middle"}):"right"===r?(x.labels[r].dx=e,x.labelsTextStyle[r]={textAlign:n&&b&&null!=(o=b.attribute.textAlign)?o:"left",textBaseline:n&&b&&null!=(h=b.attribute.textBaseline)?h:"middle"}):"top"===r?(x.labels[r].y=0,x.labels[r].dy=-e,x.labelsTextStyle[r]={textAlign:n&&b&&null!=(d=b.attribute.textAlign)?d:"center",textBaseline:n&&b&&null!=(c=b.attribute.textBaseline)?c:"bottom"}):"bottom"===r&&(x.labels[r].dy=e,x.labelsTextStyle[r]={textAlign:n&&b&&null!=(p=b.attribute.textAlign)?p:"center",textBaseline:n&&b&&null!=(g=b.attribute.textBaseline)?g:"top"}),x.labels[r].defaultFormatter=m)}}),x&&!C){let t={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};AH(t,c),"xField"===n?(x.coordRange=[t.x1,t.x2],x.sizeRange=[t.y1,t.y2],x.coord=v+i.x,x.labels&&(x.labels.top.y=t.y1,x.labels.bottom.y=t.y2)):(x.coordRange=[t.y1,t.y2],x.sizeRange=[t.x1,t.x2],x.coord=v+i.y,x.labels&&(x.labels.left.x=t.x1,x.labels.right.x=t.x2)),(x.coord<x.coordRange[0]||x.coord>x.coordRange[1])&&(x.visible=!1),f&&f.label&&Object.keys(x.labels).forEach(t=>{x.labels[t].visible&&AO(x.labels[t],t,f.label)})}t[n].bandSize=null!=u?u:0,t[n].offsetSize=w,t[n].cacheInfo=x}),t),AO=(t,e,i)=>{let{formatMethod:r,formatter:n}=i,{formatFunc:l,args:s}=bz(r,n,t.text,{label:t.text,position:e});l?t.text=l(...s):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))},AH=(t,e)=>{e.forEach(({axis:e})=>{e.getRegions().forEach(e=>{let{x:i,y:r}=e.getLayoutStartPoint(),{width:n,height:l}=e.getLayoutRect();t.x1=Math.min(t.x1,i),t.y1=Math.min(t.y1,r),t.x2=Math.max(t.x2,i+n),t.y2=Math.max(t.y2,r+l)})})},AD=t=>{let e,{cacheInfo:i,attributes:r,bandSize:n,offsetSize:l,coordKey:s,anotherAxisKey:a}=t,{coord:o,sizeRange:h}=i,d=r.type;if("line"===d){let t=o+n/2;e={visible:!0,start:{[s]:t,[a]:h[0]},end:{[s]:t,[a]:h[1]}}}else if("rect"===d){let[t,d]=Az(r,n,l,i.axis),{coordRange:u}=i;e={visible:!0,start:{[s]:Math.max(o+t,u[0]),[a]:h[0]},end:{[s]:Math.min(o+d,u[1]),[a]:h[1]}}}return e},Az=(t,e,i,r)=>{var n,l,s;let a=0===e?i:e,o=a;if(null==(n=t.style)?void 0:n.sizePercent)o=a*t.style.sizePercent;else if("number"==typeof(null==(l=t.style)?void 0:l.size))o=t.style.size;else if("function"==typeof(null==(s=t.style)?void 0:s.size)){let e=r.getLayoutRect();o=t.style.size(e,r)}return 0===e?[-o/2,o/2]:[e/2-o/2,o/2+e/2]},AW=(t,e)=>{var i;let r=new Map,n=new Map,{series:l,datum:s}=t,a="horizontal"===l.direction,o=(a?l.getYAxisHelper():l.getXAxisHelper()).getAxisId(),h=l.getChart().getComponentsByKey("axes").find(t=>t.id===o);if(!h)return;(a?n:r).set(h.getSpecIndex(),{datum:null==(i=l.getDatumPositionValues(s[0],l.getDimensionField()))?void 0:i[0],axis:h});let d={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:r,attributes:{visible:!!r.size,type:"rect"}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:n,attributes:{visible:!!n.size,type:"rect"}}};return AF(d,l,e),d.xField.cacheInfo?AD(d.xField):d.yField.cacheInfo?AD(d.yField):void 0},AZ=["updateTitle","updateContent","updatePosition","maxLineCount","othersLine"],AN=(t,e,i,r,n)=>{var l,s,a;let o={activeType:t};switch(t){case"mark":case"group":if(i){let a=null==(l=i.getSpec())?void 0:l.tooltip;return o.visible=!0,(null==a?void 0:a.handler)&&(o.handler=a.handler),(null==(s=o.handler)?void 0:s.showTooltip)?o:((null==a?void 0:a[t])&&AZ.forEach(e=>{(0,aw.Z)(a[t][e])&&(o[e]=a[t][e])}),Object.assign(Object.assign({},o),i.tooltipHelper.getTooltipData(t,e,r,r[0].datum,n)))}break;case"dimension":if(null==r?void 0:r.length){if(Aj(r).every(t=>{var e;return!bV("dimension",null==(e=t.tooltipHelper)?void 0:e.spec)})?o.visible=!1:o.visible=!0,o.handler=e.handler,null==(a=o.handler)?void 0:a.showTooltip)return o;let i=[];return r.forEach(l=>l.data.forEach(l=>{let{series:s}=l,a=s.tooltipHelper.getTooltipData(t,e,r,l.datum,n);a&&i.push(a)})),function(t){if(!t||!t.length)return null;let e=[];return t.forEach(({content:t})=>{t&&t.forEach(t=>{e.push(t)})}),e.length?Object.assign(Object.assign({},t[0]),{content:e}):t[0]}(i)}}return null},Aj=t=>{let e=[];return t.forEach(t=>{t.data.forEach(t=>{(0,aw.Z)(t.series)&&e.push(t.series)})}),e},AG={dom:`${d9}_TOOLTIP_HANDLER_DOM`,canvas:`${d9}_TOOLTIP_HANDLER_CANVAS`},AV={key:"其他",value:"..."};(tj=t2||(t2={})).group="group",tj.mark="mark",tj.dimension="dimension";class AU{constructor(t){this._showTooltipByHandler=(t,e)=>{var i,r,n;let l;if((0,nB.Z)(t))return 1;e.changePositionOnly||this.clearCache(),this._updateViewSpec(t,e);let s=this._cacheActiveSpec;if((0,nB.Z)(s)||!1===s.visible)return 1;e.tooltipSpec=this.component.getSpec(),e.activeTooltipSpec=s;let{title:a,content:o}=s,h=(0,nB.Z)(null==a?void 0:a.key)&&(0,nB.Z)(null==a?void 0:a.value)&&!(null==o?void 0:o.length);return(this.component.event.emit(J.tooltipShow,Object.assign(Object.assign({},e),{isEmptyTooltip:h,tooltipData:t,activeType:this.activeType,tooltip:this.component})),h)?1:((null==(i=s.handler)?void 0:i.showTooltip)?l=s.handler.showTooltip.bind(s.handler):(null==(r=this.component.tooltipHandler)?void 0:r.showTooltip)&&(l=this.component.tooltipHandler.showTooltip.bind(this.component.tooltipHandler)),l?null!=(n=l(this.activeType,t,e))?n:0:1)},this.component=t}_preprocessDimensionInfo(t){let e=[];if(null==t||t.forEach(t=>{let i=Object.assign(Object.assign({},t),{data:t.data.filter(({series:t})=>{var e,i;return!1!==(null==(i=null==(e=t.getSpec())?void 0:e.tooltip)?void 0:i.visible)})});i.data.length>0&&e.push(i)}),e.length>0)return e}_updateViewSpec(t,e){var i,r,n,l,s,a,o,h,d;let{changePositionOnly:u,model:c}=e;if(!u||!this._cacheActiveSpec){let u=this.component.getSpec();if(this._cacheActiveSpec=AN(this.activeType,this.component.getSpec(),c,t,e),this._cacheActiveSpec){(0,nB.Z)(this._cacheActiveSpec.handler)&&(0,aw.Z)(u.handler)&&(this._cacheActiveSpec.handler=u.handler);let c=null!=(i=u[this.activeType])?i:{},p=null!=(r=this._cacheActiveSpec.updateTitle)?r:c.updateTitle,g=null!=(n=this._cacheActiveSpec.updateContent)?n:c.updateContent,f=null!=(s=null!=(l=this._cacheActiveSpec.maxLineCount)?l:c.maxLineCount)?s:20;if(p&&(this._cacheActiveSpec.title=null!=(a=p(this._cacheActiveSpec.title,t,e))?a:this._cacheActiveSpec.title),g)this._cacheActiveSpec.content=null!=(o=g(this._cacheActiveSpec.content,t,e))?o:this._cacheActiveSpec.content;else if(f>=1&&(null==(h=this._cacheActiveSpec.content)?void 0:h.length)>f){let t=null!=(d=this._cacheActiveSpec.othersLine)?d:c.othersLine,e=t?Object.assign(Object.assign({},AV),t):AV;this._cacheActiveSpec.content=[...this._cacheActiveSpec.content.slice(0,f-1),Object.assign(Object.assign({},this._cacheActiveSpec.content[f-1]),e)]}}}}shouldHandleTooltip(t,e){var i,r;return!!this.component.enable&&!(0,nB.Z)(e)&&bV(this.activeType,null==(r=null==(i=t.model)?void 0:i.tooltipHelper)?void 0:r.spec)}clearCache(){this._cacheActiveSpec=void 0}}class AK extends AU{constructor(){super(...arguments),this.activeType="dimension"}showTooltip(t,e,i){let r=Object.assign(Object.assign({},e),{dimensionInfo:this._preprocessDimensionInfo(t),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(t,r)}_getDimensionInfo(t){var e,i,r;let n,l=this.component.getChart(),s=l.getCompiler().getStage().getLayer(void 0),a={x:t.event.viewX,y:t.event.viewY};if(s.globalTransMatrix.transformPoint({x:t.event.viewX,y:t.event.viewY},a),0===(n=null!=(r=null==(i=(e=this.component.getOption()).getDimensionInfo)?void 0:i.call(e,l,a,!0))?r:[]).length)n=void 0;else if(n.length>1){let t=n.filter(t=>{var e;let i,r=t.axis;if(r.getSpec().hasDimensionTooltip)return!0;if(!(0,pW.lK)(r.getScale().type))return!1;for(let t of null!=(e=null==r?void 0:r.getRegions())?e:[]){for(let e of t.getSeries())if("cartesian"===e.coordinate){i=e;break}if((0,aw.Z)(i))break}return(0,aw.Z)(i)&&i.getDimensionField()[0]===i.fieldY[0]?"left"===r.getOrient()||"right"===r.getOrient():"bottom"===r.getOrient()||"top"===r.getOrient()});if((n=t.length?t:n.slice(0,1)).length>1){let t=new Set;n.forEach(e=>{e.data=e.data.filter(({key:e})=>!t.has(e)&&(t.add(e),!0))})}}return n}getMouseEventData(t){return{tooltipInfo:this._getDimensionInfo(t),ignore:!1}}}let AX=()=>{h9.registerTooltipProcessor("dimension",AK)};class AY extends AU{constructor(){super(...arguments),this.activeType="mark"}showTooltip(t,e,i){var r,n,l;let{datum:s,series:a}=t,o=this.component.getSpec(),h=[{datum:[s],series:a}],d=a.tooltipHelper,u=null==(r=a.getSpec())?void 0:r.tooltip,c=null==(n=null==u?void 0:u.mark)?void 0:n.checkOverlap,p=!1;if(!0===c||!0===(null==(l=o.mark)?void 0:l.checkOverlap)&&!1!==c){let t=null==d?void 0:d.activeTriggerSet.mark;if(t){p=!0;let i=this.component.getChart().getCompiler().getStage().getLayer(void 0),r={x:e.event.viewX,y:e.event.viewY};i.globalTransMatrix.transformPoint({x:e.event.viewX,y:e.event.viewY},r),t.forEach(t=>{t.getGraphics().forEach(t=>{t!==e.node&&t&&t.containsPoint(r.x,r.y,o2.GLOBAL,t.stage.getPickerService())&&h[0].datum.push(dM(t))})})}}let g=Object.assign(Object.assign({},e),{model:a,changePositionOnly:i,tooltip:this.component});if(i&&p){let t=this._cacheActiveSpec&&this._cacheActiveSpec.data;t&&t[0].series===h[0].series&&t[0].datum.length===h[0].datum.length&&!t[0].datum.some((t,e)=>t!==h[0].datum[e])||(g.changePositionOnly=!1)}return this._showTooltipByHandler(h,g)}getMouseEventData(t){var e;let i,r,n=null==(e=t.model)?void 0:e.modelType;if("series"===n){let e=t.model,n=e.tooltipHelper,l=null==n?void 0:n.activeTriggerSet.mark,s=null==n?void 0:n.ignoreTriggerSet.mark;(null==l?void 0:l.has(t.mark))?i={mark:t.mark,datum:t.datum,series:e}:(null==s?void 0:s.has(t.mark))&&(r=!0)}else if("component"===n){let e=t.model,n=t.node;if("label"===e.name&&n){let t=e.getLabelInfoByTextGraphic(n),{baseMark:l,series:s,labelMark:a}=null!=t?t:{},o=s.tooltipHelper,h=null==o?void 0:o.activeTriggerSet.mark,d=null==o?void 0:o.ignoreTriggerSet.mark;(null==h?void 0:h.has(a))?i={mark:l,datum:n.attribute.data,series:s}:(null==d?void 0:d.has(a))&&(r=!0)}}return{tooltipInfo:i,ignore:r}}}let A$=()=>{h9.registerTooltipProcessor("mark",AY)};class Aq extends AU{constructor(){super(...arguments),this.activeType="group"}showTooltip(t,e,i){let{datum:r,series:n}=t,l=[{datum:(0,a1.IX)(r),series:n}],s=Object.assign(Object.assign({},e),{groupDatum:this._getGroupDatum(e),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(l,s)}getMouseEventData(t){var e,i;let r;if("series"===(null==(e=t.model)?void 0:e.modelType)){let e=t.model,n=e.tooltipHelper,l=null==n?void 0:n.activeTriggerSet.group;if(null==l?void 0:l.has(t.mark)){let n=this.component.getSpec()[this.activeType];((null==n?void 0:n.triggerMark)?(0,a1.IX)(n.triggerMark):[]).includes(null==(i=t.mark)?void 0:i.name)&&(r={mark:t.mark,datum:t.datum,series:e})}}return{tooltipInfo:r,ignore:!1}}_getGroupDatum(t){let{model:e,mark:i,datum:r}=t;if(["line","area"].includes(i.type))return(0,a1.IX)(r);let n=e.getViewData().latestData,l=e.getSeriesField();if(!l)return n;let s=(0,a1.IX)(r)[0][l];return n.filter(t=>t[l]===s)}}let AJ=()=>{h9.registerTooltipProcessor("group",Aq)};class AQ extends Ah{constructor(){super(...arguments),this.transformerConstructor=An,this.type="line",this.seriesType=Y.line}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}AQ.type="line",AQ.seriesType=Y.line,AQ.transformerConstructor=An,(0,yf.jB)(AQ,Ac);let A0=()=>{AX(),A$(),AJ(),AM(),Af(),S9(),h9.registerChart(AQ.type,AQ)},A1=["segments","points","curveType","curveTension",...sO];class A2 extends sN{constructor(t){super(t),this.type="area",this.numberType=sr}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;let{points:t,segments:e}=this.attribute;return e?0!==e.length:!!t&&0!==t.length}getGraphicTheme(){return nP(this).area}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateAreaAABBBoundsBySegments(t,e,i):this.updateAreaAABBBoundsByPoints(t,e,i)),iC.graphicService.updateTempAABBBounds(i),this.setWidthHeightWithoutTransform(i);let{lineJoin:r=e.lineJoin}=t;return iC.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}updateAreaAABBBoundsByPoints(t,e,i,r){let{points:n=e.points}=t;return n.forEach(t=>{var e,r;i.add(t.x,t.y),i.add(null!=(e=t.x1)?e:t.x,null!=(r=t.y1)?r:t.y)}),i}updateAreaAABBBoundsBySegments(t,e,i,r){let{segments:n=e.segments}=t;return n.forEach(t=>{t.points.forEach(t=>{var e,r;i.add(t.x,t.y),i.add(null!=(e=t.x1)?e:t.x,null!=(r=t.y1)?r:t.y)})}),i}_interpolate(t,e,i,r,n){"points"===t&&(n.points=nQ(i,r,e))}needUpdateTags(t){return super.needUpdateTags(t,A1)}needUpdateTag(t){return super.needUpdateTag(t,A1)}toCustomPath(){let t=super.toCustomPath();if(t)return t;t=new rp;let e=this.attribute,i=e.segments,r=e=>{if(e&&e.length){let i=!0,r=[];if(e.forEach(e=>{var n,l;!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),r.push({x:null!=(n=e.x1)?n:e.x,y:null!=(l=e.y1)?l:e.y}),i=!1)}),r.length){for(let e=r.length-1;e>=0;e--)t.lineTo(r[e].x,r[e].y);t.closePath()}}};return e.points?r(e.points):i&&i.length&&i.forEach(t=>{r(t.points)}),t}clone(){return new A2(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return A2.NOWORK_ANIMATE_ATTR}}function A3(t){return new A2(t)}A2.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},sZ);let A5=!1,A4=new eQ(t=>{A5||(A5=!0,t(oH).toSelf().inSingletonScope(),t(s3).to(oH).inSingletonScope(),t(s4).toService(s3),t(oi).toService(of),il(t,oi),t(oD).toSelf().inSingletonScope())}),A6=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="area",this.numberType=sr}};A6=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tG=it(s3),function(t,e){tG(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],A6);let A7=!1,A8=new eQ((t,e,i,r)=>{A7||(A7=!0,t(ce).to(A6).inSingletonScope(),t(cf).toService(ce))});function A9(){A9.__loaded||(A9.__loaded=!0,ak.RegisterGraphicCreator("area",A3),ib.load(A4),ib.load(u$?A8:fW))}A9.__loaded=!1;let Mt=[..._k,"fill","fillOpacity","background","texture","texturePadding","textureSize","textureColor"];class Me extends _R{constructor(){super(...arguments),this.type=Me.type,this._isValidPointChannel=t=>["x","y","x1","y1","defined"].includes(t)}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}_getSegmentAttributes(){return Mt}_getIgnoreAttributes(){return[]}}Me.type="area";let Mi=()=>{h9.registerMark(Me.type,Me),gG(),A9(),CW(),Cj(),v3(),h9.registerGraphicComponent("area",A3)};class Mr extends bY{constructor(){super(...arguments),this._getSeriesStyle=(t,e,i)=>{var r,n,l,s;for(let i of(0,a1.IX)(e)){let e=null==(r=this.series.getSeriesStyle(t))?void 0:r(i);if(!1!==e||"fill"!==i&&"stroke"!==i||(e="fill"===i?null==(l=null==(n=this.series.getSeriesStyle(t))?void 0:n("stroke"))?void 0:l[0]:null==(s=this.series.getSeriesStyle(t))?void 0:s("fill")),(0,aw.Z)(e))return e}return i}}}let Mn=Object.assign(Object.assign(Object.assign({},b7),_C),{area:{name:"area",type:"area"}}),Ml=()=>{vQ(),vJ(),vX()};class Ms extends CX{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){var e,i,r;let n=!1!==(null==(e=t.point)?void 0:e.visible)&&!1!==(null==(r=null==(i=t.point)?void 0:i.style)?void 0:r.visible);this._addMarkLabelSpec(t,t=>{let e="inside-middle"===t.position;return!n||e?"area":"point"}),this._addMarkLabelSpec(t,"area","areaLabel","initLineLabelMarkStyle",void 0,!0)}_transformSpecAfterMergingTheme(t,e,i){var r,n,l,s,a;super._transformSpecAfterMergingTheme(t,e,i);let{area:o={},line:h={},seriesMark:d}=t,u=!1!==o.visible&&!1!==(null==(r=o.style)?void 0:r.visible),c=!1!==h.visible&&!1!==(null==(n=h.style)?void 0:n.visible);o.support3d=!(!o.support3d&&!h.support3d),o.zIndex=(0,aw.Z)(o.zIndex)||(0,aw.Z)(h.zIndex)?Math.max(null!=(l=o.zIndex)?l:0,null!=(s=h.zIndex)?s:0):void 0,o.style&&delete o.style.stroke,o.state&&Object.keys(o.state).forEach(t=>{"style"in o.state[t]?delete o.state[t].style.stroke:delete o.state[t].stroke});let p=o,g=h;("line"===d||c&&!u)&&(p=h,g=o),o.style=h5({},g.style,p.style),o.state=h5({},g.state,p.state),!1===o.interactive&&(o.style.fillPickable=!1),!1===h.interactive&&(h.style.strokePickable=!1),o.interactive=!(!o.interactive&&null!=(a=h.interactive)&&!a),t.area=o,t.line=h}}class Ma extends _y{constructor(){super(...arguments),this.type=Y.area,this.transformerConstructor=Ms,this._sortDataByAxis=!1}initMark(){var t;let e=null!=(t=this._spec.seriesMark)?t:"area",i=this._isAreaVisible()||this._isLineVisible();this._areaMark=this._createMark(Ma.mark.area,{groupKey:this._seriesField,isSeriesMark:i&&"point"!==e},{morphElementKey:this.getDimensionField()[0]}),this.initSymbolMark("point"===e)}initMarkStyle(){this.initAreaMarkStyle(),this.initSymbolMarkStyle()}initAreaMarkStyle(){var t,e,i,r,n;let l=null!=(i=null==(e=null==(t=this.getSpec().area)?void 0:t.style)?void 0:e.curveType)?i:null==(n=null==(r=this.getSpec().line)?void 0:r.style)?void 0:n.curveType,s=l===_v?"horizontal"===this._direction?"monotoneY":"monotoneX":l,a=this._areaMark;if(a){let t=this._isAreaVisible(),e=this._isLineVisible();t||e?a.setVisible(!0):a.setVisible(!1),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:t=>{var e,i;return pF(this.dataToPositionX1(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),y1:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,orient:this._direction},"normal",to.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:this.dataToPositionX.bind(this),y1:t=>{var e,i;return pF(this.dataToPositionY1(t),null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",to.Series),this.setMarkStyle(a,{fill:!!t&&this.getColorAttribute(),stroke:!!e&&this.getColorAttribute()},"normal",to.Series),"zero"!==this._invalidType&&this.setMarkStyle(a,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",to.Series),this.getStack()&&this.setMarkStyle(a,{zIndex:t=>-t[uh]},"normal",to.Series),this.setMarkStyle(a,{curveType:s},"normal",to.Built_In),Object.keys(a.stateStyle).forEach(t=>{a.stateStyle[t].stroke&&a.setPostProcess("stroke",t=>[t,!1,!1,!1],t)})}}initAnimation(){var t,e,i,r;let n={direction:this.direction},l=null==(t=this._spec.animationAppear)?void 0:t.preset;if(this._lineMark&&this._lineMark.setAnimationConfig(_l(null==(e=h9.getAnimationInKey("line"))?void 0:e(n,l),_s("line",this._spec,this._markAttributeContext))),this._areaMark&&this._areaMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("area"))?void 0:i(n,l),_s("area",this._spec,this._markAttributeContext))),this._symbolMark){let t=_m(this);this._symbolMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("scaleInOut"))?void 0:r(),_s("point",this._spec,this._markAttributeContext),t))}}_isAreaVisible(){var t;let e=this._spec.area||{};return!1!==e.visible&&!1!==(null==(t=e.style)?void 0:t.visible)}_isLineVisible(){var t;let e=this._spec.line||{};return!1!==e.visible&&!1!==(null==(t=e.style)?void 0:t.visible)}initTooltip(){this._tooltipHelper=new Mr(this);let{group:t,mark:e}=this._tooltipHelper.activeTriggerSet;this._areaMark&&t.add(this._areaMark),this._lineMark&&t.add(this._lineMark),this._symbolMark&&(e.add(this._symbolMark),t.add(this._symbolMark))}viewDataStatisticsUpdate(t){super.viewDataStatisticsUpdate(t),this.encodeDefined(this._areaMark,"defined")}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}onLayoutEnd(){super.onLayoutEnd(),this.reCompileSampling()}getSeriesStyle(t){return e=>{var i,r,n,l,s;let a=null!=(i=this._spec.seriesMark)?i:"area",o=null!=(n=null==(r=this._seriesMark)?void 0:r.getAttribute(e,t))?n:void 0;return"fill"!==e||o&&"line"!==a||(e="stroke",o=null!=(s=null==(l=this._seriesMark)?void 0:l.getAttribute(e,t))?s:void 0),"stroke"===e&&(0,rD.Z)(o)?o[0]:o}}}Ma.type=Y.area,Ma.builtInTheme={area:{label:{visible:!1,offset:5,position:"top",style:{stroke:{type:"palette",key:"backgroundColor"},lineWidth:2}},point:{style:{symbolType:"circle"}},seriesMark:"area"}},Ma.mark=Mn,Ma.transformerConstructor=Ms,(0,yf.jB)(Ma,_x);let Mo=()=>{S7(),SJ(),CV(),Mi(),CK(),Ml(),SI(),SX(),h9.registerSeries(Ma.type,Ma)};class Mh extends Ar{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["point","line","area","seriesMark","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","areaLabel","useSequentialAnimation"])}transformSpec(t){super.transformSpec(t),c8(t)}}class Md extends Ah{constructor(){super(...arguments),this.transformerConstructor=Mh,this.type="area",this.seriesType=Y.area}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}Md.type="area",Md.seriesType=Y.area,Md.transformerConstructor=Mh,(0,yf.jB)(Md,Ac);let Mu=()=>{AX(),A$(),AJ(),Af(),Mo(),AM(),h9.registerChart(Md.type,Md)};function Mc(t,e=!0){return(i,r,n)=>{let l="vertical"===t.direction?t.yField:t.xField,s=null==i?void 0:i[l];return"vertical"===t.direction?{overall:e?t.growFrom():e,orient:s>0?"negative":"positive"}:{overall:!!e&&t.growFrom(),orient:s>0?"positive":"negative"}}}let Mp=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:Mc(t,e)}),Mg=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:Mc(t,e)}),Mf={type:"fadeIn"},Mm={type:"growCenterIn"};function My(t,e){if(!1===e)return{};switch(e){case"fadeIn":return Mf;case"scaleIn":return Mm;default:return Mp(t)}}let Mv=()=>{h9.registerAnimation("bar",(t,e)=>({appear:My(t,e),enter:Mp(t,!1),exit:Mg(t,!1),disappear:{duration:vV.disappear.duration}}))};var Mb=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class M_ extends CL{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,h3.Z)({},M_.defaultAttributes,Mb(t,["data"]))))}labeling(t,e,i="top",r=0){if(!t||!e)return;let{x1:n,y1:l,x2:s,y2:a}=t,o=Math.abs(s-n),h=Math.abs(a-l),{x:d,y:u}=(0,yd.v1)(e,i),c=0,p=0,g=i.includes("inside");switch(i.includes("top")?p=g?1:-1:i.includes("bottom")?p=g?-1:1:i.includes("left")?c=g?1:-1:i.includes("right")&&(c=g?-1:1),i){case"top-right":case"bottom-right":c=-1;break;case"top-left":case"bottom-left":c=1}return{x:d+c*r+c*o/2,y:u+p*r+p*h/2}}}M_.tag="rect-label",M_.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};let MC=()=>{CO("rect",M_)};class Mx extends gW{constructor(){super(...arguments),this.type=Mx.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}Mx.type="rect";let Mw=()=>{gG(),c7(),MC(),h9.registerMark(Mx.type,Mx),v1(),h9.registerGraphicComponent("rect",cN)},MS=Object.assign(Object.assign({},b7),{bar:{name:"bar",type:"rect"},barBackground:{name:"barBackground",type:"rect"}});function MA(t,e,i,r,n,l){let s=i.getSpec().barMinHeight,a=i[r.axisHelper].isInverse(),o=pF(i[r.startMethod](t),n),h=pF(i[r.endMethod](t),n);l&&(e=o);let d=Math.abs(o-h);d<=0&&!pO(t[i.getStackValueField()],n)?d=0:d<s&&(d=s);let u=1;return h<o?u=-1:h===o&&(u=r.isVertical?a?1:-1:a?-1:1),h=e+u*d,t[r.start]=e,t[r.end]=h,h}class MM extends _c{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){this._addMarkLabelSpec(t,"bar")}}class MT extends _y{constructor(){super(...arguments),this.type=Y.bar,this._barMarkName="bar",this._barMarkType="rect",this.transformerConstructor=MM,this._bandPosition=0,this._getLinearBarRange=(t,e)=>{let[i,r]=[t,e].sort((t,e)=>t-e),n=r-i;if(this._spec.barGap){let t=.5*this._spec.barGap;i+=t,r-=t}let l=r-i,s=hk(this._spec.barMinWidth||2,n);if(l<s){let t=(s-l)/2;i-=t,r+=t}return[i,r]},this._getBarXStart=(t,e,i)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),t[b8]):this._spec.barMinHeight?this._calculateRectPosition(t,!1,i):pF(this._dataToPosX(t),e,i),this._getBarXEnd=(t,e,i)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),t[b9]):pF(this._dataToPosX1(t),e,i),this._getLinearBarXRange=(t,e,i)=>{let r=pF(this._dataToPosX(t),e,i),n=pF(this._dataToPosX1(t),e,i);return this._getLinearBarRange(r,n)},this._getBarYStart=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),t[_t]):this._spec.barMinHeight?this._calculateRectPosition(t,!0):pF(this._dataToPosY(t),e),this._getBarYEnd=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),t[_e]):pF(this._dataToPosY1(t),e),this._getLinearBarYRange=(t,e,i)=>{let r=pF(this._dataToPosY(t),e,i),n=pF(this._dataToPosY1(t),e,i);return this._getLinearBarRange(r,n)},this._getBarBackgroundXStart=t=>{let e=t.range();return Math.min(e[0],e[e.length-1])},this._getBarBackgroundXEnd=t=>{let e=t.range();return Math.max(e[0],e[e.length-1])},this._getBarBackgroundYStart=t=>{let e=t.range();return Math.min(e[0],e[e.length-1])},this._getBarBackgroundYEnd=t=>{let e=t.range();return Math.max(e[0],e[e.length-1])},this._getBarBackgroundPositionXEncoder=()=>{var t;return null==(t=this._barBackgroundPositionXEncoder)?void 0:t.bind(this)},this._setBarBackgroundPositionXEncoder=t=>{this._barBackgroundPositionXEncoder=t.bind(this)},this._getBarBackgroundPositionYEncoder=()=>{var t;return null==(t=this._barBackgroundPositionYEncoder)?void 0:t.bind(this)},this._setBarBackgroundPositionYEncoder=t=>{this._barBackgroundPositionYEncoder=t.bind(this)}}initMark(){this._initBarBackgroundMark(),this._barMark=this._createMark(Object.assign(Object.assign({},MT.mark.bar),{name:this._barMarkName,type:this._barMarkType}),{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0],morph:_h(this._spec,this._barMarkName)})}_initBarBackgroundMark(){this._spec.barBackground&&this._spec.barBackground.visible&&(this._barBackgroundMark=this._createMark(MT.mark.barBackground,{dataView:this._barBackgroundViewData.getDataView(),dataProductId:this._barBackgroundViewData.getProductId()}))}initMarkStyle(){this._barMark&&this.setMarkStyle(this._barMark,{fill:this.getColorAttribute()},"normal",to.Series)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null})}initTooltip(){super.initTooltip();let{mark:t,group:e}=this._tooltipHelper.activeTriggerSet;this._barMark&&(t.add(this._barMark),e.add(this._barMark))}_statisticViewData(){var t,e;let i;super._statisticViewData();let r=null!=(t=this._spec.barBackground)?t:{};if(!r.visible)return;let n=this._getRelatedComponentSpecInfo("axes").some(t=>t.type===oQ.cartesianBandAxis);if(dL(this._option.dataSet,"addVChartProperty",bO),n)dL(this._option.dataSet,"dimensionItems",([t],{scaleDepth:e})=>{var i,r;let n=[{}],l=this.getDimensionField(),s=(0,nB.Z)(e)?l.length:Math.min(l.length,e);for(let e=0;e<s;e++){let s=l[e],a=null==(i=t.latestData[s])?void 0:i.values;if(!(null==a?void 0:a.length))continue;let o=[],h=null!=(r=this._spec.dataKey)?r:un;for(let t=0;t<a.length;t++)for(let e=0;e<n.length;e++)o.push(Object.assign(Object.assign({},n[e]),{[s]:a[t],[h]:a[t]}));n=o}return n}),i=new eq.V(this._option.dataSet).parse([this._viewDataStatistics],{type:"dataview"}).transform({type:"dimensionItems",options:{scaleDepth:(0,nB.Z)(r.fieldLevel)?void 0:r.fieldLevel+1}},!1).transform({type:"addVChartProperty",options:{beforeCall:b3.bind(this),call:b5}},!1),null==(e=this._viewDataStatistics)||e.target.addListener("change",i.reRunAllTransform);else{dL(this._option.dataSet,"dimensionItems",([e])=>{let i=[],[r,n]=this.getDimensionContinuousField(),l={};return t.latestData.forEach(t=>{let e=`${t[r]}-${t[n]}`;l[e]||(l[e]={[r]:t[r],[n]:t[n]},i.push(l[e]))}),i});let t=this.getViewData();i=new eq.V(this._option.dataSet).parse([t],{type:"dataview"}).transform({type:"dimensionItems"},!1).transform({type:"addVChartProperty",options:{beforeCall:b3.bind(this),call:b5}},!1),null==t||t.target.addListener("change",i.reRunAllTransform)}this._barBackgroundViewData=new pV(this._option,i)}init(t){var e,i;super.init(t),"vertical"===this.direction?"band"===(null==(e=this._xAxisHelper)?void 0:e.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle():"band"===(null==(i=this._yAxisHelper)?void 0:i.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle()}_shouldDoPreCalculate(){let t=this.getRegion();return this.getStack()&&t.getSeries().filter(t=>t.type===this.type&&t.getSpec().barMinHeight).length}_calculateStackRectPosition(t){let e,i,r,n,l,s=this.getRegion();if(s._bar_series_position_calculated)return;s._bar_series_position_calculated=!0,t?(e=_e,i=_t,r="_dataToPosY1",n="_dataToPosY",l="_yAxisHelper"):(e=b9,i=b8,r="_dataToPosX1",n="_dataToPosX",l="_xAxisHelper");let a=bk(s,!1,t=>t.type===this.type);for(let o in a)for(let h in a[o].nodes)!function t(e,i,r){var n,l;if(e.values.length>0){let t;if(e.sortDatums.length){let s=e.sortDatums;i&&(s=e.sortDatums.slice().reverse());for(let e=0;e<s.length;e++)t=MA(s[e].datum,t,s[e].series,r,null==(l=(n=s[e].series[r.axisHelper]).getScale)?void 0:l.call(n,0),0===e)}else{let n=e.series;i&&(n=n.slice().reverse()),n.forEach(({s:e,values:n},l)=>{var s,a;let o=null==(a=(s=e[r.axisHelper]).getScale)?void 0:a.call(s,0);for(let s=0;s<n.length;s++)t=MA(n[i?n.length-1-s:s],t,e,r,o,0===s&&0===l)})}}for(let n in e.nodes)t(e.nodes[n],i,r)}(a[o].nodes[h],s.getStackInverse(),{isVertical:t,start:e,end:i,startMethod:r,endMethod:n,axisHelper:l})}_calculateRectPosition(t,e,i){var r,n;let l,s,a;e?(l="_dataToPosY1",s="_dataToPosY",a="_yAxisHelper"):(l="_dataToPosX1",s="_dataToPosX",a="_xAxisHelper");let o=null==(n=(r=this[a]).getScale)?void 0:n.call(r,0),h=this[a].isInverse(),d=this._spec.barMinHeight,u=pF(this[l](t),o,i),c=pF(this[s](t),o,i),p=Math.abs(u-c);p<=0&&!pO(t[this.getStackValueField()],o)?p=0:p<d&&(p=d);let g=1;return c<u?g=-1:c===u&&(g=e?h?1:-1:h?-1:1),u+g*p}_dataToPosX(t){return this.dataToPositionX(t)}_dataToPosX1(t){return this.dataToPositionX1(t)}_dataToPosY(t){return this.dataToPositionY(t)}_dataToPosY1(t){return this.dataToPositionY1(t)}initBandRectMarkStyle(){var t,e,i,r;let n=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),l=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0);"horizontal"===this.direction?this.setMarkStyle(this._barMark,{x:t=>this._getBarXStart(t,n),x1:t=>this._getBarXEnd(t,n),y:t=>this._getPosition(this.direction,t),height:()=>this._getBarWidth(this._yAxisHelper),width:()=>{},y1:()=>{}},"normal",to.Series):this.setMarkStyle(this._barMark,{y:t=>this._getBarYStart(t,l),y1:t=>this._getBarYEnd(t,l),x:t=>this._getPosition(this.direction,t),width:()=>this._getBarWidth(this._xAxisHelper),x1:()=>{},height:()=>{}},"normal",to.Series),this._initStackBarMarkStyle(),this._initBandBarBackgroundMarkStyle()}_initStackBarMarkStyle(){var t,e,i,r;if(!this._spec.stackCornerRadius)return;let n=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),l=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0);this._barMark.setMarkConfig({clip:!0,clipPath:()=>{let t=[];return this._forEachStackGroup(e=>{let i=1/0,r=-1/0,s=!1,a=1/0,o=-1/0;e.values.forEach(t=>{let e=t[uo],n=t[uh],l=t[ud],h=t[uu];i=Math.min(i,e,n),r=Math.max(r,e,n),(0,aw.Z)(l)&&(0,aw.Z)(h)&&(s=!0,a=Math.min(a,l,h),o=Math.max(o,l,h))});let h=Object.assign(Object.assign(Object.assign({},e.values[0]),{[uo]:i,[uh]:r}),s?{[ud]:a,[uu]:o}:void 0),d="horizontal"===this.direction?{x:this._getBarXStart(h,n),x1:this._getBarXEnd(h,n),y:this._getPosition(this.direction,h),height:this._getBarWidth(this._yAxisHelper)}:{y:this._getBarYStart(h,l),y1:this._getBarYEnd(h,l),x:this._getPosition(this.direction,h),width:this._getBarWidth(this._xAxisHelper)};t.push(cN(Object.assign(Object.assign({},d),{cornerRadius:(0,nz.Z)(this._spec.stackCornerRadius)?this._spec.stackCornerRadius(d,h,this._markAttributeContext):this._spec.stackCornerRadius,fill:!0})))}),t}})}initLinearRectMarkStyle(){var t,e,i,r;let n=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),l=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0);if("horizontal"===this.direction){let t=(0,aw.Z)(this._fieldY2)?{y:t=>this._getLinearBarYRange(t,l,!0)[0],y1:t=>this._getLinearBarYRange(t,l,!0)[1]}:{y:t=>pF(this._dataToPosY(t)-this._getBarWidth(this._yAxisHelper)/2,l,!0),height:t=>this._getBarWidth(this._yAxisHelper)};this.setMarkStyle(this._barMark,Object.assign({x:t=>this._getBarXStart(t,n,!0),x1:t=>this._getBarXEnd(t,n,!0)},t),"normal",to.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign({x:()=>this._getBarBackgroundXStart(n),x1:()=>this._getBarBackgroundXEnd(n)},t),"normal",to.Series)}else{let t=(0,aw.Z)(this._fieldX2)?{x:t=>this._getLinearBarXRange(t,n,!0)[0],x1:t=>this._getLinearBarXRange(t,n,!0)[1]}:{x:t=>pF(this._dataToPosX(t)-this._getBarWidth(this._xAxisHelper)/2,n,!0),width:t=>this._getBarWidth(this._xAxisHelper)};this.setMarkStyle(this._barMark,Object.assign(Object.assign({},t),{y:t=>this._getBarYStart(t,l),y1:t=>this._getBarYEnd(t,l)}),"normal",to.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign(Object.assign({},t),{y:()=>this._getBarBackgroundYStart(l),y1:()=>this._getBarBackgroundYEnd(l)}),"normal",to.Series)}}_initBandBarBackgroundMarkStyle(){var t,e,i,r,n;if(!this._barBackgroundMark)return;let l=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),s=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0),a=null!=(n=this._spec.barBackground)?n:{},o=(0,nB.Z)(a.fieldLevel)?void 0:a.fieldLevel+1;"horizontal"===this.direction?this.setMarkStyle(this._barBackgroundMark,{x:()=>this._getBarBackgroundXStart(l),x1:()=>this._getBarBackgroundXEnd(l),y:t=>this._getPosition(this.direction,t,o,"barBackground"),height:()=>this._getBarWidth(this._yAxisHelper,o),width:()=>{},y1:()=>{}},"normal",to.Series):this.setMarkStyle(this._barBackgroundMark,{x:t=>this._getPosition(this.direction,t,o,"barBackground"),y:()=>this._getBarBackgroundYStart(s),y1:()=>this._getBarBackgroundYEnd(s),width:()=>this._getBarWidth(this._xAxisHelper,o),x1:()=>{},height:()=>{}},"normal",to.Series)}initAnimation(){var t,e;let i={yField:this._fieldY[0],xField:this._fieldX[0],direction:this.direction,growFrom:()=>{var t;let e="horizontal"===this.direction?null==(t=this._xAxisHelper)?void 0:t.getScale(0):this._yAxisHelper.getScale(0);if(e){let t=e.domain(),i=(0,a1.iH)(t),r=(0,a1.CE)(t);return r<0?e.scale(r):i>0?e.scale(i):e.scale(0)}}},r=null==(t=this._spec.animationAppear)?void 0:t.preset,n=_m(this);this._barMark.setAnimationConfig(_l(null==(e=h9.getAnimationInKey("bar"))?void 0:e(i,r),_s(this._barMarkName,this._spec,this._markAttributeContext),n))}_getBarWidth(t,e){var i,r;let n=this._groups?this._groups.fields.length:1,l=(0,nB.Z)(e)?n:Math.min(n,e),s=null!=(r=null==(i=t.getBandwidth)?void 0:i.call(t,l-1))?r:6,a=(0,aw.Z)(this._spec.barWidth)&&l===n,o=(0,aw.Z)(this._spec.barMinWidth),h=(0,aw.Z)(this._spec.barMaxWidth),d=s;return a&&(d=hk(this._spec.barWidth,s)),o&&(d=Math.max(d,hk(this._spec.barMinWidth,s))),h&&(d=Math.min(d,hk(this._spec.barMaxWidth,s))),d}_getPosition(t,e,i,r){var n,l,s,a,o;let h,d,u;"horizontal"===t?(h=this.getYAxisHelper(),d="height",u="barBackground"===r?this.dataToBarBackgroundPositionY.bind(this):this.dataToPositionY.bind(this)):(h=this.getXAxisHelper(),d="width",u="barBackground"===r?this.dataToBarBackgroundPositionX.bind(this):this.dataToPositionX.bind(this));let c=h.getScale(0),p=this._groups?this._groups.fields.length:1,g=(0,nB.Z)(i)?p:Math.min(p,i),f=null!=(l=null==(n=h.getBandwidth)?void 0:n.call(h,g-1))?l:6,m=g===p?this._barMark.getAttribute(d,e):f;if(g>1&&(0,aw.Z)(this._spec.barGapInGroup)){let t=this._groups.fields,i=(0,a1.IX)(this._spec.barGapInGroup),r=0,n=0;for(let l=t.length-1;l>=1;l--){let d=t[l],u=null!=(a=null==(s=h.getScale(l))?void 0:s.domain())?a:[],c=u.length,p=hk(null!=(o=i[l-1])?o:(0,a1.Z$)(i),f),g=u.indexOf(e[d]);l===t.length-1?(r+=c*m+(c-1)*p,n+=g*(m+p)):(n+=g*(r+p),r+=r+(c-1)*p)}return c.scale(e[t[0]])+h.getBandwidth(0)/2-r/2+n}let y=(0,pW.z2)(c.type||"band");return u(e,g)+.5*(f-m)+(y?-f/2:0)}dataToBarBackgroundPositionX(t,e){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,e,this._getBarBackgroundPositionXEncoder,this._setBarBackgroundPositionXEncoder)}dataToBarBackgroundPositionY(t,e){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,e,this._getBarBackgroundPositionYEncoder,this._setBarBackgroundPositionYEncoder)}onLayoutEnd(){super.onLayoutEnd(),this.getRegion()._bar_series_position_calculated=!1,this._spec.sampling&&this.compile()}onDataUpdate(){super.onDataUpdate(),this.getRegion()._bar_series_position_calculated=!1}compile(){if(super.compile(),this._spec.sampling){let{width:t,height:e}=this._region.getLayoutRect(),i=this._fieldY,r=this._fieldX;this._data.setTransform([{type:"sampling",size:"horizontal"===this._direction?e:t,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?r[0]:i[0],groupBy:this._seriesField,mode:this._spec.sampling}])}}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._barMark]}compileData(){var t;super.compileData(),null==(t=this._barBackgroundViewData)||t.compile()}fillData(){var t,e;super.fillData(),null==(e=null==(t=this._barBackgroundViewData)?void 0:t.getDataView())||e.reRunAllTransform()}viewDataUpdate(t){var e,i,r;super.viewDataUpdate(t),null==(i=null==(e=this._barBackgroundViewData)?void 0:e.getDataView())||i.reRunAllTransform(),null==(r=this._barBackgroundViewData)||r.updateData()}release(){var t;super.release(),null==(t=this._barBackgroundViewData)||t.release(),this._barBackgroundViewData=null}}MT.type=Y.bar,MT.builtInTheme={bar:{label:{visible:!1,position:"outside",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}}},MT.mark=MS,MT.transformerConstructor=MM;let Mk=()=>{S7(),Mw(),Mv(),SI(),SX(),h9.registerSeries(MT.type,MT)};class MR extends Ar{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barMinHeight","sampling","samplingFactor","barBackground","stackCornerRadius","useSequentialAnimation"])}transformSpec(t){super.transformSpec(t),c8(t)}_transformAxisSpec(t){var e,i;if(super._transformAxisSpec(t),!t.axes)return;let r=t.series.some(t=>"horizontal"===t.direction),n=null!=(e=t.axes.find(t=>"band"===t.type))?e:t.axes.find(t=>(r?["left","right"]:["top","bottom"]).includes(t.orient));if(n&&!n.bandSize&&!n.maxBandSize&&!n.minBandSize&&t.autoBandSize){let e=(0,nF.Z)(t.autoBandSize)&&null!=(i=t.autoBandSize.extend)?i:0,{barMaxWidth:r,barMinWidth:l,barWidth:s,barGapInGroup:a}=t.series.find(t=>"bar"===t.type);this._applyAxisBandSize(n,e,{barMaxWidth:r,barMinWidth:l,barWidth:s,barGapInGroup:a})}}}class MP extends Ah{constructor(){super(...arguments),this.transformerConstructor=MR,this.type="bar",this.seriesType=Y.bar}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}MP.type="bar",MP.seriesType=Y.bar,MP.transformerConstructor=MR,(0,yf.jB)(MP,Ac);let MB=()=>{AX(),A$(),AJ(),Af(),Mk(),AM(),h9.registerChart(MP.type,MP)};var MI=i(80741);let ME=[10,20],ML=pW._f.Linear,MF="circle",MO=pW._f.Ordinal,MH=["circle","square","triangle","diamond","star"],MD=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"},Mz=()=>{h9.registerAnimation("scatter",(t,e)=>Object.assign({appear:MD(0,e)},vU))},MW=Object.assign(Object.assign({},b7),{point:{name:"point",type:"symbol"}});class MZ extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"point")}}class MN extends _y{constructor(){super(...arguments),this.type=Y.scatter,this.transformerConstructor=MZ,this._invalidType="zero"}setAttrFromSpec(){super.setAttrFromSpec(),this._size=this._spec.size,this._sizeField=this._spec.sizeField,this._shape=this._spec.shape,this._shapeField=this._spec.shapeField}_getSeriesAttribute(t,e,{defaultScaleType:i,defaultRange:r},n){var l,s,a,o;if((0,nz.Z)(e))return e;if((0,rD.Z)(e)){if((0,nB.Z)(t))return null==(l=this._option)||l.onError(`${n}Field is required.`),e;if("ordinal"!==i&&e.length>2)return null==(s=this._option)||s.onError(`${n} length is invalid, specify up to 2 ${n}s.`),e;let r=`${d9}_series_scatter_${this.id}_scale_${n}`;return this._option.globalScale.registerModelScale({id:r,type:i,domain:[{dataId:this._rawData.name,fields:[t]}],range:e}),{scale:r,field:t}}if((0,nF.Z)(e)){if((0,nB.Z)(t))return null==(a=this._option)||a.onError(`${n}Field is required.`),e;let l=Object.assign({id:`${d9}_series_scatter_${this.id}_scale_${n}`,type:i,domain:[{dataId:this._rawData.name,fields:[t]}],range:r},e);return this._option.globalScale.registerModelScale(l),{scale:l.id,field:t}}return null==(o=this._option)||o.onError(`${n} attribute is invalid.`),e}getSizeAttribute(t,e){return(0,nB.Z)(e)?10:(0,n4.Z)(e)?e:(0,nI.Z)(e)&&(0,MI.Z)(e)?parseFloat(e):this._getSeriesAttribute(t,e,{defaultScaleType:ML,defaultRange:ME},"size")}getShapeAttribute(t,e){return(0,nB.Z)(e)?MF:(0,nI.Z)(e)?e:this._getSeriesAttribute(t,e,{defaultScaleType:MO,defaultRange:MH},"shape")}initMark(){this._symbolMark=this._createMark(MN.mark.point,{groupKey:this._seriesField,isSeriesMark:!0},{morph:_h(this._spec,MN.mark.point.name),morphElementKey:this.getDimensionField()[0]})}initMarkStyle(){this.initSymbolMarkStyle()}initAnimation(){var t,e,i;let r=_m(this),n=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._symbolMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("scatter"))?void 0:i({},n),_s("point",this._spec,this._markAttributeContext),r))}initSymbolMarkStyle(){let t=this._symbolMark;t&&("zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)}),this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,fill:this.getColorAttribute(),size:(0,n4.Z)(this._size)||(0,nz.Z)(this._size)?this._size:10,symbolType:(0,nI.Z)(this._shape)||(0,nz.Z)(this._shape)?this._shape:MF},td.STATE_NORMAL,to.Series),((0,aw.Z)(this._sizeField)||(0,aw.Z)(this._size))&&this.setMarkStyle(t,{size:this.getSizeAttribute(this._sizeField,this._size)},td.STATE_NORMAL,to.User_Mark),((0,aw.Z)(this._shapeField)||(0,aw.Z)(this._shape))&&this.setMarkStyle(t,{symbolType:this.getShapeAttribute(this._shapeField,this._shape)},td.STATE_NORMAL,to.User_Mark))}initTooltip(){super.initTooltip(),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)}viewDataStatisticsUpdate(t){super.viewDataStatisticsUpdate(t);let e=[this.getDimensionField()[0],this.getStackValueField()].every(t=>{var e,i,r;return t&&(null==(r=null==(i=null==(e=this.getViewDataStatistics())?void 0:e.latestData)?void 0:i[t])?void 0:r.allValid)});"zero"===this._invalidType||e?this.setMarkStyle(this._symbolMark,{visible:!0},"normal",to.Series):this.setMarkStyle(this._symbolMark,{visible:this._getInvalidDefined.bind(this)},"normal",to.Series),this._symbolMark.getProduct()&&this._symbolMark.compileEncode()}initLabelMarkStyle(t){t&&(this._labelMark=t,this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null},td.STATE_NORMAL,to.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},td.STATE_NORMAL,to.Series))}handleZoom(t){var e,i;this.getMarksWithoutRoot().forEach(t=>{if(!t)return;let e=t.getGraphics();e&&e.length&&e.forEach((t,e)=>{var i,r;let n=null==(r=null==(i=null==t?void 0:t.context)?void 0:i.data)?void 0:r[0],l=this.dataToPosition(n);l&&t&&t.translateTo(l.x,l.y)})});let r=null==(i=null==(e=this._labelMark)?void 0:e.getComponent())?void 0:i.getProduct();r&&r.evaluate(null,null)}handlePan(t){this.handleZoom(t)}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._symbolMark]}}MN.type=Y.scatter,MN.mark=MW,MN.builtInTheme={scatter:{point:{style:{size:8,symbolType:"circle",lineWidth:0,fillOpacity:.8}},label:{visible:!1,offset:5,position:"top",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}}},MN.transformerConstructor=MZ;let Mj=()=>{CK(),Mz(),SI(),SX(),h9.registerSeries(MN.type,MN)};class MG extends Ar{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["point","size","shape","shapeField","sizeField"])}}class MV extends Ah{constructor(){super(...arguments),this.transformerConstructor=MG,this.type="scatter",this.seriesType=Y.scatter}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}MV.type="scatter",MV.seriesType=Y.scatter,MV.transformerConstructor=MG,(0,yf.jB)(MV,Ac);let MU=()=>{AX(),A$(),AM(),Af(),Mj(),h9.registerChart(MV.type,MV)},MK=(t,e)=>{let i;if(!e.from||!e.from())return t;let r=e.fields,n=e.key,l=e.values,s=e.default,a=e.as||[r],o=e.from().reduce(function(t,e){return e[r]&&t.set(e[r],e),t},new Map);if((0,nz.Z)(e.set))i=function(t){let i=o.get(t[n]);e.set(t,i)};else if(l){let t=l.length;i=function(e){let i=o.get(e[n]);if((0,nB.Z)(i))for(let i=0;i<t;++i)e[a[i]]=s;else for(let r=0;r<t;++r)e[a[r]]=i[l[r]]}}else i=function(t){let e=o.get(t[n]);t[a[0]]=(0,aw.Z)(e)?e:s};return 0===t.length?[]:t.map(t=>(i(t),t))};class MX extends _p{constructor(){super(...arguments),this.type=Y.geo,this.coordinate="geo",this._nameProperty="name"}getMapViewData(){var t;return null==(t=this._mapViewData)?void 0:t.getDataView()}get nameField(){return this._nameField}set nameField(t){this._nameField=t}get valueField(){return this._valueField}set valueField(t){this._valueField=t}getNameProperty(){return this._nameProperty}getCentroidProperty(){return this._centroidProperty}getCoordinateHelper(){return this._coordinateHelper}setCoordinateHelper(t){this._coordinateHelper=t}getStatisticFields(){let t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}getGroupFields(){return null}dataToPosition(t,e){var i;let r=null;if(!t||e&&!this.isDatumInViewData(t))return r;let{dataToPosition:n,latitudeField:l,longitudeField:s}=this._coordinateHelper;if(null===(r=this.nameToPosition(t))){let e=s?null==t?void 0:t[s]:Number.NaN,a=l?null==t?void 0:t[l]:Number.NaN;r=null!=(i=null==n?void 0:n([e,a]))?i:null}return r}nameToPosition(t){let e=this.getDatumName(t);return(0,nB.Z)(e)?null:this.nameValueToPosition(e)}nameValueToPosition(t){var e,i;let r=null==(i=null==(e=this.getMapViewData())?void 0:e.latestData)?void 0:i.filter(e=>this.getDatumName(e)===t)[0];if((0,nB.Z)(r))return null;let{dataToPosition:n}=this._coordinateHelper,l=this.getDatumCenter(r),s=null==n?void 0:n(l);return(0,nB.Z)(s)||isNaN(s.x)||isNaN(s.y)?null:s}dataToLatitude(t){if(!this._coordinateHelper)return Number.NaN;let{dataToLatitude:e}=this._coordinateHelper;return e(t)}dataToLongitude(t){if(!this._coordinateHelper)return Number.NaN;let{dataToLatitude:e}=this._coordinateHelper;return e(t)}valueToPosition(t,e){return{x:this.dataToLongitude(t),y:this.dataToLatitude(e)}}positionToData(t){}latitudeToData(t){}longitudeToData(t){}dataToPositionX(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}dataToPositionY(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}dataToPositionZ(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}release(){super.release(),this._mapViewData.release(),this._mapViewData=this._mapViewDataStatistics=null}getStackGroupFields(){return[this._nameField]}getStackValueField(){return this._spec.valueField}compileData(){var t;null==(t=this._mapViewData)||t.compile()}initStatisticalData(){if(super.initStatisticalData(),this._mapViewData){let t=`${d9}_series_${this.id}_mapViewDataStatic`;this._mapViewDataStatistics=this.createStatisticalData(t,this._mapViewData.getDataView()),this._mapViewData.getDataView().target.removeListener("change",this._mapViewDataStatistics.reRunAllTransform)}}getSeriesKeys(){var t,e,i,r,n;return this._seriesField?null!=(n=null!=(e=null==(t=this.getRawDataStatisticsByField(this._seriesField))?void 0:t.values)?e:null==(r=null==(i=this._mapViewDataStatistics)?void 0:i.latestData[this._seriesField])?void 0:r.values)?n:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}fillData(){var t,e;super.fillData(),null==(t=this._mapViewData.getDataView())||t.reRunAllTransform(),null==(e=this._mapViewDataStatistics)||e.reRunAllTransform()}getActiveMarks(){return[]}}let MY=(t,e)=>(t.features&&t.features.forEach((t,i)=>{var r;t[ur]=i;let n=null==(r=t.properties)?void 0:r[e.nameProperty];e.nameMap&&e.nameMap[n]?t[uA]=e.nameMap[n]:t[uA]=n}),t.features);class M$ extends bY{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=t=>{var e;let i=this.series;return null!=(e=this._getDimensionData(t))?e:i.getDatumName(t)}}}class Mq extends gW{constructor(){super(...arguments),this.type=Mq.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0,path:""})}}Mq.type="path";let MJ=()=>{h9.registerMark(Mq.type,Mq),gG(),wD(),h9.registerGraphicComponent("path",wP)},MQ=Object.assign(Object.assign({},b7),{area:{name:"area",type:"path"}});var M0=i(36248);class M1{constructor(t){this.projection=(0,M0.UQ)(t.type)()}fit(t,e,i){this.projection.fitExtent([t,e],{type:"FeatureCollection",features:i})}center(t){var e,i;null==(i=null==(e=this.projection)?void 0:e.center)||i.call(e,t)}project(t){var e;return null==(e=this.projection)?void 0:e.call(this,t)}shape(t){var e,i;return null==(i=null==(e=this.projection)?void 0:e.path)?void 0:i.call(e,t)}invert(t){var e,i;return null==(i=null==(e=this.projection)?void 0:e.invert)?void 0:i.call(e,t)}scale(t){var e;if(null==(e=this.projection)?void 0:e.scale){if(void 0===t)return this.projection.scale();this.projection.scale(t)}}translate(t){var e;if(null==(e=this.projection)?void 0:e.scale){if(void 0===t)return this.projection.translate();this.projection.translate(t)}}evaluate(t,e,i){let r=this.projection.copy();return null==r?void 0:r.fitExtent([t,e],{type:"FeatureCollection",features:i})}}class M2{parserScrollEvent(t){return t?!(t.ctrlKey||0===t.deltaY&&0===t.deltaX)&&(t.scrollX=t.deltaX,t.scrollY=t.deltaY,t):t}parserZoomEvent(t){if(!t)return t;let e=Math.pow(1.0005,-t.deltaY*Math.pow(16,t.deltaMode));return t.zoomDelta=e,t.zoomX=t.canvasX,t.zoomY=t.canvasY,t}clearZoom(){}clearScroll(){}clearDrag(){}}class M3{constructor(){this._lastScale=0}clearZoom(){this._lastScale=0}parserZoomEvent(t){let e=t.scale;if(0===this._lastScale)return this._lastScale=e,t;t.zoomDelta=e/this._lastScale;let i=t.center;return t.zoomX=i.x,t.zoomY=i.y,this._lastScale=e,t}parserScrollEvent(t){return t}clearScroll(){}clearDrag(){}}function M5(t){return t===oJ["desktop-browser"]||t===oJ["desktop-miniApp"]?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside"],zoom:"wheel",zoomEnd:"pointerup",scroll:"wheel",trigger:M2}:hE(t)||hL(t)?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside","pointerleave"],zoom:"pinch",zoomEnd:"pinchend",scroll:"pan",scrollEnd:"panend",trigger:M3}:null}let M4={debounce:dS.Z,throttle:dw.Z};class M6{constructor(){this._isGestureListener=!1}initZoomable(t,e=oJ["desktop-browser"]){this._eventObj=t,this._renderMode=e,this._gestureController=this._option.getCompiler()._gestureController,this._isGestureListener=hE(this._renderMode)||hL(this._renderMode),M5(this._renderMode)&&(this._clickEnable=!0,this._zoomableTrigger=new(this._getZoomTriggerEvent("trigger")))}_getZoomTriggerEvent(t){return M5(this._renderMode)[t]}_zoomEventDispatch(t,e,i,r){if(!this._isGestureListener&&!t.event)return;let n=this._isGestureListener?t:t.event.clone();this._zoomableTrigger.parserZoomEvent(n);let{zoomDelta:l,zoomX:s,zoomY:a,path:o}=n;if(!r&&!o.some(t=>t.name&&t.name.includes("region"))||(0,nB.Z)(l)||!(0,aj.qr)({x:s,y:a},this._getRegionOrSeriesLayout(e),!1))return;this._clearDragEvent(),this._zoomableTrigger.clearScroll();let h={};i&&(h=i({zoomDelta:l,zoomX:s,zoomY:a},n)),this._eventObj.emit("zoom",Object.assign(Object.assign({scale:n.zoomDelta,scaleCenter:{x:n.zoomX,y:n.zoomY}},h),{model:this}))}_getRegionOrSeriesLayout(t){"region"!==t.type&&(t=t.getRegion());let{x:e,y:i,width:r,height:n}=t.layout.getLayout();return{x1:e,y1:i,x2:e+r,y2:i+n}}_bindZoomEventAsRegion(t,e,i,r){var n,l;let s=null!=(n=null==r?void 0:r.delayType)?n:"throttle",a=null!=(l=null==r?void 0:r.delayTime)?l:0,o=this._isGestureListener?this._gestureController:t,h=this._isGestureListener?[this._getZoomTriggerEvent("zoom")]:[this._getZoomTriggerEvent("zoom"),{level:te.chart,consume:!0}],d=this._isGestureListener?[this._getZoomTriggerEvent("zoomEnd")]:[this._getZoomTriggerEvent("zoomEnd"),{level:te.chart,consume:!1}];o.on(...d,M4[s](t=>{this._zoomableTrigger.clearZoom()},a)),o.on(...h,M4[s](t=>{var n;this._zoomEventDispatch(t,e,i,null!=(n=null==r?void 0:r.allowComponentZoom)&&n)},a))}initZoomEventOfSeries(t,e,i){this._option.disableTriggerEvent||M5(this._renderMode)&&this._bindZoomEventAsRegion(t.event,t,e,i)}initZoomEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||M5(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&this._bindZoomEventAsRegion(t.event,t,i,r)}):this._bindZoomEventAsRegion(this._eventObj,t,i,r)})}_scrollEventDispatch(t,e,i){let r=!1;if(!this._isGestureListener&&(!t.event||this._option.disableTriggerEvent))return r;let n=this._isGestureListener?t:t.event;this._zoomableTrigger.parserScrollEvent(n);let{scrollX:l,scrollY:s,canvasX:a,canvasY:o}=n;return(0,nB.Z)(l)&&(0,nB.Z)(s)||(0,aj.qr)({x:a,y:o},this._getRegionOrSeriesLayout(e),!1)&&(this._clearDragEvent(),this._zoomableTrigger.clearZoom(),i&&(r=i({scrollX:l,scrollY:s},n)),this._eventObj.emit("scroll",{scrollX:l,scrollY:s,model:this})),r}_bindScrollEventAsRegion(t,e,i,r){var n,l;let s=null!=(n=null==r?void 0:r.delayType)?n:"throttle",a=null!=(l=null==r?void 0:r.delayTime)?l:0,o=this._isGestureListener?this._gestureController:t,h=this._isGestureListener?[this._getZoomTriggerEvent("scroll")]:[this._getZoomTriggerEvent("scroll"),{level:te.chart,consume:!0}],d=this._isGestureListener?[this._getZoomTriggerEvent("scrollEnd")]:[this._getZoomTriggerEvent("scrollEnd"),{level:te.chart,consume:!1}];o.on(...d,M4[s](t=>{this._zoomableTrigger.clearScroll()},a)),o.on(...h,M4[s](t=>this._scrollEventDispatch(t,e,i),a))}initScrollEventOfSeries(t,e,i){M5(this._renderMode)&&this._bindScrollEventAsRegion(t.event,t,e,i)}initScrollEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||M5(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&this._bindScrollEventAsRegion(t.event,t,i,r)}):this._bindScrollEventAsRegion(this._eventObj,t,i,r)})}_bindDragEventAsRegion(t,e,i,r){t.on(this._getZoomTriggerEvent("start"),{level:te.chart},t=>{if(!t.event)return;let{event:n}=t;(0,aj.qr)({x:n.canvasX,y:n.canvasY},this._getRegionOrSeriesLayout(e),!1)&&this._handleDrag(t,i,r)}),t.on("click",{level:te.chart},()=>!this._clickEnable)}initDragEventOfSeries(t,e,i){this._option.disableTriggerEvent||M5(this._renderMode)&&t.event.on(this._getZoomTriggerEvent("start"),{level:te.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},t=>{this._handleDrag(t,e,i)})}initDragEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||M5(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&(t.event.on(this._getZoomTriggerEvent("start"),{level:te.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},t=>{this._handleDrag(t,i)}),t.event.on("click",{level:te.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>!this._clickEnable))}):this._bindDragEventAsRegion(this._eventObj,t,i,r)})}_clearDragEvent(){let t=this._getZoomTriggerEvent("move"),e=this._getZoomTriggerEvent("end");this._handleDragMouseMove&&(this._eventObj.off(t,{level:te.chart,source:Q.chart},this._handleDragMouseMove),this._handleDragMouseMove=void 0),this._handleDragMouseUp&&(e.forEach(t=>{this._eventObj.off(t,{level:te.chart,source:Q.chart},this._handleDragMouseUp),this._eventObj.allow(t)}),this._handleDragMouseUp=void 0)}isDragEnable(t){if(this._isGestureListener&&this._gestureController){let t=this._gestureController.cachedEvents;return!t||t.length<2}return!0}_handleDrag(t,e,i){var r,n,l;if(this._clearDragEvent(),this._option.disableTriggerEvent||(this._clickEnable=!1,!this.isDragEnable(t.event)))return;this._zoomableTrigger.clearZoom(),this._zoomableTrigger.clearScroll();let s=null!=(r=null==i?void 0:i.delayType)?r:"throttle",a=null!=(n=null==i?void 0:i.delayTime)?n:0,o=null==(l=null==i?void 0:i.realTime)||l,h=this._getZoomTriggerEvent("move"),d=this._getZoomTriggerEvent("end"),u=t.event,c=u.canvasX,p=u.canvasY,g=u.canvasX,f=u.canvasY;this._handleDragMouseUp=M4[s](t=>{this._clickEnable=!0;let i=t.event,r=[i.canvasX-g,i.canvasY-f];g=i.canvasX,f=i.canvasY,!o&&e&&e(r,t.event),this._eventObj.emit("panend",{delta:r,model:this}),this._clearDragEvent()},a),this._handleDragMouseMove=M4[s](t=>{if(!this.isDragEnable(t.event))return;this._clickEnable=!1,d.forEach(t=>{this._eventObj.prevent(t,{handler:this._handleDragMouseUp,level:te.chart})});let i=t.event,r=[i.canvasX-c,i.canvasY-p];c=i.canvasX,p=i.canvasY,o&&e&&e(r,t.event),this._eventObj.emit("panmove",{delta:r,model:this})},a),this._eventObj.on(h,{level:te.chart,source:Q.chart},this._handleDragMouseMove),d.forEach(t=>{this._eventObj.on(t,{level:te.chart,source:Q.chart},this._handleDragMouseUp)})}}class M7 extends xZ{constructor(){var t,e;super(...arguments),this.type=oQ.geoCoordinate,this.name=oQ.geoCoordinate,this.layoutType="none",this.layoutZIndex=ts.Mark,this._projectionSpec={name:(t=this.type,e=this.id,`${d9}_${e}_${t}`),type:"mercator"},this._actualScale=1,this._initialScale=1,this.effect={scaleUpdate:()=>{this.coordinateHelper()}},this._handleChartZoom=(t,e)=>{var i,r,n,l,s,a;let o=(0,aw.Z)(this._spec.zoomRate)?Math.max(0,this._spec.zoomRate):1,h=Math.pow(Math.max(t.zoomDelta,1e-6),o),d=this._actualScale;return this._actualScale*=h,this._actualScale<(null==(i=this._spec.zoomLimit)?void 0:i.min)?(this._actualScale=null==(r=this._spec.zoomLimit)?void 0:r.min,h=(null==(n=this._spec.zoomLimit)?void 0:n.min)/d):this._actualScale>(null==(l=this._spec.zoomLimit)?void 0:l.max)&&(this._actualScale=null==(s=this._spec.zoomLimit)?void 0:s.max,h=(null==(a=this._spec.zoomLimit)?void 0:a.max)/d),this.zoom(h,[t.zoomX,t.zoomY]),{scale:h,totalScale:this._actualScale}},this.pan=(t=[0,0])=>{var e,i,r;let n=null!=(i=null==(e=this._projection)?void 0:e.translate())?i:[0,0],l=n[0],s=n[1];l+=t[0],s+=t[1],null==(r=this._projection)||r.translate([l,s])}}get longitudeField(){return this._longitudeField}get latitudeField(){return this._latitudeField}get projectionSpec(){return this._projectionSpec}setProjection(t){this._projectionSpec=Object.assign(Object.assign({},t),{name:this._projectionSpec.name})}getZoom(){return this._actualScale}static getSpecInfo(t){if((0,nB.Z)(t))return null;let e=[];return t.region.forEach((t,i)=>{if("geo"===t.coordinate){let r=Object.assign(Object.assign({},t),{padding:0});e.push({spec:r,regionIndex:i,type:oQ.geoCoordinate,specInfoPath:["component","geoCoordinate",i]})}}),e}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec(),this._spec.roam&&this.initZoomable(this.event,this._option.mode),this._projectionSpec=h5(this._projectionSpec,this._spec.projection),this._projectionSpec.zoom>(null==(t=this._spec.zoomLimit)?void 0:t.max)&&(this._projectionSpec.zoom=this._spec.zoomLimit.max),this._projectionSpec.zoom<(null==(e=this._spec.zoomLimit)?void 0:e.min)&&(this._projectionSpec.zoom=this._spec.zoomLimit.min),this._actualScale=null!=(i=this._projectionSpec.zoom)?i:1,this._initialScale=this._actualScale,this._longitudeField=this._spec.longitudeField,this._latitudeField=this._spec.latitudeField}created(){super.created(),this._regions=this._option.getRegionsInIndex([this._option.regionIndex]),this.initProjection(),this.coordinateHelper(),this.initEvent(),this._initCenterCache()}dispatchZoom(t,e){let i=e||{x:this.getLayoutStartPoint().x+this.getLayoutRect().width/2,y:this.getLayoutStartPoint().y+this.getLayoutRect().height/2},{scale:r,totalScale:n}=this._handleChartZoom({zoomDelta:t,zoomX:i.x,zoomY:i.y});1!==r&&this.event.emit("zoom",{scale:r,scaleCenter:i,totalScale:n,model:this})}initEvent(){var t,e,i;this.event.on(J.scaleUpdate,{filter:({model:t})=>(null==t?void 0:t.id)===this.id},this.effect.scaleUpdate.bind(this));let{roam:r}=this._spec;if(r){let n=!0,l=!0,s=!1;!0!==r&&(n=null==(t=r.zoom)||t,l=null==(e=r.drag)||e,s=null!=(i=r.blank)&&i),n&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom),l&&this.initDragEventOfRegions(this._regions,s?null:()=>!0,this.pan),this._regions.forEach(t=>{t.getSeries().forEach(t=>{t.event.on("zoom",e=>(t.handleZoom(e),!0)),t.event.on("panmove",e=>(t.handlePan(e),!0))})})}}initProjection(){var t;this._projection=new M1(this._projectionSpec),null!==this._projection.projection||null==(t=this._option)||t.onError("unsupported projection type!")}coordinateHelper(){let t={longitudeField:this._longitudeField,latitudeField:this._latitudeField,dataToPosition:this.dataToPosition.bind(this),dataToLongitude:this.dataToLongitude.bind(this),dataToLatitude:this.dataToLatitude.bind(this),shape:this.shape.bind(this),getCoordinateId:()=>this.id};this._regions.forEach(e=>{e.getSeries().forEach(e=>{e.type===Y.map||e.type===Y.pictogram?e.setCoordinateHelper(t):(e.setXAxisHelper(Object.assign(Object.assign({},t),{isContinuous:!0,dataToPosition:(t,i)=>{var r;let n=t[0];if((0,nB.Z)(n)&&(null==i?void 0:i.datum)){let t=i.datum[e.getDimensionField()[0]];n=null==(r=this._centerCache.get(t))?void 0:r.x}return this.dataToLongitude(n)},valueToPosition:(t,i)=>{var r;if((0,nB.Z)(t)&&(null==i?void 0:i.datum)){let n=i.datum[e.getDimensionField()[0]];t=null==(r=this._centerCache.get(n))?void 0:r.x}return this.dataToLongitude(t)},getFields:()=>[this._longitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})),e.setYAxisHelper(Object.assign(Object.assign({},t),{isContinuous:!0,dataToPosition:(t,i)=>{var r;let n=t[0];if((0,nB.Z)(n)&&(null==i?void 0:i.datum)){let t=i.datum[e.getDimensionField()[0]];n=null==(r=this._centerCache.get(t))?void 0:r.y}return this.dataToLatitude(n)},valueToPosition:(t,i)=>{var r;if((0,nB.Z)(t)&&(null==i?void 0:i.datum)){let n=i.datum[e.getDimensionField()[0]];t=null==(r=this._centerCache.get(n))?void 0:r.y}return this.dataToLatitude(t)},getFields:()=>[this._latitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})))})})}onLayoutEnd(){this.setLayoutRect(this._regions[0].getLayoutRect()),this.setLayoutStartPosition(this._regions[0].getLayoutStartPoint());let{width:t,height:e}=this.getLayoutRect(),{translate:i,scale:r,center:n}=this.evaluateProjection([0,0],[t,e]);i&&this._projection.translate(i),r&&this._projection.scale(r),n&&this._projection.center(n),C$(this._regions,t=>{var e;if(t.type===Y.map||t.type===Y.pictogram){null==(e=t.areaPath)||e.clear();let i=t.getRootMark().getProduct();i&&i.attribute.postMatrix&&i.setAttributes({postMatrix:new iT.y})}}),this._actualScale=this._initialScale,super.onLayoutEnd()}collectFeatures(){let t=[];return this._regions.forEach(e=>{e.getSeries().forEach(e=>{var i,r;e.type!==Y.map&&e.type!==Y.pictogram||t.push(...null!=(r=null==(i=e.getMapViewData())?void 0:i.latestData)?r:[])})}),t}dataToPosition(t=[]){var e;let i=null==(e=this._projection)?void 0:e.project([t[0],t[1]]);return{x:null==i?void 0:i[0],y:null==i?void 0:i[1]}}dataToLatitude(t){var e;let i=null==(e=this._projection)?void 0:e.project([0,t]);return null==i?void 0:i[1]}dataToLongitude(t){var e;let i=null==(e=this._projection)?void 0:e.project([t,0]);return null==i?void 0:i[0]}zoom(t,e=[0,0]){var i,r,n,l,s,a;let o=null!=(r=null==(i=this._projection)?void 0:i.scale())?r:0,h=null!=(l=null==(n=this._projection)?void 0:n.translate())?l:[0,0],d=h[0],u=h[1];o*=t,d-=(e[0]-d)*(t-1),u-=(e[1]-u)*(t-1),null==(s=this._projection)||s.scale(o),null==(a=this._projection)||a.translate([d,u])}shape(t){return this._projection.shape(t)}invert(t){return this._projection.invert(t)}evaluateProjection(t,e){var i;let r=this._projection.evaluate(t,e,this.collectFeatures()),n=r.translate(),l=r.scale()*this._initialScale,s=null!=(i=this._projectionSpec.center)?i:r.invert([e[0]/2,e[1]/2]);return s&&(n=[e[0]/2,e[1]/2]),{translate:n,scale:l,center:s}}_initCenterCache(){this._centerCache||(this._centerCache=new Map),this._regions.forEach(t=>{t.getSeries().forEach(t=>{var e,i;"map"===t.type&&(null!=(i=null==(e=t.getMapViewData())?void 0:e.latestData)?i:[]).forEach((e={})=>{let i=e[t.getDimensionField()[0]]||e[uA],r=t.getDatumCenter(e);i&&(0,aw.Z)(r)&&this._centerCache.set(i,{x:r[0],y:r[1]})})})})}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reMake=["roam","longitudeField","latitudeField","projection","zoomLimit","zoomRate"].some(i=>!(0,uL.X)(null==e?void 0:e[i],t[i]))),i}release(){super.release(),this._centerCache&&this._centerCache.clear(),this._centerCache=null}}M7.type=oQ.geoCoordinate,(0,yf.jB)(M7,M6);let M8=()=>{h9.registerComponent(M7.type,M7)};class M9 extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"area",void 0,void 0,!1)}}class Tt extends MX{constructor(){super(...arguments),this.type=Y.map,this.transformerConstructor=M9,this._areaCache=new Map}getNameMap(){return this._nameMap}get areaPath(){return this._areaCache}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.map=this._spec.map,this._nameMap=this._spec.nameMap,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this._spec.nameProperty&&(this._nameProperty=this._spec.nameProperty),this._spec.centroidProperty&&(this._centroidProperty=this._spec.centroidProperty),this.map||null==(t=this._option)||t.onError(`map type '${this.map}' is not specified !`),dO.get(this.map)||null==(e=this._option)||e.onError(`'${this.map}' data is not registered !`)}initData(){var t,e;super.initData(),dL(this._dataSet,"copyDataView",dZ),dL(this._dataSet,"map",MY),dL(this._dataSet,"lookup",MK);let i=dO.get(this.map);i||null==(t=this._option)||t.onError("no valid map data found!");let r=new eq.V(this._dataSet,{name:`map_${this.id}_data`});r.parse([i],{type:"dataview"}).transform({type:"copyDataView",options:{deep:!0},level:ti.copyDataView}).transform({type:"map",options:{nameMap:this._nameMap,nameProperty:this._nameProperty}}).transform({type:"lookup",options:{from:()=>{var t;return null==(t=this._data)?void 0:t.getLatestData()},key:uA,fields:this._nameField,set:(t,e)=>{e&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}}}),null==(e=this._data)||e.getDataView().target.addListener("change",r.reRunAllTransform),this._mapViewData=new pV(this._option,r)}compileData(){var t;super.compileData(),null==(t=this._mapViewData)||t.compile()}initMark(){this._pathMark=this._createMark(Tt.mark.area,{groupKey:this.getDimensionField()[0],isSeriesMark:!0},{morph:_h(this._spec,Tt.mark.area.name),morphElementKey:this.getDimensionField()[0]}),this._pathMark.setData(this._mapViewData)}initMarkStyle(){let t=this._pathMark;t&&(this.setMarkStyle(t,{fill:t=>{var e,i,r,n;return(0,aw.Z)(t[null!=(e=this._seriesField)?e:ul])?(null!=(i=this._option.globalScale.getScale("color"))?i:this._getDefaultColorScale()).scale(t[null!=(r=this._seriesField)?r:ul]):null==(n=this._spec)?void 0:n.defaultFillColor},path:this.getPath.bind(this)},"normal",to.Series),t.setPostProcess("fill",t=>(0,aw.Z)(t)?t:this._spec.defaultFillColor),this.setMarkStyle(t,{smoothScale:!0},"normal",to.Built_In))}initLabelMarkStyle(t){t&&(this._labelMark=t,this.setMarkStyle(t,{text:t=>this.getDatumName(t),x:t=>{var e;return null==(e=this.dataToPosition(t))?void 0:e.x},y:t=>{var e;return null==(e=this.dataToPosition(t))?void 0:e.y}}))}initAnimation(){var t;this._pathMark.setAnimationConfig(_l(null==(t=h9.getAnimationInKey("fadeInOut"))?void 0:t(),_s("area",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new M$(this),this._pathMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pathMark)}getPath(t){var e;let i=this._areaCache.get(t[ur]);if(i)return i.shape;let r=null==(e=this._coordinateHelper)?void 0:e.shape(t);return this._areaCache.set(t[ur],{shape:r}),r}onEvaluateEnd(){this._mapViewData.updateData()}getDimensionField(){return[this.nameField]}getMeasureField(){return[this.valueField]}release(){super.release(),this._areaCache.clear(),this._nameMap={},this._mapViewData=null}handleZoom(t){var e;let{scale:i,scaleCenter:r}=t;if(1===i)return;let n=this.getRootMark().getProduct();n&&(n.attribute.postMatrix||n.setAttributes({postMatrix:new iT.y}),n.scale(i,i,r));let l=null==(e=this._labelMark)?void 0:e.getComponent();l&&l.renderInner()}handlePan(t){var e;let{delta:i}=t;if(0===i[0]&&0===i[1])return;let r=this.getRootMark().getProduct();r&&(r.attribute.postMatrix||r.setAttributes({postMatrix:new iT.y}),r.translate(i[0],i[1]));let n=null==(e=this._labelMark)?void 0:e.getComponent();n&&n.renderInner()}getDatumCenter(t){var e,i,r,n;return this._centroidProperty&&(null==(e=t.properties)?void 0:e[this._centroidProperty])?null==(i=t.properties)?void 0:i[this._centroidProperty]:(0,hy.Z)(t.centroidX*t.centroidY)?[t.centroidX,t.centroidY]:(null==(r=t.properties)?void 0:r.center)?t.properties.center:(null==(n=t.properties)?void 0:n.centroid)?t.properties.centroid:[Number.NaN,Number.NaN]}getDatumName(t){var e;if(t[this.nameField])return t[this.nameField];let i=null==(e=t.properties)?void 0:e[this._nameProperty];if(i){if(this._spec.nameMap&&this._spec.nameMap[i])return this._spec.nameMap[i];if(this._spec.showDefaultName||!this._spec.nameMap)return i}return""}dataToPositionX(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}dataToPositionY(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}viewDataUpdate(t){var e,i,r;super.viewDataUpdate(t),null==(i=null==(e=this._mapViewData)?void 0:e.getDataView())||i.reRunAllTransform(),null==(r=this._mapViewData)||r.updateData()}_getDataIdKey(){return ur}getActiveMarks(){return[this._pathMark]}}Tt.type=Y.map,Tt.mark=MQ,Tt.builtInTheme={map:{defaultFillColor:"#f3f3f3",area:{style:{lineWidth:.5,strokeOpacity:1,stroke:"black",fillOpacity:1}},label:{interactive:!1,style:{fontSize:{type:"token",key:"l6FontSize"},lineHeight:{type:"token",key:"l6LineHeight"},textBaseline:"middle",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},stroke:{type:"palette",key:"backgroundColor"}}}}},Tt.transformerConstructor=M9;let Te=()=>{M8(),MJ(),h9.registerSeries(Tt.type,Tt),h9.registerImplement("registerMap",dH),h9.registerImplement("unregisterMap",dD),vY()};class Ti extends Ai{_isValidSeries(t){return t===Y.map}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["type","nameField","valueField","map","nameProperty","centroidProperty","nameMap","area","defaultFillColor","showDefaultName"])}transformSpec(t){super.transformSpec(t),t.region.forEach(t=>{t.coordinate="geo"}),super.transformSeriesSpec(t)}}class Tr extends Ah{constructor(){super(...arguments),this.transformerConstructor=Ti,this.type="map",this.seriesType=Y.map}}Tr.type="map",Tr.seriesType=Y.map,Tr.transformerConstructor=Ti;let Tn=()=>{A$(),Te(),h9.registerChart(Tr.type,Tr)};class Tl extends _p{constructor(){super(...arguments),this.coordinate="polar",this._outerRadius=.6,this._innerRadius=0,this._angleField=[],this._radiusField=[],this._sortDataByAxis=!1}get outerRadius(){return this._outerRadius}get innerRadius(){return this._innerRadius}getAngleField(){return this._angleField}setAngleField(t){return this._angleField=(0,aw.Z)(t)?(0,a1.IX)(t):[],this._angleField}getRadiusField(){return this._radiusField}setRadiusField(t){return this._radiusField=(0,aw.Z)(t)?(0,a1.IX)(t):[],this._radiusField}get innerRadiusField(){return this._innerRadiusField}setInnerRadiusField(t){return this._innerRadiusField=(0,a1.IX)(t),this._innerRadiusField}get radiusScale(){return this._radiusScale}setRadiusScale(t){return this._radiusScale=t,t}get angleScale(){return this._angleScale}setAngleScale(t){return this._angleScale=t,t}get angleAxisHelper(){return this._angleAxisHelper}set angleAxisHelper(t){this._angleAxisHelper=t,this.onAngleAxisHelperUpdate()}get radiusAxisHelper(){return this._radiusAxisHelper}set radiusAxisHelper(t){this._radiusAxisHelper=t,this.onRadiusAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getCenter=()=>this.angleAxisHelper.center(),this._markAttributeContext.getLayoutRadius=()=>this._computeLayoutRadius()}valueToPosition(t,e){if((0,nB.Z)(t)||(0,nB.Z)(e)||!this.angleAxisHelper||!this.radiusAxisHelper)return{x:Number.NaN,y:Number.NaN};let i=this.radiusAxisHelper.dataToPosition((0,a1.IX)(e));if(i<0){if("break"===this._invalidType||"link"===this._invalidType)return{x:Number.NaN,y:Number.NaN};if("zero"===this._invalidType)return this.angleAxisHelper.center()}let r=this.angleAxisHelper.dataToPosition((0,a1.IX)(t));return this.angleAxisHelper.coordToPoint({angle:r,radius:i})}dataToPosition(t,e){return t&&this.angleAxisHelper&&this.radiusAxisHelper?e&&!this.isDatumInViewData(t)?null:this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getDatumPositionValues(t,this._radiusField)):null}dataToPositionX(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.x}dataToPositionY(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.y}dataToPositionZ(t){return 0}positionToData(t){}radiusToData(t){}angleToData(t){}getStatisticFields(){var t,e;let i=[];return(null==(t=this.radiusAxisHelper)?void 0:t.getScale)&&this._radiusField.forEach(t=>{let e={key:t,operations:[]};(0,pW.z2)(this.radiusAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],i.push(e)}),(null==(e=this.angleAxisHelper)?void 0:e.getScale)&&this._angleField.forEach(t=>{let e={key:t,operations:[]};(0,pW.z2)(this.angleAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],i.push(e)}),i}setAttrFromSpec(){super.setAttrFromSpec(),(0,aw.Z)(this._spec.outerRadius)&&(this._outerRadius=this._spec.outerRadius),(0,aw.Z)(this._spec.radius)&&(this._outerRadius=this._spec.radius),(0,aw.Z)(this._spec.innerRadius)&&(this._innerRadius=this._spec.innerRadius),(0,aw.Z)(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)}onRadiusAxisHelperUpdate(){this.onMarkPositionUpdate()}onAngleAxisHelperUpdate(){this.onMarkPositionUpdate()}afterInitMark(){super.afterInitMark()}_computeLayoutRadius(){let t=this._angleAxisHelper||this._radiusAxisHelper;if(t)return t.layoutRadius();let{width:e,height:i}=this._region.getLayoutRect();return Math.min(e/2,i/2)}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(J.scaleDomainUpdate,{filter:t=>{var e;return t.model.id===(null==(e=this._angleAxisHelper)?void 0:e.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var t,e;(null==(e=null==(t=this.getViewData())?void 0:t.latestData)?void 0:e.length)&&_f(this.angleAxisHelper,this._angleField[0],this.getViewData().latestData)}getInvalidCheckFields(){let t=[];return this.angleAxisHelper.isContinuous&&this._angleField.forEach(e=>{t.push(e)}),this.radiusAxisHelper.isContinuous&&this._radiusField.forEach(e=>{t.push(e)}),t}}function Ts(t){return hv(t)?Number.parseFloat(t):0}let Ta=(t,e)=>{let{asStartAngle:i,asEndAngle:r,asMiddleAngle:n,asRadian:l,asRatio:s,asQuadrant:a,asK:o,showAllZero:h,supportNegative:d,showEmptyCircle:u}=e,c=e.angleField(),p=e.startAngle(),g=e.endAngle(),f=e.minAngle(),m=t.map(t=>Object.assign({},t));if(!m||0===m.length)return m;if(!h&&u&&To(m,c,d))return[];let y=(t,e,s)=>{t[i]=e,t[r]=e+s,t[n]=e+s/2,t[l]=s,t[a]=(0,iH.tc)(e+s/2)},v=0,b=-1/0,_=!0;for(let t=0;t<m.length;t++){let e=d?Math.abs(Ts(m[t][c])):Ts(m[t][c]);v+=e,b=Math.max(e,b),_&&0!==e&&(_=!1),m[t][xw]=e}let C=m.map(t=>Number(t[c])),x=g-p,w=p,S=x,A=0,M=function(t,e=2){let i=t.reduce((t,e)=>t+(isNaN(e)?0:e),0);if(0===i)return 0;let r=Math.pow(10,e),n=t.map(t=>(isNaN(t)?0:t)/i*r*100),l=100*r,s=n.map(t=>Math.floor(t)),a=s.reduce((t,e)=>t+e,0),o=n.map((t,e)=>t-s[e]);for(;a<l;){let t=Number.NEGATIVE_INFINITY,e=null;for(let i=0;i<o.length;i++)o[i]>t&&(t=o[i],e=i);++s[e],o[e]=0,++a}return s.map(t=>t/r)}(C);if(m.forEach((t,e)=>{let i=t[xw],r=v?i/v:0,n=r*x;n<f?(n=f,S-=f):A+=i;let l=w,a=w+n;t[s]=r,t[o]=b?i/b:0,t._percent_=M[e],y(t,l,n),w=a}),S<x)if(S<=.001){let t=x/m.length;m.forEach((e,i)=>{y(e,p+i*t,t)})}else{let t=S/A;w=p,m.forEach(e=>{let i=e[l]===f?f:e[xw]*t;y(e,w,i),w+=i})}if(0!==v&&(m[m.length-1][r]=g),_&&h){let t=x/m.length;m.forEach((e,i)=>{y(e,p+i*t,t)})}return m},To=(t,e,i)=>!!(0,nB.Z)(t)||0===t.length||!!t.every(t=>0===Ts(t[e]))||!i&&0===t.reduce((t,i)=>t+Ts(i[e]),0);function Th(t,e,i){return(r,n,l)=>e?"radius"===t.growField?{overall:0}:{overall:t.growFrom(r,n,i)}:{overall:!1}}let Td=t=>({type:"radius"===t.growField?"growRadiusIn":"growAngleIn",options:Th(t,!0,tr.appear)}),Tu={type:"fadeIn"},Tc=t=>({type:"radius"===t.growField?"growRadiusIn":"growAngleIn",easing:"linear",options:Th(t,!0,tr.enter)}),Tp=t=>({type:"radius"===t.growField?"growRadiusOut":"growAngleOut",easing:"linear",options:Th(t,!0,tr.exit)}),Tg=t=>({type:"radius"===t.growField?"growRadiusOut":"growAngleOut",options:Th(t,!0,tr.exit)});function Tf(t,e){if(!1===e)return{};switch(e){case"fadeIn":return Tu;case"growRadius":return Td(Object.assign(Object.assign({},t),{growField:"radius"}));default:return Td(Object.assign(Object.assign({},t),{growField:"angle"}))}}let Tm=()=>{h9.registerAnimation("pie",(t,e)=>({appear:Tf(t,e),enter:Tc(t),exit:Tp(t),disappear:{duration:vV.disappear.duration}}))},Ty=()=>{h9.registerAnimation("emptyCircle",(t,e)=>({appear:Tf(t,e)}))};var Tv=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Tb{constructor(t,e,i,r,n,l,s,a,o){this.refDatum=t,this.center=e,this.outerCenter=i,this.quadrant=r,this.radian=n,this.middleAngle=l,this.innerRadius=s,this.outerRadius=a,this.circleCenter=o,this.labelVisible=!0}getLabelBounds(){return this.labelPosition&&this.labelSize?{x1:this.labelPosition.x-this.labelSize.width/2,y1:this.labelPosition.y-this.labelSize.height/2,x2:this.labelPosition.x+this.labelSize.width/2,y2:this.labelPosition.y+this.labelSize.height/2}:{x1:0,x2:0,y1:0,y2:0}}}class T_ extends CL{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,h3.Z)({},T_.defaultAttributes,Tv(t,["data"])))),this.name="arc-label",this._ellipsisWidth=0,this._arcLeft=new Map,this._arcRight=new Map,this._line2MinLength=0,this._alignOffset=0}_overlapping(t){return["inside","inside-center"].includes(this.attribute.position)?super._overlapping(t):t}labeling(t,e,i="outside",r=0){if(t&&e)return{x:0,y:0}}_layout(t){var e,i,r;if(!t||!t.length)return[];let n=super._layout(t),l=n.map(t=>this.getGraphicBounds(t)),s=Object.assign(Object.assign({},this.attribute.textStyle),{text:"…"}),a=1/0;if(!1!==s.ellipsis){let t=this._createLabelText(s),e=this.getGraphicBounds(t);a=e.x2-e.x1}let o=n.map(t=>t.attribute),h=Array.from(this._idToGraphic.values());this._line2MinLength=(0,nz.Z)(this.attribute.line.line2MinLength)?this.attribute.line.line2MinLength(t,h,this.attribute):this.attribute.line.line2MinLength,this._alignOffset=null!=(e=(0,nz.Z)(this.attribute.layout.alignOffset)?this.attribute.layout.alignOffset(t,h,this.attribute):this.attribute.layout.alignOffset)?e:0;let d=this.layoutArcLabels(this.attribute.position,this.attribute,h,o,l,a);for(let t=0;t<o.length;t++){let e=o[t],l=d.find(t=>{var i;return(null==(i=t.refDatum)?void 0:i.id)===e.id});if(l){let e={visible:l.labelVisible,x:l.labelPosition.x,y:l.labelPosition.y,angle:l.angle,points:l.pointA&&l.pointB&&l.pointC?[l.pointA,l.pointB,l.pointC]:void 0,line:l.labelLine};"richtext"===n[t].type?e.width=null!=(i=l.labelLimit)?i:n[t].attribute.width:e.maxLineWidth=null!=(r=l.labelLimit)?r:n[t].attribute.maxLineWidth,l.refArc&&"arc3d"===l.refArc.type&&(e.anchor3d=[l.circleCenter.x-e.x,l.circleCenter.y-e.y],e.beta=l.refArc.attribute.beta),n[t].setAttributes(e)}}return n}layoutArcLabels(t,e,i,r,n,l){this._arcLeft.clear(),this._arcRight.clear(),this._ellipsisWidth=l;let s=0;i.forEach(t=>{t.attribute.outerRadius>s&&(s=t.attribute.outerRadius)}),r.forEach((t,i)=>{var l,a,o;let h=this._idToGraphic.get(t.id),d=h.getAttributes(!0),u={x:null!=(l=null==d?void 0:d.x)?l:0,y:null!=(a=null==d?void 0:d.y)?a:0};if(!(0,nB.Z)(r[i])&&!(0,nB.Z)(n[i])){let t=r[i]?r[i]:null,l=n[i]?n[i]:{x1:0,x2:0,y1:0,y2:0},a=(d.startAngle+d.endAngle)/2,c=d.endAngle-d.startAngle,p=(0,iH.tc)(d.endAngle-c/2),g=new Tb(t,(0,iH.op)(u,d.outerRadius,a),(0,iH.op)(u,s+e.line.line1MinLength,a),p,c,a,d.innerRadius,d.outerRadius,u);g.refArc=h,g.pointA=(0,iH.op)(u,this.computeDatumRadius(2*u.x,2*u.y,d.outerRadius),g.middleAngle),g.labelSize={width:l.x2-l.x1,height:l.y2-l.y1},1===(o=g.quadrant)||2===o?this._arcRight.set(g.refDatum,g):Ct(g.quadrant)&&this._arcLeft.set(g.refDatum,g)}});let a=Array.from(this._arcLeft.values()),o=Array.from(this._arcRight.values()),h=[];switch(t){case"inside":case"inside-inner":case"inside-outer":case"inside-center":h.push(...this._layoutInsideLabels(o,e,i)),h.push(...this._layoutInsideLabels(a,e,i));break;default:h.push(...this._layoutOutsideLabels(o,e,i)),h.push(...this._layoutOutsideLabels(a,e,i))}return h}_layoutInsideLabels(t,e,i){var r,n;let l=e.spaceWidth,s=null!=(r=e.position)?r:"inside",a=null!=(n=e.offsetRadius)?n:-l;return t.forEach(t=>{var i,r,n,o;let h,{labelSize:d,radian:u}=t,c=t.innerRadius,p=t.outerRadius;h=u<((o=d.height)>2*p?NaN:2*Math.asin(o/2/p))?0:p-(u>=Math.PI?c:Math.max(c,d.height/2/Math.tan(u/2)))-l,!0!==e.rotate&&(h=p-l);let g=this._getFormatLabelText(t.refDatum,h);t.labelText=g;let f=Math.min(h,t.labelSize.width),m=this._computeAlign(t,e),y,v=0;if("inside"===s&&(v="left"===m?f:"right"===m?0:f/2),y="inside-inner"===s?c-a+v:"inside-center"===s?c+(p-c)/2:p+a-v,t.labelPosition=(0,iH.op)(t.circleCenter,y,t.middleAngle),t.labelLimit=f,(0,ng.Vy)(f,0)||(t.labelVisible=!1),!1!==e.rotate){t.angle=null!=(r=null==(i=e.textStyle)?void 0:i.angle)?r:t.middleAngle;let l=null!=(n=e.offsetAngle)?n:0;["inside-inner","inside-outer"].includes(s)&&(l+=Math.PI/2),t.angle+=l}}),t}_layoutOutsideLabels(t,e,i){var r,n,l;let s=null!=(r=i[0].attribute.x)?r:0,a=2*(null!=(n=i[0].attribute.y)?n:0),o=e.layout,h=e.spaceWidth;if(t.forEach(t=>{let e=Ct(t.quadrant)?-1:1;t.labelPosition={x:t.outerCenter.x+e*(t.labelSize.width/2+this._line2MinLength+h),y:t.outerCenter.y}}),t.sort((t,e)=>t.labelPosition.y-e.labelPosition.y),!1!==e.coverEnable||"none"===o.strategy){for(let r of t){let{labelPosition:t,labelSize:n}=r;r.labelLimit=n.width,r.pointB=Ct(r.quadrant)?{x:t.x+n.width/2+this._line2MinLength+h,y:t.y}:{x:t.x-n.width/2-this._line2MinLength-h,y:t.y},this._computeX(r,e,i)}!1===e.coverEnable&&"none"===o.strategy&&this._coverLabels(t)}else{let r=a/((null==(l=e.textStyle)?void 0:l.fontSize)||16);this._adjustY(t,r,e,i);let{minY:n,maxY:s}=t.reduce((t,e)=>{let{y1:i,y2:r}=e.getLabelBounds();return t.minY=Math.max(0,Math.min(i,t.minY)),t.maxY=Math.min(a,Math.max(r,t.maxY)),t},{minY:1/0,maxY:-1/0}),o=Math.max(Math.abs(a/2-n),Math.abs(s-a/2)),h=this._computeLayoutRadius(o,e,i);for(let r of t)this._computePointB(r,h,e,i),this._computeX(r,e,i)}let d=2*s;return t.forEach(t=>{var i,r;t.labelVisible&&((0,ng.SQ)(t.pointB.x,this._line2MinLength+h)||(0,ng.Vy)(t.pointB.x,d-this._line2MinLength-h))&&(t.labelVisible=!1),t.angle=null!=(r=null==(i=e.textStyle)?void 0:i.angle)?r:0,e.offsetAngle&&(t.angle+=e.offsetAngle),t.labelLine=Object.assign(Object.assign({},e.line),{visible:t.labelVisible})}),t}_computeX(t,e,i){var r,n;let l=t.circleCenter,s=this.attribute.width;this.attribute.height;let a=0;i.forEach(t=>{t.getAttributes(!0).outerRadius>a&&(a=t.getAttributes(!0).outerRadius)});let o=this.computeLayoutOuterRadius(a,e.width,e.height),h=e.line.line1MinLength,d=null==(r=e.layout)?void 0:r.align,u=e.spaceWidth,{labelPosition:c,quadrant:p,pointB:g}=t;(0,hy.Z)(g.x*g.y)||(t.pointC={x:NaN,y:NaN},c.x=NaN,t.labelLimit=0);let f=this.computeRadius(o,e.width,e.height),m=Ct(p)?-1:1,y=0,v=(m>0?s-g.x:g.x-0)+this._alignOffset-this._line2MinLength-u;"labelLine"===d&&(y=(f+h+this._line2MinLength)*m+l.x,v=(m>0?s-y:y-0)-u);let b=this._getFormatLabelText(t.refDatum,v);t.labelText=b;let _=Math.min(v,t.labelSize.width);switch(d){case"labelLine":break;case"edge":y=m>0?s-_-u:0+_+u;break;default:y=g.x+m*this._line2MinLength}let C=(_=Math.max(this._ellipsisWidth,_))<t.labelSize.width-1;t.labelLimit=C?_:null,t.pointC={x:y,y:c.y};let x=("left"===(n=this._computeAlign(t,e))?0:"right"===n?1:.5)*(C?_:t.labelSize.width);"edge"===d?(c.x=(m>0?s:0)-m*x+m*this._alignOffset,t.pointC.x+=m*this._alignOffset):c.x=y+m*(this._alignOffset+u+x)}_computeAlign(t,e){var i,r,n,l,s,a;let o=null!=(r=null==(i=e.textStyle)?void 0:i.textAlign)?r:null==(n=e.textStyle)?void 0:n.align,h=null!=(s=null==(l=e.layout)?void 0:l.textAlign)?s:null==(a=e.layout)?void 0:a.align;return"inside"!==e.position?(0,nB.Z)(o)||"auto"===o?"edge"===h?Ct(t.quadrant)?"left":"right":Ct(t.quadrant)?"right":"left":o:(0,nB.Z)(o)||"auto"===o?"center":o}_getFormatLabelText(t,e){var i;return null!=(i=null==t?void 0:t.text)?i:""}_adjustY(t,e,i,r){var n;r[0].attribute.x;let l=2*(null!=(n=r[0].attribute.y)?n:0),s=i.layout;if("vertical"===s.strategy){let e,i=0,r=t.length;if(r<=0)return;for(let n=0;n<r;n++){let{y1:l}=t[n].getLabelBounds();if(e=l-i,(0,ng.SQ)(e,0)){let i=this._shiftY(t,n,r-1,-e);this._shiftY(t,i,0,e/2)}let{y2:s}=t[n].getLabelBounds();i=s}let{y1:n}=t[0].getLabelBounds();e=n-0,(0,ng.SQ)(e,0)&&this._shiftY(t,0,r-1,-e);for(let e=t.length-1;e>=0&&t[e].getLabelBounds().y2>l;e--)t[e].labelVisible=!1}else if("none"!==s.strategy){let n=t.map((t,e)=>({arc:t,originIndex:e,priorityIndex:0}));n.sort((t,e)=>e.arc.radian-t.arc.radian),n.forEach((t,e)=>{t.priorityIndex=e,t.arc.labelVisible=!1});let a=1/0,o=-1/0;for(let h=0;h<e&&h<t.length;h++){let e;this._storeY(t);let d=n[h].arc;this._computeYRange(d,i,r),d.labelVisible=!0;let u=d.labelPosition.y,{lastIndex:c,nextIndex:p}=this._findNeighborIndex(t,n[h]),g=t[c],f=t[p];if(-1===c&&-1!==p){let e=f.labelPosition.y;u>e?d.labelPosition.y=e-f.labelSize.height/2-d.labelSize.height/2:this._twoWayShift(t,d,f,p)}else if(-1!==c&&-1===p){let e=g.labelPosition.y;u<e?d.labelPosition.y=e+g.labelSize.height/2+d.labelSize.height/2:this._twoWayShift(t,g,d,n[h].originIndex)}else if(-1!==c&&-1!==p){let e=g.labelPosition.y,i=f.labelPosition.y;u>i?(d.labelPosition.y=i-f.labelSize.height/2-d.labelSize.height/2,this._twoWayShift(t,g,d,n[h].originIndex)):(u<e?d.labelPosition.y=e+g.labelSize.height/2+d.labelSize.height/2:this._twoWayShift(t,g,d,n[h].originIndex),this._twoWayShift(t,d,f,p))}let m=Math.min(a,n[h].originIndex),y=Math.max(o,n[h].originIndex);if(e=t[y].getLabelBounds().y2-l,(0,ng.Vy)(e,0)&&this._shiftY(t,y,0,-e),e=t[m].getLabelBounds().y1-0,(0,ng.SQ)(e,0)&&this._shiftY(t,m,t.length-1,-e),e=t[y].getLabelBounds().y2-l,(0,ng.Vy)(e,0)){d.labelVisible=!1,this._restoreY(t);break}s.tangentConstraint&&!this._checkYRange(t)?(d.labelVisible=!1,this._restoreY(t)):(a=m,o=y)}}}_shiftY(t,e,i,r){let n=e<i?1:-1,l=e;for(;-1!==l;){t[l].labelPosition.y+=r;let e=this._findNextVisibleIndex(t,l,i,n);if(e>=0&&e<t.length){let{y1:i,y2:r}=t[l].getLabelBounds(),{y1:s,y2:a}=t[e].getLabelBounds();if(n>0&&r<s||n<0&&i>a)return l}l=e}return i}_findNextVisibleIndex(t,e,i,r){let n=(i-e)*r;for(let i=1;i<=n;i++){let n=e+i*r;if(t[n].labelVisible)return n}return -1}_computePointB(t,e,i,r){let n=0;r.forEach(t=>{t.getAttributes(!0).outerRadius>n&&(n=t.getAttributes(!0).outerRadius)});let l=this.computeLayoutOuterRadius(n,i.width,i.height),s=i.line.line1MinLength;if("none"===i.layout.strategy)t.pointB={x:t.outerCenter.x,y:t.outerCenter.y};else{let r=t.circleCenter,n=this.computeRadius(l,i.width,i.height),{labelPosition:a,quadrant:o}=t,h=e-Math.max(n+s,t.outerRadius),d=Math.sqrt(e**2-Math.abs(r.y-a.y)**2)-h;(0,hy.Z)(d)?t.pointB={x:r.x+d*(Ct(o)?-1:1),y:a.y}:t.pointB={x:NaN,y:NaN}}}_storeY(t){for(let e of t)e.labelVisible&&(e.lastLabelY=e.labelPosition.y)}_computeYRange(t,e,i){let r,n,l,s,a,o=t.circleCenter,h={width:2*o.x,height:2*o.y},d=0;i.forEach(t=>{t.getAttributes(!0).outerRadius>d&&(d=t.getAttributes(!0).outerRadius)});let u=this.computeLayoutOuterRadius(d,e.width,e.height),c=e.line.line1MinLength,{width:p,height:g}=h,f=this.computeRadius(u,e.width,e.height),m=this._computeLayoutRadius(g/2,e,i),y=Math.abs(t.center.x-p/2),v=t.center.y-g/2;if((0,ng.Yt)(p/2,y))r=0,n=1,l=-v;else if((0,ng.Yt)(g/2,v))r=1,n=0,l=-y;else{let t=-1/(v/y);r=t,n=-1,l=v-t*y}let b=function(t,e,i,r,n,l){if(0===t&&0===e||l<=0)return[];if(0===t){let t=-i/e,n=l**2-(t-0)**2;return n<0?[]:0===n?[{x:r,y:t}]:[{x:Math.sqrt(n)+r,y:t},{x:-Math.sqrt(n)+r,y:t}]}if(0===e){let e=-i/t,s=l**2-(e-r)**2;return s<0?[]:0===s?[{x:e,y:0}]:[{x:e,y:Math.sqrt(s)+n},{x:e,y:-Math.sqrt(s)+n}]}let s=(e/t)**2+1,a=2*(e/t*(i/t+r)-n),o=a**2-4*s*((i/t+r)**2+n**2-l**2);if(o<0)return[];let h=(-a+Math.sqrt(o))/(2*s),d=(-a-Math.sqrt(o))/(2*s),u=-(e*h+i)/t;return 0===o?[{x:u,y:h}]:[{x:u,y:h},{x:-(e*d+i)/t,y:d}]}(r,n,l,c+f-m,0,m);b.length<2||(b[0].x>b[1].x&&b.reverse(),b[0].x<0?(0,ng.Yt)(b[0].y,b[1].y)?(0,ng.Vy)(t.middleAngle,-Math.PI)&&(0,ng.SQ)(t.middleAngle,0)||(0,ng.Vy)(t.middleAngle,Math.PI)&&(0,ng.SQ)(t.middleAngle,2*Math.PI)?(s=0,a=b[1].y+g/2):(s=b[1].y+g/2,a=g):b[0].y<b[1].y?(s=0,a=b[1].y+g/2):(s=b[1].y+g/2,a=h.height):(s=Math.min(b[0].y,b[1].y)+g/2,a=Math.max(b[0].y,b[1].y)+g/2),t.labelYRange=[s,a])}_computeLayoutRadius(t,e,i){let r=e.layoutArcGap,n=e.line.line1MinLength,l=0;i.forEach(t=>{t.getAttributes(!0).outerRadius>l&&(l=t.getAttributes(!0).outerRadius)});let s=this.computeLayoutOuterRadius(l,e.width,e.height),a=this.computeRadius(s,e.width,e.height)+n,o=a-r;return Math.max((o**2+t**2)/(2*o),a)}_findNeighborIndex(t,e){let i=e.originIndex,r=-1,n=-1;for(let e=i-1;e>=0;e--)if(t[e].labelVisible){r=e;break}for(let e=i+1;e<t.length;e++)if(t[e].labelVisible){n=e;break}return{lastIndex:r,nextIndex:n}}_twoWayShift(t,e,i,r){let n=i.getLabelBounds().y1-e.getLabelBounds().y2;if((0,ng.SQ)(n,0)){let e=this._shiftY(t,r,t.length-1,-n);this._shiftY(t,e,0,n/2)}}_restoreY(t){for(let e of t)e.labelVisible&&(e.labelPosition.y=e.lastLabelY)}_checkYRange(t){for(let e of t){let{labelYRange:t,labelPosition:i}=e;if(e.labelVisible&&t&&((0,ng.SQ)(i.y,t[0])||(0,ng.Vy)(i.y,t[1])))return!1}return!0}_coverLabels(t){if(t.length<=1)return;let e=t[0].getLabelBounds();for(let i=1;i<t.length;i++){let r=t[i].getLabelBounds();!function(t,e){let{x1:i,y1:r,x2:n,y2:l}=t,{x1:s,y1:a,x2:o,y2:h}=e;return!(i<=s&&n<=s||i>=o&&n>=o||r<=a&&l<=a||r>=h&&l>=h)}(e,r)?e=r:t[i].labelVisible=!1}}_getLabelLinePoints(t,e){return t.attribute.points}_createLabelLine(t,e){var i,r,n,l,s;let{line:a={},visible:o}=t.attribute,h=super._createLabelLine(t,e);if(h&&(h.setAttributes({visible:null==(n=null!=(i=a.visible&&o)?i:null==(r=t.attribute)?void 0:r.visible)||n,lineWidth:null!=(s=null==(l=a.style)?void 0:l.lineWidth)?s:1}),a.smooth&&h.setAttributes({curveType:"basis"}),"arc3d"===e.type&&e)){let{beta:t,x:i,y:r}=e.getAttributes(!0);h.setAttributes({beta:t,anchor3d:[i,r]})}return h}computeRadius(t,e,i,r){return this.computeLayoutRadius(e||0,i||0)*t*((0,nB.Z)(r)?1:r)}computeLayoutRadius(t,e){return Math.min(t/2,e/2)}_canPlaceInside(t,e){return"inside"===this.attribute.position||"inside-center"===this.attribute.position}computeLayoutOuterRadius(t,e,i){return t/(Math.min(e,i)/2)}computeDatumRadius(t,e,i){let r=this.computeLayoutOuterRadius(i,t,e);return this.computeLayoutRadius(t||0,e||0)*r}}T_.defaultAttributes={coverEnable:!1,spaceWidth:5,layoutArcGap:6,textStyle:{visible:!0,fontSize:14,fontWeight:"normal",fillOpacity:1,boundsPadding:[-1,0,-1,0],ellipsis:!0},position:"outside",line:{visible:!0,line1MinLength:20,line2MinLength:10},layout:{align:"arc",strategy:"priority",tangentConstraint:!0}};let TC=()=>{CO("arc",T_)};class Tx extends gW{constructor(t,e){super(t,e),this.type=Tw.type,this._unCompileChannel={centerOffset:!0,radiusOffset:!0},this.computeOuterRadius=(t,e,i="normal",r)=>{var n;return r+(null!=(n=this.getAttribute("radiusOffset",e,i))?n:0)},this.computeCenter=(t,e,i="normal",r)=>(0,iH.op)({x:0,y:0},this.getAttribute("centerOffset",e,i),e[xk])[t]+r,this._computeExChannel.x=this.computeCenter,this._computeExChannel.y=this.computeCenter,this._computeExChannel.outerRadius=this.computeOuterRadius,this._extensionChannel.centerOffset=["x","y"],this._extensionChannel.radiusOffset=["outerRadius"]}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{startAngle:0,endAngle:0,outerRadius:0,innerRadius:0,cornerRadius:0,lineWidth:0,innerPadding:0,outerPadding:0})}}class Tw extends Tx{constructor(){super(...arguments),this.type=Tw.type}}Tw.type="arc";let TS=()=>{gG(),Sl(),TC(),v2(),h9.registerGraphicComponent("arc",w6),h9.registerMark(Tw.type,Tw)},TA=Object.assign(Object.assign({},b7),{pie:{name:"pie",type:"arc"},labelLine:{name:"labelLine",type:"path"}});class TM extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"pie")}_mergeThemeToSpec(t,e){let i=this._theme,r=t;if(this._shouldMergeThemeToSpec()){let i=this._getDefaultSpecFromChart(e);r=h5({},this._theme,i,t);let n=(t,e)=>h5({},"inside"===t||"inside-center"===t?this._theme.innerLabel:this._theme.outerLabel,e);(0,rD.Z)(r.label)?r.label=r.label.map(t=>n(t.position,t)):r.label=n(r.label.position,r.label)}return{spec:r,theme:i}}_getDefaultSpecFromChart(t){var e;let i=null!=(e=super._getDefaultSpecFromChart(t))?e:{},{centerX:r,centerY:n}=t;return(0,aw.Z)(r)&&(i.centerX=r),(0,aw.Z)(n)&&(i.centerY=n),Object.keys(i).length>0?i:void 0}}let TT=`${d9}_LABEL_VISIBLE`;class Tk extends Tl{constructor(){super(...arguments),this.transformerConstructor=TM,this._pieMarkName="pie",this._pieMarkType="arc",this.getCenter=()=>{var t,e;let i=this._region.getLayoutRect();return{x:hw(null==(t=this._spec)?void 0:t.centerX,i.width,i,i.width/2),y:hw(null==(e=this._spec)?void 0:e.centerY,i.height,i,i.height/2)}},this._startAngle=xB,this._endAngle=xI,this._pieMark=null,this._labelMark=null,this._labelLineMark=null,this._emptyArcMark=null,this.dataToCentralPosition=t=>{let e=t[xk];if((0,nB.Z)(e))return null;let i=this.computeDatumRadius(t),r=this.computeDatumInnerRadius(t),n=this.computeCenter(t);return(0,iH.op)(n,(i+r)/2,e)}}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.getCenter().x,y:()=>this.getCenter().y}),this._markAttributeContext.startAngleScale=t=>this.startAngleScale(t),this._markAttributeContext.endAngleScale=t=>this.endAngleScale(t)}setAttrFromSpec(){var t,e,i,r,n,l;super.setAttrFromSpec(),this._centerOffset=null!=(t=this._spec.centerOffset)?t:0,this._cornerRadius=null!=(e=this._spec.cornerRadius)?e:0;let s=function(t,e){let i=0,r=2*Math.PI,n=(0,aw.Z)(t),l=(0,aw.Z)(e);for(n||l?l?(i=n?t:e-2*Math.PI,r=e):(i=t,r=t+2*Math.PI):(i=0,r=2*Math.PI);r<=i;)r+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI,r-=2*Math.PI;for(;r<0;)i+=2*Math.PI,r+=2*Math.PI;return{startAngle:i,endAngle:r}}((0,aw.Z)(this._spec.startAngle)?(0,iH.M4)(this._spec.startAngle):this._startAngle,(0,aw.Z)(this._spec.endAngle)?(0,iH.M4)(this._spec.endAngle):this._endAngle);this._startAngle=s.startAngle,this._endAngle=s.endAngle,this._padAngle=(0,aw.Z)(this._spec.padAngle)?(0,iH.M4)(this._spec.padAngle):0,this.setAngleField(this._spec.valueField||this._spec.angleField),this._spec.categoryField&&this.setSeriesField(this._spec.categoryField),this._radiusField=[],this._specAngleField=this._angleField.slice(),this._specRadiusField=[],this._showEmptyCircle=null!=(r=null==(i=this._spec.emptyPlaceholder)?void 0:i.showEmptyCircle)&&r,this._showAllZero=null!=(n=this._spec.showAllZero)&&n,this._supportNegative=null!=(l=this._spec.supportNegative)&&l}initData(){super.initData();let t=this.getViewData();if(!t)return;dL(this._dataSet,"pie",Ta),t.transform({type:"pie",options:{angleField:()=>this._angleField[0],startAngle:()=>this._startAngle,endAngle:()=>this._endAngle,minAngle:()=>(0,aw.Z)(this._spec.minAngle)?(0,iH.M4)(this._spec.minAngle):0,asStartAngle:xA,asEndAngle:xM,asRatio:xS,asMiddleAngle:xk,asRadian:xP,asQuadrant:xR,asK:xT,showAllZero:this._showAllZero,supportNegative:this._supportNegative,showEmptyCircle:this._showEmptyCircle}},!1);let e=new eq.V(this._dataSet,{name:`${d9}_series_${this.id}_viewDataLabel`});e.parse([this.getViewData()],{type:"dataview"}),this._viewDataLabel=new pV(this._option,e)}compileData(){var t;super.compileData(),null==(t=this._viewDataLabel)||t.compile()}initMark(){this._pieMark=this._createMark(Object.assign(Object.assign({},Tk.mark.pie),{name:this._pieMarkName,type:this._pieMarkType}),{key:un,groupKey:this._seriesField,isSeriesMark:!0},{morph:_h(this._spec,this._pieMarkName),morphElementKey:this._seriesField}),this._showEmptyCircle&&(this._emptyArcMark=this._createMark({name:"emptyCircle",type:"arc"},{dataView:!1}),this._data.addRelatedMark(this._emptyArcMark))}startAngleScale(t){return hu(xA)(t)}endAngleScale(t){return hu(xM)(t)}_computeLayoutRadius(){return xL(()=>this._spec.layoutRadius,this.getLayoutRect,this.getCenter,()=>({startAngle:this._startAngle,endAngle:this._endAngle}))}initMarkStyle(){let t={x:()=>this.getCenter().x,y:()=>this.getCenter().y,fill:this.getColorAttribute(),outerRadius:pH(this._outerRadius)?this._outerRadius:()=>this._computeLayoutRadius()*this._outerRadius,innerRadius:pH(this._innerRadius)?this._innerRadius:()=>this._computeLayoutRadius()*this._innerRadius,cornerRadius:()=>this._computeLayoutRadius()*this._cornerRadius,startAngle:t=>this.startAngleScale(t),endAngle:t=>this.endAngleScale(t),padAngle:this._padAngle,centerOffset:this._centerOffset},e=this._pieMark;e&&this.setMarkStyle(e,t,"normal",to.Series);let i=this._emptyArcMark;i&&this.setMarkStyle(i,Object.assign(Object.assign({},t),{visible:()=>{let t=this.getViewData().latestData;return!t||!t.length}}),"normal",to.Series)}getInteractionTriggers(){return this._parseInteractionConfig(this._pieMark?[this._pieMark]:[])}initTooltip(){super.initTooltip(),this._pieMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pieMark)}initMarkStyleWithSpec(t,e){if(super.initMarkStyleWithSpec(t,e),t.name===this._pieMarkName){let e=this.getSpec()[t.name];if(e)for(let i in e.state||{})this.setMarkStyle(t,this.generateRadiusStyle(e.state[i]),i,to.User_Mark)}"emptyCircle"===t.name&&this.setMarkStyle(t,this.generateRadiusStyle(e.style),"normal",to.User_Mark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{visible:hu(TT).bind(this),text:t=>t[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:this.dataToPositionZ.bind(this)})}afterInitMark(){super.afterInitMark()}initEvent(){var t;super.initEvent(),null==(t=this._viewDataLabel.getDataView())||t.target.addListener("change",this.viewDataLabelUpdate.bind(this))}initGroups(){}onLayoutEnd(){this._viewDataLabel.getDataView().reRunAllTransform(),this.onMarkPositionUpdate(),super.onLayoutEnd()}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return this._specAngleField}viewDataLabelUpdate(){this.event.emit(J.viewDataLabelUpdate,{model:this}),this._viewDataLabel.updateData()}generateRadiusStyle(t){if(!t)return;let e={};return t.outerRadius&&(e.outerRadius=()=>this._computeLayoutRadius()*t.outerRadius),t.innerRadius&&(e.innerRadius=()=>this._computeLayoutRadius()*t.innerRadius),t.cornerRadius&&(e.cornerRadius=()=>this._computeLayoutRadius()*t.cornerRadius),e}computeCenter(t){return{x:this._pieMark.getAttribute("x",t,"normal"),y:this._pieMark.getAttribute("y",t,"normal")}}getRadius(t="normal"){var e,i,r,n,l,s,a;let o="normal"===t?null==(r=null==(i=this.getSpec()[(null==(e=this._pieMark)?void 0:e.name)||"pie"])?void 0:i.style)?void 0:r.outerRadius:null==(a=null==(s=null==(l=this.getSpec()[(null==(n=this._pieMark)?void 0:n.name)||"pie"])?void 0:l.state)?void 0:s[t])?void 0:a.outerRadius;return null!=o?o:this._outerRadius}getInnerRadius(t="normal"){var e,i,r,n,l,s,a;let o="normal"===t?null==(r=null==(i=this.getSpec()[(null==(e=this._pieMark)?void 0:e.name)||"pie"])?void 0:i.style)?void 0:r.innerRadius:null==(a=null==(s=null==(l=this.getSpec()[(null==(n=this._pieMark)?void 0:n.name)||"pie"])?void 0:l.state)?void 0:s[t])?void 0:a.innerRadius;return null!=o?o:this._innerRadius}computeRadius(t,e){return this._computeLayoutRadius()*t*((0,nB.Z)(e)?1:e)+this._centerOffset}computeDatumRadius(t,e){return this._computeLayoutRadius()*this.getRadius(e)+this._centerOffset}_compareSpec(t,e,i){i=null!=i?i:{data:!0};let r=["centerX","centerY","centerOffset","radius","innerRadius","cornerRadius","startAngle","endAngle","padAngle"];r.forEach(t=>{i[t]=!0});let n=super._compareSpec(t,e,i);return t=null!=t?t:{},r.some(i=>t[i]!==e[i])&&(n.reRender=!0,n.change=!0),n}computeDatumInnerRadius(t,e){return this._computeLayoutRadius()*this.getInnerRadius(e)+this._centerOffset}dataToPosition(t,e){let i=t[xk];if((0,nB.Z)(i)||e&&!this.isDatumInViewData(t))return null;let r=this.computeDatumRadius(t),n=this.computeCenter(t);return(0,iH.op)(n,r,i)}initAnimation(){var t,e,i;let r={growFrom:(t,e,i)=>{var r,n;if(i===tr.appear)return this._startAngle;if(i===tr.disappear)return this._endAngle;let l=[tr.disappear,tr.exit],s=this._pieMark.getGraphics(),a=null==t?void 0:t[ur];if(void 0===s.find(t=>{var e;return(null==(e=t.context.data[0])?void 0:e[ur])<a}))return this._startAngle;if(void 0===s.find(t=>{var e;return(null==(e=t.context.data[0])?void 0:e[ur])>a}))return this._endAngle;let o=[...s].reverse().find(t=>{var e;return(null==(e=t.context.data[0])?void 0:e[ur])<a});return l.includes(i)?null==(r=null==o?void 0:o.getFinalAttribute())?void 0:r.endAngle:null==(n=null==o?void 0:o.attribute)?void 0:n.endAngle}},n=null==(t=this._spec.animationAppear)?void 0:t.preset;if(this._pieMark){let t=_l(null==(e=h9.getAnimationInKey("pie"))?void 0:e(r,n),_s("pie",this._spec,this._markAttributeContext));t.normal&&t.normal.type&&(t.normal=function(t,e){var i,r,n,l;let s=null!=(r=null==(i=e.options)?void 0:i.distance)?r:10,a=(0,hy.Z)(e.duration)?e.duration/2:1e3,o=null!=(n=e.options.easing)?n:"cubicOut";return{oneByOne:e.oneByOne,loop:null!=(l=e.loop)&&l,timeSlices:[{duration:a,effects:{easing:o,channel:{x:{from:e=>t.getAttribute("x",e),to:e=>t.getAttribute("x",e)+(0,iH.op)({x:0,y:0},s,e[xk]).x},y:{from:e=>t.getAttribute("y",e),to:e=>t.getAttribute("y",e)+(0,iH.op)({x:0,y:0},s,e[xk]).y}}}},{duration:a,effects:{easing:o,channel:{x:{to:e=>t.getAttribute("x",e),from:e=>t.getAttribute("x",e)+(0,iH.op)({x:0,y:0},s,e[xk]).x},y:{to:e=>t.getAttribute("y",e),from:e=>t.getAttribute("y",e)+(0,iH.op)({x:0,y:0},s,e[xk]).y}}}}]}}(this._pieMark,t.normal)),this._pieMark.setAnimationConfig(t)}if(this._emptyArcMark){let t=_l(null==(i=h9.getAnimationInKey("emptyCircle"))?void 0:i(r,null!=n?n:"fadeIn"));this._emptyArcMark.setAnimationConfig(t)}}getDefaultShapeType(){return"circle"}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(t,e){return e}getActiveMarks(){return[this._pieMark]}}Tk.transformerConstructor=TM,Tk.mark=TA,Tk.builtInTheme={pie:{outerRadius:.6,pie:{style:{fillOpacity:1}},label:{visible:!1,interactive:!0,position:"outside",style:{fontWeight:"normal",stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1}},innerLabel:{style:{lineWidth:2}},emptyCircle:{style:{fill:{type:"palette",key:"emptyCircleColor"},fillOpacity:1}}}};class TR extends Tk{constructor(){super(...arguments),this.type=Y.pie}}TR.type=Y.pie;let TP=()=>{TS(),Tm(),Ty(),h9.registerSeries(TR.type,TR)};class TB extends Ai{_isValidSeries(t){return!this.seriesType||t===this.seriesType}getIndicatorSpec(t){var e,i,r;let n=(0,a1.IX)(t.indicator),l=null!=(e=t.innerRadius)?e:null==(r=null==(i=t.series)?void 0:i[0])?void 0:r.innerRadius;return(0,aw.Z)(l)&&n.forEach(t=>{(0,nB.Z)(t.limitRatio)&&(t.limitRatio=l)}),n}_getDefaultSeriesSpec(t,e){return super._getDefaultSeriesSpec(t,["radius","outerRadius","innerRadius","startAngle","endAngle","sortDataByAxis"],e)}transformSpec(t){super.transformSpec(t),(0,rD.Z)(t.dataZoom)&&t.dataZoom.length>0&&t.dataZoom.forEach(t=>{"axis"===t.filterMode&&(t.filterMode="filter")}),this.transformSeriesSpec(t),(0,aw.Z)(t.indicator)&&(t.indicator=this.getIndicatorSpec(t))}}class TI extends TB{needAxes(){return!1}_getDefaultSeriesSpec(t){var e;let i=super._getDefaultSeriesSpec(t,["center","centerOffset","cornerRadius","padAngle","minAngle","emptyPlaceholder","showAllZero","supportNegative","useSequentialAnimation","layoutRadius"]);return i.categoryField=t.categoryField||t.seriesField,i.valueField=t.valueField||t.angleField,i.emptyCircle=null==(e=t.emptyPlaceholder)?void 0:e.emptyCircle,i}}class TE extends Ah{constructor(){super(...arguments),this.transformerConstructor=TI}}TE.transformerConstructor=TI;class TL extends TE{constructor(){super(...arguments),this.transformerConstructor=TI,this.type="pie",this.seriesType=Y.pie}}TL.type="pie",TL.seriesType=Y.pie,TL.transformerConstructor=TI;let TF=()=>{A$(),TP(),h9.registerChart(TL.type,TL)};function TO(t){return"angle"===t?"growAngleIn":"growRadiusIn"}let TH=t=>({type:TO(t.growField),options:{overall:!0}}),TD={type:"fadeIn"},Tz=t=>({type:TO(t.growField)}),TW=t=>({type:"angle"===t.growField?"growAngleOut":"growRadiusOut"}),TZ=()=>{h9.registerAnimation("rose",(t,e)=>({appear:function(t,e){if(!1===e)return{};switch(e){case"fadeIn":return TD;case"growAngle":return TH(Object.assign(Object.assign({},t),{growField:"angle"}));default:return TH(Object.assign(Object.assign({},t),{growField:"radius"}))}}(t,e),enter:Tz(t),exit:TW(t),disappear:{duration:vV.disappear.duration}}))};class TN extends Tl{getStackGroupFields(){return this._angleField}getStackValueField(){return(0,a1.IX)(this._spec.valueField)[0]||(0,a1.IX)(this._spec.radiusField)[0]}getGroupFields(){return this._angleField}setAttrFromSpec(){super.setAttrFromSpec(),this.setAngleField(this._spec.categoryField||this._spec.angleField),this.setRadiusField(this._spec.valueField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice(),this.setInnerRadiusField(this._spec.valueField||this._spec.radiusField),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent()}setValueFieldToStack(){this.setRadiusField(uh),this.setInnerRadiusField(uo)}setValueFieldToPercent(){this.setRadiusField(uu),this.setInnerRadiusField(ud)}getDimensionField(){return this._specAngleField}getMeasureField(){return this._specRadiusField}getDefaultShapeType(){return"square"}}let Tj=Object.assign(Object.assign({},b7),{rose:{name:"rose",type:"arc"}});class TG extends _c{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){this._addMarkLabelSpec(t,"rose")}}var TV=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class TU extends xX{get center(){return this._center}get startAngle(){return this._startAngle}get endAngle(){return this._endAngle}getOrient(){return this._orient}getDefaultInteractive(){return"angle"!==this._orient}getGroupScales(){return this._groupScales}static getSpecInfo(t){let e,i;if(!t[this.specKey])return null;let r=(0,rD.Z)(t[this.specKey]),n=r?t[this.specKey]:[t[this.specKey]],l=[],s=[],a=[];return n.forEach((n,o)=>{if(!function(t){let e=null==t?void 0:t.orient;return"angle"===e||"radius"===e}(n))return;let{axisType:h,componentName:d,startAngle:u,endAngle:c,center:p,outerRadius:g,layoutRadius:f}=xE(n,t);n.center=p,n.startAngle=u,n.endAngle=c,n.outerRadius=g,n.type=h,n.layoutRadius=f;let m={spec:n,specPath:r?[this.specKey,o]:[this.specKey],specInfoPath:["component",this.specKey,o],type:d};l.push(m),"radius"===n.orient?(s.push(m),i=o):(a.push(m),e=o)}),s.forEach(t=>{t.angleAxisIndex=e}),a.forEach(t=>{t.radiusAxisIndex=i}),l}static createComponent(t,e){let{spec:i}=t,r=TV(t,["spec"]),n=h9.getComponentInKey(r.type);return n?new n(i,Object.assign(Object.assign({},e),r)):(e.onError(`Component ${r.type} not found`),null)}constructor(t,e){super(t,e),this.type=oQ.polarAxis,this.name=oQ.polarAxis,this._defaultBandPosition=0,this._defaultBandInnerPadding=0,this._defaultBandOuterPadding=0,this.layoutType="absolute",this.layoutZIndex=ts.Axis,this._tick=void 0,this._center=null,this._startAngle=xB,this._endAngle=xI,this._orient="radius",this._groupScales=[],this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),C$(this._regions,t=>{"radius"===this.getOrient()?xC(t.radiusAxisHelper,this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&(t.radiusAxisHelper=this.axisHelper()):xC(t.angleAxisHelper,this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&(t.angleAxisHelper=this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=t=>{var e;let i=null==(e=this.getRegions())?void 0:e[0];return i?i.getLayoutStartPoint():t},this.getCenter=()=>{var t,e;let i=this.getRefLayoutRect(),{width:r,height:n}=i;return{x:hw(null==(t=this._center)?void 0:t.x,r,i,r/2),y:hw(null==(e=this._center)?void 0:e.y,n,i,n/2)}},this.getRefLayoutRect=()=>this.getRegions()[0].getLayoutRect(),this._coordinateType="polar"}setAttrFromSpec(){super.setAttrFromSpec(),this.visible&&(this._axisStyle=this._getAxisAttributes(),this._gridStyle=this._getGridAttributes()),this._tick=this._spec.tick,this._orient="angle"===this._spec.orient?"angle":"radius",this._center=this._spec.center,this._startAngle=(0,iH.M4)(this._spec.startAngle),this._endAngle=(0,iH.M4)(this._spec.endAngle),this._inverse=this._spec.inverse}_tickTransformOption(){var t;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimal:null==(t=this._tick)?void 0:t.noDecimals,startAngle:this.startAngle,labelOffset:xm(this._spec),getRadius:()=>this.getOuterRadius(),inside:this._spec.inside})}updateScaleRange(){let t,e=this._scale.range();return t="radius"===this.getOrient()?this._inverse?[this.computeLayoutOuterRadius(),this.computeLayoutInnerRadius()]:[this.computeLayoutInnerRadius(),this.computeLayoutOuterRadius()]:this._inverse?[this._endAngle,this._startAngle]:[this._startAngle,this._endAngle],(!e||!t||e[0]!==t[0]||e[1]!==t[1])&&(this._scale.range(t),!0)}collectSeriesField(t,e){var i,r;return t>0?null==(r=null==(i=e.getGroups())?void 0:i.fields)?void 0:r[t]:"radius"===this.getOrient()?e.getRadiusField():e.getAngleField()}updateSeriesScale(){C$(this._regions,t=>{"radius"===this.getOrient()?xC(t.radiusAxisHelper,this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&(t.setRadiusScale(this._scale),t.radiusAxisHelper=this.axisHelper()):xC(t.angleAxisHelper,this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&(t.setAngleScale(this._scale),t.angleAxisHelper=this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getSeriesStatisticsField(t){let e="radius"===this.getOrient()?t.getRadiusField():t.getAngleField();return(0,pW.z2)(this._scale.type)?e:[e[0]]}initGroupScales(){}axisHelper(){return{isContinuous:(0,pW.z2)(this._scale.type),dataToPosition:this.dataToPosition.bind(this),coordToPoint:this.coordToPoint.bind(this),pointToCoord:this.pointToCoord.bind(this),center:this.getCenter.bind(this),layoutRadius:this._computeLayoutRadius.bind(this),getScale:(t=0)=>this._scales[t],getAxisId:()=>this.id,getSpec:()=>this._spec}}positionToData(t){let e=this.pointToCoord(t);return"radius"===this.getOrient()?this.invert(e.radius):this.invert(e.angle)}coordToPoint(t){let e=this.getCenter();return(0,iH.op)(e,t.radius,t.angle)}pointToCoord(t){let e=this.getCenter(),i=this._startAngle,r=this._endAngle;return(0,iH.Jl)(t,e,i,r)}getOuterRadius(){return this.computeLayoutOuterRadius()}getInnerRadius(){return this.computeLayoutInnerRadius()}updateLayoutAttribute(){this._visible&&("radius"===this.getOrient()?this._layoutRadiusAxis():this._layoutAngleAxis()),super.updateLayoutAttribute()}_getNormalizedValue(t,e){return 0===e?0:(this.dataToPosition(t)-this._getStartValue())/e}getLabelItems(t){var e;let i=null==(e=this.getTickData())?void 0:e.getLatestData();return i&&i.length?[i.map(e=>x_(e.value,this._getNormalizedValue([e.value],t)))]:[]}_getStartValue(){return"radius"===this.getOrient()?this.computeLayoutInnerRadius():this._startAngle}_layoutAngleAxis(){var t,e,i,r,n;let l=this.getCenter(),s=this.computeLayoutOuterRadius(),a=this.computeLayoutInnerRadius(),o=this._endAngle-this._startAngle,h=this.getLabelItems(o),d=Object.assign(Object.assign({},this.getLayoutStartPoint()),{inside:this._spec.inside,center:l,radius:s,innerRadius:a,startAngle:this._startAngle,endAngle:this._endAngle,layoutRect:this.getRefLayoutRect(),autoLabelMaxWidth:null!=(e=null==(t=this._spec.label)?void 0:t.autoLabelMaxWidth)&&e,sides:(null==(n=null==(r=null==(i=this._getRelatedAxis(this._option.radiusAxisIndex))?void 0:i.getSpec())?void 0:r.grid)?void 0:n.smooth)?void 0:this.getScale().domain().length}),u=Object.assign(Object.assign({},d),{size:this.getRefLayoutRect(),title:{text:this._spec.title.text||this._dataFieldText},items:h,orient:"angle",scale:this._scale});this._spec.grid.visible&&(u.grid=Object.assign({type:"line",smoothLink:!0,items:h[0]},d)),this._update(u)}_layoutRadiusAxis(){var t,e,i;let r=this.getCenter(),n=this.computeLayoutOuterRadius(),l=this.computeLayoutInnerRadius(),s=this.coordToPoint({angle:this._startAngle,radius:n}),a=this.coordToPoint({angle:this._startAngle,radius:l}),o=iN.HL.distancePP(a,s),h=this.getLabelItems(o),d=Object.assign(Object.assign({},this.getLayoutStartPoint()),{start:a,end:s,verticalFactor:-1}),u=Object.assign(Object.assign({},d),{title:{text:this._spec.title.text||this._dataFieldText},items:h,orient:"radius",scale:this._scale.clone()});(null==(t=this._spec.grid)?void 0:t.visible)&&(u.grid=Object.assign({items:h[0],type:(null==(e=this._spec.grid)?void 0:e.smooth)?"circle":"polygon",center:r,closed:!0,sides:null==(i=this._getRelatedAxis(this._option.angleAxisIndex))?void 0:i.getScale().domain().length,startAngle:this._startAngle,endAngle:this._endAngle},d)),this._update(u)}_getRelatedAxis(t){if((0,aw.Z)(t))return this._option.getComponentByIndex(this.specKey,t)}_computeLayoutRadius(){return xL(()=>this._spec.layoutRadius,this.getRefLayoutRect,this.getCenter,()=>({startAngle:this._startAngle,endAngle:this._endAngle}))}computeLayoutOuterRadius(){var t;let e=null!=(t=this._spec.outerRadius)?t:this._spec.radius,i=null!=e?e:this.getRefSeriesRadius().outerRadius;return this._computeLayoutRadius()*i}computeLayoutInnerRadius(){var t;let e=null!=(t=this._spec.innerRadius)?t:this.getRefSeriesRadius().innerRadius;return this._computeLayoutRadius()*e}getRefSeriesRadius(){let t=.6,e=0,i=this.getChart().getSpec();return C$(this.getRegions(),r=>{if(_g(r.type)){let{outerRadius:n=i.outerRadius,innerRadius:l=i.innerRadius}=r;(0,hy.Z)(n)&&(t=n),(0,hy.Z)(l)&&(e=l)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),{outerRadius:t,innerRadius:e}}_update(t){let{grid:e}=t,i=TV(t,["grid"]);this._axisMark.getComponent().setAttributes(h5({},this._axisStyle,i)),this._gridMark&&this._gridMark.getComponent().setAttributes(h5({},this._gridStyle,e))}invert(t){var e;if("angle"===this.getOrient()&&"band"===this._scale.type){let i=this._scale.range(),r=i[i.length-1]-i[0],n=.5===(null!=(e=this.getSpec().bandPosition)?e:this._defaultBandPosition)?0:this._scale.bandwidth()/2;if(i[0]<0){let e=(t+n+Math.abs(i[0]))%r-Math.abs(i[0]);return this._scale.invert(e)}return this._scale.invert((t+n)%r)}return this._scale.invert(t)}}TU.type=oQ.polarAxis,TU.specKey="axes";let TK=(t,e,i)=>{var r;let{labelStyle:n,getRadius:l,labelOffset:s,labelFormatter:a,inside:o}=i,h=null==l?void 0:l(),d=null!=(r=n.angle)?r:0,u=gQ(n);return e.map(e=>{let i=a?a(e):`${e}`,{width:r,height:l}=u.quickMeasure(i),c=Math.max(r,12),p=Math.max(l,12),g=t.scale(e),f={x:0,y:0},m=0,y=0,v={align:n.textAlign,baseline:n.textBaseline},{x:b,y:_}=function(t,e,i,r,n){var l;let s=(0,iH.op)({x:0,y:0},i,t),a=ws(s,wa(r,s,e,n));return l=wa(r||1,a,e,n),{x:a.x+l[0],y:a.y+l[1]}}(g,f,h,s,o);return v.align||((0,ng.Yt)(b,f.x)?v.baseline||(v.baseline=_>f.y?"top":"bottom"):b>f.x?v.align="left":b<f.x&&(v.align="right")),m=b+("right"===v.align?-c:"left"===v.align?0:-c/2),y=_+("bottom"===v.baseline?-p:"top"===v.baseline?0:-p/2),(new iI.FB).set(m,y,m+c,y+p).rotate(d,m+c/2,y+p/2)})},TX=(t,e)=>{let i,{tickCount:r,forceTickCount:n,tickStep:l,getRadius:s,labelOffset:a,labelGap:o=0,labelStyle:h}=e,d=null==s?void 0:s();if(!d||d<=0)return xr(t.domain());if((0,aw.Z)(l))i=t.stepTicks(l);else if((0,aw.Z)(n))i=t.forceTicks(n);else if((0,aw.Z)(r)){let e=t.range(),n=Math.abs(e[e.length-1]-e[0]),l=(0,nz.Z)(r)?r({axisLength:n,labelStyle:h}):r;i=t.ticks(l)}else if(e.sampling){let r=t.domain(),n=t.range(),l=TK(t,r,e),s=(0,a1.iH)(n),h=Math.abs((0,a1.CE)(n)-s)*(d+a)/r.length,{step:u,delCount:c}=TY(r,l,o,Math.floor(l.reduce((t,e)=>Math.min(t,e.width(),e.height()),Number.MAX_VALUE)/h));i=(i=t.stepTicks(u)).slice(0,i.length-c)}else i=t.domain();return xr(i)},TY=(t,e,i,r)=>{let n=r;do{let r=!0;n++;let l=0;do l+n<t.length&&xn(e[l],e[l+n],i)&&(r=!1),l+=n;while(r&&l<t.length);if(r)break}while(n<=t.length);let l=0;if(t.length>2){let i=t.length-t.length%n;for(i>=t.length&&(i-=n);i>0&&xn(e[0],e[i]);)l++,i-=n}return{step:n,delCount:l}};class T${isInValidValue(t){let{startAngle:e=gK,endAngle:i=gX}=this.attribute;return Math.abs(i-e)%(2*Math.PI)==0?t>1:t<0||t>1}getTickCoord(t){let{startAngle:e=gK,endAngle:i=gX,center:r,radius:n,inside:l=!1,innerRadius:s=0}=this.attribute;return(0,iH.op)(r,l&&s>0?s:n,e+(i-e)*t)}getVerticalVector(t,e=!1,i){return wa(t,i,this.attribute.center,e,this.attribute.inside)}getRelativeVector(t){let{center:e}=this.attribute;return[t.y-e.y,-1*(t.x-e.x)]}}function Tq(t,e){let i=t.length;return{prevLabel:e>=1?t[e-1]:t[i-1],nextLabel:e<i-1?t[e+1]:t[0]}}function TJ(t,e,i){var r;t.setAttributes({maxLineWidth:e,ellipsis:null!=(r=t.attribute.ellipsis)?r:i})}function TQ(t,e,i){let r=[];if(t.length>=3){let{prevLabel:i,nextLabel:n}=Tq(t,e);r.push(i,n)}else 2===t.length&&r.push(t[+(0===e)]);let n=t[e],l=Math.min(Math.abs(n.attribute.y-i.y1),Math.abs(n.attribute.y-i.y2));r.forEach(t=>{l=Math.min(l,Math.abs(t.attribute.y-n.attribute.y))}),l>0&&n.setAttributes({whiteSpace:"normal",heightLimit:l})}var T0=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};wZ(),wT();class T1 extends Sm{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},T1.defaultAttributes,t))}renderLine(t){let{startAngle:e=gK,endAngle:i=gX,radius:r,center:n,innerRadius:l=0,line:s={},inside:a=!1,sides:o}=this.attribute,h,d=r,u=l;if(a&&l>0&&(d=l,u=0),(0,hy.Z)(o)&&o>=3){let t=wo(n,o,d,e,i);h=ak.path(Object.assign(Object.assign({},s.style),{path:wh(t,!0)}))}else{let t=Object.assign(Object.assign(Object.assign({},n),{startAngle:e,endAngle:i,radius:d,innerRadius:u}),s.style);h=ak.circle(t)}h.name=t0.line,h.id=this._getNodeId("line"),(0,uF.Z)(s.state)||(h.states=(0,h3.Z)({},xV,s.state)),t.add(h)}getTitleAttribute(){var t,e,i;let{center:r,radius:n,innerRadius:l=0}=this.attribute,s=this.attribute.title,{space:a=4,textStyle:o={},shape:h,background:d,state:u={}}=s,c=T0(s,["space","textStyle","shape","background","state"]),p=r,g=0;(null==(t=this.attribute.label)?void 0:t.visible)&&!1===this.attribute.label.inside&&(g=(0,dx.Z)(this.attribute.label,"style.fontSize",12)+(0,dx.Z)(this.attribute.label,"space",4));let f=0;(null==(e=this.attribute.tick)?void 0:e.visible)&&!1===this.attribute.tick.inside&&(f=this.attribute.tick.length||4),(null==(i=this.attribute.subTick)?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(f=Math.max(f,this.attribute.subTick.length||2));let m=n+f+g+a,y="middle",{position:v}=this.attribute.title;(0,nB.Z)(v)&&(v=0===l?"end":"middle"),"start"===v?(y="bottom",p={x:r.x,y:r.y-m}):"end"===v&&(y="top",p={x:r.x,y:r.y+m});let b=Object.assign(Object.assign(Object.assign({},p),c),{textStyle:Object.assign({textBaseline:y,textAlign:"center"},o),state:{text:(0,h3.Z)({},xV,u.text),shape:(0,h3.Z)({},xV,u.shape),panel:(0,h3.Z)({},xV,u.background)}}),{angle:_}=c;return b.angle=_,h&&h.visible&&(b.shape=Object.assign({visible:!0},h.style),h.space&&(b.space=h.space)),d&&d.visible&&(b.panel=Object.assign({visible:!0},d.style)),b}getSubTickLineItems(){var t,e;let{subTick:i}=this.attribute,r=[],{count:n=4,inside:l=!1,length:s=2}=i,a=this.tickLineItems,o=a.length;if(o>=2){let i=this.data[1].value-this.data[0].value,h=null==(e=null==(t=this.attribute)?void 0:t.tick)?void 0:e.alignWithLabel;for(let t=0;t<o;t++){let e=a[t],o=a[t+1];for(let t=0;t<n;t++){let a=(t+1)/(n+1),d=(1-a)*e.value+a*(o?o.value:h?1:e.value+i),u=this.getTickCoord(d),c=this.getVerticalCoord(u,s,l);r.push({start:u,end:c,value:d})}}}return r}beforeLabelsOverlap(t,e,i,r,n){}handleLabelsOverlap(t,e,i,r,n){if((0,uF.Z)(t))return;let{inside:l,radius:s,center:a,size:o,label:h,orient:d}=this.attribute,u=o?{x1:0,y1:0,x2:o.width,y2:o.height}:{x1:a.x-s,y1:a.y-s,x2:a.x+s,y2:a.y+s},{layoutFunc:c,autoLimit:p,limitEllipsis:g,autoHide:f,autoHideMethod:m,autoHideSeparation:y,autoWrap:v}=h;(0,nz.Z)(c)?c(t,e,r,this):((p||v)&&function(t,e){let{ellipsis:i,inside:r,bounds:n,autoWrap:l,center:s}=e;r||t.forEach((e,r)=>{let{x:a,y:o}=e.attribute,h=e.AABBBounds;if((0,ng.Yt)(a,s.x)){if(o>n.y2||o<n.y1)return void TJ(e,0,i);let l=n.x2-n.x1;if(t.length>=3){let{prevLabel:n,nextLabel:s}=Tq(t,r),o=n.attribute.x,h=s.attribute.x;o>h&&(o=s.attribute.x,h=n.attribute.x);let d=o===h?l:a>=o&&a<=h?h-o:Math.min(Math.abs(o-a),Math.abs(h-a));e.AABBBounds.width()>d&&TJ(e,d,i)}else e.AABBBounds.width()>l&&TJ(e,l,i)}else a>s.x&&h.x2>n.x2?(TJ(e,n.x2-a,i),l&&TQ(t,r,n)):a<s.x&&h.x1<n.x1&&(TJ(e,a-n.x1,i),l&&TQ(t,r,n))})}(t,{inside:l,autoWrap:v,bounds:u,ellipsis:g,center:a}),f&&S_(t,{orient:d,method:m,separation:y}))}afterLabelsOverlap(t,e,i,r,n){var l;let{layoutRect:s,autoLabelMaxWidth:a}=this.attribute;if(!a||!s||!t||0===t.length)return;let o=0+s.width;for(let e=0;e<t.length;e++){let i=t[e],r=i.attribute.x,n=null!=(l=i.attribute.textAlign)?l:"center",s=0;(s="left"===n?o-r:"right"===n?r-0:2*Math.max(0,Math.min(r-0,o-r)))>0?i.setAttributes({maxLineWidth:s}):i.setAttributes({maxLineWidth:0})}}getTextBaseline(t){return .3>Math.abs(t[1]/t[0])?"middle":t[1]<0?"bottom":t[1]>0?"top":"middle"}getLabelAlign(t,e,i){return(0,ng.Yt)(t[0],0)?{textAlign:"center",textBaseline:t[1]>0?"top":"bottom"}:t[0]<0?{textAlign:"right",textBaseline:this.getTextBaseline(t)}:t[0]>0?{textAlign:"left",textBaseline:this.getTextBaseline(t)}:{textAlign:"center",textBaseline:"middle"}}getLabelPosition(t,e,i,r){return t}}T1.defaultAttributes=wt,(0,yf.jB)(T1,T$);var T2=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};uD(),wD();class T3 extends wp{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},wp.defaultAttributes,t),e)}getGridPointsByValue(t){let e=this.getTickCoord(t),{radius:i,innerRadius:r=0}=this.attribute;return[e,this.getVerticalCoord(e,i-r,!0)]}getGridAttribute(t){let e,i=[],r=this.attribute,{radius:n,innerRadius:l=0,startAngle:s=gK,endAngle:a=gX,center:o,subGrid:h}=r,d=T2(r,["radius","innerRadius","startAngle","endAngle","center","subGrid"]),{alignWithLabel:u=!0}=d||{},c=n-l,p=this._parseTickSegment();if(t){e=(0,h3.Z)({},d,h);let t=[],{count:r=4}=h||{},n=this.data.length;if(n>=2){let e=this._getPointsOfSubGrid(p,u);for(let i=0;i<n;i++){let n=e[i],l=e[i+1];t.push({id:`sub-${i}-0`,points:[this.getTickCoord(n.value),this.getVerticalCoord(this.getTickCoord(n.value),c,!0)],datum:{}});for(let e=0;e<r;e++){let s=(e+1)/(r+1),a=(1-s)*n.value+s*(l?l.value:u?1:n.value+p),o=this.getTickCoord(a),h=this.getVerticalCoord(o,c,!0);t.push({id:`sub-${i}-${e+1}`,points:[o,h],datum:{}})}}Math.abs(a-s)%(2*Math.PI)==0&&t.push(t[0]),i=t}}else{e=d;let t=[];(Math.abs(a-s)%(2*Math.PI)==0?[...this.data].concat(this.data[0]):this.data).forEach(e=>{let{point:i}=e;if(!u){let t=e.value-p/2;if(this.isInValidValue(t))return;i=this.getTickCoord(t)}let r=this.getVerticalCoord(i,c,!0);t.push({id:e.id,points:[i,r],datum:e})}),i=t}return Object.assign(Object.assign({},e),{items:i,center:o,type:"line"})}}(0,yf.jB)(T3,T$);let T5={grid:{smooth:!0,visible:!0},subGrid:{smooth:!0,visible:!1}},T4={grid:{visible:!0,style:{lineDash:[6,6]}},label:{space:5}};class T6 extends TU{constructor(){super(...arguments),this.type=oQ.polarBandAxis,this._scale=new pT.j}computeDomain(t){return this.computeBandDomain(t)}updateScaleRange(){let t=super.updateScaleRange();return this.updateGroupScaleRange(),t}axisHelper(){let t=super.axisHelper();return Object.assign(Object.assign({},t),{getBandwidth:e=>t.getScale(e).bandwidth()})}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}registerTicksTransform(){let t=`${this.type}-ticks`;return dL(this._option.dataSet,t,TX),t}transformScaleDomain(){}}T6.type=oQ.polarBandAxis,T6.specKey="axes",T6.builtInTheme={axis:Sk,axisBand:ST,axisAngle:T4,axisRadius:T5},(0,yf.jB)(T6,x0);let T7=()=>{h9.registerGraphicComponent(tJ.lineAxis,(t,e)=>new SM(t,e)),h9.registerGraphicComponent(tQ.lineAxisGrid,(t,e)=>new wN(t,e)),h9.registerGraphicComponent(tJ.circleAxis,(t,e)=>new T1(t,e)),h9.registerGraphicComponent(tQ.circleAxisGrid,(t,e)=>new T3(t,e)),xY(),h9.registerComponent(T6.type,T6)};class T8 extends TU{constructor(){super(...arguments),this.type=oQ.polarLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new pM.f}setAttrFromSpec(){super.setAttrFromSpec(),this.setExtraAttrFromSpec()}initScales(){super.initScales(),this.setScaleNice()}computeDomain(t){return this.computeLinearDomain(t)}axisHelper(){let t=super.axisHelper();return t.setExtendDomain=this.setExtendDomain.bind(this),t}registerTicksTransform(){let t=`${this.type}-ticks`;return dL(this._option.dataSet,t,SG),t}}T8.type=oQ.polarLinearAxis,T8.specKey="axes",T8.builtInTheme={axis:Sk,axisLinear:SU,axisAngle:T4,axisRadius:T5},(0,yf.jB)(T8,SZ);let T9=()=>{h9.registerGraphicComponent(tJ.lineAxis,(t,e)=>new SM(t,e)),h9.registerGraphicComponent(tQ.lineAxisGrid,(t,e)=>new wN(t,e)),h9.registerGraphicComponent(tJ.circleAxis,(t,e)=>new T1(t,e)),h9.registerGraphicComponent(tQ.circleAxisGrid,(t,e)=>new T3(t,e)),xY(),h9.registerComponent(T8.type,T8)};class kt extends TN{constructor(){super(...arguments),this.type=Y.rose,this.transformerConstructor=TG,this._roseMark=null,this._labelMark=null}initMark(){this.initRoseMark()}initMarkStyle(){this.initRoseMarkStyle()}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y}),this._markAttributeContext.startAngleScale=t=>this.startAngleScale(t),this._markAttributeContext.endAngleScale=t=>this.endAngleScale(t)}initRoseMark(){this._roseMark=this._createMark(kt.mark.rose,{groupKey:this._seriesField,isSeriesMark:!0},{morph:_h(this._spec,kt.mark.rose.name),morphElementKey:this.getDimensionField()[0]})}getRoseAngle(){var t,e,i;return null!=(i=null==(e=(t=this.angleAxisHelper).getBandwidth)?void 0:e.call(t,this._groups?this._groups.fields.length-1:0))?i:.5}startAngleScale(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}endAngleScale(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+this.getRoseAngle()-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}initRoseMarkStyle(){let t=this._roseMark;t&&this.setMarkStyle(t,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:t=>this.startAngleScale(t),endAngle:t=>this.endAngleScale(t),fill:this.getColorAttribute(),outerRadius:t=>pF(this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]]),this.radiusAxisHelper.getScale(0)),innerRadius:t=>{var e;if(!this.getStack())return 0;let i=pF(this.radiusAxisHelper.dataToPosition([t[this._innerRadiusField[0]]]),this.radiusAxisHelper.getScale(0));return i<=Number.MIN_VALUE?this._computeLayoutRadius()*(null!=(e=this._spec.innerRadius)?e:0):i}})}initTooltip(){super.initTooltip(),this._roseMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._roseMark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{text:t=>t[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:0})}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._roseMark&&this._roseMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("rose"))?void 0:i({innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!=(t=this._spec.innerRadius)?t:0)}},r),_s("rose",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._roseMark]}}kt.type=Y.rose,kt.mark=Tj,kt.builtInTheme={rose:{rose:{style:{fillOpacity:1}},label:{style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"},textAlign:"center",textBaseline:"middle"}}}},kt.transformerConstructor=TG;let ke=()=>{h9.registerSeries(kt.type,kt),TS(),TZ(),T7(),T9()};class ki extends TB{needAxes(){return!0}_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.categoryField=t.categoryField||t.angleField,e.valueField=t.valueField||t.radiusField,e}transformSpec(t){var e;if(super.transformSpec(t),this.needAxes()){t.axes||(t.axes=[]);let i={radius:!1,angle:!1};(null!=(e=t.axes)?e:[]).forEach(t=>{let{orient:e}=t;"radius"===e&&(i.radius=!0),"angle"===e&&(i.angle=!0)}),i.angle||t.axes.push({orient:"angle"}),i.radius||t.axes.push({orient:"radius"})}}}class kr extends ki{_getDefaultSeriesSpec(t){var e,i,r;let n=super._getDefaultSeriesSpec(t);return n.radius=null!=(e=t.radius)?e:.6,n.outerRadius=null!=(i=t.outerRadius)?i:.6,n.innerRadius=null!=(r=t.innerRadius)?r:0,n.stack=t.stack,n.percent=t.percent,n}transformSpec(t){var e;super.transformSpec(t),(null!=(e=t.axes)?e:[]).forEach(t=>{["domainLine","grid","label","tick"].forEach(e=>{t[e]||(t[e]={visible:!1})}),"angle"===t.orient&&(0,nB.Z)(t.bandPosition)&&(t.bandPosition=.5)}),t.crosshair=(0,a1.IX)(t.crosshair||{}).map(t=>h5({categoryField:{visible:!0,line:{visible:!0,type:"rect"}}},t))}}let kn=(t,e)=>{let i=2*Math.PI,r=(0,a1.iH)(e),n=(0,a1.CE)(e);return t<r?t+=Math.ceil((r-t)/i)*i:t>n&&(t-=Math.ceil((t-n)/i)*i),t},kl=(t,e)=>{if(!t)return null;let i=Aw(t,t=>"angle"===t.getOrient(),e),r=Aw(t,t=>"radius"===t.getOrient(),e);if(!(i&&i.length||r&&r.length))return null;let n=[],l=t=>t.getDimensionField()[0],{x:s,y:a}=e;return i&&i.forEach(t=>{var e;let i=t.getScale();if(i&&(0,pW.lK)(i.type)){let o=i.domain(),h=i.range(),d=t.getCenter(),u={x:s-t.getLayoutStartPoint().x-d.x,y:a-t.getLayoutStartPoint().y-d.y},c=bw({x:1,y:0},u);c=kn(c,h);let p=bS(u),g=null==(e=r[0])?void 0:e.getScale(),f=null==g?void 0:g.range();if((c-(null==h?void 0:h[0]))*(c-(null==h?void 0:h[1]))>0||(p-(null==f?void 0:f[0]))*(p-(null==f?void 0:f[1]))>0)return;let m=t.invert(c);if((0,nB.Z)(m))return;let y=o.findIndex(t=>(null==t?void 0:t.toString())===m.toString());y<0&&(y=void 0);let v=AC(m,t,"polar",l);n.push({index:y,value:m,position:i.scale(m),axis:t,data:v})}}),r&&r.forEach(t=>{var e;let r=t.getScale(),o=null==r?void 0:r.range();if(r&&(0,pW.lK)(r.type)){let h=t.getCenter(),d={x:s-t.getLayoutStartPoint().x-h.x,y:a-t.getLayoutStartPoint().y-h.y},u=bw({x:1,y:0},d);u<-Math.PI/2&&(u=2*Math.PI+u);let c=bS(d),p=null==(e=i[0])?void 0:e.getScale(),g=null==p?void 0:p.range();if((u-(null==g?void 0:g[0]))*(u-(null==g?void 0:g[1]))>0||(c-(null==o?void 0:o[0]))*(c-(null==o?void 0:o[1]))>0)return;let f=r.invert(c);if((0,nB.Z)(f))return;let m=r.domain().findIndex(t=>(null==t?void 0:t.toString())===f.toString());m<0&&(m=void 0);let y=AC(f,t,"polar",l);n.push({index:m,value:f,position:r.scale(f),axis:t,data:y})}}),n.length?n:null};class ks extends Ah{constructor(){super(...arguments),this.transformerConstructor=kr,this.type="rose",this.seriesType=Y.rose}_setModelOption(){this._modelOption.getDimensionInfo=kl}}ks.type="rose",ks.seriesType=Y.rose,ks.transformerConstructor=kr,(0,yf.jB)(ks,Ac);let ka=()=>{AX(),A$(),AM(),Af(),ke(),h9.registerChart(ks.type,ks)};class ko extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this._center=e.center}getEndProps(){return!1===this.valid?{}:(0,iH.op)(this._center,this._toRadius,this._toAngle)}onBind(){this.from=this.target.attribute,this.to=this.target.getFinalAttribute(),this._prevCenter=this.target.attribute.center,this._center&&this._prevCenter||(this.valid=!1);let{angle:t,radius:e}=(0,iH.Jl)(this.from,this._prevCenter),{angle:i,radius:r}=(0,iH.Jl)(this.to,this._center);(0,hy.Z)(i*r)||(this.valid=!1),this._fromAngle=(0,hy.Z)(t)?t:i,this._fromRadius=(0,hy.Z)(e)?e:r,this._toAngle=i,this._toRadius=r,by(this._fromAngle,this._toAngle)&&by(this._fromRadius,this._toRadius)&&(this.valid=!1),this.props=this.getEndProps()}onUpdate(t,e,i){if(!1===this.valid)return i.x=this.to.x,void(i.y=this.to.y);let{x:r,y:n}=(0,iH.op)({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*e,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*e},this._fromRadius+(this._toRadius-this._fromRadius)*e,this._fromAngle+(this._toAngle-this._fromAngle)*e);this.target.setAttributes({x:r,y:n}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class kh extends yG{onBind(){super.onBind();let{center:t}=this.target.attribute,{center:e}=this.target.getFinalAttribute();this._center=e,this._prevCenter=t}onUpdate(t,e,i){this.points=this.points.map((r,n)=>{let l=this.polarPointInterpolation(this.interpolatePoints[n][0],this.interpolatePoints[n][1],e);return t&&(i.center=this._center),l.context=r.context,l}),this.target.attribute.points=this.points,this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}_interpolationSinglePoint(t,e,i){if(!bA(t)&&!bA(e))return e;let r=(0,iH.Jl)(t,this._prevCenter),n=(0,iH.Jl)(e,this._center),l=(0,iH.LW)(r.angle),s=(0,iH.LW)(n.angle);!(0,hy.Z)(l)&&(0,hy.Z)(s)&&(l=s),(0,hy.Z)(l)&&!(0,hy.Z)(s)&&(s=l);let a=l+(s-l)*i,o=r.radius+(n.radius-r.radius)*i;return(0,iH.op)({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*i,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*i},o,a)}polarPointInterpolation(t,e,i){let{x:r,y:n}=this._interpolationSinglePoint(t,e,i),{x:l,y:s}=this._interpolationSinglePoint({x:t.x1,y:t.y1},{x:e.x1,y:e.y1},i),a=new iN.E9(r,n,l,s);return a.defined=e.defined,a}}let kd=t=>({type:"in"===t?"fadeIn":"fadeOut"}),ku=(t,e)=>({type:"in"===e?"growPointsIn":"growPointsOut",options:()=>({center:t.center()})});function kc(t,e,i){return"fadeIn"===e?kd(i):ku(t,i)}let kp=(t,e)=>{let i=()=>{var e;return null==(e=t.center())?void 0:e.x},r=(t,e)=>e.getGraphicAttribute("x"),n=()=>{var e;return null==(e=t.center())?void 0:e.y},l=(t,e)=>e.getGraphicAttribute("y");return"in"===e?{channel:{x:{from:i,to:r},y:{from:n,to:l}}}:{channel:{x:{from:r,to:i},y:{from:l,to:n}}}},kg=(t,e)=>({custom:yZ,customParameters:(i,r)=>{var n;return{group:r,startAngle:null!=(n=t.startAngle)?n:Math.PI/2,orient:"clockwise",center:t.center(),radius:t.radius(),animationType:e}}}),kf=()=>{h9.registerAnimation("radar",(t,e)=>({appear:"clipIn"===e?void 0:kc(t,e,"in"),enter:kc(t,e,"in"),exit:kc(t,e,"out"),disappear:"clipIn"===e?void 0:{duration:vV.disappear.duration},update:[{channel:["points","center"],custom:kh,customParameters:t,duration:vV.update.duration,easing:vV.update.easing},{type:"update",options:{excludeChannels:["points","defined","center"]}}]})),h9.registerAnimation("radarSymbol",(t,e)=>({appear:"clipIn"===e?void 0:"fadeIn"===e?kd("in"):kp(t,"in"),enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:"clipIn"===e?void 0:{duration:vV.disappear.duration},update:[{options:{excludeChannels:["x","y","center"]}},{channel:["x","y","center"],custom:ko,customParameters:t,duration:vV.update.duration,easing:vV.update.easing}]})),h9.registerAnimation("radarGroup",(t,e)=>({appear:kg(t,"in"),disappear:{duration:vV.disappear.duration}})),Sl()},km=Object.assign(Object.assign(Object.assign({},b7),_C),{area:{name:"area",type:"area"}});class ky extends TN{constructor(){super(...arguments),this.type=Y.radar,this.transformerConstructor=CX,this._sortDataByAxis=!1}initGroups(){}compile(){super.compile(),this.addOverlapCompile()}initMark(){var t,e,i,r;let n=!1!==(null==(t=this._spec.area)?void 0:t.visible)&&!1!==(null==(i=null==(e=this._spec.area)?void 0:e.style)?void 0:i.visible),l=null!=(r=this._spec.seriesMark)?r:"area";this.initAreaMark(n&&"area"===l),this.initLineMark("line"===l||"area"===l&&!n),this.initSymbolMark("point"===l)}initMarkStyle(){this.initAreaMarkStyle(),this.initLineMarkStyle(),this.initSymbolMarkStyle(),[this._lineMark,this._symbolMark,this._areaMark].forEach(t=>{t&&this.setMarkStyle(t,{center:()=>{var t;return null==(t=this.angleAxisHelper)?void 0:t.center()}})})}initAreaMark(t){this._areaMark=this._createMark(ky.mark.area,{groupKey:this._seriesField,isSeriesMark:t})}initAreaMarkStyle(){let t=this._areaMark;t&&(this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),x1:t=>t&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getStack()?this.getDatumPositionValues(t,this._innerRadiusField):this.radiusScale.domain()[0]).x:Number.NaN,y1:t=>t&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getStack()?this.getDatumPositionValues(t,this._innerRadiusField):this.radiusScale.domain()[0]).y:Number.NaN,fill:this.getColorAttribute(),curveType:_b,closePath:!0},"normal",to.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",to.Series),this.event.on(J.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(t,"defined")}))}initTooltip(){super.initTooltip();let{group:t,mark:e}=this._tooltipHelper.activeTriggerSet;this._lineMark&&t.add(this._lineMark),this._areaMark&&t.add(this._areaMark),this._symbolMark&&(e.add(this._symbolMark),t.add(this._symbolMark))}initAnimation(){var t,e,i,r;let n={center:()=>{var t;return null==(t=this.angleAxisHelper)?void 0:t.center()},radius:()=>{let t=this.getLayoutRect();return Math.min(t.width,t.height)},startAngle:(0,aw.Z)(this._spec.startAngle)?(0,iH.M4)(this._spec.startAngle):xB},l=null!=(i=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset)?i:"clipIn";"clipIn"===l&&this._rootMark&&this._rootMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("radarGroup"))?void 0:r(n,l),_s("group",this._spec,this._markAttributeContext))),[[this._areaMark,"radar"],[this._lineMark,"radar"],[this._symbolMark,"radarSymbol"]].forEach(([t,e])=>{if((0,aw.Z)(t)){let i=h9.getAnimationInKey(e);t.setAnimationConfig(_l(null==i?void 0:i(n,l),_s(t.name,this._spec,this._markAttributeContext)))}})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}getSeriesStyle(t){return e=>{var i,r,n,l;let s=null!=(r=null==(i=this._seriesMark)?void 0:i.getAttribute(e,t))?r:void 0;return"fill"!==e||s||(e="stroke",s=null!=(l=null==(n=this._seriesMark)?void 0:n.getAttribute(e,t))?l:void 0),"stroke"===e&&(0,rD.Z)(s)?s[0]:s}}}ky.type=Y.radar,ky.mark=km,ky.builtInTheme={radar:{label:{visible:!1,offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}}},ky.transformerConstructor=CX,(0,yf.jB)(ky,_x);let kv=()=>{h9.registerSeries(ky.type,ky),Mi(),CV(),CK(),kf(),T7(),T9()};class kb extends ki{_getDefaultSeriesSpec(t){var e;let i=super._getDefaultSeriesSpec(t);return i.line=t.line,i.point=t.point,i.stack=t.stack,i.percent=t.percent,i.area=h5({visible:!1},t.area),i.seriesMark=null!=(e=t.seriesMark)?e:"area",i.activePoint=t.activePoint,i.pointDis=t.pointDis,i.pointDisMul=t.pointDisMul,i.markOverlap=t.markOverlap,i}transformSpec(t){var e;super.transformSpec(t),(null!=(e=t.axes)?e:[]).forEach(t=>{"radius"===t.orient&&(["domainLine","label","tick"].forEach(e=>{t[e]||(t[e]={visible:!1})}),t.grid||(t.grid={visible:!0}))}),t.crosshair=(0,a1.IX)(t.crosshair||{}).map(t=>h5({categoryField:{visible:!0,line:{visible:!0,type:"line"}}},t))}}class k_ extends Ah{constructor(){super(...arguments),this.transformerConstructor=kb,this.type="radar",this.seriesType=Y.radar}_setModelOption(){this._modelOption.getDimensionInfo=kl}}k_.type="radar",k_.seriesType=Y.radar,k_.transformerConstructor=kb,(0,yf.jB)(k_,Ac);let kC=()=>{AX(),A$(),AJ(),AM(),Af(),kv(),h9.registerChart(k_.type,k_)};class kx extends Ai{_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return delete e.data,e}_transformAxisSpec(t){t.axes&&t.autoBandSize&&t.series.forEach((e,i)=>{var r;if("bar"===e.type){let n=this._findBandAxisBySeries(e,i,t.axes);if(n&&!n.bandSize&&!n.maxBandSize&&!n.minBandSize){let t=(0,nF.Z)(e.autoBandSize)&&null!=(r=e.autoBandSize.extend)?r:0,{barMaxWidth:i,barMinWidth:l,barWidth:s,barGapInGroup:a}=e;this._applyAxisBandSize(n,t,{barMaxWidth:i,barMinWidth:l,barWidth:s,barGapInGroup:a})}}})}transformSpec(t){if(super.transformSpec(t),t.series&&t.series.length){let e=this._getDefaultSeriesSpec(t);t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})})}t.axes&&t.axes.length&&t.axes.forEach(e=>{(0,dx.Z)(e,"trimPadding")&&h5(e,pe(this.type,t))}),this._transformAxisSpec(t)}}class kw extends Ah{constructor(){super(...arguments),this.transformerConstructor=kx,this.type="common"}_setModelOption(){this._modelOption.getDimensionInfo=(t,e,i)=>{var r,n;return[...null!=(r=AI(t,e,i))?r:[],...null!=(n=kl(t,e))?n:[]]},this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}kw.type="common",kw.transformerConstructor=kx,(0,yf.jB)(kw,Ac);let kS=()=>{AX(),A$(),AJ(),AM(),h9.registerChart(kw.type,kw),Af()};class kA extends bY{constructor(){super(...arguments),this.shapeTypeCallback=()=>"square"}enableByType(t){return"mark"===t}getDefaultTitlePattern(t){return{key:"link info",value:"link info"}}getDefaultContentList(){return[{key:"time",value:t=>bH.k.getInstance().timeFormat("%Y%m%d %H:%M",t.from.split("_")[1])},{key:"type",value:t=>t.action_type},{key:"from",value:t=>t.from},{key:"to",value:t=>t.to}]}}var kM=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class kT extends gW{constructor(){super(...arguments),this.type=kT.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x1:0,y1:0})}_transformGraphicAttributes(t,e,i){let r=super._transformGraphicAttributes(t,e,i),{x:n,x1:l,y:s,y1:a}=r;return Object.assign(Object.assign({},kM(r,["x","x1","y","y1"])),{points:[{x:n,y:s},{x:l,y:a}]})}_createGraphic(t={}){return _I(t)}}kT.type="rule";let kk=()=>{h9.registerMark(kT.type,kT),gG(),_W(),h9.registerGraphicComponent("line",_I)},kR=Object.assign(Object.assign({},b7),{group:{name:"group",type:"group"},link:{name:"link",type:"rule"},arrow:{name:"arrow",type:"symbol"}}),kP=(t,e)=>{let{infoKey:i,fields:r,linkData:n,dotData:l}=e,{fromField:s,toField:a,xField:o,yField:h}=r(),d=n(),u=l(),c={};return u.forEach(t=>{let e={};for(let r in t)r!==i&&(e[r]=t[r]);let r=t[i];null==r||r.forEach(t=>{c[t.node_name]=Object.assign({},e,t)})}),d.forEach(t=>{var e,i,r,n;t[s+"_xField"]=null==(e=null==c?void 0:c[t[s]])?void 0:e[o],t[s+"_yField"]=null==(i=null==c?void 0:c[t[s]])?void 0:i[h],t[a+"_xField"]=null==(r=null==c?void 0:c[t[a]])?void 0:r[o],t[a+"_yField"]=null==(n=null==c?void 0:c[t[a]])?void 0:n[h]}),d};class kB extends _y{constructor(){super(...arguments),this.type=Y.link}getFromField(){return this._fromField}setFromField(t){(0,aw.Z)(t)&&(this._fromField=t)}getToField(){return this._toField}setToField(t){(0,aw.Z)(t)&&(this._toField=t)}getDotTypeField(){return this._dotTypeField}setDotTypeField(t){(0,aw.Z)(t)&&(this._dotTypeField=t)}getDotSeriesSpec(){return this._dotSeriesSpec}setDotSeriesSpec(t){(0,aw.Z)(t)&&(this._dotSeriesSpec=t)}_getDotData(){let t=this._option.getChart().getSeriesInIndex([this._spec.dotSeriesIndex])[0];return t?t.getRawData().latestData:[]}initData(){var t;super.initData(),dL(this._option.dataSet,"linkDotInfo",kP),null==(t=this.getViewData())||t.transform({type:"linkDotInfo",options:{infoKey:"dots",fields:()=>({fromField:this._fromField,toField:this._toField,xField:this._dotSeriesSpec.xField,yField:this._dotSeriesSpec.yField}),linkData:()=>this._rawData.latestData,dotData:()=>this._getDotData()},level:ti.linkDotInfo},!1)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFromField(this._spec.fromField),this.setToField(this._spec.toField),this.setDotTypeField(this._spec.dotTypeField),this.setDotSeriesSpec(this._spec.dotSeriesSpec)}initMark(){this._clipMark=this._createMark(kB.mark.group),this._containerMark=this._createMark(kB.mark.group,{parent:this._clipMark}),this._linkMark=this._createMark(kB.mark.link,{skipBeforeLayouted:!1,parent:this._containerMark}),this._arrowMark=this._createMark(kB.mark.arrow,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark})}initMarkStyle(){var t,e,i,r;let n=this._clipMark;n&&(this.setMarkStyle(n,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",to.Series),n.setMarkConfig({interactive:!1,clip:!0}));let l=this._containerMark;l&&(this.setMarkStyle(l,{x:this._spec.leftAppendPadding,width:this.getLayoutRect().width},"normal",to.Series),l.setMarkConfig({interactive:!1}));let s=this._linkMark;s&&this.setMarkStyle(s,{stroke:this.getColorAttribute(),strokeOpacity:this.dataToOpacity.bind(this),x:this.dataToPositionXFrom.bind(this),y:this.dataToPositionYFrom.bind(this),x1:this.dataToPositionXTo.bind(this),y1:this.dataToPositionYTo.bind(this)},"normal",to.Series);let a=this._arrowMark;if(a){let n=null!=(r=null==(i=null==(e=null==(t=this._theme)?void 0:t.arrow)?void 0:e.style)?void 0:i.size)?r:10;this.setMarkStyle(a,{x:this.dataToPositionXTo.bind(this),y:t=>this.dataToPositionArrowYTo(t,n),fill:this.getColorAttribute(),fillOpacity:this.dataToOpacity.bind(this),size:n,symbolType:t=>this.isPositionYFromHigher(t)?"triangleDown":"triangleUp"},"normal",to.Series)}}afterInitMark(){super.afterInitMark()}dataToPositionXFrom(t){if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._fromField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYFrom(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fromField+"_yField"))}dataToPositionXTo(t){if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._toField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYTo(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})}dataToPositionArrowYTo(t,e){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:i}=this._yAxisHelper,r=this.isPositionYFromHigher(t)?-e/2:e/2;return i(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})+r}dataToOpacity(t){return this.isPositionXOuterRange(t,this._fromField+"_xField")||this.isPositionXOuterRange(t,this._toField+"_xField")||t[this._fromField]===t[this._toField]?0:1}isPositionYFromHigher(t){return this.dataToPositionYFrom(t)<this.dataToPositionYTo(t)}isPositionXOuterRange(t,e){if(!this._xAxisHelper)return!1;let{dataToPosition:i,getScale:r}=this._xAxisHelper;return i(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})<r(0).range()[0]||i(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})>r(0).range()[1]}getDefaultColorDomain(){var t,e;return this._dotTypeField?null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._dotTypeField].values:this._seriesField?null==(e=this.getViewDataStatistics())?void 0:e.latestData[this._seriesField].values:[]}getColorAttribute(){var t,e,i;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:null!=(i=null!=(e=this._dotTypeField)?e:this._seriesField)?i:ul}}getInteractionTriggers(){let t=[];return this._linkMark&&t.push(this._linkMark),this._arrowMark&&t.push(this._arrowMark),this._parseInteractionConfig(t)}initTooltip(){this._tooltipHelper=new kA(this),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._arrowMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._arrowMark)}onMarkTreePositionUpdate(t){t.forEach(t=>{t.commit(!1,!0)})}getDotInfoData(){var t,e;return null==(e=null!=(t=this._linkMark)?t:this._arrowMark)?void 0:e.getData()}getActiveMarks(){return[this._linkMark,this._arrowMark]}}kB.type=Y.link,kB.mark=kR,kB.builtInTheme={link:{arrow:{style:{size:10}}}};let kI=()=>{kk(),CK(),SI(),SX(),h9.registerSeries(kB.type,kB)};class kE extends bY{constructor(){super(...arguments),this.shapeTypeCallback=()=>"square"}enableByType(t){return"mark"===t}getDefaultTitlePattern(t){return{key:"event info",value:"event info"}}getDefaultContentList(){return[{key:t=>t.type,value:t=>t.id},{key:"event_time",value:t=>bH.k.getInstance().timeFormat("%Y%m%d",t.event_time)},{key:"action_type",value:t=>t.action_type},{key:"children",value:t=>t.children}]}getTooltipData(t,e,i,r,n){var l,s,a,o;let h=super.getTooltipData(t,e,i,r,n),d=null!=(a=null==(s=null==(l=this.spec)?void 0:l[t])?void 0:s.updateContent)?a:null==(o=null==e?void 0:e[t])?void 0:o.updateContent;return h&&!d&&(h.updateContent=(t,e,i)=>{let r=[],n=t.filter(t=>"children"===t.key);return n.length>0&&n[0].value.forEach(t=>{let e=!0;for(let i in t)r.push(Object.assign(Object.assign({},n[0]),{shapeType:"circle",hasShape:e,key:i,value:t[i]+""})),e=!1}),t.concat(r)}),h}}let kL=(t,e)=>{var i;let r=(null==(i=t[0])?void 0:i.latestData)?t[0].latestData:t||[],n=[],l=0;return r.forEach(t=>{let i,r={};for(let n in t)n===e||n.startsWith(d9)||(r[n]=t[n],i=(0,aw.Z)(i)?`${i}_${t[n]}`:`${t[n]}`);let s=t[e];null==s||s.forEach((t,e)=>{n.push(Object.assign({},r,t,{[ur]:l,[un]:`${i}_${e}`})),l++})}),n},kF={fill:"#bbb",fillOpacity:.2};class kO extends gW{getTextType(){return this._textType}constructor(t,e){super(t,e),this.type=kO.type,this._textType="text"}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{angle:0,textAlign:"center",lineWidth:0,textConfig:[]})}initStyleWithSpec(t){super.initStyleWithSpec(t),t.textType&&(this._textType=t.textType)}_transformGraphicAttributes(t,e,i){let r=super._transformGraphicAttributes(t,e,i),{text:n}=r;return(0,nF.Z)(n)&&(0,aw.Z)(n.text)&&("rich"===this._textType||"rich"===n.type)&&(r.textConfig=n.text),r}_createGraphic(t={}){let{text:e}=t;return"rich"===this._textType||"rich"===(null==e?void 0:e.type)?Cm(t):uj(t)}}kO.type="text";let kH=()=>{h9.registerMark(kO.type,kO),gG(),cw(),Cw(),h9.registerGraphicComponent("text",uj),h9.registerGraphicComponent("richtext",Cm)},kD=Object.assign(Object.assign({},b7),{group:{name:"group",type:"group"},grid:{name:"grid",type:"rule"},gridBackground:{name:"gridBackground",type:"rect"},dot:{name:"dot",type:"symbol"},title:{name:"title",type:"text"},subTitle:{name:"subTitle",type:"text"},symbol:{name:"symbol",type:"symbol"}});class kz extends _y{constructor(){super(...arguments),this.type=Y.dot}getSeriesGroupField(){return this._seriesField}setSeriesGroupField(t){(0,aw.Z)(t)&&(this._seriesGroupField=t)}getTitleField(){return this._titleField}setTitleField(t){(0,aw.Z)(t)&&(this._titleField=t)}getSubTitleField(){return this._subTitleField}setSubTitleField(t){(0,aw.Z)(t)&&(this._subTitleField=t)}getDotTypeField(){return this._dotTypeField}setDotTypeField(t){(0,aw.Z)(t)&&(this._dotTypeField=t)}getHighLightSeriesGroup(){return this._highLightSeriesGroup}setHighLightSeriesGroup(t){(0,aw.Z)(t)&&(this._highLightSeriesGroup=t)}setGridBackground(t){(0,aw.Z)(t)&&(this._gridBackground=t)}initData(){var t;super.initData(),this._xDimensionStatisticsDomain=this.getRawData().latestData.map(t=>t[this._fieldY[0]]),dL(this._option.dataSet,"objFlat",kL),dL(this._option.dataSet,"copyDataView",dZ),dF(this._option.dataSet,"dataview",e$.i),null==(t=this.getViewData())||t.transform({type:"objFlat",options:"dots",level:ti.dotObjFlat},!1)}getStatisticFields(){return[{key:this._fieldY[0],operations:["values"],customize:this._xDimensionStatisticsDomain}]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setSeriesGroupField(this._spec.seriesGroupField),this.setTitleField(this._spec.titleField),this.setSubTitleField(this._spec.subTitleField),this.setDotTypeField(this._spec.dotTypeField),this.setHighLightSeriesGroup(this._spec.highLightSeriesGroup),this.setGridBackground(h5(kF,(null==(t=this._spec.grid)?void 0:t.background)||{}))}initMark(){this._clipMark=this._createMark(kz.mark.group),this._containerMark=this._createMark(kz.mark.group,{parent:this._clipMark,dataView:this.getRawData()}),this._gridBackgroundMark=this._createMark(kz.mark.gridBackground,{parent:this._containerMark,dataView:this.getRawData()}),this._gridMark=this._createMark(kz.mark.grid,{parent:this._containerMark,dataView:this.getRawData()}),this._dotMark=this._createMark(kz.mark.dot,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark}),this._titleMark=this._createMark(kz.mark.title,{parent:this._containerMark,dataView:this.getRawData()}),this._subTitleMark=this._createMark(kz.mark.subTitle,{parent:this._containerMark,dataView:this.getRawData()}),this._symbolMark=this._createMark(kz.mark.symbol,{parent:this._containerMark,dataView:this.getRawData()})}initMarkStyle(){var t;let e=this._clipMark;e&&(this.setMarkStyle(e,{x:-(null!=(t=this._spec.leftAppendPadding)?t:0),y:0,width:1e4,height:()=>{var t;return null!=(t=this._spec.clipHeight)?t:this._region.getLayoutRect().height}},"normal",to.Series),e.setMarkConfig({interactive:!1,clip:!0}));let i=this._containerMark;i&&(this.setMarkStyle(i,{x:this._spec.leftAppendPadding},"normal",to.Series),i.setMarkConfig({interactive:!1}));let r=this._gridBackgroundMark;r&&this.setMarkStyle(r,{x:this.getRegionRectLeft.bind(this),x1:this.getRegionRectRight.bind(this),y:this.dataToGridBackgroundPositionY.bind(this),y1:this.dataToGridBackgroundPositionY1.bind(this),fill:this._gridBackground.fill,fillOpacity:this.dataToGridBackgroundOpacity.bind(this)},"normal",to.Series);let n=this._gridMark;n&&this.setMarkStyle(n,{stroke:this.getColorAttribute(),x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),x1:this.getRegionRectRight.bind(this),y1:this.dataToPositionY.bind(this)},"normal",to.Series);let l=this._dotMark;l&&this.setMarkStyle(l,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),fill:this.getDotColorAttribute(),stroke:this.getDotColorAttribute(),fillOpacity:this.dataToOpacity.bind(this)},"normal",to.Series);let s=this._titleMark;s&&this.setMarkStyle(s,{fill:this.getColorAttribute(),text:t=>t[this.getTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",to.Series);let a=this._subTitleMark;a&&this.setMarkStyle(a,{fill:this.getColorAttribute(),text:t=>t[this.getSubTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",to.Series);let o=this._symbolMark;o&&this.setMarkStyle(o,{x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),fill:this.getColorAttribute()},"normal",to.Series)}dataToGridBackgroundPositionY(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e,getBandwidth:i}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})-i(0)/2}dataToGridBackgroundPositionY1(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e,getBandwidth:i}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})+i(0)/2}dataToOpacity(t){var e,i,r,n;if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:l,getScale:s}=this._xAxisHelper;return l(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})<s(0).range()[0]||l(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})>s(0).range()[1]?0:null!=(n=null==(r=null==(i=null==(e=this._theme)?void 0:e.dot)?void 0:i.style)?void 0:r.fillOpacity)?n:1}dataToGridBackgroundOpacity(t){return t[this._seriesGroupField]===this._highLightSeriesGroup?this._gridBackground.fillOpacity:0}onLayoutEnd(){var t,e;super.onLayoutEnd();let i=null!=(e=null==(t=this._spec)?void 0:t.leftAppendPadding)?e:0;this.setMarkStyle(this._clipMark,{width:this.getLayoutRect().width+i},"normal",to.Series)}getDefaultColorDomain(){var t,e;return this._seriesGroupField?null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._seriesGroupField].values:this._seriesField?null==(e=this.getViewDataStatistics())?void 0:e.latestData[this._seriesField].values:[]}getColorAttribute(){var t,e,i;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:null!=(i=null!=(e=this._seriesGroupField)?e:this._seriesField)?i:ul}}getDotColorScale(){var t,e,i;let r=this._dotTypeField?null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._dotTypeField].values:this._seriesGroupField?null==(e=this.getViewDataStatistics())?void 0:e.latestData[this._seriesGroupField].values:this._seriesField?null==(i=this.getViewDataStatistics())?void 0:i.latestData[this._seriesField].values:[],n=this._getDataScheme();return(new pB).domain(r).range(n)}getDotColorAttribute(){var t,e,i,r;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this.getDotColorScale(),field:null!=(r=null!=(i=null!=(e=this._dotTypeField)?e:this._seriesGroupField)?i:this._seriesField)?r:ul}}initTooltip(){this._tooltipHelper=new kE(this),this._dotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._dotMark)}onEvaluateEnd(t){super.onEvaluateEnd(t)}onMarkTreePositionUpdate(t){t.forEach(t=>{t.commit(!1,!0)})}getDotData(){var t;return null==(t=this._dotMark)?void 0:t.getData()}_getDataIdKey(){}getStackValueField(){return null}getActiveMarks(){return[this._dotMark]}}kz.type=Y.dot,kz.mark=kD,kz.builtInTheme={dot:{dot:{style:{size:10,fillOpacity:1}},symbol:{style:{size:10}},title:{style:{textAlign:"left",textBaseline:"middle",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},subTitle:{style:{textAlign:"left",textBaseline:"top",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}};let kW=()=>{CK(),kk(),Mw(),kH(),h9.registerSeries(kz.type,kz)};class kZ extends Ai{_getSeriesDataLength(t,e){var i,r;if(e.data){let t=(0,a1.IX)(e.data)[0];return t instanceof eq.V?null==(i=t.latestData)?void 0:i.length:null==(r=t.values)?void 0:r.length}let n=(0,a1.IX)(t.data).find((t,i)=>e.dataId?t instanceof eq.V?t.name===e.dataId:t.id===e.dataId:e.dataIndex===i);return n?n instanceof eq.V?n.latestData.length:n.values.length:0}addAttrToComponentSpec(t,e,i){return Array.isArray(t)?t[0][e]=i:t[e]=i,t}addPaddingRow(t,e,i){t.push({index:e,size:i})}addOrientAxes(t,e,i,r){t.push({id:`regionAxesRow${i}`}),e.push({modelId:`axesRow${i}`,col:1,row:i}),r.axes[0].id=`axesRow${i}`,r.axes[0].regionIndex=Array.from(Array(r.series.length),(t,e)=>"top"===r.axes[0].orient?e+1:e)}transformSpec(t){var e,i,r,n,l,s,a,o,h,d,u,c,p,g,f;super.transformSpec(t);let m=0,y=[],v=[],b=[],_=[],C=[],x=this._option.getCompiler().getStage(),w=(x.viewWidth,x.viewHeight),S=0;if(null==t?void 0:t.legends){y.push({modelId:`legendRow${m}`,col:1,row:m}),this.addAttrToComponentSpec(t.legends,"id",`legendRow${m}`);let a=(0,a1.IX)(t.legends),o=null!=(e=a[0].height)?e:40;if(a[0].padding){let t=hM(a[0].padding);o+=Number(null!=(i=null==t?void 0:t.bottom)?i:0),o+=Number(null!=(r=null==t?void 0:t.top)?r:0),a[0].offsetY=Number(null!=(l=null==(n=a[0])?void 0:n.offsetY)?l:0)+Number(null!=(s=null==t?void 0:t.top)?s:0)}C.push({index:m,size:o}),S+=o,m++}(null==t?void 0:t.dataZoom)&&(y.push({modelId:`dataZoomRow${m}`,col:1,row:m}),this.addAttrToComponentSpec(t.dataZoom,"id",`dataZoomRow${m}`),S+=60,m++,this.addPaddingRow(C,m,10),S+=10,m++),S+=60,null!==t.axes&&"top"!==(null==(o=null==(a=null==t?void 0:t.axes)?void 0:a[0])?void 0:o.orient)||(this.addOrientAxes(v,y,m,t),m++);let A=t.series.filter(t=>t.type!==Y.link).length,M=(w-S-20*A)/A,T=(null==(h=null==t?void 0:t.appendPadding)?void 0:h.left)||0,k=(null==(d=null==t?void 0:t.appendPadding)?void 0:d.right)||0;null==(u=null==t?void 0:t.series)||u.forEach(e=>{var i,r;if([Y.bar,Y.line,Y.area,Y.dot].includes(e.type)){if(y.push({modelId:`${e.type}Row${m}`,col:1,row:m}),y.push({modelId:`axesLeftRow${m}`,col:0,row:m}),v.push({id:`${e.type}Row${m}`,clip:!1}),C.push({index:m,size:(null==e?void 0:e.height)||M}),b.push({orient:"left",id:`axesLeftRow${m}`,type:e.type===Y.dot?"band":"linear",visible:e.type!==Y.dot,title:{visible:!0,autoRotate:!1,style:{text:null==e?void 0:e.barTitle,dx:-20,textBaseline:"middle",textAlign:"end"}},grid:{visible:"boolean"!=typeof(null==(i=null==e?void 0:e.grid)?void 0:i.visible)||(null==(r=null==e?void 0:e.grid)?void 0:r.visible),style:(t,i)=>{var r,n,l,s,a;let o=0;if(0===i){let t=null==(r=null==e?void 0:e.grid)?void 0:r.style;o=null!=(l=null!=(n=null==t?void 0:t.lineWidth)?n:null==t?void 0:t.strokeWidth)?l:1}return{lineWidth:o,stroke:(null==(a=null==(s=null==e?void 0:e.grid)?void 0:s.style)?void 0:a.stroke)||"#dfdfdf",lineDash:[0,0]}}},domainLine:{visible:!1},tick:{visible:!1},label:{visible:!1},regionIndex:v.length-1}),e.type===Y.dot){y.push({modelId:`scrollBarRightRow${m}`,col:2,row:m});let i=this._getSeriesDataLength(t,e),r=0;i&&(r=((null==e?void 0:e.height)||M)/(30*i)),_.push(Object.assign({orient:"right",visible:e.type===Y.dot&&r<1,id:`scrollBarRightRow${m}`,start:0,end:Math.min(r,1),filterMode:"axis",regionIndex:v.length-1,axisId:`axesLeftRow${m}`},(0,a1.IX)(null==t?void 0:t.scrollBar)[0]))}e.regionIndex=v.length-1,m++,this.addPaddingRow(C,m,(null==e?void 0:e.padding)||20),m++,e.leftAppendPadding=T,e.type===Y.dot&&(e.title.style.dx=-T,e.subTitle.style.dx=-T)}}),this.addPaddingRow(C,m,20),m++,null==(c=null==t?void 0:t.series)||c.forEach(e=>{if(e.type===Y.link){let i=e.dotSeriesIndex+1;y.push({modelId:`${e.type}Row${i}`,col:1,row:i-1}),e.regionIndex=t.series[e.dotSeriesIndex].regionIndex,e.leftAppendPadding=T,e.height=t.series[e.dotSeriesIndex].height,e.clipHeight=t.series[e.dotSeriesIndex].clipHeight}}),(null==t?void 0:t.legends)&&this.addAttrToComponentSpec(t.legends,"regionIndex",[v.length-1]),"bottom"===(null==(g=null==(p=null==t?void 0:t.axes)?void 0:p[0])?void 0:g.orient)&&(this.addOrientAxes(v,y,m,t),m++),t.layout={type:"grid",col:4,row:m,colWidth:[{index:0,size:T},{index:2,size:12},{index:3,size:k}],rowHeight:C,elements:y},t.region=v,null==(f=t.axes)||f.push(...b),t.scrollBar=_}}var kN=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class kj extends Ah{constructor(){super(...arguments),this.transformerConstructor=kZ,this.type="sequence"}_createSeries(t,e){let i;if(!t)return;let{spec:r}=e,n=kN(e,["spec"]);if(r.type===Y.link&&(r.dotSeriesSpec=this._spec.series[r.dotSeriesIndex]),r.regionId&&(i=this.getRegionsInUserId(r.regionId)),i||(i=this.getRegionsInIndex(r.regionIndex?[r.regionIndex]:void 0)[0]),!i)return;let l=new t(r,Object.assign(Object.assign(Object.assign({},this._modelOption),n),{region:i,specKey:"series",globalScale:this._globalScale}));l&&(l.created(),this._series.push(l),i.addSeries(l))}}kj.type="sequence",kj.transformerConstructor=kZ;let kG=()=>{AX(),A$(),kW(),kI(),SI(),SX(),h9.registerChart(kj.type,kj)};class kV extends Ar{transformSpec(t){super.transformSpec(t),t.axes.forEach(t=>t.type="linear")}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["x2Field","y2Field","barMinHeight","barBackground","barGap"])}}class kU extends Ah{constructor(){super(...arguments),this.transformerConstructor=kV}}kU.transformerConstructor=kV,(0,yf.jB)(kU,Ac);class kK extends kV{transformSpec(t){super.transformSpec(t),c8(t)}}var kX=i(22345);class kY extends kU{constructor(){super(...arguments),this.transformerConstructor=kK,this.type="histogram",this.seriesType=Y.bar}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}kY.type="histogram",kY.seriesType=Y.bar,kY.transformerConstructor=kK;let k$=()=>{AX(),A$(),AJ(),AM(),Af(),Mk(),h9.registerTransform("bin",kX.L),h9.registerChart(kY.type,kY)},kq=Object.assign(Object.assign({},b7),{group:{name:"group",type:"group"}});class kJ extends Tl{constructor(){super(...arguments),this._arcGroupMark=null,this._getAngleValueStart=t=>{let e=this._getAngleAxis(),{tickMask:i}=this._spec;if((null==i?void 0:i.forceAlign)&&this._isTickMaskVisible(e)){let r,n=t[this.getStack()?uo:ux],l=this._getAngleAxisSubTickData(e),s=l[1].value-l[0].value,a=(0,iH.M4)(i.offsetAngle);if((0,aw.Z)(n)){let t=(0,x1.lo)(l,t=>t.value-n),e=t>=l.length||n>l[t].value-s/2?Math.min(t,l.length-1):t>0?t-1:void 0;void 0!==e&&(r=this.angleAxisHelper.dataToPosition([l[e].value-s/2]))}return(0,nB.Z)(r)&&(r=this.angleAxisHelper.dataToPosition([l[0].value-s/2])),r+a}return this._getAngleValueStartWithoutMask(t)},this._getAngleValueEnd=t=>{let e=this._getAngleAxis(),{tickMask:i}=this._spec;if((null==i?void 0:i.forceAlign)&&this._isTickMaskVisible(e)){let r=t[this.getStack()?uh:this._angleField[0]],n=this._getAngleAxisSubTickData(e),l=n[1].value-n[0].value,s=(0,iH.M4)(i.offsetAngle),a=(0,x1.lo)(n,t=>t.value-r),o=a>=n.length||r>n[a].value-l/2?Math.min(a,n.length-1):a>0?a-1:void 0;return(void 0!==o?this.angleAxisHelper.dataToPosition([n[o].value+l/2]):this.angleAxisHelper.dataToPosition([n[0].value-l/2]))+s}return this._getAngleValueEndWithoutMask(t)}}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec();let r=null==(t=this._option.globalInstance.getChart())?void 0:t.getSpec(),n=null!=(e=this._spec.startAngle)?e:null==r?void 0:r.startAngle;this._startAngle=(0,aw.Z)(n)?(0,iH.M4)(n):xB;let l=null!=(i=this._spec.endAngle)?i:null==r?void 0:r.endAngle;this._endAngle=(0,aw.Z)(l)?(0,iH.M4)(l):xI,this.setAngleField(this._spec.valueField||this._spec.angleField),this.setRadiusField(this._spec.categoryField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice()}getStackGroupFields(){return this._radiusField}getStackValueField(){var t;return null==(t=this._angleField)?void 0:t[0]}getGroupFields(){return this._angleField}_convertMarkStyle(t){let e=super._convertMarkStyle(t);if(e.fill){let i=t.fill;"conical"!==(null==i?void 0:i.gradient)||(0,aw.Z)(null==i?void 0:i.startAngle)||(0,aw.Z)(null==i?void 0:i.endAngle)||(e.fill=Object.assign(Object.assign({},i),{startAngle:this._startAngle,endAngle:this._endAngle}))}return e}_getAngleValueStartWithoutMask(t){if(this.getStack()){let e=pF(this.angleAxisHelper.dataToPosition([t[uo]]),this.angleAxisHelper.getScale(0));if((0,hy.Z)(e))return e}return this._startAngle}_getAngleValueEndWithoutMask(t){if(this.getStack()){let e=pF(this.angleAxisHelper.dataToPosition([t[uh]]),this.angleAxisHelper.getScale(0));if((0,hy.Z)(e))return e}let e=this.angleAxisHelper.dataToPosition([t[this._angleField[0]]]);return this._spec.clamp?pF(e,this.angleAxisHelper.getScale(0)):e}getDimensionField(){return this._specRadiusField}getMeasureField(){return this._specAngleField}initMark(){this._initArcGroupMark()}initMarkStyle(){this._initArcGroupMarkStyle()}_initArcGroupMark(){return this._arcGroupMark=this._createMark(kJ.mark.group,{skipBeforeLayouted:!1}),this._arcGroupMark}_initArcGroupMarkStyle(){let t=this._arcGroupMark;t.created(),this.setMarkStyle(t,{x:0,y:0},"normal",to.Series),this._arcGroupMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0,clipPath:()=>{let t=this._getAngleAxis(),{x:e,y:i}=this.angleAxisHelper.center(),r=this._computeLayoutRadius();if(this._isTickMaskVisible(t)){let{tickMask:n}=this._spec,{angle:l,offsetAngle:s,style:a={}}=n;return this._getAngleAxisSubTickData(t).map(({value:t})=>{let n=this.angleAxisHelper.dataToPosition([t])+(0,iH.M4)(s),o=(0,iH.M4)(l)/2;return w6(Object.assign(Object.assign({},a),{x:e,y:i,startAngle:n-o,endAngle:n+o,innerRadius:r*this._innerRadius,outerRadius:r*this._outerRadius,fill:!0}))})}let{width:n,height:l}=this.getLayoutRect();return[cN({width:n,height:l,fill:!0})]}})}_getAngleAxis(){if(!this.angleAxisHelper)return;let t=this.angleAxisHelper.getAxisId();return this._option.getChart().getAllComponents().find(e=>e.id===t)}_getAngleAxisTickData(t){var e;return null==(e=null==t?void 0:t.getTickData())?void 0:e.getLatestData()}_isTickMaskVisible(t){let e=this._getAngleAxisTickData(t),{tickMask:i}=this._spec;return i&&!1!==i.visible&&(null==e?void 0:e.length)>1}_getAngleAxisSubTickData(t){var e;let i=this._getAngleAxisTickData(t),r=[],{subTick:n={},tick:l={}}=null!=(e=null==t?void 0:t.getSpec())?e:{},{tickCount:s=4}=n,{alignWithLabel:a}=l;if((null==i?void 0:i.length)>=2){let t=i[1].value-i[0].value;for(let e=0;e<i.length-1;e++){let n=i[e],l=i[e+1];r.push(n);for(let e=0;e<s;e++){let i=(e+1)/(s+1),o=(1-i)*n.value+i*(l?l.value:a?1:n.value+t);r.push({value:o})}}return r.push(i[i.length-1]),r}return i}}kJ.mark=kq;let kQ=Object.assign(Object.assign({},kq),{track:{name:"track",type:"arc"},progress:{name:"progress",type:"arc"}}),k0=t=>({type:"growAngleIn",options:{overall:t.startAngle}}),k1={type:"fadeIn"},k2=()=>{h9.registerAnimation("circularProgress",(t,e)=>({appear:"fadeIn"===e?k1:k0(t),enter:{type:"growAngleIn"},disappear:{duration:vV.disappear.duration}}))};class k3 extends _c{constructor(){super(...arguments),this._supportStack=!0}}class k5 extends kJ{constructor(){super(...arguments),this.type=Y.circularProgress,this.transformerConstructor=k3,this._progressMark=null,this._trackMark=null,this._getRadiusValueStart=t=>{if(this.getGroupFields().length>1){let e=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()));if((0,hy.Z)(e))return e}return this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]])},this._getRadiusValueEnd=t=>{var e,i;if(this.getGroupFields().length>1){let r=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+(null==(i=(e=this.radiusAxisHelper).getBandwidth)?void 0:i.call(e,this._groups?this._groups.fields.length-1:0));if((0,hy.Z)(r))return r}return this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]])+this.radiusAxisHelper.getScale(0).step()}}getStackGroupFields(){return this.getGroupFields()}getGroupFields(){return this._radiusField}initMark(){super.initMark(),this._initTrackMark(),this._initProgressMark()}initMarkStyle(){super.initMarkStyle(),this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){return this._progressMark=this._createMark(k5.mark.progress,{parent:this._arcGroupMark,isSeriesMark:!0},{morph:_h(this._spec,"progress")}),this._progressMark}_initProgressMarkStyle(){var t;let e=this._progressMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart,endAngle:this._getAngleValueEnd,innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cap:null!=(t=this._spec.roundCap)&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0},"normal",to.Series)}getInteractionTriggers(){let t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)}initTooltip(){super.initTooltip(),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark)}_initTrackMark(){return this._trackMark=this._createMark(k5.mark.track,{parent:this._arcGroupMark}),this._trackMark.setMarkConfig({morph:!1,morphKey:null,morphElementKey:null}),this._trackMark}_initTrackMarkStyle(){let t=this._trackMark;t&&this.setMarkStyle(t,{visible:t=>{let e=this.angleAxisHelper.getScale(0).range(),i=Math.min(e[0],e[e.length-1]);return 1e-14>=Math.abs(this._getAngleValueStartWithoutMask(t)-i)},x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:()=>{let t=this.getStack()?uo:this._angleField[0],e=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueStart({[t]:e[0]})},endAngle:()=>{let t=this.getStack()?uh:this._angleField[0],e=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueEnd({[t]:e[e.length-1]})},innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:100},"normal",to.Series)}initAnimation(){var t,e,i,r;let n=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._progressMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("circularProgress"))?void 0:i({startAngle:this._startAngle},n),_s("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("fadeInOut"))?void 0:r(),_s("track",this._spec,this._markAttributeContext)))}getActiveMarks(){return[this._progressMark]}}k5.type=Y.circularProgress,k5.mark=kQ,k5.builtInTheme={circularProgress:{outerRadius:.8,innerRadius:.6,progress:{style:{fillOpacity:1}},track:{style:{fillOpacity:.2}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}}},k5.transformerConstructor=k3;let k4=()=>{h9.registerSeries(k5.type,k5),TS(),k2(),vY(),T7(),T9()};class k6 extends TB{needAxes(){return!1}_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t,["startAngle","endAngle","centerX","centerY"]);return e.categoryField=t.categoryField||t.radiusField,e.valueField=t.valueField||t.angleField,e}_transformProgressAxisSpec(t,e,i,r,n){var l,s;t.axes||(t.axes=[]);let a=(null!=(l=t.axes)?l:[]).find(t=>"radius"===t.orient),o=(null!=(s=t.axes)?s:[]).find(t=>"angle"===t.orient);o||(o=e,t.axes.push(o)),a||(a=i,t.axes.push(a)),(0,nB.Z)(o.type)&&(o.type="linear"),(0,nB.Z)(a.type)&&(a.type="band");let h=xy(o,{min:0,max:1});(0,nB.Z)(o.min)&&(o.min=h.min),(0,nB.Z)(o.max)&&(o.max=h.max),r&&Object.assign(o,h5({},r,o)),n&&Object.assign(a,h5({},n,a))}}class k7 extends k6{_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t);return r.progress=t.progress,r.track=t.track,r.tickMask=t.tickMask,r.cornerRadius=null!=(e=t.cornerRadius)?e:0,r.roundCap=null!=(i=t.roundCap)&&i,r}transformSpec(t){super.transformSpec(t),this._transformProgressAxisSpec(t,{orient:"angle",visible:!1},{orient:"radius",visible:!1},{forceInitTick:t.tickMask&&!1!==t.tickMask.visible})}}class k8 extends Ah{constructor(){super(...arguments),this.transformerConstructor=k7,this.type="circularProgress",this.seriesType=Y.circularProgress}_setModelOption(){this._modelOption.getDimensionInfo=kl}}k8.type="circularProgress",k8.seriesType=Y.circularProgress,k8.transformerConstructor=k7,(0,yf.jB)(k8,Ac);let k9=()=>{AX(),A$(),AM(),Af(),k4(),h9.registerChart(k8.type,k8)},Rt=Object.assign(Object.assign({},kq),{segment:{name:"segment",type:"arc"},track:{name:"track",type:"arc"}}),Re=Object.assign(Object.assign({},b7),{pin:{name:"pin",type:"path"},pinBackground:{name:"pinBackground",type:"path"},pointer:{name:"pointer",type:["path","rect"]}}),Ri=t=>({channel:{angle:{from:t.startAngle+Math.PI/2}}}),Rr={type:"fadeIn"},Rn=()=>{h9.registerAnimation("gaugePointer",(t,e)=>{let i="fadeIn"===e?Rr:Ri(t);return{appear:i,enter:i,disappear:{duration:vV.disappear.duration}}})};class Rl extends _c{constructor(){super(...arguments),this._supportStack=!1}}class Rs extends bY{enableByType(t){return"dimension"!==t}}let Ra="M1 0 C1 0.55228 0.55228 1 0 1 C-0.552285 1 -1 0.55228 -1 0 C-1 -0.552285 -0.552285 -1 0 -1 C0.55228 -1 1 -0.552285 1 0Z";class Ro extends kJ{constructor(){super(...arguments),this.type=Y.gaugePointer,this.transformerConstructor=Rl,this._pinMark=null,this._pointerMark=null,this._pinBackgroundMark=null}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setRadiusField(this._spec.radiusField),this._pointerType="rect"===(null==(t=this._spec.pointer)?void 0:t.type)?"rect":"path"}initMark(){this._pinBackgroundMark=this._createMark(Ro.mark.pinBackground),this._pointerMark=this._createMark(Object.assign(Object.assign({},Ro.mark.pointer),{type:this._pointerType}),{isSeriesMark:!0}),this._pinMark=this._createMark(Ro.mark.pin)}initMarkStyle(){this.initPinBackgroundMarkStyle(),this.initPointerMarkStyle(),this.initPinMarkStyle()}initGroups(){}initPointerMarkStyle(){let t=this._pointerMark,e=this._spec.pointer;t&&(this.setMarkStyle(t,{x:t=>{var i,r;let{x:n}=this._getPointerAnchor(t,e);return n-this._getPointerWidth()*(null!=(r=null==(i=null==e?void 0:e.center)?void 0:i[0])?r:0)},y:t=>{var i,r;let{y:n}=this._getPointerAnchor(t,e);return n-this._getPointerHeight(t)*(null!=(r=null==(i=null==e?void 0:e.center)?void 0:i[1])?r:0)},anchor:t=>{let{x:i,y:r}=this._getPointerAnchor(t,e);return[i,r]},fill:this.getColorAttribute(),zIndex:200}),"path"===this._pointerType?this.setMarkStyle(t,{scaleX:this._getPointerWidth.bind(this),scaleY:this._getPointerHeight.bind(this),angle:t=>this._getPointerAngle(t)+Math.PI/2}):this.setMarkStyle(t,{width:this._getPointerWidth.bind(this),height:this._getPointerHeight.bind(this),angle:t=>this._getPointerAngle(t)-Math.PI/2}))}initTooltip(){this._tooltipHelper=new Rs(this),this._pointerMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pointerMark)}_getPointerAnchor(t,e){var i;return null==(i=e.isOnCenter)||i?this.angleAxisHelper.center():this.radiusAxisHelper.coordToPoint({radius:this._innerRadius*this._computeLayoutRadius(),angle:this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])})}_getPointerWidth(){return this._spec.pointer.width*this._computeLayoutRadius()}_getPointerHeight(t){var e,i;let r=this._spec.pointer,n=this._radiusField[0];return(0,aw.Z)(this.radiusAxisHelper)&&(0,aw.Z)(n)?this.radiusAxisHelper.dataToPosition([t[n]])-(null!=(e=null==r?void 0:r.innerPadding)?e:0)-(null!=(i=null==r?void 0:r.outerPadding)?i:10):r.height*this._computeLayoutRadius()}_getPointerAngle(t){let e=this.angleAxisHelper.getScale().domain(),i=(0,a1.CE)(e),r=(0,a1.iH)(e),n=(0,yj.Z)(t[this._angleField[0]],r,i);return this.angleAxisHelper.dataToPosition([n])}_getRotatedPointerCenterOffset(t){var e,i,r,n;let l=this._spec.pointer,s=this._getPointerWidth()*(null!=(i=null==(e=null==l?void 0:l.center)?void 0:e[0])?i:0),a=-this._getPointerHeight(t)*(null!=(n=null==(r=null==l?void 0:l.center)?void 0:r[1])?n:0),o=this._getPointerAngle(t)-Math.PI/2,h=Math.cos(o),d=Math.sin(o);return{x:s*h+a*d,y:-(a*h-s*d)}}initPinBackgroundMarkStyle(){let t=this._pinBackgroundMark,e=this._spec.pinBackground;t&&this.setMarkStyle(t,{x:t=>this._getPointerAnchor(t,e).x,y:t=>this._getPointerAnchor(t,e).y,scaleX:()=>e.width*this._computeLayoutRadius(),scaleY:()=>e.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:100})}initPinMarkStyle(){let t=this._pinMark,e=this._spec.pin;t&&this.setMarkStyle(t,{x:t=>this._getPointerAnchor(t,e).x,y:t=>this._getPointerAnchor(t,e).y,scaleX:()=>e.width*this._computeLayoutRadius(),scaleY:()=>e.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:300})}getInteractionTriggers(){return this._parseInteractionConfig(this._pointerMark?[this._pointerMark]:[])}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._pointerMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("gaugePointer"))?void 0:i({startAngle:this._startAngle},r),_s("pointer",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}Ro.type=Y.gaugePointer,Ro.mark=Re,Ro.builtInTheme={gaugePointer:{pointer:{type:"path",width:.4,height:.4,style:{path:"M-0.020059 -0.978425 C-0.018029 -0.9888053 -0.013378 -1 0 -1 C0.01342 -1 0.01812 -0.989146 0.0201 -0.978425 C0.02161 -0.9702819 0.0692 -0.459505 0.09486 -0.184807 C0.10298 -0.097849 0.1089 -0.034548 0.11047 -0.018339 C0.11698 0.04908 0.07373 0.11111 0.00002 0.11111 C-0.07369 0.11111 -0.117184 0.04991 -0.110423 -0.018339 C-0.103662 -0.086591 -0.022089 -0.9680447 -0.020059 -0.978425Z"}},pin:{width:.025,height:.025,style:{path:Ra,fill:"#888"}},pinBackground:{width:.06,height:.06,style:{path:Ra,fill:"#ddd"}}}},Ro.transformerConstructor=Rl;let Rh=()=>{h9.registerSeries(Ro.type,Ro),MJ(),Mw(),Rn(),T7(),T9()};var Rd=i(53739);class Ru extends _c{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){this._addMarkLabelSpec(t,"segment")}}class Rc extends kJ{constructor(){super(...arguments),this.type=Y.gauge,this.transformerConstructor=Ru,this._segmentMark=null,this._trackMark=null,this._padAngle=0}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._padAngle=(0,iH.M4)(null!=(t=this._spec.padAngle)?t:0)}initData(){var t;super.initData(),dL(this._option.dataSet,"spiltSegment",(t,e)=>{let i=t.slice();return i.sort((t,e)=>t[this._angleField[0]]-e[this._angleField[0]]),i.forEach((t,e)=>{t[uw]=t[this._angleField[0]],t[ux]=e>0?i[e-1][uw]:void 0}),i}),null==(t=this.getViewData())||t.transform({type:"spiltSegment"},!1)}initMark(){super.initMark(),this._trackMark=this._createMark(Rc.mark.track,{parent:this._arcGroupMark,dataView:!1}),this._segmentMark=this._createMark(Rc.mark.segment,{parent:this._arcGroupMark,isSeriesMark:!0})}initMarkStyle(){super.initMarkStyle(),this.initTrackMarkStyle(),this.initSegmentMarkStyle()}initSegmentMarkStyle(){var t;let e=this._segmentMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart.bind(this),endAngle:this._getAngleValueEnd.bind(this),innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!=(t=this._spec.innerRadius)?t:0)},outerRadius:()=>{var t,e;return this._computeLayoutRadius()*(null!=(e=null!=(t=this._spec.radius)?t:this._spec.outerRadius)?e:1)},cap:null!=(t=this._spec.roundCap)&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0})}generateRadiusStyle(t){if(!t)return;let e={};return t.outerRadius&&(e.outerRadius=()=>this._computeLayoutRadius()*t.outerRadius),t.innerRadius&&(e.innerRadius=()=>this._computeLayoutRadius()*t.innerRadius),e}initMarkStyleWithSpec(t,e){if(super.initMarkStyleWithSpec(t,e),t&&"segment"===t.name){let e=this.getSpec().segment;if(e)for(let i in e.state||{})this.setMarkStyle(t,this.generateRadiusStyle(e.state[i]),i,to.User_Mark)}}initTooltip(){super.initTooltip(),this._segmentMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._segmentMark)}initTrackMarkStyle(){var t;let e=this._trackMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!=(t=this._spec.innerRadius)?t:0)},outerRadius:()=>{var t,e;return this._computeLayoutRadius()*(null!=(e=null!=(t=this._spec.radius)?t:this._spec.outerRadius)?e:1)},cap:null!=(t=this._spec.roundCap)&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,zIndex:100})}_getAngleValueStartWithoutMask(t){let e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),r=(0,Rd.i)(e,(e+i)/2)(e+(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?pF(r,this.angleAxisHelper.getScale(0)):r}_getAngleValueEndWithoutMask(t){let e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),r=(0,Rd.i)(i,(e+i)/2)(i-(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?pF(r,this.angleAxisHelper.getScale(0)):r}_getAngleValueStartWithoutPadAngle(t){return(0,aw.Z)(t[ux])?this.angleAxisHelper.dataToPosition([t[ux]]):this._startAngle}_getAngleValueEndWithoutPadAngle(t){return this.angleAxisHelper.dataToPosition([t[uw]])}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._segmentMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("circularProgress"))?void 0:i({startAngle:this._startAngle},r),_s("segment",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}Rc.type=Y.gauge,Rc.mark=Rt,Rc.builtInTheme={gauge:{outerRadius:.8,innerRadius:.6,padAngle:1.146,segment:{style:{fillOpacity:1}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}}},Rc.transformerConstructor=Ru;let Rp=()=>{h9.registerSeries(Rc.type,Rc),TS(),k2(),T9()};class Rg extends k6{_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.radiusField=t.radiusField,e.pin=t.pin,e.pinBackground=t.pinBackground,e.pointer=t.pointer,e}_getDefaultCircularProgressSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.type=Y.circularProgress,e}transformSpec(t){var e,i,r,n,l;super.transformSpec(t);let s=null==(e=t.series)?void 0:e.find(t=>t.type===Y.gauge||t.type===Y.circularProgress);(0,nB.Z)(s)&&("circularProgress"===(s=null!=(i=t.gauge)?i:this._getDefaultCircularProgressSeriesSpec(t)).type&&((0,nB.Z)(s.radiusField)&&(0,nB.Z)(s.categoryField)&&(s.radiusField=null!=(n=null!=(r=t.radiusField)?r:t.categoryField)?n:t.seriesField),(0,nB.Z)(s.valueField)&&(0,nB.Z)(s.angleField)&&(s.valueField=null!=(l=t.valueField)?l:t.angleField)),1===t.series.length?t.series.push(s):t.series.forEach(t=>{t.type===s.type&&Object.keys(s).forEach(e=>{e in t||(t[e]=s[e])})})),s.type===Y.circularProgress?this._transformProgressAxisSpec(t,{orient:"angle",visible:!0,domainLine:{visible:!1},grid:{visible:!1}},{orient:"radius",visible:!1},{zIndex:ts.Region+50}):this._transformGaugeAxisSpec(t)}_transformGaugeAxisSpec(t){var e;t.axes||(t.axes=[]);let i={radius:null,angle:null};(null!=(e=t.axes)?e:[]).forEach(t=>{let{orient:e}=t;"radius"===e&&(i.radius=t),"angle"===e&&(i.angle=t)}),i.angle||(i.angle={orient:"angle",visible:!0},t.axes.push(i.angle)),i.radius||(i.radius={orient:"radius",visible:!1},t.axes.push(i.radius)),(0,nB.Z)(i.angle.type)&&(i.angle.type="linear"),(0,nB.Z)(i.radius.type)&&(i.radius.type="linear"),(0,nB.Z)(i.angle.zIndex)&&(i.angle.zIndex=ts.Region+50)}}class Rf extends Ah{constructor(){super(...arguments),this.transformerConstructor=Rg,this.type="gauge",this.seriesType=Y.gaugePointer}}Rf.type="gauge",Rf.seriesType=Y.gaugePointer,Rf.transformerConstructor=Rg;let Rm=()=>{A$(),Rh(),Rp(),k4(),h9.registerChart(Rf.type,Rf)};class Ry extends Ai{transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["nameField","valueField","fontFamilyField","fontWeightField","fontStyleField","colorHexField","colorMode","colorList","rotateAngles","fontWeightRange","fontSizeRange","maskShape","keepAspect","random","wordCloudConfig","wordCloudShapeConfig","word","fillingWord","wordMask"])}}class Rv extends Ah{constructor(){super(...arguments),this.transformerConstructor=Ry,this.type="wordCloud",this.seriesType=Y.wordCloud}}Rv.transformerConstructor=Ry;let Rb=[0],R_=[20,40],RC=[200,500],Rx={shrink:!1,enlarge:!1,fontSizeLimitMin:0},Rw=["triangleForward","triangle","diamond","square","star","cardioid","circle","pentagon","rect"],RS=`${d9}_WORD_CLOUD_TEXT`,RA=Object.assign(Object.assign({},b7),{word:{name:"word",type:"text"},fillingWord:{name:"fillingWord",type:"text"},wordMask:{name:"wordMask",type:"rect"}});class RM extends _p{constructor(){super(...arguments),this._fontSizeRange=[20,20],this._isWordCloudShape=!1,this._dataChange=!0,this.handleMaskCanvasUpdate=(t,e)=>{this._maskCanvas=t},this.getWordColor=t=>t.isFillingWord?(this._fillingColorCallback&&!this._dataChange||(this._fillingColorCallback=this._wordCloudShapeConfig.fillingColorHexField?t=>t[this._wordCloudShapeConfig.fillingColorHexField]:this.initColorCallback(this._wordCloudShapeConfig.fillingSeriesField,!0)),this._fillingColorCallback(t)):(this._keyWordColorCallback&&!this._dataChange||(this._keyWordColorCallback=this._spec.colorHexField?t=>t[this._spec.colorHexField]:this.initColorCallback(this._seriesField,!1)),this._keyWordColorCallback(t)),this._calculateFontWeight=t=>{let e=this.getRawDataStatisticsByField(this._valueField,!0);return e.min===e.max?this._fontWeightRange[0]:this._fontWeightRange[0]+(this._fontWeightRange[this._fontWeightRange.length-1]-this._fontWeightRange[0])*(t[this._valueField]-e.min)/(e.max-e.min)}}setValueField(t){(0,aw.Z)(t)&&(this._valueField=t)}setFontSizeRange(t){(0,aw.Z)(t)?this._fontSizeRange=t:this._fontSizeRange=R_}setAttrFromSpec(){var t,e,i,r,n;super.setAttrFromSpec(),this._padding=this._option.getChart().padding,this._nameField=this._spec.nameField,this._colorMode=null!=(t=this._spec.colorMode)?t:"ordinal",this._colorList=this._spec.colorList,this.setValueField(this._spec.valueField),this._fontWeightRange=null!=(e=this._spec.fontWeightRange)?e:RC,this._rotateAngles=null!=(i=this._spec.rotateAngles)?i:Rb,this.setFontSizeRange(this._spec.fontSizeRange),this._maskShape=null!=(r=this._spec.maskShape)?r:"circle",this._textField=(null==(n=this._spec.word)?void 0:n.formatMethod)?RS:this._nameField;let l=this._spec.wordCloudConfig;this._wordCloudConfig=Object.assign({drawOutOfBound:"hidden",layoutMode:"default",zoomToFit:Rx},this._spec.wordCloudConfig),l&&!(0,nB.Z)(l.layoutMode)||hI(this._option.mode)||(this._wordCloudConfig.layoutMode="fast"),this._wordCloudShapeConfig=Object.assign({fillingSeriesField:this.getSeriesField(),fillingRotateAngles:Rb,layoutMode:"default"},this._spec.wordCloudShapeConfig),this._isWordCloudShape=!Rw.includes(this._maskShape)&&!["fast","grid","cloud"].includes(this._wordCloudConfig.layoutMode),this._defaultFontFamily=this._option.getTheme("fontFamily")}initData(){var t,e;super.initData(),null==(e=null==(t=this.getViewData())?void 0:t.target)||e.addListener("change",()=>{this._dataChange=!0,this.compile()})}initMark(){var t;this._wordMark=this._createMark(RM.mark.word,{key:un,groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this._seriesField}),(null==(t=this._spec.wordMask)?void 0:t.visible)&&(this._maskMark=this._createMark(RM.mark.wordMask,{dataView:!1}),this._maskMark.setMarkConfig({zIndex:ts.Mark-1}))}initMarkStyle(){this.initMarkStyleOfWord(this._wordMark,this._spec.word,this._spec.colorHexField,this._seriesField),this._maskMark&&this.setMarkStyle(this._maskMark,{width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,background:()=>this._maskCanvas},"normal",to.Series)}initMarkStyleOfWord(t,e,i,r,n){var l,s;t&&(this.setMarkStyle(t,{text:(null==e?void 0:e.formatMethod)?t=>e.formatMethod(t):t=>t[this._textField],x:t=>t.x,y:t=>t.y,fontSize:t=>t.fontSize,fontStyle:t=>t.fontStyle,angle:t=>t.angle,visible:t=>t.visible},"normal",to.Series),this.setMarkStyle(t,{fill:null!=(s=null==(l=null==e?void 0:e.style)?void 0:l.fill)?s:this.getWordColor,fontWeight:t=>t.fontWeight,fontFamily:t=>t.fontFamily},"normal",to.User_Mark))}initTooltip(){super.initTooltip(),this._wordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._wordMark)}initAnimation(){[this._wordMark].forEach(t=>{var e,i;if(t){let r=null==(i=null==(e=this._spec)?void 0:e.animationAppear)?void 0:i.preset;t.setAnimationConfig(_l(h9.getAnimationInKey("wordCloud")({animationConfig:()=>{var e,i;return null==(i=null==(e=t.getAnimationConfig())?void 0:e.appear)?void 0:i[0]}},r),_s("word",this._spec,this._markAttributeContext)))}})}getWordOrdinalColorScale(t,e){var i,r,n,l,s;let a=e?this._wordCloudShapeConfig.fillingColorList:this._colorList,o=t?null==(i=this.getViewData())?void 0:i.latestData.map(e=>e[t]):[],h=null!=(n=null!=a?a:null==(r=this._option.globalScale.getScale("color"))?void 0:r.range())?n:this._getDataScheme();return null==(s=(l=(new pB).domain(o)).range)?void 0:s.call(l,h)}initColorCallback(t,e){var i,r,n,l;if("ordinal"===this._colorMode){let i=this.getWordOrdinalColorScale(t,e);return e=>i.scale(e[null!=t?t:ul])}let s=null!=(i=e?this._colorList:this._wordCloudShapeConfig.fillingColorList)?i:this._option.globalScale.getScale("color").range();if(1===s.length)return t=>s[0];if(this._valueField){let t=this.getRawDataStatisticsByField(this._valueField,!0);if(t.min===t.max)return s[0];let e=(new pM.f).domain([t.min,t.max]).range(s);return t=>e.scale(t[this._valueField])}let a=(new pM.f).domain([0,null!=(l=null==(n=null==(r=this.getViewData())?void 0:r.latestData)?void 0:n.length)?l:1]).range(s);return t=>a.scale(t[ur])}compile(){super.compile();let{width:t,height:e}=this._region.getLayoutRect();if(!(0,hy.Z)(t)||!(0,hy.Z)(e)||!(e>0&&t>0))return;let i=[];this._isWordCloudShape?i.push(Object.assign({type:"wordcloudShape"},this._wordCloudShapeTransformOption())):i.push(Object.assign({type:"wordcloud"},this._wordCloudTransformOption())),this._wordMark.setTransform(i)}_getCommonTransformOptions(){var t,e,i,r,n;let{width:l,height:s}=this._region.getLayoutRect(),a=null!=(t=this._spec.word)?t:{},o=null!=(e=a.style)?e:{};return{size:[l,s],shape:(0,nF.Z)(this._maskShape)&&"text"===this._maskShape.type&&(0,nB.Z)(this._maskShape.fontFamily)?Object.assign({fontFamily:this._option.getTheme("fontFamily")},this._maskShape):this._maskShape,onUpdateMaskCanvas:this.handleMaskCanvasUpdate,onLayoutFinished:()=>{let t=()=>{var e,i,r,n;this._option.globalInstance.getStage().hooks.afterRender.taps=this._option.globalInstance.getStage().hooks.afterRender.taps.filter(e=>e.fn!==t),null==(i=(e=this._option).dispatchEvent)||i.call(e,J.afterWordcloudShapeDraw,{instance:this._option.globalInstance}),null==(n=null==(r=this._option.globalInstance.getChart().getOption().performanceHook)?void 0:r.afterWordcloudShapeDraw)||n.call(r,this._option.globalInstance)};this._option.globalInstance.getStage().hooks.afterRender.taps.push({type:"sync",name:"afterWordcloudShapeDraw",fn:t})},dataIndexKey:un,text:a.formatMethod?t=>a.formatMethod(t):{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:null!=(r=null==(i=this._spec.word)?void 0:i.padding)?r:1,fontFamily:(0,aw.Z)(this._spec.fontFamilyField)?{field:this._spec.fontFamilyField}:null!=(n=o.fontFamily)?n:this._defaultFontFamily,fontWeight:(0,aw.Z)(this._spec.fontWeightField)?{field:this._spec.fontWeightField}:(0,aw.Z)(o.fontWeight)?o.fontWeight:(0,aw.Z)(this._valueField)?this._calculateFontWeight:"normal",fontStyle:(0,aw.Z)(this._spec.fontStyleField)?{field:this._spec.fontStyleField}:o.fontStyle,createCanvas:hd.createCanvas.bind(hd),getTextBounds:uG}}_wordCloudTransformOption(){var t,e;return Object.assign(Object.assign(Object.assign({},null!=(t=this._wordCloudConfig)?t:{}),this._getCommonTransformOptions()),{layoutType:this._wordCloudConfig.layoutMode,rotate:this._rotateAngles,randomVisible:null==(e=this._spec.random)||e,clip:"clip"===this._wordCloudConfig.drawOutOfBound,shrink:this._wordCloudConfig.zoomToFit.shrink,enlarge:this._wordCloudConfig.zoomToFit.enlarge,minFontSize:this._wordCloudConfig.zoomToFit.fontSizeLimitMin,progressiveTime:this._wordCloudConfig.progressiveTime,progressiveStep:this._wordCloudConfig.progressiveStep,repeatFill:this._wordCloudConfig.zoomToFit.repeat})}_wordCloudShapeTransformOption(){var t,e,i,r,n,l;let s=null!=(e=null==(t=this._spec.fillingWord)?void 0:t.style)?e:{},a=null!=(i=this._wordCloudShapeConfig)?i:{};return Object.assign(Object.assign(Object.assign({},a),this._getCommonTransformOptions()),{createImage:Ch,rotateList:this._rotateAngles,fillingRotateList:a.fillingRotateAngles,fillingFontFamily:(0,aw.Z)(a.fillingFontFamilyField)?{field:a.fillingFontFamilyField}:null!=(r=s.fontFamily)?r:this._defaultFontFamily,fillingPadding:null!=(l=null==(n=this._spec.fillingWord)?void 0:n.padding)?l:1,fillingFontStyle:(0,aw.Z)(a.fillingFontStyleField)?{field:a.fillingFontStyleField}:s.fontStyle,fillingFontWeight:(0,aw.Z)(a.fillingFontWeightField)?{field:a.fillingFontWeightField}:s.fontWeight})}getStatisticFields(){let t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}dataToPosition(t){return null}dataToPositionX(t){return null}dataToPositionY(t){return null}dataToPositionZ(t){return null}valueToPosition(t,e){return null}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}onLayoutEnd(){super.onLayoutEnd(),this.compile(),this._dataChange=!1}getActiveMarks(){return[this._wordMark]}reInit(){super.reInit(),this._keyWordColorCallback&&(this._keyWordColorCallback=null),this._fillingColorCallback&&(this._fillingColorCallback=null)}}RM.mark=RA,RM.builtInTheme={wordCloud:{word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}}};let RT=t=>({type:"scaleIn",duration:200,delay:(e,i)=>{let r=t.animationConfig(),n=(null==r?void 0:r.duration)||200,l=(null==r?void 0:r.totalTime)||vV.appear.duration,s=i.context.graphicCount;return i.context.graphicIndex*(n*s<l?n+(l-s*n)/(s-1):(l-n)/(s-1))}}),Rk=()=>{h9.registerAnimation("wordCloud",(t,e)=>({appear:!1===e?{}:"fadeIn"===e?{type:"fadeIn"}:RT(t),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{duration:vV.disappear.duration}}))};var RR=i(98705),RP=i(66974);class RB extends RM{constructor(){super(...arguments),this.type=Y.wordCloud}}RB.type=Y.wordCloud;let RI=()=>{h9.registerGrammarTransform("wordcloud",{transform:RR.v}),kH(),Rk(),h9.registerSeries(RB.type,RB)},RE=()=>{h9.registerGrammarTransform("wordcloudShape",{transform:RP.v}),h9.registerGrammarTransform("wordcloud",{transform:RR.v}),kH(),Rk(),h9.registerSeries(RB.type,RB)};class RL extends Rv{constructor(){super(...arguments),this.transformerConstructor=Ry,this.type="wordCloud",this.seriesType=Y.wordCloud}}RL.type="wordCloud",RL.seriesType=Y.wordCloud,RL.transformerConstructor=Ry;let RF=()=>{A$(),RI(),h9.registerChart(RL.type,RL)},RO=()=>{RE(),A$(),RI(),h9.registerChart(RL.type,RL)},RH=(t,e)=>{var i,r;let n=t.map(t=>Object.assign({},t));if(!n||0===n.length)return n;let{valueField:l,asTransformRatio:s,asReachRatio:a,asHeightRatio:o,asValueRatio:h,asNextValueRatio:d,asLastValueRatio:u,asLastValue:c,asCurrentValue:p,asNextValue:g,heightVisual:f=!1,isCone:m=!0,range:y}=e,v=n.reduce((t,e)=>Math.max(t,Number.parseFloat(e[l])||-1/0),-1/0),b=n.reduce((t,e)=>Math.min(t,Number.parseFloat(e[l])||1/0),1/0),_=[null!=(i=null==y?void 0:y.min)?i:b,null!=(r=null==y?void 0:y.max)?r:v];return n.forEach((t,e)=>{var i,r;let y=Number.parseFloat(t[l]),v=Number.parseFloat(null==(i=n[e-1])?void 0:i[l]),b=Number.parseFloat(null==(r=n[e+1])?void 0:r[l]),C=(0,hy.Z)(b*y)&&0!==y?b/y:0,x=(0,hy.Z)(y*v)&&0!==v?y/v:0;c&&(t[c]=v),g&&(t[g]=b),s&&(t[s]=C),a&&(t[a]=0===e?1:x),o&&(t[o]=!0===f?C:1/n.length),h&&(t[h]=y/_[1]),d&&(t[d]=e===n.length-1?m?0:t[h]:b/_[1]),u&&(t[u]=0===e?1:v/_[1]),p&&(t[p]=y)}),n},RD=(t,e)=>{var i,r;let n=null==(r=null==(i=t[0])?void 0:i.latestData)?void 0:r.map(t=>Object.assign({},t));return n&&0!==n.length&&(n.shift(),n.forEach(t=>{t[e.asIsTransformLevel]=!0})),n},Rz=`${d9}_FUNNEL_TRANSFORM_RATIO`,RW=`${d9}_FUNNEL_REACH_RATIO`,RZ=`${d9}_FUNNEL_HEIGHT_RATIO`,RN=`${d9}_FUNNEL_VALUE_RATIO`,Rj=`${d9}_FUNNEL_LAST_VALUE_RATIO`,RG=`${d9}_FUNNEL_NEXT_VALUE_RATIO`,RV=`${d9}_FUNNEL_LAST_VALUE`,RU=`${d9}_FUNNEL_CURRENT_VALUE`,RK=`${d9}_FUNNEL_NEXT_VALUE`,RX=`${d9}_FUNNEL_TRANSFORM_LEVEL`;class RY extends bY{constructor(t){var e,i;super(t),this.dimensionTooltipTitleCallback=(t,e)=>{var i,r,n;let l=this.series;return"transform"===(null==(i=null==e?void 0:e.mark)?void 0:i.name)?this._transformRatioText:null!=(r=this._getDimensionData(t))?r:null==(n=t.properties)?void 0:n[`${l.getCategoryField()}`]},this.markTooltipValueCallback=(t,e)=>{var i;return"transform"===(null==(i=null==e?void 0:e.mark)?void 0:i.name)?`${(100*(null==t?void 0:t[RW])).toFixed(1)}%`:this._getMeasureData(t)},this.markTooltipKeyCallback=(t,e)=>{var i;if("transform"===(null==(i=null==e?void 0:e.mark)?void 0:i.name))return this._transformRatioText;let{dimensionFields:r,seriesFields:n}=this._seriesCacheInfo,l=r[r.length-1];return(0,aw.Z)(n[0])?null==t?void 0:t[n[0]]:null==t?void 0:t[l]},this._transformRatioText=null!=(i=null==(e=t.getSpec())?void 0:e.transformRatioText)?i:"转化率"}}class R$ extends gW{_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{points:[]})}}class Rq extends R${constructor(){super(...arguments),this.type=Rq.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}}Rq.type="polygon";let RJ=()=>{h9.registerMark(Rq.type,Rq),gG(),w3(),v5(),h9.registerGraphicComponent("polygon",wU)},RQ=Object.assign(Object.assign({},b7),{funnel:{name:"funnel",type:"polygon"},transform:{name:"transform",type:"polygon"},transformLabel:{name:"transformLabel",type:"text"},outerLabel:{name:"outerLabel",type:"text"},outerLabelLine:{name:"outerLabelLine",type:"rule"}});class R0 extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"funnel"),t.isTransform&&this._addMarkLabelSpec(t,"transform","transformLabel")}}class R1 extends _p{constructor(){super(...arguments),this.type=Y.funnel,this._funnelMarkName="funnel",this._funnelMarkType="polygon",this._transformMarkName="transform",this._transformMarkType="polygon",this.transformerConstructor=R0,this._funnelMark=null,this._funnelTransformMark=null,this._labelMark=null,this._transformLabelMark=null,this._funnelOuterLabelMark={}}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t,e,i,r,n;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this._funnelOrient=null!=(t=this._spec.funnelOrient)?t:"top",this._shape=null!=(e=this._spec.shape)?e:"trapezoid",this._minLabelLineWidth=null!=(n=null==(r=null==(i=this._spec.outerLabel)?void 0:i.line)?void 0:r.minLength)?n:20,this._isHorizontal()?this._funnelAlign=["top","bottom"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center":this._funnelAlign=["left","right"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center",!this._seriesField&&this._spec.categoryField&&this.setSeriesField(this._spec.categoryField)}initData(){if(super.initData(),!this._data)return;dL(this._dataSet,"funnel",RH),dL(this._dataSet,"funnelTransform",RD);let t=new eq.V(this._dataSet,{name:`${d9}_series_${this.id}_viewDataTransform`});t.parse([this.getViewData()],{type:"dataview"}),this._viewDataTransform=new pV(this._option,t)}compile(){var t,e;super.compile(),this._funnelOuterLabelMark&&(null==(t=this._funnelOuterLabelMark.label)||t.compile({group:this._rootMark.getProduct()}),null==(e=this._funnelOuterLabelMark.line)||e.compile({group:this._rootMark.getProduct()}))}compileData(){var t;super.compileData(),null==(t=this._viewDataTransform)||t.compile()}getStatisticFields(){let t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}_statisticViewData(){var t,e,i,r,n,l,s,a,o;super._statisticViewData(),this._data.getDataView().transform({type:"funnel",options:{valueField:this.getValueField(),isCone:this._spec.isCone,asCurrentValue:RU,asTransformRatio:Rz,asReachRatio:RW,asHeightRatio:RZ,asValueRatio:RN,asNextValueRatio:RG,asLastValueRatio:Rj,asLastValue:RV,asNextValue:RK,range:{min:null!=(e=null==(t=this._spec.range)?void 0:t.min)?e:null==(r=null==(i=this.getViewDataStatistics().latestData)?void 0:i[this.getValueField()])?void 0:r.min,max:null!=(l=null==(n=this._spec.range)?void 0:n.max)?l:null==(a=null==(s=this.getViewDataStatistics().latestData)?void 0:s[this.getValueField()])?void 0:a.max}}}),null==(o=this._viewDataTransform.getDataView())||o.transform({type:"funnelTransform",options:{asIsTransformLevel:RX}})}initMark(){var t,e,i,r,n,l,s,a;if(this._funnelMark=this._createMark(Object.assign(Object.assign({},R1.mark.funnel),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null==(t=this._theme)?void 0:t.funnel,groupKey:this._seriesField,isSeriesMark:!0,noSeparateStyle:!0},{morph:_h(this._spec,this._funnelMarkName),morphElementKey:this._seriesField}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(Object.assign(Object.assign({},R1.mark.transform),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null==(e=this._theme)?void 0:e.transform,noSeparateStyle:!0}),this._funnelTransformMark&&this._funnelTransformMark.setData(this._viewDataTransform)),null==(r=null==(i=this._spec)?void 0:i.outerLabel)?void 0:r.visible){let{line:t}=null!=(n=this._spec.outerLabel)?n:{},{line:e}=null!=(s=null==(l=this._theme)?void 0:l.outerLabel)?s:{};this._funnelOuterLabelMark.label=this._createMark(R1.mark.outerLabel,{themeSpec:null==(a=this._theme)?void 0:a.outerLabel,markSpec:this._spec.outerLabel,noSeparateStyle:!0,parent:!1}),this._funnelOuterLabelMark.line=this._createMark(R1.mark.outerLabelLine,{themeSpec:e,markSpec:t,noSeparateStyle:!0,parent:!1})}}initTooltip(){this._tooltipHelper=new RY(this),this._funnelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelMark),this._funnelTransformMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelTransformMark)}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return[this._valueField]}getGroupFields(){return null}initMarkStyle(){var t,e,i,r;let n=this._funnelMark;n&&this.setMarkStyle(n,{points:t=>this.getPoints(t),visible:t=>(0,aw.Z)(t[this._valueField]),fill:this.getColorAttribute()},"normal",to.Series);let l=this._funnelTransformMark;l&&this.setMarkStyle(l,{points:t=>this.getPoints(t)},"normal",to.Series);let s=this._funnelOuterLabelMark.label;s&&(this.setMarkStyle(s,{text:t=>`${t[this.getCategoryField()]}`,x:t=>this._computeOuterLabelPosition(t).x,y:t=>this._computeOuterLabelPosition(t).y,textAlign:t=>this._computeOuterLabelPosition(t).align,textBaseline:t=>this._computeOuterLabelPosition(t).textBaseline,maxLineWidth:t=>this._computeOuterLabelLimit(t),width:0,height:0},"normal",to.Series),(0,nz.Z)(this._spec.outerLabel.formatMethod)&&this.setMarkStyle(s,{text:t=>this._spec.outerLabel.formatMethod(`${t[this.getCategoryField()]}`,t)},"normal",to.User_Mark));let a=this._funnelOuterLabelMark.line;if(a&&s){this.setMarkStyle(a,{x:t=>this._computeOuterLabelLinePosition(t).x1,y:t=>this._computeOuterLabelLinePosition(t).y1,x1:t=>this._computeOuterLabelLinePosition(t).x2,y1:t=>this._computeOuterLabelLinePosition(t).y2},"normal",to.Series);let n=null!=(i=null==(e=null==(t=this._spec.outerLabel)?void 0:t.line)?void 0:e.visible)?i:null==(r=this._spec.outerLabel)?void 0:r.visible;(0,aw.Z)(n)&&a.setVisible(n)}}initLabelMarkStyle(t){var e;if(!t)return;let i=t.getTarget(),r=t.getComponent();if(i===this._funnelMark){this._labelMark=t,this.setMarkStyle(t,{text:t=>`${t[this.getCategoryField()]} ${t[this.getValueField()]}`,x:t=>this._computeLabelPosition(t).x,y:t=>this._computeLabelPosition(t).y,maxLineWidth:t=>this._computeLabelLimit(t,this._spec.label),stroke:this.getColorAttribute()},"normal",to.Series);let i=this.getCompiler().getRootMarks();this._funnelOuterLabelMark.label&&SL(i,this._funnelOuterLabelMark.label,r),this._funnelOuterLabelMark.line&&SL(i,this._funnelOuterLabelMark.line,null!=(e=this._funnelOuterLabelMark.label)?e:r)}else this._funnelTransformMark&&i===this._funnelTransformMark&&(this._transformLabelMark=t,this.setMarkStyle(t,{text:t=>`${(100*hu(RW).bind(this)(t)).toFixed(1)}%`,x:t=>this._computeLabelPosition(t).x,y:t=>this._computeLabelPosition(t).y,maxLineWidth:t=>this._computeLabelLimit(t,this._spec.transformLabel)},"normal",to.Series))}initAnimation(){var t,e,i,r,n,l,s;let a=null!=(i=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset)?i:"clipIn";"clipIn"===a&&this._rootMark&&this._rootMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("cartesianGroupClip"))?void 0:r({direction:()=>this._isHorizontal()?"x":"y",width:()=>{let t=this.getRootMark().getProduct();if(t){let{x1:e,x2:i}=t.AABBBounds;return Math.max(e,i)}return this.getLayoutRect().width},height:()=>{let t=this.getRootMark().getProduct();if(t){let{y1:e,y2:i}=t.AABBBounds;return Math.max(e,i)}return this.getLayoutRect().height},orient:()=>this._isReverse()?"negative":"positive"},a),_s("group",this._spec,this._markAttributeContext))),[null==(n=this._funnelOuterLabelMark)?void 0:n.label].forEach(t=>{t&&t.setAnimationConfig(_l(h9.getAnimationInKey("fadeInOut")(),_s(t.name,this._spec,this._markAttributeContext)))}),[this._funnelMark,this._funnelTransformMark].forEach(t=>{t&&t.setAnimationConfig(_l(h9.getAnimationInKey("funnel")({},a),_s(t.name,this._spec,this._markAttributeContext)))}),(null==(l=this._funnelOuterLabelMark)?void 0:l.line)&&this._funnelOuterLabelMark.line.setAnimationConfig(_l(null==(s=h9.getAnimationInKey("fadeInOut"))?void 0:s(),_s("outerLabelLine",this._spec,this._markAttributeContext)))}initGroups(){}getStackGroupFields(){return[]}getStackValueField(){return null}initEvent(){var t;super.initEvent(),null==(t=this._viewDataTransform.getDataView())||t.target.addListener("change",t=>{this._viewDataTransform.updateData()})}getPoints(t){let e,i,r=this.isTransformLevel(t),n=this._getMainAxisLength(r)/2;r?(e="rect"===this._shape?this._getSecondaryAxisLength(t[Rj])/2:this._getSecondaryAxisLength(t[RN])/2,i=this._getSecondaryAxisLength(t[RN])/2):(e=this._getSecondaryAxisLength(t[RN])/2,i="rect"===this._shape?e:this._getSecondaryAxisLength(t[RG])/2);let{x:l,y:s}=this._getPositionByData(t),a=this._getPolygonPoints([l,s],e,i,e,i,n);return"center"!==this._funnelAlign&&this._adjustPoints(a),a}isTransformLevel(t){return!!(null==t?void 0:t[RX])}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getPoints=this.getPoints.bind(this),this._markAttributeContext.isTransformLevel=this.isTransformLevel.bind(this)}valueToPosition(t){var e,i,r;let n=null==(r=null==(i=null==(e=this.getViewData())?void 0:e.latestData)?void 0:i.find)?void 0:r.call(i,e=>e[this._categoryField]===t);return(0,aw.Z)(n)?this._getPolygonCenter(this.getPoints(n)):null}dataToPosition(t,e){return e&&!this.isDatumInViewData(t)?null:this.valueToPosition(t[this._categoryField])}dataToPositionX(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.x}dataToPositionY(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.y}dataToPositionZ(t){return 0}_getMainAxisLength(t=!1){var e;let i=this.getViewData().latestData.length,r=this._isHorizontal()?this.getLayoutRect().width:this.getLayoutRect().height,n=!!this._spec.isTransform,l=n?0:null!=(e=this._spec.gap)?e:0,s=n?Math.max(0,i-1):0,a=this._spec.heightRatio||.5,o=(r-l*Math.max(0,i-1))/(i+a*s);return t?n?o*a:0:o}_getSecondaryAxisLength(t){let e=Number.isNaN(t)||!Number.isFinite(t)?0:t,i=this._computeMaxSize(),r=this._computeMinSize();return r+(i-r)*e}_getPositionByData(t){var e;let i=null==(e=this.getViewData().latestData)?void 0:e.findIndex(e=>e[this._categoryField]===t[this._categoryField]&&e[un]===t[un]);if(!(0,aw.Z)(i)||i<0)return{};let r=this.isTransformLevel(t),n=this._isHorizontal(),l=n?this.getLayoutRect().height:this.getLayoutRect().width,s=n?this.getLayoutRect().width:this.getLayoutRect().height,a=l/2,o=0,h=this._getMainAxisLength(),d=this._getMainAxisLength(!0);return o+=i*(h+d)+(r?-d/2:h/2),!this._spec.isTransform&&this._spec.gap&&(o+=this._spec.gap*i),this._isReverse()&&(o=s-o),this._isHorizontal()?{x:o,y:a}:{x:a,y:o}}_getPolygonPoints(t,e,i,r,n,l){let s=t[0],a=t[1];switch(this._funnelOrient){case"left":return[{x:s-l,y:a+e},{x:s-l,y:a-r},{x:s+l,y:a-n},{x:s+l,y:a+i}];case"right":return[{x:s+l,y:a-r},{x:s+l,y:a+r},{x:s-l,y:a+i},{x:s-l,y:a-i}];case"bottom":return[{x:s+e,y:a+l},{x:s-r,y:a+l},{x:s-n,y:a-l},{x:s+i,y:a-l}];default:return[{x:s-e,y:a-l},{x:s+r,y:a-l},{x:s+n,y:a+l},{x:s-i,y:a+l}]}}_getPolygonCenter(t){if(this._isHorizontal()){let e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}let e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}_adjustPoints(t){let e,i,r;return this._isHorizontal()?(r="y","left"===this._funnelOrient?(e="bottom"===this._funnelAlign?-t[1].y:t[1].y,i="bottom"===this._funnelAlign?-t[2].y:t[2].y):(e="bottom"===this._funnelAlign?-t[0].y:t[0].y,i="bottom"===this._funnelAlign?-t[3].y:t[3].y)):(r="x","top"===this._funnelOrient?(e="left"===this._funnelAlign?t[0].x:-t[0].x,i="left"===this._funnelAlign?t[3].x:-t[3].x):(e="left"===this._funnelAlign?t[1].x:-t[1].x,i="left"===this._funnelAlign?t[2].x:-t[2].x)),t[0][r]-=e,t[1][r]-=e,t[2][r]-=i,t[3][r]-=i,t}_computeLabelPosition(t){let e=this.getPoints(t);return this._getPolygonCenter(e)}_computeLabelLimit(t,e){let i=null==e?void 0:e.limit;if((0,n4.Z)(i))return i;let r=this.getPoints(t);return"shapeSize"===i?this._isHorizontal()?Math.abs(r[3].x-r[0].x):(Math.abs(r[0].x-r[1].x)+Math.abs(r[2].x-r[3].x))/2:this._isHorizontal()?Math.abs(r[3].x-r[0].x):void 0}_computeOuterLabelPosition(t){var e,i;let r,n,l=null==(e=this._spec.outerLabel)?void 0:e.position,s="center",a="middle";if(l=this._isHorizontal()?["top","bottom"].includes(l)?l:"bottom"===this._funnelAlign?"top":"bottom":["left","right"].includes(l)?l:"left"===this._funnelAlign?"right":"left",!1!==(null==(i=this._spec.outerLabel)?void 0:i.alignLabel))({x:r,y:n}=this._getPositionByData(t)),"left"===l?(r=0,s="left"):"right"===l?(r=this.getLayoutRect().width,s="right"):"top"===l?(n=0,a="top"):"bottom"===l&&(n=this.getLayoutRect().height,a="bottom");else{let{x2:e,y2:i}=this._computeOuterLabelLinePosition(t);r=e,n=i,"left"===l?(r-=5,s="right"):"right"===l?(r+=5,s="left"):"top"===l?(n-=5,a="bottom"):"bottom"===l&&(n+=5,a="top")}return{x:r,y:n,align:s,textBaseline:a}}_computeOuterLabelLimit(t){var e,i,r,n,l,s;if(this._isHorizontal())return this._getMainAxisLength(this.isTransformLevel(t));let a=this.getPoints(t),o=(Math.abs(a[0].x-a[1].x)+Math.abs(a[2].x-a[3].x))/2,h=this.getCategoryField(),d=null==(n=null==(r=null==(i=null==(e=this._labelMark)?void 0:e.getComponent())?void 0:i.getComponent())?void 0:r.find(({attribute:e,type:i})=>{var r;return"text"===i&&(null==(r=e.data)?void 0:r[h])===t[h]},!0))?void 0:n.AABBBounds,u=d?d.x2-d.x1:0,c=this._funnelOuterLabelMark.line?this._minLabelLineWidth:0,p=this.getLayoutRect().width-Math.max(o,u);return"center"===this._funnelAlign&&(p/=2),p-c-(null!=(s=null==(l=this._spec.outerLabel)?void 0:l.spaceWidth)?s:5)}_computeOuterLabelLinePosition(t){var e,i,r,n,l,s,a,o,h,d;let u,c,p,g,f=this.getCategoryField(),m=null==(n=null==(r=null==(i=null==(e=this._funnelOuterLabelMark)?void 0:e.label)?void 0:i.getGraphics())?void 0:r.find(e=>{var i;return(null==(i=e.context.data[0])?void 0:i[f])===t[f]}))?void 0:n.AABBBounds,y=null==(s=null==(l=this._labelMark)?void 0:l.getComponent())?void 0:s.getComponent(),v=null==(a=null==y?void 0:y.find(({attribute:e,type:i})=>{var r;return"text"===i&&(null==(r=e.data)?void 0:r[f])===t[f]},!0))?void 0:a.AABBBounds,b=null!=(o=this._spec.outerLabel)?o:{};if(this._isHorizontal()){let e=null!=(h=b.spaceWidth)?h:5,i=this.getPoints(t),r=(Math.abs(i[0].y-i[1].y)+Math.abs(i[2].y-i[3].y))/2;return"top"===this._spec.outerLabel.position||"bottom"===this._funnelAlign?(p=this._getPolygonCenter(i).y-r/2-e,g=!1!==b.alignLabel?(null==m?void 0:m.y2)+e:p-e,u=this._getPolygonCenter(i).x,p-g<this._minLabelLineWidth&&(g=p-this._minLabelLineWidth)):(p=this._getPolygonCenter(i).y+r/2+e,g=!1!==b.alignLabel?(null==m?void 0:m.y1)-e:p+e,u=this._getPolygonCenter(i).x,g-p<this._minLabelLineWidth&&(g=p+this._minLabelLineWidth)),c=u,{x1:u,x2:c,y1:p,y2:g}}let _=this.getPoints(t),C=(Math.abs(_[0].x-_[1].x)+Math.abs(_[2].x-_[3].x))/2,x=(null==v?void 0:v.x2)-(null==v?void 0:v.x1)||0,w=null!=(d=b.spaceWidth)?d:5;return"right"===this._spec.outerLabel.position||"left"===this._funnelAlign?(u=this._getPolygonCenter(_).x+Math.max(x/2,C/2)+w,c=!1!==b.alignLabel?(null==m?void 0:m.x1)-w:u+w,p=this._getPolygonCenter(_).y,c-u<this._minLabelLineWidth&&(c=u+this._minLabelLineWidth)):(u=this._getPolygonCenter(_).x-Math.max(x/2,C/2)-w,c=!1!==b.alignLabel?(null==m?void 0:m.x2)+w:u-w,p=this._getPolygonCenter(_).y,u-c<this._minLabelLineWidth&&(c=u-this._minLabelLineWidth)),g=p,{x1:u,x2:c,y1:p,y2:g}}_computeMaxSize(){var t;let e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return hw(null!=(t=this._spec.maxSize)?t:"80%",e)}_computeMinSize(){var t;let e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return hw(null!=(t=this._spec.minSize)?t:0,e)}_isHorizontal(){return"left"===this._funnelOrient||"right"===this._funnelOrient}_isReverse(){return"bottom"===this._funnelOrient||"right"===this._funnelOrient}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._funnelMark]}}R1.type=Y.funnel,R1.mark=RQ,R1.builtInTheme={funnel:dr},R1.transformerConstructor=R0;let R2=()=>{RJ(),kH(),kk(),h9.registerSeries(R1.type,R1),h9.registerAnimation("funnel",(t,e)=>Object.assign({appear:"clipIn"===e?void 0:{type:"fadeIn"}},vK)),v$(),vY()};class R3 extends Ai{needAxes(){return!1}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","funnelAlign","funnelOrient","heightRatio","shape","funnel","transform","outerLabel","transformLabel","isTransform","maxSize","minSize","gap","isCone","range","transformRatioText"])}transformSpec(t){super.transformSpec(t),super.transformSeriesSpec(t)}}class R5 extends Ah{constructor(){super(...arguments),this.transformerConstructor=R3,this.type="funnel",this.seriesType=Y.funnel}}R5.type="funnel",R5.seriesType=Y.funnel,R5.transformerConstructor=R3;let R4=()=>{A$(),R2(),h9.registerChart(R5.type,R5)},R6=t=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:()=>"vertical"===t.direction?{orient:"negative"}:{orient:"positive"}}),R7={type:"fadeIn"};function R8(t,e="grow"){return!1===e?{}:"fadeIn"===e?R7:R6(t)}let R9=()=>{h9.registerAnimation("linearProgress",(t,e)=>({appear:R8(t,e),enter:R8(t),disappear:{duration:vV.disappear.duration}}))};class Pt extends bY{enableByType(t){return"dimension"!==t}}let Pe=Object.assign(Object.assign({},b7),{track:{name:"track",type:"rect"},progress:{name:"progress",type:"rect"},group:{name:"group",type:"group"}});class Pi extends _y{constructor(){super(...arguments),this.type=Y.linearProgress,this._progressMark=null,this._trackMark=null,this._defaultProgressCustomShape=(t,e,i)=>{var r,n;let l=null==(r=this._spec)?void 0:r.cornerRadius,s=(0,aw.Z)(e.width)?e.width:e.x1-e.x,a=(0,aw.Z)(e.height)?e.height:e.y1-e.y,o=Math.min(0,s),h=Math.max(0,s),d=Math.min(0,a),u=Math.max(0,a);if(l>0){let t=l;if("vertical"===(null==(n=this._spec)?void 0:n.direction)){if(2*(t=Math.min(Math.abs(s/2),l))>Math.abs(a)){let e=Math.acos((t-Math.abs(a)/2)/t);return i.moveTo(o+t,d),i.arc(o+t,d+t,t,1.5*Math.PI,1.5*Math.PI-e,!0),i.arc(o+t,u-t,t,e+Math.PI/2,Math.PI/2,!0),i.lineTo(h-l,u),i.arc(h-t,u-t,t,Math.PI/2,Math.PI/2-e,!0),i.arc(h-t,d+t,t,-Math.PI/2+e,-Math.PI/2,!0),i.lineTo(o+t,d),i.closePath(),i}}else if(2*(t=Math.min(Math.abs(a/2),l))>Math.abs(s)){let e=Math.acos((t-Math.abs(s)/2)/t);return i.moveTo(o,d+t),i.arc(o+t,d+t,t,Math.PI,Math.PI+e),i.arc(h-t,d+t,t,-e,0),i.lineTo(h,u-t),i.arc(h-t,u-t,t,0,e),i.arc(o+t,u-t,t,Math.PI-e,Math.PI),i.closePath(),i}i.moveTo(o,d+t),i.arc(o+t,d+t,t,Math.PI,1.5*Math.PI),i.lineTo(h-t,d),i.arc(h-t,d+t,t,-Math.PI/2,0),i.lineTo(h,u-t),i.arc(h-t,u-t,t,0,Math.PI/2),i.lineTo(o+t,u),i.arc(o+t,u-t,t,Math.PI/2,Math.PI),i.closePath()}else i.moveTo(o,d),i.lineTo(h,d),i.lineTo(h,u),i.lineTo(o,u),i.closePath();return i}}initMark(){this._initTrackMark(),this._initProgressMark()}initMarkStyle(){this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){var t;return this._progressMark=this._createMark(Pi.mark.progress,{isSeriesMark:!0}),(0,nB.Z)(null==(t=this._spec.progress)?void 0:t.customShape)&&this._progressMark.setMarkConfig({setCustomizedShape:this._defaultProgressCustomShape}),this._progressMark}_initProgressMarkStyle(){var t,e,i,r;let n=this._progressMark;if(n)if("vertical"===this._spec.direction){let i=this._spec.progress||{},r=null!=(t=i.leftPadding)?t:0,l=null!=(e=i.rightPadding)?e:0;this.setMarkStyle(n,{x:t=>{var e,i;return pF(this.dataToPositionX(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0),!0)-this._spec.bandWidth/2+r},y1:t=>{var e,i;return pF(this.dataToPositionY(t),null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:()=>{var t,e,i;let r=null==(t=this._yAxisHelper)?void 0:t.dataToPosition([0],{bandPosition:this._bandPosition});return this._spec.clamp?pF(r,null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0)):r},width:this._spec.bandWidth-r-l,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",to.Series)}else{let t=this._spec.progress||{},e=null!=(i=t.topPadding)?i:0,l=null!=(r=t.bottomPadding)?r:0;this.setMarkStyle(n,{x1:t=>{var e,i;return pF(this.dataToPositionX(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:t=>{var i,r;return pF(this.dataToPositionY(t),null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0),!0)-this._spec.bandWidth/2+e},height:this._spec.bandWidth-e-l,x:()=>{var t,e,i;let r=null==(t=this._xAxisHelper)?void 0:t.dataToPosition([0],{bandPosition:this._bandPosition});return this._spec.clamp?pF(r,null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0)):r},cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",to.Series)}}_initTrackMark(){return this._trackMark=this._createMark(Pi.mark.track),this._trackMark}_initTrackMarkStyle(){let t=this._trackMark;t&&("vertical"===this._spec.direction?this.setMarkStyle(t,{x:t=>{var e,i;return pF(this.dataToPositionX(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0),!0)-this._spec.bandWidth/2},y:0,width:this._spec.bandWidth,height:()=>this._scaleY.range()[0],cornerRadius:this._spec.cornerRadius},"normal",to.Series):this.setMarkStyle(t,{x:0,y:t=>{var e,i;return pF(this.dataToPositionY(t),null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0),!0)-this._spec.bandWidth/2},height:this._spec.bandWidth,width:()=>this._scaleX.range()[1],cornerRadius:this._spec.cornerRadius},"normal",to.Series))}getInteractionTriggers(){let t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)}initAnimation(){var t,e,i,r;let n={direction:this.direction},l=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._progressMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("linearProgress"))?void 0:i(n,l),_s("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("fadeInOut"))?void 0:r(),_s("track",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new Pt(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark),this._trackMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._trackMark)}getActiveMarks(){return[this._progressMark]}}Pi.type=Y.linearProgress,Pi.mark=Pe,Pi.builtInTheme={linearProgress:{bandWidth:30,progress:{style:{fillOpacity:1}},track:{style:{fill:{type:"palette",key:"linearProgressTrackColor"},fillOpacity:1}}}};let Pr=()=>{Mw(),R9(),vY(),h9.registerSeries(Pi.type,Pi)};class Pn extends Ar{needAxes(){return!1}_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t,["bandWidth","progress","track","clamp"]);return r.direction=null!=(e=t.direction)?e:"horizontal",r.cornerRadius=null!=(i=t.cornerRadius)?i:0,r}transformSpec(t){var e,i;if(super.transformSpec(t),t.axes||(t.axes=[]),"vertical"===t.direction){let i=null,r=null;(null!=(e=t.axes)?e:[]).forEach(t=>{let{orient:e}=t;"left"===e&&(i=t),"bottom"===e&&(r=t)}),i||(i={orient:"left",visible:!1},t.axes.push(i)),r||(r={orient:"bottom",visible:!1},t.axes.push(r)),(0,nB.Z)(r.type)&&(r.type="band"),(0,nB.Z)(i.type)&&(i.type="linear");let n=xy(i,{min:0,max:1});(0,nB.Z)(i.min)&&(i.min=n.min),(0,nB.Z)(i.max)&&(i.max=n.max)}else{let e=null,r=null;(null!=(i=t.axes)?i:[]).forEach(t=>{let{orient:i}=t;"left"===i&&(e=t),"bottom"===i&&(r=t)}),e||(e={type:"band",orient:"left",visible:!1},t.axes.push(e)),r||(r={orient:"bottom",visible:!1},t.axes.push(r)),(0,nB.Z)(r.type)&&(r.type="linear"),(0,nB.Z)(e.type)&&(e.type="band");let n=xy(r,{min:0,max:1});(0,nB.Z)(r.min)&&(r.min=n.min),(0,nB.Z)(r.max)&&(r.max=n.max)}}}class Pl extends Ah{constructor(){super(...arguments),this.transformerConstructor=Pn,this.type="linearProgress",this.seriesType=Y.linearProgress}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}Pl.type="linearProgress",Pl.seriesType=Y.linearProgress,Pl.transformerConstructor=Pn,(0,yf.jB)(Pl,Ac);let Ps=()=>{AX(),A$(),AM(),Af(),Pr(),h9.registerChart(Pl.type,Pl)};class Pa extends bY{constructor(){super(...arguments),this._getMeasureData=t=>"horizontal"===this.series.getSpec().direction?t[this.series.getSpec().xField[0]]+"-"+t[this.series.getSpec().xField[1]]:t[this.series.getSpec().yField[0]]+"-"+t[this.series.getSpec().yField[1]]}}let Po=t=>({type:"growCenterIn",options:{direction:"horizontal"===t.direction?"x":"y"}}),Ph={type:"fadeIn"},Pd=t=>({type:"growCenterOut",options:{direction:"horizontal"===t.direction?"x":"y"}}),Pu=()=>{h9.registerAnimation("rangeColumn",(t,e)=>({appear:"fadeIn"===e?Ph:Po(t),enter:Po(t),exit:Pd(t),disappear:{duration:vV.disappear.duration}}))},Pc=Object.assign(Object.assign({},MS),{minLabel:{name:"minLabel",type:"text"},maxLabel:{name:"maxLabel",type:"text"}});class Pp extends MM{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){var e;"bothEnd"!==(null==(e=t.label)?void 0:e.position)&&this._addMarkLabelSpec(t,"bar")}}class Pg extends MT{constructor(){super(...arguments),this.type=Y.rangeColumn,this._barMarkType="rect",this._barName=Y.bar,this.transformerConstructor=Pp}initMark(){var t,e,i,r,n,l,s,a;this._initBarBackgroundMark();let o=null==(t=this._spec.label)?void 0:t.position;this._barMark=this._createMark(Pg.mark.bar,{groupKey:this._seriesField,isSeriesMark:!0},{morph:_h(this._spec,Pg.mark.bar.name),morphElementKey:this.getDimensionField()[0]}),!1!==(null==(e=this._spec.label)?void 0:e.visible)&&"bothEnd"===o&&(!1!==(null==(r=null==(i=this._spec.label)?void 0:i.minLabel)?void 0:r.visible)&&(this._minLabelMark=this._createMark(Pg.mark.minLabel,{markSpec:null==(n=this._spec.label)?void 0:n.minLabel})),!1!==(null==(s=null==(l=this._spec.label)?void 0:l.maxLabel)?void 0:s.visible)&&(this._maxLabelMark=this._createMark(Pg.mark.maxLabel,{markSpec:null==(a=this._spec.label)?void 0:a.maxLabel})))}initMarkStyle(){var t,e;super.initMarkStyle(),this._initLabelMarkPos(this._minLabelMark,null==(t=this._spec.label)?void 0:t.minLabel,0,"end"),this._initLabelMarkPos(this._maxLabelMark,null==(e=this._spec.label)?void 0:e.maxLabel,1,"start")}_initLabelMarkPos(t,e,i,r){var n,l,s,a,o,h,d,u,c;if(t){this.setMarkStyle(t,{fill:null!=(l=null==(n=null==e?void 0:e.style)?void 0:n.fill)?l:this.getColorAttribute(),text:t=>{let r="horizontal"===this._spec.direction?t[this._spec.xField[i]]:t[this._spec.yField[i]];return(null==e?void 0:e.formatMethod)?e.formatMethod(r,t):r}});let p=null!=(s=null==e?void 0:e.position)?s:r,g=null!=(a=null==e?void 0:e.offset)?a:"vertical"===this._direction?-20:-25;o=t=>this._barMark.getAttribute("x",t),h=t=>"vertical"===this._direction?this._barMark.getAttribute("x",t)+this._barMark.getAttribute("width",t):this._barMark.getAttribute("x1",t),d=t=>this._barMark.getAttribute("y",t),u=t=>"vertical"===this._direction?this._barMark.getAttribute("y1",t):this._barMark.getAttribute("y",t)+this._barMark.getAttribute("height",t),c=()=>this._direction,this.setMarkStyle(t,{textAlign:t=>{if("vertical"===c())return"center";let e=o(t),i=h(t);if("middle"===p)return"center";if(e>=i){if("start"===p)return"left";if("end"===p)return"right";if("outside"===p)return"left"}else{if("start"===p)return"right";if("end"===p)return"left";if("outside"===p)return"right"}return"center"},textBaseline:t=>{if("horizontal"===c())return"middle";let e=d(t),i=u(t);if("middle"===p)return"middle";if(i>=e){if("start"===p)return"bottom";if("end"===p)return"top";if("outside"===p)return"bottom"}else{if("start"===p)return"top";if("end"===p)return"bottom";if("outside"===p)return"top"}return"middle"}}),this.setMarkStyle(t,{x:t=>{let e=c(),i=o(t),r=h(t);if("vertical"===e||"middle"===p)return(i+r)/2;if(i>=r){if("start"===p)return r+g;if("end"===p)return i-g;if("outside"===p)return i+g}else{if("start"===p)return r-g;if("end"===p)return i+g;if("outside"===p)return i-g}return(i+r)/2},y:t=>{let e=c(),i=d(t),r=u(t);if("horizontal"===e||"middle"===p)return(i+r)/2;if(i>=r){if("start"===p)return r+g;if("end"===p)return i-g;if("outside"===p)return i+g}else{if("start"===p)return r-g;if("end"===p)return i+g;if("outside"===p)return i-g}return(i+r)/2}},"normal",to.Series)}}initLabelMarkStyle(t){t&&(this.setMarkStyle(t,{text:t=>{let e,i;return"horizontal"===this._spec.direction?(e=t[this._spec.xField[0]],i=t[this._spec.xField[1]]):(e=t[this._spec.yField[0]],i=t[this._spec.yField[1]]),e+"-"+i},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._labelMark=t)}_dataToPosX(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[0]),{bandPosition:this._bandPosition})}_dataToPosX1(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})}_dataToPosY(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[0]),{bandPosition:this._bandPosition})}_dataToPosY1(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})}initAnimation(){var t,e,i,r,n;let l=_m(this),s=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._barMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("rangeColumn"))?void 0:i({direction:this.direction},s),_s("bar",this._spec,this._markAttributeContext),l)),this._minLabelMark&&this._minLabelMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("fadeInOut"))?void 0:r(),_s("label",this._spec,this._markAttributeContext),l)),this._maxLabelMark&&this._maxLabelMark.setAnimationConfig(_l(null==(n=h9.getAnimationInKey("fadeInOut"))?void 0:n(),_s("label",this._spec,this._markAttributeContext),l))}initTooltip(){this._tooltipHelper=new Pa(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark),this._minLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._minLabelMark),this._maxLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._maxLabelMark),this._labelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._labelMark)}}Pg.type=Y.rangeColumn,Pg.mark=Pc,Pg.builtInTheme={rangeColumn:{label:{visible:!1,offset:5,position:"inside",style:{lineWidth:2,fill:{type:"palette",key:"axisMarkerFontColor"}},minLabel:{position:"end"},maxLabel:{position:"start"}}}},Pg.transformerConstructor=Pp;let Pf=()=>{Mw(),kH(),Pu(),vY(),SI(),SX(),h9.registerSeries(Pg.type,Pg)};class Pm extends Ar{_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar"]);return"horizontal"===t.direction?r.xField=null!=(e=t.xField)?e:[t.minField,t.maxField]:r.yField=null!=(i=t.yField)?i:[t.minField,t.maxField],r}transformSpec(t){super.transformSpec(t),c8(t)}}class Py extends Ah{constructor(){super(...arguments),this.transformerConstructor=Pm,this.type="rangeColumn",this.seriesType=Y.rangeColumn}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}Py.type="rangeColumn",Py.seriesType=Y.rangeColumn,Py.transformerConstructor=Pm;let Pv=()=>{AX(),A$(),AM(),Af(),Pf(),h9.registerChart(Py.type,Py)},Pb=(t,e)=>Math.max(0,Math.min(1,(t-e[0])/(e[1]-e[0]||1))),P_=t=>{let e=t.filter(t=>t.context.diffState===th.update),i=(0,a1.iH)(e.map(t=>{var e,i;return null==(i=null==(e=null==t?void 0:t.context)?void 0:e.data)?void 0:i[0].depth}));return e.filter(t=>{var e,r;return(null==(r=null==(e=null==t?void 0:t.context)?void 0:e.data)?void 0:r[0].depth)===i})},PC=(t,e,i)=>(0,uF.Z)(t)?[e,i]:[(0,a1.iH)(t.map(t=>+t.getFinalAttribute().startAngle)),(0,a1.CE)(t.map(t=>+t.getFinalAttribute().endAngle))],Px=t=>({channel:{startAngle:{from:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),l=PC(P_(i.parent.children),r,n);return Pb(i.getFinalAttribute().startAngle,l)*(n-r)+r},to:(t,e)=>e.getFinalAttribute().startAngle},endAngle:{from:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),l=PC(P_(i.parent.children),r,n);return Pb(i.getFinalAttribute().endAngle,l)*(n-r)+r},to:(t,e)=>e.getFinalAttribute().endAngle},outerRadius:{from:(t,e)=>e.getFinalAttribute().innerRadius,to:(t,e)=>e.getFinalAttribute().outerRadius},innerRadius:{from:(t,e)=>e.getFinalAttribute().innerRadius,to:(t,e)=>e.getFinalAttribute().innerRadius}}}),Pw=t=>[(0,a1.iH)(t.map(t=>+t.getFinalAttribute().startAngle)),(0,a1.CE)(t.map(t=>+t.getFinalAttribute().endAngle))],PS=t=>({channel:{startAngle:{from:(t,e)=>e.getFinalAttribute().startAngle,to:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),l=Pw(P_(i.parent.children));return Pb(i.getFinalAttribute().startAngle,l)*(n-r)+r}},endAngle:{from:(t,e)=>e.getFinalAttribute().endAngle,to:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),l=Pw(P_(i.parent.children));return Pb(i.getFinalAttribute().endAngle,l)*(n-r)+r}},outerRadius:{from:(t,e)=>e.getFinalAttribute().outerRadius,to:()=>t.animationInfo().innerRadius},innerRadius:{from:(t,e)=>e.getFinalAttribute().innerRadius,to:()=>t.animationInfo().innerRadius}}}),PA=(t,e)=>{switch(e){case"fadeIn":return{type:"fadeIn"};case"growAngle":return{type:"growAngleIn"};default:return{type:"growRadiusIn"}}},PM=()=>{h9.registerAnimation("sunburst",(t,e)=>({appear:PA(t,e),enter:Px(t),exit:PS(t),disappear:{duration:vV.disappear.duration}}))};var PT=i(93364);let Pk=(t,e={})=>{if(!t)return[];let i=[];return(0,PT.bp)(t,i,e),i};var PR=i(31563);let PP=(t,e)=>{if(!t)return t;let i=e(),{width:r,height:n}=i;return new PR.p(i).layout(t,{width:r,height:n})};class PB extends bY{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>null==t?void 0:t[this.series.getDimensionField()[0]]}}let PI=(t,e,i="key",r="children")=>{for(let n=0;n<t.length;n++){let l=t[n];if(l[i]===e)return l;if(l[r]){let t=PI(l[r],e,i,r);if(t)return t}}return null},PE=(t,e,i="key",r="children")=>{for(let n=0;n<t.length;n++){let l=t[n];if(l[r])for(let t=0;t<l[r].length;t++){let n=l[r][t];if(n[i]===e)return l;let s=PE([n],e,i,r);if(s)return s}}return null},PL=(t,e,i="key",r="children")=>{let n=[],l=(t,s)=>{for(let a of t){if(a[i]===e)return n.push(...s,a[i].toString()),!0;if(a[r]){let t=l(a[r],[...s,a[i]]);if(!0===t)return t}}return!1};return l(t,[]),n};(tV=t3||(t3={})).DrillDown="drillDown",tV.DrillUp="drillUp";let PF=(t,e)=>{let i=e.info(),r=e.keyField(),n=null==i?void 0:i.key;if((0,nB.Z)(n))return t;if(i.type===t3.DrillDown){let e=PI(t,n,r,"children");return(0,a1.IX)(e)}if(i.type===t3.DrillUp){let e=PE(t,n,r,"children");if(e)return(0,a1.IX)(e)}return t};class PO{_getDrillTriggerEvent(t){var e;let{mode:i}=this._drillParams;return null==(e=M5(i))?void 0:e[t]}_hideTooltip(){let t=this.getChart().getComponentsByType(oQ.tooltip)[0];t&&t.hideTooltip()}initDrillable(t){this._drillParams=t}initDrillableData(t){let{getRawData:e}=this._drillParams;dL(t,"drillFilter",PF),e().transform({type:"drillFilter",options:{info:()=>this._drillInfo,keyField:()=>this._drillParams.drillField()}})}bindDrillEvent(){let{event:t,getRawData:e,drillField:i}=this._drillParams,r=i();this._getDrillTriggerEvent("start")&&t.on(this._getDrillTriggerEvent("start"),t=>{var i,n,l;if((0,nB.Z)(t.datum)||(0,nB.Z)(null==(i=t.datum)?void 0:i[r]))return void this.drillUp();this._hideTooltip();let s=t.datum[r],a=null!=(l=null==(n=this._drillInfo)?void 0:n.path)?l:[],o=PL(e().rawData,s,r,"children");a[a.length-1]===o[o.length-1]?this.drillUp():this.drillDown(o)})}drillDown(t=[]){let{getRawData:e,event:i}=this._drillParams;if(!(0,rD.Z)(t)||(0,uF.Z)(t))return t;let r=t[t.length-1];return this._drillInfo={key:r,path:t,type:t3.DrillDown},e().reRunAllTransform(),i.emit(J.drill,{value:{path:t,type:t3.DrillDown},model:this}),t}drillUp(){var t,e;let{getRawData:i,event:r}=this._drillParams,n=null!=(e=null==(t=this._drillInfo)?void 0:t.path)?e:[];if(!(0,rD.Z)(n)||(0,uF.Z)(n))return n;let l=n.pop();return this._drillInfo={key:l,path:n,type:t3.DrillUp},i().reRunAllTransform(),r.emit(J.drill,{value:{path:n,type:t3.DrillUp},model:this}),n}}let PH=Object.assign(Object.assign({},b7),{sunburst:{name:"sunburst",type:"arc"}}),PD=(t,e,i)=>(t.push({key:e,operations:["values"]}),t.push({key:i,operations:["max","min"]}),t.push({key:b0,operations:["max","min","values"]}),t.push({key:b1,operations:["values"]}),t);class Pz extends Tl{constructor(){super(...arguments),this.type=Y.sunburst}setCategoryField(t){return this._categoryField=t,this._categoryField}getCategoryField(){return this._categoryField}setValueField(t){return this._valueField=t,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:b1),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t;return null!=(t=this._spec.drillField)?t:un},getRawData:()=>this.getRawData()}),this._startAngle=(0,iH.M4)(this._spec.startAngle),this._endAngle=(0,iH.M4)(this._spec.endAngle),this._centerX=this._spec.centerX,this._centerY=this._spec.centerY,this._offsetX=this._spec.offsetX,this._offsetY=this._spec.offsetY,this.__innerRadius=this._spec.innerRadius,this.__outerRadius=this._spec.outerRadius,this._gap=this._spec.gap,this._labelLayout=this._spec.labelLayout,this._sunburst=this._spec.sunburst,this._label=this._spec.label,this._labelAutoVisible=this._spec.labelAutoVisible}initData(){super.initData();let t=this.getRawData();t&&(this._spec.drill&&this.initDrillableData(this._dataSet),dL(this._dataSet,"sunburstLayout",PP),dL(this._dataSet,"flatten",Pk),t.transform({type:"sunburstLayout",options:()=>{let{innerRadius:t,outerRadius:e,gap:i,label:r}=this._computeLevel();return{nodeKey:this._categoryField,width:this.getLayoutRect().width,height:this.getLayoutRect().height,center:[(0,aw.Z)(this._centerX)?this._centerX:this.getLayoutRect().width/2,(0,aw.Z)(this._centerY)?this._centerY:this.getLayoutRect().height/2],startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:t,outerRadius:e,gapRadius:i,label:r}}}),t.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}}))}getStatisticFields(){return PD(super.getStatisticFields(),this._categoryField,this._valueField)}_addDataIndexAndKey(){let t=this.getRawData();(0,nB.Z)(null==t?void 0:t.dataSet)||(dL(t.dataSet,"addVChartProperty",bO),t.transform({type:"addVChartProperty",options:{beforeCall:b4.bind(this),call:b6}}))}initMark(){this._initArcMark(),this._initLabelMark()}initMarkStyle(){this._initArcMarkStyle(),this._initLabelMarkStyle()}_initArcMark(){if(!1===this._sunburst.visible)return;let t=this._createMark(Pz.mark.sunburst,{isSeriesMark:!0});this._sunburstMark=t}_initArcMarkStyle(){(0,nB.Z)(this._sunburstMark)||this.setMarkStyle(this._sunburstMark,{x:t=>t.x+((0,aw.Z)(this._offsetX)?this._offsetX:0),y:t=>t.y+((0,aw.Z)(this._offsetY)?this._offsetY:0),outerRadius:t=>t.outerRadius,innerRadius:t=>t.innerRadius,startAngle:t=>t.startAngle,endAngle:t=>t.endAngle,fill:this.getColorAttribute()},td.STATE_NORMAL,to.Series)}_initLabelMark(){if(!0!==this._label.visible)return;let t=this._createMark(Pz.mark.label,{isSeriesMark:!1});this._labelMark=t}_initLabelMarkStyle(){(0,nB.Z)(this._labelMark)||this.setMarkStyle(this._labelMark,{visible:t=>{var e;let i=this._labelAutoVisible;return(0,nF.Z)(i)&&!0===i.enable?(t.endAngle-t.startAngle)*(t.outerRadius-t.innerRadius)>(null!=(e=null==i?void 0:i.circumference)?e:10):this._spec.label.visible},x:t=>{var e;return(null==(e=t.label)?void 0:e.x)+((0,aw.Z)(this._offsetX)?this._offsetX:0)},y:t=>{var e;return(null==(e=t.label)?void 0:e.y)+((0,aw.Z)(this._offsetY)?this._offsetY:0)},textBaseline:t=>{var e;return null==(e=t.label)?void 0:e.textBaseline},textAlign:t=>{var e;return null==(e=t.label)?void 0:e.textAlign},angle:t=>{var e,i;return null!=(i=null==(e=t.label)?void 0:e.angle)?i:0},fontSize:10,text:t=>t.name},td.STATE_NORMAL,to.Series)}initTooltip(){this._tooltipHelper=new PB(this),this._sunburstMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._sunburstMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var t,e;let i={animationInfo:()=>({innerRadius:this._computeRadius((0,a1.IX)(this.__innerRadius))[0],outerRadius:this._computeRadius((0,a1.IX)(this.__outerRadius))[0],startAngle:(0,a1.IX)(this._startAngle)[0],endAngle:(0,a1.IX)(this._endAngle)[0]})},r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this.getMarksInType("arc").forEach(t=>{var e;t.setAnimationConfig(_l(null==(e=h9.getAnimationInKey("sunburst"))?void 0:e(i,r),_s(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(t=>{var e;t.setAnimationConfig(_l(null==(e=h9.getAnimationInKey("fadeInOut"))?void 0:e(),_s(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(){super.onLayoutEnd(),this._rawData.reRunAllTransform()}_computeRadius(t){return(0,rD.Z)(t)?t.map(t=>this._computeLayoutRadius()*t):this._computeLayoutRadius()*t}_computeLevel(){return{innerRadius:this._computeRadius(this.__innerRadius),outerRadius:this._computeRadius(this.__outerRadius),gap:this._gap,label:this._labelLayout}}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._sunburstMark]}getMarkData(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t}}Pz.type=Y.sunburst,Pz.mark=PH,Pz.builtInTheme={sunburst:{innerRadius:0,outerRadius:1,startAngle:-90,endAngle:270,gap:0,labelLayout:{align:"center",offset:0,rotate:"radial"},sunburst:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1,cursor:"pointer"}},label:{visible:!0,style:{cursor:"pointer",fill:{type:"palette",key:"primaryFontColor"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},(0,yf.jB)(Pz,PO);let PW=()=>{h9.registerSeries(Pz.type,Pz),TS(),kH(),vY(),PM()};class PZ extends Ai{_getDefaultSeriesSpec(t){let e=(0,aw.Z)(t.startAngle)?t.startAngle:-90,i=(0,aw.Z)(t.endAngle)?t.endAngle:e+(0,iH.Dt)(2*Math.PI),r=super._getDefaultSeriesSpec(t,["categoryField","valueField","centerX","centerY","offsetX","offsetY","innerRadius","outerRadius","gap","labelLayout","label","labelAutoVisible","drill","drillField"]);return r.startAngle=e,r.endAngle=i,r}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class PN extends Ah{constructor(){super(...arguments),this.transformerConstructor=PZ,this.type="sunburst",this.seriesType=Y.sunburst}}PN.type="sunburst",PN.seriesType=Y.sunburst,PN.transformerConstructor=PZ;let Pj=()=>{A$(),PW(),h9.registerChart(PN.type,PN)};var PG=i(88131);let PV=(t,e)=>{if(!t)return t;let i=e(),{width:r,height:n}=i;return 0===r||0===n?t:new PG.l(i).layout(t,{width:r,height:n})};class PU extends bY{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>null==t?void 0:t[this.series.getDimensionField()[0]]}}let PK=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"growRadiusIn"},PX=()=>{h9.registerAnimation("circlePacking",(t,e)=>({appear:PK(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{duration:vV.disappear.duration}}))},PY=Object.assign(Object.assign({},b7),{circlePacking:{name:"circlePacking",type:"arc"}});class P$ extends _y{constructor(){super(...arguments),this.type=Y.circlePacking}setCategoryField(t){return this._categoryField=t,this._categoryField}getCategoryField(){return this._categoryField}setValueField(t){return this._valueField=t,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:b1),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t;return null!=(t=this._spec.drillField)?t:un},getRawData:()=>this.getRawData()}),this._circlePacking=this._spec.circlePacking,this._label=this._spec.label,this._layoutPadding=this._spec.layoutPadding}initData(){super.initData();let t=this.getRawData();(0,nB.Z)(t)||(this._spec.drill&&this.initDrillableData(this._dataSet),dL(this._dataSet,"circlePackingLayout",PV),dL(this._dataSet,"flatten",Pk),t.transform({type:"circlePackingLayout",options:()=>({nodeKey:this._categoryField,padding:this._layoutPadding,includeRoot:!1,width:this.getLayoutRect().width||1,height:this.getLayoutRect().height||1})}),t.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}}))}_addDataIndexAndKey(){let t=this.getRawData();(0,nB.Z)(null==t?void 0:t.dataSet)||(dL(t.dataSet,"addVChartProperty",bO),t.transform({type:"addVChartProperty",options:{beforeCall:b4.bind(this),call:b6}}))}initMark(){this._initCirclePackingMark(),this._initLabelMark()}initMarkStyle(){this._initCirclePackingMarkStyle(),this._initLabelMarkStyle()}_initCirclePackingMark(){var t;if(!1===(null==(t=this._circlePacking)?void 0:t.visible))return;let e=this._createMark(P$.mark.circlePacking,{isSeriesMark:!0});this._circlePackingMark=e}_initCirclePackingMarkStyle(){(0,nB.Z)(this._circlePackingMark)||this.setMarkStyle(this._circlePackingMark,{x:t=>t.x,y:t=>t.y,outerRadius:t=>t.radius,innerRadius:0,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),zIndex:t=>t.depth},td.STATE_NORMAL,to.Series)}_initLabelMark(){var t;if(!1===(null==(t=this._label)?void 0:t.visible))return;let e=this._createMark(P$.mark.label,{isSeriesMark:!1});this._labelMark=e}_initLabelMarkStyle(){(0,nB.Z)(this._labelMark)||this.setMarkStyle(this._labelMark,{x:t=>t.x,y:t=>t.y,text:t=>t.key,cursor:"pointer"},td.STATE_NORMAL,to.Series)}getStatisticFields(){return PD(super.getStatisticFields(),this._categoryField,this._valueField)}initTooltip(){this._tooltipHelper=new PU(this),this._circlePackingMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circlePackingMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var t;let e=null==(t=this._spec.animationAppear)?void 0:t.preset;this.getMarksInType("arc").forEach(t=>{var i;t.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("circlePacking"))?void 0:i(void 0,e),_s(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(t=>{var e;t.setAnimationConfig(_l(null==(e=h9.getAnimationInKey("scaleInOut"))?void 0:e(),_s(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(){super.onLayoutEnd(),this._rawData.reRunAllTransform()}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._circlePackingMark]}getMarkData(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t}}P$.type=Y.circlePacking,P$.mark=PY,P$.builtInTheme={circlePacking:{layoutPadding:5,circlePacking:{visible:!0,style:{cursor:"pointer",lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},label:{visible:!0,style:{cursor:"pointer",fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},(0,yf.jB)(P$,PO);let Pq=()=>{h9.registerSeries(P$.type,P$),TS(),kH(),vX(),PX()};class PJ extends Ai{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","layoutPadding","circlePacking","drill","drillField"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class PQ extends Ah{constructor(){super(...arguments),this.transformerConstructor=PJ,this.type="circlePacking",this.seriesType=Y.circlePacking}}PQ.type="circlePacking",PQ.seriesType=Y.circlePacking,PQ.transformerConstructor=PJ;let P0=()=>{A$(),Pq(),h9.registerChart(PQ.type,PQ)},P1=(t,e)=>{let i=e.fields;return((0,nz.Z)(i)&&(i=i()),(null==i?void 0:i.length)&&(null==t?void 0:t.length)&&t[0].latestData)?bq([{latestData:Pk(t[0].latestData)}],e):{}};class P2 extends bY{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>{var e,i;return null==(i=null==(e=this.series)?void 0:e.getMarkData(t))?void 0:i[this.series.getDimensionField()[0]]},this.markTooltipValueCallback=t=>{var e,i;let{measureFields:r}=this._seriesCacheInfo,n=null==(e=this.series)?void 0:e.getMarkData(t);if(r[0]&&n)return null!=(i=n[r[0]])?i:t.value},this.dimensionTooltipTitleCallback=t=>{var e;let{dimensionFields:i}=this._seriesCacheInfo,r=null==(e=this.series)?void 0:e.getMarkData(t);if(i[0]&&r)return r[i[0]]}}get defaultShapeType(){return"square"}}let P3=Object.assign(Object.assign({},b7),{nonLeaf:{name:"nonLeaf",type:"rect"},leaf:{name:"leaf",type:"rect"},nonLeafLabel:{name:"nonLeafLabel",type:"text"}}),P5=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"growCenterIn"},P4=()=>{h9.registerAnimation("treemap",(t,e)=>({appear:P5(e),enter:{type:"growCenterIn"},exit:{type:"growCenterOut"},disappear:{duration:vV.disappear.duration}}))};class P6 extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"nonLeaf","nonLeafLabel","initNonLeafLabelMarkStyle"),this._addMarkLabelSpec(t,"leaf")}}let P7=()=>{h9.registerGrammarTransform("filter",{transform:(t,e)=>null==e?void 0:e.filter(t.callback)})},P8=()=>{h9.registerGrammarTransform("map",{transform:(t,e)=>(null==e||e.forEach((e,i)=>{t.callback(e)}),e)})};var P9=i(79478);let Bt=(t,e)=>{if(e.getViewBox()){let i=new P9.j(e).layout(t,e.getViewBox()),r=[];return(0,PT.bp)(i,r,{maxDepth:null==e?void 0:e.maxDepth}),r.forEach((t,i)=>{t&&[b1,"name"].forEach(i=>{t[i]=t.datum[t.depth][e.nameField]})}),r}return[]};class Be extends _y{constructor(){super(...arguments),this.type=Y.treemap,this.transformerConstructor=P6,this._categoryField="name",this._valueField="value",this._viewBox=new iI.YZ,this._enableAnimationHook=this.enableMarkAnimation.bind(this),this.isHierarchyData=()=>!0}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:b1),this._spec.roam&&(this.initZoomable(this.event,this._option.mode),this._matrix=new iT.y),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t,e;return null!=(e=null!=(t=this._spec.drillField)?t:this._categoryField)?e:un},getRawData:()=>this.getRawData()}),(0,hy.Z)(this._spec.maxDepth)&&(this._maxDepth=this._spec.maxDepth-1)}initData(){var t,e,i,r,n;super.initData(),dL(this._dataSet,"treemap",Bt),null==(t=this._data.getDataView())||t.transform({type:"treemap",options:{nameField:this._categoryField,valueField:this._valueField,getViewBox:()=>this._viewBox.empty()?null:{x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2},maxDepth:this._maxDepth,gapWidth:this._spec.gapWidth,padding:this._spec.nodePadding,splitType:this._spec.splitType,aspectRatio:this._spec.aspectRatio,labelPadding:(null==(e=this._spec.nonLeafLabel)?void 0:e.visible)?null==(i=this._spec.nonLeafLabel)?void 0:i.padding:0,labelPosition:null==(r=this._spec.nonLeafLabel)?void 0:r.position,minVisibleArea:null!=(n=this._spec.minVisibleArea)?n:10,minChildrenVisibleArea:this._spec.minChildrenVisibleArea,minChildrenVisibleSize:this._spec.minChildrenVisibleSize}}),this.getViewData()&&this._spec.drill&&this.initDrillableData(this._dataSet)}_runTreemapTransform(t=!1){this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()}_addDataIndexAndKey(){var t;(null==(t=this._rawData)?void 0:t.dataSet)&&(dL(this._rawData.dataSet,"addVChartProperty",bO),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:b4.bind(this),call:b6}}))}getRawDataStatisticsByField(t,e){var i;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&this._rawData){let r=P1([this._rawData],{fields:[{key:t,operations:e?["min","max"]:["values"]}]})[t];this._rawStatisticsCache[t]=(0,h3.Z)(null!=(i=this._rawStatisticsCache[t])?i:{},r)}return this._rawStatisticsCache[t]}_createHierarchyDataStatistics(t,e){dL(this._dataSet,"hierarchyDimensionStatistics",P1),dL(this._dataSet,"flatten",Pk);let i=new eq.V(this._dataSet,{name:t});return i.parse(e,{type:"dataview"}),i.transform({type:"hierarchyDimensionStatistics",options:{fields:()=>{let t=this.getStatisticFields();return this._seriesField&&this._seriesField!==this._categoryField&&t.push({key:this._seriesField,operations:["values"]}),t}}},!1),i}getStatisticFields(){return PD(super.getStatisticFields(),this._categoryField,this._valueField)}initMark(){let t=this._createMark(Be.mark.nonLeaf,{isSeriesMark:!0});t&&(t.setTransform([{type:"filter",callback:t=>!this._shouldFilterElement(t,"nonLeaf")}]),this._nonLeafMark=t);let e=this._createMark(Be.mark.leaf,{isSeriesMark:!0});e&&(e.setTransform([{type:"filter",callback:t=>!this._shouldFilterElement(t,"leaf")}]),this._leafMark=e)}initMarkStyle(){this._initLeafMarkStyle(),this._initNonLeafMarkStyle()}_initLeafMarkStyle(){this._leafMark&&this.setMarkStyle(this._leafMark,{x:t=>t.x0,y:t=>t.y0,x1:t=>t.x1,y1:t=>t.y1,fill:this.getColorAttribute()},td.STATE_NORMAL,to.Series)}_initNonLeafMarkStyle(){this._nonLeafMark&&this.setMarkStyle(this._nonLeafMark,{x:t=>t.x0,y:t=>t.y0,x1:t=>t.x1,y1:t=>t.y1,fill:this.getColorAttribute()},td.STATE_NORMAL,to.Series)}_initRichStyleOfLabelMark(t){"rich"===t.getTextType()&&this.setMarkStyle(t,{maxWidth:t=>Math.abs(t.x0-t.x1),maxHeight:t=>Math.abs(t.y0-t.y1),ellipsis:!0},td.STATE_NORMAL,to.Series)}initLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:t=>(t.x0+t.x1)/2,y:t=>(t.y0+t.y1)/2,text:t=>{var e;return null==(e=t.datum[t.depth])?void 0:e[this.getDimensionField()[0]]},maxLineWidth:t=>t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0},td.STATE_NORMAL,to.Series),this._initRichStyleOfLabelMark(t))}initNonLeafLabelMarkStyle(t){t&&(this._nonLeafLabelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:t=>t.labelRect?(t.labelRect.x0+t.labelRect.x1)/2:(t.x0+t.x1)/2,y:t=>t.labelRect?(t.labelRect.y0+t.labelRect.y1)/2:(t.y0+t.y1)/2,text:t=>{var e;return null==(e=t.datum[t.depth])?void 0:e[this.getDimensionField()[0]]},maxLineWidth:t=>t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0},td.STATE_NORMAL,to.Series),this._initRichStyleOfLabelMark(t))}initAnimation(){this.getMarksInType("rect").forEach(t=>{var e;t.setAnimationConfig(_l(null==(e=h9.getAnimationInKey("treemap"))?void 0:e(),_s(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.roam&&(this.initDragEventOfSeries(this),this.event.on("panmove",t=>{this.handlePan(t)}),this.initZoomEventOfSeries(this),this.event.on("zoom",t=>{this.handleZoom(t)})),this._spec.drill&&this.bindDrillEvent()}_getDataIdKey(){return"key"}initTooltip(){this._tooltipHelper=new P2(this),this._leafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._leafMark),this._nonLeafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nonLeafMark)}_shouldFilterElement(t,e){let i=t.isLeaf;return"leaf"===e?!i:i}handlePan(t){let{delta:e}=t;if(0===e[0]&&0===e[1])return;this._matrix.reset(),this._matrix.translate(e[0],e[1]);let{a:i,b:r,c:n,d:l,e:s,f:a}=this._matrix;this._matrix.multiply(i,r,n,l,s,a),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}handleZoom(t){let{scale:e,scaleCenter:i}=t;if(1===e)return;this._matrix.reset();let{x:r,y:n}=i;this._matrix.translate(r,n),this._matrix.scale(e,e),this._matrix.translate(-r,-n);let{a:l,b:s,c:a,d:o,e:h,f:d}=this._matrix;this._matrix.multiply(l,s,a,o,h,d),this.disableMarkAnimation(),this.event.on(q.AFTER_DO_RENDER,this._enableAnimationHook),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runTreemapTransform()}enableMarkAnimation(){this.getMarks().forEach(t=>{}),[this._labelMark,this._nonLeafLabelMark].forEach(t=>{t&&t.getComponent()&&t.getComponent().getProduct().enableAnimation()}),this.event.off(q.AFTER_DO_RENDER,this._enableAnimationHook)}disableMarkAnimation(){this.getMarks().forEach(t=>{}),[this._labelMark,this._nonLeafLabelMark].forEach(t=>{t&&t.getComponent()&&t.getComponent().getProduct().disableAnimation()})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._nonLeafMark,this._leafMark]}getMarkData(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t}}Be.type=Y.treemap,Be.mark=P3,Be.builtInTheme={treemap:{gapWidth:1,nodePadding:[5],nonLeaf:{visible:!1,style:{fillOpacity:.5}},label:{style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},nonLeafLabel:{padding:24,style:{fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},textBaseline:"middle",textAlign:"center"}}}},Be.transformerConstructor=P6,(0,yf.jB)(Be,PO),(0,yf.jB)(Be,M6);let Bi=()=>{P7(),P8(),Mw(),kH(),P4(),vY(),h9.registerSeries(Be.type,Be)};class Br extends Ai{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","aspectRatio","splitType","maxDepth","gapWidth","nodePadding","minVisibleArea","minChildrenVisibleArea","minChildrenVisibleSize","roam","drill","drillField","leaf","nonLeaf","nonLeafLabel"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class Bn extends Ah{constructor(){super(...arguments),this.transformerConstructor=Br,this.type="treemap",this.seriesType=Y.treemap}}Bn.type="treemap",Bn.seriesType=Y.treemap,Bn.transformerConstructor=Br;let Bl=()=>{A$(),Bi(),h9.registerChart(Bn.type,Bn)},Bs=`${d9}_waterfall_default_seriesField`,Ba=(t,e)=>{if(!t||0===t.length)return t;let{indexField:i,total:r,groupData:n,calculationMode:l}=e,s=[],{dimensionValues:a,dimensionData:o}=n().latestData,h=Array.from(a[i]);"decrease"===l&&(h=h.reverse());let d={start:0,end:0,positive:0,negative:0,lastIndex:null};return h.forEach((t,i)=>{let n={start:d.end,end:d.end,lastIndex:d.lastIndex,lastEnd:d.end,index:t,isTotal:!1,positive:d.end,negative:d.end},l=!0===e.stackInverse?o[t].reverse():o[t];if(null==l||l.forEach((t,e)=>{e===l.length-1?t[um]=!0:delete t[um]}),l.length>1){let a=t=>{if(r&&"end"!==r.type){if("field"===r.type||"custom"===r.type)return!!t[r.tagField]}else if(i===h.length-1)return!0;return!1};if(l.some(t=>a(t)))return d=function(t,e,i,r,n,l,s,a,o){i.isTotal=!0;let{valueField:h,startAs:d,endAs:u,total:c}=a,p=[],g=[];if(t.forEach((t,e)=>{o(t)?g.push(Object.assign(Object.assign({},t),{_vchart_waterfall_waterfall_temp:e})):p.push(t)}),g.length===t.length){let o=Bo([t[0]],e,i,r,n,l,s,a);return g.forEach(e=>{e[d]=t[0][d],e[u]=t[0][u],e[h]=t[0][h]}),o}let{start:f,end:m}=Bh(g[0],i,r,n,c);i.start=f,i.end=m;let y=f,v=f,b=m-f,_=p.reduce((t,e)=>(0,ik.f2)(t,+e[h]),b);return g.forEach(t=>{let e={[d]:f,[u]:m,[h]:_};p.splice(t._vchart_waterfall_waterfall_temp,0,e)}),p.forEach(t=>{let e=+t[h];e>=0?(t[d]=+y,y=(0,ik.hY)(y,e)):(t[d]=+v,v=(0,ik.hY)(v,e)),t[u]=(0,ik.hY)(t[d],e),f=(0,ik.hY)(f,e),b=(0,ik.f2)(b,e)}),g.forEach(e=>{let i=e._vchart_waterfall_waterfall_temp;e=p[i];let r=t[i];r[d]=e[d],r[u]=e[u],r[h]=e[h]}),Object.assign(Object.assign({},i),{lastIndex:e})}(l,t,n,s,d,h,i,e,a),void s.push(n)}d=Bo(l,t,n,s,d,h,i,e),s.push(n)}),s};function Bo(t,e,i,r,n,l,s,a){let{valueField:o,startAs:h,endAs:d,total:u,seriesField:c,seriesFieldName:p}=a;return t.forEach(t=>{let e=!1;if(u&&"end"!==u.type){if(("field"===u.type||"custom"===u.type)&&t[u.tagField]){e=!0;let{start:l,end:s}=Bh(t,i,r,n,u);t[h]=l,t[d]=s,t[o]=s-l,i.start=l,i.end=s}}else s===l.length-1&&(i.start=0,t[h]=i.start,t[d]=i.end,e=!0);if(!e){let e=+t[o];e>=0?(t[h]=+i.positive,i.positive=(0,ik.hY)(i.positive,e)):(t[h]=+i.negative,i.negative=(0,ik.hY)(i.negative,e)),t[d]=(0,ik.hY)(t[h],e),i.end=(0,ik.hY)(i.end,e)}i.isTotal=e,((0,nB.Z)(c)||c===Bs)&&(t[Bs]=e?p.total:+t[o]>=0?p.increase:p.decrease)}),Object.assign(Object.assign({},i),{lastIndex:e})}function Bh(t,e,i,r,n){var l,s,a,o,h;let d,u;return n&&"end"!==n.type?"field"===n.type||"custom"===n.type?"custom"===n.type?(l=t,s=r,n.product(l,s)):n.collectCountField&&!(0,nB.Z)(t[n.collectCountField])?function(t,e,i,r){let n=0,l=i.end,s=e.length-t[r.collectCountField],a=e.length-1;return s<0?hO("total.collectCountField error"):n=e[s].start,a<0?hO("total.collectCountField error"):l=e[a].end,{start:n,end:l}}(t,i,e,n):(a=t,o=e,h=n,d=0,u=o.end,h.startField&&!(0,nB.Z)(a[h.startField])&&(d=+a[h.startField]),h.valueField&&!(0,nB.Z)(a[h.valueField])&&(u=(0,ik.hY)(d,+a[h.valueField])),{start:d,end:u}):{start:0,end:0}:{start:0,end:e.end}}let Bd=(t,e)=>{if(!t)return t;let{indexField:i,valueField:r,total:n,seriesField:l,calculationMode:s}=e,a={[i]:(null==n?void 0:n.text)||"total",[r]:t.reduce((t,e)=>(0,ik.hY)(t,+e[r]),0)};return l&&(a[l]="total"),"decrease"===s?t.unshift(a):t.push(a),t},Bu={type:"fadeIn"},Bc={type:"growCenterIn"},Bp=()=>{h9.registerAnimation("waterfall",(t,e)=>({appear:function(t,e){switch(e){case"fadeIn":return Bu;case"scaleIn":return Bc;default:return Mp(t,!1)}}(t,e),enter:Mp(t,!1),exit:Mg(t,!1),disappear:{duration:vV.disappear.duration}}))},Bg=Object.assign(Object.assign({},MS),{leaderLine:{name:"leaderLine",type:"rule"},stackLabel:{name:"stackLabel",type:"text"}}),Bf=(t,e)=>{if(!e.fields)return t;let i={};return{dimensionValues:i,dimensionData:function t(e,i,r){var n,l;if(0===i.length)return e;let s=i[0],a=i.slice(1);r[s]=new Set;let o=function(t,e,i){let r={};return t.forEach(t=>{let n=t[e];r[n]||(r[n]=[],i.add(n)),r[n].push(t)}),r}(e,s,r[s]);return a.length?(n=o,l=(e,i)=>t(e,a,r),Object.keys(n).reduce((t,e)=>(t[e]=l(n[e],e),t),{})):o}(t.map(t=>t.latestData).flat(),e.fields,i)}};class Bm{get fields(){return this._fields}get groupData(){return this._groupData}constructor(t){this._fields=[],this._fields=t}initData(t,e){let i=t.name,r=new eq.V(e instanceof eY.q?e:t.dataSet);r.name=i,r.parse([t],{type:"dataview"}),dL(e,"dimensionTree",Bf),r.transform({type:"dimensionTree",options:{fields:this._fields}},!1),r.target.addListener("change",this.groupDataUpdate.bind(this)),this._groupData=r}groupDataUpdate(){}getGroupValueInField(t){var e,i,r;let n=null==(r=null==(i=null==(e=this.groupData)?void 0:e.latestData)?void 0:i.dimensionValues)?void 0:r[t];return n?Array.from(n):[]}}class By extends MM{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){this._addMarkLabelSpec(t,"bar"),this._addMarkLabelSpec(t,"bar","stackLabel","initStackLabelMarkStyle")}}let Bv={rect:Bx,symbol:BC,arc:Bw,point:function(t){let{labelSpec:e}=t;return{position:"center",overlap:!1!==e.overlap&&{clampForce:!1,avoidBaseMark:!1}}},"line-data":function(t){let e=BC(t);return(0,nD.Z)(e.overlap)||(e.overlap.avoidBaseMark=!1,e.overlap.clampForce=!1),e},stackLabel:BS,line:BA,area:BA,rect3d:Bx,arc3d:Bw,treemap:function(t){return{customLayoutFunc:(t,e)=>e,overlap:!1}},venn:function(t){return{customLayoutFunc:(t,e)=>e,smartInvert:!0}},boxPlot:function(t){return{customLayoutFunc:(e,i,r)=>{for(let n=0;n<i.length;n++){let l=i[n],s=e[n];if(!l||!s)continue;let a=r(s),o=a.getSubGraphic().findIndex(t=>"median"===t.name);if(-1!==o){let e=a.getSubGraphic()[o].AABBBounds;"horizontal"===t.series.direction?l.setAttributes({x:e.x2+l.AABBBounds.width()/2,y:(e.y1+e.y2)/2}):l.setAttributes({x:(e.x1+e.x2)/2,y:e.y2+l.AABBBounds.height()/2})}else{let t=a.AABBBounds;l.setAttributes({x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2})}}return i}}}};function Bb(t,e,i,r){var n,l;let{labelMark:s,series:a}=t,o=a.getMeasureField()[0],h=s.getAttributesOfState(e);if("text"in h||(h.text=null!=(n=h.text)?n:e[o]),"textType"in h||(h.textType=null!=(l=t.labelSpec.textType)?l:"text"),h.data=e,a.type!==Y.sankey){let{formatFunc:t,args:n}=bz(i,r,h.text,e);t&&(h._originText=h.text,h.text=t(...n,{series:a}))}return h}function B_(t){return(0,nz.Z)(t)?e=>t(e.data):t}function BC(t){var e,i,r;let n,{series:l,labelSpec:s}=t,a="horizontal"===l.direction?"right":"top",o=null!=(e=B_(s.position))?e:a;return n=!1!==s.overlap&&{strategy:null!=(r=null==(i=s.overlap)?void 0:i.strategy)?r:[{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}],avoidBaseMark:"center"!==o},{position:o,overlap:n}}function Bx(t){var e,i,r,n,l,s,a;let{series:o,labelSpec:h={}}=t,d=null!=(e=B_(h.position))?e:"outside",u=null!=(i=o.direction)?i:"vertical",c="horizontal"===o.direction?null==(r=o.getXAxisHelper())?void 0:r.isInverse():null==(n=o.getYAxisHelper())?void 0:n.isInverse(),p,g=d;g=t=>{var e;let{data:i}=t,r=null!=(e="function"==typeof h.position?h.position(i):h.position)?e:"outside";if("outside"===r){let t=o.getMeasureField()[0];return({vertical:["top","bottom"],horizontal:["right","left"]})[u][(null==i?void 0:i[t])>=0&&c||(null==i?void 0:i[t])<0&&!c?1:0]}return r},p=!1!==h.overlap&&{strategy:null!=(s=null==(l=h.overlap)?void 0:l.strategy)?s:(a=o,[{type:"position",position:t=>{var e,i;let{data:r}=t,n=a.getMeasureField()[0];return("horizontal"===a.direction?null==(e=a.getXAxisHelper())?void 0:e.isInverse():null==(i=a.getYAxisHelper())?void 0:i.isInverse())?(null==r?void 0:r[n])>=0?"horizontal"===a.direction?["left","inside-left"]:["bottom","inside-bottom"]:"horizontal"===a.direction?["right","inside-right"]:["top","inside-top"]:(null==r?void 0:r[n])>=0?"horizontal"===a.direction?["right","inside-right"]:["top","inside-top"]:"horizontal"===a.direction?["left","inside-left"]:["bottom","inside-bottom"]}}])};let f=!1;return(0,nI.Z)(d)&&d.includes("inside")&&(f=!0),{position:g,overlap:p,smartInvert:f}}function Bw(t){var e;let i,{labelSpec:r}=t,n=null!=(e=B_(r.position))?e:"outside";return i=r.smartInvert?r.smartInvert:(0,nI.Z)(n)&&n.includes("inside"),{position:n,smartInvert:i}}function BS(t,e,i){let r=t.series,n=t.labelSpec||{},l=r.getTotalData();return{customLayoutFunc:l=>l.map(l=>{let s=n.position||"withChange",a=n.offset||0,o=e?e(l.data):l.data,h=Bb(t,o,n.formatMethod);return h.x="horizontal"===r.direction?"middle"===s?.5*(r.totalPositionX(o,"end")+r.totalPositionY(o,"start")):"max"===s?r.totalPositionX(o,o.end>=o.start?"end":"start")+a:"min"===s?r.totalPositionX(o,o.end>=o.start?"start":"end")-a:r.totalPositionX(o,"end")+(o.end>=o.start?a:-a):r.totalPositionX(o,"index",.5),h.y="horizontal"===r.direction?r.totalPositionY(o,"index",.5):"middle"===s?.5*(r.totalPositionY(o,"end")+r.totalPositionY(o,"start")):"max"===s?r.totalPositionY(o,o.end>=o.start?"end":"start")-a:"min"===s?r.totalPositionY(o,o.end>=o.start?"start":"end")+a:r.totalPositionY(o,"end")+(o.end>=o.start?-a:a),"horizontal"===r.direction?h.textAlign="middle"===s?"center":"withChange"===s&&o.end-o.start>=0||"max"===s?"left":"right":h.textBaseline="middle"===s?s:"withChange"===s&&o.end-o.start>=0||"max"===s?"bottom":"top",null==i||i(l,o,h),uj(Object.assign(Object.assign({},h),{id:l.id}))}),dataFilter:t=>{let e=[];return l.forEach(i=>{let n=t.find(t=>{var e;return i.index===(null==(e=t.data)?void 0:e[r.getDimensionField()[0]])});n&&(n.data=i,e.push(n))}),e},overlap:{strategy:[]}}}function BA(t){var e,i,r,n;let{labelSpec:l,series:s}=t,a=null==(r=null==(i=null==(e=s.getViewDataStatistics)?void 0:e.call(s).latestData)?void 0:i[s.getSeriesField()])?void 0:r.values,o=a?a.map((t,e)=>({[s.getSeriesField()]:t,index:e})):[{index:0,[ul]:s.getSeriesKeys()[0]}];return{position:null!=(n=l.position)?n:"end",data:o,overlap:{avoidBaseMark:!1,clampForce:!1}}}class BM extends MT{constructor(){super(...arguments),this.type=Y.waterfall,this.transformerConstructor=By,this._leaderLineMark=null,this._stackLabelMark=null,this._labelMark=null,this._reStackTotal=()=>{let t=this.getStackData(),e=this.getStackValueField();t&&bP(t,e)}}getTotalData(){var t;return null==(t=this._totalData)?void 0:t.getLatestData()}initGroups(){let t=this.getGroupFields();t&&t.length&&(this._groups=new Bm(t),this._data&&this._groups.initData(this._data.getDataView(),this._dataSet))}setAttrFromSpec(){super.setAttrFromSpec(),this.setValueFieldToStack(),this._fieldX=[this._fieldX[0]],this._fieldY=[this._fieldY[0]],(0,nB.Z)(this._seriesField)&&(this._seriesField=Bs)}getSeriesKeys(){return this._seriesField===Bs?[this._theme.seriesFieldName.increase,this._theme.seriesFieldName.decrease,this._theme.seriesFieldName.total]:super.getSeriesKeys()}initData(){var t,e,i;super.initData(),dL(this._dataSet,"waterfallFillTotal",Bd),dL(this._dataSet,"waterfall",Ba),((0,nB.Z)(this._spec.total)||"end"===this._spec.total.type)&&(null==(t=this._rawData)||t.transform({type:"waterfallFillTotal",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,total:this._spec.total,calculationMode:null!=(e=this._spec.calculationMode)?e:"increase",stackInverse:this.getRegion().getStackInverse()}},!1));let r=dN(this.getViewData(),this._dataSet,{name:`${d9}_series_${this.id}_totalData`});this.getViewData().target.removeListener("change",r.reRunAllTransform),this._totalData=new pV(this._option,r),r.transform({type:"waterfall",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,startAs:uo,endAs:uh,total:this._spec.total,calculationMode:null!=(i=this._spec.calculationMode)?i:"increase",groupData:()=>this.getGroups().groupData,stackInverse:this.getRegion().getStackInverse()}},!1),r.target.addListener("change",this._reStackTotal)}compileData(){var t;super.compileData(),null==(t=this._totalData)||t.compile()}initAnimation(){var t,e,i,r;let n={yField:"horizontal"===this.direction?this._fieldY[0]:this.getStackValueField(),xField:"horizontal"===this.direction?this.getStackValueField():this._fieldX[0],direction:this.direction,growFrom:()=>{var t,e;return"horizontal"===this.direction?null==(t=this._xAxisHelper)?void 0:t.getScale(0).scale(0):null==(e=this._yAxisHelper)?void 0:e.getScale(0).scale(0)}},l=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset,s=_m(this);this._barMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("waterfall"))?void 0:i(n,l),_s("bar",this._spec,this._markAttributeContext),s)),this._leaderLineMark&&this._leaderLineMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("fadeInOut"))?void 0:r(),_s("leaderLine",this._spec,this._markAttributeContext)))}viewDataUpdate(t){this._totalData.getDataView().reRunAllTransform(),this._totalData.updateData(),super.viewDataUpdate(t)}addViewDataFilter(t){}reFilterViewData(){}onEvaluateEnd(t){super.onEvaluateEnd(t),this._totalData.updateData()}initMark(){super.initMark();let t=this._createMark(BM.mark.leaderLine,{key:"index"});t&&(this._leaderLineMark=t,t.setData(this._totalData))}initLabelMarkStyle(t){var e;if(t)return!this._labelMark&&(null==(e=this._spec.label)?void 0:e.visible)?(super.initLabelMarkStyle(t),void(this._labelMark=t)):void 0}initStackLabelMarkStyle(t){t&&(this._stackLabelMark=t,t.skipEncode=!0,t.setRule("stackLabel"),t.setData(this._totalData),this.setMarkStyle(t,{text:t=>{var e;return"absolute"===(null==(e=this._spec.stackLabel)?void 0:e.valueType)?t.end:(0,ik.f2)(t.end,t.start)}}))}initTotalLabelMarkStyle(t){this.setMarkStyle(t,{text:t=>{var e;return"end"in t?"absolute"===(null==(e=this._spec.totalLabel)?void 0:e.valueType)?t.end:(0,ik.f2)(t.end,t.start):"horizontal"===this.direction?t[this._fieldX[0]]:t[this._fieldY[0]]}})}getTotalLabelComponentStyle(t){return BS(Object.assign(Object.assign({},t),{series:this,labelSpec:this._spec.totalLabel}),t=>{let e="vertical"===this.direction?t[this._fieldX[0]]:t[this._fieldY[0]];return this._totalData.getLatestData().find(t=>t.index===e)})}totalPositionX(t,e,i=.5){let{dataToPosition:r,getBandwidth:n}=this._xAxisHelper;return"horizontal"===this._direction?pF(r([t[e]],{bandPosition:this._bandPosition})):r([t[e]],{bandPosition:this._bandPosition})+.5*n(0)-this._barMark.getAttribute("width",t)*(.5-i)}totalPositionY(t,e,i=.5){let{dataToPosition:r,getBandwidth:n}=this._yAxisHelper;return"horizontal"===this._direction?r([t[e]],{bandPosition:this._bandPosition})+.5*n(0)-this._barMark.getAttribute("height",t)*(.5-i):pF(r([t[e]],{bandPosition:this._bandPosition}))}initMarkStyle(){super.initMarkStyle();let t="decrease"===this._spec.calculationMode;this._leaderLineMark&&("horizontal"===this._direction?this.setMarkStyle(this._leaderLineMark,{visible:t=>this.isVisibleLeaderLine(t),x:t=>this.totalPositionX(t,"lastEnd",0),x1:t=>this.totalPositionX(t,t.isTotal?"end":"start",0),y:e=>e.lastIndex?this.totalPositionY(e,"lastIndex",+!t):0,y1:e=>this.totalPositionY(e,"index",+!!t)},"normal",to.Series):this.setMarkStyle(this._leaderLineMark,{visible:t=>this.isVisibleLeaderLine(t),x:e=>e.lastIndex?this.totalPositionX(e,"lastIndex",+!t):0,x1:e=>this.totalPositionX(e,"index",+!!t),y:t=>this.totalPositionY(t,"lastEnd",0),y1:t=>this.totalPositionY(t,t.isTotal?"end":"start",0)},"normal",to.Series))}isVisibleLeaderLine(t){return!(0,nB.Z)(t.lastIndex)&&pO([t.lastEnd,t[t.isTotal?"end":"start"]],"horizontal"===this.direction?this._xAxisHelper.getScale(0):this._yAxisHelper.getScale(0))}}BM.type=Y.waterfall,BM.mark=Bg,BM.builtInTheme={waterfall:{seriesFieldName:{total:"total",increase:"increase",decrease:"decrease"},leaderLine:{style:{stroke:"black",lineWidth:1,lineDash:[4,4]}},stackLabel:{visible:!0,offset:12,position:"withChange",style:{fill:"black",fontSize:{type:"token",key:"l4FontSize"}}},label:{visible:!1,offset:12,position:"inside",style:{lineWidth:2}}}},BM.transformerConstructor=By;let BT=()=>{kk(),Mw(),Bp(),vY(),SI(),SX(),h9.registerSeries(BM.type,BM)};class Bk extends MR{transformSpec(t){super.transformSpec(t),t.legends&&(0,a1.IX)(t.legends).forEach(t=>{t.select=!1,t.hover=!1,t.filter=!1}),c8(t)}_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.bar=t.bar,e.stackLabel=t.stackLabel,e.leaderLine=t.leaderLine,e.total=t.total,e.calculationMode=t.calculationMode,e}}class BR extends MP{constructor(){super(...arguments),this.transformerConstructor=Bk,this.type="waterfall",this.seriesType=Y.waterfall}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}BR.type="waterfall",BR.seriesType=Y.waterfall,BR.transformerConstructor=Bk;let BP=()=>{AX(),A$(),AJ(),AM(),Af(),BT(),h9.registerChart(BR.type,BR)},BB=`${d9}_BOX_PLOT_OUTLIER_VALUE`;(tU=t5||(t5={})).OUTLIER="outlier",tU.MAX="max",tU.MIN="min",tU.MEDIAN="median",tU.Q1="q1",tU.Q3="q3",tU.SERIES_FIELD="seriesField";let BI=(t,e)=>{let i=[],{outliersField:r,dimensionField:n,seriesField:l}=e;return(t[0].latestData||[]).forEach(t=>{let e=t[r];(0,rD.Z)(e)||(e=[e]),i.push(...e.map(e=>{let i={[BB]:e};return n.forEach(e=>{i[e]=t[e]}),(0,aw.Z)(l)&&(i[l]=t[l]),i}))}),i};class BE extends bY{constructor(){super(...arguments),this.getContentKey=t=>e=>{if(this.isOutlierMark(e))return t===t5.OUTLIER?this.series.getOutliersField():t===t5.SERIES_FIELD?this.series.getSeriesField():null;switch(t){case t5.MIN:return this.series.getMinField();case t5.MAX:return this.series.getMaxField();case t5.MEDIAN:return this.series.getMedianField();case t5.Q1:return this.series.getQ1Field();case t5.Q3:return this.series.getQ3Field();case t5.SERIES_FIELD:return this.series.getSeriesField()}return null},this.getContentValue=t=>e=>{if(this.isOutlierMark(e))return t===t5.OUTLIER?e[BB]:t===t5.SERIES_FIELD?e[this.series.getSeriesField()]:null;switch(t){case t5.MIN:return e[this.series.getMinField()];case t5.MAX:return e[this.series.getMaxField()];case t5.MEDIAN:return e[this.series.getMedianField()];case t5.Q1:return e[this.series.getQ1Field()];case t5.Q3:return e[this.series.getQ3Field()];case t5.SERIES_FIELD:return e[this.series.getSeriesField()]}return null},this.shapeColorCallback=t=>"line"===this.series.getShaftShape()?this.series.getMarkInName("boxPlot").getAttribute("stroke",t):this.series.getMarkInName("boxPlot").getAttribute("fill",t),this.getOutlierFillColor=t=>{var e,i;let r=this.series.getOutliersStyle();return null!=(e=null==r?void 0:r.fill)?e:null==(i=this.series.getMarkInName("outlier"))?void 0:i.getAttribute("fill",t)},this.isOutlierMark=t=>(0,aw.Z)(t[BB])}getDefaultContentList(t){return[{key:this.getContentKey(t5.OUTLIER),value:this.getContentValue(t5.OUTLIER),shapeType:this.shapeTypeCallback,shapeColor:this.getOutlierFillColor,shapeStroke:this.getOutlierFillColor},{key:this.getContentKey(t5.MAX),value:this.getContentValue(t5.MAX)},{key:this.getContentKey(t5.Q3),value:this.getContentValue(t5.Q3)},{key:this.getContentKey(t5.MEDIAN),value:this.getContentValue(t5.MEDIAN)},{key:this.getContentKey(t5.Q1),value:this.getContentValue(t5.Q1)},{key:this.getContentKey(t5.MIN),value:this.getContentValue(t5.MIN)},{key:this.getContentKey(t5.SERIES_FIELD),value:this.getContentValue(t5.SERIES_FIELD)}]}}class BL extends sN{constructor(t){super(t),this.type="glyph",this.numberType=sl,this.subGraphic=[],this._onInit&&this._onInit(this),this.valid=this.isValid()}setSubGraphic(t){this.detachSubGraphic(),this.subGraphic=t,t.forEach(t=>{t.glyphHost=this,Object.setPrototypeOf(t.attribute,this.attribute)}),this.valid=this.isValid(),this.addUpdateBoundTag()}detachSubGraphic(){this.subGraphic.forEach(t=>{t.glyphHost=null,Object.setPrototypeOf(t.attribute,{})})}getSubGraphic(){return this.subGraphic}onInit(t){this._onInit=t}onUpdate(t){this._onUpdate=t}isValid(){return!0}setAttribute(t,e,i,r){super.setAttribute(t,e,i,r),this.subGraphic.forEach(t=>{t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()})}setAttributes(t,e=!1,i){super.setAttributes(t,e,i),this.subGraphic.forEach(t=>{t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()})}translate(t,e){return super.translate(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}translateTo(t,e){return super.translateTo(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}scale(t,e,i){return super.scale(t,e,i),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}scaleTo(t,e){return super.scaleTo(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}rotate(t){return super.rotate(t),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}rotateTo(t){return super.rotate(t),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}getGraphicTheme(){return nP(this).glyph}updateAABBBounds(t,e,i){return this.getSubGraphic().forEach(t=>{i.union(t.AABBBounds)}),i}doUpdateAABBBounds(){this.updateAABBBoundsStamp++,this._AABBBounds.clear();let t=this.updateAABBBounds(this.attribute,this.getGraphicTheme(),this._AABBBounds);return this.clearUpdateBoundTag(),t}needUpdateTags(t){return!1}needUpdateTag(t){return!1}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!((null==(i=this.currentStates)?void 0:i.length)!==t.length||t.some((t,e)=>this.currentStates[e]!==t)))return;this.stopStateAnimates();let r={},n=this.subGraphic.map(()=>({}));t.forEach(e=>{var i;let l=this.glyphStateProxy?this.glyphStateProxy(e,t):this.glyphStates[e];l&&(Object.assign(r,l.attributes),(null==(i=l.subAttributes)?void 0:i.length)&&n.forEach((t,e)=>{Object.assign(t,l.subAttributes[e])}))}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}clearStates(t){this.stopStateAnimates(),this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}clone(){let t=new BL(Object.assign({},this.attribute));return t.setSubGraphic(this.subGraphic.map(t=>t.clone())),t}getNoWorkAnimateAttr(){return BL.NOWORK_ANIMATE_ATTR}}function BF(t){return new BL(t)}BL.NOWORK_ANIMATE_ATTR=sZ;let BO=class{constructor(){this.numberType=sl}reInit(){}drawShape(t,e,i,r,n,l,s,a){n.drawContribution&&t.getSubGraphic().forEach(t=>{let o=n.drawContribution.getRenderContribution(t);o&&o.drawShape&&o.drawShape(t,e,i,r,n,l,s,a)})}draw(t,e,i,r){let{context:n}=i;if(!n||(n.highPerformanceSave(),!i.drawContribution))return;let l=nP(t),s=t.getSubGraphic();s.length&&s.forEach(t=>{i.drawContribution.renderItem(t,i,{theme:l})}),n.highPerformanceRestore()}};BO=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],BO);let BH=!1,BD=new eQ(t=>{BH||(BH=!0,t(as).to(BO).inSingletonScope(),t(s4).toService(as))}),Bz=class extends fG{constructor(t){super(),this.canvasRenderer=t}};Bz=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(tK=it(as),function(t,e){tK(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Bz);let BW=!1,BZ=new eQ((t,e,i,r)=>{BW||(BW=!0,t(cp).to(Bz).inSingletonScope(),t(cf).toService(cp))});function BN(){BN.__loaded||(BN.__loaded=!0,ak.RegisterGraphicCreator("glyph",BF),ib.load(BD),ib.load(u$?BZ:fK))}BN.__loaded=!1;class Bj extends gW{constructor(){super(...arguments),this._setStateOfGraphic=t=>{t.clearStates(),t.stateProxy=null,t.context.diffState!==th.enter&&t.context.diffState!==th.update||(t.glyphStateProxy=(e,i)=>{var r;let n={attributes:Object.assign(Object.assign({},this._runEncoderOfGraphic(null==(r=this._encoderOfState)?void 0:r[e],t)),t.runtimeStateCache?t.runtimeStateCache[e]:null)};return t.glyphStates?t.glyphStates[e]||(t.glyphStates[e]=n):t.glyphStates={[e]:n},n},t.useStates(t.context.states))}}getSubMarks(){return this._subMarks}setGlyphConfig(t){this._glyphConfig=t}getGlyphConfig(){return this._glyphConfig}getPositionChannels(){return this._positionChannels}_onGlyphAttributeUpdate(t){return e=>{var i,r;let n=this.getPositionChannels(),l=n&&this._positionEncoder&&Object.keys(e).some(t=>n.includes(t))?this._positionEncoder(e,null==(r=null==(i=null==t?void 0:t.context)?void 0:i.data)?void 0:r[0],t):null;return this._channelEncoder&&Object.keys(this._channelEncoder).forEach(t=>{if(t in e){let i=this._channelEncoder[t](e[t]);l=l?(0,h3.Z)(l,i):i}}),l&&t.getSubGraphic().forEach(t=>{t&&l[t.name]&&t.setAttributes(l[t.name])}),e}}_createGraphic(t={}){let e=BF(t);e.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(e);let i=this._subMarks;if(i){let t=[];Object.keys(i).forEach(e=>{let r=h9.createGraphicComponent(i[e].type,Object.assign({},i[e].defaultAttributes));r&&(t.push(r),r.name=e,r.onBeforeAttributeUpdate=t=>t)}),e.setSubGraphic(t)}return e.onBeforeAttributeUpdate(t),e}_runProgressiveEncoder(t){this._runEncoder(t)}}let BG=()=>{h9.registerGraphicComponent("glyph",BF),gG(),BN()},BV=["x","y","minMaxWidth","minMaxHeight","q1q3Width","q1q3Height","q1","q3","min","max","median","angle"],BU=["x","y","boxWidth","boxHeight","ruleWidth","ruleHeight","q1","q3","min","max","median","angle"];class BK extends Bj{constructor(){super(...arguments),this.type=BK.type}_isHorizontal(){return this._glyphConfig&&"horizontal"===this._glyphConfig.direction}setGlyphConfig(t){super.setGlyphConfig(t),"bar"===t.shaftShape?(this._subMarks={minMaxBox:{type:"rect",defaultAttributes:{lineWidth:0}},q1q3Box:{type:"rect",defaultAttributes:{lineWidth:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=BV,this._channelEncoder={minMaxFillOpacity:t=>({minMaxBox:{fillOpacity:t}}),lineWidth:t=>({minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0}}),stroke:t=>({minMaxBox:{stroke:!1},q1q3Box:{stroke:!1}})},this._positionEncoder=(t,e,i)=>{var r;let{x:n=i.attribute.x,y:l=i.attribute.y,minMaxWidth:s=i.attribute.minMaxWidth,minMaxHeight:a=i.attribute.minMaxHeight,q1q3Width:o=i.attribute.q1q3Width,q1q3Height:h=i.attribute.q1q3Height,q1:d=i.attribute.q1,q3:u=i.attribute.q3,min:c=i.attribute.min,max:p=i.attribute.max,median:g=i.attribute.median,angle:f}=t,m=this._isHorizontal(),y={};if(m?(y.minMaxBox={x:c,x1:p,y:l-a/2,y1:l+a/2},y.q1q3Box={x:d,x1:u,y:l-h/2,y1:l+h/2},y.median={points:[{x:g,y:l-h/2},{x:g,y:l+h/2}]}):(y.minMaxBox={y:c,y1:p,x:n-s/2,x1:n+s/2},y.q1q3Box={y:d,y1:u,x:n-o/2,x1:n+o/2},y.median={points:[{y:g,x:n-o/2},{y:g,x:n+o/2}]}),(0,hy.Z)(f)){let e=null!=(r=t.anchor)?r:m?[(c+p)/2,l]:[n,(c+p)/2];Object.keys(y).forEach(t=>{y[t].angle=f,y[t].anchor=e})}return y}):(this._subMarks={shaft:{type:"line",defaultAttributes:{x:0,y:0}},box:{type:"rect"},max:{type:"line",defaultAttributes:{x:0,y:0}},min:{type:"line",defaultAttributes:{x:0,y:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=BU,this._channelEncoder={boxStroke:t=>({box:{stroke:t}}),medianStroke:t=>({median:{stroke:t}}),boxCornerRadius:t=>({box:{cornerRadius:t}})},this._positionEncoder=(t,e,i)=>{var r;let{x:n=i.attribute.x,y:l=i.attribute.y,boxWidth:s=i.attribute.boxWidth,boxHeight:a=i.attribute.boxHeight,ruleWidth:o=i.attribute.ruleWidth,ruleHeight:h=i.attribute.ruleHeight,q1:d=i.attribute.q1,q3:u=i.attribute.q3,min:c=i.attribute.min,max:p=i.attribute.max,median:g=i.attribute.median,angle:f}=t,m=this._isHorizontal(),y={};if(m?(y.box={x:d,x1:u,y:l-a/2,y1:l+a/2},y.median={points:[{x:g,y:l-a/2},{x:g,y:l+a/2}]},y.shaft={points:[{x:c,y:l},{x:p,y:l}]},y.max={points:[{x:p,y:l-h/2},{x:p,y:l+h/2}]},y.min={points:[{x:c,y:l-h/2},{x:c,y:l+h/2}]}):(y.box={x:n-s/2,x1:n+s/2,y:d,y1:u},y.median={points:[{x:n-s/2,y:g},{x:n+s/2,y:g}]},y.max={points:[{x:n-o/2,y:p},{x:n+o/2,y:p}]},y.min={points:[{x:n-o/2,y:c},{x:n+o/2,y:c}]},y.shaft={points:[{x:n,y:c},{x:n,y:p}]}),(0,hy.Z)(f)){let e=null!=(r=t.anchor)?r:m?[(c+p)/2,l]:[n,(c+p)/2];Object.keys(y).forEach(t=>{y[t].angle=f,y[t].anchor=e})}return y})}setDataLabelType(){return"symbol"}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:2,boxWidth:30,shaftWidth:20,shaftShape:"line"})}}BK.type="boxPlot";let BX=()=>{BG(),_W(),c7(),h9.registerGraphicComponent("line",t=>_I(t)),h9.registerGraphicComponent("rect",t=>cN(t)),h9.registerMark(BK.type,BK)},BY=Object.assign(Object.assign({},b7),{boxPlot:{name:"boxPlot",type:"boxPlot"},outlier:{name:"outlier",type:"symbol"}}),B$=t=>(e,i,r)=>{var n;let l=e.getFinalAttribute(),s=t(e,null!=(n=l.direction)?n:"vertical",i);if(!(0,hy.Z)(s))return{};let{x:a,y:o,min:h,max:d,q1:u,q3:c,median:p}=l,g={from:{x:a,y:o},to:{x:a,y:o}};return(0,hy.Z)(h)&&(g.from.min=s,g.to.min=h),(0,hy.Z)(d)&&(g.from.max=s,g.to.max=d),(0,hy.Z)(u)&&(g.from.q1=s,g.to.q1=u),(0,hy.Z)(c)&&(g.from.q3=s,g.to.q3=c),(0,hy.Z)(p)&&(g.from.median=s,g.to.median=p),g},Bq=t=>(e,i,r)=>{var n;let l=e.getFinalAttribute(),s=t(e,null!=(n=l.direction)?n:"vertical",i);if(!(0,hy.Z)(s))return{};let{x:a,y:o,min:h,max:d,q1:u,q3:c,median:p}=l,g={from:{x:a,y:o},to:{x:a,y:o}};return(0,hy.Z)(h)&&(g.to.min=s,g.from.min=h),(0,hy.Z)(d)&&(g.to.max=s,g.from.max=d),(0,hy.Z)(u)&&(g.to.q1=s,g.from.q1=u),(0,hy.Z)(c)&&(g.to.q3=s,g.from.q3=c),(0,hy.Z)(p)&&(g.to.median=s,g.from.median=p),g},BJ=(t,e)=>t.getSubGraphic().find(t=>t.name===e),BQ=(t,e,i)=>{var r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S;let A,M,T,k,R;if(i&&(0,hy.Z)(i.center))return i.center;if("horizontal"===e){A=null==(l=null==(n=(null==(r=BJ(t,"median"))?void 0:r.attribute).points)?void 0:n[0])?void 0:l.x,M=null==(h=null==(o=null==(a=null==(s=BJ(t,"max"))?void 0:s.attribute)?void 0:a.points)?void 0:o[0])?void 0:h.x,T=null==(p=null==(c=null==(u=null==(d=BJ(t,"min"))?void 0:d.attribute)?void 0:u.points)?void 0:c[0])?void 0:p.x;let e=BJ(t,"box").attribute.width,i=BJ(t,"box").attribute.x;k=i,R=i+e}else{A=null==(m=null==(f=(null==(g=BJ(t,"median"))?void 0:g.attribute).points)?void 0:f[0])?void 0:m.y,M=null==(_=null==(b=null==(v=null==(y=BJ(t,"max"))?void 0:y.attribute)?void 0:v.points)?void 0:b[0])?void 0:_.y,T=null==(S=null==(w=null==(x=null==(C=BJ(t,"min"))?void 0:C.attribute)?void 0:x.points)?void 0:w[0])?void 0:S.y;let e=BJ(t,"box").attribute.height,i=BJ(t,"box").attribute.y;k=i,R=i+e}return(0,hy.Z)(A)?A:(0,hy.Z)(k)&&(0,hy.Z)(R)?(k+R)/2:(0,hy.Z)(M)&&(0,hy.Z)(T)?(M+T)/2:(0,hy.Z)(T)?T:(0,hy.Z)(M)?M:NaN},B0=(t,e,i)=>{var r,n,l,s,a,o,h,d,u,c,p,g,f,m;let y,v,b,_,C;if((0,hy.Z)(null==i?void 0:i.center))return i.center;if("horizontal"===e){y=null==(l=null==(n=(null==(r=BJ(t,"median"))?void 0:r.attribute).points)?void 0:n[0])?void 0:l.x;let e=(null==(s=BJ(t,"minMaxBox"))?void 0:s.attribute).width,i=null==(a=BJ(t,"minMaxBox"))?void 0:a.attribute.x;b=i,v=i+e;let d=(null==(o=BJ(t,"q1q3Box"))?void 0:o.attribute).width,u=null==(h=BJ(t,"q1q3Box"))?void 0:h.attribute.x;_=u,C=u+d}else{y=null==(c=null==(u=(null==(d=BJ(t,"median"))?void 0:d.attribute).points)?void 0:u[0])?void 0:c.y;let e=(null==(p=BJ(t,"minMaxBox"))?void 0:p.attribute).height,i=null==(g=BJ(t,"minMaxBox"))?void 0:g.attribute.y;b=i,v=i+e;let r=(null==(f=BJ(t,"q1q3Box"))?void 0:f.attribute).height,n=null==(m=BJ(t,"q1q3Box"))?void 0:m.attribute.y;_=n,C=n+r}return(0,hy.Z)(y)?y:(0,hy.Z)(_)&&(0,hy.Z)(C)?(_+C)/2:(0,hy.Z)(v)&&(0,hy.Z)(b)?(v+b)/2:(0,hy.Z)(b)?b:(0,hy.Z)(v)?v:NaN};class B1 extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){super.onBind();let t=this.target.getFinalAttribute();t&&this.target.setAttributes(t);let{from:e,to:i}=this.computeAttribute();this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.animate.reSyncProps(),this.from=e,this.to=i,this.target.setAttributes(this.from)}computeAttribute(){return B$(BQ)(this.target,this.params,this.params.options)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}class B2 extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t;(null==(t=this.params)?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);let{from:e,to:i}=this.computeAttribute();this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.animate.reSyncProps(),this.from=e,this.to=i,this.target.setAttributes(this.from)}computeAttribute(){return Bq(BQ)(this.target,this.params,this.params.options)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}class B3 extends B1{computeAttribute(){return B$(B0)(this.target,this.params,this.params.options)}}class B5 extends B2{computeAttribute(){return Bq(B0)(this.target,this.params,this.params.options)}}let B4=()=>{yv.registerBuiltInAnimate("boxplotScaleIn",B1),yv.registerBuiltInAnimate("boxplotScaleOut",B2),yv.registerBuiltInAnimate("barBoxplotScaleIn",B3),yv.registerBuiltInAnimate("barBoxplotScaleOut",B5)};class B6 extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"boxPlot")}}class B7 extends _y{constructor(){super(...arguments),this.type=Y.boxPlot,this.transformerConstructor=B6,this._bandPosition=0}getMinField(){return this._minField}getMaxField(){return this._maxField}getQ1Field(){return this._q1Field}getMedianField(){return this._medianField}getQ3Field(){return this._q3Field}getOutliersField(){return this._outliersField}getShaftShape(){return this._shaftShape}getBoxFillColor(){return this._boxFillColor}getStrokeColor(){return this._strokeColor}getOutliersStyle(){return this._outliersStyle}setAttrFromSpec(){var t,e,i,r,n,l,s;super.setAttrFromSpec();let a=null!=(e=null==(t=this._spec.boxPlot)?void 0:t.style)?e:{};this._minField=this._spec.minField,this._maxField=this._spec.maxField,this._q1Field=this._spec.q1Field,this._medianField=this._spec.medianField,this._q3Field=this._spec.q3Field,this._outliersField=this._spec.outliersField,this._lineWidth=null!=(i=a.lineWidth)?i:2,this._boxWidth=a.boxWidth,this._shaftShape=null!=(r=a.shaftShape)?r:"line",this._shaftWidth=a.shaftWidth,this._boxFillColor=a.boxFill,this._strokeColor=a.stroke,this._shaftFillOpacity="bar"===this._shaftShape?null!=(n=a.shaftFillOpacity)?n:.5:void 0,this._outliersStyle=null!=(l=this._spec.outliersStyle)?l:null==(s=this._spec.outlier)?void 0:s.style}initMark(){this._boxPlotMark=this._createMark(B7.mark.boxPlot,{groupKey:this._seriesField,isSeriesMark:!0}),this._outliersField&&(this._outlierMark=this._createMark(B7.mark.outlier,{key:ur,groupKey:this._seriesField}),this._outlierMark.setData(this._outlierData))}initMarkStyle(){var t,e,i,r,n,l;let s=this._boxPlotMark;if(s){let i={lineWidth:this._lineWidth,fill:null!=(t=this._boxFillColor)?t:"line"!==this._shaftShape?this.getColorAttribute():"#FFF",minMaxFillOpacity:this._shaftFillOpacity,stroke:null!=(e=this._strokeColor)?e:"line"!==this._shaftShape?"#000":this.getColorAttribute()};s.setGlyphConfig({direction:this._direction,shaftShape:this._shaftShape});let r="horizontal"===this._direction?{y:t=>this._getPosition(this.direction,t),boxHeight:()=>{var t;return hk(null!=(t=this._boxWidth)?t:"100%",this._getMarkWidth())},ruleHeight:()=>{var t;return hk(null!=(t=this._shaftWidth)?t:"100%",this._getMarkWidth())},q1q3Height:()=>{var t;return hk(null!=(t=this._boxWidth)?t:"100%",this._getMarkWidth())},minMaxHeight:()=>{var t;return hk(null!=(t=this._shaftWidth)?t:"100%",this._getMarkWidth())}}:{x:t=>this._getPosition(this.direction,t),boxWidth:()=>{var t;return hk(null!=(t=this._boxWidth)?t:"100%",this._getMarkWidth())},ruleWidth:()=>{var t;return hk(null!=(t=this._shaftWidth)?t:"100%",this._getMarkWidth())},q1q3Width:()=>{var t;return hk(null!=(t=this._boxWidth)?t:"100%",this._getMarkWidth())},minMaxWidth:()=>{var t;return hk(null!=(t=this._shaftWidth)?t:"100%",this._getMarkWidth())}};this.setMarkStyle(s,i,td.STATE_NORMAL,to.Series),this.setMarkStyle(s,r,td.STATE_NORMAL,to.Built_In)}let a=this._outlierMark;a&&this.setMarkStyle(a,{fill:null!=(n=null!=(r=null==(i=this._outliersStyle)?void 0:i.fill)?r:this._boxFillColor)?n:this.getColorAttribute(),stroke:this.getColorAttribute(),size:(0,n4.Z)(null==(l=this._outliersStyle)?void 0:l.size)?this._outliersStyle.size:10},td.STATE_NORMAL,to.Series)}initBoxPlotMarkStyle(){var t,e;let i=this._boxPlotMark,r="horizontal"===this._direction?this._xAxisHelper:this._yAxisHelper;if(i&&r){let{dataToPosition:e}=r,n=null==(t=null==r?void 0:r.getScale)?void 0:t.call(r,0);this.setMarkStyle(i,{min:t=>pF(e(this.getDatumPositionValues(t,this._minField),{bandPosition:this._bandPosition}),n),q1:t=>pF(e(this.getDatumPositionValues(t,this._q1Field),{bandPosition:this._bandPosition}),n),median:t=>pF(e(this.getDatumPositionValues(t,this._medianField),{bandPosition:this._bandPosition}),n),q3:t=>pF(e(this.getDatumPositionValues(t,this._q3Field),{bandPosition:this._bandPosition}),n),max:t=>pF(e(this.getDatumPositionValues(t,this._maxField),{bandPosition:this._bandPosition}),n)},td.STATE_NORMAL,to.Series)}let n=this._outlierMark;if(n&&r){let{dataToPosition:t}=r,i=null==(e=null==r?void 0:r.getScale)?void 0:e.call(r,0),l="horizontal"===this._direction?{y:t=>this._getPosition(this.direction,t),x:e=>pF(t(this.getDatumPositionValues(e,BB),{bandPosition:this._bandPosition}),i)}:{x:t=>this._getPosition(this.direction,t),y:e=>pF(t(this.getDatumPositionValues(e,BB),{bandPosition:this._bandPosition}),i)};this.setMarkStyle(n,l,td.STATE_NORMAL,to.Series)}}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getMedianField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null})}initData(){if(super.initData(),!this._data)return;dL(this._dataSet,"foldOutlierData",BI),dL(this._dataSet,"addVChartProperty",bO);let t=new eq.V(this._dataSet,{name:`${this.type}_outlier_${this.id}_data`});t.parse([this.getViewData()],{type:"dataview"}),t.name=`${d9}_series_${this.id}_outlierData`,t.transform({type:"foldOutlierData",options:{dimensionField:"horizontal"===this._direction?this._fieldY:this._fieldX,outliersField:this._outliersField,seriesField:this._seriesField}}),t.transform({type:"addVChartProperty",options:{beforeCall:b3.bind(this),call:b5}},!1),this._outlierData=new pV(this._option,t)}compileData(){var t;super.compileData(),null==(t=this._outlierData)||t.compile()}viewDataUpdate(t){var e;super.viewDataUpdate(t),null==(e=this._outlierData)||e.updateData()}init(t){super.init(t),this.initBoxPlotMarkStyle()}_getMarkWidth(){var t;if(this._autoBoxWidth)return this._autoBoxWidth;let e="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,i=this._groups?this._groups.fields.length:1,r=null==(t=e.getBandwidth)?void 0:t.call(e,i-1),n=r;return(0,aw.Z)(this._spec.boxWidth)&&(n=hk(this._spec.boxWidth,r)),(0,aw.Z)(this._spec.boxMinWidth)&&(n=Math.max(n,hk(this._spec.boxMinWidth,r))),(0,aw.Z)(this._spec.boxMaxWidth)&&(n=Math.min(n,hk(this._spec.boxMaxWidth,r))),this._autoBoxWidth=n,this._autoBoxWidth}_getPosition(t,e){var i,r,n,l;let s,a,o;"horizontal"===t?(s=this.getYAxisHelper(),a="boxHeight",o=this.dataToPositionY.bind(this)):(s=this.getXAxisHelper(),a="boxWidth",o=this.dataToPositionX.bind(this));let h=s.getScale(0),d=this._groups?this._groups.fields.length:1,u=null==(i=s.getBandwidth)?void 0:i.call(s,d-1),c=this._boxPlotMark.getAttribute(a,e);if(d>1&&(0,aw.Z)(this._spec.boxGapInGroup)){let t=this._groups.fields,i=(0,a1.IX)(this._spec.boxGapInGroup),a=0,o=0;for(let h=t.length-1;h>=1;h--){let d=t[h],p=null!=(n=null==(r=s.getScale(h))?void 0:r.domain())?n:[],g=p.length,f=hk(null!=(l=i[h-1])?l:(0,a1.Z$)(i),u),m=p.indexOf(e[d]);h===t.length-1?(a+=g*c+(g-1)*f,o+=m*(c+f)):(o+=m*(a+f),a+=a+(g-1)*f)}return h.scale(e[t[0]])+s.getBandwidth(0)/2-a/2+o+c/2}let p=(0,pW.z2)(h.type||"band");return o(e)+.5*u+(p?-u/2:0)}onLayoutEnd(){super.onLayoutEnd(),this._autoBoxWidth=null}_initAnimationSpec(t={}){let e=(0,h3.Z)({},t);return["appear","enter","update","exit","disappear"].forEach(t=>{e[t]&&"scaleIn"===e[t].type?e[t].type="bar"===this._shaftShape?"barBoxplotScaleIn":"boxplotScaleIn":e[t]&&"scaleOut"===e[t].type&&(e[t].type="bar"===this._shaftShape?"barBoxplotScaleOut":"boxplotScaleOut")}),e}initAnimation(){var t,e,i,r,n,l,s;let a=_m(this);if(this._boxPlotMark){let e=this._initAnimationSpec(null==(t=h9.getAnimationInKey("scaleInOut"))?void 0:t()),i=this._initAnimationSpec(_s("boxPlot",this._spec,this._markAttributeContext));this._boxPlotMark.setAnimationConfig(_l(e,i,a))}if(this._outlierMark){let t={appear:null==(e=this._spec.animationAppear)?void 0:e.symbol,disappear:null==(i=this._spec.animationDisappear)?void 0:i.symbol,enter:null==(r=this._spec.animationEnter)?void 0:r.symbol,exit:null==(n=this._spec.animationExit)?void 0:n.symbol,update:null==(l=this._spec.animationUpdate)?void 0:l.symbol};this._outlierMark.setAnimationConfig(_l(null==(s=h9.getAnimationInKey("scaleInOut"))?void 0:s(),t,a))}}initTooltip(){this._tooltipHelper=new BE(this),this._boxPlotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._boxPlotMark),this._outlierMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._outlierMark)}getStatisticFields(){let t=super.getStatisticFields(),e=t.find(t=>t.key===this._outliersField);return e&&(e.operations=["array-min","array-max"]),t}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._boxPlotMark]}}B7.type=Y.boxPlot,B7.builtInTheme={boxPlot:{boxPlot:{style:{lineWidth:1}},label:{style:{lineWidth:2}}}},B7.mark=BY,B7.transformerConstructor=B6;let B8=()=>{BX(),CK(),vX(),SI(),SX(),B4(),h9.registerSeries(B7.type,B7)};class B9 extends Ar{_getDefaultSeriesSpec(t){var e;let i=[t.maxField,t.medianField,t.q1Field,t.q3Field,t.minField,t.outliersField],r=super._getDefaultSeriesSpec(t,["boxPlot","outlier","minField","maxField","q1Field","medianField","q3Field","outliersField","outliersStyle","boxWidth","boxMaxWidth","boxMinWidth","boxGapInGroup"]);return r.direction=null!=(e=t.direction)?e:"vertical",r["horizontal"===r.direction?"xField":"yField"]=i,r}transformSpec(t){super.transformSpec(t),t.axes||(t.axes=[{orient:"bottom"},{orient:"left"}]),c8(t)}}var It=i(67844);class Ie extends Ah{constructor(){super(...arguments),this.transformerConstructor=B9,this.type="boxPlot",this.seriesType=Y.boxPlot}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}Ie.type="boxPlot",Ie.seriesType=Y.boxPlot,Ie.transformerConstructor=B9;let Ii=()=>{AX(),A$(),AM(),Af(),B8(),h9.registerTransform("boxplot",It.r),h9.registerChart(Ie.type,Ie)};var Ir=i(4057);let In=(t,e,i)=>{e.forEach(e=>{(0,nB.Z)(e[i])||t.add(e[i]),e.children&&e.children.length>0&&In(t,e.children,i)})},Il=t=>{var e;if(!t||!(0,rD.Z)(t))return[];if(t.length>1){let e={links:[],nodes:[]};return t.forEach(t=>{"links"!==t.id&&"nodes"!==t.id||(e[t.id]=t.values)}),[e]}return(null==(e=t[0])?void 0:e.latestData)?t[0].latestData:t},Is=(t,e)=>{if(!t||!(null==e?void 0:e.view)||!t.length)return[];let i=e.view();if(i.x1-i.x0==0||i.y1-i.y0==0||i.x1-i.x0==-1/0||i.x1-i.x0==1/0||i.y1-i.y0==-1/0||i.y1-i.y0==1/0)return[];let r=t[0];if(("source"!==e.sourceField||"target"!==e.targetField||"value"!==e.valueField)&&r.links){let t=[];r.links.forEach(i=>{let r={};for(let t in i)t===e.sourceField?r.source=i[e.sourceField]:t===e.targetField?r.target=i[e.targetField]:t===e.valueField?r.value=i[e.valueField]:r[t]=i[t];t.push(r)}),r.links=t}let n=new Ir.V(e),l=[];return l.push(n.layout(r,i)),l},Ia=t=>{var e,i;return t&&(0,rD.Z)(t)&&(null==(e=t[0])?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!=(i=t[0].latestData[0].nodes)?i:[]},Io=t=>{var e,i;return t&&(0,rD.Z)(t)&&(null==(e=t[0])?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!=(i=t[0].latestData[0].links)?i:[]};class Ih extends bY{constructor(){super(...arguments),this._getDimensionData=t=>{if(t.source){if((0,n4.Z)(t.source)){let e=this.series.getSeriesKeys();return e[t.source]+" => "+e[t.target]}return t.source+" => "+t.target}return t.datum?t.datum[this.series.getSpec().categoryField]:t.key},this.markTooltipValueCallback=t=>t.value}}let Id=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:{overall:e?t.growFrom():e,orient:"positive"}}),Iu=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:Id(t),Ic=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"linkPathGrowIn"},Ip=(t,e,i)=>{let r={x0:t.getFinalAttribute().x0,x1:t.getFinalAttribute().x1,y0:t.getFinalAttribute().y0,y1:t.getFinalAttribute().y1,thickness:t.getFinalAttribute().thickness};return{from:Object.assign({},r,{x1:r.x0,y1:r.y0}),to:r}},Ig=(t,e,i)=>{let r={x0:t.getFinalAttribute().x0,x1:t.getFinalAttribute().x1,y0:t.getFinalAttribute().y0,y1:t.getFinalAttribute().y1,thickness:t.getFinalAttribute().thickness};return{from:r,to:Object.assign({},r,{x1:r.x0,y1:r.y0})}};class If extends gg{onBind(){var t,e,i;super.onBind(),(null==(t=this.params)?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);let{from:r,to:n}=Ip(this.target,this.params.options,this.params),l=null!=(i=null==(e=this.target.context)?void 0:e.lastAttrs)?i:r,s=this.target.getFinalAttribute();s&&Object.assign(this.target.attribute,s),this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.animate.reSyncProps(),this.from=l,this.to=n,this.target.setAttributes(l)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}class Im extends gg{onBind(){var t,e,i;super.onBind(),(null==(t=this.params)?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);let{from:r,to:n}=Ig(this.target,this.params.options,this.params),l=null!=(i=null==(e=this.target.context)?void 0:e.lastAttrs)?i:r;this.props=n,this.propKeys=Object.keys(n).filter(t=>null!=n[t]),this.animate.reSyncProps(),this.from=l,this.to=n,this.target.setAttributes(l)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}let Iy=()=>{h9.registerAnimation("sankeyNode",(t,e)=>Object.assign({appear:Iu(t,e)},vK)),h9.registerAnimation("sankeyLinkPath",(t,e)=>({appear:Ic(e),enter:{type:"linkPathGrowIn"},exit:{type:"linkPathGrowOut"},disappear:{duration:vV.disappear.duration}})),yv.registerBuiltInAnimate("linkPathGrowOut",Im),yv.registerBuiltInAnimate("linkPathGrowIn",If)},Iv=(t,e)=>{var i;let r=null!=(i=t.curvature)?i:.5,n="number"==typeof e?t.thickness*e:t.thickness,l=t.x0,s=t.x1,a=t.y0,o=t.y1,h=l+r*(s-l),d=s+r*(l-s),u=t=>t;!1!==t.round&&(l=Math.round(l),s=Math.round(s),a=Math.round(a),o=Math.round(o),h=Math.round(h),d=Math.round(d),u=Math.round),"line"===t.pathType||t.pathType,"center"===t.align?(a=u(t.y0-n/2),o=u(t.y1-n/2)):"end"===t.align?(a=u(t.y0+t.thickness/2-n),o=u(t.y1+t.thickness/2-n)):(a=u(t.y0-t.thickness/2),o=u(t.y1-t.thickness/2));let c=u(a+n),p=u(o+n),g=Math.abs(s-l)>1e-6,f=t.endArrow&&g?`L${s},${u(o-n/2)}L${u(s+n)},${u((o+p)/2)}L${s},${u(p+n/2)}`:"",m=t.startArrow&&g?`L${l},${u(c+n/2)}L${u(l-n)},${u((a+c)/2)}L${l},${u(a-n/2)}`:"";return"line"===t.pathType?`M${l},${a}L${s},${o}${f}L${s},${p}L${l},${c}${m}Z`:"polyline"===t.pathType?`M${l},${a}L${h},${a}L${h},${o}L${s},${o}
    ${f}L${s},${p}L${h},${p}L${h},${c}L${l},${c}${m}Z`:`M${l},${a}C${h},${a},${d},${o},${s},${o}
  ${f}L${s},${p}C${d},${p},${h},${c},${l},${c}${m}Z`},Ib=(t,e)=>{var i;let r=null!=(i=t.curvature)?i:.5,n="number"==typeof e?t.thickness*e:t.thickness,l=t.y0,s=t.y1,a=t.x0,o=t.x1,h=l+r*(s-l),d=s+r*(l-s),u=t=>t;!1!==t.round&&(u=Math.round,l=Math.round(l),s=Math.round(s),a=Math.round(a),o=Math.round(o),h=Math.round(h),d=Math.round(d)),"line"===t.pathType||t.pathType,"center"===t.align?(a=u(t.x0-n/2),o=u(t.x1-n/2)):"end"===t.align?(a=u(t.x0+t.thickness/2-n),o=u(t.x1+t.thickness/2-n)):(a=u(t.x0-t.thickness/2),o=u(t.x1-t.thickness/2));let c=u(a+n),p=u(o+n),g=Math.abs(s-l)>1e-6,f=t.endArrow&&g?`L${u(o-n/2)},${s}L${u((o+p)/2)},${u(s+n)}L${u(p+n/2)},${s}`:"",m=t.startArrow&&g?`L${u(c+n/2)},${l}L${u((c+a)/2)},${u(l-n)}L${u(a-n/2)},${l}`:"";return"line"===t.pathType?`M${a},${l}L${o},${s}${f}L${p},${s}L${c},${l}${m}Z`:"polyline"===t.pathType?`M${a},${l}L${a},${h}L${o},${h}L${o},${s}
    ${f}L${p},${s}L${p},${h}L${c},${h}L${c},${l}${m}Z`:`M${a},${l}C${a},${h},${o},${d},${o},${s}
  ${f}L${p},${s}C${p},${d},${c},${h},${c},${l}${m}Z`};class I_ extends Bj{constructor(){super(...arguments),this.type=I_.type,this._subMarks={back:{type:"path",defaultAttributes:{zIndex:0}},front:{type:"path",defaultAttributes:{zIndex:1}}},this._positionChannels=["x0","y0","x1","y1","thickness","round","curvature","ratio","pathType","align","endArrow","startArrow","ratio"],this._channelEncoder={backgroundStyle:t=>({back:t})},this._positionEncoder=(t,e,i)=>{var r,n;let l=Object.assign(Object.assign({},i.attribute),t),s=["vertical","TB","BT"].includes(null!=(r=l.direction)?r:null==(n=this._glyphConfig)?void 0:n.direction)?Ib:Iv,a="number"==typeof l.ratio&&l.ratio>=0&&l.ratio<=1;return{back:{path:a?s(l,1):""},front:{path:s(l,a?l.ratio:1)}}}}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,x0:0,y0:0,x1:100,y1:100,thickness:1,round:!0})}}I_.type="linkPath";let IC=()=>{BG(),wD(),h9.registerGraphicComponent("path",t=>wP(t)),h9.registerMark(I_.type,I_)},Ix=Object.assign(Object.assign({},b7),{node:{name:"node",type:"rect"},link:{name:"link",type:"linkPath"}});class Iw extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"node")}}let IS=(t,e,i,r=!0,n)=>{t.runtimeStateCache||(t.runtimeStateCache={}),t.runtimeStateCache[e]=i,t.hasState(e)&&t.removeState(e),t.addState(e,r,n)};class IA extends _y{constructor(){super(...arguments),this.type=Y.sankey,this.transformerConstructor=Iw,this._nodeLayoutZIndex=ts.Node,this._labelLayoutZIndex=ts.Label,this._viewBox=new iI.YZ,this._fillByNode=t=>{var e,i,r,n,l;if(t&&t.sourceRect&&t.targetRect)return this._fillByLink(t);let s=null==(i=null==(e=this._spec.node)?void 0:e.style)?void 0:i.fill;if((0,aw.Z)(s))return s;if((0,aw.Z)(this._spec.seriesField)){let e=null==(n=null==(r=this._option)?void 0:r.globalScale)?void 0:n.getScale("color"),i=(null==t?void 0:t.datum)?t.datum:t;return null==e?void 0:e.scale(null==i?void 0:i[this._spec.seriesField])}return null==(l=this._colorScale)?void 0:l.scale(this._getNodeNameFromData(t))},this._fillByLink=t=>{var e,i,r,n,l,s;let a=null==(i=null==(e=this._spec.link)?void 0:e.style)?void 0:i.fill;if(a)return a;if((0,aw.Z)(this._spec.seriesField)){let e=null==(r=this._nodesSeriesData.latestData)?void 0:r.find(e=>t.source===e.key),i=null==e?void 0:e.datum,s=null==(l=null==(n=this._option)?void 0:n.globalScale)?void 0:l.getScale("color");return null==s?void 0:s.scale(null==i?void 0:i[this._spec.seriesField])}let o=(0,n4.Z)(t.source)?this.getNodeList()[t.source]:t.source;return null==(s=this._colorScale)?void 0:s.scale(o)},this._handleEmphasisElement=t=>{var e;let i=null!=(e=this._spec.emphasis)?e:{},r=t.item;"adjacency"===i.effect?r&&t.mark===this._nodeMark?this._handleNodeAdjacencyClick(r):r&&t.mark===this._linkMark?this._handleLinkAdjacencyClick(r):this._handleClearEmpty():"related"===i.effect&&(r&&t.mark===this._nodeMark?this._handleNodeRelatedClick(r):r&&t.mark===this._linkMark?this._handleLinkRelatedClick(r):this._handleClearEmpty())},this._handleClearEmpty=()=>{var t,e;if(!this._needClear)return;let i=null==(t=this._nodeMark)?void 0:t.getGraphics();if(!i||!i.length)return;let r=null==(e=this._linkMark)?void 0:e.getGraphics();r&&r.length&&(i.forEach(t=>{t.removeState(td.STATE_SANKEY_EMPHASIS),t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE)}),r.forEach(t=>{t.removeState(td.STATE_SANKEY_EMPHASIS),t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE)}),this._needClear=!1)},this._handleNodeAdjacencyClick=t=>{let e=dM(t),i=[e.key];if(this._linkMark){let t=this._linkMark.getGraphics();if(!t||!t.length)return;t.forEach((t,r)=>{let n=dM(t);n.source===e.key?(i.includes(n.target)||i.push(n.target),t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(td.STATE_SANKEY_EMPHASIS,!0)):n.target===e.key?(i.includes(n.source)||i.push(n.source),t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(td.STATE_SANKEY_EMPHASIS,!0)):(t.removeState(td.STATE_SANKEY_EMPHASIS),t.addState(td.STATE_SANKEY_EMPHASIS_REVERSE,!0))})}this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),i),this._needClear=!0},this._handleLinkAdjacencyClick=t=>{let e=dM(t),i=[e.source,e.target];if(this._linkMark){let e=this._linkMark.getGraphics();if(!e||!e.length)return;e.forEach(e=>{e===t?(e.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE),IS(e,td.STATE_SANKEY_EMPHASIS,{ratio:1})):(e.removeState(td.STATE_SANKEY_EMPHASIS),e.addState(td.STATE_SANKEY_EMPHASIS_REVERSE,!0))})}this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),i),this._needClear=!0},this._handleNodeRelatedClick=t=>{var e;let i=dM(t),r=this._nodeMark.getGraphics();if(!r||!r.length)return;let n=this._linkMark.getGraphics();if(!n||!n.length)return;let l=(null==(e=dM(n[0]))?void 0:e.parents)?"parents":"source";if("source"===l){let t=[i.key],e=[];if(n.forEach((n,l)=>{var s,a,o,h;let d=dM(n),u=(null==d?void 0:d.parents)?"parents":"source";if((0,a1.IX)(d[u]).includes(i.key)){if(e.includes(null!=(s=d.key)?s:d.index)||e.push(null!=(a=d.key)?a:d.index),t.includes(d.source)||t.push(d.source),!t.includes(d.target)){t.push(d.target);let i=r.find(t=>t.data[0].key===d.target).data[0].sourceLinks;for(;(null==i?void 0:i.length)>0;){let n=[];return i.forEach(i=>{var l,s;if(!e.includes(null!=(l=i.key)?l:i.index)&&(e.push(null!=(s=i.key)?s:i.index),!t.includes(i.target))){t.push(i.target);let e=r.find(t=>t.data[0].key===i.target);n.push(e.data[0].targetLinks)}}),void(i=n)}}}else if(d.target===i.key&&(e.includes(null!=(o=d.key)?o:d.index)||e.push(null!=(h=d.key)?h:d.index),!t.includes(d.source))){t.push(d.source);let i=r.find(t=>t.data[0].key===d.source).data[0].targetLinks;for(;(null==i?void 0:i.length)>0;){let n=[];return i.forEach(i=>{var l,s;if(!e.includes(null!=(l=i.key)?l:i.index)&&(e.push(null!=(s=i.key)?s:i.index),!t.includes(i.source))){t.push(i.source);let e=r.find(t=>t.data[0].key===i.source);n.push(e.data[0].targetLinks)}}),void(i=n)}}}),this._linkMark){let t=this._linkMark.getGraphics();if(!t||!t.length)return;t.forEach((t,i)=>{var r;let n=dM(t);e.includes(null!=(r=n.key)?r:n.index)?(t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(td.STATE_SANKEY_EMPHASIS,!0)):(t.removeState(td.STATE_SANKEY_EMPHASIS),t.addState(td.STATE_SANKEY_EMPHASIS_REVERSE,!0))})}this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),t)}else{let t=[i.key],e=i.targetLinks.reduce((t,e)=>((0,a1.IX)(e.datum).forEach(e=>{let r=e.parents,n=r.length;for(let l=0;l<n;l++){let n=r[l].key,s=r[l+1]?r[l+1].key:i.key,a=e.value,o=t.find(t=>t.source===n&&t.target===s);o?o.value+=a:t.push({source:n,target:s,value:a})}}),t),[]);n.forEach((r,n)=>{let s=dM(r),a=s.datum,o=a?a.filter(t=>t[l].some(t=>t.key===i.key)):null,h=e.find(t=>t.source===s.source&&t.target===s.target);if(o&&o.length){t.includes(s.source)||t.push(s.source),t.includes(s.target)||t.push(s.target);let e=o.reduce((t,e)=>t+e.value,0)/s.value;return r.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE),void IS(r,td.STATE_SANKEY_EMPHASIS,{ratio:e})}if(h)return t.includes(s.source)||t.push(s.source),t.includes(s.target)||t.push(s.target),r.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE),void IS(r,td.STATE_SANKEY_EMPHASIS,{ratio:h.value/s.value});r.removeState(td.STATE_SANKEY_EMPHASIS),r.addState(td.STATE_SANKEY_EMPHASIS_REVERSE,!0)}),this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),t)}this._needClear=!0},this._handleLinkRelatedClick=t=>{let e=this._nodeMark.getGraphics();if(!e||!e.length)return;let i=this._linkMark.getGraphics();if(i&&i.length){if("source"==(dM(t)?"parents":"source"))this._linkMark&&i.forEach(t=>{t.removeState(td.STATE_SANKEY_EMPHASIS),t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE)}),this._nodeMark&&e.forEach(t=>{t.removeState(td.STATE_SANKEY_EMPHASIS),t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE)});else{let r=dM(t),n=[r.source,r.target],l=[];(0,a1.IX)(r.datum).forEach(t=>{let e=t.parents,i=e.length;for(let r=0;r<i-1;r++){let i=e[r].key,n=e[r+1].key,s=t.value,a=l.find(t=>t.source===i&&t.target===n);l.push({source:e[r].key,target:e[r+1].key,value:t.value}),a?a.value+=s:l.push({source:i,target:n,value:s})}}),i.forEach(t=>{let e=dM(t),i=e.datum;if(e.source===r.source&&e.target===r.target)return t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE),void IS(t,td.STATE_SANKEY_EMPHASIS,{ratio:1});let s=i?i.filter(t=>{let e=t.parents.map(t=>t.key);return e.includes(r.source)&&e.includes(r.target)}):null;if(s&&s.length){n.includes(e.source)||n.push(e.source),n.includes(e.target)||n.push(e.target);let i=s.filter(t=>t.parents.some((e,i)=>{var n;return e.key===r.source&&(null==(n=t.parents[i+1])?void 0:n.key)===r.target})).reduce((t,e)=>t+e.value,0)/e.value;return t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE),void IS(t,td.STATE_SANKEY_EMPHASIS,{ratio:i})}let a=l.find(t=>t.source===e.source&&t.target===e.target);if(a)return n.includes(e.source)||n.push(e.source),n.includes(e.target)||n.push(e.target),t.removeState(td.STATE_SANKEY_EMPHASIS_REVERSE),void IS(t,td.STATE_SANKEY_EMPHASIS,{ratio:a.value/e.value});t.removeState(td.STATE_SANKEY_EMPHASIS),t.addState(td.STATE_SANKEY_EMPHASIS_REVERSE,!0)}),this._highLightElements(e,n)}this._needClear=!0}}}get direction(){var t;return null!=(t=this._spec.direction)?t:"horizontal"}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:this._spec.categoryField)}initData(){var t,e,i,r;super.initData();let n=this.getViewData(),l=this.getRawData();if(l&&n){dL(this._dataSet,"sankeyLayout",Is),dL(this._dataSet,"sankeyFormat",Il),l.transform({type:"sankeyFormat"},!1),n.transform({type:"sankeyLayout",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),sourceField:this._spec.sourceField,targetField:this._spec.targetField,valueField:this._spec.valueField,direction:this.direction,crossNodeAlign:this._spec.crossNodeAlign,nodeAlign:null!=(t=this._spec.nodeAlign)?t:"justify",nodeGap:null!=(e=this._spec.nodeGap)?e:8,nodeWidth:null!=(i=this._spec.nodeWidth)?i:10,linkWidth:this._spec.linkWidth,minStepWidth:this._spec.minStepWidth,minNodeHeight:null!=(r=this._spec.minNodeHeight)?r:4,maxNodeHeight:this._spec.maxNodeHeight,minLinkHeight:this._spec.minLinkHeight,maxLinkHeight:this._spec.maxLinkHeight,iterations:this._spec.iterations,nodeKey:this._spec.nodeKey,linkSortBy:this._spec.linkSortBy,nodeSortBy:this._spec.nodeSortBy,setNodeLayer:this._spec.setNodeLayer,dropIsolatedNode:this._spec.dropIsolatedNode,nodeHeight:this._spec.nodeHeight,linkHeight:this._spec.linkHeight,equalNodeHeight:this._spec.equalNodeHeight,linkOverlap:this._spec.linkOverlap,inverse:this._spec.inverse},level:ti.sankeyLayout});let{dataSet:s}=this._option;dL(s,"sankeyNodes",Ia),dL(s,"flatten",Pk);let a=new eq.V(s,{name:`sankey-node-${this.id}-data`});a.parse([this.getViewData()],{type:"dataview"}),a.transform({type:"sankeyNodes"}),a.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}},!1),a.transform({type:"addVChartProperty",options:{beforeCall:b3.bind(this),call:b5}},!1),this._nodesSeriesData=a,dL(s,"sankeyLinks",Io);let o=new eq.V(s,{name:`sankey-link-${this.id}-data`});o.parse([this.getViewData()],{type:"dataview"}),o.transform({type:"sankeyLinks"}),o.transform({type:"addVChartProperty",options:{beforeCall:b3.bind(this),call:b5}},!1),this._linksSeriesData=o}}compileData(){var t,e;super.compileData(),null==(t=this._linkMark)||t.compileData(),null==(e=this._nodeMark)||e.compileData()}initMark(){this._rootMark.setMarkConfig({overflow:this._spec.overflow,interactive:!!this._spec.overflow});let t=this._createMark(IA.mark.node,{isSeriesMark:!0,dataView:this._nodesSeriesData});t&&(t.setMarkConfig({zIndex:this._nodeLayoutZIndex}),this._nodeMark=t);let e=this._createMark(IA.mark.link,{dataView:this._linksSeriesData});e&&(this._linkMark=e)}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToNode=this.valueToNode.bind(this),this._markAttributeContext.valueToLink=this.valueToLink.bind(this)}valueToNode(t){let e=this._nodesSeriesData.latestData,i=(0,a1.IX)(t)[0];return e&&e.find(t=>t.key===i)}valueToLink(t){let e=this._linksSeriesData.latestData,i=(0,a1.IX)(t);return e&&e.find(t=>t&&t.source===i[0]&&t.target===i[1])}valueToPositionX(t){let e=this.valueToNode(t);return null==e?void 0:e.x0}valueToPositionY(t){let e=this.valueToNode(t);return null==e?void 0:e.y0}initMarkStyle(){this._initNodeMarkStyle(),this._initLinkMarkStyle()}_initNodeMarkStyle(){var t,e;let i=this._nodeMark;i&&(this.setMarkStyle(i,{x:t=>t.x0,x1:t=>t.x1,y:t=>t.y0,y1:t=>t.y1},td.STATE_NORMAL,to.Mark),this.setMarkStyle(i,{fill:null!=(e=null==(t=this._spec.node.style)?void 0:t.fill)?e:this._fillByNode},"normal",to.User_Mark))}_initLinkMarkStyle(){var t,e;let i=this._linkMark;i&&(i.setGlyphConfig({direction:this.direction}),this.setMarkStyle(i,{x0:t=>t.x0,x1:t=>t.x1,y0:t=>t.y0,y1:t=>t.y1,thickness:t=>t.thickness},td.STATE_NORMAL,to.Series),this.setMarkStyle(i,{fill:null!=(e=null==(t=this._spec.link.style)?void 0:t.fill)?e:this._fillByLink},"normal",to.User_Mark))}initLabelMarkStyle(t,e){if(!t)return;let i=e.position;i&&i.includes("inside")?this.setMarkStyle(t,{fill:"#ffffff",text:t=>this._createText(t,e),maxLineWidth:t=>{var i;return null!=(i=e.limit)?i:t.x1-t.x0}}):this.setMarkStyle(t,{fill:this._fillByNode,text:t=>this._createText(t,e),maxLineWidth:e.limit}),t.setMarkConfig({zIndex:this._labelLayoutZIndex})}_createText(t,e){if((0,nB.Z)(t)||(0,nB.Z)(t.datum))return"";let i=t.datum[this._spec.categoryField]||"",{formatMethod:r,formatter:n}=e||{},{formatFunc:l,args:s}=bz(r,n,i,t.datum);return l&&(i=l(...s,{series:this})),i}initAnimation(){var t,e,i,r;let n={direction:this.direction,growFrom:()=>{var t,e;return"horizontal"===this.direction?null==(t=this._xAxisHelper)?void 0:t.getScale(0).scale(0):null==(e=this._yAxisHelper)?void 0:e.getScale(0).scale(0)}},l=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._nodeMark&&this._nodeMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("sankeyNode"))?void 0:i(n,l),_s("node",this._spec,this._markAttributeContext))),this._linkMark&&this._linkMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("sankeyLinkPath"))?void 0:r(n,l),_s("link",this._spec,this._markAttributeContext)))}initEvent(){var t,e,i;super.initEvent(),null==(t=this._nodesSeriesData)||t.target.addListener("change",this.nodesSeriesDataUpdate.bind(this)),null==(e=this._linksSeriesData)||e.target.addListener("change",this.linksSeriesDataUpdate.bind(this));let r=null!=(i=this._spec.emphasis)?i:{};if(!0!==this._option.disableTriggerEvent&&r.enable&&("adjacency"===r.effect||"related"===r.effect)){let t="hover"===r.trigger?"pointerover":"pointerdown";this.event.on(t,{level:te.chart},this._handleEmphasisElement)}}nodesSeriesDataUpdate(){this._nodeMark.getData().updateData(),this._nodeList=null,this._setNodeOrdinalColorScale()}linksSeriesDataUpdate(){this._linkMark.getData().updateData()}_highLightElements(t,e){t&&t.length&&t.forEach(t=>{t.removeState([td.STATE_SANKEY_EMPHASIS_REVERSE,td.STATE_SANKEY_EMPHASIS]),e.includes(dM(t).key)?t.addState(td.STATE_SANKEY_EMPHASIS,!0):t.addState(td.STATE_SANKEY_EMPHASIS_REVERSE,!0)})}initTooltip(){this._tooltipHelper=new Ih(this),this._nodeMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodeMark),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark)}_setNodeOrdinalColorScale(){var t,e,i,r,n;let l,s,a=null==(e=null==(t=this._option)?void 0:t.globalScale)?void 0:e.getScale("color");if(null==a?void 0:a._specified)return void(this._colorScale=a);a&&(l=a.domain(),s=a.range()),s||(s=this._getDataScheme()),l&&!(0,nB.Z)(l[0])||(l=this.getNodeList())&&l.length>10&&(s=null==(i=this._getDataScheme()[1])?void 0:i.scheme);let o=new pB;null==(n=(r=o.domain(l)).range)||n.call(r,s),this._colorScale=o}getNodeList(){var t,e;if(this._nodeList)return this._nodeList;let i=this._rawData.latestData[0],r=(null==i?void 0:i.nodes)?(null==(t=i.nodes[0])?void 0:t.children)?Array.from(this.extractNamesFromTree(i.nodes,this._spec.categoryField)):i.nodes.map((t,e)=>t[this._spec.categoryField]):(null==i?void 0:i.links)?Array.from(this.extractNamesFromLink(i.links)):null==(e=null==i?void 0:i.values)?void 0:e.map((t,e)=>t[this._spec.categoryField]);return this._nodeList=r,r}_getNodeNameFromData(t){var e;return(null==t?void 0:t.datum)?t.datum[this._spec.categoryField]:null!=(e=t.key)?e:t[this._spec.categoryField]}extractNamesFromTree(t,e){let i=new Set;return t.forEach(t=>{i.add(t[e]),t.children&&this.extractNamesFromTree(t.children,e).forEach(t=>i.add(t))}),i}extractNamesFromLink(t){let e=new Set,{sourceField:i,targetField:r}=this._spec;return t.forEach(t=>{(0,aw.Z)(t[i])&&e.add(t[i]),(0,aw.Z)(t[r])&&e.add(t[r])}),e}getDimensionField(){return[this._spec.categoryField]}getMeasureField(){return[this._valueField]}getRawDataStatisticsByField(t,e){var i;return this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&(this._viewDataStatistics&&this.getViewData().transformsArr.length<=1&&(null==(i=this._viewDataStatistics.latestData)?void 0:i[t])?this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t]:this._rawData&&(this._rawStatisticsCache[t]={values:this._collectByField(t)})),this._rawStatisticsCache[t]}_collectByField(t){var e,i,r;let n=[],l=null==(i=null==(e=this.getRawData())?void 0:e.latestData)?void 0:i[0];if(!l)return[];if(l.links)(null==(r=l.nodes)?void 0:r.length)&&l.nodes.forEach(t=>{t[this._seriesField]&&n.push(t[this._seriesField])});else if(l.nodes){let t=new Set;return In(t,l.nodes,this._seriesField),Array.from(t)}return n}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this.getViewData().reRunAllTransform()}getDefaultShapeType(){return"square"}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._nodeMark,this._linkMark]}getMarkData(t){return t.datum?(0,rD.Z)(t.datum)?t.datum[t.datum.length-1]:t.datum:t}}IA.type=Y.sankey,IA.transformerConstructor=Iw,IA.mark=Ix,IA.builtInTheme={sankey:{link:{style:{fillOpacity:.15,round:!0}}}};let IM=()=>{Mw(),IC(),kH(),Iy(),vY(),h9.registerSeries(IA.type,IA)};class IT extends Ai{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","sourceField","targetField","direction","nodeAlign","crossNodeAlign","nodeGap","nodeWidth","linkWidth","minStepWidth","minNodeHeight","maxNodeHeight","minLinkHeight","maxLinkHeight","dropIsolatedNode","nodeHeight","linkHeight","equalNodeHeight","linkOverlap","iterations","nodeKey","linkSortBy","nodeSortBy","setNodeLayer","node","link","emphasis","inverse","overflow"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}var Ik=i(51996);function IR(){return"browser"===hd.env?["pointerup","pointerleave","pointercancel"]:["pointerup","pointerleave","pointerupoutside"]}let IP={debounce:dS.Z,throttle:dw.Z};uD(),c7();class IB extends CB{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},IB.defaultAttributes,t)),this.name="scrollbar",this._handleTouchMove=t=>{(0,aw.Z)(this._prePos)&&t.preventDefault()},this._onRailPointerDown=t=>{let e,{viewX:i,viewY:r}=t,{direction:n,width:l,height:s,range:a}=this.attribute,o=this._sliderSize,[h,d]=this._getScrollRange();if("vertical"===n){let t=r-this._viewPosition.y,i=(0,yj.Z)(t-o/2,h,d);e=t/s,this._slider.setAttribute("y",i,!0)}else{let t=i-this._viewPosition.x,r=(0,yj.Z)(t-o/2,h,d);e=t/l,this._slider.setAttribute("x",r,!0)}this.setScrollRange([e-(a[1]-a[0])/2,e+(a[1]-a[0])/2],!1),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()},this._onSliderPointerDown=t=>{this._clearDragEvents();let{stopSliderDownPropagation:e=!0}=this.attribute;e&&t.stopPropagation();let{direction:i}=this.attribute,{x:r,y:n}=this.stage.eventPointTransform(t);this._prePos="horizontal"===i?r:n,this._dispatchEvent("scrollDown",{pos:this._prePos,event:t});let l=IR(),s="browser"===hd.env?hd:this.stage;s.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),l.forEach(t=>{s.addEventListener(t,this._onSliderPointerUp)})},this._computeScrollValue=t=>{let{direction:e}=this.attribute,{x:i,y:r}=this.stage.eventPointTransform(t),n,l,s=0,{width:a,height:o}=this.getSliderRenderBounds();return n="vertical"===e?((l=r)-this._prePos)/o:((l=i)-this._prePos)/a,[l,n]},this._onSliderPointerMove=t=>{let{stopSliderMovePropagation:e=!0}=this.attribute;e&&t.stopPropagation();let i=this.getScrollRange(),[r,n]=this._computeScrollValue(t);this.setScrollRange([i[0]+n,i[1]+n],!0),this._prePos=r},this._onSliderPointerMoveWithDelay=0===this.attribute.delayTime?this._onSliderPointerMove:IP[this.attribute.delayType](this._onSliderPointerMove,this.attribute.delayTime),this._onSliderPointerUp=t=>{let{range:e,limitRange:i=[0,1]}=this.attribute,r=this.getScrollRange(),[n,l]=this._computeScrollValue(t),s=[r[0]+l,r[1]+l];this._prePos=null,this._dispatchEvent("scrollUp",{pre:e,value:(0,Ik.Z)(s,i[0],i[1])}),this._clearDragEvents()}}setScrollRange(t,e=!0){let{direction:i="horizontal",limitRange:r=[0,1],range:n,realTime:l=!0}=this.attribute,s=(0,Ik.Z)(t,r[0],r[1]);if(e){let t=this._getSliderPos(s);if(this._slider){let e=t[1]-t[0];this._sliderSize=e,"horizontal"===i?this._slider.setAttributes({x:t[0],width:e},!0):this._slider.setAttributes({y:t[0],height:e},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=s,l&&this._dispatchEvent(gJ,{pre:n,value:s})}getScrollRange(){return this.attribute.range}bindEvents(){if(this.attribute.disableTriggerEvent)return;let{delayType:t="throttle",delayTime:e=0}=this.attribute;this._rail&&this._rail.addEventListener("pointerdown",IP[t](this._onRailPointerDown,e)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown),("browser"===hd.env?hd:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}render(){let t;this._reset();let{direction:e="horizontal",width:i,height:r,range:n,limitRange:l=[0,1],railStyle:s,sliderStyle:a,padding:o=2}=this.attribute,h=this.createOrUpdateChild("scrollbar-container",{},"group"),d=h.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:i,height:r},s),"rect");this._rail=d;let u=this.getSliderRenderBounds(),c=this._getSliderPos((0,Ik.Z)(n,l[0],l[1])),p=c[1]-c[0];this._sliderSize=p,t="horizontal"===e?{x:c[0],y:u.y1,width:p,height:u.height}:{x:u.x1,y:c[0],width:u.width,height:p};let g=h.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},t),{cornerRadius:this._getDefaultSliderCornerRadius()}),a),{boundsPadding:(0,wj.o)(o),pickMode:"imprecise"}),"rect");this._slider=g,this._container=h;let f=this._container.AABBBounds;this._viewPosition={x:f.x1,y:f.y1}}getSliderRenderBounds(){if(this._sliderRenderBounds)return this._sliderRenderBounds;let{width:t,height:e,padding:i=2}=this.attribute,[r,n,l,s]=(0,wj.o)(i),a={x1:s,y1:r,x2:t-n,y2:e-l,width:Math.max(0,t-(s+n)),height:Math.max(0,e-(r+l))};return this._sliderRenderBounds=a,a}_getDefaultSliderCornerRadius(){let{direction:t,round:e}=this.attribute;if(e){let{width:e,height:i}=this.getSliderRenderBounds();return"horizontal"===t?i:e}return 0}_getSliderPos(t){let{direction:e}=this.attribute,{width:i,height:r,x1:n,y1:l}=this.getSliderRenderBounds();return"horizontal"===e?[i*t[0]+n,i*t[1]+n]:[r*t[0]+l,r*t[1]+l]}_getScrollRange(){if(this._sliderLimitRange)return this._sliderLimitRange;let{limitRange:t=[0,1],direction:e}=this.attribute,[i,r]=(0,Ik.Z)(t,0,1),{width:n,height:l,x1:s,y1:a}=this.getSliderRenderBounds(),o=this._sliderSize;return"horizontal"===e?(0,Ik.Z)([s+i*n,s+r*n],s,n-o):(0,Ik.Z)([a+i*l,a+r*l],a,l-o)}_clearDragEvents(){let t=IR(),e="browser"===hd.env?hd:this.stage;e.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),t.forEach(t=>{e.removeEventListener(t,this._onSliderPointerUp)})}_reset(){this._sliderRenderBounds=null,this._sliderLimitRange=null}release(t){super.release(t),("browser"===hd.env?hd:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}IB.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};let II=t4=class{constructor(){this.name="scrollbar",this.activeEvent="onRegister",this._uid=eJ.GenAutoIncrementId(),this.key=this.name+this._uid,this.scroll=t=>{var e,i;let r=t.target,n=this.getScrollContainer(r);if(!n&&!this.scrollContainer)return;if(!n&&this.scrollContainer){if(!this.scrollContainer.g.stage||this.scrollContainer.g.stage!==r.stage)return;let t=this.formatScrollContainer(this.scrollContainer.g);if(!t)return void this.clearScrollbar(this.scrollContainer.g,"all");this.scrollContainer.showH&&!t.showH&&this.clearScrollbar(this.scrollContainer.g,"horizontal"),this.scrollContainer.showV&&!t.showV&&this.clearScrollbar(this.scrollContainer.g,"vertical"),this.scrollContainer=t}else n&&this.scrollContainer&&n.g!==this.scrollContainer.g&&this.clearScrollbar(this.scrollContainer.g,"all");if(this.scrollContainer=null!=n?n:this.scrollContainer,!n)return;let l=n.g;if(!l)return;let{width:s,height:a,scrollX:o=0,scrollY:h=0}=l.attribute,d=o,u=h,{showH:c,showV:p}=n;this.scrollContainerBounds=(new iI.YZ).set(0,0,l.attribute.width,l.attribute.height),c&&c&&((0,ik.Wn)(t.deltaX)>(0,ik.Wn)(t.deltaY)?(c=c&&!0,p=p&&!1):(c=c&&!1,p=p&&!0));let g=this.childrenBounds.width(),f=this.childrenBounds.height();c&&((d=o-(null!=(e=t.deltaX)?e:0))>0?d=0:d<s-g&&(d=s-g)),p&&((u=h-(null!=(i=t.deltaY)?i:0))>0?u=0:u<a-f&&(u=a-f)),l.setAttributes({scrollX:d,scrollY:u}),this.addOrUpdateScroll(c,p,l.parent,l)},this.handleScrollBarChange=t=>{if(!(this.scrollContainer&&this.scrollContainerBounds&&this.childrenBounds&&t&&t.target&&t.detail&&t.detail.value))return;let e=t.target,i=t.detail.value;if("horizontal"===e.attribute.direction){let t=this.childrenBounds.width();this.scrollContainer.g.setAttributes({scrollX:-i[0]*t})}else{let t=this.childrenBounds.height();this.scrollContainer.g.setAttributes({scrollY:-i[0]*t})}}}activate(t){this.pluginService=t;let{stage:e}=this.pluginService;this.childrenBounds=new iI.FB,e.addEventListener("wheel",this.scroll),this.params=t4.defaultParams}initEventOfScrollbar(t,e,i){t.addEventListener("pointerover",()=>{e.setAttribute("visibleAll",!0)}),t.addEventListener("pointermove",()=>{e.setAttribute("visibleAll",!0)}),t.addEventListener("pointerout",()=>{e.setAttribute("visibleAll",!1)}),e.addEventListener("pointerover",()=>{e.setAttribute("visibleAll",!0)}),e.addEventListener("pointerout",()=>{e.setAttribute("visibleAll",!0)}),e.addEventListener("scrollUp",this.handleScrollBarChange),e.addEventListener(gJ,this.handleScrollBarChange)}addOrUpdateScroll(t,e,i,r){if(t){let{scrollBar:t,isUpdate:e}=this.addOrUpdateHScroll(r,i,!0);e||this.initEventOfScrollbar(r,t,!0)}else this.clearScrollbar(r,"horizontal");if(e){let{scrollBar:t,isUpdate:e}=this.addOrUpdateHScroll(r,i,!1);e||this.initEventOfScrollbar(r,t,!1)}else this.clearScrollbar(r,"vertical")}getDirection(t){return t?"horizontal":"vertical"}addOrUpdateHScroll(t,e,i){var r,n;let l=this.getDirection(i),s=`${null!=(r=t.name)?r:t._uid}_${this.getDirection(i)}_${this.name}`,a=e.children.filter(t=>t.name===s),o=!0,h=a[0],{y:d=0,dy:u=0,x:c=0,dx:p=0,height:g,width:f,zIndex:m=0}=this.scrollContainer.g.attribute,y={x:0,y:0,direction:l,zIndex:m+1,visibleAll:!0,padding:[2,0],railStyle:{fill:"rgba(0, 0, 0, .1)"},range:[0,.05]};i?(y.width=this.scrollContainerBounds.width(),y.height=12):(y.height=this.scrollContainerBounds.height(),y.width=12),h?a.length>1&&a.forEach((t,e)=>{var i;e&&(null==(i=t.parent)||i.removeChild(t))}):(o=!1,(h=new IB(y)).name=s,e.add(h),h.isScrollBar=!0);let v=this.childrenBounds,{scrollX:b,scrollY:_}=t.attribute;if(i){let t=Math.min(this.scrollContainerBounds.width()/v.width(),1),e=Math.max(Math.min(b/this.childrenBounds.width(),0),t-1);y.x=c+p,y.y=d+u+g-(null!=(n=y.height)?n:0),y.range=[-e,-e+t]}else{let t=Math.min(this.scrollContainerBounds.height()/v.height(),1),e=Math.max(Math.min(_/this.childrenBounds.height(),0),t-1);y.x=c+p+f-this.scrollContainerBounds.width(),y.y=d+u,y.range=[-e,-e+t]}return h.setAttributes(y),{scrollBar:h,isUpdate:o}}clearScrollbar(t,e){t.parent&&t.parent.children.filter(t=>t.isScrollBar&&("all"===e||t.attribute.direction===e)).forEach(t=>{t.parent.removeChild(t)})}formatScrollContainer(t){if(!t||"group"!==t.type||!t.attribute)return null;let{overflow:e,width:i,height:r}=t.attribute;if(!e||"hidden"===e)return null;let n=!1,l=!1;"scroll"===e?(n=!0,l=!0):l=!(n="scroll-x"===e);let s=this.childrenBounds;return s.clear(),t.forEachChildren(t=>{s.union(t.AABBBounds)}),t.AABBBounds.empty()||(n&&(n=i<s.width()),l&&(l=r<s.height())),n||l?{g:t,showH:n,showV:l}:null}getScrollContainer(t){let e=t;for(;e;){let t=this.formatScrollContainer(e);if(t)return t;e=e.parent}return null}deactivate(t){let{stage:e}=this.pluginService;e.removeEventListener("wheel",this.scroll)}};II.defaultParams={timeout:500},II=t4=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],II);let IE=new eQ((t,e,i,r)=>{i(II)||(t(II).toSelf(),t(aP).toService(II))});class IL extends Ah{constructor(){super(...arguments),this.transformerConstructor=IT,this.type="sankey",this.seriesType=Y.sankey}_setStateInDatum(t,e,i,r){let n=(0,rD.Z)(e)?e[0]:e;if(!n)return void this._interaction.clearByState(t);let l=null;this.filterGraphicsByDatum(n,{filter:(t,e)=>"text"!==e.type&&e.getProduct()&&(!i||i(t,e)),region:r,getDatum:t=>{var e;let i=null==(e=dM(t))?void 0:e.datum;return(0,rD.Z)(i)&&(i=i[0]),i},callback:(t,e,i,r)=>{var n;let l=e.getProductId();l&&(l.includes("node")||l.includes("link"))&&(null==(n=i._handleEmphasisElement)||n.call(i,{item:t,mark:e}))},regionCallback:(t,e)=>{n&&t.length&&(l=t[0])}}),l&&this._interaction.updateStateOfGraphics(t,[l])}}IL.type="sankey",IL.seriesType=Y.sankey,IL.transformerConstructor=IT;let IF=()=>{A$(),ib.load(IE),IM(),h9.registerChart(IL.type,IL)};class IO extends bY{constructor(){super(...arguments),this._getMeasureData=t=>"horizontal"===this.series.getSpec().direction?t[this.series.getSpec().xField[0]]+"-"+t[this.series.getSpec().xField[1]]:t[this.series.getSpec().yField[0]]+"-"+t[this.series.getSpec().yField[1]]}}let IH=Object.assign({},Mn);class ID extends Ma{constructor(){super(...arguments),this.type=Y.rangeArea}initMark(){this._areaMark=this._createMark(ID.mark.area,{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0]})}initMarkStyle(){this.initAreaMarkStyle()}initAreaMarkStyle(){let t=this._areaMark;t&&(super.initAreaMarkStyle(),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x1:t=>{if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})}},"normal",to.Series):this.setMarkStyle(this._areaMark,{y1:t=>{if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})}},"normal",to.Series),this.setMarkStyle(t,{stroke:!1},"normal",to.Series))}initTooltip(){this._tooltipHelper=new IO(this)}_isFieldAllValid(){let t=this.getViewDataStatistics(),e=this.fieldY;return!!(t&&t.latestData&&e.length)&&e.every(e=>t.latestData[e]&&t.latestData[e].allValid)}}ID.type=Y.rangeArea,ID.mark=IH;let Iz=()=>{Mi(),SI(),SX(),h9.registerSeries(ID.type,ID)};class IW extends Ar{_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t);return r.area=t.area,r.point=t.point,r.line=t.line,"horizontal"===t.direction?r.xField=null!=(e=t.xField)?e:[t.minField,t.maxField]:r.yField=null!=(i=t.yField)?i:[t.minField,t.maxField],r.stack=!1,r}transformSpec(t){super.transformSpec(t),c8(t)}}class IZ extends Ah{constructor(){super(...arguments),this.transformerConstructor=IW,this.type="rangeArea",this.seriesType=Y.rangeArea}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}IZ.type="rangeArea",IZ.seriesType=Y.rangeArea,IZ.transformerConstructor=IW;let IN=()=>{AX(),A$(),AJ(),AM(),Af(),Iz(),h9.registerChart(IZ.type,IZ)};class Ij extends gW{constructor(){super(...arguments),this.type=Ij.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{fill:void 0,lineWidth:0,padding:0})}_createGraphic(t={}){return oI(t)}_transformGraphicAttributes(t,e,i){var r,n,l;let s=super._transformGraphicAttributes(t,e,i),a=null!=(n=null!=(r=s.shape)?r:s.symbolType)?n:null==(l=t.attribute)?void 0:l.symbolType;return(0,nB.Z)(a)?s.symbolType="rect":s.symbolType=a,s}}Ij.type="cell";let IG=()=>{h9.registerMark(Ij.type,Ij),h9.registerGraphicComponent("symbol",oI),gG(),cH(),Cj()},IV=()=>{h9.registerAnimation("heatmap",(t,e)=>Object.assign(Object.assign({},vK),{appear:!1===e?{}:{type:"fadeIn"}}))};class IU extends bY{enableByType(t){return"dimension"!==t}}let IK=Object.assign(Object.assign({},b7),{cell:{name:"cell",type:"cell"},cellBackground:{name:"cellBackground",type:"cell"}});class IX extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"cell")}}class IY extends _y{constructor(){super(...arguments),this.type=Y.heatmap,this.transformerConstructor=IX}getFieldValue(){return this._fieldValue}setFieldValue(t){this._fieldValue=(0,a1.IX)(t)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFieldValue(this._spec.valueField)}initMark(){this._cellMark=this._createMark(IY.mark.cell,{isSeriesMark:!0},{morph:_h(this._spec,IY.mark.cell.name),morphElementKey:this.getDimensionField()[0]}),this._backgroundMark=this._createMark(IY.mark.cellBackground)}initMarkStyle(){this.initCellMarkStyle(),this.initCellBackgroundMarkStyle()}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getMeasureField()[0]]})}initCellMarkStyle(){this.setMarkStyle(this._cellMark,{x:t=>this.dataToPositionX(t),y:t=>this.dataToPositionY(t),size:()=>[this.getCellSize(this._xAxisHelper),this.getCellSize(this._yAxisHelper)],fill:this.getColorAttribute()},"normal",to.Series)}initCellBackgroundMarkStyle(){var t,e,i;let r=(0,wj.o)(null!=(i=null==(e=null==(t=this._spec.cellBackground)?void 0:t.style)?void 0:e.padding)?i:0);this.setMarkStyle(this._backgroundMark,{x:t=>{let e=this.getCellSize(this._xAxisHelper);return this.dataToPositionX(t)-e/2+r[3]},y:t=>{let e=this.getCellSize(this._yAxisHelper);return this.dataToPositionY(t)-e/2+r[0]},width:()=>this.getCellSize(this._xAxisHelper)-r[1]-r[3],height:()=>this.getCellSize(this._yAxisHelper)-r[0]-r[2]},"normal",to.Series)}getColorAttribute(){var t;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:this.getFieldValue()[0]}}getInteractionTriggers(){return this._parseInteractionConfig(this._cellMark?[this._cellMark]:[])}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset,n=_m(this);this._cellMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("heatmap"))?void 0:i(r),_s("cell",this._spec,this._markAttributeContext),n))}getCellSize(t){var e,i;return null!=(i=null==(e=t.getBandwidth)?void 0:e.call(t,0))?i:6}initTooltip(){this._tooltipHelper=new IU(this),this._cellMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._cellMark)}getDefaultShapeType(){return"rect"}getDimensionField(){return[].concat(this.fieldX,this.fieldY)}getMeasureField(){return this.getFieldValue()}getActiveMarks(){return[this._cellMark]}}IY.type=Y.heatmap,IY.mark=IK,IY.builtInTheme={heatmap:{cell:{style:{shape:"rect",fillOpacity:1}},cellBackground:{visible:!1}}},IY.transformerConstructor=IX;let I$=()=>{kH(),IG(),IV(),SI(),SX(),h9.registerSeries(IY.type,IY)};class Iq extends Ar{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["valueField","cell"])}}class IJ extends Ah{constructor(){super(...arguments),this.transformerConstructor=Iq,this.type="heatmap",this.seriesType=Y.heatmap}}IJ.type="heatmap",IJ.seriesType=Y.heatmap,IJ.transformerConstructor=Iq;let IQ=()=>{A$(),I$(),h9.registerChart(IJ.type,IJ)},I0=Object.assign(Object.assign({},b7),{nodePoint:{name:"nodePoint",type:"symbol"},ripplePoint:{name:"ripplePoint",type:"ripple"},centerPoint:{name:"centerPoint",type:"symbol"},centerLabel:{name:"centerLabel",type:"text"}});var I1=i(22197),I2=i(4988),I3=i(93690);let I5=`${d9}_CORRELATION_X`,I4=`${d9}_CORRELATION_Y`,I6=`${d9}_CORRELATION_SIZE`,I7=(t,e)=>{var i,r,n,l,s,a,o,h,d,u,c,p,g,f,m;if(!t||!(null==e?void 0:e.view)||!(0,rD.Z)(t))return t;let y=e.view();if(y.x1-y.x0==0||y.y1-y.y0==0||y.x1-y.x0==-1/0||y.x1-y.x0==1/0||y.y1-y.y0==-1/0||y.y1-y.y0==1/0)return t;let v=(0,iH.M4)(null!=(i=e.startAngle)?i:-90),b=(0,iH.M4)(null!=(r=e.endAngle)?r:270),_=Math.max((y.x1-y.x0)/2,(y.y1-y.y0)/2),C=(0,I1.y)(null!=(n=e.innerRadius)?n:0,_),x=(0,I1.y)(e.outerRadius,_),w=[(0,n4.Z)(null==(l=e.center)?void 0:l[0])?e.center[0]:y.x0+(0,I1.y)(null!=(a=null==(s=e.center)?void 0:s[0])?a:"50%",y.x1-y.x0),(0,n4.Z)(null==(o=e.center)?void 0:o[1])?e.center[1]:y.y0+(0,I1.y)(null!=(d=null==(h=e.center)?void 0:h[1])?d:"50%",y.y1-y.y0)],S=(0,I2.EP)(e.field),A=t.map(S),[M,T]=(0,I3.W)(A),k=M===T?t=>(C+x)/2:t=>C+(x-C)*(t-M)/(T-M),R=(0,nB.Z)(e.radiusField)?S:(0,I2.EP)(e.radiusField),P=null!=(c=null==(u=null==e?void 0:e.radiusRange)?void 0:u[1])?c:5,B=t=>P;if(R){let[i,r]=R!==S?(0,I3.W)(t.map(R)):[M,T],n=null!=(g=null==(p=e.radiusRange)?void 0:p[0])?g:5,l=null!=(m=null==(f=e.radiusRange)?void 0:f[1])?m:5;i!==r&&(B=t=>n+(l-n)*(R(t)-i)/(r-i))}let I=Math.min(v,b),E=Math.max(v,b),L=I8(I,E,t.length),F=[],O=(E-I)/60;return t.forEach((t,e)=>{let i=k(A[e]),r=B(t),n,l,s=L[e];for(let t=0;t<60&&(I9({x:n=w[0]+i*Math.cos(s),y:l=w[1]+i*Math.sin(s),size:r},F)||n-r<y.x0||n+r>y.x1||l-r<y.y0||l+r>y.y1);t++)t<59&&((s+=O)>E?s=I:s<I&&(s=E));F.push(Object.assign({[I5]:n,[I4]:l,[I6]:r},t))}),F},I8=(t,e,i)=>{let r=0,n=Math.max(Math.ceil(2*(e-t)/Math.PI),2),l=(e-t)/n,s=0,a=1,o=0,h=0,d=[],u=t;for(;o<i;)h<n&&(d.push(u+(h%2?Math.floor(h/2)+Math.floor(n/2):h/2)*l*a),h++),o++,h===n&&(h=0,s+=1,a*=-1,0===r?r=l/2:r/=2,u=-1===a?e-r:t+r,s>=2&&(l/=2,n*=2));return d},I9=(t,e)=>!(!e||!e.length)&&e.some(e=>Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<Math.pow(t.size+e.size,2)),Et=(t,e)=>{if(!t||!(0,rD.Z)(t))return[];let{keyword:i,categoryField:r}=e,n=t[0].latestData[0];return{[r]:i,[ur]:null==n?void 0:n[ur],[ul]:null==n?void 0:n[ul]}};class Ee extends Bj{constructor(){super(...arguments),this.type=Ee.type,this._subMarks={ripple0:{type:"symbol",defaultAttributes:{fillOpacity:.75}},ripple1:{type:"symbol",defaultAttributes:{fillOpacity:.5}},ripple2:{type:"symbol",defaultAttributes:{fillOpacity:.25}}},this._positionChannels=["ripple","size"],this._positionEncoder=(t,e,i)=>{let{ripple:r=i.attribute.ripple,size:n=i.attribute.size}=t,l=(0,yj.Z)(r,0,1),s=.5*n;return{ripple0:{size:n+s*l,fillOpacity:.75-.25*l},ripple1:{size:n+s*(1+l),fillOpacity:.5-.25*l},ripple2:{size:n+s*(2+l),fillOpacity:.25-.25*l}}}}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,ripple:0})}}Ee.type="ripple";let Ei=()=>{BG(),cH(),h9.registerMark(Ee.type,Ee),h9.registerGraphicComponent("symbol",t=>oI(t))},Er=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"},En=()=>{h9.registerAnimation("correlation",(t,e)=>Object.assign({appear:Er(0,e)},vU))};class El extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"nodePoint"),this._addMarkLabelSpec(t,"centerPoint","centerLabel")}}class Es extends Tl{constructor(){super(...arguments),this.type=Y.correlation,this.transformerConstructor=El,this._viewBox=new iI.YZ}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}getSeriesField(){return this._seriesField}setSeriesField(t){(0,aw.Z)(t)&&(this._seriesField=t)}getSizeField(){return this._sizeField}setSizeField(t){(0,aw.Z)(t)&&(this._sizeField=t)}getSizeRange(){return this._sizeRange}setSizeRange(t){(0,aw.Z)(t)&&(this._sizeRange=t)}setAttrFromSpec(){super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(this._spec.seriesField),this.setSizeField(this._spec.sizeField),this.setSizeRange(this._spec.sizeRange)}initData(){var t,e,i;if(super.initData(),!this._data)return;dL(this._dataSet,"correlation",I7);let r=new eY.q;dF(r,"dataview",e$.i),dL(r,"correlationCenter",Et);let n=new eq.V(r,{name:`${this.type}_${this.id}_center`});n.parse([this.getViewData()],{type:"dataview"}),n.transform({type:"correlationCenter",options:{keyword:null!=(i=null==(e=null==(t=this._spec.centerLabel)?void 0:t.style)?void 0:e.text)?i:"",categoryField:this._spec.categoryField}}),this._centerSeriesData=new pV(this._option,n)}compileData(){var t;super.compileData(),null==(t=this._centerSeriesData)||t.compile()}_statisticViewData(){super._statisticViewData(),this._data.getDataView().transform({type:"correlation",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),field:this._spec.valueField,radiusRange:this._spec.sizeRange,radiusField:this._spec.sizeField,center:[this._spec.centerX,this._spec.centerY],innerRadius:this._spec.innerRadius,outerRadius:this._spec.outerRadius,startAngle:this._spec.startAngle,endAngle:this._spec.endAngle}})}initMark(){let t=this._createMark(Es.mark.nodePoint,{groupKey:this._seriesField,isSeriesMark:!0,key:ur});t&&(t.setMarkConfig({zIndex:ts.Node}),this._nodePointMark=t);let e=this._createMark(Es.mark.ripplePoint,{key:ur,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});e&&(this._ripplePointMark=e);let i=this._createMark(Es.mark.centerPoint,{key:ur,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});i&&(i.setMarkConfig({zIndex:ts.Node}),this._centerPointMark=i)}initMarkStyle(){this._initNodePointMarkStyle(),this._initRipplePointMarkStyle(),this._initCenterPointMarkStyle()}_initNodePointMarkStyle(){var t,e,i,r;let n=this._nodePointMark;if(!n)return;let l=null!=(e=null==(t=this._spec.nodePoint)?void 0:t.style)?e:{};this.setMarkStyle(n,{x:t=>t[I5],y:t=>t[I4],size:t=>t[I6],fill:null!=(i=l.fill)?i:this.getColorAttribute(),fillOpacity:null!=(r=l.fillOpacity)?r:1,lineWidth:0},td.STATE_NORMAL,to.Series)}_initRipplePointMarkStyle(){var t,e,i,r,n;let l=this._ripplePointMark;if(!l)return;let s=null!=(e=null==(t=this._spec.ripplePoint)?void 0:t.style)?e:{};this.setMarkStyle(l,{x:()=>{var t;return null!=(t=this._spec.centerX)?t:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var t;return null!=(t=this._spec.centerY)?t:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:null!=(i=s.fill)?i:this.getColorAttribute(),opacity:null!=(r=s.fillOpacity)?r:.2,ripple:null!=(n=s.ripple)?n:0},td.STATE_NORMAL,to.Series)}_initCenterPointMarkStyle(){var t,e,i,r,n,l;let s=this._centerPointMark;s&&this.setMarkStyle(s,{x:()=>{var t;return null!=(t=this._spec.centerX)?t:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var t;return null!=(t=this._spec.centerY)?t:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>.2*Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:null!=(i=null==(e=null==(t=this._spec.centerPoint)?void 0:t.style)?void 0:e.fill)?i:this.getColorAttribute(),fillOpacity:null!=(l=null==(n=null==(r=this._spec.centerPoint)?void 0:r.style)?void 0:n.fillOpacity)?l:1},td.STATE_NORMAL,to.Series)}initTooltip(){super.initTooltip(),this._nodePointMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodePointMark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this._categoryField],z:this.dataToPositionZ.bind(this)},td.STATE_NORMAL,to.Series)}initAnimation(){var t,e;let i=null==(t=this._spec.animationAppear)?void 0:t.preset;this._nodePointMark.setAnimationConfig(_l(null==(e=h9.getAnimationInKey("correlation"))?void 0:e({},i),_s("nodePoint",this._spec,this._markAttributeContext)))}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}getActiveMarks(){return[this._nodePointMark,this._centerPointMark]}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this._rawData.reRunAllTransform(),this.getViewData().reRunAllTransform()}}Es.type=Y.correlation,Es.mark=I0,Es.builtInTheme={correlation:{centerLabel:{visible:!0,position:"center",style:{fill:"#fff",text:""}},label:{visible:!0,position:"bottom",style:{fill:"#000"}}}},Es.transformerConstructor=El;let Ea=()=>{CK(),Ei(),h9.registerSeries(Es.type,Es),En()};class Eo extends Ai{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","sizeField","sizeRange","centerX","centerY","innerRadius","outerRadius","startAngle","endAngle","ripplePoint","centerPoint","centerLabel","nodePoint"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class Eh extends Ah{constructor(){super(...arguments),this.transformerConstructor=Eo,this.type="correlation",this.seriesType=Y.correlation}}Eh.type="correlation",Eh.seriesType=Y.correlation,Eh.transformerConstructor=Eo;let Ed=()=>{A$(),Ea(),h9.registerChart(Eh.type,Eh)};class Eu extends SK{constructor(){super(...arguments),this.type=oQ.cartesianTimeAxis,this._zero=!1,this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),C$(this._regions,t=>{CQ(this.getOrient())?xC(t.getXAxisHelper(),this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&t.setXAxisHelper(this.axisHelper()):xC(t.getYAxisHelper(),this.axisHelper(),(0,aw.Z)(this._seriesUserId)||(0,aw.Z)(this._seriesIndex))&&t.setYAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._tick=h5({},this._spec.tick,null==(t=this._spec.layers)?void 0:t[0])}_initData(){var t;if(super._initData(),null==(t=this._spec.layers)?void 0:t[1]){let t=new eq.V(this._option.dataSet,{name:`${this.type}_${this.id}_layer_1_ticks`}).parse(this._scale,{type:"scale"}).transform({type:`${this.type}-ticks`,options:Object.assign(Object.assign({},this._tickTransformOption()),{tickCount:this._spec.layers[1].tickCount,forceTickCount:this._spec.layers[1].forceTickCount,tickStep:this._spec.layers[1].tickStep})},!1);this._layerTickData=new pV(this._option,t)}}computeData(t){super.computeData(t),this._layerTickData&&(this._layerTickData.getDataView().reRunAllTransform(),this._layerTickData.updateData())}created(){super.created(),this._layerTickData&&(this._axisMark&&this._layerTickData.addRelatedMark(this._axisMark),this._gridMark&&this._layerTickData.addRelatedMark(this._gridMark))}_getLabelFormatMethod(){var t,e,i,r,n,l,s,a;let o=bH.k.getInstance(),h=(null==(e=null==(t=this._spec.layers)?void 0:t[1])?void 0:e.timeFormat)||"%Y%m%d",d="local"===((null==(r=null==(i=this._spec.layers)?void 0:i[1])?void 0:r.timeFormatMode)||"local")?o.timeFormat:o.timeUTCFormat,u=(null==(l=null==(n=this._spec.layers)?void 0:n[0])?void 0:l.timeFormat)||"%Y%m%d",c="local"===((null==(a=null==(s=this._spec.layers)?void 0:s[0])?void 0:a.timeFormatMode)||"local")?o.timeFormat:o.timeUTCFormat;return(t,e,i,r,n)=>{var l;let s;return s=0===n?c(u,t):d(h,t),(null==(l=this._spec.label)?void 0:l.formatMethod)?this._spec.label.formatMethod(s,e):s}}getLabelItems(t){var e,i;let r=[],n=null==(e=this.getTickData())?void 0:e.getLatestData();n&&n.length&&r.push(n.map(e=>x_(e.value,this._getNormalizedValue([e.value],t))));let l=null==(i=this._layerTickData)?void 0:i.getLatestData();return l&&l.length&&r.push(l.map(e=>x_(e.value,this._getNormalizedValue([e.value],t)))),r}registerTicksTransform(){let t=`${this.type}-ticks`;return dL(this._option.dataSet,t,SG),t}transformScaleDomain(){}}Eu.type=oQ.cartesianTimeAxis,Eu.specKey="axes",Eu.builtInTheme={axis:Sk,axisX:SR,axisY:SP};let Ec=()=>{h9.registerGraphicComponent(tJ.lineAxis,(t,e)=>new SM(t,e)),h9.registerGraphicComponent(tQ.lineAxisGrid,(t,e)=>new wN(t,e)),xY(),h9.registerComponent(Eu.type,Eu)};var Ep=i(65880);class Eg extends SK{constructor(){super(...arguments),this.type=oQ.cartesianLogAxis,this._zero=!1,this._scale=new Ep.Y}initScales(){var t;super.initScales(),this._scale.base(null!=(t=this._spec.base)?t:10),this._scale.clamp(!0,null,!1)}registerTicksTransform(){let t=`${this.type}-ticks`;return dL(this._option.dataSet,t,SG),t}transformScaleDomain(){}}Eg.type=oQ.cartesianLogAxis,Eg.specKey="axes",Eg.builtInTheme={axis:Sk,axisLinear:SU,axisX:SR,axisY:SP},(0,yf.jB)(Eg,SZ);let Ef=()=>{h9.registerGraphicComponent(tJ.lineAxis,(t,e)=>new SM(t,e)),h9.registerGraphicComponent(tQ.lineAxisGrid,(t,e)=>new wN(t,e)),xY(),h9.registerComponent(Eg.type,Eg)};var Em=i(1466);class Ey extends SK{constructor(){super(...arguments),this.type=oQ.cartesianSymlogAxis,this._zero=!1,this._scale=new Em.g}initScales(){var t;super.initScales(),this._scale.constant(null!=(t=this._spec.constant)?t:10)}registerTicksTransform(){let t=`${this.type}-ticks`;return dL(this._option.dataSet,t,SG),t}transformScaleDomain(){}}Ey.type=oQ.cartesianSymlogAxis,Ey.specKey="axes",Ey.builtInTheme={axis:Sk,axisLinear:SU,axisX:SR,axisY:SP},(0,yf.jB)(Ey,SZ);let Ev=()=>{h9.registerGraphicComponent(tJ.lineAxis,(t,e)=>new SM(t,e)),h9.registerGraphicComponent(tQ.lineAxisGrid,(t,e)=>new wN(t,e)),xY(),h9.registerComponent(Ey.type,Ey)};function Eb(t){var e,i;let r=Object.assign({},t);return(0,uF.Z)(t.style)||(r.textStyle=xg(t.style)),(0,uF.Z)(t.textStyle)||h5(r.textStyle,xg(t.textStyle)),(null==(e=t.shape)?void 0:e.style)&&xg(r.shape.style),(null==(i=t.background)?void 0:i.style)&&xg(r.background.style),r}var E_=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};(t6=eA||(eA={})).selected="selected",t6.unSelected="unSelected",t6.selectedHover="selectedHover",t6.unSelectedHover="unSelectedHover",t6.focus="focus",(t7=eM||(eM={})).legendItemHover="legendItemHover",t7.legendItemUnHover="legendItemUnHover",t7.legendItemClick="legendItemClick",t7.legendItemAttributeUpdate="legendItemAttributeUpdate",(t8=eT||(eT={})).innerView="innerView",t8.title="legendTitle",t8.item="legendItem",t8.itemShape="legendItemShape",t8.itemLabel="legendItemLabel",t8.itemValue="legendItemValue",t8.focus="legendItemFocus";class EC extends CB{constructor(){super(...arguments),this.name="legend",this._title=null}render(){this.removeAllChild(!0);let{interactive:t=!0,title:e,padding:i=0}=this.attribute;this._parsedPadding=(0,wj.o)(i);let r=ak.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:t,childrenPickable:t});r.name=eT.innerView,this.add(r),this._innerView=r,(null==e?void 0:e.visible)&&this._renderTitle(e),this._renderContent(),this._adjustLayout(),t&&this._bindEvents();let n=this._innerView.AABBBounds;this.attribute.width=n.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=n.height()+this._parsedPadding[0]+this._parsedPadding[2]}_renderTitle(t){let{text:e="",textStyle:i,padding:r=0,background:n,minWidth:l,maxWidth:s,shape:a}=t,o={x:0,y:0,text:e,textStyle:i,padding:(0,wj.o)(r),minWidth:l,maxWidth:s};a&&a.visible&&(o.shape=Object.assign({visible:!0},a.style),(0,aw.Z)(a.space)&&(o.space=a.space)),n&&n.visible&&(o.panel=Object.assign({visible:!0},n.style));let h=new Su(o);h.name=eT.title,this._title=h,this._innerView.add(h)}_adjustLayout(){var t;if(this._title){let e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),r=null==(t=this.attribute.title)?void 0:t.align;"center"===r?this._title.setAttribute("x",(e-i)/2):"end"===r&&this._title.setAttribute("x",e-i)}}}function Ex(){uD(),cH(),cw()}let Ew={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};Ex();class ES extends CB{getCurrent(){return this._current}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},ES.defaultAttributes,t)),this.name="pager",this._current=1,this._onHover=t=>{let e=t.target;e.hasState("disable")||e.addState("hover")},this._onUnHover=t=>{t.target.removeState("hover")},this._onClick=t=>{let e=t.target;if("preHandler"===e.name){if(1===this._current)return;this._current-=1,1===this._current?e.addState("disable"):e.removeState("disable"),this._dispatchEvent("toPrev",{current:this._current,total:this._total,direction:"pre",event:t})}if("nextHandler"===e.name){if(this._current===this._total)return;this._current+=1,this._current===this._total?e.addState("disable"):e.removeState("disable"),this._dispatchEvent("toNext",{current:this._current,total:this._total,direction:"next",event:t})}this._current>1&&this.preHandler.removeState("disable"),this._current<this._total&&this.nextHandler.removeState("disable"),this.text.setAttribute("text",this._getPageText(this._current))}}render(){var t,e,i;this._reset();let{layout:r="horizontal",handler:n=Ew,total:l,defaultCurrent:s=1,textStyle:a,padding:o=0}=this.attribute;this._current=s;let h=(0,wj.o)(o),d="horizontal"===r,u=ak.group({x:0,y:0}),c=n.style||{},p=c.size||15,g=null!=(t=n.space)?t:8,f=n.state||{},{preShape:m,nextShape:y}=n;m||(m=d?"triangleLeft":"triangleUp"),y||(y=d?"triangleRight":"triangleDown");let v=ak.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},c),{x:0,y:0,symbolType:m,size:p}));v.states=f,v.name="preHandler",this.preHandler=v,u.add(v);let{width:b,height:_}=g0(this._getPageText(l),Object.assign({textAlign:"center",textBaseline:"middle"},a),null==(i=null==(e=this.stage)?void 0:e.getTheme())?void 0:i.text),C=(0,n4.Z)(p)?p:p[0],x=(0,n4.Z)(p)?p:p[1],w=ak.text(Object.assign({x:d?C/2+g+b/2:0,y:d?0:x/2+g+_/2,text:this._getPageText(s),textAlign:"center",textBaseline:"middle",lineHeight:null==a?void 0:a.fontSize},a));this.text=w,u.add(w);let S=ak.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},c),{x:d?C+2*g+b:0,y:d?0:x+2*g+_,symbolType:y,size:p}));S.name="nextHandler",S.states=f,this.nextHandler=S,u.add(S),1===this._total?(v.addState("disable"),S.addState("disable")):1===this._current?v.addState("disable"):this._current===l&&S.addState("disable");let A=u.AABBBounds,M=A.width(),T=A.height();u.translateTo(0-A.x1+h[3],0-A.y1+h[0]),this.add(u),this.attribute.width=M+h[1]+h[3],this.attribute.height=T+h[0]+h[2],this._bindEvents()}_bindEvents(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}_reset(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}_getPageText(t){let{pageFormatter:e}=this.attribute;return e?(0,nz.Z)(e)?e(t,this._total):`${e}`.replace("{current}",`${t}`).replace("{total}",`${this._total}`):`${t}/${this._total}`}setTotal(t){t!==this.attribute.total&&(this._total=t,1!==this._current&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}function EA(){uD(),cw(),c7(),cH()}function EM(){uD(),Sh()}ES.defaultAttributes={handler:Ew,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};var ET=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let Ek={[eA.focus]:{},[eA.selected]:{},[eA.selectedHover]:{},[eA.unSelected]:{},[eA.unSelectedHover]:{}};EM(),Ex(),uD(),c7();class ER extends EC{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},ER.defaultAttributes,t)),this.name="discreteLegend",this._itemsContainer=null,this._itemHeightByUser=void 0,this._itemHeight=0,this._itemMaxWidth=0,this._contentMaxHeight=0,this._onHover=t=>{let e=t.target;if(e&&e.name&&e.name.startsWith(eT.item)){let i=e.delegate;if(this._lastActiveItem){if(this._lastActiveItem.id===i.id)return;this._unHover(this._lastActiveItem,t)}this._hover(i,t)}else this._lastActiveItem&&(this._unHover(this._lastActiveItem,t),this._lastActiveItem=null)},this._onUnHover=t=>{this._lastActiveItem&&(this._unHover(this._lastActiveItem,t),this._lastActiveItem=null)},this._onClick=t=>{var e,i,r,n;let l=t.target;if(l&&l.name&&l.name.startsWith(eT.item)){let s=l.delegate,{selectMode:a="multiple"}=this.attribute;if(l.name===eT.focus||"focus"===a){let r=s.hasState(eA.focus);s.toggleState(eA.focus),r?null==(e=this._itemsContainer)||e.getChildren().forEach(e=>{this._removeLegendItemState(e,[eA.unSelected,eA.unSelectedHover,eA.focus],t),this._setLegendItemState(e,eA.selected,t)}):(this._setLegendItemState(s,eA.selected,t),this._removeLegendItemState(s,[eA.unSelected,eA.unSelectedHover],t),null==(i=this._itemsContainer)||i.getChildren().forEach(e=>{s!==e&&(this._removeLegendItemState(e,[eA.selected,eA.selectedHover,eA.focus],t),this._setLegendItemState(e,eA.unSelected,t))}))}else{null==(r=this._itemsContainer)||r.getChildren().forEach(t=>{t.removeState(eA.focus)});let{allowAllCanceled:e=!0}=this.attribute,i=s.hasState(eA.selected),l=this._getSelectedLegends();if("multiple"===a){if(!1===e&&i&&1===l.length)return void this._dispatchLegendEvent(eM.legendItemClick,s,t);i?(this._removeLegendItemState(s,[eA.selected,eA.selectedHover],t),this._setLegendItemState(s,eA.unSelected,t)):(this._setLegendItemState(s,eA.selected,t),this._removeLegendItemState(s,[eA.unSelected,eA.unSelectedHover],t))}else this._setLegendItemState(s,eA.selected,t),this._removeLegendItemState(s,[eA.unSelected,eA.unSelectedHover],t),null==(n=this._itemsContainer)||n.getChildren().forEach(e=>{s!==e&&(this._removeLegendItemState(e,[eA.selected,eA.selectedHover],t),this._setLegendItemState(e,eA.unSelected,t))})}this._dispatchLegendEvent(eM.legendItemClick,s,t)}}}render(){super.render(),this._lastActiveItem=null}setSelected(t){var e;(null==(e=this._itemsContainer)?void 0:e.getChildren()).forEach(e=>{let i=e.data;t.includes(i.label)?(this._setLegendItemState(e,eA.selected),this._removeLegendItemState(e,[eA.unSelected,eA.unSelectedHover])):(this._removeLegendItemState(e,[eA.selected,eA.selectedHover]),this._setLegendItemState(e,eA.unSelected))})}_renderItems(){let{item:t={},maxCol:e=1,maxRow:i=2,maxWidth:r,defaultSelected:n,lazyload:l,autoPage:s}=this.attribute,{spaceCol:a=16,spaceRow:o=8,verticalAlign:h="middle"}=t,d=this._itemsContainer,{items:u,isHorizontal:c,startIndex:p,isScrollbar:g}=this._itemContext,f=g?1:c?i:e,m=this._contentMaxHeight,y,{doWrap:v,maxWidthInCol:b,startX:_,startY:C,pages:x}=this._itemContext,w=0,S=0,A=[];for(let t=p,e=u.length;t<e&&!(l&&x>this._itemContext.currentPage*f);t++){l&&(this._itemContext.startIndex=t+1),(y=u[t]).id||(y.id=y.label),y.index=t;let e=!0;(0,rD.Z)(n)&&(e=n.includes(y.label));let i=this._renderEachItem(y,e,t,u),p=i.attribute.width,f=i.attribute.height;this._itemHeight=Math.max(this._itemHeight,f),b=Math.max(p,b),this._itemMaxWidth=Math.max(p,this._itemMaxWidth),c?((0,aw.Z)(r)&&(g&&s?v=(x=Math.ceil((_+p)/r))>1:_+p>r&&(v=!0,_>0&&("middle"!==h&&"bottom"!==h||A.forEach(t=>{t.setAttributes({y:t.attribute.y+(S-t.attribute.height)/("middle"===h?2:1)})}),x+=1,_=0,C+=S+o,S=0,A.length=0))),0===_&&0===C||i.setAttributes({x:_,y:C}),_+=a+p,S=Math.max(S,f),A.push(i)):((0,aw.Z)(m)&&(g&&s?v=(x=Math.ceil((C+f)/m))>1:m<=f?(x+=1,v=!0,C=0,t>0&&(_+=w+a)):m<C+f&&(x+=1,v=!0,C=0,_+=b+a,b=0)),0===_&&0===C||i.setAttributes({x:_,y:C}),C+=o+f),d.add(i),w=p}return c&&("middle"===h||"bottom"===h)&&A.forEach(t=>{t.setAttributes({y:t.attribute.y+(S-t.attribute.height)/("middle"===h?2:1)})}),this._itemContext.doWrap=v,this._itemContext.startX=_,this._itemContext.startY=C,this._itemContext.maxWidthInCol=b,this._itemContext.pages=x,this._itemContext.maxPages=f,g&&(this._itemContext.totalPage=x),l||(this._itemContext.startIndex=u.length),this._itemContext}_renderContent(){let{item:t={},items:e,reversed:i,maxWidth:r,maxHeight:n}=this.attribute;if(!1===t.visible||(0,uF.Z)(e))return;let l=e;i&&(l=null==e?void 0:e.reverse()),this._contentMaxHeight=Math.max(0,n-this._parsedPadding[0]-this._parsedPadding[2]);let s=ak.group({x:0,y:0});this._itemsContainer=s;let{layout:a,autoPage:o}=this.attribute,{maxWidth:h,width:d,height:u}=t,c=[];(0,aw.Z)(h)&&c.push(h),(0,aw.Z)(d)&&c.push(d),c.length&&((0,aw.Z)(r)&&c.push(r),this._itemWidthByUser=(0,a1.iH)(c)),(0,aw.Z)(u)&&(this._itemHeightByUser=u);let p=this.attribute.pager;this._itemContext={currentPage:p&&p.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:l,isHorizontal:"horizontal"===a,totalPage:1/0,isScrollbar:p&&"scrollbar"===p.type,clipContainer:void 0},this._itemContext=this._renderItems();let g=!1;this._itemContext.doWrap&&o&&this._itemContext.pages>this._itemContext.maxPages&&(g=this._renderPagerComponent()),g||(s.setAttribute("y",this._title?this._title.AABBBounds.height()+(0,dx.Z)(this.attribute,"title.space",8):0),this._innerView.add(s))}_bindEvents(){if(this.attribute.disableTriggerEvent||!this._itemsContainer)return;let{hover:t=!0,select:e=!0}=this.attribute;if(t){let e="pointermove",i="pointerleave";(0,nF.Z)(t)&&(t.trigger&&(e=t.trigger),t.triggerOff&&(i=t.triggerOff)),this._itemsContainer.addEventListener(e,this._onHover),this._itemsContainer.addEventListener(i,this._onUnHover)}if(e){let t="pointerdown";(0,nF.Z)(e)&&e.trigger&&(t=e.trigger),this._itemsContainer.addEventListener(t,this._onClick)}}_autoEllipsis(t,e,i,r){var n,l;let{label:s,value:a}=this.attribute.item,o=r.AABBBounds,h=i.AABBBounds,d=o.width(),u=h.width(),c=!1;"labelFirst"===t?u>e?c=!0:r.setAttribute("maxLineWidth",e-u):"valueFirst"===t?d>e?c=!0:i.setAttribute("maxLineWidth",e-d):d+u>e&&(c=!0),c&&(r.setAttribute("maxLineWidth",Math.max(e*(null!=(n=s.widthRatio)?n:.5),e-u)),i.setAttribute("maxLineWidth",Math.max(e*(null!=(l=a.widthRatio)?l:.5),e-d)))}_renderEachItem(t,e,i,r){var n,l;let s,{id:a,label:o,value:h,shape:d}=t,{padding:u=0,focus:c,focusIconStyle:p,align:g,autoEllipsisStrategy:f}=this.attribute.item,{shape:m,label:y,value:v,background:b}=this.attribute.item,_=this._handleStyle(m,t,e,i,r),C=this._handleStyle(y,t,e,i,r),x=this._handleStyle(v,t,e,i,r),w=this._handleStyle(b,t,e,i,r),S=(0,wj.o)(u);!1===b.visible?(s=ak.group({x:0,y:0,cursor:null==(n=w.style)?void 0:n.cursor}),this._appendDataToShape(s,eT.item,t,s)):(s=ak.group(Object.assign({x:0,y:0},w.style)),this._appendDataToShape(s,eT.item,t,s,w.state)),s.id=`${null!=a?a:o}-${i}`,s.addState(e?eA.selected:eA.unSelected);let A=ak.group({x:0,y:0,pickable:!1});s.add(A);let M,T=0,k=0,R=0;if(m&&!1!==m.visible){let i=(0,dx.Z)(_,"style.size",10);k=(0,rD.Z)(i)?i[0]||0:i,R=(0,dx.Z)(m,"space",8);let r=ak.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},d),_.style));Object.keys(_.state||{}).forEach(t=>{let e=_.state[t].fill||_.state[t].stroke;d.fill&&(0,nB.Z)(_.state[t].fill)&&e&&(_.state[t].fill=e),d.stroke&&(0,nB.Z)(_.state[t].stroke)&&e&&(_.state[t].stroke=e)}),this._appendDataToShape(r,eT.itemShape,t,s,_.state),r.addState(e?eA.selected:eA.unSelected),A.add(r)}let P=0;if(c){let e=(0,dx.Z)(p,"size",10);M=ak.symbol(Object.assign(Object.assign({x:0,y:-e/2-1,strokeBoundsBuffer:0,boundsPadding:S},p),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(M,eT.focus,t,s),P=e}let B=y.formatMethod?y.formatMethod(o,t,i):o,I=g3(Object.assign(Object.assign({x:k/2+R,y:0,textAlign:"start",textBaseline:"middle",lineHeight:null==(l=C.style)?void 0:l.fontSize},C.style),{text:B,_originText:y.formatMethod?o:void 0}));this._appendDataToShape(I,eT.itemLabel,t,s,C.state),I.addState(e?eA.selected:eA.unSelected),A.add(I);let E=(0,dx.Z)(y,"space",8);if((0,aw.Z)(h)){let r=(0,dx.Z)(v,"space",8*!!c),n=v.formatMethod?v.formatMethod(h,t,i):h,l=g3(Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:x.style.fontSize},x.style),{text:n,_originText:v.formatMethod?h:void 0}));if(this._appendDataToShape(l,eT.itemValue,t,s,x.state),l.addState(e?eA.selected:eA.unSelected),this._itemWidthByUser){let t=this._itemWidthByUser-S[1]-S[3]-k-R-E-P-r;this._autoEllipsis(f,t,I,l),v.alignRight?l.setAttributes({textAlign:"right",x:this._itemWidthByUser-k/2-S[1]-S[3]-P-r}):l.setAttribute("x",E+(I.AABBBounds.empty()?0:I.AABBBounds.x2))}else l.setAttribute("x",E+(I.AABBBounds.empty()?0:I.AABBBounds.x2));T=r+(l.AABBBounds.empty()?0:l.AABBBounds.x2),A.add(l)}else this._itemWidthByUser&&I.setAttribute("maxLineWidth",this._itemWidthByUser-S[1]-S[3]-k-R-P),T=E+(I.AABBBounds.empty()?0:I.AABBBounds.x2);M&&(M.setAttribute("x",T),A.add(M));let L=A.AABBBounds,F=L.width();if("right"===g){let t=L.x2,e=L.x1;A.forEachChildren((i,r)=>{"symbol"!==i.type&&"right"!==i.attribute.textAlign||i===M?i.setAttribute("x",e+t-i.attribute.x-i.AABBBounds.width()):"symbol"!==i.type?i.setAttributes({x:e+t-i.attribute.x,textAlign:"left"}):i.setAttribute("x",e+t-i.attribute.x)})}let O=L.height(),H=(0,aw.Z)(this.attribute.item.width)?this.attribute.item.width:F+S[1]+S[3],D=this._itemHeightByUser||O+S[0]+S[2];return s.attribute.width=H,s.attribute.height=D,M&&M.setAttribute("visible",!1),A.translateTo(-L.x1+S[3],-L.y1+S[0]),s}_createPager(t){var e,i;let{disableTriggerEvent:r,maxRow:n}=this.attribute,l=t=>t<=99?99:t<=999?999:9999;return new ES(this._itemContext.isHorizontal?Object.assign(Object.assign({layout:1===n?"horizontal":"vertical",total:l(this._itemContext.pages)},(0,h3.Z)({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:null==(e=this.attribute.pager)?void 0:e.defaultCurrent,disableTriggerEvent:r}):Object.assign({layout:"horizontal",total:l(this._itemContext.pages),disableTriggerEvent:r,defaultCurrent:null==(i=this.attribute.pager)?void 0:i.defaultCurrent},t))}_createScrollbar(t,e){let{disableTriggerEvent:i}=this.attribute;return new IB(this._itemContext.isHorizontal?Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:i,range:[0,.5],height:12*(!1!==t.visible)},t),{width:e}):Object.assign(Object.assign({direction:"vertical",width:12*(!1!==t.visible),range:[0,.5]},t),{height:e,disableTriggerEvent:i}))}_updatePositionOfPager(t,e,i){let{pager:r}=this.attribute,{totalPage:n,isHorizontal:l}=this._itemContext,s=r&&r.position||"middle";if(this._pagerComponent.setTotal(n),l){let r;r="start"===s?t:"end"===s?t+i-this._pagerComponent.AABBBounds.height()/2:t+i/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:e-this._pagerComponent.AABBBounds.width(),y:r})}else{let t;t="start"===s?0:"end"===s?e-this._pagerComponent.AABBBounds.width():(e-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:t,y:i-this._pagerComponent.AABBBounds.height()})}}_computeScrollbarDelta(){let t,{isHorizontal:e,clipContainer:i}=this._itemContext,r=this._itemsContainer.AABBBounds,n=i.AABBBounds;return e?n.width()/r.width():n.height()/r.height()}_updatePositionOfScrollbar(t,e,i){let{isHorizontal:r,currentPage:n,totalPage:l}=this._itemContext,s=(n-1)/l;this._pagerComponent.setScrollRange([s,s+this._computeScrollbarDelta()]),r?this._pagerComponent.setAttributes({x:0,y:i+e}):this._pagerComponent.setAttributes({x:t,y:i})}_bindEventsOfPager(t,e){let{animation:i=!0,animationDuration:r=450,animationEasing:n="quadIn"}=this.attribute.pager||{},l=this._itemContext.isScrollbar?t=>{let{value:e}=t.detail;return 0===e[0]?1:1===e[1]?this._itemContext.totalPage:e[0]*this._itemContext.totalPage+1}:t=>t.detail.current,s=s=>{let a=l(s);if(a!==this._itemContext.currentPage){if(this._itemContext.currentPage=a,this._itemContext&&this._itemContext.startIndex<this._itemContext.items.length){this._renderItems();let t=Math.ceil(this._itemContext.pages/this._itemContext.maxPages);if(this._itemContext.totalPage=t,this._itemContext.isScrollbar&&this._pagerComponent){let t=this._computeScrollbarDelta(),[e]=this._pagerComponent.getScrollRange();this._pagerComponent.setScrollRange([e,e+t])}}if(this._itemContext.isScrollbar){let[t]=this._pagerComponent.getScrollRange(),l=(this._itemContext.isHorizontal?this._itemsContainer.AABBBounds.width():this._itemsContainer.AABBBounds.height())*t;this.updateScrollMask(),i?this._itemsContainer.animate().to({[e]:-l},r,n):this._itemsContainer.setAttribute(e,-l)}else i?this._itemsContainer.animate().to({[e]:-(a-1)*t},r,n):this._itemsContainer.setAttribute(e,-(a-1)*t)}};this._itemContext.isScrollbar?(this._pagerComponent.addEventListener("scrollDrag",s),this._pagerComponent.addEventListener("scrollUp",s),this.attribute.pager.roamScroll&&(this.addEventListener("wheel",t=>t.nativeEvent.preventDefault()),this.addEventListener("wheel",(0,dw.Z)(t=>{let e=this._pagerComponent,i=e.getScrollRange(),{direction:r}=e.attribute,{width:n,height:l}=e.getSliderRenderBounds(),s="vertical"===r?t.deltaY/l:t.deltaX/n;e.setScrollRange([i[0]+s,i[1]+s],!0),this.updateScrollMask()},50)))):(this._pagerComponent.addEventListener("toPrev",s),this._pagerComponent.addEventListener("toNext",s))}_renderPager(){let t=this._title?this._title.AABBBounds.height()+(0,dx.Z)(this.attribute,"title.space",8):0,{maxWidth:e,maxCol:i=1,maxRow:r=2,item:n={},pager:l={}}=this.attribute,{spaceCol:s=16,spaceRow:a=8}=n,o=this._itemsContainer,{space:h=12,defaultCurrent:d=1}=l,u=ET(l,["space","defaultCurrent"]),{isHorizontal:c}=this._itemContext,p=this._contentMaxHeight,g,f=0,m=0,y=0,v=0,b=0,_=0,C=1;if(c){if(m=(r-1)*a+this._itemHeight*r,f=e,g=this._createPager(u),this._pagerComponent=g,this._innerView.add(g),(y=e-g.AABBBounds.width()-h)<=0)return this._innerView.removeChild(g),!1;o.getChildren().forEach((t,e)=>{let{width:i,height:r}=t.attribute;y<b+i&&e>0&&(b=0,_+=r+a,C+=1),e>0&&t.setAttributes({x:b,y:_}),b+=s+i}),this._itemContext.startX=b,this._itemContext.startY=_,this._itemContext.pages=C;let i=Math.ceil(C/r);this._itemContext.totalPage=i,this._updatePositionOfPager(t,f,m)}else{if(f=this._itemMaxWidth*i+(i-1)*s,m=p,y=f,g=this._createPager(u),this._pagerComponent=g,this._innerView.add(g),(v=p-g.AABBBounds.height()-h-t)<=0)return this._innerView.removeChild(g),!1;o.getChildren().forEach((t,e)=>{let{width:i,height:r}=t.attribute;v<_+r&&e>0&&(_=0,b+=this._itemMaxWidth+s,C+=1),e>0&&t.setAttributes({x:b,y:_}),_+=a+r});let e=Math.ceil(C/i);this._itemContext.totalPage=e,this._updatePositionOfPager(t,f,m)}d>1&&(c?o.setAttribute("y",-(d-1)*(m+a)):o.setAttribute("x",-(d-1)*(f+s)));let x=ak.group({x:0,y:t,width:c?y:f,height:c?m:v,clip:!0,pickable:!1});return x.add(o),this._innerView.add(x),this._itemContext.clipContainer=x,this._bindEventsOfPager(c?m+a:f+s,c?"y":"x"),!0}_renderScrollbar(){var t;let e=this._title?this._title.AABBBounds.height()+(0,dx.Z)(this.attribute,"title.space",8):0,{maxWidth:i,item:r={},pager:n={}}=this.attribute,{spaceCol:l=16,spaceRow:s=8}=r,a=this._itemsContainer,{space:o=12,defaultCurrent:h=1}=n,d=ET(n,["space","defaultCurrent"]),{isHorizontal:u}=this._itemContext,c=this._contentMaxHeight,p,g=0,f=0,m=0,y=1;if(u)g=i,f=this._itemHeight,p=this._createScrollbar(d,g),this._pagerComponent=p,this._innerView.add(p);else{if(f=c-e,g=this._itemMaxWidth,p=this._createScrollbar(d,f),this._pagerComponent=p,this._innerView.add(p),f<=0)return this._innerView.removeChild(p),!1;let t=a.getChildren(),i=t.map(t=>t.attribute.height);if(1===i.length||i.every(t=>t===i[0])){let e=i[0],r=Math.floor(f/(s+e));f=r*(s+e),y=Math.ceil(t.length/r)}else t.forEach((t,e)=>{let{height:i}=t.attribute,r=y,n=m;y=Math.floor((m+i)/f)+1,m+=s+i,r!==y&&e===a.getChildren().length-1&&m-f>=1/3*i&&(f=n+i,y-=1)});this._itemContext.totalPage=y,this._itemContext.pages=y}if(h>1)if(u){let t=this._itemsContainer.AABBBounds.width()-g;a.setAttribute("x",-Math.min((h-1)*(g+l),t))}else{let t=this._itemsContainer.AABBBounds.height()-f;a.setAttribute("y",-Math.min((h-1)*(f+s),t))}let v=ak.group({x:0,y:e,width:g,height:f,clip:!0,pickable:!1});return v.add(a),this._innerView.add(v),this._itemContext.clipContainer=v,this._updatePositionOfScrollbar(g,f,e),(null==(t=n.scrollMask)?void 0:t.visible)&&this.renderScrollMask(v),this._bindEventsOfPager(u?g:f,u?"x":"y"),!0}renderScrollMask(t){let{scrollMask:e={}}=this.attribute.pager,{visible:i=!0,gradientLength:r=16,gradientStops:n}=e;if(!i||!n)return;let l=t.AABBBounds.width(),s=t.AABBBounds.height(),a=this._itemContext.isHorizontal?l:s,o=n.map(t=>({offset:r*t.offset/a,color:t.color})),h=n.map(t=>({offset:(a-r*t.offset)/a,color:t.color})),d=ak.rect({x:0,y:0,width:l,height:s});this._scrollMask=d,this._scrollMaskContext={startStops:o,endStops:h},this.updateScrollMask(),t.add(d)}updateScrollMask(){if(!this._scrollMask||!this._pagerComponent||!this._itemContext.isScrollbar)return;let[t,e]=this._pagerComponent.getScrollRange(),i=[];(0,ng.Yt)((0,yj.Z)(e,0,1),1)||i.push(...this._scrollMaskContext.endStops),(0,ng.Yt)((0,yj.Z)(t,0,1),0)||i.push(...this._scrollMaskContext.startStops),i.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:i}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:i}}))}_renderPagerComponent(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}_hover(t,e){this._lastActiveItem=t,t.hasState(eA.selected)?this._setLegendItemState(t,eA.selectedHover,e):this._setLegendItemState(t,eA.unSelectedHover,e);let i=t.getChildren()[0].find(t=>t.name===eT.focus,!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(eM.legendItemHover,t,e)}_unHover(t,e){let i=!1;(t.hasState(eA.unSelectedHover)||t.hasState(eA.selectedHover))&&(i=!0),t.removeState(eA.unSelectedHover),t.removeState(eA.selectedHover),t.getChildren()[0].getChildren().forEach(t=>{!i&&(t.hasState(eA.unSelectedHover)||t.hasState(eA.selectedHover))&&(i=!0),t.removeState(eA.unSelectedHover),t.removeState(eA.selectedHover)});let r=t.getChildren()[0].find(t=>t.name===eT.focus,!1);r&&r.setAttribute("visible",!1),i&&this._dispatchLegendEvent(eM.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(eM.legendItemUnHover,t,e)}_setLegendItemState(t,e,i){let r=!1;t.hasState(e)||(r=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach(t=>{t.name!==eT.focus&&(r||t.hasState(e)||(r=!0),t.addState(e,!0))}),r&&this._dispatchLegendEvent(eM.legendItemAttributeUpdate,t,i)}_removeLegendItemState(t,e,i){let r=!1;e.forEach(e=>{!r&&t.hasState(e)&&(r=!0),t.removeState(e)}),t.getChildren()[0].getChildren().forEach(t=>{t.name!==eT.focus&&e.forEach(e=>{!r&&t.hasState(e)&&(r=!0),t.removeState(e)})}),r&&this._dispatchLegendEvent(eM.legendItemAttributeUpdate,t,i)}_getSelectedLegends(){var t;let e=[];return null==(t=this._itemsContainer)||t.getChildren().forEach(t=>{t.hasState(eA.selected)&&e.push(t.data)}),e}_appendDataToShape(t,e,i,r,n={}){t.name=e,t.data=i,t.delegate=r,t.states=(0,h3.Z)({},Ek,n)}_dispatchLegendEvent(t,e,i){let r=this._getSelectedLegends();r.sort((t,e)=>t.index-e.index);let n=r.map(t=>t.label);this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(eA.selected),currentSelectedItems:r,currentSelected:n,event:i})}_handleStyle(t,e,i,r,n){let l={};return t.style&&((0,nz.Z)(t.style)?l.style=t.style(e,i,r,n):l.style=t.style),t.state&&(l.state={},Object.keys(t.state).forEach(s=>{t.state[s]&&((0,nz.Z)(t.state[s])?l.state[s]=t.state[s](e,i,r,n):l.state[s]=t.state[s])})),l}release(){super.release(),this.removeAllEventListeners()}}ER.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:16,spaceRow:8,shape:{space:8,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:8,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:10,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0};let EP=(t,e)=>{let i=[],r={},{series:n,seriesField:l}=e;return n().forEach(t=>{let e=l(t);(e===t.getSeriesField()?t.getSeriesInfoList():t.getSeriesInfoInField(e)).forEach(t=>{r[t.key]||(r[t.key]=!0,i.push(t))})}),i},EB=(t,e)=>{var i,r,n;let{series:l,selected:s,field:a,data:o,customFilter:h}=e,d=s(),u=o();if(0===d.length&&u.length)return[];if(d.length===u.length)return t;let c={};d.forEach(t=>{c[t]=!0});let p=null!=(i=a())?i:ul;return h?h(t,d,p):((0,rD.Z)(t)&&(null==(r=t[0])?void 0:r.nodes)?(t[0].nodes=t[0].nodes.filter(t=>!0===c[t.key]),(null==(n=t[0])?void 0:n.links)&&(t[0].links=t[0].links.filter(t=>!0===c[t.source]&&!0===c[t.target]))):(0,aw.Z)(p)&&(t=t.filter(t=>!0===c[l.getSeriesFieldValue(t,p)])),t)};class EI extends xZ{constructor(){super(...arguments),this.layoutType="normal",this.layoutZIndex=ts.Legend,this.layoutLevel=ta.Legend,this.specKey="legends",this._orient="left",this._visible=!0,this._position="middle",this._preSelectedData=[],this._selectedData=[],this.effect={onSelectedDataChange:()=>{C$(this._regions,t=>{var e;null==(e=t.getViewData())||e.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),C$(this._regions,t=>{t.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}get orient(){return this._orient}get visible(){return this._visible}get position(){return this._position}getLegendData(){return this._legendData.getLatestData()}getSelectedData(){return this._selectedData}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._orient=h_(this._spec.orient)?this._spec.orient:"left",this._position=null!=(t=this._spec.position)?t:"middle",this._visible=!1!==this._spec.visible;let{regionId:e,regionIndex:i,seriesId:r,seriesIndex:n}=this._spec;(0,aw.Z)(r)&&(this._seriesUserId=(0,a1.IX)(r)),(0,aw.Z)(e)&&(this._regionUserId=(0,a1.IX)(e)),(0,aw.Z)(n)&&(this._seriesIndex=(0,a1.IX)(n)),(0,aw.Z)(i)&&(this._regionUserIndex=(0,a1.IX)(i)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionUserIndex)}created(){super.created(),this.initData()}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reRender=!0,(null==t?void 0:t.orient)!==(null==e?void 0:e.orient)?i.reMake=!0:(0,uL.X)(e,t)||(i.reCompile=!0),i}_bindLegendDataChange(){this._preSelectedData=this._selectedData.slice(),this._initSelectedData(),this._forceLayout()}initData(){let t=this._initLegendData();t.target.addListener("change",this._bindLegendDataChange.bind(this)),this._legendData=new pV(this._option,t),this._initSelectedData(),C$(this._regions,t=>{t.event.on(J.rawDataUpdate,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>{this._legendData.getDataView().reRunAllTransform({skipEqual:!0})})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}setSelectedData(t){var e,i,r;let n=this._selectedData;(0,nB.Z)(t)||JSON.stringify(n)===JSON.stringify(t)||(C$(this._regions,e=>{e.legendSelectedFilter&&(t=e.legendSelectedFilter(this,t))},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._selectedData=[...t],null==(i=(e=this.effect).onSelectedDataChange)||i.call(e),this.event.emit(J.legendSelectedDataChange,{model:this}),null==(r=this._legendComponent)||r.setSelected(this._selectedData))}afterSetLayoutStartPoint(t){if(super.afterSetLayoutStartPoint(t),this._legendComponent){let{x:e,y:i}=t;(0,hy.Z)(e*i)&&this._legendComponent.setAttributes({x:e,y:i})}}getBoundsInRect(t,e){if(!this._visible)return this._legendComponent&&this._legendComponent.parent&&(this._legendComponent.parent.removeChild(this._legendComponent),this._legendComponent=null),{x1:0,y1:0,x2:0,y2:0};let i={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},r=this._getLegendAttributes(t);if(r.disableTriggerEvent=this._option.disableTriggerEvent,this._legendComponent)(0,uL.X)(r,this._cacheAttrs)||this._legendComponent.setAttributes(h5({},r,{defaultSelected:this._selectedData}));else{let t=new(this._getLegendConstructor())(h5({},r,{defaultSelected:this._selectedData}));t.name="legend",this._legendComponent=t,this.getContainer().add(t),this._option.disableTriggerEvent||this._initEvent(),t.on("*",(t,e)=>this._delegateEvent(this._legendComponent,t,e))}this._cacheAttrs=r;let n=isFinite(this._legendComponent.AABBBounds.width())?this._legendComponent.AABBBounds.width():0,l=isFinite(this._legendComponent.AABBBounds.height())?this._legendComponent.AABBBounds.height():0;if("normal-inline"!==this.layoutType){let t="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",i=this._position,{width:r,height:s}=e,a=0,o=0;"horizontal"===t?"middle"===i?a=(r-n)/2:"end"===i&&(a=r-n):"middle"===i?o=(s-l)/2:"end"===i&&(o=s-l),this._legendComponent.setAttributes({dx:a,dy:o})}return i.x2=i.x1+n,i.y2=i.y1+l,i}onDataUpdate(){var t,e;if(JSON.stringify(this._preSelectedData)!==JSON.stringify(this._selectedData)){if(this._legendComponent){let t=this._getLegendAttributes(this.getLayoutRect());(0,uL.X)(t,this._cacheAttrs)||this._legendComponent.setAttributes(h5({},t,{defaultSelected:this._selectedData}))}null==(e=(t=this.effect).onSelectedDataChange)||e.call(t),this.event.emit(J.legendSelectedDataChange,{model:this})}}_getNeedClearVRenderComponents(){return[this._legendComponent]}clear(){super.clear(),this._cacheAttrs=null,this._preSelectedData=null}}EI.specKey="legends";let EE={orient:"bottom",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal"},space:12},pager:{textStyle:{fill:{type:"palette",key:"discreteLegendPagerTextColor"}},handler:{style:{fill:{type:"palette",key:"discreteLegendPagerHandlerColor"}},state:{disable:{fill:{type:"palette",key:"discreteLegendPagerHandlerDisableColor"}}}}},item:{visible:!0,spaceCol:10,spaceRow:6,padding:2,background:{state:{selectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}},unSelectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}}}},shape:{space:6,style:{lineWidth:0,fillOpacity:1,opacity:1},state:{unSelected:{fillOpacity:.2,opacity:1}}},label:{space:6,style:{fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},opacity:1},state:{unSelected:{fill:{type:"palette",key:"disableFontColor"},opacity:1}}}},allowAllCanceled:!1};class EL extends EI{constructor(){super(...arguments),this.type=oQ.discreteLegend,this.name=oQ.discreteLegend}static getSpecInfo(t){return bW(t,this.specKey,this.type,t=>!t.type||"discrete"===t.type)}init(t){super.init(t),C$(this._regions,t=>{t.addViewDataFilter({type:"discreteLegendFilter",options:{series:t,selected:()=>this._selectedData,field:()=>this._getSeriesLegendField(t),data:()=>this.getLegendDefaultData(),customFilter:this._spec.customFilter},level:ti.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_initLegendData(){dL(this._option.dataSet,"discreteLegendFilter",EB),dL(this._option.dataSet,"discreteLegendDataMake",EP);let t=new eq.V(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return t.transform({type:"discreteLegendDataMake",options:{series:()=>{let t=[];return C$(this._regions,e=>{t.push(e)},{specIndex:this._spec.seriesIndex,userId:this._spec.seriesId}),t},seriesField:t=>this._getSeriesLegendField(t)}}),t}_getSeriesLegendField(t){var e,i,r;let n=t.getSeriesField(),l=null!=(e=this._spec.scaleName)?e:this._spec.scale;if((0,nB.Z)(l)||!t.getRawData())return n;let s=this._option.globalScale.getScaleSpec(l);if(!s)return n;if(this._spec.field)return this._spec.field;if(!hb(s.domain))return n;let a=s.domain.find(e=>e.dataId===t.getRawData().name);return a&&null!=(r=null==(i=a.fields)?void 0:i[0])?r:n}_initSelectedData(){let t=this.getLegendDefaultData();if(this._unselectedData){let e=[],i=[];t.forEach(t=>{this._unselectedData.includes(t)?i.push(t):e.push(t)}),this._selectedData=e,this._unselectedData=i}else this._spec.defaultSelected?this._selectedData=[...this._spec.defaultSelected]:this._selectedData=t}getLegendDefaultData(t){return(0,nz.Z)(this._spec.data)?this._getLegendItems().map(t=>t.label):this._legendData.getLatestData().map(t?t=>t.originalKey:t=>t.key)}_addDefaultTitleText(t){var e,i,r,n;if((null==(e=t.title)?void 0:e.visible)&&(0,nB.Z)(t.title.text)&&(0,nB.Z)(null==(i=t.title.style)?void 0:i.text)){let e=null==(n=null==(r=this._regions)?void 0:r[0])?void 0:n.getSeries()[0];if(!e)return;t.title.text=bT(e.getRawData(),e.getSeriesField())}}_getLegendAttributes(t){let e=Object.assign(Object.assign({layout:"bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",items:this._getLegendItems(),zIndex:this.layoutZIndex},function(t,e){let{title:i={},item:r={},pager:n={},background:l={},type:s,id:a,visible:o,orient:h,position:d,data:u,filter:c,regionId:p,regionIndex:g,seriesIndex:f,seriesId:m,padding:y}=t,v=E_(t,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]),{title:b={},item:_={},pager:C={},background:x={}}=t;return b=(0,dz.Z)(b),_=(0,dz.Z)(_),C=(0,dz.Z)(C),x=(0,dz.Z)(x),b.visible?v.title=Eb(b):v.title={visible:!1},(0,uF.Z)(_.focusIconStyle)||xg(_.focusIconStyle),_.shape&&(_.shape=xu(_.shape)),_.label&&(_.label=xu(_.label)),_.value&&(_.value=xu(_.value)),_.background&&(_.background=xu(_.background)),hC(_.maxWidth)&&(_.maxWidth=Number(_.maxWidth.substring(0,_.maxWidth.length-1))*e.width/100),hC(_.width)&&(_.width=Number(_.width.substring(0,_.width.length-1))*e.width/100),hC(_.height)&&(_.height=Number(_.height.substring(0,_.height.length-1))*e.width/100),v.item=_,"scrollbar"===C.type?((0,uF.Z)(C.railStyle)||xg(C.railStyle),(0,uF.Z)(C.sliderStyle)||xg(C.sliderStyle)):((0,uF.Z)(C.textStyle)||xg(C.textStyle),C.handler&&xu(C.handler)),v.pager=C,x.visible&&!(0,uF.Z)(x.style)&&(h5(v,x.style),(0,aw.Z)(x.padding)&&(v.padding=x.padding)),v}(this._spec,t)),{maxWidth:t.width,maxHeight:t.height});return this._addDefaultTitleText(e),this._addLegendItemFormatMethods(e),e}_getLegendConstructor(){return ER}setSelectedData(t){t&&(this._unselectedData=this.getLegendDefaultData().filter(e=>!t.includes(e))),super.setSelectedData(t)}_initEvent(){if(this._legendComponent){let t=!1!==this._spec.filter;this._legendComponent.addEventListener(eM.legendItemClick,e=>{let i=(0,dx.Z)(e,"detail.currentSelected");t&&this.setSelectedData(i),this.event.emit(J.legendItemClick,{model:this,value:i,event:e})}),this._legendComponent.addEventListener(eM.legendItemHover,t=>{let e=(0,dx.Z)(t,"detail");this.event.emit(J.legendItemHover,{model:this,value:e,event:t})}),this._legendComponent.addEventListener(eM.legendItemUnHover,t=>{let e=(0,dx.Z)(t,"detail");this.event.emit(J.legendItemUnHover,{model:this,value:e,event:t})})}}_getLegendItems(){let t=(this._legendData.getLatestData()||[]).map(t=>{var e,i;let r=t.style("fillOpacity"),n=t.style("strokeOpacity"),l=t.style("opacity"),s=t.style("texture");return{label:t.key,shape:{symbolType:null!=(i=null!=(e=t.style("symbolType"))?e:t.shapeType)?i:"circle",fillOpacity:(0,hy.Z)(r)?r:1,strokeOpacity:(0,hy.Z)(n)?n:1,opacity:(0,hy.Z)(l)?l:1,texturePadding:s?1:null,textureSize:s?4:null,texture:s,fill:t.style("fill"),stroke:t.style("stroke"),textureColor:t.style("textureColor"),innerBorder:t.style("innerBorder"),outerBorder:t.style("outerBorder"),lineDash:t.style("lineDash"),lineDashOffset:t.style("lineDashOffset"),lineWidth:t.style("lineWidth")}}});return(0,nz.Z)(this._spec.data)?this._spec.data(t,this._option.globalScale.getScale("color"),this._option.globalScale):t}_addLegendItemFormatMethods(t){var e,i,r,n;let{formatMethod:l,formatter:s}=null!=(i=null==(e=this._spec.item)?void 0:e.label)?i:{},{formatMethod:a,formatter:o}=null!=(n=null==(r=this._spec.item)?void 0:r.value)?n:{},{formatFunc:h}=bz(l,s);s&&!l&&h&&(t.item.label.formatMethod=(t,e)=>h(t,e,s));let{formatFunc:d}=bz(a,o);o&&!a&&d&&(t.item.value.formatMethod=(t,e)=>d(o,t,e,s))}}EL.specKey="legends",EL.builtInTheme={discreteLegend:EE},EL.type=oQ.discreteLegend;let EF=()=>{h9.registerComponent(EL.type,EL)},EO=(t,e)=>{let{series:i,field:r,scale:n}=e,l=r();if(r&&l){let t=1/0,e=-1/0;return i().forEach(i=>{let r=i.getRawDataStatisticsByField(l,!0),n=null==r?void 0:r.min,s=null==r?void 0:r.max;(0,hy.Z)(n)&&(t=Math.min(n,t)),(0,hy.Z)(s)&&(e=Math.max(s,e))}),[t,e]}if(n){let t=n();return t?t.domain():[]}return[]},EH=(t,e)=>{let{selected:i,field:r,data:n,isHierarchyData:l,customFilter:s}=e,a=i(),o=r(),h=l||(t=>t&&t.some(t=>t&&function(t,e="value",i="children"){return!!(0,nF.Z)(t)&&!!t.hasOwnProperty(i)&&Array.isArray(t[i])}(t)));if(a===n())return t;if(o&&!(0,uF.Z)(a)){let[e,i]=a;return s?s(t,a,o):h(t)?function t(e,i,r,n="value",l="children"){return Array.isArray(e)?e.map(e=>{let s=Object.assign({},e);return Array.isArray(s[l])&&(s[l]=t(s[l],i,r,n,l)),s}).filter(t=>+t[n]>=i&&+t[n]<=r||t[l]&&t[l].length>0):e}(t,+e,+i,o):t.filter(t=>t[o]>=e&&t[o]<=i)}return t};function ED(t){return(0,rD.Z)(t)?t:[t,t]}function Ez(t){return t?"ew-resize":"ns-resize"}(t9=ek||(ek={})).innerView="innerView",t9.railContainer="sliderRailContainer",t9.rail="sliderRail",t9.startText="sliderStartText",t9.endText="sliderEndText",t9.startHandler="sliderStartHandler",t9.startHandlerText="startHandlerText",t9.endHandler="sliderEndHandler",t9.endHandlerText="sliderEndHandlerText",t9.track="sliderTrack",t9.trackContainer="sliderTrackContainer",EA();class EW extends CB{get track(){return this._track}get currentValue(){return this._currentValue}get startHandler(){return this._startHandler}get endHandler(){return this._endHandler}get tooltipShape(){return this._tooltipShape}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},EW.defaultAttributes,t)),this.name="slider",this._isHorizontal=!0,this._startHandler=null,this._endHandler=null,this._startHandlerText=null,this._endHandlerText=null,this._currentHandler=null,this._currentValue={},this._onTooltipShow=t=>{this._isChanging||this._tooltipState&&this._tooltipState.isActive||(this._tooltipState?this._tooltipState.isActive=!0:this._tooltipState={isActive:!0},this._onTooltipUpdate(t),this._dispatchTooltipEvent("sliderTooltipShow"))},this._onTooltipUpdate=t=>{if(this._isChanging||!this._tooltipState||!this._tooltipState.isActive)return;let e=this._isHorizontal?this._rail.globalAABBBounds.width():this._rail.globalAABBBounds.height(),i=(0,yj.Z)(this._isHorizontal?(t.viewX-this._rail.globalAABBBounds.x1)/e:(t.viewY-this._rail.globalAABBBounds.y1)/e,0,1);i!==this._tooltipState.pos&&(this._tooltipState.pos=i,this._tooltipState.value=this.calculateValueByPos(i*e),this._updateTooltip(),this._dispatchTooltipEvent("sliderTooltipUpdate"))},this._onTooltipHide=()=>{let{tooltip:t}=this.attribute;t&&t.alwaysShow||(this._tooltipState=null,this._tooltipShape&&this._tooltipShape.setAttribute("visible",!1),this._tooltipText&&this._tooltipText.setAttribute("visible",!1),this._dispatchTooltipEvent("sliderTooltipHide"))},this._onHandlerPointerdown=t=>{this._clearAllDragEvents(),this._isChanging=!0;let{x:e,y:i}=this.stage.eventPointTransform(t);this._currentHandler=t.target,this._prePos=this._isHorizontal?e:i;let r=IR(),n="browser"===hd.env?hd:this.stage;n.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),r.forEach(t=>{n.addEventListener(t,this._onHandlerPointerUp)})},this._onHandlerPointerMove=t=>{var e,i;this._isChanging=!0;let{railWidth:r,railHeight:n,min:l,max:s}=this.attribute;if(s===l)return;let{x:a,y:o}=this.stage.eventPointTransform(t),h,d,u,c=0;this._isHorizontal?(c=(h=a)-this._prePos,d=null==(i=this._currentHandler)?void 0:i.attribute.x,u=r):(c=(h=o)-this._prePos,d=null==(e=this._currentHandler)?void 0:e.attribute.y,u=n);let p=(0,yj.Z)(d+c,0,u),g=this.calculateValueByPos(p);"text"===this._currentHandler.type?this._updateHandlerText(this._currentHandler,p,g):this._updateHandler(this._currentHandler,p,g),this._updateTrack(),this._prePos=h,this._dispatchChangeEvent()},this._onHandlerPointerUp=t=>{this._isChanging=!1,this._currentHandler=null,this._clearAllDragEvents()},this._handleTouchMove=t=>{this._isChanging&&t.preventDefault()},this._onTrackPointerdown=t=>{this._clearAllDragEvents(),this._isChanging=!0;let{x:e,y:i}=this.stage.eventPointTransform(t);this._prePos=this._isHorizontal?e:i;let r=IR(),n="browser"===hd.env?hd:this.stage;n.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),r.forEach(t=>{n.addEventListener(t,this._onTrackPointerUp)})},this._onTrackPointerMove=t=>{let e,i,r;this._isChanging=!0;let{railWidth:n,railHeight:l,min:s,max:a,inverse:o}=this.attribute;if(a===s)return;let{startHandler:h,endHandler:d}=this._getHandlers(),{x:u,y:c}=this.stage.eventPointTransform(t);this._isHorizontal?(e=u,i=this._track.attribute.width,r=n):(e=c,i=this._track.attribute.height,r=l);let p=e-this._prePos;if(h){let t=this._isHorizontal?h.attribute.x:h.attribute.y,e=o?(0,yj.Z)(t+p,i,r):(0,yj.Z)(t+p,0,r-i),n=this.calculateValueByPos(e);this._updateHandler(h,e,n)}if(d){let t=this._isHorizontal?d.attribute.x:d.attribute.y,e=o?(0,yj.Z)(t+p,0,r-i):(0,yj.Z)(t+p,i,r),n=this.calculateValueByPos(e),l=null==h?void 0:h.attribute;this._updateHandler(d,e,n),this._track.setAttributes(this._isHorizontal?{x:Math.min(l.x,d.attribute.x),width:Math.abs(l.x-d.attribute.x)}:{y:Math.min(l.y,d.attribute.y),height:Math.abs(l.y-d.attribute.y)})}this._prePos=e,this._dispatchChangeEvent()},this._onTrackPointerUp=t=>{this._isChanging=!1,this._clearAllDragEvents()},this._onRailPointerDown=t=>{let e,i,r;this._clearAllDragEvents(),this._isChanging=!0;let{railWidth:n,railHeight:l,min:s,max:a}=this.attribute;if(a===s)return;let o=this._startHandler,h=this._endHandler;this._isHorizontal?(e=t.viewX-this._rail.globalAABBBounds.x1,i=null==o?void 0:o.attribute.x,r=null==h?void 0:h.attribute.x):(e=t.viewY-this._rail.globalAABBBounds.y1,i=null==o?void 0:o.attribute.y,r=null==h?void 0:h.attribute.y);let d=this.calculateValueByPos(e);if((0,aw.Z)(r)){let t=Math.abs(e-i)>Math.abs(e-r)?h:o;this._updateHandler(t,e,d)}else this._updateHandler(o,e,d);this._updateTrack(),this._dispatchChangeEvent()}}calculatePosByValue(t,e){let{layout:i,railWidth:r,railHeight:n,min:l,max:s,inverse:a}=this.attribute,o=0;return o=l===s?"start"===e?0:+("end"===e):(t-l)/(s-l),(a?1-o:o)*("vertical"===i?n:r)}calculateValueByPos(t){let{layout:e,railWidth:i,railHeight:r,min:n,max:l,inverse:s}=this.attribute,a="vertical"===e?r:i;return n+(l-n)*(s?1-t/a:t/a)}setValue(t){let{min:e,max:i}=this.attribute;if(i===e)return;let[r,n]=(0,a1.IX)(t),{startHandler:l,endHandler:s}=this._getHandlers();l&&this._updateHandler(l,this.calculatePosByValue(r),r),s&&this._updateHandler(s,this.calculatePosByValue(n),n),this._updateTrack()}render(){var t,e;let i;this.removeAllChild(!0);let{layout:r="horizontal",railWidth:n,railHeight:l,startText:s,endText:a,min:o,max:h,showHandler:d=!0,showTooltip:u}=this.attribute,{value:c}=this.attribute;(0,nB.Z)(c)&&(c=[o,h]),this._currentValue={startValue:ED(c)[0],endValue:ED(c)[1]};let p="horizontal"===r;this._isHorizontal=p;let g=ak.group({x:0,y:0});g.name=ek.innerView,this.add(g),this._innerView=g;let f,m=0;if(s&&s.visible){(f=ak.text(Object.assign({x:p?0:n/2,y:p?l/2:0,textAlign:p?"start":"center",textBaseline:p?"middle":"top",text:s.text,lineHeight:null==(t=s.style)?void 0:t.fontSize},s.style))).name=ek.startText,g.add(f);let e=(0,aw.Z)(s.space)?s.space:0;m+=(p?f.AABBBounds.width():f.AABBBounds.height())+e}let y=ak.group({x:p?m:0,y:p?0:m});g.add(y);let v=ak.group({x:0,y:0});if(v.name=ek.railContainer,this._railContainer=v,y.add(v),this._mainContainer=y,this._renderRail(v),m+=p?n:l,a&&a.visible){let t=(0,aw.Z)(a.space)?a.space:0;(i=ak.text(Object.assign({x:p?m+t:n/2,y:p?l/2:m+t,textAlign:p?"start":"center",textBaseline:p?"middle":"top",text:a.text,lineHeight:null==(e=a.style)?void 0:e.fontSize},a.style))).name=ek.endText,g.add(i)}this._renderTrack(v),d&&(this._renderHandlers(y),this._bindEvents()),u&&(this._renderTooltip(),this._bindTooltipEvents())}_renderRail(t){let{railWidth:e,railHeight:i,railStyle:r,slidable:n}=this.attribute,l="default";!1!==n&&(l="pointer");let s=ak.rect(Object.assign({x:0,y:0,width:e,height:i,cursor:l},r));return s.name=ek.rail,t.add(s),this._rail=s,s}_renderHandlers(t){let{range:e,min:i,max:r,handlerSize:n=14,handlerStyle:l,handlerText:s,railHeight:a,railWidth:o,slidable:h}=this.attribute,{value:d}=this.attribute;(0,nB.Z)(d)&&(d=[i,r]);let u=s&&s.visible,c=this._isHorizontal,[p,g]=ED(d),f=this.calculatePosByValue(p,e?"start":"end"),m=this._renderHandler(Object.assign({x:c?f:o/2,y:c?a/2:f,size:n,strokeBoundsBuffer:0,cursor:!1===h?"default":Ez(c)},l));if(m.name=ek.startHandler,this._startHandler=m,t.add(m),this._currentValue.startPos=f,u){let i=this._renderHandlerText(p,e?"start":"end");i.name=ek.startHandlerText,t.add(i),this._startHandlerText=i}if(e){let e=this.calculatePosByValue(g,"end"),i=this._renderHandler(Object.assign({x:c?e:o/2,y:c?a/2:e,size:n,strokeBoundsBuffer:0,cursor:!1===h?"default":Ez(c)},l));if(i.name=ek.endHandler,this._endHandler=i,t.add(i),this._currentValue.endPos=e,u){let e=this._renderHandlerText(g,"end");e.name=ek.endHandlerText,t.add(e),this._endHandlerText=e}}}_renderTrack(t){let e,i,r,{range:n,min:l,max:s,railHeight:a,railWidth:o,trackStyle:h,railStyle:d,slidable:u,value:c}=this.attribute;if((0,nB.Z)(c))n?(e=l,i=s):e=i=l;else if(n){let t=(0,Ik.Z)(c,l,s);e=t[0],i=t[1]}else e=l,i=(0,yj.Z)(c,l,s);let p=this._isHorizontal;n||(e=l);let g=ak.group({x:0,y:0,width:o,height:a,cornerRadius:null==d?void 0:d.cornerRadius,clip:!0,pickable:!1});g.name=ek.trackContainer;let f=(0,nF.Z)(n)&&!0===n.draggableTrack;r=!1===u?"default":!1===n||!1===f?"pointer":Ez(p);let m=this.calculatePosByValue(e,"start"),y=this.calculatePosByValue(i,n?"end":"start"),v=ak.rect(Object.assign({x:p?Math.min(m,y):0,y:p?0:Math.min(m,y),width:p?Math.abs(y-m):o,height:p?a:Math.abs(y-m),cursor:r},h));v.name=ek.track,this._track=v,g.add(v),t.add(g)}_renderHandler(t){return ak.symbol(t)}_renderHandlerText(t,e){var i,r,n;let{align:l,handlerSize:s=14,handlerText:a={},railHeight:o,railWidth:h,slidable:d}=this.attribute,u=this._isHorizontal,c=this.calculatePosByValue(t,e),p=null!=(i=a.space)?i:4,g={text:a.formatter?a.formatter(t):t.toFixed(null!=(r=a.precision)?r:0),lineHeight:null==(n=a.style)?void 0:n.lineHeight,cursor:!1===d?"default":Ez(u)};return u?"top"===l?(g.textBaseline="bottom",g.textAlign="center",g.x=c,g.y=(o-s)/2-p):(g.textBaseline="top",g.textAlign="center",g.x=c,g.y=(o+s)/2+p):("left"===l?(g.textBaseline="middle",g.textAlign="end",g.x=(h-s)/2-p):(g.textBaseline="middle",g.textAlign="start",g.x=(h+s)/2+p),g.y=c),ak.text(Object.assign(Object.assign({},g),a.style))}_renderTooltip(){var t;let{tooltip:e,railHeight:i,railWidth:r,align:n}=this.attribute;e&&e.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;let l=this._isHorizontal?0:r/2,s=this._isHorizontal?i/2:0;if(e&&e.shape){let t=ak.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:l,y:s,symbolType:"circle"},e.shapeStyle));this._tooltipShape=t,this._mainContainer.add(t)}let a=e&&e.text||{},o=null!=(t=a.space)?t:6,h={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(h.x=l,h.y="top"===n?s-i/2-o:s+i/2+o,h.textAlign="center",h.textBaseline="top"===n?"bottom":"top"):(h.y=s,h.x="left"===n?l-r/2-o:s+r/2+o,h.textAlign="left"===n?"end":"start",h.textBaseline="middle");let d=ak.text(Object.assign(Object.assign({},h),a.style));this._mainContainer.add(d),this._tooltipText=d,this._tooltipState&&this._updateTooltip()}_updateTooltip(){var t,e;if(!this._tooltipShape&&!this._tooltipText||!this._tooltipState)return;let{railWidth:i,railHeight:r}=this.attribute,n=this._isHorizontal?i:r,l=this._tooltipState.pos*n,s=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes({visible:!0,[s]:l});let{align:a}=this.attribute;if(this._tooltipText){let i=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes({visible:!0,[s]:l,text:i.formatter?i.formatter(this._tooltipState.value):this._isHorizontal||"left"!==a?`≈ ${this._tooltipState.value.toFixed(null!=(e=i.precision)?e:0)}`:`${this._tooltipState.value.toFixed(null!=(t=i.precision)?t:0)} ≈`})}}_bindEvents(){if(this.attribute.disableTriggerEvent)return;let{slidable:t,range:e}=this.attribute;t&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),(0,nF.Z)(e)&&e.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown),("browser"===hd.env?hd:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}))}_bindTooltipEvents(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}_clearAllDragEvents(){let t=IR(),e="browser"===hd.env?hd:this.stage;e.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),t.forEach(t=>{e.removeEventListener(t,this._onHandlerPointerUp)}),e.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),t.forEach(t=>{e.removeEventListener(t,this._onTrackPointerUp)})}_updateTrack(){let{inverse:t,railWidth:e,railHeight:i}=this.attribute,r=this._startHandler,n=this._endHandler;if(this._isHorizontal){let i=null==r?void 0:r.attribute.x;if(n){let t=null==n?void 0:n.attribute.x;this._track.setAttributes({x:Math.min(i,t),width:Math.abs(i-t)})}else t?this._track.setAttributes({x:i,width:e-i}):this._track.setAttributes({width:i})}else{let e=null==r?void 0:r.attribute.y;if(n){let t=null==n?void 0:n.attribute.y;this._track.setAttributes({y:Math.min(e,t),height:Math.abs(e-t)})}else t?this._track.setAttributes({y:e,height:i-e}):this._track.setAttributes({height:e})}}_updateHandler(t,e,i){var r;let n=this._isHorizontal;t.setAttribute(n?"x":"y",e);let l=t.name===ek.startHandler?this._startHandlerText:this._endHandlerText;if(l){let{handlerText:t={}}=this.attribute;l.setAttributes({text:t.formatter?t.formatter(i):i.toFixed(null!=(r=t.precision)?r:0),[n?"x":"y"]:e})}t.name===ek.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_updateHandlerText(t,e,i){var r;let n=this._isHorizontal,{handlerText:l={}}=this.attribute;t.setAttributes({[n?"x":"y"]:e,text:l.formatter?l.formatter(i):i.toFixed(null!=(r=l.precision)?r:0)});let s=t.name===ek.startHandlerText?this._startHandler:this._endHandler;s&&s.setAttributes({[n?"x":"y"]:e}),t.name===ek.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_dispatchChangeEvent(){let t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}_dispatchTooltipEvent(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}_getHandlers(){let{inverse:t}=this.attribute,e=this._startHandler,i=this._endHandler;return i&&(this._isHorizontal?(!t&&i.attribute.x<(null==e?void 0:e.attribute.x)||t&&i.attribute.x>(null==e?void 0:e.attribute.x))&&([e,i]=[i,e]):(!t&&i.attribute.y<(null==e?void 0:e.attribute.y)||t&&i.attribute.y>(null==e?void 0:e.attribute.y))&&([e,i]=[i,e])),{startHandler:e,endHandler:i}}release(t){super.release(t),("browser"===hd.env?hd:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearAllDragEvents()}}EW.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}},EM(),EA();class EZ extends EC{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},EZ.defaultAttributes,t)),this.name="colorLegend",this._onSliderToolipChange=t=>{let e=this._slider.tooltipShape;if(e&&t.detail&&!(0,nB.Z)(t.detail.value)){let i=this._colorScale.scale(t.detail.value);e.setAttribute("fill",i)}this.dispatchEvent(t)},this._onSliderChange=t=>{this._updateColor(),this.dispatchEvent(t)}}setSelected(t){this._slider&&(this._slider.setValue(t),this._updateColor())}_renderContent(){let{colors:t,slidable:e,layout:i,align:r,min:n,max:l,value:s,railWidth:a,railHeight:o,showHandler:h=!0,handlerSize:d,handlerStyle:u,railStyle:c,trackStyle:p,startText:g,endText:f,handlerText:m,showTooltip:y,tooltip:v,inverse:b,disableTriggerEvent:_}=this.attribute,C=[],x=(l-n)/(t.length-1);for(let e=0;e<t.length;e++)C.push(n+x*e);this._colorScale=(new pM.f).domain(C,!0).range(t),this._color=this._getTrackColor();let w=new EW({x:0,y:0,range:{draggableTrack:!0},slidable:e,layout:i,align:r,min:n,max:l,value:s,railWidth:a,railHeight:o,showHandler:h,handlerSize:d,handlerStyle:u,railStyle:c,trackStyle:Object.assign({fill:this._color},p),startText:g,endText:f,handlerText:m,showTooltip:y,tooltip:v,disableTriggerEvent:_,inverse:b});this._innerView.add(w),this._slider=w,w.translateTo(0-w.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+(0,dx.Z)(this.attribute,"title.space",12):0)-w.AABBBounds.y1),this._updateColor()}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}_getTrackColor(){let{colors:t,layout:e,inverse:i}=this.attribute;if((0,uF.Z)(t))return;let r=t.length;if(1===r)return t[0];let n=[];for(let e=0;e<r;e++){let i=e/(r-1);n.push({offset:i,color:t[e]})}let l="horizontal"===e,s={gradient:"linear",stops:n,x0:0,y0:0,x1:+!!l,y1:+!l};return i&&(l?(s.x0=1,s.x1=0):(s.y0=1,s.y1=0)),s}_updateColor(){var t;let{layout:e="horizontal",colors:i,railWidth:r,railHeight:n}=this.attribute,{startHandler:l,endHandler:s,track:a,attribute:o}=this._slider,{startValue:h,endValue:d,startPos:u,endPos:c}=this._slider.currentValue,p=null==(t=o.handlerStyle)?void 0:t.fill;if(l&&!p){let t=this._colorScale.scale(h);l.setAttribute("fill",t)}if(s&&!p){let t=this._colorScale.scale(d);s.setAttribute("fill",t)}let g="horizontal"===e?r:n;if(Math.abs(u-c)!==g&&i&&i.length>1){let t=this._color.stops,e=Math.min(u,c)/g,i=Math.max(u,c)/g,r=i-e,n=t.filter(t=>t.offset>e&&t.offset<i),l=Math.min(h,d),s=Math.max(h,d),o=this._colorScale.scale(l),p=this._colorScale.scale(s),f=[{offset:0,color:o}];n.forEach(t=>{f.push({offset:(t.offset-e)/r,color:t.color})}),f.push({offset:1,color:p}),a.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:f}))}}}EZ.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}},EM(),EA(),wD();class EN extends EC{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},EN.defaultAttributes,t)),this.name="sizeLegend",this._onSliderChange=t=>{this.dispatchEvent(t)},this._onSliderToolipChange=t=>{this.dispatchEvent(t)}}setSelected(t){this._slider&&this._slider.setValue(t)}_renderContent(){let{slidable:t,layout:e,align:i,min:r,max:n,value:l,railWidth:s,railHeight:a,showHandler:o=!0,handlerSize:h,handlerStyle:d,railStyle:u,trackStyle:c,startText:p,endText:g,handlerText:f,showTooltip:m,tooltip:y,sizeBackground:v,disableTriggerEvent:b,inverse:_}=this.attribute,C=ak.group({x:0,y:0});this._innerView.add(C);let x=new EW({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:t,layout:e,align:i,min:r,max:n,value:l,railWidth:s,railHeight:a,showHandler:o,handlerSize:h,handlerStyle:Object.assign({symbolType:function(t="bottom"){let e=0;return"top"===t?`
    M${e},-6L${e-3.5},-2.5
    v5
    h7
    v-5
    Z
`:"left"===t?(e=1,`
    M${e-6},0L${e-6+2.5},-3.5
    h5
    v7
    h-5
    Z
`):"right"===t?(e=-1,`
    M${e+6},0L${e+6-2.5},-3.5
    h-5
    v7
    h5
    Z
  `):`
    M${e},6L${e-3.5},2.5
    v-5
    h7
    v5
    Z
`}(i)},d),railStyle:u,trackStyle:c,startText:p,endText:g,handlerText:f,showTooltip:m,tooltip:y,disableTriggerEvent:b,inverse:_});C.add(x);let w,S=0;"horizontal"===e?"top"===i?(w=`M0,0L${s},0L${_?0:s},12Z`,S=a):(w=`M0,12L${s},12L${_?0:s},0Z`,x.setAttribute("y",12)):"left"===i?w=`M${s},0L${s+12},${_?0:a}L${s},${a}Z`:(w=`M0,${_?0:a}L12,${a}L12,0Z`,x.setAttribute("x",12));let A=ak.path(Object.assign(Object.assign({x:0,y:S,path:w},v),{zIndex:0}));C.add(A);let M=this._title?this._title.AABBBounds.height()+(0,dx.Z)(this.attribute,"title.space",12):0;C.translate(0-C.AABBBounds.x1,M-C.AABBBounds.y1),this._slider=x}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}EN.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}};var Ej=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let EG={color:EZ,size:EN},EV={orient:"right",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"primaryFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},endText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},handlerText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6}},EU=t=>{let e={width:200,height:8,style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=8):(e.width=8,e.height=200),Object.assign(Object.assign({},EV),{rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:"#ffffff"},shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"}}}})},EK={horizontal:EU(!0),vertical:EU(!1)},EX=t=>{let e={style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=4):(e.height=200,e.width=4),Object.assign(Object.assign({},EV),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:{type:"palette",key:"sliderTrackColor"}},fill:{type:"palette",key:"sliderHandleColor"}}}})},EY={horizontal:EX(!0),vertical:EX(!1)},E$=["#C4E7FF","#98CAFF","#75ACFF","#518FF9","#2775DC","#005CBE","#00429F","#00287E"],Eq=[2,10];class EJ extends EI{static getSpecInfo(t){let e=bW(t,this.specKey,this.type,t=>{var e;return"color"===(e=t.type)||"size"===e});return e&&e.forEach(t=>{t.type="color"===t.spec.type?oQ.colorLegend:oQ.sizeLegend}),e}constructor(t,e){super(t,e),this.type=oQ.colorLegend,this.name=oQ.colorLegend;let i="color"===this._spec.type?oQ.colorLegend:oQ.sizeLegend;this.type=i,this.name=i}setAttrFromSpec(){super.setAttrFromSpec(),this._field=this._spec.field,this._legendType=this._spec.type}init(t){super.init(t),C$(this._regions,t=>{t.addViewDataFilter({type:"continuousLegendFilter",options:{selected:()=>this._selectedData,field:()=>this._field,data:()=>this._legendData.getLatestData(),isHierarchyData:t.isHierarchyData,customFilter:this._spec.customFilter},level:ti.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_getScaleInGlobal(){let t=this._option.globalScale,e=this._spec.scale;return e||(e=this._legendType),t.getScale(e)}_initLegendData(){dL(this._option.dataSet,"continuousLegendFilter",EH),dL(this._option.dataSet,"continuousLegendDataMake",EO);let t=new eq.V(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return t.transform({type:"continuousLegendDataMake",options:{series:()=>Cq(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}),field:()=>this._field,scale:this._getScaleInGlobal.bind(this)}}),t}_initSelectedData(){this._spec.defaultSelected?this._selectedData=this._spec.defaultSelected.slice():this._selectedData=this._legendData.getLatestData()}_addDefaultTitleText(t){var e,i,r,n;if((null==(e=t.title)?void 0:e.visible)&&(0,nB.Z)(t.title.text)&&(0,nB.Z)(null==(i=t.title.style)?void 0:i.text)){let e=this._field;if(e){let i=null==(n=null==(r=this._regions)?void 0:r[0])?void 0:n.getSeries()[0];if(!i)return;return void(t.title.text=bT(i.getRawData(),e))}let i=this._spec.scale;i||(i=this._legendType);let l=this._option.globalScale.getScaleSpec(i);if(!hb(null==l?void 0:l.domain))return;let s=l.domain[0];if(0===s.fields.length)return;t.title.text=bT(this._option.dataSet.getDataView(s.dataId),s.fields[0])}}_getLegendAttributes(t){var e,i;let r="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",n="horizontal"===r?"bottom":this.layoutOrient,l=[],s=this._getScaleInGlobal();s&&"linear"===s.type&&(l=s.range()),(0,uF.Z)(l)&&(l="color"===this._legendType?E$:Eq);let a=null!=(e=this._legendData.getLatestData()[0])?e:0,o=null!=(i=this._legendData.getLatestData()[1])?i:1;this._legendData.getLatestData()[0]===this._legendData.getLatestData()[1]&&(a=Math.min(0,this._legendData.getLatestData()[0]),o=0===this._legendData.getLatestData()[0]?1:Math.max(0,this._legendData.getLatestData()[0]));let h=Object.assign({layout:r,align:n,zIndex:this.layoutZIndex,min:a,max:o,value:this._spec.defaultSelected,["color"===this._legendType?"colors":"sizeRange"]:l},function(t){let e=h5({},t),{title:i={},handler:r={},rail:n={},track:l={},startText:s,endText:a,handlerText:o,sizeBackground:h,background:d={},type:u,id:c,visible:p,orient:g,position:f,data:m,defaultSelected:y,field:v,filter:b,regionId:_,regionIndex:C,seriesIndex:x,seriesId:w,padding:S}=e,A=Ej(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible?A.title=Eb(i):A.title={visible:!1},A.showHandler=!1!==r.visible,(0,uF.Z)(r.style)||(A.handlerStyle=xg(r.style)),(0,aw.Z)(n.width)&&(A.railWidth=n.width),(0,aw.Z)(n.height)&&(A.railHeight=n.height),(0,uF.Z)(n.style)||(A.railStyle=xg(n.style)),(0,uF.Z)(l.style)||(A.trackStyle=xg(l.style)),A.startText=xu(s),A.endText=xu(a),A.handlerText=xu(o),(0,uF.Z)(h)||(A.sizeBackground=xg(h)),d.visible&&!(0,uF.Z)(d.style)&&(h5(A,d.style),(0,aw.Z)(d.padding)&&(A.padding=d.padding)),A}(this._spec));return this._addDefaultTitleText(h),h}_getLegendConstructor(){return EG[this._legendType]}_initEvent(){if(this._legendComponent){let t=!1!==this._spec.filter;this._legendComponent.addEventListener("change",(0,dS.Z)(e=>{let i=(0,dx.Z)(e,"detail.value");t&&this.setSelectedData(i),this.event.emit(J.legendFilter,{model:this,value:i,event:e})},30))}}}EJ.specKey="legends",EJ.builtInTheme={colorLegend:EK,sizeLegend:EY},EJ.type=oQ.continuousLegend;let EQ=()=>{h9.registerComponent(EJ.type,EJ)},E0=(t,e)=>(0,aw.Z)(e)?t.map(t=>e[t]):void 0,E1=(t,e)=>i=>t.every((t,r)=>i[t]===(null==e?void 0:e[r])),E2=t=>!(0,nB.Z)(t)&&((0,rD.Z)(t)?t.length>0&&t.every(aw.Z):Object.keys(t).length>0),E3=(t,e)=>{let i=e.getSeries(),r=[];return i.forEach(e=>{var i,n,l,s,a,o,h;let d=e.getDimensionField(),u=e.getMeasureField(),c=e.getSeriesField(),p=(0,aw.Z)(c)?t[c]:void 0,g=(0,aw.Z)(c)&&null!=(s=null==(l=null==(n=null==(i=e.getViewDataStatistics)?void 0:i.call(e))?void 0:n.latestData[c])?void 0:l.values)?s:[],f=E0(d,t),m=E0(u,t),y=E2(m),v=!y&&(0,aw.Z)(c)&&(0,nB.Z)(p)&&g.length>0,b=()=>{var t;let i=null==(t=e.getViewData())?void 0:t.latestData.find(E1(d,f));if(!y&&!E2(m=E0(u,i)))return;let n=e.type===Y.pie?e.dataToCentralPosition(i):e.dataToPosition(i);(0,nB.Z)(n)||isNaN(n.x)||isNaN(n.y)||r.push({pos:n,data:{dimensionFields:d,dimensionData:f,measureFields:u,measureData:m,hasMeasureData:y,groupField:c,groupData:p},series:e})};if("cartesian"===e.coordinate){let t=(0,pW.lK)(null==(o=null==(a=e.getYAxisHelper())?void 0:a.getScale(0))?void 0:o.type)?"y":"x",i=d.map((t,e)=>[t,e]).filter(([,t])=>(0,nB.Z)(null==f?void 0:f[t])),n=[null!=f?f:[]];i.length>0&&i.forEach(([t,i])=>{var r,l,s,a;let o=null!=(a=null==(s=null==(l=null==(r=e.getViewDataStatistics)?void 0:r.call(e))?void 0:l.latestData[t])?void 0:s.values)?a:[],h=[];n.forEach(t=>{o.forEach(e=>{var r;let n=null!=(r=null==t?void 0:t.slice())?r:[];n[i]=e,h.push(n)})}),n=h}),n.forEach(i=>{var n,l;if(v){let l=null==(n=e.getViewData())?void 0:n.latestData.filter(E1(d,i));g.forEach(n=>{let s=l.find(t=>t[c]===n);if(!E2(m=E0(u,s)))return;let a=e.dataToPosition(s);(0,nB.Z)(a)||isNaN(a.x)||isNaN(a.y)||r.push({pos:a,data:{dimensionFields:d,dimensionData:i,measureFields:u,measureData:m,hasMeasureData:y,groupField:c,groupData:n},series:e,dimType:t})})}else{let n=null==(l=e.getViewData())?void 0:l.latestData.find(E1(d,i));if(!y&&!E2(m=E0(u,n)))return;let s=e.dataToPosition(n);if((0,nB.Z)(s)||isNaN(s.x)||isNaN(s.y))return;r.push({pos:s,data:{dimensionFields:d,dimensionData:i,measureFields:u,measureData:m,hasMeasureData:y,groupField:c,groupData:p},dimType:t,series:e})}})}else if("polar"===e.coordinate)if(e.type===Y.pie)b();else if(v){let t=(null==(h=e.getViewData())?void 0:h.latestData.filter(E1(d,f))).find(t=>t[c]===p);g.forEach(i=>{if(!E2(m=E0(u,t)))return;let n=e.dataToPosition(t);(0,nB.Z)(n)||isNaN(n.x)||isNaN(n.y)||r.push({pos:n,data:{dimensionFields:d,dimensionData:f,measureFields:u,measureData:m,hasMeasureData:y,groupField:c,groupData:i},series:e})})}else b();else"geo"===e.coordinate&&b()}),r},E5=t=>(0,aw.Z)(t)&&!(0,rD.Z)(t),E4=t=>(0,aw.Z)(t)&&(0,rD.Z)(t);class E6 extends xz{_shouldMergeThemeToSpec(){return!1}_initTheme(t,e){var i,r,n;let{spec:l,theme:s}=super._initTheme(t,e);return l.style=h5({},this._theme,l.style),l.offset=h5({},s.offset,t.offset),l.transitionDuration=null!=(i=t.transitionDuration)?i:s.transitionDuration,l.trigger=null!=(r=t.trigger)?r:s.trigger,l.triggerOff=null!=(n=t.triggerOff)?n:s.triggerOff,{spec:l,theme:s}}_transformSpecAfterMergingTheme(t,e,i){var r,n,l,s,a,o,h;super._transformSpecAfterMergingTheme(t,e,i),t.visible=null==(r=t.visible)||r,t.activeType=bG(t),t.renderMode=null!=(n=t.renderMode)?n:hL(this._option.mode)||!hI(this._option.mode)?"canvas":"html",t.trigger=null!=(l=t.trigger)?l:"hover",t.className=null!=(s=t.className)?s:"vchart-tooltip-element",t.enterable=null!=(a=t.enterable)&&a,t.transitionDuration=null!=(o=t.transitionDuration)?o:150,t.confine=null!=(h=t.confine)?h:"canvas"===t.renderMode,(0,aw.Z)(t.parentElement)?(0,nI.Z)(t.parentElement)&&(t.parentElement=hd.getElementById(t.parentElement)):hI(this._option.mode)&&(t.parentElement=null==hB?void 0:hB.body)}}class E7 extends xZ{constructor(){super(...arguments),this.layoutZIndex=1,this.type=oQ.tooltip,this.name=oQ.tooltip,this.transformerConstructor=E6,this.specKey="tooltip",this.layoutType="none",this._isReleased=!1,this.enable=!0,this._alwaysShow=!1,this._eventList=[],this._isTooltipShown=!1,this._clickLock=!1,this._mountEvent=(t,e,i)=>{this.event.on(t,e,i),this._eventList.push({eventType:t,handler:i})},this._handleClickToLock=t=>{var e,i;if(this._clickLock)this._handleChartMouseOut(t),this._clickLock=!1;else{if(!this._isTooltipShown&&!(null==(i=null==(e=this.tooltipHandler)?void 0:e.isTooltipShown)?void 0:i.call(e)))return;this._clickLock=!0}},this._getMouseOutHandler=t=>e=>{var i,r,n,l,s;if(this._isReleased||this._alwaysShow||this._clickLock||!this._isTooltipShown&&!(null==(r=null==(i=this.tooltipHandler)?void 0:i.isTooltipShown)?void 0:r.call(i)))return;let a=hI(null==(n=this._option)?void 0:n.mode),{clientX:o,clientY:h}=e.event;a&&t&&this._isPointerInChart({x:o,y:h})||(this._enterable?this._outTimer=setTimeout(()=>{this._handleChartMouseOut(e)},null!=(s=null==(l=this._spec)?void 0:l.showDelay)?s:50):this._handleChartMouseOut(e))},this._handleChartMouseOut=t=>{var e;this._cacheActiveType&&(null==(e=this._option)?void 0:e.componentShowContent)&&(!1===this._option.componentShowContent.tooltip||(0,nF.Z)(this._option.componentShowContent.tooltip)&&!1===this._option.componentShowContent.tooltip[this._cacheActiveType])||this._alwaysShow||this._isReleased||this._isEnterTooltip||"none"!==this._spec.triggerOff&&(this._hideTooltipByHandler(Object.assign(Object.assign({},t),{tooltip:this})),this._handleMouseMove&&this._handleMouseMove.cancel&&this._handleMouseMove.cancel(),this._cacheEnterableRect=null,this._cacheInfo=void 0,this._cacheParams=void 0,this._cacheActiveType=void 0)},this._getMouseMoveHandler=t=>e=>{var i,r,n,l;this._isReleased||this._isEnterTooltip||(this._outTimer&&(clearTimeout(this._outTimer),this._outTimer=null),this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),this._alwaysShow||(this._clickLock?t&&(this._handleChartMouseOut(e),this._clickLock=!1):!t&&this._enterable&&(null==(r=null==(i=this.tooltipHandler)?void 0:i.isTooltipShown)?void 0:r.call(i))?(this._showTimer&&clearTimeout(this._showTimer),this._showTimer=setTimeout(()=>{this._handleChartMouseMove(e,t)},null!=(l=null==(n=this._spec)?void 0:n.showDelay)?l:50)):this._handleChartMouseMove(e,t)))},this._handleChartMouseMove=(t,e)=>{if(this._isReleased)return;let i=this._getMouseEventData(t),{tooltipInfo:{dimension:r},ignore:{mark:n}}=i,l={mark:!1,dimension:!1,group:!1},s=["group","mark","dimension"];for(let r=0,n=s.length;r<n;r++){let n=s[r],a=!!this.processor[n]&&this._showTooltipByMouseEvent(n,i,t,e);if("unShowByOption"===a)l[n]="unShowByOption";else if(a){l[n]=!0;break}}Object.values(l).every(t=>!t)&&!((0,nB.Z)(t.mark)&&(0,nB.Z)(t.model)&&(0,nB.Z)(t.datum))&&(n&&E5(this._cacheInfo)?l.mark=this._showTooltipByMouseEvent("mark",i,t,e,!0):(0,aw.Z)(r)&&(l.dimension=this._showTooltipByMouseEvent("dimension",i,t,e))),!0!==l.mark&&!0!==l.group&&(!0!==l.dimension||(0,nB.Z)(r))?this._cacheActiveType&&"unShowByOption"===l[this._cacheActiveType]||this._handleChartMouseOut(t):this._initEventOfTooltipContent()},this._showTooltipByMouseEvent=(t,e,i,r,n)=>{var l;let s;if(!this._showContentByEvent(t))return"unShowByOption";let a=this.processor[t];if(!a.shouldHandleTooltip(i,e.tooltipInfo[t]))return!1;if(this._hideTimer&&clearTimeout(this._hideTimer),n)s=!a.showTooltip(this._cacheInfo,i,!0);else{let r=e.tooltipInfo[t],n=this._isSameAsCache(r,i,t);(s=!a.showTooltip(r,i,n))&&(this._cacheInfo=r,this._cacheParams=i,this._cacheActiveType=t)}s&&(this._isTooltipShown=!0,r&&this._spec.lockAfterClick&&!this._clickLock?this._clickLock=!0:Number.isFinite(this._spec.hideTimer)&&(this._hideTimer=setTimeout(()=>{this._handleChartMouseOut()},this._spec.hideTimer)));let o=null==(l=this._option)?void 0:l.globalInstance;return s&&bg.globalConfig.uniqueTooltip&&o&&bg.hideTooltip(o.id),s},this._getMouseEventData=t=>{let e={tooltipInfo:{},ignore:{}};return Object.keys(this.processor).forEach(i=>{let{tooltipInfo:r,ignore:n}=this.processor[i].getMouseEventData(t);e.tooltipInfo[i]=r,e.ignore[i]=n}),e},this._hideTooltipByHandler=t=>{var e,i,r;if(!this._isTooltipShown&&!(null==(i=null==(e=this.tooltipHandler)?void 0:e.isTooltipShown)?void 0:i.call(e)))return 0;this.event.emit(J.tooltipHide,Object.assign(Object.assign({},t),{source:Q.chart,tooltip:this})),Object.values(this.processor).forEach(t=>{t.clearCache()});let n=null!=(r=this._spec.handler)?r:this.tooltipHandler;if(n.hideTooltip){let e=n.hideTooltip.call(n,t);return e||(this._isTooltipShown=!1),e}return 1},this.hideTooltip=()=>{if(this._isReleased)return!1;let t={changePositionOnly:!1,tooltip:this,item:void 0,datum:void 0,source:Q.chart};return this._alwaysShow=!1,!this._hideTooltipByHandler(t)}}isTooltipShown(){return this._isTooltipShown}_registerEvent(){}_releaseEvent(){}onLayoutEnd(){}created(){super.created(),this._regions=this._option.getAllRegions(),this._initEvent()}release(){var t,e;super.release(),this._isReleased=!0,this._hideTimer&&clearTimeout(this._hideTimer),this._eventList.forEach(({eventType:t,handler:e})=>{this.event.off(t,e)}),this._eventList=[],null==(e=null==(t=this.tooltipHandler)?void 0:t.release)||e.call(t),this._isTooltipShown=!1}beforeRelease(){this.event.emit(J.tooltipHide,{tooltip:this,chart:this.getChart()}),this.event.emit(J.tooltipRelease,{tooltip:this,chart:this.getChart()})}_initHandler(){var t,e,i;let r=null!=(t=this._spec.renderMode)?t:"html",n=this._option.globalInstance.getTooltipHandlerByUser();if(n)this.tooltipHandler=n,this._enterable=!1;else{let t="canvas"===r?AG.canvas:AG.dom,n=h9.getComponentPluginInType(t);n||hH("Can not find tooltip handler: "+t);let l=new n;l.name=`${this._spec.className}-${null!=(e=this._option.globalInstance.id)?e:0}-${this.getSpecIndex()}`,null==(i=this.pluginService)||i.load([l]),this.tooltipHandler=l,this._spec.enterable&&"html"===r&&this.tooltipHandler?(this._enterable=!0,this._needInitEventOfTooltip=!0):this._enterable=!1}}_initEventOfTooltipContent(){var t,e;if(!this._needInitEventOfTooltip)return;let i=null==(e=(t=this.tooltipHandler).getRootDom)?void 0:e.call(t);i&&(i.addEventListener("pointerenter",()=>{var t;if(!this._enterable)return;this._isEnterTooltip=!0;let e=null==(t=i.getBoundingClientRect)?void 0:t.call(i);e&&(this._cacheEnterableRect={width:e.width,height:e.height}),this._outTimer&&(clearTimeout(this._outTimer),this._outTimer=null),this._showTimer&&(clearTimeout(this._showTimer),this._showTimer=null)}),i.addEventListener("pointerleave",()=>{var t,e,r;if(this._enterable&&(this._isEnterTooltip=!1,"none"!==this._spec.triggerOff&&this._cacheEnterableRect)){let n=null==(t=i.getBoundingClientRect)?void 0:t.call(i);n&&Object.keys(this._cacheEnterableRect).every(t=>this._cacheEnterableRect[t]===n[t])&&(this._cacheEnterableRect=null,this._outTimer=setTimeout(this.hideTooltip,null!=(r=null==(e=this._spec)?void 0:e.showDelay)?r:50))}}),this._needInitEventOfTooltip=!1)}_initProcessor(){let t=this._spec.activeType;this.processor={},t.forEach(t=>{let e=h9.createTooltipProcessor(t,this);e&&(this.processor[t]=e)})}_initEvent(){var t;if(this._option.disableTriggerEvent)return;let e=(0,a1.IX)(null!=(t=this._spec.trigger)?t:"hover"),i=(0,a1.IX)(this._spec.triggerOff),r=this._option.mode;e.forEach(t=>{var e;"hover"===t?(this._handleMouseMove=this._throttle(this._getMouseMoveHandler(!1)),this._mountEvent("pointermove",{source:"chart"},this._handleMouseMove),(hE(r)||hL(r))&&(this._mountEvent("pointerdown",{source:"chart"},this._getMouseMoveHandler(!1)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))),this._mountEvent("pointerleave",{source:"chart"},this._getMouseOutHandler(!1))):"click"===t?(this._mountEvent("pointertap",{source:"chart"},this._getMouseMoveHandler(!0)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))):(0,nF.Z)(t)&&this._mountEvent(t.eventType,{source:null!=(e=t.source)?e:"chart",consume:t.consume},this._getMouseMoveHandler(!0))}),i.filter(t=>(0,nF.Z)(t)).forEach(t=>{var e,i;this._mountEvent(t.eventType,{source:null!=(e=t.source)?e:"chart",consume:t.consume},this._getMouseOutHandler(null!=(i=t.checkOutside)&&i))}),!e.includes("click")&&this._spec.lockAfterClick&&this._mountEvent("pointertap",{source:"chart"},this._handleClickToLock)}_throttle(t){let e;return e=(0,n4.Z)(this._spec.throttleInterval)?this._spec.throttleInterval:"html"===this._spec.renderMode&&this._spec.transitionDuration?50:10,(0,dw.Z)(t,e)}_showContentByEvent(t){var e;return!((null==(e=this._option)?void 0:e.componentShowContent)&&(!1===this._option.componentShowContent.tooltip||(0,nF.Z)(this._option.componentShowContent.tooltip)&&!1===this._option.componentShowContent.tooltip[t]))&&!0}reInit(t){var e,i,r;if(super.reInit(t),this.tooltipHandler){let t=null!=(e=this._spec.renderMode)?e:"html",n=this._spec.enterable&&"html"===t;n&&!this._enterable&&(this._needInitEventOfTooltip=!0),this._enterable=n,null==(r=(i=this.tooltipHandler).reInit)||r.call(i)}else this._initHandler()}showTooltip(t,e){var i;if(this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),!(null==(i=this.tooltipHandler)?void 0:i.showTooltip))return!1;let r=function(t,e,i){var r,n,l,s,a,o;let h=Object.assign({regionIndex:0},e),d=i.getOption(),u=d.getRegionsInUserIdOrIndex((0,aw.Z)(h.regionId)?[h.regionId]:void 0,(0,aw.Z)(h.regionIndex)?[h.regionIndex]:void 0)[0];if(!u)return"none";let c=E3(t,u),p=null!=(r=h.activeType)?r:c.length>1?"dimension":"mark",g=u.getLayoutStartPoint(),f=u.getLayoutRect(),m=d.globalInstance.getContainer(),y=Object.assign({x:0,y:0},m?(0,ax.to)(m):{}),v=t=>{var e;let{dimensionFields:i,dimensionData:r,measureFields:n,measureData:l,groupField:s,groupData:a}=t.data;return null==(e=t.series.getViewData())?void 0:e.latestData.find(t=>E1(i,r)(t)&&E1(n,l)(t)&&((0,nB.Z)(s)||E1([s],[a])(t)))},b=u.getOption().globalInstance.getStage().window.getViewBoxTransform().getInverse(),_=t=>{var e,i;let r={x:Math.min(Math.max(t.x,0),f.width),y:Math.min(Math.max(t.y,0),f.height)},n=null!=(e=h.x)?e:g.x+r.x,l=null!=(i=h.y)?i:g.y+r.y,s={x:0,y:0};b.transformPoint({x:n,y:l},s);let{x:a,y:o}=s;return{canvasX:a,canvasY:o,clientX:y.x+a,clientY:y.y+o}};if("dimension"===p){let e=c[0];if(!e)return"none";let r=new Map;c.forEach(t=>{var e;r.has(t.series)||r.set(t.series,[]),null==(e=r.get(t.series))||e.push(t)});let o=[{value:t[e.data.dimensionFields[0]],data:[...r.keys()].map(t=>{var e,i;return{series:t,datum:null!=(i=null==(e=r.get(t))?void 0:e.map(t=>v(t)))?i:[]}})}];(0,aw.Z)(e.dimType)&&(o[0].position=e.pos[e.dimType],o[0].dimType=e.dimType);let h={changePositionOnly:!1,action:"enter",tooltip:null,dimensionInfo:o,chart:null!=(n=d.globalInstance.getChart())?n:void 0,datum:void 0,model:void 0,source:Q.chart,event:_({x:c.reduce((t,e)=>t+e.pos.x,0)/c.length,y:c.reduce((t,e)=>t+e.pos.y,0)/c.length}),item:void 0};null==(a=null==(s=null==(l=i.processor)?void 0:l.dimension)?void 0:s.showTooltip)||a.call(s,o,h,!1);let u=d.globalInstance;return bg.globalConfig.uniqueTooltip&&bg.hideTooltip(u.id),p}if("mark"===p){let e=c[0];if(!e)return"none";let r=Object.assign(Object.assign({},v(e)),t),n=[{datum:[r],series:e.series}],l={changePositionOnly:!1,tooltip:null,dimensionInfo:[{value:r[e.data.dimensionFields[0]],data:n}],chart:null!=(o=d.globalInstance.getChart())?o:void 0,datum:r,model:e.series,source:Q.chart,event:_(e.pos),item:void 0};i.processor.mark.showTooltip({datum:r,mark:null,series:e.series},l,!1);let s=d.globalInstance;return bg.globalConfig.uniqueTooltip&&bg.hideTooltip(s.id),p}return"none"}(t,e,this);return"none"!==r&&(this._alwaysShow=!!(null==e?void 0:e.alwaysShow),this._cacheActiveType=r),r}_isSameAsCache(t,e,i){if(i!==this._cacheActiveType)return!1;if(t===this._cacheInfo)return!0;if((0,nB.Z)(this._cacheInfo)||(0,nB.Z)(t))return!1;if(E4(t)){if(E5(this._cacheInfo))return!1;let e=this._cacheInfo;return e.length===t.length&&t.every((t,i)=>Ab(t,e[i]))}if(E4(this._cacheInfo))return!1;let r=this._cacheInfo;if((null==t?void 0:t.datum)!==r.datum||(null==t?void 0:t.mark)!==r.mark||(null==t?void 0:t.series)!==r.series)return!1;let n=this._cacheParams;return!(0,nB.Z)(n)&&!(0,nB.Z)(e)&&n.mark===e.mark&&n.model===e.model&&n.datum===e.datum}_isPointerInChart(t){var e;let i=null==(e=this._option)?void 0:e.globalInstance;if(!i||!i.getChart())return!1;let{x:r,y:n}=t,{x:l,y:s,width:a,height:o}=i.getCanvas().getBoundingClientRect();return r>=l&&r<=l+a&&n>=s&&n<=s+o}getVisible(){return!1!==this._spec.visible}}E7.type=oQ.tooltip,E7.transformerConstructor=E6,E7.builtInTheme={tooltip:{offset:{x:10,y:10},panel:{padding:{top:10,left:10,right:10,bottom:10},backgroundColor:{type:"palette",key:"popupBackgroundColor"},border:{color:{type:"palette",key:"popupBackgroundColor"},width:0,radius:3},shadow:{x:0,y:4,blur:12,spread:0,color:{type:"palette",key:"shadowColor"}}},spaceRow:6,titleLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0},shape:{size:8,spacing:6},keyLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle",spacing:26},valueLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0}}},E7.specKey="tooltip";let E8=()=>{h9.registerComponent(E7.type,E7)};class E9 extends CB{constructor(){super(...arguments),this.name="crosshair"}render(){this.renderCrosshair(this)}}uD(),_W();class Lt extends E9{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Lt.defaultAttributes,t))}renderCrosshair(t){let{start:e,end:i,lineStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-line",Object.assign({points:[e,i]},r),"line")}setLocation(t){let{start:e,end:i}=t;this.setAttributes({start:e,end:i})}}Lt.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},uD(),c7();class Le extends E9{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Le.defaultAttributes,t))}renderCrosshair(t){let{start:e,end:i,rectStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-rect",Object.assign({x:e.x,y:e.y,width:i.x-e.x,height:i.y-e.y},r),"rect")}setLocation(t){let{start:e,end:i}=t;this.setAttributes({start:e,end:i})}}Le.defaultAttributes={rectStyle:{fill:"#b2bacf",opacity:.2}},(et=eR||(eR={}))[et.ALL=3]="ALL",et[et.HORIZONTAL=2]="HORIZONTAL",et[et.VERTICAL=1]="VERTICAL";var Li=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let Lr={x:["top","bottom"],y:["left","right"],category:["angle"],value:["radius"]};class Ln extends xZ{get enableRemain(){return"none"===this.triggerOff}constructor(t,e){super(t,e),this.specKey="crosshair",this.layoutType="none",this.gridZIndex=ts.CrossHair_Grid,this.labelZIndex=ts.CrossHair,this.trigger="hover",this._handleIn=t=>{if(!this._option)return;let{x:e,y:i}=this.calculateTriggerPoint(t);this.showDefault=!1,this._layoutCrosshair(e,i);let r=this._getNeedClearVRenderComponents();this._hasActive=r.some(t=>t&&!1!==t.attribute.visible)},this._handleClickInEvent=t=>{if(!this._hasActive||!this._spec.lockAfterClick||this._clickLock)return this._clickLock?(this._clickLock=!1,void this._handleOutEvent()):void(this._onlyLockClick||(this._handleIn(t),(0,n4.Z)(this.triggerOff)&&(this._timer&&clearTimeout(this._timer),this._timer=setTimeout(()=>{this._handleOutEvent()},this.triggerOff))));this._clickLock=!0},this._handleHoverInEvent=(0,dw.Z)(t=>{this._clickLock||this._handleIn(t)},10),this._handleOutEvent=()=>{this.enableRemain||this._clickLock||!this._hasActive||(this.clearOutEvent(),this.hideCrosshair())},this._handleTooltipShow=t=>{let e=t.tooltipData;if(t.isEmptyTooltip||!e||!e.length||(0,nF.Z)(this._spec.followTooltip)&&!1===this._spec.followTooltip[t.activeType])return void this._handleTooltipHideOrRelease();let{x:i,y:r}=this.calculateTriggerPoint(t);this.showDefault=!1,this._layoutCrosshair(i,r,e,t.activeType);let n=this._getNeedClearVRenderComponents();this._hasActive=n.some(t=>t&&!1!==t.attribute.visible)},this._handleTooltipHideOrRelease=()=>{this.clearOutEvent(),this.hideCrosshair()},this.enable=!0,this.showDefault=!0}_setAllAxisValues(t,e,i){let r=!1;if(t.forEach(t=>{(0,pW.lK)(t.axis.getScale().type)&&(r?this.enable=!1:r=!0)}),!this.enable)return!1;let{currentValue:n}=this._stateByField[i];return t.forEach((t,i)=>{let r=t.axis;n.set(i,{datum:this._getDatumAtPoint(r,e),axis:r})}),!0}clearAxisValue(){Object.keys(this._stateByField).forEach(t=>{this._stateByField[t].currentValue.clear()})}hideCrosshair(){this.clearAxisValue(),this.hide()}showCrosshair(t){t&&t.length&&(this.showDefault=!1,this.clearAxisValue(),t.forEach(t=>{let{axis:e,value:i}=t;this.setAxisValue(i,e)}),this.layoutByValue(!1))}_getLimitBounds(){var t,e;if(!this._limitBounds){let{width:i,height:r}=null!=(e=null==(t=this._option.globalInstance.getChart())?void 0:t.getViewRect())?e:{width:0,height:0};this._limitBounds={x1:0,y1:0,x2:i,y2:r}}return this._limitBounds}_showDefaultCrosshairBySpec(){let t=!1;return Object.keys(this._stateByField).forEach(e=>{let i=this._spec[e];if(i&&i.visible&&i.defaultSelect){let{axisIndex:r=0,datum:n}=i.defaultSelect,l=this._option.getComponentsByKey("axes").find(t=>t.getSpecIndex()===r);l&&(t=!0,this._stateByField[e].currentValue.clear(),this._stateByField[e].currentValue.set(r,{axis:l,datum:n}))}}),t}_updateVisibleCrosshair(){let t=!1;Object.keys(this._stateByField).forEach(e=>{let i=this._spec[e];i&&i.visible&&this._stateByField[e].currentValue.size?t=!0:this._hideByField(e)}),t&&this.layoutByValue(!1)}_showDefaultCrosshair(){this.showDefault?this._showDefaultCrosshairBySpec()&&this.layoutByValue(!1):this._updateVisibleCrosshair()}setAttrFromSpec(){super.setAttrFromSpec(),this._parseCrosshairSpec()}created(){super.created(),this._initEvent()}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(0,uL.X)(e,t)||(i.reRender=!0,i.reMake=!0),i}_initEvent(){if(!this._option.disableTriggerEvent)if(this._spec.followTooltip)this._registerTooltipEvent();else{let t=this._getTriggerEvent();t&&t.forEach(t=>{this._registerEvent(t.in,!1,t.click),t.out&&this._registerEvent(t.out,!0)})}}_registerEvent(t,e,i){var r;if(!1===(null==(r=this._option.componentShowContent)?void 0:r.crosshair))return;let n=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent,l=e?{level:te.chart}:{source:Q.chart};(0,rD.Z)(t)?t.forEach(t=>{this.event.on(t,l,n)}):this.event.on(t,l,n)}_eventOff(t,e,i){let r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent;(0,rD.Z)(t)?t.forEach(t=>{this.event.off(t,r)}):this.event.off(t,r)}onBeforeRender(){this._limitBounds=null,this._showDefaultCrosshair()}calculateTriggerPoint(t){let{event:e}=t,i=this._option.getCompiler().getStage().getLayer(void 0),r={x:e.viewX,y:e.viewY};return i.globalTransMatrix.transformPoint({x:e.viewX,y:e.viewY},r),{x:r.x-this.getLayoutStartPoint().x,y:r.y-this.getLayoutStartPoint().y}}_getTriggerEvent(){let{mode:t=oJ["desktop-browser"]}=this._option,e=t===oJ["desktop-browser"]||t===oJ["desktop-miniApp"]?{click:"pointertap",hover:"pointermove",hoverOut:"pointerleave",clickOut:"pointerleave"}:hE(t)||hL(t)?{click:"tap",hover:["pointerdown","pointermove"],hoverOut:"pointerleave",clickOut:"pointerleave"}:null;if(e){let t=(0,a1.IX)(this.trigger||"hover"),i=t=>"click"===t?"none"===this.triggerOff?null:e.clickOut:e.hoverOut;this._spec.lockAfterClick&&!t.includes("click")?(t.push("click"),this._onlyLockClick=!0):this._onlyLockClick=!1;let r=[];return t.forEach(t=>{r.push({click:"click"===t,in:e[t],out:i(t)})}),r}return null}_registerTooltipEvent(){this.event.on(J.tooltipHide,{source:Q.chart},this._handleTooltipHideOrRelease),this.event.on(J.tooltipShow,{source:Q.chart},this._handleTooltipShow),this.event.on(J.tooltipRelease,{source:Q.chart},this._handleTooltipHideOrRelease)}_getAxisInfoByField(t){var e,i;let r=null==(i=(e=this._option).getComponentsByKey)?void 0:i.call(e,"axes");if(!(null==r?void 0:r.length))return null;let n=(0,dx.Z)(this._spec,`${t}Field.bindingAxesIndex`);if(n||(n=[],r.forEach((e,i)=>{Lr[t].includes(e.getOrient())&&n.push(i)})),!n.length)return null;let l=new Map,s=1/0,a=1/0,o=-1/0,h=-1/0,{x:d,y:u}=this.getLayoutStartPoint();return n.forEach(t=>{var e;s=1/0,a=1/0,o=-1/0,h=-1/0;let i=r.find(e=>e.getSpecIndex()===t);if(!i)return;let n=(null==(e=i.getInnerOffset)?void 0:e.call(i))||{left:0,right:0,top:0,bottom:0};i.getRegions().forEach(t=>{let{x:e,y:i}=t.getLayoutStartPoint();s=Math.min(s,e-d+n.left),a=Math.min(a,i-u+n.top),o=Math.max(o,e+t.getLayoutRect().width-d-n.right),h=Math.max(h,i+t.getLayoutRect().height-u-n.bottom)}),l.set(t,{x1:s,y1:a,x2:o,y2:h,axis:i})}),l}onLayoutEnd(){let t=this._regions[0];this.setLayoutRect(t.getLayoutRect()),this.setLayoutStartPosition(t.getLayoutStartPoint()),super.onLayoutEnd()}_releaseEvent(){this.clearOutEvent();let t=this._getTriggerEvent();t&&t.forEach(t=>{this._eventOff(t.in,!1,t.click),t.out&&this._eventOff(t.out,!0)})}_parseFieldInfo(){Object.keys(this._stateByField).forEach(t=>{let e=this._spec[t],{crosshairComp:i}=this._stateByField[t];if(e&&e.visible){if(this._stateByField[t].attributes=this._parseField(e,t),i){let{style:e,type:r}=this._stateByField[t].attributes;i.setAttributes({["rect"===r?"rectStyle":"lineStyle"]:e})}}else i&&i.parent&&i.parent.removeChild(i)})}_parseCrosshairSpec(){this._parseFieldInfo();let{trigger:t,triggerOff:e,labelZIndex:i,gridZIndex:r}=this._spec;t&&(this.trigger=t),("none"===e||(0,n4.Z)(e)&&e>0)&&(this.triggerOff=e),void 0!==i&&(this.labelZIndex=i),void 0!==r&&(this.gridZIndex=r)}_parseField(t,e){var i,r,n;let l={},{line:s={},label:a={},visible:o}=t;if(l.visible=o,l.type=s.type||"line",!1===s.visible)l.style={visible:!1};else{let e=s.style||{},{stroke:n,fill:a,lineWidth:o}=e,{strokeOpacity:h,fillOpacity:d,opacity:u}=e,c=Li(e,["strokeOpacity","fillOpacity","opacity"]),p="line"===l.type,g=p?h:d;if((0,n4.Z)(u)&&(g=(null!=g?g:1)*u),l.style=Object.assign({opacity:g,pickable:!1,visible:!0},c),p)l.style.stroke=n||a,l.style.lineWidth=(0,dx.Z)(s,"width",o||2);else{l.style.fill=a||n,(null==(r=null==(i=null==t?void 0:t.line)?void 0:i.style)?void 0:r.stroke)&&(l.style.stroke=t.line.style.stroke);let e=(0,dx.Z)(s,"width");if("string"==typeof e){let t=parseInt(e.substring(0,e.length-1),10)/100;l.style.sizePercent=t}else"number"!=typeof e&&"function"!=typeof e||(l.style.size=e)}}if(a.visible){let t=a.labelBackground||{},e=null!=(n=a.syncAxisLabelAngle)&&n,i=a.style||{},r=t.style||{},{fill:s="rgba(47, 59, 82, 0.9)",stroke:o,outerBorder:h}=r,d=Li(r,["fill","stroke","outerBorder"]);l.label={visible:!0,formatMethod:a.formatMethod,formatter:a.formatter,minWidth:t.minWidth,maxWidth:t.maxWidth,padding:t.padding,syncAxisLabelAngle:e,textStyle:Object.assign(Object.assign({fontSize:14,pickable:!1},i),{fill:i.fill||"#fff",stroke:(0,dx.Z)(i,"stroke")}),panel:((0,nD.Z)(t.visible)?t.visible:t)?Object.assign({visible:!0,pickable:!1,fill:s,stroke:o,outerBorder:Object.assign({stroke:s,distance:0,lineWidth:3},h)},d):{visible:!1},zIndex:this.labelZIndex,childrenPickable:!1,pickable:!1}}else l.label={visible:!1};return l}_filterAxisByPoint(t,e,i){return t&&t.forEach(r=>{let n=r.axis;if((r.x1>e||r.x2<e||r.y1>i||r.y2<i)&&t.delete(n.getSpecIndex()),n.type.startsWith("polarAxis")){let r=n.getCenter(),l=n.getInnerRadius(),s=n.getOuterRadius(),a=iN.HL.distancePP({x:e,y:i},r);(a>s||a<l)&&t.delete(n.getSpecIndex())}}),t}_updateCrosshairLabel(t,e,i){let r=this.getContainer();t?t.setAttributes(e):(t=new Su(e),null==r||r.add(t),i(t)),function(t,e){let{x1:i,y1:r,x2:n,y2:l}=e,{x1:s,y1:a,x2:o,y2:h}=t.AABBBounds,{dx:d=0,dy:u=0}=t.attribute,c=0,p=0;s<i&&(c=i-s),a<r&&(p=r-a),o>n&&(c=n-o),h>l&&(p=l-h),c&&t.setAttribute("dx",c+d),p&&t.setAttribute("dy",p+u)}(t,this._getLimitBounds())}clearOutEvent(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._clickLock&&(this._clickLock=null),this._hasActive&&(this._hasActive=null)}_hideByField(t){let{crosshairComp:e,labelsComp:i}=this._stateByField[t];e&&e.hideAll(),i&&Object.keys(i).forEach(t=>{i[t]&&i[t].hideAll()})}hide(){Object.keys(this._stateByField).forEach(t=>{this._hideByField(t)})}_getNeedClearVRenderComponents(){return Object.keys(this._stateByField).reduce((t,e)=>{let{crosshairComp:i,labelsComp:r}=this._stateByField[e];return i&&t.push(i),r&&Object.keys(r).forEach(e=>{r[e]&&t.push(r[e])}),t},[])}}Ln.specKey="crosshair";let Ll={trigger:"hover",bandField:{visible:!1,line:{type:"rect",visible:!0,style:{fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineWidth:0,stroke:{type:"palette",key:"markLineStrokeColor"},lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}},linearField:{visible:!1,line:{type:"line",visible:!0,style:{stroke:{type:"palette",key:"markLineStrokeColor"},fill:"transparent",opacity:.7,lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}}};class Ls extends Ln{static getSpecInfo(t){return bW(t,this.specKey,this.type,t=>t.xField&&!1!==t.xField.visible||t.yField&&!1!==t.yField.visible)}constructor(t,e){super(t,e),this.type=oQ.cartesianCrosshair,this.name=oQ.cartesianCrosshair,this._stateByField={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:new Map,labelsComp:{top:null,bottom:null}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:new Map,labelsComp:{left:null,right:null}}}}_findAllAxisContains(t,e){let i=this._getAxisInfoByField("x"),r=this._getAxisInfoByField("y");return{xAxisMap:this._filterAxisByPoint(i,t,e),yAxisMap:this._filterAxisByPoint(r,t,e)}}_getDatumAtPoint(t,e){let i=CQ(t.getOrient())?"x":"y",r=e[i]-(t.getLayoutStartPoint()[i]-this.getLayoutStartPoint()[i]);return t.getScale().invert(r)}setAxisValue(t,e){CQ(e.getOrient())?this._stateByField.xField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.yField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})}_layoutCrosshair(t,e,i,r){var n;let l=t,s=e;if(i&&i.length){if("dimension"===r){let t,e=i[0],r=e.data.findIndex(t=>t.datum.length>0);if(r>-1){let i=e.data[r];t=i.series.dataToPosition(i.datum[0])}((0,aw.Z)(e.dimType)?"y"===e.dimType:C0(null==(n=null==e?void 0:e.axis)?void 0:n.getOrient()))?s=null==t?void 0:t.y:l=null==t?void 0:t.x}else if("mark"===r){let t=i[0],e=t.series.dataToPosition(t.datum[0]);l=null==e?void 0:e.x,s=null==e?void 0:e.y}}this.clearAxisValue();let{xAxisMap:a,yAxisMap:o}=this._findAllAxisContains(l,s);if(a&&0===a.size||o&&0===o.size){if(this.enableRemain)return;this.hide()}else a&&a.size&&this._setAllAxisValues(a,{x:l,y:s},"xField"),o&&o.size&&this._setAllAxisValues(o,{x:l,y:s},"yField"),this.layoutByValue()}layoutByValue(t){if(!this.enable)return;let e=CJ(this._regions,"cartesian");e&&(AF(this._stateByField,e,this.getLayoutStartPoint(),null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach(t=>{this._layoutByField(t)}))}_layoutByField(t){let{cacheInfo:e,attributes:i,labelsComp:r,bandSize:n,coordKey:l}=this._stateByField[t];if(!i||!e||e._isCache&&this.enableRemain)return;let{coord:s,labels:a,visible:o,labelsTextStyle:h}=e;if(o){let o=AD(this._stateByField[t]);this._updateCrosshairByField(t,o),Object.keys(a).forEach(o=>{var d,u,c;if(a[o].visible){let p=Object.assign(Object.assign(Object.assign({[l]:s+n/2},a[o]),i.label),{angle:i.label.syncAxisLabelAngle&&null!=(u=null==(d=e.axisLabel)?void 0:d.attribute.angle)?u:0,textStyle:Object.assign(Object.assign({},null==(c=i.label)?void 0:c.textStyle),h[o]),zIndex:this.labelZIndex,visible:!0});this._updateCrosshairLabel(r[o],p,e=>{e.name=`crosshair-${t.replace("Field","")}-${o}-label`,r[o]=e})}else r[o]&&r[o].hideAll()})}else this._hideByField(t)}_updateCrosshairByField(t,e){let i=this.getContainer(),{attributes:r}=this._stateByField[t],{crosshairComp:n}=this._stateByField[t];if(n)n.setAttributes(e);else{let l=r.style;"line"===r.type?n=new Lt(Object.assign(Object.assign({},e),{lineStyle:l,zIndex:this.gridZIndex+1,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1})):"rect"===r.type&&(n=new Le(Object.assign(Object.assign({},e),{rectStyle:l,zIndex:this.gridZIndex,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1}))),null==i||i.add(n),this._stateByField[t].crosshairComp=n}}}Ls.specKey="crosshair",Ls.builtInTheme={crosshair:Ll},Ls.type=oQ.cartesianCrosshair;let La=()=>{h9.registerComponent(Ls.type,Ls)};uD(),Sl();class Lo extends E9{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Lo.defaultAttributes,t))}renderCrosshair(t){let{center:e,radius:i,innerRadius:r=0,sectorStyle:n}=this.attribute,{startAngle:l,endAngle:s}=this.attribute;return t.createOrUpdateChild("crosshair-sector",Object.assign(Object.assign(Object.assign({},e),{outerRadius:i,innerRadius:r,startAngle:l,endAngle:s}),n),"arc")}setLocation(t){let{center:e,startAngle:i=gK,endAngle:r=gX}=this.attribute,n=r-i,l=(0,iH.Dt)((0,iH.Oy)(e,t));this.setAttributes({startAngle:l-n/2,endAngle:l+n/2})}}Lo.defaultAttributes={sectorStyle:{fill:"#b2bacf",opacity:.2}},uD(),wD();class Lh extends E9{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Lh.defaultAttributes,t))}renderCrosshair(t){let e,{center:i,radius:r,sides:n=6,lineStyle:l}=this.attribute,{startAngle:s,endAngle:a}=this.attribute,o=(a-s)%(2*Math.PI)==0,h=(a-s)/n;for(let t=0;t<=n;t++){let l=(0,iH.op)(i,r,s+h*t);0===t?e=`M${l.x},${l.y}`:e+=`L${l.x},${l.y}`,t===n&&o&&(e+="Z")}return t.createOrUpdateChild("crosshair-polygon",Object.assign({path:e},l),"path")}setLocation(t){let{center:e}=this.attribute,i=iN.HL.distancePP(t,e);this.setAttribute("radius",i)}}Lh.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},uD(),Sl();class Ld extends E9{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Ld.defaultAttributes,t))}renderCrosshair(t){let{center:e,radius:i,lineStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-circle",Object.assign(Object.assign(Object.assign(Object.assign({},e),{outerRadius:i}),this.attribute),r),"arc")}setLocation(t){let{center:e}=this.attribute,i=iN.HL.distancePP(t,e);this.setAttribute("radius",i)}}Ld.defaultAttributes={lineStyle:{stroke:["#b2bacf",!1,!1,!1],lineWidth:1,lineDash:[2]}};let Lu=(t,e,i=!1)=>{Object.keys(t).forEach(r=>{let{attributes:n,currentValue:l,cacheInfo:s,coordKey:a}=t[r];if(n){let o=!!l.size,h=i&&!o&&(0,aw.Z)(s),d=h?s:{coord:0,axis:null,visible:o,coordRange:[0,0],sizeRange:[0,0],labels:{all:{visible:!1,text:"",offset:0}}};if(s&&(s._isCache=h),"valueField"===r&&(d.sides=e.angleAxisHelper.getScale(0).domain().length),l.forEach(({axis:t,datum:i=""})=>{var l;let s=t.niceLabelFormatter;if((null==(l=n.label)?void 0:l.visible)&&(d.labels.all.visible=!0,d.labels.all.defaultFormatter=s,d.labels.all.text=i,d.labels.all.offset=xm(t.getSpec())),"categoryField"===r){let r=e.angleAxisHelper.dataToPosition([i]),n=e.angleAxisHelper.getBandwidth(0),l=t.getOuterRadius();d.coord=r,d.coordRange=[r-n/2,r+n/2],d.sizeRange=[l,l]}else{let r=t.startAngle,n=e.radiusAxisHelper.dataToPosition([i]);d.coord=n,d.coordRange=[n,n],d.sizeRange=[r,r]}d.axis=t}),d&&!h&&d.labels.all.visible&&n&&n.label){let t=d.labels.all,{formatMethod:e,formatter:i}=n.label,{formatFunc:r,args:l}=bz(e,i,t.text,{label:t.text,orient:a});r?t.text=r(...l):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))}t[r].cacheInfo=d}})},Lc=(t,e,i)=>{let{cacheInfo:r,coordKey:n,attributes:l}=t,{axis:s,coord:a,sizeRange:o,coordRange:h}=r,d=s.getCenter(),u={x:d.x+e.x,y:d.y+e.y};if("angle"===n)return"sector"==("rect"===l.type?"sector":"line")?{center:u,innerRadius:s.getInnerRadius(),radius:s.getOuterRadius(),startAngle:h[0],endAngle:h[1]}:{start:(0,iH.op)(u,s.getInnerRadius(),a),end:(0,iH.op)(u,s.getOuterRadius(),a)};let c=s.startAngle,p=s.endAngle,g=r.sides,f=a;if(!i){let t=s.getCenter(),e=s.coordToPoint({angle:o[0],radius:a}),i=(0,iH.Oy)(t,e),r=(p-c)/g,n=Math.floor((i-c)/r),l=Math.min((n+1)*r+c,p),h=(0,iH.op)(t,a,n*r+c),d=(0,iH.op)(t,a,l),u=(0,aj.Jz)([d.x,d.y],[h.x,h.y],[t.x,t.y],[e.x,e.y]);u&&(f=(0,yj.Z)(iN.HL.distancePN(e,u[0],u[1])+a,s.getInnerRadius(),s.getOuterRadius()))}return{center:u,startAngle:c,endAngle:p,radius:f,sides:g}};class Lp extends Ln{static getSpecInfo(t){return bW(t,this.specKey,this.type,t=>t.categoryField&&!1!==t.categoryField.visible||t.valueField&&!1!==t.valueField.visible)}constructor(t,e){super(t,e),this.type=oQ.polarCrosshair,this.name=oQ.polarCrosshair,this._stateByField={categoryField:{coordKey:"angle",anotherAxisKey:"radius",currentValue:new Map,labelsComp:{all:null}},valueField:{coordKey:"radius",anotherAxisKey:"angle",currentValue:new Map,labelsComp:{all:null}}}}setAxisValue(t,e){"radius"===e.getOrient()?this._stateByField.valueField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.categoryField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})}_findAllAxisContains(t,e){let i=this._getAxisInfoByField("category"),r=this._getAxisInfoByField("value");return{angleAxisMap:this._filterAxisByPoint(i,t,e),radiusAxisMap:this._filterAxisByPoint(r,t,e)}}_getDatumAtPoint(t,e){let{x:i,y:r}=t.getLayoutStartPoint(),{x:n,y:l}=this.getLayoutStartPoint();return t.positionToData({x:e.x-(i-n),y:e.y-(r-l)})}_layoutCrosshair(t,e,i,r){let n=t,l=e;if(i&&i.length){if("dimension"===r){let t=i[0];if(t.axis){let e=t.axis.pointToCoord({x:n,y:l}),i="radius"===t.axis.getOrient()?{radius:t.position,angle:e.angle}:{radius:e.radius,angle:t.position},r=t.axis.coordToPoint(i);n=r.x,l=r.y}}else if("mark"===r){let t=i[0],e=t.series.dataToPosition(t.datum[0]);n=e.x,l=e.y}}this.clearAxisValue();let{angleAxisMap:s,radiusAxisMap:a}=this._findAllAxisContains(n,l);if(0!==s.size||0!==a.size)s&&this._setAllAxisValues(s,{x:n,y:l},"categoryField"),a&&this._setAllAxisValues(a,{x:n,y:l},"valueField"),this.layoutByValue();else{if(this.enableRemain)return;this.hide()}}layoutByValue(t){if(!this.enable)return;let e=CJ(this._regions,"polar");e&&(Lu(this._stateByField,e,null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach(t=>{this._layoutByField(t)}))}_layoutByField(t){var e,i,r,n,l;let{cacheInfo:s,attributes:a,crosshairComp:o,labelsComp:h,coordKey:d}=this._stateByField[t];if(!s||s._isCache&&this.enableRemain)return;let u=this.getContainer(),{visible:c,labels:p,coord:g,sizeRange:f,axis:m}=s;if(c){let s=this.getLayoutStartPoint(),c=null==(i=null==(e=this._spec.valueField)?void 0:e.line)?void 0:i.smooth,y=Lc(this._stateByField[t],s,c);if(o)o.setAttributes(y);else{let e;if("angle"===d){let t="rect"===a.type?"sector":"line";"line"===t?e=new Lt(Object.assign(Object.assign({},y),{lineStyle:a.style,zIndex:this.gridZIndex,pickable:!1})):"sector"===t&&(e=new Lo(Object.assign(Object.assign({},y),{sectorStyle:a.style,zIndex:this.gridZIndex,pickable:!1})))}else e="polygon"==(c?"circle":"polygon")?new Lh(Object.assign(Object.assign({},y),{lineStyle:a.style,zIndex:this.gridZIndex+1})):new Ld(Object.assign(Object.assign({},y),{lineStyle:a.style,zIndex:this.gridZIndex}));this._stateByField[t].crosshairComp=e,u.add(e)}let v=p.all;if(v.visible){let t,e,i,o,u=m.getCenter(),c={x:u.x+s.x,y:u.y+s.y},p="angle"===d?(n=g,{align:(n=(0,iH.LW)(n))>=5/3*Math.PI||n<=1/3*Math.PI?"left":n>=2/3*Math.PI&&n<=4/3*Math.PI?"right":"center",baseline:n>=7/6*Math.PI&&n<=11/6*Math.PI?"bottom":n>=1/6*Math.PI&&n<=5/6*Math.PI?"top":"middle"}):(l=m.startAngle,{align:(l=(0,iH.LW)(l))>=7/6*Math.PI&&l<=11/6*Math.PI?"right":l>=1/6*Math.PI&&l<=5/6*Math.PI?"left":"center",baseline:l>=5/3*Math.PI||l<=1/3*Math.PI?"bottom":l>=2/3*Math.PI&&l<=4/3*Math.PI?"top":"middle"}),b=Object.assign(Object.assign(Object.assign(Object.assign({},"angle"===d?(0,iH.op)(c,f[1]+v.offset,g):(0,iH.op)(c,y.radius,m.startAngle)),a.label),v),{textStyle:Object.assign(Object.assign({},null==(r=a.label)?void 0:r.textStyle),{textAlign:p.align,textBaseline:p.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(h.all,b,t=>{t.name=`crosshair-${d}-label`,h.all=t})}else h.all&&h.all.hideAll()}}}Lp.specKey="crosshair",Lp.builtInTheme={crosshair:Ll},Lp.type=oQ.polarCrosshair;let Lg=()=>{h9.registerComponent(Lp.type,Lp)},Lf=(t,e)=>{let{getNewDomain:i,isContinuous:r,field:n,originalFields:l}=e,s=n(),a=i();if((0,nB.Z)(a)||(0,nB.Z)(s))return t;let o=l(),h=(0,rD.Z)(s)?s[0]:s;return t[h]&&o&&o[h]&&o[h].lockStatisticsByDomain&&!r()&&(t[h].values=a),t},Lm=(t,e)=>{let{getNewDomain:i,isContinuous:r,field:n}=e,l=n(),s=i();if((0,nB.Z)(s)||(0,nB.Z)(l))return t;if(0===s.length)return[];let a={};s.forEach(t=>{a[t]||(a[t]=1)});let o=null;return o=r()?t=>{let e=!1;return(0,a1.IX)(l).every(i=>{t[i]>=s[0]&&t[i]<=(0,a1.Z$)(s)&&(e=!0)}),e}:t=>{let e=!1;return(0,a1.IX)(l).every(i=>{(a[t[i]+""]||a[t[i]])&&(e=!0)}),e},t.filter(o)},Ly=(t,e)=>{let{stateFields:i,valueFields:r,dataCollection:n,isCategoryState:l,seriesCollection:s}=e.input,{stateField:a,valueField:o}=e.output,h={},d=[],u=[],c=[],p=!1,g=!1;return n.forEach((t,e)=>{var n;if((0,nB.Z)(i[e]))return;let l=s[e];if(l){let t=l.getRawDataStatisticsByField(i[e]);(0,aw.Z)(null==t?void 0:t.max)&&(0,aw.Z)(null==t?void 0:t.min)&&(g=!0)}let a=null==(n=t.getFields())?void 0:n[i[e]];a&&a.lockStatisticsByDomain&&(p=!0,a.domain.forEach(t=>{(0,nB.Z)(h[t])&&(c.push(t),h[t]=0,d.push(t))})),t.latestData.forEach(t=>{(0,a1.IX)(i[e]).forEach(i=>{(0,nB.Z)(t[i])||((0,nB.Z)(h[t[i]])&&(c.push(t[i]),h[t[i]]=0,d.push(t[i])),(0,nB.Z)(r[e])||(h[t[i]]+=isNaN(parseFloat(t[r[e]]))?1:parseFloat(t[r[e]])))})})}),(p?c:!1===l||g?c.sort((t,e)=>t-e):d).forEach(t=>{let e={[a]:t};o&&(e[o]=h[t]),u.push(e)}),u},Lv=(t,e,i)=>{let r=e.domain();if((0,pW.z2)(e.type))return i?r[0]+((0,a1.Z$)(r)-r[0])*(1-t):r[0]+((0,a1.Z$)(r)-r[0])*t;let n=e.range();i&&(n=n.slice().reverse());let l=n[0]+((0,a1.Z$)(n)-n[0])*t;return e.invert(l)},Lb=(t,e,i)=>{let r=e.scale(t),n=e.range();return!i&&(0,pW.z2)(e.type)&&(n=n.slice().reverse()),Math.max(0,Math.min(1,(r-n[0])/((0,a1.Z$)(n)-n[0])))},L_=(t,e)=>{if(!t)return!1;let i=t.getScale();return i.range()[0]>i.range()[1]&&(!t.getInverse()||e)},LC=t=>{let e=null==t?void 0:t.bandSize,i=null==t?void 0:t.maxBandSize,r=null==t?void 0:t.minBandSize;if(e||r||i)return{bandSize:e,maxBandSize:i,minBandSize:r}},Lx=(t,e,i)=>"start"===t?"percent"===e&&(0,aw.Z)(i.start)||"value"===e&&(0,aw.Z)(i.startValue):"percent"===e&&(0,aw.Z)(i.end)||"value"===e&&(0,aw.Z)(i.endValue),Lw=(t,e,i)=>{if((0,pW.z2)(i.type))return[Math.min(e,t),Math.max(e,t)];let r=i.domain(),n=r.indexOf(t),l=r.indexOf(e);return r.slice(Math.min(n,l),Math.max(n,l)+1)},LS=(t,e,i,r,n)=>{if((0,pW.z2)(n.type)){let l=n.domain(),s=l[0],a=(0,a1.Z$)(l)-s,o=(0,aw.Z)(t)?s+a*t:+e,h=(0,aw.Z)(i)?s+a*i:+r;return[Math.min(h,o),Math.max(h,o)]}let l=n.domain(),s=n.range(),a=s[s.length-1]-s[0],o=(0,aw.Z)(t)?l.indexOf(n.invert(a*t+s[0])):l.indexOf(e),h=(0,aw.Z)(i)?l.indexOf(n.invert(a*i+s[0])):l.indexOf(r);return l.slice(Math.min(o,h),Math.max(o,h)+1)};class LA{enableInteraction(){this._activeRoam=!0}disableInteraction(){this._activeRoam=!1}zoomIn(t){this.handleChartZoom({zoomDelta:1.2,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})}zoomOut(t){this.handleChartZoom({zoomDelta:.8,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})}constructor(t,e,i,r,n,l,s,a){this._activeRoam=!0,this._zoomAttr={enable:!0,rate:1,focus:!0},this._dragAttr={enable:!0,rate:1,reverse:!0},this._scrollAttr={enable:!0,rate:1,reverse:!0},this.initZoomEvent=()=>{var t,e,i,r,n,l,s;let a={delayType:null!=(e=null==(t=this._spec)?void 0:t.delayType)?e:"throttle",delayTime:(0,aw.Z)(null==(i=this._spec)?void 0:i.delayType)?null!=(n=null==(r=this._spec)?void 0:r.delayTime)?n:30:0,realTime:null==(s=null==(l=this._spec)?void 0:l.realTime)||s,allowComponentZoom:!0};this._zoomAttr.enable&&this.initZoomEventOfRegions(this.getRegions(),null,this.handleChartZoom,a),this._scrollAttr.enable&&this.initScrollEventOfRegions(this.getRegions(),null,this.handleChartScroll,a),this._dragAttr.enable&&this.initDragEventOfRegions(this.getRegions(),null,this.handleChartDrag,a)},this.handleChartZoom=(t,e)=>{var i,r;if(!this._activeRoam||this._zoomAttr.filter&&!this._zoomAttr.filter(t,e))return;let{zoomDelta:n,zoomX:l,zoomY:s}=t,{x:a,y:o}=this.getRegions()[0].getLayoutStartPoint(),{width:h,height:d}=this.getRegions()[0].getLayoutRect(),u=Math.abs(this.getState().start-this.getState().end),c=null!=(r=null==(i=this._spec.roamZoom)?void 0:i.rate)?r:1;if(u>=1&&n<1||u<=.01&&n>1)return;let p=this._isHorizontal?l:s,g=u*(n-1)*c,f=g/2,m=g/2;if(p){let t=this._isHorizontal?a:o,e=this._isHorizontal?h:d;f=Math.abs(t-p)/Math.abs(e-t)*g,m=Math.abs(e-p)/Math.abs(e-t)*g}let y=(0,yj.Z)(this.getState().start+f,0,1),v=(0,yj.Z)(this.getState().end-m,0,1);this._handleChange(Math.min(y,v),Math.max(y,v),!0)},this.handleChartScroll=(t,e)=>{var i;if(!this._activeRoam||this._scrollAttr.filter&&!this._scrollAttr.filter(t,e))return!1;let{scrollX:r,scrollY:n}=t,l=this._isHorizontal?r:n,s=this._isHorizontal?(0,ik.Wn)(r/n)>=.5:(0,ik.Wn)(n/r)>=.5;this._scrollAttr.reverse||(l=-l),s&&this.handleChartMove(l,null!=(i=this._scrollAttr.rate)?i:1);let a=0!==this.getState().start&&1!==this.getState().end;return s&&a},this.handleChartDrag=(t,e)=>{var i;if(!this._activeRoam||this._dragAttr.filter&&!this._dragAttr.filter(t,e))return;let[r,n]=t,l=this._isHorizontal?r:n;this._dragAttr.reverse&&(l=-l),this.handleChartMove(l,null!=(i=this._dragAttr.rate)?i:1)},this.handleChartMove=(t,e)=>{let i=this._isHorizontal?this.getLayoutRect().width:this.getLayoutRect().height;if(Math.abs(t)>=1e-6){if(t>0&&this.getState().end<1){let r=Math.min(1-this.getState().end,t/i)*e;this._handleChange(this.getState().start+r,this.getState().end+r,!0)}else if(t<0&&this.getState().start>0){let r=Math.max(-this.getState().start,t/i)*e;this._handleChange(this.getState().start+r,this.getState().end+r,!0)}}return!1},this._type=t,this._spec=e,this._handleChange=i,this.getLayoutRect=r,this.getState=n,this.getRegions=l,this._regions=l(),this.getOption=s,this._option=s(),this.getEvent=a,this._isHorizontal="horizontal"===C3(C2(e))}setEventAttrFromSpec(){!0===this._spec.roamZoom||this._spec.roamZoom?this._zoomAttr=(0,h3.Z)({},this._zoomAttr,this._spec.roamZoom):this._zoomAttr.enable=!1,!0===this._spec.roamDrag||this._spec.roamDrag?this._dragAttr=(0,h3.Z)({},this._dragAttr,this._spec.roamDrag):this._dragAttr.enable=!1,!0===this._spec.roamScroll||this._spec.roamScroll?this._scrollAttr=(0,h3.Z)({},this._scrollAttr,this._spec.roamScroll):this._scrollAttr.enable=!1,(0,nD.Z)(this._spec.roam)&&(this._zoomAttr.enable="scrollBar"!==this._type&&this._spec.roam,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.getEvent(),this._option.mode)}}(0,yf.jB)(LA,M6);class LM extends xZ{get isHorizontal(){return this._isHorizontal}get stateScale(){return this._stateScale}get relatedAxisComponent(){return this._relatedAxisComponent}setStartAndEnd(t,e,i=["percent","percent"]){let[r="percent",n="percent"]=i,l="percent"===r?t:Lb(t,this._stateScale,this._isHorizontal),s="percent"===n?e:Lb(e,this._stateScale,this._isHorizontal);this._handleChange(l,s,!0)}enableInteraction(){this._dataFilterEvent.enableInteraction()}disableInteraction(){this._dataFilterEvent.disableInteraction()}zoomIn(t){this._dataFilterEvent.zoomIn(t)}zoomOut(t){this._dataFilterEvent.zoomOut(t)}_initEvent(){var t;this._dataFilterEvent.initZoomEvent(),null==(t=this._relatedAxisComponent)||t.event.on(J.scaleRawDomainUpdate,({model:t})=>{console.log("scaleRawDomainUpdate",t.getRawDomain())})}_handleChange(t,e,i){var r,n;null!=(n=null==(r=this._spec)?void 0:r.zoomLock)&&n||e-t!==this._spanCache&&(e-t<this._minSpan||e-t>this._maxSpan)?this._shouldChange=!1:(this._shouldChange=!0,this._spanCache=e-t)}_updateRangeFactor(t){let e=this._relatedAxisComponent,i=e.getScale(),r=L_(e,this._isHorizontal),n=r?[1-this._end,1-this._start]:[this._start,this._end];if(r)switch(t){case"startHandler":e.scaleRangeFactorEnd(n[1]);break;case"endHandler":e.scaleRangeFactorStart(n[0]);break;default:e.scaleRangeFactorStart(n[0],!0),e.scaleRangeFactorEnd(n[1])}else switch(t){case"startHandler":e.scaleRangeFactorStart(n[0]);break;case"endHandler":e.scaleRangeFactorEnd(n[1]);break;default:e.scaleRangeFactorEnd(n[1],!0),e.scaleRangeFactorStart(n[0])}let l=i.rangeFactor();l?(this._start=r?1-l[1]:l[0],this._end=r?1-l[0]:l[1]):(this._start=0,this._end=1)}get visible(){return this._visible}constructor(t,e){super(t,e),this.layoutType="none",this._orient="left",this._cacheVisibility=void 0,this._dataUpdating=!1,this._hasInitStateScale=!1,this._shouldChange=!0,this._stateField="x",this._handleStateChange=(t,e,i)=>{var r,n;return this._startValue=t,this._endValue=e,this._newDomain=Lw(this._startValue,this._endValue,this._stateScale),null==(n=(r=this.effect).onZoomChange)||n.call(r,i),!0},this.effect={onZoomChange:t=>{var e,i;let r=this._relatedAxisComponent;if(r&&"axis"===this._filterMode){let n=r.getScale(),l=r.getSpec();this._auto&&LC(l)&&this._spec.ignoreBandSize&&(n.bandwidth("auto"),n.maxBandwidth("auto"),n.minBandwidth("auto")),this._updateRangeFactor(t),this._auto&&(null==(i=null==(e=this._component)?void 0:e.setStartAndEnd)||i.call(e,this._start,this._end)),r.effect.scaleUpdate({value:"force"})}else C$(this._regions,t=>{var e;null==(e=t.getViewData())||e.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),C$(this._regions,t=>{t.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._visible=!0,this._orient=C2(t),this._isHorizontal="horizontal"===C3(this._orient),this._dataFilterEvent=new LA(this.type,this._spec,this._handleChange.bind(this),this.getLayoutRect.bind(this),()=>({start:this._start,end:this._end}),()=>this._regions,(()=>this._option).bind(this),()=>this.event)}created(){super.created(),this._setAxisFromSpec(),this._setRegionsFromSpec(),this._initEvent(),this._initData(),this._initStateScale(),this._setStateFromSpec()}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}init(t){super.init(t),this._addTransformToSeries(),0===this._start&&1===this._end||this.effect.onZoomChange()}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(0,uL.X)(e,t)||(i.reRender=!0,i.reMake=!0),i}reInit(t){super.reInit(t),this._marks.forEach(t=>{t.getMarks().forEach(t=>{this.initMarkStyleWithSpec(t,this._spec[t.name])})})}onLayoutStart(t,e){super.onLayoutStart(t,e);let i=this._autoUpdate(t);this._autoVisible(i),this._dataUpdating=!1}updateLayoutAttribute(){this._visible&&this._createOrUpdateComponent(),this._hasInitStateScale||(0===this._start&&1===this._end||(this._newDomain=LS(this._spec.start,this._startValue,this._spec.end,this._endValue,this._stateScale),this.effect.onZoomChange()),this._hasInitStateScale=!0)}_initAfterLayout(){this._stateScale=null,this._initStateScale(),this._updateScaleRange(),this._setStateFromAxis()}_beforeLayoutEnd(){this._hasInitStateScale?this._updateScaleRange():this._initAfterLayout()}onLayoutEnd(){var t;this._beforeLayoutEnd();let e=0!==this._start||1!==this._end;this._autoVisible(e),super.onLayoutEnd(),null==(t=this._relatedAxisComponent)||t.updateScaleRange()}getBoundsInRect(t){let e={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0};return this._isHorizontal?(e.y2=e.y1+this._height,e.x2=e.x1+t.width):(e.x2=e.x1+this._width,e.y2=e.y1+t.height),e}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._dataFilterEvent.setEventAttrFromSpec(),this._field=this._spec.field,this._width=this._computeWidth(),this._height=this._computeHeight(),this._visible=null==(t=this._spec.visible)||t}_setAxisFromSpec(){if((0,aw.Z)(this._spec.axisId)?this._relatedAxisComponent=this._option.getComponentByUserId(this._spec.axisId):(0,aw.Z)(this._spec.axisIndex)&&(this._relatedAxisComponent=this._option.getComponentByIndex("axes",this._spec.axisIndex)),(0,nB.Z)(this._spec.field)&&!this._relatedAxisComponent){let t=this._option.getComponentsByKey("axes"),e=t.find(t=>C3(t._orient)===C3(this._orient));if(e)this._relatedAxisComponent=e;else{let e=t.find(t=>!(0,pW.z2)(t.getScale().type));this._relatedAxisComponent=e}}this._relatedAxisComponent&&"axis"===this._filterMode&&(this._relatedAxisComponent.autoIndentOnce=!0)}_setRegionsFromSpec(){var t,e;this._regions=this._relatedAxisComponent?this._relatedAxisComponent.getRegions():this._option.getAllRegions();let i=this._relatedAxisComponent?null==(e=(t=this._relatedAxisComponent).getBindSeriesFilter)?void 0:e.call(t):null;if((0,aw.Z)(i)&&((0,aw.Z)(i.userId)&&(this._seriesUserId=(0,a1.IX)(i.userId)),(0,aw.Z)(i.specIndex)&&(this._seriesIndex=(0,a1.IX)(i.specIndex))),(0,aw.Z)(this._spec.seriesId)){let t=(0,a1.IX)(this._spec.seriesId);this._seriesUserId?this._seriesUserId=this._seriesUserId.filter(e=>t.includes(e)):this._seriesUserId=t}if((0,aw.Z)(this._spec.seriesIndex)){let t=(0,a1.IX)(this._spec.seriesIndex);this._seriesIndex?this._seriesIndex=this._seriesIndex.filter(e=>t.includes(e)):this._seriesIndex=t}if((0,aw.Z)(this._spec.regionIndex)){let t=this._option.getRegionsInIndex((0,a1.IX)(this._spec.regionIndex));this._regions=this._regions.filter(e=>t.includes(e))}else if((0,aw.Z)(this._spec.regionId)){let t=(0,a1.IX)(this._spec.regionId);this._regions=t.length?this._regions.filter(e=>t.includes(e.id)):[]}}_initData(){let t,e=[],i=[],r=[],n=[];if(this._relatedAxisComponent){let i={};C$(this._regions,l=>{var s,a;let o="cartesian"===l.coordinate?l.getXAxisHelper():"polar"===l.coordinate?l.angleAxisHelper:null,h="cartesian"===l.coordinate?l.getYAxisHelper():"polar"===l.coordinate?l.radiusAxisHelper:null;if(!o||!h)return;let d=o.getAxisId()===this._relatedAxisComponent.id?o:h.getAxisId()===this._relatedAxisComponent.id?h:this._isHorizontal?o:h,u=d===o?h:o,c=(0,pW.z2)(u.getScale(0).type),p=(0,pW.z2)(d.getScale(0).type);e.push(l.getRawData());let g=l.getSpec(),f="cartesian"===l.coordinate?(0,a1.IX)(g.xField):(0,a1.IX)(null!=(s=g.angleField)?s:g.categoryField),m="cartesian"===l.coordinate?(0,a1.IX)(g.yField):(0,a1.IX)(null!=(a=g.radiusField)?a:g.valueField);if(i[l.id]="link"===l.type?["from_xField"]:d===o?f:m,p?(t=!1,r.push(i[l.id])):(t=!0,r.push(i[l.id][0])),this._valueField){let t="link"===l.type?["from_yField"]:u===o?f:m;c&&n.push(...t)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._originalStateFields=i}else C$(this._regions,t=>{e.push(t.getRawData()),i.push(t),r.push(this._field),this._valueField&&n.push(this._spec.valueField)},{userId:this._seriesUserId,specIndex:this._seriesIndex});let{dataSet:l}=this._option;dF(l,"dataview",e$.i),dL(l,"dataFilterComputeDomain",Ly);let s=new eq.V(l,{name:`${this.type}_${this.id}_data`});s.transform({type:"dataFilterComputeDomain",options:{input:{dataCollection:e,seriesCollection:i,stateFields:r,valueFields:n,isCategoryState:t},output:{stateField:this._stateField,valueField:this._valueField}}},!1),this._data=new pV(this._option,s),s.reRunAllTransform(),l.multipleDataViewAddListener(e,"change",this._handleDataCollectionChange.bind(this))}_addTransformToSeries(){this._relatedAxisComponent&&"axis"===this._filterMode||(dL(this._option.dataSet,"dataFilterWithNewDomain",Lm),dL(this._option.dataSet,"lockStatisticsFilter",Lf),C$(this._regions,t=>{t.getViewDataStatistics().transform({type:"lockStatisticsFilter",options:{originalFields:()=>t.getViewDataStatistics().getFields(),getNewDomain:()=>this._newDomain,field:()=>{var e;return null!=(e=this._field)?e:this._parseFieldOfSeries(t)},isContinuous:()=>(0,pW.z2)(this._stateScale.type)},level:1},!1),t.addViewDataFilter({type:"dataFilterWithNewDomain",options:{getNewDomain:()=>this._newDomain,field:()=>{var e;return null!=(e=this._field)?e:this._parseFieldOfSeries(t)},isContinuous:()=>(0,pW.z2)(this._stateScale.type)},level:ti.dataZoomFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex}))}onDataUpdate(){var t;let e=this._computeDomainOfStateScale((0,pW.z2)(this._stateScale.type));this._stateScale.domain(e,!1),this._handleChange(this._start,this._end,!0),this._spec.auto&&!(0,uL.X)(this._domainCache,e)&&(this._domainCache=e,this._dataUpdating=!0,null==(t=this.getChart())||t.setLayoutTag(!0,null,!1))}_parseFieldOfSeries(t){var e;return null==(e=this._originalStateFields)?void 0:e[t.id]}_setStateFromSpec(){let t,e;if(this._auto=!!this._spec.auto,this._spec.rangeMode){let[i,r]=this._spec.rangeMode;Lx("start",i,this._spec)&&Lx("end",r,this._spec)&&(t="percent"===i?this._spec.start:Lb(this._spec.startValue,this._stateScale,this._isHorizontal),e="percent"===r?this._spec.end:Lb(this._spec.endValue,this._stateScale,this._isHorizontal))}else t=this._spec.start?this._spec.start:this._spec.startValue?Lb(this._spec.startValue,this._stateScale,this._isHorizontal):0,e=this._spec.end?this._spec.end:this._spec.endValue?Lb(this._spec.endValue,this._stateScale,this._isHorizontal):1;this._start=Math.max(0,Math.min(1,t)),this._end=Math.max(0,Math.min(1,e))}_setStateFromAxis(){var t,e;this._setStateFromSpec();let i=this._relatedAxisComponent;this._startValue=Lv(this._start,this._stateScale,L_(i,this._isHorizontal)),this._endValue=Lv(this._end,this._stateScale,L_(i,this._isHorizontal)),this._minSpan=null!=(t=this._spec.minSpan)?t:0,this._maxSpan=null!=(e=this._spec.maxSpan)?e:1,(0,pW.z2)(this._stateScale.type)&&this._stateScale.domain()[0]!==(0,a1.Z$)(this._stateScale.domain())&&(this._spec.minValueSpan&&(this._minSpan=this._spec.minValueSpan/((0,a1.Z$)(this._stateScale.domain())-this._stateScale.domain()[0])),this._spec.maxValueSpan&&(this._maxSpan=this._spec.maxValueSpan/((0,a1.Z$)(this._stateScale.domain())-this._stateScale.domain()[0]))),this._minSpan=Math.max(0,this._minSpan),this._maxSpan=Math.min(this._maxSpan,1),i&&(i&&"axis"===this._filterMode||0===this._start&&1===this._end||(this._newDomain=Lw(this._startValue,this._endValue,this._stateScale)))}_initStateScale(){var t,e,i;let r=[0,1];if(this._relatedAxisComponent){let n=this._relatedAxisComponent.getScale().clone();this._stateScale=n,null==(t=n.maxBandwidth)||t.call(n,"auto",!0),null==(e=n.minBandwidth)||e.call(n,"auto",!0),null==(i=n.bandwidth)||i.call(n,"auto",!0),n.rangeFactor(r,!0).range(r)}else{let t=!0;this._field&&C$(this._regions,e=>{let i=e.getRawDataStatisticsByField(this._field);(0,hy.Z)(null==i?void 0:i.min)&&(0,hy.Z)(null==i?void 0:i.max)||(t=!1)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._stateScale=t?new pM.f:new pT.j,this._stateScale.domain(this._computeDomainOfStateScale(t),!0).range(r)}}_computeDomainOfStateScale(t){if(this._spec.customDomain)return this._spec.customDomain;let e=this._data.getLatestData().map(t=>t[this._stateField]);if(t){let t=e.map(t=>+t);return e.length?[(0,a1.iH)(t),(0,a1.CE)(t)]:[-1/0,1/0]}return e}_autoVisible(t){if(!this._auto)return;t?this.show():this.hide();let e=this._isHorizontal?"height":"width";this.layout.setLayoutRect({[e]:t?this[`_${e}`]:0},{[e]:to.Built_In})}hide(){var t;null==(t=this._component)||t.hideAll()}show(){var t;null==(t=this._component)||t.showAll()}_autoUpdate(t){var e,i,r,n,l,s;if(!this._auto)return this._cacheVisibility=void 0,!0;let a=this._relatedAxisComponent,o=null==a?void 0:a.getSpec(),h=null==a?void 0:a.getScale(),d=LC(o);if(!this._dataUpdating&&(0,pW.lK)(h.type)&&(null==t?void 0:t.height)===(null==(e=this._cacheRect)?void 0:e.height)&&(null==t?void 0:t.width)===(null==(i=this._cacheRect)?void 0:i.width)&&this._fixedBandSize===(null==d?void 0:d.bandSize))return this._cacheVisibility;let u=!0;if(this._isHorizontal&&(null==t?void 0:t.width)!==(null==(r=this._cacheRect)?void 0:r.width)?h.range(a.getInverse()?[t.width,0]:[0,t.width]):(null==t?void 0:t.height)!==(null==(n=this._cacheRect)?void 0:n.height)&&h.range(a.getInverse()?[0,t.height]:[t.height,0]),this._cacheRect={width:null==t?void 0:t.width,height:null==t?void 0:t.height},this._fixedBandSize=null==d?void 0:d.bandSize,(0,pW.lK)(h.type)){d&&(this._start||this._end)&&(this.type===oQ.scrollBar&&(this._start=0,this._end=1),this._updateRangeFactor());let[t,e]=null!=(l=h.rangeFactor())?l:[];u=(!(0,nB.Z)(t)||!(0,nB.Z)(e))&&(0!==t||1!==e)}else{let[t,e]=null!=(s=h.rangeFactor())?s:[this._start,this._end];u=0!==t||1!==e}return this.setStartAndEnd(this._start,this._end),this._cacheVisibility=u,u}_getNeedClearVRenderComponents(){return[this._component]}}(0,yf.jB)(LM,M6),(ee=eP||(eP={})).startHandler="startHandler",ee.endHandler="endHandler",ee.middleHandler="middleHandler",ee.background="background",(ei=eB||(eB={})).stateUpdate="stateUpdate",ei.maskUpdate="maskUpdate",ei.dataZoomUpdate="dataZoomUpdate",(eI||(eI={})).dataZoomChange="dataZoomChange";let LT="M -0.0544 0.25 C -0.0742 0.25 -0.0901 0.234 -0.0901 0.2143 L -0.0901 -0.1786 C -0.0901 -0.1983 -0.0742 -0.2143 -0.0544 -0.2143 L -0.0187 -0.2143 L -0.0187 -0.5 L 0.017 -0.5 L 0.017 -0.2143 L 0.0527 -0.2143 C 0.0724 -0.2143 0.0884 -0.1983 0.0884 -0.1786 L 0.0884 0.2143 C 0.0884 0.234 0.0724 0.25 0.0527 0.25 L 0.017 0.25 L 0.017 0.5 L -0.0187 0.5 L -0.0187 0.25 L -0.0544 0.25 Z M -0.0187 -0.1429 L -0.0544 -0.1429 L -0.0544 0.1786 L -0.0187 0.1786 L -0.0187 -0.1429 Z M 0.0527 -0.1429 L 0.017 -0.1429 L 0.017 0.1786 L 0.0527 0.1786 L 0.0527 -0.1429 Z",Lk={horizontal:{angle:0,strokeBoundsBuffer:0,boundsPadding:2,pickMode:"imprecise",cursor:"ew-resize"},vertical:{angle:Math.PI/180*90,cursor:"ns-resize",boundsPadding:2,pickMode:"imprecise",strokeBoundsBuffer:0}},LR=(t,e,i,r)=>{if(!e)return!1;if(r){if("start"===i){if(e.x1<t.x1)return!0}else if(e.x2>t.x2)return!0}else if("start"===i){if(e.y1<t.y1)return!0}else if(e.y2>t.y2)return!0;return!1};var LP=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class LB{get startHandlerMask(){return this._startHandlerMask}get middleHandlerSymbol(){return this._middleHandlerSymbol}get middleHandlerRect(){return this._middleHandlerRect}get endHandlerMask(){return this._endHandlerMask}get selectedBackground(){return this._selectedBackground}get dragMask(){return this._dragMask}get startText(){return this._startText}get endText(){return this._endText}get startValue(){return this._startValue}get endValue(){return this._endValue}set showText(t){this._showText=t}get background(){return this._background}set previewData(t){this._previewData=t}get previewGroup(){return this._previewGroup}get selectedPreviewGroup(){return this._selectedPreviewGroup}set previewPointsX(t){this._previewPointsX=t}set previewPointsY(t){this._previewPointsY=t}set previewPointsX1(t){this._previewPointsX1=t}set previewPointsY1(t){this._previewPointsY1=t}set statePointToData(t){this._statePointToData=t}_initAttrs(t){this.attribute=t.attribute,this._isHorizontal="top"===this.attribute.orient||"bottom"===this.attribute.orient;let{previewData:e,previewPointsX:i,previewPointsY:r,previewPointsX1:n,previewPointsY1:l}=this.attribute;e&&(this._previewData=e),(0,nz.Z)(i)&&(this._previewPointsX=i),(0,nz.Z)(r)&&(this._previewPointsY=r),(0,nz.Z)(n)&&(this._previewPointsX1=n),(0,nz.Z)(l)&&(this._previewPointsY1=l),this._getState=t.getState,this._getLayoutAttrFromConfig=t.getLayoutAttrFromConfig,this._getContainer=t.getContainer}constructor(t){this._previewData=[],this._statePointToData=t=>t;let{showDetail:e}=t.attribute;this._showText="auto"!==e&&e,this._initAttrs(t)}setAttributes(t){this._initAttrs(t)}renderDataZoom(t=!1){var e,i,r,n,l,s;let{backgroundChartStyle:a={},selectedBackgroundChartStyle:o={},brushSelect:h}=this.attribute;this._renderBackground(),(null==(e=a.line)?void 0:e.visible)&&!t&&this._setPreviewAttributes("line",this._getContainer()),(null==(i=a.area)?void 0:i.visible)&&!t&&this._setPreviewAttributes("area",this._getContainer()),h&&this.renderDragMask(),this._renderSelectedBackground(),(null==(r=o.line)?void 0:r.visible)&&this._setSelectedPreviewClipAttributes("line",this._getContainer()),(null==(n=o.line)?void 0:n.visible)&&!t&&this._setSelectedPreviewAttributes("line"),(null==(l=o.line)?void 0:l.visible)&&this._setSelectedPreviewClipAttributes("area",this._getContainer()),(null==(s=o.area)?void 0:s.visible)&&!t&&this._setSelectedPreviewAttributes("area"),this._renderHandler(),this._showText&&this.renderText()}renderDragMask(){let{dragMaskStyle:t}=this.attribute,{position:e,width:i,height:r}=this._getLayoutAttrFromConfig(),{start:n,end:l}=this._getState();return this._isHorizontal?this._dragMask=this._getContainer().createOrUpdateChild("dragMask",Object.assign({x:e.x+n*i,y:e.y,width:(l-n)*i,height:r},t),"rect"):this._dragMask=this._getContainer().createOrUpdateChild("dragMask",Object.assign({x:e.x,y:e.y+n*r,width:i,height:(l-n)*r},t),"rect"),{start:n,end:l}}_renderBackground(){var t;let{backgroundStyle:e,brushSelect:i,zoomLock:r}=this.attribute,{position:n,width:l,height:s}=this._getLayoutAttrFromConfig(),a=this._getContainer();this._background=a.createOrUpdateChild("background",Object.assign(Object.assign({x:n.x,y:n.y,width:l,height:s,cursor:i?"crosshair":"auto"},e),{pickable:!r&&(null==(t=e.pickable)||t)}),"rect")}_renderHandler(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M;let{orient:T,middleHandlerStyle:k={},startHandlerStyle:R={},endHandlerStyle:P={},zoomLock:B}=this.attribute,{start:I,end:E}=this._getState(),{position:L,width:F,height:O}=this._getLayoutAttrFromConfig(),H=null!=(t=R.triggerMinSize)?t:40,D=null!=(e=P.triggerMinSize)?e:40,z=this._getContainer();if(this._isHorizontal){if(k.visible){let t=(null==(i=k.background)?void 0:i.size)||10;this._middleHandlerRect=z.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:L.x+I*F,y:L.y-t,width:(E-I)*F,height:t},null==(r=k.background)?void 0:r.style),{pickable:!B&&(null==(s=null==(l=null==(n=k.background)?void 0:n.style)?void 0:l.pickable)||s)}),"rect"),this._middleHandlerSymbol=z.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:L.x+(I+E)/2*F,y:L.y-t/2,strokeBoundsBuffer:0,angle:0,symbolType:null!=(o=null==(a=k.icon)?void 0:a.symbolType)?o:"square"},k.icon),{pickable:!B&&(null==(h=k.icon.pickable)||h)}),"symbol")}this._startHandler=z.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:L.x+I*F,y:L.y+O/2,size:O,symbolType:null!=(d=R.symbolType)?d:"square"},Lk.horizontal),R),{pickable:!B&&(null==(u=R.pickable)||u)}),"symbol"),this._endHandler=z.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:L.x+E*F,y:L.y+O/2,size:O,symbolType:null!=(c=P.symbolType)?c:"square"},Lk.horizontal),P),{pickable:!B&&(null==(p=P.pickable)||p)}),"symbol");let t=Math.max(this._startHandler.AABBBounds.width(),H),e=Math.max(this._startHandler.AABBBounds.height(),H),g=Math.max(this._endHandler.AABBBounds.width(),D),f=Math.max(this._endHandler.AABBBounds.height(),D);this._startHandlerMask=z.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:L.x+I*F-t/2,y:L.y+O/2-e/2,width:t,height:e,fill:"white",fillOpacity:0,zIndex:999},Lk.horizontal),{pickable:!B}),"rect"),this._endHandlerMask=z.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:L.x+E*F-g/2,y:L.y+O/2-f/2,width:g,height:f,fill:"white",fillOpacity:0,zIndex:999},Lk.horizontal),{pickable:!B}),"rect")}else{if(k.visible){let t=(null==(g=k.background)?void 0:g.size)||10;this._middleHandlerRect=z.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:"left"===T?L.x-t:L.x+F,y:L.y+I*O,width:t,height:(E-I)*O},null==(f=k.background)?void 0:f.style),{pickable:!B&&(null==(v=null==(y=null==(m=k.background)?void 0:m.style)?void 0:y.pickable)||v)}),"rect"),this._middleHandlerSymbol=z.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:"left"===T?L.x-t/2:L.x+F+t/2,y:L.y+(I+E)/2*O,angle:Math.PI/180*90,symbolType:null!=(_=null==(b=k.icon)?void 0:b.symbolType)?_:"square",strokeBoundsBuffer:0},k.icon),{pickable:!B&&(null==(x=null==(C=k.icon)?void 0:C.pickable)||x)}),"symbol")}this._startHandler=z.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:L.x+F/2,y:L.y+I*O,size:F,symbolType:null!=(w=R.symbolType)?w:"square"},Lk.vertical),R),{pickable:!B&&(null==(S=R.pickable)||S)}),"symbol"),this._endHandler=z.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:L.x+F/2,y:L.y+E*O,size:F,symbolType:null!=(A=P.symbolType)?A:"square"},Lk.vertical),P),{pickable:!B&&(null==(M=P.pickable)||M)}),"symbol");let t=Math.max(this._startHandler.AABBBounds.width(),H),e=Math.max(this._startHandler.AABBBounds.height(),H),i=Math.max(this._endHandler.AABBBounds.width(),D),r=Math.max(this._endHandler.AABBBounds.height(),D);this._startHandlerMask=z.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:L.x+F/2+t/2,y:L.y+I*O-e/2,width:r,height:i,fill:"white",fillOpacity:0,zIndex:999},Lk.vertical),{pickable:!B}),"rect"),this._endHandlerMask=z.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:L.x+F/2+i/2,y:L.y+E*O-r/2,width:r,height:i,fill:"white",fillOpacity:0,zIndex:999},Lk.vertical),{pickable:!B}),"rect")}}_renderSelectedBackground(){var t,e;let{selectedBackgroundStyle:i={},selectedBackgroundChartStyle:r={},brushSelect:n,zoomLock:l}=this.attribute,{start:s,end:a}=this._getState(),{position:o,width:h,height:d}=this._getLayoutAttrFromConfig(),u=this._getContainer();this._isHorizontal?this._selectedBackground=u.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:o.x+s*h,y:o.y,width:(a-s)*h,height:d,cursor:n?"crosshair":"move"},i),{pickable:!l&&(null==(t=r.pickable)||t)}),"rect"):this._selectedBackground=u.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:o.x,y:o.y+s*d,width:h,height:(a-s)*d,cursor:n?"crosshair":"move"},i),{pickable:!l&&(null==(e=i.pickable)||e)}),"rect")}_setPreviewAttributes(t,e){this._previewGroup||(this._previewGroup=e.createOrUpdateChild("previewGroup",{pickable:!1},"group")),"line"===t?this._previewLine=this._previewGroup.createOrUpdateChild("previewLine",{},"line"):this._previewArea=this._previewGroup.createOrUpdateChild("previewArea",{curveType:"basis"},"area");let{backgroundChartStyle:i={}}=this.attribute;"line"===t&&this._previewLine.setAttributes(Object.assign({points:this._getPreviewLinePoints(),curveType:"basis",pickable:!1},i.line)),"area"===t&&this._previewArea.setAttributes(Object.assign({points:this._getPreviewAreaPoints(),curveType:"basis",pickable:!1},i.area))}_setSelectedPreviewClipAttributes(t,e){this._selectedPreviewGroupClip||(this._selectedPreviewGroupClip=e.createOrUpdateChild("selectedPreviewGroupClip",{pickable:!1},"group"),this._selectedPreviewGroup=this._selectedPreviewGroupClip.createOrUpdateChild("selectedPreviewGroup",{},"group"));let{start:i,end:r}=this._getState(),{position:n,width:l,height:s}=this._getLayoutAttrFromConfig();this._selectedPreviewGroupClip.setAttributes({x:this._isHorizontal?n.x+i*l:n.x,y:this._isHorizontal?n.y:n.y+i*s,width:this._isHorizontal?(r-i)*l:l,height:this._isHorizontal?s:(r-i)*s,clip:!0,pickable:!1}),this._selectedPreviewGroup.setAttributes({x:-(this._isHorizontal?n.x+i*l:n.x),y:-(this._isHorizontal?n.y:n.y+i*s),width:this._isHorizontal?(r-i)*l:l,height:this._isHorizontal?s:(r-i)*s,pickable:!1})}_setSelectedPreviewAttributes(t){let{selectedBackgroundChartStyle:e={}}=this.attribute;"line"===t?this._selectedPreviewLine=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewLine",{},"line"):this._selectedPreviewArea=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewArea",{curveType:"basis"},"area"),"line"===t&&this._selectedPreviewLine.setAttributes(Object.assign({points:this._getPreviewLinePoints(),curveType:"basis",pickable:!1},e.line)),"area"===t&&this._selectedPreviewArea.setAttributes(Object.assign({points:this._getPreviewAreaPoints(),curveType:"basis",pickable:!1},e.area))}_computeBasePoints(t){let e,i,{orient:r}=this.attribute,n="bottom"===r||"top"===r?"x":"y",l=Math.sign(t[t.length-1][n]-t[0][n]);0===l&&(l=1);let{position:s,width:a,height:o}=this._getLayoutAttrFromConfig();return this._isHorizontal?(e=[{x:s.x,y:s.y+o}],i=[{x:s.x+a,y:s.y+o}]):"left"===r?(e=[{x:s.x+a,y:s.y}],i=[{x:s.x+a,y:s.y+o}]):(e=[{x:s.x,y:s.y+o}],i=[{x:s.x,y:s.y}]),Math.sign(i[0][n]-e[0][n])!==l?{basePointStart:i,basePointEnd:e}:{basePointStart:e,basePointEnd:i}}_simplifyPoints(t){var e,i;if(t.length>1e4){let r=null!=(e=this.attribute.tolerance)?e:this._previewData.length/1e4;return(i=t).length<=10?i:i=function(t,e){let i,r,n=t[0].x,l=t[0].y,s=[t[0]];for(let a=1,o=t.length;a<o;a++)(i=t[a].x-n)*i+(r=t[a].y-l)*r>e&&(n=t[a].x,l=t[a].y,s.push(t[a]));return t[t.length-1].x===n&&t[t.length-1].y===l||s.push(t[t.length-1]),s}(i,void 0!==r?r*r:1)}return t}_getPreviewLinePoints(){let t=this._previewData.map(t=>({x:this._previewPointsX&&this._previewPointsX(t),y:this._previewPointsY&&this._previewPointsY(t)}));if(0===t.length)return t;t=this._simplifyPoints(t);let{basePointStart:e,basePointEnd:i}=this._computeBasePoints(t);return e.concat(t).concat(i)}_getPreviewAreaPoints(){let t=this._previewData.map(t=>({x:this._previewPointsX&&this._previewPointsX(t),y:this._previewPointsY&&this._previewPointsY(t),x1:this._previewPointsX1&&this._previewPointsX1(t),y1:this._previewPointsY1&&this._previewPointsY1(t)}));if(0===t.length)return t;t=this._simplifyPoints(t);let{basePointStart:e,basePointEnd:i}=this._computeBasePoints(t);return e.concat(t).concat(i)}renderText(){let t=null,e=null;if(this._setTextAttr(t,e),this._showText){t=this._startText.AABBBounds,e=this._endText.AABBBounds,this._setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds;let{x1:i,x2:r,y1:n,y2:l}=t,{dx:s=0,dy:a=0}=this.attribute.startTextStyle;if((new iI.YZ).set(i,n,r,l).intersects(e)){let t="bottom"===this.attribute.orient||"right"===this.attribute.orient?-1:1;this._isHorizontal?this._startText.setAttribute("dy",a+t*Math.abs(e.y1-e.y2)):this._startText.setAttribute("dx",s+t*Math.abs(e.x1-e.x2))}else this._isHorizontal?this._startText.setAttribute("dy",a):this._startText.setAttribute("dx",s)}}_setTextAttr(t,e){var i,r,n,l,s,a,o,h;let d,u,c,p,{startTextStyle:g,endTextStyle:f}=this.attribute,{formatMethod:m}=g,y=LP(g,["formatMethod"]),{formatMethod:v}=f,b=LP(f,["formatMethod"]),{start:_,end:C}=this._getState();this._startValue=this._statePointToData(_),this._endValue=this._statePointToData(C);let{position:x,width:w,height:S}=this._getLayoutAttrFromConfig(),A=m?m(this._startValue):this._startValue,M=v?v(this._endValue):this._endValue,T={x1:x.x,y1:x.y,x2:x.x+w,y2:x.y+S};this._isHorizontal?(d={x:x.x+_*w,y:x.y+S/2},u={x:x.x+C*w,y:x.y+S/2},c={textAlign:LR(T,t,"start",this._isHorizontal)?"left":"right",textBaseline:null!=(r=null==(i=null==y?void 0:y.textStyle)?void 0:i.textBaseline)?r:"middle"},p={textAlign:LR(T,e,"end",this._isHorizontal)?"right":"left",textBaseline:null!=(l=null==(n=null==b?void 0:b.textStyle)?void 0:n.textBaseline)?l:"middle"}):(d={x:x.x+w/2,y:x.y+_*S},u={x:x.x+w/2,y:x.y+C*S},c={textAlign:null!=(a=null==(s=null==y?void 0:y.textStyle)?void 0:s.textAlign)?a:"center",textBaseline:LR(T,t,"start",this._isHorizontal)?"top":"bottom"},p={textAlign:null!=(h=null==(o=null==b?void 0:b.textStyle)?void 0:o.textAlign)?h:"center",textBaseline:LR(T,e,"end",this._isHorizontal)?"bottom":"top"}),this._startText=this._maybeAddLabel(this._getContainer(),(0,h3.Z)({},y,{text:A,x:d.x,y:d.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:c}),"data-zoom-start-text"),this._endText=this._maybeAddLabel(this._getContainer(),(0,h3.Z)({},b,{text:M,x:u.x,y:u.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:p}),"data-zoom-end-text")}_maybeAddLabel(t,e,i){let r=t.find(t=>t.name===i,!0);return r?r.setAttributes(e):((r=new Su(e)).name=i,t.add(r)),r}}let LI={debounce:dS.Z,throttle:dw.Z};class LE extends nH(){constructor(t){super(),this._activeState=!1,this._activeCache={startPos:{x:0,y:0},lastPos:{x:0,y:0}},this._layoutCache={attPos:"x",attSize:"width",size:0},this._handleTouchMove=t=>{this._activeState&&t.preventDefault()},this._onHandlerPointerDown=(t,e)=>{this.clearDragEvents(),"start"===e?(this._activeTag=eP.startHandler,this._activeItem=this._startHandlerMask):"end"===e?(this._activeTag=eP.endHandler,this._activeItem=this._endHandlerMask):"middleRect"===e?(this._activeTag=eP.middleHandler,this._activeItem=this._middleHandlerRect):"middleSymbol"===e?(this._activeTag=eP.middleHandler,this._activeItem=this._middleHandlerSymbol):"background"===e&&(this._activeTag=eP.background,this._activeItem=this._background),this._activeState=!0,this._activeCache.startPos=this._eventPosToStagePos(t),this._activeCache.lastPos=this._eventPosToStagePos(t);let i="browser"===hd.env?hd:this.stage,r=IR();i.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.on("pointermove",this._onHandlerPointerMove,{capture:!0}),r.forEach(t=>{i.addEventListener(t,this._onHandlerPointerUp)})},this._pointerMove=t=>{let{brushSelect:e}=this.attribute,{position:i}=this._getLayoutAttrFromConfig(),r=this._eventPosToStagePos(t),{attPos:n,size:l,attSize:s}=this._layoutCache,a=(r[n]-this._activeCache.lastPos[n])/l,o=(r[n]-i[n])/this._getLayoutAttrFromConfig()[s],{start:h,end:d}=this._getState(),u=!0;this._activeState&&(this._activeTag===eP.middleHandler?{start:h,end:d}=this._moveZoomWithMiddle(a):this._activeTag===eP.startHandler?{start:h,end:d}=this._moveZoomWithHandler(o,"start"):this._activeTag===eP.endHandler?{start:h,end:d}=this._moveZoomWithHandler(o,"end"):this._activeTag===eP.background&&e&&({start:h,end:d}=this._moveZoomWithBackground(o),u=!1,this._dispatchEvent(eB.maskUpdate)),this._activeCache.lastPos=r),this._getState().start===h&&this._getState().end===d||(this._setStateAttr(h,d),this._dispatchEvent(eB.stateUpdate,{start:this._getState().start,end:this._getState().end,shouldRender:u,tag:this._activeTag}),this.attribute.realTime&&this._dispatchEvent(eB.dataZoomUpdate,{start:this._getState().start,end:this._getState().end,shouldRender:!0,tag:this._activeTag}))},this._onHandlerPointerUp=t=>{this._activeState&&this._activeTag===eP.background&&(this._setStateAttr(this._getState().start,this._getState().end),this._dispatchEvent(eB.stateUpdate,{start:this._getState().start,end:this._getState().end,shouldRender:!0,tag:this._activeTag})),this._activeState=!1,this._dispatchEvent(eB.dataZoomUpdate,{start:this._getState().start,end:this._getState().end,shouldRender:!0,tag:this._activeTag}),this.clearDragEvents()},this._initAttrs(t)}setAttributes(t){var e,i,r,n,l,s;this._initAttrs(t),this._onHandlerPointerMove=0===(null!=(i=null==(e=this.attribute)?void 0:e.delayTime)?i:0)?this._pointerMove:LI[null!=(n=null==(r=this.attribute)?void 0:r.delayType)?n:"debounce"](this._pointerMove,null!=(s=null==(l=this.attribute)?void 0:l.delayTime)?s:0)}_initAttrs(t){this.stage=t.stage,this.attribute=t.attribute,this._startHandlerMask=t.startHandlerMask,this._endHandlerMask=t.endHandlerMask,this._middleHandlerSymbol=t.middleHandlerSymbol,this._middleHandlerRect=t.middleHandlerRect,this._selectedBackground=t.selectedBackground,this._background=t.background,this._previewGroup=t.previewGroup,this._selectedPreviewGroup=t.selectedPreviewGroup,this._getLayoutAttrFromConfig=t.getLayoutAttrFromConfig,this._getState=t.getState,this._setState=t.setState;let{width:e,height:i}=this._getLayoutAttrFromConfig();this._spanCache=this._getState().end-this._getState().start;let r="top"===this.attribute.orient||"bottom"===this.attribute.orient;this._layoutCache.size=r?e:i,this._layoutCache.attPos=r?"x":"y",this._layoutCache.attSize=r?"width":"height",this._getGlobalTransMatrix=t.getGlobalTransMatrix}clearDragEvents(){let t="browser"===hd.env?hd:this.stage,e=IR();t.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),e.forEach(e=>{t.removeEventListener(e,this._onHandlerPointerUp)}),this.off("pointermove",this._onHandlerPointerMove,{capture:!0})}clearVGlobalEvents(){("browser"===hd.env?hd:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}bindEvents(){var t,e,i,r,n,l,s,a;let{brushSelect:o}=this.attribute;null==(t=this._startHandlerMask)||t.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"start")),null==(e=this._endHandlerMask)||e.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"end")),null==(i=this._middleHandlerSymbol)||i.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"middleSymbol")),null==(r=this._middleHandlerRect)||r.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"middleRect"));let h=o?"background":"middleRect";null==(n=this._selectedBackground)||n.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,h)),o&&(null==(l=this._background)||l.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"background"))),o&&(null==(s=this._previewGroup)||s.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"background"))),null==(a=this._selectedPreviewGroup)||a.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,h)),("browser"===hd.env?hd:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}_setStateAttr(t,e){let{zoomLock:i=!1,minSpan:r=0,maxSpan:n=1}=this.attribute,l=e-t;l!==this._spanCache&&(i||l<r||l>n)||(this._spanCache=l,this._setState({start:t,end:e}))}_moveZoomWithMiddle(t){let{start:e,end:i}=this._getState();return t>0&&i+t>1?t=1-i:t<0&&e+t<0&&(t=-e),{start:(0,yj.Z)(e+t,0,1),end:(0,yj.Z)(i+t,0,1)}}_moveZoomWithHandler(t,e){let{start:i,end:r}=this._getState(),n=i,l=r;return"start"===e?t>r?(n=r,l=t,this._activeTag=eP.endHandler):n=t:"end"===e&&(t<i?(l=i,n=t,this._activeTag=eP.startHandler):l=t),{start:(0,yj.Z)(n,0,1),end:(0,yj.Z)(l,0,1)}}_moveZoomWithBackground(t){let{position:e}=this._getLayoutAttrFromConfig(),{attSize:i}=this._layoutCache,r=(this._activeCache.startPos[this._layoutCache.attPos]-e[this._layoutCache.attPos])/this._getLayoutAttrFromConfig()[i],n=(0,yj.Z)(r,0,1),l=(0,yj.Z)(t,0,1);return n>l&&([n,l]=[l,n]),{start:n,end:l}}_eventPosToStagePos(t){var e,i;let r={x:0,y:0},n=null!=(i=null==(e=this.stage)?void 0:e.eventPointTransform(t))?i:{x:0,y:0};return this._getGlobalTransMatrix().transformPoint(n,r),r}_dispatchEvent(t,e){this.emit(t,e)}}Sh(),c7(),cH(),A9(),_W();class LL extends CB{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},LL.defaultAttributes,t)),this.name="dataZoom",this._state={start:0,end:1},this.getLayoutAttrFromConfig=()=>{var t,e,i,r,n,l;let s,a,o;if(this._layoutCacheFromConfig)return this._layoutCacheFromConfig;let{position:h,size:d,orient:u,middleHandlerStyle:c={},startHandlerStyle:p={},endHandlerStyle:g={},backgroundStyle:f={}}=this.attribute,{width:m,height:y}=d,v=null!=(e=null==(t=c.background)?void 0:t.size)?e:10;c.visible?this._isHorizontal?(s=m,a=y-v,o={x:h.x,y:h.y+v}):(s=m-v,a=y,o={x:h.x+("left"===u?v:0),y:h.y}):(s=m,a=y,o=h);let b=null!=(i=p.size)?i:this._isHorizontal?a:s,_=null!=(r=g.size)?r:this._isHorizontal?a:s;return p.visible&&(this._isHorizontal?(s-=(b+_)/2,o={x:o.x+b/2,y:o.y}):(a-=(b+_)/2,o={x:o.x,y:o.y+b/2})),a+=(null!=(n=f.lineWidth)?n:2)/2,s+=(null!=(l=f.lineWidth)?l:2)/2,this._layoutCacheFromConfig={position:o,width:s,height:a},this._layoutCacheFromConfig};let{start:i,end:r,orient:n}=this.attribute;this._isHorizontal="top"===n||"bottom"===n,i&&(this._state.start=i),r&&(this._state.end=r),this._renderer=new LB(this._getRendererAttrs()),this._interaction=new LE(this._getInteractionAttrs())}_getRendererAttrs(){return{attribute:this.attribute,getLayoutAttrFromConfig:this.getLayoutAttrFromConfig,setState:t=>{this._state=t},getState:()=>this._state,getContainer:()=>this._container}}_getInteractionAttrs(){return{stage:this.stage,attribute:this.attribute,startHandlerMask:this._renderer.startHandlerMask,endHandlerMask:this._renderer.endHandlerMask,middleHandlerSymbol:this._renderer.middleHandlerSymbol,middleHandlerRect:this._renderer.middleHandlerRect,selectedBackground:this._renderer.selectedBackground,background:this._renderer.background,previewGroup:this._renderer.previewGroup,selectedPreviewGroup:this._renderer.selectedPreviewGroup,getLayoutAttrFromConfig:this.getLayoutAttrFromConfig,setState:t=>{this._state=t},getState:()=>this._state,getGlobalTransMatrix:()=>this.globalTransMatrix}}bindEvents(){this.attribute.disableTriggerEvent?this.setAttribute("childrenPickable",!1):(this._interaction.bindEvents(),this._interaction.on(eB.stateUpdate,({shouldRender:t})=>{t&&this._renderer.renderDataZoom(!0)}),this._interaction.on(eB.dataZoomUpdate,({start:t,end:e,tag:i})=>{this._dispatchEvent(eI.dataZoomChange,{start:t,end:e,tag:i})}),this._interaction.on(eB.maskUpdate,()=>{this._renderer.renderDragMask()}),"auto"===this.attribute.showDetail&&(this._container.addEventListener("pointerenter",()=>{this._renderer.showText=!0,this._renderer.renderText()}),this._container.addEventListener("pointerleave",()=>{this._renderer.showText=!1,this._renderer.renderText()})))}setAttributes(t,e){var i,r;let{start:n,end:l}=this.attribute;n&&(this._state.start=null!=(i=t.start)?i:n),l&&(this._state.end=null!=(r=t.end)?r:l),this._renderer.setAttributes(this._getRendererAttrs()),this._interaction.setAttributes(this._getInteractionAttrs()),super.setAttributes(t,e)}render(){this._layoutCacheFromConfig=null,this._container=this.createOrUpdateChild("datazoom-container",{},"group"),this._renderer.renderDataZoom(),this._interaction.setAttributes(this._getInteractionAttrs())}release(t){super.release(t),this._interaction.clearDragEvents()}setStartAndEnd(t,e){let{start:i,end:r}=this._state;(0,aw.Z)(t)&&(0,aw.Z)(e)&&(t!==i||e!==r)&&(this._state={start:t,end:e},this._renderer.renderDataZoom(!0),this._dispatchEvent(eI.dataZoomChange,{start:t,end:e}))}setPreviewData(t){this._renderer.previewData=t}setText(t,e){"start"===e?this._renderer.startText.setAttribute("text",t):this._renderer.endText.setAttribute("text",t)}getStartValue(){return this._renderer.startValue}getEndTextValue(){return this._renderer.endValue}getMiddleHandlerSize(){var t,e,i,r;let{middleHandlerStyle:n={}}=this.attribute,l=null!=(e=null==(t=n.background)?void 0:t.size)?e:10,s=null!=(r=null==(i=n.icon)?void 0:i.size)?r:10;return Math.max(l,...(0,a1.IX)(s))}setPreviewPointsX(t){(0,nz.Z)(t)&&(this._renderer.previewPointsX=t)}setPreviewPointsY(t){(0,nz.Z)(t)&&(this._renderer.previewPointsY=t)}setPreviewPointsX1(t){(0,nz.Z)(t)&&(this._renderer.previewPointsX1=t)}setPreviewPointsY1(t){(0,nz.Z)(t)&&(this._renderer.previewPointsY1=t)}setStatePointToData(t){(0,nz.Z)(t)&&(this._renderer.statePointToData=t)}}LL.defaultAttributes={orient:"bottom",showDetail:"auto",brushSelect:!0,zoomLock:!1,minSpan:0,maxSpan:1,delayType:"throttle",delayTime:0,realTime:!0,backgroundStyle:{fill:"white",stroke:"#D1DBEE",lineWidth:1,cornerRadius:2},dragMaskStyle:{fill:"#B0C8F9",fillOpacity:.2},backgroundChartStyle:{area:{visible:!0,stroke:"#D1DBEE",lineWidth:1,fill:"#F6F8FC"},line:{visible:!0,stroke:"#D1DBEE",lineWidth:1}},selectedBackgroundStyle:{fill:"#B0C8F9",fillOpacity:.5},selectedBackgroundChartStyle:{area:{visible:!0,stroke:"#B0C8F9",lineWidth:1,fill:"#fbb934"},line:{visible:!0,stroke:"#fbb934",lineWidth:1}},middleHandlerStyle:{visible:!0,background:{size:8,style:{fill:"white",stroke:"#B0C8F9",cornerRadius:2}},icon:{size:6,fill:"white",stroke:"#B0C8F9",symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}},startHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:LT,fill:"white",stroke:"#B0C8F9",lineWidth:.5},endHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:LT,fill:"white",stroke:"#B0C8F9",lineWidth:.5},startTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}},endTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}}};class LF extends xz{_mergeThemeToSpec(t,e){let i=this._theme,r=t;if(this._shouldMergeThemeToSpec()){let e=t=>{let e=h5({selectedBackgroundChart:{line:{},area:{}}},this._theme,t),{selectedBackgroundChart:i={}}=t,{line:r,area:n}=i;return r&&!1!==r.visible&&(e.selectedBackgroundChart.line.style=Object.assign(Object.assign({},e.selectedBackgroundChart.line.style),{visible:!0})),n&&!1!==n.visible&&(e.selectedBackgroundChart.area.style=Object.assign(Object.assign({},e.selectedBackgroundChart.area.style),{visible:!0})),e};r=(0,rD.Z)(t)?t.map(t=>e(t)):e(t)}return this._adjustPadding(r),{spec:r,theme:i}}}let LO=()=>({style:{symbolType:"M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}}),LH=t=>({area:{style:{visible:t,stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{visible:t,stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}}),LD={padding:[12,0],showDetail:"auto",brushSelect:!1,middleHandler:{visible:!1,background:{size:6,style:{stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},cornerRadius:2}},icon:{style:{size:4,fill:{type:"palette",key:"sliderHandleColor"},stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}}},background:{size:20,style:{fill:{type:"palette",key:"sliderRailColor"},lineWidth:0}},selectedBackground:{style:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.1,outerBorder:{stroke:{type:"palette",key:"sliderTrackColor"},strokeOpacity:.2,distance:-.5,lineWidth:1}}},selectedBackgroundChart:LH(!1),startHandler:LO(),endHandler:LO(),startText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},endText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},backgroundChart:LH(!0)};class Lz extends LM{constructor(t,e){var i;super(t,e),this.type=oQ.dataZoom,this.name=oQ.dataZoom,this.transformerConstructor=LF,this.specKey="dataZoom",this.layoutZIndex=ts.DataZoom,this.layoutLevel=ta.DataZoom,this.layoutType="region-relative",this._isReverseCache=!1,this._dataToPositionX=t=>{let e=this._isHorizontal?0:this._middleHandlerSize,i=this._isHorizontal?this._startHandlerSize/2:0,r=this._isHorizontal?this._stateScale:this._valueScale,n=this._isHorizontal?this._stateField:this._valueField;return r.scale(t[n])+this.getLayoutStartPoint().x+e+i},this._dataToPositionX2=t=>{let e=this._isHorizontal?0:this._middleHandlerSize,i=this._isHorizontal?this._startHandlerSize/2:0,r=this._isHorizontal?this._stateScale:this._valueScale,n=r.domain()[0];return r.scale(n)+this.getLayoutStartPoint().x+e+i},this._dataToPositionY=t=>{let e=this._isHorizontal?this._middleHandlerSize:0,i=this._isHorizontal?0:this._startHandlerSize/2,r=this._isHorizontal?this._valueScale:this._getPreviewStateScale(),n=this._isHorizontal?this._valueField:this._stateField;return r.scale(t[n])+this.getLayoutStartPoint().y+e+i},this._dataToPositionY2=t=>{let e=this._isHorizontal?this._middleHandlerSize:0,i=this._isHorizontal?0:this._startHandlerSize/2,r=this._isHorizontal?this._valueScale:this._getPreviewStateScale(),n=r.domain()[0];return r.scale(n)+this.getLayoutStartPoint().y+e+i},this._valueField="y",this._filterMode=null!=(i=t.filterMode)?i:"filter"}_handleChange(t,e,i,r){if(super._handleChange(t,e,i),this._shouldChange)if(i&&this._component)this._component.setStartAndEnd(t,e);else{let i=this._relatedAxisComponent,n=Lv(t,this._stateScale,L_(i,this._isHorizontal)),l=Lv(e,this._stateScale,L_(i,this._isHorizontal));if(!(0,aw.Z)(n)||!(0,aw.Z)(l))return;this._start=t,this._end=e,((0,nz.Z)(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(t,e,n,l):this._handleStateChange(n,l,r))&&this.event.emit(J.dataZoomChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:t,end:e,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){this._data.getDataView().reRunAllTransform();let t=this._computeDomainOfValueScale();t&&(this._valueScale||(this._valueScale=new pM.f),this._valueScale.domain(t),this._updateValueScaleRange(),this._component&&this._createOrUpdateComponent(!0))}created(){super.created(),this._initValueScale()}updateLayoutAttribute(){!1!==this._cacheVisibility&&super.updateLayoutAttribute()}_beforeLayoutEnd(){super._beforeLayoutEnd();let t=this._relatedAxisComponent;(L_(t,this._isHorizontal)&&!this._isReverseCache||this._auto)&&(this._isReverseCache=L_(t,this._isHorizontal),this.effect.onZoomChange())}clear(){if(this._component){let t=this.getContainer();this._component.removeAllChild(),t&&t.removeChild(this._component),this._component=null}super.clear()}getBoundsInRect(t){var e,i,r,n;let l={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},s=this._startHandlerSize*(null!=(e=this._spec.startHandler.style.scaleX)?e:1),a=this._startHandlerSize*(null!=(i=this._spec.startHandler.style.scaleY)?i:1),o=this._endHandlerSize*(null!=(r=this._spec.endHandler.style.scaleX)?r:1),h=this._endHandlerSize*(null!=(n=this._spec.endHandler.style.scaleY)?n:1),d=this._visible?this._isHorizontal?(s-this._startHandlerSize)/2+(o-this._endHandlerSize)/2:(Math.max(s,o)-this._width)/2:0,u=this._visible?this._isHorizontal?(Math.max(a,h)-this._height)/2:(a-this._startHandlerSize)/2+(h-this._endHandlerSize)/2:0;return this._isHorizontal?(l.y2=l.y1+this._height+u,l.x2=l.x1+t.width+d):(l.x2=l.x1+this._width+d,l.y2=l.y1+t.height+u),l}setAttrFromSpec(){var t,e,i,r,n,l,s,a,o,h;super.setAttrFromSpec();let d=this._isHorizontal?Number(this._spec.height):Number(this._spec.width);this._backgroundSize=null!=(e=null==(t=this._spec.background)?void 0:t.size)?e:30,this._middleHandlerSize=this._computeMiddleHandlerSize(),(0,nB.Z)(null==(n=null==(r=null==(i=this._spec)?void 0:i.startHandler)?void 0:r.style)?void 0:n.size)&&(this._spec.startHandler.style.size=isNaN(d)?this._backgroundSize:d-this._middleHandlerSize),(0,nB.Z)(null==(a=null==(s=null==(l=this._spec)?void 0:l.endHandler)?void 0:s.style)?void 0:a.size)&&(this._spec.endHandler.style.size=isNaN(d)?this._backgroundSize:d-this._middleHandlerSize);let u=null==(o=this._spec.startHandler.style.visible)||o,c=null==(h=this._spec.endHandler.style.visible)||h;this._startHandlerSize=u?this._spec.startHandler.style.size:0,this._endHandlerSize=c?this._spec.endHandler.style.size:0,this._width=this._computeWidth(),this._height=this._computeHeight()}_initValueScale(){let t=this._computeDomainOfValueScale();if(t){let e=new pM.f;e.domain(t),this._valueScale=e}}_updateScaleRange(){this._updateStateScaleRange(),this._updateValueScaleRange()}_updateStateScaleRange(){var t,e,i;let r,n=this._startHandlerSize+this._endHandlerSize;if(!this._stateScale)return;let l=this._isHorizontal?this.getLayoutRect().width-n:this.getLayoutRect().height-n,s=null!=(e=null==(t=this._relatedAxisComponent)?void 0:t.getScale().range())?e:[this._startHandlerSize/2,l+this._startHandlerSize/2],a=this._computeWidth(),o=this._computeHeight();r=this._isHorizontal?this._visible?[this._startHandlerSize/2,a-n+this._startHandlerSize/2]:s:this._visible?[this._startHandlerSize/2,o-n+this._startHandlerSize/2]:s,this._stateScale.range(r),null==(i=this._previewStateScale)||i.range(L_(this._relatedAxisComponent,this._isHorizontal)?r.reverse():r)}_updateValueScaleRange(){if(!this._valueScale)return;let t=this._computeWidth(),e=this._computeHeight();this._isHorizontal?this._valueScale.range([e-this._middleHandlerSize,0]):"left"===this.layoutOrient?this._valueScale.range([t-this._middleHandlerSize,0]):this._valueScale.range([0,t-this._middleHandlerSize])}_computeDomainOfValueScale(){let t=this._data.getLatestData().map(t=>t[this._valueField]),e=t.map(t=>+t);return t.length?[(0,a1.iH)(e),(0,a1.CE)(e)]:null}_isScaleValid(t){if(!t||!t.domain())return!1;let e=t.domain();return(!(0,pW.z2)(t.type)||e[0]!==(0,a1.Z$)(e))&&(!(0,pW.lK)(t.type)||1!==(0,a1.V4)(e).length)}_getXScale(){return this._relatedAxisComponent.getScale().type===this.stateScale.type&&this._isHorizontal?this.stateScale:this._isHorizontal?this._stateScale:this._valueScale}_getYScale(){return this._isHorizontal?this._valueScale:this._stateScale}_computeMiddleHandlerSize(){var t,e,i,r;let n=0;return(null==(e=null==(t=this._spec)?void 0:t.middleHandler)?void 0:e.visible)&&(n+=Math.max(null!=(i=this._spec.middleHandler.icon.style.size)?i:8,null!=(r=this._spec.middleHandler.background.size)?r:40)),n}_computeWidth(){return!1===this._visible?0:(0,n4.Z)(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:Math.max(this._startHandlerSize||0,this._endHandlerSize||0,this._backgroundSize||0)+this._middleHandlerSize}_computeHeight(){return!1===this._visible?0:(0,n4.Z)(this._spec.height)?this._spec.height:this._isHorizontal?Math.max(this._startHandlerSize||0,this._endHandlerSize||0,this._backgroundSize||0)+this._middleHandlerSize:this.getLayoutRect().height}_getAttrs(t){var e,i,r,n,l;let s=null!=(e=this._spec)?e:{};return Object.assign({zIndex:this.layoutZIndex,start:this._start,end:this._end,position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},orient:this._orient,size:{width:this._computeWidth(),height:this._computeHeight()},showDetail:s.showDetail,brushSelect:null!=(i=s.brushSelect)&&i,zoomLock:null!=(r=s.zoomLock)&&r,minSpan:this._minSpan,maxSpan:this._maxSpan,delayType:s.delayType,delayTime:(0,aw.Z)(s.delayType)?null!=(n=s.delayTime)?n:30:0,realTime:null==(l=s.realTime)||l,previewData:t&&this._data.getLatestData(),previewPointsX:t&&this._dataToPositionX,previewPointsY:t&&this._dataToPositionY,tolerance:this._spec.tolerance,isReverse:L_(this._relatedAxisComponent,this._isHorizontal)},this._getComponentAttrs(t))}_getLayoutAttrs(){return{position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},size:{width:this._computeWidth(),height:this._computeHeight()}}}_createOrUpdateComponent(t){if(this._visible){let e=this._isHorizontal?this._stateScale:this._valueScale,i=this._isHorizontal?this._valueScale:this._stateScale,r=this._isScaleValid(e)&&this._isScaleValid(i)&&!1!==this._spec.showBackgroundChart,n=this._getAttrs(r),l=this._relatedAxisComponent;if(this._component)this._component.setAttributes(n),t&&(this._component.setPreviewData(this._data.getDataView().latestData),r&&(this._isHorizontal?this._component.setPreviewPointsY1(this._dataToPositionY2):this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData(t=>Lv(t,this._stateScale,L_(l,this._isHorizontal)))));else{let t=this.getContainer();this._component=new LL(n),this._component.setPreviewData(this._data.getDataView().latestData),this._isHorizontal?r&&this._component.setPreviewPointsY1(this._dataToPositionY2):r&&this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData(t=>Lv(t,this._stateScale,L_(l,this._isHorizontal))),this._component.addEventListener("dataZoomChange",t=>{let{start:e,end:i,tag:r}=t.detail;this._handleChange(e,i,void 0,r)}),t.add(this._component)}}}_getComponentAttrs(t){var e,i,r,n,l,s,a,o,h,d,u;let{middleHandler:c={},startText:p={},endText:g={},backgroundChart:f={},selectedBackgroundChart:m={}}=this._spec;return{backgroundStyle:xg(null==(e=this._spec.background)?void 0:e.style),startHandlerStyle:xg(null==(i=this._spec.startHandler)?void 0:i.style),middleHandlerStyle:c.visible?{visible:!0,icon:xg(null==(r=c.icon)?void 0:r.style),background:{size:null==(n=c.background)?void 0:n.size,style:xg(null==(l=c.background)?void 0:l.style)}}:{visible:!1},endHandlerStyle:xg(null==(s=this._spec.endHandler)?void 0:s.style),startTextStyle:{padding:p.padding,formatMethod:this._getHandlerTextFormatMethod(p),textStyle:xg(p.style)},endTextStyle:{padding:g.padding,formatMethod:this._getHandlerTextFormatMethod(g),textStyle:xg(g.style)},selectedBackgroundStyle:xg(this._spec.selectedBackground.style),dragMaskStyle:xg(null==(a=this._spec.dragMask)?void 0:a.style),backgroundChartStyle:t?{line:h5(xg(null==(o=f.line)?void 0:o.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},xg(null==(h=f.area)?void 0:h.style))}:{line:{visible:!1},area:{visible:!1}},selectedBackgroundChartStyle:t?{line:h5(xg(null==(d=m.line)?void 0:d.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},xg(null==(u=m.area)?void 0:u.style))}:{line:{visible:!1},area:{visible:!1}},disableTriggerEvent:this._option.disableTriggerEvent}}_getHandlerTextFormatMethod(t){let{formatMethod:e,formatter:i}=t,{formatFunc:r}=bz(e,i);return r?t=>r(t,{label:t},i):void 0}_getNeedClearVRenderComponents(){return[this._component]}onDataUpdate(){super.onDataUpdate(),this._previewStateScale!==this._stateScale&&(this._previewStateScale=null)}_getPreviewStateScale(){return this._previewStateScale||(L_(this._relatedAxisComponent,this._isHorizontal)?(this._previewStateScale=this._stateScale.clone(),this._previewStateScale.range(this._stateScale.range().reverse())):this._previewStateScale=this._stateScale),this._previewStateScale}}Lz.type=oQ.dataZoom,Lz.transformerConstructor=LF,Lz.builtInTheme={dataZoom:LD},Lz.specKey="dataZoom";let LW=()=>{h9.registerComponent(Lz.type,Lz)};class LZ extends LM{constructor(t,e){var i;super(t,e),this.type=oQ.scrollBar,this.name=oQ.scrollBar,this.specKey="scrollBar",this.layoutZIndex=ts.DataZoom,this.layoutLevel=ta.DataZoom,this.layoutType="region-relative",this._filterMode=null!=(i=t.filterMode)?i:"axis"}_handleChange(t,e,i){super._handleChange(t,e,i);let r=by(this._start,t)&&by(this._end,e);if(this._shouldChange&&(!r||!1===this._spec.realTime)){i&&this._component&&this._component.setAttribute("range",[t,e]),this._start=t,this._end=e;let r=Lv(t,this._stateScale,!1),n=Lv(e,this._stateScale,!1);((0,nz.Z)(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(t,e,r,n):this._handleStateChange(r,n))&&this.event.emit(J.scrollBarChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:this._start,end:this._end,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){this._spec.auto&&this._data.getDataView().reRunAllTransform()}_beforeLayoutEnd(){var t,e;super._beforeLayoutEnd(),null==(e=(t=this.effect).onZoomChange)||e.call(t)}onLayoutEnd(){this._updateComponentBounds(),super.onLayoutEnd()}_updateScaleRange(){}_updateComponentBounds(){this._component&&this._component.setAttributes({x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height})}_computeWidth(){return!1===this._visible?0:(0,n4.Z)(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:12}_computeHeight(){return!1===this._visible?0:(0,n4.Z)(this._spec.height)?this._spec.height:this._isHorizontal?12:this.getLayoutRect().height}_getAttrs(){var t,e,i,r,n,l;return Object.assign({zIndex:this.layoutZIndex,x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height,range:[this._start,this._end],direction:this._isHorizontal?"horizontal":"vertical",delayType:null==(t=this._spec)?void 0:t.delayType,delayTime:(0,aw.Z)(null==(e=this._spec)?void 0:e.delayType)?null!=(r=null==(i=this._spec)?void 0:i.delayTime)?r:30:0,realTime:null==(l=null==(n=this._spec)?void 0:n.realTime)||l},this._getComponentAttrs())}_createOrUpdateComponent(){let t=this._getAttrs();if(this._component)this._component.setAttributes(t);else{let e=this.getContainer();this._component=new IB(t),this._component.addEventListener("scrollDrag",t=>{let e=t.detail.value;this._handleChange(e[0],e[1])}),this._component.addEventListener("scrollUp",t=>{let e=t.detail.value;this._handleChange(e[0],e[1])}),e.add(this._component)}}_getComponentAttrs(){let{rail:t,slider:e,innerPadding:i}=this._spec,r={};return(0,nB.Z)(i)||(r.padding=i),(0,uF.Z)(null==t?void 0:t.style)||(r.railStyle=xg(t.style)),(0,uF.Z)(null==e?void 0:e.style)||(r.sliderStyle=xg(e.style)),r.disableTriggerEvent=this._option.disableTriggerEvent,r}_getNeedClearVRenderComponents(){return[this._component]}}LZ.type=oQ.scrollBar,LZ.builtInTheme={scrollBar:{horizontal:{height:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}},vertical:{width:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}}}},LZ.specKey="scrollBar";let LN=()=>{h9.registerComponent(LZ.type,LZ)},Lj=(t,e)=>{let{datum:i,title:r,content:n}=e,l=[],s=i.call(null);return r.visible&&l.push({type:"title",index:0,datum:s,spec:r}),(0,a1.IX)(n).forEach((t,e)=>{t.visible&&l.push({type:"content",index:e,datum:s,spec:t})}),l},LG={title:{style:{text:"",fontSize:20,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{style:{text:"",fontSize:16,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}};uD(),cw(),Cw();class LV extends CB{constructor(){super(...arguments),this.name="indicator"}_renderText(t,e,i,r,n,l){if(!1!==e.visible){let s=(0,h3.Z)({},(0,dx.Z)(LG,n),e.style,{visible:e.visible});s.lineHeight=(0,aw.Z)(s.lineHeight)?s.lineHeight:s.fontSize,e.formatMethod&&(s._originText=s.text,s.text=e.formatMethod(s.text,s));let a=g3(s);return a.name=l,t.appendChild(a),e.autoFit&&(0,hy.Z)(i)&&this._setLocalAutoFit(i,a,e),e.autoLimit&&(0,hy.Z)(r)&&a.setAttribute("maxLineWidth",i),a}}render(){var t,e;if(this.removeAllChild(!0),!0!==this.attribute.visible)return;let{title:i={},content:r,size:n,limitRatio:l=1/0}=this.attribute,s=Math.min(n.width,n.height)*l,a=this.createOrUpdateChild("indicator-container",{x:0,y:0,zIndex:1,pickable:null==(t=this.attribute.pickable)||t},"group");if((0,aw.Z)(i)&&(this._title=this._renderText(a,i,s,l,"title.style","indicator-title")),(0,aw.Z)(r)){let t=(0,a1.IX)(r),e=[];t.forEach((t,i)=>{!1!==t.visible&&e.push(this._renderText(a,t,s,l,"content.style","indicator-content-"+i))}),this._content=e}this._setGlobalAutoFit(s),this._setYPosition();let o=null!=(e=null==a?void 0:a.AABBBounds.height())?e:0;a.setAttribute("y",n.height/2-o/2),a.setAttribute("x",n.width/2)}_setLocalAutoFit(t,e,i){var r,n,l,s,a,o,h,d,u;if("default"!==(null!=(r=i.fitStrategy)?r:"default"))return;let c=g0(null!=(l=null==(n=i.style)?void 0:n.text)?l:"",null!=(s=i.style)?s:{},null==(o=null==(a=this.stage)?void 0:a.getTheme())?void 0:o.text).width;if(c>0){let r=t*(null!=(h=i.fitPercent)?h:.5)/c,n=Math.floor((null!=(u=null==(d=i.style)?void 0:d.fontSize)?u:20)*r);e.setAttribute("fontSize",n),e.setAttribute("lineHeight",(0,aw.Z)(i.style.lineHeight)?i.style.lineHeight:n)}}_setGlobalAutoFit(t){var e,i,r,n,l,s,a;let o=[],h=0,d=null!=(e=this.attribute.title)?e:{};d.autoFit&&"inscribed"===d.fitStrategy?(this._title.setAttribute("fontSize",12),o.push({text:this._title,spec:null!=(i=this.attribute.title)?i:{}})):h+=null!=(s=null==(l=null==(n=null==(r=this._title)?void 0:r.AABBBounds)?void 0:n.height)?void 0:l.call(n))?s:0;let u=null!=(a=d.space)?a:0;if(h+=u,(0,a1.IX)(this.attribute.content).filter(t=>!1!==t.visible).forEach((t,e)=>{var i,r,n,l;let s=this._content[e];t.autoFit&&"inscribed"===t.fitStrategy?(s.setAttribute("fontSize",12),o.push({text:s,spec:t})):h+=null!=(n=null==(r=null==(i=null==s?void 0:s.AABBBounds)?void 0:i.height)?void 0:r.call(i))?n:0;let a=null!=(l=t.space)?l:0;h+=a}),o.length<=0)return;let c=12/o.reduce((t,e)=>Math.max(t,e.text.AABBBounds.width()),0)*o.length,p=h/2,g=c**2+1,f=2*p*c,m=2*(c*((-f+Math.sqrt(f**2-4*g*(p**2-(t/2)**2)))/(2*g))+p),y=(m-h)/o.length;(0,hy.Z)(m)&&o.forEach(t=>{var e;let i=null==(e=t.spec.style)?void 0:e.lineHeight;t.text.setAttribute("fontSize",y),t.text.setAttribute("lineHeight",(0,aw.Z)(i)?i:y)})}_setYPosition(){var t,e,i,r,n,l;let s=0,a=null!=(r=null==(i=null==(e=null==(t=this._title)?void 0:t.AABBBounds)?void 0:e.height)?void 0:i.call(e))?r:0,o=null!=(l=null==(n=this.attribute.title)?void 0:n.space)?l:0;(0,a1.IX)(this.attribute.content).filter(t=>!1!==t.visible).forEach((t,e)=>{var i;let r=this._content[e];r.setAttribute("y",a+o+s);let n=null!=(i=t.space)?i:0;s+=r.AABBBounds.height()+n})}}let LU=(t,e)=>({fontSize:{type:"token",key:t},fill:{type:"palette",key:e},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}),LK={title:{visible:!0,autoLimit:!1,autoFit:!1,style:LU("l1FontSize","primaryFontColor")},content:{visible:!0,style:LU("l2FontSize","tertiaryFontColor")}};var LX=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class LY extends xZ{constructor(){super(...arguments),this.type=oQ.indicator,this.name=oQ.indicator,this.specKey="indicator",this.layoutType="none",this.layoutZIndex=ts.Indicator,this.layoutLevel=ta.Indicator,this._gap=0,this._activeDatum=null}static getSpecInfo(t){return bW(t,this.specKey,this.type,t=>t&&!1!==t.visible)}created(){super.created(),this.initData(),this.initEvent()}setAttrFromSpec(){super.setAttrFromSpec(),this._gap=this._spec.gap||0,this._title=this._spec.title,this._content=(0,a1.IX)(this._spec.content),this._regions=this._option.getRegionsInUserIdOrIndex((0,a1.IX)(this._spec.regionId),(0,a1.IX)(this._spec.regionIndex))}initEvent(){this._option.disableTriggerEvent||"none"!==this._spec.trigger&&("hover"===this._spec.trigger?(this.event.on("element-highlight:start",t=>{let e=t.graphics[0];this.isRelativeModel(e)&&this.updateDatum(dM(e))}),this.event.on("element-highlight:reset",t=>{this._activeDatum&&this.updateDatum(null)})):(this.event.on("element-select:start",t=>{let e=t.graphics[0];this.isRelativeModel(e)&&this.updateDatum(dM(e))}),this.event.on("element-select:reset",t=>{this._activeDatum&&this.updateDatum(null)})))}updateDatum(t){this._activeDatum=t,this._displayData.updateData();let e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e)}initData(){dL(this._option.dataSet,"indicatorFilter",Lj);let t=new eq.V(this._option.dataSet,{name:`${this.type}_${this.id}_data`});t.transform({type:"indicatorFilter",options:{title:this._title,content:this._content,datum:()=>this._activeDatum}}),t.target.addListener("change",this.updateDatum.bind(this)),this._displayData=new pV(this._option,t)}updateLayoutAttribute(){let t=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(t),super.updateLayoutAttribute()}_getIndicatorAttrs(){if(!1===this._spec.visible||!1===this._spec.fixed&&null===this._activeDatum)return{visible:!1};let t=this._regions[0],{width:e,height:i}=t.getLayoutRect(),{x:r,y:n}=t.getLayoutStartPoint(),l=this._spec,{content:s,offsetX:a,offsetY:o,limitRatio:h,title:d}=l,u=LX(l,["content","offsetX","offsetY","limitRatio","title"]),c=[];return(0,a1.IX)(s).forEach(t=>{let e=h5({},this._theme.content,t);c.push({visible:!1!==e.visible&&(!e.field||null!==this._activeDatum),space:e.space||this._gap,autoLimit:e.autoLimit,autoFit:e.autoFit,fitPercent:e.fitPercent,fitStrategy:e.fitStrategy,style:Object.assign(Object.assign({},xp((0,xN.Z)(e.style,["text"]),this._activeDatum)),{text:this._createText(e.field,e.style.text)})})}),Object.assign({visible:!0,size:{width:e,height:i},zIndex:this.layoutZIndex,x:r,y:n,dx:a?hk(a,this._computeLayoutRadius()):0,dy:o?hk(o,this._computeLayoutRadius()):0,limitRatio:h||1/0,title:{visible:!1!==d.visible&&(!(0,aw.Z)(d.field)||null!==this._activeDatum),space:d.space||this._gap,autoLimit:d.autoLimit,autoFit:d.autoFit,fitPercent:d.fitPercent,fitStrategy:d.fitStrategy,style:Object.assign(Object.assign({},xp((0,xN.Z)(d.style,["text"]),this._activeDatum)),{text:this._createText(d.field,d.style.text)})},content:c},u)}_createOrUpdateIndicatorComponent(t){if(!1===t.visible)return this._indicatorComponent&&this._indicatorComponent.parent&&this._indicatorComponent.parent.removeChild(this._indicatorComponent),void(this._indicatorComponent=null);if(this._indicatorComponent)(0,uL.X)(t,this._cacheAttrs)||this._indicatorComponent.setAttributes(t);else{let e=this.getContainer(),i=new LV(t);i.name="indicator",e.add(i),this._indicatorComponent=i,this._indicatorComponent.on("*",(t,e)=>this._delegateEvent(this._indicatorComponent,t,e))}this._cacheAttrs=t}_createText(t,e){var i;return t?this._activeDatum?this._activeDatum[t]:"":(0,nz.Z)(e)?null!=(i=e(this._activeDatum,void 0))?i:"":null!=e?e:""}_computeLayoutRadius(){let{width:t,height:e}=this._regions[0].getLayoutRect();return Math.min(t/2,e/2)}isRelativeModel(t){return this._regions.some(e=>!!e.getSeriesInId(t.context.modelId))}_getNeedClearVRenderComponents(){return[this._indicatorComponent]}clear(){this._cacheAttrs=null,super.clear()}getIndicatorComponent(){return this._indicatorComponent}}LY.type=oQ.indicator,LY.builtInTheme={indicator:LK},LY.specKey="indicator";let L$=()=>{h9.registerComponent(LY.type,LY)},Lq=["sum","average","min","max","variance","standardDeviation","median"];var LJ=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};function LQ(t,e,i){if(!i)return!1;let r=t.map(t=>+t),n=(0,a1.iH)(r),l=(0,a1.CE)(r);return e<n||e>l}function L0(t,e,i,r,n,l){var s,a;let{relativeSeries:o}=r;return(0,n4.Z)(t.x)&&LQ(e,t.x,i)&&(null==(a=null==o?void 0:(s=o.getXAxisHelper()).setExtendDomain)||a.call(s,"marker_xAxis_extend",t.x)),hC(t.x)?L5(t.x,n)+l.x:L4(o.getXAxisHelper(),[t.x])+l.x}function L1(t,e,i,r,n,l){var s,a;let{relativeSeries:o}=r;return(0,n4.Z)(t.y)&&LQ(e,t.y,i)&&(null==(a=null==(s=o.getYAxisHelper())?void 0:s.setExtendDomain)||a.call(s,"marker_yAxis_extend",t.y)),hC(t.y)?L5(t.y,n)+l.y:L4(o.getYAxisHelper(),[t.y])+l.y}function L2(t,e,i,r){var n,l;let{relativeSeries:s}=r;return(0,n4.Z)(t.angle)&&LQ(e,t.angle,i)&&(null==(l=null==(n=s.angleAxisHelper)?void 0:n.setExtendDomain)||l.call(n,"marker_angleAxis_extend",t.angle)),L4(s.angleAxisHelper,[t.angle])}function L3(t,e,i,r){var n,l;let{relativeSeries:s}=r;return(0,n4.Z)(t.radius)&&LQ(e,t.radius,i)&&(null==(l=null==(n=s.radiusAxisHelper)?void 0:n.setExtendDomain)||l.call(n,"marker_radiusAxis_extend",t.radius)),L4(s.radiusAxisHelper,[t.radius])}function L5(t,e){return Number(t.substring(0,t.length-1))*e/100}function L4(t,e){let i=t.getScale(0);return(0,pW.z2)(i.type)&&i.domain()[0]===i.domain()[1]&&e[0]!==i.domain()[0]?NaN:t.dataToPosition(e)}function L6(t){return Lq.includes(t)}function L7(t,e,i,r,n,l=!1){let s=e.getRegion(),a=s.getLayoutStartPoint(),o=i.getRegion(),h=o.getLayoutStartPoint(),d=Math.abs(Math.min(a.x,h.x)-Math.max(a.x+s.getLayoutRect().width,h.x+o.getLayoutRect().width)),u=Math.abs(Math.min(a.y,h.y)-Math.max(a.y+s.getLayoutRect().height,h.y+o.getLayoutRect().height)),c={relativeSeries:r,startRelativeSeries:e,endRelativeSeries:i},p=[],g=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,f=r.getXAxisHelper(),m=r.getYAxisHelper(),y=f.getScale(0).domain(),v=m.getScale(0).domain(),b=l&&!f.isContinuous&&!!f.getBandwidth,_=l&&!m.isContinuous&&!!m.getBandwidth,C={min:null,max:null},x={min:null,max:null};return g.forEach(t=>{let e,i,r=(0,aw.Z)(t.x),l=(0,aw.Z)(t.y);if(r&&l)e=L0(t,y,n,c,d,a),i=L1(t,v,n,c,u,a),L8(e,b,C,p.length),L8(i,_,x,p.length),p.push([{x:e,y:i}]);else if(r){e=L0(t,y,n,c,d,a),i=Math.max(a.y+s.getLayoutRect().height,h.y+o.getLayoutRect().height);let r=Math.min(a.y,h.y);L8(e,b,C,p.length),p.push([{x:e,y:i},{x:e,y:r}])}else if(l){e=Math.min(a.x,h.x),i=L1(t,v,n,c,u,a);let r=Math.max(a.x+s.getLayoutRect().width,h.x+o.getLayoutRect().width);L8(i,_,x,p.length),p.push([{x:e,y:i},{x:r,y:i}])}}),function(t,e,i,r,n){if(r.min||r.max){let i=e.getBandwidth(0)*(1+e.getScale(0).paddingInner());r.min&&t[r.min.index].forEach(t=>t.x-=i/2),r.max&&t[r.max.index].forEach(t=>t.x+=i/2)}if(n.min||n.max){let e=i.getBandwidth(0)*(1+i.getScale(0).paddingInner());n.min&&t[n.min.index].forEach(t=>t.y-=e/2),n.max&&t[n.max.index].forEach(t=>t.y+=e/2)}}(p,f,m,C,x),p}function L8(t,e,i,r){return e&&((null===i.min||i.min.value>t)&&(i.min={value:t,index:r}),(null===i.max||i.max.value<t)&&(i.max={value:t,index:r})),t}function L9(t,e,i,r,n){let l={relativeSeries:r,startRelativeSeries:e,endRelativeSeries:i},s=[],a=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,o=r.angleAxisHelper.getScale(0).domain(),h=r.radiusAxisHelper.getScale(0).domain(),d=Math.min(r.getRegion().getLayoutRect().width/2,r.getRegion().getLayoutRect().height/2);return a.forEach(t=>{let e=(0,aw.Z)(t.angle),i=(0,aw.Z)(t.radius);if(e&&i){let e=L2(t,o,n,l),i=L3(t,h,n,l);s.push([{angle:e,radius:i}])}else if(e){let e=L2(t,o,n,l);s.push([{angle:e,radius:-d},{angle:e,radius:d}])}else if(i){let e=L3(t,h,n,l);s.push([{radius:e,angle:0},{radius:e,angle:2*Math.PI}])}}),s}function Ft(t,e,i,r){let n=[],l=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,s=(0,rD.Z)(r);return l.forEach((t,l)=>{var a,o,h,d;let u=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,c=u.getRegion(),p=c.getLayoutStartPoint(),{width:g,height:f}=c.getLayoutRect(),m=0,y=0;if(r){let t=s?r[l]:r,e=t.x,i=t.y;e&&(m=hC(e)?Number(e.substring(0,e.length-1))*g/100:e),i&&(y=hC(i)?Number(i.substring(0,i.length-1))*f/100:i)}let v=u.getXAxisHelper().getScale(0).domain(),b=u.getYAxisHelper().getScale(0).domain(),_=(0,a1.IX)(t.x),C=(0,a1.IX)(t.y);1===_.length&&(0,n4.Z)(_[0])&&LQ(v,_[0],i)&&(null==(o=null==(a=u.getXAxisHelper())?void 0:a.setExtendDomain)||o.call(a,"marker_xAxis_extend",_[0])),1===C.length&&(0,n4.Z)(C[0])&&LQ(b,C[0],i)&&(null==(d=null==(h=u.getYAxisHelper())?void 0:h.setExtendDomain)||d.call(h,"marker_yAxis_extend",C[0])),n.push({x:L4(u.getXAxisHelper(),_)+p.x+m,y:L4(u.getYAxisHelper(),C)+p.y+y})}),n}function Fe(t,e,i){let r=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach(t=>{var n,l,s,a;let o=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,h=o.angleAxisHelper.getScale(0).domain(),d=o.radiusAxisHelper.getScale(0).domain(),u=(0,a1.IX)(t.angle),c=(0,a1.IX)(t.radius);1===u.length&&(0,n4.Z)(u[0])&&LQ(h,u[0],i)&&(null==(l=null==(n=o.angleAxisHelper)?void 0:n.setExtendDomain)||l.call(n,"marker_xAxis_extend",u[0])),1===c.length&&(0,n4.Z)(c[0])&&LQ(d,c[0],i)&&(null==(a=null==(s=o.radiusAxisHelper)?void 0:s.setExtendDomain)||a.call(s,"marker_yAxis_extend",c[0])),r.push({angle:L4(o.angleAxisHelper,u),radius:L4(o.radiusAxisHelper,c)})}),r}function Fi(t,e,i){let{x:r,y:n}=t;return hC(r)&&(r=L5(r,e)),hC(n)&&(n=L5(n,i)),{x:r,y:n}}function Fr(t,e,i){let r;if(r=(0,nz.Z)(t)?(0,a1.IX)(t(e.getData().getLatestData(),e)):(0,a1.IX)(t),i){let t=e.getRegion(),{x:i,y:n}=t.getLayoutStartPoint(),{width:l,height:s}=t.getLayoutRect();return r.map(t=>{let{x:e,y:r}=Fi(t,l,s);return{x:e+=i,y:r+=n}})}let{width:n,height:l}=e.getOption().getChart().getViewRect();return r.map(t=>Fi(t,n,l))}function Fn(t){let e=1/0,i=-1/0,r=1/0,n=-1/0;return t.forEach(t=>{let l=t.getLayoutStartPoint(),s=t.getLayoutRect();l.x<e&&(e=l.x),l.x+s.width>i&&(i=l.x+s.width),l.y<r&&(r=l.y),l.y+s.height>n&&(n=l.y+s.height)}),{minX:e,maxX:i,minY:r,maxY:n}}function Fl(t,e,i){let{labelBackground:r={},style:n,shape:l}=t,s=LJ(t,["labelBackground","style","shape"]);return!1!==t.visible?((null==l?void 0:l.visible)?s.shape=Object.assign({visible:!0},xg(l.style)):s.shape={visible:!1},!1!==r.visible?(s.panel=Object.assign({visible:!0,customShape:r.customShape},Fa(xg(r.style),e,i)),(0,aw.Z)(r.padding)&&(s.padding=(0,wj.o)(r.padding))):(s.panel={visible:!1},s.padding=0),n&&(s.textStyle=Fa(xg(n),e,i)),s):{visible:!1}}function Fs(t,e,i){for(let r in t)(0,nz.Z)(t[r])&&(t[r]=t[r](e,i));return t}function Fa(t,e,i){return(0,nz.Z)(t)?t(e,i):t}function Fo(t,e){return(0,nz.Z)(t)?t(e):t}function Fh(t,e,i){return(0,aw.Z)(t)?"regionLeft"===e?i.getLayoutStartPoint().x-t.x:"regionRight"===e?i.getLayoutStartPoint().x+i.getLayoutRect().width-t.x:"regionTop"===e?i.getLayoutStartPoint().y-t.y:"regionBottom"===e?i.getLayoutStartPoint().y+i.getLayoutRect().height-t.y:e:e}function Fd(t){return{isXProcess:(0,aw.Z)(t.x),isYProcess:(0,aw.Z)(t.y),isX1Process:(0,aw.Z)(t.x1),isY1Process:(0,aw.Z)(t.y1),isAngleProcess:(0,aw.Z)(t.angle),isRadiusProcess:(0,aw.Z)(t.radius),isAngle1Process:(0,aw.Z)(t.angle1),isRadius1Process:(0,aw.Z)(t.radius1),isCoordinatesProcess:(0,aw.Z)(t.coordinates),isValidProcess:(0,aw.Z)(t.process)}}function Fu(t){let{isXProcess:e,isYProcess:i,isX1Process:r,isY1Process:n,isAngleProcess:l,isRadiusProcess:s,isAngle1Process:a,isRadius1Process:o,isCoordinatesProcess:h,isValidProcess:d}=Fd(t);return{doXProcess:e&&!i&&!n,doXYY1Process:e&&i&&n,doYProcess:i&&!e&&!r,doYXX1Process:i&&e&&r,doXYProcess:e&&i&&r&&n,doAngleProcess:l&&!a&&!s&&!o,doRadiusProcess:s&&!o&&!l&&!a,doAngRadRad1Process:l&&!a&&s&&o,doRadAngAng1Process:s&&l&&a&&!o,doRadAngProcess:l&&s&&a&&o,doCoordinatesProcess:h&&(!d||"process"in t&&"xy"in t.process)}}function Fc(t){let{isXProcess:e,isYProcess:i,isX1Process:r,isY1Process:n,isAngleProcess:l,isRadiusProcess:s,isAngle1Process:a,isRadius1Process:o,isCoordinatesProcess:h}=Fd(t);return{doXProcess:e&&r&&!i&&!n,doYProcess:i&&n&&!e&&!r,doXYProcess:e&&r&&i&&n,doAngleProcess:l&&a&&!s&&!o,doRadiusProcess:s&&o&&!l&&!a,doRadAngProcess:l&&s&&a&&o,doCoordinatesProcess:h}}function Fp(t){return{doXYProcess:(0,aw.Z)(t.x)&&(0,aw.Z)(t.y),doPolarProcess:(0,aw.Z)(t.angle)&&(0,aw.Z)(t.radius),doGeoProcess:(0,aw.Z)(t.areaName)}}let Fg=new class extends cG{constructor(){super(...arguments),this.time=o6.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){return super.drawShape(t,e,i,r,n,l,s,a,o,h,d,u)}};var Ff=function(t,e){return function(i,r){e(i,r,t)}};let Fm=["","repeat-x","repeat-y","repeat"],Fy=class extends ox{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=sa,this.builtinContributions=[Fg,og],this.init(t)}drawShape(t,e,i,r,n,l,s,a){let o=nP(t).image,{repeatX:h=o.repeatX,repeatY:d=o.repeatY,x:u=o.x,y:c=o.y,cornerRadius:p=o.cornerRadius,fillStrokeOrder:g=o.fillStrokeOrder,cornerType:f=o.cornerType,image:m}=t.attribute,y=this.valid(t,o,s);if(!y)return;let{fVisible:v,sVisible:b,doFill:_,doStroke:C}=y;if(!m||!t.resources)return;let x=t.resources.get(m);if("success"!==x.state)return;let w=t.width,S=t.height;e.beginPath();let A=!1;0===p||(0,rD.Z)(p)&&p.every(t=>0===t)?e.rect(i,r,w,S):(a3(e,i,r,w,S,p,"bevel"!==f),A=!0),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o);let M=()=>{if(_){if(s)s(e,t.attribute,o);else if(v){e.setCommonStyle(t,t.attribute,i,r,o);let n=0;if("repeat"===h&&(n|=1),"repeat"===d&&(n|=2),n){let t=e.createPattern(x.data,Fm[n]);e.fillStyle=t,e.translate(i,r,!0),e.fillRect(0,0,w,S),e.translate(-i,-r,!0)}else e.drawImage(x.data,i,r,w,S)}}},T=()=>{C&&(a?a(e,t.attribute,o):b&&(e.setStrokeStyle(t,t.attribute,u-i,c-r,o),e.stroke()))};g?(T(),A&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,r,_,!1,v,!1,o,n,s),M(),A&&e.restore()):(A&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,r,_,!1,v,!1,o,n,s),M(),A&&e.restore(),T()),this.afterRenderStep(t,e,i,r,_,!1,v,!1,o,n,s)}draw(t,e,i){let{image:r}=t.attribute;if(!r||!t.resources)return;let n=t.resources.get(r);if("loading"===n.state&&(0,nI.Z)(r))return void nj.improveImageLoading(r);if("success"!==n.state)return;let{context:l}=e.drawParams;if(!l)return;let s=nP(t).image;this._draw(t,s,!1,i)}};Fy=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),Ff(0,it(ii)),Ff(0,ie(ol)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Fy);let Fv=!1,Fb=new eQ(t=>{Fv||(Fv=!0,t(aa).to(Fy).inSingletonScope(),t(s4).toService(aa),t(ol).toService(of),il(t,ol))}),F_=class extends cE{constructor(t){super(),this.canvasRenderer=t,this.type="image",this.numberType=sa}};F_=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(er=it(aa),function(t,e){er(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],F_);let FC=!1,Fx=new eQ((t,e,i,r)=>{FC||(FC=!0,t(cr).to(F_).inSingletonScope(),t(cf).toService(cr))});function Fw(){Fw.__loaded||(Fw.__loaded=!0,ak.RegisterGraphicCreator("image",Ch),ib.load(Fb),ib.load(u$?Fx:f$))}function FS(){uD(),Sh(),yL()}function FA(t,e){let{x1:i,y1:r,x2:n,y2:l}=e,{x1:s,y1:a,x2:o,y2:h}=t.AABBBounds,d=0,u=0;return s<i&&(d=i-s),a<r&&(u=r-a),o>n&&(d=n-o),h>l&&(u=l-h),{dx:d,dy:u}}function FM(t,e){let{dx:i,dy:r}=FA(t,e),{dx:n=0,dy:l=0}=t.attribute;i&&t.setAttribute("dx",i+n),r&&t.setAttribute("dy",r+l)}Fw.__loaded=!1;class FT extends CB{constructor(){super(...arguments),this.name="marker",this._onHover=t=>{this._lastHover=Sc(t,this._container,this._lastHover)},this._onUnHover=t=>{this._lastHover=Sp(t,this._container,this._lastHover)},this._onClick=t=>{this._lastSelect=Sg(t,this._container,this._lastSelect)}}transAnimationConfig(){var t,e,i;if(!1!==this.attribute.animation){let r=(0,nF.Z)(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:(0,h3.Z)({},this.defaultUpdateAnimation,r,null!=(t=this.attribute.animationEnter)?t:{}),exit:(0,h3.Z)({},this.defaultExitAnimation,r,null!=(e=this.attribute.animationExit)?e:{}),update:(0,h3.Z)({},this.defaultUpdateAnimation,r,null!=(i=this.attribute.animationUpdate)?i:{})}}}setAttribute(t,e,i){super.setAttribute(t,e,i),"visible"===t&&this.render()}_bindEvent(){var t,e,i;if(!this.attribute.interactive)return;let{hover:r,select:n}=this.attribute;r&&(null==(t=this._container)||t.addEventListener("pointermove",this._onHover),null==(e=this._container)||e.addEventListener("pointerout",this._onUnHover)),n&&(null==(i=this._container)||i.addEventListener("pointerdown",this._onClick))}_releaseEvent(){var t,e,i;null==(t=this._container)||t.removeEventListener("pointermove",this._onHover),null==(e=this._container)||e.removeEventListener("pointerout",this._onUnHover),null==(i=this._container)||i.removeEventListener("pointerdown",this._onClick)}_initContainer(){var t,e;let i,{limitRect:r={},clipInRange:n}=this.attribute;if(n){let n=ak.group(Object.assign(Object.assign({},r),{clip:!0,pickable:!1}));i=ak.group({x:-(null!=(t=r.x)?t:0),y:-(null!=(e=r.y)?e:0),pickable:!1}),n.add(i),this._containerClip=n,this.add(n)}else i=ak.group({x:0,y:0,pickable:!1}),this.add(i);i.name="marker-container",this._container=i}_updateContainer(){var t,e;let{limitRect:i={},clipInRange:r}=this.attribute;this._containerClip&&this._containerClip.setAttributes(Object.assign({},i)),this._container.setAttributes({x:r?-(null!=(t=i.x)?t:0):0,y:r?-(null!=(e=i.y)?e:0):0})}render(){var t;this.transAnimationConfig(),this.setAttribute("pickable",!1);let e=null==(t=this.attribute.visible)||t;!1===this.attribute.interactive&&this.setAttribute("childrenPickable",!1),e&&this.isValidPoints()?this._container?(this._updateContainer(),this.updateMarker(),this.markerAnimate("update")):(this._initContainer(),this.initMarker(this._container),this.markerAnimate("enter")):(this.markerAnimate("exit"),this._container=null,this.removeAllChild(!0)),this._releaseEvent(),this._bindEvent()}release(){this.markerAnimate("exit"),super.release(),this._releaseEvent(),this._container=null}}function Fk(t,e,i,r){var n,l,s,a,o;if(!t)return;null==(n=null==t?void 0:t.animates)||n.forEach(t=>t.stop("end"));let h=null!=(s=null==(l=t.attribute)?void 0:l.fillOpacity)?s:1,d=null!=(o=null==(a=t.attribute)?void 0:a.strokeOpacity)?o:1;t.setAttributes({fillOpacity:0,strokeOpacity:0}),t.animate().wait(e).to({fillOpacity:h,strokeOpacity:d},i,r)}function FR(t,e,i,r){t&&(Fk(t.startSymbol,e,i,r),t.lines.forEach(t=>Fk(t,e,i,r)),Fk(t.line,e,i,r),Fk(t.endSymbol,e,i,r))}function FP(t,e,i,r){t&&(Fk(t.getTextShape(),e,i,r),Fk(t.getBgRect(),e,i,r))}function FB(t,e,i,r){var n,l,s,a;t&&(t.setAttributes({fillOpacity:null!=(l=null==(n=t.attribute)?void 0:n.fillOpacity)?l:1,strokeOpacity:null!=(a=null==(s=t.attribute)?void 0:s.strokeOpacity)?a:1}),t.animate().wait(e).to({fillOpacity:0,strokeOpacity:0},i,r))}function FI(t,e,i,r){t&&(FB(t.startSymbol,e,i,r),t.lines.forEach(t=>FB(t,e,i,r)),FB(t.line,e,i,r),FB(t.endSymbol,e,i,r))}function FE(t,e,i,r){t&&(FB(t.getTextShape(),e,i,r),FB(t.getBgRect(),e,i,r))}function FL(t,e,i,r,n){let l=.1*i,s=.7*i,a=.1*i,o=.1*i;Fk(t.startSymbol,r,l,n),t.lines.forEach(t=>t.setAttribute("clipRange",0)),t.lines.forEach((e,i)=>{let a=s/t.lines.length;e.animate().wait(r+l+i*a).to({clipRange:1},a,n)}),Fk(t.endSymbol,r+l+s,a,n),(0,a1.IX)(e).forEach(t=>{let e=r+l+s+a;Fk(t.getTextShape(),e,o,n),Fk(t.getBgRect(),e,o,n)})}function FF(t,e,i,r,n){FR(t,r,i,n),(0,a1.IX)(e).forEach(t=>{FP(t,r,i,n)})}function FO(t,e,i,r,n){Fk(t,r,i,n),(0,a1.IX)(e).forEach(t=>{FP(t,r,i,n)})}function FH(t,e,i,r,n){Fk(t,r,i,n),(0,a1.IX)(e).forEach(t=>{FP(t,r,i,n)})}function FD(t,e,i,r,n,l){var s;FR(t,n,r,l),Fk(e,n,r,l),(null==(s=i.getTextShape)?void 0:s.call(i))?FP(i,n,r,l):Fk(i,n,r,l)}function Fz(t,e,i,r,n,l){var s;let a=.1*r,o=.65*r,h=.05*r,d=.1*r,u=.1*r;Fk(t.startSymbol,n,a,l),t.lines.forEach(t=>t.setAttribute("clipRange",0)),t.lines.forEach((e,i)=>{let r=o/t.lines.length;e.animate().wait(n+a+i*r).to({clipRange:1},r,l)}),Fk(e,n+a+o,h,l),Fk(t.endSymbol,n+a+o+h,d,l),(null==(s=i.getTextShape)?void 0:s.call(i))?(Fk(i.getTextShape(),n+a+o+h+d,u,l),Fk(i.getBgRect(),n+a+o+d,u,l)):Fk(i,n+a+o+d,u,l)}function FW(t,e,i,r){let{enter:n,update:l,exit:s}=i;if("enter"===r){let{type:i,duration:r,delay:l,easing:s}=n;"clipIn"===i?FL(t,e,r,l,s):"fadeIn"===i&&FF(t,e,r,l,s)}else if("update"===r){let{type:i,duration:r,delay:n,easing:s}=l;"clipIn"===i?FL(t,e,r,n,s):"fadeIn"===i&&FF(t,e,r,n,s)}else if("exit"===r){let{duration:i,delay:r,easing:n}=s;FI(t,r,i,n),(0,a1.IX)(e).forEach(t=>{FE(t,r,i,n)})}}function FZ(t,e,i,r){let{enter:n,update:l,exit:s}=i;if("enter"===r){let{type:i,duration:r,delay:l,easing:s}=n;"fadeIn"===i&&FO(t,e,r,l,s)}else if("update"===r){let{type:i,duration:r,delay:n,easing:s}=l;"fadeIn"===i&&FO(t,e,r,n,s)}else if("exit"===r){let{duration:i,delay:r,easing:n}=s;FB(t,r,i,n),(0,a1.IX)(e).forEach(t=>{FE(t,r,i,n)})}}function FN(t,e,i,r){let{enter:n,update:l,exit:s}=i;if("enter"===r){let{type:i,duration:r,delay:l,easing:s}=n;"fadeIn"===i&&FH(t,e,r,l,s)}else if("update"===r){let{type:i,duration:r,delay:n,easing:s}=l;"fadeIn"===i&&FH(t,e,r,n,s)}else if("exit"===r){let{duration:i,delay:r,easing:n}=s;FB(t,r,i,n),(0,a1.IX)(e).forEach(t=>{FE(t,r,i,n)})}}function Fj(t,e,i,r){let[n,l]=t,{enter:s,update:a,exit:o}=i;if("enter"===r){let{type:t,duration:i,delay:r,easing:a}=s;"fadeIn"===t?FD(n,l,e,i,r,a):"callIn"===t&&Fz(n,l,e,i,r,a)}else if("update"===r){let{type:t,duration:i,delay:r,easing:s}=a;"fadeIn"===t?FD(n,l,e,i,r,s):"callIn"===t&&Fz(n,l,e,i,r,s)}else if("exit"===r){var h;let{duration:t,delay:i,easing:r}=o;FI(n,i,t,r),FB(l,i,t,r),(null==(h=e.getTextShape)?void 0:h.call(e))?FE(e,i,t,r):FB(e,i,t,r)}}let FG={type:"clipIn",duration:500,easing:"linear",delay:0},FV={type:"fadeIn",duration:500,easing:"linear",delay:0},FU={type:"callIn",duration:500,easing:"linear",delay:0},FK={type:"fadeOut",duration:500,easing:"linear",delay:0};class FX{getLabel(){return this._label}_addMarkLabels(t,e,i){let{label:r,state:n}=this.attribute,l=(0,a1.IX)(null==n?void 0:n.label),s=(0,a1.IX)(null==n?void 0:n.labelBackground),a=(0,a1.IX)(r).map((r,n)=>{var a,o;let h=(0,h3.Z)({},i,r),d=new Su(Object.assign(Object.assign({},h),{state:{panel:(0,h3.Z)({},g$,null!=(a=s[n])?a:(0,a1.Z$)(s)),text:(0,h3.Z)({},g$,null!=(o=l[n])?o:(0,a1.Z$)(l))}}));return d.name=e,t.add(d),this.setLabelPos(d,h),d});this._label=1===(0,a1.IX)(a).length?a[0]:a}_updateMarkLabels(t){let{label:e,state:i}=this.attribute,r=(0,a1.IX)(this._label),n=(0,a1.IX)(null==i?void 0:i.label),l=(0,a1.IX)(null==i?void 0:i.labelBackground);if(r.length){let i=(0,a1.IX)(e);r.forEach((e,r)=>{var s,a;let o=(0,h3.Z)({},t,i[r]);e.setAttributes(Object.assign(Object.assign({dx:0,dy:0},o),{state:{panel:(0,h3.Z)({},g$,null!=(s=l[r])?s:(0,a1.Z$)(l)),text:(0,h3.Z)({},g$,null!=(a=n[r])?a:(0,a1.Z$)(n))}})),this.setLabelPos(e,o)})}}}class FY extends FT{constructor(){super(...arguments),this.name="markCommonLine",this.defaultUpdateAnimation=FG,this.defaultExitAnimation=FK}getLine(){return this._line}setLabelPos(t,e){let{limitRect:i}=this.attribute,{position:r,confine:n,autoRotate:l}=e,s=this.getPointAttrByPosition(r,e),a=r.toString().toLocaleLowerCase().includes("start")?this._line.getStartAngle()||0:this._line.getEndAngle()||0;if(t.setAttributes(Object.assign(Object.assign({},s.position),{angle:l?this.getRotateByAngle(s.angle,e):0,textStyle:Object.assign(Object.assign({},this.getTextStyle(r,a,l)),e.textStyle)})),i&&n){let{x:e,y:r,width:n,height:l}=i;FM(t,{x1:e,y1:r,x2:e+n,y2:r+l})}}initMarker(t){let e=this.createSegment();e.name="mark-common-line-line",this._line=e,t.add(e),this.addMarkLineLabels(t)}updateMarker(){this.setLineAttributes(),this.updateMarkLineLabels()}}(0,yf.jB)(FY,FX),(en=eE||(eE={})).start="start",en.startTop="startTop",en.startBottom="startBottom",en.insideStart="insideStart",en.insideStartTop="insideStartTop",en.insideStartBottom="insideStartBottom",en.middle="middle",en.insideMiddleTop="insideMiddleTop",en.insideMiddleBottom="insideMiddleBottom",en.end="end",en.endTop="endTop",en.endBottom="endBottom",en.insideEnd="insideEnd",en.insideEndTop="insideEndTop",en.insideEndBottom="insideEndBottom",(el=eL||(eL={})).left="left",el.right="right",el.top="top",el.bottom="bottom",el.topLeft="topLeft",el.topRight="topRight",el.bottomLeft="bottomLeft",el.bottomRight="bottomRight",el.middle="middle",el.insideLeft="insideLeft",el.insideRight="insideRight",el.insideTop="insideTop",el.insideBottom="insideBottom",el.insideTopLeft="insideTopLeft",el.insideTopRight="insideTopRight",el.insideBottomLeft="insideBottomLeft",el.insideBottomRight="insideBottomRight",(es=eF||(eF={})).arcInnerStart="arcInnerStart",es.arcInnerEnd="arcInnerEnd",es.arcInnerMiddle="arcInnerMiddle",es.arcOuterStart="arcOuterStart",es.arcOuterEnd="arcOuterEnd",es.arcOuterMiddle="arcOuterMiddle",es.center="center",(ea=eO||(eO={})).top="top",ea.bottom="bottom",ea.middle="middle",ea.insideTop="insideTop",ea.insideBottom="insideBottom",ea.insideMiddle="insideMiddle";let F$={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:eE.end,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},Fq={postiveXAxis:{start:{textAlign:"left",textBaseline:"middle"},startTop:{textAlign:"left",textBaseline:"bottom"},startBottom:{textAlign:"left",textBaseline:"top"},insideStart:{textAlign:"right",textBaseline:"middle"},insideStartTop:{textAlign:"right",textBaseline:"bottom"},insideStartBottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"left",textBaseline:"middle"},endTop:{textAlign:"left",textBaseline:"bottom"},endBottom:{textAlign:"left",textBaseline:"top"},insideEnd:{textAlign:"right",textBaseline:"middle"},insideEndTop:{textAlign:"right",textBaseline:"bottom"},insideEndBottom:{textAlign:"right",textBaseline:"top"}},negativeXAxis:{start:{textAlign:"right",textBaseline:"middle"},startTop:{textAlign:"right",textBaseline:"bottom"},startBottom:{textAlign:"right",textBaseline:"top"},insideStart:{textAlign:"left",textBaseline:"middle"},insideStartTop:{textAlign:"left",textBaseline:"bottom"},insideStartBottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"right",textBaseline:"middle"},endTop:{textAlign:"right",textBaseline:"bottom"},endBottom:{textAlign:"right",textBaseline:"top"},insideEnd:{textAlign:"left",textBaseline:"middle"},insideEndTop:{textAlign:"left",textBaseline:"bottom"},insideEndBottom:{textAlign:"left",textBaseline:"top"}}},FJ={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{autoRotate:!0,position:eF.arcOuterMiddle,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},FQ={interactive:!0,label:{position:eL.right,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},F0={interactive:!0,label:{autoRotate:!0,position:eF.arcOuterMiddle,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},F1={arcInnerStart:{textAlign:"center",textBaseline:"bottom"},arcInnerEnd:{textAlign:"center",textBaseline:"bottom"},arcInnerMiddle:{textAlign:"center",textBaseline:"bottom"},arcOuterStart:{textAlign:"center",textBaseline:"top"},arcOuterEnd:{textAlign:"center",textBaseline:"top"},arcOuterMiddle:{textAlign:"center",textBaseline:"top"},center:{textAlign:"center",textBaseline:"middle"}},F2={left:{textAlign:"right",textBaseline:"middle"},insideLeft:{textAlign:"left",textBaseline:"middle"},right:{textAlign:"left",textBaseline:"middle"},insideRight:{textAlign:"right",textBaseline:"middle"},top:{textAlign:"center",textBaseline:"bottom"},insideTop:{textAlign:"center",textBaseline:"top"},bottom:{textAlign:"center",textBaseline:"top"},insideBottom:{textAlign:"center",textBaseline:"bottom"},middle:{textAlign:"center",textBaseline:"middle"},topLeft:{textAlign:"right",textBaseline:"top"},insideTopLeft:{textAlign:"left",textBaseline:"top"},topRight:{textAlign:"left",textBaseline:"top"},insideTopRight:{textAlign:"right",textBaseline:"top"},bottomLeft:{textAlign:"right",textBaseline:"bottom"},insideBottomLeft:{textAlign:"left",textBaseline:"bottom"},bottomRight:{textAlign:"left",textBaseline:"bottom"},insideBottomRight:{textAlign:"right",textBaseline:"bottom"}},F3={postiveXAxis:{top:{textAlign:"left",textBaseline:"bottom"},bottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"left",textBaseline:"middle"},insideTop:{textAlign:"right",textBaseline:"bottom"},insideBottom:{textAlign:"right",textBaseline:"top"},insideMiddle:{textAlign:"right",textBaseline:"middle"}},negativeXAxis:{top:{textAlign:"right",textBaseline:"bottom"},bottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"right",textBaseline:"middle"},insideTop:{textAlign:"left",textBaseline:"bottom"},insideBottom:{textAlign:"left",textBaseline:"top"},insideMiddle:{textAlign:"left",textBaseline:"middle"}}};function F5(){F4._animate=FW}FS(),Ss(),yL();class F4 extends FY{markerAnimate(t){F4._animate&&this._animationConfig&&F4._animate(this._line,this._label,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},F4.defaultAttributes,t)),this.name="markLine"}getPointAttrByPosition(t,e){var i;let{refX:r=0,refY:n=0}=e,l=this._line.getMainSegmentPoints(),s=null!=(i=this._line.getEndAngle())?i:0,a=(_$(s),s),o=r*Math.cos(a)+n*Math.cos(a-Math.PI/2),h=r*Math.sin(a)+n*Math.sin(a-Math.PI/2);return t.includes("start")||t.includes("Start")?{position:{x:l[0].x+o,y:l[0].y+h},angle:a}:t.includes("middle")||t.includes("Middle")?{position:{x:(l[0].x+l[l.length-1].x)/2+o,y:(l[0].y+l[l.length-1].y)/2+h},angle:a}:{position:{x:l[l.length-1].x+o,y:l[l.length-1].y+h},angle:a}}getRotateByAngle(t,e){var i;return(_$(t)?t:t-Math.PI)+(null!=(i=e.refAngle)?i:0)}getTextStyle(t,e,i){return _q(Math.abs(e),Math.PI/2,.001)||_q(Math.abs(e),3*Math.PI/2,.001)?_J(i,e,t):_$(e)?Fq.postiveXAxis[t]:Fq.negativeXAxis[t]}createSegment(){let{points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:l,state:s}=this.attribute;return new So({points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:l,pickable:!1,state:{line:(0,h3.Z)({},g$,null==s?void 0:s.line),startSymbol:(0,h3.Z)({},g$,null==s?void 0:s.lineStartSymbol),endSymbol:(0,h3.Z)({},g$,null==s?void 0:s.lineEndSymbol)}})}setLineAttributes(){let{points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:l,state:s}=this.attribute;this._line&&this._line.setAttributes({points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:l,state:{line:(0,h3.Z)({},g$,null==s?void 0:s.line),startSymbol:(0,h3.Z)({},g$,null==s?void 0:s.lineStartSymbol),endSymbol:(0,h3.Z)({},g$,null==s?void 0:s.lineEndSymbol)}})}isValidPoints(){let{points:t}=this.attribute;if(!t||t.length<2)return!1;let e=!0;return t.forEach(t=>{if(t.length)t.forEach(t=>{(0,hy.Z)(t.x)&&(0,hy.Z)(t.y)||(e=!1)});else if(!(0,hy.Z)(t.x)||!(0,hy.Z)(t.y))return void(e=!1)}),e}addMarkLineLabels(t){this._addMarkLabels(t,"mark-common-line-label",F4.defaultAttributes.label)}updateMarkLineLabels(){this._updateMarkLabels(F4.defaultAttributes.label)}}F4.defaultAttributes=F$;var F6=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};function F7(t,e){let i;if(e.coordinates){let t,r,{coordinates:n,coordinateType:l,getSeriesByIdOrIndex:s}=e,a=F6(e,["coordinates","coordinateType","getSeriesByIdOrIndex"]);if((0,nz.Z)(n)){let i=e.getRelativeSeries();t=n(i.getData().getLatestData(),i)}else t=n;i=(t=(0,a1.IX)(t)).map(t=>{let e=s(t.refRelativeSeriesId,t.refRelativeSeriesIndex);if("cartesian"===l){let{xField:i,yField:n}=e.getSpec(),{xFieldDim:l,xFieldIndex:s,yFieldDim:o,yFieldIndex:h}=t,d=i;(0,aw.Z)(s)&&(d=(0,a1.IX)(i)[s]),l&&(0,a1.IX)(i).includes(l)&&(d=l);let u=n;(0,aw.Z)(h)&&(u=(0,a1.IX)(n)[h]),o&&(0,a1.IX)(n).includes(o)&&(u=o),r=Object.assign({x:void 0,y:void 0},a),(0,nI.Z)(t[d])&&L6(t[d])?r.x={field:d,aggrType:t[d]}:r.x=(0,a1.IX)(d).map(e=>t[e]),(0,nI.Z)(t[u])&&L6(t[u])?r.y={field:u,aggrType:t[u]}:r.y=(0,a1.IX)(u).map(e=>t[e])}else if("polar"===l){let{valueField:i,categoryField:n}=e.getSpec(),{angleFieldDim:l,angleFieldIndex:s}=t,o=n;(0,aw.Z)(s)&&(o=(0,a1.IX)(n)[s]),l&&(0,a1.IX)(n).includes(l)&&(o=l),r=Object.assign({angle:void 0,radius:void 0},a),(0,nI.Z)(t[o])&&L6(t[o])?r.angle={field:o,aggrType:t[o]}:r.angle=(0,a1.IX)(o).map(e=>t[e]),(0,nI.Z)(t[i])&&L6(t[i])?r.radius={field:i,aggrType:t[i]}:r.radius=(0,a1.IX)(i).map(e=>t[e])}return r.getRefRelativeSeries=()=>e,r})}else i=e;let r=[];return i.forEach(e=>{let i={x:null,y:null,angle:null,radius:null,areaName:null};if((0,aw.Z)(e.x)){let r=e.x;(0,rD.Z)(r)?i.x=r.map(i=>F9(i,t,e)):i.x=F9(r,t,e)}if((0,aw.Z)(e.y)){let r=e.y;(0,rD.Z)(r)?i.y=r.map(i=>F9(i,t,e)):i.y=F9(r,t,e)}if((0,aw.Z)(e.angle)){let r=e.angle;(0,rD.Z)(r)?i.angle=r.map(i=>F9(i,t,e)):i.angle=F9(r,t,e)}if((0,aw.Z)(e.radius)){let r=e.radius;(0,rD.Z)(r)?i.radius=r.map(i=>F9(i,t,e)):i.radius=F9(r,t,e)}(0,aw.Z)(e.areaName)&&(i.areaName=F9(e.areaName,t,e)),e.getRefRelativeSeries&&(i.getRefRelativeSeries=e.getRefRelativeSeries),r.push(i)}),r}let F8={min:(t,e)=>bv(t[0].latestData,e.field),max:(t,e)=>bb(t[0].latestData,e.field),sum:function(t,e){return b_(t[0].latestData,e.field)},average:function(t,e){return bC(t[0].latestData,e.field)},variance:function(t,e){return bx(t[0].latestData,e.field)},standardDeviation:function(t,e){return Math.sqrt(bx(t[0].latestData,e.field))},median:function(t,e){var i,r;return i=t[0].latestData,r=e.field,(0,bf.C)(i.map(t=>t[r]))}};function F9(t,e,i){let r=i.getRelativeSeries(),n=i.getStartRelativeSeries(),l=i.getEndRelativeSeries(),s=r.getData().getLatestData(),a=n.getData().getLatestData(),o=l.getData().getLatestData();if((0,nz.Z)(t))return t(s,a,o,r,n,l);if((0,hc.Z)(t)){let{aggrType:i,field:r}=t;return F8[i](e,{field:r})}return t}function Ot(t,e){if(e&&e.getRelativeSeries){let i=e.getRelativeSeries();if(i){let e=i.getViewData();return e&&e.latestData&&e.latestData.length?t:[]}}return t}class Oe extends xZ{constructor(){super(...arguments),this.layoutType="none",this._layoutOffsetX=0,this._layoutOffsetY=0}getRelativeSeries(){return this._relativeSeries}getMarkerData(){return this._markerData}static _getMarkerCoordinateType(t){return"cartesian"}static getSpecInfo(t){return bW(t,this.specKey,this.type,t=>!1!==t.visible&&this._getMarkerCoordinateType(t)===this.coordinateType)}getMarkAttributeContext(){return this._markAttributeContext}_buildMarkerAttributeContext(){this._markAttributeContext={relativeSeries:this._relativeSeries,startRelativeSeries:this._startRelativeSeries,endRelativeSeries:this._endRelativeSeries,vchart:this._option.globalInstance}}created(){super.created(),this._bindSeries(),this._initDataView(),this.initEvent(),this._buildMarkerAttributeContext()}_getAllRelativeSeries(){return{getRelativeSeries:()=>this._relativeSeries,getStartRelativeSeries:()=>this._startRelativeSeries,getEndRelativeSeries:()=>this._endRelativeSeries}}_getFieldInfoFromSpec(t,e,i){return(0,nI.Z)(e)&&L6(e)?{field:i.getSpec()[({x:"xField",y:"yField",radius:"valueField",angle:"categoryField",areaName:"nameField"})[t]],aggrType:e}:e}_processSpecByDims(t){let e=this._relativeSeries,i={};return t.forEach(t=>i[t.dim]=this._getFieldInfoFromSpec(t.dim,t.specValue,e)),Object.assign(Object.assign({},i),this._getAllRelativeSeries())}_processSpecCoo(t){return Object.assign(Object.assign({coordinates:t.coordinates||t.coordinate},this._getAllRelativeSeries()),{getSeriesByIdOrIndex:(t,e)=>this._getSeriesByIdOrIndex(t,e),coordinateType:this.coordinateType})}_getRelativeDataView(){if(this._specifiedDataSeries){let t=[];(0,a1.IX)(this._specifiedDataSeries).forEach(e=>{t=t.concat(e.getViewData().latestData)});let e=new eY.q;return e.registerParser("array",S),new eq.V(e).parse(t,{type:"array"})}return this._relativeSeries.getViewData()}updateLayoutAttribute(){var t,e,i;if(null==(t=this._spec.visible)||t){if(!this._markerComponent){let t=this._createMarkerComponent();t.name=null!=(e=this._spec.name)?e:this.type,t.id=null!=(i=this._spec.id)?i:`${this.type}-${this.id}`,this._markerComponent=t,this.getContainer().add(this._markerComponent),this._markerComponent.on("*",(t,e)=>{this._delegateEvent(this._markerComponent,t,e,null,this.getMarkerData.bind(this))})}this._markerLayout()}super.updateLayoutAttribute()}_getSeriesByIdOrIndex(t,e){var i,r;let n;return(n=null==(i=this._option.getSeriesInUserIdOrIndex((0,aw.Z)(t)?[t]:[],[e]))?void 0:i[0])||(n=null!=(r=this._relativeSeries)?r:this._getFirstSeries()),n}_bindSeries(){let t=this._spec;this._relativeSeries=this._getSeriesByIdOrIndex(t.relativeSeriesId,t.relativeSeriesIndex),this._startRelativeSeries=this._getSeriesByIdOrIndex(t.startRelativeSeriesId,t.startRelativeSeriesIndex),this._endRelativeSeries=this._getSeriesByIdOrIndex(t.endRelativeSeriesId,t.endRelativeSeriesIndex),t.specifiedDataSeriesIndex&&"all"===t.specifiedDataSeriesIndex||t.specifiedDataSeriesId&&"all"===t.specifiedDataSeriesId?this._specifiedDataSeries=this._option.getAllSeries():(t.specifiedDataSeriesIndex||t.specifiedDataSeriesId)&&(this._specifiedDataSeries=this._getSeriesByIdOrIndex(t.specifiedDataSeriesId,t.specifiedDataSeriesIndex))}initEvent(){"cartesian"!==this._relativeSeries.coordinate&&(this._relativeSeries.event.on("zoom",this._markerLayout.bind(this)),this._relativeSeries.event.on("panmove",this._markerLayout.bind(this)),this._relativeSeries.event.on("scroll",this._markerLayout.bind(this)))}clear(){super.clear(),this._firstSeries=null}_getFirstSeries(){var t;if(this._firstSeries)return this._firstSeries;let e=CJ(this._regions);return e?(this._firstSeries=e,e):(null==(t=this._option)||t.onError("need at least one series"),null)}_getNeedClearVRenderComponents(){return[this._markerComponent]}onLayoutStart(t,e){(0,nB.Z)(this._spec.offsetX)||(this._layoutOffsetX=hw(this._spec.offsetX,e.width,e)),(0,nB.Z)(this._spec.offsetY)||(this._layoutOffsetY=hw(this._spec.offsetY,e.height,e)),super.onLayoutStart(t,e)}_compareSpec(t,e){let i=super._compareSpec(t,e);return(0,uL.X)(e,t)||(i.reRender=!0,i.reMake=!0,i.change=!0),i}_initCommonDataView(){let{options:t}=this._computeOptions(),e=this._getRelativeDataView();dL(this._option.dataSet,"markerAggregation",F7),dL(this._option.dataSet,"markerFilter",Ot);let i=new eq.V(this._option.dataSet,{name:`${this.type}_${this.id}_data`});i.parse([e],{type:"dataview"}),i.transform({type:"markerAggregation",options:t}),i.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),i.target.on("change",()=>{this._markerLayout()}),this._markerData=i}}function Oi(t,e){return function(t,e,i){let{predict:r}=(0,bm.fw)(t,t=>t[e],t=>t[i]),n=bv(t,e),l=bb(t,e),s=r(n),a=r(l);return[{[e]:n,[i]:s},{[e]:l,[i]:a}]}(t[0].latestData,e.fieldX,e.fieldY)}class Or extends Oe{constructor(){super(...arguments),this.specKey="markLine",this.layoutZIndex=ts.MarkLine}static _getMarkerCoordinateType(t){let{doAngleProcess:e,doRadiusProcess:i,doAngRadRad1Process:r,doRadAngAng1Process:n,doRadAngProcess:l}=Fu(t);return"polar"===t.coordinateType||e||i||r||n||l?"polar":"cartesian"}_createMarkerComponent(){var t,e,i,r,n,l,s,a,o,h,d,u,c;let{startSymbol:p={},endSymbol:g={}}=this._spec,f=(0,a1.IX)(null!=(t=this._spec.label)?t:{}),m={zIndex:this.layoutZIndex,interactive:null==(e=this._spec.interactive)||e,hover:null==(i=this._spec.interactive)||i,select:null==(r=this._spec.interactive)||r,points:[{x:0,y:0},{x:0,y:0}],center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,lineStyle:Fa(xg(null==(n=this._spec.line)?void 0:n.style),this._markerData,this._markAttributeContext),clipInRange:null!=(l=this._spec.clip)&&l,label:f.map(t=>Fl(t,this._markerData,this._markAttributeContext)),state:{line:Fs(null!=(a=null==(s=this._spec.line)?void 0:s.state)?a:{},this._markerData,this._markAttributeContext),lineStartSymbol:Fs(null!=(h=null==(o=this._spec.startSymbol)?void 0:o.state)?h:{},this._markerData,this._markAttributeContext),lineEndSymbol:Fs(null!=(u=null==(d=this._spec.endSymbol)?void 0:d.state)?u:{},this._markerData,this._markAttributeContext),label:f.map(t=>{var e;return Fs(null!=(e=t.state)?e:{},this._markerData,this._markAttributeContext)}),labelBackground:f.map(t=>{var e,i;return Fs(null!=(i=null==(e=t.labelBackground)?void 0:e.state)?i:{},this._markerData,this._markAttributeContext)})},animation:null!=(c=this._spec.animation)&&c,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return p.visible?m.startSymbol=Object.assign(Object.assign({},p),{visible:!0,style:Fa(xg(p.style),this._markerData,this._markAttributeContext)}):m.startSymbol={visible:!1},g.visible?m.endSymbol=Object.assign(Object.assign({},g),{visible:!0,style:Fa(xg(g.style),this._markerData,this._markAttributeContext)}):m.endSymbol={visible:!1},this._newMarkLineComponent(m)}_getUpdateMarkerAttrs(){var t,e;let i,r=this._spec,n=this._markerData,l=this._startRelativeSeries,s=this._endRelativeSeries,a=this._relativeSeries,o=this._computePointsAttr(),h=a.getViewData().latestData,d=n.latestData[0]&&n.latestData[0].latestData?n.latestData[0].latestData:n.latestData;if(r.clip||(0,a1.IX)(r.label).some(t=>null==t?void 0:t.confine)){let{minX:t,maxX:e,minY:r,maxY:n}=Fn([l.getRegion(),s.getRegion(),a.getRegion()]);i={x:t,y:r,width:e-t,height:n-r}}let u=null!=(e=null==(t=this._markerComponent)?void 0:t.attribute)?e:{},c=(0,a1.IX)(u.label),p=(0,a1.IX)(this._spec.label),g=c.map((t,e)=>{let i=p[e]||{};return Object.assign(Object.assign({},t),{text:i.formatMethod?i.formatMethod(d,h):null==t?void 0:t.text})});return Object.assign(Object.assign({},o),{label:g,limitRect:i,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}_markerLayout(){var t;let e=this._getUpdateMarkerAttrs();null==(t=this._markerComponent)||t.setAttributes(e)}_initDataView(){let t=this._spec,e="coordinates"in t,{doXProcess:i,doYProcess:r,doXYY1Process:n,doYXX1Process:l,doXYProcess:s,doAngleProcess:a,doRadiusProcess:o,doAngRadRad1Process:h,doRadAngAng1Process:d,doRadAngProcess:u}=Fu(t);if(this._markerData=this._getRelativeDataView(),!(i||r||n||l||s||a||o||h||d||u||e))return;dL(this._option.dataSet,"markerAggregation",F7),dL(this._option.dataSet,"markerRegression",Oi),dL(this._option.dataSet,"markerFilter",Ot);let{options:c,needAggr:p,needRegr:g,processData:f}=this._computeOptions(),m=new eq.V(this._option.dataSet);m.parse([f],{type:"dataview"}),p&&m.transform({type:"markerAggregation",options:c}),g&&m.transform({type:"markerRegression",options:c}),m.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),m.target.on("change",()=>{this._markerLayout()}),this._markerData=m}}Or.specKey="markLine";let On=()=>({style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}),Ol=t=>({visible:t,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}}),Os=On();Os.refY=5;let Oa={line:{style:{lineDash:[3,3],stroke:{type:"palette",key:"markLineStrokeColor"}}},startSymbol:Ol(!1),endSymbol:Ol(!0),label:Os};class Oo extends Or{constructor(){super(...arguments),this.type=oQ.markLine,this.name=oQ.markLine,this.coordinateType="cartesian"}_newMarkLineComponent(t){return new F4(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,l=this._relativeSeries,s=(0,aw.Z)(e.coordinates),a=(0,aw.Z)(e.process),o=a&&(0,aw.Z)(e.process.x),h=a&&(0,aw.Z)(e.process.y),d=(0,aw.Z)(e.positions),u=null!=(t=e.autoRange)&&t,{doXProcess:c,doYProcess:p,doXYY1Process:g,doYXX1Process:f,doXYProcess:m,doCoordinatesProcess:y}=Fu(e),v=[];if(c||g||p||f||m||s&&o||s&&h){let t=L7(i,r,n,l,u);v=1===t.length?t[0]:t.map(t=>t[0])}else y?v=Ft(i,l,u,e.coordinatesOffset):d&&(v=Fr(e.positions,l,e.regionRelative));return{points:v}}_markerLayout(){var t,e,i,r,n;let l=this._getUpdateMarkerAttrs();if("type-step"===this._spec.type){let n,s,a=this._startRelativeSeries,o=this._endRelativeSeries,{multiSegment:h,mainSegmentIndex:d}=this._spec.line||{},{connectDirection:u,expandDistance:c=0}=this._spec;if(hC(c)){let t=a.getRegion(),e=t.getLayoutStartPoint(),i=o.getRegion(),r=i.getLayoutStartPoint();if("bottom"===u||"top"===u){let l=Math.abs(Math.min(e.y,r.y)-Math.max(e.y+t.getLayoutRect().height,r.y+i.getLayoutRect().height));n=Number(c.substring(0,c.length-1))*l/100}else{let l=Math.abs(Math.min(e.x,r.x)-Math.max(e.x+t.getLayoutRect().width,r.x+i.getLayoutRect().width));n=Number(c.substring(0,c.length-1))*l/100}}else n=c;let{points:p,limitRect:g}=l;if(!p||p.length<2)return void(null==(t=this._markerComponent)||t.setAttributes(l));let f=function(t,e,i,r=0){let n=[],l=t.y-e.y,s=t.x-e.x;switch(i){case"top":n.push(t),n.push({x:t.x,y:l>0?t.y-r-Math.abs(l):t.y-r}),n.push({x:e.x,y:l>0?e.y-r:e.y-r-Math.abs(l)}),n.push(e);break;case"bottom":n.push(t),n.push({x:t.x,y:l<0?t.y+r+Math.abs(l):t.y+r}),n.push({x:e.x,y:l<0?e.y+r:e.y+r+Math.abs(l)}),n.push(e);break;case"left":n.push(t),n.push({x:s>0?t.x-r-Math.abs(s):t.x-r,y:t.y}),n.push({x:s>0?e.x-r:e.x-r-Math.abs(s),y:e.y}),n.push(e);break;case"right":n.push(t),n.push({x:s>0?t.x+r:t.x+r+Math.abs(s),y:t.y}),n.push({x:s>0?e.x+r+Math.abs(s):e.x+r,y:e.y}),n.push(e)}return n}(p[0],p[1],u,n);s=h&&(0,aw.Z)(d)?{position:"middle",autoRotate:!1}:Object.assign({position:"start",autoRotate:!1},function(t,e,i,r=0){let n=t.y-e.y,l=t.x-e.x;return"bottom"===i?{dx:l>0?-l/2:Math.abs(l/2),dy:n>0?r:Math.abs(n)+r}:"top"===i?{dx:l>0?-Math.abs(l/2):+Math.abs(l/2),dy:n>0?-(Math.abs(n)+r):-r}:"left"===i?{dx:l>0?-l-r:-r,dy:n>0?-n/2:Math.abs(n/2)}:"right"===i?{dx:l>0?r:Math.abs(l)+r,dy:n>0?-n/2:Math.abs(n/2)}:{}}(p[0],p[1],u,n));let m=null!=(i=null==(e=this._markerComponent)?void 0:e.attribute)?i:{},y=(0,a1.IX)(m.label),v=(0,a1.IX)(l.label),b=(0,a1.IX)(this._spec.label);null==(r=this._markerComponent)||r.setAttributes({points:h?[[f[0],f[1]],[f[1],f[2]],[f[2],f[3]]]:f,label:v.map((t,e)=>{var i,r,n,l;let a=0,o=0,h=null!=(i=s.dx)?i:0,d=null!=(r=s.dy)?r:0,u=null!=(n=b[e])?n:b[0];return(0,hy.Z)(null==u?void 0:u.refX)&&(a+=u.refX),(0,hy.Z)(null==u?void 0:u.refY)&&(o+=u.refY),(0,hy.Z)(null==u?void 0:u.dx)&&(h+=u.dx),(0,hy.Z)(null==u?void 0:u.dy)&&(d+=u.dy),Object.assign(Object.assign(Object.assign({},t),s),{refX:a,refY:o,dx:h,dy:d,textStyle:Object.assign(Object.assign({},null==(l=y[e])?void 0:l.textStyle),{textAlign:"center",textBaseline:"middle"})})}),limitRect:g,multiSegment:h,mainSegmentIndex:d,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}else null==(n=this._markerComponent)||n.setAttributes(l)}_computeOptions(){let t,e=this._getRelativeDataView(),i=!0,r=!1,n=this._spec,l=this._relativeSeries,{doXProcess:s,doYProcess:a,doXYY1Process:o,doYXX1Process:h,doXYProcess:d,doCoordinatesProcess:u}=Fu(n);if(d)t=[this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y}]),this._processSpecByDims([{dim:"x",specValue:n.x1},{dim:"y",specValue:n.y1}])];else if(s)t=[this._processSpecByDims([{dim:"x",specValue:n.x}])];else if(a)t=[this._processSpecByDims([{dim:"y",specValue:n.y}])];else if(o)t=[this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y}]),this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y1}])];else if(h)t=[this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y}]),this._processSpecByDims([{dim:"x",specValue:n.x1},{dim:"y",specValue:n.y}])];else if(u){if(t=this._processSpecCoo(n),i=!1,e=new eq.V(this._option.dataSet,{name:`${this.type}_${this.id}_data`}).parse([l.getViewData()],{type:"dataview"}).transform({type:"markerAggregation",options:t}),n.process&&(0,aw.Z)(n.process.x)&&(t=[this._processSpecByDims([{dim:"x",specValue:n.process.x}])],i=!0),n.process&&(0,aw.Z)(n.process.y)&&(t=t=[this._processSpecByDims([{dim:"y",specValue:n.process.y}])],i=!0),n.process&&(0,aw.Z)(n.process.xy)){let{xField:e,yField:i}=l.getSpec();t={fieldX:e,fieldY:i},r=!0}}else i=!1;return{options:t,needAggr:i,needRegr:r,processData:e}}}Oo.type=oQ.markLine,Oo.coordinateType="cartesian",Oo.builtInTheme={markLine:Oa};let Oh=()=>{h9.registerComponent(Oo.type,Oo),F5()};Sa();class Od extends So{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},So.defaultAttributes,t)),this.name="arc-segment",this.key="arc-segment",this.isReverseArc=!1}getStartAngle(){let t=this.isReverseArc?this._startAngle+Math.PI/2:this._startAngle-Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}getEndAngle(){let t=this.isReverseArc?this._endAngle-Math.PI/2:this._endAngle+Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}getMainSegmentPoints(){return this._mainSegmentPoints}_computeStartRotate(t){return this.isReverseArc?t+Math.PI:t}_computeEndRotate(t){return this.isReverseArc?t:t+Math.PI}render(){this.removeAllChild(!0),this._reset();let{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:n=!0,radius:l,startAngle:s,endAngle:a,center:o}=this.attribute;if(!n)return;this._startAngle=s,this._endAngle=a,this.isReverseArc=s>a;let h={x:o.x+l*Math.cos(this._startAngle),y:o.y+l*Math.sin(this._startAngle)},d={x:o.x+l*Math.cos(this._endAngle),y:o.y+l*Math.sin(this._endAngle)};this._mainSegmentPoints=[h,d];let u=this._renderSymbol(t,this._mainSegmentPoints,"start"),c=this._renderSymbol(e,this._mainSegmentPoints,"end");this.startSymbol=u,this.endSymbol=c;let p=ak.arc(Object.assign({x:o.x,y:o.y,startAngle:s,endAngle:a,innerRadius:l,outerRadius:l},i));p.name=`${this.name}-line`,p.id=this._getNodeId("arc"),(0,uF.Z)(null==r?void 0:r.line)||(p.states=[].concat(r.line)[0]),this.add(p),this.line=p}}FS(),Sa(),yL();class Ou extends FY{markerAnimate(t){Ou._animate&&this._animationConfig&&Ou._animate(this._line,this._label,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Ou.defaultAttributes,t)),this.name="markArcLine"}getPointAttrByPosition(t,e){let i,{center:r,radius:n,startAngle:l,endAngle:s}=this.attribute,{refX:a=0,refY:o=0}=e;switch(t){case eF.arcInnerStart:i=l;case eF.arcOuterStart:i=l;break;case eF.arcInnerEnd:i=s;case eF.arcOuterEnd:i=s;break;case eF.center:case eF.arcInnerMiddle:case eF.arcOuterMiddle:default:i=(l+s)/2}return{position:{x:r.x+(n+o)*Math.cos(i)+a*Math.cos(i-Math.PI/2),y:r.y+(n+o)*Math.sin(i)+a*Math.sin(i-Math.PI/2)},angle:i}}getTextStyle(t){return F1[t]}getRotateByAngle(t,e){var i;return t-Math.PI/2+(null!=(i=e.refAngle)?i:0)}createSegment(){let{center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:l,lineStyle:s,state:a}=this.attribute;return new Od({center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:l,lineStyle:s,state:{line:(0,h3.Z)({},g$,null==a?void 0:a.line),startSymbol:(0,h3.Z)({},g$,null==a?void 0:a.lineStartSymbol),endSymbol:(0,h3.Z)({},g$,null==a?void 0:a.lineEndSymbol)}})}setLineAttributes(){let{center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:l,lineStyle:s,state:a}=this.attribute;this._line&&this._line.setAttributes({center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:l,lineStyle:s,state:{line:(0,h3.Z)({},g$,null==a?void 0:a.line),startSymbol:(0,h3.Z)({},g$,null==a?void 0:a.lineStartSymbol),endSymbol:(0,h3.Z)({},g$,null==a?void 0:a.lineEndSymbol)}})}isValidPoints(){return!0}addMarkLineLabels(t){this._addMarkLabels(t,"mark-common-line-label",Ou.defaultAttributes.label)}updateMarkLineLabels(){this._updateMarkLabels(Ou.defaultAttributes.label)}}Ou.defaultAttributes=FJ;class Oc extends Or{constructor(){super(...arguments),this.type=oQ.polarMarkLine,this.name=oQ.polarMarkLine,this.coordinateType="polar"}_newMarkLineComponent(t){let{doRadiusProcess:e,doRadAngAng1Process:i}=Fu(this._spec);return e||i?new Ou(t):new F4(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,l=this._relativeSeries,s=null!=(t=e.autoRange)&&t,{doAngleProcess:a,doRadiusProcess:o,doAngRadRad1Process:h,doRadAngAng1Process:d,doRadAngProcess:u,doCoordinatesProcess:c}=Fu(e),p=[],g={},f={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(a||o||h||d||u){let t=L9(i,r,n,l,s);g=(p=1===t.length?t[0]:t.map(t=>t[0]))[0].radius===p[1].radius?{radius:p[0].radius,startAngle:p[0].angle,endAngle:p[1].angle,center:f}:{points:p.map(t=>(0,iH.op)(f,t.radius,t.angle))}}else c&&(g={points:(p=Fe(i,l,s)).map(t=>(0,iH.op)(f,t.radius,t.angle))});return g}_computeOptions(){let t,e=this._spec,{doAngleProcess:i,doRadiusProcess:r,doAngRadRad1Process:n,doRadAngAng1Process:l,doRadAngProcess:s,doCoordinatesProcess:a}=Fu(e),o=this._getRelativeDataView();return s?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius1}])]:l?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:a&&(t=this._processSpecCoo(e)),{options:t,needAggr:!0,needRegr:!1,processData:o}}}Oc.type=oQ.polarMarkLine,Oc.coordinateType="polar",Oc.builtInTheme={polarMarkLine:Oa};let Op=()=>{h9.registerComponent(Oc.type,Oc),Ou._animate=FW,F5()};uD(),cw(),Cw();class Og extends CB{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Og.defaultAttributes,t)),this.name="title"}render(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b;let{textType:_,text:C,subtextType:x,textStyle:w={},subtext:S,subtextStyle:A={},width:M,height:T,minWidth:k,maxWidth:R,minHeight:P,maxHeight:B,align:I,verticalAlign:E,padding:L=0}=this.attribute,F=(0,wj.o)(L),O=this.createOrUpdateChild("title-container",{x:F[3],y:F[0],zIndex:1},"group"),H=null!=(t=w.height)?t:T;if(!1!==this.attribute.visible&&!1!==w.visible){let{width:t,maxHeight:a,maxWidth:o,x:h=0,y:d=0,ellipsis:u=!0,wordBreak:c="break-word",maxWidth:p,lineClamp:g}=w;if("rich"===_||(0,aw.Z)(w.character)){let r=Object.assign({x:h,y:d,width:null!=(e=null!=t?t:M)?e:0,height:null!=H?H:0,ellipsis:null==u||u,wordBreak:null!=c?c:"break-word",maxHeight:null!=a?a:B,maxWidth:null!=o?o:p,textConfig:null!=(i=w.character)?i:C},w);this._mainTitle=O.createOrUpdateChild("mainTitle",r,"richtext")}else if("html"===_){let e=Object.assign({html:Object.assign(Object.assign({dom:C},gq),w),x:h,y:d,width:null!=(r=null!=t?t:M)?r:0,height:null!=H?H:0,ellipsis:u,wordBreak:c,maxHeight:null!=a?a:B,maxWidth:null!=o?o:p,textConfig:[]},w);this._mainTitle=O.createOrUpdateChild("mainTitle",e,"richtext")}else(0,aw.Z)(C)&&(this._mainTitle=O.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:(0,rD.Z)(C)?C:[C],whiteSpace:"normal"},w),{maxLineWidth:null!=(l=null!=(n=w.maxLineWidth)?n:t)?l:M,heightLimit:null!=(s=w.height)?s:B,lineClamp:g,ellipsis:u,x:h,y:d}),"text"))}let D=this._mainTitle?this._mainTitle.AABBBounds.height():0,z=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(!1!==this.attribute.visible&&!1!==A.visible){let{width:t,height:e,maxWidth:i,maxHeight:r,x:n=0,y:l=0,ellipsis:s=!0,wordBreak:g="break-word",lineClamp:f}=A,m=Math.max(Number.MIN_VALUE,B-D);if("rich"===x||(0,aw.Z)(A.character)){let d=Object.assign({x:n,y:l,width:null!=(a=null!=t?t:M)?a:0,height:null!=(o=null!=e?e:T)?o:0,ellipsis:s,wordBreak:g,maxHeight:null!=r?r:m,maxWidth:null!=i?i:R,textConfig:null!=(h=A.character)?h:S},A);this._subTitle=O.createOrUpdateChild("subTitle",d,"richtext")}else if("html"===x){let a=Object.assign({html:Object.assign(Object.assign({dom:S},gq),A),x:n,y:l,width:null!=(d=null!=t?t:M)?d:0,height:null!=(u=null!=e?e:T)?u:0,ellipsis:s,wordBreak:g,maxHeight:null!=r?r:m,maxWidth:null!=i?i:R,textConfig:[]},A);this._subTitle=O.createOrUpdateChild("subTitle",a,"richtext")}else(0,aw.Z)(S)&&(this._subTitle=O.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:(0,rD.Z)(S)?S:[S],whiteSpace:"normal"},A),{maxLineWidth:null!=(c=A.maxLineWidth)?c:M,heightLimit:null!=(p=A.heightLimit)?p:m,lineClamp:f,ellipsis:s,x:0,y:D}),"text"))}let W=this._subTitle?this._subTitle.AABBBounds.height():0,Z=Math.max(z,this._subTitle?this._subTitle.AABBBounds.width():0),N=D+(null!=(g=A.height)?g:W);if((0,aw.Z)(M)&&(Z=M),(0,aw.Z)(T)&&(N=T),(0,aw.Z)(k)&&Z<k&&(Z=k),(0,aw.Z)(R)&&Z>R&&(Z=R),(0,aw.Z)(P)&&N<P&&(N=P),(0,aw.Z)(B)&&N>B&&(N=B),O.attribute.width=Z,O.attribute.height=N,O.attribute.boundsPadding=F,this._mainTitle){if((0,aw.Z)(I)||(0,aw.Z)(w.align)){let t=w.align?w.align:I,e=null!=(f=w.width)?f:Z;"center"===t?(this._mainTitle.setAttribute("x",e/2),this._mainTitle.setAttribute("textAlign","center")):"right"===t?(this._mainTitle.setAttribute("x",e),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}let t=w.verticalAlign?w.verticalAlign:E,e=null!=H?H:this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height();"middle"===t?(this._mainTitle.setAttribute("y",e/2),this._mainTitle.setAttribute("textBaseline","middle")):"bottom"===t?(this._mainTitle.setAttribute("y",e),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}if(this._subTitle){if((0,aw.Z)(I)||(0,aw.Z)(A.align)){let t=A.align?A.align:I,e=null!=(y=null!=(m=A.width)?m:w.width)?y:Z;"center"===t?(this._subTitle.setAttribute("x",e/2),this._subTitle.setAttribute("textAlign","center")):"right"===t?(this._subTitle.setAttribute("x",e),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}let t=A.verticalAlign?A.verticalAlign:E,e=this._mainTitle?(0,aw.Z)(H)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height(),H):this._mainTitle.AABBBounds.y2:0,i=null!=(b=null!=(v=A.height)?v:T)?b:this._subTitle.AABBBounds.empty()?0:this._subTitle.AABBBounds.height();"middle"===t?(this._subTitle.setAttribute("y",e+i/2),this._subTitle.setAttribute("textBaseline","middle")):"bottom"===t?(this._subTitle.setAttribute("y",e+i),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",e),this._subTitle.setAttribute("textBaseline","top"))}}}Og.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};class Of extends xZ{get orient(){return this._orient}constructor(t,e){super(t,e),this.type=oQ.title,this.specKey=oQ.title,this.layoutType="normal",this.layoutZIndex=ts.Title,this.layoutLevel=ta.Title,this._orient="top",this._orient=h_(t.orient)?t.orient:"top"}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}static getSpecInfo(t){return bW(t,this.specKey,oQ.title,t=>!1!==t.visible)}_compareSpec(t,e){let i=super._compareSpec(t,e);return(null==e?void 0:e.orient)===(null==t?void 0:t.orient)&&(null==e?void 0:e.visible)===t.visible||(i.reMake=!0),i.change=!0,i.reRender=!0,i}afterSetLayoutStartPoint(t){(0,hy.Z)(t.x)&&this._titleComponent&&this._titleComponent.setAttribute("x",t.x),(0,hy.Z)(t.y)&&this._titleComponent&&this._titleComponent.setAttribute("y",t.y),super.afterSetLayoutStartPoint(t)}getBoundsInRect(t){let e={};this.setLayoutRect(t);let i=this._getTitleAttrs();this._createOrUpdateTitleComponent(i),e=this._getTitleLayoutRect();let{x:r,y:n}=this.getLayoutStartPoint();return{x1:r,y1:n,x2:r+e.width,y2:n+e.height}}_getTitleLayoutRect(){let t=this._titleComponent.AABBBounds;return{width:this._spec.width?this._spec.width:(0,hy.Z)(t.width())?t.width():0,height:this._spec.height?this._spec.height:(0,hy.Z)(t.height())?t.height():0}}_getTitleAttrs(){var t,e,i,r,n,l,s,a;if(!1===this._spec.visible)return{visible:!1};let o=this.getLayoutRect(),h=hw(this._spec.width,o.width,null,o.width),d=Math.max(Math.min(h,hw(this._spec.maxWidth,o.width,null,o.width),o.width),0),u=Object.assign(Object.assign({},(0,xN.Z)(this._spec,["padding"])),{textType:null!=(t=this._spec.textType)?t:"text",text:null!=(e=this._spec.text)?e:"",subtextType:null!=(i=this._spec.subtextType)?i:"text",subtext:null!=(r=this._spec.subtext)?r:"",x:null!=(n=this._spec.x)?n:0,y:null!=(l=this._spec.y)?l:0,height:this._spec.height,minWidth:this._spec.minWidth,maxWidth:d,minHeight:this._spec.minHeight,maxHeight:this._spec.maxHeight,padding:this._spec.innerPadding,align:null!=(s=this._spec.align)?s:"left",verticalAlign:null!=(a=this._spec.verticalAlign)?a:"top",textStyle:Object.assign({width:d,maxLineWidth:d},this._spec.textStyle),subtextStyle:Object.assign({maxLineWidth:d},this._spec.subtextStyle)});return(0,aw.Z)(this._spec.width)&&(u.textStyle.width=Math.max(h,o.width),u.subtextStyle.width=u.textStyle.width),u}_createOrUpdateTitleComponent(t){if(this._titleComponent)(0,uL.X)(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{let e=this.getContainer(),i=new Og(t);i.name="title",e.add(i),this._titleComponent=i,i.on("*",(t,e)=>this._delegateEvent(i,t,e))}return this._cacheAttrs=t,this._titleComponent}_getNeedClearVRenderComponents(){return[this._titleComponent]}clear(){super.clear(),this._cacheAttrs=null}}Of.type=oQ.title,Of.specKey=oQ.title,Of.builtInTheme={title:{padding:{top:4,bottom:20},textStyle:{fontSize:{type:"token",key:"l3FontSize"},lineHeight:{type:"token",key:"l3LineHeight"},fill:{type:"palette",key:"primaryFontColor"}},subtextStyle:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fill:{type:"palette",key:"tertiaryFontColor"}}}};let Om=()=>{h9.registerComponent(Of.type,Of)};function Oy(){Ov._animate=FZ}FS(),w3(),yL();class Ov extends FT{markerAnimate(t){Ov._animate&&this._animationConfig&&Ov._animate(this._area,this._label,this._animationConfig,t)}getArea(){return this._area}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Ov.defaultAttributes,t)),this.name="markArea",this.defaultUpdateAnimation=FV,this.defaultExitAnimation=FK}getPointAttrByPosition(t){let{x1:e,x2:i,y1:r,y2:n}=this._area.AABBBounds,l={x:(e+i)/2,y:(r+n)/2};return(t.includes("left")||t.includes("Left"))&&(l.x=e),(t.includes("right")||t.includes("Right"))&&(l.x=i),(t.includes("top")||t.includes("Top"))&&(l.y=r),(t.includes("bottom")||t.includes("Bottom"))&&(l.y=n),l}setLabelPos(t,e){var i;if(this._area){let r=null!=(i=e.position)?i:"middle",n=this.getPointAttrByPosition(r);if(t.setAttributes(Object.assign(Object.assign({},n),{textStyle:Object.assign(Object.assign({},F2[r]),e.textStyle)})),this.attribute.limitRect&&e.confine){let{x:e,y:i,width:r,height:n}=this.attribute.limitRect;FM(t,{x1:e,y1:i,x2:e+r,y2:i+n})}}}initMarker(t){let{points:e,areaStyle:i,state:r}=this.attribute,n=ak.polygon(Object.assign({points:e},i));n.states=(0,h3.Z)({},g$,null==r?void 0:r.area),n.name="mark-area-polygon",this._area=n,t.add(n),this._addMarkLabels(t,"mark-area-label",Ov.defaultAttributes.label)}updateMarker(){let{points:t,areaStyle:e,state:i}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({points:t},e)),this._area.states=(0,h3.Z)({},g$,null==i?void 0:i.area)),this._updateMarkLabels(Ov.defaultAttributes.label)}isValidPoints(){let{points:t}=this.attribute;if(!t||t.length<3)return!1;let e=!0;return t.forEach(t=>{(0,hy.Z)(t.x)&&(0,hy.Z)(t.y)||(e=!1)}),e}}Ov.defaultAttributes=FQ,(0,yf.jB)(Ov,FX);class Ob extends Oe{constructor(){super(...arguments),this.specKey="markArea",this.layoutZIndex=ts.MarkArea}static _getMarkerCoordinateType(t){let{doAngleProcess:e,doRadiusProcess:i,doRadAngProcess:r}=Fc(t);return"polar"===t.coordinateType||e||i||r?"polar":"cartesian"}_createMarkerComponent(){var t,e,i,r,n,l,s,a;let o=(0,a1.IX)(null!=(t=this._spec.label)?t:{}),h={zIndex:this.layoutZIndex,interactive:null==(e=this._spec.interactive)||e,hover:null==(i=this._spec.interactive)||i,select:null==(r=this._spec.interactive)||r,points:[{x:0,y:0}],center:{x:0,y:0},innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,areaStyle:Fa(xg(null==(n=this._spec.area)?void 0:n.style),this._markerData,this._markAttributeContext),clipInRange:null!=(l=this._spec.clip)&&l,label:o.map(t=>Fl(t,this._markerData,this._markAttributeContext)),state:{area:Fs(null==(s=this._spec.area)?void 0:s.state,this._markerData,this._markAttributeContext),label:o.map(t=>Fs(t.state,this._markerData,this._markAttributeContext)),labelBackground:o.map(t=>{var e;return Fs(null==(e=t.labelBackground)?void 0:e.state,this._markerData,this._markAttributeContext)})},animation:null!=(a=this._spec.animation)&&a,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return this._newMarkAreaComponent(h)}_markerLayout(){var t;let e,i=this._spec,r=this._markerData,n=this._startRelativeSeries,l=this._endRelativeSeries,s=this._relativeSeries,a=this._computePointsAttr(),o=this._getRelativeDataView().latestData,h=r?r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData:o;if(i.clip||(0,a1.IX)(i.label).some(t=>null==t?void 0:t.confine)){let{minX:t,maxX:i,minY:r,maxY:a}=Fn([n.getRegion(),l.getRegion(),s.getRegion()]);e={x:t,y:r,width:i-t,height:a-r}}if(this._markerComponent){let i=(0,a1.IX)(null==(t=this._markerComponent.attribute)?void 0:t.label),r=(0,a1.IX)(this._spec.label);this._markerComponent.setAttributes(Object.assign(Object.assign({},a),{label:i.map((t,e)=>{let i=r[e]||{};return Object.assign(Object.assign({},t),{text:i.formatMethod?i.formatMethod(h,o):null==t?void 0:t.text})}),limitRect:e,dx:this._layoutOffsetX,dy:this._layoutOffsetY}))}}_initDataView(){let{doXProcess:t,doYProcess:e,doXYProcess:i,doAngleProcess:r,doRadiusProcess:n,doRadAngProcess:l,doCoordinatesProcess:s}=Fc(this._spec);if(!(t||e||i||r||n||l||s))return null;this._initCommonDataView()}}Ob.specKey="markArea";let O_={area:{style:{fill:{type:"palette",key:"axisDomainColor",a:.25}}},label:On()};class OC extends Ob{constructor(){super(...arguments),this.type=oQ.markArea,this.name=oQ.markArea,this.coordinateType="cartesian"}_newMarkAreaComponent(t){return new Ov(t)}_computePointsAttr(){var t,e;let i=this._spec,r=this._markerData,n=this._startRelativeSeries,l=this._endRelativeSeries,s=this._relativeSeries,{doXProcess:a,doYProcess:o,doXYProcess:h,doCoordinatesProcess:d}=Fc(i),u=(0,aw.Z)(i.positions),c=null!=(t=i.autoRange)&&t,p=null!=(e=i.includeFullBand)&&e,g=[],f=[];if(h){let[t,e]=L7(r,n,l,s,c,p);t&&t.length&&e&&e.length&&(g=[{x:t[0].x,y:e[0].y},t[0],{x:e[0].x,y:t[0].y},e[0]])}else if(a||o){let[t,e]=L7(r,n,l,s,c,p);t&&t.length&&e&&e.length&&(g=[...t,e[1],e[0]])}else d?g=Ft(r,s,c,i.coordinatesOffset):u&&(g=Fr(i.positions,s,i.regionRelative));return{points:g}}_computeOptions(){let t,e=this._spec,{doXProcess:i,doYProcess:r,doXYProcess:n,doCoordinatesProcess:l}=Fc(e);return n?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"x",specValue:e.x1},{dim:"y",specValue:e.y1}])]:i?t=[this._processSpecByDims([{dim:"x",specValue:e.x}]),this._processSpecByDims([{dim:"x",specValue:e.x1}])]:r?t=[this._processSpecByDims([{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"y",specValue:e.y1}])]:l&&(t=this._processSpecCoo(e)),{options:t}}}OC.type=oQ.markArea,OC.coordinateType="cartesian",OC.builtInTheme={markArea:O_};let Ox=()=>{h9.registerComponent(OC.type,OC),Oy()};FS(),Sl(),yL();class Ow extends FT{markerAnimate(t){Ow._animate&&this._animationConfig&&Ow._animate(this._area,this._label,this._animationConfig,t)}getArea(){return this._area}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Ow.defaultAttributes,t)),this.name="markArcArea",this.defaultUpdateAnimation=FV,this.defaultExitAnimation=FK}getPointAttrByPosition(t,e){let i,r,{center:n,innerRadius:l,outerRadius:s,startAngle:a,endAngle:o}=this.attribute,{refX:h=0,refY:d=0}=e;switch(t){case eF.center:i=(l+s)/2,r=(a+o)/2;break;case eF.arcInnerStart:i=l,r=a;break;case eF.arcOuterStart:i=s,r=a;break;case eF.arcInnerEnd:i=l,r=o;break;case eF.arcOuterEnd:i=s,r=o;break;case eF.arcInnerMiddle:i=l,r=(a+o)/2;break;case eF.arcOuterMiddle:i=s,r=(a+o)/2;break;default:i=l,r=(a+o)/2}return{position:{x:n.x+(i+d)*Math.cos(r)+h*Math.cos(r-Math.PI/2),y:n.y+(i+d)*Math.sin(r)+h*Math.sin(r-Math.PI/2)},angle:r}}setLabelPos(t,e){var i;if(this._area){let{position:r="arcInnerMiddle",autoRotate:n}=e,l=this.getPointAttrByPosition(r,e);if(t.setAttributes(Object.assign(Object.assign({},l.position),{angle:n?l.angle-Math.PI/2+(null!=(i=e.refAngle)?i:0):0,textStyle:Object.assign(Object.assign({},F1[r]),e.textStyle)})),this.attribute.limitRect&&e.confine){let{x:e,y:i,width:r,height:n}=this.attribute.limitRect;FM(t,{x1:e,y1:i,x2:e+r,y2:i+n})}}}initMarker(t){let{center:e,innerRadius:i,outerRadius:r,startAngle:n,endAngle:l,areaStyle:s,state:a}=this.attribute,o=ak.arc(Object.assign({x:e.x,y:e.y,innerRadius:i,outerRadius:r,startAngle:n,endAngle:l},s));o.states=(0,h3.Z)({},g$,null==a?void 0:a.area),o.name="polar-mark-area-area",this._area=o,t.add(o),this._addMarkLabels(t,"mark-area-label",Ow.defaultAttributes.label)}updateMarker(){let{center:t,innerRadius:e,outerRadius:i,startAngle:r,endAngle:n,areaStyle:l,label:s,state:a}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({x:t.x,y:t.y,innerRadius:e,outerRadius:i,startAngle:r,endAngle:n},l)),this._area.states=(0,h3.Z)({},g$,null==a?void 0:a.area)),this._updateMarkLabels(Ow.defaultAttributes.label)}isValidPoints(){return!0}}Ow.defaultAttributes=F0,(0,yf.jB)(Ow,FX);class OS extends Ob{constructor(){super(...arguments),this.type=oQ.polarMarkArea,this.name=oQ.polarMarkArea,this.coordinateType="polar"}_newMarkAreaComponent(t){let{doRadiusProcess:e,doAngleProcess:i,doRadAngProcess:r}=Fc(this._spec);return i||e||r?new Ow(t):new Ov(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,l=this._relativeSeries,{doAngleProcess:s,doRadiusProcess:a,doRadAngProcess:o,doCoordinatesProcess:h}=Fc(e),d=null!=(t=e.autoRange)&&t,u={},c={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(s||a||o){let t=L9(i,r,n,l,d);o?u={innerRadius:t[0][0].radius,outerRadius:t[1][0].radius,startAngle:t[0][0].angle,endAngle:t[1][0].angle,center:c}:s?u={innerRadius:0,outerRadius:Math.abs(t[0][0].radius),startAngle:t[0][1].angle,endAngle:t[1][1].angle,center:c}:a&&(u={innerRadius:t[0][0].radius,outerRadius:t[1][0].radius,startAngle:t[0][0].angle,endAngle:t[1][1].angle,center:c})}else h&&(u={points:Fe(i,l,d).map(t=>(0,iH.op)(c,t.radius,t.angle))});return u}_computeOptions(){let t,e=this._spec,{doAngleProcess:i,doRadiusProcess:r,doRadAngProcess:n,doCoordinatesProcess:l}=Fc(e);return n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"radius",specValue:e.radius1}])]:l&&(t=this._processSpecCoo(e)),{options:t}}}OS.type=oQ.polarMarkArea,OS.coordinateType="polar",OS.builtInTheme={polarMarkArea:O_};let OA=()=>{h9.registerComponent(OS.type,OS),Ow._animate=FN,Oy()};class OM extends oB{constructor(t){super(t)}}(eo=eH||(eH={})).OnPlay="onPlay",eo.OnPause="onPause",eo.OnForward="onForward",eo.OnBackward="onBackward",(eh=eD||(eD={})).Start="start",eh.Pause="pause",eh.Forward="forward",eh.Backward="backward";class OT extends CB{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},OT.defaultAttributes,t)),this._isPaused=!0,this.updateAttributes=()=>{this._startAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -73.1429 161.4994 a 48.7619 48.7619 0 0 1 25.9901 7.5093 l 201.7524 127.1223 a 48.7619 48.7619 0 0 1 0.3657 82.2613 l -201.7524 129.6335 A 48.7619 48.7619 0 0 1 292.5952 540.1838 v -256.7314 a 48.7619 48.7619 0 0 1 48.7619 -48.7619 z m 24.381 92.9402 v 167.9116 l 131.9497 -84.7726 L 365.7381 327.6063 z"},OT.defaultControllerAttr),{visible:this.attribute.start.visible}),this.attribute.start.style)},this._pauseAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -48.7619 195.0476 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z m 158.4762 0 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z"},OT.defaultControllerAttr),{visible:this.attribute.pause.visible}),this.attribute.pause.style)},this._forwardAttr={style:Object.assign(Object.assign(Object.assign({},OT.defaultControllerAttr),{visible:this.attribute.forward.visible}),this.attribute.forward.style)},this._backwardAttr={style:Object.assign(Object.assign(Object.assign({},OT.defaultControllerAttr),{visible:this.attribute.backward.visible}),this.attribute.backward.style)},this.updateLayout()},this.updateLayout=()=>{var t,e,i,r;this._layout=this.attribute.layout,"horizontal"===this._layout?(this._backwardAttr.style.symbolType=null!=(t=this._backwardAttr.style.symbolType)?t:"M 521.29 734.276 L 230.929 448.019 L 521.29 161.762 c 37.685 -37.153 38.003 -97.625 0.707 -134.384 c -37.297 -36.758 -98.646 -36.435 -136.331 0.718 l -357.43 352.378 c -0.155 0.153 -0.297 0.314 -0.451 0.468 c -0.084 0.082 -0.172 0.157 -0.256 0.239 c -18.357 18.092 -27.581 41.929 -27.743 65.902 c -0.004 0.311 -0.017 0.623 -0.018 0.934 c 0.001 0.316 0.014 0.632 0.018 0.948 c 0.165 23.97 9.389 47.803 27.743 65.892 c 0.083 0.082 0.171 0.157 0.255 0.239 c 0.154 0.154 0.296 0.315 0.452 0.468 l 357.43 352.378 c 37.685 37.153 99.034 37.476 136.331 0.718 c 37.297 -36.758 36.979 -97.231 -0.707 -134.384 z",this._forwardAttr.style.symbolType=null!=(e=this._forwardAttr.style.symbolType)?e:"M 30 163 L 320.361 449.257 L 30 735.514 c -37.685 37.153 -38.003 97.625 -0.707 134.384 c 37.297 36.758 98.646 36.435 136.331 -0.718 l 357.43 -352.378 c 0.155 -0.153 0.297 -0.314 0.451 -0.468 c 0.084 -0.082 0.172 -0.157 0.256 -0.239 c 18.357 -18.092 27.581 -41.929 27.743 -65.902 c 0.004 -0.311 0.017 -0.623 0.018 -0.934 c -0.001 -0.316 -0.014 -0.632 -0.018 -0.948 c -0.165 -23.97 -9.389 -47.803 -27.743 -65.892 c -0.083 -0.082 -0.171 -0.157 -0.255 -0.239 c -0.154 -0.154 -0.296 -0.315 -0.452 -0.468 l -357.43 -352.378 c -37.685 -37.153 -99.034 -37.476 -136.331 -0.718 c -37.297 36.758 -36.979 97.231 0.707 134.384 z"):"vertical"===this._layout&&(this._backwardAttr.style.symbolType=null!=(i=this._backwardAttr.style.symbolType)?i:"m 161.724 521.29 l 286.257 -290.361 l 286.257 290.361 c 37.153 37.685 97.625 38.003 134.384 0.707 c 36.758 -37.297 36.435 -98.646 -0.718 -136.331 l -352.378 -357.43 c -0.153 -0.155 -0.314 -0.297 -0.468 -0.451 c -0.082 -0.084 -0.157 -0.172 -0.239 -0.256 c -18.092 -18.357 -41.929 -27.581 -65.902 -27.743 c -0.311 -0.004 -0.623 -0.017 -0.934 -0.018 c -0.316 0.001 -0.632 0.014 -0.948 0.018 c -23.97 0.165 -47.803 9.389 -65.892 27.743 c -0.082 0.083 -0.157 0.171 -0.239 0.255 c -0.154 0.154 -0.315 0.296 -0.468 0.452 l -352.378 357.43 c -37.153 37.685 -37.476 99.034 -0.718 136.331 c 36.758 37.297 97.231 36.979 134.384 -0.707 z",this._forwardAttr.style.symbolType=null!=(r=this._forwardAttr.style.symbolType)?r:"M 734.276 28.71 L 448.019 319.071 L 161.762 28.71 c -37.153 -37.685 -97.625 -38.003 -134.384 -0.707 c -36.758 37.297 -36.435 98.646 0.718 136.331 l 352.378 357.43 c 0.153 0.155 0.314 0.297 0.468 0.451 c 0.082 0.084 0.157 0.172 0.239 0.256 c 18.092 18.357 41.929 27.581 65.902 27.743 c 0.311 0.004 0.623 0.017 0.934 0.018 c 0.316 -0.001 0.632 -0.014 0.948 -0.018 c 23.97 -0.165 47.803 -9.389 65.892 -27.743 c 0.082 -0.083 0.157 -0.171 0.239 -0.255 c 0.154 -0.154 0.315 -0.296 0.468 -0.452 l 352.378 -357.43 c 37.153 -37.685 37.476 -99.034 0.718 -136.331 c -36.758 -37.297 -97.231 -36.979 -134.384 0.707 z")},this._initPlay=()=>{(0,nB.Z)(this._playController)&&(this._playController=new OM(Object.assign({},this._startAttr.style)),this.add(this._playController))},this._initBackward=()=>{(0,nB.Z)(this._backwardController)&&(this._backwardController=new OM(Object.assign({},this._backwardAttr.style)),this.add(this._backwardController))},this._initForward=()=>{(0,nB.Z)(this._forwardController)&&(this._forwardController=new OM(Object.assign({},this._forwardAttr.style)),this.add(this._forwardController))},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._playController.addEventListener("pointerdown",t=>{t.stopPropagation(),!0===this._isPaused?this.play():this.pause()}),this._backwardController.addEventListener("pointerdown",t=>{t.stopPropagation(),this.backward()}),this._forwardController.addEventListener("pointerdown",t=>{t.stopPropagation(),this.forward()}))},this.renderPlay=()=>{this._isPaused?this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._startAttr.style)):this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._pauseAttr.style))},this.renderBackward=()=>{this._backwardController.setAttributes(this._backwardAttr.style)},this.renderForward=()=>{this._forwardController.setAttributes(this._forwardAttr.style)},this.play=()=>{this._dispatchEvent(eH.OnPlay)},this.pause=()=>{this._dispatchEvent(eH.OnPause)},this.forward=()=>{this._dispatchEvent(eH.OnForward)},this.backward=()=>{this._dispatchEvent(eH.OnBackward)},this.togglePlay=()=>{this._playController.setAttributes(this._startAttr.style),this._isPaused=!0},this.togglePause=()=>{this._playController.setAttributes(this._pauseAttr.style),this._isPaused=!1},this.updateAttributes(),this._initPlay(),this._initBackward(),this._initForward(),this._initEvents()}render(){this.updateAttributes(),this.renderPlay(),this.renderBackward(),this.renderForward()}}OT.defaultControllerAttr={visible:!0,x:0,y:0,size:20,fill:"#91caff",pickMode:"imprecise",cursor:"pointer"},OT.defaultAttributes={[eD.Start]:{},[eD.Pause]:{},[eD.Backward]:{},[eD.Forward]:{}};let Ok={visible:!0,style:{x:0,y:0,dx:0,dy:0,size:20},order:0,space:10},OR=[200,10];(ed=ez||(ez={})).Default="default",ed.Reverse="reverse";let OP=({direction:t,maxIndex:e,dataIndex:i})=>t===ez.Default&&i===e,OB=({direction:t,minIndex:e,dataIndex:i})=>t===ez.Reverse&&i===e,OI=({direction:t,maxIndex:e,minIndex:i,dataIndex:r})=>OP({direction:t,maxIndex:e,dataIndex:r})||OB({direction:t,minIndex:i,dataIndex:r}),OE=({direction:t,minIndex:e,dataIndex:i})=>t===ez.Default&&i===e,OL=({direction:t,maxIndex:e,dataIndex:i})=>t===ez.Reverse&&i===e,OF=({direction:t,maxIndex:e,minIndex:i,dataIndex:r})=>OE({direction:t,minIndex:i,dataIndex:r})||OL({direction:t,maxIndex:e,dataIndex:r}),OO=t=>"top"===t||"bottom"===t,OH=(t,e,i,r)=>"default"===t?Math.min(e+1,r):Math.max(e-1,i);class OD extends CB{getMinIndex(){return this._minIndex}getMaxIndex(){return this._maxIndex}getDataIndex(){return this._dataIndex}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},OD.defaultAttributes,t)),this._data=[],this._dataIndex=0,this._layoutInfo={},this._updateSliderAttrs=()=>{var t,e;let i;(0,hy.Z)(this._handlerStyle.size)?i=this._handlerStyle.size:this._handlerStyle.size&&this._handlerStyle.size.length&&(i=(0,ik.Fp)(this._handlerStyle.size[0],this._handlerStyle.size[1]));let r={visible:this._sliderVisible,min:this._minIndex,max:this._maxIndex,value:this._dataIndex,railWidth:this._railStyle.width,railHeight:this._railStyle.height,railStyle:this._railStyle,trackStyle:this._trackStyle,handlerSize:(0,hy.Z)(i)?i:void 0,handlerStyle:this._handlerStyle,dy:this.attribute.slider.dy,dx:this.attribute.slider.dx,slidable:!0,range:!1,handlerText:{visible:!1},startText:{visible:!1},endText:{visible:!1},disableTriggerEvent:this.attribute.disableTriggerEvent};if(OO(this._orient)){let e=Math.max(0,this._layoutInfo.slider.size),i=null!=(t=this._railStyle.height)?t:OR["1"];r.layout="horizontal",r.railHeight=i,r.railWidth=e,r.x=this._layoutInfo.slider.x,r.y=this._layoutInfo.slider.y}else{let t=Math.max(0,this._layoutInfo.slider.size),i=null!=(e=this._railStyle.width)?e:OR["1"];r.layout="vertical",r.railWidth=i,r.railHeight=t,r.x=this._layoutInfo.slider.x,r.y=this._layoutInfo.slider.y}return r},this._initSlider=()=>{let t=this._updateSliderAttrs();this._slider=new EW(t),this._sliderVisible&&this.add(this._slider)},this._updateControllerAttrs=()=>{let t={start:this._start,pause:this._pause,forward:this._forward,backward:this._backward,disableTriggerEvent:this.attribute.disableTriggerEvent};return t.layout=OO(this._orient)?"horizontal":"vertical",t.start=Object.assign(Object.assign({},t.start),{style:Object.assign(Object.assign({},t.start.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),t.pause=Object.assign(Object.assign({},t.pause),{style:Object.assign(Object.assign({},t.pause.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),t.backward=Object.assign(Object.assign({},t.backward),{style:Object.assign(Object.assign({},t.backward.style),{x:this._layoutInfo.backward.x,y:this._layoutInfo.backward.y})}),t.forward=Object.assign(Object.assign({},t.forward),{style:Object.assign(Object.assign({},t.forward.style),{x:this._layoutInfo.forward.x,y:this._layoutInfo.forward.y})}),t},this._initController=()=>{let t=this._updateControllerAttrs();this._controller=new OT(t),this._controllerVisible&&this.add(this._controller)},this._initAttributes(),this._initDataIndex(),this._initLayoutInfo(),this._initController(),this._initSlider()}_initAttributes(){this._size=this.attribute.size,this._orient=this.attribute.orient,this._data=this.attribute.data,this._minIndex=0,this._maxIndex=this._data.length-1;let{slider:t={},controller:e={}}=this.attribute;this._sliderVisible=t.visible,this._railStyle=Object.assign({},t.railStyle),this._trackStyle=Object.assign({},t.trackStyle),this._handlerStyle=Object.assign({},t.handlerStyle),this._controllerVisible=e.visible,this._start=Object.assign({},e.start),this._pause=Object.assign({},e.pause),this._forward=Object.assign({},e.forward),this._backward=Object.assign({},e.backward)}_initDataIndex(){var t;this._dataIndex=null!=(t=this.attribute.dataIndex)?t:0}_initLayoutInfo(){var t,e,i;let r=[this._start,this._backward,this._forward].sort((t,e)=>t.order-e.order),n=r.filter(t=>"end"!==t.position),l=r.filter(t=>"end"===t.position),s=null!=(t=OO(this._orient)?this._railStyle.height:this._railStyle.width)?t:OR["1"],a=r.reduce((t,e)=>{let i=e.style.size,r=(0,n4.Z)(i)?i:(0,ik.Fp)(i[0],i[1]);return t+e.space+r},0),o=this._sliderVisible?(OO(this._orient)?null==(e=this._size)?void 0:e.width:null==(i=this._size)?void 0:i.height)-a:0,h=o-this.attribute.slider.space,d=n.reduce((t,e)=>{let{key:i,space:r,style:{size:n}}=e,l=(0,n4.Z)(n)?n:(0,ik.Fp)(n[0],n[1]);return this._layoutInfo[i]=Object.assign(Object.assign({},this._layoutInfo[i]),{size:l,x:OO(this._orient)?t+r:(this._size.width-l)/2,y:OO(this._orient)?(this._size.height-l)/2:t+r}),t+r+l},0);this._layoutInfo.slider=Object.assign(Object.assign({},this._layoutInfo.slider),{size:h,x:OO(this._orient)?d+this.attribute.slider.space:(this._size.width-s)/2,y:OO(this._orient)?(this._size.height-s)/2:d+this.attribute.slider.space}),l.reduce((t,e)=>{let{key:i,space:r,style:{size:n}}=e,l=(0,n4.Z)(n)?n:(0,ik.Fp)(n[0],n[1]);return this._layoutInfo[i]=Object.assign(Object.assign({},this._layoutInfo[i]),{size:l,x:OO(this._orient)?t+r:(this._size.width-l)/2,y:OO(this._orient)?(this._size.height-l)/2:t+r}),t+r+l},d+o)}render(){this._initLayoutInfo(),this.renderSlider(),this.renderController()}renderSlider(){let t=this._updateSliderAttrs();this._slider.setAttributes(t)}renderController(){let t=this._updateControllerAttrs();this._controller.setAttributes(t)}dispatchCustomEvent(t,e){this._dispatchEvent(t,{eventType:t,index:e,value:this._data[e]})}}function Oz(){EA(),uD(),cH()}OD.defaultAttributes={visible:!0,data:[],interval:1e3,orient:"bottom",align:"center",size:{height:20,width:300},slider:{visible:!0,space:10,dx:0,dy:0,railStyle:{cornerRadius:5},trackStyle:{},handlerStyle:{}},controller:{visible:!0,start:Object.assign(Object.assign({},Ok),{key:"start",position:"start",space:0}),pause:Object.assign(Object.assign({},Ok),{key:"pause",position:"start"}),forward:Object.assign(Object.assign({},Ok),{key:"forward",position:"end"}),backward:Object.assign(Object.assign({},Ok),{key:"backward",position:"start"})}},(eu=eW||(eW={})).change="change",eu.play="play",eu.pause="pause",eu.backward="backward",eu.forward="forward",eu.end="end",eu.OnChange="change",eu.OnPlay="play",eu.OnPause="pause",eu.OnBackward="backward",eu.OnForward="forward",eu.OnEnd="end",Oz();class OW extends OD{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},t)),this._activeIndex=-1,this._isReachEnd=!1,this._initAttributes=()=>{var t,e,i;super._initAttributes(),this._alternate=null!=(t=this.attribute.alternate)&&t,this._interval=null!=(e=this.attribute.interval)?e:1e3,this._direction=null!=(i=this.attribute.direction)?i:ez.Default},this._initDataIndex=()=>{var t;this._dataIndex=(0,nB.Z)(this.attribute.dataIndex)?"default"===this._direction?this._minIndex:this._maxIndex:null!=(t=this.attribute.dataIndex)?t:0,this._slider.setAttribute("value",this._dataIndex)},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(eH.OnPlay,t=>{t.stopPropagation(),this.play()}),this._controller.addEventListener(eH.OnPause,t=>{t.stopPropagation(),this.pause()}),this._controller.addEventListener(eH.OnForward,t=>{t.stopPropagation(),this.forward()}),this._controller.addEventListener(eH.OnBackward,t=>{t.stopPropagation(),this.backward()}),this._slider.addEventListener("change",t=>{let e=Math.floor(t.detail.value)+.5;this._dataIndex=t.detail.value>=e?Math.ceil(t.detail.value):Math.floor(t.detail.value),this._slider.setValue(this._dataIndex),this.dispatchCustomEvent(eW.change)}))},this.play=()=>{this._isPlaying||1!==this._data.length&&(this._controller.togglePause(),this._isPlaying=!0,(OI({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction})||OF({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction}))&&(this._direction===ez.Default?this._updateDataIndex(this._minIndex):this._updateDataIndex(this._maxIndex)),this.dispatchCustomEvent(eW.play),this._isReachEnd=!1,this._tickTime=Date.now(),this._rafId=hd.getRequestAnimationFrame()(this._play.bind(this,!0)))},this._play=t=>{let e=Date.now();if(this._isReachEnd&&e-this._tickTime>=this._interval)return this._isReachEnd=!1,void this._playEnd();t&&this._activeIndex!==this._dataIndex?(this.dispatchCustomEvent(eW.change),this._activeIndex=this._dataIndex):e-this._tickTime>=this._interval&&(this._tickTime=e,this._updateDataIndex(OH(this._direction,this._dataIndex,this._minIndex,this._maxIndex)),this._activeIndex=this._dataIndex,this.dispatchCustomEvent(eW.change)),("default"===this._direction&&this._dataIndex>=this._maxIndex||"reverse"===this._direction&&this._dataIndex<=this._minIndex)&&(this._isReachEnd=!0),this._rafId=hd.getRequestAnimationFrame()(this._play.bind(this,!1))},this._updateDataIndex=t=>{this._dataIndex=t,this._slider.setValue(this._dataIndex)},this._playEnd=()=>{this._isPlaying=!1,this._controller.togglePlay(),hd.getCancelAnimationFrame()(this._rafId),this._activeIndex=-1,this.dispatchCustomEvent(eW.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,hd.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(eW.pause))},this.backward=()=>{let t,{loop:e=!1}=this.attribute;t=e?this._dataIndex-1<this._minIndex?this._maxIndex:this._dataIndex-1:Math.max(this._dataIndex-1,this._minIndex),this._updateDataIndex(t),this.dispatchCustomEvent(eW.change),this.dispatchCustomEvent(eW.backward)},this.forward=()=>{let t,{loop:e=!1}=this.attribute;t=e?this._dataIndex+1>this._maxIndex?this._minIndex:this._dataIndex+1:Math.min(this._dataIndex+1,this._maxIndex),this._updateDataIndex(t),this.dispatchCustomEvent(eW.change),this.dispatchCustomEvent(eW.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}setAttributes(t,e){super.setAttributes(t,e),this._initAttributes()}dispatchCustomEvent(t){super.dispatchCustomEvent(t,this._dataIndex)}}Oz();class OZ extends OD{constructor(t){super(t),this._isPlaying=!1,this._startTime=Date.now(),this._initAttributes=()=>{var t;super._initAttributes(),this._maxIndex=this._data.length,this._slider.setAttribute("max",this._maxIndex),this._isPlaying=!1,this._elapsed=0,this._interval=null!=(t=this.attribute.interval)?t:1e3;let e=this._data.length;this.attribute.totalDuration&&this._data.length?(this._totalDuration=this.attribute.totalDuration,this._interval=this._totalDuration/(null!=e?e:1)):(this._totalDuration=this._interval*e,this._interval=this.attribute.interval)},this._initDataIndex=()=>{var t;this._dataIndex=null!=(t=this.attribute.dataIndex)?t:this._minIndex},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(eH.OnPlay,t=>{t.stopPropagation(),this.play()}),this._controller.addEventListener(eH.OnPause,t=>{t.stopPropagation(),this.pause()}),this._controller.addEventListener(eH.OnForward,t=>{t.stopPropagation(),this.forward()}),this._controller.addEventListener(eH.OnBackward,t=>{t.stopPropagation(),this.backward()}),this._slider.addEventListener("change",t=>{var e;t.stopPropagation();let i=null==(e=t.detail)?void 0:e.value,r=i/this._maxIndex;this._elapsed=r*this._totalDuration,this._startTime=Date.now()-this._elapsed,this._dispatchChange(i)}))},this._getSliderValue=()=>Math.min(this._elapsed/this._totalDuration*this._maxIndex,this._maxIndex),this._updateSlider=()=>{let t=this._getSliderValue();this._dataIndex=Math.floor(t),this._slider.setValue(Math.min(t,this._maxIndex)),this._dispatchChange(Math.floor(t))},this._dispatchChange=t=>{let e=Math.floor(t);e!==this._activeIndex&&(this._dataIndex=e,this._activeIndex=e,e!==this._maxIndex&&this.dispatchCustomEvent(eW.change))},this.play=()=>{var t,e,i,r;return t=this,e=void 0,i=void 0,r=function*(){this._isPlaying||(this._controller.togglePause(),this._isPlaying=!0,this._elapsed>=this._totalDuration&&(this._elapsed=0),this._startTime=Date.now()-this._elapsed,this.dispatchCustomEvent(eW.play),this._rafId=hd.getRequestAnimationFrame()(this._play.bind(this)))},new(i||(i=Promise))(function(n,l){function s(t){try{o(r.next(t))}catch(t){l(t)}}function a(t){try{o(r.throw(t))}catch(t){l(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(s,a)}o((r=r.apply(t,e||[])).next())})},this._play=()=>{this._elapsed=Date.now()-this._startTime;let t=this._getSliderValue();this._updateSlider(),t>=this._maxIndex?this._playEnd():this._rafId=hd.getRequestAnimationFrame()(this._play.bind(this))},this._playEnd=()=>{this._isPlaying=!1,hd.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(eW.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,this._elapsed=Date.now()-this._startTime,hd.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(eW.pause))},this.backward=()=>{let t=Date.now(),e=+this._interval,i=this._elapsed-e;i<=0?(this._elapsed=0,this._startTime=t):(this._elapsed=i,this._startTime=this._startTime+this._interval),this._updateSlider(),this.dispatchCustomEvent(eW.backward)},this.forward=()=>{let t=Date.now(),e=+this._interval,i=this._elapsed+e;i>=this._totalDuration?(this._startTime=t-this._totalDuration,this._elapsed=this._totalDuration):(this._startTime=this._startTime-e,this._elapsed=i),this._updateSlider(),this.dispatchCustomEvent(eW.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}dispatchCustomEvent(t){super.dispatchCustomEvent(t,this._dataIndex)}render(){super.render()}}let ON=t=>xg(Object.assign({},t)),Oj=t=>xg(Object.assign({},t)),OG=t=>Object.assign(Object.assign({},t),{style:Object.assign({},xg(t.style))}),OV=t=>{var e,i,r,n,l,s,a,o,h,d,u,c,p,g,f;let m=ON(null!=(i=null==(e=null==t?void 0:t.slider)?void 0:e.trackStyle)?i:{}),y=ON(null!=(n=null==(r=null==t?void 0:t.slider)?void 0:r.railStyle)?n:{}),v=Oj(null!=(s=null==(l=null==t?void 0:t.slider)?void 0:l.handlerStyle)?s:{}),b=OG(null!=(o=null==(a=null==t?void 0:t.controller)?void 0:a.start)?o:{}),_=OG(null!=(d=null==(h=null==t?void 0:t.controller)?void 0:h.pause)?d:{}),C=OG(null!=(c=null==(u=null==t?void 0:t.controller)?void 0:u.backward)?c:{}),x=OG(null!=(g=null==(p=null==t?void 0:t.controller)?void 0:p.forward)?g:{}),w=Object.assign(Object.assign({},t),{direction:t.direction,interval:t.interval,visible:t.visible,orient:null!=(f=t.orient)?f:"bottom",slider:Object.assign(Object.assign({},t.slider),{trackStyle:m,railStyle:y,handlerStyle:v}),controller:Object.assign(Object.assign({},t.controller),{start:b,pause:_,backward:C,forward:x})});return t.visible||(w.controller.visible=!1,w.slider.visible=!1),w},OU=(t,e)=>Object.assign(Object.assign({},OV(t)),{data:e,type:"continuous"}),OK=(t,e)=>Object.assign(Object.assign({},OV(t)),{data:e,type:"discrete"}),OX=t=>"left"===t||"right"===t,OY=t=>"top"===t||"bottom"===t;class O$ extends xZ{constructor(){super(...arguments),this.layoutZIndex=ts.Player,this.layoutLevel=ta.Player,this.specKey="player",this.type=oQ.player,this._orient="bottom",this._getPlayerAttrs=()=>{var t,e,i,r,n,l;let s=this._spec.type,a={size:{width:this._width,height:this._height},dx:null!=(t=this._spec.dx)?t:0+this._dx,dy:null!=(e=this._spec.dy)?e:0+this._dy};return"discrete"===s?Object.assign(Object.assign(Object.assign({},OK(this._spec,this._specs)),a),{disableTriggerEvent:this._option.disableTriggerEvent,loop:null==(r=null==(i=this._spec)?void 0:i.loop)||r}):Object.assign(Object.assign(Object.assign({},OU(this._spec,this._specs)),a),{disableTriggerEvent:this._option.disableTriggerEvent,loop:null==(l=null==(n=this._spec)?void 0:n.loop)||l})},this._createOrUpdatePlayerComponent=()=>{let t=Object.assign({},this._getPlayerAttrs()),e=this.getContainer();this._playerComponent?(0,uL.X)(t,this._cacheAttrs)||(this._cacheAttrs=t,this._playerComponent.setAttributes(t),this._playerComponent._initAttributes(),this._playerComponent.render()):("discrete"===t.type?this._playerComponent=new OW(t):this._playerComponent=new OZ(t),this._cacheAttrs=t,this._playerComponent.name="player",e.add(this._playerComponent),this._initEvent())},this._maxSize=()=>{var t,e,i,r,n,l,s,a,o;return Math.max(...(0,a1.IX)(null==(e=null==(t=this._spec.controller.start)?void 0:t.style)?void 0:e.size),...(0,a1.IX)(null==(r=null==(i=this._spec.controller.pause)?void 0:i.style)?void 0:r.size),...(0,a1.IX)(null==(l=null==(n=this._spec.controller.backward)?void 0:n.style)?void 0:l.size),...(0,a1.IX)(null==(a=null==(s=this._spec.controller.forward)?void 0:s.style)?void 0:a.size),null!=(o=OX(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)?o:10)},this._sliderExceededSize=()=>{var t,e,i,r,n,l,s,a,o;let h=null!=(t=OX(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)?t:10,d=Math.max(...(0,a1.IX)(null==(i=null==(e=this._spec.controller.start)?void 0:e.style)?void 0:i.size),...(0,a1.IX)(null==(n=null==(r=this._spec.controller.pause)?void 0:r.style)?void 0:n.size),...(0,a1.IX)(null==(s=null==(l=this._spec.controller.backward)?void 0:l.style)?void 0:s.size),...(0,a1.IX)(null==(o=null==(a=this._spec.controller.forward)?void 0:a.style)?void 0:o.size));return h>=d?h-d:0},this._initEvent=()=>{this._option.disableTriggerEvent||(this._option.globalInstance.on(J.rendered,()=>{var t;(null==(t=this._spec)?void 0:t.auto)&&(this._playerComponent.pause(),this._playerComponent.play())}),this._playerComponent.addEventListener(eW.end,()=>{var t;this.event.emit(J.playerEnd,{model:this}),this._alternate&&"discrete"===this._spec.type&&(this._direction="default"===this._direction?"reverse":"default",this._playerComponent.setAttributes({direction:this._direction,dataIndex:"reverse"===this._direction?this._specs.length-2:1})),(null==(t=this._spec)?void 0:t.loop)&&this._playerComponent.play()}),this._playerComponent.addEventListener(eW.change,t=>{let{index:e}=t.detail;this.changePlayerIndex(e)}),this._playerComponent.addEventListener(eW.backward,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(J.playerBackward,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(eW.forward,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(J.playerForward,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(eW.play,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(J.playerPlay,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(eW.pause,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(J.playerPause,{model:this,value:{spec:i,index:e,specs:this._specs}})}))}}get orient(){return this._orient}set layoutOrient(t){this._orient=t}setAttrFromSpec(){var t,e,i,r,n,l,s,a;super.setAttrFromSpec(),this._orient=null!=(t=this._spec.orient)?t:"bottom",this._specs=null!=(e=this._spec.specs)?e:[],this._direction=null!=(i=this._spec.direction)?i:"default",this._alternate=null!=(r=this._spec.alternate)&&r,this._dx=null!=(n=this._spec.dx)?n:0,this._dy=null!=(l=this._spec.dy)?l:0,this._position=null!=(s=this._spec.position)?s:"middle",this._visible=null==(a=this._spec.visible)||a}afterSetLayoutStartPoint(t){if(super.afterSetLayoutStartPoint(t),(0,hy.Z)(t.x)){let e=OX(this._orient)?t.x+this._sliderExceededSize()/2:t.x;this._playerComponent&&this._playerComponent.setAttribute("x",e)}if((0,hy.Z)(t.y)){let e=OY(this._orient)?t.y+this._sliderExceededSize()/2:t.y;this._playerComponent&&this._playerComponent.setAttribute("y",e)}}getBoundsInRect(t,e){this._width=this._computeWidth(t),this._height=this._computeHeight(t),this._dx=this._computeDx(e),this._dy=this._computeDy(e);let i=this._computeLayoutRect(t,this._width,this._height);return this._createOrUpdatePlayerComponent(),i}_getNeedClearVRenderComponents(){return[this._playerComponent]}_computeLayoutRect(t,e,i){if(!1===this._visible)return{x1:0,x2:0,y1:0,y2:0};switch(this._orient){case"top":case"left":return{x1:0,y1:0,x2:e,y2:i};case"right":return{x1:t.width-e,y1:0,x2:t.width,y2:t.height};default:return{x1:0,y1:t.height-i,x2:t.width,y2:t.height}}}_computeWidth(t){return(0,n4.Z)(this._spec.width)?Math.min(t.width,Number(this._spec.width)):OX(this._orient)?this._maxSize():t.width}_computeHeight(t){return(0,n4.Z)(this._spec.height)?(this._height=this._spec.height,Math.min(t.height,Number(this._spec.height))):OY(this._orient)?this._maxSize():t.height}_computeDx(t){return OX(this._orient)||"start"===this._position?0:"middle"===this._position?(t.width-this._width)/2:t.width-this._width}_computeDy(t){return OY(this._orient)||"start"===this._position?0:"middle"===this._position?(t.height-this._height)/2:t.height-this._height}changePlayerIndex(t){let e=this._specs[t];this._option.globalInstance.updateFullData(e.data),this.event.emit(J.playerChange,{model:this,value:{spec:e,index:t,specs:this._specs}})}}O$.builtInTheme={player:{visible:!0,position:"start",padding:{top:20,bottom:20},slider:{space:10,trackStyle:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.8},railStyle:{fill:{type:"palette",key:"sliderRailColor"}},handlerStyle:{size:15,stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fill:{type:"palette",key:"playerControllerColor"}}},controller:{start:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},pause:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},backward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},forward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}}}}},O$.specKey="player",O$.type=oQ.player;let Oq=()=>{h9.registerComponent(O$.type,O$)};class OJ extends xZ{constructor(t,e){super(t,e),this.type=oQ.label,this.name=oQ.label,this.layoutType="none",this.layoutZIndex=ts.Label,this._regions=e.getRegionsInIndex(e.regionIndexes)}_interactiveConfig(t){let{interactive:e}=t,i={hover:!1,select:!1,state:t.state};if(!0!==e)return i;let{hover:r,select:n}=this._option.getChart().getSpec();return!1===r&&!1===r.enable||(i.hover=!0),!1===n&&!1===n.enable||(i.select=!0),i}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reRender=!0,(0,uL.X)(e,t)||(i.reMake=!0),i}_getDataLabelType(t,e){let i=t.type;return"line"===i||"area"===i?null!=e?e:"line-data":"rect"===i?"rect":"arc"===i?"arc":"symbol"===i||"cell"===i?"symbol":t.setDataLabelType?t.setDataLabelType():""}_setTransformOfComponent(t,e){t.setAttributeTransform(({labelStyle:t,size:i,itemEncoder:r})=>{let n=i(),l=hJ({type:"palette",key:"secondaryFontColor"},this.getColorScheme());return{dataLabels:(0,a1.IX)(e).map((e,i)=>{let s=t(i),a=[],o=e.getGraphics();if(o)return s.data&&s.data.length?s.data.forEach((t,e)=>{if(o[e]){let e=r(t,{labelIndex:i});(0,nB.Z)(e.fill)&&(e.fill=l),(0,nB.Z)(e.data)&&(e.data=t),a.push(e)}}):o.forEach(t=>{let{data:e,diffState:n}=t.context;n!==th.exit&&e.forEach((t,{})=>{let e=r(t,{labelIndex:i});(0,nB.Z)(e.fill)&&(e.fill=l),(0,nB.Z)(e.data)&&(e.data=t),a.push(e)})}),(0,hc.Z)(s.overlap)&&(0,nB.Z)(s.overlap.size)&&(s.overlap.size=Object.assign({},n)),Object.assign(Object.assign({smartInvert:!1,baseMarkGroupName:e.getProductId(),getBaseMarks:()=>o},s),{type:this._getDataLabelType(e,s.type),data:a})}),size:n}})}getVRenderComponents(){let t=[];return this.getMarks().forEach(e=>{let i=e.getComponent();i&&t.push(i)}),t}clear(){super.clear(),this.getMarks().forEach(t=>{t&&t.clearComponent()})}}OJ.type=oQ.label;class OQ extends kO{constructor(){super(...arguments),this.skipEncode=!1}getRule(){return this._rule}setRule(t){this._rule=t}getTarget(){return this._target}setTarget(t){this._target=t,this._rule||this.setRule(t.type)}getComponent(){return this._component}setComponent(t){this._component=t}render(){}}OQ.type="text",OQ.constructorType="label";let O0=()=>{kH(),h9.registerMark(OQ.constructorType,OQ)};class O1 extends xz{_initTheme(t,e){return{spec:t,theme:this._theme}}}var O2=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class O3 extends CB{constructor(t,e){let{dataLabels:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({dataLabels:i},(0,h3.Z)({},O3.defaultAttributes,O2(t,["dataLabels"])))),this.name="data-label"}render(){var t;let{dataLabels:e,size:i}=this.attribute;if(!e||0===e.length)return;let{width:r=0,height:n=0,padding:l}=i||{};if(!r||!n||!(0,hy.Z)(n*r))return;this._componentMap||(this._componentMap=new Map);let s=_1(r,n,l),a=s.bitmap(),o=new Map,h=this._componentMap;for(let r=0;r<e.length;r++){let n=e[r],l=CH(n.type)||CL;if(l){let{baseMarkGroupName:e,type:h}=n,d=null!=(t=n.id)?t:`${e}-${h}-${r}`;"arc"===n.type&&(n.width=i.width,n.height=i.height);let u=this._componentMap.get(d);u?(u.setBitmapTool(s),u.setBitmap(a),u.setAttributes(n)):((u=new l(n)).setBitmap(a),u.setBitmapTool(s),this.add(u)),o.set(d,u)}}h.forEach((t,e)=>{o.get(e)||this.removeChild(t)}),this._componentMap=o}setLocation(t){this.translateTo(t.x,t.y)}disableAnimation(){this._componentMap.forEach(t=>{t.disableAnimation()})}enableAnimation(){this._componentMap.forEach(t=>{t.enableAnimation()})}}O3.defaultAttributes={pickable:!1};class O5 extends OJ{constructor(t,e){super(t,e),this.type=oQ.label,this.name=oQ.label,this.specKey="label",this.transformerConstructor=O1,this.layoutZIndex=ts.Label,this._layoutRule=t.labelLayout||"series"}static getSpecInfo(t,e){let i=[];return((null==e?void 0:e.region)||[]).forEach((r,n)=>{(r.seriesIndexes||[]).some(t=>{let{markLabelSpec:i={}}=e.series[t];return Object.values(i).some(t=>Array.isArray(t)&&t.some(t=>t.visible))})&&i.push({spec:t,type:oQ.label,specInfoPath:["component",this.specKey,n],regionIndexes:[n]})}),i}init(t){super.init(t),this.initEvent(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()}reInit(t){super.reInit(t),this._labelInfoMap&&(this._labelInfoMap.forEach(t=>{t.forEach(({labelMark:t})=>{t.release()})}),this._labelInfoMap.clear()),this._labelInfoMap&&this._labelInfoMap.clear(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()}initEvent(){this.event.on(J.dataZoomChange,()=>{this._labelComponentMap.forEach((t,e)=>{let i=e.getComponent();i&&i.disableAnimation()}),this.event.on(q.AFTER_MARK_RENDER_END,t)});let t=()=>{this._labelComponentMap.forEach((t,e)=>{let i=e.getComponent();i&&i.enableAnimation()}),this.event.off(q.AFTER_MARK_RENDER_END,t)}}_initTextMark(){this._labelInfoMap||(this._labelInfoMap=new Map),this._labelComponentMap||(this._labelComponentMap=new Map),C$(this._regions,t=>{let{markLabelSpec:e={}}=t.getSpecInfo(),i=Object.keys(e),r=t.getRegion();this._labelInfoMap.get(r)||this._labelInfoMap.set(r,[]);for(let n=0;n<i.length;n++){let l=i[n],s=t.getMarkInName(l);s&&e[l].forEach((e,i)=>{var n,a,o;if(e.visible){let h=this._labelInfoMap.get(r),d=this._createMark({type:"label",name:`${null!=(n=t.userId)?n:t.id}-${l}-label-${i}`},{attributeContext:t.getMarkAttributeContext()});e.showRelatedMarkTooltip&&(null==(o=null==(a=t.tooltipHelper)?void 0:a.activeTriggerSet.mark)||o.add(d)),d.setTarget(s),h.push({labelMark:d,baseMark:s,series:t,labelSpec:e})}})}})}_initLabelComponent(){let t={};this._labelComponentMap.forEach((e,i)=>{t[i.name]=i}),this._labelInfoMap.forEach((e,i)=>{if("region"===this._layoutRule){let r=!1,n=`${i.getGroupMark().name}-label-component`,l=t[n];l||(r=!0,l=this._createMark({type:"component",name:n},{componentType:"label"},{support3d:this._spec.support3d})),l&&(r&&(l.setSkipBeforeLayouted(!0),this._marks.addMark(l),e.forEach(t=>{var e;null==(e=t.baseMark.getData())||e.addRelatedMark(l)})),e[0]&&(0,aw.Z)(e[0].labelSpec.zIndex)&&l.setMarkConfig({zIndex:e[0].labelSpec.zIndex}),this._labelComponentMap.set(l,()=>this._labelInfoMap.get(i)),t[n]=null)}else e.forEach((e,r)=>{var n;let l=!1,s=`${e.labelMark.name}-component`,a=t[s];a||(l=!0,a=this._createMark({type:"component",name:s},{componentType:"label",noSeparateStyle:!0},{support3d:e.baseMark.getMarkConfig().support3d})),a&&((0,aw.Z)(e.labelSpec.zIndex)&&a.setMarkConfig({zIndex:e.labelSpec.zIndex}),l&&(a.setSkipBeforeLayouted(!0),this._marks.addMark(a),null==(n=e.baseMark.getData())||n.addRelatedMark(a)),this._labelComponentMap.set(a,()=>this._labelInfoMap.get(i)[r]),t[s]=null)})}),Object.keys(t).forEach(e=>{let i=t[e];i&&(i.release(),this._labelComponentMap.delete(i))})}_initTextMarkStyle(){this._labelComponentMap.forEach((t,e)=>{(0,a1.IX)(t()).forEach(({labelMark:t})=>{t.setComponent(e)})}),this._labelInfoMap.forEach(t=>{t.forEach(t=>{var e,i;let{labelMark:r,labelSpec:n,series:l}=t;if(this.initMarkStyleWithSpec(r,n),(0,nz.Z)(null==n?void 0:n.getStyleHandler)){let t=n.getStyleHandler(l);null==t||t.call(l,r,n)}(null==(i=null==(e=r.stateStyle)?void 0:e.normal)?void 0:i.lineWidth)&&r.setAttribute("stroke",l.getColorAttribute(),"normal",to.Base_Series)})})}updateLayoutAttribute(){super.updateLayoutAttribute(),this._labelComponentMap.forEach((t,e)=>{let i=t();(0,rD.Z)(i)?this._updateMultiLabelAttribute(i,e):this._updateSingleLabelAttribute(i,e)})}_updateMultiLabelAttribute(t,e){this._updateLabelComponentAttribute(e,t.map(({baseMark:t})=>t),t)}_updateSingleLabelAttribute(t,e){let{baseMark:i}=t;this._updateLabelComponentAttribute(e,i,[t])}_updateLabelComponentAttribute(t,e,i){let r=this._option.getComponentsByType("totalLabel");t.setMarkConfig({interactive:!1}),t.setSimpleStyle({labelStyle:t=>{var e,n;let l=i[t],{labelSpec:s,labelMark:a,series:o}=l,h=a.getRule(),d=this._interactiveConfig(s),u=null!=(n=null==(e=this._spec)?void 0:e.centerOffset)?n:0,c=h5({textStyle:Object.assign({pickable:!0===s.interactive},s.style),overlap:{avoidMarks:r.map(t=>t.getMarks()[0].getProductId())}},function(t,e){var i;let{labelSpec:r}=e;r.overlap&&!(0,nF.Z)(r.overlap)&&(r.overlap={});let n=null!=(i=Bv[t])?i:Bv.point;return e.series.type===Y.sankey?function(t){var e,i,r,n;let{series:l,labelSpec:s={}}=t,a=null!=(e=B_(s.position))?e:"outside",o=l.direction,h=a;return(0,nI.Z)(a)&&("vertical"===o?h="inside-start"===a?t=>"inside-left":"inside-middle"===a?t=>"center":"inside-end"===a?t=>"inside-right":t=>"bottom":"inside-start"===a?h=t=>"inside-left":"inside-middle"===a?h=t=>"center":"inside-end"===a?h=t=>"inside-right":"outside"===a&&(h=t=>"right")),{position:h,overlap:!1!==s.overlap&&(!(0,nI.Z)(a)||!a.includes("inside"))&&{strategy:null!=(r=null==(i=s.overlap)?void 0:i.strategy)?r:(n=l,[{type:"position",position:t=>"horizontal"===n.direction?["right","left"]:["bottom","top"]}])},smartInvert:!1,offset:0,syncState:!0}}(e):n(e)}(h,l),Object.assign(Object.assign(Object.assign({},(0,xN.Z)(s,["position","style","state","type","stackDataFilterType","getStyleHandler"])),d),{centerOffset:u}),s.stackDataFilterType?{dataFilter:"min"===s.stackDataFilterType?t=>t.filter(t=>t.data[uy]):t=>t.filter(t=>t.data[um])}:{});return o&&o.parseLabelStyle&&(c=o.parseLabelStyle(c,s,a)),"line"!==h&&"area"!==h||(c.type=h),c},size:()=>{var t;return Object.assign({padding:null==(t=i[0].labelSpec.overlap)?void 0:t.padding},i[0].series.getRegion().getLayoutRect())},itemEncoder:(t,{labelIndex:e})=>i[e]&&!i[e].labelMark.skipEncode?Bb(i[e],t,i[e].labelSpec.formatMethod,i[e].labelSpec.formatter):{data:t}}),this._setTransformOfComponent(t,e)}compileMarks(){this.getMarks().forEach(t=>{let e,i=this._labelComponentMap.get(t)();e=(0,rD.Z)(i)?i[0].series.getRegion().getGroupMark().getProduct():i.series.getRegion().getGroupMark().getProduct(),t.compile({group:e})})}getLabelInfoByTextGraphic(t){let e,i=null==t?void 0:t.parent,r=null==i?void 0:i.parent;if(r){let t=r.getChildren().indexOf(i);this._labelComponentMap.forEach((i,n)=>{n.getComponent()===r&&(e=(0,a1.IX)(i())[t])})}return e}}O5.type=oQ.label,O5.specKey="label",O5.transformerConstructor=O1;let O4=()=>{h9.registerGraphicComponent(O5.type,t=>new O3(t)),O0(),xG(),h9.registerComponent(O5.type,O5,!0,1/0)};class O6 extends OJ{constructor(){super(...arguments),this.type=oQ.totalLabel,this.name=oQ.totalLabel,this.specKey="totalLabel",this.layoutZIndex=ts.Label}static getSpecInfo(t,e){var i;let r=[];return null==(i=null==e?void 0:e.region)||i.forEach((t,i)=>{var n;null==(n=t.seriesIndexes)||n.forEach(t=>{let{spec:n}=e.series[t],l=n[this.specKey];(null==l?void 0:l.visible)&&r.push({spec:l,type:oQ.totalLabel,specPath:["series",t,this.specKey],specInfoPath:["component",this.specKey,t],regionIndexes:[i],seriesIndexes:[t]})})}),r}init(t){super.init(t),this._initTextMark(),this._initLabelComponent()}reInit(t){super.reInit(t),this._initTextMark()}_initTextMark(){var t;let e=this._getSeries();if(null==(t=e.getSpec().totalLabel)?void 0:t.visible){let t=e.getSeriesMark();if(t){let e=this._createMark({type:"label",name:`${t.name}-total-label`});this._baseMark=t,this._textMark=e,this._initTextMarkStyle()}}}_initTextMarkStyle(){var t;super.initMarkStyleWithSpec(this._textMark,this._spec),this.setMarkStyle(this._textMark,{text:t=>t[ug]},"normal",to.Default);let e=this._getSeries();null==(t=e.initTotalLabelMarkStyle)||t.call(e,this._textMark)}_initLabelComponent(){var t;let e=this._getSeries(),i=this._createMark({type:"component",name:`${null!=(t=e.name)?t:e.type}-total-label-component`},{componentType:"label"},{support3d:this._spec.support3d});i&&(this._marks.addMark(i),e.getData().addRelatedMark(i))}updateLayoutAttribute(){super.updateLayoutAttribute();let t=this._getSeries();this._marks.forEach((e,i)=>{e.setMarkConfig({interactive:!1}),e.setSimpleStyle({labelStyle:()=>{var e,i;if(this._baseMark){let{offset:r,animation:n,overlap:l,position:s="top"}=this._spec,a=this._interactiveConfig(this._spec);return h5({textStyle:{pickable:!0===this._spec.interactive},position:function(t,e,i="top"){var r,n;let l,{direction:s}=t,a=+("horizontal"===s?null!=(r=t.getXAxisHelper())&&!!r.isInverse():null!=(n=t.getYAxisHelper())&&!!n.isInverse());switch(e){case"rect":case"symbol":l=("bottom"===i?{vertical:["bottom","top"],horizontal:["left","right"]}:{vertical:["top","bottom"],horizontal:["right","left"]})[s][a];break;default:l="top"}return l}(t,this._baseMark.type,s),x:0,y:0},null!=(i=null==(e=t.getTotalLabelComponentStyle)?void 0:e.call(t,{baseMark:this._baseMark,labelMark:this._textMark}))?i:{},Object.assign({offset:r,animation:n,overlap:l,dataFilter:t=>t.filter(t=>"bottom"===s?t.data[uy]:t.data[um])},a))}},size:()=>{var t;return Object.assign({padding:null==(t=this._spec.overlap)?void 0:t.padding},this._regions[0].getLayoutRect())},itemEncoder:e=>Bb({baseMark:this._baseMark,labelMark:this._textMark,series:t,labelSpec:t.getSpec().totalLabel},e,this._spec.formatMethod)}),this._setTransformOfComponent(e,this._baseMark)})}compileMarks(){this.getMarks().forEach(t=>{let e=this._regions[0].getGroupMark().getProduct();t.compile({group:e,context:{model:this}})})}_getSeries(){return this._option.getSeriesInIndex([this.getSpecPath()[1]])[0]}}O6.type=oQ.totalLabel,O6.builtInTheme={totalLabel:{visible:!1,offset:5,overlap:{clampForce:!0,strategy:[]},smartInvert:!1,animation:!1,style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"primaryFontColor"}}}},O6.specKey="totalLabel";let O7=()=>{h9.registerGraphicComponent(O6.type,t=>new O3(t)),O0(),xG(),h9.registerComponent(O6.type,O6,!0)},O8=(t,e)=>{let i=Math.atan2(t,e);return i<0?i+2*Math.PI:i};function O9(){Ht._animate=Fj}FS(),Ss(),Sa(),cH(),Fw(),_W(),yL();class Ht extends FT{markerAnimate(t){Ht._animate&&this._animationConfig&&Ht._animate([this._line,this._decorativeLine],this._item,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Ht.defaultAttributes,t)),this.name="markPoint",this.defaultUpdateAnimation=FU,this.defaultExitAnimation=FK,this._isArcLine=!1,this._isStraightLine=!1}setLabelPos(){}getTextAlignAttr(t,e,i,r,n){return _q(Math.abs(r),Math.PI/2,.001)||_q(Math.abs(r),3*Math.PI/2,.001)?_J(t,r,n):_$(r)?F3.postiveXAxis[n]:F3.negativeXAxis[n]}setItemAttributes(t,e,i,r,n){var l,s;if(!t)return;let{autoRotate:a=!0,refX:o=0,refY:h=0,refAngle:d=0,style:u,position:c=eO.middle}=e,{state:p}=this.attribute,g=(null==(l=this._line)?void 0:l.getEndAngle())||0,f=o*Math.cos(g)+h*Math.cos(g-Math.PI/2),m=o*Math.sin(g)+h*Math.sin(g-Math.PI/2);if("text"===n){let n=r.x-i.x,l=r.y-i.y;t.setAttributes(Object.assign(Object.assign({},u),{textStyle:Object.assign(Object.assign({},this.getTextAlignAttr(a,n,l,g,null!=(s=e.position)?s:"end")),u.textStyle),state:{panel:(0,h3.Z)({},g$,null==p?void 0:p.textBackground),text:(0,h3.Z)({},g$,null==p?void 0:p.itemContent)}}))}else("richText"===n||"image"===n)&&(t.setAttributes({dx:this.getItemDx(t,c,u)+(u.dx||0),dy:this.getItemDy(t,c,u)+(u.dy||0)}),t.states=(0,h3.Z)({},g$,null==p?void 0:p.itemContent));let y=_$(g)?g:g-Math.PI;t.setAttributes({x:r.x+(f||0),y:r.y+(m||0),angle:a&&y+d})}getItemDx(t,e,i){var r,n;let l=null!=(n=null==(r=null==t?void 0:t.AABBBounds)?void 0:r.width())?n:(null==i?void 0:i.width)||0;return e.includes("inside")?-l:0}getItemDy(t,e,i){var r,n;let l=null!=(n=null==(r=null==t?void 0:t.AABBBounds)?void 0:r.height())?n:(null==i?void 0:i.height)||0;return e.includes("top")||e.includes("Top")?-l:e.includes("middle")||e.includes("Middle")?-l/2:0}initItem(t,e,i){let r,{state:n}=this.attribute,{type:l="text",style:s,renderCustomCallback:a}=t;return"symbol"===l?(r=ak.symbol(Object.assign(Object.assign({},i),s))).states=(0,h3.Z)({},g$,null==n?void 0:n.itemContent):"text"===l?r=new Su(Object.assign(Object.assign({},i),{state:{panel:(0,h3.Z)({},g$,null==n?void 0:n.textBackground),text:(0,h3.Z)({},g$,null==n?void 0:n.itemContent)}})):"richText"===l?(r=ak.richtext(Object.assign(Object.assign({},i),s))).states=(0,h3.Z)({},g$,null==n?void 0:n.itemContent):"image"===l?(r=ak.image(Object.assign(Object.assign({},i),s))).states=(0,h3.Z)({},g$,null==n?void 0:n.itemContent):"custom"===l&&a&&((r=a()).states=(0,h3.Z)({},g$,null==n?void 0:n.itemContent)),r.name=`mark-point-${l}`,this.setItemAttributes(r,t,e,i,l),r}getItemLineAttr(t,e,i){let r=[],n={x:0,y:0},l=0,s=0,a=0,{type:o="type-s",arcRatio:h=.8}=t,d=i.x-e.x,u=i.y-e.y;if(this._isStraightLine=_q(d,0,.001)||_q(u,0,.001),this._isArcLine){let{x:t,y:e}=this.attribute.position,{x:r,y:o}=i,d=(t+r)/2,u=d+h*(o>e?-1:1)*d,c=(e===o?0:-(t-r)/(e-o))*(u-d)+(e+o)/2;s=O8(e-c,t-u),a=O8(o-c,r-u),n={x:u,y:c};let p=Math.sqrt((u-t)*(u-t)+(c-e)*(c-e)),g=this.attribute.targetSymbol.style.size/2;s+=2*Math.acos(Math.sqrt(1-g*g/(4*p*p))),h>0?a<s&&(a+=2*Math.PI):s<a&&(s+=2*Math.PI),l=Math.sqrt((u-t)*(u-t)+(c-e)*(c-e))}else r="type-do"!==o||this._isStraightLine?"type-po"!==o||this._isStraightLine?"type-op"!==o||this._isStraightLine?[e,i]:[e,{x:e.x,y:i.y},i]:[e,{x:i.x,y:e.y},i]:[e,{x:(e.x+i.x)/2,y:i.y},i];return{points:r=function(t){let e=[t[0]];for(let i=1;i<t.length;i++)t[i].x===t[i-1].x&&t[i].y===t[i-1].y||e.push(t[i]);return e}(r),center:n,radius:l,startAngle:s,endAngle:a}}reDrawLine(t,e){this._line.release();let{startSymbol:i,endSymbol:r,lineStyle:n,type:l="type-s"}=t,{state:s}=this.attribute,a=this._isArcLine?Od:So;this._container.removeChild(this._line),this._line=new a(Object.assign(Object.assign({},e),{pickable:!1,startSymbol:i,endSymbol:r,lineStyle:n,visible:t.visible,state:{line:(0,h3.Z)({},g$,null==s?void 0:s.line),startSymbol:(0,h3.Z)({},g$,null==s?void 0:s.lineStartSymbol),endSymbol:(0,h3.Z)({},g$,null==s?void 0:s.lineEndSymbol)}})),this._container.add(this._line)}setItemLineAttr(t,e,i){if(this._line){let{startSymbol:r,endSymbol:n,lineStyle:l,type:s="type-s"}=t,{state:a}=this.attribute,o=this.getItemLineAttr(t,e,i);this._isArcLine&&"arc-segment"===this._line.key||!this._isArcLine&&"segment"===this._line.key?this._line.setAttributes(Object.assign(Object.assign({},o),{startSymbol:r,endSymbol:n,lineStyle:l,visible:t.visible,state:{line:(0,h3.Z)({},g$,null==a?void 0:a.line),startSymbol:(0,h3.Z)({},g$,null==a?void 0:a.lineStartSymbol),endSymbol:(0,h3.Z)({},g$,null==a?void 0:a.lineEndSymbol)}})):this.reDrawLine(t,o)}}getDecorativeLineAttr(t){var e;let i=(null==(e=null==t?void 0:t.decorativeLine)?void 0:e.length)||10,r=this._line.getEndAngle()||0;return{startPointOffsetX:i/2*Math.cos(r-Math.PI/2),startPointOffsetY:i/2*Math.sin(r-Math.PI/2),endPointOffsetX:-i/2*Math.cos(r-Math.PI/2),endPointOffsetY:-i/2*Math.sin(r-Math.PI/2)}}setDecorativeLineAttr(t,e,i){var r;if(this._decorativeLine){let{lineStyle:n}=t,{startPointOffsetX:l,startPointOffsetY:s,endPointOffsetX:a,endPointOffsetY:o}=this.getDecorativeLineAttr(t);this._decorativeLine.setAttributes(Object.assign(Object.assign({points:[{x:e.x+l,y:e.y+s},{x:e.x+a,y:e.y+o}]},n),{visible:i})),this._decorativeLine.states=(0,h3.Z)({},g$,null==(r=this.attribute.state)?void 0:r.line)}}setTargetItemAttributes(t,e){var i,r;this._targetItem&&(this._targetItem.setAttributes(Object.assign({x:e.x,y:e.y,visible:null!=(i=t.visible)&&i,size:t.size},t.style)),this._targetItem.states=(0,h3.Z)({},g$,null==(r=this.attribute.state)?void 0:r.targetItem))}setAllOfItemsAttr(t,e){var i;let{position:r,itemLine:n={},itemContent:l={},limitRect:s,targetSymbol:a}=this.attribute,{type:o="text",confine:h}=l;if(s&&h){let{x:t,y:i,width:r,height:n}=s,{dx:l,dy:a}=FA(this._item,{x1:t,y1:i,x2:t+r,y2:i+n});e.x=e.x+l,e.y=e.y+a}this.setTargetItemAttributes(a,r),this.setItemLineAttr(n,t,e),this.setItemAttributes(this._item,l,t,e,o),this.setDecorativeLineAttr(n,e,null==(i=n.decorativeLine)?void 0:i.visible)}computeNewPositionAfterTargetItem(t){var e,i;let r,{itemContent:n={},targetSymbol:l,itemLine:s}=this.attribute,{offsetX:a=0,offsetY:o=0}=n,{offset:h=0,style:d,visible:u=!1,size:c}=l,p=u?null!=(i=null!=(e=d.size)?e:c)?i:20:0;return r="type-do"===s.type?O8(o,a/2):"type-po"===s.type?O8(0,a):"type-op"===s.type?O8(o,0):O8(o,a),{newPosition:{x:t.x+(p/2+h)*Math.cos(r),y:t.y+(p/2+h)*Math.sin(r)},newItemPosition:{x:t.x+(p/2+h)*Math.cos(r)+a,y:t.y+(p/2+h)*Math.sin(r)+o}}}initMarker(t){let{position:e,itemContent:i={},itemLine:r}=this.attribute,{type:n="type-s",arcRatio:l=.8}=r,{offsetX:s=0,offsetY:a=0}=i;this._isStraightLine=_q(s,0,.001)||_q(a,0,.001),this._isArcLine="type-arc"===n&&0!==l&&!this._isStraightLine;let{newPosition:o,newItemPosition:h}=this.computeNewPositionAfterTargetItem(e),d=new(this._isArcLine?Od:So)({points:[],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0});d.name="mark-point-line",this._line=d,t.add(d);let u=ak.line({points:[]});u.name="mark-point-decorativeLine",this._decorativeLine=u,t.add(u);let c=ak.symbol({});c.name="mark-point-targetItem",this._targetItem=c,t.add(this._targetItem);let p=this.initItem(i,o,h);this._item=p,t.add(p),this.setAllOfItemsAttr(o,h)}updateMarker(){let{position:t,itemContent:e={},itemLine:i}=this.attribute,{type:r="text"}=e,{type:n="type-s",arcRatio:l=.8}=i,{offsetX:s=0,offsetY:a=0}=e;this._isStraightLine=_q(s,0,.001)||_q(a,0,.001);let o="type-arc"===n&&0!==l&&!this._isStraightLine,{newPosition:h,newItemPosition:d}=this.computeNewPositionAfterTargetItem(t);o!==this._isArcLine?(this._isArcLine=o,this.reDrawLine(i,{points:[{x:0,y:0}],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0})):this._isArcLine=o,this.setItemAttributes(this._item,e,h,d,r),this.setAllOfItemsAttr(h,d)}isValidPoints(){let{position:t}=this.attribute;return!(!(0,hy.Z)(t.x)||!(0,hy.Z)(t.y))}}Ht.defaultAttributes={interactive:!0,targetSymbol:{visible:!1,offset:0,style:{symbolType:"circle",size:20,fill:!1,stroke:"rgba(46, 47, 50)"}},itemLine:{visible:!0,decorativeLine:{visible:!1,length:30},startSymbol:{visible:!0,clip:!0,symbolType:"circle",size:20,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},endSymbol:{visible:!1,clip:!0,symbolType:"triangle",size:12,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},lineStyle:{stroke:"#000",lineWidth:1}},itemContent:{type:"text",position:"middle",refX:10}};var He=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Hi extends Oe{constructor(){super(...arguments),this.specKey="markPoint",this.layoutZIndex=ts.MarkPoint}static _getMarkerCoordinateType(t){let{doPolarProcess:e,doGeoProcess:i}=Fp(t);return"polar"===t.coordinateType||e?"polar":"geo"===t.coordinateType||i?"geo":"cartesian"}_createMarkerComponent(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I;let{itemContent:E={},itemLine:L={},targetSymbol:F={}}=this._spec,{type:O="text",text:H,symbol:D,image:z,richText:W,customMark:Z,textStyle:N,symbolStyle:j,imageStyle:G,richTextStyle:V,customMarkStyle:U,style:K={},state:X={}}=E,Y=He(E,["type","text","symbol","image","richText","customMark","textStyle","symbolStyle","imageStyle","richTextStyle","customMarkStyle","style","state"]),$=null,q=null,J={};"text"===O?($=null!=(t=null==H?void 0:H.state)?t:X,J={dx:0,dy:0},q=Fl(Object.assign(Object.assign({},H),{style:(0,h3.Z)(J,null!=(i=null!=(e=null==H?void 0:H.textStyle)?e:N)?i:K)}),this._markerData,this._markAttributeContext)):"richText"===O?($=null!=(r=null==W?void 0:W.state)?r:X,J={width:100,height:100},q=Fa((0,h3.Z)(J,null!=(l=null!=(n=null==W?void 0:W.style)?n:V)?l:K),this._markerData,this._markAttributeContext)):"symbol"===O?($=null!=(s=null==D?void 0:D.state)?s:X,J={symbolType:"star",fill:"rgb(48, 115, 242)",fillOpacity:.8,size:20},q=xg(Fa((0,h3.Z)(J,null!=(o=null!=(a=null==D?void 0:D.style)?a:j)?o:K),this._markerData,this._markAttributeContext))):"image"===O?($=null!=(h=null==z?void 0:z.state)?h:X,J={width:80,height:80},q=Fa((0,h3.Z)(J,null!=(u=null!=(d=null==z?void 0:z.style)?d:G)?u:K),this._markerData,this._markAttributeContext)):"custom"===O&&($=null!=(c=null==Z?void 0:Z.state)?c:X,q=Fa(null!=(g=null!=(p=null==Z?void 0:Z.style)?p:U)?g:K,this._markerData,this._markAttributeContext));let Q={zIndex:this.layoutZIndex,interactive:null==(f=this._spec.interactive)||f,hover:null==(m=this._spec.interactive)||m,select:null==(y=this._spec.interactive)||y,position:{x:0,y:0},clipInRange:null!=(v=this._spec.clip)&&v,itemContent:Object.assign(Object.assign({type:O,offsetX:Fo(E.offsetX,this._relativeSeries.getRegion()),offsetY:Fo(E.offsetX,this._relativeSeries.getRegion())},Y),{style:Fa(q,this._markerData,this._markAttributeContext)}),targetSymbol:{offset:null!=(b=F.offset)?b:0,visible:null!=(_=F.visible)&&_,size:null!=(C=F.size)?C:20,style:Fa(F.style,this._markerData,this._markAttributeContext)},state:{line:Fs(null!=(w=null==(x=this._spec.itemLine.line)?void 0:x.state)?w:{},this._markerData,this._markAttributeContext),lineStartSymbol:Fs(null!=(A=null==(S=this._spec.itemLine.startSymbol)?void 0:S.state)?A:{},this._markerData,this._markAttributeContext),lineEndSymbol:Fs(null!=(T=null==(M=this._spec.itemLine.endSymbol)?void 0:M.state)?T:{},this._markerData,this._markAttributeContext),itemContent:Fs($,this._markerData,this._markAttributeContext),textBackground:Fs(null==(R=null==(k=this._spec.itemContent.text)?void 0:k.labelBackground)?void 0:R.state,this._markerData,this._markAttributeContext),targetItem:Fs(null!=(B=null==(P=this._spec.targetSymbol)?void 0:P.state)?B:{},this._markerData,this._markAttributeContext)},animation:null!=(I=this._spec.animation)&&I,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate},{visible:te,line:ti={}}=L,tr=He(L,["visible","line"]);return Q.itemLine=!1!==te?Object.assign(Object.assign({},tr),{visible:!0,lineStyle:xg(ti.style)}):{visible:!1},new Ht(Q)}_markerLayout(){var t,e,i,r,n;let l,s=this._spec,a=this._markerData,o=this._relativeSeries,{point:h}=this._computePointsAttr(),d=this._getRelativeDataView().latestData,u=a?a.latestData[0]&&a.latestData[0].latestData?a.latestData[0].latestData:a.latestData:d;if(s.clip||(null==(t=s.itemContent)?void 0:t.confine)){let{minX:t,maxX:e,minY:i,maxY:r}=Fn([o.getRegion()]);l={x:t,y:i,width:e-t,height:r-i}}if(this._markerComponent){let t=null!=(e=this._markerComponent.attribute)?e:{},s=null!=(r=null==(i=t.itemContent)?void 0:i.textStyle)?r:{};this._markerComponent.setAttributes({position:void 0===h?{x:null,y:null}:h,itemContent:Object.assign(Object.assign({},t.itemContent),{textStyle:Object.assign(Object.assign({},s),{text:(null==(n=this._spec.itemContent.text)?void 0:n.formatMethod)?this._spec.itemContent.text.formatMethod(u,d):s.text}),offsetX:Fh(h,t.itemContent.offsetX,this._relativeSeries.getRegion()),offsetY:Fh(h,t.itemContent.offsetY,this._relativeSeries.getRegion())}),limitRect:l,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}}_initDataView(){let t=this._spec,{doXYProcess:e,doPolarProcess:i,doGeoProcess:r}=Fp(t);((0,aw.Z)(t.coordinate)||e||i||r)&&this._initCommonDataView()}}Hi.specKey="markPoint";let Hr={itemLine:{decorativeLine:{visible:!1},startSymbol:{size:5,visible:!0,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},line:{style:{stroke:{type:"palette",key:"markLineStrokeColor"}}}},itemContent:{offsetY:-50}};class Hn extends Hi{constructor(){super(...arguments),this.type=oQ.markPoint,this.name=oQ.markPoint,this.coordinateType="cartesian"}_computePointsAttr(){var t,e,i;let r,n=this._spec,l=this._markerData,s=this._relativeSeries,a=(0,aw.Z)(n.x)&&(0,aw.Z)(n.y),o=(0,aw.Z)(n.coordinate),h=(0,aw.Z)(n.position),d=null!=(t=null==n?void 0:n.autoRange)&&t;return a?r=null==(i=null==(e=L7(l,s,s,s,d))?void 0:e[0])?void 0:i[0]:o?r=Ft(l,s,d,n.coordinatesOffset)[0]:h&&(r=Fr(n.position,s,n.regionRelative)[0]),{point:r}}_computeOptions(){let t,e=this._spec,{doXYProcess:i}=Fp(e),r=(0,aw.Z)(e.coordinate);return i?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}])]:r&&(t=this._processSpecCoo(e)),{options:t}}}Hn.type=oQ.markPoint,Hn.coordinateType="cartesian",Hn.builtInTheme={markPoint:Hr};let Hl=()=>{h9.registerComponent(Hn.type,Hn),O9()};class Hs extends Hi{constructor(){super(...arguments),this.type=oQ.polarMarkPoint,this.name=oQ.polarMarkPoint,this.coordinateType="polar"}_computePointsAttr(){var t,e;let i=this._markerData,r=this._relativeSeries,n=L9(i,r,r,r,null!=(e=null==(t=this._spec)?void 0:t.autoRange)&&e)[0][0],l={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};return{point:(0,iH.op)(l,n.radius,n.angle)}}_computeOptions(){let t=this._spec;return{options:[this._processSpecByDims([{dim:"radius",specValue:t.radius},{dim:"angle",specValue:t.angle}])]}}}Hs.type=oQ.polarMarkPoint,Hs.coordinateType="polar",Hs.builtInTheme={polarMarkPoint:Hr};let Ha=()=>{h9.registerComponent(Hs.type,Hs),O9()};class Ho extends Hi{constructor(){super(...arguments),this.type=oQ.geoMarkPoint,this.name=oQ.geoMarkPoint,this.coordinateType="geo"}_computePointsAttr(){return{point:function(t,e){let i=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach(t=>{(0,aw.Z)(t.areaName)&&i.push([{x:e.nameValueToPosition(t.areaName).x+e.getRegion().getLayoutStartPoint().x,y:e.nameValueToPosition(t.areaName).y+e.getRegion().getLayoutStartPoint().y}])}),i}(this._markerData,this._relativeSeries)[0][0]}}_computeOptions(){let t=this._spec;return{options:[this._processSpecByDims([{dim:"areaName",specValue:t.areaName}])]}}}Ho.type=oQ.geoMarkPoint,Ho.coordinateType="geo",Ho.builtInTheme={geoMarkPoint:Hr};let Hh=()=>{h9.registerComponent(Ho.type,Ho),O9()};(ec=eZ||(eZ={})).drawStart="drawStart",ec.drawEnd="drawEnd",ec.drawing="drawing",ec.moving="moving",ec.moveStart="moveStart",ec.moveEnd="moveEnd",ec.brushActive="brushActive",ec.brushClear="brushClear";let Hd={trigger:"pointerdown",updateTrigger:"pointermove",endTrigger:["pointerup","pointerleave"],resetTrigger:"pointerupoutside",hasMask:!0,brushMode:"single",brushType:"rect",brushStyle:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",strokeWidth:2},brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:10,interactiveRange:{minY:-1/0,maxY:1/0,minX:-1/0,maxX:1/0}},Hu={debounce:dS.Z,throttle:dw.Z};uD(),w3();class Hc extends CB{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},Hc.defaultAttributes,t)),this.name="brush",this._activeBrushState=!1,this._activeDrawState=!1,this._cacheDrawPoints=[],this._activeMoveState=!1,this._operatingMaskMoveDx=0,this._operatingMaskMoveDy=0,this._operatingMaskMoveRangeX=[-1/0,1/0],this._operatingMaskMoveRangeY=[-1/0,1/0],this._brushMaskAABBBoundsDict={},this._firstUpdate=!0,this._onBrushStart=t=>{if(!1===this.attribute.interactive||!1===this._beforeBrushEvent(t))return;let{updateTrigger:e=Hd.updateTrigger,endTrigger:i=Hd.endTrigger,brushMoved:r=!0}=this.attribute;(0,a1.IX)(e).forEach(t=>this.stage.addEventListener(t,this._onBrushingWithDelay)),(0,a1.IX)(i).forEach(t=>this.stage.addEventListener(t,this._onBrushEnd)),t.stopPropagation(),this._firstUpdate=!0,this._activeMoveState=r&&this._isPosInBrushMask(t),this._activeDrawState=!this._activeMoveState,this._startPos=this.eventPosToStagePos(t),this._cacheDrawPoints=[this._startPos]},this._onBrushing=t=>{!1!==this.attribute.interactive&&!1!==this._beforeBrushEvent(t)&&(this._outOfInteractiveRange(t)||(t.stopPropagation(),this._firstUpdate?(this._activeDrawState&&this._initDraw(t),this._activeMoveState&&this._initMove(t),this._firstUpdate=!1):(this._activeDrawState&&this._drawing(t),this._activeMoveState&&this._moving(t))))},this._onBrushingWithDelay=0===this.attribute.delayTime?this._onBrushing:Hu[this.attribute.delayType](this._onBrushing,this.attribute.delayTime),this._onBrushEnd=t=>{!1!==this.attribute.interactive&&(this._releaseBrushUpdateEvents(),t.preventDefault(),this._activeDrawState&&this._drawEnd(t),this._activeMoveState&&this._moveEnd(t),this._activeDrawState=!1,this._activeMoveState=!1)},this._onBrushClear=t=>{!1!==this.attribute.interactive&&!1!==this._beforeBrushEvent(t)&&(t.preventDefault(),this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(eZ.brushClear,t)),this._activeDrawState=!1,this._activeMoveState=!1)}}_bindBrushEvents(){if(this.releaseBrushEvents(),this.attribute.disableTriggerEvent)return;let{trigger:t=Hd.trigger,resetTrigger:e=Hd.resetTrigger}=this.attribute;(0,a1.IX)(t).forEach(t=>this.stage.addEventListener(t,this._onBrushStart)),(0,a1.IX)(e).forEach(t=>this.stage.addEventListener(t,this._onBrushClear))}_initDraw(t){if(!1===this.attribute.interactive)return;let{brushMode:e}=this.attribute,i=this.eventPosToStagePos(t);this._cacheDrawPoints.push(i),"single"===e&&this._clearMask(),this._addBrushMask(),this._dispatchBrushEvent(eZ.drawStart,t),this._activeBrushState=!1}_initMove(t){var e,i;if(!1===this.attribute.interactive)return;this._cacheMovePoint=this.eventPosToStagePos(t),this._operatingMaskMoveDx=null!=(e=this._operatingMask.attribute.dx)?e:0,this._operatingMaskMoveDy=null!=(i=this._operatingMask.attribute.dy)?i:0;let{interactiveRange:r}=this.attribute,{minY:n=-1/0,maxY:l=1/0,minX:s=-1/0,maxX:a=1/0}=r,{x1:o,x2:h,y1:d,y2:u}=this._operatingMask.globalAABBBounds;this._operatingMaskMoveRangeX=[s-o,a-h],this._operatingMaskMoveRangeY=[n-d,l-u],this._operatingMask.setAttribute("pickable",!0),this._dispatchBrushEvent(eZ.moveStart,t)}_drawing(t){var e;if(!1===this.attribute.interactive)return;let i=this.eventPosToStagePos(t),{brushType:r,sizeThreshold:n=5}=this.attribute,l=this._cacheDrawPoints.length;if(l>0){let t=null!=(e=this._cacheDrawPoints[this._cacheDrawPoints.length-1])?e:{};if(i.x===t.x&&i.y===t.y)return}"polygon"===r||l<=1?this._cacheDrawPoints.push(i):this._cacheDrawPoints[l-1]=i;let s=this._computeMaskPoints();this._operatingMask.setAttribute("points",s);let{x:a,y:o}=this._startPos,{x:h,y:d}=this.eventPosToStagePos(t);(Math.abs(h-a)>n||Math.abs(o-d)>n)&&(1!==Object.keys(this._brushMaskAABBBoundsDict).length||this._activeBrushState?this._dispatchBrushEvent(eZ.drawing,t):(this._activeBrushState=!0,this._dispatchBrushEvent(eZ.brushActive,t)))}_moving(t){if(!1===this.attribute.interactive)return;let e=this._cacheMovePoint,i=this.eventPosToStagePos(t);if(i.x===(null==e?void 0:e.x)&&i.y===(null==e?void 0:e.y))return;let r=i.x-e.x,n=i.y-e.y,l=Math.min(this._operatingMaskMoveRangeX[1],Math.max(this._operatingMaskMoveRangeX[0],r))+this._operatingMaskMoveDx,s=Math.min(this._operatingMaskMoveRangeY[1],Math.max(this._operatingMaskMoveRangeY[0],n))+this._operatingMaskMoveDy;this._operatingMask.setAttributes({dx:l,dy:s}),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(eZ.moving,t)}_drawEnd(t){if(!1===this.attribute.interactive)return;let{removeOnClick:e=!0,sizeThreshold:i=5}=this.attribute;if(this._outOfInteractiveRange(t))this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(eZ.brushClear,t));else{let{x:r,y:n}=this._startPos,{x:l,y:s}=this.eventPosToStagePos(t);1>=Math.abs(l-r)&&1>=Math.abs(s-n)&&e?this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(eZ.brushClear,t)):Math.abs(l-r)<i&&Math.abs(n-s)<i?(delete this._brushMaskAABBBoundsDict[this._operatingMask.name],this._container.setAttributes({}),this._container.removeChild(this._operatingMask),this._isEmptyMask()&&this._dispatchBrushEvent(eZ.brushClear,t)):(this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(eZ.drawEnd,t))}}_moveEnd(t){!1!==this.attribute.interactive&&(this._operatingMask&&this._operatingMask.setAttribute("pickable",!1),this._dispatchBrushEvent(eZ.moveEnd,t))}render(){this._bindBrushEvents();let t=this.createOrUpdateChild("brush-container",{},"group");this._container=t}releaseBrushEvents(){let{trigger:t=Hd.trigger,resetTrigger:e=Hd.resetTrigger}=this.attribute;(0,a1.IX)(t).forEach(t=>this.stage.removeEventListener(t,this._onBrushStart)),(0,a1.IX)(e).forEach(t=>this.stage.removeEventListener(t,this._onBrushClear)),this._releaseBrushUpdateEvents()}_releaseBrushUpdateEvents(){let{updateTrigger:t=Hd.updateTrigger,endTrigger:e=Hd.endTrigger}=this.attribute;(0,a1.IX)(t).forEach(t=>this.stage.removeEventListener(t,this._onBrushingWithDelay)),(0,a1.IX)(e).forEach(t=>this.stage.removeEventListener(t,this._onBrushEnd))}_computeMaskPoints(){let{brushType:t,xRange:e=[0,0],yRange:i=[0,0]}=this.attribute,r=this._cacheDrawPoints[0],n=this._cacheDrawPoints[this._cacheDrawPoints.length-1];return"rect"===t?[r,{x:n.x,y:r.y},n,{x:r.x,y:n.y}]:"x"===t?[{x:r.x,y:i[0]},{x:n.x,y:i[0]},{x:n.x,y:i[1]},{x:r.x,y:i[1]}]:"y"===t?[{x:e[0],y:r.y},{x:e[0],y:n.y},{x:e[1],y:n.y},{x:e[1],y:r.y}]:(0,dz.Z)(this._cacheDrawPoints)}_addBrushMask(){var t;let{brushStyle:e,hasMask:i}=this.attribute,r=ak.polygon(Object.assign(Object.assign({points:(0,dz.Z)(this._cacheDrawPoints),cursor:"move",pickable:!1},e),{opacity:i?null!=(t=e.opacity)?t:1:0}));r.name=`brush-${Date.now()}`,this._operatingMask=r,this._container.add(r),this._brushMaskAABBBoundsDict[r.name]=r.AABBBounds}_isPosInBrushMask(t){let e=this.eventPosToStagePos(t),i=this._container.getChildren();for(let t=0;t<i.length;t++){let{points:r=[],dx:n=0,dy:l=0}=i[t].attribute,s=r.map(t=>({x:t.x+n,y:t.y+l}));if((0,r2.O0)(s,e.x,e.y))return this._operatingMask=i[t],!0}return!1}_outOfInteractiveRange(t){let{interactiveRange:e}=this.attribute,{minY:i=-1/0,maxY:r=1/0,minX:n=-1/0,maxX:l=1/0}=e,s=this.eventPosToStagePos(t);return s.x>l||s.x<n||s.y>r||s.y<i}_beforeBrushEvent(t){var e,i;return null==(i=(e=this.attribute).beforeBrushChange)?void 0:i.call(e,t)}_dispatchBrushEvent(t,e){this._dispatchEvent(t,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e})}_clearMask(){this._brushMaskAABBBoundsDict={},this._container.removeAllChild(),this._operatingMask=null}_isEmptyMask(){return(0,uF.Z)(this._brushMaskAABBBoundsDict)||Object.keys(this._brushMaskAABBBoundsDict).every(t=>this._brushMaskAABBBoundsDict[t].empty())}}Hc.defaultAttributes=Hd;class Hp extends xZ{constructor(){super(...arguments),this.layoutType="none",this.type=oQ.brush,this.name=oQ.brush,this.specKey="brush",this.layoutZIndex=ts.Brush,this._linkedSeries=[],this._itemMap={},this._linkedItemMap={},this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._cacheInteractiveRangeAttrs=[],this._releatedAxes=[],this._regionAxisMap={},this._axisDataZoomMap={},this._zoomRecord=[]}static getSpecInfo(t){return bW(t,this.specKey,this.type,t=>!1!==t.visible)}init(){let t=this._transformBrushedMarkAttr(this._spec.inBrush),e=this._transformBrushedMarkAttr(this._spec.outOfBrush);this._option.getAllSeries().forEach(i=>{i.getActiveMarks().forEach(r=>{r&&(i.setMarkStyle(r,Object.assign({},t),"inBrush",to.Series),i.setMarkStyle(r,Object.assign({},e),"outOfBrush",to.Series))})})}_initNeedOperatedItem(){let t=this._spec.seriesId,e=this._spec.seriesIndex;this._relativeRegions.forEach(i=>{let r=[];i.getSeries().forEach(n=>{(t&&(0,a1.IX)(t).includes(n.userId.toString())||e&&(0,a1.IX)(e).includes(n.getSpecIndex())||!e&&!t)&&r.push(...n.getMarksWithoutRoot()),this._itemMap[i.id]=r})}),this._linkedSeries.forEach(t=>{this._linkedItemMap[t.id]=t.getMarksWithoutRoot()})}created(){super.created(),this.initEvent(),this._bindRegions(),this._bindLinkedSeries(),this._initRegionAxisMap(),this._initAxisDataZoomMap(),this._initNeedOperatedItem()}_bindRegions(){(0,aw.Z)(this._spec.regionId)||(0,aw.Z)(this._spec.regionIndex)?this._relativeRegions=this._option.getRegionsInUserIdOrIndex((0,a1.IX)(this._spec.regionId),(0,a1.IX)(this._spec.regionIndex)):this._relativeRegions=this._option.getAllRegions()}_bindLinkedSeries(){((0,aw.Z)(this._spec.brushLinkSeriesId)||(0,aw.Z)(this._spec.brushLinkSeriesIndex))&&(this._linkedSeries=this._option.getSeriesInUserIdOrIndex((0,a1.IX)(this._spec.brushLinkSeriesId),(0,a1.IX)(this._spec.brushLinkSeriesIndex)))}_initRegionAxisMap(){(0,aw.Z)(this._spec.axisId)?(0,a1.IX)(this._spec.axisId).forEach(t=>{this._releatedAxes.push(this._option.getComponentByUserId(t))}):(0,aw.Z)(this._spec.axisIndex)?(0,a1.IX)(this._spec.axisIndex).forEach(t=>{this._releatedAxes.push(this._option.getComponentByIndex("axes",t))}):this._releatedAxes=this._option.getComponentsByKey("axes"),this._releatedAxes.forEach(t=>{null==t||t.getRegions().forEach(e=>{this._regionAxisMap["region_"+e.id]?this._regionAxisMap["region_"+e.id].push(t):this._regionAxisMap["region_"+e.id]=[t]})})}_initAxisDataZoomMap(){this._option.getComponentsByKey("dataZoom").forEach(t=>{t.relatedAxisComponent&&(this._axisDataZoomMap[t.relatedAxisComponent.id]=t)})}initEvent(){}_compareSpec(t,e){this._brushComponents&&this._relativeRegions.forEach((t,e)=>{this._updateBrushComponent(t,e)});let i=super._compareSpec(t,e);return(0,uL.X)(e,t)||(i.reRender=!0,i.reMake=!0),i}onLayoutEnd(){var t;super.onLayoutEnd(),!this._option.disableTriggerEvent&&(null==(t=this._spec.visible)||t)&&(this._brushComponents?this._relativeRegions.forEach((t,e)=>{this._updateBrushComponent(t,e)}):(this._brushComponents=[],this._relativeRegions.forEach((t,e)=>{this._createBrushComponent(t,e)})))}_updateBrushComponent(t,e){let i=this._getBrushInteractiveAttr(t),r=this._brushComponents[e];r.setAttributes(i),this._initMarkBrushState(e,""),r.children[0].removeAllChild()}_shouldEnableInteractive(){return!1!==this.getOption().getCompiler().getOption().interactive}_createBrushComponent(t,e){var i,r;let n=this._getBrushInteractiveAttr(t),l=new Hc(Object.assign(Object.assign(Object.assign({zIndex:this.layoutZIndex,brushStyle:xg(null==(i=this._spec)?void 0:i.style)},n),this._spec),{disableTriggerEvent:this._option.disableTriggerEvent}));l.id=null!=(r=this._spec.id)?r:`brush-${this.id}`,this.getContainer().add(l),this._brushComponents.push(l),this._cacheInteractiveRangeAttrs.push(n),l.addEventListener(eZ.brushActive,i=>{this._initMarkBrushState(e,"outOfBrush"),this._emitEvent(J.brushActive,t,i)}),l.addEventListener(eZ.drawStart,e=>{this._spec.disableDimensionHoverWhenBrushing&&this._option.globalInstance.disableDimensionHoverEvent(!0),this._setRegionMarkPickable(t,!0),this._emitEvent(J.brushStart,t,e)}),l.addEventListener(eZ.moveStart,e=>{this._spec.disableDimensionHoverWhenBrushing&&this._option.globalInstance.disableDimensionHoverEvent(!0),this._setRegionMarkPickable(t,!0),this._emitEvent(J.brushStart,t,e)}),l.addEventListener(eZ.drawing,e=>{this._setRegionMarkPickable(t,!1),this._handleBrushChange(t,e),this._emitEvent(J.brushChange,t,e)}),l.addEventListener(eZ.moving,e=>{this._setRegionMarkPickable(t,!1),this._handleBrushChange(t,e),this._emitEvent(J.brushChange,t,e)}),l.addEventListener(eZ.brushClear,i=>{this._spec.disableDimensionHoverWhenBrushing&&this._option.globalInstance.disableDimensionHoverEvent(!1),this._setRegionMarkPickable(t,!0),this._initMarkBrushState(e,""),this._emitEvent(J.brushClear,t,i)}),l.addEventListener(eZ.drawEnd,i=>{var r;this._spec.disableDimensionHoverWhenBrushing&&this._option.globalInstance.disableDimensionHoverEvent(!1),this._setRegionMarkPickable(t,!0);let{operateMask:n}=i.detail,{updateElementsState:l=!0}=this._spec;if(null==(r=this._spec)?void 0:r.onBrushEnd)!0===this._spec.onBrushEnd(i)?(this.clearGraphic(),this._initMarkBrushState(e,""),this._emitEvent(J.brushClear,t,i)):(this._spec.onBrushEnd(i),this._emitEvent(J.brushEnd,t,i));else{let e=this._extendDataInBrush(this._inBrushElementsMap);(this._spec.zoomWhenEmpty||!(e.length>0))&&l||this._setAxisAndDataZoom(n,t),this._emitEvent(J.brushEnd,t,i)}}),l.addEventListener(eZ.moveEnd,e=>{this._spec.disableDimensionHoverWhenBrushing&&this._option.globalInstance.disableDimensionHoverEvent(!1),this._setRegionMarkPickable(t,!0);let{operateMask:i}=e.detail,{updateElementsState:r=!0}=this._spec,n=this._extendDataInBrush(this._inBrushElementsMap);(!this._spec.zoomWhenEmpty&&n.length>0||r)&&this._setAxisAndDataZoom(i,t),this._emitEvent(J.brushEnd,t,e)})}_getBrushInteractiveAttr(t){let e=t.getLayoutStartPoint(),i=t.getLayoutRect(),r=e.x,n=r+i.width,l=e.y,s=l+i.height;return{interactiveRange:{minY:l,maxY:s,minX:r,maxX:n},xRange:[r,n],yRange:[l,s],interactive:this._shouldEnableInteractive()}}_transformBrushedMarkAttr(t){let e={};return(null==t?void 0:t.symbol)&&(e.symbolType=t.symbol),(null==t?void 0:t.symbolSize)&&(e.size=t.symbolSize),(null==t?void 0:t.color)&&(e.fill=t.color),(null==t?void 0:t.colorAlpha)&&(e.fillOpacity=t.colorAlpha),Object.assign(Object.assign({},xg(t)),e)}_handleBrushChange(t,e){let{operateMask:i}=e.detail;this._operateMask=i;let{updateElementsState:r=!0}=this._spec;r&&(this._reconfigItem(i,t),this._reconfigLinkedItem(i,t))}_extendDataInBrush(t){var e,i;let r=[];for(let n in t)for(let l in t[n])r.push(Object.assign({},null==(i=null==(e=t[n][l].context)?void 0:e.data)?void 0:i[0]));return r}_extendDatumOutOfBrush(t){var e,i;let r=[];for(let n in t)r.push(null==(i=null==(e=t[n].context)?void 0:e.data)?void 0:i[0]);return r}_emitEvent(t,e,i){var r;this.event.emit(t,{model:this,value:{operateType:t,operateRegion:e,inBrushData:this._extendDataInBrush(this._inBrushElementsMap),outOfBrushData:this._extendDatumOutOfBrush(this._outOfBrushElementsMap),linkInBrushData:this._extendDataInBrush(this._linkedInBrushElementsMap),linkOutOfBrushData:this._extendDatumOutOfBrush(this._linkedOutOfBrushElementsMap),inBrushElementsMap:this._inBrushElementsMap,outOfBrushElementsMap:this._outOfBrushElementsMap,linkedInBrushElementsMap:this._linkedInBrushElementsMap,linkedOutOfBrushElementsMap:this._linkedOutOfBrushElementsMap,zoomRecord:this._zoomRecord},vchart:null==(r=this._option)?void 0:r.globalInstance,event:i})}_reconfigItem(t,e){var i,r,n;if(!(null==t?void 0:t.globalTransMatrix)||!(null==(i=null==t?void 0:t.attribute)?void 0:i.points))return;let l=null!=(n=null==(r=null==t?void 0:t.attribute)?void 0:r.points)?n:[],{a:s,b:a,c:o,d:h,e:d,f:u}=t.globalTransMatrix,c=l.map(t=>({x:s*t.x+o*t.y+d,y:a*t.x+h*t.y+u})),{markTypeFilter:p=[]}=this._spec;this._itemMap[e.id].forEach(e=>{if(p.includes(e.type))return;let i=e.getGraphics();i&&i.length&&i.forEach(i=>{var r,n,l;let s=e.id+"_"+i.context.key,a=this._isBrushContainItem(t.globalAABBBounds,c,i);(null==(r=this._outOfBrushElementsMap)?void 0:r[s])&&a?(i.addState("inBrush",!0),this._inBrushElementsMap[null==t?void 0:t.name]||(this._inBrushElementsMap[null==t?void 0:t.name]={}),this._inBrushElementsMap[null==t?void 0:t.name][s]=i,delete this._outOfBrushElementsMap[s]):(null==(l=null==(n=this._inBrushElementsMap)?void 0:n[null==t?void 0:t.name])?void 0:l[s])&&!a&&(i.removeState("inBrush"),i.addState("outOfBrush",!0),this._outOfBrushElementsMap[s]=i,delete this._inBrushElementsMap[t.name][s])})})}_reconfigLinkedItem(t,e){var i;if(!(null==t?void 0:t.globalTransMatrix)||!(null==(i=null==t?void 0:t.attribute)?void 0:i.points))return;let r=e.getLayoutStartPoint(),n=e.getSeries().map(t=>t.id);this._linkedSeries.forEach(e=>{var i,l;if(!n.includes(e.id)){let n=e.getRegion().getLayoutStartPoint(),s=n.x-r.x,a=n.y-r.y,o=null!=(l=null==(i=null==t?void 0:t.attribute)?void 0:i.points)?l:[],{a:h,b:d,c:u,d:c,e:p,f:g}=t.globalTransMatrix,f=s||0,m=a||0,y=o.map(t=>({x:h*t.x+u*t.y+p+f,y:d*t.x+c*t.y+g+m}));t.globalAABBBounds.clone().set(t.globalAABBBounds.x1+f,t.globalAABBBounds.y1+m,t.globalAABBBounds.x2+f,t.globalAABBBounds.y2+m);let{markTypeFilter:v=[]}=this._spec;this._linkedItemMap[e.id].forEach(e=>{if(v.includes(e.type))return;let i=e.getGraphics();i&&i.length&&i.forEach(i=>{var r,n,l;let{key:s}=i.context,a=e.id+"_"+i.context.key;(null==(r=this._linkedOutOfBrushElementsMap)?void 0:r[a])&&this._isBrushContainItem(t.globalAABBBounds,y,i)?(i.addState("inBrush",!0),this._linkedInBrushElementsMap[null==t?void 0:t.name]||(this._linkedInBrushElementsMap[null==t?void 0:t.name]={}),this._linkedInBrushElementsMap[null==t?void 0:t.name][a]=i,delete this._linkedOutOfBrushElementsMap[a]):(null==(l=null==(n=this._linkedInBrushElementsMap)?void 0:n[null==t?void 0:t.name])?void 0:l[a])&&!this._isBrushContainItem(t.globalAABBBounds,y,i)&&(i.removeState("inBrush"),i.addState("outOfBrush",!0),this._linkedOutOfBrushElementsMap[a]=i)})})}})}_isBrushContainItem(t,e,i){let r=[];if(["symbol","rect"].includes(i.type)){let{x1:t,x2:n,y1:l,y2:s}=null==i?void 0:i.globalAABBBounds;return r=[{x:t,y:l},{x:n,y:l},{x:n,y:s},{x:t,y:s}],(0,r2.iO)(e,r)}return t.intersects(i.globalAABBBounds)}_initItemMap(t,e,i){let{markTypeFilter:r=[]}=this._spec;Object.entries(t).forEach(([t,n])=>{n.forEach(t=>{if(r.includes(t.type))return;let n=t.getGraphics();n&&n.length&&n.forEach(r=>{let n=t.id+"_"+r.context.key;r.removeState("inBrush"),r.removeState("outOfBrush"),i&&r.addState(i,!0),e[n]=r})})})}_initMarkBrushState(t,e){this._brushComponents.forEach((e,i)=>{i!==t&&e.children[0].removeAllChild()}),this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._initItemMap(this._itemMap,this._outOfBrushElementsMap,e),this._initItemMap(this._linkedItemMap,this._linkedOutOfBrushElementsMap,e)}_setRegionMarkPickable(t,e){t.getGroupMark().getGraphics().forEach(t=>t.setAttribute("childrenPickable",e))}_stateClamp(t){return Math.min(Math.max(0,t),1)}_setAxisAndDataZoom(t,e){var i;if(this._zoomRecord=[],this._spec.zoomAfterBrush){let r=t.AABBBounds;null==(i=this._regionAxisMap["region_"+e.id])||i.forEach(t=>{var i,n;let l="bottom"===t.layoutOrient||"top"===t.layoutOrient,s=null!=(i=this._spec.axisRangeExpand)?i:0,{x1:a,x2:o,y1:h,y2:d}=r,u=l?"x":"y",c=l?"width":"height",p=l?a:h,g=l?o:d;if(this._axisDataZoomMap[t.id]){let i=this._axisDataZoomMap[t.id],r=(p-e.getLayoutStartPoint()[u])/e.getLayoutRect()[c],n=(g-e.getLayoutStartPoint()[u])/e.getLayoutRect()[c],l=this._stateClamp(r-s),a=this._stateClamp(n+s);i.setStartAndEnd(Math.min(l,a),Math.max(l,a),["percent","percent"]),this._zoomRecord.push({operateComponent:i,start:l,end:a,startValue:Lv(l,i.stateScale,L_(i.relatedAxisComponent,i.isHorizontal)),endValue:Lv(a,i.stateScale,L_(i.relatedAxisComponent,i.isHorizontal))})}else{let i=t.getScale().range(),r=null!=(n=t.scaleRangeFactor())?n:[0,1],l=(0,a1.Z$)(i)<i[0],a=p-e.getLayoutStartPoint()[u],o=g-e.getLayoutStartPoint()[u],h=l?Math.min(a,o):Math.max(a,o),d=l?Math.max(a,o):Math.min(a,o),c=(d-i[0])/((0,a1.Z$)(i)-i[0])*(r[1]-r[0])+r[0],f=(h-i[0])/((0,a1.Z$)(i)-i[0])*(r[1]-r[0])+r[0],m=this._stateClamp(c-s),y=this._stateClamp(f+s);t.scaleRangeFactor([m,y]),t.effect.scaleUpdate(),this._zoomRecord.push({operateComponent:t,start:m,end:y,startValue:t.getScale().invert(d),endValue:t.getScale().invert(h)})}})}}_getNeedClearVRenderComponents(){return this._brushComponents}clearGraphic(){this._brushComponents&&this._brushComponents.forEach(t=>{t._container.incrementalClearChild()})}clear(){if(this._brushComponents){let t=this.getContainer();this._brushComponents.forEach((e,i)=>{this._initMarkBrushState(i,""),e.removeAllChild(),e.releaseBrushEvents(),t&&t.removeChild(e)}),this._brushComponents=null}}clearBrushStateAndMask(){this._relativeRegions.forEach((t,e)=>{this._initMarkBrushState(e,""),this._brushComponents[e].children[0].removeAllChild()})}}Hp.type=oQ.brush,Hp.builtInTheme={brush:{style:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",lineWidth:2},brushMode:"single",brushType:"rect",brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:0}},Hp.specKey="brush";let Hg=()=>{h9.registerComponent(Hp.type,Hp)};class Hf extends xZ{constructor(){super(...arguments),this.type=oQ.customMark,this.specKey="customMark",this.layoutType="none",this.layoutZIndex=ts.CustomMark,this.layoutLevel=ta.CustomMark}created(){super.created(),this.initMarks(),this.initEvent()}getMarkAttributeContext(){return this._markAttributeContext}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(t,e)=>{var i;return null==(i=this._option.globalScale.getScale(t))?void 0:i.scale(e)}}}initMarks(){if(!this._spec)return;let t=null;if(this._spec.parent){let e=this.getChart().getAllMarks().find(t=>t.getUserId()===this._spec.parent);"group"===e.type&&(t=e)}this._createExtensionMark(this._spec,t,`${d9}_series_${this.id}_extensionMark`,0)}_createExtensionMark(t,e,i,r=0){var n,l;let s=this._createMark({type:t.type,name:(0,aw.Z)(t.name)?`${t.name}`:`${i}_${r}`},{skipBeforeLayouted:!0,attributeContext:this._getMarkAttributeContext(),componentType:t.componentType,key:t.dataKey});if(s){if((0,aw.Z)(t.id)&&s.setUserId(t.id),(null==(n=this._option.globalInstance)?void 0:n.isAnimationEnable())&&t.animation){let e=_l({},_s(t.type,t,this._markAttributeContext));s.setAnimationConfig(e)}if((0,nB.Z)(e)?this._marks.addMark(s):e&&e.addMark(s),this.initMarkStyleWithSpec(s,t),"group"===t.type&&(i=`${i}_${r}`,null==(l=t.children)||l.forEach((t,e)=>{this._createExtensionMark(t,s,i,e)})),(0,aw.Z)(t.dataId)||(0,hy.Z)(t.dataIndex)){let e=this.getChart().getSeriesData(t.dataId,t.dataIndex);e&&(s.setDataView(e),e.target.addListener("change",()=>{s.getData().updateData()}))}}}initEvent(){}_compareSpec(t,e){let i=super._compareSpec(t,e);return(0,uL.X)(e,t)||(i.reMake=!0),i.change=!0,i.reRender=!0,i}_getMarkAttributeContext(){return{vchart:this._option.globalInstance,chart:this.getChart(),globalScale:(t,e)=>{var i;return null==(i=this._option.globalScale.getScale(t))?void 0:i.scale(e)},getLayoutBounds:()=>{let{x:t,y:e}=this.getLayoutStartPoint(),{width:i,height:r}=this.getLayoutRect();return(new iI.YZ).set(t,e,t+i,e+r)}}}_getLayoutRect(){let t=new iI.YZ;return this.getMarks().forEach(e=>{let i=e.getProduct();i&&t.union(i.AABBBounds)}),t.empty()?{width:0,height:0}:{width:t.width(),height:t.height()}}getBoundsInRect(t){this.setLayoutRect(t);let e=this._getLayoutRect(),{x:i,y:r}=this.getLayoutStartPoint();return{x1:i,y1:r,x2:i+e.width,y2:r+e.height}}getVRenderComponents(){let t=[],e=i=>{if(i&&"group"===i.type)i.getMarks().forEach(t=>{e(t)});else if("component"===i.type){let e=null==i?void 0:i.getComponent();e&&t.push(e)}};return this.getMarks().forEach(t=>{e(t)}),t}}Hf.type=oQ.customMark,Hf.specKey="customMark";let Hm=()=>{h9.registerComponent(Hf.type,Hf)};class Hy{constructor(t,e){this._chartLayoutRect={x:0,y:0,width:1,height:1},this._col=1,this._row=1,this._elementMap=new Map,this.standardizationSpec(t),this._gridInfo=t,this._col=t.col,this._row=t.row,this._colSize=Array(this._col).fill(null),this._rowSize=Array(this._row).fill(null),this._colElements=Array(this._col).fill([]),this._rowElements=Array(this._row).fill([]),this._onError=null==e?void 0:e.onError,this.initUserSetting()}standardizationSpec(t){var e,i,r;t.col=null!=(e=t.col)?e:1,t.row=null!=(i=t.row)?i:1,t.elements=null!=(r=t.elements)?r:[]}initUserSetting(){this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((t,e)=>{t||(this._colSize[e]={value:0,isUserSetting:!1,isLayoutSetting:!1})}),this._rowSize.forEach((t,e)=>{t||(this._rowSize[e]={value:0,isUserSetting:!1,isLayoutSetting:!1})})}setSizeFromUserSetting(t,e,i,r){t.forEach(t=>{t.index<0&&t.index>=i||((0,hy.Z)(t.size)?e[t.index]={value:+t.size,isUserSetting:!0,isLayoutSetting:!1}:(0,nz.Z)(t.size)&&(e[t.index]={value:t.size(r),isUserSetting:!0,isLayoutSetting:!1}))})}clearLayoutSize(){this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach(t=>{t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)}),this._rowSize.forEach(t=>{t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)})}getItemGridInfo(t){var e;let i,r=this._elementMap.get(t);return r||((i=null==(e=this._gridInfo.elements)?void 0:e.find(e=>{var i;if("modelId"in e&&(0,aw.Z)(e.modelId)){if((0,aw.Z)(t.model.userId)&&t.model.userId===e.modelId)return!0}else if("modelKey"in e&&(0,aw.Z)(e.modelKey)&&"modelIndex"in e&&(0,aw.Z)(e.modelIndex)&&(null!=(i=t.model.specKey)?i:t.model.type)===e.modelKey&&t.model.getSpecIndex()===e.modelIndex)return!0;return!1}))||(i={col:0,colSpan:1,row:0,rowSpan:1}),this._elementMap.set(t,i),i)}getSizeFromGrid(t,e){var i;let r="col"===e?this._colSize:this._rowSize,n=0;for(let l=t[e];l<t[e]+(null!=(i=t[`${e}Span`])?i:1);l++)n+=r[l].value;return n}getSizeFromUser(t,e){var i,r;let n="col"===e?this._colSize:this._rowSize;if(!(null==(i=n[t[e]])?void 0:i.isUserSetting))return;let l=0;for(let i=t[e];i<t[e]+(null!=(r=t[`${e}Span`])?r:1);i++){if(!n[i].isUserSetting)return;l+=n[i].value}return l}setItemLayoutSizeToGrid(t,e){if(Hv(t))e.colSpan&&e.colSpan>1||this._colSize[e.col].isUserSetting||(this._colSize[e.col].value=Math.max(this._colSize[e.col].value,t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight),this._colSize[e.col].isLayoutSetting=!0);else{if(e.rowSpan&&e.rowSpan>1||this._rowSize[e.row].isUserSetting)return;this._rowSize[e.row].value=Math.max(this._rowSize[e.row].value,t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom),this._rowSize[e.row].isLayoutSetting=!0}}layoutGrid(t){let e="col"===t?this._colSize:this._rowSize,i="col"===t?this._chartLayoutRect.width:this._chartLayoutRect.height,r=[];e.forEach(t=>{t.isUserSetting||t.isLayoutSetting?i-=t.value:r.push(t)}),i<0&&console.warn(`layout content ${t} size bigger than chart`),r.forEach(t=>t.value=i/r.length)}getItemPosition(t){let e=this.getItemGridInfo(t),i={x:this._chartLayoutRect.x,y:this._chartLayoutRect.y};for(let t=0;t<e.col;t++)i.x+=this._colSize[t].value;for(let t=0;t<e.row;t++)i.y+=this._rowSize[t].value;return i.x+=t.layoutPaddingLeft+t.layoutOffsetX,i.y+=t.layoutPaddingTop+t.layoutOffsetY,i}getItemLayoutRect(t){var e,i;let r=this.getItemGridInfo(t);return{width:(null!=(e=this.getSizeFromGrid(r,"col"))?e:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!=(i=this.getSizeFromGrid(r,"row"))?i:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom}}layoutItems(t,e,i,r){this._chartLayoutRect=i,this._chartViewBox=r,this.clearLayoutSize(),e.sort((t,e)=>e.layoutLevel-t.layoutLevel);let n=e.filter(t=>"normal"===t.layoutType&&!1!==t.getModelVisible()),l=n.filter(t=>Hv(t)),s=n.filter(t=>!Hv(t));n.forEach(t=>{this.layoutOneItem(t,"user",!1)});let a=e.filter(t=>"region-relative"===t.layoutType),o=a.filter(t=>Hv(t)),h=a.filter(t=>!Hv(t));o.forEach(t=>this.layoutOneItem(t,"user",!1)),this.layoutGrid("col"),s.forEach(t=>this.layoutOneItem(t,"colGrid",!1)),h.forEach(t=>{this.layoutOneItem(t,"colGrid",!1)}),this.layoutGrid("row"),h.forEach(t=>{this.layoutOneItem(t,"grid",!1)}),l.forEach(t=>this.layoutOneItem(t,"grid",!1)),o.forEach(t=>{this.layoutOneItem(t,"grid",!0)}),this.layoutGrid("col"),e.filter(t=>"region"===t.layoutType).forEach(t=>this.layoutOneItem(t,"grid",!1)),this.layoutAbsoluteItems(e.filter(t=>"absolute"===t.layoutType)),e.filter(t=>"absolute"!==t.layoutType).forEach(t=>{t.setLayoutStartPosition(this.getItemPosition(t))})}layoutAbsoluteItems(t){t.forEach(t=>{t.absoluteLayoutInRect(this._chartLayoutRect)})}layoutOneItem(t,e,i){var r,n;let l="rowGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),s="colGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),a=this.getItemGridInfo(t),o={width:(null!=(r=s(a,"col"))?r:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!=(n=l(a,"row"))?n:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom},h=t.computeBoundsInRect(o);(0,hy.Z)(h.width)||(h.width=o.width),(0,hy.Z)(h.height)||(h.height=o.height),t.setLayoutRect("grid"!==e?h:o),this.setItemLayoutSizeToGrid(t,a)}}function Hv(t){return"left"===t.layoutOrient||"right"===t.layoutOrient}Hy.type="grid";let Hb=()=>{h9.registerLayout(Hy.type,Hy)};var H_=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let HC=new iI.FB;uD(),cw(),cH(),c7();let Hx="M -0.5 -0.5, L -0.5 0.5, L 0.5 -0.5, Z",Hw="M -0.5 -0.5, L -0.5 0.5, L 0.5 0.5, Z",HS="M -0.5 -0.5, L 0.5 -0.5, L 0.5 0.5, Z",HA="M 0.5 -0.5, L 0.5 0.5, L -0.5 0.5, Z",HM={tl:Hx,tr:HS,bl:Hw,br:HA,lt:Hx,lb:Hw,rt:HS,rb:HA};class HT extends CB{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},HT.defaultAttributes,t)),this.name="poptip",this.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"]}render(){var t,e,i,r,n,l,s,a,o;let{titleStyle:h={},position:d,contentStyle:u={},panel:c,logoSymbol:p,poptipAnchor:g="position",logoText:f,logoTextStyle:m={},triangleMode:y="default",space:v=4,minWidth:b=0,maxWidth:_=1/0,padding:C=4,maxWidthPercent:x,visible:w,state:S,dx:A=0,dy:M=0,positionBounds:T}=this.attribute,{title:k="",content:R=""}=this.attribute;k=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(k):k,R=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(R):R;let P=(0,wj.o)(C),B=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group");this.group=B;let I=_-P[1]-P[3],E=(0,aw.Z)(k)&&!1!==w,L=Object.assign(Object.assign({text:(0,rD.Z)(k)?k:[k],visible:E,wrap:!0},h),{x:P[3],y:P[0],maxLineWidth:I,textAlign:"left",textBaseline:"top"}),F=B.createOrUpdateChild("poptip-title",L,"text");(0,uF.Z)(null==S?void 0:S.title)||(F.states=S.title);let O=F.AABBBounds,H=O.height(),D=O.width(),z=H+v;E||(z=0);let W=(0,aw.Z)(R)&&!1!==w,Z=Object.assign(Object.assign({text:(0,rD.Z)(R)?R:[R],visible:W,wrap:!0},u),{x:P[3],y:P[0]+z,maxLineWidth:I,textAlign:"left",textBaseline:"top"}),N=B.createOrUpdateChild("poptip-content",Z,"text");(0,uF.Z)(null==S?void 0:S.content)||(N.states=S.content);let j=N.AABBBounds,G=j.height(),V=j.width();W&&(z+=G),this.titleShape=F,this.contentShape=N;let U=(0,ik.Fp)(D+P[1]+P[3],V+P[1]+P[3]);U>_?U=_:U<b&&(U=b);let K=P[0]+P[2]+z,{visible:X,square:Y}=c,$=H_(c,["visible","square"]);if(Y){let t=(0,ik.Fp)(U,K);U=t;let e=t-K;K=t,F.setAttributes({dy:e/2}),N.setAttributes({dy:e/2})}let q=null!=(t=$.size)?t:12,J=(0,rD.Z)(q)?[q[0]+(null!=(e=$.space)?e:0),q[1]+(null!=(i=$.space)?i:0)]:q+(null!=(r=$.space)?r:0),Q=null!=(n=$.lineWidth)?n:1,te=this.stage?[null!=(l=this.stage.viewWidth)?l:this.stage.width,null!=(s=this.stage.viewHeight)?s:this.stage.height]:void 0;if(te){let t=this.AABBBounds,e=Math.max(null!=(a=this.attribute.x)?a:t.x1,te[0]-t.x1);if((e=Math.min(e-(((0,rD.Z)(q)?q[0]:12)+3),e*x))<U){U=e;let t=P[1]+P[3];F.setAttribute("maxLineWidth",e-t),N.setAttribute("maxLineWidth",e-t),K=P[0]+P[2],E&&(K+=F.AABBBounds.height()+v),K+=N.AABBBounds.height()}}let ti="auto"===d||(0,rD.Z)(d),tr=(0,rD.Z)(d)?d:this.positionList,tn,tl=-1/0;for(let t=0;t<tr.length+1;t++){let e=ti?tr[t===tr.length?tn:t]:d,i="arrow2Left",r=((0,rD.Z)(q)?q[0]:q)/4,n=0;"top"===e||"bottom"===e||"left"===e||"right"===e?i="arrow2Left":"concise"===y&&(i=HM[e],r=["tl","bl","rt","rb"].includes(e)?((0,rD.Z)(q)?q[0]:q)/2:-((0,rD.Z)(q)?q[0]:q)/2,n=["tl","tr","lb","rb"].includes(e)?-((0,rD.Z)(q)?q[1]:q)/2:((0,rD.Z)(q)?q[1]:q)/2);let{angle:l,offset:s}=this.getAngleAndOffset(e,U,K,(0,rD.Z)(J)?J:[J,J-Q],i),a,h={x:0,y:0};if("bounds"===g&&T&&(h=this.calculateAnchorPoint(e,T)),(0,nD.Z)(X)){let t;a=B.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},$),{visible:X&&(W||E),x:r,y:n,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:i,angle:l,dx:s[0],dy:s[1]-(null!=(o=$.space)?o:0),size:q,zIndex:9}),"symbol"),(0,uF.Z)(null==S?void 0:S.panel)||(a.states=S.panel),t=c.panelSymbolType?B.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},$),{visible:X&&(W||E),x:0,y:0,symbolType:"rect",size:[U,K],zIndex:-8}),"symbol"):B.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},$),{visible:X&&(W||E),x:0,y:0,width:U,height:K,zIndex:-8}),"rect"),(0,uF.Z)(null==S?void 0:S.panel)||(t.states=S.panel)}if(B.setAttributes({x:-s[0]+A+h.x,y:-s[1]+M+h.y,anchor:[r,n]}),p){let{size:t=12}=p,e=(0,rD.Z)(t)?t:[t,t];"auto"===e[1]&&(e[1]=K),"auto"===e[0]&&(e[0]=K);let i=e[0];B.createOrUpdateChild("poptip-logo",Object.assign(Object.assign({},p),{x:0,y:K/2,visible:X&&(W||E),zIndex:10,size:e}),"symbol"),B.setAttributes({x:-s[0]+A+i/2,y:-s[1]+M}),f&&B.createOrUpdateChild("poptip-logo-text",Object.assign(Object.assign({},m),{x:0,y:K/2,visible:X&&(W||E),text:f,textAlign:"center",textBaseline:"middle",zIndex:10}),"text")}if(!te)break;{HC.setValue(0,0,U,K).transformWithMatrix(B.globalTransMatrix);let i=(new iI.YZ).setValue(0,0,te[0],te[1]);if(ti){if((0,aj.RA)(HC,i,!1))break;{let e=(0,aj.di)(HC,i,!1),r=(e.x2-e.x1)*(e.y2-e.y1);r>tl&&(tl=r,tn=t)}}if(["top","bottom","left","right"].includes(e)){let t="top"===e||"bottom"===e,r="left"===e||"right"===e,n=!1;if(t?n="top"===e&&HC.y1<0||"bottom"===e&&HC.y2>i.y2:r&&(n="left"===e&&HC.x1<0||"right"===e&&HC.x2>i.x2),!n){let e=0,n=((0,rD.Z)(q)?q[1]:q)/2;t?(HC.x1<0?e=-HC.x1:HC.x2>i.x2&&(e=i.x2-HC.x2),B.setAttribute("x",B.attribute.x+e),a.setAttribute("dx",(0,ik.VV)((0,ik.Fp)(a.attribute.dx-e,n),HC.width()-n))):r&&(HC.y1<0?e=-HC.y1:HC.y2>i.y2&&(e=i.y2-HC.y2),B.setAttribute("y",B.attribute.y+e),a.setAttribute("dy",(0,ik.VV)((0,ik.Fp)(a.attribute.dy-e,n),HC.height()-n)));break}}if(!ti)break}}}calculateAnchorPoint(t,e){if(!e)return{x:0,y:0};let{x:i,y:r}=this.attribute,{x1:n,y1:l,x2:s,y2:a}=e,o=s-n,h=a-l;switch(t){case"top":case"tl":case"tr":return{x:n+o/2-i,y:l-r};case"bottom":case"bl":case"br":return{x:n+o/2-i,y:a-r};case"left":case"lt":case"lb":return{x:n-i,y:l+h/2-r};case"right":case"rt":case"rb":return{x:s-i,y:l+h/2-r};default:return{x:0,y:0}}}getAngleAndOffset(t,e,i,r,n){let l="arrow2Left"===n?r[1]/2:r[1];switch(t){case"tl":return{angle:"arrow2Left"===n?ik.pi/2*3:0,offset:"arrow2Left"===n?[e/4,i+l]:[0,i+l]};case"top":return{angle:ik.pi/2*3,offset:[e/2,i+l]};case"tr":return{angle:"arrow2Left"===n?ik.pi/2*3:0,offset:"arrow2Left"===n?[e/4*3,i+l]:[e,i+l]};case"rt":return{angle:0,offset:"arrow2Left"===n?[-l,i/5]:[-l,0]};case"right":return{angle:0,offset:[-l,i/2]};case"rb":return{angle:0,offset:"arrow2Left"===n?[-l,i/5*4]:[-l,i]};case"bl":return{angle:"arrow2Left"===n?ik.pi/2:0,offset:"arrow2Left"===n?[e/4,-l]:[0,-l]};case"bottom":return{angle:ik.pi/2,offset:[e/2,-l]};case"br":return{angle:"arrow2Left"===n?ik.pi/2:0,offset:"arrow2Left"===n?[e/4*3,-l]:[e,-l]};case"lt":return{angle:"arrow2Left"===n?ik.pi:0,offset:"arrow2Left"===n?[e+l,i/5]:[e+l,0]};case"left":return{angle:ik.pi,offset:[e+l,i/2]};case"lb":return{angle:"arrow2Left"===n?ik.pi:0,offset:"arrow2Left"===n?[e+l,i/5*4]:[e+l,i]}}}}HT.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},panel:{},maxWidthPercent:.8,space:8,padding:10};let Hk=class{render(t,e,i,r,n,l,s,a,o,h,d,u,c){var p,g,f;if(1===t._showPoptip){let{visible:e,visibleCb:i}=t.attribute.poptip||{};if(!1===e||i&&!1===i(t))return;let r={};(0,h3.Z)(r,HT.defaultAttributes,t.attribute.poptip?t.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(r):this.poptipComponent=new HT(r);let n=t.attribute.poptip||{};if("text"===t.type&&null==n.title&&null==n.content){let e={};f=n,(0,h3.Z)(e,uH.poptip,f),(n=e).content=null!=(p=n.content)?p:t.attribute.text}let l=t.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1,poptipAnchor:"bounds"},n),{x:l.e,y:l.f,positionBounds:t.globalAABBBounds})),h.stage.tryInitInteractiveLayer();let s=h.stage.getLayer("_builtin_interactive");s&&s.add(this.poptipComponent)}else 2===t._showPoptip&&(t._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),null==(g=this.poptipComponent.parent)||g.removeChild(this.poptipComponent),this.poptipComponent=null))}};Hk=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],Hk);var HR=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s};class HP{constructor(){this.activeEvent="onRegister",this._uid=eJ.GenAutoIncrementId(),this.poptip=t=>{let e=t.target;this.needHide(e)?this.unpoptip(t):e!==this.activeGraphic&&(this.needShow(e)&&(e.setAttributes({}),e._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(e,!0))},this.unpoptip=t=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(t){this.pluginService=t;let{stage:e}=this.pluginService;e.addEventListener("pointerover",this.poptip)}needHide(t){return t.isContainer||!t.attribute}needShow(t){return!!t.attribute.poptip}setActiveGraphic(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}deactivate(t){let{stage:e}=this.pluginService;e.removeEventListener("pointerover",this.poptip)}}let HB=class extends HP{constructor(){super(...arguments),this.name="poptip",this.key=this.name+this._uid}};HB=HR([e6()],HB);let HI=class extends HP{constructor(){super(...arguments),this.name="poptipForText",this.key=this.name+this._uid,this.pointerlave=t=>{let{stage:e}=this.pluginService;t.target===e&&this.unpoptip(t)}}activate(t){super.activate(t);let{stage:e}=this.pluginService;e.addEventListener("pointerleave",this.pointerlave)}needHide(t){return"text"!==t.type||!t.cliped||t.isContainer||!t.attribute||t.attribute.disableAutoClipedPoptip}needShow(t){return!0}deactivate(t){let{stage:e}=this.pluginService;super.deactivate(t),e.removeEventListener("pointerleave",this.pointerlave)}};HI=HR([e6()],HI);let HE=new eQ((t,e,i,r)=>{i(Hk)||(t(Hk).toSelf().inSingletonScope(),t(ou).toService(Hk)),i(HB)||(t(HB).toSelf(),t(aP).toService(HB)),i(HI)||(t(HI).toSelf(),t(aP).toService(HI))}),HL=()=>{ib.load(HE)},HF="vchart-tooltip",HO=`${HF}-container`,HH=`${HF}-title`,HD=`${HF}-content-box`,Hz={offsetX:10,offsetY:10},HW="99999999999999";function HZ(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\(/g,"&#40;").replace(/  /g," &nbsp;")}let HN=(t,e)=>t?(e||(e=t.getBoundingClientRect()),t.offsetWidth>0?e.width/t.offsetWidth:t.offsetHeight>0?e.height/t.offsetHeight:1):1,Hj=t=>(0,nI.Z)(t)&&""!==(null==t?void 0:t.trim())||(0,n4.Z)(t)?HZ(t):"",HG=(t,e)=>{let i;if((0,aw.Z)(t)){if((0,n4.Z)(t))i=t;else if((0,nz.Z)(t)){let r=t(e);(0,n4.Z)(r)&&(i=r)}}return i},HV={left:[-2,0],right:[2,0],top:[0,-2],bottom:[0,2],insideTop:[0,-1.5],insideBottom:[0,1.5],insideLeft:[-1.5,0],insideRight:[1.5,0],insideTopLeft:[-1.5,-1.5],insideTopRight:[1.5,-1.5],insideBottomLeft:[-1.5,1.5],insideBottomRight:[1.5,1.5],lt:[-2,-2],tl:[-2,-2],rt:[2,-2],tr:[2,-2],bl:[-2,2],lb:[-2,2],br:[2,2],rb:[2,2],inside:[0,0],center:[0,0],centerBottom:[0,1],centerTop:[0,-1],centerLeft:[-1,0],centerRight:[1,0]},HU=(t,e,i=2)=>{var r,n;return null!=(n=null==(r=HV[t])?void 0:r[+("x"!==e)])?n:i},HK=t=>(0,nF.Z)(t)&&((0,aw.Z)(t.left)||(0,aw.Z)(t.right)||(0,aw.Z)(t.top)||(0,aw.Z)(t.bottom)),HX=t=>(0,nF.Z)(t)&&((0,aw.Z)(t.x)||(0,aw.Z)(t.y));class HY extends xh{constructor(){super(...arguments),this._visible=!0,this._isReleased=!1,this.showTooltip=(t,e,i)=>{let{changePositionOnly:r}=i;return r?this.changeTooltipPosition(i,e):this.changeTooltip(!0,i,e)},this.changeTooltip=(t,e,i)=>this._isReleased?1:t?this.changeTooltipPosition(e,i):(this._updateTooltip(!1,e),0),this.changeTooltipPosition=(t,e)=>{var i,r,n,l,s;if(this._isReleased)return 1;let a=t.event,{tooltipSpec:o,activeTooltipSpec:h,changePositionOnly:d}=t;if(!h)return 1;let u=h.activeType;if(h.handler)return null!=(n=null==(r=(i=h.handler).showTooltip)?void 0:r.call(i,u,e,t))?n:0;let c=this._getActualTooltipPosition(h,t,this._getTooltipBoxSize(h,d));h.position=c;let p=null!=(l=h.updatePosition)?l:null==(s=o[u])?void 0:s.updatePosition;p&&(h.position=p(h.position,e,t));let g=!1!==(null==h?void 0:h.visible);return e&&"pointerout"!==a.type&&h.visible&&(h.title||h.content)||(g=!1),this._updateTooltip(g,Object.assign(Object.assign({},t),{changePositionOnly:d})),0},this._getActualTooltipPosition=(t,e,i)=>{var r,n,l,s,a,o,h,d,u;let c=this._chartOption.getRectByDimensionData,{tooltipSpec:p}=e,g={x:1/0,y:1/0};if(!p)return g;let f=e.event,{activeType:m,data:y}=t,v="dimension"===m?null==(n=null==(r=y[0])?void 0:r.data)?void 0:n[0]:null==y?void 0:y[0],{offsetX:b,offsetY:_}=this._option,C=p[m],x=bN(null==C?void 0:C.position,y,e),w=null!=(l=bN(null==C?void 0:C.positionMode,y,e))?l:"mark"===m?"mark":"pointer",{width:S=0,height:A=0}=null!=i?i:{},M="canvas"===p.renderMode,T=null==(s=null==e?void 0:e.chart)?void 0:s.getCanvasRect(),k=null!=(a=null==T?void 0:T.width)?a:ut,R=null!=(o=null==T?void 0:T.height)?o:ue,P=!1,B={width:0,height:0},I,E={x:0,y:0},L={x:0,y:0},F=1,O=1,H=hI(this._env);if(H&&!p.confine?(B.width=window.innerWidth,B.height=window.innerHeight):(B.width=k,B.height=R),H&&!M){let t=this._getParentElement(p);L=null!=(d=null==(h=null==t?void 0:t.getBoundingClientRect)?void 0:h.call(t))?d:g;let e=null!=(u=this._compiler.getCanvas())?u:this._chartContainer;E={x:(I=null==e?void 0:e.getBoundingClientRect()).x-L.x,y:I.y-L.y},F=HN(e,I),O=HN(t,L)}let D=O/F,z={},W={x:x,y:x},Z={x:["left","right"],y:["top","bottom"]},N=({orient:t,mode:i,offset:r},n)=>{var l;let s,a,o=e.model,h=null==o?void 0:o.getLayoutStartPoint(),d=null!=r?r:"x"===n?b:_;if("mark"===i){P=!0;let t=e.item,i=null==t?void 0:t.AABBBounds;i&&h&&(s=("x"===n?i.x1:i.y1)+h[n],a=("x"===n?i.x2:i.y2)+h[n])}else if(c&&"crosshair"===i&&"cartesian"===(null==(l=null==v?void 0:v.series)?void 0:l.coordinate)&&v.datum&&v.datum.length){P=!0;let t=c(v,h);t&&(s=t.start[n],a=t.end[n])}else W[n]=t;if(P){let e=Z[n][0],i="x"===n?S:A;switch(HU(t,n)){case -2:z[e]=s-i*D-d;break;case -1.5:z[e]=s+d;break;case 0:z[e]=(s+a)/2-i*D/2;break;case -1:z[e]=(s+a)/2-i*D-d;break;case 1:z[e]=(s+a)/2+d;break;case 1.5:z[e]=a-i*D-d;break;case 2:z[e]=a+d}}},j=["x","y"];if((0,nF.Z)(x))if(HK(x)){let{left:t,right:e,top:i,bottom:r}=x;z.left=HG(t,f),z.top=HG(i,f),z.right=HG(e,f),z.bottom=HG(r,f)}else HX(x)&&j.forEach(t=>{let e=x[t];(0,n4.Z)(e)||(0,nz.Z)(e)?z[Z[t][0]]=HG(e,f):N(e,t)});else(0,aw.Z)(x)&&(N({orient:x,mode:w},"x"),N({orient:x,mode:w},"y"));let G={x:null,y:null};return j.forEach(t=>{var e;let i="x"===t?S:A,r="x"===t?k:R,n="x"===t?b:_,l=HU(W[t],t);if((0,hy.Z)(z[Z[t][0]]))G[t]=z[Z[t][0]];else if((0,hy.Z)(z[Z[t][1]]))G[t]=r-i*D-z[Z[t][1]];else{let e="x"===t?f.canvasX:f.canvasY;G[t]=l>0?e+n:0===l?e-i*D/2:e-i*D-n}G[t]*=F,H&&(G[t]+=E[t]),G[t]/=O;let s="x"===t?B.width:B.height,a=p.confine?-(L[t]-(null!=(e=null==I?void 0:I[t])?e:0)/F)/O:-L[t]/O,o=s/O+a-i;2!==l&&G[t]<a?P?G[t]=a:(G[t]+=0===l?n+i/2:2*n+i,G[t]>o&&(G[t]=o)):-2!==l&&G[t]>o&&(P?G[t]=o:(G[t]-=0===l?n+i/2:2*n+i,G[t]<a&&(G[t]=a)))}),G}}get env(){return this._env}onAdd(t){super.onAdd(t);let e=t.component;this._component=e,this._chartOption=e.getOption(),this._env=this._chartOption.mode,this._chartContainer=this._chartOption.globalInstance.getContainer(),this._compiler=e.getCompiler(),this._initFromSpec()}hideTooltip(t){return this.changeTooltip(!1,t)}release(){var t,e,i,r;let n=null!=(e=null==(t=this._component)?void 0:t.getSpec())?e:{};n.handler?null==(r=(i=n.handler).release)||r.call(i):(this._removeTooltip(),this._isReleased=!0,this._chartOption=null,this._component=null)}_getDefaultOption(){var t,e;let{offset:i}=this._component.getSpec();return i?{offsetX:null!=(t=i.x)?t:Hz.offsetX,offsetY:null!=(e=i.y)?e:Hz.offsetY}:Hz}_getParentElement(t){return t.parentElement}getTooltipContainer(){return this._container}_initFromSpec(){this._option=this._getDefaultOption()}reInit(){this._initFromSpec()}}HY.specKey="tooltip";let H$=(t,e)=>(0,aw.Z)(t)?(0,rD.Z)(t)?t.map(t=>`${t}px`).join(" "):`${t}px`:null!=e?e:"initial",Hq=(t={},e={})=>{var i,r;(0,aw.Z)(t.fontFamily)&&(e.fontFamily=t.fontFamily);let n=null!=(i=t.fill)?i:t.fontColor;return(0,aw.Z)(n)&&(e.color=n),(0,aw.Z)(t.fontWeight)&&(e.fontWeight=t.fontWeight),(0,aw.Z)(t.textAlign)&&(e.textAlign=t.textAlign),(0,aw.Z)(t.fontSize)&&(e.fontSize=H$(t.fontSize)),(0,aw.Z)(t.maxWidth)&&(e.maxWidth=H$(t.maxWidth)),t.multiLine||(0,aw.Z)(t.maxWidth)&&!1!==t.multiLine?(e.whiteSpace="initial",e.wordBreak=null!=(r=t.wordBreak)?r:"break-word"):(e.wordBreak="normal",e.whiteSpace="nowrap"),e},HJ=(t={})=>{let{lineHeight:e}=t;return t.fontSize?hw(e,t.fontSize):0},HQ=(t={})=>{var e,i,r,n;let{style:l={},enterable:s,transitionDuration:a}=t,{panel:o={},titleLabel:h,shape:d,keyLabel:u,valueLabel:c,spaceRow:p,align:g}=l,{panelStyle:f,panelPadding:m}=H0(o),y={marginTop:"0px",marginBottom:"0px"};f.pointerEvents=s?"auto":"none",a&&(f.transitionDuration=a?`${a}ms`:"initial",f.transitionProperty=a?"transform":"initial",f.transitionTimingFunction=a?"ease-out":"initial"),(0,hy.Z)(p)&&(y.marginBottom=`${p}px`);let v={width:H$(null!=(e=null==d?void 0:d.size)?e:8)},b=Hq(h),_=Hq(u),C=Hq(c),x="right"===g?"marginLeft":"marginRight";"right"===g&&(f.direction="rtl"),(0,nB.Z)(b.textAlign)&&(b.textAlign="right"===g?"right":"left"),(0,nB.Z)(_.textAlign)&&(_.textAlign="right"===g?"right":"left"),(0,nB.Z)(C.textAlign)&&(C.textAlign="right"===g?"left":"right"),v[x]=H$(null!=(i=d.spacing)?i:8),_[x]=H$(null!=(r=u.spacing)?r:26),C[x]=H$(null!=(n=c.spacing)?n:0);let w=Math.max(HJ(c),HJ(u));return y.lineHeight=w>0?`${w}px`:"20px",{panelPadding:m,row:y,panel:f,title:b,shape:v,key:_,value:C}},H0=t=>{var e;let{backgroundColor:i,border:r,shadow:n,padding:l}=t,s={borderWidth:`${null!=(e=null==r?void 0:r.width)?e:0}px`},a=null;(null==r?void 0:r.color)&&(s.borderColor=r.color),i&&(s.backgroundColor=i),s.boxShadow=n?`${n.x}px ${n.y}px ${n.blur}px ${n.spread}px ${n.color}`:"initial";let{radius:o}=null!=r?r:{};return(0,aw.Z)(o)&&(s.borderRadius=(0,hy.Z)(o)?`${o}px`:`${o}`),l&&(s.padding=H$(a=(0,wj.o)(l))),{panelStyle:s,panelPadding:a}};function H1(t,e){t&&t.style&&e&&Object.keys(e).forEach(i=>{t.style[i]=e[i]})}let H2=t=>{h9.registerComponentPlugin(t.type,t)};class H3 extends HY{getVisibility(){return!!this._rootDom&&"visible"===this._rootDom.style.visibility}setVisibility(t){t!==this.getVisibility()&&this._rootDom&&(this._rootDom.style.visibility=t?"visible":"hidden")}getRootDom(){return this._rootDom}constructor(){super(H3.type),this.type=AG.dom,this._tooltipContainer=null==hB?void 0:hB.body}onAdd(t){super.onAdd(t),this._initStyle(),this.initEl()}initEl(){let t=this._component.getSpec().parentElement;if(hB&&t&&t.children&&t.children.length){for(let e=0;e<t.children.length;e++)if(t.children[e].classList.contains(HO)){this._container=t.children[e];break}this._container||(this._container=hB.createElement("div"),this._container.style.position="relative",this._container.style.zIndex=HW,this._container.classList.add(HO),t.appendChild(this._container))}}initRootDom(){var t;let e=this._component.getSpec(),i=document.createElement("div"),r=null==(t=this._chartOption)?void 0:t.getTheme("fontFamily");H1(i,Object.assign({left:"0",top:"0",pointerEvents:"none",padding:"12px",position:"absolute",zIndex:HW,fontFamily:null!=r?r:hW.fontFamily,fontSize:"11px",borderRadius:"3px",borderStyle:"solid",lineHeight:"initial",background:"#fff",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)",maxWidth:"100wh",maxHeight:"100vh",visibility:"hidden"},this._domStyle.panel)),i.classList.add(e.className),i.setAttribute("vchart-tooltip-id",`${this.id}`),this._container.appendChild(i),this._rootDom=i}_getTooltipBoxSize(t,e){var i;this._rootDom||this.initRootDom(),e||this._updateDomStringByCol(t),this._updateDomStyle("height",e);let r=null==(i=this._rootDom)?void 0:i.getBoundingClientRect();return{width:null==r?void 0:r.width,height:null==r?void 0:r.height}}_removeTooltip(){this._rootDom&&this._rootDom.parentNode&&(this._rootDom.parentNode.removeChild(this._rootDom),this._rootDom=null),this._container=null}_updateTooltip(t,e){var i,r;if(t&&this._rootDom){let{tooltipSpec:n,activeTooltipSpec:l}=e;e.changePositionOnly||(this._tooltipActual=l);let s=this._rootDom;if(s){let{x:a=0,y:o=0}=null!=(i=l.position)?i:{},h={x:a,y:o},d=this.getVisibility();n.updateElement&&(this._updatePosition(null!=(r=this._cacheCustomTooltipPosition)?r:{x:a,y:o}),n.updateElement(s,l,e),h=this._getActualTooltipPosition(l,e,{width:s.offsetWidth,height:s.offsetHeight}),this._cacheCustomTooltipPosition=h),!d&&t&&(this._rootDom.style.transition="none",this._updatePosition(h,!1),this._rootDom.getBoundingClientRect()),this._updatePosition(h)}this.setVisibility(t)}else this.setVisibility(t),this._cacheCustomTooltipPosition=void 0}_initStyle(){let t=this._component.getSpec();this._domStyle=HQ(t)}_updateDomStringByCol(t){var e;let{title:i={},content:r}=t,n=r&&r.length,l=this._domStyle.row,s=[...this._rootDom.children],a=s.find(t=>t.className.includes(HH)),o=s.find(t=>t.className.includes(HD));if(!a&&!1!==i.visible){a=document.createElement("h2");let t=document.createElement("span");a.appendChild(t),a.classList.add(HH),this._rootDom.firstChild?this._rootDom.insertBefore(a,this._rootDom.firstChild):this._rootDom.appendChild(a)}a&&!1!==i.visible?(H1(a,Object.assign(Object.assign(Object.assign({},this._domStyle.title),n?l:{marginBottom:"0px"}),{marginTop:"0px"})),a.firstChild.innerHTML=`${null!=(e=i.value)?e:""}`):a&&!1===i.visible&&a.parentNode.removeChild(a);let h=["shape","key","value"];if(!o&&n&&(o=document.createElement("div"),h.forEach(t=>{let e=document.createElement("div");e.classList.add(`${HF}-column`),e.classList.add(`${HF}-${t}-column`),e.setAttribute("data-col",t),o.appendChild(e)}),o.classList.add(HD),this._rootDom.appendChild(o)),o&&n){let t=[...o.children];H1(o,{whiteSpace:"nowrap"}),t.forEach((t,e)=>{let i=t.getAttribute("data-col");if(i&&h.includes(i)){let e="shape"===i&&r.every(t=>!t.hasShape||!t.shapeType);H1(t,Object.assign(Object.assign({},this._domStyle[i]),{display:e?"none":"inline-block",verticalAlign:"top"}));let n=[...t.children];n.slice(r.length).forEach(t=>{t.parentNode.removeChild(t)}),r.forEach((e,s)=>{let a=n[s];a||((a=document.createElement("div")).classList.add(`${HF}-${i}`),t.appendChild(a));let o=Object.assign({},l);s===r.length-1&&(o.marginBottom="0px"),o.display=!1===e.visible?"none":"block",o.height="initial","key"===i?(a.innerHTML=Hj(e.key),e.keyStyle&&Hq(e.keyStyle,o)):"value"===i?(a.innerHTML=Hj(e.value),e.valueStyle&&Hq(e.valueStyle,o)):"shape"===i&&(a.innerHTML=function(t,e){var i,r,n,l,s,a;let o,h;if(!t||!t.hasShape||!t.shapeType)return"";let d='style="display:inline-block;vertical-align:middle;"',{shapeType:u,shapeStroke:c,shapeHollow:p=!1,shapeFill:g}=t,f=null!=(i=t.shapeSize)?i:8,m=t.shapeLineWidth?HZ(t.shapeLineWidth)+"px":"0px",y="currentColor",v=()=>c?HZ(c):y,b=t=>new oB({symbolType:t,size:f,fill:!0}),_=b(u),C=_.getParsedPath();if(!C.path&&C.pathStr&&(_=b(C.pathStr)),_.getParsedPath().path){let t=_.getParsedPath().path;h=t.toString(),o=t.bounds}else C.isSvg&&C.svgCache&&(h=C.svgCache.map(t=>t.path.toString()).join(),o=C.svgCache.reduce((t,e)=>t.union(e.path.bounds),new iI.YZ));let x=`${o.x1} ${o.y1} ${o.width()} ${o.height()}`;if("0px"!==m){let[t,e,i,r]=x.split(" ").map(t=>Number(t)),n=Number(m.slice(0,-2));x=`${t-n/2} ${e-n/2} ${i+n} ${r+n}`}let w=rW.IsGradientStr(g);if(!g||(0,nI.Z)(g)&&!w||p)return y=p?"none":g?HZ(g):"currentColor",`
    <svg ${d} width="${f}" height="${f}" viewBox="${x}">
      <path
        d="${h}"
        style="fill: ${y}; stroke: ${v()}; stroke-width: ${m}"
      >
      </path>
    </svg>`;let S=w?rW.Parse(g):(0,nF.Z)(g)?g:null;if(S){y="gradientColor"+(null!=e?e:"");let t="",i=(null!=(r=S.stops)?r:[]).map(t=>`<stop offset="${HZ(t.offset.toString())}" stop-color="${HZ(t.color)}"/>`).join("");return"radial"===S.gradient?t=`<radialGradient id="${y}" cx="50%" cy="50%" r="50%" fx="0%" fy="0%">
      ${i}
      </radialGradient>`:"linear"===S.gradient&&(t=`<linearGradient id="${y}" x1="${100*(null!=(n=S.x0)?n:0)}%" y1="${100*(null!=(l=S.y0)?l:0)}%" x2="${100*(null!=(s=S.x1)?s:0)}%" y2="${100*(null!=(a=S.y1)?a:0)}%">
      ${i}
      </linearGradient>`),`
    <svg ${d} width="${f}" height="${f}" viewBox="-0.5 -0.5 1 1">
      ${t}
      <path
        d="${h}"
        style="fill: url(#${y}); stroke: ${v()}; stroke-width: ${m}"
      >
      </path>
    </svg>`}return""}(e,`${this.id}_${s}`)),H1(a,o)})}})}else o&&!n&&o.parentNode.removeChild(o)}_updateDomStyle(t="width",e){var i,r,n,l,s;let a=this._rootDom,o=[...a.children].find(t=>t.className.includes(HD)),h=[...a.children].find(t=>t.className.includes(HH));if(o){let a=this._component.getSpec(),d={},u=null==(i=a.style)?void 0:i.titleLabel;if(u&&u.autoWidth&&!1!==u.multiLine&&h){let e=[...o.children].reduce((e,i)=>"height"===t?e+i.getBoundingClientRect().width:Math.max(e,i.getBoundingClientRect().width),0);e>0&&(h.style.maxWidth=`${e}px`,h.style.maxWidth=`${Math.ceil(o.getBoundingClientRect().width)}px`)}if((0,aw.Z)(null==(r=null==a?void 0:a.style)?void 0:r.maxContentHeight)){let t=h&&h.className.includes(HH)?h.getBoundingClientRect().height+(null!=(n=a.style.spaceRow)?n:0):0,e=this._chartOption.getChartViewRect(),i=hw(a.style.maxContentHeight,Math.min(e.height,document.body.clientHeight)-t-(this._domStyle.panelPadding?this._domStyle.panelPadding[0]+this._domStyle.panelPadding[1]:0));i>0&&(d.maxHeight=`${i}px`,d.overflowY="auto",d.width=`calc(100% + ${this._domStyle.panelPadding?this._domStyle.panelPadding[1]+"px":"10px"})`,H1(o,d))}let c=o.children,p=[];if(c){for(let i=0;i<c.length;i++){let r=null!=(l=c[i].children)?l:[];for(let i=0;i<r.length;i++){e&&(r[i].style[t]="initial");let n=r[i].getBoundingClientRect()[t];(void 0===p[i]||p[i]<n)&&(p[i]=n)}}for(let e=0;e<c.length;e++){let i=null!=(s=c[e].children)?s:[];for(let e=0;e<i.length;e++)i[e].style[t]=`${p[e]}px`}}}}_getParentElement(t){var e;return null!=(e=this._container)?e:super._getParentElement(t)}isTooltipShown(){return this.getVisibility()}reInit(){super.reInit(),this._initStyle(),this._rootDom&&H1(this._rootDom,this._domStyle.panel),this.getVisibility()&&(this._updateDomStringByCol(this._tooltipActual),this._updateDomStyle("height",!1))}_updatePosition({x:t,y:e},i=!0){this._rootDom&&(this._rootDom.style.transform=`translate3d(${t}px, ${e}px, 0)`,i&&""!==this._rootDom.style.transition&&(this._rootDom.style.transition="",Object.assign(this._rootDom.style,this._domStyle.panel)))}}H3.type=AG.dom;let H5=()=>{H2(H3)},H4=(t,...e)=>{let i=[t.shape,...e.map(t=>null==t?void 0:t.shape)],r=[t.key,...e.map(t=>null==t?void 0:t.key)],n=[t.value,...e.map(t=>null==t?void 0:t.value)];return(0,h3.Z)(t,...e,{shape:i.every(nB.Z)?void 0:(0,h3.Z)({},...i),key:r.every(nB.Z)?void 0:(0,h3.Z)({},...r),value:n.every(nB.Z)?void 0:(0,h3.Z)({},...n)})},H6=t=>{let{width:e,height:i,wordBreak:r="break-word",textAlign:n,textBaseline:l,text:s}=t;return Array.isArray(s)?{width:e,height:i,wordBreak:r,textAlign:n,textBaseline:l,singleLine:!1,textConfig:(0,a1.IX)(s).map(e=>Object.assign(Object.assign({},t),{text:e}))}:{width:e,height:i,wordBreak:r,textAlign:n,textBaseline:l,singleLine:!1,textConfig:null==s?void 0:s.text}},H7={panel:{visible:!0,cornerRadius:[3,3,3,3],fill:"white",shadow:!0,shadowBlur:12,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:4,shadowSpread:0,stroke:"white"},titleStyle:{value:{fill:"#4E5969",fontFamily:gY,fontSize:14,lineHeight:18,textAlign:"left",textBaseline:"middle"},spaceRow:6},contentStyle:{shape:{fill:"black",size:8,symbolType:"circle",spacing:6},key:{fill:"#4E5969",fontFamily:gY,fontSize:12,lineHeight:18,textAlign:"left",textBaseline:"middle",spacing:26},value:{fill:"#4E5969",fontFamily:gY,fontSize:12,lineHeight:18,textAlign:"right",textBaseline:"middle",spacing:0},spaceRow:6},padding:10,positionX:"right",positionY:"bottom",offsetX:10,offsetY:10,parentBounds:(new iI.FB).setValue(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),autoCalculatePosition:!0,autoMeasure:!0,pickable:!1,childrenPickable:!1,zIndex:500},H8=["pointerX","pointerY","offsetX","offsetY","positionX","positionY","parentBounds"];uD(),c7(),cH(),cw(),Cw();class H9 extends CB{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h3.Z)({},H9.defaultAttributes,t),e),this.name="tooltip"}render(){var t;let{visible:e,content:i,panel:r,keyWidth:n,valueWidth:l,hasContentShape:s,autoCalculatePosition:a,autoMeasure:o,align:h}=this.attribute;if(!e)return void this.hideAll();o&&H9.measureTooltip(this.attribute),a&&H9.calculateTooltipPosition(this.attribute);let d=(0,wj.o)(this.attribute.padding);this._tooltipPanel=this.createOrUpdateChild("tooltip-background",Object.assign({visible:!0},r),"rect"),this._tooltipTitleContainer=this.createOrUpdateChild("tooltip-title",{visible:!0,x:d[3],y:d[0]},"group");let u=H9.getTitleAttr(this.attribute);this._tooltipTitleSymbol=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-shape",(0,h3.Z)({symbolType:"circle"},u.shape,{visible:_Y(u)&&_Y(u.shape)}),"symbol"),"object"!=typeof u.value.text||null===u.value.text||"rich"!==u.value.text.type&&"html"!==u.value.text.type?u.value.multiLine?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:_Y(u)&&_Y(u.value)},H6(u.value)),"richtext"):this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({text:null!=(t=u.value.text)?t:"",visible:_Y(u)&&_Y(u.value)},u.value),"text"):"rich"===u.value.text.type?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:_Y(u)&&_Y(u.value)},H6(u.value)),"richtext"):"html"===u.value.text.type&&(this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({html:Object.assign(Object.assign({dom:u.value.text.text},gq),u.value),visible:_Y(u)&&_Y(u.value),width:u.value.width,height:u.value.height,wordBreak:u.value.wordBreak,textAlign:u.value.textAlign,textBaseline:u.value.textBaseline,singleLine:!1,textConfig:[]},u.value),"richtext"));let c=_Y(u.shape)?u.shape.size+u.shape.spacing:0,{textAlign:p,textBaseline:g}=u.value,f=r.width-d[3]-d[0]-c;"center"===p?this._tooltipTitle.setAttribute("x",c+f/2):"right"===p||"end"===p?this._tooltipTitle.setAttribute("x",c+f):this._tooltipTitle.setAttribute("x",c),"bottom"===g?this._tooltipTitle.setAttribute("y",u.height):"middle"===g?this._tooltipTitle.setAttribute("y",u.height/2):this._tooltipTitle.setAttribute("y",0);let m=_Y(u)?u.height+u.spaceRow:0;if(this._tooltipContent=this.createOrUpdateChild("tooltip-content",{visible:!0},"group"),this._tooltipContent.removeAllChild(!0),i&&i.length){this._tooltipContent.setAttribute("x",d[3]),this._tooltipContent.setAttribute("y",d[0]+m);let t=0;i.forEach((e,i)=>{let r=H9.getContentAttr(this.attribute,i);if(!_Y(r))return;let a=`tooltip-content-${i}`,o=this._tooltipContent.createOrUpdateChild(a,{visible:!0,x:0,y:t},"group"),d=r.shape.size+r.shape.spacing,u="right"===h?(s?d:0)+(_Y(r.key)?n+r.key.spacing:0)+(_Y(r.value)?l:0):0;this._createShape("right"===h?u-r.shape.size/2:u+r.shape.size/2,r,o,a),s&&("right"===h?u-=d:u+=d);let c=this._createKey(r,o,a);c&&(g5(h,c,r.key.textAlign,u,n),c.setAttribute("y",0),"right"===h?u-=n+r.key.spacing:u+=n+r.key.spacing);let p=this._createValue(r,o,a);if(p){let t="right";(0,aw.Z)(r.value.textAlign)?t=r.value.textAlign:_Y(r.key)||"right"===h||(t="left"),p.setAttribute("textAlign",t),g5(h,p,t,u,l),p.setAttribute("y",0)}t+=r.height+r.spaceRow})}}_createShape(t,e,i,r){var n;if(_Y(e.shape))return i.createOrUpdateChild(`${r}-shape`,Object.assign({visible:!0,x:t,y:e.shape.size/2+((null!=(n=n5(e.key.lineHeight,e.key.fontSize))?n:e.key.fontSize)-e.shape.size)/2},e.shape),"symbol")}_createKey(t,e,i){var r;if(_Y(t.key))return t.key.multiLine?e.createOrUpdateChild(`${i}-key`,Object.assign(Object.assign({visible:!0},H6(t.key)),{textBaseline:"top"}),"richtext"):"object"!=typeof t.key.text||null===t.key.text||"rich"!==t.key.text.type&&"html"!==t.key.text.type?e.createOrUpdateChild(`${i}-key`,Object.assign(Object.assign({visible:!0,text:null!=(r=t.key.text)?r:""},t.key),{textBaseline:"top"}),"text"):"rich"===t.key.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},H6(t.key)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild(`${i}-value`,{html:Object.assign(Object.assign({dom:t.key.text.text},gq),t.key)},"richtext")}_createValue(t,e,i){var r;if(_Y(t.value))return t.value.multiLine?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},H6(t.value)),{textBaseline:"top"}),"richtext"):"object"!=typeof t.value.text||null===t.value.text||"rich"!==t.value.text.type&&"html"!==t.value.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0,text:null!=(r=t.value.text)?r:""},t.value),{textBaseline:"top"}),"text"):"rich"===t.value.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},H6(t.value)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild(`${i}-value`,{html:Object.assign({dom:t.value.text.text,container:"",width:30,height:30,style:{}},t.value)},"richtext")}setAttributes(t,e){let i=Object.keys(t);this.attribute.autoCalculatePosition&&i.every(t=>H8.includes(t))?(this._mergeAttributes(t,i),(0,nB.Z)(this.attribute.panel.width)&&this.attribute.autoMeasure&&H9.measureTooltip(this.attribute),H9.calculateTooltipPosition(this.attribute),super.setAttributes({x:this.attribute.x,y:this.attribute.y},e)):super.setAttributes(t,e)}static calculateTooltipPosition(t){let{width:e=0,height:i=0}=t.panel,{offsetX:r,offsetY:n,pointerX:l,pointerY:s,positionX:a,positionY:o,parentBounds:h}=t,d=l,u=s;return"left"===a?d-=e+r:"center"===a?d-=e/2:d+=r,"top"===o?u-=i+n:"middle"===o?u-=i/2:u+=n,d+e>h.x2&&(d-=e+r),u+i>h.y2&&(u-=i+n),d<h.x1&&(d=h.x1),u<h.y1&&(u=h.y1),t.x=d,t.y=u,t}static measureTooltip(t){let{content:e,contentStyle:i}=t,r=(0,wj.o)(t.padding),n=H9.getTitleAttr(t),l=0,s=r[0]+r[2],a=0,{value:o,shape:h}=n,{visible:d=!1,symbolType:u=""}=null!=h?h:{};if((0,aw.Z)(o)&&"object"!=typeof n.value.text){let{width:t,height:e}=gQ(o).quickMeasure(o.text);l=t,a=e}if(d&&l$[u]&&(l+=h.size+h.spacing,a=Math.max(h.size,a)),t.title&&(t.title.width=l,t.title.height=a),_Y(n)&&(s+=a+n.spaceRow),e&&e.length){let r=[];if(e.forEach((e,i)=>{let n=H9.getContentAttr(t,i);(e.key||e.value)&&_Y(n)&&r.push([e,n])}),r.length){let n=!1,a=[],o=[],h=[];r.forEach(([t,e],l)=>{var d;let{key:u,value:c,shape:p,spaceRow:g}=e,f=_Y(p),m=null!=(d=null==p?void 0:p.symbolType)?d:"",y=gQ(u),v=gQ(c),b=0;if(_Y(u)){let{width:t,height:e}=y.quickMeasure(u.text);o.push(t),b=Math.max(b,e)}if(_Y(c)){let{width:t,height:e}=v.quickMeasure(c.text);h.push(t),b=Math.max(b,e)}f&&l$[m]&&(n=!0,a.push(p.size),b=Math.max(p.size,b)),t.height=b,s+=b,l<r.length-1&&(s+=null!=g?g:i.spaceRow)});let d=a.length?Math.max(...a):0,u=o.length?Math.max(...o):0,c=h.length?Math.max(...h):0;l=Math.max(u+c+i.key.spacing+i.value.spacing+(n?d+i.shape.spacing:0),l),e.forEach(t=>{t.width=l}),t.hasContentShape=n,t.keyWidth=u,t.valueWidth=c}}return t.panel.width=l+r[1]+r[3],t.panel.height=s,t}static getTitleAttr(t){return H4({},H9.defaultAttributes.titleStyle,H9.defaultAttributes.title,t.titleStyle,t.title)}static getContentAttr(t,e){return H4({},H9.defaultAttributes.contentStyle,t.contentStyle,t.content[e])}}H9.defaultAttributes=H7;let Dt={fontFamily:hW.fontFamily,spacing:10,wordBreak:"break-word"},De=(t,e)=>{var i,r;let n,l;"rich"!==(null==t?void 0:t.type)&&"html"!==(null==t?void 0:t.type)?(t=(null!=t?t:"").toString(),l=(n=e.multiLine?(n=t.split("\n")).map((t,e)=>e<n.length-1?t+"\n":t):[t]).map(t=>Object.assign(Object.assign({},e),{text:t}))):(l=t.text,n=t);let s=(r={wordBreak:null!=(i=e.wordBreak)?i:"break-word",maxWidth:e.maxWidth?e.maxWidth:void 0,width:0,height:0,textConfig:l},u||(u=ak.CreateGraphic("richtext",{})),u.setAttributes(r),u.AABBBounds);return{width:s.width(),height:s.height(),text:n}};function Di(t={},e,i){var r,n;return Object.assign(Object.assign({},null!=i?i:Dt),{fill:null!=(r=t.fill)?r:t.fontColor,textAlign:t.textAlign,textBaseline:t.textBaseline,fontFamily:null!=(n=t.fontFamily)?n:e,fontSize:t.fontSize,fontWeight:t.fontWeight,lineHeight:t.lineHeight,spacing:t.spacing,multiLine:(0,aw.Z)(t.maxWidth)?!1!==t.multiLine:t.multiLine,maxWidth:t.maxWidth,wordBreak:t.wordBreak,autoWidth:t.autoWidth})}let Dr=t=>{var e;let{backgroundColor:i,border:r,shadow:n}=t,l={lineWidth:null!=(e=null==r?void 0:r.width)?e:0,shadow:!!n};(null==r?void 0:r.color)&&(l.stroke=r.color),i&&(l.fill=i),n&&(l.shadowColor=n.color,l.shadowBlur=n.blur,l.shadowOffsetX=n.x,l.shadowOffsetY=n.y,l.shadowSpread=n.spread);let{radius:s}=null!=r?r:{};return(0,aw.Z)(s)&&(l.cornerRadius=[s,s,s,s]),l},Dn=(t,e,i)=>{var r,n,l,s,a;let{style:o={},enterable:h,transitionDuration:d}=e,{panel:u={},titleLabel:c,shape:p,keyLabel:g,valueLabel:f,spaceRow:m,align:y}=o,v=(0,wj.o)(u.padding),b=hM(u.padding),_=Di(Object.assign({textAlign:"right"===y?"right":"left"},c),i),C=Di(Object.assign({textAlign:"right"===y?"right":"left"},g),i),x=Di(f,i),w={fill:!0,size:null!=(r=null==p?void 0:p.size)?r:8,spacing:null!=(n=null==p?void 0:p.spacing)?n:6},S={panel:Dr(u),padding:v,title:{},content:[],titleStyle:{value:_,spaceRow:m},contentStyle:{shape:w,key:C,value:x,spaceRow:m},hasContentShape:!1,keyWidth:0,valueWidth:0,enterable:h,transitionDuration:d,align:y},{title:A={},content:M=[]}=t,T=b.left+b.right,k=b.top+b.bottom,R=0,P=!!M.length,B=0,I=0,E=0,L=0;if(P){let t=[],e=[],i=[],r=[],n=0;S.content=M.map((l,s)=>{let a=0,{hasShape:o,key:h,shapeType:d="",shapeFill:u,shapeStroke:c,shapeLineWidth:p,shapeSize:g,value:f,isKeyAdaptive:y,spaceRow:v,keyStyle:b,valueStyle:_,shapeHollow:S}=l,A={height:0,spaceRow:null!=v?v:m};if((0,aw.Z)(h)){let i=h5({},C,Di(b,void 0,{})),{width:r,height:n,text:l}=De(h,i);A.key=Object.assign(Object.assign({width:r,height:n},i),{text:l}),y?e.push(r):t.push(r),a=Math.max(a,n)}if((0,aw.Z)(f)){let t=h5({},x,Di(_,void 0,{})),{width:e,height:r,text:n}=De(f,t);A.value=Object.assign(Object.assign({width:e,height:r},t),{text:n}),i.push(e),a=Math.max(a,r)}if(o){let t={visible:!0,symbolType:d};S?t.stroke=u:t.fill=u,t.stroke=null!=c?c:u,t.lineWidth=p,A.shape=t;let e=null!=g?g:w.size;a=Math.max(e,a),r.push(e)}else A.shape={visible:!1};return A.height=a,n+=a,s<M.length-1&&(n+=A.spaceRow),A}),k+=n,B=t.length?(0,a1.CE)(t):0,I=e.length?(0,a1.CE)(e):0,E=i.length?(0,a1.CE)(i):0,R=Math.max((L=r.length?(0,a1.CE)(r)+w.spacing:0)+B+C.spacing+E+x.spacing,L+I,R),S.hasContentShape=!!r.length,S.keyWidth=B,S.valueWidth=E}let F=0,O=0,H=0,{visible:D=!0,value:z="",valueStyle:W,spaceRow:Z}=A;S.title.visible=D,S.title.spaceRow=null!=Z?Z:m;let N={},j=()=>N.autoWidth&&!1!==N.multiLine;if(D){N=h5({},_,Di(W,void 0,{})),j()&&(N.multiLine=null==(l=N.multiLine)||l,N.maxWidth=null!=(s=N.maxWidth)?s:P?Math.ceil(R):void 0);let{text:t,width:e,height:i}=De(z,N);S.title.value=Object.assign(Object.assign({width:j()?Math.min(e,null!=(a=N.maxWidth)?a:Number.MAX_VALUE):e,height:i},N),{text:t}),F=S.title.value.width,H=(O=S.title.value.height)+(P?S.title.spaceRow:0)}return k+=H,S.title.width=F,S.title.height=O,j()?T+=R||F:T+=Math.max(F,R),P&&S.content.forEach(t=>{var e;let i=t.value;i&&(null==(e=i.autoWidth)||e)&&(i.width=T-b.left-b.right-L-B-C.spacing-x.spacing,i.maxWidth||(i.maxWidth=Math.ceil(i.width)),S.valueWidth=Math.max(S.valueWidth,i.width))}),S.panel.width=T,S.panel.height=k,S};class Dl extends HY{constructor(){super(Dl.type),this.type=AG.canvas,this._attributes=null}onAdd(t){var e;super.onAdd(t),this._tooltipCanvasId=null==(e=this._chartOption.modeParams)?void 0:e.tooltipCanvasId}_initTooltipComponent(t){let e=this._getLayer(t);this._tooltipComponent=new H9({autoCalculatePosition:!1,autoMeasure:!1}),e.add(this._tooltipComponent)}_getLayer(t){if(this._layer)return this._layer;this._layer=t.createLayer(this._tooltipCanvasId);let e=this._layer.layerHandler.canvas.nativeCanvas;return e&&e.style&&(e.style.touchAction="none",e.style.pointerEvents="none"),this._layer}_getTooltipBoxSize(t,e){var i,r;if(!e||(0,nB.Z)(this._attributes)){let e=null==(i=this._chartOption)?void 0:i.getTheme("fontFamily");this._attributes=Dn(t,this._component.getSpec(),e)}let{panel:n}=null!=(r=this._attributes)?r:{};return{width:n.width+n.lineWidth,height:n.height+n.lineWidth}}_removeTooltip(){this._layer&&this._layer.removeAllChild(),this._attributes=null}_updateTooltip(t,e){this._visible=t;let i=this._compiler.getStage();if(!i)return;if(!t)return void(this._tooltipComponent&&this._tooltipComponent.attribute.visible&&(this._tooltipComponent.hideAll(),this._tooltipComponent.setAttributes({visibleAll:!1})));this._tooltipComponent||this._initTooltipComponent(i);let{activeTooltipSpec:r}=e,n=r.position;e.changePositionOnly?(0,aw.Z)(n)&&this._tooltipComponent.setAttributes(n):this._tooltipComponent.setAttributes(Object.assign(Object.assign({},this._attributes),n)),this._tooltipComponent.attribute.visible||(this._tooltipComponent.showAll(),this._tooltipComponent.setAttributes({visibleAll:!0}))}isTooltipShown(){var t;return null==(t=this._tooltipComponent)?void 0:t.attribute.visibleAll}release(){var t;super.release(),null==(t=this._layer)||t.release()}}Dl.type=AG.canvas;let Ds=()=>{H2(Dl)};var Da=i(63144),Do=i(43127);let Dh=t=>{h9.registerChartPlugin(t.type,t)},Dd=/\{([^}]+)\}/,Du=/\{([^}]+)\}/g,Dc=/:/;class Dp extends xh{constructor(){super(Dp.type),this.type="formatterPlugin",this._timeModeFormat={utc:bH.k.getInstance().timeUTCFormat,local:bH.k.getInstance().timeFormat},this._formatter=this._format,this._timeFormatter=this._timeModeFormat.local,this._numericFormatter=Da.C6.getInstance().format,this._numericSpecifier=Da.C6.getInstance().formatter,this._numericFormatterCache=new Map,this._isNumericFormatterCache=new Map}onInit(t,e){var i;let{globalInstance:r}=t;if(!r)return;this._spec=null!=(i=null==e?void 0:e[Dp.specKey])?i:{};let{timeMode:n,customFormatter:l,numericFormatter:s,timeFormatter:a}=this._spec;(0,nz.Z)(l)?this._formatter=l:(this._formatter=this._format.bind(this),(0,nz.Z)(a)?this._timeFormatter=a:n&&this._timeModeFormat[n]&&(this._timeFormatter=this._timeModeFormat[n]),s&&(this._numericFormatter=s,this._numericSpecifier=null,this._numericFormatterCache=null)),h9.registerFormatter(this._formatter)}_format(t,e,i){return(0,rD.Z)(t)?t.map((t,r)=>{let n=(0,rD.Z)(i)?i[r]:i;return n?this._formatSingleLine(t,e,n):t}):(0,rD.Z)(i)?i.map(i=>this._formatSingleLine(t,e,i)):this._formatSingleLine(t,e,i)}_formatSingleLine(t,e,i){let r;return(this._isNumericFormatterCache&&(this._isNumericFormatterCache.get(i)?r=this._isNumericFormatterCache.get(i):(r=Dd.test(i),this._isNumericFormatterCache.set(i,r))),r)?i.replace(Du,(t,i)=>{if(!Dc.test(i)){let r=e[i.trim()];return void 0!==r?r:t}let r=i.split(":"),n=e[r.shift()],l=r.join(":");return this._formatSingleText(n,l)}):this._formatSingleText(t,i)}_formatSingleText(t,e){if(Do.DC.test(e)&&this._numericFormatter){let i;return this._numericFormatterCache&&this._numericSpecifier?(this._numericFormatterCache.get(e)?i=this._numericFormatterCache.get(e):(i=this._numericSpecifier(e),this._numericFormatterCache.set(e,i)),i(Number(t))):this._numericFormatter(e,Number(t))}return e.includes("%")&&this._timeFormatter?this._timeFormatter(e,t):e.startsWith("calc(")?this._calcFormatter(e,t):t}_calcFormatter(t,e){try{let i=t.slice(5,-1).replace(/v/g,String(e));return this._calculateMathExpression(i,e)}catch(t){return e}}_calculateMathExpression(t,e){let i=t.replace(/\s+/g,"");if(!this._isValidMathExpression(i))return e;try{let t=Function("return ("+i+")")();if("number"!=typeof t||isNaN(t)||!isFinite(t))throw Error("Invalid calculation result");return t}catch(t){return e}}_isValidMathExpression(t){return/^[0-9+\-*/().]+$/.test(t)}release(){super.release(),this._format=null,this._timeFormatter=null,this._numericFormatter=null,this._numericSpecifier=null,this._numericFormatterCache=null,this._isNumericFormatterCache=null}}Dp.pluginType="chart",Dp.specKey="formatter",Dp.type="formatterPlugin";let Dg=()=>{Dh(Dp)},Df={state:td.STATE_ACTIVE,trigger:"pointerover",triggerOff:"pointerout"};class Dm extends bn{constructor(t){super(t),this.type="element-active",this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{this.reset(t.item)},this.options=Object.assign({},Df,t),this.updateMarkIdByState([this.options.state])}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}getStartState(){return this.options.state}start(t){if(t){let{state:e,interaction:i}=this.options;this.isGraphicInStateMark(t,e)&&(t.addState(e,!0),i.setStatedGraphics(this,[t]))}}reset(t){let{interaction:e,state:i}=this.options,r=e.getStatedGraphics(this),n=null!=t?t:null==r?void 0:r[0];n&&r.includes(n)&&(n.removeState(i),e.setStatedGraphics(this,r.filter(t=>t!==n)))}}Dm.type="element-active",Dm.defaultOptions=Df;let Dy=()=>{h9.registerInteractionTrigger(Dm.type,Dm)},Dv="element-active-by-legend",Db={state:td.STATE_ACTIVE,filterType:"groupKey"};class D_ extends bn{constructor(t){super(t),this.type=Dv,this.handleStart=t=>{var e,i;let r=t.event;r&&this.start(null==(i=null==(e=r.detail)?void 0:e.data)?void 0:i.id)},this.handleReset=t=>{this.resetAll()},this.options=Object.assign({},Db,t),this.updateMarkIdByState([this.options.state])}getEvents(){return[{type:J.legendItemHover,handler:this.handleStart},{type:J.legendItemUnHover,handler:this.handleReset}]}getStartState(){return this.options.state}start(t){if((0,nB.Z)(t))return;let{interaction:e,state:i}=this.options,r=bi(this.options),n=e.getStatedGraphics(this),l=[];this.getMarks().forEach(e=>{var i;null==(i=e.getGraphics())||i.forEach(e=>{r(e)===t&&l.push(e)})}),e.updateStates(this,l,n,i),e.setStatedGraphics(this,l)}resetAll(){let{interaction:t,state:e}=this.options;t.clearAllStatesOfTrigger(this,e),t.setStatedGraphics(this,[])}reset(t){let{state:e,interaction:i}=this.options;if(t){let r=i.getStatedGraphics(this);r&&r.includes(t)&&(t.removeState(e),i.setStatedGraphics(this,r.filter(e=>e!==t)))}else this.resetAll()}}D_.type=Dv,D_.defaultOptions=Db;let DC=()=>{h9.registerInteractionTrigger(Dv,D_)},Dx="element-highlight-by-legend",Dw={highlightState:td.STATE_HIGHLIGHT,blurState:td.STATE_BLUR,filterType:"groupKey"};class DS extends bn{constructor(t){super(t),this.type=Dx,this.handleStart=t=>{var e,i;let r=t.event;r&&this.start(null==(i=null==(e=r.detail)?void 0:e.data)?void 0:i.id)},this.handleReset=t=>{this.resetAll()},this.options=Object.assign({},Dw,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){return[{type:J.legendItemHover,handler:this.handleStart},{type:J.legendItemUnHover,handler:this.handleReset}]}start(t){if(t){let e=bi(this.options),{interaction:i,highlightState:r,blurState:n}=this.options,l=i.getStatedGraphics(this),s=[];this.getMarks().forEach(i=>{var r;null==(r=i.getGraphics())||r.forEach(i=>{e(i)===t&&s.push(i)})}),i.updateStates(this,s,l,r,n),i.setStatedGraphics(this,s)}}resetAll(){let{interaction:t,highlightState:e,blurState:i}=this.options;t.clearAllStatesOfTrigger(this,e,i),t.setStatedGraphics(this,[])}reset(t){let{highlightState:e,blurState:i,interaction:r}=this.options;if(t){let n=r.getStatedGraphics(this);n&&n.includes(t)&&(t.removeState([e,i]),r.setStatedGraphics(this,n.filter(e=>e!==t)))}else this.resetAll()}}DS.type=Dx,DS.defaultOptions=Dw;let DA=()=>{h9.registerInteractionTrigger(Dx,DS)},DM="element-highlight-by-name",DT={highlightState:td.STATE_HIGHLIGHT,blurState:td.STATE_BLUR,filterType:"groupKey"};class Dk extends bn{constructor(t){super(t),this.type=DM,this.handleStart=t=>{if(this.options.shouldStart?this.options.shouldStart(t):this._filterByName(t)){let e=this._parseTargetKey(t);this.start(e)}},this.handleReset=t=>{(this.options.shouldReset?this.options.shouldReset(t):this._filterByName(t))&&this.resetAll()},this.options=Object.assign({},DT,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}_filterByName(t){var e;let i=(0,a1.IX)(this.options.graphicName);return(null==(e=null==t?void 0:t.node)?void 0:e.name)&&i.includes(t.node.name)}_parseTargetKey(t){return this.options.parseData?this.options.parseData(t):"text"===t.node.type?t.node.attribute.text:null}start(t){if(t){let e=bi(this.options),{interaction:i,highlightState:r,blurState:n}=this.options,l=i.getStatedGraphics(this),s=[];this.getMarks().forEach(i=>{var r;null==(r=i.getGraphics())||r.forEach(i=>{e(i)===t&&s.push(i)})}),i.updateStates(this,s,l,r,n),i.setStatedGraphics(this,s)}}resetAll(){let{interaction:t,highlightState:e,blurState:i}=this.options;t.clearAllStatesOfTrigger(this,e,i),t.setStatedGraphics(this,[])}reset(t){let{highlightState:e,blurState:i,interaction:r}=this.options;if(t){let n=r.getStatedGraphics(this);n&&n.includes(t)&&(t.removeState([e,i]),r.setStatedGraphics(this,n.filter(e=>e!==t)))}else this.resetAll()}}Dk.type=DM,Dk.defaultOptions=DT;let DR=()=>{h9.registerInteractionTrigger(DM,Dk)},DP="element-highlight-by-group";class DB extends bn{constructor(t){super(t),this.type=DP,this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{let e=t.item;e&&this.isGraphicInMark(e)&&this.resetAll()},this.options=Object.assign({},br,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}resetAll(){let{interaction:t,highlightState:e,blurState:i}=this.options;t.clearAllStatesOfTrigger(this,e,i),t.setStatedGraphics(this,[])}_getHightlightKey(t){var e;return null==(e=t.context)?void 0:e.groupKey}start(t){if(t&&this.isGraphicInMark(t)){let e=this._getHightlightKey(t);if((0,nB.Z)(e))return;let{interaction:i,highlightState:r,blurState:n}=this.options,l=i.getStatedGraphics(this),s=[];this.getMarks().forEach(t=>{var i;null==(i=t.getGraphics())||i.forEach(t=>{this._getHightlightKey(t)===e&&s.push(t)})}),i.updateStates(this,s,l,r,n),i.setStatedGraphics(this,s)}}reset(t){if(t){if(this.isGraphicInMark(t)){let{interaction:e}=this.options,i=e.getStatedGraphics(this);t.removeState([this.options.highlightState,this.options.blurState]),e.setStatedGraphics(this,i.filter(e=>e!==t))}}else this.resetAll()}}DB.type=DP,DB.defaultOptions=br;let DI=()=>{h9.registerInteractionTrigger(DP,DB)},DE="element-highlight-by-key";class DL extends DB{constructor(){super(...arguments),this.type=DE}_getHightlightKey(t){var e;return null==(e=t.context)?void 0:e.key}}DL.type=DE;let DF=()=>{h9.registerInteractionTrigger(DE,DL)};class DO extends gW{constructor(){super(...arguments),this.type=DO.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}DO.type="image";let DH=()=>{h9.registerMark(DO.type,DO),gG(),Fw(),h9.registerGraphicComponent("image",Ch)};(ep=eN||(eN={})).group="group",ep.symbol="symbol",ep.rule="rule",ep.line="line",ep.text="text",ep.rect="rect",ep.image="image",ep.path="path",ep.area="area",ep.arc="arc",ep.polygon="polygon",ep.boxPlot="boxPlot",ep.linkPath="linkPath",ep.cell="cell",ep.ripple="ripple",ep.liquid="liquid",ep.component="component",ep.dataLabel="dataLabel",ep.label="label",ep.pictogram="pictogram";let DD=()=>{gU(),CV(),CK(),kk(),kH(),Mi(),Mw(),MJ(),TS(),RJ(),DH(),Ei(),xG()};bg.useRegisters([A0,Mu,MB,MU,TF,ka,kC,k$,Tn,Rm,RF,RO,R4,BP,Ii,k9,Ps,Pv,IN,Pj,P0,Bl,IF,IQ,kG,Ed,kS,SX,SI,Ec,Ef,Ev,T7,T9,EF,EQ,E8,La,Lg,LW,LN,L$,M8,Oh,Ox,Hl,Op,OA,Ha,Hh,Om,Oq,O4,O7,Hg,Hm,HL,Hb,DD,H5,Ds,Dg,Dy,DC,DA,DR,DI,DF,v6,yg,yc]),(eg=ej||(ej={})).vertical="vertical",eg.horizontal="horizontal";class Dz{constructor(){this.released=!1,this.currentTime=-1}tick(t,e){this.currentTime<0&&(this.currentTime=0),this.currentTime+=t,e(this)}release(){this.released=!0}getTime(){return this.currentTime}tickTo(t,e){this.currentTime<0&&(this.currentTime=0);let i=t-this.currentTime;this.tick(i,e)}}class DW extends yI{constructor(t){super(t),this.lastFrameTime=0,this.status=t$.RUNNING}setupTickHandler(){let t=new Dz;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0}checkSkip(t){return!1}getTime(){return this.tickerHandler.getTime()}tickAt(t){this.tickTo(t)}start(t=!1){return!(this.status===t$.RUNNING||!this.tickerHandler||!t&&(this.status===t$.PAUSE||this.ifCanStop()))&&(this.status=t$.RUNNING,!0)}}class DZ extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}getEndProps(){return{}}onStart(){this.target&&("rect"===this.target.type?this.onStartRect():"line"===this.target.type?this.onStartLineOrArea("line"):"area"===this.target.type&&this.onStartLineOrArea("area"))}onStartLineOrArea(t){var e;let i=this.target.attachShadow(),r=iC.graphicService.creator[t](Object.assign({},null==(e=this.params)?void 0:e.attribute));this[t]=r,r.pathProxy=new rp,i.add(r)}onStartRect(){var t,e,i;let r=this.target.attachShadow(),n=null==(e=null==(t=this.params)?void 0:t.isHorizontal)||e,l=n?"height":"width",s=this.target.AABBBounds[l](),a=n?0:this.target.AABBBounds.y1,o=iC.graphicService.creator.rect(Object.assign(Object.assign({[l]:s,fill:"#bcdeff",shadowBlur:30,shadowColor:"#bcdeff"},null==(i=this.params)?void 0:i.attribute),{x:0,y:a,[n?"width":"height"]:0}));this.rect=o,r.add(o)}onBind(){}onEnd(){this.target.detachShadow()}onUpdate(t,e,i){return this.rect?this.onUpdateRect(t,e,i):this.line||this.area?this.onUpdateLineOrArea(t,e,i):void 0}onUpdateRect(t,e,i){var r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v;let b=null==(n=null==(r=this.params)?void 0:r.isHorizontal)||n,_=this.target.attribute;if(b){let i=null!=(s=null!=(l=_.width)?l:Math.abs(_.x1-_.x))?s:250,r=null!=(o=null==(a=this.params)?void 0:a.streamLength)?o:i,n=null!=(u=null==(d=null==(h=this.params)?void 0:h.attribute)?void 0:d.width)?u:60,c=-n,p=c+(r-c)*e,g=Math.max(p,0),f=Math.min(Math.min(p+n,n),r-p),m=f+g>i?Math.max(i-g,0):f;this.rect.setAttributes({x:g+Math.min(_.x1-_.x,0),width:m},!1,{type:o3.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}else{let i,r=null!=(p=null!=(c=_.height)?c:Math.abs(_.y1-_.y))?p:250,n=null!=(f=null==(g=this.params)?void 0:g.streamLength)?f:r,l=null!=(v=null==(y=null==(m=this.params)?void 0:m.attribute)?void 0:y.height)?v:60,s=r-(n+l)*e,a=Math.min(s,r),o=Math.min(r-s,l);a<=0?(i=Math.max(a+o,0),a=0):i=o,this.rect.setAttributes({y:a+Math.min(_.y1-_.y,0),height:i},!1,{type:o3.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}}onUpdateLineOrArea(t,e,i){let r=this.line||this.area;if(!r)return;let n=r.pathProxy,l=this.target;l.cache||l.cacheArea?this._onUpdateLineOrAreaWithCache(n,l,t,e,i):this._onUpdateLineWithoutCache(n,l,t,e,i);let s=l.attribute;r.setAttributes(Object.assign({stroke:s.stroke},r.attribute)),r.addUpdateBoundTag()}_onUpdateLineOrAreaWithCache(t,e,i,r,n){var l,s;if(t.clear(),"line"===e.type){let i=e.cache;Array.isArray(i)||(i=[i]);let n=i.reduce((t,e)=>t+e.getLength(),0),l=[];return i.forEach(t=>{t.curves.forEach(t=>l.push(t))}),this._updateCurves(t,l,n,r)}if("area"===e.type&&(null==(s=null==(l=e.cacheArea)?void 0:l.top)?void 0:s.curves)){let i=e.cacheArea,n=i.top.curves.reduce((t,e)=>t+e.getLength(),0);return this._updateCurves(t,i.top.curves,n,r)}}_updateCurves(t,e,i,r){var n,l;let s=i*r,a=Math.min(s+(null!=(l=null==(n=this.params)?void 0:n.streamLength)?l:10),i),o=0,h=!1;for(let i=0;i<e.length;i++)if(!1!==e[i].defined){let r=e[i],n=r.getLength(),l=1-(o+n-s)/n,d,u=1-(o+n-a)/n;if(o<s&&o+n>s)if(h=!0,r.p2&&r.p3){let[e,i]=iq(r,l);t.moveTo(i.p0.x,i.p0.y),d=i}else{let e=r.getPointAt(l);t.moveTo(e.x,e.y)}if(o<a&&o+n>a){if(r.p2&&r.p3){d&&(u=(a-s)/d.getLength());let[e]=iq(d||r,u);t.bezierCurveTo(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y)}else{let e=r.getPointAt(u);t.lineTo(e.x,e.y)}break}if(h)if(r.p2&&r.p3){let e=d||r;t.bezierCurveTo(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y)}else t.lineTo(r.p1.x,r.p1.y);o+=n}}_onUpdateLineWithoutCache(t,e,i,r,n){var l,s;let{points:a,curveType:o}=e.attribute;if(!a||a.length<2||"linear"!==o)return;let h=0;for(let t=1;t<a.length;t++)h+=iN.HL.distancePP(a[t],a[t-1]);let d=h*r,u=Math.min(d+(null!=(s=null==(l=this.params)?void 0:l.streamLength)?s:10),h),c=[],p=0;for(let t=1;t<a.length;t++){let e=iN.HL.distancePP(a[t],a[t-1]);if(p<d&&p+e>d&&c.push(iN.HL.pointAtPP(a[t-1],a[t],1-(p+e-d)/e)),p<u&&p+e>u){c.push(iN.HL.pointAtPP(a[t-1],a[t],1-(p+e-u)/e));break}c.length&&c.push(a[t]),p+=e}if(c.length&&!(c.length<2)){t.clear(),t.moveTo(c[0].x,c[0].y);for(let e=1;e<c.length;e++)t.lineTo(c[e].x,c[e].y)}}}let DN="2.0.12";class Dj extends Ai{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["valueField","maskShape","reverse","outlineMargin","outlinePadding","indicatorSmartInvert","liquidBackground","liquidOutline"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}let DG={duration:2e3,loop:!0,channel:{wave:{from:0,to:1}}},DV=t=>({duration:2e3,channel:{wave:{from:0,to:1},height:t.height,dy:t.dy}}),DU=t=>({duration:2e3,channel:{dy:t.dy}}),DK=t=>({duration:2e3,channel:{dy:t.dy}});function DX(t,e){switch(e){case"wave":default:return DG;case"grow":case"waveGrow":return DV(t)}}function DY(t,e){switch(e){case"wave":default:return DG;case"grow":return DU(t);case"waveGrow":return DK(t)}}let D$=()=>{h9.registerAnimation("liquid",(t,e)=>({appear:DX(t,e),enter:DX(t,e),exit:DX(t,e)})),h9.registerAnimation("liquidGroup",(t,e)=>({appear:DY(t,e),enter:DY(t,e),exit:DY(t,e)}))},Dq=Object.assign(Object.assign({},b7),{liquidGroup:{name:"liquidGroup",type:"group"},liquid:{name:"liquid",type:"liquid"},liquidBackground:{name:"liquidBackground",type:"group"},liquidOutline:{name:"liquidOutline",type:"group"}});class DJ extends Bj{constructor(){super(...arguments),this.type=DJ.type,this._subMarks={wave0:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:1}},wave1:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.66}},wave2:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.33}}},this._positionChannels=["wave","y","height"],this._positionEncoder=(t,e,i)=>{let{wave:r=i.attribute.wave,y:n=i.attribute.y,height:l=i.attribute.height}=t,s=[],a=[],o=[];for(let t=0;t<21;t++){let e=50*t-500,i=n+20*(t%2==0),h=n+l;s.push({x:e+100*r,y:i,y1:h}),a.push({x:e+200*r-40,y:i,y1:h}),o.push({x:e+300*r-20,y:i,y1:h})}return{wave0:{x:0,y:0,points:s},wave1:{x:0,y:0,points:a},wave2:{x:0,y:0,points:o}}}}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{wave:0})}}DJ.type="liquid";let DQ=()=>{BG(),A9(),h9.registerMark(DJ.type,DJ),h9.registerGraphicComponent("area",t=>A3(t))},D0=(t,e)=>"drop"===t?function(t,e,i){let r=4*i/3,n=Math.max(r,2*i),l=r/2,s=l+0-n/2,a=Math.asin(l/(.85*(n-l))),o=Math.sin(a)*l,h=Math.cos(a)*l,d=0-h,u=s+o,c=s+l/Math.sin(a);return`
      M ${d} ${u}
      A ${l} ${l} 0 1 1 ${d+2*h} ${u}
      Q ${t} ${c} ${t} ${e+n/2}
      Q ${t} ${c} ${d} ${u}
      Z 
    `}(0,0,e):t;class D1 extends bY{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>this.series.getValueField(),this.markTooltipValueCallback=t=>t[this.series.getValueField()],this.shapeStrokeCallback=t=>this.series.getMarkInName("liquid").getAttribute("fill",t)}}class D2 extends _p{constructor(){super(...arguments),this.type=Y.liquid,this.transformerConstructor=CX,this._liquidBackgroundMark=null,this._liquidOutlineMark=null,this._getLiquidPosY=()=>{let t=0,{height:e,startY:i}=this._getLiquidBackPosAndSize();return(this._reverse?e*this._heightRatio:e*(1-this._heightRatio))+i},this._getLiquidHeight=()=>{let{height:t}=this._getLiquidBackPosAndSize();return t*this._heightRatio},this._getLiquidBackPosAndSize=(t=!1)=>{var e,i;let{top:r=0,bottom:n=0,left:l=0,right:s=0}=this._marginSpec,{top:a=0,bottom:o=0,left:h=0,right:d=0}=t?{}:this._paddingSpec;"triangle"===this._maskShape&&(n/=Math.sqrt(3),r=r/Math.sqrt(3)*2,o/=Math.sqrt(3),a=a/Math.sqrt(3)*2);let{width:u,height:c}=null!=(i=null==(e=this._region)?void 0:e.getLayoutRect())?i:{width:0,height:0},p=u/2+(l+h-(s+d))/2,g=c/2+(r+a-(n+o))/2,f=u-(l+s+h+d),m=c-(r+n+a+o),y=Math.min(f,m);return"rect"!==this._maskShape&&(f=y,m=y),{x:p,y:g,size:y,width:f,height:m,startX:p-f/2,startY:g-m/2,endX:p+f/2,endY:g+m/2}},this._getLiquidBackPath=(t=!1)=>{var e;let i;if("rect"===this._maskShape){let{x:e,y:r,width:n,height:l}=this._getLiquidBackPosAndSize(t);i=cN({x:e-n/2,y:r-l/2,width:n,height:l,fill:!0})}else{let{x:r,y:n,size:l}=this._getLiquidBackPosAndSize(t);i=oI({x:r,y:n,size:l,symbolType:D0(null!=(e=this._spec.maskShape)?e:"circle",l),fill:!0})}return[i]}}setValueField(t){(0,aw.Z)(t)&&(this._valueField=t)}getValueField(){return this._valueField}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this._marginSpec=hM(this._spec.outlineMargin),this._paddingSpec=hM(this._spec.outlinePadding),this.setValueField(this._spec.valueField),this._reverse=null!=(t=this._spec.reverse)&&t,this._maskShape=null!=(e=this._spec.maskShape)?e:"circle"}viewDataUpdate(t){super.viewDataUpdate(t),this._heightRatio=(0,ik.Fp)(...this._data.getLatestData().map(t=>t[this._valueField]))}initMark(){this._initLiquidOutlineMark(),this._initLiquidBackgroundMark(),this._initLiquidMark()}initMarkStyle(){this._initLiquidOutlineMarkStyle(),this._initLiquidBackgroundMarkStyle(),this._initLiquidMarkStyle()}_initLiquidOutlineMark(){return this._liquidOutlineMark=this._createMark(D2.mark.liquidOutline,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidOutlineMark}_initLiquidBackgroundMark(){return this._liquidBackgroundMark=this._createMark(D2.mark.liquidBackground,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidBackgroundMark}_initLiquidMark(){return this._liquidGroupMark=this._createMark(D2.mark.liquidGroup,{parent:this._liquidBackgroundMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark=this._createMark(D2.mark.liquid,{parent:this._liquidGroupMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getLiquidBackPosAndSize=this._getLiquidBackPosAndSize,this._markAttributeContext.getLiquidPosY=this._getLiquidPosY,this._markAttributeContext.getLiquidHeight=this._getLiquidHeight}_initLiquidOutlineMarkStyle(){let t=this._liquidOutlineMark;t.created(),this.setMarkStyle(t,{stroke:this.getColorAttribute(),width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,path:()=>this._getLiquidBackPath(!0)},"normal",to.Series),this._liquidOutlineMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex})}_initLiquidBackgroundMarkStyle(){let t=this._liquidBackgroundMark;t.created(),this.setMarkStyle(t,{width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,path:()=>this._getLiquidBackPath()},"normal",to.Series),this._liquidBackgroundMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0})}_initLiquidMarkStyle(){let t=this._liquidMark,e=this._liquidGroupMark;e&&this.setMarkStyle(e,{x:()=>this._region.getLayoutStartPoint().x+this._region.getLayoutRect().width/2,angle:this._reverse?-Math.PI:0,y:0,dy:this._getLiquidPosY}),t&&this.setMarkStyle(t,{y:0,dy:0,height:this._getLiquidHeight,fill:this.getColorAttribute(),wave:0},"normal",to.Series)}initTooltip(){this._tooltipHelper=new D1(this),this._liquidMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._liquidMark)}getInteractionTriggers(){return this._parseInteractionConfig(this._liquidMark?[this._liquidMark]:[])}initAnimation(){var t,e,i,r;let n={height:{from:0,to:()=>this._getLiquidHeight()},dy:{from:()=>{let t=0,{height:e,startY:i}=this._getLiquidBackPosAndSize();return(this._reverse?0:e)+i}}},l=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._liquidMark.setAnimationConfig(_l(null==(i=h9.getAnimationInKey("liquid"))?void 0:i(n,l),_s("liquid",this._spec,this._markAttributeContext))),this._liquidGroupMark.setAnimationConfig(_l(null==(r=h9.getAnimationInKey("liquidGroup"))?void 0:r(n,l),_s("liquidGroup",this._spec,this._markAttributeContext)))}initEvent(){super.initEvent(),this._spec.indicatorSmartInvert&&this._option.getChart().getComponentsByKey("indicator")&&this.event.on(J.renderFinished,()=>{this._option.getChart().getComponentsByKey("indicator").forEach(t=>{var e,i,r;let n=null==(e=this._liquidMark.getGraphics()[0].getSubGraphic())?void 0:e[0],{y1:l,y2:s}=n.globalAABBBounds;l+=this._region.getLayoutStartPoint().y,s+=this._region.getLayoutStartPoint().y,null==(r=null==(i=null==t?void 0:t.getIndicatorComponent())?void 0:i.getChildren()[0])||r.getChildren().forEach(t=>{let{y1:e,y2:i}=t.globalAABBBounds;if(l<e&&s>i){let e=_j(t.attribute.fill,n.attribute.fill);t.setAttribute("fill",e)}})})})}dataToPosition(t){return null}dataToPositionX(t){return null}dataToPositionY(t){return null}valueToPosition(t,e){return null}getStatisticFields(){return[]}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}getActiveMarks(){return[this._liquidMark]}}D2.type=Y.liquid,D2.mark=Dq,D2.builtInTheme={liquid:{outlinePadding:10,liquidBackground:{style:{lineWidth:0,fillOpacity:.2}},liquidOutline:{style:{lineWidth:2}}}},D2.transformerConstructor=CX;let D3=()=>{DQ(),gU(),D$(),h9.registerSeries(D2.type,D2)};class D5 extends Ah{constructor(){super(...arguments),this.transformerConstructor=Dj,this.type="liquid",this.seriesType=Y.liquid}}D5.type="liquid",D5.seriesType=Y.liquid,D5.transformerConstructor=Dj;let D4=()=>{A$(),D3(),h9.registerChart(D5.type,D5)},D6=t=>(0,a1.IX)(t).join(",");class D7 extends bY{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=t=>D6(null==t?void 0:t[this.series.getDimensionField()[0]]),this.markTooltipKeyCallback=t=>D6(null==t?void 0:t[this.series.getDimensionField()[0]])}}let D8=Object.assign(Object.assign({},b7),{circle:{name:"circle",type:"arc"},overlap:{name:"overlap",type:"path"},overlapLabel:{name:"overlapLabel",type:"text"}});var D9=i(61369);let zt=Math.sqrt,ze=Math.pow;function zi(t,e){let i=0;for(let r=0;r<t.length;++r)i+=t[r]*e[r];return i}class zr{constructor(t=0,e=0,i,r){this.x=0,this.y=0,this.x=t,this.y=e,this.x1=i,this.y1=r}clone(){return new zr(this.x,this.y)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}set(t,e){return this.x=t,this.y=e,this}add(t){return(0,D9.Z)(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}sub(t){return(0,D9.Z)(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}multi(t){throw Error("暂不支持")}div(t){throw Error("暂不支持")}}class zn{static distancePP(t,e){return zt(ze(t.x-e.x,2)+ze(t.y-e.y,2))}static distanceNN(t,e,i,r){return zt(ze(t-i,2)+ze(e-r,2))}static distancePN(t,e,i){return zt(ze(e-t.x,2)+ze(i-t.y,2))}static pointAtPP(t,e,i){return new zr((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}function zl(t,e){let i=function(t){let e=[];for(let i=0;i<t.length;++i)for(let r=i+1;r<t.length;++r){let n=zo(t[i],t[r]);for(let t=0;t<n.length;++t){let l=n[t];l.parentIndex=[i,r],e.push(l)}}return e}(t),r=i.filter(function(e){var i=e,r=t;for(let t=0;t<r.length;++t)if(zn.distancePP(i,r[t])>r[t].radius+1e-10)return!1;return!0}),n=0,l=0,s=[];if(r.length>1){let e=zh(r);for(let t=0;t<r.length;++t){let i=r[t];i.angle=Math.atan2(i.x-e.x,i.y-e.y)}r.sort(function(t,e){return e.angle-t.angle});let i=r[r.length-1];for(let e=0;e<r.length;++e){let a=r[e];l+=(i.x+a.x)*(a.y-i.y);let o={x:(a.x+i.x)/2,y:(a.y+i.y)/2},h=null;for(let e=0;e<a.parentIndex.length;++e)if(i.parentIndex.indexOf(a.parentIndex[e])>-1){let r=t[a.parentIndex[e]],n=Math.atan2(a.x-r.x,a.y-r.y),l=Math.atan2(i.x-r.x,i.y-r.y),s=l-n;s<0&&(s+=2*Math.PI);let d=l-s/2,u=zn.distancePP(o,{x:r.x+r.radius*Math.sin(d),y:r.y+r.radius*Math.cos(d)});u>2*r.radius&&(u=2*r.radius),(null===h||h.width>u)&&(h={circle:r,width:u,p1:a,p2:i})}null!==h&&(s.push(h),n+=zs(h.circle.radius,h.width),i=a)}}else{let e=t[0];for(let i=1;i<t.length;++i)t[i].radius<e.radius&&(e=t[i]);let i=!1;for(let r=0;r<t.length;++r)if(zn.distancePP(t[r],e)>Math.abs(e.radius-t[r].radius)){i=!0;break}i?n=l=0:(n=e.radius*e.radius*Math.PI,s.push({circle:e,p1:{x:e.x,y:e.y+e.radius},p2:{x:e.x-1e-10,y:e.y+e.radius},width:2*e.radius}))}return l/=2,e&&(e.area=n+l,e.arcArea=n,e.polygonArea=l,e.arcs=s,e.innerPoints=r,e.intersectionPoints=i),n+l}function zs(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function za(t,e,i){return i>=t+e?0:i<=Math.abs(t-e)?Math.PI*Math.min(t,e)*Math.min(t,e):zs(t,t-(i*i-e*e+t*t)/(2*i))+zs(e,e-(i*i-t*t+e*e)/(2*i))}function zo(t,e){let i=zn.distancePP(t,e),r=t.radius,n=e.radius;if(i>=r+n||i<=Math.abs(r-n))return[];let l=(r*r-n*n+i*i)/(2*i),s=Math.sqrt(r*r-l*l),a=t.x+l*(e.x-t.x)/i,o=t.y+l*(e.y-t.y)/i,h=-(e.y-t.y)*(s/i),d=-(e.x-t.x)*(s/i);return[{x:a+h,y:o-d},{x:a-h,y:o+d}]}function zh(t){let e={x:0,y:0};for(let i=0;i<t.length;++i)e.x+=t[i].x,e.y+=t[i].y;return e.x/=t.length,e.y/=t.length,e}let zd=t=>{let e={},i=Object.values(t);if(!i.length)return[];zl(i,e);let r=e.arcs.map(({p1:t,p2:e,circle:i,width:r})=>({p1:t,p2:e,radius:i.radius,setId:i.setId,largeArcFlag:r>i.radius})),n=[],l=0,s=r[0];for(;l<r.length&&s;){let{p2:t}=s;n.push(s),s=r.find(e=>1e-10>zn.distancePP(e.p1,t)),l++}return n},zu=t=>{if(!(null==t?void 0:t.length))return"";let e=0,i=t[0],{p1:r}=i,n=`M${r.x},${r.y}`;for(;i;){let{p2:r,radius:l,largeArcFlag:s}=i;n+=`A${l},${l} 0 ${+!!s},0 ${r.x},${r.y}`,i=t[++e]}return n+" Z"},zc=t=>{let e=[],i=t.split("A"),r=i[0],n=r.indexOf(",");for(e.push({p1:{x:+r.slice(1,n),y:+r.slice(n+1)}}),n=1;n<i.length;n++){let t=i[n].split(",");e[n-1].radius=+t[0];let r=+t[2].slice(2),l=+t[3].split(" ")[0];e[n-1].p2={x:r,y:l},e[n-1].largeArcFlag="1"===t[1][t[1].length-1],n<i.length-1&&e.push({p1:{x:r,y:l}})}return e},zp=t=>{var e;return null!=(e=null==t?void 0:t.map(t=>{var e,i;let{p1:r,p2:n,radius:l,largeArcFlag:s,setId:a}=t,{x:o,y:h}=r,{x:d,y:u}=n,c=((d-o)**2+(u-h)**2)**.5,p=(o+d)/2,g=(h+u)/2,f=(l**2-(c/2)**2)**.5,m=p+f*(u-h)/c,y=g-f*(d-o)/c;return e=[d-o,u-h],i=[m-o,y-h],(e[0]*i[1]-e[1]*i[0]>0||s)&&(m=p-f*(u-h)/c,y=g+f*(d-o)/c),{x:m,y:y,radius:l,setId:a}}))?e:[]},zg=t=>{switch(t){case"fadeIn":default:return{type:"fadeIn"};case"growIn":return{type:"growRadiusIn"};case"scaleIn":return{type:"scaleIn"}}},zf=t=>{switch(t){case"fadeIn":default:return{type:"fadeIn"};case"scaleIn":return{type:"scaleIn"}}};class zm extends gg{onBind(){var t,e;this.fromCircles={},null==(t=zp(this.target.attribute.arcs))||t.forEach(t=>{this.fromCircles[t.setId]=t}),this.toCircles={},null==(e=zp(this.target.getFinalAttribute().arcs))||e.forEach(t=>{this.toCircles[t.setId]=t})}onUpdate(t,e,i){let r=[];Object.keys(this.fromCircles).forEach(t=>{let i=this.fromCircles[t],n=this.toCircles[t];i&&n&&r.push({radius:i.radius+(n.radius-i.radius)*e,x:i.x+(n.x-i.x)*e,y:i.y+(n.y-i.y)*e,setId:t})});let n=zd(r);this.target.setAttributes({arcs:n,path:zu(n)})}}let zy=()=>{h9.registerAnimation("vennCircle",(t,e)=>({appear:zg(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{duration:vV.disappear.duration}})),h9.registerAnimation("vennOverlap",(t,e)=>({appear:zf(e),update:{custom:zm},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{duration:vV.disappear.duration}}))};class zv extends _c{_transformLabelSpec(t){this._addMarkLabelSpec(t,"circle"),this._addMarkLabelSpec(t,"overlap","overlapLabel","initOverlapLabelMarkStyle")}}var zb=i(9706),z_=i(50890),zC=i(58862);let zx=t=>({}).toString.call(t).replace(/^\[object /,"").replace(/]$/,""),zw=Object.prototype,zS=function(t){let e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||zw)},zA=Object.prototype.hasOwnProperty,zM=function(t){if((0,z_.Z)(t))return!0;if((0,zC.Z)(t))return!t.length;let e=zx(t);if("Map"===e||"Set"===e)return!t.size;if(zS(t))return!Object.keys(t).length;for(let e in t)if(zA.call(t,e))return!1;return!0};function zT(t,e){let i=0;for(let r=0;r<e.length;++r){let n,l=e[r];if(1!==l.sets.length){if(2===l.sets.length){let e=t[l.sets[0]],i=t[l.sets[1]];n=za(e.radius,i.radius,zn.distancePP(e,i))}else n=zl(l.sets.map(function(e){return t[e]}));i+=(l.hasOwnProperty("weight")?l.weight:1)*(n-l.size)*(n-l.size)}}return i}var zk=i(45501);function zR(t){let e=Array(t);for(let i=0;i<t;++i)e[i]=0;return e}function zP(t,e){return zR(t).map(function(){return zR(e)})}function zB(t){return Math.sqrt(zi(t,t))}function zI(t,e,i){for(let r=0;r<e.length;++r)t[r]=e[r]*i}function zE(t,e,i,r,n){for(let l=0;l<t.length;++l)t[l]=e*i[l]+r*n[l]}function zL(t,e,i){return Math.min(t,e)*Math.min(t,e)*Math.PI<=i+1e-10?Math.abs(t-e):(0,zk.Hr)(function(r){return za(t,e,r)-i},0,t+e)}var zF=i(89079);function zO(t,e,i){let r,n=(i=i||{}).maxIterations||200*e.length,l=i.nonZeroDelta||1.05,s=i.zeroDelta||.001,a=i.minErrorDelta||1e-6,o=i.minErrorDelta||1e-5,h=void 0!==i.rho?i.rho:1,d=void 0!==i.chi?i.chi:2,u=void 0!==i.psi?i.psi:-.5,c=void 0!==i.sigma?i.sigma:.5,p=e.length,g=Array(p+1);g[0]=e,g[0].fx=t(e),g[0].id=0;for(let i=0;i<p;++i){let r=e.slice();r[i]=r[i]?r[i]*l:s,g[i+1]=r,g[i+1].fx=t(r),g[i+1].id=i+1}function f(t){for(let e=0;e<t.length;e++)g[p][e]=t[e];g[p].fx=t.fx}let m=function(t,e){return t.fx-e.fx},y=e.slice(),v=e.slice(),b=e.slice(),_=e.slice();for(let e=0;e<n;++e){if(g.sort(m),i.history){let t=g.map(function(t){let e=t.slice();return e.fx=t.fx,e.id=t.id,e});t.sort(function(t,e){return t.id-e.id}),i.history.push({x:g[0].slice(),fx:g[0].fx,simplex:t})}r=0;for(let t=0;t<p;++t)r=Math.max(r,Math.abs(g[0][t]-g[1][t]));if(Math.abs(g[0].fx-g[p].fx)<a&&r<o)break;for(let t=0;t<p;++t){y[t]=0;for(let e=0;e<p;++e)y[t]+=g[e][t];y[t]/=p}let e=g[p];if(zE(v,1+h,y,-h,e),v.fx=t(v),v.fx<g[0].fx)zE(_,1+d,y,-d,e),_.fx=t(_),f(_.fx<v.fx?_:v);else if(v.fx>=g[p-1].fx){let i=!1;if(v.fx>e.fx?(zE(b,1+u,y,-u,e),b.fx=t(b),b.fx<e.fx?f(b):i=!0):(zE(b,1-u*h,y,u*h,e),b.fx=t(b),b.fx<v.fx?f(b):i=!0),i){if(c>=1)break;for(let e=1;e<g.length;++e)zE(g[e],1-c,g[0],c,g[e]),g[e].fx=t(g[e])}}else f(v)}return g.sort(m),{fx:g[0].fx,x:g[0]}}function zH(t,e){let i=function(t,e){let i=e&&e.lossFunction?e.lossFunction:zT,r={},n={};for(let e=0;e<t.length;++e){let i=t[e];if(1===i.sets.length){let t=i.sets[0];r[t]={x:1e10,y:1e10,size:i.size,radius:Math.sqrt(i.size/Math.PI),setId:t},n[t]=[]}}t=t.filter(function(t){return 2===t.sets.length});for(let e=0;e<t.length;++e){let i=t[e],l=i.hasOwnProperty("weight")?i.weight:1,s=i.sets[0],a=i.sets[1];i.size+1e-10>=Math.min(r[s].size,r[a].size)&&(l=0),n[s].push({set:a,size:i.size,weight:l}),n[a].push({set:s,size:i.size,weight:l})}let l=[];for(let t in n)if(n.hasOwnProperty(t)){let e=0;for(let i=0;i<n[t].length;++i)e+=n[t][i].size*n[t][i].weight;l.push({set:t,size:e})}function s(t,e){return e.size-t.size}l.sort(s);let a={};function o(t){return t.set in a}function h(t,e){r[e].x=t.x,r[e].y=t.y,a[e]=!0}h({x:0,y:0},l[0].set);for(let e=1;e<l.length;++e){let a=l[e].set,d=n[a].filter(o),u=r[a];if(d.sort(s),0===d.length)throw"ERROR: missing pairwise overlap information";let c=[];for(let t=0;t<d.length;++t){let e=r[d[t].set],i=zL(u.radius,e.radius,d[t].size);c.push({x:e.x+i,y:e.y}),c.push({x:e.x-i,y:e.y}),c.push({y:e.y+i,x:e.x}),c.push({y:e.y-i,x:e.x});for(let n=t+1;n<d.length;++n){let t=r[d[n].set],l=zL(u.radius,t.radius,d[n].size),s=zo({x:e.x,y:e.y,radius:i},{x:t.x,y:t.y,radius:l});for(let t=0;t<s.length;++t)c.push(s[t])}}let p=1e50,g=c[0];for(let e=0;e<c.length;++e){r[a].x=c[e].x,r[a].y=c[e].y;let n=i(r,t);n<p&&(p=n,g=c[e])}h(g,a)}return r}(t,e),r=e.lossFunction||zT;if(t.length>=8){let n=function(t,e){let i,r,n,l=(e=e||{}).restarts||10,s=[],a={};for(i=0;i<t.length;++i){let e=t[i];1===e.sets.length&&(a[e.sets[0]]=s.length,s.push(e))}let o=function(t,e,i){let r=zP(e.length,e.length),n=zP(e.length,e.length);return t.filter(function(t){return 2===t.sets.length}).map(t=>{let l=i[t.sets[0]],s=i[t.sets[1]],a=zL(Math.sqrt(e[l].size/Math.PI),Math.sqrt(e[s].size/Math.PI),t.size);r[l][s]=r[s][l]=a;let o=0;t.size+1e-10>=Math.min(e[l].size,e[s].size)?o=1:t.size<=1e-10&&(o=-1),n[l][s]=n[s][l]=o}),{distances:r,constraints:n}}(t,s,a),h=o.distances,d=o.constraints,u=zB(h.map(zB))/h.length;h=h.map(t=>t.map(t=>t/u));let c=function(t,e){return function(t,e,i,r){let n,l=0;for(n=0;n<e.length;++n)e[n]=0;for(n=0;n<i.length;++n){let s=t[2*n],a=t[2*n+1];for(let o=n+1;o<i.length;++o){let h=t[2*o],d=t[2*o+1],u=i[n][o],c=r[n][o],p=(h-s)*(h-s)+(d-a)*(d-a),g=Math.sqrt(p),f=p-u*u;c>0&&g<=u||c<0&&g>=u||(l+=2*f*f,e[2*n]+=4*f*(s-h),e[2*n+1]+=4*f*(a-d),e[2*o]+=4*f*(h-s),e[2*o+1]+=4*f*(d-a))}}return l}(t,e,h,d)};for(i=0;i<l;++i)n=function(t,e,i){let r={x:e.slice(),fx:0,fxprime:e.slice()},n={x:e.slice(),fx:0,fxprime:e.slice()},l=e.slice(),s,a=1,o=(i=i||{}).maxIterations||20*e.length;r.fx=t(r.x,r.fxprime);let h=r.fxprime.slice();zI(h,r.fxprime,-1);for(let e=0;e<o;++e){if(a=function(t,e,i,r,n,l,s){let a=i.fx,o=zi(i.fxprime,e),h=a,d=a,u=o,c=0;function p(d,c,p){for(let g=0;g<16;++g)if(n=(d+c)/2,zE(r.x,1,i.x,n,e),h=r.fx=t(r.x,r.fxprime),u=zi(r.fxprime,e),h>a+l*n*o||h>=p)c=n;else{if(Math.abs(u)<=-s*o)return n;u*(c-d)>=0&&(c=d),d=n,p=h}return 0}n=n||1,l=l||1e-6,s=s||.1;for(let g=0;g<10;++g){if(zE(r.x,1,i.x,n,e),h=r.fx=t(r.x,r.fxprime),u=zi(r.fxprime,e),h>a+l*n*o||g&&h>=d)return p(c,n,d);if(Math.abs(u)<=-s*o)break;if(u>=0)return p(n,c,h);d=h,c=n,n*=2}return n}(t,h,r,n,a),i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:a}),a){zE(l,1,n.fxprime,-1,r.fxprime);let t=zi(r.fxprime,r.fxprime);zE(h,Math.max(0,zi(l,n.fxprime)/t),h,-1,n.fxprime),s=r,r=n,n=s}else zI(h,r.fxprime,-1);if(1e-5>=zB(r.fxprime))break}return i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:a}),r}(c,zR(2*h.length).map((t,e)=>(0,zF.b8)(e)),e),(!r||n.fx<r.fx)&&(r=n);let p=r.x,g={};for(i=0;i<s.length;++i){let t=s[i];g[t.sets[0]]={x:p[2*i]*u,y:p[2*i+1]*u,radius:Math.sqrt(t.size/Math.PI)}}if(e.history)for(i=0;i<e.history.length;++i)zI(e.history[i].x,u);return g}(t,e);r(n,t)+1e-8<r(i,t)&&(i=n)}return i}function zD(t){let e=function(e){return{max:Math.max.apply(null,t.map(function(t){return t[e]+t.radius})),min:Math.min.apply(null,t.map(function(t){return t[e]-t.radius}))}};return{xRange:e("x"),yRange:e("y")}}var zz=i(37258);function zW(t,e,i){let r,n,l=e[0].radius-zn.distancePP(e[0],t);for(r=1;r<e.length;++r)(n=e[r].radius-zn.distancePP(e[r],t))<=l&&(l=n);for(r=0;r<i.length;++r)(n=zn.distancePP(i[r],t)-i[r].radius)<=l&&(l=n);return l}let zZ=(t,e)=>{let{x0:i,x1:r,y0:n,y1:l,setField:s="sets",valueField:a="size",orientation:o=Math.PI/2,orientationOrder:h=null,emptySetKey:d}=t,u={},c={},p=e.some(t=>{let e=(0,zb.IX)(t[s]);return!e||0===e.length}),g=p?e.filter(t=>!zM((0,zb.IX)(t[s]))):e;if(g.length>0){let e=g.map(t=>({sets:(0,zb.IX)(t[s]),size:t[a]})),d=function(t,e){(e=e||{}).maxIterations=e.maxIterations||500;let i=e.initialLayout||zH,r=e.lossFunction||zT,n=i(t=function(t){t=t.slice();let e=[],i={};for(let r=0;r<t.length;++r){let n=t[r];if(1===n.sets.length)e.push(n.sets[0]);else if(2===n.sets.length){let t=n.sets[0],e=n.sets[1];i[[t,e].toString()]=!0,i[[e,t].toString()]=!0}}e.sort(function(t,e){return+(t>e)});for(let r=0;r<e.length;++r){let n=e[r];for(let l=r+1;l<e.length;++l){let r=e[l];[n,r].toString()in i||t.push({sets:[n,r],size:0})}}return t}(t),e),l=[],s=[];for(let t in n)n.hasOwnProperty(t)&&(l.push(n[t].x),l.push(n[t].y),s.push(t));let a=zO(function(e){let i={};for(let t=0;t<s.length;++t){let r=s[t];i[r]={x:e[2*t],y:e[2*t+1],radius:n[r].radius}}return r(i,t)},l,e).x;for(let t=0;t<s.length;++t){let e=s[t];n[e].x=a[2*t],n[e].y=a[2*t+1]}return n}(e,t);c=function(t,e){let i={},r=function(t){let e={},i=[];for(let r in t)i.push(r),e[r]=[];for(let r=0;r<i.length;r++){let n=t[i[r]];for(let l=r+1;l<i.length;++l){let s=t[i[l]],a=zn.distancePP(n,s);a+s.radius<=n.radius+1e-10?e[i[l]].push(i[r]):a+n.radius<=s.radius+1e-10&&e[i[r]].push(i[l])}}return e}(t);for(let n=0;n<e.length;++n){let l=e[n].sets,s={},a={};for(let t=0;t<l.length;++t){s[l[t]]=!0;let e=r[l[t]];for(let t=0;t<e.length;++t)a[e[t]]=!0}let o=[],h=[];for(let e in t)e in s?o.push(t[e]):e in a||h.push(t[e]);let d=function t(e,i){let r=[];for(let t=0;t<e.length;++t){let i=e[t];r.push({x:i.x,y:i.y}),r.push({x:i.x+i.radius/2,y:i.y}),r.push({x:i.x-i.radius/2,y:i.y}),r.push({x:i.x,y:i.y+i.radius/2}),r.push({x:i.x,y:i.y-i.radius/2})}let n=r[0],l=zW(r[0],e,i);for(let t=1;t<r.length;++t){let s=zW(r[t],e,i);s>=l&&(n=r[t],l=s)}let s=zO(function(t){return -1*zW({x:t[0],y:t[1]},e,i)},[n.x,n.y],{maxIterations:500,minErrorDelta:1e-10}).x,a={x:s[0],y:s[1]},o=!0;for(let t=0;t<e.length;++t)if(zn.distancePP(a,e[t])>e[t].radius){o=!1;break}for(let t=0;t<i.length;++t)if(zn.distancePP(a,i[t])<i[t].radius){o=!1;break}if(!o)if(1===e.length)a={x:e[0].x,y:e[0].y};else{let r={};zl(e,r),a=0===r.arcs.length?{x:0,y:-1e3,disjoint:!0}:1===r.arcs.length?{x:r.arcs[0].circle.x,y:r.arcs[0].circle.y}:i.length?t(e,[]):zh(r.arcs.map(function(t){return t.p1}))}return a}(o,h);i[l.toString()]=d,d.disjoint&&e[n].size>0&&zz.Y.getInstance().error("Area "+l+" not represented on screen")}return i}(u=function(t,e,i,r,n,l=!1){let s;e=Math.max(e,1),i=Math.max(i,1);let a=[],o=[];for(let e in t)t.hasOwnProperty(e)&&(o.push(e),a.push(t[e]));let h=zD(a),d=h.xRange,u=h.yRange;if(d.max===d.min||u.max===u.min)return console.log("not scaling solution: zero size detected"),t;let c=e/(d.max-d.min),p=i/(u.max-u.min);if(l){let t=Math.min(e,i)/2,r=(d.min+d.max)/2,n=(u.min+u.max)/2,l=0;for(let t of a)l=Math.max(l,Math.sqrt(Math.pow(t.x-r,2)+Math.pow(t.y-n,2))+t.radius);s=t/l}else s=Math.min(p,c);let g=(e-(d.max-d.min)*s)/2,f=(i-(u.max-u.min)*s)/2,m={};for(let t=0;t<a.length;++t){let e=a[t];m[o[t]]={radius:s*e.radius,x:r+g+(e.x-d.min)*s,y:n+f+(e.y-u.min)*s,setId:e.setId}}return m}(d=function(t,e,i){null===e&&(e=Math.PI/2);let r=[];for(let e in t)if(t.hasOwnProperty(e)){let i=t[e];r.push({x:i.x,y:i.y,radius:i.radius,setId:e})}let n=function(t){let e;function i(t){return t.parent!==t&&(t.parent=i(t.parent)),t.parent}t.map(function(t){t.parent=t});for(let e=0;e<t.length;++e)for(let l=e+1;l<t.length;++l){var r,n;let s=t[e].radius+t[l].radius;zn.distancePP(t[e],t[l])+1e-10<s&&(r=t[l],n=t[e],i(r).parent=i(n))}let l={};for(let r=0;r<t.length;++r)(e=i(t[r]).parent.setId)in l||(l[e]=[]),l[e].push(t[r]);t.map(function(t){delete t.parent});let s=[];for(e in l)l.hasOwnProperty(e)&&s.push(l[e]);return s}(r);for(let t=0;t<n.length;++t){!function(t,e,i){let r;if(null===i?t.sort(function(t,e){return e.radius-t.radius}):t.sort(i),t.length>0){let e=t[0].x,i=t[0].y;for(r=0;r<t.length;++r)t[r].x-=e,t[r].y-=i}if(2===t.length&&zn.distancePP(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y),t.length>1){let i,n,l=Math.atan2(t[1].x,t[1].y)-e,s=Math.cos(l),a=Math.sin(l);for(r=0;r<t.length;++r)i=t[r].x,n=t[r].y,t[r].x=s*i-a*n,t[r].y=a*i+s*n}if(t.length>2){let i=Math.atan2(t[2].x,t[2].y)-e;for(;i<0;)i+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI;if(i>Math.PI){let e=t[1].y/(1e-10+t[1].x);for(r=0;r<t.length;++r){let i=(t[r].x+e*t[r].y)/(1+e*e);t[r].x=2*i-t[r].x,t[r].y=2*i*e-t[r].y}}}}(n[t],e,i);let r=zD(n[t]);n[t].size=(r.xRange.max-r.xRange.min)*(r.yRange.max-r.yRange.min),n[t].bounds=r}n.sort(function(t,e){return e.size-t.size});let l=(r=n[0]).bounds,s=(l.xRange.max-l.xRange.min)/50;function a(t,e,i){let n,a,o;if(!t)return;let h=t.bounds;e?n=l.xRange.max-h.xRange.min+s:(n=l.xRange.max-h.xRange.max,(o=(h.xRange.max-h.xRange.min)/2-(l.xRange.max-l.xRange.min)/2)<0&&(n+=o)),i?a=l.yRange.max-h.yRange.min+s:(a=l.yRange.max-h.yRange.max,(o=(h.yRange.max-h.yRange.min)/2-(l.yRange.max-l.yRange.min)/2)<0&&(a+=o));for(let e=0;e<t.length;++e)t[e].x+=n,t[e].y+=a,r.push(t[e])}let o=1;for(;o<n.length;)a(n[o],!0,!1),a(n[o+1],!1,!0),a(n[o+2],!0,!0),o+=3,l=zD(r);let h={};for(let t=0;t<r.length;++t)h[r[t].setId]=r[t];return h}(d,o,h),r-i,l-n,i,n,p),e)}return e.map(t=>{let e=(0,zb.IX)(t[s]);if(!e||0===e.length)return Object.assign(Object.assign({},t),{datum:t,sets:e,key:d||"others",size:t[a],labelX:void 0,labelY:void 0,type:"circle",x:i+(r-i)/2,y:n+(l-n)/2,radius:Math.min(r-i,l-n)/2});let o=e.toString(),h=c[o],p=Object.assign(Object.assign({},t),{datum:t,sets:e,key:o,size:t[a],labelX:null==h?void 0:h.x,labelY:null==h?void 0:h.y}),g=u[o];if(g)return Object.assign(Object.assign({},p),{type:"circle",x:g.x,y:g.y,radius:g.radius});let f=zd(e.map(t=>u[t]));return Object.assign(Object.assign({},p),{type:"overlap",x:0,y:0,path:zu(f),arcs:f})})},zN=(t,e)=>e.filter(e=>e.type===t.datumType),zj=(t,e)=>{let i=e.getViewBox();return i&&(null==t?void 0:t.length)?zZ(Object.assign({setField:e.setField,valueField:e.valueField},i),t):[]};class zG extends _p{constructor(){super(...arguments),this.type=Y.venn,this.transformerConstructor=zv,this._viewBox=new iI.YZ}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec(),this.setCategoryField(null!=(t=this._spec.categoryField)?t:"sets"),this.setValueField(null!=(e=this._spec.valueField)?e:"size"),this.setSeriesField(null!=(i=this._spec.seriesField)?i:un)}initData(){var t;super.initData(),dL(this._dataSet,"venn",zj),null==(t=this._data.getDataView())||t.transform({type:"venn",options:{getViewBox:()=>this._viewBox.empty()?null:{x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2},setField:this._categoryField,valueField:this._valueField}})}compile(){super.compile(),this._runVennTransform()}_runVennTransform(t=!1){this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()}initMark(){let t=this._createMark(zG.mark.circle,{isSeriesMark:!0});t&&(t.setTransform([{type:"vennMark",datumType:"circle"}]),this._circleMark=t);let e=this._createMark(zG.mark.overlap,{isSeriesMark:!0});e&&(e.setTransform([{type:"vennMark",datumType:"overlap"}]),this._overlapMark=e)}initMarkStyle(){this._initCircleMarkStyle(),this._initOverlapMarkStyle()}_initCircleMarkStyle(){this._circleMark&&this.setMarkStyle(this._circleMark,{x:t=>t.x,y:t=>t.y,innerRadius:0,outerRadius:t=>t.radius,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),stroke:this.getColorAttribute()},td.STATE_NORMAL,to.Series)}_initOverlapMarkStyle(){this._overlapMark&&(this.setMarkStyle(this._overlapMark,{x:t=>t.x,y:t=>t.y,path:t=>t.path,arcs:t=>t.arcs,fill:this.getColorAttribute(),stroke:this.getColorAttribute(),zIndex:t=>100*t.sets.length},td.STATE_NORMAL,to.Series),this.setMarkStyle(this._overlapMark,{zIndex:t=>100*t.sets.length+1},td.STATE_HOVER,to.Series))}initLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("venn"),this.setMarkStyle(t,{x:t=>t.labelX,y:t=>t.labelY,text:t=>D6(t.sets),maxLineWidth:t=>{let{x:e,radius:i,labelX:r}=t;return Math.min(r-(e-i),e+i-r)}},td.STATE_NORMAL,to.Series))}initOverlapLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("venn"),this.setMarkStyle(t,{x:t=>t.labelX,y:t=>t.labelY,text:t=>D6(t.sets)},td.STATE_NORMAL,to.Series))}initTooltip(){this._tooltipHelper=new D7(this),this._circleMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circleMark),this._overlapMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._overlapMark)}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runVennTransform()}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._circleMark,this._overlapMark]}getStatisticFields(){let t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}getGroupFields(){return null}dataToPosition(t,e){return{x:t.x,y:t.y}}dataToPositionX(t){return t.x}dataToPositionY(t){return t.y}valueToPosition(t,e){throw Error("Method not implemented.")}getStackGroupFields(){return[]}getStackValueField(){return null}_getSeriesInfo(t,e){let i=this.getDefaultShapeType();return e.map(e=>({key:D6(e),originalKey:e,style:this.getSeriesStyle({[t]:e}),shapeType:i}))}getSeriesFieldValue(t,e){return D6(super.getSeriesFieldValue(t,e))}legendSelectedFilter(t,e){if(t.type===oQ.discreteLegend){let i=t.getLegendDefaultData(!0);if(0===e.length&&i.length)return[];if(e.length===i.length)return e;let r={};e.forEach(t=>{r[t]=!0});let n=i.filter(t=>!r[D6(t)]),l=i.filter(t=>!n.includes(t)&&n.some(e=>(0,a1.IX)(e).every(e=>t.includes(e))));e=e.slice(),l.forEach(t=>{e.splice(e.indexOf(D6(t)),1)})}return e}initAnimation(){this.getMarksInType("arc").forEach(t=>{var e;t.setAnimationConfig(_l(null==(e=h9.getAnimationInKey("vennCircle"))?void 0:e(),_s(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("path").forEach(t=>{var e;t.setAnimationConfig(_l(null==(e=h9.getAnimationInKey("vennOverlap"))?void 0:e(),_s(t.name,this._spec,this._markAttributeContext)))})}}zG.type=Y.venn,zG.mark=D8,zG.builtInTheme={venn:{circle:{style:{opacity:.8},state:{hover:{opacity:1}}},overlap:{style:{opacity:.8},state:{hover:{opacity:1,stroke:"white",lineWidth:2}}},label:{visible:!0,style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"}}},overlapLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},zG.transformerConstructor=zv;let zV=()=>{TS(),MJ(),zy(),vY(),h9.registerGrammarTransform("vennMark",{transform:zN}),h9.registerSeries(zG.type,zG)};class zU extends Ai{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","circle","overlap","overlapLabel"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class zK extends Ah{constructor(){super(...arguments),this.transformerConstructor=zU,this.type="venn",this.seriesType=Y.venn}}zK.type="venn",zK.seriesType=Y.venn,zK.transformerConstructor=zU;let zX=()=>{A$(),zV(),h9.registerChart(zK.type,zK)};class zY extends Ar{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar","bandWidthField"])}transformSpec(t){super.transformSpec(t),c8(t)}_setDefaultXAxisSpec(t){return{orient:"bottom",type:"linear",label:{visible:!1}}}_setDefaultYAxisSpec(t){return{orient:"left",type:"linear"}}}class z$ extends MT{constructor(){super(...arguments),this.type=Y.mosaic,this.transformerConstructor=MM}get bandWidthField(){return this._bandWidthField}getStack(){return!0}getPercent(){return this._spec.percent}getGroupFields(){return"vertical"===this.direction?this._specXField:this._specYField}setAttrFromSpec(){super.setAttrFromSpec();let t=this.getPercent();"horizontal"===this.direction?(t&&(this.setFieldX(ub),this.setFieldX2(uv)),this.setFieldY(uC),this.setFieldY2(u_)):(t&&(this.setFieldY(ub),this.setFieldY2(uv)),this.setFieldX(uC),this.setFieldX2(u_)),this._spec.bandWidthField&&(this._bandWidthField=this._spec.bandWidthField)}parseLabelStyle(t,e){if((null==e?void 0:e.filterByGroup)&&(0,nB.Z)(t.dataFilter)){let i=this.getGroupFields(),{field:r,type:n="max",filter:l}=e.filterByGroup;delete t.filterField;let s=i.indexOf(r);if(s<0)return;let a=s%2?"min"===n?"horizontal"===this.direction?this._fieldY2:this._fieldX2:"horizontal"===this.direction?this._fieldY:this._fieldX:"min"===n?"horizontal"===this.direction?this._fieldX2:this._fieldY2:"horizontal"===this.direction?this._fieldX:this._fieldY,o="min"===n?(t,e)=>{var i,r;return(null==(i=t.data)?void 0:i[a])<(null==(r=e.data)?void 0:r[a])}:(t,e)=>{var i,r;return(null==(i=t.data)?void 0:i[a])>(null==(r=e.data)?void 0:r[a])};t.dataFilter=t=>{let e={};return t.forEach(t=>{let i=t.data,n=null==i?void 0:i[r];(0,nB.Z)(n)||l&&!l(t)||e[n]&&!o(t,e[n])||(e[n]=t)}),t.filter(t=>{var i;let n=null==(i=t.data)?void 0:i[r];return e[n]&&e[n]===t})}}return t}}z$.type=Y.mosaic,z$.builtInTheme={mosaic:{label:{visible:!1,position:"center",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},bar:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}}}},z$.transformerConstructor=MM;let zq=()=>{Mw(),kH(),vY(),SX(),h9.registerSeries(z$.type,z$)};class zJ extends Ah{constructor(){super(...arguments),this.transformerConstructor=zY,this.type="mosaic",this.seriesType=Y.mosaic,this.handleAfterStackRegion=(t,e)=>{t.getSeries().forEach(t=>{let i=t.getStackData(),r=t.getStackValue(),n=t.getStackValueField();i&&n&&(bB(e[r],n),bI(t,e[r]))})}}_beforeInit(){this._dataSet&&dL(this._dataSet,"stackSplit",Ad)}_initStack(){this._stack=new Au(this,{afterStackRegion:this.handleAfterStackRegion}),this._stack.init()}_setModelOption(){this._modelOption.getDimensionInfo=AI,this._modelOption.getDimensionInfoByValue=AL,this._modelOption.getRectByDimensionData=AW}}zJ.type="mosaic",zJ.seriesType=Y.mosaic,zJ.transformerConstructor=zY;let zQ=()=>{AX(),A$(),AJ(),AM(),Af(),zq(),h9.registerChart(zJ.type,zJ)};(ef=eG||(eG={})).middle="middle",ef.start="start",ef.end="end",ef.bothEnd="bothEnd",(em=eV||(eV={})).middle="middle",em.start="start",em.end="end",(ey=eU||(eU={})).area_horizontal="area_horizontal",ey.area_vertical="area_vertical",ey.area_stack="area_stack",ey.line_horizontal="line_horizontal",ey.line_vertical="line_vertical",ey.line_stack="line_stack",ey.bar_horizontal="bar_horizontal",ey.bar_vertical="bar_vertical",ey.bar_stack="bar_stack",ey.rangeColumn_horizontal="rangeColumn_horizontal",ey.rangeColumn_vertical="rangeColumn_vertical",ey.rangeArea_horizontal="rangeArea_horizontal",ey.rangeArea_vertical="rangeArea_vertical",ey.linearProgress_horizontal="linearProgress_horizontal",ey.linearProgress_vertical="linearProgress_vertical",ey.linearProgress_stack="linearProgress_stack",ey.boxPlot_horizontal="boxPlot_horizontal",ey.boxPlot_vertical="boxPlot_vertical",ey.sankey_horizontal="sankey_horizontal",ey.sankey_vertical="sankey_vertical",ey.waterfall_horizontal="waterfall_horizontal",ey.waterfall_vertical="waterfall_vertical",ey.circularProgress_stack="circularProgress_stack",ey.radar_stack="radar_stack",ey.rose_stack="rose_stack",(ev=eK||(eK={}))[ev.success=0]="success",ev[ev.failed=1]="failed";let z0=(t,e,i)=>{for(let r in t)switch(r){case"maxHeight":if((0,aw.Z)(t.maxHeight)&&e.height>t.maxHeight)return!1;break;case"minHeight":if((0,aw.Z)(t.minHeight)&&e.height<t.minHeight)return!1;break;case"maxWidth":if((0,aw.Z)(t.maxWidth)&&e.width>t.maxWidth)return!1;break;case"minWidth":if((0,aw.Z)(t.minWidth)&&e.width<t.minWidth)return!1;break;case"onResize":if((0,aw.Z)(t.onResize)&&!t.onResize(e,i))return!1}return!0},z1=(t="chart",e,i,r,n,l)=>{let s=z2(t,n,l);return Object.assign(Object.assign({},s),{modelInfo:s.modelInfo.filter(t=>!!(0,nB.Z)(e)||(0,a1.IX)(e).some(e=>(0,nz.Z)(e)?e(t,i,r):po(t.spec,e)))})},z2=(t="chart",e,i)=>{var r,n,l,s,a,o,h,d,u,c,p;let g={modelInfo:[]};if("chart"===t)g.isChart=!0,g.modelInfo.push({spec:e,type:"chart"});else if("region"===t)g.modelType="region",g.specKey="region",null==(r=e.region)||r.forEach((t,e)=>{g.modelInfo.push({spec:t,specPath:["region",e],type:"region"})});else if("series"===t)g.modelType="series",g.specKey="series",null==(n=e.series)||n.forEach((t,e)=>{g.modelInfo.push({spec:t,specPath:["series",e],type:t.type})});else if(Object.values(Y).includes(t))g.modelType="series",g.specKey="series",g.type=t,null==(l=e.series)||l.forEach((e,i)=>{e.type===t&&g.modelInfo.push({spec:e,specPath:["series",i],type:t})});else if(Object.values(oQ).includes(t)){g.modelType="component",g.type=t,g.specKey=null==(s=h9.getComponentInKey(t))?void 0:s.specKey;let{specKey:r}=g,n=(0,a1.IX)(null!=(o=null==(a=i.component)?void 0:a[r])?o:[]);null==(d=(0,a1.IX)(null!=(h=e[r])?h:[]))||d.forEach((e,i)=>{let r=n[i];r&&r.type===t?g.modelInfo.push(Object.assign(Object.assign({},r),{spec:e})):e&&!1===e.visible&&g.modelInfo.push({type:t,spec:e})})}else{let r=h9.getComponents().filter(({cmp:e})=>e.specKey===t).map(({cmp:t})=>t.type);if(r.length>0){g.modelType="component",g.specKey=t;let n=(0,a1.IX)(null!=(c=null==(u=i.component)?void 0:u[t])?c:[]);(0,a1.IX)(null!=(p=e[t])?p:[]).forEach((t,e)=>{let i=n[e];i&&r.includes(i.type)&&g.modelInfo.push(Object.assign(Object.assign({},i),{spec:t}))})}}return g},z3=(t,e,i,r)=>{let{spec:n,filter:l,filterType:s,forceAppend:a}=t,{isChart:o,modelType:h,specKey:d,type:u,modelInfo:c}=z1(s,l,t,e,i,r);if(0===c.length&&!a)return{chartSpec:i,hasChanged:!1};let p=h5({},i),g=(0,nz.Z)(n)?n(c,t,e):n;for(let{spec:t,specPath:e}of c){if(o)return{chartSpec:h5(p,g),hasChanged:!0};ph(p,e,h5({},t,g))}if(0===c.length&&a){let t=Object.assign({type:u},g);(0,rD.Z)(p[d])?p[d].push(t):(0,nB.Z)(p[d])?p[d]="component"===h?t:[t]:p[d]=[p[d],t]}return{chartSpec:p,hasChanged:!0}},z5=t=>(0,eq.v)(t)||(0,ax.Re)(t);function z4(t,e=["data"]){return(0,dz.Z)(t,z5,e)}class z6 extends xh{constructor(){super(z6.type),this.type="MediaQueryPlugin",this._currentMediaInfo={},this.currentActiveItems=new Set,this._initialized=!1}onInit(t,e){if(!(null==e?void 0:e[z6.specKey]))return;let{globalInstance:i}=t;this._option={globalInstance:t.globalInstance,updateSpec:(t,e,r)=>{r?i.updateSpecSync(t):e?i.updateSpecAndRecompile(t,!1,{transformSpec:!0}):i.setRuntimeSpec(t)}},this._spec=e[z6.specKey],this._initialized=!0}onBeforeResize(t,e,i){this._initialized&&this._changeSize(e,i,!0,!1)}onAfterChartSpecTransform(t,e,i){this._initialized&&"setCurrentTheme"===i&&this._reInit(!1,!1)}onAfterModelSpecTransform(t,e,i,r){this._initialized&&"updateSpec"===r&&this.onBeforeInitChart(t,e,"setCurrentTheme")}onBeforeInitChart(t,e,i){let r,n;if(this._initialized){switch(i){case"render":case"updateModelSpec":r=!1,n=!0;break;case"setCurrentTheme":r=!0,n=!1;break;case"updateSpecAndRecompile":r=!1,n=!1}if(r&&this.release(),this._initialized||this.onInit(t,e),r||n){let{width:t,height:e}=this._option.globalInstance.getCurrentSize();this._changeSize(t,e,!1,!1)}}}_changeSize(t,e,i,r){return(this._currentMediaInfo.width!==t||this._currentMediaInfo.height!==e)&&(this._currentMediaInfo.width=t,this._currentMediaInfo.height=e,this._applyQueries(i,r))}_applyQueries(t,e){let i,r,n=[],l=[];if(this._spec.forEach(t=>{let{hasChanged:e,isActive:i}=this._check(t);e&&(i?n.push(t):l.push(t))}),!n.length&&!l.length)return!1;this._baseChartSpec||(this._baseChartSpec=z4(this._option.globalInstance.getSpec(),["data",z6.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo());let s=!1;return l.length>0?(i=z4(this._baseChartSpec,["data",z6.specKey]),r=this._baseChartSpecInfo,Array.from(this.currentActiveItems).forEach(t=>{if(l.includes(t))return void this.currentActiveItems.delete(t);i=this._apply(t,i,r).chartSpec}),s=!0):(i=this._option.globalInstance.getSpec(),r=this._option.globalInstance.getSpecInfo()),n.forEach(t=>{this.currentActiveItems.add(t);let e=this._apply(t,i,r);i=e.chartSpec,s||(s=e.hasChanged)}),s&&this._option.updateSpec(i,t,e),!0}_check(t){let{globalInstance:e}=this._option,i=z0(t.query,this._currentMediaInfo,e);return{isActive:i,hasChanged:i!==this.currentActiveItems.has(t)}}_apply(t,e,i){let{query:r,action:n}=t,l=!1;return(0,a1.IX)(n).forEach(t=>{let n=z3(t,r,e,i);e=n.chartSpec,l||(l=n.hasChanged)}),{chartSpec:e,hasChanged:l}}_reInit(t,e){let i=this._option.globalInstance.getSpec();this._baseChartSpec=z4(i,["data",z6.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo();let r=!1;this.currentActiveItems.forEach(t=>{let e=this._apply(t,i,this._baseChartSpecInfo);i=e.chartSpec,r||(r=e.hasChanged)}),r&&this._option.updateSpec(i,t,e)}release(){super.release(),this._initialized=!1,this._spec=[],this._option=void 0,this._currentMediaInfo={},this.currentActiveItems.clear()}}z6.pluginType="chart",z6.specKey="media",z6.type="MediaQueryPlugin";let z7=()=>{Dh(z6)};class z8 extends xh{constructor(){super(z8.type),this.type="ChartResizeZoomPlugin",this._zoom=1,this._onWheel=t=>{t.preventDefault(),t.stopImmediatePropagation();let e=Math.pow(1.005,-t.deltaY*Math.pow(16,t.deltaMode)*.2*this._rate),i={x:t.offsetX,y:t.offsetY};this.zoom(e,i)}}onAfterInitChart(t,e){var i,r,n,l,s;let a=t.globalInstance,o=null!=(r=null==(i=a.getSpec())?void 0:i[z8.specKey])?r:{enabled:!1};!0===o.enabled&&(this._minZoom=null!=(n=o.min)?n:.1,this._maxZoom=null!=(l=o.max)?l:10,this._rate=null!=(s=o.rate)?s:.1,this._container=a.getContainer(),this._triggerEvent=M5(t.globalInstance.getChart().getOption().mode).zoom,this._container&&this._triggerEvent&&this._container.addEventListener(this._triggerEvent,this._onWheel))}zoom(t,e){let i=this.service.globalInstance;if(!i)return;let r=this._zoom,n=this._zoom*t;if(n<=this._minZoom&&t<1||n>=this._maxZoom&&t>1)if(n<=this._minZoom&&this._zoom>this._minZoom)n=this._minZoom;else{if(!(n>=this._maxZoom&&this._zoom<this._maxZoom))return;n=this._maxZoom}if(n===r)return;let l=n/r;if(this._zoom=n,i.resize(i.getCurrentSize().width*this._zoom,i.getCurrentSize().height*this._zoom),e&&this._container){let{scrollLeft:t,scrollTop:i}=this._container;this._container.scrollLeft=t+e.x*(l-1),this._container.scrollTop=i+e.y*(l-1)}}release(){this._container&&this._triggerEvent&&this._container.removeEventListener(this._triggerEvent,this._onWheel)}}z8.specKey="resizeZoom",z8.type="ChartResizeZoomPlugin";let z9=()=>{Dh(z8)};function Wt(t,e=0){let i=0xdeadbeef^e;return i=(i=0xcc9e2d51*((i=(0x9e3779b9^i)+(i<<6)+(i>>2))^t))<<15|i>>>17,i^=i<<25,i+=i<<9,i^=i>>4,i^=i<<18,((i|=1)>>>0)%0x7fffffff/0x7fffffff}function We(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI+2*Wt(e*n+i)*Math.PI)+1)/2))}function Wi(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-i/n*2*Math.PI)+1)/2))}function Wr(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-(n-1-i)/n*2*Math.PI)+1)/2))}function Wn(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-e/r*2*Math.PI)+1)/2))}function Wl(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-(r-1-e)/r*2*Math.PI)+1)/2))}function Ws(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-2*Math.sqrt(Math.pow((e-r/2)/r,2)+Math.pow((i-n/2)/n,2))*Math.PI)+1)/2))}function Wa(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-(e/r+i/n)/2*2*Math.PI)+1)/2))}function Wo(t,e,i,r,n,l,s,a=0,o=1){let h=Math.atan2(e-r/2,i-n/2);return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-(h<0?h+2*Math.PI:h)/(2*Math.PI)*2*Math.PI)+1)/2))}function Wh(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI*3-2*(Math.sqrt(Math.pow(e-r/2,2)+Math.pow(i-n/2,2))/Math.sqrt(Math.pow(r/2,2)+Math.pow(n/2,2)))*Math.PI)+1)/2))}function Wd(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-(e+i)%(r+n)/(r+n)*4*Math.PI)+1)/2))}function Wu(t,e,i,r,n,l,s,a=0,o=1){return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-e/r*2*Math.PI)*Math.sin(2*l*Math.PI-i/n*2*Math.PI)+1)/2))}function Wc(t,e,i,r,n,l,s,a=0,o=1){let h=r/2,d=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-4*((Math.sqrt(Math.pow(e-h,2)+Math.pow(i-d,2))/Math.sqrt(Math.pow(r/2,2)+Math.pow(n/2,2))+Math.atan2(e-h,i-d)/(2*Math.PI))/2)*Math.PI)+1)/2))}function Wp(t,e,i,r,n,l,s,a=0,o=1){let h=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-Math.abs(i-h)/h*2*Math.PI)+1)/2))}function Wg(t,e,i,r,n,l,s,a=0,o=1){let h=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-2*(1-Math.abs(i-h)/h)*Math.PI)+1)/2))}function Wf(t,e,i,r,n,l,s,a=0,o=1){let h=r/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-Math.abs(e-h)/h*2*Math.PI)+1)/2))}function Wm(t,e,i,r,n,l,s,a=0,o=1){let h=r/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-2*(1-Math.abs(e-h)/h)*Math.PI)+1)/2))}function Wy(t,e,i,r,n,l,s,a=0,o=1){let h=r/2,d=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-2*Math.min(Math.sqrt(Math.pow((e-h)/h,2)+Math.pow((i-d)/d,2)),1)*Math.PI)+1)/2))}function Wv(t,e,i,r,n,l,s,a=0,o=1){let h=r/2,d=n/2;return Math.min(1,Math.max(0,a+o*(Math.sin(2*l*Math.PI-2*(1-Math.min(Math.sqrt(Math.pow((e-h)/h,2)+Math.pow((i-d)/d,2)),1))*Math.PI)+1)/2))}function Wb(t,e,i,r,n,l,s,a=0,o=1){let h=r/2,d=n/2,u=Math.min(Math.sqrt(Math.pow((e-h)/h,2)+Math.pow((i-d)/d,2)),1),c=Math.max(0,1-u);return Math.min(1,Math.max(0,a+o*((Math.sin(2*l*Math.PI*3-4*u*Math.PI)+1)/2)*(.7*c+.3)))}function W_(t,e,i,r,n,l,s,a=0,o=1){let h=e*n+i,d=2*Wt(h,0)*Math.PI,u=.5*Wt(h,1)+.5,c=2*Wt(h,2)*Math.PI,p=r/2,g=n/2,f=(l-.4)/.6,m=Math.sin(f*u*8*Math.PI+d+c*f),y=Math.cos(Math.min(Math.sqrt(Math.pow((e-p)/p,2)+Math.pow((i-g)/g,2)),1)*Math.PI+f*Math.PI);return Math.min(1,Math.max(0,a+(m+1)/2*Math.max(0,1-1.2*f)*(.3+.7*y)*o))}class WC extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromText="",this.toText="",this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",void 0!==(null==n?void 0:n.showCursor)&&(this.showCursor=n.showCursor),void 0!==(null==n?void 0:n.cursorChar)&&(this.cursorChar=n.cursorChar),void 0!==(null==n?void 0:n.blinkCursor)&&(this.blinkCursor=n.blinkCursor),void 0!==(null==n?void 0:n.beforeText)&&(this.beforeText=n.beforeText),void 0!==(null==n?void 0:n.afterText)&&(this.afterText=n.afterText)}onFirstRun(){var t,e;let i=this.getLastProps(),r=this.getEndProps(),n=null!=(t=i.text)?t:"",l=null!=(e=r.text)?e:"";this.valid=!0,this.fromText=n.toString(),this.toText=l.toString(),this.toText||""===this.toText||(this.valid=!1)}onEnd(t){super.onEnd(t),t||(this.showCursor&&!this.blinkCursor?this.target.setAttribute("text",this.beforeText+this.toText+this.cursorChar+this.afterText):this.target.setAttribute("text",this.beforeText+this.toText+this.afterText))}onUpdate(t,e,i){let r,n;if(!this.valid)return;let l=this.toText.length,s=this.fromText.length;s>l?(r=Math.round(s-(s-l)*e),n=this.fromText.substring(0,r)):(r=Math.round(s+(l-s)*e),n=this.toText.startsWith(this.fromText)?this.toText.substring(0,r):r<=s?this.fromText.substring(0,r):this.toText.substring(0,r-s+Math.min(s,r)));let a=this.beforeText+n+this.afterText;this.showCursor&&(this.blinkCursor?Math.floor(e/.1)%2==0&&(a=this.beforeText+n+this.cursorChar+this.afterText):a=this.beforeText+n+this.cursorChar+this.afterText),this.target.setAttribute("text",a)}}class Wx extends gf{onBind(){let t,e;super.onBind();let i=CA(this.target);this._animator=i;let r=this.duration,n=this.easing,l=this.target,{symbolStartOuterType:s="scale",titleType:a="typewriter",titlePanelType:o="scale"}=this.params,h=r/10;if(l._symbolStart.setAttributes({scaleX:0,scaleY:0}),i.animate(l._symbolStart,{type:"to",to:{scaleX:1,scaleY:1},duration:5*h,easing:n}),"scale"===s?(t={scaleX:0,scaleY:0},e={scaleX:1,scaleY:1}):(t={clipRange:0},e={clipRange:1}),l._symbolStartOuter.setAttributes(t),i.animate(l._symbolStartOuter,{type:"to",to:e,duration:5*h,easing:n}),l._symbolEnd.setAttributes({scaleX:0,scaleY:0}),i.animate(l._symbolEnd,{type:"to",to:{scaleX:1,scaleY:1},duration:2*h,delay:8*h,easing:n}),l._line.setAttributes({clipRange:0}),i.animate(l._line,{type:"to",to:{clipRange:1},duration:9*h,easing:n}),"typewriter"===a){let t=l._titleTop.attribute.text;l._titleTop.setAttributes({text:""}),i.animate(l._titleTop,{type:"custom",delay:5*h,duration:4*h,easing:"linear",to:{text:t},custom:WC});let e=l._titleBottom.attribute.text;l._titleBottom.setAttributes({text:""}),i.animate(l._titleBottom,{type:"custom",delay:5*h,duration:4*h,easing:"linear",to:{text:e},custom:WC})}else l._titleTop.setAttributes({dy:l._titleTop.AABBBounds.height()+10}),i.animate(l._titleTop,{type:"to",to:{dy:0},delay:5*h,duration:4*h,easing:"linear"}),l._titleBottom.setAttributes({dy:-(10+l._titleBottom.AABBBounds.height())}),i.animate(l._titleBottom,{type:"to",to:{dy:0},delay:5*h,duration:4*h,easing:"linear"});"scale"===o?[l._titleTopPanel,l._titleBottomPanel].forEach(t=>{var e;let l=null!=(e=t.attribute.scaleX)?e:1;t.setAttributes({scaleX:0}),i.animate(t,{type:"to",to:{scaleX:l},duration:r,easing:n})}):"stroke"===o&&[l._titleTopPanel,l._titleBottomPanel].forEach(t=>{let e=t.AABBBounds,l=2*(e.width()+e.height());t.setAttributes({lineDash:[0,10*l]}),i.animate(t,{type:"to",to:{lineDash:[l,10*l]},duration:r,easing:n})}),this.completeBind(i)}}class Ww extends gf{onBind(){super.onBind();let t=CA(this.target);this._animator=t;let e=this.duration,i=this.easing,r=this.target,{mode:n}=this.params;"scale"===n?t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}):(t.animate(r._line,{type:"to",to:{clipRange:0},duration:e,easing:i}),t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._symbolEnd,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),t.animate(r._titleTop,{type:"to",to:{dy:r._titleTop.AABBBounds.height()+10},duration:e/2,easing:i}),t.animate(r._titleBottom,{type:"to",to:{dy:-(10+r._titleBottom.AABBBounds.height())},duration:e/2,easing:i}),t.animate(r._symbolStartOuter,{type:"to",to:{clipRange:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._titleTopPanel,{type:"to",to:{scaleX:0},duration:e,easing:i}),t.animate(r._titleBottomPanel,{type:"to",to:{scaleX:0},duration:e,easing:i})),this.completeBind(t)}}class WS extends gf{onBind(){super.onBind();let t=CA(this.target);this._animator=t;let e=this.duration,i=this.easing,r=this.target,{wave:n}=this.params;if(r.setAttributes({scaleX:0,scaleY:0}),t.animate(r,{type:"to",to:{scaleX:1,scaleY:1},duration:e/3*2,easing:i}),r.titleShape&&t.animate(r.titleShape,{type:"custom",to:{text:r.titleShape.attribute.text},duration:e,easing:i,custom:WC}),r.contentShape&&t.animate(r.contentShape,{type:"custom",to:{text:r.contentShape.attribute.text},duration:e,easing:i,custom:WC}),n){let l=e/6;t.animate(r.group,{timeSlices:[{duration:l,effects:{type:"to",to:{angle:n},easing:i}},{duration:2*l,effects:{type:"to",to:{angle:-n},easing:i}},{duration:2*l,effects:{type:"to",to:{angle:n},easing:i}},{duration:l,effects:{type:"to",to:{angle:0},easing:i}}]})}this.completeBind(t)}}class WA extends gf{onBind(){super.onBind();let t=CA(this.target);this._animator=t;let e=this.duration,i=this.easing,r=this.target;t.animate(r,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),this.completeBind(t)}}class WM extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.fadeInChars=!1,this.fadeInDuration=.3,this.strokeFirst=!1,this.strokeToFillRatio=.3,void 0!==(null==n?void 0:n.showCursor)&&(this.showCursor=n.showCursor),void 0!==(null==n?void 0:n.cursorChar)&&(this.cursorChar=n.cursorChar),void 0!==(null==n?void 0:n.blinkCursor)&&(this.blinkCursor=n.blinkCursor),void 0!==(null==n?void 0:n.fadeInChars)&&(this.fadeInChars=n.fadeInChars),void 0!==(null==n?void 0:n.fadeInDuration)&&(this.fadeInDuration=n.fadeInDuration),void 0!==(null==n?void 0:n.strokeFirst)&&(this.strokeFirst=n.strokeFirst),void 0!==(null==n?void 0:n.strokeToFillRatio)&&(this.strokeToFillRatio=n.strokeToFillRatio)}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?Cf.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=Cf.TransformTextConfig2SingleCharacter(this.originalTextConfig)):this.valid=!1}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){let r,n;if(!this.valid)return;let l=this.toTextConfig.length,s=this.fromTextConfig.length,a=this.fadeInChars?1-this.fadeInDuration:1;if(r=s>l?Math.round(s-(s-l)*e):this.fadeInChars?Math.round(s+(l-s)*Math.min(1,e/a)):Math.round(s+(l-s)*e),n=s>l?this.fromTextConfig.slice(0,r):this.toTextConfig.slice(0,r).map((t,i)=>{if("text"in t){let r=Object.assign({},t);if(this.strokeFirst){let t=i/l*a,n=Math.max(0,e-t),s=1-t,o=Math.min(1,n/(this.strokeToFillRatio*s));"fill"in r&&r.fill&&(r.stroke=r.fill,o<1&&(r.fillOpacity=o)),this.fadeInChars&&(r.opacity=Math.max(0,Math.min(1,Math.min(1,n/(this.fadeInDuration*s)))))}else this.fadeInChars&&(r.opacity=Math.max(0,Math.min(1,(e-i/l*a)/this.fadeInDuration)));return r}return t}),this.showCursor&&r<l){let t=!0;if(this.blinkCursor&&(t=Math.floor(e/.1)%2==0),t&&n.length>0){let t=n.length-1,e=n[t];if("text"in e)n[t]=Object.assign(Object.assign({},e),{text:String(e.text)+this.cursorChar});else{let t={text:this.cursorChar,fontSize:16};n.push(t)}}}this.target.setAttribute("textConfig",n)}}class WT extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",this.fadeOutChars=!1,this.fadeOutDuration=.3,this.direction="backward",void 0!==(null==n?void 0:n.showCursor)&&(this.showCursor=n.showCursor),void 0!==(null==n?void 0:n.cursorChar)&&(this.cursorChar=n.cursorChar),void 0!==(null==n?void 0:n.blinkCursor)&&(this.blinkCursor=n.blinkCursor),void 0!==(null==n?void 0:n.beforeText)&&(this.beforeText=n.beforeText),void 0!==(null==n?void 0:n.afterText)&&(this.afterText=n.afterText),void 0!==(null==n?void 0:n.fadeOutChars)&&(this.fadeOutChars=n.fadeOutChars),void 0!==(null==n?void 0:n.fadeOutDuration)&&(this.fadeOutDuration=n.fadeOutDuration),void 0!==(null==n?void 0:n.direction)&&(this.direction=n.direction),this.propKeys=["textConfig"]}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=Cf.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?Cf.TransformTextConfig2SingleCharacter(e.textConfig):[]):this.valid=!1}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){let r;if(!this.valid)return;let n=this.fromTextConfig.length,l=this.fadeOutChars?1-this.fadeOutDuration:1;if("forward"===this.direction){r=this.fadeOutChars?Math.round(n*(1-Math.min(1,e/l))):Math.round(n*(1-e));let t="forward"===this.direction?this.fromTextConfig.slice(n-r):this.fromTextConfig.slice(0,r);this.fadeOutChars&&(t=this.applyFadeEffect(t,e,n,r)),this.showCursor&&r>0&&(t=this.addCursor(t,e)),this.target.setAttribute("textConfig",t)}else{r=this.fadeOutChars?Math.round(n*(1-Math.min(1,e/l))):Math.round(n*(1-e));let t=this.fromTextConfig.slice(0,r);this.fadeOutChars&&(t=this.applyFadeEffect(t,e,n,r)),this.showCursor&&r>0&&(t=this.addCursor(t,e)),this.target.setAttribute("textConfig",t)}}applyFadeEffect(t,e,i,r){this.direction;let n=Math.max(0,1-Math.min(1,(e-(1-this.fadeOutDuration))/this.fadeOutDuration));return t.map((e,i)=>{if("forward"===this.direction){if(0===i&&"text"in e)return Object.assign(Object.assign({},e),{opacity:n})}else if(i===t.length-1&&"text"in e)return Object.assign(Object.assign({},e),{opacity:n});return e})}addCursor(t,e){let i=!0;if(this.blinkCursor&&(i=Math.floor(e/.1)%2==0),i&&t.length>0){let e="forward"===this.direction?0:t.length-1,i=t[e];if("text"in i){let r=[...t];return"forward"===this.direction?r[e]=Object.assign(Object.assign({},i),{text:this.cursorChar+String(i.text)}):r[e]=Object.assign(Object.assign({},i),{text:String(i.text)+this.cursorChar}),r}}return t}}class Wk extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeInDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],void 0!==(null==n?void 0:n.fadeInDuration)&&(this.fadeInDuration=n.fadeInDuration),void 0!==(null==n?void 0:n.slideDirection)&&(this.slideDirection=n.slideDirection),void 0!==(null==n?void 0:n.slideDistance)&&(this.slideDistance=n.slideDistance),void 0!==(null==n?void 0:n.wordByWord)&&(this.wordByWord=n.wordByWord),void 0!==(null==n?void 0:n.wordRegex)&&(this.wordRegex=n.wordRegex)}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?Cf.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=Cf.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.singleCharConfig=this.toTextConfig.map(t=>"text"in t?Object.assign(Object.assign({},t),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}):Object.assign(Object.assign({},t),{opacity:0})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="",e={},i,r=0;for(this.toTextConfig.forEach((i,n)=>{if("text"in i){let l=String(i.text);t+=l,e[r]=n,r++}}),this.wordRegex.lastIndex=0;null!==(i=this.wordRegex.exec(t));){let t=i.index,r=i.index+i[0].length,n=[];for(let i=t;i<r;i++)void 0!==e[i]&&n.push(e[i]);n.length>0&&this.wordGroups.push(n)}let n=new Set;this.wordGroups.forEach(t=>{t.forEach(t=>n.add(t))});for(let t=0;t<this.toTextConfig.length;t++)"text"in this.toTextConfig[t]&&!n.has(t)&&this.wordGroups.push([t])}getInitialDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getInitialDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){let r;if(!this.valid)return;let n=1-this.fadeInDuration;r=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,n):this.updateByCharacter(e,n),this.target.setAttribute("textConfig",r)}updateByWord(t,e){let i=this.wordGroups.length,r=[...this.singleCharConfig];for(let n=0;n<this.wordGroups.length;n++){let l;if(t<(l="left"===this.slideDirection?(i-1-n)/i*e:n/i*e)){for(let t of this.wordGroups[n]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}))}continue}let s=Math.max(0,Math.min(1,(t-l)/this.fadeInDuration)),a=this.getInitialDx()*(1-s),o=this.getInitialDy()*(1-s);for(let t of this.wordGroups[n]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:s,dx:a,dy:o}))}}return r}updateByCharacter(t,e){let i=this.toTextConfig.length,r=[...this.singleCharConfig];for(let n=0;n<r.length;n++){let l=r[n];if("text"in l){let s;if(t<(s="left"===this.slideDirection?(i-1-n)/i*e:n/i*e)){r[n]=Object.assign(Object.assign({},l),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()});continue}let a=Math.max(0,Math.min(1,(t-s)/this.fadeInDuration)),o=this.getInitialDx()*(1-a),h=this.getInitialDy()*(1-a);r[n]=Object.assign(Object.assign({},l),{opacity:a,dx:o,dy:h})}}return r}}class WR extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeOutDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],this.reverseOrder=!1,void 0!==(null==n?void 0:n.fadeOutDuration)&&(this.fadeOutDuration=n.fadeOutDuration),void 0!==(null==n?void 0:n.slideDirection)&&(this.slideDirection=n.slideDirection),void 0!==(null==n?void 0:n.slideDistance)&&(this.slideDistance=n.slideDistance),void 0!==(null==n?void 0:n.wordByWord)&&(this.wordByWord=n.wordByWord),void 0!==(null==n?void 0:n.wordRegex)&&(this.wordRegex=n.wordRegex),void 0!==(null==n?void 0:n.reverseOrder)&&(this.reverseOrder=n.reverseOrder),this.propKeys=["textConfig"]}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=Cf.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?Cf.TransformTextConfig2SingleCharacter(e.textConfig):[],this.singleCharConfig=this.fromTextConfig.map(t=>"text"in t?Object.assign(Object.assign({},t),{opacity:1,dx:0,dy:0}):Object.assign(Object.assign({},t),{opacity:1})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="",e={},i,r=0;for(this.fromTextConfig.forEach((i,n)=>{if("text"in i){let l=String(i.text);t+=l,e[r]=n,r++}}),this.wordRegex.lastIndex=0;null!==(i=this.wordRegex.exec(t));){let t=i.index,r=i.index+i[0].length,n=[];for(let i=t;i<r;i++)void 0!==e[i]&&n.push(e[i]);n.length>0&&this.wordGroups.push(n)}let n=new Set;this.wordGroups.forEach(t=>{t.forEach(t=>n.add(t))});for(let t=0;t<this.fromTextConfig.length;t++)"text"in this.fromTextConfig[t]&&!n.has(t)&&this.wordGroups.push([t])}getTargetDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getTargetDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){let r;if(!this.valid)return;let n=1-this.fadeOutDuration;r=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,n):this.updateByCharacter(e,n),this.target.setAttribute("textConfig",r)}updateByWord(t,e){let i=this.wordGroups.length,r=[...this.singleCharConfig];for(let n=0;n<this.wordGroups.length;n++){let l;if(t<(l=this.reverseOrder?"left"===this.slideDirection?n/i*e:(i-1-n)/i*e:"left"===this.slideDirection?(i-1-n)/i*e:n/i*e)){for(let t of this.wordGroups[n]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:1,dx:0,dy:0}))}continue}let s=Math.max(0,Math.min(1,(t-l)/this.fadeOutDuration)),a=this.getTargetDx()*s,o=this.getTargetDy()*s,h=1-s;for(let t of this.wordGroups[n]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:h,dx:a,dy:o}))}}return r}updateByCharacter(t,e){let i=this.fromTextConfig.length,r=[...this.singleCharConfig];for(let n=0;n<r.length;n++){let l=r[n];if("text"in l){let s;if(t<(s=this.reverseOrder?"left"===this.slideDirection?n/i*e:(i-1-n)/i*e:"left"===this.slideDirection?(i-1-n)/i*e:n/i*e)){r[n]=Object.assign(Object.assign({},l),{opacity:1,dx:0,dy:0});continue}let a=Math.max(0,Math.min(1,(t-s)/this.fadeOutDuration)),o=this.getTargetDx()*a,h=this.getTargetDy()*a,d=1-a;r[n]=Object.assign(Object.assign({},l),{opacity:d,dx:o,dy:h})}}return r}}class WP extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n,l,s,a,o,h,d,u;super.onBind();let c=this.target.getFinalAttribute(),p=(null==(t=this.params)?void 0:t.direction)||"right",g=(null==(e=this.params)?void 0:e.distance)||50,f=null!=(r=null==(i=this.params)?void 0:i.fromOpacity)?r:0,m={opacity:f,baseOpacity:f},y={opacity:1,baseOpacity:1};"top"===p?(m.y=(null!=(n=c.y)?n:0)-g,y.y=null!=(l=c.y)?l:0,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===p?(m.y=(null!=(s=c.y)?s:0)+g,y.y=null!=(a=c.y)?a:0,this.propKeys=["opacity","baseOpacity","y"]):("left"===p?(m.x=(null!=(o=c.x)?o:0)-g,y.x=null!=(h=c.x)?h:0):(m.x=(null!=(d=c.x)?d:0)+g,y.x=null!=(u=c.x)?u:0),this.propKeys=["opacity","baseOpacity","x"]),this.from=m,this.to=y,this.props=y,this.target.setAttributes(m)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class WB extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n,l,s;super.onBind();let a=this.target.getFinalAttribute(),o=null!=(e=null==(t=this.params)?void 0:t.fromScale)?e:0,h=(null==(i=this.params)?void 0:i.direction)||"xy",d=null!=(n=null==(r=this.params)?void 0:r.fromOpacity)?n:0,u={opacity:d,baseOpacity:d},c={opacity:1,baseOpacity:1};this.propKeys=["opacity","baseOpacity"],"x"!==h&&"xy"!==h||(u.scaleX=o,c.scaleX=null!=(l=a.scaleX)?l:1,this.propKeys.push("scaleX")),"y"!==h&&"xy"!==h||(u.scaleY=o,c.scaleY=null!=(s=a.scaleY)?s:1,this.propKeys.push("scaleY")),this.from=u,this.to=c,this.props=c,this.target.setAttributes(u)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class WI extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onBind(){var t,e,i,r,n,l,s,a,o;super.onBind();let h=this.target.getFinalAttribute(),d=null!=(e=null==(t=this.params)?void 0:t.fromAngle)?e:2*Math.PI,u=null!=(r=null==(i=this.params)?void 0:i.fromScale)?r:0,c=null!=(l=null==(n=this.params)?void 0:n.fromOpacity)?l:0,p={opacity:c,baseOpacity:c,angle:d,scaleX:u,scaleY:u},g={opacity:1,baseOpacity:1,angle:null!=(s=h.angle)?s:0,scaleX:null!=(a=h.scaleX)?a:1,scaleY:null!=(o=h.scaleY)?o:1};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=p,this.to=g,this.props=g,this.target.setAttributes(p)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class WE extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.perimeter=0,this.originalAttributes={}}onBind(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y;if(super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){let i=this.target.attribute,r=null!=(t=i.width)?t:100,n=null!=(e=i.height)?e:100;this.perimeter=2*(r+n)}else if("circle"===this.target.type){let t=null!=(i=this.target.attribute.radius)?i:50;this.perimeter=2*Math.PI*t}else if("ellipse"===this.target.type){let t=this.target.attribute,e=null!=(r=t.radiusX)?r:50,i=null!=(n=t.radiusY)?n:50;this.perimeter=2*Math.PI*Math.sqrt((e*e+i*i)/2)}else this.perimeter=1e3;let v=null!=(s=null==(l=this.params)?void 0:l.lineWidth)?s:2,b=null!=(o=null==(a=this.params)?void 0:a.strokeColor)?o:"black",_=null!=(d=null==(h=this.params)?void 0:h.fromOpacity)?d:1,C=null!=(c=null==(u=this.params)?void 0:u.dashLength)?c:this.perimeter,x=null!=(g=null==(p=this.params)?void 0:p.showFill)&&g,w=null!=(m=null==(f=this.params)?void 0:f.fillOpacity)?m:0;this.from={lineDash:[C,C],lineDashOffset:C,lineWidth:v,stroke:b,strokeOpacity:_},this.to={lineDash:[C,C],lineDashOffset:0,lineWidth:v,stroke:b,strokeOpacity:_},x?(this.from.fillOpacity=w,this.to.fillOpacity=null!=(y=this.originalAttributes.fillOpacity)?y:1):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;let n=this.target.attribute;n.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null==(r=this.params)?void 0:r.showFill)&&(n.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}onEnd(){var t;if(super.onEnd(),!(null==(t=this.params)?void 0:t.showFill)){let t=Object.assign({},this.originalAttributes);t.fillOpacity=0,this.target.setAttributes(t)}}}class WL extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.perimeter=0,this.originalAttributes={}}onFirstRun(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f;if(this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){let i=this.target.attribute,r=null!=(t=i.width)?t:100,n=null!=(e=i.height)?e:100;this.perimeter=2*(r+n)}else if("circle"===this.target.type){let t=null!=(i=this.target.attribute.radius)?i:50;this.perimeter=2*Math.PI*t}else if("ellipse"===this.target.type){let t=this.target.attribute,e=null!=(r=t.radiusX)?r:50,i=null!=(n=t.radiusY)?n:50;this.perimeter=2*Math.PI*Math.sqrt((e*e+i*i)/2)}else this.perimeter=1e3;let m=null!=(s=null==(l=this.params)?void 0:l.lineWidth)?s:2,y=null!=(o=null==(a=this.params)?void 0:a.strokeColor)?o:"black",v=null!=(d=null==(h=this.params)?void 0:h.fromOpacity)?d:1,b=null!=(c=null==(u=this.params)?void 0:u.dashLength)?c:this.perimeter,_=null!=(g=null==(p=this.params)?void 0:p.showFill)&&g;this.from={lineDash:[b,b],lineDashOffset:0,lineWidth:m,stroke:y,strokeOpacity:v},this.to={lineDash:[b,b],lineDashOffset:-b,lineWidth:m,stroke:y,strokeOpacity:v},_?this.from.fillOpacity=null!=(f=this.originalAttributes.fillOpacity)?f:1:this.from.fillOpacity=0,this.to.fillOpacity=0,this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;let n=this.target.attribute;n.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null==(r=this.params)?void 0:r.showFill)&&(n.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}}class WF extends gg{constructor(t,e,i,r,n){var l;super(t,e,i,r,n);let s=null!=(l=null==n?void 0:n.slideRatio)?l:.5;this.slideInDuration=i*s,this.growInDuration=i*(1-s)}onBind(){var t,e,i,r,n,l;super.onBind();let s=new yv(this.target);s.execute({type:"custom",custom:WP,customParameters:{direction:(null==(t=this.params)?void 0:t.slideDirection)||"right",distance:(null==(e=this.params)?void 0:e.slideDistance)||50,fromOpacity:null!=(r=null==(i=this.params)?void 0:i.fromOpacity)?r:0},duration:this.slideInDuration,easing:this.easing}),s.execute({type:"custom",custom:WB,customParameters:{fromScale:(null==(n=this.params)?void 0:n.fromScale)||.5,direction:(null==(l=this.params)?void 0:l.scaleDirection)||"xy",fromOpacity:1},duration:this.growInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class WO extends gg{constructor(t,e,i,r,n){var l;super(t,e,i,r,n);let s=null!=(l=null==n?void 0:n.slideRatio)?l:.5;this.slideInDuration=i*s,this.spinInDuration=i*(1-s)}onBind(){var t,e,i,r,n,l;super.onBind();let s=new yv(this.target);s.execute({type:"custom",custom:WP,customParameters:{direction:(null==(t=this.params)?void 0:t.slideDirection)||"right",distance:(null==(e=this.params)?void 0:e.slideDistance)||50,fromOpacity:null!=(r=null==(i=this.params)?void 0:i.fromOpacity)?r:0},duration:this.slideInDuration,easing:this.easing}),s.execute({type:"custom",custom:WI,customParameters:{fromAngle:(null==(n=this.params)?void 0:n.fromAngle)||Math.PI,fromScale:(null==(l=this.params)?void 0:l.fromScale)||.5,fromOpacity:1},duration:this.spinInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class WH extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onFirstRun(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p;let g=this.target.getAttributes(),f=(null==(t=this.params)?void 0:t.direction)||"right",m=(null==(e=this.params)?void 0:e.distance)||50,y=null!=(r=null==(i=this.params)?void 0:i.fromOpacity)?r:1,v=null!=(l=null==(n=this.params)?void 0:n.toOpacity)?l:0,b={opacity:y,baseOpacity:y},_={opacity:v,baseOpacity:v};"top"===f?(b.y=null!=(s=g.y)?s:0,_.y=(null!=(a=g.y)?a:0)-m,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===f?(b.y=null!=(o=g.y)?o:0,_.y=(null!=(h=g.y)?h:0)+m,this.propKeys=["opacity","baseOpacity","y"]):("left"===f?(b.x=null!=(d=g.x)?d:0,_.x=(null!=(u=g.x)?u:0)-m):(b.x=null!=(c=g.x)?c:0,_.x=(null!=(p=g.x)?p:0)+m),this.propKeys=["opacity","baseOpacity","x"]),this.from=b,this.to=_,this.props=_}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class WD extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onFirstRun(){var t,e,i,r,n,l,s,a,o;let h=this.target.getAttributes(),d=null!=(e=null==(t=this.params)?void 0:t.fromScale)?e:0,u=(null==(i=this.params)?void 0:i.direction)||"xy",c=null!=(n=null==(r=this.params)?void 0:r.fromOpacity)?n:1,p=null!=(s=null==(l=this.params)?void 0:l.toOpacity)?s:0,g={opacity:c,baseOpacity:c},f={opacity:p,baseOpacity:p};this.propKeys=["opacity","baseOpacity"],"x"!==u&&"xy"!==u||(g.scaleX=null!=(a=h.scaleX)?a:1,f.scaleX=d,this.propKeys.push("scaleX")),"y"!==u&&"xy"!==u||(g.scaleY=null!=(o=h.scaleY)?o:1,f.scaleY=d,this.propKeys.push("scaleY")),this.from=g,this.to=f,this.props=f}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class Wz extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n)}onFirstRun(){var t,e,i,r,n,l,s,a,o,h,d;let u=this.target.getAttributes(),c=null!=(e=null==(t=this.params)?void 0:t.fromAngle)?e:2*Math.PI,p=null!=(r=null==(i=this.params)?void 0:i.fromScale)?r:0,g=null!=(l=null==(n=this.params)?void 0:n.fromOpacity)?l:1,f=null!=(a=null==(s=this.params)?void 0:s.toOpacity)?a:0,m={opacity:g,baseOpacity:g,angle:null!=(o=u.angle)?o:0,scaleX:null!=(h=u.scaleX)?h:1,scaleY:null!=(d=u.scaleY)?d:1},y={opacity:f,baseOpacity:f,angle:c,scaleX:p,scaleY:p};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=m,this.to=y,this.props=y}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class WW extends gg{constructor(t,e,i,r,n){var l;super(t,e,i,r,n);let s=null!=(l=null==n?void 0:n.slideRatio)?l:.5;this.growOutDuration=i*(1-s),this.slideOutDuration=i*s}onFirstRun(){var t,e,i,r;let n=new yv(this.target);n.execute({type:"custom",custom:WD,customParameters:{fromScale:(null==(t=this.params)?void 0:t.fromScale)||.5,direction:(null==(e=this.params)?void 0:e.scaleDirection)||"xy",fromOpacity:1,toOpacity:1},duration:this.growOutDuration,easing:this.easing}),n.execute({type:"custom",custom:WH,customParameters:{direction:(null==(i=this.params)?void 0:i.slideDirection)||"right",distance:(null==(r=this.params)?void 0:r.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.growOutDuration})}onUpdate(t,e,i){}}class WZ extends gg{constructor(t,e,i,r,n){var l;super(t,e,i,r,n);let s=null!=(l=null==n?void 0:n.slideRatio)?l:.5;this.spinOutDuration=i*(1-s),this.slideOutDuration=i*s}onFirstRun(){var t,e,i,r;let n=new yv(this.target);n.execute({type:"custom",custom:Wz,customParameters:{fromAngle:(null==(t=this.params)?void 0:t.fromAngle)||Math.PI,fromScale:(null==(e=this.params)?void 0:e.fromScale)||.5,fromOpacity:1,toOpacity:1},duration:this.spinOutDuration,easing:this.easing}),n.execute({type:"custom",custom:WH,customParameters:{direction:(null==(i=this.params)?void 0:i.slideDirection)||"right",distance:(null==(r=this.params)?void 0:r.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.spinOutDuration})}onUpdate(t,e,i){}}class WN extends gg{constructor(t,e,i,r,n){super(t,e,i,r,n),this.originalAttributes={},this.pulseCount=3,this.pulseOpacity=.3,this.pulseScale=1.05,this.pulseColor=null,this.pulseColorIntensity=.2,this.strokeOnly=!1,this.fillOnly=!1,this.useScale=!0,this.useOpacity=!0,this.useStroke=!0,this.useFill=!0,this.useColor=!1,this.originalFill=null,this.originalStroke=null,void 0!==(null==n?void 0:n.pulseCount)&&(this.pulseCount=n.pulseCount),void 0!==(null==n?void 0:n.pulseScale)&&(this.pulseScale=n.pulseScale),void 0!==(null==n?void 0:n.pulseColor)&&(this.pulseColor=n.pulseColor),void 0!==(null==n?void 0:n.pulseColorIntensity)&&(this.pulseColorIntensity=n.pulseColorIntensity),void 0!==(null==n?void 0:n.strokeOnly)&&(this.strokeOnly=n.strokeOnly),void 0!==(null==n?void 0:n.fillOnly)&&(this.fillOnly=n.fillOnly),void 0!==(null==n?void 0:n.useScale)&&(this.useScale=n.useScale),void 0!==(null==n?void 0:n.useOpacity)&&(this.useOpacity=n.useOpacity),void 0!==(null==n?void 0:n.useStroke)&&(this.useStroke=n.useStroke),void 0!==(null==n?void 0:n.useFill)&&(this.useFill=n.useFill),void 0!==(null==n?void 0:n.useColor)&&(this.useColor=n.useColor)}onBind(){super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),this.useColor&&(this.originalFill=this.originalAttributes.fill||null,this.originalStroke=this.originalAttributes.stroke||null,this.pulseColor||(this.fillOnly&&this.originalFill?this.pulseColor=this.originalFill:this.strokeOnly&&this.originalStroke?this.pulseColor=this.originalStroke:this.originalFill?this.pulseColor=this.originalFill:this.originalStroke?this.pulseColor=this.originalStroke:this.pulseColor="#FFFFFF"))}onUpdate(t,e,i){let r=Math.abs(Math.sin(e*Math.PI*this.pulseCount)),n=this.target.attribute;if(this.useOpacity){let t=1+(this.pulseOpacity-1)*r;this.useStroke&&(n.strokeOpacity=(this.originalAttributes.strokeOpacity||1)*t),this.useFill&&(n.fillOpacity=(this.originalAttributes.fillOpacity||1)*t)}if(this.useScale){let t=1+(this.pulseScale-1)*r;n.scaleX=(this.originalAttributes.scaleX||1)*t,n.scaleY=(this.originalAttributes.scaleY||1)*t}this.useColor&&this.pulseColor&&this.applyColorPulse(n,r),this.target.addUpdateShapeAndBoundsTag(),this.target.addUpdatePositionTag()}applyColorPulse(t,e){let i=this.pulseColorIntensity*e;this.useFill&&this.originalFill&&this.pulseColor&&(t.fill=pX(this.originalFill,this.pulseColor,i,!0)),this.useStroke&&this.originalStroke&&this.pulseColor&&(t.stroke=pX(this.originalStroke,this.pulseColor,i,!0))}onEnd(){super.onEnd(),this.target.setAttributes(this.originalAttributes)}}class Wj extends gg{constructor(t,e,i,r,n){var l;super(t,e,i,r,n),n&&(this.pathLength=n.path.getLength(),this.path=n.path,this.distance=n.distance,this.totalLength=this.distance*this.pathLength,this.initAngle=null!=(l=n.initAngle)?l:0,this.changeAngle=!!n.changeAngle,this.cb=n.cb)}onBind(){this.from={x:0,y:0},this.to=this.path.getAttrAt(this.totalLength).pos,this.props=this.to}onUpdate(t,e,i){let r={},n=this.totalLength*e,{pos:l,angle:s}=this.path.getAttrAt(n);r.x=l.x,r.y=l.y,this.changeAngle&&(r.angle=s+this.initAngle),this.cb&&this.cb(this.from,this.to,e,this.target),this.target.setAttributes(r)}}class WG extends gm{constructor(t,e,i,r,n){super(t,e,i,r,n),this.webglCanvas=null,this.gl=null,this.program=null,this.currentAnimationRatio=0,this.animationTime=0}onUpdate(t,e,i){super.onUpdate(t,e,i),this.currentAnimationRatio=e,this.animationTime=e*Math.PI*2}getAnimationTime(){return this.currentAnimationRatio>0?this.animationTime:Date.now()/1e3}getDurationFromParent(){return this.duration||1e3}initWebGL(t){try{if(this.webglCanvas=hd.createCanvas({width:t.width,height:t.height,dpr:hd.devicePixelRatio}),!this.webglCanvas)return console.warn("WebGL canvas creation failed"),!1;this.webglCanvas.style.width=t.style.width||`${t.width}px`,this.webglCanvas.style.height=t.style.height||`${t.height}px`;let e=null;try{(e=this.webglCanvas.getContext("webgl"))||(e=this.webglCanvas.getContext("experimental-webgl"))}catch(t){console.warn("Failed to get WebGL context:",t)}if(this.gl=e,!this.gl)return console.warn("WebGL not supported"),!1;let i=this.getShaderSources();return this.program=this.createShaderProgram(i.vertex,i.fragment),null!==this.program}catch(t){return console.warn("Failed to initialize WebGL:",t),!1}}createShaderProgram(t,e){if(!this.gl)return null;let i=this.createShader(this.gl.VERTEX_SHADER,t),r=this.createShader(this.gl.FRAGMENT_SHADER,e);if(!i||!r)return null;let n=this.gl.createProgram();return n?(this.gl.attachShader(n,i),this.gl.attachShader(n,r),this.gl.linkProgram(n),this.gl.getProgramParameter(n,this.gl.LINK_STATUS)?n:(console.error("Shader program link error:",this.gl.getProgramInfoLog(n)),null)):null}createShader(t,e){if(!this.gl)return null;let i=this.gl.createShader(t);return i?(this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(console.error("Shader compile error:",this.gl.getShaderInfoLog(i)),this.gl.deleteShader(i),null)):null}setupWebGLState(t){this.gl&&this.webglCanvas&&(this.webglCanvas.width===t.width&&this.webglCanvas.height===t.height||(this.webglCanvas.width=t.width,this.webglCanvas.height=t.height),this.gl.viewport(0,0,this.webglCanvas.width,this.webglCanvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT))}createFullScreenQuad(){if(!this.gl)return null;let t=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,1,1,1,0]),e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),e}createTextureFromCanvas(t){if(!this.gl)return null;let e=this.gl.createTexture();return this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),e}setupVertexAttributes(){if(!this.gl||!this.program)return;let t=this.gl.getAttribLocation(this.program,"a_position"),e=this.gl.getAttribLocation(this.program,"a_texCoord");this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,2,this.gl.FLOAT,!1,16,0),this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,16,8)}createOutputCanvas(t){let e=hd.createCanvas({width:t.width,height:t.height,dpr:hd.devicePixelRatio}),i=e.getContext("2d");return i?(i.clearRect(0,0,t.width,t.height),i.drawImage(t,0,0),{canvas:e,ctx:i}):null}getShaderSources(){return null}applyWebGLEffect(t){return null}applyCanvas2DEffect(t){return null}supportsWebGL(){return null!==this.getShaderSources()}supportsCanvas2D(){return this.applyCanvas2DEffect!==WG.prototype.applyCanvas2DEffect}release(){super.release(),this.gl&&(this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.gl=null),this.webglCanvas&&(this.webglCanvas=null),this.currentAnimationRatio=0,this.animationTime=0}afterStageRender(t,e){let i=null;if(this.supportsWebGL()&&(this.gl||this.initWebGL(e)||console.warn("WebGL初始化失败，尝试Canvas 2D回退"),this.gl)){if(i=this.applyWebGLEffect(e))return i;console.warn("WebGL特效执行失败，尝试Canvas 2D回退")}if(this.supportsCanvas2D()){if(i=this.applyCanvas2DEffect(e))return i;console.warn("Canvas 2D特效执行失败")}return this.supportsWebGL()||this.supportsCanvas2D()||console.error(`特效类 ${this.constructor.name} 未实现任何渲染方法。请实现 applyWebGLEffect 或 applyCanvas2DEffect 方法。`),e}}class WV extends WG{constructor(t,e,i,r,n){super(t,e,i,r,n)}getShaderSources(){return null}applyWebGLEffect(t){return null}}class WU extends WG{constructor(t,e,i,r,n){super(t,e,i,r,n)}getShaderSources(){return null}applyWebGLEffect(t){return null}applyCanvas2DEffect(t){return null}supportsWebGL(){return this.getShaderSources!==WU.prototype.getShaderSources&&null!==this.getShaderSources()}supportsCanvas2D(){return this.applyCanvas2DEffect!==WU.prototype.applyCanvas2DEffect}afterStageRender(t,e){var i,r;let n=null;if(!1!==(null==(r=null==(i=this.params)?void 0:i.options)?void 0:r.useWebGL)){if(this.supportsWebGL()&&(this.gl||this.initWebGL(e)||console.warn("WebGL初始化失败，尝试Canvas 2D回退"),this.gl)){if(n=this.applyWebGLEffect(e))return n;console.warn("WebGL特效执行失败，尝试Canvas 2D回退")}if(this.supportsCanvas2D()){if(n=this.applyCanvas2DEffect(e))return n;console.warn("Canvas 2D特效执行失败")}}else if(this.supportsCanvas2D()){if(n=this.applyCanvas2DEffect(e))return n;console.warn("Canvas 2D特效执行失败")}else console.warn(`${this.constructor.name}: useWebGL=false 但未实现Canvas 2D方法`);return this.supportsWebGL()||this.supportsCanvas2D()||console.error(`特效类 ${this.constructor.name} 未实现任何渲染方法。请实现 applyWebGLEffect 或 applyCanvas2DEffect 方法。`),e}}class WK{static createTempCanvas(t,e,i){return hd.createCanvas({width:t,height:e,dpr:i||hd.devicePixelRatio})}static cloneImageData(t){return new ImageData(new Uint8ClampedArray(t.data),t.width,t.height)}static lerp(t,e,i){return t*(1-i)+e*i}static smoothstep(t,e,i){let r=Math.max(0,Math.min(1,(i-t)/(e-t)));return r*r*(3-2*r)}static distance(t,e,i,r){let n=i-t,l=r-e;return Math.sqrt(n*n+l*l)}static normalizeAngle(t){return(t+Math.PI)/(2*Math.PI)}static pixelNoise(t,e,i){if(i<=0)return 0;let r=43758.5453*Math.sin(Math.floor(t/i)*i*12.9898+Math.floor(e/i)*i*78.233);return r-Math.floor(r)}static generateNoiseTexture(t,e){let i=new Uint8Array(t*e);for(let t=0;t<i.length;t++)i[t]=Math.floor(256*Math.random());return i}static applyCSSFilter(t,e){let i=this.createTempCanvas(t.width,t.height),r=i.getContext("2d");return r?(r.filter=e,r.drawImage(t,0,0),r.filter="none",i):t}static extractChannel(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i.length);for(let t=0;t<i.length;t+=4)l[t]=0,l[t+1]=0,l[t+2]=0,l[t+3]=i[t+3],e>=0&&e<=2&&(l[t+e]=i[t+e]);return new ImageData(l,r,n)}static blendImageData(t,e,i){let{data:r,width:n,height:l}=t,{data:s}=e,a=new Uint8ClampedArray(r.length);for(let t=0;t<r.length;t+=4)a[t]=Math.round(this.lerp(r[t],s[t],i)),a[t+1]=Math.round(this.lerp(r[t+1],s[t+1],i)),a[t+2]=Math.round(this.lerp(r[t+2],s[t+2],i)),a[t+3]=Math.round(this.lerp(r[t+3],s[t+3],i));return new ImageData(a,n,l)}static getLuminance(t,e,i){return .299*t+.587*e+.114*i}static applySepiaToPixel(t,e,i){return[Math.min(255,.393*t+.769*e+.189*i),Math.min(255,.349*t+.686*e+.168*i),Math.min(255,.272*t+.534*e+.131*i)]}static calculateDynamicStrength(t,e){return e/(2*Math.PI)*t}}class WX{}WX.STANDARD_VERTEX_SHADER="\n    attribute vec2 a_position;\n    attribute vec2 a_texCoord;\n    varying vec2 v_texCoord;\n\n    void main() {\n      gl_Position = vec4(a_position, 0.0, 1.0);\n      v_texCoord = a_texCoord;\n    }\n  ",WX.SHADER_FUNCTIONS="\n    // 亮度计算函数\n    float luminance(vec3 color) {\n      return dot(color, vec3(0.299, 0.587, 0.114));\n    }\n\n    // 褐色调函数\n    vec3 sepia(vec3 color) {\n      float r = color.r * 0.393 + color.g * 0.769 + color.b * 0.189;\n      float g = color.r * 0.349 + color.g * 0.686 + color.b * 0.168;\n      float b = color.r * 0.272 + color.g * 0.534 + color.b * 0.131;\n      return vec3(r, g, b);\n    }\n\n    // 线性插值函数\n    float lerp(float a, float b, float t) {\n      return a * (1.0 - t) + b * t;\n    }\n\n\n    // 简单噪声函数\n    float pixelNoise(vec2 coord, float pixelSize) {\n      vec2 gridCoord = floor(coord / pixelSize) * pixelSize;\n      return fract(sin(dot(gridCoord, vec2(12.9898, 78.233))) * 43758.5453123);\n    }\n\n    // 动态强度计算\n    float calculateDynamicStrength(float baseStrength, float time) {\n      return baseStrength * (time / 6.28318531); // 2π\n    }\n  ";class WY extends WU{constructor(t,e,i,r,n){var l,s,a,o;super(t,e,i,r,n),this.noiseData=null;let h=null==(l=null==n?void 0:n.options)?void 0:l.noiseScale,d=void 0!==h?Math.max(0,Math.floor(h)):8;this.dissolveConfig={dissolveType:(null==(s=null==n?void 0:n.options)?void 0:s.dissolveType)||"outward",useWebGL:void 0===(null==(a=null==n?void 0:n.options)?void 0:a.useWebGL)||n.options.useWebGL,noiseScale:d,fadeEdge:void 0===(null==(o=null==n?void 0:n.options)?void 0:o.fadeEdge)||n.options.fadeEdge}}getShaderSources(){return{vertex:WX.STANDARD_VERTEX_SHADER,fragment:`
      precision mediump float;
      uniform sampler2D u_texture;
      uniform sampler2D u_noiseTexture;
      uniform float u_time;
      uniform int u_dissolveType;
      uniform vec2 u_resolution;
      uniform float u_noiseScale;
      uniform bool u_fadeEdge;
      varying vec2 v_texCoord;

      ${WX.SHADER_FUNCTIONS}

      // 向外溶解函数
      float outwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        vec2 center = vec2(0.5, 0.5);
        float distFromCenter = length(uv - center);
        float maxDist = length(vec2(0.5, 0.5));

        // 归一化距离 (0为中心，1为边缘)
        float normalizedDist = distFromCenter / maxDist;

        // 向外溶解：从边缘开始溶解，time控制溶解进度
        // 增加安全边距，确保动画结束时完全溶解
        float edgeThreshold = 1.2 - time * 1.5;

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          // 添加基于像素大小的噪声，让边缘呈现颗粒状
          vec2 pixelCoord = uv * resolution; // 转换为像素坐标
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.4; // 增强噪声影响
          edgeThreshold += noiseInfluence;
          return normalizedDist > edgeThreshold ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.15; // 渐变宽度
            return 1.0 - smoothstep(edgeThreshold - fadeWidth, edgeThreshold, normalizedDist);
          } else {
            // 硬边缘：返回0或1
            return normalizedDist > edgeThreshold ? 0.0 : 1.0;
          }
        }
      }

      // 向内溶解函数
      float inwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        vec2 center = vec2(0.5, 0.5);
        float distFromCenter = length(uv - center);
        float maxDist = length(vec2(0.5, 0.5));

        float normalizedDist = distFromCenter / maxDist;

        // 向内溶解：从中心开始溶解，time控制溶解进度
        // 增加系数，确保动画结束时完全溶解
        float centerThreshold = time * 1.4;

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.4;
          centerThreshold += noiseInfluence;
          return normalizedDist < centerThreshold ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.15; // 渐变宽度
            return smoothstep(centerThreshold, centerThreshold + fadeWidth, normalizedDist);
          } else {
            // 硬边缘：返回0或1
            return normalizedDist < centerThreshold ? 0.0 : 1.0;
          }
        }
      }

      // 径向溶解函数
      float radialDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        vec2 center = vec2(0.5, 0.5);
        float angle = atan(uv.y - center.y, uv.x - center.x);
        float normalizedAngle = (angle + 3.14159) / (2.0 * 3.14159);

        // 径向溶解：按角度顺序溶解，time控制溶解进度
        // 增加系数，确保动画结束时完全溶解
        float angleThreshold = time * 1.2;

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          angleThreshold += noiseInfluence;
          return normalizedAngle < angleThreshold ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(angleThreshold, angleThreshold + fadeWidth, normalizedAngle);
          } else {
            // 硬边缘：返回0或1
            return normalizedAngle < angleThreshold ? 0.0 : 1.0;
          }
        }
      }

      // 从左到右溶解函数
      float leftToRightDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // 左到右溶解：从x=0开始向x=1溶解
        float dissolvePosition = time * 1.2; // 增加系数确保完全溶解

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.x < dissolvePosition ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.x);
          } else {
            // 硬边缘：返回0或1
            return uv.x < dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      // 从右到左溶解函数
      float rightToLeftDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // 右到左溶解：从x=1开始向x=0溶解
        float dissolvePosition = 1.0 - time * 1.2; // 增加系数确保完全溶解

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.x > dissolvePosition ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.x);
          } else {
            // 硬边缘：返回0或1
            return uv.x > dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      // 从上到下溶解函数
      float topToBottomDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // 上到下溶解：从y=0开始向y=1溶解
        float dissolvePosition = time * 1.2; // 增加系数确保完全溶解

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.y < dissolvePosition ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.y);
          } else {
            // 硬边缘：返回0或1
            return uv.y < dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      // 从下到上溶解函数
      float bottomToTopDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // 下到上溶解：从y=1开始向y=0溶解
        float dissolvePosition = 1.0 - time * 1.2; // 增加系数确保完全溶解

        // 当pixelSize > 0时添加颗粒效果
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.y > dissolvePosition ? 0.0 : 1.0;
        } else {
          // 平滑溶解：根据fadeEdge决定是否使用渐变
          if (u_fadeEdge) {
            // 柔和边缘：返回渐变值
            float fadeWidth = 0.08; // 渐变宽度
            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.y);
          } else {
            // 硬边缘：返回0或1
            return uv.y > dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      void main() {
        vec2 uv = v_texCoord;
        vec4 texColor = texture2D(u_texture, uv);

        float alpha = 1.0;

        // 根据溶解类型选择对应的溶解函数
        if (u_dissolveType == 0) {
          alpha = outwardDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 1) {
          alpha = inwardDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 2) {
          alpha = radialDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 3) {
          alpha = leftToRightDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 4) {
          alpha = rightToLeftDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 5) {
          alpha = topToBottomDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 6) {
          alpha = bottomToTopDissolve(uv, u_time, u_noiseScale, u_resolution);
        }

        gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);
      }
    `}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return t;this.setupWebGLState(t);let e=this.createTextureFromCanvas(t);if(!e)return t;this.noiseData||(this.noiseData=WK.generateNoiseTexture(256,256));let i=this.gl.createTexture();this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,256,256,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,this.noiseData),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);let r=this.createFullScreenQuad();return r?(this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setUniforms(),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.deleteTexture(e),this.gl.deleteTexture(i),this.gl.deleteBuffer(r),this.webglCanvas):t}setUniforms(){if(!this.gl||!this.program||!this.webglCanvas)return;let t=this.gl.getUniformLocation(this.program,"u_texture"),e=this.gl.getUniformLocation(this.program,"u_noiseTexture"),i=this.gl.getUniformLocation(this.program,"u_time"),r=this.gl.getUniformLocation(this.program,"u_dissolveType"),n=this.gl.getUniformLocation(this.program,"u_resolution"),l=this.gl.getUniformLocation(this.program,"u_noiseScale"),s=this.gl.getUniformLocation(this.program,"u_fadeEdge");this.gl.uniform1i(t,0),this.gl.uniform1i(e,1),this.gl.uniform1f(i,this.currentAnimationRatio),this.gl.uniform2f(n,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1f(l,this.dissolveConfig.noiseScale),this.gl.uniform1i(s,+!!this.dissolveConfig.fadeEdge),this.gl.uniform1i(r,{outward:0,inward:1,radial:2,leftToRight:3,rightToLeft:4,topToBottom:5,bottomToTop:6}[this.dissolveConfig.dissolveType]||0)}applyCanvas2DEffect(t){let e,i=this.createOutputCanvas(t);if(!i)return t;let{canvas:r,ctx:n}=i,l=n.getImageData(0,0,t.width,t.height),s=this.currentAnimationRatio;switch(this.dissolveConfig.dissolveType){case"outward":e=this.applyOutwardDissolve(l,s);break;case"inward":e=this.applyInwardDissolve(l,s);break;case"radial":e=this.applyRadialDissolve(l,s);break;case"leftToRight":e=this.applyLeftToRightDissolve(l,s);break;case"rightToLeft":e=this.applyRightToLeftDissolve(l,s);break;case"topToBottom":e=this.applyTopToBottomDissolve(l,s);break;case"bottomToTop":e=this.applyBottomToTopDissolve(l,s);break;default:e=l}return n.putImageData(e,0,0),r}applyOutwardDissolve(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i.length);l.set(i);let s=r/2,a=n/2,o=Math.sqrt(s*s+a*a),h=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=i-s,d=t-a,u=Math.sqrt(n*n+d*d)/o,c=1.2-1.4*e,p=1;if(h>0)c+=.4*(WK.pixelNoise(i,t,h)-.5),p=u>c?0:1;else if(this.dissolveConfig.fadeEdge){let t=c-.15;p=u<t?1:u>c?0:1-(u-t)/(c-t)}else p=u>c?0:1;let g=4*(t*r+i);l[g+3]=Math.floor(l[g+3]*p)}return new ImageData(l,r,n)}applyInwardDissolve(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i.length);l.set(i);let s=r/2,a=n/2,o=Math.sqrt(s*s+a*a),h=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=i-s,d=t-a,u=Math.sqrt(n*n+d*d)/o,c=1.4*e,p=1;if(h>0)c+=.4*(WK.pixelNoise(i,t,h)-.5),p=u<c?0:1;else if(this.dissolveConfig.fadeEdge){let t=c+.15;p=u<c?0:u>t?1:(u-c)/(t-c)}else p=u<c?0:1;let g=4*(t*r+i);l[g+3]=Math.floor(l[g+3]*p)}return new ImageData(l,r,n)}applyRadialDissolve(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i.length);l.set(i);let s=r/2,a=n/2,o=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=(Math.atan2(t-a,i-s)+Math.PI)/(2*Math.PI),h=1.2*e,d=1;if(o>0)h+=.3*(WK.pixelNoise(i,t,o)-.5),d=n<h?0:1;else if(this.dissolveConfig.fadeEdge){let t=h+.08;d=n<h?0:n>t?1:(n-h)/(t-h)}else d=n<h?0:1;let u=4*(t*r+i);l[u+3]=Math.floor(l[u+3]*d)}return new ImageData(l,r,n)}applyLeftToRightDissolve(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i.length);l.set(i);let s=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=i/r,a=1.2*e,o=1;if(s>0)a+=.3*(WK.pixelNoise(i,t,s)-.5),o=n<a?0:1;else if(this.dissolveConfig.fadeEdge){let t=a+.08;o=n<a?0:n>t?1:(n-a)/(t-a)}else o=n<a?0:1;let h=4*(t*r+i);l[h+3]=Math.floor(l[h+3]*o)}return new ImageData(l,r,n)}applyRightToLeftDissolve(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i.length);l.set(i);let s=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let n=i/r,a=1-1.2*e,o=1;if(s>0)a+=.3*(WK.pixelNoise(i,t,s)-.5),o=n>a?0:1;else if(this.dissolveConfig.fadeEdge){let t=a-.08;o=n<t?1:n>a?0:1-(n-t)/(a-t)}else o=n>a?0:1;let h=4*(t*r+i);l[h+3]=Math.floor(l[h+3]*o)}return new ImageData(l,r,n)}applyTopToBottomDissolve(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i.length);l.set(i);let s=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let a=t/n,o=1.2*e,h=1;if(s>0)o+=.3*(WK.pixelNoise(i,t,s)-.5),h=a<o?0:1;else if(this.dissolveConfig.fadeEdge){let t=o+.08;h=a<o?0:a>t?1:(a-o)/(t-o)}else h=a<o?0:1;let d=4*(t*r+i);l[d+3]=Math.floor(l[d+3]*h)}return new ImageData(l,r,n)}applyBottomToTopDissolve(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i.length);l.set(i);let s=this.dissolveConfig.noiseScale;for(let t=0;t<n;t++)for(let i=0;i<r;i++){let a=t/n,o=1-1.2*e,h=1;if(s>0)o+=.3*(WK.pixelNoise(i,t,s)-.5),h=a>o?0:1;else if(this.dissolveConfig.fadeEdge){let t=o-.08;h=a<t?1:a>o?0:1-(a-t)/(o-t)}else h=a>o?0:1;let d=4*(t*r+i);l[d+3]=Math.floor(l[d+3]*h)}return new ImageData(l,r,n)}}class W$ extends WU{constructor(t,e,i,r,n){var l,s,a;super(t,e,i,r,n);let o=Math.max(0,Math.min(1,void 0!==(null==(l=null==n?void 0:n.options)?void 0:l.strength)?n.options.strength:1));this.colorConfig={effectType:(null==(s=null==n?void 0:n.options)?void 0:s.effectType)||"grayscale",strength:o,useWebGL:void 0===(null==(a=null==n?void 0:n.options)?void 0:a.useWebGL)||n.options.useWebGL}}getShaderSources(){return{vertex:WX.STANDARD_VERTEX_SHADER,fragment:`
      precision mediump float;
      uniform sampler2D u_texture;
      uniform float u_time;
      uniform float u_strength;
      uniform int u_effectType;
      uniform vec2 u_resolution;
      varying vec2 v_texCoord;

      ${WX.SHADER_FUNCTIONS}

      void main() {
        vec2 uv = v_texCoord;
        vec4 originalColor = texture2D(u_texture, uv);
        vec3 color = originalColor.rgb;

        // 计算动态强度
        float dynamicStrength = calculateDynamicStrength(u_strength, u_time);

        if (u_effectType == 0) {
          // 灰度效果
          float gray = luminance(color);
          vec3 grayColor = vec3(gray);
          color = mix(color, grayColor, dynamicStrength);
        } else if (u_effectType == 1) {
          // 褐色调效果
          vec3 sepiaColor = sepia(color);
          color = mix(color, sepiaColor, dynamicStrength);
        }

        gl_FragColor = vec4(color, originalColor.a);
      }
    `}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);let e=this.createTextureFromCanvas(t);if(!e)return null;let i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setColorUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}setColorUniforms(){if(!this.gl||!this.program)return;let t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),r=this.gl.getUniformLocation(this.program,"u_effectType"),n=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.colorConfig.strength),this.gl.uniform2f(n,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(r,{grayscale:0,sepia:1}[this.colorConfig.effectType]||0)}applyCanvas2DEffect(t){if(this.colorConfig.strength<=0){let e=this.createOutputCanvas(t);return e?e.canvas:null}if(this.canUseCSSFilter())return this.applyCSSFilter(t);let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r,n=i.getImageData(0,0,t.width,t.height),l=this.getAnimationTime();switch(this.colorConfig.effectType){case"grayscale":default:r=this.applyGrayscaleEffect(n,this.colorConfig.strength,l);break;case"sepia":r=this.applySepiaEffect(n,this.colorConfig.strength,l)}return i.clearRect(0,0,t.width,t.height),i.putImageData(r,0,0),e.canvas}catch(t){return console.warn("Canvas 2D color effect failed:",t),null}}canUseCSSFilter(){var t;return!!window.useFilterAPI&&"undefined"!=typeof CSS&&(null==(t=CSS.supports)?void 0:t.call(CSS,"filter","grayscale(1)"))}applyCSSFilter(t){try{let e=WK.createTempCanvas(t.width,t.height),i=e.getContext("2d");if(!i)return null;let r=this.getAnimationTime(),n=WK.calculateDynamicStrength(this.colorConfig.strength,r),l="";return"grayscale"===this.colorConfig.effectType?l=`grayscale(${Math.min(1,n)})`:"sepia"===this.colorConfig.effectType&&(l=`sepia(${Math.min(1,n)})`),i.filter=l,i.drawImage(t,0,0),i.filter="none",e}catch(t){return console.warn("CSS Filter API failed, falling back to pixel processing:",t),null}}applyGrayscaleEffect(t,e,i){let{data:r,width:n,height:l}=t,s=new Uint8ClampedArray(r.length),a=WK.calculateDynamicStrength(e,i);for(let t=0;t<r.length;t+=4){let e=r[t],i=r[t+1],n=r[t+2],l=r[t+3],o=WK.getLuminance(e,i,n);s[t]=Math.round(WK.lerp(e,o,a)),s[t+1]=Math.round(WK.lerp(i,o,a)),s[t+2]=Math.round(WK.lerp(n,o,a)),s[t+3]=l}return new ImageData(s,n,l)}applySepiaEffect(t,e,i){let{data:r,width:n,height:l}=t,s=new Uint8ClampedArray(r.length),a=WK.calculateDynamicStrength(e,i);for(let t=0;t<r.length;t+=4){let e=r[t],i=r[t+1],n=r[t+2],l=r[t+3],[o,h,d]=WK.applySepiaToPixel(e,i,n);s[t]=Math.round(WK.lerp(e,o,a)),s[t+1]=Math.round(WK.lerp(i,h,a)),s[t+2]=Math.round(WK.lerp(n,d,a)),s[t+3]=l}return new ImageData(s,n,l)}afterStageRender(t,e){if(this.canUseCSSFilter()&&this.colorConfig.strength>0){let t=this.applyCSSFilter(e);if(t)return t}return super.afterStageRender(t,e)}}class Wq extends WU{constructor(t,e,i,r,n){var l,s,a;super(t,e,i,r,n),this.distortionConfig={distortionType:(null==(l=null==n?void 0:n.options)?void 0:l.distortionType)||"wave",strength:(null==(s=null==n?void 0:n.options)?void 0:s.strength)||.3,useWebGL:void 0===(null==(a=null==n?void 0:n.options)?void 0:a.useWebGL)||n.options.useWebGL}}getShaderSources(){return{vertex:"\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        v_texCoord = a_texCoord;\n      }\n    ",fragment:"\n      precision mediump float;\n      uniform sampler2D u_texture;\n      uniform float u_time;\n      uniform float u_strength;\n      uniform int u_distortionType;\n      uniform vec2 u_resolution;\n      varying vec2 v_texCoord;\n\n      // 波浪扭曲函数\n      vec2 wave(vec2 uv, float time, float strength) {\n        float waveX = sin(uv.y * 10.0 + time * 3.0) * strength * 0.1;\n        float waveY = sin(uv.x * 10.0 + time * 2.0) * strength * 0.1;\n        return uv + vec2(waveX, waveY);\n      }\n\n      // 涟漪扭曲函数\n      vec2 ripple(vec2 uv, float time, float strength) {\n        vec2 center = vec2(0.5, 0.5);\n        float distance = length(uv - center);\n        float ripple = sin(distance * 20.0 - time * 5.0) * strength * 0.1;\n        vec2 direction = normalize(uv - center);\n        return uv + direction * ripple;\n      }\n\n      // 漩涡扭曲函数\n      vec2 swirl(vec2 uv, float time, float strength) {\n        vec2 center = vec2(0.5, 0.5);\n        vec2 delta = uv - center;\n        float dist = length(delta);\n        float originalAngle = atan(delta.y, delta.x);\n        float rotationAngle = dist * strength * time * 2.0;\n        float finalAngle = originalAngle + rotationAngle;\n        return center + dist * vec2(cos(finalAngle), sin(finalAngle));\n      }\n\n      void main() {\n        vec2 uv = v_texCoord;\n\n        // 根据扭曲类型应用相应变换\n        if (u_distortionType == 0) {\n          uv = wave(uv, u_time, u_strength);\n        } else if (u_distortionType == 1) {\n          uv = ripple(uv, u_time, u_strength);\n        } else if (u_distortionType == 2) {\n          uv = swirl(uv, u_time, u_strength);\n        }\n\n        // 边界检查\n        if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        } else {\n          gl_FragColor = texture2D(u_texture, uv);\n        }\n      }\n    "}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);let e=this.createTextureFromCanvas(t);if(!e)return null;let i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setDistortionUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}setDistortionUniforms(){if(!this.gl||!this.program)return;let t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),r=this.gl.getUniformLocation(this.program,"u_distortionType"),n=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.distortionConfig.strength),this.gl.uniform2f(n,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(r,{wave:0,ripple:1,swirl:2}[this.distortionConfig.distortionType]||0)}applyCanvas2DEffect(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r,n=i.getImageData(0,0,t.width,t.height),l=this.getAnimationTime();switch(this.distortionConfig.distortionType){case"wave":r=this.applyWaveDistortion(n,this.distortionConfig.strength,l);break;case"ripple":r=this.applyRippleDistortion(n,this.distortionConfig.strength,l);break;case"swirl":r=this.applySwirlDistortion(n,this.distortionConfig.strength,l);break;default:r=n}return i.clearRect(0,0,t.width,t.height),i.putImageData(r,0,0),e.canvas}catch(t){return console.warn("Canvas 2D distortion effect failed:",t),null}}applyWaveDistortion(t,e,i){let{data:r,width:n,height:l}=t,s=new Uint8ClampedArray(r.length);for(let t=0;t<l;t++)for(let a=0;a<n;a++){let o=Math.sin(.1*t+3*i)*e*20,h=Math.sin(.1*a+2*i)*e*20,d=Math.round(a-o),u=Math.round(t-h),c=4*(t*n+a);if(d>=0&&d<n&&u>=0&&u<l){let t=4*(u*n+d);s[c]=r[t],s[c+1]=r[t+1],s[c+2]=r[t+2],s[c+3]=r[t+3]}else s[c+3]=0}return new ImageData(s,n,l)}applyRippleDistortion(t,e,i){let{data:r,width:n,height:l}=t,s=new Uint8ClampedArray(r.length),a=n/2,o=l/2;for(let t=0;t<l;t++)for(let h=0;h<n;h++){let d=h-a,u=t-o,c=Math.sin(.2*Math.sqrt(d*d+u*u)-5*i)*e*10,p=Math.atan2(u,d),g=Math.round(h-Math.cos(p)*c),f=Math.round(t-Math.sin(p)*c),m=4*(t*n+h);if(g>=0&&g<n&&f>=0&&f<l){let t=4*(f*n+g);s[m]=r[t],s[m+1]=r[t+1],s[m+2]=r[t+2],s[m+3]=r[t+3]}else s[m+3]=0}return new ImageData(s,n,l)}applySwirlDistortion(t,e,i){let{data:r,width:n,height:l}=t,s=new Uint8ClampedArray(r.length),a=n/2,o=l/2;for(let t=0;t<l;t++)for(let h=0;h<n;h++){let d=h-a,u=t-o,c=Math.sqrt(d*d+u*u),p=Math.atan2(u,d)+c*e*i*.02,g=Math.round(a+c*Math.cos(p)),f=Math.round(o+c*Math.sin(p)),m=4*(t*n+h);if(g>=0&&g<n&&f>=0&&f<l){let t=4*(f*n+g);s[m]=r[t],s[m+1]=r[t+1],s[m+2]=r[t+2],s[m+3]=r[t+3]}else s[m+3]=0}return new ImageData(s,n,l)}afterStageRender(t,e){return this.distortionConfig.strength<=0?e:super.afterStageRender(t,e)}}class WJ extends WU{constructor(t,e,i,r,n){var l,s,a,o,h;super(t,e,i,r,n),this.particles=[],this.positionBuffer=null,this.colorBuffer=null,this.particleConfig={effectType:(null==(l=null==n?void 0:n.options)?void 0:l.effectType)||"gravity",count:(null==(s=null==n?void 0:n.options)?void 0:s.count)||4e3,size:(null==(a=null==n?void 0:n.options)?void 0:a.size)||20,strength:(null==(o=null==n?void 0:n.options)?void 0:o.strength)||1.5,useWebGL:void 0===(null==(h=null==n?void 0:n.options)?void 0:h.useWebGL)||n.options.useWebGL}}getShaderSources(){return{vertex:"\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_size;\n\n      uniform vec2 u_resolution;\n      uniform float u_time;\n      uniform float u_forceStrength;\n      uniform int u_effectType;\n\n      varying vec4 v_color;\n\n      void main() {\n        // 将像素坐标转换为剪辑空间坐标\n        vec2 clipSpace = ((a_position / u_resolution) * 2.0) - 1.0;\n        clipSpace.y = -clipSpace.y; // 翻转Y轴\n\n        gl_Position = vec4(clipSpace, 0.0, 1.0);\n        gl_PointSize = a_size;\n        v_color = a_color;\n      }\n    ",fragment:"\n      precision mediump float;\n      varying vec4 v_color;\n\n      void main() {\n        // 创建圆形粒子\n        vec2 coord = gl_PointCoord - vec2(0.5);\n        float distance = length(coord);\n\n        if (distance > 0.5) {\n          discard;\n        }\n\n        // 保持原始颜色，只调整透明度渐变\n        gl_FragColor = vec4(v_color.rgb, v_color.a);\n      }\n    "}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t),0===this.particles.length&&this.extractParticles(t),this.updateParticles(t);let e=this.gl;return e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.useProgram(this.program),this.prepareAndDrawParticles(e),this.webglCanvas}applyCanvas2DEffect(t){let e=this.createOutputCanvas(t);if(!e)return null;let{canvas:i,ctx:r}=e,n=this.currentAnimationRatio;switch(this.particleConfig.effectType){case"explode":this.applyCanvas2DExplode(r,t,n);break;case"gravity":this.applyCanvas2DGravity(r,t,n);break;case"vortex":this.applyCanvas2DVortex(r,t,n);break;default:r.globalAlpha=Math.max(0,1-n),r.drawImage(t,0,0)}return i}extractParticles(t){let e=WK.createTempCanvas(t.width,t.height,1),i=e.getContext("2d");if(!i)return;i.drawImage(t,0,0,e.width,e.height);let r=i.getImageData(0,0,e.width,e.height).data;this.particles=[];let n=Math.max(1,Math.floor(Math.sqrt(e.width*e.height/(1.5*this.particleConfig.count))));for(let i=0;i<e.height;i+=n)for(let l=0;l<e.width;l+=n){let n=4*(i*e.width+l),s=r[n],a=r[n+1],o=r[n+2],h=r[n+3];if(h>5){let r=l/e.width*t.width,n=i/e.height*t.height,d={x:r,y:n,originX:r,originY:n,vx:0,vy:0,r:s/255,g:a/255,b:o/255,a:Math.max(.6,h/255),life:1,size:this.particleConfig.size*(1+.5*Math.random())};this.particles.push(d)}}}updateParticles(t){let e=t.width/2,i=t.height/2,r=this.currentAnimationRatio,n=this.getDurationFromParent(),l=n<2e3,s=l?Math.max(1.5,3e3/n):1,a=l?Math.min(2,2e3/n):1;this.particles.forEach(n=>{let o=n.x-e,h=n.y-i,d=Math.sqrt(o*o+h*h),u=Math.atan2(h,o);this.applyParticleForces(n,u,d,r,a,t),this.updateParticleProperties(n,r,l,s,a)})}applyParticleForces(t,e,i,r,n,l){let s=this.getAnimationTime();switch(this.particleConfig.effectType){case"explode":let a=r*this.particleConfig.strength*n*5;t.vx+=Math.cos(e)*a,t.vy+=Math.sin(e)*a;break;case"gravity":this.applyGravityEffect(t,r,n,l,s);break;case"vortex":this.applyVortexEffect(t,r,n,l,e,i)}}applyGravityEffect(t,e,i,r,n){let l=(t.originX+.7*t.originY)/(r.width+r.height)*.8;if(e>l){let r=(e-l)/(1-l),s=this.particleConfig.strength*r*r*12*i;t.vy+=s;let a=Math.sin(3*n+.02*t.originX)*Math.cos(2*n+.015*t.originY);t.vx+=a*this.particleConfig.strength*2*i}}applyVortexEffect(t,e,i,r,n,l){let s=r.width/2,a=r.height/2,o=n+e*Math.PI*.8,h=l+e*Math.max(r.width,r.height)*1.26,d=s+Math.cos(o)*h,u=a+Math.sin(o)*h,c=e*this.particleConfig.strength*.08*i;t.vx+=(d-t.x)*c,t.vy+=(u-t.y)*c}updateParticleProperties(t,e,i,r,n){let l=i?.99:.98;(t.vx*=l,t.vy*=l,t.x+=t.vx,t.y+=t.vy,i)?(t.life=Math.max(0,1-e*Math.max(.1,.5/r)),t.a=Math.max(.2,t.life*Math.min(1,1.2*t.a)),t.size=Math.max(.7*this.particleConfig.size,this.particleConfig.size*(.5+.5*t.life))):(t.life=Math.max(0,1-.2*e),t.a=Math.max(.1,t.life*Math.min(1,1.5*t.a)),t.size=Math.max(.5*this.particleConfig.size,this.particleConfig.size*(.3+.7*t.life)))}prepareAndDrawParticles(t){let e=new Float32Array(2*this.particles.length),i=new Float32Array(4*this.particles.length),r=new Float32Array(this.particles.length);this.particles.forEach((t,n)=>{e[2*n]=t.x,e[2*n+1]=t.y,i[4*n]=t.r,i[4*n+1]=t.g,i[4*n+2]=t.b,i[4*n+3]=Math.max(.1,t.a),r[n]=Math.max(6,1.5*t.size)}),this.updateParticleBuffers(t,e,i,r),this.setParticleUniforms(t),t.drawArrays(t.POINTS,0,this.particles.length),this.cleanupTempBuffers(t)}updateParticleBuffers(t,e,i,r){this.positionBuffer||(this.positionBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW);let n=t.getAttribLocation(this.program,"a_position");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),this.colorBuffer||(this.colorBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,i,t.DYNAMIC_DRAW);let l=t.getAttribLocation(this.program,"a_color");t.enableVertexAttribArray(l),t.vertexAttribPointer(l,4,t.FLOAT,!1,0,0);let s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,r,t.DYNAMIC_DRAW);let a=t.getAttribLocation(this.program,"a_size");t.enableVertexAttribArray(a),t.vertexAttribPointer(a,1,t.FLOAT,!1,0,0),this._tempSizeBuffer=s}setParticleUniforms(t){let e=t.getUniformLocation(this.program,"u_resolution"),i=t.getUniformLocation(this.program,"u_time"),r=t.getUniformLocation(this.program,"u_forceStrength"),n=t.getUniformLocation(this.program,"u_effectType");t.uniform2f(e,this.webglCanvas.width,this.webglCanvas.height),t.uniform1f(i,this.getAnimationTime()),t.uniform1f(r,this.particleConfig.strength),t.uniform1i(n,{explode:0,vortex:1,gravity:2}[this.particleConfig.effectType]||0)}cleanupTempBuffers(t){let e=this._tempSizeBuffer;e&&(t.deleteBuffer(e),delete this._tempSizeBuffer)}applyCanvas2DExplode(t,e,i){let r=e.width/2,n=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(r,n);let l=1+.5*i;t.scale(l,l),t.translate(-r,-n),t.drawImage(e,0,0),t.restore()}applyCanvas2DGravity(t,e,i){t.save(),t.globalAlpha=Math.max(0,1-i);let r=i*e.height*.3;t.drawImage(e,0,r),t.restore()}applyCanvas2DVortex(t,e,i){let r=e.width/2,n=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(r,n),t.rotate(i*Math.PI*2),t.translate(-r,-n),t.drawImage(e,0,0),t.restore()}}class WQ extends WV{constructor(t,e,i,r,n){var l,s;super(t,e,i,r,n),this.glitchConfig={effectType:(null==(l=null==n?void 0:n.options)?void 0:l.effectType)||"rgb-shift",intensity:void 0!==(null==(s=null==n?void 0:n.options)?void 0:s.intensity)?n.options.intensity:.5}}applyCanvas2DEffect(t){if(this.glitchConfig.intensity<=0){let e=this.createOutputCanvas(t);return e?e.canvas:null}try{switch(this.glitchConfig.effectType){case"rgb-shift":default:return this.applyRGBShiftGlitch(t);case"digital-distortion":return this.applyDigitalDistortionGlitch(t);case"scan-lines":return this.applyScanLineGlitch(t);case"data-corruption":return this.applyDataCorruptionGlitch(t)}}catch(t){return console.warn("Glitch effect failed:",t),null}}applyRGBShiftGlitch(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{i.clearRect(0,0,t.width,t.height);let r=WK.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),n=Math.floor(20*r),l=this.generateRandomOffset(n),s=this.generateRandomOffset(n,.3),a=this.generateRandomOffset(-n),o=WK.createTempCanvas(t.width,t.height),h=o.getContext("2d");h.drawImage(t,0,0);let d=h.getImageData(0,0,t.width,t.height),u=WK.extractChannel(d,0),c=WK.extractChannel(d,1),p=WK.extractChannel(d,2);return i.globalCompositeOperation="screen",h.clearRect(0,0,t.width,t.height),h.putImageData(u,0,0),i.drawImage(o,l.x,l.y),h.clearRect(0,0,t.width,t.height),h.putImageData(c,0,0),i.drawImage(o,s.x,s.y),h.clearRect(0,0,t.width,t.height),h.putImageData(p,0,0),i.drawImage(o,a.x,a.y),i.globalCompositeOperation="source-over",e.canvas}catch(t){return console.warn("RGB shift glitch failed:",t),null}}applyDigitalDistortionGlitch(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r=i.getImageData(0,0,t.width,t.height),n=WK.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),l=this.processDigitalDistortion(r,n);return i.clearRect(0,0,t.width,t.height),i.putImageData(l,0,0),e.canvas}catch(t){return console.warn("Digital distortion glitch failed:",t),null}}applyScanLineGlitch(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r=WK.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),n=Math.max(2,Math.floor(10-8*r));i.globalCompositeOperation="multiply";for(let e=0;e<t.height;e+=n)if(Math.random()<r){let n=.1+.4*r;i.fillStyle=`rgba(0, 0, 0, ${n})`,i.fillRect(0,e,t.width,1)}i.globalCompositeOperation="screen";let l=Math.floor(20*r);for(let e=0;e<l;e++){let e=Math.random()*t.height,n=.3*r;i.fillStyle=`rgba(255, 255, 255, ${n})`,i.fillRect(0,Math.floor(e),t.width,1)}return i.globalCompositeOperation="source-over",e.canvas}catch(t){return console.warn("Scan line glitch failed:",t),null}}applyDataCorruptionGlitch(t){let e=this.createOutputCanvas(t);if(!e)return null;let{ctx:i}=e;try{let r=i.getImageData(0,0,t.width,t.height),n=WK.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),l=this.processDataCorruption(r,n);return i.clearRect(0,0,t.width,t.height),i.putImageData(l,0,0),e.canvas}catch(t){return console.warn("Data corruption glitch failed:",t),null}}generateRandomOffset(t,e=1){return{x:(Math.random()-.5)*t,y:(Math.random()-.5)*t*e}}processDigitalDistortion(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i),s=Math.floor(20*e)+5,a=Math.floor(n/s);for(let t=0;t<s;t++)if(Math.random()<e){let i=t*a,s=Math.min(i+a,n),o=Math.floor((Math.random()-.5)*r*e*.1);this.shiftSliceHorizontal(l,r,n,i,s,o)}let o=.3*e;for(let t=0;t<i.length;t+=4)Math.random()<o&&(l[t]=255*Math.random(),l[t+1]=255*Math.random(),l[t+2]=255*Math.random());return new ImageData(l,r,n)}shiftSliceHorizontal(t,e,i,r,n,l){let s=new Uint8ClampedArray(4*e);for(let i=r;i<n;i++){let r=i*e*4;for(let i=0;i<4*e;i++)s[i]=t[r+i];for(let i=0;i<e;i++){let n=r+4*i,a=(i-l+e)%e*4;t[n]=s[a],t[n+1]=s[a+1],t[n+2]=s[a+2],t[n+3]=s[a+3]}}}processDataCorruption(t,e){let{data:i,width:r,height:n}=t,l=new Uint8ClampedArray(i),s=Math.floor(15*e)+5;for(let t=0;t<s;t++)if(Math.random()<e){let t=Math.floor(Math.random()*r),e=Math.floor(5*Math.random())+1,i=.5>Math.random()?0:255;for(let s=0;s<n;s++)for(let n=0;n<e&&t+n<r;n++){let e=4*(s*r+t+n);l[e]=i,l[e+1]=i,l[e+2]=i}}let a=Math.floor(20*e);for(let t=0;t<a;t++){let t=Math.floor(Math.random()*r),e=Math.floor(Math.random()*n),i=Math.floor(20*Math.random())+5,s=Math.floor(10*Math.random())+2;this.corruptBlock(l,r,n,t,e,i,s)}return new ImageData(l,r,n)}corruptBlock(t,e,i,r,n,l,s){for(let a=0;a<s&&n+a<i;a++)for(let i=0;i<l&&r+i<e;i++){let l=4*((n+a)*e+(r+i));.7>Math.random()&&(t[l]=255*Math.random(),t[l+1]=255*Math.random(),t[l+2]=255*Math.random())}}}class W0 extends gm{constructor(t,e,i,r,n){var l,s;super(t,e,i,r,n),this.blurConfig={blurRadius:(null==(l=null==n?void 0:n.options)?void 0:l.blurRadius)||8,useOptimizedBlur:void 0===(null==(s=null==n?void 0:n.options)?void 0:s.useOptimizedBlur)||n.options.useOptimizedBlur}}applyCSSBlur(t,e){let i=hd.createCanvas({width:t.width,height:t.height,dpr:hd.devicePixelRatio}),r=i.getContext("2d");return r?(r.filter=`blur(${e}px)`,r.drawImage(t,0,0),r.filter="none",i):t}applyDownsampleBlur(t,e){let{width:i,height:r}=t,n=Math.max(1,Math.floor(e/2)),l=Math.floor(i/n),s=Math.floor(r/n),a=hd.createCanvas({width:l,height:s,dpr:1}),o=a.getContext("2d");if(!o)return t;let h=hd.createCanvas({width:i,height:r,dpr:1}),d=h.getContext("2d");return d?(d.putImageData(t,0,0),o.drawImage(h,0,0,l,s),o.filter=`blur(${e/n}px)`,o.drawImage(a,0,0),o.filter="none",d.clearRect(0,0,i,r),d.drawImage(a,0,0,i,r),d.getImageData(0,0,i,r)):t}afterStageRender(t,e){let i;if(this.blurConfig.blurRadius<=0)return e;if(this.blurConfig.useOptimizedBlur)i=this.applyCSSBlur(e,this.blurConfig.blurRadius);else{let t=hd.createCanvas({width:e.width,height:e.height,dpr:hd.devicePixelRatio}),r=t.getContext("2d");if(!r)return!1;r.clearRect(0,0,e.width,e.height),r.drawImage(e,0,0);let n=r.getImageData(0,0,e.width,e.height),l=this.applyDownsampleBlur(n,this.blurConfig.blurRadius);r.putImageData(l,0,0),i=t}let r=i.getContext("2d");return r&&(r.globalCompositeOperation="overlay",r.fillStyle="rgba(255, 255, 255, 0.1)",r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="source-over"),i}}class W1 extends WG{constructor(t,e,i,r,n){var l,s;super(t,e,i,r,n),this.pixelationConfig={maxPixelSize:(null==(l=null==n?void 0:n.options)?void 0:l.maxPixelSize)||20,method:(null==(s=null==n?void 0:n.options)?void 0:s.method)||"out"}}applyDownsamplePixelation(t,e){if(e<=1)return t;let{width:i,height:r}=t,n=Math.ceil(i/e),l=Math.ceil(r/e),s=hd.createCanvas({width:n,height:l,dpr:1}),a=s.getContext("2d");if(!a)return t;let o=hd.createCanvas({width:i,height:r,dpr:hd.devicePixelRatio}),h=o.getContext("2d");return h?(a.imageSmoothingEnabled=!1,h.imageSmoothingEnabled=!1,a.drawImage(t,0,0,n,l),h.drawImage(s,0,0,i,r),o):t}updateAnimationProgress(){return"in"===this.pixelationConfig.method?this.pixelationConfig.maxPixelSize-this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1):1+this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1)}afterStageRender(t,e){let i=this.updateAnimationProgress();return i<=1?e:this.applyDownsamplePixelation(e,i)}}let W2=()=>{yv.registerBuiltInAnimate("increaseCount",CM),yv.registerBuiltInAnimate("fromTo",y9),yv.registerBuiltInAnimate("scaleIn",yV),yv.registerBuiltInAnimate("scaleOut",yU),yv.registerBuiltInAnimate("growHeightIn",ve),yv.registerBuiltInAnimate("growHeightOut",vi),yv.registerBuiltInAnimate("growWidthIn",vn),yv.registerBuiltInAnimate("growWidthOut",vl),yv.registerBuiltInAnimate("growCenterIn",vo),yv.registerBuiltInAnimate("growCenterOut",vh),yv.registerBuiltInAnimate("clipIn",vz),yv.registerBuiltInAnimate("clipOut",vW),yv.registerBuiltInAnimate("fadeIn",yY),yv.registerBuiltInAnimate("fadeOut",y$),yv.registerBuiltInAnimate("growPointsIn",vR),yv.registerBuiltInAnimate("growPointsOut",vP),yv.registerBuiltInAnimate("growPointsXIn",vE),yv.registerBuiltInAnimate("growPointsXOut",vL),yv.registerBuiltInAnimate("growPointsYIn",vH),yv.registerBuiltInAnimate("growPointsYOut",vD),yv.registerBuiltInAnimate("growAngleIn",vS),yv.registerBuiltInAnimate("growAngleOut",vA),yv.registerBuiltInAnimate("growRadiusIn",vm),yv.registerBuiltInAnimate("growRadiusOut",vy),yv.registerBuiltInAnimate("moveIn",y0),yv.registerBuiltInAnimate("moveOut",y1),yv.registerBuiltInAnimate("rotateIn",y4),yv.registerBuiltInAnimate("rotateOut",y6),yv.registerBuiltInAnimate("update",y7),yv.registerBuiltInAnimate("state",y8),yv.registerBuiltInAnimate("labelItemAppear",Wx),yv.registerBuiltInAnimate("labelItemDisappear",Ww),yv.registerBuiltInAnimate("poptipAppear",WS),yv.registerBuiltInAnimate("poptipDisappear",WA),yv.registerBuiltInAnimate("inputText",WC),yv.registerBuiltInAnimate("inputRichText",WM),yv.registerBuiltInAnimate("outputRichText",WT),yv.registerBuiltInAnimate("slideRichText",Wk),yv.registerBuiltInAnimate("slideOutRichText",WR),yv.registerBuiltInAnimate("slideIn",WP),yv.registerBuiltInAnimate("growIn",WB),yv.registerBuiltInAnimate("spinIn",WI),yv.registerBuiltInAnimate("moveScaleIn",WF),yv.registerBuiltInAnimate("moveRotateIn",WO),yv.registerBuiltInAnimate("strokeIn",WE),yv.registerBuiltInAnimate("slideOut",WH),yv.registerBuiltInAnimate("growOut",WD),yv.registerBuiltInAnimate("spinOut",Wz),yv.registerBuiltInAnimate("moveScaleOut",WW),yv.registerBuiltInAnimate("moveRotateOut",WZ),yv.registerBuiltInAnimate("strokeOut",WL),yv.registerBuiltInAnimate("pulse",WN),yv.registerBuiltInAnimate("MotionPath",Wj),yv.registerBuiltInAnimate("streamLight",DZ),yv.registerBuiltInAnimate("dissolve",WY),yv.registerBuiltInAnimate("grayscale",W$),yv.registerBuiltInAnimate("distortion",Wq),yv.registerBuiltInAnimate("particle",WJ),yv.registerBuiltInAnimate("glitch",WQ),yv.registerBuiltInAnimate("gaussianBlur",W0),yv.registerBuiltInAnimate("pixelation",W1)};function W3(){let t=ym.getInstance();t.registerTransition("update","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),t.registerTransition("update","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),t.registerTransition("update","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),t.registerTransition("state","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),t.registerTransition("state","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),t.registerTransition("state","exit",()=>({allowTransition:!0,stopOriginalTransition:!0}))}class W5{constructor(t,e,i,r,n){this.state=t,this.graphics=e,this.config=i||[],this.beforeExecute=r,this.afterExecute=n}execute(t,e){if(!this.graphics.length||!this.config.length)return void(null==e||e());this.beforeExecute&&this.beforeExecute(this.graphics);let i=0,r=this.graphics.length,n=()=>{++i>=r&&(this.afterExecute&&this.afterExecute(this.graphics),null==e||e())};this.graphics.forEach(t=>{if(!t)return void i++;"exit"===this.state&&(t.isExiting=!0);let e=this.config.length>1?this.config.map(e=>({name:this.state,animation:Object.assign(Object.assign({},e),{customParameters:t.context})})):{name:this.state,animation:Object.assign(Object.assign({},this.config[0]),{customParameters:t.context})};t.applyAnimationState([this.state],[e],n)})}executeOnGroup(t,e){if(!this.graphics.length||!this.config.length||!t)return void(null==e||e());this.beforeExecute&&this.beforeExecute(this.graphics);let i=this.config[0],r=[{name:this.state,animation:Object.assign({},i)}];r.forEach(t=>{t.animation.customParameters=(t,e)=>e.context}),t.applyAnimationState([this.state],r,()=>{this.afterExecute&&this.afterExecute(this.graphics),null==e||e()})}}class W4{constructor(){this.name="verticalBarSplit"}shouldApply(t,e){var i,r;let n="rect"===t.type,l="vertical"===(null==(i=t.model)?void 0:i.direction),s=(null==(r=e.context)?void 0:r.diffAttrs)||{};return n&&l&&("x"in s||"width"in s||"x1"in s)&&("y"in s||"height"in s||"y1"in s)}split(t,e){var i;let r=(null==(i=e.context)?void 0:i.diffAttrs)||{},n={},l={};Object.entries(r).forEach(([t,e])=>{"x"===t||"width"===t||"x1"===t?n[t]=e:"y"===t||"height"===t||"y1"===t?l[t]=e:n[t]=e});let s=e.context,a=s.fieldX,o=s.originalFieldX,h=Array.isArray(a)&&a.length>1,d=(o?!(Array.isArray(o)&&o.length>1):!h)&&h;return[{attrs:n,order:d?1:2},{attrs:l,order:d?2:1}]}}class W6{constructor(){this.name="horizontalBarSplit"}shouldApply(t,e){var i,r;let n="rect"===t.type,l="horizontal"===(null==(i=t.model)?void 0:i.direction),s=(null==(r=e.context)?void 0:r.diffAttrs)||{};return n&&l&&("y"in s||"height"in s||"y1"in s)&&("x"in s||"width"in s||"x1"in s)}split(t,e){var i;let r=(null==(i=e.context)?void 0:i.diffAttrs)||{},n={},l={};Object.entries(r).forEach(([t,e])=>{"y"===t||"height"===t||"y1"===t?n[t]=e:"x"===t||"width"===t||"x1"===t?l[t]=e:n[t]=e});let s=e.context,a=s.fieldY,o=s.originalFieldY,h=Array.isArray(a)&&a.length>1,d=!(o?!(Array.isArray(o)&&o.length>1):!h)&&!h;return[{attrs:n,order:d?2:1},{attrs:l,order:d?1:2}]}}class W7{constructor(t){this.splitStrategies=[],this.mark=t,"rect"===t.type&&(this.registerStrategy(new W4),this.registerStrategy(new W6))}registerStrategy(t){this.splitStrategies.push(t)}detect(t,e){let i=[],r=[],n=[],l=[],s=this.mark.model.fieldX,a=this.mark.model.fieldY;return t.forEach(t=>{let e=t.context;switch(e.fieldX&&(e.originalFieldX=e.fieldX),e.fieldY&&(e.originalFieldY=e.fieldY),e.fieldX=s,e.fieldY=a,t.context.animationState){case"update":r.push(t);break;case"enter":n.push(t);break;case"appear":l.push(t);break;default:t.context.diffState===th.exit?i.push(t):t.context.diffState===th.enter?n.push(t):r.push(t)}}),e.size>t.length&&e.forEach((t,e)=>{t.context.diffState!==th.exit||t.isExiting||i.push(t)}),{hasExit:i.length>0,hasUpdate:r.length>0,hasEnter:n.length>0,hasAppear:l.length>0,exitGraphics:i,updateGraphics:r,enterGraphics:n,appearGraphics:l}}createPlanners(t,e){let i=[];if(t.hasExit&&e.exit&&i.push(new W5("exit",t.exitGraphics,e.exit)),t.hasUpdate&&e.update){let r=new Map,n=[];t.updateGraphics.forEach(t=>{let e=!1;for(let i of this.splitStrategies)if(i.shouldApply(this.mark,t)){let n=i.split(this.mark,t),l={graphic:t,steps:n};n.forEach(t=>{let{order:e}=t;r.has(e)||r.set(e,[]),r.get(e).push(l)}),e=!0;break}e||n.push(t)}),n.length>0&&i.push(new W5("update",n,e.update));let l=Array.from(r.keys()).sort((t,e)=>t-e);l.forEach(t=>{let n=r.get(t);if(n&&n.length>0){let r=n.map(({graphic:e,steps:i})=>{let r=i.find(e=>e.order===t);return{graphic:e,attrs:(null==r?void 0:r.attrs)||{}}});i.push(new W5("update",r.map(t=>t.graphic),e.update,t=>{t.forEach((t,e)=>{let i=r[e].attrs,n=t.context;n._originalDiffAttrs||(n._originalDiffAttrs=t.context.diffAttrs),t.context.diffAttrs=i})},e=>{t===l[l.length-1]&&e.forEach(t=>{let e=t.context;e._originalDiffAttrs&&(t.context.diffAttrs=e._originalDiffAttrs,delete e._originalDiffAttrs)})}))}})}return t.hasEnter&&e.enter&&i.push(new W5("enter",t.enterGraphics,e.enter)),t.hasAppear&&e.appear&&i.push(new W5("appear",t.appearGraphics,e.appear)),i}}class W8{registerAnimationSplitStrategy(t){this._grammarDetector||(this._grammarDetector=new W7(this)),this._grammarDetector.registerStrategy(t)}getGrammarDetector(){return this.initGrammarDetector(),this._grammarDetector}initGrammarDetector(){this._grammarDetector||(this._grammarDetector=new W7(this))}_runSequentialAnimations(t){this.initGrammarDetector();let e=this.getAnimationConfig(),i=this._grammarDetector.detect(t,this._graphicMap),r=this._grammarDetector.createPlanners(i,e);this._executePlanners(r,0)}_executePlanners(t,e){if(e>=t.length)return;let i=t[e];i.execute(this._product,()=>{this._executePlanners(t,e+1),"exit"===i.state&&i.graphics.forEach(t=>{t.isExiting&&(this._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release&&t.release())})})}}function W9(){(0,yf.jB)(gW,W8)}class Zt extends w4{constructor(t){super(t),this.type="arc3d",this.numberType=si}updateAABBBounds(t,e,i){let r=this.stage;if(!r||!r.camera)return i;let{outerRadius:n=e.outerRadius,height:l=0}=t,s=n+l;return i.setValue(-s,-s,s,s),iC.graphicService.updateTempAABBBounds(i),iC.graphicService.transformAABBBounds(t,i,e,!1,this),i}getNoWorkAnimateAttr(){return Zt.NOWORK_ANIMATE_ATTR}}function Ze(t){return new Zt(t)}Zt.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},sZ);class Zi extends wV{constructor(t){super(t),this.type="pyramid3d",this.numberType=su}updateAABBBounds(t,e,i){let r=this.stage;return r&&r.camera&&(this.findFace().vertices.forEach(t=>{let e=t[0],r=t[1];i.add(e,r)}),iC.graphicService.updateTempAABBBounds(i),iC.graphicService.transformAABBBounds(t,i,e,!1,this)),i}findFace(){let{points:t}=this.attribute,e=t.map((e,i)=>{let r=3===i?t[0]:t[i+1],n=e.x-r.x;return 0===n?0:(e.y-r.y)/n}),i=t.map(t=>({p:t,d:0})),r=!1,n=0;for(let t=0;t<e.length-1;t++){for(let l=t+1;l<e.length;l++){if(e[t]===e[l]){r=!0;let e=iN.HL.distancePP(i[t].p,i[t+1].p);i[t].d=e,i[t+1].d=e,n=(0,ik.Fp)(n,e);let s=iN.HL.distancePP(i[l].p,i[l+1].p);i[l].d=s,i[l+1].d=s,n=(0,ik.Fp)(n,s)}if(r)break}if(r)break}for(let e=t.length-1;e>=0;e--){let r=t[e];i.unshift({p:r,d:0})}for(let e=0;e<t.length;e++){let r=(n-i[e+t.length].d)/2;i[e].d+=r,i[e+t.length].d+=r}let l={polygons:[],vertices:[],edges:[]};return i.forEach(t=>{l.vertices.push([t.p.x,t.p.y,t.d])}),l.polygons.push({polygon:[0,4,5,1],normal:[0,-1,0]}),l.polygons.push({polygon:[7,6,2,3],normal:[0,1,0]}),l.polygons.push({polygon:[0,4,7,3],normal:[-1,0,0]}),l.polygons.push({polygon:[1,5,6,2],normal:[1,0,0]}),l.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),l.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),l.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],l}_isValid(){return super._isValid()&&4===this.attribute.points.length}getNoWorkAnimateAttr(){return Zi.NOWORK_ANIMATE_ATTR}}function Zr(t){return new Zi(t)}Zi.NOWORK_ANIMATE_ATTR=sZ;let Zn=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]];class Zl extends cZ{constructor(t){super(t),this.type="rect3d",this.numberType=sp}findFace(){let t={polygons:[],vertices:[],edges:[]},e=this.getGraphicTheme(),{x1:i,y1:r,x:n,y:l,length:s=(0,ik.VV)(e.width,e.height)}=this.attribute,{width:a,height:o}=this.attribute;a=null!=a?a:i-n,o=null!=o?o:r-l;for(let e=0;e<Zn.length;e++){let i=Zn[e];t.vertices.push([i[0]*a,i[1]*o,i[2]*s])}return t.polygons.push({polygon:[0,1,5,4],normal:[0,-1,0]}),t.polygons.push({polygon:[2,3,7,6],normal:[0,1,0]}),t.polygons.push({polygon:[4,7,3,0],normal:[-1,0,0]}),t.polygons.push({polygon:[1,2,6,5],normal:[1,0,0]}),t.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),t.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),t.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],t}getNoWorkAnimateAttr(){return Zl.NOWORK_ANIMATE_ATTR}}function Zs(t){return new Zl(t)}Zl.NOWORK_ANIMATE_ATTR=sZ;class Za{constructor(t,e,i=.8){this.dir=t,this.color=e,this.colorRgb=pU.Get(e,tc.Color1),this.ambient=i;let r=(0,ik._b)(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.formatedDir=[t[0]/r,t[1]/r,t[2]/r]}computeColor(t,e){let i,r=this.formatedDir,n=(0,ik.VV)((0,ik.Fp)((t[0]*r[0]+t[1]*r[1]+t[2]*r[2])*(1-this.ambient/2),0)+this.ambient,1);i=(0,nI.Z)(e)?pU.Get(e,tc.Color1):e;let l=this.colorRgb;return`rgb(${l[0]*i[0]*n}, ${l[1]*i[1]*n}, ${l[2]*i[2]*n})`}}let Zo=()=>{d6.registerPlugin("DirectionalLight",Za)};class Zh{set params(t){this._params=Object.assign({},t),this._projectionMatrixCached=this.forceGetProjectionMatrix(),this._viewMatrixCached=this.forceGetViewMatrix()}get params(){return Object.assign({},this._params)}constructor(t){this.params=t}getViewMatrix(){return this._viewMatrixCached||(this._viewMatrixCached=sP.allocate()),this._viewMatrixCached}forceGetViewMatrix(){this._viewMatrixCached||(this._viewMatrixCached=sP.allocate());let{pos:t,center:e,up:i}=this.params.viewParams;return function(t,e,i,r){let n,l,s,a,o,h,d,u,c,p,g=e[0],f=e[1],m=e[2],y=r[0],v=r[1],b=r[2],_=i[0],C=i[1],x=i[2];Math.abs(g-_)<ik.Ho&&Math.abs(f-C)<ik.Ho&&Math.abs(m-x)<ik.Ho?sx(t):(p=1/Math.hypot(d=g-_,u=f-C,c=m-x),d*=p,u*=p,c*=p,(p=Math.hypot(n=v*c-b*u,l=b*d-y*c,s=y*u-v*d))?(n*=p=1/p,l*=p,s*=p):(n=0,l=0,s=0),(p=Math.hypot(a=u*s-c*l,o=c*n-d*s,h=d*l-u*n))?(a*=p=1/p,o*=p,h*=p):(a=0,o=0,h=0),t[0]=n,t[1]=a,t[2]=d,t[3]=0,t[4]=l,t[5]=o,t[6]=u,t[7]=0,t[8]=s,t[9]=h,t[10]=c,t[11]=0,t[12]=-(n*g+l*f+s*m),t[13]=-(a*g+o*f+h*m),t[14]=-(d*g+u*f+c*m),t[15]=1)}(this._viewMatrixCached,t,e,i),this._vp||(this._vp=sP.allocate()),this._vp=sA(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._viewMatrixCached}getProjectionMatrix(){return this._projectionMatrixCached||(this._projectionMatrixCached=sP.allocate()),this._projectionMatrixCached}forceGetProjectionMatrix(){this._projectionMatrixCached||(this._projectionMatrixCached=sP.allocate());let{left:t,top:e,right:i,bottom:r}=this._params;return function(t,e,i,r,n,l,s){let a=1/(e-i),o=1/(r-n),h=1/(0- -2e6);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+i)*a,t[13]=(n+r)*o,t[14]=-2e6*h,t[15]=1}(this._projectionMatrixCached,t,i,r,e,0,-2e6),this._vp||(this._vp=sP.allocate()),this._vp=sA(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._projectionMatrixCached}getField(){let{fieldRatio:t=.8,fieldDepth:e,left:i,right:r}=this._params;return(null!=e?e:r-i)*t}getProjectionScale(t){let e=this.getField();return e/(e+t)}view(t,e,i){let r=[0,0,0];return sM(r,[t,e,i],this._viewMatrixCached),r}vp(t,e,i){let r=[0,0,0],{pos:n}=this._params.viewParams;sM(r,[t,e,i],this._viewMatrixCached),t=r[0],e=r[1],i=r[2];let l=this.getProjectionScale(i);return{x:t*l+n[0],y:e*l+n[1]}}}let Zd=()=>{d6.registerPlugin("OrthoCamera",Zh)};class Zu{constructor(){this.name="ViewTransform3dPlugin",this.activeEvent="onRegister",this._uid=eJ.GenAutoIncrementId(),this.key=this.name+this._uid,this.onMouseDown=t=>{this.option3d||(this.option3d=this.pluginService.stage.option3d),this.option3d&&(this.mousedown=!0,this.pageX=t.page.x,this.pageY=t.page.y)},this.onMouseUp=t=>{this.option3d||(this.option3d=this.pluginService.stage.option3d),this.option3d&&(this.mousedown=!1)},this.onMouseMove=t=>{var e,i;let r=this.pluginService.stage;if(this.option3d||(this.option3d=r.option3d),this.option3d&&this.mousedown)if(this.pageX&&this.pageY){let n=t.page.x-this.pageX,l=t.page.y-this.pageY;this.pageX=t.page.x,this.pageY=t.page.y,this.option3d.alpha=(null!=(e=this.option3d.alpha)?e:0)+n/100,this.option3d.beta=(null!=(i=this.option3d.beta)?i:0)+l/100,r.set3dOptions(this.option3d),r.renderNextFrame()}else this.pageX=t.page.x,this.pageY=t.page.y}}activate(t){this.pluginService=t;let e=t.stage;this.option3d=e.option3d,e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mouseup",this.onMouseUp),e.addEventListener("mousemove",this.onMouseMove)}deactivate(t){let e=t.stage;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("mouseup",this.onMouseUp),e.removeEventListener("mousemove",this.onMouseMove)}}let Zc=()=>{d6.registerPlugin("ViewTransform3dPlugin",Zu)};class Zp extends gg{onBind(){super.onBind(),this.propKeys=["x","y","z","alpha","zIndex"]}onFirstRun(){super.onFirstRun();let t=this.target.getFinalAttribute();t&&this.target.setAttributes(t)}onStart(){super.onStart();let{center:t,r:e}="function"==typeof this.params?this.params():this.params,i=this.target.finalAttribute.x,r=this.target.finalAttribute.y,n=this.target.finalAttribute.z,l=Math.acos((r-t.y)/e),s=Math.acos((i-t.x)/e/Math.sin(l));n-t.z<0&&(s=ik.f7-s),this.theta=s,this.phi=l}onEnd(){}onUpdate(t,e,i){if(null==this.phi||null==this.theta)return;let r=this.target,{center:n,r:l,cb:s}="function"==typeof this.params?this.params():this.params,a=2*Math.PI*e,o=this.theta+a,h=this.phi,d=l*Math.sin(h)*Math.cos(o)+n.x,u=l*Math.cos(h)+n.y,c=l*Math.sin(h)*Math.sin(o)+n.z;for(r.attribute.x=d,r.attribute.y=u,r.attribute.z=c,r.attribute.alpha=o+ik.pi/2;r.attribute.alpha>ik.f7;)r.attribute.alpha-=ik.f7;r.attribute.alpha=ik.f7-r.attribute.alpha,r.attribute.zIndex=-1e4*r.attribute.z,s&&s(i)}}let Zg=class extends ox{constructor(){super(...arguments),this.numberType=si}drawShape(t,e,i,r,n,l,s,a){var o;let h=nP(t,null==l?void 0:l.theme).arc,{fill:d=h.fill}=t.attribute,u=this.valid(t,h,s,a);if(!u)return;let{fVisible:c,sVisible:p,doFill:g,doStroke:f}=u,m=null!=(o=this.z)?o:0,{outerPadding:y=h.outerPadding,innerPadding:v=h.innerPadding,height:b=10}=t.attribute,{outerRadius:_=h.outerRadius,innerRadius:C=h.innerRadius}=t.attribute;_+=y,C-=v;let x=pU.Get(d,tc.Color255),{light:w}=n.stage||{},S=n.hack_pieFace,A={top:m,bottom:m+b},M={top:[0,1,0],bottom:[0,-1,0],outside:[1,0,-1],inside:[1,0,-1]};"bottom"===S||"top"===S?(e.beginPath(),function(t,e,i,r,n,l,s){let{startAngle:a,endAngle:o}=t.getParsedAngle(),h=(0,ik.Wn)(o-a),d=o>a,u=!1;if(l<s){let t=l;l=s,s=t}if(l<=ik.Ho)e.moveTo(i,r,n);else if(h>=ik.f7-ik.Ho)e.moveTo(i+l*(0,ik.mC)(a),r+l*(0,ik.O$)(a),n),e.arc(i,r,l,a,o,!d,n),s>ik.Ho&&(e.moveTo(i+s*(0,ik.mC)(o),r+s*(0,ik.O$)(o),n),e.arc(i,r,s,o,a,d,n));else{let{outerDeltaAngle:h,innerDeltaAngle:u,outerStartAngle:c,outerEndAngle:p,innerEndAngle:g,innerStartAngle:f}=t.getParsePadAngle(a,o),m=l*(0,ik.mC)(c),y=l*(0,ik.O$)(c),v=s*(0,ik.mC)(g),b=s*(0,ik.O$)(g);h<.001||(e.moveTo(i+m,r+y,n),e.arc(i,r,l,c,p,!d,n)),!(s>ik.Ho)||u<.001?e.lineTo(i+v,r+b,n):(e.lineTo(i+v,r+b,n),e.arc(i,r,s,g,f,d,n))}e.closePath()}(t,e,i,r,A[S],_,C),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),g&&(s?s(e,t.attribute,h):c&&(e.setCommonStyle(t,t.attribute,i,r,h),e.fillStyle=w?w.computeColor(M[S],x):d,e.fill())),f&&(a?a(e,t.attribute,h):p&&(e.setStrokeStyle(t,t.attribute,i,r,h),e.stroke()))):"outside"!==S&&"inside"!==S||("inside"===S&&(e.save(),e.beginPath(),e.arc(i,r,C,0,ik.f7,!0,A.top),e.clip()),e.beginPath(),function(t,e,i,r,n,l,s,a){let{startAngle:o,endAngle:h}=t.getParsedAngle(),d=(0,ik.Wn)(h-o),u=h>o,c=!1;if(s<=ik.Ho)e.moveTo(i,r,n);else if(d>=ik.f7-ik.Ho)e.moveTo(i+s*(0,ik.mC)(o),r+s*(0,ik.O$)(o),n),e.arc(i,r,s,o,h,!u,n),e.lineTo(i+s*(0,ik.mC)(h),r+s*(0,ik.O$)(h),l),e.arc(i,r,s,h,o,u,l);else{let{innerouterDeltaAngle:t,innerouterStartAngle:d,innerouterEndAngle:c}=a(o,h),p=s*(0,ik.mC)(d),g=s*(0,ik.O$)(d),f=s*(0,ik.mC)(c),m=s*(0,ik.O$)(c);t<.001||(e.moveTo(i+p,r+g,n),e.arc(i,r,s,d,c,!u,n),e.lineTo(i+f,r+m,l),e.arc(i,r,s,c,d,u,l))}e.closePath()}(t,e,i,r,A.top,A.bottom,"outside"===S?_:C,(e,i)=>{let{outerDeltaAngle:r,innerDeltaAngle:n,outerStartAngle:l,outerEndAngle:s,innerEndAngle:a,innerStartAngle:o}=t.getParsePadAngle(e,i);return"outside"===S?{innerouterDeltaAngle:r,innerouterEndAngle:s,innerouterStartAngle:l}:{innerouterDeltaAngle:n,innerouterEndAngle:a,innerouterStartAngle:o}}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),g&&(s?s(e,t.attribute,h):c&&(e.setCommonStyle(t,t.attribute,i,r,h),e.fillStyle=w?w.computeColor(M[S],x):d,e.fill())),f&&(a?a(e,t.attribute,h):p&&(e.setStrokeStyle(t,t.attribute,i,r,h),e.stroke())),"inside"===S&&e.restore())}draw(t,e,i,r){let n=nP(t,null==r?void 0:r.theme).arc;this._draw(t,n,!1,i,r)}};Zg=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],Zg);let Zf=!1,Zm=new eQ(t=>{Zf||(Zf=!0,t(s2).to(Zg).inSingletonScope(),t(s4).toService(s2))}),Zy=class extends cm{constructor(t){super(),this.canvasRenderer=t,this.type="arc3d",this.numberType=si,this.themeType="arc"}};Zy=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(eb=it(s2),function(t,e){eb(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Zy);let Zv=!1,Zb=new eQ((t,e,i,r)=>{Zv||(Zv=!0,t(ct).to(Zy).inSingletonScope(),t(cf).toService(ct))});function Z_(){Z_.__loaded||(Z_.__loaded=!0,ak.RegisterGraphicCreator("arc3d",Ze),Zo(),Zd(),ib.load(Zm),ib.load(Zb))}Z_.__loaded=!1;let ZC=Z_;class Zx extends ox{stroke(t,e,i,r,n){let l=r.vertices;r.edges.forEach(r=>{let s=l[r[0]],a={x:t+s[0],y:e+s[1],z:i+s[2]},o=l[r[1]],h={x:t+o[0],y:e+o[1],z:i+o[2]};n.beginPath(),n.moveTo(a.x,a.y,a.z),n.lineTo(h.x,h.y,h.z),n.stroke()})}fill(t,e,i,r,n,l,s,a,o,h,d){let u=pU.Get(l,tc.Color255),c=r.vertices,p=c.map(t=>s.view(t[0],t[1],t[2])[2]),g=[];r.polygons.forEach((t,e)=>{if(n&&!n[e])return;g.push({faceIdx:e,polygon:t});let{polygon:i}=t,r=p[i[0]],l=p[i[1]];t.ave_z=r+l+p[i[2]]+p[i[3]]}),g.sort((t,e)=>e.polygon.ave_z-t.polygon.ave_z),g.forEach(r=>{let{polygon:n,normal:p}=r.polygon,g=c[n[0]],f=c[n[1]],m=c[n[2]],y=c[n[3]],v={x:t+g[0],y:e+g[1],z:i+g[2]},b={x:t+f[0],y:e+f[1],z:i+f[2]},_={x:t+m[0],y:e+m[1],z:i+m[2]},C={x:t+y[0],y:e+y[1],z:i+y[2]};s.beginPath(),s.moveTo(v.x,v.y,v.z),s.lineTo(b.x,b.y,b.z),s.lineTo(_.x,_.y,_.z),s.lineTo(C.x,C.y,C.z),s.closePath(),d?d(s,o&&o.attribute,h):(s.fillStyle=a?a.computeColor(p,u):l,s.fill())})}}let Zw=class extends Zx{constructor(){super(...arguments),this.type="pyramid3d",this.numberType=su}drawShape(t,e,i,r,n,l,s,a){var o;let h=nP(t,null==l?void 0:l.theme).polygon,{fill:d=h.fill,stroke:u=h.stroke,face:c=[!0,!0,!0,!0,!0,!0]}=t.attribute,p=null!=(o=this.z)?o:0;if(!this.valid(t,h,s,a))return;let{light:g}=n.stage||{},f=t.findFace();if(!1!==d){e.setCommonStyle(t,t.attribute,i,r,h);let n=d;"string"!=typeof n&&(n="black"),this.fill(i,r,p,f,c,n,e,g,t,h,s)}!1!==u&&(e.setStrokeStyle(t,t.attribute,i,r,h),this.stroke(i,r,p,f,e))}draw(t,e,i){let r=nP(t).polygon;this._draw(t,r,!1,i)}};Zw=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],Zw);let ZS=!1,ZA=new eQ(t=>{ZS||(ZS=!0,t(al).to(Zw).inSingletonScope(),t(s4).toService(al))}),ZM=class extends cm{constructor(t){super(),this.canvasRenderer=t,this.type="pyramid3d",this.numberType=su,this.themeType="polygon"}};ZM=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(e_=it(al),function(t,e){e_(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],ZM);let ZT=!1,Zk=new eQ((t,e,i,r)=>{ZT||(ZT=!0,t(cu).to(ZM).inSingletonScope(),t(cf).toService(cu))});function ZR(){ZR.__loaded||(ZR.__loaded=!0,ak.RegisterGraphicCreator("pyramid3d",Zr),Zo(),Zd(),ib.load(ZA),ib.load(Zk))}ZR.__loaded=!1;let ZP=ZR,ZB=class extends Zx{constructor(){super(...arguments),this.type="rect3d",this.numberType=sp}drawShape(t,e,i,r,n,l,s,a){var o,h;let d=nP(t,null==l?void 0:l.theme).rect,{fill:u=d.fill,stroke:c=d.stroke,x1:p,y1:g,x:f,y:m,opacity:y=d.opacity,fillOpacity:v=d.fillOpacity,lineWidth:b=d.lineWidth,strokeOpacity:_=d.strokeOpacity,visible:C=d.visible,drawStrokeWhenZeroWH:x=null!=(o=d.drawStrokeWhenZeroWH)&&o}=t.attribute,{width:w,height:S}=t.attribute;w=(null!=w?w:p-f)||0,S=(null!=S?S:g-m)||0;let A=null!=(h=this.z)?h:0,M=a6(y,v,w,S,u),T=a7(y,_,w,S,x),k=!!u,R=a5(c,b);if(!t.valid||!C||!k&&!R||!(M||T||s||a))return;let{light:P}=n.stage||{},B=t.findFace();if(!1!==u){e.setCommonStyle(t,t.attribute,i,r,d);let n=u;"string"!=typeof n&&(n="black"),this.fill(i,r,A,B,null,n,e,P,null,null,s)}!1!==c&&(e.setStrokeStyle(t,t.attribute,i,r,d),this.stroke(i,r,A,B,e))}draw(t,e,i){let r=nP(t).rect;this._draw(t,r,!1,i)}};ZB=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6()],ZB);let ZI=!1,ZE=new eQ(t=>{ZI||(ZI=!0,t(ae).to(ZB).inSingletonScope(),t(s4).toService(ae))}),ZL=class extends cm{constructor(t){super(),this.canvasRenderer=t,this.type="rect3d",this.numberType=sp,this.themeType="rect"}};ZL=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([e6(),(eC=it(ae),function(t,e){eC(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],ZL);let ZF=!1,ZO=new eQ((t,e,i,r)=>{ZF||(ZF=!0,t(ca).to(ZL).inSingletonScope(),t(cf).toService(ca))});function ZH(){ZH.__loaded||(ZH.__loaded=!0,ak.RegisterGraphicCreator("rect3d",Zs),ib.load(ZE),ib.load(ZO))}ZH.__loaded=!1;let ZD=ZH,Zz=(t,e)=>{let i=new PG.l(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){let e=[];return(0,PT.bp)(i,e,{maxDepth:null==t?void 0:t.maxDepth}),e}return i},ZW=t=>t.map(t=>Object.assign({},t,{x:t.x0,y:t.y0,width:t.x1-t.x0,height:t.y1-t.y0})),ZZ=t=>{var e;return(0,z_.Z)(null==(e=null==t?void 0:t[0])?void 0:e.vertical)?t.map(t=>{let e=t.thickness/2,i=[{x:t.x0,y:t.y0-e},{x:t.x1,y:t.y1-e},{x:t.x1,y:t.y1+e},{x:t.x0,y:t.y0+e}];return Object.assign({},t,{points:i})}):t.map(t=>{let e=t.thickness/2,i=[{x:t.x0-e,y:t.y0},{x:t.x1-e,y:t.y1},{x:t.x1+e,y:t.y1},{x:t.x0+e,y:t.y0}];return Object.assign({},t,{points:i})})},ZN=(t,e=!0)=>{var i;return(0,z_.Z)(null==(i=null==t?void 0:t[0])?void 0:i.vertical)?t.map(t=>{let i=t.thickness/2,r=t.x0,n=t.x1,l=(r+n)/2,s=t.y0-i,a=t.y0+i,o=t.y1-i,h=t.y1+i;return e&&(r=Math.round(r),n=Math.round(n),l=Math.round(l),s=Math.round(s),a=Math.round(a),o=Math.round(o),h=Math.round(h)),Object.assign({},t,{path:`
          M${r},${s}
          C${l},${s},${l},${o},${n},${o}
          L${n},${h}
          C${l},${h},${l},${a},${r},${a}
          Z`})}):t.map(t=>{let i=t.thickness/2,r=t.y0,n=t.y1,l=(r+n)/2,s=t.x0-i,a=t.x0+i,o=t.x1-i,h=t.x1+i;return e&&(r=Math.round(r),n=Math.round(n),l=Math.round(l),s=Math.round(s),a=Math.round(a),o=Math.round(o),h=Math.round(h)),Object.assign({},t,{path:`
            M${s},${r}
            C${s},${l},${o},${l},${o},${n}
            L${h},${n}
            C${h},${l},${a},${l},${a},${r}
            Z
            `})})},Zj=t=>{let e=1/0,i=-1/0,r=1/0,n=-1/0;return t.forEach(t=>{e=Math.min(t.x0,e),i=Math.max(t.x1,i),r=Math.min(t.y0,r),n=Math.max(t.y1,n)}),{x0:e,x1:i,y0:r,y1:n,width:i-e,height:n-r}},ZG=t=>t.sourceLinks&&t.sourceLinks.length?!(0,z_.Z)(t.sourceLinks[0].x0):!(!t.targetLinks||!t.targetLinks.length)&&!(0,z_.Z)(t.targetLinks[0].x0),ZV=(t,e=0)=>ZG(t[0])?t.map(t=>({y:t.y1,x:(t.x0+t.x1)/2,datum:t.datum,key:t.key})):t.map(t=>({x:t.x1,y:(t.y0+t.y1)/2,datum:t.datum,key:t.key})),ZU=(t,e=0)=>ZG(t[0])?t.map(t=>({y:t.y1-e,x:(t.x0+t.x1)/2,datum:t.datum,key:t.key})):t.map(t=>({x:t.x0-e,y:(t.y0+t.y1)/2,datum:t.datum,key:t.key})),ZK=(t,e)=>{let i=new Ir.V(t).layout(Array.isArray(e)?e[0]:e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});return i?[i]:[]},ZX=(t,e)=>{let i=new PR.p(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){let e=[];return(0,PT.bp)(i,e,{maxDepth:null==t?void 0:t.maxDepth}),e}return i},ZY=(t,e=[],i)=>{let r=(null==i?void 0:i.maxDepth)>=0;return t.forEach(t=>{(!r||t.depth<=i.maxDepth-1)&&t.children&&t.children.forEach(r=>{var n;let l={source:t,target:r,x0:t.x,y0:t.y,x1:r.x,y1:r.y,key:`${t.key}~${r.key}`};e.push((null==i?void 0:i.callback)?i.callback(l):l),(null==(n=r.children)?void 0:n.length)&&ZY([r],e,i)})}),e};var Z$=i(37651);function Zq(t){let e=t.children;return e?e[0]:t.t}function ZJ(t){let e=t.children;return e?e[e.length-1]:t.t}function ZQ(t,e){return{_:t,i:e,parent:null,A:null,a:null,z:0,m:0,c:0,s:0,t:null}}var Z0=i(65709),Z1=i(70082),Z2=i(86624);class Z3{constructor(t){this.options=Object.assign({},Z3.defaultOpionts,t);let e=null==t?void 0:t.nodeKey,i=(0,Z0.Z)(e)?e:e?(0,Z1.EP)(e):null;this._getNodeKey=i,this._maxDepth=-1}layout(t,e){let i=(0,zb.IX)(t);if(!i.length)return[];let r="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},n=[],l=(0,PT.Ch)(i,n,0,-1,null,this._getNodeKey);this._maxDepth=l.maxDepth;let s=["vertical","TB","BT"].includes(this.options.direction),a="radial"===this.options.layoutType?{x0:0,y0:0,x1:2*Math.PI,y1:Math.min(r.width,r.height)/2,width:2*Math.PI,height:Math.min(r.width,r.height)/2}:s?r:{x0:r.y0,y0:r.x0,x1:r.y1,y1:r.x1,width:r.height,height:r.width};if("leaf"===this.options.alignType?function(t,e,i,r,n=function(t,e){return t.parentKey===e.parentKey?1:2}){let l,s=0;if((0,PT.Ye)([t],t=>{let e=t.children;e?(t.x=e.reduce((t,e)=>t+e.x,0)/e.length,t.y=1+e.reduce((t,e)=>Math.max(t,e.y),0)):(t.x=l?s+=n(t,l):0,t.y=0,l=t)}),(0,D9.Z)(i)&&(0,D9.Z)(r))(0,PT.Ye)([t],n=>{n.x=e.x0+(n.x-t.x)*i,n.y=e.y0+(t.y-n.y)*r});else{let r=function(t){let e=t.children;for(;e;)e=(t=e[0]).children;return t}(t),l=function(t){let e=t.children;for(;e;)e=(t=e[e.length-1]).children;return t}(t),s=r.x-n(r,l)/2,a=l.x+n(l,r)/2,o=(0,D9.Z)(i)?i:e.width/(a-s);(0,PT.Ye)([t],i=>{i.x=e.x0+(i.x-s)*o,i.y=e.y0+(1-(t.y?i.y/t.y:1))*e.height})}}(n[0],a,this.options.minNodeGap,this.options.linkWidth):function(t,e,i,r,n=function(t,e){return t.parentKey===e.parentKey?1:2}){let l,s=(t,e,i)=>{if(e){let r,l=t,s=t,a=e,o=l.parent.children[0],h=l.m,d=s.m,u=a.m,c=o.m;for(a=ZJ(a),l=Zq(l);a&&l;)o=Zq(o),(s=ZJ(s)).a=t,(r=a.z+u-l.z-h+n(a._,l._))>0&&(function(t,e,i){let r=i/(e.i-t.i);e.c-=r,e.s+=i,t.c+=r,e.z+=i,e.m+=i}(function(t,e,i){var r;let n=null!=(r=t.a)?r:t;return n.parent===e.parent?n:i}(a,t,i),t,r),h+=r,d+=r),u+=a.m,h+=l.m,c+=o.m,d+=s.m,a=ZJ(a),l=Zq(l);a&&!ZJ(s)&&(s.t=a,s.m+=u-d),l&&!Zq(o)&&(o.t=l,o.m+=h-c,i=t)}return i},a=function(t){let e=ZQ(t,0),i=[e],r,n,l,s,a=i.pop();for(;a;){if(n=a._.children)for(s=n.length,a.children=Array(s),l=s-1;l>=0;--l)r=ZQ(n[l],l),a.children[l]=r,i.push(r),r.parent=a;a=i.pop()}return e.parent=ZQ(null,0),e.parent.children=[e],e}(t);if((0,PT.Ye)([a],t=>{let e=t.children,i=t.parent.children,r=t.i?i[t.i-1]:null;if(e){!function(t){let e=0,i=0,r=t.children,n,l=r.length;for(;--l>=0;)n=r[l],n.z+=e,n.m+=e,e+=n.s+(i+=n.c)}(t);let i=(e[0].z+e[e.length-1].z)/2;r?(t.z=r.z+n(t._,r._),t.m=t.z-i):t.z=i}else r&&(t.z=r.z+n(t._,r._));t.parent.A=s(t,r,t.parent.A||i[0])}),a.parent.m=-a.z,(0,PT.R$)([a],t=>{t._.x=t.z+t.parent.m,t.m+=t.parent.m}),(0,D9.Z)(r))l=t=>t.depth*r;else if((0,Z$.Z)(r)&&r.length){let t=r.reduce((t,e,i)=>(t[i]=0===i?e:t[i-1]+e,t),[]);l=e=>{var i;return null!=(i=t[e.depth])?i:t[t.length-1]}}if((0,D9.Z)(i)&&l)(0,PT.R$)([t],t=>{t.x=e.x0+e.width/2+t.x*i,t.y=e.y0+l(t)});else{let r=t,s=t,a=t;(0,PT.R$)([t],t=>{t.x<r.x&&(r=t),t.x>s.x&&(s=t),t.depth>a.depth&&(a=t)});let o=r===s?1:n(r,s)/2,h=o-r.x,d=(0,D9.Z)(i)?i:e.width/(s.x+o+h),u=e.height/(a.depth||1);(0,PT.R$)([t],t=>{t.x=e.x0+(t.x+h)*d,t.y=e.y0+(l?l(t):t.depth*u)})}}(n[0],a,this.options.minNodeGap,this.options.linkWidth),"radial"===this.options.layoutType){let t={x:(r.x0+r.x1)/2,y:(r.y0+r.y1)/2};(0,PT.R$)(n,e=>{let i=e.x,r=e.y,n=(0,Z2.op)(t,r,i);e.x=n.x,e.y=n.y,e.maxDepth=this._maxDepth})}else["BT","RL"].includes(this.options.direction)?(0,PT.R$)(n,t=>{t.y=a.y0+a.y1-t.y,t.maxDepth=this._maxDepth}):(0,PT.R$)(n,t=>{t.maxDepth=this._maxDepth}),s||(0,PT.R$)(n,t=>{[t.x,t.y]=[t.y,t.x]});return n}}Z3.defaultOpionts={direction:"horizontal",alignType:"depth",layoutType:"orthogonal"};let Z5=(t,e)=>{let i=new Z3(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){let{maxDepth:e}=null!=t?t:{},r=[];(0,PT.bp)(i,r,{maxDepth:e});let n=[];return ZY(i,n,{maxDepth:e}),{nodes:r,links:n}}return i},Z4=(t,e)=>{let i=new P9.j(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){let e=[];return(0,PT.bp)(i,e,{maxDepth:null==t?void 0:t.maxDepth}),e}return i};var Z6=i(84592),Z7=i(83393),Z8=i(53724),Z9=i(56674);function Nt(t,e){t.aspectRatio>1?(t.width=e,t.height=~~(e/t.aspectRatio)):(t.height=e,t.width=~~(e*t.aspectRatio))}(ex=eX||(eX={})).BEFORE_IMAGECLOUD_LAYOUT="beforeImagecloudLayout",ex.AFTER_IMAGECLOUD_LAYOUT="afterImagecloudLayout",ex.AFTER_IMAGECLOUD_DRAW="afterImagecloudDraw";var Ne=i(83510);let Ni=(t,e)=>{let i,r,n=(0,Z0.Z)(e)?e:t=>t;if(t&&t.length){let e=t.length;for(let l=0;l<e;l+=1){let e=n(t[l]);(0,z_.Z)(e)||!(0,D9.Z)(e*=1)||Number.isNaN(e)||((0,z_.Z)(i)?(i=e,r=e):(i=Math.min(i,e),r=Math.max(r,e)))}}return[i,r]};var Nr=i(40499),Nn=i(58403),Nl=i(47811);class Ns{constructor(t){this.progressiveResult=[],this.imageCollageList=[],this.options=t}preProcess(){let{imageConfig:t={},weight:e}=this.options,{padding:i=0}=t,r=this.imageCollageList;return r.forEach((t,r)=>{!1===t.valid?(t.x=-10,t.y=-10,t.width=0,t.height=0,t.opacity=0):(t.padding=i,t.weight=(0,Z1.RF)(e)(this.data[r]),t.datum=this.data[r])}),r=r.filter(t=>!1!==t.valid).sort((t,e)=>e.weight-t.weight)}onImageCollageInputReady(t){t.forEach((t,e)=>{if("fulfilled"===t.status){let{width:i,height:r}=t.value;this.imageCollageList.push(Object.assign({},this.data[e],{aspectRatio:i/r}))}else this.imageCollageList.push(Object.assign({},this.data[e],{valid:!1}))})}layout(t){this.data=t,this.loadSegmentationInput(),this.loadImageCollageInput()}loadSegmentationInput(){var t,e,i,r,n,l;let s=this.options,a=s.size,o={shapeUrl:null!=(t=s.mask)?t:{type:"geometric",shape:"rect"},size:a,ratio:s.ratio||.8,tempCanvas:void 0,boardSize:[0,0],random:!1,randomGenerator:void 0,blur:null==(e=s.maskConfig)?void 0:e.edgeBlur},h=this.options.createCanvas({width:a[0],height:a[1]}),d=h.getContext("2d",{willReadFrequently:!0});if(d.textAlign="center",d.textBaseline="middle",o.tempCanvas=h,o.boardSize=[a[0]+31>>5<<5,a[1]],o.random?o.randomGenerator=Math.random:o.randomGenerator=(0,zF.s6)(),this.segmentationInput=o,(0,Ne.Z)(o.shapeUrl)){o.isEmptyPixel=(0,Nn.at)(void 0,{threshold:null!=(r=null==(i=s.maskConfig)?void 0:i.threshold)?r:200,invert:null==(n=s.maskConfig)?void 0:n.invert},this.options.createCanvas);let t=(0,Nl.p)(o.shapeUrl,this.options.createImage);t?(this.isMaskImageFinished=!1,this.isLayoutFinished=!1,t.then(t=>{var e,i;let r;this.isMaskImageFinished=!0;let n=s.size,l=this.options.createCanvas({width:n[0],height:n[1],dpr:1});o.maskCanvas=l;let a=l.getContext("2d");(null==(e=s.maskConfig)?void 0:e.removeWhiteBorder)&&(0,Nn.tc)(t,l,o.isEmptyPixel);let h=(0,Nn.Qn)(t,n);a.clearRect(0,0,n[0],n[1]),a.drawImage(t,h.x,h.y,h.width,h.height),this.segmentationOutput=(0,Nn.Sl)(this.segmentationInput),"masked"===(null==(i=this.options.layoutConfig)?void 0:i.placement)&&(r=this.generateTransparentMaskCanvas(t,n)),this.segmentationOutput.transparentMaskCanvas=r,this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(l,r)}).catch(t=>{this.isMaskImageFinished=!0})):(this.isMaskImageFinished=!0,this.isLayoutFinished=!0)}else if(o.shapeUrl&&("text"===o.shapeUrl.type||"geometric"===o.shapeUrl.type)){o.isEmptyPixel=(0,Nn.at)(o.shapeUrl.backgroundColor,void 0,this.options.createCanvas),"text"!==o.shapeUrl.type&&"geometric"!==o.shapeUrl.type||o.shapeUrl.backgroundColor||(o.shapeUrl.backgroundColor="rgba(255,255,255,255)");let t=(0,Nn.rp)(o.shapeUrl,a[0],a[1],void 0,null==(l=s.maskConfig)?void 0:l.invert,this.options.createCanvas);o.maskCanvas=t,this.segmentationOutput=(0,Nn.Sl)(this.segmentationInput),this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(t,t),this.isMaskImageFinished=!0}}loadImageCollageInput(){let t=this.data,e=(0,Nl.l)(t.map(t=>(0,Z1.RF)(this.options.image)(t)),this.options.createImage);e?e.then(t=>{this.onImageCollageInputReady(t),this.isImagesFinished=!0}).catch(t=>{this.isImagesFinished=!0,this.isLayoutFinished=!0,zz.Y.getInstance().error("image load failed",t)}):(this.isImagesFinished=!0,this.isLayoutFinished=!0)}canAnimate(){return!0}unfinished(){return!this.isLayoutFinished}output(){return this.progressiveResult}progressiveRun(){if(this.isImagesFinished&&this.isMaskImageFinished&&!this.isLayoutFinished){let t=this.preProcess(),e=this.doLayout(t);this.options&&this.options.onLayoutEnd&&this.options.onLayoutEnd(e),this.progressiveResult=this.processOutput(e),this.isLayoutFinished=!0}}progressiveOutput(){return this.progressiveResult}release(){this.segmentationInput=null,this.data=null,this.progressiveResult=null,this.options=null}calculateImageSize(t,e={},i=.45){let{imageSizeRange:r,padding:n=0}=e,l=(0,D9.Z)(e.imageSize)?e.imageSize:(0,Z1.EP)(e.imageSize),s=this.options.size;if(l||r)if(l&&!(0,Z0.Z)(l))t.forEach(t=>Nt(t,l));else if(r){let e=(new Nr.a).domain(Ni(t,t=>t.weight)).range(r);t.forEach(t=>Nt(t,~~e.scale(t.weight)))}else if(l&&(0,Z0.Z)(l)&&!r){let[e,r]=Ni(t,t=>t.weight),l=t.reduce((t,i)=>{let n=i.aspectRatio;return t+(n>1?1/n:n)*(.5+.5*((i.weight-e)/(r-e)))**2},0),a=~~Math.sqrt(i*s[0]*s[1]/l),o=[~~(.5*a)-2*n<0?1:~~(.5*a)-2*n,~~a-2*n<0?1:~~a-2*n],h=(new Nr.a).domain(Ni(t,t=>t.weight)).range(o);t.forEach(t=>Nt(t,~~h.scale(t.weight)))}else console.warn("image cloud imageSize error");else{let e=t.reduce((t,e)=>{let i=e.aspectRatio;return t+(i>1?1/i:i)},0),r=~~Math.sqrt(i*s[0]*s[1]/e);r=r-2*n<0?1:r-2*n,t.forEach(t=>Nt(t,r))}return t}generateTransparentMaskCanvas(t,e){var i;let r=this.options.createCanvas({width:e[0],height:e[1],dpr:1}),n=r.getContext("2d");this.segmentationOutput.transparentMaskCanvas=r,(null==(i=this.options.maskConfig)?void 0:i.removeWhiteBorder)&&(0,Nn.tc)(t,r,this.segmentationInput.isEmptyPixel);let l=n.createImageData(e[0],e[1]),s=this.segmentationOutput.segmentation.labels;for(let t=0;t<s.length;t++){let e=255*(0===s[t]),i=255*s[t],r=4*t;l.data[r]=e,l.data[r+1]=e,l.data[r+2]=e,l.data[r+3]=i}return n.clearRect(0,0,e[0],e[1]),n.fillStyle="rgba(255,255,255,0)",n.fillRect(0,0,e[0],e[1]),n.putImageData(l,0,0),r}processOutput(t){var e;let i=null==(e=this.options)?void 0:e.as;return i&&Object.keys(i).forEach(e=>{t.forEach(t=>{t[i[e]]=t[e],delete t[e]})}),t}}var Na=i(1058);class No extends Ns{preProcess(){let t=super.preProcess(),{imageConfig:e={},ratio:i=.45}=this.options;return this.calculateImageSize(t,e,i)}tryPlaceImage(t,e,i,r,n,l=1){let[s,a]=e,o=s/2,h=a/2,d=Math.sqrt(o**2+h**2),u=Na.$[i](e),c,p,g=-l,{segmentation:f}=r,{labels:m}=f;for(;([c,p]=u(g+=l))&&!(Math.min(Math.abs(c),Math.abs(p))>=d);)if(c-=t.width/2,p-=t.height/2,t.visible=!0,t.x=~~(o+c),t.y=~~(h+p),t._left=t.x+t.padding,t._top=t.y+t.padding,t._leftWithoutPadding=t.x,t._topWithoutPadding=t.y,function(t,e){for(let n=0;n<e.length;n++){var i,r;if(i=t,r=e[n],!(i._leftWithoutPadding+i._widthWithPadding<r._leftWithoutPadding||i._topWithoutPadding+i._heightWithPadding<r._topWithoutPadding||i._leftWithoutPadding>r._leftWithoutPadding+r._widthWithPadding||i._topWithoutPadding>r._topWithoutPadding+r._heightWithPadding))return!1}return!0}(t,n)){let{x:e,y:i,width:r,height:n}=t,l=!1;for(let t=0;t<r;t++){for(let r=0;r<n&&i+t<=a;r++)if(!(e+r>s)&&!m[(i+t)*s+(e+r)]){l=!0;break}if(l)break}if(!l){let e=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x,y:t.y+t.height},{x:t.x+t.width,y:t.y+t.height}],i=!0;for(let t of e)if(!m[t.y*s+t.x]){i=!1;break}if(!i)continue;return!0}}return!1}doLayout(t){var e;let{segmentationOutput:i}=this,{layoutConfig:r={}}=this.options,n=this.options.size,{spiralType:l="archimedean",fillingTimes:s=4,minFillingImageSize:a=10}=r,o=[],h=Object.keys(t[0]).find(t=>t.includes("VGRAMMAR"));for(let e of t)e._widthWithPadding=e.width+2*e.padding,e._heightWithPadding=e.height+2*e.padding,e.frequency=1,this.tryPlaceImage(e,n,l,i,o)&&o.push(e);let d=(0,zb.iH)(o,(t,e)=>t.width-e.width).width,u=(0,zb.iH)(o,(t,e)=>t.height-e.height).height,c=[];for(let r=0;r<s;r++){let s=.5*d-r,p=.5*u-r;for(let r of t){let t=Object.assign({},r,{visible:!0}),d=Math.max(a,t.aspectRatio>1?s:p);Nt(t,d),t._widthWithPadding=t.width+2*t.padding,t._heightWithPadding=t.height+2*t.padding,this.tryPlaceImage(t,n,l,i,[...c,...o],.5)&&(r._tempFrequency=(null!=(e=r._tempFrequency)?e:r.frequency)+1,t.frequency=r._tempFrequency,t.distance=Math.sqrt(Math.pow(t.x-n[0]/2,2)+Math.pow(t.y-n[1]/2,2)),t[h]=`${t[h]}_${t.frequency}`,c.push(t))}}return[...o,...c].filter(t=>t.visible)}}function Nh(t){let e,i,r,{imageConfig:n={},size:l,ratio:s=.1,layoutConfig:a={}}=t,{padding:o=0,imageSize:h}=n,[d,u]=l;(e=h||Math.min(d,u)*s-2*o)<0&&(e=1);let{rectAspectRatio:c=1}=a;c>1?(i=e,r=e/c):(r=e,i=e*c);let p=Math.ceil(u/(r+o)),g=Math.ceil(d/(i+o)),f=d/2,m=u/2,y=Array(g*p);for(let t=0;t<p;t++)for(let e=0;e<g;e++){let n=e*(i+o)+i/2,l=t*(r+o)+r/2;y[t*g+e]={centerX:n,centerY:l,x:n-i/2,y:l-r/2,row:t,col:e,distance:Math.sqrt(Math.pow(n-f,2)+Math.pow(l-m,2))}}return{context:Object.assign({},a,{cellWidth:i,cellHeight:r,cellInfo:y,cellCount:y.length,cellType:"rect",cellPixelCount:i*r,eachPixel:(t,e)=>{let{x:n,y:l}=t;for(let t=0;t<i;t++)for(let i=0;i<r&&l+t<=u;i++)n+i>d||e((~~l+t)*d+(~~n+i))},clipPath:`M${-i/2} ${-r/2} L${i/2} ${-r/2} L${i/2} ${r/2} L${-i/2} ${r/2} Z`}),imageLength:e}}var Nd=i(82206);let Nu={rect:Nh,circle:function(t){let{imageConfig:e={},size:i,ratio:r=.1,layoutConfig:n={}}=t,{padding:l=0,imageSize:s=0}=e,[a,o]=i,h=a/2,d=o/2,u=0;(u=s?s/2:Math.min(a,o)*r/2)-l<=0&&(u=l+1);let c=2*u,p=Math.sqrt(3)/2*c+l,g=[],f=0;for(let t=0;t*p-u<o;t++){let e=t*p,i=t%2==0?0:u;for(let r=-1;r*(c+l)+i-u<a;r++){let n=r*(c+l)+i+u;g[f++]={centerX:n,centerY:e,x:n-u,y:e-u,row:t,col:r,distance:Math.sqrt(Math.pow(n-h,2)+Math.pow(e-d,2))}}}let m=0,y=u*u;for(let t=0;t<c;t++)for(let e=0;e<c;e++){let i=t-u,r=e-u;i*i+r*r<=y&&m++}return{context:Object.assign({},n,{cellWidth:c,cellHeight:c,cellInfo:g,cellCount:g.length,cellType:"circle",cellPixelCount:m,eachPixel:(t,e)=>{let{x:i,y:r}=t;for(let t=0;t<c;t++)for(let n=0;n<c;n++){if(t+i<0||t+i>a||n+r>o||n+r<0)continue;let l=t-u,s=n-u;l*l+s*s<=y&&e((~~r+t)*a+(~~i+n))}},clipPath:"M 1 0 A 1 1 0 1 0 -1 0 A 1 1 0 1 0 1 0 Z"}),imageLength:c}},hexagonal:function(t){let e,{imageConfig:i={},size:r,ratio:n=.1,layoutConfig:l={}}=t,{padding:s=0,imageSize:a}=i,[o,h]=r,d=o/2,u=h/2;(e=a?a/2:Math.min(o,h)*n/2)-s<=0&&(e=s+1);let c=[],p=2*Math.PI/6;for(let t=0;t<6;t++){let i=p*t;c.push({x:(e-s/2)*Math.cos(i),y:(e-s/2)*Math.sin(i)})}let g=2*e,f=Math.sin(Math.PI/6)*g,m=Math.sqrt(3)*f,y=g-f/2,v=Math.cos(Math.PI/6)*g,b=v/2,_=Math.floor(h/m),C=Math.floor(o/f),x=[];for(let t=-1;t<=_+1;t++)for(let e=-1;e<=C;e++){let i=e*y,r=t*v+(e%2?b:0);x.push({centerX:i,centerY:r,x:i-f,y:r-f,row:t,col:e,distance:Math.sqrt(Math.pow(i-d,2)+Math.pow(r-u,2))})}let w=0,S=[];for(let t=0;t<=m;t++)for(let e=0;e<=2*f;e++){let i=Math.abs(e-f),r=Math.abs(t-m/2);i<=f&&r<=m/2&&2*r+i*Math.sqrt(3)<=m?(w++,S.push(!0)):S.push(!1)}return{context:Object.assign({},l,{cellHexSideLength:f,cellHexPoints:c,cellHeight:m,cellWidth:2*f,cellInfo:x,cellCount:x.length,cellType:"hexagonal",cellPixelCount:w,eachPixel:(t,e)=>{let{x:i,y:r}=t,n=0;for(let t=0;t<=m;t++)for(let l=0;l<=2*f;l++)S[n++]&&e((~~r+t)*o+(~~i+l))},clipPath:"M 1 0 L 0.5 0.866 L -0.5 0.866 L -1 0 L -0.5 -0.866 L 0.5 -0.866 Z"}),imageLength:g-s}}};class Nc extends Ns{preProcess(){var t;let e=super.preProcess(),{layoutConfig:i={}}=this.options,{cellType:r="rect"}=i,{context:n,imageLength:l}=(null!=(t=Nu[r])?t:Nu.rect)(this.options);return e.forEach(t=>{t.aspectRatio>1?(t.height=l,t.width=~~(l*t.aspectRatio)):(t.width=l,t.height=~~(l/t.aspectRatio))}),n.cellInfo.sort((t,e)=>t.distance-e.distance),this.layoutContext=n,e}doLayout(t){let{cellWidth:e,cellHeight:i,cellInfo:r,cellCount:n,clipPath:l,eachPixel:s,cellPixelCount:a}=this.layoutContext;if(0===t.length||0===n||0===e||0===i||0===r.length)return void(this.isLayoutFinished=!0);let{segmentationOutput:o}=this,{layoutConfig:h={}}=this.options,{placement:d="default"}=h;if("edge"===d||"default"===d){let{segmentation:t}=o,{labels:e}=t;r.forEach(t=>{let i=0;s(t,t=>{e[t]&&i++}),t.intersectPixels=i})}let u=t.length,c=t=>{let{intersectPixels:e}=t;return"default"===d?e>=.45*a:"edge"!==d||e>.1*a&&e<a};for(let e=0;e<u;e++){let i=t[e],n=r[e];n&&(i.x=n.centerX-i.width/2,i.y=n.centerY-i.height/2,i.clipConfig={shape:l},i.frequency=1,i.visible=c(n),i.cell=(0,Nd.Z)(n,["image"]),i.distance=n.distance,n.image=i)}let p=Object.keys(t[0]).find(t=>t.includes("VGRAMMAR"));if(u<n)for(let e=u;e<n;e++){let i=t[e-u],n=r[e];if(n){let e=Object.assign({},i);e.x=n.centerX-e.width/2,e.y=n.centerY-e.height/2,e.frequency+=1,e[p]=`${e[p]}_${e.frequency}`,e.visible=c(n),e.distance=n.distance,e.cell=(0,Nd.Z)(n,["image"]),n.image=e,t.push(e)}}return t.filter(t=>t.visible)}}class Np extends Ns{preProcess(){let t=super.preProcess(),{imageConfig:e={},ratio:i=.1}=this.options;return this.layoutContext=Nh(Object.assign({},this.options,{imageConfig:{imageSize:null}})).context,this.layoutContext.cellInfo.sort((t,e)=>t.distance-e.distance),this.calculateImageSize(t,e,i)}doLayout(t){let{segmentationOutput:e}=this,{cellWidth:i,cellHeight:r,cellInfo:n,cellCount:l,eachPixel:s,cellPixelCount:a}=this.layoutContext;if(0===t.length||0===l||0===i||0===r||0===n.length)return void(this.isLayoutFinished=!0);let{layoutConfig:o={}}=this.options,h=this.options.size,{placement:d="default",maxAngle:u=Math.PI/180*45}=o;if("edge"===d||"default"===d){let{segmentation:t}=e,{labels:i}=t;n.forEach(t=>{let e=0;s(t,t=>{i[t]&&e++}),t.intersectPixels=e})}let c=t.length,p=Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2)),g=t=>{let{intersectPixels:e}=t;return"default"===d?e>.5*a:"edge"!==d||e>.1*a&&e<a};for(let e=0;e<c;e++){let i=t[e],r=n[e];r&&(i.x=r.centerX-i.width/2,i.y=r.centerY-i.height/2,i.visible=g(r),i.cell=`${r.row}_${r.col}`,i.angle=2*u*Math.random()-u,i.anchor=[i.x+i.width/2,i.y+i.height/2],i.zIndex=p-r.distance,i.distance=r.distance,i.frequency=1,r.image=i)}let f=Object.keys(t[0]).find(t=>t.includes("VGRAMMAR"));if(c<l)for(let e=c;e<l;e++){let i=t[e-c],r=n[e];if(r){let e=Object.assign({},i);e.x=r.centerX-e.width/2,e.y=r.centerY-e.height/2,e.anchor=[e.x+e.width/2,e.y+e.height/2],e.angle=2*u*Math.random()-u,e.frequency+=1,e[f]=`${e[f]}_${e.frequency}`,e.visible=g(r),e.cell=`${r.row}_${r.col}`,e.distance=r.distance,e.zIndex=p-r.distance,r.image=e,t.push(e)}}return t.filter(t=>t.visible)}}let Ng=(t,e,i)=>{var r,n;let l,s=(0,Z0.Z)(t.size)?t.size():t.size;if(t.size=s,!s||(0,z_.Z)(s[0])||(0,z_.Z)(s[1])||s[0]<=0||s[1]<=0)return zz.Y.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(t.size=[Math.ceil(s[0]),Math.ceil(s[1])],t.image||zz.Y.getInstance().error("Imagecloud: image source must be specified."),t.onBeforeLayout&&t.onBeforeLayout(),!e||0===e.length)return[];switch(null!=(n=null==(r=t.layoutConfig)?void 0:r.layoutMode)?n:"spiral"){case"grid":l=Nc;break;case"stack":l=Np;break;default:l=No}let a=new l(t);return a.layout(e),a.unfinished()?{progressive:a}:a.output()};var Nf=i(42504);let Nm={svg:"group",rect:"rect",line:"rule",polygon:"polygon",path:"path",polyline:"line",g:"group",circle:"arc",ellipse:"arc"},Ny=Object.keys(Nm),Nv=["g","svg","text","tspan","switch"],Nb=["font-size","font-family","font-weight","font-style","text-align","text-anchor"],N_=["visibility","x","y","width","height","d","points","stroke","stroke-width","fill","fill-opacity","stroke-opacity",...Nb,"cx","cy","r","cx","cy","rx","ry","x1","x2","y1","y2"],NC=["visible","fill","stroke","stroke-width","fill-opacity","stroke-opacity",...Nb],Nx=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g,Nw=(t,e={},i)=>{let r=e.customDOMParser;if(r||(null==window?void 0:window.DOMParser)&&(r=t=>(new DOMParser).parseFromString(t,"text/xml")),!r)throw Error("No Available DOMParser!");let n=r(t),l=9===n.nodeType?n.firstChild:n;for(;l&&("svg"!==l.nodeName.toLowerCase()||1!==l.nodeType);)l=l.nextSibling;return l?function(t,e={}){let i,r=[],n=NT(t,null),l=parseFloat(t.getAttribute("width")||e.width),s=parseFloat(t.getAttribute("height")||e.height);(0,hy.Z)(l)||(l=null),(0,hy.Z)(s)||(s=null);let a=t.getAttribute("viewBox");if(a){let t=a.match(Nx)||[];if(t.length>=4&&(i={x:parseFloat(t[0]||0),y:parseFloat(t[1]||0),width:parseFloat(t[2]),height:parseFloat(t[3])},l||s)){let t={x:0,y:0,width:l,height:s},e=Math.min(t.width/i.width,t.height/i.height),r=-(i.x+i.width/2)*e+(t.x+t.width/2),a=-(i.y+i.height/2)*e+(t.y+t.height/2);n.transform=(new iT.y).translate(r,a).scale(e,e)}}return function t(e,i,r=[]){var n;let l;if(!e)return;"svg"!==e.nodeName&&(l=NT(e,i)),l&&r.push(l);let s=Nv.includes(null==(n=e.tagName)?void 0:n.toLocaleLowerCase())?e.firstChild:null;for(;s;)t(s,null!=l?l:i,r),s=s.nextSibling}(t,n,r),{root:n,width:l,height:s,elements:r,viewBoxRect:i}}(l):null},NS=0;function NA(t){let e,{parent:i,attributes:r}=t,n=t=>t?NC.reduce((e,i)=>{let r=(0,ax.zW)(i);return(0,aw.Z)(t[r])&&(e[r]=t[r]),e},{}):{};return i?(i._inheritStyle||(i._inheritStyle=n(i.attributes)),e=(0,h3.Z)({},i._inheritStyle,n(r))):e=n(r),e}function NM(t){var e,i,r;let n={},l=null!=(e=t.attributes)?e:{},s=null!=(i=t.style)?i:{};for(let t=0;t<N_.length;t++){let e=N_[t],i=(0,aw.Z)(s[e])&&""!==s[e]?s[e]:null==(r=l[e])?void 0:r.value;(0,aw.Z)(i)&&(n[(0,ax.zW)(e)]=isNaN(+i)?i:parseFloat(i))}return"none"===s.display&&(n.visible=!1),["fontSize","strokeWidth","width","height"].forEach(t=>{let e=n[t];(0,nI.Z)(n[t])&&(n[t]=parseFloat(e))}),n}function NT(t,e){var i,r,n,l,s;let a=null==(i=t.tagName)?void 0:i.toLowerCase();if(3===t.nodeType||"text"===a||"tspan"===a)return function(t,e){var i,r,n,l,s,a;let o;if(!e)return null;let h=null==(i=t.tagName)?void 0:i.toLowerCase();if(!h&&"group"!==e.graphicType)return null;let d="text"===h||"tspan"===h,u=d||null==(r=t.textContent)?void 0:r.replace(/\n/g," ").replace(/\s+/g," ");return" "===u?null:((o=d?{tagName:h,graphicType:d?"group":"text",attributes:NM(t),parent:e,name:t.getAttribute("name"),id:null!=(n=t.getAttribute("id"))?n:`${h}-${NS++}`,transform:Nk(t),value:u}:{tagName:h,graphicType:"text",attributes:NM(t),parent:e,name:null==e?void 0:e.name,id:null!=(s=null==(l=t.getAttribute)?void 0:l.call(t,"id"))?s:`${h}-${NS++}`,value:u})._inheritStyle=NA(o),(0,aw.Z)(o.name)||(o._nameFromParent=null!=(a=e.name)?a:e._nameFromParent),d?e._textGroupStyle?o._textGroupStyle=(0,h3.Z)({},e._textGroupStyle,NM(t)):o._textGroupStyle=NM(t):o.attributes=o._inheritStyle,o)}(t,e);if(!Ny.includes(a))return null;let o={tagName:a,graphicType:Nm[a],attributes:NM(t),parent:e,name:null!=(r=t.getAttribute("name"))?r:null==(n=null==e?void 0:e.attributes)?void 0:n.name,id:null!=(l=t.getAttribute("id"))?l:`${a}-${NS++}`,transform:Nk(t)};return o._inheritStyle=NA(o),e&&!(0,aw.Z)(o.name)&&(o._nameFromParent=null!=(s=e.name)?s:e._nameFromParent),o}function Nk(t){var e,i;let r=null==(e=t.transform)?void 0:e.baseVal;if(!r)return null;let n=null==(i=r.consolidate())?void 0:i.matrix;if(!n)return null;let{a:l,b:s,c:a,d:o,e:h,f:d}=n;return new iT.y(l,s,a,o,h,d)}let NR=t=>null===t;var NP=i(60659),NB=i(42998),NI=i(55592),NE=i(1475);let NL=t=>(0,NB.Z)(t,"RegExp");function NF(t,e=!1,i=0,r){let n=[],l=[];return void 0===e&&(e=!0),void 0===i&&(i=1/0),function t(i,s){let a,o;if(null===i)return null;if(0===s||"object"!=typeof i)return i;if((0,rD.Z)(i)?a=[]:NL(i)?(a=new RegExp(i.source,(o="",i.global&&(o+="g"),i.ignoreCase&&(o+="i"),i.multiline&&(o+="m"),o)),i.lastIndex&&(a.lastIndex=i.lastIndex)):a=(0,NE.Z)(i)?new Date(i.getTime()):void 0===r?Object.create(Object.getPrototypeOf(i)):Object.create(r),e){let t=n.indexOf(i);if(-1!==t)return l[t];n.push(i),l.push(a)}for(let e in i)a[e]=t(i[e],s-1);return a}(t,i)}let NO=Object.prototype.hasOwnProperty;function NH(t,e){if(!t||!(0,hc.Z)(t))return t;let i={};return e.forEach(e=>{NO.call(t,e)&&(i[e]=t[e])}),i}function ND(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function Nz(t){return(0,rD.Z)(t)?t.length:(0,nF.Z)(t)?Object.keys(t).length:0}function NW(t,e){if(ND(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e||(0,rD.Z)(t)!==(0,rD.Z)(e)||Nz(t)!==Nz(e))return!1;let i=!0;return Object.keys(t).forEach(r=>!!ND(t[r],e[r])||(i=!1)),i}var NZ=i(14616),NN=i(60837),Nj=i(39708);function NG(t,e){let i,r=0,n=0,l=0;if(void 0===e)for(let e of t)null!=e&&(e*=1)>=e&&(i=e-n,n+=i/++r,l+=i*(e-n));else{let s=-1;for(let a of t)null!=(a=e(a,++s,t))&&(a*=1)>=a&&(i=a-n,n+=i/++r,l+=i*(a-n))}return r>1?l/(r-1):0}function NV(t,e){let i=NG(t,e);return i?Math.sqrt(i):i}let NU=Math.sqrt(50),NK=Math.sqrt(10),NX=Math.sqrt(2);function NY(t,e,i){let r=Math.abs(e-t)/Math.max(0,i),n=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),l=r/n;return l>=NU?n*=10:l>=NK?n*=5:l>=NX&&(n*=2),e<t?-n:n}let N$=t=>(0,nz.Z)(t)?t:()=>t;var Nq=i(68432);let NJ=(t,e=0)=>{let i="",r=e-1;for(;r>=0;)i=`${i}${t}`,r-=1;return i},NQ=(t,e,i=" ",r="right")=>{let n=t+"",l=e-n.length;return l<=0?n:"left"===r?NJ(i,l)+n:"center"===r?NJ(i,Math.floor(l/2))+n+NJ(i,Math.ceil(l/2)):n+NJ(i,l)},N0=(t,e,i="right",r)=>{let n=(0,nB.Z)(r)?"…":r,l=t+"",s=l.length,a=Math.max(0,e-n.length);return s<=e?l:"left"===i?n+l.slice(s-a):"center"===i?l.slice(0,Math.ceil(a/2))+n+l.slice(s-Math.floor(a/2)):l.slice(0,a)+n},N1=(t,e)=>{let i,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=[];if(e=e||r.length,t)for(i=0;i<t;i++)n[i]=r[0|Math.random()*e];else{let t;for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",i=0;i<36;i++)n[i]||(t=0|16*Math.random(),n[i]=r[19===i?3&t|8:t])}return n.join("")};var N2=i(73619);let N3=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function N5(t){if(t instanceof Date)return t;if((0,nI.Z)(t)){let e=N3.exec(t);if(!e)return new Date(NaN);if(!e[8])return new Date(+e[1],(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0);let i=+e[4]||0;return"Z"!==e[8].toUpperCase()&&(i-=e[8].slice(0,3)),new Date(Date.UTC(+e[1],(e[2]||1)-1,+e[3]||1,i,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}return new Date((0,nB.Z)(t)?NaN:Math.round(t))}var N4=i(80097);function N6(t){if((0,hy.Z)(t))return t;let e=+t;return(0,hy.Z)(e)?e:0}let N7=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},N8=function(t){return t.charAt(0).toUpperCase()+t.substring(1)};function N9(t,e){return t&&e?t.replace(/\\?\{([^{}]+)\}/g,(t,i)=>"\\"===t.charAt(0)?t.slice(1):void 0===e[i]?"":e[i]):t}function jt(t){return parseFloat("0."+Math.sin(t).toString().substring(6))}function je(t=1){let e=t;return()=>(e=(1664525*e+0x3c6ef35f)%0x100000000)/0x100000000}let ji=()=>{let t=-1,e=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9];return()=>(t=(t+1)%e.length,e[t])},jr=t=>0;var jn=i(44107),jl=i(72141),js=i(41995),ja=i(14465),jo=i(10791);class jh{}class jd{constructor(){this.items={},this.itemList=[]}get type(){return"xhHashTable"}set(t,e){let i=new jh;i.key=t,i.value=e;let r=this.itemList.length;return this.has(t)&&(r=this.items[t].index),i.index=r,this.itemList[r]=i,this.items[t]=i,i}clear(){this.items={},this.itemList=[]}del(t){if(this.has(t)){let e=this.items[t].index;e>-1&&this.itemList.splice(e,1),delete this.items[t],this.resetIndex()}}delFrom(t){for(let e=t+1;e<this.count();e++){let t=this.itemList[e].key;delete this.items[t]}this.itemList.splice(t+1,this.count()-t),this.resetIndex()}resetIndex(){this.foreachHashv((t,e)=>{let i=this.itemList.indexOf(e);this.items[t].index=i})}has(t){return t in this.items}get(t){return this.has(t)?this.items[t].value:null}count(){return this.itemList.length}all(){return this.itemList.map(t=>t.value)}first(){return this.itemList[0].value}last(){return this.itemList[this.itemList.length-1].value}getByIndex(t){return this.itemList[t].value}getKeyByIndex(t){return this.itemList[t].key}foreach(t){for(let e in this.items)if(!1===t(e,this.items[e].value))return!1;return!0}foreachHashv(t){for(let e in this.items)if(!1===t(e,this.items[e]))return!1;return!0}hasValue(t){for(let e in this.items)if(this.items[e].value===t)return!0;return!1}indexOf(t){return this.has(t)?this.items[t].index:-1}insertAt(t,e,i){let r=new jh;r.index=t,r.key=i,r.value=e,this.itemList.splice(t,0,r),this.items[i]=r,this.resetIndex()}sort(t){return this.itemList.sort((e,i)=>t(e.value,i.value))}toArray(){return this.itemList.slice(0,this.itemList.length).map(t=>t.value)}push(t){t.foreach((t,e)=>{this.set(t,e)})}mapKey(){let t=[];for(let e in this.items)t.push(e);return t}toImmutableMap(){}}var ju=i(39126);let jc=(t,e,i)=>{let r=new Uint8ClampedArray(t),n=new Uint8ClampedArray(t.length);for(let t=i-1;t>=0;t--)for(let l=0;l<e;l++){let s=t*e*4+4*l,a=(i-t)*e*4+4*l;n[a]=r[s],n[a+1]=r[s+1],n[a+2]=r[s+2],n[a+3]=r[s+3]}return new ImageData(n,e,i)};function jp(t){return c=1/0,p=1/0,g=-1/0,f=-1/0,t.forEach(t=>{c>t.x&&(c=t.x),g<t.x&&(g=t.x),p>t.y&&(p=t.y),f<t.y&&(f=t.y)}),{x1:c,y1:p,x2:g,y2:f}}function jg(t,e){return(0,aj.qr)(t,e,!1)}function jf(t,e,i=3,r=!1){let n=t.x1,l=t.x2,s=t.y1,a=t.y2,o=e.x1,h=e.x2,d=e.y1,u=e.y2;if(r){let t;n>l&&(t=n,n=l,l=t),s>a&&(t=s,s=a,a=t),o>h&&(t=o,o=h,h=t),d>u&&(t=d,d=u,u=t)}if(n>=h||l<=o||s>=u||a<=d)return[t,e];let c=(l-n+2*i)*(a-s+2*i),p=(h-o+2*i)*(u-d+2*i),g=Math.min(n,o),f=Math.min(s,d),m=Math.max(l,h),y=Math.max(a,u);return c+p>(m-g)*(y-f)?[{x1:g,x2:m,y1:f,y2:y}]:[t,e]}function jm(t){let e=[];return function t(i,r){let n=[];r.forEach(t=>{let e;(e=jf(i,t)).length>1?n.push(t):i=e[0]}),e.push(i),n.length&&t(n[0],n.slice(1))}(t[0],t.slice(1)),e}function jy(t,e,i){return m=e.x-t.x,x=_=Math.sqrt((v=y=e.y-t.y)*v+(b=-m)*b),w=i,v/=_,b/=_,m=(C=i/2)*v,y=C*b,{point1:{x:t.x+m,y:t.y+y},point2:{x:t.x-m,y:t.y-y},point3:{x:e.x+m,y:e.y+y},point4:{x:e.x-m,y:e.y-y},width:x,height:w,left:Math.min(t.x,e.x)-Math.abs(m),top:Math.min(t.y,e.y)-Math.abs(y)}}let jv={x:0,y:0},jb={x:0,y:0};function j_(t,e){return jv.x=(e.point1.x+e.point2.x)/2,jv.y=(e.point1.y+e.point2.y)/2,jb.x=(e.point3.x+e.point4.x)/2,jb.y=(e.point3.y+e.point4.y)/2,jC(t,jv,jb,e.height)}function jC(t,e,i,r){return(0,ik.Ct)(t,e,i)<=r/2&&jA(t,e,i)}let jx={x:0,y:0},jw={x:0,y:0},jS={x:0,y:0};function jA(t,e,i){return jx.x=e.x-t.x,jx.y=e.y-t.y,jw.x=i.x-t.x,jw.y=i.y-t.y,jS.x=e.y-i.y,jS.y=i.x-e.x,(0,ik.i1)(jx,jS)*(0,ik.i1)(jw,jS)<0}class jM{constructor(t){this.canvas=t,t&&(this.ctx=t.getContext("2d"))}setCanvas(t){this.canvas=t,t&&(this.ctx=t.getContext("2d"))}measureText(t){return this.canvas?this.measureTextByCanvas(t):(console.warn("[warn] no canvas, measureText might be not accurate"),this.estimate(t))}measureTextByCanvas(t){return this.ctx?(this.ctx.font=function({fontStyle:t,fontVariant:e,fontWeight:i,fontSize:r,fontFamily:n}){return(t?t+" ":"")+(e?e+" ":"")+(i?i+" ":"")+(r||12)+"px "+(n||"sans-serif")}(t),{width:this.ctx.measureText(t.text).width,height:t.fontSize}):(console.error("[error!!!]measureTextByCanvas can not be called without canvas"),{width:-1,height:t.fontSize})}estimate({text:t,fontSize:e}){let i=0,r=0;for(let e=0;e<t.length;e++)128>t.charCodeAt(e)?i++:r++;return{width:~~(.8*i*e+r*e),height:e}}static getDefaultUtils(t){return jM.instance||(jM.instance=new jM(t)),jM.instance}}let jT=(t,e)=>{let{startAngle:i,endAngle:r,innerRadius:n,outerRadius:l}=t,s=(i+r)/2,a=(n+l)/2;switch(e){case"inner-start":s=i,a=n;break;case"outer-start":s=i,a=l;break;case"inner-end":s=r,a=n;break;case"outer-end":s=r,a=l;break;case"inner-middle":a=n;break;case"outer-middle":a=l}return{angle:s,radius:a}};var jk=i(3132);function jR(t){return t?"getUTCFullYear":"getFullYear"}function jP(t){return t?"getUTCMonth":"getMonth"}function jB(t){return t?"getUTCDate":"getDate"}function jI(t){return t?"getUTCHours":"getHours"}function jE(t){return t?"getUTCMinutes":"getMinutes"}function jL(t){return t?"getUTCSeconds":"getSeconds"}function jF(t){return t?"getUTCMilliseconds":"getMilliseconds"}function jO(t){return t?"setUTCFullYear":"setFullYear"}function jH(t){return t?"setUTCMonth":"setMonth"}function jD(t){return t?"setUTCDate":"setDate"}function jz(t){return t?"setUTCHours":"setHours"}function jW(t){return t?"setUTCMinutes":"setMinutes"}function jZ(t){return t?"setUTCSeconds":"setSeconds"}function jN(t){return t?"setUTCMilliseconds":"setMilliseconds"}function jj(t,e){let i=N5(t),r=i[jP(e)]()+1,n=i[jB(e)](),l=i[jI(e)](),s=i[jE(e)](),a=i[jL(e)](),o=0===i[jF(e)](),h=o&&0===a,d=h&&0===s,u=d&&0===l,c=u&&1===n;return c&&1===r?"YYYY":c?"YYYY-MM":u?"YYYY-MM-DD":d?"HH":h?"HH:mm":o?"HH:mm:ss":"HH:mm:ss SSS"}function jG(t,e){return i=>{let r=N5(i),n=r[jR(e)](),l=r[jP(e)]()+1,s=Math.floor((l-1)/3)+1,a=r[jB(e)](),o=r["get"+(e?"UTC":"")+"Day"](),h=r[jI(e)](),d=(h-1)%12+1,u=r[jE(e)](),c=r[jL(e)](),p=r[jF(e)]();return(t||"").replace(/YYYY/g,NQ(n+"",4,"0","left")).replace(/yyyy/g,n+"").replace(/yy/g,n%100+"").replace(/Q/g,s+"").replace(/MM/g,NQ(l,2,"0","left")).replace(/M/g,l+"").replace(/dd/g,NQ(a,2,"0","left")).replace(/d/g,a+"").replace(/e/g,o+"").replace(/HH/g,NQ(h,2,"0","left")).replace(/H/g,h+"").replace(/hh/g,NQ(d+"",2,"0","left")).replace(/h/g,d+"").replace(/mm/g,NQ(u,2,"0","left")).replace(/m/g,u+"").replace(/ss/g,NQ(c,2,"0","left")).replace(/s/g,c+"").replace(/SSS/g,NQ(p,3,"0","left")).replace(/S/g,p+"")}}let jV=1e3,jU=6e4,jK=36e5,jX=864e5,jY=26784e5,j$=31536e6,jq=t=>(t.setMonth(0,1),t.setHours(0,0,0,0),t),jJ=(t,e)=>(t.setFullYear(t.getFullYear()+e),t),jQ=(t,e)=>e.getFullYear()-t.getFullYear(),j0=t=>t.getFullYear(),j1=t=>(t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0),t),j2=(t,e)=>(t.setUTCFullYear(t.getUTCFullYear()+e),t),j3=(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),j5=t=>t.getUTCFullYear(),j4=t=>(t.setDate(1),t.setHours(0,0,0,0),t),j6=(t,e)=>(t.setMonth(t.getMonth()+e),t),j7=(t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear()),j8=t=>t.getMonth(),j9=t=>(t.setUTCDate(1),t.setUTCHours(0,0,0,0),t),Gt=(t,e)=>(t.setUTCMonth(t.getUTCMonth()+e),t),Ge=(t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear()),Gi=t=>t.getUTCMonth(),Gr=t=>(t.setHours(0,0,0,0),t),Gn=(t,e)=>(t.setDate(t.getDate()+e),t),Gl=(t,e)=>(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/jX,Gs=t=>t.getDate()-1,Ga=t=>(t.setUTCHours(0,0,0,0),t),Go=(t,e)=>(t.setUTCDate(t.getUTCDate()+e),t),Gh=(t,e)=>(e-t)/jX,Gd=t=>t.getUTCDate()-1,Gu=t=>(t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes()),t),Gc=(t,e)=>(t.setHours(t.getHours()+e),t),Gp=(t,e)=>(e-t)/jK,Gg=t=>t.getHours(),Gf=t=>(t.setTime(t-t.getUTCMilliseconds()-1e3*t.getUTCSeconds()-6e4*t.getUTCMinutes()),t),Gm=(t,e)=>(t.setUTCHours(t.getUTCHours()+e),t),Gy=t=>t.getUTCHours(),Gv=t=>(t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()),t),Gb=(t,e)=>(t.setMinutes(t.getMinutes()+e),t),G_=(t,e)=>(e-t)/6e4,GC=t=>t.getMinutes(),Gx=t=>(t.setTime(t-t.getUTCMilliseconds()-1e3*t.getUTCSeconds()),t),Gw=(t,e)=>(t.setUTCMinutes(t.getUTCMinutes()+e),t),GS=t=>t.getUTCMinutes(),GA=t=>(t.setTime(t-t.getMilliseconds()),t),GM=(t,e)=>(t.setSeconds(t.getSeconds()+e),t),GT=(t,e)=>(e-t)/1e3,Gk=t=>t.getSeconds(),GR=t=>(t.setTime(t-t.getUTCMilliseconds()),t),GP=(t,e)=>(t.setUTCSeconds(t.getUTCSeconds()+e),t),GB=t=>t.getUTCSeconds(),GI=t=>t,GE=(t,e)=>(t.setTime(+t+e),t),GL=(t,e)=>e-t,GF=(t,e)=>i=>{let r=new Date(i-1);return e(r,1),t(r),r},GO=(t,e)=>(i,r)=>{let n=new Date,l=new Date;return n.setTime(+i),l.setTime(+r),t(n),t(l),Math.floor(e(n,l))},GH=(t,{floor:e,offset:i,field:r,count:n})=>{let l=Math.floor(t);if(!Number.isFinite(l)||l<=0)return null;if(l<=1)return{floor:e,offset:i,ceil:GF(e,i)};let s=GO(e,n),a=r?t=>r(t)%l==0:t=>s(0,t)%l==0,o=t=>{if(!Number.isNaN(+t))for(e(t);!a(t);)t.setTime(t-1),e(t);return t},h=(t,e)=>{if(!Number.isNaN(+t))if(l<0)for(;++e<=0;)for(i(t,-1);!a(t);)i(t,-1);else for(;--e>=0;)for(i(t,1);!a(t);)i(t,1);return t};return{floor:o,offset:h,ceil:GF(o,h)}},GD=(t,e)=>"year"===t&&e?{floor:j1,offset:j2,count:j3,field:j5}:"month"===t&&e?{floor:j9,offset:Gt,count:Ge,field:Gi}:"day"===t&&e?{floor:Ga,offset:Go,count:Gh,field:Gd}:"hour"===t&&e?{floor:Gf,offset:Gm,count:Gp,field:Gy}:"minute"===t&&e?{floor:Gx,offset:Gw,count:G_,field:GS}:"second"===t&&e?{floor:GR,offset:GP,count:GT,field:GB}:"year"===t?{floor:jq,offset:jJ,count:jQ,field:j0}:"month"===t?{floor:j4,offset:j6,count:j7,field:j8}:"day"===t?{floor:Gr,offset:Gn,count:Gl,field:Gs}:"hour"===t?{floor:Gu,offset:Gc,count:Gp,field:Gg}:"minute"===t?{floor:Gv,offset:Gb,count:G_,field:GC}:"second"===t?{floor:GA,offset:GM,count:GT,field:Gk}:{floor:GI,offset:GE,count:GL};var Gz=i(49015);function GW(t,e){if(!t||!e)return!1;let i="Feature"===e.type?e.geometry:e,r=i.type,n=e.bbox,l=i.coordinates;if(n&&!0===(0,aj.qr)(t,{x1:n[0],x2:n[1],y1:n[1],y2:n[3]},!0))return!1;"Polygon"===r&&(l=[l]);for(let e=0;e<l.length;++e)for(let i=0;i<l[e].length;++i)if((0,r2.O0)(l[e][i].map(t=>({x:t[0],y:t[1]})),t.x,t.y))return!0;return!1}function GZ(t,e,i,r={}){let n=(0,iH.M4)(t[0]),l=(0,iH.M4)(t[1]),s=(0,iH.M4)(i),a=(0,Gz.lF)(e,r.units),o=Math.asin(Math.sin(l)*Math.cos(a)+Math.cos(l)*Math.sin(a)*Math.cos(s)),h=n+Math.atan2(Math.sin(s)*Math.sin(a)*Math.cos(l),Math.cos(a)-Math.sin(l)*Math.sin(o));return{x:(0,iH.Dt)(h),y:(0,iH.Dt)(o)}}let GN=1e-10;function Gj(t,e){let i=function(t){let e=[];for(let i=0;i<t.length;++i)for(let r=i+1;r<t.length;++r){let n=GK(t[i],t[r]);for(let t=0;t<n.length;++t){let l=n[t];l.parentIndex=[i,r],e.push(l)}}return e}(t),r=i.filter(function(e){return GG(e,t)}),n=0,l=0,s=[];if(r.length>1){let e=GX(r);for(let t=0;t<r.length;++t){let i=r[t];i.angle=Math.atan2(i.x-e.x,i.y-e.y)}r.sort(function(t,e){return e.angle-t.angle});let i=r[r.length-1];for(let e=0;e<r.length;++e){let a=r[e];l+=(i.x+a.x)*(a.y-i.y);let o={x:(a.x+i.x)/2,y:(a.y+i.y)/2},h=null;for(let e=0;e<a.parentIndex.length;++e)if(i.parentIndex.indexOf(a.parentIndex[e])>-1){let r=t[a.parentIndex[e]],n=Math.atan2(a.x-r.x,a.y-r.y),l=Math.atan2(i.x-r.x,i.y-r.y),s=l-n;s<0&&(s+=2*Math.PI);let d=l-s/2,u=iN.HL.distancePP(o,{x:r.x+r.radius*Math.sin(d),y:r.y+r.radius*Math.cos(d)});u>2*r.radius&&(u=2*r.radius),(null===h||h.width>u)&&(h={circle:r,width:u,p1:a,p2:i})}null!==h&&(s.push(h),n+=GV(h.circle.radius,h.width),i=a)}}else{let e=t[0];for(let i=1;i<t.length;++i)t[i].radius<e.radius&&(e=t[i]);let i=!1;for(let r=0;r<t.length;++r)if(iN.HL.distancePP(t[r],e)>Math.abs(e.radius-t[r].radius)){i=!0;break}i?n=l=0:(n=e.radius*e.radius*Math.PI,s.push({circle:e,p1:{x:e.x,y:e.y+e.radius},p2:{x:e.x-GN,y:e.y+e.radius},width:2*e.radius}))}return l/=2,e&&(e.area=n+l,e.arcArea=n,e.polygonArea=l,e.arcs=s,e.innerPoints=r,e.intersectionPoints=i),n+l}function GG(t,e){for(let i=0;i<e.length;++i)if(iN.HL.distancePP(t,e[i])>e[i].radius+GN)return!1;return!0}function GV(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function GU(t,e,i){return i>=t+e?0:i<=Math.abs(t-e)?Math.PI*Math.min(t,e)*Math.min(t,e):GV(t,t-(i*i-e*e+t*t)/(2*i))+GV(e,e-(i*i-t*t+e*e)/(2*i))}function GK(t,e){let i=iN.HL.distancePP(t,e),r=t.radius,n=e.radius;if(i>=r+n||i<=Math.abs(r-n))return[];let l=(r*r-n*n+i*i)/(2*i),s=Math.sqrt(r*r-l*l),a=t.x+l*(e.x-t.x)/i,o=t.y+l*(e.y-t.y)/i,h=-(e.y-t.y)*(s/i),d=-(e.x-t.x)*(s/i);return[{x:a+h,y:o-d},{x:a-h,y:o+d}]}function GX(t){let e={x:0,y:0};for(let i=0;i<t.length;++i)e.x+=t[i].x,e.y+=t[i].y;return e.x/=t.length,e.y/=t.length,e}function GY(t){let e=Array(t);for(let i=0;i<t;++i)e[i]=0;return e}function G$(t,e){return GY(t).map(function(){return GY(e)})}function Gq(t){return Math.sqrt((0,ik.Ih)(t,t))}function GJ(t,e,i){for(let r=0;r<e.length;++r)t[r]=e[r]*i}function GQ(t,e,i,r,n){for(let l=0;l<t.length;++l)t[l]=e*i[l]+r*n[l]}function G0(t,e,i){for(let r=0;r<t.length;++r)t[r]=(0,ik.Ih)(e[r],i)}function G1(t,e,i){let r,n=(i=i||{}).maxIterations||200*e.length,l=i.nonZeroDelta||1.05,s=i.zeroDelta||.001,a=i.minErrorDelta||1e-6,o=i.minErrorDelta||1e-5,h=void 0!==i.rho?i.rho:1,d=void 0!==i.chi?i.chi:2,u=void 0!==i.psi?i.psi:-.5,c=void 0!==i.sigma?i.sigma:.5,p=e.length,g=Array(p+1);g[0]=e,g[0].fx=t(e),g[0].id=0;for(let i=0;i<p;++i){let r=e.slice();r[i]=r[i]?r[i]*l:s,g[i+1]=r,g[i+1].fx=t(r),g[i+1].id=i+1}function f(t){for(let e=0;e<t.length;e++)g[p][e]=t[e];g[p].fx=t.fx}let m=function(t,e){return t.fx-e.fx},y=e.slice(),v=e.slice(),b=e.slice(),_=e.slice();for(let e=0;e<n;++e){if(g.sort(m),i.history){let t=g.map(function(t){let e=t.slice();return e.fx=t.fx,e.id=t.id,e});t.sort(function(t,e){return t.id-e.id}),i.history.push({x:g[0].slice(),fx:g[0].fx,simplex:t})}r=0;for(let t=0;t<p;++t)r=Math.max(r,Math.abs(g[0][t]-g[1][t]));if(Math.abs(g[0].fx-g[p].fx)<a&&r<o)break;for(let t=0;t<p;++t){y[t]=0;for(let e=0;e<p;++e)y[t]+=g[e][t];y[t]/=p}let e=g[p];if(GQ(v,1+h,y,-h,e),v.fx=t(v),v.fx<g[0].fx)GQ(_,1+d,y,-d,e),_.fx=t(_),f(_.fx<v.fx?_:v);else if(v.fx>=g[p-1].fx){let i=!1;if(v.fx>e.fx?(GQ(b,1+u,y,-u,e),b.fx=t(b),b.fx<e.fx?f(b):i=!0):(GQ(b,1-u*h,y,u*h,e),b.fx=t(b),b.fx<v.fx?f(b):i=!0),i){if(c>=1)break;for(let e=1;e<g.length;++e)GQ(g[e],1-c,g[0],c,g[e]),g[e].fx=t(g[e])}}else f(v)}return g.sort(m),{fx:g[0].fx,x:g[0]}}function G2(t,e,i){let r={x:e.slice(),fx:0,fxprime:e.slice()},n={x:e.slice(),fx:0,fxprime:e.slice()},l=e.slice(),s,a=1,o=(i=i||{}).maxIterations||20*e.length;r.fx=t(r.x,r.fxprime);let h=r.fxprime.slice();GJ(h,r.fxprime,-1);for(let e=0;e<o;++e){if(a=function(t,e,i,r,n,l,s){let a=i.fx,o=(0,ik.Ih)(i.fxprime,e),h=a,d=a,u=o,c=0;function p(d,c,p){for(let g=0;g<16;++g)if(n=(d+c)/2,GQ(r.x,1,i.x,n,e),h=r.fx=t(r.x,r.fxprime),u=(0,ik.Ih)(r.fxprime,e),h>a+l*n*o||h>=p)c=n;else{if(Math.abs(u)<=-s*o)return n;u*(c-d)>=0&&(c=d),d=n,p=h}return 0}n=n||1,l=l||1e-6,s=s||.1;for(let g=0;g<10;++g){if(GQ(r.x,1,i.x,n,e),h=r.fx=t(r.x,r.fxprime),u=(0,ik.Ih)(r.fxprime,e),h>a+l*n*o||g&&h>=d)return p(c,n,d);if(Math.abs(u)<=-s*o)break;if(u>=0)return p(n,c,h);d=h,c=n,n*=2}return n}(t,h,r,n,a),i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:a}),a){GQ(l,1,n.fxprime,-1,r.fxprime);let t=(0,ik.Ih)(r.fxprime,r.fxprime);GQ(h,Math.max(0,(0,ik.Ih)(l,n.fxprime)/t),h,-1,n.fxprime),s=r,r=n,n=s}else GJ(h,r.fxprime,-1);if(1e-5>=Gq(r.fxprime))break}return i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:a}),r}let G3=bg},11798:function(t,e,i){i.d(e,{T:()=>f});var r=i(51012),n=i(59779),l=i(83808),s=i(95723),a=i(64776),o=i(20219),h=i(22488),d=i(22288),u=i(31877),c=i(53430);function p(t,e){let i=e.getDrawRange();if((0,a.Z)(t)&&t>=e.frozenRowCount){let r=e.getFrozenRowsHeight(),n=e.getRowsHeight(0,t-1);e.scrollTop=Math.min(n-r,e.getAllRowsHeight()-i.height)-1}e.scenegraph.updateNextFrame()}var g=i(77643);(0,n.R2)(),(0,n.Eg)(),(0,n.I)(),(0,n.FD)(),(0,n._t)(),(0,n.Mh)(),u.F.registerComponent("listTreeStickCellPlugin",class t{constructor(t){this.titleRows=[],this.showedTitleRows=[],this.rowNow=-1,this.skipStartRow=-1,this.skipEndRow=-1,this.table=t,this.table.on("scroll",t=>{"vertical"===t.scrollDirection&&this.updateGroupTitle()}),this.table.on("tree_hierarchy_state_change",t=>{this.updateGroupTitle()}),this.table.on("resize_column",t=>{this.updateGroupTitle()})}updateGroupTitle(){0===this.table.scrollTop?(this.titleRows=[],this.showedTitleRows=[]):-1!==this.skipStartRow&&-1!==this.skipEndRow&&this.skipStartRow!==this.table.scenegraph.proxy.bodyTopRow-1?(this.table.scenegraph.proxy.screenTopRow<=this.skipStartRow||this.table.scenegraph.proxy.screenTopRow>=this.skipEndRow)&&(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()):(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()),this.updateScenegraph()}updateGroupTitleInfo(){this.rowNow=this.table.scenegraph.proxy.screenTopRow+this.titleRows.length;let t=this.table.getRecordIndexByCell(0,this.rowNow),e=this.table.getRecordIndexByCell(0,this.rowNow+1);this.getTitleRowsByRecordIndex(t,e)}getTitleRowsByRecordIndex(t,e){let i=[];(0,s.Z)(t)||(t=[t]),(0,s.Z)(e)||(e=[e]);for(let e=0;e<t.length;e++){let r=t.slice(0,e+1),n=this.table.dataSource.getRaw(r);i.push(n)}let r=[],n=e.length===t.length+1,l=t.slice(0,n?t.length:t.length-1),a=this.table.dataSource.currentIndexedData;for(let e=this.rowNow-this.table.columnHeaderLevelCount;e>=0;e--){let i=a[e];if((0,s.Z)(i)&&l.length===i.length){let t=!0;for(let e=0;e<i.length;e++)if(i[e]!==l[e]){t=!1;break}t&&(r.push(e+this.table.columnHeaderLevelCount),l=l.slice(0,l.length-1))}else if(i===t[0]){r.push(e+this.table.columnHeaderLevelCount);break}}this.titleRows=r.reverse()}updateScenegraph(){let{table:t}=this,{shadowGroup:e,shadowGroupFrozen:i}=function(t){let e=t.scenegraph.colHeaderGroup,i=t.scenegraph.cornerHeaderGroup;if(!e.border){let i=(0,d.f)({x:0,y:0,width:0,height:0,cursor:"pointer"});e.add(i),e.border=i,i.attachShadow(i.shadowRoot),i.name="border-rect",i.addEventListener("click",e=>{let i=t.listTreeStickCellPlugin.titleRows,{shadowTarget:r}=e.pickParams,{col:n,row:l}=(0,c.J$)(r);p(l-i.indexOf(l),t)})}if(!i.border){let e=(0,d.f)({x:0,y:0,width:0,height:0,cursor:"pointer"});i.add(e),i.border=e,e.attachShadow(e.shadowRoot),e.name="border-rect",e.addEventListener("click",e=>{let i=t.listTreeStickCellPlugin.titleRows,{shadowTarget:r}=e.pickParams,{col:n,row:l}=(0,c.J$)(r);p(l-i.indexOf(l),t)})}let r=e.border.shadowRoot,n=i.border.shadowRoot;return r.removeAllChild(),n.removeAllChild(),{shadowGroup:r,shadowGroupFrozen:n}}(t);this.showedTitleRows.length=0;let r=0;for(let u=0;u<t.colCount;u++){let c;u<t.frozenColCount?(c=new o.Z({x:t.getColsWidth(0,u-1),y:t.getFrozenRowsHeight()}),i.add(c)):(c=new o.Z({x:t.getColsWidth(t.frozenColCount,u-1),y:t.getFrozenRowsHeight()}),e.add(c)),c.col=u;for(let e=0;e<this.titleRows.length;e++){var n,l,s,a;let i=this.titleRows[e];if(n=i,l=this.rowNow,s=t.scenegraph.proxy.screenTopRow,a=this.titleRows,n===l&&n!==s+a.length-1||n===s+a.indexOf(n)+1&&n<l){0===u&&r++;continue}0===u&&this.showedTitleRows.push(i);let o=t.scenegraph.getCell(u,i);if("cell"===o.role){let t=function t(e){let i=e.clone();if(i.role=e.role,i.col=e.col,i.row=e.row,i.mergeStartCol=e.mergeStartCol,i.mergeStartRow=e.mergeStartRow,i.mergeEndCol=e.mergeEndCol,i.mergeEndRow=e.mergeEndRow,i.contentWidth=e.contentWidth,i.contentHeight=e.contentHeight,"cell"===i.role){let t=(0,d.f)({x:0,y:0,width:i.attribute.width,height:i.attribute.height});i.add(t)}return"group"===e.type&&e.forEachChildren(e=>{let r=t(e);i.add(r)}),i}(o);t.setAttributes({y:40*e}),c.add(t)}else{let r=(0,h.wW)(u,i,t,!0,!0);r.setAttributes({y:40*e}),c.add(r)}}}r>0&&-1===this.skipStartRow&&-1===this.skipEndRow&&(this.skipStartRow=t.scenegraph.proxy.screenTopRow-1,this.skipEndRow=t.scenegraph.proxy.screenTopRow+1)}}),(0,l.zf)(),(0,n.ph)(),(0,g.LQ)(),(0,g.yR)(),(0,g.pk)(),(0,g.m4)(),(0,g.Jy)(),(0,g.VT)(),(0,g.ah)(),(0,g.dB)(),(0,g.ge)(),(0,g.au)();class f extends r.e{}},51012:function(t,e,i){i.d(e,{e:()=>O});var r=i(72281),n=i(20408),l=i(64776),s=i(77874),a=i(994),o=i(26595),h=i(66023);class d{constructor(t,e,i,r){var n,l;this.seqId=0,this._columnMaxDepth=0,this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this.bodyRowSpanCount=1,this._transpose=!1,this._showHeader=!0,this._recordsCount=0,this._hasAggregation=!1,this._hasAggregationOnTopCount=0,this._hasAggregationOnBottomCount=0,this._cellRangeMap=new Map,this._showHeader=i,this._table=t,this._columns=[],this._columnsIncludeHided=[],this._headerCellIds=[],this._columnMaxDepth=this._calculateMaxDepth(e),this.hierarchyIndent=null!=r?r:20,this.hierarchyTextStartAlignment=t.options.hierarchyTextStartAlignment,this.columnHierarchyType=t.options.headerHierarchyType,this.columnExpandLevel=null!=(n=t.options.headerExpandLevel)?n:1,this.columnTree=new h.KO(e,{seqId:0},null!=(l=this.columnHierarchyType)?l:null,"grid-tree"===this.columnHierarchyType?this.columnExpandLevel:void 0),this._headerObjectsIncludeHided=this._addHeaders(0,e,[]),this._headerObjects=this._headerObjectsIncludeHided.filter(t=>!0!==t.define.hide),this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this.rowHierarchyType=(0,o.C1)(this)?"tree":"grid",this._hasAggregation=(0,o.MP)(this),this._hasAggregationOnBottomCount=(0,o.WM)(this),this._hasAggregationOnTopCount=(0,o.OT)(this),this.handleRowSeriesNumber(t.internalProps.rowSeriesNumber)}handleRowSeriesNumber(t){var e,i,r;t&&(Array.isArray(t)?this.rowSeriesNumberColumn=t.map((t,e)=>{var i,r;return{id:this.seqId++,title:t.title,define:(0,n.Z)({field:"_vtable_rowSeries_number_"+e},t),cellType:null!=(i=t.cellType)?i:"text",headerType:"checkbox"===t.cellType?"checkbox":"text",style:t.style,width:t.width,format:t.format,field:null!=(r=t.field)?r:"_vtable_rowSeries_number_"+e,icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:this.seqId++,title:t.title,define:(0,n.Z)({field:"_vtable_rowSeries_number"},t),cellType:null!=(e=t.cellType)?e:"text",headerType:null!=(i=t.headerType)?i:"checkbox"===t.cellType?"checkbox":"text",style:t.style,width:t.width,format:t.format,field:null!=(r=t.field)?r:"_vtable_rowSeries_number",icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(t=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(t=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}get transpose(){return this._transpose}set transpose(t){this._transpose=t}get showHeader(){return this._showHeader}set showHeader(t){this._showHeader=t}isSeriesNumberInHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}if(this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}return!1}isSeriesNumberInBody(t,e){return!!(this.leftRowSeriesNumberColumnCount>0)&&!!(t>=0)&&!!(t<this.leftRowSeriesNumberColumnCount)&&(!!this.transpose||!!(e>=this.headerLevelCount))||!!(this.rightRowSeriesNumberColumnCount>0)&&!!(t>=this.colCount-this.rightRowSeriesNumberColumnCount)&&(!!this.transpose||!!(e>=this.headerLevelCount))||!1}isSeriesNumber(t,e){return!!((0,l.Z)(t)&&(0,l.Z)(e))&&(!!(this.leftRowSeriesNumberColumnCount>0)&&!!(t>=0)&&!!(e>=0)&&!!(t<this.leftRowSeriesNumberColumnCount)||!!(this.rightRowSeriesNumberColumnCount>0)&&!!(e>=0)&&!!(t>=this.colCount-this.rightRowSeriesNumberColumnCount))||!1}getSeriesNumberHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return;if(e<this.headerLevelCount)return Object.assign({},this.leftRowSeriesNumberColumn[t],{style:Object.assign({},this._table.transpose?this._table.internalProps.theme.rowHeaderStyle:this._table.internalProps.theme.headerStyle,this._table.internalProps.rowSeriesNumber.headerStyle)})}if(this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e<this.headerLevelCount){if(this.transpose)return;if(e<this.headerLevelCount)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]}}getSeriesNumberBody(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount)?this.leftRowSeriesNumberColumn[t]:this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount)?this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}isHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)||!this.transpose&&e>=0&&e<this.headerLevelCount}isAggregation(t,e){if(this.hasAggregation){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}}return!1}isTopAggregation(t,e){if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}return!1}isBottomAggregation(t,e){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}return!1}get hasAggregation(){return this._hasAggregation}get hasAggregationOnTopCount(){return this._hasAggregationOnTopCount}get hasAggregationOnBottomCount(){return this._hasAggregationOnBottomCount}getAggregatorsByCell(t,e){return this.getColumnDefine(t,e).vtable_aggregator}getAggregatorsByCellRange(t,e,i,r){let n=[];if(!this.transpose){for(let r=t;r<=i;r++){let t=this.getColumnDefine(r,e);t.vtable_aggregator&&(n=n.concat(Array.isArray(t.vtable_aggregator)?t.vtable_aggregator:[t.vtable_aggregator]))}return n}for(let i=e;i<=r;i++){let e=this.getColumnDefine(t,i);e.vtable_aggregator&&(n=n.concat(Array.isArray(e.vtable_aggregator)?e.vtable_aggregator:[e.vtable_aggregator]))}return[]}getAggregatorOnTop(t,e){let i=this.getColumnDefine(t,e),r=i.vtable_aggregator,n=i.aggregation;if(Array.isArray(n)){let i=n.reduce((t,e,i)=>(e.showOnTop&&t.push(i),t),[]).map(t=>r[t]);return this.transpose?i[t-this.rowHeaderLevelCount]:i[e-this.columnHeaderLevelCount]}return this.transpose&&t-this.rowHeaderLevelCount==0?(null==n?void 0:n.showOnTop)?r:null:this.transpose||e-this.columnHeaderLevelCount!=0?null:(null==n?void 0:n.showOnTop)?r:null}getAggregatorOnBottom(t,e){let i=this.getColumnDefine(t,e),r=i.vtable_aggregator,n=i.aggregation;if(Array.isArray(n)){let i=n.reduce((t,e,i)=>(e.showOnTop||t.push(i),t),[]).map(t=>r[t]);return this.transpose?i[t-(this.colCount-this.hasAggregationOnBottomCount)]:i[e-(this.rowCount-this.hasAggregationOnBottomCount)]}return this.transpose&&t-(this.colCount-this.hasAggregationOnBottomCount)==0?(null==n?void 0:n.showOnTop)?null:r:this.transpose||e-(this.rowCount-this.hasAggregationOnBottomCount)!=0||(null==n?void 0:n.showOnTop)?null:r}getAggregatorCellAddress(t,e,i,r){let n=[],l=this.hasAggregationOnTopCount,s=this.hasAggregationOnBottomCount;if(this.transpose){for(let i=e;i<=r;i++)if(this.getColumnDefine(t,i).vtable_aggregator){for(let t=0;t<l;t++)n.push({col:this.headerLevelCount+t,row:i});for(let t=0;t<s;t++)n.push({col:this.rowCount-s+t,row:i})}}else for(let r=t;r<=i;r++)if(this.getColumnDefine(r,e).vtable_aggregator){for(let t=0;t<l;t++)n.push({col:r,row:this.headerLevelCount+t});for(let t=0;t<s;t++)n.push({col:r,row:this.rowCount-s+t})}return n}getCellLocation(t,e){return this.isHeader(t,e)?this.transpose?"rowHeader":"columnHeader":"body"}isRowHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)}isColumnHeader(t,e){return!this.transpose&&e>=0&&e<=this.headerLevelCount-1&&t>=this.leftRowSeriesNumberColumnCount&&t<this.colCount-this.rightRowSeriesNumberColumnCount}isFrozenColumn(t,e){if((0,l.Z)(e)){if(t>=0&&t<this.frozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&t>=0&&t<this.frozenColCount)return!0;return!1}isRightFrozenColumn(t,e){if((0,l.Z)(e)){if(t>=this.colCount-this.rightFrozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&t>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(t,e){if((0,l.Z)(e)){if(e>=0&&e<this.frozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.frozenRowCount>0&&e>=0&&e<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(t,e){if((0,l.Z)(e)){if(e>=this.rowCount-this.bottomFrozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.bottomFrozenRowCount>0&&e>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=0&&e<this.frozenRowCount}isLeftBottomCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=0&&e<this.frozenRowCount}isRightBottomCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isCornerHeader(t,e){return!1}getColumnHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:(null!=(t=this.rowCount)?t:0)-1}}:{start:{col:0,row:0},end:{col:(null!=(e=this.colCount)?e:0)-1,row:this._headerCellIds.length-1}}}getRowHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:(null!=(t=this.rowCount)?t:0)-1}}:{start:{col:0,row:0},end:{col:(null!=(e=this.colCount)?e:0)-1,row:this._headerCellIds.length-1}}}getCornerHeaderRange(){}getBodyRange(){var t,e,i,r;return this.transpose?{start:{col:this.headerLevelCount,row:0},end:{col:(null!=(t=this.colCount)?t:0)-1,row:(null!=(e=this.rowCount)?e:0)-1}}:{start:{col:0,row:this.headerLevelCount},end:{col:(null!=(i=this.colCount)?i:0)-1,row:(null!=(r=this.rowCount)?r:0)-1}}}get headerLevelCount(){return this.showHeader?this._headerCellIds.length:0}get columnHeaderLevelCount(){return this.transpose?0:this.headerLevelCount}get rowHeaderLevelCount(){return this.transpose?this.headerLevelCount:0}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get bottomFrozenRowCount(){return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0}get rightFrozenColCount(){return this._table.internalProps.rightFrozenColCount?this.colCount-this.frozenColCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:Math.max(0,this.colCount-this.frozenColCount):0}get colCount(){return this.transpose?this.headerLevelCount+this.recordsCount+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount:this._columns.length+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount}get rowCount(){return this.transpose?this._columns.length:this.headerLevelCount+this.recordsCount}get bodyRowCount(){return this.transpose?this._columns.length:this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.transpose?this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount:this._columns.length}get recordsCount(){return this._recordsCount}set recordsCount(t){this._recordsCount=t}get headerObjects(){return this._headerObjects}get columnObjects(){return this._columns}get headerObjectsIncludeHided(){return this._headerObjectsIncludeHided}get columnWidths(){if(this.leftRowSeriesNumberColumnCount){let t=this.leftRowSeriesNumberColumn.map(t=>({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}));return t.push(...this._columns.map(t=>({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}))),t}return this._columns.map(t=>({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}))}getColumnWidthDefined(t){var e;if(t>=0){if(t<this.leftRowSeriesNumberColumnCount)return this.leftRowSeriesNumberColumn[t];if(this.transpose){let i,r,n=0;if(t>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount){let t;return this.columnObjects.forEach((e,l)=>{"number"==typeof e.width?n=Math.max(e.width,n):"auto"===e.width&&(t=!0),"number"==typeof e.minWidth&&(r=Math.max(e.minWidth,r)),"number"==typeof e.maxWidth&&(i=Math.max(e.maxWidth,i))}),{width:n=n>0?n:t?"auto":void 0,minWidth:r,maxWidth:i}}if(this.isRowHeader(t,0)){let i=Array.isArray(this._table.defaultHeaderColWidth)?null!=(e=this._table.defaultHeaderColWidth[t])?e:this._table.defaultColWidth:this._table.defaultHeaderColWidth;return"auto"===i?{width:"auto"}:{width:i}}}return this._columns[t-this.leftRowSeriesNumberColumnCount]}}getCellId(t,e){var i,r,n,l;return this.transpose?t>=this.headerLevelCount+this.leftRowSeriesNumberColumnCount?null==(i=this._columns[e])?void 0:i.id:this.isSeriesNumber(t,e)?e+"_series_number":null==(r=this._headerCellIds[t-this.leftRowSeriesNumberColumnCount])?void 0:r[e]:this.isSeriesNumber(t,e)?this.rowSeriesNumberColumn[t].id:this.headerLevelCount<=e?null==(n=this._columns[t-this.leftRowSeriesNumberColumnCount])?void 0:n.id:null==(l=this._headerCellIds[e])?void 0:l[t-this.leftRowSeriesNumberColumnCount]}getHeader(t,e){if(this.isSeriesNumberInHeader(t,e))return this.getSeriesNumberHeader(t,e);let i=this.getCellId(t,e);return this._headerObjectMap[i]}getHeaderField(t,e){var i,r,n;if(this.isSeriesNumberInHeader(t,e))return null==(i=this.getSeriesNumberHeader(t,e))?void 0:i.field;if(this.isSeriesNumberInBody(t,e))return null==(r=this.getSeriesNumberBody(t,e))?void 0:r.field;let l=this.getCellId(t,e);return(null==(n=this._headerObjectMap[l])?void 0:n.field)||(this.transpose?this._columns[e]&&this._columns[e].field:this._columns[t-this.leftRowSeriesNumberColumnCount]&&this._columns[t-this.leftRowSeriesNumberColumnCount].field)}getHeaderCellAdressById(t){for(let e=0;e<this._headerCellIds.length;e++){let i=this._headerCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return this.transpose?{col:e,row:r}:{col:r+this.leftRowSeriesNumberColumnCount,row:e}}}getHeaderCellAddressByField(t){let e=this.headerObjects.find(e=>e&&e.field===t);return e&&this.getHeaderCellAdressById(e.id)}getBody(t,e){return this.isSeriesNumber(t,e)?this.getSeriesNumberBody(t,e):this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]}getBodyLayoutRangeById(t){var e,i;if(this.transpose){for(let i=0;i<(null!=(e=this.rowCount)?e:0);i++)if(t===this._columns[i].id)return{start:{col:0,row:i},end:{col:0,row:i}}}else for(let e=this.leftRowSeriesNumberColumnCount;e<(null!=(i=this.colCount)?i:0);e++)if(t===this._columns[e-this.leftRowSeriesNumberColumnCount].id)return{start:{col:e,row:0},end:{col:e,row:0}};return{start:{col:-1,row:-1},end:{col:-1,row:-1}}}getCellRange(t,e){return function(t,e,i){var r,n,l;if(-1===t||-1===e)return{start:{col:t,row:e},end:{col:t,row:e}};if(i._cellRangeMap.has(`$${t}$${e}`))return i._cellRangeMap.get(`$${t}$${e}`);let s={start:{col:t,row:e},end:{col:t,row:e}};if(i.transpose)s=function(t,e,i){var r,n,l,s;let a={start:{col:t,row:e},end:{col:t,row:e}};if(i.headerLevelCount+i.leftRowSeriesNumberColumnCount<=t||-1===t&&-1===e){if(i.headerLevelCount+i.leftRowSeriesNumberColumnCount<=t&&(null==(n=null==(r=i.columnObjects[e])?void 0:r.define)?void 0:n.mergeCell)){let r=i._table.getCellValue(t,e);for(let n=t-1;n>=i.headerLevelCount+i.leftRowSeriesNumberColumnCount;n--){let l=i._table.getCellValue(n,e);if("boolean"==typeof i.columnObjects[e].define.mergeCell){if(r!==l)break}else if(!i.columnObjects[e].define.mergeCell(r,l,{source:{col:t,row:e},target:{col:n,row:e},table:i._table}))break;a.start.col=n}for(let n=t+1;n<(null!=(l=i.colCount)?l:0);n++){let l=i._table.getCellValue(n,e);if("boolean"==typeof i.columnObjects[e].define.mergeCell){if(r!==l)break}else if(!i.columnObjects[e].define.mergeCell(r,l,{source:{col:t,row:e},target:{col:n,row:e},table:i._table}))break;a.end.col=n}}return a}let o=i.getCellId(t,e);for(let r=e-1;r>=0&&o===i.getCellId(t,r);r--)a.start.row=r;for(let r=e+1;r<(null!=(s=i.rowCount)?s:0)&&o===i.getCellId(t,r);r++)a.end.row=r;for(let r=t-1;r>=0&&o===i.getCellId(r,e);r--)a.start.col=r;for(let r=t+1;r<i.headerLevelCount+i.leftRowSeriesNumberColumnCount&&o===i.getCellId(r,e);r++)a.end.col=r;return a}(t,e,i);else if(i.headerLevelCount<=e){if(i.headerLevelCount<=e&&(null==(n=null==(r=i.columnObjects[t-i.leftRowSeriesNumberColumnCount])?void 0:r.define)?void 0:n.mergeCell)){let r=i._table.getCellValue(t,e);for(let n=e-1;n>=i.headerLevelCount;n--){let l=i._table.getCellValue(t,n);if("boolean"==typeof i.columnObjects[t-i.leftRowSeriesNumberColumnCount].define.mergeCell){if(r!==l)break}else if(!i.columnObjects[t-i.leftRowSeriesNumberColumnCount].define.mergeCell(r,l,{source:{col:t,row:e},target:{col:t,row:n},table:i._table}))break;s.start.row=n}for(let n=e+1;n<i.rowCount;n++){let l=i._table.getCellValue(t,n);if("boolean"==typeof i.columnObjects[t-i.leftRowSeriesNumberColumnCount].define.mergeCell){if(r!==l)break}else if(!i.columnObjects[t-i.leftRowSeriesNumberColumnCount].define.mergeCell(r,l,{source:{col:t,row:e},target:{col:t,row:n},table:i._table}))break;s.end.row=n}}!function(t,e,i,r){if("tree"!==r.rowHierarchyType)return;let n=r._table.getCellRawRecord(t,e);r._table.internalProps.groupTitleCheckbox&&r._table.internalProps.rowSeriesNumber?(null==n?void 0:n.vtableMerge)&&t>=r.leftRowSeriesNumberColumnCount&&(i.start.col=r.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount,i.end.col=r.colCount-1,i.start.row=i.end.row=e):(null==n?void 0:n.vtableMerge)&&(i.start.col=r.rowHeaderLevelCount,i.end.col=r.colCount-1,i.start.row=i.end.row=e)}(t,e,s,i)}else{let r=i.getCellId(t,e);for(let n=t-1;n>=0&&r===i.getCellId(n,e);n--)s.start.col=n;for(let n=t+1;n<(null!=(l=i.colCount)?l:0)&&r===i.getCellId(n,e);n++)s.end.col=n;for(let n=e-1;n>=0&&r===i.getCellId(t,n);n--)s.start.row=n;for(let n=e+1;n<i.headerLevelCount&&r===i.getCellId(t,n);n++)s.end.row=n}return i._cellRangeMap.set(`$${t}$${e}`,s),s}(t,e,this)}isCellRangeEqual(t,e,i,r){let n=this.getCellRange(t,e),l=this.getCellRange(i,r);return n.start.col===l.start.col&&n.end.col===l.end.col&&n.start.row===l.start.row&&n.end.row===l.end.row}getRecordShowIndexByCell(t,e){let i=this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount;return this.transpose?t<i?-1:t-i:e<i?-1:e-i}getRecordStartRowByRecordIndex(t){return(this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount)+t}_calculateMaxDepth(t,e=0){let i=e;return t.forEach(t=>{if(t.columns&&t.columns.length>0){let r=this._calculateMaxDepth(t.columns,e+1);r>i&&(i=r)}}),i}_addHeaders(t,e,i,n,l){let a=[],o=this._newRow(t,n);return e.forEach(e=>{var h,d,u,c;let p=this._columns.length,g=this.seqId++,f={id:g,title:null!=(h=e.title)?h:e.caption,headerIcon:e.headerIcon,field:e.field,style:e.headerStyle,headerType:null!=(d=e.headerType)?d:"text",dropDownMenu:e.dropDownMenu,define:e,hierarchyState:e.hierarchyState,columnWidthComputeMode:e.columnWidthComputeMode};a[g]=f;let m=t;if(e.levelSpan){m=Math.min(t+e.levelSpan-1,this._columnMaxDepth-1);for(let e=t;e<=m;e++)this._headerCellIds[e]||(this._headerCellIds[e]=[]),void 0===this._headerCellIds[e][p]&&(this._headerCellIds[e][p]=g)}if(l)for(let t=m-1;t>=0;t--)this._headerCellIds[t]&&void 0===this._headerCellIds[t][p]&&void 0!==i[m-l]&&(this._headerCellIds[t][p]=i[m-l]);else for(let t=m-1;t>=0;t--)this._headerCellIds[t]&&void 0===this._headerCellIds[t][p]&&void 0!==i[t]&&(this._headerCellIds[t][p]=i[t]);n?this._headerCellIds[t-1]&&void 0!==this._headerCellIds[t-1][p]&&(o[p]=this._headerCellIds[t-1][p]):o[p]=g;let y=!e.hierarchyState||e.hierarchyState===r.g.expand;if(e.columns&&y)e.columns.every(t=>t.hide)||e.hide||this._addHeaders(m+1,e.columns,[...i,g],e.hideColumnsSubHeader||n,e.levelSpan).forEach(t=>a.push(t));else{let i={id:this.seqId++,field:e.field,fieldFormat:e.fieldFormat,width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth,icon:e.icon,cellType:null!=(c=null!=(u=e.cellType)?u:e.columnType)?c:"text",chartModule:"chartModule"in e?e.chartModule:null,chartSpec:"chartSpec"in e?e.chartSpec:null,sparklineSpec:"sparklineSpec"in e?e.sparklineSpec:s.hW,style:e.style,define:e,columnWidthComputeMode:e.columnWidthComputeMode,disableColumnResize:null==e?void 0:e.disableColumnResize,aggregation:e.aggregation,isChildNode:t>=1};if(this._columnsIncludeHided.push(i),!0!==e.hide){this._columns.push(i);for(let e=t+1;e<this._headerCellIds.length;e++)this._headerCellIds[e][p]=g}}}),a}_newRow(t,e=!1){if(this._headerCellIds[t]){let e=this._headerCellIds[t-1];if(e.length>this._headerCellIds[t].length)for(let i=this._headerCellIds[t].length;i<e.length;i++)this._headerCellIds[t][i]=e[i];return this._headerCellIds[t]}if(e)return[];let i=this._headerCellIds[t]=[];if(!this._columns.length)return i;let r=this._headerCellIds[t-1];for(let t=0;t<r.length;t++)i[t]=r[t];return i}getCellHeaderPaths(t,e){if(this.isSeriesNumber(t,e))return;let i=[],r=[];return this.transpose?r=[{field:this._columns[e].field}]:i=[{field:this._columns[t-this.leftRowSeriesNumberColumnCount].field}],{colHeaderPaths:i,rowHeaderPaths:r,cellLocation:this.getCellLocation(t,e)}}getParentCellId(t,e){if(0!==e){if(this.isColumnHeader(t,e))return this.getCellId(t,e-1);if(this.isRowHeader(t,e)){if(this.isSeriesNumberInBody(t-1,e))return;return this.getCellId(t-1,e)}}}canMoveHeaderPosition(t,e){let i=this._table.stateManager.columnMove.movingColumnOrRow;if(this.isSeriesNumberInHeader(e.col,e.row)||this.isSeriesNumberInHeader(t.col,t.row))return!1;if(!this.transpose&&(this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)||"row"===i)){let i=this.getRecordShowIndexByCell(0,t.row),r=this.getRecordShowIndexByCell(0,e.row);return this._table.dataSource.canChangeOrder(i,r)}if(this.transpose&&(this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)||"row"===i)&&(this.getBody(t.col+this.leftRowSeriesNumberColumnCount,t.row).isChildNode&&this.getBody(e.col+this.leftRowSeriesNumberColumnCount,e.row).isChildNode?(t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1):(t.col=t.col+this.leftRowSeriesNumberColumnCount,e.col=e.col+this.leftRowSeriesNumberColumnCount)),t.col<0||t.row<0||e.col<0||e.row<0||"disabled"===this._table.internalProps.frozenColDragHeaderMode&&this._table.isFrozenColumn(e.col))return!1;let r=this.getCellRange(t.col,t.row);return this.isColumnHeader(t.col,t.row)||"column"===this._table.stateManager.columnMove.movingColumnOrRow&&0===t.row?this.getParentCellId(t.col,r.start.row)===this.getParentCellId(e.col,r.start.row):!!this.isRowHeader(t.col,t.row)&&this.getParentCellId(r.start.col,t.row)===this.getParentCellId(r.start.col,e.row)}moveHeaderPosition(t,e){var i,r,n,l,s,a,o;if((!(null==(i=this._table.options.dragOrder)?void 0:i.validateDragOrderOnEnd)||(null==(r=this._table.options.dragOrder)?void 0:r.validateDragOrderOnEnd(t,e)))&&this.canMoveHeaderPosition(t,e)){let i=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row)||"column"===this._table.stateManager.columnMove.movingColumnOrRow&&0===t.row){let r,h=i.end.col-i.start.col+1,d=this.getCellRange(e.col,i.start.row);if((r=e.col>=t.col?d.end.col-h+1:d.start.col)===i.start.col)return null;for(let t=0;t<this._headerCellIds.length;t++){let e=this._headerCellIds[t].splice(i.start.col-this.leftRowSeriesNumberColumnCount,h);e.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._headerCellIds[t],e)}if(null==(n=this._table.options.dragOrder)?void 0:n.maintainArrayDataOrder)for(let e=0;e<(null==(l=this._table.dataSource.dataSourceObj)?void 0:l.records.length);e++){let n=null==(s=this._table.dataSource.dataSourceObj)?void 0:s.records[e];if(Array.isArray(n)){n.length-1<Math.max(r,t.col)&&n.push(...Array(Math.max(r,t.col)-n.length+1).fill(void 0));let e=n.splice(i.start.col-this.leftRowSeriesNumberColumnCount,h);e.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(n,e)}}let u=this._columns.splice(i.start.col-this.leftRowSeriesNumberColumnCount,h);if(u.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columns,u),null==(a=this._table.options.dragOrder)?void 0:a.maintainArrayDataOrder)for(let t=0;t<this._columns.length;t++)this._columns[t].field=t;if(this.columnTree.movePosition(i.start.row,i.start.col-this.leftRowSeriesNumberColumnCount,r-this.leftRowSeriesNumberColumnCount),null==(o=this._table.options.dragOrder)?void 0:o.maintainArrayDataOrder)for(let t=0;t<this.columnTree.tree.children.length;t++)this.columnTree.tree.children[t].field=t;return this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:i.start.col,targetIndex:r,sourceSize:h,targetSize:d.end.col-d.start.col+1,moveType:"column"}}if(this.isRowHeader(t.col,t.row)||this.isSeriesNumberInBody(t.col,t.row)&&this.transpose){let r;this.isSeriesNumberInBody(t.col,t.row)&&(i=this.getCellRange(t.col+this.leftRowSeriesNumberColumnCount,t.row));let n=i.end.row-i.start.row+1,l=this.getCellRange(i.start.col,e.row);if((r=e.row>=t.row?l.end.row-n+1:l.start.row)===i.start.row)return null;for(let t=0;t<this._headerCellIds.length;t++){let e=this._headerCellIds[t].splice(i.start.row,n);e.unshift(r,0),Array.prototype.splice.apply(this._headerCellIds[t],e)}let s=this._columns.splice(i.start.row,n);return s.unshift(r,0),Array.prototype.splice.apply(this._columns,s),this.columnTree.movePosition(i.start.col-this.leftRowSeriesNumberColumnCount,i.start.row,r+(e.row>t.row?i.end.row-i.start.row:0)),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:i.start.row,targetIndex:r,sourceSize:n,targetSize:l.end.row-l.start.row+1,moveType:"row"}}if(this.isSeriesNumberInBody(t.col,t.row)||"row"===this._table.stateManager.columnMove.movingColumnOrRow)return{sourceIndex:t.row,targetIndex:e.row,sourceSize:1,targetSize:1,moveType:"row"}}return null}toggleHierarchyState(t){return{addCellPositions:t.add.map(t=>({col:0,row:this._table.columnHeaderLevelCount+t})),removeCellPositions:t.remove.map(t=>({col:0,row:this._table.columnHeaderLevelCount+t}))}}setChartInstance(t,e,i){let r=this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount];"function"!=typeof r.chartSpec&&(r.chartInstance=i)}getChartInstance(t,e){return(this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]).chartInstance}checkHasChart(){return(0,a.YL)(this)}getAxisConfigInPivotChart(t,e){}isEmpty(t,e){return!1}isAxisCell(t,e){return!1}getChartAxes(t,e){return[]}isShareChartSpec(t,e){let i=this.getBody(t,e);return"function"!=typeof(null==i?void 0:i.chartSpec)}isNoChartDataRenderNothing(t,e){let i=this.getBody(t,e);return(null==i?void 0:i.define).noDataRenderNothing}getChartSpec(t,e){return this.getRawChartSpec(t,e)}getRawChartSpec(t,e){let i=this.getBody(t,e),r=null==i?void 0:i.chartSpec;return"function"==typeof r?r({col:t,row:e,dataValue:this._table.getCellOriginValue(t,e)||"",value:this._table.getCellValue(t,e)||"",rect:this._table.getCellRangeRelativeRect(this._table.getCellRange(t,e)),table:this._table}):r}getChartDataId(t,e){return(0,a.py)(t,e,this)}release(){let t=this._table._getActiveChartInstance();null==t||t.release(),this.columnObjects.forEach(t=>{var e;null==(e=t.chartInstance)||e.release()})}clearCellRangeMap(){this._cellRangeMap.clear()}updateColumnTitle(t,e,i){let r=this._table.internalProps.layoutMap.getHeader(t,e);r.title=i,r.define.title=i}getColumnByField(t){var e;return null==(e=this.columnObjects)?void 0:e.reduce((e,i,r)=>(i.field===t&&e.push({col:r,columnDefine:i}),e),[])}getColumnByKey(t){var e;let i;return{columnDefine:null==(e=this.columnObjects)?void 0:e.find((e,r)=>{var n;return(null==(n=e.define)?void 0:n.key)===t&&(i=r+this.leftRowSeriesNumberColumnCount,!0)}),col:i}}getColumnDefine(t,e){if(t>=0)return t<this.leftRowSeriesNumberColumnCount?this.leftRowSeriesNumberColumn[t].define:this.transpose?this._columns[e].define:this._columns[t-this.leftRowSeriesNumberColumnCount].define}}var u=i(95723),c=i(53172),p=i(13746),g=i(67331),f=i(30430),m=i(23269),y=i(58710),v=i(6254),b=i(6958),_=i(54396),C=i(39873),x=i(87474),w=i(31877),S=i(83624);function A(t,e){return(0,S.Z)(t)?{groupByRules:[t],addRecordRule:e}:(0,u.Z)(t)?{groupByRules:t.map(t=>(0,S.Z)(t)?t:t.key),addRecordRule:e}:{addRecordRule:e}}var M=i(53681),T=i(39909),k=i(23975),R=i(4654);function P(t){let e=t.sortState;(e=!e||Array.isArray(e)?e:[e])&&(e=e.map(e=>{var i;return e.orderFn=null!=(i=t._getSortFuncFromHeaderOption(void 0,e.field))?i:b.K$,e}),t.dataSource.sort(e))}function B(t,e,i){let{checkedState:r}=t.stateManager;if(r)if("tree"===t.dataSource.rowHierarchyType){let t,n=(t=(0,R.Z)(e)?[e]:e).length,l=[];r.forEach((e,r)=>{var s;let a=r.split(",");if(a.length>=t.length)for(let o=0;o<a.length;o++){let h=null!=(s=t[o])?s:-1,d=Number(a[o]);if(!(h===d&&o<a.length-1)){if(h===d&&o===a.length-1||-1===h){l.push({originKey:r,value:e});break}h<d&&o===n-1&&(a[o]=(d-i).toString(),l.push({originKey:r,targetKey:a.toString(),value:e}));break}}}),l.sort((t,e)=>{let i=t.originKey.split(","),r=e.originKey.split(","),n=i.length,l=r.length,s=Math.min(n,l);for(let t=0;t<s;t++){let e=Number(i[t]),n=Number(r[t]);if(e!==n)return e-n}return n-l}),l.forEach(({originKey:t,targetKey:e,value:i})=>{r.delete(t),e&&r.set(e,i)})}else{let t=[],n=[];r.forEach((r,l)=>{let s=Number(l);!isNaN(s)&&s>=e&&(s===e?t.push(l):s>e&&n.push({originKey:l,targetKey:(s-i).toString(),value:r}))}),t.forEach(t=>r.delete(t)),n.forEach(({originKey:t,targetKey:e,value:i})=>{r.delete(t),r.set(e,i)})}}function I(t,e,i){let{checkedState:r}=t.stateManager;if(r)if("tree"===t.dataSource.rowHierarchyType){let t,n=(t=(0,R.Z)(e)?[e]:e).length,l=[];r.forEach((e,r)=>{var s;let a=r.split(",");if(a.length>=t.length)for(let o=0;o<a.length;o++){let h=null!=(s=t[o])?s:-1,d=Number(a[o]);if(h===d&&(o===a.length-1||o===n-1)){a[o]=(d+i).toString(),l.push({originKey:r,targetKey:a.toString(),value:e});break}if(!(h===d&&o<a.length-1)){h<d&&o===n-1&&(a[o]=(d+i).toString(),l.push({originKey:r,targetKey:a.toString(),value:e}));break}}}),l.sort((t,e)=>{let i=t.originKey.split(","),r=e.originKey.split(","),n=i.length,l=r.length,s=Math.min(n,l);for(let t=0;t<s;t++){let e=Number(i[t]),n=Number(r[t]);if(e!==n)return-e+n}return-n+l}),l.forEach(({originKey:t,targetKey:e,value:i})=>{r.delete(t),e&&r.set(e,i)})}else for(let t=r.size-1;t>=e;t--){let e=r.get(t.toString());r.delete(t.toString()),r.set((t+i).toString(),e)}}var E=i(8347),L=i(17590),F=i(92158);class O extends p.D{constructor(t,e){var i,r,n,s,a,o,h,d;super(t,e),this.showHeader=!0,e=this.options;let u=this.internalProps;if(u.frozenColDragHeaderMode=null!=(r=null==(i=e.dragOrder)?void 0:i.frozenColDragHeaderMode)?r:e.frozenColDragHeaderMode,this.pagination=e.pagination,u.sortState=e.sortState,u.multipleSort=!!e.multipleSort,u.dataConfig=this.internalProps.groupBy?A(this.internalProps.groupBy,e.addRecordRule):{addRecordRule:e.addRecordRule},u.columns=e.columns?(0,C.u)(e.columns,["children"]):e.header?(0,C.u)(e.header,["children"]):[],(0,c.rQ)(this),u.enableTreeNodeMerge=null!=(s=null!=(n=e.enableTreeNodeMerge)?n:(0,l.Z)(this.internalProps.groupBy))&&s,this.internalProps.headerHelper.setTableColumnsEditor(),this.showHeader=null==(a=e.showHeader)||a,this.internalProps.columnWidthConfig=e.columnWidthConfig,this.internalProps.rowHeightConfig=e.rowHeightConfig,this.transpose=null!=(o=e.transpose)&&o,"node"!==f.X.mode&&(this.editorManager=new y.$(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,e.dataSource?this.dataSource=e.dataSource:e.records?this.setRecords(e.records,{sortState:u.sortState}):this.setRecords([]),e.title&&(u.title=new(w.F.getComponent("title"))(e.title,this)),this.options.emptyTip)if(this.internalProps.emptyTip)null==(h=this.internalProps.emptyTip)||h.resetVisible();else{let t=w.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(d=this.internalProps.emptyTip)||d.resetVisible()}if(this.internalProps.enableTreeStickCell){let t=w.F.getComponent("listTreeStickCellPlugin");this.listTreeStickCellPlugin=new t(this)}setTimeout(()=>{this.isReleased||(this.resize(),this.fireListeners(g.B.INITIALIZED,null))},0)}isListTable(){return!0}isPivotTable(){return!1}isPivotChart(){return!1}get sortState(){return this.internalProps.sortState}get records(){var t;return null==(t=this.dataSource)?void 0:t.records}get recordsCount(){return this.dataSource.records.length}updateColumns(t,e={clearColWidthCache:!1,clearRowHeightCache:!0}){var i,r,n,l;this.scenegraph.clearCells();let s={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.columns=(0,C.u)(t,["children"]),(0,c.rQ)(this),(null==e?void 0:e.clearColWidthCache)&&this.internalProps._widthResizedColMap.clear(),this.options.columns=t,this.internalProps.headerHelper.setTableColumnsEditor(),this._hasAutoImageColumn=void 0,this.refreshHeader(),null==(r=(i=this.dataSource).updateColumns)||r.call(i,this.internalProps.columns),this.records&&(0,c.bW)(this.internalProps.columns)&&this.dataSource.processRecords(null!=(l=null==(n=this.dataSource.dataSourceObj)?void 0:n.records)?l:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(!(null==e?void 0:e.clearRowHeightCache)),this.stateManager.updateHoverPos(s.col,s.row),this.renderAsync(),this.eventManager.updateEventBinder()}_recreateSceneForStateChange(){var t,e;this.scenegraph.clearCells();let i={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this._hasAutoImageColumn=void 0,this.refreshHeader(),this.records&&(0,c.bW)(this.internalProps.columns)&&this.dataSource.processRecords(null!=(e=null==(t=this.dataSource.dataSourceObj)?void 0:t.records)?e:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this._updateSize(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(i.col,i.row),this.renderAsync(),this.eventManager.updateEventBinder()}addColumns(t,e,i=!0){var r;let n=this.options.columns;void 0===e?(e=n.length,n.push(...t)):n.splice(e,0,...t);for(let i=0;i<t.length;i++)this.colWidthsMap.addAndReorder(e+i,null!=(r=t[i].width)?r:this.internalProps.defaultColWidth);this.internalProps._colRangeWidthsMap.clear();let l=Array.from(this.internalProps._widthResizedColMap.keys());for(let i=0;i<l.length;i++)l[i]>=e&&(this.internalProps._widthResizedColMap.delete(l[i]),this.internalProps._widthResizedColMap.add(l[i]+t.length));if(i){for(let t=0;t<n.length;t++)n[t].field=t;for(let i=0;i<this.records.length;i++){let r=this.records[i];Array.isArray(r)&&r.splice(e,0,...Array(t.length).fill(void 0))}}this.updateColumns(n,{clearRowHeightCache:!1}),this.fireListeners(g.B.ADD_COLUMN,{columnIndex:e,columnCount:t.length,columns:n})}deleteColumns(t,e=!0){let i=this.options.columns;t.sort((t,e)=>e-t);for(let r=0;r<t.length;r++)if(i.splice(t[r],1),this.colWidthsMap.delAndReorder(t[r]),this.internalProps._widthResizedColMap.delete(t[r]),e)for(let e=0;e<this.records.length;e++){let i=this.records[e];Array.isArray(i)&&i.splice(t[r],1)}this.internalProps._colRangeWidthsMap.clear();let r=Array.from(this.internalProps._widthResizedColMap.keys());for(let e=0;e<r.length;e++)for(let i=0;i<t.length;i++)if(r[e]>t[i]){this.internalProps._widthResizedColMap.delete(r[e]),this.internalProps._widthResizedColMap.add(r[e]-(t.length-i));break}if(e)for(let t=0;t<i.length;t++)i[t].field=t;this.updateColumns(i,{clearRowHeightCache:!1}),this.fireListeners(g.B.DELETE_COLUMN,{deleteColIndexs:t,columns:i})}get columns(){return this.internalProps.layoutMap.columnTree.getCopiedTree()}get header(){return this.internalProps.columns}set header(t){this.internalProps.columns=t,(0,c.rQ)(this),this.options.header=t,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.renderAsync()}get transpose(){var t;return null!=(t=this.internalProps.transpose)&&t}set transpose(t){this.internalProps.transpose!==t&&(this.internalProps.transpose=t,this.internalProps.layoutMap&&(this.internalProps.layoutMap.transpose=t,this.refreshRowColCount(),this._resetFrozenColCount(),this.renderAsync()))}getCellValue(t,e,i){var r;if(-1===t||-1===e)return null;if(!i){let i=this.getCustomMergeValue(t,e);if(i)return i}if(this.internalProps.layoutMap.isSeriesNumber(t,e)){let i;if(this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getSeriesNumberHeader(t,e);return i}if(this.internalProps.groupBy){let r=this.getCellRawRecord(t,e);if(null==r?void 0:r.vtableMerge)return"";this.internalProps.layoutMap.isAggregation(t,e)||(i=this.dataSource.getGroupSeriesNumber(e-this.columnHeaderLevelCount))}else{let n=this.getBodyColumnDefine(t,e),l=this.getFieldData(n.field,t,e);i=["number","string"].includes(typeof l)?l:(null==l?void 0:l.text)?null!=(r=l.text)?r:"":e-this.columnHeaderLevelCount+1}let{format:n}=this.internalProps.layoutMap.getSeriesNumberBody(t,e);return"function"==typeof n?n(t,e,this,i):i}if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}if(this.internalProps.layoutMap.isAggregation(t,e)){if(this.internalProps.layoutMap.isTopAggregation(t,e)){let i=this.internalProps.layoutMap.getAggregatorOnTop(t,e);return(null==i?void 0:i.formatValue)?i.formatValue(t,e,this):""}if(this.internalProps.layoutMap.isBottomAggregation(t,e)){let i=this.internalProps.layoutMap.getAggregatorOnBottom(t,e);return(null==i?void 0:i.formatValue)?i.formatValue(t,e,this):""}}let{field:n,fieldFormat:l}=this.internalProps.layoutMap.getBody(t,e);return this.getFieldData(l||n,t,e)}getCellOriginValue(t,e){if(-1===t||-1===e)return null;if(this.internalProps.layoutMap.isSeriesNumber(t,e)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getSeriesNumberHeader(t,e);return i}let{format:i}=this.internalProps.layoutMap.getSeriesNumberBody(t,e);return"function"==typeof i?i(t,e,this):e-this.columnHeaderLevelCount}if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}if(this.internalProps.layoutMap.isAggregation(t,e)){if(this.internalProps.layoutMap.isTopAggregation(t,e)){let i=this.internalProps.layoutMap.getAggregatorOnTop(t,e);return null==i?void 0:i.value()}if(this.internalProps.layoutMap.isBottomAggregation(t,e)){let i=this.internalProps.layoutMap.getAggregatorOnBottom(t,e);return null==i?void 0:i.value()}}let{field:i}=this.internalProps.layoutMap.getBody(t,e);return this.getFieldData(i,t,e)}getCellRawValue(t,e){if(-1===t||-1===e)return null;if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}let{field:i}=this.internalProps.layoutMap.getBody(t,e);return this.getRawFieldData(i,t,e)}getRecordShowIndexByCell(t,e){let{layoutMap:i}=this.internalProps;return i.getRecordShowIndexByCell(t,e)}getRecordIndexByCell(t,e){let{layoutMap:i}=this.internalProps,r=i.getRecordShowIndexByCell(t,e);return this.dataSource.getRecordIndexPaths(r)}getTableIndexByRecordIndex(t){return this.transpose?this.dataSource.getTableIndex(t)+this.rowHeaderLevelCount:this.dataSource.getTableIndex(t)+this.columnHeaderLevelCount}getTableIndexByField(t){let e=this.internalProps.layoutMap.columnObjects.find(e=>e.field===t);if(!e)return -1;let i=this.internalProps.layoutMap.getBodyLayoutRangeById(e.id);return this.transpose?i.start.row:i.start.col}getCellAddrByFieldRecord(t,e){return this.transpose?{col:this.getTableIndexByRecordIndex(e),row:this.getTableIndexByField(t)}:{col:this.getTableIndexByField(t),row:this.getTableIndexByRecordIndex(e)}}getCellOriginRecord(t,e){let i=this.getRecordShowIndexByCell(t,e);if(i>-1)return this.dataSource.get(i)}getCellRawRecord(t,e){let i=this.getRecordShowIndexByCell(t,e);if(i>-1)return this.dataSource.getRaw(i)}_canResizeColumn(t,e){let i=super._canResizeColumn(t,e);if(i&&!this.transpose){let i=this.internalProps.layoutMap.getBody(t,this.columnHeaderLevelCount),r=this.internalProps.layoutMap.isSeriesNumber(t,e);if((null==i?void 0:i.disableColumnResize)||r&&!0===this.internalProps.rowSeriesNumber.disableColumnResize)return!1}return i}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,n,s,a,o,h,d,u;let p=this.internalProps;if(this.pluginManager.removeOrAddPlugins(t.plugins),super.updateOption(t,e),p.frozenColDragHeaderMode=null!=(r=null==(i=t.dragOrder)?void 0:i.frozenColDragHeaderMode)?r:t.frozenColDragHeaderMode,this.pagination=t.pagination,p.sortState=t.sortState,p.dataConfig=this.internalProps.groupBy?A(this.internalProps.groupBy,t.addRecordRule):{addRecordRule:t.addRecordRule},this.showHeader=null==(n=t.showHeader)||n,p.columns=t.columns?(0,C.u)(t.columns,["children"]):t.header?(0,C.u)(t.header,["children"]):[],(0,c.rQ)(this),p.enableTreeNodeMerge=null!=(a=null!=(s=t.enableTreeNodeMerge)?s:(0,l.Z)(this.internalProps.groupBy))&&a,this.internalProps.headerHelper.setTableColumnsEditor(),this.transpose=null!=(o=t.transpose)&&o,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.internalProps.columnWidthConfig=t.columnWidthConfig,this.internalProps.rowHeightConfig=t.rowHeightConfig,p.releaseList)for(let t=p.releaseList.length-1;t>=0;t--){let e=p.releaseList[t];e instanceof M.o2?e.updateColumns(this.internalProps.columns):(null==(h=null==e?void 0:e.release)||h.call(e),p.releaseList.splice(t,1))}if(t.dataSource&&this.dataSource!==t.dataSource?this.dataSource=t.dataSource:t.records?this.setRecords(t.records,{sortState:t.sortState}):(this.refreshRowColCount(),this._resetFrozenColCount(),this.scenegraph.createSceneGraph(),this.render()),t.title&&(p.title=new(w.F.getComponent("title"))(t.title,this),this.scenegraph.resize()),this.options.emptyTip)if(this.internalProps.emptyTip)null==(d=this.internalProps.emptyTip)||d.resetVisible();else{let t=w.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(u=this.internalProps.emptyTip)||u.resetVisible()}return this.pluginManager.updatePlugins(t.plugins),setTimeout(()=>{this.fireListeners(g.B.UPDATED,null)},0),new Promise(t=>{setTimeout(t,0)})}updatePagination(t){this.pagination&&("number"==typeof t.currentPage&&t.currentPage>=0&&(this.pagination.currentPage=t.currentPage),t.perPageCount&&(this.pagination.perPageCount=t.perPageCount||this.pagination.perPageCount),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.dataSource.updatePagination(this.pagination),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.renderAsync())}refreshHeader(){var t;let e=this.internalProps,i=this.transpose,r=this.showHeader;(e.layoutMap=new d(this,null!=(t=e.columns)?t:[],r,this.options.hierarchyIndent)).transpose=i,i||this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y;let{layoutMap:v}=this.internalProps;if(!v)return;let b=null!=(e=null==(t=this.internalProps.dataSource)?void 0:t.length)?e:0;v.recordsCount=b+(b>0||this.options.showAggregationWhenEmpty?v.hasAggregationOnTopCount+v.hasAggregationOnBottomCount:0),this.transpose?(this.rowCount=null!=(i=v.rowCount)?i:0,this.colCount=null!=(r=v.colCount)?r:0,this.internalProps.frozenColCount=Math.max((null!=(n=v.headerLevelCount)?n:0)+v.leftRowSeriesNumberColumnCount,null!=(l=this.options.frozenColCount)?l:0),this.internalProps.frozenRowCount=null!=(s=this.options.frozenRowCount)?s:0,this.bottomFrozenRowCount!==(null!=(a=this.options.bottomFrozenRowCount)?a:0)&&(this.bottomFrozenRowCount=null!=(o=this.options.bottomFrozenRowCount)?o:0),this.rightFrozenColCount!==(null!=(h=this.options.rightFrozenColCount)?h:0)&&(this.rightFrozenColCount=null!=(d=this.options.rightFrozenColCount)?d:0)):(this.colCount=null!=(u=v.colCount)?u:0,this.rowCount=v.recordsCount*v.bodyRowSpanCount+v.headerLevelCount,this.internalProps.frozenColCount=null!=(c=this.options.frozenColCount)?c:0,this.options.frozenColCount>=this.colCount&&(this.internalProps.frozenColCount=0),this._setFrozenRowCount(Math.max(v.headerLevelCount,null!=(p=this.options.frozenRowCount)?p:0)),this.bottomFrozenRowCount!==(null!=(g=this.options.bottomFrozenRowCount)?g:0)&&(this.bottomFrozenRowCount=null!=(f=this.options.bottomFrozenRowCount)?f:0),this.rightFrozenColCount!==(null!=(m=this.options.rightFrozenColCount)?m:0)&&(this.rightFrozenColCount=null!=(y=this.options.rightFrozenColCount)?y:0)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}getFieldData(t,e,i){if(null===t||this.internalProps.layoutMap.isHeader(e,i))return null;let r=this.getRecordShowIndexByCell(this.transpose?e-this.internalProps.layoutMap.leftRowSeriesNumberColumnCount:e,i);return this.internalProps.dataSource.getField(r,t,e,i,this)}getRawFieldData(t,e,i){if(null===t||this.internalProps.layoutMap.isHeader(e,i))return null;let r=this.getRecordShowIndexByCell(e,i);return this.internalProps.dataSource.getRawField(r,t,e,i,this)}_moveHeaderPosition(t,e){let i=this.getCellRange(t.col,t.row),r=this.getCellRange(e.col,e.row),n=this.internalProps.layoutMap.moveHeaderPosition(t,e);return n?("column"===n.moveType?(this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,r.start.col,r.end.col-r.start.col+1,n.targetIndex),(0,F.ct)(n,this),this.transpose||(this.colWidthsLimit={},this.setMinMaxLimitWidth())):(n.targetIndex>n.sourceIndex?this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex+n.sourceSize-n.targetSize,n.targetSize,n.targetIndex):this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex,n.targetSize,n.targetIndex),(0,F.J7)(n,this)),n):null}changeRecordOrder(t,e){this.transpose?(t=this.getRecordShowIndexByCell(t,0),e=this.getRecordShowIndexByCell(e,0)):(t=this.getRecordShowIndexByCell(0,t),e=this.getRecordShowIndexByCell(0,e)),this.dataSource.changeOrder(t,e)}getCellAddress(t,e){let i;for(let e=0;e<this.internalProps.records.length;e++){let r=this.internalProps.records[e];if("function"==typeof t)t(r)&&(i=e);else{let n=!0;for(let e in t)if(r[e]!==t[e]){n=!1;break}n&&(i=e)}if((0,l.Z)(i))break}let r=this.getCellRangeByField(e,i);if(r)return{row:r.start.row,col:r.start.col}}getCellRangeByField(t,e){let{layoutMap:i}=this.internalProps,r=i.columnObjects.find(e=>e.field===t);if(r){let t,n=i.getBodyLayoutRangeById(r.id);return(0,l.Z)(e)&&(t=i.getRecordStartRowByRecordIndex(e)),this.transpose?{start:{row:n.start.row,col:(0,l.Z)(t)?t+n.start.col:void 0},end:{row:n.end.row,col:(0,l.Z)(t)?t+n.end.col:void 0}}:{start:{col:n.start.col,row:(0,l.Z)(t)?t+n.start.row:void 0},end:{col:n.end.col,row:(0,l.Z)(t)?t+n.end.row:void 0}}}return null}getHierarchyState(t,e){var i;if(this.isHeader(t,e))return null==(i=this._getHeaderLayoutMap(t,e))?void 0:i.hierarchyState;if((!this.internalProps.groupBy||(0,u.Z)(this.internalProps.groupBy)&&0===this.internalProps.groupBy.length)&&!this.getBodyColumnDefine(t,e).tree)return r.g.none;let n=this.getRecordShowIndexByCell(t,e);return this.dataSource.getHierarchyState(n)}getRecordHierarchyState(t,e){let i;return this.transpose?this.getRecordShowIndexByCell(t,0):i=this.getRecordShowIndexByCell(0,e),this.dataSource.getHierarchyState(i)}toggleHierarchyState(t,e,i=!0){this.stateManager.updateHoverIcon(t,e,void 0,void 0);let n=this.getHierarchyState(t,e);if(this.isHeader(t,e)){let i=this.internalProps.layoutMap.getHeader(t,e),{hierarchyState:l,define:s}=i;if(![r.g.collapse,r.g.expand].includes(l)||!s)return;let a=s.columns;if(Array.isArray(a)&&a.length>0){let t=l===r.g.expand?r.g.collapse:r.g.expand;i.hierarchyState=t,i.define.hierarchyState=t,this.updateColumns(this.internalProps.columns)}this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:n,originData:i,cellLocation:this.getCellLocation(t,e)})}else if(n===r.g.expand)this._refreshHierarchyState(t,e,i),this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:r.g.collapse});else if(n===r.g.collapse){let n=this.getCellOriginRecord(t,e);Array.isArray(n.children)&&this._refreshHierarchyState(t,e,i),this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:r.g.expand,originData:n})}}setLoadingHierarchyState(t,e){this.scenegraph.setLoadingHierarchyState(t,e)}_refreshHierarchyState(t,e,i=!0){var r,n;let l=!1,s=!1,a=this.internalProps.layoutMap.checkHasChart();a&&(this.autoFillWidth&&(l=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(s=this.getAllRowsHeight()<=this.tableNoFrameHeight));let o=this.getRecordShowIndexByCell(t,e),h=this.dataSource.toggleHierarchyState(o,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount,Math.max(this.scenegraph.proxy.rowEnd-this.columnHeaderLevelCount,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount+this.scenegraph.proxy.rowLimit-1)),d=this.internalProps.layoutMap.toggleHierarchyState(h);this.refreshRowColCount();for(let t=this.rowCount-this.bottomFrozenRowCount;t<this.rowCount;t++){let e=(0,v.P)(t,0,this.colCount-1,this);this._setRowHeight(t,e)}this.clearCellStyleCache(),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1;let{updateCells:u,addCells:c,removeCells:p}=function(t,e,i,r){let n=[{col:e,row:i}],l=[],s=[],{addCellPositions:a,removeCellPositions:o}=t,h=r.scenegraph.proxy,{rowStart:d,rowLimit:u}=h,{rowEnd:c}=h,p=1/0;for(let t=0;t<a.length;t++){let{row:i}=a[t];c-d+1===u?i>=d&&i<=c&&(p=Math.min(p,i)):(l.push({col:e,row:i}),c++)}let g=Math.min(d+u,r.rowCount-1-r.bottomFrozenRowCount),f=g<d+u;for(let t=0;t<o.length;t++){let{row:i}=o[o.length-t-1];i<d||i>c||(i>g||f?(s.push({col:e,row:i}),p--):p=Math.min(p,i))}if(p!==1/0)for(let t=p;t<=c;t++)n.push({col:e,row:t});return r.scenegraph.proxy.refreshRowCount(),{updateCells:n,addCells:l,removeCells:s}}(d,t,e,this);null==(r=this.reactCustomLayout)||r.clearCache(),this.scenegraph.updateRow(p,c,u,i,!0),null==(n=this.reactCustomLayout)||n.updateAllCustomCell(),a&&(this.autoFillWidth&&!l&&(l=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!s&&(s=this.getAllRowsHeight()<=this.tableNoFrameHeight),("adaptive"===this.widthMode||l||"adaptive"===this.heightMode||s)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}_hasHierarchyTreeHeader(){var t,e;return null==(e=null!=(t=this.options.columns)?t:this.options.header)?void 0:e.some((t,e)=>t.tree)}getMenuInfo(t,e,i){return{field:this.getHeaderField(t,e),value:this.getCellValue(t,e),cellLocation:this.getCellLocation(t,e),event:void 0}}_getSortFuncFromHeaderOption(t,e,i){if(t||(t=this.internalProps.columns),e&&t&&t.length>0)for(let r=0;r<t.length;r++){let n=t[r];if((i&&i===n.fieldKey||!i&&n.field===e)&&n.sort&&"function"==typeof n.sort)return n.sort;if(n.columns){let t=this._getSortFuncFromHeaderOption(n.columns,e,i);if(t)return t}}}updateSortState(t,e=!0){var i;if(t)this.internalProps.sortState=t;else if(this.internalProps.sortState)if(Array.isArray(this.internalProps.sortState))for(let e=0;e<this.internalProps.sortState.length;e++)(t=null==(i=this.internalProps.sortState)?void 0:i[e])&&(t.order="normal");else this.internalProps.sortState.order="normal",t=this.internalProps.sortState;(t=Array.isArray(t)?t:[t]).some(t=>t.field)&&e&&this.internalProps.layoutMap.headerObjects.some(t=>!1!==t.define.sort)&&(this.dataSource.sort(t.map(t=>{let e=this._getSortFuncFromHeaderOption(this.internalProps.columns,t.field);return this.internalProps.layoutMap.headerObjects.find(e=>e&&e.field===t.field),{field:t.field,order:t.order,orderFn:null!=e?e:b.K$}})),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.sortCell()),t.length&&this.stateManager.updateSortState(t)}updateFilterRules(t,e={clearRowHeightCache:!0}){var i;this.scenegraph.clearCells(),this.sortState?(this.dataSource.updateFilterRulesForSorted(t),P(this)):this.dataSource.updateFilterRules(t,null==e?void 0:e.onFilterRecordsEnd),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(!(null==e?void 0:e.clearRowHeightCache)),null==(i=this.internalProps.emptyTip)||i.resetVisible(),this.resize()}getFilteredRecords(){return this.dataSource.records}getCheckboxState(t){if(this.stateManager.checkedState.size<this.rowCount-this.columnHeaderLevelCount&&this.stateManager.initLeftRecordsCheckState(this.records),(0,l.Z)(t)){let e=Array.from(this.stateManager.checkedState.keys()).sort((t,e)=>{var i,r;let n=t.split(","),l=e.split(","),s=Math.max(n.length,l.length);for(let t=0;t<s;t++){let e=null!=(i=Number(n[t]))?i:0,s=null!=(r=Number(l[t]))?r:0;if(e!==s)return e-s}return 0}).map(t=>this.stateManager.checkedState.get(t));return this.options.groupBy&&(e=(0,x.aC)(this)),Array.from(e,e=>e&&e[t])}return[...this.stateManager.checkedState.values()]}getCellCheckboxState(t,e){var i;let r=this.getBodyColumnDefine(t,e),n=null==r?void 0:r.field,s=this.getCellType(t,e);if((0,l.Z)(n)&&("checkbox"===s||"switch"===s)){let r=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)).toString();return null==(i=this.stateManager.checkedState.get(r))?void 0:i[n]}}getRadioState(t){return(0,l.Z)(t)?this.stateManager.radioState[t]:this.stateManager.radioState}getCellRadioState(t,e){return(0,_.Wg)(t,e,this)}setCellCheckboxState(t,e,i){(0,x.Jd)(t,e,i,this)}setCellRadioState(t,e,i){(0,_.vj)(t,e,i,this)}getSwitchState(t){return this.getCheckboxState(t)}getCellSwitchState(t,e){return this.getCellCheckboxState(t,e)}setCellSwitchState(t,e,i){this.setCellCheckboxState(t,e,i)}setRecords(t,e){var i,r,n,s;let a;(0,E.H6)(),null==(i=this.internalProps.dataSource)||i.release(),this.internalProps.releaseList=null==(r=this.internalProps.releaseList)?void 0:r.filter(t=>!t.dataSourceObj),this.internalProps.dataSource=null,Array.isArray(e)||(null==e?void 0:e.order)?a=e:e?a=e.sortState:null===e&&(a=null),"undefined"!=typeof window&&window.performance.now();let o={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};if(this.scenegraph.clearCells(),void 0!==a&&(null===a||!Array.isArray(a)&&(0,l.Z)(a.field)||Array.isArray(a))&&(this.internalProps.sortState=this.internalProps.multipleSort?Array.isArray(a)?a:[a]:a,this.stateManager.setSortState(this.sortState)),t){if((0,c.mP)(this,t),this.sortState){let t=Array.isArray(this.sortState)?this.sortState:[this.sortState];t.some(t=>t.order&&t.field&&"normal"!==t.order)&&this.internalProps.layoutMap.headerObjectsIncludeHided.some(t=>!1!==t.define.sort)&&this.dataSource.sort(t.map(t=>{let e=this._getSortFuncFromHeaderOption(void 0,t.field);return this.internalProps.layoutMap.headerObjectsIncludeHided.find(e=>e&&e.field===t.field),{field:t.field,order:t.order||"asc",orderFn:null!=e?e:b.K$}}))}this.refreshRowColCount()}else(0,c.mP)(this,t);if(this.stateManager.initCheckedState(t),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(o.col,o.row),this._updateSize(),this.internalProps.title&&!this.internalProps.title.isReleased&&this.internalProps.title.resize(),this.scenegraph.resize(),this.options.emptyTip)if(this.internalProps.emptyTip)null==(n=this.internalProps.emptyTip)||n.resetVisible();else{let t=w.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(s=this.internalProps.emptyTip)||s.resetVisible()}this.render(),(0,l.Z)(o.col)&&(0,l.Z)(o.row)&&o.col>=0&&o.row>=0&&setTimeout(()=>{var t;null==(t=this.internalProps)||t.tooltipHandler.showTooltip(o.col,o.row)},0)}setRecordChildren(t,e,i,r=!0){let n=this.getCellOriginRecord(e,i);n.children=t;let l=this.getRecordShowIndexByCell(e,i);this.dataSource.setRecord(n,l),this._refreshHierarchyState(e,i,r)}startEditCell(t,e,i){var r;if((0,l.Z)(t)&&(0,l.Z)(e))this.eventManager.isDraging=!1,this.selectCell(t,e),this.editorManager.startEditCell(t,e,i);else if(null==(r=this.stateManager.select)?void 0:r.cellPos){let{col:t,row:e}=this.stateManager.select.cellPos;(0,l.Z)(t)&&(0,l.Z)(e)&&this.editorManager.startEditCell(t,e,i)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(t,e){var i,r;let n=this.editorManager.cacheLastSelectedCellEditor[`${t}-${e}`];if(n)return n;Object.values(this.editorManager.cacheLastSelectedCellEditor).forEach(t=>{var e;return null==(e=null==t?void 0:t.onEnd)?void 0:e.call(t)}),this.editorManager.cacheLastSelectedCellEditor={};let l=this.getBodyColumnDefine(t,e),s=this.isHeader(t,e)?null!=(i=null==l?void 0:l.headerEditor)?i:this.options.headerEditor:null!=(r=null==l?void 0:l.editor)?r:this.options.editor;return"function"==typeof s&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),"string"==typeof s&&(s=m.U(s)),s&&(this.editorManager.cacheLastSelectedCellEditor[`${t}-${e}`]=s),s}isHasEditorDefine(t,e){var i,r;let n=this.getBodyColumnDefine(t,e),s=this.isHeader(t,e)?null!=(i=null==n?void 0:n.headerEditor)?i:this.options.headerEditor:null!=(r=null==n?void 0:n.editor)?r:this.options.editor;return"function"==typeof s&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),(0,l.Z)(s)}changeCellValue(t,e,i,r=!1,n=!0){return function(t,e,i,r,n,l){if(r&&l.isHasEditorDefine(t,e)||!1===r){let r=l.getRecordShowIndexByCell(t,e),{field:s}=l.internalProps.layoutMap.getBody(t,e),a=l.getCellRawValue(t,e),o=l.getCellOriginValue(t,e);l.isHeader(t,e)?l.internalProps.layoutMap.updateColumnTitle(t,e,i):l.dataSource.changeFieldValue(i,r,s,t,e,l);let h=l.getCellRange(t,e),d=l.internalProps.layoutMap.getAggregatorsByCell(t,e);if(d){if(Array.isArray(d))for(let t=0;t<(null==d?void 0:d.length);t++)d[t].recalculate();else d.recalculate();let t=l.internalProps.layoutMap.getAggregatorCellAddress(h.start.col,h.start.row,h.end.col,h.end.row);for(let e=0;e<t.length;e++){let i=l.getCellRange(t[e].col,t[e].row);for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.row;e<=i.end.row;e++)l.scenegraph.updateCellContent(t,e)}}for(let t=h.start.col;t<=h.end.col;t++)for(let e=h.start.row;e<=h.end.row;e++)l.scenegraph.updateCellContent(t,e);if("adaptive"===l.widthMode||l.autoFillWidth&&l.getAllColsWidth()<=l.tableNoFrameWidth)0===l.internalProps._widthResizedColMap.size&&l.scenegraph.recalculateColWidths();else if(!l.internalProps._widthResizedColMap.has(t)){let e=l.getColWidth(t),i=(0,T.al)(t,0,l.rowCount-1,l,!1);i!==e&&l.scenegraph.updateColWidth(t,i-e)}if("adaptive"===l.heightMode||l.autoFillHeight&&l.getAllRowsHeight()<=l.tableNoFrameHeight)0===l.internalProps._heightResizedRowMap.size&&l.scenegraph.recalculateRowHeights();else if(l.isAutoRowHeight(e)&&!l.internalProps._heightResizedRowMap.has(e)){let t=l.getRowHeight(e),i=(0,v.P)(e,0,l.colCount-1,l);l.scenegraph.updateRowHeight(e,i-t)}let u=l.getCellOriginValue(t,e);o!==u&&n&&l.fireListeners(g.B.CHANGE_CELL_VALUE,{col:t,row:e,rawValue:a,currentValue:o,changedValue:u}),l.scenegraph.updateNextFrame()}}(t,e,i,r,n,this)}changeCellValues(t,e,i,r=!1,n=!0){return function(t,e,i,r,n,l){var s,a,o,h,d,u;return o=this,h=void 0,d=void 0,u=function*(){let o,h=[],d=t,u=e,c=[],p=[];for(let r=0;r<i.length&&!(e+r>l.rowCount-1);r++){let n=i[r],s=[],a=[];c.push(s),p.push(a);for(let i=0;i<n.length&&!(t+i>l.colCount-1);i++){o=function(t,e,i,r){if("group"===r||"sort"===r&&!i.internalProps.groupBy)return r;let n="normal";return i.internalProps.groupBy?n="group":!i.isHeader(t,e)&&i.dataSource.lastOrderField&&i.getBodyField(t,e)===i.dataSource.lastOrderField&&(n="sort"),n}(t+i,e+r,l,o);let n=l.getCellRawValue(t+i,e+r);s.push(n);let h=l.getCellOriginValue(t+i,e+r);a.push(h)}}for(let o=0;o<i.length&&!(e+o>l.rowCount-1);o++){h[o]=[],u=e+o;let f=i[o],m=t;for(let i=0;i<f.length&&!(t+i>l.colCount-1);i++){m=t+i;let d=!1;if(!1===r)d=!0;else if(l.isHasEditorDefine(t+i,e+o)){let r=l.getEditor(t+i,e+o),n=p[o][i],h=f[i],u=null==(a=null==(s=null==r?void 0:r.validateValue)?void 0:s.call(r,h,n,{col:t+i,row:e+o},l))||a;if((0,k.tI)(u)){let t=yield u;d=!0===t||"validate-exit"===t||"validate-not-exit"===t}else d=!0===u||"validate-exit"===u||"validate-not-exit"===u}if(d){h[o][i]=!0;let r=f[i],s=l.getRecordShowIndexByCell(t+i,e+o),{field:a}=l.internalProps.layoutMap.getBody(t+i,e+o),d=c[o][i],u=p[o][i];l.isHeader(t+i,e+o)?l.internalProps.layoutMap.updateColumnTitle(t+i,e+o,r):l.dataSource.changeFieldValue(r,s,a,t+i,e+o,l);let m=l.getCellOriginValue(t+i,e+o);u!==m&&n&&l.fireListeners(g.B.CHANGE_CELL_VALUE,{col:t+i,row:e+o,rawValue:d,currentValue:u,changedValue:m})}else h[o][i]=!1}d=Math.max(d,m)}let f=l.getCellRange(t,e),m=l.getCellRange(d,u),y=l.internalProps.layoutMap.getAggregatorsByCellRange(f.start.col,f.start.row,m.end.col,m.end.row);if(y){for(let t=0;t<(null==y?void 0:y.length);t++)y[t].recalculate();if("normal"===o){let t=l.internalProps.layoutMap.getAggregatorCellAddress(f.start.col,f.start.row,m.end.col,m.end.row);for(let e=0;e<t.length;e++){let i=l.getCellRange(t[e].col,t[e].row);for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.row;e<=i.end.row;e++)l.scenegraph.updateCellContent(t,e)}}}if("group"===o&&l.dataSource.updateRecordsForGroup([],[]),"sort"===o||"group"===o)return l.dataSource.sortedIndexMap.clear(),P(l),l.refreshRowColCount(),l.internalProps.layoutMap.clearCellRangeMap(),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph(),h;for(let t=f.start.col;t<=m.end.col;t++)for(let e=f.start.row;e<=m.end.row;e++)l.scenegraph.updateCellContent(t,e);if("adaptive"===l.widthMode||l.autoFillWidth&&l.getAllColsWidth()<=l.tableNoFrameWidth)0===l.internalProps._widthResizedColMap.size&&l.scenegraph.recalculateColWidths();else for(let e=t;e<=m.end.col;e++)if(!l.internalProps._widthResizedColMap.has(e)){let t=l.getColWidth(e),i=(0,T.al)(e,0,l.rowCount-1,l,!1);i!==t&&l.scenegraph.updateColWidth(e,i-t)}if("adaptive"===l.heightMode||l.autoFillHeight&&l.getAllRowsHeight()<=l.tableNoFrameHeight)l.scenegraph.recalculateRowHeights();else if(l.isAutoRowHeight(e)){let t=[],i=[];for(let r=e;r<=m.end.row;r++)if(l.rowHeightsMap.get(r)){let e=l.getRowHeight(r),n=(0,v.P)(r,0,l.colCount-1,l);t.push(r),i.push(n-e)}l.scenegraph.updateRowsHeight(t,i)}return l.scenegraph.updateNextFrame(),h},new(d||(d=Promise))(function(t,e){function i(t){try{n(u.next(t))}catch(t){e(t)}}function r(t){try{n(u.throw(t))}catch(t){e(t)}}function n(e){var n;e.done?t(e.value):((n=e.value)instanceof d?n:new d(function(t){t(n)})).then(i,r)}n((u=u.apply(o,h||[])).next())})}(t,e,i,r,n,this)}addRecord(t,e){var i;let r=function(t,e,i){var r,n,l,s;try{if(!t)return!1;if(i.internalProps.groupBy)null==(n=(r=i.dataSource).addRecordsForGroup)||n.call(r,[t],e),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&P(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if("tree"===i.dataSource.rowHierarchyType)null==(s=(l=i.dataSource).addRecordsForTree)||s.call(l,[t],e),I(i,e,1),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&P(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if(i.sortState)i.dataSource.addRecordForSorted(t),i.stateManager.checkedState.clear(),P(i),i.refreshRowColCount(),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{(void 0===e||e>i.dataSource.sourceLength)&&(e=i.dataSource.sourceLength);let r=i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount;i.dataSource.addRecord(t,e),I(i,e,1);let n=i.rowCount;if(i.refreshRowColCount(),0===i.scenegraph.proxy.totalActualBodyRowCount)return i.scenegraph.clearCells(),i.scenegraph.createSceneGraph(),!0;let l=i.transpose?i.colCount:i.rowCount;if(i.pagination){let{perPageCount:t,currentPage:s}=i.pagination,a=t*(s||0)+t;if(e<a)if(e<a-t)i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{let s=e-(a-t)+r;if(n-r===i.pagination.perPageCount){let t=[];for(let e=s;e<l;e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],[],t):i.scenegraph.updateRow([],[],t)}else{let t=[];for(let e=s;e<Math.min(l,s+1);e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],t,[]):i.scenegraph.updateRow([],t,[])}}}else{let t=[];for(let n=e+r;n<e+r+1;n++)i.transpose?t.push({col:n,row:0}):t.push({col:0,row:n});let n=[],l=i.internalProps.layoutMap.hasAggregationOnTopCount,s=i.internalProps.layoutMap.hasAggregationOnBottomCount;for(let t=r;t<r+l;t++)i.transpose?n.push({col:t,row:0}):n.push({col:0,row:t});for(let t=(i.transpose?i.colCount:i.rowCount)-s;t<(i.transpose?i.colCount:i.rowCount);t++)i.transpose?n.push({col:t,row:0}):n.push({col:0,row:t});i.transpose?i.scenegraph.updateCol([],t,[]):i.scenegraph.updateRow([],t,[])}}return!0}catch(t){return!1}}(t,e,this);(0,F.UF)(this,e,[t]),null==(i=this.internalProps.emptyTip)||i.resetVisible(),r&&this.fireListeners(g.B.ADD_RECORD,{records:[t],recordIndex:e,recordCount:1})}addRecords(t,e){var i;let r=function(t,e,i){var r,n,l,s;try{if(!t||0===t.length)return!1;if(i.internalProps.groupBy)null==(n=(r=i.dataSource).addRecordsForGroup)||n.call(r,t,e),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&P(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if("tree"===i.dataSource.rowHierarchyType)null==(s=(l=i.dataSource).addRecordsForTree)||s.call(l,t,e),I(i,e,t.length),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&P(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if(i.sortState)i.dataSource.addRecordsForSorted(t),P(i),i.refreshRowColCount(),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{void 0===e||e>i.dataSource.sourceLength?e=i.dataSource.sourceLength:e<0&&(e=0);let r=i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount;i.dataSource.addRecords(t,e),I(i,e,t.length);let n=i.transpose?i.colCount:i.rowCount;if(i.refreshRowColCount(),0===i.scenegraph.proxy.totalActualBodyRowCount)return i.scenegraph.clearCells(),i.scenegraph.createSceneGraph(),!0;let l=i.transpose?i.colCount:i.rowCount;if(i.pagination){let{perPageCount:s,currentPage:a}=i.pagination,o=s*(a||0)+s;if(e<o)if(e<o-s)i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{let a=e-(o-s)+r;if(n-r===i.pagination.perPageCount){let t=[];for(let e=a;e<l;e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],[],t):i.scenegraph.updateRow([],[],t)}else{let e=[];for(let r=a;r<Math.min(l,a+(Array.isArray(t)?t.length:1));r++)i.transpose?e.push({col:r,row:0}):e.push({col:0,row:r});i.transpose?i.scenegraph.updateCol([],e,[]):i.scenegraph.updateRow([],e,[])}}}else{let n=[];for(let l=e+r;l<e+r+(Array.isArray(t)?t.length:1);l++)i.transpose?n.push({col:l,row:0}):n.push({col:0,row:l});let l=i.internalProps.layoutMap.hasAggregationOnTopCount,s=i.internalProps.layoutMap.hasAggregationOnBottomCount,a=[];for(let t=r;t<r+l;t++)i.transpose?a.push({col:t,row:0}):a.push({col:0,row:t});for(let t=(i.transpose?i.colCount:i.rowCount)-s;t<(i.transpose?i.colCount:i.rowCount);t++)i.transpose?a.push({col:t,row:0}):a.push({col:0,row:t});i.transpose?i.scenegraph.updateCol([],n,a):i.scenegraph.updateRow([],n,a)}}return!0}catch(t){return!1}}(t,e,this);"number"==typeof e&&(0,F.UF)(this,e,t),null==(i=this.internalProps.emptyTip)||i.resetVisible(),r&&this.fireListeners(g.B.ADD_RECORD,{records:t,recordIndex:e,recordCount:t.length})}deleteRecords(t){var e;(function(t,e){var i,r,n,l,s,a,o,h;if((null==t?void 0:t.length)>0)if(e.internalProps.groupBy)null==(r=(i=e.dataSource).deleteRecordsForGroup)||r.call(i,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&P(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if("tree"===e.dataSource.rowHierarchyType){let i=null==(l=(n=e.dataSource).deleteRecordsForTree)?void 0:l.call(n,t);if(0===i.length)return;for(let t=0;t<i.length;t++)B(e,i[t],1);e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&P(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph()}else if(e.sortState)e.dataSource.deleteRecordsForSorted(t),P(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{let i=e.dataSource.deleteRecords(t);if(0===i.length)return;for(let t=0;t<i.length;t++)B(e,i[t],1);let r=e.transpose?e.colCount:e.rowCount;e.refreshRowColCount();let n=e.transpose?e.colCount:e.rowCount,l=i.sort((t,e)=>t-e),d=l[0];if(e.pagination){let{perPageCount:t,currentPage:i}=e.pagination,l=t*(i||0)+t;if(d<l)if(d<l-t)e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{let i=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,o=e.internalProps.layoutMap.hasAggregationOnTopCount,h=[],u=[];for(let i=d-(l-t)+(e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount)+o;i<n;i++)e.transpose?h.push({col:i,row:0}):h.push({col:0,row:i});for(let t=i;t<i+o;t++)e.transpose?h.push({col:t,row:0}):h.push({col:0,row:t});if(n<r)for(let t=n;t<r;t++)e.transpose?u.push({col:t,row:0}):u.push({col:0,row:t});null==(s=e.reactCustomLayout)||s.clearCache(),e.transpose?e.scenegraph.updateCol(u,[],h):e.scenegraph.updateRow(u,[],h),null==(a=e.reactCustomLayout)||a.updateAllCustomCell()}}else{let t=[],i=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,r=e.internalProps.layoutMap.hasAggregationOnTopCount,n=e.internalProps.layoutMap.hasAggregationOnBottomCount;for(let n=0;n<l.length;n++){let s=l[n]+i+r;e.transpose?t.push({col:s,row:0}):t.push({col:0,row:s})}let s=[];for(let t=i;t<i+r;t++)e.transpose?s.push({col:t,row:0}):s.push({col:0,row:t});for(let t=(e.transpose?e.colCount:e.rowCount)-n;t<(e.transpose?e.colCount:e.rowCount);t++)e.transpose?s.push({col:t,row:0}):s.push({col:0,row:t});null==(o=e.reactCustomLayout)||o.clearCache(),e.transpose?e.scenegraph.updateCol(t,[],s):e.scenegraph.updateRow(t,[],s),null==(h=e.reactCustomLayout)||h.updateAllCustomCell()}}})(t,this),(0,F.b)(this,t),null==(e=this.internalProps.emptyTip)||e.resetVisible();let i=[];for(let e=0;e<t.length;e++)i.push(this.getBodyRowIndexByRecordIndex(t[e])+this.columnHeaderLevelCount);this.fireListeners(g.B.DELETE_RECORD,{recordIndexs:t,rowIndexs:i,deletedCount:(Array.isArray(t[0]),t.length)})}updateRecords(t,e){(function(t,e,i){var r,n,l,s;if((null==e?void 0:e.length)>0)if(i.internalProps.groupBy)null==(n=(r=i.dataSource).updateRecordsForGroup)||n.call(r,t,e),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&P(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if("tree"===i.dataSource.rowHierarchyType)null==(s=(l=i.dataSource).updateRecordsForTree)||s.call(l,t,e),i.refreshRowColCount(),i.internalProps.layoutMap.clearCellRangeMap(),i.sortState&&P(i),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else if(i.sortState)i.dataSource.updateRecordsForSorted(t,e),P(i),i.refreshRowColCount(),i.scenegraph.clearCells(),i.scenegraph.createSceneGraph();else{let r=i.dataSource.updateRecords(t,e);if(0===r.length)return;let n=r.map(t=>i.getBodyRowIndexByRecordIndex(t)).sort((t,e)=>t-e);if(i.pagination){let{perPageCount:t,currentPage:e}=i.pagination,r=i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount,l=i.internalProps.layoutMap.hasAggregationOnTopCount,s=t*(e||0)+t,a=[];for(let e=0;e<n.length;e++){let r=n[e];if(r<s&&r>=s-t){let e=r-(s-t)+(i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount)+l;a.push(e)}}if(a.length>=1){let t=[];for(let e=0;e<a.length;e++){let r=a[e];i.transpose?t.push({col:r,row:0}):t.push({col:0,row:r})}for(let e=r;e<r+l;e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],[],t):i.scenegraph.updateRow([],[],t)}}else{let t=[],e=i.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount,r=i.internalProps.layoutMap.hasAggregationOnTopCount,l=i.internalProps.layoutMap.hasAggregationOnBottomCount;for(let l=0;l<n.length;l++){let s=n[l]+e+r;i.transpose?t.push({col:s,row:0}):t.push({col:0,row:s})}for(let n=e;n<e+r;n++)i.transpose?t.push({col:n,row:0}):t.push({col:0,row:n});for(let e=(i.transpose?i.colCount:i.rowCount)-l;e<(i.transpose?i.colCount:i.rowCount);e++)i.transpose?t.push({col:e,row:0}):t.push({col:0,row:e});i.transpose?i.scenegraph.updateCol([],[],t):i.scenegraph.updateRow([],[],t)}}})(t,e,this),this.fireListeners(g.B.UPDATE_RECORD,{records:t,recordIndexs:e,updateCount:t.length})}_hasCustomRenderOrLayout(){var t,e,i,r;let{headerObjects:n}=this.internalProps.layoutMap;if(this.options.customRender)return!0;for(let l=0;l<n.length;l++){let s=n[l];if((null==(t=null==s?void 0:s.define)?void 0:t.customLayout)||(null==(e=null==s?void 0:s.define)?void 0:e.headerCustomLayout)||(null==(i=null==s?void 0:s.define)?void 0:i.customRender)||(null==(r=null==s?void 0:s.define)?void 0:r.headerCustomRender))return!0}return!1}getAggregateValuesByField(t){let e=this.internalProps.layoutMap.getColumnByField(t),i=[];for(let t=0;t<e.length;t++){let r=e[t].columnDefine.aggregator;if(delete e[t].columnDefine,r){let n={col:e[t].col,aggregateValue:null};if(n.aggregateValue=[],Array.isArray(r))for(let t=0;t<r.length;t++)n.aggregateValue.push({aggregationType:r[t].type,value:r[t].value()});else n.aggregateValue.push({aggregationType:r.type,value:r.value()});i.push(n)}}return i}isAggregation(t,e){return this.internalProps.layoutMap.isAggregation(t,e)}getGroupTitleLevel(t,e){var i;if(!this.internalProps.groupBy)return;let r=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)),n=null!=(i=this.dataSource.getGroupLength())?i:0,l=(0,u.Z)(r)?r.length-1:0;return n>0&&l===n&&(l=void 0),l}getBodyRowIndexByRecordIndex(t){return Array.isArray(t)&&1===t.length&&(t=t[0]),this.dataSource.getTableIndex(t)}release(){var t;null==(t=this.editorManager)||t.release(),super.release()}expandAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let t=!1;this.dataSource&&"function"==typeof this.dataSource.expandAllNodes&&(this.dataSource.expandAllNodes(),t=!0),t&&(this._recreateSceneForStateChange(),this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:r.g.expand,originData:{children:this.records}}))}collapseAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let t=!1;this.dataSource&&"function"==typeof this.dataSource.collapseAllNodes&&(this.dataSource.collapseAllNodes(),t=!0),t&&(this._recreateSceneForStateChange(),this.fireListeners(g.B.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:r.g.collapse,originData:{children:this.records}}))}mergeCells(t,e,i,r){for(let n=t;n<=i;n++)for(let t=e;t<=r;t++){let e=this.getCellRange(n,t);if(e.start.col!==e.end.col||e.start.row!==e.end.row)return}this.options.customMergeCell?"function"==typeof this.options.customMergeCell&&(this.options.customMergeCell=[]):this.options.customMergeCell=[],this.options.customMergeCell.push({text:this.getCellValue(t,e),range:{start:{col:t,row:e},end:{col:i,row:r}}}),this.internalProps.customMergeCell=(0,L.k)(this.options.customMergeCell);for(let n=t;n<=i;n++)for(let t=e;t<=r;t++)this.scenegraph.updateCellContent(n,t);this.scenegraph.updateNextFrame()}unmergeCells(t,e,i,r){this.options.customMergeCell?"function"==typeof this.options.customMergeCell&&(this.options.customMergeCell=[]):this.options.customMergeCell=[],this.options.customMergeCell=this.options.customMergeCell.filter(n=>{let{start:l,end:s}=n.range;return l.col!==t||l.row!==e||s.col!==i||s.row!==r}),this.internalProps.customMergeCell=(0,L.k)(this.options.customMergeCell);for(let n=t;n<=i;n++)for(let t=e;t<=r;t++)this.scenegraph.updateCellContent(n,t);this.scenegraph.updateNextFrame()}}},88510:function(t,e,i){i.d(e,{z:()=>M});var r=i(47490),n=i(25987),l=i(11725),s=i(23975),a=i(91566),o=i(53172),h=i(13746),d=i(14305),u=i(65755),c=i(95723),p=i(4654),g=i(67331),f=i(39873),m=i(66023),y=i(77874),v=i(994),b=i(26595),_=i(31877),C=i(59779),x=i(77643),w=i(73508),S=i(8347),A=i(50542);(0,C.R2)(),(0,C.Eg)(),(0,C.I)(),(0,C.FD)(),(0,C._t)(),(0,C.Mh)(),(0,C.ph)(),(0,x.LQ)(),(0,x.yR)(),(0,x.pk)(),(0,x.m4)(),(0,x.Jy)(),(0,x.dB)(),(0,x.ge)(),(0,x.au)();class M extends h.D{constructor(t,e){var i,r,l,s,o,h,d,p,y,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F;let O,H;super(t,e),this.layoutNodeId={seqId:0},this._selectedDataItemsInChart=[],this._selectedDataMode="click",this._selectedDimensionInChart=[],this._chartEventMap={},this._throttleTimer=null,this._latestFilterRules=null,(e=this.options).layout&&Object.assign(e,e.layout),this.internalProps.columns=(0,u.Z)(e.columns),this.internalProps.rows=(0,u.Z)(e.rows),this.internalProps.indicators=(0,f.u)(e.indicators),this.internalProps.columnTree=!e.indicatorsAsCol||(null==(i=e.columns)?void 0:i.length)||e.columnTree?(0,u.Z)(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||(null==(r=e.rows)?void 0:r.length)||e.rowTree?(0,u.Z)(e.rowTree):[],this.internalProps.records=e.records,this.setCustomStateNameToSpec(),this.internalProps.columnResizeType=null!=(o=null!=(s=null==(l=e.resize)?void 0:l.columnResizeType)?s:e.columnResizeType)?o:"column",this.internalProps.rowResizeType=null!=(p=null!=(d=null==(h=e.resize)?void 0:h.rowResizeType)?d:e.rowResizeType)?p:"row",this.internalProps.dataConfig={isPivotChart:!0},this.internalProps.columnWidthConfig=e.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=e.columnWidthConfigForRowHeader,this._axes=(0,c.Z)(e.axes)?e.axes:[],e.columnTree&&(!1!==e.indicatorsAsCol&&(this.internalProps.columnTree=(0,b.VN)(this.internalProps.columnTree,e.indicators)),O=new m.KO(null!=(y=this.internalProps.columnTree)?y:[],this.layoutNodeId)),e.rowTree&&(!1===e.indicatorsAsCol&&(this.internalProps.rowTree=(0,b.VN)(this.internalProps.rowTree,e.indicators)),H=new m.KO(null!=(C=this.internalProps.rowTree)?C:[],this.layoutNodeId));let D=(null==(x=null==H?void 0:H.dimensionKeys)?void 0:x.count)?H.dimensionKeys.valueArr():null!=(S=null==(w=e.rows)?void 0:w.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?S:[],z=(null==(A=null==O?void 0:O.dimensionKeys)?void 0:A.count)?O.dimensionKeys.valueArr():null!=(T=null==(M=e.columns)?void 0:M.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?T:[],W=null!=(R=null==(k=e.indicators)?void 0:k.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.indicatorKey),t),[]))?R:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(z,D),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new a.q(this.internalProps.dataConfig,D,z,W,this.internalProps.indicators,null==(P=e.indicatorsAsCol)||P,e.records,void 0,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&(0,v.eW)(this.internalProps.indicators)){let t=e=>{e.forEach(e=>{var i;(null==(i=e.children)?void 0:i.length)?t(e.children):e.children=[{dimensionKey:"axis",value:""}]})};(null==(B=this.dataset.rowHeaderTree)?void 0:B.length)?t(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(e.columnTree||!1!==e.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,b.VN)(this.dataset.colHeaderTree,e.indicators)),e.rowTree||!1===e.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,b.VN)(this.dataset.rowHeaderTree,e.indicators)),O=new m.KO(null!=(I=this.dataset.colHeaderTree)?I:[],this.layoutNodeId),H=new m.KO(null!=(E=this.dataset.rowHeaderTree)?E:[],this.layoutNodeId),this.internalProps.layoutMap=new n.z(this,this.dataset,O,H),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(),e.title){let t=_.F.getComponent("title");this.internalProps.title=new t(e.title,this)}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(L=this.internalProps.emptyTip)||L.resetVisible();else{let t=_.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(F=this.internalProps.emptyTip)||F.resetVisible()}setTimeout(()=>{this.isReleased||(this.resize(),this.fireListeners(g.B.INITIALIZED,null))},0)}static get EVENT_TYPE(){return l.Z}get pivotChartAxes(){return this._axes}get recordsCount(){var t;return null==(t=this.records)?void 0:t.length}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!0}_canResizeColumn(t,e){let i=super._canResizeColumn(t,e);if(i&&!this.internalProps.layoutMap.indicatorsAsCol){let e=this.internalProps.layoutMap.getBody(t,this.columnHeaderLevelCount);if(null==e?void 0:e.disableColumnResize)return!1}return i}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,l,s,o,h,d,p,y,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F,O,H;let D,z,W=this.internalProps;super.updateOption(t,e),this.layoutNodeId={seqId:0},this.internalProps.columns=(0,u.Z)(t.columns),this.internalProps.rows=(0,u.Z)(t.rows),this.internalProps.indicators=(null==(i=t.indicators)?void 0:i.length)?(0,f.u)(t.indicators):[],this.internalProps.columnTree=!t.indicatorsAsCol||(null==(r=t.columns)?void 0:r.length)||t.columnTree?(0,u.Z)(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||(null==(l=t.rows)?void 0:l.length)||t.rowTree?(0,u.Z)(t.rowTree):[],t.records&&(this.internalProps.records=t.records),this.setCustomStateNameToSpec(),this._selectedDataItemsInChart=[],W.columnResizeType=null!=(h=null!=(o=null==(s=t.resize)?void 0:s.columnResizeType)?o:t.columnResizeType)?h:"column",W.rowResizeType=null!=(y=null!=(p=null==(d=t.resize)?void 0:d.rowResizeType)?p:t.rowResizeType)?y:"row",W.dataConfig={isPivotChart:!0},this.internalProps.columnWidthConfig=t.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=t.columnWidthConfigForRowHeader,this._axes=(0,c.Z)(t.axes)?t.axes:[],t.columnTree&&(!1!==t.indicatorsAsCol&&(this.internalProps.columnTree=(0,b.VN)(this.internalProps.columnTree,t.indicators)),D=new m.KO(null!=(C=this.internalProps.columnTree)?C:[],this.layoutNodeId)),t.rowTree&&(!1===t.indicatorsAsCol&&(this.internalProps.rowTree=(0,b.VN)(this.internalProps.rowTree,t.indicators)),z=new m.KO(null!=(x=this.internalProps.rowTree)?x:[],this.layoutNodeId));let Z=(null==(w=null==z?void 0:z.dimensionKeys)?void 0:w.count)?z.dimensionKeys.valueArr():null!=(A=null==(S=t.rows)?void 0:S.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?A:[],N=(null==(M=null==D?void 0:D.dimensionKeys)?void 0:M.count)?D.dimensionKeys.valueArr():null!=(k=null==(T=t.columns)?void 0:T.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?k:[],j=null!=(P=null==(R=t.indicators)?void 0:R.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.indicatorKey),t),[]))?P:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(N,Z),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new a.q(this.internalProps.dataConfig,Z,N,j,this.internalProps.indicators,null==(B=t.indicatorsAsCol)||B,null!=(I=t.records)?I:this.internalProps.records,void 0,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&(0,v.eW)(this.internalProps.indicators)){let t=e=>{e.forEach(e=>{var i;(null==(i=e.children)?void 0:i.length)?t(e.children):e.children=[{dimensionKey:"axis",value:""}]})};(null==(E=this.dataset.rowHeaderTree)?void 0:E.length)?t(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(t.columnTree||!1!==t.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,b.VN)(this.dataset.colHeaderTree,t.indicators)),t.rowTree||!1===t.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,b.VN)(this.dataset.rowHeaderTree,t.indicators)),D=new m.KO(null!=(L=this.dataset.colHeaderTree)?L:[],this.layoutNodeId),z=new m.KO(null!=(F=this.dataset.rowHeaderTree)?F:[],this.layoutNodeId),W.layoutMap=new n.z(this,this.dataset,D,z),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,W.releaseList&&(W.releaseList.forEach(t=>{var e;return null==(e=null==t?void 0:t.release)?void 0:e.call(t)}),W.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),t.title){let e=_.F.getComponent("title");this.internalProps.title=new e(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(O=this.internalProps.emptyTip)||O.resetVisible();else{let t=_.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(H=this.internalProps.emptyTip)||H.resetVisible()}return setTimeout(()=>{this.fireListeners(g.B.UPDATED,null)},0),new Promise(t=>{setTimeout(t,0)})}updatePagination(){}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var t,e,i,r,n,l,s,a;let{layoutMap:o}=this.internalProps;o&&(this.colCount=null!=(t=o.colCount)?t:0,this.rowCount=null!=(e=o.rowCount)?e:0,this.internalProps.frozenColCount=null!=(i=o.rowHeaderLevelCount)?i:0,this._setFrozenRowCount(Math.max(o.headerLevelCount,null!=(r=this.options.frozenRowCount)?r:0)),this.bottomFrozenRowCount!==(null!=(n=null==o?void 0:o.bottomFrozenRowCount)?n:0)&&(this.bottomFrozenRowCount=null!=(l=null==o?void 0:o.bottomFrozenRowCount)?l:0),this.rightFrozenColCount!==(null!=(s=null==o?void 0:o.rightFrozenColCount)?s:0)&&(this.rightFrozenColCount=null!=(a=null==o?void 0:o.rightFrozenColCount)?a:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(t,e,i){}syncHierarchyState(t,e){var i,r;t.value===e.value&&t.dimensionKey===e.dimensionKey&&(e.hierarchyState=null!=(i=e.hierarchyState)?i:(null==e?void 0:e.children)?t.hierarchyState:void 0,null==(r=null==e?void 0:e.children)||r.forEach((e,i)=>{var r;(null==(r=null==t?void 0:t.children)?void 0:r[i])&&e&&this.syncHierarchyState(t.children[i],e)}))}getRecordShowIndexByCell(t,e){}getTableIndexByRecordIndex(t){}getTableIndexByField(t){}getCellAddrByFieldRecord(t,e){}getBodyIndexByRow(t){let{layoutMap:e}=this.internalProps;return e.getBodyIndexByRow(t)}getBodyIndexByCol(t){let{layoutMap:e}=this.internalProps;return e.getBodyIndexByCol(t)}getCellValue(t,e,i){var r,n,l;if(!i){let i=this.getCustomMergeValue(t,e);if(i)return i}if(this.internalProps.layoutMap.isHeader(t,e)){if(this.internalProps.layoutMap.isBottomFrozenRow(t,e)||this.internalProps.layoutMap.isRightFrozenColumn(t,e)){let i,l=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(t,e);return null==l||l.forEach(t=>{let e=this.internalProps.layoutMap.getIndicatorInfo(t);e&&(i=e)}),null!=(n=null!=(r=null==i?void 0:i.title)?r:null==i?void 0:i.indicatorKey)?n:""}let{title:i,fieldFormat:l}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof l?l(i,t,e,this):i}if(this.dataset){let i,r=this.internalProps.layoutMap.getCellHeaderPaths(t,e),n=r.colHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),l=r.rowHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),s=this.dataset.getAggregator(l,n,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i);return s.value?s.value():void 0}let{fieldFormat:s}=this.internalProps.layoutMap.getBody(t,e),a=this.getBodyIndexByRow(e),o=this.getBodyIndexByCol(t),h=null==(l=this.records[a])?void 0:l[o];return"function"==typeof s?s(h,t,e,this):h}getCellOriginValue(t,e){var i,r,n;if(this.internalProps.layoutMap.isHeader(t,e)){if(this.internalProps.layoutMap.isBottomFrozenRow(t,e)||this.internalProps.layoutMap.isRightFrozenColumn(t,e)){let n,l=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(t,e);return null==l||l.forEach(t=>{let e=this.internalProps.layoutMap.getIndicatorInfo(t);e&&(n=e)}),null!=(r=null!=(i=null==n?void 0:n.title)?i:null==n?void 0:n.indicatorKey)?r:""}let{title:n}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof n?n():n}if(this.dataset){let i,r=this.internalProps.layoutMap.getCellHeaderPaths(t,e),n=r.colHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),l=r.rowHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),s=this.dataset.getAggregator(l,n,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i);return s.value?s.value():void 0}let l=this.getBodyIndexByRow(e),s=this.getBodyIndexByCol(t);return null==(n=this.records[l])?void 0:n[s]}getCellRawValue(t,e){return this.getCellOriginValue(t,e)}getCellOriginRecord(t,e){if(!this.internalProps.layoutMap.isHeader(t,e)&&this.dataset){let i,r=this.internalProps.layoutMap.getCellHeaderPaths(t,e),n=r.colHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),l=r.rowHeaderPaths.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value});return this.dataset.getAggregator(l,n,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i).records}}getCellRawRecord(t,e){return this.getCellOriginRecord(t,e)}getPivotSortState(t,e){if(!this.pivotSortState)return;let i=this.getCellRange(t,e);for(let t=0;t<this.pivotSortState.length;t++){let{col:e,row:r,order:n}=this.pivotSortState[t];if((0,s._Z)(i,e,r))return n}}_moveHeaderPosition(t,e){var i,r,n,l;let s=this.internalProps.layoutMap.moveHeaderPosition(t,e);if(s){if("column"===s.moveType){if((null==(r=null==(i=this.options.records)?void 0:i[0])?void 0:r.constructor)===Array)for(let t=0;t<this.internalProps.records.length;t++){let e=this.internalProps.records[t].splice(s.sourceIndex-this.rowHeaderLevelCount,s.sourceSize);e.unshift(s.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[t],e)}this.colWidthsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize),this.setMinMaxLimitWidth()}else if("row"===s.moveType){if((null==(l=null==(n=this.options.records)?void 0:n[0])?void 0:l.constructor)===Array){let t=this.internalProps.records.splice(s.sourceIndex-this.columnHeaderLevelCount,s.sourceSize);t.unshift(s.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,t)}this.rowHeightsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize)}return s}return null}toggleHierarchyState(t,e,i=!0){}getHeaderCellAddressByPath(t){return this.internalProps.layoutMap.getPivotCellAdress(t)}getCellAddressByHeaderPaths(t){return this.internalProps.layoutMap.getCellAdressByHeaderPath(t)}getHeaderPathByXY(t){let e;return e=t?this.getCellAt(t.x+this.getFrozenColsWidth()+this.scrollLeft+1,t.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(e.col,e.row)}getHierarchyState(t,e){var i;return null==(i=this._getHeaderLayoutMap(t,e))?void 0:i.hierarchyState}getMenuInfo(t,e,i){let r=this.internalProps.layoutMap.getPivotDimensionInfo(t,e);return{dimensionKey:r[r.length-1].dimensionKey,value:this.getCellValue(t,e),cellLocation:this.getCellLocation(t,e),isPivotCorner:this.isCornerHeader(t,e),event:void 0}}_generateCollectValuesConfig(t,e){var i,r,n,l,s,a,h,d,u,c,p,g,f,m,v,b,_,C,x,S,A,M,T,k;t=t.filter(t=>t!==y.ek),e=e.filter(t=>t!==y.ek);let R=this.internalProps.indicators,P={};for(let y=0,B=null==R?void 0:R.length;y<B;y++)if("string"!=typeof R[y]&&R[y].chartSpec){if("pie"===(null==(i=R[y].chartSpec)?void 0:i.type)||"rose"===(null==(r=R[y].chartSpec)?void 0:r.type)||"funnel"===(null==(n=R[y].chartSpec)?void 0:n.type)||"radar"===(null==(l=R[y].chartSpec)?void 0:l.type)||"gauge"===(null==(s=R[y].chartSpec)?void 0:s.type)||"wordCloud"===(null==(a=R[y].chartSpec)?void 0:a.type)||"sunburst"===(null==(h=R[y].chartSpec)?void 0:h.type)||"treemap"===(null==(d=R[y].chartSpec)?void 0:d.type)||"sankey"===(null==(u=R[y].chartSpec)?void 0:u.type)||"circlePacking"===(null==(c=R[y].chartSpec)?void 0:c.type))continue;let B=R[y],I=B.chartSpec;if(!1===this.options.indicatorsAsCol)if(!1!==(null==I?void 0:I.stack)&&("bar"===(null==I?void 0:I.type)||"area"===(null==I?void 0:I.type))&&(I.stack=!0),"heatmap"!==(null==I?void 0:I.type)&&(P[B.indicatorKey]={by:e,range:!0,sumBy:"histogram"===I.type?t.concat(null==I?void 0:I.xField,null==I?void 0:I.x2Field):(null==I?void 0:I.stack)&&t.concat(null==I?void 0:I.xField)}),I.series)I.series.forEach(i=>{var r,n,l,s,a,h,d,u,c,p,g,f,m,y;let v="string"==typeof i.xField?i.xField:i.xField[0];P[v]={by:t,type:"horizontal"!==i.direction?"xField":void 0,range:(0,w.Wm)(i,this._axes,"horizontal"===i.direction,!0),sortBy:"horizontal"!==i.direction?null!=(s=null==(l=null==(n=null==(r=null==i?void 0:i.data)?void 0:r.fields)?void 0:n[v])?void 0:l.domain)?s:null==(d=null==(h=null==(a=null==I?void 0:I.data)?void 0:a.fields)?void 0:h[v])?void 0:d.domain:void 0};let b=i.yField;!1!==i.stack&&("bar"===i.type||"area"===i.type)&&(i.stack=!0),P[b]={by:e,range:(0,w.Wm)(i,this._axes,"horizontal"===i.direction,!1),sumBy:i.stack&&t.concat(null==i?void 0:i.xField),sortBy:"horizontal"===i.direction?null!=(g=null==(p=null==(c=null==(u=null==i?void 0:i.data)?void 0:u.fields)?void 0:c[b])?void 0:p.domain)?g:null==(y=null==(m=null==(f=null==I?void 0:I.data)?void 0:f.fields)?void 0:m[b])?void 0:y.domain:void 0,extendRange:(0,o.FJ)(I.markLine)}});else{let i="histogram"===I.type?I.x2Field:"string"==typeof I.xField?I.xField:I.xField[0];P[i]={by:t,type:"horizontal"!==I.direction?"xField":void 0,range:(0,w.Wm)(I,this._axes,"horizontal"===I.direction,!0),sortBy:"horizontal"!==I.direction?null==(f=null==(g=null==(p=null==I?void 0:I.data)?void 0:p.fields)?void 0:g[i])?void 0:f.domain:void 0},!1!==(null==I?void 0:I.stack)&&("bar"===(null==I?void 0:I.type)||"area"===(null==I?void 0:I.type))&&(I.stack=!0);let r=null!=(m=I.yField)?m:I.maxField;P[r]={by:e,type:"horizontal"!==I.direction?"yField":void 0,range:(0,w.Wm)(I,this._axes,"horizontal"===I.direction,!1),sumBy:"histogram"===I.type?t.concat(null==I?void 0:I.xField,null==I?void 0:I.x2Field):I.stack&&t.concat(null==I?void 0:I.xField),sortBy:"horizontal"===I.direction?null==(_=null==(b=null==(v=null==I?void 0:I.data)?void 0:v.fields)?void 0:b[r])?void 0:_.domain:void 0,extendRange:(0,o.FJ)(I.markLine),considerFields:"boxPlot"===(null==I?void 0:I.type)?[I.maxField,I.minField,I.outliersField]:void 0}}else{let i=R[y];if(!1!==(null==I?void 0:I.stack)&&("bar"===(null==I?void 0:I.type)||"area"===(null==I?void 0:I.type))&&(I.stack=!0),"heatmap"!==(null==I?void 0:I.type)&&(P[i.indicatorKey]={by:t,range:!0,sumBy:"histogram"===I.type?e.concat(null==I?void 0:I.yField,null==I?void 0:I.y2Field):(null==I?void 0:I.stack)&&e.concat(null==I?void 0:I.yField)}),I.series)I.series.forEach(i=>{var r,n,l,s,a,h,d,u,c,p,g,f,m,y;let v="string"==typeof i.yField?i.yField:i.yField[0];P[v]={by:e,type:"horizontal"===i.direction?"yField":void 0,range:(0,w.Wm)(i,this._axes,"horizontal"===i.direction,!1),sortBy:"horizontal"===i.direction?null!=(s=null==(l=null==(n=null==(r=null==i?void 0:i.data)?void 0:r.fields)?void 0:n[v])?void 0:l.domain)?s:null==(d=null==(h=null==(a=null==I?void 0:I.data)?void 0:a.fields)?void 0:h[v])?void 0:d.domain:void 0};let b=i.xField;!1!==i.stack&&("bar"===i.type||"area"===i.type)&&(i.stack=!0),P[b]={by:t,range:(0,w.Wm)(i,this._axes,"horizontal"===i.direction,!0),sumBy:i.stack&&e.concat(null==i?void 0:i.yField),sortBy:"horizontal"!==i.direction?null!=(g=null==(p=null==(c=null==(u=null==i?void 0:i.data)?void 0:u.fields)?void 0:c[b])?void 0:p.domain)?g:null==(y=null==(m=null==(f=null==I?void 0:I.data)?void 0:f.fields)?void 0:m[b])?void 0:y.domain:void 0,extendRange:(0,o.FJ)(I.markLine)}});else{let i="histogram"===I.type?I.y2Field:"string"==typeof I.yField?I.yField:I.yField[0];P[i]={by:e,type:"horizontal"===I.direction?"yField":void 0,range:(0,w.Wm)(I,this._axes,"horizontal"===I.direction,!1),sortBy:"horizontal"===I.direction?null==(S=null==(x=null==(C=null==I?void 0:I.data)?void 0:C.fields)?void 0:x[i])?void 0:S.domain:void 0},!1!==(null==I?void 0:I.stack)&&("bar"===(null==I?void 0:I.type)||"area"===(null==I?void 0:I.type))&&(I.stack=!0);let r=null!=(A=I.xField)?A:I.maxField;P[r]={by:t,type:"horizontal"===I.direction?"xField":void 0,range:(0,w.Wm)(I,this._axes,"horizontal"===I.direction,!0),sumBy:"histogram"===I.type?e.concat(null==I?void 0:I.yField,null==I?void 0:I.y2Field):I.stack&&e.concat(null==I?void 0:I.yField),sortBy:"horizontal"!==I.direction?null==(k=null==(T=null==(M=null==I?void 0:I.data)?void 0:M.fields)?void 0:T[r])?void 0:k.domain:void 0,extendRange:(0,o.FJ)(I.markLine),considerFields:"boxPlot"===(null==I?void 0:I.type)?[I.maxField,I.minField,I.outliersField]:void 0}}}}return P}_generateAggregationRules(){var t;let e=[];return null==(t=this.internalProps.indicators)||t.forEach(t=>{var i,n;if("string"==typeof t)e.push({indicatorKey:t,field:t,aggregationType:r.E.RECORD});else if(null==(i=t.chartSpec)?void 0:i.series){let i=[];null==(n=t.chartSpec)||n.series.forEach(t=>{let e=!1===this.options.indicatorsAsCol?t.yField:t.xField;-1===i.indexOf(e)&&i.push(e)}),e.push({indicatorKey:t.indicatorKey,field:i,aggregationType:r.E.RECORD})}else{let i=!1===this.options.indicatorsAsCol?t.chartSpec.yField:t.chartSpec.xField;e.push({indicatorKey:t.indicatorKey,field:null!=i?i:t.indicatorKey,aggregationType:r.E.RECORD})}}),e}setCustomStateNameToSpec(){var t;let e=t=>{var e,i,r,n,l,s,a,o,h,d;(null==(i=null==(e=t.bar)?void 0:e.state)?void 0:i.selected)&&(t.bar.state.vtable_selected=t.bar.state.selected,t.bar.state.vtable_selected_reverse=t.bar.state.selected_reverse,delete t.bar.state.selected,delete t.bar.state.selected_reverse),(null==(n=null==(r=t.point)?void 0:r.state)?void 0:n.selected)&&(t.point.state.vtable_selected=t.point.state.selected,t.point.state.vtable_selected_reverse=t.point.state.selected_reverse,delete t.point.state.selected,delete t.point.state.selected_reverse),(null==(s=null==(l=t.line)?void 0:l.state)?void 0:s.selected)&&(t.line.state.vtable_selected=t.line.state.selected,t.line.state.vtable_selected_reverse=t.line.state.selected_reverse,delete t.line.state.selected,delete t.line.state.selected_reverse),(null==(o=null==(a=t.area)?void 0:a.state)?void 0:o.selected)&&(t.area.state.vtable_selected=t.area.state.selected,t.area.state.vtable_selected_reverse=t.area.state.selected_reverse,delete t.area.state.selected,delete t.area.state.selected_reverse),(null==(d=null==(h=t.pie)?void 0:h.state)?void 0:d.selected)&&(t.pie.state.vtable_selected=t.pie.state.selected,t.pie.state.vtable_selected_reverse=t.pie.state.selected_reverse,delete t.pie.state.selected,delete t.pie.state.selected_reverse)};null==(t=this.internalProps.indicators)||t.forEach(t=>{if(t.chartSpec){let i=t.chartSpec;i.series?i.series.forEach(t=>{e(t)}):e(i)}})}updateFilterRules(t){this._throttledUpdateFilterRules(t)}_throttledUpdateFilterRules(t){this._latestFilterRules=t,null===this._throttleTimer&&(this._executeFilterUpdate(t),this._throttleTimer=window.setTimeout(()=>{this._latestFilterRules!==t&&this._executeFilterUpdate(this._latestFilterRules),this._throttleTimer=null},200))}_executeFilterUpdate(t){this.internalProps.dataConfig.filterRules=t,this.dataset.updateFilterRules(t),(0,d.RW)(this.scenegraph),(0,d.zO)(this.scenegraph),this.render()}clearChartCacheImage(t,e){(0,p.Z)(t)&&(0,p.Z)(e)?(0,d.KP)(t,e,this.scenegraph):(0,d.RW)(this.scenegraph)}getLegendSelected(){var t;let e=[];return null==(t=this.internalProps.legends)||t.forEach(t=>{let i=t.legendComponent._getSelectedLegends().map(t=>t.label);e.push(...i)}),e}setLegendSelected(t){var e;null==(e=this.internalProps.legends)||e.forEach(e=>{e.legendComponent.setSelected(t)})}getChartDatumPosition(t,e){let{chartInstance:i,bounds:r}=this.getChartInstance(e);if(i){let e=i.convertDatumToPosition(t);return e?{x:Math.round(e.x+r.x1),y:Math.round(e.y+r.y1)}:null}return null}getCellAddressByRecord(t){let e=[],i=[],r={},n=[];for(let l in this.dataset.dataConfig.aggregationRules.forEach(t=>{if("string"==typeof t.field)r[t.field]=t.indicatorKey,n.push(t.field);else for(let e=0;e<t.field.length;e++)r[t.field[e]]=t.indicatorKey,n.push(t.field[e])}),t)this.dataset.rows.indexOf(l)>=0&&e.push({dimensionKey:l,value:t[l]}),this.dataset.columns.indexOf(l)>=0&&i.push({dimensionKey:l,value:t[l]}),n.indexOf(l)>=0&&(this.dataset.indicatorsAsCol?i.push({indicatorKey:r[l]}):e.push({indicatorKey:r[l]}));return this.getCellAddressByHeaderPaths({rowHeaderPaths:e,colHeaderPaths:i,cellLocation:"body"})}getChartInstance(t){var e,i,r,n,l;let s=this.getCellAddressByHeaderPaths(t);if(s){let t,a=this.getCellRelativeRect(s.col,s.row),o=this.scenegraph.getCell(s.col,s.row),h=null==(e=null==o?void 0:o.getChildren())?void 0:e[0];if(h.attribute.chartInstance){t=h.attribute.chartInstance;let{dataId:e,data:s,axes:a,spec:o}=h.attribute,d=h.getViewBox();null==a||a.forEach((e,i)=>{var r,n,l,s,a;"linear"===e.type?t.updateModelSpecSync({type:"axes",index:i},{min:null!=(n=null==(r=e.range)?void 0:r.min)?n:0,max:null!=(s=null==(l=e.range)?void 0:l.max)?s:0,tick:{tickMode:null==(a=e.tick)?void 0:a.tickMode}},!0):"band"===e.type&&t.updateModelSpec({type:"axes",index:i},{domain:e.domain.slice(0)},!0)}),t.updateViewBox({x1:0,x2:d.x2-d.x1,y1:0,y2:d.y2-d.y1},!1,!1);let u=t.getStage(),c=h.globalTransMatrix.clone(),p=h.stage.window.getViewBoxTransform();if(c.multiply(p.a,p.b,p.c,p.d,p.e,p.f),u.window.setViewBoxTransform&&u.window.setViewBoxTransform(c.a,c.b,c.c,c.d,c.e,c.f),"string"==typeof e||"number"==typeof e)t.updateDataSync(e,null!=s?s:[]);else{let a=[];for(let l in e){let h=e[l],d=o.series.find(t=>{var e;return(null==(e=null==t?void 0:t.data)?void 0:e.id)===l});a.push({id:l,values:h?null!=(i=null==s?void 0:s.filter(t=>t.hasOwnProperty(h)))?i:[]:null!=s?s:[],fields:null==(r=null==d?void 0:d.data)?void 0:r.fields}),t.updateFullDataSync||t.updateDataSync(l,h?null!=(n=null==s?void 0:s.filter(t=>t.hasOwnProperty(h)))?n:[]:null!=s?s:[])}null==(l=t.updateFullDataSync)||l.call(t,a)}this.render()}return{chartInstance:t,bounds:a.bounds}}return{}}activateChartInstance(t){var e,i,r,n,l;let s=this.getCellAddressByHeaderPaths(t);if(s){let t=s.col,a=s.row,o=this.scenegraph.getCell(t,a),h=null==(e=null==o?void 0:o.getChildren())?void 0:e[0],d=this.scenegraph.activateChart(t,a),{dataId:u,data:c,axes:p,spec:g}=h.attribute,f=h.getViewBox();null==p||p.forEach((t,e)=>{var i,r,n,l,s;"linear"===t.type?d.updateModelSpecSync({type:"axes",index:e},{min:null!=(r=null==(i=t.range)?void 0:i.min)?r:0,max:null!=(l=null==(n=t.range)?void 0:n.max)?l:0,tick:{tickMode:null==(s=t.tick)?void 0:s.tickMode}},!0):"band"===t.type&&d.updateModelSpec({type:"axes",index:e},{domain:t.domain.slice(0)},!0)}),d.updateViewBox({x1:0,x2:f.x2-f.x1,y1:0,y2:f.y2-f.y1},!1,!1);let m=d.getStage();m.needRender=!0;let y=h.globalTransMatrix.clone(),v=h.stage.window.getViewBoxTransform().clone();if(v.multiply(y.a,y.b,y.c,y.d,y.e,y.f),m.window.setViewBoxTransform(v.a,v.b,v.c,v.d,v.e,v.f),"string"==typeof u||"number"==typeof u)d.updateDataSync(u,null!=c?c:[]);else{let t=[];for(let e in u){let l=u[e],s=g.series.find(t=>{var i;return(null==(i=null==t?void 0:t.data)?void 0:i.id)===e});t.push({id:e,values:l?null!=(i=null==c?void 0:c.filter(t=>t.hasOwnProperty(l)))?i:[]:null!=c?c:[],fields:null==(r=null==s?void 0:s.data)?void 0:r.fields}),d.updateFullDataSync||d.updateDataSync(e,l?null!=(n=null==c?void 0:c.filter(t=>t.hasOwnProperty(l)))?n:[]:null!=c?c:[])}null==(l=d.updateFullDataSync)||l.call(d,t)}return d}}replaceChartCacheImage(t,e){var i;let r=this.getCellAddressByHeaderPaths(t);if(r){let t=this.scenegraph.getCell(r.col,r.row),n=null==(i=null==t?void 0:t.getChildren())?void 0:i[0];(0,S.Up)(e.getStage(),n)}}_getDimensionSortArray(){var t,e;if(null==(e=null==(t=this.options)?void 0:t.axes)?void 0:e.length){let t=this.options.indicatorsAsCol?"left":"bottom",e=this.options.axes.find(e=>e.orient===t);if(e&&(0,c.Z)(e.domain))return e.domain}}setRecords(t){var e,i;let r,l;this.internalProps.layoutMap.release(),(0,S.H6)();let s={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=t;let a=this.options,o=this.internalProps;this.dataset.setRecords(t),r=a.columnTree?o.layoutMap.columnDimensionTree:new m.KO(null!=(e=this.dataset.colHeaderTree)?e:[],this.layoutNodeId),l=a.rowTree?o.layoutMap.rowDimensionTree:new m.KO(null!=(i=this.dataset.rowHeaderTree)?i:[],this.layoutNodeId),o.layoutMap=new n.z(this,this.dataset,r,l),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(s.col,s.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder()}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;let{columnsDefine:t,rowsDefine:e,indicatorsDefine:i}=this.internalProps.layoutMap;for(let e=0;e<t.length;e++){let i=t[e];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let t=0;t<e.length;t++){let i=e[t];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let t=0;t<i.length;t++){let e=i[t];if("string"!=typeof e&&(e.customLayout||e.headerCustomLayout||e.customRender||e.headerCustomRender))return!0}return!1}changeRecordOrder(t,e){}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(t,e){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(t,e)}disableTooltipToAllChartInstances(){(0,A.yi)()}enableTooltipToAllChartInstances(){(0,A.cJ)()}}},68634:function(t,e,i){i.d(e,{I:()=>a});var r=i(35537),n=i(59779),l=i(83808),s=i(77643);(0,n.R2)(),(0,n.Eg)(),(0,n.I)(),(0,n.FD)(),(0,n._t)(),(0,n.Mh)(),(0,l.zf)(),(0,n.ph)(),(0,s.yR)(),(0,s.pk)(),(0,s.m4)(),(0,s.Jy)(),(0,s.dB)(),(0,s.ge)(),(0,s.au)();class a extends r.Z{}},35537:function(t,e,i){i.d(e,{Z:()=>M});var r=i(47490),n=i(72281),l=i(25987),s=i(64776);class a{constructor(t,e){this.tree={},this.beforeChangedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.dataConfig=t,e&&(this.records=e,"undefined"!=typeof window&&window.performance.now(),this.setRecords(e),"undefined"!=typeof window&&window.performance.now())}changeDataConfig(t){this.dataConfig=t}setRecords(t){this.processRecords()}processRecords(){for(let t=0,e=this.records.length;t<e;t++){let e=this.records[t];this.processRecord(e)}}processRecord(t){var e;let i=[],r=[];for(let e=0,i=this.dataConfig.rows.length;e<i;e++){let i=this.dataConfig.rows[e];void 0!==t[i]&&i!==this.dataConfig.indicatorDimensionKey&&r.push(t[i])}for(let e=0,r=this.dataConfig.columns.length;e<r;e++){let r=this.dataConfig.columns[e];void 0!==t[r]&&r!==this.dataConfig.indicatorDimensionKey&&i.push(t[r])}null==(e=this.dataConfig.indicators)||e.forEach(e=>{let n=t[e];void 0!==n&&(this.dataConfig.indicatorsAsCol?i.push(e):r.push(e));let l=r.join(this.stringJoinChar),s=i.join(this.stringJoinChar);0!==r.length&&(this.rowFlatKeys[l]||(this.rowFlatKeys[l]=1)),0!==i.length&&(this.colFlatKeys[s]||(this.colFlatKeys[s]=1)),0===i.length&&0===r.length||(this.tree[l]||(this.tree[l]={}),void 0!==n&&(this.tree[l][s]={value:n,record:t},this.dataConfig.indicatorsAsCol?i.pop():r.pop()))})}getTreeNode(t=[],e=[],i,r=!0){var n,l,a,o;let h,d;if("string"==typeof t)h=t;else{let e=!1;t.map((r,n)=>{r===i&&(t.splice(n,1),e=!0)}),e&&t.push(i),h=t.join(this.stringJoinChar)}if("string"==typeof e)d=e;else{let t=!1;e.map((r,n)=>{r===i&&(e.splice(n,1),t=!0)}),t&&e.push(i),d=e.join(this.stringJoinChar)}return r?null!=(a=null==(l=null==(n=this.tree)?void 0:n[h])?void 0:l[d])?a:void 0:(0,s.Z)(null==(o=this.beforeChangedTree[h])?void 0:o[d])?{value:this.beforeChangedTree[h][d].value,record:this.beforeChangedTree[h][d].record}:void 0}changeTreeNodeValue(t=[],e=[],i,r){var n,l,s,a,o,h,d;let u,c;if("string"==typeof t)u=t;else{let e=!1;t.map((r,n)=>{r===i&&(t.splice(n,1),e=!0)}),e&&t.push(i),u=t.join(this.stringJoinChar)}if("string"==typeof e)c=e;else{let t=!1;e.map((r,n)=>{r===i&&(e.splice(n,1),t=!0)}),t&&e.push(i),c=e.join(this.stringJoinChar)}let p=null==(l=null==(n=this.tree[u])?void 0:n[c])?void 0:l.value,g=Object.assign({},null==(a=null==(s=this.tree[u])?void 0:s[c])?void 0:a.record);(null==(h=null==(o=this.tree[u])?void 0:o[c])?void 0:h.record)?(this.tree[u][c].record[i]=r,this.tree[u][c].value=r):(this.tree[u]||(this.tree[u]={}),this.tree[u][c]={record:this._buildRecord(t,e,i,r),value:r}),(null==(d=this.beforeChangedTree[u])?void 0:d[c])||(this.beforeChangedTree[u]={},this.beforeChangedTree[u][c]={record:void 0,value:void 0},this.beforeChangedTree[u][c].record=g,this.beforeChangedTree[u][c].value=p)}_buildRecord(t=[],e=[],i,r){let n={},l=this.dataConfig.rows,s=this.dataConfig.columns;return l.forEach((e,i)=>{e!==this.dataConfig.indicatorDimensionKey&&(n[e]=t[i])}),s.forEach((t,i)=>{t!==this.dataConfig.indicatorDimensionKey&&(n[t]=e[i])}),n[i]=r,this.records.push(n),n}addRecords(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];this.processRecord(i)}this.records.push(t)}changeRecordFieldValue(t,e,i){let r=!1;for(let e=0;e<this.dataConfig.indicators.length;e++)this.dataConfig.indicators[e]===t&&(r=!0);if(!r){for(let r=0,n=this.records.length;r<n;r++){let n=this.records[r];n[t]===e&&(n[t]=i)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}}var o=i(11725),h=i(23975),d=i(91566),u=i(13746),c=i(65755),p=i(4654),g=i(30430),f=i(66023),m=i(67331),y=i(58710),v=i(23269),b=i(39909),_=i(6254),C=i(6958),x=i(39873),w=i(26595),S=i(31877),A=i(8347);class M extends u.D{constructor(t,e){var i,r,n,s,o,h,u,p,v,b,_,C,A,M,T,k,R,P,B,I,E,L,F,O;if(super(t,e),this.layoutNodeId={seqId:0},e=this.options){e.rowHierarchyType||(e.rowHierarchyType="grid"),e.columnHierarchyType||(e.columnHierarchyType="grid"),e.layout&&Object.assign(e,e.layout),this.internalProps.columns=(0,c.Z)(e.columns),this.internalProps.rows=(0,c.Z)(e.rows),this.internalProps.indicators=(0,x.u)(e.indicators),null==(i=e.indicators)||i.forEach((t,e)=>{"object"==typeof t&&(null==t?void 0:t.editor)&&(this.internalProps.indicators[e].editor=t.editor)}),this.internalProps.columnTree=!e.indicatorsAsCol||(null==(r=e.columns)?void 0:r.length)||e.columnTree?(0,c.Z)(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||(null==(n=e.rows)?void 0:n.length)||e.rowTree?(0,c.Z)(e.rowTree):[],this.internalProps.records=e.records,this.pagination=e.pagination,this.internalProps.columnResizeType=null!=(h=null!=(o=null==(s=e.resize)?void 0:s.columnResizeType)?o:e.columnResizeType)?h:"column",this.internalProps.rowResizeType=null!=(v=null!=(p=null==(u=e.resize)?void 0:u.rowResizeType)?p:e.rowResizeType)?v:"row",this.internalProps.dataConfig=(0,c.Z)(e.dataConfig),this.internalProps.columnWidthConfig=e.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=e.columnWidthConfigForRowHeader;let t=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(b=null==t?void 0:t[0])?void 0:b.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),!1===(null==(_=e.customConfig)?void 0:_.enableDataAnalysis)){let e=new f.KO(null!=(C=this.internalProps.columnTree)?C:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(A=this.options.columnExpandLevel)?A:1:void 0),i=new f.KO(null!=(M=this.internalProps.rowTree)?M:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(T=this.options.rowExpandLevel)?T:1:void 0);this.internalProps.layoutMap=new l.z(this,null,e,i),!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new a({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey},t))}else{let t=(0,w.Ul)(this,e),{rowKeys:i,columnKeys:r,indicatorKeys:n}=t,{columnDimensionTree:s,rowDimensionTree:a}=t;this.dataset=new d.q(this.internalProps.dataConfig,i,r,n,this.internalProps.indicators,null==(k=e.indicatorsAsCol)||k,e.records,e.rowHierarchyType,e.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!e.extensionRows,!!e.parseCustomTreeToMatchRecords),e.columnTree?s.hasHideNode&&((0,w.uu)(s.tree.children,e.indicators,!0,this),s.reset(s.tree.children)):(!1!==e.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,w.VN)(this.dataset.colHeaderTree,e.indicators)),!1!==e.indicatorsAsCol&&e.indicators&&this.dataset.colHeaderTree&&(0,w.uu)(this.dataset.colHeaderTree,e.indicators,!1,this),s=new f.KO(null!=(R=this.dataset.colHeaderTree)?R:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(P=this.options.columnExpandLevel)?P:1:void 0)),e.rowTree?a.hasHideNode&&((0,w.uu)(a.tree.children,e.indicators,!0,this),a.reset(a.tree.children)):(!1===e.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,w.VN)(this.dataset.rowHeaderTree,e.indicators)),!1===e.indicatorsAsCol&&this.dataset.rowHeaderTree&&e.indicators&&(0,w.uu)(this.dataset.rowHeaderTree,e.indicators,!1,this),a=new f.KO(null!=(B=this.dataset.rowHeaderTree)?B:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(I=this.options.rowExpandLevel)?I:1:void 0)),this.internalProps.layoutMap=new l.z(this,this.dataset,s,a)}if(this._changePivotSortStateBySortRules(),(null!=(L=null==(E=e.pivotSortState)?void 0:E.length)?L:0)>0&&(this.pivotSortState=[],this.pivotSortState=e.pivotSortState),"node"!==g.X.mode&&(this.editorManager=new y.$(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.stateManager.initCheckedState(t),this.scenegraph.createSceneGraph(),e.title){let t=S.F.getComponent("title");this.internalProps.title=new t(e.title,this)}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(F=this.internalProps.emptyTip)||F.resetVisible();else{let t=S.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(O=this.internalProps.emptyTip)||O.resetVisible()}setTimeout(()=>{this.isReleased||(this.resize(),this.fireListeners(m.B.INITIALIZED,null))},0)}}static get EVENT_TYPE(){return o.z}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!1}get recordsCount(){var t;return null==(t=this.records)?void 0:t.length}_canResizeColumn(t,e){let i=super._canResizeColumn(t,e);if(i){if(this.internalProps.layoutMap.isSeriesNumber(t,e)&&!0===this.internalProps.rowSeriesNumber.disableColumnResize)return!1;if(!this.internalProps.layoutMap.indicatorsAsCol){let e=this.internalProps.layoutMap.getBody(t,this.columnHeaderLevelCount);if(null==e?void 0:e.disableColumnResize)return!1}}return i}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,n,s,o,h,u,p,g,y,v,b,_,C,A,M,T,k,R,P,B,I,E,L,F,O;let H=this.internalProps;if(super.updateOption(t,e),t.rowHierarchyType||(t.rowHierarchyType="grid"),t.columnHierarchyType||(t.columnHierarchyType="grid"),this.layoutNodeId={seqId:0},this.internalProps.columns=(0,c.Z)(t.columns),this.internalProps.rows=(0,c.Z)(t.rows),this.internalProps.indicators=(null==(i=t.indicators)?void 0:i.length)?(0,x.u)(t.indicators):[],null==(r=t.indicators)||r.forEach((t,e)=>{"object"==typeof t&&(null==t?void 0:t.editor)&&(this.internalProps.indicators[e].editor=t.editor)}),this.internalProps.columnTree=!t.indicatorsAsCol||(null==(n=t.columns)?void 0:n.length)||t.columnTree?(0,c.Z)(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||(null==(s=t.rows)?void 0:s.length)||t.rowTree?(0,c.Z)(t.rowTree):[],t.records&&(this.internalProps.records=t.records),this.stateManager.initCheckedState(this.internalProps.records),this.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1),this.pagination=t.pagination,H.columnResizeType=null!=(u=null!=(h=null==(o=t.resize)?void 0:o.columnResizeType)?h:t.columnResizeType)?u:"column",H.rowResizeType=null!=(y=null!=(g=null==(p=t.resize)?void 0:p.rowResizeType)?g:t.rowResizeType)?y:"row",H.dataConfig=(0,c.Z)(t.dataConfig),this.internalProps.columnWidthConfig=t.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=t.columnWidthConfigForRowHeader,"grid"!==(null==t?void 0:t.rowHierarchyType)&&"grid"!==this.internalProps.layoutMap.rowHierarchyType&&this.internalProps.layoutMap.rowExpandLevel===(null==t?void 0:t.rowExpandLevel)){let t=this.internalProps.layoutMap.rowDimensionTree.tree.children;null==(v=this.internalProps.rowTree)||v.forEach((e,i)=>{let r=t.find(t=>t.dimensionKey===e.dimensionKey&&t.value===e.value);r&&this._syncHierarchyState(r,e)})}let D=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(b=null==D?void 0:D[0])?void 0:b.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),!1===(null==(_=t.customConfig)?void 0:_.enableDataAnalysis)){let e,i;t.columnTree&&(e=new f.KO(null!=(C=this.internalProps.columnTree)?C:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(A=this.options.columnExpandLevel)?A:1:void 0)),t.rowTree&&(i=new f.KO(null!=(M=this.internalProps.rowTree)?M:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(T=this.options.rowExpandLevel)?T:1:void 0)),H.layoutMap.clearHeaderPathCache(),H.layoutMap=new l.z(this,null,e,i),!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new a({rows:H.layoutMap.fullRowDimensionKeys,columns:H.layoutMap.colDimensionKeys,indicators:H.layoutMap.indicatorKeys,indicatorsAsCol:H.layoutMap.indicatorsAsCol,indicatorDimensionKey:H.layoutMap.indicatorDimensionKey},D))}else{let e=(0,w.Ul)(this,t),{rowKeys:i,columnKeys:r,indicatorKeys:n}=e,{columnDimensionTree:s,rowDimensionTree:a}=e;this.dataset=new d.q(H.dataConfig,i,r,n,this.internalProps.indicators,null==(k=t.indicatorsAsCol)||k,D,t.rowHierarchyType,t.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!t.extensionRows,!!t.parseCustomTreeToMatchRecords),t.columnTree?s.hasHideNode&&((0,w.uu)(s.tree.children,t.indicators,!0,this),s.reset(s.tree.children)):(!1!==t.indicatorsAsCol&&(this.dataset.colHeaderTree=(0,w.VN)(this.dataset.colHeaderTree,t.indicators)),!1!==t.indicatorsAsCol&&t.indicators&&this.dataset.colHeaderTree&&(0,w.uu)(this.dataset.colHeaderTree,t.indicators,!1,this),s=new f.KO(null!=(R=this.dataset.colHeaderTree)?R:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(P=this.options.columnExpandLevel)?P:1:void 0)),t.rowTree?a.hasHideNode&&((0,w.uu)(a.tree.children,t.indicators,!0,this),a.reset(a.tree.children)):(!1===t.indicatorsAsCol&&(this.dataset.rowHeaderTree=(0,w.VN)(this.dataset.rowHeaderTree,t.indicators)),!1===t.indicatorsAsCol&&this.dataset.rowHeaderTree&&t.indicators&&(0,w.uu)(this.dataset.rowHeaderTree,t.indicators,!1,this),a=new f.KO(null!=(B=this.dataset.rowHeaderTree)?B:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(I=this.options.rowExpandLevel)?I:1:void 0)),H.layoutMap=new l.z(this,this.dataset,s,a)}if(this._changePivotSortStateBySortRules(),(null!=(L=null==(E=t.pivotSortState)?void 0:E.length)?L:0)>0&&(this.pivotSortState=[],this.pivotSortState=t.pivotSortState),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,H.releaseList&&(H.releaseList.forEach(t=>{var e;return null==(e=null==t?void 0:t.release)?void 0:e.call(t)}),H.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),t.title){let e=S.F.getComponent("title");this.internalProps.title=new e(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)null==(F=this.internalProps.emptyTip)||F.resetVisible();else{let t=S.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(O=this.internalProps.emptyTip)||O.resetVisible()}return setTimeout(()=>{this.fireListeners(m.B.UPDATED,null)},0),new Promise(t=>{setTimeout(t,0)})}updatePagination(t){this.internalProps.layoutMap.clearHeaderPathCache(),t?(this.pagination||(this.pagination={currentPage:0,perPageCount:0}),"number"==typeof t.currentPage&&t.currentPage>=0&&(this.pagination.currentPage=t.currentPage),t.perPageCount&&(this.pagination.perPageCount=t.perPageCount||this.pagination.perPageCount),this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(this.pagination),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()):this.pagination&&(this.pagination=void 0,this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(void 0),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render())}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var t,e,i,r,n,l,s,a,o;let{layoutMap:h}=this.internalProps;h&&(this.colCount=null!=(t=h.colCount)?t:0,this.rowCount=null!=(e=h.rowCount)?e:0,this.internalProps.frozenColCount=null!=(i=this.options.frozenColCount)?i:(null!=(r=h.rowHeaderLevelCount)?r:0)+h.leftRowSeriesNumberColumnCount,this._setFrozenRowCount(Math.max(h.headerLevelCount,null!=(n=this.options.frozenRowCount)?n:0)),this.bottomFrozenRowCount!==(null!=(l=this.options.bottomFrozenRowCount)?l:0)&&(this.bottomFrozenRowCount=null!=(s=this.options.bottomFrozenRowCount)?s:0),this.rightFrozenColCount!==(null!=(a=this.options.rightFrozenColCount)?a:0)&&(this.rightFrozenColCount=null!=(o=this.options.rightFrozenColCount)?o:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount),this.stateManager.setFrozenRow(this.frozenRowCount))}_getSortFuncFromHeaderOption(t,e,i){}get rowHierarchyType(){return this.internalProps.layoutMap.rowHierarchyType}get columnHierarchyType(){return this.internalProps.layoutMap.columnHierarchyType}_syncHierarchyState(t,e){var i,r,n;t.value===e.value&&t.dimensionKey===e.dimensionKey&&(e.hierarchyState=null!=(i=e.hierarchyState)?i:(null==e?void 0:e.children)?t.hierarchyState:void 0,null==(n=null==(r=null==e?void 0:e.children)?void 0:r.forEach)||n.call(r,(e,i)=>{var r;if((null==(r=null==t?void 0:t.children)?void 0:r[i])&&e){let i=t.children.find(t=>t.dimensionKey===e.dimensionKey&&t.value===e.value);i&&this._syncHierarchyState(i,e)}}))}getRecordShowIndexByCell(t,e){}getTableIndexByRecordIndex(t){}getTableIndexByField(t){}getCellAddrByFieldRecord(t,e){}getBodyIndexByRow(t){let{layoutMap:e}=this.internalProps;return e.getBodyIndexByRow(t)}getBodyIndexByCol(t){let{layoutMap:e}=this.internalProps;return e.getBodyIndexByCol(t)}getFieldData(t,e,i){var r,n,l;if(!this.internalProps.layoutMap.isHeader(e,i)){if(this.internalProps.recordsIsTwoDimensionalArray){let t=this.getBodyIndexByRow(i),n=this.getBodyIndexByCol(e);return null==(r=this.records[t])?void 0:r[n]}if(this.dataset){let r=this.internalProps.layoutMap.getCellHeaderPaths(e,i);if(r){let s,a=null==(n=r.colHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var i;return t.indicatorKey&&(s={position:"col",index:e}),null!=(i=t.indicatorKey)?i:t.value}),o=null==(l=r.rowHeaderPaths)?void 0:l.filter(t=>!t.virtual).map((t,e)=>{var i;return t.indicatorKey&&(s={position:"row",index:e}),null!=(i=t.indicatorKey)?i:t.value}),h=this.dataset.getAggregator(o,a,this.internalProps.layoutMap.getIndicatorKey(e,i),!0,s);if(h.records&&h.records.length>=1)return h.records[0][t]}}else if(this.flatDataToObjects){let r=this.internalProps.layoutMap.getCellHeaderPaths(e,i),n=r.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),l=r.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),s=this.flatDataToObjects.getTreeNode(l,n,this.internalProps.layoutMap.getBody(e,i).indicatorKey,!1);if(null==s?void 0:s.record)return null==s?void 0:s.record[t]}}}getCellValue(t,e,i){var r,n,l,s,a,o,h;if(!i){let i=this.getCustomMergeValue(t,e);if(i)return i}if(this.internalProps.layoutMap.isSeriesNumber(t,e)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getSeriesNumberHeader(t,e);return i}let{format:i}=this.internalProps.layoutMap.getSeriesNumberBody(t,e);return"function"==typeof i?i(t,e,this):e-this.columnHeaderLevelCount+1}if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i,fieldFormat:r}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof r?r(i,t,e,this):i}if(this.internalProps.recordsIsTwoDimensionalArray){let{fieldFormat:i}=this.internalProps.layoutMap.getBody(t,e),n=this.getBodyIndexByRow(e),l=this.getBodyIndexByCol(t),s=null==(r=this.records[n])?void 0:r[l];return"function"==typeof i?i(s,t,e,this):s}if(this.dataset){let i,r=this.internalProps.layoutMap.getCellHeaderPaths(t,e),h=null==(l=null==(n=r.colHeaderPaths)?void 0:n.filter(t=>!t.virtual))?void 0:l.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),d=null==(a=null==(s=r.rowHeaderPaths)?void 0:s.filter(t=>!t.virtual))?void 0:a.map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),u=this.dataset.getAggregator(d,h,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i),{fieldFormat:c}=this.internalProps.layoutMap.getBody(t,e);return u.formatValue?u.formatValue(t,e,this):"function"==typeof c?c(null==u?void 0:u.value(),t,e,this):null!=(o=null==u?void 0:u.value())?o:""}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),l=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey),{fieldFormat:s}=this.internalProps.layoutMap.getBody(t,e);return"function"==typeof s?s(null==l?void 0:l.value,t,e,this):null!=(h=null==l?void 0:l.value)?h:""}}getCellOriginValue(t,e){var i,r,n;if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}if(this.internalProps.recordsIsTwoDimensionalArray){let r=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);return null==(i=this.records[r])?void 0:i[n]}if(this.dataset){let i,l=this.internalProps.layoutMap.getCellHeaderPaths(t,e),s=null==(r=l.colHeaderPaths)?void 0:r.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),a=null==(n=l.rowHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),o=this.dataset.getAggregator(a,s,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i);return o.value?o.value():void 0}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),l=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey);return null==l?void 0:l.value}}getCellRawValue(t,e){var i,r,n;if(this.internalProps.layoutMap.isHeader(t,e)){let{title:i}=this.internalProps.layoutMap.getHeader(t,e);return"function"==typeof i?i():i}if(this.internalProps.recordsIsTwoDimensionalArray){let r=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);return null==(i=this.records[r])?void 0:i[n]}if(this.dataset){let i,l=this.internalProps.layoutMap.getCellHeaderPaths(t,e),s=null==(r=l.colHeaderPaths)?void 0:r.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),a=null==(n=l.rowHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value}),o=this.dataset.getAggregator(a,s,this.internalProps.layoutMap.getIndicatorKey(t,e),!1,i);return o.value?o.value():void 0}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),l=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey,!1);return null==l?void 0:l.value}}getCellOriginRecord(t,e){var i,r,n;if(!this.internalProps.layoutMap.isHeader(t,e)){if(this.internalProps.recordsIsTwoDimensionalArray){let r=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);return null==(i=this.records[r])?void 0:i[n]}if(this.dataset){let i,l=this.internalProps.layoutMap.getCellHeaderPaths(t,e),s=null==(r=l.colHeaderPaths)?void 0:r.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),a=null==(n=l.rowHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value});return this.dataset.getAggregator(a,s,this.internalProps.layoutMap.getIndicatorKey(t,e),!0,i).records}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),l=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey);return null==l?void 0:l.record}}}getCellRawRecord(t,e){var i,r,n;if(!this.internalProps.layoutMap.isHeader(t,e)){if(this.internalProps.recordsIsTwoDimensionalArray){let r=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);return null==(i=this.records[r])?void 0:i[n]}if(this.dataset){let i,l=this.internalProps.layoutMap.getCellHeaderPaths(t,e),s=null==(r=l.colHeaderPaths)?void 0:r.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"col",index:e}),null!=(r=t.indicatorKey)?r:t.value}),a=null==(n=l.rowHeaderPaths)?void 0:n.filter(t=>!t.virtual).map((t,e)=>{var r;return t.indicatorKey&&(i={position:"row",index:e}),null!=(r=t.indicatorKey)?r:t.value});return this.dataset.getAggregator(a,s,this.internalProps.layoutMap.getIndicatorKey(t,e),!1,i).records}if(this.flatDataToObjects){let i=this.internalProps.layoutMap.getCellHeaderPaths(t,e),r=i.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=i.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),l=this.flatDataToObjects.getTreeNode(n,r,this.internalProps.layoutMap.getBody(t,e).indicatorKey,!1);return null==l?void 0:l.record}}}updateSortRules(t,e,i){this.internalProps.dataConfig?this.internalProps.dataConfig.sortRules=t:this.internalProps.dataConfig={sortRules:t},this.dataset.updateSortRules(t),this._changePivotSortStateBySortRules();let{layoutMap:r}=this.internalProps;r.resetHeaderTree(),this.scenegraph.clearCells(),(0,p.Z)(e)&&(0,p.Z)(i)?(this.isRowHeader(e,i)?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):this.isCornerHeader(e,i)?"column"===r.cornerSetting.titleOnDimension?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):"row"===r.cornerSetting.titleOnDimension&&this.internalProps._heightResizedRowMap.clear():this.isColumnHeader(e,i)&&this.internalProps._heightResizedRowMap.clear(),this.refreshRowColCount()):this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(!0),this.render()}_changePivotSortStateBySortRules(){var t,e,i,n;this.pivotSortState=[];let l=null!=(e=null==(t=this.internalProps.dataConfig)?void 0:t.sortRules)?e:[];for(let t=0;t<l.length;t++){let e=l[t],s=[];if(e.sortByIndicator&&e.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])){for(let t=0;t<e.query.length;t++)s.push({dimensionKey:this.dataset.indicatorsAsCol?this.dataset.columns[t]:this.dataset.rows[t],value:e.query[t]});s.push({indicatorKey:e.sortByIndicator,value:null!=(n=null==(i=this.internalProps.layoutMap.getIndicatorInfo(e.sortByIndicator))?void 0:i.title)?n:e.sortByIndicator})}else s.push({dimensionKey:e.sortField,isPivotCorner:!0,value:e.sortField});let a=e.sortType?e.sortType.toUpperCase():"ASC";this.pivotSortState.push({dimensions:s,order:r.F[a]})}}updatePivotSortState(t){this.pivotSortState=t}sort(t,e,i){var n,l;let s;if(this.isCornerHeader(t,e)){let i=this.getHeaderDefine(t,e);s=[];let r={isPivotCorner:!0,dimensionKey:i.value,value:i.value};s.push(r)}else s=this.isColumnHeader(t,e)?this.getCellHeaderPaths(t,e).colHeaderPaths:this.getCellHeaderPaths(t,e).rowHeaderPaths;let a=s[s.length-1].indicatorKey,o=this.getHeaderDefine(t,e);if(o.sort){if(this.dataset.sortRules){let t={};for(let e=this.dataset.sortRules.length-1;e>=0;e--){let i=this.dataset.sortRules[e];(o.dimensionKey&&i.sortField===o.dimensionKey||a&&i.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1]))&&(t[i.sortField]=i,this.dataset.sortRules.splice(e,1))}if(a){let e=this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1];this.dataset.sortRules.push({sortField:e,sortType:r.F[i],sortByIndicator:a,query:s.reduce((t,e)=>(e.dimensionKey&&t.push(e.value),t),[]),sortFunc:null==(n=t[e])?void 0:n.sortFunc})}else this.dataset.sortRules.push(Object.assign(null!=(l=t[o.dimensionKey])?l:{},{sortField:o.dimensionKey,sortType:r.F[i]}))}else this.dataset.sortRules=a?[{sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:r.F[i],sortByIndicator:a,query:s.reduce((t,e)=>(e.dimensionKey&&t.push(e.value),t),[])}]:[{sortField:o.dimensionKey,sortType:r.F[i]}];this.updateSortRules(this.dataset.sortRules,t,e)}}getPivotSortState(t,e){if(!this.pivotSortState)return;let i=this.getCellRange(t,e);for(let t=0;t<this.pivotSortState.length;t++){let e=this.pivotSortState[t],r=e.dimensions,n=this.getCellAddressByHeaderPaths(r),l=e.order;if(n&&(0,h._Z)(i,n.col,n.row))return l}}_moveHeaderPosition(t,e){let i=this.getCellRange(t.col,t.row),r=this.getCellRange(e.col,e.row),n=this.internalProps.layoutMap.moveHeaderPosition(t,e);if(n){if("column"===n.moveType){if(this.internalProps.recordsIsTwoDimensionalArray)for(let t=0;t<this.internalProps.records.length;t++){let e=this.internalProps.records[t].splice(n.sourceIndex-this.rowHeaderLevelCount,n.sourceSize);e.unshift(n.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[t],e)}this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,r.start.col,r.end.col-r.start.col+1,n.targetIndex),this.setMinMaxLimitWidth()}else if("row"===n.moveType){if(this.internalProps.recordsIsTwoDimensionalArray){let t=this.internalProps.records.splice(n.sourceIndex-this.columnHeaderLevelCount,n.sourceSize);t.unshift(n.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,t)}n.targetIndex>n.sourceIndex?this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex+n.sourceSize-n.targetSize,n.targetSize,n.targetIndex):this.rowHeightsMap.exchangeOrder(n.sourceIndex,n.sourceSize,n.targetIndex,n.targetSize,n.targetIndex)}return n}return null}toggleHierarchyState(t,e,i=!0){this.internalProps.layoutMap.clearHeaderPathCache();let r=this.getHierarchyState(t,e);if(r===n.g.expand)this._refreshHierarchyState(t,e,i),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:n.g.collapse});else if(r===n.g.collapse){let r=this.internalProps.layoutMap.getHeadNode(t,e);Array.isArray(r.children)&&this._refreshHierarchyState(t,e,i),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:n.g.expand,originData:r})}}_refreshHierarchyState(t,e,i=!0,r){var n,l;this.frozenColCount,this.frozenRowCount;let s=this.getBodyVisibleRowRange().rowStart;this.internalProps._oldRowCount=this.rowCount,this.internalProps._oldColCount=this.colCount;let a=!1,o=!1;this.stateManager.updateHoverIcon(t,e,void 0,void 0);let h=this.internalProps.layoutMap.checkHasChart();h&&(this.autoFillWidth&&(a=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(o=this.getAllRowsHeight()<=this.tableNoFrameHeight));let d=this.internalProps.layoutMap.isRowHeader(t,e)?this.internalProps.layoutMap.toggleHierarchyState(t,e):this.internalProps.layoutMap.toggleHierarchyStateForColumnTree(t,e);r&&r(),this.refreshRowColCount(),this.frozenColCount,this.frozenRowCount,this.clearCellStyleCache(),"tree"===this.rowHierarchyType&&this.scenegraph.updateHierarchyIcon(t,e),null==(n=this.reactCustomLayout)||n.clearCache(),"grid-tree"!==this.rowHierarchyType&&"grid-tree"!==this.columnHierarchyType?this.scenegraph.updateRow(d.removeCellPositionsRowDirection,d.addCellPositionsRowDirection,d.updateCellPositionsRowDirection,i):(this.internalProps.stick.changedCells.clear(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.scrollToRow(s)),null==(l=this.reactCustomLayout)||l.updateAllCustomCell(),h&&(this.autoFillWidth&&!a&&(a=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!o&&(o=this.getAllRowsHeight()<=this.tableNoFrameHeight),("adaptive"===this.widthMode||a||"adaptive"===this.heightMode||o)&&this.scenegraph.updateChartSizeForResizeColWidth(-1)),this.internalProps._oldRowCount=void 0,this.internalProps._oldColCount=void 0}getHeaderCellAddressByPath(t){return this.internalProps.layoutMap.getPivotCellAdress(t)}getCellAddressByHeaderPaths(t){return this.internalProps.layoutMap.getCellAdressByHeaderPath(t)}getHeaderPathByXY(t){let e;return e=t?this.getCellAt(t.x+this.getFrozenColsWidth()+this.scrollLeft+1,t.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(e.col,e.row)}getHierarchyState(t,e){var i;return null==(i=this._getHeaderLayoutMap(t,e))?void 0:i.hierarchyState}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(t,e){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(t,e)}getMenuInfo(t,e,i){let r=this.internalProps.layoutMap.getPivotDimensionInfo(t,e);return{dimensionKey:r[r.length-1].dimensionKey,value:this.getCellValue(t,e),cellLocation:this.getCellLocation(t,e),isPivotCorner:this.isCornerHeader(t,e),event:void 0}}setRecords(t){var e,i,r,n,s,o,h,d;(0,A.H6)();let u={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=t,this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(e=null==t?void 0:t[0])?void 0:e.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0);let c=this.options,p=this.internalProps;if(!1===(null==(i=this.options.customConfig)?void 0:i.enableDataAnalysis))!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new a({rows:p.layoutMap.fullRowDimensionKeys,columns:p.layoutMap.colDimensionKeys,indicators:p.layoutMap.indicatorKeys,indicatorsAsCol:p.layoutMap.indicatorsAsCol,indicatorDimensionKey:p.layoutMap.indicatorDimensionKey},t));else{let e,i;this.dataset.setRecords(t),c.columnTree?e=p.layoutMap.columnDimensionTree:(!1!==c.indicatorsAsCol&&c.indicators&&this.dataset.colHeaderTree&&(0,w.uu)(this.dataset.colHeaderTree,c.indicators,!1,this),e=new f.KO(null!=(r=this.dataset.colHeaderTree)?r:[],this.layoutNodeId,this.options.columnHierarchyType,"grid"!==this.options.columnHierarchyType?null!=(n=this.options.columnExpandLevel)?n:1:void 0)),c.rowTree?i=p.layoutMap.rowDimensionTree:(!1===c.indicatorsAsCol&&this.dataset.rowHeaderTree&&c.indicators&&(0,w.uu)(this.dataset.rowHeaderTree,c.indicators,!1,this),i=new f.KO(null!=(s=this.dataset.rowHeaderTree)?s:[],this.layoutNodeId,this.options.rowHierarchyType,"grid"!==this.options.rowHierarchyType?null!=(o=this.options.rowExpandLevel)?o:1:void 0)),p.layoutMap=new l.z(this,this.dataset,e,i),this.pivotSortState=[],c.pivotSortState&&(this.pivotSortState=c.pivotSortState)}if(this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(u.col,u.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder(),this.options.emptyTip)if(this.internalProps.emptyTip)null==(h=this.internalProps.emptyTip)||h.resetVisible();else{let t=S.F.getComponent("emptyTip");this.internalProps.emptyTip=new t(this.options.emptyTip,this),null==(d=this.internalProps.emptyTip)||d.resetVisible()}}startEditCell(t,e,i){var r;if((0,s.Z)(t)&&(0,s.Z)(e))this.eventManager.isDraging=!1,this.selectCell(t,e),this.editorManager.startEditCell(t,e,i);else if(null==(r=this.stateManager.select)?void 0:r.cellPos){let{col:t,row:e}=this.stateManager.select.cellPos;(0,s.Z)(t)&&(0,s.Z)(e)&&this.editorManager.startEditCell(t,e,i)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(t,e){var i,r,n;let l,s=this.editorManager.cacheLastSelectedCellEditor[`${t}-${e}`];if(s)return s;if(Object.values(this.editorManager.cacheLastSelectedCellEditor).forEach(t=>{var e;return null==(e=null==t?void 0:t.onEnd)?void 0:e.call(t)}),this.editorManager.cacheLastSelectedCellEditor={},this.isCornerHeader(t,e)){let r=this.getHeaderDefine(t,e);l=null!=(i=null==r?void 0:r.headerEditor)?i:this.options.headerEditor}else if(this.isHeader(t,e)){let i=this.getHeaderDefine(t,e);l=null!=(r=null==i?void 0:i.headerEditor)?r:this.options.headerEditor}else{let i=this.getBodyColumnDefine(t,e);l=null!=(n=null==i?void 0:i.editor)?n:this.options.editor}return"function"==typeof l&&(l=l({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),"string"==typeof l&&(l=v.U(l)),l&&(this.editorManager.cacheLastSelectedCellEditor[`${t}-${e}`]=l),l}isHasEditorDefine(t,e){var i;let r=this.getBodyColumnDefine(t,e),n=null!=(i=null==r?void 0:r.editor)?i:this.options.editor;return"function"==typeof n&&(n=n({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),(0,s.Z)(n)}changeCellValue(t,e,i,r=!1){var n,l;if(r&&this.isHasEditorDefine(t,e)||!1===r){let r=i,s=this.getCellOriginValue(t,e),a=this.getCellRawValue(t,e);"number"==typeof a&&(0,C.Zf)(i)&&(r=parseFloat(i)),this._changeCellValueToDataSet(t,e,s,r);let o=this.getCellRange(t,e);for(let t=o.start.col;t<=o.end.col;t++)for(let e=o.start.row;e<=o.end.row;e++)this.scenegraph.updateCellContent(t,e);if(null!=(l=null==(n=this.options.dataConfig)?void 0:n.updateAggregationOnEditCell)&&l)for(let t=0;t<this.colCount;t++)for(let e=0;e<this.rowCount;e++)this.internalProps.layoutMap.isAggregation(t,e)&&this.scenegraph.updateCellContent(t,e);if("adaptive"===this.widthMode||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)0===this.internalProps._widthResizedColMap.size&&this.scenegraph.recalculateColWidths();else if(!this.internalProps._widthResizedColMap.has(t)){let e=this.getColWidth(t),i=(0,b.al)(t,0,this.rowCount-1,this,!1);i!==e&&this.scenegraph.updateColWidth(t,i-e)}if("adaptive"===this.heightMode||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)0===this.internalProps._heightResizedRowMap.size&&this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight(e)&&!this.internalProps._heightResizedRowMap.has(e)){let t=this.getRowHeight(e),i=(0,_.P)(e,0,this.colCount-1,this);this.scenegraph.updateRowHeight(e,i-t)}s!==r&&this.fireListeners(m.B.CHANGE_CELL_VALUE,{col:t,row:e,rawValue:a,currentValue:s,changedValue:r}),this.scenegraph.updateNextFrame()}}changeCellValues(t,e,i,r=!1){var n,l;let s=t,a=e,o=[],h=[];for(let r=0;r<i.length&&!(e+r>this.rowCount-1);r++){let n=i[r],l=[],s=[];o.push(l),h.push(s);for(let i=0;i<n.length&&!(t+i>this.colCount-1);i++){let n=this.getCellRawValue(t+i,e+r);l.push(n);let a=this.getCellOriginValue(t+i,e+r);s.push(a)}}for(let n=0;n<i.length&&!(e+n>this.rowCount-1);n++){a=e+n;let l=i[n],d=t;for(let i=0;i<l.length&&!(t+i>this.colCount-1);i++)if(d=t+i,r&&this.isHasEditorDefine(t+i,e+n)||!1===r){let r=l[i],s=r,a=h[n][i],d=o[n][i];"number"==typeof d&&(0,C.Zf)(r)&&(s=parseFloat(r)),this._changeCellValueToDataSet(t+i,e+n,a,s);let u=this.getCellOriginValue(t+i,e+n);u!==a&&this.fireListeners(m.B.CHANGE_CELL_VALUE,{col:t+i,row:e+n,rawValue:d,currentValue:a,changedValue:u})}s=Math.max(s,d)}let d=this.getCellRange(t,e),u=this.getCellRange(s,a);for(let t=d.start.col;t<=u.end.col;t++)for(let e=d.start.row;e<=u.end.row;e++)this.scenegraph.updateCellContent(t,e);if(null!=(l=null==(n=this.options.dataConfig)?void 0:n.updateAggregationOnEditCell)&&l)for(let t=0;t<this.colCount;t++)for(let e=0;e<this.rowCount;e++)this.internalProps.layoutMap.isAggregation(t,e)&&this.scenegraph.updateCellContent(t,e);if("adaptive"===this.widthMode||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)0===this.internalProps._widthResizedColMap.size&&this.scenegraph.recalculateColWidths();else for(let e=t;e<=u.end.col;e++)if(!this.internalProps._widthResizedColMap.has(e)){let t=this.getColWidth(e),i=(0,b.al)(e,0,this.rowCount-1,this,!1);i!==t&&this.scenegraph.updateColWidth(e,i-t)}if("adaptive"===this.heightMode||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight(e)){let t=[],i=[];for(let r=e;r<=u.end.row;r++)if(this.rowHeightsMap.get(r)){let e=this.getRowHeight(r),n=(0,_.P)(r,0,this.colCount-1,this);t.push(r),i.push(n-e)}this.scenegraph.updateRowsHeight(t,i)}this.scenegraph.updateNextFrame()}_changeCellValueToDataSet(t,e,i,r){var n,l,s,a,o,h,d,u;if(this.internalProps.recordsIsTwoDimensionalArray){let i=this.getBodyIndexByRow(e),n=this.getBodyIndexByCol(t);this.records[i][n]=r}else if(this.dataset){let h=this.internalProps.layoutMap.getCellHeaderPaths(t,e);if(this.isCornerHeader(t,e))this.internalProps.layoutMap.changeCornerTitle(t,e,r);else if(this.isHeader(t,e))this.internalProps.layoutMap.changeTreeNodeTitle(t,e,r),this.isCornerHeader(t,e)||this.dataset.changeRecordFieldValue((null==(n=h.colHeaderPaths)?void 0:n.length)?null!=(l=h.colHeaderPaths[h.colHeaderPaths.length-1].indicatorKey)?l:h.colHeaderPaths[h.colHeaderPaths.length-1].dimensionKey:null!=(s=h.rowHeaderPaths[h.rowHeaderPaths.length-1].indicatorKey)?s:h.rowHeaderPaths[h.rowHeaderPaths.length-1].dimensionKey,i,r);else{let i=null==(a=h.colHeaderPaths)?void 0:a.filter(t=>!t.virtual).map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),n=null==(o=h.rowHeaderPaths)?void 0:o.filter(t=>!t.virtual).map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value});this.dataset.changeTreeNodeValue(this.internalProps.layoutMap.indicatorsAsCol?n:n.slice(0,-1),this.internalProps.layoutMap.indicatorsAsCol?i.slice(0,-1):i,this.internalProps.layoutMap.getIndicatorKey(t,e),r)}}else if(this.flatDataToObjects){let n=this.internalProps.layoutMap.getCellHeaderPaths(t,e);if(this.isHeader(t,e))this.internalProps.layoutMap.changeTreeNodeTitle(t,e,r),this.isCornerHeader(t,e)||this.flatDataToObjects.changeRecordFieldValue((null==(h=n.colHeaderPaths)?void 0:h.length)?null!=(d=n.colHeaderPaths[n.colHeaderPaths.length-1].indicatorKey)?d:n.colHeaderPaths[n.colHeaderPaths.length-1].dimensionKey:null!=(u=n.rowHeaderPaths[n.rowHeaderPaths.length-1].indicatorKey)?u:n.rowHeaderPaths[n.rowHeaderPaths.length-1].dimensionKey,i,r);else{let i=n.colHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value}),l=n.rowHeaderPaths.map(t=>{var e;return null!=(e=t.indicatorKey)?e:t.value});this.flatDataToObjects.changeTreeNodeValue(l,i,this.internalProps.layoutMap.getBody(t,e).indicatorKey,r)}}}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;let{columnsDefine:t,rowsDefine:e,indicatorsDefine:i}=this.internalProps.layoutMap;for(let e=0;e<t.length;e++){let i=t[e];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let t=0;t<e.length;t++){let i=e[t];if("string"!=typeof i&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let t=0;t<i.length;t++){let e=i[t];if("string"!=typeof e&&(e.customLayout||e.headerCustomLayout||e.customRender||e.headerCustomRender))return!0}return!1}changeRecordOrder(t,e){}setTreeNodeChildren(t,e,i,r){this.flatDataToObjects?(this.internalProps.layoutMap.getHeadNode(i,r).children=t,this._refreshHierarchyState(i,r,!0,()=>{this.flatDataToObjects.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey}),this.flatDataToObjects.addRecords(e)})):(this.internalProps.layoutMap.getHeadNode(i,r).children=t,this._refreshHierarchyState(i,r,!0,()=>{this.dataset._rowTreeHasChanged(),this.dataset.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys}),this.dataset.addRecords(e)}))}updateFilterRules(t,e=!1){this.internalProps.dataConfig.filterRules=t,e?(this.dataset.updateFilterRules(t,!0),this.internalProps.layoutMap.resetHeaderTree()):this.dataset.updateFilterRules(t),this.renderWithRecreateCells()}getFilteredRecords(){var t;return null==(t=this.dataset)?void 0:t.filteredRecords}getCellPivotRole(t,e){let{cellLocation:i,colHeaderPaths:r,rowHeaderPaths:n}=this.getCellHeaderPaths(t,e),l=r.length?"normal":void 0,s=n.length?"normal":void 0;return r.forEach(t=>{"sub-total"===t.role?l="sub-total":"grand-total"===t.role&&(l="grand-total")}),n.forEach(t=>{"sub-total"===t.role?s="sub-total":"grand-total"===t.role&&(s="grand-total")}),{colRole:l,rowRole:s,cellLocation:i}}getCellRowHeaderFullPaths(t){return this.internalProps.layoutMap.getCellRowHeaderFullPaths(t)}setLoadingHierarchyState(t,e){this.scenegraph.setLoadingHierarchyState(t,e)}expandAllForRowTree(){"tree"!==this.rowHierarchyType&&"grid-tree"!==this.rowHierarchyType||this.internalProps.layoutMap.rowDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.expandAllForRowDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:n.g.expand,changeAll:!0}))}collapseAllForRowTree(){"tree"!==this.rowHierarchyType&&"grid-tree"!==this.rowHierarchyType||this.internalProps.layoutMap.rowDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.collapseAllForRowDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:n.g.collapse,changeAll:!0}))}expandAllForColumnTree(){"grid-tree"===this.columnHierarchyType&&this.internalProps.layoutMap.columnDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.expandAllForColumnDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:n.g.expand,changeAll:!0}))}collapseAllForColumnTree(){"grid-tree"===this.columnHierarchyType&&this.internalProps.layoutMap.columnDimensionTree&&(this.internalProps.layoutMap.clearHeaderPathCache(),this.internalProps.layoutMap.collapseAllForColumnDimensionTree(),this.renderWithRecreateCells(),this.fireListeners(o.z.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:n.g.collapse,changeAll:!0}))}release(){var t;this.internalProps.layoutMap.clearHeaderPathCache(),null==(t=this.editorManager)||t.release(),super.release()}}},34088:function(t,e,i){i.d(e,{U:()=>s,f:()=>n});var r=i(23975);let n={},l={};function s(){return(0,r.l7)(l,n)}},27781:function(t,e,i){i.d(e,{$M:()=>d,UP:()=>p,Zu:()=>u,b8:()=>c,iR:()=>h,sG:()=>g});var r=i(20408),n=i(54326),l=i(15215),s=i(9762),a=i(86001);let o={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}},h="PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",d=14,u={FONT_FAMILY:h,LABEL_FONT_SIZE:14,MAP_LABEL_FONT_SIZE:10,TITLE_FONT_SIZE:18,AXIS_TICK_SIZE:4},c={domainLine:{visible:!0,style:{lineWidth:0,stroke:"#D9DDE4",strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,tickSize:u.AXIS_TICK_SIZE,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,tickSize:u.AXIS_TICK_SIZE/2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},label:{visible:!0,space:1,style:{fontSize:u.LABEL_FONT_SIZE,fill:"#89909D",fontWeight:"normal",fillOpacity:1},autoLimit:!0},title:{space:10,style:{fontSize:u.LABEL_FONT_SIZE,fill:"#333333",fontWeight:"normal",fillOpacity:1}}};function p(t){var e,i;return(null==(i=null==(e=null==t?void 0:t.colorScheme)?void 0:e.default)?void 0:i.palette)?(0,r.Z)({},c,{tick:{style:{stroke:t.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},subTick:{style:{stroke:t.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},label:{style:{fill:t.colorScheme.default.palette.axisLabelFontColor||"#89909D"}},title:{style:{fill:t.colorScheme.default.palette.secondaryFontColor||"#333333"}}}):c}function g(t){var e,i,h,d,u,c,p,g,f,m,y,v,b;let _=(0,r.Z)({},t);t.labelHoverOnAxis&&!1===_.domainLine.visible&&(_.domainLine.style.lineWidth=0,_.domainLine.visible=!0);let C,x=null!=(i=null==(e=_.title)?void 0:e.angle)?i:0;"left"!==_.orient&&"right"!==_.orient||(null==(h=_.title)?void 0:h.autoRotate)&&(0,n.Z)(_.title.angle)&&(x="left"===_.orient?-90:90,C=o[_.orient]);let w=(0,l.Z)(_.label,["style","formatMethod","state"]);return{orient:_.orient,select:_.select,hover:_.hover,line:(0,a.lc)(_.domainLine),label:Object.assign({style:(0,a.h_)(_.label.style),formatMethod:_.label.formatMethod?(t,e,i)=>_.label.formatMethod(e.rawValue,e):null,state:(0,a.Zv)(_.label.state)},w),tick:{visible:_.tick.visible,length:_.tick.tickSize,inside:_.tick.inside,alignWithLabel:_.tick.alignWithLabel,style:(0,a.h_)(_.tick.style),state:(0,a.Zv)(_.tick.state),dataFilter:_.tick.dataFilter},subTick:{visible:_.subTick.visible,length:_.subTick.tickSize,inside:_.subTick.inside,count:_.subTick.tickCount,style:(0,a.h_)(_.subTick.style),state:(0,a.Zv)(_.subTick.state)},grid:{type:"line",visible:_.grid.visible,alternateColor:_.grid.alternateColor,alignWithLabel:_.grid.alignWithLabel,style:(0,a.h_)(_.grid.style)},subGrid:{type:"line",visible:_.subGrid.visible,alternateColor:_.subGrid.alternateColor,style:(0,a.h_)(_.subGrid.style)},title:{visible:_.title.visible,position:_.title.position,space:_.title.space,autoRotate:!1,angle:x?(0,s.M4)(x):null,textStyle:(0,r.Z)({},C,(0,a.h_)(_.title.style)),padding:_.title.padding,shape:{visible:null==(d=_.title.shape)?void 0:d.visible,space:null==(u=_.title.shape)?void 0:u.space,style:(0,a.h_)(null==(c=_.title.shape)?void 0:c.style)},background:{visible:null==(p=_.title.background)?void 0:p.visible,style:(0,a.h_)(null==(g=_.title.background)?void 0:g.style)},state:{text:(0,a.Zv)(_.title.state),shape:(0,a.Zv)(null==(f=_.title.shape)?void 0:f.state),background:(0,a.Zv)(null==(m=_.title.background)?void 0:m.state)}},panel:{visible:null==(y=_.background)?void 0:y.visible,style:(0,a.h_)(null==(v=_.background)?void 0:v.style),state:(0,a.Zv)(null==(b=_.background)?void 0:b.state)},labelHoverOnAxis:_.labelHoverOnAxis}}},59779:function(t,e,i){i.d(e,{Mh:()=>tj,Eg:()=>tz,ph:()=>tG,FD:()=>tZ,_t:()=>tN,R2:()=>tD,I:()=>tW});var r=i(31877),n=i(73508),l=i(20408),s=i(89530),a=i(54326),o=i(9762),h=i(1769),d=i(27781);function u(t){return"bottom"===t||"top"===t}var c=i(68390),p=i(95723);class g{constructor(){this._scale=new c.j,this._scales=[this._scale]}valueToPosition(t){return this._scale.scale(t)}getPosition(t){let e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{let r=Math.min(t.length,this._scales.length);for(let i=0;i<r;i++)e+=this._scales[i].scale(t[i]);i=this._scales[r-1]}return{position:e,bandScale:i}}calcScales(t,e){var i,r;let{bandPadding:n,paddingInner:l,paddingOuter:s}=this,a=(0,p.Z)(n),o=(0,p.Z)(l),h=(0,p.Z)(s);for(let d=0;d<this._scales.length;d++){let u=a?n[d]:n,c=o?l[d]:l,p=h?s[d]:s;this._scales[d].paddingInner(null!=(i=null!=c?c:u)?i:t,!0).paddingOuter(null!=(r=null!=p?p:u)?r:e)}}dataToPosition(t,e={}){var i;if(0===t.length||0===this._scales.length)return 0;let{position:r,bandScale:n}=this.getPosition(t);return r+n.bandwidth()*(null!=(i=e.bandPosition)?i:.5)}updateScaleDomain(t){for(let e=0;e<this._scales.length;e++)this._scales[e].domain(t)}updateRange(t){let[e,i]=this._scale.range();t[0]===e&&t[1]===i||this._scale.range(t)}}var f=i(99127),m=i(28919),y=i(31820),v=i(65880),b=i(1466),_=i(10145),C=i(64776),x=i(99051);let w=Math.sqrt(50),S=Math.sqrt(10),A=Math.sqrt(2);class M{constructor(t){this._extend={},this.type=null!=t?t:"linear",this._scale="log"===t?new v.Y:"symlog"===t?new b.g:new _.f,this._scales=[this._scale]}setExtraAttrFromSpec(t,e,i,r,n,l){this.nice=!1,this.zero=e,this.zero&&(i.min=Math.min(i.min,0),i.max=Math.max(i.max,0)),this.domain=i,this.expand=r,"log"===this.type?this._scale.base(null!=n?n:10):"symlog"===this.type&&this._scale.constant(null!=l?l:10)}transformScaleDomain(){"symlog"===this.type||"log"===this.type||this.setScaleNice()}setScaleNice(){"log"===this.type?this.setLogScaleNice():this.setLinearScaleNice()}setLogScaleNice(){var t,e,i,r,n,l;(0,a.Z)(null==(t=this.domain)?void 0:t.min)&&(0,a.Z)(null==(e=this.domain)?void 0:e.max)?this.nice&&this._scale.nice():(0,C.Z)(null==(i=this.domain)?void 0:i.min)&&(0,a.Z)(null==(r=this.domain)?void 0:r.max)?this.nice&&this._scale.niceMax():(0,a.Z)(null==(n=this.domain)?void 0:n.min)&&(0,C.Z)(null==(l=this.domain)?void 0:l.max)&&this.nice&&this._scale.niceMin()}setLinearScaleNice(){var t,e,i,r,n,l,s,o;let h=null!=(e=null!=(t=this.forceTickCount)?t:this.tickCount)?e:10;"accurateFirst"===this.niceType&&(h=Math.max(10,h)),(0,a.Z)(null==(i=this.domain)?void 0:i.min)&&(0,a.Z)(null==(r=this.domain)?void 0:r.max)?this.nice&&this._scale.nice(h):(0,C.Z)(null==(n=this.domain)?void 0:n.min)&&(0,a.Z)(null==(l=this.domain)?void 0:l.max)?this.nice&&this._scale.niceMax(h):(0,a.Z)(null==(s=this.domain)?void 0:s.min)&&(0,C.Z)(null==(o=this.domain)?void 0:o.max)?this.nice&&this._scale.niceMin(h):this.nice&&this._scale.nice(h)}dataToPosition(t){return this.valueToPosition(t[0])}valueToPosition(t){return this._scale.scale(t)}computeLinearDomain(t){let e=[];return t.forEach(t=>{let{min:i,max:r}=t;e[0]=void 0===e[0]?i:Math.min(e[0],i),e[1]=void 0===e[1]?r:Math.max(e[1],r)}),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e}expandDomain(t){if(!this.expand)return;let e=t[0],i=t[t.length-1];(0,C.Z)(this.expand.min)&&(t[0]=e-(i-e)*this.expand.min),(0,C.Z)(this.expand.max)&&(t[t.length-1]=i+(i-e)*this.expand.max)}niceDomain(t){if((0,C.Z)(t[0])||(0,C.Z)(t[1])||"linear"!==this.type)return t;if(1e-12>=Math.abs((0,x.iH)(t)-(0,x.CE)(t))){let e=t[0],i=e>=0?1:-1;if((e=Math.abs(e))<1)t[0]=0,t[1]=1;else{let i=e/5,r=Math.floor(Math.log(i)/Math.LN10),n=i/Math.pow(10,r);i=(n>=w?10:n>=S?5:n>=A?2:1)*Math.pow(10,r),t[0]=0,t[1]=10*i}i<0&&(t.reverse(),t[0]*=-1,t[1]*=-1)}return t}niceMinMax(){var t,e,i,r,n,l,s,o;if(this.nice){let h=null!=(e=null!=(t=this.forceTickCount)?t:this.tickCount)?e:10;"accurateFirst"===this.niceType&&(h=Math.max(10,h)),(0,a.Z)(null==(i=this.domain)?void 0:i.min)&&(0,a.Z)(null==(r=this.domain)?void 0:r.max)?this._scale.nice(h):(0,C.Z)(null==(n=this.domain)?void 0:n.min)&&(0,a.Z)(null==(l=this.domain)?void 0:l.max)?this._scale.niceMax(h):(0,a.Z)(null==(s=this.domain)?void 0:s.min)&&(0,C.Z)(null==(o=this.domain)?void 0:o.max)?this._scale.niceMin(h):this._scale.nice(h)}}includeZero(t){this.zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(t[t.length-1],0))}setExtendDomain(t,e){if(void 0===e)return void delete this._extend[t];this._extend[t]=e;let i=this._scale.domain();this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this.nice),this.niceMinMax()}extendDomain(t){let e,i=t.length-1,r=t[0]-t[i]>0,n=r?i:0,l=r?0:i;for(let i in this._extend)(e=this._extend[i])>t[l]&&(t[l]=e),e<t[n]&&(t[n]=e)}setDomainMinMax(t){if(!this.domain)return;let{min:e,max:i}=this.domain;(0,C.Z)(e)&&(t[0]=e),(0,C.Z)(i)&&(t[1]=i)}setZero(t){this.zero!==t&&(this.zero=t,this.updateScaleDomain())}updateScaleDomain(){let t=this.computeDomain([this.domain]);this.updateScaleDomainByModel(t)}computeDomain(t){return this.computeLinearDomain(t)}updateScaleDomainByModel(t){t=null!=t?t:this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this.nice),this.niceMinMax()}updateRange(t){let[e,i]=this._scale.range();t[0]===e&&t[1]===i||this._scale.range(t)}}var T=i(44843);function k(t,e){var i;let r=e.option;(0,T.Z)(t)||(null==(i=null==r?void 0:r.label)?void 0:i.flush)&&function(t,e){let{width:i,height:r}=e.getLayoutRect(),n=u(e.orient),l=!0===e.option.inverse,s=t[0],a=(0,x.Z$)(t);if(n)if(l){let t=s.AABBBounds.x2,e=a.AABBBounds.x1;t>i&&s.setAttributes({x:i,textAlign:"right"}),e<0&&a.setAttributes({x:0,textAlign:"left"})}else{let t=s.AABBBounds.x1,e=a.AABBBounds.x2;t<0&&s.setAttributes({x:0,textAlign:"left"}),e>i&&a.setAttributes({x:i,textAlign:"right"})}else if(l){let t=s.AABBBounds.y1,e=a.AABBBounds.y2;t<0&&s.setAttributes({y:0,textBaseline:"top"}),e>r&&a.setAttributes({y:r,textBaseline:"bottom"})}else{let t=s.AABBBounds.y2,e=a.AABBBounds.y1;t>r&&s.setAttributes({y:r,textBaseline:"bottom"}),e<0&&a.setAttributes({y:0,textBaseline:"top"})}}(t,e)}let R=t=>t;class P{constructor(t,e,i,r,n){var s,a,o,h,u,c,p,g,f;(this.x=0,this.y=0,this.bodyChartCellPadding=r,this.table=n,this.orient=null!=(s=t.orient)?s:"left",this.type=null!=(a=t.type)?a:"band",this.option=(0,l.Z)({},(0,d.UP)(t.__vtableChartTheme),B(this.orient,n.theme),function(t,e,i){let r,n;if(!i)return{};let s=i.axis;return"linear"===e||"log"===e||"symlog"===e?r=i.axisLinear:"band"===e&&(r=i.axisBand),"top"===t||"bottom"===t?n=i.axisX:"left"!==t&&"right"!==t||(n=i.axisY),(0,l.Z)({},s,r,n)}(this.orient,this.type,t.__vtableChartTheme),t),"left"===this.orient||"right"===this.orient)?("left"===this.orient&&(this.x=null!=(o=this.option.cellPaddingLeft)?o:0,this.width=e-(null!=(h=this.option.cellPaddingLeft)?h:0)),"right"===this.orient&&(this.x=0,this.width=e-(null!=(u=this.option.cellPaddingRight)?u:0)),this.height=i-r[0]-r[2]-0,this.y=r[0]+0):("top"===this.orient||"bottom"===this.orient)&&(this.width=e-r[1]-r[3]-0,this.x=r[3]+0,"top"===this.orient&&(this.y=null!=(c=this.option.cellPaddingTop)?c:0,this.height=i-(null!=(p=this.option.cellPaddingTop)?p:0)),"bottom"===this.orient&&(this.y=0,this.height=i-(null!=(g=this.option.cellPaddingBottom)?g:0))),this.visible=null==(f=t.visible)||f,this.inverse="inverse"in t&&!!t.inverse,"band"===t.type&&(this.data=t.domain),this.initScale(),this.initData(),this.createComponent(),this.initEvent()}initScale(){let t=this.option;"band"===this.type||"point"===this.type?(this.scale=new g,this.scale.bandPadding=t.bandPadding,this.scale.paddingInner=t.paddingInner,this.scale.paddingOuter=t.paddingOuter,this.scale.calcScales(.1,.3),this.scale.updateScaleDomain(this.data),this.updateScaleRange()):"linear"!==this.type&&"time"!==this.type&&"log"!==this.type&&"symlog"!==this.type||(this.scale=new M(this.type),this.scale.setExtraAttrFromSpec(t.nice,t.zero,t.range,t.expand,t.base,t.constant),this.scale.transformScaleDomain(),this.scale.updateScaleDomain(),this.updateScaleRange())}initData(){var t,e,i,r,n;this.table._vDataSet||(this.table._vDataSet=new f.q),t=this.table._vDataSet,e="scale",t.getParser(e)||t.registerParser(e,R),i=this.table._vDataSet,r="ticks",n=y.s,i.getTransform(r)||i.registerTransform(r,n);let l=this.option.label||{},s=this.option.tick||{},a=new m.V(this.table._vDataSet).parse(this.scale._scale,{type:"scale"}).transform({type:"ticks",options:{sampling:!1!==this.option.sampling,tickCount:s.tickCount,forceTickCount:s.forceTickCount,tickStep:s.tickStep,tickMode:s.tickMode,noDecimals:s.noDecimals,axisOrientType:this.orient,coordinateType:"cartesian",labelStyle:l.style,labelFormatter:l.formatMethod,labelGap:l.minGap,labelLastVisible:l.lastVisible,labelFlush:l.flush}},!1);this.tickData=a,this.computeData()}computeData(){this.tickData.reRunAllTransform()}initEvent(){}createComponent(){let t=(0,d.sG)(this.option),e=this.getUpdateAttribute();e.verticalFactor="top"===this.orient||"right"===this.orient?-1:1,this.component=new h.$((0,l.Z)({disableTriggerEvent:this.table.options.disableInteraction},t,e)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.component.originAxis=this}resize(t,e){var i,r,n,s;"left"===this.orient?this.width=t-(null!=(i=this.option.cellPaddingLeft)?i:0):"right"===this.orient?this.width=t-(null!=(r=this.option.cellPaddingRight)?r:0):"top"!==this.orient&&"bottom"!==this.orient||(this.width=t-(this.bodyChartCellPadding[1]+this.bodyChartCellPadding[3])),"top"===this.orient?this.height=e-(null!=(n=this.option.cellPaddingTop)?n:0):"bottom"===this.orient?this.height=e-(null!=(s=this.option.cellPaddingBottom)?s:0):"left"!==this.orient&&"right"!==this.orient||(this.height=e-(this.bodyChartCellPadding[2]+this.bodyChartCellPadding[0])),this.updateScaleRange(),this.computeData();let a=(0,d.sG)(this.option),o=this.getUpdateAttribute();o.verticalFactor="top"===this.orient||"right"===this.orient?-1:1,this.component.setAttributes((0,l.Z)({},a,o)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.overlap()}overlap(){!function(t,e){let i=t.find(t=>"axis-label-container-layer-0"===t.name,!0),r=t.find(t=>"axis-label-container-layer-1"===t.name,!0);k(i?i.getChildren():[],e),k(r?r.getChildren():[],e)}(this.component,this)}getLayoutRect(){return{width:this.width,height:this.height}}getUpdateAttribute(){var t;this.table.tableNoFrameHeight,this.table.tableNoFrameWidth;let{width:e,height:i}=this.getLayoutRect(),r=u(this.orient),n="left"===(t=this.orient)||"right"===t,l={x:0,y:0},s=0;r?(l={x:e,y:0},s=e):n&&(l={x:0,y:i},s=i);let a="top"===this.orient||"bottom"===this.orient?i:e;return{start:{x:0,y:0},end:l,title:{text:this.option.title.text,maxWidth:this._getTitleLimit(r)},items:this.getLabelItems(s),verticalLimitSize:a,verticalMinSize:a}}getLabelItems(t){return[this.tickData.latestData.map(e=>({id:e.value,label:e.value,value:0===t?0:this.scale.dataToPosition([e.value])/t,rawValue:e.value})).filter(t=>t.value>=0&&t.value<=1)]}updateScaleRange(){var t,e,i,r,n,l,a,o;let h=null!=(e=null==(t=this.option.innerOffset)?void 0:t.right)?e:0,d=null!=(r=null==(i=this.option.innerOffset)?void 0:i.left)?r:0,c=null!=(l=null==(n=this.option.innerOffset)?void 0:n.top)?l:0,p=null!=(o=null==(a=this.option.innerOffset)?void 0:a.bottom)?o:0,{width:g,height:f}=this.getLayoutRect(),m=this.option.inverse||!1,y=[0,0];u(this.orient)?(0,s.Z)(g)&&(y=m?[g-h,d]:[d,g-h]):(0,s.Z)(f)&&(y=m?[c,f-p]:[f-p,c]),this.scale.updateRange(y)}setLayoutStartPosition(t){let{x:e,y:i}=t;return(0,s.Z)(e)&&(e+=Number("left"===this.orient)*this.getLayoutRect().width),(0,s.Z)(i)&&(i+=Number("top"===this.orient)*this.getLayoutRect().height),{x:e,y:i}}_getTitleLimit(t){var e,i,r;if(this.option.title.visible&&(0,a.Z)(null==(e=this.option.title.style)?void 0:e.maxLineWidth)){let e=(null==(i=this.option.title.style)?void 0:i.angle)||0;if((null==(r=this.option.title)?void 0:r.autoRotate)&&(0,a.Z)(this.option.title.angle)&&(e="left"===this.option.orient?-90:90),t){let t=this.getLayoutRect().width,i=Math.abs(Math.cos((0,o.M4)(e)));return i<1e-6?1/0:t/i}let n=this.getLayoutRect().height,l=Math.abs(Math.sin((0,o.M4)(e)));return l<1e-6?1/0:n/l}return null}getScale(){return this.scale._scale}getDomainSpec(){return this.scale.domain}}function B(t,e){let i;return"left"===t?i=e.axisStyle.leftAxisStyle:"right"===t?i=e.axisStyle.rightAxisStyle:"top"===t?i=e.axisStyle.topAxisStyle:"bottom"===t&&(i=e.axisStyle.bottomAxisStyle),(0,l.Z)({},e.axisStyle.defaultAxisStyle,i)}var I=i(96241),E=i(83624);function L(t,e){var i,r,n,s,a,o,h,u,c,g,f,m,y,v,b,_,C,x,w,S;let A=(0,l.Z)({},d.b8,t),M=0;!1!==A.tick.visible&&(M=null!=(i=A.tick.width)?i:4);let T=0;if(A.label.visible){if("band"===A.type)A.domain.forEach(t=>{var i,r,n,l,s,a,o,h,u,c,p,g,f,m,y,v;A.label.formatMethod&&(t=A.label.formatMethod(t));let{width:b,height:_}=e.measureText(t,{fontSize:null!=(n=null==(r=null==(i=A.label)?void 0:i.style)?void 0:r.fontSize)?n:d.$M,fontWeight:null!=(a=null==(s=null==(l=A.label)?void 0:l.style)?void 0:s.fontWeight)?a:"normal",fontFamily:null!=(u=null==(h=null==(o=A.label)?void 0:o.style)?void 0:h.fontFamily)?u:d.iR}),C=(null==(p=null==(c=A.label)?void 0:c.style)?void 0:p.maxLineWidth)||1/0,x=(null!=(m=null==(f=null==(g=A.label)?void 0:g.style)?void 0:f.angle)?m:0)+90*("vertical"===(null==(v=null==(y=A.label)?void 0:y.style)?void 0:v.direction));T=Math.max(T,H(Math.min(b,C),_,x).width)});else{let i;if((null==(r=t.sync)?void 0:r.tickAlign)&&(0,I.Z)(null==(n=t.tick)?void 0:n.tickMode))i=t.tick.tickMode();else if((0,p.Z)(t.__ticksForVTable))i=t.__ticksForVTable;else{let t=A.range,e=Math.abs(t.min)>1?Math.round(t.min):t.min,r=Math.abs(t.max)>1?Math.round(t.max):t.max;i=[O(e),O(r)]}i.forEach(t=>{var i,r,n,l,s,a,o,h,u,c,p,g,f,m,y,v;A.label.formatMethod&&(t=A.label.formatMethod(t));let{width:b,height:_}=e.measureText(t,{fontSize:null!=(n=null==(r=null==(i=A.label)?void 0:i.style)?void 0:r.fontSize)?n:d.$M,fontWeight:null!=(a=null==(s=null==(l=A.label)?void 0:l.style)?void 0:s.fontWeight)?a:"normal",fontFamily:null!=(u=null==(h=null==(o=A.label)?void 0:o.style)?void 0:h.fontFamily)?u:d.iR}),C=(null==(p=null==(c=A.label)?void 0:c.style)?void 0:p.maxLineWidth)||1/0,x=(null!=(m=null==(f=null==(g=A.label)?void 0:g.style)?void 0:f.angle)?m:0)+90*("vertical"===(null==(v=null==(y=A.label)?void 0:y.style)?void 0:v.direction));T=Math.max(T,H(Math.min(b,C),_,x).width)})}T+=null!=(s=A.label.space)?s:4}let k=0;if(A.title.visible&&(0,E.Z)(A.title.text)){let{width:i,height:r}=e.measureText(A.title.text,{fontSize:null!=(h=null==(o=null==(a=A.title)?void 0:a.style)?void 0:o.fontSize)?h:d.$M,fontWeight:null!=(g=null==(c=null==(u=A.title)?void 0:u.style)?void 0:c.fontWeight)?g:"normal",fontFamily:null!=(y=null==(m=null==(f=A.title)?void 0:f.style)?void 0:m.fontFamily)?y:d.iR}),n=H(Math.min(i,(null==(b=null==(v=A.label)?void 0:v.style)?void 0:b.maxLineWidth)||1/0),r,null==(C=null==(_=A.title)?void 0:_.style)?void 0:C.angle);k=(("left"===t.orient||"right"===t.orient)&&A.title.autoRotate?n.height:n.width)+(null!=(x=A.title.space)?x:4)}let R=0,P=B(t.orient,e.theme);return"left"===t.orient?R=null!=(w=null==P?void 0:P.cellPaddingLeft)?w:0:"right"===t.orient&&(R=null!=(S=null==P?void 0:P.cellPaddingRight)?S:0),Math.ceil(M+T+k+R+1)}function F(t,e){var i,r,n,s,a,o,h,u,c,g,f,m,y,v,b,_,C,x,w,S;let A=(0,l.Z)({},d.b8,t),M=0;!1!==A.tick.visible&&(M=null!=(i=A.tick.width)?i:4);let T=0;if(A.label.visible){if("band"===A.type)A.domain.forEach(t=>{var i,r,n,l,s,a,o,h,u,c,p,g,f,m,y,v;A.label.formatMethod&&(t=A.label.formatMethod(t));let{width:b,height:_}=e.measureText(t,{fontSize:null!=(n=null==(r=null==(i=A.label)?void 0:i.style)?void 0:r.fontSize)?n:d.$M,fontWeight:null!=(a=null==(s=null==(l=A.label)?void 0:l.style)?void 0:s.fontWeight)?a:"normal",fontFamily:null!=(u=null==(h=null==(o=A.label)?void 0:o.style)?void 0:h.fontFamily)?u:d.iR}),C=(null==(p=null==(c=A.label)?void 0:c.style)?void 0:p.maxLineWidth)||1/0,x=(null!=(m=null==(f=null==(g=A.label)?void 0:g.style)?void 0:f.angle)?m:0)+90*("vertical"===(null==(v=null==(y=A.label)?void 0:y.style)?void 0:v.direction));T=Math.max(T,H(Math.min(b,C),_,x).height)});else{let i;if((null==(r=t.sync)?void 0:r.tickAlign)&&(0,I.Z)(null==(n=t.tick)?void 0:n.tickMode))i=t.tick.tickMode();else if((0,p.Z)(t.__ticksForVTable))i=t.__ticksForVTable;else{let t=A.range,e=Math.abs(t.min)>1?Math.round(t.min):t.min,r=Math.abs(t.max)>1?Math.round(t.max):t.max;i=[O(e),O(r)]}i.forEach(t=>{var i,r,n,l,s,a,o,h,u,c,p,g,f,m,y,v;A.label.formatMethod&&(t=A.label.formatMethod(t));let{width:b,height:_}=e.measureText(t,{fontSize:null!=(n=null==(r=null==(i=A.label)?void 0:i.style)?void 0:r.fontSize)?n:d.$M,fontWeight:null!=(a=null==(s=null==(l=A.label)?void 0:l.style)?void 0:s.fontWeight)?a:"normal",fontFamily:null!=(u=null==(h=null==(o=A.label)?void 0:o.style)?void 0:h.fontFamily)?u:d.iR}),C=(null==(p=null==(c=A.label)?void 0:c.style)?void 0:p.maxLineWidth)||1/0,x=(null!=(m=null==(f=null==(g=A.label)?void 0:g.style)?void 0:f.angle)?m:0)+90*("vertical"===(null==(v=null==(y=A.label)?void 0:y.style)?void 0:v.direction));T=Math.max(T,H(Math.min(b,C),_,x).height)})}T+=null!=(s=A.label.space)?s:4}let k=0;if(A.title.visible&&A.title.text){let{width:i,height:r}=e.measureText(A.title.text,{fontSize:null!=(h=null==(o=null==(a=A.title)?void 0:a.style)?void 0:o.fontSize)?h:d.$M,fontWeight:null!=(g=null==(c=null==(u=A.title)?void 0:u.style)?void 0:c.fontWeight)?g:"normal",fontFamily:null!=(y=null==(m=null==(f=A.title)?void 0:f.style)?void 0:m.fontFamily)?y:d.iR}),n=H(Math.min(i,(null==(b=null==(v=A.label)?void 0:v.style)?void 0:b.maxLineWidth)||1/0),r,null==(C=null==(_=A.title)?void 0:_.style)?void 0:C.angle);k=(("bottom"===t.orient||"top"===t.orient)&&A.title.autoRotate?n.width:n.height)+(null!=(x=A.title.space)?x:4)}let R=0,P=B(t.orient,e.theme);return"top"===t.orient?R=null!=(w=null==P?void 0:P.cellPaddingTop)?w:0:"bottom"===t.orient&&(R=null!=(S=null==P?void 0:P.cellPaddingBottom)?S:0),M+T+k+R+1}function O(t){return"number"!=typeof t&&(t=Number(t)),Number(t.toPrecision(1)).toString()}function H(t,e,i=0){let r=i*Math.PI/180,n=-t/2,l=-e/2,s=t/2,a=-e/2,o=t/2,h=e/2,d=-t/2,u=e/2,c={x:n*Math.cos(r)-l*Math.sin(r),y:n*Math.sin(r)+l*Math.cos(r)},p={x:s*Math.cos(r)-a*Math.sin(r),y:s*Math.sin(r)+a*Math.cos(r)},g={x:o*Math.cos(r)-h*Math.sin(r),y:o*Math.sin(r)+h*Math.cos(r)},f={x:d*Math.cos(r)-u*Math.sin(r),y:d*Math.sin(r)+u*Math.cos(r)},m=Math.min(c.x,p.x,g.x,f.x),y=Math.max(c.x,p.x,g.x,f.x),v=Math.min(c.y,p.y,g.y,f.y);return{width:y-m,height:Math.max(c.y,p.y,g.y,f.y)-v}}var D=i(48530),z=i(75133),W=i(63401);class Z{constructor(t,e){this._emptyTipOption={spaceBetweenTextAndIcon:20,text:"no data",textStyle:{fontSize:14,color:"#000"},icon:{image:'<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>',width:100,height:100}},this.isReleased=!1,this.table=e,this._emptyTipOption=Object.assign(this._emptyTipOption,!0===t?{}:t),(0,C.Z)(this._emptyTipOption.displayMode)||(this.table.isListTable()?this._emptyTipOption.displayMode="basedOnTable":this._emptyTipOption.displayMode="basedOnContainer"),this._emptyTipComponent=this._createOrUpdateEmptyTipComponent(this._getEmptyTipAttrs())}_createOrUpdateEmptyTipComponent(t){if(this._emptyTipComponent)(0,z.X)(t,this._cacheAttrs)||this._emptyTipComponent.setAttributes(t);else{let e=new D.S(t);e.name="emptyTip",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._emptyTipComponent=e,this.bindEvents()}return this._emptyTipComponent}bindEvents(){this._emptyTipComponent.on("click",t=>{let e=new W.FB;this._emptyTipComponent.forEachChildren(t=>{e.union(t.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_click",t)}),this._emptyTipComponent.on("dblclick",t=>{let e=new W.FB;this._emptyTipComponent.forEachChildren(t=>{e.union(t.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_dblclick",t)})}resize(){var t;if(!this._emptyTipComponent)return;let{leftHeaderWidth:e,topHeaderHeight:i,width:r,height:n}=this.getWidthAndHeight();this._emptyTipComponent.setAttributes({spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+i,width:r,height:n,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:null==(t=this._emptyTipOption.textStyle)?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)})}release(){this._emptyTipComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent),this._emptyTipComponent=null,this.isReleased=!0}resetVisible(){(this.table.recordsCount&&0!==this.table.recordsCount||this.table.internalProps.layoutMap.rowCount!==this.table.internalProps.layoutMap.columnHeaderLevelCount)&&this.table.internalProps.layoutMap.colCount!==this.table.internalProps.layoutMap.rowHeaderLevelCount?this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent):this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)||this.table.scenegraph.stage.defaultLayer.appendChild(this._emptyTipComponent)}getWidthAndHeight(){let t=this.table.transpose||!1===this.table.options.indicatorsAsCol?this.table.getFrozenColsWidth():0,e=!this.table.transpose||this.table.options.indicatorsAsCol?this.table.getFrozenRowsHeight():0;return{leftHeaderWidth:t,topHeaderHeight:e,width:("basedOnContainer"!==this._emptyTipOption.displayMode&&this.table.columnHeaderLevelCount>0&&this.table.colCount>this.table.rowHeaderLevelCount?this.table.getDrawRange().width:this.table.tableNoFrameWidth)-t-this.table.getTheme().scrollStyle.width,height:("basedOnContainer"!==this._emptyTipOption.displayMode&&this.table.rowHeaderLevelCount>0&&this.table.rowCount>this.table.columnHeaderLevelCount?this.table.getDrawRange().height:this.table.tableNoFrameHeight)-e-this.table.getTheme().scrollStyle.width}}_getEmptyTipAttrs(){var t;let{leftHeaderWidth:e,topHeaderHeight:i,width:r,height:n}=this.getWidthAndHeight();return{spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+i,width:r,height:n,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:null==(t=this._emptyTipOption.textStyle)?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)}}}var N=i(65755),j=i(25397),G=i(3290),V=i(14604),U=i(70506),K=i(86001),X=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let Y={orient:"bottom",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fill:"#000000",fontWeight:"normal"},space:12},item:{visible:!0,spaceCol:10,spaceRow:10,padding:2,background:{state:{selectedHover:{fill:"gray",fillOpacity:.7},unSelectedHover:{fill:"gray",fillOpacity:.2}}},shape:{space:4,state:{unSelected:{fillOpacity:.5}}},label:{space:4,style:{fill:"#89909D",fontSize:14},state:{unSelected:{fillOpacity:.5}}}},allowAllCanceled:!0,visible:!0};var $=i(67331),q=i(74577);class J{constructor(t,e){var i,r,n,l;this.table=e,this.option=(0,N.Z)(t),this.orient=null!=(i=t.orient)?i:"left",this.visible=null==(r=t.visible)||r,this.position=null!=(n=t.position)?n:"middle",this.selectedData=null!=(l=t.defaultSelected)?l:null,this.createComponent(),this.initEvent()}createComponent(){let t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),e=new G.W((0,l.Z)({},t,{defaultSelected:this.selectedData,disableTriggerEvent:this.table.options.disableInteraction}));e.name="legend",this.legendComponent=e,!1===this.visible&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){if(!this.legendComponent||!1===this.visible)return;let t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});this.legendComponent.setAttributes(t),this.adjustTableSize(this.legendComponent.attribute)}adjustTableSize(t){var e,i;if(!this.legendComponent||!1===this.visible)return;let r=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,n=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(r<=0||n<=0)return;let l=this.table.tableNoFrameWidth,s=this.table.tableNoFrameHeight,a=(0,q.u)(null!=(i=null!=(e=t.padding)?e:this.option.padding)?i:10),o=0,h=0;"left"===this.orient?(o=a[3],h=0,r+=a[1]+a[3]):"top"===this.orient?(o=0,h=a[0],n+=a[0]+a[2]):"right"===this.orient?(o=l-r-a[1],h=0,r+=a[1]+a[3]):"bottom"===this.orient&&(o=0,h=s-n-a[2],n+=a[0]+a[2]);let d="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",u=this.position,c=0,p=0;"horizontal"===d?c="middle"===u?(l-r)/2:"end"===u?l-r-a[1]:a[3]:p="middle"===u?(s-n)/2:"end"===u?s-n-a[2]:a[0],this.legendComponent.setAttributes({dx:c,dy:p,x:o,y:h}),"left"===this.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r),this.table.tableX+=Math.ceil(r)):"top"===this.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n),this.table.tableY+=Math.ceil(n)):"right"===this.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r):"bottom"===this.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n))}getLegendAttributes(t){var e,i;let r="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",n=function(t,e){let i=(0,l.Z)({},Y,t),{title:r={},item:n={},pager:s={},background:a={},type:o,id:h,visible:d,orient:u,position:c,data:p,filter:g,regionId:f,regionIndex:m,seriesIndex:y,seriesId:v,padding:b}=i,_=X(i,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return r.visible&&(_.title=(0,K.qi)(r)),(0,T.Z)(n.focusIconStyle)||(0,K.h_)(n.focusIconStyle),(0,K.ro)(n.shape),(0,K.ro)(n.label),(0,K.ro)(n.value),(0,K.ro)(n.background),(0,U.hU)(n.maxWidth)&&(n.maxWidth=Number(n.maxWidth.substring(0,n.maxWidth.length-1))*e.width/100),(0,U.hU)(n.width)&&(n.width=Number(n.width.substring(0,n.width.length-1))*e.width/100),(0,U.hU)(n.height)&&(n.height=Number(n.height.substring(0,n.height.length-1))*e.width/100),_.item=n,(0,T.Z)(s.textStyle)||(0,K.h_)(s.textStyle),(0,K.ro)(s.handler),_.pager=s,a.visible&&!(0,T.Z)(a.style)&&((0,l.Z)(_,a.style),(0,C.Z)(a.padding)&&(_.padding=a.padding)),_}(this.option,t),s=(0,q.u)(null!=(i=null!=(e=n.padding)?e:this.option.padding)?i:10);return Object.assign({layout:r,items:this.getLegendItems(),maxWidth:t.width-s[1]-s[3],maxHeight:t.height-s[0]-s[2]},n)}getLegendItems(){return this.option.data}initEvent(){this.legendComponent&&(this.legendComponent.addEventListener(V.dk.legendItemClick,t=>{let e=(0,j.Z)(t,"detail.currentSelected");this.table.fireListeners($.B.LEGEND_ITEM_CLICK,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(V.dk.legendItemHover,t=>{let e=(0,j.Z)(t,"detail");this.table.fireListeners($.B.LEGEND_ITEM_HOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(V.dk.legendItemUnHover,t=>{let e=(0,j.Z)(t,"detail");this.table.fireListeners($.B.LEGEND_ITEM_UNHOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener("legendItemAttributeUpdate",t=>{this.table.scenegraph.updateNextFrame()}))}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}var Q=i(14217),te=i(39489),ti=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let tr={orient:"right",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"titleFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},endText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},handlerText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}}},tn={horizontal:Object.assign(Object.assign({},tr),{rail:{width:200,height:8,style:{fill:"rgba(0,0,0,0.04)"}}}),vertical:Object.assign(Object.assign({},tr),{rail:{width:8,height:200,style:{fill:"rgba(0,0,0,0.04)"}}})},tl={horizontal:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:200,height:4,style:{fill:"rgba(0,0,0,0.04)"}}},tr),vertical:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:4,height:200,style:{fill:"rgba(0,0,0,0.04)"}}},tr)};class ts{constructor(t,e){var i,r,n,l;this.table=e,this.option=(0,N.Z)(t),this.orient=null!=(i=t.orient)?i:"left",this.visible=null==(r=t.visible)||r,this.position=null!=(n=t.position)?n:"middle",this.selectedData=null!=(l=t.defaultSelected)?l:null,this.createComponent(),this.initEvent()}createComponent(){let t,e=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});(t="color"===this.option.type?new Q.e((0,l.Z)({},e,{slidable:!0})):new te.D((0,l.Z)({},e,{slidable:!0}))).name="legend",this.legendComponent=t,!1===this.visible&&(t.setAttributes({visible:!1,visibleAll:!1}),t.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(t),this.adjustTableSize(e)}resize(){this.legendComponent&&!1!==this.visible&&(this.legendComponent.setAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(t){var e,i;if(!this.legendComponent||!1===this.visible)return;let r=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,n=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(r<=0||n<=0)return;let l=this.table.tableNoFrameWidth,s=this.table.tableNoFrameHeight,a=(0,q.u)(null!=(i=null!=(e=t.padding)?e:this.option.padding)?i:10),o=0,h=0;"left"===this.orient?(o=a[3],h=0,r+=a[1]+a[3]):"top"===this.orient?(o=0,h=a[0],n+=a[0]+a[2]):"right"===this.orient?(o=l-r-a[1],h=0,r+=a[1]+a[3]):"bottom"===this.orient&&(o=0,h=s-n-a[2],n+=a[0]+a[2]);let d="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",u=this.position,c=0,p=0;"horizontal"===d?c="middle"===u?(l-r)/2:"end"===u?l-r-a[1]:a[3]:p="middle"===u?(s-n)/2:"end"===u?s-n-a[2]:a[0],this.legendComponent.setAttributes({dx:c,dy:p,x:o,y:h}),"left"===this.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r),this.table.tableX+=Math.ceil(r)):"top"===this.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n),this.table.tableY+=Math.ceil(n)):"right"===this.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r):"bottom"===this.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(n))}getLegendAttributes(t){let e="bottom"===this.orient||"top"===this.orient?"horizontal":"vertical",i="horizontal"===e?"bottom":this.orient;return Object.assign(Object.assign({},function(t,e){let i=(0,l.Z)({},("color"===t.type?tn:tl)["bottom"===t.orient||"top"===t.orient?"horizontal":"vertical"],t),{title:r={},handler:n={},rail:s={},track:a={},startText:o,endText:h,handlerText:d,sizeBackground:u,background:c={},type:p,id:g,visible:f,orient:m,position:y,data:v,defaultSelected:b,field:_,filter:x,regionId:w,regionIndex:S,seriesIndex:A,seriesId:M,padding:k}=i,R=ti(i,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return r.visible&&(R.title=(0,K.qi)(r)),R.showHandler=!1!==n.visible,(0,T.Z)(n.style)||(R.handlerStyle=(0,K.h_)(n.style)),(0,C.Z)(s.width)&&(R.railWidth=s.width),(0,C.Z)(s.height)&&(R.railHeight=s.height),(0,T.Z)(s.style)||(R.railStyle=(0,K.h_)(s.style)),(0,T.Z)(a.style)||(R.trackStyle=(0,K.h_)(a.style)),R.startText=(0,K.ro)(o),R.endText=(0,K.ro)(h),R.handlerText=(0,K.ro)(d),(0,T.Z)(u)||(R.sizeBackground=(0,K.h_)(u)),c.visible&&!(0,T.Z)(c.style)&&((0,l.Z)(R,c.style),(0,C.Z)(c.padding)&&(R.padding=c.padding)),R}(this.option,0)),{layout:e,align:i,min:this.option.min,max:this.option.max,value:this.option.value,["color"===this.option.type?"colors":"sizeRange"]:"color"===this.option.type?this.option.colors:this.option.sizeRange})}initEvent(){this.legendComponent&&this.legendComponent.addEventListener("change",t=>{let e=(0,j.Z)(t,"detail.value");this.table.fireListeners($.B.LEGEND_CHANGE,{model:this,value:e,event:t}),this.table.scenegraph.updateNextFrame()})}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}function ta(t,e){return"color"===t.type||"size"===t.type?new ts(t,e):new J(t,e)}class to{constructor(t){this._table=t}release(){this.unbindMenuElement(),this._menuElement&&this._menuElement.release(),this._menuElement=void 0}_getMenuElement(){return this._menuElement||(this._menuElement=this.createMenuElementInternal()),this._menuElement}bindMenuElement(t,e,i){return this._getMenuElement().bindToCell(this._table,t,e,i)}unbindMenuElement(){this._getMenuElement().unbindFromCell()}pointInMenuElement(t,e){return this._getMenuElement().pointInMenuElement(t,e)}getRootElement(){return this._getMenuElement().rootElement}}var th=i(53476),td=i(96357);let tu="vtable__menu-element",tc=`${tu}--hidden`,tp=`${tu}--shown`;class tg{constructor(t){var e,i,r;this._handler=new th.b,this._rootElement=(0,td.a)("div",[tu,tc]),this._rootElement.addEventListener("wheel",t=>{t.stopPropagation()}),null==(e=this._rootElement)||e.addEventListener("mousedown",t=>{t.stopPropagation(),t.preventDefault()}),null==(i=this._rootElement)||i.addEventListener("click",e=>{if(e.stopPropagation(),e.preventDefault(),this._rootElement.classList.contains(tc))return;let{col:i,row:r,dropDownIndex:n,menuKey:l,text:s,hasChildren:a}=e.target;if("number"!=typeof n||a)return void e.stopPropagation();let o=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(i,r):t.getHeaderField(i,r),h=t._dropDownMenuIsHighlight(i,r,n);t.fireListeners($.B.DROPDOWN_MENU_CLICK,{col:i,row:r,field:o,menuKey:l,text:s,highlight:h,cellLocation:t.getCellLocation(i,r),event:e}),t.fireListeners($.B.DROPDOWN_MENU_CLEAR,null),t.fireListeners($.B.HIDE_MENU,null),e.stopPropagation()}),null==(r=this._rootElement)||r.addEventListener("mousemove",t=>{this._rootElement.classList.contains(tc)||t.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();let t=this._rootElement;(null==t?void 0:t.parentElement)&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,i,r){let n=this._rootElement;if(this._menuInstanceInfo=r,null==n||n.classList.remove(tp),null==n||n.classList.add(tc),this._canBindToCell(t,e,i)){if(n.innerHTML="",n.appendChild(r.content),this._bindCell(t,e,i,r.position,r.referencePosition))return null==n||n.classList.add(tp),null==n||n.classList.remove(tc),!0}else this.unbindFromCell();return!1}unbindFromCell(){let t=this._rootElement;this._menuInstanceInfo=void 0,(null==t?void 0:t.parentElement)&&(t.classList.remove(tp),t.classList.add(tc))}_canBindToCell(t,e,i){var r;let n=t.getCellRangeRelativeRect({col:e,row:i}),l=null!=(r=t.internalProps.menu.parentElement)?r:t.getElement(),{top:s,bottom:a,left:o,right:h}=n;if(t.isFrozenCell(e,i))return!0;if(a<t.getFrozenRowsHeight()||h<t.getFrozenColsWidth()||o>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||s>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;let{offsetHeight:d,offsetWidth:u}=l;return!(d<s)&&!(u<o)}_bindCell(t,e,i,r,n){var l;let s=this._rootElement,a=null!=(l=t.internalProps.menu.parentElement)?l:t.getElement(),{width:o,height:h,left:d,top:u}=a.getBoundingClientRect();if(s){let e,i;s.parentElement!==a&&a.appendChild(s),s.style.left="0px",s.style.maxWidth=`${.8*o}px`;let l=s.clientWidth,c=s.clientHeight;r&&(e=r.x,i=r.y),n&&(e=n.rect.right-l,i=n.rect.bottom),i+c>h&&(i=h-c,e+=l-2),i<0&&(i/=2);let p=0,g=0;if(t.getElement()!==a){let{left:e,top:i}=t.getElement().getBoundingClientRect();p=i-u,g=e-d}return s.style.top=`${i+p}px`,e<0?e=0:e+l>o&&(e=o-l),s.style.left=`${e+g}px`,!0}return!1}pointInMenuElement(t,e){let{x:i,y:r,width:n,height:l}=this._rootElement.getBoundingClientRect();return t>i-5&&t<i+n+5&&e>r-5&&e<r+l+5}}var tf=i(5923);class tm extends to{createMenuElementInternal(){return new tf.F(this._table)}}class ty extends to{createMenuElementInternal(){return new tg(this._table)}}var tv=i(23975);let tb={"dropdown-menu":function(t){return new tm(t)},"context-menu":function(t){return new tm(t)},container:t=>new ty(t)};class t_{constructor(t){this._table=t,this._menuInstances={},this._bindTableEvent(t)}release(){let t=this._menuInstances;for(let e in t)t[e].release();delete this._menuInstances,this._attachInfo=null}_bindToCell(t,e,i,r){var n;let l=this._attachInfo,s=this._getMenuInstanceInfo(t,e,i,r);if(!l||s&&l.instance===s.instance||(null==(n=l.instance)||n.unbindMenuElement(),this._attachInfo=null),!s)return;let{instance:a,info:o}=s;if(a&&a.bindMenuElement(t,e,o)){let i=-1===t&&-1===e?{start:{col:-1,row:-1},end:{col:-1,row:-1}}:this._table.getCellRange(t,e);this._attachInfo={range:i,instance:a}}}_unbindFromCell(){let t=this._attachInfo;if(!t)return;let{instance:e}=t;null==e||e.unbindMenuElement(),this._attachInfo=null}_isBindToCell(t,e){let i=this._attachInfo;return!!i&&(0,tv._Z)(i.range,t,e)}pointInMenuElement(t,e){if(!this._attachInfo)return!1;let{instance:i}=this._attachInfo;return i.pointInMenuElement(t,e)}_bindTableEvent(t){t.on($.B.DROPDOWN_ICON_CLICK,t=>{this._attachInfo&&this._isBindToCell(t.col,t.row)?this._unbindFromCell():this._bindToCell(t.col,t.row,"dropdown-menu")}),t.on($.B.DROPDOWN_MENU_CLEAR,t=>{this._unbindFromCell()}),t.on($.B.CONTEXTMENU_CELL,e=>{var i,r,n,l;if("html"===(null==(i=t.internalProps.menu)?void 0:i.renderMode)){let i=t._getMouseAbstractPoint(e.event),s=null;i.inTable&&"function"==typeof(null==(r=t.internalProps.menu)?void 0:r.contextMenuItems)?s=t.internalProps.menu.contextMenuItems(t.getHeaderField(e.col,e.row),e.row,e.col,t):i.inTable&&Array.isArray(null==(n=t.internalProps.menu)?void 0:n.contextMenuItems)&&(s=null==(l=t.internalProps.menu)?void 0:l.contextMenuItems),this._bindToCell(e.col,e.row,"context-menu",{content:s,position:{x:i.x,y:i.y}})}}),t.on($.B.CONTEXTMENU_CANVAS,e=>{var i,r,n,l;if("html"===(null==(i=t.internalProps.menu)?void 0:i.renderMode)){let i=t._getMouseAbstractPoint(e.event),s=null;i.inTable&&"function"==typeof(null==(r=t.internalProps.menu)?void 0:r.contextMenuItems)?s=t.internalProps.menu.contextMenuItems(t.getHeaderField(e.col,e.row),e.row,e.col,t):i.inTable&&Array.isArray(null==(n=t.internalProps.menu)?void 0:n.contextMenuItems)&&(s=null==(l=t.internalProps.menu)?void 0:l.contextMenuItems),this._bindToCell(-1,-1,"context-menu",{content:s,position:{x:i.x,y:i.y}})}})}_getMenuInstanceInfo(t,e,i,r){let n=this._table,l=this._menuInstances,s=function(t,e,i,r,n){var l,s,a;if(-1===e&&-1===i&&"context-menu"===r)return(null==n?void 0:n.content)?{type:r,position:n.position,referencePosition:null!=(l=n.referencePosition)?l:{rect:{left:0,right:0,top:0,bottom:0,width:0,height:0}},content:n.content}:null;let{lineHeight:o,textBaseline:h,textStick:d}=t._getCellStyle(e,i),u=t.getCellRangeRelativeRect(t.getCellRange(e,i));d&&(u=t.getVisibleCellRangeRelativeRect({col:e,row:i}));let{left:c,right:p,bottom:g,top:f,width:m,height:y}=u;if(t.isHeader(e,i)&&({left:c,right:p,bottom:g,top:f,width:m,height:y}=t.internalProps.headerHelper.getDropDownIconRect(u,o,h||"middle")),null==n?void 0:n.content)return{type:r,position:n.position,referencePosition:null!=(s=n.referencePosition)?s:{rect:{left:c,right:p,top:f,bottom:g,width:m,height:y}},content:n.content};if("dropdown-menu"===r){let n=t.globalDropDownMenu,l=t._getHeaderLayoutMap(e,i);n=null!=(a=l.dropDownMenu)?a:n;let s=l.pivotInfo;return"function"==typeof n&&(n=n({row:i,col:e,table:t})),{type:r,referencePosition:{rect:{left:c,right:p,top:f,bottom:g,width:m,height:y}},content:n,pivotInfo:s}}return null}(n,t,e,i,r);return s?{instance:l&&l[i]||l&&(l[i]=tb[i](n)),type:i,info:s}:null}containElement(t){var e;for(let i in this._menuInstances)if(null==(e=this._menuInstances[i].getRootElement())?void 0:e.contains(t))return!0;return!1}}var tC=i(88919);class tx{constructor(t,e){this.isReleased=!1,this.table=e,this._titleOption=(0,l.Z)({orient:"top"},t),!1!==t.visible&&(this._titleComponent=this._createOrUpdateTitleComponent(this._getTitleAttrs()))}_createOrUpdateTitleComponent(t){if(this._titleComponent)(0,z.X)(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{let e=new tC.D(t);e.name="title",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._titleComponent=e}return this._adjustTableSize(this._titleComponent.attribute),this._titleComponent}resize(){var t,e,i,r,n;if(!this._titleComponent)return;let l=(0,q.u)(null!=(t=this._titleOption.padding)?t:10),s=null!=(e=this._titleOption.width)?e:("adaptive"===this.table.widthMode?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width))-l[1]-l[3],a=null!=(i=this._titleOption.height)?i:("adaptive"===this.table.heightMode?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height))-l[0]-l[2];this._titleComponent.setAttributes({x:(null!=(r=this._titleOption.x)?r:"right"===this._titleOption.orient)?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:(null!=(n=this._titleOption.y)?n:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:"top"===this._titleOption.orient||"bottom"===this._titleOption.orient?s:this._titleOption.width,height:"left"===this._titleOption.orient||"right"===this._titleOption.orient?a:this._titleOption.height,textStyle:Object.assign({width:s},this._titleOption.textStyle),subtextStyle:Object.assign({width:s},this._titleOption.subtextStyle)}),this._adjustTableSize(this._titleComponent.attribute)}_adjustTableSize(t){var e,i,r,n;let l=isFinite(null==(e=this._titleComponent)?void 0:e.AABBBounds.width())?this._titleComponent.AABBBounds.width():0,s=isFinite(null==(i=this._titleComponent)?void 0:i.AABBBounds.height())?this._titleComponent.AABBBounds.height():0;"left"===this._titleOption.orient?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(l),this.table.tableX+=Math.ceil(l)):"top"===this._titleOption.orient?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(s),this.table.tableY+=Math.ceil(s)):"right"===this._titleOption.orient?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(l):"bottom"===this._titleOption.orient&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(s)),this._cacheAttrs=t,"right"!==this._titleOption.orient&&"bottom"!==this._titleOption.orient||this._titleComponent.setAttributes({x:(null!=(r=this._titleOption.x)?r:"right"===this._titleOption.orient)?this.table.tableX+this.table.tableNoFrameWidth:this.table.tableX,y:(null!=(n=this._titleOption.y)?n:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY})}release(){this._titleComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._titleComponent),this._titleComponent=null,this.isReleased=!0}_getTitleAttrs(){var t,e,i,r,n,l,s,a,o,h,d;let u=this._titleOption.text||this._titleOption.subtext?10:0,c=(0,q.u)(null!=(t=this._titleOption.padding)?t:u),p=null!=(e=this._titleOption.width)?e:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width)-c[1]-c[3],g=null!=(i=this._titleOption.height)?i:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height)-c[0]-c[2];return{text:null!=(r=this._titleOption.text)?r:"",subtext:null!=(n=this._titleOption.subtext)?n:"",x:(null!=(l=this._titleOption.x)?l:"right"===this._titleOption.orient)?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:(null!=(s=this._titleOption.y)?s:"bottom"===this._titleOption.orient)?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:"top"===this._titleOption.orient||"bottom"===this._titleOption.orient?p:this._titleOption.width,height:"left"===this._titleOption.orient||"right"===this._titleOption.orient?g:this._titleOption.height,minWidth:this._titleOption.minWidth,maxWidth:this._titleOption.maxWidth,minHeight:this._titleOption.minHeight,maxHeight:this._titleOption.maxHeight,padding:this._titleOption.padding,align:null!=(a=this._titleOption.align)?a:"left",verticalAlign:null!=(o=this._titleOption.verticalAlign)?o:"top",textStyle:Object.assign({width:p},this._titleOption.textStyle),subtextStyle:Object.assign({width:p},this._titleOption.subtextStyle),dx:null!=(h=this._titleOption.dx)?h:0,dy:null!=(d=this._titleOption.dy)?d:0}}getComponentGraphic(){return this._titleComponent}}class tw{constructor(t){this._table=t}release(){var t,e;this.unbindTooltipElement(),this._tooltipElement&&(null==(e=(t=this._tooltipElement).release)||e.call(t)),this._tooltipElement=void 0}_getTooltipElement(){return this._tooltipElement||(this._tooltipElement=this.createTooltipElementInternal()),this._tooltipElement}bindTooltipElement(t,e,i,r){return this._getTooltipElement().bindToCell(this._table,t,e,i,r)}moveTooltipElement(t,e,i,r){this._getTooltipElement().move(this._table,t,e,i,r)}unbindTooltipElement(){this._getTooltipElement().unbindFromCell()}locateTooltipElement(t,e,i,r,n){this._getTooltipElement()._locate(this._table,t,e,i,r,n)}}var tS=i(72281),tA=i(30430),tM=i(6958);!function(){if("node"===tA.X.mode)return;let t=document.createElement("style");t.id="vtable-tooltip-styleSheet",t.textContent="\n@keyframes vtable__bubble-tooltip-element--shown-animation {\n	0% {\n		opacity: 0;\n	}\n	100% {\n		opacity: 1;\n	}\n}\n.vtable__bubble-tooltip-element {\n	position: absolute;\n	\n	// pointer-events: none;\n	//user-select: none;\n	max-width: 300px;\n	z-index: 99999;\n\n	background: #FFFFFF;\n    border: 1px solid #E6E8ED;\n    box-sizing: border-box;\n    border-radius: 4px;\n    box-shadow: 0px 2px 4px rgb(27 31 35 / 8%);\n    color: #141414;\n    font-size: 13px;\n}\n.vtable__bubble-tooltip-element--hidden {\n	opacity: 0;\n  pointer-events: none;\n	user-select: none;\n	/* transform: translate(-50%, -50%); */\n	transition: opacity 75ms linear;\n}\n.vtable__bubble-tooltip-element--shown {\n	opacity: 1;\n	/* transform: translate(-50%, -50%); */\n	animation: vtable__bubble-tooltip-element--shown-animation 150ms ease-out;\n}\n.vtable__bubble-tooltip-element__content {\n	/* font-size: .75rem; */\n	padding: 6px 8px;\n	min-height: 1em;\n	line-height: 1.5;\n	width: 100%;\n	display: block;\n	white-space: pre-wrap;\n	margin: 0;\n	box-sizing: border-box;\n	overflow: auto;\n	word-wrap: break-word;\n	position: relative;\n	background-color: #FFF;\n	z-index: 2;\n	border-radius: 4px;\n}\n/*  WebKit Microsoft Edge（新版）： */\n.vtable__bubble-tooltip-element__content::-webkit-scrollbar {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n/*  Opera Firefox  */\n.vtable__bubble-tooltip-element__content > scrollbar-track {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n/* Internet Explorer 11 和 Microsoft Edge（旧版） */\n.vtable__bubble-tooltip-element__content > scrollbar {\n  width: 0;\n  height: 0;\n  background-color: transparent;\n}\n.vtable__bubble-tooltip-element__triangle {\n	/* font-size: .75rem; */\n	position: absolute;\n	width: 10px;\n	height: 10px;\n	display: block;\n	transform: rotate(45deg);\n    transform-origin: 50% 50% 0;\n	z-index: 1;\n	background-color: #FFF;\n	border: 1px solid #E6E8ED;\n}\n",document.head.appendChild(t)}();let tT="vtable__bubble-tooltip-element",tk=`${tT}__content`,tR=`${tT}__triangle`,tP=`${tT}--hidden`,tB=`${tT}--shown`;class tI{constructor(){this._handler=new th.b;let t=this._rootElement=(0,td.a)("div",[tT,tP]),e=(0,td.a)("div",[tk]),i=(0,td.a)("span",[tR]);t.appendChild(i),t.appendChild(e),this._messageElement=t.querySelector(`.${tk}`)||void 0,this._triangleElement=t.querySelector(`.${tR}`)||void 0,t.addEventListener("mousemove",()=>{this._disappearDelayId&&clearTimeout(this._disappearDelayId)}),t.addEventListener("mouseleave",()=>{this._disappearDelay=void 0,this.unbindFromCell()}),e.addEventListener("wheel",t=>{t.stopPropagation()}),e.addEventListener("copy",t=>{(0,tM.Ed)(e)&&t.stopPropagation()})}bindToCell(t,e,i,r,n){var l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w;this._disappearDelay=null==r?void 0:r.disappearDelay,this._disappearDelayId&&clearTimeout(this._disappearDelayId);let S=this._rootElement,A=this._messageElement,M=this._triangleElement;if(null==S||S.classList.remove(tB),null==S||S.classList.add(tP),this._canBindToCell(t,e,i)){if(A.setAttribute("style",""),M.setAttribute("style",""),(null==r?void 0:r.className)&&S.classList.add(r.className),(null==(l=null==r?void 0:r.style)?void 0:l.bgColor)&&(A.style.backgroundColor=null==(s=null==r?void 0:r.style)?void 0:s.bgColor),(null==(a=null==r?void 0:r.style)?void 0:a.bgColor)&&(M.style.backgroundColor=null==(o=null==r?void 0:r.style)?void 0:o.bgColor),M.style.display=!0===(null==(h=null==r?void 0:r.style)?void 0:h.arrowMark)?"block":"none",(null==(d=null==r?void 0:r.style)?void 0:d.fontSize)&&(A.style.fontSize=(null!=(c=null==(u=null==r?void 0:r.style)?void 0:u.fontSize)?c:12)+"px"),(null==(p=null==r?void 0:r.style)?void 0:p.fontFamily)&&(A.style.fontFamily=null==(g=null==r?void 0:r.style)?void 0:g.fontFamily),(null==(f=null==r?void 0:r.style)?void 0:f.color)&&(A.style.color=null==(m=null==r?void 0:r.style)?void 0:m.color),(null==(y=null==r?void 0:r.style)?void 0:y.padding)&&(A.style.padding=`${null==(v=null==r?void 0:r.style)?void 0:v.padding.join("px ")}px`),(null==(b=null==r?void 0:r.style)?void 0:b.maxHeight)&&(A.style.maxHeight=`${null==(_=null==r?void 0:r.style)?void 0:_.maxHeight}px`),(null==(C=null==r?void 0:r.style)?void 0:C.maxWidth)&&(A.style.maxWidth=`${null==(x=null==r?void 0:r.style)?void 0:x.maxWidth}px`),A&&(A.textContent=null==r?void 0:r.content),this._bindToCell(t,e,i,null==r?void 0:r.position,null==r?void 0:r.referencePosition,n,null==(w=null==r?void 0:r.style)?void 0:w.arrowMark))return null==S||S.classList.add(tB),null==S||S.classList.remove(tP),!0}else this.unbindFromCell();return!1}release(){var t,e;this.unbindFromCell();let i=this._rootElement;(null==i?void 0:i.parentElement)&&i.parentElement.removeChild(i),null==(e=null==(t=this._handler)?void 0:t.release)||e.call(t),delete this._rootElement,delete this._messageElement}move(t,e,i,r,n){let l=this._rootElement;this._canBindToCell(t,e,i)?(this._bindToCell(t,e,i,null==r?void 0:r.position,null==r?void 0:r.referencePosition,n),null==l||l.classList.add(tB),null==l||l.classList.remove(tP)):this.unbindFromCell()}unbindFromCell(){var t;if(this._disappearDelay)this._disappearDelayId=setTimeout(()=>{let t=this._rootElement;(null==t?void 0:t.parentElement)&&(t.classList.remove(tB),t.classList.add(tP))},null!=(t=this._disappearDelay)?t:0);else{let t=this._rootElement;(null==t?void 0:t.parentElement)&&(t.classList.remove(tB),t.classList.add(tP))}}_canBindToCell(t,e,i){let r=t.getCellRangeRelativeRect({col:e,row:i}),n=t.getElement(),{bottom:l,left:s,right:a,top:o}=r;if(t.isFrozenCell(e,i))return!0;if(l<t.getFrozenRowsHeight()||a<t.getFrozenColsWidth()||s>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||o>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;let{offsetHeight:h,offsetWidth:d}=n;return!(o>h)&&!(s>d)}_bindToCell(t,e,i,r,n,l,s){let a=this._rootElement,o=t.getCellRangeRelativeRect({col:e,row:i}),h=t.internalProps.tooltip.parentElement,d=t.internalProps.element.offsetWidth,{width:u}=o;if(a){let o,c;a.parentElement!==h&&h.appendChild(a),a.style.left="0px";let p=Math.min(.8*d,4*u);a.style.maxWidth=`${p}px`;let g=a.clientWidth,f=a.clientHeight;if(!r&&!n)return!1;{let a=this.getComputedPosition(t,e,i,r,n,l,s);c=a.x,o=a.y}a.style.left=`${c}px`,a.style.top=`${o}px`,(0,tM.tq)()&&(a.style.fontSize="11px");let{x1:m,x2:y,y1:v,y2:b}=t.stateManager.menu.bounds,_=c,C=o;return!(t.stateManager.menu.isShow&&m<_+g&&y>_&&b>C&&v<_+f)}return!1}getComputedPosition(t,e,i,r,n,l,s){var a;let o,h,d=this._rootElement,u=t.getCellRangeRelativeRect({col:e,row:i}),{x:c,y:p}=t.internalProps.tooltip.parentElement.getBoundingClientRect(),{width:g,height:f,x:m,y:y}=t.internalProps.element.getBoundingClientRect(),{width:v}=u,b=Math.min(.8*g,4*v);d.style.maxWidth=`${b}px`;let _=d.clientWidth,C=d.clientHeight,x=6*!!s;if(r)h=r.x,o=r.y+x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px";else if(n){let t=null!=(a=n.placement)?a:tS.u.bottom,e=n.rect.left+n.rect.width/2,i=n.rect.top+n.rect.height/2,r=n.rect.top,s=n.rect.bottom,d=n.rect.left,u=n.rect.right,c=0,p=()=>{++c>=4||(this.removeStyleFromTriangle(),t===tS.u.top?(h=e-_/2,o=r-C-x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.bottom="-5px",l&&o<0&&(t=tS.u.right,p())):t===tS.u.bottom?(h=e-_/2,o=s+x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px",l&&o+C>f&&(t=tS.u.left,p())):t===tS.u.left?(o=i-C/2,h=d-_-x,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.right="-5px",l&&h<0&&(t=tS.u.top,p())):t===tS.u.right&&(o=i-C/2,h=u+x,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.left="-5px",l&&h+_>g&&(t=tS.u.bottom,p())))};p()}return l&&(h<0?h=0:h+d.offsetWidth>g&&(h=g-d.offsetWidth)),{x:h+m-c,y:o+y-p}}removeStyleFromTriangle(){this._triangleElement.style.left="",this._triangleElement.style.right="",this._triangleElement.style.top="",this._triangleElement.style.bottom="",this._triangleElement.style.marginLeft="",this._triangleElement.style.marginTop=""}_locate(t,e,i,r,n,l){let s=this.getComputedPosition(t,e,i,r,n,l),a=s.x,o=s.y;this._rootElement.style.left=`${a}px`,this._rootElement.style.top=`${o}px`}}class tE extends tw{createTooltipElementInternal(){return new tI}}let tL={"bubble-tooltip":function(t){return new tE(t)}};class tF{constructor(t,e){this._table=t,this._tooltipInstances={},this._bindTableEvent(t),this.confine=e}release(){var t,e;let i=this._tooltipInstances;for(let r in i)null==(e=null==(t=i[r])?void 0:t.release)||e.call(t);delete this._tooltipInstances,this._attachInfo=null}_bindToCell(t,e,i){var r;let n=this._attachInfo,l=this._getTooltipInstanceInfo(t,e);if(!n||l&&n.instance===l||(null==(r=n.instance)||r.unbindTooltipElement(),this._attachInfo=null),l&&l&&l.bindTooltipElement(t,e,i,this.confine)){let r=this._table.getCellRange(t,e);this._attachInfo={range:r,instance:l,tooltipOptions:i}}}_move(t,e,i){let r=this._attachInfo;if(!r||!(0,tv._Z)(r.range,t,e))return;let{instance:n}=r;null==n||n.moveTooltipElement(t,e,i,this.confine)}moveToPosition(t,e,i,r){let n=this._attachInfo;if(!n||!(0,tv._Z)(n.range,t,e))return;let{instance:l}=n;this._attachInfo.tooltipOptions.position=i,this._attachInfo.tooltipOptions.referencePosition=r,null==l||l.locateTooltipElement(t,e,i,r,this.confine)}_unbindFromCell(){let t=this._attachInfo;if(!t)return;let{instance:e}=t;null==e||e.unbindTooltipElement(),this._attachInfo=null}_isBindCell(t,e){let i=this._attachInfo;return!!i&&(0,tv._Z)(i.range,t,e)}_bindTableEvent(t){t.on($.B.MOUSEENTER_CELL,e=>{if((0,tM.tq)())return;let{x1:i,x2:r,y1:n,y2:l}=t.stateManager.menu.bounds;if(t.stateManager.menu.isShow&&"number"==typeof e.x&&"number"==typeof e.y&&e.x>i&&e.x<r&&e.y>n&&e.y<l)return;let{col:s,row:a}=e;this.showTooltip(s,a)}),t.on($.B.MOUSEMOVE_CELL,e=>{var i,r;if(!(0,tM.tq)()){if(null==(r=null==(i=this._attachInfo)?void 0:i.tooltipOptions)?void 0:r.referencePosition){let i=this._attachInfo.tooltipOptions.referencePosition,{event:r}=e,{left:n,right:l,top:s,bottom:a}=i.rect,o=t._getMouseAbstractPoint(r);o.inTable&&o.x>=n-5&&o.x<=l+5&&o.y>=s-5&&o.y<=a+5||this._unbindFromCell()}this._attachInfo&&t.stateManager.menu.isShow&&this._bindToCell(e.col,e.row)}}),t.on($.B.MOUSELEAVE_CELL,t=>{this._unbindFromCell()}),t.on($.B.SELECTED_CELL,t=>{this._isBindCell(t.col,t.row)&&this._unbindFromCell()}),t.on($.B.MOUSELEAVE_TABLE,t=>{this._unbindFromCell()}),t.on($.B.SCROLL,t=>{this._unbindFromCell()})}showTooltip(t,e){var i,r,n;let l,s=this._table,a=s.getHeaderDescription(t,e);if(a){let r=s.getCellRangeRelativeRect({col:t,row:e});l={content:a,referencePosition:{placement:s.internalProps.tooltip.position,rect:r},disappearDelay:null!=(i=s.internalProps.tooltip.overflowTextTooltipDisappearDelay)?i:0,style:s.theme.tooltipStyle}}else if((0,I.Z)(null==(r=s.internalProps.tooltip)?void 0:r.isShowOverflowTextTooltip)?s.internalProps.tooltip.isShowOverflowTextTooltip(t,e,s):s.internalProps.tooltip.isShowOverflowTextTooltip){let i=s.getCellOverflowText(t,e),r=s.getCellRangeRelativeRect({col:t,row:e});i&&(l={content:a?`${a}
  ${i}`:i,referencePosition:{placement:s.internalProps.tooltip.position,rect:r},disappearDelay:null!=(n=s.internalProps.tooltip.overflowTextTooltipDisappearDelay)?n:0,style:s.theme.tooltipStyle})}l?this._bindToCell(t,e,l):this._unbindFromCell()}_getTooltipInstanceInfo(t,e){let i=this._table,r=this._tooltipInstances;return r&&r["bubble-tooltip"]||r&&(r["bubble-tooltip"]=tL["bubble-tooltip"](i))}isBinded(t){var e;return JSON.stringify(t)===JSON.stringify(null==(e=this._attachInfo)?void 0:e.tooltipOptions)}}var tO=i(43453),tH=i(88237);let tD=()=>{r.F.registerComponent("axis",P),r.F.registerFunction("computeAxisComponentWidth",L),r.F.registerFunction("computeAxisComponentHeight",F),r.F.registerFunction("getAxisConfigInPivotChart",n.hZ)},tz=()=>{r.F.registerComponent("emptyTip",Z)},tW=()=>{r.F.registerFunction("createLegend",ta)},tZ=()=>{r.F.registerComponent("menuHandler",t_)},tN=()=>{r.F.registerComponent("title",tx)},tj=()=>{r.F.registerComponent("tooltipHandler",tF)},tG=()=>{(0,tO.Hp)(),(0,tH.d)()}},5923:function(t,e,i){i.d(e,{o:()=>A,F:()=>M});var r=i(53476),n=i(96357),l=i(30430),s=i(67331),a=i(23975),o=i(64776),h=i(77874);!function(){if("node"===l.X.mode)return;let t=document.createElement("style");t.id="vtable-menu-styleSheet",t.textContent="\n@keyframes vtable__menu-element--shown-animation {\n	0% {\n		opacity: 0;\n	}\n	100% {\n		opacity: 1;\n	}\n}\n.vtable__menu-element {\n	position: absolute;\n	box-sizing: border-box;\n	border-radius: 4px;\n	background-color: #fff;\n	padding: 6px 0;\n	/* pointer-events: none; */\n	user-select: none;\n	color: #000;\n	max-width: 300px;\n	z-index: 99999;\n	border: #CCC 0.5px solid;\n	cursor: default;\n	width: max-content;\n	box-shadow: 0px 8px 16px rgba(27, 31, 35, 0.12);\n  max-height: 100%;\n  overflow-y: auto;\n}\n.vtable__menu-element--hidden {\n	opacity: 0;\n	/* transform: translate(-50%, -50%); */\n	transition: opacity 75ms linear;\n	z-index: -9999;\n}\n.vtable__menu-element--shown {\n	opacity: 1;\n	/* transform: translate(-50%, -50%); */\n	animation: vtable__menu-element--shown-animation 150ms ease-out;\n}\n.vtable__menu-element__content {\n	font-family: Roboto;\n	font-size: 12px;\n	overflow: hidden;\n	display: inline-block;\n	/* height: 100%; */\n	line-height: 30px;\n}\n.vtable__menu-element__item {\n	height: 32px;\n	padding: 0px 12px;\n	cursor: pointer;\n	position: relative;\n	display: flex;\n	align-items: center;\n	justify-content: flex-start;\n}\n.vtable__menu-element__item:hover {\n	background-color: rgba(27, 31, 35, 0.06);\n}\n.vtable__menu-element__icon{\n	/* vertical-align: top; */\n	display: flex;\n	/* line-height: 30px; */\n	margin-right: 6px;\n}\n.vtable__menu-element__no-event {\n	pointer-events: none;\n}\n.vtable__menu-element--select {\n	color: #2E68CF;\n}\n.vtable__menu-element--normal {\n	color: rgba(20, 20, 20, 0.9);;\n}\n.vtable__menu-element__item-disabled {\n    color: rgba(0, 0, 0, 0.25);\n    cursor: not-allowed;\n	  background-color: #fff;\n}\n.vtable__menu-element__item-disabled:hover {\n	  background-color: #fff;\n}\n.vtable__menu-element__split {\n	height: 0px;\n	border: 1px solid rgb(209, 213, 218);\n	margin: 5px 0;\n}\n.vtable__menu-element__title {\n	color: rgb(149, 149, 149);\n}\n.vtable__menu-element__arrow {\n	position: absolute;\n	right: 3px;\n	font-weight: bold;\n	margin-top: 1px;\n}\n.vtable__menu-element__item-text {\n	margin-right: 15px;\n}\n",document.head.appendChild(t)}();let d="vtable__menu-element",u=`${d}__item`,c=`${d}__content`,p=`${d}--hidden`,g=`${d}--shown`,f=`${d}--normal`,m=`${d}--select`,y=`${d}__icon`,v=`${d}__split`,b=`${d}__title`,_=`${d}__arrow`,C=`${d}__no-event`,x=`${d}__item-text`,w=`${d}__item-disabled`;function S(){return(0,n.a)("div",[d,p])}function A(t,e,i,r,n,l){let s=t.getCellRange(r,n);for(let r=0;r<e.length;r++){let n=e[r],{col:l,row:h}=n,{field:d,menuKey:u}=n;if("number"!=typeof l||"number"!=typeof h)if(t.isPivotTable()&&(Array.isArray(d),1)){let e=t.internalProps.layoutMap.getPivotCellAdress(d);if(!e)continue;l=e.col,h=e.row}else{let e=t.internalProps.layoutMap.getHeaderCellAddressByField(d);if(!e)continue;l=e.col,h=e.row}if((0,o.Z)(l)&&(0,o.Z)(h)&&(0,a._Z)(s,l,h)&&i===u)return!0}return!1}class M{constructor(t){var e,i,n,l,a,o,h,d,u,c,f;this._handler=new r.b,this._rootElement=S(),this._secondElement=S(),this._secondElement.sub=!0,this._showChildrenIndex=-1,this._rootElement.addEventListener("wheel",t=>{t.stopPropagation()}),null==(e=this._rootElement)||e.addEventListener("mousedown",t=>{t.stopPropagation(),t.preventDefault()}),null==(i=this._rootElement)||i.addEventListener("contextmenu",t=>{t.stopPropagation(),t.preventDefault()}),null==(n=this._rootElement)||n.addEventListener("touchend",e=>{if(e.stopPropagation(),e.preventDefault(),e.target.classList.contains(w)||this._rootElement.classList.contains(p))return;let{col:i,row:r,dropDownIndex:n,menuKey:l,text:a,hasChildren:o}=e.target;if("number"!=typeof n||o)return void e.stopPropagation();let h=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(i,r):t.getHeaderField(i,r),d=t._dropDownMenuIsHighlight(i,r,n);t.fireListeners(s.B.DROPDOWN_MENU_CLICK,{col:i,row:r,field:h,menuKey:l,text:a,highlight:d,cellLocation:t.getCellLocation(i,r),event:e}),t.fireListeners(s.B.DROPDOWN_MENU_CLEAR,null),t.fireListeners(s.B.HIDE_MENU,null),e.stopPropagation()}),null==(l=this._rootElement)||l.addEventListener("click",e=>{if(e.stopPropagation(),e.preventDefault(),e.target.classList.contains(w)||this._rootElement.classList.contains(p))return;let{col:i,row:r,dropDownIndex:n,menuKey:l,text:a,hasChildren:o}=e.target;if("number"!=typeof n||o)return void e.stopPropagation();let h=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(i,r):t.getHeaderField(i,r),d=t._dropDownMenuIsHighlight(i,r,n);t.fireListeners(s.B.DROPDOWN_MENU_CLICK,{col:i,row:r,field:h,menuKey:l,text:a,highlight:d,cellLocation:t.getCellLocation(i,r),event:e}),t.fireListeners(s.B.DROPDOWN_MENU_CLEAR,null),t.fireListeners(s.B.HIDE_MENU,null),e.stopPropagation()}),null==(a=this._rootElement)||a.addEventListener("mousemove",e=>{var i,r;if(this._rootElement.classList.contains(p))return;e.stopPropagation();let{hasChildren:n,dropDownIndex:l,col:s,row:a,sub:o}=e.target;if(n){this._showChildrenIndex=l;let r=this._secondElement;null==r||r.classList.remove(p),null==r||r.classList.add(g),r.innerHTML="";let n=null==(i=this._menuInstanceInfo.content[l])?void 0:i.children;for(let e=0;e<n.length;e++){let i=n[e],l=T(i,!!t.stateManager.menu.dropDownMenuHighlight&&A(t,t.stateManager.menu.dropDownMenuHighlight,"object"==typeof i?(null==i?void 0:i.menuKey)||(null==i?void 0:i.text):i,s,a,e));l.col=s,l.row=a,l.dropDownIndex=e,"string"==typeof i?(l.text=i,l.menuKey=i):"object"==typeof i&&(l.text=i.text,l.menuKey=i.menuKey||i.text),l.sub=!0,l.sub=!0,r.appendChild(l)}let o=e.target.getBoundingClientRect();this._bindSecondElement(t,s,a,o.right,o.top)}else if(n&&this._showChildrenIndex===l){let t=this._secondElement;null==t||t.classList.remove(p),null==t||t.classList.add(g)}else!o&&(null==(r=this._secondElement)?void 0:r.classList.contains(g))&&setTimeout(()=>{if(!0!==this._mouseEnterSecondElement){this._showChildrenIndex=-1;let t=this._secondElement;null==t||t.classList.remove(g),null==t||t.classList.add(p)}},300)}),null==(o=this._secondElement)||o.addEventListener("wheel",t=>{t.stopPropagation()}),null==(h=this._secondElement)||h.addEventListener("mousemove",t=>{this._rootElement.classList.contains(p)||t.stopPropagation()}),null==(d=this._secondElement)||d.addEventListener("mouseenter",t=>{this._mouseEnterSecondElement=!0}),null==(u=this._secondElement)||u.addEventListener("mouseleave",t=>{this._mouseEnterSecondElement=!1}),null==(c=this._secondElement)||c.addEventListener("mousedown",t=>{t.stopPropagation(),t.preventDefault()}),null==(f=this._secondElement)||f.addEventListener("click",e=>{if(e.stopPropagation(),e.preventDefault(),e.target.classList.contains(w)||this._secondElement.classList.contains(p))return;let{col:i,row:r,dropDownIndex:n,menuKey:l,text:a,hasChildren:o}=e.target;if("number"!=typeof n||o)return void e.stopPropagation();let h=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(i,r):t.getHeaderField(i,r),d=!1;this._menuInstanceInfo.content.forEach((e,n)=>{if("object"==typeof e&&e.children&&e.children.length)for(let n=0;n<e.children.length;n++){let s=e.children[n];if(A(t,t.stateManager.menu.dropDownMenuHighlight,"object"==typeof s?null==s?void 0:s.menuKey:s,i,r,-1)&&l===("object"==typeof s?null==s?void 0:s.menuKey:s))return void(d=!0)}}),t.fireListeners(s.B.DROPDOWN_MENU_CLICK,{col:i,row:r,field:h,cellHeaderPaths:t.isPivotTable()?t.getCellHeaderPaths(i,r):void 0,menuKey:l,text:a,highlight:d,cellLocation:t.getCellLocation(i,r),event:e}),t.fireListeners(s.B.DROPDOWN_MENU_CLEAR,null),t.fireListeners(s.B.HIDE_MENU,null),e.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();let t=this._rootElement;(null==t?void 0:t.parentElement)&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,i,r){var n,l;let s=this._rootElement,a=this._secondElement;if(this._menuInstanceInfo=r,null==s||s.classList.remove(g),null==s||s.classList.add(p),null==a||a.classList.remove(g),null==a||a.classList.add(p),this._canBindToCell(t,e,i)){if(s.innerHTML="",Array.isArray(r.content)){let a=r.content;for(let r=0;n=r<(null==a?void 0:a.length),n;r++){let n=a[r],o=!!t.stateManager.menu.dropDownMenuHighlight&&A(t,t.stateManager.menu.dropDownMenuHighlight,"object"==typeof n?(null==n?void 0:n.menuKey)||(null==n?void 0:n.text):n,e,i,r);if(t.stateManager.menu.dropDownMenuHighlight&&"object"==typeof n&&Array.isArray(n.children)&&n.children.length)for(let r=0;r<n.children.length;r++){let l=n.children[r];if(A(t,t.stateManager.menu.dropDownMenuHighlight,"object"==typeof l?(null==l?void 0:l.menuKey)||(null==l?void 0:l.text):l,e,i,r)){o=!0;break}}let h=T(n,o);h.col=e,h.row=i,h.dropDownIndex=r,"string"==typeof n?(h.text=n,h.menuKey=n):"object"==typeof n&&(h.text=n.text,h.menuKey=n.menuKey||n.text,(null==(l=n.children)?void 0:l.length)&&(h.hasChildren=!0)),s.appendChild(h)}}if(this._bindToCell(t,e,i,r.position,r.referencePosition))return null==s||s.classList.add(g),null==s||s.classList.remove(p),!0}else this.unbindFromCell();return!1}unbindFromCell(){let t=this._rootElement,e=this._secondElement;this._menuInstanceInfo=void 0,(null==t?void 0:t.parentElement)&&(t.classList.remove(g),t.classList.add(p)),(null==e?void 0:e.parentElement)&&(e.classList.remove(g),e.classList.add(p))}_canBindToCell(t,e,i){var r;let n=t.getCellRangeRelativeRect({col:e,row:i}),l=null!=(r=t.internalProps.menu.parentElement)?r:t.getElement(),{top:s,bottom:a,left:o,right:h}=n;if(-1===e&&-1===i||t.isFrozenCell(e,i))return!0;if(a<t.getFrozenRowsHeight()||h<t.getFrozenColsWidth()||o>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||s>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;let{offsetHeight:d,offsetWidth:u}=l;return!(d<s)&&!(u<o)}_bindToCell(t,e,i,r,n){var l;let s=this._rootElement,a=null!=(l=t.internalProps.menu.parentElement)?l:t.getElement(),{width:o,height:h,left:d,top:u}=a.getBoundingClientRect();if(s){let e,i;s.parentElement!==a&&a.appendChild(s),s.style.left="0px",s.style.maxWidth=`${.8*o}px`;let l=s.offsetWidth,c=s.offsetHeight;r?(e=r.x,i=r.y):n&&(e=n.rect.right-l,i=n.rect.bottom);let p=a.getBoundingClientRect(),g=p.width/a.offsetWidth,f=p.height/a.offsetHeight;i*f+c>h&&(i=(h-c)/f),i<0&&(i/=2);let m=0,y=0;if(t.getElement()!==a){let{left:e,top:i}=t.getElement().getBoundingClientRect();m=i-u,y=e-d}return s.style.top=`${i+m}px`,e<0?e=0:e*g+l>o&&(e=(o-l)/g),s.style.left=`${e+y}px`,!0}return!1}_bindSecondElement(t,e,i,r,n){var l;let s=this._secondElement,a=this._rootElement,o=null!=(l=t.internalProps.menu.parentElement)?l:t.getElement(),{width:h,height:d,left:u,top:c}=o.getBoundingClientRect(),{x:p,y:g,width:f,height:m}=a.getBoundingClientRect();if(s){s.parentElement!==o&&o.appendChild(s),s.style.left="0px",s.style.maxWidth=`${.8*h}px`;let t=s.clientWidth,e=s.clientHeight,i=n-4-c;i+e>d&&(i=i-e+s.firstElementChild.clientHeight+4),s.style.top=`${i}px`;let l=r-u;return l+t>h?l=l-t-f:l+=4,s.style.left=`${l}px`,!0}return!1}pointInMenuElement(t,e){let{x:i,y:r,width:n,height:l}=this._rootElement.getBoundingClientRect();if(t>i-5&&t<i+n+5&&e>r-5&&e<r+l+5)return!0;let s=this._secondElement;if(s){let{x:i,y:r,width:n,height:l}=s.getBoundingClientRect();if(t>i-5&&t<i+n+5&&e>r-5&&e<r+l+5)return!0}return!1}}function T(t,e){var i,r,l;let s=(0,n.a)("div",[u,e?m:f]);if("object"==typeof t&&t.disabled&&s.classList.add(w),"string"==typeof t){let e=(0,n.a)("span",[c,C,x]);e.innerHTML=t,s.appendChild(e)}else if("object"==typeof t){let a=null!=(i=t.type)?i:"item";if("split"===a)return null==s||s.classList.add(v),s;if(null==(r=null==t?void 0:t.icon)?void 0:r.svg)if(h.tP.test(t.icon.svg)){let e=new Image;t.icon.width?e.style.width=t.icon.width.toString()+"px":e.style.width="16px",t.icon.height?e.style.height=t.icon.height.toString()+"px":e.style.height="16px",e.src=t.icon.svg,s.appendChild(e)}else{let i=(0,n.a)("span",[y,C]);i.innerHTML=e&&t.selectedIcon&&t.selectedIcon.svg?t.selectedIcon.svg:t.icon.svg,t.icon.width&&i.children[0].setAttribute("width",t.icon.width.toString()),t.icon.height&&i.children[0].setAttribute("height",t.icon.height.toString()),s.appendChild(i)}let o=(0,n.a)("span",[c,C,x]);if(o.innerHTML=t.text,s.appendChild(o),"title"===a)null==s||s.classList.add(C,b);else if(null==(l=null==t?void 0:t.children)?void 0:l.length){let t=(0,n.a)("span",[c,C,_]);t.innerHTML=e?'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#2E68CF" fill-opacity="0.65"></path></svg>':'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#141414" fill-opacity="0.65"></path></svg>',s.appendChild(t)}}return s}},30497:function(t,e,i){i.d(e,{D:()=>n,Z:()=>l});var r=i(8849);function n(t){return{rootContainer:new r.ZA({}),renderDefault:!0}}class l{constructor(t){this.table=t,this.customLayoutFuncCache=new Map,this.reactRemoveGraphicCache=new Map,this.reactRemoveAllGraphicCache=new Map,this.headerCustomLayoutFuncCache=new Map,this.headerReactRemoveGraphicCache=new Map,this.headerReactRemoveAllGraphicCache=new Map}hasReactCreateGraphic(t,e){return e?this.headerCustomLayoutFuncCache.has(t):this.customLayoutFuncCache.has(t)}setReactCreateGraphic(t,e,i){i?this.headerCustomLayoutFuncCache.set(t,e):this.customLayoutFuncCache.set(t,e)}setReactRemoveGraphic(t,e,i){i?this.headerReactRemoveGraphicCache.set(t,e):this.reactRemoveGraphicCache.set(t,e)}setReactRemoveAllGraphic(t,e,i){i?this.headerReactRemoveAllGraphicCache.set(t,e):this.reactRemoveAllGraphicCache.set(t,e)}updateCustomCell(t,e){let i=this.table;if("autoWidth"===i.widthMode&&i.scenegraph.recalculateColWidths(),(i.isAutoRowHeight()||"auto"===i.internalProps.defaultRowHeight&&!e||"auto"===i.internalProps.defaultHeaderRowHeight&&e)&&i.scenegraph.recalculateRowHeights(),i.isPivotTable()){let r=function(t,e,i){let r=+!!e.internalProps.rowSeriesNumber,n=[],l=e.internalProps.layoutMap;if(i){let{headerObjects:e}=l,i=[];for(let r=0;r<e.length;r++){let n=e[r];n&&n.define.componentId===t&&i.push(n.id)}for(let t=0;t<i.length;t++){let e=i[t],r=l.getHeaderCellAdressById(e),s=l.getCellRange(r.col,r.row);n.push(s)}}else{let e,{columnObjects:i,indicatorsAsCol:s}=l;for(let r=0;r<i.length;r++)if(i[r].define.componentId===t){e=r;break}if(s)for(let t=l.rowHeaderLevelCount+e;t<l.colCount;t+=i.length){let e={start:{col:t+r,row:l.columnHeaderLevelCount},end:{col:t+r,row:l.rowCount-1}};n.push(e)}else for(let t=l.columnHeaderLevelCount+e;t<l.rowCount;t+=i.length){let e={start:{col:l.rowHeaderLevelCount+r,row:t},end:{col:l.colCount-1,row:t}};n.push(e)}}return n}(t,i,e);for(let t=0;t<r.length;t++){let e=r[t];for(let t=e.start.col;t<=e.end.col;t++)for(let r=e.start.row;r<=e.end.row;r++)i.scenegraph.updateCellContent(t,r)}}else{let r=function(t,e,i){let r=+!!e.internalProps.rowSeriesNumber;if(i){let i,r=e.internalProps.layoutMap,{headerObjects:n}=e.internalProps.layoutMap;for(let e=0;e<n.length;e++){let r=n[e];if(r.define.componentId===t){i=r.id;break}}let l=r.getHeaderCellAdressById(i);return r.getCellRange(l.col,l.row)}let{columnObjects:n}=e.internalProps.layoutMap;for(let i=0;i<n.length;i++)if(n[i].define.componentId===t)return{start:{col:r+i,row:e.columnHeaderLevelCount},end:{col:r+i,row:e.rowCount-1}};return{start:{col:0,row:0},end:{col:e.colCount-1,row:e.rowCount-1}}}(t,i,e);for(let t=r.start.col;t<=r.end.col;t++)for(let e=r.start.row;e<=r.end.row;e++)i.scenegraph.updateCellContent(t,e)}i.scenegraph.renderSceneGraph()}getCustomLayoutFunc(t,e){var i;if(this.table.isHeader(t,e)){let{componentId:r}=this.table.getHeaderDefine(t,e);return null!=(i=this.headerCustomLayoutFuncCache.get(r))?i:n}let{componentId:r}=this.table.getBodyColumnDefine(t,e);return this.customLayoutFuncCache.get(r)||n}removeCustomCell(t,e){let i;if(this.table.isHeader(t,e)){let{componentId:r}=this.table.getHeaderDefine(t,e);i=this.headerReactRemoveGraphicCache.get(r)}else{let{componentId:r}=this.table.getBodyColumnDefine(t,e);i=this.reactRemoveGraphicCache.get(r)}i&&i(t,e)}clearCache(){this.reactRemoveAllGraphicCache.forEach(t=>{t()}),this.headerReactRemoveAllGraphicCache.forEach(t=>{t()})}updateAllCustomCell(){this.customLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e)}),this.headerCustomLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e,!0)})}}},86001:function(t,e,i){i.d(e,{Zv:()=>h,h_:()=>a,lc:()=>d,qi:()=>s,ro:()=>o});var r=i(44843),n=i(20408),l=i(9762);function s(t){var e,i;let l=Object.assign({},t);return(0,r.Z)(t.style)||(l.textStyle=a(t.style)),(0,r.Z)(t.textStyle)||(0,n.Z)(l.textStyle,a(t.textStyle)),(null==(e=t.shape)?void 0:e.style)&&a(l.shape.style),(null==(i=t.background)?void 0:i.style)&&a(l.background.style),l}function a(t){return(0,r.Z)(t)||t.angle&&(t.angle=(0,l.M4)(t.angle)),t}function o(t={}){return(0,r.Z)(t.style)||(t.style=a(t.style)),(0,r.Z)(t.state)||Object.keys(t.state).forEach(e=>{(0,r.Z)(t.state[e])||(t.state[e]=a(t.state[e]))}),t}function h(t){return(0,r.Z)(t)?null:(Object.keys(t).forEach(e=>{(0,r.Z)(t[e])||(t[e]=a(t[e]))}),t)}function d(t){return o(t),o(t.startSymbol),o(t.endSymbol),t}},13746:function(t,e,i){let r,n,l,s,a,o,h,d,u,c,p,g;i.d(e,{D:()=>r3});var f,m,y=i(64776),v=i(79497);let b={CHANGE_STYLE:"change_style"};class _ extends v.R{static get EVENT_TYPE(){return b}static get DEFAULT(){return r||(r=new _)}constructor(t={},e={}){var i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I;super(),this._defaultPadding=[10,16,10,16],this._textAlign=null!=(i=null==t?void 0:t.textAlign)?i:null==e?void 0:e.textAlign,this._textBaseline=null!=(r=null==t?void 0:t.textBaseline)?r:null==e?void 0:e.textBaseline,this._color=null!=(n=null==t?void 0:t.color)?n:null==e?void 0:e.color,this._strokeColor=null!=(l=null==t?void 0:t.strokeColor)?l:null==e?void 0:e.strokeColor,this._fontSize=null!=(s=t.fontSize)?s:null==e?void 0:e.fontSize,this._fontFamily=null!=(a=t.fontFamily)?a:null==e?void 0:e.fontFamily,this._fontWeight=null!=(o=t.fontWeight)?o:null==e?void 0:e.fontWeight,this._fontVariant=null!=(h=t.fontVariant)?h:null==e?void 0:e.fontVariant,this._fontStyle=null!=(d=t.fontStyle)?d:null==e?void 0:e.fontStyle,this._padding=null!=(c=null!=(u=null==t?void 0:t.padding)?u:null==e?void 0:e.padding)?c:this._defaultPadding,this._borderColor=null!=(p=null==t?void 0:t.borderColor)?p:null==e?void 0:e.borderColor,this._textOverflow=null!=(g=null==t?void 0:t.textOverflow)?g:null==e?void 0:e.textOverflow,this._textStick=null!=(m=null!=(f=t.textStick)?f:null==e?void 0:e.textStick)&&m,this._textStickBaseOnAlign=null!=(v=null!=(y=t.textStickBaseOnAlign)?y:null==e?void 0:e.textStickBaseOnAlign)&&v,this._bgColor=null!=(b=null==t?void 0:t.bgColor)?b:null==e?void 0:e.bgColor,this._lineHeight=null!=(_=null==t?void 0:t.lineHeight)?_:null==e?void 0:e.lineHeight,this._underline=null!=(C=null==t?void 0:t.underline)?C:null==e?void 0:e.underline,this._underlineColor=null!=(x=null==t?void 0:t.underlineColor)?x:null==e?void 0:e.underlineColor,this._underlineDash=null!=(w=null==t?void 0:t.underlineDash)?w:null==e?void 0:e.underlineDash,this._underlineOffset=null!=(S=null==t?void 0:t.underlineOffset)?S:null==e?void 0:e.underlineOffset,this._lineThrough=null!=(A=null==t?void 0:t.lineThrough)?A:null==e?void 0:e.lineThrough,this._lineThroughColor=null!=(M=null==t?void 0:t.lineThroughColor)?M:null==e?void 0:e.lineThroughColor,this._lineThroughDash=null!=(T=null==t?void 0:t.lineThroughDash)?T:null==e?void 0:e.lineThroughDash,this._linkColor=null!=(k=null==t?void 0:t.linkColor)?k:null==e?void 0:e.linkColor,this._cursor=null!=(R=t.cursor)?R:null==e?void 0:e.cursor,this._borderLineWidth=null!=(P=t.borderLineWidth)?P:null==e?void 0:e.borderLineWidth,this._borderLineDash=null!=(B=t.borderLineDash)?B:null==e?void 0:e.borderLineDash,this._marked=null!=(I=t.marked)?I:null==e?void 0:e.marked}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get padding(){return this._padding}set padding(t){this._padding=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}get marked(){return this._marked}set marked(t){this._marked=t}clone(){return new _(this,null)}}class C extends _{static get DEFAULT(){return n||(n=new C)}constructor(t={},e={},i={}){var r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S;super(t,e),this._size=(null!=(n=null!=(r=null==t?void 0:t.size)?r:null==e?void 0:e.size)?n:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(s=null!=(l=null==t?void 0:t.spaceBetweenTextAndIcon)?l:null==e?void 0:e.spaceBetweenTextAndIcon)?s:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(o=null==(a=null==t?void 0:t.checkboxStyle)?void 0:a.defaultFill)?o:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(d=null==(h=null==t?void 0:t.checkboxStyle)?void 0:h.defaultStroke)?d:null==i?void 0:i.defaultStroke,this._disableFill=null!=(c=null==(u=null==t?void 0:t.checkboxStyle)?void 0:u.disableFill)?c:null==i?void 0:i.disableFill,this._checkedFill=null!=(g=null==(p=null==t?void 0:t.checkboxStyle)?void 0:p.checkedFill)?g:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(m=null==(f=null==t?void 0:t.checkboxStyle)?void 0:f.checkedStroke)?m:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(v=null==(y=null==t?void 0:t.checkboxStyle)?void 0:y.disableCheckedFill)?v:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(_=null==(b=null==t?void 0:t.checkboxStyle)?void 0:b.disableCheckedStroke)?_:null==i?void 0:i.disableCheckedStroke,this._checkIconImage=null!=(x=null==(C=null==t?void 0:t.checkboxStyle)?void 0:C.checkIconImage)?x:null==i?void 0:i.checkIconImage,this._indeterminateIconImage=null!=(S=null==(w=null==t?void 0:t.checkboxStyle)?void 0:w.indeterminateIconImage)?S:null==i?void 0:i.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new C(t,this)}clone(){return new C(this)}}class x extends _{static get DEFAULT(){return l||(l=new x)}constructor(t={},e={},i={}){var r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M;super(t,e),this._size=(null!=(n=null!=(r=null==t?void 0:t.size)?r:null==e?void 0:e.size)?n:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(s=null!=(l=null==t?void 0:t.spaceBetweenTextAndIcon)?l:null==e?void 0:e.spaceBetweenTextAndIcon)?s:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._spaceBetweenRadio=(null!=(o=null!=(a=null==t?void 0:t.spaceBetweenRadio)?a:null==e?void 0:e.spaceBetweenRadio)?o:null==i?void 0:i.spaceBetweenRadio)||2,this._innerRadius=null!=(d=null==(h=null==t?void 0:t.radioStyle)?void 0:h.innerRadius)?d:null==i?void 0:i.innerRadius,this._outerRadius=null!=(c=null==(u=null==t?void 0:t.radioStyle)?void 0:u.outerRadius)?c:null==i?void 0:i.outerRadius,this._defaultFill=null!=(g=null==(p=null==t?void 0:t.radioStyle)?void 0:p.defaultFill)?g:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(m=null==(f=null==t?void 0:t.radioStyle)?void 0:f.defaultStroke)?m:null==i?void 0:i.defaultStroke,this._disableFill=null!=(v=null==(y=null==t?void 0:t.radioStyle)?void 0:y.disableFill)?v:null==i?void 0:i.disableFill,this._checkedFill=null!=(_=null==(b=null==t?void 0:t.radioStyle)?void 0:b.checkedFill)?_:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(x=null==(C=null==t?void 0:t.radioStyle)?void 0:C.checkedStroke)?x:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(S=null==(w=null==t?void 0:t.radioStyle)?void 0:w.disableCheckedFill)?S:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(M=null==(A=null==t?void 0:t.radioStyle)?void 0:A.disableCheckedStroke)?M:null==i?void 0:i.disableCheckedStroke}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get spaceBetweenRadio(){return this._spaceBetweenRadio}set spaceBetweenRadio(t){this._spaceBetweenRadio=t}get innerRadius(){return this._innerRadius}set innerRadius(t){this._innerRadius=t}get outerRadius(){return this._outerRadius}set outerRadius(t){this._outerRadius=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}getStyle(t){return new x(t,this)}clone(){return new x(this)}}class w extends _{static get DEFAULT(){return s||(s=new w)}constructor(t={},e={},i={}){var r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_;super(t,e),this._spaceBetweenTextAndCircle=(null!=(n=null!=(r=null==t?void 0:t.spaceBetweenTextAndCircle)?r:null==e?void 0:e.spaceBetweenTextAndCircle)?n:null==i?void 0:i.spaceBetweenTextAndCircle)||6,this._circleRadius=(null!=(s=null==(l=null==t?void 0:t.switchStyle)?void 0:l.circleRadius)?s:null==i?void 0:i.circleRadius)||8,this._boxWidth=(null!=(o=null==(a=null==t?void 0:t.switchStyle)?void 0:a.boxWidth)?o:null==i?void 0:i.boxWidth)||40,this._boxHeight=(null!=(d=null==(h=null==t?void 0:t.switchStyle)?void 0:h.boxHeight)?d:null==i?void 0:i.boxHeight)||24,this._checkedFill=(null!=(c=null==(u=null==t?void 0:t.switchStyle)?void 0:u.checkedFill)?c:null==i?void 0:i.checkedFill)||"#165DFF",this._uncheckedFill=(null!=(g=null==(p=null==t?void 0:t.switchStyle)?void 0:p.uncheckedFill)?g:null==i?void 0:i.uncheckedFill)||"#c9cdd4",this._disableCheckedFill=(null!=(m=null==(f=null==t?void 0:t.switchStyle)?void 0:f.disableCheckedFill)?m:null==i?void 0:i.disableCheckedFill)||"#94bfff",this._disableUncheckedFill=(null!=(v=null==(y=null==t?void 0:t.switchStyle)?void 0:y.disableUncheckedFill)?v:null==i?void 0:i.disableUncheckedFill)||"#f2f3f5",this._circleFill=(null!=(_=null==(b=null==t?void 0:t.switchStyle)?void 0:b.circleFill)?_:null==i?void 0:i.circleFill)||"#FFF"}get spaceBetweenTextAndCircle(){return this._spaceBetweenTextAndCircle}set spaceBetweenTextAndCircle(t){this._spaceBetweenTextAndCircle=t}get circleRadius(){return this._circleRadius}set circleRadius(t){this._circleRadius=t}get boxWidth(){return this._boxWidth}set boxWidth(t){this._boxWidth=t}get boxHeight(){return this._boxHeight}set boxHeight(t){this._boxHeight=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get uncheckedFill(){return this._uncheckedFill}set uncheckedFill(t){this._uncheckedFill=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableUncheckedFill(){return this._disableUncheckedFill}set disableUncheckedFill(t){this._disableUncheckedFill=t}get circleFill(){return this._circleFill}set circleFill(t){this._circleFill=t}getStyle(t){return new w(t,this)}clone(){return new w(this)}}class S extends _{static get DEFAULT(){return a||(a=new S)}constructor(t={},e={},i={}){var r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S;super(t,e),this._buttonColor=(null!=(n=null==(r=null==t?void 0:t.buttonStyle)?void 0:r.buttonColor)?n:null==i?void 0:i.buttonColor)||"#165DFF",this._buttonBorderColor=(null!=(s=null==(l=null==t?void 0:t.buttonStyle)?void 0:l.buttonBorderColor)?s:null==i?void 0:i.buttonBorderColor)||"#165DFF",this._buttonLineWidth=(null!=(o=null==(a=null==t?void 0:t.buttonStyle)?void 0:a.buttonLineWidth)?o:null==i?void 0:i.buttonLineWidth)||1,this._buttonBorderRadius=(null!=(d=null==(h=null==t?void 0:t.buttonStyle)?void 0:h.buttonBorderRadius)?d:null==i?void 0:i.buttonBorderRadius)||2,this._buttonHoverColor=(null!=(c=null==(u=null==t?void 0:t.buttonStyle)?void 0:u.buttonHoverColor)?c:null==i?void 0:i.buttonHoverColor)||"#4080FF",this._buttonHoverBorderColor=(null!=(g=null==(p=null==t?void 0:t.buttonStyle)?void 0:p.buttonHoverBorderColor)?g:null==i?void 0:i.buttonHoverBorderColor)||"#4080FF",this._buttonTextHoverColor=null!=(m=null==(f=null==t?void 0:t.buttonStyle)?void 0:f.buttonTextHoverColor)?m:null==i?void 0:i.buttonTextHoverColor,this._buttonDisableColor=(null!=(v=null==(y=null==t?void 0:t.buttonStyle)?void 0:y.buttonDisableColor)?v:null==i?void 0:i.buttonDisableColor)||"#94bfff",this._buttonDisableBorderColor=(null!=(_=null==(b=null==t?void 0:t.buttonStyle)?void 0:b.buttonDisableBorderColor)?_:null==i?void 0:i.buttonDisableBorderColor)||"#94bfff",this._buttonTextDisableColor=null!=(x=null==(C=null==t?void 0:t.buttonStyle)?void 0:C.buttonTextDisableColor)?x:null==i?void 0:i.buttonTextDisableColor,this._buttonPadding=(null!=(S=null==(w=null==t?void 0:t.buttonStyle)?void 0:w.buttonPadding)?S:null==i?void 0:i.buttonPadding)||10}get buttonColor(){return this._buttonColor}set buttonColor(t){this._buttonColor=t}get buttonBorderColor(){return this._buttonBorderColor}set buttonBorderColor(t){this._buttonBorderColor=t}get buttonLineWidth(){return this._buttonLineWidth}set buttonLineWidth(t){this._buttonLineWidth=t}get buttonBorderRadius(){return this._buttonBorderRadius}set buttonBorderRadius(t){this._buttonBorderRadius=t}get buttonHoverColor(){return this._buttonHoverColor}set buttonHoverColor(t){this._buttonHoverColor=t}get buttonHoverBorderColor(){return this._buttonHoverBorderColor}set buttonHoverBorderColor(t){this._buttonHoverBorderColor=t}get buttonTextHoverColor(){return this._buttonTextHoverColor}set buttonTextHoverColor(t){this._buttonTextHoverColor=t}get buttonDisableColor(){return this._buttonDisableColor}set buttonDisableColor(t){this._buttonDisableColor=t}get buttonDisableBorderColor(){return this._buttonDisableBorderColor}set buttonDisableBorderColor(t){this._buttonDisableBorderColor=t}get buttonTextDisableColor(){return this._buttonTextDisableColor}set buttonTextDisableColor(t){this._buttonTextDisableColor=t}get buttonTextHoverBorderColor(){return this._buttonTextHoverBorderColor}set buttonTextHoverBorderColor(t){this._buttonTextHoverBorderColor=t}get buttonPadding(){return this._buttonPadding}set buttonPadding(t){this._buttonPadding=t}getStyle(t){return new S(t,this)}clone(){return new S(this)}}let{EVENT_TYPE:A}=_;function M(t,e,i,r=_,n,l){var s,a,o,h;return t||e?t instanceof _?t:"function"==typeof t?M(t(i),e,i,r,n,l):(t||(t={}),n&&!(0,y.Z)(t.autoWrapText)&&(t.autoWrapText=!0),r===C?new C(null!=t?t:{},null!=e?e:{},null!=(s=l.checkboxStyle)?s:{}):r===x?new x(null!=t?t:{},null!=e?e:{},null!=(a=l.radioStyle)?a:{}):r===w?new w(null!=t?t:{},null!=e?e:{},null!=(o=l.switchStyle)?o:{}):r===S?new S(null!=t?t:{},null!=e?e:{},null!=(h=l.buttonStyle)?h:{}):new r(null!=t?t:{},null!=e?e:{})):r.DEFAULT}var T=i(30430),k=i(16214),R=i(72281),P=i(97266),B=i(23975),I=i(67331),E=i(53476),L=i(93250),F=i(3099),O=i(6958),H=i(31413),D=i(27091),z=i(34505),W=i(73036),Z=i(24197),N=i(34672),j=i(24825),G=i(31877),V=i(53172),U=i(73501),K=i(54572),X=i(22488),Y=i(32802),$=i(4654);function q(t){return!!("cell"===t.role&&(0,$.Z)(t.mergeStartCol)&&(0,$.Z)(t.mergeStartRow)&&(0,$.Z)(t.mergeEndCol)&&(0,$.Z)(t.mergeEndRow))}var J=i(74577),Q=i(95954),te=i(6254),ti=i(4713);function tr(t,e,i,r){!r&&i&&t.table._setRowHeight(e,t.table.getRowHeight(e)+i,!0);for(let r=0;r<t.table.colCount;r++){var n,l,s,a,o,h,d;let u=t.getCell(r,e);if("empty"===u.role)continue;let c=(0,j.Z)(t.table,r,e);c&&c.start.col!==r||(n=t,l=u,s=r,a=e,o=u.attribute.height+i,h=i,d=t.table.isHeader(r,e),l&&tn(n,l,s,a,o,h,d),t.updateCellContentWhileResize(r,e))}let u=0,c=0;e<t.table.frozenRowCount?(u=e+1,c=t.table.frozenRowCount-1):e>=t.table.rowCount-t.table.bottomFrozenRowCount?(u=e+1,c=t.table.rowCount-1):(u=e+1,c=Math.min(t.proxy.rowEnd,t.table.rowCount-t.table.bottomFrozenRowCount-1));for(let e=0;e<t.table.colCount;e++)for(let r=u;r<=c;r++){let n=t.highPerformanceGetCell(e,r);"cell"===n.role&&n.setAttribute("y",n.attribute.y+i)}}function tn(t,e,i,r,n,l,s){var a,o,h,d,u;if(e.attribute.height===n&&!e.needUpdateHeight)return;e.needUpdateHeight=!1,e.setAttribute("height",n);let c=null==(a=t.table.getCellRawRecord(i,r))?void 0:a.vtableMerge,p=!!t.table.getCustomMerge(i,r),g=c||p?"text":t.table.isHeader(i,r)?null!=(o=t.table._getHeaderLayoutMap(i,r).headerType)?o:"text":null!=(h=t.table.getBodyColumnType(i,r))?h:"text";if("progressbar"===g){let s,a=t.table.getBodyColumnDefine(i,r),o=t.table._getCellStyle(i,r),h=t.table.getCellValue(i,r),d=t.table.getCellOriginValue(i,r),u=(0,J.u)((0,Y.WJ)("padding",o,i,r,t.table));(null==a?void 0:a.mergeCell)&&(s=t.table.getCellRange(i,r));let c=G.F.getFunction("createProgressBarCell")(a,o,e.attribute.width,h,d,i,r,u,t.table,s),p=e.getChildByName("progress-bar");e.insertBefore(c,p),e.removeChild(p),p.removeAllChild(),p.release(),tl(e,n,l,t.table.isAutoRowHeight(r),!0,t.table)}else if("sparkline"===g){e.removeAllChild();let n=t.table._getCellStyle(i,r),l=(0,J.u)((0,Y.WJ)("padding",n,i,r,t.table));G.F.getFunction("createSparkLineCellGroup")(e,e.parent,e.attribute.x,e.attribute.y,i,r,e.attribute.width,e.attribute.height,l,t.table,(0,V.RT)(n,t.table,i,r,Y.WJ).theme,!1)}else if("image"===g||"video"===g)(0,K.km)(e,i,r,0,l,t.table);else if("axis"===(null==(d=e.firstChild)?void 0:d.name))null==(u=e.firstChild)||u.originAxis.resize(e.attribute.width,e.attribute.height);else{let s=!0,a=e.getChildByName(U.FH)||e.getChildByName(U.cd);if(a){let n;e.removeChild(a);let l=(0,X.l7)(i,r,e,t.table);if(l)for(let e=l.start.row;e<=l.end.row;e++){if(e===r)continue;let n=t.getCell(i,e),l=n.getChildByName(U.FH)||n.getChildByName(U.cd);l.removeAllChild(),n.removeChild(l),(0,X.l7)(i,e,n,t.table)}else{let l,a,o=t.table.getCellLocation(i,r),{vtableMerge:h}=t.table.getCellRawRecord(i,r)||{};if(h&&t.table.internalProps.groupTitleCustomLayout)a=t.table.internalProps.groupTitleCustomLayout;else if("body"!==o){let e=t.table.getHeaderDefine(i,r);l=null==e?void 0:e.headerCustomRender,a=null==e?void 0:e.headerCustomLayout}else{let e=t.table.getBodyColumnDefine(i,r);l=(null==e?void 0:e.customRender)||t.table.customRender,a=null==e?void 0:e.customLayout}if((l||a)&&q(e))for(let i=e.mergeStartCol;i<=e.mergeEndCol;i++)for(let n=e.mergeStartRow;n<=e.mergeEndRow;n++)n!==r&&t.updateCellContent(i,n);if(a||l){let o=t.table._getCellStyle(i,r),h=(0,J.u)((0,Y.WJ)("padding",o,i,r,t.table)),d=e.attribute.width,u=e.attribute.height;q(e)&&(d=t.table.getColsWidth(e.mergeStartCol,e.mergeEndCol),u=t.table.getRowsHeight(e.mergeStartRow,e.mergeEndRow));let c=(0,U.ws)(a,l,i,r,d,u,!1,t.table.isAutoRowHeight(r),h,q(e)?{start:{col:e.mergeStartCol,row:e.mergeStartRow},end:{col:e.mergeEndCol,row:e.mergeEndRow}}:void 0,t.table);n=c.elementsGroup,s=c.renderDefault}e.childrenCount>0&&n?e.insertBefore(n,e.firstChild):n&&e.appendChild(n)}}tl(e,n,l,t.table.isAutoRowHeight(r),s,t.table)}}function tl(t,e,i,r,n,l){if(q(t)){e=0;for(let i=t.mergeStartRow;i<=t.mergeEndRow;i++)e+=l.getRowHeight(i);let{colStart:s,colEnd:a,rowStart:o,rowEnd:h}=(0,ti.e)(t,l.scenegraph);for(let d=s;d<=a;d++)for(let a=o;a<=h;a++){let h=l.scenegraph.getCell(d,a);if("cell"!==h.role)continue;if(h.forEachChildren(t=>{t.setAttributes({dx:0,dy:0})}),n){let t=l._getCellStyle(s,o),n=(0,J.u)((0,Y.WJ)("padding",t,d,a,l));(0,Q.Zl)(h,e,i,r,n,t.textAlign,t.textBaseline,l)}let u=l.getRowHeight(a),c=l.getColWidth(d);h.contentHeight=e;let{widthChange:p}=(0,X.NQ)(h,c,u,{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}},l);p&&(h.needUpdateWidth=!0)}}else{let n=l._getCellStyle(t.col,t.row),s=(0,J.u)((0,Y.WJ)("padding",n,t.col,t.row,l));(0,Q.Zl)(t,e,i,r,s,n.textAlign,n.textBaseline,l)}}var ts=i(71994);function ta(t,e,i,r){var n,l,s,a,o,h,d;let u=!1,c=null!=(n=null==t?void 0:t.attribute.width)?n:0;if(null==t||t.setAttribute("width",c+e),null==t||t.forEachChildren((t,n)=>{if(function(t,e,i,r,n,l,s,a,o){var h,d,u,c,p,g,f;if(e.attribute.width===l&&!e.needUpdateWidth)return!1;if(e.needUpdateWidth=!1,e.setAttribute("width",l),!e)return!1;let m=t.table.isAutoRowHeight(r),y=null==(h=t.table.getCellRawRecord(i,r))?void 0:h.vtableMerge,v=!!t.table.getCustomMerge(i,r),b=y||v?"text":t.table.isHeader(i,r)?null!=(d=t.table._getHeaderLayoutMap(i,r).headerType)?d:"text":null!=(u=t.table.getBodyColumnType(i,r))?u:"text",_=!1;if("progressbar"===b){let n,a=t.table.getBodyColumnDefine(i,r),o=t.table._getCellStyle(i,r),h=t.table.getCellValue(i,r),d=t.table.getCellOriginValue(i,r),u=(0,J.u)((0,Y.WJ)("padding",o,i,r,t.table));(null==a?void 0:a.mergeCell)&&(n=t.table.getCellRange(i,r));let c=G.F.getFunction("createProgressBarCell")(a,o,e.attribute.width,h,d,i,r,u,t.table,n),p=e.getChildByName("progress-bar");e.insertBefore(c,p),e.removeChild(p),p.removeAllChild(),p.release();let g=to(e,l,s,m,!0,t.table);_=_||g}else if("sparkline"===b){e.removeAllChild();let n=t.table._getCellStyle(i,r),l=(0,J.u)((0,Y.WJ)("padding",n,i,r,t.table));G.F.getFunction("createSparkLineCellGroup")(e,e.parent,e.attribute.x,e.attribute.y,i,r,e.attribute.width,e.attribute.height,l,t.table,(0,V.RT)(n,t.table,i,r,Y.WJ).theme,!1)}else if("image"===b||"video"===b)(0,K.km)(e,i,r,s,0,t.table);else if("axis"===(null==(c=e.firstChild)?void 0:c.name)){let n=t.table.internalProps.layoutMap.getAxisConfigInPivotChart(i,r),l=t.table._getCellStyle(i,r),s=(0,J.u)((0,Y.WJ)("padding",l,i,r,t.table));if(n){let i=new(G.F.getComponent("axis"))(n,e.attribute.width,e.attribute.height,null!=(p=n.__vtableBodyChartCellPadding)?p:s,t.table);e.clear(),e.appendChild(i.component),i.overlap()}}else if("axis"===(null==(g=e.firstChild)?void 0:g.name))null==(f=e.firstChild)||f.originAxis.resize(e.attribute.width,e.attribute.height);else{let n=!0,a=e.getChildByName(U.FH)||e.getChildByName(U.cd);if(a){let l;e.removeChild(a);let s=(0,X.l7)(i,r,e,t.table);if(s)for(let e=s.start.col;e<=s.end.col;e++){if(e===i)continue;let n=t.getCell(e,r),l=n.getChildByName(U.FH)||n.getChildByName(U.cd);l.removeAllChild(),n.removeChild(l),(0,X.l7)(e,r,n,t.table)}else{let s,a,o=t.table.getCellLocation(i,r),{vtableMerge:h}=t.table.getCellRawRecord(i,r)||{};if(h&&t.table.internalProps.groupTitleCustomLayout)a=t.table.internalProps.groupTitleCustomLayout;else if("body"!==o){let e=t.table.getHeaderDefine(i,r);s=null==e?void 0:e.headerCustomRender,a=null==e?void 0:e.headerCustomLayout}else{let e=t.table.getBodyColumnDefine(i,r);s=(null==e?void 0:e.customRender)||t.table.customRender,a=null==e?void 0:e.customLayout}if((s||a)&&q(e)){for(let r=e.mergeStartCol;r<=e.mergeEndCol;r++)if(r!==i)for(let i=e.mergeStartRow;i<=e.mergeEndRow;i++)t.updateCellContent(r,i)}if(a||s){let o=t.table._getCellStyle(i,r),h=(0,J.u)((0,Y.WJ)("padding",o,i,r,t.table)),d=e.attribute.width,u=e.attribute.height;q(e)&&(d=t.table.getColsWidth(e.mergeStartCol,e.mergeEndCol),u=t.table.getRowsHeight(e.mergeStartRow,e.mergeEndRow));let c=(0,U.ws)(a,s,i,r,d,u,!1,t.table.isAutoRowHeight(r),h,q(e)?{start:{col:e.mergeStartCol,row:e.mergeStartRow},end:{col:e.mergeEndCol,row:e.mergeEndRow}}:void 0,t.table);l=c.elementsGroup,n=c.renderDefault,_=!0}e.childrenCount>0&&l?e.insertBefore(l,e.firstChild):l&&e.appendChild(l)}}let o=to(e,l,s,m,n,t.table);_=_||o}return o||(o=t.table._getCellStyle(i,r).autoWrapText),!(!m||!o)&&_}(r,t,t.col,t.row,0,c+e,e,"row-body"!==i||(t.col,r.table.rowHeaderLevelCount),r.table.internalProps.autoWrapText)){let e=(0,j.Z)(r.table,t.col,t.row);if(e&&e.end.row-e.start.row)for(let t=e.start.row;t<=e.end.row;t++)th(r,t);else th(r,t.row);u=!0}}),u){let t,e,n,u=0;for(let c=0;c<r.table.colCount;c++){if("col-corner"===i?(n=0,t=r.getColGroup(c,!0),e=null!=(l=r.colHeaderGroup.attribute.height)?l:0):"row-body"===i?(n=r.table.frozenRowCount,t=r.getColGroup(c,!1),e=null!=(s=r.bodyGroup.attribute.height)?s:0):"bottom"===i?(n=r.table.rowCount-r.table.bottomFrozenRowCount,t=r.getColGroupInBottom(c),e=null!=(a=r.bottomFrozenGroup.attribute.height)?a:0):"left-bottom"===i?(n=r.table.rowCount-r.table.bottomFrozenRowCount,t=r.getColGroupInLeftBottomCorner(c),e=null!=(o=r.leftBottomCornerGroup.attribute.height)?o:0):"right-top"===i?(n=0,t=r.getColGroupInRightTopCorner(c),e=null!=(h=r.rightTopCornerGroup.attribute.height)?h:0):"right-bottom"===i&&(n=r.table.rowCount-r.table.bottomFrozenRowCount,t=r.getColGroupInRightBottomCorner(c),e=null!=(d=r.rightBottomCornerGroup.attribute.height)?d:0),!t)continue;let p=0;t.forEachChildren(t=>{var e;t.setAttribute("y",p),p+=null!=(e=r.table.getRowHeight(t.row))?e:0}),u=p}r.updateContainerHeight(n,u-e);for(let t=0;t<r.table.frozenColCount;t++){let e=r.getColGroupInLeftBottomCorner(t),i=0;null==e||e.forEachChildren(t=>{t.setAttribute("y",i),i+=r.table.getRowHeight(t.row)})}for(let t=r.table.colCount-r.table.rightFrozenColCount;t<r.table.colCount;t++){let e=r.getColGroupInRightBottomCorner(t),i=0;null==e||e.forEachChildren(t=>{t.setAttribute("y",i),i+=r.table.getRowHeight(t.row)})}for(let t=r.table.frozenColCount;t<r.table.colCount-r.table.rightFrozenColCount;t++){let e=r.getColGroupInBottom(t),i=0;null==e||e.forEachChildren(t=>{t.setAttribute("y",i),i+=r.table.getRowHeight(t.row)})}}}function to(t,e,i,r,n,l){if(q(t)){e=0;let s=!1;for(let i=t.mergeStartCol;i<=t.mergeEndCol;i++)e+=l.getColWidth(i);let a=0;for(let e=t.mergeStartRow;e<=t.mergeEndRow;e++)a+=l.getRowHeight(e);let{colStart:o,colEnd:h,rowStart:d,rowEnd:u}=(0,ti.e)(t,l.scenegraph);for(let c=o;c<=h;c++)for(let h=d;h<=u;h++){if(c===t.col&&h!==t.row)continue;let u=l.scenegraph.getCell(c,h);if("cell"!==u.role)continue;u.forEachChildren(t=>{t.setAttributes({dx:0,dy:0})});let p=!1;if(n){let t=l._getCellStyle(o,d),n=(0,J.u)((0,Y.WJ)("padding",t,c,h,l)),s=t.textAlign,g=t.textBaseline;p=(0,Q.qs)(u,e,a,i,r,n,s,g,l.scenegraph);let f=(0,ts.L)(u.col,u.row,l);if(f){let t=u.getChildByName("text"),e=u.getChildByName("expand")||u.getChildByName("collapse");"icon-left"!==(null==e?void 0:e.role)&&t&&t.setAttribute("dx",f)}}let g=l.getRowHeight(h),f=l.getColWidth(c);u.contentWidth=e;let{heightChange:m}=(0,X.NQ)(u,f,g,{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}},l);m&&(u.needUpdateHeight=!0),s=s||p}return s}let s=l._getCellStyle(t.col,t.row),a=(0,J.u)((0,Y.WJ)("padding",s,t.col,t.row,l)),o=s.textAlign,h=s.textBaseline;return(0,Q.qs)(t,e,l.getRowHeight(t.row),i,r,a,o,h,l.scenegraph)}function th(t,e){let i=Math.round((0,te.P)(e,0,t.table.colCount-1,t.table));t.table._setRowHeight(e,i,!0);for(let s=0;s<t.table.colCount;s++){var r,n,l;let a=t.highPerformanceGetCell(s,e);"empty"!==a.role&&(r=s,n=i-a.attribute.height,l=t.table.isHeader(s,e),a&&tn(t,a,r,e,i,n,l))}}var td=i(9252),tu=i(63654),tc=i(22288),tp=i(8849),tg=i(88266),tf=i(20219),tm=i(68173);(f=m||(m={})).dropDown="dropDown",f.contextmenu="contextmenu",f.custom="custom";let ty={fontSize:12,fontFamily:"Arial,sans-serif",color:"#000",highlightColor:"#2E68CF",hoverBgColor:"#EEE",lineHeight:30,bgColor:"#FFF",cornerRadius:4,borderWidth:.5,borderColor:"#CCC",menuPadding:6,menuItemPadding:9,maxLineWidth:200};class tv{constructor(t){this._table=t,this._menuInstance=new tf.Z({x:0,y:0,fill:ty.bgColor,stroke:ty.borderColor,cornerRadius:ty.cornerRadius,lineWidth:ty.borderWidth}),this._menuInfo={x:-1,y:-1,col:-1,row:-1,type:m.dropDown,menuInfo:[],highlightIndex:-1}}bindTableComponent(t){t.appendChild(this._menuInstance),this.bindEvent()}release(){}attach(t,e,i,r,n,l){if(n===m.dropDown&&this.checkDropDownMenuChange(i,r)){let t=this.getMenuInfo(i,r,n);if(!t)return;let{menuInfo:e,highlightIndex:l}=t;this.updateMenuInfo(i,r,n,e,l),this.updateMenuInstance(e,l)}else if(n===m.contextmenu&&this.checkContextMenuChange(t,e)){let t=this.getMenuInfo(i,r,n);if(!t)return;let{menuInfo:e,highlightIndex:l}=t;this.updateMenuInfo(i,r,n,e,l),this.updateMenuInstance(e,l)}this.updatePosition(t-this._table.scenegraph.x,e-this._table.scenegraph.y),this.addToScene()}updateMenuInfo(t,e,i,r,n){this._menuInfo.col=t,this._menuInfo.row=e,this._menuInfo.type=i,this._menuInfo.menuInfo=r,this._menuInfo.highlightIndex=n}checkDropDownMenuChange(t,e){let{type:i,col:r,row:n}=this._menuInfo;return i!==m.dropDown||t!==r||e!==n}checkContextMenuChange(t,e){var i;let{type:r,menuInfo:n}=this._menuInfo;return r!==m.contextmenu||n!==(null==(i=this._table.internalProps.menu)?void 0:i.contextMenuItems)}updateMenuInstance(t,e){this._menuInstance.removeAllChild();let i=ty.menuPadding,r=ty.menuPadding,n=0;t.forEach((t,l)=>{var s,a;let o,h,d=e===l;"string"==typeof t?h=t:"object"==typeof t&&(h=t.text,o=d?t.selectedIcon:t.icon);let u=new tf.Z({y:i,x:r,height:ty.lineHeight,fill:ty.bgColor});u.role="menu-item",this._menuInstance.appendChild(u),u.stateProxy=t=>"hover"===t?{fill:ty.hoverBgColor}:{fill:ty.bgColor},u.addEventListener("pointerenter",t=>{u.addState("hover",!0,!1),this._table.scenegraph.updateNextFrame()}),u.addEventListener("pointerleave",t=>{u.removeState("hover",!1),this._table.scenegraph.updateNextFrame()});let c=new tu.x({x:ty.menuItemPadding,y:ty.menuItemPadding,fill:d?ty.highlightColor:ty.color,text:h,textBaseline:"top",fontSize:ty.fontSize,fontFamily:ty.fontFamily,pickable:!1,maxLineWidth:ty.maxLineWidth,ellipsis:"…"});if(u.addChild(c),o){c.AABBBounds.height();let t=null!=(s=o.width)?s:16,e=null!=(a=o.height)?a:16,i=new tm.J({x:ty.menuItemPadding,y:(ty.lineHeight-e)/2,width:t,height:e,image:o.svg,pickable:!1});i.role="menu-icon",u.insertBefore(i,c),c.setAttribute("x",t+ty.menuItemPadding)}n=Math.max(u.AABBBounds.width(),n),i+=ty.lineHeight}),this._menuInstance.setAttributes({width:n+2*ty.menuItemPadding+2*ty.menuPadding,height:i+ty.menuPadding}),this._menuInstance.forEachChildren(t=>{t.setAttribute("width",n+2*ty.menuItemPadding)})}updatePosition(t,e){this._menuInstance.setAttributes({x:this._menuInfo.type===m.dropDown?t-this._menuInstance.attribute.width:t,y:e}),this._menuInfo.x=m.dropDown?t-this._menuInstance.attribute.width:t,this._menuInfo.y=e}addToScene(){this._table.scenegraph.updateNextFrame()}detach(){this._menuInstance.setAttributes({x:-1e3,y:-1e3}),this._table.scenegraph.updateNextFrame()}getMenuInfo(t,e,i){var r;if(i===m.dropDown){let i=this._table.globalDropDownMenu;"function"==typeof(i=this._table._getHeaderLayoutMap(t,e).dropDownMenu)&&(i=i({row:e,col:t,table:this._table}));let r=-1;if(Array.isArray(i)){for(let n=0;n<i.length;n++)if(this._table._dropDownMenuIsHighlight(t,e,n)){r=n;break}}return{menuInfo:i,highlightIndex:r}}if(i===m.contextmenu){let i,n=null==(r=this._table.internalProps.menu)?void 0:r.contextMenuItems;if(Array.isArray(n))i=n;else if("function"==typeof n){let{field:r}=this._table.isHeader(t,e)?this._table.getHeaderDefine(t,e):this._table.getBodyColumnDefine(t,e);i=n(r,e,t)}return{menuInfo:i,highlightIndex:-1}}}bindEvent(){this._menuInstance.addEventListener("click",t=>{let{target:e}=t;if(e&&"menu-item"===e.role){let i=Object.assign(this.getEventInfo(e),this._table.getMenuInfo(this._menuInfo.col,this._menuInfo.row,this._menuInfo.type));i.event=t.nativeEvent,this._table.fireListeners(I.B.DROPDOWN_MENU_CLICK,i)}})}getEventInfo(t){let e=t.parent,i=0;e.forEachChildren((e,r)=>e===t&&(i=r-1,!0));let r="string"==typeof this._menuInfo.menuInfo[i]?this._menuInfo.menuInfo[i]:this._menuInfo.menuInfo[i].text,n="string"==typeof this._menuInfo.menuInfo[i]?r:this._menuInfo.menuInfo[i].menuKey||r;return{col:this._menuInfo.col,row:this._menuInfo.row,dropDownIndex:i,highlight:i===this._menuInfo.highlightIndex,text:r,menuKey:n}}get bounds(){return this._menuInstance.globalAABBBounds}}var tb=i(9607);let t_=tb.U2();class tC{constructor(){let t=t_.drillDown;this.icon=new tm.J({x:-1e3,y:-1e3,image:t.svg,width:t.width,height:t.height,dx:-t.width/2,dy:-t.height/2,visible:!1,funcType:t.funcType,cursor:t.cursor}),this.icon.role="icon-drill"}appand(t){t.appendChild(this.icon)}update(t,e,i,r,n,l){if(!t||r&&n)return this.icon.setAttributes({x:-1e3,y:-1e3,visible:!1}),void l.updateNextFrame();let s=t_.drillDown,a=t_.drillUp;this.icon.setAttributes({x:e,y:i,image:r?s.svg:a.svg,visible:!0}),this.icon.loadImage(this.icon.attribute.image),l.updateNextFrame()}}var tx=i(78503);class tw{constructor(t){let e=t.theme.dragHeaderSplitLine.lineWidth,i=t.theme.dragHeaderSplitLine.lineColor,r=t.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel=(0,tx.t)({visible:!1,pickable:!1,x:0,y:0,symbolType:"triangle",fill:i}),this.columnMoverLine=(0,td.W)({visible:!1,pickable:!1,stroke:i,lineWidth:e,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnMoverBack=(0,tc.f)({visible:!1,pickable:!1,fill:r,x:0,y:0,width:0,height:0}),this.table=t}appand(t){t.appendChild(this.columnMoverLabel),t.appendChild(this.columnMoverLine),t.appendChild(this.columnMoverBack)}show(t,e,i){let r=this.table.getCellLocation(t,e),n=(0,j.Z)(this.table,t,e);n&&(t=n.start.col,e=n.start.row);let l=0,s=0,a=0,o=0,h=0,d=0,u=0,c=0,p=Math.PI,g=[],f=this.table.stateManager.columnMove.movingColumnOrRow;return"columnHeader"===r&&void 0===f||"column"===f?(l=this.table.getColsWidth(0,t-1)-this.table.stateManager.scroll.horizontalBarPos,s=this.table.getRowsHeight(0,this.table.frozenRowCount-1),o=this.table.tableNoFrameHeight,a=n?this.table.getColsWidth(n.start.col,n.end.col):this.table.getColWidth(t),h=l-i,u=l+a,c=2,g.push({x:0,y:0}),g.push({x:0,y:this.table.tableNoFrameHeight})):("rowHeader"===r||this.table.internalProps.layoutMap.isSeriesNumberInBody(t,e)||"row"===f)&&(s=this.table.getRowsHeight(0,e-1)-this.table.stateManager.scroll.verticalBarPos,l=this.table.getColsWidth(0,this.table.frozenColCount-1),a=this.table.tableNoFrameWidth,o=n?this.table.getRowsHeight(n.start.row,n.end.row):this.table.getRowHeight(e),d=s-i,u=2,c=s+o,p=Math.PI/2,g.push({x:0,y:0}),g.push({x:this.table.tableNoFrameWidth,y:0})),this.columnMoverBack.setAttributes({visible:!0,x:l-h,y:s-d,width:a,height:o,dx:h,dy:d}),this.columnMoverLine.setAttributes({x:u,y:c,visible:!0,points:g}),this.columnMoverLabel.setAttributes({visible:!0,x:u,y:c,angle:p}),{backX:l-h,lineX:u,backY:s-d,lineY:c}}hide(){this.columnMoverLabel.setAttribute("visible",!1),this.columnMoverLine.setAttribute("visible",!1),this.columnMoverBack.setAttribute("visible",!1)}update(t,e,i,r){"number"==typeof t&&"number"==typeof e?(this.columnMoverLabel.setAttribute("x",e),this.columnMoverLine.setAttribute("x",e),this.columnMoverBack.setAttribute("x",t)):"number"==typeof i&&"number"==typeof r&&(this.columnMoverLabel.setAttribute("y",r),this.columnMoverLine.setAttribute("y",r),this.columnMoverBack.setAttribute("y",i))}updateStyle(){let t=this.table.theme.dragHeaderSplitLine.lineWidth,e=this.table.theme.dragHeaderSplitLine.lineColor,i=this.table.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel.setAttributes({fill:e}),this.columnMoverLine.setAttributes({stroke:e,lineWidth:t}),this.columnMoverBack.setAttributes({fill:i})}}function tS(t,e,i){if(i)return Math.min(e.tableNoFrameWidth,e.getAllColsWidth())-e.getColsWidth(t,e.colCount-1);let r=e.getColsWidth(0,t);return t>=e.frozenColCount&&(r-=e.scrollLeft),r}function tA(t,e,i){if(i)return Math.min(e.tableNoFrameWidth,e.getAllRowsHeight())-e.getRowsHeight(t,e.rowCount-1);let r=e.getRowsHeight(0,t);return t>=e.frozenRowCount&&(r-=e.scrollTop),r}class tM{constructor(t){var e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b;this.table=t;let _=this.table.theme;this.createScrollBar();let C=null==(e=_.columnResize)?void 0:e.lineColor,x=null==(i=_.columnResize)?void 0:i.lineWidth,w=null==(r=_.columnResize)?void 0:r.bgColor,S=null==(n=_.columnResize)?void 0:n.width,A=null==(s=null==(l=_.columnResize)?void 0:l.labelVisible)||s,M=null==(a=_.columnResize)?void 0:a.labelColor,T=null==(o=_.columnResize)?void 0:o.labelFontSize,k=null==(h=_.columnResize)?void 0:h.labelFontFamily,R=null==(d=_.columnResize)?void 0:d.labelBackgroundFill,P=null==(u=_.columnResize)?void 0:u.labelBackgroundCornerRadius;this.labelVisible=A,this.columnResizeLine=(0,td.W)({visible:!1,pickable:!1,stroke:C,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnResizeBgLine=(0,td.W)({visible:!1,pickable:!1,stroke:w,lineWidth:S,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});let B=(0,tu.r)({visible:!1,pickable:!1,x:0,y:0,fontSize:T,fill:M,fontFamily:k,text:"",textBaseline:"top",dx:16,dy:-T/2}),I=(0,tc.f)({visible:!1,pickable:!1,fill:R,x:0,y:0,width:5*T*.8,height:T+8,cornerRadius:P,dx:12,dy:-T/2-4});this.columnResizeLabel=(0,tp.sS)({visible:!1,pickable:!1,x:0,y:0}),this.columnResizeLabel.appendChild(I),this.columnResizeLabel.appendChild(B),this.rowResizeLine=(0,td.W)({visible:!1,pickable:!1,stroke:C,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.rowResizeBgLine=(0,td.W)({visible:!1,pickable:!1,stroke:w,lineWidth:S,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});let E=(0,tu.r)({visible:!1,pickable:!1,x:0,y:0,fontSize:T,fill:M,fontFamily:k,text:"",textBaseline:"top",dx:16,dy:-T/2}),L=(0,tc.f)({visible:!1,pickable:!1,fill:R,x:0,y:0,width:5*T*.8,height:T+8,cornerRadius:P,dx:12,dy:-T/2-4});this.rowResizeLabel=(0,tp.sS)({visible:!1,pickable:!1,x:0,y:0}),this.rowResizeLabel.appendChild(L),this.rowResizeLabel.appendChild(E),this.cellMover=new tw(this.table);let F=null==(p=null==(c=_.frozenColumnLine)?void 0:c.shadow)?void 0:p.width,O=null==(f=null==(g=_.frozenColumnLine)?void 0:g.shadow)?void 0:f.startColor,H=null==(y=null==(m=_.frozenColumnLine)?void 0:m.shadow)?void 0:y.endColor,D=null==(b=null==(v=_.frozenColumnLine)?void 0:v.shadow)?void 0:b.visible;this.frozenShadowLine=(0,tc.f)({visible:"always"===D,pickable:!1,x:0,y:0,width:F,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:O,offset:0},{color:H,offset:1}]}}),this.rightFrozenShadowLine=(0,tc.f)({visible:"always"===D,pickable:!1,x:0,y:0,width:F,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:H,offset:0},{color:O,offset:1}]}}),this.menu=new tv(this.table),this.drillIcon=new tC}addToGroup(t){t.addChild(this.frozenShadowLine),t.addChild(this.rightFrozenShadowLine),t.addChild(this.columnResizeBgLine),t.addChild(this.columnResizeLine),t.addChild(this.columnResizeLabel),t.addChild(this.rowResizeBgLine),t.addChild(this.rowResizeLine),t.addChild(this.rowResizeLabel),this.table.theme.scrollStyle.hoverOn&&!this.table.theme.scrollStyle.barToSide?(t.addChild(this.hScrollBar),t.addChild(this.vScrollBar)):(t.stage.defaultLayer.addChild(this.hScrollBar),t.stage.defaultLayer.addChild(this.vScrollBar)),this.menu.bindTableComponent(t),this.drillIcon.appand(t),this.cellMover.appand(t)}createScrollBar(){var t,e,i,r,n,l;let s,a=this.table.theme,o=null==(t=a.scrollStyle)?void 0:t.scrollRailColor,h=null==(e=a.scrollStyle)?void 0:e.scrollSliderColor,d=null==(i=a.scrollStyle)?void 0:i.scrollSliderCornerRadius,u=null==(r=a.scrollStyle)?void 0:r.width,c=null==(n=a.scrollStyle)?void 0:n.horizontalPadding,p=null==(l=a.scrollStyle)?void 0:l.verticalPadding;s=(0,y.Z)(d)?{cornerRadius:d,fill:h}:{fill:h},this.hScrollBar=new tg.B({direction:"horizontal",x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:this.table.tableNoFrameWidth,height:u,padding:c,railStyle:{fill:o},sliderStyle:s,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new tg.B({direction:"vertical",x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:u,height:this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight(),padding:p,railStyle:{fill:o},sliderStyle:s,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}updateScrollBar(){var t,e,i,r,n,l,s,a,o;let h=this.table.stateManager.scroll.horizontalBarPos,d=this.table.stateManager.scroll.verticalBarPos,u=this.table.theme,c=null==(t=u.scrollStyle)?void 0:t.width,p=null==(e=u.scrollStyle)?void 0:e.visible,g=null!=(r=null==(i=u.scrollStyle)?void 0:i.horizontalVisible)?r:p,f=null!=(l=null==(n=u.scrollStyle)?void 0:n.verticalVisible)?l:p,m=Math.ceil(this.table.tableNoFrameWidth),y=Math.ceil(this.table.tableNoFrameHeight),v=this.table.getAllRowsHeight(),b=this.table.getAllColsWidth(),_=this.table.getFrozenRowsHeight(),C=this.table.getFrozenColsWidth(),x=this.table.getBottomFrozenRowsHeight(),w=this.table.getRightFrozenColsWidth(),S=this.table.theme.scrollStyle.hoverOn,A=+(null!=(s=this.table.options.customConfig)&&!!s._disableColumnAndRowSizeRound);if(b>m+A){let t=Math.min(y,v),e=Math.max(.05,(m-C)/(b-C)),i=0;i=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameHeight-(S?c:-this.table.scenegraph.tableGroup.attribute.y)+this.table.tableY:t-(S?c:-this.table.scenegraph.tableGroup.attribute.y);let r=C+(S?0:this.table.scenegraph.tableGroup.attribute.x),n=m-C-w;null!=(o=null==(a=this.table.theme.scrollStyle)?void 0:a.ignoreFrozenCols)&&o?(r=S?0:this.table.scenegraph.tableGroup.attribute.x,n=m):(r=C+(S?0:this.table.scenegraph.tableGroup.attribute.x),n=m-C-w),this.hScrollBar.setAttributes({x:r,y:i,width:n,range:[0,e],visible:"always"===g});let l=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:l.x1,y:l.y1},"always"===g&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),width:0,visible:!1});if(v>y+A){let t=Math.min(m,b),e=Math.max(.05,(y-_)/(v-_)),i=0;i=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameWidth-(S?c:-this.table.scenegraph.tableGroup.attribute.x)+this.table.tableX:t-(S?c:-this.table.scenegraph.tableGroup.attribute.x),this.vScrollBar.setAttributes({x:i,y:_+(S?0:this.table.scenegraph.tableGroup.attribute.y),height:y-_-x,range:[0,e],visible:"always"===f});let r=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:r.x1,y:r.y1},"always"===f&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:-(2*this.table.tableNoFrameWidth),y:-(2*this.table.tableNoFrameHeight),height:0,visible:!1});this.table.stateManager.setScrollLeft(h),this.table.stateManager.setScrollTop(d)}hideResizeCol(){this.columnResizeLine.setAttribute("visible",!1),this.columnResizeBgLine.setAttribute("visible",!1),this.columnResizeLabel.setAttribute("visible",!1),this.columnResizeLabel.hideAll()}showResizeCol(t,e,i){let r=tS(t,this.table,i);this.columnResizeLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.showAll(),this.columnResizeLabel.setAttributes({visible:!0,x:r,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${this.table.getColWidth(t)}px`))}updateResizeCol(t,e,i){let r=tS(t,this.table,i);this.columnResizeLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.setAttributes({x:r,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getColWidth(t))}px`))}hideResizeRow(){this.rowResizeLine.setAttribute("visible",!1),this.rowResizeBgLine.setAttribute("visible",!1),this.rowResizeLabel.setAttribute("visible",!1),this.rowResizeLabel.hideAll()}showResizeRow(t,e,i){let r=tA(t,this.table,i);this.rowResizeLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.showAll(),this.rowResizeLabel.setAttributes({visible:!0,y:r,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${this.table.getRowHeight(t)}px`))}updateResizeRow(t,e,i){let r=tA(t,this.table,i);this.rowResizeLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.setAttributes({y:r,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getRowHeight(t))}px`))}hideMoveCol(){this.cellMover.hide()}showMoveCol(t,e,i){return this.cellMover.show(t,e,i)}updateMoveCol(t,e,i,r){this.cellMover.update(t,e,i,r)}setFrozenColumnShadow(t,e){var i,r;let n=tS(t,this.table,e);t<0||"always"!==(null==(r=null==(i=this.table.theme.frozenColumnLine)?void 0:i.shadow)?void 0:r.visible)?this.frozenShadowLine.setAttributes({visible:!1,x:n,height:this.table.getDrawRange().height}):this.frozenShadowLine.setAttributes({visible:!0,x:n,height:this.table.getDrawRange().height})}setRightFrozenColumnShadow(t){var e,i;let r=tS(t,this.table,!0);t>=this.table.colCount||"always"!==(null==(i=null==(e=this.table.theme.frozenColumnLine)?void 0:e.shadow)?void 0:i.visible)?this.rightFrozenShadowLine.setAttributes({visible:!1,x:r-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height}):this.rightFrozenShadowLine.setAttributes({visible:!0,x:r-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height})}hideFrozenColumnShadow(){var t,e,i,r,n;let l=null==(e=null==(t=this.table.theme.frozenColumnLine)?void 0:t.shadow)?void 0:e.visible;"scrolling"===(null!=(n=null==(r=null==(i=this.table.theme.frozenColumnLine)?void 0:i.shadow)?void 0:r.visible)?n:l)&&(this.frozenShadowLine.setAttribute("visible",!1),this.rightFrozenShadowLine.setAttribute("visible",!1),this.table.scenegraph.updateNextFrame())}showFrozenColumnShadow(){var t,e,i,r,n;let l=null==(e=null==(t=this.table.theme.frozenColumnLine)?void 0:t.shadow)?void 0:e.visible;"scrolling"===(null!=(n=null==(r=null==(i=this.table.theme.frozenColumnLine)?void 0:i.shadow)?void 0:r.visible)?n:l)&&(this.frozenShadowLine.setAttribute("visible",!0),this.rightFrozenShadowLine.setAttribute("visible",!0),this.table.scenegraph.updateNextFrame())}hideVerticalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,i=null!=(t=this.table.theme.scrollStyle.verticalVisible)?t:e;"focus"!==i&&"scrolling"!==i||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showVerticalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,i=null!=(t=this.table.theme.scrollStyle.verticalVisible)?t:e;"focus"!==i&&"scrolling"!==i||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}hideHorizontalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,i=null!=(t=this.table.theme.scrollStyle.horizontalVisible)?t:e;"focus"!==i&&"scrolling"!==i||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showHorizontalScrollBar(){var t;let e=this.table.theme.scrollStyle.visible,i=null!=(t=this.table.theme.scrollStyle.horizontalVisible)?t:e;"focus"!==i&&"scrolling"!==i||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}updateVerticalScrollBarPos(t){let e=this.vScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.vScrollBar.setAttribute("range",[r,r+i]);let n=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:n.x1,y:n.y1}}updateHorizontalScrollBarPos(t){let e=this.hScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.hScrollBar.setAttribute("range",[r,r+i]);let n=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:n.x1,y:n.y1}}updateStyle(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,v,b,_,C,x,w;let S,A=this.table.theme,M=null==(t=A.scrollStyle)?void 0:t.scrollRailColor,T=null==(e=A.scrollStyle)?void 0:e.scrollSliderColor,k=null==(i=A.scrollStyle)?void 0:i.scrollSliderCornerRadius,R=null==(r=A.scrollStyle)?void 0:r.width,P=null==(n=A.scrollStyle)?void 0:n.horizontalPadding,B=null==(l=A.scrollStyle)?void 0:l.verticalPadding;S=(0,y.Z)(k)?{cornerRadius:k,fill:T}:{fill:T},this.hScrollBar.setAttributes({height:R,padding:P,railStyle:{fill:M},sliderStyle:S}),this.vScrollBar.setAttributes({width:R,padding:B,railStyle:{fill:M},sliderStyle:S});let I=null==(s=A.columnResize)?void 0:s.lineColor,E=null==(a=A.columnResize)?void 0:a.lineWidth,L=null==(o=A.columnResize)?void 0:o.bgColor,F=null==(h=A.columnResize)?void 0:h.width;this.columnResizeLine.setAttributes({stroke:I,lineWidth:E}),this.columnResizeBgLine=(0,td.W)({stroke:L,lineWidth:F});let O=null==(d=A.columnResize)?void 0:d.labelColor,H=null==(u=A.columnResize)?void 0:u.labelFontSize,D=null==(c=A.columnResize)?void 0:c.labelFontFamily,z=null==(p=A.columnResize)?void 0:p.labelBackgroundFill,W=null==(g=A.columnResize)?void 0:g.labelBackgroundCornerRadius,Z=null==(m=null==(f=A.columnResize)?void 0:f.labelVisible)||m;this.labelVisible=Z,this.columnResizeLabel.lastChild.setAttributes({fontSize:H,fill:O,fontFamily:D,dy:-H/2}),this.columnResizeLabel.firstChild.setAttributes({fill:z,width:5*H*.8,height:H+8,cornerRadius:W,dy:-H/2-4}),this.rowResizeLabel.lastChild.setAttributes({fontSize:H,fill:O,fontFamily:D,dy:-H/2}),this.rowResizeLabel.firstChild.setAttributes({fill:z,width:5*H*.8,height:H+8,cornerRadius:W,dy:-H/2-4});let N=null==(b=null==(v=A.frozenColumnLine)?void 0:v.shadow)?void 0:b.width,j=null==(C=null==(_=A.frozenColumnLine)?void 0:_.shadow)?void 0:C.startColor,G=null==(w=null==(x=A.frozenColumnLine)?void 0:x.shadow)?void 0:w.endColor;this.frozenShadowLine.setAttributes({width:N,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:j,offset:0},{color:G,offset:1}]}}),this.rightFrozenShadowLine.setAttributes({width:N,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:G,offset:0},{color:j,offset:1}]}}),this.cellMover.updateStyle()}}var tT=i(95723);function tk(t,e,i,r,n){var l,s,a,o,h,d;if(!e)return;let u="table"===i,{shadowBlur:c,shadowOffsetX:p,shadowOffsetY:g,shadowColor:f,cornerRadius:m,borderColor:y,borderLineWidth:v,borderLineDash:b}=e,_=!1,C={},x={pickable:!1};c&&u&&(x.shadowBlur=c,x.shadowOffsetX=p,x.shadowOffsetY=g,x.shadowColor=f,x.stroke=!0,x.stroke=f,x.lineWidth=1,_=!0),v&&(x.stroke=!0,x.fill=!1,x.stroke=tP(null!=y?y:"#E1E4E8",r,v),x.lineWidth=v,b&&(x.lineDash=b),x.lineCap="butt"),Array.isArray(y)&&(x.strokeArrayColor=(0,J.u)(y)),Array.isArray(v)&&(x.strokeArrayWidth=(0,J.u)(v),x.lineWidth=1),m&&(x.cornerRadius=m,C.cornerRadius=m);let w=x.strokeArrayWidth?x.strokeArrayWidth[0]:null!=(l=x.lineWidth)?l:0,S=x.strokeArrayWidth?x.strokeArrayWidth[1]:null!=(s=x.lineWidth)?s:0,A=x.strokeArrayWidth?x.strokeArrayWidth[2]:null!=(a=x.lineWidth)?a:0,M=x.strokeArrayWidth?x.strokeArrayWidth[3]:null!=(o=x.lineWidth)?o:0;if(t.setAttributes(C),!n)if(x.stroke)if(x.x=M/2,x.y=w/2,x.pickable=!1,u){let i,r;if(m)if(Array.isArray(m)){let t=(0,J.u)(m);x.cornerRadius=t,C.cornerRadius=t,t[0]&&(t[0]=t[0]+Math.min(M,w)/2),t[1]&&(t[1]=t[1]+Math.min(w,S)/2),t[2]&&(t[2]=t[2]+Math.min(S,A)/2),t[3]&&(t[3]=t[3]+Math.min(A,M)/2)}else if((0,tT.Z)(v)){let t=[];x.cornerRadius=t,C.cornerRadius=t,t[0]=m+Math.min(M,w)/2,t[1]=m+Math.min(w,S)/2,t[2]=m+Math.min(S,A)/2,t[3]=m+Math.min(A,M)/2}else x.cornerRadius=m+(null!=(h=x.lineWidth)?h:0)/2,C.cornerRadius=m+(null!=(d=x.lineWidth)?d:0)/2;if(e.innerBorder?(x.x=t.attribute.x+M/2,x.y=t.attribute.y+w/2,x.width=t.attribute.width-M/2-S/2,x.height=t.attribute.height-w/2-A/2):(x.x=t.attribute.x-M/2,x.y=t.attribute.y-w/2,x.width=t.attribute.width+M/2+S/2,x.height=t.attribute.height+w/2+A/2),_){x.fill="white",x.notAdjustPos=!0,(r=(0,tp.sS)(x)).name="table-border-rect",i=(0,tc.f)({x:M/2,y:w/2,width:t.attribute.width,height:t.attribute.height,fill:"red",cornerRadius:t.attribute.cornerRadius,globalCompositeOperation:"destination-out"}),r.addChild(i);let e=(0,tc.f)({x:M/2,y:w/2,width:t.attribute.width,height:t.attribute.height,fill:"transparent",pickable:!1,globalCompositeOperation:"source-over"});r.addChild(e)}else(r=(0,tc.f)(x)).name="table-border-rect";e.innerBorder&&!_?t.parent.insertAfter(r,t):t.parent.insertBefore(r,t),t.border=r}else{x.width=t.attribute.width-M/2-S/2,x.height=t.attribute.height-w/2-A/2;let e=(0,tc.f)(x);e.name="border-rect",t.addChild(e),t.border=e}else{let e=(0,tc.f)({fill:!1,stroke:!1,pickable:!1,lineWidth:0});e.name="border-rect",t.addChild(e),t.border=e}}function tR(t,e,i){var r;if(!e)return;let{borderColor:n}=e;null==(r=t.border)||r.setAttribute("stroke",tP(n,i))}function tP(t,e,i){let r=!0;return!e&&!(0,tT.Z)(i)||(0,tT.Z)(t)?e?r=e:e||(0,tT.Z)(t)?(0,tT.Z)(t)&&(r=!0):r=t:r=(null!=e?e:i).map(e=>!!e&&t),r}function tB(t){var e,i,r,n;if(!t.border)return;let l=t.border.attribute.strokeArrayWidth?t.border.attribute.strokeArrayWidth[0]:null!=(e=t.border.attribute.lineWidth)?e:0,s=t.border.attribute.strokeArrayWidth?t.border.attribute.strokeArrayWidth[1]:null!=(i=t.border.attribute.lineWidth)?i:0,a=t.border.attribute.strokeArrayWidth?t.border.attribute.strokeArrayWidth[2]:null!=(r=t.border.attribute.lineWidth)?r:0,o=t.border.attribute.strokeArrayWidth?t.border.attribute.strokeArrayWidth[3]:null!=(n=t.border.attribute.lineWidth)?n:0;t.border.setAttributes({borderLeft:o,borderTop:l,borderRight:s,borderBottom:a,width:t.attribute.width-o/2-s/2,height:t.attribute.height-l/2-a/2}),"group"===t.border.type&&t.border.firstChild.setAttributes({width:t.attribute.width,height:t.attribute.height})}function tI(t,e){t.setAttribute("cornerRadius",e),t.border&&t.border.setAttribute("cornerRadius",e)}var tE=i(22415),tL=i(3570),tF=i(13922),tO=i(32227),tH=i(57355),tD=i(85668),tz=i(75946),tW=i(17852),tZ=i(34865),tN=i(98075),tj=i(8347);let tG=Symbol.for("ChartRender");Symbol.for("ChartRenderContribution");let tV=class extends tz.Y{constructor(){super(...arguments),this.numberType=tN.e}drawShape(t,e,i,r,n,l,s,a){var o,h,d,u;let c=(0,tW.gh)(t,null==l?void 0:l.theme).group,{dataId:p,data:g,spec:f}=t.attribute,{width:m=c.width,height:y=c.height}=t.attribute,{table:v}=t.getRootNode(),{cacheCanvas:b,activeChartInstance:_}=t;if(!_&&b)(0,tT.Z)(b)?b.forEach(t=>{let{x:i,y:r,width:n,height:l,canvas:s}=t;e.drawImage(s,i,r,n,l)}):e.drawImage(b,i,r,m,y);else if(_){if(v.options.specFormat){let e=v.options.specFormat(t.attribute.spec,_,t);if(e.needFormatSpec&&e.spec){let t=e.spec;_.updateSpecSync(t,!1,{reuse:!1,morph:!1})}}let e=t.activeChartInstanceLastViewBox,i=t.getViewBox();e&&i.x1===e.x1&&i.x2===e.x2&&i.y1===e.y1&&i.y2===e.y2||_.updateViewBox({x1:0,x2:i.x2-i.x1,y1:0,y2:i.y2-i.y1},!1,!1);let r=_.getStage();r.needRender=!0;let n=t.globalTransMatrix.clone(),l=t.stage.window.getViewBoxTransform().clone();if(l.multiply(n.a,n.b,n.c,n.d,n.e,n.f),r.window.setViewBoxTransform(l.a,l.b,l.c,l.d,l.e,l.f),"string"==typeof p||"number"==typeof p)_.updateDataSync(p,null!=g?g:[]);else{let t=[];for(let e in p){let i=p[e],r=f.series.find(t=>{var i;return(null==(i=null==t?void 0:t.data)?void 0:i.id)===e});t.push({id:e,values:i?null!=(o=null==g?void 0:g.filter(t=>t.hasOwnProperty(i)))?o:[]:null!=g?g:[],fields:null==(h=null==r?void 0:r.data)?void 0:h.fields}),_.updateFullDataSync||_.updateDataSync(e,i?null!=(d=null==g?void 0:g.filter(t=>t.hasOwnProperty(i)))?d:[]:null!=g?g:[])}null==(u=_.updateFullDataSync)||u.call(_,t)}}else v.internalProps.renderChartAsync?(-1===tj.A8.indexOf(`${t.parent.col}+${t.parent.row}`)&&(tj.A8.push(`${t.parent.col}+${t.parent.row}`),tj.LO.push(t)),(0,tj.a5)()||(0,tj.eO)(v)):(0,tj.pF)(t)}draw(t,e,i,r){this._draw(t,{},!1,i,r)}};tV=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([(0,tZ.b)()],tV);var tU=i(97708),tK=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s};let tX=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{shape:p}=t.attribute;if("circle"===p){let{width:n=o.width,height:l=o.height}=t.attribute;e.beginPath(),e.arc(i+n/2,r+l/2,Math.min(n,l)/2,0,2*Math.PI),e.closePath(),e.save(),e.clip()}}};tX=tK([(0,tZ.b)()],tX);let tY=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{shape:p}=t.attribute;"circle"===p&&e.restore()}};tY=tK([(0,tZ.b)()],tY);let t$=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{isGif:p}=t.attribute;p&&t.playing&&(t.attribute.opacity=0)}};t$=tK([(0,tZ.b)()],t$);let tq=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{isGif:p}=t.attribute;p&&t.playing&&(t.attribute.opacity=1,e.globalAlpha=t.attribute.opacity,t.renderFrame(e,i,r))}};tq=tK([(0,tZ.b)()],tq);var tJ=i(90383),tQ=i(85109);function t0(t,e,i,r){var n;let l,{highlightInRange:s,disableHeader:a,ranges:o}=t.select,h=1===o.length&&((n=null==o?void 0:o[0]).start.col!==n.end.col||n.start.row!==n.end.row)&&s;if(h?1===(null==o?void 0:o.length)&&o[0].start&&o[0].end:1===(null==o?void 0:o.length)&&o[0].end.col===o[0].start.col&&o[0].end.row===o[0].start.row){if(t.table.isHeader(e,i)&&a)return;(l=h?function(t,e,i){let r,{highlightScope:n,cellPos:l,ranges:s}=t.select,a=s[0],o=Math.min(a.start.col,a.end.col),h=Math.max(a.start.col,a.end.col),d=Math.min(a.start.row,a.end.row),u=Math.max(a.start.row,a.end.row);return n===P.p.single&&l.col===e&&l.row===i?r="cellBgColor":n===P.p.column&&e>=o&&e<=h?r=(0,B._Z)(s[0],e,i)?"cellBgColor":"inlineColumnBgColor":n===P.p.row&&i>=d&&i<=u?r=(0,B._Z)(s[0],e,i)?"cellBgColor":"inlineRowBgColor":n===P.p.cross&&((0,B._Z)(s[0],e,i)?r="cellBgColor":e>=o&&e<=h?r="inlineColumnBgColor":i>=d&&i<=u&&(r="inlineRowBgColor")),r}(t,e,i):function(t,e,i){let r,{highlightScope:n,cellPos:l}=t.select;return n===P.p.single&&l.col===e&&l.row===i?r="cellBgColor":n===P.p.column&&l.col===e?r=l.col===e&&l.row===i?"cellBgColor":"inlineColumnBgColor":n===P.p.row&&l.row===i?r=l.col===e&&l.row===i?"cellBgColor":"inlineRowBgColor":n===P.p.cross&&(l.col===e&&l.row===i?r="cellBgColor":l.col===e?r="inlineColumnBgColor":l.row===i&&(r="inlineRowBgColor")),r}(t,e,i))&&t1(t.table,e,i)&&(l=void 0)}else if("replace"===t.table.theme.selectionStyle.selectionFillMode)for(let t=0;t<o.length;t++){let r=o[t],n=Math.min(r.start.col,r.end.col),s=Math.max(r.start.col,r.end.col),a=Math.min(r.start.row,r.end.row),h=Math.max(r.start.row,r.end.row);if(n<=e&&a<=i&&s>=e&&h>=i){l="cellBgColor";break}}return l}function t1(t,e,i){var r,n;let l=null==(r=t.options.select)?void 0:r.disableSelect;if("function"==typeof l?l(e,i,t):l)return!0;if(t.isHeader(e,i)){let r=null==(n=t.options.select)?void 0:n.disableHeaderSelect;if(r)return!0;let l=t.getHeaderDefine(e,i);if(r=null==l?void 0:l.disableHeaderSelect)return!0}else{let r=t.getBodyColumnDefine(e,i),n=null==r?void 0:r.disableSelect;if("function"==typeof n?n(e,i,t):n)return!0}return!1}var t2=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s};let t3=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{stroke:p=o.stroke,strokeArrayWidth:g=o.strokeArrayWidth,strokeArrayColor:f=o.strokeArrayColor}=t.attribute;p&&(Array.isArray(g)||Array.isArray(f))&&(c.doStroke=!1)}};t3=t2([(0,tZ.b)()],t3);let t5=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){var c,p;let{stroke:g=o.stroke,strokeArrayColor:f=o.strokeArrayColor,strokeArrayWidth:m=o.strokeArrayWidth,lineWidth:y=o.lineWidth,strokeColor:v=o.stroke,cornerRadius:b=o.cornerRadius}=t.attribute,_,C,{width:x=o.width,height:w=o.height}=t.attribute;if(g&&(Array.isArray(m)||0!==y)&&(Array.isArray(f)||Array.isArray(m))){if("number"==typeof y&&1&y||Array.isArray(m)&&m.some(t=>1&t)){let e=t.stage.table;if(!e)return;let n="bottom-right"===(null==(c=null==e?void 0:e.theme)?void 0:c.cellBorderClipDirection);if(n){if(i=Math.floor(i)-.5,r=Math.floor(r)-.5,"cell"===t.role){let e=t.col,n=t.row;0===e&&(i+=1),0===n&&(r+=1)}}else i=Math.floor(i)+.5,r=Math.floor(r)+.5;(null==(p=e.options.customConfig)?void 0:p._disableColumnAndRowSizeRound)&&(x=Math.round(x),w=Math.round(w));let{width:l,height:s}=el(t,Math.ceil(x),Math.ceil(w),n);_=l,C=s}else _=Math.ceil(x),C=Math.ceil(w);0===b||(0,tT.Z)(b)&&b.every(t=>0===t)?t6(t,e,i,r,o,g,m||y,f||v,_,C):(e.beginPath(),(0,tJ.U)(e,i,r,_,C,b,!0,[,,,,].fill(0).map((n,l)=>(n,s,a,h)=>{eh(l,n,s,a,h,t,e,i,r,o,g,m||y,f||v,_,C)})),e.stroke())}}};function t4(t){let e;if(!Array.isArray(t))return{isSplitDraw:!1,width:t};for(let i=0;i<t.length;i++){let r=t[i];if(r)if(e){if(r!==e)return{isSplitDraw:!0}}else e=r}return{isSplitDraw:!1,width:e}}function t6(t,e,i,r,n,l,s,a,o,h,d,u){var c,p,g,f;let m=t4(s),y=!Array.isArray(s),v=!Array.isArray(l),b=Array.isArray(u),_=Array.isArray(a)||m.isSplitDraw;e.setStrokeStyle(t,t.attribute,i,r,n);let{lineDash:C=n.lineDash}=t.attribute,x=!1;C.length&&C.some(t=>Array.isArray(t))&&(x=!0),e.beginPath(),e.moveTo(i,r);let w=(v||l[0])&&(y||s[0]),S=(v||l[1])&&(y||s[1]),A=(v||l[2])&&(y||s[2]),M=(v||l[3])&&(y||s[3]);if(w){let t=(y?m.width:s[0])/2,n=(y?m.width:s[0])/2;b&&Array.isArray(u[0])?(e.moveTo(i-t+(o+t+n)*u[0][0],r),e.lineTo(i-t+(o+t+n)*(u[0][1]-u[0][0]),r),e.moveTo(i+o+n,r)):(e.moveTo(i-t,r),e.lineTo(i+o+n,r)),(_||x)&&(a&&a[0]?e.strokeStyle=a[0]:a&&!a[0]&&(e.strokeStyle="transparent"),y||(e.lineWidth=s[0]),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,x&&e.setLineDash(null!=(c=C[0])?c:[]),e.stroke(),e.beginPath(),e.moveTo(i+o,r))}else e.moveTo(i+o,r);if(S){let t=(y?m.width:s[1])/2,n=(y?m.width:s[1])/2;b&&Array.isArray(u[1])?(e.moveTo(i+o,r-t+h*u[1][0]),e.lineTo(i+o,r-t+(h+t+n)*(u[1][1]-u[1][0])),e.moveTo(i+o,r+h+n)):(e.moveTo(i+o,r-t),e.lineTo(i+o,r+h+n)),(_||x)&&(a&&a[1]?e.strokeStyle=a[1]:a&&!a[1]&&(e.strokeStyle="transparent"),y||(e.lineWidth=s[1]),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,x&&e.setLineDash(null!=(p=C[1])?p:[]),e.stroke(),e.beginPath(),e.moveTo(i+o,r+h))}else e.moveTo(i+o,r+h);if(A){let t=(y?m.width:s[2])/2,n=(y?m.width:s[2])/2;b&&Array.isArray(u[2])?(e.moveTo(i-t+(o+t+n)*u[2][0],r+h),e.lineTo(i-t+(o+t+n)*(u[2][1]-u[2][0]),r+h),e.moveTo(i-t,r+h)):(e.moveTo(i-t,r+h),e.lineTo(i+o+n,r+h)),(_||x)&&(a&&a[2]?e.strokeStyle=a[2]:a&&!a[2]&&(e.strokeStyle="transparent"),y||(e.lineWidth=s[2]),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,x&&e.setLineDash(null!=(g=C[2])?g:[]),e.stroke(),e.beginPath(),e.moveTo(i,r+h))}else e.moveTo(i,r+h);if(M){let t=(y?m.width:s[3])/2,n=(y?m.width:s[3])/2;b&&Array.isArray(u[3])?(e.moveTo(i,r-t+(h+t+n)*u[3][0]),e.lineTo(i,r-t+(h+t+n)*(u[3][1]-u[3][0])),e.moveTo(i,r-t)):(e.moveTo(i,r-t),e.lineTo(i,r+h+n)),(_||x)&&(a&&a[3]?e.strokeStyle=a[3]:a&&!a[3]&&(e.strokeStyle="transparent"),y||(e.lineWidth=s[3]),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,x&&e.setLineDash(null!=(f=C[3])?f:[]),e.stroke(),e.beginPath(),e.moveTo(i,r))}else e.moveTo(i,r);_||x||(!y&&m.width&&(e.lineWidth=m.width),e.stroke()),e.lineDashOffset=0,e.setLineDash([])}t5=t2([(0,tZ.b)()],t5);let t7=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){var p;let{lineDash:g=o.lineDash,stroke:f=o.stroke,strokeArrayColor:m=o.strokeArrayColor,strokeArrayWidth:y=o.strokeArrayWidth}=t.attribute;f&&Array.isArray(g)&&g.length&&(null==(p=g[0])?void 0:p.length)&&!Array.isArray(m)&&!Array.isArray(y)&&(c.doStroke=!1)}};t7=t2([(0,tZ.b)()],t7);let t8=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){var c,p,g,f,m,y,v;let{lineDash:b=o.lineDash,stroke:_=o.stroke,strokeArrayColor:C=o.strokeArrayColor,strokeArrayWidth:x=o.strokeArrayWidth,lineWidth:w=o.lineWidth}=t.attribute;if(!_||!(Array.isArray(b)&&b.length&&(null==(c=b[0])?void 0:c.length))||Array.isArray(C)||Array.isArray(x))return;let S=t.stage.table;if(!S)return;let A=(0,tT.Z)(b[0])?1===(v=b).length?[v[0],v[0],v[0],v[0]]:2===v.length?[v[0],v[1],v[0],v[1]]:v:[b,b,b,b],M,T,{width:k=o.width,height:R=o.height}=t.attribute;if((null==(p=S.options.customConfig)?void 0:p._disableColumnAndRowSizeRound)?(k=Math.round(k),R=Math.round(R)):(k=Math.ceil(k),R=Math.ceil(R)),1&w){let e="bottom-right"===S.theme.cellBorderClipDirection;e?(i=Math.floor(i)-.5,r=Math.floor(r)-.5,"cell"===t.role&&(0===t.col&&(i+=1),0===t.row&&(r+=1))):(i=Math.floor(i)+.5,r=Math.floor(r)+.5);let{width:n,height:l}=el(t,Math.ceil(k+0),Math.ceil(R+0),e);M=n,T=l}else M=Math.ceil(k),T=Math.ceil(R);e.setStrokeStyle(t,t.attribute,i,r,o),e.beginPath(),e.moveTo(i,r),e.lineTo(i+M,r),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,e.setLineDash(null!=(g=A[0])?g:[]),e.stroke(),e.beginPath(),e.moveTo(i+M,r),e.lineTo(i+M,r+T),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,e.setLineDash(null!=(f=A[1])?f:[]),e.stroke(),e.beginPath(),e.moveTo(i,r+T),e.lineTo(i+M,r+T),e.lineDashOffset=e.currentMatrix.e/e.currentMatrix.a,e.setLineDash(null!=(m=A[2])?m:[]),e.stroke(),e.beginPath(),e.moveTo(i,r),e.lineTo(i,r+T),e.lineDashOffset=e.currentMatrix.f/e.currentMatrix.d,e.setLineDash(null!=(y=A[3])?y:[]),e.stroke(),e.lineDashOffset=0,e.setLineDash([])}};t8=t2([(0,tZ.b)()],t8);let t9=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{lineWidth:p=o.lineWidth,stroke:g=o.stroke,lineDash:f=o.lineDash,strokeArrayWidth:m=o.strokeArrayWidth,strokeArrayColor:y=o.strokeArrayColor,notAdjustPos:v}=t.attribute;!0!==v&&g&&Array.isArray(f)&&!f.length&&!Array.isArray(y)&&!Array.isArray(m)&&1&p&&(c.doStroke=!1)}};t9=t2([(0,tZ.b)()],t9);let et=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){var c,p;let{lineWidth:g=o.lineWidth,stroke:f=o.stroke,lineDash:m=o.lineDash,strokeArrayWidth:y=o.strokeArrayWidth,strokeArrayColor:v=o.strokeArrayColor,notAdjustPos:b,cornerRadius:_=o.cornerRadius}=t.attribute,{width:C=o.width,height:x=o.height}=t.attribute;if(!0!==b&&f&&Array.isArray(m)&&!m.length&&!Array.isArray(v)&&!Array.isArray(y)&&1&g){let n=t.stage.table;if(!n)return;(null==(c=n.options.customConfig)?void 0:c._disableColumnAndRowSizeRound)&&(C=Math.round(C),x=Math.round(x)),e.beginPath();let l="bottom-right"===(null==(p=null==n?void 0:n.theme)?void 0:p.cellBorderClipDirection);l?(i=Math.floor(i)-.5,r=Math.floor(r)-.5,"cell"===t.role&&(0===t.col&&(i+=1),0===t.row&&(r+=1))):(i=Math.floor(i)+.5,r=Math.floor(r)+.5);let{width:s,height:a}=el(t,Math.ceil(C),Math.ceil(x),l);_?(0,tJ.U)(e,i,r,s+0,a+0,_):e.rect(i,r,s,a),e.setStrokeStyle(t,t.attribute,i,r,o),e.stroke()}}};et=t2([(0,tZ.b)()],et);let ee=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){if("cell"===t.role){let e=t.stage.table;if(e){let i=function(t,e){var i,r,n,l,s,a,o,h,d,u,c;let p,g;if("cell"===t.role&&(0,y.Z)(t.mergeStartCol)&&(0,y.Z)(t.mergeStartRow)&&(0,y.Z)(t.mergeEndCol)&&(0,y.Z)(t.mergeEndRow)){let{colStart:i,colEnd:r,rowStart:n,rowEnd:l}=(0,ti.e)(t,e.scenegraph);for(let s=i;s<=r;s++)for(let i=n;i<=l;i++){let r=t0(e.stateManager,s,i,t);!r||p&&"cellBgColor"!==r||(p=r)}}else"cell"===t.role&&(p=t0(e.stateManager,t.col,t.row,t));if(!p)return;let f=e.internalProps.layoutMap;return f.isCornerHeader(t.col,t.row)?g=(null==(i=e.theme.cornerHeaderStyle)?void 0:i.select)||(null==(r=e.theme.headerStyle)?void 0:r.select):f.isColumnHeader(t.col,t.row)?g=null==(n=e.theme.headerStyle)?void 0:n.select:f.isRowHeader(t.col,t.row)?g=null==(l=e.theme.rowHeaderStyle)?void 0:l.select:f.isBottomFrozenRow(t.col,t.row)?g=(null==(s=e.theme.bottomFrozenStyle)?void 0:s.select)||(e.isListTable()?null==(a=e.theme.bodyStyle)?void 0:a.select:null==(o=e.theme.headerStyle)?void 0:o.select):f.isRightFrozenColumn(t.col,t.row)?g=(null==(h=e.theme.rightFrozenStyle)?void 0:h.select)||(e.isListTable()?null==(d=e.theme.bodyStyle)?void 0:d.select:null==(u=e.theme.rowHeaderStyle)?void 0:u.select):e.isHeader(t.col,t.row)||(g=null==(c=e.theme.bodyStyle)?void 0:c.select),(0,Y.WJ)(p,g,t.col,t.row,e)}(t,e);if(i)t.attribute._vtableHightLightFill=i;else if(e.stateManager.interactionState!==P.F.scrolling){let i=(0,tQ.J)(t,e);i&&(t.attribute._vtableHightLightFill=i)}}}}};ee=t2([(0,tZ.b)()],ee);let ei=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){if(t.attribute._vtableHightLightFill){if(d);else if(s){let n=t.attribute.fill;t.attribute.fill=t.attribute._vtableHightLightFill,e.setCommonStyle(t,t.attribute,i,r,o),e.fill(),t.attribute.fill=n,t.attribute._vtableHightLightFill=void 0}}}};ei=t2([(0,tZ.b)()],ei);let er=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){var p,g,f,m,y,v;let b=t.stage.table;b&&("body"===t.role?en(e,-(null!=(p=t.attribute.x)?p:0)+b.getFrozenColsWidth(),-(null!=(g=t.attribute.y)?g:0)+b.getFrozenRowsHeight(),t.parent.attribute.width-b.getFrozenColsWidth()-b.getRightFrozenColsWidth(),t.parent.attribute.height-b.getFrozenRowsHeight()-b.getBottomFrozenRowsHeight()):"row-header"===t.role?en(e,0,-(null!=(f=t.attribute.y)?f:0)+b.getFrozenRowsHeight(),b.getFrozenColsWidth(),t.parent.attribute.height-b.getFrozenRowsHeight()-b.getBottomFrozenRowsHeight()):"col-header"===t.role?en(e,-(null!=(m=t.attribute.x)?m:0)+b.getFrozenColsWidth(),0,t.parent.attribute.width-b.getFrozenColsWidth()-b.getRightFrozenColsWidth(),b.getFrozenRowsHeight()):"right-frozen"===t.role?en(e,0,-(null!=(y=t.attribute.y)?y:0)+b.getFrozenRowsHeight(),b.getRightFrozenColsWidth(),t.parent.attribute.height-b.getFrozenRowsHeight()-b.getBottomFrozenRowsHeight()):"bottom-frozen"===t.role?en(e,-(null!=(v=t.attribute.x)?v:0)+b.getFrozenColsWidth(),0,t.parent.attribute.width-b.getFrozenColsWidth()-b.getRightFrozenColsWidth(),b.getBottomFrozenRowsHeight()):"corner-header"===t.role?en(e,0,0,b.getFrozenColsWidth(),b.getFrozenRowsHeight()):"corner-right-top-header"===t.role?en(e,0,0,b.getRightFrozenColsWidth(),b.getFrozenRowsHeight()):"corner-right-bottom-header"===t.role?en(e,0,0,b.getRightFrozenColsWidth(),b.getBottomFrozenRowsHeight()):"corner-left-bottom-header"===t.role&&en(e,0,0,b.getFrozenColsWidth(),b.getBottomFrozenRowsHeight()))}};function en(t,e,i,r,n){t.beginPath();let l=t.applyedMatrix;Math.abs(l.f)>0x1000000||Math.abs(l.g)>0x1000000?t.rect(e-0x1000000,i-0x1000000,r+0x2000000,n+0x2000000):t.rect(e,i,r,n)}function el(t,e,i,r){var n,l;let s=t.stage.table;if(!s)return{width:e,height:i};if("cell"===t.role){let a=t.col,o=t.row,h=(0,j.Z)(s,a,o);h&&(a=h.end.col,o=h.end.row),r?(0===a&&(e-=1),0===o&&(i-=1)):((a===s.colCount-1||a===s.frozenColCount-1&&s.scrollLeft||(null==(n=s.containerFit)?void 0:n.width)&&s.rightFrozenColCount&&a===s.colCount-s.rightFrozenColCount-1)&&(e-=1),(o===s.rowCount-1||o===s.frozenRowCount-1&&s.scrollTop||(null==(l=s.containerFit)?void 0:l.height)&&s.bottomFrozenRowCount&&o===s.rowCount-s.bottomFrozenRowCount-1)&&(i-=1))}else"corner-frozen"===t.role&&(s.scrollLeft&&!r&&(e-=1),s.scrollTop&&!r&&(i-=1));return{width:e,height:i}}er=t2([(0,tZ.b)()],er);var es=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s};let ea=class{constructor(){this.time=tU.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){let{stroke:p=o.stroke,strokeArrayWidth:g=o.strokeArrayWidth,strokeArrayColor:f=o.strokeArrayColor}=t.attribute;p&&(Array.isArray(p)||Array.isArray(g)||Array.isArray(f))&&(c.doStroke=!1)}};ea=es([(0,tZ.b)()],ea);let eo=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u){let{width:c=o.width,height:p=o.height,stroke:g=o.stroke,strokeArrayColor:f=o.strokeArrayColor,strokeArrayWidth:m=o.strokeArrayWidth,lineWidth:y=o.lineWidth,strokeColor:v=o.stroke,cornerRadius:b=o.cornerRadius}=t.attribute;!(!g||!Array.isArray(m)&&0===y||c<=0||p<=0)&&(Array.isArray(g)||Array.isArray(f)||Array.isArray(m))&&("border-rect"!==t.name&&"table-border-rect"!==t.name&&("number"==typeof y&&1&y||Array.isArray(m)&&m.some(t=>1&t))&&(i=Math.floor(i)+.5,r=Math.floor(r)+.5),0===b||(0,tT.Z)(b)&&b.every(t=>0===t)?t6(t,e,i,r,o,g,m||y,f||v,"table-border-rect"!==t.name?Math.ceil(c+0):c+0,"table-border-rect"!==t.name?Math.ceil(p+0):p+0):(e.beginPath(),(0,tJ.U)(e,i,r,c,p,b,!0,[,,,,].fill(0).map((n,l)=>(n,s,a,h)=>{eh(l,n,s,a,h,t,e,i,r,o,g,m||y,f||v,Math.ceil(c+0),Math.ceil(p+0))})),e.stroke()))}};function eh(t,e,i,r,n,l,s,a,o,h,d,u,c,p,g){var f,m,y,v;let b=t4(u),_=!Array.isArray(u),C=!Array.isArray(d),x=Array.isArray(c)||b.isSplitDraw;s.stroke(),s.setStrokeStyle(l,l.attribute,a,o,h);let{lineDash:w=h.lineDash}=l.attribute,S=!1;w.length&&w.some(t=>Array.isArray(t))&&(S=!0),s.beginPath(),s.moveTo(a,o);let A=(C||d[0])&&(_||u[0]),M=(C||d[1])&&(_||u[1]),T=(C||d[2])&&(_||u[2]),k=(C||d[3])&&(_||u[3]);A&&0===t?(_?b.width:u[0],_?b.width:u[0],s.moveTo(e,i),s.lineTo(r,n),(x||S)&&(c&&c[0]?s.strokeStyle=c[0]:c&&!c[0]&&(s.strokeStyle="transparent"),_||(s.lineWidth=u[0]),s.lineDashOffset=s.currentMatrix.e/s.currentMatrix.a,S&&s.setLineDash(null!=(f=w[0])?f:[]),s.stroke(),s.beginPath())):0===t&&s.moveTo(a+p,o),M&&1===t?(_?b.width:u[1],_?b.width:u[1],s.moveTo(e,i),s.lineTo(r,n),(x||S)&&(c&&c[1]?s.strokeStyle=c[1]:c&&!c[1]&&(s.strokeStyle="transparent"),_||(s.lineWidth=u[1]),s.lineDashOffset=s.currentMatrix.f/s.currentMatrix.d,S&&s.setLineDash(null!=(m=w[1])?m:[]),s.stroke(),s.beginPath(),s.moveTo(a+p,o+g))):1===t&&s.moveTo(a+p,o+g),T&&2===t?(_?b.width:u[2],_?b.width:u[2],s.moveTo(e,i),s.lineTo(r,n),(x||S)&&(c&&c[2]?s.strokeStyle=c[2]:c&&!c[2]&&(s.strokeStyle="transparent"),_||(s.lineWidth=u[2]),s.lineDashOffset=s.currentMatrix.e/s.currentMatrix.a,S&&s.setLineDash(null!=(y=w[2])?y:[]),s.stroke(),s.beginPath(),s.moveTo(a,o+g))):2===t&&s.moveTo(a,o+g),k&&3===t?(_?b.width:u[3],_?b.width:u[3],s.moveTo(e,i),s.lineTo(r,n),(x||S)&&(c&&c[3]?s.strokeStyle=c[3]:c&&!c[3]&&(s.strokeStyle="transparent"),_||(s.lineWidth=u[3]),s.lineDashOffset=s.currentMatrix.f/s.currentMatrix.d,S&&s.setLineDash(null!=(v=w[3])?v:[]),s.stroke(),s.beginPath(),s.moveTo(a,o))):3===t&&s.moveTo(a,o),s.closePath(),x||S||(!_&&b.width&&(s.lineWidth=b.width),s.stroke()),s.lineDashOffset=0,s.setLineDash([]),s.beginPath()}eo=es([(0,tZ.b)()],eo);var ed=i(50074),eu=i(56871);let ec,ep=class{constructor(){this.order=1,this.interceptors=[new eg]}afterDrawItem(t,e,i,r,n){for(let l=0;l<this.interceptors.length;l++)if(this.interceptors[l].afterDrawItem&&this.interceptors[l].afterDrawItem(t,e,i,r,n))return!0;return!1}beforeDrawItem(t,e,i,r,n){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let l=0;l<this.interceptors.length;l++)if(this.interceptors[l].beforeDrawItem&&this.interceptors[l].beforeDrawItem(t,e,i,r,n))return!0;return!1}};ep=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([(0,tZ.b)()],ep);class eg{constructor(){this.order=1}afterDrawItem(t,e,i,r,n){return"image"===t.type&&this.drawItem(t,e,i,r,n),!1}drawItem(t,e,i,r,n){let{image:l,gif:s}=t.attribute;if(s&&t.playing||!l||!t.resources)return!1;let a=t.resources.get(l);if(!a||"loading"!==a.state)return!1;if(!ec){let t=tb.U2(),e=t.loading_pic.svg,i=t.loading_pic.width,r=t.loading_pic.height;ec=(0,ed.B)({width:i,height:r,image:e})}let{image:o}=ec.attribute;if(!l||!ec.resources)return!1;let h=ec.resources.get(o);if("success"!==h.state)return!1;let{context:d}=i;d.highPerformanceSave(),t.parent&&d.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&d.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);let u=t.AABBBounds,{width:c,height:p}=(0,eu.f)(h.data.width,h.data.height,u.width(),u.height());return d.drawImage(h.data,u.x1+(u.width()-c)/2,u.y1+(u.height()-p)/2,c,p),d.highPerformanceRestore(),!0}}var ef=i(19626),em=i(52807),ey=i(83624),ev=i(61389);let eb=class{constructor(){this.time=tU.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,l,s,a,o,h,d,u,c){var p,g;let{text:f,underline:m=o.underline,lineThrough:y=o.lineThrough,direction:v=o.direction,whiteSpace:b=o.whiteSpace,fontSize:_=o.fontSize,verticalMode:C=o.verticalMode,ellipsis:x=o.ellipsis,textAlign:w=o.textAlign,textBaseline:S=o.textBaseline,x:A=o.x,y:M=o.y}=t.attribute,T=!1;if(Array.isArray(t)){let e=null==(p=t.cache)?void 0:p.layoutData;x&&e&&e.lines.every(t=>""===t.str)&&(T=!0)}else{let{cache:e}=t;x&&e&&""===e.clipedText&&0===e.clipedWidth&&(T=!0)}if(!T)return;let k=(0,ey.Z)(x)?x:"...",R=null!=(g=(0,ef.VA)(t.attribute.lineHeight,_))?g:_,P=0;R!==_&&("top"===S?P=(R-_)/2:"middle"===S||"bottom"===S&&(P=-(R-_)/2)),l&&(u?u(e,t.attribute,o):a&&(e.setStrokeStyle(t,t.attribute,A-i,M-r,o),e.strokeText(k,A,M+P))),n&&(d?d(e,t.attribute,o):s&&(e.setCommonStyle(t,t.attribute,A-i,M-r,o),e.fillText(k,A,M+P),this.drawUnderLine(m,y,t,A,M+P,0,o,e,k)))}drawUnderLine(t,e,i,r,n,l,s,a,o){if(e+t<=0)return;let{textAlign:h=s.textAlign,textBaseline:d=s.textBaseline,fontSize:u=s.fontSize,fontFamily:c=s.fontFamily,fontWeight:p=s.fontWeight,fontStyle:g=s.fontStyle,fill:f=s.fill,opacity:m=s.opacity,underlineOffset:y=s.underlineOffset,underlineDash:v=s.underlineDash,fillOpacity:b=s.fillOpacity}=i.attribute;if(!t&&!e)return;let _=ev.QC.measureTextWidth(o,{fontSize:u,fontFamily:c,fontWeight:p,fontStyle:g}),C=(0,em.js)(h,_),x=(0,em.nV)(d,u,u),w={lineWidth:0,stroke:f,opacity:m,strokeOpacity:b};if(t){w.lineWidth=t,a.setStrokeStyle(i,w,r,n,s),a.setLineDash(v),a.beginPath();let e=n+x+u+y;a.moveTo(r+C,e,l),a.lineTo(r+C+_,e,l),a.stroke()}if(e){w.lineWidth=e,a.setStrokeStyle(i,w,r,n,s),a.beginPath();let t=n+x+u/2;a.moveTo(r+C,t,l),a.lineTo(r+C+_,t,l),a.stroke()}}};eb=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([(0,tZ.b)()],eb);let e_=class{constructor(){this.type="chart",this.numberType=tN.e}contains(t,e,i){var r;if(t.attribute.detectPickChartItem){let i=t.activeChartInstance;if(!i)return!1;let n=i.getStage();null==(r=n.dirtyBounds)||r.clear();let l=n.pick(e.x,e.y);return(null!==l.graphic||"root"!==l.group.name)&&l}return!!t.AABBBounds.containsPoint(e)}};e_=function(t,e,i,r){var n,l=arguments.length,s=l<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(l<3?n(s):l>3?n(e,i,s):n(e,i))||s);return l>3&&s&&Object.defineProperty(e,i,s),s}([(0,tZ.b)()],e_);let eC=new tE.n((t,e,i,r)=>{i(tL.d4)?r(tL.d4).to(ea).inSingletonScope():(t(ea).toSelf().inSingletonScope(),t(tF.d5).toService(ea)),i(tL.Er)?r(tL.Er).to(eo).inSingletonScope():(t(eo).toSelf().inSingletonScope(),t(tF.d5).toService(eo)),t(tV).toSelf().inSingletonScope(),t(tG).to(tV),t(tO.uz).to(tV),t(e_).toSelf().inSingletonScope(),t(tH.EL).toService(e_),t(tX).toSelf().inSingletonScope(),t(tF.JO).toService(tX),t(tY).toSelf().inSingletonScope(),t(tF.JO).toService(tY),t(t$).toSelf().inSingletonScope(),t(tF.JO).toService(t$),t(tq).toSelf().inSingletonScope(),t(tF.JO).toService(tq),t(ee).toSelf().inSingletonScope(),t(tF.jd).toService(ee),t(ei).toSelf().inSingletonScope(),t(tF.jd).toService(ei),t(t5).toSelf().inSingletonScope(),t(tF.jd).toService(t5),t(t3).toSelf().inSingletonScope(),t(tF.jd).toService(t3),t(t7).toSelf().inSingletonScope(),t(tF.jd).toService(t7),t(t8).toSelf().inSingletonScope(),t(tF.jd).toService(t8),t(t9).toSelf().inSingletonScope(),t(tF.jd).toService(t9),t(et).toSelf().inSingletonScope(),t(tF.jd).toService(et),t(er).toSelf().inSingletonScope(),t(tF.jd).toService(er),t(ep).toSelf().inSingletonScope(),t(tD.xL).toService(ep),t(eb).toSelf().inSingletonScope(),t(tF.$K).toService(eb)});var ex=i(39909);let ew=new tf.Z({});ew.role="empty";var eS=i(37280);function eA(t,e,i,r,n,l,s,a,o){var h,d;let u,c,p,g=0;t.lastChild&&t.lastChild.row===r-1?g=t.lastChild.attribute.y+t.lastChild.attribute.height:t.colHeight?g=t.colHeight:r>=a.columnHeaderLevelCount&&r<a.rowCount-a.bottomFrozenRowCount&&(g=a.getRowsHeight(a.columnHeaderLevelCount,r-1));for(let f=r;f<=n;f++){let n=f,m,y,v,b,_=a.getCellLocation(e,n),C=a.getCellValue(e,n),x=i,w=a.getRowHeight(n),S=!1;if(a.internalProps.customMergeCell){let t=a.getCustomMerge(e,n);if(t){let{range:e,text:i,style:s,customLayout:o,customRender:h}=t;if(y=(m=e).start.col!==m.end.col||m.start.row!==m.end.row){let t=eT(m,l,a,r>m.start.row);x=t.cellWidth,w=t.cellHeight}C=i,v=s,(o||h)&&(b=(0,U.ws)(o,h,e.start.col,e.start.row,a.getColsWidth(e.start.col,e.end.col),a.getRowsHeight(e.start.row,e.end.row),!1,a.isAutoRowHeight(n),[0,0,0,0],m,a)),S=!0}}let A,M=e,T=n;m&&(M=m.start.col,T=m.start.row),!a.isPivotTable()&&("columnHeader"===_||"cornerHeader"===_)&&n>=a.columnHeaderLevelCount&&(_="body"),A=!a.isPivotTable()&&a.isSeriesNumberInBody(e,n)?a.getBodyColumnDefine(M,T):"body"!==_?a.getHeaderDefine(M,T):a.getBodyColumnDefine(M,T);let k="isAggregation"in a.internalProps.layoutMap&&a.internalProps.layoutMap.isAggregation(e,n),R=a.internalProps.layoutMap.isSeriesNumber(e,n),P="body"!==_||((null==A?void 0:A.dragOrder)||!!(null==A?void 0:A.icon)||!!(null==A?void 0:A.tree))&&!(k&&R);if(!m&&(a.internalProps.enableTreeNodeMerge||"body"!==_||(null==A?void 0:A.mergeCell))&&(y=(m=a.getCellRange(e,n)).start.col!==m.end.col||m.start.row!==m.end.row)){let t=eT(m,l,a,r>m.start.row);x=t.cellWidth,w=t.cellHeight}let I=!1;if(a.internalProps.enableTreeNodeMerge&&y){let t=a.getCellRawRecord(m.start.col,m.start.row),{vtableMergeName:i,vtableMerge:r}=null!=t?t:{};I=r,r&&(P=!0,a.internalProps.groupTitleCustomLayout&&(b=(0,U.ws)(a.internalProps.groupTitleCustomLayout,void 0,m.start.col,m.start.row,a.getColsWidth(m.start.col,m.end.col),a.getRowsHeight(m.start.row,m.end.row),!1,a.isAutoRowHeight(n),[0,0,0,0],m,a)),a.internalProps.groupTitleFieldFormat?C=a.internalProps.groupTitleFieldFormat(t,e,n,a):void 0!==i&&(C=i))}let E=I||S?"text":null!=(d=a.isHeader(e,n)?null!=(h=a._getHeaderLayoutMap(e,n).headerType)?h:"text":a.getBodyColumnType(e,n))?d:"text";if((0,B.tI)(C)){(function(t,e,i,r,n,l,s){let a=new tf.Z({x:0,y:r,width:n,height:l});a.role="cell",a.col=t,a.row=e,s.addChild(a)})(e,n,0,g,x,w,t),(0,eS.K)(C,a,eM.bind(null,{type:E,value:C,define:A,table:a,col:e,row:n,colWidth:i,cellWidth:x,cellHeight:w,columnGroup:t,y:g,customStyle:v,mayHaveIcon:P,cellLocation:_,range:m,customResult:b,defaultRowHeight:s})),t.updateColumnRowNumber(n);let r=a.getRowHeight(n);t.updateColumnHeight(r),g+=r}else{let r=v||a._getCellStyle(m?m.start.col:e,m?m.start.row:n),l=(0,V.RT)(r,a,m?m.start.col:e,m?m.start.row:n,Y.WJ).theme;l.group.cornerRadius=(0,V.xv)(e,n,a),l.group.width=i,l.group.height=Array.isArray(s)?s[n]:s,l._vtable.padding&&(u=l._vtable.padding),l.text.textAlign&&(c=l.text.textAlign),l.text.textBaseline&&(p=l.text.textBaseline),"body"===_||l.group.fill||(l.group.fill="#fff");let o=(0,X.kE)(E,C,A,a,e,n,i,x,w,t,g,u,c,p,P,l,m,b);if(t.updateColumnRowNumber(n),y){let i=a.getRowHeight(n),{width:r}=(a.getColWidth(e),o.attribute),{height:l}=o.attribute;o.contentWidth=r,o.contentHeight=l,(0,X.pZ)(m,r,l,u,c,p,a),t.updateColumnHeight(i),g+=i}else t.updateColumnHeight(w),g+=w}if(o&&n>o)break}return t.setAttribute("width",i),{width:i,height:g}}function eM(t){let e,i,r,{type:n,value:l,define:s,table:a,col:o,row:h,colWidth:d,cellWidth:u,cellHeight:c,columnGroup:p,y:g,cellLocation:f,mayHaveIcon:m,customStyle:y,range:v,customResult:b,defaultRowHeight:_}=t,C=y||a._getCellStyle(v?v.start.col:o,v?v.start.row:h),x=(0,V.RT)(C,a,v?v.start.col:o,v?v.start.row:h,Y.WJ).theme;x.group.cornerRadius=(0,V.xv)(o,h,a),x.group.width=d,x.group.height=Array.isArray(_)?_[h]:_,x._vtable.padding&&(e=x._vtable.padding),x.text.textAlign&&(i=x.text.textAlign),x.text.textBaseline&&(r=x.text.textBaseline),"body"===f||x.group.fill||(x.group.fill="#fff"),(0,X.kE)(n,l,s,a,o,h,d,u,c,p,g,e,i,r,m,x,v,b)}function eT(t,e,i,r){let n=0,l=0,s=e.get(`${t.start.col},${t.start.row};${t.end.col},${t.end.row}`);if(!s||r){for(let e=t.start.col;e<=t.end.col;e++)n+=i.getColWidth(e);for(let e=t.start.row;e<=t.end.row;e++)l+=i.getRowHeight(e);e.set(`${t.start.col},${t.start.row};${t.end.col},${t.end.row}`,{cellWidth:n,cellHeight:l})}else n=s.cellWidth,l=s.cellHeight;return{cellWidth:n,cellHeight:l}}function ek(t,e,i,r,n,l,s,a,o,h){if(r>n||l>s)return;let{layoutMap:d,defaultHeaderRowHeight:u,defaultColWidth:c}=o.internalProps,p=o.defaultRowHeight,g=0,f=0;for(let d=r;d<=n;d++){let r=d,n=o.getColWidth(r),c=new tf.Z({x:e+g,y:i,width:n,height:0,clip:!1,pickable:!1});c.role="column",c.col=d,t.addChild(c);let{width:m,height:y}=eA(c,r,n,l,s,o.scenegraph.mergeMap,"columnHeader"===a&&(0,$.Z)(u)?u:p,o,h);g+=m,f=Math.max(f,y)}t.setAttribute("width",g),t.setAttribute("height",f)}function eR(t){let e=t.firstChild;for(;e&&"group"!==e.type;)e=e._next;return e}function eP(t){let e=t.lastChild;for(;e&&"group"!==e.type;)e=e._prev;return e}function eB(t,e,i,r="left"){for(let n=t;n<=e;n++){let t=i.scenegraph.getColGroup(n);t&&eI(t,i,r);let e=i.scenegraph.getColGroup(n,!0);e&&eI(e,i,r);let l=i.scenegraph.getColGroupInBottom(n);l&&eI(l,i,r)}let n=Math.min(i.scenegraph.proxy.colLimit,i.scenegraph.proxy.bodyRightCol-i.scenegraph.proxy.bodyLeftCol+1),l=i.getColsWidth(i.frozenColCount,i.frozenColCount+n),s=i.getColsWidth(i.frozenColCount,i.colCount-1);i.scenegraph.proxy.xLimitLeft=l/2,i.scenegraph.proxy.xLimitRight=s-l/2}function eI(t,e,i="left"){if("left"===i){let i,r=function(t){let e=t._prev;for(;e&&"group"!==e.type;)e=e._prev;return e}(t);i=r?r.attribute.x+e.getColWidth(t._prev.col):e.getColsWidth(e.frozenColCount,t.col-1),t.setAttribute("x",i)}else{let i,r=function(t){let e=t._next;for(;e&&"group"!==e.type;)e=e._next;return e}(t);i=r?r.attribute.x-e.getColWidth(t.col):e.getColsWidth(e.frozenColCount,t.col-1),t.setAttribute("x",i)}}var eE=function(t,e,i,r){return new(i||(i=Promise))(function(n,l){function s(t){try{o(r.next(t))}catch(t){l(t)}}function a(t){try{o(r.throw(t))}catch(t){l(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(s,a)}o((r=r.apply(t,e||[])).next())})};function eL(t,e,i,r,n,l){return eE(this,void 0,void 0,function*(){if("left"===e&&l.colEnd+t>l.bodyRightCol?t=l.bodyRightCol-l.colEnd:"right"===e&&l.colStart-t<l.bodyLeftCol&&(t=l.colStart-l.bodyLeftCol),0!==t)if(t<0&&(e="left"===e?"right":"left",t=-t),t<l.colEnd-l.colStart){let n="left"===e?l.colStart:l.colEnd-t+1,s="left"===e?l.colStart+t-1:l.colEnd,a="left"===e?l.colEnd+1:l.colStart-t,o="left"===e?l.colEnd+t:l.colStart-1;(0,ex.rj)(l.table,a,o),function(t,e,i,r){for(let n=t;n<=e;n++)r.table.scenegraph.bodyGroup.childrenCount>0&&"group"===r.table.scenegraph.bodyGroup.firstChild.type&&eH(r.table.scenegraph.bodyGroup,i,r),r.table.scenegraph.colHeaderGroup.childrenCount>0&&"group"===r.table.scenegraph.colHeaderGroup.firstChild.type&&eH(r.table.scenegraph.colHeaderGroup,i,r),r.table.scenegraph.bottomFrozenGroup.childrenCount>0&&"group"===r.table.scenegraph.bottomFrozenGroup.firstChild.type&&eH(r.table.scenegraph.bottomFrozenGroup,i,r)}(n,s,e,l),l.colStart="left"===e?l.colStart+t:l.colStart-t,l.colEnd="left"===e?l.colEnd+t:l.colEnd-t,eD(a,o,l),eB(a,o,l.table,e);let h=r-((l.table.scenegraph.getColGroup(i)||l.table.scenegraph.getColGroup(i,!0)).attribute.x+l.table.getFrozenColsWidth()+l.table.scenegraph.proxy.deltaX);l.table.scenegraph.proxy.deltaX+=h,l.currentCol="left"===e?l.currentCol+t:l.currentCol-t,l.totalCol=Math.max(0,Math.min(l.table.colCount-1,"left"===e?l.totalCol+t:l.totalCol-t)),l.referenceCol=l.colStart+Math.floor((l.colEnd-l.colStart)/2),l.colUpdatePos=a,l.colUpdateDirection=e,l.table.scenegraph.updateNextFrame()}else{var n,s,a,o;let i="left"===e?l.colStart+t:l.colStart-t,r="left"===e?l.colEnd+t:l.colEnd-t;(0,ex.rj)(l.table,i,r),n=l.table.getColsWidth(l.bodyLeftCol,i-1),s=t,a=e,(o=l).table.scenegraph.colHeaderGroup.forEachChildren((t,e)=>{"group"===t.type&&eF(t,"left"===a?t.col+s:t.col-s,0===e?n:t._prev.attribute.x+o.table.getColWidth(t._prev.col))}),o.table.scenegraph.bottomFrozenGroup.forEachChildren((t,e)=>{"group"===t.type&&eF(t,"left"===a?t.col+s:t.col-s,0===e?n:t._prev.attribute.x+o.table.getColWidth(t._prev.col))}),o.table.scenegraph.bodyGroup.forEachChildren((t,e)=>{"group"===t.type&&eF(t,"left"===a?t.col+s:t.col-s,0===e?n:t._prev.attribute.x+o.table.getColWidth(t._prev.col))}),l.colStart=i,l.colEnd=r,eD(i,r,l),eB(i,r,l.table,r>l.bodyRightCol-(l.colEnd-l.colStart+1)?"right":"left"),l.currentCol="left"===e?l.currentCol+t:l.currentCol-t,l.totalCol=Math.max(0,Math.min(l.table.colCount-1,"left"===e?l.totalCol+t:l.totalCol-t)),l.referenceCol=l.colStart+Math.floor((l.colEnd-l.colStart)/2),l.colUpdatePos=l.colStart,l.colUpdateDirection=r>l.bodyRightCol-(l.colEnd-l.colStart+1)?"right":"left",l.table.scenegraph.updateNextFrame()}})}function eF(t,e,i){t.col=e,t.forEachChildren(t=>{t.col=e,t.needUpdate=!0}),t.setAttribute("x",i),t.needUpdate=!0}function eO(t,e){if(!t)return;let i=t.firstChild;for(;i;)i=e.updateCellGroupContent(i)._next;t.needUpdate=!1,t.setAttribute("width",e.table.getColWidth(t.col))}function eH(t,e,i){if("left"===e){let e=eR(t),r=eP(t);eF(e,r.col+1,r.attribute.x+i.table.getColWidth(r.col)),t.appendChild(e),t.border&&t.appendChild(t.border)}else{let e=eP(t),r=eR(t);eF(e,r.col-1,r.attribute.x-i.table.getColWidth(r.col-1)),t.insertBefore(e,t.firstChild)}}function eD(t,e,i){for(let r=t;r<=e;r++){let t=i.table.scenegraph.getColGroup(r,!0);t&&eO(t,i);let e=i.table.scenegraph.getColGroupInBottom(r);e&&eO(e,i);let n=i.table.scenegraph.getColGroupInRightTopCorner(r);n&&eO(n,i);let l=i.table.scenegraph.getColGroupInRightBottomCorner(r);l&&eO(l,i);let s=i.table.scenegraph.getColGroup(r);s&&function(t,e){if(!t)return;let i=e.screenTopRow,r=Math.max(e.bodyTopRow,i-e.screenRowCount),n=Math.min(e.bodyBottomRow,i+2*e.screenRowCount,e.table.rowCount-1);for(let i=r;i<=n;i++){let r=e.highPerformanceGetCell(t.col,i,!0);e.updateCellGroupContent(r)}e.rowUpdatePos=e.rowStart,t.needUpdate=!1,t.setAttribute("width",e.table.getColWidth(t.col))}(s,i)}ez(i.table.scenegraph.colHeaderGroup),ez(i.table.scenegraph.bottomFrozenGroup),ez(i.table.scenegraph.bodyGroup),i.progress()}function ez(t){var e,i;let r=eP(t);if(r&&(t.setAttribute("width",r.attribute.x+r.attribute.width),t.border)){let n=t.border;n.setAttribute("width",r.attribute.x+r.attribute.width-(null!=(e=n.attribute.borderLeft)?e:0)/2-(null!=(i=n.attribute.borderRight)?i:0)/2)}}function eW(t,e,i,r,n,l="up",s){var a,o;if("up"===l)for(let l=t;l<=e;l++)for(let t=i;t<=r;t++){let e,i=n.scenegraph.highPerformanceGetCell(l,t,!0);if("cell"===i.role&&i.row){if(i._prev)e=(null==(a=i._prev)?void 0:a.attribute.y)+n.getRowHeight(i._prev.row);else if(s){let i=r===n.rowCount-n.bottomFrozenRowCount-1?r:r+1;if(e=n.scenegraph.highPerformanceGetCell(l,i,!0).attribute.y,(0,y.Z)(e))for(let r=t;r<i;r++)e-=n.getRowHeight(r)}else e=eZ(i.row,n);(0,y.Z)(e)&&i.setAttribute("y",e)}}else for(let l=t;l<=e;l++)for(let t=r;t>=i;t--){let e,r=n.scenegraph.highPerformanceGetCell(l,t,!0);if("cell"===r.role&&r.row){if(r._next)e=(null==(o=r._next)?void 0:o.attribute.y)-n.getRowHeight(r.row);else if(s){let r=i<=n.frozenRowCount?n.frozenRowCount:i-1;e=i<=n.frozenRowCount?0:n.scenegraph.highPerformanceGetCell(l,r,!0).attribute.y;for(let i=r;i<t;i++)e+=n.getRowHeight(i)}else e=eZ(r.row,n);(0,y.Z)(e)&&r.setAttribute("y",e)}}let h=Math.min(n.scenegraph.proxy.rowLimit,n.scenegraph.proxy.bodyBottomRow-n.scenegraph.proxy.bodyTopRow+1),d=n.getRowsHeight(n.frozenRowCount,n.frozenRowCount+h),u=n.getRowsHeight(n.frozenRowCount,n.rowCount-1);n.scenegraph.proxy.yLimitTop=d/2,n.scenegraph.proxy.yLimitBottom=u-d/2}function eZ(t,e){return t<e.frozenRowCount?e.getRowsHeight(0,t-1):t>=e.rowCount-e.bottomFrozenRowCount?e.getRowsHeight(e.rowCount-e.bottomFrozenRowCount,t-1):e.getRowsHeight(e.frozenRowCount,t-1)}var eN=function(t,e,i,r){return new(i||(i=Promise))(function(n,l){function s(t){try{o(r.next(t))}catch(t){l(t)}}function a(t){try{o(r.throw(t))}catch(t){l(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(s,a)}o((r=r.apply(t,e||[])).next())})};function ej(t,e,i,r,n,l){return eN(this,void 0,void 0,function*(){if("up"===e&&l.rowEnd+t>l.bodyBottomRow?t=l.bodyBottomRow-l.rowEnd:"down"===e&&l.rowStart-t<l.bodyTopRow&&(t=l.rowStart-l.bodyTopRow),0!==t)if(t<0&&(e="up"===e?"down":"up",t=-t),t<l.rowEnd-l.rowStart){let r,n,s="up"===e?l.rowStart:l.rowEnd-t+1,a="up"===e?l.rowStart+t-1:l.rowEnd,o="up"===e?l.rowEnd+1:l.rowStart-t,h="up"===e?l.rowEnd+t:l.rowStart-1;l.table.isAutoRowHeight(s)?(r=o,n=h):(r=Math.max(l.bodyTopRow,i-l.screenRowCount),n=Math.min(l.bodyBottomRow,i+2*l.screenRowCount,l.table.rowCount-1)),(0,te.Y)(l.table,r,n,!1),function(t,e,i,r){for(let n=0;n<r.table.frozenColCount;n++){let l=r.table.scenegraph.getColGroup(n);if(l)for(let n=t;n<=e;n++)eG(l,i,r)}for(let n=r.table.colCount-r.table.rightFrozenColCount;n<r.table.colCount;n++){let l=r.table.scenegraph.getColGroup(n);if(l)for(let n=t;n<=e;n++)eG(l,i,r)}for(let n=r.bodyLeftCol;n<=r.bodyRightCol;n++){let l=r.table.scenegraph.getColGroup(n);if(l)for(let n=t;n<=e;n++)eG(l,i,r)}}(s,a,e,l),l.rowStart="up"===e?l.rowStart+t:l.rowStart-t,l.rowEnd="up"===e?l.rowEnd+t:l.rowEnd-t;let d=eV(r,n,l,!0);l.table.isAutoRowHeight(s)&&(eW(l.bodyLeftCol,l.bodyRightCol,r,n,l.table,h>l.bodyBottomRow-(l.rowEnd-l.rowStart+1)?"down":"up",!0),eW(0,l.table.frozenColCount-1,r,n,l.table,h>l.bodyBottomRow-(l.rowEnd-l.rowStart+1)?"down":"up",!0),eW(l.table.colCount-l.table.rightFrozenColCount,l.table.colCount-1,r,n,l.table,h>l.bodyBottomRow-(l.rowEnd-l.rowStart+1)?"down":"up",!0)),l.currentRow="up"===e?l.currentRow+t:l.currentRow-t,l.totalRow=Math.max(0,Math.min(l.bodyBottomRow,"up"===e?l.totalRow+t:l.totalRow-t,l.table.rowCount-1)),l.referenceRow=l.rowStart+Math.floor((l.rowEnd-l.rowStart)/2),l.table.isAutoRowHeight(s)&&d?l.rowUpdatePos=Math.min(l.rowUpdatePos,l.rowEnd+1):l.rowUpdatePos=Math.min(l.rowUpdatePos,o),l.rowUpdateDirection=e,l.table.scenegraph.updateNextFrame(),yield l.progress()}else{let r,n,s="up"===e?l.rowStart+t:l.rowStart-t,a=Math.min(l.table.rowCount-1,"up"===e?l.rowEnd+t:l.rowEnd-t),o=l.table.getRowsHeight(l.bodyTopRow,s-1);l.table.isAutoRowHeight(s)?(r=s,n=a):(r=Math.max(l.bodyTopRow,i-l.screenRowCount),n=Math.min(l.bodyBottomRow,i+2*l.screenRowCount,l.table.rowCount-1)),(0,te.Y)(l.table,r,n,!1),function(t,e,i,r){for(let n=0;n<r.table.frozenColCount;n++){let l=r.table.scenegraph.getColGroup(n);null==l||l.forEachChildren((n,l)=>{r.updateCellGroupPosition(n,"up"===i?n.row+e:n.row-e,0===l?t:n._prev.attribute.y+r.table.getRowHeight(n._prev.row))})}for(let n=r.table.colCount-r.table.rightFrozenColCount;n<r.table.colCount;n++){let l=r.table.scenegraph.getColGroup(n);null==l||l.forEachChildren((n,l)=>{r.updateCellGroupPosition(n,"up"===i?n.row+e:n.row-e,0===l?t:n._prev.attribute.y+r.table.getRowHeight(n._prev.row))})}for(let n=r.bodyLeftCol;n<=r.bodyRightCol;n++){let l=r.table.scenegraph.getColGroup(n);null==l||l.forEachChildren((n,l)=>{r.updateCellGroupPosition(n,"up"===i?n.row+e:n.row-e,0===l?t:n._prev.attribute.y+r.table.getRowHeight(n._prev.row))})}}(o,t,e,l),l.rowStart=s,l.rowEnd=a;let h=eV(r,n,l,!0);l.table.isAutoRowHeight(s)&&(eW(l.bodyLeftCol,l.bodyRightCol,r,n,l.table,a>l.bodyBottomRow-(l.rowEnd-l.rowStart+1)?"down":"up"),eW(0,l.table.frozenColCount-1,r,n,l.table,a>l.bodyBottomRow-(l.rowEnd-l.rowStart+1)?"down":"up"),eW(l.table.colCount-l.table.rightFrozenColCount,l.table.colCount-1,r,n,l.table,a>l.bodyBottomRow-(l.rowEnd-l.rowStart+1)?"down":"up")),l.currentRow="up"===e?l.currentRow+t:l.currentRow-t,l.totalRow=Math.max(0,Math.min(l.bodyBottomRow,"up"===e?l.totalRow+t:l.totalRow-t,l.table.rowCount-1)),l.referenceRow=l.rowStart+Math.floor((l.rowEnd-l.rowStart)/2),l.table.isAutoRowHeight(s)&&h?l.rowUpdatePos=l.rowEnd+1:l.rowUpdatePos=l.rowStart,l.rowUpdateDirection=a>l.bodyBottomRow-(l.rowEnd-l.rowStart+1)?"down":"up",l.table.scenegraph.updateNextFrame(),yield l.progress()}})}function eG(t,e,i){if(t.childrenCount>=1)if("up"===e){let e=t.firstChild;i.updateCellGroupPosition(e,t.lastChild.row+1,t.lastChild.attribute.y+i.table.getRowHeight(t.lastChild.row)),t.appendChild(e)}else{let e=t.lastChild;i.updateCellGroupPosition(e,t.firstChild.row-1,t.firstChild.attribute.y-i.table.getRowHeight(e.row)),t.insertBefore(e,t.firstChild)}}function eV(t,e,i,r=!1){for(let r=0;r<i.table.frozenColCount;r++)for(let n=t;n<=e;n++){let t=i.highPerformanceGetCell(r,n,!0);i.updateCellGroupContent(t)}for(let r=i.table.colCount-i.table.rightFrozenColCount;r<i.table.colCount;r++)for(let n=t;n<=e;n++){let t=i.highPerformanceGetCell(r,n);i.updateCellGroupContent(t)}let n=i.bodyLeftCol,l=i.bodyRightCol,s=!0;if(r){let t=i.screenLeftCol;n=Math.max(i.bodyLeftCol,t-i.screenColCount),l=Math.min(i.bodyRightCol,t+2*i.screenColCount),n===i.bodyLeftCol&&l===i.bodyRightCol||(s=!1)}for(let r=n;r<=l;r++)for(let n=t;n<=e;n++){let t=i.highPerformanceGetCell(r,n);i.updateCellGroupContent(t)}return eU(i.table.scenegraph.rowHeaderGroup),eU(i.table.scenegraph.rightFrozenGroup),eU(i.table.scenegraph.bodyGroup),i.table.scenegraph.updateNextFrame(),s}function eU(t){var e,i;let r=eP(t);if(!r)return;let n=eP(r);if(n&&(t.setAttribute("height",n.attribute.y+n.attribute.height),t.border)){let r=t.border;r.setAttribute("height",n.attribute.y+n.attribute.height-(null!=(e=r.attribute.borderTop)?e:0)/2-(null!=(i=r.attribute.borderBottom)?i:0)/2)}}function eK(t){let{changedCells:e}=t.internalProps.stick;return e.forEach(e=>{t.scenegraph.getCell(e.col,e.row).forEachChildren(t=>{t.setAttributes({dx:e.dx,dy:e.dy})})}),e.clear(),e}function eX(t){let e=eK(t),{scrollTop:i,scrollLeft:r,frozenRowCount:n,frozenColCount:l}=t,s=t.getFrozenRowsHeight(),a=t.getFrozenColsWidth(),{row:o}=t.getRowAt(i+s+1),{col:h}=t.getColAt(r+a+1),d=Math.max(o,t.frozenRowCount),u=Math.max(h,t.frozenColCount),c=t.getAllRowsHeight()>t.tableNoFrameHeight?t.getRowAt(i+t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()-1).row:t.rowCount-t.bottomFrozenRowCount-1,p=t.getAllColsWidth()>t.tableNoFrameWidth?t.getColAt(r+t.tableNoFrameWidth-t.getRightFrozenColsWidth()-1).col:t.colCount-t.rightFrozenColCount-1;if(!(p<0||c<0)){for(let i=0;i<n&&!(p<u);i++)[u,p].forEach(r=>{let n=t._getCellStyle(r,i);(null==n?void 0:n.textStick)&&"vertical"!==(null==n?void 0:n.textStick)&&eq(t.scenegraph.getCell(r,i),a+t.tableX,t.tableNoFrameWidth-t.getRightFrozenColsWidth()+t.tableX,e,null==n?void 0:n.textStickBaseOnAlign,t)});for(let i=0;i<l&&!(c<d);i++)[d,c].forEach(r=>{let n=t._getCellStyle(i,r);(null==n?void 0:n.textStick)&&"horizontal"!==(null==n?void 0:n.textStick)&&eY(t.scenegraph.getCell(i,r),s+t.tableY,t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()+t.tableY,e,null==n?void 0:n.textStickBaseOnAlign,t)});for(let i=u;i<=p&&!(c<d);i++)[d,c].forEach(r=>{let n=t._getCellStyle(i,r);(null==n?void 0:n.textStick)&&"horizontal"!==(null==n?void 0:n.textStick)&&eY(t.scenegraph.getCell(i,r),s+t.tableY,t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()+t.tableY,e,null==n?void 0:n.textStickBaseOnAlign,t)});for(let i=d;i<=c&&!(p<u);i++)[u,p].forEach(r=>{let n=t._getCellStyle(r,i);(null==n?void 0:n.textStick)&&"vertical"!==(null==n?void 0:n.textStick)&&eq(t.scenegraph.getCell(r,i),a+t.tableX,t.tableNoFrameWidth-t.getRightFrozenColsWidth()+t.tableX,e,null==n?void 0:n.textStickBaseOnAlign,t)})}}function eY(t,e,i,r,n,l){if((0,$.Z)(t.mergeStartCol)&&(0,$.Z)(t.mergeStartRow)&&(0,$.Z)(t.mergeEndCol)&&(0,$.Z)(t.mergeEndRow)){let{colStart:s,colEnd:a,rowStart:o,rowEnd:h}=(0,ti.e)(t,l.scenegraph);for(let t=s;t<=a;t++)for(let s=o;s<=h;s++){let a=l.scenegraph.getCell(t,s);"cell"===a.role&&e$(a,e,i,r,n)}}else e$(t,e,i,r,n)}function e$(t,e,i,r,n){var l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C;let x=t.getChildByName("text",!0)||t.getChildByName("image",!0);if(!x)return;if("image"===x.type){let{image:t}=x.attribute;if(!t||!x.resources||"success"!==x.resources.get(t).state)return}let w=null!=(l=x.textBaseline)?l:"top";x.AABBBounds.width();let S=x.globalAABBBounds.y1,A=x.globalAABBBounds.y2;if("middle"===w&&n){let n=t.globalAABBBounds.y1+(null!=(a=null==(s=t.firstChild)?void 0:s.attribute.dy)?a:0),l=n+(null!=(h=null!=(o=t.contentHeight)?o:t.attribute.height)?h:0);if(n<e||l>i){let s=Math.max(n,e),a=Math.min(l,i),o=x.globalTransMatrix.f-(a+s)/2+x.AABBBounds.height()/2;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(u=null==(d=t.firstChild)?void 0:d.attribute.dx)?u:0,dy:null!=(p=null==(c=t.firstChild)?void 0:c.attribute.dy)?p:0}),t.forEachChildren(t=>{var e;t.setAttribute("dy",(null!=(e=t.attribute.dy)?e:0)-o+2)})}}else if(S<e){let i=S-e;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(f=null==(g=t.firstChild)?void 0:g.attribute.dx)?f:0,dy:null!=(y=null==(m=t.firstChild)?void 0:m.attribute.dy)?y:0}),t.forEachChildren(t=>{var e;t.setAttribute("dy",(null!=(e=t.attribute.dy)?e:0)-i+2)})}else if(A>i){let e=A-i;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(b=null==(v=t.firstChild)?void 0:v.attribute.dx)?b:0,dy:null!=(C=null==(_=t.firstChild)?void 0:_.attribute.dy)?C:0}),t.forEachChildren(t=>{var i;t.setAttribute("dy",(null!=(i=t.attribute.dy)?i:0)-e)})}}function eq(t,e,i,r,n,l){if((0,$.Z)(t.mergeStartCol)&&(0,$.Z)(t.mergeStartRow)&&(0,$.Z)(t.mergeEndCol)&&(0,$.Z)(t.mergeEndRow)){let{colStart:s,colEnd:a,rowStart:o,rowEnd:h}=(0,ti.e)(t,l.scenegraph);for(let t=s;t<=a;t++)for(let s=o;s<=h;s++){let a=l.scenegraph.getCell(t,s);"cell"===a.role&&eJ(a,e,i,r,n)}}else eJ(t,e,i,r,n)}function eJ(t,e,i,r,n){var l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x;let w=t.getChildByName("text",!0)||t.getChildByName("image",!0);if(!w)return;if("image"===w.type){let{image:t}=w.attribute;if(!t||!w.resources||"success"!==w.resources.get(t).state)return}let S=null!=(s=null!=(l=w.attribute.textAlign)?l:w.textAlign)?s:"left";w.AABBBounds.width();let A=w.globalAABBBounds.x1,M=w.globalAABBBounds.x2;if("center"===S&&n){let n=t.globalAABBBounds.x1+(null!=(o=null==(a=t.firstChild)?void 0:a.attribute.dx)?o:0),l=n+(null!=(d=null!=(h=t.contentWidth)?h:t.attribute.width)?d:0);if(n<e||l>i){let s=Math.max(n,e),a=Math.min(l,i),o=w.globalTransMatrix.e-(a+s)/2;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(c=null==(u=t.firstChild)?void 0:u.attribute.dx)?c:0,dy:null!=(g=null==(p=t.firstChild)?void 0:p.attribute.dy)?g:0}),t.forEachChildren(t=>{var e;t.setAttribute("dx",(null!=(e=t.attribute.dx)?e:0)-o+2)})}}else if(A<e){let i=A-e;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(m=null==(f=t.firstChild)?void 0:f.attribute.dx)?m:0,dy:null!=(v=null==(y=t.firstChild)?void 0:y.attribute.dy)?v:0}),t.forEachChildren(t=>{var e;t.setAttribute("dx",(null!=(e=t.attribute.dx)?e:0)-i+2)})}else if(M>i){let e=M-i;r.has(`${t.col}-${t.row}`)||r.set(`${t.col}-${t.row}`,{col:t.col,row:t.row,dx:null!=(_=null==(b=t.firstChild)?void 0:b.attribute.dx)?_:0,dy:null!=(x=null==(C=t.firstChild)?void 0:C.attribute.dy)?x:0}),t.forEachChildren(t=>{var i;t.setAttribute("dx",(null!=(i=t.attribute.dx)?i:0)-e)})}}function eQ(t){var e,i;let r=t.internalProps.layoutMap.headerObjects,n=t.internalProps.layoutMap.columnObjects;for(let t=0;t<r.length;t++){let i=r[t];if(i&&(null==(e=i.style)?void 0:e.textStick))return!0}for(let t=0;t<n.length;t++){let e=n[t];if(e&&(null==(i=e.style)?void 0:i.textStick))return!0}return!!(t.theme.headerStyle.textStick||t.theme.rowHeaderStyle.textStick||t.theme.bodyStyle.textStick)}var e0=function(t,e,i,r){return new(i||(i=Promise))(function(n,l){function s(t){try{o(r.next(t))}catch(t){l(t)}}function a(t){try{o(r.throw(t))}catch(t){l(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(s,a)}o((r=r.apply(t,e||[])).next())})};class e1{constructor(t){this.isRelease=!1,this.mode="column",this.rowLimit=200,this.currentRow=0,this.rowStart=0,this.rowEnd=0,this.referenceRow=0,this.screenTopRow=0,this.deltaY=0,this.deltaHeight=0,this.colLimit=100,this.screenLeftCol=0,this.deltaX=0,this.deltaWidth=0,this.cellCache=new Map,this.table=t,this.table.isPivotChart()?(this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))):this.table.isAutoRowHeight(t.columnHeaderLevelCount)?this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)):("autoWidth"===this.table.widthMode||(this.rowLimit=Math.max(200,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight))),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))),this.table.internalProps.transpose?this.mode="row":this.table.isPivotTable()&&(this.mode="pivot"),this.table.options.maintainedDataCount&&(this.rowLimit=this.table.options.maintainedDataCount),this.table.options.maintainedColumnCount&&(this.colLimit=this.table.options.maintainedColumnCount),"adaptive"===this.table.heightMode&&(this.rowLimit=this.table.rowCount),"adaptive"===this.table.widthMode&&(this.colLimit=this.table.colCount)}get bodyLeftCol(){return this.table.frozenColCount}get bodyTopRow(){return this.table.frozenRowCount}setParamsForColumn(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;let t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol;let e=this.table.defaultColWidth;this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/e);let i=e*t,r=e*(this.bodyRightCol-this.bodyLeftCol+1);this.xLimitLeft=i/2,this.xLimitRight=r-i/2;let n=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/e),this.firstScreenColLimit=Math.max(15,this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(n/e))),this.colUpdatePos=this.bodyRightCol}setParamsForRow(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;let t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.bodyTopRow+t-1,this.rowStart=this.bodyTopRow,this.rowEnd=this.totalRow;let e=this.table.defaultRowHeight;this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/e);let i=e*t,r=e*(this.bodyBottomRow-this.bodyTopRow+1);this.yLimitTop=i/2,this.yLimitBottom=r-i/2;let n=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/e),this.firstScreenRowLimit=Math.max(30,this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(n/e))),this.rowUpdatePos=this.bodyBottomRow}refreshRowCount(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;let t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.rowStart+t-1}refreshColCount(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;let t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol}resize(){let t=this.table.defaultColWidth;this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/t);let e=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/t),this.firstScreenColLimit=this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(e/t));let i=this.table.defaultRowHeight;this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/i);let r=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/i),this.firstScreenRowLimit=this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(r/i))}createGroupForFirstScreen(t,e,i,r,n,l,s,a){!function(t,e,i,r,n,l,s,a,o){var h,d,u,c,p,g,f,m,y,v,b,_,C;let x,w,S,A,{table:M}=o,{leftBottomCornerGroup:T,rightTopCornerGroup:k,rightBottomCornerGroup:R}=M.scenegraph;o.setParamsForRow(),o.setParamsForColumn(),("adaptive"===M.widthMode||M.options.autoWrapText&&("adaptive"===M.heightMode||M.isAutoRowHeight(M.columnHeaderLevelCount)))&&(S=M.colCount-1),x=Math.min(o.firstScreenColLimit-1,M.colCount-1),"adaptive"===M.heightMode&&(A=M.rowCount-1),w=Math.min(o.firstScreenRowLimit-1,M.rowCount-1),0===M.internalProps._widthResizedColMap.size&&(0,ex.rj)(M,0,null!=S?S:x),0===M.internalProps._heightResizedRowMap.size&&(0,te.Y)(M,0,"auto"===M.options.canvasHeight||(null==(h=M.options.customConfig)?void 0:h.forceComputeAllRowHeight)?M.rowCount-1:null!=A?A:w),x<M.colCount-M.rightFrozenColCount&&M.colCount-M.rightFrozenColCount<=M.colCount-1&&(0,ex.rj)(M,M.colCount-M.rightFrozenColCount,M.colCount-1),w<M.rowCount-M.bottomFrozenRowCount&&M.rowCount-M.bottomFrozenRowCount<=M.rowCount-1&&(0,te.Y)(M,M.rowCount-M.bottomFrozenRowCount,M.rowCount-1),M.scenegraph.colHeaderGroup.setAttribute("x",M.getFrozenColsWidth()),M.scenegraph.rowHeaderGroup.setAttribute("y",M.getFrozenRowsHeight()),M.scenegraph.bottomFrozenGroup.setAttribute("x",M.getFrozenColsWidth()),M.scenegraph.rightFrozenGroup.setAttribute("y",M.getFrozenRowsHeight()),M.scenegraph.bodyGroup.setAttributes({x:M.getFrozenColsWidth(),y:M.getFrozenRowsHeight()}),ek(t,s,a,0,M.frozenColCount-1,0,M.frozenRowCount-1,M.isListTable()?"columnHeader":"cornerHeader",M),x-M.rightFrozenColCount>=M.frozenColCount&&ek(e,s,a,M.frozenColCount,x-M.rightFrozenColCount,0,M.frozenRowCount-1,"columnHeader",M),M.frozenColCount>0&&(M.leftRowSeriesNumberCount>0&&ek(i,s,a,0,M.leftRowSeriesNumberCount-1,M.frozenRowCount,w-M.bottomFrozenRowCount,"rowHeader",M),M.frozenColCount>M.leftRowSeriesNumberCount&&ek(i,s,a,M.leftRowSeriesNumberCount,Math.min(M.frozenColCount-1,M.rowHeaderLevelCount+M.leftRowSeriesNumberCount-1),M.frozenRowCount,w-M.bottomFrozenRowCount,"rowHeader",M),M.frozenColCount>M.rowHeaderLevelCount+M.leftRowSeriesNumberCount&&ek(i,s,a,M.rowHeaderLevelCount+M.leftRowSeriesNumberCount,M.frozenColCount-1,M.frozenRowCount,w-M.bottomFrozenRowCount,"body",M)),M.bottomFrozenRowCount>0&&(M.frozenColCount>0&&(M.leftRowSeriesNumberCount>0&&ek(T,s,a,0,M.leftRowSeriesNumberCount-1,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,"rowHeader",M),M.rowHeaderLevelCount>0&&ek(T,s,a,M.leftRowSeriesNumberCount,M.leftRowSeriesNumberCount+M.rowHeaderLevelCount-1,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,"rowHeader",M),M.frozenColCount>M.rowHeaderLevelCount+M.leftRowSeriesNumberCount&&ek(T,s,a,M.rowHeaderLevelCount+M.leftRowSeriesNumberCount,M.frozenColCount-1,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,"body",M)),x-M.rightFrozenColCount>=M.frozenColCount&&ek(n,s,a,M.frozenColCount,x-M.rightFrozenColCount,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,M.isPivotChart()?"rowHeader":"body",M)),M.rightFrozenColCount>0&&(ek(k,s,a,M.colCount-1-M.rightFrozenColCount+1,M.colCount-1,0,M.frozenRowCount-1,"columnHeader",M),ek(r,s,a,M.colCount-1-M.rightFrozenColCount+1,M.colCount-1,M.frozenRowCount,w-M.bottomFrozenRowCount,M.isPivotChart()?"rowHeader":"body",M)),M.bottomFrozenRowCount>0&&M.rightFrozenColCount>0&&ek(R,s,a,M.colCount-1-M.rightFrozenColCount+1,M.colCount-1,M.rowCount-1-M.bottomFrozenRowCount+1,M.rowCount-1,"body",M),x-M.rightFrozenColCount>=M.frozenColCount&&ek(l,s,a,M.frozenColCount,x-M.rightFrozenColCount,M.frozenRowCount,w-M.bottomFrozenRowCount,"body",M),l.firstChild||e.firstChild||t.firstChild||i.firstChild?(o.currentRow=null!=(p=null!=(u=null==(d=l.firstChild)?void 0:d.rowNumber)?u:null==(c=i.firstChild)?void 0:c.rowNumber)?p:o.totalRow,o.rowEnd=o.currentRow,o.rowUpdatePos=o.rowEnd+1,o.referenceRow=o.rowStart+Math.floor((o.rowEnd-o.rowStart)/2),o.currentCol=null!=(C=null!=(b=null!=(y=null!=(f=null==(g=l.lastChild)?void 0:g.col)?f:null==(m=e.lastChild)?void 0:m.col)?y:null==(v=i.lastChild)?void 0:v.col)?b:null==(_=t.lastChild)?void 0:_.col)?C:o.totalCol,o.colEnd=o.currentCol,o.colUpdatePos=o.colEnd+1,o.referenceCol=o.colStart+Math.floor((o.colEnd-o.colStart)/2),o.progress()):(o.currentRow=o.totalRow,o.rowEnd=o.currentRow,o.rowUpdatePos=o.rowEnd+1,o.referenceRow=o.rowStart+Math.floor((o.rowEnd-o.rowStart)/2),o.currentCol=o.totalCol,o.colEnd=o.currentCol,o.colUpdatePos=o.colEnd+1,o.referenceCol=o.colStart+Math.floor((o.colEnd-o.colStart)/2))}(t,e,i,r,n,l,s,a,this)}progress(){return e0(this,void 0,void 0,function*(){if(!this.isProgressing)return this.isProgressing=!0,new Promise((t,e)=>{setTimeout(()=>e0(this,void 0,void 0,function*(){this.isProgressing=!1,this.isRelease||(this.colUpdatePos<=this.colEnd?(yield this.updateColCellGroupsAsync(),yield this.progress()):this.rowUpdatePos<=this.rowEnd?(yield this.updateRowCellGroupsAsync(),yield this.progress()):this.currentCol<this.totalCol?(yield this.createCol(),yield this.progress()):this.currentRow<this.totalRow&&(yield this.createRow(),yield this.progress()),eX(this.table),this.table.scenegraph.updateNextFrame(),t())}),16)})})}createRow(){return e0(this,void 0,void 0,function*(){this.taskRowCount&&this.createRowCellGroup(this.taskRowCount)})}createCol(){return e0(this,void 0,void 0,function*(){this.taskColCount&&this.createColGroup(this.taskRowCount)})}createRowCellGroup(t){let e=Math.min(this.totalRow,this.currentRow+t);if("adaptive"!==this.table.heightMode&&(0,te.Y)(this.table,this.currentRow+1,e,!1),this.rowEnd=e,this.table.frozenColCount){let t=0;for(let i=0;i<this.table.frozenColCount;i++){let r=this.table.scenegraph.getColGroup(i),{height:n}=(this.table.isListTable(),eA(r,i,r.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));t=Math.max(t,n),this.table.scenegraph.rowHeaderGroup.setAttribute("height",t)}}if(this.table.rightFrozenColCount){let t=0;for(let i=this.table.colCount-this.table.rightFrozenColCount;i<this.table.colCount;i++){let r=this.table.scenegraph.getColGroup(i),{height:n}=(this.table.isPivotChart(),eA(r,i,r.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));t=Math.max(t,n),this.table.scenegraph.rightFrozenGroup.setAttribute("height",t)}}let i=0;for(let t=this.bodyLeftCol;t<=this.bodyRightCol;t++){let r=this.table.scenegraph.getColGroup(t);if(!r)continue;this.table.rowHeaderLevelCount;let{height:n}=eA(r,t,r.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table);i=Math.max(i,n)}this.table.scenegraph.bodyGroup.setAttribute("height",i),this.currentRow=e,this.rowUpdatePos=this.rowEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}createColGroup(t){let e=Math.min(this.totalCol,this.currentCol+t);"adaptive"!==this.table.widthMode&&(0,ex.rj)(this.table,this.currentCol+1,e),this.colEnd=e;for(let t=0;t<this.table.rowCount;t++){let e=this.highPerformanceGetCell(this.currentCol,t);"cell"===e.role&&(0,$.Z)(e.mergeStartCol)&&e.mergeStartCol>this.currentCol&&this.table.scenegraph.updateCellContent(e.col,e.row)}if(this.table.frozenRowCount){let t=this.table.scenegraph.colHeaderGroup.lastChild instanceof tf.Z?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev,i=t.attribute.x+t.attribute.width,r=t.attribute.y;ek(this.table.scenegraph.colHeaderGroup,i,r,this.currentCol+1,e,0,this.table.frozenRowCount-1,"columnHeader",this.table)}if(this.table.bottomFrozenRowCount){let t=this.table.scenegraph.bottomFrozenGroup.lastChild instanceof tf.Z?this.table.scenegraph.bottomFrozenGroup.lastChild:this.table.scenegraph.bottomFrozenGroup.lastChild._prev,i=t.attribute.x+t.attribute.width,r=t.attribute.y;ek(this.table.scenegraph.bottomFrozenGroup,i,r,this.currentCol+1,e,this.table.rowCount-this.table.bottomFrozenRowCount,this.table.rowCount-1,"columnHeader",this.table)}let i=this.table.scenegraph.bodyGroup.lastChild&&(this.table.scenegraph.bodyGroup.lastChild instanceof tf.Z?this.table.scenegraph.bodyGroup.lastChild:this.table.scenegraph.bodyGroup.lastChild._prev);i||(i=this.table.scenegraph.colHeaderGroup.lastChild&&(this.table.scenegraph.colHeaderGroup.lastChild instanceof tf.Z?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev));let r=i.attribute.x+i.attribute.width,n=i.attribute.y;ek(this.table.scenegraph.bodyGroup,r,n,this.currentCol+1,e,this.rowStart,this.rowEnd,"body",this.table),this.currentCol=e,this.colUpdatePos=this.colEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}setY(t,e=!1){return e0(this,void 0,void 0,function*(){let i=this.table.getRowsHeight(this.bodyTopRow,this.bodyTopRow+(this.rowEnd-this.rowStart+1))/2,r=this.table.getAllRowsHeight()-i,n=this.table.getTargetRowAt(t+this.table.scenegraph.colHeaderGroup.attribute.height);n&&(this.screenTopRow=n.row),t<i&&this.rowStart===this.bodyTopRow||t>r&&this.rowEnd===this.bodyBottomRow?(this.updateDeltaY(t),this.updateBody(t-this.deltaY)):this.table.scenegraph.bodyGroup.firstChild&&"group"===this.table.scenegraph.bodyGroup.firstChild.type&&0!==this.table.scenegraph.bodyGroup.firstChild.childrenCount||this.table.scenegraph.rowHeaderGroup.firstChild&&"group"===this.table.scenegraph.rowHeaderGroup.firstChild.type&&0!==this.table.scenegraph.rowHeaderGroup.firstChild.childrenCount?this.dynamicSetY(t,n,e):(this.updateDeltaY(t),this.updateBody(t-this.deltaY))})}setX(t,e=!1){return e0(this,void 0,void 0,function*(){let i=this.table.getColsWidth(this.bodyLeftCol,this.bodyLeftCol+(this.colEnd-this.colStart+1))/2,r=this.table.getAllColsWidth()-i,n=this.table.getTargetColAt(t+this.table.scenegraph.rowHeaderGroup.attribute.width);n&&(this.screenLeftCol=n.col),t<i&&this.colStart===this.bodyLeftCol||t>r&&this.colEnd===this.bodyRightCol||this.table.scenegraph.bodyGroup.firstChild&&"group"===this.table.scenegraph.bodyGroup.firstChild.type&&0===this.table.scenegraph.bodyGroup.firstChild.childrenCount?(this.updateDeltaX(t),this.table.scenegraph.setBodyAndColHeaderX(-t+this.deltaX)):this.dynamicSetX(t,n,e)})}dynamicSetY(t,e,i=!1){return e0(this,void 0,void 0,function*(){!function(t,e,i,r){eN(this,void 0,void 0,function*(){var n,l,s,a,o;if(!e)return;let h=e.row,d=e.top;if(n=i?r.bodyBottomRow-r.rowEnd:h-r.referenceRow,l=h,s=d,a=t,o=r,n>0?ej(n,"up",l,s,a,o):n<0&&ej(-n,"down",l,s,a,o),o.updateDeltaY(a,s,l),o.updateBody(a-o.deltaY),i){let e=r.table.scenegraph.highPerformanceGetCell(r.colStart,r.rowEnd,!0);if("cell"===e.role){let i=e.attribute.y+e.attribute.height-(r.table.tableNoFrameHeight-r.table.getFrozenRowsHeight()-r.table.getBottomFrozenRowsHeight())-t;r.deltaY=-i,r.updateBody(t-r.deltaY)}}})}(t,e,i,this)})}dynamicSetX(t,e,i=!1){return e0(this,void 0,void 0,function*(){!function(t,e,i,r){eE(this,void 0,void 0,function*(){var n,l,s,a,o;if(!e)return;let h=e.col,d=e.left;if(n=i?r.bodyRightCol-r.colEnd:r.screenLeftCol-r.referenceCol,l=h,s=d,a=t,o=r,n>0?eL(n,"left",o.screenLeftCol,s,a,o):n<0&&eL(-n,"right",o.screenLeftCol,s,a,o),o.updateDeltaX(a,s,l),o.table.scenegraph.setBodyAndColHeaderX(-a+o.deltaX),i){let e=r.table.scenegraph.getColGroup(r.colEnd);if(e){let i=e.attribute.x+e.attribute.width-(r.table.tableNoFrameWidth-r.table.getFrozenColsWidth()-r.table.getRightFrozenColsWidth())-t;r.deltaX=-i,r.table.scenegraph.setBodyAndColHeaderX(-t+r.deltaX)}}r.table.scenegraph.updateNextFrame()})}(t,e,i,this)})}updateBody(t){this.table.scenegraph.setBodyAndRowHeaderY(-t)}updateRowCellGroupsAsync(){return e0(this,void 0,void 0,function*(){this.updateCellGroups(this.taskRowCount)})}updateCellGroups(t){let e=Math.min(this.bodyBottomRow,this.rowUpdatePos+t);this.table.isAutoRowHeight(this.rowUpdatePos)&&(0,te.Y)(this.table,this.rowUpdatePos,e,!1),eV(this.rowUpdatePos,e,this),this.table.isAutoRowHeight(this.rowUpdatePos)&&(eW(this.bodyLeftCol,this.bodyRightCol,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),eW(0,this.table.frozenColCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),eW(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0)),this.rowUpdatePos=e+1}updateBottomFrozenCellGroups(){let t=this.table.rowCount-this.table.bottomFrozenRowCount,e=this.table.rowCount-1;this.table.isAutoRowHeight(t)&&(0,te.Y)(this.table,t,e,!1),eV(t,e,this),this.table.isAutoRowHeight(t)&&(eW(this.bodyLeftCol,this.bodyRightCol,t,e,this.table,this.rowUpdateDirection),eW(0,this.table.frozenColCount-1,t,e,this.table,this.rowUpdateDirection),eW(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,t,e,this.table,this.rowUpdateDirection))}updateRightFrozenCellGroups(){let t=this.table.colCount-this.table.rightFrozenColCount,e=this.table.colCount-1;"autoWidth"===this.table.widthMode&&(0,ex.rj)(this.table,t,e,!1),eD(t,e,this),this.table.isAutoRowHeight(this.rowStart)&&eB(t,e,this.table,this.colUpdateDirection)}updateColCellGroupsAsync(){return e0(this,void 0,void 0,function*(){this.updateColGroups(this.taskRowCount)})}updateColGroups(t){let e=Math.min(this.bodyRightCol,this.colUpdatePos+t);"autoWidth"===this.table.widthMode&&(0,ex.rj)(this.table,this.colUpdatePos,e),eD(this.colUpdatePos,e,this),this.colUpdatePos=e+1}updateCellGroupPosition(t,e,i){t.row=e,t.mergeStartCol=void 0,t.mergeStartRow=void 0,t.mergeEndCol=void 0,t.mergeEndRow=void 0,t.setAttribute("y",i),t.needUpdate=!0,t.needUpdateForAutoRowHeight=!0}updateCellGroupContent(t){if(!t.needUpdate||"cell"!==t.role)return t;let e=this.table.scenegraph.updateCellContent(t.col,t.row);return t.needUpdate=!1,e||t}sortCellVertical(){return e0(this,void 0,void 0,function*(){yield function(t){var e,i,r,n,l;return i=this,r=void 0,n=void 0,l=function*(){let i,r;t.table.scenegraph.bodyGroup.forEachChildren((t,e)=>{"group"===t.type&&(t.needUpdate=!0,null==t||t.forEachChildren(t=>{t.needUpdate=!0}))}),t.table.isAutoRowHeight(t.rowStart)?(i=t.rowStart,r=t.rowEnd):(i=Math.max(t.bodyTopRow,t.screenTopRow-t.screenRowCount),r=Math.min(t.bodyBottomRow,t.screenTopRow+2*t.screenRowCount,t.table.rowCount-1));let n=t.table.getAllRowsHeight();(0,te.Y)(t.table,i,r);let l=t.table.getAllRowsHeight();n!==l&&t.table.scenegraph.updateContainerHeight(t.table.frozenRowCount,l-n);for(let i=0;i<(null!=(e=t.table.frozenColCount)?e:0);i++){let e=t.table.scenegraph.getColGroup(i);null==e||e.setAttribute("chartInstance",void 0);for(let e=t.rowStart;e<=t.rowEnd;e++)t.table.scenegraph.updateCellContent(i,e);for(let e=t.table.rowCount-t.table.bottomFrozenRowCount;e<t.table.rowCount;e++)t.table.scenegraph.updateCellContent(i,e)}for(let e=t.colStart;e<=t.colEnd;e++){let i=t.table.scenegraph.getColGroup(e);null==i||i.setAttribute("chartInstance",void 0);for(let i=t.table.rowCount-t.table.bottomFrozenRowCount;i<t.table.rowCount;i++)t.table.scenegraph.updateCellContent(e,i)}for(let e=t.table.colCount-t.table.rightFrozenColCount;e<t.table.colCount;e++){let i=t.table.scenegraph.getColGroup(e);null==i||i.setAttribute("chartInstance",void 0);for(let i=t.rowStart;i<=t.rowEnd;i++)t.table.scenegraph.updateCellContent(e,i);for(let i=t.table.rowCount-t.table.bottomFrozenRowCount;i<t.table.rowCount;i++)t.table.scenegraph.updateCellContent(e,i)}eV(i,r,t),t.table.isAutoRowHeight(i)&&eW(t.bodyLeftCol,t.bodyRightCol,i,r,t.table,t.rowEnd>t.bodyBottomRow-(t.rowEnd-t.rowStart+1)?"down":"up"),t.rowUpdatePos=t.rowStart,t.rowUpdateDirection=t.rowEnd>t.bodyBottomRow-(t.rowEnd-t.rowStart+1)?"down":"up",t.table.scenegraph.updateNextFrame(),t.table.isAutoRowHeight(t.rowStart)||(yield t.progress())},new(n||(n=Promise))(function(t,e){function s(t){try{o(l.next(t))}catch(t){e(t)}}function a(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(s,a)}o((l=l.apply(i,r||[])).next())})}(this)})}sortCellHorizontal(){return e0(this,void 0,void 0,function*(){yield function(t){var e,i,r,n;return e=this,i=void 0,r=void 0,n=function*(){t.table.scenegraph.bodyGroup.forEachChildren((t,e)=>{"group"===t.type&&(t.needUpdate=!0,null==t||t.forEachChildren(t=>{t.needUpdate=!0}))});let e=Math.max(t.bodyLeftCol,t.screenLeftCol-t.screenColCount),i=Math.min(t.bodyRightCol,t.screenLeftCol+2*t.screenColCount);(0,ex.rj)(t.table,e,i);for(let e=t.colStart;e<=t.colEnd;e++){let i=t.table.scenegraph.getColGroup(e);null==i||i.setAttribute("chartInstance",void 0);for(let i=t.table.rowCount-t.table.bottomFrozenRowCount;i<t.table.rowCount;i++)t.table.scenegraph.updateCellContent(e,i)}for(let e=t.table.colCount-t.table.rightFrozenColCount;e<t.table.colCount;e++){let i=t.table.scenegraph.getColGroup(e);null==i||i.setAttribute("chartInstance",void 0);for(let i=t.rowStart;i<=t.rowEnd;i++)t.table.scenegraph.updateCellContent(e,i);for(let i=t.table.rowCount-t.table.bottomFrozenRowCount;i<t.table.rowCount;i++)t.table.scenegraph.updateCellContent(e,i)}eD(e,i,t),t.colUpdatePos=t.colStart,t.colUpdateDirection=t.colEnd>t.bodyRightCol-(t.colEnd-t.colStart+1)?"right":"left",t.table.scenegraph.updateNextFrame(),yield t.progress()},new(r||(r=Promise))(function(t,l){function s(t){try{o(n.next(t))}catch(t){l(t)}}function a(t){try{o(n.throw(t))}catch(t){l(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(s,a)}o((n=n.apply(e,i||[])).next())})}(this)})}highPerformanceGetCell(t,e,i){if(e>=this.table.frozenRowCount&&e<this.table.rowCount-this.table.bottomFrozenRowCount&&(e<this.rowStart||e>this.rowEnd)||t>=this.table.frozenColCount&&t<this.table.colCount-this.table.rightFrozenColCount&&(t<this.colStart||t>this.colEnd))return ew;if(this.cellCache.get(t)){let r=this.cellCache.get(t);if((r._next||r._prev)&&Math.abs(r.row-e)<e){let n=function t(e,i){if(!e)return null;if(e.row===i)return e;let r=e._prev,n=e._next;return e.row>i&&r&&r.row===e.row-1?t(r,i):e.row<i&&n&&n.row===e.row+1?t(n,i):null}(r,e);return n&&(i||"shadow-cell"!==n.role)||(n=this.table.scenegraph.getCell(t,e,i)),n.row&&this.cellCache.set(t,n),n}let n=this.table.scenegraph.getCell(t,e,i);return n.col===t&&n.row&&this.cellCache.set(t,n),n}let r=this.table.scenegraph.getCell(t,e,i);return r.col===t&&r.row&&this.cellCache.set(t,r),r}updateDeltaY(t,e,i){if(this.rowStart===this.bodyTopRow){let t=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowStart,!0);if("cell"===t.role){let e=t.attribute.y;this.deltaY=-e}}else if(this.rowEnd===this.bodyBottomRow){let t=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowEnd,!0);if("cell"===t.role){let e=this.table.getRowHeight(this.rowEnd),i=t.attribute.y+e-(this.table.getAllRowsHeight()-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight());this.deltaY=-i}}else if((0,y.Z)(e)&&(0,y.Z)(i)){let r=this.table.scenegraph.highPerformanceGetCell(this.colStart,i,!0);"cell"!==r.role&&(r=this.table.scenegraph.highPerformanceGetCell(0,i,!0));let n=t-this.deltaY,l=e-n,s=r.attribute.y-n+this.table.getFrozenRowsHeight();this.deltaY=l-s}}updateDeltaX(t,e,i){if(this.colStart===this.bodyLeftCol){let t=this.table.scenegraph.getColGroup(this.colStart);if(t){let e=t.attribute.x;this.deltaX=-e}}else if(this.colEnd===this.bodyRightCol){let t=this.table.scenegraph.getColGroup(this.colEnd);if(t){let e=t.attribute.x+t.attribute.width-(this.table.getAllColsWidth()-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth());this.deltaX=-e}}else if((0,y.Z)(e)&&(0,y.Z)(i)){let r=this.table.scenegraph.getColGroup(i)||this.table.scenegraph.getColGroup(i,!0),n=t-this.deltaX,l=e-n,s=r.attribute.x-n+this.table.getFrozenColsWidth();this.deltaX=l-s}}release(){this.isRelease=!0}}var e2=i(73044);function e3(t){t.customSelectedRangeComponents.forEach((e,i)=>{e5(e,i,t)}),t.selectingRangeComponents.forEach((e,i)=>{e5(e,i,t)}),t.selectedRangeComponents.forEach((e,i)=>{e5(e,i,t)})}function e5(t,e,i){var r,n,l,s,a,o,h,d,u,c;let p=i.table,[g,f,m,y]=e.split("-"),v=parseInt(g,10),b=parseInt(f,10),_=parseInt(m,10),C=parseInt(y,10),x,w=v,S=b,A=_,M=C;switch(t.role){case"rowHeader":(x=p.getBodyVisibleRowRange())&&(S=Math.max(b,x.rowStart-1),M=Math.min(C,x.rowEnd+1));break;case"columnHeader":case"bottomFrozen":(x=p.getBodyVisibleCellRange())&&(w=Math.max(v,x.colStart-1),A=Math.min(_,x.colEnd+1));break;case"cornerHeader":case"rightTopCorner":case"leftBottomCorner":case"rightBottomCorner":break;case"rightFrozen":(x=p.getBodyVisibleCellRange())&&(S=Math.max(b,x.rowStart-1),M=Math.min(C,x.rowEnd+1));break;default:(x=p.getBodyVisibleCellRange())&&(S=Math.max(b,x.rowStart-1),M=Math.min(C,x.rowEnd+1),w=Math.max(v,x.colStart-1),A=Math.min(_,x.colEnd+1))}let T=p.getColsWidth(w,A),k=p.getRowsHeight(S,M),R=i.highPerformanceGetCell(w,S).globalAABBBounds;if(t.rect.setAttributes({x:R.x1-i.tableGroup.attribute.x,y:R.y1-i.tableGroup.attribute.y,width:T,height:k,visible:!0}),p.hasListeners(I.B.AFTER_UPDATE_SELECT_BORDER_HEIGHT)&&p.fireListeners(I.B.AFTER_UPDATE_SELECT_BORDER_HEIGHT,{startRow:S,endRow:M,currentHeight:k,selectComp:t}),t.fillhandle){let e=null==(r=i.table.options.excelOptions)?void 0:r.fillHandle,l,s,a=!0;"function"==typeof e&&(a=e({selectRanges:i.table.stateManager.select.ranges,table:i.table})),s=_<p.colCount-1?i.highPerformanceGetCell(_,C).globalAABBBounds.x2-i.tableGroup.attribute.x-3:0===v?i.highPerformanceGetCell(0,C).globalAABBBounds.x1-i.tableGroup.attribute.x:i.highPerformanceGetCell(v-1,C).globalAABBBounds.x2-i.tableGroup.attribute.x-3;let o=(C<p.rowCount-1?i.highPerformanceGetCell(_,C).globalAABBBounds:i.highPerformanceGetCell(_,b-1).globalAABBBounds).y2-i.tableGroup.attribute.y-3;null==(n=t.fillhandle)||n.setAttributes({x:s,y:o,width:6,height:6,visible:a})}let P=!!p.frozenColCount&&v===p.frozenColCount;!P&&p.frozenColCount&&p.scrollLeft>0&&v>=p.frozenColCount&&p.getColsWidth(0,v-1)-p.scrollLeft<p.getFrozenColsWidth()&&(P=!0);let B=!!p.rightFrozenColCount&&p.rightFrozenColCount>0&&_===p.colCount-p.rightFrozenColCount-1;!B&&p.rightFrozenColCount&&_<p.colCount-p.rightFrozenColCount&&p.getColsWidth(0,_)-p.scrollLeft>p.tableNoFrameWidth-p.getRightFrozenColsWidth()&&(B=!0);let E=!p.frozenRowCount||b===p.frozenRowCount;!E&&p.frozenRowCount&&p.scrollTop>0&&b>=p.frozenRowCount&&p.getRowsHeight(0,b-1)-p.scrollTop<p.getFrozenRowsHeight()&&(E=!0);let L=!!p.bottomFrozenRowCount&&C===p.rowCount-p.bottomFrozenRowCount-1;!L&&p.bottomFrozenRowCount&&C<p.rowCount-p.bottomFrozenRowCount&&p.getRowsHeight(0,C)-p.scrollTop>p.tableNoFrameHeight-p.getBottomFrozenRowsHeight()&&(L=!0);let{dynamicUpdateSelectionSize:F}=p.theme.selectionStyle;if(P&&(t.rect.attribute.stroke[3]||F)||B&&(t.rect.attribute.stroke[1]||F)||E&&(t.rect.attribute.stroke[0]||F)||L&&(t.rect.attribute.stroke[2]||F)){if(P&&t.rect.attribute.stroke[3]&&i.tableGroup.insertAfter(t.rect,"columnHeader"===t.role?i.cornerHeaderGroup:"bottomFrozen"===t.role?i.leftBottomCornerGroup:i.rowHeaderGroup),L&&t.rect.attribute.stroke[2]&&i.tableGroup.insertAfter(t.rect,"rowHeader"===t.role?i.leftBottomCornerGroup:"rightFrozen"===t.role?i.rightBottomCornerGroup:i.bottomFrozenGroup),E&&t.rect.attribute.stroke[0]&&i.tableGroup.insertAfter(t.rect,"rowHeader"===t.role?i.cornerHeaderGroup:"rightFrozen"===t.role?i.rightTopCornerGroup:i.colHeaderGroup),B&&t.rect.attribute.stroke[1]&&i.tableGroup.insertAfter(t.rect,"columnHeader"===t.role?i.rightTopCornerGroup:"bottomFrozen"===t.role?i.rightBottomCornerGroup:i.rightFrozenGroup),t.rect.attribute.x<p.getFrozenColsWidth()&&p.scrollLeft>0&&("body"===t.role||"columnHeader"===t.role||"bottomFrozen"===t.role)){let e=t.rect.attribute.width-(p.getFrozenColsWidth()-t.rect.attribute.x);t.rect.setAttributes({x:t.rect.attribute.x+(p.getFrozenColsWidth()-t.rect.attribute.x),width:e>0?e:0}),null==(l=t.fillhandle)||l.setAttributes({visible:e>0})}if(p.getRightFrozenColsWidth()>0&&i.rightFrozenGroup.attribute.height>0&&t.rect.attribute.x+t.rect.attribute.width>i.rightFrozenGroup.attribute.x&&("body"===t.role||"columnHeader"===t.role||"bottomFrozen"===t.role)){let e=i.rightFrozenGroup.attribute.x-t.rect.attribute.x;t.rect.setAttributes({x:t.rect.attribute.x,width:e>0?e:0}),null==(s=t.fillhandle)||s.setAttributes({visible:e-T>0})}if(t.rect.attribute.y<i.colHeaderGroup.attribute.height&&p.scrollTop>0&&("body"===t.role||"rowHeader"===t.role||"rightFrozen"===t.role)){let e=t.rect.attribute.height-(i.colHeaderGroup.attribute.height-t.rect.attribute.y);t.rect.setAttributes({y:t.rect.attribute.y+(i.colHeaderGroup.attribute.height-t.rect.attribute.y),height:e>0?e:0}),null==(a=t.fillhandle)||a.setAttributes({visible:e>0})}if(i.bottomFrozenGroup.attribute.width>0&&i.bottomFrozenGroup.attribute.height>0&&t.rect.attribute.y+t.rect.attribute.height>i.bottomFrozenGroup.attribute.y&&("body"===t.role||"rowHeader"===t.role||"rightFrozen"===t.role)){let e=i.bottomFrozenGroup.attribute.y-t.rect.attribute.y;t.rect.setAttributes({y:t.rect.attribute.y,height:e>0?e:0}),null==(o=t.fillhandle)||o.setAttributes({visible:e-k>0})}}else i.tableGroup.insertAfter(t.rect,"body"===t.role?i.bodyGroup:"columnHeader"===t.role?i.colHeaderGroup:"rowHeader"===t.role?i.rowHeaderGroup:"cornerHeader"===t.role?i.cornerHeaderGroup:"rightTopCorner"===t.role?i.rightTopCornerGroup:"rightFrozen"===t.role?i.rightFrozenGroup:"leftBottomCorner"===t.role?i.leftBottomCornerGroup:"bottomFrozen"===t.role?i.bottomFrozenGroup:i.rightBottomCornerGroup);let O=0;"number"==typeof t.rect.attribute.lineWidth&&(O=Math.ceil(t.rect.attribute.lineWidth/2)),_===p.colCount-1&&(Array.isArray(t.rect.attribute.lineWidth)&&(O=Math.ceil((null!=(h=t.rect.attribute.lineWidth[1])?h:0)/2)),t.rect.setAttributes({width:t.rect.attribute.width-O})),0===v&&(Array.isArray(t.rect.attribute.lineWidth)&&(O=Math.ceil((null!=(d=t.rect.attribute.lineWidth[3])?d:0)/2)),t.rect.setAttributes({x:t.rect.attribute.x+O,width:t.rect.attribute.width-O})),C===p.rowCount-1&&(Array.isArray(t.rect.attribute.lineWidth)&&(O=Math.ceil((null!=(u=t.rect.attribute.lineWidth[2])?u:0)/2)),t.rect.setAttributes({height:t.rect.attribute.height-O})),0===b&&(Array.isArray(t.rect.attribute.lineWidth)&&(O=Math.ceil((null!=(c=t.rect.attribute.lineWidth[0])?c:0)/2)),t.rect.setAttributes({y:t.rect.attribute.y+O,height:t.rect.attribute.height-O}))}function e4(t,e,i=!0){let r=t.table,n=e.start.col,l=e.start.row,s=e.end.col,a=e.end.row,o=e.skipBodyMerge,h=Math.max(Math.min(s,n),0),d=Math.max(Math.min(a,l),0),u=Math.min(Math.max(s,n),r.colCount-1),c=Math.min(Math.max(a,l),r.rowCount-1),p=()=>{let t=!1;for(let e=h;e<=u;e++){if(e===h)for(let i=d;i<=c;i++){if(!r.isHeader(e,i)&&o)continue;let n=(0,j.Z)(r,e,i);if(n&&n.start.col<h){h=n.start.col,t=!0;break}}if(!t&&e===u)for(let i=d;i<=c;i++){if(!r.isHeader(e,i)&&o)continue;let n=(0,j.Z)(r,e,i);if(n&&Math.min(n.end.col,r.colCount-1)>u){u=n.end.col,t=!0;break}}if(t)break}if(!t)for(let e=d;e<=c;e++){if(e===d)for(let i=h;i<=u;i++){if(!r.isHeader(i,e)&&o)continue;let n=(0,j.Z)(r,i,e);if(n&&n.start.row<d){d=n.start.row,t=!0;break}}if(!t&&e===c)for(let i=h;i<=u;i++){if(!r.isHeader(i,e)&&o)continue;let n=(0,j.Z)(r,i,e);if(n&&Math.min(n.end.row,r.rowCount-1)>c){c=n.end.row,t=!0;break}}if(t)break}t&&p()};i&&(p(),e.start.col>e.end.col?(e.start.col=Math.max(h,u),e.end.col=Math.min(h,u)):(e.start.col=Math.min(h,u),e.end.col=Math.max(h,u)),e.start.row>e.end.row?(e.start.row=Math.max(d,c),e.end.row=Math.min(d,c)):(e.start.row=Math.min(d,c),e.end.row=Math.max(d,c))),t.selectingRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),null==(i=t.fillhandle)||i.delete()}),t.selectingRangeComponents=new Map;let{needRowHeader:g,needRightRowHeader:f,needColumnHeader:m,needBottomColumnHeader:y,needBody:v,needCornerHeader:b,needRightTopCornerHeader:_,needLeftBottomCornerHeader:C,needRightBottomCornerHeader:x}=(0,e2.L)(h,d,u,c,r);if(b){let e=Math.min(u,r.frozenColCount-1),i=Math.min(c,r.frozenRowCount-1);t.createCellSelectBorder(h,d,e,i,"cornerHeader",`${h}${d}${u}${c}`,[!0,!m,!g,!0])}if(_){let e=Math.max(h,r.colCount-r.rightFrozenColCount),i=Math.min(c,r.frozenRowCount-1);t.createCellSelectBorder(e,d,u,i,"rightTopCorner",`${h}${d}${u}${c}`,[!0,!0,!f,!m])}if(C){let e=Math.min(u,r.frozenColCount-1),i=Math.max(d,r.rowCount-r.bottomFrozenRowCount);t.createCellSelectBorder(h,i,e,c,"leftBottomCorner",`${h}${d}${u}${c}`,[!g,!y,!0,!0])}if(x){let e=Math.max(h,r.colCount-r.rightFrozenColCount),i=Math.max(d,r.rowCount-r.bottomFrozenRowCount);t.createCellSelectBorder(e,i,u,c,"rightBottomCorner",`${h}${d}${u}${c}`,[!f,!0,!0,!y])}if(m){let e=Math.max(h,r.frozenColCount),i=Math.min(u,r.colCount-r.rightFrozenColCount-1),n=Math.min(c,r.frozenRowCount-1);t.createCellSelectBorder(e,d,i,n,"columnHeader",`${h}${d}${u}${c}`,[!0,!_,!v,!b])}if(y){let e=Math.max(h,r.frozenColCount),i=Math.min(u,r.colCount-r.rightFrozenColCount-1),n=Math.max(d,r.rowCount-r.bottomFrozenRowCount);t.createCellSelectBorder(e,n,i,c,"bottomFrozen",`${h}${d}${u}${c}`,[!v,!x,!0,!C])}if(g){let e=Math.max(d,r.frozenRowCount),i=Math.min(c,r.rowCount-r.bottomFrozenRowCount-1),n=Math.min(u,r.frozenColCount-1);t.createCellSelectBorder(h,e,n,i,"rowHeader",`${h}${d}${u}${c}`,[!b,!v,!C,!0])}if(f){let e=Math.max(d,r.frozenRowCount),i=Math.min(c,r.rowCount-r.bottomFrozenRowCount-1),n=Math.max(h,r.colCount-r.rightFrozenColCount);t.createCellSelectBorder(n,e,u,i,"rightFrozen",`${h}${d}${u}${c}`,[!_,!0,!x,!v])}if(v){let e=Math.max(h,r.frozenColCount),i=Math.max(d,r.frozenRowCount),n=Math.min(u,r.colCount-r.rightFrozenColCount-1),l=Math.min(c,r.rowCount-r.bottomFrozenRowCount-1);t.createCellSelectBorder(e,i,n,l,"body",`${h}${d}${u}${c}`,[!m,!f,!y,!g])}}function e6(t){t.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)}),t.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)})}function e7(t){t.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)}),t.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)})}function e8(t,e,i,r,n,l,s){if(!e)return;let a=Array.isArray(e)?e:[e,e,e,e],o=s.colCount-1,h=s.rowCount-1,d=[0,0,0,0],u=!1;return 0===i&&0===r?(d[0]=a[0],u=!0):n===o&&l===h?(d[2]=a[2],u=!0):0===i&&l===h?(d[3]=a[3],u=!0):n===o&&0===r&&(d[1]=a[1],u=!0),u?d:void 0}function e9(t){t.selectingRangeComponents.forEach((e,i)=>{var r;t.selectedRangeComponents.get(i)&&(t.selectingRangeComponents.get(i).rect.delete(),null==(r=t.selectingRangeComponents.get(i).fillhandle)||r.delete()),t.selectedRangeComponents.set(i,e)}),t.selectingRangeComponents=new Map,t.updateNextFrame()}function it(t){t.selectedRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),null==(i=t.fillhandle)||i.delete()}),t.selectedRangeComponents=new Map}function ie(t){t.selectingRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),null==(i=t.fillhandle)||i.delete()}),t.selectingRangeComponents=new Map}function ii(t,e){for(let i=0;i<e.table.colCount;i++){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(i),height:e.table.getRowHeight(t)});if(r.role="cell",r.col=i,r.row=t,r.needUpdate=!0,!r)continue;let n=e.getColGroup(i);if(n)if(n.firstChild&&t<n.firstChild.row)n.insertBefore(r,n.firstChild),n.firstChild.row=n.firstChild.row+1;else if(n.lastChild&&t>n.lastChild.row)n.appendChild(r);else{let l=e.highPerformanceGetCell(i,t,!0);l!==r&&(n.insertBefore(r,l),l&&(l.row=l.row+1),l!==n.lastChild&&n.lastChild&&(n.lastChild.row=n.lastChild.row+1))}}}function ir(t,e){for(let i=0;i<e.table.colCount;i++){let r,n=e.getColGroup(i,!1);n&&(n.forEachChildren(e=>e.row===t&&(r=e,!0)),r&&(n.updateColumnHeight(-r.attribute.height),n.removeChild(r)))}}function il(t,e,i){let r;for(let n=0;n<i.table.colCount;n++){let l,s=i.table.getCellRange(n,t);s.start.row<=t+1&&s.end.row>=t+1&&(ia(s,i),l=s.start.row);let a=i.table.getCellRange(n,e);a.start.row<=e+1&&a.end.row>=e+1&&(ia(a,i),l=a.start.row),(0,y.Z)(l)&&(r=(0,y.Z)(r)?Math.min(r,l):l)}return r}function is(t,e,i){let r;for(let n=0;n<i.table.colCount;n++){let l,s=i.highPerformanceGetCell(n,t);s.mergeStartRow&&s.mergeEndRow&&s.mergeEndRow>t&&(ia({start:{row:s.mergeStartRow,col:i.table.isAutoRowHeight(e)?0:s.mergeStartCol},end:{row:s.mergeEndRow,col:i.table.isAutoRowHeight(e)?i.table.colCount-1:s.mergeEndCol}},i),l=s.mergeStartRow);let a=i.highPerformanceGetCell(n,e);a.mergeStartRow&&a.mergeEndRow&&a.mergeStartRow<e&&(ia({start:{row:a.mergeStartRow,col:i.table.isAutoRowHeight(e)?0:a.mergeStartCol},end:{row:a.mergeEndRow,col:i.table.isAutoRowHeight(e)?i.table.colCount-1:a.mergeEndCol}},i),l=a.mergeStartRow),(0,y.Z)(l)&&(r=(0,y.Z)(r)?Math.min(r,l):l)}return r}function ia(t,e){let{start:i,end:r}=t;for(let t=i.col;t<=r.col;t++)for(let n=i.row;n<=r.row;n++){let i=e.highPerformanceGetCell(t,n,!0);i&&(i.needUpdate=!0)}}var io=i(53430);function ih(t){if(!t.table.reactCustomLayout)return;let{table:e,stage:i}=t,r=i.pluginService.findPluginsByName("ReactAttributePlugin")[0],{htmlMap:n,renderId:l}=r;for(let s in n){let a,o=n[s],{graphic:h,wrapContainer:d,renderId:u}=o;if(u===l){if(t.frozenColCount>e.frozenColCount){let i=(0,io.J$)(h);if(!i)continue;let{col:r,row:n}=i;n>=e.rowCount-e.bottomFrozenRowCount&&r<t.frozenColCount&&r>=e.frozenColCount&&h.attribute.react.container===e.frozenBottomDomContainer?a=e.bottomDomContainer:n>=e.frozenRowCount&&r<t.frozenColCount&&r>=e.frozenColCount&&h.attribute.react.container===e.frozenBodyDomContainer?a=e.bodyDomContainer:n<e.frozenRowCount&&r<t.frozenColCount&&r>=e.frozenColCount&&h.attribute.react.container===e.frozenHeaderDomContainer&&(a=e.headerDomContainer)}else if(t.frozenColCount<e.frozenColCount){let i=(0,io.J$)(h);if(!i)continue;let{col:r,row:n}=i;n>=e.rowCount-e.bottomFrozenRowCount&&r<e.frozenColCount&&r>=t.frozenColCount&&h.attribute.react.container===e.bottomDomContainer?a=e.frozenBottomDomContainer:n>=e.frozenRowCount&&r<e.frozenColCount&&r>=t.frozenColCount&&h.attribute.react.container===e.bodyDomContainer?a=e.frozenBodyDomContainer:n<e.frozenRowCount&&r<e.frozenColCount&&r>=t.frozenColCount&&h.attribute.react.container===e.headerDomContainer&&(a=e.frozenHeaderDomContainer)}a&&(a.appendChild(d),o.nativeContainer=a,o.container=a,h.attribute.react.container=a,r.updateStyleOfWrapContainer(h,i,d,a,h.attribute.react))}}}function id(t){let e=t.bodyGroup.firstChild instanceof tf.Z?t.bodyGroup.firstChild:null;e&&(t.rowHeaderGroup.appendChild(e),t.rowHeaderGroup.setAttribute("width",t.rowHeaderGroup.attribute.width+e.attribute.width),t.bodyGroup.setAttribute("width",t.bodyGroup.attribute.width-e.attribute.width))}function iu(t){let e=t.colHeaderGroup.firstChild instanceof tf.Z?t.colHeaderGroup.firstChild:null;e&&(t.cornerHeaderGroup.appendChild(e),t.cornerHeaderGroup.setAttribute("width",t.cornerHeaderGroup.attribute.width+e.attribute.width),t.colHeaderGroup.setAttribute("width",t.colHeaderGroup.attribute.width-e.attribute.width))}function ic(t){var e;let i=t.rowHeaderGroup.lastChild instanceof tf.Z?t.rowHeaderGroup.lastChild:null==(e=t.rowHeaderGroup.lastChild)?void 0:e._prev;i&&(iy(t.bodyGroup,i,t.bodyGroup.firstChild),t.bodyGroup.setAttribute("width",t.bodyGroup.attribute.width+i.attribute.width),t.rowHeaderGroup.setAttribute("width",t.rowHeaderGroup.attribute.width-i.attribute.width))}function ip(t){var e;let i=t.cornerHeaderGroup.lastChild instanceof tf.Z?t.cornerHeaderGroup.lastChild:null==(e=t.cornerHeaderGroup.lastChild)?void 0:e._prev;i&&(iy(t.colHeaderGroup,i,t.colHeaderGroup.firstChild),t.colHeaderGroup.setAttribute("width",t.colHeaderGroup.attribute.width+i.attribute.width),t.cornerHeaderGroup.setAttribute("width",t.cornerHeaderGroup.attribute.width-i.attribute.width))}function ig(t){let e=t.bottomFrozenGroup.firstChild instanceof tf.Z?t.bottomFrozenGroup.firstChild:null;e&&(t.leftBottomCornerGroup.appendChild(e),t.leftBottomCornerGroup.setAttribute("width",t.leftBottomCornerGroup.attribute.width+e.attribute.width),t.bottomFrozenGroup.setAttribute("width",t.bottomFrozenGroup.attribute.width-e.attribute.width),t.table.isPivotChart()&&e.forEachChildren(t=>{t.setAttributes({stroke:!1,fill:!1})}))}function im(t){var e;let i=t.leftBottomCornerGroup.lastChild instanceof tf.Z?t.leftBottomCornerGroup.lastChild:null==(e=t.leftBottomCornerGroup.lastChild)?void 0:e._prev;i&&(iy(t.bottomFrozenGroup,i,t.bottomFrozenGroup.firstChild),t.bottomFrozenGroup.setAttribute("width",t.bottomFrozenGroup.attribute.width+i.attribute.width),t.leftBottomCornerGroup.setAttribute("width",t.leftBottomCornerGroup.attribute.width-i.attribute.width),t.table.isPivotChart()&&i.forEachChildren(e=>{var i,r,n,l;let s=t.table._getCellStyle(e.col,e.row),a=t.table.getCellRange(e.col,e.row),o=(0,V.RT)(s,t.table,a?a.start.col:e.col,a?a.start.row:e.row,Y.WJ).theme;e.setAttributes({fill:null!=(r=null==(i=null==o?void 0:o.group)?void 0:i.fill)?r:void 0,stroke:null!=(l=null==(n=null==o?void 0:o.group)?void 0:n.stroke)?l:void 0})}))}function iy(t,e,i){e&&t&&(i?t.insertBefore(e,i):t.appendChild(e))}function iv(t){return t instanceof tf.Z&&"table-border-rect"!==(null==t?void 0:t.name)}var ib=i(14305);function i_(t,e,i){return new tf.Z({x:0,y:0,width:t,height:e,clip:null!=i&&i,pickable:!1})}function iC(t,e){return t.forEachChildrenSkipChild((t,i)=>{t.setAttribute("x",e),e+=t.attribute.width}),e}function ix(t,e){return t.forEachChildrenSkipChild((t,i)=>{t.setAttribute("y",e),e+=t.attribute.height}),e}var iw=i(84306);function iS(t,e,i,r,n){let l=t.name;iM(i,r,t=>t.name===l,t=>{(0,Q.Bg)(e,t),t.name=e.name},n),n.updateNextFrame()}function iA(t,e,i){t&&"empty"!==t.role&&t.forEachChildren(t=>{"group"===t.type?iA(t,e,i):e(t)&&i(t)})}function iM(t,e,i,r,n){let l=n.getCell(t,e);if("cell"===l.role&&(0,y.Z)(l.mergeStartCol)&&(0,y.Z)(l.mergeStartRow)&&(0,y.Z)(l.mergeEndCol)&&(0,y.Z)(l.mergeEndRow)){let{colStart:t,colEnd:e,rowStart:s,rowEnd:a}=(0,ti.e)(l,n);for(let l=t;l<=e;l++)for(let t=s;t<=a;t++)iA(n.highPerformanceGetCell(l,t),i,r)}else iA(l,i,r)}function iT(t,e){let{bgColor:i,borderColor:r,borderLineWidth:n,borderLineDash:l}=e,s={x:0,y:0,width:0,height:0,visible:!1,pickable:!0,fill:i};return s.stroke=tP(r,void 0),s.lineWidth=n,l&&(s.lineDash=l),s.lineCap="butt",Array.isArray(r)&&(s.strokeArrayColor=(0,J.u)(r)),Array.isArray(n)&&(s.strokeArrayWidth=(0,J.u)(n),s.lineWidth=1),t.setAttributes(s),t.role="corner-frozen",t}function ik(t){let e=[];for(let i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}function iR(t){let e=t.bodyColStart;function i(i){i.col=e;let r=(0,j.Z)(t.table,i.col,i.row);r&&(i.mergeStartCol=r.start.col,i.mergeStartCol=r.start.col,i.mergeEndCol=r.end.col,i.mergeEndCol=r.end.col),i.role}t.bodyGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{i(t)}),e++}),e=t.bodyColStart,t.colHeaderGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{i(t)}),e++}),e=t.bodyColStart,t.bottomFrozenGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{i(t)}),e++})}function iP(t,e){if(e.colHeaderGroup&&e.table.columnHeaderLevelCount>0){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(t),height:0,clip:!1,pickable:!1});r.role="column",r.col=t;let n=e.getColGroup(t,!0);n?e.colHeaderGroup.insertBefore(r,n):e.colHeaderGroup.appendChild(r),i(r,t,0,e.table.columnHeaderLevelCount-1)}if(e.bodyGroup){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(t),height:0,clip:!1,pickable:!1});r.role="column",r.col=t;let n=e.getColGroup(t,!1);n?e.bodyGroup.insertBefore(r,n):e.bodyGroup.appendChild(r),i(r,t,e.bodyRowStart,e.bodyRowEnd)}if(e.bottomFrozenGroup&&e.table.bottomFrozenRowCount>0){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(t),height:0,clip:!1,pickable:!1});r.role="column",r.col=t;let n=e.getColGroupInBottom(t);n?e.bottomFrozenGroup.insertBefore(r,n):e.bottomFrozenGroup.appendChild(r),i(r,t,e.table.rowCount-e.table.bottomFrozenRowCount,e.table.rowCount-1)}function i(t,i,r,n){for(let l=r;l<=n;l++){let r=new tf.Z({x:0,y:0,width:e.table.getColWidth(i),height:e.table.getRowHeight(l)});r.role="cell",r.col=i,r.row=l,r.needUpdate=!0,t.appendChild(r)}}}var iB=i(50542);(0,D.sTO)(),z.n.load(eC),z.n.load(ev.ZP);class iI{constructor(t){let e,i;this._needUpdateContainer=!1,this.table=t,this.hasFrozen=!1,this.clear=!0,this.mergeMap=new Map,(0,iw.C)(this.table.theme.textPopTipStyle),"node"===T.X.mode?(W.rF.setEnv("node",t.options.modeParams),e=t.canvasWidth,i=t.canvasHeight):t.options.canvas&&t.options.viewBox?(W.rF.setEnv("browser"),e=t.options.viewBox.x2-t.options.viewBox.x1,i=t.options.viewBox.y2-t.options.viewBox.y1):(W.rF.setEnv("browser"),e=t.canvas.width,i=t.canvas.height),this.stage=(0,Z.H)(Object.assign({canvas:t.canvas,width:e,height:i,disableDirtyBounds:!1,background:t.theme.underlayBackgroundColor,dpr:t.internalProps.pixelRatio,enableLayout:!0,beforeRender:t=>{this.table.options.beforeRender&&this.table.options.beforeRender(t),this.table.animationManager.ticker.start()},afterRender:t=>{this.table.options.afterRender&&this.table.options.afterRender(t),this.table.fireListeners("after_render",null)},canvasControled:!t.options.canvas,viewBox:t.options.viewBox},t.options.renderOption)),this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph(),this.stage.defaultLayer.add(this.tableGroup),this.stage.table=this.table,this.createComponent()}get width(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.width)?e:0}get height(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.height)?e:0}get x(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.x)?e:0}get y(){var t,e;return null!=(e=null==(t=this.tableGroup.attribute)?void 0:t.y)?e:0}get bodyRowStart(){var t;return null!=(t=this.proxy.rowStart)?t:0}get bodyRowEnd(){var t;return null!=(t=this.proxy.rowEnd)?t:this.table.rowCount-1}get bodyColStart(){var t;return null!=(t=this.proxy.colStart)?t:0}get bodyColEnd(){var t;return null!=(t=this.proxy.colEnd)?t:this.table.colCount-1}initSceneGraph(){this.isPivot=this.table.isPivotTable(),function(t){let e=t.table.tableNoFrameWidth,i=t.table.tableNoFrameHeight;t.tableGroup=new tf.Z({x:0,y:0,width:e,height:i,clip:!0,pickable:!1}),t.tableGroup.role="table";let r=i_(0,0,!t.table.internalProps.enableTreeStickCell);r.role="col-header",t.colHeaderGroup=r;let n=i_(0,0,!t.table.options.enableTreeStickCell);n.role="corner-header",t.cornerHeaderGroup=n;let l=i_(0,0,!0);l.role="row-header",t.rowHeaderGroup=l;let s=i_(e,0,!0);s.role="body",t.bodyGroup=s;let a=i_(0,0,!0);a.role="right-frozen",t.rightFrozenGroup=a;let o=i_(0,0,!0);o.role="bottom-frozen",t.bottomFrozenGroup=o;let h=i_(0,0);h.role="component",t.componentGroup=h;let d=i_(0,0,!0);d.role="corner-right-top-header",t.rightTopCornerGroup=d;let u=i_(0,0,!0);u.role="corner-right-bottom-header",t.rightBottomCornerGroup=u;let c=i_(0,0,!0);c.role="corner-left-bottom-header",t.leftBottomCornerGroup=c,t.tableGroup.addChild(s),t.tableGroup.addChild(l),t.tableGroup.addChild(o),t.tableGroup.addChild(r),t.tableGroup.addChild(a),t.tableGroup.addChild(u),t.tableGroup.addChild(d),t.tableGroup.addChild(c),t.tableGroup.addChild(n),t.tableGroup.addChild(h)}(this)}canvasShowMenu(){this.stage.addEventListener("rightdown",t=>{let e=(0,io.RJ)(t);e.eventArgs||(this.table.stateManager.triggerContextMenu(-1,-1,e.abstractPos.x,e.abstractPos.y),this.table.fireListeners(I.B.CONTEXTMENU_CANVAS,{event:t,x:e.abstractPos.x,y:e.abstractPos.y,col:-1,row:-1,target:void 0}))})}clearCells(){var t,e;this.table.animationManager.clear(),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.findPluginsByName("poptipForText").forEach(t=>{t.deactivate(this.stage.pluginService)}),this.clear=!0,this.hasFrozen=!1,this.mergeMap.clear(),this.colHeaderGroup.clear(),delete this.colHeaderGroup.border,this.rowHeaderGroup.clear(),delete this.rowHeaderGroup.border,this.cornerHeaderGroup.clear(),delete this.cornerHeaderGroup.border,this.bodyGroup.clear(),delete this.bodyGroup.border,this.bottomFrozenGroup.clear(),delete this.bottomFrozenGroup.border,this.rightFrozenGroup.clear(),delete this.rightFrozenGroup.border,this.rightTopCornerGroup.clear(),delete this.rightTopCornerGroup.border,this.rightBottomCornerGroup.clear(),delete this.rightBottomCornerGroup.border,this.leftBottomCornerGroup.clear(),delete this.leftBottomCornerGroup.border,this.colHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rowHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.cornerHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bodyGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bottomFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightTopCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.leftBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.rightBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:0,height:0}),this.tableGroup.border&&(this.tableGroup.parent.removeChild(this.tableGroup.border),delete this.tableGroup.border),null==(t=this.proxy)||t.release(),null==(e=this.table.reactCustomLayout)||e.clearCache()}updateStageBackground(){this.stage.background=this.table.theme.underlayBackgroundColor,this.stage.renderNextFrame()}createComponent(){this.component=new tM(this.table),this.component.addToGroup(this.componentGroup),this.selectedRangeComponents=new Map,this.selectingRangeComponents=new Map,this.customSelectedRangeComponents=new Map}updateComponent(){this.component.updateStyle()}createSceneGraph(t=!1){t||(this.table.rowHeightsMap.clear(),this.table.internalProps.layoutMap.clearCellRangeMap()),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.autoEnablePlugins.getContributions().forEach(t=>{"poptipForText"===t.name&&this.stage.pluginService.register(t)}),this.clear=!1,this.frozenColCount=this.table.frozenColCount,this.frozenRowCount=this.table.frozenRowCount,this.proxy=new e1(this.table),tk(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0,!0),this.table.isPivotChart()&&(iT(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle||this.table.theme.cornerHeaderStyle||{}),iT(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle||this.table.theme.cornerHeaderStyle||{}),iT(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle||this.table.theme.cornerHeaderStyle||{})),this.proxy.createGroupForFirstScreen(this.cornerHeaderGroup,this.colHeaderGroup,this.rowHeaderGroup,this.rightFrozenGroup,this.bottomFrozenGroup,this.bodyGroup,0,0),this.afterScenegraphCreated()}renderSceneGraph(){this.stage.render()}getCell(t,e,i){var r,n,l,s,a,o;let h;if((h=this.table.rightFrozenColCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e<this.table.frozenRowCount?null==(r=this.rightTopCornerGroup.getColGroup(t))?void 0:r.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<this.table.frozenColCount?null==(n=this.leftBottomCornerGroup.getColGroup(t))?void 0:n.getRowGroup(e):this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e>=this.table.rowCount-this.table.bottomFrozenRowCount?null==(l=this.rightBottomCornerGroup.getColGroup(t))?void 0:l.getRowGroup(e):this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?null==(s=this.rightFrozenGroup.getColGroup(t))?void 0:s.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>this.table.rowCount-1-this.table.bottomFrozenRowCount?null==(a=this.bottomFrozenGroup.getColGroup(t))?void 0:a.getRowGroup(e):null==(o=this.getColGroup(t,e<this.frozenRowCount))?void 0:o.getRowGroup(e))&&"shadow-cell"===h.role&&!i){let i=this.table.getCellRange(t,e);i.start.col===t&&i.start.row===e||(h=this.getCell(i.start.col,i.start.row))}return h||ew}highPerformanceGetCell(t,e,i){return this.proxy.highPerformanceGetCell(t,e,i)}getColGroup(t,e=!1){return(t<this.frozenColCount&&e?this.cornerHeaderGroup.getColGroup(t):t<this.frozenColCount?this.rowHeaderGroup.getColGroup(t):e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightTopCornerGroup.getColGroup(t):!e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightFrozenGroup.getColGroup(t):e?this.colHeaderGroup.getColGroup(t):this.bodyGroup.getColGroup(t))||void 0}getColGroupInBottom(t,e=!1){var i;if(e){let e=null!=(i=this.getColGroupInLeftBottomCorner(t))?i:this.getColGroupInRightBottomCorner(t);if(e)return e}if(this.table.bottomFrozenRowCount>0)return this.bottomFrozenGroup.getColGroup(t)}getColGroupInLeftBottomCorner(t){if(this.table.bottomFrozenRowCount>0)return this.leftBottomCornerGroup.getColGroup(t)}getColGroupInRightTopCorner(t){if(this.table.rightFrozenColCount>0)return this.rightTopCornerGroup.getColGroup(t)}getColGroupInRightBottomCorner(t){if(this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0)return this.rightBottomCornerGroup.getColGroup(t)}getCellSize(t,e){let i=this.getCell(t,e),r=(0,j.Z)(this.table,t,e),n=i.attribute.width,l=i.attribute.height;return r&&(n/=r.end.col-r.start.col+1,l/=r.end.row-r.start.row+1),{width:n,height:l}}updateNextFrame(){this.updateContainerSync(),this.resetAllSelectComponent(),this.stage.renderNextFrame()}resetAllSelectComponent(){var t,e,i,r;((null==(e=null==(t=this.table.stateManager.select)?void 0:t.ranges)?void 0:e.length)>0||(null==(r=null==(i=this.table.stateManager.select)?void 0:i.customSelectRanges)?void 0:r.length)>0)&&e3(this)}hideHoverIcon(t,e){-1!==t&&-1!==e&&(iM(t,e,t=>"mouseenter_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",0);let e=t.parent.getChildByName("icon-back");e&&e.setAttribute("visible",!1)},this),this.updateNextFrame())}showHoverIcon(t,e){-1!==t&&-1!==e&&(iM(t,e,t=>"mouseenter_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",1)},this),this.updateNextFrame())}hideClickIcon(t,e){-1!==t&&-1!==e&&(iM(t,e,t=>"click_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",0)},this),this.updateNextFrame())}showClickIcon(t,e){-1!==t&&-1!==e&&(iM(t,e,t=>"click_cell"===t.attribute.visibleTime,t=>{t.setAttribute("opacity",1)},this),this.updateNextFrame())}getIcon(t,e,i,r){let n;return this.getCell(t,e).forEachChildren(t=>{t.role&&t.role.startsWith("icon")&&t.containsPoint(i,r,tU.LZ.GLOBAL)&&(n=t)}),n}setIconHoverStyle(t,e,i,r){!function(t,e,i,r,n){var l,s;if((t.attribute.backgroundColor||t.attribute.hoverImage)&&iM(e,i,e=>e.name===t.name,t=>{var e,i,r,n,l,s,a,o;if(t.attribute.backgroundColor){let h=t.parent.getChildByName("icon-back");h?h.setAttributes({x:(null!=(e=t.attribute.x)?e:0)+(t.AABBBounds.width()-t.backgroundWidth)/2,y:(null!=(i=t.attribute.y)?i:0)+(t.AABBBounds.height()-t.backgroundHeight)/2,dx:null!=(r=t.attribute.dx)?r:0,dy:null!=(n=t.attribute.dy)?n:0,width:t.backgroundWidth,height:t.backgroundHeight,fill:t.attribute.backgroundColor,cornerRadius:5,visible:!0}):(h=(0,tc.f)({x:(null!=(l=t.attribute.x)?l:0)+(t.AABBBounds.width()-t.backgroundWidth)/2,y:(null!=(s=t.attribute.y)?s:0)+(t.AABBBounds.height()-t.backgroundHeight)/2,dx:null!=(a=t.attribute.dx)?a:0,dy:null!=(o=t.attribute.dy)?o:0,width:t.backgroundWidth,height:t.backgroundHeight,fill:t.attribute.backgroundColor,cornerRadius:5,pickable:!1,visible:!0})).name="icon-back",t.parent.insertBefore(h,t)}t.attribute.hoverImage&&t.attribute.image!==t.attribute.hoverImage&&(t.image=t.attribute.hoverImage)},n),t.tooltip){let{x1:r,x2:a,y1:o,y2:h}=t.globalAABBBounds,d={content:t.tooltip.title,referencePosition:{rect:{left:r,right:a,top:o,bottom:h,width:t.globalAABBBounds.width(),height:t.globalAABBBounds.height()},placement:t.tooltip.placement},disappearDelay:t.tooltip.disappearDelay,style:Object.assign({},null==(l=n.table.internalProps.theme)?void 0:l.tooltipStyle,null==(s=t.tooltip)?void 0:s.style)};n.table.internalProps.tooltipHandler.isBinded(d)||n.table.showTooltip(e,i,d)}}(t,e,i,0,this)}updateSortIcon(t){let{col:e,row:i,iconMark:r,order:n,oldSortCol:l,oldSortRow:s,oldIconMark:a}=t;!function(t){let{col:e,row:i,iconMark:r,order:n,oldSortCol:l,oldSortRow:s,oldIconMark:a,scene:o}=t,h=o.table.internalProps.headerHelper.getSortIcon(n,o.table,e,i);if(r&&iS(r,h,e,i,o),!function(t,e,i,r,n){let l=n.getCellRange(t,e),s=n.getCellRange(i,r);return l.start.col===s.start.col&&l.start.row===s.start.row&&l.end.col===s.end.col&&l.end.row===s.end.row}(e,i,l,s,o.table)){let t=o.table.internalProps.headerHelper.getSortIcon("normal",o.table,l,s);a?iS(a,t,l,s,o):function(t,e,i,r){let n=r.getCell(t,e);if((0,y.Z)(n.mergeStartCol)&&(0,y.Z)(n.mergeStartRow)&&(0,y.Z)(n.mergeEndCol)&&(0,y.Z)(n.mergeEndRow))for(let t=n.mergeStartCol;t<=n.mergeEndCol;t++)for(let e=n.mergeStartRow;e<=n.mergeEndRow;e++){let n;r.getCell(t,e).forEachChildren(t=>"sort"===t.attribute.funcType&&(n=t,!0)),n&&((0,Q.Bg)(i,n),n.name=i.name)}else{let t;(0,O.yW)(n,"children",e=>"sort"===e.attribute.funcType&&(t=e,!0)),t&&((0,Q.Bg)(i,t),t.name=i.name)}}(l,s,t,o)}}({col:e,row:i,iconMark:r,order:n,oldSortCol:l,oldSortRow:s,oldIconMark:a,scene:this})}updateFrozenIcon(t,e){var i=this;for(let t=0;t<i.table.colCount;t++)for(let e=0;e<i.table.columnHeaderLevelCount;e++)iM(t,e,t=>"frozen"===t.attribute.funcType,r=>{let n=i.table.internalProps.headerHelper.getFrozenIcon(t,e);(0,Q.Bg)(n,r),r.name=n.name},i)}updateHierarchyIcon(t,e){let i;i=this.table.isHeader(t,e)?this.table.internalProps.headerHelper.getHierarchyIcon(t,e):this.table.internalProps.bodyHelper.getHierarchyIcon(t,e),iM(t,e,t=>t.attribute.funcType===N.cI.collapse||t.attribute.funcType===N.cI.expand,t=>{(0,Q.Bg)(i,t),t.name=null==i?void 0:i.name},this)}setIconNormalStyle(t,e,i){(t.attribute.backgroundColor||t.attribute.hoverImage)&&iM(e,i,e=>e.name===t.name,t=>{let e=t.parent.getChildByName("icon-back");e&&e.setAttribute("visible",!1),t.attribute.hoverImage&&t.attribute.image!==t.attribute.originImage&&(t.image=t.attribute.originImage)},this)}residentHoverIcon(t,e){iM(t,e,t=>t.attribute.funcType===N.cI.dropDown,t=>{t.oldVisibleTime=t.attribute.visibleTime,t.setAttribute("visibleTime","always"),t.setAttribute("opacity",1)},this)}resetResidentHoverIcon(t,e){iM(t,e,t=>t.attribute.funcType===N.cI.dropDown,t=>{t.oldVisibleTime&&t.setAttribute("visibleTime",t.oldVisibleTime),t.setAttribute("opacity",+("always"===t.attribute.visibleTime))},this)}deactivateChart(t,e,i=!1){var r,n,l,s,a,o,h,d,u;if(-1===t||-1===e){if(i){let t=(0,iB._f)(),e=(0,iB.AU)();if(t&&e){let e=this.getCell(t.col,t.row);(null==(r=null==e?void 0:e.firstChild)?void 0:r.deactivate)&&((0,iB.rd)(),null==(l=null==(n=null==e?void 0:e.firstChild)?void 0:n.deactivate)||l.call(n,this.table,{forceRelease:!0,releaseChartInstance:!0,releaseColumnChartInstance:!0,releaseRowChartInstance:!0,releaseAllChartInstance:!0}))}}return}let c=this.getCell(t,e);if(null==(s=null==c?void 0:c.firstChild)?void 0:s.deactivate){if(i)return(0,iB.rd)(),void(null==(o=null==(a=null==c?void 0:c.firstChild)?void 0:a.deactivate)||o.call(a,this.table,{forceRelease:!0,releaseChartInstance:!0,releaseColumnChartInstance:!0,releaseRowChartInstance:!0,releaseAllChartInstance:!0}));let r=(null==c?void 0:c.firstChild).attribute.spec.type;null==(d=null==(h=null==c?void 0:c.firstChild)?void 0:h.deactivate)||d.call(h,this.table,(null==(u=this.table.options.chartDimensionLinkage)?void 0:u.showTooltip)?{releaseChartInstance:"pie"!==r&&("scatter"===r?t!==this.table.stateManager.hover.cellPos.col&&e!==this.table.stateManager.hover.cellPos.row||this.table.stateManager.hover.cellPos.row<this.table.frozenRowCount||this.table.stateManager.hover.cellPos.row>this.table.rowCount-1-this.table.bottomFrozenRowCount||this.table.stateManager.hover.cellPos.col<this.table.frozenColCount||this.table.stateManager.hover.cellPos.col>this.table.colCount-1-this.table.rightFrozenColCount:this.table.options.indicatorsAsCol?e!==this.table.stateManager.hover.cellPos.row||this.table.stateManager.hover.cellPos.col<this.table.frozenColCount||this.table.stateManager.hover.cellPos.col>this.table.colCount-1-this.table.rightFrozenColCount:t!==this.table.stateManager.hover.cellPos.col||this.table.stateManager.hover.cellPos.row<this.table.frozenRowCount||this.table.stateManager.hover.cellPos.row>this.table.rowCount-1-this.table.bottomFrozenRowCount),releaseColumnChartInstance:"pie"!==r&&(t!==this.table.stateManager.hover.cellPos.col||this.table.stateManager.hover.cellPos.row<this.table.frozenRowCount||this.table.stateManager.hover.cellPos.row>this.table.rowCount-1-this.table.bottomFrozenRowCount),releaseRowChartInstance:"pie"!==r&&(e!==this.table.stateManager.hover.cellPos.row||this.table.stateManager.hover.cellPos.col<this.table.frozenColCount||this.table.stateManager.hover.cellPos.col>this.table.colCount-1-this.table.rightFrozenColCount)}:void 0)}}activateChart(t,e){var i,r,n;if(-1===t||-1===e)return;let l=this.getCell(t,e);return null==(r=null==(i=null==l?void 0:l.firstChild)?void 0:i.activate)||r.call(i,this.table),null==(n=null==l?void 0:l.firstChild)?void 0:n.activeChartInstance}removeInteractionBorder(t,e){let i=this.getCell(t,e);i.setAttribute("highlightStroke",void 0),i.setAttribute("highlightStrokeArrayWidth",void 0),i.setAttribute("highlightStrokeArrayColor",void 0)}createCellSelectBorder(t,e,i,r,n,l,s){!function(t,e,i,r,n,l,s,a){var o,h,d,u,c,p,g,f,m;let y,v=!!(null==(o=t.table.options.excelOptions)?void 0:o.fillHandle);if((null==(h=t.table.stateManager.select.ranges)?void 0:h.length)>1)v=!1,t.removeFillHandleFromSelectComponents();else if(1===(null==(d=t.table.stateManager.select.ranges)?void 0:d.length)){let e=Math.max(t.table.stateManager.select.ranges[0].start.row,t.table.stateManager.select.ranges[0].end.row),i=Math.max(t.table.stateManager.select.ranges[0].start.col,t.table.stateManager.select.ranges[0].end.col);t.table.isHeader(i,e)&&(v=!1)}Array.isArray(a)&&(!1===a[1]||!1===a[2])&&(v=!1);let b=Math.min(e,r),_=Math.min(i,n),C=Math.max(e,r),x=Math.max(i,n),w=t.highPerformanceGetCell(b,_).globalAABBBounds,S=t.highPerformanceGetCell(C,x).globalAABBBounds,A=t.table.theme,M=null==(u=A.selectionStyle)?void 0:u.cellBorderColor,T=null==(c=A.selectionStyle)?void 0:c.cellBorderLineWidth,k=(0,tc.f)({pickable:!1,fill:"replace"!==(null==(p=A.selectionStyle)?void 0:p.selectionFillMode)&&(null!=(f=null==(g=A.selectionStyle)?void 0:g.cellBgColor)?f:"rgba(0, 0, 255,0.1)"),lineWidth:T,stroke:a.map(t=>!!t&&M),x:w.x1-t.tableGroup.attribute.x,y:w.y1-t.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:e8(l,null==(m=t.table.theme.frameStyle)?void 0:m.cornerRadius,e,i,r,n,t.table)});v&&(y=(0,tc.f)({pickable:!1,fill:M,stroke:M,x:S.x2-3,y:S.y2-3,width:6,height:6,visible:!0})),t.lastSelectId=s,t.selectingRangeComponents.set(`${b}-${_}-${C}-${x}-${s}`,{rect:k,fillhandle:y,role:l}),t.tableGroup.insertAfter(k,"body"===l?t.bodyGroup:"columnHeader"===l?t.colHeaderGroup:"rowHeader"===l?t.rowHeaderGroup:"cornerHeader"===l?t.cornerHeaderGroup:"rightTopCorner"===l?t.rightTopCornerGroup:"rightFrozen"===l?t.rightFrozenGroup:"leftBottomCorner"===l?t.leftBottomCornerGroup:"bottomFrozen"===l?t.bottomFrozenGroup:t.rightBottomCornerGroup),v&&t.tableGroup.insertAfter(y,"body"===l?t.bodyGroup:"columnHeader"===l?t.colHeaderGroup:"rowHeader"===l?t.rowHeaderGroup:"cornerHeader"===l?t.cornerHeaderGroup:"rightTopCorner"===l?t.rightTopCornerGroup:"rightFrozen"===l?t.rightFrozenGroup:"leftBottomCorner"===l?t.leftBottomCornerGroup:"bottomFrozen"===l?t.bottomFrozenGroup:t.rightBottomCornerGroup)}(this,t,e,i,r,n,l,s)}moveSelectingRangeComponentsToSelectedRangeComponents(){e9(this)}deleteLastSelectedRangeComponents(){var t;t=this,t.selectedRangeComponents.forEach((e,i)=>{var r;i.split("-")[4]===t.lastSelectId&&(e.rect.delete(),null==(r=e.fillhandle)||r.delete(),t.selectedRangeComponents.delete(i))})}deleteAllSelectBorder(){it(this),ie(this)}updateCellSelectBorder(t,e=!0){e4(this,t,e)}removeFillHandleFromSelectComponents(){this.selectedRangeComponents.forEach((t,e)=>{var i;null==(i=t.fillhandle)||i.delete(),t.fillhandle=void 0})}recreateAllSelectRangeComponents(){it(this),this.table.stateManager.select.ranges.forEach(t=>{e4(this,t),e9(this)})}updateColWidth(t,e,i,r){(function(t,e,i,r){r||t.table._setColWidth(e,t.table.getColWidth(e)+i,!0);let n=t.getColGroup(e,!0),l=t.getColGroupInRightTopCorner(e);n&&!l&&ta(n,i,"col-corner",t),l&&ta(l,i,"right-top",t);let s=t.getColGroup(e);s&&ta(s,i,"row-body",t);let a=t.getColGroupInLeftBottomCorner(e);a&&ta(a,i,"left-bottom",t);let o=t.getColGroupInBottom(e);o&&ta(o,i,"bottom",t);let h=t.getColGroupInRightBottomCorner(e);h&&ta(h,i,"right-bottom",t),e<t.frozenColCount?(t.cornerHeaderGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)}),t.rowHeaderGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)})):(t.colHeaderGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)}),t.bodyGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)})),a&&t.leftBottomCornerGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)}),o&&t.bottomFrozenGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)}),h&&t.rightBottomCornerGroup.forEachChildrenSkipChild((t,r)=>{t.col>e&&t.setAttribute("x",t.attribute.x+i)})})(this,t,Math.round(e),r),i||this.updateContainer({async:!0})}updateChartSizeForResizeColWidth(t){(0,ib.s9)(this,t)}updateChartSizeForResizeRowHeight(t){(0,ib.kl)(this,t)}updateChartState(t,e){var i,r;if(this.table.isPivotChart()){if(null==t||0===(null==t?void 0:t.length)||0===Object.keys(t).length){let t=(0,iB.AU)();t&&t.getChart().getComponentsByKey("brush")[0].clearBrushStateAndMask(),null==(r=null==(i=this.table.options.chartDimensionLinkage)?void 0:i.clearChartState)||r.call(i)}(0,ib.s8)(this,t,e)}}updateCheckboxCellState(t,e,i){var r,n;if(this.table.transpose)null==(r=this.bodyGroup.children)||r.forEach(t=>{var r;null==(r=t.getChildAt(e))||r.getChildren().forEach(t=>{"checkbox"===t.name&&("indeterminate"===i?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",i))),"checkbox-content"===t.name&&("indeterminate"===i?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})});else{let e=this.getColGroup(t);null==(n=null==e?void 0:e.children)||n.forEach(t=>{t.getChildren().find(t=>{"checkbox"===t.name&&("indeterminate"===i?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",i))),"checkbox-content"===t.name&&("indeterminate"===i?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}}updateHeaderCheckboxCellState(t,e,i){var r,n;this.table.transpose?null==(r=this.rowHeaderGroup.children)||r.forEach(t=>{t.getChildAt(e).getChildren().forEach(t=>{"checkbox"===t.name&&("indeterminate"===i?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",i))),"checkbox-content"===t.name&&("indeterminate"===i?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})}):null==(n=this.getColGroup(t,!0).children)||n.forEach(t=>{t.getChildren().find(t=>{"checkbox"===t.name&&("indeterminate"===i?(t.setAttribute("indeterminate",!0),t.setAttribute("checked",void 0)):(t.setAttribute("indeterminate",void 0),t.setAttribute("checked",i))),"checkbox-content"===t.name&&("indeterminate"===i?(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(t._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),t._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}updateAutoColWidth(t){this.table.internalProps._widthResizedColMap.delete(t);let e=this.table.getColWidth(t),i=(0,ex.al)(t,0,this.table.rowCount-1,this.table,!0);i!==e&&this.updateColWidth(t,i-e)}recalculateColWidths(){let t=this.table;"adaptive"===t.widthMode||t.autoFillWidth||t.internalProps.transpose?(0,ex.rj)(this.table,0,this.table.colCount-1,!0):(t._clearColRangeWidthsMap(),t.frozenColCount>0&&(0,ex.rj)(this.table,0,t.frozenColCount-1,!0),t.rightFrozenColCount>0&&(0,ex.rj)(this.table,t.rightFrozenColCount,t.colCount-1,!0),(0,ex.rj)(t,this.proxy.colStart,this.proxy.colEnd,!0))}recalculateRowHeights(){let t=this.table;t.internalProps.useOneRowHeightFillAll=!1,"adaptive"===t.heightMode||t.autoFillHeight?(0,te.Y)(this.table,0,this.table.rowCount-1,!0,!0):(t.frozenRowCount>0&&(0,te.Y)(this.table,0,t.frozenRowCount-1,!0,!0),t.bottomFrozenRowCount>0&&(0,te.Y)(this.table,t.bottomFrozenRowCount,t.rowCount-1,!0,!0),(0,te.Y)(t,this.proxy.rowStart,this.proxy.rowEnd,!0,!0))}resize(){var t,e;this.proxy.resize(),("adaptive"===this.table.widthMode||this.table.autoFillWidth)&&(0===this.table.internalProps._widthResizedColMap.size?this.recalculateColWidths():this.dealWidthMode()),"adaptive"===this.table.heightMode?0===this.table.internalProps._heightResizedRowMap.size?this.recalculateRowHeights():this.dealHeightMode():this.table.autoFillHeight&&this.dealHeightMode(),this.resetFrozen(),this.updateTableSize(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),("adaptive"===this.table.widthMode||"adaptive"===this.table.heightMode||this.table.autoFillWidth||this.table.autoFillHeight||(null==(t=this.table.containerFit)?void 0:t.width)||(null==(e=this.table.containerFit)?void 0:e.height))&&this.updateChartSizeForResizeColWidth(-1),this.proxy.progress(),this.updateNextFrame()}updateTableSize(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g;let f=Math.max(this.colHeaderGroup.attribute.width,this.bodyGroup.attribute.width,this.bottomFrozenGroup.attribute.width,0)+Math.max(this.cornerHeaderGroup.attribute.width,this.rowHeaderGroup.attribute.width,this.leftBottomCornerGroup.attribute.width,0)+Math.max(this.rightTopCornerGroup.attribute.width,this.rightFrozenGroup.attribute.width,this.rightBottomCornerGroup.attribute.width,0),m=Math.max(this.colHeaderGroup.attribute.height,this.cornerHeaderGroup.attribute.height,this.rightTopCornerGroup.attribute.height,0)+Math.max(this.rowHeaderGroup.attribute.height,this.bodyGroup.attribute.height,this.rightFrozenGroup.attribute.height,0)+Math.max(this.leftBottomCornerGroup.attribute.height,this.bottomFrozenGroup.attribute.height,this.rightBottomCornerGroup.attribute.height,0),y=f,v=m;if(y=(null==(t=this.table.containerFit)?void 0:t.width)?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,f),v=(null==(e=this.table.containerFit)?void 0:e.height)?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,m),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:y,height:v}),this.tableGroup.border){let t,e,f,m,y=null==(i=this.tableGroup.border)?void 0:i.attribute;(null==y?void 0:y.strokeArrayWidth)?(t=y.strokeArrayWidth?y.strokeArrayWidth[0]:null!=(r=y.lineWidth)?r:0,e=y.strokeArrayWidth?y.strokeArrayWidth[1]:null!=(n=y.lineWidth)?n:0,f=y.strokeArrayWidth?y.strokeArrayWidth[2]:null!=(l=y.lineWidth)?l:0,m=y.strokeArrayWidth?y.strokeArrayWidth[3]:null!=(s=y.lineWidth)?s:0):(t=null!=(a=null==y?void 0:y.lineWidth)?a:0,e=null!=(o=null==y?void 0:y.lineWidth)?o:0,f=null!=(h=null==y?void 0:y.lineWidth)?h:0,m=null!=(d=null==y?void 0:y.lineWidth)?d:0),"rect"===this.tableGroup.border.type?(null==(u=this.table.theme.frameStyle)?void 0:u.innerBorder)?this.tableGroup.border.setAttributes({x:this.table.tableX+m/2,y:this.table.tableY+t/2,width:this.tableGroup.attribute.width-m/2-e/2,height:this.tableGroup.attribute.height-t/2-f/2}):this.tableGroup.border.setAttributes({x:this.table.tableX-m/2,y:this.table.tableY-t/2,width:this.tableGroup.attribute.width+m/2+e/2,height:this.tableGroup.attribute.height+t/2+f/2}):"group"===this.tableGroup.border.type&&((null==(c=this.table.theme.frameStyle)?void 0:c.innerBorder)?(this.tableGroup.border.setAttributes({x:this.table.tableX+m/2,y:this.table.tableY+t/2,width:this.tableGroup.attribute.width-m/2-e/2,height:this.tableGroup.attribute.height-t/2-f/2}),null==(p=this.tableGroup.border.firstChild)||p.setAttributes({x:0,y:0,width:this.tableGroup.attribute.width-m/2-e/2,height:this.tableGroup.attribute.height-t/2-f/2})):(this.tableGroup.border.setAttributes({x:this.table.tableX-m/2,y:this.table.tableY-t/2,width:this.tableGroup.attribute.width+m/2+e/2,height:this.tableGroup.attribute.height+t/2+f/2}),null==(g=this.tableGroup.border.firstChild)||g.setAttributes({x:m/2,y:t/2,width:this.tableGroup.attribute.width,height:this.tableGroup.attribute.height})))}this.table.bottomFrozenRowCount>0&&(this.bottomFrozenGroup.setAttribute("y",this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight()),this.leftBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight(),width:this.table.getFrozenColsWidth()}),this.rightBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight()})),this.table.rightFrozenColCount>0&&(this.rightFrozenGroup.setAttribute("x",this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth()),this.rightTopCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth(),height:this.table.getFrozenRowsHeight()}),this.rightBottomCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth()})),this.updateDomContainer()}updateRowHeight(t,e,i){tr(this,t,e=Math.round(e),i),this.updateContainerHeight(t,e)}updateRowsHeight(t,e,i){for(let r=0;r<t.length;r++){let n=t[r];if(n>=this.proxy.rowStart&&n<=this.proxy.rowEnd){let t=e[r];tr(this,n,Math.round(t),i),this._updateContainerHeight(n,t)}}this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}updateContainerWidth(t,e){t<this.frozenColCount?(this.rowHeaderGroup.setDeltaWidth(e),this.cornerHeaderGroup.setDeltaWidth(e),this.colHeaderGroup.setDeltaX(e),this.bodyGroup.setDeltaX(e)):(this.colHeaderGroup.setDeltaWidth(e),this.bodyGroup.setDeltaWidth(e)),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}_updateContainerHeight(t,e){t<this.table.frozenRowCount?(this.colHeaderGroup.setDeltaHeight(e),this.cornerHeaderGroup.setDeltaHeight(e),this.rowHeaderGroup.setDeltaY(e),this.bodyGroup.setDeltaY(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaY(e)):t>=this.table.rowCount-this.table.bottomFrozenRowCount?(this.leftBottomCornerGroup.setDeltaHeight(e),this.bottomFrozenGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightBottomCornerGroup.setDeltaHeight(e)):(this.rowHeaderGroup.setDeltaHeight(e),this.bodyGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaHeight(e))}updateContainerHeight(t,e){this._updateContainerHeight(t,e),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}setColWidth(t,e){let i=this.table.getColWidth(t);i!==e&&(this.updateColWidth(t,e-i),this.table._clearColRangeWidthsMap(t))}setRowHeight(t,e){let i=this.table.getRowHeight(t);i!==e&&((t>=this.proxy.rowStart&&t<=this.proxy.rowEnd||t>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<=this.table.rowCount-1||t<this.table.frozenRowCount)&&this.updateRowHeight(t,e-i),this.table._clearRowRangeHeightsMap(t))}setX(t,e=!1){this.table.scenegraph.proxy.setX(-t,e)}setY(t,e=!1){this.table.scenegraph.proxy.setY(-t,e)}setBodyAndRowHeaderY(t){var e,i,r,n,l,s;let a=null!=(i=null==(e=this.bodyGroup.firstChild)?void 0:e.firstChild)?i:null==(r=this.rowHeaderGroup.firstChild)?void 0:r.firstChild,o=null!=(l=null==(n=this.bodyGroup.firstChild)?void 0:n.lastChild)?l:null==(s=this.rowHeaderGroup.firstChild)?void 0:s.lastChild;0===t&&a&&a.row===this.table.frozenRowCount&&a.attribute.y+t<0?t=-a.attribute.y:o&&this.table.tableNoFrameHeight<this.table.getAllRowsHeight()&&o.row===this.table.rowCount-this.table.bottomFrozenRowCount-1&&o.attribute.y+this.table.getRowHeight(o.row)+t<this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()&&(t=this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()-o.attribute.y-this.table.getRowHeight(o.row)),this.colHeaderGroup.attribute.height+t!==this.bodyGroup.attribute.y&&(this.bodyGroup.setAttribute("y",this.colHeaderGroup.attribute.height+t),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height+t),this.table.rightFrozenColCount>0&&this.rightFrozenGroup.setAttribute("y",this.rightTopCornerGroup.attribute.height+t),this.updateNextFrame())}setBodyAndColHeaderX(t){let e=this.bodyGroup.firstChild,i=this.bodyGroup.lastChild;0===t&&e&&e.col===this.table.frozenColCount&&e.attribute.x+t<0?t=-e.attribute.x:i&&this.table.tableNoFrameWidth<this.table.getAllColsWidth()&&i.col===this.table.colCount-this.table.rightFrozenColCount-1&&i.attribute.x+i.attribute.width+t<this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()&&(t=this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()-i.attribute.x-i.attribute.width),this.table.getFrozenColsWidth()+t!==this.bodyGroup.attribute.x&&(this.bodyGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.colHeaderGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.table.bottomFrozenRowCount>0&&this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.updateNextFrame())}afterScenegraphCreated(){var t;this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount?this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):this.component.setFrozenColumnShadow(-1):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.table.stateManager.checkFrozen(),this.updateContainer(),this.createFrameBorder(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),eX(this.table),this.table.options.animationAppear&&function(t){var e,i,r,n;let l,s,a,o;if(!t.options.animationAppear)return;!0===t.options.animationAppear?(l=500,s=0,a="one-by-one",o="column"):(l=null!=(e=t.options.animationAppear.duration)?e:500,s=null!=(i=t.options.animationAppear.delay)?i:0,a=null!=(r=t.options.animationAppear.type)?r:"one-by-one",o=null!=(n=t.options.animationAppear.direction)?n:"row");let{scenegraph:h,frozenColCount:d,frozenRowCount:u}=t,{colStart:c,colEnd:p,rowStart:g,rowEnd:f}=h.proxy;for(let t=0;t<=p;t++)for(let e=0;e<=f;e++){let i=h.highPerformanceGetCell(t,e);i&&"cell"===i.role&&i.forEachChildren(i=>{i.setAttribute("opacity",0),i.animate().wait("one-by-one"===a?("row"===o?e:t)*(l-s):s).to({opacity:1},l,"linear")})}}(this.table),!1===(null==(t=this.table.options.menu)?void 0:t.contextMenuWorkOnlyCell)&&this.canvasShowMenu(),this.updateNextFrame()}dealWidthMode(){let t=this.table;if("adaptive"===t.widthMode){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,i=0,r=0,n=t.colCount;if("only-body"===t.widthAdaptiveMode){for(let e=0;e<t.colCount;e++)(e<t.rowHeaderLevelCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(i+=t.getColWidth(e));r=t.rowHeaderLevelCount,n=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount}(0,ex.j8)(e-i,r,n,!1,[],t,!0)}else if(t.autoFillWidth){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,i=0,r=0;for(let e=0;e<t.colCount;e++){let n=t.getColWidth(e);"only-body"===t.widthAdaptiveMode&&(e<t.rowHeaderLevelCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(i+=n),r+=n}if(r<e&&r>i){let r=0,n=t.colCount;"only-body"===t.widthAdaptiveMode&&(r=t.rowHeaderLevelCount,n=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount),(0,ex.j8)(e-i,r,n,!1,[],t,!0)}}let e=0;this.bodyGroup.forEachChildrenSkipChild(t=>{e+=t.attribute.width}),this.bodyGroup.setAttribute("width",e);let i=0;this.colHeaderGroup.forEachChildrenSkipChild(t=>{i+=t.attribute.width}),this.colHeaderGroup.setAttribute("width",i);let r=0;this.rowHeaderGroup.forEachChildrenSkipChild(t=>{r+=t.attribute.width}),this.rowHeaderGroup.setAttribute("width",r);let n=0;this.cornerHeaderGroup.forEachChildrenSkipChild(t=>{n+=t.attribute.width}),this.cornerHeaderGroup.setAttribute("width",n),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height),this.bodyGroup.setAttributes({x:this.rowHeaderGroup.attribute.width,y:this.colHeaderGroup.attribute.height})}dealHeightMode(){var t;let e=this.table;if("adaptive"===e.heightMode){e._clearRowRangeHeightsMap();let t=e.getRowsHeight(0,e.columnHeaderLevelCount-1),i=e.isPivotChart()?e.getBottomFrozenRowsHeight():0,r=e.tableNoFrameHeight-t-i,n=e.columnHeaderLevelCount,l=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,s=0;for(let t=n;t<l;t++)s+=e.getRowHeight(t);let a=r/s;for(let t=n;t<l;t++){let i;i=t===l-1?r-e.getRowsHeight(n,l-2):Math.round(e.getRowHeight(t)*a),this.setRowHeight(t,i)}}else if(e.autoFillHeight){e._clearRowRangeHeightsMap();let i=e.tableNoFrameHeight,r=0,n=0;for(let t=0;t<e.rowCount;t++){let i=e.getRowHeight(t);(t<e.columnHeaderLevelCount||e.isPivotChart()&&t>=e.rowCount-e.bottomFrozenRowCount)&&(n+=i),r+=i}if((null!=(t=this._dealAutoFillHeightOriginRowsHeight)?t:r)<i&&r-n>0){let t=e.columnHeaderLevelCount,l=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,s=(i-n)/(r-n);for(let r=t;r<l;r++){let a;a=r===l-1?i-n-e.getRowsHeight(t,l-2):Math.round(e.getRowHeight(r)*s),this.setRowHeight(r,a)}}}}dealFrozen(){!function(t){var e,i,r,n;if(t.table.frozenColCount>t.table.rowHeaderLevelCount){t.rowHeaderGroup.setAttribute("height",t.bodyGroup.attribute.height),t.rowHeaderGroup.setAttribute("y",t.bodyGroup.attribute.y),t.cornerHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height);for(let e=0;e<t.table.frozenColCount-t.table.rowHeaderLevelCount;e++)id(t),iu(t),ig(t)}else if(t.table.frozenColCount<t.table.rowHeaderLevelCount){t.bodyGroup.setAttribute("height",t.rowHeaderGroup.attribute.height),t.bodyGroup.setAttribute("y",t.rowHeaderGroup.attribute.y),t.colHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height);for(let e=0;e<t.table.rowHeaderLevelCount-t.table.frozenColCount;e++)ic(t),ip(t),im(t)}t.bodyGroup.setAttribute("x",t.rowHeaderGroup.attribute.width),t.colHeaderGroup.setAttribute("x",t.cornerHeaderGroup.attribute.width),t.updateContainer(),t.updateBorderSizeAndPosition(),t.isPivot||t.table.transpose?t.table.options.frozenColCount?t.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.frozenColCount&&t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):(t.component.setFrozenColumnShadow(t.table.frozenColCount-1),t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.hasFrozen=!0,t.frozenColCount=t.table.frozenColCount,t.frozenRowCount=null!=(n=null!=(i=null==(e=t.colHeaderGroup.firstChild)?void 0:e.childrenCount)?i:null==(r=t.cornerHeaderGroup.firstChild)?void 0:r.childrenCount)?n:t.table.frozenRowCount}(this)}resetFrozen(){!function(t){var e,i,r,n,l,s;if(t.frozenColCount>t.table.frozenColCount){t.bodyGroup.setAttribute("height",t.rowHeaderGroup.attribute.height),t.bodyGroup.setAttribute("y",t.rowHeaderGroup.attribute.y),t.colHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height);for(let e=0;e<t.frozenColCount-t.table.frozenColCount;e++)ic(t),ip(t),im(t)}else if(t.frozenColCount<t.table.frozenColCount){t.rowHeaderGroup.setAttribute("height",t.bodyGroup.attribute.height),t.rowHeaderGroup.setAttribute("y",t.bodyGroup.attribute.y),t.cornerHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height);for(let e=0;e<t.table.frozenColCount-t.frozenColCount;e++)id(t),iu(t),ig(t)}ih(t),t.recreateAllSelectRangeComponents(),t.frozenColCount=t.table.frozenColCount,t.frozenRowCount=null!=(n=null!=(i=null==(e=t.colHeaderGroup.firstChild)?void 0:e.childrenCount)?i:null==(r=t.cornerHeaderGroup.firstChild)?void 0:r.childrenCount)?n:t.table.frozenRowCount,t.proxy.colStart=null!=(s=null==(l=t.bodyGroup.firstChild)?void 0:l.col)?s:t.table.frozenColCount,t.bodyGroup.setAttribute("x",t.rowHeaderGroup.attribute.width),t.colHeaderGroup.setAttribute("x",t.cornerHeaderGroup.attribute.width),t.updateContainer(),t.updateBorderSizeAndPosition(),t.isPivot||t.table.transpose?t.table.options.frozenColCount?t.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.rightFrozenColCount&&t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):(t.component.setFrozenColumnShadow(t.table.frozenColCount-1),t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.hasFrozen=!0}(this)}resetRowFrozen(){!function(t){var e,i,r,n,l;if(t.frozenRowCount>t.table.frozenRowCount){t.bodyGroup.setAttribute("width",t.colHeaderGroup.attribute.width),t.bodyGroup.setAttribute("x",t.colHeaderGroup.attribute.x),t.rowHeaderGroup.setAttribute("width",t.cornerHeaderGroup.attribute.width);for(let e=0;e<t.frozenRowCount-t.table.frozenRowCount;e++)(function(t){let e=!1;for(let i=0;i<t.colHeaderGroup.childrenCount;i++){let r=t.colHeaderGroup.children[i];if(!iv(r))continue;let n=t.bodyGroup.children[i];if(!n)continue;let l=r.lastChild;iy(n,l,n.firstChild),e||(t.colHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height-l.attribute.height),t.bodyGroup.setAttribute("height",t.bodyGroup.attribute.height+l.attribute.height),e=!0)}})(t),function(t){let e=!1;for(let i=0;i<t.cornerHeaderGroup.childrenCount;i++){let r=t.cornerHeaderGroup.children[i];if(!iv(r))continue;let n=t.rowHeaderGroup.children[i];if(!n)continue;let l=r.lastChild;iy(n,l,n.firstChild),e||(t.cornerHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height-l.attribute.height),t.rowHeaderGroup.setAttribute("height",t.rowHeaderGroup.attribute.height+l.attribute.height),e=!0)}}(t),function(t){let e=!1;for(let i=0;i<t.rightTopCornerGroup.childrenCount;i++){let r=t.rightTopCornerGroup.children[i];if(!iv(r))continue;let n=t.rightFrozenGroup.children[i];if(!n)continue;let l=r.lastChild;iy(n,l,n.firstChild),e||(t.rightTopCornerGroup.setAttribute("height",t.rightTopCornerGroup.attribute.height-l.attribute.height),t.rightFrozenGroup.setAttribute("height",t.rightFrozenGroup.attribute.height+l.attribute.height),e=!0)}}(t)}else if(t.frozenRowCount<t.table.frozenRowCount){t.colHeaderGroup.setAttribute("width",t.bodyGroup.attribute.width),t.colHeaderGroup.setAttribute("x",t.bodyGroup.attribute.x),t.cornerHeaderGroup.setAttribute("width",t.rowHeaderGroup.attribute.width);for(let e=0;e<t.table.frozenRowCount-t.frozenRowCount;e++)(function(t){var e;let i=!1;for(let r=0;r<t.bodyGroup.childrenCount;r++){let n=t.bodyGroup.children[r];if(!iv(n))continue;let l=n.firstChild;t.colHeaderGroup.children[r]||ek(t.colHeaderGroup,0,0,l.col,l.col,0,0,"columnHeader",t.table),null==(e=t.colHeaderGroup.children[r])||e.appendChild(l),i||(t.colHeaderGroup.setAttribute("height",t.colHeaderGroup.attribute.height+l.attribute.height),t.bodyGroup.setAttribute("height",t.bodyGroup.attribute.height-l.attribute.height),i=!0)}})(t),function(t){var e;let i=!1;for(let r=0;r<t.rowHeaderGroup.childrenCount;r++){let n=t.rowHeaderGroup.children[r];if(!iv(n))continue;let l=n.firstChild;t.cornerHeaderGroup.children[r]||ek(t.cornerHeaderGroup,0,0,l.col,l.col,0,0,t.table.isListTable()?"columnHeader":"cornerHeader",t.table),null==(e=t.cornerHeaderGroup.children[r])||e.appendChild(l),i||(t.cornerHeaderGroup.setAttribute("height",t.cornerHeaderGroup.attribute.height+l.attribute.height),t.rowHeaderGroup.setAttribute("height",t.rowHeaderGroup.attribute.height-l.attribute.height),i=!0)}}(t),function(t){let e=!1;for(let i=0;i<t.rightFrozenGroup.childrenCount;i++){let r=t.rightFrozenGroup.children[i];if(!iv(r))continue;let n=r.firstChild;t.rightTopCornerGroup.children[i]||ek(t.rightTopCornerGroup,0,0,n.col,n.col,0,0,"columnHeader",t.table),t.rightTopCornerGroup.children[i].appendChild(n),e||(t.rightTopCornerGroup.setAttribute("height",t.rightTopCornerGroup.attribute.height+n.attribute.height),t.rightFrozenGroup.setAttribute("height",t.rightFrozenGroup.attribute.height-n.attribute.height),e=!0)}}(t)}ih(t),t.recreateAllSelectRangeComponents(),t.frozenRowCount=t.table.frozenRowCount,t.frozenColCount=null!=(i=null==(e=t.rowHeaderGroup)?void 0:e.childrenCount)?i:0,t.proxy.rowStart=null!=(l=null==(n=null==(r=t.bodyGroup.firstChild)?void 0:r.firstChild)?void 0:n.row)?l:t.table.frozenRowCount,t.bodyGroup.setAttribute("y",t.colHeaderGroup.attribute.height),t.rowHeaderGroup.setAttribute("y",t.cornerHeaderGroup.attribute.height),t.updateContainer({needUpdateCellY:!0}),t.updateBorderSizeAndPosition(),t.hasFrozen=!0}(this)}updateCellLayoutWidthCertainWidth(t,e,i){let r=t.attribute.width,n=!1;return t.forEachChildren((t,l)=>{l+=e;let s=(0,j.Z)(this.table,i,l);s?t=this.getCell(s.start.col,s.start.row):t.setAttribute("width",r);let a=this.table._getCellStyle(i,l),o=(0,J.u)((0,Y.WJ)("padding",a,i,l,this.table)),h=t.getChildByName("text"),d=0,u=0;if(h)d=h.AABBBounds.height()+(o[0]+o[2]),h.setAttribute("maxLineWidth",r-(o[1]+o[3])),u=h.AABBBounds.height()+(o[0]+o[2]);else{let e=t.getChildAt(1);d=e.AABBBounds.height()+(o[0]+o[2]),e._cellWidth=r-(o[1]+o[3]),e.layout(),u=e.AABBBounds.height()+(o[0]+o[2])}let c=this.table.getRowHeight(l);t.attribute.height!==u&&(t.setAttribute("height",u),(c===d||u>c)&&(n=!0))}),n}updateHeaderPosition(t,e,i,r,n){!function(t,e,i,r,n,l){let s=l.scenegraph;for(let i=t;i<=e;i++){let t=l.getColWidth(i),e=l.scenegraph.getColGroup(i,!0),r=l.scenegraph.getColGroup(i),n=l.scenegraph.getColGroupInBottom(i),s=l.scenegraph.getColGroupInLeftBottomCorner(i),a=l.scenegraph.getColGroupInRightBottomCorner(i);e&&(e.setAttribute("width",t),e.forEachChildren(e=>{e.setAttribute("width",t)})),r&&(r.setAttribute("width",t),r.forEachChildren(e=>{e.setAttribute("width",t)})),n&&(n.setAttribute("width",t),n.forEachChildren(e=>{e.setAttribute("width",t)})),a&&(a.setAttribute("width",t),a.forEachChildren(e=>{e.setAttribute("width",t)})),s&&(s.setAttribute("width",t),s.forEachChildren(e=>{e.setAttribute("width",t)}))}if(s.updateContainer(),"column"===n)for(let i=t;i<=e;i++){let t=l.scenegraph.getColGroup(i);null==t||t.setAttribute("chartInstance",void 0);for(let t=0;t<=l.frozenRowCount-1;t++)s.updateCellContent(i,t);for(let t=s.bodyRowStart;t<=s.bodyRowEnd;t++)s.updateCellContent(i,t);for(let t=l.rowCount-l.bottomFrozenRowCount;t<=l.rowCount-1;t++)s.updateCellContent(i,t)}else{for(let t=0;t<=l.frozenColCount-1;t++){let e=l.scenegraph.getColGroup(t);null==e||e.setAttribute("chartInstance",void 0);for(let e=i;e<=r;e++)s.updateCellContent(t,e)}for(let t=s.bodyColStart;t<=s.bodyColEnd;t++){let e=l.scenegraph.getColGroup(t);null==e||e.setAttribute("chartInstance",void 0);for(let e=i;e<=r;e++)s.updateCellContent(t,e)}for(let t=l.colCount-l.rightFrozenColCount;t<=l.colCount-1;t++){let e=l.scenegraph.getColGroup(t);null==e||e.setAttribute("chartInstance",void 0);for(let e=i;e<=r;e++)s.updateCellContent(t,e)}}}(t,e,i,r,n,this.table)}updateContainerAttrWidthAndX(){var t,e,i;let r=iC(this.cornerHeaderGroup,0),n=iC(this.rowHeaderGroup,0),l=this.colHeaderGroup.hasChildNodes()&&this.colHeaderGroup.firstChild?iC(this.colHeaderGroup,this.colHeaderGroup.firstChild.col>0?this.table.getColsWidth(null!=(t=this.table.frozenColCount)?t:0,this.colHeaderGroup.firstChild.col-1):0):0,s=this.bodyGroup.hasChildNodes()&&this.bodyGroup.firstChild?iC(this.bodyGroup,this.bodyGroup.firstChild.col>0?this.table.getColsWidth(null!=(e=this.table.frozenColCount)?e:0,this.bodyGroup.firstChild.col-1):0):0,a=iC(this.rightFrozenGroup.childrenCount>0?this.rightFrozenGroup:this.rightTopCornerGroup,0);this.bottomFrozenGroup.hasChildNodes()&&this.bottomFrozenGroup.firstChild&&iC(this.bottomFrozenGroup,this.bottomFrozenGroup.firstChild.col>0?this.table.getColsWidth(null!=(i=this.table.frozenColCount)?i:0,this.bottomFrozenGroup.firstChild.col-1):0),iC(this.leftBottomCornerGroup,0),iC(this.rightTopCornerGroup,0),iC(this.rightBottomCornerGroup,0),this.cornerHeaderGroup.setDeltaWidth(r-this.cornerHeaderGroup.attribute.width),this.leftBottomCornerGroup.setDeltaWidth(r-this.leftBottomCornerGroup.attribute.width),this.colHeaderGroup.setDeltaWidth(l-this.colHeaderGroup.attribute.width),this.rowHeaderGroup.setDeltaWidth(n-this.rowHeaderGroup.attribute.width),this.bottomFrozenGroup.setDeltaWidth(l-this.bottomFrozenGroup.attribute.width),this.rightFrozenGroup.setDeltaWidth(a-this.rightFrozenGroup.attribute.width),this.rightTopCornerGroup.setDeltaWidth(a-this.rightTopCornerGroup.attribute.width),this.rightBottomCornerGroup.setDeltaWidth(a-this.rightBottomCornerGroup.attribute.width),this.bodyGroup.setDeltaWidth(s-this.bodyGroup.attribute.width),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()),this.bodyGroup.setAttribute("x",this.rowHeaderGroup.attribute.width)}updateContainerAttrHeightAndY(){var t,e,i;for(let t=0;t<this.cornerHeaderGroup.children.length;t++)ix(this.cornerHeaderGroup.children[t],0);for(let t=0;t<this.colHeaderGroup.children.length;t++)ix(this.colHeaderGroup.children[t],0);for(let t=0;t<this.rightTopCornerGroup.children.length;t++)ix(this.rightTopCornerGroup.children[t],0);for(let e=0;e<this.rowHeaderGroup.children.length;e++)this.rowHeaderGroup.children[e].firstChild&&ix(this.rowHeaderGroup.children[e],this.rowHeaderGroup.children[e].firstChild.row>0?this.table.getRowsHeight(null!=(t=this.table.frozenRowCount)?t:0,this.rowHeaderGroup.children[e].firstChild.row-1):0);for(let t=0;t<this.bodyGroup.children.length;t++)this.bodyGroup.children[t].firstChild&&ix(this.bodyGroup.children[t],this.bodyGroup.children[t].firstChild.row>0?this.table.getRowsHeight(null!=(e=this.table.frozenRowCount)?e:0,this.bodyGroup.children[t].firstChild.row-1):0);for(let t=0;t<this.rightFrozenGroup.children.length;t++)this.rightFrozenGroup.children[t].firstChild&&ix(this.rightFrozenGroup.children[t],this.rightFrozenGroup.children[t].firstChild.row>0?this.table.getRowsHeight(null!=(i=this.table.frozenRowCount)?i:0,this.rightFrozenGroup.children[t].firstChild.row-1):0);for(let t=0;t<this.leftBottomCornerGroup.children.length;t++)ix(this.leftBottomCornerGroup.children[t],0);for(let t=0;t<this.bottomFrozenGroup.children.length;t++)ix(this.bottomFrozenGroup.children[t],0);for(let t=0;t<this.rightBottomCornerGroup.children.length;t++)ix(this.rightBottomCornerGroup.children[t],0)}updateContainer(t={async:!1,needUpdateCellY:!1}){var e;t.async?this._needUpdateContainer||(this._needUpdateContainer=!0,setTimeout(()=>{var e;this.updateContainerSync(null!=(e=t.needUpdateCellY)&&e)},0)):(this._needUpdateContainer=!0,this.updateContainerSync(null!=(e=t.needUpdateCellY)&&e))}updateContainerSync(t=!1){this._needUpdateContainer&&(this._needUpdateContainer=!1,this.updateContainerAttrWidthAndX(),t&&this.updateContainerAttrHeightAndY(),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame())}updateCellContentWhileResize(t,e){var i;let r=(null==(i=this.table.getCellRawRecord(t,e))?void 0:i.vtableMerge)?"text":this.table.isHeader(t,e)?this.table._getHeaderLayoutMap(t,e).headerType:this.table.getBodyColumnType(t,e),n=this.getCell(t,e);"image"!==r&&"video"!==r||(0,K.km)(n,t,e,0,0,this.table)}createFrameBorder(){var t,e,i,r,n;this.updateTableSize();let l=!this.isPivot&&!this.table.internalProps.transpose;tk(this.bodyGroup,this.table.theme.bodyStyle.frameStyle,this.bodyGroup.role,l?[!0,!0,!0,!1]:void 0),tk(this.rowHeaderGroup,this.isPivot||this.table.internalProps.transpose?this.table.theme.rowHeaderStyle.frameStyle:this.table.theme.bodyStyle.frameStyle,this.rowHeaderGroup.role,l?[!0,!1,!0,!0]:void 0),tk(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle,this.colHeaderGroup.role,l?[!0,!0,!0,!1]:void 0),tk(this.cornerHeaderGroup,this.isPivot?this.table.theme.cornerHeaderStyle.frameStyle:this.table.theme.headerStyle.frameStyle,this.cornerHeaderGroup.role,l?[!0,!1,!0,!0]:void 0),(null==(t=this.table.theme.cornerLeftBottomCellStyle)?void 0:t.frameStyle)&&tk(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle.frameStyle,this.leftBottomCornerGroup.role,l?[!0,!1,!0,!0]:void 0),(null==(e=this.table.theme.bottomFrozenStyle)?void 0:e.frameStyle)&&tk(this.bottomFrozenGroup,this.table.theme.bottomFrozenStyle.frameStyle,this.bottomFrozenGroup.role,l?[!0,!0,!0,!1]:void 0),(null==(i=this.table.theme.rightFrozenStyle)?void 0:i.frameStyle)&&tk(this.rightFrozenGroup,this.table.theme.rightFrozenStyle.frameStyle,this.rightFrozenGroup.role,void 0),(null==(r=this.table.theme.cornerRightTopCellStyle)?void 0:r.frameStyle)&&tk(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle.frameStyle,this.rightTopCornerGroup.role,void 0),(null==(n=this.table.theme.cornerRightBottomCellStyle)?void 0:n.frameStyle)&&tk(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle.frameStyle,this.rightBottomCornerGroup.role,void 0),tk(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0)}getResizeColAt(t,e,i){let r,n=this.table.theme.columnResize.resizeHotSpotSize/2;if(!i){let i=this.table.getDrawRange();return e>=i.top&&e<=i.bottom&&(r=this.table.getCellAtRelativePosition(t-n,e)).col===this.table.colCount-1?r:{col:-1,row:-1}}return i.stage?(t<i.globalAABBBounds.x1+n?r={col:i.col-1,row:i.row,x:i.globalAABBBounds.x1}:i.globalAABBBounds.x2-n<t&&(r={col:i.col,row:i.row,x:i.globalAABBBounds.x2}),r&&this.table.rightFrozenColCount>0&&r.col>=this.table.colCount-this.table.rightFrozenColCount-1&&this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()+this.table.scrollLeft<this.bodyGroup.attribute.width&&(r.col=r.col+1,r.rightFrozen=!0),r||{col:-1,row:-1}):{col:-1,row:-1}}getResizeRowAt(t,e,i){let r=this.table.theme.columnResize.resizeHotSpotSize/2;if(i){let t;if(e<i.globalAABBBounds.y1+r?t={col:i.col,row:i.row-1,y:i.globalAABBBounds.y1}:i.globalAABBBounds.y2-r<e&&(t={col:i.col,row:i.row,y:i.globalAABBBounds.y2}),t&&this.table.bottomFrozenRowCount>0&&t.row>=this.table.rowCount-this.table.bottomFrozenRowCount-1&&this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()+this.table.scrollTop<this.bodyGroup.attribute.height&&(t.row=t.row+1,t.bottomFrozen=!0),t)return t}return{col:-1,row:-1}}updateFrozen(){this.clear||(this.resetFrozen(),this.component.updateScrollBar())}updateRowFrozen(){this.clear||(this.resetRowFrozen(),this.component.updateScrollBar())}dealWidthRightFrozen(t){this.clear?this.table.internalProps.rightFrozenColCount=t:function(t,e){let{table:i,proxy:r,rightTopCornerGroup:n,rightFrozenGroup:l,rightBottomCornerGroup:s,bottomFrozenGroup:a,bodyGroup:o,colHeaderGroup:h}=e,d=e.table.rightFrozenColCount;if(t>d){for(let r=i.colCount-d-1;r>=i.colCount-t;r--)iy(l,e.getColGroup(r),l.firstChild),iy(n,e.getColGroup(r,!0),n.firstChild),iy(s,e.getColGroupInBottom(r),s.firstChild);let r=0;l.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width}),r=0,n.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width}),r=0,s.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width})}else if(t<d){for(let r=i.colCount-d;r<i.colCount-t;r++){let t=e.getColGroup(r);t.setAttribute("x",o.lastChild.attribute.x+i.getColWidth(o.lastChild.col)),o.appendChild(t);let n=e.getColGroupInRightTopCorner(r);n.setAttribute("x",h.lastChild.attribute.x+i.getColWidth(h.lastChild.col)),h.appendChild(n);let l=e.getColGroupInRightBottomCorner(r);l.setAttribute("x",a.lastChild.attribute.x+i.getColWidth(a.lastChild.col)),a.appendChild(l)}let r=0;l.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width}),r=0,n.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width}),r=0,s.forEachChildren(t=>{t.setAttribute("x",r),r+=t.attribute.width})}l.setAttribute("width",i.getColsWidth(i.colCount-t,i.colCount-1)),n.setAttribute("width",i.getColsWidth(i.colCount-t,i.colCount-1)),s.setAttribute("width",i.getColsWidth(i.colCount-t,i.colCount-1)),i.internalProps.rightFrozenColCount=t,e.updateContainer(),e.component.updateScrollBar(),e.updateNextFrame()}(t,this)}dealWidthBottomFrozen(t){this.clear?this.table.internalProps.bottomFrozenRowCount=t:function(t,e){let{table:i,proxy:r,bottomFrozenGroup:n,leftBottomCornerGroup:l,rightBottomCornerGroup:s}=e;n.childrenCount||(r.table.isPivotChart()||(ek(l,0,0,0,i.frozenColCount-1,0,-1,"rowHeader",i),ek(s,0,0,i.colCount-i.rightFrozenColCount,i.colCount-1,0,-1,"body",i)),ek(n,0,0,r.colStart,r.colEnd,0,-1,"body",i));let a=e.table.bottomFrozenRowCount;if(t>a){for(let r=0;r<i.frozenColCount;r++){let n=e.getColGroupInLeftBottomCorner(r);for(let l=i.rowCount-a-1;l>=i.rowCount-t;l--)iy(n,e.getCell(r,l,!0),n.firstChild);let l=0;n.forEachChildren(t=>{t.setAttribute("y",l),l+=i.getRowHeight(t.row)})}for(let n=r.colStart;n<=r.colEnd;n++){let r=e.getColGroupInBottom(n);for(let l=i.rowCount-a-1;l>=i.rowCount-t;l--)iy(r,e.getCell(n,l,!0),r.firstChild);let l=0;r.forEachChildren(t=>{t.setAttribute("y",l),l+=i.getRowHeight(t.row)})}if(i.rightFrozenColCount>0)for(let r=i.colCount-i.rightFrozenColCount;r<i.colCount;r++){let n=e.getColGroupInRightBottomCorner(r);for(let l=i.rowCount-a-1;l>=i.rowCount-t;l--)iy(n,e.getCell(r,l,!0),n.firstChild);let l=0;n.forEachChildren(t=>{t.setAttribute("y",l),l+=i.getRowHeight(t.row)})}}else if(t<a){for(let r=0;r<i.rowHeaderLevelCount;r++){let n=e.getColGroup(r);for(let l=i.rowCount-a;l<i.rowCount-t;l++){let t=e.getCell(r,l,!0);t.setAttribute("y",n.lastChild.attribute.y+i.getRowHeight(n.lastChild.row)),n.appendChild(t)}let l=e.getColGroupInLeftBottomCorner(r),s=0;l.forEachChildren(t=>{t.setAttribute("y",s),s+=i.getRowHeight(t.row)})}for(let n=r.colStart;n<=r.colEnd;n++){let r=e.getColGroup(n);for(let l=i.rowCount-a;l<i.rowCount-t;l++){let t=e.getCell(n,l,!0);t.setAttribute("y",r.lastChild.attribute.y+i.getRowHeight(r.lastChild.row)),r.appendChild(t)}let l=e.getColGroupInBottom(n),s=0;l.forEachChildren(t=>{t.setAttribute("y",s),s+=i.getRowHeight(t.row)})}if(i.rightFrozenColCount>0)for(let r=i.colCount-i.rightFrozenColCount;r<i.colCount;r++){let n=e.getColGroup(r);for(let l=i.rowCount-a;l<i.rowCount-t;l++){let t=e.getCell(r,l,!0);t.setAttribute("y",n.lastChild.attribute.y+i.getRowHeight(n.lastChild.row)),n.appendChild(t)}let l=e.getColGroupInRightBottomCorner(r),s=0;l.forEachChildren(t=>{t.setAttribute("y",s),s+=i.getRowHeight(t.row)})}}n.setAttribute("height",i.getRowsHeight(i.rowCount-t,i.rowCount-1)),l.setAttribute("height",i.getRowsHeight(i.rowCount-t,i.rowCount-1)),s.setAttribute("height",i.getRowsHeight(i.rowCount-t,i.rowCount-1)),i.internalProps.bottomFrozenRowCount=t,e.updateContainer(),e.component.updateScrollBar(),e.updateNextFrame()}(t,this)}updateBorderSizeAndPosition(){this.bodyGroup.border&&(this.bodyGroup.appendChild(this.bodyGroup.border),tB(this.bodyGroup),this.rowHeaderGroup.attribute.width,tR(this.bodyGroup,this.table.theme.bodyStyle.frameStyle)),this.colHeaderGroup.border&&(this.colHeaderGroup.appendChild(this.colHeaderGroup.border),tB(this.colHeaderGroup),this.cornerHeaderGroup.attribute.width,tR(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle)),this.rowHeaderGroup.border&&(this.rowHeaderGroup.appendChild(this.rowHeaderGroup.border),tB(this.rowHeaderGroup)),this.cornerHeaderGroup.border&&(this.cornerHeaderGroup.appendChild(this.cornerHeaderGroup.border),tB(this.cornerHeaderGroup)),this.leftBottomCornerGroup.border&&(this.leftBottomCornerGroup.appendChild(this.leftBottomCornerGroup.border),tB(this.leftBottomCornerGroup)),this.bottomFrozenGroup.border&&(this.bottomFrozenGroup.appendChild(this.bottomFrozenGroup.border),tB(this.bottomFrozenGroup)),this.rightFrozenGroup.border&&(this.rightFrozenGroup.appendChild(this.rightFrozenGroup.border),tB(this.rightFrozenGroup)),this.rightTopCornerGroup.border&&(this.rightTopCornerGroup.appendChild(this.rightTopCornerGroup.border),tB(this.rightTopCornerGroup)),this.rightBottomCornerGroup.border&&(this.rightBottomCornerGroup.appendChild(this.rightBottomCornerGroup.border),tB(this.rightBottomCornerGroup)),function(t){if(!t.theme.frameStyle.cornerRadius)return;let e=t.theme.frameStyle.cornerRadius,{cornerHeaderGroup:i,colHeaderGroup:r,rowHeaderGroup:n,bodyGroup:l,rightTopCornerGroup:s,leftBottomCornerGroup:a,rightBottomCornerGroup:o,rightFrozenGroup:h,bottomFrozenGroup:d}=t.scenegraph;i.setAttribute("cornerRadius",0),r.setAttribute("cornerRadius",0),n.setAttribute("cornerRadius",0),l.setAttribute("cornerRadius",0),s.setAttribute("cornerRadius",0),a.setAttribute("cornerRadius",0),o.setAttribute("cornerRadius",0),h.setAttribute("cornerRadius",0),d.setAttribute("cornerRadius",0);let u=(0,B.JO)(e);i.attribute.width>0&&i.attribute.height>0?tI(i,[u[0],0,0,0]):r.attribute.height>0?tI(r,[u[0],0,0,0]):n.attribute.width>0?tI(n,[u[0],0,0,0]):tI(l,[u[0],0,0,0]),a.attribute.width>0&&a.attribute.height>0?tI(a,[0,0,0,u[3]]):d.attribute.height>0?tI(d,[0,0,0,u[3]]):n.attribute.width>0?tI(n,[0,0,0,u[3]]):tI(l,[0,0,0,u[3]]),s.attribute.width>0&&s.attribute.height>0?tI(s,[0,u[1],0,0]):r.attribute.height>0?tI(r,[0,u[1],0,0]):h.attribute.width>0?tI(h,[0,u[1],0,0]):tI(l,[0,u[1],0,0]),o.attribute.width>0&&o.attribute.height>0?tI(o,[0,0,u[2],0]):h.attribute.width>0?tI(h,[0,0,u[2],0]):d.attribute.height>0?tI(d,[0,0,u[2],0]):tI(l,[0,0,u[2],0])}(this.table)}sortCell(){this.isPivot||(this.table.transpose?this.proxy.sortCellHorizontal():this.proxy.sortCellVertical())}getCellOverflowText(t,e){let i=this.getCell(t,e).getChildByName("text",!0);if(i&&"text"===i.type){if(i.attribute.moreThanMaxCharacters||i.cliped)return this.table.getCellValue(t,e)}else if(i&&"richtext"===i.type&&i.attribute.ellipsis&&i._frameCache&&i.attribute.height<i._frameCache.actualHeight)return i.attribute.textConfig.find(t=>t.text),this.table.getCellValue(t,e);return null}updateDrill(t,e,i,r,n){this.component.drillIcon.update(t,e,i,r,n,this)}updateCellContent(t,e,i=!1){if(!this.clear)return(0,X.wW)(t,e,this.table,void 0,void 0,i)}setPixelRatio(t){this.stage.disableDirtyBounds(),this.stage.window.setDpr(t),this.stage.render(),this.stage.enableDirtyBounds()}updateRow(t,e,i=[],r=!0,n){this.table.internalProps.layoutMap.clearCellRangeMap(),this.table.internalProps.useOneRowHeightFillAll=!1;let l=(0,O.oM)(e.map(t=>t.row)).sort((t,e)=>t-e),s=(0,O.oM)(i.map(t=>t.row)).sort((t,e)=>t-e),a=this.table.getAllRowsHeight()-[...l,...s].reduce((t,e)=>t+this.table.getRowHeight(e),0)<=this.table.tableNoFrameHeight;if(function(t,e,i,r,n){let l,s;eQ(r)&&eK(r);let a=r.scenegraph,o=(0,O.oM)(t.map(t=>t.row)).sort((t,e)=>e-t),h=(0,O.oM)(e.map(t=>t.row)).sort((t,e)=>t-e),d=(0,O.oM)(i.map(t=>t.row)).sort((t,e)=>t-e);if(d.length&&(l=is(d[0]-1,d[d.length-1]+1,a)),h.length){let t=is(h[0]-1,h[h.length-1]+1,a);l=(0,y.Z)(l)?(0,y.Z)(t)?Math.min(l,t):l:t}if(o.length){let t=is(o[0]-1,o[o.length-1]+1,a);l=(0,y.Z)(l)?(0,y.Z)(t)?Math.min(l,t):l:t}o.forEach(t=>{var e=t,i=a,r=n;let l=i.proxy;if(e>=l.rowStart&&e<=l.rowEnd&&(ir(e,i),l.rowEnd--,l.currentRow--),!r){l.bodyBottomRow--;let t=Math.min(l.rowLimit,l.bodyBottomRow-l.bodyTopRow+1);l.totalActualBodyRowCount=t,l.totalRow=Math.min(l.table.rowCount-1,l.rowStart+t-1)}});let u=r.rowHeightsMap;if(o.forEach(t=>{u.delete(t)}),o.length){var c,p,g=a;function f(t,e){t.row=e;let i=(0,j.Z)(g.table,t.col,t.row);i?(t.mergeStartCol=i.start.col,t.mergeEndCol=i.end.col,t.mergeStartRow=i.start.row,t.mergeEndRow=i.end.row):(t.mergeStartCol=void 0,t.mergeEndCol=void 0,t.mergeStartRow=void 0,t.mergeEndRow=void 0)}g.bodyGroup.forEachChildren(t=>{let e=g.bodyRowStart;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.rowHeaderGroup.forEachChildren(t=>{let e=g.bodyRowStart;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.rightFrozenGroup.forEachChildren(t=>{let e=g.bodyRowStart;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.bottomFrozenGroup.forEachChildren(t=>{let e=g.table.rowCount-g.table.bottomFrozenRowCount;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.leftBottomCornerGroup.forEachChildren(t=>{let e=g.table.rowCount-g.table.bottomFrozenRowCount;null==t||t.forEachChildren(t=>{f(t,e),e++})}),g.rightBottomCornerGroup.forEachChildren(t=>{let e=g.table.rowCount-g.table.bottomFrozenRowCount;null==t||t.forEachChildren(t=>{f(t,e),e++})});let t=il(o[o.length-1]-1,o[0]-o.length+1,a);l=(0,y.Z)(l)?(0,y.Z)(t)?Math.min(l,t):l:t}if(a.table._clearRowRangeHeightsMap(),h.forEach(t=>{let e=function(t,e,i){let r=e.proxy;if(!i){r.bodyBottomRow++;let t=Math.min(r.rowLimit,r.bodyBottomRow-r.bodyTopRow+1);r.totalActualBodyRowCount=t,r.totalRow=r.rowStart+t-1}if(!(t<r.rowStart))return t>r.rowEnd?r.rowEnd-r.rowStart+1<r.rowLimit?(r.rowEnd++,r.currentRow++,ii(t,e),t):void 0:(r.rowEnd-r.rowStart+1<r.rowLimit&&(r.rowEnd++,r.currentRow++,ii(t,e)),t)}(t,a,n);s=null!=s?s:e,u.insert(t)}),function(t){function e(e,i,r){e.row=i,e.setAttribute("y",r);let n=(0,j.Z)(t.table,e.col,e.row);n?(e.mergeStartCol=n.start.col,e.mergeEndCol=n.end.col,e.mergeStartRow=n.start.row,e.mergeEndRow=n.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}t.bodyGroup.forEachChildren(i=>{let r=t.bodyRowStart,n=t.getCellGroupY(r);null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.rowHeaderGroup.forEachChildren(i=>{let r=t.bodyRowStart,n=t.getCellGroupY(r);null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.rightFrozenGroup.forEachChildren(i=>{let r=t.bodyRowStart,n=t.getCellGroupY(r);null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.bottomFrozenGroup.forEachChildren(i=>{let r=t.table.rowCount-t.table.bottomFrozenRowCount,n=0;null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.leftBottomCornerGroup.forEachChildren(i=>{let r=t.table.rowCount-t.table.bottomFrozenRowCount,n=0;null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})}),t.rightBottomCornerGroup.forEachChildren(i=>{let r=t.table.rowCount-t.table.bottomFrozenRowCount,n=0;null==i||i.forEachChildren(t=>{e(t,r,n),r++,n+=t.attribute.height})})}(a),h.length){let t=il(h[0]-1,h[h.length-1]+1,a);l=(0,y.Z)(l)?(0,y.Z)(t)?Math.min(l,t):l:t}let m=new Set;for(let t=0;t<r.colCount;t++)d.forEach(e=>{if(e<r.frozenRowCount){let i=(0,j.Z)(a.table,t,e);if(i)for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.row;e<=i.end.row;e++){let i=`${t}-${e}`;m.has(i)||((0,X.wW)(t,e,a.table,!1),m.add(i))}else(0,X.wW)(t,e,a.table,!1)}else if(e>r.rowCount-1||e<a.table.rowCount-a.table.bottomFrozenRowCount&&(e<a.proxy.rowStart||e>a.proxy.rowEnd))ir(e,a);else{let i=(0,j.Z)(a.table,t,e);if(i)for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.row;e<=i.end.row;e++){let i=`${t}-${e}`;m.has(i)||((0,X.wW)(t,e,a.table,!1),m.add(i))}else(0,X.wW)(t,e,a.table,!1)}});if(d.length){let t=il(d[0]-1,d[d.length-1]+1,a);l=(0,y.Z)(l)?(0,y.Z)(t)?Math.min(l,t):l:t}if((0,$.Z)(s)){for(let t=0;t<Math.max(r.colCount,null!=(c=r.internalProps._oldColCount)?c:r.colCount);t++)for(let e=s;e<Math.max(r.rowCount,null!=(p=r.internalProps._oldRowCount)?p:r.rowCount);e++){let i=a.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}l=(0,y.Z)(l)?(0,y.Z)(s)?Math.min(l,s):l:s}if((0,$.Z)(l)&&(a.proxy.rowUpdatePos=Math.min(a.proxy.rowUpdatePos,l)),h.length){if(!(0,$.Z)(s)){let t=Math.min(...h);a.proxy.rowUpdatePos=Math.min(t,a.proxy.rowUpdatePos)}a.proxy.rowUpdateDirection="up",a.proxy.updateCellGroups(2*a.proxy.screenRowCount),b()}else o.length&&(function(t,e){if(e.table.isHasSeriesNumber())for(let i=t;i<=e.table.rowCount-1;i++)(0,X.wW)(0,i,e.table,!1)}(o[o.length-1],a),a.proxy.updateCellGroups(2*a.proxy.screenRowCount),b());a.proxy.progress();let v=r.getRowsHeight(r.frozenRowCount,r.rowCount-1-r.bottomFrozenRowCount);function b(){if((null==h?void 0:h[(null==h?void 0:h.length)-1])>=r.rowCount-r.bottomFrozenRowCount||(null==d?void 0:d[(null==d?void 0:d.length)-1])>=r.rowCount-r.bottomFrozenRowCount||(null==o?void 0:o[0])>=r.rowCount-r.bottomFrozenRowCount){for(let t=0;t<r.colCount;t++)for(let e=r.rowCount-r.bottomFrozenRowCount;e<r.rowCount;e++){let i=a.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}a.proxy.updateBottomFrozenCellGroups()}}a.updateContainerHeight(a.table.frozenRowCount,v-a.bodyGroup.attribute.height)}(t,e,i,this.table,n),r&&this.recalculateColWidths(),"adaptive"===this.table.heightMode||this.table.autoFillHeight&&(this.table.getAllRowsHeight()<=this.table.tableNoFrameHeight||a))this.table.scenegraph.recalculateRowHeights();else if(this.table.isAutoRowHeight(this.table.columnHeaderLevelCount))for(let t=0;t<s.length;t++){let e=s[t],i=this.table.rowHeightsMap.get(e),r=(0,te.P)(e,0,this.table.colCount-1,this.table);(e>=this.proxy.rowStart&&e<=this.proxy.rowEnd||e>=this.table.rowCount-this.table.bottomFrozenRowCount&&e<=this.table.rowCount-1)&&this.table.scenegraph.updateRowHeight(e,r-i)}this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCol(t,e,i=[]){(function(t,e,i,r){var n,l;let s;eQ(r)&&eK(r);let a=r.scenegraph,o=ik(t.map(t=>t.col)).sort((t,e)=>e-t),h=ik(e.map(t=>t.col)).sort((t,e)=>t-e),d=ik(i.map(t=>t.col)).sort((t,e)=>t-e);o.forEach(t=>{!function(t,e){let i=e.proxy;if(t>=e.table.rowHeaderLevelCount)if(t>=e.table.colCount-e.table.rightFrozenColCount);else{let i=e.getColGroup(t,!1);i&&i.parent===e.bodyGroup&&e.bodyGroup.removeChild(i);let r=e.getColGroupInBottom(t);r&&r.parent===e.bottomFrozenGroup&&e.bottomFrozenGroup.removeChild(r);let n=e.getColGroup(t,!0);n&&n.parent===e.colHeaderGroup&&e.colHeaderGroup.removeChild(n)}t>=i.colStart&&t<=i.colEnd&&(i.colEnd--,i.currentCol--),i.bodyRightCol--;let r=Math.min(i.colLimit,i.bodyRightCol-i.bodyLeftCol+1);i.totalActualBodyColCount=r,i.totalCol=i.colStart+r-1}(t,a)});let u=r.colWidthsMap;o.forEach(t=>{u.delAndReorder(t)}),o.length&&iR(a),a.table._clearColRangeWidthsMap(),h.forEach(t=>{let e=function(t,e){let i=e.proxy;i.bodyRightCol++;let r=Math.min(i.colLimit,i.bodyRightCol-i.bodyLeftCol+1);if(i.totalActualBodyColCount=r,i.totalCol=i.colStart+r-1,!(t<i.colStart))return t>i.colEnd?i.colEnd-i.colStart+1<i.colLimit?(i.colEnd++,i.currentCol++,iP(t,e),t):void 0:(i.colEnd-i.colStart+1<i.colLimit&&(i.colEnd++,i.currentCol++,iP(t,e)),t)}(t,a);iR(a),s=null!=s?s:e,u.addAndReorder(t)}),function(t){let e=t.bodyColStart,i=t.getCellGroupX(e);function r(i){i.col=e;let r=(0,j.Z)(t.table,i.col,i.row);r&&(i.mergeStartCol=r.start.col,i.mergeStartCol=r.start.col,i.mergeEndCol=r.end.col,i.mergeEndCol=r.end.col),i.role}t.bodyGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.bodyColStart,i=t.getCellGroupX(e),t.colHeaderGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.bodyColStart,i=t.getCellGroupX(e),t.bottomFrozenGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.table.colCount-t.table.rightFrozenColCount,i=0,t.rightFrozenGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.table.colCount-t.table.rightFrozenColCount,i=0,t.rightTopCornerGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++}),e=t.table.colCount-t.table.rightFrozenColCount,i=0,t.rightBottomCornerGroup.forEachChildren(t=>{t.col=e,null==t||t.forEachChildren(t=>{r(t)}),t.setAttribute("x",i),i+=t.attribute.width,e++})}(a);let c=new Set;if(d.forEach(t=>{for(let e=0;e<r.rowCount;e++){let i=(0,j.Z)(a.table,t,e);if(i)for(let t=i.start.col;t<=i.end.col;t++)for(let t=i.start.col;t<=i.end.col;t++){let i=`${t}-${e}`;c.has(i)||((0,X.wW)(t,e,a.table,!1),c.add(i))}else(0,X.wW)(t,e,a.table,!1)}}),(0,$.Z)(s)){for(let t=s;t<Math.max(r.colCount,null!=(n=r.internalProps._oldColCount)?n:r.colCount);t++)for(let e=0;e<Math.max(r.rowCount,null!=(l=r.internalProps._oldRowCount)?l:r.rowCount);e++){let i=a.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}a.proxy.colUpdatePos=s}if(h.length){if(!(0,$.Z)(s)){let t=Math.min(...h);a.proxy.colUpdatePos=t}a.proxy.colUpdateDirection="left",a.proxy.updateColGroups(2*a.proxy.screenColCount),g(),a.proxy.progress()}else o.length&&(a.proxy.updateColGroups(2*a.proxy.screenColCount),g(),a.proxy.progress());let p=r.getColsWidth(r.frozenColCount,r.colCount-1);function g(){if((null==h?void 0:h[(null==h?void 0:h.length)-1])>=r.colCount-r.rightFrozenColCount||(null==d?void 0:d[(null==d?void 0:d.length)-1])>=r.colCount-r.rightFrozenColCount||(null==o?void 0:o[0])>=r.colCount-r.rightFrozenColCount){for(let t=r.colCount-r.rightFrozenColCount;t<r.colCount;t++)for(let e=0;e<r.rowCount;e++){let i=a.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}a.proxy.updateRightFrozenCellGroups()}}a.updateContainerWidth(a.table.frozenColCount,p-a.bodyGroup.attribute.width)})(t,e,i,this.table),this.recalculateColWidths(),this.recalculateRowHeights(),this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCornerHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=0;e<this.table.frozenRowCount;e++)(0,X.wW)(t,e,this.table,!1)}updateRowHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=this.table.frozenRowCount;e<this.table.rowCount;e++)(0,X.wW)(t,e,this.table,!1)}updateColumnHeaderCells(){for(let t=0;t<this.table.frozenRowCount;t++)for(let e=this.table.frozenColCount;e<this.table.colCount;e++)(0,X.wW)(e,t,this.table,!1)}getColumnGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupY(t){return t<this.table.frozenRowCount?this.table.getRowsHeight(0,t-1):t<this.table.rowCount-this.table.bottomFrozenRowCount?this.table.getRowsHeight(this.table.columnHeaderLevelCount,t-1):t<this.table.rowCount?this.table.getRowsHeight(this.table.rowCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.rightFrozenColCount,t-1):0}updateDomContainer(){!function(t){let{headerDomContainer:e,bodyDomContainer:i,frozenBodyDomContainer:r,frozenHeaderDomContainer:n,rightFrozenBodyDomContainer:l,rightFrozenHeaderDomContainer:s,bottomDomContainer:a,frozenBottomDomContainer:o,rightFrozenBottomDomContainer:h}=t.internalProps;if(!(e||i||r||n||l||s||a||o||h))return;let d=t.getAllColsWidth(),u=Math.min(d,t.tableNoFrameWidth),c=t.getFrozenColsWidth(),p=t.getRightFrozenColsWidth(),g=c+p,f=Math.min(d-g,u-g),m=t.getAllRowsHeight(),y=Math.min(m,t.tableNoFrameHeight),v=t.getFrozenRowsHeight(),b=t.getBottomFrozenRowsHeight(),_=v+b,C=Math.min(m-_,y-_);t.frozenColCount>0?(e.style.left=`${t.tableX+c}px`,i.style.left=`${t.tableX+c}px`,a.style.left=`${t.tableX+c}px`):0===t.frozenColCount&&(e.style.left=`${t.tableX}px`,i.style.left=`${t.tableX}px`,a.style.left=`${t.tableX}px`),r.style.left=`${t.tableX}px`,n.style.left=`${t.tableX}px`,e.style.width=`${f}px`,e.style.height=`${v}px`,i.style.top=`${t.tableY}px`,i.style.width=`${f}px`,i.style.height=`${C}px`,i.style.top=`${t.tableY+v}px`,r.style.width=`${c}px`,r.style.height=`${C}px`,r.style.top=`${t.tableY+v}px`,n.style.width=`${c}px`,n.style.height=`${v}px`,n.style.top=`${t.tableY}px`,l.style.width=`${p}px`,l.style.height=`${C}px`,l.style.top=`${t.tableY+v}px`,l.style.left=t.tableX+u-p+"px",s.style.width=`${p}px`,s.style.height=`${v}px`,s.style.top=`${t.tableY}px`,s.style.left=t.tableX+u-p+"px",a.style.width=`${f}px`,a.style.height=`${b}px`,a.style.top=t.tableY+y-b+"px",o.style.width=`${c}px`,o.style.height=`${b}px`,o.style.top=t.tableY+y-b+"px",h.style.width=`${p}px`,h.style.height=`${b}px`,h.style.top=t.tableY+y-b+"px",h.style.left=t.tableX+u-p+"px"}(this.table)}setLoadingHierarchyState(t,e){let i=this.getCell(t,e),r=i.getChildByName("collapse",!0)||i.getChildByName("expand",!0);if(r){let i=tb.U2()[N.up.loadingIconName];i&&(0,Q.Bg)(i,r,t,e)}}temporarilyUpdateSelectRectStyle(t){let{selectedRangeComponents:e}=this;e.forEach((e,i)=>{e.rect.setAttributes(t)}),this.updateNextFrame()}resetSelectRectStyle(){this.recreateAllSelectRangeComponents()}}function iE(t,e,i){let r=t.highPerformanceGetCell(e,i);if("cell"===r.role&&(0,y.Z)(r.mergeStartCol)&&(0,y.Z)(r.mergeStartRow)&&(0,y.Z)(r.mergeEndCol)&&(0,y.Z)(r.mergeEndRow)){let{colStart:e,colEnd:i,rowStart:n,rowEnd:l}=(0,ti.e)(r,t);for(let r=e;r<=i;r++)for(let e=n;e<=l;e++){let i=t.highPerformanceGetCell(r,e);"cell"===i.role&&i.addUpdateBoundTag()}}else r.addUpdateBoundTag()}function iL(t,e,i,r,n){let l=t.table;for(let i=0;i<l.columnHeaderLevelCount;i++)iE(t,e,i);let s=t.getColGroup(e);return null==s||s.addUpdateBoundTag(),!0}function iF(t,e,i,r,n,l){let s=t.table;for(let i=0;i<s.columnHeaderLevelCount;i++)iE(t,e,i);let a=t.getColGroup(e);return null==a||a.addUpdateBoundTag(),!0}function iO(t,e,i,r,n){let l=t.table;for(let e=0;e<l.colCount;e++)iE(t,e,i);return!0}function iH(t,e,i,r,n,l){let s=t.table;for(let e=0;e<s.colCount;e++)iE(t,e,i);return!0}function iD(t,e,i,r,n){return n._getLayoutCellId(t,e)===n._getLayoutCellId(i,r)}var iz=i(11725),iW=i(63401),iZ=i(80971),iN=i(92158);function ij(t,e,i,r,n){for(let i=t;i<=e;i++)n._clearColRangeWidthsMap(i);for(let t=i;t<=r;t++)n._clearRowRangeHeightsMap(t)}function iG(t){var e;if(!t)return;let i=(null==(e=t.role)?void 0:e.startsWith("icon"))?t:"richtext"===t.type?t._currentHoverIcon:void 0;return i?"richtext"===t.type?{icon:i,position:{left:t.globalAABBBounds.x1+i.globalAABBBounds.x1,right:t.globalAABBBounds.x1+i.globalAABBBounds.x2,top:t.globalAABBBounds.y1+i.globalAABBBounds.y1,bottom:t.globalAABBBounds.y1+i.globalAABBBounds.y2,width:i.globalAABBBounds.x2-i.globalAABBBounds.x1,height:i.globalAABBBounds.y2-i.globalAABBBounds.y1},type:"richtext-icon"}:{icon:i,position:{left:i.globalAABBBounds.x1,right:i.globalAABBBounds.x2,top:i.globalAABBBounds.y1,bottom:i.globalAABBBounds.y2,width:i.globalAABBBounds.x2-i.globalAABBBounds.x1,height:i.globalAABBBounds.y2-i.globalAABBBounds.y1},type:"icon"}:void 0}var iV=i(97779);function iU(t,e){"adaptive"===e.table.widthMode&&e.columnResize.col<e.table.colCount-1?(e.table.scenegraph.updateColWidth(e.columnResize.col,t),e.table.scenegraph.updateColWidth(e.columnResize.col+1,-t),e.table.internalProps._widthResizedColMap.add(e.columnResize.col),e.table.internalProps._widthResizedColMap.add(e.columnResize.col+1)):(e.table.scenegraph.updateColWidth(e.columnResize.col,t),e.table.internalProps._widthResizedColMap.add(e.columnResize.col))}var iK=i(54396),iX=i(87474);function iY(t,e){"adaptive"===e.table.heightMode&&e.rowResize.row<e.table.rowCount-1?(e.table.scenegraph.updateRowHeight(e.rowResize.row,t),e.table.scenegraph.updateRowHeight(e.rowResize.row+1,-t),e.table.internalProps._heightResizedRowMap.add(e.rowResize.row),e.table.internalProps._heightResizedRowMap.add(e.rowResize.row+1)):(e.table.scenegraph.updateRowHeight(e.rowResize.row,t),e.table.internalProps._heightResizedRowMap.add(e.rowResize.row))}function i$(t,e,i,r,n,l,s,a,o){var h,d,u,c;let p=Math.min(e,r),g=Math.min(i,n),f=Math.max(e,r),m=Math.max(i,n),y=t.highPerformanceGetCell(p,g).globalAABBBounds,v=(0,tc.f)({pickable:!1,fill:null!=(h=o.cellBgColor)&&h,lineWidth:null!=(d=o.cellBorderLineWidth)?d:0,lineDash:null!=(u=o.cellBorderLineDash)?u:[],stroke:a.map(t=>!!t&&o.cellBorderColor),x:y.x1-t.tableGroup.attribute.x,y:y.y1-t.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:e8(l,null==(c=t.table.theme.frameStyle)?void 0:c.cornerRadius,e,i,r,n,t.table)});t.customSelectedRangeComponents.set(`${p}-${g}-${f}-${m}-${s}`,{rect:v,role:l}),t.tableGroup.insertAfter(v,"body"===l?t.bodyGroup:"columnHeader"===l?t.colHeaderGroup:"rowHeader"===l?t.rowHeaderGroup:"cornerHeader"===l?t.cornerHeaderGroup:"rightTopCorner"===l?t.rightTopCornerGroup:"rightFrozen"===l?t.rightFrozenGroup:"leftBottomCorner"===l?t.leftBottomCornerGroup:"bottomFrozen"===l?t.bottomFrozenGroup:t.rightBottomCornerGroup)}class iq{constructor(t){this.fastScrolling=!1,this.checkedState=new Map,this.headerCheckedState={},this._checkboxCellTypeFields=[],this._headerCheckFuncs={},this.radioState={},this.resetInteractionState=(0,iV.D)(t=>{this.updateInteractionState(null!=t?t:P.F.default)},100),this.table=t,this.initState(),this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this)}initState(){this._initState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}updateOptionSetState(){this._updateOptionSetState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}_updateOptionSetState(){this.interactionState=P.F.default,this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,rowSourceSize:0,rowTargetSize:0,x:0,y:0,moving:!1,movingColumnOrRow:void 0},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new iW.YZ,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}_initState(){this.interactionState=P.F.default,this.select={highlightScope:P.p.single,ranges:[],cellPos:{col:-1,row:-1},selecting:!1},this.fillHandle={isFilling:!1,startX:void 0,startY:void 0},this.hover={highlightScope:P.p.single,cellPos:{col:-1,row:-1}},this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,rowSourceSize:0,rowTargetSize:0,x:0,y:0,moving:!1,movingColumnOrRow:void 0},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new iW.YZ,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.scroll={horizontalBarPos:0,verticalBarPos:0},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}setHoverState(){var t;let{highlightMode:e,disableHover:i,disableHeaderHover:r}=null!=(t=this.table.options.hover)?t:{highlightMode:"cell"};i?this.hover.highlightScope=P.p.none:"cross"===e?this.hover.highlightScope=P.p.cross:"row"===e?this.hover.highlightScope=P.p.row:"column"===e?this.hover.highlightScope=P.p.column:"cell"===e&&(this.hover.highlightScope=P.p.single),this.hover.singleStyle=!i,this.hover.disableHeader=r,(this.hover.highlightScope===P.p.none||r)&&(this.hover.cellPosContainHeader={col:-1,row:-1})}setSelectState(){var t,e,i,r,n,l;let{headerSelectMode:s,disableSelect:a,disableHeaderSelect:o,highlightMode:h,highlightInRange:d}=Object.assign({},{headerSelectMode:"inline",disableSelect:!1,disableHeaderSelect:!1,highlightMode:"cell",highlightInRange:!1},this.table.options.select),u=(null==(t=this.table.options.select)?void 0:t.cornerHeaderSelectMode)?null==(e=this.table.options.select)?void 0:e.cornerHeaderSelectMode:"body"===(null==(i=this.table.options.select)?void 0:i.headerSelectMode)?null==(r=this.table.options.select)?void 0:r.headerSelectMode:"all";this.select.highlightScope=!0===a?P.p.none:"cross"===h?P.p.cross:"row"===h?P.p.row:"column"===h?P.p.column:P.p.single,this.select.singleStyle=!a,this.select.disableHeader=o,this.select.headerSelectMode=s,this.select.cornerHeaderSelectMode=u,this.select.highlightInRange=d,this.select.disableCtrlMultiSelect=!1===(null==(n=this.table.options.keyboardOptions)?void 0:n.ctrlMultiSelect),this.select.disableShiftMultiSelect=!1===(null==(l=this.table.options.keyboardOptions)?void 0:l.shiftMultiSelect)}isSelected(t,e){let i=!1;return this.select.ranges.forEach(r=>{(0,B._Z)(r,t,e)&&(i=!0)}),i}setSortState(t){let e=this,i=(t=!t||Array.isArray(t)?t:[t])&&t.reduce((t,i)=>{var r,n,l;let s=null==(r=function(t){let i=[];return function t(r,n=0){r.forEach(r=>{var l;let s=r.startInTotal?null!=(l=r.startInTotal+e.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?l:0:n;r.columns?t(r.columns,s):i.push(Object.assign(Object.assign({},r),{startIndex:s}))})}(t),i}(this.table.internalProps.columns))?void 0:r.find(t=>(null==t?void 0:t.field)===(null==i?void 0:i.field));return this.table.internalProps.transpose?t.push({field:i.field,order:i.order,row:null!=(n=(null==s?void 0:s.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?n:0,col:null==s?void 0:s.level}):t.push({field:i.field,order:i.order,col:null!=(l=(null==s?void 0:s.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?l:0,row:null==s?void 0:s.level}),t},[]);this.sort=i||[]}setFrozenState(){this.frozen.col=this.table.frozenColCount-1}updateInteractionState(t){if(this.interactionState===t)return;t===P.F.scrolling&&(this.interactionStateBeforeScroll=this.interactionState);let e=this.interactionState;this.interactionState=t,e===P.F.scrolling&&P.F.default}updateHoverhighlightScope(t){this.hover.highlightScope!==t&&(this.hover.highlightScope=t)}updateHoverPos(t,e){!function(t,e,i){var r;let{table:n}=t,{scenegraph:l}=n,{highlightScope:s,singleStyle:a,disableHeader:o,cellPos:h,cellPosContainHeader:d}=t.hover,u=h.col,c=h.row;if(s===P.p.none||o&&(d.col!==e||d.row!==i)){let t=d.col,r=d.row;l.hideHoverIcon(t,r),l.showHoverIcon(e,i),d.col=e,d.row=i}if((o&&n.isHeader(e,i)||s===P.p.none)&&(e=-1,i=-1),u===e&&c===i)return;h.col=e,h.row=i,(null==(r=t.table.options.customConfig)?void 0:r.disableBuildInChartActive)||(l.deactivateChart(u,c),l.activateChart(e,i));let p=!1,{ranges:g,highlightScope:f}=t.select;if(-1!==u&&-1!==c&&(p=function(t,e,i,r,n,l,s){let a=!1;return l===P.p.single?(iE(t,e,i),a=!0):l===P.p.row?a=!!iO(t,e,i,r,s)||a:l===P.p.column?a=!!iL(t,e,i,r,s)||a:l===P.p.cross&&(a=!!iO(t,e,i,r,s)||a,a=!!iL(t,e,i,r,s)||a),a}(l,u,c,g,0,s,f),o||l.hideHoverIcon(u,c)),-1===e||-1===i)return h.col=-1,h.row=-1,!p||u===e&&c===i||t.table.scenegraph.updateNextFrame();s===P.p.single?(iE(l,e,i),p=!0):s===P.p.row?p=!!iH(l,e,i,g,f,a)||p:s===P.p.column?p=!!iF(l,e,i,g,f,a)||p:s===P.p.cross&&(p=!!iH(l,e,i,g,f,a)||p,p=!!iF(l,e,i,g,f,a)||p),s===P.p.none||o||l.showHoverIcon(e,i),p&&t.table.scenegraph.updateNextFrame()}(this,t,e)}updateSelectPos(t,e,i=!1,r=!1,n=!1,l=!0,s=!1){-1!==e&&-1!==e&&(this.select.selecting=!0),t<0&&(t=-1),e<0&&(e=-1),t>this.table.colCount-1&&(t=this.table.colCount-1),e>this.table.rowCount-1&&(e=this.table.rowCount-1);let a=this.select.cellPos.col,o=this.select.cellPos.row;(function(t,e,i,r,n,l,s=!0,a=!1){var o,h;let{table:d,interactionState:u}=t,{scenegraph:c}=d,{cellPos:p}=t.select;if(t.select.isSelectAll=l,-1!==e&&-1!==i&&s&&d._makeVisibleCell(e,i),-1!==e&&-1!==i&&s)if(u===P.F.grabing&&t.select.ranges.length>0){let r=t.select.ranges[t.select.ranges.length-1];e>r.start.col&&e>r.end.col&&d._makeVisibleCell(e+1,i),i>r.start.row&&i>r.end.row&&d._makeVisibleCell(e,i+1),e<r.start.col&&e<r.end.col&&d._makeVisibleCell(e-1,i),i<r.start.row&&i<r.end.row&&d._makeVisibleCell(e,i-1)}else d._makeVisibleCell(e,i);if(l){t.select.ranges=[],c.deleteAllSelectBorder();let e=0,i=0,{disableHeaderSelect:r,disableRowSeriesNumberSelect:n}=(null==(o=d.options.keyboardOptions)?void 0:o.selectAllOnCtrlA)||{};r&&(e=d.rowHeaderLevelCount,i=d.columnHeaderLevelCount),(n||r&&d.transpose)&&d.options.rowSeriesNumber&&(e+=1),t.select.ranges.push({start:{col:e,row:i},end:{col:d.colCount-1,row:d.rowCount-1}});let l=t.select.ranges[t.select.ranges.length-1];c.updateCellSelectBorder(l,!1)}else if(-1===p.col||-1===p.row||-1!==e&&-1!==i)if(u!==P.F.default||d.eventManager.isDraging||d.stateManager.isResizeCol()){if((u===P.F.grabing||d.eventManager.isDraging)&&!d.stateManager.isResizeCol()){let r=!0;-1===p.col&&(p.col=e),-1===p.row&&(p.row=i),p.col=e,p.row=i;let n=t.select.ranges[t.select.ranges.length-1];if(n){if(d.internalProps.layoutMap.isSeriesNumberInBody(n.start.col,n.start.row))r=!1,n.end={col:d.colCount-1,row:i};else if(t.fillHandle.isFilling){if("top"===t.fillHandle.direction)if(i===t.fillHandle.beforeFillMinRow&&i===t.fillHandle.beforeFillMaxRow)n.start.row=n.end.row=i;else if(i<=t.fillHandle.beforeFillMinRow){if(n.start.row<n.end.row){let t=n.start.row;n.start.row=n.end.row,n.end.row=t}n.end.row=i}else i===t.fillHandle.beforeFillMaxRow&&(n.start.row>n.end.row?n.start.row=i:n.end.row=i);else if("bottom"===t.fillHandle.direction){if(i>=t.fillHandle.beforeFillMaxRow){if(n.start.row>n.end.row){let t=n.start.row;n.start.row=n.end.row,n.end.row=t}n.end.row=i}}else if("left"===t.fillHandle.direction)if(e===t.fillHandle.beforeFillMinCol&&e===t.fillHandle.beforeFillMaxCol)n.start.col=n.end.col=e;else if(e<=t.fillHandle.beforeFillMinCol){if(n.start.col<n.end.col){let t=n.start.col;n.start.col=n.end.col,n.end.col=t}n.end.col=e}else e===t.fillHandle.beforeFillMaxCol&&(n.start.col>n.end.col?n.start.col=e:n.end.col=e);else if("right"===t.fillHandle.direction&&e>=t.fillHandle.beforeFillMaxCol){if(n.start.col>n.end.col){let t=n.start.col;n.start.col=n.end.col,n.end.col=t}n.end.col=e}}else{n.end={col:e,row:i};let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:d.getCellRange(e,i);n.start.col<r.end.col?n.end.col=r.end.col:n.start.col>r.start.col&&(n.end.col=r.start.col),n.start.row<r.end.row?n.end.row=r.end.row:n.start.row>r.start.row&&(n.end.row=r.start.row),"body"===t.select.headerSelectMode&&(d.isRowHeader(e,i)?(n.start.col=d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,n.end.col=d.colCount-1):d.isColumnHeader(e,i)?(n.start.row=d.columnHeaderLevelCount,n.end.row=d.rowCount-1):d.internalProps.layoutMap.isSeriesNumberInBody(e,i)?(n.start.col=d.leftRowSeriesNumberCount,n.end.col=d.colCount-1):d.isCornerHeader(e,i)?(n.start.col=d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,n.start.row=d.columnHeaderLevelCount,n.end.col=d.colCount-1,n.end.row=d.rowCount-1):d.isSeriesNumber(e,i)&&(n.start.col=d.leftRowSeriesNumberCount,n.start.row=d.columnHeaderLevelCount,n.end.col=d.colCount-1,n.end.row=d.rowCount-1)),a&&(n.skipBodyMerge=!0)}n&&n.start.row<=d.rowCount-1&&n.end.row<=d.rowCount-1&&n.start.col<=d.colCount-1&&n.end.col<=d.colCount-1&&c.updateCellSelectBorder(n,r)}}}else{let l=t.select.ranges[t.select.ranges.length-1];if(r&&l){if("cell"!==t.select.headerSelectMode&&d.isColumnHeader(e,i)){let r=Math.min(l.start.col,l.end.col,e),n=Math.max(l.start.col,l.end.col,e),s=Math.min(l.start.row,l.end.row,i),a=d.rowCount-1;"body"===t.select.headerSelectMode?(l.start={col:r,row:d.columnHeaderLevelCount},l.end={col:n,row:d.rowCount-1}):(l.start={col:r,row:s},l.end={col:n,row:a})}else if("cell"!==t.select.headerSelectMode&&d.isRowHeader(e,i)){let r=Math.min(l.start.col,l.end.col,e),n=d.colCount-1,s=Math.min(l.start.row,l.end.row,i),a=Math.max(l.start.row,l.end.row,i);"body"===t.select.headerSelectMode?(l.start={col:d.leftRowSeriesNumberCount+d.rowHeaderLevelCount,row:s},l.end={col:d.colCount-1,row:a}):(l.start={col:r,row:s},l.end={col:n,row:a})}else if("cell"!==t.select.headerSelectMode&&d.isSeriesNumberInBody(e,i)){let r=Math.min(l.start.col,l.end.col,e),n=d.colCount-1,s=Math.min(l.start.row,l.end.row,i),a=Math.max(l.start.row,l.end.row,i);"body"===t.select.headerSelectMode?(l.start={col:d.leftRowSeriesNumberCount,row:s},l.end={col:d.colCount-1,row:a}):(l.start={col:r,row:s},l.end={col:n,row:a})}else l.end={col:e,row:i};r||(l.end=l.start),c.deleteLastSelectedRangeComponents(),c.updateCellSelectBorder(l)}else{let r=!0;if(-1===p.col||-1===p.row||n||(t.select.ranges=[],c.deleteAllSelectBorder()),"cell"!==t.select.headerSelectMode&&d.isColumnHeader(e,i)){let r=d.getCellRange(e,i);"body"===t.select.headerSelectMode?t.select.ranges.push({start:{col:r.start.col,row:d.columnHeaderLevelCount},end:{col:r.end.col,row:d.rowCount-1},skipBodyMerge:!0}):t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:d.rowCount-1},skipBodyMerge:!0})}else if("cell"!==t.select.headerSelectMode&&d.isRowHeader(e,i)){let r=d.getCellRange(e,i);"body"===t.select.headerSelectMode?t.select.ranges.push({start:{col:d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,row:r.start.row},end:{col:d.colCount-1,row:r.end.row},skipBodyMerge:!0}):t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:d.colCount-1,row:r.end.row},skipBodyMerge:!0})}else if(d.internalProps.layoutMap.isSeriesNumberInHeader(e,i)){r=!1;let{cornerHeaderSelectMode:n}=t.select;if("body"===n)t.select.ranges.push({start:{col:d.leftRowSeriesNumberCount,row:d.columnHeaderLevelCount},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0});else if("inline"===n){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:d.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:d.rowCount-1},skipBodyMerge:!0})}else if("cell"===n){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:d.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:r.end.row},skipBodyMerge:a||void 0})}else t.select.ranges.push({start:{col:0,row:0},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0})}else if(d.internalProps.layoutMap.isSeriesNumberInBody(e,i))r=!1,"body"===t.select.headerSelectMode?t.select.ranges.push({start:{col:d.leftRowSeriesNumberCount,row:i},end:{col:d.colCount-1,row:i},skipBodyMerge:!0}):t.select.ranges.push({start:{col:e,row:i},end:{col:d.colCount-1,row:i},skipBodyMerge:!0});else if(d.internalProps.layoutMap.isCornerHeader(e,i)){r=!1;let{cornerHeaderSelectMode:n}=t.select;if("body"===n)t.select.ranges.push({start:{col:d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,row:d.columnHeaderLevelCount},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0});else if("cell"===n){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:d.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:r.end.row},skipBodyMerge:a||void 0})}else if("inline"===n){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:d.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:d.rowCount-1},skipBodyMerge:!0})}else t.select.ranges.push({start:{col:d.leftRowSeriesNumberCount,row:0},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0})}else if(e>=0&&i>=0){let r=a?{start:{col:e,row:i},end:{col:e,row:i}}:d.getCellRange(e,i);t.select.ranges.push({start:{col:r.start.col,row:r.start.row},end:{col:r.end.col,row:r.end.row},skipBodyMerge:a||void 0})}p.col=e,p.row=i;let l=null==(h=t.select.ranges)?void 0:h[t.select.ranges.length-1];l&&l.start.row<=d.rowCount-1&&l.end.row<=d.rowCount-1&&l.start.col<=d.colCount-1&&l.end.col<=d.colCount-1&&c.updateCellSelectBorder(l,r)}}else p.col=-1,p.row=-1,t.select.ranges=[],c.deleteAllSelectBorder();c.updateNextFrame()})(this,t,e,i,r,n,l,s),this.table.hasListeners(I.B.SELECTED_CHANGED)&&(a!==t||o!==e)&&this.table.fireListeners(I.B.SELECTED_CHANGED,{ranges:this.select.ranges,col:t,row:e})}checkCellRangeInSelect(t,e){return function(t,e,i,r){for(let r=0;r<i.length;r++){let n=i[r];if((0,B.ib)(n,{start:t,end:e}))return!0}return!1}(t,e,this.select.ranges,this.select.highlightScope)}updateHoverIcon(t,e,i,r){var n,l,s,a,o,h,d,u,c;if((null==(n=this.residentHoverIcon)?void 0:n.icon)&&i===(null==(l=this.residentHoverIcon)?void 0:l.icon))return;let p=iG(i);if(p)if("richtext-icon"===p.type){let i=p.icon;if(this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(a=this.residentHoverIcon)?void 0:a.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame()),i.attribute.tooltip){let r={content:i.attribute.tooltip.title,referencePosition:{rect:p.position,placement:i.attribute.tooltip.placement},style:Object.assign({},null==(o=this.table.internalProps.theme)?void 0:o.tooltipStyle,null==(h=i.tooltip)?void 0:h.style,null==(u=null==(d=i.attribute)?void 0:d.tooltip)?void 0:u.style),disappearDelay:i.attribute.tooltip.disappearDelay};this.table.internalProps.tooltipHandler.isBinded(r)||this.table.showTooltip(t,e,r)}}else{let i=p.icon;i!==this.hoverIcon.icon&&(this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(c=this.residentHoverIcon)?void 0:c.icon)&&this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=t,this.hoverIcon.row=e,this.hoverIcon.icon=i,this.table.scenegraph.setIconHoverStyle(i,t,e,r),this.table.scenegraph.updateNextFrame())}else this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(s=this.residentHoverIcon)?void 0:s.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame())}isResizeCol(){return this.columnResize.resizing}isResizeRow(){return this.rowResize.resizing}isFillHandle(){return this.fillHandle.isFilling}isSelecting(){return this.select.selecting}endSelectCells(t=!0,e=!0){if(this.select.selecting){if(this.select.selecting=!1,0===this.select.ranges.length)return;let e=this.select.ranges[this.select.ranges.length-1];this.table.isSeriesNumber(this.select.cellPos.col,this.select.cellPos.row)||this.table.isHeader(this.select.cellPos.col,this.select.cellPos.row)||this.table.isSeriesNumberInBody(e.start.col,e.start.row)||(0,ti.T)(e,this.table);let i=!1;for(let t=0;t<this.select.ranges.length-1;t++){let r=this.select.ranges[t];if(r&&r.start.col===e.start.col&&r.start.row===e.start.row&&r.end.col===e.end.col&&r.end.row===e.end.row){i=!0;break}}i?(this.select.ranges.pop(),ie(this.table.scenegraph),this.table.scenegraph.selectingRangeComponents.clear()):this.table.scenegraph.moveSelectingRangeComponentsToSelectedRangeComponents();let r=this.select.ranges[this.select.ranges.length-1].end.col,n=this.select.ranges[this.select.ranges.length-1].end.row;t&&this.table.fireListeners(I.B.SELECTED_CELL,{ranges:this.select.ranges,col:r,row:n})}else e&&0===this.select.ranges.length&&this.table.fireListeners(I.B.SELECTED_CLEAR,{})}endResizeCol(){setTimeout(()=>{this.columnResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeColWidth(this.columnResize.col),this.checkFrozen(),this.table.scenegraph.component.hideResizeCol(),this.table.scenegraph.updateNextFrame()}startResizeCol(t,e,i,r){this.columnResize.resizing=!0,this.columnResize.col=t,this.columnResize.x=e,this.columnResize.isRightFrozen=r,this.table.scenegraph.component.showResizeCol(t,i,r),this.table.scenegraph.updateNextFrame()}updateResizeCol(t,e){!function(t,e,i){var r;t=Math.ceil(t),e=Math.ceil(e);let n=i.columnResize.isRightFrozen?i.columnResize.x-t:t-i.columnResize.x;if(1>Math.abs(n))return;let l=i.table.getColWidth(i.columnResize.col),s=l;s+=n;let a=i.table.getMinColWidth(i.columnResize.col),o=i.table.getMaxColWidth(i.columnResize.col);if(s<a||s>o){if(l===a||l===o)return;n=l-a>o-l?o-l:a-l}let h=i.table.getColWidth(i.columnResize.col)+n;if(h<i.table.internalProps.limitMinWidth&&(n=(h=i.table.internalProps.limitMinWidth)-i.table.getColWidth(i.columnResize.col)),"adaptive"===i.table.widthMode&&i.columnResize.col<i.table.colCount-1){let t=i.table.getColWidth(i.columnResize.col+1),e=i.table.getMinColWidth(i.columnResize.col+1),r=i.table.getMaxColWidth(i.columnResize.col+1),l=t;if((l-=n)<e||l>r){if(t===e||t===r)return;n=t-e>r-t?r-t:e-t}l-n<i.table.internalProps.limitMinWidth&&(n=l-i.table.internalProps.limitMinWidth)}n=Math.ceil(n),i.columnResize.col<i.table.rowHeaderLevelCount||i.columnResize.col>=i.table.colCount-i.table.rightFrozenColCount?iU(n,i):"indicator"===i.table.internalProps.columnResizeType?function(t,e){let i,r,n,l=e.table.internalProps.layoutMap;if(l.indicatorsAsCol)i=l.getIndicatorKey(e.columnResize.col,e.table.columnHeaderLevelCount);else{let t=l.getCellHeaderPaths(e.columnResize.col,e.table.columnHeaderLevelCount-1),i=t.colHeaderPaths[t.colHeaderPaths.length-1];r=i.dimensionKey,n=i.value}for(let s=e.table.rowHeaderLevelCount;s<e.table.colCount-e.table.rightFrozenColCount;s++){let a=l.getIndicatorKey(s,e.table.columnHeaderLevelCount);if(l.indicatorsAsCol&&a===i)e.table.scenegraph.updateColWidth(s,t),e.table.internalProps._widthResizedColMap.add(s);else if(!l.indicatorsAsCol){let i=l.getCellHeaderPaths(s,e.table.columnHeaderLevelCount-1),a=null==i?void 0:i.colHeaderPaths[i.colHeaderPaths.length-1];a&&r===a.dimensionKey&&n===a.value&&(e.table.scenegraph.updateColWidth(s,t),e.table.internalProps._widthResizedColMap.add(s))}}}(n,i):"indicatorGroup"===i.table.internalProps.columnResizeType?function(t,e){let i=e.table.internalProps.layoutMap,r=i.getCellHeaderPaths(e.columnResize.col,e.table.columnHeaderLevelCount),n=i.getHeadNodeByRowOrColDimensions(r.colHeaderPaths.slice(0,r.colHeaderPaths.length-1)),l=n.startInTotal+e.table.frozenColCount,s=n.startInTotal+e.table.frozenColCount+n.size-1,a=e.table.getColsWidth(l,s);for(let r=l;r<=s;r++){if(!(e.table.internalProps.transpose||e.table.isPivotTable()&&!i.indicatorsAsCol)){let t=i.getBody(r,e.table.columnHeaderLevelCount);if(null==t?void 0:t.disableColumnResize)continue}let n=e.table.getColWidth(r)/a*t;n>0&&n<.5?n=.5:n<0&&n>=-.5&&(n=-.5),e.table.scenegraph.updateColWidth(r,n),e.table.internalProps._widthResizedColMap.add(r)}}(n,i):"all"===i.table.internalProps.columnResizeType?function(t,e){let i=e.table.internalProps.layoutMap;for(let r=e.table.frozenColCount;r<e.table.colCount-e.table.rightFrozenColCount;r++){if(!(e.table.internalProps.transpose||e.table.isPivotTable()&&!i.indicatorsAsCol)){let t=i.getBody(r,e.table.columnHeaderLevelCount);if(null==t?void 0:t.disableColumnResize)continue}e.table.scenegraph.updateColWidth(r,t),e.table.internalProps._widthResizedColMap.add(r)}}(n,i):iU(n,i),i.columnResize.x=t,i.table.scenegraph.component.updateResizeCol(i.columnResize.col,e,i.columnResize.isRightFrozen),i.table._updateSize(),null==(r=i.table.internalProps.legends)||r.forEach(t=>{null==t||t.resize()}),i.table.internalProps.title&&i.table.internalProps.title.resize(),i.table.internalProps.emptyTip&&i.table.internalProps.emptyTip.resize(),!(i.columnResize.col<i.table.frozenColCount)||i.table.isPivotTable()||i.table.transpose?i.table.options.frozenColCount&&i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1):i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1,i.columnResize.isRightFrozen),(i.columnResize.col>=i.table.colCount-i.table.rightFrozenColCount&&!i.table.isPivotTable()&&!i.table.transpose||i.table.options.rightFrozenColCount)&&i.table.scenegraph.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount),i.table.scenegraph.updateNextFrame()}(t,e,this)}endResizeRow(){setTimeout(()=>{this.rowResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeRowHeight(this.rowResize.row),this.table.scenegraph.component.hideResizeRow(),this.table.scenegraph.updateNextFrame()}startResizeRow(t,e,i,r){this.rowResize.resizing=!0,this.rowResize.row=t,this.rowResize.y=i,this.rowResize.isBottomFrozen=r,this.table.scenegraph.component.showResizeRow(t,e,r),this.table.scenegraph.updateNextFrame()}updateResizeRow(t,e){!function(t,e,i){var r;t=Math.ceil(t),e=Math.ceil(e);let n=i.rowResize.isBottomFrozen?i.rowResize.y-e:e-i.rowResize.y;if(1>Math.abs(n))return;i.table.getRowHeight(i.rowResize.row);let l=i.table.getRowHeight(i.rowResize.row)+n;if(l<i.table.internalProps.limitMinHeight&&(n=(l=i.table.internalProps.limitMinHeight)-i.table.getRowHeight(i.rowResize.row)),"adaptive"===i.table.heightMode&&i.rowResize.row<i.table.rowCount-1){let t=i.table.getRowHeight(i.rowResize.row+1);(t-=n)-n<i.table.internalProps.limitMinHeight&&(n=t-i.table.internalProps.limitMinHeight)}n=Math.ceil(n),i.rowResize.row<i.table.columnHeaderLevelCount||i.rowResize.row>=i.table.rowCount-i.table.bottomFrozenRowCount?iY(n,i):"indicator"===i.table.internalProps.rowResizeType?function(t,e){var i,r;let n,l,s,a=e.table.internalProps.layoutMap;if(a.indicatorsAsCol){let t=a.getCellHeaderPaths(e.table.rowHeaderLevelCount-1,e.rowResize.row),r=null==(i=t.rowHeaderPaths)?void 0:i[t.rowHeaderPaths.length-1];l=null==r?void 0:r.dimensionKey,s=null==r?void 0:r.value}else n=a.getIndicatorKey(e.table.rowHeaderLevelCount,e.rowResize.row);for(let i=e.table.columnHeaderLevelCount;i<e.table.rowCount-e.table.bottomFrozenRowCount;i++){let o=a.getIndicatorKey(e.table.rowHeaderLevelCount,i);if(a.indicatorsAsCol||o!==n){if(a.indicatorsAsCol){let n=a.getCellHeaderPaths(e.table.rowHeaderLevelCount-1,i),o=null==(r=null==n?void 0:n.rowHeaderPaths)?void 0:r[n.rowHeaderPaths.length-1];o&&l===o.dimensionKey&&s===o.value&&(e.table.scenegraph.updateRowHeight(i,t),e.table.internalProps._heightResizedRowMap.add(i))}}else e.table.scenegraph.updateRowHeight(i,t),e.table.internalProps._heightResizedRowMap.add(i)}}(n,i):"indicatorGroup"===i.table.internalProps.rowResizeType?function(t,e){let i=e.table.internalProps.layoutMap,r=i.getCellHeaderPaths(e.table.rowHeaderLevelCount,e.rowResize.row),n=i.getHeadNodeByRowOrColDimensions(r.rowHeaderPaths.slice(0,r.rowHeaderPaths.length-1)),l=n.startInTotal+e.table.frozenRowCount,s=n.startInTotal+e.table.frozenRowCount+n.size-1,a=e.table.getRowsHeight(l,s);for(let i=l;i<=s;i++){let r=e.table.getRowHeight(i)/a*t;r>0&&r<.5?r=.5:r<0&&r>=-.5&&(r=-.51),e.table.scenegraph.updateRowHeight(i,r),e.table.internalProps._heightResizedRowMap.add(i)}}(n,i):"all"===i.table.internalProps.rowResizeType?function(t,e){for(let i=e.table.frozenRowCount;i<e.table.rowCount-e.table.bottomFrozenRowCount;i++)e.table.scenegraph.updateRowHeight(i,t),e.table.internalProps._heightResizedRowMap.add(i)}(n,i):iY(n,i),i.rowResize.y=e,i.table.scenegraph.component.updateResizeRow(i.rowResize.row,t,i.rowResize.isBottomFrozen),i.table._updateSize(),null==(r=i.table.internalProps.legends)||r.forEach(t=>{null==t||t.resize()}),i.table.internalProps.title&&i.table.internalProps.title.resize(),i.table.internalProps.emptyTip&&i.table.internalProps.emptyTip.resize(),i.table.scenegraph.updateNextFrame()}(t,e,this)}startFillSelect(t,e){this.fillHandle.isFilling=!0,this.fillHandle.startX=t,this.fillHandle.startY=e;let i=this.select.ranges[this.select.ranges.length-1];this.fillHandle.beforeFillMinCol=Math.min(i.start.col,i.end.col),this.fillHandle.beforeFillMinRow=Math.min(i.start.row,i.end.row),this.fillHandle.beforeFillMaxCol=Math.max(i.start.col,i.end.col),this.fillHandle.beforeFillMaxRow=Math.max(i.start.row,i.end.row),this.table.fireListeners(I.B.MOUSEDOWN_FILL_HANDLE,{})}endFillSelect(){this.fillHandle.isFilling=!1,this.fillHandle.startX=void 0,this.fillHandle.startY=void 0,this.fillHandle.directionRow=void 0;let t=Math.min(this.select.ranges[0].start.col,this.select.ranges[0].end.col),e=Math.min(this.select.ranges[0].start.row,this.select.ranges[0].end.row),i=Math.max(this.select.ranges[0].start.col,this.select.ranges[0].end.col),r=Math.max(this.select.ranges[0].start.row,this.select.ranges[0].end.row);this.fillHandle.beforeFillMinCol===t&&this.fillHandle.beforeFillMinRow===e&&this.fillHandle.beforeFillMaxCol===i&&this.fillHandle.beforeFillMaxRow===r||this.table.eventManager.isDraging&&this.table.fireListeners(I.B.DRAG_FILL_HANDLE_END,{direction:this.fillHandle.direction}),this.fillHandle.beforeFillMaxCol=void 0,this.fillHandle.beforeFillMaxRow=void 0,this.fillHandle.beforeFillMinCol=void 0,this.fillHandle.beforeFillMinRow=void 0}startMoveCol(t,e,i,r,n,l){!function(t,e,i,r,n,l,s){var a;let o;if(!("canMoveHeaderPosition"in n.table.internalProps.layoutMap))return;if(n.columnMove.movingColumnOrRow=s,n.columnMove.moving=!0,n.columnMove.colSource=t,n.columnMove.rowSource=e,n.table.isListTable()){let i=n.table.getRecordIndexByCell(t,e),r=n.table.getRecordByCell(t,e),l=n.table.getRecordHierarchyState(t,e);n.columnMove.rowSourceSize=(0,O.pr)(i,l,r)+1}if(n.columnMove.x=i-n.table.tableX,n.columnMove.y=r-n.table.tableY,"column"===s)o=n.columnMove.x;else if("row"===s)o=n.columnMove.y;else{let i=n.table.getCellLocation(t,e);o="columnHeader"===i?n.columnMove.x:"rowHeader"===i||n.table.internalProps.layoutMap.isSeriesNumberInBody(t,e)?n.columnMove.y:0}let{backX:h,lineX:d,backY:u,lineY:c}=n.table.scenegraph.component.showMoveCol(t,e,o);n.table.fireListeners(I.B.CHANGE_HEADER_POSITION_START,{col:t,row:e,x:i,y:r,backX:h,lineX:d,backY:u,lineY:c,event:l,movingColumnOrRow:s});let p=!!(null==(a=n.select.ranges)?void 0:a.length);n.table.stateManager.updateSelectPos(-1,-1),n.table.stateManager.endSelectCells(!0,p),n.table.scenegraph.updateNextFrame()}(t,e,i,r,this,n,l)}updateMoveCol(t,e,i,r,n){!function(t,e,i,r,n,l){if(!("canMoveHeaderPosition"in n.table.internalProps.layoutMap))return;let s=(0,iN.$Q)({col:n.columnMove.colSource,row:n.columnMove.rowSource},{col:t,row:e},n.table);if(n.table.internalProps.layoutMap.canMoveHeaderPosition({col:n.columnMove.colSource,row:n.columnMove.rowSource},{col:s.col,row:s.row})){let a,o,h,d;if(n.columnMove.x=i-n.table.tableX,n.columnMove.y=r-n.table.tableY,n.columnMove.colTarget=s.col,n.columnMove.rowTarget=s.row,n.table.isListTable()){let t=n.table.getRecordIndexByCell(s.col,s.row),e=n.table.getRecordByCell(s.col,s.row),i=n.table.getRecordHierarchyState(s.col,s.row);n.columnMove.rowTargetSize=(0,O.pr)(t,i,e)+1}n.updateCursor("grabbing");let u=n.table.getCellLocation(n.columnMove.colSource,n.columnMove.rowSource);"columnHeader"===u||"column"===n.columnMove.movingColumnOrRow&&0===n.columnMove.rowSource?(o=n.columnMove.x,a=n.table.isLeftFrozenColumn(t)?n.columnMove.colTarget>=n.columnMove.colSource?n.table.getColsWidth(0,n.columnMove.colTarget):n.table.getColsWidth(0,n.columnMove.colTarget-1):n.table.isRightFrozenColumn(t)?n.table.tableNoFrameWidth-n.table.getColsWidth(s.col+1,n.table.colCount-1):(n.columnMove.colTarget>=n.columnMove.colSource?n.table.getColsWidth(0,n.columnMove.colTarget):n.table.getColsWidth(0,n.columnMove.colTarget-1))-n.table.stateManager.scroll.horizontalBarPos):("rowHeader"===u||n.table.internalProps.layoutMap.isSeriesNumberInBody(t,e)||"row"===n.columnMove.movingColumnOrRow)&&(d=n.columnMove.y,h=n.table.isFrozenRow(e)?n.columnMove.rowTarget>=n.columnMove.rowSource?n.table.getRowsHeight(0,n.columnMove.rowTarget):n.table.getRowsHeight(0,n.columnMove.rowTarget-1):n.table.isBottomFrozenRow(e)?n.table.tableNoFrameHeight-n.table.getRowsHeight(s.row+1,n.table.rowCount-1):(n.columnMove.rowTarget>=n.columnMove.rowSource?n.table.getRowsHeight(0,n.columnMove.rowTarget):n.table.getRowsHeight(0,n.columnMove.rowTarget-1))-n.table.stateManager.scroll.verticalBarPos),n.table.scenegraph.component.updateMoveCol(o,a,d,h),n.table.fireListeners(I.B.CHANGING_HEADER_POSITION,{col:t,row:e,x:i,y:r,backX:o,lineX:a,backY:d,lineY:h,event:l,movingColumnOrRow:n.columnMove.movingColumnOrRow}),n.table.scenegraph.updateNextFrame()}else n.updateCursor("not-allowed"),n.columnMove.colTarget=n.columnMove.colSource,n.columnMove.rowTarget=n.columnMove.rowSource}(t,e,i,r,this,n)}isMoveCol(){return this.columnMove.moving}endMoveCol(){return function(t){var e,i;let r=!1;if("canMoveHeaderPosition"in t.table.internalProps.layoutMap&&t.columnMove.moving&&(t.columnMove.colSource>=0||"row"===t.columnMove.movingColumnOrRow)&&(t.columnMove.rowSource>=0||"column"===t.columnMove.movingColumnOrRow)&&(t.columnMove.colTarget>=0||"row"===t.columnMove.movingColumnOrRow)&&(t.columnMove.rowTarget>=0||"column"===t.columnMove.movingColumnOrRow)&&!0!==(null==(e=t.table.options.customConfig)?void 0:e.notUpdateInColumnRowMove)){let e=t.table.getCellRange(t.columnMove.colSource,t.columnMove.rowSource),i=t.table.getCellRange(t.columnMove.colTarget,t.columnMove.rowTarget),n=t.table._moveHeaderPosition({col:t.columnMove.colSource,row:t.columnMove.rowSource},{col:t.columnMove.colTarget,row:t.columnMove.rowTarget});if(!n||n.targetIndex===n.sourceIndex)return t.updateCursor(),t.columnMove.moving=!1,setTimeout(()=>{delete t.columnMove.colSource,delete t.columnMove.rowSource,delete t.columnMove.colTarget,delete t.columnMove.rowTarget,t.columnMove.movingColumnOrRow=void 0},0),t.table.scenegraph.component.hideMoveCol(),t.table.scenegraph.updateNextFrame(),!1;{t.table.internalProps.useOneRowHeightFillAll=!1,t.table.internalProps.layoutMap.clearCellRangeMap();let l=t.table.getCellRange(t.columnMove.colSource,t.columnMove.rowSource),s=t.table.getCellRange(t.columnMove.colTarget,t.columnMove.rowTarget),a=Math.min(l.start.col,s.start.col,e.start.col,i.start.col),o=Math.max(l.end.col,s.end.col,e.end.col,i.end.col),h=Math.min(l.start.row,s.start.row,e.start.row,i.start.row),d=Math.max(l.end.row,s.end.row,e.end.row,i.end.row);"row"===n.moveType&&"tree"===t.table.internalProps.layoutMap.rowHierarchyType&&(d=n.targetIndex>n.sourceIndex?d+n.targetSize-1:d+n.sourceSize-1),t.table.transpose||!t.table.internalProps.layoutMap.isSeriesNumberInBody(t.columnMove.colSource,t.columnMove.rowSource)&&"row"!==t.columnMove.movingColumnOrRow||(t.table.changeRecordOrder(n.sourceIndex,n.targetIndex),t.changeCheckboxAndRadioOrder(n.sourceIndex,n.targetIndex)),"column"===n.moveType?ij(a,o,0,-1,t.table):ij(0,-1,h,d,t.table),t.table.clearCellStyleCache(),t.table.internalProps.layoutMap.isSeriesNumberInBody(t.columnMove.colSource,t.columnMove.rowSource)||"row"===t.columnMove.movingColumnOrRow?t.table.scenegraph.updateHeaderPosition(t.table.scenegraph.proxy.colStart,t.table.scenegraph.proxy.colEnd,t.table.scenegraph.proxy.rowStart,t.table.scenegraph.proxy.rowEnd,n.moveType):"column"===n.moveType?t.table.scenegraph.updateHeaderPosition(a,o,0,-1,n.moveType):t.table.scenegraph.updateHeaderPosition(0,-1,h,d,n.moveType),"adjustFrozenCount"===t.table.internalProps.frozenColDragHeaderMode&&t.table.isListTable()&&(t.table.isLeftFrozenColumn(t.columnMove.colTarget)&&!t.table.isLeftFrozenColumn(t.columnMove.colSource)?t.table.frozenColCount+=l.end.col-l.start.col+1:t.table.isLeftFrozenColumn(t.columnMove.colSource)&&!t.table.isLeftFrozenColumn(t.columnMove.colTarget)&&(t.table.frozenColCount-=l.end.col-l.start.col+1),t.table.isRightFrozenColumn(t.columnMove.colTarget)&&!t.table.isRightFrozenColumn(t.columnMove.colSource)?t.table.rightFrozenColCount+=l.end.col-l.start.col+1:t.table.isRightFrozenColumn(t.columnMove.colSource)&&!t.table.isRightFrozenColumn(t.columnMove.colTarget)&&(t.table.rightFrozenColCount-=l.end.col-l.start.col+1)),r=!0}}return t.columnMove.moving=!1,setTimeout(()=>{delete t.columnMove.colSource,delete t.columnMove.rowSource,delete t.columnMove.colTarget,delete t.columnMove.rowTarget,t.columnMove.movingColumnOrRow=void 0},0),t.table.scenegraph.component.hideMoveCol(),!(t.columnResize.col<t.table.frozenColCount)||t.table.isPivotTable()||t.table.transpose?!(t.columnResize.col>=t.table.colCount-t.table.rightFrozenColCount)||t.table.isPivotTable()||t.table.transpose?t.table.options.frozenColCount?t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.rightFrozenColCount&&t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):(t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1,t.columnResize.isRightFrozen),t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.table.scenegraph.updateNextFrame(),!0===(null==(i=t.table.options.customConfig)?void 0:i.notUpdateInColumnRowMove)||r}(this)}checkFrozen(){var t,e;let i=null!=(t=this.table.options.frozenColCount)?t:this.table.isPivotTable()||this.table.isListTable()&&this.table.internalProps.transpose?(null!=(e=this.table.rowHeaderLevelCount)?e:0)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount:0;if(i){i=Math.min(i,this.table.colCount);let t=this.table.getContainer();if(t&&0===t.clientWidth){if(this._frozenObserver)return;return this._frozenObserver=new ResizeObserver(t=>{for(let e of t)if(e.contentRect.width>0)return this.clearFrozenObserver(),this.table.resize(),void setTimeout(()=>{this.checkFrozen()},0)}),void this._frozenObserver.observe(t)}if(this.table.getColsWidth(0,i-1)>this.table._getMaxFrozenWidth())if(this.table.internalProps.unfreezeAllOnExceedsMaxWidth)this.table._setFrozenColCount(0),this.setFrozenCol(-1);else{let t=this.table._getComputedFrozenColCount(i);this.table._setFrozenColCount(t),this.setFrozenCol(t)}else this.table.frozenColCount!==i&&(this.table._setFrozenColCount(i),this.setFrozenCol(i))}else this.clearFrozenObserver()}clearFrozenObserver(){this._frozenObserver&&(this._frozenObserver.disconnect(),this._frozenObserver=null)}setFrozenCol(t){t!==this.frozen.col&&(this.frozen.col=t,this.table.scenegraph.updateFrozen()),this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)}setFrozenRow(t){t!==this.frozen.row&&(this.frozen.row=t,this.table.scenegraph.updateRowFrozen())}checkVerticalScrollBarEnd(){var t,e;let i=this.table.getAllRowsHeight(),r=this.scroll.verticalBarPos,n=this.table.tableNoFrameHeight;r+n>=i&&this.table.fireListeners(I.B.SCROLL_VERTICAL_END,{scrollTop:r,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(t=this.table.theme.scrollStyle)?void 0:t.width,scrollWidth:null==(e=this.table.theme.scrollStyle)?void 0:e.width,viewHeight:n,viewWidth:this.table.tableNoFrameWidth})}checkHorizontalScrollBarEnd(){var t,e;let i=this.table.getAllColsWidth(),r=this.scroll.horizontalBarPos,n=this.table.tableNoFrameWidth;r+n>=i&&this.table.fireListeners(I.B.SCROLL_HORIZONTAL_END,{scrollTop:this.scroll.verticalBarPos,scrollLeft:r,scrollHeight:null==(t=this.table.theme.scrollStyle)?void 0:t.width,scrollWidth:null==(e=this.table.theme.scrollStyle)?void 0:e.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:n})}updateVerticalScrollBar(t){var e,i,r,n;let l=this.table.getAllRowsHeight(),s=this.scroll.verticalBarPos,a=Math.ceil(t*(l-this.table.scenegraph.height));(0,y.Z)(a)&&!isNaN(a)||(a=0);let o=a-this.table.scenegraph.proxy.deltaY-s;if(this.table.fireListeners(I.B.CAN_SCROLL,{event:void 0,scrollTop:a-this.table.scenegraph.proxy.deltaY,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(e=this.table.theme.scrollStyle)?void 0:e.width,scrollWidth:null==(i=this.table.theme.scrollStyle)?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:t,dy:o}).some(t=>!1===t)){let t=this.scroll.verticalBarPos/(l-this.table.scenegraph.height);this.table.scenegraph.component.updateVerticalScrollBarPos(t)}else this.scroll.verticalBarPos=a,this.table.scenegraph.setY(-this.scroll.verticalBarPos,1===t),this.scroll.verticalBarPos-=this.table.scenegraph.proxy.deltaY,this.table.scenegraph.proxy.deltaY=0,this.updateHoverPos(-1,-1),this.table.fireListeners(I.B.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(r=this.table.theme.scrollStyle)?void 0:r.width,scrollWidth:null==(n=this.table.theme.scrollStyle)?void 0:n.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:t,dy:o}),s!==this.scroll.verticalBarPos&&this.checkVerticalScrollBarEnd()}updateHorizontalScrollBar(t){var e,i,r,n;let l=this.table.getAllColsWidth(),s=this.scroll.horizontalBarPos,a=Math.ceil(t*(l-this.table.scenegraph.width));(0,y.Z)(a)&&!isNaN(a)||(a=0);let o=a-this.table.scenegraph.proxy.deltaX-s;if(this.table.fireListeners(I.B.CAN_SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:a-this.table.scenegraph.proxy.deltaX,scrollHeight:null==(e=this.table.theme.scrollStyle)?void 0:e.width,scrollWidth:null==(i=this.table.theme.scrollStyle)?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:t,dx:o}).some(t=>!1===t)){let t=this.scroll.horizontalBarPos/(l-this.table.scenegraph.width);this.table.scenegraph.component.updateHorizontalScrollBarPos(t)}else this.scroll.horizontalBarPos=a,this.table.scenegraph.setX(-this.scroll.horizontalBarPos,1===t),this.scroll.horizontalBarPos-=this.table.scenegraph.proxy.deltaX,this.table.scenegraph.proxy.deltaX=0,this.updateHoverPos(-1,-1),this.table.fireListeners(I.B.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(r=this.table.theme.scrollStyle)?void 0:r.width,scrollWidth:null==(n=this.table.theme.scrollStyle)?void 0:n.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:t,dx:o}),s!==this.scroll.horizontalBarPos&&this.checkHorizontalScrollBarEnd()}setScrollTop(t,e,i=!0){var r,n,l,s,a,o,h,d,u,c,p,g,f;if(!this.table||!this.table.scenegraph)return;let m=this.table.getAllRowsHeight(),v=+(null!=(r=this.table.options.customConfig)&&!!r._disableColumnAndRowSizeRound);t=Math.ceil(t=Math.max(0,Math.min(t,m-(null!=(l=null==(n=this.table.scenegraph)?void 0:n.height)?l:0)-v)));let b=this.scroll.verticalBarPos,_=t/(m-(null!=(a=null==(s=this.table.scenegraph)?void 0:s.height)?a:0));if((b!==t||!0===(null==(h=null==(o=this.table.options)?void 0:o.customConfig)?void 0:h.scrollEventAlwaysTrigger))&&i){let i=t;(0,y.Z)(i)&&!isNaN(i)||(i=0);let r=i-b;if(this.table.fireListeners(I.B.CAN_SCROLL,{event:null==e?void 0:e.nativeEvent,scrollTop:i,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(d=this.table.theme.scrollStyle)?void 0:d.width,scrollWidth:null==(u=this.table.theme.scrollStyle)?void 0:u.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:_,dy:r}).some(t=>!1===t)){let t=this.scroll.verticalBarPos/(m-(null!=(p=null==(c=this.table.scenegraph)?void 0:c.height)?p:0));return void this.table.scenegraph.component.updateVerticalScrollBarPos(t)}}(t!==this.scroll.verticalBarPos||this.table.isPivotChart())&&this.updateHoverPos(-1,-1),this.scroll.verticalBarPos=t,(0,y.Z)(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this.table.scenegraph.setY(-t),this.table.scenegraph.component.updateVerticalScrollBarPos(_);let C=this.scroll.verticalBarPos-b;this.table.fireListeners(I.B.SCROLL,{event:null==e?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(g=this.table.theme.scrollStyle)?void 0:g.width,scrollWidth:null==(f=this.table.theme.scrollStyle)?void 0:f.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:_,dy:C}),b!==t&&i&&this.checkVerticalScrollBarEnd()}setScrollLeft(t,e,i=!0){var r,n,l,s,a,o,h;if(!this.table||!this.table.scenegraph)return;this.table.scrollLeft;let d=this.table.getAllColsWidth(),u=(this.table.getFrozenColsWidth(),+(null!=(r=this.table.options.customConfig)&&!!r._disableColumnAndRowSizeRound));t=Math.ceil(t=Math.max(0,Math.min(t,d-this.table.scenegraph.width-u)));let c=this.scroll.horizontalBarPos,p=t/(d-this.table.scenegraph.width);if((c!==t||!0===(null==(l=null==(n=this.table.options)?void 0:n.customConfig)?void 0:l.scrollEventAlwaysTrigger))&&i){let i=t;(0,y.Z)(i)&&!isNaN(i)||(i=0);let r=i-c;if(this.table.fireListeners(I.B.CAN_SCROLL,{event:null==e?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:i,scrollHeight:null==(s=this.table.theme.scrollStyle)?void 0:s.width,scrollWidth:null==(a=this.table.theme.scrollStyle)?void 0:a.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:p,dx:r}).some(t=>!1===t)){let t=this.scroll.horizontalBarPos/(d-this.table.scenegraph.width);return void this.table.scenegraph.component.updateHorizontalScrollBarPos(t)}}t!==this.scroll.horizontalBarPos&&this.updateHoverPos(-1,-1),this.scroll.horizontalBarPos=t,(0,y.Z)(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this.table.scenegraph.setX(-t),this.table.scenegraph.component.updateHorizontalScrollBarPos(p);let g=this.scroll.horizontalBarPos-c;this.table.fireListeners(I.B.SCROLL,{event:null==e?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(o=this.table.theme.scrollStyle)?void 0:o.width,scrollWidth:null==(h=this.table.theme.scrollStyle)?void 0:h.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:p,dx:g}),c!==t&&i&&this.checkHorizontalScrollBarEnd()}hideVerticalScrollBar(){this.table.scenegraph.component.hideVerticalScrollBar()}showVerticalScrollBar(t){this.table.scenegraph.component.showVerticalScrollBar(),t&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{var t;null==(t=this.table.scenegraph)||t.component.hideVerticalScrollBar()},1e3))}hideHorizontalScrollBar(){this.table.scenegraph.component.hideHorizontalScrollBar()}showHorizontalScrollBar(t){var e;this.table.scenegraph.component.showHorizontalScrollBar(),null==(e=this.table.scenegraph)||e.component.showFrozenColumnShadow(),t&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{var t,e;null==(t=this.table.scenegraph)||t.component.hideFrozenColumnShadow(),null==(e=this.table.scenegraph)||e.component.hideHorizontalScrollBar()},1e3))}triggerContextMenu(t,e,i,r){this.menu.isShow&&this.menu.x===i&&this.menu.y===r?this.hideMenu():this.showContextMenu(t,e,i,r)}showContextMenu(t,e,i,r){var n;(null==(n=this.table.internalProps.menu)?void 0:n.contextMenuItems)&&("html"===this.table.internalProps.menu.renderMode?this.menu.isShow=!0:(this.menu.isShow=!0,this.menu.x=i,this.menu.y=r,this.table.scenegraph.component.menu.attach(i,r,t,e,m.contextmenu)),this.table.fireListeners(I.B.SHOW_MENU,{x:i,y:r,col:t,row:e,type:"contextmenu"}))}triggerDropDownMenu(t,e,i,r,n){this.table.fireListeners(I.B.DROPDOWN_ICON_CLICK,{col:t,row:e,event:n}),this.menu.isShow?this.hideMenu():this.showDropDownMenu(t,e,i,r)}showDropDownMenu(t,e,i,r){let n;"html"===this.table.internalProps.menu.renderMode?this.menu.isShow=!0:(this.menu.isShow=!0,this.table.scenegraph.component.menu.attach(i,r,t,e,m.dropDown),this.menu.bounds=this.table.scenegraph.component.menu.bounds),this.table.fireListeners(I.B.SHOW_MENU,{x:i,y:r,col:t,row:e,type:"dropDown"}),this.residentHoverIcon&&this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row);let l=this.table.scenegraph.getCell(t,e);l.forEachChildren(t=>t.attribute.funcType===N.cI.dropDown&&(n=t,!0)),n&&(this.residentHoverIcon={col:t,row:e,icon:n},this.table.scenegraph.setIconHoverStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row,l),this.table.scenegraph.residentHoverIcon(t,e))}hideMenu(){this.menu.isShow&&(this.table.fireListeners(I.B.DROPDOWN_MENU_CLEAR,null),this.table.fireListeners(I.B.HIDE_MENU,null),this.menu.isShow=!1,this.table.scenegraph.component.menu.detach(),this.residentHoverIcon&&(this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row),this.table.scenegraph.resetResidentHoverIcon(this.residentHoverIcon.col,this.residentHoverIcon.row),this.residentHoverIcon=null))}setDropDownMenuHighlight(t){this.menu.dropDownMenuHighlight=t;for(let e=0;e<t.length;e++){let{col:i,row:r}=t[e],n=this.table.getCellRange(i,r);if(n)for(let t=n.start.col;t<=n.end.col;t++)for(let e=n.start.row;e<=n.end.row;e++)this.table.scenegraph.updateCellContent(t,e)}}dropDownMenuIsHighlight(t,e,i){let r=this.menu.dropDownMenuHighlight;if(Array.isArray(r))for(let n=0;n<r.length;n++){let l=r[n],{col:s,row:a}=l,{field:o,menuKey:h}=l;if("number"!=typeof s||"number"!=typeof a)if(this.table.isPivotTable()&&(Array.isArray(o),1)){let t=this.table.internalProps.layoutMap.getPivotCellAdress(o);if(!t)continue;s=t.col,a=t.row}else{let t=this.table.internalProps.layoutMap.getHeaderCellAddressByField(o);if(!t)continue;s=t.col,a=t.row}if((0,y.Z)(s)&&(0,y.Z)(a)&&this.table.isCellRangeEqual(t,e,s,a)){let r=this.table._getHeaderLayoutMap(null!=s?s:t,null!=a?a:e).dropDownMenu||this.table.globalDropDownMenu;if("function"==typeof r&&(r=r({row:a,col:s,table:this.table})),r)for(let t=0;t<r.length;t++){let e=r[t];if((0,iZ.Z)(e)&&(e.menuKey||e.text)===(h||"")&&t===i||(0,ey.Z)(e)&&e===h&&t===i)return!0}}}return!1}triggerSort(t,e,i,r){if(this.table.isPivotTable()){let i=this.table.getPivotSortState(t,e),n=i?i.toUpperCase():"NORMAL";return this.table.sort(t,e,"ASC"===n?"DESC":"DESC"===n?"NORMAL":"ASC"),void this.table.fireListeners(iz.z.PIVOT_SORT_CLICK,{col:t,row:e,order:n||"normal",dimensionInfo:this.table.internalProps.layoutMap.getPivotDimensionInfo(t,e),cellLocation:this.table.getCellLocation(t,e),event:r})}let n=[...this.sort],l=this.table.internalProps.multipleSort||!n.length?null:this.sort[this.sort.length-1];!function(t,e,i,r){var n,l,s,a;let o,h=null,d=!1;if(Array.isArray(i.sortState))for(let r=0;r<i.sortState.length&&((o=i.sortState[r])&&(h=i._getHeaderCellBySortState(o)),h&&(d=iD(t,e,h.col,h.row,i)),!d);r++);else(o=i.sortState)&&(h=i._getHeaderCellBySortState(o)),h&&(d=iD(t,e,h.col,h.row,i));let u=i.getHeaderDefine(t,e);if(o&&d&&(null==u?void 0:u.sort)?o.order="asc"===o.order?"desc":"desc"===o.order?"normal":"asc":(null==u?void 0:u.sort)?o={field:i.getHeaderField(t,e),order:"asc"}:d&&(null==u?void 0:u.showSort)||(o={field:i.getHeaderField(t,e),order:"normal"}),o.event=r,i.fireListeners(I.B.SORT_CLICK,o).includes(!1))return;let c=!1,p=i.internalProps.sortState?Array.isArray(i.internalProps.sortState)&&(c=!0)?i.internalProps.sortState:[i.internalProps.sortState]:[];if(Array.isArray(p)){let t=p.findIndex(t=>t.field===o.field);t>=0?p[t]=o:p.push(o)}p=p.filter(t=>"normal"!==t.order),p=i.internalProps.multipleSort&&(c=!0)?p:p.splice(-1),p=c&&p.length?p:p[0],i.internalProps.sortState=p,i.stateManager.setSortState(p),(null==u?void 0:u.sort)&&(l=p,s=i,a=0,l=Array.isArray(l)||!l?l:[l],s.dataSource.sort((l||[]).map(t=>{var e,i;let r=s.internalProps.layoutMap.headerObjects.find(e=>e&&e.field===t.field);return{field:t.field,order:t.order||"asc",orderFn:"function"==typeof(null==(e=null==r?void 0:r.define)?void 0:e.sort)?null==(i=null==r?void 0:r.define)?void 0:i.sort:O.K$}}))),i.internalProps.useOneRowHeightFillAll=!1,i.internalProps.layoutMap.clearCellRangeMap(),i.scenegraph.sortCell();let g=!!(null==(n=i.stateManager.select.ranges)?void 0:n.length);i.stateManager.updateSelectPos(-1,-1),i.stateManager.endSelectCells(!0,g)}(t,e,this.table,r);let s=this.table.getCellRange(t,e),a=this.sort.find(t=>t.col===s.start.col&&t.row===s.start.row),o=this.table.internalProps.multipleSort||!l?null:l.col,h=this.table.internalProps.multipleSort||!l?null:l.row,d=n.findIndex(i=>i.col===t&&i.row===e);d>=0&&n.splice(d,1),this.table.scenegraph.updateSortIcon({col:t,row:e,iconMark:i,order:null==a?void 0:a.order,oldSortCol:o,oldSortRow:h,oldIconMark:null==l?void 0:l.icon}),a&&(a.icon=i),this.table.internalProps.multipleSort||n.forEach(t=>{this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:"normal",oldSortCol:t.col,oldSortRow:t.row,oldIconMark:null})}),this.table.fireListeners(iz.z.AFTER_SORT,{order:null==a?void 0:a.order,field:this.table.getHeaderField(t,e),event:r})}setSelectInline(t){this.select.selectInline=t}updateSortState(t){var e,i,r,n,l,s,a,o;t=Array.isArray(t)?t:[t];for(let o=0;o<t.length;o++){let h;if(t[o].field===(null==(e=this.sort[o])?void 0:e.field)&&t[t.length-1].order===(null==(i=this.sort[o])?void 0:i.order))return;let d=this.table.internalProps.multipleSort?null:(null==(r=this.sort[o])?void 0:r.col)||null,u=this.table.internalProps.multipleSort?null:(null==(n=this.sort[o])?void 0:n.row)||null;"asc"===(null==(l=this.sort[o])?void 0:l.order)||null==(s=this.sort[o])||s.order,this.setSortState(t.slice(0,o+1));let c=this.table.internalProps.layoutMap.getHeaderCellAddressByField(t[o].field);this.sort[o].col=c.col,this.sort[o].row=c.row;let p=this.table.scenegraph.getCell(this.sort[o].col,this.sort[o].row);(0,O.yW)(p,"children",t=>"sort"===t.attribute.funcType&&(h=t,!0)),this.table.scenegraph.updateSortIcon({col:this.sort[o].col,row:this.sort[o].row,iconMark:h,order:this.sort[o].order,oldSortCol:d,oldSortRow:u,oldIconMark:null==(a=this.sort[o])?void 0:a.icon})}let h=[];this.table.internalProps.layoutMap.columnTree.tree.children.forEach(e=>{t.some(t=>t.field===e.field)||h.push(e)});for(let t=0;t<h.length;t++){let e=h[t];this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:null,oldSortCol:null!=(o=e.startInTotal+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?o:0,oldSortRow:e.level,oldIconMark:null})}}triggerFreeze(t,e,i){if(!this.table.isPivotTable()&&!this.table.transpose){var r;if((r=this.table).frozenColCount>0?t!==r.frozenColCount-1?r.setFrozenColCount(t+1):r.setFrozenColCount(0):r.setFrozenColCount(t+1),this.table.hasListeners(iz.z.FREEZE_CLICK)){let i=this.table.internalProps.layoutMap.columnObjects.slice(0,t+1);this.table.fireListeners(iz.z.FREEZE_CLICK,{col:t,row:e,fields:i.reduce((t,e)=>t.concat(e.field),[]),colCount:this.table.frozenColCount})}this.frozen.icon=i}}updateCursor(t){var e;t||(t=null!=(e=this.table.options.defaultCursor)?e:"default"),this.table.getElement().style.cursor=t}updateDrillState(t,e,i,r,n,l){this.drill.dimensionKey=t,this.drill.title=e,this.drill.drillDown=i,this.drill.drillUp=r,this.drill.col=n,this.drill.row=l,function(t,e,i,r,n){let l=n.getCellLocation(t,e),s=0,a=0,o=!1;"columnHeader"===l?(s=n.getColsWidth(0,n.rowHeaderLevelCount-1)-(0===n.frozenColCount?n.scrollLeft:0),a=n.getRowsHeight(0,e-1)+n.getRowHeight(e)/2,o=!0):"rowHeader"===l&&(a=n.getRowsHeight(0,n.columnHeaderLevelCount-1),s=n.getColsWidth(0,t-1)+n.getColWidth(t)/2,o=!0),n.scenegraph.updateDrill(o,s,a,i,r)}(n,l,i,r,this.table)}updateSparklineHoverPose(t,e,i,r){-1!==this.sparkLine.col&&-1!==this.sparkLine.row&&function(t,e,i){let r=i.scenegraph.getCell(t,e).getChildByName("sparkline"),n=null==r?void 0:r.getChildByName("highlight-line"),l=null==r?void 0:r.getChildByName("highlight-symbol");n&&n.setAttributes({visible:!1,pickable:!1}),l&&l.setAttributes({visible:!1,pickable:!1}),i.scenegraph.updateNextFrame()}(this.sparkLine.col,this.sparkLine.row,this.table);let n=!1;-1!==t&&-1!==e&&(n=function(t,e,i,r,n){var l,s;let a,o=n.scenegraph.getCell(t,e).getChildByName("sparkline"),h=null==o?void 0:o.getChildByName("sparkline-line"),d=null==o?void 0:o.getChildByName("sparkline-symbol-group");if(!h)return!1;let u=h.bandwidth,c=h.min,p=h.max,g=h.attribute.points;i-=o.globalAABBBounds.x1,o.globalAABBBounds.y1;for(let t=0;t<g.length;t++){let{x:e,y:r,defined:n,rawData:f}=g[t];if(Math.abs(i-e)<u/2&&(a={point:g[t],points:g,pointsBandWidth:u,pointData:f},n)){let t=o.getChildByName("highlight-line");if(t)t.setAttributes({points:[{x:e,y:p},{x:e,y:c}],visible:!0,pickable:!0});else{let t=(0,td.W)({points:[{x:e,y:p},{x:e,y:c}],lineWidth:null==(l=h.hover)?void 0:l.strokeWidth,stroke:null==(s=h.hover)?void 0:s.stroke});t.name="highlight-line",o.addChild(t)}let i=o.getChildByName("highlight-symbol");if(i)i.setAttributes({x:e,y:r,visible:!0,pickable:!0});else{let t=(0,tx.t)({x:e,y:r,stroke:d.hover.stroke,lineWidth:d.hover.strokeWidth,fill:d.hover.fill,size:2*d.hover.size,symbolType:"circle"});t.name="highlight-symbol",o.addChild(t)}break}}if(n.scenegraph.updateNextFrame(),a){let i={col:t,row:e,field:n.getHeaderField(t,e),value:n.getCellValue(t,e),dataValue:n.getCellOriginValue(t,e),cellHeaderPaths:n.internalProps.layoutMap.getCellHeaderPaths(t,e),title:n.getBodyColumnDefine(t,e).title,cellRange:n.getCellRelativeRect(t,e),sparkline:{pointData:a.pointData},scaleRatio:n.canvas.getBoundingClientRect().width/n.canvas.offsetWidth};n.fireListeners(I.B.MOUSEOVER_CHART_SYMBOL,i)}return!0}(t,e,i,0,this.table)),n?(this.sparkLine.col=t,this.sparkLine.row=e):(this.sparkLine.col=-1,this.sparkLine.row=-1)}setCheckedState(t,e,i,r){return(0,iX.Y)(t,e,i,r,this)}setHeaderCheckedState(t,e){return(0,iX.Vz)(t,e,this)}syncCheckedState(t,e,i,r){return(0,iX.GW)(t,e,i,r,this)}initCheckedState(t){return(0,iX.gs)(t,this)}updateHeaderCheckedState(t,e,i){return(0,iX.Pi)(t,this,e,i)}initLeftRecordsCheckState(t){return(0,iX.Bd)(t,this)}setRadioState(t,e,i,r,n){(0,iK.Oq)(t,e,i,r,n,this)}syncRadioState(t,e,i,r,n,l){return(0,iK.fM)(t,e,i,r,n,l,this)}changeCheckboxAndRadioOrder(t,e){this.checkedState.size&&(0,iX.hR)(t,e,this),this.radioState.length&&(0,iK.tO)(t,e,this)}setCustomSelectRanges(t){var e;(function(t){let{customSelectedRangeComponents:e}=t.table.scenegraph;e.forEach((t,e)=>{t.rect.delete()}),e.clear(),t.select.customSelectRanges=[]})(this),e=this,t.forEach(t=>{!function(t,e,i){let r=t.table,n=e.start.col,l=e.start.row,s=e.end.col,a=e.end.row,o=(e.skipBodyMerge,Math.max(Math.min(s,n),0)),h=Math.max(Math.min(a,l),0),d=Math.min(Math.max(s,n),r.colCount-1),u=Math.min(Math.max(a,l),r.rowCount-1),{needRowHeader:c,needRightRowHeader:p,needColumnHeader:g,needBottomColumnHeader:f,needBody:m,needCornerHeader:y,needRightTopCornerHeader:v,needLeftBottomCornerHeader:b,needRightBottomCornerHeader:_}=(0,e2.L)(o,h,d,u,r);if(y&&i$(t,o,h,Math.min(d,r.frozenColCount-1),Math.min(u,r.frozenRowCount-1),"cornerHeader",`${o}${h}${d}${u}`,[!0,!g,!c,!0],i),v&&i$(t,Math.max(o,r.colCount-r.rightFrozenColCount),h,d,Math.min(u,r.frozenRowCount-1),"rightTopCorner",`${o}${h}${d}${u}`,[!0,!0,!p,!g],i),b){let e=Math.min(d,r.frozenColCount-1);i$(t,o,Math.max(h,r.rowCount-r.bottomFrozenRowCount),e,u,"leftBottomCorner",`${o}${h}${d}${u}`,[!c,!f,!0,!0],i)}if(_&&i$(t,Math.max(o,r.colCount-r.rightFrozenColCount),Math.max(h,r.rowCount-r.bottomFrozenRowCount),d,u,"rightBottomCorner",`${o}${h}${d}${u}`,[!p,!0,!0,!f],i),g&&i$(t,Math.max(o,r.frozenColCount),h,Math.min(d,r.colCount-r.rightFrozenColCount-1),Math.min(u,r.frozenRowCount-1),"columnHeader",`${o}${h}${d}${u}`,[!0,!v,!m,!y],i),f){let e=Math.max(o,r.frozenColCount),n=Math.min(d,r.colCount-r.rightFrozenColCount-1);i$(t,e,Math.max(h,r.rowCount-r.bottomFrozenRowCount),n,u,"bottomFrozen",`${o}${h}${d}${u}`,[!m,!_,!0,!b],i)}if(c){let e=Math.max(h,r.frozenRowCount),n=Math.min(u,r.rowCount-r.bottomFrozenRowCount-1);i$(t,o,e,Math.min(d,r.frozenColCount-1),n,"rowHeader",`${o}${h}${d}${u}`,[!y,!m,!b,!0],i)}if(p){let e=Math.max(h,r.frozenRowCount),n=Math.min(u,r.rowCount-r.bottomFrozenRowCount-1);i$(t,Math.max(o,r.colCount-r.rightFrozenColCount),e,d,n,"rightFrozen",`${o}${h}${d}${u}`,[!v,!0,!_,!m],i)}m&&i$(t,Math.max(o,r.frozenColCount),Math.max(h,r.frozenRowCount),Math.min(d,r.colCount-r.rightFrozenColCount-1),Math.min(u,r.rowCount-r.bottomFrozenRowCount-1),"body",`${o}${h}${d}${u}`,[!g,!p,!f,!c],i)}(e.table.scenegraph,t.range,t.style)}),e.select.customSelectRanges=t,e3(e.table.scenegraph),e.table.scenegraph.updateNextFrame()}}var iJ=i(47634),iQ=i(96241),i0=i(77874);function i1(t){if(t.eventManager.bindSparklineHoverEvent)return;let e=!1;(t.isPivotTable()?t.internalProps.layoutMap.indicatorsDefine.some(t=>"string"!=typeof t&&"sparkline"===t.cellType):t.internalProps.layoutMap.columnObjects.some(t=>"sparkline"===t.cellType||"function"==typeof t.cellType))&&(t.eventManager.bindSparklineHoverEvent=!0,t.on(I.B.MOUSEMOVE_CELL,e=>{let{col:i,row:r,x:n,y:l}=e;"sparkline"!==t.getBodyColumnType(i,r)&&t.stateManager.updateSparklineHoverPose(-1,-1,0,0),t.stateManager.updateSparklineHoverPose(i,r,n,l)}),t.on(I.B.MOUSELEAVE_TABLE,e=>{t.stateManager.updateSparklineHoverPose(-1,-1,0,0)}))}var i2=i(13942);function i3(t,e,i=!0){var r,n,l;let{deltaX:s,deltaY:a}=t;t.shiftKey&&t.deltaY&&(s=a,a=0);let[o,h]=function(t,e,i){var r,n;let l=Math.abs(t/e);return[Math.ceil((l<=.5?0:t)*(null!=(r=i.horizontal)?r:0)),Math.ceil((l>2?0:e)*(null!=(n=i.vertical)?n:0))]}(s,a,{horizontal:1,vertical:1});(o||h)&&e.interactionState!==P.F.scrolling&&e.updateInteractionState(P.F.scrolling);let d="scrolling"===(null==(n=null==(r=e.table.options.theme)?void 0:r.scrollStyle)?void 0:n.visible);o&&(e.setScrollLeft(e.scroll.horizontalBarPos+o,t),e.showHorizontalScrollBar(d)),h&&(e.setScrollTop(e.scroll.verticalBarPos+h,t),e.showVerticalScrollBar(d)),i&&e.resetInteractionState(e.interactionStateBeforeScroll),(null==(l=t.nativeEvent)?void 0:l.cancelable)&&("none"===e.table.internalProps.overscrollBehavior&&(a&&i6(e)||s&&i7(e))||Math.abs(a)>=Math.abs(s)&&0!==a&&i5(a,e)||Math.abs(a)<=Math.abs(s)&&0!==s&&i4(s,e))&&t.nativeEvent.preventDefault()}function i5(t,e){var i,r;return 0!=e.table.getAllRowsHeight()-e.table.scenegraph.height&&(i=t,0==(r=e).table.getAllRowsHeight()-r.table.scenegraph.height||!(i<=0)||!(r.scroll.verticalBarPos<1))&&!function(t,e){var i;let r=+(null!=(i=e.table.options.customConfig)&&!!i._disableColumnAndRowSizeRound),n=e.table.getAllRowsHeight()-e.table.scenegraph.height;return 0!==n&&t>=0&&Math.abs(e.scroll.verticalBarPos-n)<1+r}(t,e)}function i4(t,e){var i,r;return 0!=e.table.getAllColsWidth()-e.table.scenegraph.width&&(i=t,0==(r=e).table.getAllColsWidth()-r.table.scenegraph.width||!(i<=0)||!(r.scroll.horizontalBarPos<1))&&!function(t,e){var i;let r=+(null!=(i=e.table.options.customConfig)&&!!i._disableColumnAndRowSizeRound),n=e.table.getAllColsWidth()-e.table.scenegraph.width;return 0!==n&&t>=0&&Math.abs(e.scroll.horizontalBarPos-n)<1+r}(t,e)}function i6(t){return!(t.table.getAllRowsHeight()-t.table.scenegraph.height<=0)}function i7(t){return!(t.table.getAllColsWidth()-t.table.scenegraph.width<=0)}class i8{constructor(t){this.stateManager=t}setScrollHandle(t){this.scrollHandle=t}startInertia(t,e,i){this.lastTime=Date.now(),this.speedX=t,this.speedY=e,this.friction=i,this.runingId||(this.runingId=W.rF.getRequestAnimationFrame()(this.inertia.bind(this)))}inertia(){var t;let e=Date.now(),i=e-this.lastTime,r=!0,n=Math.pow(this.friction,i/16),l=n*this.speedX,s=n*this.speedY,a=0,o=0;Math.abs(l)>.05&&(r=!1,a=(this.speedX+l)/2*i),Math.abs(s)>.05&&(r=!1,o=(this.speedY+s)/2*i),null==(t=this.scrollHandle)||t.call(this,a,o),r?this.runingId=null:(this.lastTime=e,this.speedX=l,this.speedY=s,this.runingId=W.rF.getRequestAnimationFrame()(this.inertia.bind(this)))}endInertia(){W.rF.getCancelAnimationFrame()(this.runingId),this.runingId=null}isInertiaScrolling(){return!!this.runingId}}function i9(t,e,i){var r,n,l,s,a,o,h,d;if(e&&-1!==(null==(r=t.stateManager.columnMove)?void 0:r.colSource)&&-1!==(null==(n=t.stateManager.columnMove)?void 0:n.rowSource)&&-1!==(null==(l=t.stateManager.columnMove)?void 0:l.colTarget)&&-1!==(null==(s=t.stateManager.columnMove)?void 0:s.rowTarget)){if(t.hasListeners(I.B.CHANGE_HEADER_POSITION)){let{colSource:e,rowSource:r,colTarget:n,rowTarget:l,movingColumnOrRow:s}=t.stateManager.columnMove,h=null!=(a=t.stateManager.columnMove.rowSourceSize)?a:0,d=null!=(o=t.stateManager.columnMove.rowTargetSize)?o:0;t.fireListeners(I.B.CHANGE_HEADER_POSITION,{target:{col:n,row:l+d-h},source:{col:e,row:r},movingColumnOrRow:s,event:i})}}else if(!e&&t.hasListeners(I.B.CHANGE_HEADER_POSITION_FAIL)){let e=null!=(h=t.stateManager.columnMove.rowSourceSize)?h:0,r=null!=(d=t.stateManager.columnMove.rowTargetSize)?d:0;t.fireListeners(I.B.CHANGE_HEADER_POSITION_FAIL,{target:{col:t.stateManager.columnMove.colTarget,row:t.stateManager.columnMove.rowTarget+r-e},source:{col:t.stateManager.columnMove.colSource,row:t.stateManager.columnMove.rowSource},movingColumnOrRow:t.stateManager.columnMove.movingColumnOrRow,event:i})}}function rt(t){t.stateManager.endResizeCol();let e=[];for(let i=0;i<t.colCount;i++)e.push(t.getColWidth(i));t.fireListeners(I.B.RESIZE_COLUMN_END,{col:t.stateManager.columnResize.col,colWidths:e})}function re(t){t.stateManager.endResizeRow(),t.fireListeners(I.B.RESIZE_ROW_END,{row:t.stateManager.rowResize.row,rowHeight:t.getRowHeight(t.stateManager.rowResize.row)})}let ri=1;function rr(){return B.UG?ri=1:(ri=Math.ceil(window.devicePixelRatio||1))>1&&ri%2!=0&&(ri+=1),ri}rr();var rn=function(t,e,i,r){return new(i||(i=Promise))(function(n,l){function s(t){try{o(r.next(t))}catch(t){l(t)}}function a(t){try{o(r.throw(t))}catch(t){l(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(s,a)}o((r=r.apply(t,e||[])).next())})};function rl(t){return!!t.changedTouches}function rs(t,e,i){if(i.indicatorsAsCol){if(i.hasTopIndicatorAxis&&e===i.columnHeaderLevelCount-1&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount)return"top";if(e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount)return"bottom";if(t===i.rowHeaderLevelCount-1&&e>=i.rowHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return"left"}else{if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return"left";if(t===i.colCount-i.rightFrozenColCount&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return"right";e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&(i.colCount,i.rightFrozenColCount)}return"bottom"}function ra(t,e,i,r,n,l,s){var a;let o=s||"_vtable_rowSeries_number",h=e+1;for(;(0,tT.Z)(r[h])&&(null==(a=r[h])?void 0:a.length)>i.length;){let e=n.columnHeaderLevelCount+h;n.stateManager.setCheckedState(l,e,o,t),(0,iX.r5)(l,e,t,n),h++}}function ro(t,e,i,r,n,l){var s;let a=e.length-1;if(a>0){let e=t-1;for(;a>0&&e>=0;)((0,tT.Z)(i[e])&&(null==(s=i[e])?void 0:s.length)===a||1===a&&(0,$.Z)(i[e]))&&(function(t,e,i,r,n){let{checkedState:l}=r.stateManager,s=i.toString(),a=n||"_vtable_rowSeries_number";(0,tT.Z)(i)&&i.length;let o=!1,h=[],d=Array.from(l.keys()).sort((t,e)=>{var i,r;let n=t.split(","),l=e.split(","),s=Math.max(n.length,l.length);for(let t=0;t<s;t++){let e=null!=(i=Number(n[t]))?i:0,s=null!=(r=Number(l[t]))?r:0;if(e!==s)return e-s}return 0}),u=d.map(t=>l.get(t)),c=d.filter(t=>t.startsWith(s+",")&&t!==s);if(u.forEach((t,e)=>{let i=d[e],r=c.includes(i);o&&(r?h.push(t[a]):o=!1),i===s&&(o=!0)}),0===h.length)return;let p=h.every(t=>!!t),g=h.every(t=>!t);p?(r.stateManager.setCheckedState(t,e,a,!0),(0,iX.r5)(t,e,!0,r)):g?(r.stateManager.setCheckedState(t,e,a,!1),(0,iX.r5)(t,e,!1,r)):(r.stateManager.setCheckedState(t,e,a,"indeterminate"),(0,iX.r5)(t,e,"indeterminate",r))}(n,r.columnHeaderLevelCount+e,i[e],r,l),a--),e--}}function rh(t,e,i,r){let{checkedState:n}=i.stateManager,l=e.toString();(0,tT.Z)(e)&&e.length;let s=!1,a=Array.from(n.keys()).sort((t,e)=>{var i,r;let n=t.split(","),l=e.split(","),s=Math.max(n.length,l.length);for(let t=0;t<s;t++){let e=null!=(i=Number(n[t]))?i:0,s=null!=(r=Number(l[t]))?r:0;if(e!==s)return e-s}return 0}),o=a.filter(t=>t.startsWith(l+",")&&t!==l);a.map(t=>n.get(t)).forEach((e,i)=>{let n=a[i],h=0!==o.length&&o.includes(n);s&&(h?e[r]=t:s=!1),n===l&&(s=!0)})}function rd(t,e,i){let r=t.getRecordShowIndexByCell(e,i);return t.dataSource.getHierarchyState(r)}var ru=function(t,e,i,r){return new(i||(i=Promise))(function(n,l){function s(t){try{o(r.next(t))}catch(t){l(t)}}function a(t){try{o(r.throw(t))}catch(t){l(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(s,a)}o((r=r.apply(t,e||[])).next())})};class rc{constructor(t){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._enableTableScroll=!0,this.cutWaitPaste=!1,this.clipboardCheckTimer=null,this.cutOperationTime=0,this.lastClipboardContent="",this.cutCellRange=null,this.copySourceRange=null,this.table=t,this.handleTextStickBindId=[],this.inertiaScroll=new i8(t.stateManager),"node"===T.X.mode||t.options.disableInteraction||(this.bindOuterEvent(),setTimeout(()=>{this.bindSelfEvent()},0))}bindOuterEvent(){(function(t){let e=t.table,i=e.stateManager;e.scenegraph.tableGroup.addEventListener("pointermove",r=>{var n,l,s,a,o,h,d,u,c,p,g,f,m,v,b,_,C,x;let w=null!=(l=null==(n=e.eventManager.LastPointerXY)?void 0:n.x)?l:r.x,S=null!=(a=null==(s=e.eventManager.LastPointerXY)?void 0:s.y)?a:r.y;e.eventManager.LastPointerXY={x:r.x,y:r.y},t.touchSetTimeout&&(clearTimeout(t.touchSetTimeout),t.touchSetTimeout=void 0);let A=(0,io.RJ)(r);if(A.eventArgs&&e.hasListeners(I.B.MOUSEMOVE_TABLE)&&e.fireListeners(I.B.MOUSEMOVE_TABLE,{col:A.eventArgs.col,row:A.eventArgs.row,x:A.abstractPos.x,y:A.abstractPos.y,event:r.nativeEvent,target:null==(o=null==A?void 0:A.eventArgs)?void 0:o.target,mergeCellInfo:null==(h=A.eventArgs)?void 0:h.mergeInfo}),i.interactionState===P.F.grabing)return void(Math.abs(w-r.x)+Math.abs(S-r.y)>=1&&(i.isResizeCol()||i.isResizeRow()||i.isMoveCol()||(i.isFillHandle()?t.dealFillSelect(A,!0):(null==(d=e.options.select)?void 0:d.disableDragSelect)||t.dealTableSelect(A,!0))));!(null==(u=e.options.select)?void 0:u.disableDragSelect)&&e.eventManager.isDraging&&i.isSelecting()&&!(null==(c=e.editorManager)?void 0:c.editingEditor)&&t.dealTableSelect(A,!0);let M=r.path.find(t=>"cell"===t.role);if(e.hasListeners(I.B.MOUSELEAVE_CELL)&&(-1===e.stateManager.hover.cellPos.col||-1===e.stateManager.hover.cellPos.row||(null==M?void 0:M.col)===e.stateManager.hover.cellPos.col&&(null==M?void 0:M.row)===e.stateManager.hover.cellPos.row||e.fireListeners(I.B.MOUSELEAVE_CELL,{col:e.stateManager.hover.cellPos.col,row:e.stateManager.hover.cellPos.row,cellRange:e.getCellRangeRelativeRect({col:e.stateManager.hover.cellPos.col,row:e.stateManager.hover.cellPos.row}),scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,event:r.nativeEvent,target:null==(p=null==A?void 0:A.eventArgs)?void 0:p.target})),e.hasListeners(I.B.MOUSEENTER_CELL)&&"cell"===(null==M?void 0:M.role)&&(0,y.Z)(M.col)&&(0,y.Z)(M.row)&&(M.col!==e.stateManager.hover.cellPos.col||M.row!==e.stateManager.hover.cellPos.row)&&(M.col!==(null==(g=e.stateManager.hover.cellPosContainHeader)?void 0:g.col)||M.row!==(null==(f=e.stateManager.hover.cellPosContainHeader)?void 0:f.row))&&e.fireListeners(I.B.MOUSEENTER_CELL,{col:M.col,row:M.row,cellRange:e.getCellRangeRelativeRect({col:M.col,row:M.row}),scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,event:r.nativeEvent,target:null==(m=null==A?void 0:A.eventArgs)?void 0:m.target,mergeCellInfo:null==(v=A.eventArgs)?void 0:v.mergeInfo}),t.dealIconHover(A),t.dealTableHover(A),e.theme.columnResize.visibleOnHover&&t.checkColumnResize(A,!0),A.eventArgs&&e.hasListeners(I.B.MOUSEMOVE_CELL)){let t,i;if(null==(b=A.eventArgs)?void 0:b.target){let e=iG(null==(_=A.eventArgs)?void 0:_.target);e&&(t=e.icon,i=e.position)}e.fireListeners(I.B.MOUSEMOVE_CELL,{col:A.eventArgs.col,row:A.eventArgs.row,x:A.abstractPos.x,y:A.abstractPos.y,event:r.nativeEvent,targetIcon:t?{name:t.name,position:i,funcType:t.attribute.funcType}:void 0,target:null==(C=null==A?void 0:A.eventArgs)?void 0:C.target,mergeCellInfo:null==(x=A.eventArgs)?void 0:x.mergeInfo})}}),e.scenegraph.tableGroup.addEventListener("pointerout",e=>{var i;let r=(0,io.RJ)(e),n=null==(i=null==r?void 0:r.eventArgs)?void 0:i.target;"table"===(null==n?void 0:n.role)&&t.dealTableHover()}),e.scenegraph.tableGroup.addEventListener("pointerover",t=>{var i,r;let n=(0,io.RJ)(t),l=null==(i=null==n?void 0:n.eventArgs)?void 0:i.target;if(l&&e.hasListeners(I.B.MOUSEOVER_CHART_SYMBOL)&&"symbol"===l.type){let i=t.composedPath().find(t=>"cell"===t.roll);if(i){let{col:l,row:s}=i,a={col:l,row:s,field:e.getHeaderField(l,s),value:e.getCellValue(l,s),dataValue:e.getCellOriginValue(l,s),cellHeaderPaths:e.internalProps.layoutMap.getCellHeaderPaths(l,s),title:e.getBodyColumnDefine(l,s).title,cellRange:e.getCellRelativeRect(l,s),event:t.nativeEvent,sparkline:{pointData:void 0},scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,target:null==(r=null==n?void 0:n.eventArgs)?void 0:r.target};e.fireListeners(I.B.MOUSEOVER_CHART_SYMBOL,a)}}}),e.scenegraph.tableGroup.addEventListener("pointerenter",t=>{(e.theme.scrollStyle.horizontalVisible&&"focus"===e.theme.scrollStyle.horizontalVisible||!e.theme.scrollStyle.horizontalVisible&&"focus"===e.theme.scrollStyle.visible)&&i.showHorizontalScrollBar(),(e.theme.scrollStyle.verticalVisible&&"focus"===e.theme.scrollStyle.verticalVisible||!e.theme.scrollStyle.verticalVisible&&"focus"===e.theme.scrollStyle.visible)&&i.showVerticalScrollBar(),e.hasListeners(I.B.MOUSEENTER_TABLE)&&e.fireListeners(I.B.MOUSEENTER_TABLE,{event:t.nativeEvent})}),e.scenegraph.tableGroup.addEventListener("pointerleave",r=>{i.isResizeCol()||i.isResizeRow()||i.isMoveCol()||i.isSelecting()||(i.updateInteractionState(P.F.default),i.updateCursor()),(e.theme.scrollStyle.horizontalVisible&&"focus"===e.theme.scrollStyle.horizontalVisible||!e.theme.scrollStyle.horizontalVisible&&"focus"===e.theme.scrollStyle.visible)&&i.hideHorizontalScrollBar(),(e.theme.scrollStyle.verticalVisible&&"focus"===e.theme.scrollStyle.verticalVisible||!e.theme.scrollStyle.verticalVisible&&"focus"===e.theme.scrollStyle.visible)&&i.hideVerticalScrollBar(),e.hasListeners(I.B.MOUSELEAVE_CELL)&&-1!==e.stateManager.hover.cellPos.col&&-1!==e.stateManager.hover.cellPos.row&&e.fireListeners(I.B.MOUSELEAVE_CELL,{col:e.stateManager.hover.cellPos.col,row:e.stateManager.hover.cellPos.row,cellRange:e.getCellRangeRelativeRect({col:e.stateManager.hover.cellPos.col,row:e.stateManager.hover.cellPos.row}),scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,event:r.nativeEvent,target:void 0}),t.dealTableHover();let n=r.target;n&&!n.isDescendantsOf(e.scenegraph.tableGroup)&&e.fireListeners(I.B.MOUSELEAVE_TABLE,{event:r.nativeEvent})}),e.scenegraph.tableGroup.addEventListener("pointerdown",r=>{var n,l,s,a,o;if(e.hasListeners(I.B.MOUSEDOWN_TABLE)&&e.fireListeners(I.B.MOUSEDOWN_TABLE,{event:r.nativeEvent}),(0,T.u)(),e.eventManager.isDown=!0,e.eventManager.LastBodyPointerXY={x:r.x,y:r.y},e.eventManager.LastPointerXY={x:r.x,y:r.y},0!==r.button)return;let h=(0,io.RJ)(r);if(t.downIcon=void 0,i.interactionState!==P.F.default||(e.isPivotChart()&&"chart"!==(null==(n=null==h?void 0:h.eventArgs)?void 0:n.target.type)&&(e.scenegraph.updateChartState(null,void 0),e.scenegraph.deactivateChart(-1,-1,!0)),(null==(l=h.eventArgs)?void 0:l.target)!==(null==(s=i.residentHoverIcon)?void 0:s.icon)&&i.hideMenu(),"chart"===(null==(a=null==h?void 0:h.eventArgs)?void 0:a.target.type)))return;let d=null==(o=e.editorManager)?void 0:o.completeEdit(r.nativeEvent);(0,B.NC)(d,n=>{var l,s,a,o,d,u,c,p,g,f,m,v;if(!(null==(l=e.options.customConfig)?void 0:l.selectCellWhenCellEditorNotExists)&&!1===n)return;let b=(null==(o=null==(a=null==(s=null==h?void 0:h.eventArgs)?void 0:s.target)?void 0:a.role)?void 0:o.startsWith("icon"))?h.eventArgs.target:(null==(d=r.target.role)?void 0:d.startsWith("icon"))?r.target:void 0;if(t.downIcon=b,b&&!1!==b.attribute.interactive)b.attribute.funcType===N.cI.dragReorder&&(i.startMoveCol(h.eventArgs.col,h.eventArgs.row,h.abstractPos.x,h.abstractPos.y,null==(m=null==(f=h.eventArgs)?void 0:f.event)?void 0:m.nativeEvent),i.updateInteractionState(P.F.grabing));else{if(t.cellIsHeaderCheck(h))return;if("touch"===r.pointerType){if(t.touchEnd=!1,t.touchSetTimeout=setTimeout(()=>{t.isTouchdown=!1,t.isLongTouch=!0,!t.touchEnd&&(t.checkColumnResize(h,!0)||t.checkRowResize(h,!0))||!t.touchEnd&&t.checkColumnMover(h)?i.updateInteractionState(P.F.grabing):t.dealTableSelect(h)&&!t.touchEnd&&i.updateInteractionState(P.F.grabing)},500),e.hasListeners(I.B.MOUSEENTER_CELL)){let t=r.path.find(t=>"cell"===t.role);"cell"===(null==t?void 0:t.role)&&(0,y.Z)(t.col)&&(0,y.Z)(t.row)&&(t.col!==e.stateManager.hover.cellPos.col||t.row!==e.stateManager.hover.cellPos.row)&&(t.col!==(null==(u=e.stateManager.hover.cellPosContainHeader)?void 0:u.col)||t.row!==(null==(c=e.stateManager.hover.cellPosContainHeader)?void 0:c.row))&&e.fireListeners(I.B.MOUSEENTER_CELL,{col:t.col,row:t.row,cellRange:e.getCellRangeRelativeRect({col:t.col,row:t.row}),scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,event:r.nativeEvent,target:null==(p=null==h?void 0:h.eventArgs)?void 0:p.target,mergeCellInfo:null==(g=h.eventArgs)?void 0:g.mergeInfo})}t.dealTableHover(h)}else{if(!t.checkCellFillhandle(h)&&(t.checkColumnResize(h,!0)||t.checkRowResize(h,!0)))return e.scenegraph.updateChartState(null,void 0),e.scenegraph.deactivateChart(-1,-1,!0),void i.updateInteractionState(P.F.grabing);if(t.checkColumnMover(h)||t.checkCellFillhandle(h,!0)&&t.dealFillSelect(h))return void i.updateInteractionState(P.F.grabing);t.dealTableSelect(h)&&i.updateInteractionState(P.F.grabing)}}if(e.hasListeners(I.B.MOUSEDOWN_CELL)){let t=(0,io.RJ)(r);t.eventArgs&&e.fireListeners(I.B.MOUSEDOWN_CELL,{col:t.eventArgs.col,row:t.eventArgs.row,event:r.nativeEvent,target:null==(v=null==t?void 0:t.eventArgs)?void 0:v.target,mergeCellInfo:t.eventArgs.mergeInfo})}})}),e.scenegraph.tableGroup.addEventListener("pointerup",r=>{var n,l,s,a,o,h,d,u;if(0===r.button){if("grabing"===i.interactionState){if(i.updateInteractionState(P.F.default),i.isResizeCol())rt(e);else if(i.isResizeRow())re(e);else if(i.isMoveCol()){let t=e.stateManager.endMoveCol();i9(e,t,r.nativeEvent)}else if(i.isSelecting()){e.stateManager.endSelectCells(),e.stateManager.isFillHandle()&&e.stateManager.endFillSelect();let t=(0,io.RJ)(r);if(e.eventManager.isDraging&&t.eventArgs&&e.hasListeners(I.B.DRAG_SELECT_END)){let i={event:r.nativeEvent,cells:[],col:t.eventArgs.target.col,row:t.eventArgs.target.row,scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,target:null==(n=null==t?void 0:t.eventArgs)?void 0:n.target,mergeCellInfo:null==(l=t.eventArgs)?void 0:l.mergeInfo};i.cells=e.getSelectedCellInfos(),e.fireListeners(I.B.DRAG_SELECT_END,i)}}}else i.interactionState===P.F.scrolling&&i.updateInteractionState(P.F.default);if(!e.eventManager.isDraging){let i=(0,io.RJ)(r);if(!t.isTouchMove&&0===r.button&&i.eventArgs&&e.hasListeners(I.B.CLICK_CELL)){let t,n,{col:l,row:d}=i.eventArgs,u=e.getCellInfo(l,d);if(null==(s=i.eventArgs)?void 0:s.target){let e=iG(null==(a=i.eventArgs)?void 0:a.target);e&&(t=e.icon,n=e.position)}let c=Object.assign(Object.assign({},u),{event:r.nativeEvent,federatedEvent:r,cells:[],targetIcon:t?{name:t.name,position:n,funcType:t.attribute.funcType}:void 0,target:null==(o=null==i?void 0:i.eventArgs)?void 0:o.target,mergeCellInfo:null==(h=i.eventArgs)?void 0:h.mergeInfo});e.fireListeners(I.B.CLICK_CELL,c)}}if(e.hasListeners(I.B.MOUSEUP_CELL)){let t=(0,io.RJ)(r);t.eventArgs&&e.fireListeners(I.B.MOUSEUP_CELL,{col:t.eventArgs.col,row:t.eventArgs.row,event:r.nativeEvent,target:null==(d=null==t?void 0:t.eventArgs)?void 0:d.target,mergeCellInfo:null==(u=t.eventArgs)?void 0:u.mergeInfo})}setTimeout(()=>{t.isDown=!1,t.isTouchdown=!1,t.isTouchMove=!1,t.isDraging=!1,t.touchMovePoints=[]},0)}}),e.scenegraph.tableGroup.addEventListener("rightdown",t=>{var r,n,l,s,a,o,h;let d=(0,io.RJ)(t);if(d.eventArgs){i.triggerContextMenu(d.eventArgs.col,d.eventArgs.row,d.abstractPos.x,d.abstractPos.y);let{col:u,row:c}=d.eventArgs;if(u>=0&&c>=0){let i=e.getSelectedCellRanges(),p=!1;if(i.length>0)for(let t=0;t<i.length;t++){let e=i[t],r=e.start.col,n=e.end.col,l=e.start.row,s=e.end.row;if(u>=r&&u<=n&&c>=l&&c<=s||u>=n&&u<=r&&c>=s&&c<=l||u>=r&&u<=n&&c>=s&&c<=l||u>=n&&u<=r&&c>=l&&c<=s){p=!0;break}}let g=null==(r=e.options.select)?void 0:r.disableSelectOnContextMenu;if(p||g||e.selectCell(u,c),e.hasListeners(I.B.CONTEXTMENU_CELL)){let i,r,p=e.getCellInfo(u,c);if(null==(n=d.eventArgs)?void 0:n.target){let t=iG(null==(l=d.eventArgs)?void 0:l.target);t&&(i=t.icon,r=t.position)}let g=Object.assign(Object.assign({},p),{event:t.nativeEvent,cells:[],targetIcon:i?{name:i.name,position:r,funcType:i.attribute.funcType}:void 0,target:null==(s=null==d?void 0:d.eventArgs)?void 0:s.target,mergeCellInfo:null==(a=d.eventArgs)?void 0:a.mergeInfo});(null==(h=null==(o=e.options.eventOptions)?void 0:o.contextmenuReturnAllSelectedCells)||h)&&((0,B.yD)(e.stateManager.select.ranges,u,c)?g.cells=e.getSelectedCellInfos():g.cells=[[p]]),e.fireListeners(I.B.CONTEXTMENU_CELL,g)}}}}),e.scenegraph.tableGroup.addEventListener("pointertap",r=>{var n;if(e.stateManager.columnResize.resizing)return;let l=(0,io.RJ)(r);if(!e.stateManager.columnResize.resizing&&!e.stateManager.columnMove.moving&&(t.dealIconClick(r,l),(null==l?void 0:l.eventArgs)&&t.touchSetTimeout&&"touch"===r.pointerType)){let e=(0,io.RJ)(r);if(t.touchSetTimeout){clearTimeout(t.touchSetTimeout);let r=!!(null==(n=i.select.ranges)?void 0:n.length);t.dealTableSelect(e),i.endSelectCells(!0,r),t.touchSetTimeout=void 0}}}),e.scenegraph.stage.addEventListener("pointerdown",r=>{var n,l,s,a;let o=(0,io.RJ)(r);(null==(n=o.eventArgs)?void 0:n.target)&&(null==(l=o.eventArgs)?void 0:l.target)===(null==(s=i.residentHoverIcon)?void 0:s.icon)||i.hideMenu();let h=!1,d=r.target;d===e.scenegraph.tableGroup||d.isDescendantsOf(e.scenegraph.tableGroup)||(h=null==(a=e.editorManager)?void 0:a.completeEdit(r.nativeEvent)),(0,B.NC)(h,n=>{var l,s;if(!(null==(l=e.options.customConfig)?void 0:l.selectCellWhenCellEditorNotExists)&&!1===n)return;let a=(null==(s=r.target.role)?void 0:s.startsWith("icon"))?r.target:void 0;if(t.downIcon=a,"touch"===r.pointerType||a||t.checkCellFillhandle(o)||i.columnResize.resizing||!t.checkColumnResize(o,!0));else{e.scenegraph.updateChartState(null,void 0),e.scenegraph.deactivateChart(-1,-1,!0),i.updateInteractionState(P.F.grabing);let{eventArgs:t}=o;!(null==t?void 0:t.targetCell)&&e.getCellAt(o.abstractPos.x-e.theme.columnResize.resizeHotSpotSize/2,o.abstractPos.y)&&e.hasListeners(I.B.MOUSEDOWN_TABLE)&&e.fireListeners(I.B.MOUSEDOWN_TABLE,{event:r.nativeEvent})}})}),e.scenegraph.stage.addEventListener("pointerup",t=>{"grabing"===i.interactionState&&(i.updateInteractionState(P.F.default),i.isResizeCol()?rt(e):i.isResizeRow()&&re(e))}),e.scenegraph.stage.addEventListener("pointertap",r=>{var n,l,s,a,o;let h=r.target;if(e.eventManager.isDraging||!h||!h.isDescendantsOf(e.scenegraph.stage)&&h.stage!==h||h.isDescendantsOf(e.scenegraph.tableGroup))e.eventManager.isDraging&&i.isSelecting()&&i.endSelectCells();else{i.updateInteractionState(P.F.default),t.dealTableHover();let h=!!(null==(n=i.select.ranges)?void 0:n.length);(null==(l=e.options.customConfig)?void 0:l.cancelSelectCellHook)?(null==(s=e.options.customConfig)?void 0:s.cancelSelectCellHook(r))&&t.dealTableSelect():(null==(o=null==(a=e.options.select)?void 0:a.blankAreaClickDeselect)||o)&&t.dealTableSelect(),i.endSelectCells(!0,h),i.updateCursor(),e.scenegraph.updateChartState(null,void 0),e.scenegraph.deactivateChart(-1,-1,!0)}}),e.scenegraph.stage.addEventListener("pointermove",r=>{var n,l,s;let a=(0,io.RJ)(r);null!=(s=null==(l=null==(n=r.target)?void 0:n.isDescendantsOf)?void 0:l.call(n,e.scenegraph.tableGroup))&&s&&(i.isResizeCol()||t.checkColumnResize(a)?e.stateManager.select&&t.checkCellFillhandle(a)?i.updateCursor("crosshair"):i.updateCursor("col-resize"):i.isResizeRow()||t.checkRowResize(a)?e.stateManager.select&&t.checkCellFillhandle(a)?i.updateCursor("crosshair"):i.updateCursor("row-resize"):i.isMoveCol()||i.updateCursor())}),e.scenegraph.tableGroup.addEventListener("checkbox_state_change",t=>{var i,r;let n=(0,io.RJ)(t),{col:l,row:s}=n.eventArgs,a=e.getCellInfo(l,s),o=(0,j.Z)(e,l,s);if(o)for(let i=o.start.col;i<=o.end.col;i++)for(let r=o.start.row;r<=o.end.row;r++)e.scenegraph.getCell(i,r).forEachChildren(e=>{"checkbox"===e.name&&e.setAttributes({checked:t.target.attribute.checked,indeterminate:t.target.attribute.indeterminate})});let h=Object.assign(Object.assign({},a),{event:t.nativeEvent,target:null==(i=null==n?void 0:n.eventArgs)?void 0:i.target,mergeCellInfo:null==(r=null==n?void 0:n.eventArgs)?void 0:r.mergeInfo,checked:t.detail.checked});if(e.isHeader(l,s))e.stateManager.setHeaderCheckedState(a.field,t.detail.checked),e.internalProps.enableHeaderCheckboxCascade&&"checkbox"===e.getCellType(l,s)&&e.scenegraph.updateCheckboxCellState(l,s,t.detail.checked);else if(e.stateManager.setCheckedState(l,s,a.field,t.detail.checked),e.internalProps.enableCheckboxCascade&&"checkbox"===e.getCellType(l,s)){let t=e.stateManager.headerCheckedState[a.field],i=e.stateManager.updateHeaderCheckedState(a.field,l,s);t!==i&&e.scenegraph.updateHeaderCheckboxCellState(l,s,i)}e.fireListeners(I.B.CHECKBOX_STATE_CHANGE,h),e.scenegraph.updateNextFrame()}),e.scenegraph.tableGroup.addEventListener("radio_checked",t=>{var i,r,n;let l=(0,io.RJ)(t),{col:s,row:a,target:o}=l.eventArgs,h=e.getCellInfo(s,a),d=null==(i=io.xD.exec(o.id))?void 0:i[1],u=(0,j.Z)(e,s,a);if(u)for(let t=u.start.col;t<=u.end.col;t++)for(let i=u.start.row;i<=u.end.row;i++)e.scenegraph.getCell(t,i).forEachChildren(t=>{"radio"===t.name&&t.id===o.id&&t.setAttributes({checked:!0})});let c=e.getBodyColumnDefine(s,a).radioCheckType||"column";if("cell"===c)if(u)for(let t=u.start.col;t<=u.end.col;t++)for(let i=u.start.row;i<=u.end.row;i++)e.scenegraph.getCell(t,i).forEachChildren(t=>{"radio"===t.name&&t.id!==o.id&&t.setAttributes({checked:!1})});else e.scenegraph.getCell(s,a).forEachChildren(t=>{"radio"===t.name&&t.id!==o.id&&t.setAttributes({checked:!1})});else"column"===c&&e.scenegraph.getColGroup(s).forEachChildren(t=>{t.forEachChildren(t=>{"radio"===t.name&&t.id!==o.id&&t.setAttributes({checked:!1})})});let p=d?Number(d):void 0;e.stateManager.setRadioState(s,a,h.field,c,p);let g=Object.assign(Object.assign({},h),{event:t.nativeEvent,target:null==(r=null==l?void 0:l.eventArgs)?void 0:r.target,mergeCellInfo:null==(n=null==l?void 0:l.eventArgs)?void 0:n.mergeInfo,radioIndexInCell:p});e.fireListeners(I.B.RADIO_STATE_CHANGE,g),e.scenegraph.updateNextFrame()}),e.scenegraph.tableGroup.addEventListener("switch_state_change",t=>{var i,r;let n=(0,io.RJ)(t),{col:l,row:s,target:a}=n.eventArgs,o=e.getCellInfo(l,s),h=(0,j.Z)(e,l,s);if(h)for(let i=h.start.col;i<=h.end.col;i++)for(let r=h.start.row;r<=h.end.row;r++)e.scenegraph.getCell(i,r).forEachChildren(e=>{"switch"===e.name&&e.setAttributes({checked:t.target.attribute.checked})});let d=Object.assign(Object.assign({},o),{event:t.nativeEvent,target:null==(i=null==n?void 0:n.eventArgs)?void 0:i.target,mergeCellInfo:null==(r=null==n?void 0:n.eventArgs)?void 0:r.mergeInfo,checked:t.detail.checked});e.stateManager.setCheckedState(l,s,o.field,t.detail.checked),e.fireListeners(I.B.SWITCH_STATE_CHANGE,d),e.scenegraph.updateNextFrame()}),e.scenegraph.stage.addEventListener("wheel",t=>{var r;if(!t.path.find(t=>"legend"===t.name)){null==(r=e.editorManager)||r.completeEdit();let{cellPos:n}=e.stateManager.hover,l=n.col,s=n.row;e.scenegraph.deactivateChart(l,s,!0),e.eventManager._enableTableScroll&&i3(t,i)}})})(this),function(t){let e=t.table,i=e.stateManager,r=e.internalProps.handler;function n(t){var i;if(e.hasListeners(I.B.KEYDOWN)){let r={keyCode:null!=(i=t.keyCode)?i:t.which,code:t.code,event:t,scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth};e.fireListeners(I.B.KEYDOWN,r)}}r.on(e.getElement(),"blur",i=>{var r;let n=i.relatedTarget;if(n){let t=e.stateManager.select.ranges,i=1===t.length&&t[0].start.col===t[0].end.col&&t[0].start.row===t[0].end.row&&e.getEditor(e.stateManager.select.cellPos.col,e.stateManager.select.cellPos.row);if((null==(r=null==i?void 0:i.getInputElement)?void 0:r.call(i))===n)return}t.dealTableHover()}),r.on(e.getElement(),"keydown",r=>{var l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,E,L,F,O,H,D,z;let W={keyCode:null!=(l=r.keyCode)?l:r.which,code:r.code,event:r};if(e.fireListeners(I.B.BEFORE_KEYDOWN,W),"a"===r.key&&(r.ctrlKey||r.metaKey))(null==(s=e.keyboardOptions)?void 0:s.selectAllOnCtrlA)&&(r.preventDefault(),t.deelTableSelectAll());else if(i.select.cellPos.col>=0&&i.select.cellPos.row>=0&&("ArrowUp"===r.key||"ArrowDown"===r.key||"ArrowLeft"===r.key||"ArrowRight"===r.key)){let t,n;if((null==(o=null==(a=e.options.keyboardOptions)?void 0:a.moveEditCellOnArrowKeys)||!o)&&(null==(h=e.editorManager)?void 0:h.editingEditor)||!1===(null==(d=e.options.keyboardOptions)?void 0:d.moveSelectedCellOnArrowKeys)||(r.preventDefault(),r.stopPropagation(),"ArrowUp"===r.key?r.ctrlKey||r.metaKey?(t=i.select.cellPos.col,n=0):(r.shiftKey,t=i.select.cellPos.col,n=Math.min(e.rowCount-1,Math.max(0,i.select.cellPos.row-1))):"ArrowDown"===r.key?r.ctrlKey||r.metaKey?(t=i.select.cellPos.col,n=e.rowCount-1):(r.shiftKey,t=i.select.cellPos.col,n=Math.min(e.rowCount-1,Math.max(0,i.select.cellPos.row+1))):"ArrowLeft"===r.key?r.ctrlKey||r.metaKey?(t=0,n=i.select.cellPos.row):(r.shiftKey,n=i.select.cellPos.row,t=Math.min(e.colCount-1,Math.max(0,i.select.cellPos.col-1))):"ArrowRight"===r.key&&(r.ctrlKey||r.metaKey?(t=e.colCount-1,n=i.select.cellPos.row):(r.shiftKey,n=i.select.cellPos.row,t=Math.min(e.colCount-1,Math.max(0,i.select.cellPos.col+1)))),t1(e,t,n)))return;let l=!!(null==(u=e.editorManager)?void 0:u.editingEditor);null==(c=e.editorManager)||c.completeEdit(),e.getElement().focus();let s=null==(g=null==(p=e.options.keyboardOptions)?void 0:p.shiftMultiSelect)||g;e.selectCell(t,n,r.shiftKey&&s),null!=(m=null==(f=e.options.keyboardOptions)?void 0:f.moveEditCellOnArrowKeys)&&m&&l&&e.getEditor(t,n)&&(null==(y=e.editorManager)||y.startEditCell(t,n))}else if("Escape"===r.key)null==(v=e.editorManager)||v.cancelEdit(),e.getElement().focus();else if("Enter"===r.key){if(null==(b=e.editorManager)?void 0:b.editingEditor){if(n(r),null==(_=e.editorManager)||_.completeEdit(),e.getElement().focus(),!0===(null==(C=e.options.keyboardOptions)?void 0:C.moveFocusCellOnEnter)){let t=i.select.cellPos.col,n=Math.min(e.rowCount-1,Math.max(0,i.select.cellPos.row+1));if(t1(e,t,n))return;let l=null==(w=null==(x=e.options.keyboardOptions)?void 0:x.shiftMultiSelect)||w;e.selectCell(t,n,r.shiftKey&&l)}return}if(!0===(null==(S=e.options.keyboardOptions)?void 0:S.moveFocusCellOnEnter)){let t=i.select.cellPos.col,n=Math.min(e.rowCount-1,Math.max(0,i.select.cellPos.row+1));if(t1(e,t,n))return;let l=null==(M=null==(A=e.options.keyboardOptions)?void 0:A.shiftMultiSelect)||M;e.selectCell(t,n,r.shiftKey&&l)}else if((null==(k=null==(T=e.options.keyboardOptions)?void 0:T.editCellOnEnter)||k)&&1===(null!=(P=null==(R=e.stateManager.select.ranges)?void 0:R.length)?P:0)){let t=e.stateManager.select.ranges[0].start.col,i=e.stateManager.select.ranges[0].start.row,r=e.stateManager.select.ranges[0].end.col,n=e.stateManager.select.ranges[0].end.row;t===r&&i===n&&e.getEditor(t,i)&&(null==(B=e.editorManager)||B.startEditCell(t,i))}}else if("Tab"===r.key){if((null==(L=null==(E=e.options.keyboardOptions)?void 0:E.moveFocusCellOnTab)||L)&&i.select.cellPos.col>=0&&i.select.cellPos.row>=0){let t,n;if(i.select.cellPos.col===e.colCount-1&&i.select.cellPos.row===e.rowCount-1||(r.preventDefault(),i.select.cellPos.col===e.colCount-1?(n=Math.min(e.rowCount-1,i.select.cellPos.row+1),t=e.rowHeaderLevelCount):(n=i.select.cellPos.row,t=i.select.cellPos.col+1),t1(e,t,n)))return;let l=!!(null==(F=e.editorManager)?void 0:F.editingEditor);null==(O=e.editorManager)||O.completeEdit(),e.getElement().focus(),e.selectCell(t,n),l&&e.getEditor(t,n)&&(null==(H=e.editorManager)||H.startEditCell(t,n))}}else if(!r.ctrlKey&&!r.metaKey){let t=e.options.editCellTrigger,n=e.stateManager.select.ranges;1===n.length&&n[0].start.col===n[0].end.col&&n[0].start.row===n[0].end.row&&("keydown"===t||Array.isArray(t)&&t.includes("keydown"))&&!(null==(D=e.editorManager)?void 0:D.editingEditor)&&r.key.match(/^[a-zA-Z0-9+\-*\/%=.,\s]$/)&&(e.editorManager&&(e.editorManager.beginTriggerEditCellMode="keydown"),null==(z=e.editorManager)||z.startEditCell(i.select.cellPos.col,i.select.cellPos.row,""))}n(r)}),r.on(e.getElement(),"copy",i=>rn(this,void 0,void 0,function*(){var r;(null==(r=e.keyboardOptions)?void 0:r.copySelected)&&t.handleCopy(i)})),r.on(e.getElement(),"cut",i=>rn(this,void 0,void 0,function*(){var r;(null==(r=e.keyboardOptions)?void 0:r.cutSelected)&&t.handleCut(i)})),r.on(e.getElement(),"paste",i=>rn(this,void 0,void 0,function*(){var r;(null==(r=e.keyboardOptions)?void 0:r.pasteValueToCell)&&t.handlePaste(i)})),r.on(e.getElement(),"contextmenu",t=>{var i;!1!==(null==(i=e.eventOptions)?void 0:i.preventDefaultContextMenu)?t.preventDefault():s(t)}),e.options.canvas||r.on(e.getContainer(),"resize",t=>{var i;e.isReleased||0===t.width&&0===t.height||((e.autoFillWidth||e.autoFillHeight||"adaptive"===e.widthMode||"adaptive"===e.heightMode)&&(null==(i=e.editorManager)||i.completeEdit()),(0,y.Z)(e.options.pixelRatio)||e.setPixelRatio(rr()),t.windowSizeNotChange||e.resize())});let l=r=>{var n;if(e.isReleased)return;e.eventManager.LastBodyPointerXY={x:r.x,y:r.y},e.eventManager.isDown=!0;let l=r.target;if(!e.getElement().contains(l)&&!e.internalProps.menuHandler.containElement(l)){let l=null==(n=e.editorManager)?void 0:n.completeEdit(r);(0,B.NC)(l,r=>{var n,l;if(!1!==r&&(null==(n=e.options.select)?void 0:n.outsideClickDeselect)){let e=!!(null==(l=i.select.ranges)?void 0:l.length);t.dealTableSelect(),i.endSelectCells(!0,e)}}),e.scenegraph.updateChartState(null,void 0),e.scenegraph.deactivateChart(-1,-1,!0)}};t.globalEventListeners.push({name:"pointerdown",env:"vglobal",callback:l}),W.rF.addEventListener("pointerdown",l);let s=r=>{var n,l;if(e.isReleased)return;let s=r.target;if(s!==e.canvas&&(t=>{var r,n;if(i.menu.isShow&&setTimeout(()=>{e.internalProps.menuHandler.pointInMenuElement(t.clientX,t.clientY)||i.menu.isShow&&i.hideMenu()},0),i.isResizeCol())rt(e);else if(i.isResizeRow())re(e);else if(i.isMoveCol()){let i=e.stateManager.endMoveCol();i9(e,i,t)}else if(i.isSelecting()&&(null==(n=null==(r=e.stateManager.select)?void 0:r.ranges)?void 0:n.length)){let i=e.stateManager.select.ranges[e.stateManager.select.ranges.length-1].end.col,r=e.stateManager.select.ranges[e.stateManager.select.ranges.length-1].end.row;if(e.stateManager.endSelectCells(),e.hasListeners(I.B.DRAG_SELECT_END)){let n={event:t,cells:[],col:i,row:r,scaleRatio:e.canvas.getBoundingClientRect().width/e.canvas.offsetWidth,target:void 0};n.cells=e.getSelectedCellInfos(),e.fireListeners(I.B.DRAG_SELECT_END,n)}}})(r),e.eventManager.LastBodyPointerXY=null,e.eventManager.isDown=!1,e.eventManager.isDraging=!1,e.eventManager.inertiaScroll.endInertia(),"grabing"===i.interactionState&&i.isResizeCol())rt(e);else if("grabing"===i.interactionState&&i.isResizeRow())re(e);else if(i.isMoveCol()){let t=e.stateManager.endMoveCol();i9(e,t,r)}else if((null==(n=e.editorManager)?void 0:n.editingEditor)&&!e.getElement().contains(s)){let n=null==(l=e.editorManager)?void 0:l.completeEdit(r);(0,B.NC)(n,e=>{!1!==e&&(i.updateInteractionState(P.F.default),t.dealTableHover())})}i.updateInteractionState(P.F.default)};t.globalEventListeners.push({name:"pointerup",env:"vglobal",callback:s}),W.rF.addEventListener("pointerup",s);let a=r=>{var n,l,s,a,o;if(e.eventManager.isDown&&e.eventManager.LastBodyPointerXY){let t=null!=(l=null==(n=e.eventManager.LastBodyPointerXY)?void 0:n.x)?l:r.x,i=null!=(a=null==(s=e.eventManager.LastBodyPointerXY)?void 0:s.y)?a:r.y;(Math.abs(t-r.x)>1||Math.abs(i-r.y)>1)&&(e.eventManager.isDraging=!0)}let{x:h,y:d}=e._getMouseAbstractPoint(r);i.interactionState===P.F.grabing&&(i.isResizeCol()?(t.dealColumnResize(h,d),e.hasListeners(I.B.RESIZE_COLUMN)&&e.fireListeners(I.B.RESIZE_COLUMN,{col:e.stateManager.columnResize.col,colWidth:e.getColWidth(e.stateManager.columnResize.col)})):i.isResizeRow()?(t.dealRowResize(h,d),e.hasListeners(I.B.RESIZE_ROW)&&e.fireListeners(I.B.RESIZE_ROW,{row:e.stateManager.rowResize.row,rowHeight:e.getRowHeight(e.stateManager.rowResize.row)})):i.isMoveCol()&&t.dealColumnMover(h,d,r));let u=e.stateManager.isSelecting();if(t._enableTableScroll&&t.isDraging&&u&&(null==(o=e.stateManager.select.ranges)?void 0:o.length)>0){let t=e.getDrawRange(),i=e.getFrozenRowsHeight(),r=e.getBottomFrozenRowsHeight(),n=e.getFrozenColsWidth(),l=e.getRightFrozenColsWidth(),s=e.stateManager.select.ranges[e.stateManager.select.ranges.length-1].start;if(e.isSeriesNumber(s.col,s.row))return;let a=e.stateManager.select.ranges[e.stateManager.select.ranges.length-1].end,o=(!1===e.isFrozenRow(s.row)||!1===e.isFrozenRow(a.row))&&e.getAllRowsHeight()>e.tableNoFrameHeight,u=(!1===e.isFrozenColumn(s.col)||!1===e.isFrozenColumn(a.col))&&e.getAllColsWidth()>e.tableNoFrameWidth;if((d>t.bottom-r||d<t.top+i)&&o||(h>t.right-l||h<t.left+n)&&u){e.eventManager.scrollXSpeed=0,e.eventManager.scrollYSpeed=0;let s=!1,a=!1,c=!1,p=!1;d>t.bottom-r&&o&&e.scrollTop+e.tableNoFrameHeight<e.getAllRowsHeight()?(s=!0,e.eventManager.scrollYSpeed=-(d-t.bottom+r)/50):d<t.top+i&&o&&e.scrollTop>0&&(a=!0,e.eventManager.scrollYSpeed=-(d-t.top-i)/50),h>t.right-l&&u&&e.scrollLeft+e.tableNoFrameWidth<e.getAllColsWidth()?(c=!0,e.eventManager.scrollXSpeed=-(h-t.right+l)/50):h<t.left+n&&u&&e.scrollLeft>0&&(p=!0,e.eventManager.scrollXSpeed=-(h-t.left-n)/50),e.eventManager.inertiaScroll.startInertia(e.eventManager.scrollXSpeed,e.eventManager.scrollYSpeed,1),e.eventManager.inertiaScroll.setScrollHandle((o,u)=>{var g;let f,m;i3({deltaX:-o,deltaY:-u},e.stateManager,!1),s?m=e.scrollTop+t.height-r-20:a&&(m=e.scrollTop+i+20),c?f=e.scrollLeft+t.width-l-20:p&&(f=e.scrollLeft+n+20);let v=!1,b=!1;c||p||(h>e.tableNoFrameWidth-e.getRightFrozenColsWidth()&&h<e.tableNoFrameWidth||h>0&&h<e.getFrozenColsWidth()?(f=h,b=!0):f=e.scrollLeft+h),s||a||(d>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()&&d<e.tableNoFrameHeight||d>0&&d<e.getFrozenRowsHeight()?(m=d,v=!0):m=e.scrollTop+d),e.stateManager.updateInteractionState(P.F.grabing);let _=e.getTargetColAtConsiderRightFrozen(f,b),C=e.getTargetRowAtConsiderBottomFrozen(m,v);!(null==(g=e.options.select)?void 0:g.disableDragSelect)&&(0,y.Z)(_)&&(0,y.Z)(C)&&e.stateManager.updateSelectPos("row"===e.stateManager.select.selectInline?e.colCount-1:_.col,"col"===e.stateManager.select.selectInline?e.rowCount-1:C.row,!1,!1,!1,!1)})}else e.eventManager.inertiaScroll.isInertiaScrolling()?e.eventManager.inertiaScroll.endInertia():e.eventManager.scrollYSpeed=0}};t.globalEventListeners.push({name:"pointermove",env:"vglobal",callback:a}),W.rF.addEventListener("pointermove",a)}(this),function(t){let e=t.table,i=e.stateManager,r=e.scenegraph;r.component.vScrollBar.addEventListener("pointerover",t=>{i.showVerticalScrollBar()}),r.component.hScrollBar.addEventListener("pointerover",t=>{i.showHorizontalScrollBar()}),r.component.vScrollBar.addEventListener("pointerout",t=>{i.interactionState!==P.F.scrolling&&i.hideVerticalScrollBar()}),r.component.hScrollBar.addEventListener("pointerout",t=>{i.interactionState!==P.F.scrolling&&i.hideHorizontalScrollBar()}),r.component.vScrollBar.addEventListener("pointermove",t=>{r.table.stateManager.updateCursor("default"),t.stopPropagation()}),r.component.vScrollBar.addEventListener("pointerdown",t=>{t.stopPropagation(),r.table.hasListeners(I.B.MOUSEDOWN_TABLE)&&r.table.fireListeners(I.B.MOUSEDOWN_TABLE,{event:t.nativeEvent})}),r.component.vScrollBar.addEventListener("scrollDown",t=>{var e;r.table.eventManager.LastBodyPointerXY={x:t.x,y:t.y},r.table.eventManager.isDown=!0,i.interactionState!==P.F.scrolling&&i.updateInteractionState(P.F.scrolling),r.table.stateManager.hideMenu(),null==(e=r.table.editorManager)||e.completeEdit(),r.table.hasListeners(I.B.MOUSEDOWN_TABLE)&&r.table.fireListeners(I.B.MOUSEDOWN_TABLE,{event:t.nativeEvent})}),r.component.vScrollBar.addEventListener("pointerup",()=>{i.fastScrolling=!1,r.table.eventManager.isDraging=!1,i.interactionState===P.F.scrolling&&i.updateInteractionState(P.F.default)}),r.component.vScrollBar.addEventListener("pointerupoutside",()=>{i.fastScrolling=!1,i.interactionState===P.F.scrolling&&i.updateInteractionState(P.F.default)}),r.component.vScrollBar.addEventListener("scrollUp",t=>{r.table.eventManager.isDraging=!1}),r.component.hScrollBar.addEventListener("pointermove",t=>{r.table.stateManager.updateCursor(),t.stopPropagation()}),r.component.hScrollBar.addEventListener("pointerdown",t=>{t.stopPropagation(),r.table.hasListeners(I.B.MOUSEDOWN_TABLE)&&r.table.fireListeners(I.B.MOUSEDOWN_TABLE,{event:t.nativeEvent})}),r.component.hScrollBar.addEventListener("scrollDown",t=>{var e;r.table.eventManager.LastBodyPointerXY={x:t.x,y:t.y},r.table.eventManager.isDown=!0,i.interactionState!==P.F.scrolling&&i.updateInteractionState(P.F.scrolling),r.table.stateManager.hideMenu(),null==(e=r.table.editorManager)||e.completeEdit(),r.table.hasListeners(I.B.MOUSEDOWN_TABLE)&&r.table.fireListeners(I.B.MOUSEDOWN_TABLE,{event:t.nativeEvent})}),r.component.hScrollBar.addEventListener("pointerup",()=>{i.fastScrolling=!1,r.table.eventManager.isDraging=!1,i.interactionState===P.F.scrolling&&i.updateInteractionState(P.F.default)}),r.component.hScrollBar.addEventListener("pointerupoutside",()=>{i.fastScrolling=!1,i.interactionState===P.F.scrolling&&i.updateInteractionState(P.F.default)}),r.component.hScrollBar.addEventListener("scrollUp",t=>{r.table.eventManager.isDraging=!1});let n=(0,O.P2)(i.updateVerticalScrollBar,20),l=(0,O.P2)(i.updateHorizontalScrollBar,20);r.component.vScrollBar.addEventListener("scrollDrag",t=>{var l;r.table.eventManager.isDown&&(r.table.eventManager.isDraging=!0),i.fastScrolling=!0,i.interactionState!==P.F.scrolling&&i.updateInteractionState(P.F.scrolling),r.table.stateManager.hideMenu(),null==(l=r.table.editorManager)||l.completeEdit(),e.scenegraph.deactivateChart(-1,-1,!0),n(t.detail.value[0]/(1-t.detail.value[1]+t.detail.value[0]),t)}),r.component.hScrollBar.addEventListener("scrollDrag",t=>{var n;r.table.eventManager.isDown&&(r.table.eventManager.isDraging=!0),i.fastScrolling=!0,i.interactionState!==P.F.scrolling&&i.updateInteractionState(P.F.scrolling),r.table.stateManager.hideMenu(),null==(n=r.table.editorManager)||n.completeEdit(),e.scenegraph.deactivateChart(-1,-1,!0),l(t.detail.value[0]/(1-t.detail.value[1]+t.detail.value[0]))})}(this),function(t){let e=t.table,i=e.stateManager,r=e.scenegraph;if(!1===W.rF.envContribution.supportsTouchEvents)return;W.rF.addEventListener("contextmenu",t=>{t.stopPropagation(),t.preventDefault()},{capture:!0}),t.touchMovePoints=[],e.scenegraph.tableGroup.addEventListener("touchstart",i=>{var n,l,s,a,o,h,d,u;if(i.target.isChildOf(r.component.vScrollBar)||i.target.isChildOf(r.component.vScrollBar))return;t.isTouchdown=!0;let c=i.nativeEvent;t.touchMovePoints.push({x:e.rotateDegree?null!=(s=null==(l=null==(n=c.changedTouches)?void 0:n[0])?void 0:l._canvasX)?s:null==(a=i.canvas)?void 0:a.x:i.page.x,y:e.rotateDegree?null!=(d=null==(h=null==(o=c.changedTouches)?void 0:o[0])?void 0:h._canvasY)?d:null==(u=i.canvas)?void 0:u.y:i.page.y,timestamp:Date.now()})});let n=r=>{var n,l;if(t.isLongTouch&&r.preventDefault(),t.isTouchdown&&rl(r)){if(t.isTouchMove=!0,(null==(l=null==(n=t.downIcon)?void 0:n.attribute)?void 0:l.funcType)===N.cI.dragReorder)r.preventDefault();else if(t.touchMovePoints.length>4&&t.touchMovePoints.shift(),t.touchMovePoints.push({x:e.rotateDegree?r.changedTouches[0]._canvasX:r.changedTouches[0].pageX,y:e.rotateDegree?r.changedTouches[0]._canvasY:r.changedTouches[0].pageY,timestamp:Date.now()}),t._enableTableScroll){let n=-t.touchMovePoints[t.touchMovePoints.length-1].x+t.touchMovePoints[t.touchMovePoints.length-2].x,l=-t.touchMovePoints[t.touchMovePoints.length-1].y+t.touchMovePoints[t.touchMovePoints.length-2].y;i3({deltaX:n,deltaY:l},i),r.cancelable&&("none"===e.internalProps.overscrollBehavior&&(l&&i6(i)||n&&i7(i))||Math.abs(l)>=Math.abs(n)&&0!==l&&i5(l,i)||Math.abs(l)<=Math.abs(n)&&0!==n&&i4(n,i))&&r.preventDefault()}}};W.rF.addEventListener("touchmove",n,{passive:!1}),t.globalEventListeners.push({name:"touchmove",env:"vglobal",callback:n});let l=i=>{var r,n,l,s;if(t.touchEnd=!0,t.isLongTouch=!1,t.isTouchdown&&rl(i)){if((null==(n=null==(r=t.downIcon)?void 0:r.attribute)?void 0:n.funcType)===N.cI.dragReorder)i.preventDefault();else if((null==(l=t.touchMovePoints)?void 0:l.length)&&(t.touchMovePoints.length>4&&t.touchMovePoints.shift(),t.touchMovePoints.push({x:e.rotateDegree?i.changedTouches[0]._canvasX:i.changedTouches[0].pageX,y:e.rotateDegree?i.changedTouches[0]._canvasY:i.changedTouches[0].pageY,timestamp:Date.now()}),t._enableTableScroll)){let i=t.touchMovePoints[0],r=t.touchMovePoints[(null==(s=t.touchMovePoints)?void 0:s.length)-1],n=(r.x-i.x)/(r.timestamp-i.timestamp),l=(r.y-i.y)/(r.timestamp-i.timestamp);t.inertiaScroll.startInertia(n,l,.95),e.eventManager.inertiaScroll.setScrollHandle((t,i)=>{i3({deltaX:-t,deltaY:-i},e.stateManager)})}t.isTouchdown=!1,t.isTouchMove=!1,t.isDraging=!1,t.touchMovePoints=[]}};W.rF.addEventListener("touchend",l),t.globalEventListeners.push({name:"touchend",env:"vglobal",callback:l});let s=e=>{t.touchEnd=!0,t.isLongTouch=!1,t.isTouchdown&&(t.isTouchdown=!1,t.isTouchMove=!1,t.touchMovePoints=[],t.isDraging=!1)};W.rF.addEventListener("touchcancel",s),t.globalEventListeners.push({name:"touchcancel",env:"vglobal",callback:s})}(this),function(t){let e=t.table;t.gesture=new i2.o(e.scenegraph.tableGroup,{tap:{interval:300}}),t.gesture.on("doubletap",t=>{!function(t,e){var i,r,n,l,s,a;let o=(0,io.RJ)(t),h=-1,d=-1;o.eventArgs&&(h=o.eventArgs.col,d=o.eventArgs.row);let u=e.getCellValue(h,d),c=null==(r=null==(i=o.eventArgs)?void 0:i.targetCell)?void 0:r.globalAABBBounds;if(c&&e.internalProps.focusControl.setFocusRect(new F.U(c.x1+e.scrollLeft,c.y1+e.scrollTop,c.x2-c.x1,c.y2-c.y1),u),e.hasListeners(I.B.DBLCLICK_CELL)){let i,r,u=e.getCellInfo(h,d);if(null==(n=o.eventArgs)?void 0:n.target){let t=iG(null==(l=o.eventArgs)?void 0:l.target);t&&(i=t.icon,r=t.position)}let c=Object.assign(Object.assign({},u),{event:t.nativeEvent,federatedEvent:t,cells:[],targetIcon:i?{name:i.name,position:r,funcType:i.attribute.funcType}:void 0,target:null==(s=null==o?void 0:o.eventArgs)?void 0:s.target,mergeCellInfo:null==(a=null==o?void 0:o.eventArgs)?void 0:a.mergeInfo});e.fireListeners(I.B.DBLCLICK_CELL,c)}}(t,e)})}(this)}updateEventBinder(){setTimeout(()=>{var t;this.table.isReleased||(eQ(this.table)&&0===(null==(t=this.handleTextStickBindId)?void 0:t.length)?(this.handleTextStickBindId.push(this.table.on(I.B.SCROLL,t=>{eX(this.table)})),this.handleTextStickBindId.push(this.table.on(I.B.RESIZE_COLUMN_END,t=>{eX(this.table)})),this.handleTextStickBindId.push(this.table.on(I.B.RESIZE_ROW_END,t=>{eX(this.table)}))):!eQ(this.table)&&this.handleTextStickBindId&&(this.handleTextStickBindId.forEach(t=>{this.table.off(t)}),this.handleTextStickBindId=[]),i1(this.table))},0)}bindSelfEvent(){var t,e,i,r,n,l,s,a,o,h,d;this.table.isReleased||((t=this.table).on(I.B.ICON_CLICK,e=>{var i;let{col:r,row:n,x:l,y:s,funcType:a,icon:o,event:h}=e,{stateManager:d}=t;if(a===N.cI.dropDown)d.triggerDropDownMenu(r,n,l,s,h);else if(a===N.cI.sort)d.triggerSort(r,n,o,h);else if(a===N.cI.frozen)d.triggerFreeze(r,n,o);else if(a===N.cI.drillDown)t.fireListeners(iz.z.DRILLMENU_CLICK,t.stateManager.drill);else if(a===N.cI.collapse||a===N.cI.expand){let e=!!(null==(i=d.select.ranges)?void 0:i.length);d.updateSelectPos(-1,-1),d.endSelectCells(!0,e),t.toggleHierarchyState(r,n)}}),(e=this.table).on(I.B.DROPDOWN_MENU_CLICK,()=>{e.stateManager.hideMenu()}),e.on(I.B.SCROLL,()=>{e.stateManager.hideMenu()}),this.updateEventBinder(),i=this.table,"browser"===T.X.mode&&i.on(I.B.CLICK_CELL,t=>{let e,{col:r,row:n}=t;if("image"===t.target.type&&t.target.role&&t.target.role.startsWith("icon"))return;e=i.internalProps.layoutMap.isHeader(r,n)?i.isPivotTable()?i._getHeaderLayoutMap(r,n).headerType:i.getHeaderDefine(r,n).headerType:i.getBodyColumnType(r,n);let l=i.isHeader(r,n)?i.getHeaderDefine(r,n):i.getBodyColumnDefine(r,n),s=i.getCellValue(r,n),a=i.getCellOriginValue(r,n);if("link"===e){let t=(0,B.vi)(l.linkJump,{col:r,row:n,table:i,value:s,dataValue:a,cellHeaderPaths:void 0});if(!(t=!1!==t))return;let e=l.templateLink,o,h=(0,B.vi)(l.linkDetect,{col:r,row:n,table:i,value:s,dataValue:a,cellHeaderPaths:void 0});if(h=!1!==h,e){let t=i.getCellOriginRecord(r,n);if(t&&t.vtableMerge)return;let l=Object.assign({__value:s,__dataValue:a},t);o=(0,iQ.Z)(e)?e(l,r,n,i):e.replace(/\{\s*(\S+?)\s*\}/g,(t,e)=>l[e])}else if(h){if(!i0.tP.test(s))return;o=s}else o=s;if(!o)return;let d=l.linkTarget,u=l.linkWindowFeatures;window.open(o,d,u)}else if("image"===e){let{clickToPreview:t}=l;if(!1===t)return;let e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.backgroundColor="rgba(30, 30, 30, 0.4)",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.overflow="hidden",e.style.zIndex="9999",e.addEventListener("click",t=>{t.target===e&&document.body.removeChild(e)});let i=new Image;i.src=s,i.style.maxWidth="80%",i.style.maxHeight="80%",e.appendChild(i),document.body.appendChild(e)}else if("video"===e){let{clickToPreview:t}=l;if(!1===t)return;let e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.backgroundColor="rgba(30, 30, 30, 0.4)",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.overflow="hidden",e.style.zIndex="9999",e.addEventListener("click",t=>{t.target===e&&document.body.removeChild(e)});let i=document.createElement("video");i.src=s,i.style.maxWidth="80%",i.style.maxHeight="80%",i.setAttribute("preload","auto"),i.setAttribute("controls","true"),e.appendChild(i),document.body.appendChild(e)}}),(r=this.table).on(I.B.DBLCLICK_CELL,t=>{var e,i,n;if(t.federatedEvent){let l=(0,io.RJ)(t.federatedEvent),s=r.scenegraph.getResizeColAt(l.abstractPos.x,l.abstractPos.y,null==(e=l.eventArgs)?void 0:e.targetCell),a=null!=(i=r.options.disableDblclickAutoResizeColWidth)?i:null==(n=r.options.resize)?void 0:n.disableDblclickAutoResizeColWidth;if(r.eventManager.checkCellFillhandle(l))r.fireListeners(I.B.DBLCLICK_FILL_HANDLE,{});else if(r._canResizeColumn(s.col,s.row)&&s.col>=0&&!a){r.scenegraph.updateAutoColWidth(s.col),r.internalProps._widthResizedColMap.add(s.col),r.scenegraph.updateChartSizeForResizeColWidth(s.col);let t=r.stateManager;!(t.columnResize.col<t.table.frozenColCount)||t.table.isPivotTable()||t.table.transpose||t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1,t.columnResize.isRightFrozen),(t.columnResize.col>=t.table.colCount-t.table.rightFrozenColCount&&!t.table.isPivotTable()&&!t.table.transpose||t.table.options.rightFrozenColCount)&&t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount);let e=[];for(let t=0;t<r.colCount;t++)e.push(r.getColWidth(t));r.fireListeners(I.B.RESIZE_COLUMN_END,{col:s.col,colWidths:e})}}}),this.table.isPivotTable()&&function(t){let e=t.internalProps.layoutMap.rowsDefine,i=t.internalProps.layoutMap.columnsDefine;for(let t=0;t<e.length;t++){let i=e[t];if("string"!=typeof i&&(i.drillDown||i.drillUp))return!0}for(let t=0;t<i.length;t++){let e=i[t];if("string"!=typeof e&&(e.drillDown||e.drillUp))return!0}return!1}(this.table)&&((n=this.table).on(I.B.MOUSEENTER_CELL,t=>{let{col:e,row:i}=t;if(-1===e||-1===i)return;let r=n.internalProps.layoutMap.getHeaderDimension(e,i);(null==r?void 0:r.drillDown)||(null==r?void 0:r.drillUp)?n.stateManager.updateDrillState(r.dimensionKey,r.title,r.drillDown,r.drillUp,e,i):n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)}),n.on(I.B.MOUSELEAVE_TABLE,t=>{n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)})),i1(this.table),(l=this.table).isPivotChart()&&l.scenegraph.tableGroup.addEventListener("click",t=>{var e;if(!l.stateManager.columnMove.moving&&!l.stateManager.columnResize.resizing)if("axis-label"===t.target.name){let e,i,{col:r,row:n}=(0,io.RJ)(t).eventArgs,s=l.internalProps.layoutMap;s.indicatorsAsCol?(e=s.getDimensionKeyInChartSpec(s.rowHeaderLevelCount,n),i=s.getCellHeaderPaths(s.rowHeaderLevelCount-2,n).rowHeaderPaths):(e=s.getDimensionKeyInChartSpec(r,s.columnHeaderLevelCount),i=s.getCellHeaderPaths(r,s.columnHeaderLevelCount-1).colHeaderPaths);let a=i.map(t=>({key:t.dimensionKey,value:t.value})).filter(t=>t.key);if(a.push({key:e,value:t.target.attribute.text}),l._selectedDimensionInChart.length&&function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i].key!==e[i].key||t[i].value!==e[i].value)return!1;return!0}(l._selectedDimensionInChart,a))return;l._selectedDimensionInChart=a,s.updateDataStateToChartInstance(),(0,ib.RW)(l.scenegraph),l.scenegraph.updateNextFrame()}else(null==(e=l._selectedDimensionInChart)?void 0:e.length)&&(l._selectedDimensionInChart.length=0,l.internalProps.layoutMap.updateDataStateToChartInstance(),(0,ib.RW)(l.scenegraph),l.scenegraph.updateNextFrame())}),(s=this.table).isPivotChart()&&(s.on(I.B.MOUSEENTER_CELL,t=>{s.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if("axis"===e.name){let e=rs(t.col,t.row,s.internalProps.layoutMap);t.axisPosition=e,s.fireListeners(I.B.MOUSEENTER_AXIS,t)}})}),s.on(I.B.MOUSELEAVE_CELL,t=>{s.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if("axis"===e.name){let e=rs(t.col,t.row,s.internalProps.layoutMap);t.axisPosition=e,s.fireListeners(I.B.MOUSELEAVE_AXIS,t)}})})),(a=this.table).on("checkbox_state_change",t=>{var e;let{col:i,row:r,checked:n,field:l}=t;if(!a.internalProps.layoutMap.isSeriesNumber(i,r)||!0!==a.internalProps.enableCheckboxCascade||a.isHeader(i,r))return;let s=a.getCellOriginRecord(i,r),o=a.dataSource.currentPagerIndexedData,h=a.getRecordShowIndexByCell(i,r),d=o[h];if((0,$.Z)(d)&&(d=[d]),s.vtableMerge||(null==(e=s.children)?void 0:e.length))if(n)rd(a,i,r)===R.g.collapse?rh(!0,d,a,l):ra(!0,h,d,o,a,i),ro(h,d,o,a,i);else{rd(a,i,r)===R.g.collapse?rh(!1,d,a,l):ra(!1,h,d,o,a,i),ro(h,d,o,a,i);let t=a.stateManager.headerCheckedState._vtable_rowSeries_number,e=a.stateManager.updateHeaderCheckedState("_vtable_rowSeries_number",i,r);t!==e&&a.scenegraph.updateHeaderCheckboxCellState(i,r,e)}else ro(h,d,o,a,i)}),(o=this.table).on("checkbox_state_change",t=>{var e;if(!0!==o.internalProps.enableCheckboxCascade)return;let{col:i,row:r,checked:n,field:l}=t,s=o.internalProps.columns.some(t=>t.tree);if(o.internalProps.enableCheckboxCascade,!s||o.isHeader(i,r))return;let a=o.getCellOriginRecord(i,r),h=o.dataSource.currentPagerIndexedData,d=o.getRecordShowIndexByCell(i,r),u=h[d];if((0,$.Z)(u)&&(u=[u]),a.vtableMerge||(null==(e=a.children)?void 0:e.length))if(n)rd(o,i,r)===R.g.collapse?rh(!0,u,o,l):ra(!0,d,u,h,o,i,l),ro(d,u,h,o,i,l);else{rd(o,i,r)===R.g.collapse?rh(!1,u,o,l):ra(!1,d,u,h,o,i,l),ro(d,u,h,o,i,l);let t=o.stateManager.headerCheckedState._vtable_rowSeries_number,e=o.stateManager.updateHeaderCheckedState(l,i,r);t!==e&&o.scenegraph.updateHeaderCheckboxCellState(i,r,e)}else ro(d,u,h,o,i,l)}),(h=this.table).on("checkbox_state_change",t=>{if(!0!==h.internalProps.enableHeaderCheckboxCascade)return;let{col:e,row:i,checked:r,field:n}=t;if(h.isHeader(e,i))h.stateManager.setHeaderCheckedState(n,r),"checkbox"===h.getCellType(e,i)&&h.scenegraph.updateCheckboxCellState(e,i,r);else if(h.stateManager.setCheckedState(e,i,n,r),"checkbox"===h.getCellType(e,i)){let t=h.stateManager.headerCheckedState[n],r=h.stateManager.updateHeaderCheckedState(n,e,i);t!==r&&h.scenegraph.updateHeaderCheckboxCellState(e,i,r)}}),(d=this.table).on(I.B.CLICK_CELL,t=>{let{col:e,row:i,target:r}=t;"button"!==r.name||r.attribute.disable||d.hasListeners(I.B.BUTTON_CLICK)&&d.fireListeners(I.B.BUTTON_CLICK,{col:e,row:i,event:t.event})}))}dealTableHover(t){if(!t)return void this.table.stateManager.updateHoverPos(-1,-1);let{eventArgs:e}=t;e?this.table.stateManager.updateHoverPos(e.col,e.row):this.table.stateManager.updateHoverPos(-1,-1)}dealIconHover(t){let{eventArgs:e}=t;e?this.table.stateManager.updateHoverIcon(e.col,e.row,e.target,e.targetCell):this.table.stateManager.updateHoverIcon(-1,-1,void 0,void 0)}dealMenuHover(t){}dealTableSelect(t,e){var i,r,n,l,s,a,o,h,d;if(!t)return this.table.stateManager.updateSelectPos(-1,-1),!1;let{eventArgs:u}=t;if(u){if("checkbox"===u.target.name||"radio"===u.target.name||"switch"===u.target.name||"button"===u.target.name)return!1;if(this.table.isHeader(u.col,u.row)&&t1(this.table,u.col,u.row))return e||this.table.stateManager.updateSelectPos(-1,-1),!1;if(!this.table.isHeader(u.col,u.row)&&t1(this.table,u.col,u.row)){if(!e){let t=!!(null==(i=this.table.stateManager.select.ranges)?void 0:i.length);this.table.stateManager.updateSelectPos(-1,-1),t&&this.table.stateManager.endSelectCells(!0,t)}return!1}if(this.table.isPivotChart()&&("axis-label"===(null==(r=null==t?void 0:t.eventArgs)?void 0:r.target.name)||"chart"===(null==(n=null==t?void 0:t.eventArgs)?void 0:n.target.type)))return this.table.stateManager.updateSelectPos(-1,-1),!1;let c=null==(s=null==(l=this.table.keyboardOptions)?void 0:l.shiftMultiSelect)||s,p=null==(o=null==(a=this.table.keyboardOptions)?void 0:a.ctrlMultiSelect)||o;return this.table.stateManager.updateSelectPos("row"===this.table.stateManager.select.selectInline?this.table.colCount-1:u.col,"col"===this.table.stateManager.select.selectInline?this.table.rowCount-1:u.row,u.event.shiftKey&&c,(u.event.ctrlKey||u.event.metaKey)&&p,!1,!e&&(null==(d=null==(h=this.table.options.select)?void 0:h.makeSelectCellVisible)||d)),!0}return!1}dealFillSelect(t,e){var i,r,n,l,s,a,o,h;let{eventArgs:d}=t;if(d){if((null==(r=null==(i=this.table.stateManager.select)?void 0:i.ranges)?void 0:r.length)&&this.table.stateManager.isFillHandle()){let i,r,s=this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1];e&&((0,y.Z)(this.table.stateManager.fillHandle.directionRow)||(Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.directionRow=!0:this.table.stateManager.fillHandle.directionRow=!1),Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.startY-t.abstractPos.y>0?this.table.stateManager.fillHandle.direction="top":this.table.stateManager.fillHandle.direction="bottom":this.table.stateManager.fillHandle.startX-t.abstractPos.x>0?this.table.stateManager.fillHandle.direction="left":this.table.stateManager.fillHandle.direction="right",this.table.stateManager.fillHandle.directionRow?(i=d.row,r=s.end.col):(i=s.end.row,r=d.col));let a=null==(l=null==(n=this.table.keyboardOptions)?void 0:n.ctrlMultiSelect)||l;this.table.stateManager.updateSelectPos(e?r:s.end.col,e?i:s.end.row,!0,(d.event.ctrlKey||d.event.metaKey)&&a,!1,!e)}else{let t=null==(a=null==(s=this.table.keyboardOptions)?void 0:s.shiftMultiSelect)||a,i=null==(h=null==(o=this.table.keyboardOptions)?void 0:o.ctrlMultiSelect)||h;this.table.stateManager.updateSelectPos(d.col,d.row,d.event.shiftKey&&t,(d.event.ctrlKey||d.event.metaKey)&&i,!1,!e)}return!0}return!1}deelTableSelectAll(){this.table.stateManager.updateSelectPos(-1,-1,!1,!1,!0),this.table.fireListeners(I.B.SELECTED_CELL,{ranges:this.table.stateManager.select.ranges,col:0,row:0})}dealMenuSelect(t){}checkColumnResize(t,e){let{eventArgs:i}=t;if(this.table.internalProps.enableTreeStickCell&&!i)return!1;let r=this.table.scenegraph.getResizeColAt(t.abstractPos.x,t.abstractPos.y,null==i?void 0:i.targetCell),n=!0;return this.table.internalProps.canResizeColumn&&!this.table.internalProps.canResizeColumn(r.col,r.row,this.table)&&(n=!1),n&&this.table._canResizeColumn(r.col,r.row)&&r.col>=0?(e&&this.table.stateManager.startResizeCol(r.col,t.abstractPos.x,t.abstractPos.y,r.rightFrozen),!0):(this.table.stateManager.isResizeCol()&&this.table.stateManager.endResizeCol(),!1)}checkRowResize(t,e){let{eventArgs:i}=t;if(i){let r=this.table.scenegraph.getResizeRowAt(t.abstractPos.x,t.abstractPos.y,i.targetCell);if(this.table._canResizeRow(r.col,r.row)&&r.row>=0)return e&&this.table.stateManager.startResizeRow(r.row,t.abstractPos.x,t.abstractPos.y,r.bottomFrozen),!0}return!1}cellIsHeaderCheck(t,e){let{eventArgs:i}=t,{col:r,row:n,target:l}=i;return!!this.table.isHeader(r,n)&&"checkbox"===this.table.getCellType(i.col,i.row)&&"checkbox"===l.name}checkCellFillhandle(t,e){var i,r,n,l,s;if("function"==typeof(null==(i=this.table.options.excelOptions)?void 0:i.fillHandle)?this.table.options.excelOptions.fillHandle({selectRanges:this.table.stateManager.select.ranges,table:this.table}):null==(r=this.table.options.excelOptions)?void 0:r.fillHandle){let{eventArgs:i}=t;if(i&&(null==(l=null==(n=this.table.stateManager.select)?void 0:n.ranges)?void 0:l.length)){let i,r,n=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),l=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row),a=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),o=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row);i=n<this.table.colCount-1?this.table.scenegraph.highPerformanceGetCell(n,l).globalAABBBounds.x2:0===a?this.table.scenegraph.highPerformanceGetCell(0,l).globalAABBBounds.x1:this.table.scenegraph.highPerformanceGetCell(a-1,l).globalAABBBounds.x2;let h=Math.abs(t.abstractPos.x-i);r=l<this.table.rowCount-1?this.table.scenegraph.highPerformanceGetCell(n,l).globalAABBBounds.y2:this.table.scenegraph.highPerformanceGetCell(n,o-1).globalAABBBounds.y2;let d=Math.abs(t.abstractPos.y-r);if((null==(s=this.table.stateManager.fillHandle)?void 0:s.isFilling)||h<=9&&d<=9)return e&&this.table.stateManager.startFillSelect(t.abstractPos.x,t.abstractPos.y),!0}}return!1}dealColumnResize(t,e){this.table.stateManager.updateResizeCol(t,e)}dealRowResize(t,e){this.table.stateManager.updateResizeRow(t,e)}checkColumnMover(t){var e;let{eventArgs:i}=t;return!(!i||!this.table._canDragHeaderPosition(i.col,i.row))&&(this.table.stateManager.startMoveCol(i.col,i.row,t.abstractPos.x,t.abstractPos.y,null==(e=null==i?void 0:i.event)?void 0:e.nativeEvent),!0)}dealColumnMover(t,e,i){let r=this.table.getColAtRelativePosition(t),n=this.table.getRowAtRelativePosition(e);-1===r&&"row"===this.table.stateManager.columnMove.movingColumnOrRow&&(r=0),-1===n&&"column"===this.table.stateManager.columnMove.movingColumnOrRow&&(n=0),(0,y.Z)(r)&&(0,y.Z)(n)&&this.table.stateManager.updateMoveCol(r,n,t,e,i)}startColumnResize(t){}dealIconClick(t,e){let{eventArgs:i}=e,{target:r,event:n,col:l,row:s}=i||{target:t.target,event:t,col:-1,row:-1};if(r.role&&r.role.startsWith("icon-"))return this.table.fireListeners(I.B.ICON_CLICK,{name:r.name,x:(r.globalAABBBounds.x1+r.globalAABBBounds.x2)/2,y:r.globalAABBBounds.y2,col:l,row:s,funcType:r.attribute.funcType,icon:r,event:n}),!0;if(r instanceof iJ.H){let t=r.pickIcon(n.global);if(t)return this.table.fireListeners(I.B.ICON_CLICK,{name:t.attribute.id,x:t.globalX+t.globalAABBBounds.width()/2,y:t.globalY+t.AABBBounds.height(),col:l,row:s,funcType:t.attribute.funcType,icon:t,event:n}),!0}return!1}release(){var t;null==(t=this.gesture)||t.release(),this.globalEventListeners.forEach(t=>{"document"===t.env?document.removeEventListener(t.name,t.callback):"body"===t.env?document.body.removeEventListener(t.name,t.callback):"window"===t.env?window.removeEventListener(t.name,t.callback):"vglobal"===t.env&&W.rF.removeEventListener(t.name,t.callback)}),this.globalEventListeners=[]}enableScroll(){this._enableTableScroll=!0}disableScroll(){this._enableTableScroll=!1}handleCopy(t,e=!1){var i,r,n,l,s,a;return ru(this,void 0,void 0,function*(){let o=this.table;e||(this.cutWaitPaste=!1),this.copySourceRange=null;let h=o.stateManager.select.ranges;if(h&&1===h.length){let t=h[0];this.copySourceRange={startCol:Math.min(t.start.col,t.end.col),startRow:Math.min(t.start.row,t.end.row)}}else if(!(null==h?void 0:h.length))return void(this.copySourceRange=null);let d=this.table.getCopyValue(null==(r=null==(i=o.options.keyboardOptions)?void 0:i.getCopyCellValue)?void 0:r.value);if((0,y.Z)(d)){t.preventDefault();let i=o.getElement();i&&i!==document.activeElement&&(i.focus(),yield new Promise(t=>setTimeout(t,10)));try{if(navigator.clipboard&&navigator.clipboard.writeText){let e=!0;if(navigator.permissions&&navigator.permissions.query)try{e="granted"===(yield navigator.permissions.query({name:"clipboard-write"})).state}catch(t){e=!0}if(e)try{if(window.ClipboardItem){let t=d;1===o.stateManager.select.ranges.length&&(null==(l=null==(n=o.options.keyboardOptions)?void 0:n.getCopyCellValue)?void 0:l.html)&&(t=this.table.getCopyValue(null==(s=o.options.keyboardOptions)?void 0:s.getCopyCellValue.html));let e=(0,io.r5)(t);yield navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([e],{type:"text/html"}),"text/plain":new Blob([d],{type:"text/plain"})})])}else yield navigator.clipboard.writeText(d)}catch(e){this.fallbackCopyToClipboard(d,t)}else this.fallbackCopyToClipboard(d,t)}else this.fallbackCopyToClipboard(d,t);o.fireListeners(I.B.COPY_DATA,{cellRange:o.stateManager.select.ranges,copyData:d,isCut:e})}catch(e){this.fallbackCopyToClipboard(d,t)}}(null==(a=o.keyboardOptions)?void 0:a.showCopyCellBorder)&&((0,k.NR)(o),o.clearSelected())})}fallbackCopyToClipboard(t,e){try{if(e.clipboardData)return void e.clipboardData.setData("text/plain",t);document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur();let i=document.createElement("textarea");i.value=t,i.style.position="fixed",i.style.left="-999999px",i.style.top="-999999px",i.style.opacity="0",i.setAttribute("readonly",""),i.setAttribute("aria-hidden","true"),document.body.appendChild(i),i.focus(),i.select(),i.setSelectionRange(0,t.length);try{document.execCommand("copy")}catch(t){}finally{document.body.removeChild(i)}}catch(t){}}handleCut(t){return ru(this,void 0,void 0,function*(){this.handleCopy(t,!0),this.cutWaitPaste=!0,this.cutCellRange=this.table.getSelectedCellInfos(),this.clipboardCheckTimer&&clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=window.setTimeout(()=>{this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer=null)},3e4),this.saveClipboardContent()})}handlePaste(t){this.cutWaitPaste?this.checkClipboardChanged().then(e=>{this.executePaste(t),e||this.clearCutArea(this.table),this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer&&(clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=null))}).catch(()=>{this.executePaste(t),this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer&&(clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=null))}):this.executePaste(t)}executePaste(t){var e,i,r;return ru(this,void 0,void 0,function*(){let n=this.table;if(!(null==(e=n.editorManager)?void 0:e.editingEditor)){if(n.changeCellValues&&(null==(i=n.stateManager.select.ranges)?void 0:i.length)>0)try{if(navigator.clipboard&&navigator.clipboard.read)try{let e=yield navigator.clipboard.read(),i=!1;for(let t of e){if(t.types.includes("text/html")){yield this.pasteHtmlToTable(t),i=!0;break}if(t.types.includes("text/plain")){yield this.pasteTextToTable(t),i=!0;break}}i||(yield this.fallbackPasteFromClipboard(t))}catch(e){yield this.fallbackPasteFromClipboard(t)}else yield this.fallbackPasteFromClipboard(t)}catch(e){yield this.fallbackPasteFromClipboard(t)}(null==(r=n.keyboardOptions)?void 0:r.showCopyCellBorder)&&(0,k.Z7)(n)}})}fallbackPasteFromClipboard(t){return ru(this,void 0,void 0,function*(){let e=this.table,i=e.stateManager.select.ranges,r=Math.min(i[0].start.col,i[0].end.col),n=Math.min(i[0].start.row,i[0].end.row);try{let i=e.getElement();i&&i!==document.activeElement&&(i.focus(),yield new Promise(t=>setTimeout(t,10)));let l=t.clipboardData||window.clipboardData||window.Clipboard;if(l){let t=l.getData("text")||l.getData("Text");if(t)return void(yield this.processPastedText(t,r,n))}}catch(t){}})}processPastedText(t,e,i){var r;return ru(this,void 0,void 0,function*(){let n,l=this.table,s=t.split("\n"),a=[];s.forEach(function(t){let e=t.split("	"),i=[];a.push(i),e.forEach(function(t,r){r===e.length-1&&(t=t.trim()),i.push(t)})}),(null==(r=l.options.keyboardOptions)?void 0:r.processFormulaBeforePaste)&&this.copySourceRange&&(n=l.options.keyboardOptions.processFormulaBeforePaste(a,this.copySourceRange.startCol,this.copySourceRange.startRow,e,i));let o=yield l.changeCellValues(e,i,n||a,!0);l.hasListeners(I.B.PASTED_DATA)&&l.fireListeners(I.B.PASTED_DATA,{col:e,row:i,pasteData:n||a,changedCellResults:o})})}clearCutArea(t){try{let e=this.cutCellRange;if(!e||0===e.length)return;for(let i=0;i<e.length;i++)for(let r=0;r<e[i].length;r++)e[i][r]&&t.changeCellValue(e[i][r].col,e[i][r].row,void 0)}catch(t){}}checkClipboardChanged(){return ru(this,void 0,void 0,function*(){if(!navigator.clipboard||!navigator.clipboard.readText)return!1;try{return(yield navigator.clipboard.readText())!==this.lastClipboardContent}catch(t){return!1}})}saveClipboardContent(){navigator.clipboard&&navigator.clipboard.readText&&setTimeout(()=>{navigator.clipboard.readText().then(t=>{this.lastClipboardContent=t}).catch(t=>{})},50)}pasteHtmlToTable(t){let e=/<tr[^>]*>([\s\S]*?)<\/tr>/g,i=/<td[^>]*>([\s\S]*?)<\/td>/g,r=this.table,n=r.stateManager.select.ranges,l=n.length,s=Math.min(n[l-1].start.col,n[l-1].end.col),a=Math.min(n[l-1].start.row,n[l-1].end.row),o=Math.max(n[l-1].start.col,n[l-1].end.col),h=Math.max(n[l-1].start.row,n[l-1].end.row),d=0,u=0,c=[];t.getType("text/html").then(t=>{t.text().then(t=>ru(this,void 0,void 0,function*(){var n,l,p;if(t&&/(<table)|(<TABLE)/g.test(t)){let g;for(let r of Array.from(t.matchAll(e))){let t=Array.from(r[1].matchAll(i)).map(t=>t[1].replace(/(<(?!br)([^>]+)>)/gi,"").replace(/<br(\s*|\/)>[\r\n]?/gim,"\n").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#9;/gi,"	").replace(/&nbsp;/g," "));c.push(t),d=Math.max(d,null!=(n=null==t?void 0:t.length)?n:0)}u=null!=(l=c.length)?l:0,c=this.handlePasteValues(c,u,d,h-a+1,o-s+1),(null==(p=r.options.keyboardOptions)?void 0:p.processFormulaBeforePaste)&&this.copySourceRange&&(g=r.options.keyboardOptions.processFormulaBeforePaste(c,this.copySourceRange.startCol,this.copySourceRange.startRow,s,a));let f=yield r.changeCellValues(s,a,g||c,!0);r.hasListeners(I.B.PASTED_DATA)&&r.fireListeners(I.B.PASTED_DATA,{col:s,row:a,pasteData:g||c,changedCellResults:f})}else navigator.clipboard.read().then(t=>{for(let e of t)e.types.includes("text/plain")&&e.getType("text/plain").then(t=>{t.text().then(t=>this._pasteValue(t))})})}))})}_pasteValue(t){var e,i;return ru(this,void 0,void 0,function*(){let r,n=this.table,l=n.stateManager.select.ranges,s=l.length,a=Math.min(l[s-1].start.col,l[s-1].end.col),o=Math.min(l[s-1].start.row,l[s-1].end.row),h=Math.max(l[s-1].start.col,l[s-1].end.col),d=Math.max(l[s-1].start.row,l[s-1].end.row),u=0,c=0,p=[];t.split("\n").forEach(function(t,e){var i;let r=t.split("	"),n=[];p.push(n),r.forEach(function(t,e){e===r.length-1&&(t=t.trim()),n.push(t)}),u=Math.max(u,null!=(i=null==n?void 0:n.length)?i:0)}),c=null!=(e=p.length)?e:0,p=this.handlePasteValues(p,c,u,d-o+1,h-a+1),(null==(i=n.options.keyboardOptions)?void 0:i.processFormulaBeforePaste)&&this.copySourceRange&&(r=n.options.keyboardOptions.processFormulaBeforePaste(p,this.copySourceRange.startCol,this.copySourceRange.startRow,a,o));let g=yield n.changeCellValues(a,o,r||p,!0);n.hasListeners(I.B.PASTED_DATA)&&n.fireListeners(I.B.PASTED_DATA,{col:a,row:o,pasteData:r||p,changedCellResults:g})})}pasteTextToTable(t){return ru(this,void 0,void 0,function*(){let e=this.table,i=e.stateManager.select.ranges,r=i.length,n=Math.min(i[r-1].start.col,i[r-1].end.col),l=Math.min(i[r-1].start.row,i[r-1].end.row),s=Math.max(i[r-1].start.col,i[r-1].end.col),a=Math.max(i[r-1].start.row,i[r-1].end.row);try{let i=yield t.getType("text/plain"),r=yield i.text(),o=this.parsePastedData(r),h=o.length,d=Math.max(...o.map(t=>t.length),0),u=this.handlePasteValues(o,h,d,a-l+1,s-n+1),c=yield e.changeCellValues(n,l,u,!0);e.hasListeners(I.B.PASTED_DATA)&&e.fireListeners(I.B.PASTED_DATA,{col:n,row:l,pasteData:u,changedCellResults:c})}catch(t){}})}parsePastedData(t){let e=t.replace(/\r(?!\n)/g,"\r\n").split("\r\n"),i=[];return e.length>1&&""===e[e.length-1]&&e.pop(),e.forEach(t=>{let e=t.split("	").map(t=>this.processCellValue(t));i.push(e)}),i}processCellValue(t){t.includes("\n")&&(t=t.replace(/^"(.*)"$/,"$1").replace(/["]*/g,t=>Array(Math.floor(t.length/2)).fill('"').join("")));let e=Number(t);return isNaN(e)?t:e}handlePasteValues(t,e,i,r,n){if((n>i||r>e)&&n%i==0&&r%e==0){let l=[];for(let s=0;s<r;s++){let r=[];l.push(r);for(let l=0;l<n;l++){let n=s%e,a=l%i;r.push(t[n][a])}}return l}return t}}class rp extends _{static get DEFAULT(){return o||(o=new rp)}constructor(t={},e={}){var i,r;super(t,e),this._autoWrapText=null!=(i=null==t?void 0:t.autoWrapText)?i:null==e?void 0:e.autoWrapText,this._lineClamp=null!=(r=null==t?void 0:t.lineClamp)?r:null==e?void 0:e.lineClamp}clone(){return new rp(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}let rg=t=>{let e=t.value;return Number(e)>80?"#20a8d8":Number(e)>50?"#4dbd74":Number(e)>20?"#ffc107":"#f86c6b"};class rf extends _{static get DEFAULT(){return h||(h=new rf)}constructor(t={},e={}){var i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y;super(t,e),this._showBar=null==(i=t.showBar)||i,this._barColor=null!=(r=t.barColor)?r:rg,this._barPositiveColor=null!=(n=t.barPositiveColor)?n:"#4dbd74",this._barNegativeColor=null!=(l=t.barNegativeColor)?l:"#f86c6b",this._barAxisColor=null!=(s=t.barAxisColor)?s:"black",this._barBgColor=t.barBgColor,this._barHeight=null!=(a=t.barHeight)?a:3,this._barHeight=null!=(o=t.barHeight)?o:3,this._barBottom=null!=(h=t.barBottom)?h:0,this._barPadding=null!=(d=t.barPadding)?d:[0,0,0,0],this._showBarMark=null!=(u=t.showBarMark)&&u,this._barMarkPositiveColor=null!=(c=t.barMarkPositiveColor)?c:"#4dbd74",this._barMarkNegativeColor=null!=(p=t.barMarkNegativeColor)?p:"#f86c6b",this._barMarkWidth=null!=(g=t.barMarkWidth)?g:2,this._barMarkPosition=null!=(f=t.barMarkPosition)?f:"right",this._barRightToLeft=null!=(m=t.barRightToLeft)&&m,this._barMarkInBar=null==(y=t.barMarkInBar)||y}get showBar(){return this._showBar}set showBar(t){this._showBar=t}get barColor(){return this._barColor}set barColor(t){this._barColor=t}get barBgColor(){return this._barBgColor}set barBgColor(t){this._barBgColor=t}get barHeight(){return this._barHeight}set barHeight(t){this._barHeight=t}get barBottom(){return this._barBottom}set barBottom(t){this._barBottom=t}get barPositiveColor(){return this._barPositiveColor}set barPositiveColor(t){this._barPositiveColor=t}get barNegativeColor(){return this._barNegativeColor}set barNegativeColor(t){this._barNegativeColor=t}get barAxisColor(){return this._barAxisColor}set barAxisColor(t){this._barAxisColor=t}get barPadding(){return this._barPadding}set barPadding(t){this._barPadding=t}get showBarMark(){return this._showBarMark}set showBarMark(t){this._showBarMark=t}get barMarkPositiveColor(){return this._barMarkPositiveColor}set barMarkPositiveColor(t){this._barMarkPositiveColor=t}get barMarkNegativeColor(){return this._barMarkNegativeColor}set barMarkNegativeColor(t){this._barMarkNegativeColor=t}get barMarkWidth(){return this._barMarkWidth}set barMarkWidth(t){this._barMarkWidth=t}get barMarkPosition(){return this._barMarkPosition}set barMarkPosition(t){this._barMarkPosition=t}get barRightToLeft(){return this._barRightToLeft}set barRightToLeft(t){this._barRightToLeft=t}get barMarkInBar(){return this._barMarkInBar}set barMarkInBar(t){this._barMarkInBar=t}clone(){return new rf(this,null)}}class rm extends _{static get DEFAULT(){return d||(d=new rm)}constructor(t={},e={}){super(t,e)}clone(){return new rm(this,null)}}let ry=["type","content","style","color","width","height","marginRight","marginLeft","src","svg","name","path","positionType","tooltip","hover","cursor","shape","interactive","isGif"];class rv{constructor(t){this._table=t;let e=tb.U2();this.expandIcon=e[N.up.expandIconName],this.collapseIcon=e[N.up.collapseIconName]}getIcons(t,e,i,r,n){let l=[],s=this.getHierarchyIcon(t,e);s&&l.push(s);let{icon:a}=this._table.getBodyColumnDefine(t,e);if(a){let n;n="function"==typeof a?a({col:t,row:e,value:i,dataValue:r,table:this._table}):a;let s=tb.U2(),o=t=>{let e;(e="string"==typeof t?s[t]:t)&&l.push(e)};Array.isArray(n)?n.forEach((t,e)=>{o(t)}):o(n)}return n&&l.forEach((i,r)=>{(i.content||i.src)&&(l[r]=this.getCellIconFromRecordValue(i,t,e))}),l}getStyleClass(t){switch(t){case"text":case"link":break;case"image":case"video":return rm;case"chart":case"sparkline":return _;case"progressbar":return rf;case"checkbox":return C;case"radio":return x;case"switch":return w;case"button":return S}return rp}getCellIconFromRecordValue(t,e,i){if(Array.isArray(t))return t.map(t=>this.getCellIconFromRecordValue(t,e,i));if(!B.j6.isObject(t)||"function"==typeof t)return this._table.getFieldData(t,e,i);let r={};return ry.forEach(n=>{var l,s;if(void 0!==t[n]){let a=this._table.getFieldData(t[n],e,i);(0,y.Z)(a)?r[n]=a:(null==(s=(l=this._table)._hasField)?void 0:s.call(l,t[n],e,i))||(r[n]=t[n])}}),r}getHierarchyIcon(t,e){let i=this._table.getHierarchyState(t,e);return i===R.g.expand?this.expandIcon:i===R.g.collapse?this.collapseIcon:void 0}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+(null!=(t=this.expandIcon.marginLeft)?t:0)+(null!=(e=this.expandIcon.marginRight)?e:0)}}var rb=i(5923);let r_={CHANGE_STYLE:"change_style"};class rC extends v.R{static get EVENT_TYPE(){return r_}static get DEFAULT(){return u||(u=new rC)}constructor(t={},e={}){var i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I,E;super(),this._defaultPadding=[10,16,10,16],this._color=null!=(i=t.color)?i:null==e?void 0:e.color,this._strokeColor=null!=(r=null==t?void 0:t.strokeColor)?r:null==e?void 0:e.strokeColor,this._fontSize=null!=(n=t.fontSize)?n:null==e?void 0:e.fontSize,this._fontFamily=null!=(l=t.fontFamily)?l:null==e?void 0:e.fontFamily,this._fontWeight=null!=(s=t.fontWeight)?s:null==e?void 0:e.fontWeight,this._fontVariant=null!=(a=t.fontVariant)?a:null==e?void 0:e.fontVariant,this._fontStyle=null!=(o=t.fontStyle)?o:null==e?void 0:e.fontStyle,this._textOverflow=(null!=(h=t.textOverflow)?h:null==e?void 0:e.textOverflow)||"ellipsis",this._textStick=null!=(u=null!=(d=t.textStick)?d:null==e?void 0:e.textStick)&&u,this._textStickBaseOnAlign=null!=(p=null!=(c=t.textStickBaseOnAlign)?c:null==e?void 0:e.textStickBaseOnAlign)&&p,this._marked=null!=(f=null!=(g=t.marked)?g:null==e?void 0:e.marked)&&f,this._textAlign=(null!=(m=t.textAlign)?m:null==e?void 0:e.textAlign)||"left",this._textBaseline=(null!=(y=t.textBaseline)?y:null==e?void 0:e.textBaseline)||"middle",this._bgColor=null!=(v=t.bgColor)?v:null==e?void 0:e.bgColor,this._padding=null!=(_=null!=(b=t.padding)?b:null==e?void 0:e.padding)?_:this._defaultPadding,this._borderColor=null!=(C=t.borderColor)?C:null==e?void 0:e.borderColor,this._lineHeight=null!=(x=t.lineHeight)?x:null==e?void 0:e.lineHeight,this._underline=null!=(w=t.underline)?w:null==e?void 0:e.underline,this._underlineColor=null!=(S=t.underlineColor)?S:null==e?void 0:e.underlineColor,this._underlineDash=null!=(A=t.underlineDash)?A:null==e?void 0:e.underlineDash,this._underlineOffset=null!=(M=t.underlineOffset)?M:null==e?void 0:e.underlineOffset,this._lineThrough=null!=(T=t.lineThrough)?T:null==e?void 0:e.lineThrough,this._lineThroughColor=null!=(k=t.lineThroughColor)?k:null==e?void 0:e.lineThroughColor,this._lineThroughDash=null!=(R=t.lineThroughDash)?R:null==e?void 0:e.lineThroughDash,this._linkColor=null!=(P=t.linkColor)?P:null==e?void 0:e.linkColor,this._cursor=null!=(B=t.cursor)?B:null==e?void 0:e.cursor,this._borderLineWidth=null!=(I=t.borderLineWidth)?I:null==e?void 0:e.borderLineWidth,this._borderLineDash=null!=(E=t.borderLineDash)?E:null==e?void 0:e.borderLineDash}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get padding(){var t;return null!=(t=this._padding)?t:this._defaultPadding}set padding(t){this._padding=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get marked(){return this._marked}set marked(t){this._marked=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}clone(){return new rC(this)}}class rx extends rC{static get DEFAULT(){return c||(c=new rx)}constructor(t={},e={}){var i;super(t,e),this.textAlign=(null!=(i=t.textAlign)?i:null==e?void 0:e.textAlign)||"center"}clone(){return new rx(this)}}class rw extends rC{static get DEFAULT(){return p||(p=new rw)}constructor(t={},e=null){var i,r;super(t,e),this._autoWrapText=null!=(i=null==t?void 0:t.autoWrapText)?i:null==e?void 0:e.autoWrapText,this._lineClamp=null!=(r=null==t?void 0:t.lineClamp)?r:null==e?void 0:e.lineClamp}clone(){return new rw(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}class rS extends rC{static get DEFAULT(){return g||(g=new rS)}constructor(t={},e={},i={}){var r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S;super(t,e),this._size=(null!=(n=null!=(r=null==t?void 0:t.size)?r:null==e?void 0:e.size)?n:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(s=null!=(l=null==t?void 0:t.spaceBetweenTextAndIcon)?l:null==e?void 0:e.spaceBetweenTextAndIcon)?s:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(o=null==(a=null==t?void 0:t.checkboxStyle)?void 0:a.defaultFill)?o:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(d=null==(h=null==t?void 0:t.checkboxStyle)?void 0:h.defaultStroke)?d:null==i?void 0:i.defaultStroke,this._disableFill=null!=(c=null==(u=null==t?void 0:t.checkboxStyle)?void 0:u.disableFill)?c:null==i?void 0:i.disableFill,this._checkedFill=null!=(g=null==(p=null==t?void 0:t.checkboxStyle)?void 0:p.checkedFill)?g:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(m=null==(f=null==t?void 0:t.checkboxStyle)?void 0:f.checkedStroke)?m:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(v=null==(y=null==t?void 0:t.checkboxStyle)?void 0:y.disableCheckedFill)?v:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(_=null==(b=null==t?void 0:t.checkboxStyle)?void 0:b.disableCheckedStroke)?_:null==i?void 0:i.disableCheckedStroke,this._checkIconImage=null!=(x=null==(C=null==t?void 0:t.checkboxStyle)?void 0:C.checkIconImage)?x:null==i?void 0:i.checkIconImage,this._indeterminateIconImage=null!=(S=null==(w=null==t?void 0:t.checkboxStyle)?void 0:w.indeterminateIconImage)?S:null==i?void 0:i.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new rS(t,this)}clone(){return new rS(this)}}class rA{constructor(t){this._table=t;let e=tb.U2();this.freezeIcon=e[N.up.freezeIconName],this.frozenIcon=e[N.up.frozenIconName],this.frozenCurrentIcon=e[N.up.frozenCurrentIconName],this.normalIcon=e[N.up.normalIconName],this.upIcon=e[N.up.upwardIconName],this.downIcon=e[N.up.downwardIconName],this.dropDownAbsoluteIcon=e[N.up.dropdownIconName],this.expandIcon=e[N.up.expandIconName],this.collapseIcon=e[N.up.collapseIconName]}getIcons(t,e){let i=[];if(this._table.isPivotTable()){let{showSort:r,sort:n}=this._table.internalProps.layoutMap.getHeader(t,e);if("function"==typeof r?r({col:t,row:e,table:this._table}):r){let r=this._table.getPivotSortState(t,e);r&&(r=r.toUpperCase());let n="ASC"===r?this.upIcon:"DESC"===r?this.downIcon:this.normalIcon;n&&i.push(n)}else if(n){let r=this.getSortIconForPivotTable(this._table.getPivotSortState(t,e),this._table,t,e);r&&i.push(r)}}else{let r,n=this._table.sortState;r=void 0;let l=this._table.getCellRange(t,e);if(n)if(Array.isArray(n))for(let t=0;t<n.length;t++){let e=n[t],i=this._table._getHeaderCellBySortState(e);if(i&&(0,B._Z)(l,i.col,i.row)){({order:r}=e);break}}else{let t=this._table._getHeaderCellBySortState(n);t&&(0,B._Z)(l,t.col,t.row)&&({order:r}=n)}let s=this.getSortIcon(r,this._table,t,e);s&&i.push(s)}if(this._table.showFrozenIcon&&t<this._table.allowFrozenColCount){let r=this.getFrozenIcon(t,e);r&&i.push(r)}if(this.checkDropDownIcon(this._table,t,e)){let t=this.dropDownAbsoluteIcon;i.push(t)}let r=this.getDropDownStateIcons(this._table,t,e);r.length&&i.push(...r);let{headerIcon:n}=this._table._getHeaderLayoutMap(t,e),l=this.getHierarchyIcon(t,e);if(l&&i.push(l),n){let r;r="function"==typeof n?n({col:t,row:e,value:this._table.getCellValue(t,e),dataValue:this._table.getCellOriginValue(t,e),table:this._table}):n;let l=tb.U2(),s=t=>{let e;(e="string"==typeof t?l[t]:t)&&i.push(e)};Array.isArray(r)?r.forEach((t,e)=>{s(t)}):s(r)}return i}getFrozenIcon(t,e){if(this._table.isPivotTable()||this._table.transpose||this._table.rightFrozenColCount&&t>=this._table.colCount-this._table.rightFrozenColCount)return null;let i=this._table.getHeaderDefine(t,e);if(i.columns&&i.columns.length>0)return null;let r=this.freezeIcon;return this._table.options.frozenColCount-1>t?r=this.frozenIcon:this._table.options.frozenColCount-1===t&&(r=this.frozenCurrentIcon),r}getSortIcon(t,e,i,r){let n,l="asc"===t?this.upIcon:"desc"===t?this.downIcon:this.normalIcon,s=e.getHeaderDefine(i,r);return s&&(n="function"==typeof s.showSort?s.showSort({col:i,row:r,table:this._table}):s.showSort),s&&!1!==n&&((0,y.Z)(n)||s.sort)&&(!s.columns||!(s.columns.length>0))?l:null}getSortIconForPivotTable(t,e,i,r){let n,l=e.getHeaderDefine(i,r);return(l&&(n="function"==typeof l.showSort?l.showSort({col:i,row:r,table:this._table}):l.showSort),l&&!1!==n&&((0,y.Z)(n)||l.sort)&&(!l.columns||!(l.columns.length>0)))?"ASC"===(null==t?void 0:t.toUpperCase())?this.upIcon:"DESC"===(null==t?void 0:t.toUpperCase())?this.downIcon:this.normalIcon:null}getDropDownStateIcons(t,e,i){var r,n,l;let s=t.getHeaderDefine(e,i),{dropDownMenu:a}=t._getHeaderLayoutMap(e,i);"function"==typeof a&&(a=a({row:i,col:e,table:t}));let o=t.globalDropDownMenu;"function"==typeof o&&(o=o({row:i,col:e,table:t}));let h=[];if(Array.isArray(a)&&a.length||Array.isArray(o)&&o.length&&!(null==(r=null==s?void 0:s.columns)?void 0:r.length)){let r=a||o,s=-1,d=-1;for(let a=0;a<r.length;a++){let o=r[a];if("object"==typeof o&&o.children&&o.children.length)for(let r=0;r<o.children.length;r++){let h=o.children[r];if((null==(n=t.stateManager.menu)?void 0:n.dropDownMenuHighlight)&&(0,rb.o)(t,null==(l=t.stateManager.menu)?void 0:l.dropDownMenuHighlight,"object"==typeof h?null==h?void 0:h.menuKey:h,e,i,a)){s=a,d=r;break}}if(t._dropDownMenuIsHighlight(e,i,a)){s=a;break}}if(-1!==s){let t;(t=-1!==d?r[s].children[d]:r[s]).stateIcon&&(t.stateIcon.svg?h.push({type:"svg",name:t.stateIcon.src||t.stateIcon.svg,width:t.stateIcon.width||22,height:t.stateIcon.height||22,svg:t.stateIcon.svg,positionType:N.q0.right,marginRight:0,funcType:N.cI.dropDownState,interactive:!1}):t.stateIcon.src&&h.push({type:"image",name:t.stateIcon.src||t.stateIcon.svg,width:t.stateIcon.width||22,height:t.stateIcon.height||22,src:t.stateIcon.src,positionType:N.q0.right,marginRight:0,funcType:N.cI.dropDownState,interactive:!1}))}}return h}getDropDownIconRect(t,e,i){var r,n,l,s,a,o,h,d;let u,c=null!=(s=null!=(n=null==(r=this.downIcon.hover)?void 0:r.width)?n:null==(l=this.downIcon)?void 0:l.width)?s:0,p=null!=(d=null!=(o=null==(a=this.downIcon.hover)?void 0:a.height)?o:null==(h=this.downIcon)?void 0:h.height)?d:0,g=t.right-2-c;return{left:g,right:t.right-2,top:u="middle"===i?t.top+t.height/2-c/2:"top"===i?t.top+e/2:"bottom"===i?t.bottom-2*e:t.top,bottom:p+u,width:c,height:p}}getHierarchyIcon(t,e){let{hierarchyState:i}=this._table._getHeaderLayoutMap(t,e);if(i){if(i===R.g.expand)return this.expandIcon;if(i===R.g.collapse)return this.collapseIcon}}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+(null!=(t=this.expandIcon.marginLeft)?t:0)+(null!=(e=this.expandIcon.marginRight)?e:0)}checkDropDownIcon(t,e,i){var r;if(t.isPivotTable()){let r=t._getHeaderLayoutMap(e,i).dropDownMenu;if("function"==typeof r&&(r=r({row:i,col:e,table:t})),Array.isArray(r)&&r.length)return!0}else{let n=t.getHeaderDefine(e,i),l=n.dropDownMenu,s=t.globalDropDownMenu;if("function"==typeof s&&(s=s({row:i,col:e,table:t})),Array.isArray(l)&&l.length||(!Array.isArray(n.dropDownMenu)||0!==n.dropDownMenu.length)&&Array.isArray(s)&&s.length&&!(null==(r=null==n?void 0:n.columns)?void 0:r.length))return!0}return!1}getStyleClass(t){switch(t){case"text":case"link":return rw;case"image":case"video":return rx;case"checkbox":return rS}}setTableColumnsEditor(){let t=(e,i)=>{null==e||e.forEach((e,r)=>{e.editor&&(i[r].editor=e.editor),e.columns&&t(e.columns,i[r].columns)})};t(this._table.options.columns,this._table.internalProps.columns)}}var rM=i(63778),rT=i(65755);class rk extends EventTarget{constructor(t,e){if(super(),this._table=t,"node"===T.X.mode)return;let i=document.createElement("div");i.style.opacity="0",i.dataset.vtable="vtable",i.style.pointerEvents="none",i.classList.add("input-container");let r=this._input=document.createElement("input");i.appendChild(r),r.classList.add("table-focus-control"),r.dataset.vtable="vtable",r.readOnly=!0,e.appendChild(i),this._container=i}focus(){this._input.focus({preventScroll:!0})}setFocusRect(t,e){let i=this._input;i.value=e,i.select();let r=t.top-this._table.scrollTop,n=t.left-this._table.scrollLeft;i.style.top=`${r.toFixed()}px`,i.style.left=`${n.toFixed()}px`,i.style.width=`${t.width.toFixed()}px`,i.style.height=`${t.height.toFixed()}px`}get input(){return this._input}release(){var t;null==(t=this._container.parentElement)||t.removeChild(this._container)}}class rR{constructor(t){this.isUpdate=!1,this._keys=[],this._sorted=!1,this.data=new Map,this._keys.length=0,this.cumulativeSum=new Map,this.difference=new Map,this.totalSum=0,this.table=t}get length(){return this.data.size}clear(){this._keys=[],this.data.clear(),this.cumulativeSum.clear(),this.difference.clear(),this.totalSum=0}clearRange(){this.cumulativeSum.clear(),this.difference.clear()}_add(t,e){if(!(0,y.Z)(e))return;let i=this.table.getRowHeight(t);this.data.has(t)||(this._keys.push(t),this._sorted=!1),this.data.set(t,e),this.totalSum+=e,this.updateDifference(t,e-i)}_remove(t){if(this.data.has(t)){let e=this.data.get(t);this.data.delete(t);let i=this._keys.indexOf(t);-1!==i&&this._keys.splice(i,1),this.totalSum-=e;let r=this.table.getRowHeight(t);this.updateDifference(t,r-e)}}put(t,e){if((0,y.Z)(e))if(this.data.has(t)){let i=this.data.get(t);if(i===e)return;this.data.set(t,e);let r=e-i;this.totalSum+=r,this.updateDifference(t,r)}else this._add(t,e)}get(t){return this.data.get(t)}has(t){return this.data.has(t)}_sort(){let{_keys:t}=this;this._sorted||(t.sort((t,e)=>t<e?-1:+(t>e)),this._sorted=!0)}updateDifference(t,e){var i;let r=null!=(i=this.difference.get(t))?i:0;this.difference.set(t,r+e),this.update()}getSumInRange(t,e){return this.calculatePrefixSum(e)-this.calculatePrefixSum(t-1)}updateCumulativeSum(t,e){for(let[i,r]of this.cumulativeSum)i>=t&&this.cumulativeSum.set(i,r+e)}calculatePrefixSum(t){if(t<0)return 0;if(this.cumulativeSum.has(t)){let e=this.cumulativeSum.get(t);for(let[i,r]of this.difference)i<=t&&(e+=r);return e}return this.dealDiffenence(),this.getCumulativeSum(t)}getCumulativeSum(t){var e,i;let r=0,n=0,l=!1,s=this.table.rowCount>0&&this.table.bottomFrozenRowCount>0?this.table.rowCount-this.table.bottomFrozenRowCount:-1;for(let i=t;i>=0;i--){if(this.cumulativeSum.has(i)){r+=this.cumulativeSum.get(i);break}r+=null!=(e=this.data.get(i))?e:this.table.getRowHeight(i),i>=s&&-1!==s&&(n=r,l=i===s)}if(l&&(null==(i=this.table.containerFit)?void 0:i.height)&&this.table.bottomFrozenRowCount){let t=this.table.tableNoFrameHeight||0;r<t&&(r=t-this.table.getBottomFrozenRowsHeight()+n)}return this.cumulativeSum.set(t,r),r}update(){this.isUpdate||(this.isUpdate=!0,setTimeout(()=>{this.dealDiffenence(),this.isUpdate=!1},0))}dealDiffenence(){for(let[t]of this.cumulativeSum)for(let[e,i]of this.difference)if(t>=e){let e=this.cumulativeSum.get(t);this.cumulativeSum.set(t,e+i)}this.difference.clear()}insert(t,e){for(let e=t;e<=this.getLastIndex();e++)this.cumulativeSum.delete(e);let i=this.getLastIndex()+1,r=[];for(let e=t;e<=i;e++)this.has(e)&&(r.push({position:e,value:this.get(e)}),this._remove(e));for(let{position:i,value:n}of((0,y.Z)(e)&&this.put(t,e),r))this.put(i+1,n)}getLastIndex(){return this._sort(),this._keys[this._keys.length-1]}delLast(){let t=this.getLastIndex();this._remove(t)}delete(t){for(let e=t;e<=this.getLastIndex();e++)this.cumulativeSum.delete(e);let e=this.getLastIndex();this.has(t)&&this._remove(t);let i=[];for(let r=t+1;r<=e;r++)this.has(r)&&i.push({position:r,value:this.get(r)});for(let{position:t,value:e}of i)this._remove(t),this._add(t-1,e)}adjustOrder(t,e,i){this.clearRange(),this._sort();let{_keys:r}=this;if(t>e){let n=[];for(let l=rP(r,t+i-1);l>=0;l--){let s=r[l];if(s>=t)n.push(this.get(s));else if(e<=s&&s<t)this.put(s+i,this.get(s));else if(s<e)break}for(let t=0;t<i;t++)this.put(e+t,n[i-1-t])}let{length:n}=r;if(t<e){let l=[];for(let s=rP(r,t);s<n;s++){let n=r[s];if(n>=t&&n<t+i)l.push(this.get(n));else if(t+i<=n&&n<=e)this.put(n-i,this.get(n));else if(n>e)break}for(let t=0;t<i;t++)this.put(e+t,l[t])}}exchangeOrder(t,e,i,r,n){let l=[];for(let i=t+e-1;i>=t;i--)l.push({position:i,value:this.get(i)}),this.delete(i);for(let t=0;t<e;t++)this.insert(n,l[t].value)}}function rP(t,e){let i=0,r=t.length-1;for(;i<=r;){let n=Math.floor((i+r)/2);if(t[n]===e)return n;t[n]>e?r=n-1:i=n+1}let n=r<0?0:r;return t[n]===e?n:-1}class rB{constructor(t){this._table=t;let e=tb.U2();this.dragReorderIconName=e[N.up.dragReorderIconName]}getIcons(t,e){return[this.dragReorderIconName]}}var rI=i(30497),rE=i(26595);function rL(t,e){var i;return(0,V.ke)(e,t)||(null!=(i=rH(t,e))?i:{top:-1,row:-1,bottom:-1,height:-1})}function rF(t,e){var i;return(0,V.sQ)(e,t)||(null!=(i=rO(t,e))?i:{left:-1,col:-1,right:-1,width:1})}function rO(t,e){if(0===t)return{left:0,col:0,right:0,width:0};let i=function(t,e){if(e._colRangeWidthsMap.get("$0$"+(e.colCount-1))){let i=0,r=e.colCount-1;for(;r-i>1;){let n=Math.floor((i+r)/2);if(t<e._colRangeWidthsMap.get(`$0$${n}`))r=n;else{if(!(t>e._colRangeWidthsMap.get(`$0$${n}`)))return n;i=n}}return r}return Math.min(Math.ceil(t/e.internalProps.defaultColWidth),e.colCount-1)}(t,e),r=e.getColsWidth(0,i);return t>=r?((i,r)=>{let n=r-e.getColWidth(i),{colCount:l}=e.internalProps;for(let r=i;r<l;r++){let i=e.getColWidth(r),l=n+i;if(Math.round(n)<=t&&t<Math.round(l))return{left:n,col:r,right:l,width:i};n=l}return null})(i,r):((i,r)=>{let n=r;for(let r=i;r>=0;r--){let i=e.getColWidth(r),l=n-i;if(Math.round(l)<=t&&t<Math.round(n))return{left:l,col:r,right:n,width:i};n=l}return null})(i,r)}function rH(t,e){var i,r,n;let l;if(0===t)return{top:0,row:0,bottom:0,height:0};let s=!0===(null==(i=e.options.customConfig)?void 0:i._disableColumnAndRowSizeRound)?Math.floor:Math.round,a=(r=t,l=(n=e).defaultRowHeight,n._rowRangeHeightsMap.get("$0$"+(n.rowCount-1))&&(l=n._rowRangeHeightsMap.get("$0$"+(n.rowCount-1))/n.rowCount),Math.min(Math.ceil(r/l),n.rowCount-1)),o=e.getRowsHeight(0,a);return t>=o?((i,r)=>{let n=r-e.getRowHeight(i),{rowCount:l}=e.internalProps;for(let r=i;r<l;r++){let i=e.getRowHeight(r),l=n+i;if(s(n)<=s(t)&&s(t)<s(l))return{top:n,row:r,bottom:l,height:i};n=l}return null})(a,o):((i,r)=>{let n=r;for(let r=i;r>=0;r--){let i=e.getRowHeight(r),l=n-i;if(s(l)<=s(t)&&s(t)<s(n))return{top:l,row:r,bottom:n,height:i};n=l}return null})(a,o)}function rD(t,e,i){if(0===t)return{left:0,col:0,right:0,width:0};if(t-=i.tableX,e&&t>i.tableNoFrameWidth-i.getRightFrozenColsWidth()&&t<i.tableNoFrameWidth&&t<=i.getAllColsWidth()){for(let e=0;e<i.rightFrozenColCount;e++)if(t>i.tableNoFrameWidth-i.getColsWidth(i.colCount-e-1,i.colCount-1))return{col:i.colCount-e-1,left:void 0,right:void 0,width:void 0}}return rO(t,i)}function rz(t,e,i){if(0===t)return{top:0,row:0,bottom:0,height:0};if(t-=i.tableY,e&&t>i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()&&t<i.tableNoFrameHeight){for(let e=0;e<i.rightFrozenColCount;e++)if(t>i.tableNoFrameHeight-i.getRowsHeight(i.rowCount-e-1,i.rowCount-1))return{row:i.rowCount-e-1,top:void 0,bottom:void 0,height:void 0}}return rH(t,i)}var rW=i(73508);function rZ(t,e,i,r,n,l){var s;return t||e?t instanceof rC?t:"function"==typeof t?rZ(t(i),e,i,r,n,l):(t||(t={}),n&&!(0,y.Z)(t.autoWrapText)&&(t.autoWrapText=!0),r===rS?new rS(null!=t?t:{},null!=e?e:{},null!=(s=l.checkboxStyle)?s:{}):new r(null!=t?t:{},null!=e?e:{})):r.DEFAULT}var rN=i(83808);let rj={};var rG=i(15982),rV=i(41551),rU=i(71204),rK=i(96534),rX=i(27753);function rY(t){return Math.floor(t)===t}class r$ extends rG.rd{onUpdate(t,e,i){if(this.from.x!==this.to.x){let i=t?this.to.x:this.from.x+Math.floor((this.to.x-this.from.x)*e);this.params.table.scrollLeft=i}if(this.from.y!==this.to.y){let i=t?this.to.y:this.from.y+Math.floor((this.to.y-this.from.y)*e);this.params.table.scrollTop=i}}}class rq{constructor(t){this.table=t,this.timeline=new rV.L,this.ticker=new rU.H(this.table.scenegraph.stage),this.ticker.addTimeline(this.timeline),this.ticker.setFPS(60),this.tempGraphic=(0,tc.f)({})}scrollTo(t,e){var i,r;let n={x:this.table.scrollLeft,y:this.table.scrollTop},{col:l,row:s}=t,a,o,h=l,d=s;(0,$.Z)(l)&&!rY(l)&&(h=Math.floor(l),a=l-h),(0,$.Z)(s)&&!rY(s)&&(d=Math.floor(s),o=s-d);let u=this.table.getCellRect(null!=h?h:0,null!=d?d:0),{left:c,top:p}=u;a&&(c+=a*u.width),o&&(p+=o*u.height);let g={x:(0,$.Z)(l)?c-this.table.getFrozenColsWidth():this.table.scrollLeft,y:(0,$.Z)(s)?p-this.table.getFrozenRowsHeight():this.table.scrollTop},f=(0,rM.Z)(e)?3e3*!!e:null!=(i=null==e?void 0:e.duration)?i:3e3,m=(0,rM.Z)(e)?e?"linear":"":null!=(r=null==e?void 0:e.easing)?r:"linear";new rK.r(rX.R.GenAutoIncrementId(),this.timeline).bind(this.tempGraphic).play(new r$(n,g,f,m,{graphic:this.tempGraphic,table:this.table})),this.ticker.start()}clear(){this.timeline.clear(),this.ticker.stop()}}var rJ=i(17590),rQ=i(43919);let{toBoxArray:r0}=B.oB,{isTouchEvent:r1}=B.B,r2=/^\$(\d+)\$(\d+)$/;!function(){if("node"===T.X.mode)return;let t=document.createElement("style");t.id="vtable-style-styleSheet",t.textContent="\n.vtable .input-container {\n	position: absolute;\n	top:0px;\n}\n.vtable .table-scrollable {\n	position: absolute;\n	overflow: scroll;\n}\n.vtable .table-scrollable::-webkit-scrollbar-button{\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-track-piece{\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-corner {\n	background-color: transparent;\n}\n.vtable .table-scrollable::-webkit-scrollbar-thumb {\n	border-radius      : 4px;\n	background-color   : rgba(100, 100, 100, .5);\n}\n\n.vtable .table-scroll-end-point {\n	opacity: 0;\n	position: relative;\n}\n.vtable {\n	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */\n	/* overflow: auto; */\n	position: relative;\n	width: 100%;\n	height: 100%;\n	text-align: left;\n  -webkit-font-smoothing:auto;\n\n  overflow: hidden; // for react-vtable dom custom element\n}\n\n.vtable-gantt {\n	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */\n	/* overflow: auto; */\n	position: absolute;\n	width: 100%;\n	height: 100%;\n	text-align: left;\n  -webkit-font-smoothing:auto;\n\n  overflow: hidden; // for react-vtable dom custom element\n}\n.vtable .table-component-container {\n  pointer-events: none;\n  overflow: hidden;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n}\n.vtable > canvas {\n	position: absolute;\n	width: 0;\n	height: 0;\n}\n.vtable .table-focus-control {\n	position: relative !important;\n	width: 1px;\n	height: 1px;\n	opacity: 0;\n	padding: 0;\n	margin: 0;\n	box-sizing: border-box;\n	pointer-events: none;\n	max-width: 500px;\n	max-height: 500px;\n	float: none !important;\n}\n.vtable input.table-focus-control::-ms-clear {\n	visibility: hidden;\n}\n.vtable input.table-focus-control.composition {\n	opacity: 1;\n	max-width: none;\n	max-height: none;\n}\n",document.head.appendChild(t)}();class r3 extends v.R{static get EVENT_TYPE(){return I.B}constructor(t,e={}){var i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,v,b,_,C,x,w,S,A,M;if(super(),this.showFrozenIcon=!0,this.version="1.22.11-alpha.8",this.id=`VTable${Date.now()}`,this.isReleased=!1,this._chartEventMap={},this.throttleInvalidate=(0,O.E5)(this.render.bind(this),200),"node"===T.X.mode?(e=t,t=null):t instanceof HTMLElement||(e=t,t=t.container?t.container:null),!t&&"node"!==e.mode&&!e.canvas)throw Error("vtable's container is undefined");this.pluginManager=new rQ.Q(this,e),this.fireListeners(I.B.BEFORE_INIT,{options:e,container:t}),t=e.container&&e.container instanceof HTMLElement?e.container:t,!1===(null==(i=e.customConfig)?void 0:i.imageAnonymous)&&(W.rF.isImageAnonymous=!1);let{frozenColCount:k=0,unfreezeAllOnExceedsMaxWidth:P,frozenRowCount:B,defaultRowHeight:F=40,defaultHeaderRowHeight:D,defaultColWidth:z=80,defaultHeaderColWidth:Z,widthMode:N="standard",heightMode:j="standard",autoFillWidth:U=!1,autoFillHeight:K=!1,containerFit:X={width:!1,height:!1},widthAdaptiveMode:Y="only-body",heightAdaptiveMode:q="only-body",keyboardOptions:J,eventOptions:Q,rowSeriesNumber:te,enableCheckboxCascade:ti,enableHeaderCheckboxCascade:tr,columnResizeMode:tn,rowResizeMode:tl="none",resize:ts,dragHeaderMode:ta,dragOrder:to,showFrozenIcon:th,allowFrozenColCount:td,padding:tu,hover:tc,menu:tp,select:tg,customRender:tf,pixelRatio:tm=ri,renderChartAsync:ty,renderChartAsyncBatchCount:tv,mode:t_,modeParams:tC,canvasWidth:tx,canvasHeight:tw,contentOffsetX:tS,contentOffsetY:tA,overscrollBehavior:tM,limitMinWidth:tT,limitMinHeight:tk,clearDOM:tR=!0}=e,{groupConfig:tP,groupBy:tB,groupTitleFieldFormat:tI,groupTitleCustomLayout:tE,enableTreeStickCell:tL}=e;this.container=t,this.options=e,this._widthMode=N,this._heightMode=j,this._widthAdaptiveMode=Y,this._heightAdaptiveMode=q,this._autoFillWidth=U,this._autoFillHeight=K,void 0!==X&&(this._containerFit="boolean"==typeof X?{width:X,height:X}:X&&"object"==typeof X?{width:null==(r=X.width)||r,height:null==(n=X.height)||n}:{width:!1,height:!1}),this.customRender=tf,this.padding={top:0,right:0,left:0,bottom:0},tu&&("number"==typeof tu?(this.padding.top=tu,this.padding.left=tu,this.padding.bottom=tu,this.padding.right=tu):(tu.top&&(this.padding.top=tu.top),tu.bottom&&(this.padding.bottom=tu.bottom),tu.left&&(this.padding.left=tu.left),tu.right&&(this.padding.right=tu.right))),((0,y.Z)(tw)||(0,y.Z)(tx))&&(this.canvasSizeSeted=!0),this.tableNoFrameWidth=0,this.tableNoFrameHeight=0,this.contentOffsetX=null!=tS?tS:0,this.contentOffsetY=null!=tA?tA:0,this.canvasWidth=(0,$.Z)(tx)?tx:void 0,this.canvasHeight=(0,$.Z)(tw)?tw:void 0,this.columnWidthComputeMode=null!=(l=e.columnWidthComputeMode)?l:"normal";let tF=this.internalProps={};void 0!==th&&(this.showFrozenIcon=th),"number"==typeof td&&td<=0&&(this.showFrozenIcon=!1),this.options.canvas?("node"!==T.X.mode&&(tF.element=this.options.canvas.parentElement,tF.element.style.position="relative"),tF.focusControl=new rk(this,tF.element),tF.canvas=this.options.canvas,tF.context=tF.canvas.getContext("2d")):"node"!==T.X.mode&&(tF.element=(0,V._I)(this.padding),tF.focusControl=new rk(this,tF.element),tF.canvas=document.createElement("canvas"),tF.element.appendChild(tF.canvas),tF.context=tF.canvas.getContext("2d"),(null==(s=e.customConfig)?void 0:s.createReactContainer)&&function(t){let{internalProps:e}=t;e.bodyDomContainer=document.createElement("div"),e.bodyDomContainer.id="vtable-body-dom-container",e.bodyDomContainer.classList.add("table-component-container"),e.element.appendChild(e.bodyDomContainer),e.headerDomContainer=document.createElement("div"),e.headerDomContainer.id="vtable-header-dom-container",e.headerDomContainer.classList.add("table-component-container"),e.element.appendChild(e.headerDomContainer),e.frozenBodyDomContainer=document.createElement("div"),e.frozenBodyDomContainer.id="vtable-frozen-body-dom-container",e.frozenBodyDomContainer.classList.add("table-component-container"),e.element.appendChild(e.frozenBodyDomContainer),e.frozenHeaderDomContainer=document.createElement("div"),e.frozenHeaderDomContainer.id="vtable-frozen-header-dom-container",e.frozenHeaderDomContainer.classList.add("table-component-container"),e.element.appendChild(e.frozenHeaderDomContainer),e.rightFrozenBodyDomContainer=document.createElement("div"),e.rightFrozenBodyDomContainer.id="vtable-right-frozen-body-dom-container",e.rightFrozenBodyDomContainer.classList.add("table-component-container"),e.element.appendChild(e.rightFrozenBodyDomContainer),e.rightFrozenHeaderDomContainer=document.createElement("div"),e.rightFrozenHeaderDomContainer.id="vtable-right-frozen-header-dom-container",e.rightFrozenHeaderDomContainer.classList.add("table-component-container"),e.element.appendChild(e.rightFrozenHeaderDomContainer),e.frozenBottomDomContainer=document.createElement("div"),e.frozenBottomDomContainer.id="vtable-frozen-bottom-dom-container",e.frozenBottomDomContainer.classList.add("table-component-container"),e.element.appendChild(e.frozenBottomDomContainer),e.bottomDomContainer=document.createElement("div"),e.bottomDomContainer.id="vtable-bottom-dom-container",e.bottomDomContainer.classList.add("table-component-container"),e.element.appendChild(e.bottomDomContainer),e.rightFrozenBottomDomContainer=document.createElement("div"),e.rightFrozenBottomDomContainer.id="vtable-right-frozen-bottom-dom-container",e.rightFrozenBottomDomContainer.classList.add("table-component-container"),e.element.appendChild(e.rightFrozenBottomDomContainer)}(this)),tF.handler=new E.b,(0,$.Z)(this.options.resizeTime)&&(tF.handler.resizeTime=this.options.resizeTime),tF.pixelRatio=tm,tF.frozenColCount=k,tF.frozenRowCount=B,tF.unfreezeAllOnExceedsMaxWidth=null==P||P,tF.defaultRowHeight=F,tF.defaultHeaderRowHeight=null!=D?D:F,tF.defaultColWidth=z,tF.defaultHeaderColWidth=null!=Z?Z:z,tF.keyboardOptions=J,tF.eventOptions=Q,tF.rowSeriesNumber=te,tF.enableCheckboxCascade=null==(a=null!=ti?ti:null==te?void 0:te.enableTreeCheckbox)||a,tF.enableHeaderCheckboxCascade=ti||null==tr||tr,tF.columnResizeMode=null!=(o=null==ts?void 0:ts.columnResizeMode)?o:tn,tF.canResizeColumn=null==ts?void 0:ts.canResizeColumn,tF.rowResizeMode=null!=(h=null==ts?void 0:ts.rowResizeMode)?h:tl,tF.dragHeaderMode=null!=(u=null!=(d=null==to?void 0:to.dragHeaderMode)?d:ta)?u:"none",tF.renderChartAsync=ty,(0,tj.Ry)(tv),tF.overscrollBehavior=null!=tM?tM:"auto",tF.groupBy=null!=(c=null==tP?void 0:tP.groupBy)?c:tB,tF.groupTitleCheckbox=null!=(p=null==tP?void 0:tP.titleCheckbox)?p:!!(null==te?void 0:te.enableTreeCheckbox),tF.groupTitleFieldFormat=null!=(g=null==tP?void 0:tP.titleFieldFormat)?g:tI,tF.groupTitleCustomLayout=null!=(f=null==tP?void 0:tP.titleCustomLayout)?f:tE,tF.enableTreeStickCell=null!=(m=null==tP?void 0:tP.enableTreeStickCell)?m:tL,tF._rowHeightsMap=new rR(this),tF._rowRangeHeightsMap=new Map,tF._colRangeWidthsMap=new Map,tF._widthResizedColMap=new Set,tF._heightResizedRowMap=new Set,this.colWidthsMap=new L.B,this.colContentWidthsMap=new L.B,this.colWidthsLimit={};let tO=this;if(tF.calcWidthContext={_:tF,get full(){var tH,tD;return"node"===T.X.mode?tO.canvasWidth/(null!=tm?tm:1):this._.canvas.width/(null!=(tD=null!=(tH=this._.context.pixelRatio)?tH:tO.internalProps.pixelRatio)?tD:window.devicePixelRatio)}},tF.cellTextOverflows={},tF.focusedTable=!1,tF.theme=H.default.of(null!=(v=e.theme)?v:H.default.DEFAULT),tF.theme.isPivot=this.isPivotTable(),(0,tb.E6)(tF.theme.functionalIconsStyle),t&&(tR&&(t.innerHTML=""),t.appendChild(tF.element)),this._updateSize(),tF.bodyHelper=new rv(this),tF.headerHelper=new rA(this),tF.rowSeriesNumberHelper=new rB(this),tF.autoWrapText=e.autoWrapText,tF.enableLineBreak=e.enableLineBreak,tF.allowFrozenColCount=null!=(b=e.allowFrozenColCount)?b:0,tF.limitMaxAutoWidth=null!=(_=e.limitMaxAutoWidth)?_:450,tF.limitMinWidth=null!=tT?"number"==typeof tT?tT:10*!!tT:10,tF.limitMinHeight=null!=tk?"number"==typeof tk?tk:10*!!tk:10,this.scenegraph=new iI(this),this.stateManager=new iq(this),this.eventManager=new rc(this),this.animationManager=new rq(this),e.legends){tF.legends=[];let t=G.F.getFunction("createLegend");if(Array.isArray(e.legends)){for(let i=0;i<e.legends.length;i++)tF.legends.push(t(e.legends[i],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else tF.legends.push(t(e.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if(tF.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:R.u.bottom},e.tooltip),"html"===tF.tooltip.renderMode){let t=G.F.getComponent("tooltipHandler");t&&(tF.tooltipHandler=new t(this,tF.tooltip.confine))}tF.menu=Object.assign({renderMode:"html"},e.menu),Array.isArray(null==(C=e.menu)?void 0:C.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(x=e.menu)?void 0:x.dropDownMenuHighlight),(Array.isArray(null==(w=e.menu)?void 0:w.defaultHeaderMenuItems)||"function"==typeof(null==(S=e.menu)?void 0:S.defaultHeaderMenuItems))&&(this.globalDropDownMenu=e.menu.defaultHeaderMenuItems),"html"===tF.menu.renderMode&&(tF.menuHandler=new(G.F.getComponent("menuHandler"))(this)),this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyMergeTitleCache=new Map,this.bodyBottomStyleCache=new Map,tF.stick={changedCells:new Map},tF.customMergeCell=(0,rJ.k)(e.customMergeCell);let tz=G.F.getComponent("customCellStylePlugin");tz&&(this.customCellStylePlugin=new tz(this,null!=(A=e.customCellStyle)?A:[],null!=(M=e.customCellStyleArrangement)?M:[])),this._adjustCanvasSizeByOption()}_adjustCanvasSizeByOption(){"auto"!==this.options.canvasHeight&&"auto"!==this.options.canvasWidth||setTimeout(()=>{var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w;let S,A;if("auto"===this.options.canvasHeight){let c=0;if(null==(t=this.theme.frameStyle)?void 0:t.innerBorder)c+=null!=(r=r0(null!=(i=null==(e=this.internalProps.theme.frameStyle)?void 0:e.shadowBlur)?i:[0])[1])?r:0;else if(this.theme.frameStyle){let t=r0(null!=(l=null==(n=this.internalProps.theme.frameStyle)?void 0:n.borderLineWidth)?l:[null]),e=r0(null!=(a=null==(s=this.internalProps.theme.frameStyle)?void 0:s.shadowBlur)?a:[0]);c+=(null!=(o=t[0])?o:0)+(null!=(h=e[0])?h:0)+((null!=(d=t[2])?d:0)+(null!=(u=e[2])?u:0))}A=Math.min(this.options.maxCanvasHeight?this.options.maxCanvasHeight-c:2e4,this.getAllRowsHeight())+c}else A=this.canvasHeight;if("auto"===this.options.canvasWidth){let t=0;if(null==(c=this.theme.frameStyle)?void 0:c.innerBorder)t+=null!=(f=r0(null!=(g=null==(p=this.internalProps.theme.frameStyle)?void 0:p.shadowBlur)?g:[0])[2])?f:0;else if(this.theme.frameStyle){let e=r0(null!=(y=null==(m=this.internalProps.theme.frameStyle)?void 0:m.borderLineWidth)?y:[null]),i=r0(null!=(b=null==(v=this.internalProps.theme.frameStyle)?void 0:v.shadowBlur)?b:[0]);t+=(null!=(_=e[1])?_:0)+(null!=(C=i[1])?C:0)+((null!=(x=e[3])?x:0)+(null!=(w=i[3])?w:0))}S=Math.min(this.options.maxCanvasWidth?this.options.maxCanvasWidth-t:2e4,this.getAllColsWidth())+t}else S=this.canvasWidth;this.setCanvasSize(S,A)},0)}getContainer(){return this.container}getElement(){return this.internalProps.element}get canvas(){return this.internalProps.canvas}setCanvasSize(t,e){this.canvasWidth=t,this.canvasHeight=e,this.options.canvasHeight=e,this.options.canvasWidth=t,this.resize()}setContentInsetXY(t,e){this.contentOffsetX=t,this.contentOffsetY=e,this.options.contentOffsetX=t,this.options.contentOffsetY=e,this.resize()}resize(){var t;this._updateSize(),null==(t=this.internalProps.legends)||t.forEach(t=>{null==t||t.resize()}),this.internalProps.title&&this.internalProps.title.resize(),this.internalProps.emptyTip&&this.internalProps.emptyTip.resize(),this.scenegraph.resize()}get rowCount(){return this.internalProps.rowCount}set rowCount(t){this.internalProps.rowCount=t}get colCount(){var t;return null!=(t=this.internalProps.colCount)?t:0}set colCount(t){this.internalProps.colCount=t}get frozenColCount(){var t,e,i,r,n;return null!=(n=null!=(i=null==(e=null==(t=this.internalProps)?void 0:t.layoutMap)?void 0:e.frozenColCount)?i:null==(r=this.internalProps)?void 0:r.frozenColCount)?n:0}set frozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;let e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{let e=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=e}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;let e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{let e=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=e}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}_setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t}_resetFrozenColCount(){this.options.frozenColCount&&(this.tableNoFrameWidth-this.getColsWidth(0,this.options.frozenColCount-1)<=120?this._setFrozenColCount(0):this.frozenColCount!==this.options.frozenColCount&&this._setFrozenColCount(this.options.frozenColCount))}get frozenRowCount(){var t,e,i,r,n;return null!=(n=null!=(i=null==(e=null==(t=this.internalProps)?void 0:t.layoutMap)?void 0:e.frozenRowCount)?i:null==(r=this.internalProps)?void 0:r.frozenRowCount)?n:0}set frozenRowCount(t){this.internalProps.frozenRowCount=t,this.options.frozenRowCount=t,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}_setFrozenRowCount(t){this.internalProps.frozenRowCount=t,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}get rightFrozenColCount(){var t,e,i,r,n;return null!=(n=null!=(i=null==(e=null==(t=this.internalProps)?void 0:t.layoutMap)?void 0:e.rightFrozenColCount)?i:null==(r=this.internalProps)?void 0:r.rightFrozenColCount)?n:0}set rightFrozenColCount(t){this.scenegraph.dealWidthRightFrozen(t)}get bottomFrozenRowCount(){var t,e,i,r,n;return null!=(n=null!=(i=null==(e=null==(t=this.internalProps)?void 0:t.layoutMap)?void 0:e.bottomFrozenRowCount)?i:null==(r=this.internalProps)?void 0:r.bottomFrozenRowCount)?n:0}set bottomFrozenRowCount(t){this.scenegraph.dealWidthBottomFrozen(t)}get defaultRowHeight(){return(0,$.Z)(this.internalProps.defaultRowHeight)?this.internalProps.defaultRowHeight:40}set defaultRowHeight(t){this.internalProps.defaultRowHeight=t,this.options.defaultRowHeight=t}get defaultHeaderRowHeight(){return this.internalProps.defaultHeaderRowHeight}set defaultHeaderRowHeight(t){this.internalProps.defaultHeaderRowHeight=t,this.options.defaultHeaderRowHeight=t}get defaultColWidth(){return this.internalProps.defaultColWidth}set defaultColWidth(t){this.internalProps.defaultColWidth=t,this.options.defaultColWidth=t}get defaultHeaderColWidth(){return this.internalProps.defaultHeaderColWidth}set defaultHeaderColWidth(t){this.internalProps.defaultHeaderColWidth=t,this.options.defaultHeaderColWidth=t}get colWidthsMap(){return this.internalProps._colWidthsMap}set colWidthsMap(t){this.internalProps._colWidthsMap=t}get colContentWidthsMap(){return this.internalProps._colContentWidthsMap}set colContentWidthsMap(t){this.internalProps._colContentWidthsMap=t}get _colRangeWidthsMap(){return this.internalProps._colRangeWidthsMap}set _colRangeWidthsMap(t){this.internalProps._colRangeWidthsMap=t}get _rowRangeHeightsMap(){return this.internalProps._rowRangeHeightsMap}set _rowRangeHeightsMap(t){this.internalProps._rowRangeHeightsMap=t}get rowHeightsMap(){return this.internalProps._rowHeightsMap}set rowHeightsMap(t){this.internalProps._rowHeightsMap=t}get colWidthsLimit(){return this.internalProps._colWidthsLimit}set colWidthsLimit(t){this.internalProps._colWidthsLimit=t}get keyboardOptions(){var t;return null!=(t=this.internalProps.keyboardOptions)?t:null}set keyboardOptions(t){this.internalProps.keyboardOptions=null!=t?t:void 0}get eventOptions(){var t;return null!=(t=this.internalProps.eventOptions)?t:null}set eventOptions(t){this.internalProps.eventOptions=null!=t?t:void 0}get widthMode(){return this._widthMode}set widthMode(t){t!==this._widthMode&&(this._widthMode=t,this.options.widthMode=t)}get heightMode(){return this._heightMode}set heightMode(t){t!==this._heightMode&&(this._heightMode=t,this.options.heightMode=t)}get autoFillWidth(){return this._autoFillWidth}set autoFillWidth(t){t!==this._autoFillWidth&&(this._autoFillWidth=t)}get autoFillHeight(){return this._autoFillHeight}set autoFillHeight(t){t!==this._autoFillHeight&&(this._autoFillHeight=t)}get widthAdaptiveMode(){return this._widthAdaptiveMode}set widthAdaptiveMode(t){t!==this._widthAdaptiveMode&&(this._widthAdaptiveMode=t)}get heightAdaptiveMode(){return this._heightAdaptiveMode}set heightAdaptiveMode(t){t!==this._heightAdaptiveMode&&(this._heightAdaptiveMode=t)}_colWidthDefineToPxWidth(t){return"auto"===t?0:(0,V.qf)(this,t)}_getMaxFrozenWidth(){var t;let e=null!=(t=this.options.maxFrozenWidth)?t:"80%";return(0,V.qf)(this,e)}_getComputedFrozenColCount(t){let e=this._getMaxFrozenWidth(),i=t;for(;this.getColsWidth(0,i-1)>e&&!(--i<=0););return i}_getColWidthLimits(t){let e=this.colWidthsLimit[t];if(!e)return null;let i={};return e.min&&(i.min=(0,V.qf)(this,e.min),i.minDef=e.min),e.max&&(i.max=(0,V.qf)(this,e.max),i.maxDef=e.max),i}_adjustColWidth(t,e){let i=this._getColWidthLimits(t);return Math.max((0,V.AS)(i,e),0)}get pixelRatio(){return this.internalProps.pixelRatio}setPixelRatio(t){var e;if(t!==(null==(e=this.internalProps)?void 0:e.pixelRatio)){this.internalProps.pixelRatio=t;let e=this,n=this.canvasWidth;this.internalProps.calcWidthContext={_:this.internalProps,get full(){var i,r;return"node"===T.X.mode?n/(null!=t?t:1):this._.canvas.width/(null!=(r=null!=(i=this._.context.pixelRatio)?i:e.internalProps.pixelRatio)?r:window.devicePixelRatio)}},this.scenegraph.setPixelRatio(t)}}_updateSize(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,v,b,_,C,x,w,S,A,M,R,P,B,I;let{padding:E}=this,L=0,F=0;if(this.tableX=this.contentOffsetX,this.tableY=this.contentOffsetY,this.options.canvas&&this.options.viewBox)L=this.options.viewBox.x2-this.options.viewBox.x1,F=this.options.viewBox.y2-this.options.viewBox.y1,(null==(t=null==this?void 0:this.scenegraph)?void 0:t.stage)&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(L,F));else if("browser"===T.X.mode){let t=this.getElement(),d=0,u=0,c=(0,y.Z)(this.canvasWidth),p=(0,y.Z)(this.canvasHeight);if(this.canvasSizeSeted&&(c&&(d=this.canvasWidth),p&&(u=this.canvasHeight)),(!c||!p)&&t.parentElement){let e=t.parentElement.style||window.getComputedStyle(t.parentElement);c||(d=t.parentElement.offsetWidth-(parseInt(e.paddingLeft,10)||0)-(parseInt(e.paddingRight,10)||0)),p||(u=t.parentElement.offsetHeight-parseInt(e.paddingTop||"0px",10)-parseInt(e.paddingBottom||"0px",20)),d=(null!=d?d:1)-!!this.options.tableSizeAntiJitter,u=(null!=u?u:1)-!!this.options.tableSizeAntiJitter}t.style.width=d&&d-E.left-E.right+"px"||"0px",t.style.height=u&&u-E.top-E.bottom+"px"||"0px";let{canvas:g}=this.internalProps;L=(null!=(i=null==(e=g.parentElement)?void 0:e.offsetWidth)?i:1)-!!this.options.tableSizeAntiJitter,F=(null!=(n=null==(r=g.parentElement)?void 0:r.offsetHeight)?n:1)-!!this.options.tableSizeAntiJitter,(null==(l=null==this?void 0:this.scenegraph)?void 0:l.stage)?(null==(s=this.options)?void 0:s.viewBox)&&!(null==(a=this.options)?void 0:a.canvas)&&this.scenegraph.stage.resize(L,F):(g.style.width="",g.style.height="",g.width=L,g.height=F,g.style.width=`${L}px`,g.style.height=`${F}px`),(null==(o=this.options)?void 0:o.viewBox)&&(L=this.options.viewBox.x2-this.options.viewBox.x1,F=this.options.viewBox.y2-this.options.viewBox.y1),(null==(h=null==this?void 0:this.scenegraph)?void 0:h.stage)&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(L,F))}else"node"===T.X.mode&&(L=this.canvasWidth-1,F=this.canvasHeight-1);let O=this.getTheme().scrollStyle,H=0,D=0;H=this.shouldVScrollBarWidthShow(L,F,O)?k.Iv(O):0,D=this.shouldHScrollBarWidthShow(L,F,O)?k.vP(O):0;let z=Math.floor(L-H),W=Math.floor(F-D);if(null==(d=this.internalProps.theme)?void 0:d.frameStyle){let t=r0(null!=(c=null==(u=this.internalProps.theme.frameStyle)?void 0:u.borderLineWidth)?c:[null]),e=r0(null!=(g=null==(p=this.internalProps.theme.frameStyle)?void 0:p.shadowBlur)?g:[0]);if(null==(f=this.theme.frameStyle)?void 0:f.innerBorder)this.tableX+=this.contentOffsetX,this.tableY+=this.contentOffsetY,this.tableNoFrameWidth=z-(null!=(m=e[1])?m:0)-this.contentOffsetX,this.tableNoFrameHeight=W-(null!=(v=e[2])?v:0)-this.contentOffsetY;else{this.tableX+=(null!=(b=t[3])?b:0)+(null!=(_=e[3])?_:0),this.tableY+=(null!=(C=t[0])?C:0)+(null!=(x=e[0])?x:0);let i=(null!=(w=t[1])?w:0)+(null!=(S=e[1])?S:0);this.tableNoFrameWidth=z-(i>H?i-H:0)-((null!=(A=t[3])?A:0)+(null!=(M=e[3])?M:0))-this.contentOffsetX;let r=(null!=(R=t[2])?R:0)+(null!=(P=e[2])?P:0);this.tableNoFrameHeight=W-(r>D?r-D:0)-((null!=(B=t[0])?B:0)+(null!=(I=e[0])?I:0))-this.contentOffsetY}}this._clearColRangeWidthsMap(),this._clearRowRangeHeightsMap()}shouldVScrollBarWidthShow(t,e,i){if(i.hoverOn||"none"===i.visible)return!1;let r=this.getAllRowsHeight(),n=i.visible?k.vP(i):0;if(r>e-n&&r<=e){let e=this.getAllColsWidth(),r=i.visible?k.Iv(i):0;if(e>t-r&&e<=t)return!1;if(e>t)return!0;if(e<=t-r)return!1}return!(r<=e-n)}shouldHScrollBarWidthShow(t,e,i){if(i.hoverOn||"none"===i.visible)return!1;let r=this.getAllColsWidth(),n=i.visible?k.Iv(i):0;if(r>t-n&&r<=t){let t=this.getAllRowsHeight(),r=i.visible?k.vP(i):0;if(t>e-r&&t<=e)return!1;if(t>e)return!0;if(t<=e-r)return!1}return!(r<=t-n)}updateViewBox(t){var e,i,r,n,l,s,a,o,h,d,u,c;let p=(null!=(r=null==(i=null==(e=this.options)?void 0:e.viewBox)?void 0:i.x2)?r:0)-(null!=(s=null==(l=null==(n=this.options)?void 0:n.viewBox)?void 0:l.x1)?s:0),g=(null!=(h=null==(o=null==(a=this.options)?void 0:a.viewBox)?void 0:o.y2)?h:0)-(null!=(c=null==(u=null==(d=this.options)?void 0:d.viewBox)?void 0:u.y1)?c:0),f=t.x2-t.x1,m=t.y2-t.y1;this.options.viewBox=t,p!==f||g!==m?this.resize():this.scenegraph.stage.setViewBox(this.options.viewBox,!0)}setViewBoxTransform(t,e,i,r,n,l){this.internalProps.modifiedViewBoxTransform=!0,this.scenegraph.stage.window.setViewBoxTransform(t,e,i,r,n,l)}get rowHierarchyType(){return this.dataSource.rowHierarchyType}getColsWidth(t,e){var i;if(t>e)return 0;t=Math.max(t,0),e=Math.min(e,(null!=(i=this.colCount)?i:1/0)-1);let r=this._colRangeWidthsMap.get(`$${t}$${e}`);if(null!=r)return r;let n=this._colRangeWidthsMap.get(`$${t}$${e-1}`);if(null!=n){let i=n+this.getColWidth(e);return this.rightFrozenColCount>0&&e===this.colCount-this.rightFrozenColCount&&(i=this._getRangeSizeForContainerFit(t,e,i,"col")),t>=0&&e>=0&&!Number.isNaN(i)&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(i)),Math.round(i)}let l=0;for(let i=t;i<=e;i++)l+=this.getColWidth(i);return l=this._getRangeSizeForContainerFit(t,e,l,"col"),t>=0&&e>=0&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(l)),Math.round(l)}getRowHeight(t){var e;if((0,y.Z)(this.rowHeightsMap.get(t))){if(null==(e=this.options.customConfig)?void 0:e._disableColumnAndRowSizeRound){let e,i=this.rowHeightsMap.get(t);return Number.isInteger(Number((t<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,t):t>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(t,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,t)).toFixed(2)))?Math.ceil(i):Math.floor(i)}return this.rowHeightsMap.get(t)}let i=this.getDefaultRowHeight(t);return(0,$.Z)(i)?i:this.defaultRowHeight}getDefaultColumnWidth(t){var e,i;return this.isRowHeader(t,0)||this.isCornerHeader(t,0)?Array.isArray(this.defaultHeaderColWidth)?null!=(e=this.defaultHeaderColWidth[t])?e:this.defaultColWidth:this.defaultHeaderColWidth:this.isRightFrozenColumn(t,this.columnHeaderLevelCount)&&this.isPivotTable()?Array.isArray(this.defaultHeaderColWidth)?null!=(i=this.defaultHeaderColWidth[this.rowHeaderLevelCount-this.rightFrozenColCount])?i:this.defaultColWidth:this.defaultHeaderColWidth:this.defaultColWidth}getDefaultRowHeight(t){var e,i;return this.isColumnHeader(0,t)||this.isCornerHeader(0,t)||this.isSeriesNumberInHeader(0,t)?Array.isArray(this.defaultHeaderRowHeight)?null!=(e=this.defaultHeaderRowHeight[t])?e:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.isBottomFrozenRow(t)?Array.isArray(this.defaultHeaderRowHeight)?null!=(i=this.defaultHeaderRowHeight[this.columnHeaderLevelCount>0?this.columnHeaderLevelCount-this.bottomFrozenRowCount:0])?i:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.internalProps.defaultRowHeight}_setRowHeight(t,e,i){var r;this.rowHeightsMap.put(t,(null==(r=this.options.customConfig)?void 0:r._disableColumnAndRowSizeRound)?e:Math.round(e)),i&&this._clearRowRangeHeightsMap(t)}setRowHeight(t,e){this.scenegraph.setRowHeight(t,e),this.scenegraph.updateChartSizeForResizeRowHeight(t),this.internalProps._heightResizedRowMap.add(t)}getRowsHeight(t,e){var i,r,n;if(t>e||0===this.rowCount)return 0;t=Math.max(t,0),e=Math.min(e,(null!=(i=this.rowCount)?i:1/0)-1);let l=0,s="auto"===this.options.defaultRowHeight;if("standard"!==this.heightMode||this.options.customComputeRowHeight||this.autoFillHeight||!this.internalProps.layoutMap||this.hasAutoImageColumn()||s||0!==this.internalProps._heightResizedRowMap.size){if(null==(r=this.options.customConfig)?void 0:r._disableColumnAndRowSizeRound){let i,r=this.rowHeightsMap.getSumInRange(t,e);return Number.isInteger(Number((e<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,e):e>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(e,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,e)).toFixed(2)))?Math.ceil(r):Math.floor(r)}l=this.rowHeightsMap.getSumInRange(t,e)}else{let i=this.rowCount-this.bottomFrozenRowCount;for(let i=t;i<Math.min(e+1,this.columnHeaderLevelCount);i++)l+=this.getRowHeight(i);e>=this.columnHeaderLevelCount&&(l+=this.defaultRowHeight*(Math.min(e,i-1)-Math.max(this.columnHeaderLevelCount,t)+1));let r=0;for(let t=i;t<e+1;t++)r+=this.getRowHeight(t);l=this._getRangeSizeForContainerFit(t,e,l+r,"row")}return(null==(n=this.options.customConfig)?void 0:n._disableColumnAndRowSizeRound)?l:Math.round(l)}_getRangeSizeForContainerFit(t,e,i,r="col"){var n;if(!isFinite(t)||!isFinite(e))return i;let l="col"===r?{totalCount:"colCount",frozenCount:"rightFrozenColCount",fitType:"width",tableSize:"tableNoFrameWidth",getSize:"getColWidth"}:{totalCount:"rowCount",frozenCount:"bottomFrozenRowCount",fitType:"height",tableSize:"tableNoFrameHeight",getSize:"getRowHeight"},s=this[l.tableSize];if(i>=s)return i;let a=this[l.totalCount]-this[l.frozenCount];if(!isFinite(this[l.totalCount])||this[l.frozenCount]<=0||a<0||t>a||e<a||t===e||!(null==(n=this.containerFit)?void 0:n[l.fitType]))return i;let o=this[l.totalCount]-1,h=s;if(t>0){for(let e=0;e<t;e++)if((h-=this[l.getSize](e))<=0)return i}if(e!==o){for(let t=e+1;t<=o;t++)if((h-=this[l.getSize](t))<=0)return i}return h}getColWidthDefined(t){var e;let{layoutMap:i}=this.internalProps;if("autoWidth"===this.widthMode)return"auto";let{width:r}=null!=(e=null==i?void 0:i.getColumnWidthDefined(t))?e:{};return"number"==typeof r&&r<=0?0:r||this.getDefaultColumnWidth(t)}getColWidthDefinedNumber(t){let e=this.getColWidthDefined(t);return this._adjustColWidth(t,this._colWidthDefineToPxWidth(e))}isAutoRowHeight(t){return"autoHeight"===this.heightMode||!!this.options.customComputeRowHeight||!!this.internalProps.rowHeightConfig||(t>=0&&t<this.columnHeaderLevelCount?"auto"===this.getDefaultRowHeight(t):"auto"===this.internalProps.defaultRowHeight)}getColWidth(t){var e;let i=null!=(e=this.colWidthsMap.get(t))?e:this.getDefaultColumnWidth(t);return"adaptive"===this.widthMode&&"number"==typeof i||this.transpose&&"number"==typeof i?this._colWidthDefineToPxWidth(i):this._adjustColWidth(t,this._colWidthDefineToPxWidth(i))}_setColWidth(t,e,i,r){this.colWidthsMap.put(t,"number"==typeof e?Math.round(e):e),i&&this._clearColRangeWidthsMap(t),r||this.stateManager.checkFrozen()}setColWidth(t,e){this.scenegraph.setColWidth(t,e),this.scenegraph.updateChartSizeForResizeColWidth(t),this.internalProps._widthResizedColMap.add(t)}_clearColRangeWidthsMap(t){if("number"!=typeof t)this._colRangeWidthsMap.clear();else for(let e of this._colRangeWidthsMap.keys()){let i=r2.exec(e);if(i){let r=Number(i[1]),n=Number(i[2]);t>=r&&t<=n&&this._colRangeWidthsMap.delete(e)}}}_clearRowRangeHeightsMap(t){this.rowHeightsMap.clearRange()}_getColContentWidth(t){return Number(this.colContentWidthsMap.get(t))}_setColContentWidth(t,e){this.colContentWidthsMap.put(t,e)}getAllRowsHeight(){var t;return(null==(t=this.internalProps)?void 0:t.rowCount)&&!(this.internalProps.rowCount<=0)?this.getRowsHeight(0,this.internalProps.rowCount-1):0}getAllColsWidth(){var t;return(null==(t=this.internalProps)?void 0:t.colCount)&&!(this.internalProps.colCount<=0)?this.getColsWidth(0,this.internalProps.colCount-1):0}getColsWidths(){let t=this.colCount,e=[];for(let i=0;i<t;i++)e.push(this.getColWidth(i));return e}getMaxColWidth(t){var e;let i=this.colWidthsLimit[t],r=null!=(e=i&&i.max)?e:1/0;return"string"==typeof r&&(r=(0,V.qf)(this,r)),r}setMaxColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).max=e}getMinColWidth(t){var e;let i=this.colWidthsLimit[t],r=null!=(e=i&&i.min)?e:0;return"string"==typeof r&&(r=(0,V.qf)(this,r)),r}setMinColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).min=e}getCellRect(t,e){var i,r;let n,l,s=this.isFrozenCell(t,e),a=this.getColWidth(t);n=s&&s.col&&this.isRightFrozenColumn(t,e)?this.getAllColsWidth()<=this.tableNoFrameWidth?this.getColsWidth(0,t-1)||0:this.tableNoFrameWidth-(null!=(i=this.getColsWidth(t,this.colCount-1))?i:0):this.getColsWidth(0,t-1)||0;let o=this.getRowHeight(e);return l=s&&s.row&&this.isBottomFrozenRow(t,e)?this.getAllRowsHeight()<=this.tableNoFrameHeight?this.getRowsHeight(0,e-1):this.tableNoFrameHeight-(null!=(r=this.getRowsHeight(e,this.rowCount-1))?r:0):this.getRowsHeight(0,e-1),new F.U(Math.round(n),Math.round(l),Math.round(a),Math.round(o))}getMergeCellRect(t,e){let i=this.getCellRange(t,e),r=this.getColsWidth(0,i.start.col-1)||0,n=this.getColsWidth(i.start.col,i.end.col),l=this.getRowsHeight(0,i.start.row-1)||0,s=this.getRowsHeight(i.start.row,i.end.row);return new F.U(Math.round(r),Math.round(l),Math.round(n),Math.round(s))}getCellRelativeRect(t,e){let i=this.isFrozenCell(t,e),r=!0,n=!0;(null==i?void 0:i.col)&&(null==i?void 0:i.row)?(r=!1,n=!1):(null==i?void 0:i.col)?r=!1:(null==i?void 0:i.row)&&(n=!1);let l=this.getCellRect(t,e);return this._toRelativeRect(l,r,n)}getCellRangeRelativeRect(t){if(t.start){let e=this.isFrozenCell(t.start.col,t.start.row),i=!0,r=!0;return(null==e?void 0:e.col)&&(null==e?void 0:e.row)?(i=!1,r=!1):(null==e?void 0:e.col)?i=!1:(null==e?void 0:e.row)&&(r=!1),this._toRelativeRect(this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row),i,r)}let e=this.getCellRange(t.col,t.row),i=this.isFrozenCell(t.col,t.row),r=!0,n=!0;return(null==i?void 0:i.col)&&(null==i?void 0:i.row)?(r=!1,n=!1):(null==i?void 0:i.col)?r=!1:(null==i?void 0:i.row)&&(n=!1),this._toRelativeRect(this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row),r,n)}getVisibleCellRangeRelativeRect(t){let e;return e=t.start?t:this.getCellRange(t.col,t.row),this._getVisiableRect(this.getCellRangeRelativeRect(t),e)}_getVisiableRect(t,e){let i=e.start.col>=this.frozenColCount?Math.max(t.left,this.frozenColCount>=1?this.getColsWidth(0,this.frozenColCount-1):0):t.left,r=Math.min(t.right,this.tableNoFrameWidth),n=t.copy();n.left=i,n.right=r;let l=e.start.row>=this.frozenRowCount?Math.max(t.top,this.frozenRowCount>=1?this.getRowsHeight(0,this.frozenRowCount-1):0):t.top,s=Math.min(t.bottom,this.tableNoFrameHeight);return n.top=l,n.bottom=s,n}getCellsRect(t,e,i,r){var n,l,s,a,o,h;let d=this.getColsWidth(0,t-1)||0,u=this.getColsWidth(t,i),c=this.scrollLeft,p=Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),g=Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());this.isLeftFrozenColumn(t)&&this.isRightFrozenColumn(i)?u=this.tableNoFrameWidth-(null!=(n=this.getColsWidth(t+1,this.colCount-1))?n:0)-d:this.isLeftFrozenColumn(t)&&!this.isLeftFrozenColumn(i)?u=Math.max(u-c,this.getColsWidth(t,this.frozenColCount-1)):!this.isRightFrozenColumn(t)&&this.isRightFrozenColumn(i)?(d=Math.min(d-c,p-this.getRightFrozenColsWidth()),u=p-(null!=(l=this.getColsWidth(t+1,this.colCount-1))?l:0)-d):this.isRightFrozenColumn(t)&&(d=p-(null!=(s=this.getColsWidth(t,this.colCount-1))?s:0));let f=this.getRowsHeight(0,e-1),m=this.getRowsHeight(e,r),y=this.scrollTop;return this.isTopFrozenRow(e)&&this.isBottomFrozenRow(r)?m=this.tableNoFrameHeight-(null!=(a=this.getRowsHeight(e+1,this.rowCount-1))?a:0)-f:this.isTopFrozenRow(e)&&!this.isTopFrozenRow(r)?m=Math.max(m-y,this.getRowsHeight(e,this.frozenRowCount-1)):!this.isBottomFrozenRow(e)&&this.isBottomFrozenRow(r)?(f=Math.min(f-y,g-this.getBottomFrozenRowsHeight()),m=g-(null!=(o=this.getRowsHeight(e+1,this.rowCount-1))?o:0)-f):this.isBottomFrozenRow(e)&&(f=g-(null!=(h=this.getRowsHeight(e,this.rowCount-1))?h:0)),new F.U(Math.round(d),Math.round(f),Math.round(u),Math.round(m))}getCellsRectWidth(t,e,i,r){let n=this.isFrozenCell(t,e),l=this.isFrozenCell(i,r),s=this.getColsWidth(t,i);if(n&&n.col){let e=this.scrollLeft;l&&l.col||(s-=e,s=Math.max(s,this.getColsWidth(t,this.frozenColCount-1)))}return s}getCellRangeRect(t){if(t.start)return this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row);let e=this.getCellRange(t.col,t.row);return this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row)}getCellRangeRectWidth(t){if(t.start)return this.getCellsRectWidth(t.start.col,t.start.row,t.end.col,t.end.row);let e=this.getCellRange(t.col,t.row);return this.getCellsRectWidth(e.start.col,e.start.row,e.end.col,e.end.row)}isFrozenCell(t,e){let i=this.isFrozenRow(e),r=this.isFrozenColumn(t);return i||r?{row:i,col:r}:null}getRowAt(t){return rL(t,this)}getColAt(t){return rF(t,this)}getCellAt(t,e){let{row:i,top:r,bottom:n,height:l}=rL(e,this),{col:s,left:a,right:o,width:h}=rF(t,this);return{row:i,col:s,rect:{left:a,right:o,top:r,bottom:n,width:h,height:l}}}getCellAtRelativePosition(t,e){return function(t,e,i){t-=i.tableX;let r=!1;(e-=i.tableY)>0&&e<i.getFrozenRowsHeight()&&(r=!0);let n=!1;t>0&&t<i.getFrozenColsWidth()&&(n=!0);let l=!1;e>i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()&&e<i.tableNoFrameHeight&&e<=i.getAllRowsHeight()&&(l=!0);let s=!1;t>i.tableNoFrameWidth-i.getRightFrozenColsWidth()&&t<i.tableNoFrameWidth&&t<=i.getAllColsWidth()&&(s=!0);let a=rD((n||s?t:t+i.scrollLeft)+i.tableX,s,i),o=rz((r||l?e:e+i.scrollTop)+i.tableY,l,i);if(a&&o){let{row:t,top:e,bottom:i,height:r}=o,{col:n,left:l,right:s,width:h}=a;return{row:t,col:n,rect:{left:l,right:s,top:e,bottom:i,width:h,height:r}}}return{col:-1,row:-1}}(t,e,this)}getColAtRelativePosition(t){return function(t,e){let i=!1;(t-=e.tableX)>0&&t<e.getFrozenColsWidth()&&(i=!0);let r=!1;t>e.tableNoFrameWidth-e.getRightFrozenColsWidth()&&t<e.tableNoFrameWidth&&t<=e.getAllColsWidth()&&(r=!0);let n=rD((i||r?t:t+e.scrollLeft)+e.tableX,r,e);if(n){let{col:t}=n;return t}return -1}(t,this)}getRowAtRelativePosition(t){return function(t,e){let i=!1;(t-=e.tableY)>0&&t<e.getFrozenRowsHeight()&&(i=!0);let r=!1;t>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()&&t<e.tableNoFrameHeight&&t<=e.getAllRowsHeight()&&(r=!0);let n=rz((i||r?t:t+e.scrollTop)+e.tableY,r,e);if(n){let{row:t}=n;return t}return -1}(t,this)}_checkRowCol(t,e){return t>=0&&t<this.colCount&&e>=0&&e<this.rowCount}_makeVisibleCell(t,e){if(this._checkRowCol(t,e)){let i=this.isFrozenCell(t,e);if(i&&i.col&&i.row)return;let r=this.getCellRect(t,e),n=(0,V.VN)(this);!n.contains(r)&&(i&&i.col||this.getColsWidth(0,this.frozenColCount-1)+r.width>this.canvas.width||(r.left<n.left?this.scrollLeft-=n.left-r.left:n.right<r.right&&(this.scrollLeft-=n.right-r.right)),i&&i.row||this.getRowsHeight(0,this.frozenRowCount-1)+r.height>this.canvas.height||(r.top<n.top?this.scrollTop-=n.top-r.top:n.bottom<r.bottom&&(this.scrollTop-=n.bottom-r.bottom)))}}render(){this.scenegraph.renderSceneGraph()}renderAsync(){return this.scenegraph.updateNextFrame(),new Promise((t,e)=>{setTimeout(()=>{t()},0)})}_toRelativeRect(t,e=!0,i=!0){var r,n,l,s;let a=t.copy(),o=this.getVisibleRect();return a.offsetLeft(this.tableX-(e?o.left:0)),a.offsetTop(this.tableY-(i?o.top:0)),a.offsetLeft(null!=(n=null==(r=this.options.viewBox)?void 0:r.x1)?n:0),a.offsetTop(null!=(s=null==(l=this.options.viewBox)?void 0:l.y1)?s:0),a}getVisibleRect(){let{scrollTop:t,scrollLeft:e}=this,i=this.tableNoFrameWidth,r=this.tableNoFrameHeight;return new F.U(e,t,i,r)}get visibleRowCount(){let{frozenRowCount:t}=this,e=this.getVisibleRect(),i=t>0?e.top+this.getRowsHeight(0,t-1):e.top,r=this.getTargetRowAt(i);if(!r)return 0;let n=Math.max(r.top>=i?r.row:r.row+1,t),l=this.getRowsHeight(0,n-1),s=0,{rowCount:a}=this;for(let t=n;t<a;t++){let i=l+this.getRowHeight(t);if(e.bottom<i)break;s++,l=i}return s}getBodyVisibleCellRange(){let{scrollTop:t,scrollLeft:e}=this,i=this.getFrozenRowsHeight(),r=this.getFrozenColsWidth(),n=this.getBottomFrozenRowsHeight(),l=this.getRightFrozenColsWidth(),{row:s}=this.getRowAt(t+i+1),{col:a}=this.getColAt(e+r+1),o=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(t+this.tableNoFrameHeight-1-n).row:this.rowCount-1,h=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(e+this.tableNoFrameWidth-1-l).col:this.colCount-1;return h<0||o<0?null:{rowStart:s,colStart:a,rowEnd:o,colEnd:h}}getBodyVisibleRowRange(t=0,e=0){let{scrollTop:i}=this,r=this.getFrozenRowsHeight(),n=this.getBottomFrozenRowsHeight(),{row:l}=this.getRowAt(i+r+1+t),s=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(i+this.tableNoFrameHeight-1-n+e).row:this.rowCount-1;return s<0?null:{rowStart:l,rowEnd:s}}getBodyVisibleColRange(t=0,e=0){let{scrollLeft:i}=this,r=this.getFrozenColsWidth(),n=this.getRightFrozenColsWidth(),{col:l}=this.getColAt(i+r+1+t),s=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(i+this.tableNoFrameWidth-1-n+e).col:this.colCount-1;return s<0?null:{colStart:l,colEnd:s}}get visibleColCount(){let{frozenColCount:t}=this,e=this.getVisibleRect(),i=t>0?e.left+this.getColsWidth(0,t-1):e.left,r=this.getTargetColAt(i);if(!r)return 0;let n=Math.max(r.left>=i?r.col:r.col+1,t),l=this.getColsWidth(0,n-1),s=0,{colCount:a}=this;for(let t=n;t<a;t++){let i=l+this.getColWidth(t);if(e.right<i)break;s++,l=i}return s}get scrollTop(){return this.stateManager.scroll.verticalBarPos}set scrollTop(t){this.stateManager.setScrollTop(t)}get scrollLeft(){return this.stateManager.scroll.horizontalBarPos}set scrollLeft(t){this.stateManager.setScrollLeft(t)}getScrollLeft(){return this.scrollLeft}getScrollTop(){return this.scrollTop}setScrollLeft(t){this.scrollLeft=Math.ceil(t)}setScrollTop(t){this.scrollTop=Math.ceil(t)}getCellOverflowText(t,e){return this.scenegraph.getCellOverflowText(t,e)}addReleaseObj(t){if(!t||!t.release||"function"!=typeof t.release)throw Error("not releaseObj!");(this.internalProps.releaseList=this.internalProps.releaseList||[]).push(t)}dispose(){this.release()}release(){var t,e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m;let y=this.internalProps;if(this.isReleased)return;null==(e=null==(t=y.tooltipHandler)?void 0:t.release)||e.call(t),null==(r=null==(i=y.menuHandler)?void 0:i.release)||r.call(i),null==(n=super.release)||n.call(this),this.pluginManager.release(),null==(s=null==(l=y.handler)?void 0:l.release)||s.call(l),this.eventManager.release(),null==(o=null==(a=y.focusControl)?void 0:a.release)||o.call(a),null==(h=y.legends)||h.forEach(t=>{null==t||t.release()}),null==(d=y.title)||d.release(),y.title=null,null==(u=y.emptyTip)||u.release(),y.emptyTip=null,y.layoutMap.release(),y.releaseList&&(y.releaseList.forEach(t=>{var e;return null==(e=null==t?void 0:t.release)?void 0:e.call(t)}),y.releaseList=null),this.scenegraph.stage.release(),this.scenegraph.proxy.release();let v=null==(c=y.element)?void 0:c.parentElement;v&&!this.options.canvas&&v.removeChild(y.element),null==(f=null==(g=null==(p=this.editorManager)?void 0:p.editingEditor)?void 0:g.onEnd)||f.call(g),this.isReleased=!0,this.scenegraph=null,this.internalProps=null,null==(m=this.reactCustomLayout)||m.clearCache(),(0,tj.H6)()}fireListeners(t,e){return super.fireListeners(t,e)}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,k;this.fireListeners(I.B.BEFORE_UPDATE_OPTION,{options:t,container:this.container}),null==(i=this.editorManager)||i.cancelEdit(),this.options=t,this._hasAutoImageColumn=void 0;let{frozenColCount:P=0,unfreezeAllOnExceedsMaxWidth:B,defaultRowHeight:E=40,defaultHeaderRowHeight:F,defaultColWidth:O=80,defaultHeaderColWidth:D=80,keyboardOptions:z,eventOptions:W,rowSeriesNumber:Z,enableCheckboxCascade:N,enableHeaderCheckboxCascade:j,columnResizeMode:U,rowResizeMode:K="none",resize:X,dragHeaderMode:Y,dragOrder:q,showFrozenIcon:J,allowFrozenColCount:Q,padding:te,hover:ti,menu:tr,select:tn,pixelRatio:tl,widthMode:ts,heightMode:ta,autoFillWidth:to,autoFillHeight:th,containerFit:td,widthAdaptiveMode:tu,heightAdaptiveMode:tc,customRender:tp,renderChartAsync:tg,renderChartAsyncBatchCount:tf,canvasWidth:tm,canvasHeight:ty,contentOffsetX:tv=0,contentOffsetY:t_=0,overscrollBehavior:tC,limitMinWidth:tx,limitMinHeight:tw}=t,{groupConfig:tS,groupBy:tA,groupTitleFieldFormat:tM,groupTitleCustomLayout:tT,enableTreeStickCell:tk}=t;tl&&tl!==this.internalProps.pixelRatio&&(this.internalProps.pixelRatio=tl),te&&("number"==typeof te?(this.padding.top=te,this.padding.left=te,this.padding.bottom=te,this.padding.right=te):(te.top&&(this.padding.top=te.top),te.bottom&&(this.padding.bottom=te.bottom),te.left&&(this.padding.left=te.left),te.right&&(this.padding.right=te.right))),this.showFrozenIcon="boolean"!=typeof J||J,"number"==typeof Q&&Q<=0&&(this.showFrozenIcon=!1),this.widthMode=null!=ts?ts:"standard",this.heightMode=null!=ta?ta:"standard",this._widthAdaptiveMode=null!=tu?tu:"only-body",this._heightAdaptiveMode=null!=tc?tc:"only-body",this.autoFillWidth=null!=to&&to,this.autoFillHeight=null!=th&&th,void 0!==td&&(this._containerFit="boolean"==typeof td?{width:td,height:td}:td&&"object"==typeof td?{width:null==(r=td.width)||r,height:null==(n=td.height)||n}:{width:!1,height:!1}),this.customRender=tp,this.contentOffsetX=null!=tv?tv:0,this.contentOffsetY=null!=t_?t_:0,this.canvasWidth=(0,$.Z)(tm)?tm:void 0,this.canvasHeight=(0,$.Z)(ty)?ty:void 0;let tR=this.internalProps;if("node"===T.X.mode||t.canvas||(0,V.gX)(tR.element,this.padding),this.columnWidthComputeMode=null!=(l=t.columnWidthComputeMode)?l:"normal",tR.frozenColCount=P,tR.unfreezeAllOnExceedsMaxWidth=null==B||B,tR.defaultRowHeight=E,tR.defaultHeaderRowHeight=null!=F?F:E,tR.defaultColWidth=O,tR.defaultHeaderColWidth=null!=D?D:O,tR.keyboardOptions=z,tR.eventOptions=W,tR.rowSeriesNumber=Z,tR.enableCheckboxCascade=null==(s=null!=N?N:null==Z?void 0:Z.enableTreeCheckbox)||s,tR.enableHeaderCheckboxCascade=N||null==j||j,tR.columnResizeMode=null!=(a=null==X?void 0:X.columnResizeMode)?a:U,tR.canResizeColumn=null==X?void 0:X.canResizeColumn,tR.rowResizeMode=null!=(o=null==X?void 0:X.rowResizeMode)?o:K,tR.dragHeaderMode=null!=(d=null!=(h=null==q?void 0:q.dragHeaderMode)?h:Y)?d:"none",tR.renderChartAsync=tg,(0,tj.Ry)(tf),tR.overscrollBehavior=null!=tC?tC:"auto",tR.cellTextOverflows={},tR.groupBy=null!=(u=null==tS?void 0:tS.groupBy)?u:tA,tR.groupTitleCheckbox=null==tS?void 0:tS.titleCheckbox,tR.groupTitleFieldFormat=null!=(c=null==tS?void 0:tS.titleFieldFormat)?c:tM,tR.groupTitleCustomLayout=null!=(p=null==tS?void 0:tS.titleCustomLayout)?p:tT,tR.enableTreeStickCell=null!=(g=null==tS?void 0:tS.enableTreeStickCell)?g:tk,(null==e?void 0:e.clearColWidthCache)&&(tR._widthResizedColMap.clear(),this.colWidthsMap=new L.B,this.colContentWidthsMap=new L.B,this.colWidthsLimit={}),(null==e?void 0:e.clearRowHeightCache)&&(tR._heightResizedRowMap.clear(),tR._rowHeightsMap=new rR(this),tR._rowRangeHeightsMap=new Map,tR._colRangeWidthsMap=new Map),tR.stick.changedCells.clear(),tR.theme=H.default.of(null!=(f=t.theme)?f:H.default.DEFAULT),tR.theme.isPivot=this.isPivotTable(),(0,tb.E6)(tR.theme.functionalIconsStyle),this.scenegraph.updateStageBackground(),tR.autoWrapText=t.autoWrapText,tR.enableLineBreak=t.enableLineBreak,tR.allowFrozenColCount=null!=(m=t.allowFrozenColCount)?m:0,tR.limitMaxAutoWidth=null!=(y=t.limitMaxAutoWidth)?y:450,tR.limitMinWidth=null!=tx?"number"==typeof tx?tx:10*!!tx:10,tR.limitMinHeight=null!=tw?"number"==typeof tw?tw:10*!!tw:10,null==(v=tR.legends)||v.forEach(t=>{null==t||t.release()}),null==(b=tR.title)||b.release(),tR.title=null,null==(_=tR.emptyTip)||_.release(),tR.emptyTip=null,tR.layoutMap.release(),(0,tj.H6)(),this.scenegraph.clearCells(),this.scenegraph.updateComponent(),this.stateManager.updateOptionSetState(),this._updateSize(),this.eventManager.updateEventBinder(),t.legends){tR.legends=[];let e=G.F.getFunction("createLegend");if(Array.isArray(t.legends)){for(let i=0;i<t.legends.length;i++)tR.legends.push(e(t.legends[i],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else tR.legends.push(e(t.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}tR.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:R.u.bottom},t.tooltip),"html"!==tR.tooltip.renderMode||tR.tooltipHandler||(tR.tooltipHandler=new(G.F.getComponent("tooltipHandler"))(this,tR.tooltip.confine)),tR.menu=Object.assign({renderMode:"html"},t.menu),Array.isArray(null==(C=t.menu)?void 0:C.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(x=t.menu)?void 0:x.dropDownMenuHighlight),(Array.isArray(null==(w=t.menu)?void 0:w.defaultHeaderMenuItems)||"function"==typeof(null==(S=t.menu)?void 0:S.defaultHeaderMenuItems))&&(this.globalDropDownMenu=t.menu.defaultHeaderMenuItems),"html"!==tR.menu.renderMode||tR.menuHandler||(tR.menuHandler=new(G.F.getComponent("menuHandler"))(this)),this.clearCellStyleCache(),(null==e?void 0:e.clearColWidthCache)&&this.clearColWidthCache(),(null==e?void 0:e.clearRowHeightCache)&&this.clearRowHeightCache(),tR.customMergeCell=(0,rJ.k)(t.customMergeCell),null==(A=this.customCellStylePlugin)||A.updateCustomCell(null!=(M=t.customCellStyle)?M:[],null!=(k=t.customCellStyleArrangement)?k:[]),this._adjustCanvasSizeByOption()}renderWithRecreateCells(){this.internalProps.stick.changedCells.clear();let t={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(t.col,t.row),this.render()}getFrozenRowsHeight(){return this.getRowsHeight(0,this.frozenRowCount-1)}getFrozenColsWidth(){return this.getColsWidth(0,this.frozenColCount-1)}getBottomFrozenRowsHeight(){if(this.bottomFrozenRowCount>0){let t=0;for(let e=this.rowCount-this.bottomFrozenRowCount;e<=this.rowCount-1;e++)t+=this.getRowHeight(e);return t}return 0}getRightFrozenColsWidth(){if(this.rightFrozenColCount>0){let t=0;for(let e=this.colCount-this.rightFrozenColCount;e<=this.colCount-1;e++)t+=this.getColWidth(e);return t}return 0}getDrawRange(){var t,e;let i=(null==(t=this.containerFit)?void 0:t.width)?this.tableNoFrameWidth:Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),r=(null==(e=this.containerFit)?void 0:e.height)?this.tableNoFrameHeight:Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());return new F.U(this.tableX,this.tableY,i,r)}_getMouseAbstractPoint(t){var e,i,r,n,l,s,a,o;let h;if(!t)return{inTable:!1,x:void 0,y:void 0};let d=(h=r1(t)?t.changedTouches[0]:t).clientX||h.pageX+window.scrollX,u=h.clientY||h.pageY+window.scrollY,c=this.internalProps.canvas.getBoundingClientRect(),p=!0;c.right<=d&&(p=!1),c.bottom<=u&&(p=!1);let g=c.width,f=g/((90===this.rotateDegree?this.canvas.offsetHeight:this.canvas.offsetWidth)||g),m=c.height,y=m/((90===this.rotateDegree?this.canvas.offsetWidth:this.canvas.offsetHeight)||m),v=this.pluginManager.getPluginByName("Rotate Table");if(v&&90===this.rotateDegree){let t={x:d/f-(null!=(i=null==(e=this.options.viewBox)?void 0:e.x1)?i:0),y:u/y-(null!=(n=null==(r=this.options.viewBox)?void 0:r.y1)?n:0),inTable:p};return v.matrix.transformPoint(t,t),t}let b={x:(d-c.left)/f-(null!=(s=null==(l=this.options.viewBox)?void 0:l.x1)?s:0),y:(u-c.top)/y-(null!=(o=null==(a=this.options.viewBox)?void 0:a.y1)?o:0),inTable:p};return this.internalProps.modifiedViewBoxTransform&&this.scenegraph.stage.window.getViewBoxTransform()&&this.scenegraph.stage.window.getViewBoxTransform().transformPoint(b,b),b}getTheme(){return this.internalProps.theme}getTargetColAt(t){return rO(t,this)}getTargetRowAt(t){let e=rH(t,this);return e&&(e.row=Math.min(e.row,this.rowCount-1)),e}getTargetColAtConsiderRightFrozen(t,e){return rD(t,e,this)}getTargetRowAtConsiderBottomFrozen(t,e){return rz(t,e,this)}clearSelected(){this.stateManager.updateSelectPos(-1,-1)}selectCell(t,e,i,r,n,l=!1){var s,a,o;let h=!!(null==(s=this.stateManager.select.ranges)?void 0:s.length);this.stateManager.updateSelectPos(t,e,i,r,!1,null==(o=null!=n?n:null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||o,l),this.stateManager.endSelectCells(!0,h)}selectCells(t){let{scrollLeft:e,scrollTop:i}=this;t.forEach((t,e)=>{var i,r,n,l,s,a;let o=t.start.row,h=t.start.col,d=t.end.row,u=t.end.col;h===u&&o===d?this.stateManager.updateSelectPos(h,o,!1,e>=1,!1,null==(r=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||r,!0):(this.stateManager.updateSelectPos(h,o,!1,e>=1,!1,null==(l=null==(n=this.options.select)?void 0:n.makeSelectCellVisible)||l,!0),this.stateManager.updateInteractionState(P.F.grabing),this.stateManager.updateSelectPos(u,d,!1,e>=1,!1,null==(a=null==(s=this.options.select)?void 0:s.makeSelectCellVisible)||a,!0)),this.stateManager.endSelectCells(!1,!1),this.stateManager.updateInteractionState(P.F.default)}),this.setScrollTop(i),this.setScrollLeft(e)}selectRow(t,e,i){let r=this.stateManager.select.ranges;if(e)r.push({start:{col:0,row:t},end:{col:this.colCount-1,row:t}}),this.selectCells(r);else if(i){let e=r[r.length-1];e&&(e.end.row=t),this.selectCells(r)}else this.selectCells([{start:{col:0,row:t},end:{col:this.colCount-1,row:t}}])}selectCol(t,e,i){let r=this.stateManager.select.ranges;if(e)r.push({start:{col:t,row:0},end:{col:t,row:this.rowCount-1}}),this.selectCells(r);else if(i){let e=r[r.length-1];e&&(e.end.col=t),this.selectCells(r)}else this.selectCells([{start:{col:t,row:0},end:{col:t,row:this.rowCount-1}}])}startDragSelectCol(t,e,i){var r,n,l,s,a,o;let h=this.stateManager.select.ranges[this.stateManager.select.ranges.length-1],d=i&&(null==(r=null==h?void 0:h.start)?void 0:r.col)?null==(n=null==h?void 0:h.start)?void 0:n.col:t,u=this.rowCount-1;this.stateManager.updateSelectPos(d,0,i,e,!1,null==(s=null==(l=this.options.select)?void 0:l.makeSelectCellVisible)||s,!0),this.stateManager.updateInteractionState(P.F.grabing),this.stateManager.updateSelectPos(t,u,i,e,!1,null==(o=null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||o,!0)}dragSelectCol(t,e){var i,r;let n=this.stateManager.select.ranges,l=n[n.length-1];l&&(l.end.col=t),this.stateManager.updateSelectPos(t,this.rowCount-1,!1,e,!1,null==(r=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||r,!0)}endDragSelect(){this.stateManager.updateInteractionState(P.F.default),this.stateManager.endSelectCells(!1,!1)}startDragSelectRow(t,e,i){var r,n,l,s,a,o;let h=this.stateManager.select.ranges[this.stateManager.select.ranges.length-1],d=i&&(null==(r=null==h?void 0:h.start)?void 0:r.row)?null==(n=null==h?void 0:h.start)?void 0:n.row:t,u=this.colCount-1;this.stateManager.updateSelectPos(0,d,i,e,!1,null==(s=null==(l=this.options.select)?void 0:l.makeSelectCellVisible)||s,!0),this.stateManager.updateInteractionState(P.F.grabing),this.stateManager.updateSelectPos(u,t,i,e,!1,null==(o=null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||o,!0)}dragSelectRow(t,e){var i,r;let n=this.stateManager.select.ranges,l=n[n.length-1];l&&(l.end.row=t),this.stateManager.updateSelectPos(this.colCount-1,t,!1,e,!1,null==(r=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||r,!0)}get recordsCount(){var t;return null==(t=this.records)?void 0:t.length}get allowFrozenColCount(){return this.internalProps.allowFrozenColCount}get rowHeaderLevelCount(){return this.internalProps.layoutMap.rowHeaderLevelCount}get columnHeaderLevelCount(){return this.internalProps.layoutMap.columnHeaderLevelCount}get records(){return this.internalProps.records}get dataSource(){return this.internalProps.dataSource}set dataSource(t){this.scenegraph.clearCells(),(0,V.x6)(this,t),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()}get autoWrapText(){return this.internalProps.autoWrapText}set autoWrapText(t){this.internalProps.autoWrapText=t,this.options.autoWrapText=t}get enableLineBreak(){return this.internalProps.enableLineBreak}set enableLineBreak(t){this.internalProps.enableLineBreak=t,this.options.enableLineBreak=t}updateAutoWrapText(t){this.internalProps.autoWrapText!==t&&(this.internalProps.autoWrapText=t,this.options.autoWrapText=t,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.render())}get theme(){return this.internalProps.theme}set theme(t){this.internalProps.theme=H.default.of(null!=t?t:H.default.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),this.options.theme=t,(0,tb.E6)(this.internalProps.theme.functionalIconsStyle)}updateTheme(t){let e={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.theme=H.default.of(null!=t?t:H.default.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),(0,tb.E6)(this.internalProps.theme.functionalIconsStyle),this.options.theme=t,this.scenegraph.updateComponent(),this.scenegraph.updateStageBackground(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(e.col,e.row),this.render()}getBodyField(t,e){return this.internalProps.layoutMap.getBody(t,e).field}getBodyColumnDefine(t,e){let i=this.internalProps.layoutMap.getBody(t,e);return null==i?void 0:i.define}getBodyColumnType(t,e){var i,r;let n=null!=(r=null==(i=this.internalProps.layoutMap.getBody(t,e))?void 0:i.cellType)?r:"text";return(0,Y.WJ)("cellType",{cellType:n},t,e,this)}getCellType(t,e){let i;return this.isSeriesNumberInHeader(t,e)?this.internalProps.layoutMap.getSeriesNumberHeader(t,e).cellType:(i=this.isHeader(t,e)?this.internalProps.layoutMap.getHeader(t,e).headerType:this.internalProps.layoutMap.getBody(t,e).cellType,(0,Y.WJ)("cellType",{cellType:i},t,e,this))}getHeaderField(t,e){return this.internalProps.layoutMap.getHeaderField(t,e)}getHeaderDefine(t,e){let i=this.internalProps.layoutMap.getHeader(t,e);return null==i?void 0:i.define}getCellLocation(t,e){return this.internalProps.layoutMap.getCellLocation(t,e)}getCellHeaderPaths(t,e){return this.internalProps.layoutMap.getCellHeaderPaths(t,e)}getHeadersDefine(t,e){let i=[];for(;;){let r=this.getHeaderDefine(t,e);if(!r||!r.field&&!r.columns)break;i.push(r),e++}return i}_getHeaderLayoutMap(t,e){return this.internalProps.layoutMap.getHeader(t,e)}_getBodyLayoutMap(t,e){return this.internalProps.layoutMap.getBody(t,e)}getContext(){return this.internalProps.context}getRecordByCell(t,e){if(!this.internalProps.layoutMap.isHeader(t,e))return this.getCellOriginRecord(t,e)}getRecordByRowCol(t,e){return this.getRecordByCell(t,e)}getRecordStartRowByRecordIndex(t){return this.internalProps.layoutMap.getRecordStartRowByRecordIndex(t)}_getHeaderCellBySortState(t){let{layoutMap:e}=this.internalProps,i=e.headerObjects.find(e=>e&&e.field===t.field);if(i)return e.getHeaderCellAdressById(i.id)}getCellRange(t,e){var i;if(this.internalProps.customMergeCell){let i=this.internalProps.customMergeCell(t,e,this);if(i&&i.range&&((0,y.Z)(i.text)||i.customLayout||i.customRender))return{start:{col:Math.max(i.range.start.col,0),row:Math.max(i.range.start.row,0)},end:{col:Math.min(i.range.end.col,this.colCount-1),row:Math.min(i.range.end.row,this.rowCount-1)},isCustom:!0}}return null==(i=this.internalProps.layoutMap)?void 0:i.getCellRange(t,e)}hasCustomMerge(){return!!this.internalProps.customMergeCell}getCustomMerge(t,e){if(this.internalProps.customMergeCell){let i=this.internalProps.customMergeCell(t,e,this);if(i&&i.range&&((0,y.Z)(i.text)||i.customLayout||this.customRender)){if(i.style){let r=this.internalProps.bodyHelper.getStyleClass("text"),n=M(i.style,this.theme.bodyStyle,{col:t,row:e,table:this,value:i.text,dataValue:this.getCellOriginValue(t,e),cellHeaderPaths:this.getCellHeaderPaths(t,e)},r,this.options.autoWrapText,this.theme);i.style=n}return i.range={start:{col:Math.max(i.range.start.col,0),row:Math.max(i.range.start.row,0)},end:{col:Math.min(i.range.end.col,this.colCount-1),row:Math.min(i.range.end.row,this.rowCount-1)},isCustom:!0},i}}}isCellRangeEqual(t,e,i,r){return this.internalProps.layoutMap.isCellRangeEqual(t,e,i,r)}_getLayoutCellId(t,e){return this.internalProps.layoutMap.getCellId(t,e)}getHeaderDescription(t,e){var i;let r=this._getHeaderLayoutMap(t,e),n=null==r?void 0:r.define,l=null!=(i=null==n?void 0:n.description)?i:null==r?void 0:r.description;return"function"==typeof l?l({col:t,row:e,value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e)}):l}setDropDownMenuHighlight(t){this.stateManager.setDropDownMenuHighlight(t)}_dropDownMenuIsHighlight(t,e,i){return this.stateManager.dropDownMenuIsHighlight(t,e,i)}isSeriesNumberInBody(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInBody(t,e)}isSeriesNumberInHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)}isHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isHeader(t,e)}isColumnHeader(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isColumnHeader(t,e)}isRowHeader(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isRowHeader(t,e)}isCornerHeader(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isCornerHeader(t,e)}isFrozenColumn(t,e){return this.isLeftFrozenColumn(t,e)||this.isRightFrozenColumn(t,e)}isLeftFrozenColumn(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isFrozenColumn(t,e)}isRightFrozenColumn(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isRightFrozenColumn(t,e)}isFrozenRow(t,e){return this.isTopFrozenRow(t,e)||this.isBottomFrozenRow(t,e)}isTopFrozenRow(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isFrozenRow(t,e)}isBottomFrozenRow(t,e){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isBottomFrozenRow(t,e)}getCellInfo(t,e){if(t>=0&&e>=0){let i=this.isHeader(t,e)?this.getHeaderDefine(t,e):this.getBodyColumnDefine(t,e);return{col:t,row:e,field:this.getHeaderField(t,e),cellHeaderPaths:this.internalProps.layoutMap.getCellHeaderPaths(t,e),title:null==i?void 0:i.title,cellType:this.getCellType(t,e),originData:this.getCellOriginRecord(t,e),cellRange:this.getCellRangeRelativeRect({col:t,row:e}),value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e),cellLocation:this.getCellLocation(t,e),scaleRatio:this.canvas.getBoundingClientRect().width/this.canvas.offsetWidth}}}_hasField(t,e,i){var r;if(null===t||this.internalProps.layoutMap.isHeader(e,i))return!1;let n=this.getRecordShowIndexByCell(e,i);return null==(r=this.internalProps.dataSource)?void 0:r.hasField(n,t)}_getCellStyle(t,e){return function(t,e,i){var r,n,l,s,a,o,h,d,u,c;let p,g,f,m=null==(r=i.customCellStylePlugin)?void 0:r.getCustomCellStyle(t,e),{layoutMap:y}=i.internalProps;if(y.isHeader(t,e)){let r,o;if(!i.isPivotTable()||i.isBottomFrozenRow(e)||i.isRightFrozenColumn(t))r=`${t}-${e}`;else{let n=i.getHeaderDefine(t,e),l=i.isCornerHeader(t,e);r=(null==n?void 0:n.dimensionKey)?l?`dim-cor-${n.dimensionKey}`:`dim-${n.dimensionKey}`:(null==n?void 0:n.indicatorKey)?`ind-${n.indicatorKey}`:`${t}-${e}`}let h=i.headerStyleCache.get(r);if(h)return m?(0,rN.wh)(h,m):h;let d=y.getHeader(t,e);if(i.isPivotChart()&&(0,rW.Vp)(t,e,y)&&y.isAxisCell(t,e)?o=null!=(l=null==(n=y.getBody(t,i.rowHeaderLevelCount).style)?void 0:n.padding)?l:i.theme.bodyStyle.padding:i.isPivotChart()&&(0,rW.iN)(t,e,y)&&y.isAxisCell(t,e)&&(o=null!=(a=null==(s=y.getBody(i.columnHeaderLevelCount,e).style)?void 0:s.padding)?a:i.theme.bodyStyle.padding),(!d||d.isEmpty)&&(y.isLeftBottomCorner(t,e)||y.isRightBottomCorner(t,e)||y.isCornerHeader(t,e)||y.isRightTopCorner(t,e)))return rj;let u=i.internalProps.headerHelper.getStyleClass((null==d?void 0:d.headerType)||"text");if(y.isBottomFrozenRow(t,e)&&i.theme.bottomFrozenStyle)h=rZ(o?{padding:o}:{},i.theme.bottomFrozenStyle,{col:t,row:e,table:i,value:i.getCellValue(t,e),dataValue:i.getCellOriginValue(t,e),cellHeaderPaths:i.getCellHeaderPaths(t,e)},u,i.options.autoWrapText,i.theme);else if(y.isRightFrozenColumn(t,e)&&i.theme.rightFrozenStyle)h=rZ(o?{padding:o}:{},i.theme.rightFrozenStyle,{col:t,row:e,table:i,value:i.getCellValue(t,e),dataValue:i.getCellOriginValue(t,e),cellHeaderPaths:i.getCellHeaderPaths(t,e)},u,i.options.autoWrapText,i.theme);else{let r=(null==d?void 0:d.style)||{};o&&(r.padding=o),h=rZ(r,y.isColumnHeader(t,e)||y.isBottomFrozenRow(t,e)?i.theme.headerStyle:y.isRowHeader(t,e)||y.isRightFrozenColumn(t,e)?i.theme.rowHeaderStyle:i.theme.cornerHeaderStyle,{col:t,row:e,table:i,value:i.getCellValue(t,e),dataValue:i.getCellOriginValue(t,e),cellHeaderPaths:i.getCellHeaderPaths(t,e)},u,i.options.autoWrapText,i.theme)}return i.headerStyleCache.set(r,h),m?(0,rN.wh)(h,m):h}(null==(h=null==(o=i.internalProps)?void 0:o.dataConfig)?void 0:h.mappingRules)&&!i.isHeader(t,e)&&(null==(c=null==(u=null==(d=i.internalProps)?void 0:d.dataConfig)?void 0:u.mappingRules)||c.forEach((r,n)=>{r.bgColor&&i.internalProps.layoutMap.getIndicatorKey(t,e)===r.bgColor.indicatorKey&&(p=r.bgColor.mapping)}));let v=i.getCellType(t,e),b=i.getCellOriginRecord(t,e);if(g=(null==b?void 0:b.vtableMerge)?"merge-title":i.isSeriesNumberInBody(t,e)?`${t}-series-`+v:i.isListTable()&&!i.transpose||i.isPivotTable()&&i.internalProps.layoutMap.indicatorsAsCol?t+v:e+v,f=(null==b?void 0:b.vtableMerge)?i.bodyMergeTitleCache.get(g):y.isBottomFrozenRow(e)?i.bodyBottomStyleCache.get(g):i.bodyStyleCache.get(g))return m?(0,rN.wh)(f,m):f;let _=y.getBody(t,e),C=i.internalProps.bodyHelper.getStyleClass(i.getCellType(t,e)),x=null==_?void 0:_.style;return f=M(x,(null==b?void 0:b.vtableMerge)&&i.theme.groupTitleStyle?i.theme.groupTitleStyle:y.isBottomFrozenRow(e)&&i.theme.bottomFrozenStyle?i.theme.bottomFrozenStyle:y.isRightFrozenColumn(t)&&i.theme.rightFrozenStyle?i.theme.rightFrozenStyle:i.theme.bodyStyle,{col:t,row:e,table:i,value:i.getCellValue(t,e),dataValue:i.getCellOriginValue(t,e),cellHeaderPaths:i.getCellHeaderPaths(t,e)},C,i.options.autoWrapText,i.theme),p&&(f=(0,rN.wh)(f,{bgColor:p})),(0,iQ.Z)(x)||(y.isBottomFrozenRow(e)?i.bodyBottomStyleCache.set(g,f):i.bodyStyleCache.set(g,f)),m?(0,rN.wh)(f,m):f}(t,e,this)}clearCellStyleCache(){this.headerStyleCache.clear(),this.bodyStyleCache.clear(),this.bodyMergeTitleCache.clear(),this.bodyBottomStyleCache.clear()}clearRowHeightCache(){this.internalProps._rowHeightsMap.clear(),this._clearRowRangeHeightsMap()}clearColWidthCache(){this.internalProps._colWidthsMap.clear(),this._clearColRangeWidthsMap()}_canResizeColumn(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t+1,e)||"none"===this.internalProps.columnResizeMode)return!1;if("header"===this.internalProps.columnResizeMode){if(!this.isHeader(t,e))return!1}else if("body"===this.internalProps.columnResizeMode&&this.isHeader(t,e))return!1;let i=this.colWidthsLimit[t];return!(i&&i.min&&i.max)||i.max!==i.min}_canResizeRow(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t,e+1)||"none"===this.internalProps.rowResizeMode)return!1;if("header"===this.internalProps.rowResizeMode){if(!this.isHeader(t,e))return!1}else if("body"===this.internalProps.rowResizeMode&&this.isHeader(t,e))return!1;return!0}_canDragHeaderPosition(t,e){var i;if(this.isHeader(t,e)&&(this.stateManager.isSelected(t,e)||"body"===(null==(i=this.options.select)?void 0:i.headerSelectMode)&&function(t,e,i){for(let r=0;r<i.length;r++){let n=i[r];if((0,B._Z)(n,t,e))return!0}return!1}(t,e,[this.getCellRange(this.stateManager.select.cellPos.col,this.stateManager.select.cellPos.row)])||t1(this,t,e))){if("disabled"===this.internalProps.frozenColDragHeaderMode&&this.isFrozenColumn(t))return!1;if(this.stateManager.isSelected(t,e)){let i=this.stateManager.select.ranges[0];if(this.isColumnHeader(t,e)){if(i.end.row!==this.rowCount-1)return!1}else if(!this.isRowHeader(t,e)||i.end.col!==this.colCount-1)return!1}let i=this.getHeaderDefine(t,e);if(!i)return!1;if(void 0===i.dragHeader){if("all"===this.internalProps.dragHeaderMode)return!0;if("column"===this.internalProps.dragHeaderMode){if(this.isColumnHeader(t,e))return!0}else if("row"===this.internalProps.dragHeaderMode&&this.isRowHeader(t,e))return!0;return!1}return i.dragHeader}return!1}getCellIcons(t,e){var i,r,n;let l;if(this.isHeader(t,e))l=this.internalProps.headerHelper.getIcons(t,e);else if(this.internalProps.layoutMap.isSeriesNumber(t,e)){this.internalProps.groupBy&&(null==(i=this.getCellRawRecord(t,e))?void 0:i.vtableMerge)||null==(n=null==(r=this.internalProps.layoutMap.getSeriesNumberBody(t,e))?void 0:r.define)||!n.dragOrder||(l=this.internalProps.rowSeriesNumberHelper.getIcons(t,e));let s=this.getCellValue(t,e),a=this.getCellOriginValue(t,e),o=this.internalProps.context,h=this.internalProps.bodyHelper.getIcons(t,e,s,a,o);(null==l?void 0:l.length)>0?l=l.concat(h):(null==h?void 0:h.length)>0&&(l=h)}else{let i=this.getCellValue(t,e),r=this.getCellOriginValue(t,e),n=this.internalProps.context;l=this.internalProps.bodyHelper.getIcons(t,e,i,r,n)}return l}showDropDownMenu(t,e,i){let r="dropdown-menu";i&&(r=Array.isArray(i.content)?"dropdown-menu":"container"),"html"===this.internalProps.menu.renderMode&&(this.stateManager.menu.isShow=!0,this.internalProps.menuHandler._bindToCell(t,e,r,i))}showTooltip(t,e,i){"html"===this.internalProps.tooltip.renderMode&&this.internalProps.tooltipHandler._bindToCell(t,e,i)}getCellStyle(t,e){let i=this._getCellStyle(t,e),r=(0,V.RT)(i,this,t,e,Y.WJ).theme,{autoWrapText:n,lineClamp:l,textOverflow:s}=i;return{textAlign:r.text.textAlign,textBaseline:r.text.textBaseline,bgColor:(0,rM.Z)(r.group.fill)?(0,Y.WJ)("bgColor",i,t,e,this):r.group.fill,color:(0,rM.Z)(r.text.fill)?(0,Y.WJ)("color",i,t,e,this):r.text.fill,strokeColor:(0,rM.Z)(r.text.stroke)?(0,Y.WJ)("strokeColor",i,t,e,this):r.text.stroke,fontFamily:r.text.fontFamily,fontSize:r.text.fontSize,fontWeight:r.text.fontWeight,fontVariant:r.text.fontVariant,fontStyle:r.text.fontStyle,lineHeight:r.text.lineHeight,autoWrapText:null!=n&&n,lineClamp:null!=l?l:"auto",textOverflow:s,borderColor:(0,rM.Z)(r.group.stroke)?(0,Y.WJ)("borderColor",i,t,e,this):r.group.stroke,borderLineWidth:r.group.lineWidth,borderLineDash:r.group.lineDash,underline:!!r.text.underline,underlineDash:r.text.underlineDash,underlineOffset:r.text.underlineOffset,lineThrough:!!r.text.lineThrough,padding:r._vtable.padding,underlineWidth:r.text.underline,lineThroughLineWidth:r.text.lineThrough,_strokeArrayWidth:r.group.strokeArrayWidth,_strokeArrayColor:r.group.strokeArrayColor,_linkColor:(0,Y.WJ)("linkColor",i,t,e,this)}}getAllBodyCells(t,e){let i=this.rowHeaderLevelCount,r=this.columnHeaderLevelCount,n=this.colCount-1;return Array(Math.min(null!=e?e:2e3,this.rowCount-1-r+1,this.rowCount)).fill(0).map((e,l)=>Array(Math.min(null!=t?t:2e3,n-i+1,this.colCount)).fill(0).map((t,e)=>this.getCellInfo(e+i,l+r)))}getAllCells(t,e){let i=this.colCount-1;return Array(Math.min(null!=e?e:2e3,this.rowCount-1-0+1,this.rowCount)).fill(0).map((e,r)=>Array(Math.min(null!=t?t:2e3,i-0+1,this.colCount)).fill(0).map((t,e)=>this.getCellInfo(e+0,r+0)))}getAllColumnHeaderCells(){let t=this.rowHeaderLevelCount,e=this.colCount-1;return Array(this.columnHeaderLevelCount-1-0+1).fill(0).map((i,r)=>Array(e-t+1).fill(0).map((e,i)=>this.getCellInfo(i+t,r+0)))}getAllRowHeaderCells(){let t=this.columnHeaderLevelCount,e=this.rowHeaderLevelCount-1;return Array(this.rowCount-1-t+1).fill(0).map((i,r)=>Array(e-0+1).fill(0).map((e,i)=>this.getCellInfo(i+0,r+t)))}getCopyValue(t){var e,i,r;if((null==(i=null==(e=this.stateManager.select)?void 0:e.ranges)?void 0:i.length)>0){let e=this.stateManager.select.ranges,i=Math.min(e[0].start.col,e[0].end.col),n=Math.max(e[0].start.col,e[0].end.col),l=Math.min(e[0].start.row,e[0].end.row),s=Math.max(e[0].start.row,e[0].end.row);e.forEach(t=>{i=Math.min(i,t.start.col,t.end.col),n=Math.max(n,t.start.col,t.end.col),l=Math.min(l,t.start.row,t.end.row),s=Math.max(s,t.start.row,t.end.row)});let a=t=>{let i=!1;return e.forEach(e=>{let r=Math.min(e.start.row,e.end.row),n=Math.max(e.start.row,e.end.row);r<=t&&n>=t&&(i=!0)}),i},o=t=>{let i=!1;return e.forEach(e=>{let r=Math.min(e.start.col,e.end.col),n=Math.max(e.start.col,e.end.col);r<=t&&n>=t&&(i=!0)}),i},h=(t,i)=>{let r;return e.forEach(e=>{let n=Math.min(e.start.row,e.end.row),l=Math.max(e.start.row,e.end.row),s=Math.min(e.start.col,e.end.col),a=Math.max(e.start.col,e.end.col);s<=t&&a>=t&&n<=i&&l>=i&&(r=e)}),r},d=(e,i,r)=>{let n=this.getCellRange(e,i),l=n.start.col,s=n.start.row;if(r){let t=Math.min(r.start.col,r.end.col),e=Math.min(r.start.row,r.end.row);l=Math.max(t,n.start.col),s=Math.max(e,n.start.row)}return l!==e||s!==i?"":t?t(e,i):this.getCellValue(e,i)},u="";for(let t=l;t<=s;t++)if(a(t)){for(let e=i;e<=n;e++)if(o(e)){let i=h(e,t);if(i){let r=d(e,t,i);if("undefined"!=typeof Promise&&r instanceof Promise);else{let t=(0,y.Z)(r)?`${r}`:"";/^\[object .*\]$/.exec(t)||(u+=t)}(e<i.end.col||e<n)&&(u+="	")}else u+="	"}t<s&&(u+="\r\n")}return(null==(r=this.options)?void 0:r.formatCopyValue)&&(u=this.options.formatCopyValue(u)),u}return""}getSelectedCellInfos(){var t;if(!(null==(t=this.stateManager.select)?void 0:t.ranges))return null;let e=this.stateManager.select.ranges;if(!e.length)return[];let i=Math.min(e[0].start.col,e[0].end.col),r=Math.max(e[0].start.col,e[0].end.col),n=Math.min(e[0].start.row,e[0].end.row),l=Math.max(e[0].start.row,e[0].end.row);e.forEach(t=>{i=Math.min(i,t.start.col,t.end.col),r=Math.max(r,t.start.col,t.end.col),n=Math.min(n,t.start.row,t.end.row),l=Math.max(l,t.start.row,t.end.row)});let s=t=>{let i=!1;return e.forEach(e=>{let r=Math.min(e.start.row,e.end.row),n=Math.max(e.start.row,e.end.row);r<=t&&n>=t&&(i=!0)}),i},a=t=>{let i=!1;return e.forEach(e=>{let r=Math.min(e.start.col,e.end.col),n=Math.max(e.start.col,e.end.col);r<=t&&n>=t&&(i=!0)}),i},o=(t,i)=>{let r;return e.forEach(e=>{let n=Math.min(e.start.row,e.end.row),l=Math.max(e.start.row,e.end.row),s=Math.min(e.start.col,e.end.col),a=Math.max(e.start.col,e.end.col);s<=t&&a>=t&&n<=i&&l>=i&&(r=e)}),r},h=[];for(let t=n;t<=l;t++)if(s(t)){let e=[];for(let n=i;n<=r;n++)if(a(n)&&o(n,t)){let i=this.getCellInfo(n,t);e.push(i)}h.push(e)}return h}getSelectedCellRanges(){let t=this.stateManager.select.ranges;return t.length?(0,rT.Z)(t):[]}measureText(t,e){return ev.QC.measureText(t,e)}measureTextBounds(t){return(0,ev.Rc)(t)}getCustomRender(t,e){let i;if("body"!==this.getCellLocation(t,e)){let r=this.getHeaderDefine(t,e);i=null==r?void 0:r.headerCustomRender}else{let r=this.getBodyColumnDefine(t,e);i=(null==r?void 0:r.customRender)||this.customRender}return i}getCustomLayout(t,e){let i;if("body"!==this.getCellLocation(t,e)){let r=this.getHeaderDefine(t,e);i=null==r?void 0:r.headerCustomLayout}else{let r=this.getBodyColumnDefine(t,e);i=null==r?void 0:r.customLayout}return i}hasAutoImageColumn(){return void 0===this._hasAutoImageColumn&&(this._hasAutoImageColumn=(0,rE.N3)(this)),this._hasAutoImageColumn}_getActiveChartInstance(){var t,e,i,r,n,l;let s=this.scenegraph.getCell(null==(e=null==(t=this.stateManager.hover)?void 0:t.cellPos)?void 0:e.col,null==(r=null==(i=this.stateManager.hover)?void 0:i.cellPos)?void 0:r.row);return"chart"===(null==(l=null==(n=null==s?void 0:s.getChildren())?void 0:n[0])?void 0:l.type)?s.getChildren()[0].activeChartInstance:null}cellIsInVisualView(t,e){var i,r,n,l;let s,a,o,h,d=this.getDrawRange(),u=this.getCellRelativeRect(t,e);return!!(t<this.frozenColCount&&e<this.frozenRowCount||(this.frozenRowCount>=1&&(s=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}})),this.frozenColCount>=1&&(a=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.frozenColCount-1,row:this.rowCount-1}})),this.bottomFrozenRowCount>=1&&(o=this.getCellRangeRelativeRect({start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}})),this.rightFrozenColCount>=1&&(h=this.getCellRangeRelativeRect({start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.rowCount-1}})),u.top>=d.top&&u.bottom<=d.bottom&&u.left>=d.left&&u.right<=d.right&&(this.isFrozenCell(t,e)||u.top>=(null!=(i=null==s?void 0:s.bottom)?i:u.top)&&u.left>=(null!=(r=null==a?void 0:a.right)?r:u.left)&&u.bottom<=(null!=(n=null==o?void 0:o.top)?n:u.bottom)&&u.right<=(null!=(l=null==h?void 0:h.left)?l:u.right))))||!1}getCustomMergeValue(t,e){if(this.internalProps.customMergeCell){let i=this.getCustomMerge(t,e);if(i){let{text:t}=i;return t}}}exportImg(){return this.scenegraph.stage.toCanvas().toDataURL()}exportCellImg(t,e,i){var r,n,l,s;let a,o,h=this.cellIsInVisualView(t,e),{scrollTop:d,scrollLeft:u}=this;h||this.scrollToCell({col:t,row:e});let c=this.getCellRelativeRect(t,e);(null==(n=null==(r=this.stateManager.select)?void 0:r.ranges)?void 0:n.length)>0&&e6(this.scenegraph);let{col:p,row:g}=this.stateManager.hover.cellPos;if(this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.tableGroup.border.setAttribute("visible",!1),null==i?void 0:i.disableBackground){let i=this.scenegraph.getCell(t,e);a=i.attribute.fill,i.setAttribute("fill","transparent")}if(null==i?void 0:i.disableBorder){let i=this.scenegraph.getCell(t,e);o=i.attribute.stroke,i.setAttribute("stroke",!1)}this.scenegraph.renderSceneGraph();let f=0;"bottom-right"===this.theme.cellBorderClipDirection&&(f=1);let m=this.scenegraph.stage.toCanvas(!1,(new iW.FB).set(c.left+this.tableX+1,c.top+this.tableY+1,c.right+this.tableX-f,c.bottom+this.tableY-f));return h||(this.setScrollTop(d),this.setScrollLeft(u)),this.scenegraph.tableGroup.border.setAttribute("visible",!0),a&&this.scenegraph.getCell(t,e).setAttribute("fill",a),o&&this.scenegraph.getCell(t,e).setAttribute("stroke",o),(null==(s=null==(l=this.stateManager.select)?void 0:l.ranges)?void 0:s.length)>0&&e7(this.scenegraph),this.stateManager.updateHoverPos(p,g),this.scenegraph.updateNextFrame(),m.toDataURL()}exportCellRangeImg(t){var e,i,r,n;let{scrollTop:l,scrollLeft:s}=this,a=Math.min(t.start.col,t.end.col),o=Math.min(t.start.row,t.end.row),h=Math.max(t.start.col,t.end.col),d=Math.max(t.start.row,t.end.row),u=this.cellIsInVisualView(a,o),c=this.cellIsInVisualView(h,d);u&&c||this.scrollToCell({col:a,row:o});let p=this.getCellRangeRelativeRect({start:{col:a,row:o},end:{col:h,row:d}});(null==(i=null==(e=this.stateManager.select)?void 0:e.ranges)?void 0:i.length)>0&&e6(this.scenegraph);let{col:g,row:f}=this.stateManager.hover.cellPos;this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.renderSceneGraph();let m=this.scenegraph.stage.toCanvas(!1,(new iW.FB).set(p.left+this.tableX+1,p.top+this.tableY+1,p.right+this.tableX,p.bottom+this.tableY)).toDataURL();return u&&c||(this.setScrollTop(l),this.setScrollLeft(s)),(null==(n=null==(r=this.stateManager.select)?void 0:r.ranges)?void 0:n.length)>0&&e7(this.scenegraph),this.stateManager.updateHoverPos(g,f),m}exportCanvas(){return this.scenegraph.stage.toCanvas()}getImageBuffer(t="image/png"){if("node"!==this.options.mode)return;this.render();let e=this.scenegraph.stage;if(e){let i=this.tableX+this.getAllColsWidth(),r=this.tableY+this.getAllRowsHeight();return(this.internalProps.legends&&this.internalProps.legends.forEach(t=>{"right"===t.orient?i=Math.max(i,t.legendComponent.globalAABBBounds.x2):"bottom"===t.orient&&(r=Math.max(r,t.legendComponent.globalAABBBounds.y2))}),this.internalProps.title&&("right"===this.internalProps.title._titleOption.orient?i=Math.max(i,this.internalProps.title.getComponentGraphic().globalAABBBounds.x2):"bottom"===this.internalProps.title._titleOption.orient&&(r=Math.max(r,this.internalProps.title.getComponentGraphic().globalAABBBounds.y2))),i>=this.canvasWidth&&r>=this.canvasHeight)?(e.render(),e.window.getImageBuffer(t)):this.scenegraph.stage.toCanvas(!1,(new iW.FB).set(0,0,Math.min(this.canvasWidth,i),Math.min(this.canvasHeight,r))).toBuffer(t)}return null}getBodyIndexByTableIndex(t,e){return{col:t-this.rowHeaderLevelCount-this.leftRowSeriesNumberCount,row:e-this.columnHeaderLevelCount}}getTableIndexByBodyIndex(t,e){return{col:t+this.rowHeaderLevelCount+this.leftRowSeriesNumberCount,row:e+this.columnHeaderLevelCount}}onVChartEvent(t,e,i){this._chartEventMap[t]||(this._chartEventMap[t]=[]),"function"==typeof e?this._chartEventMap[t].push({callback:e}):this._chartEventMap[t].push({callback:i,query:e})}offVChartEvent(t,e){this._chartEventMap[t]&&(this._chartEventMap[t]=e?this._chartEventMap[t].filter(t=>t.callback!==e):[])}_bindChartEvent(t){if(t)for(let e in this._chartEventMap)(this._chartEventMap[e]||[]).forEach(i=>{i.query?t.on(e,i.query,i.callback):t.on(e,i.callback)})}changeRecordOrder(t,e){}hasCustomCellStyle(t){var e;return null==(e=this.customCellStylePlugin)?void 0:e.hasCustomCellStyle(t)}registerCustomCellStyle(t,e){var i;null==(i=this.customCellStylePlugin)||i.registerCustomCellStyle(t,e)}arrangeCustomCellStyle(t,e,i){var r;null==(r=this.customCellStylePlugin)||r.arrangeCustomCellStyle(t,e,i)}isSeriesNumber(t,e){return this.internalProps.layoutMap.isSeriesNumber(t,e)}isHasSeriesNumber(){var t;return(null==(t=this.internalProps.layoutMap)?void 0:t.leftRowSeriesNumberColumnCount)>0}get leftRowSeriesNumberCount(){var t,e;return null!=(e=null==(t=this.internalProps.layoutMap)?void 0:t.leftRowSeriesNumberColumnCount)?e:0}setMinMaxLimitWidth(t=!1){var e,i;let r=this.internalProps;for(let n=0;n<r.layoutMap.columnWidths.length;n++){if(this.internalProps._widthResizedColMap.has(n))continue;let{width:l,minWidth:s,maxWidth:a}=null!=(i=null==(e=r.layoutMap.columnWidths)?void 0:e[n])?i:{};t&&l&&("string"==typeof l&&"auto"!==l||"number"==typeof l&&l>0)&&this._setColWidth(n,l),s&&("number"==typeof s&&s>0||"string"==typeof s)&&this.setMinColWidth(n,s),a&&("number"==typeof a&&a>0||"string"==typeof a)&&this.setMaxColWidth(n,a)}}setSortedIndexMap(t,e){var i;null==(i=this.dataSource)||i.setSortedIndexMap(t,e)}checkReactCustomLayout(){this.reactCustomLayout||(this.reactCustomLayout=new rI.Z(this))}get bodyDomContainer(){return this.internalProps.bodyDomContainer}get headerDomContainer(){return this.internalProps.headerDomContainer}get frozenBodyDomContainer(){return this.internalProps.frozenBodyDomContainer}get frozenHeaderDomContainer(){return this.internalProps.frozenHeaderDomContainer}get rightFrozenBodyDomContainer(){return this.internalProps.rightFrozenBodyDomContainer}get rightFrozenHeaderDomContainer(){return this.internalProps.rightFrozenHeaderDomContainer}get frozenBottomDomContainer(){return this.internalProps.frozenBottomDomContainer}get bottomDomContainer(){return this.internalProps.bottomDomContainer}get rightFrozenBottomDomContainer(){return this.internalProps.rightFrozenBottomDomContainer}showMoverLine(t,e){this.scenegraph.component.showMoveCol(t,e,0),this.scenegraph.renderSceneGraph()}hideMoverLine(t,e){this.scenegraph.component.hideMoveCol(),this.scenegraph.renderSceneGraph()}disableScroll(){this.eventManager.disableScroll()}enableScroll(){this.eventManager.enableScroll()}getGroupTitleLevel(t,e){}scrollToRow(t,e){e?this.animationManager.scrollTo({row:t},e):this.scrollToCell({row:t})}scrollToCol(t,e){e?this.animationManager.scrollTo({col:t},e):this.scrollToCell({col:t})}scrollToCell(t,e){if(e)return void this.animationManager.scrollTo(t,e);let i=this.getDrawRange();if((0,y.Z)(t.col)&&t.col>=this.frozenColCount){let e=this.getFrozenColsWidth(),r=this.getColsWidth(0,t.col-1);this.scrollLeft=Math.min(r-e,this.getAllColsWidth()-i.width)}if((0,y.Z)(t.row)&&t.row>=this.frozenRowCount){let e=this.getFrozenRowsHeight(),r=this.getRowsHeight(0,t.row-1);this.scrollTop=Math.min(r-e,this.getAllRowsHeight()-i.height)}this.render()}checkHasColumnAutoWidth(){return(0,V.MO)(this)}get containerFit(){return this._containerFit}set containerFit(t){var e,i;this._containerFit="boolean"==typeof t?{width:t,height:t}:t&&"object"==typeof t?{width:null==(e=t.width)||e,height:null==(i=t.height)||i}:{width:!1,height:!1}}isColumnSelected(t){let e=this.stateManager.select.ranges;for(let i=0;i<=e.length-1;i++){let r=e[i];if(r.start.col<=t&&r.end.col>=t&&0===r.start.row&&r.end.row===this.rowCount-1)return!0}return!1}isRowSelected(t){let e=this.stateManager.select.ranges;for(let i=0;i<=e.length-1;i++){let r=e[i];if(r.start.row<=t&&r.end.row>=t&&0===r.start.col&&r.end.col===this.colCount-1)return!0}return!1}}},67331:function(t,e,i){i.d(e,{B:()=>r});let r={CLICK_CELL:"click_cell",DBLCLICK_CELL:"dblclick_cell",MOUSEDOWN_CELL:"mousedown_cell",MOUSEUP_CELL:"mouseup_cell",SELECTED_CELL:"selected_cell",SELECTED_CLEAR:"selected_clear",BEFORE_KEYDOWN:"before_keydown",KEYDOWN:"keydown",MOUSEENTER_TABLE:"mouseenter_table",MOUSELEAVE_TABLE:"mouseleave_table",MOUSEDOWN_TABLE:"mousedown_table",MOUSEMOVE_TABLE:"mousemove_table",MOUSEMOVE_CELL:"mousemove_cell",MOUSEENTER_CELL:"mouseenter_cell",MOUSELEAVE_CELL:"mouseleave_cell",CONTEXTMENU_CELL:"contextmenu_cell",CONTEXTMENU_CANVAS:"contextmenu_canvas",RESIZE_COLUMN:"resize_column",RESIZE_COLUMN_END:"resize_column_end",RESIZE_ROW:"resize_row",RESIZE_ROW_END:"resize_row_end",CHANGE_HEADER_POSITION_START:"change_header_position_start",CHANGE_HEADER_POSITION:"change_header_position",CHANGING_HEADER_POSITION:"changing_header_position",CHANGE_HEADER_POSITION_FAIL:"change_header_position_fail",SORT_CLICK:"sort_click",AFTER_SORT:"after_sort",FREEZE_CLICK:"freeze_click",SCROLL:"scroll",CAN_SCROLL:"can_scroll",SCROLL_HORIZONTAL_END:"scroll_horizontal_end",SCROLL_VERTICAL_END:"scroll_vertical_end",DROPDOWN_MENU_CLICK:"dropdown_menu_click",MOUSEOVER_CHART_SYMBOL:"mouseover_chart_symbol",DRAG_SELECT_END:"drag_select_end",SELECTED_CHANGED:"selected_changed",COPY_DATA:"copy_data",DROPDOWN_ICON_CLICK:"dropdown_icon_click",DROPDOWN_MENU_CLEAR:"dropdown_menu_clear",TREE_HIERARCHY_STATE_CHANGE:"tree_hierarchy_state_change",SHOW_MENU:"show_menu",HIDE_MENU:"hide_menu",ICON_CLICK:"icon_click",LEGEND_ITEM_CLICK:"legend_item_click",LEGEND_ITEM_HOVER:"legend_item_hover",LEGEND_ITEM_UNHOVER:"legend_item_unHover",LEGEND_CHANGE:"legend_change",MOUSEENTER_AXIS:"mouseenter_axis",MOUSELEAVE_AXIS:"mouseleave_axis",CHECKBOX_STATE_CHANGE:"checkbox_state_change",RADIO_STATE_CHANGE:"radio_state_change",SWITCH_STATE_CHANGE:"switch_state_change",BEFORE_SET_SIZE:"before_set_size",BEFORE_INIT:"before_init",BEFORE_UPDATE_OPTION:"before_update_option",AFTER_RENDER:"after_render",INITIALIZED:"initialized",UPDATED:"updated",AFTER_UPDATE_CELL_CONTENT_WIDTH:"after_update_cell_content_width",AFTER_UPDATE_SELECT_BORDER_HEIGHT:"after_update_select_border_height",CHANGE_CELL_VALUE:"change_cell_value",DRAG_FILL_HANDLE_END:"drag_fill_handle_end",MOUSEDOWN_FILL_HANDLE:"mousedown_fill_handle",DBLCLICK_FILL_HANDLE:"dblclick_fill_handle",EMPTY_TIP_CLICK:"empty_tip_click",EMPTY_TIP_DBLCLICK:"empty_tip_dblclick",BUTTON_CLICK:"button_click",BEFORE_CACHE_CHART_IMAGE:"before_cache_chart_image",PASTED_DATA:"pasted_data",PLUGIN_EVENT:"plugin_event",ADD_RECORD:"add_record",DELETE_RECORD:"delete_record",UPDATE_RECORD:"update_record",ADD_COLUMN:"add_column",DELETE_COLUMN:"delete_column",FILTER_MENU_SHOW:"filter_menu_show",FILTER_MENU_HIDE:"filter_menu_hide"}},31877:function(t,e,i){i.d(e,{F:()=>r});class r{static registerComponent(t,e){r._components[t]=e}static getComponent(t){return r._components[t]}static registerFunction(t,e){r._functions[t]=e}static getFunction(t){return r._functions[t]}static registerCellType(t,e){r._cellTypes[t]=e}static getCellType(t){return r._cellTypes[t]}}r._components={},r._functions={},r._cellTypes={}},53172:function(t,e,i){i.d(e,{bW:()=>T,FJ:()=>A,x6:()=>y,sQ:()=>b,qf:()=>_,_I:()=>c,ke:()=>v,mP:()=>f,RT:()=>w,gX:()=>p,AS:()=>C,MO:()=>k,VN:()=>x,rQ:()=>M,xv:()=>S});var r=i(53681),n=i(77818),l=i(78596),s=i.n(l),a=i(74577),o=i(3099),h=i(70506),d=i(95723),u=i(64776);function c(t,e="vtable"){var i,r;let n=document.createElement("div");n.setAttribute("tabindex","0"),n.classList.add(e),n.style.outline="none",n.style.margin=`${t.top}px ${t.right}px ${t.bottom}px ${t.left}px`;let l=(n.offsetWidth||(null==(i=n.parentElement)?void 0:i.offsetWidth)||1)-1,s=(n.offsetHeight||(null==(r=n.parentElement)?void 0:r.offsetHeight)||1)-1;return n.style.width=l&&l-t.left-t.right+"px"||"0px",n.style.height=s&&s-t.top-t.bottom+"px"||"0px",n}function p(t,e){var i,r;t.style.margin=`${e.top}px ${e.right}px ${e.bottom}px ${e.left}px`;let n=(t.offsetWidth||(null==(i=t.parentElement)?void 0:i.offsetWidth)||1)-1,l=(t.offsetHeight||(null==(r=t.parentElement)?void 0:r.offsetHeight)||1)-1;t.style.width=n&&n-e.left-e.right+"px"||"0px",t.style.height=l&&l-e.top-e.bottom+"px"||"0px"}function g(t,e){let{dataSourceEventIds:i}=t.internalProps;i&&i.forEach(e=>t.internalProps.handler.off(e)),e(t),t.internalProps.dataSourceEventIds=[t.internalProps.handler.on(t.internalProps.dataSource,r.o2.EVENT_TYPE.CHANGE_ORDER,()=>{t.dataSource.hierarchyExpandLevel&&t.refreshRowColCount(),t.render()})]}function f(t,e=[]){g(t,()=>{var i;t.internalProps.records=e;let r=t.internalProps.layoutMap.rowHierarchyType;(0,d.Z)(null==(i=t.internalProps.dataConfig)?void 0:i.groupByRules)&&(r="tree"),t.pluginManager.getPluginByName("Master Detail Plugin")&&(r="grid");let l=t.internalProps.dataSource=n.Z.ofArray(e,t.internalProps.dataConfig,t.pagination,t.internalProps.columns,r,m(t));t.addReleaseObj(l)})}function m(t){var e;return t.options.hierarchyExpandLevel?t.options.hierarchyExpandLevel:t.internalProps.groupBy?1/0:(null==(e=t._hasHierarchyTreeHeader)?void 0:e.call(t))?1:void 0}function y(t,e){g(t,()=>{t.internalProps.dataSource&&t.internalProps.releaseList.forEach(e=>{e instanceof r.o2&&(e.release(),t.internalProps.releaseList.splice(t.internalProps.releaseList.indexOf(e),1))}),e?e instanceof r.o2?(t.internalProps.dataSource=e,t.internalProps.dataSource.supplementConfig(t.pagination,t.options.columns,t.internalProps.layoutMap.rowHierarchyType,m(t))):t.internalProps.dataSource=new n.Z(e):t.internalProps.dataSource=r.o2.EMPTY,t.addReleaseObj(t.internalProps.dataSource),t.internalProps.records=null})}function v(t,e){if(!t.internalProps.frozenRowCount)return null;let{scrollTop:i}=t,r=t.internalProps.frozenRowCount;for(let n=0;n<r;n++){let r=t.getRowHeight(n),l=i+r;if(l>e)return{top:i,row:n,bottom:l,height:r};i=l}return null}function b(t,e){if(!t.internalProps.frozenColCount)return null;let{scrollLeft:i}=t,r=t.internalProps.frozenColCount;for(let n=0;n<r;n++){let r=t.getColWidth(n),l=i+r;if(l>e)return{left:i,col:n,right:l,width:r};i=l}return null}function _(t,e){return Math.round(h.aR(e,t.internalProps.calcWidthContext))}function C(t,e){return t?t.min&&t.min>e?t.min:t.max&&t.max<e?t.max:e:e}function x(t){let e=0,i=0;t.frozenColCount>0&&(e=t.getFrozenColsWidth()),t.rightFrozenColCount>0&&(i=t.getRightFrozenColsWidth());let r=0,n=0;return t.frozenRowCount>0&&(r=t.getFrozenRowsHeight()),t.bottomFrozenRowCount>0&&(n=t.getBottomFrozenRowsHeight()),new o.U(t.scrollLeft+e,t.scrollTop+r,t.tableNoFrameWidth-e-i,t.tableNoFrameHeight-r-n)}function w(t,e,i,r,n,l=!0){let o,h,d,c,p,g=(0,a.u)(n("padding",t,i,r,e)),f=n("bgColor",t,i,r,e),m=n("font",t,i,r,e);if(m){let{family:t,size:e,weight:i,style:r,variant:n}=s()(m);o=t.join(" "),h=e,d=i,c=r,c=n}else o=n("fontFamily",t,i,r,e),h=n("fontSize",t,i,r,e),d=n("fontWeight",t,i,r,e),c=n("fontStyle",t,i,r,e),p=n("fontVariant",t,i,r,e);let y=n("textAlign",t,i,r,e),v=n("textBaseline",t,i,r,e),b=n("color",t,i,r,e),_=n("strokeColor",t,i,r,e),C=n("lineHeight",t,i,r,e),x=n("underline",t,i,r,e),S=n("underlineDash",t,i,r,e),A=n("underlineOffset",t,i,r,e),M=n("lineThrough",t,i,r,e),T=Math.max(1,Math.floor(h/10)),k=n("textOverflow",t,i,r,e),R=n("borderColor",t,i,r,e),P=n("borderLineWidth",t,i,r,e),B=n("borderLineDash",t,i,r,e),I=n("marked",t,i,r,e),E=n("cursor",t,i,r,e),L=!(g&&f&&m&&y&&v&&b&&k&&R&&P&&B&&"boolean"==typeof x&&"boolean"==typeof M&&"boolean"==typeof I);if(!l)return{hasFunctionPros:L};let F={text:{fontFamily:o,fontSize:h,fontWeight:d,fontStyle:c,fontVariant:p,fill:b,stroke:null!=_&&_,textAlign:y,textBaseline:v,lineHeight:null!=C?C:h,underline:x?T:void 0,underlineDash:S,underlineOffset:A,lineThrough:M?T:void 0,ellipsis:"clip"===k?"":"ellipsis"===k?"...":(0,u.Z)(k)?k:void 0},group:{fill:f,lineDash:B,lineWidth:P,stroke:R,cursor:"auto"===E||"default"===E?void 0:E},_vtable:{padding:g,marked:I}};if(Array.isArray(P)&&(F.group.strokeArrayWidth=(0,a.u)(P)),Array.isArray(R)){let t=(0,a.u)(R);F.group.stroke=!t.every(t=>!t)&&t,F.group.strokeArrayColor=(0,a.u)(R)}return{theme:F,hasFunctionPros:L}}function S(t,e,i){let r=i.theme.frameStyle.cornerRadius;if(i.theme.cellInnerBorder){if(Array.isArray(r)){let n=[0,0,0,0];return 0===t&&0===e&&(n[0]=r[0]),t===i.colCount-1&&0===e&&(n[1]=r[1]),0===t&&e===i.rowCount-1&&(n[3]=r[3]),t===i.colCount-1&&e===i.rowCount-1&&(n[2]=r[2]),n}if(r){let n=[0,0,0,0];return 0===t&&0===e&&(n[0]=r),t===i.colCount-1&&0===e&&(n[1]=r),0===t&&e===i.rowCount-1&&(n[3]=r),t===i.colCount-1&&e===i.rowCount-1&&(n[2]=r),n}}return 0}function A(t){var e,i,r,n;if(t){if(Array.isArray(t)){let l;for(let s=0;s<t.length;s++)if(t[s].autoRange){if("sum"===t[s].y||"sum"===t[s].x||"sum"===t[s].y1||"sum"===t[s].x1)return"sum";"max"!==t[s].y&&"max"!==t[s].x&&"max"!==t[s].y1&&"max"!==t[s].x1||(l="max"),"number"==typeof t[s].y&&"number"==typeof(null!=l?l:0)&&(l=Math.max(null!=(e=l)?e:0,t[s].y)),"number"==typeof t[s].x&&"number"==typeof(null!=l?l:0)&&(l=Math.max(null!=(i=l)?i:0,t[s].x)),"number"==typeof t[s].y1&&"number"==typeof(null!=l?l:0)&&(l=Math.max(null!=(r=l)?r:0,t[s].y1)),"number"==typeof t[s].x1&&"number"==typeof(null!=l?l:0)&&(l=Math.max(null!=(n=l)?n:0,t[s].x1))}return l}if(t.autoRange){if("sum"===t.y||"sum"===t.x||"sum"===t.y1||"sum"===t.x1)return"sum";if("max"===t.y||"max"===t.x||"max"===t.y1||"max"===t.x1)return"max";if("number"==typeof t.y)return t.y;if("number"==typeof t.x)return t.x;if("number"==typeof t.y1)return t.y1;if("number"==typeof t.x1)return t.x1}}}function M(t){for(let e=0;e<t.internalProps.columns.length;e++){let i=t.internalProps.columns[e];if(i.aggregation);else if(t.options.aggregation){let r;if(r="function"==typeof t.options.aggregation?t.options.aggregation({col:e,field:i.field}):t.options.aggregation)if(Array.isArray(r)){let t=[];r.forEach(e=>{t.push(Object.assign({showOnTop:!1},e))}),i.aggregation=t}else i.aggregation=Object.assign({showOnTop:!1},r)}}}function T(t){for(let e=0;e<t.length;e++)if(t[e].aggregation)return!0;return!1}function k(t){if("autoWidth"===t.options.widthMode||"auto"===t.options.defaultHeaderColWidth||Array.isArray(t.options.defaultHeaderColWidth)&&t.options.defaultHeaderColWidth.includes("auto"))return!0;let e=t.internalProps.layoutMap.columnObjects;for(let t=0;t<e.length;t++)if("auto"===e[t].width)return!0;return!1}},17590:function(t,e,i){i.d(e,{k:()=>l});var r=i(96241),n=i(95723);function l(t){return(0,r.Z)(t)?t:(0,n.Z)(t)?(e,i)=>t.find(t=>t.range.start.col<=e&&t.range.end.col>=e&&t.range.start.row<=i&&t.range.end.row>=i):void 0}},77818:function(t,e,i){i.d(e,{Z:()=>u});var r=i(95723),n=i(4654),l=i(64776),s=i(65755),a=i(47490),o=i(53681),h=i(13546),d=i.n(h);class u extends o.o2{static get EVENT_TYPE(){return o.o2.EVENT_TYPE}static ofArray(t,e,i,r,n,l){return new u({get:e=>t[e],length:t.length,records:t},e,i,r,n,l)}constructor(t,e,i,n,l,s){let a;(0,r.Z)(null==e?void 0:e.groupByRules)&&(a=!0),super(t,e,i,n,l,s),this._isGrouped=a,this._recordCache=[],this._fieldCache={}}getOriginalRecord(t){return(0,n.Z)(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:super.getOriginalRecord(t)}getRawRecord(t){var e,i,r,s;let a,h;if(this._isGrouped){if(a=this.getOriginRecordIndexForGroup(t),(0,l.Z)(a)&&(null==(e=this.beforeChangedRecordsMap)?void 0:e.has(a.toString())))return null==(i=this.beforeChangedRecordsMap)?void 0:i.get(a.toString())}else if(null==(r=this.beforeChangedRecordsMap)?void 0:r.has(t.toString()))return null==(s=this.beforeChangedRecordsMap)?void 0:s.get(t.toString());return(0,n.Z)(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:(h=this.dataSourceObj.records?Array.isArray(t)?(0,o.UN)(this.records,t):this.records[t]:this._get(t),(0,o.NA)(h,e=>{this.recordPromiseCallBack(t,e)}))}getOriginalField(t,e,i,r,n){let l=this._fieldCache&&this._fieldCache[t];if(l){let t=l.get(e);if(t)return t}return super.getOriginalField(t,e,i,r,n)}clearCache(){this._recordCache&&(this._recordCache=[]),this._fieldCache&&(this._fieldCache={})}fieldPromiseCallBack(t,e,i){var r;r=this._fieldCache,(r[t]||(r[t]=new Map)).set(e,i)}recordPromiseCallBack(t,e){this._recordCache&&(this._recordCache[t]=e)}get records(){return Array.isArray(this._recordCache)&&this._recordCache.length>0?this._recordCache:super.records}release(){var t;null==(t=super.release)||t.call(this),this._recordCache=null,this._fieldCache=null}_generateFieldAggragations(){var t;if(super._generateFieldAggragations(),(0,r.Z)(null==(t=this.dataConfig)?void 0:t.groupByRules)){let t=this.dataConfig.groupByRules;this.groupAggregator=new this.registedAggregators[a.E.CUSTOM]({field:"",aggregationFun:(e,i,r)=>{let n=new Map,s=[];for(let e=0;e<i.length;e++)!function t(e,i,r,n,s){let a=n[s];if(!(0,l.Z)(a))return void i.push(e);let o=d()(e,a);if(void 0!==o){if(r.has(o)){let l=r.get(o);return t(e,i[l].children,i[l].map,n,s+1)}return r.set(o,i.length),i.push({vtableMerge:!0,vtableMergeName:o,children:[],map:new Map}),t(e,i[i.length-1].children,i[i.length-1].map,n,s+1)}}(i[e],s,n,t,0);return s}}),this.fieldAggregators.push(this.groupAggregator)}}processRecords(t){var e;let i=super.processRecords(t);return(null==(e=this.groupAggregator)?void 0:e.value())||i}getGroupLength(){var t,e,i;return null!=(i=null==(e=null==(t=this.dataConfig)?void 0:t.groupByRules)?void 0:e.length)?i:0}updateGroup(){var t,e,i;this.clearCache();let n=this.source;this._source=this.processRecords(null!=(e=null==(t=this.dataSourceObj)?void 0:t.records)?e:this.dataSourceObj),n&&function t(e,i,n,s){if(!n){n=new Map;for(let t=0;t<e.length;t++){let i=e[t];i.vtableMerge&&n.set(i.vtableMergeName,t)}}if(!s){s=new Map;for(let t=0;t<i.length;t++){let e=i[t];e.vtableMerge&&s.set(e.vtableMergeName,t)}}for(let n=0;n<e.length;n++){let a=e[n],o=i[s.get(a.vtableMergeName)];(0,l.Z)(o)&&(o.hierarchyState=e[n].hierarchyState),(0,r.Z)(null==a?void 0:a.children)&&(0,r.Z)(null==o?void 0:o.children)&&0!==a.map.size&&0!==o.map.size&&t(a.children,o.children,a.map,o.map)}}(n,this.source),this.sourceLength=(null==(i=this.source)?void 0:i.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this.sourceLength},(t,e)=>e),this.userPagination||(this.pagination.perPageCount=this.sourceLength,this.pagination.totalCount=this.sourceLength),this.initTreeHierarchyState(),this.updatePagerData()}getOriginRecordIndexForGroup(t){let e=this.getOriginalRecord(t);if((0,l.Z)(e)&&!(e.children&&e.children.length>0)){for(let t=0;t<this.dataSourceObj.records.length;t++)if(this.dataSourceObj.records[t]===e)return t}}addRecordsForGroup(t,e){if(!(0,r.Z)(t)||0===t.length)return;let i=this.getOriginRecordIndexForGroup(e);(void 0===i||i>this.dataSourceObj.records)&&(i=this.dataSourceObj.records.length),this.dataSourceObj.records.splice(i,0,...t),this.adjustBeforeChangedRecordsMap(i,t.length),this.updateGroup()}deleteRecordsForGroup(t){if(!(0,r.Z)(t)||0===t.length)return;let e=(0,o.pY)(t,-1);for(let t=0;t<e.length;t++){let i=e[t];if((0,n.Z)(i)&&(i>=this.sourceLength||i<0))continue;let r=this.getOriginRecordIndexForGroup(i);this.beforeChangedRecordsMap.delete(r.toString()),this.dataSourceObj.records.splice(r,1),this.sourceLength-=1,this.adjustBeforeChangedRecordsMap(r,1,"delete")}this.updateGroup()}updateRecordsForGroup(t,e){for(let i=0;i<e.length;i++){let r=e[i];if((0,n.Z)(r)&&(r>=this.sourceLength||r<0))continue;let l=this.getOriginRecordIndexForGroup(r);this.beforeChangedRecordsMap.delete(l.toString()),this.dataSourceObj.records[l]=t[i]}this.updateGroup()}addRecordsForTree(t,e){if((0,r.Z)(t)&&0!==t.length){if(this.adjustBeforeChangedRecordsMap(e,t.length),(0,n.Z)(e))this.dataSourceObj.records.splice(e,0,...t);else{let i=[...e],r=i.pop(),n=this.getOriginalRecord(i);n.children?n.children.splice(r,0,...t):n.children=t}this.initTreeHierarchyState(),this.updatePagination()}}deleteRecordsForTree(t){if(!(0,r.Z)(t)||0===t.length)return[];let e=(0,o.pY)(t,-1),i=[];for(let t=0;t<e.length;t++){let r=e[t];if(!(0,n.Z)(r)||!(r>=this.sourceLength||r<0)){if(this.beforeChangedRecordsMap.delete(r.toString()),(0,n.Z)(r))this.dataSourceObj.records.splice(r,1);else{let t=[...r],e=t.pop();this.getOriginalRecord(t).children.splice(e,1)}this.adjustBeforeChangedRecordsMap(r,1,"delete"),i.push(r)}}return this.initTreeHierarchyState(),this.updatePagination(),i}updateRecordsForTree(t,e){for(let i=0;i<e.length;i++){let r=e[i],l=t[i];if(!(0,n.Z)(r)||!(r>=this.sourceLength||r<0))if(this.beforeChangedRecordsMap.delete(r.toString()),(0,n.Z)(r))this.dataSourceObj.records.splice(r,1,l);else{let t=[...r],e=t.pop();this.getOriginalRecord(t).children.splice(e,1,l)}}this.initTreeHierarchyState(),this.updatePagerData()}adjustBeforeChangedRecordsMap(t,e,i="add"){if("tree"===this.rowHierarchyType){let r;r=(0,n.Z)(t)?[t]:t;let l=[];this.beforeChangedRecordsMap.forEach((t,n)=>{var s,a;let o=n.split(","),h=Math.max(o.length,r.length);for(let d=0;d<h;d++){let h=null!=(s=r[d])?s:-1,u=null!=(a=Number(o[d]))?a:-1;if(h<u||h===u&&d===o.length-1&&d===r.length-1)return o[d]=(u+("add"===i?e:-e)).toString(),void l.push({originKey:n,targetKey:o.toString(),value:t})}}),l.forEach(({originKey:t,targetKey:e,value:i})=>{this.beforeChangedRecordsMap.delete(t),this.beforeChangedRecordsMap.set(e,i)})}else super.adjustBeforeChangedRecordsMap(t,e,i)}cacheBeforeChangedRecord(t,e){var i;let r=this.getOriginalRecord(t);e.internalProps.groupBy&&(t=this.getOriginRecordIndexForGroup(t)),this.beforeChangedRecordsMap.has(t.toString())||this.beforeChangedRecordsMap.set(t.toString(),null!=(i=(0,s.Z)(r,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))?i:{})}getGroupSeriesNumber(t){let e=this.dataSource.currentIndexedData[t],i=e.length-1,r=e.length,l=1;for(;r>i;l++){let e=this.dataSource.currentIndexedData[t-l];r=(0,n.Z)(e)?1:e.length}return l-1}}},53681:function(t,e,i){i.d(e,{o2:()=>v,UN:()=>b,pY:()=>_,NA:()=>f});var r=i(72281),n=i(47490),l=i(23975),s=i(79497),a=i(6958),o=i(64776),h=i(80971),d=i(99051),u=i(65755),c=i(4654),p=i(39433);let g={SOURCE_LENGTH_UPDATE:"source_length_update",CHANGE_ORDER:"change_order"};function f(t,e){let i=(0,l.vi)(t);if((0,l.tI)(i)){let t=i.then(t=>(e(t),t));return e(t),t}return i}function m(t,e,i,r,n,s){var d;if(null==t)return;if((0,l.tI)(t))return t.then(t=>m(t,e,i,r,n,s));let u=(d=e,!(l.j6.isObject(d)&&(0,o.Z)(d.get)&&(0,o.Z)(d.set))&&1)?e:e.get;if((void 0===u||""===u)&&Array.isArray(t))return t[i-n.leftRowSeriesNumberCount];if((0,h.Z)(t)&&u in t)return f(t[u],s);if("function"==typeof u)return f(u(t,i,r,n),s);if(Array.isArray(u))return f((0,a.MU)(t,[...u]),s);let c=`${u}`.split(".");return c.length<=1?f(t[u],s):f((0,l.vl)(t,(t,e)=>m(t,e,i,r,n,l.nO),...c),s)}function y(t,e){if(!t)return e;let i=t[e];return(0,o.Z)(i)?i:e}class v extends s.R{static get EVENT_TYPE(){return g}constructor(t,e,i,r,n,l){var s;super(),this.addRecordRule="Object",this.currentIndexedData=[],this.hierarchyExpandLevel=0,this.hasHierarchyStateExpand=!1,this.beforeChangedRecordsMap=new Map,this.registedAggregators={},this.rowHierarchyType="grid",this.fieldAggregators=[],this.addRecordRule=(null==e?void 0:e.addRecordRule)||"Object",this.registerAggregators(),this.dataSourceObj=t,this.dataConfig=e,this._get=null==t?void 0:t.get,this.columns=r,this._source=(null==t?void 0:t.records)?this.processRecords(null==t?void 0:t.records):t,this._sourceLength=(null==(s=this._source)?void 0:s.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=i,this.pagination=i||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},l>=1&&(this.hierarchyExpandLevel=l),this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e),"tree"===n&&this.initTreeHierarchyState(),this.rowHierarchyType=n,this.updatePagerData()}initTreeHierarchyState(){var t,e;this._sourceLength=(null==(t=this._source)?void 0:t.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e);let i=this._sourceLength;for(let t=0;t<i;t++){let n=this.currentIndexedData[t],l=this.getOriginalRecord(n);if(!l)continue;let s=null!=(e=l.filteredChildren)?e:l.children;if((null==s?void 0:s.length)>0){if(this.hierarchyExpandLevel>1?l.hierarchyState||(l.hierarchyState=r.g.expand):l.hierarchyState||(l.hierarchyState=r.g.collapse),this.hasHierarchyStateExpand=!0,l.hierarchyState===r.g.collapse)continue;let e=this.initChildrenNodeHierarchy(n,this.hierarchyExpandLevel,2,l);t+=e,i+=e}else!0!==l.children||l.hierarchyState||(l.hierarchyState=r.g.collapse)}}supplementConfig(t,e,i,r){var n;this.columns=e,this._sourceLength=(null==(n=this._source)?void 0:n.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=t,this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},r>=1&&(this.hierarchyExpandLevel=r),this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e),"tree"===i&&this.initTreeHierarchyState(),this.rowHierarchyType=i,this.updatePagerData()}registerAggregator(t,e){this.registedAggregators[t]=e}registerAggregators(){this.registerAggregator(n.E.RECORD,p.hT),this.registerAggregator(n.E.SUM,p.__),this.registerAggregator(n.E.COUNT,p.ZP),this.registerAggregator(n.E.MAX,p.Fn),this.registerAggregator(n.E.MIN,p.NF),this.registerAggregator(n.E.AVG,p.ky),this.registerAggregator(n.E.NONE,p.ld),this.registerAggregator(n.E.CUSTOM,p.Js)}updateColumns(t){this.columns=t}_generateFieldAggragations(){let t=this.columns;this.fieldAggregators=[];let e=t=>{delete t.vtable_aggregator;let e=t.field,i=t.aggregation;if(i)if(Array.isArray(i))for(let r of i){let i=new this.registedAggregators[r.aggregationType]({field:e,formatFun:r.formatFun,isRecord:!0,aggregationFun:r.aggregationFun});this.fieldAggregators.push(i),t.vtable_aggregator||(t.vtable_aggregator=[]),t.vtable_aggregator.push(i)}else{let r=new this.registedAggregators[i.aggregationType]({field:e,formatFun:i.formatFun,isRecord:!0,aggregationFun:i.aggregationFun});this.fieldAggregators.push(r),t.vtable_aggregator=r}},i=t=>{if(t&&0!==t.length)for(let r of t)e(r),r.columns&&i(r.columns)};i(t)}processRecords(t){var e,i,r,n,l,s,a,o;this._generateFieldAggragations();let h=[],d=this.fieldAggregators.length>=1;if((null==(i=null==(e=this.dataConfig)?void 0:e.filterRules)?void 0:i.length)>=1||(null==(r=this.lastFilterRules)?void 0:r.length)>=1||d){for(let e=0,i=t.length;e<i;e++){let i=t[e];null!=i&&((null==(l=null==(n=this.dataConfig)?void 0:n.filterRules)?void 0:l.length)>=1?this.filterRecord(i)&&(h.push(i),"tree"===this.rowHierarchyType&&i.children&&(i.filteredChildren=this.filteredChildren(i.children)),d&&this.processRecord(i)):((null==(s=this.lastFilterRules)?void 0:s.length)>=1&&this.clearFilteredChildren(i),d&&this.processRecord(i)))}if((null==(o=null==(a=this.dataConfig)?void 0:a.filterRules)?void 0:o.length)>=1)return h}return t}filteredChildren(t){let e=[];for(let i=0,r=t.length;i<r;i++){let r=t[i];this.filterRecord(r)&&(e.push(r),r.children&&(r.filteredChildren=this.filteredChildren(r.children)))}return e}processRecord(t){for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].push(t)}initChildrenNodeHierarchy(t,e,i,n){var l,s,a;let o=0,h=n.filteredChildren?n.filteredChildren.length:null!=(s=null==(l=n.children)?void 0:l.length)?s:0;for(let l=0;l<h;l++){(i<=e||n.hierarchyState===r.g.expand)&&(o+=1);let s=n.filteredChildren?n.filteredChildren[l]:n.children[l],h=Array.isArray(t)?t.concat(l):[t,l];(i<=e||n.hierarchyState===r.g.expand)&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+o,0,h),(s.filteredChildren?s.filteredChildren.length>0:(null==(a=s.children)?void 0:a.length)>0)&&(i<e||s.hierarchyState===r.g.expand?(s.hierarchyState||(s.hierarchyState=r.g.expand),this.hasHierarchyStateExpand=!0):s.hierarchyState||(s.hierarchyState=r.g.collapse)),s.hierarchyState===r.g.expand&&(o+=this.initChildrenNodeHierarchy(h,e,i+1,s)),!0!==s.children||s.hierarchyState||(s.hierarchyState=r.g.collapse)}return o}updatePagination(t){this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},this.updatePagerData()}updatePagerData(){let{currentIndexedData:t}=this,{perPageCount:e,currentPage:i}=this.pagination,r=e*(i||0),n=r+e;if(this._currentPagerIndexedData.length=0,t&&t.length>0){let e=-1;for(let i=0;i<t.length;i++)if((Array.isArray(t[i])&&1===t[i].length||!Array.isArray(t[i]))&&e++,e>=r&&e<n)this._currentPagerIndexedData.push(t[i]);else if(e>=n)break}else if(this._sourceLength>0)throw Error("currentIndexedData should has values!")}getRecordIndexPaths(t){return this._currentPagerIndexedData[t]}get records(){return Array.isArray(this._source)?this._source:[]}get source(){return this._source}get(t){return this.getOriginalRecord(y(this.currentPagerIndexedData,t))}getRaw(t){return this.getRawRecord(y(this.currentPagerIndexedData,t))}getIndexKey(t){return y(this.currentPagerIndexedData,t)}getTableIndex(t){return Array.isArray(t)?"tree"===this.rowHierarchyType?this.currentPagerIndexedData.findIndex(e=>(0,d.h6)(e,t)):this.currentPagerIndexedData.findIndex(e=>e===t[0]):this.currentPagerIndexedData.findIndex(e=>e===t)}getField(t,e,i,r,n){return this.getOriginalField(y(this.currentPagerIndexedData,t),e,i,r,n)}getRawField(t,e,i,r,n){return this.getRawFieldData(y(this.currentPagerIndexedData,t),e,i,r,n)}hasField(t,e){return this.hasOriginalField(y(this.currentPagerIndexedData,t),e)}getHierarchyState(t){var e;let i=this.getOriginalRecord(this.currentPagerIndexedData[t]);if(null==i?void 0:i.hierarchyState){let t=i.hierarchyState;if((null==(e=i.children)?void 0:e.length)>0||!0===i.children)return t}return null}toggleHierarchyState(t,e,i){let n=this.currentIndexedData.slice(0),l=this.getIndexKey(t),s=this.getHierarchyState(t),o=this.getOriginalRecord(l);if(this.clearSortedIndexMap(),s===r.g.collapse)o.hierarchyState=r.g.expand,this.pushChildrenNode(l,r.g.expand,o),this.hasHierarchyStateExpand=!0;else if(s===r.g.expand){let t=(0,a.pr)(l,s,o);this.currentIndexedData.splice(this.currentIndexedData.indexOf(l)+1,t),o.hierarchyState=r.g.collapse}this.updatePagerData();let h=[],d=[];if(s===r.g.collapse){let e=this.currentIndexedData.length-n.length;for(let i=0;i<e;i++)h.push(t+i+1)}else if(s===r.g.expand){let e=n.length-this.currentIndexedData.length;for(let i=0;i<e;i++)d.push(t+i+1)}return{add:h,remove:d}}pushChildrenNode(t,e,i){var n,l;if(!e||e===r.g.collapse||e===r.g.none)return 0;let s=0,a=i.filteredChildren?i.filteredChildren:i.children;if(a){let e=Array.from({length:a.length},(t,e)=>e);null==(n=this.lastSortStates)||n.forEach(i=>{"normal"!==i.order&&function(t,e,i,r,n,l){let s=function(t,e){let i=Array(e);for(let r=0;r<e;r++)i[r]=t(r);return i}(t,i);s.sort((t,e)=>r(l(t),l(e),n));for(let t=0;t<i;t++)e(t,s[t])}(t=>(0,o.Z)(e[t])?e[t]:e[t]=t,(t,i)=>{e[t]=i},a.length,i.orderFn,i.order,e=>this.getOriginalField(Array.isArray(t)?t.concat([e]):[t,e],i.field))});for(let i=0;i<e.length;i++){s+=1;let n=Array.isArray(t)?t.concat([e[i]]):[t,e[i]];this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+s,0,n);let o=this.getOriginalRecord(n);!o.hierarchyState&&(null!=(l=o.filteredChildren)?l:o.children)&&(o.hierarchyState=r.g.collapse),s+=this.pushChildrenNode(n,o.hierarchyState,a[e[i]])}}return s}changeFieldValue(t,e,i,r,n,s){var o;if(null!==i&&e>=0){let n=this.getIndexKey(e);if(this.cacheBeforeChangedRecord(n,s),void 0!==i&&""!==i||(i=r-s.leftRowSeriesNumberCount),"string"==typeof i||"number"==typeof i){let e=null==(o=this.beforeChangedRecordsMap.get(n.toString()))?void 0:o[i],r=this.getOriginalRecord(n),s=t;"number"==typeof e&&(0,a.Zf)(t)&&(s=parseFloat(t)),(0,l.tI)(r)?r.then(t=>{t[i]=s}).catch(t=>{}):r?r[i]=s:(this.records[n]="Array"===this.addRecordRule?[]:{},this.records[n][i]=s)}}}cacheBeforeChangedRecord(t,e){var i;if(!this.beforeChangedRecordsMap.has(t.toString())){let e=this.getOriginalRecord(t);this.beforeChangedRecordsMap.set(t.toString(),null!=(i=(0,u.Z)(e,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))?i:{})}}setRecord(t,e){var i,r;let n=!0;if((null==(r=null==(i=this.dataConfig)?void 0:i.filterRules)?void 0:r.length)>=1&&(this.filterRecord(t)?"tree"===this.rowHierarchyType&&t.children&&(t.filteredChildren=this.filteredChildren(t.children)):n=!1),n&&Array.isArray(this.records)){let i=this.getIndexKey(e);Array.isArray(i)||this.records.splice(i,1,t)}}addRecord(t,e){var i;if(Array.isArray(this.records)){this.records.splice(e,0,t),this.adjustBeforeChangedRecordsMap(e,1),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1;for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].push(t);if("tree"===this.rowHierarchyType&&this.initTreeHierarchyState(),this.userPagination){this.pagination.totalCount=this._sourceLength;let{perPageCount:t,currentPage:i}=this.pagination;e<t*(i||0)+t&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();(null==(i=this.dataSourceObj)?void 0:i.added)&&this.dataSourceObj.added(e,1)}}addRecords(t,e){var i;if(Array.isArray(this.records)){if(Array.isArray(t)){this.records.splice(e,0,...t),this.adjustBeforeChangedRecordsMap(e,t.length);for(let e=0;e<t.length;e++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length;for(let e=0;e<this.fieldAggregators.length;e++)for(let i=0;i<t.length;i++)this.fieldAggregators[e].push(t[i])}if(this.userPagination){this.pagination.totalCount=this._sourceLength;let{perPageCount:t,currentPage:i}=this.pagination;e<t*(i||0)+t&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();(null==(i=this.dataSourceObj)?void 0:i.added)&&this.dataSourceObj.added(e,t.length)}}addRecordForSorted(t){Array.isArray(this.records)&&(this.beforeChangedRecordsMap.clear(),this.records.push(t),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1,this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength))}addRecordsForSorted(t){if(Array.isArray(this.records)){if(this.beforeChangedRecordsMap.clear(),Array.isArray(t)){this.records.push(...t);for(let e=0;e<t.length;e++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length,this.sortedIndexMap.clear()}this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}}adjustBeforeChangedRecordsMap(t,e,i="add"){for(let r=this.beforeChangedRecordsMap.size-1;r>=t;r--){let t=this.beforeChangedRecordsMap.get(r.toString());this.beforeChangedRecordsMap.delete(r.toString()),this.beforeChangedRecordsMap.set((r+("add"===i?e:-e)).toString(),t)}}deleteRecords(t){var e;if(Array.isArray(this.records)){let i=[],r=t.sort((t,e)=>e-t);for(let t=0;t<r.length;t++){let e=r[t];if(e>=this._sourceLength||e<0)continue;this.adjustBeforeChangedRecordsMap(e,1,"delete"),i.push(e);let n=this.records[e];for(let t=0;t<this.fieldAggregators.length;t++)this.fieldAggregators[t].deleteRecord(n);this.records.splice(e,1),this.currentIndexedData.pop(),this._sourceLength-=1}return this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.updatePagerData(),(null==(e=this.dataSourceObj)?void 0:e.deleted)&&this.dataSourceObj.deleted(i),i}return[]}deleteRecordsForSorted(t){if(Array.isArray(this.records)){let e=t.sort((t,e)=>e-t);for(let t=0;t<e.length;t++){let i=e[t];if(i>=this._sourceLength||i<0)continue;let r=this.currentIndexedData[i];this.records.splice(r,1),this._sourceLength-=1}this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.beforeChangedRecordsMap.clear()}}updateRecords(t,e){let i=[];for(let r=0;r<e.length;r++){let n=e[r];if(Array.isArray(n))this.beforeChangedRecordsMap.delete(n.toString()),i.push(n),n.slice(0,-1).reduce((t,e)=>(void 0===t[e]&&(t[e]={}),t[e].children),this.records)[n[n.length-1]]=t[r];else{if(n>=this._sourceLength||n<0)continue;this.beforeChangedRecordsMap.delete(n.toString()),i.push(n);for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].updateRecord(this.records[n],t[r]);this.records[n]=t[r]}}return this.userPagination&&this.updatePagerData(),i}updateRecordsForSorted(t,e){let i=[];for(let r=0;r<e.length;r++){let n=e[r];if(n>=this._sourceLength||n<0)continue;let l=this.currentIndexedData[n];if("number"!=typeof l)return;this.beforeChangedRecordsMap.delete(l.toString()),i.push(n),this.records[l]=t[r]}this.sortedIndexMap.clear()}sort(t){t=(Array.isArray(t)?t:[t]).filter(t=>{let e=this.columns.find(e=>e.field===t.field);return!1!==(null==e?void 0:e.sort)&&"normal"!==t.order}),this.lastSortStates=t;let e=t.map(t=>this.sortedIndexMap.get(null==t?void 0:t.field)||{asc:[],desc:[],normal:[]}),i=null;if(e.length>0&&(i=t.reduce((t,i,r)=>{var n;let l=null==(n=e[r])?void 0:n[i.order];return l&&l.length>0?l:t},null))&&i.length>0)return this.currentIndexedData=i,this.updatePagerData(),void this.fireListeners(g.CHANGE_ORDER,null);let r=Array.from({length:this._sourceLength},(t,e)=>e);if(r.sort((e,i)=>{let r=this.getOriginalRecord(e),n=this.getOriginalRecord(i),l=null==r||"object"==typeof r&&0===Object.keys(r).length,s=null==n||"object"==typeof n&&0===Object.keys(n).length;return t.reduce((t,r)=>{if(0!==t)return t;if("asc"===r.order||"desc"===r.order){if(l&&!s)return 1;if(!l&&s)return -1;if(l&&s)return e-i}else if(l||s)return e-i;return(r.orderFn||("desc"!==r.order?(t,e)=>t===e?0:t>e?1:-1:(t,e)=>t===e?0:t<e?1:-1))(this.getOriginalField(e,r.field),this.getOriginalField(i,r.field),r.order)},0)}),this.currentIndexedData=r,this.hierarchyExpandLevel&&"tree"===this.rowHierarchyType){let t=r.length;for(let e=0;e<t;e++){let i=this.getOriginalRecord(r[e]),n=this.pushChildrenNode(r[e],i.hierarchyState,this.getOriginalRecord(r[e]));t+=n,e+=n}}if(!e.length){e=t.map(()=>({asc:[],desc:[],normal:[]}));for(let i=0;i<t.length;i++)this.sortedIndexMap.set(t[i].field,e[i])}t.forEach((t,i)=>{e[i][t.order]=r.slice()}),this.updatePagerData(),this.fireListeners(g.CHANGE_ORDER,null)}setSortedIndexMap(t,e){this.sortedIndexMap.set(t,e)}clearFilteredChildren(t){var e,i;t.filteredChildren=void 0;for(let r=0;r<(null!=(i=null==(e=t.children)?void 0:e.length)?i:0);r++)this.clearFilteredChildren(t.children[r])}filterRecord(t){var e,i,r;let n=!0;for(let l=0;l<(null==(e=this.dataConfig.filterRules)?void 0:e.length);l++){let e=null==(i=this.dataConfig)?void 0:i.filterRules[l];if(e.filterKey){let i=t[e.filterKey];if(-1===e.filteredValues.indexOf(i)){n=!1;break}}else if(!(null==(r=e.filterFunc)?void 0:r.call(e,t))){n=!1;break}}return n}updateFilterRulesForSorted(t){var e,i,r;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords(null!=(i=null==(e=this.dataSourceObj)?void 0:e.records)?i:this.dataSourceObj),this._sourceLength=(null==(r=this._source)?void 0:r.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e),"tree"===this.rowHierarchyType&&this.initTreeHierarchyState(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}updateFilterRules(t,e){var i,r,n;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords(null!=(r=null==(i=this.dataSourceObj)?void 0:i.records)?r:this.dataSourceObj),e&&e(this._source),this._sourceLength=(null==(n=this._source)?void 0:n.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,"tree"===this.rowHierarchyType&&this.initTreeHierarchyState()),this.updatePagerData()}clearSortedIndexMap(){this.lastSortStates&&this.lastSortStates.length>0&&this.sortedIndexMap.forEach((t,e)=>{this.lastSortStates.some(t=>t.field===e)?this.lastSortStates.forEach(e=>{"asc"===e.order?(t.desc=[],t.normal=[]):"desc"===e.order?(t.asc=[],t.normal=[]):(t.asc=[],t.desc=[])}):this.sortedIndexMap.delete(e)})}get sourceLength(){return this._sourceLength}set sourceLength(t){this._sourceLength!==t&&(this._sourceLength=t,this.fireListeners(g.SOURCE_LENGTH_UPDATE,this._sourceLength))}get length(){return this.currentPagerIndexedData.length}get dataSource(){return this}get currentPagerIndexedData(){return this._currentPagerIndexedData.length>0?this._currentPagerIndexedData:[]}release(){var t;null==(t=super.release)||t.call(this),this.lastFilterRules=null,this.clearSortedMap(),this.clearCurrentIndexedData(),this.currentPagerIndexedData.length=0}clearSortedMap(){this.currentIndexedData&&(this.currentIndexedData.length=0),this.currentIndexedData=null,this.sortedIndexMap.forEach(t=>{t.asc&&(t.asc.length=0),t.desc&&(t.desc.length=0)}),this.sortedIndexMap.clear()}clearCurrentIndexedData(){this.currentIndexedData=null,this.currentPagerIndexedData.length=0}getOriginalRecord(t){return f(this.dataSourceObj.records?Array.isArray(t)?b(this.records,t):this.records[t]:this._get(t),e=>{this.recordPromiseCallBack(t,e)})}getRawRecord(t){var e,i;return(null==(e=this.beforeChangedRecordsMap)?void 0:e.has(t.toString()))?null==(i=this.beforeChangedRecordsMap)?void 0:i.get(t.toString()):f(this.dataSourceObj.records?Array.isArray(t)?b(this.records,t):this.records[t]:this._get(t),e=>{this.recordPromiseCallBack(t,e)})}getOriginalField(t,e,i,r,n){if(null!==e)return m(this.getOriginalRecord(t),e,i,r,n,i=>{this.fieldPromiseCallBack(t,e,i)})}getRawFieldData(t,e,i,r,n){if(null!==e)return m(this.getRawRecord(t),e,i,r,n,i=>{this.fieldPromiseCallBack(t,e,i)})}hasOriginalField(t,e){if(null===e)return!1;if("function"==typeof e)return!0;let i=this.getOriginalRecord(t);return!!(i&&e in i)}fieldPromiseCallBack(t,e,i){}recordPromiseCallBack(t,e){}canChangeOrder(t,e){var i;if(null==(i=this.dataSourceObj)?void 0:i.canChangeOrder)return this.dataSourceObj.canChangeOrder(t,e);if(this.hasHierarchyStateExpand){let i=this.currentPagerIndexedData[t],r=this.currentPagerIndexedData[e];if(i=Array.isArray(i)?[...i]:[i],r=Array.isArray(r)?[...r]:[r],e>t&&r.length>i.length){let t=this.currentPagerIndexedData[e+1];(t=Array.isArray(t)?[...t]:[t]).length<r.length&&r.splice(r.length-1,1)}if(i.length===r.length){for(let t=0;t<=i.length-2;t++)if(i[t]!==r[t])return!1;return!0}return!1}return!0}changeOrder(t,e){var i,r,n;if(null==(i=this.dataSourceObj)?void 0:i.changeOrder)this.dataSourceObj.changeOrder(t,e);else if(!(null==(r=this.lastSortStates)?void 0:r.some(t=>"asc"===t.order||"desc"===t.order))&&this.canChangeOrder(t,e))if(this.hasHierarchyStateExpand){let i,r,l=this.currentPagerIndexedData[t],s=this.currentPagerIndexedData[e];if(l=Array.isArray(l)?[...l]:[l],s=Array.isArray(s)?[...s]:[s],l.length>1||s.length>1){if(e>t&&s.length>l.length){let t=this.currentPagerIndexedData[e+1];(t=Array.isArray(t)?[...t]:[t]).length<s.length&&s.splice(s.length-1,1)}if(i=l.splice(l.length-1,1)[0],r=s.splice(s.length-1,1)[0],l.length>=1){let t=this.getOriginalRecord(l);if(t){let e=t.filteredChildren?t.filteredChildren.splice(i,1):t.children.splice(i,1);e.unshift(r,0),Array.prototype.splice.apply(null!=(n=t.filteredChildren)?n:t.children,e)}}else{let t=this.records.splice(i,1);t.unshift(r,0),Array.prototype.splice.apply(this.records,t)}}else this.exchangeRecordData(t,e);this.restoreTreeHierarchyState(),this.updatePagerData()}else this.exchangeRecordData(t,e)}exchangeRecordData(t,e){let i=this.getRecordIndexPaths(t),r=this.getRecordIndexPaths(e),n=this.records.splice(i,1);n.unshift(r,0),Array.prototype.splice.apply(this.records,n)}restoreTreeHierarchyState(){var t,e;if(this.hierarchyExpandLevel){for(let e=0;e<this._sourceLength;e++){let i=this.getOriginalRecord(e);i&&(null!=(t=i.filteredChildren)?t:i.children)&&!i.hierarchyState&&(i.hierarchyState=r.g.collapse)}this.currentIndexedData=Array.from({length:this._sourceLength},(t,e)=>e);let i=this._sourceLength;for(let t=0;t<i;t++){let n=this.currentIndexedData[t],l=this.getOriginalRecord(n);if(!l)continue;let s=null!=(e=l.filteredChildren)?e:l.children;if((null==s?void 0:s.length)>0&&l.hierarchyState===r.g.expand){this.hasHierarchyStateExpand=!0;let e=this.restoreChildrenNodeHierarchy(n,l);t+=e,i+=e}else!0!==l.children||l.hierarchyState||(l.hierarchyState=r.g.collapse)}}}restoreChildrenNodeHierarchy(t,e){var i,n;let l=0,s=null!=(i=e.filteredChildren)?i:e.children,a=null!=(n=null==s?void 0:s.length)?n:0;for(let i=0;i<a;i++){e.hierarchyState===r.g.expand&&(l+=1);let n=s[i],a=Array.isArray(t)?t.concat(i):[t,i];e.hierarchyState===r.g.expand&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+l,0,a),l+=this.restoreChildrenNodeHierarchy(a,n)}return l}_setNodeStateRecursive(t,e){var i;if(!t)return;let r=null!=(i=t.filteredChildren)?i:t.children;if(r&&(Array.isArray(r)?r.length>0:!0===r)&&(t.hierarchyState=e),r&&Array.isArray(r))for(let t of r)this._setNodeStateRecursive(t,e)}expandAllNodes(){if(Array.isArray(this._source)){for(let t of this._source)this._setNodeStateRecursive(t,r.g.expand);this.hasHierarchyStateExpand=!0,this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}collapseAllNodes(){if(Array.isArray(this._source)){for(let t of this._source)this._setNodeStateRecursive(t,r.g.collapse);this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}}function b(t,e){var i;let r=t;for(let t=0;t<e.length;t++){let n=e[t];if(!r[n])return;let l=null!=(i=(r=r[n]).filteredChildren)?i:null==r?void 0:r.children;l&&t+1<e.length&&(r=l)}return r}function _(t,e){return t.sort((t,i)=>{var r,n;(0,c.Z)(t)&&(t=[t]),(0,c.Z)(i)&&(i=[i]);let l=Math.max(t.length,i.length);for(let s=0;s<l;s++){let l=null!=(r=t[s])?r:-1,a=null!=(n=i[s])?n:-1;if(l!==a)return 1===e?l-a:a-l}return 0})}v.EMPTY=new v({get(){},length:0})},91566:function(t,e,i){i.d(e,{q:()=>o});var r=i(64776),n=i(47490),l=i(39433),s=i(77874);function a(t,e){let i="";for(let r=0;r<t.length;r++)i+=t[r],r!==t.length-1&&(i+=e);return i}class o{constructor(t,e,i,r,n,l,s,a,o,h,d,u,c,p){var g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X,Y,$,q;this.tree={},this.changedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.colKeys_normal=[],this.rowKeys_normal=[],this.rowOrder="key_a_to_z",this.colOrder="key_a_to_z",this.sorted=!1,this.indicatorStatistics=[],this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.registerAggregators(),this.dataConfig=t,this.filterRules=null==(g=this.dataConfig)?void 0:g.filterRules,this.rowHierarchyType=null!=a?a:"grid",this.columnHierarchyType=null!=o?o:"grid",this.sortRules=null==(f=this.dataConfig)?void 0:f.sortRules,this.aggregationRules=null==(m=this.dataConfig)?void 0:m.aggregationRules,this.derivedFieldRules=null==(y=this.dataConfig)?void 0:y.derivedFieldRules,this.mappingRules=null==(v=this.dataConfig)?void 0:v.mappingRules,this.calculatedFieldRules=null==(b=this.dataConfig)?void 0:b.calculatedFieldRules,this.calculatedFiledKeys=null!=(C=null==(_=this.calculatedFieldRules)?void 0:_.map(t=>t.key))?C:[],this.calculatedFieldDependIndicatorKeys=null!=(w=null==(x=this.calculatedFieldRules)?void 0:x.reduce((t,e)=>{for(let i=0;i<e.dependIndicatorKeys.length;i++)-1===t.indexOf(e.dependIndicatorKeys[i])&&t.push(e.dependIndicatorKeys[i]);return t},[]))?w:[],this.totals=null==(S=this.dataConfig)?void 0:S.totals,this.rows=e,this.columns=i,this.indicatorKeys=r,this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys=[...r];for(let t=0;t<this.calculatedFieldDependIndicatorKeys.length;t++)-1===this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(this.calculatedFieldDependIndicatorKeys[t])&&this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.push(this.calculatedFieldDependIndicatorKeys[t]);if(this.indicatorsAsCol=l,this.indicators=n,this.customColTree=h,this.customRowTree=d,this.hasExtensionRowTree=c,this.parseCustomTreeToMatchRecords=p,this.parseCustomTreeToMatchRecords&&(this.customColTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customColTree,"col"),this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))),this.colGrandTotalLabel=null!=(T=null==(M=null==(A=this.totals)?void 0:A.column)?void 0:M.grandTotalLabel)?T:"总计",this.colSubTotalLabel=null!=(P=null==(R=null==(k=this.totals)?void 0:k.column)?void 0:R.subTotalLabel)?P:"小计",this.rowGrandTotalLabel=null!=(E=null==(I=null==(B=this.totals)?void 0:B.row)?void 0:I.grandTotalLabel)?E:"总计",this.rowSubTotalLabel=null!=(O=null==(F=null==(L=this.totals)?void 0:L.row)?void 0:F.subTotalLabel)?O:"小计",this.collectValuesBy=null==(H=this.dataConfig)?void 0:H.collectValuesBy,this.needSplitPositiveAndNegative=null!=u&&u,this.rowsIsTotal=Array(null!=(z=null==(D=this.rows)?void 0:D.length)?z:0).fill(!1),this.colsIsTotal=Array(null!=(Z=null==(W=this.columns)?void 0:W.length)?Z:0).fill(!1),(null==(N=this.totals)?void 0:N.row)&&!1!==this.totals.row.showSubTotals&&this.totals.row.subTotalsDimensions)for(let t=0,e=null!=(U=null==(V=null==(G=null==(j=this.totals)?void 0:j.row)?void 0:G.subTotalsDimensions)?void 0:V.length)?U:0;t<e;t++){let e=this.totals.row.subTotalsDimensions[t],i=this.rows.indexOf(e);this.rowsIsTotal[i]=!0}if((null==(K=this.totals)?void 0:K.column)&&!1!==this.totals.column.showSubTotals&&this.totals.column.subTotalsDimensions)for(let t=0,e=null!=(q=null==($=null==(Y=null==(X=this.totals)?void 0:X.column)?void 0:Y.subTotalsDimensions)?void 0:$.length)?q:0;t<e;t++){let e=this.totals.column.subTotalsDimensions[t],i=this.columns.indexOf(e);this.colsIsTotal[i]=!0}this.setRecords(s)}setRecords(t){var e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x;this.records=t,this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.tree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.rowsHasValue=[],this.columnsHasValue=[],this.sorted=!1,t&&(this.records=t,"undefined"!=typeof window&&window.performance.now(),this.processRecords(),this.processCollectedValuesWithSumBy(),this.generateCollectedValuesSortRule(),this.processCollectedValuesWithSortBy(),"undefined"!=typeof window&&window.performance.now(),"undefined"!=typeof window&&window.performance.now(),this.totalStatistics(),"undefined"!=typeof window&&window.performance.now(),this.rowKeys_normal=this.rowKeys.slice(),this.colKeys_normal=this.colKeys.slice(),"undefined"!=typeof window&&window.performance.now(),this.sortKeys(),"undefined"!=typeof window&&window.performance.now(),"undefined"!=typeof window&&window.performance.now(),this.customRowTree?this.rowHeaderTree=this.customRowTree:"tree"===this.rowHierarchyType?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((t,e)=>this.rowsHasValue[e]),this.indicatorsAsCol?void 0:this.indicators,(null==(i=null==(e=this.totals)?void 0:e.row)?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,null!=(l=null==(n=null==(r=this.totals)?void 0:r.row)?void 0:n.showGrandTotalsOnTop)&&l):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((t,e)=>this.rowsHasValue[e]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,(null==(a=null==(s=this.totals)?void 0:s.row)?void 0:a.showGrandTotals)||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,this.rowSubTotalLabel,null!=(d=null==(h=null==(o=this.totals)?void 0:o.row)?void 0:h.showGrandTotalsOnTop)&&d,null!=(p=null==(c=null==(u=this.totals)?void 0:u.row)?void 0:c.showSubTotalsOnTop)&&p),this.customColTree?this.colHeaderTree=this.customColTree:this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((t,e)=>this.columnsHasValue[e]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,(null==(f=null==(g=this.totals)?void 0:g.column)?void 0:f.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length,this.colGrandTotalLabel,this.colSubTotalLabel,null!=(v=null==(y=null==(m=this.totals)?void 0:m.column)?void 0:y.showGrandTotalsOnLeft)&&v,null!=(C=null==(_=null==(b=this.totals)?void 0:b.column)?void 0:_.showSubTotalsOnLeft)&&C),"undefined"!=typeof window&&window.performance.now(),(null==(x=this.dataConfig)?void 0:x.isPivotChart)&&this.cacheDeminsionCollectedValues())}registerAggregator(t,e){l.YJ[t]=e}registerAggregators(){this.registerAggregator(n.E.RECORD,l.hT),this.registerAggregator(n.E.SUM,l.__),this.registerAggregator(n.E.COUNT,l.ZP),this.registerAggregator(n.E.MAX,l.Fn),this.registerAggregator(n.E.MIN,l.NF),this.registerAggregator(n.E.AVG,l.ky),this.registerAggregator(n.E.NONE,l.ld),this.registerAggregator(n.E.RECALCULATE,l.U4),this.registerAggregator(n.E.CUSTOM,l.Js)}processCollectedValuesWithSumBy(){var t,e,i,r,n,l;for(let s in this.collectedValues)if(null==(e=null==(t=this.collectValuesBy)?void 0:t[s])?void 0:e.sumBy)for(let t in this.collectedValues[s]){let e,a,o;"sum"===(null==(i=this.collectValuesBy[s])?void 0:i.extendRange)?(e=Object.values(this.collectedValues[s][t]).reduce((t,e)=>t+e.value(),0),e+=Math.round(e/20)):(e=Object.values(this.collectedValues[s][t]).reduce((t,e)=>e.value()>t?e.value():t,Number.MIN_SAFE_INTEGER),"max"===(null==(r=this.collectValuesBy[s])?void 0:r.extendRange)?e+=Math.round(e/20):"number"==typeof(null==(n=this.collectValuesBy[s])?void 0:n.extendRange)&&(e=Math.max(e,null==(l=this.collectValuesBy[s])?void 0:l.extendRange)));let h=Object.values(this.collectedValues[s][t]).reduce((t,e)=>e.value()<t?e.value():t,Number.MAX_SAFE_INTEGER);this.needSplitPositiveAndNegative&&(a=Object.values(this.collectedValues[s][t]).reduce((t,e)=>e.positiveValue()>t?e.positiveValue():t,Number.MIN_SAFE_INTEGER),o=Object.values(this.collectedValues[s][t]).reduce((t,e)=>e.negativeValue()<t?e.negativeValue():t,Number.MAX_SAFE_INTEGER)),this.collectedValues[s][t]={},this.collectedValues[s][t].max=e,this.collectedValues[s][t].min=h,this.needSplitPositiveAndNegative&&(this.collectedValues[s][t].positiveMax=a,this.collectedValues[s][t].negativeMin=o)}}processCollectedValuesWithSortBy(){var t,e;let i=this;for(let r in this.collectedValues)if(null==(e=null==(t=this.collectValuesBy)?void 0:t[r])?void 0:e.sortBy)for(let t in this.collectedValues[r])this.collectedValues[r][t]=this.collectedValues[r][t].sort((t,e)=>{var n,l,s,a;return(null!=(l=null==(n=i.collectValuesBy[r].sortBy)?void 0:n.indexOf(t))?l:-1)-(null!=(a=null==(s=i.collectValuesBy[r].sortBy)?void 0:s.indexOf(e))?a:-1)})}generateCollectedValuesSortRule(){for(let t in this.collectedValues)if(this.collectValuesBy&&this.collectValuesBy[t]&&!this.collectValuesBy[t].sortBy){let e=[];for(let i in this.collectedValues[t])Array.isArray(this.collectedValues[t][i])&&(e.push(...this.collectedValues[t][i]),e=Array.from(new Set(e)));e.length>0&&(this.collectValuesBy[t].sortBy=e)}}processRecords(){var t,e;let i=!1;if((null!=(e=null==(t=this.filterRules)?void 0:t.length)?e:0)>=1&&(i=!0),Array.isArray(this.records)){this.filteredRecords||(this.filteredRecords=[]);for(let t=0,e=this.records.length;t<e;t++){let e=this.records[t];i&&!this.filterRecord(e)||(this.filteredRecords.push(e),e&&this.processRecord(e))}}else for(let t in this.filteredRecords||(this.filteredRecords={}),this.records)for(let e=0,r=this.records[t].length;e<r;e++){let r=this.records[t][e];i&&!this.filterRecord(r)||(this.filteredRecords[t]||(this.filteredRecords[t]=[]),this.filteredRecords[t].push(r),this.processRecord(r,t))}this.rowFlatKeys={},this.colFlatKeys={}}filterRecord(t){var e,i;let r=!0;if(this.filterRules)for(let n=0;n<this.filterRules.length;n++){let l=this.filterRules[n];if(l.filterKey){let i=t[l.filterKey];if(-1===(null==(e=l.filteredValues)?void 0:e.indexOf(i))){r=!1;break}}else if(!(null==(i=l.filterFunc)?void 0:i.call(l,t))){r=!1;break}}return r}processRecord(t,e){var i,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X,Y,$,q,J,Q,te,ti,tr,tn,tl,ts,ta,to,th,td,tu,tc,tp,tg,tf,tm,ty,tv,tb;for(let e in null==(i=this.derivedFieldRules)||i.forEach((e,i)=>{e.fieldName&&e.derivedFunc&&(t[e.fieldName]=e.derivedFunc(t))}),this.collectValuesBy)if((0,r.Z)(t[e])){this.collectedValues[e]||(this.collectedValues[e]={});let i=this.collectValuesBy[e].by.map(e=>t[e]).join(this.stringJoinChar);if(this.collectedValues[e][i]||(this.collectValuesBy[e].sumBy?this.collectedValues[e][i]={}:this.collectValuesBy[e].range?this.collectedValues[e][i]={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}:this.collectedValues[e][i]=[]),this.collectValuesBy[e].sumBy){let r=null==(o=this.collectValuesBy[e].sumBy)?void 0:o.map(e=>t[e]).join(this.stringJoinChar);this.collectedValues[e][i][r]||(this.collectedValues[e][i][r]=new l.YJ[n.E.SUM]({key:e,field:e,isRecord:void 0,needSplitPositiveAndNegative:this.needSplitPositiveAndNegative})),this.collectedValues[e][i][r].push(t)}else if(this.collectValuesBy[e].range){let r=this.collectedValues[e][i],n=Math.max(t[e],r.max),l=Math.min(t[e],r.min);if(this.collectValuesBy[e].considerFields)for(let i of this.collectValuesBy[e].considerFields)t[i]&&("number"==typeof t[i]?(n=Math.max(t[i],n),l=Math.min(t[i],l)):Array.isArray(t[i])&&(n=Math.max(...t[i],n),l=Math.min(...t[i],l)));isNaN(n)||(r.max=n,r.min=l)}else{let r=this.collectedValues[e][i];-1===r.indexOf(t[e])&&r.push(t[e])}}let t_=!1,tC=[],tx=[];if(!this.parseCustomTreeToMatchRecords||(null==(h=this.dataConfig)?void 0:h.isPivotChart)||!(null==(d=this.customRowTree)?void 0:d.length)||e||this.hasExtensionRowTree){let i=[];tx.push({rowKey:i,indicatorKey:e});for(let e=0,r=this.rows.length;e<r;e++){let r=this.rows[e];if(r in t)this.rowsHasValue[e]=!0,i.push(t[r]);else if(r!==s.ek){if((null==(p=null==(c=null==(u=this.dataConfig)?void 0:u.totals)?void 0:c.row)?void 0:p.showGrandTotals)&&0===e&&!this.rows.find(e=>e in t)){i.push(this.rowGrandTotalLabel),t_=!0;break}if((null==(m=null==(f=null==(g=this.dataConfig)?void 0:g.totals)?void 0:f.row)?void 0:m.subTotalsDimensions)&&(null==(b=null==(v=null==(y=this.dataConfig)?void 0:y.totals)?void 0:v.row)?void 0:b.subTotalsDimensions.indexOf(this.rows[e-1]))>=0){"tree"!==this.rowHierarchyType&&i.push(this.rowSubTotalLabel),t_=!0;break}}}}else{let e=this.getFieldMatchRowDimensionPaths(t);if(e.length>0)for(let t=0,i=e.length;t<i;t++){let i,n=e[t],l=[];for(let t=0,e=n.length;t<e;t++)(0,r.Z)(n[t].indicatorKey)?i=n[t].indicatorKey:l.push(n[t].value);tx.push({rowKey:l,indicatorKey:i})}}if(!this.parseCustomTreeToMatchRecords||(null==(_=this.dataConfig)?void 0:_.isPivotChart)||!(null==(C=this.customColTree)?void 0:C.length)||e||this.hasExtensionRowTree){let i=[];tC.push({colKey:i,indicatorKey:e});for(let e=0,r=this.columns.length;e<r;e++){let r=this.columns[e];if(r in t)this.columnsHasValue[e]=!0,i.push(t[r]);else if(r!==s.ek){if((null==(S=null==(w=null==(x=this.dataConfig)?void 0:x.totals)?void 0:w.column)?void 0:S.showGrandTotals)&&0===e&&!this.columns.find(e=>e in t)){i.push(this.colGrandTotalLabel),t_=!0;break}if((null==(T=null==(M=null==(A=this.dataConfig)?void 0:A.totals)?void 0:M.column)?void 0:T.subTotalsDimensions)&&(null==(P=null==(R=null==(k=this.dataConfig)?void 0:k.totals)?void 0:R.column)?void 0:P.subTotalsDimensions.indexOf(this.columns[e-1]))>=0){i.push(this.colSubTotalLabel),t_=!0;break}}}}else{let e=this.getFieldMatchColDimensionPaths(t);if(e.length>0)for(let t=0,i=e.length;t<i;t++){let i,n=e[t],l=[];for(let t=0,e=n.length;t<e;t++)(0,r.Z)(n[t].indicatorKey)?i=n[t].indicatorKey:l.push(n[t].value);tC.push({colKey:l,indicatorKey:i})}}for(let i=0;i<tx.length;i++){let r,s=tx[i].rowKey;this.indicatorsAsCol||(r=tx[i].indicatorKey);for(let i=0;i<tC.length;i++){let o=tC[i].colKey;this.indicatorsAsCol&&(r=tC[i].indicatorKey);let h=a(s,this.stringJoinChar),d=a(o,this.stringJoinChar);if(t_){this.totalRecordsTree[h]||(this.totalRecordsTree[h]={}),this.totalRecordsTree[h][d]||(this.totalRecordsTree[h][d]=[]);let e=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let i=0;i<e.length;i++)if(this.calculatedFiledKeys.indexOf(e[i])>=0){let r=null==(B=this.calculatedFieldRules)?void 0:B.find(t=>t.key===e[i]);(null==(E=null==(I=this.totalRecordsTree[h])?void 0:I[d])?void 0:E[i])||(this.totalRecordsTree[h][d][i]=new l.YJ[n.E.RECALCULATE]({key:e[i],field:e[i],isRecord:!0,formatFun:null==(F=null==(L=this.indicators)?void 0:L.find(t=>"string"!=typeof t&&t.indicatorKey===e[i]))?void 0:F.format,calculateFun:null==r?void 0:r.calculateFun,dependAggregators:this.totalRecordsTree[h][d],dependIndicatorKeys:null==r?void 0:r.dependIndicatorKeys})),e[i]in t&&(null==(H=null==(O=this.totalRecordsTree[h])?void 0:O[d])||H[i].push(t))}else{let r=this.getAggregatorRule(e[i]);(null==(z=null==(D=this.totalRecordsTree[h])?void 0:D[d])?void 0:z[i])||(this.totalRecordsTree[h][d][i]=new l.YJ[null!=(W=null==r?void 0:r.aggregationType)?W:n.E.SUM]({key:e[i],field:null!=(Z=null==r?void 0:r.field)?Z:e[i],aggregationFun:null==r?void 0:r.aggregationFun,formatFun:null!=(N=null==r?void 0:r.formatFun)?N:null==(G=null==(j=this.indicators)?void 0:j.find(t=>"string"!=typeof t&&t.indicatorKey===e[i]))?void 0:G.format})),e[i]in t&&(null==(U=null==(V=this.totalRecordsTree[h])?void 0:V[d])||U[i].push(t))}return}0!==s.length&&(this.rowFlatKeys[h]||(this.rowKeys.push(s),this.rowFlatKeys[h]=1)),0!==o.length&&(this.colFlatKeys[d]||(this.colKeys.push(o),this.colFlatKeys[d]=1)),this.tree[h]||(this.tree[h]={}),(null==(K=this.tree[h])?void 0:K[d])||(this.tree[h][d]=[]);let u=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let i=0;i<u.length;i++)if(this.calculatedFiledKeys.indexOf(u[i])>=0){let e=null==(X=this.calculatedFieldRules)?void 0:X.find(t=>t.key===u[i]);(null==($=null==(Y=this.tree[h])?void 0:Y[d])?void 0:$[i])||(this.tree[h][d][i]=new l.YJ[n.E.RECALCULATE]({key:u[i],field:u[i],isRecord:!0,formatFun:null==(J=null==(q=this.indicators)?void 0:q.find(t=>"string"!=typeof t&&t.indicatorKey===u[i]))?void 0:J.format,calculateFun:null==e?void 0:e.calculateFun,dependAggregators:this.tree[h][d],dependIndicatorKeys:null==e?void 0:e.dependIndicatorKeys})),null==(te=null==(Q=this.tree[h])?void 0:Q[d])||te[i].push(t)}else{let s=this.getAggregatorRule(u[i]),a=!1;r?e===r?u[i]===r&&(a=!0):u[i]===r&&u[i]in t&&(a=!0):(null==s?void 0:s.field)?"string"==typeof(null==s?void 0:s.field)?(null==s?void 0:s.field)in t&&(a=!0):(null==s?void 0:s.field.find(e=>e in t))&&(a=!0):u[i]in t&&(a=!0),(null==(tr=null==(ti=this.tree[h])?void 0:ti[d])?void 0:tr[i])||!a||(this.tree[h][d][i]=new l.YJ[null!=(tn=null==s?void 0:s.aggregationType)?tn:n.E.SUM]({key:u[i],field:null!=(tl=null==s?void 0:s.field)?tl:u[i],aggregationFun:null==s?void 0:s.aggregationFun,formatFun:null!=(ts=null==s?void 0:s.formatFun)?ts:null==(to=null==(ta=this.indicators)?void 0:ta.find(t=>"string"!=typeof t&&t.indicatorKey===u[i]))?void 0:to.format})),a&&(null==(td=null==(th=this.tree[h])?void 0:th[d])||td[i].push(t))}if(this.mappingRules)for(let e=0;e<this.indicatorKeys.length;e++){if(!this.indicatorStatistics[e]){let t=this.getAggregatorRule(this.indicatorKeys[e]);this.indicatorStatistics[e]={max:new l.YJ[n.E.MAX]({key:this.indicatorKeys[e],field:this.indicatorKeys[e]}),min:new l.YJ[n.E.MIN]({key:this.indicatorKeys[e],field:this.indicatorKeys[e]}),total:new l.YJ[null!=(tu=null==t?void 0:t.aggregationType)?tu:n.E.SUM]({key:this.indicatorKeys[e],field:null!=(tc=null==t?void 0:t.field)?tc:this.indicatorKeys[e],aggregationFun:null==t?void 0:t.aggregationFun,formatFun:null!=(tp=null==t?void 0:t.formatFun)?tp:null==(tf=null==(tg=this.indicators)?void 0:tg.find(t=>"string"!=typeof t&&t.indicatorKey===this.indicatorKeys[e]))?void 0:tf.format})}}this.indicatorStatistics[e].max.push(null==(ty=null==(tm=this.tree[h])?void 0:tm[d])?void 0:ty[e].value()),this.indicatorStatistics[e].min.push(null==(tb=null==(tv=this.tree[h])?void 0:tv[d])?void 0:tb[e].value()),this.indicatorStatistics[e].total.push(t)}}}}updateSortRules(t){var e,i,r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C;this.sorted=!1,this.sortRules=t,this.sortKeys(),this.customRowTree||("tree"===this.rowHierarchyType?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((t,e)=>this.rowsHasValue[e]),this.indicatorsAsCol?void 0:this.indicators,(null==(i=null==(e=this.totals)?void 0:e.row)?void 0:i.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,null!=(l=null==(n=null==(r=this.totals)?void 0:r.row)?void 0:n.showGrandTotalsOnTop)&&l):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((t,e)=>this.rowsHasValue[e]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,(null==(a=null==(s=this.totals)?void 0:s.row)?void 0:a.showGrandTotals)||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,this.rowSubTotalLabel,null!=(d=null==(h=null==(o=this.totals)?void 0:o.row)?void 0:h.showGrandTotalsOnTop)&&d,null!=(p=null==(c=null==(u=this.totals)?void 0:u.row)?void 0:c.showSubTotalsOnTop)&&p)),this.customColTree||(this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((t,e)=>this.columnsHasValue[e]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,(null==(f=null==(g=this.totals)?void 0:g.column)?void 0:f.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length,this.colGrandTotalLabel,this.colSubTotalLabel,null!=(v=null==(y=null==(m=this.totals)?void 0:m.column)?void 0:y.showGrandTotalsOnLeft)&&v,null!=(C=null==(_=null==(b=this.totals)?void 0:b.column)?void 0:_.showSubTotalsOnLeft)&&C))}updateFilterRules(t,e=!1){var i,r;if(this.filterRules=t,this.filteredRecords=void 0,e)return this.setRecords(this.records);for(let t in this.tree)for(let e in this.tree[t])for(let r=0;r<this.tree[t][e].length;r++)null==(i=this.tree[t][e][r])||i.reset();this.collectedValues={},this.processRecords(),this.processCollectedValuesWithSumBy(),this.processCollectedValuesWithSortBy(),this.totalStatistics(),(null==(r=this.dataConfig)?void 0:r.isPivotChart)&&this.cacheDeminsionCollectedValues()}getAggregatorRule(t){var e;return null==(e=this.aggregationRules)?void 0:e.find((e,i)=>t===e.indicatorKey)}getAggregator(t=[],e=[],i,n=!0,l){var s,o,h,d,u,c,p,g,f,m,y,v,b,_;let C,x,w,S,A=this.indicatorKeys.indexOf(i);if("row"===(null==l?void 0:l.position))C=t.length>=2?this.rows[t.length-2]:void 0;else{let e=t.length-1;C=e>=0&&e<this.rows.length?this.rows[e]:void 0}if("col"===(null==l?void 0:l.position))x=e.length>=2?this.columns[e.length-2]:void 0;else{let t=e.length-1;x=t>=0&&t<this.columns.length?this.columns[t]:void 0}"string"==typeof t?w=t:(l&&"row"!==l.position||t.map((e,n)=>{e!==i||(0,r.Z)(null==l?void 0:l.index)&&n!==l.index||t.splice(n,1)}),t.length<this.rows.length&&"grid-tree"===this.rowHierarchyType&&(t[0]===this.rowGrandTotalLabel||(null==(o=null==(s=this.totals)?void 0:s.row)?void 0:o.subTotalsDimensions)&&(null==(u=null==(d=null==(h=this.totals)?void 0:h.row)?void 0:d.subTotalsDimensions)?void 0:u.length)>=1&&t[t.length-1]!==this.rowSubTotalLabel&&this.totals.row.subTotalsDimensions.find(t=>t===C)&&t.push(this.rowSubTotalLabel)),w=a(t,this.stringJoinChar)),"string"==typeof e?S=e:(l&&"col"!==l.position||e.map((t,n)=>{t!==i||(0,r.Z)(null==l?void 0:l.index)&&n!==l.index||e.splice(n,1)}),e.length<this.columns.length&&"grid-tree"===this.columnHierarchyType&&(e[0]===this.colGrandTotalLabel||(null==(p=null==(c=this.totals)?void 0:c.column)?void 0:p.subTotalsDimensions)&&(null==(m=null==(f=null==(g=this.totals)?void 0:g.column)?void 0:f.subTotalsDimensions)?void 0:m.length)>=1&&e[e.length-1]!==this.colSubTotalLabel&&this.totals.column.subTotalsDimensions.find(t=>t===x)&&e.push(this.colSubTotalLabel)),S=a(e,this.stringJoinChar));let M=null==(v=null==(y=this.tree[w])?void 0:y[S])?void 0:v[A];if(n&&(0,r.Z)(null==(_=null==(b=this.changedTree[w])?void 0:b[S])?void 0:_[A])){let t=this.changedTree[w][S][A];return M?{value:()=>t,formatValue:M.formatValue,formatFun:M.formatFun,records:M.records,recalculate(){},push(){},deleteRecord(){},updateRecord(){},clearCacheValue(){},reset(){}}:{records:[],value:()=>t,push(){},deleteRecord(){},updateRecord(){},recalculate(){},formatValue:()=>t,clearCacheValue(){},reset(){}}}return M||{records:[],push(){},deleteRecord(){},updateRecord(){},recalculate(){},value:()=>null,clearCacheValue(){},reset(){}}}sortKeys(){if(this.colKeys=this.colKeys_normal.slice(),this.rowKeys=this.rowKeys_normal.slice(),!this.sorted){this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rows,!0));let t=this.arrSort(this.columns,!1);this.colKeys.sort(t)}}arrSort(t,e){let i,r=this,n=(function(n){let l=[];for(let n=0,s=t.length;n<s;n++)if(i=t[n],r.sortRules)for(let t=0,s=r.sortRules.length;t<s;t++)r.sortRules[t].sortField===i&&l.push({field:i,fieldIndex:n,sortRule:r.sortRules[t],func:r.getSort(r.sortRules[t],e)});return l}).call(this);return function(i,l){var s,a,o,h;let d,u;for(let c=0;c<n.length;c++){if(null==(s=(u=n[c]).sortRule)?void 0:s.sortByIndicator){let n=i,s=l;u.fieldIndex<t.length-1&&(n=i.slice(0,u.fieldIndex+1),"grid"===r.rowHierarchyType&&e?n.push(r.rowSubTotalLabel):e||n.push(r.colSubTotalLabel),s=l.slice(0,u.fieldIndex+1),"grid"===r.rowHierarchyType&&e?s.push(r.rowSubTotalLabel):e||s.push(r.colSubTotalLabel)),d=u.func(n,s,null==(a=u.sortRule)?void 0:a.sortType)}else d=null==(o=u.func)?void 0:o.call(u,i[u.fieldIndex],l[u.fieldIndex],null==(h=u.sortRule)?void 0:h.sortType);if(0!==d)return d}return 0}}getSort(t,e){let i=this;return t.sortByIndicator?(r,n,s)=>{let a=function(e,r){return"grid"===i.rowHierarchyType&&e.length<i.rows.length&&e[e.length-1]!==i.rowSubTotalLabel&&e[e.length-1]!==i.rowGrandTotalLabel&&e.push(i.rowSubTotalLabel),r.length<i.columns.length&&r[r.length-1]!==i.colSubTotalLabel&&r[r.length-1]!==i.colGrandTotalLabel&&r.push(i.colSubTotalLabel),i.getAggregator(e,r,t.sortByIndicator).value()};return e?t.sortFunc?t.sortFunc(a(r,t.query),a(n,t.query),r,n,s):(0,l.SL)(a(r,t.query),a(n,t.query),s):t.sortFunc?t.sortFunc(a(t.query,r),a(t.query,n),r,n,s):(0,l.SL)(a(t.query,r),a(t.query,n),s)}:t.sortBy?(0,l.MR)(t.sortBy):t.sortFunc?t.sortFunc:t.sortType?l.y4:l.SL}totalStatistics(){var t,e,i,r,s,a,o,h,d,u,c,p,g,f;let m=this,y=(t,e)=>{var i,r,s,a,o,h,d,u,c,p,g,f,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X,Y,$,q,J,Q,te;if(null==(r=null==(i=this.totalRecordsTree)?void 0:i[t])?void 0:r[e])return this.tree[t]||(this.tree[t]={}),void(this.tree[t][e]=null==(a=null==(s=this.totalRecordsTree)?void 0:s[t])?void 0:a[e]);let ti=e.split(this.stringJoinChar);if((null==(h=null==(o=m.totals)?void 0:o.column)?void 0:h.subTotalsDimensions)&&(null==(c=null==(u=null==(d=m.totals)?void 0:d.column)?void 0:u.subTotalsDimensions)?void 0:c.length)>0&&!1!==m.totals.column.showSubTotals)for(let i=0,r=null==(f=null==(g=null==(p=m.totals)?void 0:p.column)?void 0:g.subTotalsDimensions)?void 0:f.length;i<r;i++){let r=m.totals.column.subTotalsDimensions[i],s=m.columns.indexOf(r);if(s>=0){let i=ti.slice(0,s+1);i.push(m.colSubTotalLabel);let r=i.join(this.stringJoinChar);if(null==(v=null==(y=this.totalRecordsTree)?void 0:y[t])?void 0:v[r])return void(this.tree[t][r]=null==(_=null==(b=this.totalRecordsTree)?void 0:b[t])?void 0:_[r]);this.tree[t][r]||(this.tree[t][r]=[]);let a=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let i=0;i<a.length;i++)if(this.calculatedFiledKeys.indexOf(a[i])>=0){let s=null==(C=this.calculatedFieldRules)?void 0:C.find(t=>t.key===a[i]);(null==(w=null==(x=this.tree[t])?void 0:x[r])?void 0:w[i])||(this.tree[t][r][i]=new l.YJ[n.E.RECALCULATE]({key:a[i],field:a[i],isRecord:!0,formatFun:null==(A=null==(S=this.indicators)?void 0:S.find(t=>"string"!=typeof t&&t.indicatorKey===a[i]))?void 0:A.format,calculateFun:null==s?void 0:s.calculateFun,dependAggregators:this.tree[t][r],dependIndicatorKeys:null==s?void 0:s.dependIndicatorKeys})),r!==e&&this.tree[t][r][i].push(null==(T=null==(M=m.tree[t])?void 0:M[e])?void 0:T[i])}else{if(!this.tree[t][r][i]){let e=this.getAggregatorRule(a[i]);this.tree[t][r][i]=new l.YJ[null!=(k=null==e?void 0:e.aggregationType)?k:n.E.SUM]({key:a[i],field:null!=(R=null==e?void 0:e.field)?R:a[i],aggregationFun:null==e?void 0:e.aggregationFun,formatFun:null!=(P=null==e?void 0:e.formatFun)?P:null==(I=null==(B=this.indicators)?void 0:B.find(t=>"string"!=typeof t&&t.indicatorKey===a[i]))?void 0:I.format})}r!==e&&this.tree[t][r][i].push(null==(L=null==(E=m.tree[t])?void 0:E[e])?void 0:L[i])}}}if((null==(O=null==(F=m.totals)?void 0:F.column)?void 0:O.showGrandTotals)||0===this.rows.length){let i=m.colGrandTotalLabel;if(null==(D=null==(H=this.totalRecordsTree)?void 0:H[t])?void 0:D[i])return void(this.tree[t][i]=null==(W=null==(z=this.totalRecordsTree)?void 0:z[t])?void 0:W[i]);this.tree[t][i]||(this.tree[t][i]=[]);let r=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let s=0;s<r.length;s++)if(this.calculatedFiledKeys.indexOf(r[s])>=0){let a=null==(Z=this.calculatedFieldRules)?void 0:Z.find(t=>t.key===r[s]);(null==(j=null==(N=this.tree[t])?void 0:N[i])?void 0:j[s])||(this.tree[t][i][s]=new l.YJ[n.E.RECALCULATE]({key:r[s],field:r[s],isRecord:!0,formatFun:null==(V=null==(G=this.indicators)?void 0:G.find(t=>"string"!=typeof t&&t.indicatorKey===r[s]))?void 0:V.format,calculateFun:null==a?void 0:a.calculateFun,dependAggregators:this.tree[t][i],dependIndicatorKeys:null==a?void 0:a.dependIndicatorKeys})),i!==e&&this.tree[t][i][s].push(null==(K=null==(U=m.tree[t])?void 0:U[e])?void 0:K[s])}else{if(!this.tree[t][i][s]){let e=this.getAggregatorRule(r[s]);this.tree[t][i][s]=new l.YJ[null!=(X=null==e?void 0:e.aggregationType)?X:n.E.SUM]({key:r[s],field:null!=(Y=null==e?void 0:e.field)?Y:r[s],formatFun:null!=($=null==e?void 0:e.formatFun)?$:null==(J=null==(q=this.indicators)?void 0:q.find(t=>"string"!=typeof t&&t.indicatorKey===r[s]))?void 0:J.format})}i!==e&&this.tree[t][i][s].push(null==(te=null==(Q=m.tree[t])?void 0:Q[e])?void 0:te[s])}}};if((null==(e=null==(t=null==m?void 0:m.totals)?void 0:t.column)?void 0:e.subTotalsDimensions)&&(null==(s=null==(r=null==(i=null==m?void 0:m.totals)?void 0:i.column)?void 0:r.subTotalsDimensions)?void 0:s.length)>=1||(null==(o=null==(a=null==m?void 0:m.totals)?void 0:a.row)?void 0:o.subTotalsDimensions)&&(null==(u=null==(d=null==(h=null==m?void 0:m.totals)?void 0:h.row)?void 0:d.subTotalsDimensions)?void 0:u.length)>=1||(null==(p=null==(c=null==m?void 0:m.totals)?void 0:c.column)?void 0:p.showGrandTotals)||(null==(f=null==(g=null==m?void 0:m.totals)?void 0:g.row)?void 0:f.showGrandTotals)){let t=[];Object.keys(m.tree).forEach(e=>{let i=e.split(this.stringJoinChar);Object.keys(m.tree[e]).forEach(r=>{var s,a,o,h,d,u,c,p,g,f,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F,O,H;if((null==(a=null==(s=m.totals)?void 0:s.row)?void 0:a.subTotalsDimensions)&&(null==(d=null==(h=null==(o=m.totals)?void 0:o.row)?void 0:h.subTotalsDimensions)?void 0:d.length)>0&&!1!==m.totals.row.showSubTotals)for(let s=0,a=null==(p=null==(c=null==(u=m.totals)?void 0:u.row)?void 0:c.subTotalsDimensions)?void 0:p.length;s<a;s++){let a=m.totals.row.subTotalsDimensions[s],o=m.rows.indexOf(a);if(o>=0&&o<m.rows.length-1){let s=i.slice(0,o+1);"tree"!==this.rowHierarchyType&&s.push(m.rowSubTotalLabel);let a=s.join(this.stringJoinChar);this.tree[a]||(this.tree[a]={},t.push(a)),this.tree[a][r]||(this.tree[a][r]=[]);let h=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<h.length;t++){if(!this.tree[a][r][t])if(this.calculatedFiledKeys.indexOf(h[t])>=0){let e=null==(g=this.calculatedFieldRules)?void 0:g.find(e=>e.key===h[t]);this.tree[a][r][t]=new l.YJ[n.E.RECALCULATE]({key:h[t],field:h[t],isRecord:!0,formatFun:null==(v=null==(f=this.indicators)?void 0:f.find(e=>"string"!=typeof e&&e.indicatorKey===h[t]))?void 0:v.format,calculateFun:null==e?void 0:e.calculateFun,dependAggregators:this.tree[a][r],dependIndicatorKeys:null==e?void 0:e.dependIndicatorKeys})}else{let e=this.getAggregatorRule(h[t]);this.tree[a][r][t]=new l.YJ[null!=(b=null==e?void 0:e.aggregationType)?b:n.E.SUM]({key:h[t],field:null!=(_=null==e?void 0:e.field)?_:h[t],formatFun:null!=(C=null==e?void 0:e.formatFun)?C:null==(w=null==(x=this.indicators)?void 0:x.find(e=>"string"!=typeof e&&e.indicatorKey===h[t]))?void 0:w.format})}a!==e&&this.tree[a][r][t].push(null==(A=null==(S=m.tree[e])?void 0:S[r])?void 0:A[t])}}}if((null==(T=null==(M=m.totals)?void 0:M.row)?void 0:T.showGrandTotals)||0===this.columns.length){let i=m.rowGrandTotalLabel;this.tree[i]||(this.tree[i]={},t.push(i)),this.tree[i][r]||(this.tree[i][r]=[]);let s=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<s.length;t++){if(!this.tree[i][r][t])if(this.calculatedFiledKeys.indexOf(s[t])>=0){let e=null==(k=this.calculatedFieldRules)?void 0:k.find(e=>e.key===s[t]);this.tree[i][r][t]=new l.YJ[n.E.RECALCULATE]({key:s[t],field:s[t],isRecord:!0,formatFun:null==(P=null==(R=this.indicators)?void 0:R.find(e=>"string"!=typeof e&&e.indicatorKey===s[t]))?void 0:P.format,calculateFun:null==e?void 0:e.calculateFun,dependAggregators:this.tree[i][r],dependIndicatorKeys:null==e?void 0:e.dependIndicatorKeys})}else{let e=this.getAggregatorRule(s[t]);this.tree[i][r][t]=new l.YJ[null!=(B=null==e?void 0:e.aggregationType)?B:n.E.SUM]({key:s[t],field:null!=(I=null==e?void 0:e.field)?I:s[t],formatFun:null!=(E=null==e?void 0:e.formatFun)?E:null==(F=null==(L=this.indicators)?void 0:L.find(e=>"string"!=typeof e&&e.indicatorKey===s[t]))?void 0:F.format})}i!==e&&this.tree[i][r][t].push(null==(H=null==(O=m.tree[e])?void 0:O[r])?void 0:H[t])}}y(e,r)})}),t.forEach(t=>{Object.keys(m.tree[t]).forEach(e=>{y(t,e)})})}for(let t in m.totalRecordsTree)for(let e in m.totalRecordsTree[t])y(t,e)}ArrToTree1(t,e,i,r,n,l){let s=[],a=this.stringJoinChar,o=new Map;function h(t,r){let n,h=[];t.forEach((d,u)=>{var c;h.push(d);let p=h.join(a),g=o.get(p);g||(g={value:d,dimensionKey:e[u],children:u===t.length-1&&(null!=(c=null==i?void 0:i.length)?c:0)>=1?null==i?void 0:i.map(t=>"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:t.title}):[]},o.set(p,g),n?n.children.push(g):l&&r?s.unshift(g):s.push(g)),n=g})}return t.forEach(t=>h(t,!1)),r&&h([n],r),s}ArrToTree(t,e,i,r,n,l,s,a,o){var h;let d=[],u=this.stringJoinChar,c=new Map;if((null==t?void 0:t.length)?t.forEach(t=>(function(t){let n,l=[];t.forEach((a,h)=>{var p,g,f,m;l.push(a);let y=l.join(u),v=c.get(y);if(!v){if(v={value:a,dimensionKey:e[h],children:h===t.length-1&&(null!=(p=null==i?void 0:i.length)?p:0)>=1?null==i?void 0:i.map(t=>"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:t.title}):[]},r[h]){let t=null!=(g=v.children)?g:[],n={value:s,dimensionKey:e[h+1],levelSpan:r.length-h-1,children:(null!=(f=null==i?void 0:i.length)?f:0)>=1?null==i?void 0:i.map(t=>"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:t.title}):[],role:"sub-total"};t.push(n),t=null!=(m=n.children)?m:[]}c.set(y,v),n?r[h-1]&&!o?n.children.splice(n.children.length-1,0,v):n.children.push(v):d.push(v)}n=v})})(t)):i&&(d=null==i?void 0:i.map(t=>{var e;return"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:null!=(e=t.title)?e:t.indicatorKey}})),n&&(null==t?void 0:t.length)){let t={value:l,dimensionKey:e[0],levelSpan:r.length,children:null!=(h=null==i?void 0:i.map(t=>"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:t.title}))?h:[],role:"grand-total"};a?d.unshift(t):d.push(t)}return d}cacheDeminsionCollectedValues(){for(let t in this.collectValuesBy)"xField"!==this.collectValuesBy[t].type&&"yField"!==this.collectValuesBy[t].type||(this.dataConfig.dimensionSortArray?this.cacheCollectedValues[t]=function(t,e){return t.sort((t,i)=>{let r=e.indexOf(t),n=e.indexOf(i);return r<n?-1:+(r>n)})}(this.collectedValues[t],this.dataConfig.dimensionSortArray):this.cacheCollectedValues[t]=this.collectedValues[t])}changeTreeNodeValue(t=[],e=[],i,r){var n,s,a,o,h;let d,u,c=this.indicatorKeys.indexOf(i);d="string"==typeof t?t:t.join(this.stringJoinChar),u="string"==typeof e?e:e.join(this.stringJoinChar),"string"==typeof r&&(isNaN(parseFloat(r))||(r=parseFloat(r))),(null==(n=this.changedTree[d])?void 0:n[u])||(this.changedTree[d]||(this.changedTree[d]={}),this.changedTree[d][u]=[]),this.changedTree[d][u][c]=r;let p=null==(a=null==(s=this.tree[d])?void 0:s[u])?void 0:a[c];if(1===(null==p?void 0:p.records.length)&&(p.records[0][this.indicatorKeys[c]]=r),null!=(h=null==(o=this.dataConfig)?void 0:o.updateAggregationOnEditCell)&&h)if(p)p.changedValue=r,this.recalculateTotals(t,e,i);else{let n=new l.__({key:i,field:i,isRecord:!0});n.changedValue=r,this.recalculateTotals(t,e,i,n)}}recalculateTotals(t=[],e=[],i,r){var n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F,O,H,D,z;if(!this.totals||0===Object.keys(this.tree).length||!((null==(n=this.totals.row)?void 0:n.showGrandTotals)||(null==(l=this.totals.row)?void 0:l.subTotalsDimensions)&&this.totals.row.subTotalsDimensions.length>0&&!1!==this.totals.row.showSubTotals)&&!((null==(s=this.totals.column)?void 0:s.showGrandTotals)||(null==(a=this.totals.column)?void 0:a.subTotalsDimensions)&&this.totals.column.subTotalsDimensions.length>0&&!1!==this.totals.column.showSubTotals))return;let W=Array.isArray(t)?t.join(this.stringJoinChar):t,Z=Array.isArray(e)?e.join(this.stringJoinChar):e,N=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(i),j=new Set,G=new Set,V=W.split(this.stringJoinChar),U=Z.split(this.stringJoinChar),K=(t,e,i)=>{t&&(e!==W||i!==Z)&&(j.add(t),e!==W&&i!==Z||G.add(t))};if((null==(h=null==(o=this.totals)?void 0:o.row)?void 0:h.subTotalsDimensions)&&!1!==this.totals.row.showSubTotals)for(let t=0;t<this.totals.row.subTotalsDimensions.length;t++){let e=this.totals.row.subTotalsDimensions[t],i=this.rows.indexOf(e);if(i>=0&&i<V.length){let t=V.slice(0,i+1);"tree"!==this.rowHierarchyType&&t.push(this.rowSubTotalLabel);let e=t.join(this.stringJoinChar);if((null==(u=null==(d=this.tree[e])?void 0:d[Z])?void 0:u[N])&&K(this.tree[e][Z][N],e,Z),(null==(p=null==(c=this.totals)?void 0:c.column)?void 0:p.subTotalsDimensions)&&!1!==this.totals.column.showSubTotals)for(let t=0;t<this.totals.column.subTotalsDimensions.length;t++){let i=this.totals.column.subTotalsDimensions[t],r=this.columns.indexOf(i);if(r>=0&&r<U.length){let t=U.slice(0,r+1);t.push(this.colSubTotalLabel);let i=t.join(this.stringJoinChar);(null==(f=null==(g=this.tree[e])?void 0:g[i])?void 0:f[N])&&K(this.tree[e][i][N],e,i)}}(null==(y=null==(m=this.totals)?void 0:m.column)?void 0:y.showGrandTotals)&&(null==(b=null==(v=this.tree[e])?void 0:v[this.colGrandTotalLabel])?void 0:b[N])&&K(this.tree[e][this.colGrandTotalLabel][N],e,this.colGrandTotalLabel)}}if(null==(C=null==(_=this.totals)?void 0:_.row)?void 0:C.showGrandTotals){if(null==(w=null==(x=this.tree[this.rowGrandTotalLabel])?void 0:x[Z])?void 0:w[N]){if(K(this.tree[this.rowGrandTotalLabel][Z][N],this.rowGrandTotalLabel,Z),(null==(A=null==(S=this.totals)?void 0:S.column)?void 0:A.subTotalsDimensions)&&!1!==this.totals.column.showSubTotals)for(let t=0;t<this.totals.column.subTotalsDimensions.length;t++){let e=this.totals.column.subTotalsDimensions[t],i=this.columns.indexOf(e);if(i>=0&&i<U.length){let t=U.slice(0,i+1);t.push(this.colSubTotalLabel);let e=t.join(this.stringJoinChar);(null==(T=null==(M=this.tree[this.rowGrandTotalLabel])?void 0:M[e])?void 0:T[N])&&K(this.tree[this.rowGrandTotalLabel][e][N],this.rowGrandTotalLabel,e)}}(null==(R=null==(k=this.totals)?void 0:k.column)?void 0:R.showGrandTotals)&&(null==(B=null==(P=this.tree[this.rowGrandTotalLabel])?void 0:P[this.colGrandTotalLabel])?void 0:B[N])&&K(this.tree[this.rowGrandTotalLabel][this.colGrandTotalLabel][N],this.rowGrandTotalLabel,this.colGrandTotalLabel)}if((null==(E=null==(I=this.totals)?void 0:I.column)?void 0:E.subTotalsDimensions)&&!1!==this.totals.column.showSubTotals)for(let t=0;t<this.totals.column.subTotalsDimensions.length;t++){let e=this.totals.column.subTotalsDimensions[t],i=this.columns.indexOf(e);if(i>=0&&i<U.length){let t=U.slice(0,i+1);t.push(this.colSubTotalLabel);let e=t.join(this.stringJoinChar);(null==(F=null==(L=this.tree[W])?void 0:L[e])?void 0:F[N])&&K(this.tree[W][e][N],W,e)}}(null==(H=null==(O=this.totals)?void 0:O.column)?void 0:H.showGrandTotals)&&(null==(z=null==(D=this.tree[W])?void 0:D[this.colGrandTotalLabel])?void 0:z[N])&&K(this.tree[W][this.colGrandTotalLabel][N],W,this.colGrandTotalLabel),j.forEach(t=>{r&&G.has(t)&&t.push(r),t.recalculate()})}}changeRecordFieldValue(t,e,i){let r=!1;for(let e=0;e<this.indicatorKeys.length;e++)this.indicatorKeys[e]===t&&(r=!0);if(!r){if(Array.isArray(this.records))for(let r=0,n=this.records.length;r<n;r++){let n=this.records[r];n[t]===e&&(n[t]=i)}else for(let r in this.records)for(let n=0,l=this.records[r].length;n<l;n++){let l=this.records[r][n];l[t]===e&&(l[t]=i)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}_rowTreeHasChanged(){this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))}changeDataConfig(t){this.rows=t.rows,this.columns=t.columns}addRecords(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];this.processRecord(i)}Array.isArray(this.records)&&this.records.push(t)}customTreeToDimensionPathArr(t,e){let i=[],n=this;return null==t||t.forEach(t=>(function t(l,s){var a,o,h;l.virtual||((null==(a=s[s.length-1])?void 0:a.childKeys)&&l.dimensionKey&&-1===s[s.length-1].childKeys.indexOf(l.dimensionKey)&&l.dimensionKey!==s[s.length-1].dimensionKey&&s[s.length-1].childKeys.push(l.dimensionKey),s.push({dimensionKey:(0,r.Z)(l.indicatorKey)?void 0:l.dimensionKey,value:l.value,indicatorKey:l.indicatorKey,virtual:l.virtual})),(null==(o=l.children)?void 0:o.length)>0?("tree"===n.rowHierarchyType&&"row"===e&&(s[s.length-1].childKeys=[],i.push([...s])),null==(h=l.children)||h.forEach(e=>t(e,[...s]))):i.push(s)})(t,[])),i}getFieldMatchColDimensionPaths(t){var e,i;let r=[];for(let n=0;n<(null!=(i=null==(e=this.customColTreeDimensionPaths)?void 0:e.length)?i:0);n++){let e=this.customColTreeDimensionPaths[n],i=!0;for(let r=0;r<e.length;r++){let n=e[r];if(n.dimensionKey&&t[n.dimensionKey]!==n.value||n.indicatorKey&&void 0===t[n.indicatorKey]){i=!1;break}}i&&r.push(e)}return r}getFieldMatchRowDimensionPaths(t){var e,i;let n=[];for(let l=0;l<(null!=(i=null==(e=this.customRowTreeDimensionPaths)?void 0:e.length)?i:0);l++){let e=this.customRowTreeDimensionPaths[l],i=!0;for(let n=0;n<e.length;n++){let l=e[n];if(l.dimensionKey&&t[l.dimensionKey]!==l.value||l.indicatorKey&&void 0===t[l.indicatorKey]||l.childKeys&&n===e.length-1&&l.childKeys.length>0&&l.childKeys.find(e=>(0,r.Z)(t[e]))){i=!1;break}}i&&(this.indicatorsAsCol||"tree"!==this.rowHierarchyType||e.find(t=>t.indicatorKey)||(i=!1)),i&&n.push(e)}return n}}},58710:function(t,e,i){i.d(e,{$:()=>a});var r=i(67331),n=i(53430),l=i(23975),s=i(64776);class a{constructor(t){this.isValidatingValue=!1,this.listenersId=[],this.cacheLastSelectedCellEditor={},this.table=t;let{editCellTrigger:e="doubleclick"}=t.options;this.bindEvent(e)}bindEvent(t){let e=this.table,i=e.on(r.B.DBLCLICK_CELL,i=>{var r,l,s;if(!t.includes("doubleclick"))return;let{col:a,row:o}=i,h=(0,n.RJ)(i.federatedEvent),d=e.scenegraph.getResizeColAt(h.abstractPos.x,h.abstractPos.y,null==(r=h.eventArgs)?void 0:r.targetCell);e._canResizeColumn(d.col,d.row)&&d.col>=0||(null==(s=null==(l=i.target)?void 0:l.attribute)?void 0:s.funcType)||(this.beginTriggerEditCellMode="doubleclick",this.startEditCell(a,o))}),l=e.on(r.B.CLICK_CELL,t=>{var i,r;let{editCellTrigger:n="doubleclick"}=e.options;if("click"===n||Array.isArray(n)&&n.includes("click")){if(null==(r=null==(i=t.target)?void 0:i.attribute)?void 0:r.funcType)return;this.beginTriggerEditCellMode="click";let{col:e,row:n}=t;this.startEditCell(e,n)}else"keydown"===n||Array.isArray(n)&&n.includes("keydown")}),s=e.on(r.B.SELECTED_CHANGED,i=>{let r=e.stateManager.select.ranges;if(1===r.length&&r[0].start.col===r[0].end.col&&r[0].start.row===r[0].end.row&&("keydown"===t||Array.isArray(t)&&t.includes("keydown"))){let{col:t,row:e}=i;this.beginTriggerEditCellMode="keydown";let r=this.table.getCellRangeRelativeRect(this.table.getCellRange(t,e)),n={rect:{left:r.left,top:r.top,width:r.width,height:r.height}};t===this.table.colCount-1?n.rect.width=r.width-1:n.rect.width=r.width+1,e===this.table.rowCount-1?n.rect.height=r.height-1:n.rect.height=r.height+1;let l=this.table.getEditor(t,e);l&&setTimeout(()=>{var i;l&&this.editingEditor!==l&&(null==(i=l.prepareEdit)||i.call(l,{referencePosition:n,container:this.table.getElement(),table:this.table,col:t,row:e}))},10)}});this.listenersId.push(i,l,s)}startEditCell(t,e,i,r){var n,l,a,o,h,d,u,c,p;if(this.editingEditor)return;let g=this.table.getEditor(t,e);if(g){if(r&&g.setElement(r),this.table.internalProps.layoutMap.isSeriesNumber(t,e))return;if(null==(l=null==(n=this.table.internalProps.layoutMap)?void 0:n.isAggregation)?void 0:l.call(n,t,e)){let t=null==(o=(a=this.table).isPivotTable)?void 0:o.call(a),e=!!t&&(null==(d=null==(h=this.table.internalProps)?void 0:h.dataConfig)?void 0:d.updateAggregationOnEditCell);if(!t||t&&e)return}let f=this.table.getCellRawRecord(t,e);if(null==f?void 0:f.vtableMerge)return;this.editingEditor||(this.editCell={col:t,row:e}),this.table._makeVisibleCell(t,e),this.editingEditor=g;let m=(0,s.Z)(i)?i:this.table.getCellOriginValue(t,e),y=this.table.getCellRangeRelativeRect(this.table.getCellRange(t,e)),v={rect:{left:y.left,top:y.top,width:y.width,height:y.height}};t===this.table.colCount-1?v.rect.width=y.width-1:v.rect.width=y.width+1,e===this.table.rowCount-1?v.rect.height=y.height-1:v.rect.height=y.height+1,g.beginEditing,null==(u=g.beginEditing)||u.call(g,this.table.getElement(),v,m),g.bindSuccessCallback,null==(c=g.bindSuccessCallback)||c.call(g,()=>{this.completeEdit()}),null==(p=g.onStart)||p.call(g,{value:m,endEdit:()=>{this.completeEdit()},referencePosition:v,container:this.table.getElement(),col:t,row:e,table:this.table})}}completeEdit(t){var e,i;if(!this.editingEditor)return!0;if(this.isValidatingValue)return!1;this.cacheLastSelectedCellEditor={};let r=null==t?void 0:t.target,{editingEditor:n}=this;if(r){if(n.targetIsOnEditor){if(n.targetIsOnEditor(r))return!1}else if(!n.isEditorElement||n.isEditorElement(r))return!1}if(this.editingEditor.getValue,this.editingEditor.validateValue){this.isValidatingValue=!0;let r=this.editingEditor.getValue(),n=this.table.getCellOriginValue(this.editCell.col,this.editCell.row),s=null==t?void 0:t.target,a=null==(i=(e=this.editingEditor).validateValue)?void 0:i.call(e,r,n,this.editCell,this.table,!!this.table.getElement().contains(s));return(0,l.tI)(a)?(this.isValidatingValue=!0,new Promise((t,e)=>{a.then(e=>{o(e,this,n,t)}).catch(t=>{this.isValidatingValue=!1,e(t)})})):o(a,this,n)}return this.doExit(),!0}doExit(){var t,e,i,r,n,l,s,a;let o=null==(e=(t=this.editingEditor).getValue)?void 0:e.call(t),h=this.table.getCellRange(this.editCell.col,this.editCell.row),d=[];for(let t=h.start.row;t<=h.end.row;t++){let t=[];for(let e=h.start.col;e<=h.end.col;e++)t.push(o);d.push(t)}null==(r=(i=this.editingEditor).beforeEnd)||r.call(i),this.table.changeCellValues(h.start.col,h.start.row,d),this.editingEditor.exit,null==(l=(n=this.editingEditor).exit)||l.call(n),null==(a=(s=this.editingEditor).onEnd)||a.call(s),this.editingEditor=null,this.isValidatingValue=!1,this.beginTriggerEditCellMode=null}cancelEdit(){var t,e,i,r;this.editingEditor&&(null==(e=(t=this.editingEditor).exit)||e.call(t),null==(r=(i=this.editingEditor).onEnd)||r.call(i),this.editingEditor=null)}release(){this.listenersId.forEach(t=>{this.table.off(t)})}}function o(t,e,i,r){return e.isValidatingValue=!1,"validate-exit"===t?(e.doExit(),null==r||r(!0),!0):"invalidate-exit"===t?(e.editingEditor.setValue(i),e.doExit(),null==r||r(!0),!0):"validate-not-exit"===t||"invalidate-not-exit"===t?(null==r||r(!1),!1):!0===t?(e.doExit(),null==r||r(!0),!0):(null==r||r(!1),!1)}},23269:function(t,e,i){i.d(e,{U:()=>n,X:()=>r});let r={};function n(t){if(r[t])return r[t]}},53476:function(t,e,i){i.d(e,{b:()=>a});var r=i(97779),n=i(30430);let l=1;class s{constructor(t,e,i){var n;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{let t=this.getSize(),e=!1;t.width===this.lastSize.width&&t.height===this.lastSize.height&&(e=!0),this.lastSize=t,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:e}))},this.onResize=()=>{this.callBackDebounce()},this.element=t,this.cb=e,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=(0,r.D)(this.callBack,this.resizeTime),null==window||window.addEventListener("resize",this.onResize),"ResizeObserver"in window){let t=window.ResizeObserver;this.observer=new t(this.mutationResize),null==(n=this.observer)||n.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(t){this.lastSize=t}checkSize(){let t=this.getSize();return t.width!==this.lastSize.width||t.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}}class a{constructor(){this.listeners={},this.reseizeListeners={}}on(t,e,i,...r){if("node"===n.X.mode)return -1;let a=l++;if(null==t?void 0:t.addEventListener)if("resize"!==e||t===window)null==t||t.addEventListener(e,i,...r);else{let e=new s(t,i,this.resizeTime);this.reseizeListeners[a]=e}return this.listeners[a]={target:t,type:e,listener:i,options:r},a}once(t,e,i,...r){if("node"===n.X.mode)return -1;let l=this.on(t,e,(...t)=>{this.off(l),i(...t)},...r);return l}off(t){var e;if("node"===n.X.mode||null===t)return;let i=null==(e=this.listeners)?void 0:e[t];i&&(delete this.listeners[t],i.target.removeEventListener&&i.target.removeEventListener(i.type,i.listener,...i.options))}fire(t,e,...i){if("node"!==n.X.mode)for(let r in this.listeners){let n=this.listeners[r];n.target===t&&n.type===e&&n.listener.call(n.target,...i)}}hasListener(t,e){if("node"===n.X.mode)return!1;let i=!1;for(let r in this.listeners){let n=this.listeners[r];n.target===t&&n.type===e&&(i=!0)}return i}clear(){if("node"!==n.X.mode){for(let t in this.listeners){let e=this.listeners[t];e.target.removeEventListener&&e.target.removeEventListener(e.type,e.listener,...e.options)}for(let t in this.reseizeListeners){let e=this.reseizeListeners[t];null==e||e.disConnect()}this.listeners={}}}release(){"node"!==n.X.mode&&(this.clear(),this.listeners={})}}},79497:function(t,e,i){i.d(e,{R:()=>l});var r=i(64776);let n=1;class l{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(t,e){let i=this.listenersData.listeners[t]||(this.listenersData.listeners[t]=[]);i.push(e);let r=n++;return this.listenersData.listenerData[r]={type:t,listener:e,remove:()=>{delete this.listenersData.listenerData[r];let n=i.indexOf(e);i.splice(n,1),this.listenersData.listeners[t].length||delete this.listenersData.listeners[t]}},r}off(t,e){var i;if(e)this.removeEventListener(t,e);else{if(!this.listenersData)return;null==(i=this.listenersData.listenerData[t])||i.remove()}}addEventListener(t,e,i){this.on(t,e)}removeEventListener(t,e){if(this.listenersData)for(let i in this.listenersData.listenerData){let r=this.listenersData.listenerData[i];r.type===t&&r.listener===e&&this.off(i)}}hasListeners(t){return!!this.listenersData&&!!this.listenersData.listeners[t]}fireListeners(t,e){if(!this.listenersData)return[];let i=this.listenersData.listeners[t];return i?i.map(t=>t.call(this,e)).filter(t=>(0,r.Z)(t)):[]}release(){delete this.listenersData}}},53430:function(t,e,i){i.d(e,{J$:()=>l,RJ:()=>n,r5:()=>a,xD:()=>s});var r=i(64776);function n(t){let e={abstractPos:{x:t.viewport.x,y:t.viewport.y}},i=l(t.target);return i&&(e.eventArgs={col:i.col,row:i.row,event:t,targetCell:i,mergeInfo:function(t){if((0,r.Z)(t.mergeStartCol)&&(0,r.Z)(t.mergeStartRow)&&(0,r.Z)(t.mergeEndCol)&&(0,r.Z)(t.mergeEndRow))return{colStart:t.mergeStartCol,colEnd:t.mergeEndCol,rowStart:t.mergeStartRow,rowEnd:t.mergeEndRow}}(i),target:t.target}),e}function l(t){for(;t&&t.parent;){if("cell"===t.role)return t;t=t.parent}return null}let s=/radio-\d+-\d+-(\d+)/;function a(t){let e=["<table>"],i=t.split("\r\n");return i.forEach(function(t,r){let n=t.split("	"),l=[];0===r&&e.push("<tbody>"),n.forEach(function(t,e){let i=t?t.toString().replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`).replace(/\t/gi,"&#9;"):" ";l.push(`<td>${i}</td>`)}),e.push("<tr>",...l,"</tr>"),r===i.length-1&&e.push("</tbody>")}),e.push("</table>"),['<meta name="author" content="Visactor"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>',e.join("")].join("")}},9607:function(t,e,i){let r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M;i.d(e,{E6:()=>B,U2:()=>L,ci:()=>E});var T=i(34672),k=i(23975),R=i(9607),P=i(77874);function B(t){var e,i,T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X;r=null!=(e=null==t?void 0:t.sort_color)?e:"#282F38",n=null!=(i=null==t?void 0:t.sort_color_opacity)?i:"0.35",l=null!=(T=null==t?void 0:t.sort_color_2)?T:"#416EFF",s=null!=(k=null==t?void 0:t.sort_color_opacity_2)?k:"1",a=null!=(R=null==t?void 0:t.sort_size)?R:16,o=null!=(P=null==t?void 0:t.sort_size_2)?P:22,h=null!=(B=null==t?void 0:t.frozen_color)?B:"#282F38",d=null!=(I=null==t?void 0:t.frozen_color_opacity)?I:"0.35",u=null!=(E=null==t?void 0:t.frozen_color_opacity)?E:"0.2",c=null!=(L=null==t?void 0:t.frozen_color_2)?L:"#416EFF",p=null!=(F=null==t?void 0:t.frozen_color_opacity_2)?F:"1",g=null!=(O=null==t?void 0:t.frozen_size)?O:22,f=null!=(H=null==t?void 0:t.frozen_size_2)?H:22,m=null!=(D=null==t?void 0:t.collapse_color)?D:"#141414",y=null!=(z=null==t?void 0:t.collapse_color_opacity)?z:"0.65",v=null!=(W=null==t?void 0:t.collapse_size)?W:16,b=null!=(Z=null==t?void 0:t.frozen_size_2)?Z:22,_=null!=(N=null==t?void 0:t.expand_color)?N:"#141414",C=null!=(j=null==t?void 0:t.expand_color_opacity)?j:"0.65",x=null!=(G=null==t?void 0:t.expand_size)?G:16,w=null!=(V=null==t?void 0:t.expand_size_2)?V:22,S=null!=(U=null==t?void 0:t.dragReorder_color)?U:"#666666",A=null!=(K=null==t?void 0:t.dragReorder_color_opacity)?K:"1",M=null!=(X=null==t?void 0:t.dragReorder_size)?X:20}let I={get sort_downward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${l}"  fill-opacity="${s}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${r}" fill-opacity="${n}"/></svg> `,width:a,height:a,funcType:T.cI.sort,name:"sort_downward",positionType:T.q0.contentRight,marginLeft:3,hover:{width:o,height:o,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_upward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${r}"  fill-opacity="${n}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${l}"  fill-opacity="${s}"/> </svg>`,width:a,height:a,funcType:T.cI.sort,positionType:T.q0.contentRight,name:"sort_upward",marginLeft:3,hover:{width:o,height:o,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_normal(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${r}" fill-opacity="${n}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${r}" fill-opacity="${n}"/></svg> `,width:a,height:a,funcType:T.cI.sort,positionType:T.q0.contentRight,name:"sort_normal",marginLeft:3,hover:{width:o,height:o,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get freeze(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path d="M17.1313 8.42047C17.1932 8.48238 17.2423 8.55587 17.2759 8.63676C17.3094 8.71764 17.3266 8.80434 17.3266 8.89189C17.3266 8.97944 17.3094 9.06613 17.2759 9.14702C17.2423 9.2279 17.1932 9.3014 17.1313 9.3633L13.3843 13.1103C13.7007 14.3048 13.5305 15.4443 12.8388 16.2395C12.8104 16.2781 12.7778 16.3136 12.7417 16.3451L12.712 16.3755C12.6501 16.4374 12.5766 16.4865 12.4957 16.52C12.4148 16.5535 12.3281 16.5707 12.2406 16.5707C12.153 16.5707 12.0663 16.5535 11.9854 16.52C11.9046 16.4865 11.8311 16.4374 11.7692 16.3755L9.17633 13.7826L6.05316 16.9058L5.11983 17.0925C5.09291 17.0979 5.06508 17.0965 5.03881 17.0886C5.01254 17.0806 4.98863 17.0663 4.96923 17.0469C4.94982 17.0275 4.9355 17.0036 4.92755 16.9773C4.9196 16.951 4.91827 16.9232 4.92366 16.8963L5.11033 15.963L8.23333 12.8396L5.64066 10.2471C5.57875 10.1852 5.52964 10.1117 5.49614 10.0309C5.46263 9.94997 5.44539 9.86327 5.44539 9.77572C5.44539 9.68817 5.46263 9.60148 5.49614 9.52059C5.52964 9.43971 5.57875 9.36621 5.64066 9.3043C5.65066 9.2943 5.66066 9.2843 5.67099 9.27464C5.70266 9.2383 5.73833 9.20547 5.77766 9.17664C6.57283 8.48564 7.71199 8.31564 8.90599 8.63197L12.6528 4.88497C12.7147 4.82306 12.7882 4.77395 12.8691 4.74045C12.95 4.70694 13.0367 4.6897 13.1242 4.6897C13.2118 4.6897 13.2985 4.70694 13.3794 4.74045C13.4603 4.77395 13.5338 4.82306 13.5957 4.88497L17.1312 8.42047H17.1313ZM15.7172 8.8918L13.1243 6.29914L9.56483 9.8588C9.47574 9.94788 9.36323 10.0099 9.24034 10.0376C9.11746 10.0654 8.98922 10.0578 8.87049 10.0156C8.22783 9.78764 7.63899 9.7553 7.17749 9.89814L12.1182 14.8388C12.261 14.3771 12.2287 13.7885 12.0007 13.146C11.9585 13.0272 11.9509 12.899 11.9787 12.7761C12.0064 12.6532 12.0684 12.5407 12.1575 12.4516L15.7172 8.89164V8.8918Z" fill="${h}" fill-opacity="${u}"/></g><defs><clipPath id="clip0"><rect width="22" height="22" fill="white"/></clipPath></defs></svg>`,width:g,height:g,name:"freeze",funcType:T.cI.frozen,positionType:T.q0.right,marginRight:0,hover:{width:f,height:f,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozen(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z" fill="${h}" fill-opacity="${d}"/></svg>`,width:g,height:g,name:"frozen",funcType:T.cI.frozen,positionType:T.q0.right,marginRight:0,hover:{width:f,height:f,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozenCurrent(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z"  fill="${c}" fill-opacity="${p}"/></svg>`,width:g,height:g,funcType:T.cI.frozen,positionType:T.q0.right,name:"frozenCurrent",marginRight:0,hover:{width:f,height:f,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get dropdownIcon(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="white"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#959DA5"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="#4F5965"/></svg>',width:24,height:24,funcType:T.cI.dropDown,positionType:T.q0.absoluteRight,name:"dropdownIcon",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)",image:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="#1E54C9"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#141414" stroke-opacity="0.2"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="white"/></svg>'},cursor:"pointer",visibleTime:"mouseenter_cell"}},get play(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01" /><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /><path d="M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /></svg>',width:24,height:24,funcType:T.cI.play,positionType:T.q0.right,name:"play",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get damage_pic(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 10V38C5 39.1046 5.89543 40 7 40H14H18L15 29L22 27L21 20L29 16L27 13L30 8H7C5.89543 8 5 8.89543 5 10Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M43 38V10C43 8.89543 42.1046 8 41 8H38L34 14L37 19L28 23L29 31L22 33L24 40H41C42.1046 40 43 39.1046 43 38Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 18C15.3284 18 16 17.3284 16 16.5C16 15.6716 15.3284 15 14.5 15C13.6716 15 13 15.6716 13 16.5C13 17.3284 13.6716 18 14.5 18Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',width:24,height:24,funcType:T.cI.damagePic,positionType:T.q0.left,name:"damage_pic",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get loading_pic(){return{type:"svg",svg:'<svg viewBox="0 0 400 300" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="50" y="65" width="301" height="170"><path d="M350.3 65H50v169.8h300.3V65Z" fill="#fff"/></mask><g mask="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M58.3 233.2h32.8v-36.8H58.3v36.8Z" fill="#C7DEFF"/><path d="M91.1 224.5v8.8H58.3M82.4 196.2H58.3" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M305.4 182.5s-2.7 12.6 0 17.4c2.7 4.8 8.3 6.7 12.4 4.4 4.2-2.4 5.3-8.1 2.6-12.9-2.7-4.8-15-8.9-15-8.9ZM336 204.7c4.3 2 9.7-.4 12-5.4 2.3-5-1.5-17.3-1.5-17.3s-11.8 5.1-14.1 10.1c-2.3 5-.7 10.6 3.6 12.6Z" fill="#00E4E5"/><path fill-rule="evenodd" clip-rule="evenodd" d="M326.7 174s-10 11.8-10 18.6c0 6.7 4.5 12.2 10 12.2s10-5.5 10-12.3c0-6.8-10-18.5-10-18.5Z" fill="#00E4E5"/><path d="M332.3 181.5c2.3 3.6 4.4 7.8 4.4 10.9M316.7 192.5c0-3.1 2.1-7.2 4.3-10.8" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M343.1 227.3v-9.7h-34v9.7c0 3.7 3 6.6 6.6 6.6h20.9c3.6 0 6.5-2.9 6.5-6.6Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M350.4 220.8V198H302v22.8c0 5.9 4.8 10.7 10.7 10.7h26.9c5.9 0 10.7-4.8 10.8-10.7Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M331.7 74.2H117.8L87.4 203h213.8l30.5-128.8Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M337 74.2h-6.2l-30.6 129.2h6.2L337 74.2Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M303.8 203.5h2.4l30.7-129.3h-1.8l-31.3 129.3Z" fill="#C7DEFF"/><path d="m337 74.2-30.6 129.2h-5.9" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M229.9 202.1h-47.6l2 9.6h47.3l-1.7-9.6Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path d="M138.5 74.2h193.2l-23.4 98.6M94.5 172.7l11-46.3M104.8 155.4l-2.3 11.5h6.7M316 112.1l1.1-4.5" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M148.3 138.1h97V119h-97v19.1Z" fill="#00E4E5"/><path d="M303.1 80.6h20.3l-4.6 19.6M228.3 234.3c3.6 0 6.3-3.2 5.7-6.8l-4.1-24.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M226.2 229.5h-68.9v1.2c0 2 1.6 3.7 3.7 3.7h60.1c2.8 0 5-2.2 5.1-4.9Z" fill="#C7DEFF"/><path d="M180.699 226.8h-19.9c-2.8 0-4.6 3-3.3 5.5m0 0c.6 1.2 1.9 2 3.3 2h57.8M175.9 203.4l3.6 17.6M241.2 234.3h65.1M104.6 234.3h41.3" stroke="#071F4D"/><path d="M206.2 234.3h14.9c3.1 0 5.5-2.8 5-5.9l-4.3-24.9M160.7 226.8h46M62.2 226.1h-9.5c-1.2 0-2.2-1-2.2-2.2v-18.3c0-1.2 1-2.2 2.2-2.2h9.5" stroke="#071F4D"/><path d="M53.4 171.7H68c2.1 0 3.7 1.7 3.7 3.7v16.1M79.1 192v-21.8c0-2.5 2-4.6 4.6-4.6h2.2c2.5 0 4.5-2 4.5-4.5m0 0c0-2.5-2-4.5-4.5-4.5H56.1c-2.4 0-4.3-1.9-4.3-4.3V148M71.2 165.2h-18M64 181.7v10.1" stroke="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.7 120H124c4.3 0 7.7-3.5 7.7-7.7V65.5H94.2c-4.7 0-8.5 4.9-8.5 11V120Z" fill="#C7DEFF"/><path d="M85.7 110.7V73c0-4.1 3.4-7.5 7.5-7.5h38.5M146.2 73.8v-2.5c0-3.2-2-5.8-5.8-5.8-2.8 0-6 1.1-6 5.8v42.4c0 4.7-3.8 8.5-8.5 8.5h-15.6" stroke="#071F4D"/><path d="M119.7 122.3H87c-6.1 0-11.1-5-11.1-11.1m0 0h39M126.1 122.3c-6.1 0-11.1-5-11.1-11.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.4 122.1h37.2c-6.5-1.8-8-10.5-8-10.5H76.2c.6 8.8 9.2 10.5 9.2 10.5Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M95.8 102.9h4.8V83.6h-4.8v19.3ZM106.6 102.9h4.8V77.6h-4.8v25.3ZM117.3 102.9h4.8V89.1h-4.8v13.8Z" fill="#fff"/><path d="M273.2 195.9h16.9M261.2 195.9h5" stroke="#fff"/><path d="M62.4 201.9v2.9M62.4 224.5v2.9" stroke="#071F4D"/><path d="m153.6 138.1 9.7-19.1M168.8 138.1l9.7-19.1M184.1 138.1l9.7-19.1M199.4 138.1l9.7-19.1M214.6 138.1l9.8-19.1M229.9 138.1l9.7-19.1" stroke="#fff"/><path d="M148.3 138.1h121.6V119H148.3v19.1Z" stroke="#071F4D"/></g></svg>',width:400,height:300,name:"loading_pic",positionType:T.q0.left}},get expand(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M4.64988 6.81235C4.38797 6.48497 4.62106 6 5.04031 6L10.9597 6C11.3789 6 11.612 6.48497 11.3501 6.81235L8.39043 10.512C8.19027 10.7622 7.80973 10.7622 7.60957 10.512L4.64988 6.81235Z" fill="${_}" fill-opacity="${C}"/>
      </svg>`,width:x,height:x,funcType:T.cI.expand,name:"expand",positionType:T.q0.contentLeft,marginLeft:0,marginRight:4,hover:{width:w,height:w,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get collapse(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M5.81235 11.3501C5.48497 11.612 5 11.3789 5 10.9597L5 5.04031C5 4.62106 5.48497 4.38797 5.81235 4.64988L9.51196 7.60957C9.76216 7.80973 9.76216 8.19027 9.51196 8.39044L5.81235 11.3501Z"  fill="${m}" fill-opacity="${y}"/>
      </svg>`,width:v,height:v,funcType:T.cI.collapse,name:"collapse",positionType:T.q0.contentLeft,marginLeft:0,marginRight:4,hover:{width:b,height:b,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get drillDown(){return{name:"drillDown",type:"svg",positionType:T.q0.absolute,funcType:T.cI.drillDown,svg:P.gm,width:13,height:13,cursor:"pointer"}},get drillUp(){return{name:"drillUp",type:"svg",positionType:T.q0.absolute,funcType:T.cI.drillUp,svg:P.Zj,width:13,height:13,cursor:"pointer"}},get dragReorder(){return{type:"svg",svg:`<svg t="1710129136961" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5166" width="200" height="200"><path d="M362.666667 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5167"></path><path d="M661.333333 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5168"></path><path d="M362.666667 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5169"></path><path d="M661.333333 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5170"></path><path d="M362.666667 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5171"></path><path d="M661.333333 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${S}"  fill-opacity="${A}" p-id="5172"></path></svg>`,width:M,height:M,funcType:T.cI.dragReorder,positionType:T.q0.left,name:"dragReorder",marginLeft:-10,marginRight:10,cursor:"grab"}}},E={};function L(){return(0,k.l7)(I,R.ci)}},73508:function(t,e,i){i.d(e,{iN:()=>S,Wm:()=>A,hZ:()=>_,Vp:()=>w,dK:()=>C,V4:()=>k});var r,n,l=i(4654),s=i(20408),a=i(95723),o=i(64776),h=i(89530);function d(t){return 2===t.length&&(0,h.Z)(t[0])&&(0,h.Z)(t[1])&&t[1]>=t[0]}function u(t){let e=t[1]-t[0],i=t[1]*t[0]<0,r=t[0]<=0?0-t[0]:0,n=t[1]>0?t[1]-0:0;return 0===e?t[0]<0?(r=1,n=0):t[0]>0&&(r=0,n=1):(r/=e,n/=e),{total:e,negative:r,positive:n,includeZero:i,domain:t,extendable_min:!0,extendable_max:!0}}function c(t,e){let{positive:i,negative:r,extendable_min:n,extendable_max:l,domain:s}=t,{positive:a,negative:o,extendable_min:h,extendable_max:d,domain:u}=e;if(a>0){if(!h)return!1;let t=r/i;l&&(t=r/Math.max(i,a),s[1]=-s[0]/t),u[0]=-u[1]*t}else if(o>0){if(!d)return!1;let t=i/r;n&&(t=i/Math.max(r,r),s[0]=-s[1]/t),u[1]=-u[0]*t}return!0}function p(t,e){let{extendable_min:i,extendable_max:r,domain:n}=t,{positive:l,negative:s,domain:a}=e;return(0!==l||0!==s)&&!(l>0&&!r)&&!(s>0&&!i)&&(n[0]=a[0],n[1]=a[1],!0)}function g(t,e){let{positive:i,negative:r,extendable_max:n,domain:l}=t,{positive:s,negative:a,extendable_min:o,domain:h}=e;if(n&&o){let t=Math.max(r,a)/Math.max(i,s);l[1]=-l[0]/t,h[0]=-h[1]*t}else if(o)h[0]=-h[1]*(r/i);else{if(!n)return!1;l[1]=-l[0]/(a/s)}return!0}function f(t,e){let{extendable_min:i,domain:r}=t,{extendable_max:n,domain:l}=e;return!(!i||!n)&&(r[0]=-r[1],l[1]=-l[0],!0)}var m=i(31877),y=i(74577),v=i(32802),b=i(26717);function _(t,e,i){var r,n,h,d,u,c,p,g,f,m,_,x,w,S,A,T;if(i._table.isPivotChart())if(i.indicatorsAsCol){if(i.hasTopIndicatorAxis&&e===i.columnHeaderLevelCount-1&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount){let r=i.getIndicatorKey(t,e),n=i.getIndicatorInfo(r);if(!(null==n?void 0:n.hasTopIndicatorAxis))return;let a=M("top",t,e+1,t,i.columnHeaderLevelCount-1,t,e,1,i);if(!a)return;let o=i._table._getCellStyle(t,e+1),h=(0,y.u)((0,v.WJ)("padding",o,t,e+1,i._table)),{range:d,ticks:u,axisOption:c,targetTicks:p,targetRange:g,index:f,theme:m}=a;return(0,l.Z)(null==c?void 0:c.min)&&(d.min=c.min,d.min>0&&(c.zero=!1)),(0,l.Z)(null==c?void 0:c.max)&&(d.max=c.max,d.max<0&&(c.zero=!1)),(0,s.Z)({range:d},c,{orient:"top",type:(null==c?void 0:c.type)||"linear",label:{flush:!0},tick:{tickMode:(0,b.h)(p,g,d,f)},__ticksForVTable:u,__vtableChartTheme:m,__vtableBodyChartCellPadding:h})}if(e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount){let a=i.getIndicatorKeyInChartSpec(t,e),o=null;null==a||a.forEach(t=>{let e=i.getIndicatorInfo(t);e&&(o=e)});let h=M("bottom",t,e-1,t,e,t,e,0,i),{chartType:d}=C(t,e-1,"bottom",i);if(!h)return;let u=i._table._getCellStyle(t,e-1),c=(0,y.u)((0,v.WJ)("padding",u,t,e-1,i._table)),{range:p,ticks:g,axisOption:f,index:m,targetTicks:_,targetRange:x,theme:w}=h;(0,l.Z)(null==f?void 0:f.max)?(p.max=f.max,p.max<0&&(f.zero=!1)):"boxPlot"===d&&(p.max+=(p.max-p.min)/20),(0,l.Z)(null==f?void 0:f.min)?(p.min=f.min,p.min>0&&(f.zero=!1)):"boxPlot"===d&&(p.min-=(p.max-p.min)/20);let S=[];if("heatmap"===d){let l=i.getDimensionKeyInChartSpec(t,i.rowCount-i.bottomFrozenRowCount-1,"xField"),s=null!=(r=i.dataset.collectedValues[l])?r:[],a=i.getColKeysPath(t,e);S=null!=(n=null==s?void 0:s[null!=a?a:""])?n:[]}return(0,s.Z)({title:{visible:!0,text:null==o?void 0:o.title},range:p,domain:"linear"===(null==f?void 0:f.type)?void 0:Array.from(S)},f,{orient:"bottom",type:(null==f?void 0:f.type)||"linear",label:{flush:!0},tick:{tickMode:(0,b.h)(_,x,p,m)},__ticksForVTable:g,__vtableChartTheme:w,__vtableBodyChartCellPadding:c})}if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount){let r,n=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,e);(0,a.Z)(n)&&(n=n[0]);let l=null!=(h=i.dataset.collectedValues[n])?h:[],p=i.getRowKeysPath(t,e),g=null!=(d=l[null!=p?p:""])?d:[],{axisOption:f,theme:m,chartType:b}=C(t+1,e,"left",i);if(!1===(null==f?void 0:f.visible))return;let _=i._table._getCellStyle(t+1,e),x=(0,y.u)((0,v.WJ)("padding",_,t+1,e,i._table)),w=i.getRawChartSpec(t+1,e);return(0,s.Z)({domain:"linear"===(null==f?void 0:f.type)?void 0:Array.from(g),range:"linear"===(null==f?void 0:f.type)?g:void 0,title:{autoRotate:!0}},f,{orient:"left",type:null!=(u=null==f?void 0:f.type)?u:"band",label:{flush:!0},inverse:(S=f,A="horizontal"===(null!=(c=null==w?void 0:w.direction)?c:"scatter"===b?"vertical":"horizontal"),r=null==S?void 0:S.inverse,A&&"bottom"!==(T=null==S?void 0:S.orient)&&"top"!==T&&(r=!(0,o.Z)(null==S?void 0:S.inverse)||!(null==S?void 0:S.inverse)),r),__vtableChartTheme:m,__vtableBodyChartCellPadding:x})}}else{if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount){let r=i.getIndicatorKeyInChartSpec(t,e),n=null;null==r||r.forEach(t=>{let e=i.getIndicatorInfo(t);e&&(n=e)});let a=M("left",t+1,e,t,e,t,e,0,i),{chartType:o}=C(t+1,e,"left",i);if(!a)return;let h=i._table._getCellStyle(t+1,e),d=(0,y.u)((0,v.WJ)("padding",h,t+1,e,i._table)),{range:u,ticks:c,axisOption:f,index:m,targetTicks:_,targetRange:x,theme:w}=a;(0,l.Z)(null==f?void 0:f.max)?(u.max=f.max,u.max<0&&(f.zero=!1)):"boxPlot"===o&&(u.max+=(u.max-u.min)/20),(0,l.Z)(null==f?void 0:f.min)?(u.min=f.min,u.min>0&&(f.zero=!1)):"boxPlot"===o&&(u.min-=(u.max-u.min)/20);let S=[];if("heatmap"===o){let r=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,e,"yField"),n=null!=(p=i.dataset.collectedValues[r])?p:[],l=i.getRowKeysPath(t,e);S=null!=(g=null==n?void 0:n[null!=l?l:""])?g:[]}return(0,s.Z)({title:{visible:!0,text:null==n?void 0:n.title,autoRotate:!0},range:u,domain:"linear"===(null==f?void 0:f.type)?void 0:Array.from(S)},f,{orient:"left",type:(null==f?void 0:f.type)||"linear",label:{flush:!0},tick:{tickMode:(0,b.h)(_,x,u,m)},__ticksForVTable:c,__vtableChartTheme:w,__vtableBodyChartCellPadding:d})}if(t===i.colCount-i.rightFrozenColCount&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount){let r=i.getIndicatorKey(t,e),n=i.getIndicatorInfo(r);if(!(null==n?void 0:n.hasRightIndicatorAxis))return;let{axisOption:a,chartType:o}=C(t-1,e,"right",i),h=M("right",t-1,e,i.rowHeaderLevelCount-1,e,t,e,1,i);if(!h)return;let d=i._table._getCellStyle(t-1,e),u=(0,y.u)((0,v.WJ)("padding",d,t-1,e,i._table)),{range:c,ticks:p,index:g,targetTicks:_,targetRange:x,theme:w}=h;(0,l.Z)(null==a?void 0:a.min)&&(c.min=a.min,c.min>0&&(a.zero=!1)),(0,l.Z)(null==a?void 0:a.max)&&(c.max=a.max,c.max<0&&(a.zero=!1));let S=[];if("heatmap"===o){let r=i.getDimensionKeyInChartSpec(i.colCount-i.rightFrozenColCount-1,e,"yField"),n=null!=(f=i.dataset.collectedValues[r])?f:[],l=i.getRowKeysPath(t,e);S=null!=(m=null==n?void 0:n[null!=l?l:""])?m:[]}return(0,s.Z)({range:c,title:{autoRotate:!0},domain:"linear"===(null==a?void 0:a.type)?void 0:Array.from(S)},a,{orient:"right",type:(null==a?void 0:a.type)||"linear",label:{flush:!0},tick:{tickMode:(0,b.h)(_,x,c,g)},__ticksForVTable:p,__vtableChartTheme:w,__vtableBodyChartCellPadding:u})}if(e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount){let r=i.getDimensionKeyInChartSpec(t,i.columnHeaderLevelCount);(0,a.Z)(r)&&(r=r[0]);let n=null!=(_=i.dataset.collectedValues[r])?_:[],l=i.getColKeysPath(t,e),o=null!=(x=null==n?void 0:n[null!=l?l:""])?x:[],{axisOption:h,isPercent:d,theme:u,chartType:c}=C(t,e-1,"bottom",i);if(!1===(null==h?void 0:h.visible))return;let p=i._table._getCellStyle(t,e-1),g=(0,y.u)((0,v.WJ)("padding",p,t,e-1,i._table));return(0,s.Z)({domain:"linear"===(null==h?void 0:h.type)?void 0:Array.from(o),range:"linear"===(null==h?void 0:h.type)?o:void 0},h,{orient:"bottom",type:null!=(w=null==h?void 0:h.type)?w:"band",label:{flush:!0},__vtableChartTheme:u,__vtableBodyChartCellPadding:g})}}}function C(t,e,i,r){var n,s,h,d,u,c,p,g,f;let m=r.getRawChartSpec(t,e),y=null!=(n=m.axes)?n:[];if(r._table.pivotChartAxes.forEach(t=>{-1===y.findIndex(e=>t.orient===e.orient)&&y.push(t)}),m&&(0,a.Z)(y)){let t=y.find(t=>t.orient===i);if(t){let e,n;t.zero&&(0,l.Z)(null==(s=t.range)?void 0:s.min)&&(t.zero=!1);let{seriesIndex:c,seriesId:p}=t;(0,o.Z)(p)&&(0,a.Z)(m.series)?e=((0,a.Z)(p)?p:[p]).map(t=>{let e=m.series.findIndex(e=>e.id===t);return e>=0&&(n=m.series[e]),e}):(0,o.Z)(c)&&(0,a.Z)(m.series)&&(e=c);let{isZeroAlign:g,isTickAlign:f}=x(m,i,r);return t.labelHoverOnAxis||(t.labelHoverOnAxis=null==(d=null==(h=r._table.options.chartDimensionLinkage)?void 0:h.labelHoverOnAxis)?void 0:d[i]),{axisOption:t,isPercent:m.percent,isZeroAlign:g,isTickAlign:f,seriesIndice:e,theme:m.theme,chartType:null!=(u=null==n?void 0:n.type)?u:m.type}}}let v=null!=(c=r._table.pivotChartAxes.find(t=>t.orient===i))?c:{};v.zero&&(0,l.Z)(null==(p=v.range)?void 0:p.min)&&(v.zero=!1),v&&!v.labelHoverOnAxis&&(v.labelHoverOnAxis=null==(f=null==(g=r._table.options.chartDimensionLinkage)?void 0:g.labelHoverOnAxis)?void 0:f[i]);let{isZeroAlign:b,isTickAlign:_}=x(m,i,r);return{axisOption:v,isPercent:!1,isZeroAlign:b,isTickAlign:_,theme:m.theme,chartType:m.type}}function x(t,e,i){let r,n=[];"left"===e||"right"===e?n.push("left","right"):"top"!==e&&"bottom"!==e||n.push("top","bottom"),r=t&&(0,a.Z)(t.axes)?t.axes:i._table.pivotChartAxes;let l=!1,s=!1;if((0,a.Z)(r)){let t=[];r.forEach(e=>{n.includes(e.orient)&&t.push(e)});for(let e=0;e<t.length;e++){let i=t[e];i.sync&&i.sync.axisId&&t.find(t=>t.id===i.sync.axisId)&&(l=l||i.sync.zeroAlign,s=s||i.sync.tickAlign)}}return{isZeroAlign:l,isTickAlign:s}}function w(t,e,i){if(!i._table.isPivotChart())return!1;if(i.indicatorsAsCol){if(i.hasTopIndicatorAxis&&e===i.columnHeaderLevelCount-1&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount||e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount)return!0}else if(e===i.rowCount-i.bottomFrozenRowCount&&t>=i.rowHeaderLevelCount&&t<i.colCount-i.rightFrozenColCount)return!0;return!1}function S(t,e,i){if(!i._table.isPivotChart())return!1;if(i.indicatorsAsCol){if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return!0}else if(t===i.rowHeaderLevelCount-1&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount||t===i.colCount-i.rightFrozenColCount&&e>=i.columnHeaderLevelCount&&e<i.rowCount-i.bottomFrozenRowCount)return!0;return!1}function A(t,e,i,r){if(!((0,a.Z)(t.axes)&&0!==t.axes.length||(0,a.Z)(e)&&0!==e.length))return i&&r||!i&&!r;if((0,a.Z)(t.axes)&&t.axes.length>0)for(let e=0;e<t.axes.length;e++){let n=t.axes[e];if(!i&&r&&"bottom"===n.orient){if("heatmap"===t.type)return"linear"===n.type;if("linear"===n.type)return!0}if(i&&r&&"bottom"===n.orient){if("heatmap"===t.type)return"linear"===n.type;if("linear"!==n.type)return!0}if(!i&&!r&&"left"===n.orient){if("heatmap"===t.type)return"linear"===n.type;if("linear"!==n.type)return!0}if(i&&!r&&"left"===n.orient){if("heatmap"===t.type)return"linear"===n.type;if("linear"===n.type)return!0}}if((0,a.Z)(e)&&e.length>0)for(let n=0;n<e.length;n++){let l=e[n];if(!i&&r&&"bottom"===l.orient){if("heatmap"===t.type)return"linear"===l.type;if("linear"===l.type)return!0}if(i&&r&&"bottom"===l.orient){if("heatmap"===t.type)return"linear"===l.type;if("linear"!==l.type)return!0}if(!i&&!r&&"left"===l.orient){if("heatmap"===t.type)return"linear"===l.type;if("linear"!==l.type)return!0}if(i&&!r&&"left"===l.orient){if("heatmap"===t.type)return"linear"===l.type;if("linear"===l.type)return!0}}return i&&r||!i&&!r}function M(t,e,i,r,n,l,s,a,o){let h,d=o.getIndicatorKeyInChartSpec(r>=0?r:l,n>=0?n:s);h="top"===t||"bottom"===t?o.getColKeysPath(l,s):o.getRowKeysPath(l,s);let u=T(e,i,a,t,d,h,o);if(!u)return;let c="bottom"===t?"top":"top"===t?"bottom":"left"===t?"right":"left",{targetRange:p,targetTicks:g}=R(e,i,u.index,u.isZeroAlign,u.isTickAlign,u.range,d,c,h,o);if(0!==u.index&&g){let{range:e,ticks:i}=m.F.getFunction("getAxisDomainRangeAndLabels")(u.range.min,u.range.max,u.axisOption,u.isZeroAlign,"bottom"===t||"top"===t?o._table.getColWidth(l)||o._table.tableNoFrameWidth:o._table.getRowHeight(s)||o._table.tableNoFrameHeight,{targetTicks:g,targetRange:p});u.range.min=e[0],u.range.max=e[1],u.ticks=i}return u.targetRange=p,u.targetTicks=g,u}function T(t,e,i,r,n,o,h){let{axisOption:d,isPercent:u,isZeroAlign:c,isTickAlign:p,seriesIndice:g,theme:f,chartType:y}=C(t,e,r,h),v=function t(e,i,r,n,l){var o,h;if((0,a.Z)(l)){let s={min:1/0,max:-1/0};for(let a=0;a<l.length;a++){let o=t(e,i,r,n,l[a]);o&&(s.min=Math.min(s.min,o.min),s.max=Math.max(s.max,o.max))}return isFinite(s.min)&&isFinite(s.max)?s:null}let d=null!=(o=null==i?void 0:i[l])?o:null==i?void 0:i[0];if((0,a.Z)(d)&&(d=d[0]),!d)return null;let u=e[d],c=(0,s.Z)({},null!=(h=null==u?void 0:u[null!=n?n:""])?h:{min:0,max:1});return c.positiveMax&&c.positiveMax>c.max&&(c.max=c.positiveMax),c.negativeMin&&c.negativeMin<c.min&&(c.min=c.negativeMin),c.min===c.max&&(c.min>0?c.min=0:c.max=0),c}(h.dataset.collectedValues,n,c,o,null!=g?g:i);if(!v)return;u&&(v.min=v.min<0?-1:0,v.max=+(v.max>0)),((null==d?void 0:d.zero)||v.min===v.max)&&(v.min=Math.min(v.min,0),v.max=Math.max(v.max,0));let{range:b,ticks:_}=m.F.getFunction("getAxisDomainRangeAndLabels")(v.min,v.max,d,c,"bottom"===r||"top"===r?h._table.getColWidth(t)||h._table.tableNoFrameWidth:h._table.getRowHeight(e)||h._table.tableNoFrameHeight);return(null==d?void 0:d.nice)&&(v.min=b[0],v.max=b[1]),(0,l.Z)(null==d?void 0:d.min)&&(v.min=d.min),(0,l.Z)(null==d?void 0:d.max)&&(v.max=d.max),{index:null!=g?g:i,range:v,ticks:_,isZeroAlign:c,isTickAlign:p,axisOption:d,theme:f,chartType:y}}function k(t,e,i,r,n,l,a,o){let{range:h,isZeroAlign:d,isTickAlign:u,axisOption:c,chartType:p}=T(t,e,i,r,l,a,o),{targetRange:g,targetTicks:f}=R(t,e,i,d,u,h,l,n,a,o);if(0!==i&&f){let{range:i,ticks:n}=m.F.getFunction("getAxisDomainRangeAndLabels")(h.min,h.max,(0,s.Z)({},c,{nice:!0,tick:{forceTickCount:f.length}}),d,"bottom"===r||"top"===r?o._table.getColWidth(t)||o._table.tableNoFrameWidth:o._table.getRowHeight(e)||o._table.tableNoFrameHeight,{targetTicks:f,targetRange:g});h.min=i[0],h.max=i[1]}return{axisOption:c,range:h,targetTicks:f,targetRange:g,chartType:p}}function R(t,e,i,r,n,l,s,a,o,h){let m,y;if(!r&&!n)return{targetTicks:m,targetRange:y};let v=T(t,e,s.length-1-i,a,s,o,h);if(v){let{range:s,ticks:o}=v;if(y=s,r){let t=function(t,e){let i=[t.min,t.max],r=[e.min,e.max];if(!d(i)||!d(r))return;let n=u(i),l=u(r),{positive:s,negative:a,extendable_min:o,extendable_max:h,includeZero:m}=n,{positive:y,negative:v,extendable_min:b,extendable_max:_,includeZero:C}=l;if(0===s&&0===a){if(!p(n,l))return}else if(0===y&&0===v){if(!p(l,n))return}else if(m||C)if(m&&!C){if(!c(n,l))return}else if(C&&!m){if(!c(l,n))return}else{if(a===v)return;if(a>v){if(!g(n,l))return}else if(!g(l,n))return}else{if(0===a&&0===y){if(!f(n,l))return}else if(0===v&&0===s&&!f(l,n))return;if(0===a&&0===v)if(0===i[0]&&r[0]>0){if(!b)return;r[0]=0}else{if(!(0===r[0]&&i[0]>0)||!o)return;i[0]=0}if(0===s&&0===y)if(0===i[1]&&r[1]>0){if(!_)return;r[1]=0}else{if(!(0===r[1]&&i[1]>0)||!h)return;i[1]=0}}return{range1:i,range2:r}}(l,s);t&&(l.min=t.range1[0],l.max=t.range1[1],y.min=t.range2[0],y.max=t.range2[1])}n&&(m=r?(0,b.r)(y,t,e,i,a,h):o)}return{targetTicks:m,targetRange:y}}(r=n||(n={})).vertical="vertical",r.horizontal="horizontal"},994:function(t,e,i){i.d(e,{K0:()=>v,TF:()=>p,TQ:()=>b,VR:()=>m,YL:()=>C,aw:()=>y,eW:()=>f,ed:()=>c,f_:()=>g,py:()=>_});var r=i(95723),n=i(4654),l=i(20408),s=i(64776),a=i(73508),o=i(39873),h=i(27781),d=i(26717);let u="NO_AXISID_FRO_VTABLE";function c(t,e,i){var r,n;let l,s=i.getCellHeaderPaths(t,e);if(i.indicatorsAsCol){let t=null==(r=s.colHeaderPaths.find(t=>t.indicatorKey))?void 0:r.indicatorKey;l=i.columnObjects.find(e=>e.indicatorKey===t)}else{let t=null==(n=s.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:n.indicatorKey;l=i.columnObjects.find(e=>e.indicatorKey===t)}let a=null==l?void 0:l.chartSpec;return"function"==typeof a?a({col:t,row:e,dataValue:i._table.getCellOriginValue(t,e)||"",value:i._table.getCellValue(t,e)||"",rect:i._table.getCellRangeRelativeRect(i._table.getCellRange(t,e)),table:i._table}):a}function p(t,e,i){var r,n;let l,s=i.getCellHeaderPaths(t,e);if(i.indicatorsAsCol){let t=null==(r=s.colHeaderPaths.find(t=>t.indicatorKey))?void 0:r.indicatorKey;l=i.columnObjects.find(e=>e.indicatorKey===t)}else{let t=null==(n=s.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:n.indicatorKey;l=i.columnObjects.find(e=>e.indicatorKey===t)}return"function"!=typeof(null==l?void 0:l.chartSpec)}function g(t,e,i){var r,n;let l,s=i.getCellHeaderPaths(t,e);if(i.indicatorsAsCol){let t=null==(r=s.colHeaderPaths.find(t=>t.indicatorKey))?void 0:r.indicatorKey;l=i.columnObjects.find(e=>e.indicatorKey===t)}else{let t=null==(n=s.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:n.indicatorKey;l=i.columnObjects.find(e=>e.indicatorKey===t)}return null==l?void 0:l.noDataRenderNothing}function f(t){let e=!1;for(let i=0;i<t.length;i++){let r=t[i];if(r.chartSpec&&"wordCloud"!==r.chartSpec.type&&"radar"!==r.chartSpec.type&&"gauge"!==r.chartSpec.type&&"pie"!==r.chartSpec.type&&"funnel"!==r.chartSpec.type&&"rose"!==r.chartSpec.type&&"sunburst"!==r.chartSpec.type&&"treemap"!==r.chartSpec.type&&"sankey"!==r.chartSpec.type&&"circlePacking"!==r.chartSpec.type){e=!0;break}}return e}function m(t,e,i){let r=!0,n=i.getRawChartSpec(t,e);return n&&"pie"!==n.type&&"radar"!==n.type&&"gauge"!==n.type&&"wordCloud"!==n.type&&"funnel"!==n.type&&"rose"!==n.type&&"sunburst"!==n.type&&"treemap"!==n.type&&"sankey"!==n.type&&"circlePacking"!==n.type||(r=!1),r}function y(t,e,i,r){let n=!1;if(r.indicatorsAsCol&&"row"===i||!r.indicatorsAsCol&&"col"===i)for(let t=0;t<r.indicatorsDefine.length;t++){let e=r.indicatorsDefine[t];if(e.chartSpec&&"pie"!==e.chartSpec.type&&"wordCloud"!==e.chartSpec.type&&"radar"!==e.chartSpec.type&&"gauge"!==e.chartSpec.type&&"funnel"!==e.chartSpec.type&&"rose"!==e.chartSpec.type&&"sunburst"!==e.chartSpec.type&&"treemap"!==e.chartSpec.type&&"sankey"!==e.chartSpec.type&&"circlePacking"!==e.chartSpec.type){n=!0;break}}else{let i=r.getRawChartSpec(t,e);i?"pie"!==i.type&&"radar"!==i.type&&"gauge"!==i.type&&"wordCloud"!==i.type&&"funnel"!==i.type&&"rose"!==i.type&&"sunburst"!==i.type&&"treemap"!==i.type&&"sankey"!==i.type&&"circlePacking"!==i.type&&(n=!0):n=!1}return n}function v(t,e,i){let n=i.getRawChartSpec(t,e);return n?(i._table.isPivotChart()&&((n=(0,o.u)(n)).sortDataByAxis=!0,(0,r.Z)(n.series)&&n.series.forEach(t=>{t.sortDataByAxis=!0}),"pie"!==n.type&&"radar"!==n.type&&"gauge"!==n.type&&"wordCloud"!==n.type&&"funnel"!==n.type&&"rose"!==n.type&&"sunburst"!==n.type&&"treemap"!==n.type&&"sankey"!==n.type&&"circlePacking"!==n.type&&(n.axes=i.getChartAxes(t,e)),n.padding=0,n.dataZoom=[]),n):null}function b(t,e,i){var o,c,p;let g=[];if(i.indicatorsAsCol){let c=i.getIndicatorKeyInChartSpec(t,e),p=i.getColKeysPath(t,e);c.forEach((r,s)=>{let{range:o,targetTicks:f,targetRange:m,axisOption:y,chartType:v}=(0,a.V4)(t,e,s,0===s?"bottom":"top",0===s?"top":"bottom",c,p,i);(0,n.Z)(null==y?void 0:y.max)?o.max=y.max:"boxPlot"===v&&(o.max+=(o.max-o.min)/20),(0,n.Z)(null==y?void 0:y.min)?o.min=y.min:"boxPlot"===v&&(o.min-=(o.max-o.min)/20),x(y,g)||g.push((0,l.Z)({range:o,label:{style:{fontSize:h.$M}}},y,{type:(null==y?void 0:y.type)||"linear",orient:0===s?"bottom":"top",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:(null==y?void 0:y.seriesId)?void 0:s,tick:{tickMode:(0,d.h)(f,m,o,s)},sync:{axisId:u}}))});let f=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,e);(0,r.Z)(f)&&(f=f[0]);let m=i.dataset.cacheCollectedValues[f]||i.dataset.collectedValues[f]||[],y=i.getRowKeysPath(t,e),v=m[null!=y?y:""],{axisOption:b,isPercent:_,chartType:C}=(0,a.dK)(t,e,"left",i);(null==b?void 0:b.zero)&&v&&!Array.isArray(v)&&(0,s.Z)(v.min)&&(0,s.Z)(v.max)&&((null==b?void 0:b.zero)||v.min===v.max)&&(v.min=Math.min(v.min,0),v.max=Math.max(v.max,0)),g.push((0,l.Z)({domain:"linear"!==(null==b?void 0:b.type)||Array.isArray(v)?Array.from(null!=v?v:[]):void 0,range:"linear"!==(null==b?void 0:b.type)||Array.isArray(v)?void 0:v,label:{style:{fontSize:h.$M}}},b,{type:null!=(o=null==b?void 0:b.type)?o:"band",orient:"left",label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}else{let o=i.getIndicatorKeyInChartSpec(t,e),f=i.getRowKeysPath(t,e);o.forEach((r,s)=>{var c,p;let{range:m,targetTicks:y,targetRange:v,axisOption:b}=(0,a.V4)(t,e,s,0===s?"left":"right",0===s?"right":"left",o,f,i),{chartType:_}=(0,a.dK)(t,e,0===s?"left":"right",i);if((0,n.Z)(null==b?void 0:b.max)?m.max=b.max:"boxPlot"===_&&(m.max+=(m.max-m.min)/20),(0,n.Z)(null==b?void 0:b.min)?m.min=b.min:"boxPlot"===_&&(m.min-=(m.max-m.min)/20),x(b,g))return;let C=[];if("heatmap"===_){let r=i.getDimensionKeyInChartSpec(i.rowHeaderLevelCount,e,"yField"),n=null!=(c=i.dataset.collectedValues[r])?c:[],l=i.getRowKeysPath(t,e);C=null!=(p=null==n?void 0:n[null!=l?l:""])?p:[]}g.push((0,l.Z)({range:m,label:{style:{fontSize:h.$M}},domain:"linear"===(null==b?void 0:b.type)?void 0:Array.from(C)},b,{type:(null==b?void 0:b.type)||"linear",orient:0===s?"left":"right",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:(null==b?void 0:b.seriesId)?void 0:s,tick:{tickMode:(0,d.h)(y,v,m,s),visible:!1},sync:{axisId:u}}))});let m=i.getDimensionKeyInChartSpec(t,i.columnHeaderLevelCount);(0,r.Z)(m)&&(m=m[0]);let y=i.dataset.cacheCollectedValues[m]||i.dataset.collectedValues[m]||[],v=i.getColKeysPath(t,e),b=null!=(c=null==y?void 0:y[null!=v?v:""])?c:[],{axisOption:_,isPercent:C,chartType:w}=(0,a.dK)(t,e,"bottom",i);(null==_?void 0:_.zero)&&b&&!Array.isArray(b)&&(0,s.Z)(b.min)&&(0,s.Z)(b.max)&&((null==_?void 0:_.zero)||b.min===b.max)&&(b.min=Math.min(b.min,0),b.max=Math.max(b.max,0)),g.push((0,l.Z)({domain:"linear"!==(null==_?void 0:_.type)||Array.isArray(b)?Array.from(null!=b?b:[]):void 0,range:"linear"!==(null==_?void 0:_.type)||Array.isArray(b)?void 0:b,label:{style:{fontSize:h.$M}}},_,{type:null!=(p=null==_?void 0:_.type)?p:"band",orient:"bottom",visible:!0,label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}return g}function _(t,e,i){var r;let n=i.getRawChartSpec(t,e);if(null==n?void 0:n.series){let t={};return(null==(r=n.data)?void 0:r.id)&&(t[n.data.id]=void 0),null==n||n.series.forEach(e=>{var i,r,l,s,a,o,h,d,u,c,p;if(!(null==(i=e.data)?void 0:i.fromDataId))if(null==(r=e.data)?void 0:r.transforms)t[null!=(p=null!=(u=null==(d=e.data)?void 0:d.id)?u:null==(c=n.data)?void 0:c.id)?p:"data"]=void 0;else{let i="horizontal"===e.direction?e.xField:e.yField;t[null!=(o=null!=(s=null==(l=e.data)?void 0:l.id)?s:null==(a=n.data)?void 0:a.id)?o:"data"]=(null==(h=e.data)?void 0:h.id)?i:void 0}}),t}return n.data.id}function C(t){let e=!1;for(let i=0;i<t.columnObjects.length;i++)if(t.columnObjects[i].chartSpec){e=!0;break}return e}function x(t,e){return!!(t&&(0,r.Z)(t.seriesId))&&!!(t.seriesId.length>0)&&!!(e.filter(e=>!(e.orient!==t.orient||!e.seriesId||e.seriesId.length!==t.seriesId.length||!e.seriesId.every((e,i)=>e===t.seriesId[i]))).length>0)}},26717:function(t,e,i){i.d(e,{h:()=>s,r:()=>l});var r=i(31877),n=i(73508);function l(t,e,i,l,s,a){let o=r.F.getFunction("getAxisDomainRangeAndLabels"),{axisOption:h,isZeroAlign:d}=(0,n.dK)(e,i,0===l?"right":"left",a),{ticks:u}=o(t.min,t.max,h,d,"bottom"===s||"top"===s?a._table.getColWidth(e)||a._table.tableNoFrameWidth:a._table.getRowHeight(i)||a._table.tableNoFrameHeight);return u}function s(t,e,i,r){return 0!==r&&t?()=>t.map(t=>{let r=(t-e.min)/(e.max-e.min);return Math.round(100*((i.max-i.min)*r+i.min))/100}):void 0}},26595:function(t,e,i){i.d(e,{C1:()=>d,MP:()=>a,N3:()=>u,OT:()=>o,Ul:()=>c,VN:()=>p,WM:()=>h,uu:()=>g});var r=i(95723),n=i(83624),l=i(47490),s=i(66023);function a(t){let e=t.columnObjects;for(let t=0;t<e.length;t++){let i=e[t];if(null==i?void 0:i.aggregation)return!0}return!1}function o(t){let e=t.columnObjects,i=0;for(let t=0;t<e.length;t++){let r=e[t];(null==r?void 0:r.aggregation)&&(Array.isArray(null==r?void 0:r.aggregation)?i=Math.max(i,r.aggregation.filter(t=>t.showOnTop).length):r.aggregation.showOnTop&&(i=Math.max(i,1)))}return i}function h(t){let e=t.columnObjects,i=0;for(let t=0;t<e.length;t++){let r=e[t];(null==r?void 0:r.aggregation)&&(Array.isArray(null==r?void 0:r.aggregation)?i=Math.max(i,r.aggregation.filter(t=>!t.showOnTop).length):r.aggregation.showOnTop||(i=Math.max(i,1)))}return i}function d(t){if(t._table.internalProps.groupBy)return!0;let{columns:e}=t._table.options;if((0,r.Z)(e)&&e.length>0)for(let t=0;t<e.length;t++){let i=e[t];if(!(0,n.Z)(i)&&i.tree)return!0}return!1}function u(t){let{columns:e,rows:i,indicators:l}=t.options;if(t.isPivotTable()){if((0,r.Z)(e)&&e.length>0)for(let t=0;t<e.length;t++){let i=e[t];if(!(0,n.Z)(i)&&("image"===i.headerType||"video"===i.headerType||"function"==typeof i.headerType)&&i.imageAutoSizing)return!0}if((0,r.Z)(i)&&i.length>0)for(let t=0;t<i.length;t++){let e=i[t];if(!(0,n.Z)(e)&&("image"===e.headerType||"video"===e.headerType||"function"==typeof e.headerType)&&e.imageAutoSizing)return!0}if((0,r.Z)(l)&&l.length>0)for(let t=0;t<l.length;t++){let e=l[t];if(!(0,n.Z)(e)&&(("image"===e.cellType||"video"===e.cellType||"function"==typeof e.cellType)&&e.imageAutoSizing||("image"===e.headerType||"video"===e.headerType||"function"==typeof e.headerType)&&e.imageAutoSizing))return!0}}else if((0,r.Z)(e)&&e.length>0)for(let t=0;t<e.length;t++){let i=e[t];if(("image"===i.cellType||"video"===i.cellType||"function"==typeof i.cellType)&&i.imageAutoSizing||("image"===i.headerType||"video"===i.headerType||"function"==typeof i.headerType)&&i.imageAutoSizing)return!0}return!1}function c(t,e){var i,r,n,a,o,h,d,u,c,g,f,m,y,v,b;let _,C;e.columnTree&&(!1!==t.options.indicatorsAsCol&&!1!==t.options.supplementIndicatorNodes&&(t.internalProps.columnTree=p(t.internalProps.columnTree,e.indicators)),_=new s.KO(null!=(i=t.internalProps.columnTree)?i:[],t.layoutNodeId,t.options.columnHierarchyType,"grid"!==t.options.columnHierarchyType?null!=(r=t.options.columnExpandLevel)?r:1:void 0)),e.rowTree&&(!1===t.options.indicatorsAsCol&&!1!==t.options.supplementIndicatorNodes&&(t.internalProps.rowTree=p(t.internalProps.rowTree,e.indicators)),C=new s.KO(null!=(n=t.internalProps.rowTree)?n:[],t.layoutNodeId,t.options.rowHierarchyType,"grid"!==t.options.rowHierarchyType?null!=(a=t.options.rowExpandLevel)?a:1:void 0));let x=(null==(o=null==C?void 0:C.dimensionKeys)?void 0:o.count)?C.dimensionKeys.valueArr():null!=(d=null==(h=e.rows)?void 0:h.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?d:[],w=(null==(u=null==_?void 0:_.dimensionKeys)?void 0:u.count)?_.dimensionKeys.valueArr():null!=(g=null==(c=e.columns)?void 0:c.reduce((t,e)=>("string"==typeof e?t.push(e):t.push(e.dimensionKey),t),[]))?g:[],S=null!=(m=null==(f=e.indicators)?void 0:f.reduce((e,i)=>{var r;return"string"==typeof i?e.push(i):(e.push(i.indicatorKey),(i.chartSpec||i.sparklineSpec)&&((null==(r=t.internalProps.dataConfig)?void 0:r.aggregationRules)?t.internalProps.dataConfig.aggregationRules.find(t=>t.indicatorKey===i.indicatorKey)||t.internalProps.dataConfig.aggregationRules.push({field:i.indicatorKey,indicatorKey:i.indicatorKey,aggregationType:l.E.NONE}):t.internalProps.dataConfig?t.internalProps.dataConfig.aggregationRules=[{field:i.indicatorKey,indicatorKey:i.indicatorKey,aggregationType:l.E.NONE}]:t.internalProps.dataConfig={aggregationRules:[{field:i.indicatorKey,indicatorKey:i.indicatorKey,aggregationType:l.E.NONE}]})),e},[]))?m:[];return"grid"!==e.rowHierarchyType&&(null!=(v=null==(y=e.extensionRows)?void 0:y.length)?v:0)>=1&&(null==(b=e.extensionRows)||b.forEach(t=>{let e=[];t.rows.forEach(t=>{"string"==typeof t?e.push(t):e.push(t.dimensionKey)}),x.push(...e)})),{rowKeys:x,columnKeys:w,indicatorKeys:S,columnDimensionTree:_,rowDimensionTree:C}}function p(t,e){let i=(t,r)=>{t.forEach(t=>{var n;t.indicatorKey||r||(null==(n=t.children)?void 0:n.length)&&t.children?t.children&&Array.isArray(t.children)&&i(t.children,r||!!t.indicatorKey):t.children=null==e?void 0:e.map(t=>{var e;return"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:null!=(e=t.title)?e:t.indicatorKey}})})};return(null==t?void 0:t.length)?i(t,!1):t=null==e?void 0:e.map(t=>{var e;return"string"==typeof t?{indicatorKey:t,value:t}:{indicatorKey:t.indicatorKey,value:null!=(e=t.title)?e:t.indicatorKey}}),t}function g(t,e,i,r){let n=[];for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t];(null==i?void 0:i.hide)&&n.push(i)}(n.length||i)&&(0,s.gD)(t,[],n,i,r)}},25987:function(t,e,i){i.d(e,{z:()=>g});var r=i(6958),n=i(72281),l=i(77874),s=i(994),a=i(66023),o=i(64776),h=i(95723),d=i(65755),u=i(74577),c=i(31877);let p={startInTotal:0,afterSpanLevel:0};class g{constructor(t,e,i,n){var s,a,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T,k;this.colIndex=0,this._showHeader=!0,this.columnHeaderObjs=[],this.rowHeaderObjs=[],this._cornerHeaderCellFullPathIds=[],this._columnHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds_FULL=[],this._cornerHeaderCellIds=[],this._columnHeaderCellIds=[],this._rowHeaderCellIds=[],this._rowHeaderCellIds_FULL=[],this._columnWidths=[],this.columnPaths=[],this._headerObjects=[],this._headerObjectMap={},this._indicators=[],this.indicatorsAsCol=!0,this.hideIndicatorName=!1,this._showRowHeader=!0,this._showColumnHeader=!0,this._indicatorShowType="column",this.rowHierarchyTextStartAlignment=!1,this.rowDimensionKeys=[],this.colDimensionKeys=[],this.indicatorKeys=[],this.indicatorDimensionKey=l.ek,this._rowHeaderExtensionTree={},this._extensionRowDimensionKeys=[],this.fullRowDimensionKeys=[],this.hasLeftIndicatorAxis=!1,this.hasRightIndicatorAxis=!1,this.hasTopIndicatorAxis=!1,this.hasBottomIndicatorAxis=!1,this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this._useGetBodyCache=!1,this._getBodyCache=new Map,this._useHeaderPathCache=!1,this._colHeaderPathCache=new Map,this._rowHeaderPathCache=new Map,this.matchDimensionPath=(t,e,i,r=!1,n=0)=>{if(n>=t.length)return;let l=t[n];for(let s=0;s<e.length;s++){let a=e[s];if(!(0,o.Z)(l.indicatorKey)&&a.dimensionKey===l.dimensionKey&&a.value===l.value||(0,o.Z)(l.indicatorKey)&&a.indicatorKey===l.indicatorKey&&((0,o.Z)(a.value)&&(0,o.Z)(l.value)&&l.value===a.value||!(0,o.Z)(a.value)||!(0,o.Z)(l.value))){let e=a.children;if(n===t.length-1){if(!i)return a;{let t=r&&e&&e.some(t=>"axis"===t.dimensionKey);if(!(null==e?void 0:e.length)||t)return a;let i=t=>{for(let e of t){let t=e.children,n=r&&t&&t.some(t=>"axis"===t.dimensionKey);if(!(null==t?void 0:t.length)||n)return e;let l=i(t);if(l)return l}},n=i(e);if(n)return n}}if(null==e?void 0:e.length){let l=this.matchDimensionPath(t,e,i,r,n+1);if(l)return l}else if(n===t.length-1)return a}}},this.sharedVar=t.layoutNodeId,this._table=t,"tree"===t.options.rowHierarchyType&&(this.extensionRows=t.options.extensionRows),this.dataset=e,this._largeCellRangeCache=[],this._CellHeaderPathMap=new Map,this.rowTree=t.internalProps.rowTree,this.columnTree=t.internalProps.columnTree,this.rowsDefine=null!=(s=t.internalProps.rows)?s:[],this.columnsDefine=null!=(a=t.internalProps.columns)?a:[],this.indicatorsDefine=null!=(d=t.internalProps.indicators)?d:[],this.indicatorTitle=t.options.indicatorTitle,this.indicatorsAsCol=null==(u=t.options.indicatorsAsCol)||u,this.hideIndicatorName=null!=(c=t.options.hideIndicatorName)&&c,this.showRowHeader=null==(p=t.options.showRowHeader)||p,this.showColumnHeader=null==(g=t.options.showColumnHeader)||g,this.rowHeaderTitle=t.options.rowHeaderTitle,this.columnHeaderTitle=t.options.columnHeaderTitle,this.rowHierarchyType=null!=(f=t.options.rowHierarchyType)?f:"grid",this.columnHierarchyType=null!=(m=t.options.columnHierarchyType)?m:"grid",this.rowExpandLevel=null!=(y=t.options.rowExpandLevel)?y:1,this.columnExpandLevel=null!=(v=t.options.columnExpandLevel)?v:1,this.rowHierarchyIndent=null!=(b=t.options.rowHierarchyIndent)?b:20,this.rowHierarchyTextStartAlignment=t.options.rowHierarchyTextStartAlignment,this.cornerSetting=Object.assign({titleOnDimension:"column",forceShowHeader:!1},t.options.corner),(null==(C=null==(_=this._table.options)?void 0:_.customConfig)?void 0:C.enablePivotPathCache)&&(this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()),e&&(this.rowTree=e.rowHeaderTree,this.columnTree=e.colHeaderTree),null==(x=this.indicatorsDefine)||x.forEach(t=>{"string"==typeof t?this.indicatorKeys.push(t):this.indicatorKeys.push(t.indicatorKey)}),this.columnDimensionTree=i,this.rowDimensionTree=n,this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this._table.isPivotChart()&&(this.hasLeftIndicatorAxis=!1,this.hasRightIndicatorAxis=!1,this.hasTopIndicatorAxis=!1,this.hasBottomIndicatorAxis=!1,this.indicatorsDefine.forEach(t=>{var e,i,r,n;if(t.hasLeftIndicatorAxis=!1,t.hasRightIndicatorAxis=!1,t.hasTopIndicatorAxis=!1,t.hasBottomIndicatorAxis=!1,!(null==t?void 0:t.chartSpec))return;let l=null!=(i=null!=(e=t.chartSpec.axes)?e:this._table.pivotChartAxes)?i:[],s=new Set;(null!=l?l:[]).forEach(t=>{(null==t?void 0:t.orient)&&!1!==t.visible&&s.add(t.orient)});let a=(null==(n=null==(r=t.chartSpec)?void 0:r.series)?void 0:n.length)>1;if(this.indicatorsAsCol){let e=s.has("top"),i=s.has("bottom");if(l.length||(i=!0),a){let t=l.some(t=>"top"===(null==t?void 0:t.orient)&&!1===t.visible);l.length&&t||(e=!0,l.some(t=>"bottom"===(null==t?void 0:t.orient)&&!1===t.visible)||(i=!0))}t.hasTopIndicatorAxis=e,t.hasBottomIndicatorAxis=i,t.hasLeftIndicatorAxis=!1,t.hasRightIndicatorAxis=!1}else{let e=s.has("left"),i=s.has("right");if(l.length||(e=!0),a){let t=l.some(t=>"right"===(null==t?void 0:t.orient)&&!1===t.visible);l.length&&t||(i=!0,l.some(t=>"left"===(null==t?void 0:t.orient)&&!1===t.visible)||(e=!0))}t.hasLeftIndicatorAxis=e,t.hasRightIndicatorAxis=i,t.hasTopIndicatorAxis=!1,t.hasBottomIndicatorAxis=!1}this.hasLeftIndicatorAxis||(this.hasLeftIndicatorAxis=!!t.hasLeftIndicatorAxis),this.hasRightIndicatorAxis||(this.hasRightIndicatorAxis=!!t.hasRightIndicatorAxis),this.hasTopIndicatorAxis||(this.hasTopIndicatorAxis=!!t.hasTopIndicatorAxis),this.hasBottomIndicatorAxis||(this.hasBottomIndicatorAxis=!!t.hasBottomIndicatorAxis)})),this.resetRowHeaderLevelCount(),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=(0,r.p4)(this._rowHeaderCellFullPathIds_FULL),"tree"===t.options.rowHierarchyType&&(null==(w=this.extensionRows)?void 0:w.length)>=1&&(this.generateExtensionRowTree(),this.extensionRows.forEach(t=>{let e=[];t.rows.forEach(t=>{"string"==typeof t?e.push(t):e.push(t.dimensionKey)}),this._extensionRowDimensionKeys.push(e),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(e)})),this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let R,P=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr();!this.dataset||this._table.isPivotChart()||0!==(null!=(A=null==(S=this.dataset.records)?void 0:S.length)?A:0)||this.dataset.customColTree||(P=this.columnsDefine.map(t=>"string"==typeof t?t:t.dimensionKey),this.indicatorsAsCol&&P.push(this.indicatorDimensionKey)),P=this.columnHeaderTitle?[""].concat(P):P;let B=[];if("tree"===this.rowHierarchyType&&(null==(M=this.extensionRows)?void 0:M.length)>=1){let t=[];t.push(this.rowDimensionKeys[0]),this._extensionRowDimensionKeys.forEach(e=>{t.push(e[0])}),B=this.extensionRows.reduce((t,e)=>t.concat(e.rows),[]),R=this.rowHeaderTitle?[""].concat(t):t}else R=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),!this.dataset||this._table.isPivotChart()||0!==(null!=(k=null==(T=this.dataset.records)?void 0:T.length)?k:0)||this.dataset.customRowTree||(R=this.rowsDefine.map(t=>"string"==typeof t?t:t.dimensionKey),this.indicatorsAsCol||R.push(this.indicatorDimensionKey)),R=this.rowHeaderTitle?[""].concat(R):R;this.cornerHeaderObjs=this._addCornerHeaders(P,R,this.columnsDefine.concat(...this.rowsDefine,...B)),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this.indicatorsAsCol&&!this.hideIndicatorName?this._indicatorShowType="column":this.indicatorsAsCol||this.hideIndicatorName?this._indicatorShowType="none":this._indicatorShowType="row",this.generateCellIdsConsiderHideHeader(),this.setPagination(t.options.pagination),this._table.isPivotChart()&&(this._chartItemSpanSize=0,this._chartItemBandSize=0,this._indicators.find(t=>{var e,i,r,n,l,s,a,o;(null==(e=null==t?void 0:t.style)?void 0:e.padding)&&(this._chartPadding=t.style.padding),(null==(i=t.chartSpec)?void 0:i.barWidth)&&"number"==typeof t.chartSpec.barWidth&&(this._chartItemSpanSize=null==(r=t.chartSpec)?void 0:r.barWidth);let d=null==(l=null==(n=t.chartSpec)?void 0:n.axes)?void 0:l.find(t=>"band"===t.type);return(null==d?void 0:d.bandSize)&&(this._chartItemBandSize=null==d?void 0:d.bandSize,this._chartPaddingInner=null!=(s=(0,h.Z)(d.paddingInner)?d.paddingInner[0]:d.paddingInner)?s:0,this._chartPaddingOuter=null!=(a=(0,h.Z)(d.paddingOuter)?d.paddingOuter[0]:d.paddingOuter)?a:0),this._chartItemSpanSize>0||(null==(o=t.chartSpec.series)||o.find(t=>(t.barWidth&&"number"==typeof t.barWidth&&(this._chartItemSpanSize=t.barWidth),this._chartItemSpanSize>0)),!1)})),this.handleRowSeriesNumber(t.internalProps.rowSeriesNumber),this.setColumnWidths()}handleRowSeriesNumber(t){var e;t&&(Array.isArray(t)?this.rowSeriesNumberColumn=t.map(t=>{var e;return{id:"",title:t.title,define:t,cellType:null!=(e=t.cellType)?e:"text",headerType:t.cellType&&"radio"!==t.cellType?t.cellType:"text",width:t.width,style:t.style,format:t.format,field:t.field,icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:"",title:t.title,define:t,cellType:null!=(e=t.cellType)?e:"text",headerType:t.cellType&&"radio"!==t.cellType?t.cellType:"text",style:t.style,width:t.width,format:t.format,field:"",icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(t=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(t=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}_generateColHeaderIds(){var t,e,i,r,n,l,s,a;if((null==(t=this.columnDimensionTree.tree.children)?void 0:t.length)>=1)if("grid-tree"===this.columnHierarchyType)this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1);else{let t=0;if(this.dataset&&!this._table.isPivotChart()&&0===(null!=(i=null==(e=this.dataset.records)?void 0:e.length)?i:0)&&!this.dataset.customColTree&&!this.dataset.customRowTree&&this.indicatorsAsCol&&this._getColumnHeaderTreeExpandedMaxLevelCount()<this.columnHeaderLevelCount){t=this.columnHeaderLevelCount-this._getColumnHeaderTreeExpandedMaxLevelCount();for(let e=0;e<t;e++)this._columnHeaderCellFullPathIds.unshift([])}this._addHeaders(this._columnHeaderCellFullPathIds,t,this.columnDimensionTree.tree.children,[],this.columnHeaderObjs)}if(this.columnHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let t=++this.sharedVar.seqId,e=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(t);this._columnHeaderCellFullPathIds.unshift(e);let i={id:t,title:"string"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(n=null==(r=this.columnHeaderTitle)?void 0:r.headerType)?n:"text",style:null==(l=this.columnHeaderTitle)?void 0:l.headerStyle,define:{id:t,disableHeaderHover:!!(null==(s=this.columnHeaderTitle)?void 0:s.disableHeaderHover),disableHeaderSelect:!!(null==(a=this.columnHeaderTitle)?void 0:a.disableHeaderSelect)}};this.columnHeaderObjs.push(i),this._headerObjects[t]=i}}_generateRowHeaderIds(){var t,e,i,r,n,l,s,a,o,h;if((null==(t=this.rowDimensionTree.tree.children)?void 0:t.length)>=1)if("tree"===this.rowHierarchyType)this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs);else if("grid-tree"===this.rowHierarchyType)this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0);else{let t=0;if(this.dataset&&!this._table.isPivotChart()&&0===(null!=(i=null==(e=this.dataset.records)?void 0:e.length)?i:0)&&!this.dataset.customColTree&&!this.dataset.customRowTree&&!this.indicatorsAsCol&&this._getRowHeaderTreeExpandedMaxLevelCount()<this.rowHeaderLevelCount){t=this.rowHeaderLevelCount-this._getRowHeaderTreeExpandedMaxLevelCount();for(let e=0;e<t;e++)this._rowHeaderCellFullPathIds_FULL.unshift([])}this._addHeaders(this._rowHeaderCellFullPathIds_FULL,t,this.rowDimensionTree.tree.children,[],this.rowHeaderObjs)}if(this.rowHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let t=++this.sharedVar.seqId,e=Array(null!=(n=null==(r=this._rowHeaderCellFullPathIds_FULL[0])?void 0:r.length)?n:this.rowDimensionTree.tree.size).fill(t);this._rowHeaderCellFullPathIds_FULL.unshift(e);let i={id:t,title:"string"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(s=null==(l=this.rowHeaderTitle)?void 0:l.headerType)?s:"text",style:null==(a=this.rowHeaderTitle)?void 0:a.headerStyle,define:{id:t,disableHeaderHover:!!(null==(o=this.rowHeaderTitle)?void 0:o.disableHeaderHover),disableHeaderSelect:!!(null==(h=this.rowHeaderTitle)?void 0:h.disableHeaderSelect)}};this.rowHeaderObjs.push(i),this._headerObjects[t]=i}}_getRowHeaderTreeExpandedMaxLevelCount(){return"tree"===this.rowHierarchyType?1:"grid-tree"===this.rowHierarchyType?"row"===this.cornerSetting.titleOnDimension?this.rowDimensionTree.totalLevel:this.indicatorsAsCol?this.rowDimensionTree.expandedMaxLevel:this.rowDimensionTree.expandedMaxLevel+1:this.rowDimensionTree.totalLevel}_getColumnHeaderTreeExpandedMaxLevelCount(){return"grid-tree"===this.columnHierarchyType?"column"===this.cornerSetting.titleOnDimension?this.columnDimensionTree.totalLevel:!1===this.indicatorsAsCol?this.columnDimensionTree.expandedMaxLevel:this.columnDimensionTree.expandedMaxLevel+1:this.columnDimensionTree.totalLevel}_addHeaders(t,e,i,r,n){let l=this;t[e]||function(e){let i=t[e]=[];if(0===l.colIndex)return;let r=t[e-1];for(let t=0;t<(null==r?void 0:r.length);t++)i[t]=r[t]}(e);for(let l=0;l<i.length;l++){let s=i[l];(0,a.g3)(s,t,n,r,e,this)}}_addHeadersForTreeMode(t,e,i,r,n,l,s,o){let h=this;t[e]||function(e){let i=t[e]=[];if(0===h.colIndex)return;let r=t[e-1];for(let t=0;t<(null==r?void 0:r.length);t++)i[t]=r[t]}(e);for(let h=0;h<i.length;h++){let d=i[h];(0,a.py)(d,t,o,r,e,n,l,s,this)}}_addHeadersForGridTreeMode(t,e,i,r,n,l,s,o,h,d){let u=this;t[e]||function(e){let i=t[e]=[];if(0===u.colIndex)return;let r=t[e-1];for(let t=0;t<(null==r?void 0:r.length);t++)i[t]=r[t]}(e);for(let u=0;u<i.length;u++){let c=i[u];(0,a.jS)(c,t,h,r,e,n,l,s,o,d,this.indicatorsAsCol,this)}}_addCornerHeaders(t,e,i){var r,n,l,s,a,o,h,d,u,c;this._cornerHeaderCellFullPathIds=[];let p=[],g="grid-tree"===this.columnHierarchyType&&this._getColumnHeaderTreeExpandedMaxLevelCount()||this.columnHeaderLevelCount,f="grid-tree"===this.rowHierarchyType&&this._getRowHeaderTreeExpandedMaxLevelCount()||this.rowHeaderLevelCount;if(0===g||0===f)return p;if("all"===this.cornerSetting.titleOnDimension)if(this.indicatorsAsCol){if(t)for(let e=0;e<g;e++){let l=t[e],s=++this.sharedVar.seqId,a=i.find(t=>"string"!=typeof t&&t.dimensionKey===l),o={id:s,title:l===this.indicatorDimensionKey?this.indicatorTitle:a?a.title:"axis"===l?"":l,field:l,style:this.cornerSetting.headerStyle,headerType:null!=(r=this.cornerSetting.headerType)?r:"text",showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,define:{showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,dimensionKey:l,id:s,value:l,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==a?void 0:a.cornerDropDownMenu,headerIcon:null==a?void 0:a.cornerHeaderIcon,pivotInfo:{value:null!=(n=null==a?void 0:a.title)?n:"",dimensionKey:l,isPivotCorner:!0},description:null==a?void 0:a.cornerDescription};p[s]=o,this._headerObjects[s]=o,this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]);for(let t=0;t<f;t++)this._cornerHeaderCellFullPathIds[e][t]=s}if(e)for(let t=0;t<f;t++){let r=e[t],n=++this.sharedVar.seqId,a=i.find(t=>"string"!=typeof t&&t.dimensionKey===r),o={id:n,title:r===this.indicatorDimensionKey?this.indicatorTitle:a?a.title:"axis"===r?"":r,field:r,style:this.cornerSetting.headerStyle,headerType:null!=(l=this.cornerSetting.headerType)?l:"text",showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,define:{showSort:null==a?void 0:a.showSortInCorner,sort:null==a?void 0:a.sort,dimensionKey:r,id:n,value:r,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==a?void 0:a.cornerDropDownMenu,headerIcon:null==a?void 0:a.cornerHeaderIcon,pivotInfo:{value:null!=(s=null==a?void 0:a.title)?s:"",dimensionKey:r,isPivotCorner:!0},description:null==a?void 0:a.cornerDescription};p[n]=o,this._headerObjects[n]=o,this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]||(this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]=[]),this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1][t]=n}}else{if(e)for(let t=0;t<f;t++){let r=e[t],n=++this.sharedVar.seqId,l=i.find(t=>"string"!=typeof t&&t.dimensionKey===r),s={id:n,title:r===this.indicatorDimensionKey?this.indicatorTitle:l?l.title:"axis"===r?"":r,field:r,style:this.cornerSetting.headerStyle,headerType:null!=(a=this.cornerSetting.headerType)?a:"text",showSort:null==l?void 0:l.showSortInCorner,sort:null==l?void 0:l.sort,define:{showSort:null==l?void 0:l.showSortInCorner,sort:null==l?void 0:l.sort,dimensionKey:r,id:n,value:r,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==l?void 0:l.cornerDropDownMenu,headerIcon:null==l?void 0:l.cornerHeaderIcon,pivotInfo:{value:null!=(o=null==l?void 0:l.title)?o:"",dimensionKey:r,isPivotCorner:!0},description:null==l?void 0:l.cornerDescription};p[n]=s,this._headerObjects[n]=s;for(let e=0;e<g;e++)this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]),this._cornerHeaderCellFullPathIds[e][t]=n}if(t)for(let e=0;e<g;e++){let r=t[e],n=++this.sharedVar.seqId,l=i.find(t=>"string"!=typeof t&&t.dimensionKey===r),s={id:n,title:r===this.indicatorDimensionKey?this.indicatorTitle:l?l.title:"axis"===r?"":r,field:r,style:this.cornerSetting.headerStyle,headerType:null!=(h=this.cornerSetting.headerType)?h:"text",showSort:null==l?void 0:l.showSortInCorner,sort:null==l?void 0:l.sort,define:{showSort:null==l?void 0:l.showSortInCorner,sort:null==l?void 0:l.sort,dimensionKey:r,id:n,value:r,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==l?void 0:l.cornerDropDownMenu,headerIcon:null==l?void 0:l.cornerHeaderIcon,pivotInfo:{value:null!=(d=null==l?void 0:l.title)?d:"",dimensionKey:r,isPivotCorner:!0},description:null==l?void 0:l.cornerDescription};p[n]=s,this._headerObjects[n]=s,this._cornerHeaderCellFullPathIds[e][this._cornerHeaderCellFullPathIds[e].length-1]=n}}else if("row"===this.cornerSetting.titleOnDimension||"column"===this.cornerSetting.titleOnDimension){let r="row"===(null==(u=this.cornerSetting)?void 0:u.titleOnDimension)?e:t;r&&r.forEach((t,e)=>{var r,n;let l=++this.sharedVar.seqId,s=i.find(e=>"string"!=typeof e&&e.dimensionKey===t),a={id:l,title:t===this.indicatorDimensionKey?this.indicatorTitle:s?s.title:"axis"===t?"":t,field:t,style:this.cornerSetting.headerStyle,headerType:null!=(r=this.cornerSetting.headerType)?r:"text",showSort:null==s?void 0:s.showSortInCorner,sort:null==s?void 0:s.sort,define:{showSort:null==s?void 0:s.showSortInCorner,sort:null==s?void 0:s.sort,dimensionKey:t,id:l,value:t,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==s?void 0:s.cornerDropDownMenu,headerIcon:null==s?void 0:s.cornerHeaderIcon,pivotInfo:{value:null!=(n=null==s?void 0:s.title)?n:"",dimensionKey:t,isPivotCorner:!0},description:null==s?void 0:s.cornerDescription};if(p[l]=a,this._headerObjects[l]=a,"column"===this.cornerSetting.titleOnDimension){this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]);for(let t=0;t<this.rowHeaderLevelCount;t++)this._cornerHeaderCellFullPathIds[e][t]=l}else if("row"===this.cornerSetting.titleOnDimension)for(let t=0;t<this.columnHeaderLevelCount;t++)this._cornerHeaderCellFullPathIds[t]||(this._cornerHeaderCellFullPathIds[t]=[]),this._cornerHeaderCellFullPathIds[t][e]=l})}else{let t=++this.sharedVar.seqId,e={id:t,title:"",field:"维度名称",style:this.cornerSetting.headerStyle,headerType:null!=(c=this.cornerSetting.headerType)?c:"text",define:{dimensionKey:"维度名称",id:t,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect}};p[t]=e,this._headerObjects[t]=e;for(let e=0;e<this.columnHeaderLevelCount;e++)for(let i=0;i<this.rowHeaderLevelCount;i++)this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]),this._cornerHeaderCellFullPathIds[e][i]=t}return p}generateExtensionRowTree(){this.extensionRows.forEach((t,e)=>{let i=this._rowHeaderCellFullPathIds_FULL;this._rowHeaderCellFullPathIds_FULL=[],i.forEach((e,i)=>{let r,n,l=e[e.length-1];if(this.colIndex=0,"function"==typeof t.rowTree){let i=this.findFullCellIds(e);r=t.rowTree(i.map(t=>({dimensionKey:this._headerObjects[t].field,value:this._headerObjects[t].title})))}else r=(0,d.Z)(t.rowTree);this._rowHeaderExtensionTree[l]?(this._rowHeaderExtensionTree[l].reset(this._rowHeaderExtensionTree[l].tree.children),n=this._rowHeaderExtensionTree[l]):(n=new a.KO(null!=r?r:[],this.sharedVar,this.rowHierarchyType,void 0),this._rowHeaderExtensionTree[l]=n);let s=[];this._addHeadersForTreeMode(s,0,n.tree.children,[],n.totalLevel,!0,t.rows,this.rowHeaderObjs);for(let t=0;t<s[0].length;t++)this._rowHeaderCellFullPathIds_FULL.push(e.concat(s[0][t]))})})}setColumnWidths(){var t,e,i;let r=Array(this.colCount).fill(void 0);if(this.leftRowSeriesNumberColumnCount&&(r[0]=this.leftRowSeriesNumberColumn[0]),this.showHeader&&this.showRowHeader)if(this.rowHeaderTitle&&(r[0+this.leftRowSeriesNumberColumnCount]={}),"tree"===this.rowHierarchyType){let i=this.rowDimensionKeys[0];if(i){let e=null==(t=this.rowsDefine)?void 0:t.find(t=>"string"!=typeof t&&t.dimensionKey===i);e&&(r[0+ +!!this.rowHeaderTitle+this.leftRowSeriesNumberColumnCount]={width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth})}null==(e=this._extensionRowDimensionKeys)||e.forEach((t,e)=>{var i;let n=t[0];if(n){let t=null==(i=this.extensionRows[e].rows)?void 0:i.find(t=>"string"!=typeof t&&t.dimensionKey===n);t&&(r[e+1+ +!!this.rowHeaderTitle+this.leftRowSeriesNumberColumnCount]={width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth})}})}else(this.rowDimensionTree.totalLevel>0?this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr():this.rowsDefine.map(t=>"string"==typeof t?t:t.dimensionKey)).forEach((t,e)=>{var i;let n=null==(i=this.rowsDefine)?void 0:i.find(e=>"string"!=typeof e&&e.dimensionKey===t);n&&(r[e+ +!!this.rowHeaderTitle+this.leftRowSeriesNumberColumnCount]={width:n.width,minWidth:n.minWidth,maxWidth:n.maxWidth})});if(this.indicatorsAsCol)for(let t=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;t<this.colCount;t++){let e=this.getBody(t,this.columnHeaderLevelCount);r[t]={width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,maxWidth:null==e?void 0:e.maxWidth}}else{let t,e,n,l=0;null==(i=this._indicators)||i.forEach((i,r)=>{var s,a;"number"==typeof i.width?l=Math.max(i.width,l):"auto"===i.width&&(n=!0),"number"==typeof i.minWidth&&(e=Math.max(i.minWidth,null!=(s=e)?s:0)),"number"==typeof i.maxWidth&&(t=Math.min(i.maxWidth,null!=(a=t)?a:Number.MAX_VALUE))}),l=l>0?l:n?"auto":void 0,r.fill({width:l,minWidth:e,maxWidth:t},this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,this.colCount-this.rightFrozenColCount)}this._columnWidths=r}get columnWidths(){return this._columnWidths}getColumnWidthDefined(t){return this._columnWidths[t]}get showHeader(){return this._showHeader}set showHeader(t){this._showHeader=t}get showColumnHeader(){return this._showColumnHeader}set showColumnHeader(t){this._showColumnHeader=t}get showRowHeader(){return this._showRowHeader}set showRowHeader(t){this._showRowHeader=t}get columnHeaderTitle(){return this._columnHeaderTitle}set columnHeaderTitle(t){this._columnHeaderTitle=t}get rowHeaderTitle(){return this._rowHeaderTitle}set rowHeaderTitle(t){this._rowHeaderTitle=t}getHeaderFieldKey(t,e){}getCellLocation(t,e){return this.isCornerHeader(t,e)?"cornerHeader":this.isColumnHeader(t,e)?"columnHeader":this.isRowHeader(t,e)?"rowHeader":"body"}isHeader(t,e){return t>=this.leftRowSeriesNumberColumnCount&&t<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||e>=0&&e<this.columnHeaderLevelCount||t>=this.colCount-this.rightHeaderColCount||e>=this.rowCount-this.bottomHeaderRowCount}isCornerHeader(t,e){return t>=0&&t<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&e>=0&&e<this.columnHeaderLevelCount}isColumnHeader(t,e){return t>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&e>=0&&e<this.columnHeaderLevelCount}isRowHeader(t,e){return t>=this.leftRowSeriesNumberColumnCount&&t<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&e>=this.columnHeaderLevelCount}isFrozen(t,e){return this.isFrozenColumn(t)||this.isRightFrozenColumn(t)||this.isBottomFrozenRow(e)||this.isFrozenRow(e)||this.isSeriesNumberInBody(t,e)||this.isSeriesNumberInHeader(t,e)}isFrozenColumn(t,e){if((0,o.Z)(e)){if(t>=0&&t<this.frozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&t>=0&&t<this.frozenColCount)return!0;return!1}isRightFrozenColumn(t,e){if((0,o.Z)(e)){if(t>=this.colCount-this.rightFrozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&t>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(t,e){if((0,o.Z)(e)){if(e>=0&&e<this.frozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.frozenRowCount>0&&e>=0&&e<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(t,e){if((0,o.Z)(e)){if(e>=this.rowCount-this.bottomFrozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.bottomFrozenRowCount>0&&e>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=0&&e<this.frozenRowCount}isLeftBottomCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=0&&e<this.frozenRowCount}isRightBottomCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}getColumnHeaderRange(){return{start:{col:this.rowHeaderLevelCount,row:0},end:{col:this.colCount-1,row:this.columnHeaderLevelCount-1}}}getRowHeaderRange(){return{start:{col:0,row:this.columnHeaderLevelCount},end:{col:this.rowHeaderLevelCount-1,row:this.rowCount-1}}}getCornerHeaderRange(){return{start:{col:0,row:0},end:{col:this.rowHeaderLevelCount-1,row:this.columnHeaderLevelCount-1}}}getBodyRange(){return{start:{col:this.rowHeaderLevelCount,row:this.columnHeaderLevelCount},end:{col:this.colCount-1,row:this.rowCount-1}}}resetCellIds(){}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get headerLevelCount(){return this.columnHeaderLevelCount}resetColumnHeaderLevelCount(){var t,e,i,r,n,l,a,o,h,d,u;if(this.showHeader&&this.showColumnHeader){if(this._table.isPivotChart()&&this.indicatorsAsCol&&!(null==(e=null==(t=this.dataset)?void 0:t.colKeys)?void 0:e.length)&&0===(null==(r=null==(i=this.columnDimensionTree)?void 0:i.tree)?void 0:r.level)&&!this.hasTopIndicatorAxis)return void(this.columnHeaderLevelCount=0);let c=this._getColumnHeaderTreeExpandedMaxLevelCount();return this.indicatorsAsCol&&this.hideIndicatorName&&this.colDimensionKeys[this.colDimensionKeys.length-1]===this.indicatorDimensionKey&&c--,0!==c||!this.dataset||(null==(n=this.dataset.customColTree)?void 0:n.length)?!this.dataset||this._table.isPivotChart()||0!==(null!=(d=null==(h=this.dataset.records)?void 0:h.length)?d:0)||this.dataset.customColTree||"column"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(c=null!=(u=this.columnsDefine.length)?u:0,!this.hideIndicatorName&&this.indicatorsAsCol&&c++):("row"===this.cornerSetting.titleOnDimension||"all"===this.cornerSetting.titleOnDimension)&&this.cornerSetting.forceShowHeader?c=1:this._table.isPivotChart()||0!==(null!=(a=null==(l=this.dataset.records)?void 0:l.length)?a:0)||"column"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(c=null!=(o=this.columnsDefine.length)?o:0),this.columnHeaderTitle&&(c+=1),this._table.isPivotChart()&&this.indicatorsAsCol&&!this.hasTopIndicatorAxis&&(0,s.eW)(this.indicatorsDefine)&&(c-=1),void(this.columnHeaderLevelCount=c)}this.columnHeaderLevelCount=this.indicatorsAsCol?+!this.hideIndicatorName:0}resetRowHeaderLevelCount(){var t,e,i,r,n,l,a,o;if(this.showHeader&&this.showRowHeader){if("tree"===this.rowHierarchyType){let i=null!=(e=null==(t=this.extensionRows)?void 0:t.length)?e:0;return this.rowHeaderTitle?void(this.rowHeaderLevelCount=1+ +!!this.rowDimensionTree.totalLevel+i):void(this.rowHeaderLevelCount=+!!this.rowDimensionTree.totalLevel+i)}let h=this._getRowHeaderTreeExpandedMaxLevelCount(),d=h;return 0!==d||!this.dataset||(null==(i=this.dataset.customRowTree)?void 0:i.length)?!this.dataset||this._table.isPivotChart()||0!==(null!=(o=null==(a=this.dataset.records)?void 0:a.length)?o:0)||this.dataset.customRowTree||"row"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(d=this.rowsDefine.length,this.hideIndicatorName||this.indicatorsAsCol||d++):("column"===this.cornerSetting.titleOnDimension||"all"===this.cornerSetting.titleOnDimension)&&this.cornerSetting.forceShowHeader?d=1:this._table.isPivotChart()||0!==(null!=(n=null==(r=this.dataset.records)?void 0:r.length)?n:0)||"row"!==this.cornerSetting.titleOnDimension&&"all"!==this.cornerSetting.titleOnDimension||(d=null!=(l=this.rowsDefine.length)?l:0),!this.indicatorsAsCol&&(this.hideIndicatorName||!this.hasLeftIndicatorAxis&&this._table.isPivotChart()&&(0,s.eW)(this.indicatorsDefine))&&this.rowDimensionKeys[this.rowDimensionKeys.length-1]===this.indicatorDimensionKey&&(d=h-1),this.rowHeaderTitle&&(d+=1),void(this.rowHeaderLevelCount=d)}this.rowHeaderLevelCount=this.indicatorsAsCol||this.hideIndicatorName?0:1}get columnHeaderLevelCount(){return this._columnHeaderLevelCount}set columnHeaderLevelCount(t){this._columnHeaderLevelCount=t}get rowHeaderLevelCount(){return this._rowHeaderLevelCount}set rowHeaderLevelCount(t){this._rowHeaderLevelCount=t}get colCount(){var t,e,i,r;return(this._getColumnHeaderTreeExpandedMaxLevelCount()>0||this._table.isPivotChart()||(null==(t=this.dataset.records)?void 0:t.length)>0||this.dataset.records&&!Array.isArray(this.dataset.records)?(null!=(i=null==(e=this._columnHeaderCellIds[0])?void 0:e.length)?i:this.columnDimensionTree.tree.size)||+((null==(r=this._indicators)?void 0:r.length)>0):0)+this.rowHeaderLevelCount+this.rightHeaderColCount+this.leftRowSeriesNumberColumnCount}get rowCount(){var t,e,i,r;return((this._table.records||this.dataset.records)&&(!Array.isArray(this._table.records)||this._table.records.length>0)&&(null==(t=this._indicators)?void 0:t.length)>0&&!(null==(e=this._rowHeaderCellIds)?void 0:e.length)?1:null!=(r=null==(i=this._rowHeaderCellIds)?void 0:i.length)?r:0)+this.columnHeaderLevelCount+this.bottomHeaderRowCount}get bodyRowSpanCount(){return this.rowDimensionTree.tree.size}get bottomFrozenRowCount(){if(!this._table.isPivotChart())return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0;if(this.indicatorKeys.length>=1&&(0,s.eW)(this.indicatorsDefine)){let t=this._table.pivotChartAxes.find(t=>"bottom"===t.orient);return!1===(null==t?void 0:t.visible)?0:(this.indicatorsAsCol,1)}return 0}get rightFrozenColCount(){if(!this._table.isPivotChart())return this._table.internalProps.rightFrozenColCount?this.colCount-this.rowHeaderLevelCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:this.colCount-this.rowHeaderLevelCount:0;let t=this._table.pivotChartAxes.find(t=>"right"===t.orient);return!1===(null==t?void 0:t.visible)||this.indicatorsAsCol?0:+!!this.hasRightIndicatorAxis}get bodyRowCount(){return this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount}get headerObjects(){return this._headerObjects}get columnObjects(){return this._indicators}getCellId(t,e){var i,r,n,l,s;if(e>=0&&t>=0){if(this.isSeriesNumber(t,e))return"";if(this.isCornerHeader(t,e))return null==(i=this._cornerHeaderCellIds[e])?void 0:i[t-this.leftRowSeriesNumberColumnCount];if(this.isColumnHeader(t,e))return null==(r=this._columnHeaderCellIds[e])?void 0:r[t-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount];if(this.isRowHeader(t,e))return null==(n=this._rowHeaderCellIds[e-this.columnHeaderLevelCount])?void 0:n[t-this.leftRowSeriesNumberColumnCount];if(this.isRightFrozenColumn(t,e))return null==(l=this._rowHeaderCellIds[e-this.columnHeaderLevelCount])?void 0:l[this.rowHeaderLevelCount-1];if(this.isBottomFrozenRow(t,e))return null==(s=this._columnHeaderCellIds[this.columnHeaderLevelCount-1])?void 0:s[t-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount]}}getHeader(t,e){var i;if(this.isSeriesNumberInHeader(t,e))return this.getSeriesNumberHeader(t,e);let r=this.getCellId(t,e);return null!=(i=this._headerObjectMap[r])?i:{id:void 0,field:"",headerType:"text",define:void 0}}getHeaderField(t,e){var i,r;let n=this.getCellId(t,e);return(null==(i=this._headerObjectMap[n])?void 0:i.field)||(null==(r=this.getBody(t,e))?void 0:r.field)}getHeaderCellAdressById(t){for(let e=0;e<this._columnHeaderCellIds.length;e++){let i=this._columnHeaderCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return{col:r+this._table.frozenColCount,row:e}}for(let e=0;e<this._rowHeaderCellIds.length;e++){let i=this._rowHeaderCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return{col:r,row:e+this._table.frozenRowCount}}for(let e=0;e<this._cornerHeaderCellIds.length;e++){let i=this._cornerHeaderCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return{col:r,row:e}}}getHeaderCellAddressByField(t){let e=this.headerObjects.find(e=>e&&e.field===t);return e&&this.getHeaderCellAdressById(e.id)}getBody(t,e){var i,r,n,l,s,a,h,d,u,c;let p=this.getBodyWidthCache(t,e);if(p)return p;if(this.isSeriesNumber(t,e)){let i=this.getSeriesNumberBody(t,e);return this.setBodyWidthCache(t,e,i),i}let g=this.getCellHeaderPaths(t,e);if(this.indicatorsAsCol){let a=null==(r=null==(i=g.colHeaderPaths)?void 0:i.find(t=>t.indicatorKey))?void 0:r.indicatorKey,h=(0,o.Z)(a)&&null!=(s=null!=(l=null==(n=this._indicators)?void 0:n.find(t=>t.indicatorKey===a))?l:this._indicators[0])?s:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(t,e,h),h}let f=null==(h=null==(a=g.rowHeaderPaths)?void 0:a.find(t=>t.indicatorKey))?void 0:h.indicatorKey,m=(0,o.Z)(f)&&null!=(c=null!=(u=null==(d=this._indicators)?void 0:d.find(t=>t.indicatorKey===f))?u:this._indicators[0])?c:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(t,e,m),m}getCellRange(t,e){var i,r;let n={start:{col:t,row:e},end:{col:t,row:e}};if(!this.isHeader(t,e)||-1===t||-1===e||this.isRightFrozenColumn(t,e)||this.isBottomFrozenRow(t,e))return n;if(this._table.isPivotChart()){if(this.isLeftBottomCorner(t,e))return{start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.frozenColCount-1,row:this.rowCount-1}};if(this.isRightTopCorner(t,e))return{start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}};if(this.isRightBottomCorner(t,e))return{start:{col:this.colCount-this.rightFrozenColCount,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}}}for(let i=0;i<this._largeCellRangeCache.length;i++){let r=this._largeCellRangeCache[i];if(t>=r.start.col&&t<=r.end.col&&e>=r.start.row&&e<=r.end.row)return r}if(this.isHeader(t,e)&&-1!==t&&-1!==e){let l=this.getCellId(t,e);for(let i=t-1;i>=0&&l===this.getCellId(i,e);i--)n.start.col=i;for(let r=t+1;r<(null!=(i=this.colCount)?i:0)&&l===this.getCellId(r,e);r++)n.end.col=r;for(let i=e-1;i>=0&&l===this.getCellId(t,i);i--)n.start.row=i;for(let i=e+1;i<(null!=(r=this.rowCount)?r:0)&&!(l!==this.getCellId(t,i)||this.isSeriesNumberInHeader(t,e)&&i>=this.columnHeaderLevelCount);i++)n.end.row=i}return(n.end.col-n.start.col>100||n.end.row-n.start.row>100)&&this._largeCellRangeCache.push(n),n}isCellRangeEqual(t,e,i,r){let n=this.getCellRange(t,e),l=this.getCellRange(i,r);return n.start.col===l.start.col&&n.end.col===l.end.col&&n.start.row===l.start.row&&n.end.row===l.end.row}getBodyIndexByRow(t){return t<this.columnHeaderLevelCount||t>=this.rowCount-this.bottomHeaderRowCount?-1:t-this.columnHeaderLevelCount}get bottomHeaderRowCount(){return this._table.isPivotChart()?this.bottomFrozenRowCount:0}get rightHeaderColCount(){return this._table.isPivotChart()?this.rightFrozenColCount:0}getBodyIndexByCol(t){return t<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||t>=this.colCount-this.rightHeaderColCount?-1:t-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount}getRecordStartRowByRecordIndex(t){return this.columnHeaderLevelCount+t}getRecordShowIndexByCell(t,e){}getCellHeaderPathsWithTreeNode(t,e){for(let i=0;i<this._largeCellRangeCache.length;i++){let r=this._largeCellRangeCache[i];if(t>=r.start.col&&t<=r.end.col&&e>=r.start.row&&e<=r.end.row)break}let i=this.getColHeaderPathCache(t,e),r=this.getRowHeaderPathCache(t,e),n=this.getBodyIndexByCol(t),l=this.getBodyIndexByRow(e)+this.currentPageStartIndex;if(!i&&e>=0&&n>=0){if(i=[],"grid-tree"===this.columnHierarchyType){let t=[];this._columnHeaderCellFullPathIds.map(e=>{t.push(e[n])});let e=this.getTreePathByCellIds(t);i.push(...e)}else i=this.columnDimensionTree.getTreePath(n,this.showHeader&&this.showColumnHeader?e-!!this.columnHeaderTitle:this.columnDimensionTree.totalLevel);this.setColHeaderPathCache(t,e,i)}if(!r&&t>=0&&l>=0){if(r=[],"tree"===this.rowHierarchyType){let t=this._rowHeaderCellFullPathIds[l],e=this.rowDimensionTree,i=0;for(;e&&t;){let n=[],l=t[i];for(n.push(l);;){let t=this._headerObjectMap[l];if(!(null==t?void 0:t.parentCellId))break;n.unshift(t.parentCellId),l=t.parentCellId}let s=this.getTreePathByCellIds(n);r.push(...s),e=this._rowHeaderExtensionTree[t[i]],i++}}else if("grid-tree"===this.rowHierarchyType){let t=this._rowHeaderCellFullPathIds[l],e=this.getTreePathByCellIds(t);r.push(...e)}else r=this.rowDimensionTree.getTreePath(l,this.showHeader&&this.showRowHeader?t-!!this.rowHeaderTitle-this.leftRowSeriesNumberColumnCount:this.rowDimensionTree.totalLevel);this.setRowHeaderPathCache(t,e,r)}return{colHeaderPaths:i,rowHeaderPaths:r,cellLocation:this.getCellLocation(t,e)}}getTreePathByCellIds(t){let e=[];for(let i=0;i<t.length;i++){let r=t[i];if(i>0&&r===t[i-1])continue;let n=this._headerObjects[r];(null==n?void 0:n.define)&&e.push(n.define)}return e}getCellHeaderPaths(t,e){var i,r;let n=this.getCellHeaderPathsWithTreeNode(t,e),l={colHeaderPaths:[],rowHeaderPaths:[],cellLocation:n.cellLocation};return null==(i=n.colHeaderPaths)||i.forEach(t=>{var e,i,r;let n={};n.dimensionKey=t.dimensionKey,n.indicatorKey=t.indicatorKey,n.value=null!=(r=null!=(e=t.value)?e:null==(i=this.getIndicatorInfoByIndicatorKey(t.indicatorKey))?void 0:i.title)?r:"",n.virtual=t.virtual,n.role=t.role,l.colHeaderPaths.push(n)}),null==(r=n.rowHeaderPaths)||r.forEach(t=>{var e,i,r;if("axis"!==t.dimensionKey){let n={};n.dimensionKey=t.dimensionKey,n.indicatorKey=t.indicatorKey,n.value=null!=(e=t.value)?e:t.indicatorKey?null!=(r=null==(i=this.getIndicatorInfoByIndicatorKey(t.indicatorKey))?void 0:i.title)?r:"":t.value,n.virtual=t.virtual,n.role=t.role,l.rowHeaderPaths.push(n)}}),l}getCellRowHeaderFullPaths(t){let e=[];if("grid"===this.rowHierarchyType){for(let i=0;i<=Math.min(this.rowsDefine.length-1,t);i++){let t=this.rowsDefine[i];"string"==typeof t?e.push({dimensionKey:t}):e.push({dimensionKey:t.dimensionKey})}t>=this.rowsDefine.length&&!1===this.indicatorsAsCol&&this.indicatorsDefine.length>0&&("string"==typeof this.indicatorsDefine[0]?e.push({indicatorKey:this.indicatorsDefine[0]}):e.push({indicatorKey:this.indicatorsDefine[0].indicatorKey}))}return e}getIndicatorInfoByIndicatorKey(t){var e;return null==(e=this.indicatorsDefine)?void 0:e.find(e=>"string"!=typeof e&&!!t&&e.indicatorKey===t)}findFullCellIds(t){let e=[];for(let i=0;i<t.length;i++){let r=t[i];for(e.push(r);;){let t=this._headerObjectMap[r];if(!(null==t?void 0:t.parentCellId))break;e.unshift(t.parentCellId),r=t.parentCellId}}return e}getHeaderDimension(t,e){var i,r,n;if(this.isHeader(t,e)){let l=this.getHeader(t,e);return null!=(r=null==(i=this.rowsDefine)?void 0:i.find(t=>"string"!=typeof t&&t.dimensionKey===l.field))?r:null==(n=this.columnsDefine)?void 0:n.find(t=>"string"!=typeof t&&t.dimensionKey===l.field)}}isColumnIndicatorHeader(t,e){return"column"===this._indicatorShowType&&e===this.columnHeaderLevelCount-1&&t>=this.rowHeaderLevelCount}isRowIndicatorHeader(t,e){return"row"===this._indicatorShowType&&t===this.rowHeaderLevelCount-1&&e>=this.columnHeaderLevelCount}isIndicatorHeader(t,e){return this.isColumnIndicatorHeader(t,e)||this.isRowIndicatorHeader(t,e)}_rebuildRowLayout(){var t,e,i,n,l,s;if(this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this.resetRowHeaderLevelCount(),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[...this.rowDimensionKeys],"tree"===this.rowHierarchyType?this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs):"grid-tree"===this.rowHierarchyType&&(this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.rowHeaderTitle){let r=++this.sharedVar.seqId,s=Array(this.rowCount-this.columnHeaderLevelCount).fill(r);this._rowHeaderCellFullPathIds_FULL.unshift(s);let a={id:r,title:"string"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(e=null==(t=this.rowHeaderTitle)?void 0:t.headerType)?e:"text",style:null==(i=this.rowHeaderTitle)?void 0:i.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(null==(n=this.rowHeaderTitle)?void 0:n.disableHeaderHover),disableHeaderSelect:!!(null==(l=this.rowHeaderTitle)?void 0:l.disableHeaderSelect)}};this.rowHeaderObjs.push(a),this._headerObjects[r]=a}this._rowHeaderCellFullPathIds_FULL=(0,r.p4)(this._rowHeaderCellFullPathIds_FULL),"tree"===this.rowHierarchyType&&(null==(s=this.extensionRows)?void 0:s.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),"grid-tree"===this.rowHierarchyType&&this.setColumnWidths()}_rebuildColumnLayout(){var t,e,i,r,n;if(this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this.resetColumnHeaderLevelCount(),this._columnHeaderCellFullPathIds=[],this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),"grid-tree"===this.columnHierarchyType&&(this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.columnHeaderTitle){let l=++this.sharedVar.seqId,s=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(l);this._columnHeaderCellFullPathIds.unshift(s);let a={id:l,title:"string"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(e=null==(t=this.columnHeaderTitle)?void 0:t.headerType)?e:"text",style:null==(i=this.columnHeaderTitle)?void 0:i.headerStyle,define:{id:l,disableHeaderHover:!!(null==(r=this.columnHeaderTitle)?void 0:r.disableHeaderHover),disableHeaderSelect:!!(null==(n=this.columnHeaderTitle)?void 0:n.disableHeaderSelect)}};this.columnHeaderObjs.push(a),this._headerObjects[l]=a}this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),"grid-tree"===this.columnHierarchyType&&this.setColumnWidths()}toggleHierarchyState(t,e){var i,l,s,a,o,h,d;let u;this.colIndex=0;let c=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount,p=this._rowHeaderCellFullPathIds_FULL.slice(0),g=p.map((e,i)=>({col:t,row:i+this.columnHeaderLevelCount})),f=this.getHeader(t,e);if((f.define.hierarchyState=f.define.hierarchyState===n.g.collapse?n.g.expand:n.g.collapse,this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this.resetRowHeaderLevelCount(),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[],this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),"tree"===this.rowHierarchyType)?((null==(i=this.extensionRows)?void 0:i.length)>0&&this.extensionRows.forEach(t=>{var e;let i=(null==(e=t.rows)?void 0:e.map(t=>"string"==typeof t?t:t.dimensionKey))||[];this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(i)}),this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs)):"grid-tree"===this.rowHierarchyType&&(this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.rowHeaderTitle){let t=++this.sharedVar.seqId,e=Array(this.rowCount-this.columnHeaderLevelCount).fill(t);this._rowHeaderCellFullPathIds_FULL.unshift(e);let i={id:t,title:"string"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(s=null==(l=this.rowHeaderTitle)?void 0:l.headerType)?s:"text",style:null==(a=this.rowHeaderTitle)?void 0:a.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(null==(o=this.rowHeaderTitle)?void 0:o.disableHeaderHover),disableHeaderSelect:!!(null==(h=this.rowHeaderTitle)?void 0:h.disableHeaderSelect)}};this.rowHeaderObjs.push(i),this._headerObjects[t]=i}if(this._rowHeaderCellFullPathIds_FULL=(0,r.p4)(this._rowHeaderCellFullPathIds_FULL),"tree"===this.rowHierarchyType&&(null==(d=this.extensionRows)?void 0:d.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,"tree"===this.rowHierarchyType)u=function(t,e,i,r,n,l){let s=l.columnHeaderLevelCount,a=[],o=[];for(let t=0;t<i.length;t++)r.includes(i[t])||o.push(n[t]);for(let e=0;e<r.length;e++)if(!i.includes(r[e])){let i={col:t,row:s+e};a.push(i)}let h=l.getParentCellId(t,e),d=l.getRowHeaderCellAddressByCellId(h),u=[];for(d&&u.push(d);h;)(h=l.getParentCellId(d.col,d.row))&&u.push(d=l.getRowHeaderCellAddressByCellId(h));return u.some(i=>i.col===t&&i.row===e)||u.push({col:t,row:e}),{addCellPositionsRowDirection:a,removeCellPositionsRowDirection:o,updateCellPositionsRowDirection:u}}(t,e,p.map(e=>e[t-this.leftRowSeriesNumberColumnCount]),this._rowHeaderCellFullPathIds_FULL.map(e=>e[t-this.leftRowSeriesNumberColumnCount]),g,this);else{let i=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount;u=function(t,e,i,r,n,l){let s=l.columnHeaderLevelCount,a=[],o=[];for(let t=0;t<i.length;t++)r.includes(i[t])||o.push(n[t]);for(let e=0;e<r.length;e++)if(!i.includes(r[e])){let i={col:t,row:s+e};a.push(i)}let h=l.getParentCellId(t,e),d=l.getRowHeaderCellAddressByCellId(h),u=[];for(d&&u.push(d);h;)(h=l.getParentCellId(d.col,d.row))&&u.push(d=l.getRowHeaderCellAddressByCellId(h));let c=[],p=[];if("grid-tree"===l.rowHierarchyType&&"column"===l.cornerSetting.titleOnDimension&&l.rowHeaderLevelCount!==l._cornerHeaderCellIds[0].length)if(l.rowHeaderLevelCount>l._cornerHeaderCellIds[0].length)for(let t=l._cornerHeaderCellIds[0].length;t<l.rowHeaderLevelCount;t++)c.push({col:t,row:e});else for(let t=l.rowHeaderLevelCount;t<l._cornerHeaderCellIds[0].length;t++)p.push({col:t,row:e});return{addCellPositionsRowDirection:a,removeCellPositionsRowDirection:o,updateCellPositionsRowDirection:u,addCellPositionsColumnDirection:c,removeCellPositionsColumnDirection:p}}(t,e,p.map(t=>t[c]),this._rowHeaderCellFullPathIds_FULL.map(t=>t[i]),g,this)}return this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),"grid-tree"===this.rowHierarchyType&&this.setColumnWidths(),u}toggleHierarchyStateForColumnTree(t,e){var i,r,l,s,a;this.colIndex=0;let o=this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1,h=this._columnHeaderCellFullPathIds.slice(0),d=h[this.columnHeaderLevelCount-1].map((t,i)=>({col:i+this.rowHeaderLevelCount,row:e})),u=this.getHeader(t,e);if(u.define.hierarchyState=u.define.hierarchyState===n.g.collapse?n.g.expand:n.g.collapse,this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this.resetColumnHeaderLevelCount(),this._columnHeaderCellFullPathIds=[],this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),"grid-tree"===this.columnHierarchyType&&(this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.columnHeaderTitle){let t=++this.sharedVar.seqId,e=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(t);this._columnHeaderCellFullPathIds.unshift(e);let n={id:t,title:"string"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((t,e)=>"string"==typeof e?t:t+(t?`/${e.title}`:`${e.title}`),""),field:void 0,headerType:null!=(r=null==(i=this.columnHeaderTitle)?void 0:i.headerType)?r:"text",style:null==(l=this.columnHeaderTitle)?void 0:l.headerStyle,define:{id:t,disableHeaderHover:!!(null==(s=this.columnHeaderTitle)?void 0:s.disableHeaderHover),disableHeaderSelect:!!(null==(a=this.columnHeaderTitle)?void 0:a.disableHeaderSelect)}};this.columnHeaderObjs.push(n),this._headerObjects[t]=n}this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0;let c=this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1,p=function(t,e,i,r,n,l){let s=l.rowHeaderLevelCount,a=[],o=[];for(let t=0;t<i.length;t++)r.includes(i[t])||o.push(n[t]);for(let t=0;t<r.length;t++)if(!i.includes(r[t])){let i={col:s+t,row:e};a.push(i)}let h=l.getParentCellId(t,e),d=l.getRowHeaderCellAddressByCellId(h),u=[];for(d&&u.push(d);d&&h;)(h=l.getParentCellId(d.col,d.row))&&u.push(d=l.getRowHeaderCellAddressByCellId(h));let c=[],p=[];if("grid-tree"===l.columnHierarchyType&&"row"===l.cornerSetting.titleOnDimension&&l.columnHeaderLevelCount!==l._cornerHeaderCellIds.length)if(l.columnHeaderLevelCount>l._cornerHeaderCellIds.length)for(let e=l._cornerHeaderCellIds.length;e<l.columnHeaderLevelCount;e++)c.push({col:t,row:e});else for(let e=l.columnHeaderLevelCount;e<l._cornerHeaderCellIds.length;e++)p.push({col:t,row:e});return{addCellPositionsColumnDirection:a,removeCellPositionsColumnDirection:o,updateCellPositionsColumnDirection:u,addCellPositionsRowDirection:c,removeCellPositionsRowDirection:p}}(t,e,h[o],this._columnHeaderCellFullPathIds[c],d,this);return this.generateCellIdsConsiderHideHeader(),"grid-tree"===this.columnHierarchyType&&this.setColumnWidths(),p}isHeaderForColWidth(t,e){return this.isHeader(t,e)}getHeaderForColWidth(t,e){return this.getHeader(t,e)}getPivotCellAdress(t){var e;if(!Array.isArray(t))return;let i,r,n=this.rowTree,l=this.columnTree;for(let s=0;s<t.length;s++){let a=t[s];if((a.isPivotCorner||!(0,o.Z)(a.value))&&s===t.length-1){if("row"===(null==(e=null==this?void 0:this.cornerSetting)?void 0:e.titleOnDimension)){let t=0;return"grid"===this.rowHierarchyType&&(t=this.rowDimensionKeys.indexOf(a.dimensionKey)),-1===t?void 0:{col:(this.rowHeaderTitle?t+1:t)+this.leftRowSeriesNumberColumnCount,row:0}}let t=this.colDimensionKeys.indexOf(a.dimensionKey);return -1===t?void 0:{col:0+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderTitle?t+1:t}}let h=!1;for(let t=0;t<l.length;t++){let e=l[t];if(((0,o.Z)(a.dimensionKey)&&e.dimensionKey===a.dimensionKey||(0,o.Z)(a.indicatorKey)&&e.indicatorKey===a.indicatorKey)&&e.value===a.value){l=e.children,r=e,h=!0;break}}if(!h)for(let t=0;t<n.length;t++){let e=n[t];if(((0,o.Z)(a.dimensionKey)&&e.dimensionKey===a.dimensionKey||(0,o.Z)(a.indicatorKey)&&e.indicatorKey===a.indicatorKey)&&e.value===a.value){n=e.children,i=e;break}}}let s=0,a=0;if(i){a=this.columnHeaderLevelCount;let{startInTotal:t,afterSpanLevel:e}=i;return a+=t,{col:s="grid"===this.rowHierarchyType?(this.rowHeaderTitle?e+1:e)+this.leftRowSeriesNumberColumnCount:0+this.leftRowSeriesNumberColumnCount,row:a}}if(r){s=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;let{startInTotal:t,afterSpanLevel:e}=r;return{col:s+=t,row:a=this.columnHeaderTitle?e+1:e}}}getPivotDimensionInfo(t,e){var i;let{colHeaderPaths:r,rowHeaderPaths:n}=this.getCellHeaderPaths(t,e),l=[];return r.length?r.forEach((t,e)=>{l.push({dimensionKey:t.dimensionKey,value:t.value,isPivotCorner:!1,indicatorKey:t.indicatorKey})}):n.length?n.forEach((t,e)=>{l.push({dimensionKey:t.dimensionKey,value:t.value,isPivotCorner:!1,indicatorKey:t.indicatorKey})}):this.isCornerHeader(t,e)&&("row"===(null==(i=null==this?void 0:this.cornerSetting)?void 0:i.titleOnDimension)?l.push({dimensionKey:this.rowDimensionKeys[(this.rowHeaderTitle?t-1:t)-this.leftRowSeriesNumberColumnCount],isPivotCorner:!0}):l.push({dimensionKey:this.colDimensionKeys[this.columnHeaderTitle?e-1:e],isPivotCorner:!0})),l}getIndicatorKey(t,e){var i;return null==(i=this.getBody(t,e))?void 0:i.indicatorKey}getParentCellId(t,e){if(0!==e)return this.isColumnHeader(t,e)?this.getCellId(t,e-1):this.isRowHeader(t,e)?this.getCellId(t-1,e):void 0}getRowHeaderCellAddressByCellId(t){let e,i;if(this._rowHeaderCellIds.find((r,n)=>!!r.find((i,r)=>i===t&&(e=r,!0))&&(i=n,!0)),(0,o.Z)(e)&&(0,o.Z)(i))return{col:e,row:i+this.columnHeaderLevelCount}}canMoveHeaderPosition(t,e){if(this.isSeriesNumberInHeader(e.col,e.row)||this.isSeriesNumberInHeader(t.col,t.row)||this.isCornerHeader(e.col,e.row)||t.col<0||t.row<0||e.col<0||e.row<0)return!1;this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)&&(t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1);let i=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row))return this.getParentCellId(t.col,i.start.row)===this.getParentCellId(e.col,i.start.row);if(this.isRowHeader(t.col,t.row)){if("tree"!==this.rowHierarchyType)return this.getParentCellId(i.start.col,t.row)===this.getParentCellId(i.start.col,e.row);{let i=(0,d.Z)(this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths),r=(0,d.Z)(this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths);if(i.pop(),r.pop(),i.length<=r.length){if(i.length===r.length)return!i.find((t,e)=>t.dimensionKey!==r[e].dimensionKey||t.value!==r[e].value);if(i.length>0){for(let t=0;t<i.length;t++)if(i[t].startInTotal!==r[t].startInTotal)return!1}return!0}}}return!1}moveHeaderPosition(t,e){var i,r;if((!(null==(i=this._table.options.dragOrder)?void 0:i.validateDragOrderOnEnd)||(null==(r=this._table.options.dragOrder)?void 0:r.validateDragOrderOnEnd(t,e)))&&this.canMoveHeaderPosition(t,e)&&!this.isCellRangeEqual(t.col,t.row,e.col,e.row)){let i=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row)){let r,n=i.end.col-i.start.col+1,l=this.getCellRange(e.col,i.start.row);if((r=e.col>=t.col?l.end.col-n+1:l.start.col)===i.start.col)return null;for(let t=0;t<this._columnHeaderCellFullPathIds.length;t++){let e=this._columnHeaderCellFullPathIds[t].splice(i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,n);e.unshift(r-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnHeaderCellFullPathIds[t],e)}let s=this._columnWidths.splice(i.start.col-this.leftRowSeriesNumberColumnCount,n);return s.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnWidths,s),this.columnDimensionTree.movePosition(this.getCellHeaderPathsWithTreeNode(t.col,t.row).colHeaderPaths.length-1,i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,l.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount),this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.col,targetIndex:r,sourceSize:n,targetSize:l.end.col-l.start.col+1,moveType:"column"}}if(this.isRowHeader(t.col,t.row)){let r,n=this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,l=this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,s=n[n.length-1],a=l[n.length-1],o=s.size;if((r=e.row>=t.row?a.startInTotal+a.size-o:a.startInTotal)===i.start.row-this.columnHeaderLevelCount)return null;let h=this._rowHeaderCellIds.splice(i.start.row-this.columnHeaderLevelCount,o);h.unshift(r-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellIds,h);let d=this._rowHeaderCellFullPathIds.splice(i.start.row-this.columnHeaderLevelCount,o);d.unshift(r-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds,d);let u=this._rowHeaderCellIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,o);u.unshift(r,0),Array.prototype.splice.apply(this._rowHeaderCellIds_FULL,u);let c=this._rowHeaderCellFullPathIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,o);return c.unshift(r,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds_FULL,c),this.rowDimensionTree.movePosition(n.length-1,i.start.row-this.columnHeaderLevelCount,r+(e.row>t.row?s.size-1:0)),this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.row,targetIndex:r+this.columnHeaderLevelCount,sourceSize:o,targetSize:a.size,moveType:"row"}}}return null}getCellAdressByHeaderPath(t){var e,i,r,n,l,s,a,h;let d,u,c=!1,g=!1;if(Array.isArray(t)){if(t.length>this.rowDimensionKeys.length+this.colDimensionKeys.length)return;d=t.filter(t=>this.colDimensionKeys.indexOf(t.dimensionKey)>=0||this.colDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&t.indicatorKey),u=t.filter(t=>this.rowDimensionKeys.indexOf(t.dimensionKey)>=0||this.rowDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&t.indicatorKey)}else d=t.colHeaderPaths,u=t.rowHeaderPaths,"body"===(null==t?void 0:t.cellLocation)&&this._table.isPivotTable()&&(g=!0);if(!Array.isArray(d)&&!Array.isArray(u))return;if(null==d||d.sort((t,e)=>{var i,r;return this.colDimensionKeys.indexOf(null!=(i=t.dimensionKey)?i:this.indicatorDimensionKey)-this.colDimensionKeys.indexOf(null!=(r=e.dimensionKey)?r:this.indicatorDimensionKey)}),null==u||u.sort((t,e)=>{var i,r;return this.fullRowDimensionKeys.indexOf(null!=(i=t.dimensionKey)?i:this.indicatorDimensionKey)-this.fullRowDimensionKeys.indexOf(null!=(r=e.dimensionKey)?r:this.indicatorDimensionKey)}),null==d||d.forEach(t=>{t.isPivotCorner&&(c=!0)}),null==u||u.forEach(t=>{t.isPivotCorner&&(c=!0)}),c){if("all"===this.cornerSetting.titleOnDimension&&this.indicatorsAsCol&&0===d.length){for(let t=0;t<this.rowDimensionKeys.length;t++)if((null==(e=u[0])?void 0:e.dimensionKey)===this.rowDimensionKeys[t])return{col:t+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderLevelCount-1}}else if("all"!==this.cornerSetting.titleOnDimension||this.indicatorsAsCol||0!==u.length){if("row"!==this.cornerSetting.titleOnDimension&&("all"!==this.cornerSetting.titleOnDimension||this.indicatorsAsCol)){for(let t=0;t<this.colDimensionKeys.length;t++)if((null==(n=d[0])?void 0:n.dimensionKey)===this.colDimensionKeys[t])return{col:0,row:t}}else for(let t=0;t<this.rowDimensionKeys.length;t++)if((null==(r=u[0])?void 0:r.dimensionKey)===this.rowDimensionKeys[t])return{col:t+this.leftRowSeriesNumberColumnCount,row:0}}else for(let t=0;t<this.colDimensionKeys.length;t++)if((null==(i=d[0])?void 0:i.dimensionKey)===this.colDimensionKeys[t])return{col:this.rowHeaderLevelCount-1,row:t}}let f,m,y,v,b,_,C=!1,x=!1;if((null==d?void 0:d.length)>=1&&(null==u?void 0:u.length)>=1&&(C=!0,x=!0),null!=(l=null==d?void 0:d.length)&&l&&d.length>=this._getColumnHeaderTreeExpandedMaxLevelCount()&&(C=!0),null!=(s=null==u?void 0:u.length)&&s&&u.length>=this._getRowHeaderTreeExpandedMaxLevelCount()&&(x=!0),d&&(_=this.matchDimensionPath(d,this.columnTree,C)),(null==u?void 0:u.length)>=1)if("tree"===this.rowHierarchyType){let t=u[u.length-1],e=this.headerObjects.filter(e=>((null==e?void 0:e.field)===t.dimensionKey||(null==e?void 0:e.field)===t.indicatorKey)&&(null==e?void 0:e.title)===t.value).map(t=>t.id),i=this._rowHeaderCellIds.filter(t=>e.indexOf(t[t.length-1])>=0).find(t=>{let e=this.findFullCellIds(t);return e.length===u.length&&e.every(t=>{let e=this._headerObjectMap[t];return u.find(t=>t.dimensionKey===e.field&&t.value===e.title)})});m=this._rowHeaderCellIds.indexOf(i)+this.columnHeaderLevelCount}else b=this.matchDimensionPath(u,this.rowTree,x,!0);if(g||!C||!x||(b||(0,o.Z)(m))&&_){if(b||g){m=this.columnHeaderLevelCount;let{startInTotal:t,afterSpanLevel:e}=null!=(a=b)?a:p;if(m+=null!=t?t:0,"grid"===this.rowHierarchyType)if(u.every((t,e)=>this.rowDimensionKeys[e]===t.dimensionKey)){let t=u.length-1;y=(this.rowHeaderTitle?t+1:t)+this.leftRowSeriesNumberColumnCount}else y=(this.rowHeaderTitle?e+1:e)+this.leftRowSeriesNumberColumnCount;else y=0}if(_||g){f=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;let{startInTotal:t,afterSpanLevel:e}=null!=(h=_)?h:p;f+=null!=t?t:0,v=this.columnHeaderTitle?e+1:e}if((0,o.Z)(f)||(0,o.Z)(m))return{col:null!=f?f:y,row:null!=m?m:v};if(u.length>0&&u.every((t,e)=>this.rowDimensionKeys[e]===t.dimensionKey)){let t=u.length-1;return{col:(this.rowHeaderTitle?t+1:t)+this.leftRowSeriesNumberColumnCount,row:void 0}}}}setChartInstance(t,e,i){var r,n,l,s;let a,o=this.getCellHeaderPaths(t,e);if(this.indicatorsAsCol){let t=null==(r=o.colHeaderPaths.find(t=>t.indicatorKey))?void 0:r.indicatorKey;a=null==(n=this._indicators)?void 0:n.find(e=>e.indicatorKey===t)}else{let t=null==(l=o.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:l.indicatorKey;a=null==(s=this._indicators)?void 0:s.find(e=>e.indicatorKey===t)}"function"!=typeof(null==a?void 0:a.chartSpec)&&a&&(a.chartInstance=i)}getChartInstance(t,e){var i,r,n,l;let s,a=this.getCellHeaderPaths(t,e);if(this.indicatorsAsCol){let t=null==(i=a.colHeaderPaths.find(t=>t.indicatorKey))?void 0:i.indicatorKey;s=null==(r=this._indicators)?void 0:r.find(e=>e.indicatorKey===t)}else{let t=null==(n=a.rowHeaderPaths.find(t=>t.indicatorKey))?void 0:n.indicatorKey;s=null==(l=this._indicators)?void 0:l.find(e=>e.indicatorKey===t)}return null==s?void 0:s.chartInstance}checkHasChart(){return(0,s.YL)(this)}getDimension(t,e){var i,r;return"column"===e?null==(i=this.columnsDefine)?void 0:i.find(e=>"string"!=typeof e&&e.dimensionKey===t):"row"===e?null==(r=this.rowsDefine)?void 0:r.find(e=>"string"!=typeof e&&e.dimensionKey===t):void 0}getAxisConfigInPivotChart(t,e){if((this.isFrozenColumn(t,e)||this.isRightFrozenColumn(t,e))&&(0,s.aw)(t,e,"row",this)||(this.isFrozenRow(t,e)||this.isBottomFrozenRow(t,e))&&(0,s.aw)(t,e,"col",this)){let i=c.F.getFunction("getAxisConfigInPivotChart")(t,e,this);if(!1!==(null==i?void 0:i.visible))return i}}isEmpty(t,e){return!!this._table.isPivotChart()&&(!!this.isLeftBottomCorner(t,e)||!!this.isRightBottomCorner(t,e)||!!this.isRightTopCorner(t,e))}isAxisCell(t,e){return!!this._table.isPivotChart()&&(!!(this.indicatorKeys.length>=1&&(0,s.eW)(this.indicatorsDefine)&&(this.isBottomFrozenRow(t,e)&&(0,s.aw)(t,e,"col",this)||this.isRightFrozenColumn(t,e)&&(0,s.aw)(t,e,"row",this)||this.isRowHeader(t,e)&&t===this.rowHeaderLevelCount-1&&(0,s.aw)(t,e,"row",this)||this.hasTopIndicatorAxis&&this.indicatorsAsCol&&e===this.columnHeaderLevelCount-1&&(0,s.aw)(t,e,"col",this)))||!1)}getChartAxes(t,e){if((0,s.VR)(t,e,this)||this.isAxisCell(t,e))return(0,s.TQ)(t,e,this)}getRawChartSpec(t,e){return(0,s.ed)(t,e,this)}getChartSpec(t,e){return(0,s.K0)(t,e,this)}isShareChartSpec(t,e){return(0,s.TF)(t,e,this)}getChartDataId(t,e){return(0,s.py)(t,e,this)}isNoChartDataRenderNothing(t,e){return(0,s.f_)(t,e,this)}setPagination(t){var e,i,r,n,l,s,a;if(this.clearCellRangeMap(),this._table.internalProps.useOneRowHeightFillAll=!1,this.pagination=t,"grid"===this.rowHierarchyType&&(0,o.Z)(null==(e=this.pagination)?void 0:e.perPageCount)&&(0,o.Z)(null==(i=this.pagination)?void 0:i.currentPage)){!1===this.indicatorsAsCol&&(this.pagination.perPageCount=Math.ceil(this.pagination.perPageCount/this.indicatorKeys.length)*this.indicatorKeys.length);let{perPageCount:t,currentPage:e}=this.pagination;this.currentPageStartIndex=t*(e||0),this.currentPageEndIndex=this.currentPageStartIndex+t,this._rowHeaderCellIds=null==(r=this._rowHeaderCellIds_FULL)?void 0:r.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=null==(n=this._rowHeaderCellFullPathIds_FULL)?void 0:n.slice(this.currentPageStartIndex,this.currentPageEndIndex)}else this.currentPageStartIndex=0,this.currentPageEndIndex=this._rowHeaderCellIds_FULL.length,this._rowHeaderCellIds=null==(l=this._rowHeaderCellIds_FULL)?void 0:l.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=null==(s=this._rowHeaderCellFullPathIds_FULL)?void 0:s.slice(this.currentPageStartIndex,this.currentPageEndIndex);this.pagination&&(this.pagination.totalCount=null==(a=this._rowHeaderCellIds_FULL)?void 0:a.length)}release(){var t;let e=this._table._getActiveChartInstance();null==e||e.release(),null==(t=this._indicators)||t.forEach(t=>{var e;null==(e=t.chartInstance)||e.release()})}getHeadNode(t,e){var i,r,n;let l,s=this.getCellHeaderPaths(t,e);return s.rowHeaderPaths&&(null!=(r=null==(i=s.rowHeaderPaths)?void 0:i.length)?r:0)>0?l=null==(n=s.rowHeaderPaths)?void 0:n.slice(0,s.rowHeaderPaths.length):s.colHeaderPaths&&s.colHeaderPaths.length>0&&(l=s.colHeaderPaths.slice(0,s.colHeaderPaths.length)),this.getHeadNodeByRowOrColDimensions(l,t,e)}getHeadNodeByRowOrColDimensions(t,e,i){var r;if(!Array.isArray(t))return;let n,l,s=this.rowTree,a=this.columnTree;if((0,o.Z)(i)&&(0,o.Z)(e)&&"tree"===this.rowHierarchyType&&this.extensionRows&&e>=1+this.leftRowSeriesNumberColumnCount){let t=this.getCellId(e-1,i);s=this._rowHeaderExtensionTree[t].tree.children}for(let e=0;e<t.length;e++){let i=t[e];if((i.isPivotCorner||!(0,o.Z)(i.value))&&e===t.length-1)return;let h=!1;for(let t=0;t<a.length;t++){let e=a[t];if((0,o.Z)(i.dimensionKey)&&e.dimensionKey===i.dimensionKey&&e.value===i.value||(0,o.Z)(i.indicatorKey)&&e.indicatorKey===i.indicatorKey&&(e.value===i.value||!(0,o.Z)(i.value)||!(0,o.Z)(e.value))){a=e.children,l=e,h=!0;break}}if(!h)for(let t=0;t<(null!=(r=null==s?void 0:s.length)?r:0);t++){let e=s[t];if((0,o.Z)(i.dimensionKey)&&e.dimensionKey===i.dimensionKey&&e.value===i.value||(0,o.Z)(i.indicatorKey)&&e.indicatorKey===i.indicatorKey&&(e.value===i.value||!(0,o.Z)(i.value)||!(0,o.Z)(e.value))){s=e.children,n=e;break}}}return n||l||void 0}clearCellRangeMap(){this._largeCellRangeCache.length=0,this._CellHeaderPathMap=new Map}getDimensionKeyInChartSpec(t,e,i){var r,n,l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M;let T;if(!1===this.indicatorsAsCol){let f=this.getRawChartSpec(t,e);if(f&&(T="yField"===i?null!=(r=f.yField)?r:null==(l=null==(n=null==f?void 0:f.series)?void 0:n[0])?void 0:l.yField:"histogram"===f.type?f.x2Field:null!=(s=f.xField)?s:null==(o=null==(a=null==f?void 0:f.series)?void 0:a[0])?void 0:o.xField))return T;for(let t=0;t<this.indicatorsDefine.length;t++){let e=this.indicatorsDefine[t].chartSpec;if(e&&(T="yField"===i?null!=(h=e.yField)?h:null==(u=null==(d=null==e?void 0:e.series)?void 0:d[0])?void 0:u.yField:"histogram"===e.type?e.x2Field:null!=(c=e.xField)?c:null==(g=null==(p=null==e?void 0:e.series)?void 0:p[0])?void 0:g.xField))return T}}else{let r=this.getRawChartSpec(t,e);if(r&&(T="xField"===i?"histogram"===r.type?r.x2Field:null!=(f=r.xField)?f:null==(y=null==(m=null==r?void 0:r.series)?void 0:m[0])?void 0:y.xField:"histogram"===r.type?r.y2Field:null!=(v=r.yField)?v:null==(_=null==(b=null==r?void 0:r.series)?void 0:b[0])?void 0:_.yField))return T;for(let t=0;t<this.indicatorsDefine.length;t++){let e=this.indicatorsDefine[t].chartSpec;if(e&&(T="xField"===i?"histogram"===e.type?e.x2Field:null!=(C=e.xField)?C:null==(w=null==(x=null==e?void 0:e.series)?void 0:x[0])?void 0:w.xField:null!=(S=e.yField)?S:null==(M=null==(A=null==e?void 0:e.series)?void 0:A[0])?void 0:M.yField))return T}}return null}_generateChartState(){let t=t=>{var e;return this._table._selectedDataItemsInChart.length>=1?!!this._table._selectedDataItemsInChart.find(e=>{for(let i in e)if("object"!=typeof e[i]&&e[i]!==t[i])return!1;return!0}):null!=(e=this._table._selectedDimensionInChart)&&!!e.length&&!!this._table._selectedDimensionInChart.every(e=>"object"==typeof e.value||t[e.key]===e.value)},e=t=>{var e;return this._table._selectedDataItemsInChart.length>=1?!this._table._selectedDataItemsInChart.find(e=>{for(let i in e)if("object"!=typeof e[i]&&e[i]!==t[i])return!1;return!0}):null!=(e=this._table._selectedDimensionInChart)&&!!e.length&&!this._table._selectedDimensionInChart.every(e=>"object"==typeof e.value||t[e.key]===e.value)};return{vtable_selected:{filter:e=>{var i;return(null==(i=this._table.options.chartDimensionLinkage)?void 0:i.selectedStateFilter)?this._table.options.chartDimensionLinkage.selectedStateFilter(e):"click"===this._table._selectedDataMode&&t(e)}},vtable_selected_reverse:{filter:t=>{var i;return(null==(i=this._table.options.chartDimensionLinkage)?void 0:i.selectedReverseStateFilter)?this._table.options.chartDimensionLinkage.selectedReverseStateFilter(t):"click"===this._table._selectedDataMode&&e(t)}},inBrush:{filter:e=>{var i;return(null==(i=this._table.options.chartDimensionLinkage)?void 0:i.inBrushStateFilter)?this._table.options.chartDimensionLinkage.inBrushStateFilter(e):"brush"===this._table._selectedDataMode&&t(e)}},outOfBrush:{filter:t=>{var i;return(null==(i=this._table.options.chartDimensionLinkage)?void 0:i.outOfBrushStateFilter)?this._table.options.chartDimensionLinkage.outOfBrushStateFilter(t):"brush"===this._table._selectedDataMode&&e(t)}}}}updateDataStateToChartInstance(t){var e;if(!1!==(null==(e=null==t?void 0:t.getSpec().select)?void 0:e.enable)){t||(t=this._table._getActiveChartInstance());let e=this._generateChartState();this._indicators.forEach(t=>{var i;let r=t.chartInstance;!1!==(null==(i=t.chartSpec.select)?void 0:i.enable)&&r.updateState(e)}),null==t||t.updateState(e)}}updateDataStateToActiveChartInstance(t){var e;if(!1!==(null==(e=null==t?void 0:t.getSpec().select)?void 0:e.enable)){t||(t=this._table._getActiveChartInstance());let e=this._generateChartState();null==t||t.updateState(e)}}getIndicatorKeyInChartSpec(t,e){let i=this.getRawChartSpec(t,e),r=[];if(i){if("boxPlot"===i.type)return[i.maxField];if(i.series||i.xField||i.yField)return!1===this.indicatorsAsCol?i.series?i.series.forEach(t=>{let e=t.yField;r.push(e)}):r.push(i.yField):i.series?i.series.forEach(t=>{let e=t.xField;r.push(e)}):r.push(i.xField),r;if(i.valueField&&r.push(i.valueField),r.length>=1)return r}return null}getOptimunHeightForChart(t,e){var i,r,n,l,s;let a,o,h=this.getCellHeaderPaths(this.rowHeaderLevelCount,t).rowHeaderPaths;for(let t in e&&h[h.length-1].indicatorKey&&h.pop(),this.dataset.collectValuesBy)if("yField"===this.dataset.collectValuesBy[t].type&&!this.dataset.collectValuesBy[t].range){a=null==(i=this.dataset.collectedValues[t])?void 0:i[h.map(t=>t.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)o=f(null!=(r=null==a?void 0:a.length)?r:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{let t=this._chartItemSpanSize||25;o=(null!=(n=null==a?void 0:a.length)?n:0)*(t+(e?0:t/3))}let d=(0,u.u)(null!=(s=null!=(l=this._chartPadding)?l:this._table.theme.bodyStyle.padding)?s:0);return o+d[0]+d[2]}getOptimunWidthForChart(t,e){var i,r,n,l,s;let a,o,h=this.getCellHeaderPaths(t,this.columnHeaderLevelCount).colHeaderPaths;for(let t in this.dataset.collectValuesBy)if("xField"===this.dataset.collectValuesBy[t].type&&!this.dataset.collectValuesBy[t].range){a=null==(i=this.dataset.collectedValues[t])?void 0:i[h.map(t=>t.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)o=f(null!=(r=null==a?void 0:a.length)?r:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{let t=this._chartItemSpanSize||25;o=(null!=(n=null==a?void 0:a.length)?n:0)*(t+(e?0:t/3))}let d=(0,u.u)(null!=(s=null!=(l=this._chartPadding)?l:this._table.theme.bodyStyle.padding)?s:0);return o+d[1]+d[3]}get leftAxesCount(){if(!this._table.isPivotChart())return 0;let t=this._table.pivotChartAxes.find(t=>"left"===t.orient);return!1===(null==t?void 0:t.visible)?0:(this.indicatorsAsCol,1)}get topAxesCount(){if(!this._table.isPivotChart())return 0;let t=this._table.pivotChartAxes.find(t=>"top"===t.orient);return!1===(null==t?void 0:t.visible)?0:this.indicatorsAsCol&&this.hasTopIndicatorAxis?1:0}get rightAxesCount(){return this.rightFrozenColCount}get bottomAxesCount(){return this.bottomFrozenRowCount}getColKeysPath(t,e){let i=this.getCellHeaderPaths(t,e),r=[];return i.colHeaderPaths.length&&i.colHeaderPaths.forEach(t=>{t.dimensionKey&&r.push(t.value)}),null==r?void 0:r.join(this.dataset.stringJoinChar)}getRowKeysPath(t,e){let i=this.getCellHeaderPaths(t,e),r=[];return i.rowHeaderPaths.length&&i.rowHeaderPaths.forEach(t=>{t.dimensionKey&&r.push(t.value)}),null==r?void 0:r.join(this.dataset.stringJoinChar)}getIndicatorInfo(t,e=""){var i;return null==(i=this.indicatorsDefine)?void 0:i.find(i=>"string"!=typeof i&&(t?i.indicatorKey===t:!!e&&i.title===e))}getLayoutColumnTree(){let t=[],e=this.columnDimensionTree.tree.children;return(0,a.LC)(t,e),t}getLayoutRowTree(){let t=[],e=this.rowDimensionTree.tree.children;return(0,a.LC)(t,e),t}getLayoutColumnTreeCount(){let t=this.columnDimensionTree.tree.children;return(0,a.p$)(t,"tree"===this.rowHierarchyType)}getLayoutRowTreeCount(){var t;let e=this.rowDimensionTree.tree.children,i=(0,a.p$)(e,"tree"===this.rowHierarchyType);return null==(t=this.extensionRows)||t.forEach(t=>{if("function"!=typeof t.rowTree){let e=(0,a.p$)(t.rowTree,!0);i*=e}}),i}resetHeaderTree(){var t,e,i;this.colIndex=0,this._rowHeaderCellFullPathIds_FULL=[],this._columnHeaderCellFullPathIds=[],this._columnHeaderCellIds=[];let n=this.dataset;this.rowTree=n.rowHeaderTree,this.columnTree=n.colHeaderTree;let l=this.rowDimensionTree.tree.children;null==(t=this.rowTree)||t.forEach((t,e)=>{let i=l.find(e=>e.dimensionKey===t.dimensionKey&&e.value===t.value);i&&this._table._syncHierarchyState(i,t)}),this.columnDimensionTree=new a.KO(null!=(e=this.columnTree)?e:[],this.sharedVar,this.columnHierarchyType,"grid"!==this.columnHierarchyType?this.columnExpandLevel:void 0),this.rowDimensionTree=new a.KO(null!=(i=this.rowTree)?i:[],this.sharedVar,this.rowHierarchyType,"grid"!==this.rowHierarchyType?this.rowExpandLevel:void 0),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=(0,r.p4)(this._rowHeaderCellFullPathIds_FULL),this._headerObjectMap=this._headerObjects.reduce((t,e)=>(t[e.id]=e,t),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination)}isSeriesNumberInHeader(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount&&e<this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e<this.headerLevelCount}isSeriesNumberInBody(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&e>=this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e>=this.headerLevelCount}isSeriesNumber(t,e){return!!((0,o.Z)(t)&&(0,o.Z)(e))&&(!!(this.leftRowSeriesNumberColumnCount>0)&&!!(t>=0)&&!!(e>=0)&&!!(t<this.leftRowSeriesNumberColumnCount)||!!(this.rightRowSeriesNumberColumnCount>0)&&!!(e>=0)&&!!(t>=this.colCount-this.rightRowSeriesNumberColumnCount))||!1}getSeriesNumberHeader(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&e<this.headerLevelCount?Object.assign({},this.leftRowSeriesNumberColumn[t],{style:Object.assign({},this._table.internalProps.theme.cornerHeaderStyle,this._table.internalProps.rowSeriesNumber.headerStyle)}):this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e<this.headerLevelCount&&e<this.headerLevelCount?this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}getSeriesNumberBody(t,e){return this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&e>=this.headerLevelCount?this.leftRowSeriesNumberColumn[t]:this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e>=this.headerLevelCount?this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}changeTreeNodeTitle(t,e,i){this.getHeadNode(t,e).value=i;let r=this.getCellId(t,e);this._headerObjectMap[r].title=i}changeCornerTitle(t,e,i){if(this.isCornerHeader(t,e)){let r=this.getCellId(t,e);this._headerObjectMap[r].title=i}}generateCellIdsConsiderHideHeader(){var t,e,i,r;if(this._columnHeaderCellIds=this._columnHeaderCellFullPathIds.slice(),!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){let t=this.colDimensionKeys.indexOf(l.ek),e=this._columnHeaderCellIds.splice(t,1);this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length),this._columnHeaderCellIds.push(e[0])}else this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length);if(this._rowHeaderCellIds_FULL=this._rowHeaderCellFullPathIds_FULL.slice(),!this.showRowHeader)if(this.indicatorsAsCol||this.hideIndicatorName)this._rowHeaderCellIds_FULL.forEach((t,e)=>{let i=t.slice();i.splice(0,i.length),this._rowHeaderCellIds_FULL[e]=i});else{let t=this.rowDimensionKeys.indexOf(l.ek);this._rowHeaderCellIds_FULL.forEach((e,i)=>{let r=e.slice(),n=r.splice(t,1);r.splice(0,r.length),r.push(n[0]),this._rowHeaderCellIds_FULL[i]=r})}if(this._rowHeaderCellIds=this._rowHeaderCellIds_FULL.slice(),this._cornerHeaderCellIds=this._cornerHeaderCellFullPathIds.slice(),0===this.rowHeaderLevelCount||0===this.columnHeaderLevelCount)this._cornerHeaderCellIds=[];else if("row"!==this.cornerSetting.titleOnDimension||this.showRowHeader){if("column"===this.cornerSetting.titleOnDimension&&!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){let t=this.colDimensionKeys.indexOf(l.ek),e=this._cornerHeaderCellIds.splice(t,1);this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length),this._cornerHeaderCellIds.push(e[0])}else this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length)}else if(this.indicatorsAsCol||this.hideIndicatorName)this._cornerHeaderCellIds.forEach((t,e)=>{let i=t.slice();i.splice(0,i.length),this._cornerHeaderCellIds[e]=i});else{let t=this.rowDimensionKeys.indexOf(l.ek);this._cornerHeaderCellIds.forEach((e,i)=>{let r=e.slice(),n=r.splice(t,1);r.splice(0,r.length),r.push(n[0]),this._cornerHeaderCellIds[i]=r})}if("grid-tree"===this.rowHierarchyType&&"column"===this.cornerSetting.titleOnDimension)this._cornerHeaderCellIds[0].length<this._rowHeaderCellIds[0].length?this._cornerHeaderCellIds.forEach((t,e)=>{let i=t.length;t.length=this._rowHeaderCellIds[0].length,t.fill(t[0],i)}):this._cornerHeaderCellIds[0].length>this._rowHeaderCellIds[0].length&&this._cornerHeaderCellIds.forEach((t,e)=>{t.length=this._rowHeaderCellIds[0].length});else if("grid-tree"===this.columnHierarchyType&&"row"===this.cornerSetting.titleOnDimension)if((null==(t=this._cornerHeaderCellIds)?void 0:t.length)<(null==(e=this._columnHeaderCellIds)?void 0:e.length)){let t=this._cornerHeaderCellIds.length;this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length,this._cornerHeaderCellIds.fill(this._cornerHeaderCellIds[0],t)}else(null==(i=this._cornerHeaderCellIds)?void 0:i.length)>(null==(r=this._columnHeaderCellIds)?void 0:r.length)&&(this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length)}enableUseGetBodyCache(){this._useGetBodyCache=!0,this._getBodyCache.clear()}disableUseGetBodyCache(){this._useGetBodyCache=!1,this._getBodyCache.clear()}enableUseHeaderPathCache(){var t,e;(null==(e=null==(t=this._table.options)?void 0:t.customConfig)?void 0:e.enablePivotPathCache)?this._useHeaderPathCache=!0:(this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear())}disableUseHeaderPathCache(){var t,e;(null==(e=null==(t=this._table.options)?void 0:t.customConfig)?void 0:e.enablePivotPathCache)?this._useHeaderPathCache=!0:(this._useHeaderPathCache=!1,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear())}getBodyWidthCache(t,e){if(this._useGetBodyCache&&!this.isHeader(t,e)&&!this.isSeriesNumber(t,e))return this.indicatorsAsCol&&this._getBodyCache.has(t)?this._getBodyCache.get(t):!this.indicatorsAsCol&&this._getBodyCache.has(e)?this._getBodyCache.get(e):void 0}setBodyWidthCache(t,e,i){!this._useGetBodyCache||this.isHeader(t,e)||this.isSeriesNumber(t,e)||(this.indicatorsAsCol?this._getBodyCache.set(t,i):this._getBodyCache.set(e,i))}getColHeaderPathCache(t,e){if(this._useHeaderPathCache&&!this.isHeader(t,e)&&!this.isSeriesNumber(t,e)&&this._colHeaderPathCache.has(t))return this._colHeaderPathCache.get(t)}setColHeaderPathCache(t,e,i){!this._useHeaderPathCache||this.isHeader(t,e)||this.isSeriesNumber(t,e)||this._colHeaderPathCache.set(t,i)}getRowHeaderPathCache(t,e){if(this._useHeaderPathCache&&!this.isHeader(t,e)&&!this.isSeriesNumber(t,e)&&this._rowHeaderPathCache.has(e))return this._rowHeaderPathCache.get(e)}setRowHeaderPathCache(t,e,i){!this._useHeaderPathCache||this.isHeader(t,e)||this.isSeriesNumber(t,e)||this._rowHeaderPathCache.set(e,i)}clearHeaderPathCache(){this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}isAggregation(t,e){if(this.isHeader(t,e))return!1;let i=this.getCellHeaderPaths(t,e);for(let t of i.colHeaderPaths)if("sub-total"===t.role||"grand-total"===t.role)return!0;for(let t of i.rowHeaderPaths)if("sub-total"===t.role||"grand-total"===t.role)return!0;return!1}expandAllForRowDimensionTree(){this.rowDimensionTree&&(this.rowDimensionTree.setAllNodesState(n.g.expand),this._rebuildRowLayout())}collapseAllForRowDimensionTree(){this.rowDimensionTree&&(this.rowDimensionTree.setAllNodesState(n.g.collapse),this._rebuildRowLayout())}expandAllForColumnDimensionTree(){this.columnDimensionTree&&(this.columnDimensionTree.setAllNodesState(n.g.expand),this._rebuildColumnLayout())}collapseAllForColumnDimensionTree(){this.columnDimensionTree&&(this.columnDimensionTree.setAllNodesState(n.g.collapse),this._rebuildColumnLayout())}}function f(t,e,i,r){var n,l,s;let a;1===i&&(i=0);let o=(n=t,l=i,s=r,a=1===n?n+2*s:n-l+2*s,n?a>0?a:1:0);return Math.ceil(e/(1-i)*o)}},66023:function(t,e,i){i.d(e,{KO:()=>o,LC:()=>function t(e,i){Array.isArray(i)&&(null==i||i.forEach(i=>{var r,n;let l={dimensionKey:i.dimensionKey,indicatorKey:i.indicatorKey,value:i.value,hierarchyState:i.hierarchyState,children:void 0,virtual:null!=(r=i.virtual)&&r,levelSpan:null!=(n=i.levelSpan)?n:1};e.push(l),i.children&&(l.children=[],t(l.children,i.children))}))},g3:()=>h,gD:()=>function t(e,i,r,n,l){var s;for(let a=e.length-1;a>=0;a--){let o=e[a];if(i.push(o),n&&o.hide)e.splice(a,1);else if(o.indicatorKey){let t=null==(s=null==r?void 0:r.find(t=>t.indicatorKey===o.indicatorKey))?void 0:s.hide;"function"==typeof t?t({dimensionPaths:i,table:l})&&e.splice(a,1):t&&e.splice(a,1)}else o.children&&o.children.length>0&&t(o.children,i,r,n,l);i.pop()}},jS:()=>d,p$:()=>function t(e,i){let r=0;return null==e||e.forEach(e=>{i?r++:e.children&&0!==e.children.length||r++,e.children&&(r+=t(e.children,i))}),r},py:()=>u});var r=i(65755),n=i(64776),l=i(93250),s=i(77874),a=i(72281);class o{constructor(t,e,i="grid",r){this.hasHideNode=!1,this.sizeIncludeParent=!1,this.tree={id:0,dimensionKey:"",value:"",children:[],level:-1,afterSpanLevel:-1,levelSpan:1,startIndex:0,size:0,startInTotal:0,hierarchyState:void 0},this.totalLevel=0,this.expandedMaxLevel=0,this.dimensionKeys=new l.B,this.dimensionKeysIncludeVirtual=new l.B,this.cache=new Map,this.sizeIncludeParent=null!=r,this.setExpandLevel=r,this.hierarchyType=i,this.sharedVar=e,this.reset(t)}reset(t){this.totalLevel=0,this.expandedMaxLevel=0,this.hasHideNode=!1,this.cache.clear(),this.dimensionKeys=new l.B,this.dimensionKeysIncludeVirtual=new l.B,this.tree.children=t,this.setTreeNode(this.tree,0,this.tree)}setTreeNode(t,e,i){var r,n,l,o;t.startIndex=e,t.startInTotal=(null!=(r=i.startInTotal)?r:0)+t.startIndex,t.hide&&(this.hasHideNode=!0),(null!=(n=t.dimensionKey)?n:t.indicatorKey)&&(t.virtual||this.dimensionKeys.contain(t.indicatorKey?s.ek:t.dimensionKey)||this.dimensionKeys.put(t.level,t.indicatorKey?s.ek:t.dimensionKey),this.dimensionKeysIncludeVirtual.contain(t.indicatorKey?s.ek:t.dimensionKey)||this.dimensionKeysIncludeVirtual.put(t.level,t.indicatorKey?s.ek:t.dimensionKey),t.id||(t.id=++this.sharedVar.seqId));let h=t.dimensionKey&&this.sizeIncludeParent?1:0,d=t.children||t.columns;return"grid"===this.hierarchyType||null===this.hierarchyType?(null==d?void 0:d.length)>=1?d.forEach(e=>{var i,r,n;e.level=(null!=(i=t.level)?i:0)+1,"grid"===this.hierarchyType&&(e.afterSpanLevel=(null!=(r=t.afterSpanLevel)?r:0)+(null!=(n=t.levelSpan)?n:1)),this.totalLevel=Math.max(this.totalLevel,e.level+1),h+=this.setTreeNode(e,h,t)}):h=+(-1!==t.level):t.hierarchyState===a.g.expand&&(null==d?void 0:d.length)>=1?d.forEach(e=>{var i;e.level=(null!=(i=t.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,e.level+1),h+=this.setTreeNode(e,h,t)}):t.hierarchyState===a.g.collapse&&(null==d?void 0:d.length)>=1?d.forEach(e=>{var i;e.level=(null!=(i=t.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.setTreeNode(e,h,t)}):!t.hierarchyState&&t.level+1<this.setExpandLevel&&((null==d?void 0:d.length)>=1||!0===d)?((null==(l=d[0])?void 0:l.indicatorKey)&&"grid-tree"===this.hierarchyType||(t.hierarchyState=a.g.expand),(null==d?void 0:d.length)>=1&&d.forEach(e=>{var i;e.level=(null!=(i=t.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,e.level+1),h+=this.setTreeNode(e,h,t)})):(null==d?void 0:d.length)>=1||!0===d?((null==(o=d[0])?void 0:o.indicatorKey)&&"grid-tree"===this.hierarchyType||(t.hierarchyState=a.g.collapse),(null==d?void 0:d.length)>=1&&d.forEach(e=>{var i;e.level=(null!=(i=t.level)?i:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.setTreeNode(e,h,t)})):(t.hierarchyState=a.g.none,h=+(-1!==t.level)),t.size=h,h}getTreePath(t,e=30){let i=[];return this.searchPath(t,this.tree,i,e),i.shift(),i}findNodeById(t,e){return t.find(t=>t.id===e)}searchPath(t,e,i,r){if(!e||t<e.startIndex||t>=e.startIndex+e.size||(i.push(e),!e.children||0===e.children.length||e.level>=r))return;let n=t-e.startIndex;if(this.cache.has(e.level+1)){let t=this.cache.get(e.level+1);if(n>=t.startIndex&&n<t.startIndex+t.size)return void this.searchPath(n,t,i,r)}let l=0,s=e.children.length-1;for(;l<=s;){let t=Math.floor((l+s)/2),a=e.children[t];if(n>=a.startIndex&&n<a.startIndex+a.size){this.cache.set(a.level,a);let t=[];this.cache.forEach((e,i)=>{i>a.level&&t.push(i)}),t.forEach(t=>{this.cache.delete(t)}),this.searchPath(n,a,i,r);break}n<a.startIndex?s=t-1:l=t+1}}movePosition(t,e,i){let r,n,l,s=(a,o)=>{if(void 0!==n&&void 0!==l)return;a.level===t&&(a.startInTotal===e&&(n=o),a.startInTotal<=i&&i<=a.startInTotal+a.size-1&&(l=o));let h=a.children||a.columns;if(h&&a.level<t){r=a;for(let t=0;t<h.length;t++)(e>=h[t].startInTotal&&e<=h[t].startInTotal+h[t].size||i>=h[t].startInTotal&&i<=h[t].startInTotal+h[t].size)&&s(h[t],t)}};s(this.tree,0);let a=r.children||r.columns,o=a.splice(n,1);o.unshift(l,0),Array.prototype.splice.apply(a,o)}getCopiedTree(){let t=(0,r.Z)(this.tree.children);return function t(e){for(let i=0;i<e.length;i++){let r=e[i];delete r.level,delete r.startIndex,delete r.id,delete r.levelSpan,delete r.size,delete r.startInTotal;let n=r.children||r.columns;n&&t(n)}}(t),t}setAllNodesState(t){this._updateNodeHierarchyState(this.tree,t)}_updateNodeHierarchyState(t,e){t.children&&t.children.length>0&&t.children[0].dimensionKey?(-1!==t.level&&(t.hierarchyState=e),t.children.forEach(t=>{this._updateNodeHierarchyState(t,e)})):t.hierarchyState=a.g.none}}function h(t,e,i,r,l,s){var a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P;let B=t.id,I=null!=(o=null==(a=s.rowsDefine)?void 0:a.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey))?o:null==(h=s.columnsDefine)?void 0:h.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey),E=null==(d=s.indicatorsDefine)?void 0:d.find(e=>"string"!=typeof e&&(t.indicatorKey?e.indicatorKey===t.indicatorKey:e.title===t.value&&!t.dimensionKey)),L={id:B,title:null!=(u=t.value)?u:null==E?void 0:E.title,field:t.dimensionKey,style:"function"==typeof(null==(c=null!=E?E:I)?void 0:c.headerStyle)?null==(p=null!=E?E:I)?void 0:p.headerStyle:Object.assign({},null==(g=null!=E?E:I)?void 0:g.headerStyle),headerType:null!=(m=null!=(f=null==E?void 0:E.headerType)?f:null==I?void 0:I.headerType)?m:"text",headerIcon:null!=(y=null==E?void 0:E.headerIcon)?y:null==I?void 0:I.headerIcon,define:Object.assign({},t,null!=E?E:Object.assign({},I,{sort:void 0})),fieldFormat:null!=(v=null==E?void 0:E.headerFormat)?v:null==I?void 0:I.headerFormat,dropDownMenu:null!=(b=null==E?void 0:E.dropDownMenu)?b:null==I?void 0:I.dropDownMenu,pivotInfo:{value:t.value,dimensionKey:t.dimensionKey,isPivotCorner:!1},width:null==I?void 0:I.width,minWidth:null==I?void 0:I.minWidth,maxWidth:null==I?void 0:I.maxWidth,showSort:null!=(_=null==E?void 0:E.showSort)?_:null==I?void 0:I.showSort,sort:null==E?void 0:E.sort,description:null==I?void 0:I.description};E?(E.customRender&&(t.customRender=E.customRender),(0,n.Z)(null==(C=s._indicators)?void 0:C.find(t=>t.indicatorKey===E.indicatorKey))||null==(x=s._indicators)||x.push({id:++s.sharedVar.seqId,indicatorKey:E.indicatorKey,field:E.indicatorKey,fieldFormat:null==E?void 0:E.format,cellType:null!=(S=null!=(w=null==E?void 0:E.cellType)?w:null==E?void 0:E.columnType)?S:"text",chartModule:"chartModule"in E?E.chartModule:null,chartSpec:"chartSpec"in E?E.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in E&&E.noDataRenderNothing,sparklineSpec:"sparklineSpec"in E?E.sparklineSpec:null,style:null==E?void 0:E.style,icon:null==E?void 0:E.icon,define:Object.assign({},t,E,{dragHeader:null==I?void 0:I.dragHeader}),width:null==E?void 0:E.width,minWidth:null==E?void 0:E.minWidth,maxWidth:null==E?void 0:E.maxWidth,disableColumnResize:null==E?void 0:E.disableColumnResize})):t.indicatorKey&&((0,n.Z)(null==(A=s._indicators)?void 0:A.find(e=>e.indicatorKey===t.indicatorKey))||null==(M=s._indicators)||M.push({id:++s.sharedVar.seqId,indicatorKey:t.indicatorKey,field:t.indicatorKey,cellType:"text",define:Object.assign({},t)})),i[B]=L,s._headerObjects[B]=L;for(let t=l-1;t>=0;t--)e[t][s.colIndex]=r[t];if(e[l][s.colIndex]=B,t.levelSpan>1)for(let i=1;i<t.levelSpan;i++){if(!e[l+i]){e[l+i]=[];for(let t=0;t<s.colIndex;t++)e[l+i][t]=e[l][t]}e[l+i][s.colIndex]=B}if((null==(T=t.children)?void 0:T.length)>=1)s._addHeaders(e,l+(null!=(k=t.levelSpan)?k:1),null!=(R=t.children)?R:[],[...r,...Array(null!=(P=t.levelSpan)?P:1).fill(B)],i);else{for(let t=l+1;t<e.length;t++)e[t][s.colIndex]=B;s.colIndex++}}function d(t,e,i,r,l,s,o,h,d,u,c,p){var g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X,Y,$,q,J;let Q=t.id,te=null!=(f=null==(g=p.rowsDefine)?void 0:g.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey))?f:null==(m=p.columnsDefine)?void 0:m.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey),ti=null==(y=p.indicatorsDefine)?void 0:y.find(e=>"string"!=typeof e&&(t.indicatorKey?e.indicatorKey===t.indicatorKey:e.title===t.value&&!t.dimensionKey)),tr={id:Q,title:null!=(v=t.value)?v:null==ti?void 0:ti.title,field:t.dimensionKey,style:"function"==typeof(null==(b=null!=ti?ti:te)?void 0:b.headerStyle)?null==(_=null!=ti?ti:te)?void 0:_.headerStyle:Object.assign({},null==(C=null!=ti?ti:te)?void 0:C.headerStyle),headerType:null!=(w=null!=(x=null==ti?void 0:ti.headerType)?x:null==te?void 0:te.headerType)?w:"text",headerIcon:null!=(S=null==ti?void 0:ti.headerIcon)?S:null==te?void 0:te.headerIcon,define:Object.assign(t,{linkJump:null==(A=null!=ti?ti:te)?void 0:A.linkJump,linkDetect:null==(M=null!=ti?ti:te)?void 0:M.linkDetect,templateLink:null==(T=null!=ti?ti:te)?void 0:T.templateLink,keepAspectRatio:null!=(R=null==(k=null!=ti?ti:te)?void 0:k.keepAspectRatio)&&R,imageAutoSizing:null==(P=null!=ti?ti:te)?void 0:P.imageAutoSizing,headerCustomRender:null==(B=null!=ti?ti:te)?void 0:B.headerCustomRender,headerCustomLayout:null==(I=null!=ti?ti:te)?void 0:I.headerCustomLayout,dragHeader:null==te?void 0:te.dragHeader,disableHeaderHover:!!(null==(E=null!=ti?ti:te)?void 0:E.disableHeaderHover),disableHeaderSelect:!!(null==(L=null!=ti?ti:te)?void 0:L.disableHeaderSelect),showSort:null!=(F=null==ti?void 0:ti.showSort)?F:null==te?void 0:te.showSort,hide:null==ti?void 0:ti.hide}),fieldFormat:null!=(O=null==ti?void 0:ti.headerFormat)?O:null==te?void 0:te.headerFormat,dropDownMenu:null!=(H=null==ti?void 0:ti.dropDownMenu)?H:null==te?void 0:te.dropDownMenu,pivotInfo:{value:t.value,dimensionKey:t.dimensionKey,isPivotCorner:!1},hierarchyLevel:t.level,dimensionTotalLevel:s,hierarchyState:t.hierarchyState,width:null==te?void 0:te.width,minWidth:null==te?void 0:te.minWidth,maxWidth:null==te?void 0:te.maxWidth,showSort:null!=(D=null==ti?void 0:ti.showSort)?D:null==te?void 0:te.showSort,sort:null==ti?void 0:ti.sort,description:null==te?void 0:te.description,parentCellId:r[r.length-1]};ti?(ti.customRender&&(t.customRender=ti.customRender),(0,n.Z)(null==(z=p._indicators)?void 0:z.find(t=>t.indicatorKey===ti.indicatorKey))||null==(W=p._indicators)||W.push({id:++p.sharedVar.seqId,indicatorKey:ti.indicatorKey,field:ti.indicatorKey,fieldFormat:null==ti?void 0:ti.format,cellType:null!=(N=null!=(Z=null==ti?void 0:ti.cellType)?Z:null==ti?void 0:ti.columnType)?N:"text",chartModule:"chartModule"in ti?ti.chartModule:null,chartSpec:"chartSpec"in ti?ti.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in ti&&ti.noDataRenderNothing,sparklineSpec:"sparklineSpec"in ti?ti.sparklineSpec:null,style:null==ti?void 0:ti.style,icon:null==ti?void 0:ti.icon,define:Object.assign({},t,ti,{dragHeader:null==te?void 0:te.dragHeader}),width:null==ti?void 0:ti.width,minWidth:null==ti?void 0:ti.minWidth,maxWidth:null==ti?void 0:ti.maxWidth,disableColumnResize:null==ti?void 0:ti.disableColumnResize})):t.indicatorKey&&((0,n.Z)(null==(j=p._indicators)?void 0:j.find(e=>e.indicatorKey===t.indicatorKey))||null==(G=p._indicators)||G.push({id:++p.sharedVar.seqId,indicatorKey:t.indicatorKey,field:t.indicatorKey,cellType:"text",define:Object.assign({},t)})),i[Q]=tr,p._headerObjects[Q]=tr;for(let t=l-1;t>=0;t--)e[t][p.colIndex]=r[t];e[l][p.colIndex]=Q;let tn=Math.min((u?c:!c)?o:o-1,null!=(V=t.levelSpan)?V:1e3);if(tn>0)for(let t=l+1;t<tn;t++){if(!e[t]){e[t]=[];for(let i=0;i<p.colIndex;i++)e[t][i]=e[l][i]}e[t][p.colIndex]=Q}if((null==(U=(t.hierarchyState===a.g.expand&&t).children)?void 0:U.length)>=1)p._addHeadersForGridTreeMode(e,l+(null!=(K=t.levelSpan)?K:1),null!=(X=t.children)?X:[],[...r,...Array(null!=(Y=t.levelSpan)?Y:1).fill(Q)],s,o,h&&t.hierarchyState===a.g.expand,d,i,u);else{let n=(u?c:!c)?o:o-1;for(let t=l+1;t<n;t++)e[t]||(e[t]=[]),e[t][p.colIndex]=Q;if(l<=n-1&&(u&&!1===c||!u&&!0===c)){let a=t;for(;a&&!(null==($=a.children)?void 0:$[0].indicatorKey);)a=a.children[0];p._addHeadersForGridTreeMode(e,o-1,null!=(q=a.children)?q:[],[...r,...Array(Math.max(n-l,null!=(J=t.levelSpan)?J:1)).fill(Q)],s,o,!0,d,i,u)}else p.colIndex++}}function u(t,e,i,r,l,s,o,h,d){var u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F,O,H,D,z;let W=t.id,Z=h.find(e=>"string"!=typeof e&&e.dimensionKey===t.dimensionKey),N=null==(u=d.indicatorsDefine)?void 0:u.find(e=>"string"!=typeof e&&(t.indicatorKey?e.indicatorKey===t.indicatorKey:e.title===t.value)),j={id:W,title:null!=(c=t.value)?c:N.title,field:t.dimensionKey,style:t.level+1===s||"function"==typeof(null==(p=null!=N?N:Z)?void 0:p.headerStyle)?null==(g=null!=N?N:Z)?void 0:g.headerStyle:Object.assign({},null==(f=null!=N?N:Z)?void 0:f.headerStyle,{textAlign:"left"}),headerType:null!=(y=null!=(m=null==N?void 0:N.headerType)?m:null==Z?void 0:Z.headerType)?y:"text",headerIcon:null!=(v=null==N?void 0:N.headerIcon)?v:null==Z?void 0:Z.headerIcon,define:Object.assign(t,{linkJump:null==(b=null!=N?N:Z)?void 0:b.linkJump,linkDetect:null==(_=null!=N?N:Z)?void 0:_.linkDetect,templateLink:null==(C=null!=N?N:Z)?void 0:C.templateLink,keepAspectRatio:null!=(w=null==(x=null!=N?N:Z)?void 0:x.keepAspectRatio)&&w,imageAutoSizing:null==(S=null!=N?N:Z)?void 0:S.imageAutoSizing,headerCustomRender:null==(A=null!=N?N:Z)?void 0:A.headerCustomRender,headerCustomLayout:null==(M=null!=N?N:Z)?void 0:M.headerCustomLayout,dragHeader:null==Z?void 0:Z.dragHeader,disableHeaderHover:!!(null==(T=null!=N?N:Z)?void 0:T.disableHeaderHover),disableHeaderSelect:!!(null==(k=null!=N?N:Z)?void 0:k.disableHeaderSelect),showSort:null!=(R=null==N?void 0:N.showSort)?R:null==Z?void 0:Z.showSort,hide:null==N?void 0:N.hide}),fieldFormat:null!=(P=null==N?void 0:N.headerFormat)?P:null==Z?void 0:Z.headerFormat,dropDownMenu:null!=(B=null==N?void 0:N.dropDownMenu)?B:null==Z?void 0:Z.dropDownMenu,pivotInfo:{value:t.value,dimensionKey:t.dimensionKey,isPivotCorner:!1},hierarchyLevel:t.level,dimensionTotalLevel:s,hierarchyState:t.hierarchyState,width:null==Z?void 0:Z.width,minWidth:null==Z?void 0:Z.minWidth,maxWidth:null==Z?void 0:Z.maxWidth,parentCellId:r[r.length-1]};N?(N.customRender&&(t.customRender=N.customRender),(0,n.Z)(null==(I=d._indicators)?void 0:I.find(t=>t.indicatorKey===N.indicatorKey))||null==(E=d._indicators)||E.push({id:++d.sharedVar.seqId,indicatorKey:N.indicatorKey,field:N.indicatorKey,fieldFormat:null==N?void 0:N.format,cellType:null!=(F=null!=(L=null==N?void 0:N.cellType)?L:null==N?void 0:N.columnType)?F:"text",chartModule:"chartModule"in N?N.chartModule:null,chartSpec:"chartSpec"in N?N.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in N&&N.noDataRenderNothing,sparklineSpec:"sparklineSpec"in N?N.sparklineSpec:null,style:null==N?void 0:N.style,icon:null==N?void 0:N.icon,define:Object.assign({},t,N,{dragHeader:null==Z?void 0:Z.dragHeader}),width:null==N?void 0:N.width,minWidth:null==N?void 0:N.minWidth,maxWidth:null==N?void 0:N.maxWidth,disableColumnResize:null==N?void 0:N.disableColumnResize})):t.indicatorKey&&((0,n.Z)(null==(O=d._indicators)?void 0:O.find(e=>e.indicatorKey===t.indicatorKey))||null==(H=d._indicators)||H.push({id:++d.sharedVar.seqId,indicatorKey:t.indicatorKey,field:t.indicatorKey,cellType:"text",define:Object.assign({},t)})),i[W]=j,d._headerObjects[W]=j,e[l][d.colIndex]=W;for(let t=l-1;t>=0;t--)e[t][d.colIndex]=r[t];if(t.hierarchyState===a.g.expand&&(null==(D=t.children)?void 0:D.length)>=1)o&&d.colIndex++,d._addHeadersForTreeMode(e,l,null!=(z=t.children)?z:[],[...r,W],s,o&&t.hierarchyState===a.g.expand,h,i);else{o&&d.colIndex++;for(let t=l+1;t<e.length;t++)e[t][d.colIndex]=W}}},83808:function(t,e,i){i.d(e,{Wg:()=>o,wh:()=>h,zf:()=>d});var r=i(96241),n=i(20408),l=i(64776),s=i(26025),a=i(31877);class o{constructor(t,e,i){this.table=t,this.customCellStyle=e,this.customCellStyleArrangement=i}getCustomCellStyle(t,e){let i=this.getCustomCellStyleIds(t,e);if(i.length){let l=[];return i.forEach(i=>{let n=this.getCustomCellStyleOption(i);if((0,r.Z)(null==n?void 0:n.style)){let i=n.style({col:t,row:e,table:this.table,value:this.table.getCellValue(t,e),dataValue:this.table.getCellOriginValue(t,e),cellHeaderPaths:this.table.getCellHeaderPaths(t,e)});l.push(i)}else(null==n?void 0:n.style)&&l.push(n.style)}),(0,n.Z)({},...l)}}getCustomCellStyleIds(t,e){let i=[],r=this.table.getCellRange(t,e);for(let t=r.start.col;t<=r.end.col;t++)for(let e=r.start.row;e<=r.end.row;e++)this.customCellStyleArrangement.forEach(r=>{r.cellPosition.range?r.cellPosition.range.start.col<=t&&r.cellPosition.range.end.col>=t&&r.cellPosition.range.start.row<=e&&r.cellPosition.range.end.row>=e&&i.push(r.customStyleId):r.cellPosition.col===t&&r.cellPosition.row===e&&i.push(r.customStyleId)});return i}getCustomCellStyleOption(t){return this.customCellStyle.find(e=>e.id===t)}registerCustomCellStyle(t,e){let i=this.customCellStyle.findIndex(e=>e.id===t);-1===i?this.customCellStyle.push({id:t,style:e}):this.customCellStyle[i]={id:t,style:e},this.customCellStyleArrangement.forEach(e=>{let i=e.cellPosition;if(e.customStyleId===t)if(i.range)for(let t=Math.max(0,i.range.start.col);t<=Math.min(this.table.colCount-1,i.range.end.col);t++)for(let e=Math.max(0,i.range.start.row);e<=Math.min(this.table.rowCount-1,i.range.end.row);e++)this.table.scenegraph.updateCellContent(t,e);else this.table.scenegraph.updateCellContent(i.col,i.row)}),this.table.scenegraph.updateNextFrame()}arrangeCustomCellStyle(t,e,i){var r;let n=this.customCellStyleArrangement.findIndex(e=>e.cellPosition.range&&t.range?e.cellPosition.range.start.col===t.range.start.col&&e.cellPosition.range.start.row===t.range.start.row&&e.cellPosition.range.end.col===t.range.end.col&&e.cellPosition.range.end.row===t.range.end.row:e.cellPosition.col===t.col&&e.cellPosition.row===t.row);if(-1===n&&!e)return;if(-1===n&&e)this.customCellStyleArrangement.push({cellPosition:{col:t.col,row:t.row,range:t.range},customStyleId:e});else{if(this.customCellStyleArrangement[n].customStyleId===e)return;e?this.customCellStyleArrangement[n].customStyleId=e:this.customCellStyleArrangement.splice(n,1)}let l=null==(r=this.getCustomCellStyleOption(e))?void 0:r.style;if(l){for(let t in i=!0,l)if(-1===s.n.indexOf(t)){i=!1;break}}if(t.range)for(let e=Math.max(0,t.range.start.col);e<=Math.min(this.table.colCount-1,t.range.end.col);e++)for(let r=Math.max(0,t.range.start.row);r<=Math.min(this.table.rowCount-1,t.range.end.row);r++){let t=this.table.getCellRange(e,r);for(let e=t.start.col;e<=t.end.col;e++)for(let r=t.start.row;r<=t.end.row;r++)this.table.scenegraph.updateCellContent(e,r,i)}else this.table.scenegraph.updateCellContent(t.col,t.row,i);this.table.scenegraph.updateNextFrame()}updateCustomCell(t,e){this.customCellStyle.length=0,this.customCellStyleArrangement.length=0,t.forEach(t=>{this.registerCustomCellStyle(t.id,t.style)}),e.forEach(t=>{this.arrangeCustomCellStyle(t.cellPosition,t.customStyleId)})}hasCustomCellStyle(t){return this.customCellStyle.some(e=>e.id===t)}}function h(t,e){for(let i in t=t.clone(),e){let r=e[i];(0,l.Z)(r)&&(t[`_${i}`]=r)}return t}let d=()=>{a.F.registerComponent("customCellStylePlugin",o)}},43919:function(t,e,i){i.d(e,{Q:()=>r});class r{constructor(t,e){var i;this.plugins=new Map,this.pluginEventMap=new Map,this.table=t,null==(i=e.plugins)||i.map(t=>{this.register(t),this._bindTableEventForPlugin(t)})}register(t){this.plugins.set(t.id,t)}registerAll(t){t.forEach(t=>this.register(t))}getPlugin(t){return this.plugins.get(t)}getPluginByName(t){return Array.from(this.plugins.values()).find(e=>e.name===t)}_bindTableEventForPlugin(t){var e;null==(e=t.runTime)||e.forEach(e=>{let i=this.table.on(e,(...i)=>{var r;null==(r=t.run)||r.call(t,...i,e,this.table)});this.pluginEventMap.set(t.id,[...this.pluginEventMap.get(t.id)||[],i])})}removeOrAddPlugins(t){Array.from(this.plugins.values()).filter(e=>!(null==t?void 0:t.some(t=>t.id===e.id))).forEach(t=>{var e;null==(e=this.pluginEventMap.get(t.id))||e.forEach(t=>{this.table.off(t)}),this.release(),this.plugins.delete(t.id)});let e=null==t?void 0:t.filter(t=>!this.plugins.has(t.id));null==e||e.forEach(t=>{this.register(t),this._bindTableEventForPlugin(t)})}updatePlugins(t){null==t||t.forEach(t=>{t.update&&t.update()})}release(){this.plugins.forEach(t=>{var e;null==(e=t.release)||e.call(t,this.table)})}}},20968:function(t,e,i){i.r(e),i.d(e,{aggregator:()=>p,chartModule:()=>u,clearAll:()=>f,editor:()=>c,icon:()=>d,theme:()=>h});var r=i(9607),n=i(10869),l=i(34088),s=i(23269),a=i(39433);function o(t,e,i){let r=t[e];return t[e]=i,r}function h(t,e){return null!=e?o(n.n,t,e):n.n[t]}function d(t,e){return null!=e?o(r.ci,t,e):r.ci[t]}function u(t,e){return null!=e?o(l.f,t,e):l.f[t]}function c(t,e){return null!=e?o(s.X,t,e):s.X[t]}function p(t,e){null!=e&&o(a.YJ,t,e)}function g(t){for(let e in t)delete t[e]}function f(){g(n.n),g(r.ci),g(l.f),g(s.X),g(a.YJ)}},73501:function(t,e,i){i.d(e,{FH:()=>b,Jp:()=>w,Ki:()=>v,cd:()=>_,nH:()=>S,ws:()=>C});var r=i(8849),n=i(638),l=i(22288),s=i(63654),a=i(24217),o=i(9252),h=i(91689),d=i(96241),u=i(64776),c=i(83624),p=i(80971),g=i(95723),f=i(68173),m=i(30497),y=i(53430);let v="_custom_",b="custom-container",_=v+"_0";function C(t,e,i,h,p,g,y,_,C,M,T){var k,R,P;let B,I,E,L,F=!0,O=!1;if("react-custom-layout"===t&&(t=(null==(k=T.reactCustomLayout)?void 0:k.getCustomLayoutFunc(i,h))||m.D),"function"==typeof t){let e=t({col:null!=(R=null==M?void 0:M.start.col)?R:i,row:null!=(P=null==M?void 0:M.start.row)?P:h,dataValue:T.getCellOriginValue(i,h),value:T.getCellValue(i,h)||"",rect:{left:0,top:0,right:p,bottom:g,width:p,height:g},table:T,originCol:i,originRow:h});if(!e)return{renderDefault:!0};e.rootContainer&&(e.rootContainer=S(e.rootContainer,T.animationManager.timeline)),e.rootContainer instanceof r.ZA&&((L=e.rootContainer).name=b,L.col=i,L.row=h),F=e.renderDefault,O=e.enableCellPadding}else if("function"==typeof e){let t=e({col:i,row:h,dataValue:T.getCellOriginValue(i,h),value:T.getCellValue(i,h)||"",rect:{left:0,top:0,right:p,bottom:g,width:p,height:g},table:T});t&&(E=t.elements,F=t.renderDefault,B=t.expectedWidth,I=t.expectedHeight)}else e&&(B=e.expectedWidth,I=e.expectedHeight,E=e.elements,F=e.renderDefault);return E&&(L=function(t,e,i,h){let p=new r.ZA({x:0,y:0,width:e,height:i,fill:!1,stroke:!1,pickable:!1});return p.name=b,(function(t,e,i,r){let n=[];for(let l=0;l<t.length;l++){let s=Object.assign({},t[l]);for(let t in s)s.hasOwnProperty(t)&&(0,d.Z)(s[t])&&(s[t]=s[t](r));(0,u.Z)(s.x)&&(s.x=(0,c.Z)(s.x)?x(s.x,e-0):Number(s.x)),(0,u.Z)(s.y)&&(s.y=(0,c.Z)(s.y)?x(s.y,i-0):Number(s.y)),"width"in s&&(s.width=(0,c.Z)(s.width)?x(s.width,e-0):Number(s.width)),"height"in s&&(s.height=(0,c.Z)(s.height)?x(s.height,i-0):Number(s.height)),"radius"in s&&(s.radius=(0,c.Z)(s.radius)?x(s.radius,Math.min(e-0,i-0)):Number(s.radius)),"hover"in s&&(s.hover.x=(0,c.Z)(s.hover.x)?x(s.hover.x,e-0):Number(s.hover.x),s.hover.y=(0,c.Z)(s.hover.y)?x(s.hover.y,i-0):Number(s.hover.y),s.hover.width=(0,c.Z)(s.hover.width)?x(s.hover.width,e-0):Number(s.hover.width),s.hover.height=(0,c.Z)(s.hover.height)?x(s.hover.height,i-0):Number(s.hover.height),s.hover.x+=0,s.hover.y+=0),s.x=s.x+0,s.y=s.y+0,n.push(s)}return n})(t,e,i,h).forEach(t=>{var e,i,r,h,d,u,c,g,m,y,v,b,_,C,x,w,S,A,M,T,k,R,P,B,I,E,L,F;switch(t.clickable&&(t.pickable=t.clickable),t.type){case"arc":let O=(0,n.Q)({x:t.x,y:t.y,dx:null!=(e=t.dx)?e:0,dy:null!=(i=t.dy)?i:0,fill:t.fill,stroke:t.stroke,outerRadius:t.radius,startAngle:t.startAngle,endAngle:t.endAngle,pickable:!!t.pickable,cursor:t.cursor});O.name=t.name,p.appendChild(O);break;case"text":if(t.background){let e=null!=(h=null==(r=t.background)?void 0:r.expandX)?h:0,i=null!=(u=null==(d=t.background)?void 0:d.expandY)?u:0,n=(0,l.f)({x:t.x-e,y:t.y-i,dx:null!=(c=t.dx)?c:0,dy:null!=(g=t.dy)?g:0,width:t.width+2*e,height:t.height+2*i,cornerRadius:null!=(y=null==(m=t.background)?void 0:m.cornerRadius)?y:0,fill:null!=(b=null==(v=t.background)?void 0:v.fill)?b:"#888"});p.appendChild(n)}let H=new s.x(Object.assign({pickable:!!t.pickable,fill:null!=(_=t.color)?_:t.fill},t));H.name=t.name,p.appendChild(H);break;case"rect":let D=(0,l.f)({x:t.x,y:t.y,dx:null!=(C=t.dx)?C:0,dy:null!=(x=t.dy)?x:0,width:t.width,height:t.height,cornerRadius:t.radius,fill:t.fill,stroke:t.stroke,pickable:!!t.pickable,cursor:t.cursor});D.name=t.name,p.appendChild(D);break;case"circle":let z=(0,a.y)({x:t.x,y:t.y,dx:null!=(w=t.dx)?w:0,dy:null!=(S=t.dy)?S:0,radius:t.radius,fill:t.fill,stroke:t.stroke,pickable:!!t.pickable,cursor:t.cursor});z.name=t.name,p.appendChild(z);break;case"icon":let W=new f.J({x:t.x,y:t.y,dx:null!=(A=t.dx)?A:0,dy:null!=(M=t.dy)?M:0,width:t.width,height:t.height,image:t.svg,backgroundWidth:t.hover?null!=(T=t.hover.width)?T:t.width:void 0,backgroundHeight:t.hover?null!=(k=t.hover.width)?k:t.width:void 0,backgroundColor:t.hover?null!=(R=t.hover.bgColor)?R:"rgba(22,44,66,0.2)":void 0,pickable:!!t.pickable,cursor:t.cursor});W.name=t.name,W.role="icon-custom",p.appendChild(W);break;case"image":let Z=new f.J({x:t.x,y:t.y,dx:null!=(P=t.dx)?P:0,dy:null!=(B=t.dy)?B:0,width:t.width,height:t.height,image:t.src,backgroundWidth:t.hover?null!=(I=t.hover.width)?I:t.width:void 0,backgroundHeight:t.hover?null!=(E=t.hover.width)?E:t.width:void 0,backgroundColor:t.hover?null!=(L=t.hover.bgColor)?L:"rgba(22,44,66,0.2)":void 0,pickable:!!t.pickable,cursor:t.cursor,shape:t.shape});Z.name=t.name,Z.role="image-custom",p.appendChild(Z);break;case"line":let N=(0,o.W)({points:t.points,lineWidth:null!=(F=t.lineWidth)?F:1,stroke:t.stroke,pickable:!!t.pickable,cursor:t.cursor});N.name=t.name,p.appendChild(N)}}),p}(E,y?B:p,_?I:g,T.getCellValue(i,h))),O&&L.setAttributes({x:C[3],y:C[0],width:p-C[1]-C[3],height:g-C[0]-C[2]}),w(L,p,g),M&&(M.start.col!==M.end.col||M.start.row!==M.end.row)&&function t(e,i,r,n,l){e&&(e.name=`${v}${null!=l?l:""}_${n}`,e.onBeforeAttributeUpdate=A,"group"===e.type&&e.childrenCount&&e.forEachChildren((e,s)=>{t(e,i,r,s,(null!=l?l:"")+"_"+n)}))}(L,i,h,0),{elementsGroup:L,renderDefault:F}}function x(t,e){return t.endsWith("px")?parseInt(t,10):t.endsWith("%")&&e?parseInt(t,10)/100*e:parseInt(t,10)}function w(t,e,i){t&&t.forEachChildren(t=>{var r,n;t&&((0,p.Z)(t.attribute.width)&&t.attribute.width.percent&&t.setAttribute("width",Math.max(0,t.attribute.width.percent/100*e+(null!=(r=t.attribute.width.delta)?r:0))),t.attribute.width<0&&t.setAttribute("width",0),(0,p.Z)(t.attribute.height)&&t.attribute.height.percent&&t.setAttribute("height",Math.max(0,t.attribute.height.percent/100*i+(null!=(n=t.attribute.height.delta)?n:0))),t.attribute.height<0&&t.setAttribute("height",0),"group"===t.type&&w(t,t.attribute.width,t.attribute.height))})}function S(t,e){if(!t||!(0,u.Z)(t.$$typeof)&&!(0,u.Z)(t.vtype))return t;let i=t.type,{attribute:r,children:n,stateProxy:l,animation:s}=t.props,a=i({attribute:r});if(function(t,e){let i=!1;switch(t.type){case"richtext":case"rich/image":break;default:i=!0}i&&Object.keys(e).forEach(i=>{let r=h.Nv[i];r&&t.on(r,e[i])})}(a,t.props),l&&(a.stateProxy=l),a.id=r.id,a.name=r.name,(0,g.Z)(n)?n.forEach(t=>{let i=S(t,e);i&&i.type&&a.add(i)}):n&&a.add(S(n,e)),(0,g.Z)(s)&&e){let t=a.animate();t.setTimeline(e),s.forEach(e=>{t[e[0]](...e.slice(1))})}return a}function A(t,e){if(this.skipMergeUpdate)return;let i=(0,y.J$)(this);if(!i||!i.stage)return;let r=i.stage.table;this.skipAttributeUpdate=!0;let{mergeStartCol:n,mergeEndCol:l,mergeStartRow:s,mergeEndRow:a}=i;if((0,u.Z)(n)&&(0,u.Z)(l)&&(0,u.Z)(s)&&(0,u.Z)(a)&&(n!==l||s!==a)){for(let e=n;e<=l;e++)for(let n=s;n<=a;n++){if(e===i.col&&n===i.row)continue;let l=r.scenegraph.highPerformanceGetCell(e,n);if("cell"===l.role){let e=l.getChildByName(this.name,!0);if(!e||e.skipAttributeUpdate)continue;for(let i in t)t[i]!==e.attribute[i]&&"dx"!==i&&"dy"!==i&&e.setAttribute(i,t[i])}}this.skipAttributeUpdate=void 0}}},50542:function(t,e,i){i.d(e,{AU:()=>o,CK:()=>C,Ce:()=>s,L3:()=>b,Qm:()=>f,_f:()=>h,cJ:()=>A,h9:()=>v,hZ:()=>w,pU:()=>p,rd:()=>a,u0:()=>g,yi:()=>S});var r=i(64776);let n,l={col:-1,row:-1};function s(t,e,i){n=t,l={col:e,row:i}}function a(){n=void 0,l={col:-1,row:-1}}function o(){return n}function h(){return l}let d={},u={},c=[];function p(t,e,i,n,l,s=!1,a=!1){var o;_(),(0,r.Z)(d[t])||(d[t]={});let{rowStart:h}=l.getBodyVisibleRowRange(),u=l.getBodyVisibleRowRange().rowEnd;u=Math.min(l.rowCount-1-l.bottomFrozenRowCount,u);for(let p=h;p<=u;p++){let h=l.scenegraph.getCell(t,p),u=null==(o=null==h?void 0:h.getChildren())?void 0:o[0];d[t][p]||(0,r.Z)(u)&&(u.addUpdateShapeAndBoundsTag(),u.activeChartInstance||u.activate(l),d[t][p]=u.activeChartInstance);let g=setTimeout(()=>{var r,o,h,u;if(null==(r=d[t])?void 0:r[p]){let r=l.options.chartDimensionLinkage,c=!a;if(a||"object"!=typeof r||(c=(c=null==(o=r.showTooltip)||o)&&m(p,l)),a)l.stateManager.hover.cellPos.col===t&&l.stateManager.hover.cellPos.row===p||null==(u=(h=d[t][p]).showCrosshair)||u.call(h,t=>"left"===t.layoutOrient?i:e);else{let i=l.getCellRelativeRect(t,p),r=Math.max(l.frozenRowCount?l.getCellRelativeRect(t,l.frozenRowCount-1).bottom:0,l.getCellRelativeRect(t,p).top);s?(l.stateManager.hover.cellPos.col===t&&l.stateManager.hover.cellPos.row===p||d[t][p].hideTooltip(),d[t][p].setDimensionIndex(e,{tooltip:!1,showTooltipOption:{x:n.x-i.left,y:r-i.top,activeType:"dimension"}})):d[t][p].setDimensionIndex(e,{tooltip:c,showTooltipOption:{x:n.x-i.left,y:r-i.top,activeType:"dimension"}})}}},0);c.push(g),l.scenegraph.updateNextFrame()}}function g(t,e,i,n,l,s=!1,a=!1){var o;_(),(0,r.Z)(u[t])||(u[t]={});let{colStart:h}=l.getBodyVisibleColRange(),d=l.getBodyVisibleColRange().colEnd;d=Math.min(l.colCount-1-l.rightFrozenColCount,d);for(let p=h;p<=d;p++){let h=l.scenegraph.getCell(p,t),d=null==(o=null==h?void 0:h.getChildren())?void 0:o[0];u[t][p]||(0,r.Z)(d)&&(d.addUpdateShapeAndBoundsTag(),d.activeChartInstance||d.activate(l),u[t][p]=d.activeChartInstance);let g=setTimeout(()=>{var r,o,h,d;if(null==(r=u[t])?void 0:r[p]){let r=l.options.chartDimensionLinkage,c=!a;if(a||"object"!=typeof r||(c=(c=null==(o=r.showTooltip)||o)&&y(p,l)),a)l.stateManager.hover.cellPos.col===p&&l.stateManager.hover.cellPos.row===t||null==(d=(h=u[t][p]).showCrosshair)||d.call(h,t=>"left"===t.layoutOrient?i:e);else{let i=l.getCellRelativeRect(p,t),r=Math.max(l.frozenColCount?l.getCellRelativeRect(l.frozenColCount-1,t).right:0,l.getCellRelativeRect(p,t).left);s?(l.stateManager.hover.cellPos.col===p&&l.stateManager.hover.cellPos.row===t||u[t][p].hideTooltip(),u[t][p].setDimensionIndex(e,{tooltip:!1,showTooltipOption:{x:r-i.left,y:n.y-i.top,activeType:"dimension"}})):u[t][p].setDimensionIndex(e,{tooltip:c,showTooltipOption:{x:r-i.left,y:n.y-i.top,activeType:"dimension"}})}}},0);c.push(g),l.scenegraph.updateNextFrame()}}function f(t,e,i=!1){var n;_();let{rowStart:l}=e.getBodyVisibleRowRange(),s=e.getBodyVisibleRowRange().rowEnd;s=Math.min(e.rowCount-1-e.bottomFrozenRowCount,s);let{colStart:a}=e.getBodyVisibleColRange(),o=e.getBodyVisibleColRange().colEnd;o=Math.min(e.colCount-1-e.rightFrozenColCount,o);for(let h=a;h<=o;h++){(0,r.Z)(d[h])||(d[h]={});for(let a=l;a<=s;a++){let l=e.scenegraph.getCell(h,a),s=null==(n=null==l?void 0:l.getChildren())?void 0:n[0];d[h][a]||(0,r.Z)(s)&&(s.addUpdateShapeAndBoundsTag(),s.activeChartInstance?d[h][a]=s.activeChartInstance:"pie"===s.attribute.spec.type&&(s.activate(e),d[h][a]=s.activeChartInstance));let o=setTimeout(()=>{var r,n;if(null==(r=d[h])?void 0:r[a]){let r=e.options.chartDimensionLinkage,l=!0;"object"==typeof r&&(i?(d[h][a].setHovered(),d[h][a].hideTooltip()):(l=(l=(l=null==(n=r.showTooltip)||n)&&m(a,e))&&y(h,e),d[h][a].setHovered(t),l&&d[h][a].showTooltip(t,{activeType:"mark"})))}},0);c.push(o),e.scenegraph.updateNextFrame()}}}function m(t,e){var i,r;let n=!0,{rowStart:l}=e.getBodyVisibleRowRange(),s=e.getBodyVisibleRowRange().rowEnd;s=Math.min(e.rowCount-1-e.bottomFrozenRowCount,s);let a=e.options.chartDimensionLinkage;if(t===s&&n){let t=null!=(i=a.heightLimitToShowTooltipForEdgeRow)?i:0,{rowEnd:r}=e.getBodyVisibleRowRange(0,-t);if(r===s)n=!0;else{let{rowEnd:t}=e.getBodyVisibleRowRange(0,5);n=t!==s}}else if(t===l&&n){let t=null!=(r=a.heightLimitToShowTooltipForEdgeRow)?r:0,{rowStart:i}=e.getBodyVisibleRowRange(t,0);if(i===l)n=!0;else{let{rowStart:t}=e.getBodyVisibleRowRange(0,-5);n=t!==l}}return n}function y(t,e){let i=!0,{colStart:r}=e.getBodyVisibleColRange(),n=e.getBodyVisibleColRange().colEnd;n=Math.min(e.colCount-1-e.rightFrozenColCount,n);let l=e.options.chartDimensionLinkage;if(t===n&&i){let t=l.widthLimitToShowTooltipForEdgeColumn,{colEnd:r}=e.getBodyVisibleColRange(0,-t);if(r===n)i=!0;else{let{colEnd:t}=e.getBodyVisibleColRange(0,5);i=t!==n}}else if(t===r&&i){let t=l.widthLimitToShowTooltipForEdgeColumn,{colStart:n}=e.getBodyVisibleColRange(t,0);if(n===r)i=!0;else{let{colStart:t}=e.getBodyVisibleColRange(0,-5);i=t!==r}}return i}function v(t,e,i,n=!1){var l;if((0,r.Z)(d[t])){for(let s in d[t]){if((0,r.Z)(e)&&Number(s)===e)continue;let a=i.scenegraph.getCell(t,Number(s)),o=null==(l=null==a?void 0:a.getChildren())?void 0:l[0];(0,r.Z)(o)&&(o.addUpdateShapeAndBoundsTag(),o.deactivate(i,{forceRelease:n,releaseChartInstance:!0,releaseColumnChartInstance:!1,releaseRowChartInstance:!1}),d[t][s]=null)}delete d[t]}}function b(t,e,i,n=!1){var l;if((0,r.Z)(u[t]))for(let s in u[t]){if((0,r.Z)(e)&&Number(s)===e)continue;let a=i.scenegraph.getCell(Number(s),t),o=null==(l=null==a?void 0:a.getChildren())?void 0:l[0];(0,r.Z)(o)&&(o.addUpdateShapeAndBoundsTag(),o.deactivate(i,{forceRelease:n,releaseChartInstance:!0,releaseColumnChartInstance:!1,releaseRowChartInstance:!1}),u[t][s]=null)}delete u[t]}function _(){for(let t of c)clearTimeout(t);c.length=0}function C(t,e=!1){for(let i in _(),d)v(Number(i),void 0,t,e);for(let i in u)b(Number(i),void 0,t,e)}let x=!1;function w(){return x}function S(){for(let t in x=!0,_(),d)for(let e in d[t])d[t][e].disableTooltip(!0),d[t][e].hideTooltip();for(let t in u)for(let e in u[t])u[t][e].disableTooltip(!0),u[t][e].hideTooltip()}function A(){for(let t in x=!1,d)for(let e in d[t])d[t][e].disableTooltip(!1);for(let t in u)for(let e in u[t])u[t][e].disableTooltip(!1)}},98075:function(t,e,i){i.d(e,{e:()=>u,k:()=>c});var r=i(55105),n=i(22288),l=i(20408),s=i(63401),a=i(85109),o=i(50542),h=i(73508),d=i(6958);let u=(0,r.Gg)();class c extends n.U{constructor(t,e){if(super(e),this.type="chart",this.activeChartInstanceLastViewBox=null,this.activeChartInstanceHoverOnMark=null,this.justShowMarkTooltip=void 0,this.justShowMarkTooltipTimer=Date.now(),this.delayRunDimensionHoverTimer=void 0,this.numberType=u,this.isShareChartSpec=t,e.chartInstance)this.chartInstance=e.chartInstance;else{let t=this.chartInstance=new e.ClassType(e.spec,(0,l.Z)({},this.attribute.tableChartOption,{renderCanvas:e.canvas,mode:"node"===this.attribute.mode?"node":"desktop-browser",modeParams:this.attribute.modeParams,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:e.dpr,interactive:!1,animation:!1,autoFit:!1}));t.renderSync(),t.getStage().enableDirtyBounds(),e.chartInstance=this.chartInstance=t}}activate(t){var e,i,r,n,u,p,g,f;let m;if(this.activeChartInstance)return;let{col:y,row:v}=this.parent,b=(0,a.J)(this.parent,t),{x1:_,y1:C,x2:x,y2:w}=this.getViewBox(),S=(function(t,e,i){var r,n,l,a,o,h,d,u;let{layoutMap:c}=i.internalProps,p=new s.YZ,g=i.scenegraph.tableGroup.globalAABBBounds;return p.x1=g.x1,p.x2=g.x2,p.y1=g.y1,p.y2=g.y2,c.isLeftBottomCorner(t,e)||c.isRightTopCorner(t,e)||c.isLeftTopCorner(t,e)||c.isRightBottomCorner(t,e)||(c.isFrozenColumn(t,e)?(p.y1=g.y1+i.getFrozenRowsHeight(),p.y2=g.y2-i.getBottomFrozenRowsHeight()):c.isFrozenRow(t,e)?(p.x1=g.x1+i.getFrozenColsWidth(),p.x2=g.x2-i.getRightFrozenColsWidth()):c.isRightFrozenColumn(t,e)?(p.y1=g.y1+i.getFrozenRowsHeight(),p.y2=g.y2-i.getBottomFrozenRowsHeight()):c.isBottomFrozenRow(t,e)?(p.x1=g.x1+i.getFrozenColsWidth(),p.x2=g.x2-i.getRightFrozenColsWidth()):c.isFrozenColumn(t,e)||c.isRightFrozenColumn(t,e)||(p.x1=g.x1+i.getFrozenColsWidth(),p.x2=g.x2-i.getRightFrozenColsWidth(),p.y1=g.y1+i.getFrozenRowsHeight(),p.y2=g.y2-i.getBottomFrozenRowsHeight())),p.x1=p.x1+(null!=(n=null==(r=i.options.viewBox)?void 0:r.x1)?n:0),p.x2=p.x2+(null!=(a=null==(l=i.options.viewBox)?void 0:l.x1)?a:0),p.y1=p.y1+(null!=(h=null==(o=i.options.viewBox)?void 0:o.y1)?h:0),p.y2=p.y2+(null!=(u=null==(d=i.options.viewBox)?void 0:d.y1)?u:0),p})(y,v,t).intersect({x1:_-t.scrollLeft,x2:x-t.scrollLeft,y1:C-t.scrollTop,y2:w-t.scrollTop});this.attribute.ClassType.globalConfig.uniqueTooltip=!1,this.activeChartInstance=new this.attribute.ClassType(this.attribute.spec,(0,l.Z)({},this.attribute.tableChartOption,{renderCanvas:this.attribute.canvas,mode:"desktop-browser",canvasControled:!1,viewBox:{x1:0,x2:x-_,y1:0,y2:w-C},dpr:t.internalProps.pixelRatio,animation:!1,interactive:!0,autoFit:!1,beforeRender:e=>{let i=this.stage,r=e.window.getContext(),n=i.window.getViewBoxTransform(),l=i.window.getViewBox();r.inuse=!0,r.clearMatrix(),r.setTransform(n.a,n.b,n.c,n.d,n.e,n.f,!0),r.translate(l.x1,l.y1),r.setTransformForCurrent(!0),r.beginPath(),r.rect(S.x1,S.y1,S.x2-S.x1,S.y2-S.y1),r.clip(),r.clearMatrix(),t.options.canvas&&!e.needRender&&(e.pauseRender(),t.scenegraph.stage.dirtyBounds.union(this.globalAABBBounds),t.scenegraph.updateNextFrame())},afterRender(t){t.window.getContext().inuse=!1,t.needRender=!1,A.resumeRender()},renderHooks:{afterClearRect(t){let{context:e,layer:i,viewBox:r}=t;i.main&&t.clear&&b&&(e.beginPath(),e.fillStyle=b,e.rect(r.x1,r.y1,r.x2-r.x1,r.y2-r.y1),e.fill())}},componentShowContent:(null==(e=t.options.chartDimensionLinkage)?void 0:e.showTooltip)&&"scatter"!==this.attribute.spec.type?{tooltip:{dimension:!1,mark:!0},crosshair:!1}:void 0}));let A=this.activeChartInstance.getStage(),M=this.globalTransMatrix.clone(),T=this.stage.window.getViewBoxTransform();M.multiply(T.a,T.b,T.c,T.d,T.e,T.f),A.window.setViewBoxTransform&&A.window.setViewBoxTransform(M.a,M.b,M.c,M.d,M.e,M.f),this.activeChartInstance.renderSync(),null==(r=null==(i=t.internalProps.layoutMap)?void 0:i.updateDataStateToActiveChartInstance)||r.call(i,this.activeChartInstance),this.activeChartInstance.on("click",e=>{var i;!1===(null==(i=this.attribute.spec.select)?void 0:i.enable)?t.scenegraph.updateChartState(null,void 0):c.temp&&t.scenegraph.updateChartState(null==e?void 0:e.datum,"click")}),(null==(n=t.options.chartDimensionLinkage)?void 0:n.listenBrushChange)&&(m=(0,d.j0)(t.scenegraph.updateChartState.bind(t.scenegraph),null!=(p=null==(u=t.options.chartDimensionLinkage)?void 0:u.brushChangeDelay)?p:100),this.activeChartInstance.on("brushChange",t=>{var e;m.throttled(null==(e=null==t?void 0:t.value)?void 0:e.inBrushData,"brush")})),this.activeChartInstance.on("brushStart",t=>{let e=(0,o.AU)();e!==this.activeChartInstance&&(e&&e.getChart().getComponentsByKey("brush")[0].clearBrushStateAndMask(),(0,o.Ce)(this.activeChartInstance,y,v))}),this.activeChartInstance.on("brushEnd",e=>{var i;null==m||m.cancel(),t.scenegraph.updateChartState(null==(i=null==e?void 0:e.value)?void 0:i.inBrushData,"brush"),c.temp=0,setTimeout(()=>{c.temp=1},0)}),(null==(g=t.options.chartDimensionLinkage)?void 0:g.showTooltip)&&("pie"===this.attribute.spec.type&&(this.activeChartInstance.on("pointerover",{markName:"pie"},e=>{var i;let r=this.attribute.spec.categoryField,n={[r]:null==(i=null==e?void 0:e.datum)?void 0:i[r]};(0,o.Qm)(n,t,!1)}),this.activeChartInstance.on("pointerout",{markName:"pie"},e=>{var i;let r=this.attribute.spec.categoryField,n={[r]:null==(i=null==e?void 0:e.datum)?void 0:i[r]};(0,o.Qm)(n,t,!0)})),this.activeChartInstance.on("dimensionHover",e=>{var i,r;if((0,o.hZ)())return;this.activeChartInstance.disableTooltip(!1);let n=null==e?void 0:e.dimensionInfo[0],l=null==(i=null==e?void 0:e.event)?void 0:i.canvas,s=null==(r=null==e?void 0:e.event)?void 0:r.viewport;if(s){let i=n.data[0].series.positionToDataX(s.x),r=n.data[0].series.positionToDataY(s.y);if("scatter"===this.attribute.spec.type)(0,o.pU)(y,i,void 0,l,t,!1,!0),(0,o.u0)(v,void 0,r,l,t,!1,!0),(0,h.hZ)(t.rowHeaderLevelCount-1,v,t.internalProps.layoutMap).labelHoverOnAxis&&t.scenegraph.getCell(t.rowHeaderLevelCount-1,v).firstChild.showLabelHoverOnAxis(l.y-t.getCellRelativeRect(y,v).top,r),(0,h.hZ)(y,t.rowCount-t.bottomFrozenRowCount,t.internalProps.layoutMap).labelHoverOnAxis&&t.scenegraph.getCell(y,t.rowCount-t.bottomFrozenRowCount).firstChild.showLabelHoverOnAxis(l.x-t.getCellRelativeRect(y,v).left,i);else{let i=!0,s=this.activeChartInstanceHoverOnMark,a=this.justShowMarkTooltip;e.mark&&e.datum&&!Array.isArray(e.datum)?(this.activeChartInstanceHoverOnMark=e.mark,i=!0):(this.activeChartInstanceHoverOnMark=null,i=!1),this.justShowMarkTooltip=i;let d=!1;if(!1!==a&&!1===i?(this.justShowMarkTooltipTimer=Date.now(),d=!0):!1===a&&!1===i?d=Date.now()-this.justShowMarkTooltipTimer<100:(!1===a&&!0===i||!0===a&&!0===i)&&(d=!1,this.clearDelayRunDimensionHoverTimer()),"enter"===e.action||"move"===e.action||s!==this.activeChartInstanceHoverOnMark){let e=n.value,s=t.options.indicatorsAsCol;if(d?(this.clearDelayRunDimensionHoverTimer(),this.delayRunDimensionHoverTimer=setTimeout(()=>{(0,o.hZ)()||(s?(0,o.u0)(v,e,null,l,t,i,!1):(0,o.pU)(y,e,null,l,t,i,!1))},100)):s?(0,o.u0)(v,e,null,l,t,i,!1):(0,o.pU)(y,e,null,l,t,i,!1),s){let i=n.data[0].series,l="histogram"===this.attribute.spec.type||"line"===i.type||"area"===i.type?0:i.getYAxisHelper().getBandwidth(0),s=i.valueToPositionY(e),a=(0,h.hZ)(t.rowHeaderLevelCount-1,v,t.internalProps.layoutMap),o=r;if("histogram"===this.attribute.spec.type){let{series:t,datum:e}=n.data[0];if(e.length>0){let i=e[0][t.fieldY[0]],r=e[0][t.fieldY2];o=i+" ~ "+r,s=(t.valueToPositionY(i)+t.valueToPositionY(r))/2}}a.labelHoverOnAxis&&t.scenegraph.getCell(t.rowHeaderLevelCount-1,v).firstChild.showLabelHoverOnAxis(s+("line"===i.type||"area"===i.type?0:l/2),o)}else{let i=n.data[0].series,r="histogram"===this.attribute.spec.type||"line"===i.type||"area"===i.type?0:i.getXAxisHelper().getBandwidth(0),l=i.valueToPositionX(e),s=(0,h.hZ)(y,t.rowCount-t.bottomFrozenRowCount,t.internalProps.layoutMap),a=e;if("histogram"===this.attribute.spec.type){let{series:t,datum:e}=n.data[0];if(e.length>0){let i=e[0][t.fieldX[0]],r=e[0][t.fieldX2];a=i+" ~ "+r,l=(t.valueToPositionX(i)+t.valueToPositionX(r))/2}}s.labelHoverOnAxis&&t.scenegraph.getCell(y,t.rowCount-t.bottomFrozenRowCount).firstChild.showLabelHoverOnAxis(l+r/2,a)}}}}})),null==(f=t._bindChartEvent)||f.call(t,this.activeChartInstance),(0,o.hZ)()&&this.activeChartInstance.disableTooltip(!0)}clearDelayRunDimensionHoverTimer(){clearTimeout(this.delayRunDimensionHoverTimer),this.delayRunDimensionHoverTimer=void 0}deactivate(t,{forceRelease:e=!1,releaseChartInstance:i=!0,releaseColumnChartInstance:r=!0,releaseRowChartInstance:n=!0,releaseAllChartInstance:l=!1}={}){var s,a,h,d,u,c,p,g,f,m;if(this.activeChartInstanceHoverOnMark=null,this.justShowMarkTooltip=void 0,this.justShowMarkTooltipTimer=Date.now(),this.clearDelayRunDimensionHoverTimer(),i){!e&&(0,o.AU)()&&(0,o.AU)()===this.activeChartInstance||(null==(s=this.activeChartInstance)||s.updateViewBox({x1:-1e3,x2:-800,y1:-1e3,y2:-800},!1,!1),null==(a=this.activeChartInstance)||a.release(),this.activeChartInstance=null);let{col:i,row:r}=this.parent;t.internalProps.layoutMap.isAxisCell(t.rowHeaderLevelCount-1,r)&&(null==(d=null==(h=t.scenegraph.getCell(t.rowHeaderLevelCount-1,r).firstChild)?void 0:h.hideLabelHoverOnAxis)||d.call(h)),t.internalProps.layoutMap.isAxisCell(i,t.rowCount-t.bottomFrozenRowCount)&&(null==(c=null==(u=t.scenegraph.getCell(i,t.rowCount-t.bottomFrozenRowCount).firstChild)?void 0:u.hideLabelHoverOnAxis)||c.call(u))}else{let{col:e,row:i}=this.parent;r&&t.internalProps.layoutMap.isAxisCell(e,t.rowCount-t.bottomFrozenRowCount)&&(null==(g=null==(p=t.scenegraph.getCell(e,t.rowCount-t.bottomFrozenRowCount).firstChild)?void 0:p.hideLabelHoverOnAxis)||g.call(p)),n&&t.internalProps.layoutMap.isAxisCell(t.rowHeaderLevelCount-1,i)&&(null==(m=null==(f=t.scenegraph.getCell(t.rowHeaderLevelCount-1,i).firstChild)?void 0:f.hideLabelHoverOnAxis)||m.call(f))}l?(0,o.CK)(t,e):(r&&(0,o.h9)(this.parent.col,"scatter"===this.attribute.spec.type?this.parent.row:void 0,t,e),n&&(0,o.L3)(this.parent.row,"scatter"===this.attribute.spec.type?this.parent.col:void 0,t,e))}updateData(t){this.attribute.data=t}getViewBox(){var t,e,i,r,n,l,s,a;let o=this.parent,h=this.attribute.cellPadding,d=this.stage.table,{x1:u,y1:c,x2:p,y2:g}=o.globalAABBBounds,f={x1:Math.ceil(u+h[3]+d.scrollLeft+(null!=(e=null==(t=d.options.viewBox)?void 0:t.x1)?e:0)),x2:Math.ceil(u+o.attribute.width-h[1]+d.scrollLeft+(null!=(r=null==(i=d.options.viewBox)?void 0:i.x1)?r:0)),y1:Math.ceil(c+h[0]+d.scrollTop+(null!=(l=null==(n=d.options.viewBox)?void 0:n.y1)?l:0)),y2:Math.ceil(c+o.attribute.height-h[2]+d.scrollTop+(null!=(a=null==(s=d.options.viewBox)?void 0:s.y1)?a:0))};return this.activeChartInstance?this.activeChartInstanceLastViewBox=f:this.activeChartInstanceLastViewBox=null,f}}c.temp=1},8347:function(t,e,i){i.d(e,{A8:()=>o,H6:()=>g,LO:()=>h,Ry:()=>p,Up:()=>y,a5:()=>f,eO:()=>function t(e){c=!0,h.length>0?d=r.rF.getRequestAnimationFrame()(()=>{let i=h.splice(0,u);o.splice(0,u),i.forEach(t=>{m(t),t.addUpdateBoundTag()}),e.render(),t(e)}):c=!1},pF:()=>m});var r=i(73036),n=i(34505),l=i(28364),s=i(64776),a=i(63401);let o=[],h=[],d,u=5,c=!1;function p(t){(0,s.Z)(t)&&(u=t)}function g(){o=[],h=[],c=!1,r.rF.getCancelAnimationFrame()(d)}function f(){return c}function m(t){var e,i,r,n,l,s,a;let{axes:o,dataId:h,data:d,spec:u,ClassType:c,canvas:p,mode:g,modeParams:f,dpr:m}=t.attribute,{chartInstance:v}=t;v||((v=new c(u,{renderCanvas:p,mode:"node"===g?"node":"desktop-browser",modeParams:f,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:m,interactive:!1,animation:!1,autoFit:!1})).renderSync(),t.chartInstance=v);let b=t.getViewBox();b.x2<=b.x1&&(b.x2=b.x1+1),b.y2<=b.y1&&(b.y2=b.y1+1),v.updateViewBox({x1:0,x2:b.x2-b.x1,y1:0,y2:b.y2-b.y1},!1,!1);let _=v.getStage(),C=t.globalTransMatrix,x=t.stage.window.getViewBoxTransform().clone();x.multiply(C.a,C.b,C.c,C.d,C.e,C.f),_.window.setViewBoxTransform&&_.window.setViewBoxTransform(x.a,x.b,x.c,x.d,x.e,x.f);let{table:w}=t.getRootNode(),S=!1;if(w.options.specFormat){let i=w.options.specFormat(t.attribute.spec,v,t);if(i.needFormatSpec&&i.spec){let t=i.spec;v.updateSpecSync(t,!1,{reuse:!1,morph:!1}),S=null==(e=i.updateSpec)||e}}if(!S)if(null==o||o.forEach((t,e)=>{var i,r,n,l,s;"band"===t.type?v.updateModelSpec({type:"axes",index:e},{domain:t.domain.slice(0)},!0):v.updateModelSpecSync({type:"axes",index:e},{min:null!=(r=null==(i=t.range)?void 0:i.min)?r:0,max:null!=(l=null==(n=t.range)?void 0:n.max)?l:0,tick:{tickMode:null==(s=t.tick)?void 0:s.tickMode}},!0)}),null==(r=null==(i=w.internalProps.layoutMap)?void 0:i.updateDataStateToActiveChartInstance)||r.call(i,v),"string"==typeof h||"number"==typeof h)v.getChart().setLayoutTag(!0),v.updateDataSync(h,null!=d?d:[]);else{let t=[];for(let e in h){let i=h[e],r=u.series.find(t=>{var i;return(null==(i=null==t?void 0:t.data)?void 0:i.id)===e});t.push({id:e,values:i?null!=(n=null==d?void 0:d.filter(t=>t.hasOwnProperty(i)))?n:[]:null!=d?d:[],fields:null==(l=null==r?void 0:r.data)?void 0:l.fields}),v.updateFullDataSync||v.updateDataSync(e,i?null!=(s=null==d?void 0:d.filter(t=>t.hasOwnProperty(i)))?s:[]:null!=d?d:[])}v.getChart().setLayoutTag(!0),null==(a=v.updateFullDataSync)||a.call(v,t)}w.fireListeners("before_cache_chart_image",{chartInstance:v}),y(v.getStage(),t)}function y(t,e){var i;let{viewWidth:r,viewHeight:n}=t;if(r<2e3&&n<2e3)return e.cacheCanvas=v(t),void(e.isShareChartSpec||(null==(i=e.chartInstance)||i.release(),e.chartInstance=null,e.setAttribute("chartInstance",null)));let l=Math.ceil(n/2e3),s=Math.ceil(r/2e3),o=[];for(let e=0;e<l;e++)for(let i=0;i<s;i++){let l=2e3*i,s=2e3*e,h=l+2e3>r?r:l+2e3,d=s+2e3>n?n:s+2e3,u=h-l,c=d-s,p=new a.YZ;p.setValue(l,s,h,d);let g=v(t,!1,p);o.push({canvas:g,x:l,y:s,width:u,height:c})}e.cacheCanvas=o}function v(t,e=!0,i){if("released"===t.releaseStatus)return null;let r=(function(t,e=!0,i){let r=t.window.getViewBoxTransform(),s=n.n.get(l.Oo),a=i?-i.x1:0,o=i?-i.y1:0,h=i?i.x2:t.viewWidth,d=i?i.y2:t.viewHeight,u=i?i.width():t.viewWidth,c=i?i.height():t.viewHeight;return s.create({viewBox:{x1:a,y1:o,x2:h,y2:d},width:u*r.a,height:c*r.d,dpr:t.window.dpr,canvasControled:!0,offscreen:!0,title:""}),s.setViewBoxTransform(r.a,r.b,r.c,r.d,0,0),t.renderTo(s),s})(t,e,i).getNativeHandler();return r.nativeCanvas?r.nativeCanvas:null}},20219:function(t,e,i){i.d(e,{Z:()=>n});var r=i(8849);class n extends r.ZA{clear(){this.removeAllChild()}getChildByName(t,e){let i=null;return this.forEachChildren(e=>e.name===t&&(i=e,!0)),e&&this.forEachChildren(e=>{if(e.getChildByName){let r=e.getChildByName(t,!0);if(r)return i=r,!0}return!1}),i}get width(){var t;let e=this.AABBBounds.width();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,null!=(t=this.attribute.width)?t:0)}get height(){var t;let e=this.AABBBounds.height();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,null!=(t=this.attribute.height)?t:0)}setDeltaWidth(t){var e;0!==t&&(this.setAttribute("width",(null!=(e=this.attribute.width)?e:0)+t),this.border&&(this.border.setAttribute("width",this.border.attribute.width+t),"group"===this.border.type&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.width+t)))}setDeltaHeight(t){var e;0!==t&&(this.setAttribute("height",(null!=(e=this.attribute.height)?e:0)+t),this.border&&(this.border.setAttribute("height",this.border.attribute.height+t),"group"===this.border.type&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.height+t)))}setDeltaX(t){0!==t&&this.setAttribute("x",this.attribute.x+t)}setDeltaY(t){0!==t&&this.setAttribute("y",this.attribute.y+t)}forEachChildrenSkipChild(t,e="border-rect",i=!1){if(i){let i=this._lastChild,r=0;for(;i;){if(i.name!==e&&t(i,r++))return;i=i._prev}}else{let i=this._firstChild,r=0;for(;i;){if(i.name!==e&&t(i,r++))return;i=i._next}}}getColGroup(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<this.childrenCount;i++){if(e.col===t)return e;e=e._next}return null}getRowGroup(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<this.childrenCount;i++){if(e.row===t)return e;e=e._next}return null}addCellGroup(t){if(0===this.childrenCount||this.lastChild.row===t.row-1)this.addChild(t);else{let e=this._firstChild;for(let i=0;i<this.childrenCount;i++){if(e.row===t.row-1)return void this.insertAfter(t,e);e=e._next}this.addChild(t)}}getChildAt(t){let e=super.getChildAt(t);return e&&"border-rect"===e.name?e._next:e}tryUpdateAABBBounds(){if("cell"===this.role){var t,e;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;let i=this.shouldSelfChangeUpdateAABBBounds(),r=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),t=this,e=i,t.stage&&t.stage.dirtyBounds&&t.stage.renderCount&&(t.isContainer&&!e||t.stage.dirty(t.globalAABBBounds)),r}return super.tryUpdateAABBBounds()}doUpdateAABBBounds(){if("cell"===this.role){let{x:t,y:e,width:i,height:r}=this.attribute;return this._AABBBounds.setValue(t,e,t+i,e+r),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds}return"body"===this.role||"row-header"===this.role||"col-header"===this.role||"right-frozen"===this.role||"bottom-frozen"===this.role||"corner-header"===this.role||"corner-right-top-header"===this.role||"corner-right-bottom-header"===this.role||"corner-left-bottom-header"===this.role?(this._AABBBounds.setValue(-1/0,-1/0,1/0,1/0),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds):super.doUpdateAABBBounds()}updateColumnRowNumber(t){this.rowNumber?this.rowNumber=Math.max(this.rowNumber,t):this.rowNumber=t}updateColumnHeight(t){this.colHeight?this.colHeight+=t:this.colHeight=t}}},68173:function(t,e,i){i.d(e,{J:()=>o,V:()=>h});var r=i(50074),n=i(84453),l=i(63654),s=i(29216),a=i(9607);class o extends r.E{constructor(t){super(t),this.failCallback=()=>{let{svg:t,src:e}=a.U2().damage_pic||{},i=t||e;i&&(super.image=i)},"mouseenter_cell"!==this.attribute.visibleTime&&"click_cell"!==this.attribute.visibleTime||(this.attribute.opacity=0),this.attribute.hoverImage&&(this.attribute.originImage=this.attribute.image),this.attribute.isGif&&this.attribute.gif&&this.loadGif()}loadGif(){this.playing=!1,n.h.GetFile(this.attribute.gif+"?role=gif"+`&radom=${Math.random()}`,"arrayBuffer").then(t=>{let e=(0,s.parseGIF)(t),i=(0,s.decompressFrames)(e,!0);this.renderGIF(i),this.resources.set(this.attribute.image,{state:"success",data:this.gifCanvas})}).catch(t=>{})}get backgroundWidth(){var t,e;return null!=(e=null!=(t=this.attribute.backgroundWidth)?t:this.attribute.width)?e:0}get backgroundHeight(){var t,e;return null!=(e=null!=(t=this.attribute.backgroundHeight)?t:this.attribute.height)?e:0}renderGIF(t){this.loadedFrames=t,this.frameIndex=0,this.tempCanvas||(this.tempCanvas=document.createElement("canvas"),this.tempCtx=this.tempCanvas.getContext("2d")),this.gifCanvas||(this.gifCanvas=document.createElement("canvas"),this.gifCtx=this.gifCanvas.getContext("2d")),this.gifCanvas.width=t[0].dims.width,this.gifCanvas.height=t[0].dims.height,this.playing=!0,this.lastTime=(new Date).getTime(),this.animate().to({},1e3,"linear").loop(1/0)}renderFrame(t,e,i){let r=this.loadedFrames[this.frameIndex||0];2===r.disposalType&&this.gifCtx.clearRect(0,0,this.gifCanvas.width,this.gifCanvas.height),this.drawPatch(r),this.manipulate(t,e,i);let n=(new Date).getTime()-this.lastTime;r.delay<n&&(this.frameIndex++,this.lastTime=(new Date).getTime()),this.frameIndex>=this.loadedFrames.length&&(this.frameIndex=0)}drawPatch(t){let e=t.dims;this.frameImageData&&e.width===this.frameImageData.width&&e.height===this.frameImageData.height||(this.tempCanvas.width=e.width,this.tempCanvas.height=e.height,this.frameImageData=this.tempCtx.createImageData(e.width,e.height)),this.frameImageData.data.set(t.patch),this.tempCtx.putImageData(this.frameImageData,0,0),this.gifCtx.drawImage(this.tempCanvas,e.left,e.top)}manipulate(t,e,i){t.drawImage(this.gifCanvas,0,0,this.gifCanvas.width,this.gifCanvas.height,e,i,this.attribute.width,this.attribute.height)}setAttribute(t,e,i,r){super.setAttribute(t,e,i,r),"gif"===t&&this.loadGif()}setAttributes(t,e,i){super.setAttributes(t,e,i),t.gif&&this.loadGif()}}class h extends l.x{constructor(t){var e,i,r,n,l;t.fill=null!=(e=t.fill)?e:"#00F",t.fontSize=null!=(i=t.fontSize)?i:12,t.underline=null!=(r=t.underline)?r:1,t.textBaseline=null!=(n=t.textBaseline)?n:"top",t.cursor=null!=(l=t.cursor)?l:"pointer",super(t)}}},22488:function(t,e,i){i.d(e,{pZ:()=>S,l7:()=>M,kE:()=>b,NQ:()=>A,wW:()=>C});var r=i(77874),n=i(73501),l=i(32802),s=i(53172),a=i(23975),o=i(37280),h=i(31877),d=i(71994),u=i(74577),c=i(95954),p=i(4654),g=i(95723),f=i(42515),m=i(64776);function y(t,e){var i,r;if(this.shadowRoot&&this.shadowRoot.childrenCount&&((0,m.Z)(t.width)||(0,m.Z)(t.height))){let e=this.shadowRoot.findChildrenByName("shadow-rect")[0];e&&e.setAttributes({width:null!=(i=t.width)?i:e.attribute.width,height:null!=(r=t.height)?r:e.attribute.height})}}var v=i(56982);function b(t,e,i,n,s,o,d,u,c,p,g,f,m,v,b,C,x,w){var S,A;let M,T=!1;if((0,a.tI)(e)){if("cell"!==n.scenegraph.highPerformanceGetCell(s,o).role)return M;e=n.getCellValue(s,o),T=!0}if("checkbox"===t&&i.tree)M=h.F.getFunction("createCheckboxCellGroup")(null,p,0,g,s,o,d,u,c,f,m,v,b,n,C,i,x,T,!0);else if("text"===t||"link"===t||w){if("link"===t){let h=e,d=n.getCellOriginValue(s,o),u=n._getCellStyle(s,o);"link"===t&&("templateLink"in i&&i.templateLink||!("linkDetect"in i)||!(0,a.vi)(i.linkDetect,{col:s,row:o,table:n,value:h,dataValue:d,cellHeaderPaths:void 0})||r.tP.test(h))&&(C?(C.text.fill=(0,l.WJ)("linkColor",u,s,o,n),C.group.cursor="pointer"):C={text:{fill:(0,l.WJ)("linkColor",u,s,o,n)},group:{cursor:"pointer"}})}let{customElementsGroup:y,renderDefault:A}=_(n,i,s,o,u,c,f,x,w);M=h.F.getFunction("createTextCellGroup")(n,e,p,0,g,s,o,d,u,c,f,m,v,b,y,A,C,x,T);let k=n.internalProps.layoutMap.getAxisConfigInPivotChart(s,o);if(k){let t=new(h.F.getComponent("axis"))(k,M.attribute.width,M.attribute.height,null!=(S=k.__vtableBodyChartCellPadding)?S:f,n);M.clear(),M.appendChild(t.component),t.overlap()}else n.internalProps.layoutMap.isEmpty(s,o)?(M.setAttributes({fill:!1,stroke:!1}),M.clear()):n.internalProps.layoutMap.isAxisCell(s,o)&&M.clear()}else if("image"===t)M=h.F.getFunction("createImageCellGroup")(p,0,g,s,o,u,c,i.keepAspectRatio,i.imageAutoSizing,f,m,v,b,n,C,x,T);else if("video"===t)M=h.F.getFunction("createVideoCellGroup")(p,0,g,s,o,u,c,i.keepAspectRatio,i.imageAutoSizing,f,m,v,b,n,C,x,T);else if("chart"===t){let t=n.internalProps.layoutMap.getChartInstance(s,o);M=h.F.getFunction("createChartCellGroup")(null,p,0,g,s,o,u,c,f,e,i.chartModule,n.internalProps.layoutMap.getChartSpec(s,o),t,null!=(A=n.internalProps.layoutMap.getChartDataId(s,o))?A:"data",n,C,n.internalProps.layoutMap.isShareChartSpec(s,o),T,n.internalProps.layoutMap.isNoChartDataRenderNothing(s,o))}else if("progressbar"===t){let{customElementsGroup:t,renderDefault:r}=_(n,i,s,o,u,c,f,x,w),l=n._getCellStyle(s,o),a=n.getCellOriginValue(s,o);M=h.F.getFunction("createTextCellGroup")(n,e,p,0,g,s,o,d,u,c,f,m,v,b,t,r,C,x,T);let y=h.F.getFunction("createProgressBarCell")(i,l,d,e,a,s,o,f,n,x);M.firstChild?M.insertBefore(y,M.firstChild):M.appendChild(y)}else if("sparkline"===t)M=h.F.getFunction("createSparkLineCellGroup")(null,p,0,g,s,o,u,c,f,n,C,T);else if("checkbox"===t){let t="isAggregation"in n.internalProps.layoutMap&&n.internalProps.layoutMap.isAggregation(s,o),r=n.internalProps.layoutMap.isSeriesNumber(s,o);M=t&&r?h.F.getFunction("createTextCellGroup")(n,e,p,0,g,s,o,d,u,c,f,m,v,!1,void 0,!0,C,x,T):h.F.getFunction("createCheckboxCellGroup")(null,p,0,g,s,o,d,u,c,f,m,v,b,n,C,i,x,T,!1)}else"radio"===t?M=h.F.getFunction("createRadioCellGroup")(null,p,0,g,s,o,d,u,c,f,m,v,n,C,i,x):"switch"===t?M=h.F.getFunction("createSwitchCellGroup")(null,p,0,g,s,o,d,u,c,f,m,v,b,n,C,i,x,T):"button"===t&&(M=h.F.getFunction("createButtonCellGroup")(null,p,0,g,s,o,d,u,c,f,m,v,b,n,C,i,x,T));return M.onBeforeAttributeUpdate=y,M}function _(t,e,i,r,l,s,a,o,h){let d,u=!0;if(h)d=h.elementsGroup,u=h.renderDefault;else if((null==o?void 0:o.isCustom)&&!t.isCornerHeader(i,r));else{let h,c;if("body"!==t.getCellLocation(i,r)?(h=null==e?void 0:e.headerCustomRender,c=null==e?void 0:e.headerCustomLayout):(h=(null==e?void 0:e.customRender)||t.customRender,c=null==e?void 0:e.customLayout),c||h){let e=(0,n.ws)(c,h,i,r,l,s,!1,t.isAutoRowHeight(r),a,o,t);d=e.elementsGroup,u=e.renderDefault}}return{customElementsGroup:d,renderDefault:u}}function C(t,e,i,r,h,p){var g,m,y,b,_,C,M,T,k,R,P,B,I,E,L,F,O,H;let D,z,W,Z=i.scenegraph.highPerformanceGetCell(t,e,!0);if("cell"!==Z.role&&!r)return;let N=i.getCellLocation(t,e),j,G,V,U,K=i.getCellValue(t,e),X=!1;if(i.internalProps.customMergeCell){let r=i.getCustomMerge(t,e);if(r){let{range:t,text:l,style:s,customLayout:a,customRender:o}=r;j=(G=t).start.col!==G.end.col||G.start.row!==G.end.row,K=l,V=s,(a||o)&&(U=(0,n.ws)(a,o,t.start.col,t.start.row,i.getColsWidth(t.start.col,t.end.col),i.getRowsHeight(t.start.row,t.end.row),!1,i.isAutoRowHeight(e),[0,0,0,0],G,i)),X=!0}}let Y=t,$=e;G&&(Y=G.start.col,$=G.start.row);let q="body"!==N?i.getHeaderDefine(Y,$):i.getBodyColumnDefine(Y,$),J="body"!==N||(null==q?void 0:q.dragOrder)||!!(null==q?void 0:q.icon)||!!(null==q?void 0:q.tree);!G&&(i.internalProps.enableTreeNodeMerge||"body"!==N||(null==q?void 0:q.mergeCell))&&(j=(G=i.getCellRange(t,e)).start.col!==G.end.col||G.start.row!==G.end.row);let Q=!1;if(i.internalProps.enableTreeNodeMerge&&j){let r=i.getCellRawRecord(G.start.col,G.start.row),{vtableMergeName:l,vtableMerge:s}=null!=r?r:{};Q=s,s&&(J=!0,i.internalProps.groupTitleCustomLayout&&(U=(0,n.ws)(i.internalProps.groupTitleCustomLayout,void 0,G.start.col,G.start.row,i.getColsWidth(G.start.col,G.end.col),i.getRowsHeight(G.start.row,G.end.row),!1,i.isAutoRowHeight(e),[0,0,0,0],G,i)),i.internalProps.groupTitleFieldFormat?K=i.internalProps.groupTitleFieldFormat(r,t,e,i):void 0!==l&&(K=l))}let te=V||i._getCellStyle(G?G.start.col:t,G?G.start.row:e),ti=null!=(g=te.autoWrapText)?g:i.internalProps.autoWrapText,tr=(0,s.RT)(te,i,j?G.start.col:t,j?G.start.row:e,l.WJ).theme;if(tr.group.cornerRadius=(0,s.xv)(t,e,i),!r&&!j&&!((null==q?void 0:q.customLayout)||(null==q?void 0:q.customRender)||(null==q?void 0:q.headerCustomLayout)||(null==q?void 0:q.headerCustomRender))&&(p||function(t,e,i,r,n,l){var s;let o=l.getBodyColumnType(t,e),h=l.isAutoRowHeight(e),d=l.getCellValue(t,e);return!(l.isHeader(t,e)||"cell"!==i.role||"text"!==o||r||h||n||"text"!==(null==(s=i.firstChild)?void 0:s.type)||(0,a.tI)(d))}(t,e,Z,ti,J,i))){let r=i.getColWidth(t),n=i.getRowHeight(e),s=(0,v.d)(t,e,tr,i);Z.setAttributes({width:r,height:n,lineWidth:null!=(y=null==(m=null==tr?void 0:tr.group)?void 0:m.lineWidth)?y:void 0,fill:null!=(_=null==(b=null==tr?void 0:tr.group)?void 0:b.fill)?_:void 0,stroke:null!=(M=null==(C=null==tr?void 0:tr.group)?void 0:C.stroke)?M:void 0,strokeArrayWidth:null!=s?s:void 0,strokeArrayColor:null!=(k=null==(T=null==tr?void 0:tr.group)?void 0:T.strokeArrayColor)?k:void 0,cursor:null!=(P=null==(R=null==tr?void 0:tr.group)?void 0:R.cursor)?P:void 0,cornerRadius:null!=(I=null==(B=null==tr?void 0:tr.group)?void 0:B.cornerRadius)?I:0,lineDash:null!=(L=null==(E=null==tr?void 0:tr.group)?void 0:E.lineDash)?L:void 0,y:i.scenegraph.getCellGroupY(e)}),Z.mergeStartCol=void 0,Z.mergeStartRow=void 0,Z.mergeEndCol=void 0,Z.mergeEndRow=void 0,Z.forEachChildren(t=>{t.setAttributes({dx:0,dy:0})});let a=Z.getChildByName("text");if(p&&a){let r=tr.text.textAlign,n=(0,d.L)(t,e,i),l={textBaseline:"top",dx:"left"===r?n:0};a.setAttributes(tr.text?Object.assign({},tr.text,l):l)}else if(a){let s=i.getCellValue(t,e),{text:o,moreThanMaxCharacters:h}=(0,f.$)(s,i),c=(0,d.L)(t,e,i),p=te.lineClamp,g=null!=(F=(0,u.u)((0,l.WJ)("padding",te,t,e,i)))?F:[0,0,0,0],m=tr.text.textAlign,y=0;y="center"===m?g[3]+(r-(g[1]+g[3]))/2:"right"===m?g[3]+r-(g[1]+g[3]):g[3];let v={text:1!==o.length||ti?o:o[0],moreThanMaxCharacters:h,maxLineWidth:r-(g[1]+g[3]+c),textBaseline:"top",autoWrapText:ti,lineClamp:p,wordBreak:"break-word",heightLimit:n-Math.floor(g[0]+g[2]),pickable:!1,dx:"left"===m?c:0,x:y};if(a.setAttributes(tr.text?Object.assign({},tr.text,v):v),a.attribute.text){let t=tr.text.textBaseline,e=n-(g[0]+g[2]),i=0;i="middle"===t?g[0]+(e-a.AABBBounds.height())/2:"bottom"===t?g[0]+e-a.AABBBounds.height():g[0],a.setAttributes({y:i})}}return Z}if(!r&&"empty"===Z.role)return;let tn=Q||X?"text":i.isHeader(t,e)?null!=(O=i._getHeaderLayoutMap(t,e).headerType)?O:"text":null!=(H=i.getBodyColumnType(t,e))?H:"text",tl=tr._vtable.padding,ts=tr.text.textAlign,ta=tr.text.textBaseline;if(G?(z=i.getColsWidth(G.start.col,G.end.col),W=i.getRowsHeight(G.start.row,G.end.row)):(z=i.getColWidth(t),W=i.getRowHeight(e)),(0,a.tI)(K)?(Z.removeAllChild(),(0,o.K)(K,i,w.bind(null,{type:tn,value:K,define:q,table:i,col:t,row:e,cellWidth:z,cellHeight:W,oldCellGroup:Z,padding:tl,textAlign:ts,textBaseline:ta,mayHaveIcon:J,addNew:r,range:G,customResult:U,customStyle:V}))):D=x(tn,K,q,i,t,e,z,W,Z,tl,ts,ta,J,r,tr,G,U),j){let{width:t}=D.attribute,{height:e}=D.attribute;D.contentWidth=t,D.contentHeight=e,h?function(t,e,i,r,n,l,s,a){let{col:o,row:h}=a;t.start.row!==t.end.row&&a.contentHeight!==i&&(0,c.Zl)(a,i,i,s.isAutoRowHeight(h),r,n,l,s),t.start.col!==t.end.col&&a.contentWidth!==e&&(0,c.qs)(a,e,i,0,s.isAutoRowHeight(h),r,n,l,s.scenegraph),a.contentWidth=e,a.contentHeight=i;let d=s.getRowHeight(h);A(a,s.getColWidth(o),d,t,s)}(G,z,W,tl,ts,ta,i,D):S(G,z,W,tl,ts,ta,i)}return D}function x(t,e,i,r,l,s,o,h,d,u,c,g,f,m,y,v,_){var C,x;if((0,a.tI)(e)&&(e=r.getCellValue(l,s)),!m&&(d.row!==s||d.col!==l))return null;if(!m&&d.parent&&r.reactCustomLayout){let t=d.getChildByName(n.FH);if(t){let{col:e,row:i}=t;(0,p.Z)(e)&&(0,p.Z)(i)&&r.reactCustomLayout.removeCustomCell(e,i)}}let w=b(t,e,i,r,l,s,r.getColWidth(l),o,h,m?r.scenegraph.getColGroup(l):d.parent,m?0:r.scenegraph.getCellGroupY(s),u,c,g,f,y,v,_);return!m&&d.parent&&(d.parent.insertAfter(w,d),d.parent.removeChild(d),d.release(!0),(null==(C=r.scenegraph)?void 0:C.proxy.cellCache.get(l))&&(null==(x=r.scenegraph)||x.proxy.cellCache.set(l,w))),w}function w(t){let{type:e,value:i,define:r,table:n,col:a,row:o,cellWidth:h,cellHeight:d,oldCellGroup:u,padding:c,textAlign:p,textBaseline:g,mayHaveIcon:f,addNew:m,range:y,customResult:v,customStyle:b}=t,_=b||n._getCellStyle(y?y.start.col:a,y?y.start.row:o),C=(0,s.RT)(_,n,y?y.start.col:a,y?y.start.row:o,l.WJ).theme;C.group.cornerRadius=(0,s.xv)(a,o,n),x(e,i,r,n,a,o,h,d,u,c,p,g,f,m,C,y,v)}function S(t,e,i,r,n,l,s){for(let a=t.start.col;a<=t.end.col;a++)for(let o=t.start.row;o<=t.end.row;o++){let h=s.scenegraph.highPerformanceGetCell(a,o,!0);if("cell"!==h.role)continue;t.start.row!==t.end.row&&h.contentHeight!==i&&(0,c.Zl)(h,i,i,s.isAutoRowHeight(o),r,n,l,s),t.start.col!==t.end.col&&h.contentWidth!==e&&(0,c.qs)(h,e,i,0,s.isAutoRowHeight(o),r,n,l,s.scenegraph),h.contentWidth=e,h.contentHeight=i;let d=s.getRowHeight(o);A(h,s.getColWidth(a),d,t,s)}}function A(t,e,i,r,n){var l,s;let{col:a,row:o}=t,h=-n.getColsWidth(r.start.col,a-1),d=0;if(null==(l=n.options.customConfig)?void 0:l._disableColumnAndRowSizeRound)for(let t=r.start.row;t<=o-1;t++)d-=n.getRowHeight(t);else d=-n.getRowsHeight(r.start.row,o-1);t.forEachChildren(t=>{var e,i,r,n,l,s;"number"==typeof t._dx?(t.skipMergeUpdate=!0,t.setAttributes({dx:(null!=(e=t._dx)?e:0)+h})):(t._dx=null!=(i=t.attribute.dx)?i:0,t.skipMergeUpdate=!0,t.setAttributes({dx:(null!=(r=t.attribute.dx)?r:0)+h})),t.skipMergeUpdate=!1,"number"==typeof t._dy?(t.skipMergeUpdate=!0,t.setAttributes({dy:(null!=(n=t._dy)?n:0)+d})):(t._dy=null!=(l=t.attribute.dy)?l:0,t.skipMergeUpdate=!0,t.setAttributes({dy:(null!=(s=t.attribute.dy)?s:0)+d})),t.skipMergeUpdate=!1});let u=null!=(s=t.attribute.strokeArrayWidth)?s:t.attribute.lineWidth,c=(0,g.Z)(u),p=[0,0,0,0];a===r.start.col&&(p[3]=c?u[3]:u),o===r.start.row&&(p[0]=c?u[0]:u),a===r.end.col&&(p[1]=c?u[1]:u),o===r.end.row&&(p[2]=c?u[2]:u);let f=e!==t.attribute.width,m=i!==t.attribute.height;return t.skipMergeUpdate=!0,t.setAttributes({width:e,height:i,strokeArrayWidth:p}),t.skipMergeUpdate=!1,t.mergeStartCol=r.start.col,t.mergeStartRow=r.start.row,t.mergeEndCol=r.end.col,t.mergeEndRow=r.end.row,{widthChange:f,heightChange:m}}function M(t,e,i,r){if(r.internalProps.customMergeCell){let l=r.getCustomMerge(t,e);if(l){let{range:s,text:a,style:o,customLayout:h,customRender:d}=l;if(h||d){let l=(0,n.ws)(h,d,s.start.col,s.start.row,r.getColsWidth(s.start.col,s.end.col),r.getRowsHeight(s.start.row,s.end.row),!1,r.isAutoRowHeight(e),[0,0,0,0],s,r).elementsGroup;i.childrenCount>0&&l?i.insertBefore(l,i.firstChild):l&&i.appendChild(l);let a=r.getRowHeight(e),o=r.getColWidth(t),{width:u}=i.attribute,{height:c}=i.attribute;return i.contentWidth=u,i.contentHeight=c,A(i,o,a,s,r),s}}}}},54572:function(t,e,i){i.d(e,{Gb:()=>y,LP:()=>g,SI:()=>m,Ui:()=>p,km:()=>f});var r=i(50074),n=i(9607),l=i(20219),s=i(56871),a=i(73044),o=i(32802),h=i(64776),d=i(74577),u=i(56982),c=i(95954);function p(t,e,i,s,a,p,g,m,y,b,_,C,x,w,S,A,M){var T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X,Y,$,q,J,Q,te,ti,tr;let tn,tl,ts=w._getCellStyle(s,a),ta=(0,o.vp)("padding",ts,s,a,w);(null==(T=w.options.customConfig)?void 0:T.imageMargin)?b=(0,d.u)(null==(k=w.options.customConfig)?void 0:k.imageMargin):(0,h.Z)(ta)&&(b=ta),(null==(R=null==S?void 0:S.text)?void 0:R.textAlign)&&(_=null==(P=null==S?void 0:S.text)?void 0:P.textAlign),(null==(B=null==S?void 0:S.text)?void 0:B.textBaseline)&&(C=null==(I=null==S?void 0:S.text)?void 0:I.textBaseline);let to=(0,u.d)(s,a,S,w);if(M&&(tn=w.scenegraph.highPerformanceGetCell(s,a,!0))&&"cell"===tn.role&&tn.setAttributes({x:e,y:i,width:p,height:g,lineWidth:null!=(L=null==(E=null==S?void 0:S.group)?void 0:E.lineWidth)?L:void 0,fill:null!=(O=null==(F=null==S?void 0:S.group)?void 0:F.fill)?O:void 0,stroke:null!=(D=null==(H=null==S?void 0:S.group)?void 0:H.stroke)?D:void 0,strokeArrayWidth:null!=to?to:void 0,strokeArrayColor:null!=(W=null==(z=null==S?void 0:S.group)?void 0:z.strokeArrayColor)?W:void 0,cursor:null!=(N=null==(Z=null==S?void 0:S.group)?void 0:Z.cursor)?N:void 0,lineDash:null!=(G=null==(j=null==S?void 0:S.group)?void 0:j.lineDash)?G:void 0,lineCap:"butt",clip:!0,cornerRadius:S.group.cornerRadius}),tn&&"cell"===tn.role||((tn=new l.Z({x:e,y:i,width:p,height:g,lineWidth:null!=(U=null==(V=null==S?void 0:S.group)?void 0:V.lineWidth)?U:void 0,fill:null!=(X=null==(K=null==S?void 0:S.group)?void 0:K.fill)?X:void 0,stroke:null!=($=null==(Y=null==S?void 0:S.group)?void 0:Y.stroke)?$:void 0,strokeArrayWidth:null!=to?to:void 0,strokeArrayColor:null!=(J=null==(q=null==S?void 0:S.group)?void 0:q.strokeArrayColor)?J:void 0,cursor:null!=(te=null==(Q=null==S?void 0:S.group)?void 0:Q.cursor)?te:void 0,lineDash:null!=(tr=null==(ti=null==S?void 0:S.group)?void 0:ti.lineDash)?tr:void 0,lineCap:"butt",clip:!0,cornerRadius:S.group.cornerRadius})).role="cell",tn.col=s,tn.row=a,null==t||t.addCellGroup(tn)),x){let t=s,e=a;A&&(t=A.start.col,e=A.start.row),tl=w.getCellIcons(t,e)}let th=0,td=0,tu=0;if(Array.isArray(tl)&&0!==tl.length){let{leftIconWidth:t,rightIconWidth:e,absoluteLeftIconWidth:i,absoluteRightIconWidth:r}=(0,c.M4)(tl,tn,A,w);th=t+e,td=t,tu=e,tn.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+b[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+p-e-b[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+p-r-b[1])}),tn.forEachChildren(t=>{"middle"===C?t.setAttribute("y",(g-t.AABBBounds.height())/2):"bottom"===C?t.setAttribute("y",g-t.AABBBounds.height()-b[2]):t.setAttribute("y",b[0])}),tn._cellLeftIconWidth=td,tn._cellRightIconWidth=tu}let tc=w.getCellValue(s,a),tp=(0,r.B)({x:b[3],y:b[0],width:p-b[1]-b[3]-th,height:g-b[0]-b[2],image:tc,cursor:"pointer"});return tp.name="image",tp.keepAspectRatio=m,tp.textAlign=_,tp.textBaseline=C,m||y?tp.resources&&tp.resources.has(tp.attribute.image)&&"success"===tp.resources.get(tp.attribute.image).state?(tp.setAttribute("opacity",0),setTimeout(()=>{tp.setAttribute("opacity",1),v(y,m,b,_,C,tp,tn,w),w.scenegraph.updateNextFrame()},0)):tp.successCallback=()=>{v(y,m,b,_,C,tp,tn,w),w.scenegraph.updateNextFrame()}:tp.resources&&tp.resources.has(tp.attribute.image)&&"success"===tp.resources.get(tp.attribute.image).state?f(tn,s,a,0,0,w):tp.successCallback=()=>{f(tn,s,a,0,0,w)},tp.failCallback=()=>{tp.image=n.U2().damage_pic.svg},tn.appendChild(tp),tn}function g(t,e,i,r,n,l,s){let a=!1,o=null,h=null,{width:d,height:u,isMerge:c}=m(s,n.table);if(d<i+l[1]+l[3]&&(o=i+l[1]+l[3],a=!0),u<r+l[2]+l[0]&&(h=r+l[2]+l[0],a=!0),a){if("number"==typeof o)if(c)for(let t=s.mergeStartCol;t<=s.mergeEndCol;t++)n.setColWidth(t,o/(s.mergeEndCol-s.mergeStartCol+1));else n.setColWidth(t,o);if("number"==typeof h)if(c)for(let t=s.mergeStartRow;t<=s.mergeEndRow;t++)n.setRowHeight(t,h/(s.mergeEndRow-s.mergeStartRow+1));else n.setRowHeight(e,h);return n.component.updateScrollBar(),!0}return!1}function f(t,e,i,r,n,l){var h,u,c,p,g,f,v,b,_,C,x,w;let S,A=t.getChildByName("image");if(!A)return;let M="string"!=typeof A.attribute.image&&A.attribute.image||(null==(h=A.resources)?void 0:h.get(A.attribute.image).data);if(!M)return;let T=l._getCellStyle(e,i),k=null!=(u=(0,o.WJ)("textAlign",T,e,i,l))?u:"left",R=null!=(c=(0,o.WJ)("textBaseline",T,e,i,l))?c:"middle";S=(null==(p=l.options.customConfig)?void 0:p.imageMargin)?(0,d.u)(null==(g=l.options.customConfig)?void 0:g.imageMargin):null!=(f=(0,d.u)((0,o.WJ)("padding",T,e,i,l)))?f:[0,0,0,0];let{width:P,height:B,isMerge:I}=m(t,l),E=null!=(v=t.mergeStartCol)?v:t.col,L=null!=(b=t.mergeStartRow)?b:t.row,F=null!=(_=t.mergeEndCol)?_:t.col,O=null!=(C=t.mergeEndCol)?C:t.row,H=null!=(x=t._cellLeftIconWidth)?x:0,D=null!=(w=t._cellRightIconWidth)?w:0;if(A.keepAspectRatio){let{width:t,height:e}=(0,s.f)(M.width||M.videoWidth,M.height||M.videoHeight,P-(S[1]+S[3]),B-(S[0]+S[2])),i=(0,a.W)(0,0,P,B,t,e,k,R,S);for(let r=E;r<=F;r++)for(let n=L;n<=O;n++){let s=l.scenegraph.getCell(r,n).getChildByName("image");null==s||s.setAttributes({x:i.x,y:i.y,width:t,height:e})}}else for(let t=E;t<=F;t++)for(let e=L;e<=O;e++){let i=l.scenegraph.getCell(t,e).getChildByName("image");null==i||i.setAttributes({x:H+S[3],y:S[0],width:P-S[1]-S[3]-D-H,height:B-S[0]-S[2]})}if(t.getChildByName("play-icon")){let{width:e,height:i}=m(t,l),r=Math.floor(Math.min(e-S[1]-S[3],i-S[2]-S[0])/2),n=0+(e>A.attribute.width?A.attribute.x-0+A.attribute.width/2:e/2),s=0+(i>A.attribute.height?A.attribute.y-0+A.attribute.height/2:i/2);for(let t=E;t<=F;t++)for(let e=L;e<=O;e++)l.scenegraph.getCell(t,e).getChildByName("play-icon").setAttributes({x:n-r/2,y:s-r/2,width:r,height:r})}t.forEachChildren(t=>{"icon-left"===t.role||("icon-right"===t.role||"icon-absolute-right"===t.role)&&t.setAttribute("x",t.attribute.x+r)}),t.forEachChildren(t=>{("rect"===t.type||t.role&&t.role.startsWith("icon"))&&("middle"===R?t.setAttribute("y",S[0]+(B-S[0]-S[2]-t.AABBBounds.height())/2):"bottom"===R?t.setAttribute("y",S[0]+B-S[0]-S[2]-t.AABBBounds.height()):t.setAttribute("y",S[0]))}),I&&y(t.mergeStartCol,t.mergeEndCol,t.mergeStartRow,t.mergeEndRow,l)}function m(t,e){return"cell"===t.role&&(0,h.Z)(t.mergeStartCol)&&(0,h.Z)(t.mergeEndCol)&&(0,h.Z)(t.mergeStartRow)&&(0,h.Z)(t.mergeEndRow)?{width:e.getColsWidth(t.mergeStartCol,t.mergeEndCol),height:e.getRowsHeight(t.mergeStartRow,t.mergeEndRow),isMerge:!0}:{width:t.attribute.width,height:t.attribute.height,isMerge:!1}}function y(t,e,i,r,n){for(let l=t;l<=e;l++)for(let t=i;t<=r;t++){let e=n.scenegraph.getCell(l,t);if(e){let i=e.getChildByName("image");i&&i.setAttributes({dx:-n.getColsWidth(e.mergeStartCol,l-1),dy:-n.getRowsHeight(e.mergeStartRow,t-1)});let r=e.getChildByName("play-icon");r&&r.setAttributes({dx:-n.getColsWidth(e.mergeStartCol,l-1),dy:-n.getRowsHeight(e.mergeStartRow,t-1)})}}}function v(t,e,i,r,n,l,o,h){let d=l.resources.get(l.attribute.image).data,{col:u,row:c}=o;if(t&&!b(l)&&g(u,c,d.width,d.height,h.scenegraph,i,o),e||b(l)){let{width:t,height:e,isMerge:u}=m(o,h),{width:c,height:p}=(0,s.f)(d.width,d.height,t-i[1]-i[3],e-i[0]-i[2]),g=(0,a.W)(0,0,t,e,c,p,r,n,i);l.setAttributes({x:g.x,y:g.y,width:c,height:p}),u&&y(o.mergeStartCol,o.mergeEndCol,o.mergeStartRow,o.mergeEndRow,h)}}function b(t){let e=n.U2();return t.attribute.image===e.damage_pic.svg}},77643:function(t,e,i){i.d(e,{LQ:()=>ta,dB:()=>tg,ge:()=>tf,ah:()=>tp,Jy:()=>tu,yR:()=>to,pk:()=>th,VT:()=>tc,au:()=>tm,m4:()=>td});var r=i(31877),n=i(20219),l=i(98075),s=i(34088),a=i(32802),o=i(64776),h=i(56982);function d(t,e,i,r,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S){var A,M,T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X,Y,$;let q=s.U()[m],J=_._getCellStyle(d,u),Q=(0,a.vp)("padding",J,d,u,_);if((0,o.Z)(Q)&&(g=Q),!t){let l=(0,h.d)(d,u,C,_);w&&(t=_.scenegraph.highPerformanceGetCell(d,u,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:c,height:p,lineWidth:null!=(M=null==(A=null==C?void 0:C.group)?void 0:A.lineWidth)?M:void 0,fill:null!=(k=null==(T=null==C?void 0:C.group)?void 0:T.fill)?k:void 0,stroke:null!=(P=null==(R=null==C?void 0:C.group)?void 0:R.stroke)?P:void 0,strokeArrayWidth:l,strokeArrayColor:null!=(I=null==(B=null==C?void 0:C.group)?void 0:B.strokeArrayColor)?I:void 0,cursor:null!=(L=null==(E=null==C?void 0:C.group)?void 0:E.cursor)?L:void 0,lineDash:null!=(O=null==(F=null==C?void 0:C.group)?void 0:F.lineDash)?O:void 0,lineCap:"butt",clip:!0,cornerRadius:C.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:c,height:p,lineWidth:null!=(D=null==(H=null==C?void 0:C.group)?void 0:H.lineWidth)?D:void 0,fill:null!=(W=null==(z=null==C?void 0:C.group)?void 0:z.fill)?W:void 0,stroke:null!=(N=null==(Z=null==C?void 0:C.group)?void 0:Z.stroke)?N:void 0,strokeArrayWidth:l,strokeArrayColor:null!=(G=null==(j=null==C?void 0:C.group)?void 0:j.strokeArrayColor)?G:void 0,cursor:null!=(U=null==(V=null==C?void 0:C.group)?void 0:V.cursor)?U:void 0,lineDash:null!=(X=null==(K=null==C?void 0:C.group)?void 0:K.lineDash)?X:void 0,lineCap:"butt",clip:!0,cornerRadius:C.group.cornerRadius})).role="cell",t.col=d,t.row=u,null==e||e.addCellGroup(t))}if(t.AABBBounds.width(),S&&Array.isArray(_.getCellValue(d,u))||!S){let e=new l.k(x,{stroke:!1,x:g[3],y:g[0],canvas:null!=(Y=_.canvas)?Y:_.scenegraph.stage.window.getContext().canvas,mode:_.options.mode,modeParams:_.options.modeParams,spec:_.options.specTransformInCell?_.options.specTransformInCell(y,d,u):y,ClassType:q,width:c-g[3]-g[1],height:p-g[2]-g[0],chartInstance:v,dataId:b,data:_.getCellValue(d,u)||[],cellPadding:g,dpr:_.internalProps.pixelRatio,detectPickChartItem:null==($=_.options.customConfig)?void 0:$.detectPickChartItem,axes:_.isPivotChart()?_.internalProps.layoutMap.getChartAxes(d,u):[],tableChartOption:_.options.chartOption,col:d,row:u});t.appendChild(e),_.internalProps.layoutMap.setChartInstance(d,u,e.chartInstance)}return t}var u=i(34672),c=i(80971),p=i(43064),g=i(71994),f=i(23975),m=i(95954);class y extends n.Z{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new n.Z({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new n.Z({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._checkboxGroup=new n.Z({pickable:!1,fill:!1,stroke:!1}),this._checkboxGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._checkboxGroup)}addLeftOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._leftGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth((null!=(i=t.attribute.marginLeft)?i:0)+(null!=(r=t.attribute.marginRight)?r:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._rightGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth((null!=(i=t.attribute.marginLeft)?i:0)+(null!=(r=t.attribute.marginRight)?r:0)+t.attribute.width)}addCheckbox(t){this._checkboxGroup.appendChild(t)}setCheckboxContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){let i=this._checkboxGroup.width;this._cellWidth=t+e+i,this.setAttribute("width",this._cellWidth)}else{let i=this._cellWidth-t-e;this.updateCenterLayout(i);let r=this._checkboxGroup.width;this._cellWidth=t+e+r,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();let i=this._leftGroup.height,r=this._rightGroup.height,n=this._checkboxGroup.height;this._cellHeight=Math.max(i,r,n),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._checkboxGroup.forEachChildren(t=>{t instanceof p.J&&(e-=t.AABBBounds.width())});let i=this._checkboxGroup.getChildByName("checkbox-content");i instanceof p.J&&i.setAttribute("width",e);let r=0;this._checkboxGroup.forEachChildren(t=>{t.setAttribute("x",r),r+=t.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._checkboxGroup.setAttribute("x",4),"left"===this._align||"start"===this._align?this.setAttribute("dx",0):"center"===this._align?this.setAttribute("dx",-this.attribute.width/2):"right"!==this._align&&"end"!==this._align||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){"top"===this._baseline?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._checkboxGroup.setAttribute("y",0)):"middle"===this._baseline?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._checkboxGroup.setAttribute("y",this._cellHeight/2-this._checkboxGroup.height/2)):"bottom"===this._baseline&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._checkboxGroup.setAttribute("y",this._cellHeight-this._checkboxGroup.height))}}var v=i(73501);function b(t,e,i,r,l,s,o,d,b,_,C,x,w,S,A,M,T,k,R){var P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X,Y,$,q,J,Q;let te;if(!t){let a=(0,h.d)(l,s,A,S);k&&(t=S.scenegraph.highPerformanceGetCell(l,s,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:d,height:b,lineWidth:null!=(B=null==(P=null==A?void 0:A.group)?void 0:P.lineWidth)?B:void 0,fill:null!=(E=null==(I=null==A?void 0:A.group)?void 0:I.fill)?E:void 0,stroke:null!=(F=null==(L=null==A?void 0:A.group)?void 0:L.stroke)?F:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(H=null==(O=null==A?void 0:A.group)?void 0:O.strokeArrayColor)?H:void 0,cursor:null!=(z=null==(D=null==A?void 0:A.group)?void 0:D.cursor)?z:void 0,lineDash:null!=(Z=null==(W=null==A?void 0:A.group)?void 0:W.lineDash)?Z:void 0,lineCap:"butt",clip:!0,cornerRadius:A.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:d,height:b,lineWidth:null!=(j=null==(N=null==A?void 0:A.group)?void 0:N.lineWidth)?j:void 0,fill:null!=(V=null==(G=null==A?void 0:A.group)?void 0:G.fill)?V:void 0,stroke:null!=(K=null==(U=null==A?void 0:A.group)?void 0:U.stroke)?K:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(Y=null==(X=null==A?void 0:A.group)?void 0:X.strokeArrayColor)?Y:void 0,cursor:null!=(q=null==($=null==A?void 0:A.group)?void 0:$.cursor)?q:void 0,lineDash:null!=(Q=null==(J=null==A?void 0:A.group)?void 0:J.lineDash)?Q:void 0,lineCap:"butt",clip:!0,cornerRadius:A.group.cornerRadius})).role="cell",t.col=l,t.row=s,null==e||e.addCellGroup(t))}if(w){let t=l,e=s;T&&(t=T.start.col,e=T.start.row),te=S.getCellIcons(t,e)}let ti=0,tr=0,tn=0,tl=0,ts=[];if(Array.isArray(te)&&0!==te.length){let{leftIconWidth:e,rightIconWidth:i,contentLeftIcons:r,contentRightIcons:n,absoluteLeftIconWidth:l,absoluteRightIconWidth:s}=(0,m.M4)(te,t,T,S);ti=e+i,tr=e,tn=i,ts=r,tl=s,t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+_[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+d-i-_[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+d-s-_[1])}),t.forEachChildren(t=>{"middle"===x?t.setAttribute("y",(b-t.AABBBounds.height())/2):"bottom"===x?t.setAttribute("y",b-t.AABBBounds.height()-_[2]):t.setAttribute("y",_[0])})}let ta=function(t,e,i,r,n,l,s,o,h,d){var u,m,y;let v=h._getCellStyle(t,e),b=(0,a.WJ)("size",v,t,e,h),_=(0,a.WJ)("spaceBetweenTextAndIcon",v,t,e,h),C=(0,a.WJ)("defaultFill",v,t,e,h),x=(0,a.WJ)("defaultStroke",v,t,e,h),w=(0,a.WJ)("disableFill",v,t,e,h),S=(0,a.WJ)("checkedFill",v,t,e,h),A=(0,a.WJ)("checkedStroke",v,t,e,h),M=(0,a.WJ)("disableCheckedFill",v,t,e,h),T=(0,a.WJ)("disableCheckedStroke",v,t,e,h),k=(0,a.WJ)("checkIconImage",v,t,e,h),R=(0,a.WJ)("indeterminateIconImage",v,t,e,h),P=h.getCellValue(t,e),B=h.getCellOriginValue(t,e),I,E,L=null!=P?P:"";if((0,c.Z)(P)?(I=P.checked,E=P.disable,L=null!=(u=P.text)?u:""):"boolean"==typeof P&&(I=P,L=""),h.internalProps.layoutMap.isSeriesNumber(t,e)){let i=h.getFieldData(o.field,t,e);i&&("string"==typeof i||("object"==typeof i?(I=i.checked,E=i.disable):"boolean"==typeof i&&(I=i)))}I=h.stateManager.syncCheckedState(t,e,o.field,I);let F=(0,g.L)(t,e,h),O=h._getCellStyle(t,e),H=null!=(m=O.autoWrapText)?m:h.internalProps.autoWrapText,{lineClamp:D}=O,{checked:z,disable:W}=o;if(null==I||"function"==typeof I){let i=(0,f.vi)(z,{col:t,row:e,table:h,context:null,value:P,dataValue:B});I=h.stateManager.syncCheckedState(t,e,o.field,i)}let Z=(0,f.vi)(W,{col:t,row:e,table:h,context:null,value:P,dataValue:B}),N=h.isAutoRowHeight(e),j={text:1===L.length?L[0]:L,maxLineWidth:"auto"===i?1/0:r-(l[1]+l[3]+F)-b-_,textAlign:"left",textBaseline:"top",autoWrapText:H,lineClamp:D,wordBreak:"break-word",heightLimit:N?-1:n-Math.floor(l[0]+l[2]),pickable:!1,dx:d?0:F,whiteSpace:1!==L.length||H?"normal":"no-wrap"},G={x:0,y:0,text:s.text?Object.assign({},s.text,j):j,icon:{width:Math.floor(b/1.4),height:Math.floor(b/1.4)},box:{width:b,height:b},dx:d?F:0,spaceBetweenTextAndIcon:_,disabled:null!=(y=null!=E?E:Z)&&y};"indeterminate"===I?(G.checked=void 0,G.indeterminate=!0):(G.checked=I,G.indeterminate=void 0),C&&(G.box.fill=C),x&&(G.box.stroke=x),w&&(G.box.disableFill=w),S&&(G.box.checkedFill=S),A&&(G.box.checkedStroke=A),M&&(G.box.disableCheckedFill=M),T&&(G.box.disableCheckedStroke=T),k&&(G.icon.checkIconImage=k),R&&(G.icon.indeterminateIconImage=R);let V=new p.J(G);return V.name="checkbox",V}(l,s,o-ti,d,b,_,A,M,S,R);if(1!==ts.length||ts[0].name!==u.up.expandIconName&&ts[0].name!==u.up.collapseIconName)ta&&t.appendChild(ta),ta.render();else{let e=new y({x:0,y:0,fill:!1,stroke:!1,pickable:!1});e.name="checkbox-content",e.setCheckboxContentOption({autoWidth:!1,autoHeight:!1,cellWidth:d-(_[1]+_[3]),cellHeight:b-_[0]-_[2],align:C,baseline:x});let i={addedHierarchyOffset:0};ts.forEach(r=>{let n=(0,m.Bg)(r,void 0,t.col,t.row,T,S,i);n.role="icon-content-left",n.name=r.name,e.addLeftOccupyingIcon(n)}),ta&&e.addCheckbox(ta),t.appendChild(e),e.layout(),e.AABBBounds.width(),e.AABBBounds.height();let r=d-(_[1]+_[3]),n=b-(_[0]+_[2]);t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+_[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+r-tn+_[3]):"icon-absolute-right"===t.role?t.setAttribute("x",t.attribute.x+r-tl+_[3]+_[1]):"content"!==t.name&&"checkbox-content"!==t.name||("center"===C&&"richtext"!==t.type?t.setAttribute("x",_[3]+tr+(r-tr-tn)/2):"right"===C&&"richtext"!==t.type?t.setAttribute("x",_[3]+r-tn):t.setAttribute("x",_[3]+tr))}),t.forEachChildren(t=>{t.name!==v.FH&&("middle"===x?(null==t?void 0:t._checkboxGroup)&&t._leftGroup.setAttribute("y",_[0]+(n-t._checkboxGroup.AABBBounds.height())/2):"bottom"===x?t.setAttribute("y",_[0]+n-t.AABBBounds.height()):t.setAttribute("y",_[0]))})}return d-=_[1]+_[3]+ti,b-=_[0]+_[2],"center"===C?ta.setAttribute("x",_[3]+tr+(d-ta.AABBBounds.width())/2):"right"===C?ta.setAttribute("x",_[3]+tr+d-ta.AABBBounds.width()):ta.setAttribute("x",_[3]+tr),"middle"===x?ta.setAttribute("y",_[0]+(b-ta.AABBBounds.height())/2):"bottom"===x?ta.setAttribute("y",_[0]+b-ta.AABBBounds.height()):ta.setAttribute("y",_[0]),t}var _=i(54572),C=i(4654),x=i(95723),w=i(63778),S=i(20408),A=i(36637);function M(t,e,i,r,l,s,o,d,u,c,p,f,m,y,v,b){var _,w,S,A,M,k,R,P,B,I,E,L;if(!t){let a=(0,h.d)(l,s,y,m);(t=new n.Z({x:i,y:r,width:d,height:u,lineWidth:null!=(w=null==(_=null==y?void 0:y.group)?void 0:_.lineWidth)?w:void 0,fill:null!=(A=null==(S=null==y?void 0:y.group)?void 0:S.fill)?A:void 0,stroke:null!=(k=null==(M=null==y?void 0:y.group)?void 0:M.stroke)?k:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(P=null==(R=null==y?void 0:y.group)?void 0:R.strokeArrayColor)?P:void 0,cursor:null!=(I=null==(B=null==y?void 0:y.group)?void 0:B.cursor)?I:void 0,lineDash:null!=(L=null==(E=null==y?void 0:y.group)?void 0:E.lineDash)?L:void 0,lineCap:"butt",clip:!0,cornerRadius:y.group.cornerRadius})).role="cell",t.col=l,t.row=s,null==e||e.addCellGroup(t)}let{width:F,height:O}=function(t,e,i,r,n,l,s,o,h,d,u){var c,p,f,m;let y=u._getCellStyle(t,e),v=(0,a.WJ)("size",y,t,e,u),b=(0,a.WJ)("innerRadius",y,t,e,u),_=(0,a.WJ)("outerRadius",y,t,e,u),w=(0,a.WJ)("spaceBetweenTextAndIcon",y,t,e,u),S=(0,a.WJ)("spaceBetweenRadio",y,t,e,u),A=(0,a.WJ)("defaultFill",y,t,e,u),M=(0,a.WJ)("defaultStroke",y,t,e,u),k=(0,a.WJ)("disableFill",y,t,e,u),R=(0,a.WJ)("checkedFill",y,t,e,u),P=(0,a.WJ)("checkedStroke",y,t,e,u),B=(0,a.WJ)("disableCheckedFill",y,t,e,u),I=(0,a.WJ)("disableCheckedStroke",y,t,e,u);(0,C.Z)(_)?v=2*_:_=Math.round(v/2),(!(0,C.Z)(b)||b<0)&&(b=Math.round(_/7*3));let E=u.getCellValue(t,e),L=u.getCellOriginValue(t,e),F=(0,g.L)(t,e,u),O=u._getCellStyle(t,e),H=null!=(c=O.autoWrapText)?c:u.internalProps.autoWrapText,{lineClamp:D}=O,z=u.isAutoRowHeight(e),W={maxLineWidth:"auto"===i?1/0:r-(l[1]+l[3]+F)-v-w,textAlign:"left",textBaseline:"top",autoWrapText:H,lineClamp:D,wordBreak:"break-word",heightLimit:z?-1:n-Math.floor(l[0]+l[2]),pickable:!1,dx:F},Z={x:0,y:0,text:s.text?Object.assign({},s.text,W):W,circle:{innerRadius:b,outerRadius:_},spaceBetweenTextAndIcon:w};A&&(Z.circle.fill=A),M&&(Z.circle.stroke=M),k&&(Z.circle.disableFill=k),R&&(Z.circle.checkedFill=R),P&&(Z.circle.checkedStroke=P),B&&(Z.circle.disableCheckedFill=B),I&&(Z.circle.disableCheckedStroke=I);let N=0,j=0,G=null!=(p=o.radioDirectionInCell)?p:"vertical";if((0,x.Z)(E))E.forEach((i,r)=>{var n,l;let s=T(i,L,r,t,e,o,H,Z,u);s&&h.appendChild(s),s.id=`radio-${null!=(n=null==d?void 0:d.start.col)?n:t}-${null!=(l=null==d?void 0:d.start.row)?l:e}-${r}`,s.render();let a=s.AABBBounds;"vertical"===G?(s.setAttribute("y",j),j+=a.height()+(r!==E.length-1?S:0),N=Math.max(N,a.width())):"horizontal"===G&&(s.setAttribute("x",N),N+=a.width()+(r!==E.length-1?S:0),j=Math.max(j,a.height()))});else{let i=T(E,L,void 0,t,e,o,H,Z,u);i&&h.appendChild(i),i.id=`radio-${null!=(f=null==d?void 0:d.start.col)?f:t}-${null!=(m=null==d?void 0:d.start.row)?m:e}`,i.render();let r=i.AABBBounds;N=r.width(),j=r.height()}return{width:N,height:j}}(l,s,o,d,u,c,y,v,t,b,m);return d-=c[1]+c[3],u-=c[0]+c[2],t.forEachChildren(t=>{"center"===p?t.setAttribute("x",c[3]+t.attribute.x+(d-F)/2):"right"===p?t.setAttribute("x",c[3]+t.attribute.x+d-F):t.setAttribute("x",c[3]+t.attribute.x),"middle"===f?t.setAttribute("y",c[0]+t.attribute.y+(u-O)/2):"bottom"===f?t.setAttribute("y",c[0]+t.attribute.y+u-O):t.setAttribute("y",c[0]+t.attribute.y)}),t}function T(t,e,i,r,n,l,s,a,o){let h=function(t,e,i,r,n,l,s){var a,o;let h,d,u=null!=(a=l.radioCheckType)?a:"column";return(0,c.Z)(t)?h=t.checked:"boolean"==typeof t&&(h=t),null!=(h=s.stateManager.syncRadioState(r,n,l.field,u,i,h))&&"function"!=typeof h||(d=(0,f.vi)(l.checked,{col:r,row:n,table:s,context:null,value:t,dataValue:e}),h=s.stateManager.syncRadioState(r,n,l.field,u,i,d)),null!=(o=null!=h?h:d)&&o}(t,e,i,r,n,l,o),d=function(t,e,i,r,n,l){var s;let a;(0,c.Z)(t)&&(a=t.disable);let o=(0,f.vi)(n.disable,{col:i,row:r,table:l,context:null,value:t,dataValue:e});return null!=(s=null!=a?a:o)&&s}(t,e,r,n,l,o),u=(0,c.Z)(t)?t.text:(0,w.Z)(t)?"":null!=t?t:"",p=(0,S.Z)({},a,{checked:h,disabled:d,text:{text:1===u.length?u[0]:u,whiteSpace:1!==u.length||s?"normal":"no-wrap"},boundsPadding:0}),g=new A.Y(p);return g.name="radio",g}var k=i(23162);function R(t,e,i,r,l,s,o,d,u,p,y,v,b,_,C,x,w,S){var A,M,T,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K,X,Y;let $;if(!t){let a=(0,h.d)(l,s,C,_);S&&(t=_.scenegraph.highPerformanceGetCell(l,s,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:d,height:u,lineWidth:null!=(M=null==(A=null==C?void 0:C.group)?void 0:A.lineWidth)?M:void 0,fill:null!=(R=null==(T=null==C?void 0:C.group)?void 0:T.fill)?R:void 0,stroke:null!=(B=null==(P=null==C?void 0:C.group)?void 0:P.stroke)?B:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(E=null==(I=null==C?void 0:C.group)?void 0:I.strokeArrayColor)?E:void 0,cursor:null!=(F=null==(L=null==C?void 0:C.group)?void 0:L.cursor)?F:void 0,lineDash:null!=(H=null==(O=null==C?void 0:C.group)?void 0:O.lineDash)?H:void 0,lineCap:"butt",clip:!0,cornerRadius:C.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:d,height:u,lineWidth:null!=(z=null==(D=null==C?void 0:C.group)?void 0:D.lineWidth)?z:void 0,fill:null!=(Z=null==(W=null==C?void 0:C.group)?void 0:W.fill)?Z:void 0,stroke:null!=(j=null==(N=null==C?void 0:C.group)?void 0:N.stroke)?j:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(V=null==(G=null==C?void 0:C.group)?void 0:G.strokeArrayColor)?V:void 0,cursor:null!=(K=null==(U=null==C?void 0:C.group)?void 0:U.cursor)?K:void 0,lineDash:null!=(Y=null==(X=null==C?void 0:C.group)?void 0:X.lineDash)?Y:void 0,lineCap:"butt",clip:!0,cornerRadius:C.group.cornerRadius})).role="cell",t.col=l,t.row=s,null==e||e.addCellGroup(t))}if(b){let t=l,e=s;w&&(t=w.start.col,e=w.start.row),$=_.getCellIcons(t,e)}let q=0,J=0;if(Array.isArray($)&&0!==$.length){let{leftIconWidth:e,rightIconWidth:i,absoluteLeftIconWidth:r,absoluteRightIconWidth:n}=(0,m.M4)($,t,w,_);q=e+i,J=e,t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+p[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+d-i-p[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+d-n-p[1])}),t.forEachChildren(t=>{"middle"===v?t.setAttribute("y",(u-t.AABBBounds.height())/2):"bottom"===v?t.setAttribute("y",u-t.AABBBounds.height()-p[2]):t.setAttribute("y",p[0])})}let Q=function(t,e,i,r,n,l,s,o,h){var d,u,p;let m=h._getCellStyle(t,e),y=(0,a.WJ)("spaceBetweenTextAndCircle",m,t,e,h),v=(0,a.WJ)("circleRadius",m,t,e,h),b=(0,a.WJ)("boxWidth",m,t,e,h),_=(0,a.WJ)("boxHeight",m,t,e,h),C=(0,a.WJ)("checkedFill",m,t,e,h),x=(0,a.WJ)("uncheckedFill",m,t,e,h),w=(0,a.WJ)("disableCheckedFill",m,t,e,h),S=(0,a.WJ)("disableUncheckedFill",m,t,e,h),A=(0,a.WJ)("circleFill",m,t,e,h),M=h.getCellValue(t,e),T=h.getCellOriginValue(t,e),R,P,B=null!=M?M:"";(0,c.Z)(M)?(R=M.checked,P=M.disable,B=null!=(d=M.text)?d:""):"boolean"==typeof M&&(R=M,B=""),R=h.stateManager.syncCheckedState(t,e,o.field,R);let I=(0,g.L)(t,e,h),E=h._getCellStyle(t,e),L=null!=(u=E.autoWrapText)?u:h.internalProps.autoWrapText,{lineClamp:F}=E,{checked:O,disable:H,uncheckedText:D,checkedText:z}=o;if(null==R||"function"==typeof R){let i=(0,f.vi)(O,{col:t,row:e,table:h,context:null,value:M,dataValue:T});R=h.stateManager.syncCheckedState(t,e,o.field,i)}let W=(0,f.vi)(H,{col:t,row:e,table:h,context:null,value:M,dataValue:T}),Z=(0,f.vi)(z,{col:t,row:e,table:h,context:null,value:M,dataValue:T}),N=(0,f.vi)(D,{col:t,row:e,table:h,context:null,value:M,dataValue:T}),j=h.isAutoRowHeight(e),G={text:1===B.length?B[0]:B,maxLineWidth:"auto"===i?1/0:r-(l[1]+l[3]+I)-2*v-y,textAlign:"left",textBaseline:"top",autoWrapText:L,lineClamp:F,wordBreak:"break-word",heightLimit:j?-1:n-Math.floor(l[0]+l[2]),pickable:!1,dx:I,whiteSpace:1!==B.length||L?"normal":"no-wrap",checkedText:Z,uncheckedText:N},V={x:0,y:0,text:s.text?Object.assign({},s.text,G):G,circle:{radius:v},box:{width:b,height:_},spaceBetweenTextAndCircle:y,disabled:null!=(p=null!=P?P:W)&&p};V.checked=R,x&&(V.box.uncheckedFill=x),S&&(V.box.disableUncheckedFill=S),C&&(V.box.checkedFill=C),w&&(V.box.disableCheckedFill=w),A&&(V.circle.fill=A);let U=new k.r(V);return U.name="switch",U}(l,s,o-q,d,u,p,C,x,_);return Q&&t.appendChild(Q),Q.render(),d-=p[1]+p[3]+q,u-=p[0]+p[2],"center"===y?Q.setAttribute("x",p[3]+J+(d-Q.AABBBounds.width())/2):"right"===y?Q.setAttribute("x",p[3]+J+d-Q.AABBBounds.width()):Q.setAttribute("x",p[3]+J),"middle"===v?Q.setAttribute("y",p[0]+(u-Q.AABBBounds.height())/2):"bottom"===v?Q.setAttribute("y",p[0]+u-Q.AABBBounds.height()):Q.setAttribute("y",p[0]),t}var P=i(78503),B=i(9252),I=i(6119),E=i(10145);let L=new I.Y,F=new E.f;function O(t,e,i,r,l,s,a,d,u,c,p,g){var f,m,y,v,b,_,C,x,w,S,A,M,T,k,R,B,I,E,O,z,W,Z,N,j;if(!t){let o=(0,h.d)(l,s,p,c);g&&(t=c.scenegraph.highPerformanceGetCell(l,s,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:a,height:d,lineWidth:null!=(m=null==(f=null==p?void 0:p.group)?void 0:f.lineWidth)?m:void 0,fill:null!=(v=null==(y=null==p?void 0:p.group)?void 0:y.fill)?v:void 0,stroke:null!=(_=null==(b=null==p?void 0:p.group)?void 0:b.stroke)?_:void 0,strokeArrayWidth:o,strokeArrayColor:null!=(x=null==(C=null==p?void 0:p.group)?void 0:C.strokeArrayColor)?x:void 0,cursor:null!=(S=null==(w=null==p?void 0:p.group)?void 0:w.cursor)?S:void 0,lineDash:null!=(M=null==(A=null==p?void 0:p.group)?void 0:A.lineDash)?M:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:a,height:d,lineWidth:null!=(k=null==(T=null==p?void 0:p.group)?void 0:T.lineWidth)?k:void 0,fill:null!=(B=null==(R=null==p?void 0:p.group)?void 0:R.fill)?B:void 0,stroke:null!=(E=null==(I=null==p?void 0:p.group)?void 0:I.stroke)?E:void 0,strokeArrayWidth:o,strokeArrayColor:null!=(z=null==(O=null==p?void 0:p.group)?void 0:O.strokeArrayColor)?z:void 0,cursor:null!=(Z=null==(W=null==p?void 0:p.group)?void 0:W.cursor)?Z:void 0,lineDash:null!=(j=null==(N=null==p?void 0:p.group)?void 0:N.lineDash)?j:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius})).role="cell",t.col=l,t.row=s,null==e||e.addCellGroup(t))}let G=function(t,e,i,r,n,l){let s,a,h,d,u=l.internalProps.layoutMap.getBody(t,e).sparklineSpec,c=l.getCellValue(t,e);if(!Array.isArray(c))return;let p=n[3],g=n[0];i-=n[1]+n[3];let f=r-=n[0]+n[2];"function"==typeof u?a=H(s=u({col:t,row:e,dataValue:l.getCellOriginValue(t,e)||"",value:l.getCellValue(t,e)||"",rect:l.getCellRangeRelativeRect(l.getCellRange(t,e)),table:l}),p,g,i,r):(s=u,a=H(u,p,g,i,r));let m=[],y=[];if("object"==typeof s.xField)L.domain(s.xField.domain),h=s.xField.field;else if("string"==typeof s.xField){let t=c.map(t=>t[s.xField]);L.domain(t),h=s.xField}else Array.isArray(c)&&(L.domain(Array.from({length:c.length},(t,e)=>e)),h=s.xField);if(L.range([0,i]),"object"==typeof s.yField)F.domain(s.yField.domain),d=s.yField.field;else if("string"==typeof s.yField){let t=D(c,s.yField);F.domain([Math.min(...t),Math.max(...t)]),d=s.yField}else if(Array.isArray(c)){let t=D(c);F.domain([Math.min(...t),Math.max(...t)]),d=s.yField}if(F.range([0,r]),"object"==typeof s.xField&&Array.isArray(s.xField.domain)){let t=c.map(t=>t[s.xField.field]),e=s.xField.domain;for(let i=0;i<e.length;i++){let r=!1;for(let n=0;n<t.length;n++)if(e[i]===t[n]){let t=c[n];if(!(0,o.Z)(t[h])||!(0,o.Z)(t[d]))break;m.push({x:0+L.scale(t[h]),y:f-F.scale(t[d]),defined:(0,o.Z)(t[d])}),y.push(t),r=!0;break}r||(m.push({x:0+L.scale(e[i]),y:0,defined:!1}),y.push({[h]:e[i],[d]:null}))}}else for(let t=0;t<c.length;t++){let e=c[t];m.push({x:0+L.scale(h?e[h]:t),y:f-F.scale(d?e[d]:e),defined:(0,o.Z)(d?e[d]:e),rawData:e}),y.push(e)}let v=a.getChildByName("sparkline-line");v&&v.setAttribute("points",m),v.bandwidth=L.step(),v.min=F.range()[0],v.max=F.range()[1];let b=a.getChildByName("sparkline-symbol-group");if(b){let t="isolatedPoint"===s.pointShowRule;if("all"===s.pointShowRule)for(let t=0;t<m.length;t++){let{x:e,y:i,defined:r}=m[t];if(r){let t=(0,P.t)({x:e,y:i});b.appendChild(t)}}else if(t)for(let t=0;t<m.length;t++){let{x:e,y:i,defined:r}=m[t];if(r&&(!m[t-1]||!m[t-1].defined)&&(!m[t+1]||!m[t+1].defined)){let t=(0,P.t)({x:e,y:i});b.appendChild(t)}}}return a}(l,s,a,d,u,c);return G&&t.appendChild(G),t}function H(t,e,i,r,l){var s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x,w,S,A,M,T;let k;k="function"==typeof t?t(null):t;let R=new n.Z({x:e,y:i,width:r,height:l,stroke:!1,fill:!1});if(R.name="sparkline","line"===k.type){let t=(0,B.W)({x:0,y:0,curveType:k.smooth?"monotoneX":"linear",stroke:null!=(o=null==(a=null==(s=k.line)?void 0:s.style)?void 0:a.stroke)?o:"blue",lineWidth:null!=(u=null==(d=null==(h=k.line)?void 0:h.style)?void 0:d.strokeWidth)?u:2});t.name="sparkline-line",R.addChild(t),k.crosshair&&(t.hover=null!=(p=null==(c=k.crosshair)?void 0:c.style)?p:{stroke:"#000",interpolate:"linear"});let e=new n.Z({x:0,y:0,width:r,height:l,stroke:!1,fill:!1});e.name="sparkline-symbol-group",e.setTheme({symbol:{stroke:null!=(m=null==(f=null==(g=k.point)?void 0:g.style)?void 0:f.stroke)?m:"#000",lineWidth:null!=(b=null==(v=null==(y=k.point)?void 0:y.style)?void 0:v.strokeWidth)?b:1,fill:null!=(x=null==(C=null==(_=k.point)?void 0:_.style)?void 0:C.fill)?x:"#000",size:2*(null!=(A=null==(S=null==(w=k.point)?void 0:w.style)?void 0:S.size)?A:3),symbolType:"circle"}}),R.addChild(e),e.hover=null!=(T=null==(M=k.point)?void 0:M.hover)&&T}return R}function D(t,e){let i=[];for(let r=0;r<t.length;r++){let n=t[r];(0,o.Z)(e)&&(0,o.Z)(n[e])?i.push(n[e]):!(0,o.Z)(e)&&(0,o.Z)(n)&&i.push(n)}return i}var z=i(50074),W=i(9607),Z=i(56871),N=i(68173),j=i(73044),G=i(74577);let V=W.U2();function U(t,e,i,r,l,s,d,u,c,p,g,f,y,v,b,C,x){var w,S,A,M,T,k,R,P,B,I,E,L,F,O,H,D,W,U,K,X,Y,$,q,J,Q,te,ti,tr,tn,tl;let ts,ta,to=v._getCellStyle(r,l),th=(0,a.vp)("padding",to,r,l,v);(null==(w=v.options.customConfig)?void 0:w.imageMargin)?p=(0,G.u)(null==(S=v.options.customConfig)?void 0:S.imageMargin):(0,o.Z)(th)&&(p=th),(null==(A=null==b?void 0:b.text)?void 0:A.textAlign)&&(g=null==(M=null==b?void 0:b.text)?void 0:M.textAlign),(null==(T=null==b?void 0:b.text)?void 0:T.textBaseline)&&(f=null==(k=null==b?void 0:b.text)?void 0:k.textBaseline);let td=(0,h.d)(r,l,b,v);if(x&&(ts=v.scenegraph.highPerformanceGetCell(r,l,!0))&&"cell"===ts.role&&ts.setAttributes({x:e,y:i,width:s,height:d,lineWidth:null!=(P=null==(R=null==b?void 0:b.group)?void 0:R.lineWidth)?P:void 0,fill:null!=(I=null==(B=null==b?void 0:b.group)?void 0:B.fill)?I:void 0,stroke:null!=(L=null==(E=null==b?void 0:b.group)?void 0:E.stroke)?L:void 0,strokeArrayWidth:td,strokeArrayColor:null!=(O=null==(F=null==b?void 0:b.group)?void 0:F.strokeArrayColor)?O:void 0,cursor:null!=(D=null==(H=null==b?void 0:b.group)?void 0:H.cursor)?D:void 0,lineDash:null!=(U=null==(W=null==b?void 0:b.group)?void 0:W.lineDash)?U:void 0,lineCap:"butt",clip:!0,cornerRadius:b.group.cornerRadius}),ts&&"cell"===ts.role||((ts=new n.Z({x:e,y:i,width:s,height:d,lineWidth:null!=(X=null==(K=null==b?void 0:b.group)?void 0:K.lineWidth)?X:void 0,fill:null!=($=null==(Y=null==b?void 0:b.group)?void 0:Y.fill)?$:void 0,stroke:null!=(J=null==(q=null==b?void 0:b.group)?void 0:q.stroke)?J:void 0,strokeArrayWidth:td,strokeArrayColor:null!=(te=null==(Q=null==b?void 0:b.group)?void 0:Q.strokeArrayColor)?te:void 0,cursor:null!=(tr=null==(ti=null==b?void 0:b.group)?void 0:ti.cursor)?tr:void 0,lineDash:null!=(tl=null==(tn=null==b?void 0:b.group)?void 0:tn.lineDash)?tl:void 0,lineCap:"butt",clip:!0,cornerRadius:b.group.cornerRadius})).role="cell",ts.col=r,ts.row=l,null==t||t.addCellGroup(ts)),y){let t=r,e=l;C&&(t=C.start.col,e=C.start.row),ta=v.getCellIcons(t,e)}let tu=0,tc=0;if(Array.isArray(ta)&&0!==ta.length){let{leftIconWidth:t,rightIconWidth:e,absoluteLeftIconWidth:i,absoluteRightIconWidth:r}=(0,m.M4)(ta,ts,C,v);tu=t,tc=e,ts.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+p[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+s-e-p[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+s-r-p[1])}),ts.forEachChildren(t=>{"middle"===f?t.setAttribute("y",(d-t.AABBBounds.height())/2):"bottom"===f?t.setAttribute("y",d-t.AABBBounds.height()-p[2]):t.setAttribute("y",p[0])}),ts._cellLeftIconWidth=tu,ts._cellRightIconWidth=tc}let tp=v.getCellValue(r,l),tg=document.createElement("video");tg.addEventListener("loadeddata",()=>{c&&(0,_.LP)(r,l,tg.videoWidth,tg.videoHeight,v.scenegraph,p,ts);let{width:t,height:e,isMerge:i}=(0,_.SI)(ts,v);if(u){let{width:i,height:r}=(0,Z.f)(tg.videoWidth,tg.videoHeight,t-p[1]-p[3],e-p[0]-p[2]),n=(0,j.W)(0,0,t,e,i,r,g,f,p);tf.setAttributes({width:i,height:r,x:n.x,y:n.y,dx:0})}else tf.setAttributes({x:p[3],y:p[0],width:t-p[1]-p[3],height:e-p[2]-p[0],dy:0});i&&(0,_.Gb)(ts.mergeStartCol,ts.mergeEndCol,ts.mergeStartRow,ts.mergeEndRow,v);let{width:n,height:s}=(0,_.SI)(ts,v),a=Math.floor(Math.min(n-p[1]-p[3],s-p[2]-p[0])/2),o=0+(n>tf.attribute.width?tf.attribute.x-0+tf.attribute.width/2:n/2),h=0+(s>tf.attribute.height?tf.attribute.y-0+tf.attribute.height/2:s/2),{dx:d,dy:m}=ts.getChildByName("image",!0).attribute,y=new N.J({x:o-a/2,y:h-a/2,width:a,height:a,image:V.play.svg,cursor:V.play.cursor,dx:d,dy:m});y.name="play-icon",ts.appendChild(y),v.scenegraph.updateNextFrame()}),tg.onerror=()=>{tf.image=V.damage_pic.svg},tg.src=tp,tg.setAttribute("preload","auto");let tf=(0,z.B)({x:p[3],y:p[0],width:s-p[1]-p[3],height:d-p[2]-p[0],image:tg,cursor:"pointer"});return tf.name="image",tf.keepAspectRatio=u,tf.textAlign=g,tf.textBaseline=f,ts.appendChild(tf),ts}var K=i(638),X=i(64871),Y=i(22288);function $(t,e,i,r,l,s,d,u,c,p,g,f,y,v,b,_,C,x,w){var S,A,M,T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,$,q,J,Q,te,ti,tr,tn,tl,ts;let ta,to=t._getCellStyle(s,d),th=(0,a.vp)("padding",to,s,d,t);(0,o.Z)(th)&&(g=th),(null==(S=null==C?void 0:C.text)?void 0:S.textAlign)&&(f=null==(A=null==C?void 0:C.text)?void 0:A.textAlign),(null==(M=null==C?void 0:C.text)?void 0:M.textBaseline)&&(y=null==(T=null==C?void 0:C.text)?void 0:T.textBaseline);let td=t.isAutoRowHeight(d),tu=null!=(k=to.autoWrapText)?k:t.internalProps.autoWrapText,tc=to.lineClamp,tp=(0,h.d)(s,d,C,t);if(w&&(ta=t.scenegraph.getCell(s,d,!0))&&"cell"===ta.role&&ta.setAttributes({x:r,y:l,width:c,height:p,lineWidth:null!=(P=null==(R=null==C?void 0:C.group)?void 0:R.lineWidth)?P:void 0,fill:null!=(I=null==(B=null==C?void 0:C.group)?void 0:B.fill)?I:void 0,stroke:null!=(L=null==(E=null==C?void 0:C.group)?void 0:E.stroke)?L:void 0,strokeArrayWidth:null!=tp?tp:void 0,strokeArrayColor:null!=(O=null==(F=null==C?void 0:C.group)?void 0:F.strokeArrayColor)?O:void 0,cursor:null!=(D=null==(H=null==C?void 0:C.group)?void 0:H.cursor)?D:void 0,lineDash:null!=(W=null==(z=null==C?void 0:C.group)?void 0:z.lineDash)?W:void 0,lineCap:"butt",clip:!0,cornerRadius:C.group.cornerRadius}),ta&&"cell"===ta.role||((ta=new n.Z({x:r,y:l,width:c,height:p,lineWidth:null!=(N=null==(Z=null==C?void 0:C.group)?void 0:Z.lineWidth)?N:void 0,fill:null!=(G=null==(j=null==C?void 0:C.group)?void 0:j.fill)?G:void 0,stroke:null!=(U=null==(V=null==C?void 0:C.group)?void 0:V.stroke)?U:void 0,strokeArrayWidth:null!=tp?tp:void 0,strokeArrayColor:null!=(q=null==($=null==C?void 0:C.group)?void 0:$.strokeArrayColor)?q:void 0,cursor:null!=(Q=null==(J=null==C?void 0:C.group)?void 0:J.cursor)?Q:void 0,lineDash:null!=(ti=null==(te=null==C?void 0:C.group)?void 0:te.lineDash)?ti:void 0,lineCap:"butt",clip:!0,cornerRadius:C.group.cornerRadius})).role="cell",ta.col=s,ta.row=d,null==i||i.addCellGroup(ta)),b&&ta.appendChild(b),_){let i;if(v){let e=s,r=d;x&&(e=x.start.col,r=x.start.row),i=t.getCellIcons(e,r)}(0,m.Rd)(ta,i,e,g,"auto"===u,td,tu,"number"==typeof tc?tc:void 0,ta.attribute.width,ta.attribute.height,f,y,t,C,x),(null==(tr=null==C?void 0:C._vtable)?void 0:tr.marked)&&function(t,e,i){if("boolean"==typeof t){let t=(0,K.Q)({x:e.attribute.width,y:0,startAngle:Math.PI/2,endAngle:Math.PI,outerRadius:6,fill:"#3073F2",pickable:!1});t.name="mark",e.appendChild(t)}else{let i,r,n,l,s,a,{bgColor:o="#3073F2",shape:h="sector",position:d="right-top",size:u=10,offset:c=0}=t;if("sector"===h)"right-top"===d?(i=e.attribute.width-c,r=c,n=Math.PI/2,l=Math.PI):"left-top"===d?(i=c,r=c,n=0,l=Math.PI/2):"right-bottom"===d?(i=e.attribute.width-c,r=e.attribute.height-c,n=Math.PI,l=Math.PI/2*3):"left-bottom"===d&&(i=c,r=e.attribute.height-c,n=Math.PI/2*3,l=2*Math.PI),s=o,a=(0,K.Q)({x:i,y:r,startAngle:n,endAngle:l,outerRadius:u,fill:s,pickable:!1});else if("triangle"===h){let t,n,l,h;"right-top"===d?(i=e.attribute.width-c,r=c,t=i-u,n=r,l=i,h=r+u):"left-top"===d?(i=c,r=c,t=i+u,n=r,l=i,h=r+u):"right-bottom"===d?(i=e.attribute.width-c,r=e.attribute.height-c,t=i-u,n=r,l=i,h=r-u):"left-bottom"===d&&(i=c,r=e.attribute.height-c,t=i+u,n=r,l=i,h=r-u),s=o,a=(0,X.p)({points:[{x:i,y:r},{x:t,y:n},{x:l,y:h}],fill:s,pickable:!1})}else"rect"===h&&("right-top"===d?(i=e.attribute.width-u-c,r=c):"left-top"===d?(i=c,r=c):"right-bottom"===d?(i=e.attribute.width-u-c,r=e.attribute.height-u-c):"left-bottom"===d&&(i=c,r=e.attribute.height-u-c),s=o,a=(0,Y.f)({x:i,y:r,width:u,height:u,fill:s,pickable:!1}));a.name="mark",e.appendChild(a)}}(null==(tn=null==C?void 0:C._vtable)?void 0:tn.marked,ta,0)}return b&&ta.setAttributes({width:Math.max(ta.attribute.width,null!=(tl=b.attribute.width)?tl:0),height:Math.max(ta.attribute.height,null!=(ts=b.attribute.height)?ts:0)}),ta}function q(t,e,i,r,l,s,o,h,d,u){var c,p,g,m,y,v;if(t.dependField){let e=(0,f.vi)(t.dependField,{col:s,row:o,table:d,value:r,dataValue:l,cellHeaderPaths:void 0});l=null!=(p=null==(c=d.getCellOriginRecord(s,o))?void 0:c[e])?p:l}let b=null!=(g=(0,f.vi)(t.barType,{col:s,row:o,table:d,value:r,dataValue:l,cellHeaderPaths:void 0}))?g:"default",_=null!=(m=(0,f.vi)(t.min,{col:s,row:o,table:d,value:r,dataValue:l,cellHeaderPaths:void 0}))?m:0,x=null!=(y=(0,f.vi)(t.max,{col:s,row:o,table:d,value:r,dataValue:l,cellHeaderPaths:void 0}))?y:_+100,w=0;if(w=u?d.getRowsHeight(u.start.row,u.end.row):d.getRowHeight(o),d.pluginManager&&d.pluginManager.getPluginByName("Master Detail Plugin")){let t=o-d.columnHeaderLevelCount,e=d.internalProps,i=null==(v=null==e?void 0:e.originalRowHeights)?void 0:v.get(t);void 0!==i&&i>0&&(w=i)}let S=i,A=w,M=0;(0,C.Z)(d.theme._contentOffset)&&(M=d.theme._contentOffset);let T=new n.Z({x:-M,y:-M,width:S,height:A});T.name="progress-bar";let{showBar:k,barColor:R,barBgColor:P,barPositiveColor:I,barNegativeColor:E,barAxisColor:L,barRightToLeft:F,showBarMark:O,barMarkPositiveColor:H,barMarkNegativeColor:D,barMarkWidth:z,barMarkPosition:W,barMarkInBar:Z}=e,{barHeight:N,barBottom:j,barPadding:V}=e;1===V.length?V=[V[0],V[0],V[0],V[0]]:2===V.length?V=[V[0],V[1],V[0],V[1]]:3===V.length&&(V=[V[0],V[1],V[2],V[1]]),V=V.map((t,e)=>{if("string"==typeof t&&f.Bd.endsWith(t,"%")){let r=Number(t.substr(0,t.length-1));return 0===e||2===e?w*r/100:i*r/100}return Number(t)});let U=(0,G.u)((0,a.WJ)("borderLineWidth",e,s,o,d)),K=Math.max(V[0],Math.ceil(U[0]/2)),X=Math.max(V[1],Math.floor(U[1]/2)),$=Math.max(V[2],Math.floor(U[2]/2)),q=Math.max(V[3],Math.ceil(U[3]/2));O&&z>0&&"right"===W&&!1===Z&&(X+=z,q+=z),S-=X+q,A-=$+K,o===d.rowCount-1&&[0,"0"].includes(j)&&(A-=1);let J=q,Q=S;if(N="string"==typeof N&&f.Bd.endsWith(N,"%")?A*(N=Number(N.substr(0,N.length-1)))/100:Number(N),j="string"==typeof j&&f.Bd.endsWith(j,"%")?A*(j=Number(j.substr(0,j.length-1)))/100:Number(j),(0,f.vi)(k,{col:s,row:o,table:d,context:null,value:r,dataValue:l})){let t=`${l}`;f.Bd.endsWith(t,"%")&&(t=t.substr(0,t.length-1));let e=Number(t);if(isNaN(e))return T;if("default"===(null!=b?b:"default")){let t=e<_?0:e>x?1:(e-_)/(x-_),i=S,n=K+A-N-j,a=Math.min(i*t,i),h=F?J+Q-a:J;s!==d.colCount-1||1!==t||F||(a-=1);let u=(0,f.vi)(P,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:t});if(u){let t=(0,Y.f)({x:h,y:n,width:i,height:N,fill:u});T.addChild(t)}let c=(0,f.vi)(R,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:t})||"#20a8d8",p=(0,Y.f)({x:h,y:n,width:a,height:N,fill:c});T.addChild(p)}else if("negative"===b){let t=_<0?-_:0,i=x>0?x:0,n=t/(t+i),a=1-n,h=e>0?e/i:0,u=e<0?-e/t:0,c=S,p=K+A-N-j,g=(0,f.vi)(P,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:h});if(g){let t=(0,Y.f)({x:J,y:p,width:c,height:N,fill:g});T.addChild(t)}let m=F?a*c:n*c,y=Math.min(c*n*u,c),v=F?{left:J+m,top:p,width:y,height:N}:{left:J+m-y,top:p,width:y,height:N},b=(0,f.vi)(E,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:u})||"#20a8d8",C=(0,Y.f)({x:v.left,y:v.top,width:v.width,height:v.height,fill:b});T.addChild(C);let M=Math.min(c*a*h,c);s!==d.colCount-1||1!==h||F||(M-=1);let k=F?{left:J+m-M,top:p,width:M,height:N}:{left:J+m,top:p,width:M,height:N},R=(0,f.vi)(I,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:h})||"#20a8d8",G=(0,Y.f)({x:k.left,y:k.top,width:k.width,height:k.height,fill:R});T.addChild(G);let V=F?v.left:k.left,U=(0,f.vi)(L,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:h}),X=(0,B.W)({x:0,y:0,stroke:U,lineWidth:1,lineDash:[2,2],points:[{x:V,y:0},{x:V,y:w}]});if(T.addChild(X),O&&(h||u)){let t,e=[];if(h>0)if(t=(0,f.vi)(H,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:h})||"#20a8d8","right"===W){let t=F?k.left+z/2:k.left+k.width+(Z?-z/2:z/2);e.push({x:t,y:k.top}),e.push({x:t,y:k.top+k.height})}else"bottom"===W&&(e.push({x:k.left,y:k.top+k.height-z/2}),e.push({x:k.left+k.width,y:k.top+k.height-z/2}));else if(u>0)if(t=(0,f.vi)(D,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:u})||"#20a8d8","right"===W){let t=F?v.left+v.width-z/2:v.left+z/2;e.push({x:t,y:v.top}),e.push({x:t,y:v.top+v.height})}else"bottom"===W&&(e.push({x:v.left,y:v.top+v.height-z/2}),e.push({x:v.left+v.width,y:v.top+v.height-z/2}));let i=(0,B.W)({x:0,y:0,stroke:t,lineWidth:z,points:e});T.addChild(i)}}else if("negative_no_axis"===b){let t,i=Math.max(_<0?-_:0,x>0?x:0),n=0===i?0:Math.abs(e)/i,a=S,h=Math.min(a*n,a);s!==d.colCount-1||1!==n||F||(h-=1);let u=K+A-N-j,c=F?J+Q-h:J,p=(0,f.vi)(P,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:n});if(p){let t=(0,Y.f)({x:c,y:u,width:a,height:N,fill:p});T.addChild(t)}let g={left:c,top:u,width:h,height:N};t=e>=0?(0,f.vi)(I,{col:s,row:o,table:d,context:null,value:r,percentile:n,dataValue:l})||"#20a8d8":(0,f.vi)(E,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:n})||"#20a8d8";let m=(0,Y.f)({x:g.left,y:g.top,width:g.width,height:g.height,fill:t});if(T.addChild(m),O&&e){let t,i=[];if(t=e>=0?(0,f.vi)(H,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:n})||"#20a8d8":(0,f.vi)(D,{col:s,row:o,table:d,context:null,value:r,dataValue:l,percentile:n})||"#20a8d8","right"===W){let t=F?g.left+z/2:g.left+g.width-z/2;i.push({x:t,y:g.top}),i.push({x:t,y:g.top+g.height})}else"bottom"===W&&(i.push({x:g.left,y:g.top+g.height-z/2}),i.push({x:g.left+g.width,y:g.top+g.height-z/2}));let a=(0,B.W)({x:0,y:0,stroke:t,lineWidth:z,points:i});T.addChild(a)}}}return T}var J=i(65880),Q=i(1466),te=i(96241),ti=i(54326),tr=i(27781);function tn(t,e,i,r,n,l){var s,a,h,d,u,c,p,g,f,m,y,v,b,_,x,w,S,A;let M,T;if((null==i?void 0:i.zero)&&(t=Math.min(t,0),e=Math.max(e,0)),null==i?void 0:i.expand){let r=t,n=e;(0,o.Z)(i.expand.min)&&(t=r-(n-r)*i.expand.min),(0,o.Z)(i.expand.max)&&(e=n+(n-r)*i.expand.max)}if((0,C.Z)(null==i?void 0:i.min)&&(t=i.min),(0,C.Z)(null==i?void 0:i.max)&&(e=i.max),"log"===(null==i?void 0:i.type)?(M=new J.Y).base(null!=(s=null==i?void 0:i.base)?s:10):"symlog"===(null==i?void 0:i.type)?(M=new Q.g).constant(null!=(a=null==i?void 0:i.constant)?a:10):M=new E.f,M.domain([t,e],!!(null==i?void 0:i.nice)),l){S=M,A=l,S.niceMax(A.targetTicks.length)}else if(null==i?void 0:i.nice){let t=null!=(c=null!=(d=null==(h=i.tick)?void 0:h.forceTickCount)?d:null==(u=i.tick)?void 0:u.tickCount)?c:10;(0,te.Z)(t)&&(t=t({axisLength:n,labelStyle:null!=(g=null==(p=null==i?void 0:i.label)?void 0:p.style)?g:{fontSize:tr.Zu.LABEL_FONT_SIZE}})),"accurateFirst"===i.niceType&&(t=Math.max(10,t)),(0,ti.Z)(i.min)&&(0,ti.Z)(i.max)?M.nice(t):(0,o.Z)(i.min)&&(0,ti.Z)(i.max)?M.niceMax(t):(0,ti.Z)(i.min)&&(0,o.Z)(i.max)&&M.niceMin(t)}return delete M._niceType,T=(null!=(m=null==(f=null==l?void 0:l.targetTicks)?void 0:f.length)?m:null==(y=null==i?void 0:i.tick)?void 0:y.forceTickCount)?M.forceTicks(null!=(b=null==(v=null==l?void 0:l.targetTicks)?void 0:v.length)?b:null==(_=null==i?void 0:i.tick)?void 0:_.forceTickCount):M.ticks((0,C.Z)(null==(x=null==i?void 0:i.tick)?void 0:x.tickCount)?i.tick.tickCount:5,{noDecimals:null==(w=null==i?void 0:i.tick)?void 0:w.noDecimals}),{range:M.domain(),ticks:T}}var tl=i(59417);function ts(t,e,i,r,l,s,o,d,u,c,p,y,v,b,_,C,x,w){var S,A,M,T,k,R,P,B,I,E,L,F,O,H,D,z,W,Z,N,j,G,V,U,K;let X;if(!t){let a=(0,h.d)(l,s,_,b);w&&(t=b.scenegraph.highPerformanceGetCell(l,s,!0))&&"cell"===t.role&&t.setAttributes({x:i,y:r,width:d,height:u,lineWidth:null!=(A=null==(S=null==_?void 0:_.group)?void 0:S.lineWidth)?A:void 0,fill:null!=(T=null==(M=null==_?void 0:_.group)?void 0:M.fill)?T:void 0,stroke:null!=(R=null==(k=null==_?void 0:_.group)?void 0:k.stroke)?R:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(B=null==(P=null==_?void 0:_.group)?void 0:P.strokeArrayColor)?B:void 0,cursor:null!=(E=null==(I=null==_?void 0:_.group)?void 0:I.cursor)?E:void 0,lineDash:null!=(F=null==(L=null==_?void 0:_.group)?void 0:L.lineDash)?F:void 0,lineCap:"butt",clip:!0,cornerRadius:_.group.cornerRadius}),t&&"cell"===t.role||((t=new n.Z({x:i,y:r,width:d,height:u,lineWidth:null!=(H=null==(O=null==_?void 0:_.group)?void 0:O.lineWidth)?H:void 0,fill:null!=(z=null==(D=null==_?void 0:_.group)?void 0:D.fill)?z:void 0,stroke:null!=(Z=null==(W=null==_?void 0:_.group)?void 0:W.stroke)?Z:void 0,strokeArrayWidth:a,strokeArrayColor:null!=(j=null==(N=null==_?void 0:_.group)?void 0:N.strokeArrayColor)?j:void 0,cursor:null!=(V=null==(G=null==_?void 0:_.group)?void 0:G.cursor)?V:void 0,lineDash:null!=(K=null==(U=null==_?void 0:_.group)?void 0:U.lineDash)?K:void 0,lineCap:"butt",clip:!0,cornerRadius:_.group.cornerRadius})).role="cell",t.col=l,t.row=s,null==e||e.addCellGroup(t))}if(v){let t=l,e=s;x&&(t=x.start.col,e=x.start.row),X=b.getCellIcons(t,e)}let Y=0,$=0;if(Array.isArray(X)&&0!==X.length){let{leftIconWidth:e,rightIconWidth:i,absoluteLeftIconWidth:r,absoluteRightIconWidth:n}=(0,m.M4)(X,t,x,b);Y=e+i,$=e,t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+c[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+d-i-c[1]):"icon-absolute-right"===t.role&&t.setAttribute("x",t.attribute.x+d-n-c[1])}),t.forEachChildren(t=>{"middle"===y?t.setAttribute("y",(u-t.AABBBounds.height())/2):"bottom"===y?t.setAttribute("y",u-t.AABBBounds.height()-c[2]):t.setAttribute("y",c[0])})}let q=function(t,e,i,r,n,l,s,o,h){var d,u;let c=h._getCellStyle(t,e),p=(0,a.WJ)("buttonColor",c,t,e,h),m=(0,a.WJ)("buttonBorderColor",c,t,e,h),y=(0,a.WJ)("buttonLineWidth",c,t,e,h),v=(0,a.WJ)("buttonBorderRadius",c,t,e,h),b=(0,a.WJ)("buttonHoverColor",c,t,e,h),_=(0,a.WJ)("buttonHoverBorderColor",c,t,e,h),C=(0,a.WJ)("buttonPadding",c,t,e,h),x=(0,a.WJ)("buttonTextHoverColor",c,t,e,h),w=(0,a.WJ)("buttonDisableColor",c,t,e,h),S=(0,a.WJ)("buttonDisableBorderColor",c,t,e,h),A=(0,a.WJ)("buttonTextDisableColor",c,t,e,h),M=h.getCellValue(t,e),T=h.getCellOriginValue(t,e),k=(0,g.L)(t,e,h),R=h._getCellStyle(t,e),P=null!=(d=R.autoWrapText)?d:h.internalProps.autoWrapText,{lineClamp:B}=R,I=h.isAutoRowHeight(e),{disable:E,text:L}=o,F=(0,f.vi)(E,{col:t,row:e,table:h,context:null,value:M,dataValue:T}),O=(0,f.vi)(L,{col:t,row:e,table:h,context:null,value:M,dataValue:T}),H=null!=(u=null!=O?O:M)?u:"",D={maxLineWidth:"auto"===i?1/0:r-(l[1]+l[3]+k),textAlign:"left",textBaseline:"top",autoWrapText:P,lineClamp:B,wordBreak:"break-word",heightLimit:I?-1:n-Math.floor(l[0]+l[2]),pickable:!1,dx:k,whiteSpace:1!==H.length||P?"normal":"no-wrap"},z=s.text?Object.assign({},s.text,D):D,W={x:0,y:0,cursor:F?"not-allowed":"pointer",disable:F,childrenPickable:!1,text:1===H.length?H[0]:H,textStyle:z,padding:C,panel:{visible:!0,fill:F?w:p,stroke:F?S:m,lineWidth:y,cornerRadius:v},state:{text:{hover:{}},panel:{hover:{fill:b,stroke:_}}}};A&&(W.state.text.fill=A),x&&(W.state.text.hover.fill=x);let Z=new tl.V(W);return Z.name="button",F||(Z.addEventListener("mouseenter",()=>{Z.addState("hover",!0,!1),Z.stage.renderNextFrame()}),Z.addEventListener("mouseleave",()=>{Z.removeState("hover",!1),Z.stage.renderNextFrame()})),Z}(l,s,o-Y,d,u,c,_,C,b);return q&&t.appendChild(q),d-=c[1]+c[3]+Y,u-=c[0]+c[2],"center"===p?q.setAttribute("x",c[3]+$+(d-q.AABBBounds.width())/2):"right"===p?q.setAttribute("x",c[3]+$+d-q.AABBBounds.width()):q.setAttribute("x",c[3]+$),"middle"===y?q.setAttribute("y",c[0]+(u-q.AABBBounds.height())/2):"bottom"===y?q.setAttribute("y",c[0]+u-q.AABBBounds.height()):q.setAttribute("y",c[0]),t}let ta=()=>{r.F.registerFunction("createChartCellGroup",d),r.F.registerFunction("getAxisDomainRangeAndLabels",tn)},to=()=>{r.F.registerFunction("createCheckboxCellGroup",b)},th=()=>{r.F.registerFunction("createImageCellGroup",_.Ui)},td=()=>{r.F.registerFunction("createProgressBarCell",q)},tu=()=>{r.F.registerFunction("createRadioCellGroup",M)},tc=()=>{r.F.registerFunction("createSwitchCellGroup",R)},tp=()=>{r.F.registerFunction("createButtonCellGroup",ts)},tg=()=>{r.F.registerFunction("createSparkLineCellGroup",O)},tf=()=>{r.F.registerFunction("createTextCellGroup",$)},tm=()=>{r.F.registerFunction("createVideoCellGroup",U)}},39909:function(t,e,i){i.d(e,{al:()=>v,j8:()=>_,rj:()=>y});var r=i(72281),n=i(34672),l=i(74577),s=i(32802),a=i(31877),o=i(64776),h=i(96241),d=i(80971),u=i(95723),c=i(4654),p=i(73501),g=i(42515),f=i(30497),m=i(23975);function y(t,e,i,r){var n,l,s,a,o,h,d,u,c,p;t.internalProps.columnWidthConfig&&(c=t,p=t.internalProps.columnWidthConfig,c.isPivotTable()?function(t,e){for(let i=0;i<(null==e?void 0:e.length);i++){let r=e[i],n=r.dimensions,l=r.width,s=t.getCellAddressByHeaderPaths(n);if(s&&s.col>=t.rowHeaderLevelCount){let e=t.getCellHeaderPaths(s.col,t.columnHeaderLevelCount);if(e.colHeaderPaths.length===n.length){let i=!0;for(let t=0;t<n.length;t++){let r=n[t];if(0>e.colHeaderPaths.findIndex((t,e)=>t.indicatorKey===r.indicatorKey||t.dimensionKey===r.dimensionKey&&t.value===r.value)){i=!1;break}}i&&!t.internalProps._widthResizedColMap.has(s.col)&&(t._setColWidth(s.col,l),t.internalProps._widthResizedColMap.add(s.col))}}else s&&s.col<t.rowHeaderLevelCount&&(t.internalProps._widthResizedColMap.has(s.col)||(t._setColWidth(s.col,l),t.internalProps._widthResizedColMap.add(s.col)))}}(c,p):c.isListTable()&&function(t,e){for(let i=0;i<(null==e?void 0:e.length);i++){let r=e[i],n=r.key,l=r.width,s=t.internalProps.layoutMap.getColumnByKey(n);if(s.columnDefine){let{col:e}=s;t.internalProps._widthResizedColMap.has(e)||(t._setColWidth(e,l),t.internalProps._widthResizedColMap.add(e))}}}(c,p)),t.isPivotTable()&&t.internalProps.columnWidthConfigForRowHeader&&function(t,e){for(let i=0;i<(null==e?void 0:e.length);i++){let r=e[i],n=r.dimensions,l=r.width,s=t.getCellAddressByHeaderPaths(n);s&&s.col<t.rowHeaderLevelCount&&(t.internalProps._widthResizedColMap.has(s.col)||(t._setColWidth(s.col,l),t.internalProps._widthResizedColMap.add(s.col)))}}(t,t.internalProps.columnWidthConfigForRowHeader),e=null!=e?e:0,i=null!=i?i:t.colCount-1,0===e&&i===t.colCount-1&&t._clearColRangeWidthsMap();let g=t.internalProps.layoutMap;t.isPivotTable()&&(g.enableUseGetBodyCache(),g.enableUseHeaderPathCache());let f=[],m=[];if(r)for(let e=0;e<t.colCount;e++)f[e]=t.getColWidth(e);for(let o=e;o<=i;o++){let e;if(!t.internalProps.transpose&&("only-header"===(null==(l=null==(n=t.internalProps.layoutMap.columnObjects)?void 0:n[o])?void 0:l.columnWidthComputeMode)||"only-header"===t.columnWidthComputeMode)&&"showHeader"in t.internalProps.layoutMap){let i=t.internalProps.layoutMap.showHeader;t.internalProps.layoutMap.showHeader=!0,e=v(o,0,t.internalProps.layoutMap.headerLevelCount-1,t),t.internalProps.layoutMap.showHeader=i}else e=t.internalProps.transpose||"only-body"!==(null==(a=null==(s=t.internalProps.layoutMap.columnObjects)?void 0:s[o])?void 0:a.columnWidthComputeMode)&&"only-body"!==t.columnWidthComputeMode?v(o,0,t.rowCount-1,t):v(o,t.internalProps.layoutMap.getBodyRange().start.row,t.internalProps.layoutMap.getBodyRange().end.row,t);t._setColContentWidth(o,e),t.getColWidth(o)!==e&&t._clearColRangeWidthsMap(o),r?m[o]=Math.round(t._adjustColWidth(o,e)):t._setColWidth(o,t._adjustColWidth(o,e),!1,!0)}if("adaptive"===t.widthMode){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,i=0,n=0,l=t.colCount;if("only-body"===t.widthAdaptiveMode){for(let e=0;e<t.colCount;e++){let n=r&&null!=(o=m[e])?o:t.getColWidth(e);(e<t.rowHeaderLevelCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(i+=n)}n=t.rowHeaderLevelCount,l=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount}_(e-i,n,l,r,m,t)}else if(t.autoFillWidth){t._clearColRangeWidthsMap();let e=t.tableNoFrameWidth,i=0,n=0;for(let e=0;e<t.colCount;e++){let l=r&&null!=(h=m[e])?h:t.getColWidth(e);"only-body"===t.widthAdaptiveMode&&(e<t.rowHeaderLevelCount+t.leftRowSeriesNumberCount||t.isPivotChart()&&e>=t.colCount-t.rightFrozenColCount)&&(i+=l),n+=l}if(n<e&&n>i){let n=0,l=t.colCount;"only-body"===t.widthAdaptiveMode&&(n=t.rowHeaderLevelCount+t.leftRowSeriesNumberCount,l=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount),_(e-i,n,l,r,m,t)}}if(r){for(let e=0;e<t.colCount;e++){let i=null!=(u=null!=(d=m[e])?d:t.getColWidth(e))?u:t.getColWidth(e);i!==f[e]&&t._setColWidth(e,i,!1,!0)}t.stateManager.checkFrozen();for(let e=0;e<t.colCount;e++){let i=t.getColWidth(e);i!==f[e]&&t.scenegraph.updateColWidth(e,i-f[e],!0,!0)}t.scenegraph.updateContainer({async:!0})}t.isPivotTable()&&(g.disableUseGetBodyCache(),g.disableUseHeaderPathCache())}function v(t,e,i,r,n=!1){let l=function(t,e){let i=e.getColWidthDefined(t);return e.internalProps._widthResizedColMap.has(t)?e.getColWidth(t):i}(t,r);return r.internalProps.transpose&&"auto"===l&&("only-header"===r.columnWidthComputeMode&&t>=r.rowHeaderLevelCount||"only-body"===r.columnWidthComputeMode&&t<r.rowHeaderLevelCount)&&(l=r.getDefaultColumnWidth(t)),n&&!r.internalProps.transpose?b(l,t,e,i,n,r):"number"==typeof l?l:"auto"!==l&&"string"==typeof l?r._adjustColWidth(t,r._colWidthDefineToPxWidth(l)):b(l,t,e,i,n,r)}function b(t,e,i,y,v,b){var _,C,x,w,S;let A=0,M=1,T=1;if(y-i>5e3&&(T=Math.ceil((y-i)/5e3)),b.isPivotChart()&&e>=b.rowHeaderLevelCount&&e<b.colCount-b.rightFrozenColCount){if(b.internalProps.layoutMap.indicatorsAsCol)return b.defaultColWidth;{let t=!1;"heatmap"===b.internalProps.layoutMap.getChartSpec(e,b.columnHeaderLevelCount).type&&(t=!0);let i=b.internalProps.layoutMap.getOptimunWidthForChart(e,t);if(i>0)return i}}for(let k=i;k<=y;k+=M){if(b.isPivotChart()){let t=b.internalProps.layoutMap,i=t.getAxisConfigInPivotChart(e,k);if(i){let t=a.F.getFunction("computeAxisComponentWidth")(i,b);if("number"==typeof t){A=Math.max(t,A);continue}}else if(t.isLeftBottomCorner(e,k)||t.isRightTopCorner(e,k)||t.isRightBottomCorner(e,k)||t.isAxisCell(e,k))continue}let i=function(t,e,i){var r,n,a,o,d,u,c,g,m,y;let v=i.getCustomRender(t,e),b=i.getCustomLayout(t,e);if(v||b){let _,C=1,x=0,w=!1,S=!1;(i.isHeader(t,e)||(null==(r=i.getBodyColumnDefine(t,e))?void 0:r.mergeCell)||i.hasCustomMerge())&&(C=(_=i.getCellRange(t,e)).end.col-_.start.col+1);let A={col:null!=(n=null==_?void 0:_.start.col)?n:t,row:null!=(a=null==_?void 0:_.start.row)?a:e,dataValue:i.getCellOriginValue(t,e),value:i.getCellValue(t,e)||"",rect:(g=t,m=e,{left:0,top:0,right:(y=i).getColWidth(g),bottom:y.getRowHeight(m),width:null,height:null}),table:i,originCol:t,originRow:e,forComputation:!0};if("react-custom-layout"===b&&(b=(null==(o=i.reactCustomLayout)?void 0:o.getCustomLayoutFunc(t,e))||f.D),(0,h.Z)(b)){let t=b(A);if(t.rootContainer){t.rootContainer=(0,p.nH)(t.rootContainer),(0,p.Jp)(t.rootContainer,0,i.getRowHeight(e));let r=t.rootContainer.attribute.width;t.rootContainer.setStage(i.scenegraph.stage),x=r>0?r:null!=(d=t.rootContainer.AABBBounds.width())?d:0,w=t.renderDefault,S=t.enableCellPadding}else x=0,w=t.renderDefault,S=t.enableCellPadding}else if("function"==typeof v){let t=v(A);x=null!=(u=null==t?void 0:t.expectedWidth)?u:0,w=null==t?void 0:t.renderDefault}else x=null!=(c=null==v?void 0:v.expectedWidth)?c:0,w=null==v?void 0:v.renderDefault;if(x=Math.ceil(x),S){let r=i._getCellStyle(t,e),n=(0,l.u)((0,s.WJ)("padding",r,t,e,i));x+=n[1]+n[3]}return{width:x/C,renderDefault:w}}}(e,k,b);if(i&&(A=Math.max(i.width,A),!i.renderDefault))continue;if("number"==typeof t&&"standard"===b.widthMode&&!v){A=Math.max(t,A);continue}let y=b.isHeader(e,k)?null==(_=b._getHeaderLayoutMap(e,k))?void 0:_.headerType:b.getBodyColumnType(e,k);if((0,o.Z)(y)&&"text"!==y&&"link"!==y&&"progressbar"!==y&&"checkbox"!==y&&"radio"!==y&&"switch"!==y&&"button"!==y){A=Math.max(A,b.getColWidthDefinedNumber(e)||0);continue}let R=0,P=b.internalProps.layoutMap;if(P.isHeader(e,k)){let t=P.getHeader(e,k);if("only-body"===(null==(C=null==t?void 0:t.define)?void 0:C.columnWidthComputeMode))continue;(0,o.Z)(null==t?void 0:t.hierarchyLevel)&&(R=(null!=(x=t.hierarchyLevel)?x:0)*("tree"===P.rowHierarchyType&&null!=(w=P.rowHierarchyIndent)?w:0),P.rowHierarchyTextStartAlignment&&!b.internalProps.headerHelper.getHierarchyIcon(e,k)&&(R+=b.internalProps.headerHelper.getHierarchyIconWidth()))}else if(b.isListTable()){M=T;let t=b.getBodyColumnDefine(e,k);if(null==t?void 0:t.tree){let t=b.dataSource.getIndexKey(b.getRecordShowIndexByCell(e,k));R=Array.isArray(t)&&b.getHierarchyState(e,k)!==r.g.none?(t.length-1)*(null!=(S=P.hierarchyIndent)?S:0):0,P.hierarchyTextStartAlignment&&!b.internalProps.bodyHelper.getHierarchyIcon(e,k)&&(R+=b.internalProps.headerHelper.getHierarchyIconWidth())}}A=Math.max(function(t,e,i,r){var a,o,h,p;let f,y=0,v=r.getCellValue(t,e),b=r._getCellStyle(t,e),_=0,C=!1;if("body"!==r.getCellLocation(t,e))C=!0;else{let i=r.getBodyColumnDefine(t,e);C=!!(null==i?void 0:i.icon)||!!(null==i?void 0:i.tree)||(null==i?void 0:i.dragOrder)}if(C){let i=r.getCellIcons(t,e);null==i||i.forEach(t=>{var e,i,r;t.positionType!==n.q0.absoluteRight&&(_+=(null!=(e=t.width)?e:0)+(null!=(i=t.marginLeft)?i:0)+(null!=(r=t.marginRight)?r:0))})}let x=1;if(r.isHeader(t,e)||(null==(a=r.getBodyColumnDefine(t,e))?void 0:a.mergeCell)||r.hasCustomMerge()){let i=r.getCellRange(t,e);x=i.end.col-i.start.col+1}let w=(0,l.u)((0,s.WJ)("padding",b,t,e,r)),S=w[1]+w[3],A=(0,s.WJ)("fontSize",b,t,e,r),M=(0,s.WJ)("fontFamily",b,t,e,r),T=(0,s.WJ)("fontWeight",b,t,e,r);if("checkbox"===i)f=(0,d.Z)(v)?v.text:v;else if("radio"===i)if((0,u.Z)(v)){f="";let i=r.getBodyColumnDefine(t,e),n=null!=(o=null==i?void 0:i.radioDirectionInCell)?o:"vertical";"vertical"===n?v.forEach(t=>{f+=((0,d.Z)(t)?t.text:t).toString()+"\n"}):"horizontal"===n&&v.forEach(t=>{f+=((0,d.Z)(t)?t.text:t).toString()})}else f=(0,d.Z)(v)?v.text:v;else if("button"===i){let i=r.getBodyColumnDefine(t,e),n=(0,m.vi)(i.text,{col:t,row:e,table:r,context:null,value:v,dataValue:r.getCellOriginValue(t,e)});f=null!=(h=null!=n?n:v)?h:""}else f=v;let k=(0,g.$)(f,r).text;if(k.length>=1&&(1!==k.length||""!==k[0])?k.forEach(t=>{y=Math.max((r.measureText(t,{fontSize:A,fontFamily:M,fontWeight:T}).width+S+4+_)/x,y)}):y=Math.max((S+4+_)/x,y),!1!==r.internalProps.limitMaxAutoWidth&&(y=Math.min("number"==typeof r.internalProps.limitMaxAutoWidth?r.internalProps.limitMaxAutoWidth:450,y)),"checkbox"===i){let i=(0,s.WJ)("size",b,t,e,r);if(y+=i,f){let i=(0,s.WJ)("spaceBetweenTextAndIcon",b,t,e,r);y+=i}}else if("radio"===i){let i=(0,s.WJ)("size",b,t,e,r),n=(0,s.WJ)("outerRadius",b,t,e,r),l=(0,c.Z)(n)?2*n:i,a=(0,s.WJ)("spaceBetweenTextAndIcon",b,t,e,r);if((0,u.Z)(v)){let i=r.getBodyColumnDefine(t,e),n=(0,s.WJ)("spaceBetweenRadio",b,t,e,r),o=null!=(p=null==i?void 0:i.radioDirectionInCell)?p:"vertical";"vertical"===o?(y+=l,y+=a):"horizontal"===o&&(y+=(l+a)*v.length,y+=n*(v.length-1))}else y+=l,f&&(y+=a)}else if("switch"===i)y=(0,s.WJ)("boxWidth",b,t,e,r);else if("button"===i){let i=(0,s.WJ)("buttonPadding",b,t,e,r);y+=2*i}return y}(e,k,y,b)+R,A),M>1&&b.bottomFrozenRowCount>0&&k<b.rowCount-b.bottomFrozenRowCount&&k+M>=b.rowCount-b.bottomFrozenRowCount&&(k=b.rowCount-b.bottomFrozenRowCount-M,M=1,T=1)}let k=b.getMinColWidth(e),R=b.getMaxColWidth(e);return A<k?k:A>R?R:(A<=0&&(A=b.defaultColWidth),A)}function _(t,e,i,r,n,l,s){var a,o,h,d;let u=0,c=[],p=[],g=0,f=new Map,m=new Map;for(let t=e;t<i;t++){let e=r&&null!=(a=n[t])?a:l.getColWidth(t),i=l.getMaxColWidth(t),s=l.getMinColWidth(t);u+=e,c.push(t),i===e?f.set(t,e):s===e&&m.set(t,e),(null==(o=l.options.customConfig)?void 0:o.shrinkSparklineFirst)&&"sparkline"===l.getBodyColumnType(t,0)&&(p.push({col:t,width:e}),g+=e-l.defaultColWidth)}if(u>t)for(let[e,i]of m){t-=i,u-=i;let r=c.indexOf(e);-1!==r&&c.splice(r,1)}else if(u<t)for(let[e,i]of f){t-=i,u-=i;let r=c.indexOf(e);-1!==r&&c.splice(r,1)}let y=t/u;if((null==(h=l.options.customConfig)?void 0:h.shrinkSparklineFirst)&&y<1&&u-t<g)for(let e=0;e<p.length;e++){let{col:i,width:a}=p[e],o=Math.floor(a-(u-t)/p.length);r?n[i]=l._adjustColWidth(i,o):s?l.scenegraph.setColWidth(i,l._adjustColWidth(i,o)):l._setColWidth(i,l._adjustColWidth(i,o),!1,!0)}else for(let e=0;e<c.length;e++){let i,a=c[e];i=e===c.length-1?t-c.reduce((t,e,i)=>{var s;return e!==a?t+(r?null!=(s=n[e])?s:l.getColWidth(a):l.getColWidth(e)):t},0):Math.round((r&&null!=(d=n[a])?d:l.getColWidth(a))*y),r?n[a]=l._adjustColWidth(a,i):s?l.scenegraph.setColWidth(a,l._adjustColWidth(a,i)):l._setColWidth(a,l._adjustColWidth(a,i),!1,!0)}}},6254:function(t,e,i){i.d(e,{P:()=>P,Y:()=>R});var r=i(47634),n=i(34672),l=i(32802),s=i(74577),a=i(95954),o=i(31877),h=i(95723),d=i(64776),u=i(4654),c=i(96241),p=i(73501),g=i(24825),f=i(71994),m=i(80971),y=i(6958),v=i(43064),b=i(36637),_=i(59417);let C=new v.J({}),x=new b.Y({}),w=new _.V({});function S(t,e,i,r,n,s,a,o,h,d,c,p,g,f,v){let b=(0,m.Z)(t)?t.text:t,_=(0,y.cw)(b).split("\n")||[],C=v.getColsWidth(e,r),w=(0,l.WJ)("size",n,e,i,v),S=(0,l.WJ)("outerRadius",n,e,i,v),A=(0,u.Z)(S)?2*S:w,M=0;if(s){let t=(0,l.WJ)("spaceBetweenTextAndIcon",n,e,i,v),r=C-(f[1]+f[3])-a-A-t;(0,u.Z)(S)||(S=Math.round(w/2)),x.setAttributes({text:{maxLineWidth:r,text:_,fontSize:o,fontStyle:h,fontWeight:d,fontFamily:c,lineHeight:p,wordBreak:"break-word",lineClamp:g},circle:{outerRadius:S},spaceBetweenTextAndIcon:t}),x.render(),M=x.AABBBounds.height()}else M=Math.max(w,_.length*p);return M}var A=i(61389),M=i(42515),T=i(30497);let k=new r.H({width:0,height:0,textConfig:[]});function R(t,e,i,r=!0,n){var l,s,a,o,u,c,p,f,m,y,v;let b=[],_=[];if(n)for(let r=e;r<=i;r++)b[r]=t.getRowHeight(r);let C=t.internalProps.layoutMap;t.isPivotTable()&&(C.enableUseGetBodyCache(),C.enableUseHeaderPathCache()),t.defaultHeaderRowHeight,t.defaultHeaderColWidth;let x="auto"===t.defaultHeaderRowHeight||(0,h.Z)(t.defaultHeaderRowHeight)&&t.defaultHeaderRowHeight.some(t=>"auto"===t),w=t.isAutoRowHeight(e)||"adaptive"===t.heightMode&&!1!==t.options.autoHeightInAdaptiveMode,S="auto"===t.options.defaultRowHeight;if(w||x||S){e=null!=e?e:0,i=null!=i?i:t.rowCount-1,(0===e&&i===t.rowCount-1||r)&&t._clearRowRangeHeightsMap();for(let i=e;i<t.columnHeaderLevelCount;i++){let e=0,r=t.colCount-1;if((t.isPivotTable()&&!t.isPivotChart()||t.isPivotChart()&&!t.internalProps.layoutMap.indicatorsAsCol)&&function(t,e){var i,r,n;let{layoutMap:l}=t.internalProps;if(t.internalProps.autoWrapText&&(t.isAutoRowHeight(e)||"adaptive"===t.options.heightMode))return!1;let s=l.getHeader(t.rowHeaderLevelCount,e);if("function"==typeof s.style||"function"==typeof s.icons||(null==(i=s.define)?void 0:i.headerCustomRender)||(null==(r=s.define)?void 0:r.headerCustomLayout)||"function"==typeof(null==(n=s.define)?void 0:n.icon))return!1;let a=t._getCellStyle(t.rowHeaderLevelCount,e);return"function"!=typeof a.padding&&"function"!=typeof a.fontSize&&"function"!=typeof a.lineHeight&&!0!==a.autoWrapText}(t,i)&&!(0,g.Z)(t,t.rowHeaderLevelCount,i)&&(e=0,r=t.rowHeaderLevelCount),w||"auto"===t.getDefaultRowHeight(i)){let l=P(i,e,r,t);_[i]=Math.round(l),"only-body"!==t.heightAdaptiveMode&&n||t._setRowHeight(i,l)}}for(let e=t.rowCount-t.bottomFrozenRowCount;e<=i;e++)if(w||"auto"===t.getDefaultRowHeight(e)){let i=P(e,0,t.colCount-1,t);n?_[e]=Math.round(i):t._setRowHeight(e,i)}if(!(i<t.columnHeaderLevelCount)&&(w||S))if(t.internalProps.transpose||t.isPivotTable()&&!t.internalProps.layoutMap.indicatorsAsCol||t.options.customComputeRowHeight||t.options.rowHeightConfig||!function(t,e){var i,r,n;let{layoutMap:l}=t.internalProps,s=t.columnHeaderLevelCount;if((t.internalProps.autoWrapText||t.internalProps.enableLineBreak||t.isPivotChart())&&(t.isAutoRowHeight(e)||"adaptive"===t.options.heightMode))return!1;for(let e=0;e<t.colCount;e++){let a=l.getBody(e,s);if("radio"===a.cellType||"function"==typeof a.style||"function"==typeof a.icon||(null==(i=a.define)?void 0:i.customRender)||(null==(r=a.define)?void 0:r.customLayout)||"function"==typeof(null==(n=a.define)?void 0:n.icon))return!1;let o=t._getCellStyle(e,s);if("function"==typeof o.padding||"function"==typeof o.fontSize||"function"==typeof o.lineHeight||!0===o.autoWrapText)return!1}return!0}(t,e))if(t.internalProps.transpose||t.isPivotTable()&&!t.internalProps.layoutMap.indicatorsAsCol)for(let r=Math.max(e,t.columnHeaderLevelCount);r<=i;r++){let e;e=!function(t,e){var i,r,n;let{layoutMap:l}=t.internalProps;if((t.internalProps.autoWrapText||t.internalProps.enableLineBreak)&&(t.isAutoRowHeight(e)||"adaptive"===t.options.heightMode))return!1;let s=l.getBody(t.rowHeaderLevelCount,e);if("function"==typeof s.style||"function"==typeof s.icon||(null==(i=s.define)?void 0:i.customRender)||(null==(r=s.define)?void 0:r.customLayout)||"function"==typeof(null==(n=s.define)?void 0:n.icon))return!1;let a=t._getCellStyle(t.rowHeaderLevelCount,e);return"function"!=typeof a.padding&&"function"!=typeof a.fontSize&&"function"!=typeof a.lineHeight&&!0!==a.autoWrapText}(t,r)?P(r,0,t.colCount-1,t):P(r,0,t.rowHeaderLevelCount,t),n?_[r]=Math.round(e):t._setRowHeight(r,e)}else for(let r=Math.max(e,t.columnHeaderLevelCount);r<=i;r++){let e=P(r,0,t.colCount-1,t);n?_[r]=Math.round(e):t._setRowHeight(r,e)}else{!function(t,e,i,r,n){if(!r.internalProps.useOneRowHeightFillAll){for(let l=e;l<=i;l++)n?n[l]=t:r._setRowHeight(l,t);r.internalProps.useOneRowHeightFillAll=!0}}(P(t.columnHeaderLevelCount,0,t.colCount-1,t),t.columnHeaderLevelCount,t.rowCount-1-t.bottomFrozenRowCount,t,n?_:void 0);for(let e=t.rowCount-t.bottomFrozenRowCount;e<=i;e++){let i=P(e,0,t.colCount-1,t);n?_[e]=Math.round(i):t._setRowHeight(e,i)}}}else if(("adaptive"===t.heightMode||t.autoFillHeight)&&t.clearRowHeightCache(),n)for(let r=e;r<=i;r++)_[r]=t.getRowHeight(r);if((0===e&&i===t.rowCount-1||r)&&t._clearRowRangeHeightsMap(),"adaptive"===t.heightMode){t._clearRowRangeHeightsMap();let e=t.tableNoFrameHeight,i=0,r=t.rowCount;if("only-body"===t.heightAdaptiveMode){let n=t.getRowsHeight(0,t.columnHeaderLevelCount-1),l=t.isPivotChart()?t.getBottomFrozenRowsHeight():0;e=t.tableNoFrameHeight-n-l,i=t.columnHeaderLevelCount,r=t.isPivotChart()?t.rowCount-t.bottomFrozenRowCount:t.rowCount}let a=0;for(let e=i;e<r;e++)a+=n&&null!=(l=_[e])?l:t.getRowHeight(e);let o=e/a;for(let l=i;l<r;l++){let a;a=l===r-1?e-(n?_.reduce((t,e,n)=>n>=i&&n<=r-2?t+e:t,0):t.getRowsHeight(i,r-2)):Math.round((n&&null!=(s=_[l])?s:t.getRowHeight(l))*o),n?_[l]=a:t._setRowHeight(l,a,!1)}}else if(t.autoFillHeight){t._clearRowRangeHeightsMap();let e=t.tableNoFrameHeight,i=0,r=0;for(let e=0;e<t.rowCount;e++){let l=n&&null!=(a=_[e])?a:t.getRowHeight(e);(e<t.columnHeaderLevelCount||t.isPivotChart()&&e>=t.rowCount-t.bottomFrozenRowCount)&&(r+=l),i+=l}if(t.scenegraph._dealAutoFillHeightOriginRowsHeight=i,i<e&&i-r>0){let l=t.columnHeaderLevelCount,s=t.isPivotChart()?t.rowCount-t.bottomFrozenRowCount:t.rowCount,a=(e-r)/(i-r);for(let i=l;i<s;i++){let h;h=i===s-1?e-r-(n?_.reduce((t,e,i)=>i>=l&&i<=s-2?t+e:t,0):t.getRowsHeight(l,s-2)):Math.round((n&&null!=(o=_[i])?o:t.getRowHeight(i))*a),n?_[i]=h:t._setRowHeight(i,h,!1)}}}if(n){for(let r=e;r<=i;r++){let e=null!=(u=_[r])?u:t.getRowHeight(r);(0,d.Z)(e)&&t._setRowHeight(r,e)}for(let e=0;e<=t.frozenRowCount-1;e++){let i=t.getRowHeight(e);i!==(null!=(c=b[e])?c:t.getRowHeight(e))&&t.scenegraph.updateRowHeight(e,i-(null!=(p=b[e])?p:t.getRowHeight(e)),!0)}for(let e=t.rowCount-t.bottomFrozenRowCount;e<=t.rowCount-1;e++){let i=t.getRowHeight(e);i!==(null!=(f=b[e])?f:t.getRowHeight(e))&&t.scenegraph.updateRowHeight(e,i-(null!=(m=b[e])?m:t.getRowHeight(e)),!0)}for(let e=t.scenegraph.proxy.rowStart;e<=t.scenegraph.proxy.rowEnd;e++){let i=t.getRowHeight(e);i!==(null!=(y=b[e])?y:t.getRowHeight(e))&&t.scenegraph.updateRowHeight(e,i-(null!=(v=b[e])?v:t.getRowHeight(e)),!0)}}t.isPivotTable()&&(C.disableUseGetBodyCache(),C.disableUseHeaderPathCache())}function P(t,e,i,r){var g;let v;if(!(r.isAutoRowHeight(t)||"adaptive"===r.heightMode&&!1!==r.options.autoHeightInAdaptiveMode)&&"auto"!==r.getDefaultRowHeight(t))return r.getDefaultRowHeight(t);if(r.options.customComputeRowHeight){let e=r.options.customComputeRowHeight({row:t,table:r});if("number"==typeof e)return e;if("auto"!==e)return r.getDefaultRowHeight(t)}if(r.internalProps.rowHeightConfig){let e=r.internalProps.rowHeightConfig.find(e=>e.key===t);if(e)return r.internalProps._heightResizedRowMap.has(t)||(r._setRowHeight(t,e.height),r.internalProps._heightResizedRowMap.add(t)),e.height}if(r.isPivotChart()&&t>=r.columnHeaderLevelCount&&t<r.rowCount-r.bottomFrozenRowCount){let e=r.internalProps.layoutMap.indicatorsAsCol,i=!1;if(r.internalProps.layoutMap.indicatorsAsCol||"heatmap"!==r.internalProps.layoutMap.getChartSpec(r.rowHeaderLevelCount,t).type||(i=!0,e=!0),e){let e=r.internalProps.layoutMap.getOptimunHeightForChart(t,i);if(e>0)return e}else{let e=r.getDefaultRowHeight(t);if((0,u.Z)(e))return e}}for(let u=e;u<=i;u++){let e=function(t,e,i){var r,n,a,o,h,d,u,g,f,m;let y=i.getCustomRender(t,e),v=i.getCustomLayout(t,e);if(y||v){let b,_=1,C=0,x=!1,w=!1;(i.isHeader(t,e)||(null==(r=i.getBodyColumnDefine(t,e))?void 0:r.mergeCell)||i.hasCustomMerge())&&(_=(b=i.getCellRange(t,e)).end.row-b.start.row+1);let S={col:null!=(n=null==b?void 0:b.start.col)?n:t,row:null!=(a=null==b?void 0:b.start.row)?a:e,dataValue:i.getCellOriginValue(t,e),value:i.getCellValue(t,e)||"",rect:(g=t,f=e,{left:0,top:0,right:(m=i).getColWidth(g),bottom:m.getRowHeight(f),width:m.getColWidth(g),height:0}),table:i,originCol:t,originRow:e,forComputation:!0};if("react-custom-layout"===v&&(v=(null==(o=i.reactCustomLayout)?void 0:o.getCustomLayoutFunc(t,e))||T.D),(0,c.Z)(v)){let e=v(S);e.rootContainer?(e.rootContainer=(0,p.nH)(e.rootContainer),(0,p.Jp)(e.rootContainer,i.getColWidth(t),0),e.rootContainer.setStage(i.scenegraph.stage),C=null!=(h=e.rootContainer.AABBBounds.height())?h:0):C=0,x=e.renderDefault,w=e.enableCellPadding}else if("function"==typeof y){let t=y(S);C=null!=(d=null==t?void 0:t.expectedHeight)?d:0,x=null==t?void 0:t.renderDefault}else C=null!=(u=null==y?void 0:y.expectedHeight)?u:0,x=null==y?void 0:y.renderDefault;if(w){let r=i._getCellStyle(t,e),n=(0,s.u)((0,l.WJ)("padding",r,t,e,i));C+=n[0]+n[2]}return{height:C/_,renderDefault:x}}}(u,t,r);if(e&&(v=(0,d.Z)(v)?Math.max(e.height,v):e.height,!e.renderDefault))continue;if(r.isPivotChart()){let e=r.internalProps.layoutMap.getAxisConfigInPivotChart(u,t);if(e){let t=o.F.getFunction("computeAxisComponentHeight")(e,r);if("number"==typeof t){v=(0,d.Z)(v)?Math.max(t,v):t;continue}}}if(r.isPivotChart()&&(r.isLeftFrozenColumn(u)&&r.isBottomFrozenRow(t)||r.isRightFrozenColumn(u)&&r.isBottomFrozenRow(t)))continue;let i=r.isHeader(u,t)?null==(g=r._getHeaderLayoutMap(u,t))?void 0:g.headerType:r.getBodyColumnType(u,t),b=function(t,e,i,r){var o,d,u,c,p;let g=0,v=r.getCellValue(t,e),b=r._getCellStyle(t,e),_=0,T=0,R=[],P=0,B=[],I=0,E=!1;if("body"!==r.getCellLocation(t,e))E=!0;else{let i=r.getBodyColumnDefine(t,e);E=!!(null==i?void 0:i.icon)||!!(null==i?void 0:i.tree)||(null==i?void 0:i.dragOrder)}if(E){let i=r.getCellIcons(t,e);null==i||i.forEach(t=>{var e,i,r,l,s,a,o,h,d,u;t.positionType!==n.q0.absoluteRight&&t.positionType!==n.q0.inlineFront&&t.positionType!==n.q0.inlineEnd?(T+=(null!=(e=t.width)?e:0)+(null!=(i=t.marginLeft)?i:0)+(null!=(r=t.marginRight)?r:0),_=Math.max(_,null!=(l=t.height)?l:0)):t.positionType===n.q0.inlineFront?(R.push(t),P=Math.max(P,(null!=(s=t.height)?s:0)+(null!=(a=t.marginLeft)?a:0)+(null!=(o=t.marginRight)?o:0))):t.positionType===n.q0.inlineEnd&&(B.push(t),I=Math.max(I,(null!=(h=t.height)?h:0)+(null!=(d=t.marginLeft)?d:0)+(null!=(u=t.marginRight)?u:0)))})}let L=1,F=t;if(r.isHeader(t,e)||(null==(o=r.getBodyColumnDefine(t,e))?void 0:o.mergeCell)||r.hasCustomMerge()){let i=r.getCellRange(t,e);L=i.end.row-i.start.row+1,t=i.start.col,F=i.end.col}let O=(0,s.u)((0,l.WJ)("padding",b,t,e,r)),H=(0,l.WJ)("fontSize",b,t,e,r),D=(0,l.WJ)("fontStyle",b,t,e,r),z=(0,l.WJ)("fontWeight",b,t,e,r),W=null!=(d=(0,l.WJ)("lineHeight",b,t,e,r))?d:H,Z=(0,l.WJ)("fontFamily",b,t,e,r),N=(0,l.WJ)("autoWrapText",b,t,e,r),j=(0,l.WJ)("lineClamp",b,t,e,r),G=(0,l.WJ)("underline",b,t,e,r),V=null!=(u=(0,l.WJ)("underlineOffset",b,t,e,r))?u:0;if("text"!==i&&"link"!==i&&"progressbar"!==i&&"checkbox"!==i&&"radio"!==i&&"switch"!==i&&"button"!==i)g=W;else if("checkbox"===i)g=function(t,e,i,r,n,s,a,o,h,d,u,c,p,g,f){let v=(0,m.Z)(t)?t.text:t,b=(0,y.cw)(v).split("\n")||[],_=f.getColsWidth(e,r),x=(0,l.WJ)("size",n,e,i,f),w=0;if(s){let t=(0,l.WJ)("spaceBetweenTextAndIcon",n,e,i,f),r=_-(g[1]+g[3])-a-x-t;C.setAttributes({text:{maxLineWidth:r,text:b,fontSize:o,fontStyle:h,fontWeight:d,fontFamily:u,lineHeight:c,wordBreak:"break-word",lineClamp:p},icon:{width:Math.floor(x/1.4),height:Math.floor(x/1.4)},box:{width:x,height:x},spaceBetweenTextAndIcon:t}),C.render(),w=C.AABBBounds.height()}else w=Math.max(x,b.length*c);return w}(v,t,e,F,b,N,T,H,D,z,Z,W,j,O,r);else if("radio"===i)g=function(t,e,i,r,n,s,a,o,d,u,c,p,g,f,m){var y;if((0,h.Z)(t)){let h=0,v=m.getBodyColumnDefine(e,i),b=(0,l.WJ)("spaceBetweenRadio",n,e,i,m),_=null!=(y=null==v?void 0:v.radioDirectionInCell)?y:"vertical";return"vertical"===_?t.forEach((l,y)=>{let v=S(l,e,i,r,n,s,a,o,d,u,c,p,g,f,m);h+=v,y!==t.length-1&&(h+=b)}):"horizontal"===_&&t.forEach(t=>{h=Math.max(S(t,e,i,r,n,s,a,o,d,u,c,p,g,f,m),h)}),h}return S(t,e,i,r,n,s,a,o,d,u,c,p,g,f,m)}(v,t,e,F,b,N,T,H,D,z,Z,W,j,O,r);else if("switch"===i)p=t,g=(0,l.WJ)("boxWidth",b,p,e,r);else if("button"===i)g=function(t,e,i,r,n,s,a,o,h,d,u,c,p,g,f){let v=(0,m.Z)(t)?t.text:t,b=(0,y.cw)(v).split("\n")||[],_=f.getColsWidth(e,r),C=(0,l.WJ)("buttonPadding",n,e,i,f),S=(0,l.WJ)("buttonLineWidth",n,e,i,f),A=0;if(s){let t=_-(g[1]+g[3]);w.setAttributes({text:b,textStyle:{maxLineWidth:t,fontSize:o,fontStyle:h,fontWeight:d,fontFamily:u,lineHeight:c,wordBreak:"break-word",lineClamp:p},padding:C,panel:{visible:!0,fill:"red",stroke:"red",lineWidth:S}}),x.render(),A=x.AABBBounds.height()}else A=b.length*c+2*C;return A}(v,t,e,F,b,N,0,H,D,z,Z,W,j,O,r);else{let i=(0,M.$)(v,r).text,n=r.getColsWidth(t,F);if(R.length||B.length)if(N){let t=Object.assign({text:null==v?void 0:v.toString(),fontFamily:Z,fontSize:H,fontStyle:D,fontWeight:z,lineHeight:W});t.textBaseline="middle";let e=[...R.map(t=>(0,a.vQ)(t)),t,...B.map(t=>(0,a.vQ)(t))];k.setAttributes({width:n-(O[1]+O[3])-T,height:0,textConfig:e}),g=k.AABBBounds.height()}else g=0,i.forEach((t,e)=>{var n;(null==(n=r.options.customConfig)?void 0:n.multilinesForXTable)&&0!==e||(0===e&&R.length?g+=Math.max(W,P):e===i.length-1&&B.length?g+=Math.max(W,I):g+=W)});else if(N){let l=(0,f.L)(t,e,r),s=n-(O[1]+O[3])-T-l;g=((0,A.Rc)({maxLineWidth:s,text:i,fontSize:H,fontStyle:D,fontWeight:z,fontFamily:Z,lineHeight:W,wordBreak:"break-word",whiteSpace:1!==i.length||N?"normal":"no-wrap",lineClamp:j}).height()||("number"==typeof W?W:H))+(G?V:0)}else g=(null==(c=r.options.customConfig)?void 0:c.multilinesForXTable)?W:i.length*W}return(Math.max(g,_)+O[0]+O[2])/L}(u,t,i,r);v=(0,d.Z)(v)?Math.max(b,v):b}if((0,d.Z)(v))return v;let b=r.getDefaultRowHeight(t);return(0,u.Z)(b)?b:r.defaultRowHeight}},14305:function(t,e,i){i.d(e,{KP:()=>d,RW:()=>h,kl:()=>o,s8:()=>c,s9:()=>a,zO:()=>u});var r=i(75133),n=i(31877),l=i(74577),s=i(32802);function a(t,e){let{table:i}=t,r=i.internalProps.layoutMap,n=-1===e?"all":i.internalProps.columnResizeType;if("column"===n){let r=t.getColGroup(e),n=t.getColGroup(e,!0),l=t.getColGroupInBottom(e,!0);if(null==r||r.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==n||n.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==l||l.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),"adaptive"===i.widthMode&&e<i.colCount-1){let r=t.getColGroup(e+1),n=t.getColGroup(e+1,!0),l=t.getColGroupInBottom(e+1,!0);null==r||r.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==n||n.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==l||l.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))})}}else{let l,s,a,o=i.rowHeaderLevelCount,h=i.colCount-1;if("indicator"===n)if(r.indicatorsAsCol)l=r.getIndicatorKey(e,i.columnHeaderLevelCount);else{let t=r.getCellHeaderPaths(e,i.columnHeaderLevelCount-1),n=t.colHeaderPaths[t.colHeaderPaths.length-1];s=n.dimensionKey,a=n.value}else if("indicatorGroup"===n){let t=i.internalProps.layoutMap,e=t.getCellHeaderPaths(i.stateManager.columnResize.col,i.columnHeaderLevelCount),r=t.getHeadNodeByRowOrColDimensions(e.colHeaderPaths.slice(0,e.colHeaderPaths.length-1));o=r.startInTotal+i.frozenColCount,h=r.startInTotal+i.frozenColCount+r.size-1}for(let e=o;e<=h;e++){let o=t.getColGroup(e),h=t.getColGroup(e,!0),d=t.getColGroupInBottom(e,!0);if(o){if("indicator"===n){let t=r.getIndicatorKey(e,i.columnHeaderLevelCount);if(r.indicatorsAsCol&&t!==l)continue;if(!r.indicatorsAsCol){let t=r.getCellHeaderPaths(e,i.columnHeaderLevelCount-1),n=null==t?void 0:t.colHeaderPaths[t.colHeaderPaths.length-1];if(!n||s!==n.dimensionKey||a!==n.value)continue}}o.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==h||h.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))}),null==d||d.forEachChildren(t=>{g(t,i.getColWidth(t.col),i.getRowHeight(t.row))})}}}}function o(t,e){var i;let{table:r}=t,n=r.internalProps.layoutMap,l=r.stateManager,s=-1===e?"all":r.internalProps.rowResizeType,a,o,h,d=r.columnHeaderLevelCount,u=r.rowCount-1;if("indicator"===s)if(n.indicatorsAsCol){let t=n.getCellHeaderPaths(r.rowHeaderLevelCount-1,e),l=null==(i=t.rowHeaderPaths)?void 0:i[t.rowHeaderPaths.length-1];o=null==l?void 0:l.dimensionKey,h=null==l?void 0:l.value}else a=n.getIndicatorKey(r.rowHeaderLevelCount,e);else if("indicatorGroup"===s){let t=r.internalProps.layoutMap,i=t.getCellHeaderPaths(r.rowHeaderLevelCount,e),n=t.getHeadNodeByRowOrColDimensions(i.rowHeaderPaths.slice(0,i.rowHeaderPaths.length-1));d=n.startInTotal+r.frozenRowCount,u=n.startInTotal+r.frozenRowCount+n.size-1}let c=[{startCol:t.proxy.colStart,endCol:t.proxy.colEnd}];r.frozenColCount&&c.push({startCol:0,endCol:r.frozenColCount-1}),r.rightFrozenColCount&&c.push({startCol:r.colCount-r.rightFrozenColCount,endCol:r.colCount-1}),c.forEach(({startCol:i,endCol:c})=>{for(let p=i;p<=c;p++)if("row"===s){let i=t.highPerformanceGetCell(p,e);if("cell"!==i.role)continue;if(g(i,r.getColWidth(i.col),r.getRowHeight(i.row)),"adaptive"===r.heightMode&&e<r.rowCount-1){let i=t.highPerformanceGetCell(p,e+1);g(i,r.getColWidth(i.col),r.getRowHeight(i.row))}}else for(let e=d;e<=u;e++){if("indicator"===s){let t=n.getIndicatorKey(l.table.rowHeaderLevelCount,e);if(!n.indicatorsAsCol&&t!==a)continue;if(n.indicatorsAsCol){let t=n.getCellHeaderPaths(l.table.rowHeaderLevelCount-1,e),i=null==t?void 0:t.rowHeaderPaths[t.rowHeaderPaths.length-1];if(!i||o!==i.dimensionKey||h!==i.value)continue}}let i=t.highPerformanceGetCell(p,e);"cell"===i.role&&g(i,r.getColWidth(i.col),r.getRowHeight(i.row))}})}function h(t){var e;for(let i=t.proxy.colStart;i<=t.proxy.colEnd;i++){let r=t.getColGroup(i);null==(e=null==r?void 0:r.getChildren())||e.forEach(t=>{t.children.forEach(t=>{"chart"===t.type&&(t.cacheCanvas=null,t.addUpdateBoundTag())})})}}function d(t,e,i){i.getCell(t,e).children.forEach(t=>{"chart"===t.type&&(t.cacheCanvas=null,t.addUpdateBoundTag())})}function u(t){var e;let i=t.table;for(let r=t.proxy.colStart;r<=t.proxy.colEnd;r++){let n=t.getColGroup(r);null==(e=null==n?void 0:n.getChildren())||e.forEach(t=>{let e=t.col,r=t.row;t.children.forEach(t=>{if("chart"===t.type){t.updateData(i.getCellValue(e,r));let n=t.attribute.spec,l=n.type;if("gauge"!==l&&"rose"!==l&&"radar"!==l){let l=i.internalProps.layoutMap.getChartAxes(e,r);t.setAttribute("axes",l),n.axes=l}t.setAttribute("spec",n)}})})}p(t.rowHeaderGroup,t.table),p(t.colHeaderGroup,t.table),p(t.rightFrozenGroup,t.table),p(t.bottomFrozenGroup,t.table)}function c(t,e,i){let n=t.table;if(n.isPivotChart()){n._selectedDataMode=i;let l=n._selectedDataItemsInChart.length;if((null==e||0===(null==e?void 0:e.length)||0===Object.keys(e).length)&&0===l)return;let s=[];if(Array.isArray(e))e.forEach(t=>{if(t&&0!==t.key&&Object.keys(t).length>0){let e={};for(let i in t)i.startsWith("VGRAMMAR_")||i.startsWith("__VCHART")||(e[i]=t[i]);s.push(e)}});else if(e&&0!==e.key&&Object.keys(e).length>0){let t={};for(let i in e)i.startsWith("VGRAMMAR_")||i.startsWith("__VCHART")||(t[i]=e[i]);s.push(t)}(0,r.X)(n._selectedDataItemsInChart,s)||(n._selectedDataItemsInChart=s,n.internalProps.layoutMap.updateDataStateToChartInstance(),h(t),n.scenegraph.updateNextFrame())}}function p(t,e){t.forEachChildren(t=>{"column"===t.role&&t.forEachChildren(t=>{var i;if("cell"===t.role){let r=!1;if(t.forEachChildren(t=>"axis"===t.name&&(r=!0,!0)),r){let r=e.internalProps.layoutMap.getAxisConfigInPivotChart(t.col,t.row),a=e._getCellStyle(t.col,t.row),o=(0,l.u)((0,s.WJ)("padding",a,t.col,t.row,e)),h=new(n.F.getComponent("axis"))(r,t.attribute.width,t.attribute.height,null!=(i=r.__vtableBodyChartCellPadding)?i:o,e);t.clear(),t.appendChild(h.component),h.overlap()}}})})}function g(t,e,i){t.forEachChildren(t=>{"chart"===t.type&&(t.cacheCanvas=null,t.setAttributes({width:Math.ceil(e-t.attribute.cellPadding[3]-t.attribute.cellPadding[1]),height:Math.ceil(i-t.attribute.cellPadding[0]-t.attribute.cellPadding[2])}))})}},42515:function(t,e,i){i.d(e,{$:()=>l});var r=i(83624),n=i(6958);function l(t,e){var i,l;let s,a=!1;for((0,r.Z)(t)&&t.length>(e.options.maxCharactersNumber||200)&&(t=t.slice(0,e.options.maxCharactersNumber||200)+"…",a=!0),s=e.internalProps.enableLineBreak||(null==(i=e.options.customConfig)?void 0:i.multilinesForXTable)?(0,n.m7)(t).replace(/\r?\n/g,"\n").replace(/\r/g,"\n").split("\n")||[]:[(0,n.m7)(t)];s.length&&s.length>1&&!s[s.length-1];)s.pop();if((null==(l=e.options.customConfig)?void 0:l.multilinesForXTable)&&!e.internalProps.autoWrapText)for(;s.length&&s.length>1&&!s[0];)s.shift();return{text:s,moreThanMaxCharacters:a}}},56982:function(t,e,i){i.d(e,{d:()=>n});var r=i(16214);function n(t,e,i,n){var l,s,a,o,h,d,u,c,p,g,f,m,y,v,b,_,C,x;let w=null!=(s=null==(l=null==i?void 0:i.group)?void 0:l.strokeArrayWidth)?s:void 0;return n.theme.cellInnerBorder||!(0,r.z5)(n.theme.frameStyle.borderLineWidth)||(0,r.KV)(n.theme.frameStyle.borderLineWidth)||(0===t&&((w=null!=w?w:[null==(a=null==i?void 0:i.group)?void 0:a.lineWidth,null==(o=null==i?void 0:i.group)?void 0:o.lineWidth,null==(h=null==i?void 0:i.group)?void 0:h.lineWidth,null==(d=null==i?void 0:i.group)?void 0:d.lineWidth])[3]=0),t===n.colCount-1&&((w=null!=w?w:[null==(u=null==i?void 0:i.group)?void 0:u.lineWidth,null==(c=null==i?void 0:i.group)?void 0:c.lineWidth,null==(p=null==i?void 0:i.group)?void 0:p.lineWidth,null==(g=null==i?void 0:i.group)?void 0:g.lineWidth])[1]=0),0===e&&((w=null!=w?w:[null==(f=null==i?void 0:i.group)?void 0:f.lineWidth,null==(m=null==i?void 0:i.group)?void 0:m.lineWidth,null==(y=null==i?void 0:i.group)?void 0:y.lineWidth,null==(v=null==i?void 0:i.group)?void 0:v.lineWidth])[0]=0),e===n.rowCount-1&&((w=null!=w?w:[null==(b=null==i?void 0:i.group)?void 0:b.lineWidth,null==(_=null==i?void 0:i.group)?void 0:_.lineWidth,null==(C=null==i?void 0:i.group)?void 0:C.lineWidth,null==(x=null==i?void 0:i.group)?void 0:x.lineWidth])[2]=0)),w}},73044:function(t,e,i){function r(t,e,i,n,l,s,a="left",o="middle",h=[0,0,0,0],d=0,u=0,c=0,p=0){let g=t+h[3]+d;"right"===a||"end"===a?g=t+i-l-h[1]-u:"center"===a&&(g=t+(i-l+d-u)/2);let f=e+h[0]+c;return"bottom"===o||"alphabetic"===o||"ideographic"===o?f=e+n-s-h[2]-p:"middle"===o&&(f=e+(n-s+c-p)/2),{x:g,y:f}}function n(t,e,i,r,n){let l=!1,s=!1,a=!1,o=!1,h=!1,d=!1,u=!1,c=!1,p=!1;return t<=n.frozenColCount-1&&e<=n.frozenRowCount-1&&(d=!0),i>=n.colCount-n.rightFrozenColCount&&e<=n.frozenRowCount-1&&(u=!0),t<=n.frozenColCount-1&&r>=n.rowCount-n.bottomFrozenRowCount&&(p=!0),i>=n.colCount-n.rightFrozenColCount&&r>=n.rowCount-n.bottomFrozenRowCount&&(c=!0),t<=n.frozenColCount-1&&r>=n.frozenRowCount&&e<=n.rowCount-n.bottomFrozenRowCount-1&&(l=!0),i>=n.colCount-n.rightFrozenColCount&&r>=n.frozenRowCount&&e<=n.rowCount-n.bottomFrozenRowCount-1&&(s=!0),e<=n.frozenRowCount-1&&i>=n.frozenColCount&&t<=n.colCount-n.rightFrozenColCount-1&&(a=!0),r>=n.rowCount-n.bottomFrozenRowCount&&i>=n.frozenColCount&&t<=n.colCount-n.rightFrozenColCount-1&&(o=!0),t<=n.colCount-n.rightFrozenColCount-1&&i>=n.frozenColCount&&e<=n.rowCount-n.bottomFrozenRowCount-1&&r>=n.frozenRowCount&&(h=!0),{needRowHeader:l,needRightRowHeader:s,needColumnHeader:a,needBottomColumnHeader:o,needBody:h,needCornerHeader:d,needRightTopCornerHeader:u,needLeftBottomCornerHeader:p,needRightBottomCornerHeader:c}}i.d(e,{L:()=>n,W:()=>r})},37280:function(t,e,i){i.d(e,{K:()=>r});function r(t,e,i){t.then(()=>{i(),e.scenegraph.updateNextFrame()}).catch(t=>{})}},24825:function(t,e,i){i.d(e,{Z:()=>r});function r(t,e,i){var r;if(t.internalProps.customMergeCell){let r=t.getCustomMerge(e,i);if(r)return r.range}if(!t.internalProps.enableTreeNodeMerge&&!t.isHeader(e,i)&&!(null==(r=t.getBodyColumnDefine(e,i))?void 0:r.mergeCell))return!1;let n=t.getCellRange(e,i);return(n.start.col!==n.end.col||n.start.row!==n.end.row)&&n}},71994:function(t,e,i){i.d(e,{L:()=>s});var r=i(64776),n=i(95723),l=i(72281);function s(t,e,i){var s,a,o,h,d;let u=0,c=i.internalProps.layoutMap;if(c.isHeader(t,e)){let n=c.getHeader(t,e);(0,r.Z)(null==n?void 0:n.hierarchyLevel)&&(u=(null!=(s=n.hierarchyLevel)?s:0)*("tree"===c.rowHierarchyType&&null!=(a=c.rowHierarchyIndent)?a:0),c.rowHierarchyTextStartAlignment&&!i.internalProps.headerHelper.getHierarchyIcon(t,e)&&(u+=i.internalProps.headerHelper.getHierarchyIconWidth()))}else if(i.internalProps.groupBy||(null==(o=i.getBodyColumnDefine(t,e))?void 0:o.tree)){let r=i.dataSource.getIndexKey(i.getRecordShowIndexByCell(t,e)),s=null!=(h=i.dataSource.getGroupLength())?h:0,a=(0,n.Z)(r)?r.length-1:0;s>0&&a===s&&(a=0),u=Array.isArray(r)&&i.getHierarchyState(t,e)!==l.g.none?a*(null!=(d=c.hierarchyIndent)?d:0):0,c.hierarchyTextStartAlignment&&!i.internalProps.bodyHelper.getHierarchyIcon(t,e)&&(u+=i.internalProps.bodyHelper.getHierarchyIconWidth())}return u}},32802:function(t,e,i){i.d(e,{WJ:()=>n,vp:()=>l});var r=i(64776);function n(t,e,i,n,l){let s=e&&(0,r.Z)(e[t])?e[t]:void 0;return"function"==typeof s?s({col:i,row:n,table:l,value:l.getCellValue(i,n),dataValue:l.getCellOriginValue(i,n),cellHeaderPaths:l.getCellHeaderPaths(i,n)}):s}function l(t,e,i,n,l){let s=e&&(0,r.Z)(e[t])?e[t]:void 0;if("function"==typeof s)return s({col:i,row:n,table:l,value:l.getCellValue(i,n),dataValue:l.getCellOriginValue(i,n),cellHeaderPaths:l.getCellHeaderPaths(i,n)})}},56871:function(t,e,i){i.d(e,{f:()=>r});function r(t,e,i,r){let n,l,s=t/e;return s>i/r?(r-(l=(n=i)/s))/2:(i-(n=(l=r)*s))/2,{width:n,height:l}}},74577:function(t,e,i){i.d(e,{u:()=>a});var r=i(19626),n=i(4654),l=i(83624),s=i(95723);function a(t){var e,i,a,o;if((0,n.Z)(t)||(0,l.Z)(t)||(0,s.Z)(t)){let e=(0,r.dj)(t);return"number"==typeof e||"string"==typeof e?e=[e,e,e,e]:Array.isArray(e)&&(e=e.slice(0)),e}return t&&(isFinite(t.bottom)||isFinite(t.left)||isFinite(t.right)||isFinite(t.top))?[null!=(e=t.top)?e:0,null!=(i=t.right)?i:0,null!=(a=t.bottom)?a:0,null!=(o=t.left)?o:0]:[0,0,0,0]}},95954:function(t,e,i){i.d(e,{vQ:()=>C,qs:()=>x,M4:()=>S,Zl:()=>w,Bg:()=>_,Rd:()=>b});var r=i(63654),n=i(47634),l=i(34672),s=i(20219),a=i(68173);class o extends s.Z{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new s.Z({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new s.Z({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._centerGroup=new s.Z({pickable:!1,fill:!1,stroke:!1}),this._centerGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._centerGroup)}setCellContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}addLeftOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._leftGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth((null!=(i=t.attribute.marginLeft)?i:0)+(null!=(r=t.attribute.marginRight)?r:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._rightGroup.width+(null!=(e=t.attribute.marginLeft)?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth((null!=(i=t.attribute.marginLeft)?i:0)+(null!=(r=t.attribute.marginRight)?r:0)+t.attribute.width)}addContent(t){let e=this._centerGroup.lastChild;e&&t.setAttributes({x:e.attribute.x+e.AABBBounds.width()}),this._centerGroup.appendChild(t),t instanceof r.x&&(this._centerGroup.setAttribute("pickable",!1),t.setAttribute("textAlign","left"))}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){let i=this._centerGroup.width;this._cellWidth=t+e+i,this.setAttribute("width",this._cellWidth)}else{let i=this._cellWidth-t-e;this.updateCenterLayout(i);let r=this._centerGroup.width;this._cellWidth=t+e+r,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();let i=this._leftGroup.height,r=this._rightGroup.height,n=this._centerGroup.height;this._cellHeight=Math.max(i,r,n),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._centerGroup.forEachChildren(t=>{(t instanceof a.J||t instanceof a.V)&&(e-=t.AABBBounds.width())});let i=this._centerGroup.getChildByName("text");i instanceof n.H?i.setAttribute("width",e):i instanceof r.x&&i.setAttribute("maxLineWidth",e);let l=0;this._centerGroup.forEachChildren(t=>{t.setAttribute("x",l),l+=t.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._centerGroup.setAttribute("x",this._leftGroup.width),"left"===this._align||"start"===this._align?this.setAttribute("dx",0):"center"===this._align?this.setAttribute("dx",-this.attribute.width/2):"right"!==this._align&&"end"!==this._align||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){"top"===this._baseline?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._centerGroup.setAttribute("y",0)):"middle"===this._baseline?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._centerGroup.setAttribute("y",this._cellHeight/2-this._centerGroup.height/2)):"bottom"===this._baseline&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._centerGroup.setAttribute("y",this._cellHeight-this._centerGroup.height))}updateWidth(t){this._cellWidth=t,this._originCellWidth=t,this.layout()}updateHeight(t){this._cellHeight=t,this._cellWidth=this._originCellWidth;let e=this.getChildByName("text",!0);e&&e.setAttribute("heightLimit",t),this.layout()}}var h=i(24825),d=i(71994),u=i(4654),c=i(64776),p=i(20408),g=i(89530),f=i(42515),m=i(73501),y=i(53430),v=i(67331);function b(t,e,i,l,s,a,h,p,g,y,v,b,x,w,M){var T,k,R,P,B,I,E,L,F;let O,H=0,D=0,z=0;if(Array.isArray(e)&&0!==e.length){let c,{inlineFrontIcons:m,inlineEndIcons:T,contentLeftIcons:k,contentRightIcons:R,leftIconWidth:W,rightIconWidth:Z,absoluteRightIconWidth:N}=S(e,t,M,x);if(H=W,D=Z,z=N,0===m.length&&0===T.length){let e=0;(0,u.Z)(x.theme._contentOffset)&&("left"===v?e=x.theme._contentOffset:"right"===v&&(e=-x.theme._contentOffset));let n=M?(0,d.L)(M.start.col,M.start.row,x):(0,d.L)(t.col,t.row,x),{text:o,moreThanMaxCharacters:m}=(0,f.$)(i,x),b={text:1===o.length?o[0]:o,moreThanMaxCharacters:m,maxLineWidth:s?1/0:g-(l[1]+l[3])-H-D-n,textBaseline:"top",heightLimit:!1!==(null==(P=x.options.customConfig)?void 0:P.limitContentHeight)&&(!a||(null==(B=x.options.customConfig)?void 0:B.multilinesForXTable))?y-Math.floor(l[0]+l[2]):-1,pickable:!1,autoWrapText:h,lineClamp:p,wordBreak:"break-word",whiteSpace:!1===(null==(I=x.options.customConfig)?void 0:I.limitContentHeight)||1!==o.length||h?"normal":"no-wrap",dx:("left"===v?k.length?0:n:0)+e,keepCenterInLine:!0},_=new r.x(w.text?Object.assign({},w.text,b):b);_.name="text",c=_}else{let e=Object.assign({text:null==i?void 0:i.toString()},(null==(F=null==(L=null==(E=t.parent)?void 0:E.theme)?void 0:L.userTheme)?void 0:F.text)||{});w.text&&Object.assign(e,w.text),e.textBaseline="middle";let r=[...m.map(t=>C(t)),e,...T.map(t=>C(t))];r[0].textAlign=v;let o=new n.H({width:s?0:g-(l[1]+l[3])-H-D,height:a&&h?0:Math.ceil(y-(l[0]+l[2])),textConfig:r,verticalDirection:a&&h?"top":b,ellipsis:e.ellipsis});o.name="text",c=o,o.bindIconEvent(),M&&(M.start.col!==M.end.col||M.start.row!==M.end.row)&&(o.onBeforeAttributeUpdate=A)}if(0!==k.length||0!==R.length){let e=new o({x:0,y:0,fill:!1,stroke:!1,pickable:!1});e.name="content",e.setCellContentOption({autoWidth:s,autoHeight:a,cellWidth:g-(l[1]+l[3])-H-D,cellHeight:y-(l[0]+l[2]),align:v,baseline:b});let i={addedHierarchyOffset:0};k.forEach(r=>{let n=_(r,void 0,t.col,t.row,M,x,i);n.role="icon-content-left",n.name=r.name,e.addLeftOccupyingIcon(n)}),R.forEach(r=>{let n=_(r,void 0,t.col,t.row,M,x,i);n.role="icon-content-right",n.name=r.name,e.addRightOccupyingIcon(n)}),e.addContent(c),t.appendChild(e),e.layout(),O=e.AABBBounds.width(),e.AABBBounds.height()}else t.firstChild?t.insertBefore(c,t.firstChild):t.appendChild(c),O=c.AABBBounds.width(),c.AABBBounds.height()}else if((0,c.Z)(i)){let{text:e,moreThanMaxCharacters:n}=(0,f.$)(i,x),o=M?(0,d.L)(M.start.col,M.start.row,x):(0,d.L)(t.col,t.row,x),c=0;(0,u.Z)(x.theme._contentOffset)&&("left"===v?c=x.theme._contentOffset:"right"===v&&(c=-x.theme._contentOffset));let m={text:1===e.length?e[0]:e,moreThanMaxCharacters:n,maxLineWidth:s?1/0:g-(l[1]+l[3]+o),textBaseline:"top",autoWrapText:h,lineClamp:p,wordBreak:"break-word",heightLimit:!1!==(null==(T=x.options.customConfig)?void 0:T.limitContentHeight)&&(!a||(null==(k=x.options.customConfig)?void 0:k.multilinesForXTable))?y-Math.floor(l[0]+l[2]):-1,pickable:!1,dx:("left"===v?o:0)+c,whiteSpace:!1===(null==(R=x.options.customConfig)?void 0:R.limitContentHeight)||1!==e.length||h?"normal":"no-wrap",keepCenterInLine:!0},_=new r.x(w.text?Object.assign({},w.text,m):m);_.name="text",_.textBaseline=b,t.appendChild(_),O=_.AABBBounds.width(),_.AABBBounds.height()}let W=s?H+O+D:g-(l[1]+l[3]),Z=y-(l[0]+l[2]);t.forEachChildren(t=>{"icon-left"===t.role?t.setAttribute("x",t.attribute.x+l[3]):"icon-right"===t.role?t.setAttribute("x",t.attribute.x+W-D+l[3]):"icon-absolute-right"===t.role?t.setAttribute("x",t.attribute.x+W-z+l[3]+l[1]):"content"!==t.name&&"text"!==t.name||("center"===v&&"richtext"!==t.type?t.setAttribute("x",l[3]+H+(W-H-D)/2):"right"===v&&"richtext"!==t.type?t.setAttribute("x",l[3]+W-D):t.setAttribute("x",l[3]+H))}),t.forEachChildren(t=>{t.name!==m.FH&&("middle"===b?t.setAttribute("y",l[0]+(Z-t.AABBBounds.height())/2):"bottom"===b?t.setAttribute("y",l[0]+Z-t.AABBBounds.height()):t.setAttribute("y",l[0]))}),t.setAttributes({width:W+l[1]+l[3],height:Z+l[0]+l[2]})}function _(t,e,i,r,n,s,o){var h,c,g,f,m,y;if(!t)return;let v={};"image"===t.type?(t.isGif&&(v.gif=t.src),v.image=t.src):("svg"===t.type||"svg"in t)&&(v.image=t.svg),v.width=t.width,v.height=t.height,v.visibleTime=null!=(h=t.visibleTime)?h:"always",v.funcType=t.funcType,v.interactive=t.interactive,v.isGif=t.isGif;let b,_=0;return(!o||0===(null==o?void 0:o.addedHierarchyOffset))&&(0,u.Z)(i)&&(0,u.Z)(r)&&s&&(t.funcType===l.cI.collapse||t.funcType===l.cI.expand||t.positionType===l.q0.contentLeft||t.positionType===l.q0.contentRight)&&(_=n?(0,d.L)(n.start.col,n.start.row,s):(0,d.L)(i,r,s),o&&(o.addedHierarchyOffset=1)),v.marginLeft=(null!=(c=t.marginLeft)?c:0)+_,v.marginRight=null!=(g=t.marginRight)?g:0,!1===t.interactive&&(v.pickable=!1),t.hover&&(v.backgroundWidth=null!=(f=t.hover.width)?f:t.width,v.backgroundHeight=null!=(m=t.hover.width)?m:t.width,v.backgroundColor=null!=(y=t.hover.bgColor)?y:"rgba(22,44,66,0.2)",v.hoverImage=t.hover.image),t.cursor&&(v.cursor=t.cursor),"shape"in t&&"circle"===t.shape&&(v.shape=t.shape),e?(e.setAttributes(v),e.loadImage(v.image),e.tooltip=t.tooltip,e.name=t.name,e):("text"===t.type?(v.text=t.content,(0,p.Z)(v,t.style),(b=new a.V(v)).tooltip=t.tooltip):(b=new a.J(v)).tooltip=t.tooltip,b.name=t.name,b)}function C(t){var e,i,r,n,l,s;let a={};return"image"===t.type?a.image=t.src:("svg"===t.type||"svg"in t)&&(a.image=t.svg),a.visibleTime=null!=(e=t.visibleTime)?e:"always",a.funcType=t.funcType,a.id=t.name,a.width=t.width,a.height=t.height,(t.marginRight||t.marginLeft)&&(a.margin=[0,null!=(i=t.marginRight)?i:0,0,null!=(r=t.marginLeft)?r:0]),t.hover&&(a.backgroundWidth=null!=(n=t.hover.width)?n:t.width,a.backgroundHeight=null!=(l=t.hover.height)?l:t.height,a.backgroundShowMode="hover",a.hoverImage=t.hover.image,a.backgroundStroke=!1,a.backgroundFill=null!=(s=t.hover.bgColor)?s:"rgba(22,44,66,0.2)"),t.cursor&&(a.cursor=t.cursor),a.tooltip=t.tooltip,a}function x(t,e,i,l,s,a,o,d,u){var c,p,f,y;let b;(0,g.Z)(t.contentWidth)&&(l=e-(null!=(c=t.contentWidth)?c:t.attribute.width));let _,C=0,x=0,w=0,S=0;t.forEachChildren(t=>{var e,i,r,n;"icon-left"===t.role?(C+=t.AABBBounds.width()+(null!=(e=t.attribute.marginLeft)?e:0)+(null!=(i=t.attribute.marginRight)?i:0),x=Math.max(x,t.AABBBounds.height())):"icon-right"===t.role&&(w+=t.AABBBounds.width()+(null!=(r=t.attribute.marginLeft)?r:0)+(null!=(n=t.attribute.marginRight)?n:0),S=Math.max(S,t.AABBBounds.height()))});let A=t.getChildByName("text"),M=t.getChildByName("content");A instanceof r.x?(_=A.AABBBounds.height(),A.setAttribute("maxLineWidth",e-C-w-(a[1]+a[3])-(null!=(p=A.attribute.dx)?p:0)-(null!=(f=u.table.theme._contentOffset)?f:0)),b=A.AABBBounds.height()):A instanceof n.H?(_=A.AABBBounds.height(),A.setAttribute("width",e-C-w-(a[1]+a[3])),b=A.AABBBounds.height()):M&&(_=M.AABBBounds.height(),M.updateWidth(e-C-w-(a[1]+a[3])),b=M.AABBBounds.height());let T=Math.round(Math.max(x,S,_)+a[0]+a[2]);if(t.forEachChildren(i=>{var r;if("icon-left"===i.role);else if("icon-right"===i.role)i.setAttribute("x",i.attribute.x+l);else if("icon-absolute-right"===i.role)i.setAttribute("x",i.attribute.x+l);else if("content"===i.name||"text"===i.name&&"richtext"!==i.type){let t=null!=(r=i.attribute.textAlign)?r:o;"center"===t?i.setAttribute("x",a[3]+C+(e-(a[1]+a[3])-C-w)/2):"right"===t&&i.setAttribute("x",a[3]+e-(a[1]+a[3])-w)}else"mark"===i.name&&i.setAttribute("x",t.attribute.width)}),s){let e=Math.max(x,b,S);if(function(t,e,i,r){let n=t.table,l=(0,h.Z)(n,e.col,e.row);if(l&&l.end.row-l.start.row){r/=l.end.row-l.start.row+1,i/=l.end.row-l.start.row+1;for(let t=l.start.row;t<=l.end.row;t++){let e=n.getRowHeight(t);if(e===r&&i!==e||i>e)return!0}}else{let t=n.getRowHeight(e.row);if(t===r&&i!==t||i>t)return!0}return!1}(u,t,Math.round(e+a[0]+a[2]),T))return u.table.hasListeners(v.B.AFTER_UPDATE_CELL_CONTENT_WIDTH)&&u.table.fireListeners(v.B.AFTER_UPDATE_CELL_CONTENT_WIDTH,{col:t.col,row:t.row,cellHeight:i,cellGroup:t,padding:a,textBaseline:d}),!0;e=(null!=(y=t.contentHeight)?y:i)-(a[0]+a[2]),t.forEachChildren(t=>{"rect"!==t.type&&"chart"!==t.type&&t.name!==m.FH&&("mark"===t.name?t.setAttribute("y",0):"middle"===d?t.setAttribute("y",a[0]+(e-t.AABBBounds.height())/2):"bottom"===d?t.setAttribute("y",a[0]+e-t.AABBBounds.height()):t.setAttribute("y",a[0]))})}else"middle"!==d&&"bottom"!==d||t.forEachChildren(t=>{"rect"!==t.type&&"chart"!==t.type&&t.name!==m.FH&&("mark"===t.name?t.setAttribute("y",0):"middle"===d?t.setAttribute("y",(i-a[2]+a[0]-t.AABBBounds.height())/2):"bottom"===d?t.setAttribute("y",i-t.AABBBounds.height()-a[2]):t.setAttribute("y",a[0]))});return u.table.hasListeners(v.B.AFTER_UPDATE_CELL_CONTENT_WIDTH)&&u.table.fireListeners(v.B.AFTER_UPDATE_CELL_CONTENT_WIDTH,{col:t.col,row:t.row,cellHeight:i,cellGroup:t,padding:a,textBaseline:d}),!1}function w(t,e,i,l,s,a,o,h){var d;let u=e-Math.floor(s[0]+s[2]),c=t.getChildByName("text");c instanceof r.x&&!l?c.setAttributes({heightLimit:!1===(null==(d=h.options.customConfig)?void 0:d.limitContentHeight)?-1:u}):c instanceof n.H&&!l?c.setAttributes({height:u}):t.getChildByName("content")&&t.getChildByName("content").updateHeight(u),t.forEachChildren(t=>{t.setAttribute("dy",0),"rect"===t.type||"chart"===t.type||t.name===m.FH||("mark"===t.name?t.setAttribute("y",0):"middle"===o?t.setAttribute("y",s[0]+(u-t.AABBBounds.height())/2):"bottom"===o?t.setAttribute("y",s[0]+u-t.AABBBounds.height()):t.setAttribute("y",s[0]))})}function S(t,e,i,r){let n=[],s=[],a=[],o=[],h=[],d=[],u=[],c=[],p=0,g=0,f=0,m=0,y=0,v=0;return t.forEach(t=>{switch(t.positionType){case l.q0.left:n.push(t);break;case l.q0.right:s.push(t);break;case l.q0.contentLeft:a.push(t);break;case l.q0.contentRight:o.push(t);break;case l.q0.absoluteRight:c.push(t);break;case l.q0.inlineFront:h.push(t);break;case l.q0.inlineEnd:d.push(t)}}),n.forEach(t=>{var n,l,s;let a=_(t,void 0,e.col,e.row,i,r);a.role="icon-left",a.name=t.name,a.setAttribute("x",p+(null!=(n=a.attribute.marginLeft)?n:0)),p+=a.AABBBounds.width()+(null!=(l=a.attribute.marginLeft)?l:0)+(null!=(s=a.attribute.marginRight)?s:0),g=Math.max(g,a.AABBBounds.height()),e.appendChild(a)}),s.forEach(t=>{var n,l,s;let a=_(t,void 0,e.col,e.row,i,r);a.role="icon-right",a.name=t.name,a.setAttribute("x",f+(null!=(n=a.attribute.marginLeft)?n:0)),f+=a.AABBBounds.width()+(null!=(l=a.attribute.marginLeft)?l:0)+(null!=(s=a.attribute.marginRight)?s:0),m=Math.max(m,a.AABBBounds.height()),e.appendChild(a)}),u.forEach(t=>{var n,l,s;let a=_(t,void 0,e.col,e.row,i,r);a.role="icon-absolute-left",a.name=t.name,a.setAttribute("x",y+(null!=(n=a.attribute.marginLeft)?n:0)),y+=a.AABBBounds.width()+(null!=(l=a.attribute.marginLeft)?l:0)+(null!=(s=a.attribute.marginRight)?s:0),e.appendChild(a)}),c.forEach(t=>{var n,l,s;let a=_(t,void 0,e.col,e.row,i,r);a.role="icon-absolute-right",a.name=t.name,a.setAttribute("x",v+(null!=(n=a.attribute.marginLeft)?n:0)),v+=a.AABBBounds.width()+(null!=(l=a.attribute.marginLeft)?l:0)+(null!=(s=a.attribute.marginRight)?s:0),e.appendChild(a)}),{leftIcons:n,rightIcons:s,contentLeftIcons:a,contentRightIcons:o,inlineFrontIcons:h,inlineEndIcons:d,absoluteLeftIcons:u,absoluteRightIcons:c,leftIconWidth:p,leftIconHeight:g,rightIconWidth:f,rightIconHeight:m,absoluteLeftIconWidth:y,absoluteRightIconWidth:v}}function A(t,e){if(t.hasOwnProperty("hoverIconId")){if(this.skipMergeUpdate)return;let e=(0,y.J$)(this);if(!e||!e.stage)return;let i=e.stage.table;this.skipAttributeUpdate=!0;let{mergeStartCol:r,mergeEndCol:n,mergeStartRow:l,mergeEndRow:s}=e;if((0,c.Z)(r)&&(0,c.Z)(n)&&(0,c.Z)(l)&&(0,c.Z)(s)&&(r!==n||l!==s)){for(let a=r;a<=n;a++)for(let r=l;r<=s;r++){if(a===e.col&&r===e.row){if(t.hoverIconId!==this.attribute.hoverIconId){let e=this._frameCache.icons.get(t.hoverIconId);this.updateHoverIconState(e)}continue}let n=i.scenegraph.highPerformanceGetCell(a,r);if("cell"===n.role){let e=n.getChildByName(this.name,!0);if(!e||e.skipAttributeUpdate)continue;t.hoverIconId!==e.attribute.hoverIconId&&(e.setAttribute("hoverIconId",t.hoverIconId),n.addUpdateBoundTag())}}this.skipAttributeUpdate=void 0}}}},61389:function(t,e,i){i.d(e,{QC:()=>b,Rc:()=>w,ZP:()=>f,fg:()=>_,sb:()=>C});var r=i(22415),n=i(31659),l=i(82265),s=i(68130),a=i(34505),o=i(63654),h=i(64449),d=i(64776);let u="",c="quick",p=new r.n((t,e,i,r)=>{i(n.j)?r(n.j).to(v).inSingletonScope():t(n.j).to(v).inSingletonScope()}),g=new r.n((t,e,i,r)=>{i(n.j)?r(n.j).to(n.f).inSingletonScope():t(n.j).to(n.f).inSingletonScope()}),f=p,m=new Map;function y(t,e,i,r="normal"){var n,a,o;let d=`${t}-${e}-${i}-${r}`,c=m.get(d);if(c)return c;let p=(n={fontSize:t,fontFamily:i,fontWeight:e,fontStyle:r},new h.e(Object.assign({defaultFontParams:{fontFamily:l.q9.fontFamily,fontSize:l.q9.fontSize},getTextBounds:o?void 0:s.o,specialCharSet:`{}()//&-/: .,@%'"~…=——${h.e.ALPHABET_CHAR_SET}${h.e.ALPHABET_CHAR_SET.toUpperCase()}0123456789${u}`},null!=a?a:{}),n));return m.set(d,p),p}class v extends n.f{_fastMeasure(t,e){let{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:n="normal",fontStyle:l="normal"}=e,s=y(i,n,r,l).measure(t,c);if(!(0,d.Z)(s.fontBoundingBoxAscent)&&!(0,d.Z)(s.fontBoundingBoxDescent)){let{ascent:t,descent:i}=this.measureTextBoundADscentEstimate(e);s.fontBoundingBoxAscent=t,s.fontBoundingBoxDescent=i}return s}measureTextWidth(t,e){return this._fastMeasure(t,e).width}measureText(t,e){return this._fastMeasure(t,e)}_measureTextWithoutAlignBaseline(t,e,i){return this._fastMeasure(t,e)}_measureTextWithAlignBaseline(t,e,i){return this._fastMeasure(t,e)}}let b=new class{measureText(t,e){let{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:n="normal",fontStyle:l="normal"}=e;return y(i,n,r,l).measure(t,c)}measureTextWidth(t,e){let{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:n="normal",fontStyle:l="normal"}=e;return y(i,n,r,l).measure(t,c).width}clipText(t,e,i){if(0===t.length)return{str:"",width:0};let r=this.measureTextWidth(t,e);return r<=i?{str:t,width:r}:(r=this.measureTextWidth(t[0],e))>i?{str:"",width:0}:this._clipText(t,e,i,0,t.length-1)}_clipText(t,e,i,r,n){let l,s=Math.floor((r+n)/2),a=t.substring(0,s+1),o=this.measureTextWidth(a,e);if(o>i){if(a.length<=1)return{str:"",width:0};let n=t.substring(0,s);return(l=this.measureTextWidth(n,e))<=i?{str:n,width:l}:this._clipText(t,e,i,r,s)}if(o<i){if(s>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};let r=t.substring(0,s+2);return(l=this.measureTextWidth(r,e))>=i?{str:a,width:o}:this._clipText(t,e,i,s,n)}return{str:a,width:o}}clipTextWithSuffix(t,e,i,r){if(""===r)return this.clipText(t,e,i);if(0===t.length)return{str:"",width:0};let n=this.measureTextWidth(t,e);if(n<=i)return{str:t,width:n};let l=this.measureTextWidth(r,e);if(l>i)return{str:"",width:0};i-=l;let s=this._clipText(t,e,i,0,t.length-1);return s.str+=r,s.width+=l,s}};function _(t){u=t,m.clear()}function C(){c="canvas",a.n.load(g)}let x=new o.x({ignoreBuf:!0});function w(t){return x.initAttributes(Object.assign(Object.assign({},t),{ignoreBuf:!0})),x.AABBBounds}},92158:function(t,e,i){function r(t,e,i){let r=i.getCellRange(t.col,t.row);if(i.isColumnHeader(t.col,t.row)||"column"===i.stateManager.columnMove.movingColumnOrRow&&0===t.row){let n=i.getCellRange(e.col,r.start.row);e.row>=i.columnHeaderLevelCount&&(e.row=Math.max(i.columnHeaderLevelCount-1,0)),e.col>=t.col?e.col=n.end.col:e.col=n.start.col}else if(i.isRowHeader(t.col,t.row)){let n=i.internalProps.layoutMap,l=i.getCellRange(r.start.col,e.row);if(e.col>=i.rowHeaderLevelCount+n.leftRowSeriesNumberColumnCount&&(e.col=i.rowHeaderLevelCount+n.leftRowSeriesNumberColumnCount-1),"tree"===n.rowHierarchyType){let r=n.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,l=n.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths;if(r.length<=l.length){let n=l[r.length-1];n&&(e.row>=t.row?e.row=n.startInTotal+n.size-1+i.columnHeaderLevelCount:e.row=n.startInTotal+i.columnHeaderLevelCount)}}else e.row>=t.row?e.row=l.end.row:e.row=l.start.row}return e}function n(t,e){if(e.internalProps._widthResizedColMap.size>0){let i=Array.from(e.internalProps._widthResizedColMap.keys());e.internalProps._widthResizedColMap.clear();for(let r=0;r<i.length;r++){let n,l=i[r],{sourceIndex:s,targetIndex:a,sourceSize:o}=t;n=l>=s&&l<s+o?a+(l-s):s<a?l>=s+o&&l<a||l>=a?l-o:l:l>=a&&l<s?l+o:l,e.internalProps._widthResizedColMap.add(n)}}}function l(t,e){if(e.internalProps._heightResizedRowMap.size>0){let i=Array.from(e.internalProps._heightResizedRowMap.keys());e.internalProps._heightResizedRowMap.clear();for(let r=0;r<i.length;r++){let n,l=i[r],{sourceIndex:s,targetIndex:a,sourceSize:o}=t;n=l>=s&&l<s+o?a+(l-s):s<a?l>=s+o&&l<a||l>=a?l-o:l:l>=a&&l<s?l+o:l,e.internalProps._heightResizedRowMap.add(n)}}}function s(t,e,i){let r=Array.from(t.internalProps._heightResizedRowMap.keys()),n=e+(t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount);for(let e=0;e<r.length;e++)r[e]>=n&&(t.internalProps._heightResizedRowMap.delete(r[e]),t.internalProps._heightResizedRowMap.add(r[e]+i.length))}function a(t,e){let i=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount;e.sort((t,e)=>e-t);for(let r=0;r<e.length;r++){let n=e[r]+i,l=Array.from(t.internalProps._heightResizedRowMap.keys());for(let e=0;e<l.length;e++)l[e]===n?t.internalProps._heightResizedRowMap.delete(l[e]):l[e]>n&&(t.internalProps._heightResizedRowMap.delete(l[e]),t.internalProps._heightResizedRowMap.add(l[e]-1))}}i.d(e,{$Q:()=>r,J7:()=>l,UF:()=>s,b:()=>a,ct:()=>n})},87474:function(t,e,i){i.d(e,{Bd:()=>f,GW:()=>c,Jd:()=>m,Pi:()=>g,Vz:()=>u,Y:()=>h,aC:()=>b,gs:()=>p,hR:()=>v,r5:()=>y});var r=i(64776),n=i(96241),l=i(80971),s=i(4654),a=i(95723),o=i(23975);function h(t,e,i,r,n){let l=n.table.getCellRange(t,e);if(l.start.col!==l.end.col||l.start.row!==l.end.row)for(let t=l.start.col;t<=l.end.col;t++)for(let e=l.start.row;e<=l.end.row;e++)d(t,e,i,r,n);else d(t,e,i,r,n)}function d(t,e,i,r,n){let l=n.table.getRecordShowIndexByCell(t,e);if(l>=0){let t=n.table.dataSource.getIndexKey(l).toString();n.checkedState.get(t)?n.checkedState.get(t)[i]=r:n.checkedState.set(t,{[i]:r})}}function u(t,e,i){var r;i.headerCheckedState[t]=e,i.table.internalProps.enableCheckboxCascade&&(null==(r=i.checkedState)||r.forEach(i=>{i[t]=e}))}function c(t,e,i,n,l){var s,a;if(l.table.isHeader(t,e)){if((0,r.Z)(l.headerCheckedState[i]))return l.headerCheckedState[i];if("function"==typeof n)return;if((0,r.Z)(n))l.headerCheckedState[i]=n;else if((null==(s=l.checkedState)?void 0:s.size)>0)return l.updateHeaderCheckedState(i,t,e);return l.headerCheckedState[i]}let o=l.table.getRecordShowIndexByCell(t,e);if(o>=0){let t=l.table.dataSource.getIndexKey(o).toString();if((0,r.Z)(null==(a=l.checkedState.get(t))?void 0:a[i]))return l.checkedState.get(t)[i];if(l.checkedState.get(t))l.checkedState.get(t)[i]=n;else if(l.table.internalProps.enableCheckboxCascade&&t.includes(",")){let e=t.split(",").slice(0,-1).join(",");l.checkedState.has(e)&&!0===l.checkedState.get(e)[i]?l.checkedState.set(t,{[i]:!0}):l.checkedState.set(t,{[i]:n})}else l.checkedState.set(t,{[i]:n})}return n}function p(t,e){e.checkedState.clear(),e.headerCheckedState={},e.radioState={};let i=!1;if(e._checkboxCellTypeFields=[],e._headerCheckFuncs={},e.table.internalProps.layoutMap.headerObjects.forEach((t,r)=>{if("checkbox"===t.headerType){let r=t.define.checked;null==r||"function"==typeof r?(i=!0,"function"==typeof r&&(e._headerCheckFuncs[t.field]=r)):e.headerCheckedState[t.field]=r,"checkbox"!==t.define.cellType&&!(0,n.Z)(t.define.cellType)||t.fieldFormat||e._checkboxCellTypeFields.push(t.field)}}),1===e.table.leftRowSeriesNumberCount)e.headerCheckedState._vtable_rowSeries_number=!1,e._checkboxCellTypeFields.push("_vtable_rowSeries_number"),i=!0;else if(e.table.leftRowSeriesNumberCount>1){for(let t=0;t<e.table.leftRowSeriesNumberCount;t++)e.headerCheckedState[`_vtable_rowSeries_number_${t}`]=!1,e._checkboxCellTypeFields.push(`_vtable_rowSeries_number_${t}`);i=!0}i&&function(t,e){let i=e.table,r=i.isPivotTable()?0:i.internalProps.transpose?i.rowHeaderLevelCount:i.columnHeaderLevelCount,n=i.isPivotTable()?(0,a.Z)(t)?t.length:0:i.internalProps.transpose?i.colCount:i.rowCount;for(let s=0;s+r<n;s++){let r=i.isPivotTable()?t[s]:i.dataSource.get(s);e._checkboxCellTypeFields.forEach(t=>{let n,a=r&&r[t];if((0,l.Z)(a)?n=a.checked:"boolean"==typeof a&&(n=a),null==n){let i=e._headerCheckFuncs[t];if(i){let r=e.table.getCellAddrByFieldRecord(t,s);n=(0,o.vi)(i,{col:r.col,row:r.row,table:e.table,context:null,value:a})}}let h=i.isPivotTable()?s.toString():e.table.dataSource.getIndexKey(s).toString();e.checkedState.get(h)||e.checkedState.set(h,{}),e.checkedState.get(h)[t]=n})}}(t,e)}function g(t,e,i,r){let n=!0,l=!0,s=!1;return e.checkedState.forEach((a,o)=>{var h;o=o.includes(",")?o.split(",").map(t=>Number(t)):Number(o);let d=e.table.getTableIndexByRecordIndex(o),u=e.table.transpose?e.table.getCustomMerge(d,r):e.table.getCustomMerge(i,d),c=null==(h=e.table.dataSource)?void 0:h.get(o);u||!e.table.internalProps.enableCheckboxCascade&&(null==c?void 0:c.vtableMerge)||(!0!==(null==a?void 0:a[t])?n=!1:(l=!1,s=!0))}),n?(e.headerCheckedState[t]=!0,n):l?(e.headerCheckedState[t]=!1,!1):!!s&&(e.headerCheckedState[t]="indeterminate","indeterminate")}function f(t,e){for(let i=e.checkedState.size;i<t.length;i++){let r=t[i];e._checkboxCellTypeFields.forEach(t=>{let n,s=r[t];(0,l.Z)(s)?n=s.checked:"boolean"==typeof s&&(n=s);let a=i.toString();e.checkedState.get(a)||e.checkedState.set(a,{}),e.checkedState.get(a)[t]=n})}}function m(t,e,i,r){var n,l;let s=r.scenegraph.getCell(t,e),a=(null==s?void 0:s.getChildByName("checkbox"))||(null==(l=null==(n=null==s?void 0:s.getChildByName("checkbox-content"))?void 0:n._checkboxGroup)?void 0:l.getChildByName("checkbox"));if(!a){let n=r.getHeaderField(t,e);if(r.isHeader(t,e))r.stateManager.setHeaderCheckedState(n,i),"checkbox"===r.getCellType(t,e)&&r.scenegraph.updateCheckboxCellState(t,e,i);else if(r.stateManager.setCheckedState(t,e,n,i),"checkbox"===r.getCellType(t,e)){let i=r.stateManager.headerCheckedState[n],l=r.stateManager.updateHeaderCheckedState(n,t,e);i!==l&&r.scenegraph.updateHeaderCheckboxCellState(t,e,l)}return}let{checked:o,indeterminate:h}=a.attribute;h?(i||a._handlePointerUp(),a._handlePointerUp()):o?i||a._handlePointerUp():i&&a._handlePointerUp()}function y(t,e,i,r){var n,l;let s=r.scenegraph.getCell(t,e),a=(null==s?void 0:s.getChildByName("checkbox"))||(null==(l=null==(n=null==s?void 0:s.getChildByName("checkbox-content"))?void 0:n._checkboxGroup)?void 0:l.getChildByName("checkbox"));a&&("indeterminate"===i?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",i)))}function v(t,e,i){let r,n,{checkedState:l,table:o}=i;if(o.internalProps.transpose?(t=o.getRecordShowIndexByCell(t,0),e=o.getRecordShowIndexByCell(e,0)):(r=o.isPivotTable()?void 0:o.getRecordIndexByCell(0,t),n=o.isPivotTable()?void 0:o.getRecordIndexByCell(0,e)),(0,s.Z)(r)&&(0,s.Z)(n)){if((t=r)>(e=n)){let i=l.get(t.toString());for(let i=t;i>e;i--)l.set(i.toString(),l.get((i-1).toString()));l.set(e.toString(),i)}else if(t<e){let i=l.get(t.toString());for(let i=t;i<e;i++)l.set(i.toString(),l.get((i+1).toString()));l.set(e.toString(),i)}}else if((0,a.Z)(r)&&(0,a.Z)(n)){if((t=r[r.length-1])>(e=n[n.length-1])){let i=l.get(r.toString());for(let i=t;i>e;i--){let t=[...r];t[t.length-1]=i;let e=[...r];e[e.length-1]=i-1,l.set(t.toString(),l.get(e.toString()))}l.set(n.toString(),i)}else if(t<e){let i=l.get(r.toString());for(let i=t;i<e;i++){let t=[...r];t[t.length-1]=i;let e=[...r];e[e.length-1]=i+1,l.set(t.toString(),l.get(e.toString()))}l.set(n.toString(),i)}}}function b(t){let e=[],i=t.dataSource,r=i.dataConfig.groupByRules.length+1;return i.currentIndexedData.forEach((n,l)=>{(0,a.Z)(n)&&n.length===r&&(e[i.getOriginRecordIndexForGroup(n)]=t.stateManager.checkedState.get(n.toString()))}),e}},85109:function(t,e,i){i.d(e,{J:()=>a});var r=i(32802),n=i(97266),l=i(64776),s=i(4713);function a(t,e){var i,n,a,h,d,u,c,p,g,f,m;let y,v;if("cell"===t.role&&(0,l.Z)(t.mergeStartCol)&&(0,l.Z)(t.mergeStartRow)&&(0,l.Z)(t.mergeEndCol)&&(0,l.Z)(t.mergeEndRow)){let{colStart:i,colEnd:r,rowStart:n,rowEnd:l}=(0,s.e)(t,e.scenegraph);for(let s=i;s<=r;s++)for(let i=n;i<=l;i++){let r=o(e.stateManager,s,i,t);!r||y&&"cellBgColor"!==r||(y=r)}}else"cell"===t.role&&(y=o(e.stateManager,t.col,t.row,t));if(!y)return;let b=e.internalProps.layoutMap;return b.isCornerHeader(t.col,t.row)?v=(null==(i=e.theme.cornerHeaderStyle)?void 0:i.hover)||(null==(n=e.theme.headerStyle)?void 0:n.hover):b.isColumnHeader(t.col,t.row)?v=null==(a=e.theme.headerStyle)?void 0:a.hover:b.isRowHeader(t.col,t.row)?v=null==(h=e.theme.rowHeaderStyle)?void 0:h.hover:b.isBottomFrozenRow(t.col,t.row)?v=(null==(d=e.theme.bottomFrozenStyle)?void 0:d.hover)||(e.isListTable()?null==(u=e.theme.bodyStyle)?void 0:u.hover:null==(c=e.theme.headerStyle)?void 0:c.hover):b.isRightFrozenColumn(t.col,t.row)?v=(null==(p=e.theme.rightFrozenStyle)?void 0:p.hover)||(e.isListTable()?null==(g=e.theme.bodyStyle)?void 0:g.hover:null==(f=e.theme.rowHeaderStyle)?void 0:f.hover):e.isHeader(t.col,t.row)||(v=null==(m=e.theme.bodyStyle)?void 0:m.hover),(0,r.WJ)(y,v,t.col,t.row,e)}function o(t,e,i,r){var l;let s,{highlightScope:a,disableHeader:o,cellPos:h}=t.hover,d=t.table,u=d.isHeader(e,i);if(!u||!o){if(a===n.p.single&&h.col===e&&h.row===i?s="cellBgColor":a===n.p.column&&h.col===e?s=h.col===e&&h.row===i?"cellBgColor":"inlineColumnBgColor":a===n.p.row&&h.row===i?s=h.col===e&&h.row===i?"cellBgColor":"inlineRowBgColor":a===n.p.cross&&(h.col===e&&h.row===i?s="cellBgColor":h.col===e?s="inlineColumnBgColor":h.row===i&&(s="inlineRowBgColor")),s){let t;if(u){let n=d.getHeaderDefine(e,i);t=null==n?void 0:n.disableHeaderHover,r.firstChild&&"axis"===r.firstChild.name&&(null==(l=d.options.hover)?void 0:l.disableAxisHover)&&(t=!0)}else{let r=d.getBodyColumnDefine(e,i);t=null==r?void 0:r.disableHover}t&&(s=void 0)}return s}}},54396:function(t,e,i){i.d(e,{Oq:()=>a,Wg:()=>o,fM:()=>h,tO:()=>u,vj:()=>d});var r=i(4654),n=i(64776),l=i(80971),s=i(63778);function a(t,e,i,n,l,s){let a=s.table.getRecordShowIndexByCell(t,e);if(a>=0){let t=s.table.dataSource.getIndexKey(a);"column"===n?(0,r.Z)(l)?(s.radioState[i]={},s.radioState[i][t]=l):s.radioState[i]=t:(s.radioState[i]||(s.radioState[i]={}),(0,r.Z)(l)?s.radioState[i][t]=l:s.radioState[i][t]=!0)}}function o(t,e,i){var s;let a=i.getBodyColumnDefine(t,e),o=null==a?void 0:a.field,h=i.getCellType(t,e);if((0,n.Z)(o)&&"radio"===h){let n=i.dataSource.getIndexKey(i.getRecordShowIndexByCell(t,e)),a=null==(s=i.stateManager.radioState)?void 0:s[o];if((0,r.Z)(a)){if(a===n)return!0}else if((0,l.Z)(a)){let t=a[n];if((0,r.Z)(t))return t}}return!1}function h(t,e,i,a,o,h,d){var u,c,p,g,f;let m=d.table.getRecordShowIndexByCell(t,e);if(m>=0){let t=d.table.dataSource.getIndexKey(m);if("column"===a){if(!(0,n.Z)(d.radioState[i])&&h)return(0,r.Z)(o)?(d.radioState[i]={},d.radioState[i][t]=o):d.radioState[i]=t,!0;if((0,r.Z)(d.radioState[i])&&!(0,r.Z)(o))return d.radioState[i]===t;if((0,r.Z)(d.radioState[i])&&(0,r.Z)(o)||(0,l.Z)(d.radioState[i])&&!(0,r.Z)(o))return!1;if((0,l.Z)(d.radioState[i])&&(0,r.Z)(o))return d.radioState[i][t]===o}else if("cell"===a){if(!(0,n.Z)(d.radioState[i])&&h)return d.radioState[i]={},(0,r.Z)(o)?d.radioState[i][t]=o:d.radioState[i][t]=!0,!0;if(!(0,n.Z)(null==(u=d.radioState[i])?void 0:u[t])&&h)return(0,r.Z)(o)?d.radioState[i][t]=o:d.radioState[i][t]=!0,!0;if((0,s.Z)(null==(c=d.radioState[i])?void 0:c[t])&&!(0,r.Z)(o))return d.radioState[i][t];if((0,s.Z)(null==(p=d.radioState[i])?void 0:p[t])&&(0,r.Z)(o)||(0,r.Z)(null==(g=d.radioState[i])?void 0:g[t])&&!(0,r.Z)(o))return!1;if((0,r.Z)(null==(f=d.radioState[i])?void 0:f[t])&&(0,r.Z)(o))return d.radioState[i][t]===o}}return h}function d(t,e,i,n){let l=n.scenegraph.getCell(t,e);if(l)if((0,r.Z)(i)){let t=l.getChildAt(i);null==t||t._handlePointerUp()}else{let t=l.getChildByName("radio");null==t||t._handlePointerUp()}}function u(t,e,i){let{radioState:r,table:n}=i;if(n.internalProps.transpose?(t=n.getRecordShowIndexByCell(t,0),e=n.getRecordShowIndexByCell(e,0)):(t=n.getRecordShowIndexByCell(0,t),e=n.getRecordShowIndexByCell(0,e)),t>e){let i=r[t];for(let i=t;i>e;i--)r[i]=r[i-1];r[e]=i}else if(t<e){let i=r[t];for(let i=t;i<e;i++)r[i]=r[i+1];r[e]=i}}},31413:function(t,e,i){i.r(e),i.d(e,{DEFAULT:()=>b,SIMPLIFY:()=>_,BRIGHT:()=>y,DARK:()=>m,default:()=>A,ARCO:()=>v,TableTheme:()=>g,get:()=>S,of:()=>w,theme:()=>x});var r=i(23975);let n={name:"DARK",underlayBackgroundColor:"transparent",defaultStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},headerStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},rowHeaderStyle:{},cornerHeaderStyle:{},bodyStyle:{color:"#e5e7ea",bgColor:function(t){let{row:e,table:i}=t;return 1&e-i.frozenRowCount?"#282a2e":"#2d3137"},fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#29364D"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:10,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(255, 255, 255, 0.1)",cellBorderColor:"#4284FF",cellBorderLineWidth:2},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"},functionalIconsStyle:{sort_color:"#FFFFFF",sort_color_opacity:"0.75",sort_color_2:"#416EFF",sort_color_opacity_2:"1",frozen_color:"#FFFFFF",frozen_color_opacity:"0.75",collapse_color:"#FFF",collapse_color_opacity:"0.75",expand_color:"#FFF",expand_color_opacity:"0.75",dragReorder_color:"#FFF",dragReorder_color_opacity:"0.75"}},l={name:"BRIGHT",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#5286FA",hover:{cellBgColor:"#2E67E3"}},headerStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#A1C1FF",hover:{cellBgColor:"#2E67E3"}},bodyStyle:{color:"#000",bgColor:function(t){let{row:e,table:i}=t;return 1&e-i.frozenRowCount?"#FFF":"#F4F8FF"},borderColor:"#E0EAFE",hover:{cellBgColor:"#E9EFFD"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"#CBDCFE",endColor:"#CBDCFE",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},s={name:"ARCO",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12]},headerStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},rowHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},cornerHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},bodyStyle:{padding:[8,12,8,12],color:"#141414",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:400,textAlign:"left",bgColor:function(t){let{row:e,table:i}=t;return 1&e-i.frozenRowCount?"#fbfbfc":"#FFF"},borderColor:"#e1e4e8",lineHeight:14,hover:{cellBgColor:"#F7F8FA",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:4,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#3073f2"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},a={name:"DEFAULT",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:"#E1E4E8",color:"#000",bgColor:"#ECF1F5"},headerStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},rowHeaderStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},cornerHeaderStyle:{fontSize:16,fontWeight:"bold"},bodyStyle:{fontSize:14,bgColor:function(t){let{row:e,table:i}=t;return 1&e-i.frozenRowCount?"#FDFDFD":"#FAF9FB"},hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"rgba(225, 228, 232, 0.6)",endColor:"rgba(225, 228, 232, 0.6)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#0000ff"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},o={name:"SIMPLIFY",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:function(t){let{col:e,table:i}=t,{colCount:r,frozenColCount:n}=i,l="#ccc7c7";return n-1===e||r-1===e?[l,"#f2f2f2","#ccc7c7",null]:[l,null,"#ccc7c7",null]},hover:{cellBorderColor:"#0000FF",cellBgColor:"#D0E0E3"},bgColor:"#FFF"},headerStyle:{color:"rgba(0, 0, 0, 0.87)",borderColor:function(t){let{row:e,table:{frozenRowCount:i}}=t;return i-1===e?["#f2f2f2","#f2f2f2","#ccc7c7","#f2f2f2"]:["#f2f2f2"]}},bodyStyle:{color:"rgba(0, 0, 0, 0.87)"},frameStyle:{borderColor:"#f2f2f2",borderLineWidth:1},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF"},selectionStyle:{cellBorderColor:"#FD5",cellBgColor:"rgba(111, 168, 220, 0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};var h=i(10869),d=i(6958),u=i(77874);let c={visible:!0,position:"auto",padding:8,titleStyle:{fontSize:12,fontWeight:"bold",fill:"#4E5969"},contentStyle:{fontSize:12,fill:"#4E5969"},panel:{visible:!0,fill:"#fff",stroke:"#ffffff",lineWidth:0,cornerRadius:3,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:"rgba(0, 0, 0, 0.1)",size:0,space:12}};function p(t,e,i,n){var l,s,a;return null!=(a=null!=(s=null!=(l=(0,r.TS)(t,...i))?l:(0,r.TS)(e,...i))?s:n&&(0,r.TS)(t,...n))?a:n&&(0,r.TS)(e,...n)}class g{constructor(t,e){this._defaultStyle=null,this._header=null,this._cornerHeader=null,this._cornerRightTopCell=null,this._cornerLeftBottomCell=null,this._cornerRightBottomCell=null,this._rightFrozen=null,this._bottomFrozen=null,this._rowHeader=null,this._body=null,this._groupTitle=null,this._scroll=null,this._tooltip=null,this._frameStyle=null,this._columnResize=null,this._dragHeaderSplitLine=null,this._frozenColumnLine=null,this._selectionStyle=null,this._axisStyle=null,this._checkboxStyle=null,this._radioStyle=null,this._switchStyle=null,this._buttonStyle=null,this._textPopTipStyle=null,this._internalIconsStyle=null,this.isPivot=!1,this.name="",this.internalTheme={obj:t,superTheme:e},this.name=p(t,e,["name"])}getExtendTheme(){return this.internalTheme.obj}clearBodyStyleCache(){this._body=null}get font(){let{obj:t,superTheme:e}=this.internalTheme;return p(t,e,["font"],["bodyStyle","font"])}get underlayBackgroundColor(){let{obj:t,superTheme:e}=this.internalTheme;return p(t,e,["underlayBackgroundColor"])}get cellInnerBorder(){var t;let{obj:e,superTheme:i}=this.internalTheme;return null==(t=p(e,i,["cellInnerBorder"]))||t}get cellBorderClipDirection(){var t;let{obj:e,superTheme:i}=this.internalTheme;return null!=(t=p(e,i,["cellBorderClipDirection"]))?t:"top-left"}get _contentOffset(){var t;let{obj:e,superTheme:i}=this.internalTheme;return null!=(t=p(e,i,["_contentOffset"]))?t:0}get defaultStyle(){let t=this;if(!this._defaultStyle){let{obj:X,superTheme:Y}=this.internalTheme,$=(0,d.je)({},Y.defaultStyle,X.defaultStyle);this._defaultStyle={get fontSize(){var e;return null!=(e=$.fontSize)?e:u.ho},get fontFamily(){var i;return null!=(i=$.fontFamily)?i:u.Rk},get fontWeight(){return $.fontWeight},get fontVariant(){return $.fontVariant},get fontStyle(){return $.fontStyle},get bgColor(){var r;return null!=(r=$.bgColor)?r:u.aE},get color(){var n;return null!=(n=$.color)?n:u.yZ},get borderColor(){var l;return null!=(l=$.borderColor)?l:u.cT},get borderLineWidth(){var s;return null!=(s=$.borderLineWidth)?s:u.zY},get borderLineDash(){var a;return null!=(a=$.borderLineDash)?a:u.z8},get hover(){if($.hover)return{get cellBgColor(){var o,h;return null!=(h=null==(o=$.hover)?void 0:o.cellBgColor)?h:void 0},get inlineColumnBgColor(){var c,p,g,f,m,y,v;return null!=(v=null!=(p=null==(c=$.hover)?void 0:c.inlineColumnBgColor)?p:(null==(g=$.hover)?void 0:g.cellBgColor)&&"string"==typeof(null==(f=$.hover)?void 0:f.cellBgColor)&&"transparent"!==(null==(m=$.hover)?void 0:m.cellBgColor)?(0,d.zX)(null==(y=$.hover)?void 0:y.cellBgColor,.1,!1):void 0)?v:void 0},get inlineRowBgColor(){var b,_,C,x,w,S,A;return null!=(A=null!=(_=null==(b=$.hover)?void 0:b.inlineRowBgColor)?_:(null==(C=$.hover)?void 0:C.cellBgColor)&&"string"==typeof(null==(x=$.hover)?void 0:x.cellBgColor)&&"transparent"!==(null==(w=$.hover)?void 0:w.cellBgColor)?(0,d.zX)(null==(S=$.hover)?void 0:S.cellBgColor,.1,!1):void 0)?A:void 0}}},get select(){if($.select)return{get inlineColumnBgColor(){var M,T,k,R,P,B;return null!=(B=null!=(R=null!=(T=null==(M=$.select)?void 0:M.inlineColumnBgColor)?T:null==(k=t.selectionStyle)?void 0:k.inlineColumnBgColor)?R:(null==(P=t.selectionStyle)?void 0:P.cellBgColor)&&"string"==typeof t.selectionStyle.cellBgColor&&"transparent"!==t.selectionStyle.cellBgColor?(0,d.zX)(t.selectionStyle.cellBgColor,.1,!1):void 0)?B:void 0},get inlineRowBgColor(){var I,E,L,F,O;return null!=(O=null!=(L=null!=(E=null==(I=$.select)?void 0:I.inlineRowBgColor)?E:t.selectionStyle.inlineRowBgColor)?L:(null==(F=t.selectionStyle)?void 0:F.cellBgColor)&&"string"==typeof t.selectionStyle.cellBgColor&&"transparent"!==t.selectionStyle.cellBgColor?(0,d.zX)(t.selectionStyle.cellBgColor,.1,!1):void 0)?O:void 0}}},get padding(){var H;return null!=(H=$.padding)?H:[10,16,10,16]},get textAlign(){var D;return null!=(D=$.textAlign)?D:"left"},get textStickBaseOnAlign(){return $.textStickBaseOnAlign},get textBaseline(){var z;return null!=(z=$.textBaseline)?z:"middle"},get textOverflow(){var W;return null!=(W=$.textOverflow)?W:"ellipsis"},get lineHeight(){return $.lineHeight},get autoWrapText(){var Z;return null!=(Z=$.autoWrapText)&&Z},get lineClamp(){var N;return null!=(N=$.lineClamp)?N:"auto"},get linkColor(){var j;return null!=(j=$.linkColor)?j:"#3772ff"},get cursor(){var G;return null!=(G=$.cursor)?G:"auto"},get marked(){var V;return null!=(V=$.marked)&&V},get underline(){var U;return null!=(U=$.underline)&&U},get underlineColor(){return $.underlineColor},get underlineDash(){return $.underlineDash},get underlineOffset(){return $.underlineOffset},get lineThrough(){var K;return null!=(K=$.lineThrough)&&K},get lineThroughColor(){return $.lineThroughColor},get lineThroughDash(){return $.lineThroughDash}}}return this._defaultStyle}get cornerHeaderStyle(){if(!this._cornerHeader){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},this.defaultStyle,e.cornerHeaderStyle,t.cornerHeaderStyle);this._cornerHeader=this.getStyle(i)}return this._cornerHeader}get cornerRightTopCellStyle(){if(!this._cornerRightTopCell){let{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightTopCellStyle&&!t.cornerRightTopCellStyle)return this._cornerRightTopCell;let i=(0,d.je)({},this.defaultStyle,e.cornerRightTopCellStyle,t.cornerRightTopCellStyle);this._cornerRightTopCell=this.getStyle(i)}return this._cornerRightTopCell}get cornerLeftBottomCellStyle(){if(!this._cornerLeftBottomCell){let{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerLeftBottomCellStyle&&!t.cornerLeftBottomCellStyle)return this._cornerLeftBottomCell;let i=(0,d.je)({},this.defaultStyle,e.cornerLeftBottomCellStyle,t.cornerLeftBottomCellStyle);this._cornerLeftBottomCell=this.getStyle(i)}return this._cornerLeftBottomCell}get cornerRightBottomCellStyle(){if(!this._cornerRightBottomCell){let{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightBottomCellStyle&&!t.cornerRightBottomCellStyle)return this._cornerRightBottomCell;let i=(0,d.je)({},this.defaultStyle,e.cornerRightBottomCellStyle,t.cornerRightBottomCellStyle);this._cornerRightBottomCell=this.getStyle(i)}return this._cornerRightBottomCell}get rightFrozenStyle(){if(!this._rightFrozen){let{obj:t,superTheme:e}=this.internalTheme;if(!e.rightFrozenStyle&&!t.rightFrozenStyle)return this._rightFrozen;let i=(0,d.je)({},this.defaultStyle,this.rowHeaderStyle,e.rightFrozenStyle,t.rightFrozenStyle);this._rightFrozen=this.getStyle(i)}return this._rightFrozen}get bottomFrozenStyle(){if(!this._bottomFrozen){let{obj:t,superTheme:e}=this.internalTheme;if(!e.bottomFrozenStyle&&!t.bottomFrozenStyle)return this._bottomFrozen;let i=(0,d.je)({},this.defaultStyle,this.headerStyle,e.bottomFrozenStyle,t.bottomFrozenStyle);this._bottomFrozen=this.getStyle(i)}return this._bottomFrozen}get rowHeaderStyle(){var t;if(!this._rowHeader){let{obj:e,superTheme:i}=this.internalTheme,r=(0,d.je)({},this.defaultStyle,i.rowHeaderStyle,null!=(t=e.rowHeaderStyle)?t:this.isPivot?null:e.headerStyle);this._rowHeader=this.getStyle(r)}return this._rowHeader}get headerStyle(){if(!this._header){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},this.defaultStyle,e.headerStyle,t.headerStyle);this._header=this.getStyle(i)}return this._header}get bodyStyle(){if(!this._body){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},this.defaultStyle,e.bodyStyle,t.bodyStyle);this._body=this.getStyle(i)}return this._body}get groupTitleStyle(){if(!this._groupTitle){let{obj:t,superTheme:e}=this.internalTheme;if(!e.groupTitleStyle&&!t.groupTitleStyle)return this._groupTitle;let i=(0,d.je)({},this.defaultStyle,e.groupTitleStyle,t.groupTitleStyle);this._groupTitle=this.getStyle(i)}return this._groupTitle}get frameStyle(){if(!this._frameStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},e.frameStyle,t.frameStyle);this._frameStyle={get borderColor(){return i.borderColor},get borderLineWidth(){return i.borderLineWidth},get borderLineDash(){return i.borderLineDash},get innerBorder(){return i.innerBorder},get shadowBlur(){return i.shadowBlur},get shadowColor(){return i.shadowColor},get shadowOffsetX(){return i.shadowOffsetX},get shadowOffsetY(){return i.shadowOffsetY},get cornerRadius(){return i.cornerRadius}}}return this._frameStyle}get scrollStyle(){if(!this._scroll){let{obj:o,superTheme:h}=this.internalTheme,u=(0,d.je)({},h.scrollStyle,o.scrollStyle);this._scroll={get scrollSliderColor(){var t;return null!=(t=u.scrollSliderColor)?t:"#C0C0C0"},get scrollSliderCornerRadius(){return u.scrollSliderCornerRadius},get scrollRailColor(){return u.scrollRailColor},get visible(){var e;return null!=(e=u.visible)?e:"scrolling"},get verticalVisible(){return u.verticalVisible},get horizontalVisible(){return u.horizontalVisible},get width(){var i;return null!=(i=u.width)?i:7},get hoverOn(){var r;return null==(r=u.hoverOn)||r},get barToSide(){var n;return null!=(n=u.barToSide)&&n},get horizontalPadding(){var l;return null!=(l=u.horizontalPadding)?l:0},get verticalPadding(){var s;return null!=(s=u.verticalPadding)?s:0},get ignoreFrozenCols(){var a;return null!=(a=u.ignoreFrozenCols)&&a}}}return this._scroll}get tooltipStyle(){if(!this._tooltip){let{obj:l,superTheme:s}=this.internalTheme,a=(0,d.je)({},s.tooltipStyle,l.tooltipStyle);this._tooltip={get fontFamily(){var t;return null!=(t=a.fontFamily)?t:u.Rk},get fontSize(){var e;return null!=(e=a.fontSize)?e:u.ho},get bgColor(){var i;return null!=(i=a.bgColor)?i:"#000"},get padding(){var r;return null!=(r=a.padding)?r:[6,8]},get color(){var n;return null!=(n=a.color)?n:"#FFF"},get maxWidth(){return a.maxWidth},get maxHeight(){return a.maxHeight}}}return this._tooltip}get columnResize(){if(!this._columnResize){let{obj:p,superTheme:g}=this.internalTheme,f=(0,d.je)({},g.columnResize,p.columnResize);this._columnResize={get lineColor(){var t;return null!=(t=f.lineColor)?t:"#416EFF"},get bgColor(){var e;return null!=(e=f.bgColor)?e:"#D9E2FF"},get lineWidth(){var i;return null!=(i=f.lineWidth)?i:1},get width(){var r;return null!=(r=f.width)?r:f.lineWidth+2},get resizeHotSpotSize(){var n;return null!=(n=f.resizeHotSpotSize)?n:16},get labelColor(){var l;return null!=(l=f.labelColor)?l:"#FFF"},get labelFontSize(){var s;return null!=(s=f.labelFontSize)?s:10},get labelFontFamily(){var a;return null!=(a=f.labelFontFamily)?a:"sans-serif"},get labelBackgroundFill(){var o;return null!=(o=f.labelBackgroundFill)?o:"#3073F2"},get labelBackgroundCornerRadius(){var h;return null!=(h=f.labelBackgroundCornerRadius)?h:5},get labelVisible(){var u;return null==(u=f.labelVisible)||u},get visibleOnHover(){var c;return null!=(c=f.visibleOnHover)&&c}}}return this._columnResize}get dragHeaderSplitLine(){if(!this._dragHeaderSplitLine){let{obj:r,superTheme:n}=this.internalTheme,l=(0,d.je)({},n.dragHeaderSplitLine,r.dragHeaderSplitLine);this._dragHeaderSplitLine={get lineColor(){var t;return null!=(t=l.lineColor)?t:"blue"},get lineWidth(){var e;return null!=(e=l.lineWidth)?e:2},get shadowBlockColor(){var i;return null!=(i=l.shadowBlockColor)?i:"rgba(204,204,204,0.3)"}}}return this._dragHeaderSplitLine}get frozenColumnLine(){if(!this._frozenColumnLine){let{obj:C,superTheme:x}=this.internalTheme,w=(0,d.je)({},x.frozenColumnLine,C.frozenColumnLine);this._frozenColumnLine={get shadow(){if(w.shadow)return{get width(){var t,e;return null!=(e=null==(t=w.shadow)?void 0:t.width)?e:24},get startColor(){var i,r;return null!=(r=null==(i=w.shadow)?void 0:i.startColor)?r:"rgba(00, 24, 47, 0.06)"},get endColor(){var n,l;return null!=(l=null==(n=w.shadow)?void 0:n.endColor)?l:"rgba(00, 24, 47, 0)"},get visible(){var s,a;return null!=(a=null==(s=w.shadow)?void 0:s.visible)?a:"always"}}},get border(){if(w.border)return{get lineColor(){var o,h;return null!=(h=null==(o=w.border)?void 0:o.lineColor)?h:"rgba(00, 24, 47, 0.06)"},get bgColor(){var u,c,p,g;return null!=(g=null!=(c=null==(u=w.border)?void 0:u.bgColor)?c:null==(p=w.border)?void 0:p.lineColor)?g:"rgba(00, 24, 47, 0.06)"},get lineWidth(){var f,m;return null!=(m=null==(f=w.border)?void 0:f.lineWidth)?m:4},get width(){var y,v,b,_;return null!=(_=null!=(v=null==(y=w.border)?void 0:y.width)?v:null==(b=w.border)?void 0:b.lineWidth)?_:4}}}}}return this._frozenColumnLine}get selectionStyle(){if(!this._selectionStyle){let{obj:l,superTheme:s}=this.internalTheme,a=(0,d.je)({},s.selectionStyle,l.selectionStyle);this._selectionStyle={get cellBgColor(){var t;return null!=(t=null==a?void 0:a.cellBgColor)?t:"rgba(0, 0, 255,0.1)"},get cellBorderColor(){var e;return null!=(e=null==a?void 0:a.cellBorderColor)?e:"#3073f2"},get cellBorderLineWidth(){var i;return null!=(i=null==a?void 0:a.cellBorderLineWidth)?i:2},get inlineColumnBgColor(){return null==a?void 0:a.inlineColumnBgColor},get inlineRowBgColor(){return null==a?void 0:a.inlineRowBgColor},get selectionFillMode(){var r;return null!=(r=null==a?void 0:a.selectionFillMode)?r:"overlay"},get dynamicUpdateSelectionSize(){var n;return null!=(n=null==a?void 0:a.dynamicUpdateSelectionSize)&&n}}}return this._selectionStyle}get axisStyle(){if(!this._axisStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},e.axisStyle,t.axisStyle);this._axisStyle={defaultAxisStyle:i.defaultAxisStyle||{},leftAxisStyle:i.leftAxisStyle||{},rightAxisStyle:i.rightAxisStyle||{},topAxisStyle:i.topAxisStyle||{},bottomAxisStyle:i.bottomAxisStyle||{}}}return this._axisStyle}get checkboxStyle(){if(!this._checkboxStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},e.checkboxStyle,t.checkboxStyle);this._checkboxStyle=i}return this._checkboxStyle}get radioStyle(){if(!this._radioStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},e.radioStyle,t.radioStyle);this._radioStyle=i}return this._radioStyle}get switchStyle(){if(!this._switchStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},e.switchStyle,t.switchStyle);this._switchStyle=i}return this._switchStyle}get buttonStyle(){if(!this._buttonStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},e.buttonStyle,t.buttonStyle);this._buttonStyle=i}return this._buttonStyle}get textPopTipStyle(){if(!this._textPopTipStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},c,e.textPopTipStyle,t.textPopTipStyle);this._textPopTipStyle=i}return this._textPopTipStyle}get functionalIconsStyle(){if(!this._internalIconsStyle){let{obj:t,superTheme:e}=this.internalTheme,i=(0,d.je)({},e.functionalIconsStyle,t.functionalIconsStyle);this._internalIconsStyle=i}return this._internalIconsStyle}hasProperty(t){let{obj:e,superTheme:i}=this.internalTheme;return f(e,t)||f(i,t)}extends(t){return new g((0,d.je)({},t),(0,d.je)({},this.internalTheme.superTheme,this.internalTheme.obj))}getStyle(t){let e=this;return{get fontSize(){return t.fontSize},get fontFamily(){return t.fontFamily},get fontWeight(){return t.fontWeight},get fontVariant(){return t.fontVariant},get fontStyle(){return t.fontStyle},get bgColor(){return t.bgColor},get color(){return t.color},get strokeColor(){return t.strokeColor},get borderColor(){return t.borderColor},get borderLineWidth(){return t.borderLineWidth},get borderLineDash(){return t.borderLineDash},get hover(){if(t.hover)return{get cellBgColor(){var i,r;return null!=(r=null==(i=t.hover)?void 0:i.cellBgColor)?r:void 0},get inlineColumnBgColor(){var n,l,s,a,o,h,u;return null!=(u=null!=(l=null==(n=t.hover)?void 0:n.inlineColumnBgColor)?l:(null==(s=t.hover)?void 0:s.cellBgColor)&&"string"==typeof(null==(a=t.hover)?void 0:a.cellBgColor)&&"transparent"!==(null==(o=t.hover)?void 0:o.cellBgColor)?(0,d.zX)(null==(h=t.hover)?void 0:h.cellBgColor,.1,!1):void 0)?u:void 0},get inlineRowBgColor(){var c,p,g,f,m,y,v;return null!=(v=null!=(p=null==(c=t.hover)?void 0:c.inlineRowBgColor)?p:(null==(g=t.hover)?void 0:g.cellBgColor)&&"string"==typeof(null==(f=t.hover)?void 0:f.cellBgColor)&&"transparent"!==(null==(m=t.hover)?void 0:m.cellBgColor)?(0,d.zX)(null==(y=t.hover)?void 0:y.cellBgColor,.1,!1):void 0)?v:void 0}}},get select(){return{get inlineColumnBgColor(){var b,_,C,x,w,S;return null!=(S=null!=(x=null!=(_=null==(b=t.select)?void 0:b.inlineColumnBgColor)?_:null==(C=e.selectionStyle)?void 0:C.inlineColumnBgColor)?x:(null==(w=e.selectionStyle)?void 0:w.cellBgColor)&&"string"==typeof e.selectionStyle.cellBgColor&&"transparent"!==e.selectionStyle.cellBgColor?(0,d.zX)(e.selectionStyle.cellBgColor,.1,!1):void 0)?S:void 0},get inlineRowBgColor(){var A,M,T,k,R;return null!=(R=null!=(T=null!=(M=null==(A=t.select)?void 0:A.inlineRowBgColor)?M:e.selectionStyle.inlineRowBgColor)?T:(null==(k=e.selectionStyle)?void 0:k.cellBgColor)&&"string"==typeof e.selectionStyle.cellBgColor&&"transparent"!==e.selectionStyle.cellBgColor?(0,d.zX)(e.selectionStyle.cellBgColor,.1,!1):void 0)?R:void 0},get cellBgColor(){var P,B,I;if("replace"===e.selectionStyle.selectionFillMode)return null!=(I=null!=(B=null==(P=t.select)?void 0:P.cellBgColor)?B:e.selectionStyle.cellBgColor)?I:void 0}}},get frameStyle(){if(t.frameStyle)return{get borderColor(){var E,L;return null!=(L=null==(E=t.frameStyle)?void 0:E.borderColor)?L:void 0},get borderLineWidth(){var F,O;return null!=(O=null==(F=t.frameStyle)?void 0:F.borderLineWidth)?O:void 0},get borderLineDash(){var H,D;return null!=(D=null==(H=t.frameStyle)?void 0:H.borderLineDash)?D:void 0}}},get padding(){return t.padding},get textAlign(){return t.textAlign},get textBaseline(){return t.textBaseline},get textOverflow(){return t.textOverflow},get lineHeight(){return t.lineHeight},get autoWrapText(){return t.autoWrapText},get lineClamp(){return t.lineClamp},get linkColor(){return t.linkColor},get cursor(){return t.cursor},get textStick(){return t.textStick},get textStickBaseOnAlign(){return t.textStickBaseOnAlign},get marked(){return t.marked},get underline(){var z;return null!=(z=t.underline)&&z},get underlineColor(){return t.underlineColor},get underlineDash(){return t.underlineDash},get underlineOffset(){return t.underlineOffset},get lineThrough(){var W;return null!=(W=t.lineThrough)&&W},get lineThroughColor(){return t.lineThroughColor},get lineThroughDash(){return t.lineThroughDash}}}}function f(t,e){if(t instanceof g)return t.hasProperty(e);let i=t;if(!i)return!1;for(let t=0;t<e.length;t++)if(!(i=i[e[t]]))return!1;return!!i}let m=new g(n,n),y=new g(l,l),v=new g(s,s),b=new g(a,a),_=new g(o,o),C={DEFAULT:b,SIMPLIFY:_,ARCO:v,DARK:m,BRIGHT:y},x={TableTheme:g};function w(t){if(!t)return null;if("string"==typeof t){let e=(0,r.I0)(S(),t);return e?e instanceof g?e:new g(e,e):null}return t instanceof g?t:new g(t,t)}function S(){return(0,r.l7)(C,h.n)}let A={DARK:m,BRIGHT:y,ARCO:v,DEFAULT:b,SIMPLIFY:_,theme:x,of:w,get:S}},10869:function(t,e,i){i.d(e,{n:()=>r});let r={}},93250:function(t,e,i){i.d(e,{B:()=>l});var r=i(64776);let n=(t,e)=>{let i=0,r=t.length-1;for(;i<=r;){let n=Math.floor((i+r)/2);if(t[n]===e)return n;t[n]>e?r=n-1:i=n+1}return r<0?0:r};class l{constructor(){this._keys=[],this._vals={},this._sorted=!1}count(){return this._keys.length}values(){return this._vals}valueArr(){return Object.values(this._vals)}adjustOrder(t,e,i){let{_keys:r}=this;if(this._sorted||(r.sort((t,e)=>t<e?-1:+(t>e)),this._sorted=!0),t>e){let l=[];for(let s=n(r,t+i-1);s>=0;s--){let n=r[s];if(n>=t)l.push(this.get(n));else if(e<=n&&n<t)this.put(n+i,this.get(n));else if(n<e)break}for(let t=0;t<i;t++)this.put(e+t,l[i-1-t])}let{length:l}=r;if(t<e){let s=[];for(let a=n(r,t);a<l;a++){let n=r[a];if(n>=t&&n<t+i)s.push(this.get(n));else if(t+i<=n&&n<=e)this.put(n-i,this.get(n));else if(n>e)break}for(let t=0;t<i;t++)this.put(e+t,s[t])}}exchangeOrder(t,e,i,r,l){let{_keys:s}=this;if(this._sorted||(s.sort((t,e)=>t<e?-1:+(t>e)),this._sorted=!0),t>i){let r=[],a=[];for(let l=n(s,i);l<n(s,t)+e;l++){let i=s[l];i>=t&&i<t+e?a.push(this.get(i)):r.push(this.get(i))}for(let t=0;t<e;t++)this.put(l+t,a[t]);for(let t=0;t<r.length;t++)this.put(l+e+t,r[t])}else{let a=[],o=[];for(let l=n(s,t);l<n(s,i)+r;l++){let i=s[l];i>=t&&i<t+e?o.push(this.get(i)):a.push(this.get(i))}for(let t=0;t<e;t++)this.put(l+t,o[t]);for(let e=0;e<a.length;e++)this.put(t+e,a[e])}}del(t){delete this._vals[t];let e=this._keys.indexOf(t);-1!==e&&this._keys.splice(e,1)}put(t,e){t in this._vals||(this._keys.push(t),this._sorted=!1),this._vals[t]=e}get(t){return this._vals[t]}has(t){return(0,r.Z)(this._vals[t])}contain(t){return Object.values(this._vals).indexOf(t)>=0}each(t,e,i){let{_keys:r}=this,{length:l}=r;this._sorted||(r.sort((t,e)=>t<e?-1:+(t>e)),this._sorted=!0);for(let s=n(r,t);s<l;s++){let n=r[s];if(t<=n&&n<=e){if(!1===i(this.get(n),n))break}else if(e<n)return}}clear(){this._keys.length=0,this._vals={},this._sorted=!1}getLastIndex(){return this._keys[this._keys.length-1]}delLast(){let t=this.getLastIndex();this.del(t)}delAndReorder(t){if(!this.has(t))return;let e=this.getLastIndex();this.adjustOrder(t+1,t,e-t),this.delLast()}addAndReorder(t,e){if((0,r.Z)(e)){let i=this.getLastIndex();this.adjustOrder(t,t+1,i-t),this.put(t,e)}}}},3099:function(t,e,i){i.d(e,{U:()=>n});var r=i(63401);class n{constructor(t,e,i,n){this.bounds=new r.YZ,this.bounds.set(t,e,t+i,e+n)}static bounds(t,e,i,r){return new n(t,e,Math.round(i-t),Math.round(r-e))}get left(){return this.bounds.x1}set left(t){this.bounds.x1=t}get top(){return this.bounds.y1}set top(t){this.bounds.y1=t}get right(){return this.bounds.x2}set right(t){this.bounds.x2=t}get bottom(){return this.bounds.y2}set bottom(t){this.bounds.y2=t}get width(){return this.bounds.width()}set width(t){this.bounds.x2=this.bounds.x1+t}get height(){return this.bounds.height()}set height(t){this.bounds.y2=this.bounds.y1+t}offsetLeft(t){this.bounds.translate(t,0)}offsetTop(t){this.bounds.translate(0,t)}copy(){return new n(this.left,this.top,this.width,this.height)}contains(t){return this.bounds.encloses(t.bounds)}inPoint(t,e){return this.bounds.contains(t,e)}}},70506:function(t,e,i){i.d(e,{aR:()=>u,hU:()=>c});var r=i(54326),n=i(4654),l=i(83624),s=i(23975);function a(t){return t>=48&&t<=57}function o(t){return t>=97&&t<=122||t>=65&&t<=90||37===t}function h(t){return Error(`calc parse error: ${t}`)}let d={"*":3,"/":3,"+":2,"-":2};function u(t,e){var i;return"string"==typeof t?(i=t.trim(),function t(e,i){if(11===e.nodeType){let r=t(e.left,i),n=t(e.right,i);switch(e.op.value){case"+":return r+n;case"-":return r-n;case"*":return r*n;case"/":return r/n;default:throw Error(`calc error. unknown operator: ${e.op.value}`)}}if(10===e.nodeType)switch(e.unit){case"%":return e.value*i.full/100;case"px":return e.value;default:throw Error(`calc error. unknown unit: ${e.unit}`)}if(12===e.nodeType)return e.value;throw Error("calc error.")}(function t(e,i){function r(t){let e=t.pop(),r=t.pop(),n=t.pop();if(!(n&&n.nodeType&&r&&2===r.type&&e&&e.nodeType))throw h(i);return{nodeType:11,left:n,op:r,right:e}}let n=[];for(;e.length;){let l=e.shift();if(0===l.type&&"("===l.value){let r=0,l=s.IX.findIndex(e,t=>{if(0===t.type&&"("===t.value)r++;else if(0===t.type&&")"===t.value){if(!r)return!0;r--}return!1});if(-1===l)throw h(i);n.push(t(e.splice(0,l),i)),e.shift()}else if(2===l.type){if(n.length>=3){let t=n[n.length-2].value;d[l.value]<=d[t]&&n.push(r(n))}n.push(l)}else if(1===l.type){let{value:t,unit:e}=l;n.push({nodeType:10,value:t,unit:e})}else 3===l.type&&n.push({nodeType:12,value:l.value})}for(;n.length>1;)n.push(r(n));return n[0]}(function(t){let e=t.replace(/calc\(/g,"(").trim(),i=[],r=e.length;for(let l=0;l<r;l++){let s=e[l],o=s.charCodeAt(0);if("("===s||")"===s)i.push({value:s,type:0});else if("*"===s||"/"===s)i.push({value:s,type:2});else if("+"===s||"-"===s)l=function(t,l){if(l<r){let i=e[l],r=i.charCodeAt(0);if(a(r)||46===r)return n(t+i,l+1)}return i.push({value:t,type:2}),l}(s,l+1)-1;else if(a(o)||46===o)l=n(s,l+1)-1;else if(9!==o&&10!==o&&12!==o&&13!==o&&32!==o)throw h(t)}function n(n,l){let s=l;for(;s<r;s++){let l=e[s],d=l.charCodeAt(0);if(a(d))n+=l;else{if("."!==l){if(o(d))return function(t,n,l){let s=l;for(;s<r;s++){let t=e[s];if(!o(t.charCodeAt(0)))break;n+=t}return i.push({value:parseFloat(t),unit:n,type:1}),s}(n,l,s+1);break}if(n.indexOf(".")>=0)throw h(t);n+=l}}if("."===n)throw h(t);return i.push({value:parseFloat(n),type:3}),s}return i}(i),i),e)):t-0}function c(t){var e;return!!(0,l.Z)(t)&&!!t.endsWith("%")&&(e=t.substring(0,t.length-1),!(0,r.Z)(e)&&(!!(0,n.Z)(e)||+e==+e))}},97779:function(t,e,i){i.d(e,{D:()=>a});var r=i(73036);let n=t=>{switch(Object.prototype.toString.call(t)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},l=(t,e)=>n(t)===e,s=t=>l(t,"object");function a(t,e,i){let n,l,a,o,h,d,u=0,c=!1,p=!1,g=!0,f=!e&&0!==e&&"function"==typeof r.rF.getRequestAnimationFrame();if("function"!=typeof t)throw TypeError("Expected a function");function m(e){let i=n,r=l;return l=void 0,n=void 0,u=e,o=t.apply(r,i)}function y(t,e){return f?r.rF.getRequestAnimationFrame()(t):setTimeout(t,e)}function v(t){let i=t-d;return void 0===d||i>=e||i<0||c&&t-u>=a}function b(){let t=Date.now();if(v(t))return h=void 0,g&&n?m(t):(l=void 0,n=void 0,o);h=y(b,function(t){let i=t-u,r=e&&-(t-d);return c?Math.min(r,a-i):r}(t))}return e=+e||0,s(i)&&(p=!!i.leading,(c="maxWait"in i)&&(a=Math.max(+i.maxWait||0,e)),g="trailing"in i?!!i.trailing:g),function(...t){let i=Date.now(),r=v(i);if(n=t,l=this,d=i,r){if(void 0===h){var s;return u=s=d,h=y(b,e),p?m(s):o}if(c)return h=y(b,e),m(d)}return void 0===h&&(h=y(b,e)),o}}},96357:function(t,e,i){i.d(e,{a:()=>r});function r(t,e){let i=document.createElement(t);return e&&i.classList.add(...e),i}},30430:function(t,e,i){i.d(e,{X:()=>r,u:()=>n});class r{static get mode(){return r._mode||(r._mode=function(){let t="browser";try{"node"===window.type?t="node":"undefined"==typeof window||window.performance?"undefined"==typeof window&&(t="node"):t="miniApp"}catch(e){t="node"}return t}()),r._mode}static set mode(t){r._mode=t}static RegisterCreateCanvas(t){r.CreateCanvas=t}static RegisterLoadImage(t){r.LoadImage=t}static GetCreateCanvasFunc(){return r.CreateCanvas?r.CreateCanvas:"worker"===r.mode?(t=200,e=200)=>new OffscreenCanvas(t,e):void 0}static RegisterRequestAnimationFrame(t){r.RequestAnimationFrame=t()}static GetRequestAnimationFrame(){if(r.RequestAnimationFrame)return r.RequestAnimationFrame}static RegisterCancelAnimationFrame(t){r.CancelAnimationFrame=t()}static GetCancelAnimationFrame(){if(r.CancelAnimationFrame)return r.CancelAnimationFrame}}function n(){try{let t=window.getSelection();if(t){if("function"==typeof t.removeAllRanges)return void t.removeAllRanges();if("function"==typeof t.empty)return void t.empty();if("function"==typeof t.collapse)return void t.collapse(document.body,0)}}catch(t){}}r.dpr=0},77874:function(t,e,i){i.d(e,{Rk:()=>n,Zj:()=>p,aE:()=>l,cT:()=>s,ek:()=>u,gm:()=>c,hW:()=>g,ho:()=>r,tP:()=>d,yZ:()=>h,z8:()=>o,zY:()=>a});let r=16,n="Arial,sans-serif",l="#FFF",s="#000",a=1,o=[],h="#000",d=/^(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/,u="$$indicator$$",c='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path  d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM549.333333 288a5.333333 5.333333 0 0 1 5.333334 5.333333V469.333333h176a5.333333 5.333333 0 0 1 5.333333 5.333334v74.666666a5.333333 5.333333 0 0 1-5.333333 5.333334H554.666667v176a5.333333 5.333333 0 0 1-5.333334 5.333333h-74.666666a5.333333 5.333333 0 0 1-5.333334-5.333333V554.666667H293.333333a5.333333 5.333333 0 0 1-5.333333-5.333334v-74.666666a5.333333 5.333333 0 0 1 5.333333-5.333334H469.333333V293.333333a5.333333 5.333333 0 0 1 5.333334-5.333333h74.666666z"></path></svg>',p='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM693.333333 469.333333a42.666667 42.666667 0 1 1 0 85.333334H330.666667a42.666667 42.666667 0 1 1 0-85.333334h362.666666z"></path></svg>',g={type:"line"}},23975:function(t,e,i){let r,n;i.d(e,{B:()=>T,Bd:()=>M,I0:()=>b,IX:()=>a,JO:()=>_,NC:()=>v,TS:()=>f,UG:()=>s,_Z:()=>C,ib:()=>S,j6:()=>A,l7:()=>p,nO:()=>R,oB:()=>k,tI:()=>y,vi:()=>m,vl:()=>g,yD:()=>x});var l=i(6958);let s="undefined"==typeof window||void 0===window.window,a={get find(){return r||(r=Array.prototype.find?(t,e)=>Array.prototype.find.call(t,e):(t,e)=>{let i=a.findIndex(t,e);return i>=0?t[i]:void 0})},get findIndex(){return n||(n=Array.prototype.findIndex?(t,e)=>Array.prototype.findIndex.call(t,e):(t,e)=>{let{length:i}=t;for(let r=0;r<i;r++)if(e(t[r],r,t))return r;return -1})}},{IE:o,Chrome:h,Firefox:d,Edge:u,Safari:c}=function(){if(s)return{IE:!1,Edge:!1,Chrome:!1,Firefox:!1,Safari:!1};let t=window.navigator.userAgent.toLowerCase();return{IE:!!/(msie|trident)/.exec(t),Edge:t.indexOf("edge")>-1,Chrome:t.indexOf("chrome")>-1&&-1===t.indexOf("edge"),Firefox:t.indexOf("firefox")>-1,Safari:t.indexOf("safari")>-1&&-1===t.indexOf("edge")}}();function p(...t){let e={};return t.forEach(t=>{for(let i in t)Object.defineProperty(e,i,{get:()=>t[i],set(e){t[i]=e},configurable:!0,enumerable:!0})}),e}function g(t,e,...i){let r=t;for(let t=0;t<i.length&&null!=r;t++)r=e(r,i[t]);return r}function f(t,...e){return g(t,(t,e)=>t[e],...e)}function m(t,...e){return"function"==typeof t?t(...e):t}function y(t){return!!(t&&"function"==typeof t.then)}function v(t,e){y(t)?t.then(t=>{e(t)}).catch(t=>{}):e(t)}function b(t,e){if(t[e])return t[e];let i=e.toLowerCase();if(t[i])return t[i];let r=e.toLowerCase();if(t[r])return t[r];for(let e in t)if(e.toLowerCase()===i)return t[e]}function _(t){return Array.isArray(t)?3===t.length?[t[0],t[1],t[2],t[1]]:2===t.length?[t[0],t[1],t[0],t[1]]:1===t.length?[t[0],t[0],t[0],t[0]]:[t[0],t[1],t[2],t[3]]:[t,t,t,t]}function C(t,e,i){return t.start.col<=e&&e<=t.end.col&&t.start.row<=i&&i<=t.end.row||t.end.col<=e&&e<=t.start.col&&t.end.row<=i&&i<=t.start.row||t.end.col<=e&&e<=t.start.col&&t.start.row<=i&&i<=t.end.row||t.start.col<=e&&e<=t.end.col&&t.end.row<=i&&i<=t.start.row}function x(t,e,i){for(let r=0;r<t.length;r++){let n=t[r],l=Math.min(n.start.col,n.end.col),s=Math.max(n.start.col,n.end.col),a=Math.min(n.start.row,n.end.row),o=Math.max(n.start.row,n.end.row);if(l<=e&&e<=s&&a<=i&&i<=o||s<=e&&e<=l&&o<=i&&i<=a)return!0}return!1}function w(t){return{start:{col:Math.min(t.start.col,t.end.col),row:Math.min(t.start.row,t.end.row)},end:{col:Math.max(t.start.col,t.end.col),row:Math.max(t.start.row,t.end.row)}}}function S(t,e){let i=w(t),r=w(e);return!!(Math.max(i.start.col,r.start.col)<=Math.min(i.end.col,r.end.col)&&Math.max(i.start.row,r.start.row)<=Math.min(i.end.row,r.end.row))}let A={isObject:function(t){return t===Object(t)}},M={endsWith:function(t,e,i){let r=(0,l.cw)(t);("number"!=typeof i||!isFinite(i)||Math.floor(i)!==i||i>r.length)&&(i=r.length),i-=e.length;let n=r.lastIndexOf(e,i);return -1!==n&&n===i}},T={isTouchEvent:function(t){return!!t.changedTouches}},k={toBoxArray:_},R=Function.prototype},4713:function(t,e,i){function r(t,e){if(!e||!e.proxy)return{colStart:0,colEnd:0,rowStart:0,rowEnd:0};let{mergeStartCol:i,mergeEndCol:r,mergeStartRow:n,mergeEndRow:l,col:s,row:a}=t;return{colStart:i,colEnd:r,rowStart:n,rowEnd:l}}function n(t,e){let i=t.start.col,r=t.end.col,n=t.start.row,l=t.end.row,s=i,a=r,o=n,h=l;for(let t=i;t<=r;t++)for(let i=n;i<=l;i++){let r=e.getCellRange(t,i);r&&(s=Math.min(s,r.start.col),a=Math.max(a,r.end.col),o=Math.min(o,r.start.row),h=Math.max(h,r.end.row))}return t.start.col=s,t.end.col=a,t.start.row=o,t.end.row=h,t}i.d(e,{T:()=>n,e:()=>r})},16214:function(t,e,i){i.d(e,{Iv:()=>s,KV:()=>o,NR:()=>h,Z7:()=>d,vP:()=>l,z5:()=>a});var r=i(64776),n=i(95723);function l(t){var e;return(null==t?void 0:t.hoverOn)||(null==t?void 0:t.horizontalVisible)&&"none"===(null==t?void 0:t.horizontalVisible)||!(null==t?void 0:t.horizontalVisible)&&"none"===(null==t?void 0:t.visible)?0:null!=(e=null==t?void 0:t.width)?e:7}function s(t){var e;return(null==t?void 0:t.hoverOn)||(null==t?void 0:t.verticalVisible)&&"none"===(null==t?void 0:t.verticalVisible)||!(null==t?void 0:t.verticalVisible)&&"none"===(null==t?void 0:t.visible)?0:null!=(e=null==t?void 0:t.width)?e:7}function a(t){return!!(0,r.Z)(t)&&(!(0,n.Z)(t)||t.some(t=>(0,r.Z)(t)))}function o(t){return 0===t||(0,n.Z)(t)&&t.every(t=>0===t)}function h(t){let e=t.stateManager.select.ranges,i=[];for(let t=0;t<e.length;t++){let r=e[t];i.push({range:r,style:{cellBorderColor:"blue",cellBorderLineWidth:2,cellBorderLineDash:[5,5]}})}t.stateManager.setCustomSelectRanges(i)}function d(t){t.stateManager.setCustomSelectRanges([])}},6958:function(t,e,i){i.d(e,{E5:()=>g,Ed:()=>S,K$:()=>_,MU:()=>C,P2:()=>p,Zf:()=>x,cw:()=>v,j0:()=>f,je:()=>function t(e,...i){if(!i.length)return e||{};let r=i.shift();if(a(e)&&a(r))for(let i in r)a(r[i])?(e[i]||Object.assign(e,{[i]:{}}),a(e[i])||Object.assign(e,{[i]:r[i]}),t(e[i],r[i])):null!==r[i]&&void 0!==r[i]&&Object.assign(e,{[i]:r[i]});return t(e,...i)},m7:()=>u,oM:()=>w,p4:()=>c,pr:()=>function t(e,i,r){let l=0;if(!i||i===n.g.collapse||i===n.g.none)return l;let s=r.filteredChildren?r.filteredChildren:r.children;if(s)for(let i=0;i<s.length;i++)l+=1,l+=t(Array.isArray(e)?e.concat([i]):[e,i],s[i].hierarchyState,s[i]);return l},tq:()=>b,yW:()=>function t(e,i,r){r(e),(null==e?void 0:e[i])&&Array.isArray(null==e?void 0:e[i])&&e[i].forEach(e=>t(e,i,r))},zX:()=>y});var r=i(64776),n=i(72281);let l=t=>{switch(Object.prototype.toString.call(t)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},s=(t,e)=>l(t)===e,a=t=>s(t,"object"),o=t=>s(t,"string"),h=t=>s(t,"number"),d=t=>s(t,"boolean");function u(t){return"function"==typeof t&&(t=t()),(0,r.Z)(t)?`${t}`:""}function c(t){if((null==t?void 0:t.length)<=0)return t;let e=t.length,i=t[0].length,r=Array(i);for(let n=0;n<e;n++)for(let l=0;l<i;l++)r[l]||(r[l]=Array(e)),r[l][n]=t[n][l];return r}function p(t,e){let i=null;return function(...r){i||(t.apply(this,r),i=setTimeout(()=>{i=null},e))}}function g(t,e){let i=null;return function(...r){i||(i=setTimeout(()=>{t.apply(this,r),i=null},e))}}function f(t,e){let i=null,r=null,n=null;return{throttled:function(...l){r=l,n=this,i||(i=setTimeout(()=>{r&&t.apply(n,r),i=null,r=null,n=null},e))},cancel:()=>{i&&(clearTimeout(i),i=null,r=null,n=null)},flush:()=>{i&&r&&(clearTimeout(i),t.apply(n,r),i=null,r=null,n=null)}}}function m(t,e){for(t=`${t}`;t.length<e;)t="0"+t;return t}function y(t,e,i){t=(t=t.replace(/^\s*|\s*$/,"")).replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3");let n=Math.round(256*e)*(i?-1:1),l=t.match(RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),s=l&&(0,r.Z)(l[4])?l[4]:null,a=l?[l[1],l[2],l[3]]:t.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return`${parseInt(arguments[1],16)},${parseInt(arguments[2],16)},${parseInt(arguments[3],16)}`}).split(/,/);return l?`rgb${null!==s?"a":""}(${Math[i?"max":"min"](parseInt(a[0],10)+n,255*!i)}, ${Math[i?"max":"min"](parseInt(a[1],10)+n,255*!i)}, ${Math[i?"max":"min"](parseInt(a[2],10)+n,255*!i)}${null!==s?`, ${s}`:""})`:["#",m(Math[i?"max":"min"](parseInt(a[0],10)+n,255*!i).toString(16),2),m(Math[i?"max":"min"](parseInt(a[1],10)+n,255*!i).toString(16),2),m(Math[i?"max":"min"](parseInt(a[2],10)+n,255*!i).toString(16),2)].join("")}function v(t){return o(t)||h(t)||d(t)?t.toString():""}function b(){return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)}function _(t,e,i){return"desc"!==i?t===e?0:t>e?1:-1:t===e?0:t<e?1:-1}function C(t,e){let i,r=t;for(;(i=e.shift())&&(r=r[i]););return r}function x(t){return/^-?\d+(\.\d+)?$/.test(t)}function w(t){let e=[];for(let i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}function S(t){let e=window.getSelection();if(e.rangeCount){let i=e.getRangeAt(0);return i.endOffset>i.startOffset&&t.contains(i.commonAncestorContainer)}return!1}},26025:function(t,e,i){i.d(e,{n:()=>r});let r=["bgColor","color","strokeColor","borderColor","linkColor"]},97266:function(t,e,i){var r,n,l,s;i.d(e,{F:()=>r,p:()=>n}),(l=r||(r={})).default="default",l.grabing="grabing",l.scrolling="scrolling",(s=n||(n={})).single="single",s.column="column",s.row="row",s.cross="cross",s.none="none"},39433:function(t,e,i){i.d(e,{Fn:()=>g,Js:()=>h,MR:()=>b,NF:()=>f,SL:()=>v,U4:()=>d,YJ:()=>l,ZP:()=>c,__:()=>u,hT:()=>a,jk:()=>s,ky:()=>p,ld:()=>o,vg:()=>m,y4:()=>y});var r=i(64776),n=i(47490);let l={};class s{constructor(t){var e;this.isAggregator=!0,this.isRecord=!0,this.records=[],this.children=[],this.key=t.key,this.field=t.field,this.formatFun=t.formatFun,this.isRecord=null!=(e=t.isRecord)?e:this.isRecord}clearCacheValue(){this._formatedValue=void 0}formatValue(t,e,i){return this._formatedValue||(this.formatFun?this._formatedValue=this.formatFun(this.value(),t,e,i):this._formatedValue=this.value()),this._formatedValue}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.clearCacheValue()}}class a extends s{constructor(){super(...arguments),this.type=n.E.RECORD,this.isRecord=!0}push(t){t&&this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children&&this.children.push(t),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t))),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.clearCacheValue())}value(){var t;return null!=(t=this.changedValue)?t:this.records}reset(){this.children=[],this.changedValue=void 0,this.records=[]}recalculate(){}}class o extends s{constructor(){super(...arguments),this.type=n.E.NONE,this.isRecord=!0}push(t){t&&(this.isRecord&&(this.records=[t]),t.isAggregator&&this.children&&(this.children=[t]),this.field&&(this.fieldValue=t[this.field])),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field]),this.clearCacheValue())}value(){var t;return null!=(t=this.changedValue)?t:this.fieldValue}reset(){this.children=[],this.changedValue=void 0,this.records=[],this.fieldValue=void 0}recalculate(){}}class h extends s{constructor(t){super(t),this.type=n.E.CUSTOM,this.isRecord=!0,this.values=[],this.aggregationFun=t.aggregationFun}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children&&this.children.push(t),this.field&&this.values.push(t[this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.field&&this.records.length&&(this.values=this.records.map(t=>t[this.field])),this.clearCacheValue())}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.field&&this.records.length&&(this.values=this.records.map(t=>t[this.field]))),this.clearCacheValue()}value(){var t,e;return this.fieldValue||(this.fieldValue=null==(t=this.aggregationFun)?void 0:t.call(this,this.values,this.records,this.field)),null!=(e=this.changedValue)?e:this.fieldValue}reset(){this.records=[],this.children=[],this.changedValue=void 0,this.fieldValue=void 0}recalculate(){this.fieldValue=void 0,this._formatedValue=void 0}}class d extends s{constructor(t){super(t),this.type=n.E.RECALCULATE,this.isRecord=!0,this.calculateFun=t.calculateFun,this.dependAggregators=t.dependAggregators,this.dependIndicatorKeys=t.dependIndicatorKeys}push(t){t&&this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),this.children&&t.isAggregator&&this.children.push(t),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t))),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.clearCacheValue())}value(){var t,e;if(!this.fieldValue){let e=function(t,e){let i={};for(let r=0;r<(null==e?void 0:e.length);r++){let n=t.find(t=>(null==t?void 0:t.key)===e[r]);n&&(i[n.key]=null==n?void 0:n.value())}return i}(this.dependAggregators,this.dependIndicatorKeys);this.fieldValue=null==(t=this.calculateFun)?void 0:t.call(this,e,this.records,this.field)}return null!=(e=this.changedValue)?e:this.fieldValue}reset(){this.records=[],this.children=[],this.changedValue=void 0,this.fieldValue=void 0}recalculate(){}}class u extends s{constructor(t){var e;super(t),this.type=n.E.SUM,this.sum=0,this.positiveSum=0,this.nagetiveSum=0,this.needSplitPositiveAndNegativeForSum=!1,this.needSplitPositiveAndNegativeForSum=null!=(e=t.needSplitPositiveAndNegative)&&e}push(t){if(t){if(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children){this.children.push(t);let e=t.value();this.sum+=null!=e?e:0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){let e=parseFloat(t[this.field]);this.sum+=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}}this.clearCacheValue()}deleteRecord(t){if(t){if(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children){this.children=this.children.filter(e=>e!==t);let e=t.value();this.sum-=null!=e?e:0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){let e=parseFloat(t[this.field]);this.sum-=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}}this.clearCacheValue()}updateRecord(t,e){if(t&&e){if(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&this.children){let i=t.value();this.children=this.children.filter(e=>e!==t);let r=e.value();this.children.push(e),this.sum+=r-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),r>0?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){let i=parseFloat(t[this.field]),r=parseFloat(e[this.field]);this.sum+=r-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),r>0?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r))}this.clearCacheValue()}}value(){var t,e;return null!=(t=this.changedValue)?t:(null==(e=this.records)?void 0:e.length)>=1?this.sum:void 0}positiveValue(){return this.positiveSum}negativeValue(){return this.nagetiveSum}reset(){super.reset(),this.records=[],this.sum=0}recalculate(){if(this.sum=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator){let t=e.value();this.sum+=null!=t?t:0,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))}}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];if(e.isAggregator){let t=e.value();this.sum+=null!=t?t:0,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))}else if(this.field&&!isNaN(parseFloat(e[this.field]))){let t=parseFloat(e[this.field]);this.sum+=t,this.needSplitPositiveAndNegativeForSum&&(t>0?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))}}}}class c extends s{constructor(){super(...arguments),this.type=n.E.COUNT,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.count+=t.value()):this.count++),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator?(this.children&&(this.children=this.children.filter(e=>e!==t)),this.count-=t.value()):this.count--),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&(this.count+=e.value()-t.value()),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)))}value(){var t;return null!=(t=this.changedValue)?t:this.count}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.count=0}recalculate(){if(this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator){let t=e.value();this.count+=null!=t?t:0}else this.count++}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];e.isAggregator?this.count+=e.value():this.count++}}}class p extends s{constructor(){super(...arguments),this.type=n.E.AVG,this.sum=0,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&t.type===n.E.AVG?(this.children&&this.children.push(t),this.sum+=t.sum,this.count+=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(t[this.field]),this.count++)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&t.type===n.E.AVG?(this.children&&(this.children=this.children.filter(e=>e!==t)),this.sum-=t.sum,this.count-=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum-=parseFloat(t[this.field]),this.count--)),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&t.type===n.E.AVG?(this.children&&e.isAggregator&&(this.children=this.children.map(i=>i===t?e:i)),this.sum+=e.sum-t.sum,this.count+=e.count-t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(e[this.field])-parseFloat(t[this.field])),this.clearCacheValue())}value(){var t,e;return null!=(t=this.changedValue)?t:(null==(e=this.records)?void 0:e.length)>=1?this.sum/this.count:void 0}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.sum=0,this.count=0}recalculate(){if(this.sum=0,this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator&&e.type===n.E.AVG){let t=e.value();this.sum+=t*e.count,this.count+=e.count}}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];e.isAggregator&&e.type===n.E.AVG?(this.sum+=e.sum,this.count+=e.count):this.field&&!isNaN(parseFloat(e[this.field]))&&(this.sum+=parseFloat(e[this.field]),this.count++)}}}class g extends s{constructor(){super(...arguments),this.type=n.E.MAX,this.max=Number.MIN_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.max=t.max>this.max?t.max:this.max):"number"==typeof t?this.max=t>this.max?t:this.max:this.field&&"number"==typeof t[this.field]?this.max=t[this.field]>this.max?t[this.field]:this.max:this.field&&!isNaN(t[this.field])&&(this.max=parseFloat(t[this.field])>this.max?parseFloat(t[this.field]):this.max)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.recalculate())}value(){var t,e;return null!=(t=this.changedValue)?t:(null==(e=this.records)?void 0:e.length)>=1?this.max:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.max=Number.MIN_SAFE_INTEGER}recalculate(){if(this.max=Number.MIN_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator){let t=e.value();this.max=Math.max(this.max,t)}}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];e.isAggregator?this.max=e.max>this.max?e.max:this.max:"number"==typeof e?this.max=e>this.max?e:this.max:this.field&&"number"==typeof e[this.field]?this.max=e[this.field]>this.max?e[this.field]:this.max:this.field&&!isNaN(e[this.field])&&(this.max=parseFloat(e[this.field])>this.max?parseFloat(e[this.field]):this.max)}}}class f extends s{constructor(){super(...arguments),this.type=n.E.MIN,this.min=Number.MAX_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.min=t.min<this.min?t.min:this.min):"number"==typeof t?this.min=t<this.min?t:this.min:this.field&&"number"==typeof t[this.field]?this.min=t[this.field]<this.min?t[this.field]:this.min:this.field&&!isNaN(t[this.field])&&(this.min=parseFloat(t[this.field])<this.min?parseFloat(t[this.field]):this.min)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.recalculate())}value(){var t,e;return null!=(t=this.changedValue)?t:(null==(e=this.records)?void 0:e.length)>=1?this.min:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.min=Number.MAX_SAFE_INTEGER}recalculate(){if(this.min=Number.MAX_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){let e=this.children[t];if(e.isAggregator){let t=e.value();this.min=Math.min(this.min,t)}}else if(this.records)for(let t=0;t<this.records.length;t++){let e=this.records[t];e.isAggregator?this.min=e.min<this.min?e.min:this.min:"number"==typeof e?this.min=e<this.min?e:this.min:this.field&&"number"==typeof e[this.field]?this.min=e[this.field]<this.min?e[this.field]:this.min:this.field&&!isNaN(e[this.field])&&(this.min=parseFloat(e[this.field])<this.min?parseFloat(e[this.field]):this.min)}}}function m(t,e){return t&&e?t.toString().localeCompare(e.toString(),"zh"):t?1:-1}function y(t,e,i){if(i===n.F.NORMAL||i===n.F.normal)return 0;let r=i===n.F.DESC||i===n.F.desc?-1:1;return t&&e?t.toString().localeCompare(e.toString(),"zh")*r:t?+r:-1*r}function v(t,e,i){if(i===n.F.NORMAL||i===n.F.normal)return 0;let r=/(\d+)|(\D+)/g,l=/\d/,s=/^0/,a,o,h,d,u=0,c=0,p=i===n.F.DESC||i===n.F.desc?-1:1;if(null!==e&&null===t)return -1*p;if(null!==t&&null===e)return+p;if("number"==typeof t&&isNaN(t))return -1*p;if("number"==typeof e&&isNaN(e))return+p;if((u=+t)<(c=+e))return -1*p;if(u>c)return+p;if("number"==typeof t&&"number"!=typeof e)return -1*p;if("number"==typeof e&&"number"!=typeof t)return+p;if("number"==typeof t&&"number"==typeof e)return 0;if(isNaN(c)&&!isNaN(u))return -1*p;if(isNaN(u)&&!isNaN(c))return+p;if((a=String(t))===(h=String(e)))return 0;if(!l.test(a)||!l.test(h))return(a>h?1:-1)*p;for(a=a.match(r),h=h.match(r);a.length&&h.length;)if((o=a.shift())!==(d=h.shift()))return l.test(o)&&l.test(d)?(o.replace(s,".0")-d.replace(s,".0"))*p:(o>d?1:-1)*p;return(a.length-h.length)*p}function b(t){let e,i={},l={};for(let r=0;r<t.length;r++)i[e=t[r]]=r,"string"==typeof e&&(l[e.toLowerCase()]=r);return function(t,e,s){let a;if(s===n.F.NORMAL||s===n.F.normal)return 0;let o=s===n.F.DESC||s===n.F.desc?-1:1;return null!==i[t]&&void 0!==i[t]&&null!==i[e]&&void 0!==i[e]?a=i[t]-i[e]:null!==i[t]&&void 0!==i[t]?a=-1:null!==i[e]&&void 0!==i[e]?a=1:null!==l[t]&&void 0!==i[t]&&null!==l[e]&&void 0!==i[e]?a=l[t]-l[e]:null===l[t]||void 0===i[t]||null===l[e]||void 0===i[e]?a=0:null!==l[t]&&void 0!==i[t]?a=-1:null!==l[e]&&void 0!==i[e]&&(a=1),(0,r.Z)(a)?a*o:v(t,e,s)}}},34672:function(t,e,i){var r,n,l,s,a,o;i.d(e,{cI:()=>n,q0:()=>r,up:()=>l}),(s=r||(r={})).inlineFront="inlineFront",s.inlineEnd="inlineEnd",s.left="left",s.right="right",s.absoluteRight="absoluteRight",s.contentLeft="contentLeft",s.contentRight="contentRight",s.absolute="absolute",(a=n||(n={})).frozen="frozen",a.sort="sort",a.dropDown="dropDown",a.dropDownState="dropDownState",a.play="play",a.damagePic="damagePic",a.expand="expand",a.collapse="collapse",a.drillDown="drillDown",a.drillUp="drillUp",a.dragReorder="dragReorder",(o=l||(l={})).upwardIconName="sort_upward",o.downwardIconName="sort_downward",o.normalIconName="sort_normal",o.freezeIconName="freeze",o.frozenIconName="frozen",o.frozenCurrentIconName="frozenCurrent",o.dropdownIconName="dropdownIcon",o.expandIconName="expand",o.collapseIconName="collapse",o.dragReorderIconName="dragReorder",o.loadingIconName="loading"},47490:function(t,e,i){var r,n,l,s;i.d(e,{E:()=>r,F:()=>n}),(l=r||(r={})).RECORD="RECORD",l.NONE="NONE",l.SUM="SUM",l.MIN="MIN",l.MAX="MAX",l.AVG="AVG",l.COUNT="COUNT",l.CUSTOM="CUSTOM",l.RECALCULATE="RECALCULATE",(s=n||(n={})).ASC="ASC",s.DESC="DESC",s.NORMAL="NORMAL",s.desc="desc",s.asc="asc",s.normal="normal"},11725:function(t,e,i){i.d(e,{Z:()=>s,z:()=>l});var r=i(67331),n=i(23975);let l=(0,n.l7)(r.B,{PIVOT_SORT_CLICK:"pivot_sort_click",DRILLMENU_CLICK:"drillmenu_click"}),s=(0,n.l7)(r.B,{VCHART_EVENT_TYPE:"vchart_event_type"})},72281:function(t,e,i){var r,n,l,s;i.d(e,{g:()=>n,u:()=>r}),(l=r||(r={})).top="top",l.bottom="bottom",l.left="left",l.right="right",(s=n||(n={})).expand="expand",s.collapse="collapse",s.none="none",s.loading="loading"},27091:function(t,e,i){i.d(e,{sTO:()=>C});var r=i(60779),n=i(73036),l=i(89495),s=i(34505),a=i(41857),o=i(80808),h=i(15776),d=i(68825),u=i(76401),c=i(11511),p=i(29922),g=i(67286),f=i(99754),m=i(74512),y=i(66994),v=i(16636),b=i(24599);let _=!1;function C(){_||(_=!0,(0,n.VJ)(),(0,l.kP)()?(0,o.Ns)(s.n):(0,l.KV)()&&(0,h.sn)(s.n),(0,d.x)(),(0,u.f)(),(0,c.M)(),(0,p.i)(),(0,g.N)(),(0,f.k)(),(0,m.v)(),(0,y.W)(),(0,v.k)(),(0,b.g)(),(0,a.E)(),(0,r.C)(),(0,a.E)())}}}]);
//# sourceMappingURL=1153.032bca80.js.map