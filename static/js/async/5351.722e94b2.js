/*! For license information please see 5351.722e94b2.js.LICENSE.txt */
(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["5351"],{91021:function(t,e,i){"use strict";let r,s;i.r(e),i.d(e,{PolarBandAxis:()=>vU,isProgressiveDataColorScheme:()=>e6,PolarMarkLine:()=>C3,registerSunburstChart:()=>kw,CircularProgressSeries:()=>bW,SEGMENT_FIELD_START:()=>nb,TextMark:()=>bS,registerMarkLine:()=>C0,registerDimensionTooltipProcessor:()=>mc,BasePolygonMark:()=>SS,registerMarkPoint:()=>EQ,createLine:()=>cU.W,ThemeManager:()=>iP,findMarkGraphic:()=>iW,stackOffsetSilhouette:()=>d$,MOSAIC_CAT_START_PERCENT:()=>n_,MediaQuery:()=>Ow,queryColorFromColorScheme:()=>e5,RadarChart:()=>bn,LayoutLevel:()=>j,BasePieChart:()=>vf,DEFAULT_SERIES_STYLE_NAME:()=>ns,dataScheme:()=>eD,GroupMark:()=>oh,vglobal:()=>es.rF,PolarSeries:()=>_Y,registerSankeyChart:()=>MF,registerArcAnimation:()=>u7,getTheme:()=>iw,PieChart:()=>vm,STACK_FIELD_KEY:()=>nn,DimensionEventEnum:()=>G,CartesianMarkArea:()=>Ei,stackMosaicTotal:()=>dG,registerRangeColumnSeries:()=>S1,registerScrollBar:()=>TP,registerComponentMark:()=>gL,isColorKey:()=>e7,STACK_FIELD_TOTAL:()=>nc,piePresetAnimation:()=>_5,getSpecInfo:()=>d0,normalizeLayoutPaddingSpec:()=>eA,registerRectAnimation:()=>u4,computeActualDataScheme:()=>e3,getDimensionInfoByValue:()=>f9,randomOpacity:()=>OE,registerElementHighlightByLegend:()=>Pl,SankeySeries:()=>ME,registerAllMarks:()=>Pb,MarkTypeEnum:()=>tE,columnRightToLeft:()=>OP,BaseSeriesSpecTransformer:()=>cw,registerHistogramChart:()=>bL,registerCartesianTimeAxis:()=>wp,FunnelSeries:()=>SE,HeatmapChart:()=>M1,pieDisappear:()=>_3,registerWordCloudChart:()=>Sl,registerReactAttributePlugin:()=>ub,alternatingWave:()=>Oj,isZAxis:()=>pX,registerElementHighlight:()=>dd,DEFAULT_DATA_SERIES_FIELD:()=>nr,ImageMark:()=>P_,registerVennSeries:()=>Od,lookup:()=>yb,StreamLight:()=>PM.G,registerMediaQuery:()=>OT,registerCartesianLogAxis:()=>w_,BaseArcMark:()=>vs,registerStateTransition:()=>Oq,STACK_FIELD_START_PERCENT:()=>no,DEFAULT_LAYOUT_RECT_LEVEL_MIN:()=>nW,barGrowOut:()=>mY,registerTreemapChart:()=>As,STACK_FIELD_END:()=>nl,PathMark:()=>yT,RadarSeries:()=>bi,AttributeLevel:()=>H,WaterfallSeries:()=>AM,PREFIX:()=>s6,STACK_FIELD_END_PERCENT:()=>nh,Layout:()=>at,STACK_FIELD_START:()=>na,defaultThemeName:()=>ix,TransformLevel:()=>L,registerLiquidSeries:()=>PN,CorrelationSeries:()=>wl,RuleMark:()=>bc,registerTreemapSeries:()=>Ae,registerPieSeries:()=>vc,BaseWordCloudChart:()=>xi,MapSeries:()=>_W,isPercent:()=>ev,RangeAreaChart:()=>MW,WaterfallChart:()=>AC,CartesianSymlogAxis:()=>wb,PolarMarkArea:()=>En,createRect:()=>m3.f,registerTitle:()=>C6,TotalLabel:()=>EW,registerContinuousLegend:()=>w$,getCartesianCrosshairRect:()=>ms,getColorSchemeBySeries:()=>e8,registerSankeySeries:()=>MB,RoseSeries:()=>vY,DEFAULT_MEASURE_CANVAS_ID:()=>nt,registerVRenderAnimate:()=>ux.d,CartesianLinearAxis:()=>fd,SymbolMark:()=>pD,registerCirclePackingChart:()=>kK,registerHarmonyEnv:()=>ui,STACK_FIELD_TOTAL_PERCENT:()=>np,createArc:()=>_6.Q,registerPolarBandAxis:()=>vG,centerToCorner:()=>OZ,BoxPlotSeries:()=>A4,registerMarkArea:()=>Er,DEFAULT_DATA_KEY:()=>ni,registerNodeEnv:()=>h9,functionTransform:()=>el,registerIndicator:()=>Tj,registerCorrelationChart:()=>wd,SeriesTypeEnum:()=>rw,registerGeoCoordinate:()=>_N,VennChart:()=>Op,barGrowIn:()=>m$,registerGeoMarkPoint:()=>E2,registerRangeColumnChart:()=>S5,STACK_FIELD_START_OffsetSilhouette:()=>nu,WordCloudChart:()=>Sa,ManualTicker:()=>PA,registerAnimate:()=>u8,registerBrush:()=>Be,Tooltip:()=>w1,registerGroupMark:()=>ou,ScrollBar:()=>TB,LiquidChart:()=>PV,registerMosaicSeries:()=>Oy,CartesianMarkLine:()=>CJ,getDiffAttributesOfGraphic:()=>iU,CommonChart:()=>bo,shouldMarkDoMorph:()=>ck,DataZoom:()=>TC,GaugePointerSeries:()=>b3,ComponentMark:()=>gR,builtinThemes:()=>ib,registerArcMark:()=>va,registerDataZoom:()=>TE,getCombinedSizeOfRegions:()=>gV,getRegionStackGroup:()=>dV,ContinuousLegend:()=>wZ,rotationScan:()=>OD,registerPoptip:()=>Bo,CirclePackingSeries:()=>kZ,registerImageMark:()=>Pv,registerLabel:()=>EV,registerLineChart:()=>m_,calcLayoutNumber:()=>ex,AreaSeries:()=>mN,CartesianBandAxis:()=>g9,diagonalCenterToEdge:()=>OR,getFieldAlias:()=>dN,pulseWave:()=>O$,boundsInRect:()=>ek,isCollectionMark:()=>iN,CorrelationChart:()=>wu,CircularProgressChart:()=>b$,registerBarChart:()=>yr,registerLarkEnv:()=>h7,AreaMark:()=>mL,BaseChart:()=>fF,registerMosaicChart:()=>Ov,PolygonMark:()=>SM,calcPadding:()=>eS,registerLinearProgressSeries:()=>SW,version:()=>Pw,LinearProgressChart:()=>SG,SunburstSeries:()=>kS,registerLynxEnv:()=>h6,registerLineSeries:()=>fT,LiquidSeries:()=>PH,registerSunBurstSeries:()=>kk,STACK_FIELD_TOTAL_BOTTOM:()=>nf,LinkSeries:()=>bm,BaseSeries:()=>cT,registerRoseChart:()=>v1,stackMosaic:()=>dZ,lightTheme:()=>ez,BoxPlotChart:()=>A9,BaseWordCloudChartSpecTransformer:()=>xe,MapChart:()=>_Z,registerAllEnv:()=>h5,registerGaugeSeries:()=>b6,registerRoseSeries:()=>vX,BaseWordCloudSeries:()=>xc,BaseHistogramChart:()=>bO,CartesianTimeAxis:()=>wc,FunnelChart:()=>SO,MOSAIC_CAT_END_PERCENT:()=>nv,SankeyChart:()=>MD,transformToGraphic:()=>gs,mergeFields:()=>dH,registerPolarLinearAxis:()=>v$,columnEdgeToCenter:()=>OV,registerLinearProgressChart:()=>SZ,registerTaroEnv:()=>h8,queryToken:()=>ur,getMergedTheme:()=>iE,Event:()=>iI,DEFAULT_SMOOTH_INTERPOLATE:()=>cP,registerBoxplotChart:()=>A8,createSymbol:()=>pR.t,getCartesianDimensionInfo:()=>f7,registerWaterfallSeries:()=>Aw,RoseLikeSeries:()=>vA,BaseComponent:()=>gO,FormatterPlugin:()=>B4,registerPolarCrossHair:()=>Th,registerLinkSeries:()=>by,STATE_VALUE_ENUM:()=>V,AxisSyncPlugin:()=>gt,spiralEffect:()=>OH,STACK_FIELD_TOTAL_TOP:()=>ng,BasePieChartSpecTransformer:()=>vg,rowTopToBottom:()=>OO,registerElementActive:()=>B8,BaseMark:()=>oa,TreemapChart:()=>Ar,registerPolarMarkPoint:()=>E0,CommonChartSpecTransformer:()=>bl,BandAxisMixin:()=>gZ,SEGMENT_FIELD_END:()=>nx,isPercentOffset:()=>eb,registerFunnelSeries:()=>SB,MosaicChart:()=>O_,WordCloudSeries:()=>Sr,CartesianSeries:()=>cB,transformColorSchemeToStandardStruct:()=>e9,createGroup:()=>s4.sS,CartesianChartSpecTransformer:()=>fP,pieExit:()=>_2,CirclePackingChart:()=>kX,rowCenterToEdge:()=>OW,registerDimensionHover:()=>fW,themes:()=>iS,registerCustomMark:()=>Br,registerDataSetInstanceTransform:()=>sY,AreaChart:()=>mU,Brush:()=>Bt,isXAxis:()=>p$,registerAreaMark:()=>mD,registerHtmlAttributePlugin:()=>u_,Player:()=>EI,GaugeSeries:()=>b7,registerElementHighlightByName:()=>Pd,DEFAULT_LINEAR_INTERPOLATE:()=>cO,PolarLinearAxis:()=>vZ,registerGroupTooltipProcessor:()=>mm,registerTooltip:()=>w2,registerElementHighlightByGroup:()=>Pg,registerRangeAreaChart:()=>MU,registerHeatmapSeries:()=>MJ,DEFAULT_ANIMATION_CONFIG:()=>uX,GridLayout:()=>Bs,ScatterSeries:()=>yg,stackTotal:()=>dU,registerCircularProgressSeries:()=>bU,columnLeftToRight:()=>OB,registerElementActiveByLegend:()=>Pr,registerAreaChart:()=>mG,registerDimensionEvents:()=>f0,CompilableData:()=>ly,registerMapChart:()=>_$,PolarAxis:()=>vC,PieSeriesSpecTransformer:()=>vo,createRichText:()=>bx.p,registerCirclePackingSeries:()=>k$,registerCircularProgressChart:()=>bY,registerPolygonMark:()=>Sw,DEFAULT_DATA_INDEX:()=>ne,RenderModeEnum:()=>rk,Factory:()=>ig,registerVennChart:()=>Og,registerBoxplotSeries:()=>A7,cornerToCenter:()=>OG,registerFormatPlugin:()=>B7,RangeAreaSeries:()=>MH,Direction:()=>tB,registerRangeAreaSeries:()=>MN,RangeColumnSeries:()=>S0,SeriesMarkNameEnum:()=>rT,registerWXEnv:()=>ut,snakeWave:()=>Oz,GaugeChart:()=>b8,Indicator:()=>Tz,LineChart:()=>my,registerCartesianCrossHair:()=>Ti,registerMapSeries:()=>_U,registerMarkFilterTransform:()=>k3,registerCustomAnimate:()=>OX.Hp,registerWordCloudSeries:()=>Ss,HistogramChartSpecTransformer:()=>bI,getActualNumValue:()=>ew,PieSeries:()=>vd,BasePieSeries:()=>vu,registerBarSeries:()=>yt,themeExist:()=>iC,DEFAULT_KEY:()=>nS,DomTooltipHandler:()=>BP,registerSymbolMark:()=>pF,registerCartesianLinearAxis:()=>fc,registerCartesianSymlogAxis:()=>wS,baseSeriesMark:()=>cd,token:()=>eF,rowBottomToTop:()=>OI,registerGesturePlugin:()=>de,BaseComponentSpecTransformer:()=>gB,DimensionHoverEvent:()=>fQ,DimensionClickEvent:()=>fJ,registerDotSeries:()=>bw,registerMarkMapTransform:()=>k5,registerPolygonAnimation:()=>u9,registerRectMark:()=>m4,registerRuleMark:()=>bp,BarChart:()=>yi,LineMark:()=>pO,registerRadarSeries:()=>br,getActualColor:()=>e4,registerSequentialAnimate:()=>O3,rowEdgeToCenter:()=>OU,Title:()=>C7,RectMark:()=>m5,RoseChart:()=>v0,TreemapSeries:()=>At,darkTheme:()=>ej,isYAxis:()=>pY,GeoSeries:()=>yx,ArcMark:()=>vn,LineSeries:()=>fw,FunnelChartSpecTransformer:()=>SP,SequenceChart:()=>bE,registerSequenceChart:()=>bB,registerFunnelChart:()=>SI,DEFAULT_LAYOUT_RECT_LEVEL:()=>nV,USER_LAYOUT_RECT_LEVEL:()=>nN,CartesianCrossHair:()=>Te,registerDomTooltipHandler:()=>BO,registerScatterSeries:()=>yf,sortStackValueGroup:()=>dW,userAnimationConfig:()=>cb,VennSeries:()=>Ou,DEFAULT_CHART_HEIGHT:()=>s8,HeatmapSeries:()=>MQ,VChart:()=>dy,stack:()=>dY,pieEnter:()=>_1,registerScatterChart:()=>y_,registerTotalLabel:()=>EU,registerCartesianBandAxis:()=>g8,CartesianLogAxis:()=>wy,DotSeries:()=>bM,registerRadarChart:()=>ba,CustomMark:()=>Bi,registerCanvasTooltipHandler:()=>BZ,HistogramChart:()=>bR,convertPoint:()=>eM,PositionEnum:()=>tP,Label:()=>EN,isTokenKey:()=>us,registerTTEnv:()=>ue,ChartEvent:()=>rB,registerPathMark:()=>yC,registerPolarMarkArea:()=>Ea,PolarCrossHair:()=>To,BarSeriesSpecTransformer:()=>m9,CartesianAxis:()=>gG,registerLiquidChart:()=>PW,registerMarkTooltipProcessor:()=>mg,BarSeries:()=>m8,ScatterChart:()=>yy,getPolarDimensionInfo:()=>vJ,registerDataSetInstanceParser:()=>sX,RippleMark:()=>wi,registerLineMark:()=>pI,columnCenterToEdge:()=>ON,getDatumOfGraphic:()=>iV,DEFAULT_CHART_WIDTH:()=>s9,ElementHighlight:()=>du,TooltipResult:()=>tR,measureText:()=>op,SunburstChart:()=>kM,specTransform:()=>ea,registerTextMark:()=>bk,DiscreteLegend:()=>wP,getDataScheme:()=>e2,LinearProgressSeries:()=>SV,registerTheme:()=>iM,GeoCoordinate:()=>_H,rippleEffect:()=>OF,ElementSelect:()=>dp,BaseChartSpecTransformer:()=>fB,registerCommonChart:()=>bh,registerBrowserEnv:()=>h4,particleEffect:()=>OY,RangeColumnSeriesSpecTransformer:()=>SJ,registerDragPlugin:()=>dt,registerWordCloudShapeChart:()=>So,registerGaugeChart:()=>xt,BasePlugin:()=>p8,BaseSeriesTooltipHelper:()=>d8,barPresetAnimation:()=>mq,LinearAxisMixin:()=>fo,registerChartPlugin:()=>B1,hasThemeMerged:()=>iA,CartesianMarkPoint:()=>Eq,SeriesTypeForThemeEnum:()=>tI,createArea:()=>mS,diagonalTopLeftToBottomRight:()=>OL,MosaicSeries:()=>Om,registerElementHighlightByKey:()=>Py,FunnelSeriesSpecTransformer:()=>SC,PolarMarkPoint:()=>EJ,isValidOrient:()=>e_,registerDiscreteLegend:()=>wO,registerAreaSeries:()=>mV,registerWaterfallChart:()=>AE,LayoutZIndex:()=>z,removeTheme:()=>iT,getFunnelTheme:()=>i_,DEFAULT_CLOSE_STROKE_JOIN:()=>cI,registerElementSelect:()=>dg,registerGridLayout:()=>Ba,registerPieChart:()=>vy,MOSAIC_VALUE_END_PERCENT:()=>ny,RangeColumnChart:()=>S3,ProgressLikeSeries:()=>bF,registerPlayer:()=>ER,CanvasTooltipHandler:()=>BG,default:()=>O5,registerHeatmapChart:()=>M2,stackGroup:()=>dX,GeoMarkPoint:()=>E1,STACK_FIELD_END_OffsetSilhouette:()=>nd,registerPolarMarkLine:()=>C5,MOSAIC_VALUE_START_PERCENT:()=>nm,animationConfig:()=>cv,createText:()=>gN.r,registerRippleMark:()=>wr,BarChartSpecTransformer:()=>ye,warn:()=>eI,registerGaugePointerSeries:()=>b5});var n,a,l,o,h,u,d,c,p,g,f,m,y,_,v,b,x,S,k,A,M,w,T,C,E,B,P,O,I,R,L,D,F,z,j,H,N,V,W,U,G,Z,$,Y,X,K,q,Q,J,te,ti,tr,ts,tn,ta,tl,to,th,tu,td,tc,tp,tg,tf,tm,ty,t_,tv,tb,tx,tS,tk,tA,tM,tw,tT,tC,tE,tB,tP,tO,tI,tR,tL={};i.r(tL),i.d(tL,{LX:()=>aY});let tD=t=>t;(rp=rk||(rk={}))["desktop-browser"]="desktop-browser",rp["mobile-browser"]="mobile-browser",rp.node="node",rp.worker="worker",rp.miniApp="miniApp",rp.wx="wx",rp.tt="tt",rp.harmony="harmony",rp["desktop-miniApp"]="desktop-miniApp",rp.lynx="lynx",(rg=rA||(rA={})).cartesianAxis="cartesianAxis",rg.cartesianBandAxis="cartesianAxis-band",rg.cartesianLinearAxis="cartesianAxis-linear",rg.cartesianTimeAxis="cartesianAxis-time",rg.cartesianLogAxis="cartesianAxis-log",rg.cartesianSymlogAxis="cartesianAxis-symlog",rg.polarAxis="polarAxis",rg.polarBandAxis="polarAxis-band",rg.polarLinearAxis="polarAxis-linear",rg.crosshair="crosshair",rg.cartesianCrosshair="cartesianCrosshair",rg.polarCrosshair="polarCrosshair",rg.dataZoom="dataZoom",rg.geoCoordinate="geoCoordinate",rg.indicator="indicator",rg.discreteLegend="discreteLegend",rg.continuousLegend="continuousLegend",rg.colorLegend="colorLegend",rg.sizeLegend="sizeLegend",rg.markLine="markLine",rg.markArea="markArea",rg.markPoint="markPoint",rg.polarMarkLine="polarMarkLine",rg.polarMarkArea="polarMarkArea",rg.polarMarkPoint="polarMarkPoint",rg.geoMarkPoint="geoMarkPoint",rg.tooltip="tooltip",rg.title="title",rg.player="player",rg.scrollBar="scrollBar",rg.label="label",rg.totalLabel="totalLabel",rg.brush="brush",rg.poptip="poptip",rg.customMark="customMark";var tF=i(21883),tz=i.n(tF);let tj=(t,e)=>Object.prototype.toString.call(t)===`[object ${e}]`,tH=(t,e=!1)=>{let i=typeof t;return e?"number"===i:"number"===i||tj(t,"Number")},tN="undefined"!=typeof console;function tV(t,e,i){let r=[e].concat([].slice.call(i));tN&&console[t].apply(console,r)}(rf=rM||(rM={}))[rf.None=0]="None",rf[rf.Error=1]="Error",rf[rf.Warn=2]="Warn",rf[rf.Info=3]="Info",rf[rf.Debug=4]="Debug";class tW{static getInstance(t,e){return tW._instance&&tH(t)?tW._instance.level(t):tW._instance||(tW._instance=new tW(t,e)),tW._instance}static setInstance(t){return tW._instance=t}static setInstanceLevel(t){tW._instance?tW._instance.level(t):tW._instance=new tW(t)}static clearInstance(){tW._instance=null}constructor(t=rM.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){let e=this._onErrorHandler.findIndex(e=>e===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=rM.Info}canLogDebug(){return this._level>=rM.Debug}canLogError(){return this._level>=rM.Error}canLogWarn(){return this._level>=rM.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=rM.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):tV(null!=(e=this._method)?e:"error","ERROR",t)),this}warn(...t){return this._level>=rM.Warn&&tV(this._method||"warn","WARN",t),this}info(...t){return this._level>=rM.Info&&tV(this._method||"log","INFO",t),this}debug(...t){return this._level>=rM.Debug&&tV(this._method||"log","DEBUG",t),this}}tW._instance=null;let tU=0;function tG(t="dataset"){return tU>1e8&&(tU=0),t+"_"+tU++}class tZ{constructor(t){var e;let i;this.options=t,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new(tz()),i=(null==t?void 0:t.name)?t.name:tG("dataset"),this.name=i,this._logger=null!=(e=null==t?void 0:t.logger)?e:tW.getInstance()}setLogger(t){this._logger=t}getDataView(t){return this.dataViewMap[t]}setDataView(t,e){var i;this.dataViewMap[t]&&(null==(i=this._logger)||i.error(`Error: dataView ${t} 之前已存在，请重新命名`)),this.dataViewMap[t]=e}removeDataView(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}registerParser(t,e){var i;this.parserMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.parserMap[t]=e}removeParser(t){this.parserMap[t]=null,delete this.parserMap[t]}getParser(t){return this.parserMap[t]||this.parserMap.default}registerTransform(t,e){var i;this.transformMap[t]&&(null==(i=this._logger)||i.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.transformMap[t]=e}removeTransform(t){this.transformMap[t]=null,delete this.transformMap[t]}getTransform(t){return this.transformMap[t]}multipleDataViewAddListener(t,e,i){this._callMap||(this._callMap=new Map);let r=this._callMap.get(i);r||(r=()=>{t.some(t=>t.isRunning)||i()}),t.forEach(t=>{t.target.addListener(e,r)}),this._callMap.set(i,r)}allDataViewAddListener(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}multipleDataViewRemoveListener(t,e,i){if(this._callMap){let r=this._callMap.get(i);r&&t.forEach(t=>{t.target.removeListener(e,r)}),this._callMap.delete(i)}}multipleDataViewUpdateInParse(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.parseNewData(t.data,t.options)})}multipleDataViewUpdateInRawData(t){t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.markRunning()}),t.forEach(t=>{var e;return null==(e=this.getDataView(t.name))?void 0:e.updateRawData(t.data,t.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}let t$=(t,e=!1)=>e?"boolean"==typeof t:!0===t||!1===t||tj(t,"Boolean"),tY=t=>Array.isArray?Array.isArray(t):tj(t,"Array"),tX=(t,e,i)=>{let r=!t$(null==e?void 0:e.dependencyUpdate)||(null==e?void 0:e.dependencyUpdate);if(!t||!tY(t))throw TypeError("Invalid data: must be DataView array!");return tY(i.rawData)&&i.rawData.forEach(t=>{t.target&&(t.target.removeListener("change",i.reRunAllTransform),t.target.removeListener("markRunning",i.markRunning))}),r&&t.forEach(t=>{t.target.addListener("change",i.reRunAllTransform),t.target.addListener("markRunning",i.markRunning)}),t},tK=t=>"function"==typeof t,tq=t=>"object"==typeof t&&null!==t,tQ=function(t){if(!tq(t)||!tj(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function tJ(t){return Object.prototype.toString.call(t)}function t0(t){return Object.keys(t)}function t1(t,e,i){if(t===e)return!0;if(typeof t!=typeof e||null==t||null==e)return!1;if(Number.isNaN(t)&&Number.isNaN(e))return!0;if(tJ(t)!==tJ(e))return!1;if(tK(t))return!!(null==i?void 0:i.skipFunction);if("object"!=typeof t)return!1;if(tY(t)){if(t.length!==e.length)return!1;for(let r=t.length-1;r>=0;r--)if(!t1(t[r],e[r],i))return!1;return!0}if(!tQ(t))return!1;let r=t0(t),s=t0(e);if(r.length!==s.length)return!1;r.sort(),s.sort();for(let t=r.length-1;t>=0;t--)if(r[t]!=s[t])return!1;for(let s=r.length-1;s>=0;s--){let n=r[s];if(!t1(t[n],e[n],i))return!1}return!0}let t2=t=>tj(t,"Date"),t3=(t,e=!1)=>{let i=typeof t;return e?"string"===i:"string"===i||tj(t,"String")},t5=t=>null!=t;function t4(t,e,i){let r;if(!t5(t)||"object"!=typeof t||e&&e(t))return t;let s=tY(t),n=t.length;r=s?Array(n):"object"==typeof t?{}:t$(t)||tH(t)||t3(t)?t:t2(t)?new Date(+t):void 0;let a=s?void 0:Object.keys(Object(t)),l=-1;if(r)for(;++l<(a||t).length;){let s=a?a[l]:l,n=t[s];i&&i.includes(s.toString())?r[s]=n:r[s]=t4(n,e,i)}return r}let t7=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)};function t6(t,e,i=!1,r=!1){if(e&&t!==e&&t5(e)&&"object"==typeof e){let s=Object(e),n=[];for(let t in s)n.push(t);let{length:a}=n,l=-1;for(;a--;){let a=n[++l];!t5(s[a])||"object"!=typeof s[a]||r&&tY(t[a])?t9(t,a,s[a]):function(t,e,i,r=!1,s=!1){let n=t[i],a=e[i],l=e[i],o=!0;if(tY(a)){if(r)l=[];else if(tY(n))l=n;else if(t7(n)){l=Array(n.length);let t=-1,e=n.length;for(;++t<e;)l[t]=n[t]}}else tQ(a)?(l=null!=n?n:{},"function"!=typeof n&&"object"==typeof n||(l={})):o=!1;o&&t6(l,a,r,s),t9(t,i,l)}(t,e,a,i,r)}}}function t9(t,e,i){var r,s;(void 0===i||(r=t[e],r===(s=i)||Number.isNaN(r)&&Number.isNaN(s)))&&(void 0!==i||e in t)||(t[e]=i)}function t8(t,...e){let i=-1,r=e.length;for(;++i<r;)t6(t,e[i],!0);return t}let et=t=>null==t,ee=t=>tH(t)&&Number.isFinite(t),ei=(t,e)=>{var i,r;if(!(null==e?void 0:e.fields)||0===t.length)return t;let s=e.fields,n=t[0],a={},l=[];for(let e in s)if(Object.prototype.hasOwnProperty.call(s,e)){let o,h=s[e];if(h.sort&&(ee(h.sortIndex)||(h.sortIndex=0),t5(h.sortReverse)||(h.sortReverse="desc"===h.sort)),!h.type){let r=n;e in n||(r=null!=(i=t.find(t=>e in t))?i:n),h.type="number"==typeof r[e]?"linear":"ordinal"}if("number"==typeof h.sortIndex&&(o={key:e,type:h.type,index:h.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===h.sortReverse},l.push(o)),(null==(r=h.domain)?void 0:r.length)>0)if("ordinal"===h.type){h._domainCache={},a[e]=h;let t={};h.domain.forEach((e,i)=>{t[e]=i,h._domainCache[e]=i}),o&&(o.sortIndex=t,o.sortIndexCount=h.domain.length)}else h.domain.length>=2&&(a[e]=h)}return Object.keys(a).length>0&&(t=t.filter(t=>{for(let e in a){let i=a[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0})),l.sort((t,e)=>t.index-e.index),t.sort((t,e)=>(function(t,e,i){for(let r=0;r<i.length;r++){let s=i[r],n=0;if("ordinal"===s.type?(void 0===s.sortIndex[e[s.key]]&&(s.sortIndex[e[s.key]]=s.sortIndexCount++),void 0===s.sortIndex[t[s.key]]&&(s.sortIndex[t[s.key]]=s.sortIndexCount++),n=s.sortIndex[t[s.key]]-s.sortIndex[e[s.key]]):"linear"===s.type&&(n=t[s.key]-e[s.key]),s.sortReverse&&(n=-n),0!==n)return n}return 0})(t,e,l)),t};class er{constructor(t,e){let i;this.dataSet=t,this.options=e,this.isDataView=!0,this.target=new(tz()),this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(t={})=>{let e=this.latestData;return this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(e=>{this.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1})}),this.isRunning=!1,!1===t.emitMessage||t.skipEqual&&t1(e,this.latestData)||this.target.emit("change",{latestData:this.latestData}),this},this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},i=(null==e?void 0:e.name)?e.name:tG("dataview"),this.name=i,(null==e?void 0:e.history)&&(this.history=e.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(null==e?void 0:e.fields)}parse(t,e,i=!1){var r;this.isRunning=!0,i&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);let s=this.cloneParseData(t,e);if(null==e?void 0:e.type){let t=(null!=(r=this.dataSet.getParser(e.type))?r:this.dataSet.getParser("bytejson"))(s,e.options,this);this.rawData=s,this.parserData=t,this.history&&this.historyData.push(s,t),this.latestData=t}else this.parserData=s,this.rawData=s,this.history&&this.historyData.push(s),this.latestData=s;return this.isRunning=!1,i&&this.target.emit("afterParse",[]),this}transform(t,e=!0){if(this.isRunning=!0,t&&t.type){let i=!0;if("fields"===t.type){this._fields=t.options.fields;let e=this.transformsArr.findIndex(e=>e.type===t.type);e>=0&&(i=!1,this.transformsArr[e].options.fields=this._fields)}i&&this.transformsArr.push(t),e&&this.executeTransform(t)}return this.sortTransform(),this.isRunning=!1,this}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((t,e)=>{var i,r;return(null!=(i=t.level)?i:0)-(null!=(r=e.level)?r:0)})}executeTransform(t,e={}){let{pushHistory:i,emitMessage:r,skipEqual:s}=e,n=this.dataSet.getTransform(t.type),a=this.latestData,l=n(a,t.options);this.history&&!1!==i&&this.historyData.push(l),this.latestData=l,!1===r||s&&t1(a,this.latestData)||this.target.emit("change",{latestData:this.latestData})}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}cloneParseData(t,e){let i=!1;return t instanceof er||!0!==(null==e?void 0:e.clone)||(i=!0),i?t4(t):t}parseNewData(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}updateRawData(t,e){let i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var t;return this._fields?this._fields:"dataview"===(null==(t=this.parseOption)?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(t,e=!1){this._fields=t&&e?t8({},this._fields,t):t;let i=this.transformsArr.find(t=>"fields"===t.type);!et(this._fields)&&et(i)?(this.dataSet.registerTransform("fields",ei),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}var es=i(91925);function en(t){return function(e){return tY(t)?t.reduce((t,e)=>null==t?void 0:t[e],e):null==e?void 0:e[t]}}function ea(t,e={data:t=>t}){if(!t)return t;if(t.constructor===Object){let i={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e[r]){i[r]=e[r](t[r]);continue}i[r]=ea(t[r],e)}return i}return tY(t)?t.map(t=>ea(t,e)):t}function el(t,e){if(!t)return t;if(tQ(t)){let i={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(t3(t[r])&&e.getFunction(t[r])){i[r]=e.getFunction(t[r]);continue}i[r]=el(t[r],e)}return i}return tY(t)?t.map(t=>el(t,e)):t}function eo(t){return t5(t)?tY(t)?t:[t]:[]}function eh(t){if(t7(t))return t[t.length-1]}let eu=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let s=1;s<t.length;s++){let n=t[s];(null!=(i=null==e?void 0:e(n,r))?i:n-r)>0&&(r=n)}return r},ed=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let s=1;s<t.length;s++){let n=t[s];(null!=(i=null==e?void 0:e(n,r))?i:n-r)<0&&(r=n)}return r};function ec(t,e=Math.random){let i,r,s=t.length;for(;s;)i=Math.floor(e()*s),r=t[--s],t[s]=t[i],t[i]=r;return t}let ep=0;function eg(){return ep>=9999999&&(ep=0),ep++}function ef(t){return null!=t&&""!==t&&(!!tH(t)||+t==+t)}function em(t){return!(!t||0===t.length)&&!et(t[0])&&!et(t[0].dataId)&&tY(t[0].fields)}let ey=t=>{let e=typeof t;return null!==t&&"object"===e||"function"===e};function e_(t){switch(t){case"left":case"right":case"top":case"bottom":return!0;default:return!1}}function ev(t){return!!t3(t)&&!!t.endsWith("%")&&ef(t.substring(0,t.length-1))}function eb(t){return!!ey(t)&&("percent"in t||"offset"in t)}function ex(t,e,i,r=0){var s,n;return tH(t)?t:ev(t)?Number(t.substring(0,t.length-1))*e/100:tK(t)?t(i):ey(t)?e*(null!=(s=t.percent)?s:0)+(null!=(n=t.offset)?n:0):r}function eS(t,e,i){var r,s,n,a;let l={top:0,bottom:0,left:0,right:0};return Object.values(t).every(t=>tH(t))?(l.top=null!=(r=t.top)?r:0,l.right=null!=(s=t.right)?s:0,l.bottom=null!=(n=t.bottom)?n:0,l.left=null!=(a=t.left)?a:0):[{orients:["left","right"],size:e.width},{orients:["top","bottom"],size:e.height}].forEach(e=>{e.orients.forEach(r=>{l[r]=ex(t[r],e.size,i)})}),l}function ek(t,e){return t?{width:Math.ceil(Math.min(t.x2-t.x1,e.width)),height:Math.ceil(Math.min(t.y2-t.y1,e.height))}:{width:0,height:0}}function eA(t){let e={};return tY(t)?(et(t[0])||(e.top=e.left=e.bottom=e.right=t[0]),et(t[1])||(e.left=e.right=t[1]),et(t[2])||(e.bottom=t[2]),et(t[3])||(e.left=t[3]),e):tH(t)||ev(t)||tK(t)||eb(t)?(e.top=e.left=e.bottom=e.right=t,e):ey(t)?e=Object.assign({},t):e}function eM(t,e,i){return i?{x:t.x+e.x,y:t.y+e.y}:t}let ew=(t,e)=>{let i=Number(t),r=t.toString();return isNaN(i)&&"%"===r[r.length-1]?e*(Number(r.slice(0,r.length-1))/100):i},eT=(0,i(46710).kP)(),eC=eT&&globalThis?globalThis.document:void 0;function eE(t){return("desktop-browser"===t||"mobile-browser"===t)&&eT}function eB(t){return eP(t)||"mobile-browser"===t}function eP(t){return t.includes("miniApp")||"lynx"===t||"wx"===t||"harmony"===t}let eO=(t,...e)=>eL.silent?null:tW.getInstance().info(`[VChart log]: ${t}`,...e),eI=(t,e)=>(tK(eL.warnHandler)&&eL.warnHandler.call(null,t,e),e?tW.getInstance().warn(`[VChart warn]: ${t}`,e):tW.getInstance().warn(`[VChart warn]: ${t}`)),eR=(t,e,i)=>{if(!eL.silent){if(!tK(eL.errorHandler))throw Error(t);eL.errorHandler.call(null,t,e)}},eL={silent:!1,warnHandler:!1,errorHandler:!1},eD=[{maxDomainLength:10,scheme:["#1664FF","#1AC6FF","#FF8A00","#3CC780","#7442D4","#FFC400","#304D77","#B48DEB","#009488","#FF7DDA"]},{scheme:["#1664FF","#B2CFFF","#1AC6FF","#94EFFF","#FF8A00","#FFCE7A","#3CC780","#B9EDCD","#7442D4","#DDC5FA","#FFC400","#FAE878","#304D77","#8B959E","#B48DEB","#EFE3FF","#009488","#59BAA8","#FF7DDA","#FFCFEE"]}],eF={fontFamily:"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",fontSize:14,l1FontSize:32,l1LineHeight:"150%",l2FontSize:20,l2LineHeight:"140%",l3FontSize:16,l3LineHeight:"150%",l4FontSize:14,l4LineHeight:"150%",l5FontSize:12,l5LineHeight:"130%",l6FontSize:10,l6LineHeight:"120%"},ez={name:"light",background:{type:"palette",key:"backgroundColor"},padding:20,fontFamily:{type:"token",key:"fontFamily"},colorScheme:{default:{dataScheme:eD,palette:{backgroundColor:"#ffffff",borderColor:"#e3e5e8",shadowColor:"rgba(33,37,44,0.1)",hoverBackgroundColor:"#f1f2f5",sliderRailColor:"#f1f3f4",sliderHandleColor:"#ffffff",sliderTrackColor:"#0040ff",popupBackgroundColor:"#ffffff",primaryFontColor:"#21252c",secondaryFontColor:"#606773",tertiaryFontColor:"#89909d",axisLabelFontColor:"#89909d",disableFontColor:"#bcc1cb",axisMarkerFontColor:"#ffffff",axisGridColor:"#f1f2f5",axisDomainColor:"#d9dde4",dataZoomHandleStrokeColor:"#aeb5be",dataZoomChartColor:"#c9ced8",playerControllerColor:"#0040ff",scrollBarSliderColor:"rgba(0,0,0,0.3)",axisMarkerBackgroundColor:"#21252c",markLabelBackgroundColor:"#f1f2f5",markLineStrokeColor:"#606773",dangerColor:"#e33232",warningColor:"#ffc528",successColor:"#07a35a",infoColor:"#3073f2",discreteLegendPagerTextColor:"rgb(51, 51, 51)",discreteLegendPagerHandlerColor:"rgb(47, 69, 84)",discreteLegendPagerHandlerDisableColor:"rgb(170, 170, 170)",emptyCircleColor:"#e3e5e8",linearProgressTrackColor:"#E7EBED"}}},token:eF,component:{poptip:{visible:!0,position:"auto",padding:8,titleStyle:{fontSize:{type:"token",key:"l5FontSize"},fontWeight:"bold",fill:{type:"palette",key:"primaryFontColor"}},contentStyle:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"primaryFontColor"}},panel:{visible:!0,fill:{type:"palette",key:"popupBackgroundColor"},cornerRadius:3,lineWidth:0,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"},size:0,space:12}}},mark:{text:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1}}},markByName:{label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1,lineJoin:"bevel"}},area:{style:{fillOpacity:.2}},line:{style:{lineWidth:2,lineCap:"round",lineJoin:"round"}},point:{style:{size:8,stroke:{type:"palette",key:"backgroundColor"},lineWidth:1,fillOpacity:1}},word:{style:{fontWeight:null,fontSize:null}},fillingWord:{style:{fontWeight:null,fontSize:null}},barBackground:{visible:!1,style:{fill:{type:"palette",key:"primaryFontColor",a:.06},stroke:"transparent"}}},animationThreshold:2e3},ej={name:"dark",colorScheme:{default:{dataScheme:eD,palette:{backgroundColor:"#202226",borderColor:"#404349",shadowColor:"rgba(0,0,0,0.1)",hoverBackgroundColor:"#404349",sliderRailColor:"#404349",sliderHandleColor:"#202226",sliderTrackColor:"#4284FF",popupBackgroundColor:"#404349",primaryFontColor:"#fdfdfd",secondaryFontColor:"#bbbdc3",tertiaryFontColor:"#888c93",axisLabelFontColor:"#888c93",disableFontColor:"#55595f",axisMarkerFontColor:"#202226",axisGridColor:"#404349",axisDomainColor:"#4b4f54",dataZoomHandleStrokeColor:"#bbbdc3",dataZoomChartColor:"#55595F",playerControllerColor:"#4284FF",scrollBarSliderColor:"rgba(255,255,255,0.3)",axisMarkerBackgroundColor:"#fdfdfd",markLabelBackgroundColor:"#404349",markLineStrokeColor:"#bbbdc3",dangerColor:"#eb4b4b",warningColor:"#f0bd30",successColor:"#14b267",infoColor:"#4284ff",discreteLegendPagerTextColor:"#BBBDC3",discreteLegendPagerHandlerColor:"#BBBDC3",discreteLegendPagerHandlerDisableColor:"#55595F",emptyCircleColor:"#bbbdc3",linearProgressTrackColor:"#404349"}}},component:{dataZoom:{selectedBackground:{style:{fillOpacity:.4,outerBorder:{strokeOpacity:.4}}}}}},eH=function(t,e,i){return t<e?e:t>i?i:t};function eN(t,e,i){let r=(1-Math.abs(2*(i/=100)-1))*(e/=100),s=r*(1-Math.abs(t/60%2-1)),n=i-r/2,a=0,l=0,o=0;return 0<=t&&t<60?(a=r,l=s,o=0):60<=t&&t<120?(a=s,l=r,o=0):120<=t&&t<180?(a=0,l=r,o=s):180<=t&&t<240?(a=0,l=s,o=r):240<=t&&t<300?(a=s,l=0,o=r):300<=t&&t<360&&(a=r,l=0,o=s),{r:a=Math.round(255*(a+n)),g:l=Math.round(255*(l+n)),b:o=Math.round(255*(o+n))}}function eV(t,e,i){t/=255;let r=Math.min(t,e/=255,i/=255),s=Math.max(t,e,i),n=s-r,a=0,l=0,o=0;return(a=Math.round(60*(a=0===n?0:s===t?(e-i)/n%6:s===e?(i-t)/n+2:(t-e)/n+4)))<0&&(a+=360),o=(s+r)/2,{h:a,s:l=+(100*(l=0===n?0:n/(1-Math.abs(2*o-1)))).toFixed(1),l:o=+(100*o).toFixed(1)}}let eW=/^#([0-9a-f]{3,8})$/,eU={transparent:0xffffff00},eG={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function eZ(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function e$(t){return tH(t)?new eQ(t>>16,t>>8&255,255&t,1):tY(t)?new eQ(t[0],t[1],t[2]):new eQ(255,255,255)}function eY(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function eX(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let eK=(t,e)=>{let i=eW.exec(t);if(e||i){let t=parseInt(i[1],16),e=i[1].length;return 3===e?new eQ((t>>8&15)+((t>>8&15)<<4),(t>>4&15)+((t>>4&15)<<4),(15&t)+((15&t)<<4),1):6===e?e$(t):8===e?new eQ(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):null}};class eq{static Brighter(t,e=1){return 1===e?t:new eq(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return 1===e?t:new eq(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){let i=t instanceof eq?t:new eq(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3();case"wcag":return i.getLuminanceWCAG()}}static parseColorString(t){if(t5(eU[t])){var e;return tH(e=eU[t])?new eQ(e>>>24,e>>>16&255,e>>>8&255,255&e):tY(e)?new eQ(e[0],e[1],e[2],e[3]):new eQ(255,255,255,1)}if(t5(eG[t]))return e$(eG[t]);let i=`${t}`.trim().toLowerCase(),r=eK(i);if(void 0!==r)return r;if(/^(rgb|RGB|rgba|RGBA)/.test(i)){let t=i.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new eQ(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),parseFloat(t[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(i)){let t=i.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),e=eN(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));return new eQ(e.r,e.g,e.b,parseFloat(t[3]))}}constructor(t){let e=eq.parseColorString(t);e?this.color=e:(console.warn(`Warn: 传入${t}无法解析为Color`),this.color=new eQ(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){let{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){let r=this.color.opacity,s=eV(this.color.r,this.color.g,this.color.b),n=eN(et(t)?s.h:eH(t,0,360),et(e)?s.s:e>=0&&e<=1?100*e:e,et(i)?s.l:i<=1&&i>=0?100*i:i);return this.color=new eQ(n.r,n.g,n.b,r),this}setRGB(t,e,i){return et(t)||(this.color.r=t),et(e)||(this.color.g=e),et(i)||(this.color.b=i),this}setHex(t){let e=eK(`${t}`.trim().toLowerCase(),!0);return null!=e?e:this}setColorName(t){let e=eG[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}getLuminanceWCAG(){let t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;return .2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))}clone(){return new eq(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){let i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=eY(t.color.r),this.color.g=eY(t.color.g),this.color.b=eY(t.color.b),this}copyLinearToSRGB(t){return this.color.r=eX(t.color.r),this.color.g=eX(t.color.g),this.color.b=eX(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class eQ{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),t5(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${eZ(this.r)+eZ(this.g)+eZ(this.b)+(1===this.opacity?"":eZ(255*this.opacity))}`}formatRgb(){let t=this.opacity;return`${1===t?"rgb(":"rgba("}${this.r},${this.g},${this.b}${1===t?")":`,${t})`}`}formatHsl(){let t=this.opacity,{h:e,s:i,l:r}=eV(this.r,this.g,this.b);return`${1===t?"hsl(":"hsla("}${e},${i}%,${r}%${1===t?")":`,${t})`}`}toString(){return this.formatHex()}}function eJ(t){var e,i;let{type:r}=t;return r===rw.sankey?null!=(e=t.direction)?e:"horizontal":null!=(i=t.direction)?i:"vertical"}(rm=rw||(rw={})).area="area",rm.line="line",rm.bar="bar",rm.rangeColumn="rangeColumn",rm.rangeArea="rangeArea",rm.dot="dot",rm.geo="geo",rm.link="link",rm.map="map",rm.pie="pie",rm.radar="radar",rm.rose="rose",rm.scatter="scatter",rm.circularProgress="circularProgress",rm.wordCloud="wordCloud",rm.funnel="funnel",rm.linearProgress="linearProgress",rm.boxPlot="boxPlot",rm.sankey="sankey",rm.gaugePointer="gaugePointer",rm.gauge="gauge",rm.treemap="treemap",rm.sunburst="sunburst",rm.circlePacking="circlePacking",rm.waterfall="waterfall",rm.heatmap="heatmap",rm.correlation="correlation",rm.liquid="liquid",rm.venn="venn",rm.mosaic="mosaic",rm.pictogram="pictogram",(ry=rT||(rT={})).label="label",ry.point="point",ry.line="line",ry.area="area",ry.bar="bar",ry.boxPlot="boxPlot",ry.outlier="outlier",ry.circlePacking="circlePacking",ry.group="group",ry.gridBackground="gridBackground",ry.grid="grid",ry.dot="dot",ry.title="title",ry.subTitle="subTitle",ry.symbol="symbol",ry.funnel="funnel",ry.transform="transform",ry.transformLabel="transformLabel",ry.outerLabel="outerLabel",ry.outerLabelLine="outerLabelLine",ry.pin="pin",ry.pinBackground="pinBackground",ry.pointer="pointer",ry.segment="segment",ry.track="track",ry.cell="cell",ry.cellBackground="cellBackground",ry.link="link",ry.arrow="arrow",ry.pie="pie",ry.labelLine="labelLine",ry.progress="progress",ry.minLabel="minLabel",ry.maxLabel="maxLabel",ry.rose="rose",ry.node="node",ry.sunburst="sunburst",ry.nonLeaf="nonLeaf",ry.leaf="leaf",ry.nonLeafLabel="nonLeafLabel",ry.leaderLine="leaderLine",ry.stackLabel="stackLabel",ry.word="word",ry.fillingWord="fillingWord",ry.wordMask="wordMask",ry.nodePoint="nodePoint",ry.ripplePoint="ripplePoint",ry.centerPoint="centerPoint",ry.centerLabel="centerLabel",ry.barBackground="barBackground",ry.lineLabel="lineLabel",ry.areaLabel="areaLabel",ry.liquidGroup="liquidGroup",ry.liquid="liquid",ry.liquidBackground="liquidBackground",ry.liquidOutline="liquidOutline",ry.circle="circle",ry.overlap="overlap",ry.overlapLabel="overlapLabel";let e0={primaryFontColor:"titleFontColor",tertiaryFontColor:"labelFontColor",axisLabelFontColor:"axisFontColor",axisMarkerFontColor:"labelReverseFontColor",dataZoomHandleStrokeColor:"dataZoomHandlerStrokeColor",sliderHandleColor:"dataZoomHandlerFillColor",sliderRailColor:"dataZoomBackgroundColor",sliderTrackColor:"dataZoomSelectedColor",playerControllerColor:"dataZoomSelectedColor",popupBackgroundColor:"tooltipBackgroundColor",hoverBackgroundColor:"axisGridColor"},e1={titleFontColor:"primaryFontColor",labelFontColor:"tertiaryFontColor",axisFontColor:"axisLabelFontColor",labelReverseFontColor:"axisMarkerFontColor",dataZoomHandlerStrokeColor:"dataZoomHandleStrokeColor",dataZoomHandlerFillColor:"sliderHandleColor",dataZoomBackgroundColor:"sliderRailColor",dataZoomSelectedColor:"sliderTrackColor",tooltipBackgroundColor:"popupBackgroundColor"};function e2(t,e){if(!t)return[];let i=e8(t,e);if(!i||tY(i))return null!=i?i:[];if(ey(i)){let{dataScheme:r}=i;return r?e6(r)?r.map(i=>Object.assign(Object.assign({},i),{scheme:i.scheme.map(i=>e7(i)?e5(t,i,e):i).filter(t5)})):r.map(i=>e7(i)?e5(t,i,e):i).filter(t5):[]}return[]}function e3(t,e){var i,r;return e6(t)?null!=(r=null==(i=t.find(t=>t5(t.isAvailable)?tK(t.isAvailable)?t.isAvailable(e):!!t.isAvailable:!t5(t.maxDomainLength)||(null==e?void 0:e.length)<=t.maxDomainLength))?void 0:i.scheme)?r:t[t.length-1].scheme:t}function e5(t,e,i){var r;let s,n=e8(t,i);if(!n)return;let{palette:a}=n;if(ey(a)&&(s=null!=(r=function(t,e){let i=e0[e];if(i&&t[i])return t[i];if(t[e])return t[e];let r=e1[e];return r?t[r]:void 0}(a,e.key))?r:e.default),!s)return;if(et(e.a)&&et(e.l)||!t3(s))return s;let l=new eq(s);if(t5(e.l)){let{r:t,g:i,b:r}=l.color,{h:s,s:n}=eV(t,i,r),a=eN(s,n,e.l),o=new eq(`rgb(${a.r}, ${a.g}, ${a.b})`);o.setOpacity(l.color.opacity),l=o}return t5(e.a)&&l.setOpacity(e.a),l.toRGBA()}let e4=(t,e)=>{if(e&&e7(t)){let i=e5(e,t);if(i)return i}return t};function e7(t){return t&&"palette"===t.type&&!!t.key}function e6(t){return!(!tY(t)||0===t.length)&&t.every(t=>t5(t.scheme))}function e9(t){return tY(t)?{dataScheme:t}:t}function e8(t,e){var i,r;let s,{type:n}=null!=e?e:{};if(!e||et(n))s=null==t?void 0:t.default;else{let a=eJ(e);s=null!=(r=null!=(i=null==t?void 0:t[`${n}_${a}`])?i:null==t?void 0:t[n])?r:null==t?void 0:t.default}return s}function it(t,...e){let i=-1,r=e.length;for(;++i<r;)t6(t,e[i],!0,!0);return t}var ie={},ii={};function ir(t){return Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function is(t){var e=Object.create(null),i=[];return t.forEach(function(t){for(var r in t)r in e||i.push(e[r]=r)}),i}function ia(t,e){var i=t+"",r=i.length;return r<e?Array(e-r+1).join(0)+i:i}function il(t){var e=RegExp('["'+t+"\n\r]"),i=t.charCodeAt(0);function r(t,e){var r,s=[],n=t.length,a=0,l=0,o=n<=0,h=!1;function u(){if(o)return ii;if(h)return h=!1,ie;var e,r,s=a;if(34===t.charCodeAt(s)){for(;a++<n&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=n?o=!0:10===(r=t.charCodeAt(a++))?h=!0:13===r&&(h=!0,10===t.charCodeAt(a)&&++a),t.slice(s+1,e-1).replace(/""/g,'"')}for(;a<n;){if(10===(r=t.charCodeAt(e=a++)))h=!0;else if(13===r)h=!0,10===t.charCodeAt(a)&&++a;else if(r!==i)continue;return t.slice(s,e)}return o=!0,t.slice(s,n)}for(10===t.charCodeAt(n-1)&&--n,13===t.charCodeAt(n-1)&&--n;(r=u())!==ii;){for(var d=[];r!==ie&&r!==ii;)d.push(r),r=u();e&&null==(d=e(d,l++))||s.push(d)}return s}function s(e,i){return e.map(function(e){return i.map(function(t){return a(e[t])}).join(t)})}function n(e){return e.map(a).join(t)}function a(t){var i,r,s,n,a,l;return null==t?"":t instanceof Date?(r=(i=t).getUTCHours(),s=i.getUTCMinutes(),n=i.getUTCSeconds(),a=i.getUTCMilliseconds(),isNaN(i)?"Invalid Date":((l=i.getUTCFullYear())<0?"-"+ia(-l,6):l>9999?"+"+ia(l,6):ia(l,4))+"-"+ia(i.getUTCMonth()+1,2)+"-"+ia(i.getUTCDate(),2)+(a?"T"+ia(r,2)+":"+ia(s,2)+":"+ia(n,2)+"."+ia(a,3)+"Z":n?"T"+ia(r,2)+":"+ia(s,2)+":"+ia(n,2)+"Z":s||r?"T"+ia(r,2)+":"+ia(s,2)+"Z":"")):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var i,s,n=r(t,function(t,r){var n;if(i)return i(t,r-1);s=t,i=e?(n=ir(t),function(i,r){return e(n(i),r,t)}):ir(t)});return n.columns=s||[],n},parseRows:r,format:function(e,i){return null==i&&(i=is(e)),[i.map(a).join(t)].concat(s(e,i)).join("\n")},formatBody:function(t,e){return null==e&&(e=is(t)),s(t,e).join("\n")},formatRows:function(t){return t.map(n).join("\n")},formatRow:n,formatValue:a}}var io=il(","),ih=io.parse;io.parseRows,io.format,io.formatBody,io.formatRows,io.formatRow,io.formatValue;var iu=il("	"),id=iu.parse;iu.parseRows,iu.format,iu.formatBody,iu.formatRows,iu.formatRow,iu.formatValue,(r_=rC||(rC={})).DSV="dsv",r_.TREE="tree",r_.GEO="geo",r_.BYTE="bytejson",r_.HEX="hex",r_.GRAPH="graph",r_.TABLE="table",r_.GEO_GRATICULE="geo-graticule";let ic=function(t,...e){return function(t,...e){t||(t={});let i=-1,r=e.length;for(;++i<r;){var s=t,n=e[i];if(ey(n)&&s!==n)for(let t in n)!function t(e,i,r){let s=i[r];if(void 0===s)e[r]=null;else if(ey(s))for(let i in ey(e[r])||(e[r]={}),s)t(e[r],s,i);else e[r]=s}(s,n,t)}return t}(t4(t),...e)},ip={delimiter:","};class ig{static registerChart(t,e){ig._charts[t]=e}static registerSeries(t,e){ig._series[t]=e}static registerComponent(t,e,i,r){ig._components[t]={cmp:e,alwaysCheck:i,createOrder:null!=r?r:0}}static registerGraphicComponent(t,e){ig._graphicComponents[t]=e}static createGraphicComponent(t,e,i){let r=ig._graphicComponents[t];return r?r(e,i):null}static registerMark(t,e){ig._marks[t]=e}static registerRegion(t,e){ig._regions[t]=e}static registerTransform(t,e){ig.transforms[t]=e}static registerGrammarTransform(t,e){ig._grammarTransforms[t]=e}static getGrammarTransform(t){return ig._grammarTransforms[t]}static registerLayout(t,e){ig._layout[t]=e}static registerAnimation(t,e){ig._animations[t]=e}static registerImplement(t,e){ig._implements[t]=e}static registerChartPlugin(t,e){ig._chartPlugin[t]=e}static registerComponentPlugin(t,e){ig._componentPlugin[t]=e}static createChart(t,e,i){return ig._charts[t]?new(0,ig._charts[t])(e,i):null}static getChart(t){return ig._charts[t]}static createChartSpecTransformer(t,e){if(!ig._charts[t])return null;let i=ig._charts[t];return new(0,i.transformerConstructor)(Object.assign({seriesType:i.seriesType},e))}static createRegion(t,e,i){return ig._regions[t]?new(0,ig._regions[t])(e,i):null}static createRegionSpecTransformer(t,e){return ig._regions[t]?new(0,ig._regions[t].transformerConstructor)(e):null}static createSeries(t,e,i){return ig._series[t]?new(0,ig._series[t])(e,i):null}static createSeriesSpecTransformer(t,e){return ig._series[t]?new(0,ig._series[t].transformerConstructor)(e):null}static createMark(t,e,i){if(!ig._marks[t])return null;let r=new(0,ig._marks[t])(e,i);return"group"===r.type&&r.setMarkConfig({interactive:!1}),r}static getComponents(){return Object.values(ig._components)}static getComponentInKey(t){return ig._components[t].cmp}static getLayout(){return Object.values(ig._layout)}static getLayoutInKey(t){return ig._layout[t]}static getSeries(){return Object.values(ig._series)}static getSeriesInType(t){return ig._series[t]}static getRegionInType(t){return ig._regions[t]}static getAnimationInKey(t){return ig._animations[t]}static getImplementInKey(t){return ig._implements[t]}static getSeriesMarkMap(t){return ig._series[t]?ig._series[t].mark:{}}static getSeriesBuiltInTheme(t){for(let e in ig._series){let i=ig._series[e];if(i&&i.builtInTheme&&i.builtInTheme[t])return i.builtInTheme[t]}return null}static getComponentBuiltInTheme(t){for(let e in ig._components){let i=ig._components[e];if(i&&i.cmp&&i.cmp.builtInTheme&&i.cmp.builtInTheme[t])return i.cmp.builtInTheme[t]}return null}static getChartPlugins(){return Object.values(ig._chartPlugin)}static getComponentPlugins(){return Object.values(ig._componentPlugin)}static getComponentPluginInType(t){return ig._componentPlugin[t]}static registerFormatter(t){this._formatter=t}static getFormatter(){return this._formatter}static createInteractionTrigger(t,e){let i=ig._interactionTriggers[t];return i?new i(e):null}static hasInteractionTrigger(t){return!!ig._interactionTriggers[t]}static getComposedEvent(t){return ig._composedEventMap[t]}}function im(t,...e){return it(iy(t),...e.map(iy))}function iy(t){var e,i;if(!t)return t;let r=((i=t.colorScheme)&&(i=Object.keys(i).reduce((t,e)=>{let r=i[e];return t[e]=e9(r),t},{})),i);return Object.assign({},t,{colorScheme:r,token:null!=(e=t.token)?e:{},series:Object.assign({},t.series)})}ig._charts={},ig._series={},ig._components={},ig._graphicComponents={},ig._marks={},ig._regions={},ig._animations={},ig._implements={},ig._chartPlugin={},ig._componentPlugin={},ig.transforms={fields:ei,filter:(t,e)=>{let{callback:i}=e;return i&&(t=t.filter(i)),t},fold:(t,e)=>{let{fields:i,key:r,value:s,retains:n}=e,a=[];for(let e=0;e<t.length;e++)i.forEach(l=>{let o={};if(o[r]=l,o[s]=t[e][l],n)n.forEach(i=>{o[i]=t[e][i]});else for(let r in t[e])-1===i.indexOf(r)&&(o[r]=t[e][r]);a.push(o)});return a}},ig.dataParser={csv:(t,e={},i)=>(i.type=rC.DSV,ih(t)),dsv:(t,e={},i)=>{i.type=rC.DSV;let{delimiter:r}=ic(ip,e);if(!t3(r))throw TypeError("Invalid delimiter: must be a string!");return il(r).parse(t)},tsv:(t,e={},i)=>(i.type=rC.DSV,id(t))},ig._layout={},ig._grammarTransforms={},ig._stageEventPlugins={},ig.registerStageEventPlugin=(t,e)=>{ig._stageEventPlugins[t]=e},ig.getStageEventPlugin=t=>ig._stageEventPlugins[t],ig._interactionTriggers={},ig.registerInteractionTrigger=(t,e)=>{ig._interactionTriggers[t]=e},ig._composedEventMap={},ig.registerComposedEvent=(t,e)=>{ig._composedEventMap[t]=e},ig._tooltipProcessors={},ig.registerTooltipProcessor=(t,e)=>{ig._tooltipProcessors[t]=e},ig.createTooltipProcessor=(t,e)=>{let i=ig._tooltipProcessors[t];return i?new i(e):null};let i_=t=>{let e={label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"}},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle"}}};return e[t?"transform3d":"transform"]={style:{fill:{type:"palette",key:"axisGridColor"}}},e},iv=i_(),ib={[ez.name]:ez},ix=ez.name,iS=new Map(Object.keys(ib).map(t=>[t,ib[t]])),ik=new Map,iA=new Map(Object.keys(ib).map(t=>[t,t===ix])),iM=(t,e)=>{if(!t)return;let i=iE(e);iS.set(t,i),iA.set(t,!0)},iw=(t=ix)=>(iA.has(t)&&!iA.get(t)&&iM(t,iS.get(t)),iS.get(t)),iT=t=>iS.delete(t)&&ik.delete(t)&&iA.delete(t),iC=t=>!!t3(t)&&iS.has(t),iE=t=>{var e;return im({},iw(null!=(e=t.type)?e:ix),t)};class iB{static registerInstance(t){iB.instances.set(t.id,t)}static unregisterInstance(t){iB.instances.delete(t.id)}static getInstance(t){return iB.instances.get(t)}static instanceExist(t){return iB.instances.has(t)}static forEach(t,e=[],i){let r=eo(e);return iB.instances.forEach((e,i,s)=>{r.includes(i)||t(e,i,s)},i)}}iB.instances=new Map;class iP{static registerTheme(t,e){iM(t,e)}static getTheme(t,e=!1){return iw(t)}static removeTheme(t){return iT(t)}static themeExist(t){return iC(t)}static getDefaultTheme(){return iP.themes.get(ix)}static setCurrentTheme(t){iP.themeExist(t)&&(iP._currentThemeName=t,iB.forEach(e=>null==e?void 0:e.setCurrentTheme(t)))}static getCurrentTheme(t=!1){return iP.getTheme(iP._currentThemeName,t)}static getCurrentThemeName(){return iP._currentThemeName}}function iO(t){return t3(t)?iP.themeExist(t)?iP.getTheme(t):{}:ey(t)?t:{}}iP.themes=iS,iP._currentThemeName=ix;class iI{getComposedEventMap(){return this._composedEventMap}constructor(t,e){this._composedEventMap=new Map,this._eventDispatcher=t,this._mode=e}on(t,e,i){let r="function"==typeof e?{query:null,callback:e}:{query:e,callback:i},s=ig.getComposedEvent(t);if(s){let e=new s(this._eventDispatcher,this._mode);e.register(t,r),this._composedEventMap.set(i,{eventType:t,event:e})}else this._eventDispatcher.register(t,r);return this}off(t,e,i){var r,s;let n=null!=i?i:e;if(ig.getComposedEvent(t))if(n)null==(r=this._composedEventMap.get(n))||r.event.unregister(),this._composedEventMap.delete(n);else for(let e of this._composedEventMap.entries())e[1].eventType===t&&(null==(s=this._composedEventMap.get(e[0]))||s.event.unregister(),this._composedEventMap.delete(e[0]));else if(n){let i={callback:n,query:null,filter:{nodeName:null,type:t,level:null,source:e.source,markName:null,filter:null,userId:null}};this._eventDispatcher.unregister(t,i)}else this._eventDispatcher.unregister(t);return this}emit(t,e,i){return this._eventDispatcher.dispatch(t,e,i),this}prevent(t,e){return this._eventDispatcher.prevent(t,e),this}allow(t){return this._eventDispatcher.allow(t),this}release(){this._eventDispatcher.clear(),this._composedEventMap.clear()}}(rv=rE||(rE={})).BEFORE_EVALUATE_DATA="beforeEvaluateData",rv.AFTER_EVALUATE_DATA="afterEvaluateData",rv.BEFORE_EVALUATE_SCALE="beforeEvaluateScale",rv.AFTER_EVALUATE_SCALE="afterEvaluateScale",rv.BEFORE_PARSE_VIEW="beforeParseView",rv.AFTER_PARSE_VIEW="afterParseView",rv.BEFORE_TRANSFORM="beforeTransform",rv.AFTER_TRANSFORM="afterTransform",rv.BEFORE_CREATE_VRENDER_STAGE="beforeCreateVRenderStage",rv.AFTER_CREATE_VRENDER_STAGE="afterCreateVRenderStage",rv.BEFORE_CREATE_VRENDER_LAYER="beforeCreateVRenderLayer",rv.AFTER_CREATE_VRENDER_LAYER="afterCreateVRenderLayer",rv.BEFORE_STAGE_RESIZE="beforeStageResize",rv.AFTER_STAGE_RESIZE="afterStageResize",rv.BEFORE_VRENDER_DRAW="beforeVRenderDraw",rv.AFTER_VRENDER_DRAW="afterVRenderDraw",rv.BEFORE_MARK_JOIN="beforeMarkJoin",rv.AFTER_MARK_JOIN="afterMarkJoin",rv.BEFORE_MARK_UPDATE="beforeMarkUpdate",rv.AFTER_MARK_UPDATE="afterMarkUpdate",rv.BEFORE_MARK_STATE="beforeMarkState",rv.AFTER_MARK_STATE="afterMarkState",rv.BEFORE_MARK_ENCODE="beforeMarkEncode",rv.AFTER_MARK_ENCODE="afterMarkEncode",rv.BEFORE_DO_LAYOUT="beforeDoLayout",rv.AFTER_DO_LAYOUT="afterDoLayout",rv.BEFORE_MARK_LAYOUT_END="beforeMarkLayoutEnd",rv.AFTER_MARK_LAYOUT_END="afterMarkLayoutEnd",rv.BEFORE_DO_RENDER="beforeDoRender",rv.AFTER_DO_RENDER="afterDoRender",rv.BEFORE_MARK_RENDER_END="beforeMarkRenderEnd",rv.AFTER_MARK_RENDER_END="afterMarkRenderEnd",rv.BEFORE_CREATE_VRENDER_MARK="beforeCreateVRenderMark",rv.AFTER_CREATE_VRENDER_MARK="afterCreateVRenderMark",rv.BEFORE_ADD_VRENDER_MARK="beforeAddVRenderMark",rv.AFTER_ADD_VRENDER_MARK="afterAddVRenderMark",rv.AFTER_VRENDER_NEXT_RENDER="afterVRenderNextRender",rv.BEFORE_ELEMENT_UPDATE_DATA="beforeElementUpdateData",rv.AFTER_ELEMENT_UPDATE_DATA="afterElementUpdateData",rv.BEFORE_ELEMENT_STATE="beforeElementState",rv.AFTER_ELEMENT_STATE="afterElementState",rv.BEFORE_ELEMENT_ENCODE="beforeElementEncode",rv.AFTER_ELEMENT_ENCODE="afterElementEncode",rv.ANIMATION_START="animationStart",rv.ANIMATION_END="animationEnd",rv.ELEMENT_ANIMATION_START="elementAnimationStart",rv.ELEMENT_ANIMATION_END="elementAnimationEnd",rv.ALL_ANIMATION_START="allAnimationStart",rv.ALL_ANIMATION_END="allAnimationEnd";let iR=["pointerdown","pointerup","pointerupoutside","pointertap","pointerover","pointermove","pointerenter","pointerleave","pointerout","mousedown","mouseup","mouseupoutside","rightdown","rightup","rightupoutside","click","dblclick","mousemove","mouseover","mouseout","mouseenter","mouseleave","wheel","touchstart","touchend","touchendoutside","touchmove","touchcancel","tap","dragstart","drag","dragenter","dragleave","dragover","dragend","drop","pan","panstart","panend","press","pressup","pressend","pinch","pinchstart","pinchend","swipe"];(rb=rB||(rB={})).initialized="initialized",rb.rendered="rendered",rb.renderFinished="renderFinished",rb.animationFinished="animationFinished",rb.regionSeriesDataFilterOver="regionSeriesDataFilterOver",rb.afterInitData="afterInitData",rb.afterInitEvent="afterInitEvent",rb.afterInitMark="afterInitMark",rb.rawDataUpdate="rawDataUpdate",rb.viewDataFilterOver="viewDataFilterOver",rb.viewDataUpdate="viewDataUpdate",rb.viewDataStatisticsUpdate="viewDataStatisticsUpdate",rb.markDeltaYUpdate="markDeltaYUpdate",rb.viewDataLabelUpdate="viewDataLabelUpdate",rb.scaleDomainUpdate="scaleDomainUpdate",rb.scaleUpdate="scaleUpdate",rb.dataZoomChange="dataZoomChange",rb.drill="drill",rb.layoutStart="layoutStart",rb.layoutEnd="layoutEnd",rb.layoutRectUpdate="layoutRectUpdate",rb.playerPlay="playerPlay",rb.playerPause="playerPause",rb.playerEnd="playerEnd",rb.playerChange="playerChange",rb.playerForward="playerForward",rb.playerBackward="playerBackward",rb.scrollBarChange="scrollBarChange",rb.brushStart="brushStart",rb.brushChange="brushChange",rb.brushEnd="brushEnd",rb.brushClear="brushClear",rb.brushActive="brushActive",rb.legendSelectedDataChange="legendSelectedDataChange",rb.legendFilter="legendFilter",rb.legendItemClick="legendItemClick",rb.legendItemHover="legendItemHover",rb.legendItemUnHover="legendItemUnHover",rb.tooltipShow="tooltipShow",rb.tooltipHide="tooltipHide",rb.tooltipRelease="tooltipRelease",rb.afterResize="afterResize",rb.afterRender="afterRender",rb.afterLayout="afterLayout",rb.afterMarkLayoutEnd="afterMarkLayoutEnd",(rx=rP||(rP={})).chart="chart",rx.window="window",rx.canvas="canvas",(rS=rO||(rO={})).vchart="vchart",rS.chart="chart",rS.model="model",rS.mark="mark";let iL=[rO.mark,rO.model,rO.chart,rO.vchart];class iD{constructor(){this._map=new Map,this._levelNodes=new Map,this._levelNodes.set(rO.vchart,[]),this._levelNodes.set(rO.chart,[]),this._levelNodes.set(rO.model,[]),this._levelNodes.set(rO.mark,[])}addHandler(t,e){var i;let r={level:e,handler:t};return null==(i=this._levelNodes.get(e))||i.push(r),this._map.set(t.callback,r),this}removeHandler(t){let e=this._map.get(t.callback);if(!e)return this;this._map.delete(t.callback);let i=this._levelNodes.get(e.level),r=null==i?void 0:i.findIndex(e=>e.handler.callback===t.callback);return void 0!==r&&r>=0&&(null==i||i.splice(r,1)),this}preventHandler(t){return t&&(t.prevented=!0),this}allowHandler(t){return t&&(t.prevented=!1),this}getHandlers(t){var e;return(null==(e=this._levelNodes.get(t))?void 0:e.map(t=>t.handler))||[]}getAllHandlers(){return Array.from(this._map.values()).map(t=>t.handler)||[]}getCount(){return this._map.size}release(){this._map.clear(),this._levelNodes.clear()}}let iF=(t,e,i)=>{let r=t3(e)?e.split("."):e;for(let e=0;e<r.length;e++)t=t?t[r[e]]:void 0;return void 0===t?i:t},iz=!1;try{iz="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame}catch(t){iz=!1}iz=!1;let ij=function(t,e,i){let r,s,n,a,l,o,h=0,u=!1,d=!1,c=!0,p=!e&&0!==e&&iz;if("function"!=typeof t)throw TypeError("Expected a function");function g(e){let i=r,n=s;return r=s=void 0,h=e,a=t.apply(n,i)}function f(t,e){return p?(cancelAnimationFrame(l),requestAnimationFrame(t)):setTimeout(t,e)}function m(t){let i=t-o;return void 0===o||i>=e||i<0||d&&t-h>=n}function y(){let t=Date.now();if(m(t))return _(t);l=f(y,function(t){let i=t-h,r=e-(t-o);return d?Math.min(r,n-i):r}(t))}function _(t){return l=void 0,c&&r?g(t):(r=s=void 0,a)}function v(...t){let i=Date.now(),n=m(i);if(r=t,s=this,o=i,n){if(void 0===l){var c;return h=c=o,l=f(y,e),u?g(c):a}if(d)return l=f(y,e),g(o)}return void 0===l&&(l=f(y,e)),a}return e=+e||0,ey(i)&&(u=!!i.leading,(d="maxWait"in i)&&(n=Math.max(ee(i.maxWait)?i.maxWait:0,e)),c="trailing"in i?!!i.trailing:c),v.cancel=function(){void 0!==l&&function(t){if(p)return cancelAnimationFrame(t);clearTimeout(t)}(l),h=0,r=o=s=l=void 0},v.flush=function(){return void 0===l?a:_(Date.now())},v.pending=function(){return void 0!==l},v},iH=function(t,e,i){let r=!0,s=!0;if("function"!=typeof t)throw TypeError("Expected a function");return ey(i)&&(r="leading"in i?!!i.leading:r,s="trailing"in i?!!i.trailing:s),ij(t,e,{leading:r,trailing:s,maxWait:e})},iN=t=>"line"===t||"area"===t,iV=t=>{if(!t||!t.context)return null;let{data:e,markType:i}=t.context;return"line"===i||"area"===i?e:null==e?void 0:e[0]},iW=(t,e)=>{let i=e;for(;(null==i?void 0:i.parent)&&i.parent!==t;)if((i=i.parent).context)return i;return null},iU=(t,e)=>{let i=t.getAttributes(!0),r={};return Object.keys(e).forEach(t=>{i[t]!==e[t]&&(r[t]=e[t])}),r},iG={cartesianAxis:"axis","cartesianAxis-band":"axis","cartesianAxis-linear":"axis","cartesianAxis-time":"axis",polarAxis:"axis","polarAxis-band":"axis","polarAxis-linear":"axis",discreteLegend:"legend",continuousLegend:"legend",colorLegend:"legend",sizeLegend:"legend"};class iZ{constructor(t,e){this._viewBubbles=new Map,this._windowBubbles=new Map,this._canvasBubbles=new Map,this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this._onDelegate=t=>{var e;let i=this.globalInstance.getChart(),r=t5(t.modelId)&&(null==i?void 0:i.getModelById(t.modelId))||void 0,s=t5(t.markId)&&(null==i?void 0:i.getMarkById(t.markId))||null,n=iF(t.event,"target"),a=t.datum;r&&"component"===r.modelType&&(a=null!=(e=r.getDatum(n))?e:a);let l={event:t.event,item:t.item,source:t.source,datum:a,chart:i,model:r,mark:null!=s?s:void 0,node:n};this.dispatch(t.type,l)},this._onDelegateInteractionEvent=t=>{let e=this.globalInstance.getChart(),i=t.event,r=null;i.graphics&&(r=i.graphics);let s={event:t.event,chart:e,graphics:r,datums:r&&r.map(t=>iV(t))};this.dispatch(t.type,s)},this.globalInstance=t,this._compiler=e}register(t,e){var i,r,s,n,a;this._parseQuery(e);let l=this.getEventBubble((null==(i=e.filter)?void 0:i.source)||rP.chart),o=this.getEventListeners((null==(r=e.filter)?void 0:r.source)||rP.chart);if(l.get(t)||l.set(t,new iD),l.get(t).addHandler(e,null==(s=e.filter)?void 0:s.level),this._isValidEvent(t)&&!o.has(t)){let i=this._onDelegate.bind(this);this._compiler.addEventListener(null==(n=e.filter)?void 0:n.source,t,i),o.set(t,i)}else if(this._isInteractionEvent(t)&&!o.has(t)){let i=this._onDelegateInteractionEvent.bind(this);this._compiler.addEventListener(null==(a=e.filter)?void 0:a.source,t,i),o.set(t,i)}return this}unregister(t,e){var i,r,s,n;let a=!1,l=this.getEventBubble((null==(i=null==e?void 0:e.filter)?void 0:i.source)||rP.chart),o=this.getEventListeners((null==(r=null==e?void 0:e.filter)?void 0:r.source)||rP.chart);if(e){let i=l.get(t);null==i||i.removeHandler(e),0===(null==i?void 0:i.getCount())&&(null==i||i.release(),l.delete(t),a=!0),(null==(s=null==e?void 0:e.wrappedCallback)?void 0:s.cancel)&&e.wrappedCallback.cancel()}else{let e=l.get(t);null==e||e.release(),l.delete(t),a=!0}if(a&&this._isValidEvent(t)){let i=o.get(t);this._compiler.removeEventListener((null==(n=null==e?void 0:e.filter)?void 0:n.source)||rP.chart,t,i),o.delete(t)}return this}dispatch(t,e,i){let r=this.getEventBubble(e.source||rP.chart).get(t);if(!r)return this;let s=!1;if(i){let n=r.getHandlers(i);s=this._invoke(n,t,e)}else{let i=0;for(;!s&&i<iL.length;)s=this._invoke(r.getHandlers(iL[i]),t,e),i++}return this}prevent(t,e){return["canvas","chart","window"].forEach(i=>{let r=this.getEventBubble(i).get(t);r&&r.getAllHandlers().forEach(t=>{e?iL.indexOf(t.filter.level)<iL.indexOf(e.level)&&t.callback!==e.handler&&r.preventHandler(t):r.preventHandler(t)})}),this}allow(t){return["canvas","chart","window"].forEach(e=>{let i=this.getEventBubble(e).get(t);i&&i.getAllHandlers().forEach(t=>i.allowHandler(t))}),this}clear(){[rP.chart,rP.window,rP.canvas].forEach(t=>{let e=this.getEventListeners(t);for(let i of e.entries())this._compiler.removeEventListener(t,i[0],i[1]);e.clear()}),[this._viewBubbles,this._windowBubbles,this._canvasBubbles].forEach(t=>{for(let e of t.values())e.release();t.clear()})}release(){this.clear(),this.globalInstance=null,this._compiler=null}_filter(t,e,i){var r,s,n;if(tK(t.filter)&&!t.filter(i)||t.nodeName&&iF(i,"node.name")!==t.nodeName||t.markName&&(null==(r=null==i?void 0:i.mark)?void 0:r.name)!==t.markName)return!1;let a=null==(s=i.model)?void 0:s.type;return iG[a]&&(a=iG[a]),(!t.type||a===t.type)&&!("mark"===t.level&&!t.type&&!(null==i?void 0:i.mark))&&!("model"===t.level&&!t.type&&!(null==i?void 0:i.model))&&(!t5(t.userId)||(null==(n=i.model)?void 0:n.userId)===t.userId)}_prepareParams(t,e){var i,r,s;if(t.markName&&e.mark){let t=null==(s=null==(r=(i=e.mark).getGraphics)?void 0:r.call(i))?void 0:s[0];return Object.assign(Object.assign({},e),{item:t,datum:iV(t)})}return Object.assign({},e)}_invoke(t,e,i){return t.map(t=>{var r,s,n;let a=t.filter;if(!t.prevented&&(!t.query||this._filter(a,e,i))){let e=(t.wrappedCallback||t.callback).call(null,this._prepareParams(a,i)),l=null!=e?e:null==(r=t.query)?void 0:r.consume;return l&&(null==(s=i.event)||s.stopPropagation(),null==(n=i.event)||n.preventDefault()),!!l}}).some(t=>!0===t)}_getQueryLevel(t){return t?t.level?t.level:t5(t.id)?rO.model:rO.vchart:rO.vchart}_parseQuery(t){var e;let i=t.query;(null==i?void 0:i.throttle)?t.wrappedCallback=iH(t.callback,i.throttle):(null==i?void 0:i.debounce)&&(t.wrappedCallback=ij(t.callback,i.debounce));let r=this._getQueryLevel(i),s=null,n=rP.chart,a=null,l=null,o=null;return(null==i?void 0:i.nodeName)&&(a=i.nodeName),(null==i?void 0:i.markName)&&(l=i.markName),(null==i?void 0:i.type)&&(r===rO.model||r===rO.mark)&&(s=i.type),(null==i?void 0:i.source)&&(n=i.source),t5(null==i?void 0:i.id)&&(o=null==i?void 0:i.id,r=rO.model),t.filter={level:r,markName:l,type:s,source:n,nodeName:a,userId:o,filter:null!=(e=null==i?void 0:i.filter)?e:null},t}getEventBubble(t){switch(t){case rP.chart:return this._viewBubbles;case rP.window:return this._windowBubbles;case rP.canvas:return this._canvasBubbles;default:return this._viewBubbles}}getEventListeners(t){switch(t){case rP.chart:return this._viewListeners;case rP.window:return this._windowListeners;case rP.canvas:return this._canvasListeners;default:return this._viewListeners}}_isValidEvent(t){return iR.includes(t)||Object.values(rE).includes(t)}_isInteractionEvent(t){let e;return t&&(e=t.split(":")[0])&&ig.hasInteractionTrigger(e)}}function i$(t){return t}function iY(t,e){t&&iK.hasOwnProperty(t.type)&&iK[t.type](t,e)}var iX={Feature:function(t,e){iY(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,r=-1,s=i.length;++r<s;)iY(i[r].geometry,e)}},iK={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,r=-1,s=i.length;++r<s;)t=i[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){iq(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,r=-1,s=i.length;++r<s;)iq(i[r],e,0)},Polygon:function(t,e){iQ(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,r=-1,s=i.length;++r<s;)iQ(i[r],e)},GeometryCollection:function(t,e){for(var i=t.geometries,r=-1,s=i.length;++r<s;)iY(i[r],e)}};function iq(t,e,i){var r,s=-1,n=t.length-i;for(e.lineStart();++s<n;)r=t[s],e.point(r[0],r[1],r[2]);e.lineEnd()}function iQ(t,e){var i=-1,r=t.length;for(e.polygonStart();++i<r;)iq(t[i],e,1);e.polygonEnd()}function iJ(t,e){t&&iX.hasOwnProperty(t.type)?iX[t.type](t,e):iY(t,e)}function i0(){this.reset()}i0.prototype={constructor:i0,reset:function(){this.s=this.t=0},add:function(t){i2(i1,t,this.t),i2(this,i1.s,this.s),this.s?this.t+=i1.t:this.s=i1.t},valueOf:function(){return this.s}};var i1=new i0;function i2(t,e,i){var r=t.s=e+i,s=r-e;t.t=e-(r-s)+(i-s)}var i3=Math.PI,i5=i3/2,i4=i3/4,i7=2*i3,i6=180/i3,i9=i3/180,i8=Math.abs,rt=Math.atan,re=Math.atan2,ri=Math.cos,rr=Math.exp,rs=Math.log,rn=Math.pow,ra=Math.sin,rl=Math.sign||function(t){return t>0?1:t<0?-1:0},ro=Math.sqrt,rh=Math.tan;function ru(t){return t>1?0:t<-1?i3:Math.acos(t)}function rd(t){return t>1?i5:t<-1?-i5:Math.asin(t)}function rc(){}var rp,rg,rf,rm,ry,r_,rv,rb,rx,rS,rk,rA,rM,rw,rT,rC,rE,rB,rP,rO,rI,rR,rL,rD,rF=new i0,rz=new i0,rj={point:rc,lineStart:rc,lineEnd:rc,polygonStart:function(){rj.lineStart=rH,rj.lineEnd=rW},polygonEnd:function(){rj.lineStart=rj.lineEnd=rj.point=rc,rF.add(i8(rz)),rz.reset()},result:function(){var t=rF/2;return rF.reset(),t}};function rH(){rj.point=rN}function rN(t,e){rj.point=rV,rI=rL=t,rR=rD=e}function rV(t,e){rz.add(rD*t-rL*e),rL=t,rD=e}function rW(){rV(rI,rR)}var rU=1/0,rG=1/0,rZ=-1/0,r$=rZ;let rY={point:function(t,e){t<rU&&(rU=t),t>rZ&&(rZ=t),e<rG&&(rG=e),e>r$&&(r$=e)},lineStart:rc,lineEnd:rc,polygonStart:rc,polygonEnd:rc,result:function(){var t=[[rU,rG],[rZ,r$]];return rZ=r$=-(rG=rU=1/0),t}};var rX,rK,rq,rQ,rJ=0,r0=0,r1=0,r2=0,r3=0,r5=0,r4=0,r7=0,r6=0,r9={point:r8,lineStart:st,lineEnd:sr,polygonStart:function(){r9.lineStart=ss,r9.lineEnd=sn},polygonEnd:function(){r9.point=r8,r9.lineStart=st,r9.lineEnd=sr},result:function(){var t=r6?[r4/r6,r7/r6]:r5?[r2/r5,r3/r5]:r1?[rJ/r1,r0/r1]:[NaN,NaN];return rJ=r0=r1=r2=r3=r5=r4=r7=r6=0,t}};function r8(t,e){rJ+=t,r0+=e,++r1}function st(){r9.point=se}function se(t,e){r9.point=si,r8(rq=t,rQ=e)}function si(t,e){var i=t-rq,r=e-rQ,s=ro(i*i+r*r);r2+=s*(rq+t)/2,r3+=s*(rQ+e)/2,r5+=s,r8(rq=t,rQ=e)}function sr(){r9.point=r8}function ss(){r9.point=sa}function sn(){sl(rX,rK)}function sa(t,e){r9.point=sl,r8(rX=rq=t,rK=rQ=e)}function sl(t,e){var i=t-rq,r=e-rQ,s=ro(i*i+r*r);r2+=s*(rq+t)/2,r3+=s*(rQ+e)/2,r5+=s,r4+=(s=rQ*t-rq*e)*(rq+t),r7+=s*(rQ+e),r6+=3*s,r8(rq=t,rQ=e)}function so(t){this._context=t}so.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,i7)}},result:rc};var sh,su,sd,sc,sp,sg=new i0,sf={point:rc,lineStart:function(){sf.point=sm},lineEnd:function(){sh&&sy(su,sd),sf.point=rc},polygonStart:function(){sh=!0},polygonEnd:function(){sh=null},result:function(){var t=+sg;return sg.reset(),t}};function sm(t,e){sf.point=sy,su=sc=t,sd=sp=e}function sy(t,e){sc-=t,sp-=e,sg.add(ro(sc*sc+sp*sp)),sc=t,sp=e}function s_(){this._string=[]}function sv(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function sb(t,e){var i,r,s=4.5;function n(t){return t&&("function"==typeof s&&r.pointRadius(+s.apply(this,arguments)),iJ(t,i(r))),r.result()}return n.area=function(t){return iJ(t,i(rj)),rj.result()},n.measure=function(t){return iJ(t,i(sf)),sf.result()},n.bounds=function(t){return iJ(t,i(rY)),rY.result()},n.centroid=function(t){return iJ(t,i(r9)),r9.result()},n.projection=function(e){return arguments.length?(i=null==e?(t=null,i$):(t=e).stream,n):t},n.context=function(t){return arguments.length?(r=null==t?(e=null,new s_):new so(e=t),"function"!=typeof s&&r.pointRadius(s),n):e},n.pointRadius=function(t){return arguments.length?(s="function"==typeof t?t:(r.pointRadius(+t),+t),n):s},n.projection(t).context(e)}function sx(t){var e={type:"Feature"};return Object.keys(t).forEach(function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=t[i]}}),e.properties=function t(e){var i={};return e&&Object.keys(e).forEach(function(r){var s=e[r];"object"==typeof s?null===s?i[r]=null:Array.isArray(s)?i[r]=s.map(function(t){return t}):i[r]=t(s):i[r]=s}),i}(t.properties),e.geometry=sS(t.geometry),e}function sS(t){var e={type:t.type};return(t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type)?e.geometries=t.geometries.map(function(t){return sS(t)}):e.coordinates=function t(e){return"object"!=typeof e[0]?e.slice():e.map(function(e){return t(e)})}(t.coordinates),e}s_.prototype={_radius:4.5,_circle:sv(4.5),pointRadius:function(t){return(t*=1)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=sv(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(!this._string.length)return null;var t=this._string.join("");return this._string=[],t}};let sk=function(t){if(!t)throw Error("geojson is required");switch(t.type){case"Feature":return sx(t);case"FeatureCollection":var e,i;return i={type:"FeatureCollection"},Object.keys(e=t).forEach(function(t){switch(t){case"type":case"features":return;default:i[t]=e[t]}}),i.features=e.features.map(function(t){return sx(t)}),i;case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return sS(t);default:throw Error("unknown GeoJSON type")}};function sA(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function sM(t){for(var e,i,r=sA(t),s=0,n=1;n<r.length;)e=i||r[0],s+=((i=r[n])[0]-e[0])*(i[1]+e[1]),n++;return s>0}function sw(t,e,i){void 0===i&&(i={});var r={type:"Feature"};return(0===i.id||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties=e||{},r.geometry=t,r}function sT(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function sC(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function sE(t,e){var i,r,s,n,a,l,o,h,u,d,c=0,p="FeatureCollection"===t.type,g="Feature"===t.type,f=p?t.features.length:1;for(i=0;i<f;i++){for(s=0,l=p?t.features[i].geometry:g?t.geometry:t,h=p?t.features[i].properties:g?t.properties:{},u=p?t.features[i].bbox:g?t.bbox:void 0,d=p?t.features[i].id:g?t.id:void 0,a=(o=!!l&&"GeometryCollection"===l.type)?l.geometries.length:1;s<a;s++){if(null===(n=o?l.geometries[s]:l)){if(!1===e(null,c,h,u,d))return!1;continue}switch(n.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(n,c,h,u,d))return!1;break;case"GeometryCollection":for(r=0;r<n.geometries.length;r++)if(!1===e(n.geometries[r],c,h,u,d))return!1;break;default:throw Error("Unknown Geometry Type")}}c++}}function sB(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return sE(t,function(t){sB(t,e)}),t;case"LineString":return sP(sA(t),e),t;case"Polygon":return sO(sA(t),e),t;case"MultiLineString":return sA(t).forEach(function(t){sP(t,e)}),t;case"MultiPolygon":return sA(t).forEach(function(t){sO(t,e)}),t;case"Point":case"MultiPoint":return t}}function sP(t,e){sM(t)===e&&t.reverse()}function sO(t,e){sM(t[0])!==e&&t[0].reverse();for(var i=1;i<t.length;i++)sM(t[i])===e&&t[i].reverse()}let sI=function(t,e){if((e=e||{}).constructor!==Object)throw Error("options is invalid");var i=e.reverse||!1,r=e.mutate||!1;if(!t)throw Error("<geojson> is required");if("boolean"!=typeof i)throw Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw Error("<mutate> must be a boolean");!1===r&&(t=sk(t));var s=[];switch(t.type){case"GeometryCollection":return sE(t,function(t){sB(t,i)}),t;case"FeatureCollection":return sC(t,function(t){sC(sB(t,i),function(t){s.push(t)})}),sT(s)}return sB(t,i)},sR=function(t){if(!t)throw Error("geojson is required");var e,i=[];return e=function(t){i.push(t)},sE(t,function(t,i,r,s,n){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":if(!1===e(sw(t,r,{bbox:s,id:n}),i,0))return!1;return}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var o=0;o<t.coordinates.length;o++)if(!1===e(sw({type:a,coordinates:t.coordinates[o]},r),i,o))return!1}),sT(i)},sL=sb(),sD={centroid:!1,name:!1,bbox:!1,rewind:!1},sF=t=>{if(t.geometry.type.startsWith("Multi")){let e=sR(t).features[0];return Object.assign(Object.assign({},e),e.properties)}return Object.assign(Object.assign({},t),t.properties)},sz=t=>{let e=[];return t.forEach(t=>{"FeatureCollection"===t.type?t.features.forEach(t=>{e.push(sF(t))}):e.push(sF(t))}),e},sj=(t,e={},i)=>{i.type=rC.GEO;let{centroid:r,name:s,bbox:n,rewind:a}=ic(sD,e);if(Array.isArray(t))return sz(t);let l=t.features;return a&&(l=sI(t,{reverse:!ey(a)||a.reverse}).features),l.forEach(t=>{if(r){let e=sL.centroid(t);t.centroidX=e[0],t.centroidY=e[1]}if(s&&(t.name=t.properties.name),n){let e=sL.bounds(t);t.bbox=e}}),t.features=l,t};function sH(t){return t}function sN(t,e){var i=e.id,r=e.bbox,s=null==e.properties?{}:e.properties,n=function(t,e){var i=function(t){if(null==t)return sH;var e,i,r=t.scale[0],s=t.scale[1],n=t.translate[0],a=t.translate[1];return function(t,l){l||(e=i=0);var o=2,h=t.length,u=Array(h);for(u[0]=(e+=t[0])*r+n,u[1]=(i+=t[1])*s+a;o<h;)u[o]=t[o],++o;return u}}(t.transform),r=t.arcs;function s(t){return i(t)}function n(t){for(var e=[],s=0,n=t.length;s<n;++s)!function(t,e){e.length&&e.pop();for(var s=r[t<0?~t:t],n=0,a=s.length;n<a;++n)e.push(i(s[n],n));t<0&&function(t,e){for(var i,r=t.length,s=r-e;s<--r;)i=t[s],t[s++]=t[r],t[r]=i}(e,a)}(t[s],e);return e.length<2&&e.push(e[0]),e}function a(t){for(var e=n(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(a)}return function t(e){var i,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":i=s(e.coordinates);break;case"MultiPoint":i=e.coordinates.map(s);break;case"LineString":i=n(e.arcs);break;case"MultiLineString":i=e.arcs.map(n);break;case"Polygon":i=l(e.arcs);break;case"MultiPolygon":i=e.arcs.map(l);break;default:return null}return{type:r,coordinates:i}}(e)}(t,e);return null==i&&null==r?{type:"Feature",properties:s,geometry:n}:null==r?{type:"Feature",id:i,properties:s,geometry:n}:{type:"Feature",id:i,bbox:r,properties:s,geometry:n}}let sV={},sW=(t,e,i)=>{var r;i.type=rC.GEO;let s=ic(sD,sV,e),{object:n}=s;if(!t3(n))throw TypeError("Invalid object: must be a string!");return sj(("string"==typeof(r=t.objects[n])&&(r=t.objects[r]),"GeometryCollection"===r.type?{type:"FeatureCollection",features:r.geometries.map(function(e){return sN(t,e)})}:sN(t,r)),s,i)};var sU=i(30939),sG=i.n(sU);let sZ={tolerance:.01},s$=(t,e)=>{let{tolerance:i}=ic(sZ,e);return sG()(t,i)};function sY(t,e,i){t.getTransform(e)||t.registerTransform(e,i)}function sX(t,e,i){t.getParser(e)||t.registerParser(e,i)}let sK=new Map;function sq(t,e,i={type:"geojson",centroid:!0}){sK.has(t)&&eI(`map type of '${t}' already exists, will be overwritten.`),r||(sX(r=new tZ,"geojson",sj),sX(r,"topojson",sW),sY(r,"simplify",s$));let s=new er(r),n=t8({},{centroid:!0,simplify:!1},i);"topojson"===i.type?s.parse(e,{type:"topojson",options:n}):s.parse(e,{type:"geojson",options:n});let{simplify:a}=i;!0===a?s.transform({type:"simplify"}):ey(a)&&s.transform({type:"simplify",options:a}),sK.set(t,s)}function sQ(t){sK.has(t)?sK.delete(t):eI(`map type of '${t}' does not exists.`)}function sJ(t,e=!1){let i=e;return t.latestData instanceof er&&(i=!1),i?t4(t.latestData):t.latestData&&t.latestData.slice()}let s0=(t,e)=>0===t.length?[]:1===t.length?sJ(t[0],null==e?void 0:e.deep):t.map(t=>sJ(t,null==e?void 0:e.deep));function s1(t,e,i){sY(e=e instanceof tZ?e:t.dataSet,"copyDataView",s0);let r=new er(e,i);return r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView",level:L.copyDataView}),r}function s2(t,e,i=[]){let r;if(t instanceof er)return t;let{id:s,values:n=[],fromDataIndex:a,fromDataId:l,transforms:o=[]}=t,h=t.parser?t4(t.parser):{clone:!0},u=t4(t.fields);h.clone=!1!==h.clone;let d=i.find(t=>t.name===s);if(d)r=d;else{let t={name:s};if(u&&(t.fields=u),r=new er(e,t),"string"==typeof l){let t=i.find(t=>t.name===l);if(!t)return eI(`no data matches fromDataId ${l}`),null;r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView"})}else if("number"==typeof a){let t=i[a];if(!t)return eI(`no data matches fromDataIndex ${a}`),null;r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView"})}else Array.isArray(n)?r.parse(n,h):t3(n)&&(!h||["csv","dsv","tsv"].includes(h.type))?r.parse(n,null!=h?h:{type:"csv"}):(r.parse([]),eI("values should be array"));o&&o.length&&o.forEach(t=>{e.getTransform(t.type)&&r.transform(t)})}return r}function s3(t,e,i){t&&(e.fields&&t.setFields(e.fields,i),t.parseNewData(e.values,e.parser))}(a=L||(L={}))[a.copyDataView=-10]="copyDataView",a[a.treemapFilter=-8]="treemapFilter",a[a.treemapFlatten=-7]="treemapFlatten",a[a.dotObjFlat=-7]="dotObjFlat",a[a.linkDotInfo=-7]="linkDotInfo",a[a.sankeyLayout=-7]="sankeyLayout",a[a.dataZoomFilter=-6]="dataZoomFilter",a[a.legendFilter=-5]="legendFilter",(l=D||(D={})).appear="appear",l.disappear="disappear",l.enter="enter",l.update="update",l.state="state",l.exit="exit",l.normal="normal",l.none="none",(o=F||(F={})).before="before",o.layouting="layouting",o.reevaluate="reevaluate",o.after="after";var s5=i(3607),s4=i(53068),s7=i(42915);let s6="__VCHART",s9=500,s8=500,nt=`${s6}_MEASURE_CANVAS_ID`,ne=`${s6}_DEFAULT_DATA_INDEX`,ni=`${s6}_DEFAULT_DATA_KEY`,nr=`${s6}_DEFAULT_DATA_SERIES_FIELD`,ns=`${s6}_DEFAULT_SERIES_STYLE_NAME`,nn=`${s6}_STACK_KEY`,na=`${s6}_STACK_START`,nl=`${s6}_STACK_END`,no=`${s6}_STACK_START_PERCENT`,nh=`${s6}_STACK_END_PERCENT`,nu=`${s6}_STACK_START_OffsetSilhouette`,nd=`${s6}_STACK_END_OffsetSilhouette`,nc=`${s6}_STACK_TOTAL`,np=`${s6}_STACK_TOTAL_PERCENT`,ng=`${s6}_STACK_TOTAL_TOP`,nf=`${s6}_STACK_TOTAL_BOTTOM`,nm=`${s6}_MOSAIC_VALUE_START_PERCENT`,ny=`${s6}_MOSAIC_VALUE_END_PERCENT`,n_=`${s6}_MOSAIC_CAT_START_PERCENT`,nv=`${s6}_MOSAIC_CAT_END_PERCENT`,nb=`${s6}_SEGMENT_START`,nx=`${s6}_SEGMENT_END`,nS=`${s6}_KEY`,nk=["line","area","trail"];function nA(t,e,i){let r=new Map;if(!t||0===t.length)return{keys:[],data:r};if(!e)return r.set(nS,i?t.slice().sort(i):t.slice()),{keys:[nS],data:r};if(1===t.length){let i=e(t[0],0);return r.set(i,[t[0]]),{keys:[i],data:r}}let s=new Set;return t.forEach((t,i)=>{var n;let a=e(t,i),l=null!=(n=r.get(a))?n:[];l.push(t),r.set(a,l),s.add(a)}),i&&s.forEach(t=>{r.get(t).sort(i)}),{keys:Array.from(s),data:r}}let nM=(t,e,i={})=>(t&&Object.keys(t).forEach(r=>{i[r]=t[r](e)}),i);function nw(t,e,i,r,s){let n=t=>{if(!r&&t&&(!i||i(t))){let i=e.call(null,t);if(s&&i)return i}if("group"===t.type){let e=t.getMarks();if(e)for(let t=0;t<e.length;t++){let i=n(e[t]);if(i&&s)return i}}if(r&&t&&(!i||i(t))){let i=e.call(null,t);if(i&&s)return i}};return n(t)}function nT(t){let e=[];return t.forEach(t=>{nw(t,t=>{"group"!==t.type&&"component"!==t.type&&e.push(t)})}),e}function nC(t,e,i,r){let s=nA(t,t=>i(t)),n=nA(e,t=>r(t)),a=t,l=e,o=[];return n.keys.forEach(t=>{if(!et(t)){let e=s.data.get(t),i=n.data.get(t);e&&i&&(o.push({prev:e,next:i}),a=a.filter(t=>!e.includes(t)),l=l.filter(t=>!i.includes(t)))}}),{prev:a,next:l,update:o}}class nE{getRootGroup(){return this._rootGroup}constructor(t,e){this._count=0,this._rootMarks=[],this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.isInited=!1,this._released=!1,this._compileChart=null,this.handleLayoutEnd=()=>{var t,e;null==(e=null==(t=this._compileChart)?void 0:t.getEvent())||e.emit(rB.afterMarkLayoutEnd,{chart:this._compileChart})},this.handleStageRender=()=>{var t,e;null==(e=null==(t=this._compileChart)?void 0:t.getEvent())||e.emit(rB.afterRender,{chart:this._compileChart})},this._handleAfterNextRender=()=>{var t,e;this._stage&&!this._option.disableDirtyBounds&&this._stage.enableDirtyBounds(),this._compileChart&&(null==(t=this._compileChart.getEvent())||t.emit(rB.renderFinished,{chart:this._compileChart,vchart:null==(e=this._compileChart.getOption())?void 0:e.globalInstance}))},this.handleProgressiveFrame=()=>{this._progressiveMarks.length&&this._progressiveMarks.forEach(t=>{t.isDoingProgressive()&&t.renderProgressive()}),this.doPreProgressive()},this._container=t,this._option=e}getChart(){return this._compileChart}getCanvas(){var t;return null==(t=this._stage)?void 0:t.window.getNativeHandler().nativeCanvas}getStage(){return this._stage}initView(){var t,e,i,r;if(this._released||(this.isInited=!0,this._stage))return;let{autoRefreshDpr:s,dpr:n,mode:a,modeParams:l,gestureConfig:o,interactive:h,clickInterval:u,autoPreventDefault:d,background:c}=this._option;es.rF.setEnv(function(t){switch(t){case rk["desktop-browser"]:case rk["mobile-browser"]:break;case rk.node:case rk.worker:return"node";case rk.miniApp:case rk["desktop-miniApp"]:return"feishu";case rk.lynx:return"lynx";case rk.wx:return"wx";case rk.tt:return"tt";case rk.harmony:return"harmony"}return"browser"}(a),null!=l?l:{}),this._stage=null!=(t=this._option.stage)?t:new s5.H(Object.assign({background:c,width:this._width,height:this._height,container:null!=(e=this._container.dom)?e:null,canvas:null!=(i=this._container.canvas)?i:null,dpr:n,viewBox:this._option.viewBox,canvasControled:this._option.canvasControled,beforeRender:t=>{var e,i,r;null==(e=this._compileChart)||e.onBeforeRender(),null==(r=(i=this._option).beforeRender)||r.call(i,t)},afterRender:this._option.afterRender,disableDirtyBounds:!0,autoRender:!0,ticker:this._option.ticker,pluginList:this._option.pluginList,enableHtmlAttribute:this._option.enableHtmlAttribute,optimize:this._option.optimize,supportsTouchEvents:this._option.supportsTouchEvents,supportsPointerEvents:this._option.supportsPointerEvents,event:{clickInterval:u,autoPreventDefault:d},ReactDOM:this._option.ReactDOM,autoRefresh:t5(s)?s:!t5(n)},null!=(r=this._option.renderHooks)?r:{})),this._stage.enableIncrementalAutoRender(),this._stage.setTheme({symbol:{shape:"circle",size:8},text:{fontSize:14,fill:"#000000"}});let p=(0,s4.sS)({x:0,y:0,width:this._width,height:this._height});p.name="root",this._stage.defaultLayer.appendChild(p),this._rootGroup=p;let g=(t5(o)?o:eB(a))&&!1!==h&&ig.getStageEventPlugin("gesture");g&&(this._gestureController=new g(this._stage,ey(o)?o:{})),this._setCanvasStyle(),this.getStage().hooks.afterRender.tap("chart-event",this.handleStageRender),!1!==h&&this._viewListeners.forEach(t=>{})}getLayoutState(){return this._layoutState}updateLayoutTag(){this._layoutState=F.before}_setCanvasStyle(){if(this._stage&&this._container.dom&&!t3(this._container.dom)){this._container.dom.style.display="block",this._container.dom.style.position="relative";let t=this.getCanvas();t&&(t.style.display="block")}}compile(t,e){if(this._released)return;let{chart:i}=t;this._compileChart=i,this.initView(),this._stage&&("render"!==(null==e?void 0:e.actionSource)&&this._cachedMarks&&(this.reuseOrMorphing(e.morphConfig),this._cachedMarks=null),i.compile(),i.afterCompile())}clearNextRender(){return!!this._nextRafId&&(es.rF.getSpecifiedCancelAnimationFrame(10)(this._nextRafId),this._nextRafId=null,!0)}clear(t){let{chart:e}=t;this.clearNextRender(),e.clear()}renderNextTick(t){this._released||(this._nextRafId&&this.clearNextRender(),this._nextRafId=es.rF.getSpecifiedRequestAnimationFrame(10)(()=>{this._nextRafId=null,this.render(t)}))}_commitedAll(){return this._rootMarks.some(t=>nw(t,t=>t.commit()))}_hasCommitedMark(){return this._rootMarks.some(t=>nw(t,t=>t.isCommited(),null,null,!0))}_doRender(t){this._stage&&(this._rootMarks.forEach(t=>{nw(t,t=>{t.needClear&&(this._progressiveMarks||t.runAnimation(),t.clearExitGraphics(),t.needClear=!1)},null,!0)}),this._stage.disableDirtyBounds(),this._stage.afterNextRender(this._handleAfterNextRender),t&&this._stage.render())}renderMarks(){var t;this._hasCommitedMark()&&(eO(`--- start of renderMarks(${this._count}) ---`),this.clearProgressive(),this._rootMarks.forEach(t=>{t.render()}),this._layoutState===F.before&&(this._layoutState=F.layouting,null==(t=this._compileChart)||t.onLayout(),this._layoutState=F.reevaluate,this._hasCommitedMark()&&this._rootMarks.forEach(t=>{t.render()}),this.handleLayoutEnd()),this.findProgressiveMarks(),this._doRender(!0),this.doPreProgressive(),eO(`--- start of renderMarks(${this._count}) ---`),this._count++)}reuseOrMorphing(t={}){let{reuse:e=!0,morph:i=!0,morphAll:r=!1,animation:s={},enableExitAnimation:n=!1}=t,a=nT(this._rootMarks),{update:l,exit:o}=function(t,e,i){let r={enter:[],exit:[],update:[]},s=[],n=[];t.forEach(t=>{i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?s.push(t):r.exit.push({prev:[t]})}),e.forEach(t=>{i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?n.push(t):r.enter.push({next:[t]})});let a=nC(s,n,t=>t.getMarkConfig().morphKey,t=>t.getMarkConfig().morphKey);s=a.prev,n=a.next,r.update=r.update.concat(a.update);let l=nC(s,n,t=>`${t.getUserId()}`,t=>`${t.getUserId()}`);s=l.prev,n=l.next,r.update=r.update.concat(l.update);let o=nA(s,t=>{var e,i;return null==(i=null==(e=t.group)?void 0:e.id)?void 0:i.call(e)}),h=nA(n,t=>{var e,i;return null==(i=null==(e=t.group)?void 0:e.id)?void 0:i.call(e)});return Object.keys(h).forEach(t=>{let e=o.data.get(t),i=h.data.get(t);if(e&&i){for(let t=0;t<Math.max(e.length,i.length);t+=1){let s=e[t],n=i[t];s&&n?r.update.push({prev:[s],next:[n]}):s?r.exit.push({prev:[s]}):n&&r.enter.push({next:[n]})}s=s.filter(t=>!e.includes(t)),n=n.filter(t=>!i.includes(t))}}),s.forEach(t=>r.exit.push({prev:[t]})),n.forEach(t=>r.enter.push({next:[t]})),r}(this._cachedMarks,a,{morph:i,morphAll:r,reuse:e});l.forEach(({prev:t,next:i})=>{if(e&&1===t.length&&1===i.length&&t[0].type===i[0].type)i[0].reuse(t[0]);else{let e=t.filter(t=>t.getMarkConfig().morph)[0];e&&i.forEach(t=>{t.getMarkConfig().morph&&t.prepareMorph(e)})}}),o.forEach(({prev:t})=>{t.forEach(t=>{t.removeProduct()})})}render(t){if(this._released||(this.clearNextRender(),this.initView(),!this._stage))return;let{width:e,height:i}=this._rootGroup.attribute;this._width===e&&this._height===i||this._rootGroup.setAttributes({width:this._width,height:this._height}),this.renderMarks(),this.clearNextRender()&&this.renderMarks()}updateViewBox(t,e=!0){if(!this._stage)return;let i=this._stage.viewBox;!t||i&&i.x1===t.x1&&i.y1===t.y1&&i.x2===t.x2&&i.y2===t.y2||this._stage.setViewBox(t,e)}resize(t,e,i=!0){if(!this._stage)return;let r=this._width!==t||this._height!==e;this._width=t,this._height=e,r&&(this._stage.resize(t,e),this._commitedAll(),i&&this.render({morph:!1}))}setBackground(t){this._stage&&(this._stage.background=t)}setSize(t,e){this._width=t,this._height=e,this._stage}setViewBox(t,e=!0){this.updateViewBox(t,e)}addEventListener(t,e,i){var r,s;if(!1!==this._option.interactive){if(t===rP.chart){let s=this.getRootGroup(),n=(function(r){var n;let a=r.target,l=null;a&&(l=t5(a.context)?a:iW(s,a));let o=null!=(n=null==l?void 0:l.context)?n:{},h=t5(o.markId)?o.markId:null,u=t5(o.modelId)?o.modelId:null,d=t5(o.modelUserId)?o.modelUserId:null,c=t5(o.markUserId)?o.markUserId:null,p={event:r,type:e,source:t,item:l,datum:iV(l),markId:h,modelId:u,markUserId:c,modelUserId:d};i.call(null,p)}).bind(this);this._viewListeners.set(i,{type:e,callback:n}),null==(r=this._stage)||r.addEventListener(e,n)}else if(t===rP.window){let r=(function(r){i.call(null,{event:r,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null})}).bind(this);this._windowListeners.set(i,{type:e,callback:r});let s=this._getGlobalThis();null==s||s.addEventListener(e,r)}else if(t===rP.canvas){let r=(function(r){i.call(null,{event:r,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null})}).bind(this);this._canvasListeners.set(i,{type:e,callback:r});let n=null==(s=this.getStage())?void 0:s.window;null==n||n.addEventListener(e,r)}}}removeEventListener(t,e,i){var r,s,n,a,l;if(!1!==this._option.interactive){if(t===rP.chart){let t=null==(r=this._viewListeners.get(i))?void 0:r.callback;t&&(null==(s=this._stage)||s.removeEventListener(e,t)),this._viewListeners.delete(i)}else if(t===rP.window){let t=this._getGlobalThis(),r=null==(n=this._windowListeners.get(i))?void 0:n.callback;r&&(null==t||t.removeEventListener(e,r)),this._windowListeners.delete(i)}else if(t===rP.canvas){let t=null==(a=this.getStage())?void 0:a.window,r=null==(l=this._canvasListeners.get(i))?void 0:l.callback;t&&r&&(null==t||t.removeEventListener(e,r)),this._canvasListeners.delete(i)}}}releaseEvent(){let t=this.getStage();t&&t.hooks.afterRender.unTap("chart-event",this.handleStageRender),this._viewListeners.clear(),this._windowListeners.clear(),this._canvasListeners.clear()}release(){var t;this.clearNextRender(),this.releaseEvent(),this._option=this._container=null,this.releaseGrammar(!0),this._stage!==(null==(t=this._option)?void 0:t.stage)&&this._stage.release(),this._stage=null,this.isInited=!1,this._compileChart=null,this._released=!0}releaseGrammar(t=!1){t?this._rootMarks.forEach(t=>{nw(t,t=>{t.removeProduct()},null,!0)}):this._cachedMarks=nT(this._rootMarks),this._rootMarks=[]}addRootMark(t){this._rootMarks.includes(t)||this._rootMarks.push(t)}getRootMarks(){return this._rootMarks}removeRootMark(t){let e=this._rootMarks.findIndex(e=>e===t);return e>=0&&(this._rootMarks.splice(e,1),!0)}_getGlobalThis(){var t;return eE(this._option.mode)?globalThis:null==(t=this.getStage())?void 0:t.window}_combineIncrementalLayers(){this._stage&&(0,s7.b4)(this._stage).then(()=>{this._stage&&this._stage.defaultLayer.combineSubLayer()})}findProgressiveMarks(){let t=[];return this._rootMarks.forEach(e=>{nw(e,e=>{e.isProgressive()&&t.push(e)})}),t.length?(this._progressiveMarks=t,this._combineIncrementalLayers(),t):(this._progressiveMarks=null,null)}doPreProgressive(){if(this._progressiveMarks&&this._progressiveMarks.some(t=>t.isDoingProgressive())){let t=es.rF.getSpecifiedRequestAnimationFrame(10);this._progressiveRafId=t(this.handleProgressiveFrame)}else this._progressiveMarks&&this._progressiveMarks.every(t=>t.canAnimateAfterProgressive())?this._progressiveMarks.forEach(t=>{t.runAnimation()}):this._progressiveMarks&&(this._progressiveMarks=null)}clearProgressive(){this._progressiveRafId&&es.rF.getSpecifiedCancelAnimationFrame(10)(this._progressiveRafId),this._progressiveMarks&&this._progressiveMarks.length&&(this._progressiveMarks.forEach(t=>{t.clearProgressive()}),this._progressiveMarks=null)}}let nB=t=>({}).toString.call(t).replace(/^\[object /,"").replace(/]$/,""),nP=Object.prototype,nO=function(t){let e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||nP)},nI=Object.prototype.hasOwnProperty,nR=function(t){if(et(t))return!0;if(t7(t))return!t.length;let e=nB(t);if("Map"===e||"Set"===e)return!t.size;if(nO(t))return!Object.keys(t).length;for(let e in t)if(nI.call(t,e))return!1;return!0};var nL=i(45257);function nD(t,e=0,i=0){let r;if(!t)return{width:e,height:i};try{r=null==window?void 0:window.getComputedStyle}catch(t){r=()=>({})}let s=r(t);if(/^(\d*\.?\d+)(px)$/.exec(s.width)){let r=parseFloat(s.width)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)||t.clientWidth-1,n=parseFloat(s.height)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom)||t.clientHeight-1;return{width:r<=0?e:r,height:n<=0?i:n}}return{width:e,height:i}}function nF(t){t.crosshair=eo(t.crosshair||{}).map(e=>it({["horizontal"===t.direction?"yField":"xField"]:{visible:!0,line:{visible:!0,type:"rect"}}},e))}function nz(t,e,i){var r;let{width:s,height:n}=t;if(t5(s)&&t5(n))return{width:s,height:n};let a=i.width,l=i.height,o=e.container,h=e.canvas;if(o){let{width:t,height:e}=nD(o,i.width,i.height);a=t,l=e}else if(h&&eE(e.mode)){let{width:t,height:e}=nD(t3(h)?es.rF.getElementById(h):h,i.width,i.height);a=t,l=e}else if(eP(e.mode)&&(null==(r=e.modeParams)?void 0:r.domref)){let t=e.modeParams.domref;a=t.width,l=t.height}return{width:a=null!=s?s:a,height:l=null!=n?n:l}}function nj(t,...e){let i=i=>e.reduce((t,e)=>t||(null==e?void 0:e[i]),t[i]);return Object.assign(t,{change:i("change"),reCompile:i("reCompile"),reMake:i("reMake"),reRender:i("reRender"),reSize:i("reSize"),reTransformSpec:i("reTransformSpec"),changeTheme:i("changeTheme"),changeBackground:i("changeBackground")}),t}function nH(t,e){return"line"===t||"area"===t||"common"===t&&e.series.every(t=>"area"===t.type||"line"===t.type)?{paddingInner:1,paddingOuter:0}:{paddingOuter:0}}let nN=9,nV=0,nW=-1;(h=z||(z={}))[h.SeriesGroup=0]="SeriesGroup",h[h.Axis_Grid=50]="Axis_Grid",h[h.CrossHair_Grid=100]="CrossHair_Grid",h[h.Region=450]="Region",h[h.Mark=300]="Mark",h[h.Node=400]="Node",h[h.Axis=100]="Axis",h[h.MarkLine=500]="MarkLine",h[h.MarkArea=100]="MarkArea",h[h.MarkPoint=500]="MarkPoint",h[h.DataZoom=500]="DataZoom",h[h.ScrollBar=500]="ScrollBar",h[h.Player=500]="Player",h[h.Legend=500]="Legend",h[h.CrossHair=500]="CrossHair",h[h.Indicator=500]="Indicator",h[h.Title=500]="Title",h[h.Label=500]="Label",h[h.Brush=500]="Brush",h[h.CustomMark=500]="CustomMark",h[h.Interaction=700]="Interaction",(u=j||(j={}))[u.Indicator=10]="Indicator",u[u.Region=20]="Region",u[u.Axis=30]="Axis",u[u.DataZoom=40]="DataZoom",u[u.Player=40]="Player",u[u.ScrollBar=40]="ScrollBar",u[u.Legend=50]="Legend",u[u.Title=70]="Title",u[u.CustomMark=70]="CustomMark",(d=H||(H={}))[d.Default=0]="Default",d[d.Theme=1]="Theme",d[d.Chart=2]="Chart",d[d.Base_Series=3]="Base_Series",d[d.Series=4]="Series",d[d.Mark=5]="Mark",d[d.User_Chart=6]="User_Chart",d[d.User_Series=7]="User_Series",d[d.User_Mark=8]="User_Mark",d[d.User_SeriesStyle=9]="User_SeriesStyle",d[d.Built_In=99]="Built_In";class nU{constructor(){this._children=[],this._markNameMap={},this._infoMap=new Map}getMarkNameMap(){return this._markNameMap}addMark(t,e){et(t)||(this._children.push(t),this._markNameMap[t.name]=t,this._infoMap.set(t,t8({},nU.defaultMarkInfo,e)))}removeMark(t){let e=this._children.findIndex(e=>e.name===t);e>=0&&(this._infoMap.delete(this._children[e]),delete this._markNameMap[t],this._children.splice(e,1))}clear(){this._children=[],this._markNameMap={},this._infoMap.clear()}forEach(t){this._children.forEach(t)}includes(t,e){return this._children.includes(t,e)}get(t){return isNaN(Number(t))?this._markNameMap[t]:this._children[t]}getMarks(){return this._children.slice()}getMarksInType(t){let e=eo(t);return this._children.filter(t=>e.includes(t.type))}getMarkInId(t){return this._children.find(e=>e.id===t)}getMarkWithInfo(t){return this._children.find(e=>Object.keys(t).every(i=>t[i]===this._infoMap.get(e)[i]))}}nU.defaultMarkInfo={};class nG{getOption(){return this._option}constructor(t){this._option=t,this.getCompiler=this._option.getCompiler}getStage(){var t;return null==(t=this.getCompiler())?void 0:t.getStage()}release(){this._option=null,this.getCompiler=null}}class nZ{constructor(t){this._option=t,this.type=t.type}_initTheme(t,e){return this._theme=this.getTheme(t,e),this._mergeThemeToSpec(t,e)}getTheme(t,e){}transformSpec(t,e,i){this._transformSpecBeforeMergingTheme(t,e,i);let r=this._initTheme(t,e);return this._transformSpecAfterMergingTheme(r.spec,e,i),r}_transformSpecBeforeMergingTheme(t,e,i){}_transformSpecAfterMergingTheme(t,e,i){}_mergeThemeToSpec(t,e){let i=this._theme;if(this._shouldMergeThemeToSpec()){let r=this._getDefaultSpecFromChart(e),s=t=>it({},i,r,t);return tY(t)?{spec:t.map(t=>s(t)),theme:i}:{spec:s(t),theme:i}}return{spec:t,theme:i}}_shouldMergeThemeToSpec(){return!0}_getDefaultSpecFromChart(t){}}let n$=(t,e)=>t===e||!tK(t)&&!tK(e)&&(tY(t)&&tY(e)?e.every(e=>t.some(t=>n$(t,e))):!(!ey(t)||!ey(e))&&Object.keys(e).every(i=>n$(t[i],e[i]))),nY=(t,e,i)=>{if(et(e))return t;let r=e[0];return et(r)?t:1===e.length?(t[r]=i,t):(et(t[r])&&("number"==typeof e[1]?t[r]=[]:t[r]={}),nY(t[r],e.slice(1),i))},nX=(t,e,i)=>{if(!et(e))return iF(t,e,i)};var nK=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class nq extends nG{getSpec(){return this._spec||{}}getSpecPath(){var t;return null==(t=this._option)?void 0:t.specPath}getSpecInfoPath(){var t,e,i;return null!=(e=null==(t=this._option)?void 0:t.specInfoPath)?e:null==(i=this._option)?void 0:i.specPath}getData(){return this._data}get layout(){return this._layout}getOption(){return this._option}getMarks(){var t,e;return null!=(e=null==(t=this._marks)?void 0:t.getMarks())?e:[]}getMarkNameMap(){var t;return null==(t=this._marks)?void 0:t.getMarkNameMap()}getMarkSet(){return this._marks}getChart(){return this._option.getChart()}get _theme(){var t;return null==(t=this.getSpecInfo())?void 0:t.theme}constructor(t,e){var i;super(e),this.transformerConstructor=nZ,this.type="null",this.modelType="null",this.userId=void 0,this._data=null,this._layout=null,this.specKey="",this._marks=new nU,this._lastLayoutRect=null,this.id=eg(),this.userId=t.id,this._spec=t,this.effect={},this.event=new iI(e.eventDispatcher,e.mode),null==(i=e.map)||i.set(this.id,this)}_releaseEvent(){this.event.release()}created(){this.setAttrFromSpec()}init(t){}afterInit(){}getVisible(){var t;return!1!==(null==(t=this._spec)?void 0:t.visible)}onLayoutStart(t,e){var i;null==(i=this._layout)||i.onLayoutStart(t,e)}onLayoutEnd(){var t;null==(t=this._layout)||t.onLayoutEnd(),this.getMarks().forEach(t=>t.commit(!1,!0))}onEvaluateEnd(t){}onBeforeRender(){}onDataUpdate(){}beforeRelease(){}clear(){this.getMarks().forEach(t=>{var e;return null==(e=t.clear)?void 0:e.call(t)})}release(){var t;this._releaseEvent(),this._spec=void 0,this.getMarks().forEach(t=>t.release()),null==(t=this._data)||t.release(),this._data=null,this._marks.clear(),super.release()}updateSpec(t){var e;let i=this._compareSpec(t,this._spec);return(i.reRender||i.reMake||i.reCompile)&&(null==(e=this._layout)||e.setWillLayoutTag()),this._spec=t,i}_compareSpec(t,e){return{change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1}}reInit(t){t&&(this._spec=t),this.setAttrFromSpec()}updateLayoutAttribute(){}setAttrFromSpec(){var t;null==(t=this._layout)||t.setAttrFromSpec(this._spec,this._option.getChartViewRect())}_convertMarkStyle(t){return Object.assign({},t)}setMarkStyle(t,e,i,r){t5(t)&&t5(e)&&t.setStyle(this._convertMarkStyle(e),i,r)}initMarkStyleWithSpec(t,e){if(!t5(t)||!t5(e))return;let{style:i,state:r}=e,s=Object.assign({},e);i&&(s.style=this._convertMarkStyle(i)),r&&(s.state={},Object.keys(r).forEach(t=>{s.state[t]=this._convertMarkStyle(r[t])})),t.initStyleWithSpec(s)}stateKeyToSignalName(t,e){let i=`${s6}_${this.modelType}_${this.type}_${this.id}_${t}`;return e&&(i+=`_${e}`),i}compileData(){var t;null==(t=this._data)||t.compile()}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t})})}_createMark(t,e={},i){let{type:r,name:s}=t,{parent:n}=e,a=nK(e,["parent"]),l=ig.createMark(r,s,Object.assign({model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._option.globalScale},a));return n?n.addMark(l):this.getCompiler().addRootMark(l),l&&(l.created(),i&&l.setMarkConfig(i)),l}_getDataIdKey(){}getColorScheme(){var t,e;return null==(e=(t=this._option).getTheme)?void 0:e.call(t,"colorScheme")}getSpecInfo(){var t,e,i;return nX(null!=(i=null==(e=(t=this._option).getSpecInfo)?void 0:e.call(t))?i:{},this.getSpecInfoPath())}getSpecIndex(){let t=this.getSpecPath();if(!(null==t?void 0:t.length))return 0;let e=Number(t[t.length-1]);return isNaN(e)?0:e}updateAnimateStateCallback(t){this._aniamtionStateCallback=t}getAnimationStateCallback(){return this._aniamtionStateCallback}}class nQ{getSpec(){return this._spec||{}}getLayoutStartPoint(){return this._layoutStartPoint}get layoutRectLevelMap(){return this._layoutRectLevelMap}get minWidth(){return this._minWidth}set minWidth(t){this._minWidth=t}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth=t}get minHeight(){return this._minHeight}set minHeight(t){this._minHeight=t}get maxHeight(){return this._maxHeight}set maxHeight(t){this._maxHeight=t}get lastComputeRect(){return this._lastComputeRect}getLastComputeOutBounds(){return this._lastComputeOutBounds}get layoutOrient(){return this._layoutOrient}set layoutOrient(t){this._layoutOrient=t}get model(){return this._model}get type(){return this._model.type}get willLayoutTag(){return this._willLayoutTag}constructor(t,e){var i;this.layoutClip=!1,this.autoIndent=!1,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:0,height:0},this._layoutRectLevelMap={width:nV,height:nV},this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._lastComputeRect=null,this._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0},this.getLayoutRect=()=>this._layoutRect,this.layoutType="normal",this._layoutOrient="left",this.layoutPaddingLeft=0,this.layoutPaddingTop=0,this.layoutPaddingRight=0,this.layoutPaddingBottom=0,this.layoutOffsetX=0,this.layoutOffsetY=0,this.layoutLevel=j.Region,this._willLayoutTag=!0,this._model=t,this._option=e,this.layoutLevel=e.layoutLevel,this.layoutType=e.layoutType,e.layoutOrient&&(this.layoutOrient=e.layoutOrient),this._spec=null==(i=null==t?void 0:t.getSpec)?void 0:i.call(t)}_setLayoutAttributeFromSpec(t,e){var i,r,s,n;if(this._spec&&!1!==this._spec.visible){let a=eS(eA(t.padding),e,e);this._option.transformLayoutPadding&&(a=this._option.transformLayoutPadding(a)),this.layoutPaddingLeft=a.left,this.layoutPaddingRight=a.right,this.layoutPaddingTop=a.top,this.layoutPaddingBottom=a.bottom,this._minHeight=et(t.minHeight)?null!=(i=this._minHeight)?i:null:ex(t.minHeight,e.height,e),this._maxHeight=et(t.maxHeight)?null!=(r=this._maxHeight)?r:null:ex(t.maxHeight,e.height,e),this._minWidth=et(t.minWidth)?null!=(s=this._minWidth)?s:null:ex(t.minWidth,e.width,e),this._maxWidth=et(t.maxWidth)?null!=(n=this._maxWidth)?n:null:ex(t.maxWidth,e.width,e),t.width&&this.setLayoutRect({width:ex(t.width,e.width,e)},{width:nN}),t.height&&this.setLayoutRect({height:ex(t.height,e.height,e)},{height:nN}),et(t.offsetX)||(this.layoutOffsetX=ex(t.offsetX,e.width,e)),et(t.offsetY)||(this.layoutOffsetY=ex(t.offsetY,e.height,e)),t.alignSelf&&(this.alignSelf=t.alignSelf)}}setAttrFromSpec(t,e){var i,r,s,n;this._spec=t,this.layoutType=null!=(i=t.layoutType)?i:this.layoutType,this.layoutLevel=null!=(r=t.layoutLevel)?r:this.layoutLevel,this.layoutOrient=null!=(s=t.orient)?s:this.layoutOrient,this._setLayoutAttributeFromSpec(t,e),this.layoutClip=null!=(n=t.clip)?n:this.layoutClip}onLayoutStart(t,e){this._setLayoutAttributeFromSpec(this._spec,e)}onLayoutEnd(){}_getAbsoluteSpecValue(t){let e={top:null,bottom:null,left:null,right:null};return["top","bottom","left","right"].forEach(i=>{et(this._spec[i])||(e[i]=ex(this._spec[i],"top"===i||"bottom"===i?t.height:t.width,t))}),e}absoluteLayoutInRect(t){let{top:e,bottom:i,left:r,right:s}=this._getAbsoluteSpecValue(t),n={width:t.width-this.layoutPaddingLeft-this.layoutPaddingRight,height:t.height-this.layoutPaddingTop-this.layoutPaddingBottom};et(r)||(n.width-=r),et(s)||(n.width-=s),et(e)||(n.height-=e),et(i)||(n.height-=i),this.setLayoutRect(n);let{width:a,height:l}=this.computeBoundsInRect(this.getLayoutRect());this.setLayoutRect({width:a,height:l});let o={x:t.x,y:t.y};!0===this._spec.center?(o.x=t.x+.5*t.width-.5*a,o.y=t.y+.5*t.height-.5*l):(et(r)?et(s)||(o.x=t.x+t.width-this.layoutPaddingRight-s-a):o.x=t.x+r+this.layoutPaddingLeft,et(e)?et(i)||(o.y=t.y+t.height-this.layoutPaddingBottom-i-l):o.y=t.y+e+this.layoutPaddingTop),this.setLayoutStartPosition(o)}setLayoutStartPosition(t){var e,i;this._option.transformLayoutPosition&&(t=this._option.transformLayoutPosition(t)),ee(t.x)&&(this._layoutStartPoint.x=t.x),ee(t.y)&&(this._layoutStartPoint.y=t.y),null==(i=(e=this._model).afterSetLayoutStartPoint)||i.call(e,this._layoutStartPoint)}setLayoutRect({width:t,height:e},i){var r,s,n,a;ee(t)&&(null!=(r=null==i?void 0:i.width)?r:nV)>=this._layoutRectLevelMap.width&&(this._layoutRect.width=t,this._layoutRectLevelMap.width=null!=(s=null==i?void 0:i.width)?s:nV),ee(e)&&(null!=(n=null==i?void 0:i.height)?n:nV)>=this._layoutRectLevelMap.height&&(this._layoutRect.height=e,this._layoutRectLevelMap.height=null!=(a=null==i?void 0:i.height)?a:nV),this.setRectInSpec(this._layoutRect)}getLayout(){return{x:this._layoutStartPoint.x,y:this._layoutStartPoint.y,width:this._layoutRect.width,height:this._layoutRect.height}}mergeLayoutRect({width:t,height:e}){let i={width:t,height:e};return this._layoutRectLevelMap.width>nV&&(i.width=this._layoutRect.width),this._layoutRectLevelMap.height>nV&&(i.height=this._layoutRect.height),i}getOrientPosAttribute(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"x":"y"}getOrientSizeAttribute(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"width":"height"}changeBoundsBySetting(t){return this._layoutRectLevelMap.width>nV&&(t.x2=t.x1+this._layoutRect.width),this._layoutRectLevelMap.height>nV&&(t.y2=t.y1+this._layoutRect.height),t.x1-=this._layoutStartPoint.x,t.x2-=this._layoutStartPoint.x,t.y1-=this._layoutStartPoint.y,t.y2-=this._layoutStartPoint.y,t}setRectInSpec(t){let e=Object.assign({},t);return this._layoutRectLevelMap.width<nN?(et(this._minWidth)||(e.width=Math.max(e.width,this._minWidth)),et(this._maxWidth)||(e.width=Math.min(e.width,this._maxWidth))):e.width=this._layoutRect.width,this._layoutRectLevelMap.height<nN?(et(this._minHeight)||(e.height=Math.max(e.height,this._minHeight)),et(this._maxHeight)||(e.height=Math.min(e.height,this._maxHeight))):e.height=this._layoutRect.height,e}computeBoundsInRect(t){if(this._lastComputeRect=t,("region-relative"===this.layoutType||"region-relative-overlap"===this.layoutType)&&(this._layoutRectLevelMap.width===nN&&("left"===this.layoutOrient||"right"===this.layoutOrient)||this._layoutRectLevelMap.height===nN&&("bottom"===this.layoutOrient||"top"===this.layoutOrient)))return this._layoutRect;let e=Object.assign({},this._model.getBoundsInRect(this.setRectInSpec(t),t));this.changeBoundsBySetting(e),this.autoIndent&&e.x2-e.x1>0&&e.y2-e.y1>0&&(this._lastComputeOutBounds.x1=Math.ceil(-e.x1),this._lastComputeOutBounds.x2=Math.ceil(e.x2-t.width),this._lastComputeOutBounds.y1=Math.ceil(-e.y1),this._lastComputeOutBounds.y2=Math.ceil(e.y2-t.height));let i=this.setRectInSpec(ek(e,t));return this._option.transformLayoutRect&&(i=this._option.transformLayoutRect(i)),i}getModelId(){return this._model.id}getModelVisible(){return this._model.getVisible()}setWillLayoutTag(){this._willLayoutTag=!0}clearWillLayoutTag(){this._willLayoutTag=!1}}class nJ extends nq{constructor(){super(...arguments),this.layoutType="normal",this.layoutLevel=0,this.layoutZIndex=0,this._forceLayoutTag=!1,this._layout=null,this._orient=null,this._layoutRect={width:0,height:0},this._layoutStartPos={x:0,y:0},this._isLayout=!0,this.getGraphicBounds=()=>this._layout?{x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}:{x1:0,x2:0,y1:0,y2:0},this._transformLayoutRect=null,this._transformLayoutPosition=null,this._transformLayoutPadding=null}get layoutOrient(){return this._orient}set layoutOrient(t){this._orient=t,this._layout&&(this._layout.layoutOrient=t)}initLayout(){"none"!==this.layoutType&&(this._layout=new nQ(this,{layoutType:this.layoutType,layoutLevel:this.layoutLevel,layoutOrient:this._orient,transformLayoutRect:this._transformLayoutRect,transformLayoutPosition:this._transformLayoutPosition,transformLayoutPadding:this._transformLayoutPadding}),this._orient&&"radius"!==this._orient&&"angle"!==this._orient&&this._layout&&(this._layout.layoutOrient=this._orient))}onLayoutStart(t,e){this._isLayout=!0,super.onLayoutStart(t,e)}onLayoutEnd(){super.onLayoutEnd(),this.updateLayoutAttribute();let t=this.getLayoutRect();!this._forceLayoutTag&&t1(this._lastLayoutRect,t)||(this._lastLayoutRect=Object.assign({},t)),this._forceLayoutTag=!1,this._isLayout=!1}afterSetLayoutStartPoint(t){}_forceLayout(){var t,e;this._isLayout||(null==(t=this._layout)||t.setWillLayoutTag(),this._forceLayoutTag=!0,null==(e=this._option.globalInstance.getChart())||e.setLayoutTag(!0))}getLayoutStartPoint(){return this._layout?this._layout.getLayoutStartPoint():this._layoutStartPos}setLayoutStartPosition(t){return this._layout?this._layout.setLayoutStartPosition(t):this._layoutStartPos=t8(this._layoutStartPos,t)}getLayoutRect(){return this._layout?this._layout.getLayoutRect():this._layoutRect}setLayoutRect(t,e){return this._layout?this._layout.setLayoutRect(t):this._lastLayoutRect=t8(this._layoutRect,t)}getLastComputeOutBounds(){var t;return null==(t=this._layout)?void 0:t.getLastComputeOutBounds()}setAttrFromSpec(){var t,e,i,r,s;super.setAttrFromSpec(),this.layoutClip=null!=(t=this._spec.clip)?t:this.layoutClip,this.layoutZIndex=null!=(e=this._spec.zIndex)?e:this.layoutZIndex,this.layoutType=null!=(i=this._spec.layoutType)?i:this.layoutType,this._orient=null!=(r=this._spec.orient)?r:this._orient,this.layoutLevel=null!=(s=this._spec.layoutLevel)?s:this.layoutLevel}}class n0 extends nZ{_initTheme(t,e){return{spec:t,theme:this._theme}}}class n1 extends nJ{getMaxWidth(){return this._layout.maxWidth}setMaxWidth(t){this._layout.maxWidth=t}getMaxHeight(){return this._layout.maxHeight}setMaxHeight(t){this._layout.maxHeight=t}getGroupMark(){return this._groupMark}getInteractionMark(){return this._interactionMark}getStackInverse(){return!0===this._spec.stackInverse}getStackSort(){return!0===this._spec.stackSort}constructor(t,e){var i;super(t,e),this.transformerConstructor=n0,this.modelType="region",this.specKey="region",this.type=n1.type,this._series=[],this.layoutType="region",this.layoutZIndex=z.Region,this.seriesDataFilterOver=()=>{this.event.emit(rB.regionSeriesDataFilterOver,{model:this,chart:this.getChart()}),this._series.forEach(t=>{t.getViewDataFilter()&&t.reTransformViewData()})},this.getBoundsInRect=()=>({x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}),this.userId=t.id,this.coordinate=null!=(i=t.coordinate)?i:"cartesian"}_getClipDefaultValue(){var t,e,i,r;let s=this._option.getChart().getSpec(),n=null==(e=null==(t=s.dataZoom)?void 0:t.some)?void 0:e.call(t,t=>{var e;return"axis"===(null!=(e=t.filterMode)?e:"filter")}),a=null==(r=null==(i=s.scrollBar)?void 0:i.some)?void 0:r.call(i,t=>{var e;return"axis"===(null!=(e=t.filterMode)?e:"axis")});return!(!n&&!a)||this._layout.layoutClip}created(){var t,e;this.initLayout(),super.created();let i=null!=(t=this._spec.clip)?t:this._getClipDefaultValue();this._groupMark=this._createGroupMark("regionGroup",this.userId,this.layoutZIndex),this._spec.roam&&this._groupMark.setMarkConfig({interactive:!0}),this._interactionMark=this._createGroupMark("regionInteractionGroup",(null!=(e=this.userId)?e:this.type)+"_interaction",z.Interaction),nR(this._spec.style)||(this._backgroundMark=this._createMark({type:"rect",name:"regionBackground"},{parent:this._groupMark}),i&&(this._foregroundMark=this._createMark({type:"rect",name:"regionForeground"},{parent:this._groupMark})),[this._backgroundMark,this._foregroundMark].forEach(t=>{t&&(t.created(),this.setMarkStyle(t,{width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height},"normal",H.Built_In),this._groupMark.addMark(t))}),this._backgroundMark&&this._backgroundMark.setMarkConfig({zIndex:z.SeriesGroup-1}),this._foregroundMark&&this._foregroundMark.setMarkConfig({zIndex:z.Mark+1}))}_createGroupMark(t,e,i){var r,s;let n=this._createMark({type:"group",name:t});n.setUserId(e),n.setMarkConfig({zIndex:i});let a=null!=(r=this._spec.clip)?r:this._getClipDefaultValue();return this.setMarkStyle(n,{x:()=>this.getLayoutStartPoint().x,y:()=>this.getLayoutStartPoint().y,width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height,clip:a},"normal",H.Built_In),this.setMarkStyle(n,{cornerRadius:null==(s=this._spec.style)?void 0:s.cornerRadius},"normal",H.User_Mark),this._marks.addMark(n),n}init(t){super.init(t),this.initMark(),this.initSeriesDataflow()}initMark(){this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}_initBackgroundMarkStyle(){var t,e;this._backgroundMark&&(this.setMarkStyle(this._backgroundMark,Object.assign({fillOpacity:+(null!=(t=this._spec.style)&&!!t.fill)},this._spec.style),"normal",H.User_Mark),(null!=(e=this._spec.clip)?e:this._getClipDefaultValue())&&this.setMarkStyle(this._backgroundMark,{strokeOpacity:0},"normal",H.Built_In))}_initForegroundMarkStyle(){this._foregroundMark&&this.setMarkStyle(this._foregroundMark,Object.assign(Object.assign({},this._spec.style),{fillOpacity:0,pickable:!1}),"normal",H.User_Mark)}_compareSpec(t,e){let i=super._compareSpec(t,e);return t1(null==e?void 0:e.style,null==t?void 0:t.style)||(i.reMake=!0),i}reInit(t){super.reInit(t),this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}addSeries(t){t&&(this._series.includes(t)||this._series.push(t))}removeSeries(t){if(!t)return;let e=this._series.findIndex(e=>e===t);e>=0&&this._series.splice(e,1)}getSeries(t={}){return this._series.filter(e=>{var i,r;return(!t.name||(null==e?void 0:e.name)===t.name)&&(!t.userId||eo(t.userId).includes(e.userId))&&(!t5(t.specIndex)||eo(t.specIndex).includes(e.getSpecIndex()))&&(!t.id||e.id===t.id)&&(!t.type||e.type===t.type)&&(!t.coordinateType||e.coordinate===t.coordinateType)&&(!t.dataName||(null==(r=null==(i=e.getRawData)?void 0:i.call(e))?void 0:r.name)===t.dataName)})}getSeriesInName(t){return this.getSeries({name:t})[0]}getSeriesInUserId(t){return this.getSeries({userId:t})[0]}getSeriesInId(t){return this.getSeries({id:t})[0]}getSeriesInType(t){return this.getSeries({type:t})}getSeriesInCoordinateType(t){return this.getSeries({coordinateType:t})}getSeriesInDataName(t){return this.getSeries({dataName:t})}initSeriesDataflow(){let t=this._series.map(t=>{var e;return null!=(e=t.getViewDataFilter())?e:t.getViewData()}).filter(t=>!!t);this._option.dataSet.multipleDataViewAddListener(t,"change",this.seriesDataFilterOver)}release(){super.release(),this._series=[]}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t,context:{model:this}})})}compile(){this.compileMarks()}onLayoutEnd(){this._series.forEach(t=>t.onLayoutEnd()),super.onLayoutEnd()}}function n2(t){let e=[],i=[],r=[];return t.forEach(t=>{et(t.getSpec().position)||"start"===t.getSpec().position?e.push(t):"middle"===t.getSpec().position?i.push(t):"end"===t.getSpec().position&&r.push(t)}),{startItems:e,endItems:r,middleItems:i}}function n3(t,e,i){e?t.forEach(t=>{let e=eh(t),r=(i-(e.getLayoutStartPoint().y+e.getLayoutRect().height-t[0].getLayoutStartPoint().y))/2;t.forEach(t=>{t.setLayoutStartPosition({x:t.getLayoutStartPoint().x,y:t.getLayoutStartPoint().y+r})})}):t.forEach(t=>{let e=eh(t),r=(i-(e.getLayoutStartPoint().x+e.getLayoutRect().width-t[0].getLayoutStartPoint().x))/2;t.forEach(t=>{t.setLayoutStartPosition({x:t.getLayoutStartPoint().x+r,y:t.getLayoutStartPoint().y})})})}function n5(t,e,i,r){let s;t.forEach((t,n)=>{t.length>1&&(s=i[n],t.forEach(t=>{if(!t.alignSelf||"start"===t.alignSelf)return;let i=t.getLayoutStartPoint(),n="middle"===t.alignSelf?.5:1,a=e?s-(t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight):s-(t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom);e?t.setLayoutStartPosition({x:i.x+r*a*n,y:i.y}):t.setLayoutStartPosition({x:i.x,y:i.y+r*a*n})}))})}function n4(t,e,i,r,s,n){if(t.length){let a=0,l="right"===s,o=l?-1:1,h=l?e.rightCurrent:e.leftCurrent,u=e.topCurrent,d=[],c=[],p=[];t.forEach(t=>{let{rect:r}=n8(t,e,n),s=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=l?-r.width-t.layoutPaddingRight:t.layoutPaddingLeft;t.setLayoutStartPosition({x:h+t.layoutOffsetX+f,y:u+t.layoutOffsetY+t.layoutPaddingTop}),(u+=s)>i&&c.length?(p.push(a),h+=o*a,a=g,u=e.topCurrent+s,t.setLayoutStartPosition({x:h+t.layoutOffsetX+f,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),d.push(c),c=[t]):(a=Math.max(a,g),c.push(t))}),p.push(a),d.push(c),n5(d,!0,p,o),r&&n3(d,!0,i),l?e.rightCurrent=h+o*a:e.leftCurrent=h+o*a}}function n7(t,e,i,r,s){if(t.length){let i=0,n="right"===r,a=n?-1:1,l=n?e.rightCurrent:e.leftCurrent,o=e.bottomCurrent,h=[],u=[],d=[];t.forEach(t=>{let{rect:r}=n8(t,e,s),c=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,p=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,g=n?-r.width-t.layoutPaddingRight:t.layoutPaddingLeft;o<c&&u.length?(d.push(i),l+=a*i,i=p,o=e.bottomCurrent,t.setLayoutStartPosition({x:l+t.layoutOffsetX+g,y:o+t.layoutOffsetY-r.height-t.layoutPaddingBottom}),h.push(u),u=[t]):(t.setLayoutStartPosition({x:l+t.layoutOffsetX+g,y:o+t.layoutOffsetY-r.height-t.layoutPaddingBottom}),i=Math.max(i,p),o-=c,u.push(t))}),d.push(i),h.push(u),n5(h,!0,d,a),n?e.rightCurrent=l+a*i:e.leftCurrent=l+a*i}}function n6(t,e,i,r,s,n){if(t.length){let a="top"===s,l=a?1:-1,o=0,h=e.leftCurrent,u=a?e.topCurrent:e.bottomCurrent,d=[],c=[],p=[];t.forEach(t=>{let{rect:r}=n8(t,e,n),s=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=a?t.layoutPaddingTop:-r.height-t.layoutPaddingBottom;t.setLayoutStartPosition({x:h+t.layoutOffsetX+t.layoutPaddingLeft,y:u+t.layoutOffsetY+f}),(h+=g)>i&&c.length?(p.push(o),h=e.leftCurrent+g,u+=l*o,o=s,t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:u+t.layoutOffsetY+f}),d.push(c),c=[t]):(o=Math.max(o,s),c.push(t))}),p.push(o),d.push(c),n5(d,!1,p,l),r&&n3(d,!1,i),a?e.topCurrent=u+l*o:e.bottomCurrent=u+l*o}}function n9(t,e,i,r,s){if(t.length){let i="top"===r,n=i?1:-1,a=0,l=e.rightCurrent,o=i?e.topCurrent:e.bottomCurrent,h=[],u=[],d=[];t.forEach(t=>{let{layoutTag:r,layoutRect:d,rect:c}=n8(t,e,s),p=c.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=c.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=i?t.layoutPaddingTop:-c.height-t.layoutPaddingBottom;l<g&&u.length?(l=e.rightCurrent,o+=n*a,a=p,t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-c.width-t.layoutPaddingRight,y:o+t.layoutOffsetY+f}),h.push(u),u=[t]):(u.push(t),t.setLayoutStartPosition({x:l+t.layoutOffsetX-c.width-t.layoutPaddingRight,y:o+t.layoutOffsetY+f}),a=Math.max(a,p),l-=g)}),d.push(a),h.push(u),n5(h,!1,d,n),i?e.topCurrent=o+n*a:e.bottomCurrent=o+n*a}}function n8(t,e,i,r=!0){let s,n,a="recomputeHeight",l="recomputeWidth",o="width";"top"!==t.layoutOrient&&"bottom"!==t.layoutOrient||(a="recomputeWidth",l="recomputeHeight",o="height");let h=!(!t.willLayoutTag&&!1===i[a]);if(h){let a=Object.assign({},t.getLayoutRect()),u=t.lastComputeRect;s=e.getItemComputeLayoutRect(t),!t.willLayoutTag&&t1(s,u)?(h=!1,n=t.getLayoutRect()):(n=t.computeBoundsInRect(s),t1(a[o],n[o])?h=!1:(r&&t.setLayoutRect(n),i[l]=!0))}else s=t.getLastComputeOutBounds(),n=t.getLayoutRect();return{layoutRect:s,rect:n,layoutTag:h}}n1.type="region",n1.transformerConstructor=n0,n1.specKey="region";class at{constructor(t,e){this.leftCurrent=0,this.topCurrent=0,this.rightCurrent=0,this.bottomCurrent=0,this.recomputeWidth=!1,this.recomputeHeight=!1,this._onError=null==e?void 0:e.onError}_layoutInit(t,e,i,r){this._chartLayoutRect=i,this._chartViewBox=r,this.leftCurrent=i.x,this.topCurrent=i.y,this.rightCurrent=i.x+i.width,this.bottomCurrent=i.height+i.y,this.recomputeWidth=!1,this.recomputeHeight=!1,e.sort((t,e)=>e.layoutLevel-t.layoutLevel)}_layoutNormalItems(t,e){this.layoutNormalInlineItems(t.filter(t=>"normal-inline"===t.layoutType),e),this.layoutNormalItems(t.filter(t=>"normal"===t.layoutType),e)}_groupItems(t){let e=t.filter(t=>"region"===t.layoutType),i=t.filter(t=>"region-relative"===t.layoutType),r=t.filter(t=>"region-relative-overlap"===t.layoutType),s=i.concat(r),n={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}};return r.forEach(t=>{n[t.layoutOrient].items.push(t)}),{regionItems:e,relativeItems:i,relativeOverlapItems:r,allRelatives:s,overlapItems:n}}layoutItems(t,e,i,r){this._layoutInit(t,e,i,r);let s={recomputeWidth:this.recomputeWidth,recomputeHeight:this.recomputeHeight};this._layoutNormalItems(e,s);let n={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},{regionItems:a,relativeItems:l,relativeOverlapItems:o,allRelatives:h,overlapItems:u}=this._groupItems(e);this.layoutRegionItems(a,l,o,u,s),this._processAutoIndent(a,l,o,u,h,n,s),this.layoutAbsoluteItems(e.filter(t=>"absolute"===t.layoutType)),e.forEach(t=>{t.clearWillLayoutTag()})}_processAutoIndent(t,e,i,r={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}},s,n,a){if(s.some(t=>t.autoIndent)){let{top:l,bottom:o,left:h,right:u}=this._checkAutoIndent(s,n);(l||o||h||u)&&(this.topCurrent=n.top+l,this.bottomCurrent=n.bottom-o,this.leftCurrent=n.left+h,this.rightCurrent=n.right-u,this.layoutRegionItems(t,e,i,r,a))}}layoutNormalItems(t,e){t.forEach(t=>{let{rect:i}=n8(t,this,e);"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"top"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"right"===t.layoutOrient?(t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX-i.width-t.layoutPaddingRight,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"bottom"===t.layoutOrient&&(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingRight,y:this.bottomCurrent+t.layoutOffsetY-i.height-t.layoutPaddingBottom}),this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom)})}layoutNormalInlineItems(t,e){let i=t.filter(t=>"left"===t.layoutOrient),r=t.filter(t=>"right"===t.layoutOrient),s=t.filter(t=>"top"===t.layoutOrient),n=t.filter(t=>"bottom"===t.layoutOrient),a=this._chartLayoutRect.width+this._chartLayoutRect.x,l=this._chartLayoutRect.height+this._chartLayoutRect.y;return i.length&&function(t,e,i,r){let{startItems:s,middleItems:n,endItems:a}=n2(t);s.length&&n4(s,e,i,!1,"left",r),n.length&&n4(n,e,i,!0,"left",r),a.length&&n7(a,e,i,"left",r)}(i,this,l,e),s.length&&function(t,e,i,r){let{startItems:s,middleItems:n,endItems:a}=n2(t);s.length&&n6(s,e,i,!1,"top",r),n.length&&n6(n,e,i,!0,"top",r),a.length&&n9(a,e,i,"top",r)}(s,this,a,e),r.length&&function(t,e,i,r){let{startItems:s,middleItems:n,endItems:a}=n2(t);s.length&&n4(s,e,i,!1,"right",r),n.length&&n4(n,e,i,!0,"right",r),a.length&&n7(a,e,i,"right",r)}(r,this,l,e),n.length&&function(t,e,i,r){let{startItems:s,middleItems:n,endItems:a}=n2(t);s.length&&n6(s,e,i,!1,"bottom",r),n.length&&n6(n,e,i,!0,"bottom",r),a.length&&n9(a,e,i,"bottom",r)}(n,this,a,e),!0}_layoutRelativeOverlap(t,e,i){e.items.forEach(t=>{let{rect:r}=n8(t,this,i);e.rect.width=Math.max(r.width+t.layoutPaddingLeft+t.layoutPaddingRight,e.rect.width),e.rect.height=Math.max(r.height+t.layoutPaddingTop+t.layoutPaddingBottom,e.rect.height)}),e.items.forEach(i=>{t1(i.getLayoutRect(),e.rect)||i.setLayoutRect(e.rect),"left"===t?i.setLayoutStartPosition({x:this.leftCurrent+i.layoutOffsetX}):"right"===t?i.setLayoutStartPosition({x:this.rightCurrent-e.rect.width+i.layoutOffsetX}):"top"===t?i.setLayoutStartPosition({x:this.topCurrent+i.layoutOffsetY}):i.setLayoutStartPosition({x:this.bottomCurrent-e.rect.height+i.layoutOffsetY})}),"left"===t?this.leftCurrent+=e.rect.width:"right"===t?this.rightCurrent-=e.rect.width:"top"===t?this.topCurrent+=e.rect.height:this.bottomCurrent-=e.rect.height}_layoutRelativeItem(t,e){let{rect:i}=n8(t,this,e,!1);"left"===t.layoutOrient||"right"===t.layoutOrient?t.setLayoutRect({width:i.width}):t.setLayoutRect({height:i.height}),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"right"===t.layoutOrient?(this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX+t.layoutPaddingLeft})):"top"===t.layoutOrient?(t.setLayoutStartPosition({y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"bottom"===t.layoutOrient&&(this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,t.setLayoutStartPosition({y:this.bottomCurrent+t.layoutOffsetY+t.layoutPaddingTop}))}_layoutRegionItem(t,e,i){let r=Math.max(Math.min(e,...t.map(t=>{var e;return null!=(e=t.maxWidth)?e:Number.MAX_VALUE})),0),s=Math.max(Math.min(i,...t.map(t=>{var e;return null!=(e=t.maxHeight)?e:Number.MAX_VALUE})),0);return t.forEach(t=>{let e=r-t.layoutPaddingLeft-t.layoutPaddingRight,i=s-t.layoutPaddingTop-t.layoutPaddingBottom;t.setLayoutRect({width:e,height:i}),t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop})}),{regionHeight:s,regionWidth:r}}layoutRegionItems(t,e,i,r={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}},s){let n=this.rightCurrent-this.leftCurrent,a=this.bottomCurrent-this.topCurrent;e.filter(t=>"left"===t.layoutOrient||"right"===t.layoutOrient).forEach(t=>{this._layoutRelativeItem(t,s)}),this._layoutRelativeOverlap("left",r.left,s),this._layoutRelativeOverlap("right",r.right,s),n=this.rightCurrent-this.leftCurrent,e.filter(t=>"top"===t.layoutOrient||"bottom"===t.layoutOrient).forEach(t=>{this._layoutRelativeItem(t,s)}),this._layoutRelativeOverlap("top",r.top,s),this._layoutRelativeOverlap("bottom",r.bottom,s),a=this.bottomCurrent-this.topCurrent;let{regionWidth:l,regionHeight:o}=this._layoutRegionItem(t,n,a);e.concat(i).forEach(e=>{if(["left","right"].includes(e.layoutOrient)){let i=this.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({height:i.getLayoutRect().height}),e.setLayoutStartPosition({y:i.getLayoutStartPoint().y+e.layoutOffsetY+e.layoutPaddingTop}),"right"===e.layoutOrient&&e.setLayoutStartPosition({x:e.getLayoutStartPoint().x+l-n})}else if(["top","bottom"].includes(e.layoutOrient)){let i=this.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({width:i.getLayoutRect().width}),e.setLayoutStartPosition({x:i.getLayoutStartPoint().x+e.layoutOffsetX+e.layoutPaddingLeft}),"bottom"===e.layoutOrient&&e.setLayoutStartPosition({y:e.getLayoutStartPoint().y+o-a})}})}layoutAbsoluteItems(t){t.forEach(t=>{t.willLayoutTag&&t.absoluteLayoutInRect(this._chartLayoutRect)})}filterRegionsWithID(t,e){var i;let r=t.find(t=>t.getModelId()===e);return r||(null!=(i=this._onError)?i:eR)("can not find target region item, invalid id"),r}getItemComputeLayoutRect(t){return{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight,height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom}}_checkAutoIndent(t,e){let i={top:0,left:0,bottom:0,right:0};return t.forEach(t=>{if(!t.getModelVisible()||!t.autoIndent)return;let r="left"===t.layoutOrient||"right"===t.layoutOrient,s=t.getLastComputeOutBounds(),n=this._getOutInLayout(s,t,e);r?(i.top=Math.max(i.top,n.top),i.bottom=Math.max(i.bottom,n.bottom)):(i.left=Math.max(i.left,n.left),i.right=Math.max(i.right,n.right))}),i}_getOutInLayout(t,e,i){let{x:r,y:s}=e.getLayoutStartPoint(),{width:n,height:a}=e.getLayoutRect();return{left:i.left-(r-t.x1),right:r+n+t.x2-i.right,top:i.top-(s-t.y1),bottom:s+a+t.y2-i.bottom}}}at.type="base",(c=N||(N={})).enter="enter",c.update="update",c.exit="exit",c.unChange="unChange",(p=V||(V={})).STATE_NORMAL="normal",p.STATE_HOVER="hover",p.STATE_HOVER_REVERSE="hover_reverse",p.STATE_DIMENSION_HOVER="dimension_hover",p.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",p.STATE_SELECTED="selected",p.STATE_SELECTED_REVERSE="selected_reverse",p.STATE_SANKEY_EMPHASIS="selected",p.STATE_SANKEY_EMPHASIS_REVERSE="blur",p.STATE_HIGHLIGHT="highlight",p.STATE_BLUR="blur",p.STATE_ACTIVE="active",(g=W||(W={})).STATE_HOVER_REVERSE="hover_reverse",g.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",g.STATE_SELECTED_REVERSE="selected_reverse",(f=U||(U={})).Identity="identity",f.Linear="linear",f.Log="log",f.Pow="pow",f.Sqrt="sqrt",f.Symlog="symlog",f.Time="time",f.Quantile="quantile",f.Quantize="quantize",f.Threshold="threshold",f.Ordinal="ordinal",f.Point="point",f.Band="band";let ae={};function ai(t){switch(t){case U.Linear:case U.Log:case U.Pow:case U.Sqrt:case U.Symlog:case U.Time:return!0;default:return!1}}function ar(t){switch(t){case U.Ordinal:case U.Point:case U.Band:return!0;default:return!1}}function as(t,e,i){t5(e)||(e=t,t=0),t5(i)||(i=1);let r=-1,s=0|Math.max(0,Math.ceil((e-t)/i)),n=Array(s);for(;++r<s;)n[r]=t+r*i;return n}Object.values(U).forEach(t=>{ae[t]=!0});let an=t=>{let e=null,i=null;return(...r)=>(e&&r.every((t,i)=>t===e[i])||(e=r,i=t(...r)),i)};function aa(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function al(t,e,i=0,r){for(et(r)&&(r=t.length);i<r;){let s=i+r>>>1;aa(t[s],e)>0?r=s:i=s+1}return i}let ao=(t,e)=>ah(0,t.length,i=>e(t[i])),ah=(t,e,i)=>{let r=t,s=e;for(;r<s;){let t=Math.floor((r+s)/2);i(t)>=0?s=t:r=t+1}return r};function au(t){return t}let ad=t=>t<0?-Math.sqrt(-t):Math.sqrt(t),ac=t=>t<0?-t*t:t*t,ap=t=>-Math.log(-t),ag=t=>-Math.exp(-t),af=t=>isFinite(t)?Math.pow(10,t):t<0?0:t,am=t=>10===t?af:t===Math.E?Math.exp:e=>Math.pow(t,e),ay=t=>t===Math.E?Math.log:10===t?Math.log10:2===t?Math.log2:(t=Math.log(t),e=>Math.log(e)/t),a_=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),av=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t;function ab(t,e){if(t=Number(t),e=Number(e)-t)return i=>(i-t)/e;let i=Number.isNaN(e)?NaN:.5;return()=>i}function ax(t,e,i){let r,s,n=t[0],a=t[1],l=e[0],o=e[1];return a<n?(r=ab(a,n),s=i(o,l)):(r=ab(n,a),s=i(l,o)),t=>s(r(t))}function aS(t,e,i){let r;return r=1===t?t+2*i:t-e+2*i,t?r>0?r:1:0}function ak(t,e,i,r){return 1===i&&(i=0),aS(t,i,r)*(e/(1-i))}function aA(t,e){let i=(t[1]-t[0])/(e[1]-e[0]),r=t[0]-i*e[0];return[r,i+r]}function aM(t,e,i){let r=Math.min(t.length,e.length)-1,s=Array(r),n=Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)s[a]=ab(t[a],t[a+1]),n[a]=i(e[a],e[a+1]);return function(e){let i=al(t,e,1,r)-1;return n[i](s[i](e))}}let aw=(t,e)=>{let i=t.slice(),r=0,s=i.length-1,n=i[r],a=i[s];return a<n&&([r,s]=[s,r],[n,a]=[a,n]),i[r]=e.floor(n),i[s]=e.ceil(a),i},aT=(t,e=!1)=>{let i=Math.floor(Math.log10(t)),r=t/Math.pow(10,i);return(e?r<1.5?1:r<3?2:r<7?5:10:r<=1?1:r<=2?2:r<=5?5:10)*Math.pow(10,i)},aC=(t,e)=>{let i,r;return e[0]<e[1]?(i=e[0],r=e[1]):(i=e[1],r=e[0]),Math.min(Math.max(t,i),r)},aE=Math.sqrt(50),aB=Math.sqrt(10),aP=Math.sqrt(2),aO=(t,e,i)=>{let r=1,s=t,n=Math.floor((e-1)/2),a=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?s=0:t<0&&t>=-Number.MIN_VALUE?s=-(e-1):!i&&a<1?r=aF(a).step:(i||a>1)&&(s=Math.floor(t)-n*r),r>0?(t>0?s=Math.max(s,0):t<0&&(s=Math.min(s,-(e-1)*r)),as(0,e).map(t=>s+t*r)):t>0?aR(0,-(e-1)/r,r):aR((e-1)/r,0,r)},aI=an((t,e,i,r)=>{let s,n,a,l,o=-1;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((s=e<t)&&(n=t,t=e,e=n),!isFinite(l=az(t,e,i).step))return[];if(l>0){let i=Math.round(t/l),r=Math.round(e/l);for(i*l<t&&++i,r*l>e&&--r,a=Array(n=r-i+1);++o<n;)a[o]=(i+o)*l}else if(l<0&&(null==r?void 0:r.noDecimals)){l=1;let i=Math.ceil(t),r=Math.floor(e);if(!(i<=r))return[];for(a=Array(n=r-i+1);++o<n;)a[o]=i+o}else{let i=Math.round(t*(l=-l)),r=Math.round(e*l);for(i/l<t&&++i,r/l>e&&--r,a=Array(n=r-i+1);++o<n;)a[o]=(i+o)/l}return s&&a.reverse(),a}),aR=(t,e,i)=>{let r,s,n=-1;if(i>0){let a=Math.floor(t/i),l=Math.ceil(e/i);for((a+1)*i<t&&++a,(l-1)*i>e&&--l,s=Array(r=l-a+1);++n<r;)s[n]=(a+n)*i}else{let a=Math.floor(t*(i=-i)),l=Math.ceil(e*i);for((a+1)/i<t&&++a,(l-1)/i>e&&--l,s=Array(r=l-a+1);++n<r;)s[n]=(a+n)/i}return s},aL=(t,e,i)=>{let r,s=t[0],n=t[t.length-1],a=e-t.length;if(n<=0){let e=[];for(r=a;r>=1;r--)e.push(s-r*i);return e.concat(t)}if(s>=0){for(r=1;r<=a;r++)t.push(n+r*i);return t}let l=[],o=[];for(r=1;r<=a;r++)r%2==0?l=[s-Math.floor(r/2)*i].concat(l):o.push(n+Math.ceil(r/2)*i);return l.concat(t).concat(o)},aD=an((t,e,i,r)=>{let s,n,a;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return aO(t,i,null==r?void 0:r.noDecimals);(s=e<t)&&(a=t,t=e,e=a);let l=az(t,e,i),o=l.step;if(!isFinite(o))return[];if(o>0){let r=1,{power:s,gap:a}=l,h=10===a?2*10**s:+(10**s);for(;r<=5&&(n=aR(t,e,o)).length>i+1&&i>2;)o+=h,r+=1;i>2&&n.length<i-1&&(n=aL(n,i,o))}else(null==r?void 0:r.noDecimals)&&o<0&&(o=1),n=aR(t,e,o);return s&&n.reverse(),n}),aF=t=>{let e=Math.floor(Math.log(t)/Math.LN10),i=t/10**e,r=1;return i>=aE?r=10:i>=aB?r=5:i>=aP&&(r=2),e>=0?{step:r*10**e,gap:r,power:e}:{step:-(10**-e)/r,gap:r,power:e}};function az(t,e,i){return aF((e-t)/Math.max(0,i))}function aj(t,e,i){let r;if(i*=1,(t*=1)==(e*=1)&&i>0)return[t];if(i<=0||0==(r=(e-t)/Math.max(1,i-1))||!isFinite(r))return[];let s=Array(i);for(let e=0;e<i;e++)s[e]=t+e*r;return s}function aH(t,e,i){let r,s,n=-1;if(i*=1,(s=(e*=1)<(t*=1))&&(r=t,t=e,e=r),!isFinite(i)||e-t<=i)return[t];let a=Math.floor((e-t)/i+1),l=Array(a);for(;++n<a;)l[n]=t+n*i;return s&&l.reverse(),l}function aN(t,e=10){let i,r,s=0,n=t.length-1,a=t[s],l=t[n],o=10;for(l<a&&(r=a,a=l,l=r,r=s,s=n,n=r);o-- >0;){if((r=az(a,l,e).step)===i)return t[s]=a,t[n]=l,t;if(r>0)a=Math.floor(a/r)*r,l=Math.ceil(l/r)*r;else{if(!(r<0))break;a=Math.ceil(a*r)/r,l=Math.floor(l*r)/r}i=r}}function aV(t,e){let i=tH(e.forceMin),r=tH(e.forceMax),s=null,n=[],a=null,l=i&&r?t=>t>=e.forceMin&&t<=e.forceMax:i?t=>t>=e.forceMin:r?t=>t<=e.forceMax:null;return i?n[0]=e.forceMin:tH(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(n[0]=e.min),r?n[1]=e.forceMax:tH(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(n[1]=e.max),tH(n[0])&&tH(n[1])?((a=t.slice())[0]=n[0],a[a.length-1]=n[1]):s=tH(n[0])||tH(n[1])?tH(n[0])?"max":"min":"all",{niceType:s,niceDomain:a,niceMinMax:n,domainValidator:l}}let aW=(t,e,i)=>1>Math.abs(e-t)?+i.toFixed(1):Math.round(+i),aU=an((t,e,i,r,s,n,a)=>{let l=t,o=e,h=o<l;h&&([l,o]=[o,l]);let u,d,c=s(l),p=s(o),g=[];if(!(r%1)&&p-c<i){if(c=Math.floor(c),p=Math.ceil(p),l>0){for(;c<=p;++c)for(u=1;u<r;++u)if(!((d=c<0?u/n(-c):u*n(c))<l)){if(d>o)break;g.push(d)}}else for(;c<=p;++c)for(u=r-1;u>=1;--u)if(!((d=c>0?u/n(-c):u*n(c))<l)){if(d>o)break;g.push(d)}2*g.length<i&&(g=aD(l,o,i))}else g=aD(c,p,Math.min(p-c,i)).map(n);return g=g.filter(t=>0!==t),(null==a?void 0:a.noDecimals)&&(g=Array.from(new Set(g.map(t=>Math.floor(t))))),h?g.reverse():g}),aG=an((t,e,i,r,s,n)=>{let a=[],l={},o=s(t),h=s(e),u=[];if(Number.isInteger(r))u=aD(o,h,i);else{let t=(h-o)/(i-1);for(let e=0;e<i;e++)u.push(o+e*t)}return u.forEach(i=>{let s=n(i),o=Number.isInteger(r)?aW(t,e,s):aW(t,e,aT(s)),h=aW(t,e,aC(o,[t,e]));l[h]||isNaN(h)||!(u.length>1)||(l[h]=1,a.push(h))}),a}),aZ=an((t,e,i,r,s)=>aj(r(t),r(e),i).map(t=>aT(s(t))));an((t,e,i,r,s)=>aH(r(t),r(e),i).map(t=>aT(s(t))));class a${constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:t5(this._rangeFactorStart)&&t5(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=aA(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(2===t.length&&t.every(t=>t>=0&&t<=1)&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):t5(this._rangeFactorStart)&&t5(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return et(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&(et(this._rangeFactorEnd)||1===this._rangeFactorEnd)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t,this._rangeFactorEnd=null!=(i=this._rangeFactorEnd)?i:1)),this)}rangeFactorEnd(t,e){var i;return et(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&(et(this._rangeFactorStart)||0===this._rangeFactorStart)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorEnd=t,this._rangeFactorStart=null!=(i=this._rangeFactorStart)?i:0)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);let{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,s=this.range(),n=s[0],a=s[s.length-1],l=Math.min(n,a),o=Math.max(n,a),h=eH(null!=(t=this._fishEyeOptions.focus)?t:0,l,o),u=et(r)?(o-l)*i:r,d=Math.exp(e);d=d/(d-1)*u;let c=e/u;this._fishEyeTransform=t=>{let e=Math.abs(t-h);return e>=u?t:e<=1e-6?h:h+(t-h)*(d*(1-Math.exp(-e*c))/e*.75+.25)}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var i;return null!=(i=null==this?void 0:this[t])?i:e}}function aY(t,e){let i=t.r,r=e.r,s=t.g,n=e.g,a=t.b,l=e.b,o=t.opacity,h=e.opacity;return t=>new eQ(Math.round(i*(1-t)+r*t),Math.round(s*(1-t)+n*t),Math.round(a*(1-t)+l*t),o*(1-t)+h*t)}function aX(t,e){return i=>t*(1-i)+e*i}function aK(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}RegExp(/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g.source,"g");let{LX:aq}=tL;function aQ(t,e){let i,r=typeof e;if(et(e)||"boolean"===r)return()=>e;if("number"===r)return aX(t,e);if("string"===r){if(i=eq.parseColorString(e)){let e=aq(eq.parseColorString(t),i);return t=>e(t).formatRgb()}return aX(Number(t),Number(e))}return e instanceof eQ?aq(t,e):e instanceof eq?aq(t.color,e.color):e instanceof Date?function(t,e){let i=t.valueOf(),r=e.valueOf(),s=new Date;return t=>(s.setTime(i*(1-t)+r*t),s)}(t,e):aX(Number(t),Number(e))}function aJ(t){return Number(t)}function a0(t,e){let i;return t>e&&(i=t,t=e,e=i),i=>Math.max(t,Math.min(e,i))}class a1 extends a${constructor(t=au,e=au){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=au,this._piecewise=ax,this._interpolate=aQ}calculateVisibleDomain(t){var e;return t5(this._rangeFactorStart)&&t5(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!=(e=this._niceDomain)?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),aX)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return(null!=(i=this._niceDomain)?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;let r=Array.from(t,aJ);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();let i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){let i=Array.from(t);return this._range=i,this._interpolate=aK,this.rescale(e)}rescale(t){var e;if(t)return this;let i=null!=(e=this._niceDomain)?e:this._domain,r=i.length,s=this._range.length,n=Math.min(r,s);if(r&&r<s&&this._forceAlign){let t=s-r+1,e=i[r-1],a=r>=2?(e-i[r-2])/t:0;for(let s=1;s<=t;s++)i[r-2+s]=e-a*(t-s);n=s}return this._autoClamp&&(this._clamp=a0(i[0],i[n-1])),this._piecewise=n>2?aM:ax,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:au),this.rescale(i)):this._clamp!==au}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){let e=this.ticks(t);return(null!=e?e:[]).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return et(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return et(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}class a2 extends a1{constructor(){super(...arguments),this.type=U.Linear}clone(){var t;let e=new a2;return e.domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate),this._niceType&&(e._niceType=this._niceType,e._domainValidator=this._domainValidator,e._niceDomain=null==(t=this._niceDomain)?void 0:t.slice()),e}tickFormat(){return()=>{}}d3Ticks(t=10,e){let i=this.calculateVisibleDomain(this._range);return aI(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if(tK(null==e?void 0:e.customTicks))return e.customTicks(this,t);if(t5(this._rangeFactorStart)&&t5(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(t,e);let r=null!=(i=this._niceDomain)?i:this._domain,s=this._domain,n=r[0],a=r[r.length-1],l=aD(s[0],s[s.length-1],t,e);if(!l.length)return l;if(this._domainValidator)l=l.filter(this._domainValidator);else if((l[0]!==n||l[l.length-1]!==a)&&this._niceType){let t=r.slice();if("all"===this._niceType?(t[0]=l[0],t[t.length-1]=l[l.length-1],this._niceDomain=t,this.rescale()):"min"===this._niceType&&l[0]!==n?(t[0]=l[0],this._niceDomain=t,this.rescale()):"max"===this._niceType&&l[l.length-1]!==a&&(t[t.length-1]=l[l.length-1],this._niceDomain=t,this.rescale()),"all"!==this._niceType){let e=Math.min(t[0],t[t.length-1]),i=Math.max(t[0],t[t.length-1]);l=l.filter(t=>t>=e&&t<=i)}}return l}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return aj(e[0],e[e.length-1],t)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return aH(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;let s=this._domain,n=[];if(e){let t=aV(s,e);if(n=t.niceMinMax,this._domainValidator=t.domainValidator,this._niceType=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){let e=aN(s.slice(),t);"min"===this._niceType?e[e.length-1]=null!=(i=n[1])?i:e[e.length-1]:"max"===this._niceType&&(e[0]=null!=(r=n[0])?r:e[0]),this._niceDomain=e,this.rescale()}return this}niceMin(t=10){this._niceType="min";let e=this._domain[this._domain.length-1],i=aN(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";let e=this._domain[0],i=aN(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}function a3(t,e,i=1e-10,r=1e-10){let s=i*Math.max(t,e);return Math.abs(t-e)<=Math.max(r,s)}let a5=Symbol("implicit");class a4 extends a${specified(t){var e;return t?(this._specified=Object.assign(null!=(e=this._specified)?e:{},t),this):Object.assign({},this._specified)}_getSpecifiedValue(t){if(this._specified)return this._specified[t]}constructor(){super(),this.type=U.Ordinal,this._index=new Map,this._domain=[],this._ordinalRange=[],this._unknown=a5}clone(){let t=(new a4).domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}calculateVisibleDomain(t){return t5(this._rangeFactorStart)&&t5(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:this._domain}scale(t){let e=`${t}`,i=this._getSpecifiedValue(e);if(void 0!==i)return i;let r=this._index.get(e);if(!r){if(this._unknown!==a5)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}let s=this._ordinalRange[(r-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(s):s}invert(t){let e=0;for(;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}domain(t){if(!t)return this._domain.slice();for(let e of(this._domain=[],this._index=new Map,t)){let t=`${e}`;this._index.has(t)||this._index.set(t,this._domain.push(e))}return this}range(t){if(!t)return this._ordinalRange.slice();let e=Array.from(t);return this._ordinalRange=e,this}index(t){var e;return this._index&&null!=(e=this._index.get(`${t}`))?e:-1}}function a7(t,e,i,r){let s=[],n=t;for(;n<=e;)s.push(n),n+=i;return r&&s.reverse(),s}function a6(t,e,i,r){let s,n;if(e=Math.floor(+e),t=Math.floor(+t),!(i=Math.floor(+i)))return[];if(t===e)return[t];if(s=e<t){let i=t;t=e,e=i}let a=a0(1,e-t+1)(i);if(n=Math.floor((e-t+1)/a),!r)for(;Math.ceil((e-t+1)/n)>i&&a>1;)a-=1,n=Math.floor((e-t)/a);return a7(t,e,n,s)}class a9 extends a4{constructor(t){super(),this.type=U.Band,this._range=[0,1],this._step=void 0,this._bandwidth=void 0,this._isFixed=!1,this._round=!1,this._paddingInner=0,this._paddingOuter=0,this._align=.5,this._unknown=void 0,delete this.unknown,this.rescale(t)}rescale(t,e){if(t)return this;this._wholeRange=null;let i=this._calculateWholeRange(this._range,e),r=super.domain().length,s=i[1]<i[0],n=i[Number(s)-0],a=i[1-Number(s)],l=aS(r,this._paddingInner,this._paddingOuter);return this._step=(a-n)/Math.max(1,l||1),this._round&&(this._step=Math.floor(this._step)),n+=(a-n-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(n=Math.round(n),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:s,start:s?eH(n+this._step*(r-1),i[1],i[0]):eH(n,i[0],i[1]),min:s?i[1]:i[0],max:a,count:r},this.generateFishEyeTransform(),this}scale(t){if(!this._bandRangeState)return;let e=`${t}`,i=this._getSpecifiedValue(e);if(void 0!==i)return i;let r=this._index.get(e);if(!r){if(this._unknown!==a5)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}let{count:s,start:n,reverse:a,min:l,max:o}=this._bandRangeState,h=n+(r-1)%s*(a?-1:1)*this._step;return eH(this._fishEyeTransform?this._fishEyeTransform(h):h,l,o)}_calculateWholeRange(t,e){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){var i,r,s,n,a;let e,l,o;if(t5(this._rangeFactorStart)&&t5(this._rangeFactorEnd)&&2===t.length){let i=aA(t,[this._rangeFactorStart,this._rangeFactorEnd]);e=Math.abs(i[1]-i[0])}else e=Math.abs(t[1]-t[0]);let h=(i=super.domain().length,r=e,s=this._paddingInner,n=this._paddingOuter,a=this._round,l=r/Math.max(1,aS(i,s,n)||1),a&&(l=Math.floor(l)),o=l*(1-s),a&&(o=Math.round(o)),o);h<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):h>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=h,this._isFixed=!1)}if(this.isBandwidthFixed()){let i=ak(super.domain().length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),r=Math.min((t[1]-t[0])/i,1);if(t5(this._rangeFactorStart)&&t5(this._rangeFactorEnd)){let s=this._rangeFactorStart+r<=1,n=this._rangeFactorEnd-r>=0;if("rangeFactorStart"===e&&s?this._rangeFactorEnd=this._rangeFactorStart+r:"rangeFactorEnd"===e&&n?this._rangeFactorStart=this._rangeFactorEnd-r:t[0]<=t[1]?s?this._rangeFactorEnd=this._rangeFactorStart+r:n?this._rangeFactorStart=this._rangeFactorEnd-r:(this._rangeFactorStart=0,this._rangeFactorEnd=r):n?this._rangeFactorStart=this._rangeFactorEnd-r:s?this._rangeFactorEnd=this._rangeFactorStart+r:(this._rangeFactorStart=1-r,this._rangeFactorEnd=1),i>0){let e=t[0]-i*this._rangeFactorStart;this._wholeRange=[e,e+i]}else{let e=t[1]+i*(1-this._rangeFactorEnd);this._wholeRange=[e-i,e]}}else this._rangeFactorStart=0,this._rangeFactorEnd=r,this._wholeRange=[t[0],t[0]+i];return this._wholeRange}return super._calculateWholeRange(t)}calculateWholeRangeSize(){let t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}calculateVisibleDomain(t){let e=this._domain;if(t5(this._rangeFactorStart)&&t5(this._rangeFactorEnd)&&e.length){let i=this._getInvertIndex(t[0]),r=this._getInvertIndex(t[1]);return e.slice(Math.min(i,r),Math.max(i,r)+1)}return e}domain(t,e){return t?(super.domain(t),this.rescale(e)):super.domain()}range(t,e){return t?(this._range=[aJ(t[0]),aJ(t[1])],this.rescale(e)):this._range}rangeRound(t,e){return this._range=[aJ(t[0]),aJ(t[1])],this._round=!0,this.rescale(e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return -1===t?e:a6(0,e.length-1,t,!1).map(t=>e[t])}tickData(t=10){return this.ticks(t).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0]+this._bandwidth/2)/(this._range[1]-this._range[0])}))}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return a6(0,e.length-1,t,!0).filter(t=>t<e.length).map(t=>e[t])}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return(function(t,e,i){let r;if(i=a0(1,(e=Math.floor(+e))-(t=Math.floor(+t))+1)(Math.floor(+i)),r=e<t){let i=t;t=e,e=i}return a7(t,e,i,r)})(0,e.length-1,t).map(t=>e[t])}_getInvertIndex(t){let e=0,i=this.step()/2,r=this.bandwidth()/2,s=this._domain.length,n=this.range(),a=n[0]>n[n.length-1];for(e=0;e<s;e++){var l,o,h,u;let n=this.scale(this._domain[e])+r;if(0===e&&(!a&&!(t>(l=n+i)&&!a3(t,l,void 0,void 0))||a&&!(t<(o=n-i)&&!a3(t,o,void 0,void 0)))||e===s-1)break;if(!(t<(h=n-i)&&!a3(t,h,void 0,void 0))&&!(t>(u=n+i)&&!a3(t,u,void 0,void 0)))break}return e>=0&&e<=s-1?e:s-1}invert(t){return this._domain[this._getInvertIndex(t)]}padding(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}paddingInner(t,e){return void 0!==t?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}paddingOuter(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}step(){return this._step}round(t,e){return void 0!==t?(this._round=t,this.rescale(e)):this._round}align(t,e){return void 0!==t?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}rangeFactor(t,e){return t?(super.rangeFactor(t),this.rescale(e)):super.rangeFactor()}rangeFactorStart(t,e){return et(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this.rescale(e,"rangeFactorStart"))}rangeFactorEnd(t,e){return et(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this.rescale(e,"rangeFactorEnd"))}bandwidth(t,e){return t?("auto"===t?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}maxBandwidth(t,e){return t?(this._maxBandwidth="auto"===t?void 0:t,this.rescale(e)):this._maxBandwidth}minBandwidth(t,e){return t?(this._minBandwidth="auto"===t?void 0:t,this.rescale(e)):this._minBandwidth}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}isBandwidthFixed(){return this._isFixed&&!!this._bandwidth}_isBandwidthFixedByUser(){return this._isFixed&&this._userBandwidth&&tH(this._userBandwidth)}clone(){var t,e,i;return new a9(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth(null!=(t=this._userBandwidth)?t:"auto",!0).maxBandwidth(null!=(e=this._maxBandwidth)?e:"auto",!0).minBandwidth(null!=(i=this._maxBandwidth)?i:"auto")}}class a8{constructor(){this.type=U.Threshold,this._range=[0,1],this._domain=[.5],this.n=1}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}scale(t){return!et(t)&&ee(+t)?this._range[al(this._domain,t,0,this.n)]:this._unknown}invertExtent(t){let e=this._range.indexOf(t);return[this._domain[e-1],this._domain[e]]}domain(t){return t?(this._domain=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._domain.slice()}range(t){return t?(this._range=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._range.slice()}clone(){return(new a8).domain(this._domain).range(this._range).unknown(this._unknown)}}class lt extends a4{range(t){return t?(this._range=t,this._resetRange(),this):super.range()}domain(t){return t?(super.domain(t),this._resetRange(),this):super.domain()}_resetRange(){if(!e6(this._range))return void super.range(this._range);let t=e3(this._range,this._domain);super.range(t)}}let le={linear:a2,band:a9,point:class extends a9{constructor(t){super(!1),this.type=U.Point,this._padding=0,this.paddingInner(1,t),this.padding=this.paddingOuter,this.paddingInner=void 0,this.paddingOuter=void 0}},ordinal:a4,threshold:a8,colorOrdinal:lt};function li(t){let e=le[t];return e?new e:null}function lr(t,e,i){if(!e)return t;let r=e.range(),s=i&&e._calculateWholeRange?e._calculateWholeRange(r):e.range();return Math.min(Math.max(Math.min(s[0],s[s.length-1]),t),Math.max(s[0],s[s.length-1]))}function ls(t){return t5(null==t?void 0:t.field)&&t5(null==t?void 0:t.scale)}let ln=["linear","radial","conical"],la={linear:{x0:0,y0:0,x1:1,y1:1},radial:{x0:0,y0:0,x1:1,y1:1,r0:0,r1:1},conical:{x:.5,y:.5,startAngle:0,endAngle:2*Math.PI}},ll={};Object.values(V).forEach(t=>{ll[t]=!0}),V.STATE_HOVER,V.STATE_HOVER_REVERSE,V.STATE_SELECTED,V.STATE_SELECTED_REVERSE,V.STATE_DIMENSION_HOVER,V.STATE_DIMENSION_HOVER_REVERSE;class lo extends nG{compile(){}getStateMap(){return this._stateMap}_getDefaultStateMap(){return{}}constructor(t){super(t),this.initStateMap()}initStateMap(t){this._stateMap=null!=t?t:this._getDefaultStateMap()}updateState(t,e){if(t&&(t8(this._stateMap,t),!e))return this.getCompiler().renderNextTick()}}class lh extends lo{getStateInfoList(){return this._stateInfoList}constructor(t,e){super(t),this._stateInfoList=[],this._mark=e}_getDefaultStateMap(){return{markUpdateRank:1}}getStateInfo(t){return this._stateInfoList.find(e=>e.stateValue===t)}addStateInfo(t){if(this.getStateInfo(t.stateValue))return;t.level=t.level||0;let e=!0;for(let i=0;i<this._stateInfoList.length;i++){let r=this._stateInfoList[i].level;if(r&&r>t.level){this._stateInfoList.splice(i,0,t),e=!1;break}}e&&this._stateInfoList.push(t)}_clearStateBeforeSet(t){t.datums=null,t.items=null,t.fields=null,t.filter=null}changeStateInfo(t){let e=this.getStateInfo(t.stateValue);if(e){if(void 0!==t.datums&&(this._clearStateBeforeSet(e),e.datums=t.datums,e.datumKeys=t.datumKeys),void 0!==t.items&&(this._clearStateBeforeSet(e),e.items=t.items),void 0!==t.fields)if(this._clearStateBeforeSet(e),null===t.fields)e.fields=t.fields;else for(let i in e.fields=e.fields||{},t.fields){let r=t.fields[i];e.fields[i]=e.fields[i]||{};let s=e.fields[i];t5(r.domain)&&(s.domain=r.domain),t5(r.type)&&(s.type=r.type)}t.filter&&(this._clearStateBeforeSet(e),e.filter=t.filter)}else this.addStateInfo(t)}clearStateInfo(t){t.forEach(t=>{this.getStateInfo(t)&&this.changeStateInfo({stateValue:t,datumKeys:null,datums:null,fields:null,items:null,filter:null,cache:{}})})}_isMultiMark(){var t;return!this._mark||(t=this._mark.type,nk.includes(t))}checkOneState(t,e,i){var r;let s=!1,n=!1;if(t5(i.datums)&&i.datums.length>0)s=this.checkDatumState(i,e),n=!0;else if(i.items)s=null!=(r=this.checkItemsState(i,t))&&r,n=!0;else if(i.fields)s=this.checkFieldsState(i,e,t),n=!0;else if(!s&&i.filter){let r={mark:this._mark,renderNode:t,type:this._mark.type};s=i.filter(null==e?void 0:e[0],r),n=!0}return n?s?"in":"out":"skip"}checkState(t,e){var i;let r=(null!=(i=t.context.states)?i:[]).filter(t=>!!ll[t]).map(t=>[t,10]);for(let i=0;i<this._stateInfoList.length;i++){let s=this._stateInfoList[i],n=this.checkOneState(t,e,s);"skip"!==n&&"in"===n&&r.push([s.stateValue,s.level])}return r.map(t=>t[0])}checkDatumState(t,e){let i=!1,r=e[0];if(tY(t.datums)){let e=this._isMultiMark(),s=t.datumKeys||Object.keys(t.datums[0]).filter(t=>!t.startsWith(s6));i=t.datums.some(t=>e&&tY(null==t?void 0:t.items)?s.every(e=>{var i,s;return(null==(s=null==(i=null==t?void 0:t.items)?void 0:i[0])?void 0:s[e])===(null==r?void 0:r[e])}):s.every(e=>(null==t?void 0:t[e])===(null==r?void 0:r[e])))}else if(ey(t.datums)){let e=t.datumKeys||Object.keys(t.datums).filter(t=>!t.startsWith(s6)),s=this._isMultiMark();i=e.every(e=>{var i,n;return s?(null==(i=t.datums.items)?void 0:i[0][e])===r[e]:(null==(n=t.datums)?void 0:n[e])===r[e]})}else i=e===t.datums;return i}checkItemsState(t,e){var i;return null==(i=t.items)?void 0:i.includes(e)}checkFieldsState(t,e,i){var r;let s=!0;for(let n in t.fields){let a=t.fields[n],l=a.type,o=a.domain,h=null==(r=e[0])?void 0:r[n];if(ai(l)&&o.length>1){if(this.checkLinearFieldState(o,n,e,i)){s=!1;break}s=!0}else{if(!o.some(t=>t===h)){s=!1;break}s=!0}}return s}checkLinearFieldState(t,e,i,r){var s;let n=this._isMultiMark()?null==(s=i[0])?void 0:s[e]:i[e];return n<t[0]||n>t[t.length-1]}release(){}}function lu(t){return Math.PI/180*t}function ld(t){return 180*t/Math.PI}function lc(t,e,i){return e?{x:t.x+e*Math.cos(i),y:t.y+e*Math.sin(i)}:{x:t.x,y:t.y}}function lp(t,e={x:0,y:0},i=0,r=2*Math.PI){let{x:s,y:n}=t,{x:a,y:l}=e,o=s-a,h=n-l,u=Math.sqrt(o*o+h*h);if(0===u)return{radius:0,angle:0};o/=u;let d=Math.atan2(h/=u,o);if(d<i)for(;d<=i;)d+=2*Math.PI;if(d>r)for(;d>=r;)d-=2*Math.PI;return{radius:u,angle:d}}function lg(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}var lf=i(78388);class lm extends nG{constructor(){super(...arguments),this.id=eg(),this._compiledProductId=null}getProductId(){var t;return null!=(t=this._compiledProductId)?t:this.generateProductId()}compile(t){this._compileProduct(t)}setTransform(t){this._transform=t}runTransforms(t,e){if(!t||!t.length)return e;let i=e;return t.forEach(t=>{var e;i=null==(e=ig.getGrammarTransform(t.type))?void 0:e.transform(t,i)}),i}}class ly extends lm{getProduct(){return this._product||(this._product=this.runTransforms(this._transform,this.getLatestData())),this._product}getDataView(){return this._data}setDataView(t){this._data=t}getLatestData(){var t;return null==(t=this._data)?void 0:t.latestData}constructor(t,e){super(t),this._data=null,this._data=e}removeProduct(){this._product=null,this._prevProduct=null,this._compiledProductId=null}release(){this.removeProduct(),super.release(),this._data=null}addRelatedMark(t){this._relatedMarks||(this._relatedMarks={}),this._relatedMarks[t.id]=t}updateData(t){if(this._compileProduct(),this._relatedMarks){let e=!1;if(Object.keys(this._relatedMarks).forEach(t=>{this._relatedMarks[t]&&(e=!0,this._relatedMarks[t].commit())}),!t&&e)return this.getCompiler().renderNextTick()}}_compileProduct(){this._prevProduct=this._product,this._product=null}generateProductId(){var t;return`${null==(t=this.getDataView())?void 0:t.name}`}}var l_=i(58273);function lv(t,e,i,r,s,n){let a=(e-t)*s+t,l=(i-e)*s+e,o=(r-i)*s+i,h=(l-a)*s+a,u=(o-l)*s+l,d=(u-h)*s+h;n[0]=t,n[1]=a,n[2]=h,n[3]=d,n[4]=d,n[5]=u,n[6]=o,n[7]=r}function lb(t,e){let i=t||e,r=i.length,s=i[r-2],n=i[r-1],a=[];for(let t=0;t<e.length;t+=2)a[t]=s,a[t+1]=n;return a}function lx(t){let e=0,i=0,r=0,s=t.length;for(let n=0,a=s-2;n<s;a=n,n+=2){let s=t[a],l=t[a+1],o=t[n],h=t[n+1],u=s*h-o*l;e+=u,i+=(s+o)*u,r+=(l+h)*u}return 0===e?[t[0]||0,t[1]||0,0]:[i/e/3,r/e/3,e]}function lS(t){let e=new lf.r,i=t.toString();if(!i)return[];e.fromString(i);let r=e.tryBuildCurves();if(!r||0===r.length)return[];let s=[],n=null;n=[];let a=0,l=0,o=0,h=0,u=!0;for(let t=0;t<r.length;t++){let e=r[t];if(u&&(a=e.p0.x,l=e.p0.y,o=a,h=l,n=[a,l],s.push(n),u=!1),e.p1&&e.p2&&e.p3)n.push(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y),o=e.p3.x,h=e.p3.y;else if(e.p1&&e.p2){let t=e.p1.x,i=e.p1.y,r=e.p2.x,s=e.p2.y;n.push(o+2/3*(t-o),h+2/3*(i-h),r+2/3*(t-r),s+2/3*(i-s),r,s),o=r,h=s}else if(e.p1){let t=e.p1.x,i=e.p1.y;1e-10>Math.abs(o-t)&&1e-10>Math.abs(h-i)||n.push(o,h,t,i,t,i),o=t,h=i}if(r.length,t<r.length-1){let e=r[t+1];(Math.abs(o-e.p0.x)>1e-10||Math.abs(h-e.p0.y)>1e-10)&&(u=!0)}}let d=s.filter(t=>t.length>2);return 1===d.length?[d[0]]:d}function lk(t,e){for(let i=0;i<t.length;i++){let r=t[i];for(let t=0;t<r.length;t+=2){let i=r[t],s=r[t+1],n={x:i,y:s};e.transformPoint({x:i,y:s},n),r[t]=n.x,r[t+1]=n.y}}}var lA=i(43644),lM=i(96087),lw=i(45273),lT=i(33049),lC=i(76620),lE=i(52250);function lB(t,e,i){let r,s,n=t/e;t>=e?(s=Math.ceil(Math.sqrt(i*n)),0===(r=Math.floor(i/s))&&(r=1,s=i)):(r=Math.ceil(Math.sqrt(i/n)),0===(s=Math.floor(i/r))&&(s=1,r=i));let a=[];for(let t=0;t<r;t++)a.push(s);let l=i-r*s;if(l>0)for(let t=0;t<l;t+=s)t+s<l?a.push(s):a.push(l-t);return a}let lP=(t,e)=>{let{width:i,height:r}=(0,lE.p)(t.attribute),s=lB(i,r,e),n=[],a=r/s.length;for(let t=0,e=s.length;t<e;t++){let e=s[t],r=i/e;for(let i=0;i<e;i++)n.push({x:0+i*r,y:0+t*a,width:r,height:a})}return n},lO=(t,e)=>{let i=t.getParsedAngle(),r=i.startAngle,s=i.endAngle,n=t.getComputedAttribute("innerRadius"),a=t.getComputedAttribute("outerRadius"),l=Math.abs(r-s),o=Math.abs(a-n),h=lB(l*(n+a)/2,o,e),u=[],d=o/h.length,c=a>=n?1:-1,p=s>=r?1:-1;for(let t=0,e=h.length;t<e;t++){let e=h[t],i=l/e;for(let s=0;s<e;s++)u.push({innerRadius:a-d*t*c,outerRadius:a-d*(t+1)*c,startAngle:r+i*s*p,endAngle:r+i*(s+1)*p})}return u},lI=(t,e)=>{let i=t.getComputedAttribute("startAngle"),r=t.getComputedAttribute("endAngle"),s=t.getComputedAttribute("radius"),n=Math.abs(i-r),a=lB(n*s,s,e),l=[],o=n/a[0],h=s/a.length,u=r>=i?1:-1;for(let t=0,e=a.length;t<e;t++)for(let e=0,r=a[t];e<r;e++)l.push({innerRadius:h*t,outerRadius:h*(t+1),startAngle:i+o*e*u,endAngle:i+o*(e+1)*u});return l},lR=(t,e)=>{let i=t.filter(t=>!1!==t.defined&&(0,lw.Z)(t.x)&&(0,lw.Z)(t.y));if(0===i.length)return[];if(1===i.length)return Array(e).fill(0).map(t=>i[0]);let r=[];if(e<=i.length){let t=i.length/e,s=0,n=0;for(;s<e;)r.push(i[Math.floor(n)]),n+=t,s++;return r}let s=e-i.length,n=1/(s/(i.length-1)+1),a=0;for(let e=0,i=t.length;e<i;e++)if(r.push(t[e]),e<i-1){let i=n,l=t[e].x,o=t[e].y,h=t[e+1].x,u=t[e+1].y;for(;i<1&&a<s;)r.push({x:l+(h-l)*i,y:o+(u-o)*i}),i+=n,a+=1}return r},lL=(t,e)=>{var i,r;let s=t.attribute,n=s.points,a=s.segments;n||(n=a.reduce((t,e)=>{var i;return t.concat(null!=(i=e.points)?i:[])},[]));let l=n.filter(t=>!1!==t.defined&&(0,lw.Z)(t.x)&&(0,lw.Z)(t.y));if(!l.length)return[];let o=[];l.forEach(t=>{o.push({x:t.x,y:t.y})});for(let t=l.length-1;t>=0;t--){let e=l[t];o.push({x:null!=(i=e.x1)?i:e.x,y:null!=(r=e.y1)?r:e.y})}let h=[];return lH(o,e,h),h},lD=(t,e)=>{let i=t.attribute,r=i.points;return r?lR(r,e):i.segments?lR(i.segments.reduce((t,e)=>{var i;return t.concat(null!=(i=e.points)?i:[])},[]),e):[]},lF=t=>t.map(t=>({x:t.x,y:t.y})),lz=(t,e,i)=>{let r=t.length,s=[];for(let l=0;l<r;l++){var n,a;let o=t[l],h=l===r-1?t[0]:t[l+1],u=(0,lT.Jz)([e.x,e.y],[i.x,i.y],[o.x,o.y],[h.x,h.y]);u&&"boolean"!=typeof u&&s.push({dot:(n=[u[0]-e.x,u[1]-e.x],a=[i.x-e.x,i.y-e.x],n[0]*a[1]-n[1]*a[0]),point:{x:u[0],y:u[1]},edgeIndex:l})}if(s.length<2)return[lF(t),lF(t)];s.sort((t,e)=>t.dot-e.dot);let l=s[0],o=s[s.length-1];l.edgeIndex>o.edgeIndex&&([l,o]=[o,l]);let h=l.point,u=o.point,d=[{x:h.x,y:h.y}];for(let e=l.edgeIndex+1;e<=o.edgeIndex;e++)d.push({x:t[e].x,y:t[e].y});d.push({x:u.x,y:u.y});let c=[{x:u.x,y:u.y}];for(let e=o.edgeIndex+1,i=l.edgeIndex+r;e<=i;e++){let i=t[e%r];c.push({x:i.x,y:i.y})}return c.push({x:h.x,y:h.y}),[d,c]},lj=t=>{let e=new lC.YZ;t.forEach(t=>{e.add(t.x,t.y)});let i=e.width(),r=e.height();if(i>=r){let r=e.x1+i/2;return lz(t,{x:r,y:e.y1},{x:r,y:e.y2})}let s=e.y1+r/2;return lz(t,{x:e.x1,y:s},{x:e.x2,y:s})},lH=(t,e,i)=>{if(1===e)i.push({points:t});else{let r=Math.floor(e/2),s=lj(t);lH(s[0],r,i),lH(s[1],e-r,i)}},lN=(t,e)=>{let i=t.attribute.points;if(!i||!i.length)return[];if(1===e)return[{points:lF(i)}];let r=[];return lH(i,e,r),r},lV=(t,e)=>{let i=lS(t.getParsedPathShape());if(!i.length||e<0)return[];let r=i.length;if(i.length>=e){let t=[],s=Math.floor(i.length/e);for(let n=0;n<e;n++){let a=i.slice(n*s,n===e-1?r:(n+1)*s);t.push({path:function(t){let e=new lf.r;for(let i=0;i<t.length;i++){let r=t[i];if(r.length>2){e.moveTo(r[0],r[1]);for(let t=2;t<r.length;t+=6)e.bezierCurveTo(r[t],r[t+1],r[t+2],r[t+3],r[t+4],r[t+5])}}return e}(a)})}return t}let s=[],n=Math.floor(e/r),a=e;for(let t=0;t<r;t++){let e=[];for(let r=2,s=i[t].length;r<s;r+=2)e.push({x:i[0][r],y:i[0][r+1]});lH(e,t===r-1?a:n,s),a-=n}return s};var lW=i(33760),lU=i(35652),lG=i(31535),lZ=i(84564);let l$={duration:1e3,easing:"quadInOut"},lY=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","scrollX","scrollY"],lX=t=>lY.includes(t),lK=(t,e,i)=>{t.forEach(t=>{if(Number.isFinite(t.to))e[t.key]=t.from+(t.to-t.from)*i;else if("fill"===t.key||"stroke"===t.key){let r=(0,l_.BM)(t.from,t.to,i,!1);r&&(e[t.key]=r)}})},lq=(t,e,i)=>{let r=[],s=[];e.clear();for(let n=0;n<t.length;n++){let a=t[n],l=a.from,o=a.to,h=a.rotation*i,u=a.fromCp,d=a.toCp,c=Math.sin(h),p=Math.cos(h);s[0]=u[0]+(d[0]-u[0])*i,s[1]=u[1]+(d[1]-u[1])*i;for(let t=0;t<l.length;t+=2){let e=l[t],n=l[t+1],a=e*(1-i)+o[t]*i,h=n*(1-i)+o[t+1]*i;r[t]=a*p-h*c+s[0],r[t+1]=a*c+h*p+s[1]}let g=r[0],f=r[1];e.moveTo(g,f);for(let t=2;t<l.length;t+=6){let i=r[t],s=r[t+1],n=r[t+2],a=r[t+3],l=r[t+4],o=r[t+5];g===i&&f===s&&n===l&&a===o?e.lineTo(l,o):e.bezierCurveTo(i,s,n,a,l,o),g=l,f=o}}},lQ=(t,e,i)=>{let r=t?lS(t):[],s=lS(e);i&&r&&(i.fromTransform&&lk(r,i.fromTransform.clone().getInverse()),lk(r,i.toTransfrom));let[n,a]=function(t,e){let i,r,s=[],n=[];for(let a=0;a<Math.max(t.length,e.length);a++){let l,o,h=t[a],u=e[a];h?u?([l,o]=function(t,e){let i=t.length,r=e.length;if(i===r)return[t,e];let s=[],n=[],a=i<r?t:e,l=Math.min(i,r),o=Math.abs(r-i)/6,h=Math.ceil(o/((l-2)/6)),u=[a[0],a[1]],d=o;for(let t=2;t<l;t+=6){let e=a[t-2],i=a[t-1],r=a[t],l=a[t+1],o=a[t+2],c=a[t+3],p=a[t+4],g=a[t+5];if(d<=0){u.push(r,l,o,c,p,g);continue}let f=Math.min(d,h)+1;for(let t=1;t<=f;t++){let a=t/f;lv(e,r,o,p,a,s),lv(i,l,c,g,a,n),e=s[3],i=n[3],u.push(s[1],n[1],s[2],n[2],e,i),r=s[5],l=n[5],o=s[6],c=n[6]}d-=f-1}return a===t?[u,e]:[t,u]}(h,u),i=l,r=o):(o=lb(r,h),l=h):(l=lb(i,u),o=u),s.push(l),n.push(o)}return[s,n]}(r,s);return t?function(t,e,i,r){let s,n=[];for(let i=0;i<t.length;i++){let a=t[i],l=e[i],o=lx(a),h=lx(l);null==s&&(s=o[2]<0!=h[2]<0);let u=[],d=[],c=0,p=1/0,g=[],f=a.length;s&&(a=function(t){let e=[],i=t.length;for(let r=0;r<i;r+=2)e[r]=t[i-r-2],e[r+1]=t[i-r-1];return e}(a));let m=6*function(t,e,i,r){let s=(t.length-2)/6,n=1/0,a=0,l=t.length,o=l-2;for(let h=0;h<s;h++){let s=6*h,u=0;for(let n=0;n<l;n+=2){let a=0===n?s:(s+n-2)%o+2,l=t[a]-i[0],h=t[a+1]-i[1],d=e[n]-r[0]-l,c=e[n+1]-r[1]-h;u+=d*d+c*c}u<n&&(n=u,a=h)}return a}(a,l,o,h),y=f-2;for(let t=0;t<y;t+=2){let e=(m+t)%y+2;u[t+2]=a[e]-o[0],u[t+3]=a[e+1]-o[1]}u[0]=a[m]-o[0],u[1]=a[m+1]-o[1];{let t=r/10;for(let e=-r/2;e<=r/2;e+=t){let t=Math.sin(e),i=Math.cos(e),r=0;for(let e=0;e<a.length;e+=2){let s=u[e],n=u[e+1],a=l[e]-h[0],o=l[e+1]-h[1],d=a*i-o*t,c=a*t+o*i;g[e]=d,g[e+1]=c;let p=d-s,f=c-n;r+=p*p+f*f}if(r<p){p=r,c=e;for(let t=0;t<g.length;t++)d[t]=g[t]}}}n.push({from:u,to:d,fromCp:o,toCp:h,rotation:-c})}return n}(n,a,10,Math.PI):a.map((t,e)=>({from:n[e],to:t,fromCp:[0,0],toCp:[0,0],rotation:0}))},lJ=["fill","fillOpacity","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","lineDashOffset"],l0=(t,e)=>{if(!t||!e)return null;let i=[],r=!1;return Object.keys(t).forEach(s=>{if(!lJ.includes(s))return;let n=e[s];if(!(0,lU.Z)(n)&&!(0,lU.Z)(t[s])&&n!==t[s]){if("fill"===s||"stroke"===s){let e=t=>"string"==typeof t?lA.VH.Get(t,lA.Mr.Color255):t;i.push({from:(0,lG.Z)(t[s])?t[s].map(e):e(t[s]),to:(0,lG.Z)(n)?n.map(e):e(n),key:s})}else i.push({from:t[s],to:n,key:s});r=!0}}),r?i:null};class l1 extends lZ.r{constructor(t,e,i){super({},{},e,i),this.morphingData=t.morphingData,this.otherAttrs=t.otherAttrs,this.saveOnEnd=t.saveOnEnd}getEndProps(){return{}}onBind(){this.target.createPathProxy(),this.onUpdate(!1,0,this.target.attribute)}onEnd(){}onUpdate(t,e,i){let r=this.target,s="function"==typeof r.pathProxy?r.pathProxy(r.attribute):r.pathProxy;lq(this.morphingData,s,e),this.otherAttrs&&this.otherAttrs.length&&lK(this.otherAttrs,i,e),this.target.setAttributes(i),t&&!this.saveOnEnd&&(this.target.pathProxy=null)}}let l2=(t,e,i,r)=>{var s,n,a;if(t&&(!t.valid||!t.toCustomPath))return __DEV__&&console.error(t," is not validate"),null;if(!e.valid||!e.toCustomPath)return __DEV__&&console.error(e," is not validate"),null;let l=null==t?void 0:t.globalTransMatrix;r&&l&&(l=r.clone().multiply(l.a,l.b,l.c,l.d,l.e,l.f));let o=lQ(null==(s=null==t?void 0:t.toCustomPath)?void 0:s.call(t),e.toCustomPath(),{fromTransform:l,toTransfrom:e.globalTransMatrix}),h=l0(null==t?void 0:t.attribute,e.attribute),u=e.animate(i);(null==i?void 0:i.delay)&&u.wait(i.delay);let d=new l1({morphingData:o,otherAttrs:h},null!=(n=null==i?void 0:i.duration)?n:l$.duration,null!=(a=null==i?void 0:i.easing)?a:l$.easing);return u.play(d),u},l3=(t,e,i)=>{var r;let s=e.filter(t=>t&&t.toCustomPath&&t.valid);s.length||__DEV__&&console.error(s," is not validate"),t.valid&&t.toCustomPath||__DEV__&&console.error(t," is not validate");let n=("clone"===(null==i?void 0:i.splitPath)?l6:null!=(r=null==i?void 0:i.splitPath)?r:l9)(t,s.length,!1),a=null==i?void 0:i.onEnd,l=s.length,o=()=>{0==--l&&a&&a()};s.forEach((e,r)=>{var a;let l=n[r],h=(null!=(a=null==i?void 0:i.delay)?a:0)+((null==i?void 0:i.individualDelay)?i.individualDelay(r,s.length,l,e):0);l2(l,e,Object.assign({},i,{onEnd:o,delay:h}),t.globalTransMatrix)})};class l5 extends lZ.r{constructor(t,e,i){super({},{},e,i),this.morphingData=t.morphingData,this.otherAttrs=t.otherAttrs}getEndProps(){return{}}onBind(){this.addPathProxy()}addPathProxy(){this.target.shadowRoot.forEachChildren(t=>{t.createPathProxy()}),this.onUpdate(!1,0,this.target.attribute)}clearPathProxy(){this.target.shadowRoot.forEachChildren(t=>{t.pathProxy=null})}onEnd(){}onUpdate(t,e,i){this.target.shadowRoot.forEachChildren((t,i)=>{var r;lq(this.morphingData[i],"function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy,e),(null==(r=this.otherAttrs)?void 0:r[i])&&this.otherAttrs[i].length&&lK(this.otherAttrs[i],t.attribute,e)}),t&&(this.clearPathProxy(),this.morphingData=null)}}let l4=t=>{let e={};return Object.keys(t).forEach(i=>{lX(i)||(e[i]=t[i])}),e},l7=(t,e,i)=>{let r=l4(t.attribute),s=t.attachShadow();if(e.length)s.setTheme({[e[0].type]:r}),e.forEach(t=>{t.setAttributes({pickable:!1}),s.appendChild(t)});else{let n=t.AABBBounds,a=n.width(),l=n.height();s.setTheme({rect:r}),Array(i).fill(0).forEach(t=>{let i=lM.w.graphicService.creator.rect({x:0,y:0,width:a,height:l,pickable:!1});s.appendChild(i),e.push(i)})}},l6=(t,e,i)=>{let r=[],s=i?null:l4(t.attribute),n=t.toCustomPath();for(let t=0;t<e;t++){let t={path:(new lf.r).fromCustomPath2D(n)};r.push(lM.w.graphicService.creator.path(i?t:Object.assign({},s,t)))}return i&&l7(t,r,e),r},l9=(t,e,i)=>{let r=[],s=i?null:l4(t.attribute);if("rect"===t.type)lP(t,e).forEach(t=>{r.push(lM.w.graphicService.creator.rect(i?t:Object.assign({},s,t)))});else if("arc"===t.type)lO(t,e).forEach(t=>{r.push(lM.w.graphicService.creator.arc(i?t:Object.assign({},s,t)))});else if("circle"===t.type)lI(t,e).forEach(t=>{r.push(lM.w.graphicService.creator.arc(i?t:Object.assign({},s,t)))});else if("line"===t.type){let n=lD(t,e),a={size:10,symbolType:"circle"};n.forEach(t=>{r.push(lM.w.graphicService.creator.symbol(i?Object.assign({},t,a):Object.assign({},s,t,a)))})}else"polygon"===t.type?lN(t,e).forEach(t=>{r.push(lM.w.graphicService.creator.polygon(i?t:Object.assign({},s,t)))}):"area"===t.type?lL(t,e).forEach(t=>{r.push(lM.w.graphicService.creator.polygon(i?t:Object.assign({},s,t)))}):"path"===t.type&&lV(t,e).forEach(t=>{"path"in t?r.push(lM.w.graphicService.creator.path(i?t:Object.assign({},s,t))):r.push(lM.w.graphicService.creator.polygon(i?t:Object.assign({},s,t)))});return i&&l7(t,r,e),r},l8=(t,e,i)=>{var r,s,n;let a=t.filter(t=>t.toCustomPath&&t.valid);a.length||__DEV__&&console.error(t," is not validate"),e.valid&&e.toCustomPath||__DEV__&&console.error(e," is not validate");let l=("clone"===(null==i?void 0:i.splitPath)?l6:null!=(r=null==i?void 0:i.splitPath)?r:l9)(e,a.length,!0),o=e.attribute;e.setAttribute("visible",!1);let h=a.map((t,e)=>lQ(t.toCustomPath(),l[e].toCustomPath(),{fromTransform:t.globalTransMatrix,toTransfrom:l[e].globalTransMatrix})),u=a.map((t,e)=>l0(t.attribute,o));if(null==i?void 0:i.individualDelay){let r=i.onEnd,s=a.length,n=()=>{0==--s&&(e.setAttributes({visible:!0,ratio:null},!1,{type:lW.Gk.ANIMATE_END}),e.detachShadow(),r&&r())};l.forEach((e,r)=>{var s,l,o;let d=(null!=(s=i.delay)?s:0)+i.individualDelay(r,a.length,t[r],e),c=e.animate(Object.assign({},i,{onEnd:n}));c.wait(d),c.play(new l1({morphingData:h[r],saveOnEnd:!0,otherAttrs:u[r]},null!=(l=i.duration)?l:l$.duration,null!=(o=i.easing)?o:l$.easing))})}else{let t=null==i?void 0:i.onEnd,r=i?Object.assign({},i):{};r.onEnd=()=>{e.setAttribute("visible",!0,!1,{type:lW.Gk.ANIMATE_END}),e.detachShadow(),t&&t()};let a=e.animate(r);(null==i?void 0:i.delay)&&a.wait(i.delay),a.play(new l5({morphingData:h,otherAttrs:u},null!=(s=null==i?void 0:i.duration)?s:l$.duration,null!=(n=null==i?void 0:i.easing)?n:l$.easing))}},ot=(t,e,i,r)=>"function"==typeof t?t(e,i,r):t,oe=(t,e,i,r,s)=>{var n;let a={prev:t.map(t=>{var e,i;return null==(i=null==(e=t.context)?void 0:e.data)?void 0:i[0]}),next:e.map(t=>{var e,i;return null==(i=null==(e=t.context)?void 0:e.data)?void 0:i[0]})},l={prev:t.slice(),next:e.slice()},o=null!=(n=i.animation)?n:{},h=o.easing,u=ot(o.delay,s,a,l),d=ot(o.duration,s,a,l),c=ot(o.oneByOne,s,a,l),p=ot(o.splitPath,s,a,l),g=ee(c)&&c>0?t=>tH(c)?t*c:!0===c?t*d:0:void 0;1!==t.length&&0!==t.length||1!==e.length?1===t.length&&e.length>1?l3(t[0],e,{delay:u,duration:d,easing:h,onEnd:r,individualDelay:g,splitPath:p}):t.length>1&&1===e.length&&l8(t,e[0],{delay:u,duration:d,easing:h,onEnd:r,individualDelay:g,splitPath:p}):l2(t[0],e[0],{delay:u,duration:d,easing:h,onEnd:r})},oi=(t,e)=>{let i=Math.floor(t.length/e);return Array(e).fill(0).map((r,s)=>t.slice(i*s,s===e-1?t.length:i*(s+1)))},or=t=>{let e=t.getMarkConfig();t5(e.morphElementKey)&&t.getGraphics().forEach(t=>{var i,r;let s=null==(r=null==(i=t.context)?void 0:i.data)?void 0:r[0];s&&(t.context.morphKey=s[e.morphElementKey])})},os=(t,e,i={})=>{let r=[],s=[];t.forEach(t=>{or(t),r.push(...t.getGraphics())}),e.forEach(t=>{or(t),s.push(...t.getGraphics())});let n=t=>{var e,i,r;return null!=(i=null==(e=t.context)?void 0:e.morphKey)?i:null==(r=t.context)?void 0:r.key},a=new Map,l=new Map;if(r.forEach(t=>{let e=n(t);e&&(a.has(e)||a.set(e,[]),a.get(e).push(t))}),s.forEach(t=>{let e=n(t);e&&(l.has(e)||l.set(e,[]),l.get(e).push(t))}),a.size!==l.size||!Array.from(a.keys()).every(t=>l.has(t)))return!1;let o=[...new Set([...a.keys()].filter(t=>l.has(t)))],h=[...l.keys()].filter(t=>!a.has(t)),u=0,d=()=>{0==(u-=1)&&e.forEach(t=>{})};return h.forEach(t=>{oe([],l.get(t),i,d,{}),u+=1}),o.forEach(t=>{let e=a.get(t),r=l.get(t),s=Math.min(e.length,r.length);if(s>0){let t=oi(e,s),n=oi(r,s);for(let e=0;e<s;e++)oe(t[e],n[e],i,d,{}),u+=1}}),0===u&&d(),!0};var on=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class oa extends lm{commit(t,e){e&&this.getMarks().length>0&&this.getMarks().forEach(t=>t.commit(!1,e)),this._isCommited=!0,t&&this.getCompiler().renderNextTick()}uncommit(){this._isCommited=!1}isCommited(){return this._isCommited}getMarkConfig(){return this._markConfig}setMarkConfig(t){Object.keys(t).forEach(e=>{this._markConfig[e]=t[e]})}getVisible(){return this._visible}setVisible(t){this._visible=t}getUserId(){return this._userId}setUserId(t){t5(t)&&(this._userId=t)}getDataView(){var t;return null==(t=this._data)?void 0:t.getDataView()}setDataView(t){et(this._data)&&this.initMarkData(this._option),this._data.setDataView(t)}getData(){return this._data}setData(t){this._data=t,t&&t.addRelatedMark(this)}hasState(t){return t in this.state.getStateMap()}getState(t){return this.state.getStateMap()[t]}getAnimationConfig(){return this._animationConfig}setAnimationConfig(t){let e="group"===this.type?{selfOnly:!0}:{},i=t=>{var i;let r=null!=(i=t.options)?i:{};return Object.assign(Object.assign(Object.assign({},e),t),{options:(t,e,i)=>{var s,n;let a="function"==typeof r?r(t,e,i):r;if(e&&e.context&&e.context.compiler&&t5(e.context.modelId)){let t=null==(s=e.context.compiler.getChart())?void 0:s.getModelById(e.context.modelId);return Object.assign(Object.assign({},a),{layoutRect:null==(n=null==t?void 0:t.getLayoutRect)?void 0:n.call(t)})}return Object.assign({},a)}})},r={};Object.keys(t).forEach(e=>{let s=t[e];tY(s)?r[e]=s.map(i):t5(s)&&(r[e]=i(s))}),this._animationConfig=r}disableAnimationByState(t){let e=eo(t);this._disabledAnimationStates=[...new Set([...this._disabledAnimationStates,...e])]}enableAnimationByState(t){let e=eo(t);this._disabledAnimationStates=this._disabledAnimationStates.filter(t=>!e.includes(t))}setSkipBeforeLayouted(t){this._skipBeforeLayouted=t}setGroupKey(t){this._groupKey=t}getProduct(){return this._product}initMarkData(t){this._data=new ly(t),this._data.addRelatedMark(this)}_compileProduct(t){this.commit(),this._context=null==t?void 0:t.context;let e=this.getProduct();if(this._visible){if(t5(e))t.group&&e.parent!==t.group&&t.group.appendChild(e);else{if(!this.getCompiler().isInited)return;this._initProduct(null==t?void 0:t.group)}et(this._product)||(this.compileData(),this.compileState(),this.compileEncode())}else t5(e)&&this.removeProduct()}_initProduct(t){var e;if(!this.getStage())return;let i=this.getProductId();this._product=(0,s4.sS)("group"!==this.type?{pickable:!1,zIndex:this._markConfig.zIndex,overflow:this._markConfig.overflow}:{}),this._product.name=i,this._product.mark=this,(null!=t?t:null==(e=this.getCompiler())?void 0:e.getRootGroup()).appendChild(this._product),this._compiledProductId=i}generateProductId(){return this._userId?`${this._userId}`:`${this.name}_${this.id}`}layout(t){}compileData(){et(this._data)||this._data.compile()}compileEncode(){}compileState(){}compileAnimation(){}compileContext(t){this._context=Object.assign({markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId},t)}getContext(){return this._context}compileTransform(){}updateState(t,e){return this.commit(),this.state.updateState(t,e)}getMarks(){return[]}runAnimationByState(t){}stopAnimationByState(t){}pauseAnimationByState(t){}resumeAnimationByState(t){}removeProduct(){this._product&&this._product.parent&&this._product.parent.removeChild(this._product),this._product=null,this._compiledProductId=null}release(){this.state.release(),super.release(),this._lastMark=null}setSimpleStyle(t){this._simpleStyle=t}getSimpleStyle(){return this._simpleStyle}constructor(t,e){var i;super(e),this.type=void 0,this.name="mark",this._markConfig={zIndex:z.Mark,morph:!1},this._visible=!0,this.stateStyle={},this._unCompileChannel={},this._disabledAnimationStates=[],this._skipBeforeLayouted=!1,this._extensionChannel={},this._computeExChannel={},this._graphicMap=new Map,this._graphics=[],this._getEncoderOfStyle=(t,e)=>{if(e&&t){let i={};return Object.keys(e).forEach(e=>{this._unCompileChannel[e]||(i[e]=this._computeAttribute(e,t))}),i}return null},this._setGraphicFromMarkConfig=t=>{let{setCustomizedShape:e,graphicName:i}=this._markConfig;e&&(t.pathProxy=i=>e(t.context.data,i,new lf.r)),i&&(tK(i)?t.name=i(t):t.name=i)},this._setStateOfGraphic=t=>{t.clearStates(),t.stateProxy=null,t.context.diffState!==N.enter&&t.context.diffState!==N.update||(t.stateProxy=(e,i)=>{var r;return this._runEncoderOfGraphic(null==(r=this._encoderOfState)?void 0:r[e],t)},t.context.states&&t.useStates(t.context.states))},this.name=t,this.model=e.model,this.key=e.key,this.state=new lh(e,this),this._attributeContext=e.attributeContext,null==(i=e.map)||i.set(this.id,this)}created(){this._initStyle()}initStyleWithSpec(t){t&&(t5(t.id)&&(this._userId=t.id),t$(t.interactive)&&(this._markConfig.interactive=t.interactive),t5(t.zIndex)&&(this._markConfig.zIndex=t.zIndex),t$(t.visible)&&this.setVisible(t.visible),this._markConfig.setCustomizedShape=t.customShape,this._stateSort=t.stateSort,this._initSpecStyle(t))}_transformStyleValue(t,e){if(t.scale){let i=t.scale,r=i.range();return i.range(r.map(e)),t}return"function"==typeof t?(...i)=>e(t(...i)):e(t)}convertAngleToRadian(t){return this._transformStyleValue(t,lu)}isUserLevel(t){return[H.User_Mark,H.User_Series,H.User_Chart,H.User_SeriesStyle].includes(t)}setStyle(t,e="normal",i=0){if(et(t))return;void 0===this.stateStyle[e]&&(this.stateStyle[e]={});let r=this.isUserLevel(i);Object.keys(t).forEach(s=>{let n=t[s];et(n)||(n=this._filterAttribute(s,n,e,i,r),this.setAttribute(s,n,e,i))})}getStyle(t,e="normal"){var i;return null==(i=this.stateStyle[e][t])?void 0:i.style}_filterAttribute(t,e,i,r,s){let n=this._styleConvert(e);if(s)switch(t){case"angle":n=this.convertAngleToRadian(n);break;case"innerPadding":case"outerPadding":n=this._transformStyleValue(n,t=>-t);break;case"curveType":n=this._transformStyleValue(n,t=>{var e;return e=this._option.model.direction,"monotone"===t?"horizontal"===e?"monotoneY":"monotoneX":t})}return n}setReferer(t,e,i){var r;if(t)if(e&&i){let s=null!=(r=this.stateStyle[i])?r:{[e]:{}};this.stateStyle[i][e]=Object.assign(Object.assign({},s[e]),{referer:t})}else Object.entries(this.stateStyle).forEach(([e,i])=>{Object.entries(i).forEach(([i,r])=>{this.stateStyle[e][i].referer=t})})}setPostProcess(t,e,i="normal"){var r;(null==(r=this.stateStyle[i])?void 0:r[t])&&(this.stateStyle[i][t].postProcess=e)}getAttribute(t,e,i="normal"){return this._computeAttribute(t,i)(e)}getAttributesOfState(t,e="normal"){let i=this.stateStyle[e];if(i){let r={};return Object.keys(i).forEach(i=>{this._unCompileChannel[i]||(r[i]=this._computeAttribute(i,e)(t))}),r}}setAttribute(t,e,i="normal",r=0){var s;void 0===this.stateStyle[i]&&(this.stateStyle[i]={}),void 0===this.stateStyle[i][t]&&(this.stateStyle[i][t]={level:r,style:e,referer:void 0});let n=null==(s=this.stateStyle[i][t])?void 0:s.level;t5(n)&&n<=r&&it(this.stateStyle[i][t],{style:e,level:r}),"normal"!==i&&t in this._extensionChannel&&this._extensionChannel[t].forEach(t=>{void 0===this.stateStyle[i][t]&&(this.stateStyle[i][t]=this.stateStyle.normal[t])})}_getDefaultStyle(){return{visible:!0,x:0,y:0}}_styleConvert(t){if(!t)return t;if(ae[t.type]||t.scale){let e=function(t,e){var i,r;if("scale"in t&&t.scale)return t3(t.scale)&&(null==e?void 0:e.globalScale)?e.globalScale.registerMarkAttributeScale(t,e.seriesId):t.scale;let s=li(t.type);return s&&(i=s,r=t,i&&r&&(r.domain&&i.domain(r.domain),r.range&&i.range(r.range),r.specified&&i.specified&&i.specified(r.specified),r.clamp&&i.clamp&&i.clamp(r.clamp))),s}(t,{globalScale:this._option.globalScale,seriesId:this._option.seriesId});if(e)return{scale:e,field:t.field,changeDomain:t.changeDomain}}return t}_computeAttribute(t,e){var i;let r=null==(i=this.stateStyle[e])?void 0:i[t];r||(r=this.stateStyle.normal[t]);let s=this._computeStateAttribute(r,t,e),n=tK(null==r?void 0:r.postProcess),a=t in this._computeExChannel;if(n&&a){let i=this._computeExChannel[t];return n=>{let a=s(n);return a=r.postProcess(a,n,this._attributeContext,this.getDataView()),i(t,n,e,a)}}if(n)return t=>r.postProcess(s(t),t,this._attributeContext,this.getDataView());if(a){let i=this._computeExChannel[t];return r=>i(t,r,e,s(r))}return s}_computeStateAttribute(t,e,i){var r;return t?t.referer?t.referer._computeAttribute(e,i):t.style?"function"==typeof t.style?e=>t.style(e,this._attributeContext,{mark:this},this.getDataView()):ln.includes(t.style.gradient)?this._computeGradientAttr(t.style):["outerBorder","innerBorder"].includes(e)?this._computeBorderAttr(t.style):ae[null==(r=t.style.scale)?void 0:r.type]?e=>{let i=e;return"series"===this.model.modelType&&this.model.getMarkData&&(i=this.model.getMarkData(e)),t.style.scale.scale(i[t.style.field])}:e=>t.style:e=>t.style:t=>{}}_initStyle(){let t=this._getDefaultStyle();this.setStyle(t,"normal",0)}_initSpecStyle(t){t.style&&this.setStyle(t.style,"normal",H.User_Mark);let e=t.state;e&&Object.keys(e).forEach(t=>{let i=e[t];if("style"in i){let e=i.style,r={stateValue:t};"level"in i&&(r.level=i.level),"filter"in i&&(r=tK(i.filter)?Object.assign({filter:i.filter},r):Object.assign(Object.assign({},i.filter),r)),this.state.addStateInfo(r),this.setStyle(e,t,H.User_Mark)}else this.setStyle(i,t,H.User_Mark)})}_computeGradientAttr(t){var e,i;let{gradient:r,scale:s,field:n}=t,a=on(t,["gradient","scale","field"]),l=s,o=n;if(!(s&&n||"series"!==this.model.modelType)){let{scale:t,field:e}=this.model.getColorAttribute();s||(l=t),o||(o=e)}let h=e3(e2(this.model.getColorScheme(),"series"===this.model.modelType?null==(i=(e=this.model).getSpec)?void 0:i.call(e):void 0),this.model.getDefaultColorDomain()),u=Object.assign(Object.assign({},la[r]),a);return t=>{let e={},i=this.getDataView();return Object.keys(u).forEach(r=>{let s=u[r];"stops"===r?e.stops=s.map(e=>{let{opacity:r,color:s,offset:n}=e,a=null!=s?s:null==l?void 0:l.scale(t[o]);return tK(s)&&(a=s(t,this._attributeContext,i)),t5(r)&&(a=eq.SetOpacity(a,r)),{offset:tK(n)?n(t,this._attributeContext,i):n,color:a||h[0]}}):tK(s)?e[r]=s(t,this._attributeContext,i):e[r]=s}),e.gradient=r,e}}_computeBorderAttr(t){let{scale:e,field:i}=t,r=on(t,["scale","field"]);return t=>{var s,n,a;let l={};if(Object.keys(r).forEach(e=>{let i=r[e];tK(i)?l[e]=i(t,this._attributeContext,this.getDataView()):l[e]=i}),"stroke"in l)ln.includes(null==(a=r.stroke)?void 0:a.gradient)&&(l.stroke=this._computeGradientAttr(r.stroke)(t));else{let r=e3(e2(this.model.getColorScheme(),"series"===this.model.modelType?null==(n=(s=this.model).getSpec)?void 0:n.call(s):void 0),this.model.getDefaultColorDomain()),a=e,o=i;if(!(e&&i||"series"!==this.model.modelType)){let{scale:i,field:s}=this.model.getColorAttribute();e||(a=i),o||(o=s),l.stroke=(null==a?void 0:a.scale(t[o]))||r[0]}}return l}}_getDataByKey(t){return nA(t,(t,e)=>{var i;return`${this._groupKeyGetter(t)}_${null!=(i=this._keyGetter(t))?i:e}`})}_getCommonContext(){return{compiler:this.getCompiler(),markType:this.type,markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId}}prepareMorph(t){this._lastMark=t}reuse(t){this.type===t.type&&(this._product=t.getProduct(),this._graphics=t.getGraphics(),this._graphicMap=t._graphicMap,this._graphicMap.forEach(t=>{t.context=Object.assign(Object.assign({},t.context),this._getCommonContext())}),this._dataByKey=t._dataByKey,this._prevDataByKey=t._prevDataByKey,this.needClear=t.needClear)}_parseProgressiveContext(t){let e=this._markConfig.progressiveStep>0&&this._markConfig.progressiveThreshold>0&&this._markConfig.progressiveStep<this._markConfig.progressiveThreshold,i=this._markConfig.large&&this._markConfig.largeThreshold>0&&t.length>=this._markConfig.largeThreshold;if(e){let e=this._dataByGroup;return e&&e.keys&&e.keys.some(t=>e.data.get(t).length>this._markConfig.progressiveThreshold)?{large:i,progressive:{data:t,step:this._markConfig.progressiveStep,currentIndex:0,totalStep:e.keys.reduce((t,i)=>Math.max(Math.ceil(e.data.get(i).length/this._markConfig.progressiveStep),t),1),groupedData:e.data}}:{large:i}}return{large:i}}getGraphics(){return this._graphics}_createGraphic(t={}){return ig.createGraphicComponent(this.type,t)}_runGroupData(t){this._keyGetter=tK(this.key)?this.key:t5(this.key)?t=>null==t?void 0:t[this.key]:t=>null==t?void 0:t[ni],this._groupKeyGetter=t5(this._groupKey)?t=>`${null==t?void 0:t[this._groupKey]}`:()=>"key",this._dataByGroup=nA(t,this._groupKeyGetter)}createAnimationStateList(t,e){var i;let r=e[t];return r&&Array.isArray(r)&&(r=1===r.length?r[0]:r),Array.isArray(r)?r.map((t,e)=>{var i;return Object.assign(Object.assign({},t),{priority:null!=(i=t.priority)?i:1/0})}):r?Object.assign(Object.assign({},r),{priority:"normal"===t?null!=(i=r.priority)?i:1/0:r.priority}):r}tryRunMorphing(t){if(this._lastMark){t.forEach(t=>{"appear"!==t.context.animationState&&"enter"!==t.context.animationState||t.setAttributes(t.getAttributes(!0))});let e=os([this._lastMark],[this],{});return this._lastMark=null,e}return!1}_runStateAnimation(t){var e,i;if(!this._animationConfig||0===t.length||this.tryRunMorphing(t))return;let r=this.getAnimationConfig();if(null!=(e=this._markConfig.useSequentialAnimation)&&e&&this._runSequentialAnimations)return void this._runSequentialAnimations(t);let s=t.every(t=>"appear"===t.context.animationState),n=this.createAnimationStateList("appear",r);if(s&&this._product){let t=n?["appear"]:[],e=n?[{name:"appear",animation:n}]:[];if(r.normal){t.push("normal");let i={name:"normal",animation:this.createAnimationStateList("normal",r)};e.push(i)}this._product.applyAnimationState(t,e)}let a=!1;if(t.forEach(t=>{let e=t.context.animationState;if("appear"===e)return;let i=r[e];if(i&&i.length>0){let r=i.map((t,i)=>({name:`${e}_${i}`,animation:t}));r.forEach(e=>{e.animation.customParameters=t.context});let s=[e];t.applyAnimationState(s,[1===r.length?r[0]:r])}"enter"===e&&r.normal&&(a=!0)}),a&&this._product&&(null==(i=r.normal)?void 0:i.length)){this._product.stopAnimationState("normal","start");let t={name:"normal",animation:this.createAnimationStateList("normal",r)};this._product.applyAnimationState(["normal"],[t])}}_setAnimationState(t){var e,i,r;let s=(("component"===this.type?this.model.getAnimationStateCallback():null==(r=null==(i=(e=this.model).getRegion)?void 0:i.call(e))?void 0:r.getAnimationStateCallback())||(t=>{var e;let i=null==(e=t.context)?void 0:e.diffState;return i===D.exit?D.exit:i===D.update?D.update:D.appear}))(t);t.context.animationState=null!=s?s:t.context.diffState,t.context.animationState===N.exit&&(t.context.reusing=!0,t.animates&&t.animates.forEach(t=>t.stop()))}_runJoin(t){let e=this._getDataByKey(t),i=this._prevDataByKey,r=[],s=new Set(this._graphics.filter(t=>t.context.diffState===N.enter)),n=(t,e,i)=>{var n,a,l,o,h,u,d,c,p;let g,f;return et(e)?(g=this._graphicMap.get(t))&&(f=N.exit):et(i)?(g=this._graphicMap.has(t)?this._graphicMap.get(t):{},f=N.enter,g.isExiting=!1,this._graphicMap.set(t,g),r.push(g)):(g=this._graphicMap.get(t))&&(f=N.update,r.push(g)),g&&(s.delete(g),g.context=Object.assign(Object.assign({},this._getCommonContext()),{diffState:f,reusing:null==(n=g.context)?void 0:n.reusing,originalFieldX:null==(a=g.context)?void 0:a.originalFieldX,originalFieldY:null==(l=g.context)?void 0:l.originalFieldY,fieldX:null==(o=g.context)?void 0:o.fieldX,fieldY:null==(h=g.context)?void 0:h.fieldY,data:null!=e?e:null==(u=g.context)?void 0:u.data,uniqueKey:t,key:e?this._keyGetter(e[0]):null==(d=g.context)?void 0:d.key,groupKey:e?this._groupKeyGetter(e[0]):null==(c=g.context)?void 0:c.groupKey,indexKey:"__VCHART_DEFAULT_DATA_INDEX",stateAnimateConfig:null==(p=this.getAnimationConfig())?void 0:p.state}),this._setAnimationState(g)),g};if(i&&e){let t=new Map(i.data);e.keys.forEach(i=>{n(i,e.data.get(i),t.get(i)),t.delete(i)}),i.keys.forEach(e=>{t.has(e)&&n(e,null,t.get(e))})}else e?e.keys.forEach(t=>{let i=n(t,e.data.get(t),null);i&&(i.context.animationState=D.appear)}):i&&i.keys.forEach(t=>{n(t,null,i.data.get(t)).context.animationState=D.disappear});s.forEach(t=>{this._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release()});let a=r.length;r.forEach((t,e)=>{t.context.graphicCount=a,t.context.graphicIndex=e}),this._dataByKey=e,this._graphics=r,this.needClear=!0}_runEncoderOfGraphic(t,e,i={}){return nM(t,e.context.data[0],i)}_runGroupEncoder(t){if(!this._dataByGroup)return null;let e={};return this._dataByGroup.keys.forEach(i=>{e[i]=nM(t,this._dataByGroup.data.get(i)[0])}),this._attrsByGroup=e,e}_transformGraphicAttributes(t,e,i){return Object.assign(Object.assign({},i),e)}_separateNormalStyle(t){let e={},i={};return Object.keys(t).forEach(r=>{this._unCompileChannel[r]||(this._option.noSeparateStyle||function(t,e,i){var r,s,n;let a=null==(r=e[t])?void 0:r.style;return s=t,n=a,!!(("fill"===s||"stroke"===s)&&(null==n?void 0:n.gradient)&&(null==n?void 0:n.stops)||tK(a))||!(!(null==a?void 0:a.scale)||a.field===i)}(r,t,this._groupKey)?e[r]=t[r]:i[r]=t[r])}),{updateStyles:e,groupStyles:i}}_addProgressiveGraphic(t,e){t.incrementalAppendChild(e)}_runEncoder(t,e){var i;let r=e?null:this._runGroupEncoder(null==(i=this._encoderOfState)?void 0:i.group);t.forEach((t,e)=>{var i;let s=this._runEncoderOfGraphic(null==(i=this._encoderOfState)?void 0:i.update,t);et(this._markConfig.interactive)||(s.pickable=this._markConfig.interactive);let n=this._transformGraphicAttributes(t,s,null==r?void 0:r[t.context.groupKey]);t.context.finalAttrs=n})}_runApplyGraphic(t){let e=this.hasAnimation();t.forEach((i,r)=>{var s;let n=i.context.finalAttrs,a=this.hasAnimationByState(i.context.animationState);if(i.setAttributes){let t=iU(i,n);i.context.diffAttrs=t,i.context.reusing?(i.context.lastAttrs=i.attribute,i.initAttributes({}),i.context.reusing=!1):a||(e?i.setAttributesAndPreventAnimate(t):i.setAttributes(t)),e&&i.setFinalAttributes(n)}else{let a=i;i=this._createGraphic(n),e&&i.setFinalAttributes(n),i.context=a.context,i.context.diffAttrs=n;let l=this._graphics===t?r:r+this._graphics.length-t.length;if(l>=0&&(this._graphics[l]=i),null==(s=this.renderContext)?void 0:s.progressive){let t=this._dataByGroup?this._dataByGroup.keys.indexOf(i.context.groupKey):0,e=t>=0?this._product.getChildAt(t):null;e&&this._addProgressiveGraphic(e,i)}else this._product.appendChild(i),this._graphicMap.set(i.context.uniqueKey,i)}this._setStateOfGraphic(i),this._setGraphicFromMarkConfig(i)})}_updateEncoderByState(){let t={};Object.keys(this.stateStyle).forEach(e=>{if(e===V.STATE_NORMAL){let{groupStyles:i,updateStyles:r}=this._separateNormalStyle(this.stateStyle[e]);t.group=this._getEncoderOfStyle(e,i),t.update=this._getEncoderOfStyle(e,r)}else t[e]=this._getEncoderOfStyle(e,this.stateStyle[e])}),this._encoderOfState=t}_runState(t){t.forEach(t=>{var e;let i=[...(null!=(e=t.currentStates)?e:[]).filter(t=>!this.state.getStateInfo(t)),...this.state.checkState(t,t.context.data)];this._stateSort&&i.length&&i.sort(this._stateSort),t.context.states=i})}_getAttrsFromConfig(t={}){let{zIndex:e,clip:i,clipPath:r,overflow:s}=this._markConfig;if(et(e)||(t.zIndex=e),et(i)||(t.clip=i),!et(r)){let e=tY(r)?r:r(this._graphics);e&&e.length||(t.clip=!1),t.path=e}return et(s)||(t.overflow=s),t}_updateAttrsOfGroup(){var t;let e=this._getAttrsFromConfig();null==(t=this._product)||t.setAttributes(e),this._markConfig.support3d&&this._product&&this._product.setMode("3d")}_runBeforeTransform(t){var e;let i=null==(e=this._transform)?void 0:e.filter(t=>{if(t.type){let e=ig.getGrammarTransform(t.type);return e&&(!e.runType||"beforeJoin"===e.runType)}return!1});return this.runTransforms(i,t)}_runEncoderTransform(t,e){var i;let r=null==(i=this._transform)?void 0:i.filter(t=>{if(t.type){let i=ig.getGrammarTransform(t.type);return i&&"afterEncode"===i.runType&&!!i.canProgressive===e}return!1});return this.runTransforms(r,t)}renderInner(){var t,e,i;let r;this._updateEncoderByState();let s=null!=(e=null==(t=this._data)?void 0:t.getProduct())?e:[{}],n=this._runBeforeTransform(s);if(null==n?void 0:n.progressive){this.renderContext={beforeTransformProgressive:n.progressive};let t=n.progressive;if(t.canAnimate&&t.canAnimate()&&t.unfinished())return void this._updateAttrsOfGroup();r=t.output()}else r=eo(n),this._runGroupData(r),this.renderContext=this._parseProgressiveContext(r);(null==(i=this.renderContext)?void 0:i.progressive)?(this._graphicMap.clear(),this._runProgressiveStep()):(this._runJoin(r),this._runState(this._graphics),this._runEncoder(this._graphics),this._runEncoderTransform(this._graphics,!1),this._runApplyGraphic(this._graphics)),this._updateAttrsOfGroup()}render(){this.isCommited()&&(!this.getVisible()||this._skipBeforeLayouted&&this.getCompiler().getLayoutState()===F.before||(eO(`render mark: ${this.getProductId()}, type is ${this.type}`),this.renderInner()),this.uncommit())}updateMarkState(t){if(!this._product)return;let e=this.state.getStateInfo(t);this._graphics.forEach(i=>{"in"===this.state.checkOneState(i,i.context.data,e)?i.addState(t,!0,this.hasAnimationByState("state")):i.removeState(t,this.hasAnimationByState("state"))})}clearExitGraphics(){this._prevDataByKey=this._dataByKey;let t=(t,e)=>{this._graphicMap.delete(e),t.parent&&t.parent.removeChild(t),t.release&&t.release()};this._graphicMap.forEach((e,i)=>{if(e.context.diffState===N.exit&&!e.isExiting)if(e.context.animationState===N.exit&&this.hasAnimationByState("exit")){e.isExiting=!0;let r=this.getAnimationConfig();if(r.exit&&r.exit.length){let s=r.exit.map((t,i)=>({name:`exit_${i}`,animation:Object.assign(Object.assign({},t),{customParameters:e.context})}));e.applyAnimationState(["exit"],[1===s.length?s[0]:s],()=>{t(e,i)})}}else t(e,i)})}isProgressive(){return this.renderContext&&(!!this.renderContext.progressive||!!this.renderContext.beforeTransformProgressive)}canAnimateAfterProgressive(){var t,e;return this.renderContext&&this.renderContext.beforeTransformProgressive&&(null==(e=(t=this.renderContext.beforeTransformProgressive).canAnimate)?void 0:e.call(t))}isDoingProgressive(){return this.renderContext&&(this.renderContext.progressive&&this.renderContext.progressive.currentIndex<this.renderContext.progressive.totalStep||this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.unfinished())}clearProgressive(){this.renderContext&&this.renderContext.progressive&&(this._graphics=[],this._product.children.forEach(t=>{t.incrementalClearChild()}),this._product.removeAllChild()),this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.release(),this.renderContext=null}restartProgressive(){this.renderContext&&this.renderContext.progressive&&(this.renderContext.progressive.currentIndex=0)}_runBeforeProgressive(){var t;let e=this.renderContext.beforeTransformProgressive;e.progressiveRun();let i=e.output();if(null==(t=e.canAnimate)?void 0:t.call(e)){if(e.unfinished())return;this._runGroupData(i),this._runJoin(i),this._runState(this._graphics),this._runEncoder(this._graphics),this._runApplyGraphic(this._graphics)}}_runProgressiveJoin(){let t=this.renderContext.progressive.currentIndex,e=[],i={};return this._dataByGroup.keys.forEach(r=>{let s=this.renderContext.progressive.groupedData.get(r),n=this.renderContext.progressive.step,a=s.slice(t*n,(t+1)*n),l=[];a.forEach((i,s)=>{let a=this._keyGetter(i),o={context:Object.assign(Object.assign({},this._getCommonContext()),{diffState:N.enter,data:[i],uniqueKey:`${r}_${null!=a?a:t*n+s}`,key:a,groupKey:r})};l.push(o),e.push(o)}),i[r]=l}),{graphicsByGroup:i,graphics:e,needUpdate:!0}}_createIncrementalGraphics(){this._product.removeAllChild(),this._dataByGroup.keys.forEach(t=>{let e=(0,s4.sS)({pickable:!1,zIndex:this._markConfig.zIndex});e.incremental=this.renderContext.progressive.step,this._product.appendChild(e)})}_setCommonAttributesToTheme(t){var e,i,r;if(this._attrsByGroup&&t){let s=t.parent;s&&(null==(e=this._attrsByGroup)?void 0:e[null==(i=t.context)?void 0:i.groupKey])&&s.setTheme({common:this._attrsByGroup[null==(r=t.context)?void 0:r.groupKey]})}}_runProgressiveEncoder(t){0===this.renderContext.progressive.currentIndex?this._runEncoder(t):this._runEncoder(t,!0)}_runProgressiveApplyGraphic(t){0===this.renderContext.progressive.currentIndex?(this._runApplyGraphic(t),this._setCommonAttributesToTheme(t[0])):this._runApplyGraphic(t)}_runProgressiveStep(){let{graphics:t,graphicsByGroup:e,needUpdate:i}=this._runProgressiveJoin();0===this.renderContext.progressive.currentIndex?(this._createIncrementalGraphics(),this._graphics=t):i&&t.forEach(t=>{this._graphics.push(t)}),this._runState(t),Object.keys(e).forEach(t=>{this._runProgressiveEncoder(e[t])}),this._runEncoderTransform(this._graphics,!0),Object.keys(e).forEach(t=>{this._runProgressiveApplyGraphic(e[t])}),this.renderContext.progressive.currentIndex+=1}renderProgressive(){var t;(null==(t=this.renderContext)?void 0:t.beforeTransformProgressive)?this._runBeforeProgressive():this.renderContext.progressive&&this._runProgressiveStep()}hasAnimationByState(t){if(!t||!this._animationConfig||!this._animationConfig[t]||this._disabledAnimationStates.includes(t))return!1;let e=this._animationConfig[t];return e.length>0||ey(e)}hasAnimation(){return!!this._animationConfig&&Object.keys(this._animationConfig).length>0}runAnimation(){this._runStateAnimation(this.getGraphics())}}var ol=i(43617),oo=i(51129);class oh extends oa{constructor(){super(...arguments),this.type=oh.type,this._marks=[],this._diffState=N.enter}getMarks(){return this._marks}isMarkExist(t){return void 0!==this._marks.find(e=>e.id===t.id)}addMark(t){return this.isMarkExist(t)?(eI("Mark already exists, add mark failed."),!1):(this._marks.push(t),!0)}removeMark(t){let e=this._marks.findIndex(e=>e.id===t.id||e.name===t.name);return -1===e?(eI("Mark does not exists, removeMark failed."),!1):(this._marks.splice(e,1),!0)}getMarkInType(t){return this._marks.filter(e=>e.type===t)}getMarkInId(t){return this._marks.find(e=>e.id===t)}getMarkInUserId(t){let e;return nw(this,t=>{e=t},e=>e.getUserId()===t,null,!0),e}getMarkInName(t){return this._marks.filter(e=>e.name===t)}_compileProduct(t){super._compileProduct(t),this.getMarks().forEach(t=>{t.compile({group:this._product})})}_getAttrsFromConfig(t={}){let e=super._getAttrsFromConfig(t);return et(this._markConfig.interactive)||(e.pickable=this._markConfig.interactive),t}getGraphics(){return[this._product]}renderInner(){var t;if(!this._product)return;let e=null!=(t=this._simpleStyle)?t:this.getAttributesOfState({});this._product.context=Object.assign(Object.assign(Object.assign({},this._product.context),this._getCommonContext()),{diffState:this._diffState}),this._setAnimationState(this._product);let i=this._getAttrsFromConfig(e);if(this._product.context.diffState===N.update){let t=this.hasAnimation(),e=iU(this._product,i);this._product.context.diffAttrs=e,this.hasAnimationByState(this._product.context.animationState)||(t?this._product.setAttributesAndPreventAnimate(e):this._product.setAttributes(e)),t&&this._product.setFinalAttributes(i)}else this._product.setAttributes(i);this.needClear=!0}clearExitGraphics(){this._diffState=N.update}render(){this._isCommited&&(eO(`render mark: ${this.getProductId()}, type is ${this.type}`),this.renderInner(),this.uncommit()),this.getMarks().forEach(t=>{t.render()})}release(){super.release(),this.removeProduct()}}oh.type="group";let ou=()=>{(0,ol.W)(),(0,oo.M)(),ig.registerMark(oh.type,oh)};var od=i(47979);let oc=(t,e,i)=>(0,od.gM)(t,e,i,{fontFamily:eF.fontFamily,fontSize:eF.fontSize}),op=(t,e,i,r)=>oc(e,i,r).measure(t);class og{static instance(){return og.instance_||(og.instance_=new og),og.instance_}constructor(){this.functions={}}registerFunction(t,e){t&&e&&(this.functions[t]=e)}unregisterFunction(t){t&&delete this.functions[t]}getFunction(t){return this.functions[t]||null}getFunctionNameList(){return Object.keys(this.functions)}}var of=i(93279),om=i(54611),oy=i(14364),o_=i(8385),ov=i(89359),ob=i(17783),ox=i(56304);let oS=class extends ox.s{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}getImageData(t,e,i,r){return new Promise((s,n)=>{var a;try{tt.canvasGetImageData({canvasId:null!=(a=this.canvas.nativeCanvas.id)?a:this.canvas.id,x:t,y:e,width:i,height:r,success(t){s(t)}})}catch(t){n(t)}})}draw(){let t=this.nativeContext;t.draw&&(this.drawPromise=new Promise(e=>{t.draw(!0,()=>{this.drawPromise=null,e(null)})}))}createPattern(t,e){return null}};oS.env="feishu",oS=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)()],oS);let ok=class extends ov.u{constructor(t){super(t)}init(){this._context=new oS(this,this._dpr)}release(...t){}};ok.env="feishu",ok=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],ok);var oA=i(36444);let oM=(0,oA.l)(ok,oS);var ow=i(69493),oT=i(35437),oC=i(41809),oE=i(52650);class oB{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let oP=class extends ow.X{get container(){return null}constructor(t){super(),this.global=t,this.type="feishu",this.eventManager=new oB}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oT.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new ok(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let s=t.dpr;null==s&&(s=e.width/i),this.canvas=new ok({width:i,height:r,dpr:s,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};oP.env="feishu",oP=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(m=(0,oC.f)(o_.y2),function(t,e){m(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],oP);let oO=new oy.n(t=>{t(oP).toSelf(),t(oE.zd).toDynamicValue(t=>t.container.get(oP)).whenTargetNamed(oP.env)});var oI=i(85074),oR=i(35056),oL=i(21288),oD=i(73209),oF=i(55551),oz=i(67653),oj=function(t,e){return function(i,r){e(i,r,t)}};let oH=class extends oR.f{constructor(t,e,i){super(e,i),this.contributions=t,this.pickItemInterceptorContributions=e,this.pickServiceInterceptorContributions=i,this.global.hooks.onSetEnv.tap("math-picker-service",(t,e,i)=>{this.configure(i,e)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(t=>{this.pickerMap.set(t.numberType,t)}),super._init()}configure(t,e){this.pickContext=new oL.w(null,1)}pickItem(t,e,i,r){if(!1===t.attribute.pickable)return null;let s=this.pickerMap.get(t.numberType);if(!s)return null;let n=s.contains(t,e,r),a=n?t:null;return a?{graphic:a,params:n}:null}};oH=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),oj(0,(0,oC.f)(oD.Qc)),oj(0,(0,oF.t)(oz.XN)),oj(1,(0,oC.f)(oD.Qc)),oj(1,(0,oF.t)(oI.uH)),oj(2,(0,oC.f)(oD.Qc)),oj(2,(0,oF.t)(oI.tn)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object,Object])],oH);let oN=new oy.n(t=>{oN.__vloaded||(oN.__vloaded=!0,(0,oD.yb)(t,oz.XN))});oN.__vloaded=!1;var oV=i(82421),oW=i(27177),oU=i(65719),oG=i(21996);let oZ=class extends oG.o{constructor(t){super(),this.canvasRenderer=t,this.type="area",this.numberType=oW.Ri}};oZ=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(y=(0,oC.f)(oU.Gs),function(t,e){y(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],oZ);let o$=!1,oY=new oy.n((t,e,i,r)=>{o$||(o$=!0,t(oz.$Y).to(oZ).inSingletonScope(),t(oz.XN).toService(oz.$Y))});var oX=i(1782);class oK{constructor(){this.type="glyph",this.numberType=oW.Nd}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let s=null==i?void 0:i.pickerService;if(s){let r=!1;return t.getSubGraphic().forEach(t=>{if(r)return;let n=s.pickItem(t,e,null,i);r=!(!n||!n.graphic)}),r}return!1}}let oq=class extends oK{constructor(t){super(),this.canvasRenderer=t}};oq=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(_=(0,oC.f)(oU.FU),function(t,e){_(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],oq);let oQ=!1,oJ=new oy.n((t,e,i,r)=>{oQ||(oQ=!0,t(oz.Uv).to(oq).inSingletonScope(),t(oq).toService(oz.Uv))});var o0=i(14526),o1=i(86298),o2=i(74403),o3=i(95797),o5=i(75639),o4=i(82727),o7=i(88789),o6=i(35922);let o9=new oy.n((t,e,i,r)=>{i(oH)||t(oH).toSelf().inSingletonScope(),i(oI.hH)?r(oI.hH).toService(oH):t(oI.hH).toService(oH)});function o8(t){t.load(oN),t.load(o9),t.load(oV.E),t.load(oY),t.load(oX.P),t.load(oJ),t.load(o0.x),t.load(o1.c),t.load(o2.C),t.load(o3.t),t.load(o5.k),t.load(o4.D),t.load(o7.n),t.load(o6.T)}var ht=i(35238),he=i(37967);class hi{get width(){return this._w*this.dpr}set width(t){}get height(){return this._h*this.dpr}set height(t){}get offsetWidth(){return this._w}set offsetWidth(t){}get offsetHeight(){return this._h}set offsetHeight(t){}constructor(t,e,i,r,s,n){this.nativeCanvas=t,this.ctx=e,this._w=r,this._h=s,this.id=n,t.id=n,this.dpr=i}getContext(){return this.ctx}getBoundingClientRect(){return{width:this._w,height:this._h}}}class hr{get width(){return this._w*this.dpr}set width(t){this._w=t/this.dpr,this.nativeCanvas.width=t}get height(){return this._h*this.dpr}set height(t){this._h=t/this.dpr,this.nativeCanvas.height=t}get offsetWidth(){return this._w}set offsetWidth(t){this._w=t,this.nativeCanvas.width=t*this.dpr}get offsetHeight(){return this._h}set offsetHeight(t){this._h=t,this.nativeCanvas.height=t*this.dpr}constructor(t,e,i,r,s,n){this.nativeCanvas=t,this.ctx=e,this._w=r,this._h=s,this.id=n,t.id=n,this.dpr=i}getContext(){return this.ctx}getBoundingClientRect(){return{width:this._w,height:this._h}}}let hs=class extends ht.z{constructor(){super(),this.type="feishu",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}getDynamicCanvasCount(){return this.freeCanvasList.length}getStaticCanvasCount(){return 9999}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),function(t,e,i,r,s,n){let a=null!=n?n:tt.getSystemInfoSync().pixelRatio;e.forEach((e,n)=>{let l=tt.createCanvasContext(e),o=new hi(l.canvas||{},l,a,t.width,t.height,e);l.canvas=o,i.set(e,o),n>=r&&s.push(o)})}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.pixelRatio))}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return tt.getSystemInfoSync().pixelRatio}getRequestAnimationFrame(){return function(t){return he.dZ.call(t)}}getCancelAnimationFrame(){return t=>{he.dZ.clear(t)}}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}};hs=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],hs);let hn=new oy.n(t=>{hn.isFeishuBound||(hn.isFeishuBound=!0,t(hs).toSelf().inSingletonScope(),t(o_.D0).toService(hs))});function ha(t,e=!0){ha.__loaded||(ha.__loaded=!0,t.load(hn),t.load(oM),t.load(oO),e&&o8(t))}hn.isFeishuBound=!1,ha.__loaded=!1;var hl=i(29436);let ho=class extends ox.s{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}setLineDash(t){let e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){let t=e[0];if(0===t[0]&&0===t[1])return;t&&i.setLineDash(t)}}_setStrokeStyle(t,e,i,r,s){let n=this.nativeContext;s||(s=this.strokeAttributes);let{strokeOpacity:a=s.strokeOpacity,opacity:l=s.opacity}=e;if(a>1e-12&&l>1e-12){let{lineWidth:o=s.lineWidth,stroke:h=s.stroke,lineJoin:u=s.lineJoin,lineDash:d=s.lineDash,lineCap:c=s.lineCap,miterLimit:p=s.miterLimit,keepStrokeScale:g=s.keepStrokeScale,lineDashOffset:f=s.lineDashOffset}=e;n.globalAlpha=a*l*this.baseGlobalAlpha,n.lineWidth=g?o:(0,hl.D)(this,o,this.dpr),n.strokeStyle=(0,hl.L)(this,h,t,i,r),n.lineJoin=u,(0!==d[0]||0!==d[1])&&d&&(n.setLineDash(d),n.lineDashOffset=f),n.lineCap=c,n.miterLimit=p}}measureText(t,e=lM.w.global.measureTextMethod){return this.setTransform(1,0,0,1,0,0,!0,lM.w.global.devicePixelRatio),{width:super.measureText(t,e).width,fontBoundingBoxDescent:void 0,fontBoundingBoxAscent:void 0,actualBoundingBoxAscent:void 0,actualBoundingBoxDescent:void 0}}createPattern(t,e){return null}draw(){let t=this.nativeContext;t.draw&&(this.drawPromise=new Promise(e=>{t.draw(!0,()=>{this.drawPromise=null,e(null)})}))}};ho.env="lynx",ho=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)()],ho);let hh=class extends ov.u{constructor(t){super(t)}init(){this._context=new ho(this,this._dpr)}resize(t,e){this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._nativeCanvas.nativeCanvas&&(this._nativeCanvas.nativeCanvas.width=this._pixelWidth,this._nativeCanvas.nativeCanvas.height=this._pixelHeight),this._context.dpr=this._dpr}release(...t){}};hh.env="lynx",hh=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hh);class hu{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let hd=class extends ow.X{get container(){return null}constructor(t){super(),this.global=t,this.type="lynx",this.eventManager=new hu}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oT.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new hh(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let s=t.dpr;null==s&&(s=e.width/i),this.canvas=new hh({width:i,height:r,dpr:s,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};hd.env="lynx",hd=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(v=(0,oC.f)(o_.y2),function(t,e){v(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hd);let hc=new oy.n(t=>{t(hd).toSelf(),t(oE.zd).toDynamicValue(t=>t.container.get(hd)).whenTargetNamed(hd.env)}),hp=(0,oA.l)(hh,ho),hg=!1;try{hg=!!lynx.createCanvasNG}catch(t){}let hf=class extends ht.z{constructor(){super(),this.type="lynx",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),function(t,e,i,r,s,n,a){let l=null!=a?a:SystemInfo.pixelRatio;if(e.forEach((e,a)=>{let o;n?o=lynx.createOffscreenCanvas():(o=hg?lynx.createCanvasNG(e):lynx.createCanvas(e),hg&&o.attachToCanvasView(e)),o.width=t.width*l,o.height=t.height*l;let h=o.getContext("2d"),u=new hr(o,h,l,t.width,t.height,e);i.set(e,u),a>r&&s.push(u)}),!s.length&&lynx.createOffscreenCanvas){let e=lynx.createOffscreenCanvas();e.width=t.width*l,e.height=t.height*l;let r=e.getContext("2d"),n=Math.random().toString(),a=new hr(e,r,l,t.width,t.height,n);i.set(n,a),s.push(a)}}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,!!e.offscreen,e.pixelRatio))}getDynamicCanvasCount(){return this.freeCanvasList.length}getStaticCanvasCount(){return 9999}loadImage(t){return(function(t,e=!1){if(e)return Promise.reject();let i=lynx.createImage(t);return new Promise((t,e)=>{i.onload=()=>{t(i)},i.onerror=()=>{e(Error("加载失败"))}})})(t,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return SystemInfo.pixelRatio}getRequestAnimationFrame(){return function(t){return he.dZ.call(t)}}getCancelAnimationFrame(){return t=>{he.dZ.clear(t)}}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}};hf=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],hf);let hm=new oy.n(t=>{hm.isLynxBound||(hm.isLynxBound=!0,t(hf).toSelf().inSingletonScope(),t(o_.D0).toService(hf))});function hy(t,e=!0){hy.__loaded||(hy.__loaded=!0,t.load(hm),t.load(hp),t.load(hc),e&&o8(t))}hm.isLynxBound=!1,hy.__loaded=!1;var h_=i(37730),hv=i(28504);let hb=class extends ox.s{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.setGlobalAlpha(t),this._globalAlpha=t}draw(){this.nativeContext.draw()}strokeText(t,e,i){}_setCommonStyle(t,e,i,r,s){let n=this.nativeContext;s||(s=this.fillAttributes);let{fillOpacity:a=s.fillOpacity,opacity:l=s.opacity,fill:o=s.fill}=e;a>1e-12&&l>1e-12&&(n.setGlobalAlpha(a*l),n.setFillStyle((0,hl.L)(this,o,t,i,r)))}_setStrokeStyle(t,e,i,r,s){let n=this.nativeContext;s||(s=this.strokeAttributes);let{strokeOpacity:a=s.strokeOpacity,opacity:l=s.opacity}=e;if(a>1e-12&&l>1e-12){let{lineWidth:o=s.lineWidth,stroke:h=s.stroke,lineJoin:u=s.lineJoin,lineDash:d=s.lineDash,lineDashOffset:c=s.lineDashOffset,lineCap:p=s.lineCap,miterLimit:g=s.miterLimit,keepStrokeScale:f=s.keepStrokeScale}=e;n.setGlobalAlpha(a*l),n.setLineWidth(f?o:(0,hl.D)(this,o,this.dpr)),n.setStrokeStyle((0,hl.L)(this,h,t,i,r)),n.setLineJoin(u),d&&(n.setLineDash(d),n.lineDashOffset=c),n.setLineCap(p),n.setMiterLimit(g)}}setTextStyleWithoutAlignBaseline(t,e){var i;let r=this.nativeContext;e||(e=this.textAttributes),t.font?r.font=t.font:r.font=(0,hv.U)(t,e),r.setFontSize(null!=(i=t.fontSize)?i:e.fontSize)}setTextStyle(t,e){var i,r;let s=this.nativeContext;e||(e=this.textAttributes),t.font?s.font=t.font:s.font=(0,hv.U)(t,e),s.setTextAlign(null!=(i=t.textAlign)?i:e.textAlign),s.setTextBaseline(null!=(r=t.textBaseline)?r:e.textBaseline)}createConicGradient(t,e,i,r){return null}createPattern(t,e){return null}getImageData(t,e,i,r){let s=this.nativeContext,n=s.taro;if(s&&n)return!s.getImageData&&n.canvasGetImageData?new Promise((s,a)=>{try{n.canvasGetImageData({canvasId:this.canvas.nativeCanvas.id,sx:t,sy:e,sw:i,sh:r,success(t){s(t)}})}catch(t){a(t)}}):void 0}createRadialGradient(t,e,i,r,s,n){return this.nativeContext.createCircularGradient&&this.nativeContext.createCircularGradient(t,e,i,r,s,n)}};hb.env="taro",hb=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)()],hb);let hx=class extends ov.u{constructor(t){super(t)}init(){this._context=new hb(this,this._dpr)}release(...t){}};hx.env="taro",hx=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hx);let hS=(0,oA.l)(hx,hb);class hk{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let hA=class extends ow.X{get container(){return null}constructor(t){super(),this.global=t,this.type="taro",this.eventManager=new hk}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oT.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new hx(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let s=t.dpr;null==s&&(s=e.width/i),this.canvas=new hx({width:i,height:r,dpr:s,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches.length>0&&(t.changedTouches.forEach((e,i)=>{t.changedTouches[i]=Object.assign(Object.assign({},t.changedTouches[i]),{offsetX:e.x,offsetY:e.y})}),t.offsetX=t.changedTouches[0].offsetX,t.offsetY=t.changedTouches[0].offsetY),t.touches.length>0&&t.touches.forEach((e,i)=>{t.touches[i]=Object.assign(Object.assign({},t.touches[i]),{offsetX:e.x,offsetY:e.y})}),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};hA.env="taro",hA=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(b=(0,oC.f)(o_.y2),function(t,e){b(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hA);let hM=new oy.n(t=>{t(hA).toSelf(),t(oE.zd).toDynamicValue(t=>t.container.get(hA)).whenTargetNamed(hA.env)}),hw=class extends ht.z{constructor(){super(),this.type="taro",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}getDynamicCanvasCount(){return this.freeCanvasList.length}getStaticCanvasCount(){return 9999}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}configure(t,e){var i,r,s,n,a,l,o;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,r=e.canvasIdLists,s=this.canvasMap,n=e.freeCanvasIdx,a=this.freeCanvasList,l=e.taro,o=e.pixelRatio,r.forEach((t,e)=>{let r=l.createCanvasContext(t),h=new hi(r.canvas||{},r,o,i.width,i.height,t);return r.canvas=h,s.set(t,h),e>=n&&a.push(h),h}),this.taro=e.taro,this.pixelRatio=e.pixelRatio)}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){let e=window||globalThis;if(e.DOMParser){let i=(new e.DOMParser).parseFromString(t,"image/svg+xml").children[0],r=(new XMLSerializer).serializeToString(i);return Promise.resolve({data:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(r)}`,loadState:"success"})}if(e.Blob){let i=new e.Blob([t],{type:"image/svg+xml"});return Promise.resolve({data:e.URL.createObjectURL(i),loadState:"success"})}return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return this.pixelRatio}getRequestAnimationFrame(){return requestAnimationFrame}getCancelAnimationFrame(){return cancelAnimationFrame}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}};hw=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],hw);let hT=new oy.n(t=>{hT.isTaroBound||(hT.isTaroBound=!0,t(hw).toSelf().inSingletonScope(),t(o_.D0).toService(hw))});function hC(t,e=!0){hC.__loaded||(hC.__loaded=!0,t.load(hT),t.load(hS),t.load(hM),e&&o8(t))}hT.isTaroBound=!1,hC.__loaded=!1;let hE=class extends ox.s{draw(){}createPattern(t,e){return null}};hE.env="wx",hE=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)()],hE);let hB=class extends ov.u{constructor(t){super(t)}init(){this._context=new hE(this,this._dpr)}release(...t){}};hB.env="wx",hB=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hB);let hP=(0,oA.l)(hB,hE);class hO{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let hI=class extends ow.X{get container(){return null}constructor(t){super(),this.global=t,this.type="wx",this.eventManager=new hO}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oT.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new hB(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let s=t.dpr;null==s&&(s=e.width/i),this.canvas=new hB({width:i,height:r,dpr:s,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){var e,i,r,s;let{type:n}=t;return!!this.eventManager.cache[n]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=null!=(e=t.changedTouches[0].x)?e:t.changedTouches[0].pageX,t.changedTouches[0].clientX=null!=(i=t.changedTouches[0].x)?i:t.changedTouches[0].pageX,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=null!=(r=t.changedTouches[0].y)?r:t.changedTouches[0].pageY,t.changedTouches[0].clientY=null!=(s=t.changedTouches[0].y)?s:t.changedTouches[0].pageY),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[n].listener&&this.eventManager.cache[n].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};hI.env="wx",hI=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(x=(0,oC.f)(o_.y2),function(t,e){x(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hI);let hR=new oy.n(t=>{t(hI).toSelf(),t(oE.zd).toDynamicValue(t=>t.container.get(hI)).whenTargetNamed(hI.env)}),hL=class extends ht.z{constructor(){super(),this.type="wx",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}configure(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),(function(t,e,i,r,s,n,a){var l,o,h,u;return l=this,o=void 0,h=void 0,u=function*(){let t=wx.getSystemInfoSync().pixelRatio;for(let l=0;l<e.length;l++){let o=e[l];!a&&i.has(o)||(yield new Promise(e=>{let a=wx.createSelectorQuery();n&&(a=a.in(n)),a.select(`#${o}`).fields({node:!0,size:!0}).exec(n=>{if(!n[0])return;let a=n[0].node,h=n[0].width,u=n[0].height;a.width=h*t,a.height=u*t,i.set(o,a),l>=r&&s.push(a),e(null)})}))}},new(h||(h=Promise))(function(t,e){function i(t){try{s(u.next(t))}catch(t){e(t)}}function r(t){try{s(u.throw(t))}catch(t){e(t)}}function s(e){var s;e.done?t(e.value):((s=e.value)instanceof h?s:new h(function(t){t(s)})).then(i,r)}s((u=u.apply(l,o||[])).next())})})(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component,e.forceUpdate).then(()=>{})}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return wx.getSystemInfoSync().pixelRatio}getRequestAnimationFrame(){return function(t){return he.dZ.call(t)}}getCancelAnimationFrame(){return t=>{he.dZ.clear(t)}}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}};hL=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],hL);let hD=new oy.n(t=>{hD._isWxBound||(hD._isWxBound=!0,t(hL).toSelf().inSingletonScope(),t(o_.D0).toService(hL))});function hF(t,e=!0){hF.__loaded||(hF.__loaded=!0,t.load(hD),t.load(hP),t.load(hR),e&&o8(t))}hD._isWxBound=!1,hF.__loaded=!1;var hz=i(23364);function hj(t){hj.__loaded||(hj.__loaded=!0,(0,om.Ns)(t,!1),ha(t,!1),hy(t,!1),(0,h_.sn)(t,!1),hC(t,!1),hF(t,!1),(0,hz.q)(t),es.rF.hooks.onSetEnv.tap("loadMathPicker",(e,i)=>{"browser"!==i&&o8(t)}))}hj.__loaded=!1;let hH=class extends oS{};hH.env="tt",hH=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)()],hH);let hN=class extends ov.u{constructor(t){super(t)}init(){this._context=new hH(this,this._dpr)}release(...t){}};hN.env="tt",hN=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hN);let hV=(0,oA.l)(hN,hH);class hW{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let hU=class extends ow.X{get container(){return null}constructor(t){super(),this.global=t,this.type="tt",this.eventManager=new hW}getTitle(){return this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oT.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new hN(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}let s=t.dpr;null==s&&(s=e.width/i),this.canvas=new hN({width:i,height:r,dpr:s,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};hU.env="tt",hU=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(S=(0,oC.f)(o_.y2),function(t,e){S(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hU);let hG=new oy.n(t=>{t(hU).toSelf(),t(oE.zd).toDynamicValue(t=>t.container.get(hU)).whenTargetNamed(hU.env)}),hZ=class extends ht.z{constructor(){super(),this.type="tt",this.supportEvent=!0,this.canvasMap=new Map,this.freeCanvasList=[],this.canvasIdx=0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0}configure(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),(function(t,e,i,r,s,n){var a,l,o,h;return a=this,l=void 0,o=void 0,h=function*(){let t=tt.getSystemInfoSync().pixelRatio;for(let a=0;a<e.length;a++){let l=e[a];yield new Promise(e=>{let o=tt.createSelectorQuery();n&&(o=o.in(n)),o.select(`#${l}`).node().exec(n=>{let o=n[0].node,h=o.width,u=o.height;o.width=h*t,o.height=u*t,i.set(l,o),a>=r&&s.push(o),e(null)})})}},new(o||(o=Promise))(function(t,e){function i(t){try{s(h.next(t))}catch(t){e(t)}}function r(t){try{s(h.throw(t))}catch(t){e(t)}}function s(e){var s;e.done?t(e.value):((s=e.value)instanceof o?s:new o(function(t){t(s)})).then(i,r)}s((h=h.apply(a,l||[])).next())})})(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component).then(()=>{})}loadImage(t){return Promise.resolve({data:t,loadState:"success"})}loadSvg(t){return Promise.reject()}createCanvas(t){let e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return tt.getSystemInfoSync().pixelRatio}getRequestAnimationFrame(){return function(t){return he.dZ.call(t)}}getCancelAnimationFrame(){return t=>{he.dZ.clear(t)}}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return this.canvasMap.get(t)}getRootElement(){return null}getDocument(){return null}release(...t){}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}};hZ=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],hZ);let h$=new oy.n(t=>{h$.isTTBound||(h$.isTTBound=!0,t(hZ).toSelf().inSingletonScope(),t(o_.D0).toService(hZ))});function hY(t,e=!0){hY.__loaded||(hY.__loaded=!0,t.load(h$),t.load(hV),t.load(hG),e&&o8(t))}h$.isTTBound=!1,hY.__loaded=!1;let hX=class extends ox.s{get globalAlpha(){return this._globalAlpha}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}setLineDash(t){let e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){let t=e[0];if(0===t[0]&&0===t[1])return;t&&i.setLineDash(t)}}_setStrokeStyle(t,e,i,r,s){let n=this.nativeContext;s||(s=this.strokeAttributes);let{strokeOpacity:a=s.strokeOpacity,opacity:l=s.opacity}=e;if(a>1e-12&&l>1e-12){let{lineWidth:o=s.lineWidth,stroke:h=s.stroke,lineJoin:u=s.lineJoin,lineDash:d=s.lineDash,lineCap:c=s.lineCap,miterLimit:p=s.miterLimit,keepStrokeScale:g=s.keepStrokeScale,lineDashOffset:f=s.lineDashOffset}=e;n.globalAlpha=a*l*this.baseGlobalAlpha,n.lineWidth=g?o:(0,hl.D)(this,o,this.dpr),n.strokeStyle=(0,hl.L)(this,h,t,i,r),n.lineJoin=u,0===d[0]&&0===d[1]||(d&&n.setLineDash(d),n.lineDashOffset=f),n.lineCap=c,n.miterLimit=p}}measureText(t,e=lM.w.global.measureTextMethod){return this.setTransform(1,0,0,1,0,0,!0,lM.w.global.devicePixelRatio),super.measureText(t,e)}setTextStyleWithoutAlignBaseline(t,e,i){let r=this.nativeContext;e||(e=this.textAttributes);let{scaleIn3d:s=e.scaleIn3d}=t,n="";r.font=((t.font?t.font:(0,hv.U)(t,e,s&&this.camera&&this.camera.getProjectionScale(i)))||"").replace("px","vp");let{fontFamily:a=e.fontFamily,fontSize:l=e.fontSize}=t;this.fontFamily=a,this.fontSize=l,r.textAlign="left",r.textBaseline="alphabetic"}setTextStyle(t,e,i){var r,s;let n=this.nativeContext;e||(e=this.textAttributes);let a="";n.font=((t.font?t.font:(0,hv.U)(t,e,this.camera&&this.camera.getProjectionScale(i)))||"").replace("px","vp");let{fontFamily:l=e.fontFamily,fontSize:o=e.fontSize}=t;this.fontFamily=l,this.fontSize=o,n.textAlign=null!=(r=t.textAlign)?r:e.textAlign,n.textBaseline=null!=(s=t.textBaseline)?s:e.textBaseline}createPattern(t,e){return null}drawImage(){let t=this.nativeContext,e=arguments;e[0].drawImage&&(e[0]=e[0].transferToImageBitmap()),3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}draw(){}};hX.env="harmony",hX=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)()],hX);let hK=class extends ov.u{constructor(t){super(t)}init(){this._context=new hX(this,this._dpr)}resize(t,e){}release(...t){}};hK.env="harmony",hK=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hK);class hq{constructor(){this.cache={}}addEventListener(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}removeEventListener(t,e){if(!t||!e||!this.cache[t])return;let i=this.cache[t].listener.findIndex(t=>t===e);i>=0&&this.cache[t].listener.splice(i,1)}cleanEvent(){this.cache={}}}let hQ=class extends ow.X{get container(){return null}constructor(t){super(),this.global=t,this.type="harmony",this.eventManager=new hq}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:oT.R.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new hK(i)}createWindowByCanvas(t){let e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;let i=t.width,r=t.height;if(null==i||null==r||!t.canvasControled){let t=e.getBoundingClientRect();i=t.width,r=t.height}this.canvas=new hK({width:i,height:r,dpr:1,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e){this.eventManager.addEventListener(t,e)}removeEventListener(t,e){this.eventManager.removeEventListener(t,e)}dispatchEvent(t){let{type:e}=t;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=()=>{},t.stopPropagation=()=>{},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach(e=>{e(t)}),!0)}getStyle(){return{}}setStyle(t){}getBoundingClientRect(){let t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}};hQ.env="harmony",hQ=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(k=(0,oC.f)(o_.y2),function(t,e){k(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],hQ);let hJ=new oy.n(t=>{t(hQ).toSelf(),t(oE.zd).toDynamicValue(t=>t.container.get(hQ)).whenTargetNamed(hQ.env)}),h0=(0,oA.l)(hK,hX),h1=class extends ht.z{constructor(){super(),this.type="harmony",this.supportEvent=!0,this.supportsTouchEvents=!0;try{this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsPointerEvents=!1,this.supportsMouseEvents=!1}this.applyStyles=!0,this.rafSTO=new he.p9(0)}configure(t,e){t.env===this.type&&t.setActiveEnvContribution(this)}getDynamicCanvasCount(){return 9999}getStaticCanvasCount(){return 9999}loadImage(t){}loadSvg(t){return Promise.reject()}createCanvas(t){return function(t,e,i){let r=new OffscreenCanvas(t,e),s=r.getContext("2d");return new hi({width:t,height:e,context:s,_c:r,getBoundingClientRect:()=>({width:t,height:e}),getContext:()=>s},s,1,t,e,i)}(t.width,t.height,t.id)}createOffscreenCanvas(t){}releaseCanvas(t){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return t=>this.rafSTO.call(t)}getCancelAnimationFrame(){return t=>{this.rafSTO.clear(t)}}mapToCanvasPoint(t){var e;return null==(e=null==t?void 0:t.type)||e.startsWith("mouse"),t}addEventListener(t,e,i){return null}removeEventListener(t,e,i){return null}dispatchEvent(t){return null}getElementById(t){return null}getRootElement(){return null}getDocument(){return null}release(...t){}};h1=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],h1);let h2=new oy.n(t=>{h2.isHarmonyBound||(h2.isHarmonyBound=!0,t(h1).toSelf().inSingletonScope(),t(o_.D0).toService(h1))});function h3(t,e=!0){h3.__loaded||(h3.__loaded=!0,t.load(h2),t.load(h0),t.load(hJ),e&&o8(t))}h2.isHarmonyBound=!1,h3.__loaded=!1;let h5=()=>{hj(of.n)},h4=()=>{(0,om.Ns)(of.n)},h7=()=>{ha(of.n)},h6=()=>{hy(of.n)},h9=()=>{(0,h_.sn)(of.n)},h8=()=>{hC(of.n)},ut=()=>{hF(of.n)},ue=()=>{hY(of.n)},ui=()=>{h3(of.n)};function ur(t,e){return t&&e.key in t?t[e.key]:e.default}function us(t){return t&&"token"===t.type&&!!t.key}let un=["animationThreshold","colorScheme","name","padding"];class ua{constructor(){this.id=eg(),this._plugins=[]}add(t){if(!t||0===t.length)return null;let e=[];return t.forEach(t=>{this._plugins.find(e=>e.id===t.id)?eI("不要重复添加相同的plugin"):(this._plugins.push(t),e.push(t),t.onAdd&&t.onAdd(this))}),e}load(t){let e=this.add(t);e&&e.length&&this.activate(t)}activate(t){t.length&&t.forEach(t=>{t.init&&t.init()})}get(t){return this._plugins.find(e=>e.id===t)}getAll(){return this._plugins.slice()}release(t){let e=this.get(t);e&&(e.release(this),this._plugins=this._plugins.filter(t=>t!==e))}releaseAll(){this._plugins.forEach(t=>{t.release(this)}),this._plugins=[]}clear(t){let e=this.get(t);e&&e.clear(this)}clearAll(){this._plugins.forEach(t=>{var e;null==(e=t.clear)||e.call(t,this)})}}class ul extends ua{constructor(t){super(),this.globalInstance=t}onInit(t){this._plugins.forEach(e=>{e.onInit&&e.onInit(this,t)})}onBeforeResize(t,e){this._plugins.forEach(i=>{i.onBeforeResize&&i.onBeforeResize(this,t,e)})}onAfterChartSpecTransform(t,e){this._plugins.forEach(i=>{i.onAfterChartSpecTransform&&i.onAfterChartSpecTransform(this,t,e)})}onAfterModelSpecTransform(t,e,i){this._plugins.forEach(r=>{r.onAfterModelSpecTransform&&r.onAfterModelSpecTransform(this,t,e,i)})}onBeforeInitChart(t,e){this._plugins.forEach(i=>{i.onBeforeInitChart&&i.onBeforeInitChart(this,t,e)})}releaseAll(){super.releaseAll(),this.globalInstance=null}}var uo=i(46560),uh=i(59484),uu=i(58539),ud=i(70016),uc=i(98116),up=i(43562),ug=i(30756),uf=i(97424),um=i(66778);class uy{constructor(){this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=oT.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={},this.renderId=0,this.onWheel=t=>{try{let e=new t.constructor(t.type,t);this.pluginService.stage.window.getContext().getCanvas().nativeCanvas.dispatchEvent(e)}catch(t){return}}}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,e=>{e&&e===this.pluginService.stage&&this.drawHTML([...t.stage.getChildren()])})}deactivate(t){t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter(t=>t.name!==this.key),this.release()}getWrapContainer(t,e,i){let r;return r=e?"string"==typeof e?lM.w.global.getElementById(e):e:t.window.getContainer(),{wrapContainer:lM.w.global.createDom(Object.assign({tagName:"div",parent:r},i)),nativeContainer:r}}parseDefaultStyleFromGraphic(t){let e="text"===t.type&&t.attribute?t.attribute:(0,uo.gh)(t).text;return(0,uu.WD)(e)}getTransformOfText(t){let e=(0,uo.gh)(t).text,{textAlign:i=e.textAlign,textBaseline:r=e.textBaseline}=t.attribute,{rotateDeg:s,scaleX:n,scaleY:a}=t.globalTransMatrix.toTransformAttrs(),l={left:"0",start:"0",end:"-100%",center:"-50%",right:"-100%",top:"0",middle:"-50%",bottom:"-100%",alphabetic:"-79%"},o={left:"0",start:"0",end:"100%",center:"50%",right:"100%",top:"0",middle:"50%",bottom:"100%",alphabetic:"79%"};return{textAlign:i,transform:`translate(${l[i]},${l[r]}) rotate(${s}deg) scaleX(${n}) scaleY(${a})`,transformOrigin:`${o[i]} ${o[r]}`}}updateStyleOfWrapContainer(t,e,i,r,s){let{pointerEvents:n,penetrateEventList:a=[]}=s,l=this.parseDefaultStyleFromGraphic(t);l.display=!1!==t.attribute.visible?"block":"none",l.pointerEvents=!0===n?"all":n||"none","none"!==l.pointerEvents&&(this.removeWrapContainerEventListener(i),a.forEach(t=>{"wheel"===t&&i.addEventListener("wheel",this.onWheel)})),i.style.position||(i.style.position="absolute",r.style.position="relative");let o=0,h=0,u=t.globalAABBBounds,d=s.anchorType;if((0,lU.Z)(d)&&(d="text"===t.type?"position":"boundsLeftTop"),"boundsLeftTop"===d&&(d="top-left"),"position"===d||u.empty()){let e=t.globalTransMatrix;o=e.e,h=e.f}else{let t=(0,ud.v1)(u,d);o=t.x,h=t.y}let c=lM.w.global.getElementTopLeft(r,!1),p=e.window.getTopLeft(!1),g=e.viewBox,f=o+p.left-c.left+g.x1,m=h+p.top-c.top+g.y1;if(l.left=`${f}px`,l.top=`${m}px`,"text"===t.type&&"position"===d&&(l=Object.assign(Object.assign({},l),this.getTransformOfText(t))),(0,uc.Z)(s.style)){let e=s.style({top:m,left:f,width:u.width(),height:u.height()},t,i);e&&(l=Object.assign(Object.assign({},l),e))}else(0,up.Z)(s.style)?l=Object.assign(Object.assign({},l),s.style):(0,ug.Z)(s.style)&&s.style&&(l=Object.assign(Object.assign({},l),(0,uf.wv)(s.style)));lM.w.global.updateDom(i,{width:s.width,height:s.height,style:l})}clearCacheContainer(){this.htmlMap&&Object.keys(this.htmlMap).forEach(t=>{this.htmlMap[t]&&this.htmlMap[t].renderId!==this.renderId&&this.removeElement(t)}),this.renderId+=1}drawHTML(t){"browser"===lM.w.global.env&&(t.sort((t,e)=>{var i,r;return(null!=(i=t.attribute.zIndex)?i:uh.xF.zIndex)-(null!=(r=e.attribute.zIndex)?r:uh.xF.zIndex)}).forEach(t=>{this.renderGroupHTML(t)}),this.clearCacheContainer())}renderGroupHTML(t){this.renderGraphicHTML(t),t.forEachChildren(t=>{t.isContainer?this.renderGroupHTML(t):this.renderGraphicHTML(t)})}removeElement(t){if(!this.htmlMap||!this.htmlMap[t])return;let{wrapContainer:e}=this.htmlMap[t];e&&lM.w.global.removeDom(e),this.htmlMap[t]=null}removeWrapContainerEventListener(t){t.removeEventListener("wheel",this.onWheel)}renderGraphicHTML(t){var e;let{html:i}=t.attribute;if(!i)return;let r=t.stage;if(!r)return;let{dom:s,container:n}=i;if(!s)return;let a=(0,lU.Z)(i.id)?`${null!=(e=t.id)?e:t._uid}_react`:i.id;if(this.htmlMap&&this.htmlMap[a]&&n&&n!==this.htmlMap[a].container&&this.removeElement(a),this.htmlMap&&this.htmlMap[a])"string"==typeof s?this.htmlMap[a].wrapContainer.innerHTML=s:s!==this.htmlMap[a].wrapContainer.firstChild&&(this.htmlMap[a].wrapContainer.removeChild(this.htmlMap[a].wrapContainer.firstChild),this.htmlMap[a].wrapContainer.appendChild(s));else{let{wrapContainer:t,nativeContainer:e}=this.getWrapContainer(r,n);t&&("string"==typeof s?t.innerHTML=s:t.appendChild(s),this.htmlMap||(this.htmlMap={}),this.htmlMap[a]={wrapContainer:t,nativeContainer:e,container:n,renderId:this.renderId})}if(!this.htmlMap||!this.htmlMap[a])return;let{wrapContainer:l,nativeContainer:o}=this.htmlMap[a];this.updateStyleOfWrapContainer(t,r,l,o,i),this.htmlMap[a].renderId=this.renderId}release(){"browser"===lM.w.global.env&&this.removeAllDom(this.pluginService.stage.defaultLayer)}removeAllDom(t){this.htmlMap&&(Object.keys(this.htmlMap).forEach(t=>{this.removeElement(t)}),this.htmlMap=null)}}let u_=()=>{um.F.registerPlugin("HtmlAttributePlugin",uy)};class uv extends uy{constructor(){super(...arguments),this.name="ReactAttributePlugin",this.activeEvent="onRegister",this._uid=oT.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={}}removeElement(t){if(!this.htmlMap||!this.htmlMap[t])return;let{root:e,wrapContainer:i,unmount:r}=this.htmlMap[t];e?lM.w.global.getRequestAnimationFrame()(()=>{e.unmount()}):r&&r(),i&&lM.w.global.removeDom(i),this.htmlMap[t]=null}renderGraphicHTML(t){var e;let{react:i}=t.attribute;if(!i)return;let r=t.stage;if(!r)return;let s=r.params.ReactDOM,{element:n,container:a}=i;if(!n||!s||!s.createRoot&&!s.render)return;let l=(0,lU.Z)(i.id)?`${null!=(e=t.id)?e:t._uid}_react`:i.id;if(this.htmlMap&&this.htmlMap[l]&&a&&a!==this.htmlMap[l].container&&this.removeElement(l),this.htmlMap&&this.htmlMap[l])s.createRoot?this.htmlMap[l].root.render(n):s.render(n,this.htmlMap[l].wrapContainer);else{let{wrapContainer:t,nativeContainer:e}=this.getWrapContainer(r,a);if(t)if(this.htmlMap||(this.htmlMap={}),s.createRoot){let i=s.createRoot(t);i.render(n),this.htmlMap[l]={root:i,wrapContainer:t,nativeContainer:e,container:a,renderId:this.renderId}}else s.render(n,t),this.htmlMap[l]={wrapContainer:t,nativeContainer:e,container:a,renderId:this.renderId,unmount:()=>{s.unmountComponentAtNode(t)}}}if(!this.htmlMap||!this.htmlMap[l])return;let{wrapContainer:o,nativeContainer:h}=this.htmlMap[l];this.updateStyleOfWrapContainer(t,r,o,h,i),this.htmlMap[l].renderId=this.renderId}}let ub=()=>{um.F.registerPlugin("ReactAttributePlugin",uv)};var ux=i(31852);class uS{constructor(t){this.onPointerDown=t=>{let e=t.target,i=this.rootNode,r=e===i;if(e&&!r){let n,a=!1;function s(t){if(a||(t.type="dragstart",null==e||e.dispatchEvent(t),a=!0),t.type="drag",null==e||e.dispatchEvent(t),!r){e.attribute.pickable=!1;let r=(null==i?void 0:i.pick(t.global.x,t.global.y)).graphic;e.attribute.pickable=!0,n!==r&&(n&&(t.type="dragleave",t.target=n,n.dispatchEvent(t)),r&&(t.type="dragenter",t.target=r,r.dispatchEvent(t)),(n=r)&&(t.type="dragover",t.target=n,n.dispatchEvent(t)))}}null==i||i.addEventListener("pointermove",s);let l=function(){a&&(n&&(t.type="drop",t.target=n,n.dispatchEvent(t)),t.type="dragend",e.dispatchEvent(t),a=!1),null==i||i.removeEventListener("pointermove",s)};e.addEventListener("pointerup",l,{once:!0}),e.addEventListener("pointerupoutside",l,{once:!0})}},this.rootNode=t,this.initEvents()}initEvents(){var t;null==(t=this.rootNode)||t.addEventListener("pointerdown",this.onPointerDown)}removeEvents(){var t;null==(t=this.rootNode)||t.removeEventListener("pointerdown",this.onPointerDown)}release(){this.removeEvents(),this.rootNode=null}}var uk=i(6715);class uA extends lZ.r{constructor(t,e,i,r,s){super(null,{},i,r,s),this.clipFromAttribute=t,this.clipToAttribute=e,this._group=null==s?void 0:s.group,this._clipGraphic=null==s?void 0:s.clipGraphic}onBind(){super.onBind(),this._group&&this._clipGraphic&&(this._lastClip=this._group.attribute.clip,this._lastPath=this._group.attribute.path,this._group.setAttributes({clip:!0,path:[this._clipGraphic]},!1,{type:lW.Gk.ANIMATE_BIND}))}onEnd(){this._group&&this._group.setAttributes({clip:this._lastClip,path:this._lastPath},!1,{type:lW.Gk.ANIMATE_END})}onUpdate(t,e,i){if(!this._clipGraphic)return;let r={};Object.keys(this.clipFromAttribute).forEach(t=>{r[t]=this.clipFromAttribute[t]+(this.clipToAttribute[t]-this.clipFromAttribute[t])*e}),this._clipGraphic.setAttributes(r,!1,{type:lW.Gk.ANIMATE_UPDATE,animationState:{ratio:e,end:t}})}}class uM extends uA{constructor(t,e,i,r,s){var n,a,l,o,h,u,d,c,p,g,f,m;let y,_,v=null!=(a=null==(n=null==s?void 0:s.group)?void 0:n.attribute)?a:{},b=null!=(l=v.width)?l:0,x=null!=(o=v.height)?o:0,S=null!=(h=null==s?void 0:s.animationType)?h:"in",k=null!=(u=null==s?void 0:s.startAngle)?u:0,A=null!=(d=null==s?void 0:s.orient)?d:"clockwise",M=0,w=0;"anticlockwise"===A?(w="in"===S?k+2*Math.PI:k,w=k+2*Math.PI):(M=k,w="out"===S?k+2*Math.PI:k);let T=lM.w.graphicService.creator.arc({x:null!=(p=null==(c=null==s?void 0:s.center)?void 0:c.x)?p:b/2,y:null!=(f=null==(g=null==s?void 0:s.center)?void 0:g.y)?f:x/2,outerRadius:null!=(m=null==s?void 0:s.radius)?m:(b+x)/2,innerRadius:0,startAngle:M,endAngle:w,fill:!0});"anticlockwise"===A?(y={startAngle:k+2*Math.PI},_={startAngle:k}):(y={endAngle:k},_={endAngle:k+2*Math.PI}),super("in"===S?y:_,"in"===S?_:y,i,r,{group:null==s?void 0:s.group,clipGraphic:T})}}class uw extends uA{constructor(t,e,i,r,s){var n,a,l,o,h,u,d,c,p;let g=null!=(a=null==(n=null==s?void 0:s.group)?void 0:n.attribute)?a:{},f=null!=(o=null!=(l=null==s?void 0:s.width)?l:g.width)?o:0,m=null!=(u=null!=(h=null==s?void 0:s.height)?h:g.height)?u:0,y=null!=(d=null==s?void 0:s.animationType)?d:"in",_=null!=(c=null==s?void 0:s.direction)?c:"x",v=null!=(p=null==s?void 0:s.orient)?p:"positive",b=lM.w.graphicService.creator.rect({x:0,y:0,width:"in"===y&&"x"===_?0:f,height:"in"===y&&"y"===_?0:m,fill:!0}),x={},S={};"y"===_?"negative"===v?(x={y:m,height:0},S={y:0,height:m}):(x={height:0},S={height:m}):"negative"===v?(x={x:f,width:0},S={x:0,width:f}):(x={width:0},S={width:f}),super("in"===y?x:S,"in"===y?S:x,i,r,{group:null==s?void 0:s.group,clipGraphic:b})}}var uT=i(70501),uC=i(21648),uE=i(41457);class uB extends lZ.r{constructor(t,e,i,r,s){var n,a;super(t,e,i,r,s),this.newPointAnimateType=null!=(n=null==s?void 0:s.newPointAnimateType)?n:"grow",this.clipRangeByDimension=null!=(a=null==s?void 0:s.clipRangeByDimension)?a:"x"}getPoints(t,e=!1){if(t.points)return t.points;if(t.segments){let i=[];return this.segmentsCache||(this.segmentsCache=[]),t.segments.map(t=>{var r,s;t.points&&i.push(...t.points),e&&this.segmentsCache.push(null!=(s=null==(r=t.points)?void 0:r.length)?s:0)}),i}return[]}onBind(){super.onBind();let{points:t,segments:e}=this.target.attribute,{points:i,segments:r}=this.target.getFinalAttribute();this.from={points:t,segments:e},this.to={points:i,segments:r},this.props=this.to;let s=this.getPoints(this.from),n=this.getPoints(this.to,!0);this.fromPoints=s?Array.isArray(s)?s:[s]:[],this.toPoints=n?Array.isArray(n)?n:[n]:[];let a=new Map;this.fromPoints.forEach(t=>{t.context&&a.set(t.context,t)});let l,o,h=1/0,u=-1/0;for(let t=0;t<this.toPoints.length;t+=1)if(a.has(this.toPoints[t].context)){h=t,l=a.get(this.toPoints[t].context);break}for(let t=this.toPoints.length-1;t>=0;t-=1)if(a.has(this.toPoints[t].context)){u=t,o=a.get(this.toPoints[t].context);break}"clip"===this.newPointAnimateType&&0!==this.toPoints.length&&(Number.isFinite(u)?(this.clipRange=this.toPoints[u][this.clipRangeByDimension]/this.toPoints[this.toPoints.length-1][this.clipRangeByDimension],1===this.clipRange&&(this.shrinkClipRange=this.toPoints[u][this.clipRangeByDimension]/this.fromPoints[this.fromPoints.length-1][this.clipRangeByDimension]),(0,uT.Z)(this.clipRange)?this.clipRange=(0,uC.Z)(this.clipRange,0,1):this.clipRange=0):this.clipRange=0);let d=this.toPoints[0];this.interpolatePoints=this.toPoints.map((t,e)=>{let i=a.get(t.context);return i?(d=i,[i,t]):"appear"===this.newPointAnimateType||"clip"===this.newPointAnimateType?[t,t]:e<h&&l?[l,t]:e>u&&o?[o,t]:[d,t]}),this.points=this.interpolatePoints.map(t=>{let e=t[0],i=t[1],r=new uE.E9(e.x,e.y,e.x1,e.y1);return r.defined=i.defined,r.context=i.context,r})}onFirstRun(){let t=this.target.attribute.clipRange;(0,uT.Z)(t*this.clipRange)&&(this.clipRange*=t)}onUpdate(t,e,i){if(t)return Object.keys(this.to).forEach(t=>{this.target.attribute[t]=this.to[t]}),this.target.addUpdatePositionTag(),void this.target.addUpdateShapeAndBoundsTag();if(this.points=this.points.map((t,i)=>{let r=(0,he.q9)(this.interpolatePoints[i][0],this.interpolatePoints[i][1],e);return r.context=t.context,r}),this.clipRange){if(this.shrinkClipRange)return void(t?(i.points=this.toPoints,i.clipRange=1):(i.points=this.fromPoints,i.clipRange=this.clipRange-(this.clipRange-this.shrinkClipRange)*e));this.target.setAttributes({clipRange:this.clipRange+(1-this.clipRange)*e})}if(this.segmentsCache&&this.to.segments){let t=0,e=this.to.segments.map((e,i)=>{let r=t+this.segmentsCache[i],s=this.points.slice(t,r);return t=r,Object.assign(Object.assign({},e),{points:s})});this.target.attribute.segments=e}else this.target.attribute.points=this.points;this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}var uP=i(16749),uO=i(50354),uI=i(66059),uR=i(42100),uL=i(8146),uD=i(10688),uF=i(45996),uz=i(77632),uj=i(41520),uH=i(7660),uN=i(75936),uV=i(25819),uW=i(61154),uU=i(33503),uG=i(72570);let uZ=t=>({type:"clipIn",options:{clipDimension:"horizontal"===t.direction?"y":"x"}}),u$={type:"fadeIn"},uY=t=>({type:"horizontal"===t.direction?"growPointsXIn":"growPointsYIn",options:{orient:"horizontal"===t.direction?"positive":"negative"}}),uX={appear:{duration:1e3,easing:"cubicOut"},update:{type:"update",duration:300,easing:"linear"},enter:{duration:300,easing:"linear"},exit:{duration:300,easing:"linear"},disappear:{duration:500,easing:"cubicIn"},state:{duration:300,easing:"linear"}},uK={appear:{type:"scaleIn"},enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:{type:"scaleOut"}},uq={appear:{type:"fadeIn"},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}},uQ=()=>{ig.registerAnimation("scaleInOut",()=>uK)},uJ=()=>{ig.registerAnimation("fadeInOut",()=>uq)},u0=()=>{ig.registerAnimation("cartesianGroupClip",t=>({appear:{custom:uw,customParameters:(e,i)=>({animationType:"in",group:i,direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()})},disappear:{custom:uw,customParameters:(e,i)=>({animationType:"out",group:i,direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()})}}))},u1=(t,e)=>({appear:function(t,e){switch(e){case"grow":return uY(t);case"fadeIn":return u$;default:return uZ(t)}}(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},update:[{type:"update",options:{excludeChannels:["points","defined","segments"]}},{channel:["points","segments"],custom:uB,duration:uX.update.duration,easing:uX.update.easing,customParameters:{clipRangeByDimension:"horizontal"===t.direction?"y":"x"}}],disappear:{type:"clipOut"}}),u2=()=>{ig.registerAnimation("line",u1)},u3=()=>{ig.registerAnimation("area",u1)},u5=()=>{uP.a.registerBuiltInAnimate("scaleIn",uO.O),uP.a.registerBuiltInAnimate("scaleOut",uO.E),uP.a.registerBuiltInAnimate("fadeIn",uI.U),uP.a.registerBuiltInAnimate("fadeOut",uI.D),uP.a.registerBuiltInAnimate("moveIn",uR.V8),uP.a.registerBuiltInAnimate("moveOut",uR.vW),uP.a.registerBuiltInAnimate("rotateIn",uL.hD),uP.a.registerBuiltInAnimate("rotateOut",uL.XN),uP.a.registerBuiltInAnimate("update",uD.B),uP.a.registerBuiltInAnimate("state",uF.Z),uP.a.registerBuiltInAnimate("fromTo",uz.$)},u4=()=>{uP.a.registerBuiltInAnimate("growHeightIn",uj.HQ),uP.a.registerBuiltInAnimate("growHeightOut",uj.qG),uP.a.registerBuiltInAnimate("growWidthIn",uH.dR),uP.a.registerBuiltInAnimate("growWidthOut",uH.yi),uP.a.registerBuiltInAnimate("growCenterIn",uN.W),uP.a.registerBuiltInAnimate("growCenterOut",uN.B)},u7=()=>{uP.a.registerBuiltInAnimate("growRadiusIn",uV.$),uP.a.registerBuiltInAnimate("growRadiusOut",uV.em),uP.a.registerBuiltInAnimate("growAngleIn",uW.kj),uP.a.registerBuiltInAnimate("growAngleOut",uW.j2)},u6=()=>{uP.a.registerBuiltInAnimate("growPointsIn",uU.Kk),uP.a.registerBuiltInAnimate("growPointsOut",uU.Yf),uP.a.registerBuiltInAnimate("growPointsXIn",uU.xJ),uP.a.registerBuiltInAnimate("growPointsXOut",uU.$m),uP.a.registerBuiltInAnimate("growPointsYIn",uU.yQ),uP.a.registerBuiltInAnimate("growPointsYOut",uU.rf),uP.a.registerBuiltInAnimate("clipIn",uG.b),uP.a.registerBuiltInAnimate("clipOut",uG.v)},u9=()=>{uP.a.registerBuiltInAnimate("growPointsOut",uU.Yf)},u8=()=>{(0,ux.d)(),u5()},dt=()=>{ig.registerStageEventPlugin("drag",uS)},de=()=>{ig.registerStageEventPlugin("gesture",uk.o)},di=t=>{let e=eo(t),i=[],r=[];return e.forEach(t=>{"empty"===t?i.push("view"):t3(t)&&"none"!==t?t.includes("view:")?(r.push(t.replace("view:","")),i.push("view")):(r.push(t),i.push("self")):tH(t)&&i.push("timeout")}),{eventNames:r,resetType:i}},dr=(t,e)=>{if(!e||!t)return null;let i={};return t.forEach(t=>{let r=t.stateStyle;r&&e.forEach(e=>{e&&r[e]&&(i[e]||(i[e]=[]),i[e].push(t.id))})}),i},ds=(t,e)=>{if(!e||!e.length)return[];let i=[];return t.markIds?e.filter(e=>{t.markIds.includes(e.getProductId())&&i.push(e)}):t.markNames?e.forEach(e=>{t.markNames.includes(e.name)&&i.push(e)}):e.forEach(t=>{i.push(t)}),i},dn=t=>t.filterField?e=>{var i;return null==(i=iV(e))?void 0:i[t.filterField]}:e=>e.context[t.filterType],da={highlightState:V.STATE_HIGHLIGHT,blurState:V.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"};class dl{constructor(t){this._markSet=new nU,this.options=t,t.marks&&t.marks.length&&t.marks.forEach(t=>{this.registerMark(t)})}getMarks(){return this._markSet.getMarks()}getMarksByState(t){if(this._markIdByState&&this._markSet){let e=this._markIdByState[t];return e?this.getMarks().filter(t=>t&&e.includes(t.id)):[]}return[]}registerMark(t){tY(t)?t.forEach(t=>{this._markSet.addMark(t)}):this._markSet.addMark(t)}updateMarkIdByState(t){this._markIdByState=dr(this.getMarks(),t)}getMarkIdByState(){var t;return null!=(t=this._markIdByState)?t:{}}isGraphicInStateMark(t,e){var i;let r=this.getMarkIdByState();return r&&r[e]&&r[e].includes(null==(i=t.context)?void 0:i.markId)}isGraphicInMark(t){var e;return!!this._markSet.getMarkInId(null==(e=t.context)?void 0:e.markId)}getStartState(){return null}getResetState(){return null}init(){let t=this.getEvents();t&&this.options.event&&t.forEach(t=>{t.type&&t.handler&&(tY(t.type)?t.type.forEach(e=>{e&&"none"!==e&&this.options.event.on(e,t.handler)}):"none"!==t.type&&this.options.event.on(t.type,t.handler))})}release(){let t=this.getEvents();t&&this.options.event&&(null!=t?t:[]).forEach(t=>{t.type&&t.handler&&(tY(t.type)?t.type.forEach(e=>{e&&"none"!==e&&this.options.event.on(e,t.handler)}):"none"!==t.type&&this.options.event.off(t.type,t.handler))})}start(t){}reset(t){}dispatchEvent(t,e){this.options.event&&(this.options.event.emit(`${this.type}:${t}`,e),"start"===t&&this.options.onStart?this.options.onStart(e):"reset"===t&&this.options.onReset?this.options.onReset(e):"update"===t&&this.options.onUpdate?this.options.onUpdate(e):"end"===t&&this.options.onEnd&&this.options.onEnd(e))}}let dh={highlightState:V.STATE_HIGHLIGHT,blurState:V.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"};class du extends dl{constructor(t){super(t),this.type="element-highlight",this.resetAll=()=>{let{highlightState:t,blurState:e,interaction:i}=this.options;this._lastGraphic&&(i.clearAllStatesOfTrigger(this,t,e),this.dispatchEvent("reset",{graphics:[this._lastGraphic],options:this.options}),this._lastGraphic=null,i.setStatedGraphics(this,[]))},this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{let{interaction:e}=this.options,i=e.getStatedGraphics(this);if(!i||!i.length)return;let r=t.item,s=r&&this._markSet.getMarkInId(r.context.markId);(this._resetType.includes("view")&&!s||this._resetType.includes("self")&&s)&&this.resetAll()},this.options=Object.assign({},dh,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){let t=this.options.triggerOff,e=[{type:this.options.trigger,handler:this.handleStart}],i=t;return t3(t)&&t.includes("view:")?(i=t.replace("view:",""),this._resetType="view"):this._resetType="self",e.push({type:i,handler:this.handleReset}),e}start(t){if(t&&this._markSet.getMarkInId(t.context.markId)){let{highlightState:e,blurState:i,interaction:r}=this.options;if(this._lastGraphic===t)return;let s=r.updateStates(this,[t],r.getStatedGraphics(this),e,i);r.setStatedGraphics(this,s),this._lastGraphic=t,this.dispatchEvent("start",{graphics:s,options:this.options})}else this._lastGraphic&&"view"===this._resetType&&this.resetAll()}reset(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}du.type="element-highlight",du.defaultOptions=dh;let dd=()=>{ig.registerInteractionTrigger(du.type,du)},dc={state:V.STATE_SELECTED,trigger:"click"};class dp extends dl{constructor(t){super(t),this.type="element-select",this._resetType=[],this.resetAll=()=>{let{state:t,reverseState:e,interaction:i}=this.options,r=i.getStatedGraphics(this);r&&r.length&&(i.clearAllStatesOfTrigger(this,t,e),this.dispatchEvent("reset",{graphics:r,options:this.options}),i.setStatedGraphics(this,[]))},this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{let{interaction:e}=this.options,i=e.getStatedGraphics(this);if(!i||!i.length)return;let r=t.item,s=r&&this._markSet.getMarkInId(r.context.markId);(this._resetType.includes("view")&&!s||this._resetType.includes("self")&&s)&&this.resetAll()},this.options=Object.assign({},dc,t),this.updateMarkIdByState([this.options.state,this.options.reverseState])}getStartState(){return this.options.state}getResetState(){return this.options.reverseState}getEvents(){let t=this.options.triggerOff,e=this.options.trigger,i=[{type:e,handler:this.handleStart}],{eventNames:r,resetType:s}=di(t);return r.forEach(t=>{t&&(tY(e)?!e.includes(t):t!==e)&&i.push({type:t,handler:this.handleReset})}),this._resetType=s,i}start(t){let{state:e,reverseState:i,isMultiple:r,interaction:s}=this.options,n=s.getStatedGraphics(this);if(t&&this._markSet.getMarkInId(t.context.markId))if(t.hasState(e)){if(this._resetType.includes("self")){let r=n&&n.filter(e=>e!==t);r&&r.length?s.setStatedGraphics(this,s.updateStates(this,r,n,e,i)):this.resetAll()}}else{this._timer&&clearTimeout(this._timer),t.addState(e,!0);let a=this.options.interaction.updateStates(this,r&&n?[...n,t]:[t],n,e,i);s.setStatedGraphics(this,a),this.dispatchEvent("start",{graphics:a,options:this.options}),this._resetType.includes("timeout")&&(this._timer=setTimeout(()=>{this.resetAll()},this.options.triggerOff))}else this._resetType.includes("view")&&n&&n.length&&this.resetAll()}reset(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.state,this.options.reverseState]):this.resetAll()}}dp.type="element-select",dp.defaultOptions=dc;let dg=()=>{ig.registerInteractionTrigger(dp.type,dp)};var df=function(t,e,i,r){return new(i||(i=Promise))(function(s,n){function a(t){try{o(r.next(t))}catch(t){n(t)}}function l(t){try{o(r.throw(t))}catch(t){n(t)}}function o(t){var e;t.done?s(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(a,l)}o((r=r.apply(t,e||[])).next())})},dm=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class dy{static useRegisters(t){t.forEach(t=>{"function"==typeof t?t():console.error("Invalid function:",t)})}static useChart(t){t.forEach(t=>ig.registerChart(t.type,t))}static useSeries(t){t.forEach(t=>ig.registerSeries(t.type,t))}static useComponent(t){t.forEach(t=>ig.registerComponent(t.type,t))}static useMark(t){t.forEach(t=>{var e;return ig.registerMark(null!=(e=t.constructorType)?e:t.type,t)})}static useLayout(t){t.forEach(t=>ig.registerLayout(t.type,t))}static registerDataSetTransform(t,e){ig.registerTransform(t,e)}static registerFunction(t,e){t&&e&&og.instance().registerFunction(t,e)}static unregisterFunction(t){t&&og.instance().unregisterFunction(t)}static getFunction(t){return t?og.instance().getFunction(t):null}static getFunctionList(){return og.instance().getFunctionNameList()}static registerMap(t,e,i){let r=ig.getImplementInKey("registerMap");r&&r(t,e,i)}static unregisterMap(t){let e=ig.getImplementInKey("unregisterMap");e&&e(t)}static getMap(t){return sK.get(t)}static registerSVG(t,e,i){let r=ig.getImplementInKey("registerSVG");r&&r(t,e,i)}static unregisterSVG(t){let e=ig.getImplementInKey("unregisterSVG");e&&e(t)}static hideTooltip(t=[]){iB.forEach(t=>{var e;return null==(e=null==t?void 0:t.hideTooltip)?void 0:e.call(t)},t)}static getLogger(){return tW.getInstance()}getSpec(){return this._spec}getSpecInfo(){return this._specInfo}getDataSet(){return this._dataSet}constructor(t,e){var i,r,s,n,a,l,o,h,u;this.id=eg(),this._userEvents=[],this._autoSize=!0,this._option={mode:rk["desktop-browser"],onError:t=>{throw Error(t)},optimize:{disableCheckGraphicWidthOutRange:!0}},this._observer=null,this._context={},this._doResize=()=>{let{width:t,height:e}=this.getCurrentSize();this._currentSize.width===t&&this._currentSize.height===e||(this._currentSize={width:t,height:e},this.resizeSync(t,e))},this._renderSync=(t={})=>{var e;return this._beforeRender(t)&&(null==(e=this._compiler)||e.render(t.morphConfig),this._updateAnimateState(!1),this._afterRender()),this},this._updateSpec=(t,e=!1,i)=>{var r;let s=this._spec,n={changeBackground:!1,reTransformSpec:!1,change:!1,reMake:!1,reCompile:!1,reSize:!1,changeTheme:!1};if(!this._setNewSpec(t,e))return;if(t1(s.theme,this._spec.theme)?t1(this._spec.background,s.background)||(n.reMake=!0,n.changeBackground=!0):n.changeTheme=!0,n.reSize=this._shouldChartResize(s),this._spec.type!==s.type)return null==(r=this._compiler)||r.updateLayoutTag(),n.reMake=!0,n.reTransformSpec=!0,n.change=!0,n.changeTheme=!0,n;this._initChartSpec(this._spec,"updateSpec");let a=nj(this._chart.updateSpec(this._spec),n);return i?Object.assign(Object.assign({},a),i):a},this.getTheme=(...t)=>{if(!this._currentTheme||!t||!t.length)return;this._cachedProcessedTheme||(this._cachedProcessedTheme={});let e=t.join(".");if(this._cachedProcessedTheme[e])return this._cachedProcessedTheme[e];let i=this._currentTheme;return t.forEach((e,r)=>{if(1!==r||"series"!==t[0]&&"component"!==t[0])i=null==i?void 0:i[e];else{let r="series"===t[0]?ig.getSeriesBuiltInTheme(e):ig.getComponentBuiltInTheme(e);i=i?it({},r,i[e]):r}r===t.length-1&&t5(i)&&(i=function t(e,i,r){if(!e)return e;i||(i=e.colorScheme),r||(r=e.token);let s={};return Object.keys(e).forEach(n=>{let a=e[n];un.includes(n)?s[n]=a:tQ(a)?e7(a)?s[n]=e4(a,i):us(a)?s[n]=ur(r,a):s[n]=t(a,i,r):s[n]=a}),s}({[e]:i},this._currentTheme.colorScheme,this._currentTheme.token)[e])}),this._cachedProcessedTheme[e]=i,i},function t(e,i=!1){if(null===e||"object"!=typeof e)return e;for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(void 0===e[r]){delete e[r];continue}i&&t(e[r],i)}}(e),this._option=Object.assign(Object.assign({},this._option),e),(null==e?void 0:e.optimize)&&(this._option.optimize=Object.assign(Object.assign({},this._option.optimize),e.optimize)),this._onError=null==(i=this._option)?void 0:i.onError;let d=this._option,{dom:c,renderCanvas:p,mode:g,stage:f,poptip:m}=d,y=dm(d,["dom","renderCanvas","mode","stage","poptip"]),_=eE(g);if(_?h4():"node"===g&&h9(),_&&c&&(this._container=t3(c)?es.rF.getElementById(c):c),p&&(this._canvas=p),f&&(this._stage=f),"node"!==g&&!this._container&&!this._canvas&&!this._stage)return void(null==(r=this._option)||r.onError("please specify container or renderCanvas!"));this._viewBox=this._option.viewBox,this._currentThemeName=iP.getCurrentThemeName(),this._setNewSpec(t),this._updateCurrentTheme(),this._currentSize=this.getCurrentSize();let v=[];!1!==m&&v.push("poptipForText"),"sankey"===t.type&&v.push("scrollbar");let b=new tW(null!=(s=this._option.logLevel)?s:rM.Error);tW.setInstance(b),(null==(n=this._option)?void 0:n.onError)&&b.addErrorHandler((...t)=>{var e,i;null==(i=null==(e=this._option)?void 0:e.onError)||i.call(e,...t)}),this._compiler=new nE({dom:null!=(a=this._container)?a:"none",canvas:p},Object.assign(Object.assign({mode:this._option.mode,stage:f,pluginList:v},y),{background:this._getBackground(),onError:this._onError})),this._compiler.setSize(this._currentSize.width,this._currentSize.height),this._eventDispatcher=new iZ(this,this._compiler),this._event=new iI(this._eventDispatcher,g),this._compiler.initView(),this._compiler.updateLayoutTag(),this._setFontFamilyTheme(this.getTheme("fontFamily")),this._initDataSet(this._option.dataSet),this._autoSize=!!_&&(null==(o=null!=(l=t.autoFit)?l:this._option.autoFit)||o),this._bindResizeEvent(),this._bindViewEvent(),this._initChartPlugin(),iB.registerInstance(this),null==(u=null==(h=this._option.performanceHook)?void 0:h.afterCreateVChart)||u.call(h,this)}_setNewSpec(t,e){return!!t&&(t3(t)&&(t=JSON.parse(t)),e&&this._originalSpec&&(t=it({},this._originalSpec,t)),this._originalSpec=t,this._spec=this._getSpecFromOriginalSpec(),!0)}_getSpecFromOriginalSpec(){var t;let e=ea(this._originalSpec);return e.data=null!=(t=e.data)?t:[],e}_initChartSpec(t,e){var i,r;dy.getFunctionList()&&dy.getFunctionList().length&&(t=el(t,dy)),this._spec=t,this._chartSpecTransformer||(this._chartSpecTransformer=ig.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),null==(i=this._chartSpecTransformer)||i.transformSpec(this._spec),this._chartPluginApply("onAfterChartSpecTransform",this._spec,e),this._specInfo=null==(r=this._chartSpecTransformer)?void 0:r.transformModelSpec(this._spec),this._chartPluginApply("onAfterModelSpecTransform",this._spec,this._specInfo,e)}_updateSpecInfo(){var t;this._chartSpecTransformer||(this._chartSpecTransformer=ig.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),this._specInfo=null==(t=this._chartSpecTransformer)?void 0:t.createSpecInfo(this._spec)}_initChart(t){var e,i,r;if(!this._compiler)return void(null==(e=this._option)||e.onError("compiler is not initialized"));if(this._chart)return void(null==(i=this._option)||i.onError("chart is already initialized"));let s=ig.createChart(t.type,t,this._getChartOption(t.type));s?(this._chart=s,this._chart.setCanvasRect(this._currentSize.width,this._currentSize.height),this._chart.created(this._chartSpecTransformer),this._chart.init(),this._event.emit(rB.initialized,{chart:s,vchart:this})):null==(r=this._option)||r.onError("init chart fail")}_releaseData(){this._dataSet&&(this._dataSet.dataViewMap={},this._dataSet=null)}_bindViewEvent(){var t,e;this._compiler&&(null==(e=null==(t=this._compiler.getStage())?void 0:t.getTimeline())||e.on("animationEnd",()=>{this._event.emit(rB.animationFinished,{chart:this._chart,vchart:this})}))}_bindResizeEvent(){var t,e;if(this._autoSize){if(this._onResize=iH(this._doResize,null!=(t=this._option.resizeDelay)?t:100),this._container){let t=window.ResizeObserver;t&&(this._observer=new t(this._onResize),null==(e=this._observer)||e.observe(this._container))}window.addEventListener("resize",this._onResize)}}_unBindResizeEvent(){this._autoSize&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))}getCurrentSize(){var t,e,i,r;return nz(this._spec,{container:this._container,canvas:this._canvas,mode:this._getMode(),modeParams:this._option.modeParams},{width:null!=(e=null==(t=this._currentSize)?void 0:t.width)?e:s9,height:null!=(r=null==(i=this._currentSize)?void 0:i.height)?r:s8})}_initDataSet(t){for(let e in this._dataSet=t instanceof tZ?t:new tZ,sX(this._dataSet,"dataview",tX),sX(this._dataSet,"array",tD),sY(this._dataSet,"copyDataView",s0),ig.transforms)sY(this._dataSet,e,ig.transforms[e]);for(let t in ig.dataParser)sX(this._dataSet,t,ig.dataParser[t])}updateCustomConfigAndRerender(t,e,i={}){if(!this._isReleased&&t)return tK(t)&&(t=t()),t.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._reCompile(t),e?this._renderSync(i):this._renderAsync(i)}_updateCustomConfigAndRecompile(t,e={}){return!!t&&(this._reCompile(t),this._beforeRender(e))}_reCompile(t,e){var i,r,s,n,a,l,o;if(t.reMake&&(this._releaseData(),this._initDataSet(),null==(i=this._chart)||i.release(),this._chart=null),t.reTransformSpec&&(this._chartSpecTransformer=null),t.changeTheme?(this._setCurrentTheme(),this._setFontFamilyTheme(this.getTheme("fontFamily"))):t.changeBackground&&(null==(r=this._compiler)||r.setBackground(this._getBackground())),t.reMake?(null==(s=this._compiler)||s.releaseGrammar(),this._userEvents.forEach(t=>{var e;return null==(e=this._event)?void 0:e.on(t.eType,t.query,t.handler)})):t.reCompile&&(null==(n=this._compiler)||n.clear({chart:this._chart,vChart:this}),null==(a=this._compiler)||a.compile({chart:this._chart,vChart:this})),t.reSize){let{width:t,height:e}=this.getCurrentSize();this._currentSize={width:t,height:e},null==(l=this._chart)||l.onResize(t,e,!1),null==(o=this._compiler)||o.resize(t,e,!1)}}_beforeRender(t={}){var e,i,r,s,n,a,l,o;if(this._isReleased)return!1;if(this._chart)return!0;let{transformSpec:h,actionSource:u}=t;return h&&this._initChartSpec(this._spec,"render"),this._chartPluginApply("onBeforeInitChart",this._spec,u),null==(i=null==(e=this._option.performanceHook)?void 0:e.beforeInitializeChart)||i.call(e,this),this._initChart(this._spec),null==(s=null==(r=this._option.performanceHook)?void 0:r.afterInitializeChart)||s.call(r,this),!(!this._chart||!this._compiler)&&(null==(a=null==(n=this._option.performanceHook)?void 0:n.beforeCompileToVGrammar)||a.call(n,this),this._compiler.compile({chart:this._chart,vChart:this},t),null==(o=null==(l=this._option.performanceHook)?void 0:l.afterCompileToVGrammar)||o.call(l,this),!0)}_afterRender(){return!this._isReleased&&(this._event.emit(rB.rendered,{chart:this._chart,vchart:this}),!0)}renderSync(t){return this._renderSync({morphConfig:t,transformSpec:!0,actionSource:"render"})}renderAsync(t){return df(this,void 0,void 0,function*(){return this._renderAsync({morphConfig:t,transformSpec:!0,actionSource:"render"})})}_renderAsync(t={}){return df(this,void 0,void 0,function*(){return this._renderSync(t)})}_updateAnimateState(t){var e,i;if(this.isAnimationEnable()){let r=e=>{var i;let r=null==(i=e.context)?void 0:i.diffState;return t?"exit"===r?D.none:D.appear:r};null==(e=this._chart)||e.getAllRegions().forEach(t=>{t.updateAnimateStateCallback(r)}),null==(i=this._chart)||i.getAllComponents().forEach(t=>{t.updateAnimateStateCallback(r)})}}release(){var t,e,i,r;(null==(t=this._onResize)?void 0:t.cancel)&&this._onResize.cancel(),this._chartPluginApply("releaseAll"),this._chartPlugin=null,this._chartSpecTransformer=null,null==(e=this._chart)||e.release(),null==(i=this._eventDispatcher)||i.release(),null==(r=this._compiler)||r.release(),this._unBindResizeEvent(),this._releaseData(),this._onError=null,this._onResize=null,this._container=null,this._currentTheme=null,this._cachedProcessedTheme=null,this._option=null,this._chart=null,this._compiler=null,this._spec=null,this._specInfo=null,this._originalSpec=null,this._userEvents=null,this._event=null,this._eventDispatcher=null,this._isReleased=!0,iB.unregisterInstance(this)}updateData(t,e,i,r){return df(this,void 0,void 0,function*(){return this.updateDataSync(t,e,i,r)})}_updateDataById(t,e,i){let r=this._spec.data.find(e=>e.name===t||e.id===t);r?r.id===t?r.values=e:r.name===t&&r.parse(e,i):tY(e)?this._spec.data.push({id:t,values:e}):this._spec.data.push(e)}updateDataInBatches(t){return df(this,void 0,void 0,function*(){return this._chart?(this._chart.updateFullData(t.map(({id:t,data:e,options:i})=>({id:t,values:e,parser:i}))),this._chart.updateGlobalScaleDomain(),this._compiler.render()):(this._spec.data=eo(this._spec.data),t.forEach(({id:t,data:e,options:i})=>{this._updateDataById(t,e,i)})),this})}updateDataSync(t,e,i,r){return et(this._dataSet)||(this._chart?(this._chart.updateData(t,e,!0,i),(null==r?void 0:r.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render()):(this._spec.data=eo(this._spec.data),this._updateDataById(t,e,i))),this}updateFullDataSync(t,e=!0,i){if(this._chart)return this._chart.updateFullData(t),e&&((null==i?void 0:i.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render()),this;let r=eo(this._spec.data);return eo(t).forEach(t=>{let{id:e,values:i,parser:s,fields:n}=t,a=r.find(t=>t.name===e);if(a)a instanceof er?(a.setFields(t4(n)),a.parse(i,t4(s))):(a.values=i,t5(s)&&(a.parser=s),t5(n)&&(a.fields=n));else{let e=s2(t,this._dataSet,r);tY(this._spec.data)&&this._spec.data.push(e)}}),this}updateFullData(t,e=!0){return df(this,void 0,void 0,function*(){return this.updateFullDataSync(t,e)})}updateSpec(t,e=!1,i,r){return df(this,void 0,void 0,function*(){let s=this._updateSpec(t,e,r);return s&&(yield this.updateCustomConfigAndRerender(s,!1,{morphConfig:i,transformSpec:s.reTransformSpec,actionSource:"updateSpec"})),this})}updateSpecSync(t,e=!1,i,r){let s=this._updateSpec(t,e,r);return s&&this.updateCustomConfigAndRerender(s,!0,{morphConfig:i,transformSpec:s.reTransformSpec,actionSource:"updateSpec"}),this}updateSpecAndRecompile(t,e=!1,i={}){let r=this._updateSpec(t,e);return this._updateCustomConfigAndRecompile(r,Object.assign({actionSource:"updateSpecAndRecompile"},i))}updateModelSpec(t,e,i=!1,r){return df(this,void 0,void 0,function*(){return this.updateModelSpecSync(t,e,i,r)})}updateModelSpecSync(t,e,i=!1,r){var s,n;if(!e||!this._spec)return this;if(t3(e)&&(e=JSON.parse(e)),tK(t)||(s=this._spec,n=e,Object.keys(s).forEach(e=>{if(ey(t))t.type===e&&(tY(s[e])?s[e].length>=t.index&&(s[e][t.index]=i?it({},s[e][t.index],n):n):s[e]=i?it({},s[e],n):n);else if(tY(s[e])){let r=s[e].findIndex(e=>e.id===t);r>=0&&(s[e][r]=i?it({},s[e][r],n):n)}else s.id===t&&(s[e]=i?it({},s[e],n):n)})),this._chart){let s=this._chart.getModelInFilter(t);if(s)return this._updateModelSpec(s,e,!0,i,r)}return this}_updateModelSpec(t,e,i=!1,r=!1,s){r&&(e=it({},t.getSpec(),e));let n=t.updateSpec(e);return t.reInit(e),(n.change||n.reCompile||n.reMake||n.reSize||n.reRender)&&this._chart.reDataFlow(),this.updateCustomConfigAndRerender(n,i,{morphConfig:s,transformSpec:!1,actionSource:"updateModelSpec"})}resize(t,e){return df(this,void 0,void 0,function*(){return this.resizeSync(t,e)})}resizeSync(t,e){var i,r;return this._beforeResize(t,e)?(null==(r=(i=this._compiler).resize)||r.call(i,t,e),this._afterResize()):this}_beforeResize(t,e){var i,r,s,n;if(!this._chart||!this._compiler)return!1;let a=this._chart.getCanvasRect();return(!a||a.width!==t||a.height!==e)&&(this._chartPluginApply("onBeforeResize",t,e),null==(r=null==(i=this._option.performanceHook)?void 0:i.beforeResizeWithUpdate)||r.call(i,this),this._chart.onResize(t,e,!1),null==(n=null==(s=this._option.performanceHook)?void 0:s.afterResizeWithUpdate)||n.call(s,this),!0)}_afterResize(){return this._isReleased||this._event.emit(rB.afterResize,{chart:this._chart}),this}updateViewBox(t,e=!0,i=!0){return this._chart&&this._compiler&&(this._viewBox=t,this._chart.updateViewBox(t,i),i&&(this._compiler.render(),this._chart.onEvaluateEnd()),this._compiler.updateViewBox(t,e)),this}on(t,e,i){var r;this._userEvents&&(this._userEvents.push({eType:t,query:"function"==typeof e?null:e,handler:"function"==typeof e?e:i}),null==(r=this._event)||r.on(t,e,i))}off(t,e){var i;if(this._userEvents&&0!==this._userEvents.length)if(e){let r=this._userEvents.findIndex(i=>i.eType===t&&i.handler===e);r>=0&&(this._userEvents.splice(r,1),null==(i=this._event)||i.off(t,e))}else this._userEvents.forEach(e=>{var i;e.eType===t&&(null==(i=this._event)||i.off(t,e.handler))}),this._userEvents=this._userEvents.filter(e=>e.eType!==t)}updateState(t,e){this._chart&&this._chart.updateState(t,e)}setSelected(t,e,i){this._chart&&this._chart.setSelected(t,e,i)}setHovered(t,e,i){this._chart&&this._chart.setHovered(t,e,i)}clearState(t){this._chart&&this._chart.clearState(t)}clearAllStates(){this._chart&&this._chart.clearAllStates()}clearSelected(){this._chart&&this._chart.clearSelected()}clearHovered(){this._chart&&this._chart.clearHovered()}_updateCurrentTheme(t){var e,i,r;let s,n=this._option.theme,a=null==(e=this._spec)?void 0:e.theme,l=null==(i=this._spec)?void 0:i.type;t&&(this._currentThemeName=t);let o=(t,e)=>{var i;return(null==(i=e.chart)?void 0:i[t])&&(e=im({},e,e.chart[t])),e};if(nR(n)&&nR(a))s=iO(this._currentThemeName),this._currentTheme=o(l,s);else if(t3(n)&&(!a||t3(a))||t3(a)&&(!n||t3(n))){let t=im({},iO(this._currentThemeName),iO(n),iO(a));this._currentTheme=o(l,t)}else{let t=im({},iO(this._currentThemeName),iO(n),iO(a));this._currentTheme=o(l,t)}this._cachedProcessedTheme=null,(0,nL.C)(this.getTheme("component","poptip")),null==(r=this._compiler)||r.setBackground(this._getBackground())}_shouldChartResize(t){var e,i;let r=!1;et(this._spec.width)?et(t.width)||(this._spec.width=t.width):this._spec.width!==t.width&&(r=!0),et(this._spec.height)?et(t.height)||(this._spec.height=t.height):this._spec.height!==t.height&&(r=!0);let s=this._autoSize;return this._autoSize=!!eE(this._option.mode)&&(null==(i=null!=(e=this._spec.autoFit)?e:this._option.autoFit)||i),this._autoSize!==s&&(r=!0),r}_getBackground(){return("string"==typeof this._spec.background||ey(this._spec.background)&&this._spec.background.gradient?this._spec.background:null)||this.getTheme("background")||this._option.background}getCurrentTheme(){return iO(this._currentThemeName)}getCurrentThemeName(){return this._currentThemeName}setCurrentTheme(t){return df(this,void 0,void 0,function*(){return this.setCurrentThemeSync(t)})}setCurrentThemeSync(t){if(!iP.themeExist(t))return this;let e=this._setCurrentTheme(t);return this._setFontFamilyTheme(this.getTheme("fontFamily")),this.updateCustomConfigAndRerender(e,!0,{transformSpec:!1,actionSource:"setCurrentTheme"}),this}_setCurrentTheme(t){var e;return this._updateCurrentTheme(t),this._initChartSpec(this._getSpecFromOriginalSpec(),"setCurrentTheme"),null==(e=this._chart)||e.setCurrentTheme(),{change:!0,reMake:!1}}_setFontFamilyTheme(t){var e;t&&(null==(e=this.getStage())||e.setTheme({text:{fontFamily:t},richtext:{fontFamily:t}}))}_getTooltipComponent(){var t;return null==(t=this._chart)?void 0:t.getComponentsByType(rA.tooltip)[0]}setTooltipHandler(t){var e,i;this._context.tooltipHandler=t;let r=this._getTooltipComponent();r&&(null==(i=null==(e=r.tooltipHandler)?void 0:e.release)||i.call(e),r.tooltipHandler=t)}getTooltipHandlerByUser(){var t;return null==(t=this._context)?void 0:t.tooltipHandler}getTooltipHandler(){let t=this._getTooltipComponent();return t?t.tooltipHandler:this._context.tooltipHandler}showTooltip(t,e){var i;let r=this._getTooltipComponent();return null!=(i=t5(t)&&"none"!==(null==r?void 0:r.showTooltip(t,e)))&&i}hideTooltip(){var t;let e=this._getTooltipComponent();return null!=(t=null==e?void 0:e.hideTooltip())&&t}getLegendDataById(t){var e;let i=null==(e=this._chart)?void 0:e.getComponentByUserId(t);return i?i.getLegendData():[]}getLegendDataByIndex(t=0){var e;let i=null==(e=this._chart)?void 0:e.getComponentsByType(rA.discreteLegend);return i&&i[t]?i[t].getLegendData():[]}getLegendSelectedDataById(t){var e;let i=null==(e=this._chart)?void 0:e.getComponentByUserId(t);return i?i.getSelectedData():[]}getLegendSelectedDataByIndex(t=0){var e;let i=null==(e=this._chart)?void 0:e.getComponentsByType(rA.discreteLegend);return i&&i[t]?i[t].getSelectedData():[]}setLegendSelectedDataById(t,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentByUserId(t);r&&r.setSelectedData(e)}setLegendSelectedDataByIndex(t=0,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentsByType(rA.discreteLegend);r&&r[t]&&r[t].setSelectedData(e)}getDataURL(){var t;return df(this,void 0,void 0,function*(){let e=this.getStage();if(this._chart&&e){e.render();let t=this._chart.getCanvas();return yield function(t,e){var i,r,s,n,a;return r=this,s=void 0,n=void 0,a=function*(){if(!t)return"";try{if(void 0!==OffscreenCanvas&&t instanceof OffscreenCanvas)return new Promise(e=>{t.convertToBlob().then(t=>{let i=new FileReader;i.readAsDataURL(t),i.onload=()=>{e(i.result)}})})}catch(t){(null!=(i=null==e?void 0:e.onError)?i:eR)(`getCanvasDataURL error : ${t.toString()}`)}return t.toDataURL()},new(n||(n=Promise))(function(t,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function l(t){try{o(a.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n(function(t){t(r)})).then(i,l)}o((a=a.apply(r,s||[])).next())})}(t,{onError:this._onError})}return null==(t=this._option)||t.onError(ReferenceError("render is not defined")),null})}exportImg(t){var e,i;return df(this,void 0,void 0,function*(){if(!eE(this._option.mode))return void(null==(e=this._option)||e.onError(TypeError("non-browser environment can not export img")));let r=yield this.getDataURL();r?function(t="vchart",e){let i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank"),i.setAttribute("download",`${t}.png`),i.dispatchEvent(new MouseEvent("click"))}(t,r):null==(i=this._option)||i.onError(ReferenceError("render is not defined"))})}exportCanvas(){var t;let e=this.getStage();if(this._chart&&e)return e.toCanvas();null==(t=this._option)||t.onError(ReferenceError("render is not defined"))}getImageBuffer(){var t,e;if("node"!==this._option.mode)return void(null==(t=this._option)||t.onError(TypeError("getImageBuffer() now only support node environment.")));let i=this.getStage();return i?(i.render(),i.window.getImageBuffer()):(null==(e=this._option)||e.onError(ReferenceError("render is not defined")),null)}setLayout(t){var e;this._option.layout=t,null==(e=this._chart)||e.setLayout(t)}reLayout(){var t;this._chart.resetLayoutItemTag(),null==(t=this._chart)||t.setLayoutTag(!0)}getCompiler(){return this._compiler}getChart(){return this._chart}getStage(){return this._compiler.getStage()}getCanvas(){var t;return null==(t=this._compiler)?void 0:t.getCanvas()}getContainer(){var t;let e;return t5(this._container)?this._container:t5(e=t3(this._canvas)?es.rF.getElementById(this._canvas):this._canvas)?e.parentElement:null==(t=this.getCanvas())?void 0:t.parentElement}getComponents(){return this._chart.getAllComponents()}getScale(t){var e;let i=null==(e=this._chart)?void 0:e.getGlobalScale();return null==i?void 0:i.getScale(t)}setDimensionIndex(t,e={}){var i;return null==(i=this._chart)?void 0:i.setDimensionIndex(t,e)}stopAnimation(){var t;null==(t=this.getStage())||t.stopAnimation(!0)}reRunNormalAnimation(){var t;null==(t=this.getStage())||t.reApplyAnimationState("normal",!0)}pauseAnimation(){var t;null==(t=this.getStage())||t.pauseAnimation(!0)}resumeAnimation(){var t;null==(t=this.getStage())||t.resumeAnimation(!0)}convertDatumToPosition(t,e={},i=!1,r){var s;let n;if(!this._chart||nR(t))return null;let{seriesId:a,seriesIndex:l=0}=e;if(t5(a)?n=this._chart.getSeriesInUserId(a):t5(l)&&(n=null==(s=this._chart.getSeriesInIndex([l]))?void 0:s[0]),n){let e,s=Object.keys(t),a=n.getViewData().latestData.find(e=>s.every(i=>e[i]==t[i])),l=n.getRegion().getLayoutStartPoint();return(e=a?n.dataToPosition(a,r):n.dataToPosition(t,r))?eM(e,l,i):null}return null}convertValueToPosition(t,e,i=!1){var r,s;let n;if(!this._chart||et(t)||nR(e))return null;if(!tY(t)){let s,{axisId:n,axisIndex:a}=e;if(t5(n)?s=this._chart.getComponentsByKey("axes").find(t=>t.userId===n):t5(a)&&(s=null==(r=this._chart.getComponentsByKey("axes"))?void 0:r[a]),!s)return eI("Please check whether the `axisId` or `axisIndex` is set!"),null;let l=null==s?void 0:s.valueToPosition(t);if(i){let t=s.getLayoutStartPoint(),e=s.getOrient();return l+("bottom"===e||"top"===e?t.x:t.y)}return l}let{seriesId:a,seriesIndex:l}=e;return t5(a)?n=this._chart.getSeriesInUserId(a):t5(l)&&(n=null==(s=this._chart.getSeriesInIndex([l]))?void 0:s[0]),n?eM(n.valueToPosition(t[0],t[1]),n.getRegion().getLayoutStartPoint(),i):(eI("Please check whether the `seriesId` or `seriesIndex` is set!"),null)}getFunction(t){return og.instance().getFunction(t)}registerFunction(t,e){t&&e&&og.instance().registerFunction(t,e)}unregisterFunction(t){t&&og.instance().unregisterFunction(t)}getFunctionList(){return og.instance().getFunctionNameList()}setRuntimeSpec(t){this._spec=t,this._updateSpecInfo()}updateIndicatorDataById(t,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentByUserId(t);r&&r.updateDatum(e)}updateIndicatorDataByIndex(t=0,e){var i;let r=null==(i=this._chart)?void 0:i.getComponentsByType(rA.indicator);r&&r[t]&&r[t].updateDatum(e)}geoZoomByIndex(t=0,e,i){this._geoZoomByQuery({regionIndex:t},e,i)}geoZoomById(t,e,i){this._geoZoomByQuery({regionId:t},e,i)}_geoZoomByQuery(t,e,i){var r,s;let n=null==(r=this._chart)?void 0:r.getRegionsInQuerier(t)[0],a=null==(s=this._chart)?void 0:s.getComponentsByType(rA.geoCoordinate),l=null==a?void 0:a.find(t=>{var e;return null==(e=t.getRegions())?void 0:e.includes(n)});l&&l.dispatchZoom(e,i)}_initChartPlugin(){let t=ig.getChartPlugins();t.length>0&&(this._chartPlugin=new ul(this),this._chartPlugin.load(t.map(t=>new t)),this._chartPluginApply("onInit",this._spec))}_chartPluginApply(t,...e){this._chartPlugin&&this._chartPlugin[t]&&this._chartPlugin[t].apply(this._chartPlugin,e)}_getMode(){return this._option.mode||rk["desktop-browser"]}isAnimationEnable(){return"animation"in this._option?!!this._option.animation:!1!==this._spec.animation}_getChartOption(t){return{type:t,globalInstance:this,eventDispatcher:this._eventDispatcher,dataSet:this._dataSet,container:this._container,canvas:this._canvas,map:new Map,mode:this._getMode(),modeParams:this._option.modeParams,getCompiler:()=>this._compiler,viewBox:this._viewBox,getTheme:this.getTheme,getSpecInfo:()=>{var t;return null!=(t=this._specInfo)?t:{}},layout:this._option.layout,onError:this._onError,disableTriggerEvent:!0===this._option.disableTriggerEvent}}}dy.InstanceManager=iB,dy.ThemeManager=iP,dy.globalConfig={uniqueTooltip:!0},dy.Utils={measureText:op},dy.vglobal=es.rF,ig.registerRegion("region",n1),ig.registerLayout("base",at),ou(),de(),dd(),dg(),iM(ej.name,ej);let d_=(t,e)=>{let i=t;return!0!==e&&(i=t.sort(aa)),function(t,e,i=aJ){let r=t.length;if(!r)return;if(r<2)return i(t[0],0,t);!1;let s=(r-1)*e,n=Math.floor(s),a=i(t[n],n,t);return a+(i(t[n+1],n+1,t)-a)*(s-n)}(i,.5)};function dv(t,e,i,r){let s,n,a=-1;t.forEach(t=>{s=e(t),n=i(t),!et(s)&&(s*=1)>=s&&!et(n)&&(n*=1)>=n&&r(s,n,++a)})}let db=Math.abs,dx=Math.max,dS=Math.sqrt,dk=Math.pow;function dA(t,e){return t[0]*e[1]-t[1]*e[0]}function dM(t,e){let i=0;for(let r=0;r<t.length;++r)i+=t[r]*e[r];return i}function dw(t,e=10){return Math.round(t*e)/e}function dT(t){let e=t.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-(+e[1]||0);return i>0?i:0}function dC(t,e){return dw(t+e,10**Math.max(dT(t),dT(e)))}function dE(t,e){return dw(t-e,10**Math.max(dT(t),dT(e)))}class dB{constructor(t=0,e=0,i,r){this.x=0,this.y=0,this.x=t,this.y=e,this.x1=i,this.y1=r}clone(){return new dB(this.x,this.y)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}set(t,e){return this.x=t,this.y=e,this}add(t){return tH(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}sub(t){return tH(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}multi(t){throw Error("暂不支持")}div(t){throw Error("暂不支持")}}class dP{static distancePP(t,e){return dS(dk(t.x-e.x,2)+dk(t.y-e.y,2))}static distanceNN(t,e,i,r){return dS(dk(t-i,2)+dk(e-r,2))}static distancePN(t,e,i){return dS(dk(e-t.x,2)+dk(i-t.y,2))}static pointAtPP(t,e,i){return new dB((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}function dO(t,e){let i=[];return t.forEach(t=>{let r=+t[e];ee(r)&&i.push(r)}),0===i.length?null:ed(i)}function dI(t,e){let i=[];return t.forEach(t=>{let r=+t[e];ee(r)&&i.push(r)}),0===i.length?null:eu(i)}function dR(t,e){return t.reduce((t,i)=>{let r=e?+i[e]:+i;return ee(r)&&(t+=r),t},0)}function dL(t,e){let i=0,r=0;return t.forEach(t=>{let s=e?+t[e]:+t;ee(s)&&(i+=s,r++)}),i/r}function dD(t,e){let i=dL(t,e);return t.length<=1?0:t.reduce((t,r)=>t+(e?+r[e]:r-i)**2,0)/(t.length-1)}function dF(t,e){let i=dz(t),r=dz(e),s=Math.asin((t.x*e.y-e.x*t.y)/i/r),n=Math.acos((t.x*e.x+t.y*e.y)/i/r);return s<0?-n:n}function dz(t,e={x:0,y:0}){return dP.distancePP(t,e)}function dj(t){return ee(t.x)&&ee(t.y)}function dH(t,e){for(let i=0;i<e.length;i++){let r=e[i],s=function(t,e){return t.find(t=>t.key===e)}(t,r.key);s?s.operations=[...new Set(s.operations.concat(r.operations))]:t.push(r)}return t}function dN(t,e){var i;if(!t)return null!=e?e:null;let r=t.getFields();return r&&r[e]?null!=(i=r[e].alias)?i:e:null!=e?e:null}function dV(t,e,i){let r=t.getStackSort(),s={},n=null;return r&&(n={},t.getSeries().forEach(t=>{let e=t.getSeriesField();if(e){let i=t.getRawDataStatisticsByField(e);i.values&&(n[e]||(n[e]={lastIndex:0,sort:{}}),i.values.forEach((t,i)=>{t in n[e].sort||(n[e].sort[t]=n[e].lastIndex,n[e].lastIndex++)}))}})),t.getSeries().forEach(t=>{var r;let a=t.getStackData(),l=t.getStackValue(),o=t.getStackValueField(),h=!i||i(t);a&&o&&h&&(s[l]=null!=(r=s[l])?r:{groupField:a.groupField,nodes:{}},dX(t,a,s[l],o,e,n))}),r?dW(s,n):s}function dW(t,e){var i;for(let r in t)(null==(i=t[r].sortDatums)?void 0:i.length)?(t[r].sortDatums.sort((t,e)=>t.index-e.index),t[r].values=t[r].sortDatums.map(t=>t.datum)):dW(t[r].nodes,e);return t}function dU(t,e){if("values"in t&&t.values.length){let i=dR(t.values,e),r=dI(t.values,nh);t.values.forEach(t=>{t[nc]=i,t[np]=r})}else for(let i in t.nodes)dU(t.nodes[i],e)}function dG(t,e){var i,r;if("values"in t&&t.values.length)t5(null==(i=t.values[0])?void 0:i[nc])?t.total=null==(r=t.values[0])?void 0:r[nc]:t.total=dR(t.values,e);else{for(let i in t.nodes)dG(t.nodes[i],e);t.nodes&&(t.total=dR(Object.keys(t.nodes).map(e=>t.nodes[e]),"total"))}}function dZ(t,e,i){var r;if(e.groupField&&e.nodes){let i=(null==(r=t.getRawDataStatisticsByField(e.groupField,!1))?void 0:r.values)||[],s={key:`${e.groupField}`,values:i.map(i=>{var r,s;let n,a=e.nodes[i];return{groupValue:i,value:n=t.bandWidthField&&null!=(s=null==(r=a.values.find(e=>t5(e[t.bandWidthField])))?void 0:r[t.bandWidthField])?s:a.total,end:n}})};dY(s,!1,!0,!1,{key:"groupField",start:"start",end:"end",startPercent:"startPercent",endPercent:"endPercent"}),s.values.forEach(t=>{e.nodes[t.groupValue].mosaicData=t})}else if("values"in e&&e.values.length&&i&&i.length){let t=i.length,r=0,s=1,n=0,a=1;for(let e=0;e<t;e++)if(e%2==0){let t=s-r;s=r+i[e].endPercent*t,r+=i[e].startPercent*t}else{let t=a-n;a=n+i[e].endPercent*t,n+=i[e].startPercent*t}t%2==0?e.values.forEach(t=>{let e=s-r;t[nv]=r+e*t[nh],t[n_]=r+e*t[no],t[ny]=a,t[nm]=n}):e.values.forEach(t=>{let e=a-n;t[ny]=n+e*t[nh],t[nm]=n+e*t[no],t[nv]=s,t[n_]=r})}for(let r in e.nodes)dZ(t,e.nodes[r],e.nodes[r].mosaicData?i?[...i,e.nodes[r].mosaicData]:[e.nodes[r].mosaicData]:null)}function d$(t){if(!t.values.length)return;let e=t.values[t.values.length-1][nl]/2;for(let i=0;i<t.values.length;i++)t.values[i][nu]=t.values[i][na]-e,t.values[i][nd]=t.values[i][nl]-e}function dY(t,e,i,r,s={key:nn,start:na,end:nl,startPercent:no,endPercent:nh,max:ng,min:nf}){let n=r&&t5(s.min),a=r&&t5(s.max);if(t.values.length>0){let r=0,l=0,o=1,h=0,u=null,d=null,c=t.values.length;for(let i=0;i<c;i++){let o=t.values[e?c-1-i:i];(h=o[s.end])>=0?(o[s.start]=r,r+=o[s.end],o[s.end]=r):(o[s.start]=l,l+=o[s.end],o[s.end]=l),o[s.key]=t.key,a&&(delete o[s.max],(!d||o[s.end]>d[s.end])&&(d=o)),n&&(delete o[s.min],(!u||o[s.start]<u[s.start])&&(u=o))}if(a&&d&&(d[s.max]=!0),n&&u&&(u[s.min]=!0),i)for(let i=0;i<c;i++){let n=t.values[e?c-1-i:i],a=(h=n[s.end])>=0?r:l;o=h>=0?1:-1,n[s.startPercent]=0===a?0:Math.min(1,n[s.start]/a)*o,n[s.endPercent]=0===a?0:Math.min(1,n[s.end]/a)*o}}for(let n in t.nodes)dY(t.nodes[n],e,i,r,s)}function dX(t,e,i,r,s,n,a){var l;if("values"in e)if(s&&e.values.forEach(t=>t[nl]=function(t){if(ee(t))return t;let e=+t;return ee(e)?e:0}(t[r])),i.series.push({s:t,values:e.values}),n){let r=t.getSeriesField();e.values.forEach(e=>{i.sortDatums.push({series:t,datum:e,index:r?n[r].sort[e[r]]:0})})}else i.values.push(...e.values);else for(let o in e.nodes){let h=a?`${a}_${o}`:o;i.nodes[o]||(i.nodes[o]={values:[],series:[],nodes:{},sortDatums:[],key:h},t5(null==(l=e.nodes[o])?void 0:l.groupField)&&(i.nodes[o].groupField=e.nodes[o].groupField)),dX(t,e.nodes[o],i.nodes[o],r,s,n,h)}}let dK=(t,e)=>{let i=e.beforeCall();return t&&t.forEach((t,r)=>e.call(t,r,i)),i.keyMap&&(i.keyMap.clear(),i.keyMap=null),t};class dq{static getInstance(){return dq.instance||(dq.instance=new dq),dq.instance}constructor(){this.locale_shortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.locale_periods=["AM","PM"],this.locale_weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.locale_shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.numberRe=/^\s*\d+/,this.pads={"-":"",_:" ",0:"0"},this.requoteRe=/[\\^$*+?|[\]().{}]/g,this.locale_months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.formatShortWeekday=t=>this.locale_shortWeekdays[t.getDay()],this.formatWeekday=t=>this.locale_weekdays[t.getDay()],this.formatShortMonth=t=>this.locale_shortMonths[t.getMonth()],this.formatMonth=t=>this.locale_months[t.getMonth()],this.formatDayOfMonth=(t,e)=>this.pad(t.getDate(),e,2),this.formatHour24=(t,e)=>this.pad(t.getHours(),e,2),this.formatHour12=(t,e)=>this.pad(t.getHours()%12||12,e,2),this.formatMilliseconds=(t,e)=>this.pad(t.getMilliseconds(),e,3),this.formatMonthNumber=(t,e)=>this.pad(t.getMonth()+1,e,2),this.formatMinutes=(t,e)=>this.pad(t.getMinutes(),e,2),this.formatPeriod=t=>this.locale_periods[+(t.getHours()>=12)],this.formatSeconds=(t,e)=>this.pad(t.getSeconds(),e,2),this.formatFullYear=(t,e)=>this.pad(t.getFullYear()%1e4,e,4),this.formatUTCShortWeekday=t=>this.locale_shortWeekdays[t.getUTCDay()],this.formatUTCWeekday=t=>this.locale_weekdays[t.getUTCDay()],this.formatUTCShortMonth=t=>this.locale_shortMonths[t.getUTCMonth()],this.formatUTCMonth=t=>this.locale_months[t.getUTCMonth()],this.formatUTCDayOfMonth=(t,e)=>this.pad(t.getUTCDate(),e,2),this.formatUTCHour24=(t,e)=>this.pad(t.getUTCHours(),e,2),this.formatUTCHour12=(t,e)=>this.pad(t.getUTCHours()%12||12,e,2),this.formatUTCMilliseconds=(t,e)=>this.pad(t.getUTCMilliseconds(),e,3),this.formatUTCMonthNumber=(t,e)=>this.pad(t.getUTCMonth()+1,e,2),this.formatUTCMinutes=(t,e)=>this.pad(t.getUTCMinutes(),e,2),this.formatUTCPeriod=t=>this.locale_periods[+(t.getUTCHours()>=12)],this.formatUTCSeconds=(t,e)=>this.pad(t.getUTCSeconds(),e,2),this.formatUTCFullYear=(t,e)=>this.pad(t.getUTCFullYear()%1e4,e,4),this.formats={a:this.formatShortWeekday,A:this.formatWeekday,b:this.formatShortMonth,B:this.formatMonth,d:this.formatDayOfMonth,e:this.formatDayOfMonth,H:this.formatHour24,I:this.formatHour12,L:this.formatMilliseconds,m:this.formatMonthNumber,M:this.formatMinutes,p:this.formatPeriod,S:this.formatSeconds,Y:this.formatFullYear},this.utcFormats={a:this.formatUTCShortWeekday,A:this.formatUTCWeekday,b:this.formatUTCShortMonth,B:this.formatUTCMonth,d:this.formatUTCDayOfMonth,e:this.formatUTCDayOfMonth,H:this.formatUTCHour24,I:this.formatUTCHour12,L:this.formatUTCMilliseconds,m:this.formatUTCMonthNumber,M:this.formatUTCMinutes,p:this.formatUTCPeriod,S:this.formatUTCSeconds,Y:this.formatUTCFullYear},this.parseShortWeekday=(t,e,i)=>{let r=this.shortWeekdayRe.exec(e.slice(i));return r?(t.w=this.shortWeekdayLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseWeekday=(t,e,i)=>{let r=this.weekdayRe.exec(e.slice(i));return r?(t.w=this.weekdayLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseShortMonth=(t,e,i)=>{let r=this.shortMonthRe.exec(e.slice(i));return r?(t.m=this.shortMonthLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseMonth=(t,e,i)=>{let r=this.monthRe.exec(e.slice(i));return r?(t.m=this.monthLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseDayOfMonth=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.d=+r[0],i+r[0].length):-1},this.parseHour24=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.H=+r[0],i+r[0].length):-1},this.parseMilliseconds=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+3));return r?(t.L=+r[0],i+r[0].length):-1},this.parseMonthNumber=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.m=r-1,i+r[0].length):-1},this.parseMinutes=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.M=+r[0],i+r[0].length):-1},this.parsePeriod=(t,e,i)=>{let r=this.periodRe.exec(e.slice(i));return r?(t.p=this.periodLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseSeconds=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.S=+r[0],i+r[0].length):-1},this.parseFullYear=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+4));return r?(t.y=+r[0],i+r[0].length):-1},this.parses={a:this.parseShortWeekday,A:this.parseWeekday,b:this.parseShortMonth,B:this.parseMonth,d:this.parseDayOfMonth,e:this.parseDayOfMonth,H:this.parseHour24,I:this.parseHour24,L:this.parseMilliseconds,m:this.parseMonthNumber,M:this.parseMinutes,p:this.parsePeriod,S:this.parseSeconds,Y:this.parseFullYear},this.timeFormat=(t,e)=>this.newFormat(t,this.formats)(new Date(this.getFullTimeStamp(e))),this.timeUTCFormat=(t,e)=>this.newFormat(t,this.utcFormats)(new Date(this.getFullTimeStamp(e))),this.timeParse=(t,e)=>this.newParse(t,!1)(e+""),this.requoteF=this.requote.bind(this),this.periodRe=this.formatRe(this.locale_periods),this.periodLookup=this.formatLookup(this.locale_periods),this.weekdayRe=this.formatRe(this.locale_weekdays),this.weekdayLookup=this.formatLookup(this.locale_weekdays),this.shortWeekdayRe=this.formatRe(this.locale_shortWeekdays),this.shortWeekdayLookup=this.formatLookup(this.locale_shortWeekdays),this.monthRe=this.formatRe(this.locale_months),this.monthLookup=this.formatLookup(this.locale_months),this.shortMonthRe=this.formatRe(this.locale_shortMonths),this.shortMonthLookup=this.formatLookup(this.locale_shortMonths)}requote(t){return t.replace(this.requoteRe,"\\$&")}localDate(t){if(0<=t.y&&t.y<100){let e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}utcDate(t){if(0<=t.y&&t.y<100){let e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}newDate(t,e,i){return{y:t,m:e,d:i,H:0,M:0,S:0,L:0}}formatRe(t){return RegExp("^(?:"+t.map(this.requoteF).join("|")+")","i")}formatLookup(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}pad(t,e,i){let r=t<0?"-":"",s=(r?-t:t)+"",n=s.length;return r+(n<i?Array(i-n+1).join(e)+s:s)}parseSpecifier(t,e,i,r){let s,n,a=0,l=e.length,o=i.length;for(;a<l;){if(r>=o)return -1;if(37===(s=e.charCodeAt(a++))){if(s=e.charAt(a++),!(n=this.parses[s in this.pads?e.charAt(a++):s])||(r=n(t,i,r))<0)return -1}else if(s!==i.charCodeAt(r++))return -1}return r}newParse(t,e){let i=this;return function(r){let s=i.newDate(1900,void 0,1);return i.parseSpecifier(s,t,r+="",0)!==r.length?null:"Q"in s?new Date(s.Q):"s"in s?new Date(1e3*s.s+("L"in s?s.L:0)):(!e||"Z"in s||(s.Z=0),"p"in s&&(s.H=s.H%12+12*s.p),void 0===s.m&&(s.m="q"in s?s.q:0),"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,i.utcDate(s)):i.localDate(s))}}newFormat(t,e){let i=this;return function(r){let s,n,a=[],l=-1,o=0,h=t.length;for(r instanceof Date||(r=new Date(+r));++l<h;)37===t.charCodeAt(l)&&(a.push(t.slice(o,l)),(n=i.pads[s=t.charAt(++l)])?s=t.charAt(++l):n="e"===s?" ":"0",a.push(s=(0,e[s])(r,n)),o=l+1);return a.push(t.slice(o,l)),a.join("")}}getFullTimeStamp(t){let e=parseInt(t+"",10);return 10===String(e).length?1e3*e:e}}function dQ(t,e){return e("component",t)}function dJ(t,e,i,r){if(t)return{formatFunc:t,args:[i,r]};let s=ig.getFormatter();return e&&s?{formatFunc:s,args:[i,r,e]}:{}}let d0=(t,e,i,r)=>{if(et(t[e]))return;let s=tY(t[e]),n=s?t[e]:[t[e]],a=[];return n.forEach((t,n)=>{t&&(!r||r(t))&&a.push({spec:t,specPath:s?[e,n]:[e],specInfoPath:["component",e,n],type:i})}),a},d1=(t,e,i,r)=>{let s;if(s=tK(t)?t(e,i):tQ(t)&&t5(t.field)?iF(e,t.field):t,r){let{formatFunc:i,args:n}=dJ(void 0,r,t,e);i&&n&&(s=i(...n))}return s},d2=(t,e,i)=>et(t)?t:tK(t)?t(e,i):t;var d3=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};let d5=t=>{var e,i,r;if(!1===(null==t?void 0:t.visible))return[];let s={mark:!1!==(null==(e=null==t?void 0:t.mark)?void 0:e.visible),dimension:!1!==(null==(i=null==t?void 0:t.dimension)?void 0:i.visible),group:!1!==(null==(r=null==t?void 0:t.group)?void 0:r.visible)};return t5(null==t?void 0:t.activeType)&&Object.keys(s).forEach(e=>{var i;s[e]=null==(i=null==t?void 0:t.activeType)?void 0:i.includes(e)}),Object.keys(s).filter(t=>s[t])},d4=(t,e)=>!e||!1!==e.visible&&(!e[t]||!1!==e[t].visible)&&!(e.activeType&&!(tY(e.activeType)?e.activeType.includes(t):e.activeType===t));function d7(t,e,i,r,s,n){let a=e=>{if(e){let a={datum:s},l=et(e.key)&&et(e.value)&&!nR(e)?Object.assign(Object.assign(Object.assign({},r),i),e):Object.assign(Object.assign({},r),e),{key:o,keyFormatter:h,keyTimeFormat:u,keyTimeFormatMode:d,value:c,valueFormatter:p,valueTimeFormat:g,valueTimeFormatMode:f}=l,m=d3(l,["key","keyFormatter","keyTimeFormat","keyTimeFormatMode","value","valueFormatter","valueTimeFormat","valueTimeFormatMode"]);a.key=d9(d1(o,s,n,h),u,d),a.value=d9(d1(c,s,n,p),g,f),Object.keys(m).forEach(t=>{a[t]=d1(l[t],s,n)}),!1!==a.visible&&(t5(a.key)||t5(a.value))&&t.push(a)}};tY(e)?e.forEach(t=>{a(t)}):a(e)}function d6(t,e,i,r,s,n,a){tK(e)?d7(t,e(s,a),i,r,n,a):e&&d7(t,e,i,r,n,a)}let d9=(t,e,i)=>{if(!e&&!i)return"object"!=typeof t?null==t?void 0:t.toString():t;let r=dq.getInstance();return e=e||"%Y%m%d",("local"===(i=i||"local")?r.timeFormat:r.timeUTCFormat)(e,t)};class d8{constructor(t){this.activeTriggerSet={mark:new Set,group:new Set},this.ignoreTriggerSet={mark:new Set},this._getSeriesCacheInfo=()=>{var t,e,i;let{series:r}=this,s=r.getSeriesField();return{seriesFields:t5(s)?eo(s):null!=(t=r.getSeriesKeys())?t:[],dimensionFields:null!=(e=r.getDimensionField())?e:[],measureFields:null!=(i=r.getMeasureField())?i:[],type:r.type}},this._getDimensionData=t=>{let{dimensionFields:e}=this._seriesCacheInfo;return e[0]&&(null==t?void 0:t[e[0]])},this._getMeasureData=t=>{let{measureFields:e}=this._seriesCacheInfo;return e[0]&&(null==t?void 0:t[e[0]])},this._getSeriesFieldData=t=>{let{dimensionFields:e,seriesFields:i}=this._seriesCacheInfo;if(t5(i[0])&&(null==t?void 0:t[i[0]]))return null==t?void 0:t[i[0]];let r=e[e.length-1];return e.length>1&&(0===i.length||this.series.getSeriesKeys().length),null==t?void 0:t[r]},this._getSeriesStyle=(t,e,i)=>{var r;for(let i of eo(e)){let e=null==(r=this.series.getSeriesStyle(t))?void 0:r(i);if(t5(e))return e}return i},this.markTooltipKeyCallback=(t,e)=>this._getSeriesFieldData(t),this.markTooltipValueCallback=(t,e)=>this._getMeasureData(t),this.shapeTypeCallback=(t,e)=>{var i;return null!=(i=this._getSeriesStyle(t,"shape",null))?i:this._getSeriesStyle(t,"symbolType",this.series.getDefaultShapeType())},this.shapeColorCallback=(t,e)=>this._getSeriesStyle(t,["fill","stroke"]),this.shapeStrokeCallback=(t,e)=>this._getSeriesStyle(t,["stroke","fill"]),this.dimensionTooltipTitleCallback=(t,e)=>this._getDimensionData(t),this.groupTooltipTitleCallback=(t,e)=>this._getSeriesFieldData(t),this.groupTooltipKeyCallback=(t,e)=>{let{seriesFields:i}=this._seriesCacheInfo,r=this._seriesCacheInfo.dimensionFields;return i[0]&&(r=r.filter(t=>t!==i[0])),r.map(e=>null==t?void 0:t[e]).join("-")},this.getHasShape=t=>!!t,this.series=t,this.updateTooltipSpec()}updateTooltipSpec(){var t;let e=null==(t=this.series.getSpec())?void 0:t.tooltip;this.spec=e,this._seriesCacheInfo=this._getSeriesCacheInfo()}getShapeAttrs(t,e,i){var r,s,n,a,l,o,h,u,d,c,p,g;let f=e?"content":"title",m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},null==(r=null==i?void 0:i.style)?void 0:r.shape),null==i?void 0:i[t]),null==(s=null==i?void 0:i[t])?void 0:s[f]),null==(n=this.spec)?void 0:n[t]),null==(l=null==(a=this.spec)?void 0:a[t])?void 0:l[f]);return{shapeType:null!=(o=m.shapeType)?o:this.shapeTypeCallback,shapeFill:null!=(u=null!=(h=m.shapeFill)?h:m.shapeColor)?u:this.shapeColorCallback,shapeStroke:null!=(d=m.shapeStroke)?d:this.shapeStrokeCallback,shapeHollow:null!=(c=m.shapeHollow)&&c,shapeLineWidth:m.shapeLineWidth,shapeSize:null!=(p=m.shapeSize)?p:m.size,hasShape:null!=(g=m.hasShape)?g:this.getHasShape(e)}}enableByType(t){return!0}getDefaultContentList(t){return[this.getDefaultContentPattern(t)]}getContentList(t,e,i,r,s,n){var a;return function(t,e,i,r,s,n){if(s&&s.length){let a=[];return s.forEach(s=>{tY(t)?t.forEach(t=>{d6(a,t,e,i,r,s,n)}):tK(t)?d6(a,t,e,i,r,s,n):t&&d7(a,t,e,i,s,n)}),a}return null}(null!=(a=null==e?void 0:e.content)?a:this.getDefaultContentList(t),this.getDefaultContentPattern(t),i,r,s,n)}getTitleResult(t,e,i,r,s){let n=tK(e)?e(r,s):e;if(n?et(n.value)&&(n=Object.assign(Object.assign({},this.getDefaultTitlePattern(t)),n)):n=this.getDefaultTitlePattern(t),n&&!1!==n.visible){let t=function(t){var e;for(let{data:i}of(null==(e=t[0])?void 0:e.series)?[{data:t,value:""}]:t)for(let{datum:t}of i)for(let e of null!=t?t:[])if(e)return e}(r),e={visible:d1(n.visible,t,s),value:d9(d1(n.value,t,s,n.valueFormatter),n.valueTimeFormat,n.valueTimeFormatMode),valueStyle:d1(n.valueStyle,t,s),hasShape:n.hasShape};return Object.keys(i).forEach(r=>{e[r]=d1(i[r],t,s)}),e}return{hasShape:!1,visible:!1}}getTooltipData(t,e,i,r,s){var n,a;let l;if(!(this.enableByType(t)&&d4(t,this.spec)&&("dimension"!==t||r&&r.length)))return null;let o=null!=(a=null==(n=this.spec)?void 0:n[t])?a:null==e?void 0:e[t],h=this.getShapeAttrs(t,!0,e),u=this.getShapeAttrs(t,!1,e);return"dimension"===t?(l=[],this.getContentList(t,o,h,i,r,s).forEach(t=>{l.push(t)})):l=this.getContentList(t,o,h,i,r,s),{visible:!0,activeType:t,data:i,title:this.getTitleResult(t,null==o?void 0:o.title,u,i,s),content:l}}getDefaultTitlePattern(t){return{key:void 0,value:"group"===t?this.groupTooltipTitleCallback:this.dimensionTooltipTitleCallback}}getDefaultContentPattern(t){return{seriesId:this.series.id,key:"group"===t?this.groupTooltipKeyCallback:this.markTooltipKeyCallback,value:this.markTooltipValueCallback}}}let ct={min:t=>t.length?ed(t.map(t=>+t)):0,max:t=>t.length?eu(t.map(t=>+t)):0,"array-min":t=>t.length?ed(t.map(t=>+t)):0,"array-max":t=>t.length?eu(t.map(t=>+t)):0,values:t=>{let e={},i=[];for(let r of t)e[r]||(i.push(r),e[r]=1);return i}},ce=(t,e)=>{var i,r;let s=e.fields;if(tK(s)&&(s=s()),!(null==s?void 0:s.length)||!(null==t?void 0:t.length))return{};s=dH([],s);let n="parser"===e.target?"parserData":"latestData";return ci(t[0][n]?t[0][n]:t||[],s,null==(r=(i=t[0]).getFields)?void 0:r.call(i))},ci=(t,e,i)=>{let r={},s=[],n=[];return e.forEach(e=>{let a=e.key;r[a]={};let l=null==i?void 0:i[a],o=e.operations,h=o.some(t=>"min"===t||"max"===t||"allValid"===t),u=!0;s.length=0,t&&t.forEach(t=>{t&&s.push(t[a])});let d=s.length;if(h){n.length=0,s.forEach((t,e)=>{ef(t)&&n.push(t)});let t=s;s=n,n=t,u=s.length===d}else s=o.some(t=>"array-min"===t||"array-max"===t)?s.reduce((t,e)=>(e&&e.forEach(e=>{ef(e)&&t.push(e)}),t),[]):s.filter(t=>void 0!==t);e.filter&&(s=s.filter(e.filter)),o.forEach(t=>{if(e.customize)r[a][t]=e.customize;else{if(l&&!0===l.lockStatisticsByDomain&&!et(l.domain)){if("values"===t)return void(r[a][t]=l.domain.slice())}else if("allValid"===t)return;r[a][t]=ct[t](s),"array-max"===t&&(r[a].max=r[a][t]),"array-min"===t&&(r[a].min=r[a][t])}}),h&&(r[a].allValid=u)}),r},cr=(t,e)=>{let{config:i}=e;if(!i)return t;let{invalidType:r,checkField:s}=i();return"zero"!==r||s&&s.length&&t.forEach(t=>{s.forEach(e=>{ef(t[e])||(t[e]=0)})}),t},cs=`${s6}_HIERARCHY_DEPTH`,cn=`${s6}_HIERARCHY_ROOT`,ca=`${s6}_HIERARCHY_ROOT_INDEX`;function cl(){return{keyMap:new Map,needDefaultSeriesField:!this._seriesField,defaultSeriesField:this._seriesField?null:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey)}}function co(t,e,i){t&&(i.needDefaultSeriesField&&(t[nr]=i.defaultSeriesField),t[ne]=e,t[ni]=i.getKey(t,e,i))}function ch(){return{keyMap:new Map,needDefaultSeriesField:!0,defaultSeriesField:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey),categoryField:this.getCategoryField()}}function cu(t,e,i,r=0,s,n){void 0===n&&(n=e),co(t,e,i),t[cs]=r,t[cn]=s||t[i.categoryField],t[ca]=n,t.children&&t.children.length&&t.children.forEach((e,r)=>cu(e,r,i,t[cs]+1,t[cn],n))}let cd={label:{name:"label",type:"text"}},cc=`${s6}_rect_x`,cp=`${s6}_rect_x1`,cg=`${s6}_rect_y`,cf=`${s6}_rect_y1`,cm={data:!0},cy={invalidType:!0,animation:!0,animationAppear:!0,animationEnter:!0,animationUpdate:!0,animationExit:!0,animationNormal:!0},c_=[...Object.keys(uX),"normal"];function cv(t={},e,i){let r={};for(let s=0;s<c_.length;s++){let n,a,l=c_[s],o=e?e[l]:void 0;if(!1!==o){if("normal"===l){o&&(r.normal=o);continue}if("state"===l){!1!==o&&(r.state=null!=o?o:uX.state);continue}("update"===l||o||t[l])&&((n=tY(t[l])?t[l]:[Object.assign(Object.assign({},uX[l]),t[l])],"exit"===l&&n.forEach(t=>{t.controlOptions={stopWhenStateChange:!0}}),o)?(a=tY(o)?o.map((t,e)=>{var r;let s=t;return cA(s)&&delete s.type,s.oneByOne&&(s=cx(s,null!=(r=null==i?void 0:i.dataIndex)?r:cS,null==i?void 0:i.dataCount)),s}):n.map((t,e)=>{var r;let s=it({},n[e],o);return cA(s)&&delete s.type,s.oneByOne&&(s=cx(s,null!=(r=null==i?void 0:i.dataIndex)?r:cS,null==i?void 0:i.dataCount)),s}),r[l]=a):r[l]=n)}}return r}function cb(t,e,i){var r,s,n,a,l,o;let h={};return t5(e.animationAppear)&&(h.appear=null!=(r=e.animationAppear[t])?r:e.animationAppear),t5(e.animationDisappear)&&(h.disappear=null!=(s=e.animationDisappear[t])?s:e.animationDisappear),t5(e.animationEnter)&&(h.enter=null!=(n=e.animationEnter[t])?n:e.animationEnter),t5(e.animationExit)&&(h.exit=null!=(a=e.animationExit[t])?a:e.animationExit),t5(e.animationUpdate)&&(h.update=null!=(l=e.animationUpdate[t])?l:e.animationUpdate),t5(e.animationState)&&(h.state=null!=(o=e.animationState[t])?o:e.animationState),e.animationNormal&&e.animationNormal[t]&&(h.normal=e.animationNormal[t]),function(t,e){if(!t)return t;let i=["custom","customParameters"];return function t(e,i,r=[]){if(tY(e))e.forEach((s,n)=>{e[n]=i(e[n],n),t(e[n],i,r)});else if(ey(e))for(let s in e)r.includes(s)||(e[s]=i(e[s],s),t(e[s],i,r))}(t=t4(t,null,i),t=>{var i;return tK(t)&&(null==(i=t.prototype)?void 0:i.constructor)!==t?(...i)=>t(...i,e):t},i),t}(h,i)}function cx(t,e,i){let{oneByOne:r,duration:s,delay:n,delayAfter:a}=t;return t.delay=(t,i,a)=>{let l=e(t,a),o=tK(s)?s(t,i,a):ee(s)?s:0,h=tK(n)?n(t,i,a):ee(n)?n:0,u=tK(r)?r(t,i,a):r;return!1===u?h:h+l*(o+(u=!0===u?0:u))},t.delayAfter=(t,n,l)=>{let o=e(t,l),h=tK(s)?s(t,n,l):ee(s)?s:0,u=tK(a)?a(t,n,l):ee(a)?a:0,d=tK(r)?r(t,n,l):r;return!1===d?u:(d=!0===d?0:d,u+((i?i():n.parent.count-1)-o)*(h+d))},delete t.oneByOne,t}function cS(t,e){var i;return null!=(i=null==t?void 0:t[ne])?i:e.context.graphicIndex}function ck(t,e){var i,r,s,n,a;if(!1===t.animation||!1===(null==(i=t.morph)?void 0:i.enable))return!1;let l=!1!==(null!=(s=null==(r=t.animationAppear)?void 0:r[e])?s:t.animationAppear),o=!1!==(null!=(a=null==(n=t.animationUpdate)?void 0:n[e])?a:t.animationUpdate);return!(!l||!o)}function cA(t){return!t5(t.timeSlices)&&t5(t.channel)}function cM(t){var e,i,r,s,n,a;let l=t.getSpec();if(!1===l.animation||!1===(null==(i=null==(e=t.getOption())?void 0:e.globalInstance)?void 0:i.isAnimationEnable()))return!1;let o=null!=(r=l.animationThreshold)?r:Number.MAX_SAFE_INTEGER;return null==(s=t.getMarks())||s.forEach(t=>{let e=t.getMarkConfig();e&&(e.large&&e.largeThreshold&&(o=Math.min(o,e.largeThreshold)),e.progressiveThreshold&&(o=Math.min(o,e.progressiveThreshold)))}),!((null==(a=null==(n=t.getRawData())?void 0:n.latestData)?void 0:a.length)>=o)}class cw extends nZ{constructor(){super(...arguments),this.markLabelSpec={}}getLabelSpec(t){return this.markLabelSpec[t]}setLabelSpec(t,e){this.markLabelSpec[t]=eo(e)}addLabelSpec(t,e,i=!1){this.markLabelSpec[t]||(this.markLabelSpec[t]=[]),i?this.markLabelSpec[t].unshift(e):this.markLabelSpec[t].push(e)}getTheme(t,e){var i,r,s;let n=eJ(t),a=null==(i=this._option)?void 0:i.getTheme,l=this._option.type,o=ig.getSeriesMarkMap(l)?function(t,e,i){let r=ig.getSeriesMarkMap(e);if(!r)return t;let s={};return Object.values(r).forEach(({type:e,name:r})=>{s[r]=it({},i("mark",eo(e)[0]),i("markByName",r),null==t?void 0:t[r])}),Object.assign(Object.assign({},t),s)}(a("series",l),l,a):{},h=a("series",`${l}_${n}`),u=(null!=(s=null!=(r=this.stack)?r:null==h?void 0:h.stack)?s:null==o?void 0:o.stack)?a("series",`${l}_stack`):void 0;return it({},o,h,u)}transformSpec(t,e,i){this._transformStack(t);let r=super.transformSpec(t,e,i);return this._transformLabelSpec(r.spec),Object.assign(Object.assign({},r),{markLabelSpec:this.markLabelSpec,stack:this.stack})}_transformLabelSpec(t){}_transformStack(t){t$(t.stack)&&(this.stack=t.stack),t$(t.percent)&&(this.stack=t.percent||this.stack),et(this.stack)&&this._supportStack&&t.seriesField&&(this.stack=!0)}_addMarkLabelSpec(t,e,i="label",r="initLabelMarkStyle",s=!0,n){t&&eo(t[i]).forEach(i=>{var a,l,o;if(i&&i.visible){let{animation:h=!0,animationUpdate:u=!0,animationEnter:d=!0,animationExit:c=!0}=i,{animationUpdate:p=!0,animationEnter:g=!0,animationExit:f=!0}=t,m=!!(null!=(o=null!=(l=null==(a=this._option.globalInstance)?void 0:a.isAnimationEnable())?l:t.animation)?o:i.animation)&&!!s;this.addLabelSpec(tK(e)?e(i):e,Object.assign(Object.assign({},i),{animation:!!m&&h,animationUpdate:!!(m&&p&&u)&&p,animationEnter:!!(m&&g&&d)&&g,animationExit:!!(m&&g&&c)&&f,getStyleHandler:t=>{var e;return null==(e=t[r])?void 0:e.bind(t)}}),n)}})}_getDefaultSpecFromChart(t){var e;let i=null!=(e=super._getDefaultSpecFromChart(t))?e:{},{outerRadius:r,innerRadius:s,direction:n}=t;return t5(r)&&(i.outerRadius=r),t5(s)&&(i.innerRadius=s),t5(n)&&(i.direction=n),Object.keys(i).length>0?i:void 0}_mergeThemeToSpec(t,e){let i=this._theme;if(this._shouldMergeThemeToSpec()){let r=this._getDefaultSpecFromChart(e),s=t=>{let e=it({},i,r,t),s=i.label;return s&&ey(s)&&tY(e.label)&&(e.label=e.label.map(t=>it({},s,t))),e};return tY(t)?{spec:t.map(t=>s(t)),theme:i}:{spec:s(t),theme:i}}return{spec:t,theme:i}}}class cT extends nq{getRegion(){return this._region}getLayoutStartPoint(){return this._region.getLayoutStartPoint()}getRootMark(){return this._rootMark}getSeriesMark(){return this._seriesMark}getRawData(){return this._rawData}getViewDataFilter(){return this._viewDataFilter}getViewData(){var t;return null==(t=this._data)?void 0:t.getDataView()}getViewDataProductId(){var t;return null==(t=this._data)?void 0:t.getProductId()}getViewDataStatistics(){return this._viewDataStatistics}getViewStackData(){return this._viewStackData}getSeriesField(){return this._seriesField}setSeriesField(t){t5(t)&&(this._seriesField=t)}getGroups(){return this._groups}getStack(){var t;return null==(t=this.getSpecInfo())?void 0:t.stack}getStackValue(){var t;return null!=(t=this._spec.stackValue)?t:`${s6}_series_${this.type}`}getPercent(){return this._spec.percent}getStackOffsetSilhouette(){return this._spec.stackOffsetSilhouette}get tooltipHelper(){return this._tooltipHelper||this.initTooltip(),this._tooltipHelper}getInvalidType(){return this._invalidType}setInvalidType(t){var e;this._invalidType=t,null==(e=this.getViewData())||e.reRunAllTransform()}getMarkAttributeContext(){return this._markAttributeContext}constructor(t,e){var i;super(t,e),this.specKey="series",this.type="series",this.layoutType="absolute",this.modelType="series",this.name=void 0,this.transformerConstructor=cw,this.coordinate="none",this._region=null,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:null,height:null},this.getLayoutRect=()=>{var t,e;return{width:null!=(t=this._layoutRect.width)?t:this._region.getLayoutRect().width,height:null!=(e=this._layoutRect.height)?e:this._region.getLayoutRect().height}},this._rootMark=null,this._seriesMark=null,this._viewDataMap=new Map,this._viewDataFilter=null,this._data=null,this.layoutZIndex=z.SeriesGroup,this._invalidType="break",this._region=e.region,this._dataSet=e.dataSet,(null==(i=this._spec)?void 0:i.name)&&(this.name=this._spec.name)}created(){super.created(),this._buildMarkAttributeContext(),this.initData(),this.initGroups(),this.initStatisticalData(),this.event.emit(rB.afterInitData,{model:this}),this.initRootMark(),this.initMark();let t=cM(this);this._initExtensionMark({hasAnimation:t}),this.initMarkStyle(),this.initMarkState(),t&&this.initAnimation(),this.afterInitMark(),this.initEvent(),this.event.emit(rB.afterInitEvent,{model:this})}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(t,e)=>{var i;return null==(i=this._option.globalScale.getScale(t))?void 0:i.scale(e)},seriesColor:t=>{var e;return et(t)&&(t=this.getSeriesKeys()[0]),null==(e=this._option.globalScale.getScale("color"))?void 0:e.scale(t)},getRegion:()=>this._region}}setAttrFromSpec(){super.setAttrFromSpec(),this.setSeriesField(this._spec.seriesField),t5(this._spec.invalidType)&&(this._invalidType=this._spec.invalidType)}getInvalidCheckFields(){return[this.getStackValueField()]}initInvalidDataTransform(){var t,e;"zero"===this._invalidType&&(null==(t=this._rawData)?void 0:t.dataSet)&&(sY(this._rawData.dataSet,"invalidTravel",cr),null==(e=this._rawData)||e.transform({type:"invalidTravel",options:{config:()=>({invalidType:this._invalidType,checkField:this.getInvalidCheckFields()})}},!1))}initData(){var t,e,i;let r=null!=(t=this._spec.data)?t:this._option.getSeriesData(this._spec.dataId,this._spec.dataIndex);if(r&&(this._rawData=s2(r,this._dataSet,this._option.sourceDataList)),null==(i=null==(e=this._rawData)?void 0:e.target)||i.addListener("change",this.rawDataUpdate.bind(this)),this._addDataIndexAndKey(),this._rawData){this.getStack()&&(this._viewDataFilter=s1(this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewDataFilter`}));let t=s1(this.getStack()?this._viewDataFilter:this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewData`});this._data=new ly(this._option,t),this.getStack()&&this._viewDataFilter.target.removeListener("change",t.reRunAllTransform)}this.initInvalidDataTransform()}initGroups(){let t=this.getGroupFields();t&&t.length&&(this._groups={fields:t})}initStatisticalData(){this._data&&this._statisticViewData()}getRawDataStatisticsByField(t,e){var i,r,s;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]||e&&(et(this._rawStatisticsCache[t].min)||et(this._rawStatisticsCache[t].max))||!e&&et(this._rawStatisticsCache[t].values)){if(this._viewDataStatistics&&(!this._viewDataFilter||this._viewDataFilter.transformsArr.length<=1)&&this.getViewData().transformsArr.length<=1&&(null==(i=this._viewDataStatistics.latestData)?void 0:i[t]))this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t];else if(this._rawData){let i=null==(r=this._rawData.getFields())?void 0:r[t];if(i&&i.lockStatisticsByDomain&&i.domain)this._rawStatisticsCache[t]={},e?(this._rawStatisticsCache[t].min=ed(i.domain),this._rawStatisticsCache[t].max=eu(i.domain)):this._rawStatisticsCache[t].values=i.domain;else{let i=ci(this._rawData.latestData,[{key:t,operations:e?["min","max"]:["values"]}])[t];this._rawStatisticsCache[t]=t8(null!=(s=this._rawStatisticsCache[t])?s:{},i)}}}return this._rawStatisticsCache[t]}_statisticViewData(){sY(this._dataSet,"dimensionStatistics",ce);let t=`${this.type}_${this.id}_viewDataStatic`;this._viewDataStatistics=new er(this._dataSet,{name:t}),this._viewDataStatistics.parse([this._data.getDataView()],{type:"dataview"}),this._viewDataStatistics.transform({type:"dimensionStatistics",options:{fields:()=>{let t=this.getStatisticFields();return this._seriesField&&dH(t,[{key:this._seriesField,operations:["values"]}]),t},target:"latest"}},!1),this._data.getDataView().target.removeListener("change",this._viewDataStatistics.reRunAllTransform),this.getStack()&&this.createdStackData()}createStatisticalData(t,e,i){sY(this._dataSet,"dimensionStatistics",ce);let r=new er(this._dataSet,{name:t});return r.parse([e],{type:"dataview"}),r.transform({type:"dimensionStatistics",options:{operations:["max","min","values"],fields:()=>{var t;let r=dH(this.getStatisticFields(),null!=(t=null==i?void 0:i(e.name))?t:[]);return this._seriesField&&dH(r,[{key:this._seriesField,operations:["values"]}]),r},target:"latest"}},!1),r}createdStackData(){let t=`${this.type}_${this.id}_viewStackData`;this._viewStackData=new er(this._dataSet,{name:t}),this._viewStackData.parse([this._viewDataFilter],{type:"dataview"}),this._viewStackData.transform({type:"stackSplit",options:{fields:this.getStackGroupFields()}},!1)}_noAnimationDataKey(t,e){return e}generateDefaultDataKey(t){var e;return et(t)?(t,e,i)=>{if(!1===this._spec.animation){let i=this._noAnimationDataKey(t,e);if(void 0!==i)return i}let{keyMap:r}=i,s=this._getSeriesDataKey(t);return void 0===r.get(s)?(r.set(s,0),s):(r.set(s,r.get(s)+1),`${s}_${r.get(s)}`)}:t3(t)?e=>e[t]:tY(t)&&t.every(t=>t3(t))?e=>t.map(t=>e[t]).join("-"):tK(t)?(e,i)=>t(e,i):(null==(e=this._option)||e.onError(`invalid dataKey: ${t}`),(t,e)=>{})}_addDataIndexAndKey(){var t;(null==(t=this._rawData)?void 0:t.dataSet)&&(sY(this._rawData.dataSet,"addVChartProperty",dK),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:cl.bind(this),call:co}},!1))}updateRawData(t){this._rawData&&this._rawData.updateRawData(t)}rawDataUpdate(t){var e;null==(e=this._rawDataStatistics)||e.reRunAllTransform(),this._rawStatisticsCache=null,this.event.emit(rB.rawDataUpdate,{model:this})}viewDataFilterOver(t){this.event.emit(rB.viewDataFilterOver,{model:this})}viewDataUpdate(t){var e;this.event.emit(rB.viewDataUpdate,{model:this}),null==(e=this._data)||e.updateData(),this._viewDataStatistics&&this._viewDataStatistics.reRunAllTransform()}viewDataStatisticsUpdate(t){this.event.emit(rB.viewDataStatisticsUpdate,{model:this})}getDatumPositionValue(t,e){return!t||et(e)?null:t[e]}getDatumPositionValues(t,e){return!t||et(e)?[]:t3(e)?[t[e]]:e.map(e=>t[e])}setValueFieldToStack(){}setValueFieldToPercent(){}setValueFieldToStackOffsetSilhouette(){}initRootMark(){var t,e,i;this._rootMark=this._createMark({type:"group",name:`seriesGroup_${this.type}_${this.id}`},{parent:null==(e=(t=this._region).getGroupMark)?void 0:e.call(t),dataView:!1}),this._rootMark.setMarkConfig({zIndex:null!=(i=this._spec.zIndex)?i:this.layoutZIndex})}_getExtensionMarkNamePrefix(){return`${this.type}_${this.id}_extensionMark`}_initExtensionMark(t){var e;this._spec.extensionMark&&(null==(e=this._spec.extensionMark)||e.forEach((e,i)=>{this._createExtensionMark(e,null,this._getExtensionMarkNamePrefix(),i,t)}))}_createExtensionMark(t,e,i,r,s){var n;let a=this._createMark({type:t.type,name:t5(t.name)?`${t.name}`:`${i}_${r}`},{skipBeforeLayouted:!0,markSpec:t,parent:e,dataView:!1,componentType:t.componentType,key:t.dataKey});if(a){if(t5(t.id)&&a.setUserId(t.id),s.hasAnimation){let e=cv({},cb(t.type,t,this._markAttributeContext));a.setAnimationConfig(e)}if("group"===t.type)i=`${i}_${r}`,null==(n=t.children)||n.forEach((t,e)=>{this._createExtensionMark(t,a,i,e,s)});else if(!(e||et(t.dataId)&&et(t.dataIndex))){let e=this._option.getSeriesData(t.dataId,t.dataIndex);e===this._rawData?a.setData(this._data):(a.setDataView(e),e.target.addListener("change",()=>{a.getData().updateData()}))}}}_updateExtensionMarkSpec(){var t;null==(t=this._spec.extensionMark)||t.forEach((t,e)=>{let i=this._marks.getMarkWithInfo({name:t5(t.name)?`${t.name}`:`${this._getExtensionMarkNamePrefix()}_${e}`});i&&(this.initMarkStyleWithSpec(i,t),i.commit(!1,!0))})}getStackData(){var t;return null==(t=this._viewStackData)?void 0:t.latestData}_parseDefaultInteractionConfig(t){var e;if(!(null==t?void 0:t.length))return[];let i=(e=this._option.mode)===rk["desktop-browser"]||e===rk["desktop-miniApp"]?{hover:{enable:!0,trigger:"pointermove",triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"pointertap"}}:eB(e)||eP(e)?{hover:{enable:!0,trigger:["pointerdown","pointermove"],triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"tap"}}:null,r=Object.assign({},null==i?void 0:i.hover),s=Object.assign({},null==i?void 0:i.select),n=this._spec.hover;t$(n)?r.enable=n:ey(n)&&(r.enable=!0,r=it(r,n));let a=this._spec.select;t$(a)?s.enable=a:ey(a)&&(s.enable=!0,s=it(s,a));let l=[{trigger:{type:"dimension-hover"},marks:t}];if(r.enable){let e=ds(r,t);e.length&&l.push({trigger:this._defaultHoverConfig(r),marks:e})}if(s.enable){let e=ds(s,t);e.length&&l.push({trigger:this._defaultSelectConfig(s),marks:e})}return l}_defaultHoverConfig(t){return{type:"element-highlight",trigger:t.trigger,triggerOff:t.triggerOff,blurState:V.STATE_HOVER_REVERSE,highlightState:V.STATE_HOVER}}_defaultSelectConfig(t){let e="multiple"===t.mode,i=t5(t.triggerOff)?t.triggerOff:e?["empty"]:["empty",t.trigger];return{type:"element-select",trigger:t.trigger,triggerOff:i,reverseState:V.STATE_SELECTED_REVERSE,state:V.STATE_SELECTED,isMultiple:e}}_parseInteractionConfig(t){let{interactions:e}=this._spec,i=this._parseDefaultInteractionConfig(t);return e&&e.length&&e.forEach(t=>{let e=ds(t,this.getMarks());e.length&&i.push({trigger:t,marks:e})}),i}getInteractionTriggers(){if(!0!==this._option.disableTriggerEvent){let t=this.getMarksWithoutRoot();return this._parseInteractionConfig(t)}return[]}initAnimation(){}initMarkState(){this.initSeriesStyleState()}initSeriesStyleState(){var t;let e=this._spec.seriesStyle;if(!e||!e.length)return;let i=null!=(t=this._seriesField)?t:nr;this.getMarksWithoutRoot().forEach(t=>{let r={},s={},n={};e.forEach(e=>{var i;let a=null==(i=e[t.name])?void 0:i.style;a&&(r[e.name]=!0,n[e.name]=n[e.name]||{},Object.keys(a).forEach(t=>{s[t]=!0,n[e.name][t]=a[t]}))}),t.state.addStateInfo({stateValue:ns,level:-1,filter:t=>Array.isArray(t)?0!==t.length&&!0===r[t[0][i]]:!0===r[t[i]]});let a={};Object.keys(s).forEach(e=>{a[e]=r=>{var s,a;let l;if(Array.isArray(r)){if(0===r.length)return;l=null==(s=n[r[0][i]])?void 0:s[e]}return t5(l=null==(a=n[r[i]])?void 0:a[e])?l:t.getAttribute(e,r)}}),this.setMarkStyle(t,a,ns,H.User_SeriesStyle)})}afterInitMark(){this.event.emit(rB.afterInitMark,{model:this}),this.setSeriesField(this._spec.seriesField),this.getMarks().forEach(t=>{var e,i;(null==(i=null==(e=t.stateStyle)?void 0:e.normal)?void 0:i.lineWidth)&&t.setAttribute("stroke",this.getColorAttribute(),"normal",H.Base_Series)})}getMarksWithoutRoot(){return this.getMarks().filter(t=>{var e;return!(null==(e=t.name)?void 0:e.includes("seriesGroup"))})}getMarksInType(t){return this._marks.getMarksInType(t)}getMarkInName(t){return this._marks.get(t)}getMarkInId(t){return this.getMarks().find(e=>e.id===t)}initEvent(){var t,e,i;null==(e=null==(t=this._data)?void 0:t.getDataView())||e.target.addListener("change",this.viewDataUpdate.bind(this)),null==(i=this._viewDataStatistics)||i.target.addListener("change",this.viewDataStatisticsUpdate.bind(this))}_releaseEvent(){super._releaseEvent()}initTooltip(){this._tooltipHelper=new d8(this)}_compareExtensionMarksSpec(t,e,i){t.length!==e.length||e.some((e,i)=>e.type!==t[i].type||e.id!==t[i].id||e.name!==t[i].name)?i.reMake=!0:e.some((e,i)=>e.visible!==t[i].visible)&&(i.reCompile=!0)}_compareLabelSpec(t,e,i){t.length!==e.length||e.some((e,i)=>e.labelLayout!==t[i].labelLayout||e.visible!==t[i].visible)?i.reMake=!0:!i.reCompile&&e.some((e,i)=>!t1(e,t[i]))&&(i.reCompile=!0)}_compareSpec(t,e,i){let r=super._compareSpec(t,e),s=Object.keys(e||{}).sort();if(!t1(s,Object.keys(t||{}).sort()))return r.reMake=!0,r;let n=Object.assign(Object.assign(Object.assign(Object.assign({},cm),cy),i),{extensionMark:!0,label:!0,totalLabel:!0});return this._compareExtensionMarksSpec(eo(t.extensionMark),eo(e.extensionMark),r),r.reMake||this._compareLabelSpec(eo(t.label),eo(e.label),r),r.reMake||this._compareLabelSpec(eo(t.totalLabel),eo(e.totalLabel),r),r.reMake||(!r.reCompile&&this._marks.getMarks().some(i=>{var r,s;return n[i.name]=!0,(null==(r=e[i.name])?void 0:r.visible)!==(null==(s=t[i.name])?void 0:s.visible)})&&(r.reCompile=!0),!r.reCompile&&s.some(i=>cy[i]&&!t1(t[i],e[i]))&&(r.reCompile=!0),s.some(i=>!n[i]&&!t1(t[i],e[i]))&&(r.reMake=!0)),r}_updateSpecData(){!this._rawData||!this._spec.data||this._spec.data instanceof er||s3(this._rawData,this._spec.data,!0)}reInit(t){super.reInit(t);let e=this.getMarksWithoutRoot();e.forEach(t=>{this._spec[t.name]&&this.initMarkStyleWithSpec(t,this._spec[t.name])}),this.initMarkStyle(),e.forEach(t=>{t.commit(!1)}),this._updateExtensionMarkSpec(),this._updateSpecData(),this._tooltipHelper&&this._tooltipHelper.updateTooltipSpec(),cM(this)&&this.initAnimation()}onEvaluateEnd(t){this._data.updateData()}release(){var t,e;super.release(),this._viewDataMap.clear();let i=null==(e=null==(t=this._rawData)?void 0:t.transformsArr)?void 0:e.findIndex(t=>"addVChartProperty"===t.type);i>=0&&this._rawData.transformsArr.splice(i,1),this._dataSet=this._data=this._rawData=this._rawDataStatistics=this._spec=this._region=this._viewDataStatistics=this._viewStackData=null}setLayoutStartPosition(t){ee(t.x)&&(this._layoutStartPoint.x=t.x),ee(t.y)&&(this._layoutStartPoint.y=t.y)}setLayoutRect({width:t,height:e},i){ee(t)&&(this._layoutRect.width=t),ee(e)&&(this._layoutRect.height=e)}getSeriesKeys(){var t,e;return this._seriesField?null!=(e=null==(t=this.getRawDataStatisticsByField(this._seriesField))?void 0:t.values)?e:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}getSeriesStyle(t){return e=>{var i,r;return null!=(r=null==(i=this._seriesMark)?void 0:i.getAttribute(e,t))?r:void 0}}_getSeriesInfo(t,e){let i=this.getDefaultShapeType();return e.map(e=>({key:e,originalKey:e,style:this.getSeriesStyle({[t]:e}),shapeType:i}))}getSeriesInfoInField(t){var e,i;return this._getSeriesInfo(t,null!=(i=null==(e=this.getRawDataStatisticsByField(t))?void 0:e.values)?i:[])}getSeriesInfoList(){var t;return this._getSeriesInfo(null!=(t=this._seriesField)?t:nr,this.getSeriesKeys())}_getDefaultColorScale(){var t,e;let i=this.getDefaultColorDomain(),r=this._getDataScheme();return null==(e=(t=(new lt).domain(i)).range)?void 0:e.call(t,r)}_getDataScheme(){return e2(this.getColorScheme(),this.type)}getDefaultColorDomain(){var t,e;return this._seriesField?null==(e=null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._seriesField])?void 0:e.values:[]}getColorAttribute(){var t,e;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:null!=(e=this._seriesField)?e:nr}}getDimensionField(){return[]}getMeasureField(){return[]}onMarkPositionUpdate(){this.onMarkTreePositionUpdate(this.getMarksWithoutRoot())}onMarkTreePositionUpdate(t){}_createMark(t,e={},i={}){var r,s,n,a,l;let{key:o,groupKey:h,skipBeforeLayouted:u,themeSpec:d={},markSpec:c,dataView:p,parent:g,isSeriesMark:f,noSeparateStyle:m=!1}=e,y=super._createMark(t,{key:null!=o?o:this._getDataIdKey(),seriesId:this.id,attributeContext:this._markAttributeContext,componentType:e.componentType,noSeparateStyle:m,parent:!1!==g?null!=g?g:this._rootMark:null});if(t5(y)){let e=this.getSpec()||{};this._marks.addMark(y,{name:t.name}),f&&(this._seriesMark=y),et(p)?y.setData(this._data):!1!==p&&y.setDataView(p),y.setSkipBeforeLayouted(!1!==u),et(h)||y.setGroupKey(h);let o=Object.assign(Object.assign({},i),{progressiveStep:e.progressiveStep,progressiveThreshold:e.progressiveThreshold,large:e.large,largeThreshold:e.largeThreshold,morph:null!=(r=i.morph)&&r,useSequentialAnimation:e.useSequentialAnimation,support3d:null!=(s=i.support3d)?s:e.support3d||!!e.zField,morphKey:(null==(n=e.morph)?void 0:n.morphKey)||`${this.getSpecIndex()}_${this.getMarks().length}`,morphElementKey:null!=(l=null==(a=e.morph)?void 0:a.morphElementKey)?l:i.morphElementKey});y.setMarkConfig(o),this.initMarkStyleWithSpec(y,it({},d,c||e[y.name]))}return y}_getDataIdKey(){var t;return null!=(t=super._getDataIdKey())?t:ni}_getSeriesDataKey(t){let e="";if(!t)return e;let i=this.getDimensionField();e=i.map(e=>t[e]).join("_");let r=this.getSeriesField();return r&&!i.includes(r)&&(e+=`_${t[r]}`),e}addViewDataFilter(t){var e,i;null==(i=null!=(e=this._viewDataFilter)?e:this.getViewData())||i.transform(t,!1)}reFilterViewData(){var t,e;null==(e=null!=(t=this._viewDataFilter)?t:this.getViewData())||e.reRunAllTransform()}reTransformViewData(){var t,e;null==(e=null==(t=this._data)?void 0:t.getDataView())||e.reRunAllTransform()}fillData(){var t;null==(t=this.getRawData())||t.reRunAllTransform()}compile(){this.compileData()}getDefaultShapeType(){return"circle"}getFieldAlias(t){var e;return t!==nl&&t!==nh&&t!==na&&t!==no||(t=this.getStackValueField()),null!=(e=dN(this.getRawData(),t))?e:t}_getInvalidConnectType(){return"zero"===this._invalidType?"zero":"link"===this._invalidType?"connect":"none"}_getInvalidDefined(t){let e=this.getInvalidCheckFields();return!e.length||e.every(e=>ef(t[e]))}_getRelatedComponentSpecInfo(t){var e;let i=this.getSpecIndex(),r=null==(e=this._option.getSpecInfo().component[t])?void 0:e.filter(t=>t.seriesIndexes.includes(i));return null!=r?r:[]}_forEachStackGroup(t,e){var i,r;(e=null!=e?e:null==(i=this._viewStackData)?void 0:i.latestData)&&((null==(r=e.values)?void 0:r.length)?t(e):e.nodes&&Object.values(e.nodes).forEach(e=>{this._forEachStackGroup(t,e)}))}isDatumInViewData(t){if(!t)return!1;let e=this.getViewData().latestData;return!!e&&(!!e.includes(t)||e.some(e=>Object.keys(t).every(i=>t[i]===e[i])))}getSeriesFieldValue(t,e){var i;return t[null!=(i=null!=e?e:this.getSeriesField())?i:nr]}}function cC(t,e,i){let r=t.getScale(0),s="isInverse"in t&&t.isInverse();ai(r.type)?i.sort((t,i)=>(t[e]-i[e])*(s?-1:1)):i.sort((t,i)=>(r.index(t[e])-r.index(i[e]))*(s?-1:1))}function cE(t){return{dataIndex:e=>{var i,r;let s="horizontal"===t.direction?t.fieldY[0]:t.fieldX[0],n=null==e?void 0:e[s],a="horizontal"===t.direction?t.scaleY:t.scaleX;return(null!=(r=null==(i=null==a?void 0:a.domain)?void 0:i.call(a))?r:[]).indexOf(n)||0},dataCount:()=>{var e,i,r;let s="horizontal"===t.direction?t.scaleY:t.scaleX;return null!=(r=(null!=(i=null==(e=null==s?void 0:s.domain)?void 0:e.call(s))?i:[]).length)?r:0}}}cT.mark=cd,cT.transformerConstructor=cw;class cB extends cT{constructor(){super(...arguments),this.coordinate="cartesian",this._bandPosition=.5,this._scaleConfig={bandPosition:this._bandPosition},this._direction="vertical",this._sortDataByAxis=!1,this._getPositionXEncoder=()=>{var t;return null==(t=this._positionXEncoder)?void 0:t.bind(this)},this._setPositionXEncoder=t=>{this._positionXEncoder=t.bind(this)},this._getPositionYEncoder=()=>{var t;return null==(t=this._positionYEncoder)?void 0:t.bind(this)},this._setPositionYEncoder=t=>{this._positionYEncoder=t.bind(this)}}_buildScaleConfig(){this._scaleConfig={bandPosition:this._bandPosition}}get fieldX(){return this._fieldX}setFieldX(t){this._fieldX=eo(t)}get fieldY(){return this._fieldY}setFieldY(t){this._fieldY=eo(t)}get fieldZ(){return this._fieldZ}setFieldZ(t){this._fieldZ=t&&eo(t)}get fieldX2(){return this._fieldX2}setFieldX2(t){this._fieldX2=t}get fieldY2(){return this._fieldY2}setFieldY2(t){this._fieldY2=t}get direction(){return this._direction}get scaleX(){return this._scaleX}setScaleX(t){this._scaleX=t}get scaleY(){return this._scaleY}setScaleY(t){this._scaleY=t}get scaleZ(){return this._scaleZ}setScaleZ(t){this._scaleZ=t}getXAxisHelper(){return this._xAxisHelper}setXAxisHelper(t){this._xAxisHelper=t,this.onXAxisHelperUpdate()}getYAxisHelper(){return this._yAxisHelper}setYAxisHelper(t){this._yAxisHelper=t,this.onYAxisHelperUpdate()}getZAxisHelper(){return this._zAxisHelper}setZAxisHelper(t){this._zAxisHelper=t,this.onYAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}getStatisticFields(){let t=[];return[{axisHelper:this.getXAxisHelper(),fields:this._fieldX2?[...this._fieldX,this._fieldX2]:this._fieldX},{axisHelper:this.getYAxisHelper(),fields:this._fieldY2?[...this._fieldY,this._fieldY2]:this._fieldY},{axisHelper:this.getZAxisHelper(),fields:this._fieldZ}].forEach(e=>{e.axisHelper&&e.axisHelper.getScale&&e.fields&&e.fields.forEach(i=>{let r={key:i,operations:[]},s=e.axisHelper.getScale(0);ai(s.type)?(r.operations=["max","min"],"log"===s.type&&(r.filter=t=>t>0)):r.operations=["values"],t.push(r)})}),this.getStack()&&t.push({key:this.getStackValueField(),operations:["allValid"]}),t}getGroupFields(){return"vertical"===this.direction?this._fieldX:this._fieldY}getStackGroupFields(){return this.getGroupFields()}getStackValue(){var t,e;let i=null==(t="horizontal"===this.direction?this.getXAxisHelper():this.getYAxisHelper())?void 0:t.getAxisId();return null!=(e=this._spec.stackValue)?e:`${s6}_series_${this.type}_${i}`}getStackValueField(){return"horizontal"===this.direction?eo(this._spec.xField)[0]:eo(this._spec.yField)[0]}setValueFieldToStack(){"horizontal"===this.direction?(this.setFieldX(nl),this.setFieldX2(na)):(this.setFieldY(nl),this.setFieldY2(na))}setValueFieldToPercent(){"horizontal"===this.direction?(this.setFieldX(nh),this.setFieldX2(no)):(this.setFieldY(nh),this.setFieldY2(no))}setValueFieldToStackOffsetSilhouette(){"horizontal"===this.direction?(this.setFieldX(nd),this.setFieldX2(nu)):(this.setFieldY(nd),this.setFieldY2(nu))}onXAxisHelperUpdate(){this.onMarkPositionUpdate()}onYAxisHelperUpdate(){this.onMarkPositionUpdate()}onZAxisHelperUpdate(){this.onMarkPositionUpdate()}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.setFieldX(this._spec.xField),this.setFieldY(this._spec.yField),this.setFieldZ(this._spec.zField),this._specXField=eo(this._spec.xField),this._specYField=eo(this._spec.yField),t5(this._spec.direction)&&(this._direction=this._spec.direction),this.setFieldX2(null==(t=this._spec)?void 0:t.x2Field),this.setFieldY2(null==(e=this._spec)?void 0:e.y2Field),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent(),this.getStackOffsetSilhouette()&&this.setValueFieldToStackOffsetSilhouette(),t5(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)}dataToPosition(t,e){return t?e&&!this.isDatumInViewData(t)?null:{x:this.dataToPositionX(t),y:this.dataToPositionY(t)}:null}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToX=this.valueToPositionX.bind(this),this._markAttributeContext.valueToY=this.valueToPositionY.bind(this),this._markAttributeContext.xBandwidth=(t=0)=>{var e,i,r;return null!=(r=null==(i=(e=this.getXAxisHelper()).getBandwidth)?void 0:i.call(e,t))?r:0},this._markAttributeContext.yBandwidth=(t=0)=>{var e,i,r;return null!=(r=null==(i=(e=this.getYAxisHelper()).getBandwidth)?void 0:i.call(e,t))?r:0},this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)}valueToPosition(t,e){return{x:this.valueToPositionX(t),y:this.valueToPositionY(e)}}_axisPosition(t,e,i){return this._scaleConfig.datum=i,t.isContinuous?t.valueToPosition(e,this._scaleConfig):t.dataToPosition(eo(e),this._scaleConfig)}valueToPositionX(t,e){return this._axisPosition(this._xAxisHelper,t,e)}valueToPositionY(t,e){return this._axisPosition(this._yAxisHelper,t,e)}_dataToPosition(t,e,i,r,s,n){let a=s();if(a)return a(t);if(!e)return n(t=>Number.NaN),Number.NaN;let l=(e.getFields?e.getFields():i).slice(0,r);return l&&0!==l.length?(e.isContinuous?n(t=>(this._scaleConfig.datum=t,e.valueToPosition(this.getDatumPositionValue(t,l[0]),this._scaleConfig))):n(t=>(this._scaleConfig.datum=t,e.dataToPosition(eo(this.getDatumPositionValues(t,l)),this._scaleConfig))),s()(t)):(n(t=>null),null)}dataToPositionX(t){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,void 0,this._getPositionXEncoder,this._setPositionXEncoder)}dataToPositionY(t){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,void 0,this._getPositionYEncoder,this._setPositionYEncoder)}dataToPositionZ(t){if(!this._zAxisHelper)return Number.NaN;let{dataToPosition:e}=this._zAxisHelper;return e(this.getDatumPositionValues(t,this._fieldZ),{bandPosition:this._bandPosition})}dataToPositionX1(t){return this._xAxisHelper?this._fieldX2&&this._fieldX2 in t?this.valueToPositionX(this.getDatumPositionValues(t,this._fieldX2)):this.valueToPositionX(0):Number.NaN}dataToPositionY1(t){return this._yAxisHelper?this._fieldY2&&this._fieldY2 in t?this.valueToPositionY(this.getDatumPositionValues(t,this._fieldY2)):this.valueToPositionY(0):Number.NaN}positionToData(t){return t?{x:this.positionToDataX(t.x),y:this.positionToDataY(t.y)}:null}positionToDataX(t){return this._scaleX?this._scaleX.invert(t):null}positionToDataY(t){return this._scaleY?this._scaleY.invert(t):null}getRegionRectLeft(){if(!this._xAxisHelper)return Number.NaN;let{getScale:t}=this._xAxisHelper;return t(0).range()[0]}getRegionRectRight(){if(!this._xAxisHelper)return Number.NaN;let{getScale:t}=this._xAxisHelper;return t(0).range()[1]}afterInitMark(){super.afterInitMark(),this.setFieldX(this._fieldX),this.setFieldY(this._fieldY),this._buildScaleConfig()}getDimensionField(){return"horizontal"===this._direction?this._specYField:this._specXField}getDimensionContinuousField(){return"horizontal"===this._direction?[this.fieldY[0],this.fieldY2]:[this.fieldX[0],this.fieldX2]}getMeasureField(){return"horizontal"===this._direction?this._specXField:this._specYField}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(rB.scaleDomainUpdate,{filter:t=>{var e;return t.model.id===(null==(e="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper)?void 0:e.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var t,e,i;(null==(e=null==(t=this.getViewData())?void 0:t.latestData)?void 0:e.length)&&(cC("horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,"horizontal"===this._direction?this._fieldY[0]:this._fieldX[0],this.getViewData().latestData),null==(i=this._data)||i.updateData(!0))}getInvalidCheckFields(){let t=[];return this._xAxisHelper&&this._xAxisHelper.isContinuous&&this._xAxisHelper.getAxisType()!==rA.geoCoordinate&&(this._xAxisHelper.getFields?this._xAxisHelper.getFields():this._specXField).forEach(e=>{t.push(e)}),this._yAxisHelper&&this._yAxisHelper.isContinuous&&this._yAxisHelper.getAxisType()!==rA.geoCoordinate&&(this._yAxisHelper.getFields?this._yAxisHelper.getFields():this._specYField).forEach(e=>{t.push(e)}),t}reInit(t){this._positionXEncoder&&(this._positionXEncoder=null),this._positionYEncoder&&(this._positionYEncoder=null),super.reInit(t)}}let cP="monotone",cO="linear",cI="bevel";(A=G||(G={})).dimensionHover="dimensionHover",A.dimensionClick="dimensionClick";let cR={point:{name:"point",type:"symbol"},line:{name:"line",type:"line"}};class cL{addSamplingCompile(){if(this._spec.sampling){let{width:t,height:e}=this._region.getLayoutRect(),i=this._fieldY,r=this._fieldX;this._data&&this._data.setTransform([{type:"dataSampling",size:"horizontal"===this._direction?e:t,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?r[0]:i[0],groupBy:this._seriesField,mode:this._spec.sampling}])}}addOverlapCompile(){var t;if(this._spec.markOverlap){let e=[];e.push({type:"symbolOverlap",direction:"horizontal"===this._direction&&"cartesian"===this.coordinate?2:1,delta:this._spec.pointDis,deltaMul:this._spec.pointDisMul,groupBy:this._seriesField}),null==(t=this._symbolMark)||t.setTransform(e)}}reCompileSampling(){this._spec.sampling&&this.compile()}initLineMark(t){return this._lineMark=this._createMark(cR.line,{groupKey:this._seriesField,isSeriesMark:null==t||t},{morphElementKey:this.getDimensionField()[0]}),this._lineMark}initLineMarkStyle(t,e){var i,r;let s=this._lineMark;if(s){if(this.setMarkStyle(s,{stroke:this.getColorAttribute()},"normal",H.Series),"zero"!==this._invalidType&&this.setMarkStyle(s,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",H.Series),this.event.on(rB.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(s,"defined")}),"polar"===this.coordinate)this.setMarkStyle(s,{lineJoin:cI,curveType:cO,closePath:!0},"normal",H.Series);else{let n=null!=e?e:null==(r=null==(i=this.getSpec().line)?void 0:i.style)?void 0:r.curveType;this.setMarkStyle(s,{curveType:n===cP?"horizontal"===t?"monotoneY":"monotoneX":n},"normal",H.Built_In)}this.setMarkStyle(s,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",H.Series)}return s}_getEventElement(t,e=!1){let i=[];return t.dimensionInfo.some(t=>(t.data.some(t=>t.series===this&&(i=t.datum,!0)),!i.length)),i}_dimensionTrigger(t){let e=this._getEventElement(t);switch(t.action){case"enter":this._symbolActiveMark.getDataView().parse(e),this._symbolActiveMark.getData().updateData(!1);break;case"leave":this._symbolActiveMark.getDataView().parse([]),this._symbolActiveMark.getData().updateData(!1)}}initSymbolMark(t){if(!1!==(this._spec.point||{}).visible&&(this._symbolMark=this._createMark(cR.point,{groupKey:this._seriesField,isSeriesMark:!!t},{morph:ck(this._spec,cR.point.name),morphElementKey:this.getDimensionField()[0]})),!0===this._spec.activePoint){let t=new er(this._option.dataSet,{name:`${s6}_series_${this.id}_active_point`});t.parse([]),this._symbolActiveMark=this._createMark({name:`active_point_${this.id}`,type:"symbol"},{groupKey:this._seriesField,isSeriesMark:!1,dataView:t,parent:this._region.getInteractionMark()},{morph:!1}),this._symbolActiveMark.setVisible(!1)}return this._symbolMark}initSymbolMarkStyle(){let t=this._symbolMark;if(!t)return this._initSymbolActiveMarkAlone(),t;if(this._initSymbolMark(t),this._symbolActiveMark&&this._symbolMark.stateStyle.dimension_hover){for(let e in this._symbolActiveMark.setVisible(!0),this.event.on(G.dimensionHover,this._dimensionTrigger.bind(this)),this._symbolMark.stateStyle)for(let i in this._symbolActiveMark.stateStyle[e]={},this._symbolMark.stateStyle[e])"visible"!==i&&(this._symbolActiveMark.stateStyle[e][i]={style:null,level:H.Series,referer:t});this._symbolActiveMark.state.changeStateInfo({stateValue:V.STATE_DIMENSION_HOVER,filter:()=>!0})}return t}_initSymbolMark(t){t&&(this.setMarkStyle(t,{fill:this.getColorAttribute()},"normal",H.Series),this.setMarkStyle(t,{x:t=>"zero"===this._invalidType||this._getInvalidDefined(t)?this.dataToPositionX(t):Number.NaN,y:t=>"zero"===this._invalidType||this._getInvalidDefined(t)?this.dataToPositionY(t):Number.NaN,z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",H.Series))}_initSymbolActiveMarkAlone(){var t,e;let i=this._symbolActiveMark;i&&(this._initSymbolMark(i),i&&(null==(e=null==(t=this._spec[cR.point.name])?void 0:t.state)?void 0:e.dimension_hover)&&(i.setVisible(!0),this.event.on(G.dimensionHover,this._dimensionTrigger.bind(this)),this.initMarkStyleWithSpec(i,it({},this._spec[cR.point.name],{visible:!0})),this._symbolActiveMark.state.changeStateInfo({stateValue:V.STATE_DIMENSION_HOVER,filter:()=>!0})))}initLabelMarkStyle(t){var e;t&&("symbol"!==(null==(e=t.getTarget())?void 0:e.type)&&t.setRule("line-data"),this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null}),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},"normal",H.Series),this.event.on(rB.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(t,"visible")}))}initLineLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>{var e;return null!=(e=t[this.getSeriesField()])?e:this.getSeriesKeys()[0]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})}encodeDefined(t,e){var i,r,s,n;if(!t)return;let a=this._isFieldAllValid();if("zero"===this._invalidType||a){if(!0===(null==(r=null==(i=t.stateStyle.normal)?void 0:i[e])?void 0:r.style))return;this.setMarkStyle(t,{[e]:!0},"normal",H.Series)}else{if(!0!==(null==(n=null==(s=t.stateStyle.normal)?void 0:s[e])?void 0:n.style))return;this.setMarkStyle(t,{[e]:this._getInvalidDefined.bind(this)},"normal",H.Series)}t.compileEncode()}_isFieldAllValid(){let t=this.getViewDataStatistics(),e=this.getStackValueField();return!!(t&&t.latestData&&e)&&t.latestData[e]&&t.latestData[e].allValid}}function cD(t,e,i=!0){if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames){let r=Object.getOwnPropertyNames(e);for(let s=0;s<r.length;s++){let n=r[s];"constructor"!==n&&(i?null!=e[n]:null==t[n])&&(t[n]=e[n])}}else{var r=t,s=e,n=i;let a=function(t){if(!t)return[];if(Object.keys)return Object.keys(t);let e=[];for(let i in t)t.hasOwnProperty(i)&&e.push(i);return e}(s);for(let t=0;t<a.length;t++){let e=a[t];(n?null!=s[e]:null==r[e])&&(r[e]=s[e])}}}let cF=Object.assign(Object.assign({},cd),cR),cz=(t,e)=>{var i,r;if(t===e)return!0;let s=null!=(i=t&&t.length)?i:0;return s===(null!=(r=e&&e.length)?r:0)&&0!==s&&t.every((t,i)=>!t&&!e[i]||t&&e[i]&&t.color===e[i].color&&t.offset===e[i].offset)},cj=(t,e)=>{if(t===e)return!0;if(typeof t!=typeof e||t3(t))return!1;if(tY(t))return t.length===e.length&&t.every((t,i)=>cj(t,e[i]));if(t.gradient!==e.gradient)return!1;let i=Object.keys(t),r=Object.keys(e);return i.length===r.length&&i.every(i=>"stops"===i?cz(t[i],e[i]):t[i]===e[i])},cH=(t,e)=>t.length===e.length&&t.join("-")===e.join("-"),cN=(t,e,i)=>!(!et(t)||!et(e))||!et(t)&&!et(e)&&("lineDash"===i?cH(t,e):"stroke"===i||"fill"===i?cj(t,e):t===e),cV=["stroke","strokeOpacity","lineDash","lineDashOffset","lineCap","lineJoin","lineWidth","miterLimit"];class cW extends oa{constructor(){super(...arguments),this._segmentStyleKeys=[],this._isValidPointChannel=t=>["x","y","defined"].includes(t)}_getSegmentAttributes(){return cV}initStyleWithSpec(t){this._segmentStyleKeys=[],super.initStyleWithSpec(t)}setStyle(t,e="normal",i=0){if(et(t))return;void 0===this.stateStyle[e]&&(this.stateStyle[e]={});let r=this._getIgnoreAttributes(),s=this._getSegmentAttributes(),n=this.isUserLevel(i);Object.keys(t).forEach(a=>{let l=t[a];if(et(l)||r.includes(a))return;n&&s.includes(a)&&(ae[null==l?void 0:l.type]||(null==l?void 0:l.scale)||tK(l))&&(this._segmentStyleKeys.includes(a)||this._segmentStyleKeys.push(a));let o=this._filterAttribute(a,l,e,i,n);this.setAttribute(a,o,e,i)})}_getLineSegments(t,e){if(!this._segmentStyleKeys||!this._segmentStyleKeys.length)return null;let i=[],r=null;return t.forEach((t,e)=>{r&&this._segmentStyleKeys.every(e=>cN(r[e],t[e],e))||(i.length&&(i[i.length-1].endIndex=e),r=t,i.push({attrs:r,startIndex:e}))}),i.length>=2?i.map(t=>Object.assign(Object.assign({},t.attrs),{points:e.slice(t.startIndex,et(t.endIndex)?e.length:t.endIndex)})):null}_getPrevPoints(t){let{points:e,segments:i}=t.attribute;return null!=e?e:i?i.reduce((t,e)=>(e.points&&e.points.forEach(e=>{t.push(e)}),t),[]):null}_runPointsEncoder(t,e,i={}){var r,s,n;let a=e.context.data,l=[],o=[],h={},u=null==(r=this.renderContext)?void 0:r.progressive,d=u&&0===u.currentIndex;if(a.forEach((e,i)=>{var r;o[i]={},l[i]={},Object.keys(t).forEach(r=>{this._isValidPointChannel(r)?o[i][r]=t[r](e):this._segmentStyleKeys.includes(r)&&!u?l[i][r]=t[r](e):0!==i||u&&!d||(h[r]=t[r](e))}),o[i].context=null!=(r=this._keyGetter(e))?r:i}),u){let t=null!=(n=null==(s=e.attribute)?void 0:s.segments)?n:[];return t.push({points:o}),d?Object.assign(Object.assign({},h),{segments:t}):{segments:t}}if(this._segmentStyleKeys&&this._segmentStyleKeys.length){let t=this._getLineSegments(l,o);if(t)return Object.assign(Object.assign(Object.assign({},h),l[0]),{segments:t,points:null})}return Object.assign(Object.assign(Object.assign({},h),l[0]),{points:o,segments:null})}_runEncoderOfGraphic(t,e,i={}){let r=e.context.data;return t&&Object.keys(t).some(this._isValidPointChannel)&&r&&r.length?this._runPointsEncoder(t,e,i):super._runEncoderOfGraphic(t,e,i)}_getDataByKey(t){return this._dataByGroup}_runProgressiveJoin(){let t=this.renderContext.progressive.currentIndex,e=[];this._dataByGroup.keys.forEach((i,r)=>{let s=this.renderContext.progressive.groupedData.get(i),n=this.renderContext.progressive.step,a=s.slice(t*n,(t+1)*n);if(0===t){let t={context:Object.assign(Object.assign({},this._getCommonContext()),{diffState:N.enter,data:a,uniqueKey:i,key:i,groupKey:i})};e.push(t)}else this._graphics[r].context.data=a});let i=0===t?e:this._graphics;return{graphicsByGroup:{[ni]:i},graphics:i,needUpdate:!1}}_setCommonAttributesToTheme(t){}_addProgressiveGraphic(t,e){e.incremental=1,t.appendChild(e)}}var cU=i(73208),cG=i(89255),cZ=i(95950),c$=i(20672),cY=i(47704),cX=i(21777),cK=i(14925);let cq=["#ffffff","#000000"];function cQ(t,e,i,r,s,n){if("string"!=typeof t||"string"!=typeof e)return t;let a=new cK.Il(t).toHex(),l=new cK.Il(e).toHex();return cJ(a,l,i,r,n)?a:function(t,e,i,r,s,n){let a=[];for(let l of(s&&(s instanceof Array?a.push(...s):a.push(s)),a.push(...cq),a))if(t!==l&&cJ(l,e,i,r,n))return l}(a,l,i,r,s,n)}function cJ(t,e,i,r,s){if("lightness"===s){let i=cK.Il.getColorBrightness(new cK.Il(e));return .5>cK.Il.getColorBrightness(new cK.Il(t))?i>=.5:i<.5}return r?c0(t,e)>r:"largeText"===i?c0(t,e)>3:c0(t,e)>4.5}function c0(t,e){let i=c1(t),r=c1(e);return((i>r?i:r)+.05)/((i>r?r:i)+.05)}function c1(t){let e=function(t){let e="",i="",r="",s=+("#"===t[0]);for(let n=s;n<t.length;n++)"#"!==t[n]&&(n<s+2?e+=t[n]:n<s+4?i+=t[n]:n<s+6&&(r+=t[n]));return[parseInt(e,16),parseInt(i,16),parseInt(r,16)]}(t),i=e[0]/255,r=e[1]/255,s=e[2]/255;return .2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))}function c2(t,e,i,r){let s;switch(t){case"base":s=e;break;case"invertBase":s=i;break;case"similarBase":s=r}return s}var c3=i(42465),c5=i(11165);let c4=new Uint32Array(33),c7=new Uint32Array(33);c7[0]=0,c4[0]=~c7[0];for(let t=1;t<=32;++t)c7[t]=c7[t-1]<<1|1,c4[t]=~c7[t];function c6(t,e,i={top:0,left:0,right:0,bottom:0}){let{top:r=0,left:s=0,right:n=0,bottom:a=0}=i,l=Math.max(1,Math.sqrt(t*e/1e6)),o=~~((t+s+n+l)/l),h=~~((e+r+a+l)/l),u=t=>~~(t/l);return u.bitmap=()=>(function(t,e){let i=new Uint32Array(~~((t*e+32)/32));return{array:i,get:(e,r)=>{let s=r*t+e;return i[s>>>5]&1<<(31&s)},set:(e,r)=>{let s=r*t+e;i[s>>>5]|=1<<(31&s)},clear:(e,r)=>{let s=r*t+e;i[s>>>5]&=~(1<<(31&s))},getRange:({x1:r,y1:s,x2:n,y2:a})=>{if(n<0||a<0||r>t||s>e)return!0;let l,o,h,u,d=a;for(;d>=s;--d)if(l=d*t+r,o=d*t+n,(h=l>>>5)==(u=o>>>5)){if(i[h]&c4[31&l]&c7[1+(31&o)])return!0}else{if(i[h]&c4[31&l]||i[u]&c7[1+(31&o)])return!0;for(let t=h+1;t<u;++t)if(i[t])return!0}return!1},setRange:({x1:r,y1:s,x2:n,y2:a})=>{var l,o,h,u;let d,c,p,g,f;if(!(n<0)&&!(a<0)&&!(r>t)&&!(s>e))for(;s<=a;++s)if(d=s*t+r,c=s*t+n,(p=d>>>5)==(g=c>>>5))l=c4[31&d]&c7[1+(31&c)],i[p]|=l;else for(o=c4[31&d],i[p]|=o,h=c7[1+(31&c)],i[g]|=h,f=p+1;f<g;++f)u=f,i[u]|=0xffffffff},clearRange:({x1:e,y1:r,x2:s,y2:n})=>{var a,l,o,h;let u,d,c,p,g;for(;r<=n;++r)if(u=r*t+e,d=r*t+s,(c=u>>>5)==(p=d>>>5))a=c7[31&u]|c4[1+(31&d)],i[c]&=a;else for(l=c7[31&u],i[c]&=l,o=c4[1+(31&d)],i[p]&=o,g=c+1;g<p;++g)h=g,i[h]&=0},outOfBounds:({x1:i,y1:r,x2:s,y2:n})=>i<0||r<0||n>=e||s>=t,toImageData:r=>{let s=r.createImageData(t,e),n=s.data;for(let r=0;r<e;++r)for(let e=0;e<t;++e){let s=r*t+e,a=4*s,l=i[s>>>5]&1<<(31&s);n[a+0]=255*l,n[a+1]=255*l,n[a+2]=255*l,n[a+3]=31}return s}}})(o,h),u.x=t=>~~((t+s)/l),u.y=t=>~~((t+r)/l),u.ratio=l,u.padding=i,u.width=t,u.height=e,u}function c9(t,e){let{x1:i,x2:r,y1:s,y2:n}=e,{top:a=0,left:l=0,right:o=0,bottom:h=0}=t.padding,u=(0,uC.Z)(i,-l,t.width+o),d=(0,uC.Z)(r,-l,t.width+o),c=(0,uC.Z)(s,-a,t.height+h),p=(0,uC.Z)(n,-a,t.height+h);return{x1:t.x(u),x2:t.x(d),y1:t.y(c),y2:t.y(p)}}function c8(t,e,i=!1){return i?c9(t,e):{x1:t.x(e.x1),x2:t.x(e.x2),y1:t.y(e.y1),y2:t.y(e.y2)}}function pt(t,e,i,r=!0,s=0){let n=i;s>0&&(n={x1:i.x1-s,x2:i.x2+s,y1:i.y1-s,y2:i.y2+s}),n=c8(t,n);let a=e.outOfBounds(n);return(!r||!a)&&(a&&(n=c9(t,n)),!e.getRange(n))}function pe(t,e,i,r=[],s=!0,n=0,a=!1){let l=r.filter(t=>(0,cX.Z)(t));for(let r=0;r<l.length;r++){let o;if((o=a?i:i.clone()).setAttributes(l[r]),pt(t,e,o.AABBBounds,s,n))return e.setRange(c8(t,o.AABBBounds,!0)),l[r]}return!1}let pi=["top","bottom","right","left","top-right","bottom-right","top-left","bottom-left"],pr=["top","inside-top","inside"];function ps(t,e,i,r={}){let{x1:s,x2:n,y1:a,y2:l}=t.AABBBounds,{top:o=0,left:h=0,right:u=0,bottom:d=0}=r,c=Math.min(s,n),p=Math.max(s,n),g=Math.min(a,l),f=Math.max(a,l),m=e+u,y=i+d,_=0,v=0;return c<0-h?_=-c:p>m&&(_=m-p),g<0-o?v=-g:f>y&&(v=y-f),{dx:_,dy:v}}let pn={mode:"same-time",duration:300,easing:"linear"};function pa(t){return 3===t||4===t}let pl=(t,e,i="top",r=0)=>{if(!t)return;let{x1:s,y1:n,x2:a,y2:l}=t,o=Math.abs(a-s),h=Math.abs(l-n),u=(e.x1+e.x2)/2,d=(e.y1+e.y2)/2,c=0,p=0,g=0,f=0;e&&(g=Math.abs(e.x1-e.x2)/2,f=Math.abs(e.y1-e.y2)/2);let m={"top-right":-235,"top-left":235,"bottom-right":45,"bottom-left":-45};switch(i){case"top":p=-1;break;case"bottom":p=1;break;case"left":c=-1;break;case"right":c=1;break;case"bottom-left":case"bottom-right":case"top-left":case"top-right":c=Math.sin(m[i]*(Math.PI/180)),p=Math.cos(m[i]*(Math.PI/180));break;case"center":c=0,p=0}return{x:u+c*(r+g)+o/2*Math.sign(c),y:d+p*(r+f)+h/2*Math.sign(p)}},po=t=>{if(!t||!t.attribute)return[];let{points:e,segments:i}=t.attribute;if(i&&i.length){let t=[];return i.forEach(e=>{e.points.forEach(e=>{t.push(e)})}),t}return e};function ph(t,e,i,r,s,n){return Math.abs(e/t)<n/s?{x:i+(t>0?s:-s),y:r+e*s/Math.abs(t)}:{x:i+t*n/Math.abs(e),y:r+(e>0?n:-n)}}var pu=i(23112),pd=i(80523),pc=i(86389),pp=i(92164),pg=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class pf extends lZ.O{onBind(){let t=(0,pc.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,{prevText:r,curText:s,prevLabelLine:n,curLabelLine:a,increaseEffect:l=!0}=this.params,o={};for(let t in s.attribute)r.attribute[t]!==s.attribute[t]&&(o[t]=s.attribute[t]);let{text:h}=o,u=pg(o,["text"]);t.animate(r,{type:"to",to:u,duration:e,easing:i}),!1!==l&&t.animate(r,{type:"increaseCount",to:{text:s.attribute.text},duration:e,easing:i}),n&&t.animate(n,{type:"to",to:a.attribute,duration:e,easing:i}),this.completeBind(t)}tryPreventConflict(){}}class pm extends lZ.O{onBind(){let t=(0,pc.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,{relatedGraphic:r,relatedGraphics:s,config:n}=this.params,{mode:a,type:l="fadeIn"}=n,o=this.target,h=0;"after"===a?r.animates&&r.animates.forEach(t=>{h=Math.max(h,t.getStartTime()+t.getTotalDuration())}):"after-all"===a?s&&s.forEach(t=>{t.animates&&t.animates.forEach(t=>{h=Math.max(h,t.getStartTime()+t.getTotalDuration())})}):r.animates&&r.animates.forEach(t=>{h=Math.max(h,t.getStartTime())}),t.animate(o,Object.assign(Object.assign({},n),{duration:e,easing:i,startTime:h,type:l})),this.completeBind(t)}tryPreventConflict(){}}var py=i(25258);let p_=(t,e)=>Math.ceil(t)>Math.floor(e),pv=([t,e],[i,r])=>r>t&&e>i;var pb=i(50487),px=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};(0,oo.M)(),(0,pu.g)(),(0,pd.v)(),(0,cG.N)(),uP.a.registerBuiltInAnimate("increaseCount",pp.B),uP.a.registerBuiltInAnimate("labelUpdate",pf),uP.a.registerBuiltInAnimate("labelEnter",pm);class pS extends pb.g{setBitmap(t){this._bitmap=t}setBitmapTool(t){this._bmpTool=t}constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cZ.Z)({},pS.defaultAttributes,px(t,["data"])))),this.name="label",this._onHover=t=>{let e=t.target;e===this._lastHover||(0,cY.Z)(e.states)||(e.addState(c5.HW.hover,!0),(0,c3.Ck)(this,t=>{t===e||(0,cY.Z)(t.states)||t.addState(c5.HW.hoverReverse,!0)}),this._lastHover=e)},this._onUnHover=t=>{this._lastHover&&((0,c3.Ck)(this,t=>{(0,cY.Z)(t.states)||(t.removeState(c5.HW.hoverReverse),t.removeState(c5.HW.hover))}),this._lastHover=null)},this._onClick=t=>{let e=t.target;if(this._lastSelect===e&&e.hasState("selected"))return this._lastSelect=null,void(0,c3.Ck)(this,t=>{(0,cY.Z)(t.states)||(t.removeState(c5.HW.selectedReverse),t.removeState(c5.HW.selected))});(0,cY.Z)(e.states)||(e.addState(c5.HW.selected,!0),(0,c3.Ck)(this,t=>{t===e||(0,cY.Z)(t.states)||t.addState(c5.HW.selectedReverse,!0)}),this._lastSelect=e)},this._handleRelatedGraphicSetState=t=>{var e,i,r,s,n;if((null==(e=t.detail)?void 0:e.type)===lW.Gk.STATE||(null==(i=t.detail)?void 0:i.type)===lW.Gk.ANIMATE_UPDATE&&(null==(r=t.detail.animationState)?void 0:r.isFirstFrameOfStep)){let e=null!=(n=null==(s=t.target)?void 0:s.currentStates)?n:[],i=this._isCollectionBase?[...this._graphicToText.values()]:[this._graphicToText.get(t.target)];this.updateStatesOfLabels(i,e)}}}labeling(t,e,i,r){}_getLabelLinePoints(t,e){return function(t,e){if(!t||!e||(0,lT.SX)(t,e,!0))return;let i=Math.min(t.x1,t.x2),r=Math.min(t.y1,t.y2),s=Math.min(e.x1,e.x2),n=Math.min(e.y1,e.y2),a=Math.abs(t.x2-i)/2,l=Math.abs(t.y2-r)/2,o=Math.abs(e.x2-s)/2,h=Math.abs(e.y2-n)/2,u=i+a,d=r+l,c=s+o,p=n+h,g=c-u,f=p-d;return[ph(g,f,u,d,a,l),ph(-g,-f,c,p,o,h)]}(t.AABBBounds,null==e?void 0:e.AABBBounds)}_createLabelLine(t,e){let i=this._getLabelLinePoints(t,e);if(i){let r=c$.i.line({points:i}),{line:s={}}=t.attribute;if(s.customShape){let i=s.customShape;r.pathProxy=r=>i({text:t,baseMark:e},r,new lf.r)}return e&&e.getAttributes(!0).fill&&r.setAttribute("stroke",e.getAttributes(!0).fill),this.attribute.line&&!(0,cY.Z)(this.attribute.line.style)&&r.setAttributes(this.attribute.line.style),this._setStatesOfLabelLine(r),r}}render(){if(this._prepare(),(0,lU.Z)(this._idToGraphic)||this._isCollectionBase&&(0,lU.Z)(this._idToPoint))return;let t=[];!1!==this._enableAnimation&&this._baseMarks.forEach(e=>{t.push(e.attribute),e.initAttributes(e.getAttributes(!0))});let{overlap:e,smartInvert:i,dataFilter:r,customLayoutFunc:s,customOverlapFunc:n}=this.attribute,a=this.attribute.data;if((0,uc.Z)(r)&&(a=r(a)),a&&a.length){let t=new Set;a=a.filter(e=>!t.has(e.id)&&t.add(e.id))}let l=this._initText(a);l=(0,uc.Z)(s)?s(a,l,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null,this):this._layout(l),(0,uc.Z)(n)?l=n(l,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null,this):!1!==e&&(l=this._overlapping(l)),(0,uc.Z)(this.attribute.onAfterOverlapping)&&this.attribute.onAfterOverlapping(l,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null,this),l&&l.length&&l.forEach(t=>{this._bindEvent(t),this._setStatesOfText(t)}),!1!==i&&this._smartInvert(l),this._renderLabels(l),!1!==this._enableAnimation&&this._baseMarks.forEach((e,i)=>{e.initAttributes(t[i])})}_bindEvent(t){if(this.attribute.disableTriggerEvent||!t)return;let{hover:e,select:i}=this.attribute;e&&(t.addEventListener("pointermove",this._onHover),t.addEventListener("pointerout",this._onUnHover)),i&&t.addEventListener("pointerdown",this._onClick)}_setStatesOfText(t){if(!t)return;let e=this.attribute.state;e&&!(0,cY.Z)(e)&&(t.states=e)}_setStatesOfLabelLine(t){if(!t)return;let e=this.attribute.labelLineState;e&&!(0,cY.Z)(e)&&(t.states=e)}_createLabelText(t){var e,i;let r=Object.assign(Object.assign({},null==(i=null==(e=this.stage)?void 0:e.getTheme())?void 0:i.text),t);return(0,od.vS)(r,"textType")}_prepare(){var t,e;let i=[];if(((0,uc.Z)(this.attribute.getBaseMarks)?this.attribute.getBaseMarks():(0,c3.tP)(this.getRootNode(),this.attribute.baseMarkGroupName)).forEach(t=>{"willRelease"!==t.releaseStatus&&i.push(t)}),null==(t=this._idToGraphic)||t.clear(),null==(e=this._idToPoint)||e.clear(),this._baseMarks=i,this._isCollectionBase="line-data"===this.attribute.type,!i||0===i.length)return;let{data:r}=this.attribute;if(r&&0!==r.length){if(this._idToGraphic||(this._idToGraphic=new Map),this._isCollectionBase){this._idToPoint||(this._idToPoint=new Map);let t=0;for(let e=0;e<i.length;e++){let s=i[e],n=po(s);if(n&&n.length)for(let e=0;e<n.length;e++){let i=r[t];i&&n[e]&&((0,cX.Z)(i.id)||(i.id=`vrender-component-${this.name}-${t}`),this._idToPoint.set(i.id,n[e]),this._idToGraphic.set(i.id,s)),t++}}}else for(let t=0;t<i.length;t++){let e=r[t],s=i[t];e&&s&&((0,cX.Z)(e.id)||(e.id=`vrender-component-${this.name}-${t}`),this._idToGraphic.set(e.id,s))}this._prepareAnimate(pn)}}getRelatedGraphic(t){return this._idToGraphic.get(t.id)}_initText(t=[]){let{textStyle:e={}}=this.attribute,i=[];for(let r=0;r<t.length;r++){let s=t[r],n=this.getRelatedGraphic(s);if(!n)continue;let a=n.getAttributes(!0),l=Object.assign(Object.assign({fill:this._isCollectionBase?(0,lG.Z)(a.stroke)?a.stroke.find(t=>!!t&&!0!==t):a.stroke:a.fill},e),s),o=this._createLabelText(l);i.push(o)}return i}_layout(t){let{position:e,offset:i}=this.attribute;for(let r=0;r<t.length;r++){let s=t[r];if(!s)return;let n=s.attribute,a=this.getRelatedGraphic(n);if(!a)continue;s.attachedThemeGraphic=this;let l=this.getGraphicBounds(s);s.attachedThemeGraphic=null;let o=(0,uc.Z)(e)?e(n):e,h=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(n.id),o):this.getGraphicBounds(a,{x:n.x,y:n.y},o),u=this.labeling(l,h,o,i);u&&s.setAttributes(u)}return t}_overlapping(t){var e,i,r;if(0===t.length)return[];let s=(0,up.Z)(this.attribute.overlap)?this.attribute.overlap:{},n=this.getBaseMarkGroup(),a=null!=(e=s.size)?e:{width:null!=(i=null==n?void 0:n.AABBBounds.width())?i:0,height:null!=(r=null==n?void 0:n.AABBBounds.height())?r:0};if(0===a.width||0===a.height)return t;let{strategy:l,priority:o}=s,h=this._bmpTool||c6(a.width,a.height),u=this._bitmap||h.bitmap();return o&&(t=t.sort((t,e)=>o(e.attribute.data)-o(t.attribute.data))),"shiftY"===(null==l?void 0:l.type)?this._overlapGlobal(t,s,h,u):this._overlapByStrategy(t,s,h,u)}_overlapGlobal(t,e,i,r){let s=t.filter(t=>t.attribute.visible&&0!==t.attribute.opacity&&this.isMarkInsideRect(this.getRelatedGraphic(t.attribute),i)),{clampForce:n=!0,hideOnHit:a=!0,overlapPadding:l,strategy:o}=e;if(n)for(let e=0;e<s.length;e++){let r=t[e],{dx:s=0,dy:n=0}=ps(r,i.width,i.height,i.padding);0===s&&0===n||(r.setAttributes({x:r.attribute.x+s,y:r.attribute.y+n}),r._isClamped=!0)}s=function(t,e){let{maxY:i=Number.MAX_VALUE,labelling:r,globalShiftY:s={enable:!0,maxIterations:10,maxError:.1,padding:1}}=e,n=t.length;if(n<=1)return t;let a=new Map,l=new Map,o=t=>l.get(t).y1Initial,h=t=>l.get(t).height,u=t=>l.get(t).y1,d=t=>l.get(t).x,c=t=>l.get(t).x1,p=t=>l.get(t).x2,g=t=>l.get(t).attempts,f=(t,e)=>{l.get(t).y1=e},m=(t,e)=>{l.get(t).attempts=e};for(let e of(t.sort((t,e)=>t.attribute.x-e.attribute.x),t)){let{y1:t,y2:i,x1:r,x2:s}=e.AABBBounds,{x:n,y:o}=e.attribute;l.set(e,{y1Initial:t,y1:t,y2:i,y:o,height:i-t,x1:r,x2:s,x:n,attempts:0});let h=!1;for(let[t,i]of a){let{start:l,end:o}=t;if(r>=l&&s<=o)i.push(e),h=!0;else if((0,py.Yt)(n,d(i[0]),void 0,5)){let n={start:Math.min(l,r),end:Math.max(o,s)};i.push(e),a.set(n,i),a.delete(t),h=!0}else if(function(t,e){let[i,r]=t,[s,n]=e;return Math.max(0,Math.min(r,n)-Math.max(i,s))}([l,o],[r,s])/(o-l)>.5){let n={start:Math.min(l,r),end:Math.max(o,s)};i.push(e),a.set(n,i),a.delete(t),h=!0}if(h)break}h||a.set({start:r,end:s},[e])}for(let t of a.values())t.sort((t,e)=>o(t)-o(e)),function(t){for(let e=t.length-1;e>=0;e--){let s=t[e],n=t[e-1],a=t[e+1];if(n&&p_(u(n)+h(n),u(s))||0===u(s)&&s._isClamped){let{y:t}=r(s);a&&p_(t+h(s)/2,u(a))||t+h(s)/2<=i&&f(s,u(s)+t-l.get(s).y)}}}(t);if(!1!==s.enable){let{maxIterations:e=10,maxError:r=.1,padding:a=1,maxAttempts:l=1e3,deltaYTolerance:d=Number.MAX_VALUE}=s;for(let s=0;s<e;s++){t.sort((t,e)=>o(t)-o(e));let e=0;for(let r=0;r<n-1;r++){let s=t[r];if(g(s)>=l)continue;let n,y=r+1;for(;(n=t[y])&&!pv([c(s),p(s)],[c(n),p(n)]);)y+=1;if(n){let t=u(s),r=h(s),l=u(n),c=l-(t+r);if(c<a){let r=(a-c)/2;if(e=Math.max(e,r),t+r+h(n)>i){let e=t-(a-c);Math.abs(o(s)-e)<=d&&(f(s,e),m(s,g(s)+1))}else if(t-r<0){let t=l+(a-c);Math.abs(o(n)-t)<=d&&(f(n,t),m(n,g(n)+1))}else{let e=t-r,i=o(s)-e,a=l+r,h=o(n)-a;Math.abs(i)<=d&&Math.abs(h)<=d&&(f(s,e),f(n,a),m(s,g(s)+1),m(n,g(n)+1))}}}}if(e<r)break}}for(let e of t){let t=e.attribute.y+u(e)-o(e);e.setAttribute("y",t)}let y=[];t.sort((t,e)=>t.attribute.x-e.attribute.x);let _=0,v=t.length-1;for(;_<=v;)_===v?y.push(t[_]):(y.push(t[_]),y.push(t[v])),_++,v--;return y}(s,Object.assign(Object.assign({maxY:i.height},o),{labelling:t=>{let e=this.getRelatedGraphic(t.attribute),i=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t.attribute.id)):this.getGraphicBounds(e,t);return this.labeling(t.AABBBounds,i,"bottom",this.attribute.offset)}}));for(let t=0;t<s.length;t++){let e=s[t],o=e.AABBBounds,h=c8(i,o,!0);if(pt(i,r,o,n,l))r.setRange(h);else{if(n&&this._processClampForce(e,i,r,l))continue;a?e.setAttributes({visible:!1}):r.setRange(h)}}return s}_processClampForce(t,e,i,r=0){let{dy:s=0,dx:n=0}=ps(t,e.width,e.height,e.padding);if(0===n&&0===s){if(pt(e,i,t.AABBBounds,!1,r))return i.setRange(c8(e,t.AABBBounds,!0)),!0}else if(pt(e,i,{x1:t.AABBBounds.x1+n,x2:t.AABBBounds.x2+n,y1:t.AABBBounds.y1+s,y2:t.AABBBounds.y2+s}))return t.setAttributes({x:t.attribute.x+n,y:t.attribute.y+s}),i.setRange(c8(e,t.AABBBounds,!0)),!0;return!1}_overlapByStrategy(t,e,i,r){var s;let{avoidBaseMark:n,strategy:a=[],hideOnHit:l=!0,clampForce:o=!0,avoidMarks:h=[],overlapPadding:u}=e,d=[],c=a.some(t=>"bound"===t.type);n&&(null==(s=this._baseMarks)||s.forEach(t=>{t.AABBBounds&&r.setRange(c8(i,t.AABBBounds,!0))})),h.length>0&&h.forEach(t=>{(0,ug.Z)(t)?(0,c3.Dh)(this.getRootNode(),t).forEach(t=>{t.AABBBounds&&r.setRange(c8(i,t.AABBBounds,!0))}):t.AABBBounds&&r.setRange(c8(i,t.AABBBounds,!0))});for(let e=0;e<t.length;e++){if(!1===t[e].attribute.visible)continue;let s=t[e],n=this.getRelatedGraphic(s.attribute);if(s.update(),!this.isMarkInsideRect(n,i))continue;if(pt(i,r,s.AABBBounds,o,u)&&(!c||c&&n&&n.AABBBounds&&this._canPlaceInside(s.AABBBounds,n.AABBBounds))){r.setRange(c8(i,s.AABBBounds,!0)),d.push(s);continue}let h=!1;for(let l=0;l<a.length;l++)if(!1!==(h=function(t,e,i,r,s,n,a){var l,o;let h=null==(l=r.overlap)?void 0:l.clampForce,u=null==(o=r.overlap)?void 0:o.overlapPadding;if("bound"===i.type||"position"===i.type){if((0,uc.Z)(a)){let l=(((0,uc.Z)(i.position)?i.position(s.attribute):i.position)||("rect"===r.type?pr:pi)).map(t=>a(s.AABBBounds,n,t,r.offset));return pe(t,e,s,l,h,u,!1===i.restorePosition)}return!1}if("moveY"===i.type){let r=(i.offset?(0,uc.Z)(i.offset)?i.offset(s.attribute):i.offset:[]).map(t=>({x:s.attribute.x,y:s.attribute.y+t}));return pe(t,e,s,r,h,u)}if("moveX"===i.type){let r=(i.offset?(0,uc.Z)(i.offset)?i.offset(s.attribute):i.offset:[]).map(t=>({x:s.attribute.x+t,y:s.attribute.y}));return pe(t,e,s,r,h,u)}return!1}(i,r,a[l],this.attribute,s,this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t[e].attribute.id)):this.getGraphicBounds(n,t[e].attribute),this.labeling))){s.setAttributes({x:h.x,y:h.y}),d.push(s);break}if(!h&&o&&this._processClampForce(s,i,r,u)){d.push(s);continue}h||l||d.push(s)}return d}isMarkInsideRect(t,e){let{left:i,right:r,top:s,bottom:n}=e.padding,a={x1:-i,x2:e.width+r,y1:-s,y2:e.height+n},l=t.AABBBounds;if(0!==l.width()&&0!==l.height())return(0,lT.SX)(t.AABBBounds,a,!0);let{attribute:o}=t;if("rect"===t.type){let{x:t,x1:e,y:i,y1:r}=o;return(0,lT.qr)({x:null!=t?t:e,y:null!=i?i:r},a,!0)}return"x"in o&&"y"in o&&(0,lT.qr)({x:o.x,y:o.y},a,!0)}getBaseMarkGroup(){let{baseMarkGroupName:t}=this.attribute;if(t)return this.getRootNode().find(e=>e.name===t,!0)}getGraphicBounds(t,e={},i){var r;if(t){if(!1!==t.attribute.visible){if(null==(r=t.context)?void 0:r.animationState){let e=t.clone();return Object.assign(e.attribute,t.getAttributes(!0)),e.AABBBounds}return t.AABBBounds}let{x:e,y:i}=t.attribute;return{x1:e,x2:e,y1:i,y2:i}}if(e&&i&&"inside-middle"===i){let{x:t,y:i,x1:r=t,y1:s=i}=e;return{x1:(t+r)/2,x2:(t+r)/2,y1:(i+s)/2,y2:(i+s)/2}}let{x:s,y:n}=e;return{x1:s,x2:s,y1:n,y2:n}}_renderLabels(t){var e;let{syncState:i}=this.attribute,r=new Map,s=this._graphicToText||new Map,n=[],a=[],{visible:l}=null!=(e=this.attribute.line)?e:{};t&&t.forEach((t,e)=>{var o;let h,u=this.getRelatedGraphic(t.attribute),d=this._isCollectionBase?t.attribute.id:u,c=(null==s?void 0:s.get(d))?"update":"enter";l&&(h=this._createLabelLine(t,u));let p=h?{text:t,labelLine:h}:{text:t};if(i&&this.updateStatesOfLabels([p],null!=(o=u.currentStates)?o:[]),"enter"===c)n.push(t),r.set(d,p),this._addLabel(p,n,a,e);else if("update"===c){let t=s.get(d);s.delete(d),r.set(d,t),this._updateLabel(t,p)}}),this._removeLabel(s),this._graphicToText=r}runEnterAnimation(t,e){if(!1===this._enableAnimation||!this._animationConfig.enter)return;let i=this.getRelatedGraphic(t.attribute),{enter:r}=this._animationConfig;[t,e].filter(Boolean).forEach(e=>e.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r),{type:"labelEnter",selfOnly:!0,customParameters:{relatedGraphic:i,relatedGraphics:this._idToGraphic,config:Object.assign(Object.assign({},r),{type:e===t?r.type:"fadeIn"})}})}]))}_runUpdateAnimation(t,e){let{text:i,labelLine:r}=t,{text:s,labelLine:n}=e;i.applyAnimationState(["update"],[{name:"update",animation:{type:"labelUpdate",customParameters:Object.assign(Object.assign({},this._animationConfig.update),{prevText:i,curText:s,prevLabelLine:r,curLabelLine:n})}}])}_syncStateWithRelatedGraphic(t){this.attribute.syncState&&t&&t.on("afterStateUpdate",this._handleRelatedGraphicSetState)}_addLabel(t,e,i,r){let{text:s,labelLine:n}=t,a=this.getRelatedGraphic(s.attribute);this._syncStateWithRelatedGraphic(a),s&&this.add(s),n&&this.add(n),this.runEnterAnimation(s,n)}_updateLabel(t,e){let{text:i,labelLine:r}=t,{text:s,labelLine:n}=e;!1===this._enableAnimation||!1===this._animationConfig.update?(t.text.setAttributes(s.attribute),r&&n&&t.labelLine.setAttributes(n.attribute)):this._runUpdateAnimation(t,e)}_removeLabel(t){let e=t=>{this.removeChild(t.text),t.labelLine&&this.removeChild(t.labelLine)};!1!==this._enableAnimation&&!1!==this._animationConfig.exit?t.forEach(t=>{var i;t.text.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},this._animationConfig.exit),{type:"fadeOut"})}],()=>{e(t)}),null==(i=t.labelLine)||i.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},this._animationConfig.exit),{type:"fadeOut"})}],()=>{})}):t.forEach(t=>{e(t)})}updateStatesOfLabels(t,e){t.forEach(t=>{t&&(t.text&&t.text.useStates(e),t.labelLine&&t.labelLine.useStates(e))})}_smartInvert(t){var e,i,r,s,n,a,l;let o=(0,up.Z)(this.attribute.smartInvert)?this.attribute.smartInvert:{},{textType:h,contrastRatiosThreshold:u,alternativeColors:d,mode:c,interactInvertType:p}=o,g=null!=(e=o.fillStrategy)?e:"invertBase",f=null!=(i=o.strokeStrategy)?i:"base",m=null!=(r=o.brightColor)?r:"#ffffff",y=null!=(s=o.darkColor)?s:"#000000",_=null!=(n=o.outsideEnable)&&n;if("null"!==g||"null"!==f)for(let e=0;e<t.length;e++){let i=t[e];if(!i)continue;let r=this.getRelatedGraphic(i.attribute),s=r.getAttributes(!0).fill,n=i.attribute.fill;if((0,up.Z)(s)&&s.gradient){let t=null==(l=null==(a=s.stops)?void 0:a[0])?void 0:l.color;t&&(s=t,n=t)}let o=cQ(n,s,h,u,d,c),v=cJ(o,m)?m:y,b=this._canPlaceInside(i.AABBBounds,r.AABBBounds),x=!b&&i.AABBBounds&&r.AABBBounds&&r.AABBBounds.intersects(i.AABBBounds);if(b||_||x&&"inside"===p){let t=c2(g,s,o,v);if(t&&i.setAttributes({fill:t}),0===i.attribute.lineWidth||0===i.attribute.strokeOpacity)continue;let e=c2(f,s,o,v);e&&i.setAttributes({stroke:e})}else if(x&&"none"!==p){if(0===i.attribute.lineWidth||0===i.attribute.strokeOpacity)continue;if(i.attribute.stroke){i.setAttributes({fill:cQ(i.attribute.fill,i.attribute.stroke,h,u,d,c)});continue}let t=c2(g,s,o,v);t&&i.setAttributes({fill:t});let e=c2(f,s,o,v);e&&i.setAttributes({stroke:e})}}}_canPlaceInside(t,e){return!(!t||!e)&&e.encloses(t)}setLocation(t){this.translateTo(t.x,t.y)}disableAnimation(){this._enableAnimation=!1}enableAnimation(){this._enableAnimation=!0}}pS.defaultAttributes={textStyle:{fontSize:12,textAlign:"center",textBaseline:"middle",boundsPadding:[-2,-1,-2,-1]},offset:0,pickable:!1};let pk={},pA=(t,e)=>{pk[t]=e},pM=t=>pk[t];var pw=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class pT extends pS{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cZ.Z)({},pT.defaultAttributes,pw(t,["data"])))),this.name="line-label"}getGraphicBounds(t,e={},i="end"){if(!t||"line"!==t.type&&"area"!==t.type)return super.getGraphicBounds(t,e);let r=t.attribute.points,s=t.attribute.segments;!r&&s&&s.length&&(r=s.reduce((t,e)=>{var i;return t.concat(null!=(i=e.points)?i:[])},[])),r&&0!==r.length||(r=[e]);let n="start"===i?0:r.length-1;return r[n]?{x1:r[n].x,x2:r[n].x,y1:r[n].y,y2:r[n].y}:void 0}labeling(t,e,i="end",r=0){return function(t,e,i="end",r=0){if(!t||!e)return{x:1/0,y:1/0};let{x1:s,x2:n}=t,a=Math.abs(n-s),l=e.x1,o=l;return"end"===i?o=l+a/2+r:"start"===i&&(o=l-a/2-r),{x:o,y:e.y1}}(t,e,i,r)}}pT.defaultAttributes={textStyle:{fill:"#000"},position:"end",offset:6};let pC=()=>{pA("line",pT),pA("area",pT)};var pE=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class pB extends pS{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cZ.Z)({},pB.defaultAttributes,pE(t,["data"])))),this.name="symbol-label"}labeling(t,e,i="top",r=0){return pl(t,e,i,r)}}pB.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};let pP=()=>{pA("symbol",pB),pA("line-data",pB)};class pO extends cW{constructor(){super(...arguments),this.type=pO.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:1})}_getIgnoreAttributes(){var t,e;return(null==(t=this.model)?void 0:t.type)===rw.radar&&"polar"===(null==(e=this.model)?void 0:e.coordinate)?[]:["fill","fillOpacity"]}}pO.type="line";let pI=()=>{ig.registerMark(pO.type,pO),(0,ol.W)(),(0,cG.N)(),pC(),pP(),u6(),ig.registerGraphicComponent("line",cU.W)};var pR=i(14861),pL=i(91015);class pD extends oa{constructor(){super(...arguments),this.type=pD.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{size:1,symbolType:"circle",fill:void 0,lineWidth:0})}_transformGraphicAttributes(t,e,i){var r,s,n;let a=super._transformGraphicAttributes(t,e,i),l=null!=(s=null!=(r=a.shape)?r:a.symbolType)?s:null==(n=t.attribute)?void 0:n.symbolType;return et(l)?a.symbolType="circle":a.symbolType=l,a}}pD.type="symbol";let pF=()=>{ig.registerMark(pD.type,pD),(0,ol.W)(),(0,pL.k)(),pP(),ig.registerGraphicComponent("symbol",pR.t)};class pz extends cw{_transformLabelSpec(t){var e,i,r;!1!==(null==(e=t.point)?void 0:e.visible)&&!1!==(null==(r=null==(i=t.point)?void 0:i.style)?void 0:r.visible)?this._addMarkLabelSpec(t,"point"):this._addMarkLabelSpec(t,"line"),this._addMarkLabelSpec(t,"line","lineLabel","initLineLabelMarkStyle",void 0,!0)}}function pj(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1]}function pH(t,e,i,r){let s=t[0],n=e[0],a=i[0],l=r[0];return n<s&&([s,n]=[n,s]),l<a&&([l,a]=[a,l]),!(n<a||l<s)&&(s=t[1],n=e[1],a=i[1],l=r[1],n<s&&([s,n]=[n,s]),l<a&&([l,a]=[a,l]),!(n<a||l<s))}function pN(t,e,i){if(!e)return!0;if(!i)return t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2;let r=e.x1,s=e.x2,n=e.y1,a=e.y2;return r>s&&([r,s]=[s,r]),n>a&&([n,a]=[a,n]),t.x>=r&&t.x<=s&&t.y>=n&&t.y<=a}(M=Z||(Z={}))[M.NONE=0]="NONE",M[M.BBOX1=1]="BBOX1",M[M.BBOX2=2]="BBOX2";class pV{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new pV(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return tY(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){let r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){let s=this.scalePoints(t,e,i,r);return this.clear().add(s[0],s[1]).add(s[2],s[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return function(t,e,i){let{x1:r,y1:s,x2:n,y2:a}=e;i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f)):(t.clear(),t.add(i.a*r+i.c*s+i.e,i.b*r+i.d*s+i.f),t.add(i.a*n+i.c*s+i.e,i.b*n+i.d*s+i.f),t.add(i.a*n+i.c*a+i.e,i.b*n+i.d*a+i.f),t.add(i.a*r+i.c*a+i.e,i.b*r+i.d*a+i.f))}(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){let{x1:r,y1:s,x2:n,y2:a}=this,l=Math.cos(t),o=Math.sin(t),h=e-e*l+i*o,u=i-e*o-i*l;return[l*r-o*s+h,o*r+l*s+u,l*r-o*a+h,o*r+l*a+u,l*n-o*s+h,o*n+l*s+u,l*n-o*a+h,o*n+l*a+u]}scalePoints(t,e,i,r){let{x1:s,y1:n,x2:a,y2:l}=this;return[t*s+(1-t)*i,e*n+(1-e)*r,t*a+(1-t)*i,e*l+(1-e)*r]}}function pW(t,e,i){let r=!1;if(e&&tK(e)){for(let s of t)for(let t of s.getSeries(i))if(r=!!e.call(null,t))return r}return r}function pU(t,e){let i=[];for(let r of t)for(let t of r.getSeries(e))i.push(t);return i}let pG=(t,e)=>{for(let i=0;i<t.length;i++){let r=t[i].getSeries();for(let t=0;t<r.length;t++){let i=r[t];if(e&&i&&i.coordinate===e||!e&&i)return i}}return null},pZ=t=>void 0===t;function p$(t){return"bottom"===t||"top"===t}function pY(t){return"left"===t||"right"===t}function pX(t){return"z"===t}function pK(t,e){return e_(t.orient)||e&&e.includes(t.orient)?t.orient:"left"}function pq(t){return"top"===t||"bottom"===t?"horizontal":"vertical"}function pQ(t,e){var i,r;let s=null!=(i=t.type)?i:(r=t.orient,e?p$(r)?"linear":"band":p$(r)?"band":"linear");return{axisType:s,componentName:`${rA.cartesianAxis}-${s}`}}let pJ=(t,e,i)=>{var r;let s=null!=(r="band"===e?dQ("axisBand",i):["linear","log","symlog"].includes(e)?dQ("axisLinear",i):{})?r:{},n=p$(t)?dQ("axisX",i):pY(t)?dQ("axisY",i):dQ("axisZ",i);return it({},dQ("axis",i),s,n)};function p0(t){return t.length>=2&&ee(t[0])&&ee(eh(t))&&eh(t)>=t[0]}function p1(t,e){var i;let r=eh(e)-e[0],s=eh(e)*e[0]<0,n=e[0]<=0?0-e[0]:0,a=eh(e)>0?eh(e)-0:0;0===r?e[0]<0?(n=1,a=0):e[0]>0&&(n=0,a=1):(n/=r,a/=r);let l=t.getDomainSpec(),o={total:r,negative:n,positive:a,includeZero:s,domain:e,extendable_min:!ee(l.min),extendable_max:!ee(l.max)};if(null==(i=t._break)?void 0:i.scope){let i,r,s=e.findIndex(t=>t>=0);0===s?(i=t._break.scope[s],r=[e[0],e[1]],o.positive=1,o.negative=0):0>=eh(e)?(o.positive=0,o.negative=1,r=[e[e.length-2],e[e.length-1]]):(i=t._break.scope[s-1],r=[e[s-1],e[s]],o.negative=i[0]+(0-r[0])/(r[1]-r[0])*(i[1]-i[0]),o.positive=1-o.negative),o.break=!0,o.extendable_max=!1,o.extendable_min=!1,o.domain=r}return o}function p2(t,e){let{positive:i,negative:r,extendable_min:s,extendable_max:n,domain:a}=t,{positive:l,negative:o,extendable_min:h,extendable_max:u,domain:d}=e;if(l>0){if(!h)return!1;let t=r/i;n&&(t=r/Math.max(i,l),a[1]=-a[0]/t),d[0]=-d[1]*t}else if(o>0){if(!u)return!1;let t=i/r;s&&(t=i/Math.max(r,r),a[0]=-a[1]/t),d[1]=-d[0]*t}return!0}function p3(t,e){let{extendable_min:i,extendable_max:r,domain:s}=t,{positive:n,negative:a,domain:l}=e;return(0!==n||0!==a)&&!(n>0&&!r)&&!(a>0&&!i)&&(s[0]=l[0],s[1]=l[1],!0)}function p5(t,e){let{positive:i,negative:r,extendable_max:s,domain:n}=t,{positive:a,negative:l,extendable_min:o,domain:h}=e;if(s&&o){let t=Math.max(r,l)/Math.max(i,a);n[1]=-n[0]/t,h[0]=-h[1]*t}else if(o)h[0]=-h[1]*(r/i);else{if(!s)return!1;n[1]=-n[0]/(l/a)}return!0}function p4(t,e){let{extendable_min:i,domain:r}=t,{extendable_max:s,domain:n}=e;return!(!i||!s)&&(r[0]=-r[1],n[1]=-n[0],!0)}let p7=(t,e)=>{var i,r,s,n;let a=t.getScale(),l=e.getScale();if(!a||!l)return;let o=null!=(r=null==(i=t.getDomainAfterSpec)?void 0:i.call(t))?r:[0,1],h=null!=(n=null==(s=e.getDomainAfterSpec)?void 0:s.call(e))?n:[0,1];if(!(o&&h&&p0(o)&&p0(h)))return;let u=p1(t,o),d=p1(e,h);if(!0===u.break&&!0===d.break)return;let{positive:c,negative:p,extendable_min:g,extendable_max:f,includeZero:m}=u,{positive:y,negative:_,extendable_min:v,extendable_max:b,includeZero:x}=d;if(0===c&&0===p){if(!p3(u,d))return}else if(0===y&&0===_){if(!p3(d,u))return}else if(m||x)if(m&&!x){if(!p2(u,d))return}else if(x&&!m){if(!p2(d,u))return}else{if(p===_)return;if(p>_){if(!p5(u,d))return}else if(!p5(d,u))return}else{if(0===p&&0===y){if(!p4(u,d))return}else if(0===_&&0===c&&!p4(d,u))return;if(0===p&&0===_)if(0===o[0]&&h[0]>0){if(!v)return;h[0]=0}else{if(!(0===h[0]&&o[0]>0)||!g)return;o[0]=0}if(0===c&&0===y)if(0===o[1]&&h[1]>0){if(!b)return;h[1]=0}else{if(!(0===h[1]&&o[1]>0)||!f)return;o[1]=0}}a.domain(o),l.domain(h)};var p6=i(37922);let p9=(t,e)=>{var i,r,s,n,a;if(!t)return t;let l=null==(i=null==e?void 0:e.targetAxis)?void 0:i.call(e);if(!l)return t;let o=null==(r=null==e?void 0:e.currentAxis)?void 0:r.call(e);if(!o)return t;let h=null==(s=o.getTickData())?void 0:s.getDataView();if(!h||!h.transformsArr.find(t=>t.type.includes("ticks")))return t;let u=o.getScale();if(!u)return t;let d=null==(a=null==(n=l.getTickData())?void 0:n.getDataView())?void 0:a.latestData;if(!(null==d?void 0:d.length))return t;let c=l.getScale();if(!c)return t;let p=c.domain(),g=eh(p)-p[0];if(0===g)return t;let f=u.domain(),m=eh(f)-f[0];if(0===g)return t;let y=d.map(t=>(function(t,e,i,r,s){let n=dE(t,e),a=Math.max(dT(i),dT(n));return Math.round(n*10**a)/Math.round(i*10**a)*s+r})(t.value,p[0],g,f[0],m));return(0,p6.KV)(y)};class p8{constructor(t){this.id=eg(),this.name=`${t}_${this.id}`}onAdd(t){this.service=t}release(){this.service=null}}class gt extends p8{constructor(){super(gt.type),this.type="AxisSyncPlugin"}_checkEnableSync(t){if(!ai(t.getScale().type))return!1;let e=t.getSpec().sync;return!!(null==e?void 0:e.axisId)&&e}_getTargetAxis(t,e){let i=t.getOption().getChart().getComponentByUserId(e.axisId);return(null==i?void 0:i.type.startsWith("cartesianAxis"))?i:null}onInit(t,e){let i=this._checkEnableSync(e);if(!i||!i.zeroAlign)return;let r=this._getTargetAxis(e,i);r&&e.event.on(rB.scaleDomainUpdate,{filter:({model:t})=>t.id===e.id||t.id===r.id},()=>{p7(r,e)})}onDidCompile(t,e){var i;let r=this._checkEnableSync(e);if(!r)return;let s=this._getTargetAxis(e,r);if(s&&r.tickAlign){sY(e.getOption().dataSet,"tickAlign",p9);let t=null==(i=s.getTickData())?void 0:i.getDataView();t&&t.target.addListener("change",()=>{var t,i;null==(i=null==(t=e.getTickData())?void 0:t.getDataView())||i.reRunAllTransform({skipEqual:!0})}),e.addTransformToTickData({type:"tickAlign",options:{targetAxis:()=>s,currentAxis:()=>e},level:Number.MAX_SAFE_INTEGER},!1)}}}function ge(t={}){let e=Object.assign({},t);if(tK(t.style)?e.style=(e,i,r,s)=>gs(t.style(e,i,r,s)):nR(t.style)||(e.style=gs(t.style)),!nR(t.state)){let i={};Object.keys(t.state).forEach(e=>{tK(t.state[e])?i[e]=(i,r,s,n)=>gs(t.state[e](i,r,s,n)):nR(t.state[e])||(i[e]=gs(t.state[e]))}),e.state=i}return e}function gi(t){if(nR(t))return null;let e={};return Object.keys(t).forEach(i=>{tK(t[i])?e[i]=(e,r,s,n)=>gs(t[i](e,r,s,n)):nR(t[i])||(e[i]=gs(t[i]))}),e}function gr(t,e){if(nR(t))return null;let i={};return Object.keys(t).forEach(r=>{tK(t[r])?i[r]=t[r](e):i[r]=t[r]}),gs(i)}function gs(t){return(null==t?void 0:t.angle)&&(t.angle=lu(t.angle)),t}gt.pluginType="component",gt.type="AxisSyncPlugin";let gn={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}};function ga(t){let e=0;return iF(t,"tick.visible")&&(e+=iF(t,"tick.tickSize")),iF(t,"label.visible")&&(e+=iF(t,"label.space")),e}function gl(t,e){var i,r,s,n,a,l;return{min:null!=(s=null!=(i=t.min)?i:null==(r=t.range)?void 0:r.min)?s:null==e?void 0:e.min,max:null!=(l=null!=(n=t.max)?n:null==(a=t.range)?void 0:a.max)?l:null==e?void 0:e.max}}function go(t){let e=null==t?void 0:t.orient;return"top"===e||"bottom"===e||"left"===e||"right"===e||"z"===e}let gh=t=>"band"===t||"ordinal"===t||"point"===t;function gu(t,e){return{id:t,label:t,value:e,rawValue:t}}function gd(t,e,i){return i||!t||t.getAxisId()===e.getAxisId()}var gc=i(99014);class gp extends ua{constructor(t){super(),this.component=t}releaseAll(){super.releaseAll(),this.component=null}}let gg=`${s6}_ARC_TRANSFORM_VALUE`,gf=`${s6}_ARC_RATIO`,gm=`${s6}_ARC_START_ANGLE`,gy=`${s6}_ARC_END_ANGLE`,g_=`${s6}_ARC_K`,gv=`${s6}_ARC_MIDDLE_ANGLE`,gb=`${s6}_ARC_QUADRANT`,gx=`${s6}_ARC_RADIAN`,gS=-Math.PI/2,gk=3*Math.PI/2,gA=(t,e)=>{var i,r,s,n,a,l;let o=null!=(i=t.type)?i:"angle"===t.orient?"band":"linear",h=`${rA.polarAxis}-${o}`,u=null!=(r=t.startAngle)?r:e.startAngle,d=null!=(s=t.endAngle)?s:e.endAngle;return{axisType:o,componentName:h,startAngle:null!=u?u:-90,endAngle:null!=d?d:t5(u)?u+360:270,center:t5(e.center)?e.center:t5(null==e?void 0:e.centerX)||t5(null==e?void 0:e.centerY)?{x:null==e?void 0:e.centerX,y:null==e?void 0:e.centerY}:void 0,outerRadius:null!=(l=null!=(a=null!=(n=t.outerRadius)?n:t.radius)?a:e.outerRadius)?l:e.radius,layoutRadius:e.layoutRadius}},gM=(t,e,i,r)=>{let s=t();if(tH(s))return s;if(tK(s))return s(e(),i());let n=e();if("auto"===s&&n.width>0&&n.height>0){let{startAngle:t=0,endAngle:e=2*Math.PI}=r();return function(t,e,i,r){let{x:s,y:n}=e,a=function(t,e){let i=Math.abs(e-t);if(i>=2*Math.PI||2*Math.PI-i<1e-6)return[0,Math.PI/2,Math.PI,1.5*Math.PI];let r=lg(Math.min(t,e)),s=r+i,n=[r,s],a=Math.floor(r/Math.PI)*Math.PI/2;for(;a<s;)a>r&&n.push(a),a+=Math.PI/2;return n}(i,r),{width:l,height:o}=t,h=[];return a.forEach(t=>{let e=Math.sin(t),i=Math.cos(t);1===e?h.push(o-n):-1===e?h.push(n):1===i?h.push(l-s):-1===i?h.push(s):(e>0?h.push(Math.abs((o-n)/e)):h.push(Math.abs(n/e)),i>0?h.push(Math.abs((l-s)/i)):h.push(Math.abs(s/i)))}),Math.min.apply(null,h)}(n,i(),t,e)}return Math.min(n.width/2,n.height/2)},gw=(t,e,i)=>{var r;let s=null!=(r="band"===e?dQ("axisBand",i):"linear"===e?dQ("axisLinear",i):{})?r:{},n=dQ("angle"===t?"axisAngle":"axisRadius",i);return it({},dQ("axis",i),s,n)},gT=(t,e)=>{var i,r;let s,n=eo(null!=(i=e.axes)?i:[]),{bandField:a,linearField:l,xField:o,yField:h,trigger:u,triggerOff:d}=null!=(r=dQ(rA.crosshair,t))?r:{},c=n.find(t=>p$(t.orient));s=t5(c)?it({},gh(c.type)?a:l,o):o;let p=n.find(t=>pY(t.orient));return{xField:s,yField:t5(p)?it({},ar(p.type)?a:l,h):h,trigger:u,triggerOff:d}},gC=(t,e)=>{var i,r;let s,n=eo(null!=(i=e.axes)?i:[]),{bandField:a,linearField:l,categoryField:o,valueField:h,trigger:u,triggerOff:d}=null!=(r=dQ(rA.crosshair,t))?r:{},c=n.find(t=>"angle"===t.orient);s=t5(c)?it({},gh(c.type)?a:l,o):o;let p=n.find(t=>"radius"===t.orient);return{categoryField:s,valueField:t5(p)?it({},ar(p.type)?a:l,h):h,trigger:u,triggerOff:d}},gE=(t,e)=>{var i;let r=null!=(i=t.orient)?i:e.orient,s=e[pq(r)],n=it({},e,s);return delete n.horizontal,delete n.vertical,n};class gB extends nZ{getTheme(t,e){var i=this.type,r=this._option.getTheme;switch(i){case rA.cartesianBandAxis:return pJ(pK(t,["z"]),"band",r);case rA.cartesianLinearAxis:return pJ(pK(t,["z"]),"linear",r);case rA.cartesianLogAxis:return pJ(pK(t,["z"]),"log",r);case rA.cartesianSymlogAxis:return pJ(pK(t,["z"]),"symlog",r);case rA.cartesianAxis:case rA.cartesianTimeAxis:return pJ(pK(t),void 0,r);case rA.polarBandAxis:return gw(t.orient,"band",r);case rA.polarLinearAxis:return gw(t.orient,"linear",r);case rA.polarAxis:return gw(t.orient,void 0,r);case rA.cartesianCrosshair:return gT(r,e);case rA.polarCrosshair:return gC(r,e);case rA.colorLegend:case rA.sizeLegend:case rA.discreteLegend:case rA.dataZoom:case rA.scrollBar:return gE(t,dQ(i,r));default:return dQ(i,r)}}_mergeThemeToSpec(t,e){let{spec:i,theme:r}=super._mergeThemeToSpec(t,e);return this._adjustPadding(i),{spec:i,theme:r}}_adjustPadding(t){let{padding:e,noOuterPadding:i=!0,orient:r}=t;i&&e&&r&&(t.padding=Object.assign(Object.assign({},eA(e)),{[r]:0}))}}var gP=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class gO extends nJ{constructor(){super(...arguments),this.name="component",this.modelType="component",this.transformerConstructor=gB,this._delegateEvent=(t,e,i,r=null,s=null)=>{var n,a;e instanceof gc.A||this.event.emit(i,{model:this,node:t,event:e,item:r,datum:s,source:rP.chart,chart:null==(a=null==(n=this._option)?void 0:n.globalInstance)?void 0:a.getChart()},"model")}}static createComponent(t,e){let{spec:i}=t,r=gP(t,["spec"]);return new this(i,Object.assign(Object.assign({},e),r))}getRegions(){return this._regions}created(){super.created(),this.initLayout(),this.pluginService=new gp(this)}initLayout(){var t;super.initLayout(),this._regions=null!=(t=this._regions)?t:this._option.getRegionsInIndex(),this._layout&&(this._layout.layoutBindRegionID=this._regions.map(t=>null==t?void 0:t.id))}_getNeedClearVRenderComponents(){return[]}getVRenderComponents(){return this._getNeedClearVRenderComponents()}callPlugin(t){this.pluginService&&this.pluginService.getAll().forEach(e=>t(e))}getContainer(){var t;return this._container||(this._container=null==(t=this._option)?void 0:t.globalInstance.getStage().find(t=>"root"===t.name,!0)),this._container}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reMake=["seriesId","seriesIndex","regionId","regionIndex"].some(i=>!t1(null==e?void 0:e[i],t[i]))),(null==e?void 0:e.visible)!==t.visible&&(i.reCompile=!0),i}release(){var t;super.release(),this.clear(),null==(t=this.pluginService)||t.releaseAll(),this.pluginService=null}clear(){var t;let e=this._getNeedClearVRenderComponents();e&&e.length&&e.forEach(t=>{var e;t&&(null==(e=this.getContainer())||e.removeChild(t),t=null)}),this._container=null,null==(t=this.pluginService)||t.clearAll()}compile(){this.compileMarks(),this.reAppendComponents()}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t,context:{model:this}})})}reAppendComponents(){let t=this._getNeedClearVRenderComponents();t&&t.length&&t.forEach(t=>{var e;t&&!t.stage&&(null==(e=this.getContainer())||e.appendChild(t))})}getBoundsInRect(t,e){return{x1:0,x2:0,y1:0,y2:0}}getDatum(t){}}function gI(t,e){if(!t||!tQ(t))return t;let i={};return Object.keys(t).forEach(r=>{let s=t[r],n=!1;e.forEach(t=>{(t3(t)&&t===r||t instanceof RegExp&&r.match(t))&&(n=!0)}),n||(i[r]=s)}),i}gO.transformerConstructor=gB,(w=$||($={})).lineAxis="lineAxis",w.circleAxis="circleAxis",(T=Y||(Y={})).lineAxisGrid="lineAxisGrid",T.circleAxisGrid="circleAxisGrid";class gR extends oa{constructor(t,e){super(t,e),this.type="component",this._componentType=e.componentType,this._mode=e.mode}_getDefaultStyle(){return{}}getComponent(){return this._component}clearComponent(){this._component&&(this._component.parent&&this._component.parent.removeChild(this._component),this._component=null)}_getAttrsFromConfig(t={}){let e=super._getAttrsFromConfig(t);return et(this._markConfig.interactive)||(e.pickable=this._markConfig.interactive),t}setAttributeTransform(t){this._attributesTransform=t}renderInner(){var t;let e=null!=(t=this._simpleStyle)?t:this.getAttributesOfState({}),i=this._getAttrsFromConfig(e);this._attributesTransform&&(i=this._attributesTransform(i)),this._animationConfig&&(i=Object.assign(Object.assign({},i),{animation:!0,animationAppear:this._animationConfig.appear?Array.isArray(this._animationConfig.appear)?this._animationConfig.appear[0]:this._animationConfig.appear:void 0,animationEnter:this._animationConfig.enter?Array.isArray(this._animationConfig.enter)?this._animationConfig.enter[0]:this._animationConfig.enter:void 0,animationUpdate:this._animationConfig.update?Array.isArray(this._animationConfig.update)?this._animationConfig.update[0]:this._animationConfig.update:void 0,animationExit:this._animationConfig.exit?Array.isArray(this._animationConfig.exit)?this._animationConfig.exit[0]:this._animationConfig.exit:void 0})),this._component?this._component.setAttributes(i):(this._component=ig.createGraphicComponent(this._componentType,i,{mode:this._mode,skipDefault:this._markConfig.skipTheme}),this._component&&this._product.appendChild(this._component)),this._component&&(this._component.context=this._getCommonContext()),this._markConfig.support3d&&this._product&&this._product.setMode("3d"),this.model.event.emit(rE.AFTER_ELEMENT_ENCODE,{mark:this,model:this.model}),this.needClear=!0}release(){super.release(),this.removeProduct()}}gR.type="component";let gL=()=>{ig.registerMark(gR.type,gR)};var gD=i(19660);let gF=t=>t;var gz=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class gj extends gO{getOrient(){return this._orient}getScale(){return this._scale}getScales(){return this._scales}getTickData(t=0){return this._tickData[t]}get visible(){return this._visible}getInverse(){return this._inverse}getCoordinateType(){return this._coordinateType}constructor(t,e){var i;super(t,e),this.specKey="axes",this._scales=[],this._tickData=[],this._visible=!0,this._tick=void 0,this._onTickDataChange=t=>{this._forceLayout(),null==t||t.updateData()},this._visible=null==(i=t.visible)||i,this._coordinateType="none"}getVRenderComponents(){var t,e;return[null==(t=this._axisMark)?void 0:t.getProduct(),null==(e=this._gridMark)?void 0:e.getProduct()].filter(t5)}created(){var t,e,i,r,s,n,a,l,o,h,u,d,c,p,g,f,m,y,_;if(super.created(),this.setSeriesAndRegionsFromSpec(),this.initEvent(),this.initScales(),this.updateSeriesScale(),this._shouldComputeTickData()&&this._initData(),this._visible){let v=this._createMark({type:"component",name:`axis-${this.getOrient()}`},{componentType:"angle"===this.getOrient()?$.circleAxis:$.lineAxis,mode:this._spec.mode},{skipTheme:!0});if(this._updateTickDataMarks(v),this._axisMark=v,v.setMarkConfig({zIndex:this.layoutZIndex}),t5(this._spec.id)&&v.setUserId(this._spec.id),v.setMarkConfig({interactive:null!=(t=this._spec.interactive)?t:this.getDefaultInteractive()}),this._marks.addMark(v),null==(e=this._spec.grid)?void 0:e.visible){let t=this._createMark({type:"component",name:`axis-${this.getOrient()}-grid`},{componentType:"angle"===this.getOrient()?Y.circleAxisGrid:Y.lineAxisGrid,mode:this._spec.mode},{skipTheme:!0});this._updateTickDataMarks(t),t.setMarkConfig({zIndex:null!=(a=null!=(s=null==(r=null==(i=this._spec.grid)?void 0:i.style)?void 0:r.zIndex)?s:null==(n=this._spec.grid)?void 0:n.zIndex)?a:z.Axis_Grid,interactive:!1}),this._marks.addMark(t),this._gridMark=t}if((null==(l=this._option.globalInstance)?void 0:l.isAnimationEnable())&&!1!==iF(this._option.getChart().getSpec(),"animation")&&!0===this._spec.animation){let t=cv(null==(o=ig.getAnimationInKey("axis"))?void 0:o(),{appear:null!=(u=null!=(h=this._spec.animationAppear)?h:iF(this._option.getChart().getSpec(),"animationAppear.axis"))?u:iF(this._option.getChart().getSpec(),"animationAppear"),disappear:null!=(c=null!=(d=this._spec.animationDisappear)?d:iF(this._option.getChart().getSpec(),"animationDisappear.axis"))?c:iF(this._option.getChart().getSpec(),"animationDisappear"),enter:null!=(g=null!=(p=this._spec.animationEnter)?p:iF(this._option.getChart().getSpec(),"animationEnter.axis"))?g:iF(this._option.getChart().getSpec(),"animationEnter"),exit:null!=(m=null!=(f=this._spec.animationExit)?f:iF(this._option.getChart().getSpec(),"animationExit.axis"))?m:iF(this._option.getChart().getSpec(),"animationExit"),update:null!=(_=null!=(y=this._spec.animationUpdate)?y:iF(this._option.getChart().getSpec(),"animationUpdate.axis"))?_:iF(this._option.getChart().getSpec(),"animationUpdate")});t.enter&&(t.update[0].customParameters={enter:t.enter[0]}),this._marks.forEach(e=>e.setAnimationConfig(t))}}}_shouldComputeTickData(){return this.getVisible()||this._spec.forceInitTick}_initData(){let t=this._initTickDataSet(this._tickTransformOption()),e=new ly(this._option,t);this._tickData=[e],t.target.addListener("change",()=>{this._onTickDataChange(e)})}collectData(t,e){let i=[];return pW(this._regions,r=>{var s;let n=this.collectSeriesField(t,r);if(n=tY(n)?ai(this._scale.type)?n:[n[0]]:[n],t||(this._dataFieldText=r.getFieldAlias(n[0])),n){let t=r.getViewData();if(e)n.forEach(t=>{i.push(r.getRawDataStatisticsByField(t,!1))});else if(t&&t.latestData&&t.latestData.length){let e=null==(s=r.getViewDataStatistics)?void 0:s.call(r),a=this.type===rA.cartesianLinearAxis&&this._spec.breaks&&this._spec.breaks.length;n.forEach(r=>{var s;(null==(s=null==e?void 0:e.latestData)?void 0:s[r])&&(a?i.push(Object.assign(Object.assign({},e.latestData[r]),{values:t.latestData.map(t=>t[r])})):i.push(e.latestData[r]))})}}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),i}isSeriesDataEnable(){let t=!0;return pW(this._regions,e=>{var i;tY(null==(i=e.getViewDataStatistics())?void 0:i.latestData)&&(t=!1)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),t}setSeriesAndRegionsFromSpec(){let{seriesId:t,seriesIndex:e,regionId:i,regionIndex:r}=this._spec;t5(t)&&(this._seriesUserId=eo(t)),t5(i)&&(this._regionUserId=eo(i)),t5(e)&&(this._seriesIndex=eo(e)),t5(r)&&(this._regionIndex=eo(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionIndex),this.layout.layoutBindRegionID=this._regions.map(t=>t.id)}getBindSeriesFilter(){return{userId:this._seriesUserId,specIndex:this._seriesIndex}}initEvent(){this.event.on(rB.scaleUpdate,{filter:({model:t})=>(null==t?void 0:t.id)===this.id},this.effect.scaleUpdate.bind(this));let t=pU(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}).map(t=>t.getViewDataStatistics()).filter(t=>!!t);t.length>1?this._option.dataSet.multipleDataViewAddListener(t,"change",()=>{this.updateScaleDomain()}):1===t.length&&t[0].target.addListener("change",()=>{this.updateScaleDomain()}),pW(this._regions,t=>{t.event.on(rB.rawDataUpdate,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>{this._clearRawDomain()})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}updateScaleDomain(){}_clearRawDomain(){}onLayoutEnd(){this.updateScaleRange(),this.event.emit(rB.scaleUpdate,{model:this,value:"range"}),super.onLayoutEnd()}computeData(t){"force"!==t||this._tickData&&this._tickData.length?!this._tickData||!this._tickData.length||"force"!==t&&t1(this._scale.range(),[0,1])||this._tickData.forEach(t=>{t.getDataView().reRunAllTransform({skipEqual:!0})}):pW(this._regions,t=>{var e;null==(e=t.getViewData())||e.reRunAllTransform()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_updateTickDataMarks(t){this._tickData&&this._tickData.forEach(e=>{e.addRelatedMark(t)})}initScales(){this._scales=[this._scale];let t=[];if(pW(this._regions,e=>{let i=e.getGroups();i&&t.push(i)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),0!==t.length){let e=eu(t.map(t=>t.fields.length));for(let t=1;t<e;t++){let t=this._scale.clone();this._scales.push(t)}}}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reRender=!0,(null==e?void 0:e.type)!==(null==t?void 0:t.type)||(null==e?void 0:e.visible)!==(null==t?void 0:t.visible)?i.reMake=!0:i.reMake=["grid","subGrid","tick","subTick","label","domainLine","title"].some(i=>{var r,s;return(null==(r=null==e?void 0:e[i])?void 0:r.visible)!==(null==(s=null==t?void 0:t[i])?void 0:s.visible)})),i}_getAxisAttributes(){var t;let e=this._spec,i={orient:this.getOrient(),select:!0!==this._option.disableTriggerEvent&&e.select,hover:!0!==this._option.disableTriggerEvent&&e.hover};if((e.domainLine&&e.domainLine.visible?((t=ge(t=e.domainLine)).startSymbol=ge(t.startSymbol),t.endSymbol=ge(t.endSymbol),i.line=t):i.line={visible:!1},e.label&&e.label.visible)?(i.label=gI(e.label,["style","formatMethod","state"]),e.label.style&&(i.label.style=tK(e.label.style)?(t,i,r,s)=>{var n;let a=e.label.style(t.rawValue,i,t,r,s);return gs(it({},null==(n=this._theme.label)?void 0:n.style,a))}:gs(e.label.style)),(e.label.formatMethod||e.label.formatter)&&(i.label.formatMethod=this._getLabelFormatMethod()),e.label.state&&(i.label.state=function(t){if(nR(t))return null;let e={};return Object.keys(t).forEach(i=>{tK(t[i])?e[i]=(e,r,s,n)=>gs(t[i](e.rawValue,r,e,s,n)):nR(t[i])||(e[i]=gs(t[i]))}),e}(e.label.state)),tK(e.label.dataFilter)&&(i.label.dataFilter=(t,i)=>e.label.dataFilter(t,i,{vchart:this._option.globalInstance}))):i.label={visible:!1},e.tick&&e.tick.visible?(i.tick={visible:e.tick.visible,length:e.tick.tickSize,inside:e.tick.inside,alignWithLabel:e.tick.alignWithLabel,dataFilter:tK(e.tick.dataFilter)?t=>e.tick.dataFilter(t,{vchart:this._option.globalInstance}):void 0},e.tick.style&&(i.tick.style=tK(e.tick.style)?(t,i,r,s)=>{var n;let a=e.tick.style(t,i,r,s);return gs(it({},null==(n=this._theme.tick)?void 0:n.style,a))}:gs(e.tick.style)),e.tick.state&&(i.tick.state=gi(e.tick.state))):i.tick={visible:!1},e.subTick&&e.subTick.visible?(i.subTick={visible:e.subTick.visible,length:e.subTick.tickSize,inside:e.subTick.inside,count:e.subTick.tickCount},e.subTick.style&&(i.subTick.style=tK(e.subTick.style)?(t,i,r,s)=>{var n;let a=e.subTick.style(t,i,r,s);return gs(it({},null==(n=this._theme.subTick)?void 0:n.style,a))}:gs(e.subTick.style)),e.subTick.state&&(i.subTick.state=gi(e.subTick.state))):i.subTick={visible:!1},e.title&&e.title.visible){let t=e.title,{autoRotate:r,angle:s,style:n={},background:a,state:l,shape:o}=t,h=gz(t,["autoRotate","angle","style","background","state","shape"]),u,d=s;"left"!==e.orient&&"right"!==e.orient||r&&et(d)&&(d="left"===e.orient?-90:90,u=gn[e.orient]),i.title=Object.assign(Object.assign({},h),{autoRotate:!1,angle:d?lu(d):null,textStyle:it({},u,gs(n)),pickable:!1!==n.pickable,childrenPickable:!1!==n.pickable,state:{}}),o&&o.visible?(i.title.shape=Object.assign(Object.assign({},o),{style:gs(o.style)}),o.state&&(i.title.state.shape=gi(o.state))):i.title.shape={visible:!1},a&&a.visible?(i.title.background=Object.assign(Object.assign({},a),{style:gs(a.style)}),a.state&&(i.title.state.background=gi(a.state))):i.title.background={visible:!1},l&&(i.title.state.text=gi(l))}else i.title={visible:!1};return e.background&&e.background.visible?(i.panel={visible:!0},e.background.style&&(i.panel.style=gs(e.background.style)),e.background.state&&(i.panel.state=gi(e.background.state))):i.panel={visible:!1},i}_getGridAttributes(){let t=this._spec;return{alternateColor:t.grid.alternateColor,alignWithLabel:t.grid.alignWithLabel,style:tK(t.grid.style)?(e,i)=>{var r,s;let n=t.grid.style(null==(r=e.datum)?void 0:r.rawValue,i,e.datum);return gs(it({},null==(s=this._theme.grid)?void 0:s.style,n))}:gs(t.grid.style),subGrid:!1===t.subGrid.visible?{visible:!1}:{type:"line",visible:t.subGrid.visible,alternateColor:t.subGrid.alternateColor,style:gs(t.subGrid.style)}}}_getLabelFormatMethod(){let{formatMethod:t,formatter:e}=this._spec.label,{formatFunc:i}=dJ(t,e);return i?(t,r,s)=>i(r.rawValue,r,e):null}_initTickDataSet(t,e=0){sX(this._option.dataSet,"scale",gF);let i=this.registerTicksTransform();return new er(this._option.dataSet,{name:`${this.type}_${this.id}_ticks_${e}`}).parse(this._scales[e],{type:"scale"}).transform({type:i,options:t},!1)}_tickTransformOption(){let t=this._tick||{},e=this._spec.label||{},{tickCount:i,forceTickCount:r,tickStep:s,tickMode:n}=t,{style:a,formatMethod:l,minGap:o}=e;return{sampling:!1!==this._spec.sampling,tickCount:i,forceTickCount:r,tickStep:s,tickMode:n,axisOrientType:this._orient,coordinateType:this._coordinateType,labelStyle:a,labelFormatter:l,labelGap:o}}addTransformToTickData(t,e){this._tickData.forEach(i=>{var r;null==(r=null==i?void 0:i.getDataView())||r.transform(t,e)})}dataToPosition(t){return this._scale.scale(t)}getDatum(t){var e;return t&&t.name===gD.X9.label?t.data:this._axisMark?null==(e=this._axisMark.getComponent())?void 0:e.attribute.items:void 0}scaleRangeFactor(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactor(t,e,i)}scaleRangeFactorEnd(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorEnd(t,e)}scaleRangeFactorStart(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorStart(t,e)}}gj.specKey="axes";let gH=()=>{gL(),ig.registerAnimation("axis",()=>({appear:{type:"fadeIn"},enter:{type:"fadeIn"},update:{type:"update"},exit:{type:"fadeOut"}}))};var gN=i(29411);let gV=t=>{let{x:e,y:i}=t[0].getLayoutStartPoint(),r=e+t[0].getLayoutRect().width,s=i+t[0].getLayoutRect().height;for(let n=1;n<t.length;n++){let a=t[n],{x:l,y:o}=a.getLayoutStartPoint(),{width:h,height:u}=a.getLayoutRect();e=Math.min(e,l),r=Math.max(r,h+l),i=Math.min(i,o),s=Math.max(s,u+o)}return{width:Math.abs(r-e),height:Math.abs(s-i)}};var gW=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};let gU=[gt];class gG extends gj{getOrient(){return this._orient}getDefaultInteractive(){return!0}set autoIndentOnce(t){this._autoIndentOnce=t}getScales(){return this._scales}constructor(t,e){super(t,e),this.type=rA.cartesianAxis,this.name=rA.cartesianAxis,this._defaultBandPosition=.5,this._defaultBandInnerPadding=.1,this._defaultBandOuterPadding=.3,this.layoutType="region-relative",this.layoutZIndex=z.Axis,this.layoutLevel=j.Axis,this._orient="left",this._autoIndentOnce=!1,this._hasAutoIndent=!1,this._scales=[],this._tick=void 0,this._layoutCache={width:0,height:0,_lastComputeOutBounds:{x1:0,x2:0,y1:0,y2:0}},this._innerOffset={top:0,bottom:0,left:0,right:0},this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),pW(this._regions,t=>{let e=this.getOrient();p$(e)?gd(t.getXAxisHelper(),this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&t.setXAxisHelper(this.axisHelper()):pY(e)?gd(t.getYAxisHelper(),this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&t.setYAxisHelper(this.axisHelper()):pX(e)&&gd(t.getZAxisHelper(),this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&t.setZAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=t=>{let{x:e,y:i}=t;return ee(e)&&(e+=Number("left"===this._orient)*this.getLayoutRect().width),ee(i)&&(i+=Number("top"===this._orient)*this.getLayoutRect().height),{x:e,y:i}},this._transformLayoutRect=t=>{if(!this._visible)return t;let e=this._latestBounds.clone().translate(-this.getLayoutStartPoint().x,-this.getLayoutStartPoint().y);switch(this._layout.layoutOrient){case"left":this._layout.layoutRectLevelMap.width===nV&&(t.width=e.x1<0?-e.x1:0);break;case"right":this._layout.layoutRectLevelMap.width===nV&&(t.width=e.x2>0?e.x2:0);break;case"top":this._layout.layoutRectLevelMap.height===nV&&(t.height=e.y1<0?-e.y1:0);break;case"bottom":this._layout.layoutRectLevelMap.height===nV&&(t.height=e.y2>0?e.y2:0)}return t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),this._layout.setRectInSpec(this._layoutCacheProcessing(t))},this._transformLayoutPadding=t=>("left"===this.layoutOrient||"right"===this.layoutOrient?(t.top=0,t.bottom=0):"top"!==this.layoutOrient&&"bottom"!==this.layoutOrient||(t.left=0,t.right=0),t),this._updateAxisLayout=()=>{let t=this.getLayoutStartPoint(),e=this._getUpdateAttribute(!1),{grid:i}=e,r=gW(e,["grid"]),s=it({x:t.x,y:t.y},this._axisStyle,r);this._axisMark.setSimpleStyle(s),this._gridMark&&this._gridMark.setSimpleStyle(it({x:t.x,y:t.y},this._getGridAttributes(),i))},this._fixAxisOnZero=()=>{let{onZero:t,visible:e}=this._spec.domainLine;if(this.visible&&t&&!1!==e){let{onZeroAxisId:t,onZeroAxisIndex:e}=this._spec.domainLine,i=this._option.getComponentsByKey("axes"),r=p$(this.getOrient()),s=t=>{var e;return(r?!p$(t.getOrient()):p$(t.getOrient()))&&ai(t.getScale().type)&&(t.getTickData()?null==(e=t.getTickData().getLatestData())?void 0:e.find(t=>0===t.value):t.getScale().domain()[0]<=0&&eh(t.getScale().domain())>=0)},n=i.filter(t=>s(t));if(n.length){let a;if(t5(t))a=n.find(e=>e.id===t);else if(t5(e)){let t=i[e];s(t)&&(a=t)}else a=n[0];if(a){let t=this._axisMark,e=a.valueToPosition(0);r?t.setSimpleStyle(Object.assign(Object.assign({},t.getSimpleStyle()),{line:Object.assign(Object.assign({},this._axisStyle.line),{dy:"bottom"===this._orient?-((a.getInverse()?a.getScale().range()[1]:a.getScale().range()[0])-e):e})})):t.setSimpleStyle(Object.assign(Object.assign({},t.getSimpleStyle()),{line:Object.assign(Object.assign({},this._axisStyle.line),{dx:"left"===this._orient?e:-((a.getInverse()?a.getScale().range()[0]:a.getScale().range()[1])-e)})}))}}}},this._orient=pK(t,["z"]),pX(this._orient)&&(this.layoutType="absolute"),this._dataSet=e.dataSet,this._coordinateType="cartesian"}static getSpecInfo(t){let e=t[this.specKey];if(!e)return null;let i="horizontal"===t.direction;if(!tY(e)){if(!go(e))return null;let{axisType:t,componentName:r}=pQ(e,i);return e.type=t,[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:r}]}let r=!0;if(e.filter(t=>"z"===t.orient)[0]){let t=e.filter(t=>"bottom"===t.orient)[0],i=e.filter(t=>pY(t.orient))[0];r=3===e.length&&t&&i}let s=e.map((t,e)=>({spec:t,index:e}));r||(s=s.filter(({spec:t})=>"z"!==t.orient));let n=[];return s.forEach(({spec:t,index:e})=>{if(!go(t))return;let{axisType:r,componentName:s}=pQ(t,i);t.type=r,n.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:s})}),n}static createComponent(t,e){let{spec:i}=t,r=gW(t,["spec"]),s=ig.getComponentInKey(r.type);return s?new s(i,Object.assign(Object.assign({},e),r)):(e.onError(`Component ${r.type} not found`),null)}initLayout(){super.initLayout(),this._layout.autoIndent=!1!==this._spec.autoIndent,this._layout.layoutOrient=this._orient}getNewScaleRange(){let{width:t,height:e}=this.getLayoutRect(),{left:i,right:r,top:s,bottom:n}=this._innerOffset,a=[];return p$(this.getOrient())?ee(t)&&(a=this._inverse?[t-r,i]:[i,t-r]):pX(this.getOrient())?ee(t)&&(a=this._inverse?[t-r,i]:[i,t-r],this._scale.range(a)):ee(e)&&(a=this._inverse?[s,e-n]:[e-n,s]),a}updateScaleRange(){let t=!1,e=this.getNewScaleRange(),i=this._scale.range();return e.length===i.length&&e.every((t,e)=>t===i[e])?t=!1:(t=!0,this._scale.range(e)),t}init(t){var e;super.init(t),null==(e=this.pluginService)||e.load(gU.map(t=>new t)),this.callPlugin(t=>{this.pluginService&&t.onInit&&t.onInit(this.pluginService,this)})}setAttrFromSpec(){var t,e,i;let r;if(super.setAttrFromSpec(),this.visible){p$(this.getOrient())?pZ(this._spec.maxHeight)&&(this._spec.maxHeight="30%"):pZ(this._spec.maxWidth)&&(this._spec.maxWidth="30%");let t=this._getAxisAttributes();t.label.formatMethod=this._getLabelFormatMethod(),t.verticalFactor="top"===this.getOrient()||"right"===this.getOrient()?-1:1,this._axisStyle=t}this._tick=this._spec.tick;let s=null==(t=this._option.getChart())?void 0:t.getSpec();this._inverse=(e=this._spec,i="horizontal"===(null==s?void 0:s.direction),r=e.inverse,i&&!p$(e.orient)&&(r=!t5(e.inverse)||!e.inverse),r)}onLayoutStart(t,e){if(super.onLayoutStart(t,e),!pX(this.getOrient())&&this._spec.innerOffset){let t=this._spec;pY(this.getOrient())?["top","bottom"].forEach(i=>{this._innerOffset[i]=ex(t.innerOffset[i],e.height,e)}):["left","right"].forEach(i=>{this._innerOffset[i]=ex(t.innerOffset[i],e.width,e)})}}getSeriesStatisticsField(t){let e;return e=p$(this.getOrient())?t.fieldX:pX(this.getOrient())?t.fieldZ:t.fieldY,ai(this._scale.type)?e:[e[0]]}_tickTransformOption(){var t,e,i,r;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimals:null==(t=this._tick)?void 0:t.noDecimals,labelLastVisible:null==(e=this._spec.label)?void 0:e.lastVisible,labelFirstVisible:null==(i=this._spec.label)?void 0:i.firstVisible,labelFlush:null==(r=this._spec.label)?void 0:r.flush})}axisHelper(){return{isContinuous:ai(this._scale.type),dataToPosition:this.dataToPosition.bind(this),getScale:(t=0)=>this._scales[t],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!0===this._inverse,getSpec:()=>this._spec}}afterCompile(){var t;(null==(t=this._axisMark)?void 0:t.getProduct())&&this.event.on(rE.AFTER_ELEMENT_ENCODE,({mark:t})=>{if(t===this._axisMark&&!1===this._isLayout&&(p$(this.getOrient())?this.callPlugin(t=>{this.pluginService&&t.onDidLayoutHorizontal&&t.onDidLayoutHorizontal(this.pluginService,this)}):this.callPlugin(t=>{this.pluginService&&t.onDidLayoutVertical&&t.onDidLayoutVertical(this.pluginService,this)}),this._unitText)){let{x:t,y:e}=this.getLayoutStartPoint(),i=p$(this._orient)?{x:eu(this._scale.range())+t,y:e}:{x:t,y:ed(this._scale.range())+e};this._unitText.setAttributes(i)}}),this.callPlugin(t=>{this.pluginService&&t.onDidCompile&&t.onDidCompile(this.pluginService,this)})}collectScale(){let t=[];return pW(this._regions,e=>{t.push("left"===this.getOrient()||"right"===this.getOrient()?e.scaleY:e.scaleX)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),t}collectSeriesField(t,e){var i,r;return t>0?null==(r=null==(i=e.getGroups())?void 0:i.fields)?void 0:r[t]:p$(this.getOrient())?e.getSpec().x2Field?[...e.fieldX,e.fieldX2]:e.fieldX:pX(this.getOrient())?e.fieldZ:e.getSpec().y2Field?[...e.fieldY,e.fieldY2]:e.fieldY}updateSeriesScale(){let t=this.getOrient();pW(this._regions,e=>{p$(t)?gd(e.getXAxisHelper(),this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&(e.setScaleX(this._scale),e.setXAxisHelper(this.axisHelper())):pY(t)?gd(e.getYAxisHelper(),this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&(e.setScaleY(this._scale),e.setYAxisHelper(this.axisHelper())):pX(t)&&gd(e.getZAxisHelper(),this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&(e.setScaleZ(this._scale),e.setZAxisHelper(this.axisHelper()))},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getBoundsInRect(t){var e;let i={x1:0,y1:0,x2:0,y2:0};if(!this._visible)return i;this._verticalLimitSize=p$(this.getOrient())?t.height:t.width,this.setLayoutRect(t),!this.updateScaleRange()&&tY(null==(e=this.getTickData())?void 0:e.getLatestData())||this.computeData("range");let r={skipLayout:!1},s=p$(this.getOrient());this.pluginService&&(s?this.callPlugin(t=>{t.onWillLayoutHorizontal&&t.onWillLayoutHorizontal(this.pluginService,r,this)}):this.callPlugin(t=>{t.onWillLayoutVertical&&t.onWillLayoutVertical(this.pluginService,r,this)}));let n=this._axisMark.getProduct(),a=!1;if(!r.skipLayout){let t=this._getUpdateAttribute(!0),e=this._axisMark.getComponent(),r=it(Object.assign({},this.getLayoutStartPoint()),this._axisStyle,t,{line:{visible:!1}}),n=null==e?void 0:e.getBoundsWithoutRender(r);n&&!n.empty()||(n=(new pV).set(r.x,r.y,r.x,r.y)),a=!0,this._latestBounds=n,i=this._appendAxisUnit(n,s)}return a||(this._latestBounds=n.AABBBounds),i}positionToData(t,e){let i=p$(this.getOrient());e&&(t-=i?this.getLayoutStartPoint().x:this.getLayoutStartPoint().y),this._innerOffset&&(t=i?eH(t,this._innerOffset.left,this.getLayoutRect().width-this._innerOffset.right):eH(t,this._innerOffset.top,this.getLayoutRect().height-this._innerOffset.bottom));let r=this._scale.range();return(t-r[0])*(t-eh(r))>0?null:this._scale.invert(t)}_getTitleLimit(t){var e,i,r,s,n;let a=this._spec.title;if(a.visible&&et(null==(e=a.style)?void 0:e.maxLineWidth)){let e=null!=(n=null!=(r=null==(i=this._axisStyle.title)?void 0:i.angle)?r:null==(s=a.style)?void 0:s.angle)?n:0;if(t){let t=this.getLayoutRect().width,i=Math.abs(Math.cos(e));return i<1e-6?1/0:t/i}let l=this.getLayoutRect().height,o=Math.abs(Math.sin(e));return o<1e-6?1/0:l/o}return null}_getUpdateAttribute(t){let e=0,i=0;if(!t){let t=gV(this.getRegions());i=t.width,e=t.height}let{width:r,height:s}=this.getLayoutRect(),n=p$(this._orient),a=pY(this._orient),l={x:0,y:0},o=e,h=r;n?l={x:r,y:0}:a&&(l={x:0,y:s},o=i,h=s);let u=this.getLabelItems(h),d={start:{x:0,y:0},end:l,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(n)},items:u,scale:this._scale.clone()};t||(d.grid={type:"line",start:{x:0,y:0},end:l,items:u[0],verticalFactor:this._axisStyle.verticalFactor,length:o});let c=n?this.layout.minHeight:this.layout.minWidth;return(n&&this._layout.layoutRectLevelMap.height===nN||a&&this._layout.layoutRectLevelMap.width===nN)&&(c=this._verticalLimitSize),d.verticalLimitSize=this._verticalLimitSize,d.verticalMinSize=c,d.label={overflowLimitLength:this._getLabelOverflowLimit(n)},this._afterUpdateAttribute?this._afterUpdateAttribute(d,t):d}getLabelItems(t){var e;let i=null==(e=this.getTickData())?void 0:e.getLatestData();return i&&i.length?[i.map(e=>{let i=this._getNormalizedValue([e.value],t);return gu(e.value,i)}).filter(t=>{let{value:e,rawValue:i}=t,r=this._scale.domain();return"log"===this.getSpec().type?e>=0&&e<=1:ai(this._scale.type)?i>=r[0]&&i<=eh(r):r.includes(i)})]:[]}initEvent(){super.initEvent(),this.visible&&(this.event.on(rB.layoutEnd,this._updateAxisLayout),this.event.on(rB.layoutEnd,this._fixAxisOnZero),this.event.on(rB.layoutRectUpdate,()=>{this._clearLayoutCache()}))}_getNormalizedValue(t,e){return 0===e?0:this.dataToPosition(t)/e}_layoutCacheProcessing(t){return["width","height"].forEach(e=>{t[e]<this._layoutCache[e]?t[e]=this._layoutCache[e]:this._layoutCache[e]=t[e]}),this._autoIndentOnce&&this._hasAutoIndent?["x1","x2","y1","y2"].forEach(t=>{this.layout.getLastComputeOutBounds()[t]=this._layoutCache._lastComputeOutBounds[t]}):(this._hasAutoIndent=!0,["x1","x2","y1","y2"].forEach(t=>{this.layout.getLastComputeOutBounds()[t]<this._layoutCache._lastComputeOutBounds[t]?this.layout.getLastComputeOutBounds()[t]=this._layoutCache._lastComputeOutBounds[t]:this._layoutCache._lastComputeOutBounds[t]=this.layout.getLastComputeOutBounds()[t]})),t}reInit(t){super.reInit(t),this._clearLayoutCache()}_clearLayoutCache(){this._hasAutoIndent=!1,this._layoutCache.width=0,this._layoutCache.height=0,this._layoutCache._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0}}onDataUpdate(){this._clearLayoutCache()}_appendAxisUnit(t,e){var i;if(this._spec.unit&&this._spec.unit.visible){let r,s,{text:n,style:a}=this._spec.unit,{x:l,y:o}=this.getLayoutStartPoint();e?(r={x:eu(this._scale.range())+l,y:o},s={textAlign:"left",textBaseline:"middle"}):(r={x:l,y:ed(this._scale.range())+o},s={textAlign:"left"===this._orient?"left":"right",textBaseline:"bottom"}),s=Object.assign(Object.assign(Object.assign({},s),a),{x:r.x,y:r.y,text:n}),this._unitText?this._unitText.setAttributes(s):(this._unitText=(0,gN.r)(s),this._unitText.name="axis-unit",null==(i=this.getContainer())||i.add(this._unitText));let h=this._unitText.AABBBounds;e?(t.x2+=h.x2>t.x2?h.x2-t.x2:0,t.y2+=h.y2>t.y2?h.y2-t.y2:0):(t.x1+=h.x1<t.x1?h.x1-t.x1:0,t.y1+=h.y1<t.y1?h.y1-t.y1:0)}return t}_getNeedClearVRenderComponents(){return this._unitText?[this._unitText]:[]}_getLabelOverflowLimit(t){var e,i;if(t&&!1!==(null==(e=this._spec.label)?void 0:e.visible)&&!0===(null==(i=this._spec.label)?void 0:i.autoLimit)){let t=this._option.getComponentsByKey("axes"),e=this.getRegions(),i=t.filter(t=>{let i=t.getOrient();return("left"===i||"right"===i)&&t.getRegions().some(t=>e.includes(t))}),r=0,s=0,n=this.getLayoutStartPoint().x,a=n+this.getLayoutRect().width;return i.forEach(t=>{let e=t.getLayoutStartPoint().x;if("left"===t.getOrient()&&e===n){let e=t.getLayoutRect().width;r=Math.max(r,e)}else if(e===a){let e=t.getLayoutRect().width;s=Math.max(s,e)}}),{left:r,right:s}}}}gG.type=rA.cartesianAxis,gG.specKey="axes";class gZ{constructor(){this._rawDomainIndex=[]}_initData(){var t;if(this._spec.showAllGroupLayers&&this._scales.length>1)for(let e=0;e<this._scales.length;e++){let i=(null!=(t=this._spec.layers)?t:[])[this._scales.length-1-e]||{};if(!1!==i.visible&&0!==i.tickCount&&0!==i.forceTickCount){let t=this._initTickDataSet(Object.assign(Object.assign({},this._tickTransformOption()),i),e),r=new ly(this._option,t);this._tickData.push(r),t.target.addListener("change",()=>{this._onTickDataChange(r)}),this._tickDataMap||(this._tickDataMap={}),this._tickDataMap[e]=r}}else{let t=this._initTickDataSet(this._tickTransformOption()),e=new ly(this._option,t);t.target.addListener("change",()=>{this._onTickDataChange(e)}),this._tickData=[e],this._tickDataMap={0:e}}}_updateData(){var t,e,i;let r=this.registerTicksTransform();if(this._spec.showAllGroupLayers&&this._scales.length>1){let e=null!=(t=this._spec.layers)?t:[];Object.keys(this._tickDataMap).forEach(t=>{let i=e[this._scales.length-1-t]||{},s=this._tickDataMap[t],n=null==s?void 0:s.getDataView().transformsArr.find(t=>t.type===r);n&&(n.options=Object.assign(Object.assign({},this._tickTransformOption()),i))})}else{let t=null==(i=null==(e=this._tickData)?void 0:e[0])?void 0:i.getDataView().transformsArr.find(t=>t.type===r);t&&(t.options=this._tickTransformOption())}}dataToPosition(t,e={}){var i,r;if(0===t.length||0===this._scales.length)return 0;let{position:s,bandScale:n}=this.getPosition(t);return s+n.bandwidth()*(null!=(r=null!=(i=e.bandPosition)?i:this._spec.bandPosition)?r:this._defaultBandPosition)}valueToPosition(t){return this._scale.scale(t)}updateGroupScaleRange(){let t=this._scale;this._scales.forEach((e,i)=>{i>0&&(e.range([0,t.bandwidth()]),t=e)})}getPosition(t){let e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{let r=Math.min(t.length,this._scales.length);for(let i=0;i<r;i++)e+=this._scales[i].scale(t[i]);i=this._scales[r-1]}return{position:e,bandScale:i}}calcScales(t,e){var i,r;let{bandPadding:s,paddingInner:n,paddingOuter:a}=this._spec,l=tY(s),o=tY(n),h=tY(a);for(let u=0;u<this._scales.length;u++){let d=l?s[u]:s,c=o?n[u]:n,p=h?a[u]:a;this._scales[u].paddingInner(null!=(i=null!=c?c:d)?i:t,!0).paddingOuter(null!=(r=null!=p?p:d)?r:e,!0)}}computeBandDomain(t){if(!t.length)return[];if(1===t.length)return t[0].values;let e=new Set;for(let i=0;i<t.length;i++)for(let r=0;r<t[i].values.length;r++)e.add(t[i].values[r]);return Array.from(e)}updateScaleDomain(){var t;if(!this.isSeriesDataEnable())return;(null==(t=this._rawDomainIndex)?void 0:t.length)||!this._scales.length||this._updateRawDomain();let e=this._spec.domain;for(let t=0;t<this._scales.length;t++)if(e&&e.length&&0===t)this._scales[t].domain(e);else{let e=this.collectData(t),i=this.computeBandDomain(e);this._scales[t].domain(i.sort((e,i)=>this._rawDomainIndex[t][e]-this._rawDomainIndex[t][i]))}this.transformScaleDomain(),this.event.emit(rB.scaleDomainUpdate,{model:this}),this.event.emit(rB.scaleUpdate,{model:this,value:"domain"})}getLabelItems(t){let e=[],i=[];return(this._spec.showAllGroupLayers?this._scales:[this._scales[0]]).forEach((r,s)=>{var n;let a=this._tickDataMap[s],l=null==(n=null==a?void 0:a.getLatestData())?void 0:n.length,o=l?a.getLatestData().map(t=>t.value):r.domain();if(o&&o.length)if(i&&i.length){let r=[],s=[];i.forEach(e=>{o.forEach(i=>{let n=eo(e).concat(i);if(s.push(n),l){let e=gu(i,this._getNormalizedValue(n,t));r.push(e)}})}),l&&e.push(r.filter(t=>t.value>=0&&t.value<=1)),i=s}else o.forEach(t=>{i.push(t)}),l&&e.push(a.getLatestData().map(e=>gu(e.value,this._getNormalizedValue([e.value],t))).filter(t=>t.value>=0&&t.value<=1))}),e.reverse()}_updateRawDomain(){this._rawDomainIndex=[];let t=this._spec.domain;for(let e=0;e<this._scales.length;e++)if(t&&t.length&&0===e)this._scales[e].domain(t);else{let t=this.collectData(e,!0),i=this.computeBandDomain(t);this._rawDomainIndex[e]={},i.forEach((t,i)=>this._rawDomainIndex[e][t]=i)}}_clearRawDomain(){this._rawDomainIndex=[]}}var g$=i(80133),gY=i(87986),gX=i(88504),gK=i(28076),gq=i(93227);function gQ(t,e,i,r){let s="";if(!t||0===e.length)return s;let n=e[0],a=uE.HL.distancePP(t,n),l=+!i;return r?s+=`M${t.x},${t.y-a}A${a},${a},0,0,${l},${t.x},${t.y+a}A${a},${a},0,0,${l},${t.x},${t.y-a}Z`:e.forEach((t,e)=>{0===e?s=`M${t.x},${t.y}`:s+=`A${a},${a},0,0,${l},${t.x},${t.y}`}),s}class gJ extends gK.k{constructor(){super(...arguments),this.name="axis-grid",this.data=[]}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}render(){this._prevInnerView=this._innerView&&(0,gq.uX)(this._innerView),this.removeAllChild(!0),this._innerView=c$.i.group({x:0,y:0,pickable:!1}),this.add(this._innerView);let{items:t,visible:e}=this.attribute;t&&t.length&&!1!==e&&(this.data=this._transformItems(t),this._renderGrid(this._innerView))}getVerticalCoord(t,e,i){return(0,gq.cN)(t,this.getVerticalVector(e,i,t))}_transformItems(t){let e=[];return t.forEach(t=>{var i;e.push(Object.assign(Object.assign({},t),{point:this.getTickCoord(t.value),id:null!=(i=t.id)?i:t.label}))}),e}_renderGrid(t){let{visible:e}=this.attribute.subGrid||{};e&&this._renderGridByType(!0,t),this._renderGridByType(!1,t)}_renderGridByType(t,e){let i=(0,cZ.Z)({},this.attribute,this.getGridAttribute(t)),{type:r,items:s,style:n,closed:a,alternateColor:l,depth:o=0}=i,h=t?`${gD.X9.grid}-sub`:`${gD.X9.grid}`;if(s.forEach((t,i)=>{let{id:s,points:l}=t,u="";if("line"===r||"polygon"===r)u=(0,gq.st)(l,!!a);else if("circle"===r){let{center:t}=this.attribute;u=gQ(t,l,!1,!!a)}let d=c$.i.path(Object.assign({path:u,z:o},(0,uc.Z)(n)?(0,cZ.Z)({},this.skipDefault?null:gJ.defaultAttributes.style,n(t,i)):n));d.name=`${h}-line`,d.id=this._getNodeId(`${h}-path-${s}`),e.add(d)}),o&&"line"===r&&s.forEach((t,i)=>{let{id:r,points:s}=t,l=[];l.push(s[0]);let u=s[1].x-s[0].x,d=s[1].y-s[0].y,c=o/Math.sqrt(u*u+d*d);l.push({x:s[0].x+u*c,y:s[0].y+d*c});let p=(0,gq.st)(l,!!a),g=(0,gX.Wn)(l[0].x-l[1].x),f=(0,gX.Wn)(l[0].y-l[1].y),m=c$.i.path(Object.assign({path:p,z:0,alpha:g>f?(s[1].x-s[0].x>0?-1:1)*gX.pi/2:0,beta:g<f?-gX.pi/2:0,anchor3d:g>f?[l[0].x,0]:[0,l[0].y]},(0,uc.Z)(n)?(0,cZ.Z)({},this.skipDefault?null:gJ.defaultAttributes.style,n(t,i)):n));m.name=`${h}-line`,m.id=this._getNodeId(`${h}-path-${r}`),e.add(m)}),s.length>1&&l){let t=(0,lG.Z)(l)?l:[l,"transparent"],r=e=>t[e%t.length],n=this.attribute.items,a=n[0],o=n[n.length-1],u=!(0,py.Yt)(a.value,0)&&!(0,py.Yt)(o.value,0),d=!(0,py.Yt)(a.value,1)&&!(0,py.Yt)(o.value,1),c=[],p=a.value>o.value;(p&&d||!p&&u)&&c.push(this.getGridPointsByValue(+!!p)),s.forEach(t=>{c.push(t.points)}),(p&&u||!p&&d)&&c.push(this.getGridPointsByValue(+!p));for(let t=0;t<c.length-1;t++){let s=function(t,e,i){let{type:r,closed:s}=i,n=e.slice(0).reverse(),a="",l="";if("line"===r&&i.smoothLink&&i.center){let e=t[0],r=n[0],o=i.center;a=(0,gq.st)(t,!!s),l=(0,gq.st)(n,!!s);let h=uE.HL.distancePP(r,o),u=uE.HL.distancePP(e,o);a+=`A${h},${h},0,0,1,${r.x},${r.y}L${r.x},${r.y}`,l+=`A${u},${u},0,0,0,${e.x},${e.y}`}else if("circle"===r){let{center:e}=i;a=gQ(e,t,!1,!!s),l=gQ(e,n,!0,!!s)}else"line"!==r&&"polygon"!==r||(a=(0,gq.st)(t,!!s),l=(0,gq.st)(n,!!s));return s?a+=l:(a+=l="L"+l.substring(1),a+="Z"),a}(c[t],c[t+1],i),n=c$.i.path({path:s,fill:r(t)});n.name=`${h}-region`,n.id=this._getNodeId(`${h}-region-${t}`),e.add(n)}}}_getNodeId(t){return`${this.id}-${t}`}_parseTickSegment(){let t=1;return this.data.length>=2&&(t=this.data[1].value-this.data[0].value),t}_getPointsOfSubGrid(t,e){let i=this.data.length,r=[];return i>=2&&this.data.forEach(i=>{let s=i.value;if(!e){let e=i.value-t/2;if(this.isInValidValue(e))return;s=e}r.push({value:s})}),r}release(){super.release(),this._prevInnerView=null,this._innerView=null}}gJ.defaultAttributes={style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]}}};var g0=i(34687),g1=i(71060);(0,g1.nZ)();class g2 extends gJ{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},gJ.defaultAttributes,t),e)}_getGridPoint(t,e){let i;if("line"===t){let{length:t}=this.attribute;i=[e,this.getVerticalCoord(e,t,!0)]}else if("circle"===t||"polygon"===t){let{center:t,sides:r=6,startAngle:s=c5.v2,endAngle:n=c5.Di}=this.attribute,a=uE.HL.distancePP(t,e);i=(0,gq.zl)(t,r,a,s,n)}return i}getGridPointsByValue(t){let e=this.getTickCoord(t);return this._getGridPoint(this.attribute.type,e)}getGridAttribute(t){let{type:e,alignWithLabel:i=!0}=this.attribute,r=this._parseTickSegment(),s,n=[];if(t){s=(0,cZ.Z)({},this.attribute,this.attribute.subGrid);let t=[],{count:e=4}=s;if(this.data.length>=2){let s=this._getPointsOfSubGrid(r,i);for(let i=0;i<s.length-1;i++){let r=s[i],n=s[i+1];t.push({id:`sub-${i}-0`,points:this.getGridPointsByValue(r.value),datum:{}});for(let s=0;s<e;s++){let a=(s+1)/(e+1),l=(1-a)*r.value+a*n.value;t.push({id:`sub-${i}-${s+1}`,points:this.getGridPointsByValue(l),datum:{}})}i===s.length-2&&t.push({id:`sub-${i}-${e+1}`,points:this.getGridPointsByValue(n.value),datum:{}})}n=t}}else{s=this.attribute;let t=[];this.data.forEach(s=>{let{point:n}=s;if(!i){let t=s.value-r/2;if(this.isInValidValue(t))return;n=this.getTickCoord(t)}t.push({id:s.label,datum:s,points:this._getGridPoint(e,n)})}),n=t}return Object.assign(Object.assign({},s),{items:n})}}(0,gY.jB)(g2,g0.b);var g3=i(7210);let g5={domainLine:{visible:!0},grid:{visible:!1},subGrid:{visible:!1},tick:{visible:!0},subTick:{visible:!1}},g4={domainLine:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,inside:!1,tickSize:4,alignWithLabel:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},subTick:{visible:!1,tickSize:2,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},label:{visible:!0,inside:!1,space:10,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}},title:{space:10,padding:0,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor"},fontWeight:"normal",fillOpacity:1}}},g7={label:{space:8},title:{space:8},maxHeight:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},g6={label:{space:12,autoLimit:!0},title:{space:12,autoRotate:!0},maxWidth:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}};class g9 extends gG{constructor(){super(...arguments),this.type=rA.cartesianBandAxis,this._scale=new a9}computeDomain(t){return this.computeBandDomain(t)}updateScaleRange(){let t=super.updateScaleRange();return this.updateGroupScaleRange(),t}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}axisHelper(){let t=(t=0)=>this._scales[t];return{isContinuous:!1,dataToPosition:this.dataToPosition.bind(this),getScale:t,getBandwidth:(e=0)=>t(e).bandwidth(),getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>this._inverse,getSpec:()=>this._spec}}registerTicksTransform(){let t=`${this.type}-ticks`;return sY(this._option.dataSet,t,g$.U),t}transformScaleDomain(){this.updateFixedWholeLength()}updateFixedWholeLength(){if(this._scale){let{bandSize:t,maxBandSize:e,minBandSize:i}=this._getOuterBandSizeFromSpec();if(t&&this._scale.bandwidth(t),e&&this._scale.maxBandwidth(e),i&&this._scale.minBandwidth(i),this._scale.isBandwidthFixed()&&this._spec.autoRegionSize&&(t||e)){let i=ak(this._scale.domain().length,null!=t?t:e,this._scale.paddingInner(),this._scale.paddingOuter());["bottom","top"].includes(this._orient)?this._regions.forEach(t=>t.setMaxWidth(i)):["left","right"].includes(this._orient)&&this._regions.forEach(t=>t.setMaxHeight(i))}}}_getOuterBandSizeFromSpec(){var t;let{bandSize:e,maxBandSize:i,minBandSize:r,bandSizeLevel:s=0}=this._spec,{gap:n,extend:a=0}=null!=(t=this._spec.bandSizeExtend)?t:{};s=Math.min(s,this._scales.length-1);for(let t=s;t>0;t--){let l=this._scales[t],o=l.domain(),h=l.paddingInner(),u=l.paddingOuter(),d=e=>{let i=t===s?a:0;return et(n)||t<s?ak(o.length,e,h,u)+i:(e+(t3(n)?e*(Number(n.substring(0,n.length-1))/100):n))*o.length/(this._scales[t-1].paddingInner()+1)+i};t5(e)&&(e=d(e)),t5(i)&&(i=d(i)),t5(r)&&(r=d(r))}return{bandSize:e,maxBandSize:i,minBandSize:r}}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(null==e?void 0:e.showAllGroupLayers)===(null==t?void 0:t.showAllGroupLayers)&&t1(null==e?void 0:e.layers,null==t?void 0:t.layers)||(i.reMake=!0),i}reInit(t){super.reInit(),null==this||this._updateData()}}g9.type=rA.cartesianBandAxis,g9.specKey="axes",g9.builtInTheme={axis:g4,axisBand:g5,axisX:g7,axisY:g6},cD(g9,gZ);let g8=()=>{ig.registerGraphicComponent($.lineAxis,(t,e)=>new g3.$(t,e)),ig.registerGraphicComponent(Y.lineAxisGrid,(t,e)=>new g2(t,e)),gH(),ig.registerComponent(g9.type,g9,!1)};function ft(t){let e=[];for(let i=0;i<t.length;i++){let r=t[i];0!==i&&r[0]===e[e.length-1]||e.push(r[0]),e.push(r[1])}return e}function fe(t,e,i){let r=t.indexOf(e),s=t.indexOf(i);r>=0&&s>=0&&r<s&&(t.splice(r,1),t.splice(s,0,e))}let fi=(t,e,i)=>i.reduce((t,r,s)=>(t.push([r,i.length===s+1?e:i[s+1]]),t),[[t,i[0]]]),fr=(t,e)=>t-e,fs=(t,e)=>{let i=[{count:0,sub:[],max:e[0],min:e[0]}],r=0,s=0;for(;r<e.length;)t[s]<=e[r]?(i[r].count+=1,i[r].sub.push(t[s]),s+=1):i[r+=1]={count:0,sub:[],max:e[r],min:e[r]};i.forEach(t=>{t.count&&(t.min=Math.min.apply(null,t.sub))});let n=t.slice(s);return i[r]={count:n.length,sub:n,min:e[e.length-1],max:Math.max.apply(null,n)},i},fn=Math.sqrt(50),fa=Math.sqrt(10),fl=Math.sqrt(2);class fo{constructor(){this._extend={},this.niceLabelFormatter=null}setExtraAttrFromSpec(){t5(this._spec.nice)&&(this._nice=this._spec.nice),t5(this._spec.zero)&&(this._zero=this._spec.zero),this._expand=this._spec.expand,this._domain=gl(this._spec)}transformScaleDomain(){this.setScaleNice()}setLinearScaleNice(){var t;if(!this._nice)return!1;let e=5,i=this._spec.tick||{};if(ee(i.forceTickCount))e=i.forceTickCount;else if(tK(i.tickCount)){let t=this._scale.range(),r=Math.abs(eh(t)-t[0]);1===r&&this._option&&(r=p$(this._orient)?this._option.getChartViewRect().width:this._option.getChartViewRect().height),e=i.tickCount({axisLength:r,labelStyle:this._spec.label&&this._spec.label.style})}else e=ee(i.tickCount)?i.tickCount:5;"accurateFirst"===this._spec.niceType&&(e=Math.max(5,e));let{min:r,max:s}=null!=(t=this._domain)?t:{};return et(r)&&et(s)&&et(this._softMaxValue)&&et(this._softMinValue)?this._scale.nice(e):(t5(r)||t5(this._softMinValue))&&et(s)&&et(this._softMaxValue)?this._scale.niceMax(e):!(!et(r)||!et(this._softMinValue)||!t5(s)&&!t5(this._softMaxValue))&&this._scale.niceMin(e)}setLogScaleNice(){var t;if(!this._nice)return!1;let{min:e,max:i}=null!=(t=this._domain)?t:{};return et(e)&&et(i)&&et(this._softMaxValue)&&et(this._softMinValue)?this._scale.nice():(t5(e)||t5(this._softMinValue))&&et(i)&&et(this._softMaxValue)?this._scale.niceMax():!(!et(e)||!et(this._softMinValue)||!t5(i)&&!t5(this._softMaxValue))&&this._scale.niceMin()}setScaleNice(){return"log"===this._spec.type?this.setLogScaleNice():this.setLinearScaleNice()}dataToPosition(t,e){return this.valueToPosition(t[0])}valueToPosition(t){return this._scale.scale(t)}computeLinearDomain(t){let e=[];if(t.length){let n=this._spec.breaks&&this._spec.breaks.length,a,l,o=[];if(t.forEach(t=>{let{min:e,max:i}=t;a=void 0===a?e:Math.min(a,e),l=void 0===l?i:Math.max(l,i),n&&(o=o.concat(t.values))}),n){let t=[],n=[],h=et(this._domain.max)?l:this._domain.max;for(let e=0;e<this._spec.breaks.length;e++){let{range:i}=this._spec.breaks[e];i[0]<=i[1]&&i[1]<=h&&(t.push(i),n.push(this._spec.breaks[e]))}if(t.sort((t,e)=>t[0]-e[0]),t.length){var i,r,s;let{domain:a,scope:l}=(i=o,r=ft(t),s=this._spec.breaks[0].scopeType,i.sort(fr),r.sort(fr),{domain:function(t,e){let i=t[0],r=t[t.length-1],s=e.filter(t=>t>i&&t<r);return 0===s.length?[[i,r]]:fi(i,r,s)}(i,r),scope:function(t,e,i="count"){let r=fs(t,e),s="count"===i?t.length:r.reduce((t,e,i)=>e.count>0?t+e.max-e.min:t,0),n=[],a=0,l=0;return r.forEach((t,e)=>{if(0===s)n.push([0,e/r.length-1]);else{let o="count"===i?t.count:t.max-t.min,h=n[l-1]?n[l-1][1]:0,u=e===r.length-1?1:Math.min((a+o)/s,1);(h!==u||0!==h&&1!==h)&&(l+=1,n.push([h,u]),a+=o)}}),n}(i,r,s)});e=ft(a),this._break={domain:a,scope:l,breakDomains:t,breaks:n}}else e=[a,l]}else e=[a,l]}else e[0]=0,e[1]=0;return this.setSoftDomainMinMax(e),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e}expandDomain(t){if(!this._expand)return;let e=t[0],i=eh(t);e===i&&(0===i?i=1:i>0?e=0:i<0&&(i=0)),t5(this._expand.min)&&(t[0]=e-(i-e)*this._expand.min),t5(this._expand.max)&&(t[t.length-1]=i+(i-e)*this._expand.max)}niceDomain(t){let{min:e,max:i}=gl(this._spec);if(t5(e)||t5(i)||"linear"!==this._spec.type)return t;if(1e-12>=Math.abs(ed(t)-eu(t))){let e=t[0],i=e>=0?1:-1;if((e=Math.abs(e))<1)t[0]=0,t[t.length-1]=1;else{let i=e/5,r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);i=(s>=fn?10:s>=fa?5:s>=fl?2:1)*Math.pow(10,r),t[0]=0,t[t.length-1]=10*i}i<0&&(t.reverse(),t[0]*=-1,t[t.length-1]*=-1)}return t}includeZero(t){this._zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(eh(t),0))}setExtendDomain(t,e){if(void 0===e)return void delete this._extend[t];this._extend[t]=e;let i=this._scale.domain();this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this._nice),this._nice&&(this.setScaleNice()||this._scale.rescale()),this.event.emit(rB.scaleUpdate,{model:this,value:"domain"})}extendDomain(t){let e,i=t.length-1,r=t[0]-t[i]>0,s=r?i:0,n=r?0:i;for(let i in this._extend)(e=this._extend[i])>t[n]&&(t[n]=e),e<t[s]&&(t[s]=e)}getDomainSpec(){return this._domain}setDomainMinMax(t){if(!this._domain)return;let{min:e,max:i}=this._domain;t5(e)&&(t[0]=e),t5(i)&&(t[t.length-1]=i)}setSoftDomainMinMax(t){let{softMin:e,softMax:i}=this._spec;if(t5(e)){let i=tK(e)?e(t):e;et(i)&&(i=t[0]),i<=t[0]&&(t[0]=i,this._softMinValue=i)}if(t5(i)){let e=tK(i)?i(t):i;et(e)&&(e=eh(t)),e>=eh(t)&&(t[t.length-1]=e),this._softMaxValue=e}}setZero(t){this._zero!==t&&(this._zero=t,this.updateScaleDomain())}updateScaleDomain(){if(!this.isSeriesDataEnable())return;let t=this.collectData(),e=this.computeLinearDomain(t);this.updateScaleDomainByModel(e)}updateScaleDomainByModel(t){t=null!=t?t:this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this._nice),this._nice&&(this.setScaleNice()||this._scale.rescale()),this._updateNiceLabelFormatter(t),this._domainAfterSpec=this._scale.domain(),this.event.emit(rB.scaleDomainUpdate,{model:this}),this.event.emit(rB.scaleUpdate,{model:this,value:"domain"})}getDomainAfterSpec(){return this._domainAfterSpec}_updateNiceLabelFormatter(t){let e=Math.pow(10,Math.max(-Math.floor(Math.log10(Math.abs(eh(t)-t[0]))),0)+2);this.niceLabelFormatter=t=>ee(+t)?Math.round(t*e)/e:t}}var fh=i(29685);let fu={domainLine:{visible:!1},grid:{visible:!0},subGrid:{visible:!1},tick:{visible:!1},subTick:{visible:!1}};class fd extends gG{constructor(){super(...arguments),this.type=rA.cartesianLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new a2}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.setExtraAttrFromSpec();let i=null==(e=null==(t=this._tickData)?void 0:t[0])?void 0:e.getDataView().transformsArr.find(t=>t.type===this.registerTicksTransform());i&&(i.options=this._tickTransformOption())}initScales(){var t,e;super.initScales();let i=[0,1];t5(null==(t=this._domain)?void 0:t.min)&&(i[0]=this._domain.min),t5(null==(e=this._domain)?void 0:e.max)&&(i[1]=this._domain.max),this._scale.domain(i)}_tickTransformOption(){var t;return Object.assign(Object.assign({},super._tickTransformOption()),{breakData:(null==(t=this._spec.breaks)?void 0:t.length)?()=>this._break:null})}_getUpdateAttribute(t){var e,i;let r=super._getUpdateAttribute(t);if(!pX(this._orient)&&(null==(i=null==(e=this._break)?void 0:e.breaks)?void 0:i.length)){let{width:t,height:e}=this.getLayoutRect(),i=p$(this._orient),s=i?t:e;r.breaks=this._break.breaks.map(t=>{let e,{range:r,breakSymbol:n,gap:a=6}=t,l=this.valueToPosition((r[0]+r[1])/2)/s;e=ev(a)?Number(a.substring(0,a.length-1))/100:a/s;let o=ee(null==n?void 0:n.angle)?n.angle:i?60:15;return{range:[l-e/2,l+e/2],breakSymbol:Object.assign(Object.assign({visible:!0},n),{angle:o*Math.PI/180}),rawRange:r}})}return r}getNewScaleRange(){var t,e;let i=super.getNewScaleRange();return(null==(t=this._spec.breaks)?void 0:t.length)&&(null==(e=this._break)?void 0:e.scope)&&(i=ft(this._break.scope).map(t=>i[0]+(eh(i)-i[0])*t)),i}computeDomain(t){return this.computeLinearDomain(t)}axisHelper(){let t=super.axisHelper();return t.setExtendDomain=this.setExtendDomain.bind(this),t.valueToPosition=this.valueToPosition.bind(this),t}registerTicksTransform(){let t=`${this.type}-ticks`;return sY(this._option.dataSet,t,fh.m),t}}fd.type=rA.cartesianLinearAxis,fd.specKey="axes",fd.builtInTheme={axis:g4,axisLinear:fu,axisX:g7,axisY:g6},cD(fd,fo);let fc=()=>{ig.registerGraphicComponent($.lineAxis,(t,e)=>new g3.$(t,e)),ig.registerGraphicComponent(Y.lineAxisGrid,(t,e)=>new g2(t,e)),gH(),ig.registerComponent(fd.type,fd)},fp=`${s6}_hide_`;function fg(t,e){t.context.finalAttrs&&(t.context.finalAttrs.visible=e)}let ff=(t,e)=>{if(!e||0===e.length)return e;let{direction:i,delta:r,deltaMul:s=1,groupBy:n}=t,a=e=>{e.forEach(t=>{t[fp]&&(fg(t,!0),t[fp]=!1)});let n=t.sort?e.slice().sort((t,e)=>t.context.finalAttrs.x-e.context.finalAttrs.x):e;0===i?function(t,e,i){let r=-1/0,s=0,n=0,a=et(e),l=e;t.forEach(t=>{if(!1===t.context.finalAttrs.visible)return;let e=t.context.finalAttrs.size/2,{x:n,y:o}=t.context.finalAttrs;a&&(l=(e+s)*i),(-1/0-n)**2+(r-o)**2<(l+s+e)**2?t.context.finalAttrs.forceShow||(t[fp]=!0,fg(t,!1)):r=o,s=e})}(n,r,s):1===i?function(t,e,i){let r=-1/0,s=0,n=et(e),a=e;t.forEach(t=>{if(!1===t.context.finalAttrs.visible)return;let e=t.context.finalAttrs.size/2,l=t.context.finalAttrs.x;n&&(a=(e+s)*i),Math.abs(l-r)<a+s+e?t.context.finalAttrs.forceShow||(t[fp]=!0,fg(t,!1)):r=l,s=e})}(n,r,s):function(t,e,i){let r=-1/0,s=0,n=et(e),a=e;t.forEach(t=>{if(!1===t.context.finalAttrs.visible)return;let e=t.context.finalAttrs.size/2,l=t.context.finalAttrs.y;n&&(a=(e+s)*i),Math.abs(l-r)<a+s+e?t.context.finalAttrs.forceShow||(t[fp]=!0,fg(t,!1)):r=l,s=e})}(n,r,s)};if(n){let t=e.reduce((t,e)=>{var i,r;let s=null==(r=null==(i=e.context.data)?void 0:i[0])?void 0:r[n];return t[s]?t[s].push(e):t[s]=[e],t},{});Object.keys(t).forEach(e=>{a(t[e])})}else a(e);return e},fm=()=>{ig.registerGrammarTransform("symbolOverlap",{transform:ff,runType:"afterEncode"})},fy={min:ed,max:eu,average:dL,sum:dR};function f_(t,e,i,r){let s=Math.floor(e.length/t),n=[],a=e.length,l,o,h,u=0,d=0;n[d++]=u;for(let t=1;t<a-1;t+=s){let i=Math.min(t+s,a-1),c=Math.min(t+2*s,a),p=(c+i)/2,g=0;for(let t=i;t<c;t++){let i=e[t][r];Number.isNaN(i)||(g+=i)}g/=c-i;let f=t,m=Math.min(t+s,a),y=t-1,_=e[u][r];l=-1,h=f;for(let t=f;t<m;t++){let i=e[t][r];Number.isNaN(r)||(o=Math.abs((y-p)*(i-_)-(y-t)*(g-_)))>l&&(l=o,h=t)}n[d++]=h,u=h}return n[d-1]!==a-1&&(n[d++]=a-1),n.map(t=>i?e[t].i:t)}function fv(t,e,i,r,s){let n=Math.floor(e.length/t),a=[],l=e.length,o=0,h=[];a.push(o),e[o][s]=e[o][s];for(let t=1;t<l-1;t+=n){n>l-t&&(n=l-t,h.length=n),h=[];for(let i=0;i<n;i++)h.push(e[t+i][s]);let i=fy[r](h);e[o=Math.min(Math.round(t+h.length/2)||0,l-1)][s]=i,a.push(o)}return a.map(t=>i?e[t].i:t)}function fb(t,e,i,r){return fv(t,e,i,"min",r)}function fx(t,e,i,r){return fv(t,e,i,"max",r)}function fS(t,e,i,r){return fv(t,e,i,"average",r)}function fk(t,e,i,r){return fv(t,e,i,"sum",r)}let fA=(t,e)=>{let i=tK(t.size)?t.size():t.size,r=t.factor||1;if(Array.isArray(i)&&(i=Math.floor(i[1]-i[0])),(i*=r)<=0)return[];if(e.length<=i)return e;if(t.skipfirst)return e.slice(0,1);let{mode:s,yfield:n,groupBy:a}=t,l=null!=n?n:"y",o=f_;if("min"===s?o=fb:"max"===s?o=fx:"average"===s?o=fS:"sum"===s&&(o=fk),e.length){let t={};if(a){for(let i=0,r=e.length;i<r;i++){let r=e[i],s=r[a];t[s]||(t[s]=[]),t[s].push({[l]:r[l],i:i})}let r=[];return Object.keys(t).forEach(s=>{let n=t[s];if(n.length<=i){let t=n.map(t=>t.i);r=r.concat(t)}else{let t=o(i,n,!0,l);r=r.concat(t),n.forEach(t=>e[t.i][l]=t[l])}}),r.sort((t,e)=>t-e),r.map(t=>e[t])}return o(i,e,!1,l).map(t=>e[t])}return[]},fM=()=>{ig.registerGrammarTransform("dataSampling",{transform:fA})};class fw extends cB{constructor(){super(...arguments),this.type=rw.line,this.transformerConstructor=pz,this._sortDataByAxis=!1}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}initMark(){var t;let e=null!=(t=this._spec.seriesMark)?t:"line";this.initLineMark("line"===e),this.initSymbolMark("point"===e)}initTooltip(){super.initTooltip();let{group:t,mark:e}=this._tooltipHelper.activeTriggerSet;this._lineMark&&t.add(this._lineMark),this._symbolMark&&(e.add(this._symbolMark),t.add(this._symbolMark))}initMarkStyle(){this.initLineMarkStyle(this._direction),this.initSymbolMarkStyle()}initAnimation(){var t,e,i,r;let s={direction:this.direction},n=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;if(this._lineMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("line"))?void 0:i(s,n),cb("line",this._spec,this._markAttributeContext))),this._symbolMark){let t=cE(this);this._symbolMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("scaleInOut"))?void 0:r(),cb("point",this._spec,this._markAttributeContext),t))}}onLayoutEnd(){super.onLayoutEnd(),this.reCompileSampling()}getSeriesStyle(t){var e;let i="point"!==(null==(e=this._spec)?void 0:e.seriesMark);return e=>{var r,s;return i&&"fill"===e&&(e="stroke"),null!=(s=null==(r=this._seriesMark)?void 0:r.getAttribute(e,t))?s:void 0}}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._lineMark,this._symbolMark]}}fw.type=rw.line,fw.mark=cF,fw.builtInTheme={line:{label:{visible:!1,position:"top",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}}},fw.transformerConstructor=pz,cD(fw,cL);let fT=()=>{fM(),fm(),pI(),pF(),u2(),uQ(),g8(),fc(),ig.registerSeries(fw.type,fw)},fC=(t,e)=>{var i;let{regionId:r,regionIndex:s}=t.spec;if(t5(r)){let t=eo(r);return null==(i=e.region)?void 0:i.filter(({spec:e})=>t.includes(e.id))}if(t5(s))return eo(s).map(t=>{var i;return null==(i=e.region)?void 0:i[t]}).filter(t5)},fE=(t,e)=>{var i;let{seriesId:r,seriesIndex:s}=t.spec;if(t5(r)){let t=eo(r);return null==(i=e.series)?void 0:i.filter(({spec:e})=>t.includes(e.id))}if(t5(s))return eo(s).map(t=>{var i;return null==(i=e.series)?void 0:i[t]}).filter(t5)};class fB{constructor(t){this._option=t,this.type=t.type,this.seriesType=t.seriesType}initChartSpec(t){return this.transformSpec(t),this.transformModelSpec(t)}transformSpec(t){t.region&&0!==t.region.length||(t.region=[{}]),void 0===t.tooltip&&(t.tooltip={}),t5(t.stackInverse)&&t.region.forEach(e=>{t5(e.stackInverse)||(e.stackInverse=t.stackInverse)}),t5(t.stackSort)&&t.region.forEach(e=>{t5(e.stackSort)||(e.stackSort=t.stackSort)})}generateTransform(t,e){return(i,r,s)=>{let{spec:n,specPath:a,specInfoPath:l,type:o}=r,h=new i.transformerConstructor(Object.assign(Object.assign({},this._option),{type:o})),u=h.transformSpec(n,t,s),d=Object.assign(Object.assign({},r),u);e?d.theme=h.getTheme(n,t):nY(t,a,u.spec),nY(s,null!=l?l:a,d)}}transformModelSpec(t){return this.createSpecInfo(t,this.generateTransform(t,!1))}createSpecInfo(t,e){var i,r;e||(e=this.generateTransform(t,!0));let s={};return this.forEachRegionInSpec(t,e,s),this.forEachSeriesInSpec(t,e,s),null==(i=s.series)||i.forEach((t,e)=>{var i,r;let n=(null!=(r=null!=(i=fC(t,s))?i:s.region)?r:[])[0];n&&(n.seriesIndexes||(n.seriesIndexes=[]),n.seriesIndexes.push(e),t.regionIndexes=n.regionIndexes.slice())}),this.forEachComponentInSpec(t,e,s),Object.values(null!=(r=s.component)?r:{}).forEach(t=>t.forEach((t,e)=>{var i,r,n;if(t){if(!t.regionIndexes){let e=null!=(r=null!=(i=fC(t,s))?i:s.region)?r:[];t.regionIndexes=e.map(t=>t.regionIndexes[0])}if(!t.seriesIndexes){let e=fE(t,s);if(e)t.seriesIndexes=e.map(({seriesIndexes:t})=>t[0]);else{let e=new Set;(null!=(n=t.regionIndexes)?n:[]).forEach(t=>{var i,r;let n=null==(i=s.region)?void 0:i[t];null==(r=null==n?void 0:n.seriesIndexes)||r.forEach(t=>e.add(t))}),t.seriesIndexes=Array.from(e)}}}})),s}_isValidSeries(t){return!0}_getDefaultSeriesSpec(t,e,i){var r,s,n,a,l;let o={dataKey:t.dataKey,hover:t.hover,select:t.select,label:t.label,seriesStyle:t.seriesStyle,animation:null!=(r=t.animation)?r:null==(s=this._option.globalInstance)?void 0:s.isAnimationEnable(),animationThreshold:null!=(n=t.animationThreshold)?n:null==(l=(a=this._option).getTheme)?void 0:l.call(a,"animationThreshold"),animationAppear:t.animationAppear,animationDisappear:t.animationDisappear,animationEnter:t.animationEnter,animationUpdate:t.animationUpdate,animationExit:t.animationExit,animationNormal:t.animationNormal,animationState:t.animationState,extensionMark:t.extensionMark,large:t.large,largeThreshold:t.largeThreshold,progressiveStep:t.progressiveStep,progressiveThreshold:t.progressiveThreshold,background:t.seriesBackground,invalidType:t.invalidType,seriesField:t.seriesField,morph:t.morph,interactions:t.interactions},h=this.seriesType;return h&&(o.type=h,o[h]=t[h]),e&&e.length&&e.forEach(e=>{o[e]=t[e]}),i&&i.length&&i.forEach(e=>{o[e]=t[e]}),o}forEachRegionInSpec(t,e,i){var r;return(null!=(r=t.region)?r:[]).map((t,r)=>e(ig.getRegionInType("region"),{spec:t,specPath:["region",r],type:"region",regionIndexes:[r]},i))}forEachSeriesInSpec(t,e,i){var r;return(null!=(r=t.series)?r:[]).map((t,r)=>e(ig.getSeriesInType(t.type),{spec:t,specPath:["series",r],type:t.type,seriesIndexes:[r]},i))}forEachComponentInSpec(t,e,i){var r,s,n;let a,l,o,h,u=[],d=ig.getComponents(),c=[];for(let e=0;e<d.length;e++){let{cmp:i,alwaysCheck:s}=d[e];i.type.startsWith(rA.cartesianAxis)?a=i:i.type.startsWith(rA.polarAxis)?l=i:i.type===rA.geoCoordinate?o=i:(s||t[null!=(r=i.specKey)?r:i.type])&&(i.type===rA.tooltip?h=i:c.push(d[e]))}let p=!1;if(a){let r=a.getSpecInfo(t,i);(null==r?void 0:r.length)>0&&(p=!0,r.forEach(t=>{let r=ig.getComponentInKey(t.type);u.push(e(r,t,i))}))}if(l&&!p){let r=l.getSpecInfo(t,i);(null==r?void 0:r.length)>0&&(p=!0,r.forEach(t=>{let r=ig.getComponentInKey(t.type);u.push(e(r,t,i))}))}return o&&!p&&(null==(s=o.getSpecInfo(t,i))||s.forEach(t=>{u.push(e(o,t,i))})),c.sort((t,e)=>t.createOrder-e.createOrder),c.forEach(({cmp:r})=>{var s;null==(s=r.getSpecInfo?r.getSpecInfo(t,i):d0(t,r.specKey,r.type))||s.forEach(t=>{u.push(e(r,t,i))})}),h&&(null==(n=d0(t,h.specKey,h.type))||n.forEach(t=>{u.push(e(h,t,i))})),u}transformSeriesSpec(t){let e=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}):t.series=[e]}_findBandAxisBySeries(t,e,i){let r="horizontal"===(null==t?void 0:t.direction)?["left","right"]:["top","bottom"];return i.find(i=>!!r.includes(i.orient)&&(t5(i.seriesId)?eo(i.seriesId).includes(null==t?void 0:t.id):t5(i.seriesIndex)?eo(i.seriesIndex).includes(e):i.type,!0))}_applyAxisBandSize(t,e,i){let{barMaxWidth:r,barMinWidth:s,barWidth:n,barGapInGroup:a}=i,l=!1;tH(s)?(t.minBandSize=s,l=!0):tH(n)?(t.minBandSize=n,l=!0):tH(r)&&(t.minBandSize=r,l=!0),l&&(t.bandSizeLevel=Number.MAX_VALUE,t.bandSizeExtend={extend:e,gap:tY(a)?a[a.length-1]:a})}}class fP extends fB{needAxes(){return!0}_isValidSeries(t){return!this.seriesType||t===this.seriesType}_getDefaultSeriesSpec(t,e){return super._getDefaultSeriesSpec(t,["xField","yField","zField","direction","stack","percent","stackOffsetSilhouette","totalLabel","sortDataByAxis"],e)}transformSpec(t){super.transformSpec(t),super.transformSeriesSpec(t),this._transformAxisSpec(t)}_setDefaultXAxisSpec(t){return{orient:"bottom"}}_setDefaultYAxisSpec(t){return{orient:"left"}}_setDefaultZAxisSpec(t){return{orient:"z"}}_transformAxisSpec(t){if(this.needAxes()){t.axes||(t.axes=[]);let e={x:!1,y:!1,z:!1};t.axes.forEach(i=>{let{orient:r}=i,s=null;"top"!==r&&"bottom"!==r||(e.x=!0,s=this._setDefaultXAxisSpec(t)),"left"!==r&&"right"!==r||(e.y=!0,s=this._setDefaultYAxisSpec(t)),"z"===r&&(e.z=!0,s=this._setDefaultZAxisSpec(t)),s&&Object.keys(s).forEach(t=>{et(i[t])&&(i[t]=s[t])}),iF(i,"trimPadding")&&it(i,nH(this.type,t))}),e.x||t.axes.push(this._setDefaultXAxisSpec(t)),e.y||t.axes.push(this._setDefaultYAxisSpec(t)),t.zField&&!e.z&&t.axes.push(this._setDefaultZAxisSpec(t))}}}class fO extends fP{_getDefaultSeriesSpec(t){var e;let i=super._getDefaultSeriesSpec(t,["point","line","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","lineLabel"]);return i.seriesMark=null!=(e=t.seriesMark)?e:"line",i}transformSpec(t){super.transformSpec(t),nF(t)}}class fI{get dataList(){return this._dataArr}constructor(t){this._dataArr=[],this._dataSet=t}parseData(t){this._dataArr=[];let e=eo(t);for(let t=0;t<e.length;t++)this._dataArr.push(s2(e[t],this._dataSet,this._dataArr))}updateData(t,e=!1,i=!0){let r=eo(t);return(!e||r.length===this._dataArr.length)&&(this._dataValueForEach(r,(t,e)=>{e.markRunning()}),this._dataValueForEach(r,(t,e)=>{s3(e,t,i)}),!0)}_dataValueForEach(t,e){t.forEach((t,i)=>{if(t instanceof er)return;let r=this.getSeriesData(t.id,i);r&&e(t,r,i)})}getSeriesData(t,e){if(!this._dataArr.length)return null;if("string"==typeof t){let e=this._dataArr.filter(e=>e.name===t);if(e[0])return e[0];eI(`no data matches dataId ${t}!`)}if("number"==typeof e){if(this._dataArr[e])return this._dataArr[e];eI(`no data matches dataIndex ${e}!`)}return this._dataArr[0]}}class fR{constructor(t,e){this._scaleSpecMap=new Map,this._scaleMap=new Map,this._modelScaleSpecMap=new Map,this._markAttributeScaleMap=new Map,this._spec=null,this._chart=null,this.getStatisticalFields=t=>{let e=[];return this._scaleSpecMap.forEach((i,r)=>{em(i.domain)&&i.domain.forEach(r=>{r.dataId===t&&r.fields.forEach(t=>{dH(e,[{key:t,operations:ai(i.type)?["max","min"]:["values"]}])})})}),this._markAttributeScaleMap.forEach((i,r)=>{let s=this.getScale(r);i.forEach(i=>{this._getSeriesBySeriesId(i.seriesId).getRawData().name===t&&i.field&&dH(e,[{key:i.field,operations:ai(s.type)?["max","min"]:["values"]}])})}),e},this._spec=t,this._chart=e,this._setAttrFromSpec()}_createFromSpec(t){if(!t.id)return null;let e=this._scaleMap.get(t.id);return e||(e="ordinal"===t.type&&"color"===t.id?li("colorOrdinal"):li(t.type)),e?(tY(t.range)&&e.range(t.range),tY(t.domain)&&(em(t.domain)||e.domain(t.domain)),t.specified&&e.specified&&e.specified(t.specified),t.clamp&&e.clamp&&e.clamp(t.clamp),e):null}_setAttrFromSpec(){var t;if(!(null==(t=this._spec)?void 0:t.length))return;let e=new Map,i=new Map;this._spec.forEach(t=>{let r=this._createFromSpec(t);r&&(e.set(t.id,r),i.set(t.id,t))}),this._modelScaleSpecMap.forEach(t=>{let r=this._createFromSpec(t);r&&(e.set(t.id,r),i.set(t.id,t))}),this._scaleSpecMap=i,this._scaleMap=e}updateSpec(t){let e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(t1(t,this._spec))return e;e.change=!0;for(let i=0;i<t.length;i++){let r=t[i],s=this._scaleMap.get(r.id);if(!s)return e.reMake=!0,e;let n=this._spec.find(t=>t.id===r.id);if(!n.id||n.type!==r.type||!t1(n.specified,r.specified))return e.reMake=!0,e;r.range&&!t1(r.range,s.range())&&(s.range(r.range),e.reRender=!0),em(r.domain)?e.reRender=!0:t1(r.domain,s.domain())||(s.domain(r.domain),e.reRender=!0),this._scaleSpecMap.set(r.id,r)}return this._spec=t,e}registerModelScale(t){let e=this._createFromSpec(t);e&&(this._modelScaleSpecMap.set(t.id,t),this._scaleSpecMap.set(t.id,t),this._scaleMap.set(t.id,e))}removeModelScale(t){this._modelScaleSpecMap.forEach(e=>{t(e)&&(this._modelScaleSpecMap.delete(e.id),this._scaleSpecMap.delete(e.id),this._scaleMap.delete(e.id))})}getScale(t){return this._scaleMap.get(t)}getScaleSpec(t){return this._scaleSpecMap.get(t)}_getSeriesByRawDataId(t){let e=this._chart.getAllSeries();for(let i=0;i<e.length;i++){let r=e[i];if(r.getRawData().name===t)return r}return null}_getSeriesBySeriesId(t){let e=this._chart.getAllSeries();for(let i=0;i<e.length;i++){let r=e[i];if(r.id===t)return r}return null}updateScaleDomain(t){this._scaleSpecMap.forEach((e,i)=>{let r,s=this._scaleMap.get(i);if(!s)return;if(!em(e.domain))return e.domain&&0!==e.domain.length||s.domain(t),void this._updateMarkScale(i,s,s.domain().slice());r=ai(e.type)?[null,null]:new Set,e.domain.forEach(t=>{let i=this._getSeriesByRawDataId(t.dataId);if(!i)return;let s=ai(e.type);t.fields.forEach(t=>{let e=i.getRawDataStatisticsByField(t,s);e&&(s?(et(r[0])?r[0]=e.min:r[0]=Math.min(e.min,r[0]),et(r[1])?r[1]=e.max:r[1]=Math.max(e.max,r[1])):e.values.forEach(t=>{r.add(t)}))})});let n=r;ai(e.type)||(r=Array.from(r)),s.domain(r),this._updateMarkScale(i,s,n)})}_updateMarkScale(t,e,i){let r=this._markAttributeScaleMap.get(t);r&&0!==r.length&&r.forEach(t=>{if(!t.field||!t.markScale||t.markScale===e)return;if(et(t.changeDomain)||"none"===t.changeDomain||et(t.seriesId))return void(ai(e.type)?t.markScale.domain(i):e.domain(Array.from(i)));let r=this._getSeriesBySeriesId(t.seriesId),s=ai(e.type),n=r.getRawDataStatisticsByField(t.field,s);if(!nR(n))return"expand"===t.changeDomain?(s?(i[0]=Math.min(i[0],n.min),i[1]=Math.max(i[1],n.max)):(n.values.forEach(t=>{i.add(t)}),i=Array.from(i)),void t.markScale.domain(i)):void("replace"!==t.changeDomain||(s?t.markScale.domain([n.min,n.max]):t.markScale.domain(n.values)));ai(e.type)?t.markScale.domain(i):e.domain(Array.from(i))})}registerMarkAttributeScale(t,e){let i=this._scaleMap.get(t.scale),r=this._markAttributeScaleMap.get(t.scale);r||(r=[],this._markAttributeScaleMap.set(t.scale,r));let s=i;return!et(t.field)&&(et(t.changeDomain)||"none"===t.changeDomain||et(e))||(s=i.clone()),r.push(Object.assign(Object.assign({},t),{seriesId:e,markScale:s})),s}}class fL{constructor(){this._stateGraphicsByTrigger=new Map,this._disableTriggerEvent=!1,this._triggerMapByState=new Map}setDisableActiveEffect(t){this._disableTriggerEvent=t}addTrigger(t){t&&[t.getStartState(),t.getResetState()].forEach(e=>{if(e){let i=this._triggerMapByState.get(e);i?i.includes(t)||i.push(t):this._triggerMapByState.set(e,[t])}})}setStatedGraphics(t,e){this._stateGraphicsByTrigger.set(t,e)}getStatedGraphics(t){return this._stateGraphicsByTrigger.get(t)}updateStates(t,e,i,r,s){return this._disableTriggerEvent?[]:e&&e.length?(r&&s?i&&i.length?(this.toggleReverseStateOfGraphics(t,e,i,s),this.toggleStateOfGraphics(t,e,i,r)):this.addBothStateOfGraphics(t,e,r,s):r&&(i&&i.length?this.toggleStateOfGraphics(t,e,i,r):this.addStateOfGraphics(t,e,r)),e):[]}toggleReverseStateOfGraphics(t,e,i,r){let s=t.getMarkIdByState();i.forEach(t=>{var e;if(r&&s[r]&&s[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,s=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(r,!0,s)}}),e.forEach(t=>{var e;if(r&&s[r]&&s[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,s=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(r,s)}})}toggleStateOfGraphics(t,e,i,r){let s=t.getMarkIdByState();i.forEach(t=>{var e;if(r&&s[r]&&s[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,s=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(r,s)}}),e.forEach(t=>{var e;if(r&&s[r]&&s[r].includes(t.context.markId)){let i=null==(e=t.parent)?void 0:e.mark,s=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(r,!0,s)}})}addBothStateOfGraphics(t,e,i,r){let s=t.getMarks(),n=t.getMarkIdByState();s.forEach(t=>{var s;let a=r&&n[r]&&n[r].includes(t.id),l=i&&n[i]&&n[i].includes(t.id);if(!a&&!l)return;let o=t.hasAnimationByState&&t.hasAnimationByState("state");null==(s=t.getGraphics())||s.forEach(t=>{e&&e.includes(t)?l&&t.addState(i,!0,o):a&&t.addState(r,!0,o)})})}addStateOfGraphics(t,e,i){let r=t.getMarks(),s=t.getMarkIdByState();r.forEach(t=>{var r;let n=i&&s[i]&&s[i].includes(t.id);if(!n)return;let a=t.hasAnimationByState&&t.hasAnimationByState("state");null==(r=t.getGraphics())||r.forEach(t=>{e&&e.includes(t)&&n&&t.addState(i,!0,a)})})}clearAllStatesOfTrigger(t,e,i){if(this._disableTriggerEvent)return;let r=this.getStatedGraphics(t);if(!r||!r.length)return;let s=t.getMarks(),n=t.getMarkIdByState();s.forEach(t=>{if(t){let s=t.getGraphics(),a=t.hasAnimationByState&&t.hasAnimationByState("state");s&&s.length&&(i&&n[i]&&n[i].includes(t.id)&&s.forEach(t=>{t.removeState(i,a)}),e&&n[e]&&n[e].includes(t.id)&&s.forEach(t=>{r.includes(t)&&t.removeState(e,a)}))}})}clearAllStates(){this._disableTriggerEvent||this._triggerMapByState.forEach((t,e)=>{t.forEach(t=>{this.clearAllStatesOfTrigger(t,e,t.getResetState())})})}clearByState(t){if(this._disableTriggerEvent)return;let e=this._triggerMapByState.get(t);e&&e.length&&e.forEach(e=>{this.clearAllStatesOfTrigger(e,t,e.getResetState()),this.setStatedGraphics(e,[])})}updateStateOfGraphics(t,e){if(this._disableTriggerEvent)return;let i=this._triggerMapByState.get(t);i&&i.length&&i.forEach(t=>{let i=e.filter(e=>t.getMarks().some(t=>{let i=t&&t.getGraphics();return i&&i.includes(e)}));this.updateStates(t,i,this.getStatedGraphics(t),t.getStartState(),t.getResetState()),this.setStatedGraphics(t,i)})}}var fD=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class fF extends nG{getSpec(){return this._spec}setSpec(t){this._spec=t}getOption(){return this._option}getLayoutRect(){return this._layoutRect}getViewRect(){return this._viewRect}getLayoutTag(){return this._layoutTag}setLayoutTag(t,e,i=!0){this._layoutTag=t;let r=this.getCompiler();return r&&(r.updateLayoutTag(),t&&i&&r.renderNextTick(e)),this._layoutTag}resetLayoutItemTag(){this.getLayoutElements().forEach(t=>t.setWillLayoutTag())}getModelOption(){return this._modelOption}getGlobalScale(){return this._globalScale}getEvent(){return this._event}get chartData(){return this._chartData}_setModelOption(){}constructor(t,e){var i,r,s;super(e),this.type="chart",this.id=eg(),this._regions=[],this._series=[],this._components=[],this._layoutRect={x:0,y:0,width:s9,height:s8},this._viewRect={width:s9,height:s8},this._viewBox={x1:0,y1:0,x2:s9,y2:s8},this._layoutTag=!0,this._idMap=new Map,this.state={layoutUpdateRank:1},this.padding={top:0,left:0,right:0,bottom:0},this.getAllSeries=()=>{var t;return null!=(t=this._series)?t:[]},this.getRegionsInIndex=t=>t&&0!==t.length?this._regions.filter((e,i)=>t.includes(i)):[this._regions[0]],this.getAllRegions=()=>this._regions,this.getRegionsInIds=t=>t?this._regions.filter(e=>t.includes(e.id)):[],this.getRegionsInQuerier=t=>t?this._regions.filter((e,i)=>eo(t).some(t=>t5(t.regionId)&&t.regionId===e.userId||t.regionIndex===i)):this._regions,this.getRegionsInUserId=t=>{if(t)return this._regions.find(e=>e.userId===t)},this.getRegionsInUserIdOrIndex=(t,e)=>this.getAllRegions().filter(i=>(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())),this.getComponents=()=>this._components,this.getSeriesInIndex=t=>t&&0!==t.length?this._series.filter((e,i)=>t.includes(i)):[this._series[0]],this.getSeriesInIds=t=>t?this._series.filter(e=>t.includes(e.id)):[],this.getSeriesInUserId=t=>{if(t)return this._series.find(e=>e.userId===t)},this.getSeriesInUserIdOrIndex=(t,e)=>this.getAllSeries().filter(i=>(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())),this.getComponentByIndex=(t,e)=>{let i=this._components.filter(e=>(e.specKey||e.type)===t);if(i&&0!==i.length)return i[e]},this.getComponentsByKey=t=>this._components.filter(e=>(e.specKey||e.type)===t),this.getComponentByUserId=t=>{let e=this._components.find(e=>e.userId===t);if(e)return e},this.getComponentsByType=t=>this._components.filter(e=>e.type===t),this._paddingSpec=eA(null!=(i=t.padding)?i:e.getTheme("padding")),this._event=new iI(e.eventDispatcher,e.mode),this._dataSet=e.dataSet,this._chartData=new fI(this._dataSet),this._modelOption=Object.assign(Object.assign({},e),{mode:this._option.mode,map:this._idMap,getChartLayoutRect:()=>this._layoutRect,getChartViewRect:()=>this._viewRect,getChart:()=>this,globalScale:this._globalScale,onError:null==(r=this._option)?void 0:r.onError,disableTriggerEvent:!0===(null==(s=this._option)?void 0:s.disableTriggerEvent),getSeriesData:this._chartData.getSeriesData.bind(this._chartData)}),this._setModelOption&&this._setModelOption(),this._spec=t}created(t){this._chartData.parseData(this._spec.data),this._createGlobalScale(),this._createBackground(),this._createLayout(),t.forEachRegionInSpec(this._spec,this._createRegion.bind(this)),t.forEachSeriesInSpec(this._spec,this._createSeries.bind(this)),t.forEachComponentInSpec(this._spec,this._createComponent.bind(this),this._option.getSpecInfo())}_initInteractions(){if(this._option.disableTriggerEvent)return;this._interaction=new fL;let t=this.getAllSeries(),e=[],i={};t.forEach(t=>{let r=t.getInteractionTriggers();if(r&&r.length){let s=t.getRegion().id;r.forEach(({trigger:t,marks:r})=>{let n=`${s}-${t.type}`;i[n]?r.forEach(t=>{i[n].marks.push(t)}):(i[n]=Object.assign(Object.assign({},t),{marks:r}),e.push(i[n]))})}}),e.forEach(t=>{let e=ig.createInteractionTrigger(t.type,Object.assign(Object.assign({},t),{event:this._event,interaction:this._interaction}));e&&(e.init(),this._interaction.addTrigger(e))})}init(){var t,e;null==(t=this._beforeInit)||t.call(this),this._regions.forEach(t=>t.init({})),this._series.forEach(t=>t.init({})),this._components.forEach(t=>t.init({dataSet:this._dataSet})),this._initEvent(),null==(e=this._initStack)||e.call(this),this.reDataFlow(),this._initInteractions()}reDataFlow(){this._series.forEach(t=>{var e;return null==(e=t.getRawData())?void 0:e.markRunning()}),this._series.forEach(t=>t.fillData()),this.updateGlobalScaleDomain()}onResize(t,e,i=!0){this._canvasRect={width:t,height:e},this._updateLayoutRect(this._option.viewBox),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,i)}updateViewBox(t,e){this._option.viewBox=t,this._updateLayoutRect(t),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,e)}_createBackground(){let t=this._spec.background;if(!t||"object"!=typeof t||t5(t.gradient))return;let e=gI(t,["x","y","width","height","x1","y1","image"]);e.background=t.image,this._backgroundMark=ig.createMark("group","chart-background",{model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._globalScale}),this._backgroundMark.created(),this._backgroundMark.setStyle(Object.assign(Object.assign({},e),{x:()=>this._viewBox.x1,y:()=>this._viewBox.y1,width:()=>this._viewBox.x2-this._viewBox.x1,height:()=>this._viewBox.y2-this._viewBox.y1})),this._backgroundMark.setMarkConfig({zIndex:z.SeriesGroup-2}),this.getCompiler().addRootMark(this._backgroundMark)}_createRegion(t,e){if(!t)return;let{spec:i}=e,r=fD(e,["spec"]),s=new t(i,Object.assign(Object.assign({},this._modelOption),r));s&&(s.created(),this._regions.push(s))}_createSeries(t,e){let i;if(!t)return;let{spec:r}=e,s=fD(e,["spec"]);if(t5(r.regionId)?i=this.getRegionsInUserId(r.regionId):t5(r.regionIndex)&&(i=this.getRegionsInIndex([r.regionIndex])[0]),!i&&!(i=this._regions[0]))return;let n=new t(r,Object.assign(Object.assign(Object.assign({},this._modelOption),s),{type:r.type,region:i,globalScale:this._globalScale,sourceDataList:this._chartData.dataList}));n&&(n.created(),this._series.push(n),i.addSeries(n))}getSeriesById(t){return this._series.find(e=>e.id===t)}_createComponent(t,e){let i=t.createComponent(e,Object.assign(Object.assign({},this._modelOption),{type:t.type,getAllRegions:this.getAllRegions,getRegionsInIndex:this.getRegionsInIndex,getRegionsInIds:this.getRegionsInIds,getRegionsInUserIdOrIndex:this.getRegionsInUserIdOrIndex,getAllSeries:this.getAllSeries,getSeriesInIndex:this.getSeriesInIndex,getSeriesInIds:this.getSeriesInIds,getSeriesInUserIdOrIndex:this.getSeriesInUserIdOrIndex,getAllComponents:this.getComponents,getComponentByIndex:this.getComponentByIndex,getComponentByUserId:this.getComponentByUserId,getComponentsByKey:this.getComponentsByKey,getComponentsByType:this.getComponentsByType}));i&&(i.created(),this._components.push(i))}getAllComponents(){return this._components}getAllModels(){return[].concat(this.getAllSeries(),this.getAllComponents(),this.getAllRegions())}getModelInFilter(t){if(t3(t))return this.getAllModels().find(e=>e.userId===t);if(tK(t))return this.getAllModels().find(e=>t(e));let e=0;return this.getAllModels().find(i=>{var r;if((null!=(r=i.specKey)?r:i.type)===t.type){if(e===t.index)return!0;e++}return!1})}_createLayout(){this._updateLayoutRect(this._option.viewBox),this._initLayoutFunc()}setLayout(t){this._option.layout=t,this._initLayoutFunc()}_initLayoutFunc(){var t,e,i;if(this._layoutFunc=this._option.layout,!this._layoutFunc){let r=ig.getLayoutInKey(null!=(e=null==(t=this._spec.layout)?void 0:t.type)?e:"base");if(r){let t=new r(this._spec.layout,{onError:null==(i=this._option)?void 0:i.onError});this._layoutFunc=t.layoutItems.bind(t)}}}layout(){var t,e,i,r;if(null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeLayoutWithSceneGraph)||e.call(t,this._option.globalInstance),this.getLayoutTag()){this._event.emit(rB.layoutStart,{chart:this,vchart:this._option.globalInstance}),this.onLayoutStart();let t=this.getLayoutElements();this._layoutFunc(this,t,this._layoutRect,this._viewBox),this._event.emit(rB.afterLayout,{elements:t,chart:this}),this.setLayoutTag(!1),this.onLayoutEnd(),this._event.emit(rB.layoutEnd,{chart:this,vchart:this._option.globalInstance})}null==(r=null==(i=this._option.performanceHook)?void 0:i.afterLayoutWithSceneGraph)||r.call(i,this._option.globalInstance)}onLayoutStart(){this.getAllModels().forEach(t=>t.onLayoutStart(this._layoutRect,this._viewRect))}onLayoutEnd(){this.getAllModels().forEach(t=>{"series"!==t.modelType&&t.onLayoutEnd()})}onEvaluateEnd(t){[...this._components,...this._regions,...this._series].forEach(e=>e.onEvaluateEnd(t))}onBeforeRender(){[...this._components,...this._regions,...this._series].forEach(t=>t.onBeforeRender())}getLayoutElements(){return this.getAllModels().map(t=>t.layout).filter(t=>!!t)}getModelById(t){let e=this._idMap.get(t);if(e&&e instanceof nq)return e}getModelByUserId(t){let e=this.getSeriesInUserId(t);if(e)return e;let i=this.getRegionsInUserId(t);return i||this.getComponentByUserId(t)||void 0}getAllMarks(){return Array.from(this._idMap.values()).filter(t=>t&&t instanceof oa)}getMarkById(t){let e=this._idMap.get(t);if(e&&e instanceof oa)return e}getMarkByUserName(t){return this.getAllMarks().filter(e=>e.name&&e.name===t)}updateData(t,e,i=!0,r){let s=this._dataSet.getDataView(t);s&&(s.markRunning(),s.parseNewData(e,r)),i&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(t=>t.onDataUpdate())}updateFullData(t,e=!0){eo(t).forEach(t=>{let e=this._dataSet.getDataView(t.id);e&&e.markRunning()}),eo(t).forEach(t=>{let e=this._dataSet.getDataView(t.id);e&&s3(e,t,!0)}),e&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(t=>t.onDataUpdate())}setCanvasRect(t,e){this._canvasRect={width:t,height:e}}getCanvasRect(){return this._canvasRect||(this._canvasRect=nz(this._spec,this._option,{width:s9,height:s8})),this._canvasRect}getSeriesData(t,e){return this._chartData.getSeriesData(t,e)}_transformSpecScale(){var t;let e=this._spec.scales?[...this._spec.scales]:[],i=e.find(t=>"color"===t.id),r=this.getColorScheme();if(!i&&(i={type:"ordinal",id:"color",domain:null,range:null},e.push(i),this._spec.color)){let t=this._spec.color;tY(t)?i.range=t:(Object.prototype.hasOwnProperty.call(t,"type")&&(i.type=t.type),Object.prototype.hasOwnProperty.call(t,"domain")&&(i.domain=t.domain),Object.prototype.hasOwnProperty.call(t,"range")&&(i.range=t.range),Object.prototype.hasOwnProperty.call(t,"specified")&&(i.specified=t.specified),Object.prototype.hasOwnProperty.call(t,"clamp")&&(i.clamp=t.clamp))}return(null==(t=i.range)?void 0:t.length)||(i.range=e2(r),i.rangeTheme=!0),e}_createGlobalScale(){this._globalScale=new fR(this._transformSpecScale(),this),this._modelOption.globalScale=this._globalScale}updateGlobalScaleDomain(){let t=new Set;this._series.forEach(e=>{let i=e.getSeriesKeys();i&&i.forEach(e=>t.add(e))});let e=Array.from(t);this._globalScale.updateScaleDomain(e)}updateGlobalScale(t){nj(t,this._globalScale.updateSpec(this._transformSpecScale()))}updateGlobalScaleTheme(){let t=this._globalScale.getScaleSpec("color"),e=this.getColorScheme();t.rangeTheme&&(t.range=e2(e),this._globalScale.getScale("color").range(t.range))}_getSpecKeys(t){let e={width:!0,height:!0};return Object.keys(t).filter(t=>!e[t]).sort()}updateSpec(t){let e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(this.setLayoutTag(!0,null,!1),t.type!==this.type)return e.reMake=!0,e;let i=this._getSpecKeys(this._spec);if(!t1(i,this._getSpecKeys(t)))return e.reMake=!0,e;for(let r=0;r<i.length;r++){let s=i[r];if(tY(this._spec[s])&&this._spec[s].length!==eo(t[s]).length)return e.reMake=!0,e}let r=this._spec;return this._spec=t,this.updateChartConfig(e,r),e.reMake||(this.updateGlobalScale(e),e.reMake||(this.updateRegionSpec(e),e.reMake||(this.updateComponentSpec(e),e.reMake||(this.updateSeriesSpec(e),e.reMake||(this.reInit(),this.updateDataSpec(),this.updateGlobalScaleDomain()))))),e}updateChartConfig(t,e){var i,r;this._paddingSpec=eA(null!=(i=this._spec.padding)?i:null==(r=this._option)?void 0:r.getTheme("padding")),this._updateLayoutRect(this._viewBox)}updateDataSpec(){this._spec.data&&this._chartData.updateData(this._spec.data,!1,!0)}updateRegionSpec(t){var e;(null==(e=this._spec)?void 0:e.region)&&(this._spec.region.length===this._regions.length?this._regions.forEach(e=>{nj(t,e.updateSpec(this._spec.region[e.getSpecIndex()]))}):t.reMake=!0)}updateComponentSpec(t){let e={},i={[rA.title]:!0,[rA.brush]:!0,[rA.indicator]:!0};for(let r in this._components.forEach(r=>{var s,n;if(r.type===rA.label||r.type===rA.totalLabel)return;i[r.type]&&(i[r.type]=!1);let a=r.specKey||r.type,l=null!=(s=this._spec[a])?s:{};tY(l)?(e[a]=e[a]||{specCount:l.length,componentCount:0},e[a].componentCount++,nj(t,r.updateSpec(null!=(n=l[r.getSpecIndex()])?n:{},l))):nj(t,r.updateSpec(l))}),e)if(Object.prototype.hasOwnProperty.call(e,r)){let i=e[r];i.componentCount!==i.specCount&&(t.reMake=!0)}let r=t=>t&&!1!==t.visible;Object.keys(i).forEach(e=>{if(i[e]){let i=this._spec[e];(tY(i)?i.some(r):r(i))&&(t.reMake=!0)}})}updateSeriesSpec(t){this._spec.series.length===this._series.length?this._series.forEach(e=>{let i=this._spec.series[e.getSpecIndex()];nj(t,e.updateSpec(i))}):t.reMake=!0}getCanvas(){var t,e;return null!=(e=null==(t=this.getCompiler())?void 0:t.getCanvas())?e:null}_updateLayoutRect(t){let e=this.getCanvasRect();if(t){this._viewBox=t;let{x1:i=0,y1:r=0,x2:s,y2:n}=t;e={width:s-i,height:n-r}}else this._viewBox={x1:0,y1:0,x2:e.width,y2:e.height};this._viewRect=e,this.padding=eS(this._paddingSpec,e,e),this._layoutRect.width=e.width-this.padding.left-this.padding.right,this._layoutRect.height=e.height-this.padding.top-this.padding.bottom,this._layoutRect.x=this.padding.left,this._layoutRect.y=this.padding.top,this._event.emit(rB.layoutRectUpdate,{chart:this})}setCurrentTheme(){this.updateChartConfig({change:!0,reMake:!1},this._spec),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,!1),this.updateGlobalScaleTheme(),this.reInit()}reInit(){[...this._regions,...this._series,...this._components].forEach(t=>{let e=t.getSpecInfo();e&&e.spec&&t.reInit(e.spec)})}clear(){this.getAllModels().forEach(t=>{var e;return null==(e=t.clear)?void 0:e.call(t)})}compile(){this.compileBackground(),this.compileLayout(),this.compileRegions(),this.compileSeries(),this.compileComponents()}afterCompile(){this.getAllRegions().forEach(t=>{var e;null==(e=t.afterCompile)||e.call(t)}),this.getAllSeries().forEach(t=>{var e;null==(e=t.afterCompile)||e.call(t)}),this.getAllComponents().forEach(t=>{var e;null==(e=t.afterCompile)||e.call(t)})}compileLayout(){let{width:t,height:e}=this.getCanvasRect();this.getCompiler().setSize(t,e)}compileBackground(){this._backgroundMark&&this._backgroundMark.compile()}compileRegions(){var t,e,i,r;null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeRegionCompile)||e.call(t,this._option.globalInstance),this.getAllRegions().forEach(t=>{t.compile()}),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterRegionCompile)||r.call(i,this._option.globalInstance)}compileSeries(){var t,e,i,r;null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeSeriesCompile)||e.call(t,this._option.globalInstance),this.getAllSeries().forEach(t=>{t.compile()}),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterSeriesCompile)||r.call(i,this._option.globalInstance)}compileComponents(){var t,e,i,r;null==(e=null==(t=this._option.performanceHook)?void 0:t.beforeComponentCompile)||e.call(t,this._option.globalInstance),this.getAllComponents().forEach(t=>{t.compile()}),null==(r=null==(i=this._option.performanceHook)?void 0:i.afterComponentCompile)||r.call(i,this._option.globalInstance)}release(){[...this._components,...this._regions,...this._series].forEach(t=>{t.beforeRelease()}),super.release(),this.clear(),[...this._components,...this._regions,...this._series].forEach(t=>{t.release()}),this._components=this._regions=this._series=[],this._spec={},this._dataSet=this._globalScale=this._layoutFunc=null,this._layoutTag=!1,this._idMap.clear()}onLayout(){this.layout()}updateState(t,e){let i=this.getAllSeries();for(let r in t){if(nR(t[r]))continue;let s=t[r],n={stateValue:r};n=tK(s.filter)?Object.assign({filter:s.filter},n):Object.assign(Object.assign({},s.filter),n),s.level&&(n.level=s.level),i.forEach(t=>{t.getMarks().forEach(i=>{i.stateStyle[r]&&(e&&!e(t,i,r)||(i.state.changeStateInfo(n),i.updateMarkState(r)))})})}}setSelected(t,e,i){this._setStateInDatum(V.STATE_SELECTED,t,e,i)}setHovered(t,e,i){this._setStateInDatum(V.STATE_HOVER,t,e,i)}clearState(t){this._interaction.clearByState(t)}clearAllStates(){this._interaction.clearAllStates()}clearSelected(){this.clearState(V.STATE_SELECTED)}clearHovered(){this.clearState(V.STATE_HOVER)}_initEvent(){[rB.dataZoomChange,rB.scrollBarChange].forEach(t=>{this._event.on(t,({value:t})=>{this._disableMarkAnimation(["exit","update"]);let e=()=>{this._enableMarkAnimation(["exit","update"]),this._event.off(rE.AFTER_MARK_RENDER_END,e)};this._event.on(rE.AFTER_MARK_RENDER_END,e)})})}_enableMarkAnimation(t){this.getAllMarks().forEach(e=>e.enableAnimationByState(t))}_disableMarkAnimation(t){this.getAllMarks().forEach(e=>e.disableAnimationByState(t))}filterGraphicsByDatum(t,e={}){var i;let r=(t=t?eo(t):null)?Object.keys(t[0]):null,s=[],n=null!=(i=e.getDatum)?i:iV;return this.getRegionsInQuerier(e.region).forEach(i=>{let a=[];t&&i.getSeries().forEach(l=>{l.getMarks().forEach(o=>{let h=o.getGraphics();if(h&&h.length&&(!e.filter||tK(e.filter)&&e.filter(l,o)))if(iN(o.type))h.filter(h=>{let u=n(h,o,l,i);u&&t.every((t,e)=>r.every(i=>t[i]==u[e][i]))&&(a.push(h),s.push(h),e.callback&&e.callback(h,o,l,i))});else if(t.length>1){let u=t.slice();h.forEach(t=>{let h=n(t,o,l,i),d=h&&u.findIndex(t=>r.every(e=>t[e]==h[e]));d>=0&&(u.splice(d,1),a.push(t),s.push(t),e.callback&&e.callback(t,o,l,i))})}else{let u=h.find(e=>{let s=n(e,o,l,i);return s&&r.every(e=>t[0][e]==s[e])});u&&(a.push(u),s.push(u),e.callback&&e.callback(u,o,l,i))}})}),e.regionCallback&&e.regionCallback(a,i)}),s}_setStateInDatum(t,e,i,r){if(!e)return void this._interaction.clearByState(t);let s=this.filterGraphicsByDatum(e,{filter:i,region:r});this._interaction.updateStateOfGraphics(t,s)}setDimensionIndex(t,e){var i;let r=null;Array.from(this._event.getComposedEventMap().values()).forEach(i=>{let{eventType:s,event:n}=i;if(s===G.dimensionHover||s===G.dimensionClick){let i=n.dispatch(t,e);(null==i?void 0:i.length)&&(r=i)}});let s=et(t)||!r||r.every(t=>ar(t.axis.getScale().type)&&et(t.index));if(!1!==e.tooltip){let t=this.getComponentsByType(rA.tooltip)[0];if(null==t?void 0:t.getVisible())if(s)null==(i=t.hideTooltip)||i.call(t);else{let i={};r.forEach(t=>{let{axis:e,value:r,data:s}=t,n="left"===e.getOrient()||"right"===e.getOrient();s.forEach(t=>{var e,s,a;let l=n?t.series.fieldY[0]:t.series.fieldX[0];i[l]=null!=(a=null==(s=null==(e=t.datum)?void 0:e[0])?void 0:s[l])?a:r})}),t.showTooltip(i,e.showTooltipOption)}}if(!1!==e.crosshair){let t=this.getComponentsByType(rA.cartesianCrosshair)[0];t&&t.clearAxisValue&&t.setAxisValue&&(s?t.hideCrosshair():t.showCrosshair(r))}}getColorScheme(){var t,e;return null==(e=(t=this._option).getTheme)?void 0:e.call(t,"colorScheme")}}let fz=(t,e)=>{let i={nodes:{}},{fields:r}=e;if(!(null==r?void 0:r.length))return i;let s=r.length-1,n,a=i;return t.forEach(t=>{t.latestData&&t.latestData.forEach(t=>{a=i;for(let e=0;e<r.length;e++){let i=r[e],l=t[i];if(et(l))break;a.groupField=i,a.nodes[l]||(e===s?a.nodes[l]={values:[]}:(n={nodes:{}},a.nodes[l]=n)),e===s?a.nodes[l].values.push(t):a=a.nodes[l]}})}),i};class fj{constructor(t,e){this.stackRegion=({model:t})=>{var e;let i=t.getSeries();if(!i.some(t=>t.getStack()))return;let r=i.some(t=>{var e,i,r,s;return!!(null==(i=null==(e=t.getSpec())?void 0:e.totalLabel)?void 0:i.alwayCalculateTotal)||(null==(s=null==(r=t.getSpec())?void 0:r.totalLabel)?void 0:s.visible)}),s=r||i.some(t=>t.getPercent()),n=i.some(t=>t.getStackOffsetSilhouette()),a=dV(t,!0);for(let e in a)for(let i in a[e].nodes)dY(a[e].nodes[i],t.getStackInverse(),s,r);if(n)for(let t in a)for(let e in a[t].nodes)d$(a[t].nodes[e]);r&&t.getSeries().forEach(t=>{let e=t.getStackData(),i=t.getStackValue(),r=t.getStackValueField();e&&r&&dU(a[i],r)}),(null==(e=this._options)?void 0:e.afterStackRegion)&&this._options.afterStackRegion(t,a)},this._chart=t,this._options=e}init(){this._chart.getAllRegions().forEach(t=>{t.event.on(rB.regionSeriesDataFilterOver,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},this.stackRegion)})}stackAll(){this._chart.getAllRegions().forEach(t=>{this.stackRegion({model:t})})}}class fH{_beforeInit(){this._dataSet&&sY(this._dataSet,"stackSplit",fz)}_initStack(){this._stack=new fj(this),this._stack.init()}}let fN={state:V.STATE_DIMENSION_HOVER,reverseState:V.STATE_DIMENSION_HOVER_REVERSE,trigger:G.dimensionHover};class fV extends dl{constructor(t){super(t),this.type="dimension-hover",this._resetType=[],this.resetAll=()=>{let{state:t,reverseState:e,interaction:i}=this.options,r=i.getStatedGraphics(this);r&&r.length&&(i.clearAllStatesOfTrigger(this,t,e),this.dispatchEvent("reset",{graphics:r,options:this.options}),i.setStatedGraphics(this,[]))},this.handleStart=t=>{let e=this.options.interaction;switch(t.action){case"enter":let i=this.getStatedGraphics(t);e.updateStates(this,this.getStatedGraphics(t),e.getStatedGraphics(this),this.options.state,this.options.reverseState),e.setStatedGraphics(this,i);break;case"leave":e.clearAllStatesOfTrigger(this,this.options.state,this.options.reverseState),e.setStatedGraphics(this,[])}},this.options=Object.assign({},fN,t),this.updateMarkIdByState([this.options.state,this.options.reverseState])}getStartState(){return this.options.state}getResetState(){return this.options.reverseState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart}]}getStatedGraphics(t,e=!1){let i=this.getMarksByState(e?this.options.reverseState:this.options.state),r=[];return t.dimensionInfo.forEach(t=>{t.data.forEach(t=>{i.filter(e=>e.model===t.series&&e.getVisible()).forEach(i=>{let s=i.getGraphics();if(!s||!s.length)return;let n=s.filter(i=>{let r,s=iV(i);return r=tY(s)?s.every((e,i)=>e===t.datum[i]):t.datum.some(t=>t===s),e?!r:r});r.push(...n)})})}),r}}fV.type="dimension-hover",fV.defaultOptions=fN;let fW=()=>{ig.registerInteractionTrigger(fV.type,fV)};class fU{constructor(t,e){this._eventDispatcher=t,this._mode=e}get chart(){var t,e;return this._chart||(this._chart=null==(e=(t=this._eventDispatcher.globalInstance).getChart)?void 0:e.call(t)),this._chart}register(t,e){var i,r;(null!=(r=null==(i=this.chart)?void 0:i.getOption().onError)?r:eR)("Method not implemented.")}unregister(){var t,e;(null!=(e=null==(t=this.chart)?void 0:t.getOption().onError)?e:eR)("Method not implemented.")}getTargetDimensionInfo(t,e){var i,r,s;let n=null!=(s=null==(r=(i=this.chart.getModelOption()).getDimensionInfo)?void 0:r.call(i,this.chart,{x:t,y:e}))?s:[];return 0===n.length?null:n}dispatch(t,e){var i,r;let s=null==(i=this.chart)?void 0:i.getAllComponents().filter(t=>"axes"===t.specKey&&(!(null==e?void 0:e.filter)||e.filter(t))),n=s.filter(t=>ar(t.getScale().type)),a=n.length?n:s.filter(t=>{let e=t.getOrient();return p$(e)||"angle"===e}),l=[],o=null==(r=this.chart)?void 0:r.getModelOption().getDimensionInfoByValue;return o&&a.forEach(e=>{let i=o(e,t);i&&l.push(i)}),this._callback.call(null,{action:"enter",dimensionInfo:l}),l}}let fG=(t,e,i)=>t.x>=e.x&&t.x<=i.x&&t.y>=e.y&&t.y<=i.y,fZ=(t,e,i)=>{let r=t.getRegionsInIds(eo(e.layout.layoutBindRegionID));return null==r?void 0:r.some(t=>{let e=t.getLayoutRect(),r=t.getLayoutStartPoint();return fG(i,{x:r.x,y:r.y},{x:e.width+r.x,y:e.height+r.y})})},f$=(t,e)=>{var i,r;return t===e||!et(t)&&!et(e)&&t.value===e.value&&(null==(i=t.axis)?void 0:i.id)===(null==(r=e.axis)?void 0:r.id)},fY=(t,e)=>{let i=t.tooltipFilterRange,r="function"==typeof i?i({scale:e}):i;return ee(r)?[-r,r]:r},fX=(t,e,i,r)=>{var s;let n=e.getScale(),a=ar(n.type),l=[];for(let o of e.getOption().getChart().getSeriesInIndex(e.getSpecInfo().seriesIndexes))if(o.coordinate===i){let i=eo(r(o)),h=null==(s=o.getViewData())?void 0:s.latestData;if(i&&h)if(a){let e=[],r=[];h.forEach((s,n)=>{var a;(null==(a=s[i[0]])?void 0:a.toString())===(null==t?void 0:t.toString())&&(e.push(s),r.push(n))}),l.push({series:o,datum:e,key:fK(o,r)})}else if(t5(i[1])){let e=[],r=[];h.forEach((s,n)=>{var a;((null==(a=s[i[0]])?void 0:a.toString())===(null==t?void 0:t.toString())||t5(s[i[0]])&&t5(s[i[1]])&&t>=s[i[0]]&&t<s[i[1]])&&(e.push(s),r.push(n))}),l.push({series:o,datum:e,key:fK(o,r)})}else{let r=fY(e.getSpec(),n),s=[],a=[];if(r)h.forEach((e,n)=>{if(t5(e[i[0]])){let l=e[i[0]]-t;l>=r[0]&&l<=r[1]&&(s.push(e),a.push(n))}});else{let e=1/0,r=0;h.forEach((n,l)=>{if(t5(n[i[0]])){let o=Math.abs(n[i[0]]-t),h=Math.sign(n[i[0]]-t);o<e?(e=o,s=[n],a=[l],r=h):o===e&&h===r&&(s.push(n),a.push(l))}})}l.push({series:o,datum:s,key:fK(o,a)})}}return l},fK=(t,e)=>`${t.id}_${e.join("_")}`,fq=(t,e,i)=>{let r=t.getAllComponents().filter(r=>"axes"===r.specKey&&e(r)&&fZ(t,r,i));return r.length?r:null};class fQ extends fU{constructor(){super(...arguments),this._cacheDimensionInfo=null,this.onMouseMove=t=>{if(!t)return;let e=t.event.viewX,i=t.event.viewY,r=this.getTargetDimensionInfo(e,i);null===r&&null!==this._cacheDimensionInfo?(this._callback.call(null,Object.assign(Object.assign({},t),{action:"leave",dimensionInfo:this._cacheDimensionInfo.slice()})),this._cacheDimensionInfo=r):null!==r&&(null===this._cacheDimensionInfo||r.length!==this._cacheDimensionInfo.length||r.some((t,e)=>!f$(t,this._cacheDimensionInfo[e])))?(this._callback.call(null,Object.assign(Object.assign({},t),{action:"enter",dimensionInfo:r.slice()})),this._cacheDimensionInfo=r):null!==r&&this._callback.call(null,Object.assign(Object.assign({},t),{action:"move",dimensionInfo:r.slice()}))},this.onMouseOut=t=>{t&&(this._callback.call(null,Object.assign(Object.assign({},t),{action:"leave",dimensionInfo:this._cacheDimensionInfo?this._cacheDimensionInfo.slice():[]})),this._cacheDimensionInfo=null)}}register(t,e){this._callback=e.callback,this._eventDispatcher.register("pointermove",{query:Object.assign(Object.assign({},e.query),{source:rP.chart}),callback:this.onMouseMove}),this._eventDispatcher.register("pointerout",{query:Object.assign(Object.assign({},e.query),{source:rP.canvas}),callback:this.onMouseOut}),eB(this._mode)&&this._eventDispatcher.register("pointerdown",{query:Object.assign(Object.assign({},e.query),{source:rP.chart}),callback:this.onMouseMove})}unregister(){this._eventDispatcher.unregister("pointermove",{query:null,callback:this.onMouseMove}),eB(this._mode)&&this._eventDispatcher.unregister("pointerdown",{query:null,callback:this.onMouseMove})}}class fJ extends fU{constructor(){super(...arguments),this.onClick=t=>{if(!t)return;let e=t.event.viewX,i=t.event.viewY,r=this.getTargetDimensionInfo(e,i);r&&this._callback.call(null,Object.assign(Object.assign({},t),{action:"click",dimensionInfo:r.slice()}))}}register(t,e){this._callback=e.callback,this._eventDispatcher.register("pointertap",{query:Object.assign(Object.assign({},e.query),{source:rP.chart}),callback:this.onClick})}unregister(){this._eventDispatcher.unregister("pointertap",{query:null,callback:this.onClick})}}let f0=()=>{ig.registerComposedEvent(G.dimensionHover,fQ),ig.registerComposedEvent(G.dimensionClick,fJ)},f1=t=>t.fieldX[0],f2=t=>t.fieldY[0],f3=t=>{var e;return[t.fieldX[0],null!=(e=t.fieldX2)?e:t.fieldX[1]]},f5=t=>{var e;return[t.fieldY[0],null!=(e=t.fieldY2)?e:t.fieldY[1]]},f4=(t,e)=>t?e?f1:f3:e?f2:f5,f7=(t,e,i)=>{var r,s;if(!t)return null;let{x:n,y:a}=e,l=null!=(r=fq(t,t=>p$(t.getOrient()),e))?r:[],o=null!=(s=fq(t,t=>pY(t.getOrient()),e))?s:[];if(!l.length&&!o.length)return null;let h=new Set,u=new Set,d=new Set;[l,o].forEach(t=>t.forEach(t=>{ar(t.getScale().type)?h.add(t):u.add(t),i&&t.getSpec().hasDimensionTooltip&&d.add(t)}));let c=[],p=t=>{let e="x"===t,i=e?n:a;(e?l:o).forEach(t=>{if(d.size>0){if(d.has(t)){let r=f6(t,i,f4(e,ar(t.getScale().type)));r&&c.push(r)}}else{let r=h.size>0;if((r?h:u).has(t)){let s=f6(t,i,f4(e,r));s&&c.push(s)}}})};return"horizontal"===t.getSpec().direction?(p("y"),0===c.length&&p("x")):(p("x"),0===c.length&&p("y")),c.length?c:null},f6=(t,e,i)=>{let r=t.positionToData(e,!0);return et(r)?null:f9(t,r,i)},f9=(t,e,i)=>{let r=t.getScale();if(et(e))return null;let s=r.domain().findIndex(t=>(null==t?void 0:t.toString())===e.toString());s<0&&(s=void 0);let n=fX(e,t,"cartesian",null!=i?i:p$(t.getOrient())?f1:f2);return{index:s,value:e,position:r.scale(e),axis:t,data:n}},f8=(t,e,i,r=!1)=>(i||(i={x:0,y:0}),Object.keys(t).forEach(s=>{var n,a,l,o,h,u;let d,{currentValue:c,cacheInfo:p,labelsComp:g,attributes:f,coordKey:m}=t[s],y=null,_=0,v=null;if(c.size){let t=Array.from(c.values())[0];_=t.axis.getScale().scale(t.datum)+t.axis.getLayoutStartPoint()[m]-i[m],v=null==(u=null==(h=null==(o=null==(l=null==(a=null==(n=(y=t.axis).getVRenderComponents()[0])?void 0:n.children[0])?void 0:a.children[0])?void 0:l.children[0])?void 0:o.getChildByName("axis-label-container"))?void 0:h.getChildByName("axis-label-container-layer-0"))?void 0:u.children[0]}let b=!!c.size&&Number.isFinite(_)&&!Number.isNaN(_),x=r&&!b&&t5(p),S=x?p:{coordRange:[0,0],sizeRange:[0,0],coord:_,labelsTextStyle:{},labels:g?Object.keys(g).reduce((t,e)=>(t[e]={visible:!1,text:"",dx:0,dy:0},t),{}):null,visible:b,axis:y,axisLabel:v};S&&(S._isCache=x);let k=0;if(f&&c.forEach(({axis:t,datum:i=""})=>{var r,n,a,l,o,h,u,c,p,g;let m=null,y=t.getScale();if(ar(y.type))0===(d=y.bandwidth())&&y.step&&(k=y.step());else if(ai(y.type)){let r="xField"===s?e.fieldX[0]:e.fieldY[0],n="xField"===s?e.fieldX2:e.fieldY2,a=function(t,e,i,r){for(let s=0,n=t.length;s<n;s++){let n=t[s];if(n){let t=n[i],s=n[r||i];if(t<=e&&s>=e)return n}}return null}(e.getViewData().latestData,+i,r,n);if(a){let t="xField"===s?e.dataToPositionX(a):e.dataToPositionY(a);n?(d=Math.abs(t-("xField"===s?e.dataToPositionX1(a):e.dataToPositionY1(a))),i=`${a[r]} ~ ${a[n]}`):d=1,_=t}m=t.niceLabelFormatter}if(S&&(null==(r=f.label)?void 0:r.visible)&&!x){let e=ga(t.getSpec()),r=t.getOrient(),s=null==(n=f.label)?void 0:n.syncAxisLabelAngle;S.labels[r]&&(S.labels[r].visible=!0,S.labels[r].text=i,"left"===r?(S.labels[r].dx=-e,S.labelsTextStyle[r]={textAlign:s&&v&&null!=(a=v.attribute.textAlign)?a:"right",textBaseline:s&&v&&null!=(l=v.attribute.textBaseline)?l:"middle"}):"right"===r?(S.labels[r].dx=e,S.labelsTextStyle[r]={textAlign:s&&v&&null!=(o=v.attribute.textAlign)?o:"left",textBaseline:s&&v&&null!=(h=v.attribute.textBaseline)?h:"middle"}):"top"===r?(S.labels[r].y=0,S.labels[r].dy=-e,S.labelsTextStyle[r]={textAlign:s&&v&&null!=(u=v.attribute.textAlign)?u:"center",textBaseline:s&&v&&null!=(c=v.attribute.textBaseline)?c:"bottom"}):"bottom"===r&&(S.labels[r].dy=e,S.labelsTextStyle[r]={textAlign:s&&v&&null!=(p=v.attribute.textAlign)?p:"center",textBaseline:s&&v&&null!=(g=v.attribute.textBaseline)?g:"top"}),S.labels[r].defaultFormatter=m)}}),S&&!x){let t={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};me(t,c),"xField"===s?(S.coordRange=[t.x1,t.x2],S.sizeRange=[t.y1,t.y2],S.coord=_+i.x,S.labels&&(S.labels.top.y=t.y1,S.labels.bottom.y=t.y2)):(S.coordRange=[t.y1,t.y2],S.sizeRange=[t.x1,t.x2],S.coord=_+i.y,S.labels&&(S.labels.left.x=t.x1,S.labels.right.x=t.x2)),(S.coord<S.coordRange[0]||S.coord>S.coordRange[1])&&(S.visible=!1),f&&f.label&&Object.keys(S.labels).forEach(t=>{S.labels[t].visible&&mt(S.labels[t],t,f.label)})}t[s].bandSize=null!=d?d:0,t[s].offsetSize=k,t[s].cacheInfo=S}),t),mt=(t,e,i)=>{let{formatMethod:r,formatter:s}=i,{formatFunc:n,args:a}=dJ(r,s,t.text,{label:t.text,position:e});n?t.text=n(...a):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))},me=(t,e)=>{e.forEach(({axis:e})=>{e.getRegions().forEach(e=>{let{x:i,y:r}=e.getLayoutStartPoint(),{width:s,height:n}=e.getLayoutRect();t.x1=Math.min(t.x1,i),t.y1=Math.min(t.y1,r),t.x2=Math.max(t.x2,i+s),t.y2=Math.max(t.y2,r+n)})})},mi=t=>{let e,{cacheInfo:i,attributes:r,bandSize:s,offsetSize:n,coordKey:a,anotherAxisKey:l}=t,{coord:o,sizeRange:h}=i,u=r.type;if("line"===u){let t=o+s/2;e={visible:!0,start:{[a]:t,[l]:h[0]},end:{[a]:t,[l]:h[1]}}}else if("rect"===u){let[t,u]=mr(r,s,n,i.axis),{coordRange:d}=i;e={visible:!0,start:{[a]:Math.max(o+t,d[0]),[l]:h[0]},end:{[a]:Math.min(o+u,d[1]),[l]:h[1]}}}return e},mr=(t,e,i,r)=>{var s,n,a;let l=0===e?i:e,o=l;if(null==(s=t.style)?void 0:s.sizePercent)o=l*t.style.sizePercent;else if("number"==typeof(null==(n=t.style)?void 0:n.size))o=t.style.size;else if("function"==typeof(null==(a=t.style)?void 0:a.size)){let e=r.getLayoutRect();o=t.style.size(e,r)}return 0===e?[-o/2,o/2]:[e/2-o/2,o/2+e/2]},ms=(t,e)=>{var i;let r=new Map,s=new Map,{series:n,datum:a}=t,l="horizontal"===n.direction,o=(l?n.getYAxisHelper():n.getXAxisHelper()).getAxisId(),h=n.getChart().getComponentsByKey("axes").find(t=>t.id===o);if(!h)return;(l?s:r).set(h.getSpecIndex(),{datum:null==(i=n.getDatumPositionValues(a[0],n.getDimensionField()))?void 0:i[0],axis:h});let u={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:r,attributes:{visible:!!r.size,type:"rect"}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:s,attributes:{visible:!!s.size,type:"rect"}}};return f8(u,n,e),u.xField.cacheInfo?mi(u.xField):u.yField.cacheInfo?mi(u.yField):void 0},mn=["updateTitle","updateContent","updatePosition","maxLineCount","othersLine"],ma=(t,e,i,r,s)=>{var n,a,l;let o={activeType:t};switch(t){case"mark":case"group":if(i){let l=null==(n=i.getSpec())?void 0:n.tooltip;return o.visible=!0,(null==l?void 0:l.handler)&&(o.handler=l.handler),(null==(a=o.handler)?void 0:a.showTooltip)?o:((null==l?void 0:l[t])&&mn.forEach(e=>{t5(l[t][e])&&(o[e]=l[t][e])}),Object.assign(Object.assign({},o),i.tooltipHelper.getTooltipData(t,e,r,r[0].datum,s)))}break;case"dimension":if(null==r?void 0:r.length){if(ml(r).every(t=>{var e;return!d4("dimension",null==(e=t.tooltipHelper)?void 0:e.spec)})?o.visible=!1:o.visible=!0,o.handler=e.handler,null==(l=o.handler)?void 0:l.showTooltip)return o;let i=[];return r.forEach(n=>n.data.forEach(n=>{let{series:a}=n,l=a.tooltipHelper.getTooltipData(t,e,r,n.datum,s);l&&i.push(l)})),function(t){if(!t||!t.length)return null;let e=[];return t.forEach(({content:t})=>{t&&t.forEach(t=>{e.push(t)})}),e.length?Object.assign(Object.assign({},t[0]),{content:e}):t[0]}(i)}}return null},ml=t=>{let e=[];return t.forEach(t=>{t.data.forEach(t=>{t5(t.series)&&e.push(t.series)})}),e},mo={dom:`${s6}_TOOLTIP_HANDLER_DOM`,canvas:`${s6}_TOOLTIP_HANDLER_CANVAS`},mh={key:"其他",value:"..."};(C=X||(X={})).group="group",C.mark="mark",C.dimension="dimension";class mu{constructor(t){this._showTooltipByHandler=(t,e)=>{var i,r,s;let n;if(et(t))return 1;e.changePositionOnly||this.clearCache(),this._updateViewSpec(t,e);let a=this._cacheActiveSpec;if(et(a)||!1===a.visible)return 1;e.tooltipSpec=this.component.getSpec(),e.activeTooltipSpec=a;let{title:l,content:o}=a,h=et(null==l?void 0:l.key)&&et(null==l?void 0:l.value)&&!(null==o?void 0:o.length);return(this.component.event.emit(rB.tooltipShow,Object.assign(Object.assign({},e),{isEmptyTooltip:h,tooltipData:t,activeType:this.activeType,tooltip:this.component})),h)?1:((null==(i=a.handler)?void 0:i.showTooltip)?n=a.handler.showTooltip.bind(a.handler):(null==(r=this.component.tooltipHandler)?void 0:r.showTooltip)&&(n=this.component.tooltipHandler.showTooltip.bind(this.component.tooltipHandler)),n?null!=(s=n(this.activeType,t,e))?s:0:1)},this.component=t}_preprocessDimensionInfo(t){let e=[];if(null==t||t.forEach(t=>{let i=Object.assign(Object.assign({},t),{data:t.data.filter(({series:t})=>{var e,i;return!1!==(null==(i=null==(e=t.getSpec())?void 0:e.tooltip)?void 0:i.visible)})});i.data.length>0&&e.push(i)}),e.length>0)return e}_updateViewSpec(t,e){var i,r,s,n,a,l,o,h,u;let{changePositionOnly:d,model:c}=e;if(!d||!this._cacheActiveSpec){let d=this.component.getSpec();if(this._cacheActiveSpec=ma(this.activeType,this.component.getSpec(),c,t,e),this._cacheActiveSpec){et(this._cacheActiveSpec.handler)&&t5(d.handler)&&(this._cacheActiveSpec.handler=d.handler);let c=null!=(i=d[this.activeType])?i:{},p=null!=(r=this._cacheActiveSpec.updateTitle)?r:c.updateTitle,g=null!=(s=this._cacheActiveSpec.updateContent)?s:c.updateContent,f=null!=(a=null!=(n=this._cacheActiveSpec.maxLineCount)?n:c.maxLineCount)?a:20;if(p&&(this._cacheActiveSpec.title=null!=(l=p(this._cacheActiveSpec.title,t,e))?l:this._cacheActiveSpec.title),g)this._cacheActiveSpec.content=null!=(o=g(this._cacheActiveSpec.content,t,e))?o:this._cacheActiveSpec.content;else if(f>=1&&(null==(h=this._cacheActiveSpec.content)?void 0:h.length)>f){let t=null!=(u=this._cacheActiveSpec.othersLine)?u:c.othersLine,e=t?Object.assign(Object.assign({},mh),t):mh;this._cacheActiveSpec.content=[...this._cacheActiveSpec.content.slice(0,f-1),Object.assign(Object.assign({},this._cacheActiveSpec.content[f-1]),e)]}}}}shouldHandleTooltip(t,e){var i,r;return!et(e)&&d4(this.activeType,null==(r=null==(i=t.model)?void 0:i.tooltipHelper)?void 0:r.spec)}clearCache(){this._cacheActiveSpec=void 0}}class md extends mu{constructor(){super(...arguments),this.activeType="dimension"}showTooltip(t,e,i){let r=Object.assign(Object.assign({},e),{dimensionInfo:this._preprocessDimensionInfo(t),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(t,r)}_getDimensionInfo(t){var e,i,r;let s,n=this.component.getChart(),a=n.getCompiler().getStage().getLayer(void 0),l={x:t.event.viewX,y:t.event.viewY};if(a.globalTransMatrix.transformPoint({x:t.event.viewX,y:t.event.viewY},l),0===(s=null!=(r=null==(i=(e=this.component.getOption()).getDimensionInfo)?void 0:i.call(e,n,l,!0))?r:[]).length)s=void 0;else if(s.length>1){let t=s.filter(t=>{var e;let i,r=t.axis;if(r.getSpec().hasDimensionTooltip)return!0;if(!ar(r.getScale().type))return!1;for(let t of null!=(e=null==r?void 0:r.getRegions())?e:[]){for(let e of t.getSeries())if("cartesian"===e.coordinate){i=e;break}if(t5(i))break}return t5(i)&&i.getDimensionField()[0]===i.fieldY[0]?"left"===r.getOrient()||"right"===r.getOrient():"bottom"===r.getOrient()||"top"===r.getOrient()});if((s=t.length?t:s.slice(0,1)).length>1){let t=new Set;s.forEach(e=>{e.data=e.data.filter(({key:e})=>!t.has(e)&&(t.add(e),!0))})}}return s}getMouseEventData(t){return{tooltipInfo:this._getDimensionInfo(t),ignore:!1}}}let mc=()=>{ig.registerTooltipProcessor("dimension",md)};class mp extends mu{constructor(){super(...arguments),this.activeType="mark"}showTooltip(t,e,i){var r,s,n;let{datum:a,series:l}=t,o=this.component.getSpec(),h=[{datum:[a],series:l}],u=l.tooltipHelper,d=null==(r=l.getSpec())?void 0:r.tooltip,c=null==(s=null==d?void 0:d.mark)?void 0:s.checkOverlap,p=!1;if(!0===c||!0===(null==(n=o.mark)?void 0:n.checkOverlap)&&!1!==c){let t=null==u?void 0:u.activeTriggerSet.mark;if(t){p=!0;let i=this.component.getChart().getCompiler().getStage().getLayer(void 0),r={x:e.event.viewX,y:e.event.viewY};i.globalTransMatrix.transformPoint({x:e.event.viewX,y:e.event.viewY},r),t.forEach(t=>{t.getGraphics().forEach(t=>{t!==e.node&&t&&t.containsPoint(r.x,r.y,lW.LZ.GLOBAL,t.stage.getPickerService())&&h[0].datum.push(iV(t))})})}}let g=Object.assign(Object.assign({},e),{model:l,changePositionOnly:i,tooltip:this.component});if(i&&p){let t=this._cacheActiveSpec&&this._cacheActiveSpec.data;t&&t[0].series===h[0].series&&t[0].datum.length===h[0].datum.length&&!t[0].datum.some((t,e)=>t!==h[0].datum[e])||(g.changePositionOnly=!1)}return this._showTooltipByHandler(h,g)}getMouseEventData(t){var e;let i,r,s=null==(e=t.model)?void 0:e.modelType;if("series"===s){let e=t.model,s=e.tooltipHelper,n=null==s?void 0:s.activeTriggerSet.mark,a=null==s?void 0:s.ignoreTriggerSet.mark;(null==n?void 0:n.has(t.mark))?i={mark:t.mark,datum:t.datum,series:e}:(null==a?void 0:a.has(t.mark))&&(r=!0)}else if("component"===s){let e=t.model,s=t.node;if("label"===e.name&&s){let t=e.getLabelInfoByTextGraphic(s),{baseMark:n,series:a,labelMark:l}=null!=t?t:{},o=a.tooltipHelper,h=null==o?void 0:o.activeTriggerSet.mark,u=null==o?void 0:o.ignoreTriggerSet.mark;(null==h?void 0:h.has(l))?i={mark:n,datum:s.attribute.data,series:a}:(null==u?void 0:u.has(l))&&(r=!0)}}return{tooltipInfo:i,ignore:r}}}let mg=()=>{ig.registerTooltipProcessor("mark",mp)};class mf extends mu{constructor(){super(...arguments),this.activeType="group"}showTooltip(t,e,i){let{datum:r,series:s}=t,n=[{datum:eo(r),series:s}],a=Object.assign(Object.assign({},e),{groupDatum:this._getGroupDatum(e),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(n,a)}getMouseEventData(t){var e,i;let r;if("series"===(null==(e=t.model)?void 0:e.modelType)){let e=t.model,s=e.tooltipHelper,n=null==s?void 0:s.activeTriggerSet.group;if(null==n?void 0:n.has(t.mark)){let s=this.component.getSpec()[this.activeType];((null==s?void 0:s.triggerMark)?eo(s.triggerMark):[]).includes(null==(i=t.mark)?void 0:i.name)&&(r={mark:t.mark,datum:t.datum,series:e})}}return{tooltipInfo:r,ignore:!1}}_getGroupDatum(t){let{model:e,mark:i,datum:r}=t;if(["line","area"].includes(i.type))return eo(r);let s=e.getViewData().latestData,n=e.getSeriesField();if(!n)return s;let a=eo(r)[0][n];return s.filter(t=>t[n]===a)}}let mm=()=>{ig.registerTooltipProcessor("group",mf)};class my extends fF{constructor(){super(...arguments),this.transformerConstructor=fO,this.type="line",this.seriesType=rw.line}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}my.type="line",my.seriesType=rw.line,my.transformerConstructor=fO,cD(my,fH);let m_=()=>{mc(),mg(),mm(),f0(),fW(),fT(),ig.registerChart(my.type,my)};var mv=i(33430);let mb=["segments","points","curveType","curveTension",...mv.DH];class mx extends mv.zs{constructor(t){super(t),this.type="area",this.numberType=oW.Ri}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;let{points:t,segments:e}=this.attribute;return e?0!==e.length:!!t&&0!==t.length}getGraphicTheme(){return(0,uo.gh)(this).area}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateAreaAABBBoundsBySegments(t,e,i):this.updateAreaAABBBoundsByPoints(t,e,i)),lM.w.graphicService.updateTempAABBBounds(i),this.setWidthHeightWithoutTransform(i);let{lineJoin:r=e.lineJoin}=t;return lM.w.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}updateAreaAABBBoundsByPoints(t,e,i,r){let{points:s=e.points}=t;return s.forEach(t=>{var e,r;i.add(t.x,t.y),i.add(null!=(e=t.x1)?e:t.x,null!=(r=t.y1)?r:t.y)}),i}updateAreaAABBBoundsBySegments(t,e,i,r){let{segments:s=e.segments}=t;return s.forEach(t=>{t.points.forEach(t=>{var e,r;i.add(t.x,t.y),i.add(null!=(e=t.x1)?e:t.x,null!=(r=t.y1)?r:t.y)})}),i}_interpolate(t,e,i,r,s){"points"===t&&(s.points=(0,he.SA)(i,r,e))}needUpdateTags(t){return super.needUpdateTags(t,mb)}needUpdateTag(t){return super.needUpdateTag(t,mb)}toCustomPath(){let t=super.toCustomPath();if(t)return t;t=new lf.r;let e=this.attribute,i=e.segments,r=e=>{if(e&&e.length){let i=!0,r=[];if(e.forEach(e=>{var s,n;!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),r.push({x:null!=(s=e.x1)?s:e.x,y:null!=(n=e.y1)?n:e.y}),i=!1)}),r.length){for(let e=r.length-1;e>=0;e--)t.lineTo(r[e].x,r[e].y);t.closePath()}}};return e.points?r(e.points):i&&i.length&&i.forEach(t=>{r(t.points)}),t}clone(){return new mx(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return mx.NOWORK_ANIMATE_ATTR}}function mS(t){return new mx(t)}mx.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},mv.Wl);var mk=i(42178),mA=i(26036),mM=i(90552),mw=i(25044);let mT=!1,mC=new oy.n(t=>{mT||(mT=!0,t(mk.j).toSelf().inSingletonScope(),t(oU.Gs).to(mk.j).inSingletonScope(),t(oU.uz).toService(oU.Gs),t(mM.Gq).toService(mA.Sg),(0,oD.yb)(t,mM.Gq),t(mw.K).toSelf().inSingletonScope())});var mE=i(52493);let mB=class extends oG.o{constructor(t){super(),this.canvasRenderer=t,this.type="area",this.numberType=oW.Ri}};mB=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(E=(0,oC.f)(oU.Gs),function(t,e){E(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],mB);let mP=!1,mO=new oy.n((t,e,i,r)=>{mP||(mP=!0,t(oz.CV).to(mB).inSingletonScope(),t(oz.EL).toService(oz.CV))});function mI(){mI.__loaded||(mI.__loaded=!0,c$.i.RegisterGraphicCreator("area",mS),of.n.load(mC),of.n.load(mE.X?mO:oY))}mI.__loaded=!1;let mR=[...cV,"fill","fillOpacity","background","texture","texturePadding","textureSize","textureColor"];class mL extends cW{constructor(){super(...arguments),this.type=mL.type,this._isValidPointChannel=t=>["x","y","x1","y1","defined"].includes(t)}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}_getSegmentAttributes(){return mR}_getIgnoreAttributes(){return[]}}mL.type="area";let mD=()=>{ig.registerMark(mL.type,mL),(0,ol.W)(),mI(),pC(),pP(),u6(),ig.registerGraphicComponent("area",mS)};class mF extends d8{constructor(){super(...arguments),this._getSeriesStyle=(t,e,i)=>{var r,s,n,a;for(let i of eo(e)){let e=null==(r=this.series.getSeriesStyle(t))?void 0:r(i);if(!1!==e||"fill"!==i&&"stroke"!==i||(e="fill"===i?null==(n=null==(s=this.series.getSeriesStyle(t))?void 0:s("stroke"))?void 0:n[0]:null==(a=this.series.getSeriesStyle(t))?void 0:a("fill")),t5(e))return e}return i}}}let mz=Object.assign(Object.assign(Object.assign({},cd),cR),{area:{name:"area",type:"area"}}),mj=()=>{u3(),u2(),uQ()};class mH extends pz{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){var e,i,r;let s=!1!==(null==(e=t.point)?void 0:e.visible)&&!1!==(null==(r=null==(i=t.point)?void 0:i.style)?void 0:r.visible);this._addMarkLabelSpec(t,t=>{let e="inside-middle"===t.position;return!s||e?"area":"point"}),this._addMarkLabelSpec(t,"area","areaLabel","initLineLabelMarkStyle",void 0,!0)}_transformSpecAfterMergingTheme(t,e,i){var r,s,n,a,l;super._transformSpecAfterMergingTheme(t,e,i);let{area:o={},line:h={},seriesMark:u}=t,d=!1!==o.visible&&!1!==(null==(r=o.style)?void 0:r.visible),c=!1!==h.visible&&!1!==(null==(s=h.style)?void 0:s.visible);o.support3d=!(!o.support3d&&!h.support3d),o.zIndex=t5(o.zIndex)||t5(h.zIndex)?Math.max(null!=(n=o.zIndex)?n:0,null!=(a=h.zIndex)?a:0):void 0,o.style&&delete o.style.stroke,o.state&&Object.keys(o.state).forEach(t=>{"style"in o.state[t]?delete o.state[t].style.stroke:delete o.state[t].stroke});let p=o,g=h;("line"===u||c&&!d)&&(p=h,g=o),o.style=it({},g.style,p.style),o.state=it({},g.state,p.state),!1===o.interactive&&(o.style.fillPickable=!1),!1===h.interactive&&(h.style.strokePickable=!1),o.interactive=!(!o.interactive&&null!=(l=h.interactive)&&!l),t.area=o,t.line=h}}class mN extends cB{constructor(){super(...arguments),this.type=rw.area,this.transformerConstructor=mH,this._sortDataByAxis=!1}initMark(){var t;let e=null!=(t=this._spec.seriesMark)?t:"area",i=this._isAreaVisible()||this._isLineVisible();this._areaMark=this._createMark(mN.mark.area,{groupKey:this._seriesField,isSeriesMark:i&&"point"!==e},{morphElementKey:this.getDimensionField()[0]}),this.initSymbolMark("point"===e)}initMarkStyle(){this.initAreaMarkStyle(),this.initSymbolMarkStyle()}initAreaMarkStyle(){var t,e,i,r,s;let n=null!=(i=null==(e=null==(t=this.getSpec().area)?void 0:t.style)?void 0:e.curveType)?i:null==(s=null==(r=this.getSpec().line)?void 0:r.style)?void 0:s.curveType,a=n===cP?"horizontal"===this._direction?"monotoneY":"monotoneX":n,l=this._areaMark;if(l){let t=this._isAreaVisible(),e=this._isLineVisible();t||e?l.setVisible(!0):l.setVisible(!1),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:t=>{var e,i;return lr(this.dataToPositionX1(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),y1:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,orient:this._direction},"normal",H.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:this.dataToPositionX.bind(this),y1:t=>{var e,i;return lr(this.dataToPositionY1(t),null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",H.Series),this.setMarkStyle(l,{fill:!!t&&this.getColorAttribute(),stroke:!!e&&this.getColorAttribute()},"normal",H.Series),"zero"!==this._invalidType&&this.setMarkStyle(l,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",H.Series),this.getStack()&&this.setMarkStyle(l,{zIndex:t=>-t[nl]},"normal",H.Series),this.setMarkStyle(l,{curveType:a},"normal",H.Built_In),Object.keys(l.stateStyle).forEach(t=>{l.stateStyle[t].stroke&&l.setPostProcess("stroke",t=>[t,!1,!1,!1],t)})}}initAnimation(){var t,e,i,r;let s={direction:this.direction},n=null==(t=this._spec.animationAppear)?void 0:t.preset;if(this._lineMark&&this._lineMark.setAnimationConfig(cv(null==(e=ig.getAnimationInKey("line"))?void 0:e(s,n),cb("line",this._spec,this._markAttributeContext))),this._areaMark&&this._areaMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("area"))?void 0:i(s,n),cb("area",this._spec,this._markAttributeContext))),this._symbolMark){let t=cE(this);this._symbolMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("scaleInOut"))?void 0:r(),cb("point",this._spec,this._markAttributeContext),t))}}_isAreaVisible(){var t;let e=this._spec.area||{};return!1!==e.visible&&!1!==(null==(t=e.style)?void 0:t.visible)}_isLineVisible(){var t;let e=this._spec.line||{};return!1!==e.visible&&!1!==(null==(t=e.style)?void 0:t.visible)}initTooltip(){this._tooltipHelper=new mF(this);let{group:t,mark:e}=this._tooltipHelper.activeTriggerSet;this._areaMark&&t.add(this._areaMark),this._lineMark&&t.add(this._lineMark),this._symbolMark&&(e.add(this._symbolMark),t.add(this._symbolMark))}viewDataStatisticsUpdate(t){super.viewDataStatisticsUpdate(t),this.encodeDefined(this._areaMark,"defined")}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}onLayoutEnd(){super.onLayoutEnd(),this.reCompileSampling()}getSeriesStyle(t){return e=>{var i,r,s,n,a;let l=null!=(i=this._spec.seriesMark)?i:"area",o=null!=(s=null==(r=this._seriesMark)?void 0:r.getAttribute(e,t))?s:void 0;return"fill"!==e||o&&"line"!==l||(e="stroke",o=null!=(a=null==(n=this._seriesMark)?void 0:n.getAttribute(e,t))?a:void 0),"stroke"===e&&tY(o)?o[0]:o}}}mN.type=rw.area,mN.builtInTheme={area:{label:{visible:!1,offset:5,position:"top",style:{stroke:{type:"palette",key:"backgroundColor"},lineWidth:2}},point:{style:{symbolType:"circle"}},seriesMark:"area"}},mN.mark=mz,mN.transformerConstructor=mH,cD(mN,cL);let mV=()=>{fM(),fm(),pI(),mD(),pF(),mj(),g8(),fc(),ig.registerSeries(mN.type,mN)};class mW extends fP{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["point","line","area","seriesMark","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","areaLabel","useSequentialAnimation"])}transformSpec(t){super.transformSpec(t),nF(t)}}class mU extends fF{constructor(){super(...arguments),this.transformerConstructor=mW,this.type="area",this.seriesType=rw.area}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}mU.type="area",mU.seriesType=rw.area,mU.transformerConstructor=mW,cD(mU,fH);let mG=()=>{mc(),mg(),mm(),fW(),mV(),f0(),ig.registerChart(mU.type,mU)};function mZ(t,e=!0){return(i,r,s)=>{let n="vertical"===t.direction?t.yField:t.xField,a=null==i?void 0:i[n];return"vertical"===t.direction?{overall:e?t.growFrom():e,orient:a>0?"negative":"positive"}:{overall:!!e&&t.growFrom(),orient:a>0?"positive":"negative"}}}let m$=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:mZ(t,e)}),mY=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:mZ(t,e)}),mX={type:"fadeIn"},mK={type:"growCenterIn"};function mq(t,e){if(!1===e)return{};switch(e){case"fadeIn":return mX;case"scaleIn":return mK;default:return m$(t)}}let mQ=()=>{ig.registerAnimation("bar",(t,e)=>({appear:mq(t,e),enter:m$(t,!1),exit:mY(t,!1),disappear:mY(t)}))};var mJ=i(29624),m0=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class m1 extends pS{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cZ.Z)({},m1.defaultAttributes,m0(t,["data"]))))}labeling(t,e,i="top",r=0){if(!t||!e)return;let{x1:s,y1:n,x2:a,y2:l}=t,o=Math.abs(a-s),h=Math.abs(l-n),{x:u,y:d}=(0,ud.v1)(e,i),c=0,p=0,g=i.includes("inside");switch(i.includes("top")?p=g?1:-1:i.includes("bottom")?p=g?-1:1:i.includes("left")?c=g?1:-1:i.includes("right")&&(c=g?-1:1),i){case"top-right":case"bottom-right":c=-1;break;case"top-left":case"bottom-left":c=1}return{x:u+c*r+c*o/2,y:d+p*r+p*h/2}}}m1.tag="rect-label",m1.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};let m2=()=>{pA("rect",m1)};var m3=i(28651);class m5 extends oa{constructor(){super(...arguments),this.type=m5.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}m5.type="rect";let m4=()=>{(0,ol.W)(),(0,mJ.k)(),m2(),ig.registerMark(m5.type,m5),u4(),ig.registerGraphicComponent("rect",m3.f)},m7=Object.assign(Object.assign({},cd),{bar:{name:"bar",type:"rect"},barBackground:{name:"barBackground",type:"rect"}});function m6(t,e,i,r,s,n){let a=i.getSpec().barMinHeight,l=i[r.axisHelper].isInverse(),o=lr(i[r.startMethod](t),s),h=lr(i[r.endMethod](t),s);n&&(e=o);let u=Math.abs(o-h);u<a&&(u=a);let d=1;return h<o?d=-1:h===o&&(d=r.isVertical?l?1:-1:l?-1:1),h=e+d*u,t[r.start]=e,t[r.end]=h,h}class m9 extends cw{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){this._addMarkLabelSpec(t,"bar")}}class m8 extends cB{constructor(){super(...arguments),this.type=rw.bar,this._barMarkName="bar",this._barMarkType="rect",this.transformerConstructor=m9,this._bandPosition=0,this._getLinearBarRange=(t,e)=>{let[i,r]=[t,e].sort((t,e)=>t-e),s=r-i;if(this._spec.barGap){let t=.5*this._spec.barGap;i+=t,r-=t}let n=r-i,a=ew(this._spec.barMinWidth||2,s);if(n<a){let t=(a-n)/2;i-=t,r+=t}return[i,r]},this._getBarXStart=(t,e,i)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),t[cc]):this._spec.barMinHeight?this._calculateRectPosition(t,!1,i):lr(this._dataToPosX(t),e,i),this._getBarXEnd=(t,e,i)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),t[cp]):lr(this._dataToPosX1(t),e,i),this._getLinearBarXRange=(t,e,i)=>{let r=lr(this._dataToPosX(t),e,i),s=lr(this._dataToPosX1(t),e,i);return this._getLinearBarRange(r,s)},this._getBarYStart=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),t[cg]):this._spec.barMinHeight?this._calculateRectPosition(t,!0):lr(this._dataToPosY(t),e),this._getBarYEnd=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),t[cf]):lr(this._dataToPosY1(t),e),this._getLinearBarYRange=(t,e,i)=>{let r=lr(this._dataToPosY(t),e,i),s=lr(this._dataToPosY1(t),e,i);return this._getLinearBarRange(r,s)},this._getBarBackgroundXStart=t=>{let e=t.range();return Math.min(e[0],e[e.length-1])},this._getBarBackgroundXEnd=t=>{let e=t.range();return Math.max(e[0],e[e.length-1])},this._getBarBackgroundYStart=t=>{let e=t.range();return Math.min(e[0],e[e.length-1])},this._getBarBackgroundYEnd=t=>{let e=t.range();return Math.max(e[0],e[e.length-1])},this._getBarBackgroundPositionXEncoder=()=>{var t;return null==(t=this._barBackgroundPositionXEncoder)?void 0:t.bind(this)},this._setBarBackgroundPositionXEncoder=t=>{this._barBackgroundPositionXEncoder=t.bind(this)},this._getBarBackgroundPositionYEncoder=()=>{var t;return null==(t=this._barBackgroundPositionYEncoder)?void 0:t.bind(this)},this._setBarBackgroundPositionYEncoder=t=>{this._barBackgroundPositionYEncoder=t.bind(this)}}initMark(){this._initBarBackgroundMark(),this._barMark=this._createMark(Object.assign(Object.assign({},m8.mark.bar),{name:this._barMarkName,type:this._barMarkType}),{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0],morph:ck(this._spec,this._barMarkName)})}_initBarBackgroundMark(){this._spec.barBackground&&this._spec.barBackground.visible&&(this._barBackgroundMark=this._createMark(m8.mark.barBackground,{dataView:this._barBackgroundViewData.getDataView(),dataProductId:this._barBackgroundViewData.getProductId()}))}initMarkStyle(){this._barMark&&this.setMarkStyle(this._barMark,{fill:this.getColorAttribute()},"normal",H.Series)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null})}initTooltip(){super.initTooltip();let{mark:t,group:e}=this._tooltipHelper.activeTriggerSet;this._barMark&&(t.add(this._barMark),e.add(this._barMark))}_statisticViewData(){var t,e;let i;super._statisticViewData();let r=null!=(t=this._spec.barBackground)?t:{};if(!r.visible)return;let s=this._getRelatedComponentSpecInfo("axes").some(t=>t.type===rA.cartesianBandAxis);if(sY(this._option.dataSet,"addVChartProperty",dK),s)sY(this._option.dataSet,"dimensionItems",([t],{scaleDepth:e})=>{var i,r;let s=[{}],n=this.getDimensionField(),a=et(e)?n.length:Math.min(n.length,e);for(let e=0;e<a;e++){let a=n[e],l=null==(i=t.latestData[a])?void 0:i.values;if(!(null==l?void 0:l.length))continue;let o=[],h=null!=(r=this._spec.dataKey)?r:ni;for(let t=0;t<l.length;t++)for(let e=0;e<s.length;e++)o.push(Object.assign(Object.assign({},s[e]),{[a]:l[t],[h]:l[t]}));s=o}return s}),i=new er(this._option.dataSet).parse([this._viewDataStatistics],{type:"dataview"}).transform({type:"dimensionItems",options:{scaleDepth:et(r.fieldLevel)?void 0:r.fieldLevel+1}},!1).transform({type:"addVChartProperty",options:{beforeCall:cl.bind(this),call:co}},!1),null==(e=this._viewDataStatistics)||e.target.addListener("change",i.reRunAllTransform);else{sY(this._option.dataSet,"dimensionItems",([e])=>{let i=[],[r,s]=this.getDimensionContinuousField(),n={};return t.latestData.forEach(t=>{let e=`${t[r]}-${t[s]}`;n[e]||(n[e]={[r]:t[r],[s]:t[s]},i.push(n[e]))}),i});let t=this.getViewData();i=new er(this._option.dataSet).parse([t],{type:"dataview"}).transform({type:"dimensionItems"},!1).transform({type:"addVChartProperty",options:{beforeCall:cl.bind(this),call:co}},!1),null==t||t.target.addListener("change",i.reRunAllTransform)}this._barBackgroundViewData=new ly(this._option,i)}init(t){var e,i;super.init(t),"vertical"===this.direction?"band"===(null==(e=this._xAxisHelper)?void 0:e.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle():"band"===(null==(i=this._yAxisHelper)?void 0:i.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle()}_shouldDoPreCalculate(){let t=this.getRegion();return this.getStack()&&t.getSeries().filter(t=>t.type===this.type&&t.getSpec().barMinHeight).length}_calculateStackRectPosition(t){let e,i,r,s,n,a=this.getRegion();if(a._bar_series_position_calculated)return;a._bar_series_position_calculated=!0,t?(e=cf,i=cg,r="_dataToPosY1",s="_dataToPosY",n="_yAxisHelper"):(e=cp,i=cc,r="_dataToPosX1",s="_dataToPosX",n="_xAxisHelper");let l=dV(a,!1,t=>t.type===this.type);for(let o in l)for(let h in l[o].nodes)!function t(e,i,r){var s,n;if(e.values.length>0){let t;if(e.sortDatums.length){let a=e.sortDatums;i&&(a=e.sortDatums.slice().reverse());for(let e=0;e<a.length;e++)t=m6(a[e].datum,t,a[e].series,r,null==(n=(s=a[e].series[r.axisHelper]).getScale)?void 0:n.call(s,0),0===e)}else{let s=e.series;i&&(s=s.slice().reverse()),s.forEach(({s:e,values:s},n)=>{var a,l;let o=null==(l=(a=e[r.axisHelper]).getScale)?void 0:l.call(a,0);for(let a=0;a<s.length;a++)t=m6(s[i?s.length-1-a:a],t,e,r,o,0===a&&0===n)})}}for(let s in e.nodes)t(e.nodes[s],i,r)}(l[o].nodes[h],a.getStackInverse(),{isVertical:t,start:e,end:i,startMethod:r,endMethod:s,axisHelper:n})}_calculateRectPosition(t,e,i){var r,s;let n,a,l;e?(n="_dataToPosY1",a="_dataToPosY",l="_yAxisHelper"):(n="_dataToPosX1",a="_dataToPosX",l="_xAxisHelper");let o=null==(s=(r=this[l]).getScale)?void 0:s.call(r,0),h=this[l].isInverse(),u=this._spec.barMinHeight,d=lr(this[n](t),o,i),c=lr(this[a](t),o,i),p=Math.abs(d-c);p<u&&(p=u);let g=1;return c<d?g=-1:c===d&&(g=e?h?1:-1:h?-1:1),d+g*p}_dataToPosX(t){return this.dataToPositionX(t)}_dataToPosX1(t){return this.dataToPositionX1(t)}_dataToPosY(t){return this.dataToPositionY(t)}_dataToPosY1(t){return this.dataToPositionY1(t)}initBandRectMarkStyle(){var t,e,i,r;let s=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),n=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0);"horizontal"===this.direction?this.setMarkStyle(this._barMark,{x:t=>this._getBarXStart(t,s),x1:t=>this._getBarXEnd(t,s),y:t=>this._getPosition(this.direction,t),height:()=>this._getBarWidth(this._yAxisHelper),width:()=>{},y1:()=>{}},"normal",H.Series):this.setMarkStyle(this._barMark,{y:t=>this._getBarYStart(t,n),y1:t=>this._getBarYEnd(t,n),x:t=>this._getPosition(this.direction,t),width:()=>this._getBarWidth(this._xAxisHelper),x1:()=>{},height:()=>{}},"normal",H.Series),this._initStackBarMarkStyle(),this._initBandBarBackgroundMarkStyle()}_initStackBarMarkStyle(){var t,e,i,r;if(!this._spec.stackCornerRadius)return;let s=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),n=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0);this._barMark.setMarkConfig({clip:!0,clipPath:()=>{let t=[];return this._forEachStackGroup(e=>{let i=1/0,r=-1/0,a=!1,l=1/0,o=-1/0;e.values.forEach(t=>{let e=t[na],s=t[nl],n=t[no],h=t[nh];i=Math.min(i,e,s),r=Math.max(r,e,s),t5(n)&&t5(h)&&(a=!0,l=Math.min(l,n,h),o=Math.max(o,n,h))});let h=Object.assign(Object.assign(Object.assign({},e.values[0]),{[na]:i,[nl]:r}),a?{[no]:l,[nh]:o}:void 0),u="horizontal"===this.direction?{x:this._getBarXStart(h,s),x1:this._getBarXEnd(h,s),y:this._getPosition(this.direction,h),height:this._getBarWidth(this._yAxisHelper)}:{y:this._getBarYStart(h,n),y1:this._getBarYEnd(h,n),x:this._getPosition(this.direction,h),width:this._getBarWidth(this._xAxisHelper)};t.push((0,m3.f)(Object.assign(Object.assign({},u),{cornerRadius:tK(this._spec.stackCornerRadius)?this._spec.stackCornerRadius(u,h,this._markAttributeContext):this._spec.stackCornerRadius,fill:!0})))}),t}})}initLinearRectMarkStyle(){var t,e,i,r;let s=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),n=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0);if("horizontal"===this.direction){let t=t5(this._fieldY2)?{y:t=>this._getLinearBarYRange(t,n,!0)[0],y1:t=>this._getLinearBarYRange(t,n,!0)[1]}:{y:t=>lr(this._dataToPosY(t)-this._getBarWidth(this._yAxisHelper)/2,n,!0),height:t=>this._getBarWidth(this._yAxisHelper)};this.setMarkStyle(this._barMark,Object.assign({x:t=>this._getBarXStart(t,s,!0),x1:t=>this._getBarXEnd(t,s,!0)},t),"normal",H.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign({x:()=>this._getBarBackgroundXStart(s),x1:()=>this._getBarBackgroundXEnd(s)},t),"normal",H.Series)}else{let t=t5(this._fieldX2)?{x:t=>this._getLinearBarXRange(t,s,!0)[0],x1:t=>this._getLinearBarXRange(t,s,!0)[1]}:{x:t=>lr(this._dataToPosX(t)-this._getBarWidth(this._xAxisHelper)/2,s,!0),width:t=>this._getBarWidth(this._xAxisHelper)};this.setMarkStyle(this._barMark,Object.assign(Object.assign({},t),{y:t=>this._getBarYStart(t,n),y1:t=>this._getBarYEnd(t,n)}),"normal",H.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign(Object.assign({},t),{y:()=>this._getBarBackgroundYStart(n),y1:()=>this._getBarBackgroundYEnd(n)}),"normal",H.Series)}}_initBandBarBackgroundMarkStyle(){var t,e,i,r,s;if(!this._barBackgroundMark)return;let n=null==(e=null==(t=this._xAxisHelper)?void 0:t.getScale)?void 0:e.call(t,0),a=null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0),l=null!=(s=this._spec.barBackground)?s:{},o=et(l.fieldLevel)?void 0:l.fieldLevel+1;"horizontal"===this.direction?this.setMarkStyle(this._barBackgroundMark,{x:()=>this._getBarBackgroundXStart(n),x1:()=>this._getBarBackgroundXEnd(n),y:t=>this._getPosition(this.direction,t,o,"barBackground"),height:()=>this._getBarWidth(this._yAxisHelper,o),width:()=>{},y1:()=>{}},"normal",H.Series):this.setMarkStyle(this._barBackgroundMark,{x:t=>this._getPosition(this.direction,t,o,"barBackground"),y:()=>this._getBarBackgroundYStart(a),y1:()=>this._getBarBackgroundYEnd(a),width:()=>this._getBarWidth(this._xAxisHelper,o),x1:()=>{},height:()=>{}},"normal",H.Series)}initAnimation(){var t,e;let i={yField:this._fieldY[0],xField:this._fieldX[0],direction:this.direction,growFrom:()=>{var t;let e="horizontal"===this.direction?null==(t=this._xAxisHelper)?void 0:t.getScale(0):this._yAxisHelper.getScale(0);if(e){let t=e.domain(),i=ed(t),r=eu(t);return r<0?e.scale(r):i>0?e.scale(i):e.scale(0)}}},r=null==(t=this._spec.animationAppear)?void 0:t.preset,s=cE(this);this._barMark.setAnimationConfig(cv(null==(e=ig.getAnimationInKey("bar"))?void 0:e(i,r),cb(this._barMarkName,this._spec,this._markAttributeContext),s))}_getBarWidth(t,e){var i,r;let s=this._groups?this._groups.fields.length:1,n=et(e)?s:Math.min(s,e),a=null!=(r=null==(i=t.getBandwidth)?void 0:i.call(t,n-1))?r:6,l=t5(this._spec.barWidth)&&n===s,o=t5(this._spec.barMinWidth),h=t5(this._spec.barMaxWidth),u=a;return l&&(u=ew(this._spec.barWidth,a)),o&&(u=Math.max(u,ew(this._spec.barMinWidth,a))),h&&(u=Math.min(u,ew(this._spec.barMaxWidth,a))),u}_getPosition(t,e,i,r){var s,n,a,l,o;let h,u,d;"horizontal"===t?(h=this.getYAxisHelper(),u="height",d="barBackground"===r?this.dataToBarBackgroundPositionY.bind(this):this.dataToPositionY.bind(this)):(h=this.getXAxisHelper(),u="width",d="barBackground"===r?this.dataToBarBackgroundPositionX.bind(this):this.dataToPositionX.bind(this));let c=h.getScale(0),p=this._groups?this._groups.fields.length:1,g=et(i)?p:Math.min(p,i),f=null!=(n=null==(s=h.getBandwidth)?void 0:s.call(h,g-1))?n:6,m=g===p?this._barMark.getAttribute(u,e):f;if(g>1&&t5(this._spec.barGapInGroup)){let t=this._groups.fields,i=eo(this._spec.barGapInGroup),r=0,s=0;for(let n=t.length-1;n>=1;n--){let u=t[n],d=null!=(l=null==(a=h.getScale(n))?void 0:a.domain())?l:[],c=d.length,p=ew(null!=(o=i[n-1])?o:eh(i),f),g=d.indexOf(e[u]);n===t.length-1?(r+=c*m+(c-1)*p,s+=g*(m+p)):(s+=g*(r+p),r+=r+(c-1)*p)}return c.scale(e[t[0]])+h.getBandwidth(0)/2-r/2+s}let y=ai(c.type||"band");return d(e,g)+.5*(f-m)+(y?-f/2:0)}dataToBarBackgroundPositionX(t,e){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,e,this._getBarBackgroundPositionXEncoder,this._setBarBackgroundPositionXEncoder)}dataToBarBackgroundPositionY(t,e){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,e,this._getBarBackgroundPositionYEncoder,this._setBarBackgroundPositionYEncoder)}onLayoutEnd(){super.onLayoutEnd(),this.getRegion()._bar_series_position_calculated=!1,this._spec.sampling&&this.compile()}onDataUpdate(){super.onDataUpdate(),this.getRegion()._bar_series_position_calculated=!1}compile(){if(super.compile(),this._spec.sampling){let{width:t,height:e}=this._region.getLayoutRect(),i=this._fieldY,r=this._fieldX;this._data.setTransform([{type:"sampling",size:"horizontal"===this._direction?e:t,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?r[0]:i[0],groupBy:this._seriesField,mode:this._spec.sampling}])}}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._barMark]}compileData(){var t;super.compileData(),null==(t=this._barBackgroundViewData)||t.compile()}fillData(){var t,e;super.fillData(),null==(e=null==(t=this._barBackgroundViewData)?void 0:t.getDataView())||e.reRunAllTransform()}viewDataUpdate(t){var e,i,r;super.viewDataUpdate(t),null==(i=null==(e=this._barBackgroundViewData)?void 0:e.getDataView())||i.reRunAllTransform(),null==(r=this._barBackgroundViewData)||r.updateData()}release(){var t;super.release(),null==(t=this._barBackgroundViewData)||t.release(),this._barBackgroundViewData=null}}m8.type=rw.bar,m8.builtInTheme={bar:{label:{visible:!1,position:"outside",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}}},m8.mark=m7,m8.transformerConstructor=m9;let yt=()=>{fM(),m4(),mQ(),g8(),fc(),ig.registerSeries(m8.type,m8)};class ye extends fP{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barMinHeight","sampling","samplingFactor","barBackground","stackCornerRadius","useSequentialAnimation"])}transformSpec(t){super.transformSpec(t),nF(t)}_transformAxisSpec(t){var e,i;if(super._transformAxisSpec(t),!t.axes)return;let r=t.series.some(t=>"horizontal"===t.direction),s=null!=(e=t.axes.find(t=>"band"===t.type))?e:t.axes.find(t=>(r?["left","right"]:["top","bottom"]).includes(t.orient));if(s&&!s.bandSize&&!s.maxBandSize&&!s.minBandSize&&t.autoBandSize){let e=ey(t.autoBandSize)&&null!=(i=t.autoBandSize.extend)?i:0,{barMaxWidth:r,barMinWidth:n,barWidth:a,barGapInGroup:l}=t.series.find(t=>"bar"===t.type);this._applyAxisBandSize(s,e,{barMaxWidth:r,barMinWidth:n,barWidth:a,barGapInGroup:l})}}}class yi extends fF{constructor(){super(...arguments),this.transformerConstructor=ye,this.type="bar",this.seriesType=rw.bar}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}yi.type="bar",yi.seriesType=rw.bar,yi.transformerConstructor=ye,cD(yi,fH);let yr=()=>{mc(),mg(),mm(),fW(),yt(),f0(),ig.registerChart(yi.type,yi)},ys=t=>"string"==typeof t&&!isNaN(Number(t))&&!isNaN(parseFloat(t)),yn=[10,20],ya=U.Linear,yl="circle",yo=U.Ordinal,yh=["circle","square","triangle","diamond","star"],yu=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"},yd=()=>{ig.registerAnimation("scatter",(t,e)=>Object.assign({appear:yu(0,e)},uK))},yc=Object.assign(Object.assign({},cd),{point:{name:"point",type:"symbol"}});class yp extends cw{_transformLabelSpec(t){this._addMarkLabelSpec(t,"point")}}class yg extends cB{constructor(){super(...arguments),this.type=rw.scatter,this.transformerConstructor=yp,this._invalidType="zero"}setAttrFromSpec(){super.setAttrFromSpec(),this._size=this._spec.size,this._sizeField=this._spec.sizeField,this._shape=this._spec.shape,this._shapeField=this._spec.shapeField}_getSeriesAttribute(t,e,{defaultScaleType:i,defaultRange:r},s){var n,a,l,o;if(tK(e))return e;if(tY(e)){if(et(t))return null==(n=this._option)||n.onError(`${s}Field is required.`),e;if("ordinal"!==i&&e.length>2)return null==(a=this._option)||a.onError(`${s} length is invalid, specify up to 2 ${s}s.`),e;let r=`${s6}_series_scatter_${this.id}_scale_${s}`;return this._option.globalScale.registerModelScale({id:r,type:i,domain:[{dataId:this._rawData.name,fields:[t]}],range:e}),{scale:r,field:t}}if(ey(e)){if(et(t))return null==(l=this._option)||l.onError(`${s}Field is required.`),e;let n=Object.assign({id:`${s6}_series_scatter_${this.id}_scale_${s}`,type:i,domain:[{dataId:this._rawData.name,fields:[t]}],range:r},e);return this._option.globalScale.registerModelScale(n),{scale:n.id,field:t}}return null==(o=this._option)||o.onError(`${s} attribute is invalid.`),e}getSizeAttribute(t,e){return et(e)?10:tH(e)?e:t3(e)&&ys(e)?parseFloat(e):this._getSeriesAttribute(t,e,{defaultScaleType:ya,defaultRange:yn},"size")}getShapeAttribute(t,e){return et(e)?yl:t3(e)?e:this._getSeriesAttribute(t,e,{defaultScaleType:yo,defaultRange:yh},"shape")}initMark(){this._symbolMark=this._createMark(yg.mark.point,{groupKey:this._seriesField,isSeriesMark:!0},{morph:ck(this._spec,yg.mark.point.name),morphElementKey:this.getDimensionField()[0]})}initMarkStyle(){this.initSymbolMarkStyle()}initAnimation(){var t,e,i;let r=cE(this),s=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._symbolMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("scatter"))?void 0:i({},s),cb("point",this._spec,this._markAttributeContext),r))}initSymbolMarkStyle(){let t=this._symbolMark;t&&("zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)}),this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,fill:this.getColorAttribute(),size:tH(this._size)||tK(this._size)?this._size:10,symbolType:t3(this._shape)||tK(this._shape)?this._shape:yl},V.STATE_NORMAL,H.Series),(t5(this._sizeField)||t5(this._size))&&this.setMarkStyle(t,{size:this.getSizeAttribute(this._sizeField,this._size)},V.STATE_NORMAL,H.User_Mark),(t5(this._shapeField)||t5(this._shape))&&this.setMarkStyle(t,{symbolType:this.getShapeAttribute(this._shapeField,this._shape)},V.STATE_NORMAL,H.User_Mark))}initTooltip(){super.initTooltip(),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)}viewDataStatisticsUpdate(t){super.viewDataStatisticsUpdate(t);let e=[this.getDimensionField()[0],this.getStackValueField()].every(t=>{var e,i,r;return t&&(null==(r=null==(i=null==(e=this.getViewDataStatistics())?void 0:e.latestData)?void 0:i[t])?void 0:r.allValid)});"zero"===this._invalidType||e?this.setMarkStyle(this._symbolMark,{visible:!0},"normal",H.Series):this.setMarkStyle(this._symbolMark,{visible:this._getInvalidDefined.bind(this)},"normal",H.Series),this._symbolMark.getProduct()&&this._symbolMark.compileEncode()}initLabelMarkStyle(t){t&&(this._labelMark=t,this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null},V.STATE_NORMAL,H.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},V.STATE_NORMAL,H.Series))}handleZoom(t){var e,i;this.getMarksWithoutRoot().forEach(t=>{if(!t)return;let e=t.getGraphics();e&&e.length&&e.forEach((t,e)=>{var i,r;let s=null==(r=null==(i=null==t?void 0:t.context)?void 0:i.data)?void 0:r[0],n=this.dataToPosition(s);n&&t&&t.translateTo(n.x,n.y)})});let r=null==(i=null==(e=this._labelMark)?void 0:e.getComponent())?void 0:i.getProduct();r&&r.evaluate(null,null)}handlePan(t){this.handleZoom(t)}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._symbolMark]}}yg.type=rw.scatter,yg.mark=yc,yg.builtInTheme={scatter:{point:{style:{size:8,symbolType:"circle",lineWidth:0,fillOpacity:.8}},label:{visible:!1,offset:5,position:"top",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}}},yg.transformerConstructor=yp;let yf=()=>{pF(),yd(),g8(),fc(),ig.registerSeries(yg.type,yg)};class ym extends fP{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["point","size","shape","shapeField","sizeField"])}}class yy extends fF{constructor(){super(...arguments),this.transformerConstructor=ym,this.type="scatter",this.seriesType=rw.scatter}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}yy.type="scatter",yy.seriesType=rw.scatter,yy.transformerConstructor=ym,cD(yy,fH);let y_=()=>{mc(),mg(),f0(),fW(),yf(),ig.registerChart(yy.type,yy)};class yv{constructor(t=1,e=0,i=0,r=1,s=0,n=0){this.a=t,this.b=e,this.c=i,this.d=r,this.e=s,this.f=n}equalToMatrix(t){return this.e===t.e&&this.f===t.f&&this.a===t.a&&this.d===t.d&&this.b===t.b&&this.c===t.c}equalTo(t,e,i,r,s,n){return this.e===s&&this.f===n&&this.a===t&&this.d===r&&this.b===e&&this.c===i}setValue(t,e,i,r,s,n){return this.a=t,this.b=e,this.c=i,this.d=r,this.e=s,this.f=n,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){let t=this.a,e=this.b,i=this.c,r=this.d,s=this.e,n=this.f,a=new yv,l=t*r-e*i;return a.a=r/l,a.b=-e/l,a.c=-i/l,a.d=t/l,a.e=(i*n-r*s)/l,a.f=-(t*n-e*s)/l,a}rotate(t){let e=Math.cos(t),i=Math.sin(t),r=this.a*e+this.c*i,s=this.b*e+this.d*i,n=-(this.a*i)+this.c*e,a=-(this.b*i)+this.d*e;return this.a=r,this.b=s,this.c=n,this.d=a,this}rotateByCenter(t,e,i){let r=Math.cos(t),s=Math.sin(t),n=r*this.a-s*this.b,a=s*this.a+r*this.b,l=r*this.c-s*this.d,o=s*this.c+r*this.d,h=r*this.e-s*this.f+((1-r)*e+s*i),u=s*this.e+r*this.f+((1-r)*i-s*e);return this.a=n,this.b=a,this.c=l,this.d=o,this.e=h,this.f=u,this}scale(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}setScale(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}transform(t,e,i,r,s,n){return this.multiply(t,e,i,r,s,n),this}translate(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}transpose(){let{a:t,b:e,c:i,d:r,e:s,f:n}=this;return this.a=e,this.b=t,this.c=r,this.d=i,this.e=n,this.f=s,this}multiply(t,e,i,r,s,n){let a=this.a,l=this.b,o=this.c,h=this.d,u=a*s+o*n+this.e,d=l*s+h*n+this.f;return this.a=a*t+o*e,this.b=l*t+h*e,this.c=a*i+o*r,this.d=l*i+h*r,this.e=u,this.f=d,this}interpolate(t,e){let i=new yv;return i.a=this.a+(t.a-this.a)*e,i.b=this.b+(t.b-this.b)*e,i.c=this.c+(t.c-this.c)*e,i.d=this.d+(t.d-this.d)*e,i.e=this.e+(t.e-this.e)*e,i.f=this.f+(t.f-this.f)*e,i}transformPoint(t,e){let{a:i,b:r,c:s,d:n,e:a,f:l}=this,o=i*n-r*s,{x:h,y:u}=t;e.x=n/o*h+-s/o*u+(s*l-n*a)/o,e.y=-r/o*h+i/o*u+-(i*l-r*a)/o}onlyTranslate(t=1){return this.a===t&&0===this.b&&0===this.c&&this.d===t}clone(){return new yv(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){let t=this.a,e=this.b,i=this.c,r=this.d,s=t*r-e*i,n={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){let a=Math.sqrt(t*t+e*e);n.rotateDeg=e>0?Math.acos(t/a):-Math.acos(t/a),n.scaleX=a,n.scaleY=s/a,n.skewX=(t*i+e*r)/s,n.skewY=0}else if(0!==i||0!==r){let a=Math.sqrt(i*i+r*r);n.rotateDeg=Math.PI/2-(r>0?Math.acos(-i/a):-Math.acos(i/a)),n.scaleX=s/a,n.scaleY=a,n.skewX=0,n.skewY=(t*i+e*r)/s}return n.rotateDeg=ld(n.rotateDeg),n}}let yb=(t,e)=>{let i;if(!e.from||!e.from())return t;let r=e.fields,s=e.key,n=e.values,a=e.default,l=e.as||[r],o=e.from().reduce(function(t,e){return e[r]&&t.set(e[r],e),t},new Map);if(tK(e.set))i=function(t){let i=o.get(t[s]);e.set(t,i)};else if(n){let t=n.length;i=function(e){let i=o.get(e[s]);if(et(i))for(let i=0;i<t;++i)e[l[i]]=a;else for(let r=0;r<t;++r)e[l[r]]=i[n[r]]}}else i=function(t){let e=o.get(t[s]);t[l[0]]=t5(e)?e:a};return 0===t.length?[]:t.map(t=>(i(t),t))};class yx extends cT{constructor(){super(...arguments),this.type=rw.geo,this.coordinate="geo",this._nameProperty="name"}getMapViewData(){var t;return null==(t=this._mapViewData)?void 0:t.getDataView()}get nameField(){return this._nameField}set nameField(t){this._nameField=t}get valueField(){return this._valueField}set valueField(t){this._valueField=t}getNameProperty(){return this._nameProperty}getCentroidProperty(){return this._centroidProperty}getCoordinateHelper(){return this._coordinateHelper}setCoordinateHelper(t){this._coordinateHelper=t}getStatisticFields(){let t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}getGroupFields(){return null}dataToPosition(t,e){var i;let r=null;if(!t||e&&!this.isDatumInViewData(t))return r;let{dataToPosition:s,latitudeField:n,longitudeField:a}=this._coordinateHelper;if(null===(r=this.nameToPosition(t))){let e=a?null==t?void 0:t[a]:Number.NaN,l=n?null==t?void 0:t[n]:Number.NaN;r=null!=(i=null==s?void 0:s([e,l]))?i:null}return r}nameToPosition(t){let e=this.getDatumName(t);return et(e)?null:this.nameValueToPosition(e)}nameValueToPosition(t){var e,i;let r=null==(i=null==(e=this.getMapViewData())?void 0:e.latestData)?void 0:i.filter(e=>this.getDatumName(e)===t)[0];if(et(r))return null;let{dataToPosition:s}=this._coordinateHelper,n=this.getDatumCenter(r),a=null==s?void 0:s(n);return et(a)||isNaN(a.x)||isNaN(a.y)?null:a}dataToLatitude(t){if(!this._coordinateHelper)return Number.NaN;let{dataToLatitude:e}=this._coordinateHelper;return e(t)}dataToLongitude(t){if(!this._coordinateHelper)return Number.NaN;let{dataToLatitude:e}=this._coordinateHelper;return e(t)}valueToPosition(t,e){return{x:this.dataToLongitude(t),y:this.dataToLatitude(e)}}positionToData(t){}latitudeToData(t){}longitudeToData(t){}dataToPositionX(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}dataToPositionY(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}dataToPositionZ(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}release(){super.release(),this._mapViewData.release(),this._mapViewData=this._mapViewDataStatistics=null}getStackGroupFields(){return[this._nameField]}getStackValueField(){return this._spec.valueField}compileData(){var t;null==(t=this._mapViewData)||t.compile()}initStatisticalData(){if(super.initStatisticalData(),this._mapViewData){let t=`${s6}_series_${this.id}_mapViewDataStatic`;this._mapViewDataStatistics=this.createStatisticalData(t,this._mapViewData.getDataView()),this._mapViewData.getDataView().target.removeListener("change",this._mapViewDataStatistics.reRunAllTransform)}}getSeriesKeys(){var t,e,i,r,s;return this._seriesField?null!=(s=null!=(e=null==(t=this.getRawDataStatisticsByField(this._seriesField))?void 0:t.values)?e:null==(r=null==(i=this._mapViewDataStatistics)?void 0:i.latestData[this._seriesField])?void 0:r.values)?s:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}fillData(){var t,e;super.fillData(),null==(t=this._mapViewData.getDataView())||t.reRunAllTransform(),null==(e=this._mapViewDataStatistics)||e.reRunAllTransform()}getActiveMarks(){return[]}}let yS=`${s6}_MAP_LOOK_UP_KEY`,yk=(t,e)=>(t.features&&t.features.forEach((t,i)=>{var r;t[ne]=i;let s=null==(r=t.properties)?void 0:r[e.nameProperty];e.nameMap&&e.nameMap[s]?t[yS]=e.nameMap[s]:t[yS]=s}),t.features);class yA extends d8{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=t=>{var e;let i=this.series;return null!=(e=this._getDimensionData(t))?e:i.getDatumName(t)}}}var yM=i(81428),yw=i(88110);class yT extends oa{constructor(){super(...arguments),this.type=yT.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0,path:""})}}yT.type="path";let yC=()=>{ig.registerMark(yT.type,yT),(0,ol.W)(),(0,yM.N)(),ig.registerGraphicComponent("path",yw.E)},yE=Object.assign(Object.assign({},cd),{area:{name:"area",type:"path"}});function yB(){var t,e=[];return{point:function(e,i,r){t.push([e,i,r])},lineStart:function(){e.push(t=[])},lineEnd:rc,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function yP(t,e){return 1e-6>i8(t[0]-e[0])&&1e-6>i8(t[1]-e[1])}function yO(t,e,i,r){this.x=t,this.z=e,this.o=i,this.e=r,this.v=!1,this.n=this.p=null}function yI(t,e,i,r,s){var n,a,l=[],o=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,i,r=t[0],a=t[e];if(yP(r,a)){if(!r[2]&&!a[2]){for(s.lineStart(),n=0;n<e;++n)s.point((r=t[n])[0],r[1]);s.lineEnd();return}a[0]+=2e-6}l.push(i=new yO(r,t,null,!0)),o.push(i.o=new yO(r,null,i,!1)),l.push(i=new yO(a,t,null,!1)),o.push(i.o=new yO(a,null,i,!0))}}),l.length){for(o.sort(e),yR(l),yR(o),n=0,a=o.length;n<a;++n)o[n].e=i=!i;for(var h,u,d=l[0];;){for(var c=d,p=!0;c.v;)if((c=c.n)===d)return;h=c.z,s.lineStart();do{if(c.v=c.o.v=!0,c.e){if(p)for(n=0,a=h.length;n<a;++n)s.point((u=h[n])[0],u[1]);else r(c.x,c.n.x,1,s);c=c.n}else{if(p)for(n=(h=c.p.z).length-1;n>=0;--n)s.point((u=h[n])[0],u[1]);else r(c.x,c.p.x,-1,s);c=c.p}h=(c=c.o).z,p=!p}while(!c.v);s.lineEnd()}}}function yR(t){if(e=t.length){for(var e,i,r=0,s=t[0];++r<e;)s.n=i=t[r],i.p=s,s=i;s.n=i=t[0],i.p=s}}function yL(t){return[re(t[1],t[0]),rd(t[2])]}function yD(t){var e=t[0],i=t[1],r=ri(i);return[r*ri(e),r*ra(e),ra(i)]}function yF(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function yz(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function yj(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function yH(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function yN(t){var e=ro(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var yV=new i0;function yW(t){return i8(t[0])<=i3?t[0]:rl(t[0])*((i8(t[0])+i3)%i7-i3)}function yU(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var yG=(1===(B=yU).length&&(n=B,B=function(t,e){return yU(n(t),e)}),{left:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var s=i+r>>>1;0>B(t[s],e)?i=s+1:r=s}return i},right:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var s=i+r>>>1;B(t[s],e)>0?r=s:i=s+1}return i}});yG.right,yG.left;var yZ=Array.prototype;function y$(t){for(var e,i,r,s=t.length,n=-1,a=0;++n<s;)a+=t[n].length;for(i=Array(a);--s>=0;)for(e=(r=t[s]).length;--e>=0;)i[--a]=r[e];return i}function yY(t,e,i,r){return function(s){var n,a,l,o=e(s),h=yB(),u=e(h),d=!1,c={point:p,lineStart:f,lineEnd:m,polygonStart:function(){c.point=y,c.lineStart=_,c.lineEnd=v,a=[],n=[]},polygonEnd:function(){c.point=p,c.lineStart=f,c.lineEnd=m,a=y$(a);var t=function(t,e){var i=yW(e),r=e[1],s=ra(r),n=[ra(i),-ri(i),0],a=0,l=0;yV.reset(),1===s?r=i5+1e-6:-1===s&&(r=-i5-1e-6);for(var o=0,h=t.length;o<h;++o)if(d=(u=t[o]).length)for(var u,d,c=u[d-1],p=yW(c),g=c[1]/2+i4,f=ra(g),m=ri(g),y=0;y<d;++y,p=v,f=x,m=S,c=_){var _=u[y],v=yW(_),b=_[1]/2+i4,x=ra(b),S=ri(b),k=v-p,A=k>=0?1:-1,M=A*k,w=M>i3,T=f*x;if(yV.add(re(T*A*ra(M),m*S+T*ri(M))),a+=w?k+A*i7:k,w^p>=i^v>=i){var C=yz(yD(c),yD(_));yN(C);var E=yz(n,C);yN(E);var B=(w^k>=0?-1:1)*rd(E[2]);(r>B||r===B&&(C[0]||C[1]))&&(l+=w^k>=0?1:-1)}}return(a<-1e-6||a<1e-6&&yV<-1e-6)^1&l}(n,r);a.length?(d||(s.polygonStart(),d=!0),yI(a,yK,t,i,s)):t&&(d||(s.polygonStart(),d=!0),s.lineStart(),i(null,null,1,s),s.lineEnd()),d&&(s.polygonEnd(),d=!1),a=n=null},sphere:function(){s.polygonStart(),s.lineStart(),i(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function p(e,i){t(e,i)&&s.point(e,i)}function g(t,e){o.point(t,e)}function f(){c.point=g,o.lineStart()}function m(){c.point=p,o.lineEnd()}function y(t,e){l.push([t,e]),u.point(t,e)}function _(){u.lineStart(),l=[]}function v(){y(l[0][0],l[0][1]),u.lineEnd();var t,e,i,r,o=u.clean(),c=h.result(),p=c.length;if(l.pop(),n.push(l),l=null,p){if(1&o){if((e=(i=c[0]).length-1)>0){for(d||(s.polygonStart(),d=!0),s.lineStart(),t=0;t<e;++t)s.point((r=i[t])[0],r[1]);s.lineEnd()}return}p>1&&2&o&&c.push(c.pop().concat(c.shift())),a.push(c.filter(yX))}}return c}}function yX(t){return t.length>1}function yK(t,e){return((t=t.x)[0]<0?t[1]-i5-1e-6:i5-t[1])-((e=e.x)[0]<0?e[1]-i5-1e-6:i5-e[1])}yZ.slice,yZ.map;let yq=yY(function(){return!0},function(t){var e,i=NaN,r=NaN,s=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(n,a){var l,o,h,u,d,c,p,g=n>0?i3:-i3,f=i8(n-i);1e-6>i8(f-i3)?(t.point(i,r=(r+a)/2>0?i5:-i5),t.point(s,r),t.lineEnd(),t.lineStart(),t.point(g,r),t.point(n,r),e=0):s!==g&&f>=i3&&(1e-6>i8(i-s)&&(i-=1e-6*s),1e-6>i8(n-g)&&(n-=1e-6*g),l=i,o=r,h=n,u=a,r=i8(p=ra(l-h))>1e-6?rt((ra(o)*(c=ri(u))*ra(h)-ra(u)*(d=ri(o))*ra(l))/(d*c*p)):(o+u)/2,t.point(s,r),t.lineEnd(),t.lineStart(),t.point(g,r),e=0),t.point(i=n,r=a),s=g},lineEnd:function(){t.lineEnd(),i=r=NaN},clean:function(){return 2-e}}},function(t,e,i,r){var s;if(null==t)s=i*i5,r.point(-i3,s),r.point(0,s),r.point(i3,s),r.point(i3,0),r.point(i3,-s),r.point(0,-s),r.point(-i3,-s),r.point(-i3,0),r.point(-i3,s);else if(i8(t[0]-e[0])>1e-6){var n=t[0]<e[0]?i3:-i3;s=i*n/2,r.point(-n,s),r.point(0,s),r.point(n,s)}else r.point(e[0],e[1])},[-i3,-i5]);function yQ(t,e){e=yD(e),e[0]-=t,yN(e);var i=ru(-e[1]);return((0>-e[2]?-i:i)+i7-1e-6)%i7}function yJ(t,e,i,r){function s(s,n){return t<=s&&s<=i&&e<=n&&n<=r}function n(s,n,l,h){var u=0,d=0;if(null==s||(u=a(s,l))!==(d=a(n,l))||0>o(s,n)^l>0)do h.point(0===u||3===u?t:i,u>1?r:e);while((u=(u+l+4)%4)!==d);else h.point(n[0],n[1])}function a(r,s){return 1e-6>i8(r[0]-t)?s>0?0:3:1e-6>i8(r[0]-i)?s>0?2:1:1e-6>i8(r[1]-e)?+(s>0):s>0?3:2}function l(t,e){return o(t.x,e.x)}function o(t,e){var i=a(t,1),r=a(e,1);return i!==r?i-r:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(a){var o,h,u,d,c,p,g,f,m,y,_,v=a,b=yB(),x={point:S,lineStart:function(){x.point=k,h&&h.push(u=[]),y=!0,m=!1,g=f=NaN},lineEnd:function(){o&&(k(d,c),p&&m&&b.rejoin(),o.push(b.result())),x.point=S,m&&v.lineEnd()},polygonStart:function(){v=b,o=[],h=[],_=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,s=h.length;i<s;++i)for(var n,a,l=h[i],o=1,u=l.length,d=l[0],c=d[0],p=d[1];o<u;++o)n=c,a=p,c=(d=l[o])[0],p=d[1],a<=r?p>r&&(c-n)*(r-a)>(p-a)*(t-n)&&++e:p<=r&&(c-n)*(r-a)<(p-a)*(t-n)&&--e;return e}(),i=_&&e,s=(o=y$(o)).length;(i||s)&&(a.polygonStart(),i&&(a.lineStart(),n(null,null,1,a),a.lineEnd()),s&&yI(o,l,e,n,a),a.polygonEnd()),v=a,o=h=u=null}};function S(t,e){s(t,e)&&v.point(t,e)}function k(n,a){var l=s(n,a);if(h&&u.push([n,a]),y)d=n,c=a,p=l,y=!1,l&&(v.lineStart(),v.point(n,a));else if(l&&m)v.point(n,a);else{var o=[g=Math.max(-1e9,Math.min(1e9,g)),f=Math.max(-1e9,Math.min(1e9,f))],b=[n=Math.max(-1e9,Math.min(1e9,n)),a=Math.max(-1e9,Math.min(1e9,a))];!function(t,e,i,r,s,n){var a,l=t[0],o=t[1],h=e[0],u=e[1],d=0,c=1,p=h-l,g=u-o;if(a=i-l,!p&&a>0)return;if(a/=p,p<0){if(a<d)return;a<c&&(c=a)}else if(p>0){if(a>c)return;a>d&&(d=a)}if(a=s-l,p||!(a<0)){if(a/=p,p<0){if(a>c)return;a>d&&(d=a)}else if(p>0){if(a<d)return;a<c&&(c=a)}if(a=r-o,g||!(a>0)){if(a/=g,g<0){if(a<d)return;a<c&&(c=a)}else if(g>0){if(a>c)return;a>d&&(d=a)}if(a=n-o,g||!(a<0)){if(a/=g,g<0){if(a>c)return;a>d&&(d=a)}else if(g>0){if(a<d)return;a<c&&(c=a)}return d>0&&(t[0]=l+d*p,t[1]=o+d*g),c<1&&(e[0]=l+c*p,e[1]=o+c*g),!0}}}}(o,b,t,e,i,r)?l&&(v.lineStart(),v.point(n,a),_=!1):(m||(v.lineStart(),v.point(o[0],o[1])),v.point(b[0],b[1]),l||v.lineEnd(),_=!1)}g=n,f=a,m=l}return x}}function y0(t,e){function i(i,r){return e((i=t(i,r))[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,r){return(i=e.invert(i,r))&&t.invert(i[0],i[1])}),i}function y1(t,e){return[i8(t)>i3?t+Math.round(-t/i7)*i7:t,e]}function y2(t,e,i){return(t%=i7)?e||i?y0(y5(t),y4(e,i)):y5(t):e||i?y4(e,i):y1}function y3(t){return function(e,i){return[(e+=t)>i3?e-i7:e<-i3?e+i7:e,i]}}function y5(t){var e=y3(t);return e.invert=y3(-t),e}function y4(t,e){var i=ri(t),r=ra(t),s=ri(e),n=ra(e);function a(t,e){var a=ri(e),l=ri(t)*a,o=ra(t)*a,h=ra(e),u=h*i+l*r;return[re(o*s-u*n,l*i-h*r),rd(u*s+o*n)]}return a.invert=function(t,e){var a=ri(e),l=ri(t)*a,o=ra(t)*a,h=ra(e),u=h*s-o*n;return[re(o*s+h*n,l*i+u*r),rd(u*i-l*r)]},a}function y7(t){return function(e){var i=new y6;for(var r in t)i[r]=t[r];return i.stream=e,i}}function y6(){}function y9(t,e,i){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),iJ(i,t.stream(rY)),e(rY.result()),null!=r&&t.clipExtent(r),t}function y8(t,e,i){return y9(t,function(i){var r=e[1][0]-e[0][0],s=e[1][1]-e[0][1],n=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+e[0][0]+(r-n*(i[1][0]+i[0][0]))/2,l=+e[0][1]+(s-n*(i[1][1]+i[0][1]))/2;t.scale(150*n).translate([a,l])},i)}function _t(t,e,i){return y8(t,[[0,0],e],i)}function _e(t,e,i){return y9(t,function(i){var r=+e,s=r/(i[1][0]-i[0][0]),n=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];t.scale(150*s).translate([n,a])},i)}function _i(t,e,i){return y9(t,function(i){var r=+e,s=r/(i[1][1]-i[0][1]),n=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;t.scale(150*s).translate([n,a])},i)}y1.invert=y1,y6.prototype={constructor:y6,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var _r=ri(30*i9);function _s(t,e){var i;return+e?function(t,e){function i(r,s,n,a,l,o,h,u,d,c,p,g,f,m){var y=h-r,_=u-s,v=y*y+_*_;if(v>4*e&&f--){var b=a+c,x=l+p,S=o+g,k=ro(b*b+x*x+S*S),A=rd(S/=k),M=1e-6>i8(i8(S)-1)||1e-6>i8(n-d)?(n+d)/2:re(x,b),w=t(M,A),T=w[0],C=w[1],E=T-r,B=C-s,P=_*E-y*B;(P*P/v>e||i8((y*E+_*B)/v-.5)>.3||a*c+l*p+o*g<_r)&&(i(r,s,n,a,l,o,T,C,M,b/=k,x/=k,S,f,m),m.point(T,C),i(T,C,M,b,x,S,h,u,d,c,p,g,f,m))}}return function(e){var r,s,n,a,l,o,h,u,d,c,p,g,f={point:m,lineStart:y,lineEnd:v,polygonStart:function(){e.polygonStart(),f.lineStart=b},polygonEnd:function(){e.polygonEnd(),f.lineStart=y}};function m(i,r){i=t(i,r),e.point(i[0],i[1])}function y(){u=NaN,f.point=_,e.lineStart()}function _(r,s){var n=yD([r,s]),a=t(r,s);i(u,d,h,c,p,g,u=a[0],d=a[1],h=r,c=n[0],p=n[1],g=n[2],16,e),e.point(u,d)}function v(){f.point=m,e.lineEnd()}function b(){y(),f.point=x,f.lineEnd=S}function x(t,e){_(r=t,e),s=u,n=d,a=c,l=p,o=g,f.point=_}function S(){i(u,d,h,c,p,g,s,n,r,a,l,o,16,e),f.lineEnd=v,v()}return f}}(t,e):(i=t,y7({point:function(t,e){t=i(t,e),this.stream.point(t[0],t[1])}}))}var _n=y7({point:function(t,e){this.stream.point(t*i9,e*i9)}});function _a(t,e,i,r,s,n){var a=ri(n),l=ra(n),o=a*t,h=l*t,u=a/t,d=l/t,c=(l*i-a*e)/t,p=(l*e+a*i)/t;function g(t,n){return[o*(t*=r)-h*(n*=s)+e,i-h*t-o*n]}return g.invert=function(t,e){return[r*(u*t-d*e+c),s*(p-d*t-u*e)]},g}function _l(t){return _o(function(){return t})()}function _o(t){var e,i,r,s,n,a,l,o,h,u,d=150,c=480,p=250,g=0,f=0,m=0,y=0,_=0,v=0,b=1,x=1,S=null,k=yq,A=null,M=i$,w=.5;function T(t){return o(t[0]*i9,t[1]*i9)}function C(t){return(t=o.invert(t[0],t[1]))&&[t[0]*i6,t[1]*i6]}function E(){var t=_a(d,0,0,b,x,v).apply(null,e(g,f)),r=(v?_a:function(t,e,i,r,s){function n(n,a){return[e+t*(n*=r),i-t*(a*=s)]}return n.invert=function(n,a){return[(n-e)/t*r,(i-a)/t*s]},n})(d,c-t[0],p-t[1],b,x,v);return i=y2(m,y,_),l=y0(e,r),o=y0(i,l),a=_s(l,w),B()}function B(){return h=u=null,T}return T.stream=function(t){var e;return h&&u===t?h:h=_n((e=i,y7({point:function(t,i){var r=e(t,i);return this.stream.point(r[0],r[1])}}))(k(a(M(u=t)))))},T.preclip=function(t){return arguments.length?(k=t,S=void 0,B()):k},T.postclip=function(t){return arguments.length?(M=t,A=r=s=n=null,B()):M},T.clipAngle=function(t){return arguments.length?(k=+t?function(t){var e=ri(t),i=6*i9,r=e>0,s=i8(e)>1e-6;function n(t,i){return ri(t)*ri(i)>e}function a(t,i,r){var s=yD(t),n=yD(i),a=[1,0,0],l=yz(s,n),o=yF(l,l),h=l[0],u=o-h*h;if(!u)return!r&&t;var d=yz(a,l),c=yH(a,e*o/u);yj(c,yH(l,-e*h/u));var p=yF(c,d),g=yF(d,d),f=p*p-g*(yF(c,c)-1);if(!(f<0)){var m=ro(f),y=yH(d,(-p-m)/g);if(yj(y,c),y=yL(y),!r)return y;var _,v=t[0],b=i[0],x=t[1],S=i[1];b<v&&(_=v,v=b,b=_);var k=b-v,A=1e-6>i8(k-i3);if(!A&&S<x&&(_=x,x=S,S=_),A||k<1e-6?A?x+S>0^y[1]<(1e-6>i8(y[0]-v)?x:S):x<=y[1]&&y[1]<=S:k>i3^(v<=y[0]&&y[0]<=b)){var M=yH(d,(-p+m)/g);return yj(M,c),[y,yL(M)]}}}function l(e,i){var s=r?t:i3-t,n=0;return e<-s?n|=1:e>s&&(n|=2),i<-s?n|=4:i>s&&(n|=8),n}return yY(n,function(t){var e,i,o,h,u;return{lineStart:function(){h=o=!1,u=1},point:function(d,c){var p,g,f=[d,c],m=n(d,c),y=r?m?0:l(d,c):m?l(d+(d<0?i3:-i3),c):0;!e&&(h=o=m)&&t.lineStart(),m!==o&&(!(g=a(e,f))||yP(e,g)||yP(f,g))&&(f[2]=1),m!==o?(u=0,m?(t.lineStart(),g=a(f,e),t.point(g[0],g[1])):(g=a(e,f),t.point(g[0],g[1],2),t.lineEnd()),e=g):s&&e&&r^m&&!(y&i)&&(p=a(f,e,!0))&&(u=0,r?(t.lineStart(),t.point(p[0][0],p[0][1]),t.point(p[1][0],p[1][1]),t.lineEnd()):(t.point(p[1][0],p[1][1]),t.lineEnd(),t.lineStart(),t.point(p[0][0],p[0][1],3))),!m||e&&yP(e,f)||t.point(f[0],f[1]),e=f,o=m,i=y},lineEnd:function(){o&&t.lineEnd(),e=null},clean:function(){return u|(h&&o)<<1}}},function(e,r,s,n){!function(t,e,i,r,s,n){if(i){var a=ri(e),l=ra(e),o=r*i;null==s?(s=e+r*i7,n=e-o/2):(s=yQ(a,s),n=yQ(a,n),(r>0?s<n:s>n)&&(s+=r*i7));for(var h,u=s;r>0?u>n:u<n;u-=o)h=yL([a,-l*ri(u),-l*ra(u)]),t.point(h[0],h[1])}}(n,t,i,s,e,r)},r?[0,-t]:[-i3,t-i3])}(S=t*i9):(S=null,yq),B()):S*i6},T.clipExtent=function(t){return arguments.length?(M=null==t?(A=r=s=n=null,i$):yJ(A=+t[0][0],r=+t[0][1],s=+t[1][0],n=+t[1][1]),B()):null==A?null:[[A,r],[s,n]]},T.scale=function(t){return arguments.length?(d=+t,E()):d},T.translate=function(t){return arguments.length?(c=+t[0],p=+t[1],E()):[c,p]},T.center=function(t){return arguments.length?(g=t[0]%360*i9,f=t[1]%360*i9,E()):[g*i6,f*i6]},T.rotate=function(t){return arguments.length?(m=t[0]%360*i9,y=t[1]%360*i9,_=t.length>2?t[2]%360*i9:0,E()):[m*i6,y*i6,_*i6]},T.angle=function(t){return arguments.length?(v=t%360*i9,E()):v*i6},T.reflectX=function(t){return arguments.length?(b=t?-1:1,E()):b<0},T.reflectY=function(t){return arguments.length?(x=t?-1:1,E()):x<0},T.precision=function(t){return arguments.length?(a=_s(l,w=t*t),B()):ro(w)},T.fitExtent=function(t,e){return y8(T,t,e)},T.fitSize=function(t,e){return _t(T,t,e)},T.fitWidth=function(t,e){return _e(T,t,e)},T.fitHeight=function(t,e){return _i(T,t,e)},function(){return e=t.apply(this,arguments),T.invert=e.invert&&C,E()}}function _h(t){var e=0,i=i3/3,r=_o(t),s=r(e,i);return s.parallels=function(t){return arguments.length?r(e=t[0]*i9,i=t[1]*i9):[e*i6,i*i6]},s}function _u(t,e){var i=ra(t),r=(i+ra(e))/2;if(1e-6>i8(r)){var s=ri(t);function n(t,e){return[t*s,ra(e)/s]}return n.invert=function(t,e){return[t/s,rd(e*s)]},n}var a=1+i*(2*r-i),l=ro(a)/r;function o(t,e){var i=ro(a-2*r*ra(e))/r;return[i*ra(t*=r),l-i*ri(t)]}return o.invert=function(t,e){var i=l-e,s=re(t,i8(i))*rl(i);return i*r<0&&(s-=i3*rl(t)*rl(i)),[s/r,rd((a-(t*t+i*i)*r*r)/(2*r))]},o}function _d(){return _h(_u).scale(155.424).center([0,33.6442])}function _c(){return _d().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function _p(t){return function(e,i){var r=ri(e),s=ri(i),n=t(r*s);return[n*s*ra(e),n*ra(i)]}}function _g(t){return function(e,i){var r=ro(e*e+i*i),s=t(r),n=ra(s);return[re(e*n,r*ri(s)),rd(r&&i*n/r)]}}var _f=_p(function(t){return ro(2/(1+t))});_f.invert=_g(function(t){return 2*rd(t/2)});var _m=_p(function(t){return(t=ru(t))&&t/ra(t)});function _y(t,e){return[t,rs(rh((i5+e)/2))]}function __(t){var e,i,r,s=_l(t),n=s.center,a=s.scale,l=s.translate,o=s.clipExtent,h=null;function u(){var n=i3*a(),l=s((function(t){function e(e){return e=t(e[0]*i9,e[1]*i9),e[0]*=i6,e[1]*=i6,e}return t=y2(t[0]*i9,t[1]*i9,t.length>2?t[2]*i9:0),e.invert=function(e){return e=t.invert(e[0]*i9,e[1]*i9),e[0]*=i6,e[1]*=i6,e},e})(s.rotate()).invert([0,0]));return o(null==h?[[l[0]-n,l[1]-n],[l[0]+n,l[1]+n]]:t===_y?[[Math.max(l[0]-n,h),e],[Math.min(l[0]+n,i),r]]:[[h,Math.max(l[1]-n,e)],[i,Math.min(l[1]+n,r)]])}return s.scale=function(t){return arguments.length?(a(t),u()):a()},s.translate=function(t){return arguments.length?(l(t),u()):l()},s.center=function(t){return arguments.length?(n(t),u()):n()},s.clipExtent=function(t){return arguments.length?(null==t?h=e=i=r=null:(h=+t[0][0],e=+t[0][1],i=+t[1][0],r=+t[1][1]),u()):null==h?null:[[h,e],[i,r]]},u()}function _v(t){return rh((i5+t)/2)}function _b(t,e){var i=ri(t),r=t===e?ra(t):rs(i/ri(e))/rs(_v(e)/_v(t)),s=i*rn(_v(t),r)/r;if(!r)return _y;function n(t,e){s>0?e<-i5+1e-6&&(e=-i5+1e-6):e>i5-1e-6&&(e=i5-1e-6);var i=s/rn(_v(e),r);return[i*ra(r*t),s-i*ri(r*t)]}return n.invert=function(t,e){var i=s-e,n=rl(r)*ro(t*t+i*i),a=re(t,i8(i))*rl(i);return i*r<0&&(a-=i3*rl(t)*rl(i)),[a/r,2*rt(rn(s/n,1/r))-i5]},n}function _x(t,e){return[t,e]}function _S(t,e){var i=ri(t),r=t===e?ra(t):(i-ri(e))/(e-t),s=i/r+t;if(1e-6>i8(r))return _x;function n(t,e){var i=s-e,n=r*t;return[i*ra(n),s-i*ri(n)]}return n.invert=function(t,e){var i=s-e,n=re(t,i8(i))*rl(i);return i*r<0&&(n-=i3*rl(t)*rl(i)),[n/r,s-rl(r)*ro(t*t+i*i)]},n}_m.invert=_g(function(t){return t}),_y.invert=function(t,e){return[t,2*rt(rr(e))-i5]},_x.invert=_x;var _k=ro(3)/2;function _A(t,e){var i=rd(_k*ra(e)),r=i*i,s=r*r*r;return[t*ri(i)/(_k*(1.340264+-.24331799999999998*r+s*(.0062510000000000005+.034164*r))),i*(1.340264+-.081106*r+s*(893e-6+.003796*r))]}function _M(t,e){var i=ri(e),r=ri(t)*i;return[i*ra(t)/r,ra(e)/r]}function _w(t,e){var i=e*e,r=i*i;return[t*(.8707-.131979*i+r*(-.013791+r*(.003971*i-.001529*r))),e*(1.007226+i*(.015085+r*(-.044475+.028874*i-.005916*r)))]}function _T(t,e){return[ri(e)*ra(t),ra(e)]}function _C(t,e){var i=ri(e),r=1+ri(t)*i;return[i*ra(t)/r,ra(e)/r]}function _E(t,e){return[rs(rh((i5+e)/2)),-t]}_A.invert=function(t,e){for(var i,r,s=e,n=s*s,a=n*n*n,l=0;l<12&&(r=s*(1.340264+-.081106*n+a*(893e-6+.003796*n))-e,s-=i=r/(1.340264+-.24331799999999998*n+a*(.0062510000000000005+.034164*n)),a=(n=s*s)*n*n,!(1e-12>i8(i)));++l);return[_k*t*(1.340264+-.24331799999999998*n+a*(.0062510000000000005+.034164*n))/ri(s),rd(ra(s)/_k)]},_M.invert=_g(rt),_w.invert=function(t,e){var i,r=e,s=25;do{var n=r*r,a=n*n;r-=i=(r*(1.007226+n*(.015085+a*(-.044475+.028874*n-.005916*a)))-e)/(1.007226+n*(.045255+a*(-.311325+.259866*n-.005916*11*a)))}while(i8(i)>1e-6&&--s>0);return[t/(.8707+(n=r*r)*(-.131979+n*(-.013791+n*n*n*(.003971-.001529*n)))),r]},_T.invert=_g(rd),_C.invert=_g(function(t){return 2*rt(t)}),_E.invert=function(t,e){return[-e,2*rt(rr(t))-i5]},sb();let _B={},_P={albers:_c,albersusa:function(){var t,e,i,r,s,n,a=_c(),l=_d().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=_d().rotate([157,0]).center([-3,19.9]).parallels([8,18]),h={point:function(t,e){n=[t,e]}};function u(t){var e=t[0],a=t[1];return n=null,i.point(e,a),n||(r.point(e,a),n)||(s.point(e,a),n)}function d(){return t=e=null,u}return u.invert=function(t){var e=a.scale(),i=a.translate(),r=(t[0]-i[0])/e,s=(t[1]-i[1])/e;return(s>=.12&&s<.234&&r>=-.425&&r<-.214?l:s>=.166&&s<.234&&r>=-.214&&r<-.115?o:a).invert(t)},u.stream=function(i){var r,s;return t&&e===i?t:(s=(r=[a.stream(e=i),l.stream(i),o.stream(i)]).length,t={point:function(t,e){for(var i=-1;++i<s;)r[i].point(t,e)},sphere:function(){for(var t=-1;++t<s;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<s;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<s;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<s;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<s;)r[t].polygonEnd()}})},u.precision=function(t){return arguments.length?(a.precision(t),l.precision(t),o.precision(t),d()):a.precision()},u.scale=function(t){return arguments.length?(a.scale(t),l.scale(.35*t),o.scale(t),u.translate(a.translate())):a.scale()},u.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),n=+t[0],u=+t[1];return i=a.translate(t).clipExtent([[n-.455*e,u-.238*e],[n+.455*e,u+.238*e]]).stream(h),r=l.translate([n-.307*e,u+.201*e]).clipExtent([[n-.425*e+1e-6,u+.12*e+1e-6],[n-.214*e-1e-6,u+.234*e-1e-6]]).stream(h),s=o.translate([n-.205*e,u+.212*e]).clipExtent([[n-.214*e+1e-6,u+.166*e+1e-6],[n-.115*e-1e-6,u+.234*e-1e-6]]).stream(h),d()},u.fitExtent=function(t,e){return y8(u,t,e)},u.fitSize=function(t,e){return _t(u,t,e)},u.fitWidth=function(t,e){return _e(u,t,e)},u.fitHeight=function(t,e){return _i(u,t,e)},u.scale(1070)},azimuthalequalarea:function(){return _l(_f).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return _l(_m).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return _h(_b).scale(109.5).parallels([30,30])},conicequalarea:_d,conicequidistant:function(){return _h(_S).scale(131.154).center([0,13.9389])},equalearth:function(){return _l(_A).scale(177.158)},equirectangular:function(){return _l(_x).scale(152.63)},gnomonic:function(){return _l(_M).scale(144.049).clipAngle(60)},identity:function(){var t,e,i,r,s,n,a,l=1,o=0,h=0,u=1,d=1,c=0,p=null,g=1,f=1,m=y7({point:function(t,e){var i=v([t,e]);this.stream.point(i[0],i[1])}}),y=i$;function _(){return g=l*u,f=l*d,n=a=null,v}function v(i){var r=i[0]*g,s=i[1]*f;if(c){var n=s*t-r*e;r=r*t+s*e,s=n}return[r+o,s+h]}return v.invert=function(i){var r=i[0]-o,s=i[1]-h;if(c){var n=s*t+r*e;r=r*t-s*e,s=n}return[r/g,s/f]},v.stream=function(t){return n&&a===t?n:n=m(y(a=t))},v.postclip=function(t){return arguments.length?(y=t,p=i=r=s=null,_()):y},v.clipExtent=function(t){return arguments.length?(y=null==t?(p=i=r=s=null,i$):yJ(p=+t[0][0],i=+t[0][1],r=+t[1][0],s=+t[1][1]),_()):null==p?null:[[p,i],[r,s]]},v.scale=function(t){return arguments.length?(l=+t,_()):l},v.translate=function(t){return arguments.length?(o=+t[0],h=+t[1],_()):[o,h]},v.angle=function(i){return arguments.length?(e=ra(c=i%360*i9),t=ri(c),_()):c*i6},v.reflectX=function(t){return arguments.length?(u=t?-1:1,_()):u<0},v.reflectY=function(t){return arguments.length?(d=t?-1:1,_()):d<0},v.fitExtent=function(t,e){return y8(v,t,e)},v.fitSize=function(t,e){return _t(v,t,e)},v.fitWidth=function(t,e){return _e(v,t,e)},v.fitHeight=function(t,e){return _i(v,t,e)},v},mercator:function(){return __(_y).scale(961/i7)},naturalearth1:function(){return _l(_w).scale(175.295)},orthographic:function(){return _l(_T).scale(249.5).clipAngle(90.000001)},stereographic:function(){return _l(_C).scale(250).clipAngle(142)},transversemercator:function(){var t=__(_E),e=t.center,i=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?i([t[0],t[1],t.length>2?t[2]+90:90]):[(t=i())[0],t[1],t[2]-90]},i([0,0,90]).scale(159.155)}},_O=["clipAngle","clipExtent","scale","translate","center","rotate","precision","reflectX","reflectY","parallels","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function _I(t,e){return function i(){let r=e();return r.type=t,r.path=sb().projection(r),r.copy=r.copy||function(){let t=i();return _O.forEach(e=>{r[e]&&t[e](r[e]())}),t.path.pointRadius(r.path.pointRadius()),t},r}}class _R{constructor(t){this.projection=(function(t,e){let i=t.toLowerCase();return arguments.length>1?_I(i,e):_P[i]?(_B[i]||(_B[i]=_I(i,_P[i])),_B[i]):null})(t.type)()}fit(t,e,i){this.projection.fitExtent([t,e],{type:"FeatureCollection",features:i})}center(t){var e,i;null==(i=null==(e=this.projection)?void 0:e.center)||i.call(e,t)}project(t){var e;return null==(e=this.projection)?void 0:e.call(this,t)}shape(t){var e,i;return null==(i=null==(e=this.projection)?void 0:e.path)?void 0:i.call(e,t)}invert(t){var e,i;return null==(i=null==(e=this.projection)?void 0:e.invert)?void 0:i.call(e,t)}scale(t){var e;if(null==(e=this.projection)?void 0:e.scale){if(void 0===t)return this.projection.scale();this.projection.scale(t)}}translate(t){var e;if(null==(e=this.projection)?void 0:e.scale){if(void 0===t)return this.projection.translate();this.projection.translate(t)}}evaluate(t,e,i){let r=this.projection.copy();return null==r?void 0:r.fitExtent([t,e],{type:"FeatureCollection",features:i})}}class _L{parserScrollEvent(t){return t?!(t.ctrlKey||0===t.deltaY&&0===t.deltaX)&&(t.scrollX=t.deltaX,t.scrollY=t.deltaY,t):t}parserZoomEvent(t){if(!t)return t;let e=Math.pow(1.0005,-t.deltaY*Math.pow(16,t.deltaMode));return t.zoomDelta=e,t.zoomX=t.canvasX,t.zoomY=t.canvasY,t}clearZoom(){}clearScroll(){}clearDrag(){}}class _D{constructor(){this._lastScale=0}clearZoom(){this._lastScale=0}parserZoomEvent(t){let e=t.scale;if(0===this._lastScale)return this._lastScale=e,t;t.zoomDelta=e/this._lastScale;let i=t.center;return t.zoomX=i.x,t.zoomY=i.y,this._lastScale=e,t}parserScrollEvent(t){return t}clearScroll(){}clearDrag(){}}function _F(t){return t===rk["desktop-browser"]||t===rk["desktop-miniApp"]?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside"],zoom:"wheel",zoomEnd:"pointerup",scroll:"wheel",trigger:_L}:eB(t)||eP(t)?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside","pointerleave"],zoom:"pinch",zoomEnd:"pinchend",scroll:"pan",scrollEnd:"panend",trigger:_D}:null}let _z={debounce:ij,throttle:iH};class _j{constructor(){this._isGestureListener=!1}initZoomable(t,e=rk["desktop-browser"]){this._eventObj=t,this._renderMode=e,this._gestureController=this._option.getCompiler()._gestureController,this._isGestureListener=eB(this._renderMode)||eP(this._renderMode),_F(this._renderMode)&&(this._clickEnable=!0,this._zoomableTrigger=new(this._getZoomTriggerEvent("trigger")))}_getZoomTriggerEvent(t){return _F(this._renderMode)[t]}_zoomEventDispatch(t,e,i,r){if(!this._isGestureListener&&!t.event)return;let s=this._isGestureListener?t:t.event.clone();this._zoomableTrigger.parserZoomEvent(s);let{zoomDelta:n,zoomX:a,zoomY:l,path:o}=s;if(!r&&!o.some(t=>t.name&&t.name.includes("region"))||et(n)||!pN({x:a,y:l},this._getRegionOrSeriesLayout(e),!1))return;this._clearDragEvent(),this._zoomableTrigger.clearScroll();let h={};i&&(h=i({zoomDelta:n,zoomX:a,zoomY:l},s)),this._eventObj.emit("zoom",Object.assign(Object.assign({scale:s.zoomDelta,scaleCenter:{x:s.zoomX,y:s.zoomY}},h),{model:this}))}_getRegionOrSeriesLayout(t){"region"!==t.type&&(t=t.getRegion());let{x:e,y:i,width:r,height:s}=t.layout.getLayout();return{x1:e,y1:i,x2:e+r,y2:i+s}}_bindZoomEventAsRegion(t,e,i,r){var s,n;let a=null!=(s=null==r?void 0:r.delayType)?s:"throttle",l=null!=(n=null==r?void 0:r.delayTime)?n:0,o=this._isGestureListener?this._gestureController:t,h=this._isGestureListener?[this._getZoomTriggerEvent("zoom")]:[this._getZoomTriggerEvent("zoom"),{level:rO.chart,consume:!0}],u=this._isGestureListener?[this._getZoomTriggerEvent("zoomEnd")]:[this._getZoomTriggerEvent("zoomEnd"),{level:rO.chart,consume:!1}];o.on(...u,_z[a](t=>{this._zoomableTrigger.clearZoom()},l)),o.on(...h,_z[a](t=>{var s;this._zoomEventDispatch(t,e,i,null!=(s=null==r?void 0:r.allowComponentZoom)&&s)},l))}initZoomEventOfSeries(t,e,i){this._option.disableTriggerEvent||_F(this._renderMode)&&this._bindZoomEventAsRegion(t.event,t,e,i)}initZoomEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||_F(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&this._bindZoomEventAsRegion(t.event,t,i,r)}):this._bindZoomEventAsRegion(this._eventObj,t,i,r)})}_scrollEventDispatch(t,e,i){let r=!1;if(!this._isGestureListener&&(!t.event||this._option.disableTriggerEvent))return r;let s=this._isGestureListener?t:t.event;this._zoomableTrigger.parserScrollEvent(s);let{scrollX:n,scrollY:a,canvasX:l,canvasY:o}=s;return et(n)&&et(a)||pN({x:l,y:o},this._getRegionOrSeriesLayout(e),!1)&&(this._clearDragEvent(),this._zoomableTrigger.clearZoom(),i&&(r=i({scrollX:n,scrollY:a},s)),this._eventObj.emit("scroll",{scrollX:n,scrollY:a,model:this})),r}_bindScrollEventAsRegion(t,e,i,r){var s,n;let a=null!=(s=null==r?void 0:r.delayType)?s:"throttle",l=null!=(n=null==r?void 0:r.delayTime)?n:0,o=this._isGestureListener?this._gestureController:t,h=this._isGestureListener?[this._getZoomTriggerEvent("scroll")]:[this._getZoomTriggerEvent("scroll"),{level:rO.chart,consume:!0}],u=this._isGestureListener?[this._getZoomTriggerEvent("scrollEnd")]:[this._getZoomTriggerEvent("scrollEnd"),{level:rO.chart,consume:!1}];o.on(...u,_z[a](t=>{this._zoomableTrigger.clearScroll()},l)),o.on(...h,_z[a](t=>this._scrollEventDispatch(t,e,i),l))}initScrollEventOfSeries(t,e,i){_F(this._renderMode)&&this._bindScrollEventAsRegion(t.event,t,e,i)}initScrollEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||_F(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&this._bindScrollEventAsRegion(t.event,t,i,r)}):this._bindScrollEventAsRegion(this._eventObj,t,i,r)})}_bindDragEventAsRegion(t,e,i,r){t.on(this._getZoomTriggerEvent("start"),{level:rO.chart},t=>{if(!t.event)return;let{event:s}=t;pN({x:s.canvasX,y:s.canvasY},this._getRegionOrSeriesLayout(e),!1)&&this._handleDrag(t,i,r)}),t.on("click",{level:rO.chart},()=>!this._clickEnable)}initDragEventOfSeries(t,e,i){this._option.disableTriggerEvent||_F(this._renderMode)&&t.event.on(this._getZoomTriggerEvent("start"),{level:rO.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},t=>{this._handleDrag(t,e,i)})}initDragEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||_F(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&(t.event.on(this._getZoomTriggerEvent("start"),{level:rO.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},t=>{this._handleDrag(t,i)}),t.event.on("click",{level:rO.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>!this._clickEnable))}):this._bindDragEventAsRegion(this._eventObj,t,i,r)})}_clearDragEvent(){let t=this._getZoomTriggerEvent("move"),e=this._getZoomTriggerEvent("end");this._handleDragMouseMove&&(this._eventObj.off(t,{level:rO.chart,source:rP.chart},this._handleDragMouseMove),this._handleDragMouseMove=void 0),this._handleDragMouseUp&&(e.forEach(t=>{this._eventObj.off(t,{level:rO.chart,source:rP.chart},this._handleDragMouseUp),this._eventObj.allow(t)}),this._handleDragMouseUp=void 0)}isDragEnable(t){if(this._isGestureListener&&this._gestureController){let t=this._gestureController.cachedEvents;return!t||t.length<2}return!0}_handleDrag(t,e,i){var r,s,n;if(this._clearDragEvent(),this._option.disableTriggerEvent||(this._clickEnable=!1,!this.isDragEnable(t.event)))return;this._zoomableTrigger.clearZoom(),this._zoomableTrigger.clearScroll();let a=null!=(r=null==i?void 0:i.delayType)?r:"throttle",l=null!=(s=null==i?void 0:i.delayTime)?s:0,o=null==(n=null==i?void 0:i.realTime)||n,h=this._getZoomTriggerEvent("move"),u=this._getZoomTriggerEvent("end"),d=t.event,c=d.canvasX,p=d.canvasY,g=d.canvasX,f=d.canvasY;this._handleDragMouseUp=_z[a](t=>{this._clickEnable=!0;let i=t.event,r=[i.canvasX-g,i.canvasY-f];g=i.canvasX,f=i.canvasY,!o&&e&&e(r,t.event),this._eventObj.emit("panend",{delta:r,model:this}),this._clearDragEvent()},l),this._handleDragMouseMove=_z[a](t=>{if(!this.isDragEnable(t.event))return;this._clickEnable=!1,u.forEach(t=>{this._eventObj.prevent(t,{handler:this._handleDragMouseUp,level:rO.chart})});let i=t.event,r=[i.canvasX-c,i.canvasY-p];c=i.canvasX,p=i.canvasY,o&&e&&e(r,t.event),this._eventObj.emit("panmove",{delta:r,model:this})},l),this._eventObj.on(h,{level:rO.chart,source:rP.chart},this._handleDragMouseMove),u.forEach(t=>{this._eventObj.on(t,{level:rO.chart,source:rP.chart},this._handleDragMouseUp)})}}class _H extends gO{constructor(){var t,e;super(...arguments),this.type=rA.geoCoordinate,this.name=rA.geoCoordinate,this.layoutType="none",this.layoutZIndex=z.Mark,this._projectionSpec={name:(t=this.type,e=this.id,`${s6}_${e}_${t}`),type:"mercator"},this._actualScale=1,this._initialScale=1,this.effect={scaleUpdate:()=>{this.coordinateHelper()}},this._handleChartZoom=(t,e)=>{var i,r,s,n,a,l;let o=t.zoomDelta,h=this._actualScale;return this._actualScale*=o,this._actualScale<(null==(i=this._spec.zoomLimit)?void 0:i.min)?(this._actualScale=null==(r=this._spec.zoomLimit)?void 0:r.min,o=(null==(s=this._spec.zoomLimit)?void 0:s.min)/h):this._actualScale>(null==(n=this._spec.zoomLimit)?void 0:n.max)&&(this._actualScale=null==(a=this._spec.zoomLimit)?void 0:a.max,o=(null==(l=this._spec.zoomLimit)?void 0:l.max)/h),this.zoom(o,[t.zoomX,t.zoomY]),{scale:o,totalScale:this._actualScale}},this.pan=(t=[0,0])=>{var e,i,r;let s=null!=(i=null==(e=this._projection)?void 0:e.translate())?i:[0,0],n=s[0],a=s[1];n+=t[0],a+=t[1],null==(r=this._projection)||r.translate([n,a])}}get longitudeField(){return this._longitudeField}get latitudeField(){return this._latitudeField}get projectionSpec(){return this._projectionSpec}setProjection(t){this._projectionSpec=Object.assign(Object.assign({},t),{name:this._projectionSpec.name})}getZoom(){return this._actualScale}static getSpecInfo(t){if(et(t))return null;let e=[];return t.region.forEach((t,i)=>{if("geo"===t.coordinate){let r=Object.assign(Object.assign({},t),{padding:0});e.push({spec:r,regionIndex:i,type:rA.geoCoordinate,specInfoPath:["component","geoCoordinate",i]})}}),e}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec(),this._spec.roam&&this.initZoomable(this.event,this._option.mode),this._projectionSpec=it(this._projectionSpec,this._spec.projection),this._projectionSpec.zoom>(null==(t=this._spec.zoomLimit)?void 0:t.max)&&(this._projectionSpec.zoom=this._spec.zoomLimit.max),this._projectionSpec.zoom<(null==(e=this._spec.zoomLimit)?void 0:e.min)&&(this._projectionSpec.zoom=this._spec.zoomLimit.min),this._actualScale=null!=(i=this._projectionSpec.zoom)?i:1,this._initialScale=this._actualScale,this._longitudeField=this._spec.longitudeField,this._latitudeField=this._spec.latitudeField}created(){super.created(),this._regions=this._option.getRegionsInIndex([this._option.regionIndex]),this.initProjection(),this.coordinateHelper(),this.initEvent(),this._initCenterCache()}dispatchZoom(t,e){let i=e||{x:this.getLayoutStartPoint().x+this.getLayoutRect().width/2,y:this.getLayoutStartPoint().y+this.getLayoutRect().height/2},{scale:r,totalScale:s}=this._handleChartZoom({zoomDelta:t,zoomX:i.x,zoomY:i.y});1!==r&&this.event.emit("zoom",{scale:r,scaleCenter:i,totalScale:s,model:this})}initEvent(){this.event.on(rB.scaleUpdate,{filter:({model:t})=>(null==t?void 0:t.id)===this.id},this.effect.scaleUpdate.bind(this));let{roam:t}=this._spec;t&&(this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom),this.initDragEventOfRegions(this._regions,t.blank?null:()=>!0,this.pan),this._regions.forEach(t=>{t.getSeries().forEach(t=>{t.event.on("zoom",e=>(t.handleZoom(e),!0)),t.event.on("panmove",e=>(t.handlePan(e),!0))})}))}initProjection(){var t;this._projection=new _R(this._projectionSpec),null!==this._projection.projection||null==(t=this._option)||t.onError("unsupported projection type!")}coordinateHelper(){let t={longitudeField:this._longitudeField,latitudeField:this._latitudeField,dataToPosition:this.dataToPosition.bind(this),dataToLongitude:this.dataToLongitude.bind(this),dataToLatitude:this.dataToLatitude.bind(this),shape:this.shape.bind(this),getCoordinateId:()=>this.id};this._regions.forEach(e=>{e.getSeries().forEach(e=>{e.type===rw.map||e.type===rw.pictogram?e.setCoordinateHelper(t):(e.setXAxisHelper(Object.assign(Object.assign({},t),{isContinuous:!0,dataToPosition:(t,i)=>{var r;let s=t[0];if(et(s)&&(null==i?void 0:i.datum)){let t=i.datum[e.getDimensionField()[0]];s=null==(r=this._centerCache.get(t))?void 0:r.x}return this.dataToLongitude(s)},valueToPosition:(t,i)=>{var r;if(et(t)&&(null==i?void 0:i.datum)){let s=i.datum[e.getDimensionField()[0]];t=null==(r=this._centerCache.get(s))?void 0:r.x}return this.dataToLongitude(t)},getFields:()=>[this._longitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})),e.setYAxisHelper(Object.assign(Object.assign({},t),{isContinuous:!0,dataToPosition:(t,i)=>{var r;let s=t[0];if(et(s)&&(null==i?void 0:i.datum)){let t=i.datum[e.getDimensionField()[0]];s=null==(r=this._centerCache.get(t))?void 0:r.y}return this.dataToLatitude(s)},valueToPosition:(t,i)=>{var r;if(et(t)&&(null==i?void 0:i.datum)){let s=i.datum[e.getDimensionField()[0]];t=null==(r=this._centerCache.get(s))?void 0:r.y}return this.dataToLatitude(t)},getFields:()=>[this._latitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})))})})}onLayoutEnd(){this.setLayoutRect(this._regions[0].getLayoutRect()),this.setLayoutStartPosition(this._regions[0].getLayoutStartPoint());let{width:t,height:e}=this.getLayoutRect(),{translate:i,scale:r,center:s}=this.evaluateProjection([0,0],[t,e]);i&&this._projection.translate(i),r&&this._projection.scale(r),s&&this._projection.center(s),pW(this._regions,t=>{var e;if(t.type===rw.map||t.type===rw.pictogram){null==(e=t.areaPath)||e.clear();let i=t.getRootMark().getProduct();i&&i.attribute.postMatrix&&i.setAttributes({postMatrix:new yv})}}),this._actualScale=this._initialScale,super.onLayoutEnd()}collectFeatures(){let t=[];return this._regions.forEach(e=>{e.getSeries().forEach(e=>{var i,r;e.type!==rw.map&&e.type!==rw.pictogram||t.push(...null!=(r=null==(i=e.getMapViewData())?void 0:i.latestData)?r:[])})}),t}dataToPosition(t=[]){var e;let i=null==(e=this._projection)?void 0:e.project([t[0],t[1]]);return{x:null==i?void 0:i[0],y:null==i?void 0:i[1]}}dataToLatitude(t){var e;let i=null==(e=this._projection)?void 0:e.project([0,t]);return null==i?void 0:i[1]}dataToLongitude(t){var e;let i=null==(e=this._projection)?void 0:e.project([t,0]);return null==i?void 0:i[0]}zoom(t,e=[0,0]){var i,r,s,n,a,l;let o=null!=(r=null==(i=this._projection)?void 0:i.scale())?r:0,h=null!=(n=null==(s=this._projection)?void 0:s.translate())?n:[0,0],u=h[0],d=h[1];o*=t,u-=(e[0]-u)*(t-1),d-=(e[1]-d)*(t-1),null==(a=this._projection)||a.scale(o),null==(l=this._projection)||l.translate([u,d])}shape(t){return this._projection.shape(t)}invert(t){return this._projection.invert(t)}evaluateProjection(t,e){var i;let r=this._projection.evaluate(t,e,this.collectFeatures()),s=r.translate(),n=r.scale()*this._initialScale,a=null!=(i=this._projectionSpec.center)?i:r.invert([e[0]/2,e[1]/2]);return a&&(s=[e[0]/2,e[1]/2]),{translate:s,scale:n,center:a}}_initCenterCache(){this._centerCache||(this._centerCache=new Map),this._regions.forEach(t=>{t.getSeries().forEach(t=>{var e,i;"map"===t.type&&(null!=(i=null==(e=t.getMapViewData())?void 0:e.latestData)?i:[]).forEach((e={})=>{let i=e[t.getDimensionField()[0]]||e[yS],r=t.getDatumCenter(e);i&&t5(r)&&this._centerCache.set(i,{x:r[0],y:r[1]})})})})}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reMake=["roam","longitudeField","latitudeField","projection","zoomLimit"].some(i=>!t1(null==e?void 0:e[i],t[i]))),i}release(){super.release(),this._centerCache&&this._centerCache.clear(),this._centerCache=null}}_H.type=rA.geoCoordinate,cD(_H,_j);let _N=()=>{ig.registerComponent(_H.type,_H)};class _V extends cw{_transformLabelSpec(t){this._addMarkLabelSpec(t,"area",void 0,void 0,!1)}}class _W extends yx{constructor(){super(...arguments),this.type=rw.map,this.transformerConstructor=_V,this._areaCache=new Map}getNameMap(){return this._nameMap}get areaPath(){return this._areaCache}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.map=this._spec.map,this._nameMap=this._spec.nameMap,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this._spec.nameProperty&&(this._nameProperty=this._spec.nameProperty),this._spec.centroidProperty&&(this._centroidProperty=this._spec.centroidProperty),this.map||null==(t=this._option)||t.onError(`map type '${this.map}' is not specified !`),sK.get(this.map)||null==(e=this._option)||e.onError(`'${this.map}' data is not registered !`)}initData(){var t,e;super.initData(),sY(this._dataSet,"copyDataView",s0),sY(this._dataSet,"map",yk),sY(this._dataSet,"lookup",yb);let i=sK.get(this.map);i||null==(t=this._option)||t.onError("no valid map data found!");let r=new er(this._dataSet,{name:`map_${this.id}_data`});r.parse([i],{type:"dataview"}).transform({type:"copyDataView",options:{deep:!0},level:L.copyDataView}).transform({type:"map",options:{nameMap:this._nameMap,nameProperty:this._nameProperty}}).transform({type:"lookup",options:{from:()=>{var t;return null==(t=this._data)?void 0:t.getLatestData()},key:yS,fields:this._nameField,set:(t,e)=>{e&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}}}),null==(e=this._data)||e.getDataView().target.addListener("change",r.reRunAllTransform),this._mapViewData=new ly(this._option,r)}compileData(){var t;super.compileData(),null==(t=this._mapViewData)||t.compile()}initMark(){this._pathMark=this._createMark(_W.mark.area,{groupKey:this.getDimensionField()[0],isSeriesMark:!0},{morph:ck(this._spec,_W.mark.area.name),morphElementKey:this.getDimensionField()[0]}),this._pathMark.setData(this._mapViewData)}initMarkStyle(){let t=this._pathMark;t&&(this.setMarkStyle(t,{fill:t=>{var e,i,r,s;return t5(t[null!=(e=this._seriesField)?e:nr])?(null!=(i=this._option.globalScale.getScale("color"))?i:this._getDefaultColorScale()).scale(t[null!=(r=this._seriesField)?r:nr]):null==(s=this._spec)?void 0:s.defaultFillColor},path:this.getPath.bind(this)},"normal",H.Series),t.setPostProcess("fill",t=>t5(t)?t:this._spec.defaultFillColor),this.setMarkStyle(t,{smoothScale:!0},"normal",H.Built_In))}initLabelMarkStyle(t){t&&(this._labelMark=t,this.setMarkStyle(t,{text:t=>this.getDatumName(t),x:t=>{var e;return null==(e=this.dataToPosition(t))?void 0:e.x},y:t=>{var e;return null==(e=this.dataToPosition(t))?void 0:e.y}}))}initAnimation(){var t;this._pathMark.setAnimationConfig(cv(null==(t=ig.getAnimationInKey("fadeInOut"))?void 0:t(),cb("area",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new yA(this),this._pathMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pathMark)}getPath(t){var e;let i=this._areaCache.get(t[ne]);if(i)return i.shape;let r=null==(e=this._coordinateHelper)?void 0:e.shape(t);return this._areaCache.set(t[ne],{shape:r}),r}onEvaluateEnd(){this._mapViewData.updateData()}getDimensionField(){return[this.nameField]}getMeasureField(){return[this.valueField]}release(){super.release(),this._areaCache.clear(),this._nameMap={},this._mapViewData=null}handleZoom(t){var e;let{scale:i,scaleCenter:r}=t;if(1===i)return;let s=this.getRootMark().getProduct();s&&(s.attribute.postMatrix||s.setAttributes({postMatrix:new yv}),s.scale(i,i,r));let n=null==(e=this._labelMark)?void 0:e.getComponent();n&&n.renderInner()}handlePan(t){var e;let{delta:i}=t;if(0===i[0]&&0===i[1])return;let r=this.getRootMark().getProduct();r&&(r.attribute.postMatrix||r.setAttributes({postMatrix:new yv}),r.translate(i[0],i[1]));let s=null==(e=this._labelMark)?void 0:e.getComponent();s&&s.renderInner()}getDatumCenter(t){var e,i,r,s;return this._centroidProperty&&(null==(e=t.properties)?void 0:e[this._centroidProperty])?null==(i=t.properties)?void 0:i[this._centroidProperty]:ee(t.centroidX*t.centroidY)?[t.centroidX,t.centroidY]:(null==(r=t.properties)?void 0:r.center)?t.properties.center:(null==(s=t.properties)?void 0:s.centroid)?t.properties.centroid:[Number.NaN,Number.NaN]}getDatumName(t){var e;if(t[this.nameField])return t[this.nameField];let i=null==(e=t.properties)?void 0:e[this._nameProperty];if(i){if(this._spec.nameMap&&this._spec.nameMap[i])return this._spec.nameMap[i];if(this._spec.showDefaultName||!this._spec.nameMap)return i}return""}dataToPositionX(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}dataToPositionY(t){var e;return null==(e=this._option)||e.onError("Method not implemented."),0}viewDataUpdate(t){var e,i,r;super.viewDataUpdate(t),null==(i=null==(e=this._mapViewData)?void 0:e.getDataView())||i.reRunAllTransform(),null==(r=this._mapViewData)||r.updateData()}_getDataIdKey(){return ne}getActiveMarks(){return[this._pathMark]}}_W.type=rw.map,_W.mark=yE,_W.builtInTheme={map:{defaultFillColor:"#f3f3f3",area:{style:{lineWidth:.5,strokeOpacity:1,stroke:"black",fillOpacity:1}},label:{interactive:!1,style:{fontSize:{type:"token",key:"l6FontSize"},lineHeight:{type:"token",key:"l6LineHeight"},textBaseline:"middle",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},stroke:{type:"palette",key:"backgroundColor"}}}}},_W.transformerConstructor=_V;let _U=()=>{_N(),yC(),ig.registerSeries(_W.type,_W),ig.registerImplement("registerMap",sq),ig.registerImplement("unregisterMap",sQ),uJ()};class _G extends fB{_isValidSeries(t){return t===rw.map}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["type","nameField","valueField","map","nameProperty","centroidProperty","nameMap","area","defaultFillColor","showDefaultName"])}transformSpec(t){super.transformSpec(t),t.region.forEach(t=>{t.coordinate="geo"}),super.transformSeriesSpec(t)}}class _Z extends fF{constructor(){super(...arguments),this.transformerConstructor=_G,this.type="map",this.seriesType=rw.map}}_Z.type="map",_Z.seriesType=rw.map,_Z.transformerConstructor=_G;let _$=()=>{mg(),_U(),ig.registerChart(_Z.type,_Z)};class _Y extends cT{constructor(){super(...arguments),this.coordinate="polar",this._outerRadius=.6,this._innerRadius=0,this._angleField=[],this._radiusField=[],this._sortDataByAxis=!1}get outerRadius(){return this._outerRadius}get innerRadius(){return this._innerRadius}getAngleField(){return this._angleField}setAngleField(t){return this._angleField=t5(t)?eo(t):[],this._angleField}getRadiusField(){return this._radiusField}setRadiusField(t){return this._radiusField=t5(t)?eo(t):[],this._radiusField}get innerRadiusField(){return this._innerRadiusField}setInnerRadiusField(t){return this._innerRadiusField=eo(t),this._innerRadiusField}get radiusScale(){return this._radiusScale}setRadiusScale(t){return this._radiusScale=t,t}get angleScale(){return this._angleScale}setAngleScale(t){return this._angleScale=t,t}get angleAxisHelper(){return this._angleAxisHelper}set angleAxisHelper(t){this._angleAxisHelper=t,this.onAngleAxisHelperUpdate()}get radiusAxisHelper(){return this._radiusAxisHelper}set radiusAxisHelper(t){this._radiusAxisHelper=t,this.onRadiusAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getCenter=()=>this.angleAxisHelper.center(),this._markAttributeContext.getLayoutRadius=()=>this._computeLayoutRadius()}valueToPosition(t,e){if(et(t)||et(e)||!this.angleAxisHelper||!this.radiusAxisHelper)return{x:Number.NaN,y:Number.NaN};let i=this.radiusAxisHelper.dataToPosition(eo(e));if(i<0){if("break"===this._invalidType||"link"===this._invalidType)return{x:Number.NaN,y:Number.NaN};if("zero"===this._invalidType)return this.angleAxisHelper.center()}let r=this.angleAxisHelper.dataToPosition(eo(t));return this.angleAxisHelper.coordToPoint({angle:r,radius:i})}dataToPosition(t,e){return t&&this.angleAxisHelper&&this.radiusAxisHelper?e&&!this.isDatumInViewData(t)?null:this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getDatumPositionValues(t,this._radiusField)):null}dataToPositionX(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.x}dataToPositionY(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.y}dataToPositionZ(t){return 0}positionToData(t){}radiusToData(t){}angleToData(t){}getStatisticFields(){var t,e;let i=[];return(null==(t=this.radiusAxisHelper)?void 0:t.getScale)&&this._radiusField.forEach(t=>{let e={key:t,operations:[]};ai(this.radiusAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],i.push(e)}),(null==(e=this.angleAxisHelper)?void 0:e.getScale)&&this._angleField.forEach(t=>{let e={key:t,operations:[]};ai(this.angleAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],i.push(e)}),i}setAttrFromSpec(){super.setAttrFromSpec(),t5(this._spec.outerRadius)&&(this._outerRadius=this._spec.outerRadius),t5(this._spec.radius)&&(this._outerRadius=this._spec.radius),t5(this._spec.innerRadius)&&(this._innerRadius=this._spec.innerRadius),t5(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)}onRadiusAxisHelperUpdate(){this.onMarkPositionUpdate()}onAngleAxisHelperUpdate(){this.onMarkPositionUpdate()}afterInitMark(){super.afterInitMark()}_computeLayoutRadius(){let t=this._angleAxisHelper||this._radiusAxisHelper;if(t)return t.layoutRadius();let{width:e,height:i}=this._region.getLayoutRect();return Math.min(e/2,i/2)}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(rB.scaleDomainUpdate,{filter:t=>{var e;return t.model.id===(null==(e=this._angleAxisHelper)?void 0:e.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var t,e;(null==(e=null==(t=this.getViewData())?void 0:t.latestData)?void 0:e.length)&&cC(this.angleAxisHelper,this._angleField[0],this.getViewData().latestData)}getInvalidCheckFields(){let t=[];return this.angleAxisHelper.isContinuous&&this._angleField.forEach(e=>{t.push(e)}),this.radiusAxisHelper.isContinuous&&this._radiusField.forEach(e=>{t.push(e)}),t}}function _X(t){return ef(t)?Number.parseFloat(t):0}let _K=(t,e)=>{let{asStartAngle:i,asEndAngle:r,asMiddleAngle:s,asRadian:n,asRatio:a,asQuadrant:l,asK:o,showAllZero:h,supportNegative:u,showEmptyCircle:d}=e,c=e.angleField(),p=e.startAngle(),g=e.endAngle(),f=e.minAngle(),m=t.map(t=>Object.assign({},t));if(!m||0===m.length)return m;if(!h&&d&&_q(m,c,u))return[];let y=(t,e,a)=>{var o;t[i]=e,t[r]=e+a,t[s]=e+a/2,t[n]=a,t[l]=(o=lg(o=e+a/2))>0&&o<=Math.PI/2?2:o>Math.PI/2&&o<=Math.PI?3:o>Math.PI&&o<=3*Math.PI/2?4:1},_=0,v=-1/0,b=!0;for(let t=0;t<m.length;t++){let e=u?Math.abs(_X(m[t][c])):_X(m[t][c]);_+=e,v=Math.max(e,v),b&&0!==e&&(b=!1),m[t][gg]=e}let x=m.map(t=>Number(t[c])),S=g-p,k=p,A=S,M=0,w=function(t,e=2){let i=t.reduce((t,e)=>t+(isNaN(e)?0:e),0);if(0===i)return 0;let r=Math.pow(10,e),s=t.map(t=>(isNaN(t)?0:t)/i*r*100),n=100*r,a=s.map(t=>Math.floor(t)),l=a.reduce((t,e)=>t+e,0),o=s.map((t,e)=>t-a[e]);for(;l<n;){let t=Number.NEGATIVE_INFINITY,e=null;for(let i=0;i<o.length;i++)o[i]>t&&(t=o[i],e=i);++a[e],o[e]=0,++l}return a.map(t=>t/r)}(x);if(m.forEach((t,e)=>{let i=t[gg],r=_?i/_:0,s=r*S;s<f?(s=f,A-=f):M+=i;let n=k,l=k+s;t[a]=r,t[o]=v?i/v:0,t._percent_=w[e],y(t,n,s),k=l}),A<S)if(A<=.001){let t=S/m.length;m.forEach((e,i)=>{y(e,p+i*t,t)})}else{let t=A/M;k=p,m.forEach(e=>{let i=e[n]===f?f:e[gg]*t;y(e,k,i),k+=i})}if(0!==_&&(m[m.length-1][r]=g),b&&h){let t=S/m.length;m.forEach((e,i)=>{y(e,p+i*t,t)})}return m},_q=(t,e,i)=>!!et(t)||0===t.length||!!t.every(t=>0===_X(t[e]))||!i&&0===t.reduce((t,i)=>t+_X(i[e]),0);function _Q(t,e,i){return(r,s,n)=>e?"radius"===t.growField?{overall:0}:{overall:t.growFrom(r,s,i)}:{overall:!1}}let _J=t=>({type:"radius"===t.growField?"growRadiusIn":"growAngleIn",options:_Q(t,!0,D.appear)}),_0={type:"fadeIn"},_1=t=>({type:"radius"===t.growField?"growRadiusIn":"growAngleIn",easing:"linear",options:_Q(t,!0,D.enter)}),_2=t=>({type:"radius"===t.growField?"growRadiusOut":"growAngleOut",easing:"linear",options:_Q(t,!0,D.exit)}),_3=t=>({type:"radius"===t.growField?"growRadiusOut":"growAngleOut",options:_Q(t,!0,D.exit)});function _5(t,e){if(!1===e)return{};switch(e){case"fadeIn":return _0;case"growRadius":return _J(Object.assign(Object.assign({},t),{growField:"radius"}));default:return _J(Object.assign(Object.assign({},t),{growField:"angle"}))}}let _4=()=>{ig.registerAnimation("pie",(t,e)=>({appear:_5(t,e),enter:_1(t),exit:_2(t),disappear:_3(t)}))},_7=()=>{ig.registerAnimation("emptyCircle",(t,e)=>({appear:_5(t,e)}))};var _6=i(11971),_9=i(98706),_8=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class vt{constructor(t,e,i,r,s,n,a,l,o){this.refDatum=t,this.center=e,this.outerCenter=i,this.quadrant=r,this.radian=s,this.middleAngle=n,this.innerRadius=a,this.outerRadius=l,this.circleCenter=o,this.labelVisible=!0}getLabelBounds(){return this.labelPosition&&this.labelSize?{x1:this.labelPosition.x-this.labelSize.width/2,y1:this.labelPosition.y-this.labelSize.height/2,x2:this.labelPosition.x+this.labelSize.width/2,y2:this.labelPosition.y+this.labelSize.height/2}:{x1:0,x2:0,y1:0,y2:0}}}class ve extends pS{constructor(t,e){let{data:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({data:i},(0,cZ.Z)({},ve.defaultAttributes,_8(t,["data"])))),this.name="arc-label",this._ellipsisWidth=0,this._arcLeft=new Map,this._arcRight=new Map,this._line2MinLength=0,this._alignOffset=0}_overlapping(t){return["inside","inside-center"].includes(this.attribute.position)?super._overlapping(t):t}labeling(t,e,i="outside",r=0){if(t&&e)return{x:0,y:0}}_layout(t){var e,i,r;if(!t||!t.length)return;let s=super._layout(t),n=s.map(t=>this.getGraphicBounds(t)),a=Object.assign(Object.assign({},this.attribute.textStyle),{text:"…"}),l=1/0;if(!1!==a.ellipsis){let t=this._createLabelText(a),e=this.getGraphicBounds(t);l=e.x2-e.x1}let o=s.map(t=>t.attribute),h=Array.from(this._idToGraphic.values());this._line2MinLength=(0,uc.Z)(this.attribute.line.line2MinLength)?this.attribute.line.line2MinLength(t,h,this.attribute):this.attribute.line.line2MinLength,this._alignOffset=null!=(e=(0,uc.Z)(this.attribute.layout.alignOffset)?this.attribute.layout.alignOffset(t,h,this.attribute):this.attribute.layout.alignOffset)?e:0;let u=this.layoutArcLabels(this.attribute.position,this.attribute,h,o,n,l);for(let t=0;t<o.length;t++){let e=o[t],n=u.find(t=>{var i;return(null==(i=t.refDatum)?void 0:i.id)===e.id});if(n){let e={visible:n.labelVisible,x:n.labelPosition.x,y:n.labelPosition.y,angle:n.angle,points:n.pointA&&n.pointB&&n.pointC?[n.pointA,n.pointB,n.pointC]:void 0,line:n.labelLine};"richtext"===s[t].type?e.width=null!=(i=n.labelLimit)?i:s[t].attribute.width:e.maxLineWidth=null!=(r=n.labelLimit)?r:s[t].attribute.maxLineWidth,n.refArc&&"arc3d"===n.refArc.type&&(e.anchor3d=[n.circleCenter.x-e.x,n.circleCenter.y-e.y],e.beta=n.refArc.attribute.beta),s[t].setAttributes(e)}}return s}layoutArcLabels(t,e,i,r,s,n){this._arcLeft.clear(),this._arcRight.clear(),this._ellipsisWidth=n;let a=0;i.forEach(t=>{t.attribute.outerRadius>a&&(a=t.attribute.outerRadius)}),r.forEach((t,i)=>{var n,l,o;let h=this._idToGraphic.get(t.id),u=h.getAttributes(!0),d={x:null!=(n=null==u?void 0:u.x)?n:0,y:null!=(l=null==u?void 0:u.y)?l:0};if(!(0,lU.Z)(r[i])&&!(0,lU.Z)(s[i])){let t=r[i]?r[i]:null,n=s[i]?s[i]:{x1:0,x2:0,y1:0,y2:0},l=(u.startAngle+u.endAngle)/2,c=u.endAngle-u.startAngle,p=(0,_9.tc)(u.endAngle-c/2),g=new vt(t,(0,_9.op)(d,u.outerRadius,l),(0,_9.op)(d,a+e.line.line1MinLength,l),p,c,l,u.innerRadius,u.outerRadius,d);g.refArc=h,g.pointA=(0,_9.op)(d,this.computeDatumRadius(2*d.x,2*d.y,u.outerRadius),g.middleAngle),g.labelSize={width:n.x2-n.x1,height:n.y2-n.y1},1===(o=g.quadrant)||2===o?this._arcRight.set(g.refDatum,g):pa(g.quadrant)&&this._arcLeft.set(g.refDatum,g)}});let l=Array.from(this._arcLeft.values()),o=Array.from(this._arcRight.values()),h=[];switch(t){case"inside":case"inside-inner":case"inside-outer":case"inside-center":h.push(...this._layoutInsideLabels(o,e,i)),h.push(...this._layoutInsideLabels(l,e,i));break;default:h.push(...this._layoutOutsideLabels(o,e,i)),h.push(...this._layoutOutsideLabels(l,e,i))}return h}_layoutInsideLabels(t,e,i){var r,s;let n=e.spaceWidth,a=null!=(r=e.position)?r:"inside",l=null!=(s=e.offsetRadius)?s:-n;return t.forEach(t=>{var i,r,s,o;let h,{labelSize:u,radian:d}=t,c=t.innerRadius,p=t.outerRadius;h=d<((o=u.height)>2*p?NaN:2*Math.asin(o/2/p))?0:p-(d>=Math.PI?c:Math.max(c,u.height/2/Math.tan(d/2)))-n,!0!==e.rotate&&(h=p-n);let g=this._getFormatLabelText(t.refDatum,h);t.labelText=g;let f=Math.min(h,t.labelSize.width),m=this._computeAlign(t,e),y,_=0;if("inside"===a&&(_="left"===m?f:"right"===m?0:f/2),y="inside-inner"===a?c-l+_:"inside-center"===a?c+(p-c)/2:p+l-_,t.labelPosition=(0,_9.op)(t.circleCenter,y,t.middleAngle),t.labelLimit=f,(0,py.Vy)(f,0)||(t.labelVisible=!1),!1!==e.rotate){t.angle=null!=(r=null==(i=e.textStyle)?void 0:i.angle)?r:t.middleAngle;let n=null!=(s=e.offsetAngle)?s:0;["inside-inner","inside-outer"].includes(a)&&(n+=Math.PI/2),t.angle+=n}}),t}_layoutOutsideLabels(t,e,i){var r,s,n;let a=null!=(r=i[0].attribute.x)?r:0,l=2*(null!=(s=i[0].attribute.y)?s:0),o=e.layout,h=e.spaceWidth;if(t.forEach(t=>{let e=pa(t.quadrant)?-1:1;t.labelPosition={x:t.outerCenter.x+e*(t.labelSize.width/2+this._line2MinLength+h),y:t.outerCenter.y}}),t.sort((t,e)=>t.labelPosition.y-e.labelPosition.y),!1!==e.coverEnable||"none"===o.strategy){for(let r of t){let{labelPosition:t,labelSize:s}=r;r.labelLimit=s.width,r.pointB=pa(r.quadrant)?{x:t.x+s.width/2+this._line2MinLength+h,y:t.y}:{x:t.x-s.width/2-this._line2MinLength-h,y:t.y},this._computeX(r,e,i)}!1===e.coverEnable&&"none"===o.strategy&&this._coverLabels(t)}else{let r=l/((null==(n=e.textStyle)?void 0:n.fontSize)||16);this._adjustY(t,r,e,i);let{minY:s,maxY:a}=t.reduce((t,e)=>{let{y1:i,y2:r}=e.getLabelBounds();return t.minY=Math.max(0,Math.min(i,t.minY)),t.maxY=Math.min(l,Math.max(r,t.maxY)),t},{minY:1/0,maxY:-1/0}),o=Math.max(Math.abs(l/2-s),Math.abs(a-l/2)),h=this._computeLayoutRadius(o,e,i);for(let r of t)this._computePointB(r,h,e,i),this._computeX(r,e,i)}let u=2*a;return t.forEach(t=>{var i,r;t.labelVisible&&((0,py.SQ)(t.pointB.x,this._line2MinLength+h)||(0,py.Vy)(t.pointB.x,u-this._line2MinLength-h))&&(t.labelVisible=!1),t.angle=null!=(r=null==(i=e.textStyle)?void 0:i.angle)?r:0,e.offsetAngle&&(t.angle+=e.offsetAngle),t.labelLine=Object.assign(Object.assign({},e.line),{visible:t.labelVisible})}),t}_computeX(t,e,i){var r,s;let n=t.circleCenter,a=this.attribute.width;this.attribute.height;let l=0;i.forEach(t=>{t.getAttributes(!0).outerRadius>l&&(l=t.getAttributes(!0).outerRadius)});let o=this.computeLayoutOuterRadius(l,e.width,e.height),h=e.line.line1MinLength,u=null==(r=e.layout)?void 0:r.align,d=e.spaceWidth,{labelPosition:c,quadrant:p,pointB:g}=t;(0,uT.Z)(g.x*g.y)||(t.pointC={x:NaN,y:NaN},c.x=NaN,t.labelLimit=0);let f=this.computeRadius(o,e.width,e.height),m=pa(p)?-1:1,y=0,_=(m>0?a-g.x:g.x-0)+this._alignOffset-this._line2MinLength-d;"labelLine"===u&&(y=(f+h+this._line2MinLength)*m+n.x,_=(m>0?a-y:y-0)-d);let v=this._getFormatLabelText(t.refDatum,_);t.labelText=v;let b=Math.min(_,t.labelSize.width);switch(u){case"labelLine":break;case"edge":y=m>0?a-b-d:0+b+d;break;default:y=g.x+m*this._line2MinLength}let x=(b=Math.max(this._ellipsisWidth,b))<t.labelSize.width-1;t.labelLimit=x?b:null,t.pointC={x:y,y:c.y};let S=("left"===(s=this._computeAlign(t,e))?0:"right"===s?1:.5)*(x?b:t.labelSize.width);"edge"===u?(c.x=(m>0?a:0)-m*S+m*this._alignOffset,t.pointC.x+=m*this._alignOffset):c.x=y+m*(this._alignOffset+d+S)}_computeAlign(t,e){var i,r,s,n,a,l;let o=null!=(r=null==(i=e.textStyle)?void 0:i.textAlign)?r:null==(s=e.textStyle)?void 0:s.align,h=null!=(a=null==(n=e.layout)?void 0:n.textAlign)?a:null==(l=e.layout)?void 0:l.align;return"inside"!==e.position?(0,lU.Z)(o)||"auto"===o?"edge"===h?pa(t.quadrant)?"left":"right":pa(t.quadrant)?"right":"left":o:(0,lU.Z)(o)||"auto"===o?"center":o}_getFormatLabelText(t,e){var i;return null!=(i=null==t?void 0:t.text)?i:""}_adjustY(t,e,i,r){var s;r[0].attribute.x;let n=2*(null!=(s=r[0].attribute.y)?s:0),a=i.layout;if("vertical"===a.strategy){let e,i=0,r=t.length;if(r<=0)return;for(let s=0;s<r;s++){let{y1:n}=t[s].getLabelBounds();if(e=n-i,(0,py.SQ)(e,0)){let i=this._shiftY(t,s,r-1,-e);this._shiftY(t,i,0,e/2)}let{y2:a}=t[s].getLabelBounds();i=a}let{y1:s}=t[0].getLabelBounds();e=s-0,(0,py.SQ)(e,0)&&this._shiftY(t,0,r-1,-e);for(let e=t.length-1;e>=0&&t[e].getLabelBounds().y2>n;e--)t[e].labelVisible=!1}else if("none"!==a.strategy){let s=t.map((t,e)=>({arc:t,originIndex:e,priorityIndex:0}));s.sort((t,e)=>e.arc.radian-t.arc.radian),s.forEach((t,e)=>{t.priorityIndex=e,t.arc.labelVisible=!1});let l=1/0,o=-1/0;for(let h=0;h<e&&h<t.length;h++){let e;this._storeY(t);let u=s[h].arc;this._computeYRange(u,i,r),u.labelVisible=!0;let d=u.labelPosition.y,{lastIndex:c,nextIndex:p}=this._findNeighborIndex(t,s[h]),g=t[c],f=t[p];if(-1===c&&-1!==p){let e=f.labelPosition.y;d>e?u.labelPosition.y=e-f.labelSize.height/2-u.labelSize.height/2:this._twoWayShift(t,u,f,p)}else if(-1!==c&&-1===p){let e=g.labelPosition.y;d<e?u.labelPosition.y=e+g.labelSize.height/2+u.labelSize.height/2:this._twoWayShift(t,g,u,s[h].originIndex)}else if(-1!==c&&-1!==p){let e=g.labelPosition.y,i=f.labelPosition.y;d>i?(u.labelPosition.y=i-f.labelSize.height/2-u.labelSize.height/2,this._twoWayShift(t,g,u,s[h].originIndex)):(d<e?u.labelPosition.y=e+g.labelSize.height/2+u.labelSize.height/2:this._twoWayShift(t,g,u,s[h].originIndex),this._twoWayShift(t,u,f,p))}let m=Math.min(l,s[h].originIndex),y=Math.max(o,s[h].originIndex);if(e=t[y].getLabelBounds().y2-n,(0,py.Vy)(e,0)&&this._shiftY(t,y,0,-e),e=t[m].getLabelBounds().y1-0,(0,py.SQ)(e,0)&&this._shiftY(t,m,t.length-1,-e),e=t[y].getLabelBounds().y2-n,(0,py.Vy)(e,0)){u.labelVisible=!1,this._restoreY(t);break}a.tangentConstraint&&!this._checkYRange(t)?(u.labelVisible=!1,this._restoreY(t)):(l=m,o=y)}}}_shiftY(t,e,i,r){let s=e<i?1:-1,n=e;for(;-1!==n;){t[n].labelPosition.y+=r;let e=this._findNextVisibleIndex(t,n,i,s);if(e>=0&&e<t.length){let{y1:i,y2:r}=t[n].getLabelBounds(),{y1:a,y2:l}=t[e].getLabelBounds();if(s>0&&r<a||s<0&&i>l)return n}n=e}return i}_findNextVisibleIndex(t,e,i,r){let s=(i-e)*r;for(let i=1;i<=s;i++){let s=e+i*r;if(t[s].labelVisible)return s}return -1}_computePointB(t,e,i,r){let s=0;r.forEach(t=>{t.getAttributes(!0).outerRadius>s&&(s=t.getAttributes(!0).outerRadius)});let n=this.computeLayoutOuterRadius(s,i.width,i.height),a=i.line.line1MinLength;if("none"===i.layout.strategy)t.pointB={x:t.outerCenter.x,y:t.outerCenter.y};else{let r=t.circleCenter,s=this.computeRadius(n,i.width,i.height),{labelPosition:l,quadrant:o}=t,h=e-Math.max(s+a,t.outerRadius),u=Math.sqrt(e**2-Math.abs(r.y-l.y)**2)-h;(0,uT.Z)(u)?t.pointB={x:r.x+u*(pa(o)?-1:1),y:l.y}:t.pointB={x:NaN,y:NaN}}}_storeY(t){for(let e of t)e.labelVisible&&(e.lastLabelY=e.labelPosition.y)}_computeYRange(t,e,i){let r,s,n,a,l,o=t.circleCenter,h={width:2*o.x,height:2*o.y},u=0;i.forEach(t=>{t.getAttributes(!0).outerRadius>u&&(u=t.getAttributes(!0).outerRadius)});let d=this.computeLayoutOuterRadius(u,e.width,e.height),c=e.line.line1MinLength,{width:p,height:g}=h,f=this.computeRadius(d,e.width,e.height),m=this._computeLayoutRadius(g/2,e,i),y=Math.abs(t.center.x-p/2),_=t.center.y-g/2;if((0,py.Yt)(p/2,y))r=0,s=1,n=-_;else if((0,py.Yt)(g/2,_))r=1,s=0,n=-y;else{let t=-1/(_/y);r=t,s=-1,n=_-t*y}let v=function(t,e,i,r,s,n){if(0===t&&0===e||n<=0)return[];if(0===t){let t=-i/e,s=n**2-(t-0)**2;return s<0?[]:0===s?[{x:r,y:t}]:[{x:Math.sqrt(s)+r,y:t},{x:-Math.sqrt(s)+r,y:t}]}if(0===e){let e=-i/t,a=n**2-(e-r)**2;return a<0?[]:0===a?[{x:e,y:0}]:[{x:e,y:Math.sqrt(a)+s},{x:e,y:-Math.sqrt(a)+s}]}let a=(e/t)**2+1,l=2*(e/t*(i/t+r)-s),o=l**2-4*a*((i/t+r)**2+s**2-n**2);if(o<0)return[];let h=(-l+Math.sqrt(o))/(2*a),u=(-l-Math.sqrt(o))/(2*a),d=-(e*h+i)/t;return 0===o?[{x:d,y:h}]:[{x:d,y:h},{x:-(e*u+i)/t,y:u}]}(r,s,n,c+f-m,0,m);v.length<2||(v[0].x>v[1].x&&v.reverse(),v[0].x<0?(0,py.Yt)(v[0].y,v[1].y)?(0,py.Vy)(t.middleAngle,-Math.PI)&&(0,py.SQ)(t.middleAngle,0)||(0,py.Vy)(t.middleAngle,Math.PI)&&(0,py.SQ)(t.middleAngle,2*Math.PI)?(a=0,l=v[1].y+g/2):(a=v[1].y+g/2,l=g):v[0].y<v[1].y?(a=0,l=v[1].y+g/2):(a=v[1].y+g/2,l=h.height):(a=Math.min(v[0].y,v[1].y)+g/2,l=Math.max(v[0].y,v[1].y)+g/2),t.labelYRange=[a,l])}_computeLayoutRadius(t,e,i){let r=e.layoutArcGap,s=e.line.line1MinLength,n=0;i.forEach(t=>{t.getAttributes(!0).outerRadius>n&&(n=t.getAttributes(!0).outerRadius)});let a=this.computeLayoutOuterRadius(n,e.width,e.height),l=this.computeRadius(a,e.width,e.height)+s,o=l-r;return Math.max((o**2+t**2)/(2*o),l)}_findNeighborIndex(t,e){let i=e.originIndex,r=-1,s=-1;for(let e=i-1;e>=0;e--)if(t[e].labelVisible){r=e;break}for(let e=i+1;e<t.length;e++)if(t[e].labelVisible){s=e;break}return{lastIndex:r,nextIndex:s}}_twoWayShift(t,e,i,r){let s=i.getLabelBounds().y1-e.getLabelBounds().y2;if((0,py.SQ)(s,0)){let e=this._shiftY(t,r,t.length-1,-s);this._shiftY(t,e,0,s/2)}}_restoreY(t){for(let e of t)e.labelVisible&&(e.labelPosition.y=e.lastLabelY)}_checkYRange(t){for(let e of t){let{labelYRange:t,labelPosition:i}=e;if(e.labelVisible&&t&&((0,py.SQ)(i.y,t[0])||(0,py.Vy)(i.y,t[1])))return!1}return!0}_coverLabels(t){if(t.length<=1)return;let e=t[0].getLabelBounds();for(let i=1;i<t.length;i++){let r=t[i].getLabelBounds();!function(t,e){let{x1:i,y1:r,x2:s,y2:n}=t,{x1:a,y1:l,x2:o,y2:h}=e;return!(i<=a&&s<=a||i>=o&&s>=o||r<=l&&n<=l||r>=h&&n>=h)}(e,r)?e=r:t[i].labelVisible=!1}}_getLabelLinePoints(t,e){return t.attribute.points}_createLabelLine(t,e){var i,r,s,n,a;let{line:l={},visible:o}=t.attribute,h=super._createLabelLine(t,e);if(h&&(h.setAttributes({visible:null==(s=null!=(i=l.visible&&o)?i:null==(r=t.attribute)?void 0:r.visible)||s,lineWidth:null!=(a=null==(n=l.style)?void 0:n.lineWidth)?a:1}),l.smooth&&h.setAttributes({curveType:"basis"}),"arc3d"===e.type&&e)){let{beta:t,x:i,y:r}=e.getAttributes(!0);h.setAttributes({beta:t,anchor3d:[i,r]})}return h}computeRadius(t,e,i,r){return this.computeLayoutRadius(e||0,i||0)*t*((0,lU.Z)(r)?1:r)}computeLayoutRadius(t,e){return Math.min(t/2,e/2)}_canPlaceInside(t,e){return"inside"===this.attribute.position||"inside-center"===this.attribute.position}computeLayoutOuterRadius(t,e,i){return t/(Math.min(e,i)/2)}computeDatumRadius(t,e,i){let r=this.computeLayoutOuterRadius(i,t,e);return this.computeLayoutRadius(t||0,e||0)*r}}ve.defaultAttributes={coverEnable:!1,spaceWidth:5,layoutArcGap:6,textStyle:{visible:!0,fontSize:14,fontWeight:"normal",fillOpacity:1,boundsPadding:[-1,0,-1,0],ellipsis:!0},position:"outside",line:{visible:!0,line1MinLength:20,line2MinLength:10},layout:{align:"arc",strategy:"priority",tangentConstraint:!0}};let vi=()=>{pA("arc",ve)};var vr=i(61226);class vs extends oa{constructor(t,e){super(t,e),this.type=vn.type,this._unCompileChannel={centerOffset:!0,radiusOffset:!0},this.computeOuterRadius=(t,e,i="normal",r)=>{var s;return r+(null!=(s=this.getAttribute("radiusOffset",e,i))?s:0)},this.computeCenter=(t,e,i="normal",r)=>lc({x:0,y:0},this.getAttribute("centerOffset",e,i),e[gv])[t]+r,this._computeExChannel.x=this.computeCenter,this._computeExChannel.y=this.computeCenter,this._computeExChannel.outerRadius=this.computeOuterRadius,this._extensionChannel.centerOffset=["x","y"],this._extensionChannel.radiusOffset=["outerRadius"]}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{startAngle:0,endAngle:0,outerRadius:0,innerRadius:0,cornerRadius:0,lineWidth:0,innerPadding:0,outerPadding:0})}}class vn extends vs{constructor(){super(...arguments),this.type=vn.type}}vn.type="arc";let va=()=>{(0,ol.W)(),(0,vr.x)(),vi(),u7(),ig.registerGraphicComponent("arc",_6.Q),ig.registerMark(vn.type,vn)},vl=Object.assign(Object.assign({},cd),{pie:{name:"pie",type:"arc"},labelLine:{name:"labelLine",type:"path"}});class vo extends cw{_transformLabelSpec(t){this._addMarkLabelSpec(t,"pie")}_mergeThemeToSpec(t,e){let i=this._theme,r=t;if(this._shouldMergeThemeToSpec()){let i=this._getDefaultSpecFromChart(e);r=it({},this._theme,i,t);let s=(t,e)=>it({},"inside"===t||"inside-center"===t?this._theme.innerLabel:this._theme.outerLabel,e);tY(r.label)?r.label=r.label.map(t=>s(t.position,t)):r.label=s(r.label.position,r.label)}return{spec:r,theme:i}}_getDefaultSpecFromChart(t){var e;let i=null!=(e=super._getDefaultSpecFromChart(t))?e:{},{centerX:r,centerY:s}=t;return t5(r)&&(i.centerX=r),t5(s)&&(i.centerY=s),Object.keys(i).length>0?i:void 0}}let vh=`${s6}_LABEL_VISIBLE`;class vu extends _Y{constructor(){super(...arguments),this.transformerConstructor=vo,this._pieMarkName="pie",this._pieMarkType="arc",this.getCenter=()=>{var t,e;let i=this._region.getLayoutRect();return{x:ex(null==(t=this._spec)?void 0:t.centerX,i.width,i,i.width/2),y:ex(null==(e=this._spec)?void 0:e.centerY,i.height,i,i.height/2)}},this._startAngle=gS,this._endAngle=gk,this._pieMark=null,this._labelMark=null,this._labelLineMark=null,this._emptyArcMark=null,this.dataToCentralPosition=t=>{let e=t[gv];if(et(e))return null;let i=this.computeDatumRadius(t),r=this.computeDatumInnerRadius(t);return lc(this.computeCenter(t),(i+r)/2,e)}}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.getCenter().x,y:()=>this.getCenter().y}),this._markAttributeContext.startAngleScale=t=>this.startAngleScale(t),this._markAttributeContext.endAngleScale=t=>this.endAngleScale(t)}setAttrFromSpec(){var t,e,i,r,s,n;super.setAttrFromSpec(),this._centerOffset=null!=(t=this._spec.centerOffset)?t:0,this._cornerRadius=null!=(e=this._spec.cornerRadius)?e:0;let a=function(t,e){let i=0,r=2*Math.PI,s=t5(t),n=t5(e);for(s||n?n?(i=s?t:e-2*Math.PI,r=e):(i=t,r=t+2*Math.PI):(i=0,r=2*Math.PI);r<=i;)r+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI,r-=2*Math.PI;for(;r<0;)i+=2*Math.PI,r+=2*Math.PI;return{startAngle:i,endAngle:r}}(t5(this._spec.startAngle)?lu(this._spec.startAngle):this._startAngle,t5(this._spec.endAngle)?lu(this._spec.endAngle):this._endAngle);this._startAngle=a.startAngle,this._endAngle=a.endAngle,this._padAngle=t5(this._spec.padAngle)?lu(this._spec.padAngle):0,this.setAngleField(this._spec.valueField||this._spec.angleField),this._spec.categoryField&&this.setSeriesField(this._spec.categoryField),this._radiusField=[],this._specAngleField=this._angleField.slice(),this._specRadiusField=[],this._showEmptyCircle=null!=(r=null==(i=this._spec.emptyPlaceholder)?void 0:i.showEmptyCircle)&&r,this._showAllZero=null!=(s=this._spec.showAllZero)&&s,this._supportNegative=null!=(n=this._spec.supportNegative)&&n}initData(){super.initData();let t=this.getViewData();if(!t)return;sY(this._dataSet,"pie",_K),t.transform({type:"pie",options:{angleField:()=>this._angleField[0],startAngle:()=>this._startAngle,endAngle:()=>this._endAngle,minAngle:()=>t5(this._spec.minAngle)?lu(this._spec.minAngle):0,asStartAngle:gm,asEndAngle:gy,asRatio:gf,asMiddleAngle:gv,asRadian:gx,asQuadrant:gb,asK:g_,showAllZero:this._showAllZero,supportNegative:this._supportNegative,showEmptyCircle:this._showEmptyCircle}},!1);let e=new er(this._dataSet,{name:`${s6}_series_${this.id}_viewDataLabel`});e.parse([this.getViewData()],{type:"dataview"}),this._viewDataLabel=new ly(this._option,e)}compileData(){var t;super.compileData(),null==(t=this._viewDataLabel)||t.compile()}initMark(){this._pieMark=this._createMark(Object.assign(Object.assign({},vu.mark.pie),{name:this._pieMarkName,type:this._pieMarkType}),{key:ni,groupKey:this._seriesField,isSeriesMark:!0},{morph:ck(this._spec,this._pieMarkName),morphElementKey:this._seriesField}),this._showEmptyCircle&&(this._emptyArcMark=this._createMark({name:"emptyCircle",type:"arc"},{dataView:!1}),this._data.addRelatedMark(this._emptyArcMark))}startAngleScale(t){return en(gm)(t)}endAngleScale(t){return en(gy)(t)}_computeLayoutRadius(){return gM(()=>this._spec.layoutRadius,this.getLayoutRect,this.getCenter,()=>({startAngle:this._startAngle,endAngle:this._endAngle}))}initMarkStyle(){let t={x:()=>this.getCenter().x,y:()=>this.getCenter().y,fill:this.getColorAttribute(),outerRadius:ls(this._outerRadius)?this._outerRadius:()=>this._computeLayoutRadius()*this._outerRadius,innerRadius:ls(this._innerRadius)?this._innerRadius:()=>this._computeLayoutRadius()*this._innerRadius,cornerRadius:()=>this._computeLayoutRadius()*this._cornerRadius,startAngle:t=>this.startAngleScale(t),endAngle:t=>this.endAngleScale(t),padAngle:this._padAngle,centerOffset:this._centerOffset},e=this._pieMark;e&&this.setMarkStyle(e,t,"normal",H.Series);let i=this._emptyArcMark;i&&this.setMarkStyle(i,Object.assign(Object.assign({},t),{visible:()=>{let t=this.getViewData().latestData;return!t||!t.length}}),"normal",H.Series)}getInteractionTriggers(){return this._parseInteractionConfig(this._pieMark?[this._pieMark]:[])}initTooltip(){super.initTooltip(),this._pieMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pieMark)}initMarkStyleWithSpec(t,e){if(super.initMarkStyleWithSpec(t,e),t.name===this._pieMarkName){let e=this.getSpec()[t.name];if(e)for(let i in e.state||{})this.setMarkStyle(t,this.generateRadiusStyle(e.state[i]),i,H.User_Mark)}"emptyCircle"===t.name&&this.setMarkStyle(t,this.generateRadiusStyle(e.style),"normal",H.User_Mark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{visible:en(vh).bind(this),text:t=>t[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:this.dataToPositionZ.bind(this)})}afterInitMark(){super.afterInitMark()}initEvent(){var t;super.initEvent(),null==(t=this._viewDataLabel.getDataView())||t.target.addListener("change",this.viewDataLabelUpdate.bind(this))}initGroups(){}onLayoutEnd(){this._viewDataLabel.getDataView().reRunAllTransform(),this.onMarkPositionUpdate(),super.onLayoutEnd()}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return this._specAngleField}viewDataLabelUpdate(){this.event.emit(rB.viewDataLabelUpdate,{model:this}),this._viewDataLabel.updateData()}generateRadiusStyle(t){if(!t)return;let e={};return t.outerRadius&&(e.outerRadius=()=>this._computeLayoutRadius()*t.outerRadius),t.innerRadius&&(e.innerRadius=()=>this._computeLayoutRadius()*t.innerRadius),t.cornerRadius&&(e.cornerRadius=()=>this._computeLayoutRadius()*t.cornerRadius),e}computeCenter(t){return{x:this._pieMark.getAttribute("x",t,"normal"),y:this._pieMark.getAttribute("y",t,"normal")}}getRadius(t="normal"){var e,i,r,s,n,a,l;let o="normal"===t?null==(r=null==(i=this.getSpec()[(null==(e=this._pieMark)?void 0:e.name)||"pie"])?void 0:i.style)?void 0:r.outerRadius:null==(l=null==(a=null==(n=this.getSpec()[(null==(s=this._pieMark)?void 0:s.name)||"pie"])?void 0:n.state)?void 0:a[t])?void 0:l.outerRadius;return null!=o?o:this._outerRadius}getInnerRadius(t="normal"){var e,i,r,s,n,a,l;let o="normal"===t?null==(r=null==(i=this.getSpec()[(null==(e=this._pieMark)?void 0:e.name)||"pie"])?void 0:i.style)?void 0:r.innerRadius:null==(l=null==(a=null==(n=this.getSpec()[(null==(s=this._pieMark)?void 0:s.name)||"pie"])?void 0:n.state)?void 0:a[t])?void 0:l.innerRadius;return null!=o?o:this._innerRadius}computeRadius(t,e){return this._computeLayoutRadius()*t*(et(e)?1:e)+this._centerOffset}computeDatumRadius(t,e){return this._computeLayoutRadius()*this.getRadius(e)+this._centerOffset}_compareSpec(t,e,i){i=null!=i?i:{data:!0};let r=["centerX","centerY","centerOffset","radius","innerRadius","cornerRadius","startAngle","endAngle","padAngle"];r.forEach(t=>{i[t]=!0});let s=super._compareSpec(t,e,i);return t=null!=t?t:{},r.some(i=>t[i]!==e[i])&&(s.reRender=!0,s.change=!0),s}computeDatumInnerRadius(t,e){return this._computeLayoutRadius()*this.getInnerRadius(e)+this._centerOffset}dataToPosition(t,e){let i=t[gv];if(et(i)||e&&!this.isDatumInViewData(t))return null;let r=this.computeDatumRadius(t);return lc(this.computeCenter(t),r,i)}initAnimation(){var t,e,i;let r={growFrom:(t,e,i)=>{var r,s;if(i===D.appear)return this._startAngle;if(i===D.disappear)return this._endAngle;let n=[D.disappear,D.exit],a=this._pieMark.getGraphics(),l=null==t?void 0:t[ne];if(void 0===a.find(t=>{var e;return(null==(e=t.context.data[0])?void 0:e[ne])<l}))return this._startAngle;if(void 0===a.find(t=>{var e;return(null==(e=t.context.data[0])?void 0:e[ne])>l}))return this._endAngle;let o=[...a].reverse().find(t=>{var e;return(null==(e=t.context.data[0])?void 0:e[ne])<l});return n.includes(i)?null==(r=null==o?void 0:o.getFinalAttribute())?void 0:r.endAngle:null==(s=null==o?void 0:o.attribute)?void 0:s.endAngle}},s=null==(t=this._spec.animationAppear)?void 0:t.preset;if(this._pieMark){let t=cv(null==(e=ig.getAnimationInKey("pie"))?void 0:e(r,s),cb("pie",this._spec,this._markAttributeContext));t.normal&&t.normal.type&&(t.normal=function(t,e){var i,r,s,n;let a=null!=(r=null==(i=e.options)?void 0:i.distance)?r:10,l=ee(e.duration)?e.duration/2:1e3,o=null!=(s=e.options.easing)?s:"cubicOut";return{oneByOne:e.oneByOne,loop:null!=(n=e.loop)&&n,timeSlices:[{duration:l,effects:{easing:o,channel:{x:{from:e=>t.getAttribute("x",e),to:e=>t.getAttribute("x",e)+lc({x:0,y:0},a,e[gv]).x},y:{from:e=>t.getAttribute("y",e),to:e=>t.getAttribute("y",e)+lc({x:0,y:0},a,e[gv]).y}}}},{duration:l,effects:{easing:o,channel:{x:{to:e=>t.getAttribute("x",e),from:e=>t.getAttribute("x",e)+lc({x:0,y:0},a,e[gv]).x},y:{to:e=>t.getAttribute("y",e),from:e=>t.getAttribute("y",e)+lc({x:0,y:0},a,e[gv]).y}}}}]}}(this._pieMark,t.normal)),this._pieMark.setAnimationConfig(t)}if(this._emptyArcMark){let t=cv(null==(i=ig.getAnimationInKey("emptyCircle"))?void 0:i(r,null!=s?s:"fadeIn"));this._emptyArcMark.setAnimationConfig(t)}}getDefaultShapeType(){return"circle"}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(t,e){return e}getActiveMarks(){return[this._pieMark]}}vu.transformerConstructor=vo,vu.mark=vl,vu.builtInTheme={pie:{outerRadius:.6,pie:{style:{fillOpacity:1}},label:{visible:!1,interactive:!0,position:"outside",style:{fontWeight:"normal",stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1}},innerLabel:{style:{lineWidth:2}},emptyCircle:{style:{fill:{type:"palette",key:"emptyCircleColor"},fillOpacity:1}}}};class vd extends vu{constructor(){super(...arguments),this.type=rw.pie}}vd.type=rw.pie;let vc=()=>{va(),_4(),_7(),ig.registerSeries(vd.type,vd)};class vp extends fB{_isValidSeries(t){return!this.seriesType||t===this.seriesType}getIndicatorSpec(t){var e,i,r;let s=eo(t.indicator),n=null!=(e=t.innerRadius)?e:null==(r=null==(i=t.series)?void 0:i[0])?void 0:r.innerRadius;return t5(n)&&s.forEach(t=>{et(t.limitRatio)&&(t.limitRatio=n)}),s}_getDefaultSeriesSpec(t,e){return super._getDefaultSeriesSpec(t,["radius","outerRadius","innerRadius","startAngle","endAngle","sortDataByAxis"],e)}transformSpec(t){super.transformSpec(t),tY(t.dataZoom)&&t.dataZoom.length>0&&t.dataZoom.forEach(t=>{"axis"===t.filterMode&&(t.filterMode="filter")}),this.transformSeriesSpec(t),t5(t.indicator)&&(t.indicator=this.getIndicatorSpec(t))}}class vg extends vp{needAxes(){return!1}_getDefaultSeriesSpec(t){var e;let i=super._getDefaultSeriesSpec(t,["center","centerOffset","cornerRadius","padAngle","minAngle","emptyPlaceholder","showAllZero","supportNegative","useSequentialAnimation","layoutRadius"]);return i.categoryField=t.categoryField||t.seriesField,i.valueField=t.valueField||t.angleField,i.emptyCircle=null==(e=t.emptyPlaceholder)?void 0:e.emptyCircle,i}}class vf extends fF{constructor(){super(...arguments),this.transformerConstructor=vg}}vf.transformerConstructor=vg;class vm extends vf{constructor(){super(...arguments),this.transformerConstructor=vg,this.type="pie",this.seriesType=rw.pie}}vm.type="pie",vm.seriesType=rw.pie,vm.transformerConstructor=vg;let vy=()=>{mg(),vc(),ig.registerChart(vm.type,vm)};function v_(t){return"angle"===t?"growAngleIn":"growRadiusIn"}let vv=t=>({type:v_(t.growField),options:{overall:!0}}),vb={type:"fadeIn"},vx=t=>({type:v_(t.growField)}),vS=t=>({type:"angle"===t.growField?"growAngleOut":"growRadiusOut"}),vk=()=>{ig.registerAnimation("rose",(t,e)=>({appear:function(t,e){if(!1===e)return{};switch(e){case"fadeIn":return vb;case"growAngle":return vv(Object.assign(Object.assign({},t),{growField:"angle"}));default:return vv(Object.assign(Object.assign({},t),{growField:"radius"}))}}(t,e),enter:vx(t),exit:vS(t),disappear:vS(t)}))};class vA extends _Y{getStackGroupFields(){return this._angleField}getStackValueField(){return eo(this._spec.valueField)[0]||eo(this._spec.radiusField)[0]}getGroupFields(){return this._angleField}setAttrFromSpec(){super.setAttrFromSpec(),this.setAngleField(this._spec.categoryField||this._spec.angleField),this.setRadiusField(this._spec.valueField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice(),this.setInnerRadiusField(this._spec.valueField||this._spec.radiusField),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent()}setValueFieldToStack(){this.setRadiusField(nl),this.setInnerRadiusField(na)}setValueFieldToPercent(){this.setRadiusField(nh),this.setInnerRadiusField(no)}getDimensionField(){return this._specAngleField}getMeasureField(){return this._specRadiusField}getDefaultShapeType(){return"square"}}let vM=Object.assign(Object.assign({},cd),{rose:{name:"rose",type:"arc"}});class vw extends cw{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){this._addMarkLabelSpec(t,"rose")}}var vT=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class vC extends gj{get center(){return this._center}get startAngle(){return this._startAngle}get endAngle(){return this._endAngle}getOrient(){return this._orient}getDefaultInteractive(){return"angle"!==this._orient}getGroupScales(){return this._groupScales}static getSpecInfo(t){let e,i;if(!t[this.specKey])return null;let r=tY(t[this.specKey]),s=r?t[this.specKey]:[t[this.specKey]],n=[],a=[],l=[];return s.forEach((s,o)=>{if(!function(t){let e=null==t?void 0:t.orient;return"angle"===e||"radius"===e}(s))return;let{axisType:h,componentName:u,startAngle:d,endAngle:c,center:p,outerRadius:g,layoutRadius:f}=gA(s,t);s.center=p,s.startAngle=d,s.endAngle=c,s.outerRadius=g,s.type=h,s.layoutRadius=f;let m={spec:s,specPath:r?[this.specKey,o]:[this.specKey],specInfoPath:["component",this.specKey,o],type:u};n.push(m),"radius"===s.orient?(a.push(m),i=o):(l.push(m),e=o)}),a.forEach(t=>{t.angleAxisIndex=e}),l.forEach(t=>{t.radiusAxisIndex=i}),n}static createComponent(t,e){let{spec:i}=t,r=vT(t,["spec"]),s=ig.getComponentInKey(r.type);return s?new s(i,Object.assign(Object.assign({},e),r)):(e.onError(`Component ${r.type} not found`),null)}constructor(t,e){super(t,e),this.type=rA.polarAxis,this.name=rA.polarAxis,this._defaultBandPosition=0,this._defaultBandInnerPadding=0,this._defaultBandOuterPadding=0,this.layoutType="absolute",this.layoutZIndex=z.Axis,this._tick=void 0,this._center=null,this._startAngle=gS,this._endAngle=gk,this._orient="radius",this._groupScales=[],this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),pW(this._regions,t=>{"radius"===this.getOrient()?gd(t.radiusAxisHelper,this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&(t.radiusAxisHelper=this.axisHelper()):gd(t.angleAxisHelper,this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&(t.angleAxisHelper=this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=t=>{var e;let i=null==(e=this.getRegions())?void 0:e[0];return i?i.getLayoutStartPoint():t},this.getCenter=()=>{var t,e;let i=this.getRefLayoutRect(),{width:r,height:s}=i;return{x:ex(null==(t=this._center)?void 0:t.x,r,i,r/2),y:ex(null==(e=this._center)?void 0:e.y,s,i,s/2)}},this.getRefLayoutRect=()=>this.getRegions()[0].getLayoutRect(),this._coordinateType="polar"}setAttrFromSpec(){super.setAttrFromSpec(),this.visible&&(this._axisStyle=this._getAxisAttributes(),this._gridStyle=this._getGridAttributes()),this._tick=this._spec.tick,this._orient="angle"===this._spec.orient?"angle":"radius",this._center=this._spec.center,this._startAngle=lu(this._spec.startAngle),this._endAngle=lu(this._spec.endAngle),this._inverse=this._spec.inverse}_tickTransformOption(){var t;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimal:null==(t=this._tick)?void 0:t.noDecimals,startAngle:this.startAngle,labelOffset:ga(this._spec),getRadius:()=>this.getOuterRadius(),inside:this._spec.inside})}updateScaleRange(){let t,e=this._scale.range();return t="radius"===this.getOrient()?this._inverse?[this.computeLayoutOuterRadius(),this.computeLayoutInnerRadius()]:[this.computeLayoutInnerRadius(),this.computeLayoutOuterRadius()]:this._inverse?[this._endAngle,this._startAngle]:[this._startAngle,this._endAngle],(!e||!t||e[0]!==t[0]||e[1]!==t[1])&&(this._scale.range(t),!0)}collectSeriesField(t,e){var i,r;return t>0?null==(r=null==(i=e.getGroups())?void 0:i.fields)?void 0:r[t]:"radius"===this.getOrient()?e.getRadiusField():e.getAngleField()}updateSeriesScale(){pW(this._regions,t=>{"radius"===this.getOrient()?gd(t.radiusAxisHelper,this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&(t.setRadiusScale(this._scale),t.radiusAxisHelper=this.axisHelper()):gd(t.angleAxisHelper,this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&(t.setAngleScale(this._scale),t.angleAxisHelper=this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getSeriesStatisticsField(t){let e="radius"===this.getOrient()?t.getRadiusField():t.getAngleField();return ai(this._scale.type)?e:[e[0]]}initGroupScales(){}axisHelper(){return{isContinuous:ai(this._scale.type),dataToPosition:this.dataToPosition.bind(this),coordToPoint:this.coordToPoint.bind(this),pointToCoord:this.pointToCoord.bind(this),center:this.getCenter.bind(this),layoutRadius:this._computeLayoutRadius.bind(this),getScale:(t=0)=>this._scales[t],getAxisId:()=>this.id,getSpec:()=>this._spec}}positionToData(t){let e=this.pointToCoord(t);return"radius"===this.getOrient()?this.invert(e.radius):this.invert(e.angle)}coordToPoint(t){return lc(this.getCenter(),t.radius,t.angle)}pointToCoord(t){let e=this.getCenter();return lp(t,e,this._startAngle,this._endAngle)}getOuterRadius(){return this.computeLayoutOuterRadius()}getInnerRadius(){return this.computeLayoutInnerRadius()}updateLayoutAttribute(){this._visible&&("radius"===this.getOrient()?this._layoutRadiusAxis():this._layoutAngleAxis()),super.updateLayoutAttribute()}_getNormalizedValue(t,e){return 0===e?0:(this.dataToPosition(t)-this._getStartValue())/e}getLabelItems(t){var e;let i=null==(e=this.getTickData())?void 0:e.getLatestData();return i&&i.length?[i.map(e=>gu(e.value,this._getNormalizedValue([e.value],t)))]:[]}_getStartValue(){return"radius"===this.getOrient()?this.computeLayoutInnerRadius():this._startAngle}_layoutAngleAxis(){var t,e,i;let r=this.getCenter(),s=this.computeLayoutOuterRadius(),n=this.computeLayoutInnerRadius(),a=this._endAngle-this._startAngle,l=this.getLabelItems(a),o=Object.assign(Object.assign({},this.getLayoutStartPoint()),{inside:this._spec.inside,center:r,radius:s,innerRadius:n,startAngle:this._startAngle,endAngle:this._endAngle,sides:(null==(i=null==(e=null==(t=this._getRelatedAxis(this._option.radiusAxisIndex))?void 0:t.getSpec())?void 0:e.grid)?void 0:i.smooth)?void 0:this.getScale().domain().length}),h=Object.assign(Object.assign({},o),{size:this.getRefLayoutRect(),title:{text:this._spec.title.text||this._dataFieldText},items:l,orient:"angle",scale:this._scale});this._spec.grid.visible&&(h.grid=Object.assign({type:"line",smoothLink:!0,items:l[0]},o)),this._update(h)}_layoutRadiusAxis(){var t,e,i;let r=this.getCenter(),s=this.computeLayoutOuterRadius(),n=this.computeLayoutInnerRadius(),a=this.coordToPoint({angle:this._startAngle,radius:s}),l=this.coordToPoint({angle:this._startAngle,radius:n}),o=dP.distancePP(l,a),h=this.getLabelItems(o),u=Object.assign(Object.assign({},this.getLayoutStartPoint()),{start:l,end:a,verticalFactor:-1}),d=Object.assign(Object.assign({},u),{title:{text:this._spec.title.text||this._dataFieldText},items:h,orient:"radius",scale:this._scale.clone()});(null==(t=this._spec.grid)?void 0:t.visible)&&(d.grid=Object.assign({items:h[0],type:(null==(e=this._spec.grid)?void 0:e.smooth)?"circle":"polygon",center:r,closed:!0,sides:null==(i=this._getRelatedAxis(this._option.angleAxisIndex))?void 0:i.getScale().domain().length,startAngle:this._startAngle,endAngle:this._endAngle},u)),this._update(d)}_getRelatedAxis(t){if(t5(t))return this._option.getComponentByIndex(this.specKey,t)}_computeLayoutRadius(){return gM(()=>this._spec.layoutRadius,this.getRefLayoutRect,this.getCenter,()=>({startAngle:this._startAngle,endAngle:this._endAngle}))}computeLayoutOuterRadius(){var t;let e=null!=(t=this._spec.outerRadius)?t:this._spec.radius,i=null!=e?e:this.getRefSeriesRadius().outerRadius;return this._computeLayoutRadius()*i}computeLayoutInnerRadius(){var t;let e=null!=(t=this._spec.innerRadius)?t:this.getRefSeriesRadius().innerRadius;return this._computeLayoutRadius()*e}getRefSeriesRadius(){let t=.6,e=0,i=this.getChart().getSpec();return pW(this.getRegions(),r=>{var s;if(s=r.type,[rw.rose,rw.radar,rw.circularProgress].includes(s)){let{outerRadius:s=i.outerRadius,innerRadius:n=i.innerRadius}=r;ee(s)&&(t=s),ee(n)&&(e=n)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),{outerRadius:t,innerRadius:e}}_update(t){let{grid:e}=t,i=vT(t,["grid"]);this._axisMark.getComponent().setAttributes(it({},this._axisStyle,i)),this._gridMark&&this._gridMark.getComponent().setAttributes(it({},this._gridStyle,e))}invert(t){var e;if("angle"===this.getOrient()&&"band"===this._scale.type){let i=this._scale.range(),r=i[i.length-1]-i[0],s=.5===(null!=(e=this.getSpec().bandPosition)?e:this._defaultBandPosition)?0:this._scale.bandwidth()/2;if(i[0]<0){let e=(t+s+Math.abs(i[0]))%r-Math.abs(i[0]);return this._scale.invert(e)}return this._scale.invert((t+s)%r)}return this._scale.invert(t)}}vC.type=rA.polarAxis,vC.specKey="axes";var vE=i(19288),vB=i(59225),vP=i(44368),vO=i(89542);class vI{isInValidValue(t){let{startAngle:e=c5.v2,endAngle:i=c5.Di}=this.attribute;return Math.abs(i-e)%(2*Math.PI)==0?t>1:t<0||t>1}getTickCoord(t){let{startAngle:e=c5.v2,endAngle:i=c5.Di,center:r,radius:s,inside:n=!1,innerRadius:a=0}=this.attribute;return(0,_9.op)(r,n&&a>0?a:s,e+(i-e)*t)}getVerticalVector(t,e=!1,i){return(0,gq.jO)(t,i,this.attribute.center,e,this.attribute.inside)}getRelativeVector(t){let{center:e}=this.attribute;return[t.y-e.y,-1*(t.x-e.x)]}}var vR=i(10308);function vL(t,e){let i=t.length;return{prevLabel:e>=1?t[e-1]:t[i-1],nextLabel:e<i-1?t[e+1]:t[0]}}function vD(t,e,i){var r;t.setAttributes({maxLineWidth:e,ellipsis:null!=(r=t.attribute.ellipsis)?r:i})}function vF(t,e,i){let r=[];if(t.length>=3){let{prevLabel:i,nextLabel:s}=vL(t,e);r.push(i,s)}else 2===t.length&&r.push(t[+(0===e)]);let s=t[e],n=Math.min(Math.abs(s.attribute.y-i.y1),Math.abs(s.attribute.y-i.y2));r.forEach(t=>{n=Math.min(n,Math.abs(t.attribute.y-s.attribute.y))}),n>0&&s.setAttributes({whiteSpace:"normal",heightLimit:n})}var vz=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};(0,g1.WF)();class vj extends vP.I{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},vj.defaultAttributes,t))}renderLine(t){let{startAngle:e=c5.v2,endAngle:i=c5.Di,radius:r,center:s,innerRadius:n=0,line:a={},inside:l=!1,sides:o}=this.attribute,h,u=r,d=n;if(l&&n>0&&(u=n,d=0),(0,uT.Z)(o)&&o>=3){let t=(0,gq.zl)(s,o,u,e,i);h=c$.i.path(Object.assign(Object.assign({},a.style),{path:(0,gq.st)(t,!0)}))}else{let t=Object.assign(Object.assign(Object.assign({},s),{startAngle:e,endAngle:i,radius:u,innerRadius:d}),a.style);h=c$.i.circle(t)}h.name=gD.X9.line,h.id=this._getNodeId("line"),(0,cY.Z)(a.state)||(h.states=(0,cZ.Z)({},gD.n0,a.state)),t.add(h)}getTitleAttribute(){var t,e,i;let{center:r,radius:s,innerRadius:n=0}=this.attribute,a=this.attribute.title,{space:l=4,textStyle:o={},shape:h,background:u,state:d={}}=a,c=vz(a,["space","textStyle","shape","background","state"]),p=r,g=0;(null==(t=this.attribute.label)?void 0:t.visible)&&!1===this.attribute.label.inside&&(g=(0,vB.Z)(this.attribute.label,"style.fontSize",12)+(0,vB.Z)(this.attribute.label,"space",4));let f=0;(null==(e=this.attribute.tick)?void 0:e.visible)&&!1===this.attribute.tick.inside&&(f=this.attribute.tick.length||4),(null==(i=this.attribute.subTick)?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(f=Math.max(f,this.attribute.subTick.length||2));let m=s+f+g+l,y="middle",{position:_}=this.attribute.title;(0,lU.Z)(_)&&(_=0===n?"end":"middle"),"start"===_?(y="bottom",p={x:r.x,y:r.y-m}):"end"===_&&(y="top",p={x:r.x,y:r.y+m});let v=Object.assign(Object.assign(Object.assign({},p),c),{textStyle:Object.assign({textBaseline:y,textAlign:"center"},o),state:{text:(0,cZ.Z)({},gD.n0,d.text),shape:(0,cZ.Z)({},gD.n0,d.shape),panel:(0,cZ.Z)({},gD.n0,d.background)}}),{angle:b}=c;return v.angle=b,h&&h.visible&&(v.shape=Object.assign({visible:!0},h.style),h.space&&(v.space=h.space)),u&&u.visible&&(v.panel=Object.assign({visible:!0},u.style)),v}getSubTickLineItems(){var t,e;let{subTick:i}=this.attribute,r=[],{count:s=4,inside:n=!1,length:a=2}=i,l=this.tickLineItems,o=l.length;if(o>=2){let i=this.data[1].value-this.data[0].value,h=null==(e=null==(t=this.attribute)?void 0:t.tick)?void 0:e.alignWithLabel;for(let t=0;t<o;t++){let e=l[t],o=l[t+1];for(let t=0;t<s;t++){let l=(t+1)/(s+1),u=(1-l)*e.value+l*(o?o.value:h?1:e.value+i),d=this.getTickCoord(u),c=this.getVerticalCoord(d,a,n);r.push({start:d,end:c,value:u})}}}return r}beforeLabelsOverlap(t,e,i,r,s){}handleLabelsOverlap(t,e,i,r,s){if((0,cY.Z)(t))return;let{inside:n,radius:a,center:l,size:o,label:h,orient:u}=this.attribute,d=o?{x1:0,y1:0,x2:o.width,y2:o.height}:{x1:l.x-a,y1:l.y-a,x2:l.x+a,y2:l.y+a},{layoutFunc:c,autoLimit:p,limitEllipsis:g,autoHide:f,autoHideMethod:m,autoHideSeparation:y,autoWrap:_}=h;(0,uc.Z)(c)?c(t,e,r,this):((p||_)&&function(t,e){let{ellipsis:i,inside:r,bounds:s,autoWrap:n,center:a}=e;r||t.forEach((e,r)=>{let{x:l,y:o}=e.attribute,h=e.AABBBounds;if((0,py.Yt)(l,a.x)){if(o>s.y2||o<s.y1)return void vD(e,0,i);let n=s.x2-s.x1;if(t.length>=3){let{prevLabel:s,nextLabel:a}=vL(t,r),o=s.attribute.x,h=a.attribute.x;o>h&&(o=a.attribute.x,h=s.attribute.x);let u=o===h?n:l>=o&&l<=h?h-o:Math.min(Math.abs(o-l),Math.abs(h-l));e.AABBBounds.width()>u&&vD(e,u,i)}else e.AABBBounds.width()>n&&vD(e,n,i)}else l>a.x&&h.x2>s.x2?(vD(e,s.x2-l,i),n&&vF(t,r,s)):l<a.x&&h.x1<s.x1&&(vD(e,l-s.x1,i),n&&vF(t,r,s))})}(t,{inside:n,autoWrap:_,bounds:d,ellipsis:g,center:l}),f&&(0,vR.t)(t,{orient:u,method:m,separation:y}))}afterLabelsOverlap(t,e,i,r,s){}getTextBaseline(t){return .3>Math.abs(t[1]/t[0])?"middle":t[1]<0?"bottom":t[1]>0?"top":"middle"}getLabelAlign(t,e,i){return(0,py.Yt)(t[0],0)?{textAlign:"center",textBaseline:t[1]>0?"top":"bottom"}:t[0]<0?{textAlign:"right",textBaseline:this.getTextBaseline(t)}:t[0]>0?{textAlign:"left",textBaseline:this.getTextBaseline(t)}:{textAlign:"center",textBaseline:"middle"}}getLabelPosition(t,e,i,r){return t}}vj.defaultAttributes=vO.p,(0,gY.jB)(vj,vI);var vH=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};(0,g1.sC)();class vN extends gJ{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},gJ.defaultAttributes,t),e)}getGridPointsByValue(t){let e=this.getTickCoord(t),{radius:i,innerRadius:r=0}=this.attribute;return[e,this.getVerticalCoord(e,i-r,!0)]}getGridAttribute(t){let e,i=[],r=this.attribute,{radius:s,innerRadius:n=0,startAngle:a=c5.v2,endAngle:l=c5.Di,center:o,subGrid:h}=r,u=vH(r,["radius","innerRadius","startAngle","endAngle","center","subGrid"]),{alignWithLabel:d=!0}=u||{},c=s-n,p=this._parseTickSegment();if(t){e=(0,cZ.Z)({},u,h);let t=[],{count:r=4}=h||{},s=this.data.length;if(s>=2){let e=this._getPointsOfSubGrid(p,d);for(let i=0;i<s;i++){let s=e[i],n=e[i+1];t.push({id:`sub-${i}-0`,points:[this.getTickCoord(s.value),this.getVerticalCoord(this.getTickCoord(s.value),c,!0)],datum:{}});for(let e=0;e<r;e++){let a=(e+1)/(r+1),l=(1-a)*s.value+a*(n?n.value:d?1:s.value+p),o=this.getTickCoord(l),h=this.getVerticalCoord(o,c,!0);t.push({id:`sub-${i}-${e+1}`,points:[o,h],datum:{}})}}Math.abs(l-a)%(2*Math.PI)==0&&t.push(t[0]),i=t}}else{e=u;let t=[];(Math.abs(l-a)%(2*Math.PI)==0?[...this.data].concat(this.data[0]):this.data).forEach(e=>{let{point:i}=e;if(!d){let t=e.value-p/2;if(this.isInValidValue(t))return;i=this.getTickCoord(t)}let r=this.getVerticalCoord(i,c,!0);t.push({id:e.id,points:[i,r],datum:e})}),i=t}return Object.assign(Object.assign({},e),{items:i,center:o,type:"line"})}}(0,gY.jB)(vN,vI);let vV={grid:{smooth:!0,visible:!0},subGrid:{smooth:!0,visible:!1}},vW={grid:{visible:!0,style:{lineDash:[6,6]}},label:{space:5}};class vU extends vC{constructor(){super(...arguments),this.type=rA.polarBandAxis,this._scale=new a9}computeDomain(t){return this.computeBandDomain(t)}updateScaleRange(){let t=super.updateScaleRange();return this.updateGroupScaleRange(),t}axisHelper(){let t=super.axisHelper();return Object.assign(Object.assign({},t),{getBandwidth:e=>t.getScale(e).bandwidth()})}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}registerTicksTransform(){let t=`${this.type}-ticks`;return sY(this._option.dataSet,t,vE.t),t}transformScaleDomain(){}}vU.type=rA.polarBandAxis,vU.specKey="axes",vU.builtInTheme={axis:g4,axisBand:g5,axisAngle:vW,axisRadius:vV},cD(vU,gZ);let vG=()=>{ig.registerGraphicComponent($.lineAxis,(t,e)=>new g3.$(t,e)),ig.registerGraphicComponent(Y.lineAxisGrid,(t,e)=>new g2(t,e)),ig.registerGraphicComponent($.circleAxis,(t,e)=>new vj(t,e)),ig.registerGraphicComponent(Y.circleAxisGrid,(t,e)=>new vN(t,e)),gH(),ig.registerComponent(vU.type,vU)};class vZ extends vC{constructor(){super(...arguments),this.type=rA.polarLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new a2}setAttrFromSpec(){super.setAttrFromSpec(),this.setExtraAttrFromSpec()}initScales(){super.initScales(),this.setScaleNice()}computeDomain(t){return this.computeLinearDomain(t)}axisHelper(){let t=super.axisHelper();return t.setExtendDomain=this.setExtendDomain.bind(this),t}registerTicksTransform(){let t=`${this.type}-ticks`;return sY(this._option.dataSet,t,fh.m),t}}vZ.type=rA.polarLinearAxis,vZ.specKey="axes",vZ.builtInTheme={axis:g4,axisLinear:fu,axisAngle:vW,axisRadius:vV},cD(vZ,fo);let v$=()=>{ig.registerGraphicComponent($.lineAxis,(t,e)=>new g3.$(t,e)),ig.registerGraphicComponent(Y.lineAxisGrid,(t,e)=>new g2(t,e)),ig.registerGraphicComponent($.circleAxis,(t,e)=>new vj(t,e)),ig.registerGraphicComponent(Y.circleAxisGrid,(t,e)=>new vN(t,e)),gH(),ig.registerComponent(vZ.type,vZ)};class vY extends vA{constructor(){super(...arguments),this.type=rw.rose,this.transformerConstructor=vw,this._roseMark=null,this._labelMark=null}initMark(){this.initRoseMark()}initMarkStyle(){this.initRoseMarkStyle()}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y}),this._markAttributeContext.startAngleScale=t=>this.startAngleScale(t),this._markAttributeContext.endAngleScale=t=>this.endAngleScale(t)}initRoseMark(){this._roseMark=this._createMark(vY.mark.rose,{groupKey:this._seriesField,isSeriesMark:!0},{morph:ck(this._spec,vY.mark.rose.name),morphElementKey:this.getDimensionField()[0]})}getRoseAngle(){var t,e,i;return null!=(i=null==(e=(t=this.angleAxisHelper).getBandwidth)?void 0:e.call(t,this._groups?this._groups.fields.length-1:0))?i:.5}startAngleScale(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}endAngleScale(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+this.getRoseAngle()-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}initRoseMarkStyle(){let t=this._roseMark;t&&this.setMarkStyle(t,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:t=>this.startAngleScale(t),endAngle:t=>this.endAngleScale(t),fill:this.getColorAttribute(),outerRadius:t=>lr(this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]]),this.radiusAxisHelper.getScale(0)),innerRadius:t=>{var e;if(!this.getStack())return 0;let i=lr(this.radiusAxisHelper.dataToPosition([t[this._innerRadiusField[0]]]),this.radiusAxisHelper.getScale(0));return i<=Number.MIN_VALUE?this._computeLayoutRadius()*(null!=(e=this._spec.innerRadius)?e:0):i}})}initTooltip(){super.initTooltip(),this._roseMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._roseMark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{text:t=>t[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:0})}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._roseMark&&this._roseMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("rose"))?void 0:i({innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!=(t=this._spec.innerRadius)?t:0)}},r),cb("rose",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._roseMark]}}vY.type=rw.rose,vY.mark=vM,vY.builtInTheme={rose:{rose:{style:{fillOpacity:1}},label:{style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"},textAlign:"center",textBaseline:"middle"}}}},vY.transformerConstructor=vw;let vX=()=>{ig.registerSeries(vY.type,vY),va(),vk(),vG(),v$()};class vK extends vp{needAxes(){return!0}_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.categoryField=t.categoryField||t.angleField,e.valueField=t.valueField||t.radiusField,e}transformSpec(t){var e;if(super.transformSpec(t),this.needAxes()){t.axes||(t.axes=[]);let i={radius:!1,angle:!1};(null!=(e=t.axes)?e:[]).forEach(t=>{let{orient:e}=t;"radius"===e&&(i.radius=!0),"angle"===e&&(i.angle=!0)}),i.angle||t.axes.push({orient:"angle"}),i.radius||t.axes.push({orient:"radius"})}}}class vq extends vK{_getDefaultSeriesSpec(t){var e,i,r;let s=super._getDefaultSeriesSpec(t);return s.radius=null!=(e=t.radius)?e:.6,s.outerRadius=null!=(i=t.outerRadius)?i:.6,s.innerRadius=null!=(r=t.innerRadius)?r:0,s.stack=t.stack,s.percent=t.percent,s}transformSpec(t){var e;super.transformSpec(t),(null!=(e=t.axes)?e:[]).forEach(t=>{["domainLine","grid","label","tick"].forEach(e=>{t[e]||(t[e]={visible:!1})}),"angle"===t.orient&&et(t.bandPosition)&&(t.bandPosition=.5)}),t.crosshair=eo(t.crosshair||{}).map(t=>it({categoryField:{visible:!0,line:{visible:!0,type:"rect"}}},t))}}let vQ=(t,e)=>{let i=2*Math.PI,r=ed(e),s=eu(e);return t<r?t+=Math.ceil((r-t)/i)*i:t>s&&(t-=Math.ceil((t-s)/i)*i),t},vJ=(t,e)=>{if(!t)return null;let i=fq(t,t=>"angle"===t.getOrient(),e),r=fq(t,t=>"radius"===t.getOrient(),e);if(!(i&&i.length||r&&r.length))return null;let s=[],n=t=>t.getDimensionField()[0],{x:a,y:l}=e;return i&&i.forEach(t=>{var e;let i=t.getScale();if(i&&ar(i.type)){let o=i.domain(),h=i.range(),u=t.getCenter(),d={x:a-t.getLayoutStartPoint().x-u.x,y:l-t.getLayoutStartPoint().y-u.y},c=dF({x:1,y:0},d);c=vQ(c,h);let p=dz(d),g=null==(e=r[0])?void 0:e.getScale(),f=null==g?void 0:g.range();if((c-(null==h?void 0:h[0]))*(c-(null==h?void 0:h[1]))>0||(p-(null==f?void 0:f[0]))*(p-(null==f?void 0:f[1]))>0)return;let m=t.invert(c);if(et(m))return;let y=o.findIndex(t=>(null==t?void 0:t.toString())===m.toString());y<0&&(y=void 0);let _=fX(m,t,"polar",n);s.push({index:y,value:m,position:i.scale(m),axis:t,data:_})}}),r&&r.forEach(t=>{var e;let r=t.getScale(),o=null==r?void 0:r.range();if(r&&ar(r.type)){let h=t.getCenter(),u={x:a-t.getLayoutStartPoint().x-h.x,y:l-t.getLayoutStartPoint().y-h.y},d=dF({x:1,y:0},u);d<-Math.PI/2&&(d=2*Math.PI+d);let c=dz(u),p=null==(e=i[0])?void 0:e.getScale(),g=null==p?void 0:p.range();if((d-(null==g?void 0:g[0]))*(d-(null==g?void 0:g[1]))>0||(c-(null==o?void 0:o[0]))*(c-(null==o?void 0:o[1]))>0)return;let f=r.invert(c);if(et(f))return;let m=r.domain().findIndex(t=>(null==t?void 0:t.toString())===f.toString());m<0&&(m=void 0);let y=fX(f,t,"polar",n);s.push({index:m,value:f,position:r.scale(f),axis:t,data:y})}}),s.length?s:null};class v0 extends fF{constructor(){super(...arguments),this.transformerConstructor=vq,this.type="rose",this.seriesType=rw.rose}_setModelOption(){this._modelOption.getDimensionInfo=vJ}}v0.type="rose",v0.seriesType=rw.rose,v0.transformerConstructor=vq,cD(v0,fH);let v1=()=>{mc(),mg(),f0(),fW(),vX(),ig.registerChart(v0.type,v0)};class v2 extends lZ.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this._center=e.center}getEndProps(){return!1===this.valid?{}:lc(this._center,this._toRadius,this._toAngle)}onBind(){this.from=this.target.attribute,this.to=this.target.getFinalAttribute(),this._prevCenter=this.target.attribute.center,this._center&&this._prevCenter||(this.valid=!1);let{angle:t,radius:e}=lp(this.from,this._prevCenter),{angle:i,radius:r}=lp(this.to,this._center);ee(i*r)||(this.valid=!1),this._fromAngle=ee(t)?t:i,this._fromRadius=ee(e)?e:r,this._toAngle=i,this._toRadius=r,a3(this._fromAngle,this._toAngle)&&a3(this._fromRadius,this._toRadius)&&(this.valid=!1),this.props=this.getEndProps()}onUpdate(t,e,i){if(!1===this.valid)return i.x=this.to.x,void(i.y=this.to.y);let{x:r,y:s}=lc({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*e,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*e},this._fromRadius+(this._toRadius-this._fromRadius)*e,this._fromAngle+(this._toAngle-this._fromAngle)*e);this.target.setAttributes({x:r,y:s}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class v3 extends uB{onBind(){super.onBind();let{center:t}=this.target.attribute,{center:e}=this.target.getFinalAttribute();this._center=e,this._prevCenter=t}onUpdate(t,e,i){this.points=this.points.map((r,s)=>{let n=this.polarPointInterpolation(this.interpolatePoints[s][0],this.interpolatePoints[s][1],e);return t&&(i.center=this._center),n.context=r.context,n}),this.target.attribute.points=this.points,this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}_interpolationSinglePoint(t,e,i){if(!dj(t)&&!dj(e))return e;let r=lp(t,this._prevCenter),s=lp(e,this._center),n=lg(r.angle),a=lg(s.angle);!ee(n)&&ee(a)&&(n=a),ee(n)&&!ee(a)&&(a=n);let l=n+(a-n)*i,o=r.radius+(s.radius-r.radius)*i;return lc({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*i,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*i},o,l)}polarPointInterpolation(t,e,i){let{x:r,y:s}=this._interpolationSinglePoint(t,e,i),{x:n,y:a}=this._interpolationSinglePoint({x:t.x1,y:t.y1},{x:e.x1,y:e.y1},i),l=new dB(r,s,n,a);return l.defined=e.defined,l}}let v5=t=>({type:"in"===t?"fadeIn":"fadeOut"}),v4=(t,e)=>({type:"in"===e?"growPointsIn":"growPointsOut",options:()=>({center:t.center()})});function v7(t,e,i){return"fadeIn"===e?v5(i):v4(t,i)}let v6=(t,e)=>{let i=()=>{var e;return null==(e=t.center())?void 0:e.x},r=(t,e)=>e.getGraphicAttribute("x"),s=()=>{var e;return null==(e=t.center())?void 0:e.y},n=(t,e)=>e.getGraphicAttribute("y");return"in"===e?{channel:{x:{from:i,to:r},y:{from:s,to:n}}}:{channel:{x:{from:r,to:i},y:{from:n,to:s}}}};function v9(t,e,i){return"fadeIn"===e?v5(i):v6(t,i)}let v8=(t,e)=>({custom:uM,customParameters:(i,r)=>{var s;return{group:r,startAngle:null!=(s=t.startAngle)?s:Math.PI/2,orient:"clockwise",center:t.center(),radius:t.radius(),animationType:e}}}),bt=()=>{ig.registerAnimation("radar",(t,e)=>({appear:"clipIn"===e?void 0:v7(t,e,"in"),enter:v7(t,e,"in"),exit:v7(t,e,"out"),disappear:"clipIn"===e?void 0:v7(t,e,"out"),update:[{channel:["points","center"],custom:v3,customParameters:t,duration:uX.update.duration,easing:uX.update.easing},{type:"update",options:{excludeChannels:["points","defined","center"]}}]})),ig.registerAnimation("radarSymbol",(t,e)=>({appear:"clipIn"===e?void 0:v9(t,e,"in"),enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:"clipIn"===e?void 0:v9(t,e,"out"),update:[{options:{excludeChannels:["x","y","center"]}},{channel:["x","y","center"],custom:v2,customParameters:t,duration:uX.update.duration,easing:uX.update.easing}]})),ig.registerAnimation("radarGroup",(t,e)=>({appear:v8(t,"in"),disappear:v8(t,"out")})),(0,vr.x)()},be=Object.assign(Object.assign(Object.assign({},cd),cR),{area:{name:"area",type:"area"}});class bi extends vA{constructor(){super(...arguments),this.type=rw.radar,this.transformerConstructor=pz,this._sortDataByAxis=!1}initGroups(){}compile(){super.compile(),this.addOverlapCompile()}initMark(){var t,e,i,r;let s=!1!==(null==(t=this._spec.area)?void 0:t.visible)&&!1!==(null==(i=null==(e=this._spec.area)?void 0:e.style)?void 0:i.visible),n=null!=(r=this._spec.seriesMark)?r:"area";this.initAreaMark(s&&"area"===n),this.initLineMark("line"===n||"area"===n&&!s),this.initSymbolMark("point"===n)}initMarkStyle(){this.initAreaMarkStyle(),this.initLineMarkStyle(),this.initSymbolMarkStyle(),[this._lineMark,this._symbolMark,this._areaMark].forEach(t=>{t&&this.setMarkStyle(t,{center:()=>{var t;return null==(t=this.angleAxisHelper)?void 0:t.center()}})})}initAreaMark(t){this._areaMark=this._createMark(bi.mark.area,{groupKey:this._seriesField,isSeriesMark:t})}initAreaMarkStyle(){let t=this._areaMark;t&&(this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),x1:t=>t&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getStack()?this.getDatumPositionValues(t,this._innerRadiusField):this.radiusScale.domain()[0]).x:Number.NaN,y1:t=>t&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getStack()?this.getDatumPositionValues(t,this._innerRadiusField):this.radiusScale.domain()[0]).y:Number.NaN,fill:this.getColorAttribute(),curveType:cO,closePath:!0},"normal",H.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",H.Series),this.event.on(rB.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(t,"defined")}))}initTooltip(){super.initTooltip();let{group:t,mark:e}=this._tooltipHelper.activeTriggerSet;this._lineMark&&t.add(this._lineMark),this._areaMark&&t.add(this._areaMark),this._symbolMark&&(e.add(this._symbolMark),t.add(this._symbolMark))}initAnimation(){var t,e,i,r;let s={center:()=>{var t;return null==(t=this.angleAxisHelper)?void 0:t.center()},radius:()=>{let t=this.getLayoutRect();return Math.min(t.width,t.height)},startAngle:t5(this._spec.startAngle)?lu(this._spec.startAngle):gS},n=null!=(i=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset)?i:"clipIn";"clipIn"===n&&this._rootMark&&this._rootMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("radarGroup"))?void 0:r(s,n),cb("group",this._spec,this._markAttributeContext))),[[this._areaMark,"radar"],[this._lineMark,"radar"],[this._symbolMark,"radarSymbol"]].forEach(([t,e])=>{if(t5(t)){let i=ig.getAnimationInKey(e);t.setAnimationConfig(cv(null==i?void 0:i(s,n),cb(t.name,this._spec,this._markAttributeContext)))}})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}getSeriesStyle(t){return e=>{var i,r,s,n;let a=null!=(r=null==(i=this._seriesMark)?void 0:i.getAttribute(e,t))?r:void 0;return"fill"!==e||a||(e="stroke",a=null!=(n=null==(s=this._seriesMark)?void 0:s.getAttribute(e,t))?n:void 0),"stroke"===e&&tY(a)?a[0]:a}}}bi.type=rw.radar,bi.mark=be,bi.builtInTheme={radar:{label:{visible:!1,offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}}},bi.transformerConstructor=pz,cD(bi,cL);let br=()=>{ig.registerSeries(bi.type,bi),mD(),pI(),pF(),bt(),vG(),v$()};class bs extends vK{_getDefaultSeriesSpec(t){var e;let i=super._getDefaultSeriesSpec(t);return i.line=t.line,i.point=t.point,i.stack=t.stack,i.percent=t.percent,i.area=it({visible:!1},t.area),i.seriesMark=null!=(e=t.seriesMark)?e:"area",i.activePoint=t.activePoint,i.pointDis=t.pointDis,i.pointDisMul=t.pointDisMul,i.markOverlap=t.markOverlap,i}transformSpec(t){var e;super.transformSpec(t),(null!=(e=t.axes)?e:[]).forEach(t=>{"radius"===t.orient&&(["domainLine","label","tick"].forEach(e=>{t[e]||(t[e]={visible:!1})}),t.grid||(t.grid={visible:!0}))}),t.crosshair=eo(t.crosshair||{}).map(t=>it({categoryField:{visible:!0,line:{visible:!0,type:"line"}}},t))}}class bn extends fF{constructor(){super(...arguments),this.transformerConstructor=bs,this.type="radar",this.seriesType=rw.radar}_setModelOption(){this._modelOption.getDimensionInfo=vJ}}bn.type="radar",bn.seriesType=rw.radar,bn.transformerConstructor=bs,cD(bn,fH);let ba=()=>{mc(),mg(),mm(),f0(),fW(),br(),ig.registerChart(bn.type,bn)};class bl extends fB{_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return delete e.data,e}_transformAxisSpec(t){t.axes&&t.autoBandSize&&t.series.forEach((e,i)=>{var r;if("bar"===e.type){let s=this._findBandAxisBySeries(e,i,t.axes);if(s&&!s.bandSize&&!s.maxBandSize&&!s.minBandSize){let t=ey(e.autoBandSize)&&null!=(r=e.autoBandSize.extend)?r:0,{barMaxWidth:i,barMinWidth:n,barWidth:a,barGapInGroup:l}=e;this._applyAxisBandSize(s,t,{barMaxWidth:i,barMinWidth:n,barWidth:a,barGapInGroup:l})}}})}transformSpec(t){if(super.transformSpec(t),t.series&&t.series.length){let e=this._getDefaultSeriesSpec(t);t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})})}t.axes&&t.axes.length&&t.axes.forEach(e=>{iF(e,"trimPadding")&&it(e,nH(this.type,t))}),this._transformAxisSpec(t)}}class bo extends fF{constructor(){super(...arguments),this.transformerConstructor=bl,this.type="common"}_setModelOption(){this._modelOption.getDimensionInfo=(t,e,i)=>{var r,s;return[...null!=(r=f7(t,e,i))?r:[],...null!=(s=vJ(t,e))?s:[]]},this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}bo.type="common",bo.transformerConstructor=bl,cD(bo,fH);let bh=()=>{mc(),mg(),mm(),f0(),ig.registerChart(bo.type,bo),fW()};class bu extends d8{constructor(){super(...arguments),this.shapeTypeCallback=()=>"square"}enableByType(t){return"mark"===t}getDefaultTitlePattern(t){return{key:"link info",value:"link info"}}getDefaultContentList(){return[{key:"time",value:t=>dq.getInstance().timeFormat("%Y%m%d %H:%M",t.from.split("_")[1])},{key:"type",value:t=>t.action_type},{key:"from",value:t=>t.from},{key:"to",value:t=>t.to}]}}var bd=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class bc extends oa{constructor(){super(...arguments),this.type=bc.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x1:0,y1:0})}_transformGraphicAttributes(t,e,i){let r=super._transformGraphicAttributes(t,e,i),{x:s,x1:n,y:a,y1:l}=r;return Object.assign(Object.assign({},bd(r,["x","x1","y","y1"])),{points:[{x:s,y:a},{x:n,y:l}]})}_createGraphic(t={}){return(0,cU.W)(t)}}bc.type="rule";let bp=()=>{ig.registerMark(bc.type,bc),(0,ol.W)(),(0,cG.N)(),ig.registerGraphicComponent("line",cU.W)},bg=Object.assign(Object.assign({},cd),{group:{name:"group",type:"group"},link:{name:"link",type:"rule"},arrow:{name:"arrow",type:"symbol"}}),bf=(t,e)=>{let{infoKey:i,fields:r,linkData:s,dotData:n}=e,{fromField:a,toField:l,xField:o,yField:h}=r(),u=s(),d=n(),c={};return d.forEach(t=>{let e={};for(let r in t)r!==i&&(e[r]=t[r]);let r=t[i];null==r||r.forEach(t=>{c[t.node_name]=Object.assign({},e,t)})}),u.forEach(t=>{var e,i,r,s;t[a+"_xField"]=null==(e=null==c?void 0:c[t[a]])?void 0:e[o],t[a+"_yField"]=null==(i=null==c?void 0:c[t[a]])?void 0:i[h],t[l+"_xField"]=null==(r=null==c?void 0:c[t[l]])?void 0:r[o],t[l+"_yField"]=null==(s=null==c?void 0:c[t[l]])?void 0:s[h]}),u};class bm extends cB{constructor(){super(...arguments),this.type=rw.link}getFromField(){return this._fromField}setFromField(t){t5(t)&&(this._fromField=t)}getToField(){return this._toField}setToField(t){t5(t)&&(this._toField=t)}getDotTypeField(){return this._dotTypeField}setDotTypeField(t){t5(t)&&(this._dotTypeField=t)}getDotSeriesSpec(){return this._dotSeriesSpec}setDotSeriesSpec(t){t5(t)&&(this._dotSeriesSpec=t)}_getDotData(){let t=this._option.getChart().getSeriesInIndex([this._spec.dotSeriesIndex])[0];return t?t.getRawData().latestData:[]}initData(){var t;super.initData(),sY(this._option.dataSet,"linkDotInfo",bf),null==(t=this.getViewData())||t.transform({type:"linkDotInfo",options:{infoKey:"dots",fields:()=>({fromField:this._fromField,toField:this._toField,xField:this._dotSeriesSpec.xField,yField:this._dotSeriesSpec.yField}),linkData:()=>this._rawData.latestData,dotData:()=>this._getDotData()},level:L.linkDotInfo},!1)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFromField(this._spec.fromField),this.setToField(this._spec.toField),this.setDotTypeField(this._spec.dotTypeField),this.setDotSeriesSpec(this._spec.dotSeriesSpec)}initMark(){this._clipMark=this._createMark(bm.mark.group),this._containerMark=this._createMark(bm.mark.group,{parent:this._clipMark}),this._linkMark=this._createMark(bm.mark.link,{skipBeforeLayouted:!1,parent:this._containerMark}),this._arrowMark=this._createMark(bm.mark.arrow,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark})}initMarkStyle(){var t,e,i,r;let s=this._clipMark;s&&(this.setMarkStyle(s,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",H.Series),s.setMarkConfig({interactive:!1,clip:!0}));let n=this._containerMark;n&&(this.setMarkStyle(n,{x:this._spec.leftAppendPadding,width:this.getLayoutRect().width},"normal",H.Series),n.setMarkConfig({interactive:!1}));let a=this._linkMark;a&&this.setMarkStyle(a,{stroke:this.getColorAttribute(),strokeOpacity:this.dataToOpacity.bind(this),x:this.dataToPositionXFrom.bind(this),y:this.dataToPositionYFrom.bind(this),x1:this.dataToPositionXTo.bind(this),y1:this.dataToPositionYTo.bind(this)},"normal",H.Series);let l=this._arrowMark;if(l){let s=null!=(r=null==(i=null==(e=null==(t=this._theme)?void 0:t.arrow)?void 0:e.style)?void 0:i.size)?r:10;this.setMarkStyle(l,{x:this.dataToPositionXTo.bind(this),y:t=>this.dataToPositionArrowYTo(t,s),fill:this.getColorAttribute(),fillOpacity:this.dataToOpacity.bind(this),size:s,symbolType:t=>this.isPositionYFromHigher(t)?"triangleDown":"triangleUp"},"normal",H.Series)}}afterInitMark(){super.afterInitMark()}dataToPositionXFrom(t){if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._fromField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYFrom(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fromField+"_yField"))}dataToPositionXTo(t){if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._toField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYTo(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})}dataToPositionArrowYTo(t,e){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:i}=this._yAxisHelper,r=this.isPositionYFromHigher(t)?-e/2:e/2;return i(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})+r}dataToOpacity(t){return this.isPositionXOuterRange(t,this._fromField+"_xField")||this.isPositionXOuterRange(t,this._toField+"_xField")||t[this._fromField]===t[this._toField]?0:1}isPositionYFromHigher(t){return this.dataToPositionYFrom(t)<this.dataToPositionYTo(t)}isPositionXOuterRange(t,e){if(!this._xAxisHelper)return!1;let{dataToPosition:i,getScale:r}=this._xAxisHelper;return i(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})<r(0).range()[0]||i(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})>r(0).range()[1]}getDefaultColorDomain(){var t,e;return this._dotTypeField?null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._dotTypeField].values:this._seriesField?null==(e=this.getViewDataStatistics())?void 0:e.latestData[this._seriesField].values:[]}getColorAttribute(){var t,e,i;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:null!=(i=null!=(e=this._dotTypeField)?e:this._seriesField)?i:nr}}getInteractionTriggers(){let t=[];return this._linkMark&&t.push(this._linkMark),this._arrowMark&&t.push(this._arrowMark),this._parseInteractionConfig(t)}initTooltip(){this._tooltipHelper=new bu(this),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._arrowMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._arrowMark)}onMarkTreePositionUpdate(t){t.forEach(t=>{t.commit(!1,!0)})}getDotInfoData(){var t,e;return null==(e=null!=(t=this._linkMark)?t:this._arrowMark)?void 0:e.getData()}getActiveMarks(){return[this._linkMark,this._arrowMark]}}bm.type=rw.link,bm.mark=bg,bm.builtInTheme={link:{arrow:{style:{size:10}}}};let by=()=>{bp(),pF(),g8(),fc(),ig.registerSeries(bm.type,bm)};class b_ extends d8{constructor(){super(...arguments),this.shapeTypeCallback=()=>"square"}enableByType(t){return"mark"===t}getDefaultTitlePattern(t){return{key:"event info",value:"event info"}}getDefaultContentList(){return[{key:t=>t.type,value:t=>t.id},{key:"event_time",value:t=>dq.getInstance().timeFormat("%Y%m%d",t.event_time)},{key:"action_type",value:t=>t.action_type},{key:"children",value:t=>t.children}]}getTooltipData(t,e,i,r,s){var n,a,l,o;let h=super.getTooltipData(t,e,i,r,s),u=null!=(l=null==(a=null==(n=this.spec)?void 0:n[t])?void 0:a.updateContent)?l:null==(o=null==e?void 0:e[t])?void 0:o.updateContent;return h&&!u&&(h.updateContent=(t,e,i)=>{let r=[],s=t.filter(t=>"children"===t.key);return s.length>0&&s[0].value.forEach(t=>{let e=!0;for(let i in t)r.push(Object.assign(Object.assign({},s[0]),{shapeType:"circle",hasShape:e,key:i,value:t[i]+""})),e=!1}),t.concat(r)}),h}}let bv=(t,e)=>{var i;let r=(null==(i=t[0])?void 0:i.latestData)?t[0].latestData:t||[],s=[],n=0;return r.forEach(t=>{let i,r={};for(let s in t)s===e||s.startsWith(s6)||(r[s]=t[s],i=t5(i)?`${i}_${t[s]}`:`${t[s]}`);let a=t[e];null==a||a.forEach((t,e)=>{s.push(Object.assign({},r,t,{[ne]:n,[ni]:`${i}_${e}`})),n++})}),s},bb={fill:"#bbb",fillOpacity:.2};var bx=i(93342);class bS extends oa{getTextType(){return this._textType}constructor(t,e){super(t,e),this.type=bS.type,this._textType="text"}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{angle:0,textAlign:"center",lineWidth:0,textConfig:[]})}initStyleWithSpec(t){super.initStyleWithSpec(t),t.textType&&(this._textType=t.textType)}_transformGraphicAttributes(t,e,i){let r=super._transformGraphicAttributes(t,e,i),{text:s}=r;return ey(s)&&t5(s.text)&&("rich"===this._textType||"rich"===s.type)&&(r.textConfig=s.text),r}_createGraphic(t={}){let{text:e}=t;return"rich"===this._textType||"rich"===(null==e?void 0:e.type)?(0,bx.p)(t):(0,gN.r)(t)}}bS.type="text";let bk=()=>{ig.registerMark(bS.type,bS),(0,ol.W)(),(0,pu.g)(),(0,pd.v)(),ig.registerGraphicComponent("text",gN.r),ig.registerGraphicComponent("richtext",bx.p)},bA=Object.assign(Object.assign({},cd),{group:{name:"group",type:"group"},grid:{name:"grid",type:"rule"},gridBackground:{name:"gridBackground",type:"rect"},dot:{name:"dot",type:"symbol"},title:{name:"title",type:"text"},subTitle:{name:"subTitle",type:"text"},symbol:{name:"symbol",type:"symbol"}});class bM extends cB{constructor(){super(...arguments),this.type=rw.dot}getSeriesGroupField(){return this._seriesField}setSeriesGroupField(t){t5(t)&&(this._seriesGroupField=t)}getTitleField(){return this._titleField}setTitleField(t){t5(t)&&(this._titleField=t)}getSubTitleField(){return this._subTitleField}setSubTitleField(t){t5(t)&&(this._subTitleField=t)}getDotTypeField(){return this._dotTypeField}setDotTypeField(t){t5(t)&&(this._dotTypeField=t)}getHighLightSeriesGroup(){return this._highLightSeriesGroup}setHighLightSeriesGroup(t){t5(t)&&(this._highLightSeriesGroup=t)}setGridBackground(t){t5(t)&&(this._gridBackground=t)}initData(){var t;super.initData(),this._xDimensionStatisticsDomain=this.getRawData().latestData.map(t=>t[this._fieldY[0]]),sY(this._option.dataSet,"objFlat",bv),sY(this._option.dataSet,"copyDataView",s0),sX(this._option.dataSet,"dataview",tX),null==(t=this.getViewData())||t.transform({type:"objFlat",options:"dots",level:L.dotObjFlat},!1)}getStatisticFields(){return[{key:this._fieldY[0],operations:["values"],customize:this._xDimensionStatisticsDomain}]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setSeriesGroupField(this._spec.seriesGroupField),this.setTitleField(this._spec.titleField),this.setSubTitleField(this._spec.subTitleField),this.setDotTypeField(this._spec.dotTypeField),this.setHighLightSeriesGroup(this._spec.highLightSeriesGroup),this.setGridBackground(it(bb,(null==(t=this._spec.grid)?void 0:t.background)||{}))}initMark(){this._clipMark=this._createMark(bM.mark.group),this._containerMark=this._createMark(bM.mark.group,{parent:this._clipMark,dataView:this.getRawData()}),this._gridBackgroundMark=this._createMark(bM.mark.gridBackground,{parent:this._containerMark,dataView:this.getRawData()}),this._gridMark=this._createMark(bM.mark.grid,{parent:this._containerMark,dataView:this.getRawData()}),this._dotMark=this._createMark(bM.mark.dot,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark}),this._titleMark=this._createMark(bM.mark.title,{parent:this._containerMark,dataView:this.getRawData()}),this._subTitleMark=this._createMark(bM.mark.subTitle,{parent:this._containerMark,dataView:this.getRawData()}),this._symbolMark=this._createMark(bM.mark.symbol,{parent:this._containerMark,dataView:this.getRawData()})}initMarkStyle(){let t=this._clipMark;t&&(this.setMarkStyle(t,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",H.Series),t.setMarkConfig({interactive:!1,clip:!0}));let e=this._containerMark;e&&(this.setMarkStyle(e,{x:this._spec.leftAppendPadding},"normal",H.Series),e.setMarkConfig({interactive:!1}));let i=this._gridBackgroundMark;i&&this.setMarkStyle(i,{x:this.getRegionRectLeft.bind(this),x1:this.getRegionRectRight.bind(this),y:this.dataToGridBackgroundPositionY.bind(this),y1:this.dataToGridBackgroundPositionY1.bind(this),fill:this._gridBackground.fill,fillOpacity:this.dataToGridBackgroundOpacity.bind(this)},"normal",H.Series);let r=this._gridMark;r&&this.setMarkStyle(r,{stroke:this.getColorAttribute(),x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),x1:this.getRegionRectRight.bind(this),y1:this.dataToPositionY.bind(this)},"normal",H.Series);let s=this._dotMark;s&&this.setMarkStyle(s,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),fill:this.getDotColorAttribute(),stroke:this.getDotColorAttribute(),fillOpacity:this.dataToOpacity.bind(this)},"normal",H.Series);let n=this._titleMark;n&&this.setMarkStyle(n,{fill:this.getColorAttribute(),text:t=>t[this.getTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",H.Series);let a=this._subTitleMark;a&&this.setMarkStyle(a,{fill:this.getColorAttribute(),text:t=>t[this.getSubTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",H.Series);let l=this._symbolMark;l&&this.setMarkStyle(l,{x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),fill:this.getColorAttribute()},"normal",H.Series)}dataToGridBackgroundPositionY(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e,getBandwidth:i}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})-i(0)/2}dataToGridBackgroundPositionY1(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e,getBandwidth:i}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})+i(0)/2}dataToOpacity(t){var e,i,r,s;if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:n,getScale:a}=this._xAxisHelper;return n(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})<a(0).range()[0]||n(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})>a(0).range()[1]?0:null!=(s=null==(r=null==(i=null==(e=this._theme)?void 0:e.dot)?void 0:i.style)?void 0:r.fillOpacity)?s:1}dataToGridBackgroundOpacity(t){return t[this._seriesGroupField]===this._highLightSeriesGroup?this._gridBackground.fillOpacity:0}onLayoutEnd(){var t,e;super.onLayoutEnd();let i=null!=(e=null==(t=this._spec)?void 0:t.leftAppendPadding)?e:0;this.setMarkStyle(this._clipMark,{width:this.getLayoutRect().width+i},"normal",H.Series)}getDefaultColorDomain(){var t,e;return this._seriesGroupField?null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._seriesGroupField].values:this._seriesField?null==(e=this.getViewDataStatistics())?void 0:e.latestData[this._seriesField].values:[]}getColorAttribute(){var t,e,i;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:null!=(i=null!=(e=this._seriesGroupField)?e:this._seriesField)?i:nr}}getDotColorScale(){var t,e,i;let r=this._dotTypeField?null==(t=this.getViewDataStatistics())?void 0:t.latestData[this._dotTypeField].values:this._seriesGroupField?null==(e=this.getViewDataStatistics())?void 0:e.latestData[this._seriesGroupField].values:this._seriesField?null==(i=this.getViewDataStatistics())?void 0:i.latestData[this._seriesField].values:[],s=this._getDataScheme();return(new lt).domain(r).range(s)}getDotColorAttribute(){var t,e,i,r;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this.getDotColorScale(),field:null!=(r=null!=(i=null!=(e=this._dotTypeField)?e:this._seriesGroupField)?i:this._seriesField)?r:nr}}initTooltip(){this._tooltipHelper=new b_(this),this._dotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._dotMark)}onEvaluateEnd(t){super.onEvaluateEnd(t)}onMarkTreePositionUpdate(t){t.forEach(t=>{t.commit(!1,!0)})}getDotData(){var t;return null==(t=this._dotMark)?void 0:t.getData()}_getDataIdKey(){}getStackValueField(){return null}getActiveMarks(){return[this._dotMark]}}bM.type=rw.dot,bM.mark=bA,bM.builtInTheme={dot:{dot:{style:{size:10,fillOpacity:1}},symbol:{style:{size:10}},title:{style:{textAlign:"left",textBaseline:"middle",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},subTitle:{style:{textAlign:"left",textBaseline:"top",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}};let bw=()=>{pF(),bp(),m4(),bk(),ig.registerSeries(bM.type,bM)};class bT extends fB{_getSeriesDataLength(t,e){var i,r;if(e.data){let t=eo(e.data)[0];return t instanceof er?null==(i=t.latestData)?void 0:i.length:null==(r=t.values)?void 0:r.length}let s=eo(t.data).find((t,i)=>e.dataId?t instanceof er?t.name===e.dataId:t.id===e.dataId:e.dataIndex===i);return s?s instanceof er?s.latestData.length:s.values.length:0}addAttrToComponentSpec(t,e,i){return Array.isArray(t)?t[0][e]=i:t[e]=i,t}addPaddingRow(t,e,i){t.push({index:e,size:i})}addOrientAxes(t,e,i,r){t.push({id:`regionAxesRow${i}`}),e.push({modelId:`axesRow${i}`,col:1,row:i}),r.axes[0].id=`axesRow${i}`,r.axes[0].regionIndex=Array.from(Array(r.series.length),(t,e)=>"top"===r.axes[0].orient?e+1:e)}transformSpec(t){var e,i,r,s,n,a,l,o,h,u,d,c,p,g,f;super.transformSpec(t);let m=0,y=[],_=[],v=[],b=[],x=[],S=this._option.getCompiler().getStage(),k=(S.viewWidth,S.viewHeight),A=0;if(null==t?void 0:t.legends){y.push({modelId:`legendRow${m}`,col:1,row:m}),this.addAttrToComponentSpec(t.legends,"id",`legendRow${m}`);let l=eo(t.legends),o=null!=(e=l[0].height)?e:40;if(l[0].padding){let t=eA(l[0].padding);o+=Number(null!=(i=null==t?void 0:t.bottom)?i:0),o+=Number(null!=(r=null==t?void 0:t.top)?r:0),l[0].offsetY=Number(null!=(n=null==(s=l[0])?void 0:s.offsetY)?n:0)+Number(null!=(a=null==t?void 0:t.top)?a:0)}x.push({index:m,size:o}),A+=o,m++}(null==t?void 0:t.dataZoom)&&(y.push({modelId:`dataZoomRow${m}`,col:1,row:m}),this.addAttrToComponentSpec(t.dataZoom,"id",`dataZoomRow${m}`),A+=60,m++,this.addPaddingRow(x,m,10),A+=10,m++),A+=60,null!==t.axes&&"top"!==(null==(o=null==(l=null==t?void 0:t.axes)?void 0:l[0])?void 0:o.orient)||(this.addOrientAxes(_,y,m,t),m++);let M=t.series.filter(t=>t.type!==rw.link).length,w=(k-A-20*M)/M,T=(null==(h=null==t?void 0:t.appendPadding)?void 0:h.left)||0,C=(null==(u=null==t?void 0:t.appendPadding)?void 0:u.right)||0;null==(d=null==t?void 0:t.series)||d.forEach(e=>{var i,r;if([rw.bar,rw.line,rw.area,rw.dot].includes(e.type)){if(y.push({modelId:`${e.type}Row${m}`,col:1,row:m}),y.push({modelId:`axesLeftRow${m}`,col:0,row:m}),_.push({id:`${e.type}Row${m}`,clip:!1}),x.push({index:m,size:(null==e?void 0:e.height)||w}),v.push({orient:"left",id:`axesLeftRow${m}`,type:e.type===rw.dot?"band":"linear",visible:e.type!==rw.dot,title:{visible:!0,autoRotate:!1,style:{text:null==e?void 0:e.barTitle,dx:-20,textBaseline:"middle",textAlign:"end"}},grid:{visible:"boolean"!=typeof(null==(i=null==e?void 0:e.grid)?void 0:i.visible)||(null==(r=null==e?void 0:e.grid)?void 0:r.visible),style:(t,i)=>{var r,s,n,a,l;let o=0;if(0===i){let t=null==(r=null==e?void 0:e.grid)?void 0:r.style;o=null!=(n=null!=(s=null==t?void 0:t.lineWidth)?s:null==t?void 0:t.strokeWidth)?n:1}return{lineWidth:o,stroke:(null==(l=null==(a=null==e?void 0:e.grid)?void 0:a.style)?void 0:l.stroke)||"#dfdfdf",lineDash:[0,0]}}},domainLine:{visible:!1},tick:{visible:!1},label:{visible:!1},regionIndex:_.length-1}),e.type===rw.dot){y.push({modelId:`scrollBarRightRow${m}`,col:2,row:m});let i=this._getSeriesDataLength(t,e),r=0;i&&(r=((null==e?void 0:e.height)||w)/(30*i)),b.push(Object.assign({orient:"right",visible:e.type===rw.dot&&r<1,id:`scrollBarRightRow${m}`,start:0,end:Math.min(r,1),filterMode:"axis",regionIndex:_.length-1,axisId:`axesLeftRow${m}`},eo(null==t?void 0:t.scrollBar)[0]))}e.regionIndex=_.length-1,m++,this.addPaddingRow(x,m,(null==e?void 0:e.padding)||20),m++,e.leftAppendPadding=T,e.type===rw.dot&&(e.title.style.dx=-T,e.subTitle.style.dx=-T)}}),this.addPaddingRow(x,m,20),m++,null==(c=null==t?void 0:t.series)||c.forEach(e=>{if(e.type===rw.link){let i=e.dotSeriesIndex+1;y.push({modelId:`${e.type}Row${i}`,col:1,row:i-1}),e.regionIndex=t.series[e.dotSeriesIndex].regionIndex,e.leftAppendPadding=T,e.height=t.series[e.dotSeriesIndex].height,e.clipHeight=t.series[e.dotSeriesIndex].clipHeight}}),(null==t?void 0:t.legends)&&this.addAttrToComponentSpec(t.legends,"regionIndex",[_.length-1]),"bottom"===(null==(g=null==(p=null==t?void 0:t.axes)?void 0:p[0])?void 0:g.orient)&&(this.addOrientAxes(_,y,m,t),m++),t.layout={type:"grid",col:4,row:m,colWidth:[{index:0,size:T},{index:2,size:12},{index:3,size:C}],rowHeight:x,elements:y},t.region=_,null==(f=t.axes)||f.push(...v),t.scrollBar=b}}var bC=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class bE extends fF{constructor(){super(...arguments),this.transformerConstructor=bT,this.type="sequence"}_createSeries(t,e){let i;if(!t)return;let{spec:r}=e,s=bC(e,["spec"]);if(r.type===rw.link&&(r.dotSeriesSpec=this._spec.series[r.dotSeriesIndex]),r.regionId&&(i=this.getRegionsInUserId(r.regionId)),i||(i=this.getRegionsInIndex(r.regionIndex?[r.regionIndex]:void 0)[0]),!i)return;let n=new t(r,Object.assign(Object.assign(Object.assign({},this._modelOption),s),{region:i,specKey:"series",globalScale:this._globalScale}));n&&(n.created(),this._series.push(n),i.addSeries(n))}}bE.type="sequence",bE.transformerConstructor=bT;let bB=()=>{mc(),mg(),bw(),by(),g8(),fc(),ig.registerChart(bE.type,bE)};class bP extends fP{transformSpec(t){super.transformSpec(t),t.axes.forEach(t=>t.type="linear")}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["x2Field","y2Field","barMinHeight","barBackground","barGap"])}}class bO extends fF{constructor(){super(...arguments),this.transformerConstructor=bP}}bO.transformerConstructor=bP,cD(bO,fH);class bI extends bP{transformSpec(t){super.transformSpec(t),nF(t)}}class bR extends bO{constructor(){super(...arguments),this.transformerConstructor=bI,this.type="histogram",this.seriesType=rw.bar}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}bR.type="histogram",bR.seriesType=rw.bar,bR.transformerConstructor=bI;let bL=()=>{mc(),mg(),mm(),f0(),fW(),yt(),ig.registerChart(bR.type,bR)},bD=Object.assign(Object.assign({},cd),{group:{name:"group",type:"group"}});class bF extends _Y{constructor(){super(...arguments),this._arcGroupMark=null,this._getAngleValueStart=t=>{let e=this._getAngleAxis(),{tickMask:i}=this._spec;if((null==i?void 0:i.forceAlign)&&this._isTickMaskVisible(e)){let r,s=t[this.getStack()?na:nb],n=this._getAngleAxisSubTickData(e),a=n[1].value-n[0].value,l=lu(i.offsetAngle);if(t5(s)){let t=ao(n,t=>t.value-s),e=t>=n.length||s>n[t].value-a/2?Math.min(t,n.length-1):t>0?t-1:void 0;void 0!==e&&(r=this.angleAxisHelper.dataToPosition([n[e].value-a/2]))}return et(r)&&(r=this.angleAxisHelper.dataToPosition([n[0].value-a/2])),r+l}return this._getAngleValueStartWithoutMask(t)},this._getAngleValueEnd=t=>{let e=this._getAngleAxis(),{tickMask:i}=this._spec;if((null==i?void 0:i.forceAlign)&&this._isTickMaskVisible(e)){let r=t[this.getStack()?nl:this._angleField[0]],s=this._getAngleAxisSubTickData(e),n=s[1].value-s[0].value,a=lu(i.offsetAngle),l=ao(s,t=>t.value-r),o=l>=s.length||r>s[l].value-n/2?Math.min(l,s.length-1):l>0?l-1:void 0;return(void 0!==o?this.angleAxisHelper.dataToPosition([s[o].value+n/2]):this.angleAxisHelper.dataToPosition([s[0].value-n/2]))+a}return this._getAngleValueEndWithoutMask(t)}}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec();let r=null==(t=this._option.globalInstance.getChart())?void 0:t.getSpec(),s=null!=(e=this._spec.startAngle)?e:null==r?void 0:r.startAngle;this._startAngle=t5(s)?lu(s):gS;let n=null!=(i=this._spec.endAngle)?i:null==r?void 0:r.endAngle;this._endAngle=t5(n)?lu(n):gk,this.setAngleField(this._spec.valueField||this._spec.angleField),this.setRadiusField(this._spec.categoryField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice()}getStackGroupFields(){return this._radiusField}getStackValueField(){var t;return null==(t=this._angleField)?void 0:t[0]}getGroupFields(){return this._angleField}_convertMarkStyle(t){let e=super._convertMarkStyle(t);if(e.fill){let i=t.fill;"conical"!==(null==i?void 0:i.gradient)||t5(null==i?void 0:i.startAngle)||t5(null==i?void 0:i.endAngle)||(e.fill=Object.assign(Object.assign({},i),{startAngle:this._startAngle,endAngle:this._endAngle}))}return e}_getAngleValueStartWithoutMask(t){if(this.getStack()){let e=lr(this.angleAxisHelper.dataToPosition([t[na]]),this.angleAxisHelper.getScale(0));if(ee(e))return e}return this._startAngle}_getAngleValueEndWithoutMask(t){if(this.getStack()){let e=lr(this.angleAxisHelper.dataToPosition([t[nl]]),this.angleAxisHelper.getScale(0));if(ee(e))return e}let e=this.angleAxisHelper.dataToPosition([t[this._angleField[0]]]);return this._spec.clamp?lr(e,this.angleAxisHelper.getScale(0)):e}getDimensionField(){return this._specRadiusField}getMeasureField(){return this._specAngleField}initMark(){this._initArcGroupMark()}initMarkStyle(){this._initArcGroupMarkStyle()}_initArcGroupMark(){return this._arcGroupMark=this._createMark(bF.mark.group,{skipBeforeLayouted:!1}),this._arcGroupMark}_initArcGroupMarkStyle(){let t=this._arcGroupMark;t.created(),this.setMarkStyle(t,{x:0,y:0},"normal",H.Series),this._arcGroupMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0,clipPath:()=>{let t=this._getAngleAxis(),{x:e,y:i}=this.angleAxisHelper.center(),r=this._computeLayoutRadius();if(this._isTickMaskVisible(t)){let{tickMask:s}=this._spec,{angle:n,offsetAngle:a,style:l={}}=s;return this._getAngleAxisSubTickData(t).map(({value:t})=>{let s=this.angleAxisHelper.dataToPosition([t])+lu(a),o=lu(n)/2;return(0,_6.Q)(Object.assign(Object.assign({},l),{x:e,y:i,startAngle:s-o,endAngle:s+o,innerRadius:r*this._innerRadius,outerRadius:r*this._outerRadius,fill:!0}))})}let{width:s,height:n}=this.getLayoutRect();return[(0,m3.f)({width:s,height:n,fill:!0})]}})}_getAngleAxis(){if(!this.angleAxisHelper)return;let t=this.angleAxisHelper.getAxisId();return this._option.getChart().getAllComponents().find(e=>e.id===t)}_getAngleAxisTickData(t){var e;return null==(e=null==t?void 0:t.getTickData())?void 0:e.getLatestData()}_isTickMaskVisible(t){let e=this._getAngleAxisTickData(t),{tickMask:i}=this._spec;return i&&!1!==i.visible&&(null==e?void 0:e.length)>1}_getAngleAxisSubTickData(t){var e;let i=this._getAngleAxisTickData(t),r=[],{subTick:s={},tick:n={}}=null!=(e=null==t?void 0:t.getSpec())?e:{},{tickCount:a=4}=s,{alignWithLabel:l}=n;if((null==i?void 0:i.length)>=2){let t=i[1].value-i[0].value;for(let e=0;e<i.length-1;e++){let s=i[e],n=i[e+1];r.push(s);for(let e=0;e<a;e++){let i=(e+1)/(a+1),o=(1-i)*s.value+i*(n?n.value:l?1:s.value+t);r.push({value:o})}}return r.push(i[i.length-1]),r}return i}}bF.mark=bD;let bz=Object.assign(Object.assign({},bD),{track:{name:"track",type:"arc"},progress:{name:"progress",type:"arc"}}),bj=t=>({type:"growAngleIn",options:{overall:t.startAngle}}),bH={type:"fadeIn"},bN=()=>{ig.registerAnimation("circularProgress",(t,e)=>({appear:"fadeIn"===e?bH:bj(t),enter:{type:"growAngleIn"},disappear:{type:"growAngleOut"}}))};class bV extends cw{constructor(){super(...arguments),this._supportStack=!0}}class bW extends bF{constructor(){super(...arguments),this.type=rw.circularProgress,this.transformerConstructor=bV,this._progressMark=null,this._trackMark=null,this._getRadiusValueStart=t=>{if(this.getGroupFields().length>1){let e=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()));if(ee(e))return e}return this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]])},this._getRadiusValueEnd=t=>{var e,i;if(this.getGroupFields().length>1){let r=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+(null==(i=(e=this.radiusAxisHelper).getBandwidth)?void 0:i.call(e,this._groups?this._groups.fields.length-1:0));if(ee(r))return r}return this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]])+this.radiusAxisHelper.getScale(0).step()}}getStackGroupFields(){return this.getGroupFields()}getGroupFields(){return this._radiusField}initMark(){super.initMark(),this._initTrackMark(),this._initProgressMark()}initMarkStyle(){super.initMarkStyle(),this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){return this._progressMark=this._createMark(bW.mark.progress,{parent:this._arcGroupMark,isSeriesMark:!0},{morph:ck(this._spec,"progress")}),this._progressMark}_initProgressMarkStyle(){var t;let e=this._progressMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart,endAngle:this._getAngleValueEnd,innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cap:null!=(t=this._spec.roundCap)&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0},"normal",H.Series)}getInteractionTriggers(){let t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)}initTooltip(){super.initTooltip(),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark)}_initTrackMark(){return this._trackMark=this._createMark(bW.mark.track,{parent:this._arcGroupMark}),this._trackMark.setMarkConfig({morph:!1,morphKey:null,morphElementKey:null}),this._trackMark}_initTrackMarkStyle(){let t=this._trackMark;t&&this.setMarkStyle(t,{visible:t=>{let e=this.angleAxisHelper.getScale(0).range(),i=Math.min(e[0],e[e.length-1]);return 1e-14>=Math.abs(this._getAngleValueStartWithoutMask(t)-i)},x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:()=>{let t=this.getStack()?na:this._angleField[0],e=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueStart({[t]:e[0]})},endAngle:()=>{let t=this.getStack()?nl:this._angleField[0],e=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueEnd({[t]:e[e.length-1]})},innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:100},"normal",H.Series)}initAnimation(){var t,e,i,r;let s=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._progressMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("circularProgress"))?void 0:i({startAngle:this._startAngle},s),cb("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("fadeInOut"))?void 0:r(),cb("track",this._spec,this._markAttributeContext)))}getActiveMarks(){return[this._progressMark]}}bW.type=rw.circularProgress,bW.mark=bz,bW.builtInTheme={circularProgress:{outerRadius:.8,innerRadius:.6,progress:{style:{fillOpacity:1}},track:{style:{fillOpacity:.2}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}}},bW.transformerConstructor=bV;let bU=()=>{ig.registerSeries(bW.type,bW),va(),bN(),uJ(),vG(),v$()};class bG extends vp{needAxes(){return!1}_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t,["startAngle","endAngle","centerX","centerY"]);return e.categoryField=t.categoryField||t.radiusField,e.valueField=t.valueField||t.angleField,e}_transformProgressAxisSpec(t,e,i,r,s){var n,a;t.axes||(t.axes=[]);let l=(null!=(n=t.axes)?n:[]).find(t=>"radius"===t.orient),o=(null!=(a=t.axes)?a:[]).find(t=>"angle"===t.orient);o||(o=e,t.axes.push(o)),l||(l=i,t.axes.push(l)),et(o.type)&&(o.type="linear"),et(l.type)&&(l.type="band");let h=gl(o,{min:0,max:1});et(o.min)&&(o.min=h.min),et(o.max)&&(o.max=h.max),r&&Object.assign(o,it({},r,o)),s&&Object.assign(l,it({},s,l))}}class bZ extends bG{_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t);return r.progress=t.progress,r.track=t.track,r.tickMask=t.tickMask,r.cornerRadius=null!=(e=t.cornerRadius)?e:0,r.roundCap=null!=(i=t.roundCap)&&i,r}transformSpec(t){super.transformSpec(t),this._transformProgressAxisSpec(t,{orient:"angle",visible:!1},{orient:"radius",visible:!1},{forceInitTick:t.tickMask&&!1!==t.tickMask.visible})}}class b$ extends fF{constructor(){super(...arguments),this.transformerConstructor=bZ,this.type="circularProgress",this.seriesType=rw.circularProgress}_setModelOption(){this._modelOption.getDimensionInfo=vJ}}b$.type="circularProgress",b$.seriesType=rw.circularProgress,b$.transformerConstructor=bZ,cD(b$,fH);let bY=()=>{mc(),mg(),f0(),fW(),bU(),ig.registerChart(b$.type,b$)},bX=Object.assign(Object.assign({},bD),{segment:{name:"segment",type:"arc"},track:{name:"track",type:"arc"}}),bK=Object.assign(Object.assign({},cd),{pin:{name:"pin",type:"path"},pinBackground:{name:"pinBackground",type:"path"},pointer:{name:"pointer",type:["path","rect"]}}),bq=t=>({channel:{angle:{from:t.startAngle+Math.PI/2}}}),bQ={type:"fadeIn"},bJ=()=>{ig.registerAnimation("gaugePointer",(t,e)=>{let i="fadeIn"===e?bQ:bq(t);return{appear:i,enter:i,disappear:{type:"fadeOut"}}})};class b0 extends cw{constructor(){super(...arguments),this._supportStack=!1}}class b1 extends d8{enableByType(t){return"dimension"!==t}}let b2="M1 0 C1 0.55228 0.55228 1 0 1 C-0.552285 1 -1 0.55228 -1 0 C-1 -0.552285 -0.552285 -1 0 -1 C0.55228 -1 1 -0.552285 1 0Z";class b3 extends bF{constructor(){super(...arguments),this.type=rw.gaugePointer,this.transformerConstructor=b0,this._pinMark=null,this._pointerMark=null,this._pinBackgroundMark=null}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setRadiusField(this._spec.radiusField),this._pointerType="rect"===(null==(t=this._spec.pointer)?void 0:t.type)?"rect":"path"}initMark(){this._pinBackgroundMark=this._createMark(b3.mark.pinBackground),this._pointerMark=this._createMark(Object.assign(Object.assign({},b3.mark.pointer),{type:this._pointerType}),{isSeriesMark:!0}),this._pinMark=this._createMark(b3.mark.pin)}initMarkStyle(){this.initPinBackgroundMarkStyle(),this.initPointerMarkStyle(),this.initPinMarkStyle()}initGroups(){}initPointerMarkStyle(){let t=this._pointerMark,e=this._spec.pointer;t&&(this.setMarkStyle(t,{x:t=>{var i,r;let{x:s}=this._getPointerAnchor(t,e);return s-this._getPointerWidth()*(null!=(r=null==(i=null==e?void 0:e.center)?void 0:i[0])?r:0)},y:t=>{var i,r;let{y:s}=this._getPointerAnchor(t,e);return s-this._getPointerHeight(t)*(null!=(r=null==(i=null==e?void 0:e.center)?void 0:i[1])?r:0)},anchor:t=>{let{x:i,y:r}=this._getPointerAnchor(t,e);return[i,r]},fill:this.getColorAttribute(),zIndex:200}),"path"===this._pointerType?this.setMarkStyle(t,{scaleX:this._getPointerWidth.bind(this),scaleY:this._getPointerHeight.bind(this),angle:t=>this._getPointerAngle(t)+Math.PI/2}):this.setMarkStyle(t,{width:this._getPointerWidth.bind(this),height:this._getPointerHeight.bind(this),angle:t=>this._getPointerAngle(t)-Math.PI/2}))}initTooltip(){this._tooltipHelper=new b1(this),this._pointerMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pointerMark)}_getPointerAnchor(t,e){var i;return null==(i=e.isOnCenter)||i?this.angleAxisHelper.center():this.radiusAxisHelper.coordToPoint({radius:this._innerRadius*this._computeLayoutRadius(),angle:this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])})}_getPointerWidth(){return this._spec.pointer.width*this._computeLayoutRadius()}_getPointerHeight(t){var e,i;let r=this._spec.pointer,s=this._radiusField[0];return t5(this.radiusAxisHelper)&&t5(s)?this.radiusAxisHelper.dataToPosition([t[s]])-(null!=(e=null==r?void 0:r.innerPadding)?e:0)-(null!=(i=null==r?void 0:r.outerPadding)?i:10):r.height*this._computeLayoutRadius()}_getPointerAngle(t){let e=this.angleAxisHelper.getScale().domain(),i=eu(e),r=ed(e),s=eH(t[this._angleField[0]],r,i);return this.angleAxisHelper.dataToPosition([s])}_getRotatedPointerCenterOffset(t){var e,i,r,s;let n=this._spec.pointer,a=this._getPointerWidth()*(null!=(i=null==(e=null==n?void 0:n.center)?void 0:e[0])?i:0),l=-this._getPointerHeight(t)*(null!=(s=null==(r=null==n?void 0:n.center)?void 0:r[1])?s:0),o=this._getPointerAngle(t)-Math.PI/2,h=Math.cos(o),u=Math.sin(o);return{x:a*h+l*u,y:-(l*h-a*u)}}initPinBackgroundMarkStyle(){let t=this._pinBackgroundMark,e=this._spec.pinBackground;t&&this.setMarkStyle(t,{x:t=>this._getPointerAnchor(t,e).x,y:t=>this._getPointerAnchor(t,e).y,scaleX:()=>e.width*this._computeLayoutRadius(),scaleY:()=>e.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:100})}initPinMarkStyle(){let t=this._pinMark,e=this._spec.pin;t&&this.setMarkStyle(t,{x:t=>this._getPointerAnchor(t,e).x,y:t=>this._getPointerAnchor(t,e).y,scaleX:()=>e.width*this._computeLayoutRadius(),scaleY:()=>e.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:300})}getInteractionTriggers(){return this._parseInteractionConfig(this._pointerMark?[this._pointerMark]:[])}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._pointerMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("gaugePointer"))?void 0:i({startAngle:this._startAngle},r),cb("pointer",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}b3.type=rw.gaugePointer,b3.mark=bK,b3.builtInTheme={gaugePointer:{pointer:{type:"path",width:.4,height:.4,style:{path:"M-0.020059 -0.978425 C-0.018029 -0.9888053 -0.013378 -1 0 -1 C0.01342 -1 0.01812 -0.989146 0.0201 -0.978425 C0.02161 -0.9702819 0.0692 -0.459505 0.09486 -0.184807 C0.10298 -0.097849 0.1089 -0.034548 0.11047 -0.018339 C0.11698 0.04908 0.07373 0.11111 0.00002 0.11111 C-0.07369 0.11111 -0.117184 0.04991 -0.110423 -0.018339 C-0.103662 -0.086591 -0.022089 -0.9680447 -0.020059 -0.978425Z"}},pin:{width:.025,height:.025,style:{path:b2,fill:"#888"}},pinBackground:{width:.06,height:.06,style:{path:b2,fill:"#ddd"}}}},b3.transformerConstructor=b0;let b5=()=>{ig.registerSeries(b3.type,b3),yC(),m4(),bJ(),vG(),v$()};class b4 extends cw{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){this._addMarkLabelSpec(t,"segment")}}class b7 extends bF{constructor(){super(...arguments),this.type=rw.gauge,this.transformerConstructor=b4,this._segmentMark=null,this._trackMark=null,this._padAngle=0}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._padAngle=lu(null!=(t=this._spec.padAngle)?t:0)}initData(){var t;super.initData(),sY(this._option.dataSet,"spiltSegment",(t,e)=>{let i=t.slice();return i.sort((t,e)=>t[this._angleField[0]]-e[this._angleField[0]]),i.forEach((t,e)=>{t[nx]=t[this._angleField[0]],t[nb]=e>0?i[e-1][nx]:void 0}),i}),null==(t=this.getViewData())||t.transform({type:"spiltSegment"},!1)}initMark(){super.initMark(),this._trackMark=this._createMark(b7.mark.track,{parent:this._arcGroupMark,dataView:!1}),this._segmentMark=this._createMark(b7.mark.segment,{parent:this._arcGroupMark,isSeriesMark:!0})}initMarkStyle(){super.initMarkStyle(),this.initTrackMarkStyle(),this.initSegmentMarkStyle()}initSegmentMarkStyle(){var t;let e=this._segmentMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart.bind(this),endAngle:this._getAngleValueEnd.bind(this),innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!=(t=this._spec.innerRadius)?t:0)},outerRadius:()=>{var t,e;return this._computeLayoutRadius()*(null!=(e=null!=(t=this._spec.radius)?t:this._spec.outerRadius)?e:1)},cap:null!=(t=this._spec.roundCap)&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0})}generateRadiusStyle(t){if(!t)return;let e={};return t.outerRadius&&(e.outerRadius=()=>this._computeLayoutRadius()*t.outerRadius),t.innerRadius&&(e.innerRadius=()=>this._computeLayoutRadius()*t.innerRadius),e}initMarkStyleWithSpec(t,e){if(super.initMarkStyleWithSpec(t,e),t&&"segment"===t.name){let e=this.getSpec().segment;if(e)for(let i in e.state||{})this.setMarkStyle(t,this.generateRadiusStyle(e.state[i]),i,H.User_Mark)}}initTooltip(){super.initTooltip(),this._segmentMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._segmentMark)}initTrackMarkStyle(){var t;let e=this._trackMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!=(t=this._spec.innerRadius)?t:0)},outerRadius:()=>{var t,e;return this._computeLayoutRadius()*(null!=(e=null!=(t=this._spec.radius)?t:this._spec.outerRadius)?e:1)},cap:null!=(t=this._spec.roundCap)&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,zIndex:100})}_getAngleValueStartWithoutMask(t){let e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),r=a0(e,(e+i)/2)(e+(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?lr(r,this.angleAxisHelper.getScale(0)):r}_getAngleValueEndWithoutMask(t){let e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),r=a0(i,(e+i)/2)(i-(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?lr(r,this.angleAxisHelper.getScale(0)):r}_getAngleValueStartWithoutPadAngle(t){return t5(t[nb])?this.angleAxisHelper.dataToPosition([t[nb]]):this._startAngle}_getAngleValueEndWithoutPadAngle(t){return this.angleAxisHelper.dataToPosition([t[nx]])}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._segmentMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("circularProgress"))?void 0:i({startAngle:this._startAngle},r),cb("segment",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}b7.type=rw.gauge,b7.mark=bX,b7.builtInTheme={gauge:{outerRadius:.8,innerRadius:.6,padAngle:1.146,segment:{style:{fillOpacity:1}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}}},b7.transformerConstructor=b4;let b6=()=>{ig.registerSeries(b7.type,b7),va(),bN(),v$()};class b9 extends bG{_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.radiusField=t.radiusField,e.pin=t.pin,e.pinBackground=t.pinBackground,e.pointer=t.pointer,e}_getDefaultCircularProgressSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.type=rw.circularProgress,e}transformSpec(t){var e,i,r,s,n;super.transformSpec(t);let a=null==(e=t.series)?void 0:e.find(t=>t.type===rw.gauge||t.type===rw.circularProgress);et(a)&&("circularProgress"===(a=null!=(i=t.gauge)?i:this._getDefaultCircularProgressSeriesSpec(t)).type&&(et(a.radiusField)&&et(a.categoryField)&&(a.radiusField=null!=(s=null!=(r=t.radiusField)?r:t.categoryField)?s:t.seriesField),et(a.valueField)&&et(a.angleField)&&(a.valueField=null!=(n=t.valueField)?n:t.angleField)),1===t.series.length?t.series.push(a):t.series.forEach(t=>{t.type===a.type&&Object.keys(a).forEach(e=>{e in t||(t[e]=a[e])})})),a.type===rw.circularProgress?this._transformProgressAxisSpec(t,{orient:"angle",visible:!0,domainLine:{visible:!1},grid:{visible:!1}},{orient:"radius",visible:!1},{zIndex:z.Region+50}):this._transformGaugeAxisSpec(t)}_transformGaugeAxisSpec(t){var e;t.axes||(t.axes=[]);let i={radius:null,angle:null};(null!=(e=t.axes)?e:[]).forEach(t=>{let{orient:e}=t;"radius"===e&&(i.radius=t),"angle"===e&&(i.angle=t)}),i.angle||(i.angle={orient:"angle",visible:!0},t.axes.push(i.angle)),i.radius||(i.radius={orient:"radius",visible:!1},t.axes.push(i.radius)),et(i.angle.type)&&(i.angle.type="linear"),et(i.radius.type)&&(i.radius.type="linear"),et(i.angle.zIndex)&&(i.angle.zIndex=z.Region+50)}}class b8 extends fF{constructor(){super(...arguments),this.transformerConstructor=b9,this.type="gauge",this.seriesType=rw.gaugePointer}}b8.type="gauge",b8.seriesType=rw.gaugePointer,b8.transformerConstructor=b9;let xt=()=>{mg(),b5(),b6(),bU(),ig.registerChart(b8.type,b8)};class xe extends fB{transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["nameField","valueField","fontFamilyField","fontWeightField","fontStyleField","colorHexField","colorMode","colorList","rotateAngles","fontWeightRange","fontSizeRange","maskShape","keepAspect","random","wordCloudConfig","wordCloudShapeConfig","word","fillingWord","wordMask"])}}class xi extends fF{constructor(){super(...arguments),this.transformerConstructor=xe,this.type="wordCloud",this.seriesType=rw.wordCloud}}xi.transformerConstructor=xe;let xr=[0],xs=[20,40],xn=[200,500],xa={shrink:!1,enlarge:!1,fontSizeLimitMin:0},xl=["triangleForward","triangle","diamond","square","star","cardioid","circle","pentagon","rect"],xo=`${s6}_WORD_CLOUD_TEXT`,xh=Object.assign(Object.assign({},cd),{word:{name:"word",type:"text"},fillingWord:{name:"fillingWord",type:"text"},wordMask:{name:"wordMask",type:"rect"}});var xu=i(82794),xd=i(19427);class xc extends cT{constructor(){super(...arguments),this._fontSizeRange=[20,20],this._isWordCloudShape=!1,this._dataChange=!0,this.handleMaskCanvasUpdate=(t,e)=>{this._maskCanvas=t},this.getWordColor=t=>t.isFillingWord?(this._fillingColorCallback&&!this._dataChange||(this._fillingColorCallback=this._wordCloudShapeConfig.fillingColorHexField?t=>t[this._wordCloudShapeConfig.fillingColorHexField]:this.initColorCallback(this._wordCloudShapeConfig.fillingSeriesField,!0)),this._fillingColorCallback(t)):(this._keyWordColorCallback&&!this._dataChange||(this._keyWordColorCallback=this._spec.colorHexField?t=>t[this._spec.colorHexField]:this.initColorCallback(this._seriesField,!1)),this._keyWordColorCallback(t)),this._calculateFontWeight=t=>{let e=this.getRawDataStatisticsByField(this._valueField,!0);return e.min===e.max?this._fontWeightRange[0]:this._fontWeightRange[0]+(this._fontWeightRange[this._fontWeightRange.length-1]-this._fontWeightRange[0])*(t[this._valueField]-e.min)/(e.max-e.min)}}setValueField(t){t5(t)&&(this._valueField=t)}setFontSizeRange(t){t5(t)?this._fontSizeRange=t:this._fontSizeRange=xs}setAttrFromSpec(){var t,e,i,r,s;super.setAttrFromSpec(),this._padding=this._option.getChart().padding,this._nameField=this._spec.nameField,this._colorMode=null!=(t=this._spec.colorMode)?t:"ordinal",this._colorList=this._spec.colorList,this.setValueField(this._spec.valueField),this._fontWeightRange=null!=(e=this._spec.fontWeightRange)?e:xn,this._rotateAngles=null!=(i=this._spec.rotateAngles)?i:xr,this.setFontSizeRange(this._spec.fontSizeRange),this._maskShape=null!=(r=this._spec.maskShape)?r:"circle",this._textField=(null==(s=this._spec.word)?void 0:s.formatMethod)?xo:this._nameField;let n=this._spec.wordCloudConfig;this._wordCloudConfig=Object.assign({drawOutOfBound:"hidden",layoutMode:"default",zoomToFit:xa},this._spec.wordCloudConfig),n&&!et(n.layoutMode)||eE(this._option.mode)||(this._wordCloudConfig.layoutMode="fast"),this._wordCloudShapeConfig=Object.assign({fillingSeriesField:this.getSeriesField(),fillingRotateAngles:xr,layoutMode:"default"},this._spec.wordCloudShapeConfig),this._isWordCloudShape=!xl.includes(this._maskShape)&&!["fast","grid","cloud"].includes(this._wordCloudConfig.layoutMode),this._defaultFontFamily=this._option.getTheme("fontFamily")}initData(){var t,e;super.initData(),null==(e=null==(t=this.getViewData())?void 0:t.target)||e.addListener("change",()=>{this._dataChange=!0,this.compile()})}initMark(){var t;this._wordMark=this._createMark(xc.mark.word,{key:ni,groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this._seriesField}),(null==(t=this._spec.wordMask)?void 0:t.visible)&&(this._maskMark=this._createMark(xc.mark.wordMask,{dataView:!1}),this._maskMark.setMarkConfig({zIndex:z.Mark-1}))}initMarkStyle(){this.initMarkStyleOfWord(this._wordMark,this._spec.word,this._spec.colorHexField,this._seriesField),this._maskMark&&this.setMarkStyle(this._maskMark,{width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,background:()=>this._maskCanvas},"normal",H.Series)}initMarkStyleOfWord(t,e,i,r,s){var n,a;t&&(this.setMarkStyle(t,{text:(null==e?void 0:e.formatMethod)?t=>e.formatMethod(t):t=>t[this._textField],x:t=>t.x,y:t=>t.y,fontSize:t=>t.fontSize,fontStyle:t=>t.fontStyle,angle:t=>t.angle,visible:t=>t.visible},"normal",H.Series),this.setMarkStyle(t,{fill:null!=(a=null==(n=null==e?void 0:e.style)?void 0:n.fill)?a:this.getWordColor,fontWeight:t=>t.fontWeight,fontFamily:t=>t.fontFamily},"normal",H.User_Mark))}initTooltip(){super.initTooltip(),this._wordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._wordMark)}initAnimation(){[this._wordMark].forEach(t=>{var e,i;if(t){let r=null==(i=null==(e=this._spec)?void 0:e.animationAppear)?void 0:i.preset;t.setAnimationConfig(cv(ig.getAnimationInKey("wordCloud")({animationConfig:()=>{var e,i;return null==(i=null==(e=t.getAnimationConfig())?void 0:e.appear)?void 0:i[0]}},r),cb("word",this._spec,this._markAttributeContext)))}})}getWordOrdinalColorScale(t,e){var i,r,s,n,a;let l=e?this._wordCloudShapeConfig.fillingColorList:this._colorList,o=t?null==(i=this.getViewData())?void 0:i.latestData.map(e=>e[t]):[],h=null!=(s=null!=l?l:null==(r=this._option.globalScale.getScale("color"))?void 0:r.range())?s:this._getDataScheme();return null==(a=(n=(new lt).domain(o)).range)?void 0:a.call(n,h)}initColorCallback(t,e){var i,r,s,n;if("ordinal"===this._colorMode){let i=this.getWordOrdinalColorScale(t,e);return e=>i.scale(e[null!=t?t:nr])}let a=null!=(i=e?this._colorList:this._wordCloudShapeConfig.fillingColorList)?i:this._option.globalScale.getScale("color").range();if(1===a.length)return t=>a[0];if(this._valueField){let t=this.getRawDataStatisticsByField(this._valueField,!0);if(t.min===t.max)return a[0];let e=(new a2).domain([t.min,t.max]).range(a);return t=>e.scale(t[this._valueField])}let l=(new a2).domain([0,null!=(n=null==(s=null==(r=this.getViewData())?void 0:r.latestData)?void 0:s.length)?n:1]).range(a);return t=>l.scale(t[ne])}compile(){super.compile();let{width:t,height:e}=this._region.getLayoutRect();if(!ee(t)||!ee(e)||!(e>0&&t>0))return;let i=[];this._isWordCloudShape?i.push(Object.assign({type:"wordcloudShape"},this._wordCloudShapeTransformOption())):i.push(Object.assign({type:"wordcloud"},this._wordCloudTransformOption())),this._wordMark.setTransform(i)}_getCommonTransformOptions(){var t,e,i,r,s;let{width:n,height:a}=this._region.getLayoutRect(),l=null!=(t=this._spec.word)?t:{},o=null!=(e=l.style)?e:{};return{size:[n,a],shape:ey(this._maskShape)&&"text"===this._maskShape.type&&et(this._maskShape.fontFamily)?Object.assign({fontFamily:this._option.getTheme("fontFamily")},this._maskShape):this._maskShape,onUpdateMaskCanvas:this.handleMaskCanvasUpdate,dataIndexKey:ni,text:l.formatMethod?t=>l.formatMethod(t):{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:null!=(r=null==(i=this._spec.word)?void 0:i.padding)?r:1,fontFamily:t5(this._spec.fontFamilyField)?{field:this._spec.fontFamilyField}:null!=(s=o.fontFamily)?s:this._defaultFontFamily,fontWeight:t5(this._spec.fontWeightField)?{field:this._spec.fontWeightField}:t5(o.fontWeight)?o.fontWeight:t5(this._valueField)?this._calculateFontWeight:"normal",fontStyle:t5(this._spec.fontStyleField)?{field:this._spec.fontStyleField}:o.fontStyle,createCanvas:es.rF.createCanvas.bind(es.rF),getTextBounds:xu.o}}_wordCloudTransformOption(){var t,e;return Object.assign(Object.assign(Object.assign({},null!=(t=this._wordCloudConfig)?t:{}),this._getCommonTransformOptions()),{layoutType:this._wordCloudConfig.layoutMode,rotate:this._rotateAngles,randomVisible:null==(e=this._spec.random)||e,clip:"clip"===this._wordCloudConfig.drawOutOfBound,shrink:this._wordCloudConfig.zoomToFit.shrink,enlarge:this._wordCloudConfig.zoomToFit.enlarge,minFontSize:this._wordCloudConfig.zoomToFit.fontSizeLimitMin,progressiveTime:this._wordCloudConfig.progressiveTime,progressiveStep:this._wordCloudConfig.progressiveStep,repeatFill:this._wordCloudConfig.zoomToFit.repeat})}_wordCloudShapeTransformOption(){var t,e,i,r,s,n;let a=null!=(e=null==(t=this._spec.fillingWord)?void 0:t.style)?e:{},l=null!=(i=this._wordCloudShapeConfig)?i:{};return Object.assign(Object.assign(Object.assign({},l),this._getCommonTransformOptions()),{createImage:xd.B,rotateList:this._rotateAngles,fillingRotateList:l.fillingRotateAngles,fillingFontFamily:t5(l.fillingFontFamilyField)?{field:l.fillingFontFamilyField}:null!=(r=a.fontFamily)?r:this._defaultFontFamily,fillingPadding:null!=(n=null==(s=this._spec.fillingWord)?void 0:s.padding)?n:1,fillingFontStyle:t5(l.fillingFontStyleField)?{field:l.fillingFontStyleField}:a.fontStyle,fillingFontWeight:t5(l.fillingFontWeightField)?{field:l.fillingFontWeightField}:a.fontWeight})}getStatisticFields(){let t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}dataToPosition(t){return null}dataToPositionX(t){return null}dataToPositionY(t){return null}dataToPositionZ(t){return null}valueToPosition(t,e){return null}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}onLayoutEnd(){super.onLayoutEnd(),this.compile(),this._dataChange=!1}getActiveMarks(){return[this._wordMark]}reInit(){super.reInit(),this._keyWordColorCallback&&(this._keyWordColorCallback=null),this._fillingColorCallback&&(this._fillingColorCallback=null)}}xc.mark=xh,xc.builtInTheme={wordCloud:{word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}}};let xp=t=>({type:"scaleIn",duration:200,delay:(e,i)=>{let r=t.animationConfig(),s=(null==r?void 0:r.duration)||200,n=(null==r?void 0:r.totalTime)||uX.appear.duration,a=i.context.graphicCount;return i.context.graphicIndex*(s*a<n?s+(n-a*s)/(a-1):(n-s)/(a-1))}}),xg=()=>{ig.registerAnimation("wordCloud",(t,e)=>({appear:!1===e?{}:"fadeIn"===e?{type:"fadeIn"}:xp(t),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}))};function xf(t){return parseFloat("0."+Math.sin(t).toString().substring(6))}let xm=()=>{let t=-1,e=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9];return()=>(t=(t+1)%e.length,e[t])},xy={triangleForward:function(){return function(t){let e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}},triangleUpright:x_,triangle:x_,diamond:function(){return function(t){let e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))}},square:function(){return function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))}},star:function(){return function(t){let e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}},cardioid:function(){return function(t){return 1+Math.sin(t)}},circle:function(){return function(){return 1}},pentagon:function(){return function(t){let e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))}}};function x_(){return function(t){let e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function xv(t,e){let i=e[0],r=e[1],s=1,n=[e[0]>>1,e[1]>>1];switch(t){case"cardioid":n[1]=~~(r/2.7*.4),s=Math.floor(Math.min(i/2.3,r/2.6));break;case"triangleForward":s=r/Math.sqrt(.75)>i?Math.floor(i/2):Math.floor(r/(2*Math.sqrt(.75)));break;case"triangle":case"triangleUpright":n[1]=~~(r/1.5),s=Math.floor(Math.min(r/1.5,i/2));break;case"circle":case"diamond":case"square":case"star":case"pentagon":s=Math.floor(Math.min(i/2,r/2));break;default:s=Math.floor(Math.max(i/2,r/2))}return{maxRadius:s,center:n}}let xb=t=>xy[t]?xy[t]():xy.circle(),xx=(t,e)=>"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)";function xS(t){return tK(t)?t:function(){return t}}class xk{constructor(t){var e,i;switch(this.options=t8({},xk.defaultOptions,t),tK(this.options.shape)?this.shape=this.options.shape:this.shape=xb(this.options.shape),this.getText=null!=(e=xS(this.options.text))?e:t=>t,this.getTextFontWeight=xS(this.options.fontWeight),this.getTextFontSize=xS(this.options.fontSize),this.getTextFontStyle=xS(this.options.fontStyle),this.getTextFontFamily=xS(this.options.fontFamily),this.outputCallback=null!=(i=this.options.outputCallback)?i:t=>t,this.options.color){case"random-dark":this.getTextColor=()=>xx(10,50);break;case"random-light":this.getTextColor=()=>xx(50,90);break;default:this.getTextColor=xS(this.options.color)}if(et(this.options.rotate))if(this.options.useRandomRotate){let t=Math.abs(this.options.maxRotation-this.options.minRotation),e=Math.abs(Math.floor(this.options.rotationSteps)),i=Math.min(this.options.maxRotation,this.options.minRotation);this.getTextRotate=()=>0===this.options.rotateRatio||Math.random()>this.options.rotateRatio?0:0===t?i:e>0?i+Math.floor(Math.random()*e)*t/(e-1):i+Math.random()*t}else this.getTextRotate=()=>0;else this.getTextRotate=tK(this.options.rotate)?t=>{var e;return lu(null!=(e=this.options.rotate(t))?e:0)}:(t,e)=>{let i=eo(this.options.rotate);return lu(i[Math.floor((this.options.random?Math.random():xf(e))*i.length)])}}canRepeat(){return!1}exceedTime(){var t;return this.options.progressiveStep>0?this.progressiveIndex>=((null!=(t=this.currentStepIndex)?t:-1)+1)*this.options.progressiveStep:this.options.progressiveTime>0&&(new Date).getTime()-this.escapeTime>this.options.progressiveTime}progressiveRun(){var t;if(this.options.progressiveStep>0?this.currentStepIndex=(null!=(t=this.currentStepIndex)?t:-1)+1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.data&&this.progressiveIndex<this.data.length){this.progressiveResult=[];let t=this.progressiveIndex,e=0,i=this.options.maxSingleWordTryCount,r=Math.min(this.options.maxFailCount,this.originalData.length);for(;t<this.data.length&&this.failCount<r;){let s=this.layoutWord(t);if(e++,(s||e>i)&&(t++,e=0,this.failCount=s?0:this.failCount+1),this.progressiveIndex=t,this.exceedTime())break;t===this.data.length&&this.failCount<r&&this.options.repeatFill&&this.canRepeat()&&(this.data=[...this.data,...this.originalData.map(t=>Object.assign(Object.assign({},t),{isFill:!0}))],this.isTryRepeatFill=!0)}return this.progressiveResult}return this.result}initProgressive(){this.failCount=0,this.progressiveIndex=0,this.options.progressiveStep>0?this.currentStepIndex=-1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.progressiveResult=[]}output(){return this.result?this.outputCallback(this.result):null}progressiveOutput(){return this.progressiveResult?this.outputCallback(this.progressiveResult):null}unfinished(){return this.data&&this.data.length&&!et(this.progressiveIndex)&&this.progressiveIndex<this.data.length}release(){this.data=null,this.result=null,this.progressiveIndex=null,this.progressiveResult=null}}xk.defaultOptions={fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",fontStyle:"normal",minFontSize:12,drawOutOfBound:!1,shrink:!1,minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,rotateRatio:.1,random:!1,shape:"circle",progressiveTime:0,progressiveStep:0,repeatFill:!1,fillTextFontSize:12,maxFailCount:20};let xA={archimedean:function(t){let e=t[0]/t[1];return t=>[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]},rectangular:function(t){let e=4*t[0]/t[1],i=0,r=0;return t=>{let s=t<0?-1:1;switch(Math.sqrt(1+4*s*t)-s&3){case 0:i+=e;break;case 1:r+=4;break;case 2:i-=e;break;default:r-=4}return[i,r]}}};class xM extends xk{constructor(t){var e;super(t8({},xM.defaultOptions,t)),this.cw=64,this.ch=2048,this._size=[256,256],this._isBoardExpandCompleted=!1,this._placeStatus=0,this._tTemp=null,this._dtTemp=null,this._dy=0,this.cacheMap=new Map,this.options.minFontSize<=xM.defaultOptions.minFontSize&&(this.options.minFontSize=xM.defaultOptions.minFontSize),this.spiral=t3(this.options.spiral)?null!=(e=xA[this.options.spiral])?e:xA.archimedean:this.options.spiral,this.random=this.options.random?Math.random:()=>1,this.getTextPadding=xS(this.options.padding)}zoomRatio(){return this._originSize[0]/this._size[0]}dy(){return this._dy}layoutWord(t){let e=this.data[t];if(""===(""+e.text).trim())return!0;let{maxRadius:i,center:r}=xv(this.options.shape,this._size);if(e.x=r[0],e.y=r[1],function(t,e,i,r,s,n){let a,l,o,h,u;if(e.sprite)return;let d=t.context,c=t.ratio;d.setTransform(c,0,0,c,0,0),d.clearRect(0,0,(s<<5)/c,n/c);let p=0,g=0,f=0,m=i.length;for(--r;++r<m;){if(e=i[r],d.save(),d.font=e.fontStyle+" "+e.fontWeight+" "+~~((e.fontSize+1)/c)+"px "+e.fontFamily,a=d.measureText(e.text+"m").width*c,o=e.fontSize<<1,e.angle){let t=Math.sin(e.angle),i=Math.cos(e.angle),r=a*i,s=a*t,n=o*i,l=o*t;a=Math.max(Math.abs(r+l),Math.abs(r-l))+31>>5<<5,o=~~Math.max(Math.abs(s+n),Math.abs(s-n))}else a=a+31>>5<<5;if(o>f&&(f=o),p+a>=s<<5&&(p=0,g+=f,f=0),g+o>=n)break;d.translate((p+(a>>1))/c,(g+(o>>1))/c),e.angle&&d.rotate(e.angle),d.fillText(e.text,0,0),e.padding&&(d.lineWidth=2*e.padding,d.strokeText(e.text,0,0)),d.restore(),e.width=a,e.height=o,e.xoff=p,e.yoff=g,e.x1=a>>1,e.y1=o>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=a}let y=d.getImageData(0,0,(s<<5)/c,n/c).data,_=[];for(;--r>=0;){if(!(e=i[r]).hasText)continue;for(l=(a=e.width)>>5,o=e.y1-e.y0,h=0;h<o*l;h++)_[h]=0;if(null==(p=e.xoff))return;g=e.yoff;let t=0,n=-1;for(u=0;u<o;u++){for(h=0;h<a;h++){let e=l*u+(h>>5),i=y[(g+u)*(s<<5)+(p+h)<<2]?1<<31-h%32:0;_[e]|=i,t|=i}t?n=u:(e.y0++,o--,u--,g++)}e.y1=e.y0+n,e.sprite=_.slice(0,(e.y1-e.y0)*l)}}(this.contextAndRatio,e,this.data,t,this.cw,this.ch),this._placeStatus=0,e.hasText&&this.place(this._board,e,this._bounds,i))return this.result.push(e),this._bounds?function(t,e){let i=t[0],r=t[1];e.x+e.x0<i.x&&(i.x=e.x+e.x0),e.y+e.y0<i.y&&(i.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}(this._bounds,e):this._bounds=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=this._size[0]>>1,e.y-=this._size[1]>>1,this._tTemp=null,this._dtTemp=null,!0;if(this.updateBoardExpandStatus(e.fontSize),e.hasText&&this.shouldShrinkContinue()){if(1===this._placeStatus){let t=e.fontSize*this._originSize[0]/this.options.minFontSize,i=Math.max(e.width,e.height);if(i<=t)this.expandBoard(this._board,this._bounds,i/this._size[0]);else{if(!this.options.clip)return!0;this.expandBoard(this._board,this._bounds,t/this._size[0])}}else this._placeStatus,this.expandBoard(this._board,this._bounds);return this.updateBoardExpandStatus(e.fontSize),!1}return this._tTemp=null,this._dtTemp=null,!0}layout(t,e){this.initProgressive(),this.result=[],this._size=[e.width,e.height],this.clearCache(),this._originSize=[...this._size];let i=this.getContext(this.options.createCanvas({width:1,height:1}));this.contextAndRatio=i,this._board=Array((this._size[0]>>5)*this._size[1]).fill(0),this._bounds=null,t.length,this.result=[];let r=t.map((t,e)=>({text:this.getText(t),fontFamily:this.getTextFontFamily(t),fontStyle:this.getTextFontStyle(t),fontWeight:this.getTextFontWeight(t),angle:this.getTextRotate(t,e),fontSize:~~this.getTextFontSize(t),padding:this.getTextPadding(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t,x:0,y:0,width:0,height:0})).sort(function(t,e){return e.fontSize-t.fontSize});if(this.originalData=r,this.data=r,this.progressiveRun(),!this.options.clip&&this.options.enlarge&&this._bounds&&this.shrinkBoard(this._bounds),this._bounds&&["cardioid","triangle","triangle-upright"].includes(this.options.shape)){let t=(this._bounds[0].y+this._bounds[1].y)/2;this._dy=-(t-this._originSize[1]/2)}return this.result}formatTagItem(t){let e,i,r=this._size,s=this.zoomRatio(),n=this.dy(),a=r[0]>>1,l=r[1]>>1,o=t.length,h=[];for(let r=0;r<o;++r)e=t[r],(i={}).datum=e.datum,i.x=(e.x+a)*s,i.y=(e.y+l+n)*s,i.fontFamily=e.fontFamily,i.fontSize=e.fontSize*s,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.angle=e.angle,h.push(i);return h}output(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.result)):this.formatTagItem(this.result)}progressiveOutput(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.progressiveResult)):this.formatTagItem(this.progressiveResult)}updateBoardExpandStatus(t){this._isBoardExpandCompleted=t*(this._originSize[0]/this._size[0])<this.options.minFontSize}shouldShrinkContinue(){return!this.options.clip&&this.options.shrink&&!this._isBoardExpandCompleted}shrinkBoard(t){let e=t[0],i=t[1];if(i.x>=this._size[0]||i.y>=this._size[1])return;let r=Math.min(e.x,this._size[0]-i.x),s=Math.min(e.y,this._size[1]-i.y),n=2*Math.min(r/this._size[0],s/this._size[1]);this._size=this._size.map(t=>t*(1-n))}expandBoard(t,e,i){let r=this._size[0]*(i||1.1)-this._size[0]>>5,s=2*r>2?r:2;s%2!=0&&s++;let n=Math.ceil(this._size[1]*(s<<5)/this._size[0]);n%2!=0&&n++;let a=this._size[0],l=this._size[1],o=Array(s).fill(0),h=Array(n/2*(s+(a>>5))).fill(0);this.insertZerosToArray(t,l*(a>>5),h.length+s/2);for(let e=l-1;e>0;e--)this.insertZerosToArray(t,e*(a>>5),o.length);this.insertZerosToArray(t,0,h.length+s/2),this._size=[a+(s<<5),l+n],e&&(e[0].x+=(s<<5)/2,e[0].y+=n/2,e[1].x+=(s<<5)/2,e[1].y+=n/2)}insertZerosToArray(t,e,i){if(this.options.customInsertZerosToArray)return this.options.customInsertZerosToArray(t,e,i);let r=Math.floor(i/6e4);for(let i=0;i<r;i++)t.splice(e+6e4*i,0,...Array(6e4).fill(0));t.splice(e+6e4*r,0,...Array(i%6e4).fill(0))}getContext(t){t.width=1,t.height=1;let e=Math.sqrt(t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1).data.length>>2);t.width=(this.cw<<5)/e,t.height=this.ch/e;let i=t.getContext("2d",{willReadFrequently:!0});return i.fillStyle=i.strokeStyle="red",i.textAlign="center",{context:i,ratio:e,canvas:t}}place(t,e,i,r){let s=!1;if(this.shouldShrinkContinue()&&(e.width>this._size[0]||e.height>this._size[1]))return this._placeStatus=1,!1;let n=.5>this.random()?1:-1;if(!this.shouldShrinkContinue()&&this.isSizeLargerThanMax(e,n))return null;let a=e.x,l=e.y,o=Math.sqrt(this._size[0]*this._size[0]+this._size[1]*this._size[1]),h=this.spiral(this._size),u,d,c,p,g=-n;for(this._tTemp=null,this._dtTemp=null;u=h(g+=n);){let h=Math.sqrt((d=u[0])**2+(c=u[1])**2),y=Math.atan(c/d);d<0?y+=Math.PI:c<0&&(y=2*Math.PI+y);let _=this.shape(y);if(Math.min(Math.abs(d),Math.abs(c))>=o)break;if(h>=r)s&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=n);else{var f,m;if(e.x=a+~~(h*_*Math.cos(-y)),e.y=l+~~(h*_*Math.sin(-y)),p=e,this.options.clip)if(this.shouldShrinkContinue()){if(xT(p,this._size)){s&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=n);continue}}else{if(xw(p,this._size)){s&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=n);continue}xT(p,this._size)&&(p=function(t,e){let i=t.sprite,r=t.y1-t.y0,s=t.width>>5,n=0,a=[],l=Math.max(-(t.y0+t.y),0),o=Math.min(r+(e[1]-(t.y1+t.y)),r),h=Math.max(-(t.x0+t.x),0)>>5,u=Math.min(s+(e[0]-(t.x1+t.x)>>5)+1,s);for(let t=0;t<r;t++){for(let e=0;e<s;e++)t<l||o<=t||e<h||u<=e||a.push(i[n+e]);n+=s}let d=h<<5,c=s-u<<5,p=r-o;return Object.assign(Object.assign({},t),{width:t.width-d-c,height:t.height-l-p,x0:t.x0+d,x1:t.x1-c,y0:t.y0+l,y1:t.y1-p,x:t.x+d/2-c/2,sprite:a})}(p,this._size))}else if(xT(p,this._size)){s&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=n);continue}if(s=!0,(!i||(f=p,m=i,f.x+f.x1>m[0].x&&f.x+f.x0<m[1].x&&f.y+f.y1>m[0].y&&f.y+f.y0<m[1].y))&&(!i||!function(t,e,i){let r=i[0]>>5,s=t.sprite,n=t.width>>5,a=t.x-(n<<4),l=127&a,o=32-l,h=t.y1-t.y0,u,d=(t.y+t.y0)*r+(a>>5);for(let t=0;t<h;t++){u=0;for(let i=0;i<=n;i++)if((u<<o|(i<n?(u=s[t*n+i])>>>l:0))&e[d+i])return!0;d+=r}return!1}(p,t,this._size))){let i=p.sprite,r=p.width>>5,s=this._size[0]>>5,n=p.x-(r<<4),a=127&n,l=32-a,o=p.y1-p.y0,h,u=(p.y+p.y0)*s+(n>>5);for(let e=0;e<o;e++){h=0;for(let s=0;s<=r;s++)t[u+s]|=h<<l|(s<r?(h=i[e*r+s])>>>a:0);u+=s}return e.sprite=null,p.sprite=null,!0}}}return null!==this._tTemp&&(this._placeStatus=3),this.shouldShrinkContinue()||this.setCache(p,n),!1}clearCache(){this.cacheMap.clear()}setCache(t,e){let i=`${t.angle}-${e}`,r=t.x1-t.x0,s=t.y1-t.y0;if(!this.cacheMap.has(i))return void this.cacheMap.set(i,{width:r,height:s});let{width:n,height:a}=this.cacheMap.get(i);(r<n&&s<a||r<=n&&s<a)&&this.cacheMap.set(i,{width:r,height:s})}isSizeLargerThanMax(t,e){let i=`${t.angle}-${e}`;if(!this.cacheMap.has(i))return!1;let{width:r,height:s}=this.cacheMap.get(i),n=t.x1-t.x0,a=t.y1-t.y0;return n>=r&&a>=s}}xM.defaultOptions={enlarge:!1,minFontSize:2,maxSingleWordTryCount:2};let xw=(t,e)=>t.x+t.x0>e[0]||t.y+t.y0>e[0]||t.x+t.x1<0||t.y+t.y1<0,xT=(t,e)=>t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>e[0]||t.y+t.y1>e[1],xC=(t,e,i)=>{let{threshold:r,invert:s=!1}=null!=e?e:{};if(!t||"#fff"===t)return(t,e,i)=>{let n=t.width;if(0===t.data[e*n*4+4*i+3])return!s;let a=t.data[e*n*4+4*i+0],l=t.data[e*n*4+4*i+1],o=t.data[e*n*4+4*i+2];if(255===a&&255===l&&255===o)return!s;if(ee(r)){let t=.3*a+.59*l+.11*o;return s?t<=r:t>=r}return!1};let n=i({width:1,height:1}).getContext("2d",{willReadFrequently:!0});n.fillStyle=t,n.fillRect(0,0,1,1);let a=n.getImageData(0,0,1,1).data;return(t,e,i)=>{let r=t.width;return[0,1,2,3].every(n=>s?t.data[4*(e*r+i)+n]!==a[n]:t.data[4*(e*r+i)+n]===a[n])}},xE=(t,e,i,r,s=!1,n)=>{let{backgroundColor:a="#fff"}=t,{fill:l="#000"}=t;s&&([a,l]=[l,a]);let o=r||n({width:e,height:i,dpr:1}),h=o.getContext("2d",{willReadFrequently:!0});if(r){let t=r.width,s=r.height;h.clearRect(0,0,t,s),r.style.width=`${e}px`,r.style.height=`${i}px`,r.width=e,r.height=i}return h.fillStyle=a,h.fillRect(0,0,o.width,o.height),"text"===t.type?xB(t,l,o.width,o.height,h):"geometric"===t.type&&xL(t,l,o.width,o.height,h),o},xB=(t,e,i,r,s)=>{let{fontFamily:n="sans-serif",fontWeight:a="normal",fontStyle:l="normal",fontVariant:o="normal",text:h,hollow:u}=t,d=12;s.font=`${l} ${o} ${a} ${d}px ${n}`,s.textAlign="center",s.textBaseline="middle",s.fillStyle=e;let c=s.measureText(h),p="normal"!==l?1.1:1,g=t5(c.actualBoundingBoxRight)&&t5(c.actualBoundingBoxLeft)?Math.ceil(p*(Math.abs(c.actualBoundingBoxRight)+Math.abs(c.actualBoundingBoxLeft))):0,f=Math.max(Math.ceil(c.width),g,d);if(u&&(s.globalCompositeOperation="xor"),f>i){let t=Math.min(i/f,r/d);s.fillText(h,i/2,r/2),s.scale(t,t)}else d=Math.min(d=Math.floor(d*i/f),r),s.font=`${l} ${o} ${a} ${d}px ${n}`,s.fillText(h,Math.floor(i/2),Math.floor(r/2))},xP=(t,e,i=0,r)=>{let s=2*Math.PI/r;return Array(r).fill(0).map((r,n)=>lc(t,e,i+n*s))},xO=(t,e,i=0,r)=>{let s=2*Math.PI/r,n=xb("cardioid");return Array(r).fill(0).map((r,a)=>{let l=i+a*s;return lc(t,e*n(l),l)})},xI=(t,e)=>{t.beginPath(),e.forEach((e,i)=>{0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)}),t.closePath(),t.fill()},xR=(t,e)=>{let i;t.beginPath(),e.forEach((e,r)=>{0===r?t.moveTo(e.x,e.y):t.bezierCurveTo(e.x,e.y,i.x,i.y,e.x,e.y),i=e}),t.closePath(),t.fill()},xL=(t,e,i,r,s)=>{let{hollow:n}=t,{center:a,maxRadius:l}=xv(t.shape,[i,r]);s.fillStyle=e,n&&(s.globalCompositeOperation="xor");let o=a[0],h=a[1];if("cardioid"===t.shape)xR(s,xO({x:o,y:h},l,0,100));else if("circle"===t.shape)s.beginPath(),s.arc(o,h,l,0,2*Math.PI,!0),s.fill();else if("diamond"===t.shape)xI(s,xP({x:o,y:h},l,-Math.PI/2,4));else if("square"===t.shape)xI(s,xP({x:o,y:h},l,-Math.PI/4,4));else if("pentagon"===t.shape)xI(s,xP({x:o,y:h},l,Math.PI/2,5));else if("triangle"===t.shape||"triangleUpright"===t.shape)xI(s,xP({x:o,y:h},l,-Math.PI/2,3));else if("triangleForward"===t.shape)xI(s,xP({x:o,y:h},l,0,3));else if("star"===t.shape){let t=xP({x:o,y:h},l,-Math.PI/2,5),e=xP({x:o,y:h},l/(2*Math.cos(Math.PI/5)),-Math.PI/2+Math.PI/5,5),i=[];for(let r=0;r<5;r++)i.push(t[r]),i.push(e[r]);xI(s,i)}else s.fillRect(0,0,i,r)};class xD extends xk{constructor(t){super(t8({},xD.defaultOptions,t)),this.fillGridAt=(t,e)=>{t>=this.ngx||e>=this.ngy||t<0||e<0||(this.grid[t][e]=!1)},this.updateGrid=(t,e,i,r,s)=>{let n=s.occupied,a=n.length;for(;a--;){let i=t+n[a][0],r=e+n[a][1];i>=this.ngx||r>=this.ngy||i<0||r<0||this.fillGridAt(i,r)}},this.gridSize=Math.max(Math.floor(this.options.gridSize),4)}getPointsAtRadius(t){if(this.pointsAtRadius[t])return this.pointsAtRadius[t];let e=8*t,i=e,r=[];for(0===t&&r.push([this.center[0],this.center[1],0]);i--;){let s=this.shape(i/e*2*Math.PI);r.push([this.center[0]+t*s*Math.cos(-i/e*2*Math.PI),this.center[1]+t*s*Math.sin(-i/e*2*Math.PI)*this.options.ellipticity,i/e*2*Math.PI])}return this.pointsAtRadius[t]=r,r}getTextInfo(t,e=1,i){var r;let s=this.options.clip?1:e,n=Math.max(Math.floor((this.isTryRepeatFill?this.options.fillTextFontSize:this.getTextFontSize(t))*s),this.options.minFontSize),a=this.getText(t)+"";if(this.options.clip&&(a=a.slice(0,Math.ceil(a.length*e))),!a)return null;let l=this.getTextFontWeight(t),o=this.getTextFontStyle(t),h=this.getTextRotate&&null!=(r=this.getTextRotate(t,i))?r:0,u=this.getTextFontFamily(t),d=this.options.createCanvas({width:1,height:1}),c=d.getContext("2d",{willReadFrequently:!0});c.font=o+" "+l+" "+n.toString(10)+"px "+u;let p=c.measureText(a).width,g=Math.max(n,c.measureText("m").width,c.measureText("Ｗ").width),f=p+2*g,m=3*g,y=Math.ceil(f/this.gridSize),_=Math.ceil(m/this.gridSize);f=y*this.gridSize;let v=-p/2,b=-(.4*g),x=Math.ceil((f*Math.abs(Math.sin(h))+(m=_*this.gridSize)*Math.abs(Math.cos(h)))/this.gridSize),S=Math.ceil((f*Math.abs(Math.cos(h))+m*Math.abs(Math.sin(h)))/this.gridSize),k=S*this.gridSize,A=x*this.gridSize;d.setAttribute("width",""+k),d.setAttribute("height",""+A),c.scale(1,1),c.translate(k/2,A/2),c.rotate(-h),c.font=o+" "+l+" "+n.toString(10)+"px "+u,c.fillStyle="#000",c.textBaseline="middle",c.fillText(a,v,b);let M=c.getImageData(0,0,k,A).data;if(this.exceedTime())return null;let w=[],T,C=S,E=[x/2,S/2,x/2,S/2],B=(t,e,i)=>{let r=this.gridSize;for(;r--;){let s=this.gridSize;for(;s--;)if(M[4*((e*this.gridSize+r)*k+(t*this.gridSize+s))+3])return i.push([t,e]),t<E[3]&&(E[3]=t),t>E[1]&&(E[1]=t),e<E[0]&&(E[0]=e),void(e>E[2]&&(E[2]=e))}};for(;C--;)for(T=x;T--;)B(C,T,w);return{datum:t,occupied:w,bounds:E,gw:S,gh:x,fillTextOffsetX:v,fillTextOffsetY:b,fillTextWidth:p,fillTextHeight:g,fontSize:n,fontStyle:o,fontWeight:l,fontFamily:u,angle:h,text:a}}calculateEmptyRate(){let t=this.ngx*this.ngy,e=0;for(let t=0;t<this.ngx;t++)for(let i=0;i<this.ngy;i++)this.grid[t][i]&&e++;return e/t}canFitText(t,e,i,r,s){let n=s.length;for(;n--;){let i=t+s[n][0],r=e+s[n][1];if(i>=this.ngx||r>=this.ngy||i<0||r<0){if(!this.options.drawOutOfBound)return!1}else if(!this.grid[i][r])return!1}return!0}layoutWord(t,e=1){let i=this.data[t],r=this.getTextInfo(i,e,t);if(!r||this.exceedTime())return!1;if(!this.options.drawOutOfBound&&(!this.options.shrink||r.fontSize<=this.options.minFontSize)&&!this.options.clip){let t=r.bounds;if(t[1]-t[3]+1>this.ngx||t[2]-t[0]+1>this.ngy)return!1}let s=this.maxRadius+1,n=t=>{let e=Math.floor(t[0]-r.gw/2),i=Math.floor(t[1]-r.gh/2),n=r.gw,a=r.gh;return!!this.canFitText(e,i,n,a,r.occupied)&&(r.distance=this.maxRadius-s,r.theta=t[2],this.outputText(e,i,r),this.updateGrid(e,i,n,a,r),!0)};for(;s--;){let t=this.getPointsAtRadius(this.maxRadius-s);if(this.options.random&&ec(t=[].concat(t)),t.some(n))return!0}return(this.options.clip||!!(this.options.shrink&&r.fontSize>this.options.minFontSize))&&this.layoutWord(t,.75*e)}outputText(t,e,i){let r=this.getTextColor(i),s={text:i.text,datum:i.datum,color:r,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontFamily:i.fontFamily,angle:i.angle,width:i.fillTextWidth,height:i.fillTextHeight,x:(t+i.gw/2)*this.gridSize,y:(e+i.gh/2)*this.gridSize+i.fillTextOffsetY+.5*i.fontSize,fontSize:i.fontSize};this.result.push(s),this.progressiveResult&&this.progressiveResult.push(s)}initGrid(t){this.grid=[];let e=this.options.shape;if(ey(e)){let i=xE(e,t.width,t.height,void 0,!1,this.options.createCanvas),r=i.getContext("2d").getImageData(0,0,this.ngx*this.gridSize,this.ngy*this.gridSize);this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(i);let s=xC(e.backgroundColor,void 0,this.options.createCanvas),n=(t,e)=>{let i=this.gridSize;for(;i--;){let n=this.gridSize;for(;n--;)if(!s(r,e*this.gridSize+i,t*this.gridSize+n))return void(this.grid[t][e]=!0)}this.grid[t][e]=!1},a=this.ngx;for(;a--;){this.grid[a]=[];let t=this.ngy;for(;t--;)n(a,t),!1!==this.grid[a][t]&&(this.grid[a][t]=!0)}r=s=void 0}else{let t=this.ngx;for(;t--;){this.grid[t]=[];let e=this.ngy;for(;e--;)this.grid[t][e]=!0}}}canRepeat(){return this.calculateEmptyRate()>.001}layout(t,e){this.initProgressive(),this.drawnCount=0,this.isTryRepeatFill=!1,this.originalData=t,this.data=t,this.pointsAtRadius=[],this.ngx=Math.floor(e.width/this.gridSize),this.ngy=Math.floor(e.height/this.gridSize);let{center:i,maxRadius:r}=xv(this.options.shape,[e.width,e.height]);return this.center=e.origin?[e.origin[0]/this.gridSize,e.origin[1]/this.gridSize]:[i[0]/this.gridSize,i[1]/this.gridSize],this.maxRadius=Math.floor(r/this.gridSize),this.initGrid(e),this.result=[],this.progressiveRun()}}xD.defaultOptions={gridSize:8,ellipticity:1,maxSingleWordTryCount:1};class xF extends xk{constructor(t){super(t8({},xF.defaultOptions,t)),this.random=this.options.random?Math.random:()=>0,this.aspectRatio=1}fit(t){for(let r=0,s=this.result.length;r<s;r++){var e,i;if(e=t,i=this.result[r],!(e.left+e.width<i.left||e.top+e.height<i.top||e.left>i.left+i.width||e.top>i.top+i.height))return!1}return!0}getTextInfo(t,e){let i={datum:t,fontSize:this.getTextFontSize(t),fontWeight:this.getTextFontWeight(t),fontStyle:this.getTextFontStyle(t),fontFamily:this.getTextFontFamily(t),angle:this.getTextRotate(t,e),text:this.getText(t)+"",x:this.center[0],y:this.center[1]},r=this.options.getTextBounds(i);return i.width=r.width(),i.height=r.height(),i.top=this.center[1]-i.height+.21*i.height,i.left=this.center[0]-i.width/2,i}layoutWord(t){let e=this.getTextInfo(this.data[t],t),i=2*Math.PI,r=0,s=e.left,n=e.top,a=e.width,l=e.height,o=1,h=this.fit(e);for(;!h&&r<this.maxRadius;)r+=.5,o=this.shape(r/this.maxRadius*2*Math.PI),i+=.5*(this.options.random?this.random()>.5?1:-1:t%2==0?1:-1),s=this.center[0]-a/2+r*o*Math.cos(i)*this.aspectRatio,n=this.center[1]-l/2+r*o*Math.sin(i),e.left=s,e.top=n,e.x=s+a/2,e.y=n+l/2,h=this.fit(e);return!!h&&!!(this.options.clip||e.left>=0&&e.left+e.width<=this.width&&e.top>=0&&e.top+e.height<=this.height)&&(this.result.push(e),!0)}layout(t,e){if(!(null==t?void 0:t.length))return[];this.initProgressive(),this.result=[],this.maxRadius=Math.sqrt(e.width*e.width+e.height*e.height)/2,this.center=[e.width/2,e.height/2],this.width=e.width,this.height=e.height,this.data=t.sort((t,e)=>this.getTextFontSize(e)-this.getTextFontSize(t));let i=0;for(;i<t.length&&(this.layoutWord(i),i++,this.progressiveIndex=i,!this.exceedTime()););return this.result}}xF.defaultOptions={enlarge:!1};let xz={x:"x",y:"y",z:"z",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle"},xj=(t,e)=>{var i,r,s,n,a,l;if(t.size&&(t.size[0]<=0||t.size[1]<=0))return tW.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];let o=(null!=(i=t.size)?i:[500,500]).slice();o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]);let h=t.fontFamily?xH(t.fontFamily):"sans-serif",u=t.fontStyle?xH(t.fontStyle):"normal",d=t.fontWeight?xH(t.fontWeight):"normal",c=t.rotate?xH(t.rotate):0,p=xH(t.text),g=null!=(r=t.spiral)?r:"archimedean",f=t.padding?xH(t.padding):1,m=null!=(s=t.shape)?s:"square",y=null!=(n=t.shrink)&&n,_=null!=(a=t.enlarge)&&a,v=null!=(l=t.clip)&&l,b=t.minFontSize,x=t.randomVisible,S=t.as?Object.assign(Object.assign({},xz),t.as):xz,k=t.depth_3d,A=t.postProjection,M=t.fontSize?xH(t.fontSize):14,w=t.fontSizeRange;if(w&&!tH(M)){let t=M,i=xV(xW(t,e),w);M=e=>i(t(e))}let T=xM;"fast"===t.layoutType?T=xF:"grid"===t.layoutType&&(T=xD);let C=new T(Object.assign(Object.assign({},t),{text:p,padding:f,spiral:g,shape:m,rotate:c,fontFamily:h,fontStyle:u,fontWeight:d,fontSize:M,shrink:y,clip:v,enlarge:_,minFontSize:b,random:x,outputCallback:e=>{let i,r,s=[];for(let n=0,a=e.length;n<a;n++)(i=(r=e[n]).datum)[S.x]=r.x,i[S.y]=r.y,i[S.fontFamily]=r.fontFamily,i[S.fontSize]=r.fontSize,i[S.fontStyle]=r.fontStyle,i[S.fontWeight]=r.fontWeight,i[S.angle]=r.angle,"StereographicProjection"===A&&function(t,e,i,r,s){let n=Math.max(t[0],t[1])/2,a=function(t,e,i,r,s){let{x:n,y:a}=s,l=n/t*Math.PI*2,o=Math.PI-a/e*Math.PI;return{x:i*Math.sin(o+=(o<Math.PI/2?1:-1)*Math.pow(Math.min(o-Math.PI/2,1),2)/5)*Math.cos(l)+r.x,y:i*Math.cos(o)+r.y,z:i*Math.sin(o)*Math.sin(l)+r.z}}(t[0],t[1],n,{x:n,y:n,z:null!=s?s:n},e);i[r.x]=a.x,i[r.y]=a.y,i[r.z]=a.z}(o,r,i,S,k),t.dataIndexKey&&(i[t.dataIndexKey]=`${n}`),s.push(i);return s}}));return C.layout(e,{width:o[0],height:o[1]}),t.progressiveStep>0||t.progressiveTime>0?{progressive:C}:C.output()},xH=t=>t3(t)||tH(t)||tK(t)||tY(t)?t:e=>e[t.field],xN=t=>t<0?-Math.sqrt(-t):Math.sqrt(t),xV=(t,e,i)=>{if(t[0]===t[1])return t=>e[0];let r=xN(t[0]),s=xN(t[1]),n=Math.min(r,s),a=Math.max(r,s);return t=>(xN(t)-n)/(a-n)*(e[1]-e[0])+e[0]},xW=(t,e)=>{let i,r=1/0,s=-1/0,n=e.length;for(let a=0;a<n;++a)(i=aJ(t(e[a])))<r&&(r=i),i>s&&(s=i);return 1===e.length&&r===s&&(r-=1e4),[r,s]};(P=K||(K={})).BEFORE_WORDCLOUD_SHAPE_LAYOUT="beforeWordcloudShapeLayout",P.AFTER_WORDCLOUD_SHAPE_LAYOUT="afterWordcloudShapeLayout",P.AFTER_WORDCLOUD_SHAPE_DRAW="afterWordcloudShapeDraw";let xU=(t,e)=>{if(1===e.length&&"#537EF5"===e[0])return!0;if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},xG=t=>/^[\u4e00-\u9fa5]+$/.test(t),xZ=(t,e)=>{if(et(t))return 0;let i=0;for(let e of t)xG(e)?i+=1:i+=.53;return i};function x$(t,e,i){let{stepFactor:r,importantWordCount:s,globalShinkLimit:n}=e,{size:a,segmentation:{regions:l},tempCanvas:o,boardSize:h,shapeCenter:u,shapeMaxR:d,shapeRatio:c}=i,p=o.getContext("2d",{willReadFrequently:!0}),g=xQ(i),f=g.slice(0),m=e.fontSizeShrinkFactor,y=null,_=1,v=1,b=0;t.length>s&&(b=t.sort((t,e)=>e.weight-t.weight)[s].weight);for(let e=0;e<l.length;e++){let{words:i,center:s,maxR:u,ratio:d}=l[e],c=!1;for(let e=0;e<i.length;e++){xq(o,p,t,e);let l=i[e];if(l.x=s[0],l.y=s[1],!l.skip&&l.hasText&&l.sprite&&xY(f,l,u,d,a,h,r))l.hasPlaced=!0;else{if(!l.skip&&l.weight>b&&v>n){let e=l.datum[Symbol.for("vGrammar_id")];e!==y&&(y=e,_=v),v*=m,t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*m}),f=g.slice(0),c=!0;break}if(!l.skip&&l.datum[Symbol.for("vGrammar_id")]===y){t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/v}),l.skip=!0,v=_,y=null,f=g.slice(0),c=!0;break}}}c&&(e=-1)}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];xq(o,p,i,t),e.x=u[0],e.y=u[1],e.hasText&&xY(f,e,d,c,a,h,r)&&(e.hasPlaced=!0)}}e.board=f}function xY(t,e,i,r,s,n,a){var l;let o=e.x,h=e.y,u=(l=r,function(t){return[l*(t*=.1)*Math.cos(t),t*Math.sin(t)]}),d=+a,c,p,g,f=-d;for(;c=u(f+=d);){let{wordSize:r,bounds:{dTop:a,dBottom:l,dLeft:u,dRight:d}}=e;if(Math.min(Math.abs(p=c[0]),Math.abs(g=c[1]))>=i)break;if(e.x=~~(o+p),e.y=~~(h+g),!(e.x-u<0||e.x+d>s[0]||e.y-a<0||e.y+l>s[1]||xK(e,t,n)))return xX(e,t,n),!0}return!1}function xX(t,e,i){let{wordSize:r}=t,s=t.sprite,n=r[0]>>5,a=i[0]>>5,l=t.x-(n<<4),o=l%32,h=32-o,u=r[1],d,c=(t.y-(r[1]>>1))*a+(l>>5);if(0===o)for(let t=0;t<u;t++){for(let i=0;i<n;i++)e[c+i]|=s[t*n+i];c+=a}else for(let t=0;t<u;t++){d=0;for(let i=0;i<=n;i++)e[c+i]|=d<<h|(i<n?(d=s[t*n+i])>>>o:0);c+=a}}function xK(t,e,i){let{sprite:r,wordSize:s}=t,n=i[0]>>5,a=s[0]>>5,l=t.x-(a<<4),o=l%32,h=32-o,u=s[1],d,c=(t.y-(s[1]>>1))*n+(l>>5);if(0===o)for(let t=0;t<u;t++){for(let i=0;i<a;i++)if(e[c+i]&r[t*a+i])return!0;c+=n}else for(let t=0;t<u;t++){d=0;for(let i=0;i<=a;i++)if((d<<h|(i<a?(d=r[t*a+i])>>>o:0))&e[c+i])return!0;c+=n}return!1}function xq(t,e,i,r){let s,n;if(i[r].sprite||0===i[r].fontSize)return;let a=Math.PI/180,l=i.length;t.width=2048,t.height=2048,e.clearRect(0,0,2048,2048),e.textAlign="center";let o,h,u=0,d=0,c=0,p=0,g=r;for(--r;++r<l;){let t=i[r],s=Math.max(t.fontSize,2);if(e.save(),e.font=t.fontStyle+" "+t.fontWeight+" "+s+"px "+t.fontFamily,o=e.measureText(t.text+"m").width+2*t.padding,h=2*s+2*t.padding,0!==t.rotate){let e=Math.sin(t.rotate*a),i=Math.cos(t.rotate*a),r=o*i,s=o*e,n=h*i,l=h*e;o=Math.max(Math.abs(r+l),Math.abs(r-l)),h=~~Math.max(Math.abs(s+n),Math.abs(s-n))}if(o=o+31>>5<<5,(h=Math.ceil(h))>c&&(c=h),u+o>=2048&&(u=0,d+=c,c=h),d+h>=2048){if(0===d){t.hasText=!1;continue}break}d+h>=p&&(p=d+h),e.translate(u+(o>>1),d+(h>>1)),0!==t.rotate&&e.rotate(t.rotate*a),e.fillText(t.text,0,0),t.padding&&(e.lineWidth=2*t.padding,e.strokeText(t.text,0,0)),e.restore(),t.LT=[u,d],t.wordSize=[o,h],t.hasText=!0,u+=o}if(0===p)return;let f=e.getImageData(0,0,2048,p).data;for(;--r>=g;){let t=i[r];if(!t.hasText){t.bounds={dTop:1/0,dBottom:-1/0,dLeft:1/0,dRight:-1/0};break}let{LT:e=[0,0],wordSize:a}=t;[u,d]=e;let l=a[0]>>5,o=Array(l*a[1]).fill(0),[h,c,p,g]=[1/0,-1/0,1/0,-1/0];for(n=0;n<a[1];n++){let t;for(s=0;s<a[0];s++)if(f[4*((d+n)*2048+(u+s))+3]>0){let e=1<<31-s%32;o[l*n+(s>>5)]|=e,s<p&&(p=s),s>g&&(g=s),t|=e}t&&(n<h&&(h=n),n>c&&(c=n))}t.bounds={dTop:(a[1]>>1)-h,dBottom:c-(a[1]>>1),dLeft:(a[0]>>1)-p,dRight:g-(a[0]>>1)},t.sprite=o,delete t.LT}}function xQ(t){let{segmentation:{labels:e},boardSize:i,size:r}=t,s=i[0]>>5,n=Array(s*r[1]).fill(0);for(let t=0;t<r[1];t++)for(let i=0;i<r[0];i++)if(0===e[t*r[0]+i]){let e=1<<31-i%32;n[s*t+(i>>5)]|=e}if(i[0]>r[0]){let t=(1<<i[0]-r[0])-1;for(let e=0;e<r[1];e++)n[s*e+s-1]|=t}return n}let xJ=t=>new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(t),x0=t=>new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(t),x1=t=>e=>iF(e,t),x2=(t,e={})=>{if(tK(t))return t;let i=[t];return(e&&e.get||x1)(i)},x3=(t,e={})=>{if(tY(t)){let i=t.map(t=>x2(t,e));return t=>i.map(e=>e(t))}return x2(t,e)},x5=t=>t?"string"==typeof t||"number"==typeof t?()=>t:tK(t)?t:e=>e[t.field]:null;class x4 extends a2{constructor(){super(ad,ac),this.type=U.Sqrt}clone(){return(new x4).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}}let x7={x:"x",y:"y",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle",opacity:"opacity",visible:"visible",isFillingWord:"isFillingWord",color:"color"};class x6{constructor(t){this.progressiveResult=[],this.options=t}layout(t){this.data=t;let e=this.options,i={shapeUrl:e.shape,size:e.size,ratio:e.ratio||.8,tempCanvas:void 0,boardSize:[0,0],random:!1,randomGenerator:void 0},r=this.options.createCanvas({width:e.size[0],height:e.size[1]}),s=r.getContext("2d",{willReadFrequently:!0});if(s.textAlign="center",s.textBaseline="middle",i.tempCanvas=r,i.boardSize=[e.size[0]+31>>5<<5,e.size[1]],i.random?i.randomGenerator=Math.random:i.randomGenerator=xm(),this.segmentationInput=i,t3(i.shapeUrl)){var n,a;i.isEmptyPixel=xC(void 0,void 0,this.options.createCanvas);let t=(n=i.shapeUrl,a=this.options.createImage,n&&(xJ(n)||x0(n)||n.startsWith("<svg"))?new Promise((t,e)=>{var i;let r=a({image:n}),s=null==(i=r.resources)?void 0:i.get(n);s&&"success"===s.state&&s.data?t(s.data):(r.successCallback=()=>{var i;if(r){let s=null==(i=r.resources)?void 0:i.get(n);s&&"success"===s.state&&s.data?t(s.data):e(Error("image load failed: "+n))}else e(Error("image load failed: "+n))},r.failCallback=()=>{e(Error("image load failed: "+n))})}):null);t?(this.isImageFinished=!1,this.isLayoutFinished=!1,t.then(t=>{this.isImageFinished=!0;let r=this.options.createCanvas({width:e.size[0],height:e.size[1],dpr:1});i.maskCanvas=r;let s=r.getContext("2d");e.removeWhiteBorder&&function(t,e,i){e.width=t.width,e.height=t.height;let r=e.getContext("2d",{willReadFrequently:!0});r.clearRect(0,0,e.width,e.height),r.drawImage(t,0,0);let s=e.width,n=r.getImageData(0,0,e.width,e.height),a=0,l=n.height,o=0,h=n.width,u=(t,e)=>{for(let r=0;r<t;++r)if(!i(n,e,r))return!1;return!0},d=(t,e,r)=>{for(let s=e;s<r;++s)if(!i(n,s,t))return!1;return!0};for(;a<l&&u(s,a);)++a;for(;l-1>a&&u(s,l-1);)--l;for(;o<h&&d(o,a,l);)++o;for(;h-1>o&&d(h-1,a,l);)--h;let c=r.getImageData(o,a,h-o,l-a);e.width=c.width,e.height=c.height,r.clearRect(0,0,e.width,e.height),r.putImageData(c,0,0)}(t,r,i.isEmptyPixel);let n=function(t,e){let i=t.width,r=t.height,s=e[0]/i;r*s>e[1]&&(s=e[1]/r);let n=Math.floor(s*i),a=Math.floor(s*r);return{x:(e[0]-n)/2,y:(e[1]-a)/2,width:n,height:a,scale:s}}(t,e.size);s.clearRect(0,0,e.size[0],e.size[1]),s.drawImage(t,n.x,n.y,n.width,n.height),this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(i.maskCanvas)}).catch(t=>{this.isImageFinished=!0})):(this.isImageFinished=!0,this.isLayoutFinished=!0)}else if(i.shapeUrl&&("text"===i.shapeUrl.type||"geometric"===i.shapeUrl.type)){i.isEmptyPixel=xC(i.shapeUrl.backgroundColor,void 0,this.options.createCanvas);let t=xE(i.shapeUrl,e.size[0],e.size[1],void 0,!1,this.options.createCanvas);i.maskCanvas=t,this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(t),this.doLayout(),this.isImageFinished=!0,this.isLayoutFinished=!0}}canAnimate(){return!0}unfinished(){return!this.isLayoutFinished}output(){return this.progressiveResult}progressiveRun(){this.isImageFinished&&!this.isLayoutFinished&&(this.segmentationInput.maskCanvas&&this.doLayout(),this.isLayoutFinished=!0)}progressiveOutput(){return this.progressiveResult}doLayout(){var t,e,i,r,s,n,a,l,o,h,u,d,c,p,g,f,m,y,_,v,b;let x,S,k=this.segmentationInput,A=function(t){let{size:e,maskCanvas:i}=t,r=i.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,i.width,i.height),s=Array(e[0]*e[1]).fill(0),n=1,a=[[0,1],[1,0],[-1,0],[0,-1]],l=[];for(let i=0;i<e[1];i++)for(let o=0;o<e[0];o++)if(0===s[i*e[0]+o]&&!t.isEmptyPixel(r,i,o)){s[i*e[0]+o]=n,l.push([i,o]);for(let i=0;i<l.length;i++)for(let o=0;o<4;o++){let h=l[i][0]+a[o][0],u=l[i][1]+a[o][1];h=h<0?0:h>=e[1]?e[1]-1:h,u=u<0?0:u>=e[0]?e[0]-1:u,0!==s[h*e[0]+u]||t.isEmptyPixel(r,h,u)||(s[h*e[0]+u]=n,l.push([h,u]))}n++,l=[]}let o={},h={},u={},d={},c={},p={},g={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0,width:0,height:0},f=[];for(let t=0;t<e[1];t++)for(let i=0;i<e[0];i++){let r=s[t*e[0]+i];0!==r&&(function(t,i){let r=[[0,1],[1,0],[-1,0],[0,-1]];if(0===t||0===i||t===e[1]-1||i===e[0]-1)return!0;for(let n=0;n<4;n++){let a=t+r[n][0],l=i+r[n][1];if(a=a<0?0:a>=e[1]?e[1]-1:a,l=l<0?0:l>=e[0]?e[0]-1:l,0===s[a*e[0]+l])return!0}return!1}(t,i)&&(f.push([t,i]),o[r]=o[r]||[],o[r].push([i,t]),d[r]||(d[r]=[1/0,-1/0,1/0,-1/0]),t<d[r][0]&&(d[r][0]=t),t>d[r][1]&&(d[r][1]=t),i<d[r][2]&&(d[r][2]=i),i>d[r][3]&&(d[r][3]=i),i<g.x1&&(g.x1=i),i>g.x2&&(g.x2=i),t<g.y1&&(g.y1=t),t>g.y2&&(g.y2=t)),h[r]=(h[r]||0)+1)}let m=[];for(let t in o){let e=o[t],i=~~(e.reduce((t,e)=>t+e[0],0)/e.length),r=~~(e.reduce((t,e)=>t+e[1],0)/e.length);u[t]=[i,r],m.push(...e);let[s,n,a,l]=d[t];c[t]=~~Math.max(Math.sqrt((i-a)**2+(r-s)**2),Math.sqrt((i-l)**2+(r-n)**2),Math.sqrt((i-a)**2+(r-n)**2),Math.sqrt((i-l)**2+(r-s)**2)),p[t]=(l-a)/(n-s)}let y=Object.keys(u).map(t=>({label:t-1,boundary:o[t],area:h[t],center:u[t],maxPoint:d[t],maxR:c[t],ratio:p[t]}));g.width=g.x2-g.x1+1,g.height=g.y2-g.y1+1;let _=~~(m.reduce((t,e)=>t+e[0],0)/m.length),v=~~(m.reduce((t,e)=>t+e[1],0)/m.length),b=~~Math.max(Math.sqrt((_-g.x1)**2+(v-g.y1)**2),Math.sqrt((_-g.x2)**2+(v-g.y2)**2),Math.sqrt((_-g.x1)**2+(v-g.y2)**2),Math.sqrt((_-g.x2)**2+(v-g.y1)**2)),x=g.width/g.height,S=Object.keys(h).reduce((t,e)=>t+h[e],0),k={regions:y,labels:s,labelNumber:n-1};if(t.blur){let i=t.blur,r=function(t,e,i,r){let s=Math.ceil(r/2),n=function(t,e){let i=Array(2*t+1).fill(0),r=0;for(let s=-t;s<=t;s++){let n=Math.exp(-s*s/(2*e*e));i[s+t]=n,r+=n}for(let t=0;t<i.length;t++)i[t]/=r;return i}(s,r/3),a=Array(t.length).fill(0),l=Array(t.length).fill(0);for(let r=0;r<i;r++)for(let i=0;i<e;i++){let l=0;for(let a=-s;a<=s;a++)l+=t[r*e+Math.min(Math.max(i+a,0),e-1)]*n[a+s];a[r*e+i]=l}for(let t=0;t<e;t++)for(let r=0;r<i;r++){let o=0;for(let l=-s;l<=s;l++)o+=a[Math.min(Math.max(r+l,0),i-1)*e+t]*n[l+s];l[r*e+t]=Math.max(0,Math.min(1,o))}return l}(s,e[0],e[1],i);(function(t,e,i,r,s=1){let n=Array(t.length).fill(0);for(let[t,a]of e)if(n[t*i+a]=1,s>1){for(let e=1-s;e<=s-1;e++)for(let l=1-s;l<=s-1;l++)if(Math.sqrt(e*e+l*l)<s){let s=t+e,o=a+l;s>=0&&s<r&&o>=0&&o<i&&(n[s*i+o]=1)}}return n})(s,f,e[0],e[1],Math.ceil(i/2)).forEach((t,e)=>{1===t&&(s[e]=r[e])})}return Object.assign(t,{segmentation:k,shapeBounds:g,shapeMaxR:b,shapeRatio:x,shapeCenter:[_,v],shapeArea:S})}(k);if(!A.segmentation.regions.length)return;let M=this.options,w=this.data,T=M.colorMode||"ordinal",C={getText:x5(M.text),getFontSize:x5(M.fontSize),fontSizeRange:M.fontSizeRange,colorMode:T,getColor:M.colorField?x5(M.colorField):x5(M.text),getFillingColor:x5(M.fillingColorField),colorList:M.colorList||("ordinal"===T?["#2E62F1"]:["#537EF5","#2E62F1","#2358D8","#184FBF","#0C45A6","#013B8E"]),getColorHex:x5(M.colorHexField),getFontFamily:x5(M.fontFamily||"sans-serif"),rotateList:M.rotateList||[0],getPadding:x5(M.padding||1),getFontStyle:x5(M.fontStyle||"normal"),getFontWeight:x5(M.fontWeight||"normal"),getFontOpacity:M.fontOpacity?x5(M.fontOpacity):()=>1};x8(w,C,A);let E={size:M.size,ratio:M.ratio||.8,shapeUrl:M.shape,random:void 0===M.random||M.random,textLayoutTimes:null!=(t=M.textLayoutTimes)?t:3,removeWhiteBorder:M.removeWhiteBorder,layoutMode:null!=(e=M.layoutMode)?e:"default",fontSizeShrinkFactor:null!=(i=M.fontSizeShrinkFactor)?i:.8,stepFactor:null!=(r=M.stepFactor)?r:1,importantWordCount:null!=(s=M.importantWordCount)?s:10,globalShinkLimit:M.globalShinkLimit||.2,fontSizeEnlargeFactor:null!=(n=M.fontSizeEnlargeFactor)?n:1.5,fillingRatio:null!=(a=M.fillingRatio)?a:.7,fillingTimes:null!=(l=M.fillingTimes)?l:4,fillingXStep:M.fillingXRatioStep?Math.max(Math.floor(M.size[0]*M.fillingXRatioStep),1):null!=(o=M.fillingXStep)?o:4,fillingYStep:M.fillingYRatioStep?Math.max(Math.floor(M.size[1]*M.fillingYRatioStep),1):null!=(h=M.fillingYStep)?h:4,fillingInitialFontSize:M.fillingInitialFontSize,fillingDeltaFontSize:M.fillingDeltaFontSize,fillingInitialOpacity:null!=(u=M.fillingInitialOpacity)?u:.8,fillingDeltaOpacity:null!=(d=M.fillingDeltaOpacity)?d:.05,getFillingFontFamily:x5(M.fillingFontFamily||"sans-serif"),getFillingFontStyle:x5(M.fillingFontStyle||"normal"),getFillingFontWeight:x5(M.fillingFontWeight||"normal"),getFillingPadding:x5(null!=(c=M.fillingPadding)?c:.4),fillingRotateList:null!=(p=M.fillingRotateList)?p:[0,90],fillingDeltaFontSizeFactor:null!=(g=M.fillingDeltaFontSizeFactor)?g:.2,fillingColorList:M.fillingColorList||["#537EF5"],sameColorList:!1,minInitFontSize:null!=(f=M.minInitFontSize)?f:10,minFontSize:null!=(m=M.minFontSize)?m:4,minFillFontSize:null!=(y=M.minFillFontSize)?y:2},B=xU(C.colorList,E.fillingColorList);E.sameColorList=B,x9(w,C,E,M),function(t,e,i,r){let{getText:s}=e,{fillingInitialFontSize:n,fillingDeltaFontSize:a}=i,{fillingRatio:l}=i,o=Math.ceil(Math.sqrt(r.shapeArea)/4);if(!n||!a){let e,h=t.reduce((t,e)=>{let i=xZ(s(e));return i>o?t:t+i},0)/t.length;n=~~(e=0===h?8:Math.sqrt(.2*r.shapeArea/h*(l/100))),a=e*i.fillingDeltaFontSizeFactor,Object.assign(i,{fillingInitialFontSize:n,fillingDeltaFontSize:a})}}(w,C,E,A);let{getText:P,getFontFamily:O,getFontStyle:I,getFontWeight:R,getPadding:L,getColor:D,getFillingColor:F,getColorHex:z,fontSizeScale:j,colorScale:H,fillingColorScale:N,getFontOpacity:V,rotateList:W}=C,U=w.map(t=>{var e,i;return{x:0,y:0,weight:0,text:P(t),fontFamily:O(t),fontWeight:R(t),fontStyle:I(t),rotate:W[~~(k.randomGenerator()*W.length)],fontSize:Math.max(E.minInitFontSize,~~j(t)),opacity:V(t),padding:L(t),color:z&&z(t)||H&&H(D(t))||"black",fillingColor:!F||(null==(e=M.colorField)?void 0:e.field)===(null==(i=M.fillingColorField)?void 0:i.field)&&B?void 0:z&&z(t)||N&&N(F(t))||"black",datum:t,visible:!0,hasPlaced:!1}}),G=eu(U.map(t=>t.fontSize));U.forEach(t=>t.weight=t.fontSize/G),U.sort((t,e)=>e.weight-t.weight);let{fillingWords:Z,successedWords:$,failedWords:Y}=function(t,e,i){(function(t,e){let{segmentation:{regions:i}}=e,r=-1/0,s=0,n=0;i.forEach((t,e)=>{let i=t.area;i>r&&(r=i,n=e),s+=i});let a=0;i.forEach(e=>{let i=e.area,n=Math.ceil(i/s*t.length),l=i/r;e.words=[],e.regionNum=n,e.regionWeight=l,a+=n}),a<t.length&&(i[n].wordsNum+=t.length-a);let l=n,o=i.map(t=>t.regionNum);t.forEach(t=>{let e=0,r=0;t.regionIndex=-1;do{if(o[l]>0&&t.weight<=i[l].regionWeight){t.regionIndex=l,i[l].words.push(t),o[l]--,l=(l+1)%i.length;break}l=(l+1)%i.length,e++,++r>i.length+1&&(i.forEach(t=>{t.regionWeight+=.15}),r=0)}while(-1===t.regionIndex&&e<3*i.length);-1===t.regionIndex&&(t.regionIndex=n,i[n].words.push(t),o[n]--)}),i.forEach(t=>{t.words.sort((t,e)=>e.weight-t.weight)})})(t,i),"ensureMapping"===e.layoutMode?x$(t,e,i):"ensureMappingEnlarge"===e.layoutMode?function(t,e,i){let{size:r,stepFactor:s,importantWordCount:n}=e,{segmentation:{regions:a},tempCanvas:l,boardSize:o,shapeCenter:h,shapeMaxR:u,shapeRatio:d}=i,c=l.getContext("2d",{willReadFrequently:!0}),p=xQ(i),g=p.slice(0),f=e.fontSizeEnlargeFactor,m=Math.min(n,t.length),y=0;t.length>m&&(y=t.sort((t,e)=>e.weight-t.weight)[m-1].weight);let _=0,v=1,b=!1;for(let n=0;n<a.length;n++){let{words:h,center:u,maxR:d,ratio:x}=a[n],S=!1;for(let n=0;n<h.length;n++){xq(l,c,t,n);let a=h[n];if(a.x=u[0],a.y=u[1],a.hasText&&a.sprite&&xY(g,a,d,x,r,o,s)){if(a.hasPlaced=!0,a.weight>=y&&_++,_>=m&&!b){v*=f,t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*f}),g=p.slice(0),S=!0,_=0;break}}else{if(a.weight>=y&&v>1){t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/f}),v/=f,b=!0,g=p.slice(0),S=!0;break}if(a.weight>=y)return x$(t,e,i)}}S&&(n=-1)}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];xq(l,c,i,t),e.x=h[0],e.y=h[1],e.hasText&&xY(g,e,u,d,r,o,s)&&(e.hasPlaced=!0)}}e.board=g}(t,e,i):function(t,e,i){let{size:r,stepFactor:s}=e,{segmentation:{regions:n},tempCanvas:a,boardSize:l,shapeCenter:o,shapeMaxR:h,shapeRatio:u}=i,d=xQ(i),c=a.getContext("2d",{willReadFrequently:!0});for(let e of n){let{words:i,center:n,maxR:o,ratio:h}=e;for(let e=0;e<i.length;e++){xq(a,c,t,e);let u=i[e];u.x=n[0],u.y=n[1],u.hasText&&u.sprite&&xY(d,u,o,h,r,l,s)&&(u.hasPlaced=!0)}}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];xq(a,c,i,t),e.x=o[0],e.y=o[1],e.hasText&&xY(d,e,h,u,r,l,s)&&(e.hasPlaced=!0)}}e.board=d}(t,e,i);let r=function(t,e,i){let{size:r,fillingTimes:s,fillingXStep:n,fillingYStep:a,getFillingFontStyle:l,getFillingFontWeight:o,getFillingFontFamily:h,fillingInitialFontSize:u,fillingDeltaFontSize:d,fillingInitialOpacity:c,fillingDeltaOpacity:p,fillingRotateList:g,getFillingPadding:f,random:m,board:y,minFillFontSize:_}=e,{boardSize:v,shapeBounds:b,tempCanvas:x,randomGenerator:S}=i,k=x.getContext("2d",{willReadFrequently:!0}),A=u,M=c,w=[];for(let e=0;e<s;e++)(function(e,i){let s=t.map(t=>{let{text:r,color:s,fillingColor:n,hasPlaced:a,datum:u}=t;return{x:0,y:0,weight:0,text:r,fontFamily:h(u),fontStyle:l(u),fontWeight:o(u),fontSize:e,rotate:g[~~(S()*g.length)],padding:f(u),opacity:i,visible:!0,color:s,fillingColor:n,hasPlaced:a,datum:u}});T(s);let u=0,{x1:d,y1:c,x2:p,y2:_}=b,[A,M]=[d+~~(S()*n*2),c+~~(S()*a*2)];for(let t=M;t<=_;t+=a)for(let e=A;e<=p;e+=n){xq(x,k,s,u);let i=s[u];i.x=e,i.y=t;let{wordSize:n,bounds:a,hasPlaced:l}=i;if(!l||!a){++u===s.length&&(u=0,m&&T(s));continue}let{dTop:o,dBottom:h,dLeft:d,dRight:c}=a;i.x-d<0||i.x+c>r[0]||i.y-o<0||i.y+h>r[1]||i.hasText&&i.sprite&&!xK(i,y,v)&&(xX(i,y,v),w.push(Object.assign({},i)),++u===s.length&&(u=0,m&&T(s)))}})(A,M),A=Math.max(A>d?A-d:d,_),M=M>p?M-p:p;return w;function T(t){return t.sort(()=>S()-.5)}}(t,e,i),s=[],n=[];for(let e=0;e<t.length;e++)t[e].hasPlaced?n.push(t[e]):s.push(t[e]);return s.forEach(t=>t.visible=!1),{fillingWords:r,successedWords:n,failedWords:s}}(U,E,A),X=null!=(v=null==(_=M.text)?void 0:_.field)?v:"textKey",K=null!=(b=M.dataIndexKey)?b:"defaultDataIndexKey",q=M.as?Object.assign(Object.assign({},x7),M.as):x7,Q=[];for(let t=0;t<U.length;++t)(S=(x=U[t]).datum)[q.x]=x.x,S[q.y]=x.y,S[q.fontFamily]=x.fontFamily,S[q.fontSize]=x.fontSize,S[q.fontStyle]=x.fontStyle,S[q.fontWeight]=x.fontWeight,S[q.angle]=lu(x.rotate),S[q.opacity]=x.opacity,S[q.visible]=x.visible,S[q.isFillingWord]=!1,S[q.color]=x.color,S[K]=`${x.text}_${t}_keyword`,Q.push(S);let J=[];Z.forEach((t,e)=>{var i,r;let s=Object.assign({},t.datum);s[q.x]=t.x,s[q.y]=t.y,s[q.fontFamily]=t.fontFamily,s[q.fontSize]=t.fontSize,s[q.fontStyle]=t.fontStyle,s[q.fontWeight]=t.fontWeight,s[q.angle]=lu(t.rotate),s[q.opacity]=t.opacity,s[q.visible]=t.visible,s[q.isFillingWord]=!0,s[q.color]=F?(null==(i=M.colorField)?void 0:i.field)===(null==(r=M.fillingColorField)?void 0:r.field)&&B?t.color:t.fillingColor:E.fillingColorList[~~(k.randomGenerator()*E.fillingColorList.length)],s[X]=t.text,s[K]=`${t.text}_${e}_fillingWords`,J.push(s)}),this.options.onLayoutFinished&&this.options.onLayoutFinished({successedWords:$,failedWords:Y}),this.progressiveResult=Q.concat(J)}release(){this.segmentationInput=null,this.data=null,this.progressiveResult=null,this.options=null}}let x9=(t,e,i,r)=>{var s,n,a,l;let{colorMode:o,getColor:h,getFillingColor:u}=e,{sameColorList:d}=i,c,p,g=e.colorList,f=i.fillingColorList;if("ordinal"===o){let e=t.map(t=>h(t));if(c=t=>(new a4).domain(e).range(g).scale(t),u&&((null==(s=r.colorField)?void 0:s.field)!==(null==(n=r.fillingColorField)?void 0:n.field)||!d)){let e=t.map(t=>u(t));p=t=>(new a4).domain(e).range(f).scale(t)}}else{1===g.length&&(g=[g[0],g[0]]);let e=(new a2).domain(Se(h,t)).range(g);if(c=t=>e.scale(t),u&&((null==(a=r.colorField)?void 0:a.field)!==(null==(l=r.fillingColorField)?void 0:l.field)||!d)){1===f.length&&(f=[f[0],f[0]]);let e=(new a2).domain(Se(u,t)).range(f);p=t=>e.scale(t)}}Object.assign(e,{colorScale:c,fillingColorScale:p})},x8=(t,e,i)=>{let r,{fontSizeRange:s}=e,{getFontSize:n,getText:a}=e;if(n){if(n&&s){let e=(new x4).domain(Se(n,t)).range(s);r=t=>e.scale(n(t))}else if(n&&tK(n)&&!s){let[e,l]=Se(n,t),o=St(t.map(t=>({text:a(t),value:n(t),weight:l===e?1:(n(t)-e)/(l-e)})),i,!0);s=[~~(.5*o),~~o];let h=(new x4).domain(Se(n,t)).range(s);r=t=>h.scale(n(t))}}else{var l;r="function"==typeof(l=St(t.map(t=>({text:a(t)})),i,!1))?l:function(){return l}}Object.assign(e,{getFontSize:n,fontSizeRange:s,fontSizeScale:r})},St=(t,e,i)=>{let r=e.shapeArea,s=e.ratio,n=e.segmentation.regions,a=Math.ceil(Math.sqrt(r)/12),l=t.reduce((t,e)=>{let r=xZ(e.text);return r<a?t+r*(i?(.5+.5*e.weight)**2:1):t},0);if(0===l)return 12;let o=20;if(1===n.length)o=Math.sqrt(r/(1.7*l)*s);else{let t=[];for(let e=0;e<n.length;e++){let i=n[e].area,a=n[e].ratio,o=i/r;if(o<.1)continue;let h=Math.sqrt(i/(l*(a<1?2.7-a:1.7)*o)*s);t.push(h)}o=t.length?Math.min(...t):Math.sqrt(r/(1.7*l)*s)}return o},Se=(t,e)=>{let i,r=1/0,s=-1/0,n=e.length;for(let a=0;a<n;++a)(i=aJ(t(e[a])))<r&&(r=i),i>s&&(s=i);return 1===e.length&&r===s&&(r-=1e4),[r,s]},Si=(t,e,i)=>{if(!t.size||et(t.size[0])||et(t.size[1])||t.size[0]<=0||t.size[1]<=0)return tW.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(t.size=[Math.ceil(t.size[0]),Math.ceil(t.size[1])],t.shape||tW.getInstance().error("WordcloudShape shape must be specified."),t.text||tW.getInstance().error("WordcloudShape text must be specified."),t.onBeforeLayout&&t.onBeforeLayout(),!e||0===e.length)return[];let r=new x6(t);return r.layout(e),r.unfinished()?{progressive:r}:r.output()};class Sr extends xc{constructor(){super(...arguments),this.type=rw.wordCloud}}Sr.type=rw.wordCloud;let Ss=()=>{ig.registerGrammarTransform("wordcloud",{transform:xj}),bk(),xg(),ig.registerSeries(Sr.type,Sr)},Sn=()=>{ig.registerGrammarTransform("wordcloudShape",{transform:Si}),ig.registerGrammarTransform("wordcloud",{transform:xj}),bk(),xg(),ig.registerSeries(Sr.type,Sr)};class Sa extends xi{constructor(){super(...arguments),this.transformerConstructor=xe,this.type="wordCloud",this.seriesType=rw.wordCloud}}Sa.type="wordCloud",Sa.seriesType=rw.wordCloud,Sa.transformerConstructor=xe;let Sl=()=>{mg(),Ss(),ig.registerChart(Sa.type,Sa)},So=()=>{Sn(),mg(),Ss(),ig.registerChart(Sa.type,Sa)},Sh=(t,e)=>{var i,r;let s=t.map(t=>Object.assign({},t));if(!s||0===s.length)return s;let{valueField:n,asTransformRatio:a,asReachRatio:l,asHeightRatio:o,asValueRatio:h,asNextValueRatio:u,asLastValueRatio:d,asLastValue:c,asCurrentValue:p,asNextValue:g,heightVisual:f=!1,isCone:m=!0,range:y}=e,_=s.reduce((t,e)=>Math.max(t,Number.parseFloat(e[n])||-1/0),-1/0),v=s.reduce((t,e)=>Math.min(t,Number.parseFloat(e[n])||1/0),1/0),b=[null!=(i=null==y?void 0:y.min)?i:v,null!=(r=null==y?void 0:y.max)?r:_];return s.forEach((t,e)=>{var i,r;let y=Number.parseFloat(t[n]),_=Number.parseFloat(null==(i=s[e-1])?void 0:i[n]),v=Number.parseFloat(null==(r=s[e+1])?void 0:r[n]),x=ee(v*y)&&0!==y?v/y:0,S=ee(y*_)&&0!==_?y/_:0;c&&(t[c]=_),g&&(t[g]=v),a&&(t[a]=x),l&&(t[l]=0===e?1:S),o&&(t[o]=!0===f?x:1/s.length),h&&(t[h]=y/b[1]),u&&(t[u]=e===s.length-1?m?0:t[h]:v/b[1]),d&&(t[d]=0===e?1:_/b[1]),p&&(t[p]=y)}),s},Su=(t,e)=>{var i,r;let s=null==(r=null==(i=t[0])?void 0:i.latestData)?void 0:r.map(t=>Object.assign({},t));return s&&0!==s.length&&(s.shift(),s.forEach(t=>{t[e.asIsTransformLevel]=!0})),s},Sd=`${s6}_FUNNEL_TRANSFORM_RATIO`,Sc=`${s6}_FUNNEL_REACH_RATIO`,Sp=`${s6}_FUNNEL_HEIGHT_RATIO`,Sg=`${s6}_FUNNEL_VALUE_RATIO`,Sf=`${s6}_FUNNEL_LAST_VALUE_RATIO`,Sm=`${s6}_FUNNEL_NEXT_VALUE_RATIO`,Sy=`${s6}_FUNNEL_LAST_VALUE`,S_=`${s6}_FUNNEL_CURRENT_VALUE`,Sv=`${s6}_FUNNEL_NEXT_VALUE`,Sb=`${s6}_FUNNEL_TRANSFORM_LEVEL`;class Sx extends d8{constructor(t){var e,i;super(t),this.dimensionTooltipTitleCallback=(t,e)=>{var i,r,s;let n=this.series;return"transform"===(null==(i=null==e?void 0:e.mark)?void 0:i.name)?this._transformRatioText:null!=(r=this._getDimensionData(t))?r:null==(s=t.properties)?void 0:s[`${n.getCategoryField()}`]},this.markTooltipValueCallback=(t,e)=>{var i;return"transform"===(null==(i=null==e?void 0:e.mark)?void 0:i.name)?`${(100*(null==t?void 0:t[Sc])).toFixed(1)}%`:this._getMeasureData(t)},this.markTooltipKeyCallback=(t,e)=>{var i;if("transform"===(null==(i=null==e?void 0:e.mark)?void 0:i.name))return this._transformRatioText;let{dimensionFields:r,seriesFields:s}=this._seriesCacheInfo,n=r[r.length-1];return t5(s[0])?null==t?void 0:t[s[0]]:null==t?void 0:t[n]},this._transformRatioText=null!=(i=null==(e=t.getSpec())?void 0:e.transformRatioText)?i:"转化率"}}class SS extends oa{_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{points:[]})}}var Sk=i(89705),SA=i(50730);class SM extends SS{constructor(){super(...arguments),this.type=SM.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}}SM.type="polygon";let Sw=()=>{ig.registerMark(SM.type,SM),(0,ol.W)(),(0,Sk.M)(),u9(),ig.registerGraphicComponent("polygon",SA.p)},ST=Object.assign(Object.assign({},cd),{funnel:{name:"funnel",type:"polygon"},transform:{name:"transform",type:"polygon"},transformLabel:{name:"transformLabel",type:"text"},outerLabel:{name:"outerLabel",type:"text"},outerLabelLine:{name:"outerLabelLine",type:"rule"}});class SC extends cw{_transformLabelSpec(t){this._addMarkLabelSpec(t,"funnel"),t.isTransform&&this._addMarkLabelSpec(t,"transform","transformLabel")}}class SE extends cT{constructor(){super(...arguments),this.type=rw.funnel,this._funnelMarkName="funnel",this._funnelMarkType="polygon",this._transformMarkName="transform",this._transformMarkType="polygon",this.transformerConstructor=SC,this._funnelMark=null,this._funnelTransformMark=null,this._labelMark=null,this._transformLabelMark=null,this._funnelOuterLabelMark={}}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t,e,i,r,s;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this._funnelOrient=null!=(t=this._spec.funnelOrient)?t:"top",this._shape=null!=(e=this._spec.shape)?e:"trapezoid",this._minLabelLineWidth=null!=(s=null==(r=null==(i=this._spec.outerLabel)?void 0:i.line)?void 0:r.minLength)?s:20,this._isHorizontal()?this._funnelAlign=["top","bottom"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center":this._funnelAlign=["left","right"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center",!this._seriesField&&this._spec.categoryField&&this.setSeriesField(this._spec.categoryField)}initData(){if(super.initData(),!this._data)return;sY(this._dataSet,"funnel",Sh),sY(this._dataSet,"funnelTransform",Su);let t=new er(this._dataSet,{name:`${s6}_series_${this.id}_viewDataTransform`});t.parse([this.getViewData()],{type:"dataview"}),this._viewDataTransform=new ly(this._option,t)}compile(){var t,e;super.compile(),this._funnelOuterLabelMark&&(null==(t=this._funnelOuterLabelMark.label)||t.compile({group:this._rootMark.getProduct()}),null==(e=this._funnelOuterLabelMark.line)||e.compile({group:this._rootMark.getProduct()}))}compileData(){var t;super.compileData(),null==(t=this._viewDataTransform)||t.compile()}getStatisticFields(){let t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}_statisticViewData(){var t,e,i,r,s,n,a,l,o;super._statisticViewData(),this._data.getDataView().transform({type:"funnel",options:{valueField:this.getValueField(),isCone:this._spec.isCone,asCurrentValue:S_,asTransformRatio:Sd,asReachRatio:Sc,asHeightRatio:Sp,asValueRatio:Sg,asNextValueRatio:Sm,asLastValueRatio:Sf,asLastValue:Sy,asNextValue:Sv,range:{min:null!=(e=null==(t=this._spec.range)?void 0:t.min)?e:null==(r=null==(i=this.getViewDataStatistics().latestData)?void 0:i[this.getValueField()])?void 0:r.min,max:null!=(n=null==(s=this._spec.range)?void 0:s.max)?n:null==(l=null==(a=this.getViewDataStatistics().latestData)?void 0:a[this.getValueField()])?void 0:l.max}}}),null==(o=this._viewDataTransform.getDataView())||o.transform({type:"funnelTransform",options:{asIsTransformLevel:Sb}})}initMark(){var t,e,i,r,s,n,a,l;if(this._funnelMark=this._createMark(Object.assign(Object.assign({},SE.mark.funnel),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null==(t=this._theme)?void 0:t.funnel,groupKey:this._seriesField,isSeriesMark:!0,noSeparateStyle:!0},{morph:ck(this._spec,this._funnelMarkName),morphElementKey:this._seriesField}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(Object.assign(Object.assign({},SE.mark.transform),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null==(e=this._theme)?void 0:e.transform,noSeparateStyle:!0}),this._funnelTransformMark&&this._funnelTransformMark.setData(this._viewDataTransform)),null==(r=null==(i=this._spec)?void 0:i.outerLabel)?void 0:r.visible){let{line:t}=null!=(s=this._spec.outerLabel)?s:{},{line:e}=null!=(a=null==(n=this._theme)?void 0:n.outerLabel)?a:{};this._funnelOuterLabelMark.label=this._createMark(SE.mark.outerLabel,{themeSpec:null==(l=this._theme)?void 0:l.outerLabel,markSpec:this._spec.outerLabel,noSeparateStyle:!0,parent:!1}),this._funnelOuterLabelMark.line=this._createMark(SE.mark.outerLabelLine,{themeSpec:e,markSpec:t,noSeparateStyle:!0,parent:!1})}}initTooltip(){this._tooltipHelper=new Sx(this),this._funnelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelMark),this._funnelTransformMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelTransformMark)}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return[this._valueField]}getGroupFields(){return null}initMarkStyle(){var t,e,i,r;let s=this._funnelMark;s&&this.setMarkStyle(s,{points:t=>this.getPoints(t),visible:t=>t5(t[this._valueField]),fill:this.getColorAttribute()},"normal",H.Series);let n=this._funnelTransformMark;n&&this.setMarkStyle(n,{points:t=>this.getPoints(t)},"normal",H.Series);let a=this._funnelOuterLabelMark.label;a&&(this.setMarkStyle(a,{text:t=>`${t[this.getCategoryField()]}`,x:t=>this._computeOuterLabelPosition(t).x,y:t=>this._computeOuterLabelPosition(t).y,textAlign:t=>this._computeOuterLabelPosition(t).align,textBaseline:t=>this._computeOuterLabelPosition(t).textBaseline,maxLineWidth:t=>this._computeOuterLabelLimit(t),width:0,height:0},"normal",H.Series),tK(this._spec.outerLabel.formatMethod)&&this.setMarkStyle(a,{text:t=>this._spec.outerLabel.formatMethod(`${t[this.getCategoryField()]}`,t)},"normal",H.User_Mark));let l=this._funnelOuterLabelMark.line;if(l&&a){this.setMarkStyle(l,{x:t=>this._computeOuterLabelLinePosition(t).x1,y:t=>this._computeOuterLabelLinePosition(t).y1,x1:t=>this._computeOuterLabelLinePosition(t).x2,y1:t=>this._computeOuterLabelLinePosition(t).y2},"normal",H.Series);let s=null!=(i=null==(e=null==(t=this._spec.outerLabel)?void 0:t.line)?void 0:e.visible)?i:null==(r=this._spec.outerLabel)?void 0:r.visible;t5(s)&&l.setVisible(s)}}initLabelMarkStyle(t){var e;if(!t)return;let i=t.getTarget(),r=t.getComponent();if(i===this._funnelMark){this._labelMark=t,this.setMarkStyle(t,{text:t=>`${t[this.getCategoryField()]} ${t[this.getValueField()]}`,x:t=>this._computeLabelPosition(t).x,y:t=>this._computeLabelPosition(t).y,maxLineWidth:t=>this._computeLabelLimit(t,this._spec.label),stroke:this.getColorAttribute()},"normal",H.Series);let i=this.getCompiler().getRootMarks();this._funnelOuterLabelMark.label&&fe(i,this._funnelOuterLabelMark.label,r),this._funnelOuterLabelMark.line&&fe(i,this._funnelOuterLabelMark.line,null!=(e=this._funnelOuterLabelMark.label)?e:r)}else this._funnelTransformMark&&i===this._funnelTransformMark&&(this._transformLabelMark=t,this.setMarkStyle(t,{text:t=>`${(100*en(Sc).bind(this)(t)).toFixed(1)}%`,x:t=>this._computeLabelPosition(t).x,y:t=>this._computeLabelPosition(t).y,maxLineWidth:t=>this._computeLabelLimit(t,this._spec.transformLabel)},"normal",H.Series))}initAnimation(){var t,e,i,r,s,n,a;let l=null!=(i=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset)?i:"clipIn";"clipIn"===l&&this._rootMark&&this._rootMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("cartesianGroupClip"))?void 0:r({direction:()=>this._isHorizontal()?"x":"y",width:()=>{let t=this.getRootMark().getProduct();if(t){let{x1:e,x2:i}=t.AABBBounds;return Math.max(e,i)}return this.getLayoutRect().width},height:()=>{let t=this.getRootMark().getProduct();if(t){let{y1:e,y2:i}=t.AABBBounds;return Math.max(e,i)}return this.getLayoutRect().height},orient:()=>this._isReverse()?"negative":"positive"},l),cb("group",this._spec,this._markAttributeContext))),[null==(s=this._funnelOuterLabelMark)?void 0:s.label].forEach(t=>{t&&t.setAnimationConfig(cv(ig.getAnimationInKey("fadeInOut")(),cb(t.name,this._spec,this._markAttributeContext)))}),[this._funnelMark,this._funnelTransformMark].forEach(t=>{t&&t.setAnimationConfig(cv(ig.getAnimationInKey("funnel")({},l),cb(t.name,this._spec,this._markAttributeContext)))}),(null==(n=this._funnelOuterLabelMark)?void 0:n.line)&&this._funnelOuterLabelMark.line.setAnimationConfig(cv(null==(a=ig.getAnimationInKey("fadeInOut"))?void 0:a(),cb("outerLabelLine",this._spec,this._markAttributeContext)))}initGroups(){}getStackGroupFields(){return[]}getStackValueField(){return null}initEvent(){var t;super.initEvent(),null==(t=this._viewDataTransform.getDataView())||t.target.addListener("change",t=>{this._viewDataTransform.updateData()})}getPoints(t){let e,i,r=this.isTransformLevel(t),s=this._getMainAxisLength(r)/2;r?(e="rect"===this._shape?this._getSecondaryAxisLength(t[Sf])/2:this._getSecondaryAxisLength(t[Sg])/2,i=this._getSecondaryAxisLength(t[Sg])/2):(e=this._getSecondaryAxisLength(t[Sg])/2,i="rect"===this._shape?e:this._getSecondaryAxisLength(t[Sm])/2);let{x:n,y:a}=this._getPositionByData(t),l=this._getPolygonPoints([n,a],e,i,e,i,s);return"center"!==this._funnelAlign&&this._adjustPoints(l),l}isTransformLevel(t){return!!(null==t?void 0:t[Sb])}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getPoints=this.getPoints.bind(this),this._markAttributeContext.isTransformLevel=this.isTransformLevel.bind(this)}valueToPosition(t){var e,i,r;let s=null==(r=null==(i=null==(e=this.getViewData())?void 0:e.latestData)?void 0:i.find)?void 0:r.call(i,e=>e[this._categoryField]===t);return t5(s)?this._getPolygonCenter(this.getPoints(s)):null}dataToPosition(t,e){return e&&!this.isDatumInViewData(t)?null:this.valueToPosition(t[this._categoryField])}dataToPositionX(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.x}dataToPositionY(t){var e;return null==(e=this.dataToPosition(t))?void 0:e.y}dataToPositionZ(t){return 0}_getMainAxisLength(t=!1){var e;let i=this.getViewData().latestData.length,r=this._isHorizontal()?this.getLayoutRect().width:this.getLayoutRect().height,s=!!this._spec.isTransform,n=s?0:null!=(e=this._spec.gap)?e:0,a=s?Math.max(0,i-1):0,l=this._spec.heightRatio||.5,o=(r-n*Math.max(0,i-1))/(i+l*a);return t?s?o*l:0:o}_getSecondaryAxisLength(t){let e=Number.isNaN(t)||!Number.isFinite(t)?0:t,i=this._computeMaxSize(),r=this._computeMinSize();return r+(i-r)*e}_getPositionByData(t){var e;let i=null==(e=this.getViewData().latestData)?void 0:e.findIndex(e=>e[this._categoryField]===t[this._categoryField]&&e[ni]===t[ni]);if(!t5(i)||i<0)return{};let r=this.isTransformLevel(t),s=this._isHorizontal(),n=s?this.getLayoutRect().height:this.getLayoutRect().width,a=s?this.getLayoutRect().width:this.getLayoutRect().height,l=n/2,o=0,h=this._getMainAxisLength(),u=this._getMainAxisLength(!0);return o+=i*(h+u)+(r?-u/2:h/2),!this._spec.isTransform&&this._spec.gap&&(o+=this._spec.gap*i),this._isReverse()&&(o=a-o),this._isHorizontal()?{x:o,y:l}:{x:l,y:o}}_getPolygonPoints(t,e,i,r,s,n){let a=t[0],l=t[1];switch(this._funnelOrient){case"left":return[{x:a-n,y:l+e},{x:a-n,y:l-r},{x:a+n,y:l-s},{x:a+n,y:l+i}];case"right":return[{x:a+n,y:l-r},{x:a+n,y:l+r},{x:a-n,y:l+i},{x:a-n,y:l-i}];case"bottom":return[{x:a+e,y:l+n},{x:a-r,y:l+n},{x:a-s,y:l-n},{x:a+i,y:l-n}];default:return[{x:a-e,y:l-n},{x:a+r,y:l-n},{x:a+s,y:l+n},{x:a-i,y:l+n}]}}_getPolygonCenter(t){if(this._isHorizontal()){let e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}let e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}_adjustPoints(t){let e,i,r;return this._isHorizontal()?(r="y","left"===this._funnelOrient?(e="bottom"===this._funnelAlign?-t[1].y:t[1].y,i="bottom"===this._funnelAlign?-t[2].y:t[2].y):(e="bottom"===this._funnelAlign?-t[0].y:t[0].y,i="bottom"===this._funnelAlign?-t[3].y:t[3].y)):(r="x","top"===this._funnelOrient?(e="left"===this._funnelAlign?t[0].x:-t[0].x,i="left"===this._funnelAlign?t[3].x:-t[3].x):(e="left"===this._funnelAlign?t[1].x:-t[1].x,i="left"===this._funnelAlign?t[2].x:-t[2].x)),t[0][r]-=e,t[1][r]-=e,t[2][r]-=i,t[3][r]-=i,t}_computeLabelPosition(t){let e=this.getPoints(t);return this._getPolygonCenter(e)}_computeLabelLimit(t,e){let i=null==e?void 0:e.limit;if(tH(i))return i;let r=this.getPoints(t);return"shapeSize"===i?this._isHorizontal()?Math.abs(r[3].x-r[0].x):(Math.abs(r[0].x-r[1].x)+Math.abs(r[2].x-r[3].x))/2:this._isHorizontal()?Math.abs(r[3].x-r[0].x):void 0}_computeOuterLabelPosition(t){var e,i;let r,s,n=null==(e=this._spec.outerLabel)?void 0:e.position,a="center",l="middle";if(n=this._isHorizontal()?["top","bottom"].includes(n)?n:"bottom"===this._funnelAlign?"top":"bottom":["left","right"].includes(n)?n:"left"===this._funnelAlign?"right":"left",!1!==(null==(i=this._spec.outerLabel)?void 0:i.alignLabel))({x:r,y:s}=this._getPositionByData(t)),"left"===n?(r=0,a="left"):"right"===n?(r=this.getLayoutRect().width,a="right"):"top"===n?(s=0,l="top"):"bottom"===n&&(s=this.getLayoutRect().height,l="bottom");else{let{x2:e,y2:i}=this._computeOuterLabelLinePosition(t);r=e,s=i,"left"===n?(r-=5,a="right"):"right"===n?(r+=5,a="left"):"top"===n?(s-=5,l="bottom"):"bottom"===n&&(s+=5,l="top")}return{x:r,y:s,align:a,textBaseline:l}}_computeOuterLabelLimit(t){var e,i,r,s,n,a;if(this._isHorizontal())return this._getMainAxisLength(this.isTransformLevel(t));let l=this.getPoints(t),o=(Math.abs(l[0].x-l[1].x)+Math.abs(l[2].x-l[3].x))/2,h=this.getCategoryField(),u=null==(s=null==(r=null==(i=null==(e=this._labelMark)?void 0:e.getComponent())?void 0:i.getComponent())?void 0:r.find(({attribute:e,type:i})=>{var r;return"text"===i&&(null==(r=e.data)?void 0:r[h])===t[h]},!0))?void 0:s.AABBBounds,d=u?u.x2-u.x1:0,c=this._funnelOuterLabelMark.line?this._minLabelLineWidth:0,p=this.getLayoutRect().width-Math.max(o,d);return"center"===this._funnelAlign&&(p/=2),p-c-(null!=(a=null==(n=this._spec.outerLabel)?void 0:n.spaceWidth)?a:5)}_computeOuterLabelLinePosition(t){var e,i,r,s,n,a,l,o,h,u;let d,c,p,g,f=this.getCategoryField(),m=null==(s=null==(r=null==(i=null==(e=this._funnelOuterLabelMark)?void 0:e.label)?void 0:i.getGraphics())?void 0:r.find(e=>{var i;return(null==(i=e.context.data[0])?void 0:i[f])===t[f]}))?void 0:s.AABBBounds,y=null==(a=null==(n=this._labelMark)?void 0:n.getComponent())?void 0:a.getComponent(),_=null==(l=null==y?void 0:y.find(({attribute:e,type:i})=>{var r;return"text"===i&&(null==(r=e.data)?void 0:r[f])===t[f]},!0))?void 0:l.AABBBounds,v=null!=(o=this._spec.outerLabel)?o:{};if(this._isHorizontal()){let e=null!=(h=v.spaceWidth)?h:5,i=this.getPoints(t),r=(Math.abs(i[0].y-i[1].y)+Math.abs(i[2].y-i[3].y))/2;return"top"===this._spec.outerLabel.position||"bottom"===this._funnelAlign?(p=this._getPolygonCenter(i).y-r/2-e,g=!1!==v.alignLabel?(null==m?void 0:m.y2)+e:p-e,d=this._getPolygonCenter(i).x,p-g<this._minLabelLineWidth&&(g=p-this._minLabelLineWidth)):(p=this._getPolygonCenter(i).y+r/2+e,g=!1!==v.alignLabel?(null==m?void 0:m.y1)-e:p+e,d=this._getPolygonCenter(i).x,g-p<this._minLabelLineWidth&&(g=p+this._minLabelLineWidth)),c=d,{x1:d,x2:c,y1:p,y2:g}}let b=this.getPoints(t),x=(Math.abs(b[0].x-b[1].x)+Math.abs(b[2].x-b[3].x))/2,S=(null==_?void 0:_.x2)-(null==_?void 0:_.x1)||0,k=null!=(u=v.spaceWidth)?u:5;return"right"===this._spec.outerLabel.position||"left"===this._funnelAlign?(d=this._getPolygonCenter(b).x+Math.max(S/2,x/2)+k,c=!1!==v.alignLabel?(null==m?void 0:m.x1)-k:d+k,p=this._getPolygonCenter(b).y,c-d<this._minLabelLineWidth&&(c=d+this._minLabelLineWidth)):(d=this._getPolygonCenter(b).x-Math.max(S/2,x/2)-k,c=!1!==v.alignLabel?(null==m?void 0:m.x2)+k:d-k,p=this._getPolygonCenter(b).y,d-c<this._minLabelLineWidth&&(c=d-this._minLabelLineWidth)),g=p,{x1:d,x2:c,y1:p,y2:g}}_computeMaxSize(){var t;let e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return ex(null!=(t=this._spec.maxSize)?t:"80%",e)}_computeMinSize(){var t;let e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return ex(null!=(t=this._spec.minSize)?t:0,e)}_isHorizontal(){return"left"===this._funnelOrient||"right"===this._funnelOrient}_isReverse(){return"bottom"===this._funnelOrient||"right"===this._funnelOrient}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._funnelMark]}}SE.type=rw.funnel,SE.mark=ST,SE.builtInTheme={funnel:iv},SE.transformerConstructor=SC;let SB=()=>{Sw(),bk(),bp(),ig.registerSeries(SE.type,SE),ig.registerAnimation("funnel",(t,e)=>Object.assign({appear:"clipIn"===e?void 0:{type:"fadeIn"}},uq)),u0(),uJ()};class SP extends fB{needAxes(){return!1}_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","funnelAlign","funnelOrient","heightRatio","shape","funnel","transform","outerLabel","transformLabel","isTransform","maxSize","minSize","gap","isCone","range","transformRatioText"])}transformSpec(t){super.transformSpec(t),super.transformSeriesSpec(t)}}class SO extends fF{constructor(){super(...arguments),this.transformerConstructor=SP,this.type="funnel",this.seriesType=rw.funnel}}SO.type="funnel",SO.seriesType=rw.funnel,SO.transformerConstructor=SP;let SI=()=>{mg(),SB(),ig.registerChart(SO.type,SO)};function SR(t){return()=>"vertical"===t.direction?{orient:"negative"}:{orient:"positive"}}let SL=t=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:SR(t)}),SD=t=>({type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:SR(t)}),SF={type:"fadeIn"};function Sz(t,e="grow"){return!1===e?{}:"fadeIn"===e?SF:SL(t)}let Sj=()=>{ig.registerAnimation("linearProgress",(t,e)=>({appear:Sz(t,e),enter:Sz(t),disappear:SD(t)}))};class SH extends d8{enableByType(t){return"dimension"!==t}}let SN=Object.assign(Object.assign({},cd),{track:{name:"track",type:"rect"},progress:{name:"progress",type:"rect"},group:{name:"group",type:"group"}});class SV extends cB{constructor(){super(...arguments),this.type=rw.linearProgress,this._progressMark=null,this._trackMark=null,this._defaultProgressCustomShape=(t,e,i)=>{var r,s;let n=null==(r=this._spec)?void 0:r.cornerRadius,a=t5(e.width)?e.width:e.x1-e.x,l=t5(e.height)?e.height:e.y1-e.y,o=Math.min(0,a),h=Math.max(0,a),u=Math.min(0,l),d=Math.max(0,l);if(n>0){let t=n;if("vertical"===(null==(s=this._spec)?void 0:s.direction)){if(2*(t=Math.min(Math.abs(a/2),n))>Math.abs(l)){let e=Math.acos((t-Math.abs(l)/2)/t);return i.moveTo(o+t,u),i.arc(o+t,u+t,t,1.5*Math.PI,1.5*Math.PI-e,!0),i.arc(o+t,d-t,t,e+Math.PI/2,Math.PI/2,!0),i.lineTo(h-n,d),i.arc(h-t,d-t,t,Math.PI/2,Math.PI/2-e,!0),i.arc(h-t,u+t,t,-Math.PI/2+e,-Math.PI/2,!0),i.lineTo(o+t,u),i.closePath(),i}}else if(2*(t=Math.min(Math.abs(l/2),n))>Math.abs(a)){let e=Math.acos((t-Math.abs(a)/2)/t);return i.moveTo(o,u+t),i.arc(o+t,u+t,t,Math.PI,Math.PI+e),i.arc(h-t,u+t,t,-e,0),i.lineTo(h,d-t),i.arc(h-t,d-t,t,0,e),i.arc(o+t,d-t,t,Math.PI-e,Math.PI),i.closePath(),i}i.moveTo(o,u+t),i.arc(o+t,u+t,t,Math.PI,1.5*Math.PI),i.lineTo(h-t,u),i.arc(h-t,u+t,t,-Math.PI/2,0),i.lineTo(h,d-t),i.arc(h-t,d-t,t,0,Math.PI/2),i.lineTo(o+t,d),i.arc(o+t,d-t,t,Math.PI/2,Math.PI),i.closePath()}else i.moveTo(o,u),i.lineTo(h,u),i.lineTo(h,d),i.lineTo(o,d),i.closePath();return i}}initMark(){this._initTrackMark(),this._initProgressMark()}initMarkStyle(){this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){var t;return this._progressMark=this._createMark(SV.mark.progress,{isSeriesMark:!0}),et(null==(t=this._spec.progress)?void 0:t.customShape)&&this._progressMark.setMarkConfig({setCustomizedShape:this._defaultProgressCustomShape}),this._progressMark}_initProgressMarkStyle(){var t,e,i,r;let s=this._progressMark;if(s)if("vertical"===this._spec.direction){let i=this._spec.progress||{},r=null!=(t=i.leftPadding)?t:0,n=null!=(e=i.rightPadding)?e:0;this.setMarkStyle(s,{x:t=>{var e,i;return lr(this.dataToPositionX(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0),!0)-this._spec.bandWidth/2+r},y1:t=>{var e,i;return lr(this.dataToPositionY(t),null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:()=>{var t,e,i;let r=null==(t=this._yAxisHelper)?void 0:t.dataToPosition([0],{bandPosition:this._bandPosition});return this._spec.clamp?lr(r,null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0)):r},width:this._spec.bandWidth-r-n,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",H.Series)}else{let t=this._spec.progress||{},e=null!=(i=t.topPadding)?i:0,n=null!=(r=t.bottomPadding)?r:0;this.setMarkStyle(s,{x1:t=>{var e,i;return lr(this.dataToPositionX(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0))},y:t=>{var i,r;return lr(this.dataToPositionY(t),null==(r=null==(i=this._yAxisHelper)?void 0:i.getScale)?void 0:r.call(i,0),!0)-this._spec.bandWidth/2+e},height:this._spec.bandWidth-e-n,x:()=>{var t,e,i;let r=null==(t=this._xAxisHelper)?void 0:t.dataToPosition([0],{bandPosition:this._bandPosition});return this._spec.clamp?lr(r,null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0)):r},cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",H.Series)}}_initTrackMark(){return this._trackMark=this._createMark(SV.mark.track),this._trackMark}_initTrackMarkStyle(){let t=this._trackMark;t&&("vertical"===this._spec.direction?this.setMarkStyle(t,{x:t=>{var e,i;return lr(this.dataToPositionX(t),null==(i=null==(e=this._xAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0),!0)-this._spec.bandWidth/2},y:0,width:this._spec.bandWidth,height:()=>this._scaleY.range()[0],cornerRadius:this._spec.cornerRadius},"normal",H.Series):this.setMarkStyle(t,{x:0,y:t=>{var e,i;return lr(this.dataToPositionY(t),null==(i=null==(e=this._yAxisHelper)?void 0:e.getScale)?void 0:i.call(e,0),!0)-this._spec.bandWidth/2},height:this._spec.bandWidth,width:()=>this._scaleX.range()[1],cornerRadius:this._spec.cornerRadius},"normal",H.Series))}getInteractionTriggers(){let t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)}initAnimation(){var t,e,i,r;let s={direction:this.direction},n=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._progressMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("linearProgress"))?void 0:i(s,n),cb("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("fadeInOut"))?void 0:r(),cb("track",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new SH(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark),this._trackMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._trackMark)}getActiveMarks(){return[this._progressMark]}}SV.type=rw.linearProgress,SV.mark=SN,SV.builtInTheme={linearProgress:{bandWidth:30,progress:{style:{fillOpacity:1}},track:{style:{fill:{type:"palette",key:"linearProgressTrackColor"},fillOpacity:1}}}};let SW=()=>{m4(),Sj(),uJ(),ig.registerSeries(SV.type,SV)};class SU extends fP{needAxes(){return!1}_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t,["bandWidth","progress","track","clamp"]);return r.direction=null!=(e=t.direction)?e:"horizontal",r.cornerRadius=null!=(i=t.cornerRadius)?i:0,r}transformSpec(t){var e,i;if(super.transformSpec(t),t.axes||(t.axes=[]),"vertical"===t.direction){let i=null,r=null;(null!=(e=t.axes)?e:[]).forEach(t=>{let{orient:e}=t;"left"===e&&(i=t),"bottom"===e&&(r=t)}),i||(i={orient:"left",visible:!1},t.axes.push(i)),r||(r={orient:"bottom",visible:!1},t.axes.push(r)),et(r.type)&&(r.type="band"),et(i.type)&&(i.type="linear");let s=gl(i,{min:0,max:1});et(i.min)&&(i.min=s.min),et(i.max)&&(i.max=s.max)}else{let e=null,r=null;(null!=(i=t.axes)?i:[]).forEach(t=>{let{orient:i}=t;"left"===i&&(e=t),"bottom"===i&&(r=t)}),e||(e={type:"band",orient:"left",visible:!1},t.axes.push(e)),r||(r={orient:"bottom",visible:!1},t.axes.push(r)),et(r.type)&&(r.type="linear"),et(e.type)&&(e.type="band");let s=gl(r,{min:0,max:1});et(r.min)&&(r.min=s.min),et(r.max)&&(r.max=s.max)}}}class SG extends fF{constructor(){super(...arguments),this.transformerConstructor=SU,this.type="linearProgress",this.seriesType=rw.linearProgress}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}SG.type="linearProgress",SG.seriesType=rw.linearProgress,SG.transformerConstructor=SU,cD(SG,fH);let SZ=()=>{mc(),mg(),f0(),fW(),SW(),ig.registerChart(SG.type,SG)};class S$ extends d8{constructor(){super(...arguments),this._getMeasureData=t=>"horizontal"===this.series.getSpec().direction?t[this.series.getSpec().xField[0]]+"-"+t[this.series.getSpec().xField[1]]:t[this.series.getSpec().yField[0]]+"-"+t[this.series.getSpec().yField[1]]}}let SY=t=>({type:"growCenterIn",options:{direction:"horizontal"===t.direction?"x":"y"}}),SX={type:"fadeIn"},SK=t=>({type:"growCenterOut",options:{direction:"horizontal"===t.direction?"x":"y"}}),Sq=()=>{ig.registerAnimation("rangeColumn",(t,e)=>({appear:"fadeIn"===e?SX:SY(t),enter:SY(t),exit:SK(t),disappear:SK(t)}))},SQ=Object.assign(Object.assign({},m7),{minLabel:{name:"minLabel",type:"text"},maxLabel:{name:"maxLabel",type:"text"}});class SJ extends m9{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){var e;"bothEnd"!==(null==(e=t.label)?void 0:e.position)&&this._addMarkLabelSpec(t,"bar")}}class S0 extends m8{constructor(){super(...arguments),this.type=rw.rangeColumn,this._barMarkType="rect",this._barName=rw.bar,this.transformerConstructor=SJ}initMark(){var t,e,i,r,s,n,a,l;this._initBarBackgroundMark();let o=null==(t=this._spec.label)?void 0:t.position;this._barMark=this._createMark(S0.mark.bar,{groupKey:this._seriesField,isSeriesMark:!0},{morph:ck(this._spec,S0.mark.bar.name),morphElementKey:this.getDimensionField()[0]}),!1!==(null==(e=this._spec.label)?void 0:e.visible)&&"bothEnd"===o&&(!1!==(null==(r=null==(i=this._spec.label)?void 0:i.minLabel)?void 0:r.visible)&&(this._minLabelMark=this._createMark(S0.mark.minLabel,{markSpec:null==(s=this._spec.label)?void 0:s.minLabel})),!1!==(null==(a=null==(n=this._spec.label)?void 0:n.maxLabel)?void 0:a.visible)&&(this._maxLabelMark=this._createMark(S0.mark.maxLabel,{markSpec:null==(l=this._spec.label)?void 0:l.maxLabel})))}initMarkStyle(){var t,e;super.initMarkStyle(),this._initLabelMarkPos(this._minLabelMark,null==(t=this._spec.label)?void 0:t.minLabel,0,"end"),this._initLabelMarkPos(this._maxLabelMark,null==(e=this._spec.label)?void 0:e.maxLabel,1,"start")}_initLabelMarkPos(t,e,i,r){var s,n,a,l,o,h,u,d,c;if(t){this.setMarkStyle(t,{fill:null!=(n=null==(s=null==e?void 0:e.style)?void 0:s.fill)?n:this.getColorAttribute(),text:t=>{let r="horizontal"===this._spec.direction?t[this._spec.xField[i]]:t[this._spec.yField[i]];return(null==e?void 0:e.formatMethod)?e.formatMethod(r,t):r}});let p=null!=(a=null==e?void 0:e.position)?a:r,g=null!=(l=null==e?void 0:e.offset)?l:"vertical"===this._direction?-20:-25;o=t=>this._barMark.getAttribute("x",t),h=t=>"vertical"===this._direction?this._barMark.getAttribute("x",t)+this._barMark.getAttribute("width",t):this._barMark.getAttribute("x1",t),u=t=>this._barMark.getAttribute("y",t),d=t=>"vertical"===this._direction?this._barMark.getAttribute("y1",t):this._barMark.getAttribute("y",t)+this._barMark.getAttribute("height",t),c=()=>this._direction,this.setMarkStyle(t,{textAlign:t=>{if("vertical"===c())return"center";let e=o(t),i=h(t);if("middle"===p)return"center";if(e>=i){if("start"===p)return"left";if("end"===p)return"right";if("outside"===p)return"left"}else{if("start"===p)return"right";if("end"===p)return"left";if("outside"===p)return"right"}return"center"},textBaseline:t=>{if("horizontal"===c())return"middle";let e=u(t),i=d(t);if("middle"===p)return"middle";if(i>=e){if("start"===p)return"bottom";if("end"===p)return"top";if("outside"===p)return"bottom"}else{if("start"===p)return"top";if("end"===p)return"bottom";if("outside"===p)return"top"}return"middle"}}),this.setMarkStyle(t,{x:t=>{let e=c(),i=o(t),r=h(t);if("vertical"===e||"middle"===p)return(i+r)/2;if(i>=r){if("start"===p)return r+g;if("end"===p)return i-g;if("outside"===p)return i+g}else{if("start"===p)return r-g;if("end"===p)return i+g;if("outside"===p)return i-g}return(i+r)/2},y:t=>{let e=c(),i=u(t),r=d(t);if("horizontal"===e||"middle"===p)return(i+r)/2;if(i>=r){if("start"===p)return r+g;if("end"===p)return i-g;if("outside"===p)return i+g}else{if("start"===p)return r-g;if("end"===p)return i+g;if("outside"===p)return i-g}return(i+r)/2}},"normal",H.Series)}}initLabelMarkStyle(t){t&&(this.setMarkStyle(t,{text:t=>{let e,i;return"horizontal"===this._spec.direction?(e=t[this._spec.xField[0]],i=t[this._spec.xField[1]]):(e=t[this._spec.yField[0]],i=t[this._spec.yField[1]]),e+"-"+i},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._labelMark=t)}_dataToPosX(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[0]),{bandPosition:this._bandPosition})}_dataToPosX1(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})}_dataToPosY(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[0]),{bandPosition:this._bandPosition})}_dataToPosY1(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})}initAnimation(){var t,e,i,r,s;let n=cE(this),a=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._barMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("rangeColumn"))?void 0:i({direction:this.direction},a),cb("bar",this._spec,this._markAttributeContext),n)),this._minLabelMark&&this._minLabelMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("fadeInOut"))?void 0:r(),cb("label",this._spec,this._markAttributeContext),n)),this._maxLabelMark&&this._maxLabelMark.setAnimationConfig(cv(null==(s=ig.getAnimationInKey("fadeInOut"))?void 0:s(),cb("label",this._spec,this._markAttributeContext),n))}initTooltip(){this._tooltipHelper=new S$(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark),this._minLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._minLabelMark),this._maxLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._maxLabelMark),this._labelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._labelMark)}}S0.type=rw.rangeColumn,S0.mark=SQ,S0.builtInTheme={rangeColumn:{label:{visible:!1,offset:5,position:"inside",style:{lineWidth:2,fill:{type:"palette",key:"axisMarkerFontColor"}},minLabel:{position:"end"},maxLabel:{position:"start"}}}},S0.transformerConstructor=SJ;let S1=()=>{m4(),bk(),Sq(),uJ(),g8(),fc(),ig.registerSeries(S0.type,S0)};class S2 extends fP{_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar"]);return"horizontal"===t.direction?r.xField=null!=(e=t.xField)?e:[t.minField,t.maxField]:r.yField=null!=(i=t.yField)?i:[t.minField,t.maxField],r}transformSpec(t){super.transformSpec(t),nF(t)}}class S3 extends fF{constructor(){super(...arguments),this.transformerConstructor=S2,this.type="rangeColumn",this.seriesType=rw.rangeColumn}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}S3.type="rangeColumn",S3.seriesType=rw.rangeColumn,S3.transformerConstructor=S2;let S5=()=>{mc(),mg(),f0(),fW(),S1(),ig.registerChart(S3.type,S3)},S4=(t,e)=>Math.max(0,Math.min(1,(t-e[0])/(e[1]-e[0]||1))),S7=t=>{let e=t.filter(t=>t.context.diffState===N.update),i=ed(e.map(t=>{var e,i;return null==(i=null==(e=null==t?void 0:t.context)?void 0:e.data)?void 0:i[0].depth}));return e.filter(t=>{var e,r;return(null==(r=null==(e=null==t?void 0:t.context)?void 0:e.data)?void 0:r[0].depth)===i})},S6=(t,e,i)=>nR(t)?[e,i]:[ed(t.map(t=>+t.getFinalAttribute().startAngle)),eu(t.map(t=>+t.getFinalAttribute().endAngle))],S9=t=>({channel:{startAngle:{from:(e,i)=>{let{startAngle:r,endAngle:s}=t.animationInfo(),n=S6(S7(i.parent.children),r,s);return S4(i.getFinalAttribute().startAngle,n)*(s-r)+r},to:(t,e)=>e.getFinalAttribute().startAngle},endAngle:{from:(e,i)=>{let{startAngle:r,endAngle:s}=t.animationInfo(),n=S6(S7(i.parent.children),r,s);return S4(i.getFinalAttribute().endAngle,n)*(s-r)+r},to:(t,e)=>e.getFinalAttribute().endAngle},outerRadius:{from:(t,e)=>e.getFinalAttribute().innerRadius,to:(t,e)=>e.getFinalAttribute().outerRadius},innerRadius:{from:(t,e)=>e.getFinalAttribute().innerRadius,to:(t,e)=>e.getFinalAttribute().innerRadius}}}),S8=t=>[ed(t.map(t=>+t.getFinalAttribute().startAngle)),eu(t.map(t=>+t.getFinalAttribute().endAngle))],kt=t=>({channel:{startAngle:{from:(t,e)=>e.getFinalAttribute().startAngle,to:(e,i)=>{let{startAngle:r,endAngle:s}=t.animationInfo(),n=S8(S7(i.parent.children));return S4(i.getFinalAttribute().startAngle,n)*(s-r)+r}},endAngle:{from:(t,e)=>e.getFinalAttribute().endAngle,to:(e,i)=>{let{startAngle:r,endAngle:s}=t.animationInfo(),n=S8(S7(i.parent.children));return S4(i.getFinalAttribute().endAngle,n)*(s-r)+r}},outerRadius:{from:(t,e)=>e.getFinalAttribute().outerRadius,to:()=>t.animationInfo().innerRadius},innerRadius:{from:(t,e)=>e.getFinalAttribute().innerRadius,to:()=>t.animationInfo().innerRadius}}}),ke=(t,e)=>{switch(e){case"fadeIn":return{type:"fadeIn"};case"growAngle":return{type:"growAngleIn"};default:return{type:"growRadiusIn"}}},ki=()=>{ig.registerAnimation("sunburst",(t,e)=>({appear:ke(t,e),enter:S9(t),exit:kt(t),disappear:kt(t)}))};function kr(t){if(ee(t))return t;let e=+t;return ee(e)?e:0}let ks=(t,e,i=0,r=-1,s,n,a="value")=>{let l=0,o=null!=r?r:-1,h=i;return t.forEach((t,r)=>{var u,d;let c={flattenIndex:++o,key:n?n(t):`${null!=(u=null==s?void 0:s.key)?u:""}-${r}`,maxDepth:-1,depth:i,index:r,value:t[a],isLeaf:!0,datum:s?s.datum.concat(t):[t],parentKey:null==s?void 0:s.key};if(null==(d=t.children)?void 0:d.length){c.children=[],c.isLeaf=!1;let e=ks(t.children,c.children,i+1,o,c,n,a);c.value=et(t[a])?e.sum:Math.max(e.sum,kr(t[a])),o=e.flattenIndex,h=Math.max(e.maxDepth,h)}else c.isLeaf=!0,c.value=kr(t[a]);l+=Math.abs(c.value),e.push(c)}),{sum:l,maxDepth:h,flattenIndex:o}},kn=(t,e,i,r)=>{let s=r;return t.forEach((t,r)=>{var n;s=e(t,r,i,s),(null==(n=t.children)?void 0:n.length)&&(s=kn(t.children,e,t,s))}),r},ka=(t,e,i,r)=>{let s=r;return t.forEach((t,r)=>{var n;(null==(n=t.children)?void 0:n.length)&&(s=ka(t.children,e,t,s)),s=e(t,r,i,s)}),s},kl=(t,e=[],i)=>{let r=(null==i?void 0:i.maxDepth)>=0;return t.forEach(t=>{(!r||t.depth<=i.maxDepth)&&(e.push((null==i?void 0:i.callback)?i.callback(t):t),t.children&&(r&&t.depth===i.maxDepth?(t.children=null,t.isLeaf=!0):kl(t.children,e,i)))}),e},ko=(t,e={})=>{if(!t)return[];let i=[];return kl(t,i,e),i};function kh(t,e,i,r,s,n={x0:"x0",x1:"x1",y0:"y0",y1:"y1"}){let a=t.children,l,o=-1,h=a.length,u=t.value&&(r-e)/t.value;for(;++o<h;)(l=a[o])[n.y0]=i,l[n.y1]=s,l[n.x0]=e,l[n.x1]=e+=l.value*u}let ku=(t,e)=>et(t)?e:t3(t)?e*parseFloat(t)/100:t,kd={x0:"startAngle",x1:"endAngle",y0:"innerRadius",y1:"outerRadius"};class kc{constructor(t){this._layoutNode=t=>{if(t.maxDepth=this._maxDepth,t.children){let e=this._parsedInnerRadius[t.depth+1],i=this._parsedOutterRadius[t.depth+1];kh(t,t.startAngle,Math.min(e,i),t.endAngle,Math.max(e,i),kd);let r=tY(this.options.label)?this.options.label[t.depth+1]:this.options.label;t.children.forEach(t=>{if(t.x=this._parsedCenter[0],t.y=this._parsedCenter[1],r)return this._layoutLabel(t,t$(r)?{align:"center",rotate:"radial"}:r)})}},this.options=t?Object.assign({},kc.defaultOpionts,t):Object.assign({},kc.defaultOpionts);let e=this.options.nodeKey,i=tK(e)?e:e?x3(e):null;this._getNodeKey=i,this._maxDepth=-1}_parseRadius(t,e){let i=t.x0+ku(this.options.center[0],t.width),r=t.y0+ku(this.options.center[1],t.height),s=Math.min(t.width/2,t.height/2),n=this.options.innerRadius,a=this.options.outerRadius,l=tY(n),o=l?n.map(t=>ku(t,s)):ku(n,s),h=tY(a),u=this.options.gapRadius,d=h?a.map(t=>ku(t,s)):ku(a,s),c=as(0,e+1);if(l)this._parsedInnerRadius=c.map((t,e)=>{let i=o[e];return et(i)?s:i}),this._parsedOutterRadius=c.map((t,i)=>{var r,n;return h?null!=(r=d[i])?r:s:i<e?this._parsedInnerRadius[i+1]-(tY(u)?null!=(n=u[i])?n:0:u):d});else if(h)this._parsedOutterRadius=c.map((t,e)=>et(d[e])?s:d[e]),this._parsedInnerRadius=c.map((t,e)=>{var i;return 0===e?o:this._parsedOutterRadius[e-1]-(tY(u)?null!=(i=u[e])?i:0:u)});else{let t=ku(n,s),i=(d-t)/(e+1);this._parsedInnerRadius=c.map((e,r)=>t+r*i),this._parsedOutterRadius=c.map((t,e)=>{var r;return this._parsedInnerRadius[e]+i-(tY(u)?null!=(r=u[e])?r:0:u)})}this._parsedCenter=[i,r],this._maxRadius=s}layout(t,e){let i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];let r=[],s=ks(t,r,0,-1,null,this._getNodeKey);return this._parseRadius(i,s.maxDepth),this._maxDepth=s.maxDepth,this._layout(r,{flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:s.sum,datum:null,children:r,startAngle:this.options.startAngle,endAngle:this.options.endAngle}),r}_layout(t,e){this._layoutNode(e),t.forEach(t=>{var e;(null==(e=null==t?void 0:t.children)?void 0:e.length)?this._layout(t.children,t):this._layoutNode(t)})}_layoutLabel(t,e){var i;let r=(t.startAngle+t.endAngle)/2,s=("start"===e.align?t.innerRadius:"end"===e.align?t.outerRadius:(t.innerRadius+t.outerRadius)/2)+(null!=(i=e.offset)?i:0),n=lc({x:this._parsedCenter[0],y:this._parsedCenter[1]},s,r);if(t.label={x:n.x,y:n.y,textBaseline:"middle"},"tangential"===e.rotate)t.label.angle=r-Math.PI/2,t.label.textAlign="center",t.label.maxLineWidth=Math.abs(t.endAngle-t.startAngle)*s;else{let i=r%(2*Math.PI),s=i<0?i+2*Math.PI:i;s>Math.PI/2&&s<1.5*Math.PI?(t.label.angle=s+Math.PI,t.label.textAlign="start"===e.align?"end":"end"===e.align?"start":"center"):(t.label.angle=s,t.label.textAlign=e.align),t.label.maxLineWidth=t.isLeaf?void 0:Math.abs(t.outerRadius-t.innerRadius)}}}kc.defaultOpionts={startAngle:Math.PI/2,endAngle:-3*Math.PI/2,center:["50%","50%"],gapRadius:0,innerRadius:0,outerRadius:"70%"};let kp=(t,e)=>{if(!t)return t;let i=e(),{width:r,height:s}=i;return new kc(i).layout(t,{width:r,height:s})};class kg extends d8{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>null==t?void 0:t[this.series.getDimensionField()[0]]}}let kf=(t,e,i="key",r="children")=>{for(let s=0;s<t.length;s++){let n=t[s];if(n[i]===e)return n;if(n[r]){let t=kf(n[r],e,i,r);if(t)return t}}return null},km=(t,e,i="key",r="children")=>{for(let s=0;s<t.length;s++){let n=t[s];if(n[r])for(let t=0;t<n[r].length;t++){let s=n[r][t];if(s[i]===e)return n;let a=km([s],e,i,r);if(a)return a}}return null},ky=(t,e,i="key",r="children")=>{let s=[],n=(t,a)=>{for(let l of t){if(l[i]===e)return s.push(...a,l[i].toString()),!0;if(l[r]){let t=n(l[r],[...a,l[i]]);if(!0===t)return t}}return!1};return n(t,[]),s};(O=q||(q={})).DrillDown="drillDown",O.DrillUp="drillUp";let k_=(t,e)=>{let i=e.info(),r=e.keyField(),s=null==i?void 0:i.key;if(et(s))return t;if(i.type===q.DrillDown)return eo(kf(t,s,r,"children"));if(i.type===q.DrillUp){let e=km(t,s,r,"children");if(e)return eo(e)}return t};class kv{_getDrillTriggerEvent(t){var e;let{mode:i}=this._drillParams;return null==(e=_F(i))?void 0:e[t]}_hideTooltip(){let t=this.getChart().getComponentsByType(rA.tooltip)[0];t&&t.hideTooltip()}initDrillable(t){this._drillParams=t}initDrillableData(t){let{getRawData:e}=this._drillParams;sY(t,"drillFilter",k_),e().transform({type:"drillFilter",options:{info:()=>this._drillInfo,keyField:()=>this._drillParams.drillField()}})}bindDrillEvent(){let{event:t,getRawData:e,drillField:i}=this._drillParams,r=i();this._getDrillTriggerEvent("start")&&t.on(this._getDrillTriggerEvent("start"),t=>{var i,s,n;if(et(t.datum)||et(null==(i=t.datum)?void 0:i[r]))return void this.drillUp();this._hideTooltip();let a=t.datum[r],l=null!=(n=null==(s=this._drillInfo)?void 0:s.path)?n:[],o=ky(e().rawData,a,r,"children");l[l.length-1]===o[o.length-1]?this.drillUp():this.drillDown(o)})}drillDown(t=[]){let{getRawData:e,event:i}=this._drillParams;if(!tY(t)||nR(t))return t;let r=t[t.length-1];return this._drillInfo={key:r,path:t,type:q.DrillDown},e().reRunAllTransform(),i.emit(rB.drill,{value:{path:t,type:q.DrillDown},model:this}),t}drillUp(){var t,e;let{getRawData:i,event:r}=this._drillParams,s=null!=(e=null==(t=this._drillInfo)?void 0:t.path)?e:[];if(!tY(s)||nR(s))return s;let n=s.pop();return this._drillInfo={key:n,path:s,type:q.DrillUp},i().reRunAllTransform(),r.emit(rB.drill,{value:{path:s,type:q.DrillUp},model:this}),s}}let kb=Object.assign(Object.assign({},cd),{sunburst:{name:"sunburst",type:"arc"}}),kx=(t,e,i)=>(t.push({key:e,operations:["values"]}),t.push({key:i,operations:["max","min"]}),t.push({key:cs,operations:["max","min","values"]}),t.push({key:cn,operations:["values"]}),t);class kS extends _Y{constructor(){super(...arguments),this.type=rw.sunburst}setCategoryField(t){return this._categoryField=t,this._categoryField}getCategoryField(){return this._categoryField}setValueField(t){return this._valueField=t,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:cn),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t;return null!=(t=this._spec.drillField)?t:ni},getRawData:()=>this.getRawData()}),this._startAngle=lu(this._spec.startAngle),this._endAngle=lu(this._spec.endAngle),this._centerX=this._spec.centerX,this._centerY=this._spec.centerY,this._offsetX=this._spec.offsetX,this._offsetY=this._spec.offsetY,this.__innerRadius=this._spec.innerRadius,this.__outerRadius=this._spec.outerRadius,this._gap=this._spec.gap,this._labelLayout=this._spec.labelLayout,this._sunburst=this._spec.sunburst,this._label=this._spec.label,this._labelAutoVisible=this._spec.labelAutoVisible}initData(){super.initData();let t=this.getRawData();t&&(this._spec.drill&&this.initDrillableData(this._dataSet),sY(this._dataSet,"sunburstLayout",kp),sY(this._dataSet,"flatten",ko),t.transform({type:"sunburstLayout",options:()=>{let{innerRadius:t,outerRadius:e,gap:i,label:r}=this._computeLevel();return{nodeKey:this._categoryField,width:this.getLayoutRect().width,height:this.getLayoutRect().height,center:[t5(this._centerX)?this._centerX:this.getLayoutRect().width/2,t5(this._centerY)?this._centerY:this.getLayoutRect().height/2],startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:t,outerRadius:e,gapRadius:i,label:r}}}),t.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}}))}getStatisticFields(){return kx(super.getStatisticFields(),this._categoryField,this._valueField)}_addDataIndexAndKey(){let t=this.getRawData();et(null==t?void 0:t.dataSet)||(sY(t.dataSet,"addVChartProperty",dK),t.transform({type:"addVChartProperty",options:{beforeCall:ch.bind(this),call:cu}}))}initMark(){this._initArcMark(),this._initLabelMark()}initMarkStyle(){this._initArcMarkStyle(),this._initLabelMarkStyle()}_initArcMark(){if(!1===this._sunburst.visible)return;let t=this._createMark(kS.mark.sunburst,{isSeriesMark:!0});this._sunburstMark=t}_initArcMarkStyle(){et(this._sunburstMark)||this.setMarkStyle(this._sunburstMark,{x:t=>t.x+(t5(this._offsetX)?this._offsetX:0),y:t=>t.y+(t5(this._offsetY)?this._offsetY:0),outerRadius:t=>t.outerRadius,innerRadius:t=>t.innerRadius,startAngle:t=>t.startAngle,endAngle:t=>t.endAngle,fill:this.getColorAttribute()},V.STATE_NORMAL,H.Series)}_initLabelMark(){if(!0!==this._label.visible)return;let t=this._createMark(kS.mark.label,{isSeriesMark:!1});this._labelMark=t}_initLabelMarkStyle(){et(this._labelMark)||this.setMarkStyle(this._labelMark,{visible:t=>{var e;let i=this._labelAutoVisible;return ey(i)&&!0===i.enable?(t.endAngle-t.startAngle)*(t.outerRadius-t.innerRadius)>(null!=(e=null==i?void 0:i.circumference)?e:10):this._spec.label.visible},x:t=>{var e;return(null==(e=t.label)?void 0:e.x)+(t5(this._offsetX)?this._offsetX:0)},y:t=>{var e;return(null==(e=t.label)?void 0:e.y)+(t5(this._offsetY)?this._offsetY:0)},textBaseline:t=>{var e;return null==(e=t.label)?void 0:e.textBaseline},textAlign:t=>{var e;return null==(e=t.label)?void 0:e.textAlign},angle:t=>{var e,i;return null!=(i=null==(e=t.label)?void 0:e.angle)?i:0},fontSize:10,text:t=>t.name},V.STATE_NORMAL,H.Series)}initTooltip(){this._tooltipHelper=new kg(this),this._sunburstMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._sunburstMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var t,e;let i={animationInfo:()=>({innerRadius:this._computeRadius(eo(this.__innerRadius))[0],outerRadius:this._computeRadius(eo(this.__outerRadius))[0],startAngle:eo(this._startAngle)[0],endAngle:eo(this._endAngle)[0]})},r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this.getMarksInType("arc").forEach(t=>{var e;t.setAnimationConfig(cv(null==(e=ig.getAnimationInKey("sunburst"))?void 0:e(i,r),cb(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(t=>{var e;t.setAnimationConfig(cv(null==(e=ig.getAnimationInKey("fadeInOut"))?void 0:e(),cb(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(){super.onLayoutEnd(),this._rawData.reRunAllTransform()}_computeRadius(t){return tY(t)?t.map(t=>this._computeLayoutRadius()*t):this._computeLayoutRadius()*t}_computeLevel(){return{innerRadius:this._computeRadius(this.__innerRadius),outerRadius:this._computeRadius(this.__outerRadius),gap:this._gap,label:this._labelLayout}}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._sunburstMark]}getMarkData(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t}}kS.type=rw.sunburst,kS.mark=kb,kS.builtInTheme={sunburst:{innerRadius:0,outerRadius:1,startAngle:-90,endAngle:270,gap:0,labelLayout:{align:"center",offset:0,rotate:"radial"},sunburst:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1,cursor:"pointer"}},label:{visible:!0,style:{cursor:"pointer",fill:{type:"palette",key:"primaryFontColor"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},cD(kS,kv);let kk=()=>{ig.registerSeries(kS.type,kS),va(),bk(),uJ(),ki()};class kA extends fB{_getDefaultSeriesSpec(t){let e=t5(t.startAngle)?t.startAngle:-90,i=t5(t.endAngle)?t.endAngle:e+ld(2*Math.PI),r=super._getDefaultSeriesSpec(t,["categoryField","valueField","centerX","centerY","offsetX","offsetY","innerRadius","outerRadius","gap","labelLayout","label","labelAutoVisible","drill","drillField"]);return r.startAngle=e,r.endAngle=i,r}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class kM extends fF{constructor(){super(...arguments),this.transformerConstructor=kA,this.type="sunburst",this.seriesType=rw.sunburst}}kM.type="sunburst",kM.seriesType=rw.sunburst,kM.transformerConstructor=kA;let kw=()=>{mg(),kk(),ig.registerChart(kM.type,kM)};function kT(t,e){let i=t.radius-e.radius,r=e.x-t.x,s=e.y-t.y;return i<0||i*i<r*r+s*s}function kC(t,e){let i=t.radius-e.radius+1e-9*Math.max(t.radius,e.radius,1),r=e.x-t.x,s=e.y-t.y;return i>0&&i*i>r*r+s*s}function kE(t,e){for(let i=0;i<e.length;++i)if(!kC(t,e[i]))return!1;return!0}function kB(t,e){let i=t.x,r=t.y,s=t.radius,n=e.x,a=e.y,l=e.radius,o=n-i,h=a-r,u=l-s,d=Math.sqrt(o*o+h*h);return{x:(i+n+o/d*u)/2,y:(r+a+h/d*u)/2,radius:(d+s+l)/2}}function kP(t,e,i){let r=t.x,s=t.y,n=t.radius,a=e.x,l=e.y,o=e.radius,h=i.x,u=i.y,d=i.radius,c=r-a,p=r-h,g=s-l,f=s-u,m=o-n,y=d-n,_=r*r+s*s-n*n,v=_-a*a-l*l+o*o,b=_-h*h-u*u+d*d,x=p*g-c*f,S=(g*b-f*v)/(2*x)-r,k=(f*m-g*y)/x,A=(p*v-c*b)/(2*x)-s,M=(c*y-p*m)/x,w=k*k+M*M-1,T=2*(n+S*k+A*M),C=S*S+A*A-n*n,E=-(Math.abs(w)>1e-6?(T+Math.sqrt(T*T-4*w*C))/(2*w):C/T);return{x:r+S+k*E,y:s+A+M*E,radius:E}}function kO(t,e,i){let r,s,n,a,l=t.x-e.x,o=t.y-e.y,h=l*l+o*o;h?(s=e.radius+i.radius,s*=s,a=t.radius+i.radius,s>(a*=a)?(r=(h+a-s)/(2*h),n=Math.sqrt(Math.max(0,a/h-r*r)),i.x=t.x-r*l-n*o,i.y=t.y-r*o+n*l):(r=(h+s-a)/(2*h),n=Math.sqrt(Math.max(0,s/h-r*r)),i.x=e.x+r*l-n*o,i.y=e.y+r*o+n*l)):(i.x=e.x+i.radius,i.y=e.y)}function kI(t,e){let i=t.radius+e.radius-1e-6,r=e.x-t.x,s=e.y-t.y;return i>0&&i*i>r*r+s*s}function kR(t){let e=t._,i=t.next._,r=e.radius+i.radius,s=(e.x*i.radius+i.x*e.radius)/r,n=(e.y*i.radius+i.y*e.radius)/r;return s*s+n*n}function kL(t){return{_:t,next:null,prev:null}}let kD=t=>0;function kF(t){return function(e){e.children||(e.radius=Math.max(0,+t(e)||0))}}function kz(t,e,i){return function(r){let s=null==r?void 0:r.children;if(s){let n,a=s.length,l=t(r)*e||0;if(l)for(n=0;n<a;++n)s[n].radius+=l;let o=function(t,e){let i=(t=eo(t)).length;if(!i)return 0;let r=t[0];if(r.x=0,r.y=0,1===i)return r.radius;let s=t[1];if(r.x=-s.radius,s.x=r.radius,s.y=0,2===i)return r.radius+s.radius;let n=t[2];kO(s,r,n);let a,l,o,h,u,d,c,p=kL(r),g=kL(s),f=kL(n);p.next=g,f.prev=g,g.next=f,p.prev=f,f.next=p,g.prev=p;for(let e=3;e<i;++e){c=!1,n=t[e],kO(p._,g._,n),f=kL(n),a=g.next,l=p.prev,o=g._.radius,h=p._.radius;do if(o<=h){if(kI(a._,f._)){g=a,p.next=g,g.prev=p,--e,c=!0;break}o+=a._.radius,a=a.next}else{if(kI(l._,f._)){(p=l).next=g,g.prev=p,--e,c=!0;break}h+=l._.radius,l=l.prev}while(a!==l.next);if(!c){for(f.prev=p,f.next=g,p.next=g.prev=g=f,u=kR(p),f=f.next;f!==g;)(d=kR(f))<u&&(p=f,u=d),f=f.next;g=p.next}}let m=[g._];for(f=g.next;f!==g;)m.push(f._),f=f.next;n=function(t,e){let i=0,r=ec(Array.from(t),e),s=r.length,n,a,l=[];for(;i<s;)n=r[i],a&&kC(a,n)?++i:(a=function(t){switch(t.length){case 1:var e;return{x:(e=t[0]).x,y:e.y,radius:e.radius};case 2:return kB(t[0],t[1]);case 3:return kP(t[0],t[1],t[2])}}(l=function(t,e){let i,r;if(kE(e,t))return[e];for(i=0;i<t.length;++i)if(kT(e,t[i])&&kE(kB(t[i],e),t))return[t[i],e];for(i=0;i<t.length-1;++i)for(r=i+1;r<t.length;++r)if(kT(kB(t[i],t[r]),e)&&kT(kB(t[i],e),t[r])&&kT(kB(t[r],e),t[i])&&kE(kP(t[i],t[r],e),t))return[t[i],t[r],e];tW.getInstance().error("error when packEncloseRandom")}(l,n)),i=0);return a}(m,e);for(let e=0;e<i;++e)r=t[e],r.x-=n.x,r.y-=n.y;return n.radius}(s,i);if(l)for(n=0;n<a;++n)s[n].radius-=l;r.radius=o+l}}}function kj(t,e){return function(i,r,s){i.radius*=t,i.maxDepth=e,s&&(i.x=s.x+t*i.x,i.y=s.y+t*i.y)}}class kH{constructor(t){this.options=t;let e=null==t?void 0:t.nodeKey,i=tK(e)?e:e?x3(e):null;this._getNodeKey=i,this._getPadding=tH(null==t?void 0:t.padding)?e=>t.padding:tY(null==t?void 0:t.padding)?e=>{var i;return null!=(i=t.padding[e.depth+1])?i:0}:()=>0,this._maxDepth=-1}layout(t,e){var i;let r="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];let s=[],n=ks(t,s,0,-1,null,this._getNodeKey);this._maxDepth=n.maxDepth;let a=function(t=1){let e=t;return()=>(e=(1664525*e+0x3c6ef35f)%0x100000000)/0x100000000}(),l={flattenIndex:-1,maxDepth:-1,key:"root",depth:-1,index:-1,value:n.sum,datum:null,children:s,x:r.x0+r.width/2,y:r.y0+r.height/2},{nodeSort:o,setRadius:h,padding:u,includeRoot:d}=null!=(i=this.options)?i:{};if(!1!==o){let t=tK(o)?this.options.nodeKey:kH.defaultOpionts.nodeSort;kn([l],e=>{e.children&&e.children.length&&e.children.sort(t)})}if(h)kn([l],kF(h)),ka([l],kz(this._getPadding,.5,a)),kn([l],kj(1,this._maxDepth));else{let t=Math.min(r.width,r.height);kn([l],kF(kH.defaultOpionts.setRadius)),ka([l],kz(kD,1,a)),u&&ka([l],kz(this._getPadding,l.radius/t,a)),kn([l],kj(t/(2*l.radius),this._maxDepth))}return d?[l]:s}}kH.defaultOpionts={setRadius:t=>Math.sqrt(t.value),padding:0,nodeSort:(t,e)=>e.value-t.value};let kN=(t,e)=>{if(!t)return t;let i=e(),{width:r,height:s}=i;return 0===r||0===s?t:new kH(i).layout(t,{width:r,height:s})};class kV extends d8{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>null==t?void 0:t[this.series.getDimensionField()[0]]}}let kW=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"growRadiusIn"},kU=()=>{ig.registerAnimation("circlePacking",(t,e)=>({appear:kW(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}))},kG=Object.assign(Object.assign({},cd),{circlePacking:{name:"circlePacking",type:"arc"}});class kZ extends cB{constructor(){super(...arguments),this.type=rw.circlePacking}setCategoryField(t){return this._categoryField=t,this._categoryField}getCategoryField(){return this._categoryField}setValueField(t){return this._valueField=t,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:cn),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t;return null!=(t=this._spec.drillField)?t:ni},getRawData:()=>this.getRawData()}),this._circlePacking=this._spec.circlePacking,this._label=this._spec.label,this._layoutPadding=this._spec.layoutPadding}initData(){super.initData();let t=this.getRawData();et(t)||(this._spec.drill&&this.initDrillableData(this._dataSet),sY(this._dataSet,"circlePackingLayout",kN),sY(this._dataSet,"flatten",ko),t.transform({type:"circlePackingLayout",options:()=>({nodeKey:this._categoryField,padding:this._layoutPadding,includeRoot:!1,width:this.getLayoutRect().width||1,height:this.getLayoutRect().height||1})}),t.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}}))}_addDataIndexAndKey(){let t=this.getRawData();et(null==t?void 0:t.dataSet)||(sY(t.dataSet,"addVChartProperty",dK),t.transform({type:"addVChartProperty",options:{beforeCall:ch.bind(this),call:cu}}))}initMark(){this._initCirclePackingMark(),this._initLabelMark()}initMarkStyle(){this._initCirclePackingMarkStyle(),this._initLabelMarkStyle()}_initCirclePackingMark(){var t;if(!1===(null==(t=this._circlePacking)?void 0:t.visible))return;let e=this._createMark(kZ.mark.circlePacking,{isSeriesMark:!0});this._circlePackingMark=e}_initCirclePackingMarkStyle(){et(this._circlePackingMark)||this.setMarkStyle(this._circlePackingMark,{x:t=>t.x,y:t=>t.y,outerRadius:t=>t.radius,innerRadius:0,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),zIndex:t=>t.depth},V.STATE_NORMAL,H.Series)}_initLabelMark(){var t;if(!1===(null==(t=this._label)?void 0:t.visible))return;let e=this._createMark(kZ.mark.label,{isSeriesMark:!1});this._labelMark=e}_initLabelMarkStyle(){et(this._labelMark)||this.setMarkStyle(this._labelMark,{x:t=>t.x,y:t=>t.y,text:t=>t.key,cursor:"pointer"},V.STATE_NORMAL,H.Series)}getStatisticFields(){return kx(super.getStatisticFields(),this._categoryField,this._valueField)}initTooltip(){this._tooltipHelper=new kV(this),this._circlePackingMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circlePackingMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var t;let e=null==(t=this._spec.animationAppear)?void 0:t.preset;this.getMarksInType("arc").forEach(t=>{var i;t.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("circlePacking"))?void 0:i(void 0,e),cb(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(t=>{var e;t.setAnimationConfig(cv(null==(e=ig.getAnimationInKey("scaleInOut"))?void 0:e(),cb(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(){super.onLayoutEnd(),this._rawData.reRunAllTransform()}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._circlePackingMark]}getMarkData(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t}}kZ.type=rw.circlePacking,kZ.mark=kG,kZ.builtInTheme={circlePacking:{layoutPadding:5,circlePacking:{visible:!0,style:{cursor:"pointer",lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},label:{visible:!0,style:{cursor:"pointer",fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},cD(kZ,kv);let k$=()=>{ig.registerSeries(kZ.type,kZ),va(),bk(),uQ(),kU()};class kY extends fB{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","layoutPadding","circlePacking","drill","drillField"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class kX extends fF{constructor(){super(...arguments),this.transformerConstructor=kY,this.type="circlePacking",this.seriesType=rw.circlePacking}}kX.type="circlePacking",kX.seriesType=rw.circlePacking,kX.transformerConstructor=kY;let kK=()=>{mg(),k$(),ig.registerChart(kX.type,kX)},kq=(t,e)=>{let i=e.fields;return(tK(i)&&(i=i()),(null==i?void 0:i.length)&&(null==t?void 0:t.length)&&t[0].latestData)?ce([{latestData:ko(t[0].latestData)}],e):{}};class kQ extends d8{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>{var e,i;return null==(i=null==(e=this.series)?void 0:e.getMarkData(t))?void 0:i[this.series.getDimensionField()[0]]},this.markTooltipValueCallback=t=>{var e,i;let{measureFields:r}=this._seriesCacheInfo,s=null==(e=this.series)?void 0:e.getMarkData(t);if(r[0]&&s)return null!=(i=s[r[0]])?i:t.value},this.dimensionTooltipTitleCallback=t=>{var e;let{dimensionFields:i}=this._seriesCacheInfo,r=null==(e=this.series)?void 0:e.getMarkData(t);if(i[0]&&r)return r[i[0]]}}get defaultShapeType(){return"square"}}let kJ=Object.assign(Object.assign({},cd),{nonLeaf:{name:"nonLeaf",type:"rect"},leaf:{name:"leaf",type:"rect"},nonLeafLabel:{name:"nonLeafLabel",type:"text"}}),k0=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"growCenterIn"},k1=()=>{ig.registerAnimation("treemap",(t,e)=>({appear:k0(e),enter:{type:"growCenterIn"},exit:{type:"growCenterOut"},disappear:{type:"growCenterOut"}}))};class k2 extends cw{_transformLabelSpec(t){this._addMarkLabelSpec(t,"nonLeaf","nonLeafLabel","initNonLeafLabelMarkStyle"),this._addMarkLabelSpec(t,"leaf")}}let k3=()=>{ig.registerGrammarTransform("filter",{transform:(t,e)=>null==e?void 0:e.filter(t.callback)})},k5=()=>{ig.registerGrammarTransform("map",{transform:(t,e)=>(null==e||e.forEach((e,i)=>{t.callback(e)}),e)})};function k4(t,e,i,r,s){let n=t.children,a,l=-1,o=n.length,h=t.value&&(s-i)/t.value;for(;++l<o;)(a=n[l]).x0=e,a.x1=r,a.y0=i,i+=a.value*h,a.y1=i}let k7=t=>(e,i,r,s,n)=>{!function(t,e,i,r,s,n){let a=[],l=e.children,o,h,u=0,d=0,c=l.length,p,g,f,m,y,_,v,b,x,S=e.value;for(;u<c;){p=s-i,g=n-r;do f=l[d++].value;while(!f&&d<c);for(m=f,v=Math.max((y=f)/(x=f*f*(b=Math.max(g/p,p/g)/(S*t))),x/m);d<c;++d){if(f+=h=l[d].value,h<m&&(m=h),h>y&&(y=h),(_=Math.max(y/(x=f*f*b),x/m))>v){f-=h;break}v=_}o=Object.assign({},e,{value:f,children:l.slice(u,d)}),a.push(o),p<g?kh(o,i,r,s,S?r+=g*f/S:n):k4(o,i,r,S?i+=p*f/S:s,n),S-=f,u=d}}(t,e,i,r,s,n)},k6={binary:function(t,e,i,r,s){let n=t.children,a=n.length,l=0,o=Array(a+1);o[0]=0;for(let t=0;t<a;++t)l+=n[t].value,o[t+1]=l;let h=(t,e,i,r,s,a,l)=>{if(t>=e-1){let e=n[t];return e.x0=r,e.y0=s,e.x1=a,void(e.y1=l)}let u=o[t],d=i/2+u,c=t+1,p=e-1;for(;c<p;){let t=c+p>>>1;o[t]<d?c=t+1:p=t}d-o[c-1]<o[c]-d&&t+1<c&&--c;let g=o[c]-u,f=i-g;if(a-r>l-s){let n=i?(r*f+a*g)/i:a;h(t,c,g,r,s,n,l),h(c,e,f,n,s,a,l)}else{let n=i?(s*f+l*g)/i:l;h(t,c,g,r,s,a,n),h(c,e,f,r,n,a,l)}};h(0,a,t.value,e,i,r,s)},dice:kh,slice:k4,sliceDice:function(t,e,i,r,s){(t.depth%2==1?k4:kh)(t,e,i,r,s)}};class k9{constructor(t){var e;this._filterByArea=(t,e)=>{var i;let r=this._getMinAreaByDepth(t.depth);if(r>0&&t.value*e<r)return!1;if(null==(i=t.children)?void 0:i.length){let i=t.children.filter(t=>this._filterByArea(t,e));i.length?i.length!==t.children.length&&(t.children=i):(t.isLeaf=!0,t.children=null)}return!0},this._getMinAreaByDepth=t=>{var e;return t<0?0:null!=(e=tY(this.options.minVisibleArea)?this.options.minVisibleArea[t]:this.options.minVisibleArea)?e:0},this._getGapWidthByDepth=t=>{var e;return t<0?0:null!=(e=tY(this.options.gapWidth)?this.options.gapWidth[t]:this.options.gapWidth)?e:0},this._getPaddingByDepth=t=>{var e;return t<0?0:null!=(e=tY(this.options.padding)?this.options.padding[t]:this.options.padding)?e:0},this._getLabelPaddingByDepth=t=>{var e;return t<0?0:null!=(e=tY(this.options.labelPadding)?this.options.labelPadding[t]:this.options.labelPadding)?e:0},this._layoutNode=t=>{let e=this._getGapWidthByDepth(t.depth),i=t.x0,r=t.y0,s=t.x1,n=t.y1;if(t.maxDepth=this._maxDepth,e>0&&(i+=e/2,s-=e/2,r+=e/2,n-=e/2,i>s&&(s=i=(i+s)/2),r>n&&(n=r=(r+n)/2),t.x0=i,t.x1=s,t.y0=r,t.y1=n),t.children){let e=this._getLabelPaddingByDepth(t.depth),a=this._getPaddingByDepth(t.depth);a>0&&a<Math.min(s-i,n-r)/2&&(r+=a,n-=a,i+=a,s-=a),e>0&&("top"===this.options.labelPosition&&r+e<n?(t.labelRect={x0:i,y0:r,x1:s,y1:r+e},r+=e):"bottom"===this.options.labelPosition&&n-e>r?(t.labelRect={x0:i,y0:n-e,x1:s,y1:n},n-=e):"left"===this.options.labelPosition&&i+e<s?(t.labelRect={x0:i,y0:r,x1:i+e,y1:n},i+=e):"right"===this.options.labelPosition&&s-e>i&&(t.labelRect={x0:s-e,y0:r,x1:s,y1:n},s-=e));let l=this._getGapWidthByDepth(t.depth+1);l>0&&(i-=l/2,s+=l/2,r-=l/2,n+=l/2),this._splitNode(t,i,r,s,n)}},this.options=Object.assign({},k9.defaultOpionts,t);let i=this.options.nodeKey,r=tK(i)?i:i?x3(i):null;this._getNodeKey=r,this._splitNode="squarify"===this.options.splitType?k7(this.options.aspectRatio):null!=(e=k6[this.options.splitType])?e:k6.binary,this._maxDepth=-1}layout(t,e){var i;if(!t||!t.length)return[];let r="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},s=[],n=ks(t,s,0,-1,null,this._getNodeKey,this.options.valueField);if(this._maxDepth=n.maxDepth,n.sum<=0)return[];let a={flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:n.sum,datum:null,x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1,children:s},l=r.width*r.height/n.sum;return this._filterByArea(a,l),this._layout(a),null!=(i=a.children)?i:[]}_filterChildren(t){let e=this.options.maxDepth;if(tH(e)&&e>=0&&t.depth>=e)return!1;let i=this.options.minChildrenVisibleArea;if(tH(i)&&Math.abs((t.x1-t.x0)*(t.y1-t.y0))<i)return!1;let r=this.options.minChildrenVisibleSize;return!tH(r)||!(Math.abs(t.x1-t.x0)<r||Math.abs(t.y1-t.y0)<r)}_layout(t){var e;this._filterChildren(t)||(t.children=null,t.isLeaf=!0),this._layoutNode(t),(null==(e=t.children)?void 0:e.length)&&t.children.forEach(t=>{var e;(null==(e=null==t?void 0:t.children)?void 0:e.length)?this._layout(t):this._layoutNode(t)})}}k9.defaultOpionts={aspectRatio:(1+Math.sqrt(5))/2,gapWidth:0,labelPadding:0,labelPosition:"top",splitType:"binary",minVisibleArea:10};let k8=(t,e)=>{if(e.getViewBox()){let i=new k9(e).layout(t,e.getViewBox()),r=[];return kl(i,r,{maxDepth:null==e?void 0:e.maxDepth}),r.forEach((t,i)=>{t&&[cn,"name"].forEach(i=>{t[i]=t.datum[t.depth][e.nameField]})}),r}return[]};class At extends cB{constructor(){super(...arguments),this.type=rw.treemap,this.transformerConstructor=k2,this._categoryField="name",this._valueField="value",this._viewBox=new pV,this._enableAnimationHook=this.enableMarkAnimation.bind(this),this.isHierarchyData=()=>!0}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:cn),this._spec.roam&&(this.initZoomable(this.event,this._option.mode),this._matrix=new yv),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t,e;return null!=(e=null!=(t=this._spec.drillField)?t:this._categoryField)?e:ni},getRawData:()=>this.getRawData()}),ee(this._spec.maxDepth)&&(this._maxDepth=this._spec.maxDepth-1)}initData(){var t,e,i,r,s;super.initData(),sY(this._dataSet,"treemap",k8),null==(t=this._data.getDataView())||t.transform({type:"treemap",options:{nameField:this._categoryField,valueField:this._valueField,getViewBox:()=>this._viewBox.empty()?null:{x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2},maxDepth:this._maxDepth,gapWidth:this._spec.gapWidth,padding:this._spec.nodePadding,splitType:this._spec.splitType,aspectRatio:this._spec.aspectRatio,labelPadding:(null==(e=this._spec.nonLeafLabel)?void 0:e.visible)?null==(i=this._spec.nonLeafLabel)?void 0:i.padding:0,labelPosition:null==(r=this._spec.nonLeafLabel)?void 0:r.position,minVisibleArea:null!=(s=this._spec.minVisibleArea)?s:10,minChildrenVisibleArea:this._spec.minChildrenVisibleArea,minChildrenVisibleSize:this._spec.minChildrenVisibleSize}}),this.getViewData()&&this._spec.drill&&this.initDrillableData(this._dataSet)}_runTreemapTransform(t=!1){this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()}_addDataIndexAndKey(){var t;(null==(t=this._rawData)?void 0:t.dataSet)&&(sY(this._rawData.dataSet,"addVChartProperty",dK),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:ch.bind(this),call:cu}}))}getRawDataStatisticsByField(t,e){var i;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&this._rawData){let r=kq([this._rawData],{fields:[{key:t,operations:e?["min","max"]:["values"]}]})[t];this._rawStatisticsCache[t]=t8(null!=(i=this._rawStatisticsCache[t])?i:{},r)}return this._rawStatisticsCache[t]}_createHierarchyDataStatistics(t,e){sY(this._dataSet,"hierarchyDimensionStatistics",kq),sY(this._dataSet,"flatten",ko);let i=new er(this._dataSet,{name:t});return i.parse(e,{type:"dataview"}),i.transform({type:"hierarchyDimensionStatistics",options:{fields:()=>{let t=this.getStatisticFields();return this._seriesField&&this._seriesField!==this._categoryField&&t.push({key:this._seriesField,operations:["values"]}),t}}},!1),i}getStatisticFields(){return kx(super.getStatisticFields(),this._categoryField,this._valueField)}initMark(){let t=this._createMark(At.mark.nonLeaf,{isSeriesMark:!0});t&&(t.setTransform([{type:"filter",callback:t=>!this._shouldFilterElement(t,"nonLeaf")}]),this._nonLeafMark=t);let e=this._createMark(At.mark.leaf,{isSeriesMark:!0});e&&(e.setTransform([{type:"filter",callback:t=>!this._shouldFilterElement(t,"leaf")}]),this._leafMark=e)}initMarkStyle(){this._initLeafMarkStyle(),this._initNonLeafMarkStyle()}_initLeafMarkStyle(){this._leafMark&&this.setMarkStyle(this._leafMark,{x:t=>t.x0,y:t=>t.y0,x1:t=>t.x1,y1:t=>t.y1,fill:this.getColorAttribute()},V.STATE_NORMAL,H.Series)}_initNonLeafMarkStyle(){this._nonLeafMark&&this.setMarkStyle(this._nonLeafMark,{x:t=>t.x0,y:t=>t.y0,x1:t=>t.x1,y1:t=>t.y1,fill:this.getColorAttribute()},V.STATE_NORMAL,H.Series)}_initRichStyleOfLabelMark(t){"rich"===t.getTextType()&&this.setMarkStyle(t,{maxWidth:t=>Math.abs(t.x0-t.x1),maxHeight:t=>Math.abs(t.y0-t.y1),ellipsis:!0},V.STATE_NORMAL,H.Series)}initLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:t=>(t.x0+t.x1)/2,y:t=>(t.y0+t.y1)/2,text:t=>{var e;return null==(e=t.datum[t.depth])?void 0:e[this.getDimensionField()[0]]},maxLineWidth:t=>t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0},V.STATE_NORMAL,H.Series),this._initRichStyleOfLabelMark(t))}initNonLeafLabelMarkStyle(t){t&&(this._nonLeafLabelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:t=>t.labelRect?(t.labelRect.x0+t.labelRect.x1)/2:(t.x0+t.x1)/2,y:t=>t.labelRect?(t.labelRect.y0+t.labelRect.y1)/2:(t.y0+t.y1)/2,text:t=>{var e;return null==(e=t.datum[t.depth])?void 0:e[this.getDimensionField()[0]]},maxLineWidth:t=>t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0},V.STATE_NORMAL,H.Series),this._initRichStyleOfLabelMark(t))}initAnimation(){this.getMarksInType("rect").forEach(t=>{var e;t.setAnimationConfig(cv(null==(e=ig.getAnimationInKey("treemap"))?void 0:e(),cb(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.roam&&(this.initDragEventOfSeries(this),this.event.on("panmove",t=>{this.handlePan(t)}),this.initZoomEventOfSeries(this),this.event.on("zoom",t=>{this.handleZoom(t)})),this._spec.drill&&this.bindDrillEvent()}_getDataIdKey(){return"key"}initTooltip(){this._tooltipHelper=new kQ(this),this._leafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._leafMark),this._nonLeafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nonLeafMark)}_shouldFilterElement(t,e){let i=t.isLeaf;return"leaf"===e?!i:i}handlePan(t){let{delta:e}=t;if(0===e[0]&&0===e[1])return;this._matrix.reset(),this._matrix.translate(e[0],e[1]);let{a:i,b:r,c:s,d:n,e:a,f:l}=this._matrix;this._matrix.multiply(i,r,s,n,a,l),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}handleZoom(t){let{scale:e,scaleCenter:i}=t;if(1===e)return;this._matrix.reset();let{x:r,y:s}=i;this._matrix.translate(r,s),this._matrix.scale(e,e),this._matrix.translate(-r,-s);let{a:n,b:a,c:l,d:o,e:h,f:u}=this._matrix;this._matrix.multiply(n,a,l,o,h,u),this.disableMarkAnimation(),this.event.on(rE.AFTER_DO_RENDER,this._enableAnimationHook),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runTreemapTransform()}enableMarkAnimation(){this.getMarks().forEach(t=>{}),[this._labelMark,this._nonLeafLabelMark].forEach(t=>{t&&t.getComponent()&&t.getComponent().getProduct().getGroupGraphicItem().enableAnimation()}),this.event.off(rE.AFTER_DO_RENDER,this._enableAnimationHook)}disableMarkAnimation(){this.getMarks().forEach(t=>{}),[this._labelMark,this._nonLeafLabelMark].forEach(t=>{t&&t.getComponent()&&t.getComponent().getProduct().getGroupGraphicItem().disableAnimation()})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._nonLeafMark,this._leafMark]}getMarkData(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t}}At.type=rw.treemap,At.mark=kJ,At.builtInTheme={treemap:{gapWidth:1,nodePadding:[5],nonLeaf:{visible:!1,style:{fillOpacity:.5}},label:{style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},nonLeafLabel:{padding:24,style:{fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},textBaseline:"middle",textAlign:"center"}}}},At.transformerConstructor=k2,cD(At,kv),cD(At,_j);let Ae=()=>{k3(),k5(),m4(),bk(),k1(),uJ(),ig.registerSeries(At.type,At)};class Ai extends fB{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","aspectRatio","splitType","maxDepth","gapWidth","nodePadding","minVisibleArea","minChildrenVisibleArea","minChildrenVisibleSize","roam","drill","drillField","leaf","nonLeaf","nonLeafLabel"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class Ar extends fF{constructor(){super(...arguments),this.transformerConstructor=Ai,this.type="treemap",this.seriesType=rw.treemap}}Ar.type="treemap",Ar.seriesType=rw.treemap,Ar.transformerConstructor=Ai;let As=()=>{mg(),Ae(),ig.registerChart(Ar.type,Ar)},An=`${s6}_waterfall_default_seriesField`,Aa=(t,e)=>{if(!t||0===t.length)return t;let{indexField:i,total:r,groupData:s}=e,n=[],{dimensionValues:a,dimensionData:l}=s().latestData,o=Array.from(a[i]),h={start:0,end:0,positive:0,negative:0,lastIndex:null};return o.forEach((t,i)=>{let s={start:h.end,end:h.end,lastIndex:h.lastIndex,lastEnd:h.end,index:t,isTotal:!1,positive:h.end,negative:h.end},a=!0===e.stackInverse?l[t].reverse():l[t];if(null==a||a.forEach((t,e)=>{e===a.length-1?t[ng]=!0:delete t[ng]}),a.length>1){let l=t=>{if(r&&"end"!==r.type){if("field"===r.type||"custom"===r.type)return!!t[r.tagField]}else if(i===o.length-1)return!0;return!1};if(a.some(t=>l(t)))return h=function(t,e,i,r,s,n,a,l,o){i.isTotal=!0;let{valueField:h,startAs:u,endAs:d,total:c}=l,p=[],g=[];if(t.forEach(t=>{o(t)?g.push(t):p.push(t)}),g.length===t.length){let o=Al([t[0]],e,i,r,s,n,a,l);return g.forEach(e=>{e[u]=t[0][u],e[d]=t[0][d],e[h]=t[0][h]}),o}let{start:f,end:m}=Ao(g[0],i,r,s,c);i.start=f,i.end=m;let y=f,_=f,v=m-f;return p.forEach(t=>{let e=+t[h];e>=0?(t[u]=+y,y=dC(y,e)):(t[u]=+_,_=dC(_,e)),t[d]=dC(t[u],e),f=dC(f,e),v=dE(v,e)}),g.forEach(t=>{t[u]=+f,t[d]=dC(t[u],v),t[h]=v}),Object.assign(Object.assign({},i),{lastIndex:e})}(a,t,s,n,h,o,i,e,l),void n.push(s)}h=Al(a,t,s,n,h,o,i,e),n.push(s)}),n};function Al(t,e,i,r,s,n,a,l){let{valueField:o,startAs:h,endAs:u,total:d,seriesField:c,seriesFieldName:p}=l;return t.forEach(t=>{let e=!1;if(d&&"end"!==d.type){if(("field"===d.type||"custom"===d.type)&&t[d.tagField]){e=!0;let{start:n,end:a}=Ao(t,i,r,s,d);t[h]=n,t[u]=a,t[o]=a-n,i.start=n,i.end=a}}else a===n.length-1&&(i.start=0,t[h]=i.start,t[u]=i.end,e=!0);if(!e){let e=+t[o];e>=0?(t[h]=+i.positive,i.positive=dC(i.positive,e)):(t[h]=+i.negative,i.negative=dC(i.negative,e)),t[u]=dC(t[h],e),i.end=dC(i.end,e)}i.isTotal=e,(et(c)||c===An)&&(t[An]=e?p.total:+t[o]>=0?p.increase:p.decrease)}),Object.assign(Object.assign({},i),{lastIndex:e})}function Ao(t,e,i,r,s){var n,a,l,o,h;let u,d;return s&&"end"!==s.type?"field"===s.type||"custom"===s.type?"custom"===s.type?(n=t,a=r,s.product(n,a)):s.collectCountField&&!et(t[s.collectCountField])?function(t,e,i,r){let s=0,n=i.end,a=e.length-t[r.collectCountField],l=e.length-1;return a<0?eI("total.collectCountField error"):s=e[a].start,l<0?eI("total.collectCountField error"):n=e[l].end,{start:s,end:n}}(t,i,e,s):(l=t,o=e,h=s,u=0,d=o.end,h.startField&&!et(l[h.startField])&&(u=+l[h.startField]),h.valueField&&!et(l[h.valueField])&&(d=dC(u,+l[h.valueField])),{start:u,end:d}):{start:0,end:0}:{start:0,end:e.end}}let Ah=(t,e)=>{if(!t)return t;let{indexField:i,valueField:r,total:s,seriesField:n}=e,a={[i]:(null==s?void 0:s.text)||"total",[r]:t.reduce((t,e)=>dC(t,+e[r]),0)};return n&&(a[n]="total"),t.push(a),t},Au={type:"fadeIn"},Ad={type:"growCenterIn"},Ac=()=>{ig.registerAnimation("waterfall",(t,e)=>({appear:function(t,e){switch(e){case"fadeIn":return Au;case"scaleIn":return Ad;default:return m$(t,!1)}}(t,e),enter:m$(t,!1),exit:mY(t,!1),disappear:mY(t,!1)}))},Ap=Object.assign(Object.assign({},m7),{leaderLine:{name:"leaderLine",type:"rule"},stackLabel:{name:"stackLabel",type:"text"}}),Ag=(t,e)=>{if(!e.fields)return t;let i={};return{dimensionValues:i,dimensionData:function t(e,i,r){var s,n;if(0===i.length)return e;let a=i[0],l=i.slice(1);r[a]=new Set;let o=function(t,e,i){let r={};return t.forEach(t=>{let s=t[e];r[s]||(r[s]=[],i.add(s)),r[s].push(t)}),r}(e,a,r[a]);return l.length?(s=o,n=(e,i)=>t(e,l,r),Object.keys(s).reduce((t,e)=>(t[e]=n(s[e],e),t),{})):o}(t.map(t=>t.latestData).flat(),e.fields,i)}};class Af{get fields(){return this._fields}get groupData(){return this._groupData}constructor(t){this._fields=[],this._fields=t}initData(t,e){let i=t.name,r=new er(e instanceof tZ?e:t.dataSet);r.name=i,r.parse([t],{type:"dataview"}),sY(e,"dimensionTree",Ag),r.transform({type:"dimensionTree",options:{fields:this._fields}},!1),r.target.addListener("change",this.groupDataUpdate.bind(this)),this._groupData=r}groupDataUpdate(){}getGroupValueInField(t){var e,i,r;let s=null==(r=null==(i=null==(e=this.groupData)?void 0:e.latestData)?void 0:i.dimensionValues)?void 0:r[t];return s?Array.from(s):[]}}class Am extends m9{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){this._addMarkLabelSpec(t,"bar"),this._addMarkLabelSpec(t,"bar","stackLabel","initStackLabelMarkStyle")}}let Ay={rect:Ax,symbol:Ab,arc:AS,point:function(t){let{labelSpec:e}=t;return{position:"center",overlap:!1!==e.overlap&&{clampForce:!1,avoidBaseMark:!1}}},"line-data":function(t){let e=Ab(t);return t$(e.overlap)||(e.overlap.avoidBaseMark=!1,e.overlap.clampForce=!1),e},stackLabel:Ak,line:AA,area:AA,rect3d:Ax,arc3d:AS,treemap:function(t){return{customLayoutFunc:(t,e)=>e,overlap:!1}},venn:function(t){return{customLayoutFunc:(t,e)=>e,smartInvert:!0}}};function A_(t,e,i,r){var s,n;let{labelMark:a,series:l}=t,o=l.getMeasureField()[0],h=a.getAttributesOfState(e);if("text"in h||(h.text=null!=(s=h.text)?s:e[o]),"textType"in h||(h.textType=null!=(n=t.labelSpec.textType)?n:"text"),h.data=e,l.type!==rw.sankey){let{formatFunc:t,args:s}=dJ(i,r,h.text,e);t&&(h._originText=h.text,h.text=t(...s,{series:l}))}return h}function Av(t){return tK(t)?e=>t(e.data):t}function Ab(t){var e,i,r;let s,{series:n,labelSpec:a}=t,l="horizontal"===n.direction?"right":"top",o=null!=(e=Av(a.position))?e:l;return s=!1!==a.overlap&&{strategy:null!=(r=null==(i=a.overlap)?void 0:i.strategy)?r:[{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}],avoidBaseMark:"center"!==o},{position:o,overlap:s}}function Ax(t){var e,i,r,s,n,a,l;let{series:o,labelSpec:h={}}=t,u=null!=(e=Av(h.position))?e:"outside",d=null!=(i=o.direction)?i:"vertical",c="horizontal"===o.direction?null==(r=o.getXAxisHelper())?void 0:r.isInverse():null==(s=o.getYAxisHelper())?void 0:s.isInverse(),p,g=u;g=t=>{var e;let{data:i}=t,r=null!=(e="function"==typeof h.position?h.position(i):h.position)?e:"outside";if("outside"===r){let t=o.getMeasureField()[0];return({vertical:["top","bottom"],horizontal:["right","left"]})[d][(null==i?void 0:i[t])>=0&&c||(null==i?void 0:i[t])<0&&!c?1:0]}return r},p=!1!==h.overlap&&{strategy:null!=(a=null==(n=h.overlap)?void 0:n.strategy)?a:(l=o,[{type:"position",position:t=>{var e,i;let{data:r}=t,s=l.getMeasureField()[0];return("horizontal"===l.direction?null==(e=l.getXAxisHelper())?void 0:e.isInverse():null==(i=l.getYAxisHelper())?void 0:i.isInverse())?(null==r?void 0:r[s])>=0?"horizontal"===l.direction?["left","inside-left"]:["bottom","inside-bottom"]:"horizontal"===l.direction?["right","inside-right"]:["top","inside-top"]:(null==r?void 0:r[s])>=0?"horizontal"===l.direction?["right","inside-right"]:["top","inside-top"]:"horizontal"===l.direction?["left","inside-left"]:["bottom","inside-bottom"]}}])};let f=!1;return t3(u)&&u.includes("inside")&&(f=!0),{position:g,overlap:p,smartInvert:f}}function AS(t){var e;let i,{labelSpec:r}=t,s=null!=(e=Av(r.position))?e:"outside";return i=r.smartInvert?r.smartInvert:t3(s)&&s.includes("inside"),{position:s,smartInvert:i}}function Ak(t,e,i){let r=t.series,s=t.labelSpec||{},n=r.getTotalData();return{customLayoutFunc:n=>n.map(n=>{let a=s.position||"withChange",l=s.offset||0,o=e?e(n.data):n.data,h=A_(t,o,s.formatMethod);return h.x="horizontal"===r.direction?"middle"===a?.5*(r.totalPositionX(o,"end")+r.totalPositionY(o,"start")):"max"===a?r.totalPositionX(o,o.end>=o.start?"end":"start")+l:"min"===a?r.totalPositionX(o,o.end>=o.start?"start":"end")-l:r.totalPositionX(o,"end")+(o.end>=o.start?l:-l):r.totalPositionX(o,"index",.5),h.y="horizontal"===r.direction?r.totalPositionY(o,"index",.5):"middle"===a?.5*(r.totalPositionY(o,"end")+r.totalPositionY(o,"start")):"max"===a?r.totalPositionY(o,o.end>=o.start?"end":"start")-l:"min"===a?r.totalPositionY(o,o.end>=o.start?"start":"end")+l:r.totalPositionY(o,"end")+(o.end>=o.start?-l:l),"horizontal"===r.direction?h.textAlign="middle"===a?"center":"withChange"===a&&o.end-o.start>=0||"max"===a?"left":"right":h.textBaseline="middle"===a?a:"withChange"===a&&o.end-o.start>=0||"max"===a?"bottom":"top",null==i||i(n,o,h),(0,gN.r)(Object.assign(Object.assign({},h),{id:n.id}))}),dataFilter:t=>{let e=[];return n.forEach(i=>{let s=t.find(t=>{var e;return i.index===(null==(e=t.data)?void 0:e[r.getDimensionField()[0]])});s&&(s.data=i,e.push(s))}),e},overlap:{strategy:[]}}}function AA(t){var e,i,r,s;let{labelSpec:n,series:a}=t,l=null==(r=null==(i=null==(e=a.getViewDataStatistics)?void 0:e.call(a).latestData)?void 0:i[a.getSeriesField()])?void 0:r.values,o=l?l.map((t,e)=>({[a.getSeriesField()]:t,index:e})):[{index:0,[nr]:a.getSeriesKeys()[0]}];return{position:null!=(s=n.position)?s:"end",data:o,overlap:{avoidBaseMark:!1,clampForce:!1}}}class AM extends m8{constructor(){super(...arguments),this.type=rw.waterfall,this.transformerConstructor=Am,this._leaderLineMark=null,this._stackLabelMark=null,this._labelMark=null}getTotalData(){var t;return null==(t=this._totalData)?void 0:t.getLatestData()}initGroups(){let t=this.getGroupFields();t&&t.length&&(this._groups=new Af(t),this._data&&this._groups.initData(this._data.getDataView(),this._dataSet))}setAttrFromSpec(){super.setAttrFromSpec(),this.setValueFieldToStack(),this._fieldX=[this._fieldX[0]],this._fieldY=[this._fieldY[0]],et(this._seriesField)&&(this._seriesField=An)}getSeriesKeys(){return this._seriesField===An?[this._theme.seriesFieldName.increase,this._theme.seriesFieldName.decrease,this._theme.seriesFieldName.total]:super.getSeriesKeys()}initData(){var t;super.initData(),sY(this._dataSet,"waterfallFillTotal",Ah),sY(this._dataSet,"waterfall",Aa),(et(this._spec.total)||"end"===this._spec.total.type)&&(null==(t=this._rawData)||t.transform({type:"waterfallFillTotal",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,total:this._spec.total,stackInverse:this.getRegion().getStackInverse()}},!1));let e=s1(this.getViewData(),this._dataSet,{name:`${s6}_series_${this.id}_totalData`});this.getViewData().target.removeListener("change",e.reRunAllTransform),this._totalData=new ly(this._option,e),e.transform({type:"waterfall",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,startAs:na,endAs:nl,total:this._spec.total,groupData:()=>this.getGroups().groupData,stackInverse:this.getRegion().getStackInverse()}},!1)}compileData(){var t;super.compileData(),null==(t=this._totalData)||t.compile()}initAnimation(){var t,e,i,r;let s={yField:"horizontal"===this.direction?this._fieldY[0]:this.getStackValueField(),xField:"horizontal"===this.direction?this.getStackValueField():this._fieldX[0],direction:this.direction,growFrom:()=>{var t,e;return"horizontal"===this.direction?null==(t=this._xAxisHelper)?void 0:t.getScale(0).scale(0):null==(e=this._yAxisHelper)?void 0:e.getScale(0).scale(0)}},n=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset,a=cE(this);this._barMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("waterfall"))?void 0:i(s,n),cb("bar",this._spec,this._markAttributeContext),a)),this._leaderLineMark&&this._leaderLineMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("fadeInOut"))?void 0:r(),cb("leaderLine",this._spec,this._markAttributeContext)))}viewDataUpdate(t){this._totalData.getDataView().reRunAllTransform(),this._totalData.updateData(),super.viewDataUpdate(t)}addViewDataFilter(t){}reFilterViewData(){}onEvaluateEnd(t){super.onEvaluateEnd(t),this._totalData.updateData()}initMark(){super.initMark();let t=this._createMark(AM.mark.leaderLine,{key:"index"});t&&(this._leaderLineMark=t,t.setData(this._totalData))}initLabelMarkStyle(t){var e;if(t)return!this._labelMark&&(null==(e=this._spec.label)?void 0:e.visible)?(super.initLabelMarkStyle(t),void(this._labelMark=t)):void 0}initStackLabelMarkStyle(t){t&&(this._stackLabelMark=t,t.skipEncode=!0,t.setRule("stackLabel"),t.setData(this._totalData),this.setMarkStyle(t,{text:t=>{var e;return"absolute"===(null==(e=this._spec.stackLabel)?void 0:e.valueType)?t.end:dE(t.end,t.start)}}))}initTotalLabelMarkStyle(t){this.setMarkStyle(t,{text:t=>{var e;return"end"in t?"absolute"===(null==(e=this._spec.totalLabel)?void 0:e.valueType)?t.end:dE(t.end,t.start):"horizontal"===this.direction?t[this._fieldX[0]]:t[this._fieldY[0]]}})}getTotalLabelComponentStyle(t){return Ak(Object.assign(Object.assign({},t),{series:this,labelSpec:this._spec.totalLabel}),t=>{let e="vertical"===this.direction?t[this._fieldX[0]]:t[this._fieldY[0]];return this._totalData.getLatestData().find(t=>t.index===e)})}totalPositionX(t,e,i=.5){let{dataToPosition:r,getBandwidth:s}=this._xAxisHelper;return"horizontal"===this._direction?lr(r([t[e]],{bandPosition:this._bandPosition})):r([t[e]],{bandPosition:this._bandPosition})+.5*s(0)-this._barMark.getAttribute("width",t)*(.5-i)}totalPositionY(t,e,i=.5){let{dataToPosition:r,getBandwidth:s}=this._yAxisHelper;return"horizontal"===this._direction?r([t[e]],{bandPosition:this._bandPosition})+.5*s(0)-this._barMark.getAttribute("height",t)*(.5-i):lr(r([t[e]],{bandPosition:this._bandPosition}))}initMarkStyle(){super.initMarkStyle(),this._leaderLineMark&&("horizontal"===this._direction?this.setMarkStyle(this._leaderLineMark,{visible:t=>this.isVisibleLeaderLine(t),x:t=>this.totalPositionX(t,"lastEnd",0),x1:t=>this.totalPositionX(t,t.isTotal?"end":"start",0),y:t=>t.lastIndex?this.totalPositionY(t,"lastIndex",1):0,y1:t=>this.totalPositionY(t,"index",0)},"normal",H.Series):this.setMarkStyle(this._leaderLineMark,{visible:t=>this.isVisibleLeaderLine(t),x:t=>t.lastIndex?this.totalPositionX(t,"lastIndex",1):0,x1:t=>this.totalPositionX(t,"index",0),y:t=>this.totalPositionY(t,"lastEnd",0),y1:t=>this.totalPositionY(t,t.isTotal?"end":"start",0)},"normal",H.Series))}isVisibleLeaderLine(t){return!et(t.lastIndex)&&function(t,e,i){if(!e)return!0;e.range();let r=e.range().map(t=>e.invert(t)),s=Math.min(r[0],r[r.length-1]),n=Math.max(r[0],r[r.length-1]);return Array.isArray(t)?t.every(t=>t>=s&&t<=n):t>=s&&t<=n}([t.lastEnd,t[t.isTotal?"end":"start"]],"horizontal"===this.direction?this._xAxisHelper.getScale(0):this._yAxisHelper.getScale(0))}}AM.type=rw.waterfall,AM.mark=Ap,AM.builtInTheme={waterfall:{seriesFieldName:{total:"total",increase:"increase",decrease:"decrease"},leaderLine:{style:{stroke:"black",lineWidth:1,lineDash:[4,4]}},stackLabel:{visible:!0,offset:12,position:"withChange",style:{fill:"black",fontSize:{type:"token",key:"l4FontSize"}}},label:{visible:!1,offset:12,position:"inside",style:{lineWidth:2}}}},AM.transformerConstructor=Am;let Aw=()=>{bp(),m4(),Ac(),uJ(),g8(),fc(),ig.registerSeries(AM.type,AM)};class AT extends ye{transformSpec(t){super.transformSpec(t),t.legends&&eo(t.legends).forEach(t=>{t.select=!1,t.hover=!1,t.filter=!1}),nF(t)}_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return e.bar=t.bar,e.stackLabel=t.stackLabel,e.leaderLine=t.leaderLine,e.total=t.total,e}}class AC extends yi{constructor(){super(...arguments),this.transformerConstructor=AT,this.type="waterfall",this.seriesType=rw.waterfall}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}AC.type="waterfall",AC.seriesType=rw.waterfall,AC.transformerConstructor=AT;let AE=()=>{mc(),mg(),mm(),f0(),fW(),Aw(),ig.registerChart(AC.type,AC)},AB=`${s6}_BOX_PLOT_OUTLIER_VALUE`;(I=Q||(Q={})).OUTLIER="outlier",I.MAX="max",I.MIN="min",I.MEDIAN="median",I.Q1="q1",I.Q3="q3",I.SERIES_FIELD="seriesField";let AP=(t,e)=>{let i=[],{outliersField:r,dimensionField:s}=e;return(t[0].latestData||[]).forEach(t=>{let e=t[r];tY(e)||(e=[e]),i.push(...e.map(e=>{let i={[AB]:e};return s.forEach(e=>{i[e]=t[e]}),i}))}),i};class AO extends d8{constructor(){super(...arguments),this.getContentKey=t=>e=>{if(this.isOutlierMark(e))return t===Q.OUTLIER?this.series.getOutliersField():t===Q.SERIES_FIELD?this.series.getSeriesField():null;switch(t){case Q.MIN:return this.series.getMinField();case Q.MAX:return this.series.getMaxField();case Q.MEDIAN:return this.series.getMedianField();case Q.Q1:return this.series.getQ1Field();case Q.Q3:return this.series.getQ3Field();case Q.SERIES_FIELD:return this.series.getSeriesField()}return null},this.getContentValue=t=>e=>{if(this.isOutlierMark(e))return t===Q.OUTLIER?e[AB]:t===Q.SERIES_FIELD?e[this.series.getSeriesField()]:null;switch(t){case Q.MIN:return e[this.series.getMinField()];case Q.MAX:return e[this.series.getMaxField()];case Q.MEDIAN:return e[this.series.getMedianField()];case Q.Q1:return e[this.series.getQ1Field()];case Q.Q3:return e[this.series.getQ3Field()];case Q.SERIES_FIELD:return e[this.series.getSeriesField()]}return null},this.shapeColorCallback=t=>"line"===this.series.getShaftShape()?this.series.getMarkInName("boxPlot").getAttribute("stroke",t):this.series.getMarkInName("boxPlot").getAttribute("fill",t),this.getOutlierFillColor=t=>{var e,i;let r=this.series.getOutliersStyle();return null!=(e=null==r?void 0:r.fill)?e:null==(i=this.series.getMarkInName("outlier"))?void 0:i.getAttribute("fill",t)},this.isOutlierMark=t=>t5(t[AB])}getDefaultContentList(t){return[{key:this.getContentKey(Q.OUTLIER),value:this.getContentValue(Q.OUTLIER),shapeType:this.shapeTypeCallback,shapeColor:this.getOutlierFillColor,shapeStroke:this.getOutlierFillColor},{key:this.getContentKey(Q.MAX),value:this.getContentValue(Q.MAX)},{key:this.getContentKey(Q.Q3),value:this.getContentValue(Q.Q3)},{key:this.getContentKey(Q.MEDIAN),value:this.getContentValue(Q.MEDIAN)},{key:this.getContentKey(Q.Q1),value:this.getContentValue(Q.Q1)},{key:this.getContentKey(Q.MIN),value:this.getContentValue(Q.MIN)},{key:this.getContentKey(Q.SERIES_FIELD),value:this.getContentValue(Q.SERIES_FIELD)}]}}class AI extends mv.zs{constructor(t){super(t),this.type="glyph",this.numberType=oW.Nd,this.subGraphic=[],this._onInit&&this._onInit(this),this.valid=this.isValid()}setSubGraphic(t){this.detachSubGraphic(),this.subGraphic=t,t.forEach(t=>{t.glyphHost=this,Object.setPrototypeOf(t.attribute,this.attribute)}),this.valid=this.isValid(),this.addUpdateBoundTag()}detachSubGraphic(){this.subGraphic.forEach(t=>{t.glyphHost=null,Object.setPrototypeOf(t.attribute,{})})}getSubGraphic(){return this.subGraphic}onInit(t){this._onInit=t}onUpdate(t){this._onUpdate=t}isValid(){return!0}setAttribute(t,e,i,r){super.setAttribute(t,e,i,r),this.subGraphic.forEach(t=>{t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()})}setAttributes(t,e=!1,i){super.setAttributes(t,e,i),this.subGraphic.forEach(t=>{t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()})}translate(t,e){return super.translate(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}translateTo(t,e){return super.translateTo(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}scale(t,e,i){return super.scale(t,e,i),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}scaleTo(t,e){return super.scaleTo(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}rotate(t){return super.rotate(t),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}rotateTo(t){return super.rotate(t),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}getGraphicTheme(){return(0,uo.gh)(this).glyph}updateAABBBounds(t,e,i){return this.getSubGraphic().forEach(t=>{i.union(t.AABBBounds)}),i}doUpdateAABBBounds(){this.updateAABBBoundsStamp++,this._AABBBounds.clear();let t=this.updateAABBBounds(this.attribute,this.getGraphicTheme(),this._AABBBounds);return this.clearUpdateBoundTag(),t}needUpdateTags(t){return!1}needUpdateTag(t){return!1}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!((null==(i=this.currentStates)?void 0:i.length)!==t.length||t.some((t,e)=>this.currentStates[e]!==t)))return;this.stopStateAnimates();let r={},s=this.subGraphic.map(()=>({}));t.forEach(e=>{var i;let n=this.glyphStateProxy?this.glyphStateProxy(e,t):this.glyphStates[e];n&&(Object.assign(r,n.attributes),(null==(i=n.subAttributes)?void 0:i.length)&&s.forEach((t,e)=>{Object.assign(t,n.subAttributes[e])}))}),this.subGraphic.forEach((i,r)=>{i.updateNormalAttrs(s[r]),i.applyStateAttrs(s[r],t,e)}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}clearStates(t){this.stopStateAnimates(),this.hasState()&&this.normalAttrs?(this.currentStates=[],this.subGraphic.forEach(e=>{e.applyStateAttrs(e.normalAttrs,this.currentStates,t,!0),e.normalAttrs=null}),this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}clone(){let t=new AI(Object.assign({},this.attribute));return t.setSubGraphic(this.subGraphic.map(t=>t.clone())),t}getNoWorkAnimateAttr(){return AI.NOWORK_ANIMATE_ATTR}}function AR(t){return new AI(t)}AI.NOWORK_ANIMATE_ATTR=mv.Wl;let AL=class{constructor(){this.numberType=oW.Nd}reInit(){}drawShape(t,e,i,r,s,n,a,l){s.drawContribution&&t.getSubGraphic().forEach(t=>{let o=s.drawContribution.getRenderContribution(t);o&&o.drawShape&&o.drawShape(t,e,i,r,s,n,a,l)})}draw(t,e,i,r){let{context:s}=i;if(!s||(s.highPerformanceSave(),!i.drawContribution))return;let n=(0,uo.gh)(t),a=t.getSubGraphic();a.length&&a.forEach(t=>{i.drawContribution.renderItem(t,i,{theme:n})}),s.highPerformanceRestore()}};AL=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)()],AL);let AD=!1,AF=new oy.n(t=>{AD||(AD=!0,t(oU.FU).to(AL).inSingletonScope(),t(oU.uz).toService(oU.FU))}),Az=class extends oK{constructor(t){super(),this.canvasRenderer=t}};Az=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)(),(R=(0,oC.f)(oU.FU),function(t,e){R(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Az);let Aj=!1,AH=new oy.n((t,e,i,r)=>{Aj||(Aj=!0,t(oz.Se).to(Az).inSingletonScope(),t(oz.EL).toService(oz.Se))});function AN(){AN.__loaded||(AN.__loaded=!0,c$.i.RegisterGraphicCreator("glyph",AR),of.n.load(AF),of.n.load(mE.X?AH:oJ))}AN.__loaded=!1;class AV extends oa{constructor(){super(...arguments),this._setStateOfGraphic=t=>{t.clearStates(),t.stateProxy=null,t.context.diffState!==N.enter&&t.context.diffState!==N.update||(t.glyphStateProxy=(e,i)=>{var r;let s={attributes:Object.assign(Object.assign({},this._runEncoderOfGraphic(null==(r=this._encoderOfState)?void 0:r[e],t)),t.runtimeStateCache?t.runtimeStateCache[e]:null)};return t.glyphStates?t.glyphStates[e]||(t.glyphStates[e]=s):t.glyphStates={[e]:s},s},t.useStates(t.context.states))}}getSubMarks(){return this._subMarks}setGlyphConfig(t){this._glyphConfig=t}getGlyphConfig(){return this._glyphConfig}getPositionChannels(){return this._positionChannels}_onGlyphAttributeUpdate(t){return e=>{var i,r;let s=this.getPositionChannels(),n=s&&this._positionEncoder&&Object.keys(e).some(t=>s.includes(t))?this._positionEncoder(e,null==(r=null==(i=null==t?void 0:t.context)?void 0:i.data)?void 0:r[0],t):null;return this._channelEncoder&&Object.keys(this._channelEncoder).forEach(t=>{if(t in e){let i=this._channelEncoder[t](e[t]);n=n?t8(n,i):i}}),n&&t.getSubGraphic().forEach(t=>{t&&n[t.name]&&t.setAttributes(n[t.name])}),e}}_createGraphic(t={}){let e=AR(t);e.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(e);let i=this._subMarks;if(i){let t=[];Object.keys(i).forEach(e=>{let r=ig.createGraphicComponent(i[e].type,Object.assign({},i[e].defaultAttributes));r&&(t.push(r),r.name=e,r.onBeforeAttributeUpdate=t=>t)}),e.setSubGraphic(t)}return e.onBeforeAttributeUpdate(t),e}_runProgressiveEncoder(t){this._runEncoder(t)}}let AW=()=>{ig.registerGraphicComponent("glyph",AR),(0,ol.W)(),AN()},AU=["x","y","minMaxWidth","minMaxHeight","q1q3Width","q1q3Height","q1","q3","min","max","median","angle"],AG=["x","y","boxWidth","boxHeight","ruleWidth","ruleHeight","q1","q3","min","max","median","angle"];class AZ extends AV{constructor(){super(...arguments),this.type=AZ.type}_isHorizontal(){return this._glyphConfig&&"horizontal"===this._glyphConfig.direction}setGlyphConfig(t){super.setGlyphConfig(t),"bar"===t.shaftShape?(this._subMarks={minMaxBox:{type:"rect",defaultAttributes:{lineWidth:0}},q1q3Box:{type:"rect",defaultAttributes:{lineWidth:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=AU,this._channelEncoder={minMaxFillOpacity:t=>({minMaxBox:{fillOpacity:t}}),lineWidth:t=>({minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0}}),stroke:t=>({minMaxBox:{stroke:!1},q1q3Box:{stroke:!1}})},this._positionEncoder=(t,e,i)=>{var r;let{x:s=i.attribute.x,y:n=i.attribute.y,minMaxWidth:a=i.attribute.minMaxWidth,minMaxHeight:l=i.attribute.minMaxHeight,q1q3Width:o=i.attribute.q1q3Width,q1q3Height:h=i.attribute.q1q3Height,q1:u=i.attribute.q1,q3:d=i.attribute.q3,min:c=i.attribute.min,max:p=i.attribute.max,median:g=i.attribute.median,angle:f}=t,m=this._isHorizontal(),y={};if(m?(y.minMaxBox={x:c,x1:p,y:n-l/2,y1:n+l/2},y.q1q3Box={x:u,x1:d,y:n-h/2,y1:n+h/2},y.median={points:[{x:g,y:n-h/2},{x:g,y:n+h/2}]}):(y.minMaxBox={y:c,y1:p,x:s-a/2,x1:s+a/2},y.q1q3Box={y:u,y1:d,x:s-o/2,x1:s+o/2},y.median={points:[{y:g,x:s-o/2},{y:g,x:s+o/2}]}),ee(f)){let e=null!=(r=t.anchor)?r:m?[(c+p)/2,n]:[s,(c+p)/2];Object.keys(y).forEach(t=>{y[t].angle=f,y[t].anchor=e})}return y}):(this._subMarks={shaft:{type:"line",defaultAttributes:{x:0,y:0}},box:{type:"rect"},max:{type:"line",defaultAttributes:{x:0,y:0}},min:{type:"line",defaultAttributes:{x:0,y:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=AG,this._channelEncoder=null,this._positionEncoder=(t,e,i)=>{var r;let{x:s=i.attribute.x,y:n=i.attribute.y,boxWidth:a=i.attribute.boxWidth,boxHeight:l=i.attribute.boxHeight,ruleWidth:o=i.attribute.ruleWidth,ruleHeight:h=i.attribute.ruleHeight,q1:u=i.attribute.q1,q3:d=i.attribute.q3,min:c=i.attribute.min,max:p=i.attribute.max,median:g=i.attribute.median,angle:f}=t,m=this._isHorizontal(),y={};if(m?(y.box={x:u,x1:d,y:n-l/2,y1:n+l/2},y.median={points:[{x:g,y:n-l/2},{x:g,y:n+l/2}]},y.shaft={points:[{x:c,y:n},{x:p,y:n}]},y.max={points:[{x:p,y:n-h/2},{x:p,y:n+h/2}]},y.min={points:[{x:c,y:n-h/2},{x:c,y:n+h/2}]}):(y.box={x:s-a/2,x1:s+a/2,y:u,y1:d},y.median={points:[{x:s-a/2,y:g},{x:s+a/2,y:g}]},y.max={points:[{x:s-o/2,y:p},{x:s+o/2,y:p}]},y.min={points:[{x:s-o/2,y:c},{x:s+o/2,y:c}]},y.shaft={points:[{x:s,y:c},{x:s,y:p}]}),ee(f)){let e=null!=(r=t.anchor)?r:m?[(c+p)/2,n]:[s,(c+p)/2];Object.keys(y).forEach(t=>{y[t].angle=f,y[t].anchor=e})}return y})}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:2,boxWidth:30,shaftWidth:20,shaftShape:"line"})}}AZ.type="boxPlot";let A$=()=>{AW(),(0,cG.N)(),(0,mJ.k)(),ig.registerGraphicComponent("line",t=>(0,cU.W)(t)),ig.registerGraphicComponent("rect",t=>(0,m3.f)(t)),ig.registerMark(AZ.type,AZ)},AY=Object.assign(Object.assign({},cd),{boxPlot:{name:"boxPlot",type:"boxPlot"},outlier:{name:"outlier",type:"symbol"}}),AX=t=>(e,i,r)=>{var s;let n=e.getFinalAttribute(),a=t(e,null!=(s=n.direction)?s:"vertical",i);if(!ee(a))return{};let{x:l,y:o,min:h,max:u,q1:d,q3:c,median:p}=n,g={from:{x:l,y:o},to:{x:l,y:o}};return ee(h)&&(g.from.min=a,g.to.min=h),ee(u)&&(g.from.max=a,g.to.max=u),ee(d)&&(g.from.q1=a,g.to.q1=d),ee(c)&&(g.from.q3=a,g.to.q3=c),ee(p)&&(g.from.median=a,g.to.median=p),g},AK=t=>(e,i,r)=>{var s;let n=e.getFinalAttribute(),a=t(e,null!=(s=n.direction)?s:"vertical",i);if(!ee(a))return{};let{x:l,y:o,min:h,max:u,q1:d,q3:c,median:p}=n,g={from:{x:l,y:o},to:{x:l,y:o}};return ee(h)&&(g.to.min=a,g.from.min=h),ee(u)&&(g.to.max=a,g.from.max=u),ee(d)&&(g.to.q1=a,g.from.q1=d),ee(c)&&(g.to.q3=a,g.from.q3=c),ee(p)&&(g.to.median=a,g.from.median=p),g},Aq=(t,e)=>t.getSubGraphic().find(t=>t.name===e),AQ=(t,e,i)=>{var r,s,n,a,l,o,h,u,d,c,p,g,f,m,y,_,v,b,x,S,k,A;let M,w,T,C,E;if(i&&ee(i.center))return i.center;if("horizontal"===e){M=null==(n=null==(s=(null==(r=Aq(t,"median"))?void 0:r.attribute).points)?void 0:s[0])?void 0:n.x,w=null==(h=null==(o=null==(l=null==(a=Aq(t,"max"))?void 0:a.attribute)?void 0:l.points)?void 0:o[0])?void 0:h.x,T=null==(p=null==(c=null==(d=null==(u=Aq(t,"min"))?void 0:u.attribute)?void 0:d.points)?void 0:c[0])?void 0:p.x;let e=Aq(t,"box").attribute.width,i=Aq(t,"box").attribute.x;C=i,E=i+e}else{M=null==(m=null==(f=(null==(g=Aq(t,"median"))?void 0:g.attribute).points)?void 0:f[0])?void 0:m.y,w=null==(b=null==(v=null==(_=null==(y=Aq(t,"max"))?void 0:y.attribute)?void 0:_.points)?void 0:v[0])?void 0:b.y,T=null==(A=null==(k=null==(S=null==(x=Aq(t,"min"))?void 0:x.attribute)?void 0:S.points)?void 0:k[0])?void 0:A.y;let e=Aq(t,"box").attribute.height,i=Aq(t,"box").attribute.y;C=i,E=i+e}return ee(M)?M:ee(C)&&ee(E)?(C+E)/2:ee(w)&&ee(T)?(w+T)/2:ee(T)?T:ee(w)?w:NaN},AJ=(t,e,i)=>{var r,s,n,a,l,o,h,u,d,c,p,g,f,m;let y,_,v,b,x;if(ee(null==i?void 0:i.center))return i.center;if("horizontal"===e){y=null==(n=null==(s=(null==(r=Aq(t,"median"))?void 0:r.attribute).points)?void 0:s[0])?void 0:n.x;let e=(null==(a=Aq(t,"minMaxBox"))?void 0:a.attribute).width,i=null==(l=Aq(t,"minMaxBox"))?void 0:l.attribute.x;v=i,_=i+e;let u=(null==(o=Aq(t,"q1q3Box"))?void 0:o.attribute).width,d=null==(h=Aq(t,"q1q3Box"))?void 0:h.attribute.x;b=d,x=d+u}else{y=null==(c=null==(d=(null==(u=Aq(t,"median"))?void 0:u.attribute).points)?void 0:d[0])?void 0:c.y;let e=(null==(p=Aq(t,"minMaxBox"))?void 0:p.attribute).height,i=null==(g=Aq(t,"minMaxBox"))?void 0:g.attribute.y;v=i,_=i+e;let r=(null==(f=Aq(t,"q1q3Box"))?void 0:f.attribute).height,s=null==(m=Aq(t,"q1q3Box"))?void 0:m.attribute.y;b=s,x=s+r}return ee(y)?y:ee(b)&&ee(x)?(b+x)/2:ee(_)&&ee(v)?(_+v)/2:ee(v)?v:ee(_)?_:NaN};class A0 extends lZ.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){super.onBind();let t=this.target.getFinalAttribute();t&&this.target.setAttributes(t);let{from:e,to:i}=this.computeAttribute();this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.animate.reSyncProps(),this.from=e,this.to=i,this.target.setAttributes(this.from)}computeAttribute(){return AX(AQ)(this.target,this.params,this.params.options)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}class A1 extends lZ.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t;(null==(t=this.params)?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);let{from:e,to:i}=this.computeAttribute();this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.animate.reSyncProps(),this.from=e,this.to=i,this.target.setAttributes(this.from)}computeAttribute(){return AK(AQ)(this.target,this.params,this.params.options)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}class A2 extends A0{computeAttribute(){return AX(AJ)(this.target,this.params,this.params.options)}}class A3 extends A1{computeAttribute(){return AK(AJ)(this.target,this.params,this.params.options)}}let A5=()=>{uP.a.registerBuiltInAnimate("boxplotScaleIn",A0),uP.a.registerBuiltInAnimate("boxplotScaleOut",A1),uP.a.registerBuiltInAnimate("barBoxplotScaleIn",A2),uP.a.registerBuiltInAnimate("barBoxplotScaleOut",A3)};class A4 extends cB{constructor(){super(...arguments),this.type=rw.boxPlot}getMinField(){return this._minField}getMaxField(){return this._maxField}getQ1Field(){return this._q1Field}getMedianField(){return this._medianField}getQ3Field(){return this._q3Field}getOutliersField(){return this._outliersField}getShaftShape(){return this._shaftShape}getBoxFillColor(){return this._boxFillColor}getStrokeColor(){return this._strokeColor}getOutliersStyle(){return this._outliersStyle}setAttrFromSpec(){var t,e,i,r,s;super.setAttrFromSpec();let n=null!=(e=null==(t=this._spec.boxPlot)?void 0:t.style)?e:{};this._minField=this._spec.minField,this._maxField=this._spec.maxField,this._q1Field=this._spec.q1Field,this._medianField=this._spec.medianField,this._q3Field=this._spec.q3Field,this._outliersField=this._spec.outliersField,this._lineWidth=null!=(i=n.lineWidth)?i:2,this._boxWidth=n.boxWidth,this._shaftShape=null!=(r=n.shaftShape)?r:"line",this._shaftWidth=n.shaftWidth,this._boxFillColor=n.boxFill,this._strokeColor=n.stroke,this._shaftFillOpacity="bar"===this._shaftShape?null!=(s=n.shaftFillOpacity)?s:.5:void 0,this._outliersStyle=this._spec.outliersStyle}initMark(){this._boxPlotMark=this._createMark(A4.mark.boxPlot,{groupKey:this._seriesField,isSeriesMark:!0}),this._outliersField&&(this._outlierMark=this._createMark(A4.mark.outlier,{key:ne,groupKey:this._seriesField,dataView:this._outlierDataView.getDataView(),dataProductId:this._outlierDataView.getProductId()}))}initMarkStyle(){var t,e,i,r,s;let n=this._boxPlotMark;if(n){let i={lineWidth:this._lineWidth,fill:null!=(t=this._boxFillColor)?t:"line"===this._shaftShape?"#FFF":this.getColorAttribute(),minMaxFillOpacity:this._shaftFillOpacity,stroke:null!=(e=this._strokeColor)?e:"line"===this._shaftShape?this.getColorAttribute():"#000"};n.setGlyphConfig({direction:this._direction,shaftShape:this._shaftShape});let r="horizontal"===this._direction?Object.assign(Object.assign({y:this.dataToPositionY.bind(this)},i),{boxHeight:()=>{var t;return null!=(t=this._boxWidth)?t:this._getMarkWidth()},ruleHeight:()=>{var t;return null!=(t=this._shaftWidth)?t:this._getMarkWidth()},q1q3Height:()=>{var t;return null!=(t=this._boxWidth)?t:this._getMarkWidth()},minMaxHeight:()=>{var t;return null!=(t=this._shaftWidth)?t:this._getMarkWidth()}}):Object.assign(Object.assign({x:this.dataToPositionX.bind(this)},i),{boxWidth:()=>{var t;return null!=(t=this._boxWidth)?t:this._getMarkWidth()},ruleWidth:()=>{var t;return null!=(t=this._shaftWidth)?t:this._getMarkWidth()},q1q3Width:()=>{var t;return null!=(t=this._boxWidth)?t:this._getMarkWidth()},minMaxWidth:()=>{var t;return null!=(t=this._shaftWidth)?t:this._getMarkWidth()}});this.setMarkStyle(n,r,V.STATE_NORMAL,H.Series)}let a=this._outlierMark;a&&this.setMarkStyle(a,{fill:null!=(r=null==(i=this._outliersStyle)?void 0:i.fill)?r:this.getColorAttribute(),size:tH(null==(s=this._outliersStyle)?void 0:s.size)?this._outliersStyle.size:10,symbolType:"circle"},V.STATE_NORMAL,H.Series)}initBoxPlotMarkStyle(){var t,e;let i=this._boxPlotMark,r="horizontal"===this._direction?this._xAxisHelper:this._yAxisHelper;if(i&&r){let{dataToPosition:e}=r,s=null==(t=null==r?void 0:r.getScale)?void 0:t.call(r,0);this.setMarkStyle(i,{min:t=>lr(e(this.getDatumPositionValues(t,this._minField),{bandPosition:this._bandPosition}),s),q1:t=>lr(e(this.getDatumPositionValues(t,this._q1Field),{bandPosition:this._bandPosition}),s),median:t=>lr(e(this.getDatumPositionValues(t,this._medianField),{bandPosition:this._bandPosition}),s),q3:t=>lr(e(this.getDatumPositionValues(t,this._q3Field),{bandPosition:this._bandPosition}),s),max:t=>lr(e(this.getDatumPositionValues(t,this._maxField),{bandPosition:this._bandPosition}),s)},V.STATE_NORMAL,H.Series)}let s=this._outlierMark;if(s&&r){let{dataToPosition:t}=r,i=null==(e=null==r?void 0:r.getScale)?void 0:e.call(r,0),n="horizontal"===this._direction?{y:this.dataToPositionY.bind(this),x:e=>lr(t(this.getDatumPositionValues(e,AB),{bandPosition:this._bandPosition}),i)}:{x:this.dataToPositionX.bind(this),y:e=>lr(t(this.getDatumPositionValues(e,AB),{bandPosition:this._bandPosition}),i)};this.setMarkStyle(s,n,V.STATE_NORMAL,H.Series)}}initData(){if(super.initData(),!this._data)return;sY(this._dataSet,"foldOutlierData",AP),sY(this._dataSet,"addVChartProperty",dK);let t=new er(this._dataSet,{name:`${this.type}_outlier_${this.id}_data`});t.parse([this.getViewData()],{type:"dataview"}),t.name=`${s6}_series_${this.id}_outlierData`,t.transform({type:"foldOutlierData",options:{dimensionField:"horizontal"===this._direction?this._fieldY:this._fieldX,outliersField:this._outliersField}}),t.transform({type:"addVChartProperty",options:{beforeCall:cl.bind(this),call:co}},!1),this._outlierDataView=new ly(this._option,t)}compileData(){var t;super.compileData(),null==(t=this._outlierDataView)||t.compile()}init(t){super.init(t),this.initBoxPlotMarkStyle()}_getMarkWidth(){if(this._autoBoxWidth)return this._autoBoxWidth;let t="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,e="horizontal"===this._direction?this._fieldY:this._fieldX,i=t.getBandwidth(e.length-1)/e.length;return this._autoBoxWidth=i,this._autoBoxWidth}onLayoutEnd(){super.onLayoutEnd(),this._autoBoxWidth=null}_initAnimationSpec(t={}){let e=t8({},t);return["appear","enter","update","exit","disappear"].forEach(t=>{e[t]&&"scaleIn"===e[t].type?e[t].type="line"===this._shaftShape?"boxplotScaleIn":"barBoxplotScaleIn":e[t]&&"scaleOut"===e[t].type&&(e[t].type="line"===this._shaftShape?"boxplotScaleOut":"barBoxplotScaleOut")}),e}initAnimation(){var t,e,i,r,s,n,a;let l=cE(this);if(this._boxPlotMark){let e=this._initAnimationSpec(null==(t=ig.getAnimationInKey("scaleInOut"))?void 0:t()),i=this._initAnimationSpec(cb("boxPlot",this._spec,this._markAttributeContext));this._boxPlotMark.setAnimationConfig(cv(e,i,l))}if(this._outlierMark){let t={appear:null==(e=this._spec.animationAppear)?void 0:e.symbol,disappear:null==(i=this._spec.animationDisappear)?void 0:i.symbol,enter:null==(r=this._spec.animationEnter)?void 0:r.symbol,exit:null==(s=this._spec.animationExit)?void 0:s.symbol,update:null==(n=this._spec.animationUpdate)?void 0:n.symbol};this._outlierMark.setAnimationConfig(cv(null==(a=ig.getAnimationInKey("scaleInOut"))?void 0:a(),t,l))}}initTooltip(){this._tooltipHelper=new AO(this),this._boxPlotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._boxPlotMark),this._outlierMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._outlierMark)}getStatisticFields(){let t=super.getStatisticFields(),e=t.find(t=>t.key===this._outliersField);return e&&(e.operations=["array-min","array-max"]),t}onEvaluateEnd(t){super.onEvaluateEnd(t),this._outlierDataView.updateData()}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._boxPlotMark]}}A4.type=rw.boxPlot,A4.builtInTheme={boxPlot:{boxPlot:{style:{lineWidth:1}},label:{style:{lineWidth:2}}}},A4.mark=AY;let A7=()=>{A$(),pF(),uQ(),g8(),fc(),A5(),ig.registerSeries(A4.type,A4)};class A6 extends fP{_getDefaultSeriesSpec(t){var e;let i=[t.maxField,t.medianField,t.q1Field,t.q3Field,t.minField,t.outliersField],r=super._getDefaultSeriesSpec(t,["boxPlot","minField","maxField","q1Field","medianField","q3Field","outliersField","outliersStyle"]);return r.direction=null!=(e=t.direction)?e:"vertical",r["horizontal"===r.direction?"xField":"yField"]=i,r}transformSpec(t){super.transformSpec(t),t.axes||(t.axes=[{orient:"bottom"},{orient:"left"}]),nF(t)}}class A9 extends fF{constructor(){super(...arguments),this.transformerConstructor=A6,this.type="boxPlot",this.seriesType=rw.boxPlot}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}A9.type="boxPlot",A9.seriesType=rw.boxPlot,A9.transformerConstructor=A6;let A8=()=>{mc(),mg(),f0(),fW(),A7(),ig.registerChart(A9.type,A9)},Mt=t=>{let e=0;return t.forEach((t,i)=>{var r;et(t.value)&&((null==(r=t.children)?void 0:r.length)?t.value=Mt(t.children):t.value=0),e+=Math.abs(t.value)}),e};function Me(t){return t.depth}function Mi(t,e){return e-1-t.endDepth}let Mr=(t,e)=>(null==t?void 0:t.y0)-(null==e?void 0:e.y0),Ms=(t,e)=>{if(et(t.value))return null;let i=(e?t.targetLinks:t.sourceLinks).reduce((t,e)=>(et(e.value)?t.count+=1:t.sum+=e.value,t),{sum:0,count:0});return i.count>0?(t.value-i.sum)/i.count:null},Mn={left:Me,right:Mi,justify:function(t,e){return t.sourceLinks.length?t.depth:e-1},center:function(t,e,i){return t.targetLinks.length?t.depth:t.sourceLinks.length?ed(t.sourceLinks.map(t=>i[t.target].depth))-1:0},start:Me,end:Mi},Ma=a0(0,1);class Ml{constructor(t){this._ascendingSourceBreadth=(t,e)=>Mr(this._nodeMap[t.source],this._nodeMap[e.source])||t.index-e.index,this._ascendingTargetBreadth=(t,e)=>Mr(this._nodeMap[t.target],this._nodeMap[e.target])||t.index-e.index,this.options=Object.assign({},Ml.defaultOptions,t);let e=this.options.nodeKey,i=tK(e)?e:e?x3(e):null;this._getNodeKey=i,this._logger=tW.getInstance(),this._alignFunc=tK(this.options.setNodeLayer)?t=>this.options.setNodeLayer(t.datum):Mn[this.options.nodeAlign]}layout(t,e){if(!t)return null;let i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};"vertical"===this.options.direction?this._viewBox={x0:i.y0,x1:i.y1,y0:i.x0,y1:i.x1,width:i.height,height:i.width}:this._viewBox=i;let r=this.computeNodeLinks(t),s=r.nodes,n=r.links;if(this._nodeMap=r.nodeMap,this.computeNodeValues(s),this.computeNodeDepths(s),["right","end","justify"].includes(this.options.nodeAlign)&&this.computeNodeEndDepths(s),this._maxDepth<=0)return null;let a=this.computeNodeBreadths(s);if(this.computeLinkBreadths(s),s.forEach(t=>{t.sourceLinks=t.sourceLinks.filter(t=>!et(t.source)&&!et(t.target)),t.targetLinks=t.targetLinks.filter(t=>!et(t.source)&&!et(t.target))}),n=n.filter(t=>!et(t.source)&&!et(t.target)),"vertical"===this.options.direction)if(this.options.inverse){let t=this._viewBox.x1;s.forEach(e=>{let{y0:i,y1:r,x0:s,x1:n}=e;e.y0=t-n,e.y1=t-s,e.x0=i,e.x1=r}),n.forEach(e=>{e.vertical=!0;let{x0:i,x1:r,y0:s,y1:n}=e;e.x0=s,e.x1=n,e.y0=t-i,e.y1=t-r})}else s.forEach(t=>{let{y0:e,y1:i}=t;t.y0=t.x0,t.y1=t.x1,t.x0=e,t.x1=i}),n.forEach(t=>{t.vertical=!0;let e=t.x0,i=t.x1;t.x0=t.y0,t.x1=t.y1,t.y0=e,t.y1=i});else this.options.inverse&&(s.forEach(t=>{let{x0:e,x1:r}=t;t.x0=i.x1-r,t.x1=i.x1-e}),n.forEach(t=>{t.x0=i.x1-t.x0,t.x1=i.x1-t.x1}));return n.forEach(t=>{let e=this._nodeMap[t.source],i=this._nodeMap[t.target];t.sourceRect={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},t.targetRect={x0:i.x0,x1:i.x1,y1:i.y1,y0:i.y0}}),{nodes:s,links:n,columns:a}}computeHierarchicNodeLinks(t){let e=[],i=[],r={},s={},n=[];Mt(t);let a=(t,i,s)=>{t.forEach((t,l)=>{let o=this._getNodeKey?this._getNodeKey(t):s?`${s[s.length-1].key}-${l}`:`${i}-${l}`,h=et(t.value)?0:kr(t.value);if(r[o])r[o].value=void 0;else{let s={depth:i,datum:t,index:l,key:o,value:h,sourceLinks:[],targetLinks:[]};r[o]=s,e.push(s)}s&&n.push({source:s[s.length-1].key,target:o,value:h,parents:s}),t.children&&t.children.length&&a(t.children,i+1,s?s.concat([r[o]]):[r[o]])})};return a(t,0,null),n.forEach((t,e)=>{let n=`${t.source}-${t.target}`,a=gI(t,["parents"]);if(a.parents=t.parents.map(t=>gI(t,["sourceLinks","targetLinks"])),s[n])return s[n].value+=kr(t.value),void s[n].datum.push(a);let l={index:e,key:`${t.source}-${t.target}`,source:t.source,target:t.target,datum:[a],value:t.value,parents:t.parents.map(t=>t.key)};i.push(l),r[t.source].sourceLinks.push(l),r[t.target].targetLinks.push(l),s[n]=l}),{nodes:e,links:i,nodeMap:r}}computeSourceTargetNodeLinks(t){let e=[],i=[],r={};t.nodes&&t.nodes.forEach((t,i)=>{let s={depth:-1,datum:t,index:i,key:this._getNodeKey?this._getNodeKey(t):i,value:t.value,sourceLinks:[],targetLinks:[]};r[s.key]=s,e.push(s)});let s=[];return t.links.forEach((n,a)=>{let l=!et(n.source),o=!et(n.target);if(t.nodes&&(!r[n.source]||!r[n.target]))return;t.nodes||!l||r[n.source]||(r[n.source]={value:void 0,depth:-1,index:e.length,key:n.source,datum:null,sourceLinks:[],targetLinks:[]},e.push(r[n.source])),t.nodes||!o||r[n.target]||(r[n.target]={value:void 0,depth:-1,index:e.length,key:n.target,datum:null,sourceLinks:[],targetLinks:[]},e.push(r[n.target]));let h={index:a,source:n.source,target:n.target,datum:n,value:n.value};this.options.divideNodeValueToLink&&et(n.value)&&s.push(h),i.push(h),l&&r[n.source].sourceLinks.push(h),o&&r[n.target].targetLinks.push(h)}),this.options.divideNodeValueToLink&&s.length&&s.forEach(t=>{let e=[Ms(r[t.source]),Ms(r[t.target],!0)].filter(t=>!et(t));e.length&&(t.value=ed(e))}),{nodeMap:r,nodes:e,links:i}}computeNodeLinks(t){let e;"links"in t?e=this.computeSourceTargetNodeLinks(t):(this._isHierarchic=!0,e=this.computeHierarchicNodeLinks(t.nodes));let i=e.nodes,r=e.links;if(this.options.linkSortBy)for(let t=0,e=i.length;t<e;t++)i[t].sourceLinks.sort(this.options.linkSortBy),i[t].targetLinks.sort(this.options.linkSortBy);return this.options.dropIsolatedNode&&(i=i.filter(t=>t.targetLinks.length||t.sourceLinks.length)),{nodes:i,links:r,nodeMap:e.nodeMap}}computeNodeValues(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];i.value=Math.max(et(i.value)?0:kr(i.value),i.sourceLinks.reduce((t,e)=>{var i;return t+(null!=(i=kr(e.value))?i:0)},0),i.targetLinks.reduce((t,e)=>{var i;return t+(null!=(i=kr(e.value))?i:0)},0))}}computeNodeDepths(t){var e;let i=t.length,r,s,n=t,a=0,l=-1,o=tK(this.options.setNodeLayer)?this.options.setNodeLayer:null;for(;n.length&&a<i;){r=[],s={};for(let t=0,i=n.length;t<i;t++){let i=n[t];if(i&&(i.depth=o&&null!=(e=o(i.datum))?e:a,o&&(l=Math.max(i.depth,l)),i.sourceLinks&&i.sourceLinks.length))for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t];s[e.target]||(r.push(this._nodeMap[e.target]),s[e.target]=!0)}}n=r,a+=1}a>i&&this._logger.warn("Error: there is a circular link"),this._maxDepth=o?l+1:a}computeNodeEndDepths(t){let e=t.length,i,r,s=t,n=0;for(;s.length&&n<e;){i=[],r={};for(let t=0,e=s.length;t<e;t++){let e=s[t];if(e){e.endDepth=n;for(let t=0,s=e.targetLinks.length;t<s;t++){let s=e.targetLinks[t];r[s.source]||(i.push(this._nodeMap[s.source]),r[s.source]=!0)}}}s=i,n+=1}n>e&&this._logger.warn("Error: there is a circular link")}computeNodeLayers(t){let e=this.options.nodeWidth,i=this.options.linkWidth,r=this.options.minStepWidth,s=this._viewBox.width,n=null,a=null,l=!1;if(t3(e)){let t=eH(parseFloat(e.replace("%",""))/100,0,1),i=s/(this._maxDepth-1+t);r>0&&(i=Math.max(r,i)),n=i*t,a=i*(1-t),l=!0}else if(tH(e)){if(n=e,tH(i))a=i;else if(et(i)){let t=(s-e)/(this._maxDepth-1);r>0&&(t=Math.max(r,t)),a=t-e}l=!0}else tK(e)&&tH(i)&&(a=i);let o=[];for(let e=0,i=t.length;e<i;e++){let i=t[e];i.layer=this._isHierarchic?i.depth:eH(Math.floor(this._alignFunc(i,this._maxDepth,this._nodeMap)),0,this._maxDepth-1);let r=i.layer;r===this._maxDepth-1&&(i.isLastLayer=!0),l&&(i.x0=this._viewBox.x0+r*(n+a),i.x1=i.x0+n),o[r]?o[r].push(i):o[r]=[i]}if(this.options.nodeSortBy)for(let t=0,e=o.length;t<e;t++)o[t].sort(this.options.nodeSortBy);if(!l&&tK(e)){let t=this._viewBox.x0;for(let r=0;r<this._maxDepth;r++){let s=o[r],l=0,h=0;for(let r=0,o=s&&s.length;r<o;r++){let o=s[r],u=e(o);o.x0=t,o.x1=t+u,l=Math.max(n,u);let d=o.sourceLinks;for(let t=0,e=d.length;t<e;t++){let e=d[t];h=Math.max(h,tK(i)?i(e,this._viewBox):a)}}t+=l+h}}return o}initializeNodeBreadths(t){var e,i,r;let s=null!=(e=this.options.minLinkHeight)?e:0,n=null!=(i=this.options.minNodeHeight)?i:0,a=null!=(r=this.options.maxNodeHeight)?r:1/0,l=this.options.maxLinkHeight;(et(n)||n<s)&&(n=s),(et(l)||l>a)&&(l=a);let o=0,h=null,u=null;if(tK(this.options.nodeGap))h=this.options.nodeGap,o=t.reduce((t,e)=>{let i=e.reduce((t,e)=>t+e.value,0),r=e.reduce((t,e)=>t+this.options.nodeGap(e),0);return Math.min(t,(this._viewBox.height-r)/i)},1/0);else{let e=t.reduce((t,e)=>Math.max(t,e.length),0),i=this._viewBox.height/e,r=Math.min(this.options.nodeGap,i);if(n+r>i&&(r=n>=i?i/2:(i-n)/2,n=Math.min(i-r,n)),h=()=>r,this._gapY=r,this.options.equalNodeHeight)u=this._viewBox.height/e-r;else{let e=n>0?Math.max(r,n):r;o=t.reduce((t,i)=>{let r=i.reduce((t,e)=>t+e.value,0);return Math.min(t,(this._viewBox.height-((i.length-1)*e+n))/r)},1/0)}}let d="start"===this.options.gapPosition,c=!d&&"end"!==this.options.gapPosition,p=tH(this.options.nodeHeight)?t=>this.options.nodeHeight:tK(this.options.nodeHeight)?this.options.nodeHeight:u>0?t=>u:t=>Math.max(t.value*o,0),g=tH(this.options.linkHeight)?()=>this.options.linkHeight:tK(this.options.linkHeight)?this.options.linkHeight:(t,e,i)=>Math.min(Math.max(e.value?i*Ma(t.value/e.value):0,s,0),l);for(let e=0,i=t.length;e<i;e++){let i=t[e];if(!i||!i.length)continue;let r=this._viewBox.y0,s=0,l=0,o=0;for(let t=0,e=i.length;t<e;t++){let e=i[t];s=h(e),d&&(r+=s),l=Math.min(Math.max(o=p(e),n),a),e.y0=r,e.y1=r+l,r=d?e.y1:e.y1+s;for(let t=0,i=e.sourceLinks.length;t<i;t++){let i=e.sourceLinks[t];i.thickness=g(i,e,o)}}let u=this._viewBox.y1-r+(c?s:0);if(u>0)if("start"===this.options.crossNodeAlign);else if("end"===this.options.crossNodeAlign)for(let t=0,e=i.length;t<e;++t){let e=i[t];e.y0+=u,e.y1+=u}else if("parent"===this.options.crossNodeAlign){let r=i.reduce((t,e)=>(e.targetLinks&&e.targetLinks.length&&e.targetLinks.forEach(e=>{t[e.source]=!0}),t),{});if(Object.keys(r).length&&t[e-1]&&t[e-1].length){let s=t[e-1].filter(t=>r[t.key]);if(s&&s.length&&s[0].y0!==i[0].y0){let t=s[0].y0-i[0].y0;for(let e=0,r=i.length;e<r;++e){let r=i[e];r.y0+=t,r.y1+=t}}}}else{u/=i.length+1;for(let t=0,e=i.length;t<e;++t){let e=i[t];e.y0+=u*(t+1),e.y1+=u*(t+1)}}else if(u<0&&i.length>1&&s+(u/=i.length-1)>=0){s+=u,this._gapY=Math.min(s);for(let t=1,e=i.length;t<e;++t){let e=i[t];e.y0+=u*t,e.y1+=u*t}}this.reorderLinks(i)}}computeNodeBreadths(t){let e=this.computeNodeLayers(t);this.initializeNodeBreadths(e);let i=this.options.iterations;if(!this._isHierarchic&&!tK(this.options.setNodeLayer)&&!tK(this.options.nodeGap))for(let t=0;t<i;++t){let r=Math.pow(.99,t),s=Math.max(1-r,(t+1)/i);this.relaxRightToLeft(e,r,s),this.relaxLeftToRight(e,r,s)}return e}relaxLeftToRight(t,e,i){for(let r=1,s=t.length;r<s;++r){let s=t[r];for(let t=0,i=s.length;t<i;t++){let i=s[t],r=0,n=0;for(let t=0,e=i.targetLinks.length;t<e;t++){let e=i.targetLinks[t],s=e.value*(i.layer-this._nodeMap[e.source].layer);r+=this.targetTop(this._nodeMap[e.source],i)*s,n+=s}if(!(n>0))continue;let a=(r/n-i.y0)*e;i.y0+=a,i.y1+=a,this.reorderNodeLinks(i)}et(this.options.nodeSortBy)&&s.sort(Mr),this.resolveCollisions(s,i)}}relaxRightToLeft(t,e,i){for(let r=t.length-2;r>=0;--r){let s=t[r];for(let t=0,i=s.length;t<i;t++){let i=s[t],r=0,n=0;for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t],s=e.value*(this._nodeMap[e.target].layer-i.layer);r+=this.sourceTop(i,this._nodeMap[e.target])*s,n+=s}if(!(n>0))continue;let a=(r/n-i.y0)*e;i.y0+=a,i.y1+=a,this.reorderNodeLinks(i)}void 0===this.options.nodeSortBy&&s.sort(Mr),this.resolveCollisions(s,i)}}resolveCollisions(t,e){let i=t.length>>1,r=t[i];this.resolveCollisionsBottomToTop(t,r.y0-this._gapY,i-1,e),this.resolveCollisionsTopToBottom(t,r.y1+this._gapY,i+1,e),this.resolveCollisionsBottomToTop(t,this._viewBox.y1,t.length-1,e),this.resolveCollisionsTopToBottom(t,this._viewBox.y0,0,e)}resolveCollisionsTopToBottom(t,e,i,r){for(;i<t.length;++i){let s=t[i],n=(e-s.y0)*r;n>1e-6&&(s.y0+=n,s.y1+=n),e=s.y1+this._gapY}}resolveCollisionsBottomToTop(t,e,i,r){for(;i>=0;--i){let s=t[i],n=(s.y1-e)*r;n>1e-6&&(s.y0-=n,s.y1-=n),e=s.y0-this._gapY}}targetTop(t,e){let i,r,s,n=t.y0-(t.sourceLinks.length-1)*this._gapY/2;for(i=0,r=t.sourceLinks.length;i<r&&(s=t.sourceLinks[i]).target!==e.key;i++)n+=s.thickness+this._gapY;for(i=0,r=e.targetLinks.length;i<r&&(s=e.targetLinks[i]).source!==t.key;i++)n-=s.thickness;return n}sourceTop(t,e){let i,r,s,n=e.y0-(e.targetLinks.length-1)*this._gapY/2;for(i=0,r=e.targetLinks.length;i<r&&(s=e.targetLinks[i]).source!==t.key;i++)n+=s.thickness+this._gapY;for(i=0,r=t.sourceLinks.length;i<r&&(s=t.sourceLinks[i]).target!==e.key;i++)n-=s.thickness;return n}computeLinkBreadthsNoOverlap(t){for(let e=0,i=t.length;e<i;e++){let i=t[e],r=i.y0,s=!1;for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t];s||(e.y0=r+e.thickness/2),e.x0=i.x1,r+e.thickness>i.y1||s?(e.y0=i.y1-e.thickness/2,s=!0):r+=e.thickness}let n=i.y0;s=!1;for(let t=0,e=i.targetLinks.length;t<e;t++){let e=i.targetLinks[t];s||(e.y1=n+e.thickness/2),e.x1=i.x0,n+e.thickness>i.y1||s?(e.y1=i.y1-e.thickness/2,s=!0):n+=e.thickness}}}computeLinkBreadthsOverlap(t){let e=this.options.linkOverlap;for(let i=0,r=t.length;i<r;i++){let r=t[i],s="start"===e?r.y0:"end"===e?r.y1:(r.y0+r.y1)/2,n="start"===e?.5:"end"===e?-.5:0;for(let t=0,e=r.sourceLinks.length;t<e;t++){let e=r.sourceLinks[t];e.y0=s+n*e.thickness,e.x0=r.x1}for(let t=0,e=r.targetLinks.length;t<e;t++){let e=r.targetLinks[t];e.y1=s+n*e.thickness,e.x1=r.x0}}}computeLinkBreadths(t){this.options.linkOverlap?this.computeLinkBreadthsOverlap(t):this.computeLinkBreadthsNoOverlap(t)}reorderNodeLinks(t){if(et(this.options.linkSortBy)){let e=t.targetLinks,i=t.sourceLinks;for(let t=0,i=e.length;t<i;t++){let i=e[t];this._nodeMap[i.source].sourceLinks.sort(this._ascendingTargetBreadth)}for(let t=0,e=i.length;t<e;t++){let e=i[t];this._nodeMap[e.target].targetLinks.sort(this._ascendingSourceBreadth)}}}reorderLinks(t){if(et(this.options.linkSortBy))for(let e=0,i=t.length;e<i;e++){let i=t[e];i.sourceLinks.sort(this._ascendingTargetBreadth),i.targetLinks.sort(this._ascendingSourceBreadth)}}}Ml.defaultOptions={iterations:6,nodeAlign:"justify",direction:"horizontal",nodeWidth:24,nodeGap:8,crossNodeAlign:"middle",dropIsolatedNode:!0};let Mo=(t,e,i)=>{e.forEach(e=>{et(e[i])||t.add(e[i]),e.children&&e.children.length>0&&Mo(t,e.children,i)})},Mh=t=>{var e;if(!t||!tY(t))return[];if(t.length>1){let e={links:[],nodes:[]};return t.forEach(t=>{"links"!==t.id&&"nodes"!==t.id||(e[t.id]=t.values)}),[e]}return(null==(e=t[0])?void 0:e.latestData)?t[0].latestData:t},Mu=(t,e)=>{if(!t||!(null==e?void 0:e.view)||!t.length)return[];let i=e.view();if(i.x1-i.x0==0||i.y1-i.y0==0||i.x1-i.x0==-1/0||i.x1-i.x0==1/0||i.y1-i.y0==-1/0||i.y1-i.y0==1/0)return[];let r=t[0];if(("source"!==e.sourceField||"target"!==e.targetField||"value"!==e.valueField)&&r.links){let t=[];r.links.forEach(i=>{let r={};for(let t in i)t===e.sourceField?r.source=i[e.sourceField]:t===e.targetField?r.target=i[e.targetField]:t===e.valueField?r.value=i[e.valueField]:r[t]=i[t];t.push(r)}),r.links=t}let s=new Ml(e),n=[];return n.push(s.layout(r,i)),n},Md=t=>{var e,i;return t&&tY(t)&&(null==(e=t[0])?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!=(i=t[0].latestData[0].nodes)?i:[]},Mc=t=>{var e,i;return t&&tY(t)&&(null==(e=t[0])?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!=(i=t[0].latestData[0].links)?i:[]};class Mp extends d8{constructor(){super(...arguments),this._getDimensionData=t=>{if(t.source){if(tH(t.source)){let e=this.series.getSeriesKeys();return e[t.source]+" => "+e[t.target]}return t.source+" => "+t.target}return t.datum?t.datum[this.series.getSpec().categoryField]:t.key},this.markTooltipValueCallback=t=>t.value}}let Mg=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:{overall:e?t.growFrom():e,orient:"positive"}}),Mf=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:Mg(t),Mm=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"linkPathGrowIn"},My=(t,e,i)=>{let r={x0:t.getFinalAttribute().x0,x1:t.getFinalAttribute().x1,y0:t.getFinalAttribute().y0,y1:t.getFinalAttribute().y1,thickness:t.getFinalAttribute().thickness};return{from:Object.assign({},r,{x1:r.x0,y1:r.y0}),to:r}},M_=(t,e,i)=>{let r={x0:t.getFinalAttribute().x0,x1:t.getFinalAttribute().x1,y0:t.getFinalAttribute().y0,y1:t.getFinalAttribute().y1,thickness:t.getFinalAttribute().thickness};return{from:r,to:Object.assign({},r,{x1:r.x0,y1:r.y0})}};class Mv extends lZ.r{onBind(){var t,e,i;super.onBind(),(null==(t=this.params)?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);let{from:r,to:s}=My(this.target,this.params.options,this.params),n=null!=(i=null==(e=this.target.context)?void 0:e.lastAttrs)?i:r,a=this.target.getFinalAttribute();a&&Object.assign(this.target.attribute,a),this.props=s,this.propKeys=Object.keys(s).filter(t=>null!=s[t]),this.animate.reSyncProps(),this.from=n,this.to=s,this.target.setAttributes(n)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}class Mb extends lZ.r{onBind(){var t,e,i;super.onBind(),(null==(t=this.params)?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);let{from:r,to:s}=M_(this.target,this.params.options,this.params),n=null!=(i=null==(e=this.target.context)?void 0:e.lastAttrs)?i:r;this.props=s,this.propKeys=Object.keys(s).filter(t=>null!=s[t]),this.animate.reSyncProps(),this.from=n,this.to=s,this.target.setAttributes(n)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.setAttributes(r)}}let Mx=()=>{ig.registerAnimation("sankeyNode",(t,e)=>Object.assign({appear:Mf(t,e)},uq)),ig.registerAnimation("sankeyLinkPath",(t,e)=>({appear:Mm(e),enter:{type:"linkPathGrowIn"},exit:{type:"linkPathGrowOut"},disappear:{type:"linkPathGrowOut"}})),uP.a.registerBuiltInAnimate("linkPathGrowOut",Mb),uP.a.registerBuiltInAnimate("linkPathGrowIn",Mv)},MS=(t,e)=>{var i;let r=null!=(i=t.curvature)?i:.5,s="number"==typeof e?t.thickness*e:t.thickness,n=t.x0,a=t.x1,l=t.y0,o=t.y1,h=n+r*(a-n),u=a+r*(n-a),d=t=>t;!1!==t.round&&(n=Math.round(n),a=Math.round(a),l=Math.round(l),o=Math.round(o),h=Math.round(h),u=Math.round(u),d=Math.round),"line"===t.pathType||t.pathType,"center"===t.align?(l=d(t.y0-s/2),o=d(t.y1-s/2)):"end"===t.align?(l=d(t.y0+t.thickness/2-s),o=d(t.y1+t.thickness/2-s)):(l=d(t.y0-t.thickness/2),o=d(t.y1-t.thickness/2));let c=d(l+s),p=d(o+s),g=Math.abs(a-n)>1e-6,f=t.endArrow&&g?`L${a},${d(o-s/2)}L${d(a+s)},${d((o+p)/2)}L${a},${d(p+s/2)}`:"",m=t.startArrow&&g?`L${n},${d(c+s/2)}L${d(n-s)},${d((l+c)/2)}L${n},${d(l-s/2)}`:"";return"line"===t.pathType?`M${n},${l}L${a},${o}${f}L${a},${p}L${n},${c}${m}Z`:"polyline"===t.pathType?`M${n},${l}L${h},${l}L${h},${o}L${a},${o}
    ${f}L${a},${p}L${h},${p}L${h},${c}L${n},${c}${m}Z`:`M${n},${l}C${h},${l},${u},${o},${a},${o}
  ${f}L${a},${p}C${u},${p},${h},${c},${n},${c}${m}Z`},Mk=(t,e)=>{var i;let r=null!=(i=t.curvature)?i:.5,s="number"==typeof e?t.thickness*e:t.thickness,n=t.y0,a=t.y1,l=t.x0,o=t.x1,h=n+r*(a-n),u=a+r*(n-a),d=t=>t;!1!==t.round&&(d=Math.round,n=Math.round(n),a=Math.round(a),l=Math.round(l),o=Math.round(o),h=Math.round(h),u=Math.round(u)),"line"===t.pathType||t.pathType,"center"===t.align?(l=d(t.x0-s/2),o=d(t.x1-s/2)):"end"===t.align?(l=d(t.x0+t.thickness/2-s),o=d(t.x1+t.thickness/2-s)):(l=d(t.x0-t.thickness/2),o=d(t.x1-t.thickness/2));let c=d(l+s),p=d(o+s),g=Math.abs(a-n)>1e-6,f=t.endArrow&&g?`L${d(o-s/2)},${a}L${d((o+p)/2)},${d(a+s)}L${d(p+s/2)},${a}`:"",m=t.startArrow&&g?`L${d(c+s/2)},${n}L${d((c+l)/2)},${d(n-s)}L${d(l-s/2)},${n}`:"";return"line"===t.pathType?`M${l},${n}L${o},${a}${f}L${p},${a}L${c},${n}${m}Z`:"polyline"===t.pathType?`M${l},${n}L${l},${h}L${o},${h}L${o},${a}
    ${f}L${p},${a}L${p},${h}L${c},${h}L${c},${n}${m}Z`:`M${l},${n}C${l},${h},${o},${u},${o},${a}
  ${f}L${p},${a}C${p},${u},${c},${h},${c},${n}${m}Z`};class MA extends AV{constructor(){super(...arguments),this.type=MA.type,this._subMarks={back:{type:"path",defaultAttributes:{zIndex:0}},front:{type:"path",defaultAttributes:{zIndex:1}}},this._positionChannels=["x0","y0","x1","y1","thickness","round","curvature","ratio","pathType","align","endArrow","startArrow","ratio"],this._channelEncoder={backgroundStyle:t=>({back:t})},this._positionEncoder=(t,e,i)=>{var r,s;let n=Object.assign(Object.assign({},i.attribute),t),a=["vertical","TB","BT"].includes(null!=(r=n.direction)?r:null==(s=this._glyphConfig)?void 0:s.direction)?Mk:MS,l="number"==typeof n.ratio&&n.ratio>=0&&n.ratio<=1;return{back:{path:l?a(n,1):""},front:{path:a(n,l?n.ratio:1)}}}}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,x0:0,y0:0,x1:100,y1:100,thickness:1,round:!0})}}MA.type="linkPath";let MM=()=>{AW(),(0,yM.N)(),ig.registerGraphicComponent("path",t=>(0,yw.E)(t)),ig.registerMark(MA.type,MA)},Mw=Object.assign(Object.assign({},cd),{node:{name:"node",type:"rect"},link:{name:"link",type:"linkPath"}});class MT extends cw{_transformLabelSpec(t){this._addMarkLabelSpec(t,"node")}}let MC=(t,e,i,r=!0,s)=>{t.runtimeStateCache||(t.runtimeStateCache={}),t.runtimeStateCache[e]=i,t.hasState(e)&&t.removeState(e),t.addState(e,r,s)};class ME extends cB{constructor(){super(...arguments),this.type=rw.sankey,this.transformerConstructor=MT,this._nodeLayoutZIndex=z.Node,this._labelLayoutZIndex=z.Label,this._viewBox=new pV,this._fillByNode=t=>{var e,i,r,s,n;if(t&&t.sourceRect&&t.targetRect)return this._fillByLink(t);let a=null==(i=null==(e=this._spec.node)?void 0:e.style)?void 0:i.fill;if(t5(a))return a;if(t5(this._spec.seriesField)){let e=null==(s=null==(r=this._option)?void 0:r.globalScale)?void 0:s.getScale("color"),i=(null==t?void 0:t.datum)?t.datum:t;return null==e?void 0:e.scale(null==i?void 0:i[this._spec.seriesField])}return null==(n=this._colorScale)?void 0:n.scale(this._getNodeNameFromData(t))},this._fillByLink=t=>{var e,i,r,s,n,a;let l=null==(i=null==(e=this._spec.link)?void 0:e.style)?void 0:i.fill;if(l)return l;if(t5(this._spec.seriesField)){let e=null==(r=this._nodesSeriesData.latestData)?void 0:r.find(e=>t.source===e.key),i=null==e?void 0:e.datum,a=null==(n=null==(s=this._option)?void 0:s.globalScale)?void 0:n.getScale("color");return null==a?void 0:a.scale(null==i?void 0:i[this._spec.seriesField])}let o=tH(t.source)?this.getNodeList()[t.source]:t.source;return null==(a=this._colorScale)?void 0:a.scale(o)},this._handleEmphasisElement=t=>{var e;let i=null!=(e=this._spec.emphasis)?e:{},r=t.item;"adjacency"===i.effect?r&&t.mark===this._nodeMark?this._handleNodeAdjacencyClick(r):r&&t.mark===this._linkMark?this._handleLinkAdjacencyClick(r):this._handleClearEmpty():"related"===i.effect&&(r&&t.mark===this._nodeMark?this._handleNodeRelatedClick(r):r&&t.mark===this._linkMark?this._handleLinkRelatedClick(r):this._handleClearEmpty())},this._handleClearEmpty=()=>{var t,e;if(!this._needClear)return;let i=null==(t=this._nodeMark)?void 0:t.getGraphics();if(!i||!i.length)return;let r=null==(e=this._linkMark)?void 0:e.getGraphics();r&&r.length&&(i.forEach(t=>{t.removeState(V.STATE_SANKEY_EMPHASIS),t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE)}),r.forEach(t=>{t.removeState(V.STATE_SANKEY_EMPHASIS),t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE)}),this._needClear=!1)},this._handleNodeAdjacencyClick=t=>{let e=iV(t),i=[e.key];if(this._linkMark){let t=this._linkMark.getGraphics();if(!t||!t.length)return;t.forEach((t,r)=>{let s=iV(t);s.source===e.key?(i.includes(s.target)||i.push(s.target),t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(V.STATE_SANKEY_EMPHASIS,!0)):s.target===e.key?(i.includes(s.source)||i.push(s.source),t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(V.STATE_SANKEY_EMPHASIS,!0)):(t.removeState(V.STATE_SANKEY_EMPHASIS),t.addState(V.STATE_SANKEY_EMPHASIS_REVERSE,!0))})}this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),i),this._needClear=!0},this._handleLinkAdjacencyClick=t=>{let e=iV(t),i=[e.source,e.target];if(this._linkMark){let e=this._linkMark.getGraphics();if(!e||!e.length)return;e.forEach(e=>{e===t?(e.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE),MC(e,V.STATE_SANKEY_EMPHASIS,{ratio:1})):(e.removeState(V.STATE_SANKEY_EMPHASIS),e.addState(V.STATE_SANKEY_EMPHASIS_REVERSE,!0))})}this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),i),this._needClear=!0},this._handleNodeRelatedClick=t=>{var e;let i=iV(t),r=this._nodeMark.getGraphics();if(!r||!r.length)return;let s=this._linkMark.getGraphics();if(!s||!s.length)return;let n=(null==(e=iV(s[0]))?void 0:e.parents)?"parents":"source";if("source"===n){let t=[i.key],e=[];if(s.forEach((s,n)=>{var a,l,o,h;let u=iV(s),d=(null==u?void 0:u.parents)?"parents":"source";if(eo(u[d]).includes(i.key)){if(e.includes(null!=(a=u.key)?a:u.index)||e.push(null!=(l=u.key)?l:u.index),t.includes(u.source)||t.push(u.source),!t.includes(u.target)){t.push(u.target);let i=r.find(t=>t.data[0].key===u.target).data[0].sourceLinks;for(;(null==i?void 0:i.length)>0;){let s=[];return i.forEach(i=>{var n,a;if(!e.includes(null!=(n=i.key)?n:i.index)&&(e.push(null!=(a=i.key)?a:i.index),!t.includes(i.target))){t.push(i.target);let e=r.find(t=>t.data[0].key===i.target);s.push(e.data[0].targetLinks)}}),void(i=s)}}}else if(u.target===i.key&&(e.includes(null!=(o=u.key)?o:u.index)||e.push(null!=(h=u.key)?h:u.index),!t.includes(u.source))){t.push(u.source);let i=r.find(t=>t.data[0].key===u.source).data[0].targetLinks;for(;(null==i?void 0:i.length)>0;){let s=[];return i.forEach(i=>{var n,a;if(!e.includes(null!=(n=i.key)?n:i.index)&&(e.push(null!=(a=i.key)?a:i.index),!t.includes(i.source))){t.push(i.source);let e=r.find(t=>t.data[0].key===i.source);s.push(e.data[0].targetLinks)}}),void(i=s)}}}),this._linkMark){let t=this._linkMark.getGraphics();if(!t||!t.length)return;t.forEach((t,i)=>{var r;let s=iV(t);e.includes(null!=(r=s.key)?r:s.index)?(t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(V.STATE_SANKEY_EMPHASIS,!0)):(t.removeState(V.STATE_SANKEY_EMPHASIS),t.addState(V.STATE_SANKEY_EMPHASIS_REVERSE,!0))})}this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),t)}else{let t=[i.key],e=i.targetLinks.reduce((t,e)=>(eo(e.datum).forEach(e=>{let r=e.parents,s=r.length;for(let n=0;n<s;n++){let s=r[n].key,a=r[n+1]?r[n+1].key:i.key,l=e.value,o=t.find(t=>t.source===s&&t.target===a);o?o.value+=l:t.push({source:s,target:a,value:l})}}),t),[]);s.forEach((r,s)=>{let a=iV(r),l=a.datum,o=l?l.filter(t=>t[n].some(t=>t.key===i.key)):null,h=e.find(t=>t.source===a.source&&t.target===a.target);if(o&&o.length){t.includes(a.source)||t.push(a.source),t.includes(a.target)||t.push(a.target);let e=o.reduce((t,e)=>t+e.value,0)/a.value;return r.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE),void MC(r,V.STATE_SANKEY_EMPHASIS,{ratio:e})}if(h)return t.includes(a.source)||t.push(a.source),t.includes(a.target)||t.push(a.target),r.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE),void MC(r,V.STATE_SANKEY_EMPHASIS,{ratio:h.value/a.value});r.removeState(V.STATE_SANKEY_EMPHASIS),r.addState(V.STATE_SANKEY_EMPHASIS_REVERSE,!0)}),this._nodeMark&&this._highLightElements(this._nodeMark.getGraphics(),t)}this._needClear=!0},this._handleLinkRelatedClick=t=>{let e=this._nodeMark.getGraphics();if(!e||!e.length)return;let i=this._linkMark.getGraphics();if(i&&i.length){if("source"==(iV(t)?"parents":"source"))this._linkMark&&i.forEach(t=>{t.removeState(V.STATE_SANKEY_EMPHASIS),t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE)}),this._nodeMark&&e.forEach(t=>{t.removeState(V.STATE_SANKEY_EMPHASIS),t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE)});else{let r=iV(t),s=[r.source,r.target],n=[];eo(r.datum).forEach(t=>{let e=t.parents,i=e.length;for(let r=0;r<i-1;r++){let i=e[r].key,s=e[r+1].key,a=t.value,l=n.find(t=>t.source===i&&t.target===s);n.push({source:e[r].key,target:e[r+1].key,value:t.value}),l?l.value+=a:n.push({source:i,target:s,value:a})}}),i.forEach(t=>{let e=iV(t),i=e.datum;if(e.source===r.source&&e.target===r.target)return t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE),void MC(t,V.STATE_SANKEY_EMPHASIS,{ratio:1});let a=i?i.filter(t=>{let e=t.parents.map(t=>t.key);return e.includes(r.source)&&e.includes(r.target)}):null;if(a&&a.length){s.includes(e.source)||s.push(e.source),s.includes(e.target)||s.push(e.target);let i=a.filter(t=>t.parents.some((e,i)=>{var s;return e.key===r.source&&(null==(s=t.parents[i+1])?void 0:s.key)===r.target})).reduce((t,e)=>t+e.value,0)/e.value;return t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE),void MC(t,V.STATE_SANKEY_EMPHASIS,{ratio:i})}let l=n.find(t=>t.source===e.source&&t.target===e.target);if(l)return s.includes(e.source)||s.push(e.source),s.includes(e.target)||s.push(e.target),t.removeState(V.STATE_SANKEY_EMPHASIS_REVERSE),void MC(t,V.STATE_SANKEY_EMPHASIS,{ratio:l.value/e.value});t.removeState(V.STATE_SANKEY_EMPHASIS),t.addState(V.STATE_SANKEY_EMPHASIS_REVERSE,!0)}),this._highLightElements(e,s)}this._needClear=!0}}}get direction(){var t;return null!=(t=this._spec.direction)?t:"horizontal"}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!=(t=this._spec.seriesField)?t:this._spec.categoryField)}initData(){var t,e,i,r;super.initData();let s=this.getViewData(),n=this.getRawData();if(n&&s){sY(this._dataSet,"sankeyLayout",Mu),sY(this._dataSet,"sankeyFormat",Mh),n.transform({type:"sankeyFormat"},!1),s.transform({type:"sankeyLayout",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),sourceField:this._spec.sourceField,targetField:this._spec.targetField,valueField:this._spec.valueField,direction:this.direction,crossNodeAlign:this._spec.crossNodeAlign,nodeAlign:null!=(t=this._spec.nodeAlign)?t:"justify",nodeGap:null!=(e=this._spec.nodeGap)?e:8,nodeWidth:null!=(i=this._spec.nodeWidth)?i:10,linkWidth:this._spec.linkWidth,minStepWidth:this._spec.minStepWidth,minNodeHeight:null!=(r=this._spec.minNodeHeight)?r:4,maxNodeHeight:this._spec.maxNodeHeight,minLinkHeight:this._spec.minLinkHeight,maxLinkHeight:this._spec.maxLinkHeight,iterations:this._spec.iterations,nodeKey:this._spec.nodeKey,linkSortBy:this._spec.linkSortBy,nodeSortBy:this._spec.nodeSortBy,setNodeLayer:this._spec.setNodeLayer,dropIsolatedNode:this._spec.dropIsolatedNode,nodeHeight:this._spec.nodeHeight,linkHeight:this._spec.linkHeight,equalNodeHeight:this._spec.equalNodeHeight,linkOverlap:this._spec.linkOverlap,inverse:this._spec.inverse},level:L.sankeyLayout});let{dataSet:a}=this._option;sY(a,"sankeyNodes",Md),sY(a,"flatten",ko);let l=new er(a,{name:`sankey-node-${this.id}-data`});l.parse([this.getViewData()],{type:"dataview"}),l.transform({type:"sankeyNodes"}),l.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}},!1),l.transform({type:"addVChartProperty",options:{beforeCall:cl.bind(this),call:co}},!1),this._nodesSeriesData=l,sY(a,"sankeyLinks",Mc);let o=new er(a,{name:`sankey-link-${this.id}-data`});o.parse([this.getViewData()],{type:"dataview"}),o.transform({type:"sankeyLinks"}),o.transform({type:"addVChartProperty",options:{beforeCall:cl.bind(this),call:co}},!1),this._linksSeriesData=o}}compileData(){var t,e;super.compileData(),null==(t=this._linkMark)||t.compileData(),null==(e=this._nodeMark)||e.compileData()}initMark(){this._rootMark.setMarkConfig({overflow:this._spec.overflow,interactive:!!this._spec.overflow});let t=this._createMark(ME.mark.node,{isSeriesMark:!0,dataView:this._nodesSeriesData});t&&(t.setMarkConfig({zIndex:this._nodeLayoutZIndex}),this._nodeMark=t);let e=this._createMark(ME.mark.link,{dataView:this._linksSeriesData});e&&(this._linkMark=e)}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToNode=this.valueToNode.bind(this),this._markAttributeContext.valueToLink=this.valueToLink.bind(this)}valueToNode(t){let e=this._nodesSeriesData.latestData,i=eo(t)[0];return e&&e.find(t=>t.key===i)}valueToLink(t){let e=this._linksSeriesData.latestData,i=eo(t);return e&&e.find(t=>t&&t.source===i[0]&&t.target===i[1])}valueToPositionX(t){let e=this.valueToNode(t);return null==e?void 0:e.x0}valueToPositionY(t){let e=this.valueToNode(t);return null==e?void 0:e.y0}initMarkStyle(){this._initNodeMarkStyle(),this._initLinkMarkStyle()}_initNodeMarkStyle(){var t,e;let i=this._nodeMark;i&&(this.setMarkStyle(i,{x:t=>t.x0,x1:t=>t.x1,y:t=>t.y0,y1:t=>t.y1},V.STATE_NORMAL,H.Mark),this.setMarkStyle(i,{fill:null!=(e=null==(t=this._spec.node.style)?void 0:t.fill)?e:this._fillByNode},"normal",H.User_Mark))}_initLinkMarkStyle(){var t,e;let i=this._linkMark;i&&(i.setGlyphConfig({direction:this.direction}),this.setMarkStyle(i,{x0:t=>t.x0,x1:t=>t.x1,y0:t=>t.y0,y1:t=>t.y1,thickness:t=>t.thickness},V.STATE_NORMAL,H.Series),this.setMarkStyle(i,{fill:null!=(e=null==(t=this._spec.link.style)?void 0:t.fill)?e:this._fillByLink},"normal",H.User_Mark))}initLabelMarkStyle(t,e){if(!t)return;let i=e.position;i&&i.includes("inside")?this.setMarkStyle(t,{fill:"#ffffff",text:t=>this._createText(t,e),maxLineWidth:t=>{var i;return null!=(i=e.limit)?i:t.x1-t.x0}}):this.setMarkStyle(t,{fill:this._fillByNode,text:t=>this._createText(t,e),maxLineWidth:e.limit}),t.setMarkConfig({zIndex:this._labelLayoutZIndex})}_createText(t,e){if(et(t)||et(t.datum))return"";let i=t.datum[this._spec.categoryField]||"",{formatMethod:r,formatter:s}=e||{},{formatFunc:n,args:a}=dJ(r,s,i,t.datum);return n&&(i=n(...a,{series:this})),i}initAnimation(){var t,e,i,r;let s={direction:this.direction,growFrom:()=>{var t,e;return"horizontal"===this.direction?null==(t=this._xAxisHelper)?void 0:t.getScale(0).scale(0):null==(e=this._yAxisHelper)?void 0:e.getScale(0).scale(0)}},n=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._nodeMark&&this._nodeMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("sankeyNode"))?void 0:i(s,n),cb("node",this._spec,this._markAttributeContext))),this._linkMark&&this._linkMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("sankeyLinkPath"))?void 0:r(s,n),cb("link",this._spec,this._markAttributeContext)))}initEvent(){var t,e,i;super.initEvent(),null==(t=this._nodesSeriesData)||t.target.addListener("change",this.nodesSeriesDataUpdate.bind(this)),null==(e=this._linksSeriesData)||e.target.addListener("change",this.linksSeriesDataUpdate.bind(this));let r=null!=(i=this._spec.emphasis)?i:{};if(!0!==this._option.disableTriggerEvent&&r.enable&&("adjacency"===r.effect||"related"===r.effect)){let t="hover"===r.trigger?"pointerover":"pointerdown";this.event.on(t,{level:rO.chart},this._handleEmphasisElement)}}nodesSeriesDataUpdate(){this._nodeMark.getData().updateData(),this._nodeList=null,this._setNodeOrdinalColorScale()}linksSeriesDataUpdate(){this._linkMark.getData().updateData()}_highLightElements(t,e){t&&t.length&&t.forEach(t=>{t.removeState([V.STATE_SANKEY_EMPHASIS_REVERSE,V.STATE_SANKEY_EMPHASIS]),e.includes(iV(t).key)?t.addState(V.STATE_SANKEY_EMPHASIS,!0):t.addState(V.STATE_SANKEY_EMPHASIS_REVERSE,!0)})}initTooltip(){this._tooltipHelper=new Mp(this),this._nodeMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodeMark),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark)}_setNodeOrdinalColorScale(){var t,e,i,r,s;let n,a,l=null==(e=null==(t=this._option)?void 0:t.globalScale)?void 0:e.getScale("color");if(null==l?void 0:l._specified)return void(this._colorScale=l);l&&(n=l.domain(),a=l.range()),a||(a=this._getDataScheme()),n&&!et(n[0])||(n=this.getNodeList()).length>10&&(a=null==(i=this._getDataScheme()[1])?void 0:i.scheme);let o=new lt;null==(s=(r=o.domain(n)).range)||s.call(r,a),this._colorScale=o}getNodeList(){var t,e;if(this._nodeList)return this._nodeList;let i=this._rawData.latestData[0],r=(null==i?void 0:i.nodes)?(null==(t=i.nodes[0])?void 0:t.children)?Array.from(this.extractNamesFromTree(i.nodes,this._spec.categoryField)):i.nodes.map((t,e)=>t[this._spec.categoryField]):(null==i?void 0:i.links)?Array.from(this.extractNamesFromLink(i.links)):null==(e=null==i?void 0:i.values)?void 0:e.map((t,e)=>t[this._spec.categoryField]);return this._nodeList=r,r}_getNodeNameFromData(t){var e;return(null==t?void 0:t.datum)?t.datum[this._spec.categoryField]:null!=(e=t.key)?e:t[this._spec.categoryField]}extractNamesFromTree(t,e){let i=new Set;return t.forEach(t=>{i.add(t[e]),t.children&&this.extractNamesFromTree(t.children,e).forEach(t=>i.add(t))}),i}extractNamesFromLink(t){let e=new Set,{sourceField:i,targetField:r}=this._spec;return t.forEach(t=>{t5(t[i])&&e.add(t[i]),t5(t[r])&&e.add(t[r])}),e}getDimensionField(){return[this._spec.categoryField]}getMeasureField(){return[this._valueField]}getRawDataStatisticsByField(t,e){var i;return this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&(this._viewDataStatistics&&this.getViewData().transformsArr.length<=1&&(null==(i=this._viewDataStatistics.latestData)?void 0:i[t])?this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t]:this._rawData&&(this._rawStatisticsCache[t]={values:this._collectByField(t)})),this._rawStatisticsCache[t]}_collectByField(t){var e,i,r;let s=[],n=null==(i=null==(e=this.getRawData())?void 0:e.latestData)?void 0:i[0];if(!n)return[];if(n.links)(null==(r=n.nodes)?void 0:r.length)&&n.nodes.forEach(t=>{t[this._seriesField]&&s.push(t[this._seriesField])});else if(n.nodes){let t=new Set;return Mo(t,n.nodes,this._seriesField),Array.from(t)}return s}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this.getViewData().reRunAllTransform()}getDefaultShapeType(){return"square"}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._nodeMark,this._linkMark]}getMarkData(t){return t.datum?tY(t.datum)?t.datum[t.datum.length-1]:t.datum:t}}ME.type=rw.sankey,ME.transformerConstructor=MT,ME.mark=Mw,ME.builtInTheme={sankey:{link:{style:{fillOpacity:.15,round:!0}}}};let MB=()=>{m4(),MM(),bk(),Mx(),uJ(),ig.registerSeries(ME.type,ME)};class MP extends fB{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","sourceField","targetField","direction","nodeAlign","crossNodeAlign","nodeGap","nodeWidth","linkWidth","minStepWidth","minNodeHeight","maxNodeHeight","minLinkHeight","maxLinkHeight","dropIsolatedNode","nodeHeight","linkHeight","equalNodeHeight","linkOverlap","iterations","nodeKey","linkSortBy","nodeSortBy","setNodeLayer","node","link","emphasis","inverse","overflow"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}var MO=i(66838),MI=i(29609);let MR=J=class{constructor(){this.name="scrollbar",this.activeEvent="onRegister",this._uid=oT.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.scroll=t=>{var e,i;let r=t.target,s=this.getScrollContainer(r);if(!s&&!this.scrollContainer)return;if(!s&&this.scrollContainer){if(!this.scrollContainer.g.stage||this.scrollContainer.g.stage!==r.stage)return;let t=this.formatScrollContainer(this.scrollContainer.g);if(!t)return void this.clearScrollbar(this.scrollContainer.g,"all");this.scrollContainer.showH&&!t.showH&&this.clearScrollbar(this.scrollContainer.g,"horizontal"),this.scrollContainer.showV&&!t.showV&&this.clearScrollbar(this.scrollContainer.g,"vertical"),this.scrollContainer=t}else s&&this.scrollContainer&&s.g!==this.scrollContainer.g&&this.clearScrollbar(this.scrollContainer.g,"all");if(this.scrollContainer=null!=s?s:this.scrollContainer,!s)return;let n=s.g;if(!n)return;let{width:a,height:l,scrollX:o=0,scrollY:h=0}=n.attribute,u=o,d=h,{showH:c,showV:p}=s;this.scrollContainerBounds=(new lC.YZ).set(0,0,n.attribute.width,n.attribute.height),c&&c&&((0,gX.Wn)(t.deltaX)>(0,gX.Wn)(t.deltaY)?(c=c&&!0,p=p&&!1):(c=c&&!1,p=p&&!0));let g=this.childrenBounds.width(),f=this.childrenBounds.height();c&&((u=o-(null!=(e=t.deltaX)?e:0))>0?u=0:u<a-g&&(u=a-g)),p&&((d=h-(null!=(i=t.deltaY)?i:0))>0?d=0:d<l-f&&(d=l-f)),n.setAttributes({scrollX:u,scrollY:d}),this.addOrUpdateScroll(c,p,n.parent,n)},this.handleScrollBarChange=t=>{if(!(this.scrollContainer&&this.scrollContainerBounds&&this.childrenBounds&&t&&t.target&&t.detail&&t.detail.value))return;let e=t.target,i=t.detail.value;if("horizontal"===e.attribute.direction){let t=this.childrenBounds.width();this.scrollContainer.g.setAttributes({scrollX:-i[0]*t})}else{let t=this.childrenBounds.height();this.scrollContainer.g.setAttributes({scrollY:-i[0]*t})}}}activate(t){this.pluginService=t;let{stage:e}=this.pluginService;this.childrenBounds=new lC.FB,e.addEventListener("wheel",this.scroll),this.params=J.defaultParams}initEventOfScrollbar(t,e,i){t.addEventListener("pointerover",()=>{e.setAttribute("visibleAll",!0)}),t.addEventListener("pointermove",()=>{e.setAttribute("visibleAll",!0)}),t.addEventListener("pointerout",()=>{e.setAttribute("visibleAll",!1)}),e.addEventListener("pointerover",()=>{e.setAttribute("visibleAll",!0)}),e.addEventListener("pointerout",()=>{e.setAttribute("visibleAll",!0)}),e.addEventListener("scrollUp",this.handleScrollBarChange),e.addEventListener(c5.eV,this.handleScrollBarChange)}addOrUpdateScroll(t,e,i,r){if(t){let{scrollBar:t,isUpdate:e}=this.addOrUpdateHScroll(r,i,!0);e||this.initEventOfScrollbar(r,t,!0)}else this.clearScrollbar(r,"horizontal");if(e){let{scrollBar:t,isUpdate:e}=this.addOrUpdateHScroll(r,i,!1);e||this.initEventOfScrollbar(r,t,!1)}else this.clearScrollbar(r,"vertical")}getDirection(t){return t?"horizontal":"vertical"}addOrUpdateHScroll(t,e,i){var r,s;let n=this.getDirection(i),a=`${null!=(r=t.name)?r:t._uid}_${this.getDirection(i)}_${this.name}`,l=e.children.filter(t=>t.name===a),o=!0,h=l[0],{y:u=0,dy:d=0,x:c=0,dx:p=0,height:g,width:f,zIndex:m=0}=this.scrollContainer.g.attribute,y={x:0,y:0,direction:n,zIndex:m+1,visibleAll:!0,padding:[2,0],railStyle:{fill:"rgba(0, 0, 0, .1)"},range:[0,.05]};i?(y.width=this.scrollContainerBounds.width(),y.height=12):(y.height=this.scrollContainerBounds.height(),y.width=12),h?l.length>1&&l.forEach((t,e)=>{var i;e&&(null==(i=t.parent)||i.removeChild(t))}):(o=!1,(h=new MI.B(y)).name=a,e.add(h),h.isScrollBar=!0);let _=this.childrenBounds,{scrollX:v,scrollY:b}=t.attribute;if(i){let t=Math.min(this.scrollContainerBounds.width()/_.width(),1),e=Math.max(Math.min(v/this.childrenBounds.width(),0),t-1);y.x=c+p,y.y=u+d+g-(null!=(s=y.height)?s:0),y.range=[-e,-e+t]}else{let t=Math.min(this.scrollContainerBounds.height()/_.height(),1),e=Math.max(Math.min(b/this.childrenBounds.height(),0),t-1);y.x=c+p+f-this.scrollContainerBounds.width(),y.y=u+d,y.range=[-e,-e+t]}return h.setAttributes(y),{scrollBar:h,isUpdate:o}}clearScrollbar(t,e){t.parent&&t.parent.children.filter(t=>t.isScrollBar&&("all"===e||t.attribute.direction===e)).forEach(t=>{t.parent.removeChild(t)})}formatScrollContainer(t){if(!t||"group"!==t.type||!t.attribute)return null;let{overflow:e,width:i,height:r}=t.attribute;if(!e||"hidden"===e)return null;let s=!1,n=!1;"scroll"===e?(s=!0,n=!0):n=!(s="scroll-x"===e);let a=this.childrenBounds;return a.clear(),t.forEachChildren(t=>{a.union(t.AABBBounds)}),t.AABBBounds.empty()||(s&&(s=i<a.width()),n&&(n=r<a.height())),s||n?{g:t,showH:s,showV:n}:null}getScrollContainer(t){let e=t;for(;e;){let t=this.formatScrollContainer(e);if(t)return t;e=e.parent}return null}deactivate(t){let{stage:e}=this.pluginService;e.removeEventListener("wheel",this.scroll)}};MR.defaultParams={timeout:500},MR=J=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,ob.b)()],MR);let ML=new oy.n((t,e,i,r)=>{i(MR)||(t(MR).toSelf(),t(MO.X).toService(MR))});class MD extends fF{constructor(){super(...arguments),this.transformerConstructor=MP,this.type="sankey",this.seriesType=rw.sankey}_setStateInDatum(t,e,i,r){let s=tY(e)?e[0]:e;if(!s)return void this._interaction.clearByState(t);let n=null;this.filterGraphicsByDatum(s,{filter:(t,e)=>"text"!==e.type&&e.getProduct()&&(!i||i(t,e)),region:r,getDatum:t=>{var e;let i=null==(e=iV(t))?void 0:e.datum;return tY(i)&&(i=i[0]),i},callback:(t,e,i,r)=>{var s;let n=e.getProductId();n&&(n.includes("node")||n.includes("link"))&&(null==(s=i._handleEmphasisElement)||s.call(i,{item:t,mark:e}))},regionCallback:(t,e)=>{s&&t.length&&(n=t[0])}}),n&&this._interaction.updateStateOfGraphics(t,[n])}}MD.type="sankey",MD.seriesType=rw.sankey,MD.transformerConstructor=MP;let MF=()=>{mg(),of.n.load(ML),MB(),ig.registerChart(MD.type,MD)};class Mz extends d8{constructor(){super(...arguments),this._getMeasureData=t=>"horizontal"===this.series.getSpec().direction?t[this.series.getSpec().xField[0]]+"-"+t[this.series.getSpec().xField[1]]:t[this.series.getSpec().yField[0]]+"-"+t[this.series.getSpec().yField[1]]}}let Mj=Object.assign({},mz);class MH extends mN{constructor(){super(...arguments),this.type=rw.rangeArea}initMark(){this._areaMark=this._createMark(MH.mark.area,{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0]})}initMarkStyle(){this.initAreaMarkStyle()}initAreaMarkStyle(){let t=this._areaMark;t&&(super.initAreaMarkStyle(),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x1:t=>{if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})}},"normal",H.Series):this.setMarkStyle(this._areaMark,{y1:t=>{if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})}},"normal",H.Series),this.setMarkStyle(t,{stroke:!1},"normal",H.Series))}initTooltip(){this._tooltipHelper=new Mz(this)}_isFieldAllValid(){let t=this.getViewDataStatistics(),e=this.fieldY;return!!(t&&t.latestData&&e.length)&&e.every(e=>t.latestData[e]&&t.latestData[e].allValid)}}MH.type=rw.rangeArea,MH.mark=Mj;let MN=()=>{mD(),g8(),fc(),ig.registerSeries(MH.type,MH)};class MV extends fP{_getDefaultSeriesSpec(t){var e,i;let r=super._getDefaultSeriesSpec(t);return r.area=t.area,"horizontal"===t.direction?r.xField=null!=(e=t.xField)?e:[t.minField,t.maxField]:r.yField=null!=(i=t.yField)?i:[t.minField,t.maxField],r.stack=!1,r}transformSpec(t){super.transformSpec(t),nF(t)}}class MW extends fF{constructor(){super(...arguments),this.transformerConstructor=MV,this.type="rangeArea",this.seriesType=rw.rangeArea}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}MW.type="rangeArea",MW.seriesType=rw.rangeArea,MW.transformerConstructor=MV;let MU=()=>{mc(),mg(),mm(),f0(),fW(),MN(),ig.registerChart(MW.type,MW)};class MG extends oa{constructor(){super(...arguments),this.type=MG.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{fill:void 0,lineWidth:0,padding:0})}_createGraphic(t={}){return(0,pR.t)(t)}_transformGraphicAttributes(t,e,i){var r,s,n;let a=super._transformGraphicAttributes(t,e,i),l=null!=(s=null!=(r=a.shape)?r:a.symbolType)?s:null==(n=t.attribute)?void 0:n.symbolType;return et(l)?a.symbolType="rect":a.symbolType=l,a}}MG.type="cell";let MZ=()=>{ig.registerMark(MG.type,MG),ig.registerGraphicComponent("symbol",pR.t),(0,ol.W)(),(0,pL.k)(),pP()},M$=()=>{ig.registerAnimation("heatmap",(t,e)=>Object.assign(Object.assign({},uq),{appear:!1===e?{}:{type:"fadeIn"}}))};function MY(t){if(ee(t))return[t,t,t,t];if(tY(t)){let e=t.length;if(1===e){let e=t[0];return[e,e,e,e]}if(2===e){let[e,i]=t;return[e,i,e,i]}if(3===e){let[e,i,r]=t;return[e,i,r,i]}if(4===e)return t}if(ey(t)){let{top:e=0,right:i=0,bottom:r=0,left:s=0}=t;return[e,i,r,s]}return[0,0,0,0]}class MX extends d8{enableByType(t){return"dimension"!==t}}let MK=Object.assign(Object.assign({},cd),{cell:{name:"cell",type:"cell"},cellBackground:{name:"cellBackground",type:"cell"}});class Mq extends cw{_transformLabelSpec(t){this._addMarkLabelSpec(t,"cell")}}class MQ extends cB{constructor(){super(...arguments),this.type=rw.heatmap,this.transformerConstructor=Mq}getFieldValue(){return this._fieldValue}setFieldValue(t){this._fieldValue=eo(t)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFieldValue(this._spec.valueField)}initMark(){this._cellMark=this._createMark(MQ.mark.cell,{isSeriesMark:!0},{morph:ck(this._spec,MQ.mark.cell.name),morphElementKey:this.getDimensionField()[0]}),this._backgroundMark=this._createMark(MQ.mark.cellBackground)}initMarkStyle(){this.initCellMarkStyle(),this.initCellBackgroundMarkStyle()}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getMeasureField()[0]]})}initCellMarkStyle(){this.setMarkStyle(this._cellMark,{x:t=>this.dataToPositionX(t),y:t=>this.dataToPositionY(t),size:()=>[this.getCellSize(this._xAxisHelper),this.getCellSize(this._yAxisHelper)],fill:this.getColorAttribute()},"normal",H.Series)}initCellBackgroundMarkStyle(){var t,e,i;let r=MY(null!=(i=null==(e=null==(t=this._spec.cellBackground)?void 0:t.style)?void 0:e.padding)?i:0);this.setMarkStyle(this._backgroundMark,{x:t=>{let e=this.getCellSize(this._xAxisHelper);return this.dataToPositionX(t)-e/2+r[3]},y:t=>{let e=this.getCellSize(this._yAxisHelper);return this.dataToPositionY(t)-e/2+r[0]},width:()=>this.getCellSize(this._xAxisHelper)-r[1]-r[3],height:()=>this.getCellSize(this._yAxisHelper)-r[0]-r[2]},"normal",H.Series)}getColorAttribute(){var t;return{scale:null!=(t=this._option.globalScale.getScale("color"))?t:this._getDefaultColorScale(),field:this.getFieldValue[0]}}getInteractionTriggers(){return this._parseInteractionConfig(this._cellMark?[this._cellMark]:[])}initAnimation(){var t,e,i;let r=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset,s=cE(this);this._cellMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("heatmap"))?void 0:i(r),cb("cell",this._spec,this._markAttributeContext),s))}getCellSize(t){var e,i;return null!=(i=null==(e=t.getBandwidth)?void 0:e.call(t,0))?i:6}initTooltip(){this._tooltipHelper=new MX(this),this._cellMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._cellMark)}getDefaultShapeType(){return"square"}getDimensionField(){return[].concat(this.fieldX,this.fieldY)}getMeasureField(){return this.getFieldValue()}getActiveMarks(){return[this._cellMark]}}MQ.type=rw.heatmap,MQ.mark=MK,MQ.builtInTheme={heatmap:{cell:{style:{shape:"square",fillOpacity:1}},cellBackground:{visible:!1}}},MQ.transformerConstructor=Mq;let MJ=()=>{bk(),MZ(),M$(),g8(),fc(),ig.registerSeries(MQ.type,MQ)};class M0 extends fP{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["valueField","cell"])}}class M1 extends fF{constructor(){super(...arguments),this.transformerConstructor=M0,this.type="heatmap",this.seriesType=rw.heatmap}}M1.type="heatmap",M1.seriesType=rw.heatmap,M1.transformerConstructor=M0;let M2=()=>{mg(),MJ(),ig.registerChart(M1.type,M1)},M3=Object.assign(Object.assign({},cd),{nodePoint:{name:"nodePoint",type:"symbol"},ripplePoint:{name:"ripplePoint",type:"ripple"},centerPoint:{name:"centerPoint",type:"symbol"},centerLabel:{name:"centerLabel",type:"text"}}),M5=(t,e)=>{let i,r,s=tK(e)?e:t=>t;if(t&&t.length){let e=t.length;for(let n=0;n<e;n+=1){let e=s(t[n]);et(e)||!tH(e*=1)||Number.isNaN(e)||(et(i)?(i=e,r=e):(i=Math.min(i,e),r=Math.max(r,e)))}}return[i,r]},M4=`${s6}_CORRELATION_X`,M7=`${s6}_CORRELATION_Y`,M6=`${s6}_CORRELATION_SIZE`,M9=(t,e)=>{var i,r,s,n,a,l,o,h,u,d,c,p,g,f,m;if(!t||!(null==e?void 0:e.view)||!tY(t))return t;let y=e.view();if(y.x1-y.x0==0||y.y1-y.y0==0||y.x1-y.x0==-1/0||y.x1-y.x0==1/0||y.y1-y.y0==-1/0||y.y1-y.y0==1/0)return t;let _=lu(null!=(i=e.startAngle)?i:-90),v=lu(null!=(r=e.endAngle)?r:270),b=Math.max((y.x1-y.x0)/2,(y.y1-y.y0)/2),x=ku(null!=(s=e.innerRadius)?s:0,b),S=ku(e.outerRadius,b),k=[tH(null==(n=e.center)?void 0:n[0])?e.center[0]:y.x0+ku(null!=(l=null==(a=e.center)?void 0:a[0])?l:"50%",y.x1-y.x0),tH(null==(o=e.center)?void 0:o[1])?e.center[1]:y.y0+ku(null!=(u=null==(h=e.center)?void 0:h[1])?u:"50%",y.y1-y.y0)],A=x3(e.field),M=t.map(A),[w,T]=M5(M),C=w===T?t=>(x+S)/2:t=>x+(S-x)*(t-w)/(T-w),E=et(e.radiusField)?A:x3(e.radiusField),B=null!=(c=null==(d=null==e?void 0:e.radiusRange)?void 0:d[1])?c:5,P=t=>B;if(E){let[i,r]=E!==A?M5(t.map(E)):[w,T],s=null!=(g=null==(p=e.radiusRange)?void 0:p[0])?g:5,n=null!=(m=null==(f=e.radiusRange)?void 0:f[1])?m:5;i!==r&&(P=t=>s+(n-s)*(E(t)-i)/(r-i))}let O=Math.min(_,v),I=Math.max(_,v),R=M8(O,I,t.length),L=[],D=(I-O)/60;return t.forEach((t,e)=>{let i=C(M[e]),r=P(t),s,n,a=R[e];for(let t=0;t<60&&(wt({x:s=k[0]+i*Math.cos(a),y:n=k[1]+i*Math.sin(a),size:r},L)||s-r<y.x0||s+r>y.x1||n-r<y.y0||n+r>y.y1);t++)t<59&&((a+=D)>I?a=O:a<O&&(a=I));L.push(Object.assign({[M4]:s,[M7]:n,[M6]:r},t))}),L},M8=(t,e,i)=>{let r=0,s=Math.max(Math.ceil(2*(e-t)/Math.PI),2),n=(e-t)/s,a=0,l=1,o=0,h=0,u=[],d=t;for(;o<i;)h<s&&(u.push(d+(h%2?Math.floor(h/2)+Math.floor(s/2):h/2)*n*l),h++),o++,h===s&&(h=0,a+=1,l*=-1,0===r?r=n/2:r/=2,d=-1===l?e-r:t+r,a>=2&&(n/=2,s*=2));return u},wt=(t,e)=>!(!e||!e.length)&&e.some(e=>Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<Math.pow(t.size+e.size,2)),we=(t,e)=>{if(!t||!tY(t))return[];let{keyword:i,categoryField:r}=e,s=t[0].latestData[0];return{[r]:i,[ne]:null==s?void 0:s[ne],[nr]:null==s?void 0:s[nr]}};class wi extends AV{constructor(){super(...arguments),this.type=wi.type,this._subMarks={ripple0:{type:"symbol",defaultAttributes:{fillOpacity:.75}},ripple1:{type:"symbol",defaultAttributes:{fillOpacity:.5}},ripple2:{type:"symbol",defaultAttributes:{fillOpacity:.25}}},this._positionChannels=["ripple","size"],this._positionEncoder=(t,e,i)=>{let{ripple:r=i.attribute.ripple,size:s=i.attribute.size}=t,n=eH(r,0,1),a=.5*s;return{ripple0:{size:s+a*n,fillOpacity:.75-.25*n},ripple1:{size:s+a*(1+n),fillOpacity:.5-.25*n},ripple2:{size:s+a*(2+n),fillOpacity:.25-.25*n}}}}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,ripple:0})}}wi.type="ripple";let wr=()=>{AW(),(0,pL.k)(),ig.registerMark(wi.type,wi),ig.registerGraphicComponent("symbol",t=>(0,pR.t)(t))},ws=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"},wn=()=>{ig.registerAnimation("correlation",(t,e)=>Object.assign({appear:ws(0,e)},uK))};class wa extends cw{_transformLabelSpec(t){this._addMarkLabelSpec(t,"nodePoint"),this._addMarkLabelSpec(t,"centerPoint","centerLabel")}}class wl extends _Y{constructor(){super(...arguments),this.type=rw.correlation,this.transformerConstructor=wa,this._viewBox=new pV}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}getSeriesField(){return this._seriesField}setSeriesField(t){t5(t)&&(this._seriesField=t)}getSizeField(){return this._sizeField}setSizeField(t){t5(t)&&(this._sizeField=t)}getSizeRange(){return this._sizeRange}setSizeRange(t){t5(t)&&(this._sizeRange=t)}setAttrFromSpec(){super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(this._spec.seriesField),this.setSizeField(this._spec.sizeField),this.setSizeRange(this._spec.sizeRange)}initData(){var t,e,i;if(super.initData(),!this._data)return;sY(this._dataSet,"correlation",M9);let r=new tZ;sX(r,"dataview",tX),sY(r,"correlationCenter",we);let s=new er(r,{name:`${this.type}_${this.id}_center`});s.parse([this.getViewData()],{type:"dataview"}),s.transform({type:"correlationCenter",options:{keyword:null!=(i=null==(e=null==(t=this._spec.centerLabel)?void 0:t.style)?void 0:e.text)?i:"",categoryField:this._spec.categoryField}}),this._centerSeriesData=new ly(this._option,s)}compileData(){var t;super.compileData(),null==(t=this._centerSeriesData)||t.compile()}_statisticViewData(){super._statisticViewData(),this._data.getDataView().transform({type:"correlation",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),field:this._spec.valueField,radiusRange:this._spec.sizeRange,radiusField:this._spec.sizeField,center:[this._spec.centerX,this._spec.centerY],innerRadius:this._spec.innerRadius,outerRadius:this._spec.outerRadius,startAngle:this._spec.startAngle,endAngle:this._spec.endAngle}})}initMark(){let t=this._createMark(wl.mark.nodePoint,{groupKey:this._seriesField,isSeriesMark:!0,key:ne});t&&(t.setMarkConfig({zIndex:z.Node}),this._nodePointMark=t);let e=this._createMark(wl.mark.ripplePoint,{key:ne,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});e&&(this._ripplePointMark=e);let i=this._createMark(wl.mark.centerPoint,{key:ne,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});i&&(i.setMarkConfig({zIndex:z.Node}),this._centerPointMark=i)}initMarkStyle(){this._initNodePointMarkStyle(),this._initRipplePointMarkStyle(),this._initCenterPointMarkStyle()}_initNodePointMarkStyle(){var t,e,i,r;let s=this._nodePointMark;if(!s)return;let n=null!=(e=null==(t=this._spec.nodePoint)?void 0:t.style)?e:{};this.setMarkStyle(s,{x:t=>t[M4],y:t=>t[M7],size:t=>t[M6],fill:null!=(i=n.fill)?i:this.getColorAttribute(),fillOpacity:null!=(r=n.fillOpacity)?r:1,lineWidth:0},V.STATE_NORMAL,H.Series)}_initRipplePointMarkStyle(){var t,e,i,r,s;let n=this._ripplePointMark;if(!n)return;let a=null!=(e=null==(t=this._spec.ripplePoint)?void 0:t.style)?e:{};this.setMarkStyle(n,{x:()=>{var t;return null!=(t=this._spec.centerX)?t:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var t;return null!=(t=this._spec.centerY)?t:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:null!=(i=a.fill)?i:this.getColorAttribute(),opacity:null!=(r=a.fillOpacity)?r:.2,ripple:null!=(s=a.ripple)?s:0},V.STATE_NORMAL,H.Series)}_initCenterPointMarkStyle(){var t,e,i,r,s,n;let a=this._centerPointMark;a&&this.setMarkStyle(a,{x:()=>{var t;return null!=(t=this._spec.centerX)?t:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var t;return null!=(t=this._spec.centerY)?t:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>.2*Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:null!=(i=null==(e=null==(t=this._spec.centerPoint)?void 0:t.style)?void 0:e.fill)?i:this.getColorAttribute(),fillOpacity:null!=(n=null==(s=null==(r=this._spec.centerPoint)?void 0:r.style)?void 0:s.fillOpacity)?n:1},V.STATE_NORMAL,H.Series)}initTooltip(){super.initTooltip(),this._nodePointMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodePointMark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this._categoryField],z:this.dataToPositionZ.bind(this)},V.STATE_NORMAL,H.Series)}initAnimation(){var t,e;let i=null==(t=this._spec.animationAppear)?void 0:t.preset;this._nodePointMark.setAnimationConfig(cv(null==(e=ig.getAnimationInKey("correlation"))?void 0:e({},i),cb("nodePoint",this._spec,this._markAttributeContext)))}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}getActiveMarks(){return[this._nodePointMark,this._centerPointMark]}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this._rawData.reRunAllTransform(),this.getViewData().reRunAllTransform()}}wl.type=rw.correlation,wl.mark=M3,wl.builtInTheme={correlation:{centerLabel:{visible:!0,position:"center",style:{fill:"#fff",text:""}},label:{visible:!0,position:"bottom",style:{fill:"#000"}}}},wl.transformerConstructor=wa;let wo=()=>{pF(),wr(),ig.registerSeries(wl.type,wl),wn()};class wh extends fB{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","sizeField","sizeRange","centerX","centerY","innerRadius","outerRadius","startAngle","endAngle","ripplePoint","centerPoint","centerLabel","nodePoint"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class wu extends fF{constructor(){super(...arguments),this.transformerConstructor=wh,this.type="correlation",this.seriesType=rw.correlation}}wu.type="correlation",wu.seriesType=rw.correlation,wu.transformerConstructor=wh;let wd=()=>{mg(),wo(),ig.registerChart(wu.type,wu)};class wc extends fd{constructor(){super(...arguments),this.type=rA.cartesianTimeAxis,this._zero=!1,this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),pW(this._regions,t=>{p$(this.getOrient())?gd(t.getXAxisHelper(),this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&t.setXAxisHelper(this.axisHelper()):gd(t.getYAxisHelper(),this.axisHelper(),t5(this._seriesUserId)||t5(this._seriesIndex))&&t.setYAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._tick=it({},this._spec.tick,null==(t=this._spec.layers)?void 0:t[0])}_initData(){var t;if(super._initData(),null==(t=this._spec.layers)?void 0:t[1]){let t=new er(this._option.dataSet,{name:`${this.type}_${this.id}_layer_1_ticks`}).parse(this._scale,{type:"scale"}).transform({type:`${this.type}-ticks`,options:Object.assign(Object.assign({},this._tickTransformOption()),{tickCount:this._spec.layers[1].tickCount,forceTickCount:this._spec.layers[1].forceTickCount,tickStep:this._spec.layers[1].tickStep})},!1);this._layerTickData=new ly(this._option,t)}}computeData(t){super.computeData(t),this._layerTickData&&(this._layerTickData.getDataView().reRunAllTransform(),this._layerTickData.updateData())}created(){super.created(),this._layerTickData&&(this._axisMark&&this._layerTickData.addRelatedMark(this._axisMark),this._gridMark&&this._layerTickData.addRelatedMark(this._gridMark))}_getLabelFormatMethod(){var t,e,i,r,s,n,a,l;let o=dq.getInstance(),h=(null==(e=null==(t=this._spec.layers)?void 0:t[1])?void 0:e.timeFormat)||"%Y%m%d",u="local"===((null==(r=null==(i=this._spec.layers)?void 0:i[1])?void 0:r.timeFormatMode)||"local")?o.timeFormat:o.timeUTCFormat,d=(null==(n=null==(s=this._spec.layers)?void 0:s[0])?void 0:n.timeFormat)||"%Y%m%d",c="local"===((null==(l=null==(a=this._spec.layers)?void 0:a[0])?void 0:l.timeFormatMode)||"local")?o.timeFormat:o.timeUTCFormat;return(t,e,i,r,s)=>{var n;let a;return a=0===s?c(d,t):u(h,t),(null==(n=this._spec.label)?void 0:n.formatMethod)?this._spec.label.formatMethod(a,e):a}}getLabelItems(t){var e,i;let r=[],s=null==(e=this.getTickData())?void 0:e.getLatestData();s&&s.length&&r.push(s.map(e=>gu(e.value,this._getNormalizedValue([e.value],t))));let n=null==(i=this._layerTickData)?void 0:i.getLatestData();return n&&n.length&&r.push(n.map(e=>gu(e.value,this._getNormalizedValue([e.value],t)))),r}registerTicksTransform(){let t=`${this.type}-ticks`;return sY(this._option.dataSet,t,fh.m),t}transformScaleDomain(){}}wc.type=rA.cartesianTimeAxis,wc.specKey="axes",wc.builtInTheme={axis:g4,axisX:g7,axisY:g6};let wp=()=>{ig.registerGraphicComponent($.lineAxis,(t,e)=>new g3.$(t,e)),ig.registerGraphicComponent(Y.lineAxisGrid,(t,e)=>new g2(t,e)),gH(),ig.registerComponent(wc.type,wc)};class wg{nice(t=10,e){var i,r,s,n;let a=this._domain,l=[],o=null;if(e){let t=aV(a,e);if(l=t.niceMinMax,this._domainValidator=t.domainValidator,o=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else o="all";if(o){let t=aw(a.slice(),null!=(r=null==(i=this.getNiceConfig)?void 0:i.call(this))?r:{floor:t=>Math.floor(t),ceil:t=>Math.ceil(t)});return"min"===o?t[t.length-1]=null!=(s=l[1])?s:t[t.length-1]:"max"===o&&(t[0]=null!=(n=l[0])?n:t[0]),this._niceDomain=t,this.rescale(),this}return this}niceMin(){let t=this._domain[this._domain.length-1];this.nice();let e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}niceMax(){let t=this._domain[0];this.nice();let e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}function wf(t=Number.EPSILON){return e=>Math.max(e,t)}class wm extends a1{constructor(){super(ay(10),am(10)),this.type=U.Log,this._limit=wf(),this._logs=this.transformer,this._pows=this.untransformer,this._domain=[1,10],this._base=10}clone(){return(new wm).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}rescale(t){var e;if(t)return this;super.rescale();let i=ay(this._base),r=am(this._base);return(null!=(e=this._niceDomain)?e:this._domain)[0]<0?(this._logs=t=>-i(-t),this._pows=t=>-r(-t),this._limit=function(t=Number.EPSILON){return e=>Math.min(e,-t)}(),this.transformer=ap,this.untransformer=ag):(this._logs=i,this._pows=r,this._limit=wf(),this.transformer=this._logs,this.untransformer=r),this}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!=(e=this._niceDomain)?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}base(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}tickFormat(){return au}d3Ticks(t=10,e){let i=this.domain();return aU(this._limit(i[0]),this._limit(i[i.length-1]),t,this._base,this.transformer,this.untransformer,e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return aG(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return aZ(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return aZ(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}getNiceConfig(){return{floor:t=>this._pows(Math.floor(this._logs(this._limit(t)))),ceil:t=>Math.abs(t)>=1?Math.ceil(t):this._pows(Math.ceil(this._logs(this._limit(t))))}}}cD(wm,wg);class wy extends fd{constructor(){super(...arguments),this.type=rA.cartesianLogAxis,this._zero=!1,this._scale=new wm}initScales(){var t;super.initScales(),this._scale.base(null!=(t=this._spec.base)?t:10),this._scale.clamp(!0,null,!1)}registerTicksTransform(){let t=`${this.type}-ticks`;return sY(this._option.dataSet,t,fh.m),t}transformScaleDomain(){}}wy.type=rA.cartesianLogAxis,wy.specKey="axes",wy.builtInTheme={axis:g4,axisLinear:fu,axisX:g7,axisY:g6},cD(wy,fo);let w_=()=>{ig.registerGraphicComponent($.lineAxis,(t,e)=>new g3.$(t,e)),ig.registerGraphicComponent(Y.lineAxisGrid,(t,e)=>new g2(t,e)),gH(),ig.registerComponent(wy.type,wy)};class wv extends a2{constructor(){super(a_(1),av(1)),this.type=U.Symlog,this._const=1}clone(){return(new wv).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}constant(t,e){return arguments.length?(this._const=t,this.transformer=a_(t),this.untransformer=av(t),this.rescale(e)):this._const}d3Ticks(t=10,e){let i=this.domain();return aU(i[0],i[i.length-1],t,this._const,this.transformer,this.untransformer,e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return aG(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return aZ(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return aZ(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}cD(wv,wg);class wb extends fd{constructor(){super(...arguments),this.type=rA.cartesianSymlogAxis,this._zero=!1,this._scale=new wv}initScales(){var t;super.initScales(),this._scale.constant(null!=(t=this._spec.constant)?t:10)}registerTicksTransform(){let t=`${this.type}-ticks`;return sY(this._option.dataSet,t,fh.m),t}transformScaleDomain(){}}wb.type=rA.cartesianSymlogAxis,wb.specKey="axes",wb.builtInTheme={axis:g4,axisLinear:fu,axisX:g7,axisY:g6},cD(wb,fo);let wS=()=>{ig.registerGraphicComponent($.lineAxis,(t,e)=>new g3.$(t,e)),ig.registerGraphicComponent(Y.lineAxisGrid,(t,e)=>new g2(t,e)),gH(),ig.registerComponent(wb.type,wb)};function wk(t){var e,i;let r=Object.assign({},t);return nR(t.style)||(r.textStyle=gs(t.style)),nR(t.textStyle)||it(r.textStyle,gs(t.textStyle)),(null==(e=t.shape)?void 0:e.style)&&gs(r.shape.style),(null==(i=t.background)?void 0:i.style)&&gs(r.background.style),r}var wA=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i},wM=i(43483),ww=i(88666);let wT=(t,e)=>{let i=[],r={},{series:s,seriesField:n}=e;return s().forEach(t=>{let e=n(t);(e===t.getSeriesField()?t.getSeriesInfoList():t.getSeriesInfoInField(e)).forEach(t=>{r[t.key]||(r[t.key]=!0,i.push(t))})}),i},wC=(t,e)=>{var i,r,s;let{series:n,selected:a,field:l,data:o,customFilter:h}=e,u=a(),d=o();if(0===u.length&&d.length)return[];if(u.length===d.length)return t;let c={};u.forEach(t=>{c[t]=!0});let p=null!=(i=l())?i:nr;return h?h(t,u,p):(tY(t)&&(null==(r=t[0])?void 0:r.nodes)?(t[0].nodes=t[0].nodes.filter(t=>!0===c[t.key]),(null==(s=t[0])?void 0:s.links)&&(t[0].links=t[0].links.filter(t=>!0===c[t.source]&&!0===c[t.target]))):t5(p)&&(t=t.filter(t=>!0===c[n.getSeriesFieldValue(t,p)])),t)};class wE extends gO{constructor(){super(...arguments),this.layoutType="normal",this.layoutZIndex=z.Legend,this.layoutLevel=j.Legend,this.specKey="legends",this._orient="left",this._visible=!0,this._position="middle",this._preSelectedData=[],this._selectedData=[],this.effect={onSelectedDataChange:()=>{pW(this._regions,t=>{var e;null==(e=t.getViewData())||e.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),pW(this._regions,t=>{t.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}get orient(){return this._orient}get visible(){return this._visible}get position(){return this._position}getLegendData(){return this._legendData.getLatestData()}getSelectedData(){return this._selectedData}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._orient=e_(this._spec.orient)?this._spec.orient:"left",this._position=null!=(t=this._spec.position)?t:"middle",this._visible=!1!==this._spec.visible;let{regionId:e,regionIndex:i,seriesId:r,seriesIndex:s}=this._spec;t5(r)&&(this._seriesUserId=eo(r)),t5(e)&&(this._regionUserId=eo(e)),t5(s)&&(this._seriesIndex=eo(s)),t5(i)&&(this._regionUserIndex=eo(i)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionUserIndex)}created(){super.created(),this.initData()}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reRender=!0,(null==t?void 0:t.orient)!==(null==e?void 0:e.orient)?i.reMake=!0:t1(e,t)||(i.reCompile=!0),i}_bindLegendDataChange(){this._preSelectedData=this._selectedData.slice(),this._initSelectedData(),this._forceLayout()}initData(){let t=this._initLegendData();t.target.addListener("change",this._bindLegendDataChange.bind(this)),this._legendData=new ly(this._option,t),this._initSelectedData(),pW(this._regions,t=>{t.event.on(rB.rawDataUpdate,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>{this._legendData.getDataView().reRunAllTransform({skipEqual:!0})})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}setSelectedData(t){var e,i,r;let s=this._selectedData;et(t)||JSON.stringify(s)===JSON.stringify(t)||(pW(this._regions,e=>{e.legendSelectedFilter&&(t=e.legendSelectedFilter(this,t))},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._selectedData=[...t],null==(i=(e=this.effect).onSelectedDataChange)||i.call(e),this.event.emit(rB.legendSelectedDataChange,{model:this}),null==(r=this._legendComponent)||r.setSelected(this._selectedData))}afterSetLayoutStartPoint(t){if(super.afterSetLayoutStartPoint(t),this._legendComponent){let{x:e,y:i}=t;ee(e*i)&&this._legendComponent.setAttributes({x:e,y:i})}}getBoundsInRect(t,e){if(!this._visible)return this._legendComponent&&this._legendComponent.parent&&(this._legendComponent.parent.removeChild(this._legendComponent),this._legendComponent=null),{x1:0,y1:0,x2:0,y2:0};let i={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},r=this._getLegendAttributes(t);if(r.disableTriggerEvent=this._option.disableTriggerEvent,this._legendComponent)t1(r,this._cacheAttrs)||this._legendComponent.setAttributes(it({},r,{defaultSelected:this._selectedData}));else{let t=new(this._getLegendConstructor())(it({},r,{defaultSelected:this._selectedData}));t.name="legend",this._legendComponent=t,this.getContainer().add(t),this._option.disableTriggerEvent||this._initEvent(),t.on("*",(t,e)=>this._delegateEvent(this._legendComponent,t,e))}this._cacheAttrs=r;let s=isFinite(this._legendComponent.AABBBounds.width())?this._legendComponent.AABBBounds.width():0,n=isFinite(this._legendComponent.AABBBounds.height())?this._legendComponent.AABBBounds.height():0;if("normal-inline"!==this.layoutType){let t="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",i=this._position,{width:r,height:a}=e,l=0,o=0;"horizontal"===t?"middle"===i?l=(r-s)/2:"end"===i&&(l=r-s):"middle"===i?o=(a-n)/2:"end"===i&&(o=a-n),this._legendComponent.setAttributes({dx:l,dy:o})}return i.x2=i.x1+s,i.y2=i.y1+n,i}onDataUpdate(){var t,e;if(JSON.stringify(this._preSelectedData)!==JSON.stringify(this._selectedData)){if(this._legendComponent){let t=this._getLegendAttributes(this.getLayoutRect());t1(t,this._cacheAttrs)||this._legendComponent.setAttributes(it({},t,{defaultSelected:this._selectedData}))}null==(e=(t=this.effect).onSelectedDataChange)||e.call(t),this.event.emit(rB.legendSelectedDataChange,{model:this})}}_getNeedClearVRenderComponents(){return[this._legendComponent]}clear(){super.clear(),this._cacheAttrs=null,this._preSelectedData=null}}wE.specKey="legends";let wB={orient:"bottom",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal"},space:12},pager:{textStyle:{fill:{type:"palette",key:"discreteLegendPagerTextColor"}},handler:{style:{fill:{type:"palette",key:"discreteLegendPagerHandlerColor"}},state:{disable:{fill:{type:"palette",key:"discreteLegendPagerHandlerDisableColor"}}}}},item:{visible:!0,spaceCol:10,spaceRow:6,padding:2,background:{state:{selectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}},unSelectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}}}},shape:{space:6,style:{lineWidth:0,fillOpacity:1,opacity:1},state:{unSelected:{fillOpacity:.2,opacity:1}}},label:{space:6,style:{fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},opacity:1},state:{unSelected:{fill:{type:"palette",key:"disableFontColor"},opacity:1}}}},allowAllCanceled:!1};class wP extends wE{constructor(){super(...arguments),this.type=rA.discreteLegend,this.name=rA.discreteLegend}static getSpecInfo(t){return d0(t,this.specKey,this.type,t=>!t.type||"discrete"===t.type)}init(t){super.init(t),pW(this._regions,t=>{t.addViewDataFilter({type:"discreteLegendFilter",options:{series:t,selected:()=>this._selectedData,field:()=>this._getSeriesLegendField(t),data:()=>this.getLegendDefaultData(),customFilter:this._spec.customFilter},level:L.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_initLegendData(){sY(this._option.dataSet,"discreteLegendFilter",wC),sY(this._option.dataSet,"discreteLegendDataMake",wT);let t=new er(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return t.transform({type:"discreteLegendDataMake",options:{series:()=>{let t=[];return pW(this._regions,e=>{t.push(e)},{specIndex:this._spec.seriesIndex,userId:this._spec.seriesId}),t},seriesField:t=>this._getSeriesLegendField(t)}}),t}_getSeriesLegendField(t){var e,i,r;let s=t.getSeriesField(),n=null!=(e=this._spec.scaleName)?e:this._spec.scale;if(et(n)||!t.getRawData())return s;let a=this._option.globalScale.getScaleSpec(n);if(!a)return s;if(this._spec.field)return this._spec.field;if(!em(a.domain))return s;let l=a.domain.find(e=>e.dataId===t.getRawData().name);return l&&null!=(r=null==(i=l.fields)?void 0:i[0])?r:s}_initSelectedData(){let t=this.getLegendDefaultData();if(this._unselectedData){let e=[],i=[];t.forEach(t=>{this._unselectedData.includes(t)?i.push(t):e.push(t)}),this._selectedData=e,this._unselectedData=i}else this._spec.defaultSelected?this._selectedData=[...this._spec.defaultSelected]:this._selectedData=t}getLegendDefaultData(t){return tK(this._spec.data)?this._getLegendItems().map(t=>t.label):this._legendData.getLatestData().map(t?t=>t.originalKey:t=>t.key)}_addDefaultTitleText(t){var e,i,r,s;if((null==(e=t.title)?void 0:e.visible)&&et(t.title.text)&&et(null==(i=t.title.style)?void 0:i.text)){let e=null==(s=null==(r=this._regions)?void 0:r[0])?void 0:s.getSeries()[0];if(!e)return;t.title.text=dN(e.getRawData(),e.getSeriesField())}}_getLegendAttributes(t){let e=Object.assign(Object.assign({layout:"bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",items:this._getLegendItems(),zIndex:this.layoutZIndex},function(t,e){let{title:i={},item:r={},pager:s={},background:n={},type:a,id:l,visible:o,orient:h,position:u,data:d,filter:c,regionId:p,regionIndex:g,seriesIndex:f,seriesId:m,padding:y}=t,_=wA(t,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible?_.title=wk(i):_.title={visible:!1},nR(r.focusIconStyle)||gs(r.focusIconStyle),r.shape&&(r.shape=ge(r.shape)),r.label&&(r.label=ge(r.label)),r.value&&(r.value=ge(r.value)),r.background&&(r.background=ge(r.background)),ev(r.maxWidth)&&(r.maxWidth=Number(r.maxWidth.substring(0,r.maxWidth.length-1))*e.width/100),ev(r.width)&&(r.width=Number(r.width.substring(0,r.width.length-1))*e.width/100),ev(r.height)&&(r.height=Number(r.height.substring(0,r.height.length-1))*e.width/100),_.item=r,"scrollbar"===s.type?(nR(s.railStyle)||gs(s.railStyle),nR(s.sliderStyle)||gs(s.sliderStyle)):(nR(s.textStyle)||gs(s.textStyle),s.handler&&ge(s.handler)),_.pager=s,n.visible&&!nR(n.style)&&(it(_,n.style),t5(n.padding)&&(_.padding=n.padding)),_}(this._spec,t)),{maxWidth:t.width,maxHeight:t.height});return this._addDefaultTitleText(e),this._addLegendItemFormatMethods(e),e}_getLegendConstructor(){return ww.W}setSelectedData(t){t&&(this._unselectedData=this.getLegendDefaultData().filter(e=>!t.includes(e))),super.setSelectedData(t)}_initEvent(){if(this._legendComponent){let t=!1!==this._spec.filter;this._legendComponent.addEventListener(wM.dk.legendItemClick,e=>{let i=iF(e,"detail.currentSelected");t&&this.setSelectedData(i),this.event.emit(rB.legendItemClick,{model:this,value:i,event:e})}),this._legendComponent.addEventListener(wM.dk.legendItemHover,t=>{let e=iF(t,"detail");this.event.emit(rB.legendItemHover,{model:this,value:e,event:t})}),this._legendComponent.addEventListener(wM.dk.legendItemUnHover,t=>{let e=iF(t,"detail");this.event.emit(rB.legendItemUnHover,{model:this,value:e,event:t})})}}_getLegendItems(){let t=(this._legendData.getLatestData()||[]).map(t=>{var e,i;let r=t.style("fillOpacity"),s=t.style("strokeOpacity"),n=t.style("opacity"),a=t.style("texture");return{label:t.key,shape:{symbolType:null!=(i=null!=(e=t.style("symbolType"))?e:t.shapeType)?i:"circle",fillOpacity:ee(r)?r:1,strokeOpacity:ee(s)?s:1,opacity:ee(n)?n:1,texturePadding:a?1:null,textureSize:a?4:null,texture:a,fill:t.style("fill"),stroke:t.style("stroke"),textureColor:t.style("textureColor"),innerBorder:t.style("innerBorder"),outerBorder:t.style("outerBorder"),lineDash:t.style("lineDash"),lineDashOffset:t.style("lineDashOffset"),lineWidth:t.style("lineWidth")}}});return tK(this._spec.data)?this._spec.data(t,this._option.globalScale.getScale("color"),this._option.globalScale):t}_addLegendItemFormatMethods(t){var e,i,r,s;let{formatMethod:n,formatter:a}=null!=(i=null==(e=this._spec.item)?void 0:e.label)?i:{},{formatMethod:l,formatter:o}=null!=(s=null==(r=this._spec.item)?void 0:r.value)?s:{},{formatFunc:h}=dJ(n,a);a&&!n&&h&&(t.item.label.formatMethod=(t,e)=>h(t,e,a));let{formatFunc:u}=dJ(l,o);o&&!l&&u&&(t.item.value.formatMethod=(t,e)=>u(o,t,e,a))}}wP.specKey="legends",wP.builtInTheme={discreteLegend:wB},wP.type=rA.discreteLegend;let wO=()=>{ig.registerComponent(wP.type,wP)},wI=(t,e)=>{let{series:i,field:r,scale:s}=e,n=r();if(r&&n){let t=1/0,e=-1/0;return i().forEach(i=>{let r=i.getRawDataStatisticsByField(n,!0),s=null==r?void 0:r.min,a=null==r?void 0:r.max;ee(s)&&(t=Math.min(s,t)),ee(a)&&(e=Math.max(a,e))}),[t,e]}if(s){let t=s();return t?t.domain():[]}return[]},wR=(t,e)=>{let{selected:i,field:r,data:s,isHierarchyData:n,customFilter:a}=e,l=i(),o=r(),h=n||(t=>t&&t.some(t=>t&&function(t,e="value",i="children"){return!!ey(t)&&!!t.hasOwnProperty(i)&&Array.isArray(t[i])}(t)));if(l===s())return t;if(o&&!nR(l)){let[e,i]=l;return a?a(t,l,o):h(t)?function t(e,i,r,s="value",n="children"){return Array.isArray(e)?e.map(e=>{let a=Object.assign({},e);return Array.isArray(a[n])&&(a[n]=t(a[n],i,r,s,n)),a}).filter(t=>+t[s]>=i&&+t[s]<=r||t[n]&&t[n].length>0):e}(t,+e,+i,o):t.filter(t=>t[o]>=e&&t[o]<=i)}return t};var wL=i(38724),wD=i(95548),wF=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};let wz={color:wL.e,size:wD.D},wj={orient:"right",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"primaryFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},endText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},handlerText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6}},wH=t=>{let e={width:200,height:8,style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=8):(e.width=8,e.height=200),Object.assign(Object.assign({},wj),{rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:"#ffffff"},shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"}}}})},wN={horizontal:wH(!0),vertical:wH(!1)},wV=t=>{let e={style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=4):(e.height=200,e.width=4),Object.assign(Object.assign({},wj),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:{type:"palette",key:"sliderTrackColor"}},fill:{type:"palette",key:"sliderHandleColor"}}}})},wW={horizontal:wV(!0),vertical:wV(!1)},wU=["#C4E7FF","#98CAFF","#75ACFF","#518FF9","#2775DC","#005CBE","#00429F","#00287E"],wG=[2,10];class wZ extends wE{static getSpecInfo(t){let e=d0(t,this.specKey,this.type,t=>{var e;return"color"===(e=t.type)||"size"===e});return e&&e.forEach(t=>{t.type="color"===t.spec.type?rA.colorLegend:rA.sizeLegend}),e}constructor(t,e){super(t,e),this.type=rA.colorLegend,this.name=rA.colorLegend;let i="color"===this._spec.type?rA.colorLegend:rA.sizeLegend;this.type=i,this.name=i}setAttrFromSpec(){super.setAttrFromSpec(),this._field=this._spec.field,this._legendType=this._spec.type}init(t){super.init(t),pW(this._regions,t=>{t.addViewDataFilter({type:"continuousLegendFilter",options:{selected:()=>this._selectedData,field:()=>this._field,data:()=>this._legendData.getLatestData(),isHierarchyData:t.isHierarchyData,customFilter:this._spec.customFilter},level:L.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_getScaleInGlobal(){let t=this._option.globalScale,e=this._spec.scale;return e||(e=this._legendType),t.getScale(e)}_initLegendData(){sY(this._option.dataSet,"continuousLegendFilter",wR),sY(this._option.dataSet,"continuousLegendDataMake",wI);let t=new er(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return t.transform({type:"continuousLegendDataMake",options:{series:()=>pU(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}),field:()=>this._field,scale:this._getScaleInGlobal.bind(this)}}),t}_initSelectedData(){this._spec.defaultSelected?this._selectedData=this._spec.defaultSelected.slice():this._selectedData=this._legendData.getLatestData()}_addDefaultTitleText(t){var e,i,r,s;if((null==(e=t.title)?void 0:e.visible)&&et(t.title.text)&&et(null==(i=t.title.style)?void 0:i.text)){let e=this._field;if(e){let i=null==(s=null==(r=this._regions)?void 0:r[0])?void 0:s.getSeries()[0];if(!i)return;return void(t.title.text=dN(i.getRawData(),e))}let i=this._spec.scale;i||(i=this._legendType);let n=this._option.globalScale.getScaleSpec(i);if(!em(null==n?void 0:n.domain))return;let a=n.domain[0];if(0===a.fields.length)return;t.title.text=dN(this._option.dataSet.getDataView(a.dataId),a.fields[0])}}_getLegendAttributes(t){var e,i;let r="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",s="horizontal"===r?"bottom":this.layoutOrient,n=[],a=this._getScaleInGlobal();a&&"linear"===a.type&&(n=a.range()),nR(n)&&(n="color"===this._legendType?wU:wG);let l=null!=(e=this._legendData.getLatestData()[0])?e:0,o=null!=(i=this._legendData.getLatestData()[1])?i:1;this._legendData.getLatestData()[0]===this._legendData.getLatestData()[1]&&(l=Math.min(0,this._legendData.getLatestData()[0]),o=0===this._legendData.getLatestData()[0]?1:Math.max(0,this._legendData.getLatestData()[0]));let h=Object.assign({layout:r,align:s,zIndex:this.layoutZIndex,min:l,max:o,value:this._spec.defaultSelected,["color"===this._legendType?"colors":"sizeRange"]:n},function(t){let e=it({},t),{title:i={},handler:r={},rail:s={},track:n={},startText:a,endText:l,handlerText:o,sizeBackground:h,background:u={},type:d,id:c,visible:p,orient:g,position:f,data:m,defaultSelected:y,field:_,filter:v,regionId:b,regionIndex:x,seriesIndex:S,seriesId:k,padding:A}=e,M=wF(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible?M.title=wk(i):M.title={visible:!1},M.showHandler=!1!==r.visible,nR(r.style)||(M.handlerStyle=gs(r.style)),t5(s.width)&&(M.railWidth=s.width),t5(s.height)&&(M.railHeight=s.height),nR(s.style)||(M.railStyle=gs(s.style)),nR(n.style)||(M.trackStyle=gs(n.style)),M.startText=ge(a),M.endText=ge(l),M.handlerText=ge(o),nR(h)||(M.sizeBackground=gs(h)),u.visible&&!nR(u.style)&&(it(M,u.style),t5(u.padding)&&(M.padding=u.padding)),M}(this._spec));return this._addDefaultTitleText(h),h}_getLegendConstructor(){return wz[this._legendType]}_initEvent(){if(this._legendComponent){let t=!1!==this._spec.filter;this._legendComponent.addEventListener("change",ij(e=>{let i=iF(e,"detail.value");t&&this.setSelectedData(i),this.event.emit(rB.legendFilter,{model:this,value:i,event:e})},30))}}}wZ.specKey="legends",wZ.builtInTheme={colorLegend:wN,sizeLegend:wW},wZ.type=rA.continuousLegend;let w$=()=>{ig.registerComponent(wZ.type,wZ)},wY=(t,e)=>t5(e)?t.map(t=>e[t]):void 0,wX=(t,e)=>i=>t.every((t,r)=>i[t]===(null==e?void 0:e[r])),wK=t=>!et(t)&&(tY(t)?t.length>0&&t.every(t5):Object.keys(t).length>0),wq=(t,e)=>{let i=e.getSeries(),r=[];return i.forEach(e=>{var i,s,n,a,l,o,h;let u=e.getDimensionField(),d=e.getMeasureField(),c=e.getSeriesField(),p=t5(c)?t[c]:void 0,g=t5(c)&&null!=(a=null==(n=null==(s=null==(i=e.getViewDataStatistics)?void 0:i.call(e))?void 0:s.latestData[c])?void 0:n.values)?a:[],f=wY(u,t),m=wY(d,t),y=wK(m),_=!y&&t5(c)&&et(p)&&g.length>0,v=()=>{var t;let i=null==(t=e.getViewData())?void 0:t.latestData.find(wX(u,f));if(!y&&!wK(m=wY(d,i)))return;let s=e.type===rw.pie?e.dataToCentralPosition(i):e.dataToPosition(i);et(s)||isNaN(s.x)||isNaN(s.y)||r.push({pos:s,data:{dimensionFields:u,dimensionData:f,measureFields:d,measureData:m,hasMeasureData:y,groupField:c,groupData:p},series:e})};if("cartesian"===e.coordinate){let t=ar(null==(o=null==(l=e.getYAxisHelper())?void 0:l.getScale(0))?void 0:o.type)?"y":"x",i=u.map((t,e)=>[t,e]).filter(([,t])=>et(null==f?void 0:f[t])),s=[null!=f?f:[]];i.length>0&&i.forEach(([t,i])=>{var r,n,a,l;let o=null!=(l=null==(a=null==(n=null==(r=e.getViewDataStatistics)?void 0:r.call(e))?void 0:n.latestData[t])?void 0:a.values)?l:[],h=[];s.forEach(t=>{o.forEach(e=>{var r;let s=null!=(r=null==t?void 0:t.slice())?r:[];s[i]=e,h.push(s)})}),s=h}),s.forEach(i=>{var s,n;if(_){let n=null==(s=e.getViewData())?void 0:s.latestData.filter(wX(u,i));g.forEach(s=>{let a=n.find(t=>t[c]===s);if(!wK(m=wY(d,a)))return;let l=e.dataToPosition(a);et(l)||isNaN(l.x)||isNaN(l.y)||r.push({pos:l,data:{dimensionFields:u,dimensionData:i,measureFields:d,measureData:m,hasMeasureData:y,groupField:c,groupData:s},series:e,dimType:t})})}else{let s=null==(n=e.getViewData())?void 0:n.latestData.find(wX(u,i));if(!y&&!wK(m=wY(d,s)))return;let a=e.dataToPosition(s);if(et(a)||isNaN(a.x)||isNaN(a.y))return;r.push({pos:a,data:{dimensionFields:u,dimensionData:i,measureFields:d,measureData:m,hasMeasureData:y,groupField:c,groupData:p},dimType:t,series:e})}})}else if("polar"===e.coordinate)if(e.type===rw.pie)v();else if(_){let t=(null==(h=e.getViewData())?void 0:h.latestData.filter(wX(u,f))).find(t=>t[c]===p);g.forEach(i=>{if(!wK(m=wY(d,t)))return;let s=e.dataToPosition(t);et(s)||isNaN(s.x)||isNaN(s.y)||r.push({pos:s,data:{dimensionFields:u,dimensionData:f,measureFields:d,measureData:m,hasMeasureData:y,groupField:c,groupData:i},series:e})})}else v();else"geo"===e.coordinate&&v()}),r},wQ=t=>t5(t)&&!tY(t),wJ=t=>t5(t)&&tY(t);class w0 extends gB{_shouldMergeThemeToSpec(){return!1}_initTheme(t,e){var i,r,s;let{spec:n,theme:a}=super._initTheme(t,e);return n.style=it({},this._theme,n.style),n.offset=it({},a.offset,t.offset),n.transitionDuration=null!=(i=t.transitionDuration)?i:a.transitionDuration,n.trigger=null!=(r=t.trigger)?r:a.trigger,n.triggerOff=null!=(s=t.triggerOff)?s:a.triggerOff,{spec:n,theme:a}}_transformSpecAfterMergingTheme(t,e,i){var r,s,n,a,l,o,h;super._transformSpecAfterMergingTheme(t,e,i),t.visible=null==(r=t.visible)||r,t.activeType=d5(t),t.renderMode=null!=(s=t.renderMode)?s:eP(this._option.mode)||!eE(this._option.mode)?"canvas":"html",t.trigger=null!=(n=t.trigger)?n:"hover",t.className=null!=(a=t.className)?a:"vchart-tooltip-element",t.enterable=null!=(l=t.enterable)&&l,t.transitionDuration=null!=(o=t.transitionDuration)?o:150,t.confine=null!=(h=t.confine)?h:"canvas"===t.renderMode,t5(t.parentElement)?t3(t.parentElement)&&(t.parentElement=es.rF.getElementById(t.parentElement)):eE(this._option.mode)&&(t.parentElement=null==eC?void 0:eC.body)}}class w1 extends gO{constructor(){super(...arguments),this.layoutZIndex=1,this.type=rA.tooltip,this.name=rA.tooltip,this.transformerConstructor=w0,this.specKey="tooltip",this.layoutType="none",this._isReleased=!1,this._alwaysShow=!1,this._eventList=[],this._isTooltipShown=!1,this._clickLock=!1,this._mountEvent=(t,e,i)=>{this.event.on(t,e,i),this._eventList.push({eventType:t,handler:i})},this._handleClickToLock=t=>{var e,i;if(this._clickLock)this._handleChartMouseOut(t),this._clickLock=!1;else{if(!this._isTooltipShown&&!(null==(i=null==(e=this.tooltipHandler)?void 0:e.isTooltipShown)?void 0:i.call(e)))return;this._clickLock=!0}},this._getMouseOutHandler=t=>e=>{var i,r,s,n,a;if(this._isReleased||this._alwaysShow||this._clickLock||!this._isTooltipShown&&!(null==(r=null==(i=this.tooltipHandler)?void 0:i.isTooltipShown)?void 0:r.call(i)))return;let l=eE(null==(s=this._option)?void 0:s.mode),{clientX:o,clientY:h}=e.event;l&&t&&this._isPointerInChart({x:o,y:h})||(this._enterable?this._outTimer=setTimeout(()=>{this._handleChartMouseOut(e)},null!=(a=null==(n=this._spec)?void 0:n.showDelay)?a:50):this._handleChartMouseOut(e))},this._handleChartMouseOut=t=>{this._alwaysShow||this._isReleased||this._isEnterTooltip||"none"!==this._spec.triggerOff&&(this._hideTooltipByHandler(Object.assign(Object.assign({},t),{tooltip:this})),this._handleMouseMove&&this._handleMouseMove.cancel&&this._handleMouseMove.cancel(),this._cacheEnterableRect=null,this._cacheInfo=void 0,this._cacheParams=void 0,this._cacheActiveType=void 0)},this._getMouseMoveHandler=t=>e=>{var i,r,s,n;this._isReleased||this._isEnterTooltip||(this._outTimer&&(clearTimeout(this._outTimer),this._outTimer=null),this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),this._alwaysShow||(this._clickLock?t&&(this._handleChartMouseOut(e),this._clickLock=!1):!t&&this._enterable&&(null==(r=null==(i=this.tooltipHandler)?void 0:i.isTooltipShown)?void 0:r.call(i))?(this._showTimer&&clearTimeout(this._showTimer),this._showTimer=setTimeout(()=>{this._handleChartMouseMove(e,t)},null!=(n=null==(s=this._spec)?void 0:s.showDelay)?n:50)):this._handleChartMouseMove(e,t)))},this._handleChartMouseMove=(t,e)=>{if(this._isReleased)return;let i=this._getMouseEventData(t),{tooltipInfo:{dimension:r},ignore:{mark:s}}=i,n={mark:!1,dimension:!1,group:!1},a=["group","mark","dimension"];for(let r=0,s=a.length;r<s;r++){let s=a[r];if(this.processor[s]&&this._showTooltipByMouseEvent(s,i,t,e)){n[s]=!0;break}}Object.values(n).every(t=>!t)&&!(et(t.mark)&&et(t.model)&&et(t.datum))&&(s&&wQ(this._cacheInfo)?n.mark=this._showTooltipByMouseEvent("mark",i,t,e,!0):t5(r)&&(n.dimension=this._showTooltipByMouseEvent("dimension",i,t,e))),n.mark||n.group||n.dimension&&!et(r)?this._initEventOfTooltipContent():this._handleChartMouseOut(t)},this._showTooltipByMouseEvent=(t,e,i,r,s)=>{var n;let a,l=this.processor[t];if(!l.shouldHandleTooltip(i,e.tooltipInfo[t]))return!1;if(this._hideTimer&&clearTimeout(this._hideTimer),s)a=!l.showTooltip(this._cacheInfo,i,!0);else{let r=e.tooltipInfo[t],s=this._isSameAsCache(r,i,t);(a=!l.showTooltip(r,i,s))&&(this._cacheInfo=r,this._cacheParams=i,this._cacheActiveType=t)}a&&(this._isTooltipShown=!0,r&&this._spec.lockAfterClick&&!this._clickLock?this._clickLock=!0:Number.isFinite(this._spec.hideTimer)&&(this._hideTimer=setTimeout(()=>{this._handleChartMouseOut()},this._spec.hideTimer)));let o=null==(n=this._option)?void 0:n.globalInstance;return a&&dy.globalConfig.uniqueTooltip&&o&&dy.hideTooltip(o.id),a},this._getMouseEventData=t=>{let e={tooltipInfo:{},ignore:{}};return Object.keys(this.processor).forEach(i=>{let{tooltipInfo:r,ignore:s}=this.processor[i].getMouseEventData(t);e.tooltipInfo[i]=r,e.ignore[i]=s}),e},this._hideTooltipByHandler=t=>{var e,i,r;if(!this._isTooltipShown&&!(null==(i=null==(e=this.tooltipHandler)?void 0:e.isTooltipShown)?void 0:i.call(e)))return 0;this.event.emit(rB.tooltipHide,Object.assign(Object.assign({},t),{source:rP.chart,tooltip:this})),Object.values(this.processor).forEach(t=>{t.clearCache()});let s=null!=(r=this._spec.handler)?r:this.tooltipHandler;if(s.hideTooltip){let e=s.hideTooltip.call(s,t);return e||(this._isTooltipShown=!1),e}return 1},this.hideTooltip=()=>{if(this._isReleased)return!1;let t={changePositionOnly:!1,tooltip:this,item:void 0,datum:void 0,source:rP.chart};return this._alwaysShow=!1,!this._hideTooltipByHandler(t)}}isTooltipShown(){return this._isTooltipShown}_registerEvent(){}_releaseEvent(){}onLayoutEnd(){}created(){super.created(),this._regions=this._option.getAllRegions(),this._initEvent()}release(){var t,e;super.release(),this._isReleased=!0,this._hideTimer&&clearTimeout(this._hideTimer),this._eventList.forEach(({eventType:t,handler:e})=>{this.event.off(t,e)}),this._eventList=[],null==(e=null==(t=this.tooltipHandler)?void 0:t.release)||e.call(t),this._isTooltipShown=!1}beforeRelease(){this.event.emit(rB.tooltipHide,{tooltip:this,chart:this.getChart()}),this.event.emit(rB.tooltipRelease,{tooltip:this,chart:this.getChart()})}_initHandler(){var t,e,i;let r=null!=(t=this._spec.renderMode)?t:"html",s=this._option.globalInstance.getTooltipHandlerByUser();if(s)this.tooltipHandler=s,this._enterable=!1;else{let t="canvas"===r?mo.canvas:mo.dom,s=ig.getComponentPluginInType(t);s||eR("Can not find tooltip handler: "+t);let n=new s;n.name=`${this._spec.className}-${null!=(e=this._option.globalInstance.id)?e:0}-${this.getSpecIndex()}`,null==(i=this.pluginService)||i.load([n]),this.tooltipHandler=n,this._spec.enterable&&"html"===r&&this.tooltipHandler?(this._enterable=!0,this._needInitEventOfTooltip=!0):this._enterable=!1}}_initEventOfTooltipContent(){var t,e;if(!this._needInitEventOfTooltip)return;let i=null==(e=(t=this.tooltipHandler).getRootDom)?void 0:e.call(t);i&&(i.addEventListener("pointerenter",()=>{var t;if(!this._enterable)return;this._isEnterTooltip=!0;let e=null==(t=i.getBoundingClientRect)?void 0:t.call(i);e&&(this._cacheEnterableRect={width:e.width,height:e.height}),this._outTimer&&(clearTimeout(this._outTimer),this._outTimer=null),this._showTimer&&(clearTimeout(this._showTimer),this._showTimer=null)}),i.addEventListener("pointerleave",()=>{var t,e,r;if(this._enterable&&(this._isEnterTooltip=!1,"none"!==this._spec.triggerOff&&this._cacheEnterableRect)){let s=null==(t=i.getBoundingClientRect)?void 0:t.call(i);s&&Object.keys(this._cacheEnterableRect).every(t=>this._cacheEnterableRect[t]===s[t])&&(this._cacheEnterableRect=null,this._outTimer=setTimeout(this.hideTooltip,null!=(r=null==(e=this._spec)?void 0:e.showDelay)?r:50))}}),this._needInitEventOfTooltip=!1)}_initProcessor(){let t=this._spec.activeType;this.processor={},t.forEach(t=>{let e=ig.createTooltipProcessor(t,this);e&&(this.processor[t]=e)})}_initEvent(){var t;if(this._option.disableTriggerEvent)return;let e=eo(null!=(t=this._spec.trigger)?t:"hover"),i=eo(this._spec.triggerOff),r=this._option.mode;e.forEach(t=>{var e;"hover"===t?(this._handleMouseMove=this._throttle(this._getMouseMoveHandler(!1)),this._mountEvent("pointermove",{source:"chart"},this._handleMouseMove),(eB(r)||eP(r))&&(this._mountEvent("pointerdown",{source:"chart"},this._getMouseMoveHandler(!1)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))),this._mountEvent("pointerleave",{source:"chart"},this._getMouseOutHandler(!1))):"click"===t?(this._mountEvent("pointertap",{source:"chart"},this._getMouseMoveHandler(!0)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))):ey(t)&&this._mountEvent(t.eventType,{source:null!=(e=t.source)?e:"chart",consume:t.consume},this._getMouseMoveHandler(!0))}),i.filter(t=>ey(t)).forEach(t=>{var e,i;this._mountEvent(t.eventType,{source:null!=(e=t.source)?e:"chart",consume:t.consume},this._getMouseOutHandler(null!=(i=t.checkOutside)&&i))}),!e.includes("click")&&this._spec.lockAfterClick&&this._mountEvent("pointertap",{source:"chart"},this._handleClickToLock)}_throttle(t){return iH(t,tH(this._spec.throttleInterval)?this._spec.throttleInterval:"html"===this._spec.renderMode&&this._spec.transitionDuration?50:10)}reInit(t){var e,i,r;if(super.reInit(t),this.tooltipHandler){let t=null!=(e=this._spec.renderMode)?e:"html",s=this._spec.enterable&&"html"===t;s&&!this._enterable&&(this._needInitEventOfTooltip=!0),this._enterable=s,null==(r=(i=this.tooltipHandler).reInit)||r.call(i)}else this._initHandler()}showTooltip(t,e){var i;if(this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),!(null==(i=this.tooltipHandler)?void 0:i.showTooltip))return!1;let r=function(t,e,i){var r,s,n;let a=Object.assign({regionIndex:0},e),l=i.getOption(),o=l.getRegionsInUserIdOrIndex(t5(a.regionId)?[a.regionId]:void 0,t5(a.regionIndex)?[a.regionIndex]:void 0)[0];if(!o)return"none";let h=wq(t,o),u=null!=(r=a.activeType)?r:h.length>1?"dimension":"mark",d=o.getLayoutStartPoint(),c=o.getLayoutRect(),p=l.globalInstance.getContainer(),g=Object.assign({x:0,y:0},p?function(t){let{x:e,y:i}=t.getBoundingClientRect();return{x:e,y:i}}(p):{}),f=t=>{var e;let{dimensionFields:i,dimensionData:r,measureFields:s,measureData:n,groupField:a,groupData:l}=t.data;return null==(e=t.series.getViewData())?void 0:e.latestData.find(t=>wX(i,r)(t)&&wX(s,n)(t)&&(et(a)||wX([a],[l])(t)))},m=t=>{var e,i;let r={x:Math.min(Math.max(t.x,0),c.width),y:Math.min(Math.max(t.y,0),c.height)},s=null!=(e=a.x)?e:d.x+r.x,n=null!=(i=a.y)?i:d.y+r.y;return{canvasX:s,canvasY:n,clientX:g.x+s,clientY:g.y+n}};if("dimension"===u){let e=h[0];if(!e)return"none";let r=new Map;h.forEach(t=>{var e;r.has(t.series)||r.set(t.series,[]),null==(e=r.get(t.series))||e.push(t)});let n=[{value:t[e.data.dimensionFields[0]],data:[...r.keys()].map(t=>{var e,i;return{series:t,datum:null!=(i=null==(e=r.get(t))?void 0:e.map(t=>f(t)))?i:[]}})}];t5(e.dimType)&&(n[0].position=e.pos[e.dimType],n[0].dimType=e.dimType);let a={changePositionOnly:!1,action:"enter",tooltip:null,dimensionInfo:n,chart:null!=(s=l.globalInstance.getChart())?s:void 0,datum:void 0,model:void 0,source:rP.chart,event:m({x:h.reduce((t,e)=>t+e.pos.x,0)/h.length,y:h.reduce((t,e)=>t+e.pos.y,0)/h.length}),item:void 0};i.processor.dimension.showTooltip(n,a,!1);let o=l.globalInstance;return dy.globalConfig.uniqueTooltip&&dy.hideTooltip(o.id),u}if("mark"===u){let e=h[0];if(!e)return"none";let r=Object.assign(Object.assign({},f(e)),t),s=[{datum:[r],series:e.series}],a={changePositionOnly:!1,tooltip:null,dimensionInfo:[{value:r[e.data.dimensionFields[0]],data:s}],chart:null!=(n=l.globalInstance.getChart())?n:void 0,datum:r,model:e.series,source:rP.chart,event:m(e.pos),item:void 0};i.processor.mark.showTooltip({datum:r,mark:null,series:e.series},a,!1);let o=l.globalInstance;return dy.globalConfig.uniqueTooltip&&dy.hideTooltip(o.id),u}return"none"}(t,e,this);return"none"!==r&&(this._alwaysShow=!!(null==e?void 0:e.alwaysShow)),r}_isSameAsCache(t,e,i){if(i!==this._cacheActiveType)return!1;if(t===this._cacheInfo)return!0;if(et(this._cacheInfo)||et(t))return!1;if(wJ(t)){if(wQ(this._cacheInfo))return!1;let e=this._cacheInfo;return e.length===t.length&&t.every((t,i)=>f$(t,e[i]))}if(wJ(this._cacheInfo))return!1;let r=this._cacheInfo;if((null==t?void 0:t.datum)!==r.datum||(null==t?void 0:t.mark)!==r.mark||(null==t?void 0:t.series)!==r.series)return!1;let s=this._cacheParams;return!et(s)&&!et(e)&&s.mark===e.mark&&s.model===e.model&&s.datum===e.datum}_isPointerInChart(t){var e;let i=null==(e=this._option)?void 0:e.globalInstance;if(!i||!i.getChart())return!1;let{x:r,y:s}=t,{x:n,y:a,width:l,height:o}=i.getCanvas().getBoundingClientRect();return r>=n&&r<=n+l&&s>=a&&s<=a+o}getVisible(){return!1!==this._spec.visible}}w1.type=rA.tooltip,w1.transformerConstructor=w0,w1.builtInTheme={tooltip:{offset:{x:10,y:10},panel:{padding:{top:10,left:10,right:10,bottom:10},backgroundColor:{type:"palette",key:"popupBackgroundColor"},border:{color:{type:"palette",key:"popupBackgroundColor"},width:0,radius:3},shadow:{x:0,y:4,blur:12,spread:0,color:{type:"palette",key:"shadowColor"}}},spaceRow:6,titleLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0},shape:{size:8,spacing:6},keyLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle",spacing:26},valueLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0}}},w1.specKey="tooltip";let w2=()=>{ig.registerComponent(w1.type,w1)};class w3 extends gK.k{constructor(){super(...arguments),this.name="crosshair"}render(){this.renderCrosshair(this)}}(0,oo.M)(),(0,cG.N)();class w5 extends w3{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},w5.defaultAttributes,t))}renderCrosshair(t){let{start:e,end:i,lineStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-line",Object.assign({points:[e,i]},r),"line")}setLocation(t){let{start:e,end:i}=t;this.setAttributes({start:e,end:i})}}w5.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},(0,oo.M)(),(0,mJ.k)();class w4 extends w3{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},w4.defaultAttributes,t))}renderCrosshair(t){let{start:e,end:i,rectStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-rect",Object.assign({x:e.x,y:e.y,width:i.x-e.x,height:i.y-e.y},r),"rect")}setLocation(t){let{start:e,end:i}=t;this.setAttributes({start:e,end:i})}}w4.defaultAttributes={rectStyle:{fill:"#b2bacf",opacity:.2}};var w7=i(46293);(te=t_||(t_={}))[te.ALL=3]="ALL",te[te.HORIZONTAL=2]="HORIZONTAL",te[te.VERTICAL=1]="VERTICAL";var w6=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};let w9={x:["top","bottom"],y:["left","right"],category:["angle"],value:["radius"]};class w8 extends gO{get enableRemain(){return"none"===this.triggerOff}constructor(t,e){super(t,e),this.specKey="crosshair",this.layoutType="none",this.gridZIndex=z.CrossHair_Grid,this.labelZIndex=z.CrossHair,this.trigger="hover",this._handleIn=t=>{if(!this._option)return;let{x:e,y:i}=this.calculateTriggerPoint(t);this.showDefault=!1,this._layoutCrosshair(e,i);let r=this._getNeedClearVRenderComponents();this._hasActive=r.some(t=>t&&!1!==t.attribute.visible)},this._handleClickInEvent=t=>{if(!this._hasActive||!this._spec.lockAfterClick||this._clickLock)return this._clickLock?(this._clickLock=!1,void this._handleOutEvent()):void(this._onlyLockClick||(this._handleIn(t),tH(this.triggerOff)&&(this._timer&&clearTimeout(this._timer),this._timer=setTimeout(()=>{this._handleOutEvent()},this.triggerOff))));this._clickLock=!0},this._handleHoverInEvent=iH(t=>{this._clickLock||this._handleIn(t)},10),this._handleOutEvent=()=>{this.enableRemain||this._clickLock||!this._hasActive||(this.clearOutEvent(),this.hide())},this._handleTooltipShow=t=>{let e=t.tooltipData;if(t.isEmptyTooltip||!e||!e.length||ey(this._spec.followTooltip)&&!1===this._spec.followTooltip[t.activeType])return void this._handleTooltipHideOrRelease();let{x:i,y:r}=this.calculateTriggerPoint(t);this.showDefault=!1,this._layoutCrosshair(i,r,e,t.activeType);let s=this._getNeedClearVRenderComponents();this._hasActive=s.some(t=>t&&!1!==t.attribute.visible)},this._handleTooltipHideOrRelease=()=>{this.clearOutEvent(),this.hide()},this.enable=!0,this.showDefault=!0}_setAllAxisValues(t,e,i){let r=!1;if(t.forEach(t=>{ar(t.axis.getScale().type)&&(r?this.enable=!1:r=!0)}),!this.enable)return!1;let{currentValue:s}=this._stateByField[i];return t.forEach((t,i)=>{let r=t.axis;s.set(i,{datum:this._getDatumAtPoint(r,e),axis:r})}),!0}clearAxisValue(){Object.keys(this._stateByField).forEach(t=>{this._stateByField[t].currentValue.clear()})}hideCrosshair(){this.clearAxisValue(),this.hide()}showCrosshair(t){t&&t.length&&(this.showDefault=!1,this.clearAxisValue(),t.forEach(t=>{let{axis:e,value:i}=t;this.setAxisValue(i,e)}),this.layoutByValue(!1))}_getLimitBounds(){var t,e;if(!this._limitBounds){let{width:i,height:r}=null!=(e=null==(t=this._option.globalInstance.getChart())?void 0:t.getViewRect())?e:{width:0,height:0};this._limitBounds={x1:0,y1:0,x2:i,y2:r}}return this._limitBounds}_showDefaultCrosshairBySpec(){Object.keys(this._stateByField).forEach(t=>{let e=this._spec[t];if(e&&e.visible&&e.defaultSelect){let{axisIndex:i=0,datum:r}=e.defaultSelect,s=this._option.getComponentsByKey("axes").find(t=>t.getSpecIndex()===i);s&&(this._stateByField[t].currentValue.clear(),this._stateByField[t].currentValue.set(i,{axis:s,datum:r}))}})}_updateVisibleCrosshair(){let t=!1;Object.keys(this._stateByField).forEach(e=>{let i=this._spec[e];i&&i.visible&&this._stateByField[e].currentValue.size?t=!0:this._hideByField(e)}),t&&this.layoutByValue(!1)}_showDefaultCrosshair(){this.showDefault?(this._showDefaultCrosshairBySpec(),this.layoutByValue(!1)):this._updateVisibleCrosshair()}setAttrFromSpec(){super.setAttrFromSpec(),this._parseCrosshairSpec()}created(){super.created(),this._initEvent()}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||t1(e,t)||(i.reRender=!0,i.reMake=!0),i}_initEvent(){if(!this._option.disableTriggerEvent)if(this._spec.followTooltip)this._registerTooltipEvent();else{let t=this._getTriggerEvent();t&&t.forEach(t=>{this._registerEvent(t.in,!1,t.click),t.out&&this._registerEvent(t.out,!0)})}}_registerEvent(t,e,i){let r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent,s=e?{level:rO.chart}:{source:rP.chart};tY(t)?t.forEach(t=>{this.event.on(t,s,r)}):this.event.on(t,s,r)}_eventOff(t,e,i){let r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent;tY(t)?t.forEach(t=>{this.event.off(t,r)}):this.event.off(t,r)}onBeforeRender(){this._limitBounds=null,this._showDefaultCrosshair()}calculateTriggerPoint(t){let{event:e}=t,i=this._option.getCompiler().getStage().getLayer(void 0),r={x:e.viewX,y:e.viewY};return i.globalTransMatrix.transformPoint({x:e.viewX,y:e.viewY},r),{x:r.x-this.getLayoutStartPoint().x,y:r.y-this.getLayoutStartPoint().y}}_getTriggerEvent(){let{mode:t=rk["desktop-browser"]}=this._option,e=t===rk["desktop-browser"]||t===rk["desktop-miniApp"]?{click:"pointertap",hover:"pointermove",hoverOut:"pointerleave",clickOut:"pointerleave"}:eB(t)||eP(t)?{click:"tap",hover:["pointerdown","pointermove"],hoverOut:"pointerleave",clickOut:"pointerleave"}:null;if(e){let t=eo(this.trigger||"hover"),i=t=>"click"===t?"none"===this.triggerOff?null:e.clickOut:e.hoverOut;this._spec.lockAfterClick&&!t.includes("click")?(t.push("click"),this._onlyLockClick=!0):this._onlyLockClick=!1;let r=[];return t.forEach(t=>{r.push({click:"click"===t,in:e[t],out:i(t)})}),r}return null}_registerTooltipEvent(){this.event.on(rB.tooltipHide,{source:rP.chart},this._handleTooltipHideOrRelease),this.event.on(rB.tooltipShow,{source:rP.chart},this._handleTooltipShow),this.event.on(rB.tooltipRelease,{source:rP.chart},this._handleTooltipHideOrRelease)}_getAxisInfoByField(t){var e,i;let r=null==(i=(e=this._option).getComponentsByKey)?void 0:i.call(e,"axes");if(!(null==r?void 0:r.length))return null;let s=iF(this._spec,`${t}Field.bindingAxesIndex`);if(s||(s=[],r.forEach((e,i)=>{w9[t].includes(e.getOrient())&&s.push(i)})),!s.length)return null;let n=new Map,a=1/0,l=1/0,o=-1/0,h=-1/0,{x:u,y:d}=this.getLayoutStartPoint();return s.forEach(t=>{a=1/0,l=1/0,o=-1/0,h=-1/0;let e=r.find(e=>e.getSpecIndex()===t);e&&(e.getRegions().forEach(t=>{let{x:e,y:i}=t.getLayoutStartPoint();a=Math.min(a,e-u),l=Math.min(l,i-d),o=Math.max(o,e+t.getLayoutRect().width-u),h=Math.max(h,i+t.getLayoutRect().height-d)}),n.set(t,{x1:a,y1:l,x2:o,y2:h,axis:e}))}),n}onLayoutEnd(){let t=this._regions[0];this.setLayoutRect(t.getLayoutRect()),this.setLayoutStartPosition(t.getLayoutStartPoint()),super.onLayoutEnd()}_releaseEvent(){this.clearOutEvent();let t=this._getTriggerEvent();t&&t.forEach(t=>{this._eventOff(t.in,!1,t.click),t.out&&this._eventOff(t.out,!0)})}_parseFieldInfo(){Object.keys(this._stateByField).forEach(t=>{let e=this._spec[t],{crosshairComp:i}=this._stateByField[t];if(e&&e.visible){if(this._stateByField[t].attributes=this._parseField(e,t),i){let{style:e,type:r}=this._stateByField[t].attributes;i.setAttributes({["rect"===r?"rectStyle":"lineStyle"]:e})}}else i&&i.parent&&i.parent.removeChild(i)})}_parseCrosshairSpec(){this._parseFieldInfo();let{trigger:t,triggerOff:e,labelZIndex:i,gridZIndex:r}=this._spec;t&&(this.trigger=t),("none"===e||tH(e)&&e>0)&&(this.triggerOff=e),void 0!==i&&(this.labelZIndex=i),void 0!==r&&(this.gridZIndex=r)}_parseField(t,e){var i,r,s;let n={},{line:a={},label:l={},visible:o}=t;if(n.visible=o,n.type=a.type||"line",!1===a.visible)n.style={visible:!1};else{let e=a.style||{},{stroke:s,fill:l,lineWidth:o}=e,{strokeOpacity:h,fillOpacity:u,opacity:d}=e,c=w6(e,["strokeOpacity","fillOpacity","opacity"]),p="line"===n.type,g=p?h:u;if(tH(d)&&(g=(null!=g?g:1)*d),n.style=Object.assign({opacity:g,pickable:!1,visible:!0},c),p)n.style.stroke=s||l,n.style.lineWidth=iF(a,"width",o||2);else{n.style.fill=l||s,(null==(r=null==(i=null==t?void 0:t.line)?void 0:i.style)?void 0:r.stroke)&&(n.style.stroke=t.line.style.stroke);let e=iF(a,"width");if("string"==typeof e){let t=parseInt(e.substring(0,e.length-1),10)/100;n.style.sizePercent=t}else"number"!=typeof e&&"function"!=typeof e||(n.style.size=e)}}if(l.visible){let t=l.labelBackground||{},e=null!=(s=l.syncAxisLabelAngle)&&s,i=l.style||{},r=t.style||{},{fill:a="rgba(47, 59, 82, 0.9)",stroke:o,outerBorder:h}=r,u=w6(r,["fill","stroke","outerBorder"]);n.label={visible:!0,formatMethod:l.formatMethod,formatter:l.formatter,minWidth:t.minWidth,maxWidth:t.maxWidth,padding:t.padding,syncAxisLabelAngle:e,textStyle:Object.assign(Object.assign({fontSize:14,pickable:!1},i),{fill:i.fill||"#fff",stroke:iF(i,"stroke")}),panel:(t$(t.visible)?t.visible:t)?Object.assign({visible:!0,pickable:!1,fill:a,stroke:o,outerBorder:Object.assign({stroke:a,distance:0,lineWidth:3},h)},u):{visible:!1},zIndex:this.labelZIndex,childrenPickable:!1,pickable:!1}}else n.label={visible:!1};return n}_filterAxisByPoint(t,e,i){return t&&t.forEach(r=>{let s=r.axis;if((r.x1>e||r.x2<e||r.y1>i||r.y2<i)&&t.delete(s.getSpecIndex()),s.type.startsWith("polarAxis")){let r=s.getCenter(),n=s.getInnerRadius(),a=s.getOuterRadius(),l=dP.distancePP({x:e,y:i},r);(l>a||l<n)&&t.delete(s.getSpecIndex())}}),t}_updateCrosshairLabel(t,e,i){let r=this.getContainer();t?t.setAttributes(e):(t=new w7.V(e),null==r||r.add(t),i(t)),function(t,e){let{x1:i,y1:r,x2:s,y2:n}=e,{x1:a,y1:l,x2:o,y2:h}=t.AABBBounds,{dx:u=0,dy:d=0}=t.attribute,c=0,p=0;a<i&&(c=i-a),l<r&&(p=r-l),o>s&&(c=s-o),h>n&&(p=n-h),c&&t.setAttribute("dx",c+u),p&&t.setAttribute("dy",p+d)}(t,this._getLimitBounds())}clearOutEvent(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._clickLock&&(this._clickLock=null),this._hasActive&&(this._hasActive=null)}_hideByField(t){let{crosshairComp:e,labelsComp:i}=this._stateByField[t];e&&e.hideAll(),i&&Object.keys(i).forEach(t=>{i[t]&&i[t].hideAll()})}hide(){Object.keys(this._stateByField).forEach(t=>{this._hideByField(t)})}_getNeedClearVRenderComponents(){return Object.keys(this._stateByField).reduce((t,e)=>{let{crosshairComp:i,labelsComp:r}=this._stateByField[e];return i&&t.push(i),r&&Object.keys(r).forEach(e=>{r[e]&&t.push(r[e])}),t},[])}}w8.specKey="crosshair";let Tt={trigger:"hover",bandField:{visible:!1,line:{type:"rect",visible:!0,style:{fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineWidth:0,stroke:{type:"palette",key:"markLineStrokeColor"},lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}},linearField:{visible:!1,line:{type:"line",visible:!0,style:{stroke:{type:"palette",key:"markLineStrokeColor"},fill:"transparent",opacity:.7,lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}}};class Te extends w8{static getSpecInfo(t){return d0(t,this.specKey,this.type,t=>t.xField&&!1!==t.xField.visible||t.yField&&!1!==t.yField.visible)}constructor(t,e){super(t,e),this.type=rA.cartesianCrosshair,this.name=rA.cartesianCrosshair,this._stateByField={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:new Map,labelsComp:{top:null,bottom:null}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:new Map,labelsComp:{left:null,right:null}}}}_findAllAxisContains(t,e){let i=this._getAxisInfoByField("x"),r=this._getAxisInfoByField("y");return{xAxisMap:this._filterAxisByPoint(i,t,e),yAxisMap:this._filterAxisByPoint(r,t,e)}}_getDatumAtPoint(t,e){let i=p$(t.getOrient())?"x":"y",r=e[i]-(t.getLayoutStartPoint()[i]-this.getLayoutStartPoint()[i]);return t.getScale().invert(r)}setAxisValue(t,e){p$(e.getOrient())?this._stateByField.xField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.yField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})}_layoutCrosshair(t,e,i,r){var s;let n=t,a=e;if(i&&i.length){if("dimension"===r){let t,e=i[0],r=e.data.findIndex(t=>t.datum.length>0);if(r>-1){let i=e.data[r];t=i.series.dataToPosition(i.datum[0])}(t5(e.dimType)?"y"===e.dimType:pY(null==(s=null==e?void 0:e.axis)?void 0:s.getOrient()))?a=null==t?void 0:t.y:n=null==t?void 0:t.x}else if("mark"===r){let t=i[0],e=t.series.dataToPosition(t.datum[0]);n=null==e?void 0:e.x,a=null==e?void 0:e.y}}this.clearAxisValue();let{xAxisMap:l,yAxisMap:o}=this._findAllAxisContains(n,a);if(l&&0===l.size||o&&0===o.size){if(this.enableRemain)return;this.hide()}else l&&l.size&&this._setAllAxisValues(l,{x:n,y:a},"xField"),o&&o.size&&this._setAllAxisValues(o,{x:n,y:a},"yField"),this.layoutByValue()}layoutByValue(t){if(!this.enable)return;let e=pG(this._regions,"cartesian");e&&(f8(this._stateByField,e,this.getLayoutStartPoint(),null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach(t=>{this._layoutByField(t)}))}_layoutByField(t){let{cacheInfo:e,attributes:i,labelsComp:r,bandSize:s,coordKey:n}=this._stateByField[t];if(!i||!e||e._isCache&&this.enableRemain)return;let{coord:a,labels:l,visible:o,labelsTextStyle:h}=e;if(o){let o=mi(this._stateByField[t]);this._updateCrosshairByField(t,o),Object.keys(l).forEach(o=>{var u,d,c;if(l[o].visible){let p=Object.assign(Object.assign(Object.assign({[n]:a+s/2},l[o]),i.label),{angle:i.label.syncAxisLabelAngle&&null!=(d=null==(u=e.axisLabel)?void 0:u.attribute.angle)?d:0,textStyle:Object.assign(Object.assign({},null==(c=i.label)?void 0:c.textStyle),h[o]),zIndex:this.labelZIndex,visible:!0});this._updateCrosshairLabel(r[o],p,e=>{e.name=`crosshair-${t.replace("Field","")}-${o}-label`,r[o]=e})}else r[o]&&r[o].hideAll()})}else this._hideByField(t)}_updateCrosshairByField(t,e){let i=this.getContainer(),{attributes:r}=this._stateByField[t],{crosshairComp:s}=this._stateByField[t];if(s)s.setAttributes(e);else{let n=r.style;"line"===r.type?s=new w5(Object.assign(Object.assign({},e),{lineStyle:n,zIndex:this.gridZIndex+1,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1})):"rect"===r.type&&(s=new w4(Object.assign(Object.assign({},e),{rectStyle:n,zIndex:this.gridZIndex,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1}))),null==i||i.add(s),this._stateByField[t].crosshairComp=s}}}Te.specKey="crosshair",Te.builtInTheme={crosshair:Tt},Te.type=rA.cartesianCrosshair;let Ti=()=>{ig.registerComponent(Te.type,Te)};(0,oo.M)(),(0,vr.x)();class Tr extends w3{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},Tr.defaultAttributes,t))}renderCrosshair(t){let{center:e,radius:i,innerRadius:r=0,sectorStyle:s}=this.attribute,{startAngle:n,endAngle:a}=this.attribute;return t.createOrUpdateChild("crosshair-sector",Object.assign(Object.assign(Object.assign({},e),{outerRadius:i,innerRadius:r,startAngle:n,endAngle:a}),s),"arc")}setLocation(t){let{center:e,startAngle:i=c5.v2,endAngle:r=c5.Di}=this.attribute,s=r-i,n=(0,_9.Dt)((0,_9.Oy)(e,t));this.setAttributes({startAngle:n-s/2,endAngle:n+s/2})}}Tr.defaultAttributes={sectorStyle:{fill:"#b2bacf",opacity:.2}},(0,oo.M)(),(0,yM.N)();class Ts extends w3{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},Ts.defaultAttributes,t))}renderCrosshair(t){let e,{center:i,radius:r,sides:s=6,lineStyle:n}=this.attribute,{startAngle:a,endAngle:l}=this.attribute,o=(l-a)%(2*Math.PI)==0,h=(l-a)/s;for(let t=0;t<=s;t++){let n=(0,_9.op)(i,r,a+h*t);0===t?e=`M${n.x},${n.y}`:e+=`L${n.x},${n.y}`,t===s&&o&&(e+="Z")}return t.createOrUpdateChild("crosshair-polygon",Object.assign({path:e},n),"path")}setLocation(t){let{center:e}=this.attribute,i=uE.HL.distancePP(t,e);this.setAttribute("radius",i)}}Ts.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},(0,oo.M)(),(0,vr.x)();class Tn extends w3{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},Tn.defaultAttributes,t))}renderCrosshair(t){let{center:e,radius:i,lineStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-circle",Object.assign(Object.assign(Object.assign(Object.assign({},e),{outerRadius:i}),this.attribute),r),"arc")}setLocation(t){let{center:e}=this.attribute,i=uE.HL.distancePP(t,e);this.setAttribute("radius",i)}}Tn.defaultAttributes={lineStyle:{stroke:["#b2bacf",!1,!1,!1],lineWidth:1,lineDash:[2]}};let Ta=(t,e,i=!1)=>{Object.keys(t).forEach(r=>{let{attributes:s,currentValue:n,cacheInfo:a,coordKey:l}=t[r];if(s){let o=!!n.size,h=i&&!o&&t5(a),u=h?a:{coord:0,axis:null,visible:o,coordRange:[0,0],sizeRange:[0,0],labels:{all:{visible:!1,text:"",offset:0}}};if(a&&(a._isCache=h),"valueField"===r&&(u.sides=e.angleAxisHelper.getScale(0).domain().length),n.forEach(({axis:t,datum:i=""})=>{var n;let a=t.niceLabelFormatter;if((null==(n=s.label)?void 0:n.visible)&&(u.labels.all.visible=!0,u.labels.all.defaultFormatter=a,u.labels.all.text=i,u.labels.all.offset=ga(t.getSpec())),"categoryField"===r){let r=e.angleAxisHelper.dataToPosition([i]),s=e.angleAxisHelper.getBandwidth(0),n=t.getOuterRadius();u.coord=r,u.coordRange=[r-s/2,r+s/2],u.sizeRange=[n,n]}else{let r=t.startAngle,s=e.radiusAxisHelper.dataToPosition([i]);u.coord=s,u.coordRange=[s,s],u.sizeRange=[r,r]}u.axis=t}),u&&!h&&u.labels.all.visible&&s&&s.label){let t=u.labels.all,{formatMethod:e,formatter:i}=s.label,{formatFunc:r,args:n}=dJ(e,i,t.text,{label:t.text,orient:l});r?t.text=r(...n):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))}t[r].cacheInfo=u}})},Tl=(t,e,i)=>{let{cacheInfo:r,coordKey:s,attributes:n}=t,{axis:a,coord:l,sizeRange:o,coordRange:h}=r,u=a.getCenter(),d={x:u.x+e.x,y:u.y+e.y};if("angle"===s)return"sector"==("rect"===n.type?"sector":"line")?{center:d,innerRadius:a.getInnerRadius(),radius:a.getOuterRadius(),startAngle:h[0],endAngle:h[1]}:{start:lc(d,a.getInnerRadius(),l),end:lc(d,a.getOuterRadius(),l)};let c=a.startAngle,p=a.endAngle,g=r.sides,f=l;if(!i){let t=a.getCenter(),e=a.coordToPoint({angle:o[0],radius:l}),i=Math.atan2(e.y-t.y,e.x-t.x),r=(p-c)/g,s=Math.floor((i-c)/r),n=Math.min((s+1)*r+c,p),h=lc(t,l,s*r+c),u=lc(t,l,n),d=function(t,e,i,r){if(!pH(t,e,i,r))return!1;let s=[0,0],n=[0,0],a=[0,0];if(pj(s,e,t),pj(n,r,i),db(s[0]-n[0])+db(s[1]-n[1])<1e-12)return!0;pj(a,i,t);let l=dA(a,n)/dA(s,n);return l>=0&&l<=1&&[t[0]+s[0]*l,t[1]+s[1]*l]}([u.x,u.y],[h.x,h.y],[t.x,t.y],[e.x,e.y]);d&&(f=eH(dP.distancePN(e,d[0],d[1])+l,a.getInnerRadius(),a.getOuterRadius()))}return{center:d,startAngle:c,endAngle:p,radius:f,sides:g}};class To extends w8{static getSpecInfo(t){return d0(t,this.specKey,this.type,t=>t.categoryField&&!1!==t.categoryField.visible||t.valueField&&!1!==t.valueField.visible)}constructor(t,e){super(t,e),this.type=rA.polarCrosshair,this.name=rA.polarCrosshair,this._stateByField={categoryField:{coordKey:"angle",anotherAxisKey:"radius",currentValue:new Map,labelsComp:{all:null}},valueField:{coordKey:"radius",anotherAxisKey:"angle",currentValue:new Map,labelsComp:{all:null}}}}setAxisValue(t,e){"radius"===e.getOrient()?this._stateByField.valueField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.categoryField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})}_findAllAxisContains(t,e){let i=this._getAxisInfoByField("category"),r=this._getAxisInfoByField("value");return{angleAxisMap:this._filterAxisByPoint(i,t,e),radiusAxisMap:this._filterAxisByPoint(r,t,e)}}_getDatumAtPoint(t,e){let{x:i,y:r}=t.getLayoutStartPoint(),{x:s,y:n}=this.getLayoutStartPoint();return t.positionToData({x:e.x-(i-s),y:e.y-(r-n)})}_layoutCrosshair(t,e,i,r){let s=t,n=e;if(i&&i.length){if("dimension"===r){let t=i[0];if(t.axis){let e=t.axis.pointToCoord({x:s,y:n}),i="radius"===t.axis.getOrient()?{radius:t.position,angle:e.angle}:{radius:e.radius,angle:t.position},r=t.axis.coordToPoint(i);s=r.x,n=r.y}}else if("mark"===r){let t=i[0],e=t.series.dataToPosition(t.datum[0]);s=e.x,n=e.y}}this.clearAxisValue();let{angleAxisMap:a,radiusAxisMap:l}=this._findAllAxisContains(s,n);if(0!==a.size||0!==l.size)a&&this._setAllAxisValues(a,{x:s,y:n},"categoryField"),l&&this._setAllAxisValues(l,{x:s,y:n},"valueField"),this.layoutByValue();else{if(this.enableRemain)return;this.hide()}}layoutByValue(t){if(!this.enable)return;let e=pG(this._regions,"polar");e&&(Ta(this._stateByField,e,null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach(t=>{this._layoutByField(t)}))}_layoutByField(t){var e,i,r,s;let{cacheInfo:n,attributes:a,crosshairComp:l,labelsComp:o,coordKey:h}=this._stateByField[t];if(!n||n._isCache&&this.enableRemain)return;let u=this.getContainer(),{visible:d,labels:c,coord:p,sizeRange:g,axis:f}=n;if(d){let n=this.getLayoutStartPoint(),d=null==(i=null==(e=this._spec.valueField)?void 0:e.line)?void 0:i.smooth,m=Tl(this._stateByField[t],n,d);if(l)l.setAttributes(m);else{let e;if("angle"===h){let t="rect"===a.type?"sector":"line";"line"===t?e=new w5(Object.assign(Object.assign({},m),{lineStyle:a.style,zIndex:this.gridZIndex,pickable:!1})):"sector"===t&&(e=new Tr(Object.assign(Object.assign({},m),{sectorStyle:a.style,zIndex:this.gridZIndex,pickable:!1})))}else e="polygon"==(d?"circle":"polygon")?new Ts(Object.assign(Object.assign({},m),{lineStyle:a.style,zIndex:this.gridZIndex+1})):new Tn(Object.assign(Object.assign({},m),{lineStyle:a.style,zIndex:this.gridZIndex}));this._stateByField[t].crosshairComp=e,u.add(e)}let y=c.all;if(y.visible){let t,e,i=f.getCenter(),l={x:i.x+n.x,y:i.y+n.y},u="angle"===h?(0,gq.mU)(p):(s=f.startAngle,{align:(s=lg(s))>=7/6*Math.PI&&s<=11/6*Math.PI?"right":s>=1/6*Math.PI&&s<=5/6*Math.PI?"left":"center",baseline:s>=5/3*Math.PI||s<=1/3*Math.PI?"bottom":s>=2/3*Math.PI&&s<=4/3*Math.PI?"top":"middle"}),d=Object.assign(Object.assign(Object.assign(Object.assign({},"angle"===h?lc(l,g[1]+y.offset,p):lc(l,m.radius,f.startAngle)),a.label),y),{textStyle:Object.assign(Object.assign({},null==(r=a.label)?void 0:r.textStyle),{textAlign:u.align,textBaseline:u.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(o.all,d,t=>{t.name=`crosshair-${h}-label`,o.all=t})}else o.all&&o.all.hideAll()}}}To.specKey="crosshair",To.builtInTheme={crosshair:Tt},To.type=rA.polarCrosshair;let Th=()=>{ig.registerComponent(To.type,To)},Tu=(t,e)=>{let{getNewDomain:i,isContinuous:r,field:s,originalFields:n}=e,a=s(),l=i();if(et(l)||et(a))return t;let o=n(),h=tY(a)?a[0]:a;return t[h]&&o&&o[h]&&o[h].lockStatisticsByDomain&&!r()&&(t[h].values=l),t},Td=(t,e)=>{let{getNewDomain:i,isContinuous:r,field:s}=e,n=s(),a=i();if(et(a)||et(n))return t;if(0===a.length)return[];let l={};a.forEach(t=>{l[t]||(l[t]=1)});let o=null;return o=r()?t=>{let e=!1;return eo(n).every(i=>{t[i]>=a[0]&&t[i]<=eh(a)&&(e=!0)}),e}:t=>{let e=!1;return eo(n).every(i=>{(l[t[i]+""]||l[t[i]])&&(e=!0)}),e},t.filter(o)},Tc=(t,e)=>{let{stateFields:i,valueFields:r,dataCollection:s,isCategoryState:n}=e.input,{stateField:a,valueField:l}=e.output,o={},h=[],u=[],d=!1;return s.forEach((t,e)=>{var s;if(et(i[e]))return;let n=null==(s=t.getFields())?void 0:s[i[e]];n&&n.lockStatisticsByDomain&&(d=!0,n.domain.forEach(t=>{et(o[t])&&(u.push(t),o[t]=0)})),t.latestData.forEach(t=>{eo(i[e]).forEach(i=>{et(t[i])||(et(o[t[i]])&&(u.push(t[i]),o[t[i]]=0),et(r[e])||(o[t[i]]+=isNaN(parseFloat(t[r[e]]))?1:parseFloat(t[r[e]])))})})}),(d?u:!1===n?u.sort((t,e)=>t-e):Object.keys(o)).forEach(t=>{let e={[a]:t};l&&(e[l]=o[t]),h.push(e)}),h};class Tp extends gO{get relatedAxisComponent(){return this._relatedAxisComponent}setStartAndEnd(t,e,i=["percent","percent"]){let[r="percent",s="percent"]=i,n="percent"===r?t:this.dataToStatePoint(t),a="percent"===s?e:this.dataToStatePoint(e);this._handleChange(n,a,!0)}enableInteraction(){this._activeRoam=!0}disableInteraction(){this._activeRoam=!1}zoomIn(t){this._handleChartZoom({zoomDelta:1.2,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})}zoomOut(t){this._handleChartZoom({zoomDelta:.8,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})}_handleChange(t,e,i){var r,s;null!=(s=null==(r=this._spec)?void 0:r.zoomLock)&&s||e-t!==this._spanCache&&(e-t<this._minSpan||e-t>this._maxSpan)?this._shouldChange=!1:(this._shouldChange=!0,this._spanCache=e-t)}_isReverse(){let t=this._relatedAxisComponent;if(!t)return!1;let e=t.getScale();return e.range()[0]>e.range()[1]&&(!t.getInverse()||this._isHorizontal)}_updateRangeFactor(t){let e=this._relatedAxisComponent,i=e.getScale(),r=this._isReverse(),s=r?[1-this._end,1-this._start]:[this._start,this._end];if(r)switch(t){case"startHandler":e.scaleRangeFactorEnd(s[1]);break;case"endHandler":e.scaleRangeFactorStart(s[0]);break;default:e.scaleRangeFactorStart(s[0],!0),e.scaleRangeFactorEnd(s[1])}else switch(t){case"startHandler":e.scaleRangeFactorStart(s[0]);break;case"endHandler":e.scaleRangeFactorEnd(s[1]);break;default:e.scaleRangeFactorEnd(s[1],!0),e.scaleRangeFactorStart(s[0])}let n=i.rangeFactor();n?(this._start=r?1-n[1]:n[0],this._end=r?1-n[0]:n[1]):(this._start=0,this._end=1)}get visible(){return this._visible}constructor(t,e){super(t,e),this.layoutType="none",this._orient="left",this._cacheVisibility=void 0,this._dataUpdating=!1,this._shouldChange=!0,this._stateField="x",this._activeRoam=!0,this._zoomAttr={enable:!0,rate:1,focus:!0},this._dragAttr={enable:!0,rate:1,reverse:!0},this._scrollAttr={enable:!0,rate:1,reverse:!0},this.effect={onZoomChange:t=>{var e,i;let r=this._relatedAxisComponent;if(r&&"axis"===this._filterMode){let s=r.getScale(),n=r.getSpec();this._auto&&this._getAxisBandSize(n)&&this._spec.ignoreBandSize&&(s.bandwidth("auto"),s.maxBandwidth("auto"),s.minBandwidth("auto")),this._updateRangeFactor(t),this._auto&&(null==(i=null==(e=this._component)?void 0:e.setStartAndEnd)||i.call(e,this._start,this._end)),r.effect.scaleUpdate({value:"force"})}else pW(this._regions,t=>{var e;null==(e=t.getViewData())||e.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),pW(this._regions,t=>{t.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._visible=!0,this._handleStateChange=(t,e,i)=>{var r,s;return this._startValue=t,this._endValue=e,this._newDomain=this._parseDomainFromState(this._startValue,this._endValue),null==(s=(r=this.effect).onZoomChange)||s.call(r,i),!0},this._handleChartZoom=(t,e)=>{var i,r;if(!this._activeRoam||this._zoomAttr.filter&&!this._zoomAttr.filter(t,e))return;let{zoomDelta:s,zoomX:n,zoomY:a}=t,{x:l,y:o}=this._regions[0].getLayoutStartPoint(),{width:h,height:u}=this._regions[0].getLayoutRect(),d=Math.abs(this._start-this._end),c=null!=(r=null==(i=this._spec.roamZoom)?void 0:i.rate)?r:1;if(d>=1&&s<1||d<=.01&&s>1)return;let p=this._isHorizontal?n:a,g=d*(s-1)*c,f=g/2,m=g/2;if(p){let t=this._isHorizontal?l:o,e=this._isHorizontal?h:u;f=Math.abs(t-p)/Math.abs(e-t)*g,m=Math.abs(e-p)/Math.abs(e-t)*g}let y=eH(this._start+f,0,1),_=eH(this._end-m,0,1);this._handleChange(Math.min(y,_),Math.max(y,_),!0)},this._handleChartScroll=(t,e)=>{var i;if(!this._activeRoam||this._scrollAttr.filter&&!this._scrollAttr.filter(t,e))return!1;let{scrollX:r,scrollY:s}=t,n=this._isHorizontal?r:s,a=this._isHorizontal?db(r/s)>=.5:db(s/r)>=.5;this._scrollAttr.reverse||(n=-n),a&&this._handleChartMove(n,null!=(i=this._scrollAttr.rate)?i:1);let l=0!==this._start&&1!==this._end;return a&&l},this._handleChartDrag=(t,e)=>{var i;if(!this._activeRoam||this._dragAttr.filter&&!this._dragAttr.filter(t,e))return;let[r,s]=t,n=this._isHorizontal?r:s;this._dragAttr.reverse&&(n=-n),this._handleChartMove(n,null!=(i=this._dragAttr.rate)?i:1)},this._handleChartMove=(t,e)=>{let i=this._isHorizontal?this.getLayoutRect().width:this.getLayoutRect().height;if(Math.abs(t)>=1e-6){if(t>0&&this._end<1){let r=Math.min(1-this._end,t/i)*e;this._handleChange(this._start+r,this._end+r,!0)}else if(t<0&&this._start>0){let r=Math.max(-this._start,t/i)*e;this._handleChange(this._start+r,this._end+r,!0)}}return!1},this._orient=pK(t),this._isHorizontal="horizontal"===pq(this._orient)}created(){super.created(),this._setAxisFromSpec(),this._setRegionsFromSpec(),this._initEvent(),this._initData(),this._initStateScale(),this._setStateFromSpec()}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}_setAxisFromSpec(){if(t5(this._spec.axisId)?this._relatedAxisComponent=this._option.getComponentByUserId(this._spec.axisId):t5(this._spec.axisIndex)&&(this._relatedAxisComponent=this._option.getComponentByIndex("axes",this._spec.axisIndex)),et(this._spec.field)&&!this._relatedAxisComponent){let t=this._option.getComponentsByKey("axes"),e=t.find(t=>t._orient===this._orient);if(e)this._relatedAxisComponent=e;else{let e=t.find(t=>!ai(t.getScale().type));this._relatedAxisComponent=e}}this._relatedAxisComponent&&"axis"===this._filterMode&&(this._relatedAxisComponent.autoIndentOnce=!0)}_setRegionsFromSpec(){var t,e;this._regions=this._relatedAxisComponent?this._relatedAxisComponent.getRegions():this._option.getAllRegions();let i=this._relatedAxisComponent?null==(e=(t=this._relatedAxisComponent).getBindSeriesFilter)?void 0:e.call(t):null;if(t5(i)&&(t5(i.userId)&&(this._seriesUserId=eo(i.userId)),t5(i.specIndex)&&(this._seriesIndex=eo(i.specIndex))),t5(this._spec.seriesId)){let t=eo(this._spec.seriesId);this._seriesUserId?this._seriesUserId=this._seriesUserId.filter(e=>t.includes(e)):this._seriesUserId=t}if(t5(this._spec.seriesIndex)){let t=eo(this._spec.seriesIndex);this._seriesIndex?this._seriesIndex=this._seriesIndex.filter(e=>t.includes(e)):this._seriesIndex=t}if(t5(this._spec.regionIndex)){let t=this._option.getRegionsInIndex(eo(this._spec.regionIndex));this._regions=this._regions.filter(e=>t.includes(e))}else if(t5(this._spec.regionId)){let t=eo(this._spec.regionId);this._regions=t.length?this._regions.filter(e=>t.includes(e.id)):[]}}onDataUpdate(){var t;let e=this._computeDomainOfStateScale(ai(this._stateScale.type));this._stateScale.domain(e,!1),this._handleChange(this._start,this._end,!0),this._spec.auto&&!t1(this._domainCache,e)&&(this._domainCache=e,this._dataUpdating=!0,null==(t=this.getChart())||t.setLayoutTag(!0,null,!1))}_computeDomainOfStateScale(t){if(this._spec.customDomain)return this._spec.customDomain;let e=this._data.getLatestData().map(t=>t[this._stateField]);if(t){let t=e.map(t=>+t);return e.length?[ed(t),eu(t)]:[-1/0,1/0]}return e}_initEvent(){this._initCommonEvent()}_initData(){let t,e=[],i=[],r=[];if(this._relatedAxisComponent){let s={};pW(this._regions,n=>{var a,l;let o="cartesian"===n.coordinate?n.getXAxisHelper():"polar"===n.coordinate?n.angleAxisHelper:null,h="cartesian"===n.coordinate?n.getYAxisHelper():"polar"===n.coordinate?n.radiusAxisHelper:null;if(!o||!h)return;let u=o.getAxisId()===this._relatedAxisComponent.id?o:h.getAxisId()===this._relatedAxisComponent.id?h:this._isHorizontal?o:h,d=u===o?h:o;e.push(n.getRawData());let c=n.getSpec(),p="cartesian"===n.coordinate?eo(c.xField):eo(null!=(a=c.angleField)?a:c.categoryField),g="cartesian"===n.coordinate?eo(c.yField):eo(null!=(l=c.radiusField)?l:c.valueField);if(s[n.id]="link"===n.type?["from_xField"]:u===o?p:g,ai(u.getScale(0).type)?(t=!1,i.push(s[n.id])):i.push(s[n.id][0]),this._valueField){let t="link"===n.type?["from_yField"]:d===o?p:g;ai(d.getScale(0).type)&&r.push(...t)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._originalStateFields=s}else pW(this._regions,t=>{e.push(t.getRawData()),i.push(this._field),this._valueField&&r.push(this._spec.valueField)},{userId:this._seriesUserId,specIndex:this._seriesIndex});let{dataSet:s}=this._option;sX(s,"dataview",tX),sY(s,"dataFilterComputeDomain",Tc);let n=new er(s,{name:`${this.type}_${this.id}_data`});n.transform({type:"dataFilterComputeDomain",options:{input:{dataCollection:e,stateFields:i,valueFields:r,isCategoryState:t},output:{stateField:this._stateField,valueField:this._valueField}}},!1),this._data=new ly(this._option,n),n.reRunAllTransform(),s.multipleDataViewAddListener(e,"change",this._handleDataCollectionChange.bind(this))}setAttrFromSpec(){var t;super.setAttrFromSpec(),!0===this._spec.roamZoom||this._spec.roamZoom?this._zoomAttr=t8({},this._zoomAttr,this._spec.roamZoom):this._zoomAttr.enable=!1,!0===this._spec.roamDrag||this._spec.roamDrag?this._dragAttr=t8({},this._dragAttr,this._spec.roamDrag):this._dragAttr.enable=!1,!0===this._spec.roamScroll||this._spec.roamScroll?this._scrollAttr=t8({},this._scrollAttr,this._spec.roamScroll):this._scrollAttr.enable=!1,this._field=this._spec.field,this._width=this._computeWidth(),this._height=this._computeHeight(),this._visible=null==(t=this._spec.visible)||t}statePointToData(t){let e=this._stateScale,i=e.domain();if(ai(e.type))return this._isReverse()?i[0]+(eh(i)-i[0])*(1-t):i[0]+(eh(i)-i[0])*t;let r=e.range();this._isReverse()&&(r=r.slice().reverse());let s=r[0]+(eh(r)-r[0])*t;return e.invert(s)}dataToStatePoint(t){let e=this._stateScale,i=e.scale(t),r=e.range();return!this._isHorizontal&&ai(e.type)&&(r=r.slice().reverse()),(i-r[0])/(eh(r)-r[0])}_modeCheck(t,e){return"start"===t?"percent"===e&&t5(this._spec.start)||"value"===e&&t5(this._spec.startValue):"percent"===e&&t5(this._spec.end)||"value"===e&&t5(this._spec.endValue)}_setStateFromSpec(){var t,e;let i,r;if(this._auto=!!this._spec.auto,this._spec.rangeMode){let[t,e]=this._spec.rangeMode;this._modeCheck("start",t)&&this._modeCheck("end",e)&&(i="percent"===t?this._spec.start:this.dataToStatePoint(this._spec.startValue),r="percent"===e?this._spec.end:this.dataToStatePoint(this._spec.endValue))}else i=this._spec.start?this._spec.start:this._spec.startValue?this.dataToStatePoint(this._spec.startValue):0,r=this._spec.end?this._spec.end:this._spec.endValue?this.dataToStatePoint(this._spec.endValue):1;this._startValue=this.statePointToData(i),this._endValue=this.statePointToData(r),this._start=i,this._end=r,this._minSpan=null!=(t=this._spec.minSpan)?t:0,this._maxSpan=null!=(e=this._spec.maxSpan)?e:1,ai(this._stateScale.type)&&this._stateScale.domain()[0]!==eh(this._stateScale.domain())&&(this._spec.minValueSpan&&(this._minSpan=this._spec.minValueSpan/(eh(this._stateScale.domain())-this._stateScale.domain()[0])),this._spec.maxValueSpan&&(this._maxSpan=this._spec.maxValueSpan/(eh(this._stateScale.domain())-this._stateScale.domain()[0]))),this._minSpan=Math.max(0,this._minSpan),this._maxSpan=Math.min(this._maxSpan,1),this._relatedAxisComponent&&"axis"===this._filterMode||0===this._start&&1===this._end||(this._newDomain=this._parseDomainFromState(this._startValue,this._endValue))}_parseFieldOfSeries(t){var e;return null==(e=this._originalStateFields)?void 0:e[t.id]}_initStateScale(){let t=[0,1];if(this._relatedAxisComponent){let e=this._relatedAxisComponent.getScale(),i=ai(e.type),r=this._computeDomainOfStateScale(i);if(this._stateScale=e.clone(),i){let e=r.map(t=>+t);this._stateScale.domain(r.length?[ed(e),eu(e)]:[0,1],!0).range(t)}else this._stateScale.domain(r,!0).range(t)}else this._stateScale=new a9,this._stateScale.domain(this._computeDomainOfStateScale(),!0).range(t)}init(t){super.init(t),this._addTransformToSeries(),0===this._start&&1===this._end||this.effect.onZoomChange()}_addTransformToSeries(){this._relatedAxisComponent&&"axis"===this._filterMode||(sY(this._option.dataSet,"dataFilterWithNewDomain",Td),sY(this._option.dataSet,"lockStatisticsFilter",Tu),pW(this._regions,t=>{t.getViewDataStatistics().transform({type:"lockStatisticsFilter",options:{originalFields:()=>t.getViewDataStatistics().getFields(),getNewDomain:()=>this._newDomain,field:()=>{var e;return null!=(e=this._field)?e:this._parseFieldOfSeries(t)},isContinuous:()=>ai(this._stateScale.type)},level:1},!1),t.addViewDataFilter({type:"dataFilterWithNewDomain",options:{getNewDomain:()=>this._newDomain,field:()=>{var e;return null!=(e=this._field)?e:this._parseFieldOfSeries(t)},isContinuous:()=>ai(this._stateScale.type)},level:L.dataZoomFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex}))}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||t1(e,t)||(i.reRender=!0,i.reMake=!0),i}reInit(t){super.reInit(t),this._marks.forEach(t=>{t.getMarks().forEach(t=>{this.initMarkStyleWithSpec(t,this._spec[t.name])})})}_parseDomainFromState(t,e){if(ai(this._stateScale.type))return[Math.min(e,t),Math.max(e,t)];let i=this._stateScale.domain(),r=i.indexOf(t),s=i.indexOf(e);return i.slice(Math.min(r,s),Math.max(r,s)+1)}_initCommonEvent(){var t,e,i,r,s,n,a;let l={delayType:null!=(e=null==(t=this._spec)?void 0:t.delayType)?e:"throttle",delayTime:t5(null==(i=this._spec)?void 0:i.delayType)?null!=(s=null==(r=this._spec)?void 0:r.delayTime)?s:30:0,realTime:null==(a=null==(n=this._spec)?void 0:n.realTime)||a,allowComponentZoom:!0};this._zoomAttr.enable&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom,l),this._scrollAttr.enable&&this.initScrollEventOfRegions(this._regions,null,this._handleChartScroll,l),this._dragAttr.enable&&this.initDragEventOfRegions(this._regions,null,this._handleChartDrag,l)}updateLayoutAttribute(){this._visible&&this._createOrUpdateComponent(),super.updateLayoutAttribute()}_autoVisible(t){if(!this._auto)return;t?this.show():this.hide();let e=this._isHorizontal?"height":"width";this.layout.setLayoutRect({[e]:t?this[`_${e}`]:0},{[e]:H.Built_In})}onLayoutStart(t,e){super.onLayoutStart(t,e);let i=this._autoUpdate(t);this._autoVisible(i),this._dataUpdating=!1}onLayoutEnd(){let t=0!==this._start||1!==this._end;this._autoVisible(t),super.onLayoutEnd()}getBoundsInRect(t){let e={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0};return this._isHorizontal?(e.y2=e.y1+this._height,e.x2=e.x1+t.width):(e.x2=e.x1+this._width,e.y2=e.y1+t.height),e}hide(){var t;null==(t=this._component)||t.hideAll()}show(){var t;null==(t=this._component)||t.showAll()}_getAxisBandSize(t){let e=null==t?void 0:t.bandSize,i=null==t?void 0:t.maxBandSize,r=null==t?void 0:t.minBandSize;if(e||r||i)return{bandSize:e,maxBandSize:i,minBandSize:r}}_autoUpdate(t){var e,i,r,s,n,a;if(!this._auto)return this._cacheVisibility=void 0,!0;let l=this._relatedAxisComponent,o=null==l?void 0:l.getSpec(),h=null==l?void 0:l.getScale(),u=this._getAxisBandSize(o);if(!this._dataUpdating&&ar(h.type)&&(null==t?void 0:t.height)===(null==(e=this._cacheRect)?void 0:e.height)&&(null==t?void 0:t.width)===(null==(i=this._cacheRect)?void 0:i.width)&&this._fixedBandSize===(null==u?void 0:u.bandSize))return this._cacheVisibility;let d=!0;if(this._isHorizontal&&(null==t?void 0:t.width)!==(null==(r=this._cacheRect)?void 0:r.width)?h.range(l.getInverse()?[t.width,0]:[0,t.width]):(null==t?void 0:t.height)!==(null==(s=this._cacheRect)?void 0:s.height)&&h.range(l.getInverse()?[0,t.height]:[t.height,0]),this._cacheRect={width:null==t?void 0:t.width,height:null==t?void 0:t.height},this._fixedBandSize=null==u?void 0:u.bandSize,ar(h.type)){u&&(this._start||this._end)&&(this.type===rA.scrollBar&&(this._start=0,this._end=1),this._updateRangeFactor());let[t,e]=null!=(n=h.rangeFactor())?n:[];d=(!et(t)||!et(e))&&(0!==t||1!==e)}else{let[t,e]=null!=(a=h.rangeFactor())?a:[this._start,this._end];d=0!==t||1!==e}return this.setStartAndEnd(this._start,this._end),this._cacheVisibility=d,d}_getNeedClearVRenderComponents(){return[this._component]}}cD(Tp,_j);var Tg=i(10391),Tf=i(70527),Tm=i(88663);let Ty="M -0.0544 0.25 C -0.0742 0.25 -0.0901 0.234 -0.0901 0.2143 L -0.0901 -0.1786 C -0.0901 -0.1983 -0.0742 -0.2143 -0.0544 -0.2143 L -0.0187 -0.2143 L -0.0187 -0.5 L 0.017 -0.5 L 0.017 -0.2143 L 0.0527 -0.2143 C 0.0724 -0.2143 0.0884 -0.1983 0.0884 -0.1786 L 0.0884 0.2143 C 0.0884 0.234 0.0724 0.25 0.0527 0.25 L 0.017 0.25 L 0.017 0.5 L -0.0187 0.5 L -0.0187 0.25 L -0.0544 0.25 Z M -0.0187 -0.1429 L -0.0544 -0.1429 L -0.0544 0.1786 L -0.0187 0.1786 L -0.0187 -0.1429 Z M 0.0527 -0.1429 L 0.017 -0.1429 L 0.017 0.1786 L 0.0527 0.1786 L 0.0527 -0.1429 Z",T_={horizontal:{angle:0,strokeBoundsBuffer:0,boundsPadding:2,pickMode:"imprecise",cursor:"ew-resize"},vertical:{angle:Math.PI/180*90,cursor:"ns-resize",boundsPadding:2,pickMode:"imprecise",strokeBoundsBuffer:0}};(ti=tv||(tv={})).startHandler="startHandler",ti.endHandler="endHandler",ti.middleHandler="middleHandler",ti.background="background";var Tv=i(48683),Tb=i(39144),Tx=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};let TS={debounce:Tg.Z,throttle:Tf.Z};(0,Tv.b)(),(0,mJ.k)(),(0,pL.k)(),mI(),(0,cG.N)();class Tk extends gK.k{setPropsFromAttrs(){let{start:t,end:e,orient:i,previewData:r,previewPointsX:s,previewPointsY:n,previewPointsX1:a,previewPointsY1:l}=this.attribute;t&&(this.state.start=t),e&&(this.state.end=e);let{width:o,height:h}=this.getLayoutAttrFromConfig();this._spanCache=this.state.end-this.state.start,this._isHorizontal="top"===i||"bottom"===i,this._layoutCache.max=this._isHorizontal?o:h,this._layoutCache.attPos=this._isHorizontal?"x":"y",this._layoutCache.attSize=this._isHorizontal?"width":"height",r&&(this._previewData=r),(0,uc.Z)(s)&&(this._previewPointsX=s),(0,uc.Z)(n)&&(this._previewPointsY=n),(0,uc.Z)(a)&&(this._previewPointsX1=a),(0,uc.Z)(l)&&(this._previewPointsY1=l)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},Tk.defaultAttributes,t)),this.name="dataZoom",this._previewData=[],this._activeState=!1,this._activeCache={startPos:{x:0,y:0},lastPos:{x:0,y:0}},this._layoutCache={attPos:"x",attSize:"width",max:0},this.state={start:0,end:1},this._statePointToData=t=>t,this._handleTouchMove=t=>{this._activeState&&t.preventDefault()},this._onHandlerPointerDown=(t,e)=>{this._clearDragEvents(),"start"===e?(this._activeTag=tv.startHandler,this._activeItem=this._startHandlerMask):"end"===e?(this._activeTag=tv.endHandler,this._activeItem=this._endHandlerMask):"middleRect"===e?(this._activeTag=tv.middleHandler,this._activeItem=this._middleHandlerRect):"middleSymbol"===e?(this._activeTag=tv.middleHandler,this._activeItem=this._middleHandlerSymbol):"background"===e&&(this._activeTag=tv.background,this._activeItem=this._background),this._activeState=!0,this._activeCache.startPos=this.eventPosToStagePos(t),this._activeCache.lastPos=this.eventPosToStagePos(t);let i="browser"===es.rF.env?es.rF:this.stage,r=(0,Tb.G)();i.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),r.forEach(t=>{i.addEventListener(t,this._onHandlerPointerUp)})},this._pointerMove=t=>{let{start:e,end:i,brushSelect:r,realTime:s=!0}=this.attribute,n=this.eventPosToStagePos(t),{attPos:a,max:l}=this._layoutCache,o=(n[a]-this._activeCache.lastPos[a])/l,{start:h,end:u}=this.state;this._activeState&&(this._activeTag===tv.middleHandler?this.moveZoomWithMiddle((this.state.start+this.state.end)/2+o):this._activeTag===tv.startHandler?h+o>u?(u=(h=u)+o,this._activeTag=tv.endHandler):h+=o:this._activeTag===tv.endHandler&&(u+o<h?(h=(u=h)+o,this._activeTag=tv.startHandler):u+=o),this._activeCache.lastPos=n,r&&this.renderDragMask()),h=Math.min(Math.max(h,0),1),u=Math.min(Math.max(u,0),1),e===h&&i===u||(this.setStateAttr(h,u,!0),s&&this._dispatchEvent("change",{start:h,end:u,tag:this._activeTag}))},this._onHandlerPointerMove=0===this.attribute.delayTime?this._pointerMove:TS[this.attribute.delayType](this._pointerMove,this.attribute.delayTime),this._onHandlerPointerUp=t=>{let{start:e,end:i,brushSelect:r,realTime:s=!0}=this.attribute;if(this._activeState&&this._activeTag===tv.background){let e=this.eventPosToStagePos(t);this.backgroundDragZoom(this._activeCache.startPos,e)}this._activeState=!1,r&&this.renderDragMask(),this._dispatchEvent("change",{start:this.state.start,end:this.state.end,tag:this._activeTag}),this._clearDragEvents()};let{position:i,showDetail:r}=t;this._activeCache.startPos=i,this._activeCache.lastPos=i,this._showText="auto"!==r&&r,this.setPropsFromAttrs()}setAttributes(t,e){super.setAttributes(t,e),this.setPropsFromAttrs()}bindEvents(){if(this.attribute.disableTriggerEvent)return void this.setAttribute("childrenPickable",!1);let{showDetail:t,brushSelect:e}=this.attribute;this._startHandlerMask&&this._startHandlerMask.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"start")),this._endHandlerMask&&this._endHandlerMask.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"end")),this._middleHandlerSymbol&&this._middleHandlerSymbol.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"middleSymbol")),this._middleHandlerRect&&this._middleHandlerRect.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"middleRect"));let i=e?"background":"middleRect";this._selectedBackground&&this._selectedBackground.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,i)),e&&this._background&&this._background.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"background")),e&&this._previewGroup&&this._previewGroup.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"background")),this._selectedPreviewGroup&&this._selectedPreviewGroup.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,i)),"auto"===t&&(this.addEventListener("pointerenter",this._onHandlerPointerEnter),this.addEventListener("pointerleave",this._onHandlerPointerLeave)),("browser"===es.rF.env?es.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}dragMaskSize(){let{position:t}=this.attribute,{attPos:e,max:i}=this._layoutCache;return this._activeCache.lastPos[e]-t[e]>i?i+t[e]-this._activeCache.startPos[e]:this._activeCache.lastPos[e]-t[e]<0?t[e]-this._activeCache.startPos[e]:this._activeCache.lastPos[e]-this._activeCache.startPos[e]}setStateAttr(t,e,i){let{zoomLock:r=!1,minSpan:s=0,maxSpan:n=1}=this.attribute,a=e-t;a!==this._spanCache&&(r||a<s||a>n)||(this._spanCache=a,this.state.start=t,this.state.end=e,i&&this.setAttributes({start:t,end:e}))}_clearDragEvents(){let t="browser"===es.rF.env?es.rF:this.stage,e=(0,Tb.G)();t.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),e.forEach(e=>{t.removeEventListener(e,this._onHandlerPointerUp)}),this.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0})}_onHandlerPointerEnter(t){this._showText=!0,this.renderText()}_onHandlerPointerLeave(t){this._showText=!1,this.renderText()}backgroundDragZoom(t,e){let{attPos:i,max:r}=this._layoutCache,{position:s}=this.attribute,n=t[i]-s[i],a=e[i]-s[i],l=Math.min(Math.max(Math.min(n,a)/r,0),1),o=Math.min(Math.max(Math.max(n,a)/r,0),1);.01>Math.abs(l-o)?this.moveZoomWithMiddle(l):this.setStateAttr(l,o,!1)}moveZoomWithMiddle(t){let e=t-(this.state.start+this.state.end)/2;0!==e&&(e>0?this.state.end+e>1&&(e=1-this.state.end):e<0&&this.state.start+e<0&&(e=-this.state.start),this.setStateAttr(this.state.start+e,this.state.end+e,!1))}renderDragMask(){let{dragMaskStyle:t}=this.attribute,{position:e,width:i,height:r}=this.getLayoutAttrFromConfig();this._isHorizontal?this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:(0,uC.Z)(0>this.dragMaskSize()?this._activeCache.lastPos.x:this._activeCache.startPos.x,e.x,e.x+i),y:e.y,width:this._activeState&&this._activeTag===tv.background&&Math.abs(this.dragMaskSize())||0,height:r},t),"rect"):this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:e.x,y:(0,uC.Z)(0>this.dragMaskSize()?this._activeCache.lastPos.y:this._activeCache.startPos.y,e.y,e.y+r),width:i,height:this._activeState&&this._activeTag===tv.background&&Math.abs(this.dragMaskSize())||0},t),"rect")}isTextOverflow(t,e,i){if(!e)return!1;if(this._isHorizontal){if("start"===i){if(e.x1<t.x1)return!0}else if(e.x2>t.x2)return!0}else if("start"===i){if(e.y1<t.y1)return!0}else if(e.y2>t.y2)return!0;return!1}setTextAttr(t,e){var i,r,s,n,a,l,o,h;let u,d,c,p,{startTextStyle:g,endTextStyle:f}=this.attribute,{formatMethod:m}=g,y=Tx(g,["formatMethod"]),{formatMethod:_}=f,v=Tx(f,["formatMethod"]),{start:b,end:x}=this.state;this._startValue=this._statePointToData(b),this._endValue=this._statePointToData(x);let{position:S,width:k,height:A}=this.getLayoutAttrFromConfig(),M=m?m(this._startValue):this._startValue,w=_?_(this._endValue):this._endValue,T={x1:S.x,y1:S.y,x2:S.x+k,y2:S.y+A};this._isHorizontal?(u={x:S.x+b*k,y:S.y+A/2},d={x:S.x+x*k,y:S.y+A/2},c={textAlign:this.isTextOverflow(T,t,"start")?"left":"right",textBaseline:null!=(r=null==(i=null==y?void 0:y.textStyle)?void 0:i.textBaseline)?r:"middle"},p={textAlign:this.isTextOverflow(T,e,"end")?"right":"left",textBaseline:null!=(n=null==(s=null==v?void 0:v.textStyle)?void 0:s.textBaseline)?n:"middle"}):(u={x:S.x+k/2,y:S.y+b*A},d={x:S.x+k/2,y:S.y+x*A},c={textAlign:null!=(l=null==(a=null==y?void 0:y.textStyle)?void 0:a.textAlign)?l:"center",textBaseline:this.isTextOverflow(T,t,"start")?"top":"bottom"},p={textAlign:null!=(h=null==(o=null==v?void 0:v.textStyle)?void 0:o.textAlign)?h:"center",textBaseline:this.isTextOverflow(T,e,"end")?"bottom":"top"}),this._startText=this.maybeAddLabel(this._container,(0,cZ.Z)({},y,{text:M,x:u.x,y:u.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:c}),`data-zoom-start-text-${S}`),this._endText=this.maybeAddLabel(this._container,(0,cZ.Z)({},v,{text:w,x:d.x,y:d.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:p}),`data-zoom-end-text-${S}`)}renderText(){let t=null,e=null;this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds,this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds;let{x1:i,x2:r,y1:s,y2:n}=t,{dx:a=0,dy:l=0}=this.attribute.startTextStyle;if((new lC.YZ).set(i,s,r,n).intersects(e)){let t="bottom"===this.attribute.orient||"right"===this.attribute.orient?-1:1;if(this._isHorizontal){let i=Math.abs(e.y1-e.y2);this._startText.setAttribute("dy",l+t*(Number.isFinite(i)?i:0))}else{let i=Math.abs(e.x1-e.x2);this._startText.setAttribute("dx",a+t*(Number.isFinite(i)?i:0))}}else this._isHorizontal?this._startText.setAttribute("dy",l):this._startText.setAttribute("dx",a)}getLayoutAttrFromConfig(){var t,e,i,r,s,n;let a,l,o;if(this._layoutAttrFromConfig)return this._layoutAttrFromConfig;let{position:h,size:u,orient:d,middleHandlerStyle:c={},startHandlerStyle:p={},endHandlerStyle:g={},backgroundStyle:f={}}=this.attribute,{width:m,height:y}=u,_=null!=(e=null==(t=c.background)?void 0:t.size)?e:10;c.visible?this._isHorizontal?(a=m,l=y-_,o={x:h.x,y:h.y+_}):(a=m-_,l=y,o={x:h.x+("left"===d?_:0),y:h.y}):(a=m,l=y,o=h);let v=null!=(i=p.size)?i:this._isHorizontal?l:a,b=null!=(r=g.size)?r:this._isHorizontal?l:a;return p.visible&&(this._isHorizontal?(a-=(v+b)/2,o={x:o.x+v/2,y:o.y}):(l-=(v+b)/2,o={x:o.x,y:o.y+v/2})),l+=(s=f.lineWidth/2,s),a+=(n=f.lineWidth/2,n),this._layoutAttrFromConfig={position:o,width:a,height:l},this._layoutAttrFromConfig}render(){var t,e,i,r,s,n,a,l,o,h,u,d,c,p,g,f,m,y,_,v,b,x,S,k,A,M,w,T,C,E,B,P,O,I;this._layoutAttrFromConfig=null;let{orient:R,backgroundStyle:L,backgroundChartStyle:D={},selectedBackgroundStyle:F={},selectedBackgroundChartStyle:z={},middleHandlerStyle:j={},startHandlerStyle:H={},endHandlerStyle:N={},brushSelect:V,zoomLock:W}=this.attribute,{start:U,end:G}=this.state,{position:Z,width:$,height:Y}=this.getLayoutAttrFromConfig(),X=null!=(t=H.triggerMinSize)?t:40,K=null!=(e=N.triggerMinSize)?e:40,q=this.createOrUpdateChild("dataZoom-container",{},"group");if(this._container=q,this._background=q.createOrUpdateChild("background",Object.assign(Object.assign({x:Z.x,y:Z.y,width:$,height:Y,cursor:V?"crosshair":"auto"},L),{pickable:!W&&(null==(i=L.pickable)||i)}),"rect"),(null==(r=D.line)?void 0:r.visible)&&this.setPreviewAttributes("line",q),(null==(s=D.area)?void 0:s.visible)&&this.setPreviewAttributes("area",q),V&&this.renderDragMask(),this._isHorizontal?this._selectedBackground=q.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:Z.x+U*$,y:Z.y,width:(G-U)*$,height:Y,cursor:V?"crosshair":"move"},F),{pickable:!W&&(null==(n=z.pickable)||n)}),"rect"):this._selectedBackground=q.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:Z.x,y:Z.y+U*Y,width:$,height:(G-U)*Y,cursor:V?"crosshair":"move"},F),{pickable:!W&&(null==(a=F.pickable)||a)}),"rect"),(null==(l=z.line)?void 0:l.visible)&&this.setSelectedPreviewAttributes("line",q),(null==(o=z.area)?void 0:o.visible)&&this.setSelectedPreviewAttributes("area",q),this._isHorizontal){if(j.visible){let t=(null==(h=j.background)?void 0:h.size)||10;this._middleHandlerRect=q.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:Z.x+U*$,y:Z.y-t,width:(G-U)*$,height:t},null==(u=j.background)?void 0:u.style),{pickable:!W&&(null==(p=null==(c=null==(d=j.background)?void 0:d.style)?void 0:c.pickable)||p)}),"rect"),this._middleHandlerSymbol=q.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:Z.x+(U+G)/2*$,y:Z.y-t/2,strokeBoundsBuffer:0,angle:0,symbolType:null!=(f=null==(g=j.icon)?void 0:g.symbolType)?f:"square"},j.icon),{pickable:!W&&(null==(m=j.icon.pickable)||m)}),"symbol")}this._startHandler=q.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:Z.x+U*$,y:Z.y+Y/2,size:Y,symbolType:null!=(y=H.symbolType)?y:"square"},T_.horizontal),H),{pickable:!W&&(null==(_=H.pickable)||_)}),"symbol"),this._endHandler=q.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:Z.x+G*$,y:Z.y+Y/2,size:Y,symbolType:null!=(v=N.symbolType)?v:"square"},T_.horizontal),N),{pickable:!W&&(null==(b=N.pickable)||b)}),"symbol");let t=Math.max(this._startHandler.AABBBounds.width(),X),e=Math.max(this._startHandler.AABBBounds.height(),X),i=Math.max(this._endHandler.AABBBounds.width(),K),r=Math.max(this._endHandler.AABBBounds.height(),K);this._startHandlerMask=q.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:Z.x+U*$-t/2,y:Z.y+Y/2-e/2,width:t,height:e,fill:"white",fillOpacity:0,zIndex:999},T_.horizontal),{pickable:!W}),"rect"),this._endHandlerMask=q.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:Z.x+G*$-i/2,y:Z.y+Y/2-r/2,width:i,height:r,fill:"white",fillOpacity:0,zIndex:999},T_.horizontal),{pickable:!W}),"rect")}else{if(j.visible){let t=(null==(x=j.background)?void 0:x.size)||10;this._middleHandlerRect=q.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:"left"===R?Z.x-t:Z.x+$,y:Z.y+U*Y,width:t,height:(G-U)*Y},null==(S=j.background)?void 0:S.style),{pickable:!W&&(null==(M=null==(A=null==(k=j.background)?void 0:k.style)?void 0:A.pickable)||M)}),"rect"),this._middleHandlerSymbol=q.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:"left"===R?Z.x-t/2:Z.x+$+t/2,y:Z.y+(U+G)/2*Y,angle:Math.PI/180*90,symbolType:null!=(T=null==(w=j.icon)?void 0:w.symbolType)?T:"square",strokeBoundsBuffer:0},j.icon),{pickable:!W&&(null==(E=null==(C=j.icon)?void 0:C.pickable)||E)}),"symbol")}this._startHandler=q.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:Z.x+$/2,y:Z.y+U*Y,size:$,symbolType:null!=(B=H.symbolType)?B:"square"},T_.vertical),H),{pickable:!W&&(null==(P=H.pickable)||P)}),"symbol"),this._endHandler=q.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:Z.x+$/2,y:Z.y+G*Y,size:$,symbolType:null!=(O=N.symbolType)?O:"square"},T_.vertical),N),{pickable:!W&&(null==(I=N.pickable)||I)}),"symbol");let t=Math.max(this._startHandler.AABBBounds.width(),X),e=Math.max(this._startHandler.AABBBounds.height(),X),i=Math.max(this._endHandler.AABBBounds.width(),K),r=Math.max(this._endHandler.AABBBounds.height(),K);this._startHandlerMask=q.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:Z.x+$/2+t/2,y:Z.y+U*Y-e/2,width:r,height:i,fill:"white",fillOpacity:0,zIndex:999},T_.vertical),{pickable:!W}),"rect"),this._endHandlerMask=q.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:Z.x+$/2+i/2,y:Z.y+G*Y-r/2,width:r,height:i,fill:"white",fillOpacity:0,zIndex:999},T_.vertical),{pickable:!W}),"rect")}this._showText&&this.renderText()}computeBasePoints(){let t,e,{orient:i}=this.attribute,{position:r,width:s,height:n}=this.getLayoutAttrFromConfig();return this._isHorizontal?(t=[{x:r.x,y:r.y+n}],e=[{x:r.x+s,y:r.y+n}]):"left"===i?(t=[{x:r.x+s,y:r.y}],e=[{x:r.x+s,y:r.y+n}]):(t=[{x:r.x,y:r.y+n}],e=[{x:r.x,y:r.y}]),{basePointStart:t,basePointEnd:e}}simplifyPoints(t){var e,i;if(t.length>1e4){let r=null!=(e=this.attribute.tolerance)?e:this._previewData.length/1e4;return(i=t).length<=10?i:i=function(t,e){let i,r,s=t[0].x,n=t[0].y,a=[t[0]];for(let l=1,o=t.length;l<o;l++)(i=t[l].x-s)*i+(r=t[l].y-n)*r>e&&(s=t[l].x,n=t[l].y,a.push(t[l]));return t[t.length-1].x===s&&t[t.length-1].y===n||a.push(t[t.length-1]),a}(i,void 0!==r?r*r:1)}return t}getPreviewLinePoints(){let t=this._previewData.map(t=>({x:this._previewPointsX&&this._previewPointsX(t),y:this._previewPointsY&&this._previewPointsY(t)}));if(0===t.length)return t;t=this.simplifyPoints(t);let{basePointStart:e,basePointEnd:i}=this.computeBasePoints();return e.concat(t).concat(i)}getPreviewAreaPoints(){let t=this._previewData.map(t=>({x:this._previewPointsX&&this._previewPointsX(t),y:this._previewPointsY&&this._previewPointsY(t),x1:this._previewPointsX1&&this._previewPointsX1(t),y1:this._previewPointsY1&&this._previewPointsY1(t)}));if(0===t.length)return t;t=this.simplifyPoints(t);let{basePointStart:e,basePointEnd:i}=this.computeBasePoints();return e.concat(t).concat(i)}setPreviewAttributes(t,e){this._previewGroup||(this._previewGroup=e.createOrUpdateChild("previewGroup",{pickable:!1},"group")),"line"===t?this._previewLine=this._previewGroup.createOrUpdateChild("previewLine",{},"line"):this._previewArea=this._previewGroup.createOrUpdateChild("previewArea",{curveType:"basis"},"area");let{backgroundChartStyle:i={}}=this.attribute;"line"===t&&this._previewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},i.line)),"area"===t&&this._previewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},i.area))}setSelectedPreviewAttributes(t,e){this._selectedPreviewGroupClip||(this._selectedPreviewGroupClip=e.createOrUpdateChild("selectedPreviewGroupClip",{pickable:!1},"group"),this._selectedPreviewGroup=this._selectedPreviewGroupClip.createOrUpdateChild("selectedPreviewGroup",{},"group")),"line"===t?this._selectedPreviewLine=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewLine",{},"line"):this._selectedPreviewArea=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewArea",{curveType:"basis"},"area");let{selectedBackgroundChartStyle:i={}}=this.attribute,{start:r,end:s}=this.state,{position:n,width:a,height:l}=this.getLayoutAttrFromConfig();this._selectedPreviewGroupClip.setAttributes({x:this._isHorizontal?n.x+r*a:n.x,y:this._isHorizontal?n.y:n.y+r*l,width:this._isHorizontal?(s-r)*a:a,height:this._isHorizontal?l:(s-r)*l,clip:!0,pickable:!1}),this._selectedPreviewGroup.setAttributes({x:-(this._isHorizontal?n.x+r*a:n.x),y:-(this._isHorizontal?n.y:n.y+r*l),width:this._isHorizontal?(s-r)*a:a,height:this._isHorizontal?l:(s-r)*l,pickable:!1}),"line"===t&&this._selectedPreviewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},i.line)),"area"===t&&this._selectedPreviewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},i.area))}maybeAddLabel(t,e,i){let r=this.find(t=>t.name===i,!0);return r?r.setAttributes(e):(r=new w7.V(e)).name=i,t.add(r),r}setStartAndEnd(t,e){let{start:i,end:r}=this.attribute;(0,cX.Z)(t)&&(0,cX.Z)(e)&&(t!==this.state.start||e!==this.state.end)&&(this.state.start=t,this.state.end=e,i===this.state.start&&r===this.state.end||(this.setStateAttr(t,e,!0),this._dispatchEvent("change",{start:t,end:e,tag:this._activeTag})))}setPreviewData(t){this._previewData=t}setText(t,e){"start"===e?this._startText.setAttribute("text",t):this._endText.setAttribute("text",t)}getStartValue(){return this._startValue}getEndTextValue(){return this._endValue}getMiddleHandlerSize(){var t,e,i,r;let{middleHandlerStyle:s={}}=this.attribute,n=null!=(e=null==(t=s.background)?void 0:t.size)?e:10,a=null!=(r=null==(i=s.icon)?void 0:i.size)?r:10;return Math.max(n,...(0,Tm.IX)(a))}setPreviewPointsX(t){(0,uc.Z)(t)&&(this._previewPointsX=t)}setPreviewPointsY(t){(0,uc.Z)(t)&&(this._previewPointsY=t)}setPreviewPointsX1(t){(0,uc.Z)(t)&&(this._previewPointsX1=t)}setPreviewPointsY1(t){(0,uc.Z)(t)&&(this._previewPointsY1=t)}setStatePointToData(t){(0,uc.Z)(t)&&(this._statePointToData=t)}release(t){super.release(t),("browser"===es.rF.env?es.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}Tk.defaultAttributes={orient:"bottom",showDetail:"auto",brushSelect:!0,zoomLock:!1,minSpan:0,maxSpan:1,delayType:"throttle",delayTime:0,realTime:!0,backgroundStyle:{fill:"white",stroke:"#D1DBEE",lineWidth:1,cornerRadius:2},dragMaskStyle:{fill:"#B0C8F9",fillOpacity:.2},backgroundChartStyle:{area:{visible:!0,stroke:"#D1DBEE",lineWidth:1,fill:"#F6F8FC"},line:{visible:!0,stroke:"#D1DBEE",lineWidth:1}},selectedBackgroundStyle:{fill:"#B0C8F9",fillOpacity:.5},selectedBackgroundChartStyle:{area:{visible:!0,stroke:"#B0C8F9",lineWidth:1,fill:"#fbb934"},line:{visible:!0,stroke:"#fbb934",lineWidth:1}},middleHandlerStyle:{visible:!0,background:{size:8,style:{fill:"white",stroke:"#B0C8F9",cornerRadius:2}},icon:{size:6,fill:"white",stroke:"#B0C8F9",symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}},startHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:Ty,fill:"white",stroke:"#B0C8F9",lineWidth:.5},endHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:Ty,fill:"white",stroke:"#B0C8F9",lineWidth:.5},startTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}},endTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}}};class TA extends gB{_mergeThemeToSpec(t,e){let i=this._theme,r=t;if(this._shouldMergeThemeToSpec()){let e=t=>{let e=it({selectedBackgroundChart:{line:{},area:{}}},this._theme,t),{selectedBackgroundChart:i={}}=t,{line:r,area:s}=i;return r&&!1!==r.visible&&(e.selectedBackgroundChart.line.style=Object.assign(Object.assign({},e.selectedBackgroundChart.line.style),{visible:!0})),s&&!1!==s.visible&&(e.selectedBackgroundChart.area.style=Object.assign(Object.assign({},e.selectedBackgroundChart.area.style),{visible:!0})),e};r=tY(t)?t.map(t=>e(t)):e(t)}return this._adjustPadding(r),{spec:r,theme:i}}}let TM=()=>({style:{symbolType:"M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}}),Tw=t=>({area:{style:{visible:t,stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{visible:t,stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}}),TT={padding:[12,0],showDetail:"auto",brushSelect:!1,middleHandler:{visible:!1,background:{size:6,style:{stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},cornerRadius:2}},icon:{style:{size:4,fill:{type:"palette",key:"sliderHandleColor"},stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}}},background:{size:20,style:{fill:{type:"palette",key:"sliderRailColor"},lineWidth:0}},selectedBackground:{style:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.1,outerBorder:{stroke:{type:"palette",key:"sliderTrackColor"},strokeOpacity:.2,distance:-.5,lineWidth:1}}},selectedBackgroundChart:Tw(!1),startHandler:TM(),endHandler:TM(),startText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},endText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},backgroundChart:Tw(!0)};class TC extends Tp{constructor(t,e){var i;super(t,e),this.type=rA.dataZoom,this.name=rA.dataZoom,this.transformerConstructor=TA,this.specKey="dataZoom",this.layoutZIndex=z.DataZoom,this.layoutLevel=j.DataZoom,this.layoutType="region-relative",this._isReverseCache=!1,this._dataToPositionX=t=>{let e="left"===this._orient?this._middleHandlerSize:0,i=this._isHorizontal?this._startHandlerSize/2:0,r=this._isHorizontal?this._stateScale:this._valueScale,s=this._isHorizontal?this._stateField:this._valueField;return r.scale(t[s])+this.getLayoutStartPoint().x+e+i},this._dataToPositionX2=t=>{let e="left"===this._orient?this._middleHandlerSize:0,i=this._isHorizontal?this._startHandlerSize/2:0,r=this._isHorizontal?this._stateScale:this._valueScale,s=r.domain()[0];return r.scale(s)+this.getLayoutStartPoint().x+e+i},this._dataToPositionY=t=>{let e=this._isHorizontal?this._middleHandlerSize:0,i=this._isHorizontal?0:this._startHandlerSize/2,r=this._isHorizontal?this._valueScale:this._stateScale,s=this._isHorizontal?this._valueField:this._stateField;return r.scale(t[s])+this.getLayoutStartPoint().y+e+i},this._dataToPositionY2=t=>{let e=this._isHorizontal?this._middleHandlerSize:0,i=this._isHorizontal?0:this._startHandlerSize/2,r=this._isHorizontal?this._valueScale:this._stateScale,s=r.domain()[0];return r.scale(s)+this.getLayoutStartPoint().y+e+i},this._valueField="y",this._filterMode=null!=(i=t.filterMode)?i:"filter"}created(){super.created(),this._initValueScale()}setAttrFromSpec(){var t,e,i,r,s,n,a,l,o,h;super.setAttrFromSpec(),t$(this._spec.roam)&&(this._zoomAttr.enable=this._spec.roam,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode),this._backgroundSize=null!=(e=null==(t=this._spec.background)?void 0:t.size)?e:30,this._middleHandlerSize=this._computeMiddleHandlerSize(),this._width=this._computeWidth(),this._height=this._computeHeight(),et(null==(s=null==(r=null==(i=this._spec)?void 0:i.startHandler)?void 0:r.style)?void 0:s.size)&&(this._spec.startHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize),et(null==(l=null==(a=null==(n=this._spec)?void 0:n.endHandler)?void 0:a.style)?void 0:l.size)&&(this._spec.endHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize);let u=null==(o=this._spec.startHandler.style.visible)||o,d=null==(h=this._spec.endHandler.style.visible)||h;this._startHandlerSize=u?this._spec.startHandler.style.size:0,this._endHandlerSize=d?this._spec.endHandler.style.size:0}onLayoutEnd(){this._updateScaleRange(),this._isReverse()&&!this._isReverseCache&&(this._isReverseCache=this._isReverse(),this.effect.onZoomChange()),!1!==this._cacheVisibility&&super.onLayoutEnd()}_initValueScale(){let t=this._computeDomainOfValueScale();if(t){let e=new a2;e.domain(t),this._valueScale=e}}_updateScaleRange(){var t,e;let i,r=this._startHandlerSize+this._endHandlerSize;if(!this._stateScale||!this._valueScale)return;let s=this._isHorizontal?this.getLayoutRect().width-r:this.getLayoutRect().height-r,n=null!=(e=null==(t=this._relatedAxisComponent)?void 0:t.getScale().range())?e:[this._startHandlerSize/2,s+this._startHandlerSize/2],a=this._computeWidth(),l=this._computeHeight();this._isHorizontal?(i=this._visible?[this._startHandlerSize/2,a-r+this._startHandlerSize/2]:n,this._stateScale.range(i),this._valueScale.range([l-this._middleHandlerSize,0])):(i=this._visible?[this._startHandlerSize/2,l-r+this._startHandlerSize/2]:n,this._stateScale.range(i),"left"===this.layoutOrient?this._valueScale.range([a-this._middleHandlerSize,0]):this._valueScale.range([0,a-this._middleHandlerSize])),this._component&&!1!==this._cacheVisibility&&this._component.setAttributes({size:{width:a,height:l},position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y}})}_computeDomainOfValueScale(){let t=this._data.getLatestData().map(t=>t[this._valueField]),e=t.map(t=>+t);return t.length?[ed(e),eu(e)]:null}_computeMiddleHandlerSize(){var t,e,i,r;let s=0;return(null==(e=null==(t=this._spec)?void 0:t.middleHandler)?void 0:e.visible)&&(s+=Math.max(null!=(i=this._spec.middleHandler.icon.style.size)?i:8,null!=(r=this._spec.middleHandler.background.size)?r:40)),s}_computeWidth(){return!1===this._visible?0:tH(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:this._backgroundSize+this._middleHandlerSize}_computeHeight(){return!1===this._visible?0:tH(this._spec.height)?this._spec.height:this._isHorizontal?this._backgroundSize+this._middleHandlerSize:this.getLayoutRect().height}_isScaleValid(t){if(!t||!t.domain())return!1;let e=t.domain();return(!ai(t.type)||e[0]!==eh(e))&&(!ar(t.type)||1!==(e&&tY(e)?Array.from(new Set(eo(e))):e).length)}_getAttrs(t){var e,i,r,s,n;let a=null!=(e=this._spec)?e:{};return Object.assign({zIndex:this.layoutZIndex,start:this._start,end:this._end,position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},orient:this._orient,size:{width:this._computeWidth(),height:this._computeHeight()},showDetail:a.showDetail,brushSelect:null!=(i=a.brushSelect)&&i,zoomLock:null!=(r=a.zoomLock)&&r,minSpan:this._minSpan,maxSpan:this._maxSpan,delayType:a.delayType,delayTime:t5(a.delayType)?null!=(s=a.delayTime)?s:30:0,realTime:null==(n=a.realTime)||n,previewData:t&&this._data.getLatestData(),previewPointsX:t&&this._dataToPositionX,previewPointsY:t&&this._dataToPositionY,tolerance:this._spec.tolerance},this._getComponentAttrs(t))}_createOrUpdateComponent(){if(this._visible){let t=this._isHorizontal?this._stateScale:this._valueScale,e=this._isHorizontal?this._valueScale:this._stateScale,i=this._isScaleValid(t)&&this._isScaleValid(e)&&!1!==this._spec.showBackgroundChart,r=this._getAttrs(i);if(this._component)this._component.setAttributes(r);else{let t=this.getContainer();this._component=new Tk(r),this._isHorizontal?i&&this._component.setPreviewPointsY1(this._dataToPositionY2):i&&this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData(t=>this.statePointToData(t)),this._component.addEventListener("change",t=>{let{start:e,end:i,tag:r}=t.detail;this._handleChange(e,i,void 0,r)}),t.add(this._component),this._updateScaleRange()}}}_handleChange(t,e,i,r){if(super._handleChange(t,e,i),this._shouldChange){i&&this._component&&this._component.setStartAndEnd(t,e),this._start=t,this._end=e;let s=this.statePointToData(t),n=this.statePointToData(e);(tK(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(t,e,s,n):this._handleStateChange(s,n,r))&&this.event.emit(rB.dataZoomChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:t,end:e,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){var t;let e=this._data.getDataView();if(e.reRunAllTransform(),null==(t=this._component)||t.setPreviewData(e.latestData),this._valueScale){let t=this._computeDomainOfValueScale();t&&this._valueScale.domain(t)}}_getComponentAttrs(t){var e,i,r,s,n,a,l,o,h,u,d;let{middleHandler:c={},startText:p={},endText:g={},backgroundChart:f={},selectedBackgroundChart:m={}}=this._spec;return{backgroundStyle:gs(null==(e=this._spec.background)?void 0:e.style),startHandlerStyle:gs(null==(i=this._spec.startHandler)?void 0:i.style),middleHandlerStyle:c.visible?{visible:!0,icon:gs(null==(r=c.icon)?void 0:r.style),background:{size:null==(s=c.background)?void 0:s.size,style:gs(null==(n=c.background)?void 0:n.style)}}:{visible:!1},endHandlerStyle:gs(null==(a=this._spec.endHandler)?void 0:a.style),startTextStyle:{padding:p.padding,formatMethod:this._getHandlerTextFormatMethod(p),textStyle:gs(p.style)},endTextStyle:{padding:g.padding,formatMethod:this._getHandlerTextFormatMethod(g),textStyle:gs(g.style)},selectedBackgroundStyle:gs(this._spec.selectedBackground.style),dragMaskStyle:gs(null==(l=this._spec.dragMask)?void 0:l.style),backgroundChartStyle:t?{line:it(gs(null==(o=f.line)?void 0:o.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},gs(null==(h=f.area)?void 0:h.style))}:{line:{visible:!1},area:{visible:!1}},selectedBackgroundChartStyle:t?{line:it(gs(null==(u=m.line)?void 0:u.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},gs(null==(d=m.area)?void 0:d.style))}:{line:{visible:!1},area:{visible:!1}},disableTriggerEvent:this._option.disableTriggerEvent}}_getHandlerTextFormatMethod(t){let{formatMethod:e,formatter:i}=t,{formatFunc:r}=dJ(e,i);return r?t=>r(t,{label:t},i):void 0}_getNeedClearVRenderComponents(){return[this._component]}clear(){if(this._component){let t=this.getContainer();this._component.removeAllChild(),t&&t.removeChild(this._component),this._component=null}super.clear()}}TC.type=rA.dataZoom,TC.transformerConstructor=TA,TC.builtInTheme={dataZoom:TT},TC.specKey="dataZoom";let TE=()=>{ig.registerComponent(TC.type,TC)};class TB extends Tp{constructor(t,e){var i;super(t,e),this.type=rA.scrollBar,this.name=rA.scrollBar,this.specKey="scrollBar",this.layoutZIndex=z.DataZoom,this.layoutLevel=j.DataZoom,this.layoutType="region-relative",this._filterMode=null!=(i=t.filterMode)?i:"axis"}setAttrFromSpec(){super.setAttrFromSpec(),t$(this._spec.roam)&&(this._zoomAttr.enable=!1,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode)}onLayoutEnd(){var t,e;this._updateScaleRange(),null==(e=(t=this.effect).onZoomChange)||e.call(t),super.onLayoutEnd()}_updateScaleRange(){this._component&&this._component.setAttributes({x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height})}_computeWidth(){return tH(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:12}_computeHeight(){return tH(this._spec.height)?this._spec.height:this._isHorizontal?12:this.getLayoutRect().height}_getAttrs(){var t,e,i,r,s,n;return Object.assign({zIndex:this.layoutZIndex,x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height,range:[this._start,this._end],direction:this._isHorizontal?"horizontal":"vertical",delayType:null==(t=this._spec)?void 0:t.delayType,delayTime:t5(null==(e=this._spec)?void 0:e.delayType)?null!=(r=null==(i=this._spec)?void 0:i.delayTime)?r:30:0,realTime:null==(n=null==(s=this._spec)?void 0:s.realTime)||n},this._getComponentAttrs())}_createOrUpdateComponent(){let t=this._getAttrs();if(this._component)this._component.setAttributes(t);else{let e=this.getContainer();this._component=new MI.B(t),this._component.addEventListener("scrollDrag",t=>{let e=t.detail.value;this._handleChange(e[0],e[1])}),this._component.addEventListener("scrollUp",t=>{let e=t.detail.value;this._handleChange(e[0],e[1])}),e.add(this._component)}}_handleChange(t,e,i){super._handleChange(t,e,i);let r=a3(this._start,t)&&a3(this._end,e);if(this._shouldChange&&(!r||!1===this._spec.realTime)){i&&this._component&&this._component.setAttribute("range",[t,e]),this._start=t,this._end=e;let r=this.statePointToData(t),s=this.statePointToData(e);(tK(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(t,e,r,s):this._handleStateChange(this.statePointToData(t),this.statePointToData(e)))&&this.event.emit(rB.scrollBarChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:this._start,end:this._end,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){this._spec.auto&&this._data.getDataView().reRunAllTransform()}_getComponentAttrs(){let{rail:t,slider:e,innerPadding:i}=this._spec,r={};return et(i)||(r.padding=i),nR(null==t?void 0:t.style)||(r.railStyle=gs(t.style)),nR(null==e?void 0:e.style)||(r.sliderStyle=gs(e.style)),r.disableTriggerEvent=this._option.disableTriggerEvent,r}_getNeedClearVRenderComponents(){return[this._component]}}TB.type=rA.scrollBar,TB.builtInTheme={scrollBar:{horizontal:{height:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}},vertical:{width:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}}}},TB.specKey="scrollBar";let TP=()=>{ig.registerComponent(TB.type,TB)},TO=(t,e)=>{let{datum:i,title:r,content:s}=e,n=[],a=i.call(null);return r.visible&&n.push({type:"title",index:0,datum:a,spec:r}),eo(s).forEach((t,e)=>{t.visible&&n.push({type:"content",index:e,datum:a,spec:t})}),n},TI={title:{style:{text:"",fontSize:20,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{style:{text:"",fontSize:16,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}};(0,oo.M)(),(0,pu.g)(),(0,pd.v)();class TR extends gK.k{constructor(){super(...arguments),this.name="indicator"}_renderText(t,e,i,r,s,n){if(!1!==e.visible){let a=(0,cZ.Z)({},(0,vB.Z)(TI,s),e.style,{visible:e.visible});a.lineHeight=(0,cX.Z)(a.lineHeight)?a.lineHeight:a.fontSize,e.formatMethod&&(a._originText=a.text,a.text=e.formatMethod(a.text,a));let l=(0,od.vS)(a);return l.name=n,t.appendChild(l),e.autoFit&&(0,uT.Z)(i)&&this._setLocalAutoFit(i,l,e),e.autoLimit&&(0,uT.Z)(r)&&l.setAttribute("maxLineWidth",i),l}}render(){var t,e;if(this.removeAllChild(!0),!0!==this.attribute.visible)return;let{title:i={},content:r,size:s,limitRatio:n=1/0}=this.attribute,a=Math.min(s.width,s.height)*n,l=this.createOrUpdateChild("indicator-container",{x:0,y:0,zIndex:1,pickable:null==(t=this.attribute.pickable)||t},"group");if((0,cX.Z)(i)&&(this._title=this._renderText(l,i,a,n,"title.style","indicator-title")),(0,cX.Z)(r)){let t=(0,Tm.IX)(r),e=[];t.forEach((t,i)=>{!1!==t.visible&&e.push(this._renderText(l,t,a,n,"content.style","indicator-content-"+i))}),this._content=e}this._setGlobalAutoFit(a),this._setYPosition();let o=null!=(e=null==l?void 0:l.AABBBounds.height())?e:0;l.setAttribute("y",s.height/2-o/2),l.setAttribute("x",s.width/2)}_setLocalAutoFit(t,e,i){var r,s,n,a,l,o,h,u,d;if("default"!==(null!=(r=i.fitStrategy)?r:"default"))return;let c=(0,od.fe)(null!=(n=null==(s=i.style)?void 0:s.text)?n:"",null!=(a=i.style)?a:{},null==(o=null==(l=this.stage)?void 0:l.getTheme())?void 0:o.text).width;if(c>0){let r=t*(null!=(h=i.fitPercent)?h:.5)/c,s=Math.floor((null!=(d=null==(u=i.style)?void 0:u.fontSize)?d:20)*r);e.setAttribute("fontSize",s),e.setAttribute("lineHeight",(0,cX.Z)(i.style.lineHeight)?i.style.lineHeight:s)}}_setGlobalAutoFit(t){var e,i,r,s,n,a,l;let o=[],h=0,u=null!=(e=this.attribute.title)?e:{};u.autoFit&&"inscribed"===u.fitStrategy?(this._title.setAttribute("fontSize",12),o.push({text:this._title,spec:null!=(i=this.attribute.title)?i:{}})):h+=null!=(a=null==(n=null==(s=null==(r=this._title)?void 0:r.AABBBounds)?void 0:s.height)?void 0:n.call(s))?a:0;let d=null!=(l=u.space)?l:0;if(h+=d,(0,Tm.IX)(this.attribute.content).filter(t=>!1!==t.visible).forEach((t,e)=>{var i,r,s,n;let a=this._content[e];t.autoFit&&"inscribed"===t.fitStrategy?(a.setAttribute("fontSize",12),o.push({text:a,spec:t})):h+=null!=(s=null==(r=null==(i=null==a?void 0:a.AABBBounds)?void 0:i.height)?void 0:r.call(i))?s:0;let l=null!=(n=t.space)?n:0;h+=l}),o.length<=0)return;let c=12/o.reduce((t,e)=>Math.max(t,e.text.AABBBounds.width()),0)*o.length,p=h/2,g=c**2+1,f=2*p*c,m=2*(c*((-f+Math.sqrt(f**2-4*g*(p**2-(t/2)**2)))/(2*g))+p),y=(m-h)/o.length;(0,uT.Z)(m)&&o.forEach(t=>{var e;let i=null==(e=t.spec.style)?void 0:e.lineHeight;t.text.setAttribute("fontSize",y),t.text.setAttribute("lineHeight",(0,cX.Z)(i)?i:y)})}_setYPosition(){var t,e,i,r,s,n;let a=0,l=null!=(r=null==(i=null==(e=null==(t=this._title)?void 0:t.AABBBounds)?void 0:e.height)?void 0:i.call(e))?r:0,o=null!=(n=null==(s=this.attribute.title)?void 0:s.space)?n:0;(0,Tm.IX)(this.attribute.content).filter(t=>!1!==t.visible).forEach((t,e)=>{var i;let r=this._content[e];r.setAttribute("y",l+o+a);let s=null!=(i=t.space)?i:0;a+=r.AABBBounds.height()+s})}}let TL=(t,e)=>({fontSize:{type:"token",key:t},fill:{type:"palette",key:e},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}),TD={title:{visible:!0,autoLimit:!1,autoFit:!1,style:TL("l1FontSize","primaryFontColor")},content:{visible:!0,style:TL("l2FontSize","tertiaryFontColor")}};var TF=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class Tz extends gO{constructor(){super(...arguments),this.type=rA.indicator,this.name=rA.indicator,this.specKey="indicator",this.layoutType="none",this.layoutZIndex=z.Indicator,this.layoutLevel=j.Indicator,this._gap=0,this._activeDatum=null}static getSpecInfo(t){return d0(t,this.specKey,this.type,t=>t&&!1!==t.visible)}created(){super.created(),this.initData(),this.initEvent()}setAttrFromSpec(){super.setAttrFromSpec(),this._gap=this._spec.gap||0,this._title=this._spec.title,this._content=eo(this._spec.content),this._regions=this._option.getRegionsInUserIdOrIndex(eo(this._spec.regionId),eo(this._spec.regionIndex))}initEvent(){this._option.disableTriggerEvent||"none"!==this._spec.trigger&&("hover"===this._spec.trigger?(this.event.on("element-highlight:start",t=>{let e=t.graphics[0];this.isRelativeModel(e)&&this.updateDatum(iV(e))}),this.event.on("element-highlight:reset",t=>{this._activeDatum&&this.updateDatum(null)})):(this.event.on("element-select:start",t=>{let e=t.graphics[0];this.isRelativeModel(e)&&this.updateDatum(iV(e))}),this.event.on("element-select:reset",t=>{this._activeDatum&&this.updateDatum(null)})))}updateDatum(t){this._activeDatum=t,this._displayData.updateData();let e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e)}initData(){sY(this._option.dataSet,"indicatorFilter",TO);let t=new er(this._option.dataSet,{name:`${this.type}_${this.id}_data`});t.transform({type:"indicatorFilter",options:{title:this._title,content:this._content,datum:()=>this._activeDatum}}),t.target.addListener("change",this.updateDatum.bind(this)),this._displayData=new ly(this._option,t)}updateLayoutAttribute(){let t=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(t),super.updateLayoutAttribute()}_getIndicatorAttrs(){if(!1===this._spec.visible||!1===this._spec.fixed&&null===this._activeDatum)return{visible:!1};let t=this._regions[0],{width:e,height:i}=t.getLayoutRect(),{x:r,y:s}=t.getLayoutStartPoint(),n=this._spec,{content:a,offsetX:l,offsetY:o,limitRatio:h,title:u}=n,d=TF(n,["content","offsetX","offsetY","limitRatio","title"]),c=[];return eo(a).forEach(t=>{let e=it({},this._theme.content,t);c.push({visible:!1!==e.visible&&(!e.field||null!==this._activeDatum),space:e.space||this._gap,autoLimit:e.autoLimit,autoFit:e.autoFit,fitPercent:e.fitPercent,fitStrategy:e.fitStrategy,style:Object.assign(Object.assign({},gr(gI(e.style,["text"]),this._activeDatum)),{text:this._createText(e.field,e.style.text)})})}),Object.assign({visible:!0,size:{width:e,height:i},zIndex:this.layoutZIndex,x:r,y:s,dx:l?ew(l,this._computeLayoutRadius()):0,dy:o?ew(o,this._computeLayoutRadius()):0,limitRatio:h||1/0,title:{visible:!1!==u.visible&&(!t5(u.field)||null!==this._activeDatum),space:u.space||this._gap,autoLimit:u.autoLimit,autoFit:u.autoFit,fitPercent:u.fitPercent,fitStrategy:u.fitStrategy,style:Object.assign(Object.assign({},gr(gI(u.style,["text"]),this._activeDatum)),{text:this._createText(u.field,u.style.text)})},content:c},d)}_createOrUpdateIndicatorComponent(t){if(!1===t.visible)return this._indicatorComponent&&this._indicatorComponent.parent&&this._indicatorComponent.parent.removeChild(this._indicatorComponent),void(this._indicatorComponent=null);if(this._indicatorComponent)t1(t,this._cacheAttrs)||this._indicatorComponent.setAttributes(t);else{let e=this.getContainer(),i=new TR(t);i.name="indicator",e.add(i),this._indicatorComponent=i,this._indicatorComponent.on("*",(t,e)=>this._delegateEvent(this._indicatorComponent,t,e))}this._cacheAttrs=t}_createText(t,e){var i;return t?this._activeDatum?this._activeDatum[t]:"":tK(e)?null!=(i=e(this._activeDatum,void 0))?i:"":null!=e?e:""}_computeLayoutRadius(){let{width:t,height:e}=this._regions[0].getLayoutRect();return Math.min(t/2,e/2)}isRelativeModel(t){return this._regions.some(e=>!!e.getSeriesInId(t.context.modelId))}_getNeedClearVRenderComponents(){return[this._indicatorComponent]}clear(){this._cacheAttrs=null,super.clear()}getIndicatorComponent(){return this._indicatorComponent}}Tz.type=rA.indicator,Tz.builtInTheme={indicator:TD},Tz.specKey="indicator";let Tj=()=>{ig.registerComponent(Tz.type,Tz)},TH=["sum","average","min","max","variance","standardDeviation","median"];var TN=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};function TV(t,e,i){if(!i)return!1;let r=t.map(t=>+t),s=ed(r),n=eu(r);return e<s||e>n}function TW(t,e,i,r,s,n){var a,l;let{relativeSeries:o}=r;return tH(t.x)&&TV(e,t.x,i)&&(null==(l=null==o?void 0:(a=o.getXAxisHelper()).setExtendDomain)||l.call(a,"marker_xAxis_extend",t.x)),ev(t.x)?T$(t.x,s)+n.x:TY(o.getXAxisHelper(),[t.x])+n.x}function TU(t,e,i,r,s,n){var a,l;let{relativeSeries:o}=r;return tH(t.y)&&TV(e,t.y,i)&&(null==(l=null==(a=o.getYAxisHelper())?void 0:a.setExtendDomain)||l.call(a,"marker_yAxis_extend",t.y)),ev(t.y)?T$(t.y,s)+n.y:TY(o.getYAxisHelper(),[t.y])+n.y}function TG(t,e,i,r){var s,n;let{relativeSeries:a}=r;return tH(t.angle)&&TV(e,t.angle,i)&&(null==(n=null==(s=a.angleAxisHelper)?void 0:s.setExtendDomain)||n.call(s,"marker_angleAxis_extend",t.angle)),TY(a.angleAxisHelper,[t.angle])}function TZ(t,e,i,r){var s,n;let{relativeSeries:a}=r;return tH(t.radius)&&TV(e,t.radius,i)&&(null==(n=null==(s=a.radiusAxisHelper)?void 0:s.setExtendDomain)||n.call(s,"marker_radiusAxis_extend",t.radius)),TY(a.radiusAxisHelper,[t.radius])}function T$(t,e){return Number(t.substring(0,t.length-1))*e/100}function TY(t,e){let i=t.getScale(0);return ai(i.type)&&i.domain()[0]===i.domain()[1]&&e[0]!==i.domain()[0]?NaN:t.dataToPosition(e)}function TX(t){return TH.includes(t)}function TK(t,e,i,r,s){let n=e.getRegion(),a=n.getLayoutStartPoint(),l=i.getRegion(),o=l.getLayoutStartPoint(),h=Math.abs(Math.min(a.x,o.x)-Math.max(a.x+n.getLayoutRect().width,o.x+l.getLayoutRect().width)),u=Math.abs(Math.min(a.y,o.y)-Math.max(a.y+n.getLayoutRect().height,o.y+l.getLayoutRect().height)),d={relativeSeries:r,startRelativeSeries:e,endRelativeSeries:i},c=[],p=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,g=r.getXAxisHelper().getScale(0).domain(),f=r.getYAxisHelper().getScale(0).domain();return p.forEach(t=>{let e=t5(t.x),i=t5(t.y);if(e&&i){let e=TW(t,g,s,d,h,a),i=TU(t,f,s,d,u,a);c.push([{x:e,y:i}])}else if(e){let e=TW(t,g,s,d,h,a),i=Math.max(a.y+n.getLayoutRect().height,o.y+l.getLayoutRect().height),r=Math.min(a.y,o.y);c.push([{x:e,y:i},{x:e,y:r}])}else if(i){let e=Math.min(a.x,o.x),i=TU(t,f,s,d,u,a),r=Math.max(a.x+n.getLayoutRect().width,o.x+l.getLayoutRect().width);c.push([{x:e,y:i},{x:r,y:i}])}}),c}function Tq(t,e,i,r,s){let n={relativeSeries:r,startRelativeSeries:e,endRelativeSeries:i},a=[],l=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,o=r.angleAxisHelper.getScale(0).domain(),h=r.radiusAxisHelper.getScale(0).domain(),u=Math.min(r.getRegion().getLayoutRect().width/2,r.getRegion().getLayoutRect().height/2);return l.forEach(t=>{let e=t5(t.angle),i=t5(t.radius);if(e&&i){let e=TG(t,o,s,n),i=TZ(t,h,s,n);a.push([{angle:e,radius:i}])}else if(e){let e=TG(t,o,s,n);a.push([{angle:e,radius:-u},{angle:e,radius:u}])}else if(i){let e=TZ(t,h,s,n);a.push([{radius:e,angle:0},{radius:e,angle:2*Math.PI}])}}),a}function TQ(t,e,i,r){let s=[],n=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,a=tY(r);return n.forEach((t,n)=>{var l,o,h,u;let d=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,c=d.getRegion(),p=c.getLayoutStartPoint(),{width:g,height:f}=c.getLayoutRect(),m=0,y=0;if(r){let t=a?r[n]:r,e=t.x,i=t.y;e&&(m=ev(e)?Number(e.substring(0,e.length-1))*g/100:e),i&&(y=ev(i)?Number(i.substring(0,i.length-1))*f/100:i)}let _=d.getXAxisHelper().getScale(0).domain(),v=d.getYAxisHelper().getScale(0).domain(),b=eo(t.x),x=eo(t.y);1===b.length&&tH(b[0])&&TV(_,b[0],i)&&(null==(o=null==(l=d.getXAxisHelper())?void 0:l.setExtendDomain)||o.call(l,"marker_xAxis_extend",b[0])),1===x.length&&tH(x[0])&&TV(v,x[0],i)&&(null==(u=null==(h=d.getYAxisHelper())?void 0:h.setExtendDomain)||u.call(h,"marker_yAxis_extend",x[0])),s.push({x:TY(d.getXAxisHelper(),b)+p.x+m,y:TY(d.getYAxisHelper(),x)+p.y+y})}),s}function TJ(t,e,i){let r=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach(t=>{var s,n,a,l;let o=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,h=o.angleAxisHelper.getScale(0).domain(),u=o.radiusAxisHelper.getScale(0).domain(),d=eo(t.angle),c=eo(t.radius);1===d.length&&tH(d[0])&&TV(h,d[0],i)&&(null==(n=null==(s=o.angleAxisHelper)?void 0:s.setExtendDomain)||n.call(s,"marker_xAxis_extend",d[0])),1===c.length&&tH(c[0])&&TV(u,c[0],i)&&(null==(l=null==(a=o.radiusAxisHelper)?void 0:a.setExtendDomain)||l.call(a,"marker_yAxis_extend",c[0])),r.push({angle:TY(o.angleAxisHelper,d),radius:TY(o.radiusAxisHelper,c)})}),r}function T0(t,e,i){let{x:r,y:s}=t;return ev(r)&&(r=T$(r,e)),ev(s)&&(s=T$(s,i)),{x:r,y:s}}function T1(t,e,i){let r;if(r=tK(t)?eo(t(e.getData().getLatestData(),e)):eo(t),i){let t=e.getRegion(),{x:i,y:s}=t.getLayoutStartPoint(),{width:n,height:a}=t.getLayoutRect();return r.map(t=>{let{x:e,y:r}=T0(t,n,a);return{x:e+=i,y:r+=s}})}let{width:s,height:n}=e.getOption().getChart().getViewRect();return r.map(t=>T0(t,s,n))}function T2(t){let e=1/0,i=-1/0,r=1/0,s=-1/0;return t.forEach(t=>{let n=t.getLayoutStartPoint(),a=t.getLayoutRect();n.x<e&&(e=n.x),n.x+a.width>i&&(i=n.x+a.width),n.y<r&&(r=n.y),n.y+a.height>s&&(s=n.y+a.height)}),{minX:e,maxX:i,minY:r,maxY:s}}function T3(t,e,i){let{labelBackground:r={},style:s,shape:n}=t,a=TN(t,["labelBackground","style","shape"]);return!1!==t.visible?((null==n?void 0:n.visible)?a.shape=Object.assign({visible:!0},gs(n.style)):a.shape={visible:!1},!1!==r.visible?(a.panel=Object.assign({visible:!0,customShape:r.customShape},T4(gs(r.style),e,i)),t5(r.padding)&&(a.padding=MY(r.padding))):(a.panel={visible:!1},a.padding=0),s&&(a.textStyle=T4(gs(s),e,i)),a):{visible:!1}}function T5(t,e,i){for(let r in t)tK(t[r])&&(t[r]=t[r](e,i));return t}function T4(t,e,i){return tK(t)?t(e,i):t}function T7(t,e,i){return t5(t)?"regionLeft"===e?i.getLayoutStartPoint().x-t.x:"regionRight"===e?i.getLayoutStartPoint().x+i.getLayoutRect().width-t.x:"regionTop"===e?i.getLayoutStartPoint().y-t.y:"regionBottom"===e?i.getLayoutStartPoint().y+i.getLayoutRect().height-t.y:e:e}function T6(t){return{isXProcess:t5(t.x),isYProcess:t5(t.y),isX1Process:t5(t.x1),isY1Process:t5(t.y1),isAngleProcess:t5(t.angle),isRadiusProcess:t5(t.radius),isAngle1Process:t5(t.angle1),isRadius1Process:t5(t.radius1),isCoordinatesProcess:t5(t.coordinates),isValidProcess:t5(t.process)}}function T9(t){let{isXProcess:e,isYProcess:i,isX1Process:r,isY1Process:s,isAngleProcess:n,isRadiusProcess:a,isAngle1Process:l,isRadius1Process:o,isCoordinatesProcess:h,isValidProcess:u}=T6(t);return{doXProcess:e&&!i&&!s,doXYY1Process:e&&i&&s,doYProcess:i&&!e&&!r,doYXX1Process:i&&e&&r,doXYProcess:e&&i&&r&&s,doAngleProcess:n&&!l&&!a&&!o,doRadiusProcess:a&&!o&&!n&&!l,doAngRadRad1Process:n&&!l&&a&&o,doRadAngAng1Process:a&&n&&l&&!o,doRadAngProcess:n&&a&&l&&o,doCoordinatesProcess:h&&(!u||"process"in t&&"xy"in t.process)}}function T8(t){let{isXProcess:e,isYProcess:i,isX1Process:r,isY1Process:s,isAngleProcess:n,isRadiusProcess:a,isAngle1Process:l,isRadius1Process:o,isCoordinatesProcess:h}=T6(t);return{doXProcess:e&&r&&!i&&!s,doYProcess:i&&s&&!e&&!r,doXYProcess:e&&r&&i&&s,doAngleProcess:n&&l&&!a&&!o,doRadiusProcess:a&&o&&!n&&!l,doRadAngProcess:n&&a&&l&&o,doCoordinatesProcess:h}}function Ct(t){return{doXYProcess:t5(t.x)&&t5(t.y),doPolarProcess:t5(t.angle)&&t5(t.radius),doGeoProcess:t5(t.areaName)}}var Ce=i(92875),Ci=i(44889);function Cr(){(0,oo.M)(),(0,Tv.b)(),(0,ux.d)()}function Cs(t,e){let{x1:i,y1:r,x2:s,y2:n}=e,{x1:a,y1:l,x2:o,y2:h}=t.AABBBounds,u=0,d=0;return a<i&&(u=i-a),l<r&&(d=r-l),o>s&&(u=s-o),h>n&&(d=n-h),{dx:u,dy:d}}function Cn(t,e){let{dx:i,dy:r}=Cs(t,e),{dx:s=0,dy:n=0}=t.attribute;i&&t.setAttribute("dx",i+s),r&&t.setAttribute("dy",r+n)}var Ca=i(47700);class Cl extends gK.k{constructor(){super(...arguments),this.name="marker",this._onHover=t=>{this._lastHover=(0,Ca.fM)(t,this._container,this._lastHover)},this._onUnHover=t=>{this._lastHover=(0,Ca.lO)(t,this._container,this._lastHover)},this._onClick=t=>{this._lastSelect=(0,Ca.Q6)(t,this._container,this._lastSelect)}}transAnimationConfig(){var t,e,i;if(!1!==this.attribute.animation){let r=(0,up.Z)(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:(0,cZ.Z)({},this.defaultUpdateAnimation,r,null!=(t=this.attribute.animationEnter)?t:{}),exit:(0,cZ.Z)({},this.defaultExitAnimation,r,null!=(e=this.attribute.animationExit)?e:{}),update:(0,cZ.Z)({},this.defaultUpdateAnimation,r,null!=(i=this.attribute.animationUpdate)?i:{})}}}setAttribute(t,e,i){super.setAttribute(t,e,i),"visible"===t&&this.render()}_bindEvent(){var t,e,i;if(!this.attribute.interactive)return;let{hover:r,select:s}=this.attribute;r&&(null==(t=this._container)||t.addEventListener("pointermove",this._onHover),null==(e=this._container)||e.addEventListener("pointerout",this._onUnHover)),s&&(null==(i=this._container)||i.addEventListener("pointerdown",this._onClick))}_releaseEvent(){var t,e,i;null==(t=this._container)||t.removeEventListener("pointermove",this._onHover),null==(e=this._container)||e.removeEventListener("pointerout",this._onUnHover),null==(i=this._container)||i.removeEventListener("pointerdown",this._onClick)}_initContainer(){var t,e;let i,{limitRect:r={},clipInRange:s}=this.attribute;if(s){let s=c$.i.group(Object.assign(Object.assign({},r),{clip:!0,pickable:!1}));i=c$.i.group({x:-(null!=(t=r.x)?t:0),y:-(null!=(e=r.y)?e:0),pickable:!1}),s.add(i),this._containerClip=s,this.add(s)}else i=c$.i.group({x:0,y:0,pickable:!1}),this.add(i);i.name="marker-container",this._container=i}_updateContainer(){var t,e;let{limitRect:i={},clipInRange:r}=this.attribute;this._containerClip&&this._containerClip.setAttributes(Object.assign({},i)),this._container.setAttributes({x:r?-(null!=(t=i.x)?t:0):0,y:r?-(null!=(e=i.y)?e:0):0})}render(){var t;this.transAnimationConfig(),this.setAttribute("pickable",!1);let e=null==(t=this.attribute.visible)||t;!1===this.attribute.interactive&&this.setAttribute("childrenPickable",!1),e&&this.isValidPoints()?this._container?(this._updateContainer(),this.updateMarker(),this.markerAnimate("update")):(this._initContainer(),this.initMarker(this._container),this.markerAnimate("enter")):(this.markerAnimate("exit"),this._container=null,this.removeAllChild(!0)),this._releaseEvent(),this._bindEvent()}release(){this.markerAnimate("exit"),super.release(),this._releaseEvent(),this._container=null}}function Co(t,e,i,r){var s,n,a,l,o;if(!t)return;null==(s=null==t?void 0:t.animates)||s.forEach(t=>t.stop("end"));let h=null!=(a=null==(n=t.attribute)?void 0:n.fillOpacity)?a:1,u=null!=(o=null==(l=t.attribute)?void 0:l.strokeOpacity)?o:1;t.setAttributes({fillOpacity:0,strokeOpacity:0}),t.animate().wait(e).to({fillOpacity:h,strokeOpacity:u},i,r)}function Ch(t,e,i,r){t&&(Co(t.startSymbol,e,i,r),t.lines.forEach(t=>Co(t,e,i,r)),Co(t.line,e,i,r),Co(t.endSymbol,e,i,r))}function Cu(t,e,i,r){t&&(Co(t.getTextShape(),e,i,r),Co(t.getBgRect(),e,i,r))}function Cd(t,e,i,r){var s,n,a,l;t&&(t.setAttributes({fillOpacity:null!=(n=null==(s=t.attribute)?void 0:s.fillOpacity)?n:1,strokeOpacity:null!=(l=null==(a=t.attribute)?void 0:a.strokeOpacity)?l:1}),t.animate().wait(e).to({fillOpacity:0,strokeOpacity:0},i,r))}function Cc(t,e,i,r){t&&(Cd(t.startSymbol,e,i,r),t.lines.forEach(t=>Cd(t,e,i,r)),Cd(t.line,e,i,r),Cd(t.endSymbol,e,i,r))}function Cp(t,e,i,r){t&&(Cd(t.getTextShape(),e,i,r),Cd(t.getBgRect(),e,i,r))}function Cg(t,e,i,r,s){let n=.1*i,a=.7*i,l=.1*i,o=.1*i;Co(t.startSymbol,r,n,s),t.lines.forEach(t=>t.setAttribute("clipRange",0)),t.lines.forEach((e,i)=>{let l=a/t.lines.length;e.animate().wait(r+n+i*l).to({clipRange:1},l,s)}),Co(t.endSymbol,r+n+a,l,s),(0,Tm.IX)(e).forEach(t=>{let e=r+n+a+l;Co(t.getTextShape(),e,o,s),Co(t.getBgRect(),e,o,s)})}function Cf(t,e,i,r,s){Ch(t,r,i,s),(0,Tm.IX)(e).forEach(t=>{Cu(t,r,i,s)})}function Cm(t,e,i,r,s){Co(t,r,i,s),(0,Tm.IX)(e).forEach(t=>{Cu(t,r,i,s)})}function Cy(t,e,i,r,s){Co(t,r,i,s),(0,Tm.IX)(e).forEach(t=>{Cu(t,r,i,s)})}function C_(t,e,i,r,s,n){var a;Ch(t,s,r,n),Co(e,s,r,n),(null==(a=i.getTextShape)?void 0:a.call(i))?Cu(i,s,r,n):Co(i,s,r,n)}function Cv(t,e,i,r,s,n){var a;let l=.1*r,o=.65*r,h=.05*r,u=.1*r,d=.1*r;Co(t.startSymbol,s,l,n),t.lines.forEach(t=>t.setAttribute("clipRange",0)),t.lines.forEach((e,i)=>{let r=o/t.lines.length;e.animate().wait(s+l+i*r).to({clipRange:1},r,n)}),Co(e,s+l+o,h,n),Co(t.endSymbol,s+l+o+h,u,n),(null==(a=i.getTextShape)?void 0:a.call(i))?(Co(i.getTextShape(),s+l+o+h+u,d,n),Co(i.getBgRect(),s+l+o+u,d,n)):Co(i,s+l+o+u,d,n)}function Cb(t,e,i,r){let{enter:s,update:n,exit:a}=i;if("enter"===r){let{type:i,duration:r,delay:n,easing:a}=s;"clipIn"===i?Cg(t,e,r,n,a):"fadeIn"===i&&Cf(t,e,r,n,a)}else if("update"===r){let{type:i,duration:r,delay:s,easing:a}=n;"clipIn"===i?Cg(t,e,r,s,a):"fadeIn"===i&&Cf(t,e,r,s,a)}else if("exit"===r){let{duration:i,delay:r,easing:s}=a;Cc(t,r,i,s),(0,Tm.IX)(e).forEach(t=>{Cp(t,r,i,s)})}}function Cx(t,e,i,r){let{enter:s,update:n,exit:a}=i;if("enter"===r){let{type:i,duration:r,delay:n,easing:a}=s;"fadeIn"===i&&Cm(t,e,r,n,a)}else if("update"===r){let{type:i,duration:r,delay:s,easing:a}=n;"fadeIn"===i&&Cm(t,e,r,s,a)}else if("exit"===r){let{duration:i,delay:r,easing:s}=a;Cd(t,r,i,s),(0,Tm.IX)(e).forEach(t=>{Cp(t,r,i,s)})}}function CS(t,e,i,r){let{enter:s,update:n,exit:a}=i;if("enter"===r){let{type:i,duration:r,delay:n,easing:a}=s;"fadeIn"===i&&Cy(t,e,r,n,a)}else if("update"===r){let{type:i,duration:r,delay:s,easing:a}=n;"fadeIn"===i&&Cy(t,e,r,s,a)}else if("exit"===r){let{duration:i,delay:r,easing:s}=a;Cd(t,r,i,s),(0,Tm.IX)(e).forEach(t=>{Cp(t,r,i,s)})}}function Ck(t,e,i,r){let[s,n]=t,{enter:a,update:l,exit:o}=i;if("enter"===r){let{type:t,duration:i,delay:r,easing:l}=a;"fadeIn"===t?C_(s,n,e,i,r,l):"callIn"===t&&Cv(s,n,e,i,r,l)}else if("update"===r){let{type:t,duration:i,delay:r,easing:a}=l;"fadeIn"===t?C_(s,n,e,i,r,a):"callIn"===t&&Cv(s,n,e,i,r,a)}else if("exit"===r){var h;let{duration:t,delay:i,easing:r}=o;Cc(s,i,t,r),Cd(n,i,t,r),(null==(h=e.getTextShape)?void 0:h.call(e))?Cp(e,i,t,r):Cd(e,i,t,r)}}let CA={type:"clipIn",duration:500,easing:"linear",delay:0},CM={type:"fadeIn",duration:500,easing:"linear",delay:0},Cw={type:"callIn",duration:500,easing:"linear",delay:0},CT={type:"fadeOut",duration:500,easing:"linear",delay:0};class CC{getLabel(){return this._label}_addMarkLabels(t,e,i){let{label:r,state:s}=this.attribute,n=(0,Tm.IX)(null==s?void 0:s.label),a=(0,Tm.IX)(null==s?void 0:s.labelBackground),l=(0,Tm.IX)(r).map((r,s)=>{var l,o;let h=(0,cZ.Z)({},i,r),u=new w7.V(Object.assign(Object.assign({},h),{state:{panel:(0,cZ.Z)({},c5.n0,null!=(l=a[s])?l:(0,Tm.Z$)(a)),text:(0,cZ.Z)({},c5.n0,null!=(o=n[s])?o:(0,Tm.Z$)(n))}}));return u.name=e,t.add(u),this.setLabelPos(u,h),u});this._label=1===(0,Tm.IX)(l).length?l[0]:l}_updateMarkLabels(t){let{label:e,state:i}=this.attribute,r=(0,Tm.IX)(this._label),s=(0,Tm.IX)(null==i?void 0:i.label),n=(0,Tm.IX)(null==i?void 0:i.labelBackground);if(r.length){let i=(0,Tm.IX)(e);r.forEach((e,r)=>{var a,l;let o=(0,cZ.Z)({},t,i[r]);e.setAttributes(Object.assign(Object.assign({dx:0,dy:0},o),{state:{panel:(0,cZ.Z)({},c5.n0,null!=(a=n[r])?a:(0,Tm.Z$)(n)),text:(0,cZ.Z)({},c5.n0,null!=(l=s[r])?l:(0,Tm.Z$)(s))}})),this.setLabelPos(e,o)})}}}class CE extends Cl{constructor(){super(...arguments),this.name="markCommonLine",this.defaultUpdateAnimation=CA,this.defaultExitAnimation=CT}getLine(){return this._line}setLabelPos(t,e){let{limitRect:i}=this.attribute,{position:r,confine:s,autoRotate:n}=e,a=this.getPointAttrByPosition(r,e),l=r.toString().toLocaleLowerCase().includes("start")?this._line.getStartAngle()||0:this._line.getEndAngle()||0;if(t.setAttributes(Object.assign(Object.assign({},a.position),{angle:n?this.getRotateByAngle(a.angle,e):0,textStyle:Object.assign(Object.assign({},this.getTextStyle(r,l,n)),e.textStyle)})),i&&s){let{x:e,y:r,width:s,height:n}=i;Cn(t,{x1:e,y1:r,x2:e+s,y2:r+n})}}initMarker(t){let e=this.createSegment();e.name="mark-common-line-line",this._line=e,t.add(e),this.addMarkLineLabels(t)}updateMarker(){this.setLineAttributes(),this.updateMarkLineLabels()}}(0,gY.jB)(CE,CC);var CB=i(27589);(tr=tb||(tb={})).start="start",tr.startTop="startTop",tr.startBottom="startBottom",tr.insideStart="insideStart",tr.insideStartTop="insideStartTop",tr.insideStartBottom="insideStartBottom",tr.middle="middle",tr.insideMiddleTop="insideMiddleTop",tr.insideMiddleBottom="insideMiddleBottom",tr.end="end",tr.endTop="endTop",tr.endBottom="endBottom",tr.insideEnd="insideEnd",tr.insideEndTop="insideEndTop",tr.insideEndBottom="insideEndBottom",(ts=tx||(tx={})).left="left",ts.right="right",ts.top="top",ts.bottom="bottom",ts.topLeft="topLeft",ts.topRight="topRight",ts.bottomLeft="bottomLeft",ts.bottomRight="bottomRight",ts.middle="middle",ts.insideLeft="insideLeft",ts.insideRight="insideRight",ts.insideTop="insideTop",ts.insideBottom="insideBottom",ts.insideTopLeft="insideTopLeft",ts.insideTopRight="insideTopRight",ts.insideBottomLeft="insideBottomLeft",ts.insideBottomRight="insideBottomRight",(tn=tS||(tS={})).arcInnerStart="arcInnerStart",tn.arcInnerEnd="arcInnerEnd",tn.arcInnerMiddle="arcInnerMiddle",tn.arcOuterStart="arcOuterStart",tn.arcOuterEnd="arcOuterEnd",tn.arcOuterMiddle="arcOuterMiddle",tn.center="center",(ta=tk||(tk={})).top="top",ta.bottom="bottom",ta.middle="middle",ta.insideTop="insideTop",ta.insideBottom="insideBottom",ta.insideMiddle="insideMiddle";let CP={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:tb.end,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},CO={postiveXAxis:{start:{textAlign:"left",textBaseline:"middle"},startTop:{textAlign:"left",textBaseline:"bottom"},startBottom:{textAlign:"left",textBaseline:"top"},insideStart:{textAlign:"right",textBaseline:"middle"},insideStartTop:{textAlign:"right",textBaseline:"bottom"},insideStartBottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"left",textBaseline:"middle"},endTop:{textAlign:"left",textBaseline:"bottom"},endBottom:{textAlign:"left",textBaseline:"top"},insideEnd:{textAlign:"right",textBaseline:"middle"},insideEndTop:{textAlign:"right",textBaseline:"bottom"},insideEndBottom:{textAlign:"right",textBaseline:"top"}},negativeXAxis:{start:{textAlign:"right",textBaseline:"middle"},startTop:{textAlign:"right",textBaseline:"bottom"},startBottom:{textAlign:"right",textBaseline:"top"},insideStart:{textAlign:"left",textBaseline:"middle"},insideStartTop:{textAlign:"left",textBaseline:"bottom"},insideStartBottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"right",textBaseline:"middle"},endTop:{textAlign:"right",textBaseline:"bottom"},endBottom:{textAlign:"right",textBaseline:"top"},insideEnd:{textAlign:"left",textBaseline:"middle"},insideEndTop:{textAlign:"left",textBaseline:"bottom"},insideEndBottom:{textAlign:"left",textBaseline:"top"}}},CI={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{autoRotate:!0,position:tS.arcOuterMiddle,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},CR={interactive:!0,label:{position:tx.right,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},CL={interactive:!0,label:{autoRotate:!0,position:tS.arcOuterMiddle,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},CD={arcInnerStart:{textAlign:"center",textBaseline:"bottom"},arcInnerEnd:{textAlign:"center",textBaseline:"bottom"},arcInnerMiddle:{textAlign:"center",textBaseline:"bottom"},arcOuterStart:{textAlign:"center",textBaseline:"top"},arcOuterEnd:{textAlign:"center",textBaseline:"top"},arcOuterMiddle:{textAlign:"center",textBaseline:"top"},center:{textAlign:"center",textBaseline:"middle"}},CF={left:{textAlign:"right",textBaseline:"middle"},insideLeft:{textAlign:"left",textBaseline:"middle"},right:{textAlign:"left",textBaseline:"middle"},insideRight:{textAlign:"right",textBaseline:"middle"},top:{textAlign:"center",textBaseline:"bottom"},insideTop:{textAlign:"center",textBaseline:"top"},bottom:{textAlign:"center",textBaseline:"top"},insideBottom:{textAlign:"center",textBaseline:"bottom"},middle:{textAlign:"center",textBaseline:"middle"},topLeft:{textAlign:"right",textBaseline:"top"},insideTopLeft:{textAlign:"left",textBaseline:"top"},topRight:{textAlign:"left",textBaseline:"top"},insideTopRight:{textAlign:"right",textBaseline:"top"},bottomLeft:{textAlign:"right",textBaseline:"bottom"},insideBottomLeft:{textAlign:"left",textBaseline:"bottom"},bottomRight:{textAlign:"left",textBaseline:"bottom"},insideBottomRight:{textAlign:"right",textBaseline:"bottom"}},Cz={postiveXAxis:{top:{textAlign:"left",textBaseline:"bottom"},bottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"left",textBaseline:"middle"},insideTop:{textAlign:"right",textBaseline:"bottom"},insideBottom:{textAlign:"right",textBaseline:"top"},insideMiddle:{textAlign:"right",textBaseline:"middle"}},negativeXAxis:{top:{textAlign:"right",textBaseline:"bottom"},bottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"right",textBaseline:"middle"},insideTop:{textAlign:"left",textBaseline:"bottom"},insideBottom:{textAlign:"left",textBaseline:"top"},insideMiddle:{textAlign:"left",textBaseline:"middle"}}};function Cj(){CH._animate=Cb}Cr(),(0,Ci.j)(),(0,ux.d)();class CH extends CE{markerAnimate(t){CH._animate&&this._animationConfig&&CH._animate(this._line,this._label,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},CH.defaultAttributes,t)),this.name="markLine"}getPointAttrByPosition(t,e){var i;let{refX:r=0,refY:s=0}=e,n=this._line.getMainSegmentPoints(),a=null!=(i=this._line.getEndAngle())?i:0,l=((0,c3.WF)(a),a),o=r*Math.cos(l)+s*Math.cos(l-Math.PI/2),h=r*Math.sin(l)+s*Math.sin(l-Math.PI/2);return t.includes("start")||t.includes("Start")?{position:{x:n[0].x+o,y:n[0].y+h},angle:l}:t.includes("middle")||t.includes("Middle")?{position:{x:(n[0].x+n[n.length-1].x)/2+o,y:(n[0].y+n[n.length-1].y)/2+h},angle:l}:{position:{x:n[n.length-1].x+o,y:n[n.length-1].y+h},angle:l}}getRotateByAngle(t,e){var i;return((0,c3.WF)(t)?t:t-Math.PI)+(null!=(i=e.refAngle)?i:0)}getTextStyle(t,e,i){return(0,c3.U4)(Math.abs(e),Math.PI/2,.001)||(0,c3.U4)(Math.abs(e),3*Math.PI/2,.001)?(0,c3.ic)(i,e,t):(0,c3.WF)(e)?CO.postiveXAxis[t]:CO.negativeXAxis[t]}createSegment(){let{points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:s,multiSegment:n,state:a}=this.attribute;return new CB.X({points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:s,multiSegment:n,pickable:!1,state:{line:(0,cZ.Z)({},c5.n0,null==a?void 0:a.line),startSymbol:(0,cZ.Z)({},c5.n0,null==a?void 0:a.lineStartSymbol),endSymbol:(0,cZ.Z)({},c5.n0,null==a?void 0:a.lineEndSymbol)}})}setLineAttributes(){let{points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:s,multiSegment:n,state:a}=this.attribute;this._line&&this._line.setAttributes({points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:s,multiSegment:n,state:{line:(0,cZ.Z)({},c5.n0,null==a?void 0:a.line),startSymbol:(0,cZ.Z)({},c5.n0,null==a?void 0:a.lineStartSymbol),endSymbol:(0,cZ.Z)({},c5.n0,null==a?void 0:a.lineEndSymbol)}})}isValidPoints(){let{points:t}=this.attribute;if(!t||t.length<2)return!1;let e=!0;return t.forEach(t=>{if(t.length)t.forEach(t=>{(0,uT.Z)(t.x)&&(0,uT.Z)(t.y)||(e=!1)});else if(!(0,uT.Z)(t.x)||!(0,uT.Z)(t.y))return void(e=!1)}),e}addMarkLineLabels(t){this._addMarkLabels(t,"mark-common-line-label",CH.defaultAttributes.label)}updateMarkLineLabels(){this._updateMarkLabels(CH.defaultAttributes.label)}}CH.defaultAttributes=CP;var CN=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};function CV(t,e){let i;if(e.coordinates){let t,r,{coordinates:s,coordinateType:n,getSeriesByIdOrIndex:a}=e,l=CN(e,["coordinates","coordinateType","getSeriesByIdOrIndex"]);if(tK(s)){let i=e.getRelativeSeries();t=s(i.getData().getLatestData(),i)}else t=s;i=(t=eo(t)).map(t=>{let e=a(t.refRelativeSeriesId,t.refRelativeSeriesIndex);if("cartesian"===n){let{xField:i,yField:s}=e.getSpec(),{xFieldDim:n,xFieldIndex:a,yFieldDim:o,yFieldIndex:h}=t,u=i;t5(a)&&(u=eo(i)[a]),n&&eo(i).includes(n)&&(u=n);let d=s;t5(h)&&(d=eo(s)[h]),o&&eo(s).includes(o)&&(d=o),r=Object.assign({x:void 0,y:void 0},l),t3(t[u])&&TX(t[u])?r.x={field:u,aggrType:t[u]}:r.x=eo(u).map(e=>t[e]),t3(t[d])&&TX(t[d])?r.y={field:d,aggrType:t[d]}:r.y=eo(d).map(e=>t[e])}else if("polar"===n){let{valueField:i,categoryField:s}=e.getSpec(),{angleFieldDim:n,angleFieldIndex:a}=t,o=s;t5(a)&&(o=eo(s)[a]),n&&eo(s).includes(n)&&(o=n),r=Object.assign({angle:void 0,radius:void 0},l),t3(t[o])&&TX(t[o])?r.angle={field:o,aggrType:t[o]}:r.angle=eo(o).map(e=>t[e]),t3(t[i])&&TX(t[i])?r.radius={field:i,aggrType:t[i]}:r.radius=eo(i).map(e=>t[e])}return r.getRefRelativeSeries=()=>e,r})}else i=e;let r=[];return i.forEach(e=>{let i={x:null,y:null,angle:null,radius:null,areaName:null};if(t5(e.x)){let r=e.x;tY(r)?i.x=r.map(i=>CU(i,t,e)):i.x=CU(r,t,e)}if(t5(e.y)){let r=e.y;tY(r)?i.y=r.map(i=>CU(i,t,e)):i.y=CU(r,t,e)}if(t5(e.angle)){let r=e.angle;tY(r)?i.angle=r.map(i=>CU(i,t,e)):i.angle=CU(r,t,e)}if(t5(e.radius)){let r=e.radius;tY(r)?i.radius=r.map(i=>CU(i,t,e)):i.radius=CU(r,t,e)}t5(e.areaName)&&(i.areaName=CU(e.areaName,t,e)),e.getRefRelativeSeries&&(i.getRefRelativeSeries=e.getRefRelativeSeries),r.push(i)}),r}let CW={min:(t,e)=>dO(t[0].latestData,e.field),max:(t,e)=>dI(t[0].latestData,e.field),sum:function(t,e){return dR(t[0].latestData,e.field)},average:function(t,e){return dL(t[0].latestData,e.field)},variance:function(t,e){return dD(t[0].latestData,e.field)},standardDeviation:function(t,e){return Math.sqrt(dD(t[0].latestData,e.field))},median:function(t,e){var i,r;return i=t[0].latestData,r=e.field,d_(i.map(t=>t[r]))}};function CU(t,e,i){let r=i.getRelativeSeries(),s=i.getStartRelativeSeries(),n=i.getEndRelativeSeries(),a=r.getData().getLatestData(),l=s.getData().getLatestData(),o=n.getData().getLatestData();if(tK(t))return t(a,l,o,r,s,n);if(tQ(t)){let{aggrType:i,field:r}=t;return CW[i](e,{field:r})}return t}function CG(t,e){if(e&&e.getRelativeSeries){let i=e.getRelativeSeries();if(i){let e=i.getViewData();return e&&e.latestData&&e.latestData.length?t:[]}}return t}class CZ extends gO{constructor(){super(...arguments),this.layoutType="none",this._layoutOffsetX=0,this._layoutOffsetY=0}getRelativeSeries(){return this._relativeSeries}getMarkerData(){return this._markerData}static _getMarkerCoordinateType(t){return"cartesian"}static getSpecInfo(t){return d0(t,this.specKey,this.type,t=>!1!==t.visible&&this._getMarkerCoordinateType(t)===this.coordinateType)}getMarkAttributeContext(){return this._markAttributeContext}_buildMarkerAttributeContext(){this._markAttributeContext={relativeSeries:this._relativeSeries,startRelativeSeries:this._startRelativeSeries,endRelativeSeries:this._endRelativeSeries,vchart:this._option.globalInstance}}created(){super.created(),this._bindSeries(),this._initDataView(),this.initEvent(),this._buildMarkerAttributeContext()}_getAllRelativeSeries(){return{getRelativeSeries:()=>this._relativeSeries,getStartRelativeSeries:()=>this._startRelativeSeries,getEndRelativeSeries:()=>this._endRelativeSeries}}_getFieldInfoFromSpec(t,e,i){return t3(e)&&TX(e)?{field:i.getSpec()[({x:"xField",y:"yField",radius:"valueField",angle:"categoryField",areaName:"nameField"})[t]],aggrType:e}:e}_processSpecByDims(t){let e=this._relativeSeries,i={};return t.forEach(t=>i[t.dim]=this._getFieldInfoFromSpec(t.dim,t.specValue,e)),Object.assign(Object.assign({},i),this._getAllRelativeSeries())}_processSpecCoo(t){return Object.assign(Object.assign({coordinates:t.coordinates||t.coordinate},this._getAllRelativeSeries()),{getSeriesByIdOrIndex:(t,e)=>this._getSeriesByIdOrIndex(t,e),coordinateType:this.coordinateType})}_getRelativeDataView(){if(this._specifiedDataSeries){let t=[];eo(this._specifiedDataSeries).forEach(e=>{t=t.concat(e.getViewData().latestData)});let e=new tZ;return e.registerParser("array",tD),new er(e).parse(t,{type:"array"})}return this._relativeSeries.getViewData()}updateLayoutAttribute(){var t,e,i;if(null==(t=this._spec.visible)||t){if(!this._markerComponent){let t=this._createMarkerComponent();t.name=null!=(e=this._spec.name)?e:this.type,t.id=null!=(i=this._spec.id)?i:`${this.type}-${this.id}`,this._markerComponent=t,this.getContainer().add(this._markerComponent),this._markerComponent.on("*",(t,e)=>{this._delegateEvent(this._markerComponent,t,e,null,this.getMarkerData.bind(this))})}this._markerLayout()}super.updateLayoutAttribute()}_getSeriesByIdOrIndex(t,e){var i,r;let s;return(s=null==(i=this._option.getSeriesInUserIdOrIndex(t5(t)?[t]:[],[e]))?void 0:i[0])||(s=null!=(r=this._relativeSeries)?r:this._getFirstSeries()),s}_bindSeries(){let t=this._spec;this._relativeSeries=this._getSeriesByIdOrIndex(t.relativeSeriesId,t.relativeSeriesIndex),this._startRelativeSeries=this._getSeriesByIdOrIndex(t.startRelativeSeriesId,t.startRelativeSeriesIndex),this._endRelativeSeries=this._getSeriesByIdOrIndex(t.endRelativeSeriesId,t.endRelativeSeriesIndex),t.specifiedDataSeriesIndex&&"all"===t.specifiedDataSeriesIndex||t.specifiedDataSeriesId&&"all"===t.specifiedDataSeriesId?this._specifiedDataSeries=this._option.getAllSeries():(t.specifiedDataSeriesIndex||t.specifiedDataSeriesId)&&(this._specifiedDataSeries=this._getSeriesByIdOrIndex(t.specifiedDataSeriesId,t.specifiedDataSeriesIndex))}initEvent(){"cartesian"!==this._relativeSeries.coordinate&&(this._relativeSeries.event.on("zoom",this._markerLayout.bind(this)),this._relativeSeries.event.on("panmove",this._markerLayout.bind(this)),this._relativeSeries.event.on("scroll",this._markerLayout.bind(this)))}clear(){super.clear(),this._firstSeries=null}_getFirstSeries(){var t;if(this._firstSeries)return this._firstSeries;let e=pG(this._regions);return e?(this._firstSeries=e,e):(null==(t=this._option)||t.onError("need at least one series"),null)}_getNeedClearVRenderComponents(){return[this._markerComponent]}onLayoutStart(t,e){et(this._spec.offsetX)||(this._layoutOffsetX=ex(this._spec.offsetX,e.width,e)),et(this._spec.offsetY)||(this._layoutOffsetY=ex(this._spec.offsetY,e.height,e)),super.onLayoutStart(t,e)}_compareSpec(t,e){let i=super._compareSpec(t,e);return t1(e,t)||(i.reRender=!0,i.reMake=!0,i.change=!0),i}_initCommonDataView(){let{options:t}=this._computeOptions(),e=this._getRelativeDataView();sY(this._option.dataSet,"markerAggregation",CV),sY(this._option.dataSet,"markerFilter",CG);let i=new er(this._option.dataSet,{name:`${this.type}_${this.id}_data`});i.parse([e],{type:"dataview"}),i.transform({type:"markerAggregation",options:t}),i.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),i.target.on("change",()=>{this._markerLayout()}),this._markerData=i}}function C$(t,e){return function(t,e,i){let{predict:r}=function(t,e=t=>t.x,i=t=>t.y){var r;let s,n,a=0,l=0,o=0,h=0,u=0;dv(t,e,i,(t,e)=>{++u,a+=(t-a)/u,l+=(e-l)/u,o+=(t*e-o)/u,h+=(t*t-h)/u});let d=function(t,e,i,r){let s=r-t*t,n=1e-24>Math.abs(s)?0:(i-t*e)/s;return[e-n*t,n]}(a,l,o,h),c=t=>d[0]+d[1]*t;return{coef:d,predict:c,rSquared:(r=l,s=0,n=0,dv(t,e,i,(t,e)=>{let i=e-c(t),a=e-r;s+=i*i,n+=a*a}),1-s/n)}}(t,t=>t[e],t=>t[i]),s=dO(t,e),n=dI(t,e),a=r(s),l=r(n);return[{[e]:s,[i]:a},{[e]:n,[i]:l}]}(t[0].latestData,e.fieldX,e.fieldY)}class CY extends CZ{constructor(){super(...arguments),this.specKey="markLine",this.layoutZIndex=z.MarkLine}static _getMarkerCoordinateType(t){let{doAngleProcess:e,doRadiusProcess:i,doAngRadRad1Process:r,doRadAngAng1Process:s,doRadAngProcess:n}=T9(t);return"polar"===t.coordinateType||e||i||r||s||n?"polar":"cartesian"}_createMarkerComponent(){var t,e,i,r,s,n,a,l,o,h,u,d,c;let{startSymbol:p={},endSymbol:g={}}=this._spec,f=eo(null!=(t=this._spec.label)?t:{}),m={zIndex:this.layoutZIndex,interactive:null==(e=this._spec.interactive)||e,hover:null==(i=this._spec.interactive)||i,select:null==(r=this._spec.interactive)||r,points:[{x:0,y:0},{x:0,y:0}],center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,lineStyle:T4(gs(null==(s=this._spec.line)?void 0:s.style),this._markerData,this._markAttributeContext),clipInRange:null!=(n=this._spec.clip)&&n,label:f.map(t=>T3(t,this._markerData,this._markAttributeContext)),state:{line:T5(null!=(l=null==(a=this._spec.line)?void 0:a.state)?l:{},this._markerData,this._markAttributeContext),lineStartSymbol:T5(null!=(h=null==(o=this._spec.startSymbol)?void 0:o.state)?h:{},this._markerData,this._markAttributeContext),lineEndSymbol:T5(null!=(d=null==(u=this._spec.endSymbol)?void 0:u.state)?d:{},this._markerData,this._markAttributeContext),label:f.map(t=>{var e;return T5(null!=(e=t.state)?e:{},this._markerData,this._markAttributeContext)}),labelBackground:f.map(t=>{var e,i;return T5(null!=(i=null==(e=t.labelBackground)?void 0:e.state)?i:{},this._markerData,this._markAttributeContext)})},animation:null!=(c=this._spec.animation)&&c,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return p.visible?m.startSymbol=Object.assign(Object.assign({},p),{visible:!0,style:T4(gs(p.style),this._markerData,this._markAttributeContext)}):m.startSymbol={visible:!1},g.visible?m.endSymbol=Object.assign(Object.assign({},g),{visible:!0,style:T4(gs(g.style),this._markerData,this._markAttributeContext)}):m.endSymbol={visible:!1},this._newMarkLineComponent(m)}_getUpdateMarkerAttrs(){var t,e;let i,r=this._spec,s=this._markerData,n=this._startRelativeSeries,a=this._endRelativeSeries,l=this._relativeSeries,o=this._computePointsAttr(),h=l.getViewData().latestData,u=s.latestData[0]&&s.latestData[0].latestData?s.latestData[0].latestData:s.latestData;if(r.clip||eo(r.label).some(t=>null==t?void 0:t.confine)){let{minX:t,maxX:e,minY:r,maxY:s}=T2([n.getRegion(),a.getRegion(),l.getRegion()]);i={x:t,y:r,width:e-t,height:s-r}}let d=eo((null!=(e=null==(t=this._markerComponent)?void 0:t.attribute)?e:{}).label),c=eo(this._spec.label),p=d.map((t,e)=>{let i=c[e]||{};return Object.assign(Object.assign({},t),{text:i.formatMethod?i.formatMethod(u,h):null==t?void 0:t.text})});return Object.assign(Object.assign({},o),{label:p,limitRect:i,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}_markerLayout(){var t;let e=this._getUpdateMarkerAttrs();null==(t=this._markerComponent)||t.setAttributes(e)}_initDataView(){let t=this._spec,e="coordinates"in t,{doXProcess:i,doYProcess:r,doXYY1Process:s,doYXX1Process:n,doXYProcess:a,doAngleProcess:l,doRadiusProcess:o,doAngRadRad1Process:h,doRadAngAng1Process:u,doRadAngProcess:d}=T9(t);if(this._markerData=this._getRelativeDataView(),!(i||r||s||n||a||l||o||h||u||d||e))return;sY(this._option.dataSet,"markerAggregation",CV),sY(this._option.dataSet,"markerRegression",C$),sY(this._option.dataSet,"markerFilter",CG);let{options:c,needAggr:p,needRegr:g,processData:f}=this._computeOptions(),m=new er(this._option.dataSet);m.parse([f],{type:"dataview"}),p&&m.transform({type:"markerAggregation",options:c}),g&&m.transform({type:"markerRegression",options:c}),m.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),m.target.on("change",()=>{this._markerLayout()}),this._markerData=m}}CY.specKey="markLine";let CX=()=>({style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}),CK=t=>({visible:t,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}}),Cq=CX();Cq.refY=5;let CQ={line:{style:{lineDash:[3,3],stroke:{type:"palette",key:"markLineStrokeColor"}}},startSymbol:CK(!1),endSymbol:CK(!0),label:Cq};class CJ extends CY{constructor(){super(...arguments),this.type=rA.markLine,this.name=rA.markLine,this.coordinateType="cartesian"}_newMarkLineComponent(t){return new CH(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,s=this._endRelativeSeries,n=this._relativeSeries,a=t5(e.coordinates),l=t5(e.process),o=l&&t5(e.process.x),h=l&&t5(e.process.y),u=t5(e.positions),d=null!=(t=e.autoRange)&&t,{doXProcess:c,doYProcess:p,doXYY1Process:g,doYXX1Process:f,doXYProcess:m,doCoordinatesProcess:y}=T9(e),_=[];if(c||g||p||f||m||a&&o||a&&h){let t=TK(i,r,s,n,d);_=1===t.length?t[0]:t.map(t=>t[0])}else y?_=TQ(i,n,d,e.coordinatesOffset):u&&(_=T1(e.positions,n,e.regionRelative));return{points:_}}_markerLayout(){var t,e,i,r;let s=this._getUpdateMarkerAttrs();if("type-step"===this._spec.type){let r,n,a=this._startRelativeSeries,l=this._endRelativeSeries,{multiSegment:o,mainSegmentIndex:h}=this._spec.line||{},{connectDirection:u,expandDistance:d=0}=this._spec;if(ev(d)){let t=a.getRegion(),e=t.getLayoutStartPoint(),i=l.getRegion(),s=i.getLayoutStartPoint();if("bottom"===u||"top"===u){let n=Math.abs(Math.min(e.y,s.y)-Math.max(e.y+t.getLayoutRect().height,s.y+i.getLayoutRect().height));r=Number(d.substring(0,d.length-1))*n/100}else{let n=Math.abs(Math.min(e.x,s.x)-Math.max(e.x+t.getLayoutRect().width,s.x+i.getLayoutRect().width));r=Number(d.substring(0,d.length-1))*n/100}}else r=d;let{points:c,limitRect:p}=s,g=function(t,e,i,r=0){let s=[],n=t.y-e.y,a=t.x-e.x;switch(i){case"top":s.push(t),s.push({x:t.x,y:n>0?t.y-r-Math.abs(n):t.y-r}),s.push({x:e.x,y:n>0?e.y-r:e.y-r-Math.abs(n)}),s.push(e);break;case"bottom":s.push(t),s.push({x:t.x,y:n<0?t.y+r+Math.abs(n):t.y+r}),s.push({x:e.x,y:n<0?e.y+r:e.y+r+Math.abs(n)}),s.push(e);break;case"left":s.push(t),s.push({x:a>0?t.x-r-Math.abs(a):t.x-r,y:t.y}),s.push({x:a>0?e.x-r:e.x-r-Math.abs(a),y:e.y}),s.push(e);break;case"right":s.push(t),s.push({x:a>0?t.x+r:t.x+r+Math.abs(a),y:t.y}),s.push({x:a>0?e.x+r+Math.abs(a):e.x+r,y:e.y}),s.push(e)}return s}(c[0],c[1],u,r);n=o&&t5(h)?{position:"middle",autoRotate:!1}:Object.assign({position:"start",autoRotate:!1},function(t,e,i,r=0){let s=t.y-e.y,n=t.x-e.x;return"bottom"===i?{dx:n>0?-n/2:Math.abs(n/2),dy:s>0?r:Math.abs(s)+r}:"top"===i?{dx:n>0?-Math.abs(n/2):+Math.abs(n/2),dy:s>0?-(Math.abs(s)+r):-r}:"left"===i?{dx:n>0?-n-r:-r,dy:s>0?-s/2:Math.abs(s/2)}:"right"===i?{dx:n>0?r:Math.abs(n)+r,dy:s>0?-s/2:Math.abs(s/2)}:{}}(c[0],c[1],u,r));let f=eo((null!=(e=null==(t=this._markerComponent)?void 0:t.attribute)?e:{}).label),m=eo(s.label),y=eo(this._spec.label);null==(i=this._markerComponent)||i.setAttributes({points:o?[[g[0],g[1]],[g[1],g[2]],[g[2],g[3]]]:g,label:m.map((t,e)=>{var i,r,s,a;let l=0,o=0,h=null!=(i=n.dx)?i:0,u=null!=(r=n.dy)?r:0,d=null!=(s=y[e])?s:y[0];return ee(null==d?void 0:d.refX)&&(l+=d.refX),ee(null==d?void 0:d.refY)&&(o+=d.refY),ee(null==d?void 0:d.dx)&&(h+=d.dx),ee(null==d?void 0:d.dy)&&(u+=d.dy),Object.assign(Object.assign(Object.assign({},t),n),{refX:l,refY:o,dx:h,dy:u,textStyle:Object.assign(Object.assign({},null==(a=f[e])?void 0:a.textStyle),{textAlign:"center",textBaseline:"middle"})})}),limitRect:p,multiSegment:o,mainSegmentIndex:h,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}else null==(r=this._markerComponent)||r.setAttributes(s)}_computeOptions(){let t,e=this._getRelativeDataView(),i=!0,r=!1,s=this._spec,n=this._relativeSeries,{doXProcess:a,doYProcess:l,doXYY1Process:o,doYXX1Process:h,doXYProcess:u,doCoordinatesProcess:d}=T9(s);if(u)t=[this._processSpecByDims([{dim:"x",specValue:s.x},{dim:"y",specValue:s.y}]),this._processSpecByDims([{dim:"x",specValue:s.x1},{dim:"y",specValue:s.y1}])];else if(a)t=[this._processSpecByDims([{dim:"x",specValue:s.x}])];else if(l)t=[this._processSpecByDims([{dim:"y",specValue:s.y}])];else if(o)t=[this._processSpecByDims([{dim:"x",specValue:s.x},{dim:"y",specValue:s.y}]),this._processSpecByDims([{dim:"x",specValue:s.x},{dim:"y",specValue:s.y1}])];else if(h)t=[this._processSpecByDims([{dim:"x",specValue:s.x},{dim:"y",specValue:s.y}]),this._processSpecByDims([{dim:"x",specValue:s.x1},{dim:"y",specValue:s.y}])];else if(d){if(t=this._processSpecCoo(s),i=!1,e=new er(this._option.dataSet,{name:`${this.type}_${this.id}_data`}).parse([n.getViewData()],{type:"dataview"}).transform({type:"markerAggregation",options:t}),s.process&&t5(s.process.x)&&(t=[this._processSpecByDims([{dim:"x",specValue:s.process.x}])],i=!0),s.process&&t5(s.process.y)&&(t=t=[this._processSpecByDims([{dim:"y",specValue:s.process.y}])],i=!0),s.process&&t5(s.process.xy)){let{xField:e,yField:i}=n.getSpec();t={fieldX:e,fieldY:i},r=!0}}else i=!1;return{options:t,needAggr:i,needRegr:r,processData:e}}}CJ.type=rA.markLine,CJ.coordinateType="cartesian",CJ.builtInTheme={markLine:CQ};let C0=()=>{ig.registerComponent(CJ.type,CJ),Cj()};(0,Ci.O)();class C1 extends CB.X{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},CB.X.defaultAttributes,t)),this.name="arc-segment",this.key="arc-segment",this.isReverseArc=!1}getStartAngle(){let t=this.isReverseArc?this._startAngle+Math.PI/2:this._startAngle-Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}getEndAngle(){let t=this.isReverseArc?this._endAngle-Math.PI/2:this._endAngle+Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}getMainSegmentPoints(){return this._mainSegmentPoints}_computeStartRotate(t){return this.isReverseArc?t+Math.PI:t}_computeEndRotate(t){return this.isReverseArc?t:t+Math.PI}render(){this.removeAllChild(!0),this._reset();let{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:s=!0,radius:n,startAngle:a,endAngle:l,center:o}=this.attribute;if(!s)return;this._startAngle=a,this._endAngle=l,this.isReverseArc=a>l;let h={x:o.x+n*Math.cos(this._startAngle),y:o.y+n*Math.sin(this._startAngle)},u={x:o.x+n*Math.cos(this._endAngle),y:o.y+n*Math.sin(this._endAngle)};this._mainSegmentPoints=[h,u];let d=this._renderSymbol(t,this._mainSegmentPoints,"start"),c=this._renderSymbol(e,this._mainSegmentPoints,"end");this.startSymbol=d,this.endSymbol=c;let p=c$.i.arc(Object.assign({x:o.x,y:o.y,startAngle:a,endAngle:l,innerRadius:n,outerRadius:n},i));p.name=`${this.name}-line`,p.id=this._getNodeId("arc"),(0,cY.Z)(null==r?void 0:r.line)||(p.states=[].concat(r.line)[0]),this.add(p),this.line=p}}Cr(),(0,Ci.O)(),(0,ux.d)();class C2 extends CE{markerAnimate(t){C2._animate&&this._animationConfig&&C2._animate(this._line,this._label,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},C2.defaultAttributes,t)),this.name="markArcLine"}getPointAttrByPosition(t,e){let i,{center:r,radius:s,startAngle:n,endAngle:a}=this.attribute,{refX:l=0,refY:o=0}=e;switch(t){case tS.arcInnerStart:i=n;case tS.arcOuterStart:i=n;break;case tS.arcInnerEnd:i=a;case tS.arcOuterEnd:i=a;break;case tS.center:case tS.arcInnerMiddle:case tS.arcOuterMiddle:default:i=(n+a)/2}return{position:{x:r.x+(s+o)*Math.cos(i)+l*Math.cos(i-Math.PI/2),y:r.y+(s+o)*Math.sin(i)+l*Math.sin(i-Math.PI/2)},angle:i}}getTextStyle(t){return CD[t]}getRotateByAngle(t,e){var i;return t-Math.PI/2+(null!=(i=e.refAngle)?i:0)}createSegment(){let{center:t,radius:e,startAngle:i,endAngle:r,startSymbol:s,endSymbol:n,lineStyle:a,state:l}=this.attribute;return new C1({center:t,radius:e,startAngle:i,endAngle:r,startSymbol:s,endSymbol:n,lineStyle:a,state:{line:(0,cZ.Z)({},c5.n0,null==l?void 0:l.line),startSymbol:(0,cZ.Z)({},c5.n0,null==l?void 0:l.lineStartSymbol),endSymbol:(0,cZ.Z)({},c5.n0,null==l?void 0:l.lineEndSymbol)}})}setLineAttributes(){let{center:t,radius:e,startAngle:i,endAngle:r,startSymbol:s,endSymbol:n,lineStyle:a,state:l}=this.attribute;this._line&&this._line.setAttributes({center:t,radius:e,startAngle:i,endAngle:r,startSymbol:s,endSymbol:n,lineStyle:a,state:{line:(0,cZ.Z)({},c5.n0,null==l?void 0:l.line),startSymbol:(0,cZ.Z)({},c5.n0,null==l?void 0:l.lineStartSymbol),endSymbol:(0,cZ.Z)({},c5.n0,null==l?void 0:l.lineEndSymbol)}})}isValidPoints(){return!0}addMarkLineLabels(t){this._addMarkLabels(t,"mark-common-line-label",C2.defaultAttributes.label)}updateMarkLineLabels(){this._updateMarkLabels(C2.defaultAttributes.label)}}C2.defaultAttributes=CI;class C3 extends CY{constructor(){super(...arguments),this.type=rA.polarMarkLine,this.name=rA.polarMarkLine,this.coordinateType="polar"}_newMarkLineComponent(t){let{doRadiusProcess:e,doRadAngAng1Process:i}=T9(this._spec);return e||i?new C2(t):new CH(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,s=this._endRelativeSeries,n=this._relativeSeries,a=null!=(t=e.autoRange)&&t,{doAngleProcess:l,doRadiusProcess:o,doAngRadRad1Process:h,doRadAngAng1Process:u,doRadAngProcess:d,doCoordinatesProcess:c}=T9(e),p=[],g={},f={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(l||o||h||u||d){let t=Tq(i,r,s,n,a);g=(p=1===t.length?t[0]:t.map(t=>t[0]))[0].radius===p[1].radius?{radius:p[0].radius,startAngle:p[0].angle,endAngle:p[1].angle,center:f}:{points:p.map(t=>lc(f,t.radius,t.angle))}}else c&&(g={points:(p=TJ(i,n,a)).map(t=>lc(f,t.radius,t.angle))});return g}_computeOptions(){let t,e=this._spec,{doAngleProcess:i,doRadiusProcess:r,doAngRadRad1Process:s,doRadAngAng1Process:n,doRadAngProcess:a,doCoordinatesProcess:l}=T9(e),o=this._getRelativeDataView();return a?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}])]:s?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius1}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:l&&(t=this._processSpecCoo(e)),{options:t,needAggr:!0,needRegr:!1,processData:o}}}C3.type=rA.polarMarkLine,C3.coordinateType="polar",C3.builtInTheme={polarMarkLine:CQ};let C5=()=>{ig.registerComponent(C3.type,C3),C2._animate=Cb,Cj()};var C4=i(5845);class C7 extends gO{get orient(){return this._orient}constructor(t,e){super(t,e),this.type=rA.title,this.specKey=rA.title,this.layoutType="normal",this.layoutZIndex=z.Title,this.layoutLevel=j.Title,this._orient="top",this._orient=e_(t.orient)?t.orient:"top"}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}static getSpecInfo(t){return d0(t,this.specKey,rA.title,t=>!1!==t.visible)}_compareSpec(t,e){let i=super._compareSpec(t,e);return(null==e?void 0:e.orient)===(null==t?void 0:t.orient)&&(null==e?void 0:e.visible)===t.visible||(i.reMake=!0),i.change=!0,i.reRender=!0,i}afterSetLayoutStartPoint(t){ee(t.x)&&this._titleComponent&&this._titleComponent.setAttribute("x",t.x),ee(t.y)&&this._titleComponent&&this._titleComponent.setAttribute("y",t.y),super.afterSetLayoutStartPoint(t)}getBoundsInRect(t){let e={};this.setLayoutRect(t);let i=this._getTitleAttrs();this._createOrUpdateTitleComponent(i),e=this._getTitleLayoutRect();let{x:r,y:s}=this.getLayoutStartPoint();return{x1:r,y1:s,x2:r+e.width,y2:s+e.height}}_getTitleLayoutRect(){let t=this._titleComponent.AABBBounds;return{width:this._spec.width?this._spec.width:ee(t.width())?t.width():0,height:this._spec.height?this._spec.height:ee(t.height())?t.height():0}}_getTitleAttrs(){var t,e,i,r,s,n,a,l;if(!1===this._spec.visible)return{visible:!1};let o=this.getLayoutRect(),h=ex(this._spec.width,o.width,null,o.width),u=Math.max(Math.min(h,ex(this._spec.maxWidth,o.width,null,o.width),o.width),0),d=Object.assign(Object.assign({},gI(this._spec,["padding"])),{textType:null!=(t=this._spec.textType)?t:"text",text:null!=(e=this._spec.text)?e:"",subtextType:null!=(i=this._spec.subtextType)?i:"text",subtext:null!=(r=this._spec.subtext)?r:"",x:null!=(s=this._spec.x)?s:0,y:null!=(n=this._spec.y)?n:0,height:this._spec.height,minWidth:this._spec.minWidth,maxWidth:u,minHeight:this._spec.minHeight,maxHeight:this._spec.maxHeight,padding:this._spec.innerPadding,align:null!=(a=this._spec.align)?a:"left",verticalAlign:null!=(l=this._spec.verticalAlign)?l:"top",textStyle:Object.assign({width:u,maxLineWidth:u},this._spec.textStyle),subtextStyle:Object.assign({maxLineWidth:u},this._spec.subtextStyle)});return t5(this._spec.width)&&(d.textStyle.width=Math.max(h,o.width),d.subtextStyle.width=d.textStyle.width),d}_createOrUpdateTitleComponent(t){if(this._titleComponent)t1(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{let e=this.getContainer(),i=new C4.D(t);i.name="title",e.add(i),this._titleComponent=i,i.on("*",(t,e)=>this._delegateEvent(i,t,e))}return this._cacheAttrs=t,this._titleComponent}_getNeedClearVRenderComponents(){return[this._titleComponent]}clear(){super.clear(),this._cacheAttrs=null}}C7.type=rA.title,C7.specKey=rA.title,C7.builtInTheme={title:{padding:{top:4,bottom:20},textStyle:{fontSize:{type:"token",key:"l3FontSize"},lineHeight:{type:"token",key:"l3LineHeight"},fill:{type:"palette",key:"primaryFontColor"}},subtextStyle:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fill:{type:"palette",key:"tertiaryFontColor"}}}};let C6=()=>{ig.registerComponent(C7.type,C7)};function C9(){C8._animate=Cx}Cr(),(0,Sk.M)(),(0,ux.d)();class C8 extends Cl{markerAnimate(t){C8._animate&&this._animationConfig&&C8._animate(this._area,this._label,this._animationConfig,t)}getArea(){return this._area}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},C8.defaultAttributes,t)),this.name="markArea",this.defaultUpdateAnimation=CM,this.defaultExitAnimation=CT}getPointAttrByPosition(t){let{x1:e,x2:i,y1:r,y2:s}=this._area.AABBBounds,n={x:(e+i)/2,y:(r+s)/2};return(t.includes("left")||t.includes("Left"))&&(n.x=e),(t.includes("right")||t.includes("Right"))&&(n.x=i),(t.includes("top")||t.includes("Top"))&&(n.y=r),(t.includes("bottom")||t.includes("Bottom"))&&(n.y=s),n}setLabelPos(t,e){var i;if(this._area){let r=null!=(i=e.position)?i:"middle",s=this.getPointAttrByPosition(r);if(t.setAttributes(Object.assign(Object.assign({},s),{textStyle:Object.assign(Object.assign({},CF[r]),e.textStyle)})),this.attribute.limitRect&&e.confine){let{x:e,y:i,width:r,height:s}=this.attribute.limitRect;Cn(t,{x1:e,y1:i,x2:e+r,y2:i+s})}}}initMarker(t){let{points:e,areaStyle:i,state:r}=this.attribute,s=c$.i.polygon(Object.assign({points:e},i));s.states=(0,cZ.Z)({},c5.n0,null==r?void 0:r.area),s.name="mark-area-polygon",this._area=s,t.add(s),this._addMarkLabels(t,"mark-area-label",C8.defaultAttributes.label)}updateMarker(){let{points:t,areaStyle:e,state:i}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({points:t},e)),this._area.states=(0,cZ.Z)({},c5.n0,null==i?void 0:i.area)),this._updateMarkLabels(C8.defaultAttributes.label)}isValidPoints(){let{points:t}=this.attribute;if(!t||t.length<3)return!1;let e=!0;return t.forEach(t=>{(0,uT.Z)(t.x)&&(0,uT.Z)(t.y)||(e=!1)}),e}}C8.defaultAttributes=CR,(0,gY.jB)(C8,CC);class Et extends CZ{constructor(){super(...arguments),this.specKey="markArea",this.layoutZIndex=z.MarkArea}static _getMarkerCoordinateType(t){let{doAngleProcess:e,doRadiusProcess:i,doRadAngProcess:r}=T8(t);return"polar"===t.coordinateType||e||i||r?"polar":"cartesian"}_createMarkerComponent(){var t,e,i,r,s,n,a,l;let o=eo(null!=(t=this._spec.label)?t:{}),h={zIndex:this.layoutZIndex,interactive:null==(e=this._spec.interactive)||e,hover:null==(i=this._spec.interactive)||i,select:null==(r=this._spec.interactive)||r,points:[{x:0,y:0}],center:{x:0,y:0},innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,areaStyle:T4(gs(null==(s=this._spec.area)?void 0:s.style),this._markerData,this._markAttributeContext),clipInRange:null!=(n=this._spec.clip)&&n,label:o.map(t=>T3(t,this._markerData,this._markAttributeContext)),state:{area:T5(null==(a=this._spec.area)?void 0:a.state,this._markerData,this._markAttributeContext),label:o.map(t=>T5(t.state,this._markerData,this._markAttributeContext)),labelBackground:o.map(t=>{var e;return T5(null==(e=t.labelBackground)?void 0:e.state,this._markerData,this._markAttributeContext)})},animation:null!=(l=this._spec.animation)&&l,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return this._newMarkAreaComponent(h)}_markerLayout(){var t;let e,i=this._spec,r=this._markerData,s=this._startRelativeSeries,n=this._endRelativeSeries,a=this._relativeSeries,l=this._computePointsAttr(),o=this._getRelativeDataView().latestData,h=r?r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData:o;if(i.clip||eo(i.label).some(t=>null==t?void 0:t.confine)){let{minX:t,maxX:i,minY:r,maxY:l}=T2([s.getRegion(),n.getRegion(),a.getRegion()]);e={x:t,y:r,width:i-t,height:l-r}}if(this._markerComponent){let i=eo(null==(t=this._markerComponent.attribute)?void 0:t.label),r=eo(this._spec.label);this._markerComponent.setAttributes(Object.assign(Object.assign({},l),{label:i.map((t,e)=>{let i=r[e]||{};return Object.assign(Object.assign({},t),{text:i.formatMethod?i.formatMethod(h,o):null==t?void 0:t.text})}),limitRect:e,dx:this._layoutOffsetX,dy:this._layoutOffsetY}))}}_initDataView(){let{doXProcess:t,doYProcess:e,doXYProcess:i,doAngleProcess:r,doRadiusProcess:s,doRadAngProcess:n,doCoordinatesProcess:a}=T8(this._spec);if(!(t||e||i||r||s||n||a))return null;this._initCommonDataView()}}Et.specKey="markArea";let Ee={area:{style:{fill:{type:"palette",key:"axisDomainColor",a:.25}}},label:CX()};class Ei extends Et{constructor(){super(...arguments),this.type=rA.markArea,this.name=rA.markArea,this.coordinateType="cartesian"}_newMarkAreaComponent(t){return new C8(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,s=this._endRelativeSeries,n=this._relativeSeries,{doXProcess:a,doYProcess:l,doXYProcess:o,doCoordinatesProcess:h}=T8(e),u=t5(e.positions),d=null!=(t=e.autoRange)&&t,c=[],p=[];if(o){let[t,e]=TK(i,r,s,n,d);t&&t.length&&e&&e.length&&(c=[{x:t[0].x,y:e[0].y},t[0],{x:e[0].x,y:t[0].y},e[0]])}else if(a||l){let[t,e]=TK(i,r,s,n,d);t&&t.length&&e&&e.length&&(c=[...t,e[1],e[0]])}else h?c=TQ(i,n,d,e.coordinatesOffset):u&&(c=T1(e.positions,n,e.regionRelative));return{points:c}}_computeOptions(){let t,e=this._spec,{doXProcess:i,doYProcess:r,doXYProcess:s,doCoordinatesProcess:n}=T8(e);return s?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"x",specValue:e.x1},{dim:"y",specValue:e.y1}])]:i?t=[this._processSpecByDims([{dim:"x",specValue:e.x}]),this._processSpecByDims([{dim:"x",specValue:e.x1}])]:r?t=[this._processSpecByDims([{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"y",specValue:e.y1}])]:n&&(t=this._processSpecCoo(e)),{options:t}}}Ei.type=rA.markArea,Ei.coordinateType="cartesian",Ei.builtInTheme={markArea:Ee};let Er=()=>{ig.registerComponent(Ei.type,Ei),C9()};Cr(),(0,vr.x)(),(0,ux.d)();class Es extends Cl{markerAnimate(t){Es._animate&&this._animationConfig&&Es._animate(this._area,this._label,this._animationConfig,t)}getArea(){return this._area}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},Es.defaultAttributes,t)),this.name="markArcArea",this.defaultUpdateAnimation=CM,this.defaultExitAnimation=CT}getPointAttrByPosition(t,e){let i,r,{center:s,innerRadius:n,outerRadius:a,startAngle:l,endAngle:o}=this.attribute,{refX:h=0,refY:u=0}=e;switch(t){case tS.center:i=(n+a)/2,r=(l+o)/2;break;case tS.arcInnerStart:i=n,r=l;break;case tS.arcOuterStart:i=a,r=l;break;case tS.arcInnerEnd:i=n,r=o;break;case tS.arcOuterEnd:i=a,r=o;break;case tS.arcInnerMiddle:i=n,r=(l+o)/2;break;case tS.arcOuterMiddle:i=a,r=(l+o)/2;break;default:i=n,r=(l+o)/2}return{position:{x:s.x+(i+u)*Math.cos(r)+h*Math.cos(r-Math.PI/2),y:s.y+(i+u)*Math.sin(r)+h*Math.sin(r-Math.PI/2)},angle:r}}setLabelPos(t,e){var i;if(this._area){let{position:r="arcInnerMiddle",autoRotate:s}=e,n=this.getPointAttrByPosition(r,e);if(t.setAttributes(Object.assign(Object.assign({},n.position),{angle:s?n.angle-Math.PI/2+(null!=(i=e.refAngle)?i:0):0,textStyle:Object.assign(Object.assign({},CD[r]),e.textStyle)})),this.attribute.limitRect&&e.confine){let{x:e,y:i,width:r,height:s}=this.attribute.limitRect;Cn(t,{x1:e,y1:i,x2:e+r,y2:i+s})}}}initMarker(t){let{center:e,innerRadius:i,outerRadius:r,startAngle:s,endAngle:n,areaStyle:a,state:l}=this.attribute,o=c$.i.arc(Object.assign({x:e.x,y:e.y,innerRadius:i,outerRadius:r,startAngle:s,endAngle:n},a));o.states=(0,cZ.Z)({},c5.n0,null==l?void 0:l.area),o.name="polar-mark-area-area",this._area=o,t.add(o),this._addMarkLabels(t,"mark-area-label",Es.defaultAttributes.label)}updateMarker(){let{center:t,innerRadius:e,outerRadius:i,startAngle:r,endAngle:s,areaStyle:n,label:a,state:l}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({x:t.x,y:t.y,innerRadius:e,outerRadius:i,startAngle:r,endAngle:s},n)),this._area.states=(0,cZ.Z)({},c5.n0,null==l?void 0:l.area)),this._updateMarkLabels(Es.defaultAttributes.label)}isValidPoints(){return!0}}Es.defaultAttributes=CL,(0,gY.jB)(Es,CC);class En extends Et{constructor(){super(...arguments),this.type=rA.polarMarkArea,this.name=rA.polarMarkArea,this.coordinateType="polar"}_newMarkAreaComponent(t){let{doRadiusProcess:e,doAngleProcess:i,doRadAngProcess:r}=T8(this._spec);return i||e||r?new Es(t):new C8(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,s=this._endRelativeSeries,n=this._relativeSeries,{doAngleProcess:a,doRadiusProcess:l,doRadAngProcess:o,doCoordinatesProcess:h}=T8(e),u=null!=(t=e.autoRange)&&t,d={},c={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(a||l||o){let t=Tq(i,r,s,n,u);o?d={innerRadius:t[0][0].radius,outerRadius:t[1][0].radius,startAngle:t[0][0].angle,endAngle:t[1][0].angle,center:c}:a?d={innerRadius:0,outerRadius:Math.abs(t[0][0].radius),startAngle:t[0][1].angle,endAngle:t[1][1].angle,center:c}:l&&(d={innerRadius:t[0][0].radius,outerRadius:t[1][0].radius,startAngle:t[0][0].angle,endAngle:t[1][1].angle,center:c})}else h&&(d={points:TJ(i,n,u).map(t=>lc(c,t.radius,t.angle))});return d}_computeOptions(){let t,e=this._spec,{doAngleProcess:i,doRadiusProcess:r,doRadAngProcess:s,doCoordinatesProcess:n}=T8(e);return s?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"radius",specValue:e.radius1}])]:n&&(t=this._processSpecCoo(e)),{options:t}}}En.type=rA.polarMarkArea,En.coordinateType="polar",En.builtInTheme={polarMarkArea:Ee};let Ea=()=>{ig.registerComponent(En.type,En),Es._animate=CS,C9()};var El=i(60121);class Eo extends pR.m{constructor(t){super(t)}}(tl=tA||(tA={})).OnPlay="onPlay",tl.OnPause="onPause",tl.OnForward="onForward",tl.OnBackward="onBackward",(to=tM||(tM={})).Start="start",to.Pause="pause",to.Forward="forward",to.Backward="backward";class Eh extends gK.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},Eh.defaultAttributes,t)),this._isPaused=!0,this.updateAttributes=()=>{this._startAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -73.1429 161.4994 a 48.7619 48.7619 0 0 1 25.9901 7.5093 l 201.7524 127.1223 a 48.7619 48.7619 0 0 1 0.3657 82.2613 l -201.7524 129.6335 A 48.7619 48.7619 0 0 1 292.5952 540.1838 v -256.7314 a 48.7619 48.7619 0 0 1 48.7619 -48.7619 z m 24.381 92.9402 v 167.9116 l 131.9497 -84.7726 L 365.7381 327.6063 z"},Eh.defaultControllerAttr),{visible:this.attribute.start.visible}),this.attribute.start.style)},this._pauseAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -48.7619 195.0476 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z m 158.4762 0 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z"},Eh.defaultControllerAttr),{visible:this.attribute.pause.visible}),this.attribute.pause.style)},this._forwardAttr={style:Object.assign(Object.assign(Object.assign({},Eh.defaultControllerAttr),{visible:this.attribute.forward.visible}),this.attribute.forward.style)},this._backwardAttr={style:Object.assign(Object.assign(Object.assign({},Eh.defaultControllerAttr),{visible:this.attribute.backward.visible}),this.attribute.backward.style)},this.updateLayout()},this.updateLayout=()=>{var t,e,i,r;this._layout=this.attribute.layout,"horizontal"===this._layout?(this._backwardAttr.style.symbolType=null!=(t=this._backwardAttr.style.symbolType)?t:"M 521.29 734.276 L 230.929 448.019 L 521.29 161.762 c 37.685 -37.153 38.003 -97.625 0.707 -134.384 c -37.297 -36.758 -98.646 -36.435 -136.331 0.718 l -357.43 352.378 c -0.155 0.153 -0.297 0.314 -0.451 0.468 c -0.084 0.082 -0.172 0.157 -0.256 0.239 c -18.357 18.092 -27.581 41.929 -27.743 65.902 c -0.004 0.311 -0.017 0.623 -0.018 0.934 c 0.001 0.316 0.014 0.632 0.018 0.948 c 0.165 23.97 9.389 47.803 27.743 65.892 c 0.083 0.082 0.171 0.157 0.255 0.239 c 0.154 0.154 0.296 0.315 0.452 0.468 l 357.43 352.378 c 37.685 37.153 99.034 37.476 136.331 0.718 c 37.297 -36.758 36.979 -97.231 -0.707 -134.384 z",this._forwardAttr.style.symbolType=null!=(e=this._forwardAttr.style.symbolType)?e:"M 30 163 L 320.361 449.257 L 30 735.514 c -37.685 37.153 -38.003 97.625 -0.707 134.384 c 37.297 36.758 98.646 36.435 136.331 -0.718 l 357.43 -352.378 c 0.155 -0.153 0.297 -0.314 0.451 -0.468 c 0.084 -0.082 0.172 -0.157 0.256 -0.239 c 18.357 -18.092 27.581 -41.929 27.743 -65.902 c 0.004 -0.311 0.017 -0.623 0.018 -0.934 c -0.001 -0.316 -0.014 -0.632 -0.018 -0.948 c -0.165 -23.97 -9.389 -47.803 -27.743 -65.892 c -0.083 -0.082 -0.171 -0.157 -0.255 -0.239 c -0.154 -0.154 -0.296 -0.315 -0.452 -0.468 l -357.43 -352.378 c -37.685 -37.153 -99.034 -37.476 -136.331 -0.718 c -37.297 36.758 -36.979 97.231 0.707 134.384 z"):"vertical"===this._layout&&(this._backwardAttr.style.symbolType=null!=(i=this._backwardAttr.style.symbolType)?i:"m 161.724 521.29 l 286.257 -290.361 l 286.257 290.361 c 37.153 37.685 97.625 38.003 134.384 0.707 c 36.758 -37.297 36.435 -98.646 -0.718 -136.331 l -352.378 -357.43 c -0.153 -0.155 -0.314 -0.297 -0.468 -0.451 c -0.082 -0.084 -0.157 -0.172 -0.239 -0.256 c -18.092 -18.357 -41.929 -27.581 -65.902 -27.743 c -0.311 -0.004 -0.623 -0.017 -0.934 -0.018 c -0.316 0.001 -0.632 0.014 -0.948 0.018 c -23.97 0.165 -47.803 9.389 -65.892 27.743 c -0.082 0.083 -0.157 0.171 -0.239 0.255 c -0.154 0.154 -0.315 0.296 -0.468 0.452 l -352.378 357.43 c -37.153 37.685 -37.476 99.034 -0.718 136.331 c 36.758 37.297 97.231 36.979 134.384 -0.707 z",this._forwardAttr.style.symbolType=null!=(r=this._forwardAttr.style.symbolType)?r:"M 734.276 28.71 L 448.019 319.071 L 161.762 28.71 c -37.153 -37.685 -97.625 -38.003 -134.384 -0.707 c -36.758 37.297 -36.435 98.646 0.718 136.331 l 352.378 357.43 c 0.153 0.155 0.314 0.297 0.468 0.451 c 0.082 0.084 0.157 0.172 0.239 0.256 c 18.092 18.357 41.929 27.581 65.902 27.743 c 0.311 0.004 0.623 0.017 0.934 0.018 c 0.316 -0.001 0.632 -0.014 0.948 -0.018 c 23.97 -0.165 47.803 -9.389 65.892 -27.743 c 0.082 -0.083 0.157 -0.171 0.239 -0.255 c 0.154 -0.154 0.315 -0.296 0.468 -0.452 l 352.378 -357.43 c 37.153 -37.685 37.476 -99.034 0.718 -136.331 c -36.758 -37.297 -97.231 -36.979 -134.384 0.707 z")},this._initPlay=()=>{(0,lU.Z)(this._playController)&&(this._playController=new Eo(Object.assign({},this._startAttr.style)),this.add(this._playController))},this._initBackward=()=>{(0,lU.Z)(this._backwardController)&&(this._backwardController=new Eo(Object.assign({},this._backwardAttr.style)),this.add(this._backwardController))},this._initForward=()=>{(0,lU.Z)(this._forwardController)&&(this._forwardController=new Eo(Object.assign({},this._forwardAttr.style)),this.add(this._forwardController))},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._playController.addEventListener("pointerdown",t=>{t.stopPropagation(),!0===this._isPaused?this.play():this.pause()}),this._backwardController.addEventListener("pointerdown",t=>{t.stopPropagation(),this.backward()}),this._forwardController.addEventListener("pointerdown",t=>{t.stopPropagation(),this.forward()}))},this.renderPlay=()=>{this._isPaused?this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._startAttr.style)):this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._pauseAttr.style))},this.renderBackward=()=>{this._backwardController.setAttributes(this._backwardAttr.style)},this.renderForward=()=>{this._forwardController.setAttributes(this._forwardAttr.style)},this.play=()=>{this._dispatchEvent(tA.OnPlay)},this.pause=()=>{this._dispatchEvent(tA.OnPause)},this.forward=()=>{this._dispatchEvent(tA.OnForward)},this.backward=()=>{this._dispatchEvent(tA.OnBackward)},this.togglePlay=()=>{this._playController.setAttributes(this._startAttr.style),this._isPaused=!0},this.togglePause=()=>{this._playController.setAttributes(this._pauseAttr.style),this._isPaused=!1},this.updateAttributes(),this._initPlay(),this._initBackward(),this._initForward(),this._initEvents()}render(){this.updateAttributes(),this.renderPlay(),this.renderBackward(),this.renderForward()}}Eh.defaultControllerAttr={visible:!0,x:0,y:0,size:20,fill:"#91caff",pickMode:"imprecise",cursor:"pointer"},Eh.defaultAttributes={[tM.Start]:{},[tM.Pause]:{},[tM.Backward]:{},[tM.Forward]:{}};let Eu={visible:!0,style:{x:0,y:0,dx:0,dy:0,size:20},order:0,space:10},Ed=[200,10];(th=tw||(tw={})).Default="default",th.Reverse="reverse";let Ec=({direction:t,maxIndex:e,dataIndex:i})=>t===tw.Default&&i===e,Ep=({direction:t,minIndex:e,dataIndex:i})=>t===tw.Reverse&&i===e,Eg=({direction:t,maxIndex:e,minIndex:i,dataIndex:r})=>Ec({direction:t,maxIndex:e,dataIndex:r})||Ep({direction:t,minIndex:i,dataIndex:r}),Ef=({direction:t,minIndex:e,dataIndex:i})=>t===tw.Default&&i===e,Em=({direction:t,maxIndex:e,dataIndex:i})=>t===tw.Reverse&&i===e,Ey=({direction:t,maxIndex:e,minIndex:i,dataIndex:r})=>Ef({direction:t,minIndex:i,dataIndex:r})||Em({direction:t,maxIndex:e,dataIndex:r}),E_=t=>"top"===t||"bottom"===t,Ev=(t,e,i,r)=>"default"===t?Math.min(e+1,r):Math.max(e-1,i);class Eb extends gK.k{getMinIndex(){return this._minIndex}getMaxIndex(){return this._maxIndex}getDataIndex(){return this._dataIndex}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},Eb.defaultAttributes,t)),this._data=[],this._dataIndex=0,this._layoutInfo={},this._updateSliderAttrs=()=>{var t,e;let i;(0,uT.Z)(this._handlerStyle.size)?i=this._handlerStyle.size:this._handlerStyle.size&&this._handlerStyle.size.length&&(i=(0,gX.Fp)(this._handlerStyle.size[0],this._handlerStyle.size[1]));let r={visible:this._sliderVisible,min:this._minIndex,max:this._maxIndex,value:this._dataIndex,railWidth:this._railStyle.width,railHeight:this._railStyle.height,railStyle:this._railStyle,trackStyle:this._trackStyle,handlerSize:(0,uT.Z)(i)?i:void 0,handlerStyle:this._handlerStyle,dy:this.attribute.slider.dy,dx:this.attribute.slider.dx,slidable:!0,range:!1,handlerText:{visible:!1},startText:{visible:!1},endText:{visible:!1},disableTriggerEvent:this.attribute.disableTriggerEvent};if(E_(this._orient)){let e=Math.max(0,this._layoutInfo.slider.size),i=null!=(t=this._railStyle.height)?t:Ed["1"];r.layout="horizontal",r.railHeight=i,r.railWidth=e,r.x=this._layoutInfo.slider.x,r.y=this._layoutInfo.slider.y}else{let t=Math.max(0,this._layoutInfo.slider.size),i=null!=(e=this._railStyle.width)?e:Ed["1"];r.layout="vertical",r.railWidth=i,r.railHeight=t,r.x=this._layoutInfo.slider.x,r.y=this._layoutInfo.slider.y}return r},this._initSlider=()=>{let t=this._updateSliderAttrs();this._slider=new El.i(t),this._sliderVisible&&this.add(this._slider)},this._updateControllerAttrs=()=>{let t={start:this._start,pause:this._pause,forward:this._forward,backward:this._backward,disableTriggerEvent:this.attribute.disableTriggerEvent};return t.layout=E_(this._orient)?"horizontal":"vertical",t.start=Object.assign(Object.assign({},t.start),{style:Object.assign(Object.assign({},t.start.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),t.pause=Object.assign(Object.assign({},t.pause),{style:Object.assign(Object.assign({},t.pause.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),t.backward=Object.assign(Object.assign({},t.backward),{style:Object.assign(Object.assign({},t.backward.style),{x:this._layoutInfo.backward.x,y:this._layoutInfo.backward.y})}),t.forward=Object.assign(Object.assign({},t.forward),{style:Object.assign(Object.assign({},t.forward.style),{x:this._layoutInfo.forward.x,y:this._layoutInfo.forward.y})}),t},this._initController=()=>{let t=this._updateControllerAttrs();this._controller=new Eh(t),this._controllerVisible&&this.add(this._controller)},this._initAttributes(),this._initDataIndex(),this._initLayoutInfo(),this._initController(),this._initSlider()}_initAttributes(){this._size=this.attribute.size,this._orient=this.attribute.orient,this._data=this.attribute.data,this._minIndex=0,this._maxIndex=this._data.length-1;let{slider:t={},controller:e={}}=this.attribute;this._sliderVisible=t.visible,this._railStyle=Object.assign({},t.railStyle),this._trackStyle=Object.assign({},t.trackStyle),this._handlerStyle=Object.assign({},t.handlerStyle),this._controllerVisible=e.visible,this._start=Object.assign({},e.start),this._pause=Object.assign({},e.pause),this._forward=Object.assign({},e.forward),this._backward=Object.assign({},e.backward)}_initDataIndex(){var t;this._dataIndex=null!=(t=this.attribute.dataIndex)?t:0}_initLayoutInfo(){var t,e,i;let r=[this._start,this._backward,this._forward].sort((t,e)=>t.order-e.order),s=r.filter(t=>"end"!==t.position),n=r.filter(t=>"end"===t.position),a=null!=(t=E_(this._orient)?this._railStyle.height:this._railStyle.width)?t:Ed["1"],l=r.reduce((t,e)=>{let i=e.style.size,r=(0,lw.Z)(i)?i:(0,gX.Fp)(i[0],i[1]);return t+e.space+r},0),o=this._sliderVisible?(E_(this._orient)?null==(e=this._size)?void 0:e.width:null==(i=this._size)?void 0:i.height)-l:0,h=o-this.attribute.slider.space,u=s.reduce((t,e)=>{let{key:i,space:r,style:{size:s}}=e,n=(0,lw.Z)(s)?s:(0,gX.Fp)(s[0],s[1]);return this._layoutInfo[i]=Object.assign(Object.assign({},this._layoutInfo[i]),{size:n,x:E_(this._orient)?t+r:(this._size.width-n)/2,y:E_(this._orient)?(this._size.height-n)/2:t+r}),t+r+n},0);this._layoutInfo.slider=Object.assign(Object.assign({},this._layoutInfo.slider),{size:h,x:E_(this._orient)?u+this.attribute.slider.space:(this._size.width-a)/2,y:E_(this._orient)?(this._size.height-a)/2:u+this.attribute.slider.space}),n.reduce((t,e)=>{let{key:i,space:r,style:{size:s}}=e,n=(0,lw.Z)(s)?s:(0,gX.Fp)(s[0],s[1]);return this._layoutInfo[i]=Object.assign(Object.assign({},this._layoutInfo[i]),{size:n,x:E_(this._orient)?t+r:(this._size.width-n)/2,y:E_(this._orient)?(this._size.height-n)/2:t+r}),t+r+n},u+o)}render(){this._initLayoutInfo(),this.renderSlider(),this.renderController()}renderSlider(){let t=this._updateSliderAttrs();this._slider.setAttributes(t)}renderController(){let t=this._updateControllerAttrs();this._controller.setAttributes(t)}dispatchCustomEvent(t,e){this._dispatchEvent(t,{eventType:t,index:e,value:this._data[e]})}}Eb.defaultAttributes={visible:!0,data:[],interval:1e3,orient:"bottom",align:"center",size:{height:20,width:300},slider:{visible:!0,space:10,dx:0,dy:0,railStyle:{cornerRadius:5},trackStyle:{},handlerStyle:{}},controller:{visible:!0,start:Object.assign(Object.assign({},Eu),{key:"start",position:"start",space:0}),pause:Object.assign(Object.assign({},Eu),{key:"pause",position:"start"}),forward:Object.assign(Object.assign({},Eu),{key:"forward",position:"end"}),backward:Object.assign(Object.assign({},Eu),{key:"backward",position:"start"})}},(tu=tT||(tT={})).change="change",tu.play="play",tu.pause="pause",tu.backward="backward",tu.forward="forward",tu.end="end",tu.OnChange="change",tu.OnPlay="play",tu.OnPause="pause",tu.OnBackward="backward",tu.OnForward="forward",tu.OnEnd="end";var Ex=i(6004);function ES(){(0,Ex.d)(),(0,oo.M)(),(0,pL.k)()}ES();class Ek extends Eb{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},t)),this._activeIndex=-1,this._isReachEnd=!1,this._initAttributes=()=>{var t,e,i;super._initAttributes(),this._alternate=null!=(t=this.attribute.alternate)&&t,this._interval=null!=(e=this.attribute.interval)?e:1e3,this._direction=null!=(i=this.attribute.direction)?i:tw.Default},this._initDataIndex=()=>{var t;this._dataIndex=(0,lU.Z)(this.attribute.dataIndex)?"default"===this._direction?this._minIndex:this._maxIndex:null!=(t=this.attribute.dataIndex)?t:0,this._slider.setAttribute("value",this._dataIndex)},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(tA.OnPlay,t=>{t.stopPropagation(),this.play()}),this._controller.addEventListener(tA.OnPause,t=>{t.stopPropagation(),this.pause()}),this._controller.addEventListener(tA.OnForward,t=>{t.stopPropagation(),this.forward()}),this._controller.addEventListener(tA.OnBackward,t=>{t.stopPropagation(),this.backward()}),this._slider.addEventListener("change",t=>{let e=Math.floor(t.detail.value)+.5;this._dataIndex=t.detail.value>=e?Math.ceil(t.detail.value):Math.floor(t.detail.value),this._slider.setValue(this._dataIndex),this.dispatchCustomEvent(tT.change)}))},this.play=()=>{this._isPlaying||1!==this._data.length&&(this._controller.togglePause(),this._isPlaying=!0,(Eg({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction})||Ey({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction}))&&(this._direction===tw.Default?this._updateDataIndex(this._minIndex):this._updateDataIndex(this._maxIndex)),this.dispatchCustomEvent(tT.play),this._isReachEnd=!1,this._tickTime=Date.now(),this._rafId=es.rF.getRequestAnimationFrame()(this._play.bind(this,!0)))},this._play=t=>{let e=Date.now();if(this._isReachEnd&&e-this._tickTime>=this._interval)return this._isReachEnd=!1,void this._playEnd();t&&this._activeIndex!==this._dataIndex?(this.dispatchCustomEvent(tT.change),this._activeIndex=this._dataIndex):e-this._tickTime>=this._interval&&(this._tickTime=e,this._updateDataIndex(Ev(this._direction,this._dataIndex,this._minIndex,this._maxIndex)),this._activeIndex=this._dataIndex,this.dispatchCustomEvent(tT.change)),("default"===this._direction&&this._dataIndex>=this._maxIndex||"reverse"===this._direction&&this._dataIndex<=this._minIndex)&&(this._isReachEnd=!0),this._rafId=es.rF.getRequestAnimationFrame()(this._play.bind(this,!1))},this._updateDataIndex=t=>{this._dataIndex=t,this._slider.setValue(this._dataIndex)},this._playEnd=()=>{this._isPlaying=!1,this._controller.togglePlay(),es.rF.getCancelAnimationFrame()(this._rafId),this._activeIndex=-1,this.dispatchCustomEvent(tT.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,es.rF.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(tT.pause))},this.backward=()=>{let t,{loop:e=!1}=this.attribute;t=e?this._dataIndex-1<this._minIndex?this._maxIndex:this._dataIndex-1:Math.max(this._dataIndex-1,this._minIndex),this._updateDataIndex(t),this.dispatchCustomEvent(tT.change),this.dispatchCustomEvent(tT.backward)},this.forward=()=>{let t,{loop:e=!1}=this.attribute;t=e?this._dataIndex+1>this._maxIndex?this._minIndex:this._dataIndex+1:Math.min(this._dataIndex+1,this._maxIndex),this._updateDataIndex(t),this.dispatchCustomEvent(tT.change),this.dispatchCustomEvent(tT.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}setAttributes(t,e){super.setAttributes(t,e),this._initAttributes()}dispatchCustomEvent(t){super.dispatchCustomEvent(t,this._dataIndex)}}ES();class EA extends Eb{constructor(t){super(t),this._isPlaying=!1,this._startTime=Date.now(),this._initAttributes=()=>{var t;super._initAttributes(),this._maxIndex=this._data.length,this._slider.setAttribute("max",this._maxIndex),this._isPlaying=!1,this._elapsed=0,this._interval=null!=(t=this.attribute.interval)?t:1e3;let e=this._data.length;this.attribute.totalDuration&&this._data.length?(this._totalDuration=this.attribute.totalDuration,this._interval=this._totalDuration/(null!=e?e:1)):(this._totalDuration=this._interval*e,this._interval=this.attribute.interval)},this._initDataIndex=()=>{var t;this._dataIndex=null!=(t=this.attribute.dataIndex)?t:this._minIndex},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(tA.OnPlay,t=>{t.stopPropagation(),this.play()}),this._controller.addEventListener(tA.OnPause,t=>{t.stopPropagation(),this.pause()}),this._controller.addEventListener(tA.OnForward,t=>{t.stopPropagation(),this.forward()}),this._controller.addEventListener(tA.OnBackward,t=>{t.stopPropagation(),this.backward()}),this._slider.addEventListener("change",t=>{var e;t.stopPropagation();let i=null==(e=t.detail)?void 0:e.value,r=i/this._maxIndex;this._elapsed=r*this._totalDuration,this._startTime=Date.now()-this._elapsed,this._dispatchChange(i)}))},this._getSliderValue=()=>Math.min(this._elapsed/this._totalDuration*this._maxIndex,this._maxIndex),this._updateSlider=()=>{let t=this._getSliderValue();this._dataIndex=Math.floor(t),this._slider.setValue(Math.min(t,this._maxIndex)),this._dispatchChange(Math.floor(t))},this._dispatchChange=t=>{let e=Math.floor(t);e!==this._activeIndex&&(this._dataIndex=e,this._activeIndex=e,e!==this._maxIndex&&this.dispatchCustomEvent(tT.change))},this.play=()=>{var t,e,i,r;return t=this,e=void 0,i=void 0,r=function*(){this._isPlaying||(this._controller.togglePause(),this._isPlaying=!0,this._elapsed>=this._totalDuration&&(this._elapsed=0),this._startTime=Date.now()-this._elapsed,this.dispatchCustomEvent(tT.play),this._rafId=es.rF.getRequestAnimationFrame()(this._play.bind(this)))},new(i||(i=Promise))(function(s,n){function a(t){try{o(r.next(t))}catch(t){n(t)}}function l(t){try{o(r.throw(t))}catch(t){n(t)}}function o(t){var e;t.done?s(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(a,l)}o((r=r.apply(t,e||[])).next())})},this._play=()=>{this._elapsed=Date.now()-this._startTime;let t=this._getSliderValue();this._updateSlider(),t>=this._maxIndex?this._playEnd():this._rafId=es.rF.getRequestAnimationFrame()(this._play.bind(this))},this._playEnd=()=>{this._isPlaying=!1,es.rF.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(tT.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,this._elapsed=Date.now()-this._startTime,es.rF.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(tT.pause))},this.backward=()=>{let t=Date.now(),e=+this._interval,i=this._elapsed-e;i<=0?(this._elapsed=0,this._startTime=t):(this._elapsed=i,this._startTime=this._startTime+this._interval),this._updateSlider(),this.dispatchCustomEvent(tT.backward)},this.forward=()=>{let t=Date.now(),e=+this._interval,i=this._elapsed+e;i>=this._totalDuration?(this._startTime=t-this._totalDuration,this._elapsed=this._totalDuration):(this._startTime=this._startTime-e,this._elapsed=i),this._updateSlider(),this.dispatchCustomEvent(tT.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}dispatchCustomEvent(t){super.dispatchCustomEvent(t,this._dataIndex)}render(){super.render()}}let EM=t=>gs(Object.assign({},t)),Ew=t=>gs(Object.assign({},t)),ET=t=>Object.assign(Object.assign({},t),{style:Object.assign({},gs(t.style))}),EC=t=>{var e,i,r,s,n,a,l,o,h,u,d,c,p,g,f;let m=EM(null!=(i=null==(e=null==t?void 0:t.slider)?void 0:e.trackStyle)?i:{}),y=EM(null!=(s=null==(r=null==t?void 0:t.slider)?void 0:r.railStyle)?s:{}),_=Ew(null!=(a=null==(n=null==t?void 0:t.slider)?void 0:n.handlerStyle)?a:{}),v=ET(null!=(o=null==(l=null==t?void 0:t.controller)?void 0:l.start)?o:{}),b=ET(null!=(u=null==(h=null==t?void 0:t.controller)?void 0:h.pause)?u:{}),x=ET(null!=(c=null==(d=null==t?void 0:t.controller)?void 0:d.backward)?c:{}),S=ET(null!=(g=null==(p=null==t?void 0:t.controller)?void 0:p.forward)?g:{}),k=Object.assign(Object.assign({},t),{direction:t.direction,interval:t.interval,visible:t.visible,orient:null!=(f=t.orient)?f:"bottom",slider:Object.assign(Object.assign({},t.slider),{trackStyle:m,railStyle:y,handlerStyle:_}),controller:Object.assign(Object.assign({},t.controller),{start:v,pause:b,backward:x,forward:S})});return t.visible||(k.controller.visible=!1,k.slider.visible=!1),k},EE=(t,e)=>Object.assign(Object.assign({},EC(t)),{data:e,type:"continuous"}),EB=(t,e)=>Object.assign(Object.assign({},EC(t)),{data:e,type:"discrete"}),EP=t=>"left"===t||"right"===t,EO=t=>"top"===t||"bottom"===t;class EI extends gO{constructor(){super(...arguments),this.layoutZIndex=z.Player,this.layoutLevel=j.Player,this.specKey="player",this.type=rA.player,this._orient="bottom",this._getPlayerAttrs=()=>{var t,e,i,r,s,n;let a=this._spec.type,l={size:{width:this._width,height:this._height},dx:null!=(t=this._spec.dx)?t:0+this._dx,dy:null!=(e=this._spec.dy)?e:0+this._dy};return"discrete"===a?Object.assign(Object.assign(Object.assign({},EB(this._spec,this._specs)),l),{disableTriggerEvent:this._option.disableTriggerEvent,loop:null==(r=null==(i=this._spec)?void 0:i.loop)||r}):Object.assign(Object.assign(Object.assign({},EE(this._spec,this._specs)),l),{disableTriggerEvent:this._option.disableTriggerEvent,loop:null==(n=null==(s=this._spec)?void 0:s.loop)||n})},this._createOrUpdatePlayerComponent=()=>{let t=Object.assign({},this._getPlayerAttrs()),e=this.getContainer();this._playerComponent?t1(t,this._cacheAttrs)||(this._cacheAttrs=t,this._playerComponent.setAttributes(t),this._playerComponent._initAttributes(),this._playerComponent.render()):("discrete"===t.type?this._playerComponent=new Ek(t):this._playerComponent=new EA(t),this._cacheAttrs=t,this._playerComponent.name="player",e.add(this._playerComponent),this._initEvent())},this._maxSize=()=>{var t,e,i,r,s,n,a,l,o;return Math.max(...eo(null==(e=null==(t=this._spec.controller.start)?void 0:t.style)?void 0:e.size),...eo(null==(r=null==(i=this._spec.controller.pause)?void 0:i.style)?void 0:r.size),...eo(null==(n=null==(s=this._spec.controller.backward)?void 0:s.style)?void 0:n.size),...eo(null==(l=null==(a=this._spec.controller.forward)?void 0:a.style)?void 0:l.size),null!=(o=EP(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)?o:10)},this._sliderExceededSize=()=>{var t,e,i,r,s,n,a,l,o;let h=null!=(t=EP(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)?t:10,u=Math.max(...eo(null==(i=null==(e=this._spec.controller.start)?void 0:e.style)?void 0:i.size),...eo(null==(s=null==(r=this._spec.controller.pause)?void 0:r.style)?void 0:s.size),...eo(null==(a=null==(n=this._spec.controller.backward)?void 0:n.style)?void 0:a.size),...eo(null==(o=null==(l=this._spec.controller.forward)?void 0:l.style)?void 0:o.size));return h>=u?h-u:0},this._initEvent=()=>{this._option.disableTriggerEvent||(this._option.globalInstance.on(rB.rendered,()=>{var t;(null==(t=this._spec)?void 0:t.auto)&&(this._playerComponent.pause(),this._playerComponent.play())}),this._playerComponent.addEventListener(tT.end,()=>{var t;this.event.emit(rB.playerEnd,{model:this}),this._alternate&&"discrete"===this._spec.type&&(this._direction="default"===this._direction?"reverse":"default",this._playerComponent.setAttributes({direction:this._direction,dataIndex:"reverse"===this._direction?this._specs.length-2:1})),(null==(t=this._spec)?void 0:t.loop)&&this._playerComponent.play()}),this._playerComponent.addEventListener(tT.change,t=>{let{index:e}=t.detail;this.changePlayerIndex(e)}),this._playerComponent.addEventListener(tT.backward,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(rB.playerBackward,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(tT.forward,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(rB.playerForward,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(tT.play,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(rB.playerPlay,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(tT.pause,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(rB.playerPause,{model:this,value:{spec:i,index:e,specs:this._specs}})}))}}get orient(){return this._orient}set layoutOrient(t){this._orient=t}setAttrFromSpec(){var t,e,i,r,s,n,a,l;super.setAttrFromSpec(),this._orient=null!=(t=this._spec.orient)?t:"bottom",this._specs=null!=(e=this._spec.specs)?e:[],this._direction=null!=(i=this._spec.direction)?i:"default",this._alternate=null!=(r=this._spec.alternate)&&r,this._dx=null!=(s=this._spec.dx)?s:0,this._dy=null!=(n=this._spec.dy)?n:0,this._position=null!=(a=this._spec.position)?a:"middle",this._visible=null==(l=this._spec.visible)||l}afterSetLayoutStartPoint(t){if(super.afterSetLayoutStartPoint(t),ee(t.x)){let e=EP(this._orient)?t.x+this._sliderExceededSize()/2:t.x;this._playerComponent&&this._playerComponent.setAttribute("x",e)}if(ee(t.y)){let e=EO(this._orient)?t.y+this._sliderExceededSize()/2:t.y;this._playerComponent&&this._playerComponent.setAttribute("y",e)}}getBoundsInRect(t,e){this._width=this._computeWidth(t),this._height=this._computeHeight(t),this._dx=this._computeDx(e),this._dy=this._computeDy(e);let i=this._computeLayoutRect(t,this._width,this._height);return this._createOrUpdatePlayerComponent(),i}_getNeedClearVRenderComponents(){return[this._playerComponent]}_computeLayoutRect(t,e,i){if(!1===this._visible)return{x1:0,x2:0,y1:0,y2:0};switch(this._orient){case"top":case"left":return{x1:0,y1:0,x2:e,y2:i};case"right":return{x1:t.width-e,y1:0,x2:t.width,y2:t.height};default:return{x1:0,y1:t.height-i,x2:t.width,y2:t.height}}}_computeWidth(t){return tH(this._spec.width)?Math.min(t.width,Number(this._spec.width)):EP(this._orient)?this._maxSize():t.width}_computeHeight(t){return tH(this._spec.height)?(this._height=this._spec.height,Math.min(t.height,Number(this._spec.height))):EO(this._orient)?this._maxSize():t.height}_computeDx(t){return EP(this._orient)||"start"===this._position?0:"middle"===this._position?(t.width-this._width)/2:t.width-this._width}_computeDy(t){return EO(this._orient)||"start"===this._position?0:"middle"===this._position?(t.height-this._height)/2:t.height-this._height}changePlayerIndex(t){let e=this._specs[t];this._option.globalInstance.updateFullData(e.data),this.event.emit(rB.playerChange,{model:this,value:{spec:e,index:t,specs:this._specs}})}}EI.builtInTheme={player:{visible:!0,position:"start",padding:{top:20,bottom:20},slider:{space:10,trackStyle:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.8},railStyle:{fill:{type:"palette",key:"sliderRailColor"}},handlerStyle:{size:15,stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fill:{type:"palette",key:"playerControllerColor"}}},controller:{start:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},pause:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},backward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},forward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}}}}},EI.specKey="player",EI.type=rA.player;let ER=()=>{ig.registerComponent(EI.type,EI)};class EL extends gO{constructor(t,e){super(t,e),this.type=rA.label,this.name=rA.label,this.layoutType="none",this.layoutZIndex=z.Label,this._regions=e.getRegionsInIndex(e.regionIndexes)}_interactiveConfig(t){let{interactive:e}=t,i={hover:!1,select:!1,state:t.state};if(!0!==e)return i;let{hover:r,select:s}=this._option.getChart().getSpec();return!1===r&&!1===r.enable||(i.hover=!0),!1===s&&!1===s.enable||(i.select=!0),i}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reRender=!0,t1(e,t)||(i.reMake=!0),i}_getDataLabelType(t,e){let i=t.type;return"line"===i||"area"===i?null!=e?e:"line-data":"rect"===i?"rect":"arc"===i?"arc":"symbol"===i||"cell"===i?"symbol":t.setDataLabelType?t.setDataLabelType():""}_setTransformOfComponent(t,e){t.setAttributeTransform(({labelStyle:t,size:i,itemEncoder:r})=>{let s=i(),n=e4({type:"palette",key:"secondaryFontColor"},this.getColorScheme());return{dataLabels:eo(e).map((e,i)=>{let a=t(i),l=[],o=e.getGraphics();if(o)return a.data&&a.data.length?a.data.forEach((t,e)=>{if(o[e]){let e=r(t,{labelIndex:i});et(e.fill)&&(e.fill=n),et(e.data)&&(e.data=t),l.push(e)}}):o.forEach(t=>{let{data:e,diffState:s}=t.context;s!==N.exit&&e.forEach((t,{})=>{let e=r(t,{labelIndex:i});et(e.fill)&&(e.fill=n),et(e.data)&&(e.data=t),l.push(e)})}),tQ(a.overlap)&&et(a.overlap.size)&&(a.overlap.size=Object.assign({},s)),Object.assign(Object.assign({smartInvert:!1,baseMarkGroupName:e.getProductId(),getBaseMarks:()=>o},a),{type:this._getDataLabelType(e,a.type),data:l})}),size:s}})}getVRenderComponents(){let t=[];return this.getMarks().forEach(e=>{let i=e.getComponent();i&&t.push(i)}),t}clear(){super.clear(),this.getMarks().forEach(t=>{t&&t.clearComponent()})}}EL.type=rA.label;class ED extends bS{constructor(){super(...arguments),this.skipEncode=!1}getRule(){return this._rule}setRule(t){this._rule=t}getTarget(){return this._target}setTarget(t){this._target=t,this._rule||this.setRule(t.type)}getComponent(){return this._component}setComponent(t){this._component=t}render(){}}ED.type="text",ED.constructorType="label";let EF=()=>{bk(),ig.registerMark(ED.constructorType,ED)};class Ez extends gB{_initTheme(t,e){return{spec:t,theme:this._theme}}}var Ej=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class EH extends gK.k{constructor(t,e){let{dataLabels:i}=t;super((null==e?void 0:e.skipDefault)?t:Object.assign({dataLabels:i},(0,cZ.Z)({},EH.defaultAttributes,Ej(t,["dataLabels"])))),this.name="data-label"}render(){var t;let{dataLabels:e,size:i}=this.attribute;if(!e||0===e.length)return;let{width:r=0,height:s=0,padding:n}=i||{};if(!r||!s||!(0,uT.Z)(s*r))return;this._componentMap||(this._componentMap=new Map);let a=c6(r,s,n),l=a.bitmap(),o=new Map,h=this._componentMap;for(let r=0;r<e.length;r++){let s=e[r],n=pM(s.type)||pS;if(n){let{baseMarkGroupName:e,type:h}=s,u=null!=(t=s.id)?t:`${e}-${h}-${r}`;"arc"===s.type&&(s.width=i.width,s.height=i.height);let d=this._componentMap.get(u);d?(d.setBitmapTool(a),d.setBitmap(l),d.setAttributes(s)):((d=new n(s)).setBitmap(l),d.setBitmapTool(a),this.add(d)),o.set(u,d)}}h.forEach((t,e)=>{o.get(e)||this.removeChild(t)}),this._componentMap=o}setLocation(t){this.translateTo(t.x,t.y)}disableAnimation(){this._componentMap.forEach(t=>{t.disableAnimation()})}enableAnimation(){this._componentMap.forEach(t=>{t.enableAnimation()})}}EH.defaultAttributes={pickable:!1};class EN extends EL{constructor(t,e){super(t,e),this.type=rA.label,this.name=rA.label,this.specKey="label",this.transformerConstructor=Ez,this.layoutZIndex=z.Label,this._layoutRule=t.labelLayout||"series"}static getSpecInfo(t,e){let i=[];return((null==e?void 0:e.region)||[]).forEach((r,s)=>{(r.seriesIndexes||[]).some(t=>{let{markLabelSpec:i={}}=e.series[t];return Object.values(i).some(t=>Array.isArray(t)&&t.some(t=>t.visible))})&&i.push({spec:t,type:rA.label,specInfoPath:["component",this.specKey,s],regionIndexes:[s]})}),i}init(t){super.init(t),this.initEvent(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()}reInit(t){super.reInit(t),this._labelInfoMap&&(this._labelInfoMap.forEach(t=>{t.forEach(({labelMark:t})=>{t.release()})}),this._labelInfoMap.clear()),this._labelInfoMap&&this._labelInfoMap.clear(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()}initEvent(){this.event.on(rB.dataZoomChange,()=>{this._labelComponentMap.forEach((t,e)=>{let i=e.getComponent();i&&i.disableAnimation()}),this.event.on(rE.AFTER_MARK_RENDER_END,t)});let t=()=>{this._labelComponentMap.forEach((t,e)=>{let i=e.getComponent();i&&i.enableAnimation()}),this.event.off(rE.AFTER_MARK_RENDER_END,t)}}_initTextMark(){this._labelInfoMap||(this._labelInfoMap=new Map),this._labelComponentMap||(this._labelComponentMap=new Map),pW(this._regions,t=>{let{markLabelSpec:e={}}=t.getSpecInfo(),i=Object.keys(e),r=t.getRegion();this._labelInfoMap.get(r)||this._labelInfoMap.set(r,[]);for(let s=0;s<i.length;s++){let n=i[s],a=t.getMarkInName(n);a&&e[n].forEach((e,i)=>{var s,l,o;if(e.visible){let h=this._labelInfoMap.get(r),u=this._createMark({type:"label",name:`${null!=(s=t.userId)?s:t.id}-${n}-label-${i}`},{attributeContext:t.getMarkAttributeContext()});e.showRelatedMarkTooltip&&(null==(o=null==(l=t.tooltipHelper)?void 0:l.activeTriggerSet.mark)||o.add(u)),u.setTarget(a),h.push({labelMark:u,baseMark:a,series:t,labelSpec:e})}})}})}_initLabelComponent(){let t={};this._labelComponentMap.forEach((e,i)=>{t[i.name]=i}),this._labelInfoMap.forEach((e,i)=>{if("region"===this._layoutRule){let r=!1,s=`${i.getGroupMark().name}-label-component`,n=t[s];n||(r=!0,n=this._createMark({type:"component",name:s},{componentType:"label"},{support3d:this._spec.support3d})),n&&(r&&(n.setSkipBeforeLayouted(!0),this._marks.addMark(n),e.forEach(t=>{var e;null==(e=t.baseMark.getData())||e.addRelatedMark(n)})),e[0]&&t5(e[0].labelSpec.zIndex)&&n.setMarkConfig({zIndex:e[0].labelSpec.zIndex}),this._labelComponentMap.set(n,()=>this._labelInfoMap.get(i)),t[s]=null)}else e.forEach((e,r)=>{var s;let n=!1,a=`${e.labelMark.name}-component`,l=t[a];l||(n=!0,l=this._createMark({type:"component",name:a},{componentType:"label",noSeparateStyle:!0},{support3d:e.baseMark.getMarkConfig().support3d})),l&&(t5(e.labelSpec.zIndex)&&l.setMarkConfig({zIndex:e.labelSpec.zIndex}),n&&(l.setSkipBeforeLayouted(!0),this._marks.addMark(l),null==(s=e.baseMark.getData())||s.addRelatedMark(l)),this._labelComponentMap.set(l,()=>this._labelInfoMap.get(i)[r]),t[a]=null)})}),Object.keys(t).forEach(e=>{let i=t[e];i&&(i.release(),this._labelComponentMap.delete(i))})}_initTextMarkStyle(){this._labelComponentMap.forEach((t,e)=>{eo(t()).forEach(({labelMark:t})=>{t.setComponent(e)})}),this._labelInfoMap.forEach(t=>{t.forEach(t=>{var e,i;let{labelMark:r,labelSpec:s,series:n}=t;if(this.initMarkStyleWithSpec(r,s),tK(null==s?void 0:s.getStyleHandler)){let t=s.getStyleHandler(n);null==t||t.call(n,r,s)}(null==(i=null==(e=r.stateStyle)?void 0:e.normal)?void 0:i.lineWidth)&&r.setAttribute("stroke",n.getColorAttribute(),"normal",H.Base_Series)})})}updateLayoutAttribute(){super.updateLayoutAttribute(),this._labelComponentMap.forEach((t,e)=>{let i=t();tY(i)?this._updateMultiLabelAttribute(i,e):this._updateSingleLabelAttribute(i,e)})}_updateMultiLabelAttribute(t,e){this._updateLabelComponentAttribute(e,t.map(({baseMark:t})=>t),t)}_updateSingleLabelAttribute(t,e){let{baseMark:i}=t;this._updateLabelComponentAttribute(e,i,[t])}_updateLabelComponentAttribute(t,e,i){let r=this._option.getComponentsByType("totalLabel");t.setMarkConfig({interactive:!1}),t.setSimpleStyle({labelStyle:t=>{var e,s;let n=i[t],{labelSpec:a,labelMark:l,series:o}=n,h=l.getRule(),u=this._interactiveConfig(a),d=null!=(s=null==(e=this._spec)?void 0:e.centerOffset)?s:0,c=it({textStyle:Object.assign({pickable:!0===a.interactive},a.style),overlap:{avoidMarks:r.map(t=>t.getMarks()[0].getProductId())}},function(t,e){var i;let{labelSpec:r}=e;r.overlap&&!ey(r.overlap)&&(r.overlap={});let s=null!=(i=Ay[t])?i:Ay.point;return e.series.type===rw.sankey?function(t){var e,i,r,s;let{series:n,labelSpec:a={}}=t,l=null!=(e=Av(a.position))?e:"outside",o=n.direction,h=l;return t3(l)&&("vertical"===o?h="inside-start"===l?t=>"inside-left":"inside-middle"===l?t=>"center":"inside-end"===l?t=>"inside-right":t=>"bottom":"inside-start"===l?h=t=>"inside-left":"inside-middle"===l?h=t=>"center":"inside-end"===l?h=t=>"inside-right":"outside"===l&&(h=t=>"right")),{position:h,overlap:!1!==a.overlap&&(!t3(l)||!l.includes("inside"))&&{strategy:null!=(r=null==(i=a.overlap)?void 0:i.strategy)?r:(s=n,[{type:"position",position:t=>"horizontal"===s.direction?["right","left"]:["bottom","top"]}])},smartInvert:!1,offset:0,syncState:!0}}(e):s(e)}(h,n),Object.assign(Object.assign(Object.assign({},gI(a,["position","style","state","type","stackDataFilterType","getStyleHandler"])),u),{centerOffset:d}),a.stackDataFilterType?{dataFilter:"min"===a.stackDataFilterType?t=>t.filter(t=>t.data[nf]):t=>t.filter(t=>t.data[ng])}:{});return o&&o.parseLabelStyle&&(c=o.parseLabelStyle(c,a,l)),"line"!==h&&"area"!==h||(c.type=h),c},size:()=>{var t;return Object.assign({padding:null==(t=i[0].labelSpec.overlap)?void 0:t.padding},i[0].series.getRegion().getLayoutRect())},itemEncoder:(t,{labelIndex:e})=>i[e]&&!i[e].labelMark.skipEncode?A_(i[e],t,i[e].labelSpec.formatMethod,i[e].labelSpec.formatter):{data:t}}),this._setTransformOfComponent(t,e)}compileMarks(){this.getMarks().forEach(t=>{let e,i=this._labelComponentMap.get(t)();e=tY(i)?i[0].series.getRegion().getGroupMark().getProduct():i.series.getRegion().getGroupMark().getProduct(),t.compile({group:e})})}getLabelInfoByTextGraphic(t){let e,i=null==t?void 0:t.parent,r=null==i?void 0:i.parent;if(r){let t=r.getChildren().indexOf(i);this._labelComponentMap.forEach((i,s)=>{s.getComponent()===r&&(e=eo(i())[t])})}return e}}EN.type=rA.label,EN.specKey="label",EN.transformerConstructor=Ez;let EV=()=>{ig.registerGraphicComponent(EN.type,t=>new EH(t)),EF(),gL(),ig.registerComponent(EN.type,EN,!0,1/0)};class EW extends EL{constructor(){super(...arguments),this.type=rA.totalLabel,this.name=rA.totalLabel,this.specKey="totalLabel",this.layoutZIndex=z.Label}static getSpecInfo(t,e){var i;let r=[];return null==(i=null==e?void 0:e.region)||i.forEach((t,i)=>{var s;null==(s=t.seriesIndexes)||s.forEach(t=>{let{spec:s}=e.series[t],n=s[this.specKey];(null==n?void 0:n.visible)&&r.push({spec:n,type:rA.totalLabel,specPath:["series",t,this.specKey],specInfoPath:["component",this.specKey,t],regionIndexes:[i],seriesIndexes:[t]})})}),r}init(t){super.init(t),this._initTextMark(),this._initLabelComponent()}reInit(t){super.reInit(t),this._initTextMark()}_initTextMark(){var t;let e=this._getSeries();if(null==(t=e.getSpec().totalLabel)?void 0:t.visible){let t=e.getSeriesMark();if(t){let e=this._createMark({type:"label",name:`${t.name}-total-label`});this._baseMark=t,this._textMark=e,this._initTextMarkStyle()}}}_initTextMarkStyle(){var t;super.initMarkStyleWithSpec(this._textMark,this._spec),this.setMarkStyle(this._textMark,{text:t=>t[nc]},"normal",H.Default);let e=this._getSeries();null==(t=e.initTotalLabelMarkStyle)||t.call(e,this._textMark)}_initLabelComponent(){var t;let e=this._getSeries(),i=this._createMark({type:"component",name:`${null!=(t=e.name)?t:e.type}-total-label-component`},{componentType:"label"},{support3d:this._spec.support3d});i&&(this._marks.addMark(i),e.getData().addRelatedMark(i))}updateLayoutAttribute(){super.updateLayoutAttribute();let t=this._getSeries();this._marks.forEach((e,i)=>{e.setMarkConfig({interactive:!1}),e.setSimpleStyle({labelStyle:()=>{var e,i;if(this._baseMark){let{offset:r,animation:s,overlap:n,position:a="top"}=this._spec,l=this._interactiveConfig(this._spec);return it({textStyle:{pickable:!0===this._spec.interactive},position:function(t,e,i="top"){var r,s;let n,{direction:a}=t,l=+("horizontal"===a?null!=(r=t.getXAxisHelper())&&!!r.isInverse():null!=(s=t.getYAxisHelper())&&!!s.isInverse());switch(e){case"rect":case"symbol":n=("bottom"===i?{vertical:["bottom","top"],horizontal:["left","right"]}:{vertical:["top","bottom"],horizontal:["right","left"]})[a][l];break;default:n="top"}return n}(t,this._baseMark.type,a),x:0,y:0},null!=(i=null==(e=t.getTotalLabelComponentStyle)?void 0:e.call(t,{baseMark:this._baseMark,labelMark:this._textMark}))?i:{},Object.assign({offset:r,animation:s,overlap:n,dataFilter:t=>t.filter(t=>"bottom"===a?t.data[nf]:t.data[ng])},l))}},size:()=>{var t;return Object.assign({padding:null==(t=this._spec.overlap)?void 0:t.padding},this._regions[0].getLayoutRect())},itemEncoder:e=>A_({baseMark:this._baseMark,labelMark:this._textMark,series:t,labelSpec:t.getSpec().totalLabel},e,this._spec.formatMethod)}),this._setTransformOfComponent(e,this._baseMark)})}compileMarks(){this.getMarks().forEach(t=>{let e=this._regions[0].getGroupMark().getProduct();t.compile({group:e,context:{model:this}})})}_getSeries(){return this._option.getSeriesInIndex([this.getSpecPath()[1]])[0]}}EW.type=rA.totalLabel,EW.builtInTheme={totalLabel:{visible:!1,offset:5,overlap:{clampForce:!0,strategy:[]},smartInvert:!1,animation:!1,style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"primaryFontColor"}}}},EW.specKey="totalLabel";let EU=()=>{ig.registerGraphicComponent(EW.type,t=>new EH(t)),EF(),gL(),ig.registerComponent(EW.type,EW,!0)},EG=(t,e)=>{let i=Math.atan2(t,e);return i<0?i+2*Math.PI:i};function EZ(){E$._animate=Ck}Cr(),(0,Ci.j)(),(0,Ci.O)(),(0,pL.k)(),(0,Ce.i)(),(0,cG.N)(),(0,ux.d)();class E$ extends Cl{markerAnimate(t){E$._animate&&this._animationConfig&&E$._animate([this._line,this._decorativeLine],this._item,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},E$.defaultAttributes,t)),this.name="markPoint",this.defaultUpdateAnimation=Cw,this.defaultExitAnimation=CT,this._isArcLine=!1,this._isStraightLine=!1}setLabelPos(){}getTextAlignAttr(t,e,i,r,s){return(0,c3.U4)(Math.abs(r),Math.PI/2,.001)||(0,c3.U4)(Math.abs(r),3*Math.PI/2,.001)?(0,c3.ic)(t,r,s):(0,c3.WF)(r)?Cz.postiveXAxis[s]:Cz.negativeXAxis[s]}setItemAttributes(t,e,i,r,s){var n,a;if(!t)return;let{autoRotate:l=!0,refX:o=0,refY:h=0,refAngle:u=0,style:d,position:c=tk.middle}=e,{state:p}=this.attribute,g=(null==(n=this._line)?void 0:n.getEndAngle())||0,f=o*Math.cos(g)+h*Math.cos(g-Math.PI/2),m=o*Math.sin(g)+h*Math.sin(g-Math.PI/2);if("text"===s){let s=r.x-i.x,n=r.y-i.y;t.setAttributes(Object.assign(Object.assign({},d),{textStyle:Object.assign(Object.assign({},this.getTextAlignAttr(l,s,n,g,null!=(a=e.position)?a:"end")),d.textStyle),state:{panel:(0,cZ.Z)({},c5.n0,null==p?void 0:p.textBackground),text:(0,cZ.Z)({},c5.n0,null==p?void 0:p.itemContent)}}))}else("richText"===s||"image"===s)&&(t.setAttributes({dx:this.getItemDx(t,c,d)+(d.dx||0),dy:this.getItemDy(t,c,d)+(d.dy||0)}),t.states=(0,cZ.Z)({},c5.n0,null==p?void 0:p.itemContent));let y=(0,c3.WF)(g)?g:g-Math.PI;t.setAttributes({x:r.x+(f||0),y:r.y+(m||0),angle:l&&y+u})}getItemDx(t,e,i){var r,s;let n=null!=(s=null==(r=null==t?void 0:t.AABBBounds)?void 0:r.width())?s:(null==i?void 0:i.width)||0;return e.includes("inside")?-n:0}getItemDy(t,e,i){var r,s;let n=null!=(s=null==(r=null==t?void 0:t.AABBBounds)?void 0:r.height())?s:(null==i?void 0:i.height)||0;return e.includes("top")||e.includes("Top")?-n:e.includes("middle")||e.includes("Middle")?-n/2:0}initItem(t,e,i){let r,{state:s}=this.attribute,{type:n="text",style:a,renderCustomCallback:l}=t;return"symbol"===n?(r=c$.i.symbol(Object.assign(Object.assign({},i),a))).states=(0,cZ.Z)({},c5.n0,null==s?void 0:s.itemContent):"text"===n?r=new w7.V(Object.assign(Object.assign({},i),{state:{panel:(0,cZ.Z)({},c5.n0,null==s?void 0:s.textBackground),text:(0,cZ.Z)({},c5.n0,null==s?void 0:s.itemContent)}})):"richText"===n?(r=c$.i.richtext(Object.assign(Object.assign({},i),a))).states=(0,cZ.Z)({},c5.n0,null==s?void 0:s.itemContent):"image"===n?(r=c$.i.image(Object.assign(Object.assign({},i),a))).states=(0,cZ.Z)({},c5.n0,null==s?void 0:s.itemContent):"custom"===n&&l&&((r=l()).states=(0,cZ.Z)({},c5.n0,null==s?void 0:s.itemContent)),r.name=`mark-point-${n}`,this.setItemAttributes(r,t,e,i,n),r}getItemLineAttr(t,e,i){let r=[],s={x:0,y:0},n=0,a=0,l=0,{type:o="type-s",arcRatio:h=.8}=t,u=i.x-e.x,d=i.y-e.y;if(this._isStraightLine=(0,c3.U4)(u,0,.001)||(0,c3.U4)(d,0,.001),this._isArcLine){let{x:t,y:e}=this.attribute.position,{x:r,y:o}=i,u=(t+r)/2,d=u+h*(o>e?-1:1)*u,c=(e===o?0:-(t-r)/(e-o))*(d-u)+(e+o)/2;a=EG(e-c,t-d),l=EG(o-c,r-d),s={x:d,y:c};let p=Math.sqrt((d-t)*(d-t)+(c-e)*(c-e)),g=this.attribute.targetSymbol.style.size/2;a+=2*Math.acos(Math.sqrt(1-g*g/(4*p*p))),h>0?l<a&&(l+=2*Math.PI):a<l&&(a+=2*Math.PI),n=Math.sqrt((d-t)*(d-t)+(c-e)*(c-e))}else r="type-do"!==o||this._isStraightLine?"type-po"!==o||this._isStraightLine?"type-op"!==o||this._isStraightLine?[e,i]:[e,{x:e.x,y:i.y},i]:[e,{x:i.x,y:e.y},i]:[e,{x:(e.x+i.x)/2,y:i.y},i];return{points:r=(0,c3.Bh)(r),center:s,radius:n,startAngle:a,endAngle:l}}reDrawLine(t,e){this._line.release();let{startSymbol:i,endSymbol:r,lineStyle:s,type:n="type-s"}=t,{state:a}=this.attribute,l=this._isArcLine?C1:CB.X;this._container.removeChild(this._line),this._line=new l(Object.assign(Object.assign({},e),{pickable:!1,startSymbol:i,endSymbol:r,lineStyle:s,visible:t.visible,state:{line:(0,cZ.Z)({},c5.n0,null==a?void 0:a.line),startSymbol:(0,cZ.Z)({},c5.n0,null==a?void 0:a.lineStartSymbol),endSymbol:(0,cZ.Z)({},c5.n0,null==a?void 0:a.lineEndSymbol)}})),this._container.add(this._line)}setItemLineAttr(t,e,i){if(this._line){let{startSymbol:r,endSymbol:s,lineStyle:n,type:a="type-s"}=t,{state:l}=this.attribute,o=this.getItemLineAttr(t,e,i);this._isArcLine&&"arc-segment"===this._line.key||!this._isArcLine&&"segment"===this._line.key?this._line.setAttributes(Object.assign(Object.assign({},o),{startSymbol:r,endSymbol:s,lineStyle:n,visible:t.visible,state:{line:(0,cZ.Z)({},c5.n0,null==l?void 0:l.line),startSymbol:(0,cZ.Z)({},c5.n0,null==l?void 0:l.lineStartSymbol),endSymbol:(0,cZ.Z)({},c5.n0,null==l?void 0:l.lineEndSymbol)}})):this.reDrawLine(t,o)}}getDecorativeLineAttr(t){var e;let i=(null==(e=null==t?void 0:t.decorativeLine)?void 0:e.length)||10,r=this._line.getEndAngle()||0;return{startPointOffsetX:i/2*Math.cos(r-Math.PI/2),startPointOffsetY:i/2*Math.sin(r-Math.PI/2),endPointOffsetX:-i/2*Math.cos(r-Math.PI/2),endPointOffsetY:-i/2*Math.sin(r-Math.PI/2)}}setDecorativeLineAttr(t,e,i){var r;if(this._decorativeLine){let{lineStyle:s}=t,{startPointOffsetX:n,startPointOffsetY:a,endPointOffsetX:l,endPointOffsetY:o}=this.getDecorativeLineAttr(t);this._decorativeLine.setAttributes(Object.assign(Object.assign({points:[{x:e.x+n,y:e.y+a},{x:e.x+l,y:e.y+o}]},s),{visible:i})),this._decorativeLine.states=(0,cZ.Z)({},c5.n0,null==(r=this.attribute.state)?void 0:r.line)}}setTargetItemAttributes(t,e){var i,r;this._targetItem&&(this._targetItem.setAttributes(Object.assign({x:e.x,y:e.y,visible:null!=(i=t.visible)&&i,size:t.size},t.style)),this._targetItem.states=(0,cZ.Z)({},c5.n0,null==(r=this.attribute.state)?void 0:r.targetItem))}setAllOfItemsAttr(t,e){var i;let{position:r,itemLine:s={},itemContent:n={},limitRect:a,targetSymbol:l}=this.attribute,{type:o="text",confine:h}=n;if(a&&h){let{x:t,y:i,width:r,height:s}=a,{dx:n,dy:l}=Cs(this._item,{x1:t,y1:i,x2:t+r,y2:i+s});e.x=e.x+n,e.y=e.y+l}this.setTargetItemAttributes(l,r),this.setItemLineAttr(s,t,e),this.setItemAttributes(this._item,n,t,e,o),this.setDecorativeLineAttr(s,e,null==(i=s.decorativeLine)?void 0:i.visible)}computeNewPositionAfterTargetItem(t){var e,i;let r,{itemContent:s={},targetSymbol:n,itemLine:a}=this.attribute,{offsetX:l=0,offsetY:o=0}=s,{offset:h=0,style:u,visible:d=!1,size:c}=n,p=d?null!=(i=null!=(e=u.size)?e:c)?i:20:0;return r="type-do"===a.type?EG(o,l/2):"type-po"===a.type?EG(0,l):"type-op"===a.type?EG(o,0):EG(o,l),{newPosition:{x:t.x+(p/2+h)*Math.cos(r),y:t.y+(p/2+h)*Math.sin(r)},newItemPosition:{x:t.x+(p/2+h)*Math.cos(r)+l,y:t.y+(p/2+h)*Math.sin(r)+o}}}initMarker(t){let{position:e,itemContent:i={},itemLine:r}=this.attribute,{type:s="type-s",arcRatio:n=.8}=r,{offsetX:a=0,offsetY:l=0}=i;this._isStraightLine=(0,c3.U4)(a,0,.001)||(0,c3.U4)(l,0,.001),this._isArcLine="type-arc"===s&&0!==n&&!this._isStraightLine;let{newPosition:o,newItemPosition:h}=this.computeNewPositionAfterTargetItem(e),u=new(this._isArcLine?C1:CB.X)({points:[],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0});u.name="mark-point-line",this._line=u,t.add(u);let d=c$.i.line({points:[]});d.name="mark-point-decorativeLine",this._decorativeLine=d,t.add(d);let c=c$.i.symbol({});c.name="mark-point-targetItem",this._targetItem=c,t.add(this._targetItem);let p=this.initItem(i,o,h);this._item=p,t.add(p),this.setAllOfItemsAttr(o,h)}updateMarker(){let{position:t,itemContent:e={},itemLine:i}=this.attribute,{type:r="text"}=e,{type:s="type-s",arcRatio:n=.8}=i,{offsetX:a=0,offsetY:l=0}=e;this._isStraightLine=(0,c3.U4)(a,0,.001)||(0,c3.U4)(l,0,.001);let o="type-arc"===s&&0!==n&&!this._isStraightLine,{newPosition:h,newItemPosition:u}=this.computeNewPositionAfterTargetItem(t);o!==this._isArcLine?(this._isArcLine=o,this.reDrawLine(i,{points:[{x:0,y:0}],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0})):this._isArcLine=o,this.setItemAttributes(this._item,e,h,u,r),this.setAllOfItemsAttr(h,u)}isValidPoints(){let{position:t}=this.attribute;return!(!(0,uT.Z)(t.x)||!(0,uT.Z)(t.y))}}E$.defaultAttributes={interactive:!0,targetSymbol:{visible:!1,offset:0,style:{symbolType:"circle",size:20,fill:!1,stroke:"rgba(46, 47, 50)"}},itemLine:{visible:!0,decorativeLine:{visible:!1,length:30},startSymbol:{visible:!0,clip:!0,symbolType:"circle",size:20,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},endSymbol:{visible:!1,clip:!0,symbolType:"triangle",size:12,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},lineStyle:{stroke:"#000",lineWidth:1}},itemContent:{type:"text",position:"middle",refX:10}};var EY=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};class EX extends CZ{constructor(){super(...arguments),this.specKey="markPoint",this.layoutZIndex=z.MarkPoint}static _getMarkerCoordinateType(t){let{doPolarProcess:e,doGeoProcess:i}=Ct(t);return"polar"===t.coordinateType||e?"polar":"geo"===t.coordinateType||i?"geo":"cartesian"}_createMarkerComponent(){var t,e,i,r,s,n,a,l,o,h,u,d,c,p,g,f,m,y,_,v,b,x,S,k,A,M,w,T,C,E,B,P,O,I,R,L;let{itemContent:D={},itemLine:F={},targetSymbol:z={}}=this._spec,{type:j="text",text:H,symbol:N,image:V,richText:W,customMark:U,textStyle:G,symbolStyle:Z,imageStyle:$,richTextStyle:Y,customMarkStyle:X,style:K={},state:q={}}=D,Q=EY(D,["type","text","symbol","image","richText","customMark","textStyle","symbolStyle","imageStyle","richTextStyle","customMarkStyle","style","state"]),J=null,te=null,ti={};"text"===j?(J=null!=(t=null==H?void 0:H.state)?t:q,te=T3(t8({dx:0,dy:0},null!=(e=null!=H?H:G)?e:K),this._markerData,this._markAttributeContext)):"richText"===j?(J=null!=(i=null==W?void 0:W.state)?i:q,te=T4(t8({width:100,height:100},null!=(s=null!=(r=null==W?void 0:W.style)?r:Y)?s:K),this._markerData,this._markAttributeContext)):"symbol"===j?(J=null!=(n=null==N?void 0:N.state)?n:q,te=gs(T4(t8({symbolType:"star",fill:"rgb(48, 115, 242)",fillOpacity:.8,size:20},null!=(l=null!=(a=null==N?void 0:N.style)?a:Z)?l:K),this._markerData,this._markAttributeContext))):"image"===j?(J=null!=(o=null==V?void 0:V.state)?o:q,te=T4(t8({width:80,height:80},null!=(u=null!=(h=null==V?void 0:V.style)?h:$)?u:K),this._markerData,this._markAttributeContext)):"custom"===j&&(J=null!=(d=null==U?void 0:U.state)?d:q,te=T4(null!=(p=null!=(c=null==U?void 0:U.style)?c:X)?p:K,this._markerData,this._markAttributeContext));let tr={zIndex:this.layoutZIndex,interactive:null==(g=this._spec.interactive)||g,hover:null==(f=this._spec.interactive)||f,select:null==(m=this._spec.interactive)||m,position:{x:0,y:0},clipInRange:null!=(y=this._spec.clip)&&y,itemContent:Object.assign(Object.assign({type:j,offsetX:(O=D.offsetX,I=this._relativeSeries.getRegion(),tK(O)?O(I):O),offsetY:(R=D.offsetX,L=this._relativeSeries.getRegion(),tK(R)?R(L):R)},Q),{style:T4(te,this._markerData,this._markAttributeContext)}),targetSymbol:{offset:null!=(_=z.offset)?_:0,visible:null!=(v=z.visible)&&v,size:null!=(b=z.size)?b:20,style:T4(z.style,this._markerData,this._markAttributeContext)},state:{line:T5(null!=(S=null==(x=this._spec.itemLine.line)?void 0:x.state)?S:{},this._markerData,this._markAttributeContext),lineStartSymbol:T5(null!=(A=null==(k=this._spec.itemLine.startSymbol)?void 0:k.state)?A:{},this._markerData,this._markAttributeContext),lineEndSymbol:T5(null!=(w=null==(M=this._spec.itemLine.endSymbol)?void 0:M.state)?w:{},this._markerData,this._markAttributeContext),itemContent:T5(J,this._markerData,this._markAttributeContext),textBackground:T5(null==(C=null==(T=this._spec.itemContent.text)?void 0:T.labelBackground)?void 0:C.state,this._markerData,this._markAttributeContext),targetItem:T5(null!=(B=null==(E=this._spec.targetSymbol)?void 0:E.state)?B:{},this._markerData,this._markAttributeContext)},animation:null!=(P=this._spec.animation)&&P,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate},{visible:ts,line:tn={}}=F,ta=EY(F,["visible","line"]);return tr.itemLine=!1!==ts?Object.assign(Object.assign({},ta),{visible:!0,lineStyle:gs(tn.style)}):{visible:!1},new E$(tr)}_markerLayout(){var t,e,i,r,s;let n,a=this._spec,l=this._markerData,o=this._relativeSeries,{point:h}=this._computePointsAttr(),u=this._getRelativeDataView().latestData,d=l?l.latestData[0]&&l.latestData[0].latestData?l.latestData[0].latestData:l.latestData:u;if(a.clip||(null==(t=a.itemContent)?void 0:t.confine)){let{minX:t,maxX:e,minY:i,maxY:r}=T2([o.getRegion()]);n={x:t,y:i,width:e-t,height:r-i}}if(this._markerComponent){let t=null!=(e=this._markerComponent.attribute)?e:{},a=null!=(r=null==(i=t.itemContent)?void 0:i.textStyle)?r:{};this._markerComponent.setAttributes({position:void 0===h?{x:null,y:null}:h,itemContent:Object.assign(Object.assign({},t.itemContent),{textStyle:Object.assign(Object.assign({},a),{text:(null==(s=this._spec.itemContent.text)?void 0:s.formatMethod)?this._spec.itemContent.text.formatMethod(d,u):a.text}),offsetX:T7(h,t.itemContent.offsetX,this._relativeSeries.getRegion()),offsetY:T7(h,t.itemContent.offsetY,this._relativeSeries.getRegion())}),limitRect:n,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}}_initDataView(){let t=this._spec,{doXYProcess:e,doPolarProcess:i,doGeoProcess:r}=Ct(t);(t5(t.coordinate)||e||i||r)&&this._initCommonDataView()}}EX.specKey="markPoint";let EK={itemLine:{decorativeLine:{visible:!1},startSymbol:{size:5,visible:!0,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},line:{style:{stroke:{type:"palette",key:"markLineStrokeColor"}}}},itemContent:{offsetY:-50}};class Eq extends EX{constructor(){super(...arguments),this.type=rA.markPoint,this.name=rA.markPoint,this.coordinateType="cartesian"}_computePointsAttr(){var t;let e,i=this._spec,r=this._markerData,s=this._relativeSeries,n=t5(i.x)&&t5(i.y),a=t5(i.coordinate),l=t5(i.position),o=null!=(t=null==i?void 0:i.autoRange)&&t;return n?e=TK(r,s,s,s,o)[0][0]:a?e=TQ(r,s,o,i.coordinatesOffset)[0]:l&&(e=T1(i.position,s,i.regionRelative)[0]),{point:e}}_computeOptions(){let t,e=this._spec,{doXYProcess:i}=Ct(e),r=t5(e.coordinate);return i?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}])]:r&&(t=this._processSpecCoo(e)),{options:t}}}Eq.type=rA.markPoint,Eq.coordinateType="cartesian",Eq.builtInTheme={markPoint:EK};let EQ=()=>{ig.registerComponent(Eq.type,Eq),EZ()};class EJ extends EX{constructor(){super(...arguments),this.type=rA.polarMarkPoint,this.name=rA.polarMarkPoint,this.coordinateType="polar"}_computePointsAttr(){var t,e;let i=this._markerData,r=this._relativeSeries,s=Tq(i,r,r,r,null!=(e=null==(t=this._spec)?void 0:t.autoRange)&&e)[0][0];return{point:lc({x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y},s.radius,s.angle)}}_computeOptions(){let t=this._spec;return{options:[this._processSpecByDims([{dim:"radius",specValue:t.radius},{dim:"angle",specValue:t.angle}])]}}}EJ.type=rA.polarMarkPoint,EJ.coordinateType="polar",EJ.builtInTheme={polarMarkPoint:EK};let E0=()=>{ig.registerComponent(EJ.type,EJ),EZ()};class E1 extends EX{constructor(){super(...arguments),this.type=rA.geoMarkPoint,this.name=rA.geoMarkPoint,this.coordinateType="geo"}_computePointsAttr(){return{point:function(t,e){let i=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach(t=>{t5(t.areaName)&&i.push([{x:e.nameValueToPosition(t.areaName).x+e.getRegion().getLayoutStartPoint().x,y:e.nameValueToPosition(t.areaName).y+e.getRegion().getLayoutStartPoint().y}])}),i}(this._markerData,this._relativeSeries)[0][0]}}_computeOptions(){let t=this._spec;return{options:[this._processSpecByDims([{dim:"areaName",specValue:t.areaName}])]}}}E1.type=rA.geoMarkPoint,E1.coordinateType="geo",E1.builtInTheme={geoMarkPoint:EK};let E2=()=>{ig.registerComponent(E1.type,E1),EZ()};var E3=i(92493),E5=i(6201);(td=tC||(tC={})).drawStart="drawStart",td.drawEnd="drawEnd",td.drawing="drawing",td.moving="moving",td.moveStart="moveStart",td.moveEnd="moveEnd",td.brushActive="brushActive",td.brushClear="brushClear";let E4={trigger:"pointerdown",updateTrigger:"pointermove",endTrigger:["pointerup","pointerleave"],resetTrigger:"pointerupoutside",hasMask:!0,brushMode:"single",brushType:"rect",brushStyle:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",strokeWidth:2},brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:10,interactiveRange:{minY:-1/0,maxY:1/0,minX:-1/0,maxX:1/0}},E7={debounce:Tg.Z,throttle:Tf.Z};(0,oo.M)(),(0,Sk.M)();class E6 extends gK.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},E6.defaultAttributes,t)),this.name="brush",this._activeBrushState=!1,this._activeDrawState=!1,this._cacheDrawPoints=[],this._activeMoveState=!1,this._operatingMaskMoveDx=0,this._operatingMaskMoveDy=0,this._operatingMaskMoveRangeX=[-1/0,1/0],this._operatingMaskMoveRangeY=[-1/0,1/0],this._brushMaskAABBBoundsDict={},this._firstUpdate=!0,this._onBrushStart=t=>{let{updateTrigger:e=E4.updateTrigger,endTrigger:i=E4.endTrigger,brushMoved:r=!0}=this.attribute;(0,Tm.IX)(e).forEach(t=>this.stage.addEventListener(t,this._onBrushingWithDelay)),(0,Tm.IX)(i).forEach(t=>this.stage.addEventListener(t,this._onBrushEnd)),t.stopPropagation(),this._firstUpdate=!0,this._activeMoveState=r&&this._isPosInBrushMask(t),this._activeDrawState=!this._activeMoveState,this._startPos=this.eventPosToStagePos(t),this._cacheDrawPoints=[this._startPos]},this._onBrushing=t=>{this._outOfInteractiveRange(t)||(t.stopPropagation(),this._firstUpdate?(this._activeDrawState&&this._initDraw(t),this._activeMoveState&&this._initMove(t),this._firstUpdate=!1):(this._activeDrawState&&this._drawing(t),this._activeMoveState&&this._moving(t)))},this._onBrushingWithDelay=0===this.attribute.delayTime?this._onBrushing:E7[this.attribute.delayType](this._onBrushing,this.attribute.delayTime),this._onBrushEnd=t=>{this._releaseBrushUpdateEvents(),t.preventDefault(),this._activeDrawState&&this._drawEnd(t),this._activeMoveState&&this._moveEnd(t),this._activeDrawState=!1,this._activeMoveState=!1},this._onBrushClear=t=>{t.preventDefault(),this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(tC.brushClear,t)),this._activeDrawState=!1,this._activeMoveState=!1}}_bindBrushEvents(){if(this.releaseBrushEvents(),this.attribute.disableTriggerEvent)return;let{trigger:t=E4.trigger,resetTrigger:e=E4.resetTrigger}=this.attribute;(0,Tm.IX)(t).forEach(t=>this.stage.addEventListener(t,this._onBrushStart)),(0,Tm.IX)(e).forEach(t=>this.stage.addEventListener(t,this._onBrushClear))}_initDraw(t){let{brushMode:e}=this.attribute,i=this.eventPosToStagePos(t);this._cacheDrawPoints.push(i),"single"===e&&this._clearMask(),this._addBrushMask(),this._dispatchBrushEvent(tC.drawStart,t),this._activeBrushState=!1}_initMove(t){var e,i;this._cacheMovePoint=this.eventPosToStagePos(t),this._operatingMaskMoveDx=null!=(e=this._operatingMask.attribute.dx)?e:0,this._operatingMaskMoveDy=null!=(i=this._operatingMask.attribute.dy)?i:0;let{interactiveRange:r}=this.attribute,{minY:s=-1/0,maxY:n=1/0,minX:a=-1/0,maxX:l=1/0}=r,{x1:o,x2:h,y1:u,y2:d}=this._operatingMask.globalAABBBounds;this._operatingMaskMoveRangeX=[a-o,l-h],this._operatingMaskMoveRangeY=[s-u,n-d],this._operatingMask.setAttribute("pickable",!0),this._dispatchBrushEvent(tC.moveStart,t)}_drawing(t){var e;let i=this.eventPosToStagePos(t),{brushType:r,sizeThreshold:s=5}=this.attribute,n=this._cacheDrawPoints.length;if(n>0){let t=null!=(e=this._cacheDrawPoints[this._cacheDrawPoints.length-1])?e:{};if(i.x===t.x&&i.y===t.y)return}"polygon"===r||n<=1?this._cacheDrawPoints.push(i):this._cacheDrawPoints[n-1]=i;let a=this._computeMaskPoints();this._operatingMask.setAttribute("points",a);let{x:l,y:o}=this._startPos,{x:h,y:u}=this.eventPosToStagePos(t);(Math.abs(h-l)>s||Math.abs(o-u)>s)&&(1!==Object.keys(this._brushMaskAABBBoundsDict).length||this._activeBrushState?this._dispatchBrushEvent(tC.drawing,t):(this._activeBrushState=!0,this._dispatchBrushEvent(tC.brushActive,t)))}_moving(t){let e=this._cacheMovePoint,i=this.eventPosToStagePos(t);if(i.x===(null==e?void 0:e.x)&&i.y===(null==e?void 0:e.y))return;let r=i.x-e.x,s=i.y-e.y,n=Math.min(this._operatingMaskMoveRangeX[1],Math.max(this._operatingMaskMoveRangeX[0],r))+this._operatingMaskMoveDx,a=Math.min(this._operatingMaskMoveRangeY[1],Math.max(this._operatingMaskMoveRangeY[0],s))+this._operatingMaskMoveDy;this._operatingMask.setAttributes({dx:n,dy:a}),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(tC.moving,t)}_drawEnd(t){let{removeOnClick:e=!0,sizeThreshold:i=5}=this.attribute;if(this._outOfInteractiveRange(t))this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(tC.brushClear,t));else{let{x:r,y:s}=this._startPos,{x:n,y:a}=this.eventPosToStagePos(t);1>=Math.abs(n-r)&&1>=Math.abs(a-s)&&e?this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(tC.brushClear,t)):Math.abs(n-r)<i&&Math.abs(s-a)<i?(delete this._brushMaskAABBBoundsDict[this._operatingMask.name],this._container.setAttributes({}),this._container.removeChild(this._operatingMask),this._isEmptyMask()&&this._dispatchBrushEvent(tC.brushClear,t)):(this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(tC.drawEnd,t))}}_moveEnd(t){this._operatingMask&&this._operatingMask.setAttribute("pickable",!1),this._dispatchBrushEvent(tC.moveEnd,t)}render(){this._bindBrushEvents();let t=this.createOrUpdateChild("brush-container",{},"group");this._container=t}releaseBrushEvents(){let{trigger:t=E4.trigger,resetTrigger:e=E4.resetTrigger}=this.attribute;(0,Tm.IX)(t).forEach(t=>this.stage.removeEventListener(t,this._onBrushStart)),(0,Tm.IX)(e).forEach(t=>this.stage.removeEventListener(t,this._onBrushClear)),this._releaseBrushUpdateEvents()}_releaseBrushUpdateEvents(){let{updateTrigger:t=E4.updateTrigger,endTrigger:e=E4.endTrigger}=this.attribute;(0,Tm.IX)(t).forEach(t=>this.stage.removeEventListener(t,this._onBrushingWithDelay)),(0,Tm.IX)(e).forEach(t=>this.stage.removeEventListener(t,this._onBrushEnd))}_computeMaskPoints(){let{brushType:t,xRange:e=[0,0],yRange:i=[0,0]}=this.attribute,r=this._cacheDrawPoints[0],s=this._cacheDrawPoints[this._cacheDrawPoints.length-1];return"rect"===t?[r,{x:s.x,y:r.y},s,{x:r.x,y:s.y}]:"x"===t?[{x:r.x,y:i[0]},{x:s.x,y:i[0]},{x:s.x,y:i[1]},{x:r.x,y:i[1]}]:"y"===t?[{x:e[0],y:r.y},{x:e[0],y:s.y},{x:e[1],y:s.y},{x:e[1],y:r.y}]:(0,E3.Z)(this._cacheDrawPoints)}_addBrushMask(){var t;let{brushStyle:e,hasMask:i}=this.attribute,r=c$.i.polygon(Object.assign(Object.assign({points:(0,E3.Z)(this._cacheDrawPoints),cursor:"move",pickable:!1},e),{opacity:i?null!=(t=e.opacity)?t:1:0}));r.name=`brush-${Date.now()}`,this._operatingMask=r,this._container.add(r),this._brushMaskAABBBoundsDict[r.name]=r.AABBBounds}_isPosInBrushMask(t){let e=this.eventPosToStagePos(t),i=this._container.getChildren();for(let t=0;t<i.length;t++){let{points:r=[],dx:s=0,dy:n=0}=i[t].attribute,a=r.map(t=>({x:t.x+s,y:t.y+n}));if((0,E5.O0)(a,e.x,e.y))return this._operatingMask=i[t],!0}return!1}_outOfInteractiveRange(t){let{interactiveRange:e}=this.attribute,{minY:i=-1/0,maxY:r=1/0,minX:s=-1/0,maxX:n=1/0}=e,a=this.eventPosToStagePos(t);return a.x>n||a.x<s||a.y>r||a.y<i}_dispatchBrushEvent(t,e){this._dispatchEvent(t,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e})}_clearMask(){this._brushMaskAABBBoundsDict={},this._container.removeAllChild(),this._operatingMask=null}_isEmptyMask(){return(0,cY.Z)(this._brushMaskAABBBoundsDict)||Object.keys(this._brushMaskAABBBoundsDict).every(t=>this._brushMaskAABBBoundsDict[t].empty())}}function E9(t,e,i,r,s,n){if(n>e&&n>r||n<e&&n<r||r===e)return 0;let a=(n-e)/(r-e),l=r<e?1:-1;1!==a&&0!==a||(l=r<e?.5:-.5);let o=a*(i-t)+t;return o===s?1/0:o>s?l:0}function E8(t,e){return 1e-8>Math.abs(t-e)}E6.defaultAttributes=E4;class Bt extends gO{constructor(){super(...arguments),this.layoutType="none",this.type=rA.brush,this.name=rA.brush,this.specKey="brush",this.layoutZIndex=z.Brush,this._linkedSeries=[],this._itemMap={},this._linkedItemMap={},this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._cacheInteractiveRangeAttrs=[],this._releatedAxes=[],this._regionAxisMap={},this._axisDataZoomMap={},this._zoomRecord=[]}static getSpecInfo(t){return d0(t,this.specKey,this.type,t=>!1!==t.visible)}init(){let t=this._transformBrushedMarkAttr(this._spec.inBrush),e=this._transformBrushedMarkAttr(this._spec.outOfBrush);this._option.getAllSeries().forEach(i=>{i.getActiveMarks().forEach(r=>{r&&(i.setMarkStyle(r,Object.assign({},t),"inBrush",H.Series),i.setMarkStyle(r,Object.assign({},e),"outOfBrush",H.Series))})})}_initNeedOperatedItem(){let t=this._spec.seriesId,e=this._spec.seriesIndex;this._relativeRegions.forEach(i=>{let r=[];i.getSeries().forEach(s=>{(t&&eo(t).includes(s.userId.toString())||e&&eo(e).includes(s.getSpecIndex())||!e&&!t)&&r.push(...s.getMarksWithoutRoot()),this._itemMap[i.id]=r})}),this._linkedSeries.forEach(t=>{this._linkedItemMap[t.id]=t.getMarksWithoutRoot()})}created(){super.created(),this.initEvent(),this._bindRegions(),this._bindLinkedSeries(),this._initRegionAxisMap(),this._initAxisDataZoomMap(),this._initNeedOperatedItem()}_bindRegions(){t5(this._spec.regionId)||t5(this._spec.regionIndex)?this._relativeRegions=this._option.getRegionsInUserIdOrIndex(eo(this._spec.regionId),eo(this._spec.regionIndex)):this._relativeRegions=this._option.getAllRegions()}_bindLinkedSeries(){(t5(this._spec.brushLinkSeriesId)||t5(this._spec.brushLinkSeriesIndex))&&(this._linkedSeries=this._option.getSeriesInUserIdOrIndex(eo(this._spec.brushLinkSeriesId),eo(this._spec.brushLinkSeriesIndex)))}_initRegionAxisMap(){t5(this._spec.axisId)?eo(this._spec.axisId).forEach(t=>{this._releatedAxes.push(this._option.getComponentByUserId(t))}):t5(this._spec.axisIndex)?eo(this._spec.axisIndex).forEach(t=>{this._releatedAxes.push(this._option.getComponentByIndex("axes",t))}):this._releatedAxes=this._option.getComponentsByKey("axes"),this._releatedAxes.forEach(t=>{null==t||t.getRegions().forEach(e=>{this._regionAxisMap["region_"+e.id]?this._regionAxisMap["region_"+e.id].push(t):this._regionAxisMap["region_"+e.id]=[t]})})}_initAxisDataZoomMap(){this._option.getComponentsByKey("dataZoom").forEach(t=>{t.relatedAxisComponent&&(this._axisDataZoomMap[t.relatedAxisComponent.id]=t)})}initEvent(){}_compareSpec(t,e){this._brushComponents&&this._relativeRegions.forEach((t,e)=>{this._updateBrushComponent(t,e)});let i=super._compareSpec(t,e);return t1(e,t)||(i.reRender=!0,i.reMake=!0),i}onLayoutEnd(){var t;super.onLayoutEnd(),!this._option.disableTriggerEvent&&(null==(t=this._spec.visible)||t)&&(this._brushComponents?this._relativeRegions.forEach((t,e)=>{this._updateBrushComponent(t,e)}):(this._brushComponents=[],this._relativeRegions.forEach((t,e)=>{this._createBrushComponent(t,e)})))}_updateBrushComponent(t,e){let i=this._getBrushInteractiveAttr(t),r=this._brushComponents[e];r.setAttributes(i),this._initMarkBrushState(e,""),r.children[0].removeAllChild()}_createBrushComponent(t,e){var i,r;let s=this._getBrushInteractiveAttr(t),n=new E6(Object.assign(Object.assign(Object.assign({zIndex:this.layoutZIndex,brushStyle:gs(null==(i=this._spec)?void 0:i.style)},s),this._spec),{disableTriggerEvent:this._option.disableTriggerEvent}));n.id=null!=(r=this._spec.id)?r:`brush-${this.id}`,this.getContainer().add(n),this._brushComponents.push(n),this._cacheInteractiveRangeAttrs.push(s),n.addEventListener(tC.brushActive,i=>{this._initMarkBrushState(e,"outOfBrush"),this._emitEvent(rB.brushActive,t)}),n.addEventListener(tC.drawStart,e=>{this._setRegionMarkPickable(t,!0),this._emitEvent(rB.brushStart,t)}),n.addEventListener(tC.moveStart,e=>{this._setRegionMarkPickable(t,!0),this._emitEvent(rB.brushStart,t)}),n.addEventListener(tC.drawing,e=>{this._setRegionMarkPickable(t,!1),this._handleBrushChange(t,e),this._emitEvent(rB.brushChange,t)}),n.addEventListener(tC.moving,e=>{this._setRegionMarkPickable(t,!1),this._handleBrushChange(t,e),this._emitEvent(rB.brushChange,t)}),n.addEventListener(tC.brushClear,i=>{this._setRegionMarkPickable(t,!0),this._initMarkBrushState(e,""),this._emitEvent(rB.brushClear,t)}),n.addEventListener(tC.drawEnd,i=>{var r;this._setRegionMarkPickable(t,!0);let{operateMask:s}=i.detail,{updateElementsState:n=!0}=this._spec;if(null==(r=this._spec)?void 0:r.onBrushEnd)!0===this._spec.onBrushEnd(i)?(this.clearGraphic(),this._initMarkBrushState(e,""),this._emitEvent(rB.brushClear,t)):(this._spec.onBrushEnd(i),this._emitEvent(rB.brushEnd,t));else{let e=this._extendDataInBrush(this._inBrushElementsMap);(this._spec.zoomWhenEmpty||!(e.length>0))&&n||this._setAxisAndDataZoom(s,t),this._emitEvent(rB.brushEnd,t)}}),n.addEventListener(tC.moveEnd,e=>{this._setRegionMarkPickable(t,!0);let{operateMask:i}=e.detail,{updateElementsState:r=!0}=this._spec,s=this._extendDataInBrush(this._inBrushElementsMap);(!this._spec.zoomWhenEmpty&&s.length>0||r)&&this._setAxisAndDataZoom(i,t),this._emitEvent(rB.brushEnd,t)})}_getBrushInteractiveAttr(t){let e=t.getLayoutStartPoint(),i=t.getLayoutRect(),r=e.x,s=r+i.width,n=e.y,a=n+i.height;return{interactiveRange:{minY:n,maxY:a,minX:r,maxX:s},xRange:[r,s],yRange:[n,a]}}_transformBrushedMarkAttr(t){let e={};return(null==t?void 0:t.symbol)&&(e.symbolType=t.symbol),(null==t?void 0:t.symbolSize)&&(e.size=t.symbolSize),(null==t?void 0:t.color)&&(e.fill=t.color),(null==t?void 0:t.colorAlpha)&&(e.fillOpacity=t.colorAlpha),Object.assign(Object.assign({},gs(t)),e)}_handleBrushChange(t,e){let{operateMask:i}=e.detail,{updateElementsState:r=!0}=this._spec;r&&(this._reconfigItem(i,t),this._reconfigLinkedItem(i,t))}_extendDataInBrush(t){var e,i;let r=[];for(let s in t)for(let n in t[s])r.push(Object.assign({},null==(i=null==(e=t[s][n].context)?void 0:e.data)?void 0:i[0]));return r}_extendDatumOutOfBrush(t){var e,i;let r=[];for(let s in t)r.push(null==(i=null==(e=t[s].context)?void 0:e.data)?void 0:i[0]);return r}_emitEvent(t,e){var i;this.event.emit(t,{model:this,value:{operateType:t,operateRegion:e,inBrushData:this._extendDataInBrush(this._inBrushElementsMap),outOfBrushData:this._extendDatumOutOfBrush(this._outOfBrushElementsMap),linkInBrushData:this._extendDataInBrush(this._linkedInBrushElementsMap),linkOutOfBrushData:this._extendDatumOutOfBrush(this._linkedOutOfBrushElementsMap),inBrushElementsMap:this._inBrushElementsMap,outOfBrushElementsMap:this._outOfBrushElementsMap,linkedInBrushElementsMap:this._linkedInBrushElementsMap,linkedOutOfBrushElementsMap:this._linkedOutOfBrushElementsMap,zoomRecord:this._zoomRecord},vchart:null==(i=this._option)?void 0:i.globalInstance})}_reconfigItem(t,e){var i,r,s;if(!(null==t?void 0:t.globalTransMatrix)||!(null==(i=null==t?void 0:t.attribute)?void 0:i.points))return;let n=null!=(s=null==(r=null==t?void 0:t.attribute)?void 0:r.points)?s:[],{a:a,b:l,c:o,d:h,e:u,f:d}=t.globalTransMatrix,c=n.map(t=>({x:a*t.x+o*t.y+u,y:l*t.x+h*t.y+d})),{markTypeFilter:p=[]}=this._spec;this._itemMap[e.id].forEach(e=>{if(p.includes(e.type))return;let i=e.getGraphics();i&&i.length&&i.forEach(i=>{var r,s,n;let a=e.id+"_"+i.context.key,l=this._isBrushContainItem(t.globalAABBBounds,c,i);(null==(r=this._outOfBrushElementsMap)?void 0:r[a])&&l?(i.addState("inBrush",!0),this._inBrushElementsMap[null==t?void 0:t.name]||(this._inBrushElementsMap[null==t?void 0:t.name]={}),this._inBrushElementsMap[null==t?void 0:t.name][a]=i,delete this._outOfBrushElementsMap[a]):(null==(n=null==(s=this._inBrushElementsMap)?void 0:s[null==t?void 0:t.name])?void 0:n[a])&&!l&&(i.removeState("inBrush"),i.addState("outOfBrush",!0),this._outOfBrushElementsMap[a]=i,delete this._inBrushElementsMap[t.name][a])})})}_reconfigLinkedItem(t,e){var i;if(!(null==t?void 0:t.globalTransMatrix)||!(null==(i=null==t?void 0:t.attribute)?void 0:i.points))return;let r=e.getLayoutStartPoint(),s=e.getSeries().map(t=>t.id);this._linkedSeries.forEach(e=>{var i,n;if(!s.includes(e.id)){let s=e.getRegion().getLayoutStartPoint(),a=s.x-r.x,l=s.y-r.y,o=null!=(n=null==(i=null==t?void 0:t.attribute)?void 0:i.points)?n:[],{a:h,b:u,c:d,d:c,e:p,f:g}=t.globalTransMatrix,f=a||0,m=l||0,y=o.map(t=>({x:h*t.x+d*t.y+p+f,y:u*t.x+c*t.y+g+m}));t.globalAABBBounds.clone().set(t.globalAABBBounds.x1+f,t.globalAABBBounds.y1+m,t.globalAABBBounds.x2+f,t.globalAABBBounds.y2+m);let{markTypeFilter:_=[]}=this._spec;this._linkedItemMap[e.id].forEach(e=>{if(_.includes(e.type))return;let i=e.getGraphics();i&&i.length&&i.forEach(i=>{var r,s,n;let{key:a}=i.context,l=e.id+"_"+i.context.key;(null==(r=this._linkedOutOfBrushElementsMap)?void 0:r[l])&&this._isBrushContainItem(t.globalAABBBounds,y,i)?(i.addState("inBrush",!0),this._linkedInBrushElementsMap[null==t?void 0:t.name]||(this._linkedInBrushElementsMap[null==t?void 0:t.name]={}),this._linkedInBrushElementsMap[null==t?void 0:t.name][l]=i,delete this._linkedOutOfBrushElementsMap[l]):(null==(n=null==(s=this._linkedInBrushElementsMap)?void 0:s[null==t?void 0:t.name])?void 0:n[l])&&!this._isBrushContainItem(t.globalAABBBounds,y,i)&&(i.removeState("inBrush"),i.addState("outOfBrush",!0),this._linkedOutOfBrushElementsMap[l]=i)})})}})}_isBrushContainItem(t,e,i){let r=[];if(["symbol","rect"].includes(i.type)){let{x1:t,x2:r,y1:n,y2:a}=null==i?void 0:i.globalAABBBounds;var s=[{x:t,y:n},{x:r,y:n},{x:r,y:a},{x:t,y:a}];for(let t=0;t<s.length;t++)if(function(t,e,i){let r=0,s=t[0];if(!s)return!1;for(let n=1;n<t.length;n++){let a=t[n];r+=E9(s.x,s.y,a.x,a.y,e,i),s=a}let n=t[0];return E8(s.x,n.x)&&E8(s.y,n.y)||(r+=E9(s.x,s.y,n.x,n.y,e,i)),0!==r}(e,s[t].x,s[t].y)||t>0&&function(t,e,i,r,s){for(let n=0,a=s[s.length-1];n<s.length;n++){let l=s[n];if(pH([t,e],[i,r],[l.x,l.y],[a.x,a.y]))return!0;a=l}return!1}(s[t-1].x,s[t-1].y,s[t].x,s[t].y,e))return!0;return!1}return t.intersects(i.globalAABBBounds)}_initItemMap(t,e,i){let{markTypeFilter:r=[]}=this._spec;Object.entries(t).forEach(([t,s])=>{s.forEach(t=>{if(r.includes(t.type))return;let s=t.getGraphics();s&&s.length&&s.forEach(r=>{let s=t.id+"_"+r.context.key;r.removeState("inBrush"),r.removeState("outOfBrush"),i&&r.addState(i,!0),e[s]=r})})})}_initMarkBrushState(t,e){this._brushComponents.forEach((e,i)=>{i!==t&&e.children[0].removeAllChild()}),this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._initItemMap(this._itemMap,this._outOfBrushElementsMap,e),this._initItemMap(this._linkedItemMap,this._linkedOutOfBrushElementsMap,e)}_setRegionMarkPickable(t,e){t.getGroupMark().getGraphics().forEach(t=>t.setAttribute("childrenPickable",e))}_stateClamp(t){return Math.min(Math.max(0,t),1)}_setAxisAndDataZoom(t,e){var i;if(this._zoomRecord=[],this._spec.zoomAfterBrush){let r=t.AABBBounds;null==(i=this._regionAxisMap["region_"+e.id])||i.forEach(t=>{var i,s;let n="bottom"===t.layoutOrient||"top"===t.layoutOrient,a=null!=(i=this._spec.axisRangeExpand)?i:0,{x1:l,x2:o,y1:h,y2:u}=r,d=n?"x":"y",c=n?l:h,p=n?o:u;if(this._axisDataZoomMap[t.id]){let i=this._axisDataZoomMap[t.id],r=i.relatedAxisComponent,s=r.getScale().invert(c-e.getLayoutStartPoint()[d]),n=r.getScale().invert(p-e.getLayoutStartPoint()[d]),l=i.dataToStatePoint(s),o=i.dataToStatePoint(n),h=this._stateClamp(l-a),u=this._stateClamp(o+a);i.setStartAndEnd(Math.min(h,u),Math.max(h,u),["percent","percent"]),this._zoomRecord.push({operateComponent:i,start:h,end:u,startValue:i.statePointToData(h),endValue:i.statePointToData(u)})}else{let i=t.getScale().range(),r=null!=(s=t.scaleRangeFactor())?s:[0,1],n=eh(i)<i[0],l=c-e.getLayoutStartPoint()[d],o=p-e.getLayoutStartPoint()[d],h=n?Math.min(l,o):Math.max(l,o),u=n?Math.max(l,o):Math.min(l,o),g=(u-i[0])/(eh(i)-i[0])*(r[1]-r[0])+r[0],f=(h-i[0])/(eh(i)-i[0])*(r[1]-r[0])+r[0],m=this._stateClamp(g-a),y=this._stateClamp(f+a);t.scaleRangeFactor([m,y]),t.effect.scaleUpdate(),this._zoomRecord.push({operateComponent:t,start:m,end:y,startValue:t.getScale().invert(u),endValue:t.getScale().invert(h)})}})}}_getNeedClearVRenderComponents(){return this._brushComponents}clearGraphic(){this._brushComponents&&this._brushComponents.forEach(t=>{t._container.incrementalClearChild()})}clear(){if(this._brushComponents){let t=this.getContainer();this._brushComponents.forEach((e,i)=>{this._initMarkBrushState(i,""),e.removeAllChild(),e.releaseBrushEvents(),t&&t.removeChild(e)}),this._brushComponents=null}}}Bt.type=rA.brush,Bt.builtInTheme={brush:{style:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",lineWidth:2},brushMode:"single",brushType:"rect",brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:0}},Bt.specKey="brush";let Be=()=>{ig.registerComponent(Bt.type,Bt)};class Bi extends gO{constructor(){super(...arguments),this.type=rA.customMark,this.specKey="customMark",this.layoutType="none",this.layoutZIndex=z.CustomMark,this.layoutLevel=j.CustomMark}created(){super.created(),this.initMarks(),this.initEvent()}getMarkAttributeContext(){return this._markAttributeContext}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(t,e)=>{var i;return null==(i=this._option.globalScale.getScale(t))?void 0:i.scale(e)}}}initMarks(){if(!this._spec)return;let t=null;if(this._spec.parent){let e=this.getChart().getAllMarks().find(t=>t.getUserId()===this._spec.parent);"group"===e.type&&(t=e)}this._createExtensionMark(this._spec,t,`${s6}_series_${this.id}_extensionMark`,0)}_createExtensionMark(t,e,i,r=0){var s,n;let a=this._createMark({type:t.type,name:t5(t.name)?`${t.name}`:`${i}_${r}`},{skipBeforeLayouted:!0,attributeContext:this._getMarkAttributeContext(),componentType:t.componentType,key:t.dataKey});if(a){if(t5(t.id)&&a.setUserId(t.id),(null==(s=this._option.globalInstance)?void 0:s.isAnimationEnable())&&t.animation){let e=cv({},cb(t.type,t,this._markAttributeContext));a.setAnimationConfig(e)}if(et(e)?this._marks.addMark(a):e&&e.addMark(a),this.initMarkStyleWithSpec(a,t),"group"===t.type&&(i=`${i}_${r}`,null==(n=t.children)||n.forEach((t,e)=>{this._createExtensionMark(t,a,i,e)})),t5(t.dataId)||ee(t.dataIndex)){let e=this.getChart().getSeriesData(t.dataId,t.dataIndex);e&&(e.target.addListener("change",()=>{a.getData().updateData()}),a.setDataView(e))}}}initEvent(){}_compareSpec(t,e){let i=super._compareSpec(t,e);return t1(e,t)||(i.reMake=!0),i.change=!0,i.reRender=!0,i}_getMarkAttributeContext(){return{vchart:this._option.globalInstance,chart:this.getChart(),globalScale:(t,e)=>{var i;return null==(i=this._option.globalScale.getScale(t))?void 0:i.scale(e)},getLayoutBounds:()=>{let{x:t,y:e}=this.getLayoutStartPoint(),{width:i,height:r}=this.getLayoutRect();return(new pV).set(t,e,t+i,e+r)}}}_getLayoutRect(){let t=new pV;return this.getMarks().forEach(e=>{let i=e.getProduct();i&&t.union(i.AABBBounds)}),t.empty()?{width:0,height:0}:{width:t.width(),height:t.height()}}getBoundsInRect(t){this.setLayoutRect(t);let e=this._getLayoutRect(),{x:i,y:r}=this.getLayoutStartPoint();return{x1:i,y1:r,x2:i+e.width,y2:r+e.height}}getVRenderComponents(){let t=[],e=i=>{var r;if(i&&"group"===i.type)i.getMarks().forEach(t=>{e(t)});else if("component"===i.type){let e=null==(r=null==i?void 0:i.getProduct())?void 0:r.getGroupGraphicItem();e&&t.push(e)}};return this.getMarks().forEach(t=>{e(t)}),t}}Bi.type=rA.customMark,Bi.specKey="customMark";let Br=()=>{ig.registerComponent(Bi.type,Bi)};class Bs{constructor(t,e){this._chartLayoutRect={x:0,y:0,width:1,height:1},this._col=1,this._row=1,this._elementMap=new Map,this.standardizationSpec(t),this._gridInfo=t,this._col=t.col,this._row=t.row,this._colSize=Array(this._col).fill(null),this._rowSize=Array(this._row).fill(null),this._colElements=Array(this._col).fill([]),this._rowElements=Array(this._row).fill([]),this._onError=null==e?void 0:e.onError,this.initUserSetting()}standardizationSpec(t){var e,i,r;t.col=null!=(e=t.col)?e:1,t.row=null!=(i=t.row)?i:1,t.elements=null!=(r=t.elements)?r:[]}initUserSetting(){this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((t,e)=>{t||(this._colSize[e]={value:0,isUserSetting:!1,isLayoutSetting:!1})}),this._rowSize.forEach((t,e)=>{t||(this._rowSize[e]={value:0,isUserSetting:!1,isLayoutSetting:!1})})}setSizeFromUserSetting(t,e,i,r){t.forEach(t=>{t.index<0&&t.index>=i||(ee(t.size)?e[t.index]={value:+t.size,isUserSetting:!0,isLayoutSetting:!1}:tK(t.size)&&(e[t.index]={value:t.size(r),isUserSetting:!0,isLayoutSetting:!1}))})}clearLayoutSize(){this._colSize.forEach(t=>{t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)}),this._rowSize.forEach(t=>{t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)})}getItemGridInfo(t){var e;let i,r=this._elementMap.get(t);return r||((i=null==(e=this._gridInfo.elements)?void 0:e.find(e=>{var i;if("modelId"in e&&t5(e.modelId)){if(t5(t.model.userId)&&t.model.userId===e.modelId)return!0}else if("modelKey"in e&&t5(e.modelKey)&&"modelIndex"in e&&t5(e.modelIndex)&&(null!=(i=t.model.specKey)?i:t.model.type)===e.modelKey&&t.model.getSpecIndex()===e.modelIndex)return!0;return!1}))||(i={col:0,colSpan:1,row:0,rowSpan:1}),this._elementMap.set(t,i),i)}getSizeFromGrid(t,e){var i;let r="col"===e?this._colSize:this._rowSize,s=0;for(let n=t[e];n<t[e]+(null!=(i=t[`${e}Span`])?i:1);n++)s+=r[n].value;return s}getSizeFromUser(t,e){var i,r;let s="col"===e?this._colSize:this._rowSize;if(!(null==(i=s[t[e]])?void 0:i.isUserSetting))return;let n=0;for(let i=t[e];i<t[e]+(null!=(r=t[`${e}Span`])?r:1);i++){if(!s[i].isUserSetting)return;n+=s[i].value}return n}setItemLayoutSizeToGrid(t,e){if(Bn(t))e.colSpan&&e.colSpan>1||this._colSize[e.col].isUserSetting||(this._colSize[e.col].value=Math.max(this._colSize[e.col].value,t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight),this._colSize[e.col].isLayoutSetting=!0);else{if(e.rowSpan&&e.rowSpan>1||this._rowSize[e.row].isUserSetting)return;this._rowSize[e.row].value=Math.max(this._rowSize[e.row].value,t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom),this._rowSize[e.row].isLayoutSetting=!0}}layoutGrid(t){let e="col"===t?this._colSize:this._rowSize,i="col"===t?this._chartLayoutRect.width:this._chartLayoutRect.height,r=[];e.forEach(t=>{t.isUserSetting||t.isLayoutSetting?i-=t.value:r.push(t)}),i<0&&console.warn(`layout content ${t} size bigger than chart`),r.forEach(t=>t.value=i/r.length)}getItemPosition(t){let e=this.getItemGridInfo(t),i={x:this._chartLayoutRect.x,y:this._chartLayoutRect.y};for(let t=0;t<e.col;t++)i.x+=this._colSize[t].value;for(let t=0;t<e.row;t++)i.y+=this._rowSize[t].value;return i.x+=t.layoutPaddingLeft+t.layoutOffsetX,i.y+=t.layoutPaddingTop+t.layoutOffsetY,i}getItemLayoutRect(t){var e,i;let r=this.getItemGridInfo(t);return{width:(null!=(e=this.getSizeFromGrid(r,"col"))?e:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!=(i=this.getSizeFromGrid(r,"row"))?i:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom}}layoutItems(t,e,i,r){this._chartLayoutRect=i,this._chartViewBox=r,this.clearLayoutSize(),e.sort((t,e)=>e.layoutLevel-t.layoutLevel);let s=e.filter(t=>"normal"===t.layoutType&&!1!==t.getModelVisible()),n=s.filter(t=>Bn(t)),a=s.filter(t=>!Bn(t));s.forEach(t=>{this.layoutOneItem(t,"user",!1)});let l=e.filter(t=>"region-relative"===t.layoutType),o=l.filter(t=>Bn(t)),h=l.filter(t=>!Bn(t));o.forEach(t=>this.layoutOneItem(t,"user",!1)),this.layoutGrid("col"),a.forEach(t=>this.layoutOneItem(t,"colGrid",!1)),h.forEach(t=>{this.layoutOneItem(t,"colGrid",!1)}),this.layoutGrid("row"),h.forEach(t=>{this.layoutOneItem(t,"grid",!1)}),n.forEach(t=>this.layoutOneItem(t,"grid",!1)),o.forEach(t=>{this.layoutOneItem(t,"grid",!0)}),this.layoutGrid("col"),e.filter(t=>"region"===t.layoutType).forEach(t=>this.layoutOneItem(t,"grid",!1)),this.layoutAbsoluteItems(e.filter(t=>"absolute"===t.layoutType)),e.filter(t=>"absolute"!==t.layoutType).forEach(t=>{t.setLayoutStartPosition(this.getItemPosition(t))})}layoutAbsoluteItems(t){t.forEach(t=>{t.absoluteLayoutInRect(this._chartLayoutRect)})}layoutOneItem(t,e,i){var r,s;let n="rowGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),a="colGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),l=this.getItemGridInfo(t),o={width:(null!=(r=a(l,"col"))?r:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!=(s=n(l,"row"))?s:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom},h=t.computeBoundsInRect(o);ee(h.width)||(h.width=o.width),ee(h.height)||(h.height=o.height),t.setLayoutRect("grid"!==e?h:o),this.setItemLayoutSizeToGrid(t,l)}}function Bn(t){return"left"===t.layoutOrient||"right"===t.layoutOrient}Bs.type="grid";let Ba=()=>{ig.registerLayout(Bs.type,Bs)};var Bl=i(89959);let Bo=()=>{(0,Bl.C)()},Bh="vchart-tooltip",Bu=`${Bh}-container`,Bd=`${Bh}-title`,Bc=`${Bh}-content-box`,Bp={offsetX:10,offsetY:10},Bg="99999999999999";function Bf(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\(/g,"&#40;").replace(/  /g," &nbsp;")}let Bm=(t,e)=>t?(e||(e=t.getBoundingClientRect()),t.offsetWidth>0?e.width/t.offsetWidth:t.offsetHeight>0?e.height/t.offsetHeight:1):1,By=t=>t3(t)&&""!==(null==t?void 0:t.trim())||tH(t)?Bf(t):"",B_=(t,e)=>{let i;if(t5(t)){if(tH(t))i=t;else if(tK(t)){let r=t(e);tH(r)&&(i=r)}}return i},Bv={left:[-2,0],right:[2,0],top:[0,-2],bottom:[0,2],insideTop:[0,-1.5],insideBottom:[0,1.5],insideLeft:[-1.5,0],insideRight:[1.5,0],insideTopLeft:[-1.5,-1.5],insideTopRight:[1.5,-1.5],insideBottomLeft:[-1.5,1.5],insideBottomRight:[1.5,1.5],lt:[-2,-2],tl:[-2,-2],rt:[2,-2],tr:[2,-2],bl:[-2,2],lb:[-2,2],br:[2,2],rb:[2,2],inside:[0,0],center:[0,0],centerBottom:[0,1],centerTop:[0,-1],centerLeft:[-1,0],centerRight:[1,0]},Bb=(t,e,i=2)=>{var r,s;return null!=(s=null==(r=Bv[t])?void 0:r[+("x"!==e)])?s:i},Bx=t=>ey(t)&&(t5(t.left)||t5(t.right)||t5(t.top)||t5(t.bottom)),BS=t=>ey(t)&&(t5(t.x)||t5(t.y));class Bk extends p8{constructor(){super(...arguments),this._visible=!0,this._isReleased=!1,this.showTooltip=(t,e,i)=>{let{changePositionOnly:r}=i;return r?this.changeTooltipPosition(i,e):this.changeTooltip(!0,i,e)},this.changeTooltip=(t,e,i)=>this._isReleased?1:t?this.changeTooltipPosition(e,i):(this._updateTooltip(!1,e),0),this.changeTooltipPosition=(t,e)=>{var i,r,s,n,a;if(this._isReleased)return 1;let l=t.event,{tooltipSpec:o,activeTooltipSpec:h,changePositionOnly:u}=t;if(!h)return 1;let d=h.activeType;if(h.handler)return null!=(s=null==(r=(i=h.handler).showTooltip)?void 0:r.call(i,d,e,t))?s:0;let c=this._getActualTooltipPosition(h,t,this._getTooltipBoxSize(h,u));h.position=c;let p=null!=(n=h.updatePosition)?n:null==(a=o[d])?void 0:a.updatePosition;p&&(h.position=p(h.position,e,t));let g=!1!==(null==h?void 0:h.visible);return e&&"pointerout"!==l.type&&h.visible&&(h.title||h.content)||(g=!1),this._updateTooltip(g,Object.assign(Object.assign({},t),{changePositionOnly:u})),0},this._getActualTooltipPosition=(t,e,i)=>{var r,s,n,a,l,o,h,u,d;let c=this._chartOption.getRectByDimensionData,{tooltipSpec:p}=e,g={x:1/0,y:1/0};if(!p)return g;let f=e.event,{activeType:m,data:y}=t,_="dimension"===m?null==(s=null==(r=y[0])?void 0:r.data)?void 0:s[0]:null==y?void 0:y[0],{offsetX:v,offsetY:b}=this._option,x=p[m],S=d2(null==x?void 0:x.position,y,e),k=null!=(n=d2(null==x?void 0:x.positionMode,y,e))?n:"mark"===m?"mark":"pointer",{width:A=0,height:M=0}=null!=i?i:{},w="canvas"===p.renderMode,T=null==(a=null==e?void 0:e.chart)?void 0:a.getCanvasRect(),C=null!=(l=null==T?void 0:T.width)?l:s9,E=null!=(o=null==T?void 0:T.height)?o:s8,B=!1,P={width:0,height:0},O,I={x:0,y:0},R={x:0,y:0},L=1,D=1,F=eE(this._env);if(F&&!p.confine?(P.width=window.innerWidth,P.height=window.innerHeight):(P.width=C,P.height=E),F&&!w){let t=this._getParentElement(p);R=null!=(u=null==(h=null==t?void 0:t.getBoundingClientRect)?void 0:h.call(t))?u:g;let e=null!=(d=this._compiler.getCanvas())?d:this._chartContainer;I={x:(O=null==e?void 0:e.getBoundingClientRect()).x-R.x,y:O.y-R.y},L=Bm(e,O),D=Bm(t,R)}let z=D/L,j={},H={x:S,y:S},N={x:["left","right"],y:["top","bottom"]},V=({orient:t,mode:i,offset:r},s)=>{var n;let a,l,o=e.model,h=null==o?void 0:o.getLayoutStartPoint(),u=null!=r?r:"x"===s?v:b;if("mark"===i){B=!0;let t=e.item,i=null==t?void 0:t.AABBBounds;i&&h&&(a=("x"===s?i.x1:i.y1)+h[s],l=("x"===s?i.x2:i.y2)+h[s])}else if(c&&"crosshair"===i&&"cartesian"===(null==(n=null==_?void 0:_.series)?void 0:n.coordinate)&&_.datum&&_.datum.length){B=!0;let t=c(_,h);t&&(a=t.start[s],l=t.end[s])}else H[s]=t;if(B){let e=N[s][0],i="x"===s?A:M;switch(Bb(t,s)){case -2:j[e]=a-i*z-u;break;case -1.5:j[e]=a+u;break;case 0:j[e]=(a+l)/2-i*z/2;break;case -1:j[e]=(a+l)/2-i*z-u;break;case 1:j[e]=(a+l)/2+u;break;case 1.5:j[e]=l-i*z-u;break;case 2:j[e]=l+u}}},W=["x","y"];if(ey(S))if(Bx(S)){let{left:t,right:e,top:i,bottom:r}=S;j.left=B_(t,f),j.top=B_(i,f),j.right=B_(e,f),j.bottom=B_(r,f)}else BS(S)&&W.forEach(t=>{let e=S[t];tH(e)||tK(e)?j[N[t][0]]=B_(e,f):V(e,t)});else t5(S)&&(V({orient:S,mode:k},"x"),V({orient:S,mode:k},"y"));let U={x:null,y:null};return W.forEach(t=>{var e;let i="x"===t?A:M,r="x"===t?C:E,s="x"===t?v:b,n=Bb(H[t],t);if(ee(j[N[t][0]]))U[t]=j[N[t][0]];else if(ee(j[N[t][1]]))U[t]=r-i*z-j[N[t][1]];else{let e="x"===t?f.canvasX:f.canvasY;U[t]=n>0?e+s:0===n?e-i*z/2:e-i*z-s}U[t]*=L,F&&(U[t]+=I[t]),U[t]/=D;let a="x"===t?P.width:P.height,l=p.confine?-(R[t]-(null!=(e=null==O?void 0:O[t])?e:0)/L)/D:-R[t]/D,o=a/D+l-i;2!==n&&U[t]<l?B?U[t]=l:(U[t]+=0===n?s+i/2:2*s+i,U[t]>o&&(U[t]=o)):-2!==n&&U[t]>o&&(B?U[t]=o:(U[t]-=0===n?s+i/2:2*s+i,U[t]<l&&(U[t]=l)))}),U}}get env(){return this._env}onAdd(t){super.onAdd(t);let e=t.component;this._component=e,this._chartOption=e.getOption(),this._env=this._chartOption.mode,this._chartContainer=this._chartOption.globalInstance.getContainer(),this._compiler=e.getCompiler(),this._initFromSpec()}hideTooltip(t){return this.changeTooltip(!1,t)}release(){var t,e,i,r;let s=null!=(e=null==(t=this._component)?void 0:t.getSpec())?e:{};s.handler?null==(r=(i=s.handler).release)||r.call(i):(this._removeTooltip(),this._isReleased=!0,this._chartOption=null,this._component=null)}_getDefaultOption(){var t,e;let{offset:i}=this._component.getSpec();return i?{offsetX:null!=(t=i.x)?t:Bp.offsetX,offsetY:null!=(e=i.y)?e:Bp.offsetY}:Bp}_getParentElement(t){return t.parentElement}getTooltipContainer(){return this._container}_initFromSpec(){this._option=this._getDefaultOption()}reInit(){this._initFromSpec()}}Bk.specKey="tooltip";let BA=(t,e)=>t5(t)?tY(t)?t.map(t=>`${t}px`).join(" "):`${t}px`:null!=e?e:"initial",BM=(t={},e={})=>{var i,r;t5(t.fontFamily)&&(e.fontFamily=t.fontFamily);let s=null!=(i=t.fill)?i:t.fontColor;return t5(s)&&(e.color=s),t5(t.fontWeight)&&(e.fontWeight=t.fontWeight),t5(t.textAlign)&&(e.textAlign=t.textAlign),t5(t.fontSize)&&(e.fontSize=BA(t.fontSize)),t5(t.maxWidth)&&(e.maxWidth=BA(t.maxWidth)),t.multiLine||t5(t.maxWidth)&&!1!==t.multiLine?(e.whiteSpace="initial",e.wordBreak=null!=(r=t.wordBreak)?r:"break-word"):(e.wordBreak="normal",e.whiteSpace="nowrap"),e},Bw=(t={})=>{let{lineHeight:e}=t;return t.fontSize?ex(e,t.fontSize):0},BT=(t={})=>{var e,i,r,s;let{style:n={},enterable:a,transitionDuration:l}=t,{panel:o={},titleLabel:h,shape:u,keyLabel:d,valueLabel:c,spaceRow:p,align:g}=n,{panelStyle:f,panelPadding:m}=BC(o),y={marginTop:"0px",marginBottom:"0px"};f.pointerEvents=a?"auto":"none",l&&(f.transitionDuration=l?`${l}ms`:"initial",f.transitionProperty=l?"transform":"initial",f.transitionTimingFunction=l?"ease-out":"initial"),ee(p)&&(y.marginBottom=`${p}px`);let _={width:BA(null!=(e=null==u?void 0:u.size)?e:8)},v=BM(h),b=BM(d),x=BM(c),S="right"===g?"marginLeft":"marginRight";"right"===g&&(f.direction="rtl"),et(v.textAlign)&&(v.textAlign="right"===g?"right":"left"),et(b.textAlign)&&(b.textAlign="right"===g?"right":"left"),et(x.textAlign)&&(x.textAlign="right"===g?"left":"right"),_[S]=BA(null!=(i=u.spacing)?i:8),b[S]=BA(null!=(r=d.spacing)?r:26),x[S]=BA(null!=(s=c.spacing)?s:0);let k=Math.max(Bw(c),Bw(d));return y.lineHeight=k>0?`${k}px`:"20px",{panelPadding:m,row:y,panel:f,title:v,shape:_,key:b,value:x}},BC=t=>{var e;let{backgroundColor:i,border:r,shadow:s,padding:n}=t,a={borderWidth:`${null!=(e=null==r?void 0:r.width)?e:0}px`},l=null;(null==r?void 0:r.color)&&(a.borderColor=r.color),i&&(a.backgroundColor=i),a.boxShadow=s?`${s.x}px ${s.y}px ${s.blur}px ${s.spread}px ${s.color}`:"initial";let{radius:o}=null!=r?r:{};return t5(o)&&(a.borderRadius=ee(o)?`${o}px`:`${o}`),n&&(a.padding=BA(l=MY(n))),{panelStyle:a,panelPadding:l}};function BE(t,e){t&&t.style&&e&&Object.keys(e).forEach(i=>{t.style[i]=e[i]})}let BB=t=>{ig.registerComponentPlugin(t.type,t)};class BP extends Bk{getVisibility(){return!!this._rootDom&&"visible"===this._rootDom.style.visibility}setVisibility(t){t!==this.getVisibility()&&this._rootDom&&(this._rootDom.style.visibility=t?"visible":"hidden")}getRootDom(){return this._rootDom}constructor(){super(BP.type),this.type=mo.dom,this._tooltipContainer=null==eC?void 0:eC.body}onAdd(t){super.onAdd(t),this._initStyle(),this.initEl()}initEl(){let t=this._component.getSpec().parentElement;if(eC&&t&&t.children&&t.children.length){for(let e=0;e<t.children.length;e++)if(t.children[e].classList.contains(Bu)){this._container=t.children[e];break}this._container||(this._container=eC.createElement("div"),this._container.style.position="relative",this._container.style.zIndex=Bg,this._container.classList.add(Bu),t.appendChild(this._container))}}initRootDom(){var t;let e=this._component.getSpec(),i=document.createElement("div"),r=null==(t=this._chartOption)?void 0:t.getTheme("fontFamily");BE(i,Object.assign({left:"0",top:"0",pointerEvents:"none",padding:"12px",position:"absolute",zIndex:Bg,fontFamily:null!=r?r:eF.fontFamily,fontSize:"11px",borderRadius:"3px",borderStyle:"solid",lineHeight:"initial",background:"#fff",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)",maxWidth:"100wh",maxHeight:"100vh",visibility:"hidden"},this._domStyle.panel)),i.classList.add(e.className),i.setAttribute("vchart-tooltip-id",`${this.id}`),this._container.appendChild(i),this._rootDom=i}_getTooltipBoxSize(t,e){var i;this._rootDom||this.initRootDom(),e||this._updateDomStringByCol(t),this._updateDomStyle("height",e);let r=null==(i=this._rootDom)?void 0:i.getBoundingClientRect();return{width:null==r?void 0:r.width,height:null==r?void 0:r.height}}_removeTooltip(){this._rootDom&&this._rootDom.parentNode&&(this._rootDom.parentNode.removeChild(this._rootDom),this._rootDom=null),this._container=null}_updateTooltip(t,e){var i,r,s;if(t&&this._rootDom){let{tooltipSpec:n,activeTooltipSpec:a}=e;e.changePositionOnly||(this._tooltipActual=a);let l=this.getVisibility(),o=this._rootDom;if(o){let{x:t=0,y:h=0}=null!=(i=a.position)?i:{};if(n.updateElement){this._updatePosition(null!=(r=this._cacheCustomTooltipPosition)?r:{x:t,y:h}),n.updateElement(o,a,e);let i=this._getActualTooltipPosition(a,e,{width:o.offsetWidth,height:o.offsetHeight});this._updatePosition(i),this._cacheCustomTooltipPosition=i}else this._rootDom.style.transitionDuration=l?null!=(s=this._domStyle.panel.transitionDuration)?s:"initial":"0ms",this._updatePosition({x:t,y:h})}this.setVisibility(t)}else this.setVisibility(t),this._cacheCustomTooltipPosition=void 0}_initStyle(){let t=this._component.getSpec();this._domStyle=BT(t)}_updateDomStringByCol(t){var e;let{title:i={},content:r}=t,s=r&&r.length,n=this._domStyle.row,a=[...this._rootDom.children],l=a.find(t=>t.className.includes(Bd)),o=a.find(t=>t.className.includes(Bc));if(!l&&!1!==i.visible){l=document.createElement("h2");let t=document.createElement("span");l.appendChild(t),l.classList.add(Bd),this._rootDom.firstChild?this._rootDom.insertBefore(l,this._rootDom.firstChild):this._rootDom.appendChild(l)}l&&!1!==i.visible?(BE(l,Object.assign(Object.assign(Object.assign({},this._domStyle.title),s?n:{marginBottom:"0px"}),{marginTop:"0px"})),l.firstChild.innerHTML=`${null!=(e=i.value)?e:""}`):l&&!1===i.visible&&l.parentNode.removeChild(l);let h=["shape","key","value"];if(!o&&s&&(o=document.createElement("div"),h.forEach(t=>{let e=document.createElement("div");e.classList.add(`${Bh}-column`),e.classList.add(`${Bh}-${t}-column`),e.setAttribute("data-col",t),o.appendChild(e)}),o.classList.add(Bc),this._rootDom.appendChild(o)),o&&s){let t=[...o.children];BE(o,{whiteSpace:"nowrap"}),t.forEach((t,e)=>{let i=t.getAttribute("data-col");if(i&&h.includes(i)){let e="shape"===i&&r.every(t=>!t.hasShape||!t.shapeType);BE(t,Object.assign(Object.assign({},this._domStyle[i]),{display:e?"none":"inline-block",verticalAlign:"top"}));let s=[...t.children];s.slice(r.length).forEach(t=>{t.parentNode.removeChild(t)}),r.forEach((e,a)=>{let l=s[a];l||((l=document.createElement("div")).classList.add(`${Bh}-${i}`),t.appendChild(l));let o=Object.assign({},n);a===r.length-1&&(o.marginBottom="0px"),o.display=!1===e.visible?"none":"block",o.height="initial","key"===i?(l.innerHTML=By(e.key),e.keyStyle&&BM(e.keyStyle,o)):"value"===i?(l.innerHTML=By(e.value),e.valueStyle&&BM(e.valueStyle,o)):"shape"===i&&(l.innerHTML=function(t,e){var i,r,s,n,a,l;let o,h;if(!t||!t.hasShape||!t.shapeType)return"";let u='style="display:inline-block;vertical-align:middle;"',{shapeType:d,shapeFill:c,shapeStroke:p,shapeHollow:g=!1}=t,f=null!=(i=t.shapeSize)?i:8,m=t.shapeLineWidth?Bf(t.shapeLineWidth)+"px":"0px",y="currentColor",_=()=>p?Bf(p):y,v=t=>new pR.m({symbolType:t,size:f,fill:!0}),b=v(d),x=b.getParsedPath();if(!x.path&&x.pathStr&&(b=v(x.pathStr)),b.getParsedPath().path){let t=b.getParsedPath().path;h=t.toString(),o=t.bounds}else x.isSvg&&x.svgCache&&(h=x.svgCache.map(t=>t.path.toString()).join(),o=x.svgCache.reduce((t,e)=>t.union(e.path.bounds),new pV));let S=`${o.x1} ${o.y1} ${o.width()} ${o.height()}`;if("0px"!==m){let[t,e,i,r]=S.split(" ").map(t=>Number(t)),s=Number(m.slice(0,-2));S=`${t-s/2} ${e-s/2} ${i+s} ${r+s}`}if(!c||t3(c)||g)return y=g?"none":c?Bf(c):"currentColor",`
    <svg ${u} width="${f}" height="${f}" viewBox="${S}">
      <path
        d="${h}"
        style="fill: ${y}; stroke: ${_()}; stroke-width: ${m}"
      >
      </path>
    </svg>`;if(ey(c)){y="gradientColor"+(null!=e?e:"");let t="",i=(null!=(r=c.stops)?r:[]).map(t=>`<stop offset="${Bf(t.offset.toString())}" stop-color="${Bf(t.color)}"/>`).join("");return"radial"===c.gradient?t=`<radialGradient id="${y}" cx="50%" cy="50%" r="50%" fx="0%" fy="0%">
      ${i}
      </radialGradient>`:"linear"===c.gradient&&(t=`<linearGradient id="${y}" x1="${100*(null!=(s=c.x0)?s:0)}%" y1="${100*(null!=(n=c.y0)?n:0)}%" x2="${100*(null!=(a=c.x1)?a:0)}%" y2="${100*(null!=(l=c.y1)?l:0)}%">
      ${i}
      </linearGradient>`),`
    <svg ${u} width="${f}" height="${f}" viewBox="-0.5 -0.5 1 1">
      ${t}
      <path
        d="${h}"
        style="fill: url(#${y}); stroke: ${_()}; stroke-width: ${m}"
      >
      </path>
    </svg>`}return""}(e,`${this.id}_${a}`)),BE(l,o)})}})}else o&&!s&&o.parentNode.removeChild(o)}_updateDomStyle(t="width",e){var i,r,s,n,a;let l=this._rootDom,o=[...l.children].find(t=>t.className.includes(Bc)),h=[...l.children].find(t=>t.className.includes(Bd));if(o){let l=this._component.getSpec(),u={},d=null==(i=l.style)?void 0:i.titleLabel;if(d&&d.autoWidth&&!1!==d.multiLine&&h){let e=[...o.children].reduce((e,i)=>"height"===t?e+i.getBoundingClientRect().width:Math.max(e,i.getBoundingClientRect().width),0);e>0&&(h.style.maxWidth=`${e}px`,h.style.maxWidth=`${Math.ceil(o.getBoundingClientRect().width)}px`)}if(t5(null==(r=null==l?void 0:l.style)?void 0:r.maxContentHeight)){let t=h&&h.className.includes(Bd)?h.getBoundingClientRect().height+(null!=(s=l.style.spaceRow)?s:0):0,e=this._chartOption.getChartViewRect(),i=ex(l.style.maxContentHeight,Math.min(e.height,document.body.clientHeight)-t-(this._domStyle.panelPadding?this._domStyle.panelPadding[0]+this._domStyle.panelPadding[1]:0));i>0&&(u.maxHeight=`${i}px`,u.overflowY="auto",u.width=`calc(100% + ${this._domStyle.panelPadding?this._domStyle.panelPadding[1]+"px":"10px"})`,BE(o,u))}let c=o.children,p=[];if(c){for(let i=0;i<c.length;i++){let r=null!=(n=c[i].children)?n:[];for(let i=0;i<r.length;i++){e&&(r[i].style[t]="initial");let s=r[i].getBoundingClientRect()[t];(void 0===p[i]||p[i]<s)&&(p[i]=s)}}for(let e=0;e<c.length;e++){let i=null!=(a=c[e].children)?a:[];for(let e=0;e<i.length;e++)i[e].style[t]=`${p[e]}px`}}}}_getParentElement(t){var e;return null!=(e=this._container)?e:super._getParentElement(t)}isTooltipShown(){return this.getVisibility()}reInit(){super.reInit(),this._initStyle(),this._rootDom&&BE(this._rootDom,this._domStyle.panel),this.getVisibility()&&(this._updateDomStringByCol(this._tooltipActual),this._updateDomStyle("height",!1))}_updatePosition({x:t,y:e}){this._rootDom&&(this._rootDom.style.transform=`translate3d(${t}px, ${e}px, 0)`)}}BP.type=mo.dom;let BO=()=>{BB(BP)};var BI=i(26635),BR=i(11681);let BL=(t,...e)=>{let i=[t.shape,...e.map(t=>null==t?void 0:t.shape)],r=[t.key,...e.map(t=>null==t?void 0:t.key)],s=[t.value,...e.map(t=>null==t?void 0:t.value)];return(0,cZ.Z)(t,...e,{shape:i.every(lU.Z)?void 0:(0,cZ.Z)({},...i),key:r.every(lU.Z)?void 0:(0,cZ.Z)({},...r),value:s.every(lU.Z)?void 0:(0,cZ.Z)({},...s)})},BD=t=>{let{width:e,height:i,wordBreak:r="break-word",textAlign:s,textBaseline:n,text:a}=t;return Array.isArray(a)?{width:e,height:i,wordBreak:r,textAlign:s,textBaseline:n,singleLine:!1,textConfig:(0,Tm.IX)(a).map(e=>Object.assign(Object.assign({},t),{text:e}))}:{width:e,height:i,wordBreak:r,textAlign:s,textBaseline:n,singleLine:!1,textConfig:null==a?void 0:a.text}},BF={panel:{visible:!0,cornerRadius:[3,3,3,3],fill:"white",shadow:!0,shadowBlur:12,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:4,shadowSpread:0,stroke:"white"},titleStyle:{value:{fill:"#4E5969",fontFamily:c5.iR,fontSize:14,lineHeight:18,textAlign:"left",textBaseline:"middle"},spaceRow:6},contentStyle:{shape:{fill:"black",size:8,symbolType:"circle",spacing:6},key:{fill:"#4E5969",fontFamily:c5.iR,fontSize:12,lineHeight:18,textAlign:"left",textBaseline:"middle",spacing:26},value:{fill:"#4E5969",fontFamily:c5.iR,fontSize:12,lineHeight:18,textAlign:"right",textBaseline:"middle",spacing:0},spaceRow:6},padding:10,positionX:"right",positionY:"bottom",offsetX:10,offsetY:10,parentBounds:(new lC.FB).setValue(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),autoCalculatePosition:!0,autoMeasure:!0,pickable:!1,childrenPickable:!1,zIndex:500},Bz=["pointerX","pointerY","offsetX","offsetY","positionX","positionY","parentBounds"];(0,oo.M)(),(0,mJ.k)(),(0,pL.k)(),(0,pu.g)(),(0,pd.v)();class Bj extends gK.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,cZ.Z)({},Bj.defaultAttributes,t),e),this.name="tooltip"}render(){var t;let{visible:e,content:i,panel:r,keyWidth:s,valueWidth:n,hasContentShape:a,autoCalculatePosition:l,autoMeasure:o,align:h}=this.attribute;if(!e)return void this.hideAll();o&&Bj.measureTooltip(this.attribute),l&&Bj.calculateTooltipPosition(this.attribute);let u=(0,BR.o)(this.attribute.padding);this._tooltipPanel=this.createOrUpdateChild("tooltip-background",Object.assign({visible:!0},r),"rect"),this._tooltipTitleContainer=this.createOrUpdateChild("tooltip-title",{visible:!0,x:u[3],y:u[0]},"group");let d=Bj.getTitleAttr(this.attribute);this._tooltipTitleSymbol=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-shape",(0,cZ.Z)({symbolType:"circle"},d.shape,{visible:(0,c3.pn)(d)&&(0,c3.pn)(d.shape)}),"symbol"),"object"!=typeof d.value.text||null===d.value.text||"rich"!==d.value.text.type&&"html"!==d.value.text.type?d.value.multiLine?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:(0,c3.pn)(d)&&(0,c3.pn)(d.value)},BD(d.value)),"richtext"):this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({text:null!=(t=d.value.text)?t:"",visible:(0,c3.pn)(d)&&(0,c3.pn)(d.value)},d.value),"text"):"rich"===d.value.text.type?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:(0,c3.pn)(d)&&(0,c3.pn)(d.value)},BD(d.value)),"richtext"):"html"===d.value.text.type&&(this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({html:Object.assign(Object.assign({dom:d.value.text.text},c5.Ze),d.value),visible:(0,c3.pn)(d)&&(0,c3.pn)(d.value),width:d.value.width,height:d.value.height,wordBreak:d.value.wordBreak,textAlign:d.value.textAlign,textBaseline:d.value.textBaseline,singleLine:!1,textConfig:[]},d.value),"richtext"));let c=(0,c3.pn)(d.shape)?d.shape.size+d.shape.spacing:0,{textAlign:p,textBaseline:g}=d.value,f=r.width-u[3]-u[0]-c;"center"===p?this._tooltipTitle.setAttribute("x",c+f/2):"right"===p||"end"===p?this._tooltipTitle.setAttribute("x",c+f):this._tooltipTitle.setAttribute("x",c),"bottom"===g?this._tooltipTitle.setAttribute("y",d.height):"middle"===g?this._tooltipTitle.setAttribute("y",d.height/2):this._tooltipTitle.setAttribute("y",0);let m=(0,c3.pn)(d)?d.height+d.spaceRow:0;if(this._tooltipContent=this.createOrUpdateChild("tooltip-content",{visible:!0},"group"),this._tooltipContent.removeAllChild(!0),i&&i.length){this._tooltipContent.setAttribute("x",u[3]),this._tooltipContent.setAttribute("y",u[0]+m);let t=0;i.forEach((e,i)=>{let r=Bj.getContentAttr(this.attribute,i);if(!(0,c3.pn)(r))return;let l=`tooltip-content-${i}`,o=this._tooltipContent.createOrUpdateChild(l,{visible:!0,x:0,y:t},"group"),u=r.shape.size+r.shape.spacing,d="right"===h?(a?u:0)+((0,c3.pn)(r.key)?s+r.key.spacing:0)+((0,c3.pn)(r.value)?n:0):0;this._createShape("right"===h?d-r.shape.size/2:d+r.shape.size/2,r,o,l),a&&("right"===h?d-=u:d+=u);let c=this._createKey(r,o,l);c&&((0,od.He)(h,c,r.key.textAlign,d,s),c.setAttribute("y",0),"right"===h?d-=s+r.key.spacing:d+=s+r.key.spacing);let p=this._createValue(r,o,l);if(p){let t="right";(0,cX.Z)(r.value.textAlign)?t=r.value.textAlign:(0,c3.pn)(r.key)||"right"===h||(t="left"),p.setAttribute("textAlign",t),(0,od.He)(h,p,t,d,n),p.setAttribute("y",0)}t+=r.height+r.spaceRow})}}_createShape(t,e,i,r){var s;if((0,c3.pn)(e.shape))return i.createOrUpdateChild(`${r}-shape`,Object.assign({visible:!0,x:t,y:e.shape.size/2+((null!=(s=(0,he.VA)(e.key.lineHeight,e.key.fontSize))?s:e.key.fontSize)-e.shape.size)/2},e.shape),"symbol")}_createKey(t,e,i){var r;if((0,c3.pn)(t.key))return t.key.multiLine?e.createOrUpdateChild(`${i}-key`,Object.assign(Object.assign({visible:!0},BD(t.key)),{textBaseline:"top"}),"richtext"):"object"!=typeof t.key.text||null===t.key.text||"rich"!==t.key.text.type&&"html"!==t.key.text.type?e.createOrUpdateChild(`${i}-key`,Object.assign(Object.assign({visible:!0,text:null!=(r=t.key.text)?r:""},t.key),{textBaseline:"top"}),"text"):"rich"===t.key.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},BD(t.key)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild(`${i}-value`,{html:Object.assign(Object.assign({dom:t.key.text.text},c5.Ze),t.key)},"richtext")}_createValue(t,e,i){var r;if((0,c3.pn)(t.value))return t.value.multiLine?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},BD(t.value)),{textBaseline:"top"}),"richtext"):"object"!=typeof t.value.text||null===t.value.text||"rich"!==t.value.text.type&&"html"!==t.value.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0,text:null!=(r=t.value.text)?r:""},t.value),{textBaseline:"top"}),"text"):"rich"===t.value.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},BD(t.value)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild(`${i}-value`,{html:Object.assign({dom:t.value.text.text,container:"",width:30,height:30,style:{}},t.value)},"richtext")}setAttributes(t,e){let i=Object.keys(t);this.attribute.autoCalculatePosition&&i.every(t=>Bz.includes(t))?(this._mergeAttributes(t,i),(0,lU.Z)(this.attribute.panel.width)&&this.attribute.autoMeasure&&Bj.measureTooltip(this.attribute),Bj.calculateTooltipPosition(this.attribute),super.setAttributes({x:this.attribute.x,y:this.attribute.y},e)):super.setAttributes(t,e)}static calculateTooltipPosition(t){let{width:e=0,height:i=0}=t.panel,{offsetX:r,offsetY:s,pointerX:n,pointerY:a,positionX:l,positionY:o,parentBounds:h}=t,u=n,d=a;return"left"===l?u-=e+r:"center"===l?u-=e/2:u+=r,"top"===o?d-=i+s:"middle"===o?d-=i/2:d+=s,u+e>h.x2&&(u-=e+r),d+i>h.y2&&(d-=i+s),u<h.x1&&(u=h.x1),d<h.y1&&(d=h.y1),t.x=u,t.y=d,t}static measureTooltip(t){let{content:e,contentStyle:i}=t,r=(0,BR.o)(t.padding),s=Bj.getTitleAttr(t),n=0,a=r[0]+r[2],l=0,{value:o,shape:h}=s,{visible:u=!1,symbolType:d=""}=null!=h?h:{};if((0,cX.Z)(o)&&"object"!=typeof s.value.text){let{width:t,height:e}=(0,od.gM)(o).quickMeasure(o.text);n=t,l=e}if(u&&BI.g6[d]&&(n+=h.size+h.spacing,l=Math.max(h.size,l)),t.title&&(t.title.width=n,t.title.height=l),(0,c3.pn)(s)&&(a+=l+s.spaceRow),e&&e.length){let r=[];if(e.forEach((e,i)=>{let s=Bj.getContentAttr(t,i);(e.key||e.value)&&(0,c3.pn)(s)&&r.push([e,s])}),r.length){let s=!1,l=[],o=[],h=[];r.forEach(([t,e],n)=>{var u;let{key:d,value:c,shape:p,spaceRow:g}=e,f=(0,c3.pn)(p),m=null!=(u=null==p?void 0:p.symbolType)?u:"",y=(0,od.gM)(d),_=(0,od.gM)(c),v=0;if((0,c3.pn)(d)){let{width:t,height:e}=y.quickMeasure(d.text);o.push(t),v=Math.max(v,e)}if((0,c3.pn)(c)){let{width:t,height:e}=_.quickMeasure(c.text);h.push(t),v=Math.max(v,e)}f&&BI.g6[m]&&(s=!0,l.push(p.size),v=Math.max(p.size,v)),t.height=v,a+=v,n<r.length-1&&(a+=null!=g?g:i.spaceRow)});let u=l.length?Math.max(...l):0,d=o.length?Math.max(...o):0,c=h.length?Math.max(...h):0;n=Math.max(d+c+i.key.spacing+i.value.spacing+(s?u+i.shape.spacing:0),n),e.forEach(t=>{t.width=n}),t.hasContentShape=s,t.keyWidth=d,t.valueWidth=c}}return t.panel.width=n+r[1]+r[3],t.panel.height=a,t}static getTitleAttr(t){return BL({},Bj.defaultAttributes.titleStyle,Bj.defaultAttributes.title,t.titleStyle,t.title)}static getContentAttr(t,e){return BL({},Bj.defaultAttributes.contentStyle,t.contentStyle,t.content[e])}}Bj.defaultAttributes=BF;let BH={fontFamily:eF.fontFamily,spacing:10,wordBreak:"break-word"},BN=(t,e)=>{var i;let r,s;"rich"!==(null==t?void 0:t.type)&&"html"!==(null==t?void 0:t.type)?(t=(null!=t?t:"").toString(),s=(r=e.multiLine?(r=t.split("\n")).map((t,e)=>e<r.length-1?t+"\n":t):[t]).map(t=>Object.assign(Object.assign({},e),{text:t}))):(s=t.text,r=t);let n=(0,xu.X)({wordBreak:null!=(i=e.wordBreak)?i:"break-word",maxWidth:e.maxWidth?e.maxWidth:void 0,width:0,height:0,textConfig:s});return{width:n.width(),height:n.height(),text:r}};function BV(t={},e,i){var r,s;return Object.assign(Object.assign({},null!=i?i:BH),{fill:null!=(r=t.fill)?r:t.fontColor,textAlign:t.textAlign,textBaseline:t.textBaseline,fontFamily:null!=(s=t.fontFamily)?s:e,fontSize:t.fontSize,fontWeight:t.fontWeight,lineHeight:t.lineHeight,spacing:t.spacing,multiLine:t5(t.maxWidth)?!1!==t.multiLine:t.multiLine,maxWidth:t.maxWidth,wordBreak:t.wordBreak,autoWidth:t.autoWidth})}let BW=t=>{var e;let{backgroundColor:i,border:r,shadow:s}=t,n={lineWidth:null!=(e=null==r?void 0:r.width)?e:0,shadow:!!s};(null==r?void 0:r.color)&&(n.stroke=r.color),i&&(n.fill=i),s&&(n.shadowColor=s.color,n.shadowBlur=s.blur,n.shadowOffsetX=s.x,n.shadowOffsetY=s.y,n.shadowSpread=s.spread);let{radius:a}=null!=r?r:{};return t5(a)&&(n.cornerRadius=[a,a,a,a]),n},BU=(t,e,i)=>{var r,s,n,a,l;let{style:o={},enterable:h,transitionDuration:u}=e,{panel:d={},titleLabel:c,shape:p,keyLabel:g,valueLabel:f,spaceRow:m,align:y}=o,_=MY(d.padding),v=eA(d.padding),b=BV(Object.assign({textAlign:"right"===y?"right":"left"},c),i),x=BV(Object.assign({textAlign:"right"===y?"right":"left"},g),i),S=BV(f,i),k={fill:!0,size:null!=(r=null==p?void 0:p.size)?r:8,spacing:null!=(s=null==p?void 0:p.spacing)?s:6},A={panel:BW(d),padding:_,title:{},content:[],titleStyle:{value:b,spaceRow:m},contentStyle:{shape:k,key:x,value:S,spaceRow:m},hasContentShape:!1,keyWidth:0,valueWidth:0,enterable:h,transitionDuration:u,align:y},{title:M={},content:w=[]}=t,T=v.left+v.right,C=v.top+v.bottom,E=0,B=!!w.length,P=0,O=0,I=0,R=0;if(B){let t=[],e=[],i=[],r=[],s=0;A.content=w.map((n,a)=>{let l=0,{hasShape:o,key:h,shapeType:u="",shapeFill:d,shapeStroke:c,shapeLineWidth:p,shapeSize:g,value:f,isKeyAdaptive:y,spaceRow:_,keyStyle:v,valueStyle:b,shapeHollow:A}=n,M={height:0,spaceRow:null!=_?_:m};if(t5(h)){let i=it({},x,BV(v,void 0,{})),{width:r,height:s,text:n}=BN(h,i);M.key=Object.assign(Object.assign({width:r,height:s},i),{text:n}),y?e.push(r):t.push(r),l=Math.max(l,s)}if(t5(f)){let t=it({},S,BV(b,void 0,{})),{width:e,height:r,text:s}=BN(f,t);M.value=Object.assign(Object.assign({width:e,height:r},t),{text:s}),i.push(e),l=Math.max(l,r)}if(o){let t={visible:!0,symbolType:u};A?t.stroke=d:t.fill=d,t.stroke=null!=c?c:d,t.lineWidth=p,M.shape=t;let e=null!=g?g:k.size;l=Math.max(e,l),r.push(e)}else M.shape={visible:!1};return M.height=l,s+=l,a<w.length-1&&(s+=M.spaceRow),M}),C+=s,P=t.length?eu(t):0,O=e.length?eu(e):0,I=i.length?eu(i):0,E=Math.max((R=r.length?eu(r)+k.spacing:0)+P+x.spacing+I+S.spacing,R+O,E),A.hasContentShape=!!r.length,A.keyWidth=P,A.valueWidth=I}let L=0,D=0,F=0,{visible:z=!0,value:j="",valueStyle:H,spaceRow:N}=M;A.title.visible=z,A.title.spaceRow=null!=N?N:m;let V={},W=()=>V.autoWidth&&!1!==V.multiLine;if(z){V=it({},b,BV(H,void 0,{})),W()&&(V.multiLine=null==(n=V.multiLine)||n,V.maxWidth=null!=(a=V.maxWidth)?a:B?Math.ceil(E):void 0);let{text:t,width:e,height:i}=BN(j,V);A.title.value=Object.assign(Object.assign({width:W()?Math.min(e,null!=(l=V.maxWidth)?l:Number.MAX_VALUE):e,height:i},V),{text:t}),L=A.title.value.width,F=(D=A.title.value.height)+(B?A.title.spaceRow:0)}return C+=F,A.title.width=L,A.title.height=D,W()?T+=E||L:T+=Math.max(L,E),B&&A.content.forEach(t=>{var e;let i=t.value;i&&(null==(e=i.autoWidth)||e)&&(i.width=T-v.left-v.right-R-P-x.spacing-S.spacing,i.maxWidth||(i.maxWidth=Math.ceil(i.width)),A.valueWidth=Math.max(A.valueWidth,i.width))}),A.panel.width=T,A.panel.height=C,A};class BG extends Bk{constructor(){super(BG.type),this.type=mo.canvas,this._attributes=null}onAdd(t){var e;super.onAdd(t),this._tooltipCanvasId=null==(e=this._chartOption.modeParams)?void 0:e.tooltipCanvasId}_initTooltipComponent(t){let e=this._getLayer(t);this._tooltipComponent=new Bj({autoCalculatePosition:!1,autoMeasure:!1}),e.add(this._tooltipComponent)}_getLayer(t){if(this._layer)return this._layer;this._layer=t.createLayer(this._tooltipCanvasId);let e=this._layer.layerHandler.canvas.nativeCanvas;return e&&e.style&&(e.style.touchAction="none",e.style.pointerEvents="none"),this._layer}_getTooltipBoxSize(t,e){var i,r;if(!e||et(this._attributes)){let e=null==(i=this._chartOption)?void 0:i.getTheme("fontFamily");this._attributes=BU(t,this._component.getSpec(),e)}let{panel:s}=null!=(r=this._attributes)?r:{};return{width:s.width+s.lineWidth,height:s.height+s.lineWidth}}_removeTooltip(){this._layer&&this._layer.removeAllChild(),this._attributes=null}_updateTooltip(t,e){this._visible=t;let i=this._compiler.getStage();if(!i)return;if(!t)return void(this._tooltipComponent&&this._tooltipComponent.attribute.visible&&(this._tooltipComponent.hideAll(),this._tooltipComponent.setAttributes({visibleAll:!1})));this._tooltipComponent||this._initTooltipComponent(i);let{activeTooltipSpec:r}=e,s=r.position;e.changePositionOnly?t5(s)&&this._tooltipComponent.setAttributes(s):this._tooltipComponent.setAttributes(Object.assign(Object.assign({},this._attributes),s)),this._tooltipComponent.attribute.visible||(this._tooltipComponent.showAll(),this._tooltipComponent.setAttributes({visibleAll:!0}))}isTooltipShown(){var t;return null==(t=this._tooltipComponent)?void 0:t.attribute.visibleAll}release(){var t;super.release(),null==(t=this._layer)||t.release()}}BG.type=mo.canvas;let BZ=()=>{BB(BG)};function B$(t,e){let i=e?t.toExponential(e-1):t.toExponential(),r=i.indexOf("e");if(r<0)return null;let s=i.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+i.slice(r+1)]}function BY(t,e){let i=B$(t,e);if(!i)return t+"";let r=i[0],s=i[1];return s<0?"0."+Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+Array(s-r.length+2).join("0")}class BX{constructor(t={}){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}toString(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}}let BK=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Bq(t){let e;if(e=BK.exec(t))return new BX({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]});tW.getInstance().error("invalid format: "+t)}let BQ=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];class BJ{constructor(){var t,e,i;this.locale={thousands:",",grouping:[3],currency:["$",""]},this.group=void 0===this.locale.grouping||void 0===this.locale.thousands?t=>t:(t=[...this.locale.grouping].map(Number),e=`${this.locale.thousands}`,function(i,r){let s=i.length,n=[],a=0,l=t[0],o=0;for(;s>0&&l>0&&(o+l+1>r&&(l=Math.max(1,r-o)),n.push(i.substring(s-=l,s+l)),!((o+=l+1)>r));)l=t[a=(a+1)%t.length];return n.reverse().join(e)}),this.currencyPrefix=void 0===this.locale.currency?"":this.locale.currency[0]+"",this.currencySuffix=void 0===this.locale.currency?"":this.locale.currency[1]+"",this.decimal=void 0===this.locale.decimal?".":this.locale.decimal+"",this.numerals=void 0===this.locale.numerals?t=>t:(i=[...this.locale.numerals].map(String),function(t){return t.replace(/[0-9]/g,t=>i[+t])}),this.percent=void 0===this.locale.percent?"%":this.locale.percent+"",this.minus=void 0===this.locale.minus?"−":this.locale.minus+"",this.nan=void 0===this.locale.nan?"NaN":this.locale.nan+"",this.formatter=t=>this.newFormat(t),this.format=(t,e)=>this.formatter(t)(e),this.formatPrefix=(t,e)=>this._formatPrefix(t,e)}static getInstance(){return BJ.instance||(BJ.instance=new BJ),BJ.instance}newFormat(t){let e=Bq(t),i=e.fill,r=e.align,n=e.sign,a=e.symbol,l=e.zero,o=e.width,h=e.comma,u=e.precision,d=e.trim,c=e.type;"n"===c?(h=!0,c="g"):B0[c]||(void 0===u&&(u=12),d=!0,c="g"),(l||"0"===i&&"="===r)&&(l=!0,i="0",r="=");let p="$"===a?this.currencyPrefix:"#"===a&&/[boxX]/.test(c)?"0"+c.toLowerCase():"",g="$"===a?this.currencySuffix:/[%p]/.test(c)?this.percent:"",f=B0[c],m=/[defgprstz%]/.test(c);u=void 0===u?6:/[gprs]/.test(c)?Math.max(1,Math.min(21,u)):Math.max(0,Math.min(20,u));let{nan:y,minus:_,decimal:v,group:b,numerals:x}=this;function S(t){let e,a,S,k=p,A=g,M=t;if("c"===c)A=f(M)+A,M="";else{let t=(M*=1)<0||1/M<0;if(M=isNaN(M)?y:f(Math.abs(M),u),d&&(M=function(t){let e=t.length,i,r=-1;t:for(let s=1;s<e;++s)switch(t[s]){case".":r=i=s;break;case"0":0===r&&(r=s),i=s;break;default:if(!+t[s])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(i+1):t}(M)),t&&0==+M&&"+"!==n&&(t=!1),k=(t?"("===n?n:_:"-"===n||"("===n?"":n)+k,A=("s"===c?BQ[8+s/3]:"")+A+(t&&"("===n?")":""),m){for(e=-1,a=M.length;++e<a;)if(48>(S=M.charCodeAt(e))||S>57){A=(46===S?v+M.slice(e+1):M.slice(e))+A,M=M.slice(0,e);break}}}h&&!l&&(M=b(M,1/0));let w=k.length+M.length+A.length,T=w<o?Array(o-w+1).join(i):"";switch(h&&l&&(M=b(T+M,T.length?o-A.length:1/0),T=""),r){case"<":M=k+M+A+T;break;case"=":M=k+T+M+A;break;case"^":M=T.slice(0,w=T.length>>1)+k+M+A+T.slice(w);break;default:M=T+k+M+A}return x(M)}return S.toString=function(){return t+""},S}_formatPrefix(t,e){let i=Bq(t);i.type="f";let r=this.newFormat(i.toString()),s=3*Math.max(-8,Math.min(8,Math.floor(function(t){let e=B$(Math.abs(t));return e?e[1]:NaN}(e)/3))),n=Math.pow(10,-s),a=BQ[8+s/3];return function(t){return r(n*t)+a}}}let B0={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},f:(t,e)=>t.toFixed(e),e:(t,e)=>t.toExponential(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>BY(100*t,e),r:BY,s:function(t,e){let i=B$(t,e);if(!i)return t+"";let r=i[0],n=i[1],a=n-(s=3*Math.max(-8,Math.min(8,Math.floor(n/3))))+1,l=r.length;return a===l?r:a>l?r+Array(a-l+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+Array(1-a).join("0")+B$(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16),t:(t,e)=>Number.isInteger(t)?t.toFixed(2):Math.floor(t*Math.pow(10,e))/Math.pow(10,e)+"",z:(t,e)=>t%1==0?t+"":t.toFixed(e)},B1=t=>{ig.registerChartPlugin(t.type,t)},B2=/\{([^}]+)\}/,B3=/\{([^}]+)\}/g,B5=/:/;class B4 extends p8{constructor(){super(B4.type),this.type="formatterPlugin",this._timeModeFormat={utc:dq.getInstance().timeUTCFormat,local:dq.getInstance().timeFormat},this._formatter=this._format,this._timeFormatter=this._timeModeFormat.local,this._numericFormatter=BJ.getInstance().format,this._numericSpecifier=BJ.getInstance().formatter,this._numericFormatterCache=new Map,this._isNumericFormatterCache=new Map}onInit(t,e){var i;let{globalInstance:r}=t;if(!r)return;this._spec=null!=(i=null==e?void 0:e[B4.specKey])?i:{};let{timeMode:s,customFormatter:n,numericFormatter:a,timeFormatter:l}=this._spec;tK(n)?this._formatter=n:(this._formatter=this._format.bind(this),tK(l)?this._timeFormatter=l:s&&this._timeModeFormat[s]&&(this._timeFormatter=this._timeModeFormat[s]),a&&(this._numericFormatter=a,this._numericSpecifier=null,this._numericFormatterCache=null)),ig.registerFormatter(this._formatter)}_format(t,e,i){return tY(t)?t.map((t,r)=>{let s=tY(i)?i[r]:i;return s?this._formatSingleLine(t,e,s):t}):tY(i)?i.map(i=>this._formatSingleLine(t,e,i)):this._formatSingleLine(t,e,i)}_formatSingleLine(t,e,i){let r;return(this._isNumericFormatterCache&&(this._isNumericFormatterCache.get(i)?r=this._isNumericFormatterCache.get(i):(r=B2.test(i),this._isNumericFormatterCache.set(i,r))),r)?i.replace(B3,(t,i)=>{if(!B5.test(i)){let r=e[i.trim()];return void 0!==r?r:t}let r=i.split(":"),s=e[r.shift()],n=r.join(":");return this._formatSingleText(s,n)}):this._formatSingleText(t,i)}_formatSingleText(t,e){if(BK.test(e)&&this._numericFormatter){let i;return this._numericFormatterCache&&this._numericSpecifier?(this._numericFormatterCache.get(e)?i=this._numericFormatterCache.get(e):(i=this._numericSpecifier(e),this._numericFormatterCache.set(e,i)),i(Number(t))):this._numericFormatter(e,Number(t))}return e.includes("%")&&this._timeFormatter?this._timeFormatter(e,t):t}release(){super.release(),this._format=null,this._timeFormatter=null,this._numericFormatter=null,this._numericSpecifier=null,this._numericFormatterCache=null,this._isNumericFormatterCache=null}}B4.pluginType="chart",B4.specKey="formatter",B4.type="formatterPlugin";let B7=()=>{B1(B4)},B6={state:V.STATE_ACTIVE,trigger:"pointerover",triggerOff:"pointerout"};class B9 extends dl{constructor(t){super(t),this.type="element-active",this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{this.reset(t.item)},this.options=Object.assign({},B6,t),this.updateMarkIdByState([this.options.state])}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}getStartState(){return this.options.state}start(t){if(t){let{state:e,interaction:i}=this.options;this.isGraphicInStateMark(t,e)&&(t.addState(e,!0),i.setStatedGraphics(this,[t]))}}reset(t){let{interaction:e,state:i}=this.options,r=e.getStatedGraphics(this),s=null!=t?t:null==r?void 0:r[0];s&&r.includes(s)&&(s.removeState(i),e.setStatedGraphics(this,r.filter(t=>t!==s)))}}B9.type="element-active",B9.defaultOptions=B6;let B8=()=>{ig.registerInteractionTrigger(B9.type,B9)},Pt="element-active-by-legend",Pe={state:V.STATE_ACTIVE,filterType:"groupKey"};class Pi extends dl{constructor(t){super(t),this.type=Pt,this.handleStart=t=>{var e,i;let r=t.event;r&&this.start(null==(i=null==(e=r.detail)?void 0:e.data)?void 0:i.id)},this.handleReset=t=>{this.resetAll()},this.options=Object.assign({},Pe,t),this.updateMarkIdByState([this.options.state])}getEvents(){return[{type:rB.legendItemHover,handler:this.handleStart},{type:rB.legendItemUnHover,handler:this.handleReset}]}getStartState(){return this.options.state}start(t){if(et(t))return;let{interaction:e,state:i}=this.options,r=dn(this.options),s=e.getStatedGraphics(this),n=[];this.getMarks().forEach(e=>{var i;null==(i=e.getGraphics())||i.forEach(e=>{r(e)===t&&n.push(e)})}),e.updateStates(this,n,s,i),e.setStatedGraphics(this,n)}resetAll(){let{interaction:t,state:e}=this.options;t.clearAllStatesOfTrigger(this,e),t.setStatedGraphics(this,[])}reset(t){let{state:e,interaction:i}=this.options;if(t){let r=i.getStatedGraphics(this);r&&r.includes(t)&&(t.removeState(e),i.setStatedGraphics(this,r.filter(e=>e!==t)))}else this.resetAll()}}Pi.type=Pt,Pi.defaultOptions=Pe;let Pr=()=>{ig.registerInteractionTrigger(Pt,Pi)},Ps="element-highlight-by-legend",Pn={highlightState:V.STATE_HIGHLIGHT,blurState:V.STATE_BLUR,filterType:"groupKey"};class Pa extends dl{constructor(t){super(t),this.type=Ps,this.handleStart=t=>{var e,i;let r=t.event;r&&this.start(null==(i=null==(e=r.detail)?void 0:e.data)?void 0:i.id)},this.handleReset=t=>{this.resetAll()},this.options=Object.assign({},Pn,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){return[{type:rB.legendItemHover,handler:this.handleStart},{type:rB.legendItemUnHover,handler:this.handleReset}]}start(t){if(t){let e=dn(this.options),{interaction:i,highlightState:r,blurState:s}=this.options,n=i.getStatedGraphics(this),a=[];this.getMarks().forEach(i=>{var r;null==(r=i.getGraphics())||r.forEach(i=>{e(i)===t&&a.push(i)})}),i.updateStates(this,a,n,r,s),i.setStatedGraphics(this,a)}}resetAll(){let{interaction:t,highlightState:e,blurState:i}=this.options;t.clearAllStatesOfTrigger(this,e,i),t.setStatedGraphics(this,[])}reset(t){let{highlightState:e,blurState:i,interaction:r}=this.options;if(t){let s=r.getStatedGraphics(this);s&&s.includes(t)&&(t.removeState([e,i]),r.setStatedGraphics(this,s.filter(e=>e!==t)))}else this.resetAll()}}Pa.type=Ps,Pa.defaultOptions=Pn;let Pl=()=>{ig.registerInteractionTrigger(Ps,Pa)},Po="element-highlight-by-name",Ph={highlightState:V.STATE_HIGHLIGHT,blurState:V.STATE_BLUR,filterType:"groupKey"};class Pu extends dl{constructor(t){super(t),this.type=Po,this.handleStart=t=>{if(this.options.shouldStart?this.options.shouldStart(t):this._filterByName(t)){let e=this._parseTargetKey(t);this.start(e)}},this.handleReset=t=>{(this.options.shouldReset?this.options.shouldReset(t):this._filterByName(t))&&this.resetAll()},this.options=Object.assign({},Ph,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}_filterByName(t){var e;let i=eo(this.options.graphicName);return(null==(e=null==t?void 0:t.node)?void 0:e.name)&&i.includes(t.node.name)}_parseTargetKey(t){return this.options.parseData?this.options.parseData(t):"text"===t.node.type?t.node.attribute.text:null}start(t){if(t){let e=dn(this.options),{interaction:i,highlightState:r,blurState:s}=this.options,n=i.getStatedGraphics(this),a=[];this.getMarks().forEach(i=>{var r;null==(r=i.getGraphics())||r.forEach(i=>{e(i)===t&&a.push(i)})}),i.updateStates(this,a,n,r,s),i.setStatedGraphics(this,a)}}resetAll(){let{interaction:t,highlightState:e,blurState:i}=this.options;t.clearAllStatesOfTrigger(this,e,i),t.setStatedGraphics(this,[])}reset(t){let{highlightState:e,blurState:i,interaction:r}=this.options;if(t){let s=r.getStatedGraphics(this);s&&s.includes(t)&&(t.removeState([e,i]),r.setStatedGraphics(this,s.filter(e=>e!==t)))}else this.resetAll()}}Pu.type=Po,Pu.defaultOptions=Ph;let Pd=()=>{ig.registerInteractionTrigger(Po,Pu)},Pc="element-highlight-by-group";class Pp extends dl{constructor(t){super(t),this.type=Pc,this.handleStart=t=>{this.start(t.item)},this.handleReset=t=>{let e=t.item;e&&this.isGraphicInMark(e)&&this.resetAll()},this.options=Object.assign({},da,t),this.updateMarkIdByState([this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getResetState(){return this.options.blurState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}resetAll(){let{interaction:t,highlightState:e,blurState:i}=this.options;t.clearAllStatesOfTrigger(this,e,i),t.setStatedGraphics(this,[])}_getHightlightKey(t){var e;return null==(e=t.context)?void 0:e.groupKey}start(t){if(t&&this.isGraphicInMark(t)){let e=this._getHightlightKey(t);if(et(e))return;let{interaction:i,highlightState:r,blurState:s}=this.options,n=i.getStatedGraphics(this),a=[];this.getMarks().forEach(t=>{var i;null==(i=t.getGraphics())||i.forEach(t=>{this._getHightlightKey(t)===e&&a.push(t)})}),i.updateStates(this,a,n,r,s),i.setStatedGraphics(this,a)}}reset(t){if(t){if(this.isGraphicInMark(t)){let{interaction:e}=this.options,i=e.getStatedGraphics(this);t.removeState([this.options.highlightState,this.options.blurState]),e.setStatedGraphics(this,i.filter(e=>e!==t))}}else this.resetAll()}}Pp.type=Pc,Pp.defaultOptions=da;let Pg=()=>{ig.registerInteractionTrigger(Pc,Pp)},Pf="element-highlight-by-key";class Pm extends Pp{constructor(){super(...arguments),this.type=Pf}_getHightlightKey(t){var e;return null==(e=t.context)?void 0:e.key}}Pm.type=Pf;let Py=()=>{ig.registerInteractionTrigger(Pf,Pm)};class P_ extends oa{constructor(){super(...arguments),this.type=P_.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}P_.type="image";let Pv=()=>{ig.registerMark(P_.type,P_),(0,ol.W)(),(0,Ce.i)(),ig.registerGraphicComponent("image",xd.B)};(tc=tE||(tE={})).group="group",tc.symbol="symbol",tc.rule="rule",tc.line="line",tc.text="text",tc.rect="rect",tc.image="image",tc.path="path",tc.area="area",tc.arc="arc",tc.polygon="polygon",tc.boxPlot="boxPlot",tc.linkPath="linkPath",tc.cell="cell",tc.ripple="ripple",tc.liquid="liquid",tc.component="component",tc.dataLabel="dataLabel",tc.label="label",tc.pictogram="pictogram";let Pb=()=>{ou(),pI(),pF(),bp(),bk(),mD(),m4(),yC(),va(),Sw(),Pv(),wr(),gL()};dy.useRegisters([m_,mG,yr,y_,vy,v1,ba,bL,_$,xt,Sl,So,SI,AE,A8,bY,SZ,S5,MU,kw,kK,As,MF,M2,bB,wd,bh,fc,g8,wp,w_,wS,vG,v$,wO,w$,w2,Ti,Th,TE,TP,Tj,_N,C0,Er,EQ,C5,Ea,E0,E2,C6,ER,EV,EU,Be,Br,Bo,Ba,Pb,BO,BZ,B7,B8,Pr,Pl,Pd,Pg,Py,u8,ub,u_]),(tp=tB||(tB={})).vertical="vertical",tp.horizontal="horizontal";var Px=i(94927),PS=i(88994);class Pk{constructor(){this.released=!1,this.currentTime=-1}tick(t,e){this.currentTime<0&&(this.currentTime=0),this.currentTime+=t,e(this)}release(){this.released=!0}getTime(){return this.currentTime}tickTo(t,e){this.currentTime<0&&(this.currentTime=0);let i=t-this.currentTime;this.tick(i,e)}}class PA extends PS.H{constructor(t){super(t),this.lastFrameTime=0,this.status=Px.Q.RUNNING}setupTickHandler(){let t=new Pk;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0}checkSkip(t){return!1}getTime(){return this.tickerHandler.getTime()}tickAt(t){this.tickTo(t)}start(t=!1){return!(this.status===Px.Q.RUNNING||!this.tickerHandler||!t&&(this.status===Px.Q.PAUSE||this.ifCanStop()))&&(this.status=Px.Q.RUNNING,!0)}}var PM=i(85309);let Pw="2.0.3";class PT extends fB{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["valueField","maskShape","reverse","outlineMargin","outlinePadding","indicatorSmartInvert","liquidBackground","liquidOutline"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}let PC={duration:2e3,loop:!0,channel:{wave:{from:0,to:1}}},PE=t=>({duration:2e3,channel:{wave:{from:0,to:1},height:t.height,dy:t.dy}}),PB=t=>({duration:2e3,channel:{dy:t.dy}}),PP=t=>({duration:2e3,channel:{dy:t.dy}});function PO(t,e){switch(e){case"wave":default:return PC;case"grow":case"waveGrow":return PE(t)}}function PI(t,e){switch(e){case"wave":default:return PC;case"grow":return PB(t);case"waveGrow":return PP(t)}}let PR=()=>{ig.registerAnimation("liquid",(t,e)=>({appear:PO(t,e),enter:PO(t,e),exit:PO(t,e)})),ig.registerAnimation("liquidGroup",(t,e)=>({appear:PI(t,e),enter:PI(t,e),exit:PI(t,e)}))},PL=Object.assign(Object.assign({},cd),{liquidGroup:{name:"liquidGroup",type:"group"},liquid:{name:"liquid",type:"liquid"},liquidBackground:{name:"liquidBackground",type:"group"},liquidOutline:{name:"liquidOutline",type:"group"}});class PD extends AV{constructor(){super(...arguments),this.type=PD.type,this._subMarks={wave0:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:1}},wave1:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.66}},wave2:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.33}}},this._positionChannels=["wave","y","height"],this._positionEncoder=(t,e,i)=>{let{wave:r=i.attribute.wave,y:s=i.attribute.y,height:n=i.attribute.height}=t,a=[],l=[],o=[];for(let t=0;t<21;t++){let e=50*t-500,i=s+20*(t%2==0),h=s+n;a.push({x:e+100*r,y:i,y1:h}),l.push({x:e+200*r-40,y:i,y1:h}),o.push({x:e+300*r-20,y:i,y1:h})}return{wave0:{x:0,y:0,points:a},wave1:{x:0,y:0,points:l},wave2:{x:0,y:0,points:o}}}}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{wave:0})}}PD.type="liquid";let PF=()=>{AW(),mI(),ig.registerMark(PD.type,PD),ig.registerGraphicComponent("area",t=>mS(t))},Pz=(t,e)=>"drop"===t?function(t,e,i){let r=4*i/3,s=Math.max(r,2*i),n=r/2,a=n+0-s/2,l=Math.asin(n/(.85*(s-n))),o=Math.sin(l)*n,h=Math.cos(l)*n,u=0-h,d=a+o,c=a+n/Math.sin(l);return`
      M ${u} ${d}
      A ${n} ${n} 0 1 1 ${u+2*h} ${d}
      Q ${t} ${c} ${t} ${e+s/2}
      Q ${t} ${c} ${u} ${d}
      Z 
    `}(0,0,e):t;class Pj extends d8{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>this.series.getValueField(),this.markTooltipValueCallback=t=>t[this.series.getValueField()],this.shapeStrokeCallback=t=>this.series.getMarkInName("liquid").getAttribute("fill",t)}}class PH extends cT{constructor(){super(...arguments),this.type=rw.liquid,this.transformerConstructor=pz,this._liquidBackgroundMark=null,this._liquidOutlineMark=null,this._getLiquidPosY=()=>{let t=0,{height:e,startY:i}=this._getLiquidBackPosAndSize();return(this._reverse?e*this._heightRatio:e*(1-this._heightRatio))+i},this._getLiquidHeight=()=>{let{height:t}=this._getLiquidBackPosAndSize();return t*this._heightRatio},this._getLiquidBackPosAndSize=(t=!1)=>{var e,i;let{top:r=0,bottom:s=0,left:n=0,right:a=0}=this._marginSpec,{top:l=0,bottom:o=0,left:h=0,right:u=0}=t?{}:this._paddingSpec;"triangle"===this._maskShape&&(s/=Math.sqrt(3),r=r/Math.sqrt(3)*2,o/=Math.sqrt(3),l=l/Math.sqrt(3)*2);let{width:d,height:c}=null!=(i=null==(e=this._region)?void 0:e.getLayoutRect())?i:{width:0,height:0},p=d/2+(n+h-(a+u))/2,g=c/2+(r+l-(s+o))/2,f=d-(n+a+h+u),m=c-(r+s+l+o),y=Math.min(f,m);return"rect"!==this._maskShape&&(f=y,m=y),{x:p,y:g,size:y,width:f,height:m,startX:p-f/2,startY:g-m/2,endX:p+f/2,endY:g+m/2}},this._getLiquidBackPath=(t=!1)=>{var e;let i;if("rect"===this._maskShape){let{x:e,y:r,width:s,height:n}=this._getLiquidBackPosAndSize(t);i=(0,m3.f)({x:e-s/2,y:r-n/2,width:s,height:n,fill:!0})}else{let{x:r,y:s,size:n}=this._getLiquidBackPosAndSize(t);i=(0,pR.t)({x:r,y:s,size:n,symbolType:Pz(null!=(e=this._spec.maskShape)?e:"circle",n),fill:!0})}return[i]}}setValueField(t){t5(t)&&(this._valueField=t)}getValueField(){return this._valueField}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this._marginSpec=eA(this._spec.outlineMargin),this._paddingSpec=eA(this._spec.outlinePadding),this.setValueField(this._spec.valueField),this._reverse=null!=(t=this._spec.reverse)&&t,this._maskShape=null!=(e=this._spec.maskShape)?e:"circle"}viewDataUpdate(t){super.viewDataUpdate(t),this._heightRatio=dx(...this._data.getLatestData().map(t=>t[this._valueField]))}initMark(){this._initLiquidOutlineMark(),this._initLiquidBackgroundMark(),this._initLiquidMark()}initMarkStyle(){this._initLiquidOutlineMarkStyle(),this._initLiquidBackgroundMarkStyle(),this._initLiquidMarkStyle()}_initLiquidOutlineMark(){return this._liquidOutlineMark=this._createMark(PH.mark.liquidOutline,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidOutlineMark}_initLiquidBackgroundMark(){return this._liquidBackgroundMark=this._createMark(PH.mark.liquidBackground,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidBackgroundMark}_initLiquidMark(){return this._liquidGroupMark=this._createMark(PH.mark.liquidGroup,{parent:this._liquidBackgroundMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark=this._createMark(PH.mark.liquid,{parent:this._liquidGroupMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getLiquidBackPosAndSize=this._getLiquidBackPosAndSize,this._markAttributeContext.getLiquidPosY=this._getLiquidPosY,this._markAttributeContext.getLiquidHeight=this._getLiquidHeight}_initLiquidOutlineMarkStyle(){let t=this._liquidOutlineMark;t.created(),this.setMarkStyle(t,{stroke:this.getColorAttribute(),width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,path:()=>this._getLiquidBackPath(!0)},"normal",H.Series),this._liquidOutlineMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex})}_initLiquidBackgroundMarkStyle(){let t=this._liquidBackgroundMark;t.created(),this.setMarkStyle(t,{width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,path:()=>this._getLiquidBackPath()},"normal",H.Series),this._liquidBackgroundMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0})}_initLiquidMarkStyle(){let t=this._liquidMark,e=this._liquidGroupMark;e&&this.setMarkStyle(e,{x:()=>this._region.getLayoutStartPoint().x+this._region.getLayoutRect().width/2,angle:this._reverse?-Math.PI:0,y:0,dy:this._getLiquidPosY}),t&&this.setMarkStyle(t,{y:0,dy:0,height:this._getLiquidHeight,fill:this.getColorAttribute(),wave:0},"normal",H.Series)}initTooltip(){this._tooltipHelper=new Pj(this),this._liquidMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._liquidMark)}getInteractionTriggers(){return this._parseInteractionConfig(this._liquidMark?[this._liquidMark]:[])}initAnimation(){var t,e,i,r;let s={height:{from:0,to:()=>this._getLiquidHeight()},dy:{from:()=>{let t=0,{height:e,startY:i}=this._getLiquidBackPosAndSize();return(this._reverse?0:e)+i}}},n=null==(e=null==(t=this._spec)?void 0:t.animationAppear)?void 0:e.preset;this._liquidMark.setAnimationConfig(cv(null==(i=ig.getAnimationInKey("liquid"))?void 0:i(s,n),cb("liquid",this._spec,this._markAttributeContext))),this._liquidGroupMark.setAnimationConfig(cv(null==(r=ig.getAnimationInKey("liquidGroup"))?void 0:r(s,n),cb("liquidGroup",this._spec,this._markAttributeContext)))}initEvent(){super.initEvent(),this._spec.indicatorSmartInvert&&this._option.getChart().getComponentsByKey("indicator")&&this.event.on(rB.renderFinished,()=>{this._option.getChart().getComponentsByKey("indicator").forEach(t=>{var e,i,r;let s=null==(e=this._liquidMark.getGraphics()[0].getSubGraphic())?void 0:e[0],{y1:n,y2:a}=s.globalAABBBounds;n+=this._region.getLayoutStartPoint().y,a+=this._region.getLayoutStartPoint().y,null==(r=null==(i=null==t?void 0:t.getIndicatorComponent())?void 0:i.getChildren()[0])||r.getChildren().forEach(t=>{let{y1:e,y2:i}=t.globalAABBBounds;if(n<e&&a>i){let e=cQ(t.attribute.fill,s.attribute.fill);t.setAttribute("fill",e)}})})})}dataToPosition(t){return null}dataToPositionX(t){return null}dataToPositionY(t){return null}valueToPosition(t,e){return null}getStatisticFields(){return[]}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}getActiveMarks(){return[this._liquidMark]}}PH.type=rw.liquid,PH.mark=PL,PH.builtInTheme={liquid:{outlinePadding:10,liquidBackground:{style:{lineWidth:0,fillOpacity:.2}},liquidOutline:{style:{lineWidth:2}}}},PH.transformerConstructor=pz;let PN=()=>{PF(),ou(),PR(),ig.registerSeries(PH.type,PH)};class PV extends fF{constructor(){super(...arguments),this.transformerConstructor=PT,this.type="liquid",this.seriesType=rw.liquid}}PV.type="liquid",PV.seriesType=rw.liquid,PV.transformerConstructor=PT;let PW=()=>{mg(),PN(),ig.registerChart(PV.type,PV)},PU=t=>eo(t).join(",");class PG extends d8{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=t=>PU(null==t?void 0:t[this.series.getDimensionField()[0]]),this.markTooltipKeyCallback=t=>PU(null==t?void 0:t[this.series.getDimensionField()[0]])}}let PZ=Object.assign(Object.assign({},cd),{circle:{name:"circle",type:"arc"},overlap:{name:"overlap",type:"path"},overlapLabel:{name:"overlapLabel",type:"text"}});function P$(t,e){let i=function(t){let e=[];for(let i=0;i<t.length;++i)for(let r=i+1;r<t.length;++r){let s=PK(t[i],t[r]);for(let t=0;t<s.length;++t){let n=s[t];n.parentIndex=[i,r],e.push(n)}}return e}(t),r=i.filter(function(e){var i=e,r=t;for(let t=0;t<r.length;++t)if(dP.distancePP(i,r[t])>r[t].radius+1e-10)return!1;return!0}),s=0,n=0,a=[];if(r.length>1){let e=Pq(r);for(let t=0;t<r.length;++t){let i=r[t];i.angle=Math.atan2(i.x-e.x,i.y-e.y)}r.sort(function(t,e){return e.angle-t.angle});let i=r[r.length-1];for(let e=0;e<r.length;++e){let l=r[e];n+=(i.x+l.x)*(l.y-i.y);let o={x:(l.x+i.x)/2,y:(l.y+i.y)/2},h=null;for(let e=0;e<l.parentIndex.length;++e)if(i.parentIndex.indexOf(l.parentIndex[e])>-1){let r=t[l.parentIndex[e]],s=Math.atan2(l.x-r.x,l.y-r.y),n=Math.atan2(i.x-r.x,i.y-r.y),a=n-s;a<0&&(a+=2*Math.PI);let u=n-a/2,d=dP.distancePP(o,{x:r.x+r.radius*Math.sin(u),y:r.y+r.radius*Math.cos(u)});d>2*r.radius&&(d=2*r.radius),(null===h||h.width>d)&&(h={circle:r,width:d,p1:l,p2:i})}null!==h&&(a.push(h),s+=PY(h.circle.radius,h.width),i=l)}}else{let e=t[0];for(let i=1;i<t.length;++i)t[i].radius<e.radius&&(e=t[i]);let i=!1;for(let r=0;r<t.length;++r)if(dP.distancePP(t[r],e)>Math.abs(e.radius-t[r].radius)){i=!0;break}i?s=n=0:(s=e.radius*e.radius*Math.PI,a.push({circle:e,p1:{x:e.x,y:e.y+e.radius},p2:{x:e.x-1e-10,y:e.y+e.radius},width:2*e.radius}))}return n/=2,e&&(e.area=s+n,e.arcArea=s,e.polygonArea=n,e.arcs=a,e.innerPoints=r,e.intersectionPoints=i),s+n}function PY(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function PX(t,e,i){return i>=t+e?0:i<=Math.abs(t-e)?Math.PI*Math.min(t,e)*Math.min(t,e):PY(t,t-(i*i-e*e+t*t)/(2*i))+PY(e,e-(i*i-t*t+e*e)/(2*i))}function PK(t,e){let i=dP.distancePP(t,e),r=t.radius,s=e.radius;if(i>=r+s||i<=Math.abs(r-s))return[];let n=(r*r-s*s+i*i)/(2*i),a=Math.sqrt(r*r-n*n),l=t.x+n*(e.x-t.x)/i,o=t.y+n*(e.y-t.y)/i,h=-(e.y-t.y)*(a/i),u=-(e.x-t.x)*(a/i);return[{x:l+h,y:o-u},{x:l-h,y:o+u}]}function Pq(t){let e={x:0,y:0};for(let i=0;i<t.length;++i)e.x+=t[i].x,e.y+=t[i].y;return e.x/=t.length,e.y/=t.length,e}let PQ=t=>{let e={},i=Object.values(t);if(!i.length)return[];P$(i,e);let r=e.arcs.map(({p1:t,p2:e,circle:i,width:r})=>({p1:t,p2:e,radius:i.radius,setId:i.setId,largeArcFlag:r>i.radius})),s=[],n=0,a=r[0];for(;n<r.length&&a;){let{p2:t}=a;s.push(a),a=r.find(e=>1e-10>dP.distancePP(e.p1,t)),n++}return s},PJ=t=>{if(!(null==t?void 0:t.length))return"";let e=0,i=t[0],{p1:r}=i,s=`M${r.x},${r.y}`;for(;i;){let{p2:r,radius:n,largeArcFlag:a}=i;s+=`A${n},${n} 0 ${+!!a},0 ${r.x},${r.y}`,i=t[++e]}return s+" Z"},P0=t=>{var e;return null!=(e=null==t?void 0:t.map(t=>{let{p1:e,p2:i,radius:r,largeArcFlag:s,setId:n}=t,{x:a,y:l}=e,{x:o,y:h}=i,u=((o-a)**2+(h-l)**2)**.5,d=(a+o)/2,c=(l+h)/2,p=(r**2-(u/2)**2)**.5,g=d+p*(h-l)/u,f=c-p*(o-a)/u;return(dA([o-a,h-l],[g-a,f-l])>0||s)&&(g=d-p*(h-l)/u,f=c+p*(o-a)/u),{x:g,y:f,radius:r,setId:n}}))?e:[]},P1=t=>{switch(t){case"fadeIn":default:return{type:"fadeIn"};case"growIn":return{type:"growRadiusIn"};case"scaleIn":return{type:"scaleIn"}}},P2=t=>{switch(t){case"fadeIn":default:return{type:"fadeIn"};case"scaleIn":return{type:"scaleIn"}}};class P3 extends lZ.r{onBind(){var t,e;this.fromCircles={},null==(t=P0(this.target.attribute.arcs))||t.forEach(t=>{this.fromCircles[t.setId]=t}),this.toCircles={},null==(e=P0(this.target.getFinalAttribute().arcs))||e.forEach(t=>{this.toCircles[t.setId]=t})}onUpdate(t,e,i){let r=[];Object.keys(this.fromCircles).forEach(t=>{let i=this.fromCircles[t],s=this.toCircles[t];i&&s&&r.push({radius:i.radius+(s.radius-i.radius)*e,x:i.x+(s.x-i.x)*e,y:i.y+(s.y-i.y)*e,setId:t})});let s=PQ(r);this.target.setAttributes({arcs:s,path:PJ(s)})}}let P5=()=>{ig.registerAnimation("vennCircle",(t,e)=>({appear:P1(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}})),ig.registerAnimation("vennOverlap",(t,e)=>({appear:P2(e),update:{custom:P3},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}))};class P4 extends cw{_transformLabelSpec(t){this._addMarkLabelSpec(t,"circle"),this._addMarkLabelSpec(t,"overlap","overlapLabel","initOverlapLabelMarkStyle")}}function P7(t,e){let i=0;for(let r=0;r<e.length;++r){let s,n=e[r];if(1!==n.sets.length){if(2===n.sets.length){let e=t[n.sets[0]],i=t[n.sets[1]];s=PX(e.radius,i.radius,dP.distancePP(e,i))}else s=P$(n.sets.map(function(e){return t[e]}));i+=(n.hasOwnProperty("weight")?n.weight:1)*(s-n.size)*(s-n.size)}}return i}function P6(t){let e=Array(t);for(let i=0;i<t;++i)e[i]=0;return e}function P9(t,e){return P6(t).map(function(){return P6(e)})}function P8(t){return Math.sqrt(dM(t,t))}function Ot(t,e,i){for(let r=0;r<e.length;++r)t[r]=e[r]*i}function Oe(t,e,i,r,s){for(let n=0;n<t.length;++n)t[n]=e*i[n]+r*s[n]}function Oi(t,e,i){return Math.min(t,e)*Math.min(t,e)*Math.PI<=i+1e-10?Math.abs(t-e):function(t,e,i,r){var s;let n=100,a=(s=void 0,1e-10),l=t(e),o=t(i),h=i-e;if(l*o>0)return tW.getInstance().error("Initial bisect points must have opposite signs"),NaN;if(0===l)return e;if(0===o)return i;for(let i=0;i<n;++i){let i=e+(h/=2),r=t(i);if(r*l>=0&&(e=i),Math.abs(h)<a||0===r)return i}return e+h}(function(r){return PX(t,e,r)-i},0,t+e)}function Or(t,e,i){let r,s=(i=i||{}).maxIterations||200*e.length,n=i.nonZeroDelta||1.05,a=i.zeroDelta||.001,l=i.minErrorDelta||1e-6,o=i.minErrorDelta||1e-5,h=void 0!==i.rho?i.rho:1,u=void 0!==i.chi?i.chi:2,d=void 0!==i.psi?i.psi:-.5,c=void 0!==i.sigma?i.sigma:.5,p=e.length,g=Array(p+1);g[0]=e,g[0].fx=t(e),g[0].id=0;for(let i=0;i<p;++i){let r=e.slice();r[i]=r[i]?r[i]*n:a,g[i+1]=r,g[i+1].fx=t(r),g[i+1].id=i+1}function f(t){for(let e=0;e<t.length;e++)g[p][e]=t[e];g[p].fx=t.fx}let m=function(t,e){return t.fx-e.fx},y=e.slice(),_=e.slice(),v=e.slice(),b=e.slice();for(let e=0;e<s;++e){if(g.sort(m),i.history){let t=g.map(function(t){let e=t.slice();return e.fx=t.fx,e.id=t.id,e});t.sort(function(t,e){return t.id-e.id}),i.history.push({x:g[0].slice(),fx:g[0].fx,simplex:t})}r=0;for(let t=0;t<p;++t)r=Math.max(r,Math.abs(g[0][t]-g[1][t]));if(Math.abs(g[0].fx-g[p].fx)<l&&r<o)break;for(let t=0;t<p;++t){y[t]=0;for(let e=0;e<p;++e)y[t]+=g[e][t];y[t]/=p}let e=g[p];if(Oe(_,1+h,y,-h,e),_.fx=t(_),_.fx<g[0].fx)Oe(b,1+u,y,-u,e),b.fx=t(b),f(b.fx<_.fx?b:_);else if(_.fx>=g[p-1].fx){let i=!1;if(_.fx>e.fx?(Oe(v,1+d,y,-d,e),v.fx=t(v),v.fx<e.fx?f(v):i=!0):(Oe(v,1-d*h,y,d*h,e),v.fx=t(v),v.fx<_.fx?f(v):i=!0),i){if(c>=1)break;for(let e=1;e<g.length;++e)Oe(g[e],1-c,g[0],c,g[e]),g[e].fx=t(g[e])}}else f(_)}return g.sort(m),{fx:g[0].fx,x:g[0]}}function Os(t,e){let i=function(t,e){let i=e&&e.lossFunction?e.lossFunction:P7,r={},s={};for(let e=0;e<t.length;++e){let i=t[e];if(1===i.sets.length){let t=i.sets[0];r[t]={x:1e10,y:1e10,size:i.size,radius:Math.sqrt(i.size/Math.PI),setId:t},s[t]=[]}}t=t.filter(function(t){return 2===t.sets.length});for(let e=0;e<t.length;++e){let i=t[e],n=i.hasOwnProperty("weight")?i.weight:1,a=i.sets[0],l=i.sets[1];i.size+1e-10>=Math.min(r[a].size,r[l].size)&&(n=0),s[a].push({set:l,size:i.size,weight:n}),s[l].push({set:a,size:i.size,weight:n})}let n=[];for(let t in s)if(s.hasOwnProperty(t)){let e=0;for(let i=0;i<s[t].length;++i)e+=s[t][i].size*s[t][i].weight;n.push({set:t,size:e})}function a(t,e){return e.size-t.size}n.sort(a);let l={};function o(t){return t.set in l}function h(t,e){r[e].x=t.x,r[e].y=t.y,l[e]=!0}h({x:0,y:0},n[0].set);for(let e=1;e<n.length;++e){let l=n[e].set,u=s[l].filter(o),d=r[l];if(u.sort(a),0===u.length)throw"ERROR: missing pairwise overlap information";let c=[];for(let t=0;t<u.length;++t){let e=r[u[t].set],i=Oi(d.radius,e.radius,u[t].size);c.push({x:e.x+i,y:e.y}),c.push({x:e.x-i,y:e.y}),c.push({y:e.y+i,x:e.x}),c.push({y:e.y-i,x:e.x});for(let s=t+1;s<u.length;++s){let t=r[u[s].set],n=Oi(d.radius,t.radius,u[s].size),a=PK({x:e.x,y:e.y,radius:i},{x:t.x,y:t.y,radius:n});for(let t=0;t<a.length;++t)c.push(a[t])}}let p=1e50,g=c[0];for(let e=0;e<c.length;++e){r[l].x=c[e].x,r[l].y=c[e].y;let s=i(r,t);s<p&&(p=s,g=c[e])}h(g,l)}return r}(t,e),r=e.lossFunction||P7;if(t.length>=8){let s=function(t,e){let i,r,s,n=(e=e||{}).restarts||10,a=[],l={};for(i=0;i<t.length;++i){let e=t[i];1===e.sets.length&&(l[e.sets[0]]=a.length,a.push(e))}let o=function(t,e,i){let r=P9(e.length,e.length),s=P9(e.length,e.length);return t.filter(function(t){return 2===t.sets.length}).map(t=>{let n=i[t.sets[0]],a=i[t.sets[1]],l=Oi(Math.sqrt(e[n].size/Math.PI),Math.sqrt(e[a].size/Math.PI),t.size);r[n][a]=r[a][n]=l;let o=0;t.size+1e-10>=Math.min(e[n].size,e[a].size)?o=1:t.size<=1e-10&&(o=-1),s[n][a]=s[a][n]=o}),{distances:r,constraints:s}}(t,a,l),h=o.distances,u=o.constraints,d=P8(h.map(P8))/h.length;h=h.map(t=>t.map(t=>t/d));let c=function(t,e){return function(t,e,i,r){let s,n=0;for(s=0;s<e.length;++s)e[s]=0;for(s=0;s<i.length;++s){let a=t[2*s],l=t[2*s+1];for(let o=s+1;o<i.length;++o){let h=t[2*o],u=t[2*o+1],d=i[s][o],c=r[s][o],p=(h-a)*(h-a)+(u-l)*(u-l),g=Math.sqrt(p),f=p-d*d;c>0&&g<=d||c<0&&g>=d||(n+=2*f*f,e[2*s]+=4*f*(a-h),e[2*s+1]+=4*f*(l-u),e[2*o]+=4*f*(h-a),e[2*o+1]+=4*f*(u-l))}}return n}(t,e,h,u)};for(i=0;i<n;++i)s=function(t,e,i){let r={x:e.slice(),fx:0,fxprime:e.slice()},s={x:e.slice(),fx:0,fxprime:e.slice()},n=e.slice(),a,l=1,o=(i=i||{}).maxIterations||20*e.length;r.fx=t(r.x,r.fxprime);let h=r.fxprime.slice();Ot(h,r.fxprime,-1);for(let e=0;e<o;++e){if(l=function(t,e,i,r,s,n,a){let l=i.fx,o=dM(i.fxprime,e),h=l,u=l,d=o,c=0;function p(u,c,p){for(let g=0;g<16;++g)if(s=(u+c)/2,Oe(r.x,1,i.x,s,e),h=r.fx=t(r.x,r.fxprime),d=dM(r.fxprime,e),h>l+n*s*o||h>=p)c=s;else{if(Math.abs(d)<=-a*o)return s;d*(c-u)>=0&&(c=u),u=s,p=h}return 0}s=s||1,n=n||1e-6,a=a||.1;for(let g=0;g<10;++g){if(Oe(r.x,1,i.x,s,e),h=r.fx=t(r.x,r.fxprime),d=dM(r.fxprime,e),h>l+n*s*o||g&&h>=u)return p(c,s,u);if(Math.abs(d)<=-a*o)break;if(d>=0)return p(s,c,h);u=h,c=s,s*=2}return s}(t,h,r,s,l),i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:l}),l){Oe(n,1,s.fxprime,-1,r.fxprime);let t=dM(r.fxprime,r.fxprime);Oe(h,Math.max(0,dM(n,s.fxprime)/t),h,-1,s.fxprime),a=r,r=s,s=a}else Ot(h,r.fxprime,-1);if(1e-5>=P8(r.fxprime))break}return i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:l}),r}(c,P6(2*h.length).map((t,e)=>xf(e)),e),(!r||s.fx<r.fx)&&(r=s);let p=r.x,g={};for(i=0;i<a.length;++i){let t=a[i];g[t.sets[0]]={x:p[2*i]*d,y:p[2*i+1]*d,radius:Math.sqrt(t.size/Math.PI)}}if(e.history)for(i=0;i<e.history.length;++i)Ot(e.history[i].x,d);return g}(t,e);r(s,t)+1e-8<r(i,t)&&(i=s)}return i}function On(t){let e=function(e){return{max:Math.max.apply(null,t.map(function(t){return t[e]+t.radius})),min:Math.min.apply(null,t.map(function(t){return t[e]-t.radius}))}};return{xRange:e("x"),yRange:e("y")}}function Oa(t,e,i){let r,s,n=e[0].radius-dP.distancePP(e[0],t);for(r=1;r<e.length;++r)(s=e[r].radius-dP.distancePP(e[r],t))<=n&&(n=s);for(r=0;r<i.length;++r)(s=dP.distancePP(i[r],t)-i[r].radius)<=n&&(n=s);return n}let Ol=(t,e)=>{let{x0:i,x1:r,y0:s,y1:n,setField:a="sets",valueField:l="size",orientation:o=Math.PI/2,orientationOrder:h=null}=t,u={},d={};if(e.length>0){let c=e.map(t=>({sets:eo(t[a]),size:t[l]})),p=function(t,e){(e=e||{}).maxIterations=e.maxIterations||500;let i=e.initialLayout||Os,r=e.lossFunction||P7,s=i(t=function(t){t=t.slice();let e=[],i={};for(let r=0;r<t.length;++r){let s=t[r];if(1===s.sets.length)e.push(s.sets[0]);else if(2===s.sets.length){let t=s.sets[0],e=s.sets[1];i[[t,e].toString()]=!0,i[[e,t].toString()]=!0}}e.sort(function(t,e){return+(t>e)});for(let r=0;r<e.length;++r){let s=e[r];for(let n=r+1;n<e.length;++n){let r=e[n];[s,r].toString()in i||t.push({sets:[s,r],size:0})}}return t}(t),e),n=[],a=[];for(let t in s)s.hasOwnProperty(t)&&(n.push(s[t].x),n.push(s[t].y),a.push(t));let l=Or(function(e){let i={};for(let t=0;t<a.length;++t){let r=a[t];i[r]={x:e[2*t],y:e[2*t+1],radius:s[r].radius}}return r(i,t)},n,e).x;for(let t=0;t<a.length;++t){let e=a[t];s[e].x=l[2*t],s[e].y=l[2*t+1]}return s}(c,t);d=function(t,e){let i={},r=function(t){let e={},i=[];for(let r in t)i.push(r),e[r]=[];for(let r=0;r<i.length;r++){let s=t[i[r]];for(let n=r+1;n<i.length;++n){let a=t[i[n]],l=dP.distancePP(s,a);l+a.radius<=s.radius+1e-10?e[i[n]].push(i[r]):l+s.radius<=a.radius+1e-10&&e[i[r]].push(i[n])}}return e}(t);for(let s=0;s<e.length;++s){let n=e[s].sets,a={},l={};for(let t=0;t<n.length;++t){a[n[t]]=!0;let e=r[n[t]];for(let t=0;t<e.length;++t)l[e[t]]=!0}let o=[],h=[];for(let e in t)e in a?o.push(t[e]):e in l||h.push(t[e]);let u=function t(e,i){let r=[];for(let t=0;t<e.length;++t){let i=e[t];r.push({x:i.x,y:i.y}),r.push({x:i.x+i.radius/2,y:i.y}),r.push({x:i.x-i.radius/2,y:i.y}),r.push({x:i.x,y:i.y+i.radius/2}),r.push({x:i.x,y:i.y-i.radius/2})}let s=r[0],n=Oa(r[0],e,i);for(let t=1;t<r.length;++t){let a=Oa(r[t],e,i);a>=n&&(s=r[t],n=a)}let a=Or(function(t){return -1*Oa({x:t[0],y:t[1]},e,i)},[s.x,s.y],{maxIterations:500,minErrorDelta:1e-10}).x,l={x:a[0],y:a[1]},o=!0;for(let t=0;t<e.length;++t)if(dP.distancePP(l,e[t])>e[t].radius){o=!1;break}for(let t=0;t<i.length;++t)if(dP.distancePP(l,i[t])<i[t].radius){o=!1;break}if(!o)if(1===e.length)l={x:e[0].x,y:e[0].y};else{let r={};P$(e,r),l=0===r.arcs.length?{x:0,y:-1e3,disjoint:!0}:1===r.arcs.length?{x:r.arcs[0].circle.x,y:r.arcs[0].circle.y}:i.length?t(e,[]):Pq(r.arcs.map(function(t){return t.p1}))}return l}(o,h);i[n.toString()]=u,u.disjoint&&e[s].size>0&&tW.getInstance().error("Area "+n+" not represented on screen")}return i}(u=function(t,e,i,r,s){e=Math.max(e,1),i=Math.max(i,1);let n=[],a=[];for(let e in t)t.hasOwnProperty(e)&&(a.push(e),n.push(t[e]));let l=On(n),o=l.xRange,h=l.yRange;if(o.max===o.min||h.max===h.min)return console.log("not scaling solution: zero size detected"),t;let u=e/(o.max-o.min),d=Math.min(i/(h.max-h.min),u),c=(e-(o.max-o.min)*d)/2,p=(i-(h.max-h.min)*d)/2,g={};for(let t=0;t<n.length;++t){let e=n[t];g[a[t]]={radius:d*e.radius,x:r+c+(e.x-o.min)*d,y:s+p+(e.y-h.min)*d,setId:e.setId}}return g}(p=function(t,e,i){null===e&&(e=Math.PI/2);let r=[];for(let e in t)if(t.hasOwnProperty(e)){let i=t[e];r.push({x:i.x,y:i.y,radius:i.radius,setId:e})}let s=function(t){let e;function i(t){return t.parent!==t&&(t.parent=i(t.parent)),t.parent}t.map(function(t){t.parent=t});for(let e=0;e<t.length;++e)for(let n=e+1;n<t.length;++n){var r,s;let a=t[e].radius+t[n].radius;dP.distancePP(t[e],t[n])+1e-10<a&&(r=t[n],s=t[e],i(r).parent=i(s))}let n={};for(let r=0;r<t.length;++r)(e=i(t[r]).parent.setId)in n||(n[e]=[]),n[e].push(t[r]);t.map(function(t){delete t.parent});let a=[];for(e in n)n.hasOwnProperty(e)&&a.push(n[e]);return a}(r);for(let t=0;t<s.length;++t){!function(t,e,i){let r;if(null===i?t.sort(function(t,e){return e.radius-t.radius}):t.sort(i),t.length>0){let e=t[0].x,i=t[0].y;for(r=0;r<t.length;++r)t[r].x-=e,t[r].y-=i}if(2===t.length&&dP.distancePP(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y),t.length>1){let i,s,n=Math.atan2(t[1].x,t[1].y)-e,a=Math.cos(n),l=Math.sin(n);for(r=0;r<t.length;++r)i=t[r].x,s=t[r].y,t[r].x=a*i-l*s,t[r].y=l*i+a*s}if(t.length>2){let i=Math.atan2(t[2].x,t[2].y)-e;for(;i<0;)i+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI;if(i>Math.PI){let e=t[1].y/(1e-10+t[1].x);for(r=0;r<t.length;++r){let i=(t[r].x+e*t[r].y)/(1+e*e);t[r].x=2*i-t[r].x,t[r].y=2*i*e-t[r].y}}}}(s[t],e,i);let r=On(s[t]);s[t].size=(r.xRange.max-r.xRange.min)*(r.yRange.max-r.yRange.min),s[t].bounds=r}s.sort(function(t,e){return e.size-t.size});let n=(r=s[0]).bounds,a=(n.xRange.max-n.xRange.min)/50;function l(t,e,i){let s,l,o;if(!t)return;let h=t.bounds;e?s=n.xRange.max-h.xRange.min+a:(s=n.xRange.max-h.xRange.max,(o=(h.xRange.max-h.xRange.min)/2-(n.xRange.max-n.xRange.min)/2)<0&&(s+=o)),i?l=n.yRange.max-h.yRange.min+a:(l=n.yRange.max-h.yRange.max,(o=(h.yRange.max-h.yRange.min)/2-(n.yRange.max-n.yRange.min)/2)<0&&(l+=o));for(let e=0;e<t.length;++e)t[e].x+=s,t[e].y+=l,r.push(t[e])}let o=1;for(;o<s.length;)l(s[o],!0,!1),l(s[o+1],!1,!0),l(s[o+2],!0,!0),o+=3,n=On(r);let h={};for(let t=0;t<r.length;++t)h[r[t].setId]=r[t];return h}(p,o,h),r-i,n-s,i,s),c)}return e.map(t=>{let e=eo(t[a]),i=e.toString(),r=d[i],s=Object.assign(Object.assign({},t),{datum:t,sets:e,key:i,size:t[l],labelX:null==r?void 0:r.x,labelY:null==r?void 0:r.y}),n=u[i];if(n)return Object.assign(Object.assign({},s),{type:"circle",x:n.x,y:n.y,radius:n.radius});let o=PQ(e.map(t=>u[t]));return Object.assign(Object.assign({},s),{type:"overlap",x:0,y:0,path:PJ(o),arcs:o})})},Oo=(t,e)=>e.filter(e=>e.type===t.datumType),Oh=(t,e)=>{let i=e.getViewBox();return i&&(null==t?void 0:t.length)?Ol(Object.assign({setField:e.setField,valueField:e.valueField},i),t):[]};class Ou extends cT{constructor(){super(...arguments),this.type=rw.venn,this.transformerConstructor=P4,this._viewBox=new pV}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec(),this.setCategoryField(null!=(t=this._spec.categoryField)?t:"sets"),this.setValueField(null!=(e=this._spec.valueField)?e:"size"),this.setSeriesField(null!=(i=this._spec.seriesField)?i:ni)}initData(){var t;super.initData(),sY(this._dataSet,"venn",Oh),null==(t=this._data.getDataView())||t.transform({type:"venn",options:{getViewBox:()=>this._viewBox.empty()?null:{x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2},setField:this._categoryField,valueField:this._valueField}})}compile(){super.compile(),this._runVennTransform()}_runVennTransform(t=!1){this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()}initMark(){let t=this._createMark(Ou.mark.circle,{isSeriesMark:!0});t&&(t.setTransform([{type:"vennMark",datumType:"circle"}]),this._circleMark=t);let e=this._createMark(Ou.mark.overlap,{isSeriesMark:!0});e&&(e.setTransform([{type:"vennMark",datumType:"overlap"}]),this._overlapMark=e)}initMarkStyle(){this._initCircleMarkStyle(),this._initOverlapMarkStyle()}_initCircleMarkStyle(){this._circleMark&&this.setMarkStyle(this._circleMark,{x:t=>t.x,y:t=>t.y,innerRadius:0,outerRadius:t=>t.radius,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),stroke:this.getColorAttribute()},V.STATE_NORMAL,H.Series)}_initOverlapMarkStyle(){this._overlapMark&&(this.setMarkStyle(this._overlapMark,{x:t=>t.x,y:t=>t.y,path:t=>t.path,arcs:t=>t.arcs,fill:this.getColorAttribute(),stroke:this.getColorAttribute(),zIndex:t=>100*t.sets.length},V.STATE_NORMAL,H.Series),this.setMarkStyle(this._overlapMark,{zIndex:t=>100*t.sets.length+1},V.STATE_HOVER,H.Series))}initLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("venn"),this.setMarkStyle(t,{x:t=>t.labelX,y:t=>t.labelY,text:t=>PU(t.sets),maxLineWidth:t=>{let{x:e,radius:i,labelX:r}=t;return Math.min(r-(e-i),e+i-r)}},V.STATE_NORMAL,H.Series))}initOverlapLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("venn"),this.setMarkStyle(t,{x:t=>t.labelX,y:t=>t.labelY,text:t=>PU(t.sets)},V.STATE_NORMAL,H.Series))}initTooltip(){this._tooltipHelper=new PG(this),this._circleMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circleMark),this._overlapMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._overlapMark)}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(){super.onLayoutEnd(),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runVennTransform()}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._circleMark,this._overlapMark]}getStatisticFields(){let t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}getGroupFields(){return null}dataToPosition(t,e){return{x:t.x,y:t.y}}dataToPositionX(t){return t.x}dataToPositionY(t){return t.y}valueToPosition(t,e){throw Error("Method not implemented.")}getStackGroupFields(){return[]}getStackValueField(){return null}_getSeriesInfo(t,e){let i=this.getDefaultShapeType();return e.map(e=>({key:PU(e),originalKey:e,style:this.getSeriesStyle({[t]:e}),shapeType:i}))}getSeriesFieldValue(t,e){return PU(super.getSeriesFieldValue(t,e))}legendSelectedFilter(t,e){if(t.type===rA.discreteLegend){let i=t.getLegendDefaultData(!0);if(0===e.length&&i.length)return[];if(e.length===i.length)return e;let r={};e.forEach(t=>{r[t]=!0});let s=i.filter(t=>!r[PU(t)]),n=i.filter(t=>!s.includes(t)&&s.some(e=>eo(e).every(e=>t.includes(e))));e=e.slice(),n.forEach(t=>{e.splice(e.indexOf(PU(t)),1)})}return e}initAnimation(){this.getMarksInType("arc").forEach(t=>{var e;t.setAnimationConfig(cv(null==(e=ig.getAnimationInKey("vennCircle"))?void 0:e(),cb(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("path").forEach(t=>{var e;t.setAnimationConfig(cv(null==(e=ig.getAnimationInKey("vennOverlap"))?void 0:e(),cb(t.name,this._spec,this._markAttributeContext)))})}}Ou.type=rw.venn,Ou.mark=PZ,Ou.builtInTheme={venn:{circle:{style:{opacity:.8},state:{hover:{opacity:1}}},overlap:{style:{opacity:.8},state:{hover:{opacity:1,stroke:"white",lineWidth:2}}},label:{visible:!0,style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"}}},overlapLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},Ou.transformerConstructor=P4;let Od=()=>{va(),yC(),P5(),uJ(),ig.registerGrammarTransform("vennMark",{transform:Oo}),ig.registerSeries(Ou.type,Ou)};class Oc extends fB{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["categoryField","valueField","circle","overlap","overlapLabel"])}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class Op extends fF{constructor(){super(...arguments),this.transformerConstructor=Oc,this.type="venn",this.seriesType=rw.venn}}Op.type="venn",Op.seriesType=rw.venn,Op.transformerConstructor=Oc;let Og=()=>{mg(),Od(),ig.registerChart(Op.type,Op)};class Of extends fP{_getDefaultSeriesSpec(t){return super._getDefaultSeriesSpec(t,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar","bandWidthField"])}transformSpec(t){super.transformSpec(t),nF(t)}_setDefaultXAxisSpec(t){return{orient:"bottom",type:"linear",label:{visible:!1}}}_setDefaultYAxisSpec(t){return{orient:"left",type:"linear"}}}class Om extends m8{constructor(){super(...arguments),this.type=rw.mosaic,this.transformerConstructor=m9}get bandWidthField(){return this._bandWidthField}getStack(){return!0}getPercent(){return this._spec.percent}getGroupFields(){return"vertical"===this.direction?this._specXField:this._specYField}setAttrFromSpec(){super.setAttrFromSpec();let t=this.getPercent();"horizontal"===this.direction?(t&&(this.setFieldX(ny),this.setFieldX2(nm)),this.setFieldY(nv),this.setFieldY2(n_)):(t&&(this.setFieldY(ny),this.setFieldY2(nm)),this.setFieldX(nv),this.setFieldX2(n_)),this._spec.bandWidthField&&(this._bandWidthField=this._spec.bandWidthField)}parseLabelStyle(t,e){if((null==e?void 0:e.filterByGroup)&&et(t.dataFilter)){let i=this.getGroupFields(),{field:r,type:s="max",filter:n}=e.filterByGroup;delete t.filterField;let a=i.indexOf(r);if(a<0)return;let l=a%2?"min"===s?"horizontal"===this.direction?this._fieldY2:this._fieldX2:"horizontal"===this.direction?this._fieldY:this._fieldX:"min"===s?"horizontal"===this.direction?this._fieldX2:this._fieldY2:"horizontal"===this.direction?this._fieldX:this._fieldY,o="min"===s?(t,e)=>{var i,r;return(null==(i=t.data)?void 0:i[l])<(null==(r=e.data)?void 0:r[l])}:(t,e)=>{var i,r;return(null==(i=t.data)?void 0:i[l])>(null==(r=e.data)?void 0:r[l])};t.dataFilter=t=>{let e={};return t.forEach(t=>{let i=t.data,s=null==i?void 0:i[r];et(s)||n&&!n(t)||e[s]&&!o(t,e[s])||(e[s]=t)}),t.filter(t=>{var i;let s=null==(i=t.data)?void 0:i[r];return e[s]&&e[s]===t})}}return t}}Om.type=rw.mosaic,Om.builtInTheme={mosaic:{label:{visible:!1,position:"center",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},bar:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}}}},Om.transformerConstructor=m9;let Oy=()=>{m4(),bk(),uJ(),fc(),ig.registerSeries(Om.type,Om)};class O_ extends fF{constructor(){super(...arguments),this.transformerConstructor=Of,this.type="mosaic",this.seriesType=rw.mosaic,this.handleAfterStackRegion=(t,e)=>{t.getSeries().forEach(t=>{let i=t.getStackData(),r=t.getStackValue(),s=t.getStackValueField();i&&s&&(dG(e[r],s),dZ(t,e[r]))})}}_beforeInit(){this._dataSet&&sY(this._dataSet,"stackSplit",fz)}_initStack(){this._stack=new fj(this,{afterStackRegion:this.handleAfterStackRegion}),this._stack.init()}_setModelOption(){this._modelOption.getDimensionInfo=f7,this._modelOption.getDimensionInfoByValue=f9,this._modelOption.getRectByDimensionData=ms}}O_.type="mosaic",O_.seriesType=rw.mosaic,O_.transformerConstructor=Of;let Ov=()=>{mc(),mg(),mm(),f0(),fW(),Oy(),ig.registerChart(O_.type,O_)};(tg=tP||(tP={})).middle="middle",tg.start="start",tg.end="end",tg.bothEnd="bothEnd",(tf=tO||(tO={})).middle="middle",tf.start="start",tf.end="end",(tm=tI||(tI={})).area_horizontal="area_horizontal",tm.area_vertical="area_vertical",tm.area_stack="area_stack",tm.line_horizontal="line_horizontal",tm.line_vertical="line_vertical",tm.line_stack="line_stack",tm.bar_horizontal="bar_horizontal",tm.bar_vertical="bar_vertical",tm.bar_stack="bar_stack",tm.rangeColumn_horizontal="rangeColumn_horizontal",tm.rangeColumn_vertical="rangeColumn_vertical",tm.rangeArea_horizontal="rangeArea_horizontal",tm.rangeArea_vertical="rangeArea_vertical",tm.linearProgress_horizontal="linearProgress_horizontal",tm.linearProgress_vertical="linearProgress_vertical",tm.linearProgress_stack="linearProgress_stack",tm.boxPlot_horizontal="boxPlot_horizontal",tm.boxPlot_vertical="boxPlot_vertical",tm.sankey_horizontal="sankey_horizontal",tm.sankey_vertical="sankey_vertical",tm.waterfall_horizontal="waterfall_horizontal",tm.waterfall_vertical="waterfall_vertical",tm.circularProgress_stack="circularProgress_stack",tm.radar_stack="radar_stack",tm.rose_stack="rose_stack",(ty=tR||(tR={}))[ty.success=0]="success",ty[ty.failed=1]="failed";let Ob=(t,e,i)=>{for(let r in t)switch(r){case"maxHeight":if(t5(t.maxHeight)&&e.height>t.maxHeight)return!1;break;case"minHeight":if(t5(t.minHeight)&&e.height<t.minHeight)return!1;break;case"maxWidth":if(t5(t.maxWidth)&&e.width>t.maxWidth)return!1;break;case"minWidth":if(t5(t.minWidth)&&e.width<t.minWidth)return!1;break;case"onResize":if(t5(t.onResize)&&!t.onResize(e,i))return!1}return!0},Ox=(t="chart",e,i,r,s,n)=>{let a=OS(t,s,n);return Object.assign(Object.assign({},a),{modelInfo:a.modelInfo.filter(t=>!!et(e)||eo(e).some(e=>tK(e)?e(t,i,r):n$(t.spec,e)))})},OS=(t="chart",e,i)=>{var r,s,n,a,l,o,h,u,d,c,p;let g={modelInfo:[]};if("chart"===t)g.isChart=!0,g.modelInfo.push({spec:e,type:"chart"});else if("region"===t)g.modelType="region",g.specKey="region",null==(r=e.region)||r.forEach((t,e)=>{g.modelInfo.push({spec:t,specPath:["region",e],type:"region"})});else if("series"===t)g.modelType="series",g.specKey="series",null==(s=e.series)||s.forEach((t,e)=>{g.modelInfo.push({spec:t,specPath:["series",e],type:t.type})});else if(Object.values(rw).includes(t))g.modelType="series",g.specKey="series",g.type=t,null==(n=e.series)||n.forEach((e,i)=>{e.type===t&&g.modelInfo.push({spec:e,specPath:["series",i],type:t})});else if(Object.values(rA).includes(t)){g.modelType="component",g.type=t,g.specKey=null==(a=ig.getComponentInKey(t))?void 0:a.specKey;let{specKey:r}=g,s=eo(null!=(o=null==(l=i.component)?void 0:l[r])?o:[]);null==(u=eo(null!=(h=e[r])?h:[]))||u.forEach((e,i)=>{let r=s[i];r&&r.type===t?g.modelInfo.push(Object.assign(Object.assign({},r),{spec:e})):e&&!1===e.visible&&g.modelInfo.push({type:t,spec:e})})}else{let r=ig.getComponents().filter(({cmp:e})=>e.specKey===t).map(({cmp:t})=>t.type);if(r.length>0){g.modelType="component",g.specKey=t;let s=eo(null!=(c=null==(d=i.component)?void 0:d[t])?c:[]);eo(null!=(p=e[t])?p:[]).forEach((t,e)=>{let i=s[e];i&&r.includes(i.type)&&g.modelInfo.push(Object.assign(Object.assign({},i),{spec:t}))})}}return g},Ok=(t,e,i,r)=>{let{spec:s,filter:n,filterType:a,forceAppend:l}=t,{isChart:o,modelType:h,specKey:u,type:d,modelInfo:c}=Ox(a,n,t,e,i,r);if(0===c.length&&!l)return{chartSpec:i,hasChanged:!1};let p=it({},i),g=tK(s)?s(c,t,e):s;for(let{spec:t,specPath:e}of c){if(o)return{chartSpec:it(p,g),hasChanged:!0};nY(p,e,it({},t,g))}if(0===c.length&&l){let t=Object.assign({type:d},g);tY(p[u])?p[u].push(t):et(p[u])?p[u]="component"===h?t:[t]:p[u]=[p[u],t]}return{chartSpec:p,hasChanged:!0}},OA=t=>t instanceof er||function(t){try{return t instanceof Element}catch(i){let e=Object.keys(t);return["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"].every(t=>e.includes(t))}}(t);function OM(t,e=["data"]){return t4(t,OA,e)}class Ow extends p8{constructor(){super(Ow.type),this.type="MediaQueryPlugin",this._currentMediaInfo={},this.currentActiveItems=new Set,this._initialized=!1}onInit(t,e){if(!(null==e?void 0:e[Ow.specKey]))return;let{globalInstance:i}=t;this._option={globalInstance:t.globalInstance,updateSpec:(t,e,r)=>{r?i.updateSpecSync(t):e?i.updateSpecAndRecompile(t,!1,{transformSpec:!0}):i.setRuntimeSpec(t)}},this._spec=e[Ow.specKey],this._initialized=!0}onBeforeResize(t,e,i){this._initialized&&this._changeSize(e,i,!0,!1)}onAfterChartSpecTransform(t,e,i){this._initialized&&"setCurrentTheme"===i&&this._reInit(!1,!1)}onAfterModelSpecTransform(t,e,i,r){this._initialized&&"updateSpec"===r&&this.onBeforeInitChart(t,e,"setCurrentTheme")}onBeforeInitChart(t,e,i){let r,s;if(this._initialized){switch(i){case"render":case"updateModelSpec":r=!1,s=!0;break;case"setCurrentTheme":r=!0,s=!1;break;case"updateSpecAndRecompile":r=!1,s=!1}if(r&&this.release(),this._initialized||this.onInit(t,e),r||s){let{width:t,height:e}=this._option.globalInstance.getCurrentSize();this._changeSize(t,e,!1,!1)}}}_changeSize(t,e,i,r){return(this._currentMediaInfo.width!==t||this._currentMediaInfo.height!==e)&&(this._currentMediaInfo.width=t,this._currentMediaInfo.height=e,this._applyQueries(i,r))}_applyQueries(t,e){let i,r,s=[],n=[];if(this._spec.forEach(t=>{let{hasChanged:e,isActive:i}=this._check(t);e&&(i?s.push(t):n.push(t))}),!s.length&&!n.length)return!1;this._baseChartSpec||(this._baseChartSpec=OM(this._option.globalInstance.getSpec(),["data",Ow.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo());let a=!1;return n.length>0?(i=OM(this._baseChartSpec,["data",Ow.specKey]),r=this._baseChartSpecInfo,Array.from(this.currentActiveItems).forEach(t=>{if(n.includes(t))return void this.currentActiveItems.delete(t);i=this._apply(t,i,r).chartSpec}),a=!0):(i=this._option.globalInstance.getSpec(),r=this._option.globalInstance.getSpecInfo()),s.forEach(t=>{this.currentActiveItems.add(t);let e=this._apply(t,i,r);i=e.chartSpec,a||(a=e.hasChanged)}),a&&this._option.updateSpec(i,t,e),!0}_check(t){let{globalInstance:e}=this._option,i=Ob(t.query,this._currentMediaInfo,e);return{isActive:i,hasChanged:i!==this.currentActiveItems.has(t)}}_apply(t,e,i){let{query:r,action:s}=t,n=!1;return eo(s).forEach(t=>{let s=Ok(t,r,e,i);e=s.chartSpec,n||(n=s.hasChanged)}),{chartSpec:e,hasChanged:n}}_reInit(t,e){let i=this._option.globalInstance.getSpec();this._baseChartSpec=OM(i,["data",Ow.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo();let r=!1;this.currentActiveItems.forEach(t=>{let e=this._apply(t,i,this._baseChartSpecInfo);i=e.chartSpec,r||(r=e.hasChanged)}),r&&this._option.updateSpec(i,t,e)}release(){super.release(),this._initialized=!1,this._spec=[],this._option=void 0,this._currentMediaInfo={},this.currentActiveItems.clear()}}Ow.pluginType="chart",Ow.specKey="media",Ow.type="MediaQueryPlugin";let OT=()=>{B1(Ow)};function OC(t,e=0){let i=0xdeadbeef^e;return i=(i=0xcc9e2d51*((i=(0x9e3779b9^i)+(i<<6)+(i>>2))^t))<<15|i>>>17,i^=i<<25,i+=i<<9,i^=i>>4,i^=i<<18,((i|=1)>>>0)%0x7fffffff/0x7fffffff}function OE(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI+2*OC(e*s+i)*Math.PI)+1)/2))}function OB(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-i/s*2*Math.PI)+1)/2))}function OP(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-(s-1-i)/s*2*Math.PI)+1)/2))}function OO(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-e/r*2*Math.PI)+1)/2))}function OI(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-(r-1-e)/r*2*Math.PI)+1)/2))}function OR(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-2*Math.sqrt(Math.pow((e-r/2)/r,2)+Math.pow((i-s/2)/s,2))*Math.PI)+1)/2))}function OL(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-(e/r+i/s)/2*2*Math.PI)+1)/2))}function OD(t,e,i,r,s,n,a,l=0,o=1){let h=Math.atan2(e-r/2,i-s/2);return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-(h<0?h+2*Math.PI:h)/(2*Math.PI)*2*Math.PI)+1)/2))}function OF(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI*3-2*(Math.sqrt(Math.pow(e-r/2,2)+Math.pow(i-s/2,2))/Math.sqrt(Math.pow(r/2,2)+Math.pow(s/2,2)))*Math.PI)+1)/2))}function Oz(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-(e+i)%(r+s)/(r+s)*4*Math.PI)+1)/2))}function Oj(t,e,i,r,s,n,a,l=0,o=1){return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-e/r*2*Math.PI)*Math.sin(2*n*Math.PI-i/s*2*Math.PI)+1)/2))}function OH(t,e,i,r,s,n,a,l=0,o=1){let h=r/2,u=s/2;return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-4*((Math.sqrt(Math.pow(e-h,2)+Math.pow(i-u,2))/Math.sqrt(Math.pow(r/2,2)+Math.pow(s/2,2))+Math.atan2(e-h,i-u)/(2*Math.PI))/2)*Math.PI)+1)/2))}function ON(t,e,i,r,s,n,a,l=0,o=1){let h=s/2;return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-Math.abs(i-h)/h*2*Math.PI)+1)/2))}function OV(t,e,i,r,s,n,a,l=0,o=1){let h=s/2;return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-2*(1-Math.abs(i-h)/h)*Math.PI)+1)/2))}function OW(t,e,i,r,s,n,a,l=0,o=1){let h=r/2;return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-Math.abs(e-h)/h*2*Math.PI)+1)/2))}function OU(t,e,i,r,s,n,a,l=0,o=1){let h=r/2;return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-2*(1-Math.abs(e-h)/h)*Math.PI)+1)/2))}function OG(t,e,i,r,s,n,a,l=0,o=1){let h=r/2,u=s/2;return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-2*Math.min(Math.sqrt(Math.pow((e-h)/h,2)+Math.pow((i-u)/u,2)),1)*Math.PI)+1)/2))}function OZ(t,e,i,r,s,n,a,l=0,o=1){let h=r/2,u=s/2;return Math.min(1,Math.max(0,l+o*(Math.sin(2*n*Math.PI-2*(1-Math.min(Math.sqrt(Math.pow((e-h)/h,2)+Math.pow((i-u)/u,2)),1))*Math.PI)+1)/2))}function O$(t,e,i,r,s,n,a,l=0,o=1){let h=r/2,u=s/2,d=Math.min(Math.sqrt(Math.pow((e-h)/h,2)+Math.pow((i-u)/u,2)),1),c=Math.max(0,1-d);return Math.min(1,Math.max(0,l+o*((Math.sin(2*n*Math.PI*3-4*d*Math.PI)+1)/2)*(.7*c+.3)))}function OY(t,e,i,r,s,n,a,l=0,o=1){let h=e*s+i,u=2*OC(h,0)*Math.PI,d=.5*OC(h,1)+.5,c=2*OC(h,2)*Math.PI,p=r/2,g=s/2,f=(n-.4)/.6,m=Math.sin(f*d*8*Math.PI+u+c*f),y=Math.cos(Math.min(Math.sqrt(Math.pow((e-p)/p,2)+Math.pow((i-g)/g,2)),1)*Math.PI+f*Math.PI);return Math.min(1,Math.max(0,l+(m+1)/2*Math.max(0,1-1.2*f)*(.3+.7*y)*o))}var OX=i(94160),OK=i(18367);function Oq(){let t=OK.X.getInstance();t.registerTransition("update","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),t.registerTransition("update","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),t.registerTransition("update","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),t.registerTransition("state","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),t.registerTransition("state","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),t.registerTransition("state","exit",()=>({allowTransition:!0,stopOriginalTransition:!0}))}class OQ{constructor(t,e,i,r,s){this.state=t,this.graphics=e,this.config=i||[],this.beforeExecute=r,this.afterExecute=s}execute(t,e){if(!this.graphics.length||!this.config.length)return void(null==e||e());this.beforeExecute&&this.beforeExecute(this.graphics);let i=0,r=this.graphics.length,s=()=>{++i>=r&&(this.afterExecute&&this.afterExecute(this.graphics),null==e||e())};this.graphics.forEach(t=>{if(!t)return void i++;"exit"===this.state&&(t.isExiting=!0);let e=this.config.length>1?this.config.map(e=>({name:this.state,animation:Object.assign(Object.assign({},e),{customParameters:t.context})})):{name:this.state,animation:Object.assign(Object.assign({},this.config[0]),{customParameters:t.context})};t.applyAnimationState([this.state],[e],s)})}executeOnGroup(t,e){if(!this.graphics.length||!this.config.length||!t)return void(null==e||e());this.beforeExecute&&this.beforeExecute(this.graphics);let i=this.config[0],r=[{name:this.state,animation:Object.assign({},i)}];r.forEach(t=>{t.animation.customParameters=(t,e)=>e.context}),t.applyAnimationState([this.state],r,()=>{this.afterExecute&&this.afterExecute(this.graphics),null==e||e()})}}class OJ{constructor(){this.name="verticalBarSplit"}shouldApply(t,e){var i,r;let s="rect"===t.type,n="vertical"===(null==(i=t.model)?void 0:i.direction),a=(null==(r=e.context)?void 0:r.diffAttrs)||{};return s&&n&&("x"in a||"width"in a||"x1"in a)&&("y"in a||"height"in a||"y1"in a)}split(t,e){var i;let r=(null==(i=e.context)?void 0:i.diffAttrs)||{},s={},n={};Object.entries(r).forEach(([t,e])=>{"x"===t||"width"===t||"x1"===t?s[t]=e:"y"===t||"height"===t||"y1"===t?n[t]=e:s[t]=e});let a=e.context,l=a.fieldX,o=a.originalFieldX,h=Array.isArray(l)&&l.length>1,u=(o?!(Array.isArray(o)&&o.length>1):!h)&&h;return[{attrs:s,order:u?1:2},{attrs:n,order:u?2:1}]}}class O0{constructor(){this.name="horizontalBarSplit"}shouldApply(t,e){var i,r;let s="rect"===t.type,n="horizontal"===(null==(i=t.model)?void 0:i.direction),a=(null==(r=e.context)?void 0:r.diffAttrs)||{};return s&&n&&("y"in a||"height"in a||"y1"in a)&&("x"in a||"width"in a||"x1"in a)}split(t,e){var i;let r=(null==(i=e.context)?void 0:i.diffAttrs)||{},s={},n={};Object.entries(r).forEach(([t,e])=>{"y"===t||"height"===t||"y1"===t?s[t]=e:"x"===t||"width"===t||"x1"===t?n[t]=e:s[t]=e});let a=e.context,l=a.fieldY,o=a.originalFieldY,h=Array.isArray(l)&&l.length>1,u=!(o?!(Array.isArray(o)&&o.length>1):!h)&&!h;return[{attrs:s,order:u?2:1},{attrs:n,order:u?1:2}]}}class O1{constructor(t){this.splitStrategies=[],this.mark=t,"rect"===t.type&&(this.registerStrategy(new OJ),this.registerStrategy(new O0))}registerStrategy(t){this.splitStrategies.push(t)}detect(t,e){let i=[],r=[],s=[],n=[],a=this.mark.model.fieldX,l=this.mark.model.fieldY;return t.forEach(t=>{let e=t.context;switch(e.fieldX&&(e.originalFieldX=e.fieldX),e.fieldY&&(e.originalFieldY=e.fieldY),e.fieldX=a,e.fieldY=l,t.context.animationState){case"update":r.push(t);break;case"enter":s.push(t);break;case"appear":n.push(t);break;default:t.context.diffState===N.exit?i.push(t):t.context.diffState===N.enter?s.push(t):r.push(t)}}),e.size>t.length&&e.forEach((t,e)=>{t.context.diffState!==N.exit||t.isExiting||i.push(t)}),{hasExit:i.length>0,hasUpdate:r.length>0,hasEnter:s.length>0,hasAppear:n.length>0,exitGraphics:i,updateGraphics:r,enterGraphics:s,appearGraphics:n}}createPlanners(t,e){let i=[];if(t.hasExit&&e.exit&&i.push(new OQ("exit",t.exitGraphics,e.exit)),t.hasUpdate&&e.update){let r=new Map,s=[];t.updateGraphics.forEach(t=>{let e=!1;for(let i of this.splitStrategies)if(i.shouldApply(this.mark,t)){let s=i.split(this.mark,t),n={graphic:t,steps:s};s.forEach(t=>{let{order:e}=t;r.has(e)||r.set(e,[]),r.get(e).push(n)}),e=!0;break}e||s.push(t)}),s.length>0&&i.push(new OQ("update",s,e.update));let n=Array.from(r.keys()).sort((t,e)=>t-e);n.forEach(t=>{let s=r.get(t);if(s&&s.length>0){let r=s.map(({graphic:e,steps:i})=>{let r=i.find(e=>e.order===t);return{graphic:e,attrs:(null==r?void 0:r.attrs)||{}}});i.push(new OQ("update",r.map(t=>t.graphic),e.update,t=>{t.forEach((t,e)=>{let i=r[e].attrs,s=t.context;s._originalDiffAttrs||(s._originalDiffAttrs=t.context.diffAttrs),t.context.diffAttrs=i})},e=>{t===n[n.length-1]&&e.forEach(t=>{let e=t.context;e._originalDiffAttrs&&(t.context.diffAttrs=e._originalDiffAttrs,delete e._originalDiffAttrs)})}))}})}return t.hasEnter&&e.enter&&i.push(new OQ("enter",t.enterGraphics,e.enter)),t.hasAppear&&e.appear&&i.push(new OQ("appear",t.appearGraphics,e.appear)),i}}class O2{registerAnimationSplitStrategy(t){this._grammarDetector||(this._grammarDetector=new O1(this)),this._grammarDetector.registerStrategy(t)}getGrammarDetector(){return this.initGrammarDetector(),this._grammarDetector}initGrammarDetector(){this._grammarDetector||(this._grammarDetector=new O1(this))}_runSequentialAnimations(t){this.initGrammarDetector();let e=this.getAnimationConfig(),i=this._grammarDetector.detect(t,this._graphicMap),r=this._grammarDetector.createPlanners(i,e);this._executePlanners(r,0)}_executePlanners(t,e){if(e>=t.length)return;let i=t[e];i.execute(this._product,()=>{this._executePlanners(t,e+1),"exit"===i.state&&i.graphics.forEach(t=>{t.isExiting&&(this._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release&&t.release())})})}}function O3(){cD(oa,O2)}let O5=dy},75365:function(t,e,i){"use strict";i.d(e,{r:()=>l});var r=i(36516),s=i(35437),n=i(72949),a=i(46511);class l{constructor(t=s.R.GenAutoIncrementId(),e=a.P,i){this.id=t,this.status=n.t.INITIAL,this._timeline=e,e.addAnimate(this),this.slience=i,this._startTime=0,this._duration=0,this._totalDuration=0,this._loopCount=0,this._currentLoop=0,this._bounce=!1,this._firstStep=null,this._lastStep=null,this._startProps={},this._endProps={},this._preventAttrs=new Set,this.currentTime=0,this.interpolateUpdateFunction=null,this.priority=0}getStartProps(){return this._startProps}getEndProps(){return this._endProps}setTimeline(t){this._timeline=t}getTimeline(){return this._timeline}get timeline(){return this._timeline}bind(t){return this.target=t,this.target.animates||(this.target.animates=new Map),this.target.animates.set(this.id,this),this.onRemove(()=>{this.stop(),this.target.animates.delete(this.id)}),this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.target.animationAttribute||(this.target.animationAttribute={}),this}to(t,e=300,i="linear"){let s=new r.h(n.T.to,t,e,i);return s.bind(this.target,this),this.updateStepAfterAppend(s),this}wait(t){let e=new r.o(n.T.wait,{},t,"linear");return e.bind(this.target,this),this.updateStepAfterAppend(e),this}updateStepAfterAppend(t){this._firstStep?this._lastStep.append(t):this._firstStep=t,this._lastStep=t,this.parseStepProps(t),this.updateDuration()}parseStepProps(t){this._lastStep&&(t.propKeys=t.propKeys||Object.keys(t.props),Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=null!=(i=t.props[e])?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}))}reSyncProps(){if(!this._lastStep)return;this._endProps={};let t=this._firstStep;for(;t;)Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=null!=(i=t.props[e])?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}),t=t.next}from(t,e=300,i="linear"){let s=new r.h(n.T.from,t,e,i);return this._firstStep?this._lastStep.append(s):this._firstStep=s,this._lastStep=s,this.updateDuration(),this}play(t){return t.bind(this.target,this),this.updateStepAfterAppend(t),this}pause(){this.status===n.t.RUNNING&&(this.status=n.t.PAUSED)}resume(){this.status===n.t.PAUSED&&(this.status=n.t.RUNNING)}onStart(t){var e;t?(this._onStart||(this._onStart=[]),this._onStart.push(t)):(null==(e=this._onStart)||e.forEach(t=>t()),Object.keys(this._endProps).forEach(t=>{this._startProps[t]=this.target.getComputedAttribute(t)}))}onEnd(t){var e;t?(this._onEnd||(this._onEnd=[]),this._onEnd.push(t)):null==(e=this._onEnd)||e.forEach(t=>t())}onFrame(t){t&&(this._onFrame||(this._onFrame=[]),this._onFrame.push(t))}onRemove(t){var e;t?(this._onRemove||(this._onRemove=[]),this._onRemove.push(t)):null==(e=this._onRemove)||e.forEach(t=>t())}preventAttr(t){this._preventAttrs.add(t),delete this._startProps[t],delete this._endProps[t];let e=this._firstStep;for(;e;)e.deleteSelfAttr(t),e=e.next}preventAttrs(t){t.forEach(t=>this._preventAttrs.add(t))}validAttr(t){return!this._preventAttrs.has(t)}runCb(t){var e;return null==(e=this._lastStep)||e.onEnd(t),this}startAt(t){return this._startTime=t,this}customInterpolate(t,e,i,r,s,n){return!1}getFromValue(){return this._startProps}getToValue(){return this._endProps}stop(t){let e=this._firstStep;for(;e;)e.stop(),e=e.next;this.status!==n.t.END&&this.onEnd(),this.status=n.t.END,this.target&&("start"===t?this.target.setAttributes(this._startProps):"end"===t?this.target.setAttributes(this._endProps):t&&this.target.setAttributes(t))}release(){this.status=n.t.END,this._onRemove&&this._onRemove.forEach(t=>t()),this._onStart=[],this._onFrame=[],this._onEnd=[],this._onRemove=[]}getDuration(){return this._duration}getStartTime(){return this._startTime}afterAll(t){if(!t||0===t.length)return this;let e=0;return t.forEach(t=>{let i=t.getStartTime()+t.getTotalDuration();e=Math.max(e,i)}),this.startAt(e)}after(t){if(!t)return this;let e=t.getStartTime()+t.getTotalDuration();return this.startAt(e)}parallel(t){return t&&this.startAt(t.getStartTime()),this}loop(t){return!0===t?t=1/0:!1===t&&(t=0),this._loopCount=t,this.updateDuration(),this}bounce(t){return this._bounce=t,this}advance(t){var e,i,r;if(this.status===n.t.END)return void console.warn("aaa 动画已经结束，不能推进");let s=this.currentTime+t;if(s<this._startTime)return void(this.currentTime=s);if(s>=this._startTime+this._totalDuration)return null==(e=this._lastStep)||e.onUpdate(!0,1,{}),null==(i=this._lastStep)||i.onEnd(),this.onEnd(),void(this.status=n.t.END);this.status=n.t.RUNNING,this.currentTime<=this._startTime&&this.onStart(),this.currentTime=s;let a=s-this._startTime,l=!1,o=!1;if(this._loopCount>0){a=(s-this._startTime)%this._duration;let t=Math.floor((s-this._startTime)/this._duration);l=t>this._currentLoop,this._currentLoop=t,(o=this._bounce&&t%2==1)&&(a=this._duration-a)}l&&!o&&this.target.setAttributes(this._startProps);let h=null;if(this._lastStep===this._firstStep)h=this._firstStep;else{let t=this._firstStep;for(;t;){let e=t.getStartTime(),i=t.getDuration();if(a>=e&&a<=e+i){h=t;break}t=t.next}}if(!h)return;h!==this.lastRunStep&&(null==(r=this.lastRunStep)||r.onEnd()),this.lastRunStep=h;let u=(a-h.getStartTime())/h.getDuration(),d=u>=1;h.update(d,u,{}),d&&(h.onEnd(),this.lastRunStep=null)}updateDuration(){this._lastStep?(this._duration=this._lastStep.getStartTime()+this._lastStep.getDuration(),this._totalDuration=this._duration*(this._loopCount+1)):this._duration=0}getTotalDuration(){return this._totalDuration}getLoop(){return this._loopCount}}},86389:function(t,e,i){"use strict";i.d(e,{L:()=>n});var r=i(16749);class s{constructor(t){this.tasks=[],this.started=!1,this.completed=0,this.totalDuration=0,this.onStartCallbacks=[],this.onEndCallbacks=[],this.onUpdateCallbacks=[],this.component=t}animate(t,e){return this.started?console.warn("Cannot add animations after animation has started"):this.tasks.push({graphic:t,config:e}),this}onStart(t){return this.onStartCallbacks.push(t),this}onEnd(t){return this.onEndCallbacks.push(t),this}onUpdate(t){return this.onUpdateCallbacks.push(t),this}start(){return this.started?console.warn("Animation has already started"):(this.started=!0,this.completed=0,this.onStartCallbacks.forEach(t=>t()),0===this.tasks.length?setTimeout(()=>{this.onEndCallbacks.forEach(t=>t())},0):this.tasks.forEach(t=>{let e=new r.a(t.graphic);e.onEnd(()=>{this.completed++,this.completed===this.tasks.length&&this.onEndCallbacks.forEach(t=>t())});let i=e.executeItem(t.config,t.graphic);t.animate=i,i.forEach(t=>{this.totalDuration=Math.max(this.totalDuration,t.getStartTime()+t.getDuration())})})),this}deleteSelfAttr(t){this.tasks.forEach(e=>{e.animate&&e.animate.forEach(e=>e.preventAttr(t))})}stop(t){return this.tasks.forEach(e=>{e.animate&&e.animate.forEach(e=>e.stop(t))}),this.started&&this.completed!==this.tasks.length&&(this.onEndCallbacks.forEach(t=>t()),this.completed=this.tasks.length),this}getDuration(){return this.totalDuration}}function n(t){return new s(t)}},72570:function(t,e,i){"use strict";i.d(e,{b:()=>s,v:()=>n});var r=i(85344);class s extends r.W{constructor(t,e,i,r,s){super(t,e,i,r,s),this.keys=["clipRange"],this.from={clipRange:0}}onFirstRun(){var t;super.onFirstRun();let{clipDimension:e}=(null==(t=this.params)?void 0:t.options)||{};e&&(this.target.attribute.clipRangeByDimension=e)}}class n extends r.U{constructor(t,e,i,r,s){super(t,e,i,r,s),this.keys=["clipRange"]}}},85344:function(t,e,i){"use strict";i.d(e,{U:()=>n,W:()=>s});var r=i(84564);class s extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i;super.onBind();let r=this.target.getFinalAttribute(),s=null!=(t=this.target.attribute)?t:{},n={},a=null!=(e=this.from)?e:{};this.keys.forEach(t=>{var e,i,l;n[t]=null!=(e=null==r?void 0:r[t])?e:1,a[t]=null!=(l=null!=(i=a[t])?i:s[t])?l:0});let l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),this.props=n,this.propKeys=this.keys,this.from=a,this.to=n,!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(a)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class n extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){super.onBind();let t=this.target.attribute,e={},i={};this.keys.forEach(r=>{var s;e[r]=0,i[r]=null!=(s=t[r])?s:1}),this.props=e,this.propKeys=this.keys,this.from=i,this.to=e,Object.assign(this.target.attribute,i),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}},84564:function(t,e,i){"use strict";i.d(e,{O:()=>n,r:()=>s});var r=i(36516);class s extends r.h{constructor(t,e,i,r,s){super("customAnimate",e,i,r),this.type="customAnimate",this.customFrom=t,this.params=s,this.from=t,this.to=e}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.onUpdate(t,r,i),this.syncAttributeUpdate()}setProps(t){this.props=t,this.propKeys=Object.keys(t),this.animate.reSyncProps()}}class n extends s{completeBind(t){this.setStartTime(0),this._animator&&this._animator.start(),this.setDuration(t.getDuration())}stop(){this._animator&&this._animator.stop()}}},66059:function(t,e,i){"use strict";i.d(e,{D:()=>n,U:()=>s});var r=i(85344);class s extends r.W{constructor(t,e,i,r,s){super(t,e,i,r,s),this.keys=["opacity","fillOpacity","strokeOpacity"],this.from={opacity:0,fillOpacity:0,strokeOpacity:0}}}class n extends r.U{constructor(t,e,i,r,s){super(t,e,i,r,s),this.keys=["opacity","fillOpacity","strokeOpacity"]}}},77632:function(t,e,i){"use strict";i.d(e,{$:()=>s});var r=i(84564);class s extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.from=null!=t?t:{}}onBind(){var t,e;super.onBind(),Object.keys(this.from).forEach(t=>{null==this.props[t]&&(this.props[t]=this.target.getGraphicAttribute(t))});let i=this.target.getFinalAttribute();"appear"===(null==(t=this.target.context)?void 0:t.animationState)&&i&&this.target.setAttributes(i),!1!==(null==(e=this.params.controlOptions)?void 0:e.immediatelyApply)&&this.target.setAttributes(this.from)}onFirstRun(){this.from=Object.assign(Object.assign({},this.getLastProps()),this.from);let t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.from[e]=null!=(i=this.from[e])?i:t[e]}),this.target.setAttributes(this.from)}deleteSelfAttr(t){super.deleteSelfAttr(t),delete this.from[t]}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.from,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.from[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}},61154:function(t,e,i){"use strict";i.d(e,{j2:()=>c,kj:()=>d});var r=i(84564),s=i(45273);let n=(t,e,i)=>{let r=t.getFinalAttribute();return e&&"anticlockwise"===e.orient?{from:{startAngle:null==r?void 0:r.endAngle},to:{startAngle:null==r?void 0:r.startAngle}}:{from:{endAngle:null==r?void 0:r.startAngle},to:{endAngle:null==r?void 0:r.endAngle}}},a=(t,e,i)=>{let r=t.getFinalAttribute();if(e&&"anticlockwise"===e.orient){let t=(0,s.Z)(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:t,endAngle:t},to:{startAngle:null==r?void 0:r.startAngle,endAngle:null==r?void 0:r.endAngle}}}let n=(0,s.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:n,endAngle:n},to:{startAngle:null==r?void 0:r.startAngle,endAngle:null==r?void 0:r.endAngle}}},l=(t,e,i)=>{var r;return!1!==(null!=(r=null==e?void 0:e.overall)&&r)?a(t,e):n(t,e)},o=(t,e,i)=>{let r=t.attribute;return e&&"anticlockwise"===e.orient?{from:{startAngle:r.startAngle},to:{startAngle:null==r?void 0:r.endAngle}}:{from:{endAngle:r.endAngle},to:{endAngle:null==r?void 0:r.startAngle}}},h=(t,e,i)=>{let r=t.attribute;if(e&&"anticlockwise"===e.orient){let t=(0,s.Z)(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:r.startAngle,endAngle:r.endAngle},to:{startAngle:t,endAngle:t}}}let n=(0,s.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:r.startAngle,endAngle:r.endAngle},to:{startAngle:n,endAngle:n}}};class u extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}determineUpdateFunction(){this.propKeys?this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this.valid=!1:this.valid=!1}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];let e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this._updateFunction=null}updateStartAngle(t){this.target.attribute.startAngle=this.from.startAngle+(this.to.startAngle-this.from.startAngle)*t}updateEndAngle(t){this.target.attribute.endAngle=this.from.endAngle+(this.to.endAngle-this.from.endAngle)*t}updateAngle(t){this.updateStartAngle(t),this.updateEndAngle(t)}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdateShapeAndBoundsTag())}}class d extends u{onBind(){var t,e;super.onBind();let{from:i,to:r}=l(this.target,this.params.options,this.params),s=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:i;this.props=r,this.propKeys=Object.keys(r).filter(t=>null!=r[t]),this.from=s,this.to=r;let n=this.target.getFinalAttribute();n&&this.target.setAttributes(n),this.target.setAttributes(s),this.determineUpdateFunction()}}class c extends u{onBind(){var t,e,i;super.onBind();let{from:r,to:s}=(t=this.target,e=this.params.options,this.params,!1!==(null!=(i=null==e?void 0:e.overall)&&i)?h(t,e):o(t,e));this.props=s,this.propKeys=Object.keys(s).filter(t=>null!=s[t]),this.from=null!=r?r:this.target.attribute,this.to=s,this.determineUpdateFunction()}}},75936:function(t,e,i){"use strict";i.d(e,{B:()=>o,W:()=>l});var r=i(21777),s=i(84564);let n=(t,e,i)=>{let s=t.getFinalAttribute();switch(null==e?void 0:e.direction){case"x":{let t=s.x,e=s.x1,i=s.width;return{from:(0,r.Z)(i)?{x:t+i/2,x1:void 0,width:0}:{x:(t+e)/2,x1:(t+e)/2,width:void 0},to:{x:t,x1:e,width:i}}}case"y":{let t=s.y,e=s.y1,i=s.height;return{from:(0,r.Z)(i)?{y:t+i/2,y1:void 0,height:0}:{y:(t+e)/2,y1:(t+e)/2,height:void 0},to:{y:t,y1:e,height:i}}}default:{let t=s.x,e=s.x1,i=s.width,n=s.y,a=s.y1,l=s.height,o={};return(0,r.Z)(i)?(o.x=t+i/2,o.width=0,o.x1=void 0):(o.x=(t+e)/2,o.x1=(t+e)/2,o.width=void 0),(0,r.Z)(l)?(o.y=n+l/2,o.height=0,o.y1=void 0):(o.y=(n+a)/2,o.y1=(n+a)/2,o.height=void 0),{from:o,to:{x:t,y:n,x1:e,y1:a,width:i,height:l}}}}},a=(t,e,i)=>{let s=t.attribute;switch(null==e?void 0:e.direction){case"x":{let t=s.x,e=s.x1,i=s.width;return{to:(0,r.Z)(i)?{x:t+i/2,x1:void 0,width:0}:{x:(t+e)/2,x1:(t+e)/2,width:void 0}}}case"y":{let t=s.y,e=s.y1,i=s.height;return{to:(0,r.Z)(i)?{y:t+i/2,y1:void 0,height:0}:{y:(t+e)/2,y1:(t+e)/2,height:void 0}}}default:{let t=s.x,e=s.y,i=s.x1,n=s.y1,a=s.width,l=s.height,o={};return(0,r.Z)(a)?(o.x=t+a/2,o.width=0,o.x1=void 0):(o.x=(t+i)/2,o.x1=(t+i)/2,o.width=void 0),(0,r.Z)(l)?(o.y=e+l/2,o.height=0,o.y1=void 0):(o.y=(e+n)/2,o.y1=(e+n)/2,o.height=void 0),{to:o}}}};class l extends s.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i;super.onBind();let{from:r,to:s}=n(this.target,this.params.options,this.params),a=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=s,this.propKeys=Object.keys(s).filter(t=>null!=s[t]),this.from=a,this.to=s;let l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(a)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class o extends s.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){super.onBind();let{from:t,to:e}=a(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(t=>null!=e[t]),this.from=null!=t?t:this.target.attribute,this.to=e}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}},41520:function(t,e,i){"use strict";i.d(e,{HQ:()=>o,qG:()=>h});var r=i(21777),s=i(35652),n=i(45273),a=i(84564);let l=(t,e,i)=>{var a;return!1!==(null!=(a=null==e?void 0:e.overall)&&a)?function(t,e,i){var r,a,l;let o,h=t.getFinalAttribute(),u=h.y,d=h.y1,c=h.height;return e&&"negative"===e.orient?(0,n.Z)(e.overall)?o=e.overall:i.group?(o=null!=(l=null!=(r=i.groupHeight)?r:null==(a=e.layoutRect)?void 0:a.height)?l:i.group.getBounds().height(),i.groupHeight=o):o=i.height:o=(0,n.Z)(null==e?void 0:e.overall)?e.overall:0,{from:{y:o,y1:(0,s.Z)(d)?void 0:o,height:(0,s.Z)(c)?void 0:0},to:{y:u,y1:d,height:c}}}(t,e,i):function(t,e,i){let n=t.getFinalAttribute(),a=n.y,l=n.y1,o=n.height;if(e&&"negative"===e.orient){let t=(0,r.Z)(o)?Math.max(a,a+o):Math.max(a,l);return{from:{y:t,y1:(0,s.Z)(l)?void 0:t,height:(0,s.Z)(o)?void 0:0},to:{y:a,y1:l,height:o}}}let h=(0,r.Z)(o)?Math.min(a,a+o):Math.min(a,l);return{from:{y:h,y1:(0,s.Z)(l)?void 0:h,height:(0,s.Z)(o)?void 0:0},to:{y:a,y1:l,height:o}}}(t,e,0)};class o extends a.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i;super.onBind();let{from:r,to:s}=l(this.target,this.params.options,this.params),n=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:r;this.props=s,this.propKeys=Object.keys(s).filter(t=>null!=s[t]),this.from=n,this.to=s;let a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),!1!==(null==(i=this.params.controlOptions)?void 0:i.immediatelyApply)&&this.target.setAttributes(n)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class h extends a.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i,a;super.onBind();let{from:l,to:o}=(t=this.target,e=this.params.options,i=this.params,!1!==(null!=(a=null==e?void 0:e.overall)&&a)?function(t,e,i){var r,a,l;let o,h=t.getFinalAttribute(),u=h.y1,d=h.height;return e&&"negative"===e.orient?(0,n.Z)(e.overall)?o=e.overall:i.group?(o=null!=(l=null!=(r=i.groupHeight)?r:null==(a=e.layoutRect)?void 0:a.height)?l:i.group.getBounds().height(),i.groupHeight=o):o=i.height:o=(0,n.Z)(null==e?void 0:e.overall)?e.overall:0,{to:{y:o,y1:(0,s.Z)(u)?void 0:o,height:(0,s.Z)(d)?void 0:0}}}(t,e,i):function(t,e,i){let n=t.getFinalAttribute(),a=n.y,l=n.y1,o=n.height;if(e&&"negative"===e.orient){let t=(0,r.Z)(o)?Math.max(a,a+o):Math.max(a,l);return{to:{y:t,y1:(0,s.Z)(l)?void 0:t,height:(0,s.Z)(o)?void 0:0}}}let h=(0,r.Z)(o)?Math.min(a,a+o):Math.min(a,l);return{to:{y:h,y1:(0,s.Z)(l)?void 0:h,height:(0,s.Z)(o)?void 0:0}}}(t,e,0));this.props=o,this.propKeys=Object.keys(o).filter(t=>null!=o[t]),this.from=null!=l?l:this.target.attribute,this.to=o}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}},33503:function(t,e,i){"use strict";i.d(e,{$m:()=>g,Kk:()=>h,Yf:()=>u,rf:()=>_,xJ:()=>p,yQ:()=>y});var r=i(37967),s=i(70501),n=i(84564);let a=(t,e,i)=>{let r=t.getFinalAttribute().points,n={x:0,y:0};return r.forEach(t=>{n.x+=t.x,n.y+=t.y}),n.x/=r.length,n.y/=r.length,e&&e.center&&((0,s.Z)(e.center.x)&&(n.x=e.center.x),(0,s.Z)(e.center.y)&&(n.y=e.center.y)),"area"===t.type&&(n.x1=n.x,n.y1=n.y),r.map(t=>Object.assign({},t,n))},l=(t,e,i)=>{let r=t.getFinalAttribute();return{from:{points:a(t,e)},to:{points:r.points}}};class o extends n.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onUpdate(t,e,i){var s,n;let a=null==(s=this.from)?void 0:s.points,l=null==(n=this.to)?void 0:n.points;a&&l&&(this.target.attribute.points=a.map((t,i)=>(0,r.q9)(a[i],l[i],e)),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag())}}class h extends o{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:e,to:i}=l(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}else this.valid=!1}}class u extends o{onBind(){var t,e;if(super.onBind(),["area","line"].includes(this.target.type)){let i=this.target.getFinalAttribute(),{from:r,to:s}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:a(t,e)}});this.props=s,this.propKeys=Object.keys(s).filter(t=>null!=s[t]),this.from=r||i,this.to=s}else this.valid=!1}}let d=(t,e,i)=>t.getFinalAttribute().points.map(i=>{if(e&&"negative"===e.orient){let e=t.stage.viewWidth;return t.parent.parent.parent&&(e=t.parent.parent.parent.AABBBounds.width()),Object.assign(Object.assign({},i),{x:e,y:i.y,x1:e,y1:i.y1,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:0,y:i.y,x1:0,y1:i.y1,defined:!1!==i.defined})}),c=(t,e,i)=>{let r=t.getFinalAttribute();return{from:{points:d(t,e)},to:{points:r.points}}};class p extends o{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:e,to:i}=c(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}else this.valid=!1}}class g extends o{onBind(){var t,e;if(super.onBind(),["area","line"].includes(this.target.type)){let i=this.target.getFinalAttribute(),{from:r,to:s}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:d(t,e)}});this.props=s,this.propKeys=Object.keys(s).filter(t=>null!=s[t]),this.from=r||i,this.to=s}else this.valid=!1}}let f=(t,e,i)=>t.getFinalAttribute().points.map(i=>{if(e&&"negative"===e.orient){let e=t.stage.viewHeight;return t.parent.parent.parent&&(e=t.parent.parent.parent.AABBBounds.height()),Object.assign(Object.assign({},i),{x:i.x,y:e,x1:i.x1,y1:e,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:i.x,y:0,x1:i.x1,y1:0,defined:!1!==i.defined})}),m=(t,e,i)=>{let r=t.getFinalAttribute();return{from:{points:f(t,e)},to:{points:r.points}}};class y extends o{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:e,to:i}=m(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}else this.valid=!1}}class _ extends o{onBind(){var t,e;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){let{from:i,to:r}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:f(t,e)}});this.props=r,this.propKeys=Object.keys(r).filter(t=>null!=r[t]),this.from=null!=i?i:this.target.attribute,this.to=r}else this.valid=!1}}},25819:function(t,e,i){"use strict";i.d(e,{$:()=>d,em:()=>c});var r=i(84564),s=i(45273);let n=(t,e,i)=>{let r=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==r?void 0:r.outerRadius},to:{innerRadius:null==r?void 0:r.innerRadius}}:{from:{outerRadius:null==r?void 0:r.innerRadius},to:{outerRadius:null==r?void 0:r.outerRadius}}},a=(t,e,i)=>{let r=t.getFinalAttribute(),n=(0,s.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:n,outerRadius:n},to:{innerRadius:null==r?void 0:r.innerRadius,outerRadius:null==r?void 0:r.outerRadius}}},l=(t,e,i)=>{var r;return!1!==(null!=(r=null==e?void 0:e.overall)&&r)?a(t,e):n(t,e)},o=(t,e,i)=>{let r=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==r?void 0:r.innerRadius},to:{innerRadius:null==r?void 0:r.outerRadius}}:{from:{outerRadius:null==r?void 0:r.outerRadius},to:{outerRadius:null==r?void 0:r.innerRadius}}},h=(t,e,i)=>{let r=t.getFinalAttribute(),n=(0,s.Z)(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:null==r?void 0:r.innerRadius,outerRadius:null==r?void 0:r.outerRadius},to:{innerRadius:n,outerRadius:n}}};class u extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class d extends u{onBind(){var t,e;super.onBind();let{from:i,to:r}=l(this.target,this.params.options,this.params),s=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:i;this.props=r,this.propKeys=Object.keys(r).filter(t=>null!=r[t]),this.from=s,this.to=r;let n=this.target.getFinalAttribute();n&&this.target.setAttributes(n),this.target.setAttributes(s)}}class c extends u{onBind(){var t,e,i;super.onBind();let{to:r}=(t=this.target,e=this.params.options,this.params,!1!==(null!=(i=null==e?void 0:e.overall)&&i)?h(t,e):o(t,e));this.props=r,this.propKeys=Object.keys(r).filter(t=>null!=r[t]),this.from=this.target.attribute,this.to=r}}},7660:function(t,e,i){"use strict";i.d(e,{dR:()=>o,yi:()=>h});var r=i(21777),s=i(35652),n=i(45273),a=i(84564);let l=(t,e,i)=>{var a;return!1!==(null!=(a=null==e?void 0:e.overall)&&a)?function(t,e,i){var r;let a,l=t.getFinalAttribute(),o=l.x,h=l.x1,u=l.width;return e&&"negative"===e.orient?(0,n.Z)(e.overall)?a=e.overall:i.group?(a=null!=(r=i.groupWidth)?r:i.group.getBounds().width(),i.groupWidth=a):a=i.width:a=(0,n.Z)(null==e?void 0:e.overall)?null==e?void 0:e.overall:0,{from:{x:a,x1:(0,s.Z)(h)?void 0:a,width:(0,s.Z)(u)?void 0:0},to:{x:o,x1:h,width:u}}}(t,e,i):function(t,e,i){let n=t.getFinalAttribute(),a=n.x,l=n.x1,o=n.width;if(e&&"negative"===e.orient){let t=(0,r.Z)(o)?Math.max(a,a+o):Math.max(a,l);return{from:{x:t,x1:(0,s.Z)(l)?void 0:t,width:(0,s.Z)(o)?void 0:0},to:{x:a,x1:l,width:o}}}let h=(0,r.Z)(o)?Math.min(a,a+o):Math.min(a,l);return{from:{x:h,x1:(0,s.Z)(l)?void 0:h,width:(0,s.Z)(o)?void 0:0},to:{x:a,x1:l,width:o}}}(t,e,0)};class o extends a.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e;super.onBind();let{from:i,to:r}=l(this.target,this.params.options,this.params),s=null!=(e=null==(t=this.target.context)?void 0:t.lastAttrs)?e:i;this.props=r,this.propKeys=Object.keys(r).filter(t=>null!=r[t]),this.from=s,this.to=r;let n=this.target.getFinalAttribute();n&&this.target.setAttributes(n),this.target.setAttributes(s)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class h extends a.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i,a;super.onBind();let{from:l,to:o}=(t=this.target,e=this.params.options,i=this.params,!1!==(null!=(a=null==e?void 0:e.overall)&&a)?function(t,e,i){var r;let a,l=t.getFinalAttribute(),o=l.x1,h=l.width;return e&&"negative"===e.orient?(0,n.Z)(e.overall)?a=e.overall:i.group?(a=null!=(r=i.groupWidth)?r:i.group.getBounds().width(),i.groupWidth=a):a=i.width:a=(0,n.Z)(null==e?void 0:e.overall)?e.overall:0,{to:{x:a,x1:(0,s.Z)(o)?void 0:a,width:(0,s.Z)(h)?void 0:0}}}(t,e,i):function(t,e,i){let n=t.getFinalAttribute(),a=n.x,l=n.x1,o=n.width;if(e&&"negative"===e.orient){let t=(0,r.Z)(o)?Math.max(a,a+o):Math.max(a,l);return{to:{x:t,x1:(0,s.Z)(l)?void 0:t,width:(0,s.Z)(o)?void 0:0}}}let h=(0,r.Z)(o)?Math.min(a,a+o):Math.min(a,l);return{to:{x:h,x1:(0,s.Z)(l)?void 0:h,width:(0,s.Z)(o)?void 0:0}}}(t,e,0));this.props=o,this.propKeys=Object.keys(o).filter(t=>null!=o[t]),this.from=null!=l?l:this.target.attribute,this.to=o}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}},42100:function(t,e,i){"use strict";i.d(e,{V8:()=>h,vW:()=>u});var r=i(98116),s=i(70501),n=i(84564);let a=(t,e,i)=>{var n,a,l,o;let{offset:h=0,orient:u,direction:d,point:c,excludeChannels:p=[],layoutRect:g={}}=null!=e?e:{},f=0,m=0;"negative"===u&&(f=null!=(n=g.width)?n:t.stage.viewWidth,m=null!=(a=g.height)?a:t.stage.viewHeight),f+=h,m+=h;let y=(0,r.Z)(c)?c.call(null,null==(o=null==(l=t.context)?void 0:l.data)?void 0:o[0],t,i):c,_=t.getGraphicAttribute("x"),v=t.getGraphicAttribute("y"),b=p.includes("x")?_:y&&(0,s.Z)(y.x)?y.x:f,x=p.includes("y")?v:y&&(0,s.Z)(y.y)?y.y:m;switch(d){case"x":return{from:{x:p.includes("x")?_:b},to:{x:_}};case"y":return{from:{y:x},to:{y:v}};default:return{from:{x:b,y:x},to:{x:_,y:v}}}},l=(t,e,i)=>{var n,a,l,o;let{offset:h=0,orient:u,direction:d,point:c}=null!=e?e:{},p=i.group?i.group.AABBBounds:null,g=null!=(n=p.width())?n:i.width,f=null!=(a=p.height())?a:i.height,m=(0,r.Z)(c)?c.call(null,null==(o=null==(l=t.context)?void 0:l.data)?void 0:o[0],t,i):c,y=m&&(0,s.Z)(m.x)?m.x:("negative"===u?g:0)+h,_=m&&(0,s.Z)(m.y)?m.y:("negative"===u?f:0)+h;switch(d){case"x":return{from:{x:t.getGraphicAttribute("x")},to:{x:y}};case"y":return{from:{y:t.getGraphicAttribute("y")},to:{y:_}};default:return{from:{x:t.getGraphicAttribute("x"),y:t.getGraphicAttribute("y")},to:{x:y,y:_}}}};class o extends n.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class h extends o{onBind(){var t;super.onBind();let{from:e,to:i}=a(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(t=>null!=i[t]),this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}}class u extends o{onBind(){super.onBind();let{from:t,to:e}=l(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(t=>null!=e[t]),this.from=t,this.to=e}}},92164:function(t,e,i){"use strict";i.d(e,{B:()=>s});var r=i(84564);class s extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.formatTemplate=null,this.decimalLength=null==s?void 0:s.decimalLength,(null==s?void 0:s.formatTemplate)&&s.formatTemplate.includes("{{var}}")&&(this.formatTemplate=s.formatTemplate)}onFirstRun(){var t,e,i;let r=this.getLastProps(),s=this.getEndProps(),n=null!=(t=r.text)?t:0,a=null!=(e=s.text)?e:0;this.valid=!0;let l=0,o=0,h="",u="",d=0;if("number"==typeof n)l=n,d=Math.max(d,(n.toString().split(".")[1]||"").length);else{if("string"!=typeof n)return void(this.valid=!1);if(n.endsWith("%")){h="%";let t=n.substring(0,n.length-1).replace(/,/g,"");if(isNaN(l=parseFloat(t)/100))return void(this.valid=!1);d=Math.max(d,(t.split(".")[1]||"").length+2)}else{let t=n.replace(/,/g,"");if(isNaN(l=parseFloat(t)))return void(this.valid=!1);n.includes(",")&&(h=","),d=Math.max(d,(t.split(".")[1]||"").length)}}if("number"==typeof a)o=a,d=Math.max(d,(a.toString().split(".")[1]||"").length);else{if("string"!=typeof a)return void(this.valid=!1);if(a.endsWith("%")){u="%";let t=a.substring(0,a.length-1).replace(/,/g,"");if(isNaN(o=parseFloat(t)/100))return void(this.valid=!1);d=Math.max(d,(t.split(".")[1]||"").length+2)}else{let t=a.replace(/,/g,"");if(isNaN(o=parseFloat(t)))return void(this.valid=!1);a.includes(",")&&(u=","),d=Math.max(d,(t.split(".")[1]||"").length)}}if(null==(i=this.params)?void 0:i.format){switch(this.params.format){case"percent":this.format="%";break;case"thousandth":this.format=",";break;case"none":this.format="";break;default:this.format=u||h}"%"===this.format&&"%"!==u&&"%"!==h&&void 0===this.decimalLength&&(this.decimalLength=2),"%"===this.format||"%"!==u&&"%"!==h||(l*=100,o*=100)}else this.format=u||h;this.fromNumber=l,this.toNumber=o,void 0===this.decimalLength&&(this.decimalLength=d)}onEnd(t){super.onEnd(t),t||this.props&&this.target.setAttributes(this.props)}onUpdate(t,e,i){if(!this.valid)return;let r=this.fromNumber+(this.toNumber-this.fromNumber)*e,s="",n=this.format,a=("%"===n?100*r:r).toFixed(this.decimalLength),l,o=a;if(parseFloat(a)===Math.floor(parseFloat(a))&&(o=Math.floor(parseFloat(a))),"%"===n)l=`${o}%`;else if(","===n){let t=o.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),l=t.join(".")}else l=o;s=this.formatTemplate?this.formatTemplate.replace("{{var}}",l.toString()):l,this.target.setAttribute("text",s)}}},94160:function(t,e,i){"use strict";i.d(e,{Hp:()=>$});var r=i(16749),s=i(72570),n=i(66059),a=i(61154),l=i(75936),o=i(41520),h=i(33503),u=i(25819),d=i(7660),c=i(84564);class p extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.fromText="",this.toText="",this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",void 0!==(null==s?void 0:s.showCursor)&&(this.showCursor=s.showCursor),void 0!==(null==s?void 0:s.cursorChar)&&(this.cursorChar=s.cursorChar),void 0!==(null==s?void 0:s.blinkCursor)&&(this.blinkCursor=s.blinkCursor),void 0!==(null==s?void 0:s.beforeText)&&(this.beforeText=s.beforeText),void 0!==(null==s?void 0:s.afterText)&&(this.afterText=s.afterText)}onFirstRun(){var t,e;let i=this.getLastProps(),r=this.getEndProps(),s=null!=(t=i.text)?t:"",n=null!=(e=r.text)?e:"";this.valid=!0,this.fromText=s.toString(),this.toText=n.toString(),this.toText||""===this.toText||(this.valid=!1)}onEnd(t){super.onEnd(t),t||(this.showCursor&&!this.blinkCursor?this.target.setAttribute("text",this.beforeText+this.toText+this.cursorChar+this.afterText):this.target.setAttribute("text",this.beforeText+this.toText+this.afterText))}onUpdate(t,e,i){let r,s;if(!this.valid)return;let n=this.toText.length,a=this.fromText.length;a>n?(r=Math.round(a-(a-n)*e),s=this.fromText.substring(0,r)):(r=Math.round(a+(n-a)*e),s=this.toText.startsWith(this.fromText)?this.toText.substring(0,r):r<=a?this.fromText.substring(0,r):this.toText.substring(0,r-a+Math.min(a,r)));let l=this.beforeText+s+this.afterText;this.showCursor&&(this.blinkCursor?Math.floor(e/.1)%2==0&&(l=this.beforeText+s+this.cursorChar+this.afterText):l=this.beforeText+s+this.cursorChar+this.afterText),this.target.setAttribute("text",l)}}var g=i(86389);class f extends c.O{onBind(){let t,e;super.onBind();let i=(0,g.L)(this.target);this._animator=i;let r=this.duration,s=this.easing,n=this.target,{symbolStartOuterType:a="scale",titleType:l="typewriter",titlePanelType:o="scale"}=this.params,h=r/10;if(n._symbolStart.setAttributes({scaleX:0,scaleY:0}),i.animate(n._symbolStart,{type:"to",to:{scaleX:1,scaleY:1},duration:5*h,easing:s}),"scale"===a?(t={scaleX:0,scaleY:0},e={scaleX:1,scaleY:1}):(t={clipRange:0},e={clipRange:1}),n._symbolStartOuter.setAttributes(t),i.animate(n._symbolStartOuter,{type:"to",to:e,duration:5*h,easing:s}),n._symbolEnd.setAttributes({scaleX:0,scaleY:0}),i.animate(n._symbolEnd,{type:"to",to:{scaleX:1,scaleY:1},duration:2*h,delay:8*h,easing:s}),n._line.setAttributes({clipRange:0}),i.animate(n._line,{type:"to",to:{clipRange:1},duration:9*h,easing:s}),"typewriter"===l){let t=n._titleTop.attribute.text;n._titleTop.setAttributes({text:""}),i.animate(n._titleTop,{type:"custom",delay:5*h,duration:4*h,easing:"linear",to:{text:t},custom:p});let e=n._titleBottom.attribute.text;n._titleBottom.setAttributes({text:""}),i.animate(n._titleBottom,{type:"custom",delay:5*h,duration:4*h,easing:"linear",to:{text:e},custom:p})}else n._titleTop.setAttributes({dy:n._titleTop.AABBBounds.height()+10}),i.animate(n._titleTop,{type:"to",to:{dy:0},delay:5*h,duration:4*h,easing:"linear"}),n._titleBottom.setAttributes({dy:-(10+n._titleBottom.AABBBounds.height())}),i.animate(n._titleBottom,{type:"to",to:{dy:0},delay:5*h,duration:4*h,easing:"linear"});"scale"===o?[n._titleTopPanel,n._titleBottomPanel].forEach(t=>{var e;let n=null!=(e=t.attribute.scaleX)?e:1;t.setAttributes({scaleX:0}),i.animate(t,{type:"to",to:{scaleX:n},duration:r,easing:s})}):"stroke"===o&&[n._titleTopPanel,n._titleBottomPanel].forEach(t=>{let e=t.AABBBounds,n=2*(e.width()+e.height());t.setAttributes({lineDash:[0,10*n]}),i.animate(t,{type:"to",to:{lineDash:[n,10*n]},duration:r,easing:s})}),this.completeBind(i)}}class m extends c.O{onBind(){super.onBind();let t=(0,g.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,r=this.target,{mode:s}=this.params;"scale"===s?t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}):(t.animate(r._line,{type:"to",to:{clipRange:0},duration:e,easing:i}),t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._symbolEnd,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),t.animate(r._titleTop,{type:"to",to:{dy:r._titleTop.AABBBounds.height()+10},duration:e/2,easing:i}),t.animate(r._titleBottom,{type:"to",to:{dy:-(10+r._titleBottom.AABBBounds.height())},duration:e/2,easing:i}),t.animate(r._symbolStartOuter,{type:"to",to:{clipRange:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._titleTopPanel,{type:"to",to:{scaleX:0},duration:e,easing:i}),t.animate(r._titleBottomPanel,{type:"to",to:{scaleX:0},duration:e,easing:i})),this.completeBind(t)}}var y=i(92164);class _ extends c.O{onBind(){super.onBind();let t=(0,g.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,r=this.target,{wave:s}=this.params;if(r.setAttributes({scaleX:0,scaleY:0}),t.animate(r,{type:"to",to:{scaleX:1,scaleY:1},duration:e/3*2,easing:i}),r.titleShape&&t.animate(r.titleShape,{type:"custom",to:{text:r.titleShape.attribute.text},duration:e,easing:i,custom:p}),r.contentShape&&t.animate(r.contentShape,{type:"custom",to:{text:r.contentShape.attribute.text},duration:e,easing:i,custom:p}),s){let n=e/6;t.animate(r.group,{timeSlices:[{duration:n,effects:{type:"to",to:{angle:s},easing:i}},{duration:2*n,effects:{type:"to",to:{angle:-s},easing:i}},{duration:2*n,effects:{type:"to",to:{angle:s},easing:i}},{duration:n,effects:{type:"to",to:{angle:0},easing:i}}]})}this.completeBind(t)}}class v extends c.O{onBind(){super.onBind();let t=(0,g.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,r=this.target;t.animate(r,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),this.completeBind(t)}}var b=i(93342);class x extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.fadeInChars=!1,this.fadeInDuration=.3,this.strokeFirst=!1,this.strokeToFillRatio=.3,void 0!==(null==s?void 0:s.showCursor)&&(this.showCursor=s.showCursor),void 0!==(null==s?void 0:s.cursorChar)&&(this.cursorChar=s.cursorChar),void 0!==(null==s?void 0:s.blinkCursor)&&(this.blinkCursor=s.blinkCursor),void 0!==(null==s?void 0:s.fadeInChars)&&(this.fadeInChars=s.fadeInChars),void 0!==(null==s?void 0:s.fadeInDuration)&&(this.fadeInDuration=s.fadeInDuration),void 0!==(null==s?void 0:s.strokeFirst)&&(this.strokeFirst=s.strokeFirst),void 0!==(null==s?void 0:s.strokeToFillRatio)&&(this.strokeToFillRatio=s.strokeToFillRatio)}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?b.H.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=b.H.TransformTextConfig2SingleCharacter(this.originalTextConfig)):this.valid=!1}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){let r,s;if(!this.valid)return;let n=this.toTextConfig.length,a=this.fromTextConfig.length,l=this.fadeInChars?1-this.fadeInDuration:1;if(r=a>n?Math.round(a-(a-n)*e):this.fadeInChars?Math.round(a+(n-a)*Math.min(1,e/l)):Math.round(a+(n-a)*e),s=a>n?this.fromTextConfig.slice(0,r):this.toTextConfig.slice(0,r).map((t,i)=>{if("text"in t){let r=Object.assign({},t);if(this.strokeFirst){let t=i/n*l,s=Math.max(0,e-t),a=1-t,o=Math.min(1,s/(this.strokeToFillRatio*a));"fill"in r&&r.fill&&(r.stroke=r.fill,o<1&&(r.fillOpacity=o)),this.fadeInChars&&(r.opacity=Math.max(0,Math.min(1,Math.min(1,s/(this.fadeInDuration*a)))))}else this.fadeInChars&&(r.opacity=Math.max(0,Math.min(1,(e-i/n*l)/this.fadeInDuration)));return r}return t}),this.showCursor&&r<n){let t=!0;if(this.blinkCursor&&(t=Math.floor(e/.1)%2==0),t&&s.length>0){let t=s.length-1,e=s[t];if("text"in e)s[t]=Object.assign(Object.assign({},e),{text:String(e.text)+this.cursorChar});else{let t={text:this.cursorChar,fontSize:16};s.push(t)}}}this.target.setAttribute("textConfig",s)}}class S extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",this.fadeOutChars=!1,this.fadeOutDuration=.3,this.direction="backward",void 0!==(null==s?void 0:s.showCursor)&&(this.showCursor=s.showCursor),void 0!==(null==s?void 0:s.cursorChar)&&(this.cursorChar=s.cursorChar),void 0!==(null==s?void 0:s.blinkCursor)&&(this.blinkCursor=s.blinkCursor),void 0!==(null==s?void 0:s.beforeText)&&(this.beforeText=s.beforeText),void 0!==(null==s?void 0:s.afterText)&&(this.afterText=s.afterText),void 0!==(null==s?void 0:s.fadeOutChars)&&(this.fadeOutChars=s.fadeOutChars),void 0!==(null==s?void 0:s.fadeOutDuration)&&(this.fadeOutDuration=s.fadeOutDuration),void 0!==(null==s?void 0:s.direction)&&(this.direction=s.direction),this.propKeys=["textConfig"]}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=b.H.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?b.H.TransformTextConfig2SingleCharacter(e.textConfig):[]):this.valid=!1}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){let r;if(!this.valid)return;let s=this.fromTextConfig.length,n=this.fadeOutChars?1-this.fadeOutDuration:1;if("forward"===this.direction){r=this.fadeOutChars?Math.round(s*(1-Math.min(1,e/n))):Math.round(s*(1-e));let t="forward"===this.direction?this.fromTextConfig.slice(s-r):this.fromTextConfig.slice(0,r);this.fadeOutChars&&(t=this.applyFadeEffect(t,e,s,r)),this.showCursor&&r>0&&(t=this.addCursor(t,e)),this.target.setAttribute("textConfig",t)}else{r=this.fadeOutChars?Math.round(s*(1-Math.min(1,e/n))):Math.round(s*(1-e));let t=this.fromTextConfig.slice(0,r);this.fadeOutChars&&(t=this.applyFadeEffect(t,e,s,r)),this.showCursor&&r>0&&(t=this.addCursor(t,e)),this.target.setAttribute("textConfig",t)}}applyFadeEffect(t,e,i,r){this.direction;let s=Math.max(0,1-Math.min(1,(e-(1-this.fadeOutDuration))/this.fadeOutDuration));return t.map((e,i)=>{if("forward"===this.direction){if(0===i&&"text"in e)return Object.assign(Object.assign({},e),{opacity:s})}else if(i===t.length-1&&"text"in e)return Object.assign(Object.assign({},e),{opacity:s});return e})}addCursor(t,e){let i=!0;if(this.blinkCursor&&(i=Math.floor(e/.1)%2==0),i&&t.length>0){let e="forward"===this.direction?0:t.length-1,i=t[e];if("text"in i){let r=[...t];return"forward"===this.direction?r[e]=Object.assign(Object.assign({},i),{text:this.cursorChar+String(i.text)}):r[e]=Object.assign(Object.assign({},i),{text:String(i.text)+this.cursorChar}),r}}return t}}class k extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeInDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],void 0!==(null==s?void 0:s.fadeInDuration)&&(this.fadeInDuration=s.fadeInDuration),void 0!==(null==s?void 0:s.slideDirection)&&(this.slideDirection=s.slideDirection),void 0!==(null==s?void 0:s.slideDistance)&&(this.slideDistance=s.slideDistance),void 0!==(null==s?void 0:s.wordByWord)&&(this.wordByWord=s.wordByWord),void 0!==(null==s?void 0:s.wordRegex)&&(this.wordRegex=s.wordRegex)}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?b.H.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=b.H.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.singleCharConfig=this.toTextConfig.map(t=>"text"in t?Object.assign(Object.assign({},t),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}):Object.assign(Object.assign({},t),{opacity:0})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="",e={},i,r=0;for(this.toTextConfig.forEach((i,s)=>{if("text"in i){let n=String(i.text);t+=n,e[r]=s,r++}}),this.wordRegex.lastIndex=0;null!==(i=this.wordRegex.exec(t));){let t=i.index,r=i.index+i[0].length,s=[];for(let i=t;i<r;i++)void 0!==e[i]&&s.push(e[i]);s.length>0&&this.wordGroups.push(s)}let s=new Set;this.wordGroups.forEach(t=>{t.forEach(t=>s.add(t))});for(let t=0;t<this.toTextConfig.length;t++)"text"in this.toTextConfig[t]&&!s.has(t)&&this.wordGroups.push([t])}getInitialDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getInitialDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){let r;if(!this.valid)return;let s=1-this.fadeInDuration;r=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,s):this.updateByCharacter(e,s),this.target.setAttribute("textConfig",r)}updateByWord(t,e){let i=this.wordGroups.length,r=[...this.singleCharConfig];for(let s=0;s<this.wordGroups.length;s++){let n;if(t<(n="left"===this.slideDirection?(i-1-s)/i*e:s/i*e)){for(let t of this.wordGroups[s]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}))}continue}let a=Math.max(0,Math.min(1,(t-n)/this.fadeInDuration)),l=this.getInitialDx()*(1-a),o=this.getInitialDy()*(1-a);for(let t of this.wordGroups[s]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:a,dx:l,dy:o}))}}return r}updateByCharacter(t,e){let i=this.toTextConfig.length,r=[...this.singleCharConfig];for(let s=0;s<r.length;s++){let n=r[s];if("text"in n){let a;if(t<(a="left"===this.slideDirection?(i-1-s)/i*e:s/i*e)){r[s]=Object.assign(Object.assign({},n),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()});continue}let l=Math.max(0,Math.min(1,(t-a)/this.fadeInDuration)),o=this.getInitialDx()*(1-l),h=this.getInitialDy()*(1-l);r[s]=Object.assign(Object.assign({},n),{opacity:l,dx:o,dy:h})}}return r}}class A extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeOutDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],this.reverseOrder=!1,void 0!==(null==s?void 0:s.fadeOutDuration)&&(this.fadeOutDuration=s.fadeOutDuration),void 0!==(null==s?void 0:s.slideDirection)&&(this.slideDirection=s.slideDirection),void 0!==(null==s?void 0:s.slideDistance)&&(this.slideDistance=s.slideDistance),void 0!==(null==s?void 0:s.wordByWord)&&(this.wordByWord=s.wordByWord),void 0!==(null==s?void 0:s.wordRegex)&&(this.wordRegex=s.wordRegex),void 0!==(null==s?void 0:s.reverseOrder)&&(this.reverseOrder=s.reverseOrder),this.propKeys=["textConfig"]}onFirstRun(){let t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=b.H.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?b.H.TransformTextConfig2SingleCharacter(e.textConfig):[],this.singleCharConfig=this.fromTextConfig.map(t=>"text"in t?Object.assign(Object.assign({},t),{opacity:1,dx:0,dy:0}):Object.assign(Object.assign({},t),{opacity:1})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="",e={},i,r=0;for(this.fromTextConfig.forEach((i,s)=>{if("text"in i){let n=String(i.text);t+=n,e[r]=s,r++}}),this.wordRegex.lastIndex=0;null!==(i=this.wordRegex.exec(t));){let t=i.index,r=i.index+i[0].length,s=[];for(let i=t;i<r;i++)void 0!==e[i]&&s.push(e[i]);s.length>0&&this.wordGroups.push(s)}let s=new Set;this.wordGroups.forEach(t=>{t.forEach(t=>s.add(t))});for(let t=0;t<this.fromTextConfig.length;t++)"text"in this.fromTextConfig[t]&&!s.has(t)&&this.wordGroups.push([t])}getTargetDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getTargetDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){let r;if(!this.valid)return;let s=1-this.fadeOutDuration;r=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,s):this.updateByCharacter(e,s),this.target.setAttribute("textConfig",r)}updateByWord(t,e){let i=this.wordGroups.length,r=[...this.singleCharConfig];for(let s=0;s<this.wordGroups.length;s++){let n;if(t<(n=this.reverseOrder?"left"===this.slideDirection?s/i*e:(i-1-s)/i*e:"left"===this.slideDirection?(i-1-s)/i*e:s/i*e)){for(let t of this.wordGroups[s]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:1,dx:0,dy:0}))}continue}let a=Math.max(0,Math.min(1,(t-n)/this.fadeOutDuration)),l=this.getTargetDx()*a,o=this.getTargetDy()*a,h=1-a;for(let t of this.wordGroups[s]){let e=r[t];"text"in e&&(r[t]=Object.assign(Object.assign({},e),{opacity:h,dx:l,dy:o}))}}return r}updateByCharacter(t,e){let i=this.fromTextConfig.length,r=[...this.singleCharConfig];for(let s=0;s<r.length;s++){let n=r[s];if("text"in n){let a;if(t<(a=this.reverseOrder?"left"===this.slideDirection?s/i*e:(i-1-s)/i*e:"left"===this.slideDirection?(i-1-s)/i*e:s/i*e)){r[s]=Object.assign(Object.assign({},n),{opacity:1,dx:0,dy:0});continue}let l=Math.max(0,Math.min(1,(t-a)/this.fadeOutDuration)),o=this.getTargetDx()*l,h=this.getTargetDy()*l,u=1-l;r[s]=Object.assign(Object.assign({},n),{opacity:u,dx:o,dy:h})}}return r}}var M=i(50354),w=i(45996),T=i(58273);class C extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i,r,s,n,a,l,o,h,u,d;super.onBind();let c=this.target.getFinalAttribute(),p=(null==(t=this.params)?void 0:t.direction)||"right",g=(null==(e=this.params)?void 0:e.distance)||50,f=null!=(r=null==(i=this.params)?void 0:i.fromOpacity)?r:0,m={opacity:f,baseOpacity:f},y={opacity:1,baseOpacity:1};"top"===p?(m.y=(null!=(s=c.y)?s:0)-g,y.y=null!=(n=c.y)?n:0,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===p?(m.y=(null!=(a=c.y)?a:0)+g,y.y=null!=(l=c.y)?l:0,this.propKeys=["opacity","baseOpacity","y"]):("left"===p?(m.x=(null!=(o=c.x)?o:0)-g,y.x=null!=(h=c.x)?h:0):(m.x=(null!=(u=c.x)?u:0)+g,y.x=null!=(d=c.x)?d:0),this.propKeys=["opacity","baseOpacity","x"]),this.from=m,this.to=y,this.props=y,this.target.setAttributes(m)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class E extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i,r,s,n,a;super.onBind();let l=this.target.getFinalAttribute(),o=null!=(e=null==(t=this.params)?void 0:t.fromScale)?e:0,h=(null==(i=this.params)?void 0:i.direction)||"xy",u=null!=(s=null==(r=this.params)?void 0:r.fromOpacity)?s:0,d={opacity:u,baseOpacity:u},c={opacity:1,baseOpacity:1};this.propKeys=["opacity","baseOpacity"],"x"!==h&&"xy"!==h||(d.scaleX=o,c.scaleX=null!=(n=l.scaleX)?n:1,this.propKeys.push("scaleX")),"y"!==h&&"xy"!==h||(d.scaleY=o,c.scaleY=null!=(a=l.scaleY)?a:1,this.propKeys.push("scaleY")),this.from=d,this.to=c,this.props=c,this.target.setAttributes(d)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class B extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i,r,s,n,a,l,o;super.onBind();let h=this.target.getFinalAttribute(),u=null!=(e=null==(t=this.params)?void 0:t.fromAngle)?e:2*Math.PI,d=null!=(r=null==(i=this.params)?void 0:i.fromScale)?r:0,c=null!=(n=null==(s=this.params)?void 0:s.fromOpacity)?n:0,p={opacity:c,baseOpacity:c,angle:u,scaleX:d,scaleY:d},g={opacity:1,baseOpacity:1,angle:null!=(a=h.angle)?a:0,scaleX:null!=(l=h.scaleX)?l:1,scaleY:null!=(o=h.scaleY)?o:1};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=p,this.to=g,this.props=g,this.target.setAttributes(p)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class P extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.perimeter=0,this.originalAttributes={}}onBind(){var t,e,i,r,s,n,a,l,o,h,u,d,c,p,g,f,m,y;if(super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){let i=this.target.attribute,r=null!=(t=i.width)?t:100,s=null!=(e=i.height)?e:100;this.perimeter=2*(r+s)}else if("circle"===this.target.type){let t=null!=(i=this.target.attribute.radius)?i:50;this.perimeter=2*Math.PI*t}else if("ellipse"===this.target.type){let t=this.target.attribute,e=null!=(r=t.radiusX)?r:50,i=null!=(s=t.radiusY)?s:50;this.perimeter=2*Math.PI*Math.sqrt((e*e+i*i)/2)}else this.perimeter=1e3;let _=null!=(a=null==(n=this.params)?void 0:n.lineWidth)?a:2,v=null!=(o=null==(l=this.params)?void 0:l.strokeColor)?o:"black",b=null!=(u=null==(h=this.params)?void 0:h.fromOpacity)?u:1,x=null!=(c=null==(d=this.params)?void 0:d.dashLength)?c:this.perimeter,S=null!=(g=null==(p=this.params)?void 0:p.showFill)&&g,k=null!=(m=null==(f=this.params)?void 0:f.fillOpacity)?m:0;this.from={lineDash:[x,x],lineDashOffset:x,lineWidth:_,stroke:v,strokeOpacity:b},this.to={lineDash:[x,x],lineDashOffset:0,lineWidth:_,stroke:v,strokeOpacity:b},S?(this.from.fillOpacity=k,this.to.fillOpacity=null!=(y=this.originalAttributes.fillOpacity)?y:1):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;let s=this.target.attribute;s.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null==(r=this.params)?void 0:r.showFill)&&(s.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}onEnd(){var t;if(super.onEnd(),!(null==(t=this.params)?void 0:t.showFill)){let t=Object.assign({},this.originalAttributes);t.fillOpacity=0,this.target.setAttributes(t)}}}class O extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.perimeter=0,this.originalAttributes={}}onFirstRun(){var t,e,i,r,s,n,a,l,o,h,u,d,c,p,g,f;if(this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){let i=this.target.attribute,r=null!=(t=i.width)?t:100,s=null!=(e=i.height)?e:100;this.perimeter=2*(r+s)}else if("circle"===this.target.type){let t=null!=(i=this.target.attribute.radius)?i:50;this.perimeter=2*Math.PI*t}else if("ellipse"===this.target.type){let t=this.target.attribute,e=null!=(r=t.radiusX)?r:50,i=null!=(s=t.radiusY)?s:50;this.perimeter=2*Math.PI*Math.sqrt((e*e+i*i)/2)}else this.perimeter=1e3;let m=null!=(a=null==(n=this.params)?void 0:n.lineWidth)?a:2,y=null!=(o=null==(l=this.params)?void 0:l.strokeColor)?o:"black",_=null!=(u=null==(h=this.params)?void 0:h.fromOpacity)?u:1,v=null!=(c=null==(d=this.params)?void 0:d.dashLength)?c:this.perimeter,b=null!=(g=null==(p=this.params)?void 0:p.showFill)&&g;this.from={lineDash:[v,v],lineDashOffset:0,lineWidth:m,stroke:y,strokeOpacity:_},this.to={lineDash:[v,v],lineDashOffset:-v,lineWidth:m,stroke:y,strokeOpacity:_},b?this.from.fillOpacity=null!=(f=this.originalAttributes.fillOpacity)?f:1:this.from.fillOpacity=0,this.to.fillOpacity=0,this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;let s=this.target.attribute;s.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null==(r=this.params)?void 0:r.showFill)&&(s.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}}class I extends c.r{constructor(t,e,i,r,s){var n;super(t,e,i,r,s);let a=null!=(n=null==s?void 0:s.slideRatio)?n:.5;this.slideInDuration=i*a,this.growInDuration=i*(1-a)}onBind(){var t,e,i,s,n,a;super.onBind();let l=new r.a(this.target);l.execute({type:"custom",custom:C,customParameters:{direction:(null==(t=this.params)?void 0:t.slideDirection)||"right",distance:(null==(e=this.params)?void 0:e.slideDistance)||50,fromOpacity:null!=(s=null==(i=this.params)?void 0:i.fromOpacity)?s:0},duration:this.slideInDuration,easing:this.easing}),l.execute({type:"custom",custom:E,customParameters:{fromScale:(null==(n=this.params)?void 0:n.fromScale)||.5,direction:(null==(a=this.params)?void 0:a.scaleDirection)||"xy",fromOpacity:1},duration:this.growInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class R extends c.r{constructor(t,e,i,r,s){var n;super(t,e,i,r,s);let a=null!=(n=null==s?void 0:s.slideRatio)?n:.5;this.slideInDuration=i*a,this.spinInDuration=i*(1-a)}onBind(){var t,e,i,s,n,a;super.onBind();let l=new r.a(this.target);l.execute({type:"custom",custom:C,customParameters:{direction:(null==(t=this.params)?void 0:t.slideDirection)||"right",distance:(null==(e=this.params)?void 0:e.slideDistance)||50,fromOpacity:null!=(s=null==(i=this.params)?void 0:i.fromOpacity)?s:0},duration:this.slideInDuration,easing:this.easing}),l.execute({type:"custom",custom:B,customParameters:{fromAngle:(null==(n=this.params)?void 0:n.fromAngle)||Math.PI,fromScale:(null==(a=this.params)?void 0:a.fromScale)||.5,fromOpacity:1},duration:this.spinInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class L extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onFirstRun(){var t,e,i,r,s,n,a,l,o,h,u,d,c,p;let g=this.target.getAttributes(),f=(null==(t=this.params)?void 0:t.direction)||"right",m=(null==(e=this.params)?void 0:e.distance)||50,y=null!=(r=null==(i=this.params)?void 0:i.fromOpacity)?r:1,_=null!=(n=null==(s=this.params)?void 0:s.toOpacity)?n:0,v={opacity:y,baseOpacity:y},b={opacity:_,baseOpacity:_};"top"===f?(v.y=null!=(a=g.y)?a:0,b.y=(null!=(l=g.y)?l:0)-m,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===f?(v.y=null!=(o=g.y)?o:0,b.y=(null!=(h=g.y)?h:0)+m,this.propKeys=["opacity","baseOpacity","y"]):("left"===f?(v.x=null!=(u=g.x)?u:0,b.x=(null!=(d=g.x)?d:0)-m):(v.x=null!=(c=g.x)?c:0,b.x=(null!=(p=g.x)?p:0)+m),this.propKeys=["opacity","baseOpacity","x"]),this.from=v,this.to=b,this.props=b}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class D extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onFirstRun(){var t,e,i,r,s,n,a,l,o;let h=this.target.getAttributes(),u=null!=(e=null==(t=this.params)?void 0:t.fromScale)?e:0,d=(null==(i=this.params)?void 0:i.direction)||"xy",c=null!=(s=null==(r=this.params)?void 0:r.fromOpacity)?s:1,p=null!=(a=null==(n=this.params)?void 0:n.toOpacity)?a:0,g={opacity:c,baseOpacity:c},f={opacity:p,baseOpacity:p};this.propKeys=["opacity","baseOpacity"],"x"!==d&&"xy"!==d||(g.scaleX=null!=(l=h.scaleX)?l:1,f.scaleX=u,this.propKeys.push("scaleX")),"y"!==d&&"xy"!==d||(g.scaleY=null!=(o=h.scaleY)?o:1,f.scaleY=u,this.propKeys.push("scaleY")),this.from=g,this.to=f,this.props=f}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class F extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onFirstRun(){var t,e,i,r,s,n,a,l,o,h,u;let d=this.target.getAttributes(),c=null!=(e=null==(t=this.params)?void 0:t.fromAngle)?e:2*Math.PI,p=null!=(r=null==(i=this.params)?void 0:i.fromScale)?r:0,g=null!=(n=null==(s=this.params)?void 0:s.fromOpacity)?n:1,f=null!=(l=null==(a=this.params)?void 0:a.toOpacity)?l:0,m={opacity:g,baseOpacity:g,angle:null!=(o=d.angle)?o:0,scaleX:null!=(h=d.scaleX)?h:1,scaleY:null!=(u=d.scaleY)?u:1},y={opacity:f,baseOpacity:f,angle:c,scaleX:p,scaleY:p};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=m,this.to=y,this.props=y}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class z extends c.r{constructor(t,e,i,r,s){var n;super(t,e,i,r,s);let a=null!=(n=null==s?void 0:s.slideRatio)?n:.5;this.growOutDuration=i*(1-a),this.slideOutDuration=i*a}onFirstRun(){var t,e,i,s;let n=new r.a(this.target);n.execute({type:"custom",custom:D,customParameters:{fromScale:(null==(t=this.params)?void 0:t.fromScale)||.5,direction:(null==(e=this.params)?void 0:e.scaleDirection)||"xy",fromOpacity:1,toOpacity:1},duration:this.growOutDuration,easing:this.easing}),n.execute({type:"custom",custom:L,customParameters:{direction:(null==(i=this.params)?void 0:i.slideDirection)||"right",distance:(null==(s=this.params)?void 0:s.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.growOutDuration})}onUpdate(t,e,i){}}class j extends c.r{constructor(t,e,i,r,s){var n;super(t,e,i,r,s);let a=null!=(n=null==s?void 0:s.slideRatio)?n:.5;this.spinOutDuration=i*(1-a),this.slideOutDuration=i*a}onFirstRun(){var t,e,i,s;let n=new r.a(this.target);n.execute({type:"custom",custom:F,customParameters:{fromAngle:(null==(t=this.params)?void 0:t.fromAngle)||Math.PI,fromScale:(null==(e=this.params)?void 0:e.fromScale)||.5,fromOpacity:1,toOpacity:1},duration:this.spinOutDuration,easing:this.easing}),n.execute({type:"custom",custom:L,customParameters:{direction:(null==(i=this.params)?void 0:i.slideDirection)||"right",distance:(null==(s=this.params)?void 0:s.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.spinOutDuration})}onUpdate(t,e,i){}}class H extends c.r{constructor(t,e,i,r,s){super(t,e,i,r,s),this.originalAttributes={},this.pulseCount=3,this.pulseOpacity=.3,this.pulseScale=1.05,this.pulseColor=null,this.pulseColorIntensity=.2,this.strokeOnly=!1,this.fillOnly=!1,this.useScale=!0,this.useOpacity=!0,this.useStroke=!0,this.useFill=!0,this.useColor=!1,this.originalFill=null,this.originalStroke=null,void 0!==(null==s?void 0:s.pulseCount)&&(this.pulseCount=s.pulseCount),void 0!==(null==s?void 0:s.pulseScale)&&(this.pulseScale=s.pulseScale),void 0!==(null==s?void 0:s.pulseColor)&&(this.pulseColor=s.pulseColor),void 0!==(null==s?void 0:s.pulseColorIntensity)&&(this.pulseColorIntensity=s.pulseColorIntensity),void 0!==(null==s?void 0:s.strokeOnly)&&(this.strokeOnly=s.strokeOnly),void 0!==(null==s?void 0:s.fillOnly)&&(this.fillOnly=s.fillOnly),void 0!==(null==s?void 0:s.useScale)&&(this.useScale=s.useScale),void 0!==(null==s?void 0:s.useOpacity)&&(this.useOpacity=s.useOpacity),void 0!==(null==s?void 0:s.useStroke)&&(this.useStroke=s.useStroke),void 0!==(null==s?void 0:s.useFill)&&(this.useFill=s.useFill),void 0!==(null==s?void 0:s.useColor)&&(this.useColor=s.useColor)}onBind(){super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),this.useColor&&(this.originalFill=this.originalAttributes.fill||null,this.originalStroke=this.originalAttributes.stroke||null,this.pulseColor||(this.fillOnly&&this.originalFill?this.pulseColor=this.originalFill:this.strokeOnly&&this.originalStroke?this.pulseColor=this.originalStroke:this.originalFill?this.pulseColor=this.originalFill:this.originalStroke?this.pulseColor=this.originalStroke:this.pulseColor="#FFFFFF"))}onUpdate(t,e,i){let r=Math.abs(Math.sin(e*Math.PI*this.pulseCount)),s=this.target.attribute;if(this.useOpacity){let t=1+(this.pulseOpacity-1)*r;this.useStroke&&(s.strokeOpacity=(this.originalAttributes.strokeOpacity||1)*t),this.useFill&&(s.fillOpacity=(this.originalAttributes.fillOpacity||1)*t)}if(this.useScale){let t=1+(this.pulseScale-1)*r;s.scaleX=(this.originalAttributes.scaleX||1)*t,s.scaleY=(this.originalAttributes.scaleY||1)*t}this.useColor&&this.pulseColor&&this.applyColorPulse(s,r),this.target.addUpdateShapeAndBoundsTag(),this.target.addUpdatePositionTag()}applyColorPulse(t,e){let i=this.pulseColorIntensity*e;this.useFill&&this.originalFill&&this.pulseColor&&(t.fill=(0,T.BM)(this.originalFill,this.pulseColor,i,!0)),this.useStroke&&this.originalStroke&&this.pulseColor&&(t.stroke=(0,T.BM)(this.originalStroke,this.pulseColor,i,!0))}onEnd(){super.onEnd(),this.target.setAttributes(this.originalAttributes)}}var N=i(10688),V=i(42100),W=i(8146);class U extends c.r{constructor(t,e,i,r,s){var n;super(t,e,i,r,s),s&&(this.pathLength=s.path.getLength(),this.path=s.path,this.distance=s.distance,this.totalLength=this.distance*this.pathLength,this.initAngle=null!=(n=s.initAngle)?n:0,this.changeAngle=!!s.changeAngle,this.cb=s.cb)}onBind(){this.from={x:0,y:0},this.to=this.path.getAttrAt(this.totalLength).pos,this.props=this.to}onUpdate(t,e,i){let r={},s=this.totalLength*e,{pos:n,angle:a}=this.path.getAttrAt(s);r.x=n.x,r.y=n.y,this.changeAngle&&(r.angle=a+this.initAngle),this.cb&&this.cb(this.from,this.to,e,this.target),this.target.setAttributes(r)}}var G=i(77632),Z=i(85309);let $=()=>{r.a.registerBuiltInAnimate("increaseCount",y.B),r.a.registerBuiltInAnimate("fromTo",G.$),r.a.registerBuiltInAnimate("scaleIn",M.O),r.a.registerBuiltInAnimate("scaleOut",M.E),r.a.registerBuiltInAnimate("growHeightIn",o.HQ),r.a.registerBuiltInAnimate("growHeightOut",o.qG),r.a.registerBuiltInAnimate("growWidthIn",d.dR),r.a.registerBuiltInAnimate("growWidthOut",d.yi),r.a.registerBuiltInAnimate("growCenterIn",l.W),r.a.registerBuiltInAnimate("growCenterOut",l.B),r.a.registerBuiltInAnimate("clipIn",s.b),r.a.registerBuiltInAnimate("clipOut",s.v),r.a.registerBuiltInAnimate("fadeIn",n.U),r.a.registerBuiltInAnimate("fadeOut",n.D),r.a.registerBuiltInAnimate("growPointsIn",h.Kk),r.a.registerBuiltInAnimate("growPointsOut",h.Yf),r.a.registerBuiltInAnimate("growPointsXIn",h.xJ),r.a.registerBuiltInAnimate("growPointsXOut",h.$m),r.a.registerBuiltInAnimate("growPointsYIn",h.yQ),r.a.registerBuiltInAnimate("growPointsYOut",h.rf),r.a.registerBuiltInAnimate("growAngleIn",a.kj),r.a.registerBuiltInAnimate("growAngleOut",a.j2),r.a.registerBuiltInAnimate("growRadiusIn",u.$),r.a.registerBuiltInAnimate("growRadiusOut",u.em),r.a.registerBuiltInAnimate("moveIn",V.V8),r.a.registerBuiltInAnimate("moveOut",V.vW),r.a.registerBuiltInAnimate("rotateIn",W.hD),r.a.registerBuiltInAnimate("rotateOut",W.XN),r.a.registerBuiltInAnimate("update",N.B),r.a.registerBuiltInAnimate("state",w.Z),r.a.registerBuiltInAnimate("labelItemAppear",f),r.a.registerBuiltInAnimate("labelItemDisappear",m),r.a.registerBuiltInAnimate("poptipAppear",_),r.a.registerBuiltInAnimate("poptipDisappear",v),r.a.registerBuiltInAnimate("inputText",p),r.a.registerBuiltInAnimate("inputRichText",x),r.a.registerBuiltInAnimate("outputRichText",S),r.a.registerBuiltInAnimate("slideRichText",k),r.a.registerBuiltInAnimate("slideOutRichText",A),r.a.registerBuiltInAnimate("slideIn",C),r.a.registerBuiltInAnimate("growIn",E),r.a.registerBuiltInAnimate("spinIn",B),r.a.registerBuiltInAnimate("moveScaleIn",I),r.a.registerBuiltInAnimate("moveRotateIn",R),r.a.registerBuiltInAnimate("strokeIn",P),r.a.registerBuiltInAnimate("slideOut",L),r.a.registerBuiltInAnimate("growOut",D),r.a.registerBuiltInAnimate("spinOut",F),r.a.registerBuiltInAnimate("moveScaleOut",z),r.a.registerBuiltInAnimate("moveRotateOut",j),r.a.registerBuiltInAnimate("strokeOut",O),r.a.registerBuiltInAnimate("pulse",H),r.a.registerBuiltInAnimate("MotionPath",U),r.a.registerBuiltInAnimate("streamLight",Z.G)}},8146:function(t,e,i){"use strict";i.d(e,{XN:()=>u,hD:()=>h});var r=i(25258),s=i(70501),n=i(84564);let a=(t,e)=>{var i;let n=null!=(i=t.getFinalAttribute().angle)?i:0,a=0;return{from:{angle:(0,r.Yt)(n/(2*Math.PI),0)?Math.round(n/(2*Math.PI))*Math.PI*2:(0,s.Z)(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(n/(2*Math.PI))*Math.PI*2:Math.floor(n/(2*Math.PI))*Math.PI*2},to:{angle:n}}},l=(t,e)=>{var i;let n=null!=(i=t.getFinalAttribute().angle)?i:0,a=0;return a=(0,r.Yt)(n/(2*Math.PI),0)?Math.round(n/(2*Math.PI))*Math.PI*2:(0,s.Z)(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(n/(2*Math.PI))*Math.PI*2:Math.floor(n/(2*Math.PI))*Math.PI*2,{from:{angle:n},to:{angle:a}}};class o extends n.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class h extends o{onBind(){var t;super.onBind();let{from:e,to:i}=a(this.target,this.params.options);this.props=i,this.propKeys=["angle"],this.from=e,this.to=i;let r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),!1!==(null==(t=this.params.controlOptions)?void 0:t.immediatelyApply)&&this.target.setAttributes(e)}}class u extends o{onBind(){super.onBind();let{from:t,to:e}=l(this.target,this.params.options);this.props=e,this.propKeys=["angle"],this.from=t,this.to=e}}},50354:function(t,e,i){"use strict";i.d(e,{E:()=>n,O:()=>s});var r=i(84564);class s extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i,r,s,n,a,l,o,h,u;let d,c;super.onBind();let p=this.target.getFinalAttribute(),g=null!=(t=this.target.attribute)?t:{};switch(null==(e=this.params)?void 0:e.direction){case"x":d={scaleX:null!=(i=g.scaleX)?i:0},c={scaleX:null!=(r=null==p?void 0:p.scaleX)?r:1},this._updateFunction=this.updateX;break;case"y":d={scaleY:null!=(s=g.scaleY)?s:0},c={scaleY:null!=(n=null==p?void 0:p.scaleY)?n:1},this._updateFunction=this.updateY;break;default:d={scaleX:null!=(a=g.scaleX)?a:0,scaleY:null!=(l=g.scaleY)?l:0},c={scaleX:null!=(o=null==p?void 0:p.scaleX)?o:1,scaleY:null!=(h=null==p?void 0:p.scaleY)?h:1},this._updateFunction=this.updateXY}let f=this.target.getFinalAttribute();f&&this.target.setAttributes(f),this.props=c,this.from=d,this.to=c,!1!==(null==(u=this.params.controlOptions)?void 0:u.immediatelyApply)&&this.target.setAttributes(d)}onEnd(t){super.onEnd(t)}updateX(t){this.target.attribute.scaleX=this.from.scaleX+(this.to.scaleX-this.from.scaleX)*t}updateY(t){this.target.attribute.scaleY=this.from.scaleY+(this.to.scaleY-this.from.scaleY)*t}updateXY(t){this.updateX(t),this.updateY(t)}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];let e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateXY:"scaleX"===this.propKeys[0]?this._updateFunction=this.updateX:"scaleY"===this.propKeys[0]?this._updateFunction=this.updateY:this._updateFunction=null}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag())}}class n extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e,i,r,s;let n,a;super.onBind();let l=this.target.attribute;switch(null==(t=this.params)?void 0:t.direction){case"x":n={scaleX:null!=(e=null==l?void 0:l.scaleX)?e:1},a={scaleX:0};break;case"y":n={scaleY:null!=(i=null==l?void 0:l.scaleY)?i:1},a={scaleY:0};break;default:n={scaleX:null!=(r=null==l?void 0:l.scaleX)?r:1,scaleY:null!=(s=null==l?void 0:l.scaleY)?s:1},a={scaleX:0,scaleY:0}}this.props=a,this.from=n,this.to=a}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){let r=this.target.attribute;this.propKeys.forEach(t=>{r[t]=this.from[t]+(this.to[t]-this.from[t])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}}},45996:function(t,e,i){"use strict";i.d(e,{Z:()=>s});var r=i(84564);class s extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.fromProps[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}},85309:function(t,e,i){"use strict";i.d(e,{G:()=>h});var r=i(96087),s=i(78388),n=i(33760),a=i(60452),l=i(84564),o=i(41457);class h extends l.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}getEndProps(){return{}}onStart(){this.target&&("rect"===this.target.type?this.onStartRect():"line"===this.target.type?this.onStartLineOrArea("line"):"area"===this.target.type&&this.onStartLineOrArea("area"))}onStartLineOrArea(t){var e;let i=this.target.attachShadow(),n=r.w.graphicService.creator[t](Object.assign({},null==(e=this.params)?void 0:e.attribute));this[t]=n,n.pathProxy=new s.r,i.add(n)}onStartRect(){var t,e,i;let s=this.target.attachShadow(),n=null==(e=null==(t=this.params)?void 0:t.isHorizontal)||e,a=n?"height":"width",l=this.target.AABBBounds[a](),o=n?0:this.target.AABBBounds.y1,h=r.w.graphicService.creator.rect(Object.assign(Object.assign({[a]:l,fill:"#bcdeff",shadowBlur:30,shadowColor:"#bcdeff"},null==(i=this.params)?void 0:i.attribute),{x:0,y:o,[n?"width":"height"]:0}));this.rect=h,s.add(h)}onBind(){}onEnd(){this.target.detachShadow()}onUpdate(t,e,i){return this.rect?this.onUpdateRect(t,e,i):this.line||this.area?this.onUpdateLineOrArea(t,e,i):void 0}onUpdateRect(t,e,i){var r,s,a,l,o,h,u,d,c,p,g,f,m,y,_,v;let b=null==(s=null==(r=this.params)?void 0:r.isHorizontal)||s,x=this.target.attribute;if(b){let i=null!=(l=null!=(a=x.width)?a:Math.abs(x.x1-x.x))?l:250,r=null!=(h=null==(o=this.params)?void 0:o.streamLength)?h:i,s=null!=(c=null==(d=null==(u=this.params)?void 0:u.attribute)?void 0:d.width)?c:60,p=-s,g=p+(r-p)*e,f=Math.max(g,0),m=Math.min(Math.min(g+s,s),r-g),y=m+f>i?Math.max(i-f,0):m;this.rect.setAttributes({x:f+Math.min(x.x1-x.x,0),width:y},!1,{type:n.Gk.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}else{let i,r=null!=(g=null!=(p=x.height)?p:Math.abs(x.y1-x.y))?g:250,s=null!=(m=null==(f=this.params)?void 0:f.streamLength)?m:r,a=null!=(v=null==(_=null==(y=this.params)?void 0:y.attribute)?void 0:_.height)?v:60,l=r-(s+a)*e,o=Math.min(l,r),h=Math.min(r-l,a);o<=0?(i=Math.max(o+h,0),o=0):i=h,this.rect.setAttributes({y:o+Math.min(x.y1-x.y,0),height:i},!1,{type:n.Gk.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}}onUpdateLineOrArea(t,e,i){let r=this.line||this.area;if(!r)return;let s=r.pathProxy,n=this.target;n.cache||n.cacheArea?this._onUpdateLineOrAreaWithCache(s,n,t,e,i):this._onUpdateLineWithoutCache(s,n,t,e,i);let a=n.attribute;r.setAttributes(Object.assign({stroke:a.stroke},r.attribute)),r.addUpdateBoundTag()}_onUpdateLineOrAreaWithCache(t,e,i,r,s){var n,a;if(t.clear(),"line"===e.type){let i=e.cache;Array.isArray(i)||(i=[i]);let s=i.reduce((t,e)=>t+e.getLength(),0),n=[];return i.forEach(t=>{t.curves.forEach(t=>n.push(t))}),this._updateCurves(t,n,s,r)}if("area"===e.type&&(null==(a=null==(n=e.cacheArea)?void 0:n.top)?void 0:a.curves)){let i=e.cacheArea,s=i.top.curves.reduce((t,e)=>t+e.getLength(),0);return this._updateCurves(t,i.top.curves,s,r)}}_updateCurves(t,e,i,r){var s,n;let l=i*r,o=Math.min(l+(null!=(n=null==(s=this.params)?void 0:s.streamLength)?n:10),i),h=0,u=!1;for(let i=0;i<e.length;i++)if(!1!==e[i].defined){let r=e[i],s=r.getLength(),n=1-(h+s-l)/s,d,c=1-(h+s-o)/s;if(h<l&&h+s>l)if(u=!0,r.p2&&r.p3){let[e,i]=(0,a.m)(r,n);t.moveTo(i.p0.x,i.p0.y),d=i}else{let e=r.getPointAt(n);t.moveTo(e.x,e.y)}if(h<o&&h+s>o){if(r.p2&&r.p3){d&&(c=(o-l)/d.getLength());let[e]=(0,a.m)(d||r,c);t.bezierCurveTo(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y)}else{let e=r.getPointAt(c);t.lineTo(e.x,e.y)}break}if(u)if(r.p2&&r.p3){let e=d||r;t.bezierCurveTo(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y)}else t.lineTo(r.p1.x,r.p1.y);h+=s}}_onUpdateLineWithoutCache(t,e,i,r,s){var n,a;let{points:l,curveType:h}=e.attribute;if(!l||l.length<2||"linear"!==h)return;let u=0;for(let t=1;t<l.length;t++)u+=o.HL.distancePP(l[t],l[t-1]);let d=u*r,c=Math.min(d+(null!=(a=null==(n=this.params)?void 0:n.streamLength)?a:10),u),p=[],g=0;for(let t=1;t<l.length;t++){let e=o.HL.distancePP(l[t],l[t-1]);if(g<d&&g+e>d&&p.push(o.HL.pointAtPP(l[t-1],l[t],1-(g+e-d)/e)),g<c&&g+e>c){p.push(o.HL.pointAtPP(l[t-1],l[t],1-(g+e-c)/e));break}p.length&&p.push(l[t]),g+=e}if(p.length&&!(p.length<2)){t.clear(),t.moveTo(p[0].x,p[0].y);for(let e=1;e<p.length;e++)t.lineTo(p[e].x,p[e].y)}}}},10688:function(t,e,i){"use strict";i.d(e,{B:()=>s});var r=i(84564);class s extends r.r{constructor(t,e,i,r,s){super(t,e,i,r,s)}onBind(){var t,e;super.onBind();let{diffAttrs:i={}}=null!=(t=this.target.context)?t:{},{options:r}=this.params;i=Object.assign({},i),(null==(e=null==r?void 0:r.excludeChannels)?void 0:e.length)&&r.excludeChannels.forEach(t=>{delete i[t]}),this.props=i}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.fromProps[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i)}}},16749:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r=i(31535),s=i(98116);class n{static registerBuiltInAnimate(t,e){n.builtInAnimateMap[t]=e}constructor(t){this._animates=[],this._startCallbacks=[],this._endCallbacks=[],this._started=!1,this._activeCount=0,this._target=t}onStart(t){t?(this._startCallbacks.push(t),this._started&&this._activeCount>0&&t()):this._startCallbacks.forEach(t=>{t()})}onEnd(t){t?this._endCallbacks.push(t):this._endCallbacks.forEach(t=>{t()})}_trackAnimation(t){this._animates.push(t),this._activeCount++,1!==this._activeCount||this._started||(this._started=!0,this.onStart()),t.onEnd(()=>{this._activeCount--;let e=this._animates.indexOf(t);e>=0&&this._animates.splice(e,1),0===this._activeCount&&this._started&&(this._started=!1,this.onEnd())})}parseParams(t,e,i){var a,l;let o=this.resolveValue(t.totalTime,void 0,void 0),h=this.resolveValue(t.startTime,void 0,0),u=Object.assign({},t);u.oneByOneDelay=0,u.startTime=h,u.totalTime=o;let d=this.resolveValue(t.oneByOne,i,!1);if(e){let t=u.timeSlices;(0,r.Z)(t)||(u.timeSlices=[t]);let e=0;u.timeSlices=u.timeSlices.map(t=>{let r=this.resolveValue(t.delay,i,0),s=this.resolveValue(t.delayAfter,i,0),n=this.resolveValue(t.duration,i,300);return e+=r+n+s,Object.assign(Object.assign({},t),{delay:r,delayAfter:s,duration:n})});let a=0;d&&(a="number"==typeof d?d:d?e:0),u.oneByOneDelay=a;let l=1;if(o){let t=e+a*(this._target.count-2);l=o?o/t:1}u.timeSlices=u.timeSlices.map(t=>{let e=t.effects;return Array.isArray(e)||(e=[e]),Object.assign(Object.assign({},t),{delay:t.delay*l,delayAfter:t.delayAfter*l,duration:t.duration*l,effects:e.map(t=>{var e,i;let r=null!=(e=t.custom)?e:n.builtInAnimateMap[null!=(i=t.type)?i:"fromTo"],a=r&&(0,s.Z)(r)?/^class\s/.test(Function.prototype.toString.call(r))?1:2:0;return Object.assign(Object.assign({},t),{custom:r,customType:a})})})}),u.oneByOneDelay=a*l,u.startTime=h*l}else{let e=this.resolveValue(t.delay,i,0),r=this.resolveValue(t.delayAfter,i,0),c=this.resolveValue(t.duration,i,300),p=0;d&&(p="number"==typeof d?d:d?e+r+c:0),u.oneByOneDelay=p,u.custom=null!=(a=t.custom)?a:n.builtInAnimateMap[null!=(l=t.type)?l:"fromTo"];let g=u.custom&&(0,s.Z)(u.custom)?/^class\s/.test(Function.prototype.toString.call(u.custom))?1:2:0;if(u.customType=g,o){let t=e+r+c+p*(this._target.count-2),i=o?o/t:1;u.delay=e*i,u.delayAfter=r*i,u.duration=c*i,u.oneByOneDelay=p*i,u.startTime=h}}return u}execute(t){Array.isArray(t)?t.forEach(t=>this._execute(t)):this._execute(t)}_execute(t){let e;if(t.selfOnly)return this._executeItem(t,this._target,0,1);let i="timeSlices"in t;i&&t.partitioner&&(e=(null!=e?e:this._target.getChildren()).filter(e=>{var i,r;return t.partitioner(null==(r=null==(i=e.context)?void 0:i.data)?void 0:r[0],e,{})})),i&&t.sort&&(e=null!=e?e:this._target.getChildren()).sort((e,i)=>{var r,s,n,a;return t.sort(null==(s=null==(r=e.context)?void 0:r.data)?void 0:s[0],null==(a=null==(n=i.context)?void 0:n.data)?void 0:a[0],e,i,{})});let r=i?(e,r,s)=>{let n=this.parseParams(t,i,e),a=this.executeTimelineItem(n,e,r,s);a&&this._trackAnimation(a)}:(e,r,s)=>{let n=this.parseParams(t,i,e),a=this.executeTypeConfigItem(n,e,r,s);a&&this._trackAnimation(a)};e?e.forEach((t,i)=>r(t,i,e.length)):this._target.count<=1?r(this._target,0,1):this._target.forEachChildren((t,e)=>r(t,e,this._target.count-1))}executeTypeConfigItem(t,e,i,r){var n,a,l,o,h,u,d,c;let{type:p="fromTo",channel:g,customParameters:f,easing:m="linear",delay:y=0,delayAfter:_=0,duration:v=300,startTime:b=0,oneByOneDelay:x=0,loop:S,bounce:k,priority:A=0,options:M,custom:w,customType:T,controlOptions:C}=t,E=e.animate();E.priority=A;let B=(0,s.Z)(y)?y(null==(a=null==(n=e.context)?void 0:n.data)?void 0:a[0],e,{}):y,P=null==(o=null==(l=e.context)?void 0:l.data)?void 0:o[0],O=null==(h=e.context)?void 0:h.indexKey;P&&O&&(i=null!=(u=P[O])?u:i),E.startAt(b);let I=i*x+B;I>0&&E.wait(I);let R=null,L=t.to,D=t.from;L||(R||(R=this.createPropsFromChannel(g,e)),L=R.props),D||(R||(R=this.createPropsFromChannel(g,e)),D=R.from),this._handleRunAnimate(E,w,T,D,L,v,m,f,C,M,p,e);let F=0;x&&(F=x*(r-i-1));let z=(0,s.Z)(_)?_(null==(c=null==(d=e.context)?void 0:d.data)?void 0:c[0],e,{}):_;return z>0&&(F+=z),F>0&&E.wait(F),S&&S>0&&E.loop(S),k&&E.bounce(!0),E}_handleRunAnimate(t,e,i,r,n,a,l,o,h,u,d,c){var p,g,f,m;if(e&&i){let d=Object.assign({width:c.stage.width,height:c.stage.height,group:this._target.parent},this.resolveValue(o,c)),y=(0,s.Z)(u)?u.call(null,null!=(g=d&&(null==(p=d.data)?void 0:p[0]))?g:null==(m=null==(f=c.context)?void 0:f.data)?void 0:m[0],c,d):u;d.options=y,d.controlOptions=h,1===i?this.createCustomAnimation(t,e,r,n,a,l,d):2===i&&this.createCustomInterpolatorAnimation(t,e,n,a,l,d)}else"to"===d?t.to(n,a,l):"from"===d&&t.from(n,a,l)}executeTimelineItem(t,e,i,r){var s,n,a,l;let{timeSlices:o,startTime:h=0,loop:u,bounce:d,oneByOneDelay:c,priority:p,controlOptions:g}=t,f=null==(n=null==(s=e.context)?void 0:s.data)?void 0:n[0],m=null==(a=e.context)?void 0:a.indexKey;f&&m&&(i=null!=(l=f[m])?l:i);let y=e.animate();return y.priority=p,y.startAt(h),y.wait(i*c),u&&u>0&&y.loop(u),d&&y.bounce(!0),(Array.isArray(o)?o:[o]).forEach(t=>{this.applyTimeSliceToAnimate(t,y,e,g)}),c&&y.wait(c*(r-i-1)),y}applyTimeSliceToAnimate(t,e,i,r){var a,l,o,h;let{effects:u,duration:d=300,delay:c=0,delayAfter:p=0}=t,g=(0,s.Z)(c)?c(null==(l=null==(a=i.context)?void 0:a.data)?void 0:l[0],i,{}):c,f=(0,s.Z)(p)?p(null==(h=null==(o=i.context)?void 0:o.data)?void 0:h[0],i,{}):p;g>0&&e.wait(g),(Array.isArray(u)?u:[u]).forEach(t=>{var s;let{type:a="fromTo",channel:l,customParameters:o,easing:h="linear",options:u}=t,c=null,p=t.to,g=t.from;p||(c||(c=this.createPropsFromChannel(l,i)),p=c.props),g||(c||(c=this.createPropsFromChannel(l,i)),g=c.from);let f=null!=(s=t.custom)?s:n.builtInAnimateMap[a],m=t.customType;this._handleRunAnimate(e,f,m,g,p,d,h,o,r,u,a,i)}),f>0&&e.wait(f)}createCustomInterpolatorAnimation(t,e,i,r,s,n){let a={};Object.keys(i).forEach(e=>{a[e]=t.target.getComputedAttribute(e)}),t.interpolateUpdateFunction=(i,r,s,a,l)=>{e(s,i,r,a,l,t.target,n)},t.to(i,r,s)}createCustomAnimation(t,e,i,r,s,n,a){let l=new e(i,r,s,n,a);t.play(l)}createPropsFromChannel(t,e){let i={},r=null;return t&&(Array.isArray(t)?t.forEach(t=>{var r,s;let n=null==(s=null==(r=e.context)?void 0:r.diffAttrs)?void 0:s[t];void 0!==n&&(i[t]=n)}):Object.keys(t).forEach(s=>{var n,a,l,o;let h=t[s];void 0!==h.to&&("function"==typeof h.to?i[s]=h.to(null==(a=null==(n=e.context)?void 0:n.data)?void 0:a[0],e,{}):i[s]=h.to),void 0!==h.from&&(r||(r={}),"function"==typeof h.from?r[s]=h.from(null==(o=null==(l=e.context)?void 0:l.data)?void 0:o[0],e,{}):r[s]=h.from)})),{from:r,props:i}}resolveValue(t,e,i){var r,s;return void 0===t?i:"function"==typeof t&&e?t(null==(s=null==(r=e.context)?void 0:r.data)?void 0:s[0],e,{}):t}executeItem(t,e,i=0,r=1){return Array.isArray(t)?t.map(t=>this._executeItem(t,e,i,r)).filter(Boolean):[this._executeItem(t,e,i,r)].filter(Boolean)}_executeItem(t,e,i=0,r=1){if(!e)return null;let s="timeSlices"in t,n=null,a=this.parseParams(t,s);return(n=s?this.executeTimelineItem(a,e,i,r):this.executeTypeConfigItem(a,e,i,r))&&this._trackAnimation(n),n}stop(t){for(;this._animates.length>0;){let e=this._animates.pop();null==e||e.stop(t)}this._animates=[],this._activeCount=0,this._started&&(this._started=!1,this.onEnd())}}n.builtInAnimateMap={}},31852:function(t,e,i){"use strict";i.d(e,{d:()=>b});var r=i(33430),s=i(87986),n=i(18367),a=i(16749),l=i(31535);let o="appear",h="disappear",u="update",d="highlight",c="unhighlight";class p{constructor(t){this.graphic=t}registerState(t){this.states||(this.states=new Map),this.states.set(t.name,t)}clearStates(){var t;null==(t=this.states)||t.clear()}}class g{constructor(t){this.stateList=null,this.graphic=t}applyState(t,e,i){let r=n.X.getInstance(),s=[],o=[];if(this.stateList&&this.stateList.length?t.forEach((t,i)=>{let n={allowTransition:!0};this.stateList.forEach(e=>{let i=r.isTransitionAllowed(e.state,t,this.graphic);n.allowTransition=n.allowTransition&&i.allowTransition}),n.allowTransition&&(o.push({state:t,animationConfig:(0,l.Z)(e[i])?e[i].map(t=>t.animation):e[i].animation,executor:new a.a(this.graphic)}),this.stateList.forEach(e=>{r.isTransitionAllowed(e.state,t,this.graphic).stopOriginalTransition&&s.push(e)}))}):t.forEach((t,i)=>{o.push({state:t,animationConfig:(0,l.Z)(e[i])?e[i].map(t=>t.animation):e[i].animation,executor:new a.a(this.graphic)})}),s.forEach(t=>{t.executor.stop()}),o.length){o[0].executor.execute(o[0].animationConfig);for(let t=0;t<o.length;t++){let e=o[t+1],r=o[t];r.executor.onEnd(()=>{e&&e.executor.execute(e.animationConfig),this.stateList=this.stateList.filter(t=>t!==r),t===o.length-1&&i&&i(!1)})}}else i&&i(!0);this.stateList?this.stateList=this.stateList.filter(t=>!s.includes(t)):this.stateList=[],this.stateList.push(...o)}applyAppearState(t,e){this.applyState([o],[{name:o,animation:t}],e)}applyDisappearState(t,e){this.applyState([h],[{name:h,animation:t}],e)}applyUpdateState(t,e){this.applyState([u],[{name:u,animation:t}],e)}applyHighlightState(t,e){this.applyState([d],[{name:d,animation:t}],e)}applyUnhighlightState(t,e){this.applyState([c],[{name:c,animation:t}],e)}stopState(t,e){var i;let r=null==(i=this.stateList)?void 0:i.find(e=>e.state===t);r&&r.executor.stop(e)}clearState(){var t;null==(t=this.stateList)||t.forEach(t=>{t.executor.stop()}),this.stateList=null}reApplyState(t){var e;let i=null==(e=this.stateList)?void 0:e.find(e=>e.state===t);if(i){let t=this.stateList.slice();i.executor.stop(),this.stateList=t,i.executor.execute(i.animationConfig)}}}class f{_getAnimationStateManager(t){return t._animationStateManager||(t._animationStateManager=new g(t)),t._animationStateManager}_getAnimationStateStore(t){return t._animationStateStore||(t._animationStateStore=new p(t)),t._animationStateStore}registerAnimationState(t){return this._getAnimationStateStore(this).registerState(t),this}applyAnimationState(t,e,i){return this._getAnimationStateManager(this).applyState(t,e,i),this}applyAppearState(t,e){return this._getAnimationStateManager(this).applyAppearState(t,e),this}applyDisappearState(t,e){return this._getAnimationStateManager(this).applyDisappearState(t,e),this}applyUpdateState(t,e){return this._getAnimationStateManager(this).applyUpdateState(t,e),this}applyHighlightState(t,e){return this._getAnimationStateManager(this).applyHighlightState(t,e),this}applyUnhighlightState(t,e){return this._getAnimationStateManager(this).applyUnhighlightState(t,e),this}stopAnimationState(t,e,i=!1){return this._getAnimationStateManager(this).stopState(t,e),i&&this.isContainer&&this.forEachChildren(r=>{r.stopAnimationState(t,e,i)}),this}clearAnimationStates(){let t=this._animationStateManager;return t&&t.clearState(),this}reApplyAnimationState(t,e=!1){let i=this._animationStateManager;return i&&i.reApplyState(t),e&&this.isContainer&&this.forEachChildren(i=>{i.reApplyAnimationState(t,e)}),this}static extend(t){return(new f)._getAnimationStateManager(t),t}}var m=i(75365),y=i(46511),_=i(88994);class v{getAttributes(t=!1){return t&&this.finalAttribute?this.finalAttribute:this.attribute}animate(t){var e,i,r;let s=new m.r(null==t?void 0:t.id,null!=(i=null!=(e=null==t?void 0:t.timeline)?e:this.stage&&this.stage.getTimeline())?i:y.P,null==t?void 0:t.slience);if(s.bind(this),t){let{onStart:e,onEnd:i,onRemove:r}=t;null!=e&&s.onStart(e),null!=i&&s.onEnd(i),null!=r&&s.onRemove(r)}return null==(r=this.stage)||r.ticker.start(),s}createTimeline(){return new y.L}createTicker(t){return new _.H(t)}setFinalAttributes(t){this.finalAttribute||(this.finalAttribute={}),Object.assign(this.finalAttribute,t)}initFinalAttributes(t){this.finalAttribute=t}initAnimateExecutor(){this._animateExecutor||(this._animateExecutor=new a.a(this))}executeAnimation(t){return this.initAnimateExecutor(),this._animateExecutor.execute(t),this}executeAnimations(t){return this.initAnimateExecutor(),t.forEach(t=>{this._animateExecutor.execute(t)}),this}getFinalAttribute(){return this.finalAttribute}getGraphicAttribute(t,e=!1){return!e&&this.finalAttribute?this.finalAttribute[t]:this.attribute[t]}pauseAnimation(t=!1){this.animates&&this.animates.forEach(t=>t.pause()),t&&this.isContainer&&this.forEachChildren(e=>{e.pauseAnimation(t)})}resumeAnimation(t=!1){this.animates&&this.animates.forEach(t=>t.resume()),t&&this.isContainer&&this.forEachChildren(e=>{e.resumeAnimation(t)})}stopAnimation(t=!1){this.animates&&this.animates.forEach(t=>t.stop()),t&&this.isContainer&&this.forEachChildren(e=>{e.stopAnimation(t)})}}function b(){(0,s.jB)(r.zs,f),(0,s.jB)(r.zs,v)}},18367:function(t,e,i){"use strict";i.d(e,{X:()=>r});class r{constructor(){this.transitions=new Map,this.registerDefaultTransitions()}static getInstance(){return r.instance||(r.instance=new r),r.instance}registerDefaultTransitions(){this.registerTransition("appear","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("appear","appear",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("appear","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("appear","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("normal","normal",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("normal","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("exit","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","enter",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","exit",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("enter","enter",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("enter","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("disappear","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("disappear","appear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("update","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("state","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","exit",()=>({allowTransition:!0,stopOriginalTransition:!0}))}isTransitionAllowed(t,e,i){var r,s,n,a;let l=null==(r=this.transitions.get(t))?void 0:r.get(e);return l||(l=null==(s=this.transitions.get(t))?void 0:s.get("*"))||(l=null==(n=this.transitions.get("*"))?void 0:n.get(e))||(l=null==(a=this.transitions.get("*"))?void 0:a.get("*"))?l(i,t):{allowTransition:!0,stopOriginalTransition:!0}}registerTransition(t,e,i){let r=this.transitions.get(t);r||(r=new Map,this.transitions.set(t,r)),r.set(e,i)}}r.getInstance()},36516:function(t,e,i){"use strict";i.d(e,{h:()=>p,o:()=>g});var r=i(35437),s=i(43644),n=i(88504);class a{constructor(){}static linear(t){return t}static none(){return this.linear}static get(t){return t<-1?t=-1:t>1&&(t=1),function(e){return 0===t?e:t<0?e*(-(e*t)+1+t):e*((2-e)*t+(1-t))}}static getPowIn(t){return function(e){return Math.pow(e,t)}}static getPowOut(t){return function(e){return 1-Math.pow(1-e,t)}}static getPowInOut(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}static getBackIn(t){return function(e){return e*e*((t+1)*e-t)}}static getBackOut(t){return function(e){return--e*e*((t+1)*e+t)+1}}static getBackInOut(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}static sineIn(t){return 1-Math.cos(t*Math.PI/2)}static sineOut(t){return Math.sin(t*Math.PI/2)}static sineInOut(t){return-(Math.cos(Math.PI*t)-1)/2}static expoIn(t){return 0===t?0:Math.pow(2,10*t-10)}static expoOut(t){return 1===t?1:1-Math.pow(2,-10*t)}static expoInOut(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}static circIn(t){return-(Math.sqrt(1-t*t)-1)}static circOut(t){return Math.sqrt(1- --t*t)}static circInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}static bounceOut(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}static bounceIn(t){return 1-a.bounceOut(1-t)}static bounceInOut(t){return t<.5?.5*a.bounceIn(2*t):.5*a.bounceOut(2*t-1)+.5}static getElasticIn(t,e){return function(i){if(0===i||1===i)return i;let r=e/n.f7*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*n.f7/e)}}static getElasticOut(t,e){return function(i){if(0===i||1===i)return i;let r=e/n.f7*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-r)*n.f7/e)+1}}static getElasticInOut(t,e){return function(i){let r=e/n.f7*Math.asin(1/t);return(i*=2)<1?-(t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*n.f7/e)*.5):t*Math.pow(2,-10*(i-=1))*Math.sin((i-r)*n.f7/e)*.5+1}}static registerFunc(t,e){a[t]=e}}a.quadIn=a.getPowIn(2),a.quadOut=a.getPowOut(2),a.quadInOut=a.getPowInOut(2),a.cubicIn=a.getPowIn(3),a.cubicOut=a.getPowOut(3),a.cubicInOut=a.getPowInOut(3),a.quartIn=a.getPowIn(4),a.quartOut=a.getPowOut(4),a.quartInOut=a.getPowInOut(4),a.quintIn=a.getPowIn(5),a.quintOut=a.getPowOut(5),a.quintInOut=a.getPowInOut(5),a.backIn=a.getBackIn(1.7),a.backOut=a.getBackOut(1.7),a.backInOut=a.getBackInOut(1.7),a.elasticIn=a.getElasticIn(1,.3),a.elasticOut=a.getElasticOut(1,.3),a.elasticInOut=a.getElasticInOut(1,.3*1.5),a.easeInOutQuad=t=>(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2),a.easeOutElastic=t=>{let e=2*Math.PI/3;return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1},a.easeInOutElastic=t=>{let e=2*Math.PI/4.5;return 0===t?0:1===t?1:t<.5?-Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*e)/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*e)/2+1};for(let t=0;t<10;t++)a[`flicker${t}`]=e=>(function(t,e){let i=1/e,r=1;for(;t>i;)t-=i,r*=-1;let s=r*t/i;return s>0?s:1+s})(e,t);for(let t=2;t<10;t++)a[`aIn${t}`]=e=>t*e*e+(1-t)*e;var l=i(58273),o=i(37967);let h=new class{constructor(){this.opacity=(t,e,i,r,s,n)=>{n.attribute.opacity=e+(i-e)*r},this.baseOpacity=(t,e,i,r,s,n)=>{n.attribute.baseOpacity=e+(i-e)*r},this.fillOpacity=(t,e,i,r,s,n)=>{n.attribute.fillOpacity=e+(i-e)*r},this.strokeOpacity=(t,e,i,r,s,n)=>{n.attribute.strokeOpacity=e+(i-e)*r},this.zIndex=(t,e,i,r,s,n)=>{n.attribute.zIndex=e+(i-e)*r},this.backgroundOpacity=(t,e,i,r,s,n)=>{n.attribute.backgroundOpacity=e+(i-e)*r},this.shadowOffsetX=(t,e,i,r,s,n)=>{n.attribute.shadowOffsetX=e+(i-e)*r},this.shadowOffsetY=(t,e,i,r,s,n)=>{n.attribute.shadowOffsetY=e+(i-e)*r},this.shadowBlur=(t,e,i,r,s,n)=>{n.attribute.shadowBlur=e+(i-e)*r},this.fill=(t,e,i,r,s,n)=>{n.attribute.fill=(0,l.BM)(e,i,r,!1)},this.fillPure=(t,e,i,r,s,n)=>{n.attribute.fill=s.fromParsedProps.fill?(0,l.Ib)(s.fromParsedProps.fill,s.toParsedProps.fill,r):s.toParsedProps.fill},this.stroke=(t,e,i,r,s,n)=>{n.attribute.stroke=(0,l.BM)(e,i,r,!1)},this.strokePure=(t,e,i,r,s,n)=>{n.attribute.stroke=s.fromParsedProps.stroke?(0,l.Ib)(s.fromParsedProps.stroke,s.toParsedProps.stroke,r):s.toParsedProps.stroke},this.width=(t,e,i,r,s,n)=>{n.attribute.width=e+(i-e)*r,n.addUpdateBoundTag()},this.height=(t,e,i,r,s,n)=>{n.attribute.height=e+(i-e)*r,n.addUpdateBoundTag()},this.x=(t,e,i,r,s,n)=>{n.attribute.x=e+(i-e)*r,n.addUpdateBoundTag(),n.addUpdatePositionTag()},this.y=(t,e,i,r,s,n)=>{n.attribute.y=e+(i-e)*r,n.addUpdateBoundTag(),n.addUpdatePositionTag()},this.dx=(t,e,i,r,s,n)=>{n.attribute.dx=e+(i-e)*r,n.addUpdateBoundTag(),n.addUpdatePositionTag()},this.dy=(t,e,i,r,s,n)=>{n.attribute.dy=e+(i-e)*r,n.addUpdateBoundTag(),n.addUpdatePositionTag()},this.angle=(t,e,i,r,s,n)=>{n.attribute.angle=e+(i-e)*r,n.addUpdateBoundTag(),n.addUpdatePositionTag()},this.scaleX=(t,e,i,r,s,n)=>{n.attribute.scaleX=e+(i-e)*r,n.addUpdateBoundTag(),n.addUpdatePositionTag()},this.scaleY=(t,e,i,r,s,n)=>{n.attribute.scaleY=e+(i-e)*r,n.addUpdateBoundTag(),n.addUpdatePositionTag()},this.lineWidth=(t,e,i,r,s,n)=>{n.attribute.lineWidth=e+(i-e)*r,n.addUpdateBoundTag()},this.startAngle=(t,e,i,r,s,n)=>{n.attribute.startAngle=e+(i-e)*r,n.addUpdateBoundTag()},this.endAngle=(t,e,i,r,s,n)=>{n.attribute.endAngle=e+(i-e)*r,n.addUpdateBoundTag()},this.radius=(t,e,i,r,s,n)=>{n.attribute.radius=e+(i-e)*r,n.addUpdateBoundTag()},this.outerRadius=(t,e,i,r,s,n)=>{n.attribute.outerRadius=e+(i-e)*r,n.addUpdateBoundTag()},this.innerRadius=(t,e,i,r,s,n)=>{n.attribute.innerRadius=e+(i-e)*r,n.addUpdateBoundTag()},this.size=(t,e,i,r,s,n)=>{n.attribute.size=e+(i-e)*r,n.addUpdateBoundTag()},this.points=(t,e,i,r,s,n)=>{n.attribute.points=(0,o.SA)(e,i,r),n.addUpdateBoundTag()}}};function u(t,e,i,r,s,n){if(Number.isFinite(i)&&Number.isFinite(e))return n.attribute[t]=e+(i-e)*r,!0;if(Array.isArray(i)&&Array.isArray(e)&&i.length===e.length){let s=[],a=!0;for(let t=0;t<i.length;t++){let n=e[t],l=n+(i[t]-n)*r;if(!Number.isFinite(l)){a=!1;break}s.push(l)}return a&&(n.attribute[t]=s),!0}return!1}var d=i(30756);function c(){}class p{constructor(t,e,i,s){var n;this._startTime=0,this._hasFirstRun=!1,this._syncAttributeUpdate=()=>{this.target.setAttributes(this.target.attribute)},this.type=t,this.props=e,this.duration=i,this.easing=s?"function"==typeof s?s:null!=(n=a[s])?n:a.linear:a.linear,"wait"===t&&(this.onUpdate=c),this.id=r.R.GenAutoIncrementId(),this.syncAttributeUpdate=c}bind(t,e){this.target=t,this.animate=e,this.onBind(),this.syncAttributeUpdate()}append(t){this.next=t,t.prev=this,t.setStartTime(this.getStartTime()+this.duration,!1)}updateDownstreamStartTimes(){let t=this.next,e=this._startTime+this.duration;for(;t;)t.setStartTime(e,!1),e+=t.duration,t=t.next;this.animate.updateDuration()}getLastProps(){return this.prev?this.prev.props||{}:this.animate.getStartProps()}setDuration(t,e=!0){this.duration=t,e&&this.updateDownstreamStartTimes()}getDuration(){return this.duration}determineInterpolateUpdateFunction(){if(!this.props)return;let t=[];this.propKeys.forEach(e=>{if("fill"===e||"stroke"===e){let i=this.fromProps[e],r=this.props[e];if((0,d.Z)(i)&&(0,d.Z)(r)){let n=s.VH.Get(i,s.Mr.Color255),a=s.VH.Get(r,s.Mr.Color255);this.fromParsedProps||(this.fromParsedProps={}),this.toParsedProps||(this.toParsedProps={}),this.fromParsedProps[e]=n,this.toParsedProps[e]=a,t.push(h["fill"===e?"fillPure":"strokePure"])}else h[e]?t.push(h[e]):t.push(u)}else h[e]?t.push(h[e]):t.push(u)}),this.interpolateUpdateFunctions=t}setStartTime(t,e=!0){this._startTime=t,e&&this.updateDownstreamStartTimes()}getStartTime(){return this._startTime}onBind(){"glyph"===this.target.type&&(this.syncAttributeUpdate=this._syncAttributeUpdate)}onFirstRun(){}onStart(){if(!this._hasFirstRun){this._hasFirstRun=!0,this.fromProps=this.getLastProps();let t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.fromProps[e]=null!=(i=this.fromProps[e])?i:t[e]}),this.determineInterpolateUpdateFunction(),this.tryPreventConflict(),this.trySyncStartProps(),this.onFirstRun()}}tryPreventConflict(){let t=this.animate;this.target.animates.forEach(e=>{if(e===t||e.priority>t.priority||e.priority===1/0)return;let i=e.getStartProps();this.propKeys.forEach(t=>{null!=i[t]&&e.preventAttr(t)})})}deleteSelfAttr(t){var e;delete this.props[t],this.fromProps&&delete this.fromProps[t];let i=this.propKeys.indexOf(t);-1!==i&&(this.propKeys.splice(i,1),null==(e=this.interpolateUpdateFunctions)||e.splice(i,1))}trySyncStartProps(){this.propKeys.forEach(t=>{this.fromProps[t]=this.animate.target.getComputedAttribute(t)})}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;let r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((t,e)=>{if(!this.animate.validAttr(this.propKeys[e]))return;let i=this.propKeys[e];t(i,this.fromProps[i],this.props[i],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}onUpdate(t,e,i){}onEnd(t){this.target.setAttributes(this.props),t?this._endCb=t:this._endCb&&this._endCb(this.animate,this)}getEndProps(){return this.props}getFromProps(){return this.fromProps}getMergedEndProps(){return this.getEndProps()}stop(){}}class g extends p{constructor(t,e,i,r){super(t,e,i,r)}onStart(){super.onStart()}onFirstRun(){let t=this.getFromProps();this.target.setAttributes(t)}update(t,e,i){this.onStart()}determineInterpolateUpdateFunction(){}}},88994:function(t,e,i){"use strict";i.d(e,{H:()=>u});var r=i(21883),s=i.n(r),n=i(94966),a=i(94927),l=i(96087);let o=new n.A;class h{constructor(){this.released=!1}tick(t,e){o.addAnimationFrameCb(()=>{if(!this.released)return e(this)})}release(){this.released=!0}getTime(){return Date.now()}}class u extends s(){constructor(t){super(),this.timelines=[],this.frameTimeHistory=[],this.handleTick=(t,e)=>{let{once:i=!1}=null!=e?e:{};if(this.ifCanStop())return this.stop(),!1;let r=t.getTime();this._lastTickTime=r,this.lastFrameTime<0&&(this.lastFrameTime=r-this.interval+this.timeOffset,this.frameTimeHistory.push(this.lastFrameTime));let s=r-this.lastFrameTime,n=this.checkSkip(s);return n||(this._handlerTick(s),this.lastFrameTime=r,this.frameTimeHistory.push(this.lastFrameTime)),i||t.tick(this.interval,this.handleTick),!n},this._handlerTick=t=>{this.status===a.Q.RUNNING&&(this.tickCounts++,this.timelines.forEach(e=>{e.tick(t)}),this.emit("tick",t))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.stage=t,this.autoStop=!0,this.interval=16,this.computeTimeOffsetAndJitter()}bindStage(t){this.stage=t}computeTimeOffsetAndJitter(){this.timeOffset=Math.floor(Math.random()*this.interval),this._jitter=Math.min(Math.max(.2*this.interval,6),.7*this.interval)}init(){this.interval=16,this.status=a.Q.INITIAL,l.w.global.hooks.onSetEnv.tap("graph-ticker",()=>{this.initHandler(!1)}),l.w.global.env&&this.initHandler(!1)}addTimeline(t){this.timelines.push(t)}remTimeline(t){this.timelines=this.timelines.filter(e=>e!==t)}getTimelines(){return this.timelines}initHandler(t=!1){this.setupTickHandler(t)}setupTickHandler(t=!1){if(!t&&this.tickerHandler)return!0;let e=new h;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=e,!0}setInterval(t){this.interval=t,this.computeTimeOffsetAndJitter()}getInterval(){return this.interval}setFPS(t){this.setInterval(Math.floor(1e3/t))}getFPS(){return 1e3/this.interval}tick(t){this.tickerHandler.tick(t,t=>this.handleTick(t,{once:!0}))}tickTo(t){this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,t=>{this.handleTick(t,{once:!0})})}pause(){return this.status!==a.Q.INITIAL&&(this.status=a.Q.PAUSE,!0)}resume(){return this.status!==a.Q.INITIAL&&(this.status=a.Q.RUNNING,!0)}ifCanStop(){return!!(this.autoStop&&(!this.timelines.length||this.timelines.every(t=>!t.isRunning())))||!1}start(t=!1){return!(this.status===a.Q.RUNNING||!this.tickerHandler||!t&&(this.status===a.Q.PAUSE||this.ifCanStop()))&&(this.status=a.Q.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0)}stop(){this.status=a.Q.INITIAL,this.setupTickHandler(!0),this.lastFrameTime=-1}trySyncTickStatus(){this.status===a.Q.INITIAL&&this.timelines.some(t=>t.isRunning())?this.start():this.status===a.Q.RUNNING&&this.timelines.every(t=>!t.isRunning())&&this.stop()}release(){var t;this.stop(),this.timelines=[],null==(t=this.tickerHandler)||t.release(),this.tickerHandler=null,this.lastFrameTime=-1}checkSkip(t){var e,i,r;return"performance"!==(null==(r=null==(i=null==(e=this.stage)?void 0:e.params)?void 0:i.optimize)?void 0:r.tickRenderMode)&&t<this.interval+2*(Math.random()-.5)*this._jitter}}},46511:function(t,e,i){"use strict";i.d(e,{L:()=>l,P:()=>o});var r=i(35437),s=i(72949),n=i(21883),a=i.n(n);class l extends a(){get animateCount(){return this._animateCount}constructor(){super(),this.head=null,this.tail=null,this.animateMap=new Map,this._animateCount=0,this._playSpeed=1,this._totalDuration=0,this._startTime=0,this._currentTime=0,this._animationEndFlag=!0,this.id=r.R.GenAutoIncrementId(),this.paused=!1}isRunning(){return!this.paused&&this._animateCount>0}forEachAccessAnimate(t){let e=this.head,i=0;for(;e;){let r=e.next;t(e.animate,i),i++,e=r}}addAnimate(t){let e={animate:t,next:null,prev:null};this.head?this.tail&&(this.tail.next=e,e.prev=this.tail,this.tail=e):(this.head=e,this.tail=e),this.animateMap.set(t,e),this._animateCount++,this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())}pause(){this.paused=!0}resume(){this.paused=!1}tick(t){if(this.paused)return;this._animationEndFlag&&(this._animationEndFlag=!1,this.emit("animationStart"));let e=t*this._playSpeed;this._currentTime+=e,this.forEachAccessAnimate((t,i)=>{t.status===s.t.END?this.removeAnimate(t,!0):t.status!==s.t.RUNNING&&t.status!==s.t.INITIAL||t.advance(e)}),0===this._animateCount&&(this._animationEndFlag=!0,this.emit("animationEnd"))}clear(){this.forEachAccessAnimate(t=>{t.release()}),this.head=null,this.tail=null,this.animateMap.clear(),this._animateCount=0,this._totalDuration=0}removeAnimate(t,e=!0){let i=this.animateMap.get(t);i&&(e&&(t._onRemove&&t._onRemove.forEach(t=>t()),t.release()),i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev,this.animateMap.delete(t),this._animateCount--,t.getStartTime()+t.getDuration()>=this._totalDuration&&this.recalculateTotalDuration())}recalculateTotalDuration(){this._totalDuration=0,this.forEachAccessAnimate(t=>{this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())})}getTotalDuration(){return this._totalDuration}getPlaySpeed(){return this._playSpeed}setPlaySpeed(t){this._playSpeed=t}getPlayState(){return this.paused?"paused":0===this.animateCount?"stopped":"playing"}setStartTime(t){this._startTime=t}getStartTime(){return this._startTime}getCurrentTime(){return this._currentTime}setCurrentTime(t){this._currentTime=t}}let o=new l;o.isGlobal=!0},50487:function(t,e,i){"use strict";i.d(e,{g:()=>l});var r=i(28076),s=i(43562),n=i(95950),a=i(31535);class l extends r.k{_prepareAnimate(t){if(!1!==this.attribute.animation){let{animation:e,animationEnter:i,animationExit:r,animationUpdate:l}=this.attribute,o=(0,s.Z)(e)?e:{};this._animationConfig={enter:!1!==i&&(0,n.Z)({},t,o,null!=i?i:{}),exit:!1!==r&&(0,n.Z)({},t,o,null!=r?r:{}),update:!1!==l&&((0,a.Z)(l)?l:(0,n.Z)({},t,o,null!=l?l:{}))}}else this._animationConfig={enter:!1,exit:!1,update:!1}}}},44368:function(t,e,i){"use strict";i.d(e,{I:()=>A});var r=i(20672),s=i(31535),n=i(98116),a=i(80875);function l(t){return Object.prototype.toString.call(t)}function o(t){return Object.keys(t)}var h=i(92493),u=i(47704),d=i(95950),c=i(88504),p=i(59225),g=i(47979),f=i(42465),m=i(11165),y=i(19660),_=i(89542),v=i(46293),b=i(93227),x=i(47700),S=i(50487);let k={type:"default",duration:300,easing:"linear"};class A extends S.g{constructor(){super(...arguments),this.name="axis",this.data=[],this.tickLineItems=[],this.subTickLineItems=[],this.axisLabelLayerSize={},this.axisLabelsContainer=null,this._onHover=t=>{this._lastHover=(0,x.fM)(t,this.axisContainer,this._lastHover)},this._onUnHover=t=>{this._lastHover=(0,x.lO)(t,this.axisContainer,this._lastHover)},this._onClick=t=>{this._lastSelect=(0,x.Q6)(t,this.axisContainer,this._lastSelect)}}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}getBoundsWithoutRender(t){let e=(0,h.Z)(this.attribute);e.scale=this.attribute.scale,this.attribute=t;let i=r.i.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}render(){this._prepare(),this._prevInnerView=this._innerView&&(0,b.uX)(this._innerView),this.removeAllChild(!0),this._innerView=r.i.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent(),this.runAnimation()}_prepare(){this._prepareAnimate(k)}_bindEvent(){if(this.attribute.disableTriggerEvent)return;let{hover:t,select:e}=this.attribute;t&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),e&&this._innerView.addEventListener("pointerdown",this._onClick)}_renderInner(t){let{title:e,label:i,tick:s,line:n,items:a}=this.attribute,l=r.i.group({x:0,y:0,zIndex:1,pickable:!1});if(l.name=y.X9.axisContainer,l.id=this._getNodeId("container"),l.setMode(this.mode),this.axisContainer=l,t.add(l),n&&n.visible&&this.renderLine(l),a&&a.length&&(this.data=this._transformItems(a[0]),s&&s.visible&&this.renderTicks(l),i&&i.visible)){let t=r.i.group({x:0,y:0,pickable:!1});t.name=y.X9.labelContainer,t.id=this._getNodeId("label-container"),this.axisLabelsContainer=t,l.add(t),a.forEach((e,i)=>{let r=this.renderLabels(t,e,i),s=r.getChildren();this.beforeLabelsOverlap(s,e,r,i,a.length),this.handleLabelsOverlap(s,e,r,i,a.length),this.afterLabelsOverlap(s,e,r,i,a.length);let n=0,l=0,o="center",h="middle",u=0;s.forEach((t,e)=>{var i;let r=t.attribute,s=null!=(i=r.angle)?i:0,a=t.AABBBounds,d=a.width(),c=a.height();s&&(d=Math.abs(d*Math.cos(s)),c=Math.abs(c*Math.sin(s))),n=Math.max(n,d),l=Math.max(l,c),o=r.textAlign,h=r.textBaseline,0===e&&(u=r.x)}),this.axisLabelLayerSize[i]={width:n,height:l,labelPos:u,textAlign:o,textBaseline:h}})}e&&e.visible&&this.renderTitle(l)}renderTicks(t){let e=this.getTickLineItems(),i=r.i.group({x:0,y:0,pickable:!1});i.name=y.X9.tickContainer,i.id=this._getNodeId("tick-container"),t.add(i),e.forEach((t,s)=>{var a;let l=r.i.line(Object.assign({},this._getTickLineAttribute("tick",t,s,e)));if(l.name=y.X9.tick,l.id=this._getNodeId(t.id),(0,u.Z)(null==(a=this.attribute.tick)?void 0:a.state))l.states=m.n0;else{let t=this.data[s],e=(0,d.Z)({},m.n0,this.attribute.tick.state);Object.keys(e).forEach(i=>{(0,n.Z)(e[i])&&(e[i]=e[i](t.rawValue,s,t,this.data))}),l.states=e}i.add(l)}),this.tickLineItems=e;let{subTick:s}=this.attribute;if(s&&s.visible){let t=this.getSubTickLineItems();t.length&&t.forEach((t,a)=>{let l=r.i.line(Object.assign({},this._getTickLineAttribute("subTick",t,a,e)));if(l.name=y.X9.subTick,l.id=this._getNodeId(`${a}`),(0,u.Z)(s.state))l.states=m.n0;else{let i=(0,d.Z)({},m.n0,s.state);Object.keys(i).forEach(r=>{(0,n.Z)(i[r])&&(i[r]=i[r](t.value,a,t,e))}),l.states=i}i.add(l)}),this.subTickLineItems=t}}renderLabels(t,e,i){let{dataFilter:s}=this.attribute.label;s&&(0,n.Z)(s)&&(e=s(e,i));let a=this._transformItems(e),l=r.i.group({x:0,y:0,pickable:!1});return l.name=`${y.X9.labelContainer}-layer-${i}`,l.id=this._getNodeId(`label-container-layer-${i}`),t.add(l),a.forEach((t,e)=>{var r;let s=this._getLabelAttribute(t,e,a,i),o=(0,g.vS)(s);if(o.name=y.X9.label,o.id=this._getNodeId(`layer${i}-label-${t.id}`),(0,u.Z)(null==(r=this.attribute.label)?void 0:r.state))o.states=m.n0;else{let r=(0,d.Z)({},m.n0,this.attribute.label.state);Object.keys(r).forEach(s=>{(0,n.Z)(r[s])&&(r[s]=r[s](t,e,a,i))}),o.states=r}o.data=Object.assign(Object.assign({},t),{index:e,layer:i}),l.add(o)}),l}renderTitle(t){let e=this.getTitleAttribute(),i=new v.V(Object.assign({},e));i.name=y.X9.title,i.id=this._getNodeId("title"),t.add(i)}getVerticalCoord(t,e,i){return(0,b.cN)(t,this.getVerticalVector(e,i,t))}getTickLineItems(){let{tick:t}=this.attribute,e=this.data,i=[],{alignWithLabel:r,inside:s=!1,length:a,dataFilter:l}=t,o=1;return e.length>=2&&(o=e[1].value-e[0].value),(l&&(0,n.Z)(l)?l(e):e).forEach(t=>{let e=t.point,n=t.value;if(!r){let i=t.value-o/2;if(this.isInValidValue(i))return;e=this.getTickCoord(i),n=i}let l=this.getVerticalCoord(e,a,s);if("3d"===this.mode){let r=this.getVerticalVector(a,s,e),o=0,h=0;(0,c.Wn)(r[0])>(0,c.Wn)(r[1])?o=c.pi/2*(l.x>e.x?1:-1):h=c.pi/2*(l.y>e.y?-1:1),i.push({start:e,end:l,value:n,id:`tick-${t.id}`,anchor:[e.x,e.y],alpha:o,beta:h})}else i.push({start:e,end:l,value:n,id:`tick-${t.id}`})}),i}getSubTickLineItems(){let{subTick:t}=this.attribute,e=[],{count:i=4,inside:r=!1,length:s=2}=t,n=this.tickLineItems,a=n.length;if(a>=2)for(let t=0;t<a-1;t++){let a=n[t],l=n[t+1];for(let t=0;t<i;t++){let n=(t+1)/(i+1),o=(1-n)*a.value+n*l.value,h=this.getTickCoord(o),u=this.getVerticalCoord(h,s,r);e.push({start:h,end:u,value:o,id:`sub-tick-${o}`})}}return e}_getTickLineAttribute(t,e,i,r){let s=(0,p.Z)(this.attribute,`${t}.style`),a=this.data[i];s=(0,n.Z)(s)?(0,d.Z)({},(0,p.Z)(_.p,`${t}.style`),"tick"===t?s(a.rawValue,i,a,this.data):s(e.value,i,e,r)):s;let{start:l,end:o,anchor:h,alpha:u,beta:c}=e;return Object.assign({points:[l,o],anchor:h,alpha:u,beta:c},s)}_getLabelAttribute(t,e,i,r){var s,a;let{space:l=4,inside:o=!1,formatMethod:h,type:u="text",text:c}=this.attribute.label,g=l,f=0;(null==(s=this.attribute.tick)?void 0:s.visible)&&this.attribute.tick.inside===o&&(f=this.attribute.tick.length||4),(null==(a=this.attribute.subTick)?void 0:a.visible)&&this.attribute.subTick.inside===o&&(f=Math.max(f,this.attribute.subTick.length||2)),g+=f;let m=this.getRelativeVector(t.point);r>0&&(0===m[1]?g+=(this.axisLabelLayerSize[r-1].height+(0,p.Z)(this.attribute,"label.space",4))*r:g+=(this.axisLabelLayerSize[r-1].width+(0,p.Z)(this.attribute,"label.space",4))*r);let y=this.getVerticalCoord(t.point,g,o),v=this.getVerticalVector(g||1,o,y),b=h?h(`${t.label}`,t,e,i,r):t.label,{style:x}=this.attribute.label;x=(0,n.Z)(x)?(0,d.Z)({},_.p.label.style,x(t,e,i,r)):x;let S=this.getLabelAlign(v,o,x.angle);return x=(0,d.Z)(S,x),(0,n.Z)(x.text)&&(x.text=x.text({label:t.label,value:t.rawValue,index:t.index,layer:r})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(y,v,b,x)),{text:null!=c?c:b,_originText:t.label,lineHeight:null==x?void 0:x.fontSize,type:u}),x)}getLabelPosition(t,e,i,r){return t}_transformItems(t){let e=[];return t.forEach(t=>{var i;e.push(Object.assign(Object.assign({},t),{point:this.getTickCoord(t.value),id:null!=(i=t.id)?i:t.label}))}),e}runAnimation(){let t=this.lastScale;if(this.attribute.scale){let t=this.attribute.scale;this.lastScale=t.clone(),this.lastScale.range([0,1])}if(this.attribute.animation&&this.applyAnimationState){let e=this.getInnerView(),i=this.getPrevInnerView();if(!i)return;let r=this._animationConfig;this._newElementAttrMap={},(0,f.Ck)(e,e=>{var h;if("group"!==e.type&&e.id){let u=i[e.id];if(e.setFinalAttributes(e.attribute),u){u.release();let i=u.attribute,d=e.getFinalAttribute(),c=function(t,e,i){let r={};for(let i in e)i in t&&function t(e,i,r){if(e===i)return!0;if(typeof e!=typeof i||null==e||null==i)return!1;if(Number.isNaN(e)&&Number.isNaN(i))return!0;if(l(e)!==l(i))return!1;if((0,n.Z)(e))return!!(null==r?void 0:r.skipFunction);if("object"!=typeof e)return!1;if((0,s.Z)(e)){if(e.length!==i.length)return!1;for(let s=e.length-1;s>=0;s--)if(!t(e[s],i[s],r))return!1;return!0}if(!(0,a.Z)(e))return!1;let h=o(e),u=o(i);if(h.length!==u.length)return!1;h.sort(),u.sort();for(let t=h.length-1;t>=0;t--)if(h[t]!=u[t])return!1;for(let s=h.length-1;s>=0;s--){let n=h[s];if(!t(e[n],i[n],r))return!1}return!0}(t[i],e[i])||(r[i]=e[i]);return r}(i,d),p=Object.keys(c).length>0;if("opacity"in i&&d.opacity!==i.opacity&&(c.opacity=null!=(h=d.opacity)?h:1,p=!0),r.update&&p){this._newElementAttrMap[e.id]={state:"update",node:e,attrs:e.attribute};let i=u.attribute;e.setAttributes(i),e.applyAnimationState(["update"],[{name:"update",animation:Object.assign(Object.assign({selfOnly:!0},r.update),{type:"axisUpdate",customParameters:{config:r.update,diffAttrs:c,lastScale:t}})}])}}else r.enter&&(this._newElementAttrMap[e.id]={state:"enter",node:e,attrs:e.attribute},e.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r.enter),{type:"axisEnter",selfOnly:!0,customParameters:{config:r.enter,lastScale:t,getTickCoord:this.getTickCoord.bind(this)}})}]))}})}}release(){super.release(),this._prevInnerView=null,this._innerView=null}}},89542:function(t,e,i){"use strict";i.d(e,{P:()=>s,p:()=>r});let r={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},s={size:8,stroke:"#000",lineWidth:1,zIndex:1}},19660:function(t,e,i){"use strict";var r,s,n,a;i.d(e,{X9:()=>r,bz:()=>o,n0:()=>l}),(n=r||(r={})).innerView="inner-view",n.axisContainer="axis-container",n.labelContainer="axis-label-container",n.tickContainer="axis-tick-container",n.tick="axis-tick",n.subTick="axis-sub-tick",n.label="axis-label",n.title="axis-title",n.gridContainer="axis-grid-container",n.grid="axis-grid",n.gridRegion="axis-grid-region",n.line="axis-line",n.background="axis-background",n.axisLabelBackground="axis-label-background",n.axisBreak="axis-break",n.axisBreakSymbol="axis-break-symbol",(a=s||(s={})).selected="selected",a.selectedReverse="selected_reverse",a.hover="hover",a.hoverReverse="hover_reverse";let l={[s.selectedReverse]:{},[s.selected]:{},[s.hover]:{},[s.hoverReverse]:{}},o=999},7210:function(t,e,i){"use strict";i.d(e,{$:()=>R});var r=i(95950),s=i(47704),n=i(25258),a=i(59225),l=i(35652),o=i(70501),h=i(88663),u=i(98116),d=i(21777),c=i(11681),p=i(87986),g=i(20672),f=i(27589),m=i(8843),y=i(44368),_=i(89542),v=i(19660),b=i(47979),x=i(10308),S=i(98706),k=i(47187);function A(t=0){if(t<0)for(;t<0;)t+=2*Math.PI;if(t>0)for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function M(t,e=0){let i,r=["center","left","left","left","center","right","right","right","left"],s=["top","top","middle","bottom","bottom","bottom","middle","top","top"];"top"===t&&(r=["center","right","right","right","center","left","left","left","right"],s=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);let n=(e=A(e))/(.5*Math.PI);return{textAlign:r[i=n===Math.floor(n)?2*Math.floor(n):2*Math.floor(n)+1],textBaseline:s[i]}}function w(t,e=0){let i,r=["right","right","center","left","left","left","center","right","right"],s=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];"right"===t&&(r=["left","left","center","right","right","right","center","left","left"],s=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);let n=(e=A(e))/(.5*Math.PI);return{textAlign:r[i=n===Math.floor(n)?2*Math.floor(n):2*Math.floor(n)+1],textBaseline:s[i]}}var T=i(43562),C=i(88504);function E(t,e,i){let r;return(0,o.Z)(e)&&(r=Math.abs(e-t)),(0,o.Z)(i)&&(r=(0,o.Z)(r)?Math.min(Math.abs(t-i),r):Math.abs(t-i)),r}var B=i(34687),P=i(71060),O=i(93227),I=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};(0,P.Vu)();class R extends y.I{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},R.defaultAttributes,t),e)}_renderInner(t){var e;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){let t=[];for(let e=0;e<this.attribute.breaks.length;e++){let{range:i,breakSymbol:r,rawRange:s}=this.attribute.breaks[e];t.push({startPoint:this.getTickCoord(i[0]),endPoint:this.getTickCoord(i[1]),range:i,breakSymbol:r,rawRange:s})}this._breaks=t}super._renderInner(t),this._breaks&&this._breaks.length&&this._breaks.forEach((e,i)=>{let{startPoint:r,endPoint:s,breakSymbol:n,rawRange:a}=e;if(!1!==(null==n?void 0:n.visible)){let e=g.i.group({zIndex:v.bz});e.name=v.X9.axisBreak,e.id=this._getNodeId(`${v.X9.axisBreak}-${i}`),e.data=a;let l=(0,O.uf)(n),o=g.i.symbol(Object.assign({x:r.x,y:r.y},l));o.name=v.X9.axisBreakSymbol;let h=g.i.symbol(Object.assign({x:s.x,y:s.y},l));h.name=v.X9.axisBreakSymbol,e.add(o),e.add(h),t.add(e)}});let{panel:i}=this.attribute;if(i&&i.visible){let t=this.axisContainer,s=t.AABBBounds,n=g.i.rect(Object.assign({x:s.x1,y:s.y1,width:s.width(),height:s.height()},i.style));n.name=v.X9.background,n.id=this._getNodeId("background"),n.states=(0,r.Z)({},v.n0,null!=(e=i.state)?e:{}),t.insertBefore(n,t.firstChild)}}renderLine(t){let{start:e,end:i,line:n}=this.attribute,{startSymbol:a,endSymbol:l,style:o,state:h}=n,u=Object.assign({startSymbol:a,endSymbol:l,lineStyle:o},I(n,["startSymbol","endSymbol","style","state"]));if(this._breaks&&this._breaks.length){let t=[],r=e;this._breaks.forEach(e=>{let{startPoint:i,endPoint:s}=e;t.push([r,i]),r=s}),t.push([r,i]),u.points=t,u.multiSegment=!0}else u.points=[e,i];(0,s.Z)(h)||(u.state={line:(0,r.Z)({},v.n0,h),symbol:(0,r.Z)({},v.n0,h)});let d=new f.X(u);d.name=v.X9.line,d.id=this._getNodeId("line"),t.add(d)}getTextAlign(t){let e="center";return(0,n.Yt)(t[0],0)?(0,n.Yt)(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}getTitleAttribute(){var t,e,i;let s=this.attribute.title,{position:n="middle",space:h=4,textStyle:u={},autoRotate:d=!0,shape:c,background:p,state:g={},maxWidth:f}=s,y=I(s,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]),_=.5;"start"===n?_=0:"end"===n&&(_=1);let{verticalFactor:b=1}=this.attribute,x=this.getTickCoord(_),S=this.getRelativeVector(),k=0;if((null==(t=this.attribute.label)?void 0:t.visible)&&!1===this.attribute.label.inside){let t=+(0,a.Z)(this.attribute,"label.space",4);k+=t;let e=Object.keys(this.axisLabelLayerSize).length;if(0===S[1]){let i=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(i)?k+=i+(e-1)*t:k=0}else if(0===S[0])if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){let i=this.axisLabelLayerSize[0].labelPos,r=this.axisLabelsContainer.AABBBounds;k+=(1==-1*b?r.x2>i?Math.min(r.x2-i,r.width()):0:r.x1<i?Math.min(i-r.x1,r.width()):0)+(e-1)*t}else k=0;else Object.keys(this.axisLabelLayerSize).forEach((e,i)=>{k+=this.axisLabelLayerSize[e].width+(i>0?t:0)})}let A=0;(null==(e=this.attribute.tick)?void 0:e.visible)&&!1===this.attribute.tick.inside&&(A=this.attribute.tick.length||4),(null==(i=this.attribute.subTick)?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(A=Math.max(A,this.attribute.subTick.length||2));let M=A+k+h,w=this.getVerticalCoord(x,M,!1),T=this.getVerticalVector(M,!1,{x:0,y:0}),C,E,{angle:B}=y;if(C="start"===n?"start":"end"===n?"end":"center",(0,l.Z)(B)&&d){B=(0,m.Dg)(S,[1,0],!0);let{verticalFactor:t=1}=this.attribute;E=1==-1*t?"bottom":"top"}else C=this.getTextAlign(T),E=this.getTextBaseline(T,!1);let P=f;if((0,l.Z)(P)){let{verticalLimitSize:t,verticalMinSize:e,orient:i}=this.attribute,r=Math.min(t||1/0,e||1/0);if((0,o.Z)(r))if("bottom"===i||"top"===i)if(B!==Math.PI/2){let t=Math.abs(Math.cos(null!=B?B:0));P=t<1e-6?1/0:this.attribute.end.x/t}else P=r-M;else if(B&&0!==B){let t=Math.abs(Math.sin(B));P=t<1e-6?1/0:this.attribute.end.y/t}else P=r-M}let O=Object.assign(Object.assign(Object.assign({},w),y),{maxWidth:P,textStyle:Object.assign({textAlign:C,textBaseline:E},u),state:{text:(0,r.Z)({},v.n0,g.text),shape:(0,r.Z)({},v.n0,g.shape),panel:(0,r.Z)({},v.n0,g.background)}});return O.angle=B,c&&c.visible&&(O.shape=Object.assign({visible:!0},c.style),c.space&&(O.space=c.space)),p&&p.visible&&(O.panel=Object.assign({visible:!0},p.style)),O}getTextBaseline(t,e){let i="middle",{verticalFactor:r=1}=this.attribute;return(0,n.Yt)(t[1],0)?i=!(0,n.Yt)(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":1==(e?1:-1)*r?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}getLabelAlign(t,e,i){let r=this.attribute.orient;if(["top","bottom","right","left"].includes(r)||0===t[0]&&0===t[1]){if("top"===r||"bottom"===r)return M(e?"bottom"===r?"top":"bottom":r,i);if("left"===r||"right"===r)return w(e?"left"===r?"right":"left":r,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}beforeLabelsOverlap(t,e,i,r,s){var n,a,l,o;let{flush:u=!1}=this.attribute.label||{};if(u&&t.length){let{orient:e,start:i,end:r}=this.attribute,s="bottom"===e||"top"===e,u=t[0],d=(0,h.Z$)(t),c=s?u.attribute.x>d.attribute.x:u.attribute.y<d.attribute.y;if(s){let t=c?d:u,e=c?u:d,s=i.x,l=r.x,o=t.AABBBounds.x1,h=e.AABBBounds.x2;o<s&&(t.attribute.angle?t.setAttributes({dx:(null!=(n=t.attribute.dx)?n:0)+s-o}):t.setAttributes({x:s,textAlign:"left"})),h>l&&(e.attribute.angle?e.setAttributes({dx:(null!=(a=e.attribute.dx)?a:0)+l-h}):e.setAttributes({x:l,textAlign:"right"}))}else{let t=c?d:u,e=c?u:d,s=t.AABBBounds.y2,n=e.AABBBounds.y1,a=i.y,h=r.y;n<a&&(e.attribute.angle?e.setAttributes({dy:(null!=(l=e.attribute.dy)?l:0)+a-n}):e.setAttributes({y:a,textBaseline:"top"})),s>h&&(t.attribute.angle?t.setAttributes({dy:(null!=(o=t.attribute.dy)?o:0)+h-s}):t.setAttributes({y:h,textBaseline:"bottom"}))}}}handleLabelsOverlap(t,e,i,r,n){if((0,s.Z)(t))return;let{verticalLimitSize:a,label:h,orient:d}=this.attribute,c=this._getAxisLabelLimitLength(a,n),{layoutFunc:p,autoRotate:g,autoRotateAngle:f,autoLimit:m,limitEllipsis:y,autoHide:_,autoHideMethod:v,autoHideSeparation:b,lastVisible:B,firstVisible:P,autoWrap:O,overflowLimitLength:I}=h;if((0,u.Z)(p))p(t,e,r,this);else{if(g)!function(t,e){if((0,s.Z)(t))return;let{orient:i,labelRotateAngle:r=[0,45,90]}=e;if(0===r.length||t.some(t=>!!t.attribute.angle))return;let n=0,a=0;for(r&&r.length>0&&(a=r.length);n<a;){var l,o;let e=r[n++];if(t.forEach(t=>{t.attribute.angle=(0,S.M4)(e)}),l=i,o=t,"bottom"!==l&&"top"!==l||function(t,e){e.forEach(e=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},M(t,e.attribute.angle)),{angle:A(e.attribute.angle)}))})}(l,o),"left"!==l&&"right"!==l||function(t,e){e.forEach((e,i)=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},w(t,e.attribute.angle)),{angle:A(e.attribute.angle)}))})}(l,o),(0,k.PY)(o),!function(t){for(let e=1;e<t.length;e++)if((0,k.Ph)(t[e-1],t[e]))return!0;return!1}(t))break}}(t,{labelRotateAngle:f,orient:d});else if(O){let e="left"===d||"right"===d?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x);!function(t,e){let{limitLength:i,axisLength:r,ellipsis:n="...",orient:a}=e;if((0,s.Z)(t)||!(0,o.Z)(i))return;let l=t[0].attribute.angle,h=(0,k.nw)(l),u=(0,k.GK)(l),d="top"===a||"bottom"===a,c=r/t.length;t.forEach((e,r)=>{var s,a,l,p,g;if(d){if(u&&Math.floor(e.AABBBounds.height())<=i)return;if(h){let i=E(e.attribute.x,null==(s=t[r+1])?void 0:s.attribute.x,null==(a=t[r-1])?void 0:a.attribute.x);(0,o.Z)(i)&&(c=(0,C.VV)(c,i))}}else{if(u){let i=E(e.attribute.y,null==(l=t[r+1])?void 0:l.attribute.y,null==(p=t[r-1])?void 0:p.attribute.y);(0,o.Z)(i)&&(c=(0,C.VV)(c,i))}if(h&&Math.floor(e.AABBBounds.width())<=i)return}let f=null,m=null;d?u?(f=i,m=c):(f=c,m=i):u?(f=c,m=i):(f=i,m=c),e.setAttributes({maxLineWidth:f,ellipsis:null!=(g=e.attribute.ellipsis)?g:n,whiteSpace:"normal",heightLimit:m})})}(t,{orient:d,limitLength:c,axisLength:e,ellipsis:y})}if(!O&&m&&(0,o.Z)(c)&&c>0){let e="left"===d||"right"===d,i=e?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x),r=e?i/t.length:_||g?1/0:i/t.length;!function(t,e){var i;let{limitLength:r,verticalLimitLength:n,ellipsis:a="...",orient:h,axisLength:u}=e;if((0,s.Z)(t)||!(0,o.Z)(r))return;let d=(i=e.overflowLimitLength,(0,o.Z)(i)?{left:i,right:i}:(0,T.Z)(i)?{left:i.left||0,right:i.right||0}:{left:0,right:0}),c=t[0],p=c.attribute.angle,g=!(0,l.Z)(p),f=g?Math.cos(p):1,m=g?Math.sin(p):0,y=(0,k.nw)(p),_=(0,k.GK)(p),v="top"===h||"bottom"===h,b=c.attribute.direction,x=!y&&!_&&v&&(t.length<2||t.some(t=>Math.abs(t.AABBBounds.width()-c.AABBBounds.width())>=2))&&c.AABBBounds.width()>Math.abs(r/m);t.forEach(t=>{var e;if(v&&(_&&Math.floor(t.AABBBounds.height())<=r||y&&Math.floor(t.AABBBounds.width())<=n))return;if(!v&&("vertical"===b&&Math.floor(t.AABBBounds.height())<=n||"vertical"!==b&&(y&&Math.floor(t.AABBBounds.width())<=r||_&&Math.floor(t.AABBBounds.height())<=n)))return;let i=null;if(y||_)i=v?y?n:r:"vertical"===b||_?n:r;else if(v){let{x1:e,x2:s}=t.AABBBounds,n=m/f,a=Math.abs(r/m);i=x&&n>0&&e<=u+d.right&&r/n+e>u+d.right?Math.min((u-e+d.right)/Math.abs(f),a):x&&n<0&&s>=-d.left&&r/n+s<-d.left?Math.min((s+d.left)/Math.abs(f),a):a}else i=Math.abs(r/f);(0,o.Z)(t.attribute.maxLineWidth)&&(i=(0,o.Z)(i)?Math.min(t.attribute.maxLineWidth,i):t.attribute.maxLineWidth),t.setAttributes({maxLineWidth:i,ellipsis:null!=(e=t.attribute.ellipsis)?e:a})})}(t,{limitLength:c,verticalLimitLength:r,ellipsis:y,orient:d,axisLength:i,overflowLimitLength:I})}_&&(0,x.t)(t,{orient:d,method:v,separation:b,lastVisible:B,firstVisible:P})}}afterLabelsOverlap(t,e,i,r,s){let{verticalLimitSize:n,orient:a}=this.attribute,l="bottom"===a||"top"===a,h=i.AABBBounds,u=l?h.height():h.width(),{verticalMinSize:c}=this.attribute;if((0,o.Z)(c)&&(!(0,o.Z)(n)||c<=n)){let t,e;u=Math.max(u,this._getAxisLabelLimitLength(c,s)),"left"===a?(t=h.x2-u,e=h.y1):"right"===a?(t=h.x1,e=h.y1):"top"===a?(t=h.x1,e=h.y2-u):"bottom"===a&&(t=h.x1,e=h.y1);let r=g.i.rect({x:t,y:e,width:l?h.width():u,height:l?u:h.height(),pickable:!1});r.name=v.X9.axisLabelBackground,r.id=this._getNodeId("axis-label-background"),i.insertBefore(r,i.firstChild)}if((0,d.Z)(this.attribute.label.containerAlign)){var p,f,m;let e;"left"===a?e=h.x2-u:"right"===a?e=h.x1:"top"===a?e=h.y2-u:"bottom"===a&&(e=h.y1),p=e,f=u,m=this.attribute.label.containerAlign,"left"===a||"right"===a?"left"===m?t.forEach(t=>{var e;t.setAttributes({dx:(null!=(e=t.attribute.dx)?e:0)+p-t.AABBBounds.x1})}):"right"===m?t.forEach(t=>{var e;t.setAttributes({dx:(null!=(e=t.attribute.dx)?e:0)+p+f-t.AABBBounds.x2})}):"center"===m&&t.forEach(t=>{var e;t.setAttributes({dx:(null!=(e=t.attribute.dx)?e:0)+p+f/2-(t.AABBBounds.x1+t.AABBBounds.x2)/2})}):"bottom"!==a&&"top"!==a||("top"===m?t.forEach(t=>{var e;t.setAttributes({dy:(null!=(e=t.attribute.dy)?e:0)+p-t.AABBBounds.y1})}):"bottom"===m?t.forEach(t=>{var e;t.setAttributes({dy:(null!=(e=t.attribute.dy)?e:0)+p+f-t.AABBBounds.y2})}):"middle"===m&&t.forEach(t=>{var e;t.setAttributes({dy:(null!=(e=t.attribute.dy)?e:0)+p+f/2-(t.AABBBounds.y1+t.AABBBounds.y2)/2})}))}}_getAxisLabelLimitLength(t,e){var i,r,s,n,a;let{label:l,title:o,line:h,tick:u}=this.attribute,d=null!=(i=l.space)?i:4,p=t,g=0,f=0,m=h&&h.visible?null!=(r=h.style.lineWidth)?r:1:0,y=u&&u.visible?null!=(s=u.length)?s:4:0;if(o&&o.visible&&"string"==typeof o.text){g=(0,b.fe)(o.text,o.textStyle,null==(a=null==(n=this.stage)?void 0:n.getTheme())?void 0:a.text).height;let t=(0,c.o)(o.padding);f=o.space+t[0]+t[2]}return p&&(p=(p-d-f-g-m-y)/e),p}release(){super.release(),this._breaks=null}}R.defaultAttributes=_.p,(0,p.jB)(R,B.b)},34687:function(t,e,i){"use strict";i.d(e,{b:()=>s});var r=i(8843);class s{isInValidValue(t){return t<0||t>1}getTickCoord(t){let{start:e}=this.attribute,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}getRelativeVector(t){let{start:e,end:i}=this.attribute;return[i.x-e.x,i.y-e.y]}getVerticalVector(t,e=!1,i){let{verticalFactor:s=1}=this.attribute,n=this.getRelativeVector(),a=(0,r.Fv)(n),l=[a[1],-1*a[0]];return(0,r.bA)(l,t*(e?1:-1)*s)}}},10308:function(t,e,i){"use strict";i.d(e,{t:()=>u});var r=i(47704),s=i(98116),n=i(88663),a=i(93227);let l={parity:function(t){return t.filter((t,e)=>e%2?t.setAttribute("opacity",0):1)},greedy:function(t,e){let i;return t.filter((t,r)=>r&&(0,a.qw)(i,t,e)?t.setAttribute("opacity",0):(i=t,1))}};function o(t){let e;return(e=t.OBBBounds.empty()?t.AABBBounds:t.OBBBounds).width()>1&&e.height()>1}function h(t,e,i,r,s=!1){if(i&&!t.attribute.opacity){let i=e.length;if(i>1){t.setAttribute("opacity",1);for(let t=0;t<i;t++){let n=s?e[i-1-t]:e[t];if(!r(n))break;n.setAttribute("opacity",0)}}}}function u(t,e){let i;if((0,r.Z)(t))return;let u=t.filter(o);if((0,r.Z)(u))return;u.forEach(t=>t.setAttribute("opacity",1)),i=u;let{method:d="parity",separation:c=0}=e,p=(0,s.Z)(d)?d:l[d]||l.parity;if(i.length>=3&&(0,a.A9)(i,c)){do i=p(i,c);while(i.length>=3&&(0,a.A9)(i,c));let t=(t,e,i=!0)=>i&&t<3||e,r=t(i.length,e.firstVisible,!1),s=t(i.length,e.lastVisible),l=u[0],o=(0,n.Z$)(u);(0,a.qw)(l,o,c)&&r&&s&&(o.setAttribute("opacity",0),s=!1),h(l,i,r,t=>(0,a.qw)(t,l,c)),h(o,i,s,t=>(0,a.qw)(t,o,c)||!(!r||t===l)&&(0,a.qw)(t,l,c),!0)}u.forEach(t=>{t.setAttribute("visible",!!t.attribute.opacity)})}},47187:function(t,e,i){"use strict";i.d(e,{GK:()=>o,PY:()=>n,Ph:()=>a,nw:()=>h});var r=i(33049),s=i(35652);function n(t){t.forEach(t=>{if(t.rotatedBounds||!t.attribute.angle)return;let e=function(t){let e=t.AABBBounds;return{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,centerX:t.attribute.x,centerY:t.attribute.y,angle:t.attribute.angle}}(t),i=(0,r.xj)({x:t.attribute.x,y:t.attribute.y},e.angle,{x:e.centerX,y:e.centerY}),s=i.x-e.centerX,n=i.y-e.centerY;e.x1+=s,e.x2+=s,e.y1+=n,e.y2+=n,e.centerX+=s,e.centerY+=n,t.rotatedBounds=e})}function a(t,e){var i,s;return(null==(i=t.OBBBounds)?void 0:i.empty())||(null==(s=e.OBBBounds)?void 0:s.empty())?(0,r.SX)(t.AABBBounds,e.AABBBounds,!1)&&(!t.rotatedBounds||!e.rotatedBounds||(0,r.nn)(t.rotatedBounds,e.rotatedBounds,!0)):t.OBBBounds.intersects(e.OBBBounds)}let l=Math.sin(Math.PI/10);function o(t,e=l){let i=!(0,s.Z)(t)&&0!==t,r=i?Math.cos(t):1;return i&&Math.abs(r)<=e}function h(t,e=l){let i=!(0,s.Z)(t)&&0!==t,r=i?Math.sin(t):0;return!i||Math.abs(r)<=e}},71060:function(t,e,i){"use strict";i.d(e,{WF:()=>y,sC:()=>v,Vu:()=>m,nZ:()=>_});var r=i(51129),s=i(89255),n=i(80523),a=i(23112),l=i(29624),o=i(2316),h=i(81428),u=i(84564),d=i(86389),c=i(16749);class p extends u.O{onBind(){var t;let e=(0,d.L)(this.target);this._animator=e;let i=this.duration,r=this.easing,{config:s,lastScale:n,getTickCoord:a}=this.params,l=1,o=this.target.data;if(n&&a&&o){l=.7;let t=a(n.scale(o.rawValue)),s=this.target.attribute.x,h=this.target.attribute.y;this.target.setAttributes({x:t.x,y:t.y}),e.animate(this.target,{type:"to",to:{x:s,y:h},duration:i,easing:r})}e.animate(this.target,{type:null!=(t=s.type)?t:"fadeIn",to:s.to,duration:i*l,easing:r}),this.completeBind(e)}}class g extends u.O{onBind(){let t=(0,d.L)(this.target);this._animator=t;let e=this.duration,i=this.easing,{config:r,diffAttrs:s}=this.params;t.animate(this.target,{type:"to",to:Object.assign({},s),duration:e,easing:i,customParameters:{diffAttrs:Object.assign({},s)}}),this.completeBind(t)}deleteSelfAttr(t){super.deleteSelfAttr(t),this._animator.deleteSelfAttr(t)}tryPreventConflict(){}}function f(){(0,r.M)(),(0,s.N)(),(0,n.v)(),(0,a.g)(),c.a.registerBuiltInAnimate("axisEnter",p),c.a.registerBuiltInAnimate("axisUpdate",g)}function m(){f(),(0,l.k)()}function y(){f(),(0,o.f)()}function _(){(0,r.M)(),(0,h.N)()}function v(){(0,r.M)(),(0,h.N)()}},29685:function(t,e,i){"use strict";i.d(e,{m:()=>d});var r=i(83143),s=i(21777),n=i(98116),a=i(88663),l=i(37922),o=i(93227);function h(t,e,i,r){let s,{breakData:n}=t;if(n&&n()){let{breakDomains:t}=n(),a=e.domain();s=[];for(let e=0;e<a.length-1;e++)r(i,[a[e],a[e+1]]).forEach(e=>{t.some(t=>e>=t[0]&&e<=t[1])||s.push(e)});e.domain(a)}else s=r(i);return s}function u(t,e,i,r,s=!1){if(i&&!e.includes(t)){let i=e.length;if(i>1){s?e.push(t):e.unshift(t);for(let t=0;t<i;t++){let n=s?i-1-t:t;if(!r(e[n]))break;e.splice(n,1),t--,i--}}}}let d=(t,e)=>{var i,d,p,g,f,m;let y;if(!(0,r.z2)(t.type))return(0,l.KV)(t.domain());let _=t.range(),v=Math.abs(_[_.length-1]-_[0]);if(v<2)return(0,l.KV)([t.domain()[0]]);let{tickCount:b,forceTickCount:x,tickStep:S,noDecimals:k=!1,labelStyle:A,breakData:M}=e;if((0,s.Z)(S))f=t.stepTicks(S),y=(m=M&&M()?M().breakDomains:null)&&m.length?f.filter(t=>m.every(e=>t<e[0]||t>e[1])):f;else if((0,s.Z)(x))y=h(e,t,x,(e,i)=>i&&i.length?t.domain(i,!0).forceTicks(e):t.forceTicks(e));else if("d3"===e.tickMode)y=h(e,t,null!=(i=(0,n.Z)(b)?b({axisLength:v,labelStyle:A}):b)?i:5,(e,i)=>i&&i.length?t.domain(i,!0).d3Ticks(e,{noDecimals:k}):t.d3Ticks(e,{noDecimals:k}));else{let i=null!=(d=(0,n.Z)(b)?b({axisLength:v,labelStyle:A}):b)?d:5,r=(0,n.Z)(e.tickMode)?e.tickMode:void 0;y=h(e,t,i,(e,i)=>i&&i.length?t.domain(i,!0).ticks(e,{noDecimals:k,customTicks:r}):t.ticks(e,{noDecimals:k,customTicks:r}))}let w=t.domain();if(e.labelFirstVisible&&w[0]!==y[0]&&!y.includes(w[0])&&y.unshift(w[0]),e.labelLastVisible&&w[w.length-1]!==y[y.length-1]&&!y.includes(w[w.length-1])&&y.push(w[w.length-1]),e.sampling&&y.length>1&&("cartesian"===e.coordinateType||"polar"===e.coordinateType&&"radius"===e.axisOrientType)){let i,{labelGap:r=4,labelFlush:s}=e;if(6*y.length>v){let r=[],s=Math.floor(6*y.length/v);y.forEach((t,e)=>{e%s!=0&&e!==y.length-1||r.push(t)}),i=null==(p=(0,l.SZ)(t,r,e))?void 0:p.map((t,e)=>({AABBBounds:t,value:r[e]}))}else i=null==(g=(0,l.SZ)(t,y,e))?void 0:g.map((t,e)=>({AABBBounds:t,value:y[e]}));if(i){let t=i[0],n=(0,a.Z$)(i),l=M&&M()?c.greedy:c.parity;for(;i.length>=3&&(0,o.A9)(i,r);)i=l(i,r);let h=e.labelFirstVisible,d=e.labelLastVisible;(0,o.qw)(t,n,r)&&i.includes(n)&&i.length>1&&h&&d&&(i.splice(i.indexOf(n),1),d=!1),u(t,i,h,e=>(0,o.qw)(e,t,r)),u(n,i,d,e=>(0,o.qw)(e,n,r)||!(!h||e===t)&&(0,o.qw)(e,t,r),!0);let p=i.map(t=>t.value);p.length<3&&s&&(p.length>1&&p.pop(),(0,a.Z$)(p)!==(0,a.Z$)(y)&&p.push((0,a.Z$)(y))),y=p}}return(0,l.KV)(y)},c={parity:function(t){return t.filter((t,e)=>e%2==0)},greedy:function(t,e){let i;return t.filter((t,r)=>(!r||!(0,o.qw)(i,t,e))&&(i=t,!0))}}},80133:function(t,e,i){"use strict";i.d(e,{U:()=>c});var r=i(21777),s=i(98116),n=i(88663),a=i(35652),l=i(45103),o=i(37922);let h=(t,e,i,r)=>{let s=(0,o.SZ)(t,e,i);return s&&s.map(t=>r?[t.x1,t.x2,t.width()]:[t.y1,t.y2,t.height()])},u=(t,e,i=0)=>Math.max(t[0],e[0])-i/2<=Math.min(t[1],e[1])+i/2,d=(t,e)=>t[1]<e[0]?e[0]-t[1]:e[1]<t[0]?t[0]-e[1]:0,c=(t,e)=>{var i;let l,u=t.domain();if(!u.length)return[];let{tickCount:d,forceTickCount:c,tickStep:g,labelGap:f=4,axisOrientType:m,labelStyle:y}=e,_=(0,o.tz)(m),v=t.range(),b=t.calculateWholeRangeSize();if(b<2)return e.labelLastVisible?(0,o.KV)([u[u.length-1]]):(0,o.KV)([u[0]]);if((0,r.Z)(g))l=t.stepTicks(g);else if((0,r.Z)(c))l=t.forceTicks(c);else if((0,r.Z)(d)){let e=(0,s.Z)(d)?d({axisLength:b,labelStyle:y}):d;l=t.ticks(e)}else if(e.sampling){let r=(null!=(i=e.labelStyle.fontSize)?i:12)+2,s=(0,n.iH)(v),a=(0,n.CE)(v);if(u.length<=b/r){let i=h(t,u,e,_);if(i){let r=Math.min(...i.map(t=>t[2])),n=(a-s)/u.length,o=p(u,i,f,e.labelLastVisible,Math.floor(r/n),!1);l=t.stepTicks(o.step),e.labelLastVisible&&(o.delCount&&(l=l.slice(0,l.length-o.delCount)),l.push(u[u.length-1]))}}else{let i=h(t,[u[0],u[Math.floor(u.length/2)],u[u.length-1]],e,_);if(i){let r=null;i.forEach(t=>{r?r[2]<t[2]&&(r=t):r=t});let n=a-s-f>0?Math.ceil(u.length*(f+r[2])/(a-s-f)):u.length-1;l=t.stepTicks(n),!e.labelLastVisible||l.length&&l[l.length-1]===u[u.length-1]||(l.length&&Math.abs(t.scale(l[l.length-1])-t.scale(u[u.length-1]))<r[2]&&(l=l.slice(0,-1)),l.push(u[u.length-1]))}}}return(0,a.Z)(l)&&(l=t.domain()),(0,o.KV)(l)},p=(t,e,i,r,s,n)=>{let a=0,o=0,h=-1,c=Number.MAX_VALUE,p=r=>{let s=!0,n=0;do n+r<t.length&&u(e[n],e[n+r],i)&&(s=!1),n+=r;while(s&&n<t.length);return s},g=(0,l.o0)(s,t.length,t=>p(t)?1:-1),f=g;do if(!(f>g)||n||p(f)){if(!r){o=f;break}{let r=t.length-1,s,n=0;s=t.length%f>0?t.length-t.length%f+f:t.length;do{if((s-=f)!==r&&!u(e[s],e[r],i))break;n++}while(s>0);if(s===r){o=f,a=n;break}{let i=Math.floor(t.length/f)-n+1;if(i<h)break;{h=i;let t=d(e[s],e[r]),l=s-f>=0?d(e[s-f],e[s]):t,u=Math.abs(t-l);if(u<c&&(c=u,o=f,a=n),t<=l)break}}}f++}else f++;while(f<=t.length);return{step:o,delCount:a}}},19288:function(t,e,i){"use strict";i.d(e,{t:()=>c});var r=i(25258),s=i(21777),n=i(98116),a=i(88663),l=i(37922),o=i(76620),h=i(47979),u=i(93227);let d=(t,e,i)=>{var s;let{labelStyle:n,getRadius:a,labelOffset:d,labelFormatter:c,inside:p}=i,g=null==a?void 0:a(),f=null!=(s=n.angle)?s:0,m=(0,h.gM)(n);return e.map(e=>{let i=c?c(e):`${e}`,{width:s,height:a}=m.quickMeasure(i),h=Math.max(s,l.rd),y=Math.max(a,l.rd),_=t.scale(e),v={x:0,y:0},b=0,x=0,S={align:n.textAlign,baseline:n.textBaseline},{x:k,y:A}=(0,u.DJ)(_,v,g,d,p);return S.align||((0,r.Yt)(k,v.x)?S.baseline||(S.baseline=A>v.y?"top":"bottom"):k>v.x?S.align="left":k<v.x&&(S.align="right")),b=k+("right"===S.align?-h:"left"===S.align?0:-h/2),x=A+("bottom"===S.baseline?-y:"top"===S.baseline?0:-y/2),(new o.FB).set(b,x,b+h,x+y).rotate(f,b+h/2,x+y/2)})},c=(t,e)=>{let i,{tickCount:r,forceTickCount:o,tickStep:h,getRadius:u,labelOffset:c,labelGap:g=0,labelStyle:f}=e,m=null==u?void 0:u();if(!m)return(0,l.KV)(t.domain());if((0,s.Z)(h))i=t.stepTicks(h);else if((0,s.Z)(o))i=t.forceTicks(o);else if((0,s.Z)(r)){let e=t.range(),s=Math.abs(e[e.length-1]-e[0]),a=(0,n.Z)(r)?r({axisLength:s,labelStyle:f}):r;i=t.ticks(a)}else if(e.sampling){let r=t.domain(),s=t.range(),n=d(t,r,e),l=(0,a.iH)(s),o=Math.abs((0,a.CE)(s)-l)*(m+c)/r.length,{step:h,delCount:u}=p(r,n,g,Math.floor(n.reduce((t,e)=>Math.min(t,e.width(),e.height()),Number.MAX_VALUE)/o));i=(i=t.stepTicks(h)).slice(0,i.length-u)}else i=t.domain();return(0,l.KV)(i)},p=(t,e,i,r)=>{let s=r;do{let r=!0;s++;let n=0;do n+s<t.length&&(0,l.jY)(e[n],e[n+s],i)&&(r=!1),n+=s;while(r&&n<t.length);if(r)break}while(s<=t.length);let n=0;if(t.length>2){let i=t.length-t.length%s;for(i>=t.length&&(i-=s);i>0&&(0,l.jY)(e[0],e[i]);)n++,i-=s}return{step:s,delCount:n}}},37922:function(t,e,i){"use strict";i.d(e,{KV:()=>l,SZ:()=>d,jY:()=>o,rd:()=>h,tz:()=>c});var r=i(76620),s=i(98706),n=i(80875),a=i(47979);let l=t=>t.map((t,e)=>({index:e,value:t})),o=(t,e,i=0)=>{let s=new r.FB(t).expand(i/2),n=new r.FB(e).expand(i/2);return s.intersects(n)},h=12,u=(t,e,i,r)=>i<t?Math.max(t-e/2,i):i>t?Math.min(t-e/2,i-e):i<r?i:i-e,d=(t,e,i)=>{var l,o,h;let{labelStyle:d,axisOrientType:c,labelFlush:p,labelFormatter:g,startAngle:f=0}=i,m=null!=(l=d.angle)?l:0;"vertical"===d.direction&&(m+=(0,s.M4)(90));let y=["bottom","top"].includes(c),_=["left","right"].includes(c),v=1,b=0;y||(_?(v=0,b=1):f&&(v=Math.cos(f),b=-Math.sin(f)));let x=(0,a.gM)(d),S=t.range(),k=[];for(let i=0;i<e.length;i++){let s=e[i],a=g?g(s):`${s}`;if((0,n.Z)(a)){k=void 0;break}let{width:l,height:c}=x.quickMeasure(a),f=Math.max(l,12),A=Math.max(c,12),M=t.scale(s),w=v*M,T=b*M,C,E,B=w,P=T;p&&y&&0===i?B=u(w,f,S[0],S[S.length-1]):p&&y&&i===e.length-1?B=u(w,f,S[S.length-1],S[0]):C=null!=(o=d.textAlign)?o:"center","right"===C?B-=f:"center"===C&&(B-=f/2),p&&_&&0===i?P=u(T,A,S[0],S[S.length-1]):p&&_&&i===e.length-1?P=u(T,A,S[S.length-1],S[0]):E=null!=(h=d.textBaseline)?h:"middle","bottom"===E?P-=A:"middle"===E&&(P-=A/2);let O=(new r.FB).set(B,P,B+f,P+A);m&&O.rotate(m,w,T),k.push(O)}return k},c=t=>["bottom","top","z"].includes(t)},93227:function(t,e,i){"use strict";i.d(e,{A9:()=>v,DJ:()=>f,cN:()=>c,jO:()=>p,mU:()=>g,qw:()=>_,st:()=>y,uX:()=>d,uf:()=>u,zl:()=>m});var r=i(95950),s=i(98706),n=i(70016),a=i(42465),l=i(8843),o=i(89542),h=i(47187);function u(t={}){var e,i;let{style:s={},angle:n=.5*Math.PI}=t,a=(0,r.Z)({},o.P,s),l=null!=(e=a.size)?e:o.P.size;return Object.assign(Object.assign({},a),{symbolType:null!=(i=a.symbolType)?i:`M ${-l/2} ${l*Math.sin(n)} L ${l/2} ${-l*Math.sin(n)}`,symbolSize:l})}function d(t){let e={};return(0,a.Ck)(t,t=>{"group"!==t.type&&t.id&&(e[t.id]=t)}),e}function c(t,e){return{x:t.x+e[0],y:t.y+e[1]}}function p(t,e,i,r=!1,s=!1){let n=[e.x-i.x,e.y-i.y];return(0,l.bA)(n,(r?-1:1)*(s?-1:1)*t/(0,l.kE)(n))}function g(t){let e="center",i="middle";return{align:e=(t=(0,s.LW)(t))>=5/3*Math.PI||t<=1/3*Math.PI?"left":t>=2/3*Math.PI&&t<=4/3*Math.PI?"right":"center",baseline:t>=7/6*Math.PI&&t<=11/6*Math.PI?"bottom":t>=1/6*Math.PI&&t<=5/6*Math.PI?"top":"middle"}}function f(t,e,i,r,n){var a;let l=(0,s.op)({x:0,y:0},i,t),o=c(l,p(r,l,e,n));return a=p(r||1,o,e,n),{x:o.x+a[0],y:o.y+a[1]}}function m(t,e,i,r,n){let a=[],l=n-r;for(let n=0;n<e;n++){let o=r+n*l/e;a.push((0,s.op)(t,i,o))}return a}function y(t,e){let i="";return 0===t.length||(t.forEach((t,e)=>{0===e?i=`M${t.x},${t.y}`:i+=`L${t.x},${t.y}`}),e&&(i+="Z")),i}function _(t,e,i){var r;let s=null==(r=t.attribute)?void 0:r.angle;if((0,h.nw)(s,Number.EPSILON))return i>(0,n.YB)(t.AABBBounds,e.AABBBounds);let a=t.OBBBounds,l=e.OBBBounds;return!a||!l||a.empty()||l.empty()?i>(0,n.YB)(t.AABBBounds,e.AABBBounds):a.intersects(l)||i>(0,n.up)(a,l)}function v(t,e){for(let i,r=1,s=t.length,n=t[0];r<s;n=i,++r)if(_(n,i=t[r],e))return!0;return!1}},11165:function(t,e,i){"use strict";var r,s;i.d(e,{$M:()=>o,Di:()=>a,HW:()=>r,Ze:()=>u,eV:()=>c,gB:()=>p,iR:()=>l,m3:()=>d,n0:()=>h,v2:()=>n});let n=-.5*Math.PI,a=1.5*Math.PI,l="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",o=14;(s=r||(r={})).selected="selected",s.selectedReverse="selected_reverse",s.hover="hover",s.hoverReverse="hover_reverse";let h={[r.selectedReverse]:{},[r.selected]:{},[r.hover]:{},[r.hoverReverse]:{}},u={container:"",width:30,height:30,style:{}},d="scrollDown",c="scrollDrag",p="scrollUp"},28076:function(t,e,i){"use strict";i.d(e,{k:()=>u});var r=i(53068),s=i(99014),n=i(80875),a=i(98116),l=i(95950),o=i(35652);let h=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"];class u extends r.ZA{constructor(t,e){super(t),this._skipRenderAttributes=h,(null==e?void 0:e.mode)&&(this.mode=e.mode,this.setMode(e.mode)),(null==e?void 0:e.skipDefault)&&(this.skipDefault=!0),this.setTheme({common:{strokeBoundsBuffer:0}}),this.attribute=t,this.onSetStage(()=>{this.render(),this.bindEvents()})}setAttribute(t,e,i,r){let s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);if(s)return this._setAttributes(s,i);(0,n.Z)(this.attribute[t])&&(0,n.Z)(e)&&!(0,a.Z)(this.attribute[t])&&!(0,a.Z)(e)?(0,l.Z)(this.attribute[t],e):this.attribute[t]=e,this._skipRenderAttributes.includes(t)||this.render(),this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(i||this.needUpdateTag(t))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}setAttributes(t,e,i){return t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t,this._setAttributes(t,e)}_setAttributes(t,e){let i=Object.keys(t);this._mergeAttributes(t,i),i.every(t=>this._skipRenderAttributes.includes(t))||this.render(),this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(e||this.needUpdateTags(i))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}_mergeAttributes(t,e){(0,o.Z)(e)&&(e=Object.keys(t));for(let i=0;i<e.length;i++){let r=e[i];!(0,n.Z)(this.attribute[r])||(0,a.Z)(this.attribute[r])||(0,a.Z)(t[r])?this.attribute[r]=t[r]:(0,l.Z)(this.attribute[r],t[r])}}bindEvents(){}_getNodeId(t){var e;return`${null!=(e=this.id)?e:this._uid}-${this.name}-${t}`}_dispatchEvent(t,e){var i;let r=new s.A(t,e);r.manager=null==(i=this.stage)?void 0:i.eventSystem.manager,this.dispatchEvent(r)}eventPosToStagePos(t){var e,i;let r={x:0,y:0},s=null!=(i=null==(e=this.stage)?void 0:e.eventPointTransform(t))?i:{x:0,y:0};return this.globalTransMatrix.transformPoint(s,r),r}}},78996:function(t,e,i){"use strict";i.d(e,{U:()=>h});var r=i(11681),s=i(21777),n=i(20672),a=i(28076),l=i(46293),o=i(43483);class h extends a.k{constructor(){super(...arguments),this.name="legend",this._title=null}render(){this.removeAllChild(!0);let{interactive:t=!0,title:e,padding:i=0}=this.attribute;this._parsedPadding=(0,r.o)(i);let s=n.i.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:t,childrenPickable:t});s.name=o.GN.innerView,this.add(s),this._innerView=s,(null==e?void 0:e.visible)&&this._renderTitle(e),this._renderContent(),this._adjustLayout(),t&&this._bindEvents();let a=this._innerView.AABBBounds;this.attribute.width=a.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=a.height()+this._parsedPadding[0]+this._parsedPadding[2]}_renderTitle(t){let{text:e="",textStyle:i,padding:n=0,background:a,minWidth:h,maxWidth:u,shape:d}=t,c={x:0,y:0,text:e,textStyle:i,padding:(0,r.o)(n),minWidth:h,maxWidth:u};d&&d.visible&&(c.shape=Object.assign({visible:!0},d.style),(0,s.Z)(d.space)&&(c.space=d.space)),a&&a.visible&&(c.panel=Object.assign({visible:!0},a.style));let p=new l.V(c);p.name=o.GN.title,this._title=p,this._innerView.add(p)}_adjustLayout(){var t;if(this._title){let e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),r=null==(t=this.attribute.title)?void 0:t.align;"center"===r?this._title.setAttribute("x",(e-i)/2):"end"===r&&this._title.setAttribute("x",e-i)}}}},38724:function(t,e,i){"use strict";i.d(e,{e:()=>Y});var r={};i.r(r),i.d(r,{LX:()=>D});var s=i(95950),n=i(35652),a=i(59225),l=i(47704),o=i(83143),h=i(21777);let u=t=>{let e=null,i=null;return(...r)=>(e&&r.every((t,i)=>t===e[i])||(e=r,i=t(...r)),i)};var d=i(45273),c=i(45103);function p(t){return t}function g(t,e){if(t=Number(t),e=Number(e)-t)return i=>(i-t)/e;let i=Number.isNaN(e)?NaN:.5;return()=>i}function f(t,e,i){let r,s,n=t[0],a=t[1],l=e[0],o=e[1];return a<n?(r=g(a,n),s=i(o,l)):(r=g(n,a),s=i(l,o)),t=>s(r(t))}function m(t,e,i){let r=Math.min(t.length,e.length)-1,s=Array(r),n=Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)s[a]=g(t[a],t[a+1]),n[a]=i(e[a],e[a+1]);return function(e){let i=(0,c.b4)(t,e,1,r)-1;return n[i](s[i](e))}}let y=(t,e=!1)=>{let i=Math.floor(Math.log10(t)),r=t/Math.pow(10,i);return(e?r<1.5?1:r<3?2:r<7?5:10:r<=1?1:r<=2?2:r<=5?5:10)*Math.pow(10,i)},_=(t,e)=>{let i,r;return e[0]<e[1]?(i=e[0],r=e[1]):(i=e[1],r=e[0]),Math.min(Math.max(t,i),r)},v=Math.sqrt(50),b=Math.sqrt(10),x=Math.sqrt(2),S=(t,e,i)=>{let r=1,s=t,n=Math.floor((e-1)/2),a=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?s=0:t<0&&t>=-Number.MIN_VALUE?s=-(e-1):!i&&a<1?r=T(a).step:(i||a>1)&&(s=Math.floor(t)-n*r),r>0?(t>0?s=Math.max(s,0):t<0&&(s=Math.min(s,-(e-1)*r)),(function(t,e,i){(0,h.Z)(e)||(e=t,t=0),(0,h.Z)(i)||(i=1);let r=-1,s=0|Math.max(0,Math.ceil((e-t)/i)),n=Array(s);for(;++r<s;)n[r]=t+r*i;return n})(0,e).map(t=>s+t*r)):t>0?A(0,-(e-1)/r,r):A((e-1)/r,0,r)},k=u((t,e,i,r)=>{let s,n,a,l,o=-1;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((s=e<t)&&(n=t,t=e,e=n),!isFinite(l=C(t,e,i).step))return[];if(l>0){let i=Math.round(t/l),r=Math.round(e/l);for(i*l<t&&++i,r*l>e&&--r,a=Array(n=r-i+1);++o<n;)a[o]=(i+o)*l}else if(l<0&&(null==r?void 0:r.noDecimals)){l=1;let i=Math.ceil(t),r=Math.floor(e);if(!(i<=r))return[];for(a=Array(n=r-i+1);++o<n;)a[o]=i+o}else{let i=Math.round(t*(l=-l)),r=Math.round(e*l);for(i/l<t&&++i,r/l>e&&--r,a=Array(n=r-i+1);++o<n;)a[o]=(i+o)/l}return s&&a.reverse(),a}),A=(t,e,i)=>{let r,s,n=-1;if(i>0){let a=Math.floor(t/i),l=Math.ceil(e/i);for((a+1)*i<t&&++a,(l-1)*i>e&&--l,s=Array(r=l-a+1);++n<r;)s[n]=(a+n)*i}else{let a=Math.floor(t*(i=-i)),l=Math.ceil(e*i);for((a+1)/i<t&&++a,(l-1)/i>e&&--l,s=Array(r=l-a+1);++n<r;)s[n]=(a+n)/i}return s},M=(t,e,i)=>{let r,s=t[0],n=t[t.length-1],a=e-t.length;if(n<=0){let e=[];for(r=a;r>=1;r--)e.push(s-r*i);return e.concat(t)}if(s>=0){for(r=1;r<=a;r++)t.push(n+r*i);return t}let l=[],o=[];for(r=1;r<=a;r++)r%2==0?l=[s-Math.floor(r/2)*i].concat(l):o.push(n+Math.ceil(r/2)*i);return l.concat(t).concat(o)},w=u((t,e,i,r)=>{let s,n,a;if(i*=1,(t*=1)==(e*=1)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return S(t,i,null==r?void 0:r.noDecimals);(s=e<t)&&(a=t,t=e,e=a);let l=C(t,e,i),o=l.step;if(!isFinite(o))return[];if(o>0){let r=1,{power:s,gap:a}=l,h=10===a?2*10**s:+(10**s);for(;r<=5&&(n=A(t,e,o)).length>i+1&&i>2;)o+=h,r+=1;i>2&&n.length<i-1&&(n=M(n,i,o))}else(null==r?void 0:r.noDecimals)&&o<0&&(o=1),n=A(t,e,o);return s&&n.reverse(),n}),T=t=>{let e=Math.floor(Math.log(t)/Math.LN10),i=t/10**e,r=1;return i>=v?r=10:i>=b?r=5:i>=x&&(r=2),e>=0?{step:r*10**e,gap:r,power:e}:{step:-(10**-e)/r,gap:r,power:e}};function C(t,e,i){return T((e-t)/Math.max(0,i))}function E(t,e,i){let r;if(i*=1,(t*=1)==(e*=1)&&i>0)return[t];if(i<=0||0==(r=(e-t)/Math.max(1,i-1))||!isFinite(r))return[];let s=Array(i);for(let e=0;e<i;e++)s[e]=t+e*r;return s}function B(t,e,i){let r,s,n=-1;if(i*=1,(s=(e*=1)<(t*=1))&&(r=t,t=e,e=r),!isFinite(i)||e-t<=i)return[t];let a=Math.floor((e-t)/i+1),l=Array(a);for(;++n<a;)l[n]=t+n*i;return s&&l.reverse(),l}function P(t,e=10){let i,r,s=0,n=t.length-1,a=t[s],l=t[n],o=10;for(l<a&&(r=a,a=l,l=r,r=s,s=n,n=r);o-- >0;){if((r=C(a,l,e).step)===i)return t[s]=a,t[n]=l,t;if(r>0)a=Math.floor(a/r)*r,l=Math.ceil(l/r)*r;else{if(!(r<0))break;a=Math.ceil(a*r)/r,l=Math.floor(l*r)/r}i=r}}let O=(t,e,i)=>1>Math.abs(e-t)?+i.toFixed(1):Math.round(+i);u((t,e,i,r,s,n,a)=>{let l=t,o=e,h=o<l;h&&([l,o]=[o,l]);let u,d,c=s(l),p=s(o),g=[];if(!(r%1)&&p-c<i){if(c=Math.floor(c),p=Math.ceil(p),l>0){for(;c<=p;++c)for(u=1;u<r;++u)if(!((d=c<0?u/n(-c):u*n(c))<l)){if(d>o)break;g.push(d)}}else for(;c<=p;++c)for(u=r-1;u>=1;--u)if(!((d=c>0?u/n(-c):u*n(c))<l)){if(d>o)break;g.push(d)}2*g.length<i&&(g=w(l,o,i))}else g=w(c,p,Math.min(p-c,i)).map(n);return g=g.filter(t=>0!==t),(null==a?void 0:a.noDecimals)&&(g=Array.from(new Set(g.map(t=>Math.floor(t))))),h?g.reverse():g}),u((t,e,i,r,s,n)=>{let a=[],l={},o=s(t),h=s(e),u=[];if(Number.isInteger(r))u=w(o,h,i);else{let t=(h-o)/(i-1);for(let e=0;e<i;e++)u.push(o+e*t)}return u.forEach(i=>{let s=n(i),o=Number.isInteger(r)?O(t,e,s):O(t,e,y(s)),h=O(t,e,_(o,[t,e]));l[h]||isNaN(h)||!(u.length>1)||(l[h]=1,a.push(h))}),a}),u((t,e,i,r,s)=>E(r(t),r(e),i).map(t=>y(s(t)))),u((t,e,i,r,s)=>B(r(t),r(e),i).map(t=>y(s(t))));var I=i(21648);class R{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:(0,h.Z)(this._rangeFactorStart)&&(0,h.Z)(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=function(t,e){let i=(t[1]-t[0])/(e[1]-e[0]),r=t[0]-i*e[0];return[r,i+r]}(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(2===t.length&&t.every(t=>t>=0&&t<=1)&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):(0,h.Z)(this._rangeFactorStart)&&(0,h.Z)(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return(0,n.Z)(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&((0,n.Z)(this._rangeFactorEnd)||1===this._rangeFactorEnd)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t,this._rangeFactorEnd=null!=(i=this._rangeFactorEnd)?i:1)),this)}rangeFactorEnd(t,e){var i;return(0,n.Z)(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&((0,n.Z)(this._rangeFactorStart)||0===this._rangeFactorStart)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorEnd=t,this._rangeFactorStart=null!=(i=this._rangeFactorStart)?i:0)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);let{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,s=this.range(),a=s[0],l=s[s.length-1],o=Math.min(a,l),h=Math.max(a,l),u=(0,I.Z)(null!=(t=this._fishEyeOptions.focus)?t:0,o,h),d=(0,n.Z)(r)?(h-o)*i:r,c=Math.exp(e);c=c/(c-1)*d;let p=e/d;this._fishEyeTransform=t=>{let e=Math.abs(t-u);return e>=d?t:e<=1e-6?u:u+(t-u)*(c*(1-Math.exp(-e*p))/e*.75+.25)}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var i;return null!=(i=null==this?void 0:this[t])?i:e}}var L=i(14925);function D(t,e){let i=t.r,r=e.r,s=t.g,n=e.g,a=t.b,l=e.b,o=t.opacity,h=e.opacity;return t=>{let e=Math.round(i*(1-t)+r*t),u=Math.round(s*(1-t)+n*t),d=Math.round(a*(1-t)+l*t);return new L.eX(e,u,d,o*(1-t)+h*t)}}function F(t,e){return i=>t*(1-i)+e*i}function z(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}RegExp(/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g.source,"g");let{LX:j}=r;function H(t,e){let i,r=typeof e;if((0,n.Z)(e)||"boolean"===r)return()=>e;if("number"===r)return F(t,e);if("string"===r){if(i=L.Il.parseColorString(e)){let e=j(L.Il.parseColorString(t),i);return t=>e(t).formatRgb()}return F(Number(t),Number(e))}return e instanceof L.eX?j(t,e):e instanceof L.Il?j(t.color,e.color):e instanceof Date?function(t,e){let i=t.valueOf(),r=e.valueOf(),s=new Date;return t=>(s.setTime(i*(1-t)+r*t),s)}(t,e):F(Number(t),Number(e))}function N(t){return Number(t)}class V extends R{constructor(t=p,e=p){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=p,this._piecewise=f,this._interpolate=H}calculateVisibleDomain(t){var e;return(0,h.Z)(this._rangeFactorStart)&&(0,h.Z)(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!=(e=this._niceDomain)?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!=(e=this._niceDomain)?e:this._domain).map(this.transformer),F)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return(null!=(i=this._niceDomain)?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;let r=Array.from(t,N);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();let i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){let i=Array.from(t);return this._range=i,this._interpolate=z,this.rescale(e)}rescale(t){var e,i,r;let s;if(t)return this;let n=null!=(e=this._niceDomain)?e:this._domain,a=n.length,l=this._range.length,o=Math.min(a,l);if(a&&a<l&&this._forceAlign){let t=l-a+1,e=n[a-1],i=a>=2?(e-n[a-2])/t:0;for(let r=1;r<=t;r++)n[a-2+r]=e-i*(t-r);o=l}return this._autoClamp&&(this._clamp=(i=n[0],r=n[o-1],i>r&&(s=i,i=r,r=s),t=>Math.max(i,Math.min(r,t)))),this._piecewise=o>2?m:f,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:p),this.rescale(i)):this._clamp!==p}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){let e=this.ticks(t);return(null!=e?e:[]).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return(0,n.Z)(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return(0,n.Z)(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}var W=i(98116);class U extends V{constructor(){super(...arguments),this.type=o._f.Linear}clone(){var t;let e=new U;return e.domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate),this._niceType&&(e._niceType=this._niceType,e._domainValidator=this._domainValidator,e._niceDomain=null==(t=this._niceDomain)?void 0:t.slice()),e}tickFormat(){return()=>{}}d3Ticks(t=10,e){let i=this.calculateVisibleDomain(this._range);return k(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if((0,W.Z)(null==e?void 0:e.customTicks))return e.customTicks(this,t);if((0,h.Z)(this._rangeFactorStart)&&(0,h.Z)(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(t,e);let r=null!=(i=this._niceDomain)?i:this._domain,s=this._domain,n=r[0],a=r[r.length-1],l=w(s[0],s[s.length-1],t,e);if(!l.length)return l;if(this._domainValidator)l=l.filter(this._domainValidator);else if((l[0]!==n||l[l.length-1]!==a)&&this._niceType){let t=r.slice();if("all"===this._niceType?(t[0]=l[0],t[t.length-1]=l[l.length-1],this._niceDomain=t,this.rescale()):"min"===this._niceType&&l[0]!==n?(t[0]=l[0],this._niceDomain=t,this.rescale()):"max"===this._niceType&&l[l.length-1]!==a&&(t[t.length-1]=l[l.length-1],this._niceDomain=t,this.rescale()),"all"!==this._niceType){let e=Math.min(t[0],t[t.length-1]),i=Math.max(t[0],t[t.length-1]);l=l.filter(t=>t>=e&&t<=i)}}return l}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return E(e[0],e[e.length-1],t)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return B(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;let s=this._domain,n=[];if(e){let t=function(t,e){let i=(0,d.Z)(e.forceMin),r=(0,d.Z)(e.forceMax),s=null,n=[],a=null,l=i&&r?t=>t>=e.forceMin&&t<=e.forceMax:i?t=>t>=e.forceMin:r?t=>t<=e.forceMax:null;return i?n[0]=e.forceMin:(0,d.Z)(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(n[0]=e.min),r?n[1]=e.forceMax:(0,d.Z)(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(n[1]=e.max),(0,d.Z)(n[0])&&(0,d.Z)(n[1])?((a=t.slice())[0]=n[0],a[a.length-1]=n[1]):s=(0,d.Z)(n[0])||(0,d.Z)(n[1])?(0,d.Z)(n[0])?"max":"min":"all",{niceType:s,niceDomain:a,niceMinMax:n,domainValidator:l}}(s,e);if(n=t.niceMinMax,this._domainValidator=t.domainValidator,this._niceType=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){let e=P(s.slice(),t);"min"===this._niceType?e[e.length-1]=null!=(i=n[1])?i:e[e.length-1]:"max"===this._niceType&&(e[0]=null!=(r=n[0])?r:e[0]),this._niceDomain=e,this.rescale()}return this}niceMin(t=10){this._niceType="min";let e=this._domain[this._domain.length-1],i=P(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";let e=this._domain[0],i=P(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}var G=i(78996),Z=i(60121),$=i(43483);(0,i(94765).Fw)();class Y extends G.U{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,s.Z)({},Y.defaultAttributes,t)),this.name="colorLegend",this._onSliderToolipChange=t=>{let e=this._slider.tooltipShape;if(e&&t.detail&&!(0,n.Z)(t.detail.value)){let i=this._colorScale.scale(t.detail.value);e.setAttribute("fill",i)}this.dispatchEvent(t)},this._onSliderChange=t=>{this._updateColor(),this.dispatchEvent(t)}}setSelected(t){this._slider&&(this._slider.setValue(t),this._updateColor())}_renderContent(){let{colors:t,slidable:e,layout:i,align:r,min:s,max:n,value:l,railWidth:o,railHeight:h,showHandler:u=!0,handlerSize:d,handlerStyle:c,railStyle:p,trackStyle:g,startText:f,endText:m,handlerText:y,showTooltip:_,tooltip:v,inverse:b,disableTriggerEvent:x}=this.attribute,S=[],k=(n-s)/(t.length-1);for(let e=0;e<t.length;e++)S.push(s+k*e);this._colorScale=(new U).domain(S,!0).range(t),this._color=this._getTrackColor();let A=new Z.i({x:0,y:0,range:{draggableTrack:!0},slidable:e,layout:i,align:r,min:s,max:n,value:l,railWidth:o,railHeight:h,showHandler:u,handlerSize:d,handlerStyle:c,railStyle:p,trackStyle:Object.assign({fill:this._color},g),startText:f,endText:m,handlerText:y,showTooltip:_,tooltip:v,disableTriggerEvent:x,inverse:b});this._innerView.add(A),this._slider=A,A.translateTo(0-A.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+(0,a.Z)(this.attribute,"title.space",$.$5):0)-A.AABBBounds.y1),this._updateColor()}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}_getTrackColor(){let{colors:t,layout:e,inverse:i}=this.attribute;if((0,l.Z)(t))return;let r=t.length;if(1===r)return t[0];let s=[];for(let e=0;e<r;e++){let i=e/(r-1);s.push({offset:i,color:t[e]})}let n="horizontal"===e,a={gradient:"linear",stops:s,x0:0,y0:0,x1:+!!n,y1:+!n};return i&&(n?(a.x0=1,a.x1=0):(a.y0=1,a.y1=0)),a}_updateColor(){var t;let{layout:e="horizontal",colors:i,railWidth:r,railHeight:s}=this.attribute,{startHandler:n,endHandler:a,track:l,attribute:o}=this._slider,{startValue:h,endValue:u,startPos:d,endPos:c}=this._slider.currentValue,p=null==(t=o.handlerStyle)?void 0:t.fill;if(n&&!p){let t=this._colorScale.scale(h);n.setAttribute("fill",t)}if(a&&!p){let t=this._colorScale.scale(u);a.setAttribute("fill",t)}let g="horizontal"===e?r:s;if(Math.abs(d-c)!==g&&i&&i.length>1){let t=this._color.stops,e=Math.min(d,c)/g,i=Math.max(d,c)/g,r=i-e,s=t.filter(t=>t.offset>e&&t.offset<i),n=Math.min(h,u),a=Math.max(h,u),o=this._colorScale.scale(n),p=this._colorScale.scale(a),f=[{offset:0,color:o}];s.forEach(t=>{f.push({offset:(t.offset-e)/r,color:t.color})}),f.push({offset:1,color:p}),l.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:f}))}}}Y.defaultAttributes={layout:"horizontal",title:{align:"start",space:$.$5,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}}},43483:function(t,e,i){"use strict";var r,s,n,a,l,o;i.d(e,{$5:()=>f,DN:()=>d,GN:()=>n,Nu:()=>p,SX:()=>h,Th:()=>m,dk:()=>s,g:()=>u,qL:()=>c,so:()=>g,uu:()=>r});let h=10,u=8,d=8,c=8,p=16,g=8,f=12,m=12;(a=r||(r={})).selected="selected",a.unSelected="unSelected",a.selectedHover="selectedHover",a.unSelectedHover="unSelectedHover",a.focus="focus",(l=s||(s={})).legendItemHover="legendItemHover",l.legendItemUnHover="legendItemUnHover",l.legendItemClick="legendItemClick",l.legendItemAttributeUpdate="legendItemAttributeUpdate",(o=n||(n={})).innerView="innerView",o.title="legendTitle",o.item="legendItem",o.itemShape="legendItemShape",o.itemLabel="legendItemLabel",o.itemValue="legendItemValue",o.focus="legendItemFocus"},88666:function(t,e,i){"use strict";i.d(e,{W:()=>E});var r=i(95950),s=i(31535),n=i(21777),a=i(47704),l=i(88663),o=i(59225),h=i(43562),u=i(11681),d=i(35652),c=i(70527),p=i(25258),g=i(21648),f=i(98116),m=i(20672),y=i(78996),_=i(45273),v=i(28076),b=i(47979),x=i(14481);let S={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};(0,x.s)();class k extends v.k{getCurrent(){return this._current}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},k.defaultAttributes,t)),this.name="pager",this._current=1,this._onHover=t=>{let e=t.target;e.hasState("disable")||e.addState("hover")},this._onUnHover=t=>{t.target.removeState("hover")},this._onClick=t=>{let e=t.target;if("preHandler"===e.name){if(1===this._current)return;this._current-=1,1===this._current?e.addState("disable"):e.removeState("disable"),this._dispatchEvent("toPrev",{current:this._current,total:this._total,direction:"pre",event:t})}if("nextHandler"===e.name){if(this._current===this._total)return;this._current+=1,this._current===this._total?e.addState("disable"):e.removeState("disable"),this._dispatchEvent("toNext",{current:this._current,total:this._total,direction:"next",event:t})}this._current>1&&this.preHandler.removeState("disable"),this._current<this._total&&this.nextHandler.removeState("disable"),this.text.setAttribute("text",this._getPageText(this._current))}}render(){var t,e,i;this._reset();let{layout:r="horizontal",handler:s=S,total:n,defaultCurrent:a=1,textStyle:l,padding:o=0}=this.attribute;this._current=a;let h=(0,u.o)(o),d="horizontal"===r,c=m.i.group({x:0,y:0}),p=s.style||{},g=p.size||15,f=null!=(t=s.space)?t:8,y=s.state||{},{preShape:v,nextShape:x}=s;v||(v=d?"triangleLeft":"triangleUp"),x||(x=d?"triangleRight":"triangleDown");let k=m.i.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},p),{x:0,y:0,symbolType:v,size:g}));k.states=y,k.name="preHandler",this.preHandler=k,c.add(k);let{width:A,height:M}=(0,b.fe)(this._getPageText(n),Object.assign({textAlign:"center",textBaseline:"middle"},l),null==(i=null==(e=this.stage)?void 0:e.getTheme())?void 0:i.text),w=(0,_.Z)(g)?g:g[0],T=(0,_.Z)(g)?g:g[1],C=m.i.text(Object.assign({x:d?w/2+f+A/2:0,y:d?0:T/2+f+M/2,text:this._getPageText(a),textAlign:"center",textBaseline:"middle",lineHeight:null==l?void 0:l.fontSize},l));this.text=C,c.add(C);let E=m.i.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},p),{x:d?w+2*f+A:0,y:d?0:T+2*f+M,symbolType:x,size:g}));E.name="nextHandler",E.states=y,this.nextHandler=E,c.add(E),1===this._total?(k.addState("disable"),E.addState("disable")):1===this._current?k.addState("disable"):this._current===n&&E.addState("disable");let B=c.AABBBounds,P=B.width(),O=B.height();c.translateTo(0-B.x1+h[3],0-B.y1+h[0]),this.add(c),this.attribute.width=P+h[1]+h[3],this.attribute.height=O+h[0]+h[2],this._bindEvents()}_bindEvents(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}_reset(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}_getPageText(t){let{pageFormatter:e}=this.attribute;return e?(0,f.Z)(e)?e(t,this._total):`${e}`.replace("{current}",`${t}`).replace("{total}",`${this._total}`):`${t}/${this._total}`}setTotal(t){t!==this.attribute.total&&(this._total=t,1!==this._current&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}k.defaultAttributes={handler:S,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};var A=i(43483),M=i(94765),w=i(29609),T=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};let C={[A.uu.focus]:{},[A.uu.selected]:{},[A.uu.selectedHover]:{},[A.uu.unSelected]:{},[A.uu.unSelectedHover]:{}};(0,M.cV)();class E extends y.U{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},E.defaultAttributes,t)),this.name="discreteLegend",this._itemsContainer=null,this._itemHeightByUser=void 0,this._itemHeight=0,this._itemMaxWidth=0,this._contentMaxHeight=0,this._onHover=t=>{let e=t.target;if(e&&e.name&&e.name.startsWith(A.GN.item)){let i=e.delegate;if(this._lastActiveItem){if(this._lastActiveItem.id===i.id)return;this._unHover(this._lastActiveItem,t)}this._hover(i,t)}else this._lastActiveItem&&(this._unHover(this._lastActiveItem,t),this._lastActiveItem=null)},this._onUnHover=t=>{this._lastActiveItem&&(this._unHover(this._lastActiveItem,t),this._lastActiveItem=null)},this._onClick=t=>{var e,i,r,s;let n=t.target;if(n&&n.name&&n.name.startsWith(A.GN.item)){let a=n.delegate,{selectMode:l="multiple"}=this.attribute;if(n.name===A.GN.focus||"focus"===l){let r=a.hasState(A.uu.focus);a.toggleState(A.uu.focus),r?null==(e=this._itemsContainer)||e.getChildren().forEach(e=>{this._removeLegendItemState(e,[A.uu.unSelected,A.uu.unSelectedHover,A.uu.focus],t),this._setLegendItemState(e,A.uu.selected,t)}):(this._setLegendItemState(a,A.uu.selected,t),this._removeLegendItemState(a,[A.uu.unSelected,A.uu.unSelectedHover],t),null==(i=this._itemsContainer)||i.getChildren().forEach(e=>{a!==e&&(this._removeLegendItemState(e,[A.uu.selected,A.uu.selectedHover,A.uu.focus],t),this._setLegendItemState(e,A.uu.unSelected,t))}))}else{null==(r=this._itemsContainer)||r.getChildren().forEach(t=>{t.removeState(A.uu.focus)});let{allowAllCanceled:e=!0}=this.attribute,i=a.hasState(A.uu.selected),n=this._getSelectedLegends();if("multiple"===l){if(!1===e&&i&&1===n.length)return void this._dispatchLegendEvent(A.dk.legendItemClick,a,t);i?(this._removeLegendItemState(a,[A.uu.selected,A.uu.selectedHover],t),this._setLegendItemState(a,A.uu.unSelected,t)):(this._setLegendItemState(a,A.uu.selected,t),this._removeLegendItemState(a,[A.uu.unSelected,A.uu.unSelectedHover],t))}else this._setLegendItemState(a,A.uu.selected,t),this._removeLegendItemState(a,[A.uu.unSelected,A.uu.unSelectedHover],t),null==(s=this._itemsContainer)||s.getChildren().forEach(e=>{a!==e&&(this._removeLegendItemState(e,[A.uu.selected,A.uu.selectedHover],t),this._setLegendItemState(e,A.uu.unSelected,t))})}this._dispatchLegendEvent(A.dk.legendItemClick,a,t)}}}render(){super.render(),this._lastActiveItem=null}setSelected(t){var e;(null==(e=this._itemsContainer)?void 0:e.getChildren()).forEach(e=>{let i=e.data;t.includes(i.label)?(this._setLegendItemState(e,A.uu.selected),this._removeLegendItemState(e,[A.uu.unSelected,A.uu.unSelectedHover])):(this._removeLegendItemState(e,[A.uu.selected,A.uu.selectedHover]),this._setLegendItemState(e,A.uu.unSelected))})}_renderItems(){let{item:t={},maxCol:e=1,maxRow:i=2,maxWidth:r,defaultSelected:a,lazyload:l,autoPage:o}=this.attribute,{spaceCol:h=A.Nu,spaceRow:u=A.so,verticalAlign:d="middle"}=t,c=this._itemsContainer,{items:p,isHorizontal:g,startIndex:f,isScrollbar:m}=this._itemContext,y=m?1:g?i:e,_=this._contentMaxHeight,v,{doWrap:b,maxWidthInCol:x,startX:S,startY:k,pages:M}=this._itemContext,w=0,T=0,C=[];for(let t=f,e=p.length;t<e&&!(l&&M>this._itemContext.currentPage*y);t++){l&&(this._itemContext.startIndex=t+1),(v=p[t]).id||(v.id=v.label),v.index=t;let e=!0;(0,s.Z)(a)&&(e=a.includes(v.label));let i=this._renderEachItem(v,e,t,p),f=i.attribute.width,y=i.attribute.height;this._itemHeight=Math.max(this._itemHeight,y),x=Math.max(f,x),this._itemMaxWidth=Math.max(f,this._itemMaxWidth),g?((0,n.Z)(r)&&(m&&o?b=(M=Math.ceil((S+f)/r))>1:S+f>r&&(b=!0,S>0&&("middle"!==d&&"bottom"!==d||C.forEach(t=>{t.setAttributes({y:t.attribute.y+(T-t.attribute.height)/("middle"===d?2:1)})}),M+=1,S=0,k+=T+u,T=0,C.length=0))),0===S&&0===k||i.setAttributes({x:S,y:k}),S+=h+f,T=Math.max(T,y),C.push(i)):((0,n.Z)(_)&&(m&&o?b=(M=Math.ceil((k+y)/_))>1:_<=y?(M+=1,b=!0,k=0,t>0&&(S+=w+h)):_<k+y&&(M+=1,b=!0,k=0,S+=x+h,x=0)),0===S&&0===k||i.setAttributes({x:S,y:k}),k+=u+y),c.add(i),w=f}return g&&("middle"===d||"bottom"===d)&&C.forEach(t=>{t.setAttributes({y:t.attribute.y+(T-t.attribute.height)/("middle"===d?2:1)})}),this._itemContext.doWrap=b,this._itemContext.startX=S,this._itemContext.startY=k,this._itemContext.maxWidthInCol=x,this._itemContext.pages=M,this._itemContext.maxPages=y,m&&(this._itemContext.totalPage=M),l||(this._itemContext.startIndex=p.length),this._itemContext}_renderContent(){let{item:t={},items:e,reversed:i,maxWidth:r,maxHeight:s}=this.attribute;if(!1===t.visible||(0,a.Z)(e))return;let h=e;i&&(h=null==e?void 0:e.reverse()),this._contentMaxHeight=Math.max(0,s-this._parsedPadding[0]-this._parsedPadding[2]);let u=m.i.group({x:0,y:0});this._itemsContainer=u;let{layout:d,autoPage:c}=this.attribute,{maxWidth:p,width:g,height:f}=t,y=[];(0,n.Z)(p)&&y.push(p),(0,n.Z)(g)&&y.push(g),y.length&&((0,n.Z)(r)&&y.push(r),this._itemWidthByUser=(0,l.iH)(y)),(0,n.Z)(f)&&(this._itemHeightByUser=f);let _=this.attribute.pager;this._itemContext={currentPage:_&&_.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:h,isHorizontal:"horizontal"===d,totalPage:1/0,isScrollbar:_&&"scrollbar"===_.type,clipContainer:void 0},this._itemContext=this._renderItems();let v=!1;this._itemContext.doWrap&&c&&this._itemContext.pages>this._itemContext.maxPages&&(v=this._renderPagerComponent()),v||(u.setAttribute("y",this._title?this._title.AABBBounds.height()+(0,o.Z)(this.attribute,"title.space",8):0),this._innerView.add(u))}_bindEvents(){if(this.attribute.disableTriggerEvent||!this._itemsContainer)return;let{hover:t=!0,select:e=!0}=this.attribute;if(t){let e="pointermove",i="pointerleave";(0,h.Z)(t)&&(t.trigger&&(e=t.trigger),t.triggerOff&&(i=t.triggerOff)),this._itemsContainer.addEventListener(e,this._onHover),this._itemsContainer.addEventListener(i,this._onUnHover)}if(e){let t="pointerdown";(0,h.Z)(e)&&e.trigger&&(t=e.trigger),this._itemsContainer.addEventListener(t,this._onClick)}}_autoEllipsis(t,e,i,r){var s,n;let{label:a,value:l}=this.attribute.item,o=r.AABBBounds,h=i.AABBBounds,u=o.width(),d=h.width(),c=!1;"labelFirst"===t?d>e?c=!0:r.setAttribute("maxLineWidth",e-d):"valueFirst"===t?u>e?c=!0:i.setAttribute("maxLineWidth",e-u):u+d>e&&(c=!0),c&&(r.setAttribute("maxLineWidth",Math.max(e*(null!=(s=a.widthRatio)?s:.5),e-d)),i.setAttribute("maxLineWidth",Math.max(e*(null!=(n=l.widthRatio)?n:.5),e-u)))}_renderEachItem(t,e,i,r){var a,l;let h,{id:c,label:p,value:g,shape:f}=t,{padding:y=0,focus:_,focusIconStyle:v,align:x,autoEllipsisStrategy:S}=this.attribute.item,{shape:k,label:M,value:w,background:T}=this.attribute.item,C=this._handleStyle(k,t,e,i,r),E=this._handleStyle(M,t,e,i,r),B=this._handleStyle(w,t,e,i,r),P=this._handleStyle(T,t,e,i,r),O=(0,u.o)(y);!1===T.visible?(h=m.i.group({x:0,y:0,cursor:null==(a=P.style)?void 0:a.cursor}),this._appendDataToShape(h,A.GN.item,t,h)):(h=m.i.group(Object.assign({x:0,y:0},P.style)),this._appendDataToShape(h,A.GN.item,t,h,P.state)),h.id=`${null!=c?c:p}-${i}`,h.addState(e?A.uu.selected:A.uu.unSelected);let I=m.i.group({x:0,y:0,pickable:!1});h.add(I);let R,L=0,D=0,F=0;if(k&&!1!==k.visible){let i=(0,o.Z)(C,"style.size",A.SX);D=(0,s.Z)(i)?i[0]||0:i,F=(0,o.Z)(k,"space",A.g);let r=m.i.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},f),C.style));Object.keys(C.state||{}).forEach(t=>{let e=C.state[t].fill||C.state[t].stroke;f.fill&&(0,d.Z)(C.state[t].fill)&&e&&(C.state[t].fill=e),f.stroke&&(0,d.Z)(C.state[t].stroke)&&e&&(C.state[t].stroke=e)}),this._appendDataToShape(r,A.GN.itemShape,t,h,C.state),r.addState(e?A.uu.selected:A.uu.unSelected),I.add(r)}let z=0;if(_){let e=(0,o.Z)(v,"size",A.SX);R=m.i.symbol(Object.assign(Object.assign({x:0,y:-e/2-1,strokeBoundsBuffer:0,boundsPadding:O},v),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(R,A.GN.focus,t,h),z=e}let j=M.formatMethod?M.formatMethod(p,t,i):p,H=Object.assign(Object.assign({x:D/2+F,y:0,textAlign:"start",textBaseline:"middle",lineHeight:null==(l=E.style)?void 0:l.fontSize},E.style),{text:j,_originText:M.formatMethod?p:void 0}),N=(0,b.vS)(H);this._appendDataToShape(N,A.GN.itemLabel,t,h,E.state),N.addState(e?A.uu.selected:A.uu.unSelected),I.add(N);let V=(0,o.Z)(M,"space",A.DN);if((0,n.Z)(g)){let r=(0,o.Z)(w,"space",_?A.qL:0),s=w.formatMethod?w.formatMethod(g,t,i):g,n=Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:B.style.fontSize},B.style),{text:s,_originText:w.formatMethod?g:void 0}),a=(0,b.vS)(n);if(this._appendDataToShape(a,A.GN.itemValue,t,h,B.state),a.addState(e?A.uu.selected:A.uu.unSelected),this._itemWidthByUser){let t=this._itemWidthByUser-O[1]-O[3]-D-F-V-z-r;this._autoEllipsis(S,t,N,a),w.alignRight?a.setAttributes({textAlign:"right",x:this._itemWidthByUser-D/2-O[1]-O[3]-z-r}):a.setAttribute("x",V+(N.AABBBounds.empty()?0:N.AABBBounds.x2))}else a.setAttribute("x",V+(N.AABBBounds.empty()?0:N.AABBBounds.x2));L=r+(a.AABBBounds.empty()?0:a.AABBBounds.x2),I.add(a)}else this._itemWidthByUser&&N.setAttribute("maxLineWidth",this._itemWidthByUser-O[1]-O[3]-D-F-z),L=V+(N.AABBBounds.empty()?0:N.AABBBounds.x2);R&&(R.setAttribute("x",L),I.add(R));let W=I.AABBBounds,U=W.width();if("right"===x){let t=W.x2,e=W.x1;I.forEachChildren((i,r)=>{"symbol"!==i.type&&"right"!==i.attribute.textAlign||i===R?i.setAttribute("x",e+t-i.attribute.x-i.AABBBounds.width()):"symbol"!==i.type?i.setAttributes({x:e+t-i.attribute.x,textAlign:"left"}):i.setAttribute("x",e+t-i.attribute.x)})}let G=W.height(),Z=(0,n.Z)(this.attribute.item.width)?this.attribute.item.width:U+O[1]+O[3],$=this._itemHeightByUser||G+O[0]+O[2];return h.attribute.width=Z,h.attribute.height=$,R&&R.setAttribute("visible",!1),I.translateTo(-W.x1+O[3],-W.y1+O[0]),h}_createPager(t){var e,i;let{disableTriggerEvent:s,maxRow:n}=this.attribute,a=t=>t<=99?99:t<=999?999:9999;return new k(this._itemContext.isHorizontal?Object.assign(Object.assign({layout:1===n?"horizontal":"vertical",total:a(this._itemContext.pages)},(0,r.Z)({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:null==(e=this.attribute.pager)?void 0:e.defaultCurrent,disableTriggerEvent:s}):Object.assign({layout:"horizontal",total:a(this._itemContext.pages),disableTriggerEvent:s,defaultCurrent:null==(i=this.attribute.pager)?void 0:i.defaultCurrent},t))}_createScrollbar(t,e){let{disableTriggerEvent:i}=this.attribute;return new w.B(this._itemContext.isHorizontal?Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:i,range:[0,.5],height:12*(!1!==t.visible)},t),{width:e}):Object.assign(Object.assign({direction:"vertical",width:12*(!1!==t.visible),range:[0,.5]},t),{height:e,disableTriggerEvent:i}))}_updatePositionOfPager(t,e,i){let{pager:r}=this.attribute,{totalPage:s,isHorizontal:n}=this._itemContext,a=r&&r.position||"middle";if(this._pagerComponent.setTotal(s),n){let r;r="start"===a?t:"end"===a?t+i-this._pagerComponent.AABBBounds.height()/2:t+i/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:e-this._pagerComponent.AABBBounds.width(),y:r})}else{let t;t="start"===a?0:"end"===a?e-this._pagerComponent.AABBBounds.width():(e-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:t,y:i-this._pagerComponent.AABBBounds.height()})}}_computeScrollbarDelta(){let t,{isHorizontal:e,clipContainer:i}=this._itemContext,r=this._itemsContainer.AABBBounds,s=i.AABBBounds;return e?s.width()/r.width():s.height()/r.height()}_updatePositionOfScrollbar(t,e,i){let{isHorizontal:r,currentPage:s,totalPage:n}=this._itemContext,a=(s-1)/n;this._pagerComponent.setScrollRange([a,a+this._computeScrollbarDelta()]),r?this._pagerComponent.setAttributes({x:0,y:i+e}):this._pagerComponent.setAttributes({x:t,y:i})}_bindEventsOfPager(t,e){let{animation:i=!0,animationDuration:r=450,animationEasing:s="quadIn"}=this.attribute.pager||{},n=this._itemContext.isScrollbar?t=>{let{value:e}=t.detail;return 0===e[0]?1:1===e[1]?this._itemContext.totalPage:e[0]*this._itemContext.totalPage+1}:t=>t.detail.current,a=a=>{let l=n(a);if(l!==this._itemContext.currentPage){if(this._itemContext.currentPage=l,this._itemContext&&this._itemContext.startIndex<this._itemContext.items.length){this._renderItems();let t=Math.ceil(this._itemContext.pages/this._itemContext.maxPages);if(this._itemContext.totalPage=t,this._itemContext.isScrollbar&&this._pagerComponent){let t=this._computeScrollbarDelta(),[e]=this._pagerComponent.getScrollRange();this._pagerComponent.setScrollRange([e,e+t])}}if(this._itemContext.isScrollbar){let[t]=this._pagerComponent.getScrollRange(),n=(this._itemContext.isHorizontal?this._itemsContainer.AABBBounds.width():this._itemsContainer.AABBBounds.height())*t;this.updateScrollMask(),i?this._itemsContainer.animate().to({[e]:-n},r,s):this._itemsContainer.setAttribute(e,-n)}else i?this._itemsContainer.animate().to({[e]:-(l-1)*t},r,s):this._itemsContainer.setAttribute(e,-(l-1)*t)}};this._itemContext.isScrollbar?(this._pagerComponent.addEventListener("scrollDrag",a),this._pagerComponent.addEventListener("scrollUp",a),this.attribute.pager.roamScroll&&(this.addEventListener("wheel",t=>t.nativeEvent.preventDefault()),this.addEventListener("wheel",(0,c.Z)(t=>{let e=this._pagerComponent,i=e.getScrollRange(),{direction:r}=e.attribute,{width:s,height:n}=e.getSliderRenderBounds(),a="vertical"===r?t.deltaY/n:t.deltaX/s;e.setScrollRange([i[0]+a,i[1]+a],!0),this.updateScrollMask()},50)))):(this._pagerComponent.addEventListener("toPrev",a),this._pagerComponent.addEventListener("toNext",a))}_renderPager(){let t=this._title?this._title.AABBBounds.height()+(0,o.Z)(this.attribute,"title.space",8):0,{maxWidth:e,maxCol:i=1,maxRow:r=2,item:s={},pager:n={}}=this.attribute,{spaceCol:a=A.Nu,spaceRow:l=A.so}=s,h=this._itemsContainer,{space:u=A.Th,defaultCurrent:d=1}=n,c=T(n,["space","defaultCurrent"]),{isHorizontal:p}=this._itemContext,g=this._contentMaxHeight,f,y=0,_=0,v=0,b=0,x=0,S=0,k=1;if(p){if(_=(r-1)*l+this._itemHeight*r,y=e,f=this._createPager(c),this._pagerComponent=f,this._innerView.add(f),(v=e-f.AABBBounds.width()-u)<=0)return this._innerView.removeChild(f),!1;h.getChildren().forEach((t,e)=>{let{width:i,height:r}=t.attribute;v<x+i&&(x=0,S+=r+l,k+=1),e>0&&t.setAttributes({x:x,y:S}),x+=a+i}),this._itemContext.startX=x,this._itemContext.startY=S,this._itemContext.pages=k;let i=Math.ceil(k/r);this._itemContext.totalPage=i,this._updatePositionOfPager(t,y,_)}else{if(y=this._itemMaxWidth*i+(i-1)*a,_=g,v=y,f=this._createPager(c),this._pagerComponent=f,this._innerView.add(f),(b=g-f.AABBBounds.height()-u-t)<=0)return this._innerView.removeChild(f),!1;h.getChildren().forEach((t,e)=>{let{height:i}=t.attribute;b<S+i&&(S=0,x+=this._itemMaxWidth+a,k+=1),e>0&&t.setAttributes({x:x,y:S}),S+=l+i});let e=Math.ceil(k/i);this._itemContext.totalPage=e,this._updatePositionOfPager(t,y,_)}d>1&&(p?h.setAttribute("y",-(d-1)*(_+l)):h.setAttribute("x",-(d-1)*(y+a)));let M=m.i.group({x:0,y:t,width:p?v:y,height:p?_:b,clip:!0,pickable:!1});return M.add(h),this._innerView.add(M),this._itemContext.clipContainer=M,this._bindEventsOfPager(p?_+l:y+a,p?"y":"x"),!0}_renderScrollbar(){var t;let e=this._title?this._title.AABBBounds.height()+(0,o.Z)(this.attribute,"title.space",8):0,{maxWidth:i,item:r={},pager:s={}}=this.attribute,{spaceCol:n=A.Nu,spaceRow:a=A.so}=r,l=this._itemsContainer,{space:h=A.Th,defaultCurrent:u=1}=s,d=T(s,["space","defaultCurrent"]),{isHorizontal:c}=this._itemContext,p=this._contentMaxHeight,g,f=0,y=0,_=0,v=1;if(c)f=i,y=this._itemHeight,g=this._createScrollbar(d,f),this._pagerComponent=g,this._innerView.add(g);else{if(y=p-e,f=this._itemMaxWidth,g=this._createScrollbar(d,y),this._pagerComponent=g,this._innerView.add(g),y<=0)return this._innerView.removeChild(g),!1;let t=l.getChildren(),i=t.map(t=>t.attribute.height);if(1===i.length||i.every(t=>t===i[0])){let e=i[0],r=Math.floor(y/(a+e));y=r*(a+e),v=Math.ceil(t.length/r)}else t.forEach((t,e)=>{let{height:i}=t.attribute,r=v,s=_;v=Math.floor((_+i)/y)+1,_+=a+i,r!==v&&e===l.getChildren().length-1&&_-y>=1/3*i&&(y=s+i,v-=1)});this._itemContext.totalPage=v,this._itemContext.pages=v}if(u>1)if(c){let t=this._itemsContainer.AABBBounds.width()-f;l.setAttribute("x",-Math.min((u-1)*(f+n),t))}else{let t=this._itemsContainer.AABBBounds.height()-y;l.setAttribute("y",-Math.min((u-1)*(y+a),t))}let b=m.i.group({x:0,y:e,width:f,height:y,clip:!0,pickable:!1});return b.add(l),this._innerView.add(b),this._itemContext.clipContainer=b,this._updatePositionOfScrollbar(f,y,e),(null==(t=s.scrollMask)?void 0:t.visible)&&this.renderScrollMask(b),this._bindEventsOfPager(c?f:y,c?"x":"y"),!0}renderScrollMask(t){let{scrollMask:e={}}=this.attribute.pager,{visible:i=!0,gradientLength:r=16,gradientStops:s}=e;if(!i||!s)return;let n=t.AABBBounds.width(),a=t.AABBBounds.height(),l=this._itemContext.isHorizontal?n:a,o=s.map(t=>({offset:r*t.offset/l,color:t.color})),h=s.map(t=>({offset:(l-r*t.offset)/l,color:t.color})),u=m.i.rect({x:0,y:0,width:n,height:a});this._scrollMask=u,this._scrollMaskContext={startStops:o,endStops:h},this.updateScrollMask(),t.add(u)}updateScrollMask(){if(!this._scrollMask||!this._pagerComponent||!this._itemContext.isScrollbar)return;let[t,e]=this._pagerComponent.getScrollRange(),i=[];(0,p.Yt)((0,g.Z)(e,0,1),1)||i.push(...this._scrollMaskContext.endStops),(0,p.Yt)((0,g.Z)(t,0,1),0)||i.push(...this._scrollMaskContext.startStops),i.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:i}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:i}}))}_renderPagerComponent(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}_hover(t,e){this._lastActiveItem=t,t.hasState(A.uu.selected)?this._setLegendItemState(t,A.uu.selectedHover,e):this._setLegendItemState(t,A.uu.unSelectedHover,e);let i=t.getChildren()[0].find(t=>t.name===A.GN.focus,!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(A.dk.legendItemHover,t,e)}_unHover(t,e){let i=!1;(t.hasState(A.uu.unSelectedHover)||t.hasState(A.uu.selectedHover))&&(i=!0),t.removeState(A.uu.unSelectedHover),t.removeState(A.uu.selectedHover),t.getChildren()[0].getChildren().forEach(t=>{!i&&(t.hasState(A.uu.unSelectedHover)||t.hasState(A.uu.selectedHover))&&(i=!0),t.removeState(A.uu.unSelectedHover),t.removeState(A.uu.selectedHover)});let r=t.getChildren()[0].find(t=>t.name===A.GN.focus,!1);r&&r.setAttribute("visible",!1),i&&this._dispatchLegendEvent(A.dk.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(A.dk.legendItemUnHover,t,e)}_setLegendItemState(t,e,i){let r=!1;t.hasState(e)||(r=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach(t=>{t.name!==A.GN.focus&&(r||t.hasState(e)||(r=!0),t.addState(e,!0))}),r&&this._dispatchLegendEvent(A.dk.legendItemAttributeUpdate,t,i)}_removeLegendItemState(t,e,i){let r=!1;e.forEach(e=>{!r&&t.hasState(e)&&(r=!0),t.removeState(e)}),t.getChildren()[0].getChildren().forEach(t=>{t.name!==A.GN.focus&&e.forEach(e=>{!r&&t.hasState(e)&&(r=!0),t.removeState(e)})}),r&&this._dispatchLegendEvent(A.dk.legendItemAttributeUpdate,t,i)}_getSelectedLegends(){var t;let e=[];return null==(t=this._itemsContainer)||t.getChildren().forEach(t=>{t.hasState(A.uu.selected)&&e.push(t.data)}),e}_appendDataToShape(t,e,i,s,n={}){t.name=e,t.data=i,t.delegate=s,t.states=(0,r.Z)({},C,n)}_dispatchLegendEvent(t,e,i){let r=this._getSelectedLegends();r.sort((t,e)=>t.index-e.index);let s=r.map(t=>t.label);this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(A.uu.selected),currentSelectedItems:r,currentSelected:s,event:i})}_handleStyle(t,e,i,r,s){let n={};return t.style&&((0,f.Z)(t.style)?n.style=t.style(e,i,r,s):n.style=t.style),t.state&&(n.state={},Object.keys(t.state).forEach(a=>{t.state[a]&&((0,f.Z)(t.state[a])?n.state[a]=t.state[a](e,i,r,s):n.state[a]=t.state[a])})),n}release(){super.release(),this.removeAllEventListeners()}}E.defaultAttributes={layout:"horizontal",title:{align:"start",space:A.$5,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:A.Nu,spaceRow:A.so,shape:{space:A.g,style:{size:A.SX,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:A.DN,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:A.SX,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:A.Th,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0}},94765:function(t,e,i){"use strict";i.d(e,{Fw:()=>d,Vo:()=>c,cV:()=>u});var r=i(51129),s=i(81428),n=i(48683),a=i(14481),l=i(6004),o=i(26544);function h(){(0,r.M)(),(0,n.b)()}function u(){h(),(0,a.s)(),(0,o.M)()}function d(){h(),(0,l.d)()}function c(){h(),(0,l.d)(),(0,s.N)()}},95548:function(t,e,i){"use strict";i.d(e,{D:()=>h});var r=i(20672),s=i(95950),n=i(59225),a=i(78996),l=i(60121),o=i(43483);(0,i(94765).Vo)();class h extends a.U{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,s.Z)({},h.defaultAttributes,t)),this.name="sizeLegend",this._onSliderChange=t=>{this.dispatchEvent(t)},this._onSliderToolipChange=t=>{this.dispatchEvent(t)}}setSelected(t){this._slider&&this._slider.setValue(t)}_renderContent(){let{slidable:t,layout:e,align:i,min:s,max:a,value:h,railWidth:u,railHeight:d,showHandler:c=!0,handlerSize:p,handlerStyle:g,railStyle:f,trackStyle:m,startText:y,endText:_,handlerText:v,showTooltip:b,tooltip:x,sizeBackground:S,disableTriggerEvent:k,inverse:A}=this.attribute,M=r.i.group({x:0,y:0});this._innerView.add(M);let w=new l.i({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:t,layout:e,align:i,min:s,max:a,value:h,railWidth:u,railHeight:d,showHandler:c,handlerSize:p,handlerStyle:Object.assign({symbolType:function(t="bottom"){let e=0;return"top"===t?`
    M${e},-6L${e-3.5},-2.5
    v5
    h7
    v-5
    Z
`:"left"===t?(e=1,`
    M${e-6},0L${e-6+2.5},-3.5
    h5
    v7
    h-5
    Z
`):"right"===t?(e=-1,`
    M${e+6},0L${e+6-2.5},-3.5
    h-5
    v7
    h5
    Z
  `):`
    M${e},6L${e-3.5},2.5
    v-5
    h7
    v5
    Z
`}(i)},g),railStyle:f,trackStyle:m,startText:y,endText:_,handlerText:v,showTooltip:b,tooltip:x,disableTriggerEvent:k,inverse:A});M.add(w);let T,C=0;"horizontal"===e?"top"===i?(T=`M0,0L${u},0L${A?0:u},12Z`,C=d):(T=`M0,12L${u},12L${A?0:u},0Z`,w.setAttribute("y",12)):"left"===i?T=`M${u},0L${u+12},${A?0:d}L${u},${d}Z`:(T=`M0,${A?0:d}L12,${d}L12,0Z`,w.setAttribute("x",12));let E=r.i.path(Object.assign(Object.assign({x:0,y:C,path:T},S),{zIndex:0}));M.add(E);let B=this._title?this._title.AABBBounds.height()+(0,n.Z)(this.attribute,"title.space",o.$5):0;M.translate(0-M.AABBBounds.x1,B-M.AABBBounds.y1),this._slider=w}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}h.defaultAttributes={layout:"horizontal",title:{align:"start",space:o.$5,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}}},14481:function(t,e,i){"use strict";i.d(e,{s:()=>a});var r=i(51129),s=i(91015),n=i(23112);function a(){(0,r.M)(),(0,s.k)(),(0,n.g)()}},89959:function(t,e,i){"use strict";i.d(e,{C:()=>L});var r=i(14364),s=i(90552),n=i(66838),a=i(93279),l=i(17783),o=i(76620),h=i(95950),u=i(11681),d=i(21777),c=i(31535),p=i(47704),g=i(88504),f=i(61868),m=i(33049),y=i(28076),_=i(45257),v=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};let b=new o.FB;(0,_.q)();let x="M -0.5 -0.5, L -0.5 0.5, L 0.5 -0.5, Z",S="M -0.5 -0.5, L -0.5 0.5, L 0.5 0.5, Z",k="M -0.5 -0.5, L 0.5 -0.5, L 0.5 0.5, Z",A="M 0.5 -0.5, L 0.5 0.5, L -0.5 0.5, Z",M={tl:x,tr:k,bl:S,br:A,lt:x,lb:S,rt:k,rb:A};class w extends y.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,h.Z)({},w.defaultAttributes,t)),this.name="poptip",this.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"]}render(){var t,e,i,r,s,n,a,l,h;let{titleStyle:y={},position:_,contentStyle:x={},panel:S,logoSymbol:k,poptipAnchor:A="position",logoText:w,logoTextStyle:T={},triangleMode:C="default",space:E=4,minWidth:B=0,maxWidth:P=1/0,padding:O=4,maxWidthPercent:I,visible:R,state:L,dx:D=0,dy:F=0,positionBounds:z}=this.attribute,{title:j="",content:H=""}=this.attribute;j=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(j):j,H=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(H):H;let N=(0,u.o)(O),V=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group");this.group=V;let W=P-N[1]-N[3],U=(0,d.Z)(j)&&!1!==R,G=Object.assign(Object.assign({text:(0,c.Z)(j)?j:[j],visible:U,wrap:!0},y),{x:N[3],y:N[0],maxLineWidth:W,textAlign:"left",textBaseline:"top"}),Z=V.createOrUpdateChild("poptip-title",G,"text");(0,p.Z)(null==L?void 0:L.title)||(Z.states=L.title);let $=Z.AABBBounds,Y=$.height(),X=$.width(),K=Y+E;U||(K=0);let q=(0,d.Z)(H)&&!1!==R,Q=Object.assign(Object.assign({text:(0,c.Z)(H)?H:[H],visible:q,wrap:!0},x),{x:N[3],y:N[0]+K,maxLineWidth:W,textAlign:"left",textBaseline:"top"}),J=V.createOrUpdateChild("poptip-content",Q,"text");(0,p.Z)(null==L?void 0:L.content)||(J.states=L.content);let te=J.AABBBounds,ti=te.height(),tr=te.width();q&&(K+=ti),this.titleShape=Z,this.contentShape=J;let ts=(0,g.Fp)(X+N[1]+N[3],tr+N[1]+N[3]);ts>P?ts=P:ts<B&&(ts=B);let tn=N[0]+N[2]+K,{visible:ta,square:tl}=S,to=v(S,["visible","square"]);if(tl){let t=(0,g.Fp)(ts,tn);ts=t;let e=t-tn;tn=t,Z.setAttributes({dy:e/2}),J.setAttributes({dy:e/2})}let th=null!=(t=to.size)?t:12,tu=(0,c.Z)(th)?[th[0]+(null!=(e=to.space)?e:0),th[1]+(null!=(i=to.space)?i:0)]:th+(null!=(r=to.space)?r:0),td=null!=(s=to.lineWidth)?s:1,tc=this.stage?[null!=(n=this.stage.viewWidth)?n:this.stage.width,null!=(a=this.stage.viewHeight)?a:this.stage.height]:void 0;if(tc){let t=this.AABBBounds,e=Math.max(null!=(l=this.attribute.x)?l:t.x1,tc[0]-t.x1);if((e=Math.min(e-(((0,c.Z)(th)?th[0]:12)+3),e*I))<ts){ts=e;let t=N[1]+N[3];Z.setAttribute("maxLineWidth",e-t),J.setAttribute("maxLineWidth",e-t),tn=N[0]+N[2],U&&(tn+=Z.AABBBounds.height()+E),tn+=J.AABBBounds.height()}}let tp="auto"===_||(0,c.Z)(_),tg=(0,c.Z)(_)?_:this.positionList,tf,tm=-1/0;for(let t=0;t<tg.length+1;t++){let e=tp?tg[t===tg.length?tf:t]:_,i="arrow2Left",r=((0,c.Z)(th)?th[0]:th)/4,s=0;"top"===e||"bottom"===e||"left"===e||"right"===e?i="arrow2Left":"concise"===C&&(i=M[e],r=["tl","bl","rt","rb"].includes(e)?((0,c.Z)(th)?th[0]:th)/2:-((0,c.Z)(th)?th[0]:th)/2,s=["tl","tr","lb","rb"].includes(e)?-((0,c.Z)(th)?th[1]:th)/2:((0,c.Z)(th)?th[1]:th)/2);let{angle:n,offset:a}=this.getAngleAndOffset(e,ts,tn,(0,c.Z)(tu)?tu:[tu,tu-td],i),l,u={x:0,y:0};if("bounds"===A&&z&&(u=this.calculateAnchorPoint(e,z)),(0,f.Z)(ta)){let t;l=V.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},to),{visible:ta&&(q||U),x:r,y:s,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:i,angle:n,dx:a[0],dy:a[1]-(null!=(h=to.space)?h:0),size:th,zIndex:9}),"symbol"),(0,p.Z)(null==L?void 0:L.panel)||(l.states=L.panel),t=S.panelSymbolType?V.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},to),{visible:ta&&(q||U),x:0,y:0,symbolType:"rect",size:[ts,tn],zIndex:-8}),"symbol"):V.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},to),{visible:ta&&(q||U),x:0,y:0,width:ts,height:tn,zIndex:-8}),"rect"),(0,p.Z)(null==L?void 0:L.panel)||(t.states=L.panel)}if(V.setAttributes({x:-a[0]+D+u.x,y:-a[1]+F+u.y,anchor:[r,s]}),k){let{size:t=12}=k,e=(0,c.Z)(t)?t:[t,t];"auto"===e[1]&&(e[1]=tn),"auto"===e[0]&&(e[0]=tn);let i=e[0];V.createOrUpdateChild("poptip-logo",Object.assign(Object.assign({},k),{x:0,y:tn/2,visible:ta&&(q||U),zIndex:10,size:e}),"symbol"),V.setAttributes({x:-a[0]+D+i/2,y:-a[1]+F}),w&&V.createOrUpdateChild("poptip-logo-text",Object.assign(Object.assign({},T),{x:0,y:tn/2,visible:ta&&(q||U),text:w,textAlign:"center",textBaseline:"middle",zIndex:10}),"text")}if(!tc)break;{b.setValue(0,0,ts,tn).transformWithMatrix(V.globalTransMatrix);let i=(new o.YZ).setValue(0,0,tc[0],tc[1]);if(tp){if((0,m.RA)(b,i,!1))break;{let e=(0,m.di)(b,i,!1),r=(e.x2-e.x1)*(e.y2-e.y1);r>tm&&(tm=r,tf=t)}}if(["top","bottom","left","right"].includes(e)){let t="top"===e||"bottom"===e,r="left"===e||"right"===e,s=!1;if(t?s="top"===e&&b.y1<0||"bottom"===e&&b.y2>i.y2:r&&(s="left"===e&&b.x1<0||"right"===e&&b.x2>i.x2),!s){let e=0,s=((0,c.Z)(th)?th[1]:th)/2;t?(b.x1<0?e=-b.x1:b.x2>i.x2&&(e=i.x2-b.x2),V.setAttribute("x",V.attribute.x+e),l.setAttribute("dx",(0,g.VV)((0,g.Fp)(l.attribute.dx-e,s),b.width()-s))):r&&(b.y1<0?e=-b.y1:b.y2>i.y2&&(e=i.y2-b.y2),V.setAttribute("y",V.attribute.y+e),l.setAttribute("dy",(0,g.VV)((0,g.Fp)(l.attribute.dy-e,s),b.height()-s)));break}}if(!tp)break}}}calculateAnchorPoint(t,e){if(!e)return{x:0,y:0};let{x:i,y:r}=this.attribute,{x1:s,y1:n,x2:a,y2:l}=e,o=a-s,h=l-n;switch(t){case"top":case"tl":case"tr":return{x:s+o/2-i,y:n-r};case"bottom":case"bl":case"br":return{x:s+o/2-i,y:l-r};case"left":case"lt":case"lb":return{x:s-i,y:n+h/2-r};case"right":case"rt":case"rb":return{x:a-i,y:n+h/2-r};default:return{x:0,y:0}}}getAngleAndOffset(t,e,i,r,s){let n="arrow2Left"===s?r[1]/2:r[1];switch(t){case"tl":return{angle:"arrow2Left"===s?g.pi/2*3:0,offset:"arrow2Left"===s?[e/4,i+n]:[0,i+n]};case"top":return{angle:g.pi/2*3,offset:[e/2,i+n]};case"tr":return{angle:"arrow2Left"===s?g.pi/2*3:0,offset:"arrow2Left"===s?[e/4*3,i+n]:[e,i+n]};case"rt":return{angle:0,offset:"arrow2Left"===s?[-n,i/5]:[-n,0]};case"right":return{angle:0,offset:[-n,i/2]};case"rb":return{angle:0,offset:"arrow2Left"===s?[-n,i/5*4]:[-n,i]};case"bl":return{angle:"arrow2Left"===s?g.pi/2:0,offset:"arrow2Left"===s?[e/4,-n]:[0,-n]};case"bottom":return{angle:g.pi/2,offset:[e/2,-n]};case"br":return{angle:"arrow2Left"===s?g.pi/2:0,offset:"arrow2Left"===s?[e/4*3,-n]:[e,-n]};case"lt":return{angle:"arrow2Left"===s?g.pi:0,offset:"arrow2Left"===s?[e+n,i/5]:[e+n,0]};case"left":return{angle:g.pi,offset:[e+n,i/2]};case"lb":return{angle:"arrow2Left"===s?g.pi:0,offset:"arrow2Left"===s?[e+n,i/5*4]:[e+n,i]}}}}w.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},panel:{},maxWidthPercent:.8,space:8,padding:10};var T=i(80131);let C=class{render(t,e,i,r,s,n,a,l,o,u,d,c,p){var g,f,m;if(1===t._showPoptip){let{visible:e,visibleCb:i}=t.attribute.poptip||{};if(!1===e||i&&!1===i(t))return;let r={};(0,h.Z)(r,w.defaultAttributes,t.attribute.poptip?t.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(r):this.poptipComponent=new w(r);let s=t.attribute.poptip||{};if("text"===t.type&&null==s.title&&null==s.content){let e={};m=s,(0,h.Z)(e,T.r.poptip,m),(s=e).content=null!=(g=s.content)?g:t.attribute.text}let n=t.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1,poptipAnchor:"bounds"},s),{x:n.e,y:n.f,positionBounds:t.globalAABBBounds})),u.stage.tryInitInteractiveLayer();let a=u.stage.getLayer("_builtin_interactive");a&&a.add(this.poptipComponent)}else 2===t._showPoptip&&(t._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),null==(f=this.poptipComponent.parent)||f.removeChild(this.poptipComponent),this.poptipComponent=null))}};C=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)()],C);var E=i(35437),B=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};class P{constructor(){this.activeEvent="onRegister",this._uid=E.R.GenAutoIncrementId(),this.poptip=t=>{let e=t.target;this.needHide(e)?this.unpoptip(t):e!==this.activeGraphic&&(this.needShow(e)&&(e.setAttributes({}),e._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(e,!0))},this.unpoptip=t=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(t){this.pluginService=t;let{stage:e}=this.pluginService;e.addEventListener("pointerover",this.poptip)}needHide(t){return t.isContainer||!t.attribute}needShow(t){return!!t.attribute.poptip}setActiveGraphic(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}deactivate(t){let{stage:e}=this.pluginService;e.removeEventListener("pointerover",this.poptip)}}let O=class extends P{constructor(){super(...arguments),this.name="poptip",this.key=this.name+this._uid}};O=B([(0,l.b)()],O);let I=class extends P{constructor(){super(...arguments),this.name="poptipForText",this.key=this.name+this._uid,this.pointerlave=t=>{let{stage:e}=this.pluginService;t.target===e&&this.unpoptip(t)}}activate(t){super.activate(t);let{stage:e}=this.pluginService;e.addEventListener("pointerleave",this.pointerlave)}needHide(t){return"text"!==t.type||!t.cliped||t.isContainer||!t.attribute||t.attribute.disableAutoClipedPoptip}needShow(t){return!0}deactivate(t){let{stage:e}=this.pluginService;super.deactivate(t),e.removeEventListener("pointerleave",this.pointerlave)}};I=B([(0,l.b)()],I);let R=new r.n((t,e,i,r)=>{i(C)||(t(C).toSelf().inSingletonScope(),t(s.tg).toService(C)),i(O)||(t(O).toSelf(),t(n.X).toService(O)),i(I)||(t(I).toSelf(),t(n.X).toService(I))});function L(){a.n.load(R)}},45257:function(t,e,i){"use strict";i.d(e,{C:()=>u,q:()=>h});var r=i(95950),s=i(80131),n=i(51129),a=i(23112),l=i(91015),o=i(29624);function h(){(0,n.M)(),(0,a.g)(),(0,l.k)(),(0,o.k)()}function u(t){(0,r.Z)(s.r.poptip,s.t,t)}},80131:function(t,e,i){"use strict";i.d(e,{r:()=>n,t:()=>s});var r=i(95950);let s={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},n={poptip:(0,r.Z)({},s)}},26544:function(t,e,i){"use strict";i.d(e,{M:()=>n});var r=i(51129),s=i(29624);function n(){(0,r.M)(),(0,s.k)()}},29609:function(t,e,i){"use strict";i.d(e,{B:()=>m});var r=i(91925),s=i(10391),n=i(70527),a=i(95950),l=i(21777),o=i(21648),h=i(12319),u=i(11681),d=i(28076),c=i(26544),p=i(11165),g=i(39144);let f={debounce:s.Z,throttle:n.Z};(0,c.M)();class m extends d.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,a.Z)({},m.defaultAttributes,t)),this.name="scrollbar",this._handleTouchMove=t=>{(0,l.Z)(this._prePos)&&t.preventDefault()},this._onRailPointerDown=t=>{let e,{viewX:i,viewY:r}=t,{direction:s,width:n,height:a,range:l}=this.attribute,h=this._sliderSize,[u,d]=this._getScrollRange();if("vertical"===s){let t=r-this._viewPosition.y,i=(0,o.Z)(t-h/2,u,d);e=t/a,this._slider.setAttribute("y",i,!0)}else{let t=i-this._viewPosition.x,r=(0,o.Z)(t-h/2,u,d);e=t/n,this._slider.setAttribute("x",r,!0)}this.setScrollRange([e-(l[1]-l[0])/2,e+(l[1]-l[0])/2],!1),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()},this._onSliderPointerDown=t=>{this._clearDragEvents();let{stopSliderDownPropagation:e=!0}=this.attribute;e&&t.stopPropagation();let{direction:i}=this.attribute,{x:s,y:n}=this.stage.eventPointTransform(t);this._prePos="horizontal"===i?s:n,this._dispatchEvent(p.m3,{pos:this._prePos,event:t});let a=(0,g.G)(),l="browser"===r.rF.env?r.rF:this.stage;l.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),a.forEach(t=>{l.addEventListener(t,this._onSliderPointerUp)})},this._computeScrollValue=t=>{let{direction:e}=this.attribute,{x:i,y:r}=this.stage.eventPointTransform(t),s,n,a=0,{width:l,height:o}=this.getSliderRenderBounds();return s="vertical"===e?((n=r)-this._prePos)/o:((n=i)-this._prePos)/l,[n,s]},this._onSliderPointerMove=t=>{let{stopSliderMovePropagation:e=!0}=this.attribute;e&&t.stopPropagation();let i=this.getScrollRange(),[r,s]=this._computeScrollValue(t);this.setScrollRange([i[0]+s,i[1]+s],!0),this._prePos=r},this._onSliderPointerMoveWithDelay=0===this.attribute.delayTime?this._onSliderPointerMove:f[this.attribute.delayType](this._onSliderPointerMove,this.attribute.delayTime),this._onSliderPointerUp=t=>{let{range:e,limitRange:i=[0,1]}=this.attribute,r=this.getScrollRange(),[s,n]=this._computeScrollValue(t),a=[r[0]+n,r[1]+n];this._prePos=null,this._dispatchEvent(p.gB,{pre:e,value:(0,h.Z)(a,i[0],i[1])}),this._clearDragEvents()}}setScrollRange(t,e=!0){let{direction:i="horizontal",limitRange:r=[0,1],range:s,realTime:n=!0}=this.attribute,a=(0,h.Z)(t,r[0],r[1]);if(e){let t=this._getSliderPos(a);if(this._slider){let e=t[1]-t[0];this._sliderSize=e,"horizontal"===i?this._slider.setAttributes({x:t[0],width:e},!0):this._slider.setAttributes({y:t[0],height:e},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=a,n&&this._dispatchEvent(p.eV,{pre:s,value:a})}getScrollRange(){return this.attribute.range}bindEvents(){if(this.attribute.disableTriggerEvent)return;let{delayType:t="throttle",delayTime:e=0}=this.attribute;this._rail&&this._rail.addEventListener("pointerdown",f[t](this._onRailPointerDown,e)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown),("browser"===r.rF.env?r.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}render(){let t;this._reset();let{direction:e="horizontal",width:i,height:r,range:s,limitRange:n=[0,1],railStyle:a,sliderStyle:l,padding:o=2}=this.attribute,d=this.createOrUpdateChild("scrollbar-container",{},"group"),c=d.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:i,height:r},a),"rect");this._rail=c;let p=this.getSliderRenderBounds(),g=this._getSliderPos((0,h.Z)(s,n[0],n[1])),f=g[1]-g[0];this._sliderSize=f,t="horizontal"===e?{x:g[0],y:p.y1,width:f,height:p.height}:{x:p.x1,y:g[0],width:p.width,height:f};let m=d.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},t),{cornerRadius:this._getDefaultSliderCornerRadius()}),l),{boundsPadding:(0,u.o)(o),pickMode:"imprecise"}),"rect");this._slider=m,this._container=d;let y=this._container.AABBBounds;this._viewPosition={x:y.x1,y:y.y1}}getSliderRenderBounds(){if(this._sliderRenderBounds)return this._sliderRenderBounds;let{width:t,height:e,padding:i=2}=this.attribute,[r,s,n,a]=(0,u.o)(i),l={x1:a,y1:r,x2:t-s,y2:e-n,width:Math.max(0,t-(a+s)),height:Math.max(0,e-(r+n))};return this._sliderRenderBounds=l,l}_getDefaultSliderCornerRadius(){let{direction:t,round:e}=this.attribute;if(e){let{width:e,height:i}=this.getSliderRenderBounds();return"horizontal"===t?i:e}return 0}_getSliderPos(t){let{direction:e}=this.attribute,{width:i,height:r,x1:s,y1:n}=this.getSliderRenderBounds();return"horizontal"===e?[i*t[0]+s,i*t[1]+s]:[r*t[0]+n,r*t[1]+n]}_getScrollRange(){if(this._sliderLimitRange)return this._sliderLimitRange;let{limitRange:t=[0,1],direction:e}=this.attribute,[i,r]=(0,h.Z)(t,0,1),{width:s,height:n,x1:a,y1:l}=this.getSliderRenderBounds(),o=this._sliderSize;return"horizontal"===e?(0,h.Z)([a+i*s,a+r*s],a,s-o):(0,h.Z)([l+i*n,l+r*n],l,n-o)}_clearDragEvents(){let t=(0,g.G)(),e="browser"===r.rF.env?r.rF:this.stage;e.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),t.forEach(t=>{e.removeEventListener(t,this._onSliderPointerUp)})}_reset(){this._sliderRenderBounds=null,this._sliderLimitRange=null}release(t){super.release(t),("browser"===r.rF.env?r.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}m.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0}},44889:function(t,e,i){"use strict";i.d(e,{O:()=>h,j:()=>o});var r=i(51129),s=i(89255),n=i(89705),a=i(91015),l=i(61226);function o(){(0,r.M)(),(0,s.N)(),(0,n.M)(),(0,a.k)()}function h(){(0,r.M)(),(0,s.N)(),(0,l.x)(),(0,a.k)()}},27589:function(t,e,i){"use strict";i.d(e,{X:()=>c});var r=i(95950),s=i(70501),n=i(88663),a=i(31535),l=i(47704),o=i(20672),h=i(28076),u=i(44889),d=i(98706);(0,u.j)();class c extends h.k{getStartAngle(){return(0,d.LW)(this._startAngle)}getEndAngle(){return(0,d.LW)(this._endAngle)}getMainSegmentPoints(){return this._mainSegmentPoints}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},c.defaultAttributes,t)),this.name="segment",this.key="segment",this.lines=[]}render(){this.removeAllChild(!0),this._reset();let{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:h=!0,multiSegment:u,mainSegmentIndex:d}=this.attribute;if(!h)return;this._computeLineAngle();let c=this._getMainSegmentPoints(),p=this._renderSymbol(t,c,"start"),g=this._renderSymbol(e,c,"end");if(this.startSymbol=p,this.endSymbol=g,u){let t=[...this.attribute.points];if((0,s.Z)(d))t[d]=this._clipPoints(t[d]);else{let e=this._clipPoints((0,n.VF)(t));t[0][0]=e[0],t[t.length-1][t[t.length-1].length-1]=e[e.length-1]}t.forEach((t,e)=>{var s,n;let h=o.i.line(Object.assign(Object.assign({points:t},(0,a.Z)(i)?null!=(s=i[e])?s:i[i.length-1]:i),{fill:!1}));h.name=`${this.name}-line`,h.id=this._getNodeId("line"+e),(0,l.Z)(null==r?void 0:r.line)||(h.states=(0,a.Z)(r.line)?null!=(n=r.line[e])?n:r.line[r.line.length-1]:r.line),this.add(h),this.lines.push(h)})}else{let t=o.i.line;(0,n.IX)(i)[0].cornerRadius&&(t=o.i.polygon);let e=t(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},(0,n.IX)(i)[0]),{fill:!1,closePath:!1}));e.name=`${this.name}-line`,e.id=this._getNodeId("line"),(0,l.Z)(null==r?void 0:r.line)||(e.states=[].concat(r.line)[0]),this.add(e),this.lines.push(e)}}_computeStartRotate(t){return t+Math.PI/2}_computeEndRotate(t){return t+Math.PI/2}_renderSymbol(t,e,i){let r;if(!e.length)return;let{autoRotate:n=!0}=t;if(t&&t.visible){let a,h,u=this.getStartAngle(),d=this.getEndAngle(),{state:c}=this.attribute,p=e[0],g=e[e.length-1],{refX:f=0,refY:m=0,refAngle:y=0,style:_,symbolType:v,size:b=12}=t;"start"===i?(a={x:p.x+((0,s.Z)(u)?f*Math.cos(u)+m*Math.cos(u-Math.PI/2):0),y:p.y+((0,s.Z)(u)?f*Math.sin(u)+m*Math.sin(u-Math.PI/2):0)},h=this._computeStartRotate(this._startAngle)):(a={x:g.x+((0,s.Z)(d)?f*Math.cos(d)+m*Math.cos(d-Math.PI/2):0),y:g.y+((0,s.Z)(d)?f*Math.sin(d)+m*Math.sin(d-Math.PI/2):0)},h=this._computeEndRotate(this._endAngle)),(r=o.i.symbol(Object.assign(Object.assign(Object.assign({},a),{symbolType:v,size:b,angle:n?h+y:0,strokeBoundsBuffer:0}),_))).name=`${this.name}-${i}-symbol`,r.id=this._getNodeId(`${i}-symbol`),(0,l.Z)(null==c?void 0:c.symbol)||(r.states=c.symbol),"start"===i?(0,l.Z)(null==c?void 0:c.startSymbol)||(r.states=c.startSymbol):(0,l.Z)(null==c?void 0:c.endSymbol)||(r.states=c.endSymbol),this.add(r)}return r}_getMainSegmentPoints(){let t;if(this._mainSegmentPoints)return this._mainSegmentPoints;let{points:e,multiSegment:i,mainSegmentIndex:r}=this.attribute;return t=i?(0,s.Z)(r)?e[r]:(0,n.VF)(e):e,this._mainSegmentPoints=t,t}_clipPoints(t){let{startSymbol:e={},endSymbol:i={}}=this.attribute,r=t;if(e.visible){let i=e.clip?e.size||10:0;r=[{x:t[0].x-i/2*(Math.cos(this._startAngle)||0),y:t[0].y-i/2*(Math.sin(this._startAngle)||0)},...r.slice(1)]}if(i.visible){let e=i.clip?i.size||10:0,s={x:t[t.length-1].x-e/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-e/2*(Math.sin(this._endAngle)||0)};r=[...r.slice(0,r.length-1),s]}return r}_computeLineAngle(){let t=this._getMainSegmentPoints();if(t.length<=1)return;let e=t[0],i=t[1],r=t[t.length-2],s=t[t.length-1],n=[e.x-i.x,e.y-i.y],a=Math.atan2(n[1],n[0]),l=[s.x-r.x,s.y-r.y],o=Math.atan2(l[1],l[0]);this._startAngle=a,this._endAngle=o}_reset(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}c.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}}},6004:function(t,e,i){"use strict";i.d(e,{d:()=>l});var r=i(51129),s=i(23112),n=i(29624),a=i(91015);function l(){(0,r.M)(),(0,s.g)(),(0,n.k)(),(0,a.k)()}},60121:function(t,e,i){"use strict";i.d(e,{i:()=>b});var r,s,n=i(31535),a=i(95950),l=i(21648),o=i(21777),h=i(88663),u=i(35652),d=i(12319),c=i(43562),p=i(91925),g=i(20672),f=i(28076);(r=s||(s={})).innerView="innerView",r.railContainer="sliderRailContainer",r.rail="sliderRail",r.startText="sliderStartText",r.endText="sliderEndText",r.startHandler="sliderStartHandler",r.startHandlerText="startHandlerText",r.endHandler="sliderEndHandler",r.endHandlerText="sliderEndHandlerText",r.track="sliderTrack",r.trackContainer="sliderTrackContainer";var m=i(6004),y=i(39144);function _(t){return(0,n.Z)(t)?t:[t,t]}function v(t){return t?"ew-resize":"ns-resize"}(0,m.d)();class b extends f.k{get track(){return this._track}get currentValue(){return this._currentValue}get startHandler(){return this._startHandler}get endHandler(){return this._endHandler}get tooltipShape(){return this._tooltipShape}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,a.Z)({},b.defaultAttributes,t)),this.name="slider",this._isHorizontal=!0,this._startHandler=null,this._endHandler=null,this._startHandlerText=null,this._endHandlerText=null,this._currentHandler=null,this._currentValue={},this._onTooltipShow=t=>{this._isChanging||this._tooltipState&&this._tooltipState.isActive||(this._tooltipState?this._tooltipState.isActive=!0:this._tooltipState={isActive:!0},this._onTooltipUpdate(t),this._dispatchTooltipEvent("sliderTooltipShow"))},this._onTooltipUpdate=t=>{if(this._isChanging||!this._tooltipState||!this._tooltipState.isActive)return;let e=this._isHorizontal?this._rail.globalAABBBounds.width():this._rail.globalAABBBounds.height(),i=(0,l.Z)(this._isHorizontal?(t.viewX-this._rail.globalAABBBounds.x1)/e:(t.viewY-this._rail.globalAABBBounds.y1)/e,0,1);i!==this._tooltipState.pos&&(this._tooltipState.pos=i,this._tooltipState.value=this.calculateValueByPos(i*e),this._updateTooltip(),this._dispatchTooltipEvent("sliderTooltipUpdate"))},this._onTooltipHide=()=>{let{tooltip:t}=this.attribute;t&&t.alwaysShow||(this._tooltipState=null,this._tooltipShape&&this._tooltipShape.setAttribute("visible",!1),this._tooltipText&&this._tooltipText.setAttribute("visible",!1),this._dispatchTooltipEvent("sliderTooltipHide"))},this._onHandlerPointerdown=t=>{this._clearAllDragEvents(),this._isChanging=!0;let{x:e,y:i}=this.stage.eventPointTransform(t);this._currentHandler=t.target,this._prePos=this._isHorizontal?e:i;let r=(0,y.G)(),s="browser"===p.rF.env?p.rF:this.stage;s.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),r.forEach(t=>{s.addEventListener(t,this._onHandlerPointerUp)})},this._onHandlerPointerMove=t=>{var e,i;this._isChanging=!0;let{railWidth:r,railHeight:s,min:n,max:a}=this.attribute;if(a===n)return;let{x:o,y:h}=this.stage.eventPointTransform(t),u,d,c,p=0;this._isHorizontal?(p=(u=o)-this._prePos,d=null==(i=this._currentHandler)?void 0:i.attribute.x,c=r):(p=(u=h)-this._prePos,d=null==(e=this._currentHandler)?void 0:e.attribute.y,c=s);let g=(0,l.Z)(d+p,0,c),f=this.calculateValueByPos(g);"text"===this._currentHandler.type?this._updateHandlerText(this._currentHandler,g,f):this._updateHandler(this._currentHandler,g,f),this._updateTrack(),this._prePos=u,this._dispatchChangeEvent()},this._onHandlerPointerUp=t=>{this._isChanging=!1,this._currentHandler=null,this._clearAllDragEvents()},this._handleTouchMove=t=>{this._isChanging&&t.preventDefault()},this._onTrackPointerdown=t=>{this._clearAllDragEvents(),this._isChanging=!0;let{x:e,y:i}=this.stage.eventPointTransform(t);this._prePos=this._isHorizontal?e:i;let r=(0,y.G)(),s="browser"===p.rF.env?p.rF:this.stage;s.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),r.forEach(t=>{s.addEventListener(t,this._onTrackPointerUp)})},this._onTrackPointerMove=t=>{let e,i,r;this._isChanging=!0;let{railWidth:s,railHeight:n,min:a,max:o,inverse:h}=this.attribute;if(o===a)return;let{startHandler:u,endHandler:d}=this._getHandlers(),{x:c,y:p}=this.stage.eventPointTransform(t);this._isHorizontal?(e=c,i=this._track.attribute.width,r=s):(e=p,i=this._track.attribute.height,r=n);let g=e-this._prePos;if(u){let t=this._isHorizontal?u.attribute.x:u.attribute.y,e=h?(0,l.Z)(t+g,i,r):(0,l.Z)(t+g,0,r-i),s=this.calculateValueByPos(e);this._updateHandler(u,e,s)}if(d){let t=this._isHorizontal?d.attribute.x:d.attribute.y,e=h?(0,l.Z)(t+g,0,r-i):(0,l.Z)(t+g,i,r),s=this.calculateValueByPos(e),n=null==u?void 0:u.attribute;this._updateHandler(d,e,s),this._track.setAttributes(this._isHorizontal?{x:Math.min(n.x,d.attribute.x),width:Math.abs(n.x-d.attribute.x)}:{y:Math.min(n.y,d.attribute.y),height:Math.abs(n.y-d.attribute.y)})}this._prePos=e,this._dispatchChangeEvent()},this._onTrackPointerUp=t=>{this._isChanging=!1,this._clearAllDragEvents()},this._onRailPointerDown=t=>{let e,i,r;this._clearAllDragEvents(),this._isChanging=!0;let{railWidth:s,railHeight:n,min:a,max:l}=this.attribute;if(l===a)return;let h=this._startHandler,u=this._endHandler;this._isHorizontal?(e=t.viewX-this._rail.globalAABBBounds.x1,i=null==h?void 0:h.attribute.x,r=null==u?void 0:u.attribute.x):(e=t.viewY-this._rail.globalAABBBounds.y1,i=null==h?void 0:h.attribute.y,r=null==u?void 0:u.attribute.y);let d=this.calculateValueByPos(e);if((0,o.Z)(r)){let t=Math.abs(e-i)>Math.abs(e-r)?u:h;this._updateHandler(t,e,d)}else this._updateHandler(h,e,d);this._updateTrack(),this._dispatchChangeEvent()}}calculatePosByValue(t,e){let{layout:i,railWidth:r,railHeight:s,min:n,max:a,inverse:l}=this.attribute,o=0;return o=n===a?"start"===e?0:+("end"===e):(t-n)/(a-n),(l?1-o:o)*("vertical"===i?s:r)}calculateValueByPos(t){let{layout:e,railWidth:i,railHeight:r,min:s,max:n,inverse:a}=this.attribute,l="vertical"===e?r:i;return s+(n-s)*(a?1-t/l:t/l)}setValue(t){let{min:e,max:i}=this.attribute;if(i===e)return;let[r,s]=(0,h.IX)(t),{startHandler:n,endHandler:a}=this._getHandlers();n&&this._updateHandler(n,this.calculatePosByValue(r),r),a&&this._updateHandler(a,this.calculatePosByValue(s),s),this._updateTrack()}render(){var t,e;let i;this.removeAllChild(!0);let{layout:r="horizontal",railWidth:n,railHeight:a,startText:l,endText:h,min:d,max:c,showHandler:p=!0,showTooltip:f}=this.attribute,{value:m}=this.attribute;(0,u.Z)(m)&&(m=[d,c]),this._currentValue={startValue:_(m)[0],endValue:_(m)[1]};let y="horizontal"===r;this._isHorizontal=y;let v=g.i.group({x:0,y:0});v.name=s.innerView,this.add(v),this._innerView=v;let b,x=0;if(l&&l.visible){(b=g.i.text(Object.assign({x:y?0:n/2,y:y?a/2:0,textAlign:y?"start":"center",textBaseline:y?"middle":"top",text:l.text,lineHeight:null==(t=l.style)?void 0:t.fontSize},l.style))).name=s.startText,v.add(b);let e=(0,o.Z)(l.space)?l.space:0;x+=(y?b.AABBBounds.width():b.AABBBounds.height())+e}let S=g.i.group({x:y?x:0,y:y?0:x});v.add(S);let k=g.i.group({x:0,y:0});if(k.name=s.railContainer,this._railContainer=k,S.add(k),this._mainContainer=S,this._renderRail(k),x+=y?n:a,h&&h.visible){let t=(0,o.Z)(h.space)?h.space:0;(i=g.i.text(Object.assign({x:y?x+t:n/2,y:y?a/2:x+t,textAlign:y?"start":"center",textBaseline:y?"middle":"top",text:h.text,lineHeight:null==(e=h.style)?void 0:e.fontSize},h.style))).name=s.endText,v.add(i)}this._renderTrack(k),p&&(this._renderHandlers(S),this._bindEvents()),f&&(this._renderTooltip(),this._bindTooltipEvents())}_renderRail(t){let{railWidth:e,railHeight:i,railStyle:r,slidable:n}=this.attribute,a="default";!1!==n&&(a="pointer");let l=g.i.rect(Object.assign({x:0,y:0,width:e,height:i,cursor:a},r));return l.name=s.rail,t.add(l),this._rail=l,l}_renderHandlers(t){let{range:e,min:i,max:r,handlerSize:n=14,handlerStyle:a,handlerText:l,railHeight:o,railWidth:h,slidable:d}=this.attribute,{value:c}=this.attribute;(0,u.Z)(c)&&(c=[i,r]);let p=l&&l.visible,g=this._isHorizontal,[f,m]=_(c),y=this.calculatePosByValue(f,e?"start":"end"),b=this._renderHandler(Object.assign({x:g?y:h/2,y:g?o/2:y,size:n,strokeBoundsBuffer:0,cursor:!1===d?"default":v(g)},a));if(b.name=s.startHandler,this._startHandler=b,t.add(b),this._currentValue.startPos=y,p){let i=this._renderHandlerText(f,e?"start":"end");i.name=s.startHandlerText,t.add(i),this._startHandlerText=i}if(e){let e=this.calculatePosByValue(m,"end"),i=this._renderHandler(Object.assign({x:g?e:h/2,y:g?o/2:e,size:n,strokeBoundsBuffer:0,cursor:!1===d?"default":v(g)},a));if(i.name=s.endHandler,this._endHandler=i,t.add(i),this._currentValue.endPos=e,p){let e=this._renderHandlerText(m,"end");e.name=s.endHandlerText,t.add(e),this._endHandlerText=e}}}_renderTrack(t){let e,i,r,{range:n,min:a,max:o,railHeight:h,railWidth:p,trackStyle:f,railStyle:m,slidable:y,value:_}=this.attribute;if((0,u.Z)(_))n?(e=a,i=o):e=i=a;else if(n){let t=(0,d.Z)(_,a,o);e=t[0],i=t[1]}else e=a,i=(0,l.Z)(_,a,o);let b=this._isHorizontal;n||(e=a);let x=g.i.group({x:0,y:0,width:p,height:h,cornerRadius:null==m?void 0:m.cornerRadius,clip:!0,pickable:!1});x.name=s.trackContainer;let S=(0,c.Z)(n)&&!0===n.draggableTrack;r=!1===y?"default":!1===n||!1===S?"pointer":v(b);let k=this.calculatePosByValue(e,"start"),A=this.calculatePosByValue(i,n?"end":"start"),M=g.i.rect(Object.assign({x:b?Math.min(k,A):0,y:b?0:Math.min(k,A),width:b?Math.abs(A-k):p,height:b?h:Math.abs(A-k),cursor:r},f));M.name=s.track,this._track=M,x.add(M),t.add(x)}_renderHandler(t){return g.i.symbol(t)}_renderHandlerText(t,e){var i,r,s;let{align:n,handlerSize:a=14,handlerText:l={},railHeight:o,railWidth:h,slidable:u}=this.attribute,d=this._isHorizontal,c=this.calculatePosByValue(t,e),p=null!=(i=l.space)?i:4,f={text:l.formatter?l.formatter(t):t.toFixed(null!=(r=l.precision)?r:0),lineHeight:null==(s=l.style)?void 0:s.lineHeight,cursor:!1===u?"default":v(d)};return d?"top"===n?(f.textBaseline="bottom",f.textAlign="center",f.x=c,f.y=(o-a)/2-p):(f.textBaseline="top",f.textAlign="center",f.x=c,f.y=(o+a)/2+p):("left"===n?(f.textBaseline="middle",f.textAlign="end",f.x=(h-a)/2-p):(f.textBaseline="middle",f.textAlign="start",f.x=(h+a)/2+p),f.y=c),g.i.text(Object.assign(Object.assign({},f),l.style))}_renderTooltip(){var t;let{tooltip:e,railHeight:i,railWidth:r,align:s}=this.attribute;e&&e.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;let n=this._isHorizontal?0:r/2,a=this._isHorizontal?i/2:0;if(e&&e.shape){let t=g.i.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:n,y:a,symbolType:"circle"},e.shapeStyle));this._tooltipShape=t,this._mainContainer.add(t)}let l=e&&e.text||{},o=null!=(t=l.space)?t:6,h={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(h.x=n,h.y="top"===s?a-i/2-o:a+i/2+o,h.textAlign="center",h.textBaseline="top"===s?"bottom":"top"):(h.y=a,h.x="left"===s?n-r/2-o:a+r/2+o,h.textAlign="left"===s?"end":"start",h.textBaseline="middle");let u=g.i.text(Object.assign(Object.assign({},h),l.style));this._mainContainer.add(u),this._tooltipText=u,this._tooltipState&&this._updateTooltip()}_updateTooltip(){var t,e;if(!this._tooltipShape&&!this._tooltipText||!this._tooltipState)return;let{railWidth:i,railHeight:r}=this.attribute,s=this._isHorizontal?i:r,n=this._tooltipState.pos*s,a=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes({visible:!0,[a]:n});let{align:l}=this.attribute;if(this._tooltipText){let i=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes({visible:!0,[a]:n,text:i.formatter?i.formatter(this._tooltipState.value):this._isHorizontal||"left"!==l?`≈ ${this._tooltipState.value.toFixed(null!=(e=i.precision)?e:0)}`:`${this._tooltipState.value.toFixed(null!=(t=i.precision)?t:0)} ≈`})}}_bindEvents(){if(this.attribute.disableTriggerEvent)return;let{slidable:t,range:e}=this.attribute;t&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),(0,c.Z)(e)&&e.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown),("browser"===p.rF.env?p.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}))}_bindTooltipEvents(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}_clearAllDragEvents(){let t=(0,y.G)(),e="browser"===p.rF.env?p.rF:this.stage;e.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),t.forEach(t=>{e.removeEventListener(t,this._onHandlerPointerUp)}),e.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),t.forEach(t=>{e.removeEventListener(t,this._onTrackPointerUp)})}_updateTrack(){let{inverse:t,railWidth:e,railHeight:i}=this.attribute,r=this._startHandler,s=this._endHandler;if(this._isHorizontal){let i=null==r?void 0:r.attribute.x;if(s){let t=null==s?void 0:s.attribute.x;this._track.setAttributes({x:Math.min(i,t),width:Math.abs(i-t)})}else t?this._track.setAttributes({x:i,width:e-i}):this._track.setAttributes({width:i})}else{let e=null==r?void 0:r.attribute.y;if(s){let t=null==s?void 0:s.attribute.y;this._track.setAttributes({y:Math.min(e,t),height:Math.abs(e-t)})}else t?this._track.setAttributes({y:e,height:i-e}):this._track.setAttributes({height:e})}}_updateHandler(t,e,i){var r;let n=this._isHorizontal;t.setAttribute(n?"x":"y",e);let a=t.name===s.startHandler?this._startHandlerText:this._endHandlerText;if(a){let{handlerText:t={}}=this.attribute;a.setAttributes({text:t.formatter?t.formatter(i):i.toFixed(null!=(r=t.precision)?r:0),[n?"x":"y"]:e})}t.name===s.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_updateHandlerText(t,e,i){var r;let n=this._isHorizontal,{handlerText:a={}}=this.attribute;t.setAttributes({[n?"x":"y"]:e,text:a.formatter?a.formatter(i):i.toFixed(null!=(r=a.precision)?r:0)});let l=t.name===s.startHandlerText?this._startHandler:this._endHandler;l&&l.setAttributes({[n?"x":"y"]:e}),t.name===s.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_dispatchChangeEvent(){let t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}_dispatchTooltipEvent(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}_getHandlers(){let{inverse:t}=this.attribute,e=this._startHandler,i=this._endHandler;return i&&(this._isHorizontal?(!t&&i.attribute.x<(null==e?void 0:e.attribute.x)||t&&i.attribute.x>(null==e?void 0:e.attribute.x))&&([e,i]=[i,e]):(!t&&i.attribute.y<(null==e?void 0:e.attribute.y)||t&&i.attribute.y>(null==e?void 0:e.attribute.y))&&([e,i]=[i,e])),{startHandler:e,endHandler:i}}release(t){super.release(t),("browser"===p.rF.env?p.rF:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearAllDragEvents()}}b.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}}},48683:function(t,e,i){"use strict";i.d(e,{b:()=>o});var r=i(51129),s=i(29624),n=i(91015),a=i(80523),l=i(23112);function o(){(0,r.M)(),(0,s.k)(),(0,n.k)(),(0,a.v)(),(0,l.g)()}},46293:function(t,e,i){"use strict";i.d(e,{V:()=>y});var r=i(78388),s=i(95950),n=i(11681),a=i(61868),l=i(45273),o=i(47704),h=i(21777),u=i(35652),d=i(43562),c=i(88663),p=i(28076),g=i(47979),f=i(48683),m=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)0>e.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(i[r[s]]=t[r[s]])}return i};(0,f.b)();class y extends p.k{getBgRect(){return this._bgRect}getTextShape(){return this._textShape}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,s.Z)({},y.defaultAttributes,t)),this.name="tag",this._tagStates=[],this._rectStates=[],this._symbolStates=[],this._textStates=[]}render(){var t,e,i;let s,p,f;this.cacheStates();let{text:y="",textStyle:_={},shape:v={},panel:b={},space:x=4,minWidth:S,maxWidth:k,padding:A=4,visible:M,state:w,type:T,textAlwaysCenter:C,containerTextAlign:E}=this.attribute,B=(0,n.o)(A),P=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group"),O,I=-B[3],R=-B[0],L=B[1]+B[3],D=B[0]+B[2],F=0,z=0,{visible:j}=v,H=m(v,["visible"]);if((0,a.Z)(j)){let t=(null==H?void 0:H.size)||10,e=(0,l.Z)(t)?t:Math.max(t[0],t[1]);O=P.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:t,strokeBoundsBuffer:0},H),{visible:j,x:e/2,y:e/2}),"symbol"),(0,o.Z)(null==w?void 0:w.shape)||(O.states=w.shape),j&&(z=e+x)}if(L+=z,F+=z,(0,g.TV)({text:y})||"rich"===T){let t=Object.assign(Object.assign(Object.assign({},(0,g.ut)(Object.assign({type:T,text:y},_))),_),{visible:(0,h.Z)(y)&&!1!==M,x:F,y:0});(0,u.Z)(t.lineHeight)&&(t.lineHeight=_.fontSize),p=(s=P.createOrUpdateChild("tag-text",t,"richtext")).AABBBounds.width(),f=s.AABBBounds.height()}else{let i=Object.assign(Object.assign({text:(0,d.Z)(y)&&"type"in y&&"text"===y.type?y.text:y,visible:(0,h.Z)(y)&&!1!==M,lineHeight:null==_?void 0:_.fontSize},_),{x:F,y:0});(0,u.Z)(i.lineHeight)&&(i.lineHeight=_.fontSize),s=P.createOrUpdateChild("tag-text",i,"text");let r=(0,g.fe)(i.text,_,null==(e=null==(t=this.stage)?void 0:t.getTheme())?void 0:e.text);p=r.width,f=r.height}L+=p;let N=null!=(i=v.size)?i:10,V=(0,l.Z)(N)?N:Math.max(N[0],N[1]);D+=Math.max(f,v.visible?V:0);let{textAlign:W,textBaseline:U}=_;((0,h.Z)(S)||(0,h.Z)(k))&&((0,h.Z)(S)&&L<S&&(L=S),(0,h.Z)(k)&&L>k&&(L=k,s.setAttribute("maxLineWidth",k-B[1]-B[2]))),I=0,R=0;let G=0;"left"===W||"start"===W?G=1:"right"===W||"end"===W?G=-1:"center"===W&&(G=0),G?G<0?(I-=L,O&&O.setAttribute("x",(O.attribute.x||0)-p),P.setAttribute("x",-B[1]-z)):G>0&&P.setAttribute("x",B[3]):(I-=L/2,O&&O.setAttribute("x",(O.attribute.x||0)-p/2),P.setAttribute("x",-z/2));let Z=(t,e)=>{"richtext"===s.type?s.setAttributes({x:t,textAlign:e,textConfig:(0,c.IX)(s.attribute.textConfig).map(t=>Object.assign(Object.assign({},t),{textAlign:e}))}):s.setAttributes({x:t,textAlign:e})};if((E?"center"===E:C)&&G){let t=L-B[1]-B[3],e=p+z,i=1===G?(t-e)/2+z+p/2:B[0]+z-(L/2+e/2-z)+p/2;if(Z(i,"center"),O){let t=i-p/2-z+V/2;O.setAttributes({x:t})}}if(("left"===E||"start"===E)&&1!==G){let t=L-B[1]-B[3],e=0===G?-t/2+z/2:-L+B[3]+B[1]+z;Z(e+z,"left"),O&&O.setAttributes({x:e+V/2})}if(("right"===E||"end"===E)&&-1!==G){let t=L-B[1]-B[3],e=0===G?t/2+z/2:t;if(Z(e,"right"),O){let t=e-p-z+V/2;O.setAttributes({x:t})}}"middle"===U?(R-=D/2,O&&O.setAttribute("y",0)):"bottom"===U?(R-=D,O&&O.setAttribute("y",-f/2),P.setAttribute("y",-B[2])):"top"===U&&(P.setAttribute("y",B[0]),O&&O.setAttribute("y",f/2)),(0,o.Z)(null==w?void 0:w.text)||(s.states=w.text);let{visible:$}=b,Y=m(b,["visible"]);if(M&&(0,a.Z)($)){let t=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},Y),{visible:$&&!!y,width:L,height:D,x:I,y:R}),"rect");if((0,o.Z)(null==w?void 0:w.panel)||(t.states=w.panel),Y.customShape){let e=Y.customShape;t.pathProxy=t=>e(this,t,new r.r)}this._bgRect=t}this._textShape=s,this._symbol=O,this.resetStates()}initAttributes(t,e){t=(null==e?void 0:e.skipDefault)?t:(0,s.Z)({},y.defaultAttributes,t),super.initAttributes(t),this.render()}addState(t,e,i){super.addState(t,e,i),this._textShape&&this._textShape.addState(t,e,i),this._bgRect&&this._bgRect.addState(t,e,i),this._symbol&&this._symbol.addState(t,e,i)}removeState(t,e){super.removeState(t,e),this._textShape&&this._textShape.removeState(t,e),this._bgRect&&this._bgRect.removeState(t,e),this._symbol&&this._symbol.removeState(t,e)}cacheStates(){var t,e,i,r,s,n,a,l,o,h,u,d,c,p;this._tagStates=null!=(e=null==(t=this.currentStates)?void 0:t.slice())?e:[],this._rectStates=null!=(s=null==(r=null==(i=this._bgRect)?void 0:i.currentStates)?void 0:r.slice())?s:[],this._symbolStates=null!=(l=null==(a=null==(n=this._symbol)?void 0:n.currentStates)?void 0:a.slice())?l:[],this._textStates=null!=(u=null==(h=null==(o=this._textShape)?void 0:o.currentStates)?void 0:h.slice())?u:[],this.clearStates(),null==(d=this._bgRect)||d.clearStates(),null==(c=this._symbol)||c.clearStates(),null==(p=this._textShape)||p.clearStates()}resetStates(){var t,e,i;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&(null==(t=this._bgRect)||t.useStates(this._rectStates)),this._symbolStates.length&&(null==(e=this._symbol)||e.useStates(this._symbolStates)),this._textStates.length&&(null==(i=this._textShape)||i.useStates(this._textStates))}}y.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}}},5845:function(t,e,i){"use strict";i.d(e,{D:()=>c});var r=i(95950),s=i(11681),n=i(21777),a=i(31535),l=i(28076),o=i(11165),h=i(51129),u=i(23112),d=i(80523);(0,h.M)(),(0,u.g)(),(0,d.v)();class c extends l.k{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:(0,r.Z)({},c.defaultAttributes,t)),this.name="title"}render(){var t,e,i,r,l,h,u,d,c,p,g,f,m,y,_,v,b,x,S,k;let{textType:A,text:M,subtextType:w,textStyle:T={},subtext:C,subtextStyle:E={},width:B,height:P,minWidth:O,maxWidth:I,minHeight:R,maxHeight:L,align:D,verticalAlign:F,padding:z=0}=this.attribute,j=(0,s.o)(z),H=this.createOrUpdateChild("title-container",{x:j[3],y:j[0],zIndex:1},"group"),N=null!=(t=T.height)?t:P;if(!1!==this.attribute.visible&&!1!==T.visible){let{width:t,maxHeight:s,maxWidth:d,x:c=0,y:p=0,ellipsis:g=!0,wordBreak:f="break-word",maxWidth:m,lineClamp:y}=T;if("rich"===A||(0,n.Z)(T.character)){let r=Object.assign({x:c,y:p,width:null!=(e=null!=t?t:B)?e:0,height:null!=N?N:0,ellipsis:null==g||g,wordBreak:null!=f?f:"break-word",maxHeight:null!=s?s:L,maxWidth:null!=d?d:m,textConfig:null!=(i=T.character)?i:M},T);this._mainTitle=H.createOrUpdateChild("mainTitle",r,"richtext")}else if("html"===A){let e=Object.assign({html:Object.assign(Object.assign({dom:M},o.Ze),T),x:c,y:p,width:null!=(r=null!=t?t:B)?r:0,height:null!=N?N:0,ellipsis:g,wordBreak:f,maxHeight:null!=s?s:L,maxWidth:null!=d?d:m,textConfig:[]},T);this._mainTitle=H.createOrUpdateChild("mainTitle",e,"richtext")}else(0,n.Z)(M)&&(this._mainTitle=H.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:(0,a.Z)(M)?M:[M],whiteSpace:"normal"},T),{maxLineWidth:null!=(h=null!=(l=T.maxLineWidth)?l:t)?h:B,heightLimit:null!=(u=T.height)?u:L,lineClamp:y,ellipsis:g,x:c,y:p}),"text"))}let V=this._mainTitle?this._mainTitle.AABBBounds.height():0,W=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(!1!==this.attribute.visible&&!1!==E.visible){let{width:t,height:e,maxWidth:i,maxHeight:r,x:s=0,y:l=0,ellipsis:h=!0,wordBreak:u="break-word",lineClamp:_}=E,v=Math.max(Number.MIN_VALUE,L-V);if("rich"===w||(0,n.Z)(E.character)){let n=Object.assign({x:s,y:l,width:null!=(d=null!=t?t:B)?d:0,height:null!=(c=null!=e?e:P)?c:0,ellipsis:h,wordBreak:u,maxHeight:null!=r?r:v,maxWidth:null!=i?i:I,textConfig:null!=(p=E.character)?p:C},E);this._subTitle=H.createOrUpdateChild("subTitle",n,"richtext")}else if("html"===w){let n=Object.assign({html:Object.assign(Object.assign({dom:C},o.Ze),E),x:s,y:l,width:null!=(g=null!=t?t:B)?g:0,height:null!=(f=null!=e?e:P)?f:0,ellipsis:h,wordBreak:u,maxHeight:null!=r?r:v,maxWidth:null!=i?i:I,textConfig:[]},E);this._subTitle=H.createOrUpdateChild("subTitle",n,"richtext")}else(0,n.Z)(C)&&(this._subTitle=H.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:(0,a.Z)(C)?C:[C],whiteSpace:"normal"},E),{maxLineWidth:null!=(m=E.maxLineWidth)?m:B,heightLimit:null!=(y=E.heightLimit)?y:v,lineClamp:_,ellipsis:h,x:0,y:V}),"text"))}let U=this._subTitle?this._subTitle.AABBBounds.height():0,G=Math.max(W,this._subTitle?this._subTitle.AABBBounds.width():0),Z=V+(null!=(_=E.height)?_:U);if((0,n.Z)(B)&&(G=B),(0,n.Z)(P)&&(Z=P),(0,n.Z)(O)&&G<O&&(G=O),(0,n.Z)(I)&&G>I&&(G=I),(0,n.Z)(R)&&Z<R&&(Z=R),(0,n.Z)(L)&&Z>L&&(Z=L),H.attribute.width=G,H.attribute.height=Z,H.attribute.boundsPadding=j,this._mainTitle){if((0,n.Z)(D)||(0,n.Z)(T.align)){let t=T.align?T.align:D,e=null!=(v=T.width)?v:G;"center"===t?(this._mainTitle.setAttribute("x",e/2),this._mainTitle.setAttribute("textAlign","center")):"right"===t?(this._mainTitle.setAttribute("x",e),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}let t=T.verticalAlign?T.verticalAlign:F,e=null!=N?N:this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height();"middle"===t?(this._mainTitle.setAttribute("y",e/2),this._mainTitle.setAttribute("textBaseline","middle")):"bottom"===t?(this._mainTitle.setAttribute("y",e),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}if(this._subTitle){if((0,n.Z)(D)||(0,n.Z)(E.align)){let t=E.align?E.align:D,e=null!=(x=null!=(b=E.width)?b:T.width)?x:G;"center"===t?(this._subTitle.setAttribute("x",e/2),this._subTitle.setAttribute("textAlign","center")):"right"===t?(this._subTitle.setAttribute("x",e),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}let t=E.verticalAlign?E.verticalAlign:F,e=this._mainTitle?(0,n.Z)(N)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height(),N):this._mainTitle.AABBBounds.y2:0,i=null!=(k=null!=(S=E.height)?S:P)?k:this._subTitle.AABBBounds.empty()?0:this._subTitle.AABBBounds.height();"middle"===t?(this._subTitle.setAttribute("y",e+i/2),this._subTitle.setAttribute("textBaseline","middle")):"bottom"===t?(this._subTitle.setAttribute("y",e+i),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",e),this._subTitle.setAttribute("textBaseline","top"))}}}c.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}}},42465:function(t,e,i){"use strict";i.d(e,{Bh:()=>l,Ck:()=>function t(e,i){e.forEachChildren(e=>{let r=i(e);e.isContainer&&!r&&t(e,i)})},Dh:()=>a,U4:()=>h,WF:()=>o,ic:()=>u,pn:()=>s,tP:()=>n});var r=i(35652);let s=t=>!(0,r.Z)(t)&&!1!==t.visible;function n(t,e){if(!e)return[];let i=t.find(t=>t.name===e,!0);return i?i.getChildren():[]}function a(t,e){if(!e)return[];let i=t.find(t=>t.name===e,!0);return i?i.findAll(t=>"group"!==t.type,!0):[]}function l(t){let e=[t[0]];for(let i=1;i<t.length;i++)t[i].x===t[i-1].x&&t[i].y===t[i-1].y||e.push(t[i]);return e}function o(t){return t>=0&&t<Math.PI/2||t>3*Math.PI/2&&t<=2*Math.PI}function h(t,e,i){return Math.abs(t-e)<i}function u(t,e,i){return t?{textAlign:"right",textBaseline:"middle"}:{textAlign:e<Math.PI&&i.toLocaleLowerCase().includes("top")||e>Math.PI&&i.toLocaleLowerCase().includes("bottom")?"left":e<Math.PI&&i.toLocaleLowerCase().includes("bottom")||e>Math.PI&&i.toLocaleLowerCase().includes("top")?"right":"center",textBaseline:e<Math.PI&&i.includes("inside")||e>Math.PI&&!i.includes("inside")?"bottom":"top"}}},39144:function(t,e,i){"use strict";i.d(e,{G:()=>s});var r=i(91925);function s(){return"browser"===r.rF.env?["pointerup","pointerleave","pointercancel"]:["pointerup","pointerleave","pointerupoutside"]}},47700:function(t,e,i){"use strict";i.d(e,{Q6:()=>o,fM:()=>a,lO:()=>l});var r=i(11165),s=i(42465),n=i(47704);let a=(t,e,i)=>{let a=t.target;return a!==i&&a.name&&!(0,n.Z)(a.states)?(a.addState(r.HW.hover,!0),(0,s.Ck)(e,t=>{t!==a&&t.name&&!(0,n.Z)(t.states)&&t.addState(r.HW.hoverReverse,!0)}),a):i},l=(t,e,i)=>i?((0,s.Ck)(e,t=>{t.name&&!(0,n.Z)(t.states)&&(t.removeState(r.HW.hoverReverse),t.removeState(r.HW.hover))}),null):i,o=(t,e,i)=>{let a=t.target;return i===a&&a.hasState(r.HW.selected)?((0,s.Ck)(e,t=>{t.name&&!(0,n.Z)(t.states)&&(t.removeState(r.HW.selectedReverse),t.removeState(r.HW.selected))}),null):a.name&&!(0,n.Z)(a.states)?(a.addState(r.HW.selected,!0),(0,s.Ck)(e,t=>{t!==a&&t.name&&!(0,n.Z)(t.states)&&t.addState(r.HW.selectedReverse,!0)}),a):i}},8843:function(t,e,i){"use strict";i.d(e,{Dg:()=>l,Fv:()=>a,bA:()=>s,kE:()=>n});var r=i(88504);function s(t,e){return[t[0]*e,t[1]*e]}function n(t){let[e,i]=t;return Math.sqrt(e*e+i*i)}function a(t){let e=n(t);return e>0&&(e=1/e),[t[0]*e,t[1]*e]}function l(t,e,i){let s=function(t,e){let[i,r]=t,[s,n]=e,a=Math.sqrt((i*i+r*r)*(s*s+n*n));return Math.acos(Math.min(Math.max(a&&(i*s+r*n)/a,-1),1))}(t,e),n=(0,r.ir)(t,e)>=0;return i?n?2*Math.PI-s:s:n?s:2*Math.PI-s}},47979:function(t,e,i){"use strict";i.d(e,{He:()=>f,TV:()=>d,fe:()=>u,gM:()=>h,ut:()=>p,vS:()=>g});var r=i(82794),s=i(20672),n=i(21728),a=i(43562),l=i(21777),o=i(11165);let h=(t,e,i,s)=>new n.e(Object.assign({defaultFontParams:Object.assign({fontFamily:o.iR,fontSize:o.$M},s),getTextBounds:i?void 0:r.o,specialCharSet:"-/: .,@%'\"~"+n.e.ALPHABET_CHAR_SET+n.e.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t);function u(t,e,i={}){if(!t)return{width:0,height:0};let s=(0,r.o)({text:t,fontFamily:e.fontFamily||i.fontFamily||o.iR,fontSize:e.fontSize||i.fontSize||12,fontWeight:e.fontWeight||i.fontWeight,textAlign:e.textAlign||"center",textBaseline:e.textBaseline,ellipsis:!!e.ellipsis,maxLineWidth:e.maxLineWidth||1/0,lineHeight:e.fontSize||i.fontSize||12});return{width:s.width(),height:s.height()}}function d(t,e="type"){return"rich"===c(t,e)}function c(t,e="type"){var i,r;return(0,a.Z)(t.text)&&"type"in t.text?null!=(i=t.text.type)?i:"text":e in t&&null!=(r=t[e])?r:"text"}function p(t){var e,i;return(0,l.Z)(t.maxLineWidth)&&(t.maxWidth=t.maxLineWidth,delete t.maxLineWidth),t.width=null!=(e=t.width)?e:0,t.height=null!=(i=t.height)?i:0,t.textConfig=t.text.text||t.text,t}function g(t,e="type"){let i=c(t,e);return"rich"===i?s.i.richtext(p(t)):("html"===i?t=function(t){let{text:e,_originText:i}=t,{text:r}=e;return t.html=r,t.text=i,t.renderable=!1,t}(t):"react"===i&&(t=function(t){let{text:e,_originText:i}=t,{text:r}=e;return t.react=r,t.text=i,t.renderable=!1,t}(t)),s.i.text(t))}function f(t,e,i,r,s){"right"===t?"center"===i?e.setAttribute("x",r-s/2):"right"===i||"end"===i?e.setAttribute("x",r):e.setAttribute("x",r-s):"center"===i?e.setAttribute("x",r+s/2):"right"===i||"end"===i?e.setAttribute("x",r+s):e.setAttribute("x",r)}},19293:function(t,e,i){"use strict";i.d(e,{et:()=>s});var r=i(76620);Symbol.for("BoundsAllocate");let s=new class{constructor(){this.pools=[];for(let t=0;t<10;t++)this.pools.push(new r.FB)}allocate(t,e,i,s){if(!this.pools.length)return(new r.FB).setValue(t,e,i,s);let n=this.pools.pop();return n.x1=t,n.y1=e,n.x2=i,n.y2=s,n}allocateByObj(t){if(!this.pools.length)return new r.FB(t);let e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}},64067:function(t,e,i){"use strict";i.d(e,{A:()=>n});var r=i(96087),s=i(38286);let n=new class{constructor(){this.pools=[],this.allocatedCanvas=[]}shareCanvas(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}getCommonCanvas(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}allocate(t){if(!this.pools.length){let e=(0,s.JN)(Object.assign({nativeCanvas:r.w.global.createCanvas(t)},t));return this.allocatedCanvas.push(e),e}let e=this.pools.pop();return e.resize(t.width,t.height),e.dpr=t.dpr,e}allocateByObj(t){if(!this.pools.length){let e={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},i=(0,s.JN)(Object.assign({nativeCanvas:r.w.global.createCanvas(e)},e));return this.allocatedCanvas.push(i),i}let e=this.pools.pop();return e.width=t.width,e.height=t.height,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}},53627:function(t,e,i){"use strict";i.d(e,{QE:()=>l,yp:()=>o});var r=i(8992),s=i(46527);function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Symbol.for("MatrixAllocate"),Symbol.for("Mat4Allocate");class a{constructor(){this.pools=[]}static identity(t){return(0,s.TL)(t)}allocate(){if(!this.pools.length)return n();let t=this.pools.pop();return a.identity(t),t}allocateByObj(t){let e;e=this.pools.length?this.pools.pop():n();for(let i=0;i<e.length;i++)e[i]=t[i];return e}free(t){t&&this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}let l=new class{constructor(){this.pools=[]}allocate(t,e,i,s,n,a){if(!this.pools.length)return new r.y(t,e,i,s,n,a);let l=this.pools.pop();return l.a=t,l.b=e,l.c=i,l.d=s,l.e=n,l.f=a,l}allocateByObj(t){if(!this.pools.length)return new r.y(t.a,t.b,t.c,t.d,t.e,t.f);let e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}},o=new a},96087:function(t,e,i){"use strict";i.d(e,{w:()=>r});let r=new class{}},74239:function(t,e,i){"use strict";i.d(e,{Of:()=>d,MB:()=>u});class r{constructor(){this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}clearCache(t,e){let{CLEAN_THRESHOLD:i=this.CLEAN_THRESHOLD,L_TIME:r=this.L_TIME,R_COUNT:s=this.R_COUNT}=e;if(t.size<i)return 0;let n=0,a=e=>{n++,t.delete(e)},l=Date.now();return t.forEach((t,e)=>{if(t.timestamp.length<s)return a(e);let i=0;for(;l-t.timestamp[t.timestamp.length-1-i]<r&&!(++i>=s););if(i<s)return a(e);for(;l-t.timestamp[0]>r;)t.timestamp.shift()}),n}addLimitedTimestamp(t,e,i){let{R_TIMESTAMP_MAX_SIZE:r=this.R_TIMESTAMP_MAX_SIZE}=i;t.timestamp.length>r&&t.timestamp.shift(),t.timestamp.push(e)}clearTimeStamp(t,e){let{L_TIME:i=this.L_TIME}=e,r=Date.now();t.forEach(t=>{for(;r-t.timestamp[0]>i;)t.timestamp.shift()})}clearItemTimestamp(t,e){let{L_TIME:i=this.L_TIME}=e,r=Date.now();for(;r-t.timestamp[0]>i;)t.timestamp.shift()}}var s=i(88504),n=i(96087),a=i(58273);class l{static GetCanvas(){try{return l.canvas||(l.canvas=n.w.global.createCanvas({})),l.canvas}catch(t){return null}}static GetCtx(){if(!l.ctx){let t=l.GetCanvas();l.ctx=t.getContext("2d")}return l.ctx}}class o extends r{static getInstance(){return o._instance||(o._instance=new o),o._instance}constructor(t=[],e=100){super(),this.cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},this.dataMap=new Map;let i=l.GetCanvas(),r=l.GetCtx();if(i.width=e,i.height=1,!r)return;if(r.translate(0,0),!r)throw Error("获取ctx发生错误");let s=r.createLinearGradient(0,0,e,0);t.forEach(t=>{s.addColorStop(t[0],t[1])}),r.fillStyle=s,r.fillRect(0,0,e,1),this.rgbaSet=r.getImageData(0,0,e,1).data}getColor(t){let e=this.rgbaSet.slice(4*t,4*t+4);return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]/255})`}GetOrCreate(t,e,i,r,s=[],n=100){let a=`${t}${e}${i}${r}`;s.forEach(t=>a+=t.join()),a+=n;let l=this.dataMap.get(a);return l||(l={data:new o(s,n),timestamp:[]},this.addLimitedTimestamp(l,Date.now(),{}),this.dataMap.set(a,l)),this.clearCache(this.dataMap,this.cacheParams),l.data}}class h{static GetSize(t){for(let e=0;e<h.ImageSize.length;e++)if(h.ImageSize[e]>=t)return h.ImageSize[e];return t}static Get(t,e,i,r,s,n,a){let l=h.GenKey(t,e,i,r,s),o=h.cache[l];if(!o||0===o.length)return null;for(let t=0;t<o.length;t++)if(o[t].width>=n&&o[t].height>=a)return o[t].pattern;return null}static Set(t,e,i,r,s,n,a,l){let o=h.GenKey(t,e,i,r,s);h.cache[o]?h.cache[o].push({width:a,height:l,pattern:n}):h.cache[o]=[{width:a,height:l,pattern:n}]}static GenKey(t,e,i,r,s){return`${e},${i},${r},${s},${t.join()}`}}function u(t,e,i,r){let{stops:n,startAngle:l,endAngle:o}=r;for(;i<0;)i+=s.f7;for(;i>s.f7;)i-=s.f7;if(i<l||i>o)return n[0].color;let h,u,d=(i-l)/(o-l);for(let t=0;t<n.length;t++)if(n[t].offset>=d){h=n[t-1],u=n[t];break}return d=(d-h.offset)/(u.offset-h.offset),(0,a.BM)(h.color,u.color,d,!1)}function d(t,e,i,r,s,n,a,u,d){let c=Math.floor(180*s/Math.PI),p=l.GetCanvas(),g=l.GetCtx();if(!g)return null;let f=h.GetSize(u),m=h.GetSize(d),y=h.Get(e,i,r,n,a,f,m);if(y)return y;let _=Math.sqrt(Math.max(Math.max(Math.pow(i,2)+Math.pow(r,2),Math.pow(f-i,2)+Math.pow(r,2)),Math.max(Math.pow(f-i,2)+Math.pow(m-r,2),Math.pow(i,2)+Math.pow(m-r,2)))),v=c+1,b=s/Math.max(1,v-1),x=o.getInstance().GetOrCreate(i,r,f,m,e,v),S=2*Math.PI*_/360;p.width=f,p.height=m,g.setTransform(1,0,0,1,0,0),g.clearRect(0,0,f,m),g.translate(i,r),g.rotate(n);for(let t=0,e=v-1;t<e&&!(n+t*b>a);t++){let e=x.getColor(t);g.beginPath(),g.rotate(b),g.moveTo(0,0),g.lineTo(_,-2*S),g.lineTo(_,0),g.fillStyle=e,g.closePath(),g.fill()}let k=g.getImageData(0,0,f,m);return p.width=k.width,p.height=k.height,g.putImageData(k,0,0),(y=t.createPattern(p,"no-repeat"))&&h.Set(e,i,r,n,a,y,f,m),y}h.cache={},h.ImageSize=[20,40,80,160,320,640,1280,2560]},42832:function(t,e,i){"use strict";i.d(e,{A:()=>s,r:()=>r});let r=Symbol.for("CanvasFactory"),s=Symbol.for("Context2dFactory")},89359:function(t,e,i){"use strict";i.d(e,{u:()=>r});class r{get displayWidth(){return this._pixelWidth/this._dpr}get displayHeight(){return this._pixelHeight/this._dpr}get id(){return this._id}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get nativeCanvas(){return this._nativeCanvas}set nativeCanvas(t){this._nativeCanvas=t}get width(){return this._pixelWidth}set width(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}get height(){return this._pixelHeight}set height(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}getContext(t){return this._context}get visiable(){return this._visiable}set visiable(t){this._visiable=t,t?this.show():this.hide()}get dpr(){return this._dpr}set dpr(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}constructor(t){var e;let{nativeCanvas:i,width:r=500,height:s=500,dpr:n=1,x:a,y:l,id:o,canvasControled:h=!0}=t;this._x=null!=a?a:0,this._y=null!=l?l:0,this._pixelWidth=r*n,this._pixelHeight=s*n,this._visiable=!1!==t.visiable,this.controled=h,this._displayWidth=r,this._displayHeight=s,this._dpr=n,this._nativeCanvas=i,this._id=null!=(e=i.id)?e:o,o&&(i.id=o),this.init(t)}getNativeCanvas(){return this._nativeCanvas}hide(){}show(){}applyPosition(){}resetStyle(t){}resize(t,e){}toDataURL(t,e){return""}readPixels(t,e,i,r){return this._context.getImageData(t,e,i,r)}convertToBlob(t){throw Error("暂未实现")}transferToImageBitmap(){throw Error("暂未实现")}release(...t){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}r.env="browser"},21288:function(t,e,i){"use strict";i.d(e,{w:()=>d});var r=i(8992),s=i(17783),n=i(38286),a=i(78388),l=i(29436),o=i(53627);let h=new r.y(1,0,0,1,0,0),u={x:0,y:0},d=class{get nativeContext(){return this.path}constructor(t,e){this.matrix=new r.y(1,0,0,1,0,0),this.stack=[],this.dpr=e,this.applyedMatrix=new r.y(1,0,0,1,0,0),this.path=new a.r,this._clearMatrix=new r.y(1,0,0,1,0,0)}getCanvas(){throw Error("不支持getCanvas")}getContext(){throw Error("不支持getContext")}setTransformForCurrent(t=!1){!t&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix=this.cloneMatrix(this.matrix))}get currentMatrix(){return this.matrix}cloneMatrix(t){return o.QE.allocateByObj(t)}clear(){this.save(),this.resetTransform(),this.restore()}reset(){this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new r.y(1,0,0,1,0,0),this.stack.length=0}restore(){this.stack.length>0&&(o.QE.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent())}highPerformanceRestore(){this.stack.length>0&&(o.QE.free(this.matrix),this.matrix=this.stack.pop())}rotate(t,e=!0){this.matrix.rotate(t),e&&this.setTransformForCurrent()}save(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}highPerformanceSave(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}scale(t,e,i=!0){this.matrix.scale(t,e),i&&this.setTransformForCurrent()}setScale(t,e,i=!0){this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}scalePoint(t,e,i,r,s=!0){this.translate(i,r,!1),this.scale(t,e,!1),this.translate(-i,-r,!1),s&&this.setTransformForCurrent()}setTransform(t,e,i,r,s,n,a=!0,l=this.dpr){this.matrix.setValue(l*t,l*e,l*i,l*r,l*s,l*n),a&&this.setTransformForCurrent()}setTransformFromMatrix(t,e=!0,i=this.dpr){this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}resetTransform(t=!0,e=this.dpr){this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}transform(t,e,i,r,s,n,a=!0){this.matrix.multiply(t,e,i,r,s,n),a&&this.setTransformForCurrent()}transformFromMatrix(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}translate(t,e,i=!0){this.matrix.translate(t,e),i&&this.setTransformForCurrent()}rotateDegrees(t,e=!0){let i=t*Math.PI/180;this.rotate(i,e)}rotateAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}rotateDegreesAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}beginPath(){this.path.clear()}clip(t,e){}arc(t,e,i,r,s,n){this.path.arc(t,e,i,r,s,n)}arcTo(t,e,i,r,s){this.path.arcTo(t,e,i,r,s)}bezierCurveTo(t,e,i,r,s,n){this.path.bezierCurveTo(t,e,i,r,s,n)}closePath(){this.path.closePath()}ellipse(t,e,i,r,s,n,a,l){}lineTo(t,e){this.path.lineTo(t,e)}moveTo(t,e){this.path.moveTo(t,e)}quadraticCurveTo(t,e,i,r){this.path.quadraticCurveTo(t,e,i,r)}rect(t,e,i,r){this.path.rect(t,e,i,r)}createImageData(t,e){return null}createLinearGradient(t,e,i,r){throw Error("不支持createLinearGradient")}createPattern(t,e){throw Error("不支持createPattern")}createRadialGradient(t,e,i,r,s,n){throw Error("不支持createRadialGradient")}createConicGradient(t,e,i,r){return null}fill(t,e){}fillRect(t,e,i,r){this.path.rect(t,e,i,r)}clearRect(t,e,i,r){}fillText(t,e,i){}getImageData(t,e,i,r){return null}getLineDash(){return[]}isPointInPath(t,e){return this.matrix.transformPoint({x:t,y:e},u),(0,n.XS)(this.path.commandList,u.x,u.y)}isPointInStroke(t,e){if(!this.lineWidth)return!1;this.matrix.transformPoint({x:t,y:e},u);let i=(0,l.D)(this,this.lineWidth,this.dpr);return(0,n.me)(this.path.commandList,i,u.x,u.y)}measureText(t){throw Error("不支持measureText")}putImageData(t,e,i){throw Error("不支持measureText")}setLineDash(t){}stroke(t){}strokeRect(t,e,i,r){this.path.rect(t,e,i,r)}strokeText(t,e,i){}drawImage(){}setCommonStyle(t,e,i,r,s){}_setCommonStyle(t,e,i,r){}setStrokeStyle(t,e,i,r,s){}_setStrokeStyle(t,e,i,r){}setTextStyleWithoutAlignBaseline(t,e){}setTextStyle(t,e){}draw(){}clearMatrix(t=!0,e=this.dpr){this.setTransformFromMatrix(h,t,e)}setClearMatrix(t,e,i,r,s,n){this._clearMatrix.setValue(t,e,i,r,s,n)}onlyTranslate(t=this.dpr){return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}release(...t){this.stack.forEach(t=>o.QE.free(t)),this.stack.length=0}};d=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,s.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],d)},38286:function(t,e,i){"use strict";i.d(e,{JN:()=>h,XS:()=>T,me:()=>C});var r=i(88504),s=i(6201),n=i(78591),a=i(93279),l=i(96087),o=i(42832);function h(t){return a.n.getNamed(o.r,l.w.global.env)(t)}let u=Math.sqrt(3),d=1/3;function c(t){return t>-x&&t<x}let p=[0,0],g=[0,0],f=[0,0];function m(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function y(t,e,i,r){let s=1-r;return s*(s*t+2*r*e)+r*r*i}function _(t,e,i,r,s){let n=1-s;return n*n*(n*t+3*s*e)+s*s*(s*r+3*n*i)}function v(t){return(t%=r.f7)<0&&(t+=r.f7),t}function b(t,e,i,r,s,n,a){if(0===s)return!1;let l=s/2,o=0,h=t;if(a>e+l&&a>r+l||a<e-l&&a<r-l||n>t+l&&n>i+l||n<t-l&&n<i-l)return!1;if(t===i)return Math.abs(n-t)<=s/2;let u=(o=(e-r)/(t-i))*n-a+(t*r-i*e)/(t-i);return u*u/(o*o+1)<=s/2*s/2}let x=1e-4,S=[-1,-1,-1],k=[-1,-1];function A(t){return Math.round(t/r.pi*1e8)/1e8%2*r.pi}let M=[0,0];function w(t,e,i,a,l){let o=t.length,h,w,T=0,C=0,E=0,B=0,P=0;for(let D=0;D<o;D++){var O,I,R,L;let o=t[D],F=0===D;o[0]===n.m.M&&D>1&&(i||(T+=(0,s.N0)(C,E,B,P,a,l))),F&&(C=o[1],E=o[2],B=C,P=E);let z=o[0],j=o[1],H=o[2],N=o[3],V=o[4],W=o[5],U=o[6],G=V,Z=W;M[0]=G,M[1]=Z,function(t,e){let i=A(t[0]);i<0&&(i+=r.f7);let s=i-t[0],n=t[1];n+=s,!e&&n-i>=r.f7?n=i+r.f7:e&&i-n>=r.f7?n=i-r.f7:!e&&i>n?n=i+(r.f7-A(i-n)):e&&i<n&&(n=i-(r.f7-A(n-i))),t[0]=i,t[1]=n}(M,!!o[6]),G=M[0],Z=M[1];let $=G,Y=Z-G,X=!!(1-!o[6]),K=(a-j)*N/N+j;switch(z){case n.m.M:B=j,P=H,C=B,E=P;break;case n.m.L:if(i){if(b(C,E,j,H,e,a,l))return!0}else T+=(0,s.N0)(C,E,j,H,a,l)||0;C=j,E=H;break;case n.m.C:if(i){if(O=C,I=E,0!==e&&(!(l>I+e)||!(l>H+e)||!(l>V+e)||!(l>U+e))&&(!(l<I-e)||!(l<H-e)||!(l<V-e)||!(l<U-e))&&(!(a>O+e)||!(a>j+e)||!(a>N+e)||!(a>W+e))&&(!(a<O-e)||!(a<j-e)||!(a<N-e)||!(a<W-e))&&function(t,e,i,r,s,n,a,l,o,h,u){let d,c,y,v,b=0,x=.005,S=1/0;p[0]=o,p[1]=h;for(let o=0;o<1;o+=.05)g[0]=_(t,i,s,a,o),g[1]=_(e,r,n,l,o),(y=m(p,g))<S&&(b=o,S=y);S=1/0;for(let o=0;o<32&&!(x<1e-4);o++)d=b-x,c=b+x,g[0]=_(t,i,s,a,d),g[1]=_(e,r,n,l,d),y=m(g,p),d>=0&&y<S?(b=d,S=y):(f[0]=_(t,i,s,a,c),f[1]=_(e,r,n,l,c),v=m(f,p),c<=1&&v<S?(b=c,S=v):x*=.5);return Math.sqrt(S)}(O,I,j,H,N,V,W,U,a,l,0)<=e/2)return!0}else T+=function(t,e,i,r,s,n,a,l,o,h){if(h>e&&h>r&&h>n&&h>l||h<e&&h<r&&h<n&&h<l)return 0;let p=function(t,e,i,r,s,n){let a=r+3*(e-i)-t,l=3*(i-2*e+t),o=3*(e-t),h=t-s,p=l*l-3*a*o,g=l*o-9*a*h,f=o*o-3*l*h,m=0;if(c(p)&&c(g))if(c(l))n[0]=0;else{let t=-o/l;t>=0&&t<=1&&(n[m++]=t)}else{let t=g*g-4*p*f;if(c(t)){let t=g/p,e=-l/a+t,i=-t/2;e>=0&&e<=1&&(n[m++]=e),i>=0&&i<=1&&(n[m++]=i)}else if(t>0){let e=Math.sqrt(t),i=p*l+1.5*a*(-g+e),r=p*l+1.5*a*(-g-e),s=(-l-((i=i<0?-Math.pow(-i,d):Math.pow(i,d))+(r=r<0?-Math.pow(-r,d):Math.pow(r,d))))/(3*a);s>=0&&s<=1&&(n[m++]=s)}else{let t=Math.acos((2*p*l-3*a*g)/(2*Math.sqrt(p*p*p)))/3,e=Math.sqrt(p),i=Math.cos(t),r=(-l-2*e*i)/(3*a),s=(-l+e*(i+u*Math.sin(t)))/(3*a),o=(-l+e*(i-u*Math.sin(t)))/(3*a);r>=0&&r<=1&&(n[m++]=r),s>=0&&s<=1&&(n[m++]=s),o>=0&&o<=1&&(n[m++]=o)}}return m}(e,r,n,l,h,S);if(0===p)return 0;let g=0,f=-1,m=0,y=0;for(let h=0;h<p;h++){let u=S[h],d=0===u||1===u?.5:1;_(t,i,s,a,u)<o||(f<0&&(f=function(t,e,i,r,s){let n=6*i-12*e+6*t,a=9*e+3*r-3*t-9*i,l=3*e-3*t,o=0;if(c(a)){if(n>x||n<-x){let t=-l/n;t>=0&&t<=1&&(s[o++]=t)}}else{let t=n*n-4*a*l;if(c(t))s[0]=-n/(2*a);else if(t>0){let e=Math.sqrt(t),i=(-n+e)/(2*a),r=(-n-e)/(2*a);i>=0&&i<=1&&(s[o++]=i),r>=0&&r<=1&&(s[o++]=r)}}return o}(e,r,n,l,k),k[1]<k[0]&&f>1&&function(){let t=k[0];k[0]=k[1],k[1]=t}(),m=_(e,r,n,l,k[0]),f>1&&(y=_(e,r,n,l,k[1]))),2===f?u<k[0]?g+=m<e?d:-d:u<k[1]?g+=y<m?d:-d:g+=l<y?d:-d:u<k[0]?g+=m<e?d:-d:g+=l<m?d:-d)}return g}(C,E,j,H,N,V,W,U,a,l)||0;C=W,E=U;break;case n.m.Q:if(i){if(R=C,L=E,0!==e&&(!(l>L+e)||!(l>H+e)||!(l>V+e))&&(!(l<L-e)||!(l<H-e)||!(l<V-e))&&(!(a>R+e)||!(a>j+e)||!(a>N+e))&&(!(a<R-e)||!(a<j-e)||!(a<N-e))&&function(t,e,i,r,s,n,a,l,o){let h=0,u=.005,d=1/0;p[0]=a,p[1]=l;for(let a=0;a<1;a+=.05){g[0]=y(t,i,s,a),g[1]=y(e,r,n,a);let l=m(p,g);l<d&&(h=a,d=l)}d=1/0;for(let a=0;a<32&&!(u<1e-4);a++){let a=h-u,l=h+u;g[0]=y(t,i,s,a),g[1]=y(e,r,n,a);let o=m(g,p);if(a>=0&&o<d)h=a,d=o;else{f[0]=y(t,i,s,l),f[1]=y(e,r,n,l);let a=m(f,p);l<=1&&a<d?(h=l,d=a):u*=.5}}return Math.sqrt(d)}(R,L,j,H,N,V,a,l,0)<=e/2)return!0}else T+=function(t,e,i,r,s,n,a,l){if(l>e&&l>r&&l>n||l<e&&l<r&&l<n)return 0;let o=function(t,e,i,r,s){let n=t-2*e+i,a=2*(e-t),l=t-r,o=0;if(c(n)){if(a>x||a<-x){let t=-l/a;t>=0&&t<=1&&(s[o++]=t)}}else{let t=a*a-4*n*l;if(c(t)){let t=-a/(2*n);t>=0&&t<=1&&(s[o++]=t)}else if(t>0){let e=Math.sqrt(t),i=(-a+e)/(2*n),r=(-a-e)/(2*n);i>=0&&i<=1&&(s[o++]=i),r>=0&&r<=1&&(s[o++]=r)}}return o}(e,r,n,l,S);if(0===o)return 0;let h=function(t,e,i){let r=t+i-2*e;return 0===r?.5:(t-e)/r}(e,r,n);if(h>=0&&h<=1){let l=0,u=y(e,r,n,h);for(let r=0;r<o;r++){let o=0===S[r]||1===S[r]?.5:1;y(t,i,s,S[r])<a||(S[r]<h?l+=u<e?o:-o:l+=n<u?o:-o)}return l}let u=0===S[0]||1===S[0]?.5:1;return y(t,i,s,S[0])<a?0:n<e?u:-u}(C,E,j,H,N,V,a,l)||0;C=N,E=V;break;case n.m.A:if(h=Math.cos($)*N+j,w=Math.sin($)*N+H,F?(B=h,P=w):T+=(0,s.N0)(C,E,h,w,a,l),i){if(function(t,e,i,s,n,a,l,o,h){if(0===l)return!1;let u=Math.sqrt((o-=t)*o+(h-=e)*h);if(u-l>i||u+l<i)return!1;if(Math.abs(s-n)%r.f7<1e-4)return!0;if(a){let t=s;s=v(n),n=v(t)}else s=v(s),n=v(n);s>n&&(n+=r.f7);let d=Math.atan2(h,o);return d<0&&(d+=r.f7),d>=s&&d<=n||d+r.f7>=s&&d+r.f7<=n}(j,H,N,$,$+Y,X,e,K,l))return!0}else T+=function(t,e,i,s,n,a,l,o){if((o-=e)>i||o<-i)return 0;let h=Math.sqrt(i*i-o*o);S[0]=-h,S[1]=h;let u=Math.abs(s-n);if(u<1e-4)return 0;if(u>=r.f7-1e-4)return s=0,n=r.f7,l>=S[0]+t&&l<=S[1]+t?a?1:-1:0;if(s>n){let t=s;s=n,n=t}s<0&&(s+=r.f7,n+=r.f7);let d=0;for(let e=0;e<2;e++){let i=S[e];if(i+t>l){let t=Math.atan2(o,i),e=a?1:-1;t<0&&(t=r.f7+t),(t>=s&&t<=n||t+r.f7>=s&&t+r.f7<=n)&&(t>r.pi/2&&t<1.5*r.pi&&(e=-e),d+=e)}}return d}(j,H,N,$,$+Y,X,K,l);C=Math.cos($+Y)*N+j,E=Math.sin($+Y)*N+H;break;case n.m.R:if(B=C=j,P=E=H,h=B+N,w=P+V,i){if(b(B,P,h,P,e,a,l)||b(h,P,h,w,e,a,l)||b(h,w,B,w,e,a,l)||b(B,w,B,P,e,a,l))return!0}else T+=(0,s.N0)(h,P,h,w,a,l),T+=(0,s.N0)(B,w,B,P,a,l);break;case n.m.Z:if(i){if(b(C,E,B,P,e,a,l))return!0}else T+=(0,s.N0)(C,E,B,P,a,l);C=B,E=P}}return i||Math.abs(E-P)<x||(T+=(0,s.N0)(C,E,B,P,a,l)||0),0!==T}function T(t,e,i){return w(t,0,!1,e,i)}function C(t,e,i,r){return w(t,e,!0,i,r)}},58273:function(t,e,i){"use strict";i.d(e,{BM:()=>l,Ib:()=>h});var r=i(43644),s=i(45273),n=i(31535);function a(t,e=!1){return Array.isArray(t)&&(0,s.Z)(t[0])?e?`rgb(${Math.round(t[0])},${Math.round(t[1])},${Math.round(t[2])},${t[3].toFixed(2)})`:`rgb(${Math.round(t[0])},${Math.round(t[1])},${Math.round(t[2])})`:t}function l(t,e,i,r,a){return Array.isArray(t)&&!(0,s.Z)(t[0])||Array.isArray(e)&&!(0,s.Z)(e[0])?[,,,,].fill(0).map((s,a)=>{var l,h;return o((0,n.Z)(t)?null!=(l=t[a])?l:t[0]:t,(0,n.Z)(e)?null!=(h=e[a])?h:e[0]:e,i,r)}):o(t,e,i,r,a)}function o(t,e,i,s,n){if(!t||!e)return t&&a(t)||e&&a(e)||!1;let o,h,u=!1,d=!1;if(Array.isArray(t)?o=t:"string"==typeof t?o=r.VH.Get(t,r.Mr.Color255):u=!0,Array.isArray(e)?h=e:"string"==typeof e?h=r.VH.Get(e,r.Mr.Color255):d=!0,u!==d){let r=u?t:e,o=u?e:t,h=Object.assign(Object.assign({},r),{stops:r.stops.map(t=>Object.assign(Object.assign({},t),{color:a(o)}))});return u?l(r,h,i,s,n):l(h,r,i,s,n)}if(u){if(t.gradient===e.gradient){let r=t.stops,s=e.stops;if(r.length!==s.length)return!1;if("linear"===t.gradient){var p,g,f,m=t,y=e,_=i;let r=m.stops,s=y.stops;return{gradient:"linear",x0:m.x0+(y.x0-m.x0)*_,x1:m.x1+(y.x1-m.x1)*_,y0:m.y0+(y.y0-m.y0)*_,y1:m.y1+(y.y1-m.y1)*_,stops:Array(r.length).fill(0).map((t,e)=>({color:c(r[e].color,s[e].color,_),offset:r[e].offset+(s[e].offset-r[e].offset)*_}))}}if("radial"===t.gradient){var v=t,b=e,x=i;let r=v.stops,s=b.stops;return{gradient:"radial",x0:v.x0+(b.x0-v.x0)*x,x1:v.x1+(b.x1-v.x1)*x,y0:v.y0+(b.y0-v.y0)*x,y1:v.y1+(b.y1-v.y1)*x,r0:v.r0+(b.r0-v.r0)*x,r1:v.r1+(b.r1-v.r1)*x,stops:Array(r.length).fill(0).map((t,e)=>({color:c(r[e].color,s[e].color,x),offset:r[e].offset+(s[e].offset-r[e].offset)*x}))}}if("conical"===t.gradient){var S=t,k=e,A=i;let r=S.stops,s=k.stops;return{gradient:"conical",startAngle:S.startAngle+(k.startAngle-S.startAngle)*A,endAngle:S.endAngle+(k.endAngle-S.endAngle)*A,x:S.x+(k.x-S.x)*A,y:S.y+(k.y-S.y)*A,stops:Array(r.length).fill(0).map((t,e)=>({color:c(r[e].color,s[e].color,A),offset:r[e].offset+(s[e].offset-r[e].offset)*A}))}}}return!1}return n&&n(o,h),a((p=o,g=h,f=i,[p[0]+(g[0]-p[0])*f,p[1]+(g[1]-p[1])*f,p[2]+(g[2]-p[2])*f,p[3]+(g[3]-p[3])*f]),s)}function h(t,e,i){return`rgba(${t[0]+(e[0]-t[0])*i},${t[1]+(e[1]-t[1])*i},${t[2]+(e[2]-t[2])*i},${t[3]+(e[3]-t[3])*i})`}let u=[0,0,0,0],d=[0,0,0,0];function c(t,e,i){return r.VH.Get(t,r.Mr.Color255,u),r.VH.Get(e,r.Mr.Color255,d),`rgba(${Math.round(u[0]+(d[0]-u[0])*i)},${Math.round(u[1]+(d[1]-u[1])*i)},${Math.round(u[2]+(d[2]-u[2])*i)},${u[3]+(d[3]-u[3])*i})`}},43644:function(t,e,i){"use strict";i.d(e,{Mr:()=>s,VH:()=>a});var r,s,n=i(14925);(r=s||(s={}))[r.Color255=0]="Color255",r[r.Color1=1]="Color1";class a{static Get(t,e=s.Color1,i=[0,0,0,1]){if(e===s.Color1){let e=a.store1[t];if(e)return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i;let r=n.Il.parseColorString(t);if(r){let e=[r.r/255,r.g/255,r.b/255,r.opacity];a.store1[t]=e,a.store255[t]=[r.r,r.g,r.b,r.opacity],i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]}return i}let r=a.store255[t];if(r)return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i;let l=n.Il.parseColorString(t);return l&&(a.store1[t]=[l.r/255,l.g/255,l.b/255,l.opacity],a.store255[t]=[l.r,l.g,l.b,l.opacity],i[0]=l.r,i[1]=l.g,i[2]=l.b,i[3]=l.opacity),i}static Set(t,e,i){if(e===s.Color1)a.store1[t]||(a.store1[t]=i,a.store255[t]=[Math.floor(255*i[0]),Math.floor(255*i[1]),Math.floor(255*i[2]),Math.floor(255*i[3])]);else{if(a.store255[t])return;a.store255[t]=i,a.store1[t]=[i[0]/255,i[1]/255,i[2]/255,i[3]]}}}a.store255={},a.store1={}},96141:function(t,e,i){"use strict";i.d(e,{y:()=>n});var r=i(88504),s=i(27177);let n=(t,e,i,n)=>{let a,l=!1,o=!1;if(e.forEachChildren(t=>!(l=t.numberType===s.IJ)),e.forEachChildren(t=>!(o=!!t.findFace)),l){let t=e.getChildren(),s=[...t];s.sort((t,e)=>{var i,s,n,a;let l=(null!=(s=null!=(i=t.attribute.startAngle)?i:0+t.attribute.endAngle)?s:0)/2,o=(null!=(a=null!=(n=e.attribute.startAngle)?n:0+e.attribute.endAngle)?a:0)/2;for(;l<0;)l+=r.f7;for(;o<0;)o+=r.f7;return o-l}),s.forEach(t=>{t._next=null,t._prev=null}),e.removeAllChild(),e.update(),s.forEach(t=>{e.appendChild(t)}),n.hack_pieFace="outside",(a=i(l,o))&&a.graphic||(n.hack_pieFace="inside",a=i(l,o)),a&&a.graphic||(n.hack_pieFace="top",a=i(l,o)),e.removeAllChild(),t.forEach(t=>{t._next=null,t._prev=null}),t.forEach(t=>{e.appendChild(t)})}else if(o){let r=e.getChildren(),s=r.map(e=>({ave_z:e.findFace().vertices.map(i=>{var r;return t.view(i[0],i[1],null!=(r=i[2]+e.attribute.z)?r:0)[2]}).reduce((t,e)=>t+e,0),g:e}));s.sort((t,e)=>e.ave_z-t.ave_z),e.removeAllChild(),s.forEach(t=>{t.g._next=null,t.g._prev=null}),e.update(),s.forEach(t=>{e.add(t.g)}),a=i(l,o),e.removeAllChild(),r.forEach(t=>{t._next=null,t._prev=null}),e.update(),r.forEach(t=>{e.add(t)})}else a=i(l,o);return a}},59064:function(t,e,i){"use strict";var r,s;i.d(e,{Z:()=>n});let n=(r={},function(t){Object.prototype.hasOwnProperty;let e="function"==typeof Symbol,i=e&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=(e&&void 0!==Symbol.iterator&&Symbol.iterator,Object.create,Object.getPrototypeOf(Function)),s=("object"==typeof process&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL,Map),n=new WeakMap;function a(t,e,i){let r=n.get(t);if(o(r)){if(!i)return;r=new s,n.set(t,r)}let a=r.get(e);if(o(a)){if(!i)return;a=new s,r.set(e,a)}return a}function l(t,e,i){let r=a(e,i,!1);return!o(r)&&!!r.has(t)}function o(t){return void 0===t}function h(t){return null===t}function u(t){return"object"==typeof t?null!==t:"function"==typeof t}function d(t){let e=function(t,e){switch(function(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}let r="string",s=function(t,e){let i=t[e];if(null!=i){if(!c(i))throw TypeError();return i}}(t,i);if(void 0!==s){let e=s.call(t,r);if(u(e))throw TypeError();return e}return function(t,e){if("string"===e){let e=t.toString;if(c(e)){let i=e.call(t);if(!u(i))return i}let i=t.valueOf;if(c(i)){let e=i.call(t);if(!u(e))return e}}else{let e=t.valueOf;if(c(e)){let i=e.call(t);if(!u(i))return i}let i=t.toString;if(c(i)){let e=i.call(t);if(!u(e))return e}}throw TypeError()}(t,r)}(t,0);return"symbol"==typeof e?e:""+e}function c(t){return"function"==typeof t}function p(t){let e=Object.getPrototypeOf(t);if("function"!=typeof t||t===r||e!==r)return e;let i=t.prototype,s=i&&Object.getPrototypeOf(i);if(null==s||s===Object.prototype)return e;let n=s.constructor;return"function"!=typeof n||n===t?e:n}t("defineMetadata",function(t,e,i,r){var s,n;if(!u(i))throw TypeError();return s=t,n=e,void a(i,r,!0).set(s,n)}),t("hasMetadata",function(t,e,i){if(!u(e))throw TypeError();return o(i)||(i=d(i)),function t(e,i,r){if(l(e,i,r))return!0;let s=p(i);return null!==s&&t(e,s,r)}(t,e,i)}),t("hasOwnMetadata",function(t,e,i){if(!u(e))throw TypeError();return o(i)||(i=d(i)),l(t,e,i)}),t("getMetadata",function(t,e,i){if(!u(e))throw TypeError();return o(i)||(i=d(i)),function t(e,i,r){if(l(e,i,r)){var s=e,n=i,h=r;let t=a(n,h,!1);return o(t)?void 0:t.get(s)}let u=p(i);return null===u?void 0:t(e,u,r)}(t,e,i)})}(function(t,e){"function"!=typeof r[t]&&Object.defineProperty(r,t,{configurable:!0,writable:!0,value:e}),s&&s(t,e)}),r)},83917:function(t,e,i){"use strict";i.d(e,{Ci:()=>n,P:()=>l,Pv:()=>h,hN:()=>u});var r=i(41457);function s(t,e){let i=0,s=t.length;for(let n=0;n<s;n++){let a=t[n],l=e[n],o=t[(n+1)%s],h=e[(n+1)%s];i+=r.HL.distanceNN(a,l,o,h)}return i/2}function n(t,e,i,r,n){return s([t.x,e.x,i.x,r.x],[t.y,e.y,i.y,r.y])}function a(t,e,i,r,s){let n=1-s;return n*n*n*t+3*e*s*n*n+3*i*s*s*n+r*s*s*s}function l(t,e,i,s,n){let l=a(t.x,e.x,i.x,s.x,n),o=a(t.y,e.y,i.y,s.y,n);return new r.E9(l,o)}function o(t,e,i,r){let s=1-r;return s*s*t+2*s*r*e+r*r*i}function h(t,e,i,s){let n=o(t.x,e.x,i.x,s),a=o(t.y,e.y,i.y,s);return new r.E9(n,a)}function u(t,e,i,r){return s([t.x,e.x,i.x],[t.y,e.y,i.y])}},14535:function(t,e,i){"use strict";i.d(e,{C:()=>n});var r=i(88504);let s=r.BZ-1e-8;class n{constructor(t){this.init(t)}init(t){this.bounds=t}arc(t,e,i,n,a,l){if(Math.abs(a-n)>s)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);let o,h,u,d,c=1/0,p=-1/0,g=1/0,f=-1/0;function m(t){u=i*Math.cos(t),d=i*Math.sin(t),u<c&&(c=u),u>p&&(p=u),d<g&&(g=d),d>f&&(f=d)}if(m(n),m(a),a!==n)if((n%=r.BZ)<0&&(n+=r.BZ),(a%=r.BZ)<0&&(a+=r.BZ),a<n&&(l=!l,o=n,n=a,a=o),l)for(a-=r.BZ,o=n-n%r.ou,h=0;h<4&&o>a;++h,o-=r.ou)m(o);else for(o=n-n%r.ou+r.ou,h=0;h<4&&o<a;++h,o+=r.ou)m(o);this.bounds.add(t+c,e+g),this.bounds.add(t+p,e+f)}arcTo(t,e,i,r,s){this.bounds.add(t,e)}bezierCurveTo(t,e,i,r,s,n){this.bounds.add(t,e),this.bounds.add(i,r),this.bounds.add(s,n)}closePath(){}ellipse(){throw Error("不支持ellipse")}lineTo(t,e){this.bounds.add(t,e)}moveTo(t,e){this.bounds.add(t,e)}quadraticCurveTo(t,e,i,r){this.bounds.add(t,e),this.bounds.add(i,r)}rect(t,e,i,r){this.bounds.add(t,e),this.bounds.add(t+i,e+r)}clear(){this.bounds.clear()}release(...t){}}},29436:function(t,e,i){"use strict";i.d(e,{D:()=>l,L:()=>o});var r=i(31535),s=i(88504);let n=function(){let t={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i},e="";function i(t){let i=Error(e+": "+t);throw i.source=e,i}function r(){return s("linear",t.linearGradient,n)||s("radial",t.radialGradient,l)||s("conic",t.conicGradient,a)}function s(e,r,s){let n=y(r);if(n){y(t.startCall)||i("Missing (");let r=function(r){let n=s();return n&&(y(t.comma)||i("Missing comma before color stops")),{type:e,orientation:n,colorStops:c(p)}}(0);return y(t.endCall)||i("Missing )"),r}}function n(){return m("directional",t.sideOrCorner,1)||m("angular",t.angleValue,1)}function a(){return m("angular",t.fromAngleValue,1)}function l(){let i,r,s=o();return s&&((i=[]).push(s),r=e,y(t.comma)&&((s=o())?i.push(s):e=r)),i}function o(){let t=function(){let t=m("shape",/^(circle)/i,0);return t&&(t.style=f()||h()),t}()||function(){let t=m("shape",/^(ellipse)/i,0);return t&&(t.style=g()||h()),t}();if(t)t.at=u();else{let e=h();if(e){t=e;let i=u();i&&(t.at=i)}else{let e=d();e&&(t={type:"default-radial",at:e})}}return t}function h(){return m("extent-keyword",t.extentKeywords,1)}function u(){if(m("position",/^at/,0)){let t=d();return t||i("Missing positioning value"),t}}function d(){let t={x:g(),y:g()};if(t.x||t.y)return{type:"position",value:t}}function c(e){let r=e(),s=[];if(r)for(s.push(r);y(t.comma);)(r=e())?s.push(r):i("One extra comma");return s}function p(){let e=m("hex",t.hexColor,1)||m("rgba",t.rgbaColor,1)||m("rgb",t.rgbColor,1)||m("literal",t.literalColor,0);return e||i("Expected color definition"),e.length=g(),e}function g(){return m("%",t.percentageValue,1)||m("position-keyword",t.positionKeywords,1)||f()}function f(){return m("px",t.pixelValue,1)||m("em",t.emValue,1)}function m(t,e,i){let r=y(e);if(r)return{type:t,value:r[i]}}function y(t){let i=/^[\n\r\t\s]+/.exec(e);i&&_(i[0].length);let r=t.exec(e);return r&&_(r[0].length),r}function _(t){e=e.substr(t)}return function(t){return e=t.toString(),function(){let t=c(r);return e.length>0&&i("Invalid input not EOF"),t}()}}();class a{static IsGradient(t){return!("string"==typeof t&&!t.includes("gradient"))}static IsGradientStr(t){return"string"==typeof t&&t.includes("gradient")}static Parse(t){if(a.IsGradientStr(t))try{let e=n(t)[0];if(e){if("linear"===e.type)return a.ParseLinear(e);if("radial"===e.type)return a.ParseRadial(e);if("conic"===e.type)return a.ParseConic(e)}}catch(t){}return t}static ParseConic(t){let{orientation:e,colorStops:i=[]}=t,r=s.pi/2,n=parseFloat(e.value)/180*s.pi-r;return{gradient:"conical",x:.5,y:.5,startAngle:n,endAngle:n+s.f7,stops:i.map(t=>({color:t.value,offset:parseFloat(t.length.value)/100}))}}static ParseRadial(t){let{colorStops:e=[]}=t;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:e.map(t=>({color:t.value,offset:parseFloat(t.length.value)/100}))}}static ParseLinear(t){let{orientation:e,colorStops:i=[]}=t,r=s.pi/2,n="angular"===e.type?parseFloat(e.value)/180*s.pi:0;for(;n<0;)n+=s.f7;for(;n>=s.f7;)n-=s.f7;let a=0,l=0,o=0,h=0;return n<r?(a=0,l=1,o=Math.sin(n),h=l-Math.cos(n)):n<s.pi?(a=0,l=0,o=Math.cos(n-r),h=Math.sin(n-r)):n<s.pi+r?(l=0,o=(a=1)-Math.sin(n-s.pi),h=Math.cos(n-s.pi)):(o=(a=1)-Math.cos(n-r-s.pi),h-=Math.sin(n-r-s.pi)),{gradient:"linear",x0:a,y0:l,x1:o,y1:h,stops:i.map(t=>({color:t.value,offset:parseFloat(t.length.value)/100}))}}}function l(t,e,i){let r=e,{a:s,b:n,c:a,d:l}=t.currentMatrix,o=Math.sign(s)*Math.sqrt(s*s+n*n),h=Math.sign(l)*Math.sqrt(a*a+l*l);return o+h===0?0:r=r/Math.abs(o+h)*2*i}function o(t,e,i,s=0,n=0){var l,h,u,d;let c,p;if(!e||!0===e)return"black";if((0,r.Z)(e))for(let t=0;t<e.length&&!(p=e[t]);t++);else p=e;if("string"==typeof(p=a.Parse(p)))return p;if(i.AABBBounds&&(!i.attribute||0!==i.attribute.scaleX||0!==i.attribute.scaleY)){let e=i.AABBBounds,r=e.x2-e.x1,a=e.y2-e.y1,o=e.x1-s,g=e.y1-n;if(i.attribute){let{scaleX:t=1,scaleY:e=1,angle:s=0}=i.attribute;r/=t,a/=e,o/=t,g/=e,(s||1!==t||1!==e)&&(o=null!=(l=i.x1WithoutTransform)?l:0,g=null!=(h=i.y1WithoutTransform)?h:0,r=null!=(u=i.widthWithoutTransform)?u:r,a=null!=(d=i.heightWithoutTransform)?d:a)}"linear"===p.gradient?c=function(t,e,i,r,s,n){var a,l,o,h;let u=t.createLinearGradient(i+(null!=(a=e.x0)?a:0)*s,r+(null!=(l=e.y0)?l:0)*n,i+(null!=(o=e.x1)?o:1)*s,r+(null!=(h=e.y1)?h:0)*n);return e.stops.forEach(t=>{u.addColorStop(t.offset,t.color)}),u}(t,p,o,g,r,a):"conical"===p.gradient?c=function(t,e,i,r,s,n){var a,l;let o=t.createConicGradient(i+(null!=(a=e.x)?a:0)*s,r+(null!=(l=e.y)?l:0)*n,e.startAngle,e.endAngle);return e.stops.forEach(t=>{o.addColorStop(t.offset,t.color)}),o.GetPattern?o.GetPattern(s+i,n+r,void 0):o}(t,p,o,g,r,a):"radial"===p.gradient&&(c=function(t,e,i,r,s,n){var a,l,o,h,u,d;let c=t.createRadialGradient(i+(null!=(a=e.x0)?a:.5)*s,r+(null!=(l=e.y0)?l:.5)*n,Math.max(s,n)*(null!=(o=e.r0)?o:0),i+(null!=(h=e.x1)?h:.5)*s,r+(null!=(u=e.y1)?u:.5)*n,Math.max(s,n)*(null!=(d=e.r1)?d:.5));return e.stops.forEach(t=>{c.addColorStop(t.offset,t.color)}),c}(t,p,o,g,r,a))}return c||"orange"}},73209:function(t,e,i){"use strict";i.d(e,{EM:()=>a,Qc:()=>r,yb:()=>n});let r=Symbol("ContributionProvider");class s{constructor(t,e){this.serviceIdentifier=t,this.container=e,l.setStore(this.serviceIdentifier,this)}getContributions(){return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier))),this.caches}refresh(){this.caches&&(this.caches.length=0,this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier)))}}function n(t,e){t(r).toDynamicValue(({container:t})=>new s(e,t)).inSingletonScope().whenTargetNamed(e)}function a(t,e){t(r).toDynamicValue(({container:t})=>new s(e,t)).whenTargetNamed(e)}class l{static getStore(t){return this.store.get(t)}static setStore(t,e){this.store.set(t,e)}static refreshAllContributions(){this.store.forEach(t=>{t.refresh()})}}l.store=new Map},78388:function(t,e,i){"use strict";i.d(e,{r:()=>x});var r=i(14535),s=i(76620);class n{constructor(){this._curves=[],this.bounds=new s.FB}get curves(){return this._curves}getCurveLengths(){return this._curves.map(t=>t.getLength())}getPointAt(t){return{x:0,y:0}}getLength(){return 0}getBounds(){return this.bounds}}var a=i(78591),l=i(88504),o=i(33760),h=i(98706);function u(t,e,i,r){let s=function(t,e,i,r,s,n,a,o,u){let d=(0,h.M4)(a),c=Math.sin(d),p=Math.cos(d),g=p*(o-t)*.5+c*(u-e)*.5,f=p*(u-e)*.5-c*(o-t)*.5,m=g*g/((i=Math.abs(i))*i)+f*f/((r=Math.abs(r))*r);m>1&&(i*=m=Math.sqrt(m),r*=m);let y=p/i,_=c/i,v=-c/r,b=p/r,x=y*o+_*u,S=v*o+b*u,k=y*t+_*e,A=v*t+b*e,M=1/((k-x)*(k-x)+(A-S)*(A-S))-.25;M<0&&(M=0);let w=Math.sqrt(M);n===s&&(w=-w);let T=.5*(x+k)-w*(A-S),C=.5*(S+A)+w*(k-x),E=Math.atan2(S-C,x-T),B=Math.atan2(A-C,k-T)-E;B<0&&1===n?B+=l.BZ:B>0&&0===n&&(B-=l.BZ);let P=Math.ceil(Math.abs(B/(l.ou+.001))),O=[];for(let t=0;t<P;++t){let e=E+t*B/P,s=E+(t+1)*B/P;O[t]=[T,C,e,s,i,r,c,p]}return O}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,i);for(let e=0;e<s.length;++e){let i=function(t){let e=t[0],i=t[1],r=t[2],s=t[3],n=t[4],a=t[5],l=t[6],o=t[7],h=o*n,u=-l*a,d=l*n,c=o*a,p=Math.cos(r),g=Math.sin(r),f=Math.cos(s),m=Math.sin(s),y=.5*(s-r),_=Math.sin(.5*y),v=8/3*_*_/Math.sin(y),b=e+p-v*g,x=i+g+v*p,S=e+f,k=i+m,A=S+v*m,M=k-v*f;return[h*b+u*x,d*b+c*x,h*A+u*M,d*A+c*M,h*S+u*k,d*S+c*k]}(s[e]);t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5])}}let d=(t,e,i,r,s,n,a,l=!1)=>{let o=2*Math.PI,h=(e%o+o)%o,u,d=(i%o+o)%o;l?d>=h&&(d-=o):d<=h&&(d+=o);let c=Math.ceil(Math.abs(u=d-h)/(.5*Math.PI)),p=u/c;for(let e=0;e<c;e++){let i=h+p*e,o=h+p*(e+1),u=4/3*Math.tan(Math.abs(p)/4),d=Math.cos(i),c=Math.sin(i),g=Math.cos(o),f=Math.sin(o),m=d*n+r,y=c*a+s,_=g*n+r,v=f*a+s,b=l?-1:1,x=n*u*b,S=a*u*b;t.push(m-x*c,y+S*d,_+x*f,v-S*g,_,v)}};var c=i(60027),p=i(41457),g=i(58757),f=i(60452),m=i(83917),y=i(34318);class _ extends y.H{constructor(t,e,i){super(),this.type=o.D5.QuadraticBezierCurve,this.p0=t,this.p1=e,this.p2=i}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y)}getPointAt(t){if(!1!==this.defined)return(0,m.Pv)(this.p0,this.p1,this.p2,t);throw Error("defined为false的点不能getPointAt")}calcLength(){return this._validPoint()?(0,m.hN)(this.p0,this.p1,this.p2,0):60}calcProjLength(t){return t===o.Nm.ROW?(0,l.Wn)(this.p0.x-this.p2.x):t===o.Nm.COLUMN?(0,l.Wn)(this.p0.y-this.p2.y):0}getAngleAt(t){let e=(0,l.Fp)(t-.01,0),i=(0,l.VV)(t+.01,1),r=this.getPointAt(e),s=this.getPointAt(i);return(0,l.fv)(s.y-r.y,s.x-r.x)}draw(t,e,i,r,s,n){if(t.moveTo(this.p0.x*r+e,this.p0.y*s+i),n>=1)t.quadraticCurveTo(this.p1.x*r+e,this.p1.y*s+i,this.p2.x*r+e,this.p2.y*s+i);else if(n>0){let[a]=function(t,e){let{p0:i,p1:r,p2:s}=t,n=(0,m.Pv)(i,r,s,e),a=p.HL.pointAtPP(i,r,e),l=p.HL.pointAtPP(r,s,e);return[new _(i,a,n),new _(n,l,s)]}(this,n);t.quadraticCurveTo(a.p1.x*r+e,a.p1.y*s+i,a.p2.x*r+e,a.p2.y*s+i)}}getYAt(t){throw Error("QuadraticBezierCurve暂不支持getYAt")}includeX(t){throw Error("QuadraticBezierCurve暂不支持includeX")}}class v{constructor(t){this.path=t,this._lastX=this._lastY=this._startX=this._startY=0}moveTo(t,e){return this._lastX=this._startX=t,this._lastY=this._startY=e,this}lineTo(t,e){let i=this.addLinearCurve(t,e);this.path.addCurve(i),this._lastX=t,this._lastY=e}addLinearCurve(t,e){return new g.g(new p.E9(this._lastX,this._lastY),new p.E9(t,e))}quadraticCurveTo(t,e,i,r){let s=new _(new p.E9(this._lastX,this._lastY),new p.E9(t,e),new p.E9(i,r));this.path.addCurve(s),this._lastX=i,this._lastY=r}bezierCurveTo(t,e,i,r,s,n){let a=new f.A(new p.E9(this._lastX,this._lastY),new p.E9(t,e),new p.E9(i,r),new p.E9(s,n));this.path.addCurve(a),this._lastX=s,this._lastY=n}arcTo(t,e,i,r,s){throw Error("CurveContext不支持调用arcTo")}ellipse(t,e,i,r,s,n,a,l){throw Error("CurveContext不支持调用ellipse")}rect(t,e,i,r){throw Error("CurveContext不支持调用rect")}arc(t,e,i,r,s,n){throw Error("CurveContext不支持调用arc")}closePath(){this.path.curves.length<2||this.lineTo(this._startX,this._startY)}}var b=i(83962);class x extends n{constructor(t){super(),this.commandList=[],t&&(this._ctx=t),this._boundsContext=new r.C(this.bounds)}get curves(){return this.tryBuildCurves()}setCtx(t){this._ctx=t}moveTo(t,e){return this.commandList.push([a.m.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}lineTo(t,e){return this.commandList.push([a.m.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}quadraticCurveTo(t,e,i,r){return this.commandList.push([a.m.Q,t,e,i,r]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,r),this}bezierCurveTo(t,e,i,r,s,n){return this.commandList.push([a.m.C,t,e,i,r,s,n]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,r,s,n),this}arcTo(t,e,i,r,s){return this.commandList.push([a.m.AT,t,e,i,r,s]),this._ctx&&this._ctx.arcTo(t,e,i,r,s),this}ellipse(t,e,i,r,s,n,l,o){return this.commandList.push([a.m.E,t,e,i,r,s,n,l,o]),this._ctx&&this._ctx.ellipse(t,e,i,r,s,n,l,o),this}rect(t,e,i,r){return this.commandList.push([a.m.R,t,e,i,r]),this._ctx&&this._ctx.rect(t,e,i,r),this}arc(t,e,i,r,s,n){return this.commandList.push([a.m.A,t,e,i,r,s,n]),this._ctx&&this._ctx.arc(t,e,i,r,s,n),this}closePath(){return this.commandList.push([a.m.Z]),this._ctx&&this._ctx.closePath(),this}addCurve(t){this._curves.push(t)}clear(){this.transformCbList=null,this.commandList.length=0,this._curves.length=0}beginPath(){this.clear()}tryBuildCurves(){if(!this._curves||!this._curves.length){let t=new v(this);(0,c.h)(this.commandList,t,0,0,1,1)}return this._curves}toString(){if(!this.toStringCbList){let t=[];t[a.m.M]=t=>`M${t[1]} ${t[2]}`,t[a.m.L]=t=>`L${t[1]} ${t[2]}`,t[a.m.Q]=t=>`Q${t[1]} ${t[2]} ${t[3]} ${t[4]}`,t[a.m.C]=t=>`C${t[1]} ${t[2]} ${t[3]} ${t[4]} ${t[5]} ${t[6]}`,t[a.m.A]=t=>{let e=[],i=t[1],r=t[2],s=t[3],n=t[4];d(e,n,t[5],i,r,s,s,t[6]);let a="";for(let t=0;t<e.length;t+=6)a+=`C${e[t]} ${e[t+1]} ${e[t+2]} ${e[t+3]} ${e[t+4]} ${e[t+5]}`;return a},t[a.m.R]=t=>`M${t[1]} ${t[2]} h${t[3]} v${t[4]} H${t[1]}Z`,t[a.m.Z]=t=>"Z",this.toStringCbList=t}let t=this.toStringCbList,e="";return this.commandList.forEach(i=>{e+=t[i[0]](i)}),e}fromString(t,e,i,r,s){this.clear();let n=(0,a.U)(t);return this._runCommandStrList(n,e,i,r,s),this._updateBounds(),this}fromLine(t){let{points:e,curveType:i,clipRangeByDimension:r}=t.attribute;if(!e)return;let s=(0,b.X0)(e,i);"x"===r?this.direction=o.Nm.ROW:"y"===r?this.direction=o.Nm.COLUMN:"auto"===r&&(this.direction=s.direction),this._curves=s.curves}fromCustomPath2D(t,e,i,r,s){return this.clear(),this._runCommandList(t.commandList,e,i,r,s),this._updateBounds(),this}transform(t,e,i,r){let s=this.commandList;if(!this.transformCbList){let t=[];t[a.m.M]=this.moveToTransform,t[a.m.L]=this.lineToTransform,t[a.m.Q]=this.quadraticCurveToTransform,t[a.m.C]=this.bezierCurveToTransform,t[a.m.AT]=this.arcToTransform,t[a.m.E]=this.ellipseTransform,t[a.m.R]=this.rectTransform,t[a.m.A]=this.arcTransform,t[a.m.Z]=this.closePathTransform,this.transformCbList=t}s.forEach(s=>{this.transformCbList[s[0]](s,t,e,i,r)}),this._updateBounds()}moveToTransform(t,e,i,r,s){t[1]=t[1]*r+e,t[2]=t[2]*s+i}lineToTransform(t,e,i,r,s){t[1]=t[1]*r+e,t[2]=t[2]*s+i}quadraticCurveToTransform(t,e,i,r,s){t[1]=t[1]*r+e,t[2]=t[2]*s+i,t[3]=t[3]*r+e,t[4]=t[4]*s+i}bezierCurveToTransform(t,e,i,r,s){t[1]=t[1]*r+e,t[2]=t[2]*s+i,t[3]=t[3]*r+e,t[4]=t[4]*s+i,t[5]=t[5]*r+e,t[6]=t[6]*s+i}arcToTransform(t,e,i,r,s){t[1]=t[1]*r+e,t[2]=t[2]*s+i,t[3]=t[3]*r+e,t[4]=t[4]*s+i,t[5]=t[5]*(r+s)/2}ellipseTransform(t,e,i,r,s){t[1]=t[1]*r+e,t[2]=t[2]*s+i,t[3]=t[3]*r,t[4]=t[4]*s}rectTransform(t,e,i,r,s){t[1]=t[1]*r+e,t[2]=t[2]*s+i,t[3]=t[3]*r,t[4]=t[4]*s}arcTransform(t,e,i,r,s){t[1]=t[1]*r+e,t[2]=t[2]*s+i,t[3]=t[3]*(r+s)/2}closePathTransform(){}_runCommandStrList(t,e=0,i=0,r=1,s=1){let n,a,l,o,h,d=null,c=0,p=0,g=0,f=0;for(let m=0,y=t.length;m<y;++m){switch(n=t[m],1===r&&1===s||(n=function(t,e,i){let r=S[0]=t[0];if("a"===r||"A"===r)S[1]=e*t[1],S[2]=i*t[2],S[3]=t[3],S[4]=t[4],S[5]=t[5],S[6]=e*t[6],S[7]=i*t[7];else if("h"===r||"H"===r)S[1]=e*t[1];else if("v"===r||"V"===r)S[1]=i*t[1];else for(let r=1,s=t.length;r<s;++r)S[r]=(r%2==1?e:i)*t[r];return S}(n,r,s)),n[0]){case"l":c+=n[1],p+=n[2],this.lineTo(c+e,p+i);break;case"L":c=n[1],p=n[2],this.lineTo(c+e,p+i);break;case"h":c+=n[1],this.lineTo(c+e,p+i);break;case"H":c=n[1],this.lineTo(c+e,p+i);break;case"v":p+=n[1],this.lineTo(c+e,p+i);break;case"V":p=n[1],this.lineTo(c+e,p+i);break;case"m":c+=n[1],p+=n[2],this.moveTo(c+e,p+i);break;case"M":c=n[1],p=n[2],this.moveTo(c+e,p+i);break;case"c":a=c+n[5],l=p+n[6],g=c+n[3],f=p+n[4],this.bezierCurveTo(c+n[1]+e,p+n[2]+i,g+e,f+i,a+e,l+i),c=a,p=l;break;case"C":c=n[5],p=n[6],g=n[3],f=n[4],this.bezierCurveTo(n[1]+e,n[2]+i,g+e,f+i,c+e,p+i);break;case"s":a=c+n[3],l=p+n[4],null===d[0].match(/[CcSs]/)?(g=c,f=p):(g=2*c-g,f=2*p-f),o=c+n[1],h=p+n[2],this.bezierCurveTo(g+e,f+i,o+e,h+i,a+e,l+i),g=o,f=h,c=a,p=l;break;case"S":a=n[3],l=n[4],null===d[0].match(/[CcSs]/)?(g=c,f=p):(g=2*c-g,f=2*p-f),o=n[1],h=n[2],this.bezierCurveTo(g+e,f+i,o+e,h+i,a+e,l+i),g=o,f=h,c=a,p=l;break;case"q":a=c+n[3],l=p+n[4],g=c+n[1],f=p+n[2],this.quadraticCurveTo(g+e,f+i,a+e,l+i),c=a,p=l;break;case"Q":a=n[3],l=n[4],this.quadraticCurveTo(n[1]+e,n[2]+i,a+e,l+i),c=a,p=l,g=n[1],f=n[2];break;case"t":a=c+n[1],l=p+n[2],null===d[0].match(/[QqTt]/)?(g=c,f=p):"t"===d[0]?(g=2*c-o,f=2*p-h):"q"===d[0]&&(g=2*c-g,f=2*p-f),o=g,h=f,this.quadraticCurveTo(g+e,f+i,a+e,l+i),c=a,p=l,g=c+n[1],f=p+n[2];break;case"T":a=n[1],l=n[2],g=2*c-g,f=2*p-f,this.quadraticCurveTo(g+e,f+i,a+e,l+i),c=a,p=l;break;case"a":u(this,c+e,p+i,[n[1],n[2],n[3],n[4],n[5],n[6]+c+e,n[7]+p+i]),c+=n[6],p+=n[7];break;case"A":u(this,c+e,p+i,[n[1],n[2],n[3],n[4],n[5],n[6]+e,n[7]+i]),c=n[6],p=n[7];break;case"z":case"Z":this.closePath()}d=n}}_runCommandList(t,e=0,i=0,r=1,s=1){if(0!==e||0!==i||1!==r||1!==s)for(let n=0,l=t.length;n<l;++n){let l=t[n].slice();switch(l[0]){case a.m.L:this.lineToTransform(l,e,i,r,s);break;case a.m.M:this.moveToTransform(l,e,i,r,s);break;case a.m.C:this.bezierCurveToTransform(l,e,i,r,s);break;case a.m.Q:this.quadraticCurveToTransform(l,e,i,r,s);break;case a.m.A:this.arcToTransform(l,e,i,r,s);break;case a.m.E:this.ellipseTransform(l,e,i,r,s);break;case a.m.R:this.rectTransform(l,e,i,r,s);break;case a.m.AT:this.arcToTransform(l,e,i,r,s);break;case a.m.Z:this.closePath()}}else this.commandList=t.map(t=>t.slice())}_updateBounds(){this.bounds.clear(),(0,c.h)(this.commandList,this._boundsContext)}release(){this.commandList=[],this._boundsContext=null,this._ctx=null}getLength(){if(this.direction===o.Nm.COLUMN){if(!this._curves.length)return 0;let t=this._curves[0],e=this._curves[this._curves.length-1];return(0,l.Wn)(t.p0.y-e.p1.y)}if(this.direction===o.Nm.ROW){if(!this._curves.length)return 0;let t=this._curves[0],e=this._curves[this._curves.length-1];return(0,l.Wn)(t.p0.x-e.p1.x)}return this._curves.reduce((t,e)=>t+e.getLength(),0)}getYAt(t){if(!this.curves)return 1/0;for(let e=0;e<this.curves.length;e++){let i=this.curves[e];if(i.includeX(t))return i.getYAt(t)}return 1/0}getAttrAt(t){if(!this._curves)return{pos:{x:0,y:0},angle:0};let e,i=0;for(let r=0;r<this._curves.length;r++){let s=(e=this._curves[r]).getLength(this.direction);if(i+s>=t)break;i+=s}let r=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(r),angle:e.getAngleAt(r)}}drawWithClipRange(t,e,i,r,s){this.tryBuildCurves();let n=this.getLength()*s,a=0;for(let s=0;s<this._curves.length;s++){let l=this._curves[s],o=l.getLength(this.direction);if(!(a+o<=n)){let s=1-(a+o-n)/o;l.draw(t,i,r,e,e,s);break}l.draw(t,i,r,e,e,1),a+=o}}}let S=["l",0,0,0,0,0,0,0]},33760:function(t,e,i){"use strict";var r,s,n,a,l,o,h,u,d,c,p,g;i.d(e,{D5:()=>l,Gk:()=>n,Gz:()=>r,LZ:()=>s,Nm:()=>a,Oh:()=>o}),(h=r||(r={}))[h.NONE=0]="NONE",h[h.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",h[h.UPDATE_SHAPE=2]="UPDATE_SHAPE",h[h.CLEAR_SHAPE=253]="CLEAR_SHAPE",h[h.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",h[h.INIT=179]="INIT",h[h.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",h[h.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",h[h.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",h[h.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",h[h.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",h[h.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",h[h.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",h[h.CLEAR_LAYOUT=127]="CLEAR_LAYOUT",(u=s||(s={}))[u.GLOBAL=1]="GLOBAL",u[u.LOCAL=16]="LOCAL",u[u.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",u[u.LOCAL_ACCURATE=48]="LOCAL_ACCURATE",(d=n||(n={}))[d.INIT=0]="INIT",d[d.DEFAULT=1]="DEFAULT",d[d.STATE=2]="STATE",d[d.ANIMATE_BIND=10]="ANIMATE_BIND",d[d.ANIMATE_PLAY=11]="ANIMATE_PLAY",d[d.ANIMATE_START=12]="ANIMATE_START",d[d.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",d[d.ANIMATE_END=14]="ANIMATE_END",d[d.TRANSLATE=20]="TRANSLATE",d[d.TRANSLATE_TO=21]="TRANSLATE_TO",d[d.SCALE=22]="SCALE",d[d.SCALE_TO=23]="SCALE_TO",d[d.ROTATE=24]="ROTATE",d[d.ROTATE_TO=25]="ROTATE_TO",(c=a||(a={}))[c.ROW=1]="ROW",c[c.COLUMN=2]="COLUMN",(p=l||(l={}))[p.CubicBezierCurve=0]="CubicBezierCurve",p[p.QuadraticBezierCurve=1]="QuadraticBezierCurve",p[p.ArcCurve=2]="ArcCurve",p[p.LineCurve=3]="LineCurve",p[p.EllipseCurve=4]="EllipseCurve",p[p.MoveCurve=5]="MoveCurve",(g=o||(o={}))[g.beforeFillStroke=0]="beforeFillStroke",g[g.afterFillStroke=1]="afterFillStroke"},65323:function(t,e,i){"use strict";i.d(e,{w:()=>r});class r{constructor(){this._listenerMap=new Map,this._eventListenerTransformer=t=>t}setEventListenerTransformer(t){this._eventListenerTransformer=t||(t=>t)}addEventListener(t,e,i){if(!e)return;let r=t=>{let i=this._eventListenerTransformer(t);"function"==typeof e?e(i):e.handleEvent&&e.handleEvent(i)};this._listenerMap.has(t)||this._listenerMap.set(t,new Map),this._listenerMap.get(t).set(e,r),this._nativeAddEventListener(t,r,i)}removeEventListener(t,e,i){var r;if(!e)return;let s=null==(r=this._listenerMap.get(t))?void 0:r.get(e);s&&(this._nativeRemoveEventListener(t,s,i),this._listenerMap.get(t).delete(e),0===this._listenerMap.get(t).size&&this._listenerMap.delete(t))}dispatchEvent(t){return this._nativeDispatchEvent(t)}clearAllEventListeners(){this._listenerMap.forEach((t,e)=>{t.forEach((t,i)=>{this._nativeRemoveEventListener(e,t,void 0)})}),this._listenerMap.clear()}_nativeAddEventListener(t,e,i){throw Error("_nativeAddEventListener must be implemented by derived classes")}_nativeRemoveEventListener(t,e,i){throw Error("_nativeRemoveEventListener must be implemented by derived classes")}_nativeDispatchEvent(t){throw Error("_nativeDispatchEvent must be implemented by derived classes")}}},35437:function(t,e,i){"use strict";i.d(e,{R:()=>r});class r{static GenAutoIncrementId(){return r.auto_increment_id++}}r.auto_increment_id=0},41809:function(t,e,i){"use strict";i.d(e,{f:()=>s});var r=i(76239);let s=(0,i(17126).v)(r.B8)},17126:function(t,e,i){"use strict";i.d(e,{f:()=>a,v:()=>l});var r=i(19381),s=i(76239),n=i(59064);function a(t){return(e,i,r)=>{var a,l;let o,h;a=s.LD,l=r.toString(),o={},n.Z.hasOwnMetadata(a,e)&&(o=n.Z.getMetadata(a,e)),void 0===(h=o[l])&&(h=[]),h.push(t),o[l]=h,n.Z.defineMetadata(a,o,e)}}function l(t){return e=>(i,s,n)=>a(new r.S(t,e))(i,s,n)}},17783:function(t,e,i){"use strict";i.d(e,{b:()=>n});var r=i(76239),s=i(59064);function n(){return function(t){return s.Z.defineMetadata(r.FL,null,t),t}}},55551:function(t,e,i){"use strict";i.d(e,{t:()=>a});var r=i(19381),s=i(76239),n=i(17126);function a(t){return(0,n.f)(new r.S(s.vO,t))}},14364:function(t,e,i){"use strict";i.d(e,{n:()=>s});var r=i(35437);class s{constructor(t){this.id=r.R.GenAutoIncrementId(),this.registry=t}}},19381:function(t,e,i){"use strict";i.d(e,{S:()=>s});var r=i(76239);class s{constructor(t,e){this.key=t,this.value=e}toString(){return this.key===r.vO?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}},76239:function(t,e,i){"use strict";i.d(e,{B8:()=>s,FL:()=>l,LD:()=>a,Lc:()=>n,vO:()=>r});let r="named",s="inject",n="multi_inject",a="inversify:tagged",l="inversify:paramtypes"},46527:function(t,e,i){"use strict";function r(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function s(t,e,i){let r=Math.sin(i),s=Math.cos(i),n=e[4],a=e[5],l=e[6],o=e[7],h=e[8],u=e[9],d=e[10],c=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*s+h*r,t[5]=a*s+u*r,t[6]=l*s+d*r,t[7]=o*s+c*r,t[8]=h*s-n*r,t[9]=u*s-a*r,t[10]=d*s-l*r,t[11]=c*s-o*r,t}function n(t,e,i){let r=Math.sin(i),s=Math.cos(i),n=e[0],a=e[1],l=e[2],o=e[3],h=e[8],u=e[9],d=e[10],c=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s-h*r,t[1]=a*s-u*r,t[2]=l*s-d*r,t[3]=o*s-c*r,t[8]=n*r+h*s,t[9]=a*r+u*s,t[10]=l*r+d*s,t[11]=o*r+c*s,t}function a(t,e,i){let r=Math.sin(i),s=Math.cos(i),n=e[0],a=e[1],l=e[2],o=e[3],h=e[4],u=e[5],d=e[6],c=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s+h*r,t[1]=a*s+u*r,t[2]=l*s+d*r,t[3]=o*s+c*r,t[4]=h*s-n*r,t[5]=u*s-a*r,t[6]=d*s-l*r,t[7]=c*s-o*r,t}function l(t,e,i){let r,s,n,a,l,o,h,u,d,c,p,g,f=i[0],m=i[1],y=i[2];return e===t?(t[12]=e[0]*f+e[4]*m+e[8]*y+e[12],t[13]=e[1]*f+e[5]*m+e[9]*y+e[13],t[14]=e[2]*f+e[6]*m+e[10]*y+e[14],t[15]=e[3]*f+e[7]*m+e[11]*y+e[15]):(r=e[0],s=e[1],n=e[2],a=e[3],l=e[4],o=e[5],h=e[6],u=e[7],d=e[8],c=e[9],p=e[10],g=e[11],t[0]=r,t[1]=s,t[2]=n,t[3]=a,t[4]=l,t[5]=o,t[6]=h,t[7]=u,t[8]=d,t[9]=c,t[10]=p,t[11]=g,t[12]=r*f+l*m+d*y+e[12],t[13]=s*f+o*m+c*y+e[13],t[14]=n*f+h*m+p*y+e[14],t[15]=a*f+u*m+g*y+e[15]),t}function o(t,e){t[0]=e.a,t[1]=e.b,t[2]=0,t[3]=0,t[4]=e.c,t[5]=e.d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e.e,t[13]=e.f,t[14]=0,t[15]=1}function h(t,e,i){let r=i[0],s=i[1],n=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function u(t,e,i){let r=e[0],s=e[1],n=e[2],a=e[3],l=e[4],o=e[5],h=e[6],u=e[7],d=e[8],c=e[9],p=e[10],g=e[11],f=e[12],m=e[13],y=e[14],_=e[15],v=i[0],b=i[1],x=i[2],S=i[3];return t[0]=v*r+b*l+x*d+S*f,t[1]=v*s+b*o+x*c+S*m,t[2]=v*n+b*h+x*p+S*y,t[3]=v*a+b*u+x*g+S*_,v=i[4],b=i[5],x=i[6],S=i[7],t[4]=v*r+b*l+x*d+S*f,t[5]=v*s+b*o+x*c+S*m,t[6]=v*n+b*h+x*p+S*y,t[7]=v*a+b*u+x*g+S*_,v=i[8],b=i[9],x=i[10],S=i[11],t[8]=v*r+b*l+x*d+S*f,t[9]=v*s+b*o+x*c+S*m,t[10]=v*n+b*h+x*p+S*y,t[11]=v*a+b*u+x*g+S*_,v=i[12],b=i[13],x=i[14],S=i[15],t[12]=v*r+b*l+x*d+S*f,t[13]=v*s+b*o+x*c+S*m,t[14]=v*n+b*h+x*p+S*y,t[15]=v*a+b*u+x*g+S*_,t}function d(t,e,i){let r=e[0],s=e[1],n=e[2],a=i[3]*r+i[7]*s+i[11]*n+i[15];return a=a||1,t[0]=(i[0]*r+i[4]*s+i[8]*n+i[12])/a,t[1]=(i[1]*r+i[5]*s+i[9]*n+i[13])/a,t[2]=(i[2]*r+i[6]*s+i[10]*n+i[14])/a,t}i.d(e,{B$:()=>o,G9:()=>u,Iu:()=>l,TL:()=>r,fF:()=>d,jI:()=>a,lM:()=>s,mN:()=>h,uD:()=>n})},78591:function(t,e,i){"use strict";let r,s,n,a,l;i.d(e,{U:()=>d,m:()=>u});let o=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,h={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},u={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};function d(t){let e,i;if(!t)return[];let u=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(null===u)return[];let d=[];for(let t=0,c=u.length;t<c;t++)if(s=(r=u[t]).slice(1),e=[n=r[0]],null!==(i=s.match(o))){for(let t=0,r=i.length;t<r;t++)Number.isNaN(a=parseFloat(i[t]))||e.push(a);if(l=h[n],e.length-1>l){let t,i=n;for(let r=1,s=e.length;r<s;r+=l){t=[i];for(let i=r,s=r+l;i<s;i++)t.push(e[i]);d.push(t),"m"===i?i="l":"M"===i&&(i="L")}}else d.push(e)}else d.push(e);return d}},94966:function(t,e,i){"use strict";i.d(e,{A:()=>n});var r=i(96087);let s=0;class n{constructor(){this.nextAnimationFrameCbs=new Map,this._rafHandle=null,this.runAnimationFrame=t=>{this._rafHandle=null;let e=this.nextAnimationFrameCbs;this.nextAnimationFrameCbs=new Map,e.forEach(e=>e(t))},this.tryRunAnimationFrameNextFrame=()=>{null===this._rafHandle&&0!==this.nextAnimationFrameCbs.size&&(this._rafHandle=r.w.global.getRequestAnimationFrame()(this.runAnimationFrame))}}addAnimationFrameCb(t){return this.nextAnimationFrameCbs.set(++s,t),this.tryRunAnimationFrameNextFrame(),s}removeAnimationFrameCb(t){return!!this.nextAnimationFrameCbs.has(t)&&(this.nextAnimationFrameCbs.delete(t),!0)}}},52250:function(t,e,i){"use strict";i.d(e,{p:()=>s});var r=i(35652);let s=t=>{if(!t)return{x:0,y:0,width:0,height:0};let e=(0,r.Z)(t.width)?t.x1-t.x:t.width,i=(0,r.Z)(t.height)?t.y1-t.y:t.height,s=0,n=0;return e<0?(s=e,e=-e):Number.isNaN(e)&&(e=0),i<0?(n=i,i=-i):Number.isNaN(i)&&(i=0),{x:s,y:n,width:e,height:i}}},60027:function(t,e,i){"use strict";i.d(e,{h:()=>s});let r=[(t,e,i,r,s,n,a)=>e.arc(t[1]*s+i,t[2]*n+r,t[3]*(s+n)/2,t[4],t[5],t[6],a),(t,e,i,r,s,n,a)=>e.arcTo(t[1]*s+i,t[2]*n+r,t[3]*s+i,t[4]*n+r,t[5]*(s+n)/2,a),(t,e,i,r,s,n,a)=>e.bezierCurveTo(t[1]*s+i,t[2]*n+r,t[3]*s+i,t[4]*n+r,t[5]*s+i,t[6]*n+r,a),(t,e,i,r)=>e.closePath(),(t,e,i,r,s,n)=>e.ellipse(t[1]*s+i,t[2]*n+r,t[3]*s,t[4]*n,t[5],t[6],t[7],t[8]),(t,e,i,r,s,n,a)=>e.lineTo(t[1]*s+i,t[2]*n+r,a),(t,e,i,r,s,n,a)=>e.moveTo(t[1]*s+i,t[2]*n+r,a),(t,e,i,r,s,n,a)=>e.quadraticCurveTo(t[1]*s+i,t[2]*n+r,t[3]*s+i,t[4]*n+r,a),(t,e,i,r,s,n,a)=>e.rect(t[1]*s+i,t[2]*n+r,t[3]*s,t[4]*n,a)];function s(t,e,i=0,n=0,a=1,l=1,o){for(let s=0;s<t.length;s++){let h=t[s];r[h[0]](h,e,i,n,a,l,o)}}},55418:function(t,e,i){"use strict";i.d(e,{V3:()=>o,fW:()=>l,hJ:()=>h});var r=i(88504),s=i(33760),n=i(47275);function a(t,e,i,r,s,n,a){var l;let o=e.p0,h=r;if(i&&i.originP1===i.originP2&&(o=i.p0),e.defined)r||(t.lineTo(o.x+s,o.y+n,a),h=!r);else{let u,{originP1:d,originP2:c}=e;if(d&&!1!==d.defined&&!i?u=o:d&&!1!==c.defined&&(u=null!=(l=e.p3)?l:e.p1),r){h=!r;let i=u?u.x:e.p0.x,l=u?u.y:e.p0.y;t.moveTo(i+s,l+n,a)}else u&&(h=!r,t.lineTo(u.x+s,u.y+n,a))}return h}function l(t,e,i,l,o){let h,{offsetX:u=0,offsetY:d=0,offsetZ:c=0,mode:p="none",drawConnect:g=!1}=o||{};if(g&&"none"===p||!e)return;let f=!0,{curves:m}=e;if(i>=1){if(g){let e,i=!0;m.forEach((r,s)=>{r.originP1!==r.originP2&&(i=a(t,r,e,i,u,d,c)),e=r})}else m.forEach(e=>{e.defined?(f&&t.moveTo(e.p0.x+u,e.p0.y+d,c),(0,n.w)(t,e,1,o),f=!1):f=!0});return}if(i<=0)return;"x"===l?h=s.Nm.ROW:"y"===l?h=s.Nm.COLUMN:"auto"===l&&(h=e.direction);let y=i*e.tryUpdateLength(h),_=0,v=!0,b=null;for(let e=0,i=m.length;e<i;e++){let i=m[e],s=i.getLength(h),l=(y-_)/s;if(_+=s,l<0)break;if(g){if(i.originP1===i.originP2){b=i;continue}v=a(t,i,b,v,u,d,c),b=i}else{if(!i.defined){f=!0;continue}f&&t.moveTo(i.p0.x+u,i.p0.y+d,c),(0,n.w)(t,i,(0,r.VV)(l,1),o),f=!1}}}function o(t,e,i,r){let{offsetX:s=0,offsetY:n=0}=r||{},a=e?e.points[e.points.length-1]:i.points[0];t.moveTo(a.x+s,a.y+n),i.points.forEach(e=>{!1!==e.defined?t.lineTo(e.x+s,e.y+n):t.moveTo(e.x+s,e.y+n)})}function h(t,e,i,r){let{offsetX:s=0,offsetY:n=0}=r||{},{points:a}=i,l=[],o=0;for(let t=0;t<a.length;t++)!1===a[t].defined&&(o+1!==t&&l.slice(o,t),o=t);l.push(a),l.forEach((i,r)=>{var a,l,o,h;let u=e&&0===r?e.points[e.points.length-1]:i[0];t.moveTo(u.x+s,u.y+n),i.forEach(e=>{!1!==e.defined?t.lineTo(e.x+s,e.y+n):t.moveTo(e.x+s,e.y+n)});for(let e=i.length-1;e>=0;e--){let r=i[e];t.lineTo(null!=(a=r.x1)?a:r.x,null!=(l=r.y1)?l:r.y)}t.lineTo(null!=(o=u.x1)?o:u.x,null!=(h=u.y1)?h:u.y),t.closePath()})}},47275:function(t,e,i){"use strict";i.d(e,{w:()=>s});var r=i(60452);function s(t,e,i,s){if(!e.p1)return;let{offsetX:n=0,offsetY:a=0,offsetZ:l=0}=s||{};if(1===i)e.p2&&e.p3?t.bezierCurveTo(n+e.p1.x,a+e.p1.y,n+e.p2.x,a+e.p2.y,n+e.p3.x,a+e.p3.y,l):t.lineTo(n+e.p1.x,a+e.p1.y,l);else if(e.p2&&e.p3){let[s]=(0,r.m)(e,i);t.bezierCurveTo(n+s.p1.x,a+s.p1.y,n+s.p2.x,a+s.p2.y,n+s.p3.x,a+s.p3.y,l)}else{let r=e.getPointAt(i);t.lineTo(n+r.x,a+r.y,l)}}},34318:function(t,e,i){"use strict";i.d(e,{H:()=>r});class r{getLength(t){return null!=t?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}},60452:function(t,e,i){"use strict";i.d(e,{A:()=>h,m:()=>o});var r=i(41457),s=i(88504),n=i(34318),a=i(33760),l=i(83917);function o(t,e){let{p0:i,p1:s,p2:n,p3:a}=t,o=(0,l.P)(i,s,n,a,e),u=r.HL.pointAtPP(i,s,e),d=r.HL.pointAtPP(s,n,e),c=r.HL.pointAtPP(n,a,e),p=r.HL.pointAtPP(u,d,e),g=r.HL.pointAtPP(d,c,e);return[new h(i,u,p,o),new h(o,g,c,a)]}class h extends n.H{constructor(t,e,i,r){super(),this.type=a.D5.CubicBezierCurve,this.p0=t,this.p1=e,this.p2=i,this.p3=r}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}getPointAt(t){if(!1!==this.defined)return(0,l.P)(this.p0,this.p1,this.p2,this.p3,t);throw Error("defined为false的点不能getPointAt")}calcLength(){return this._validPoint()?(0,l.Ci)(this.p0,this.p1,this.p2,this.p3,0):60}calcProjLength(t){return t===a.Nm.ROW?(0,s.Wn)(this.p0.x-this.p3.x):t===a.Nm.COLUMN?(0,s.Wn)(this.p0.y-this.p3.y):0}getAngleAt(t){let e=(0,s.Fp)(t-.01,0),i=(0,s.VV)(t+.01,1),r=this.getPointAt(e),n=this.getPointAt(i);return(0,s.fv)(n.y-r.y,n.x-r.x)}draw(t,e,i,r,s,n){if(t.moveTo(this.p0.x*r+e,this.p0.y*s+i),n>=1)t.bezierCurveTo(this.p1.x*r+e,this.p1.y*s+i,this.p2.x*r+e,this.p2.y*s+i,this.p3.x*r+e,this.p3.y*s+i);else if(n>0){let[a]=o(this,n);t.bezierCurveTo(a.p1.x*r+e,a.p1.y*s+i,a.p2.x*r+e,a.p2.y*s+i,a.p3.x*r+e,a.p3.y*s+i)}}includeX(t){let e=(0,s.VV)(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(0,s.Fp)(this.p0.x,this.p1.x,this.p2.x,this.p3.x);return t>=e&&t<=i}getYAt(t){let e=(0,s.VV)(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(t-e)/((0,s.Fp)(this.p0.x,this.p1.x,this.p2.x,this.p3.x)-e);return this.getPointAt(i).y}}},58757:function(t,e,i){"use strict";i.d(e,{d:()=>l,g:()=>o});var r=i(41457),s=i(88504),n=i(34318),a=i(33760);function l(t,e){let{p0:i,p1:s}=t,n=r.HL.pointAtPP(i,s,e);return[new o(i,n),new o(n,s)]}class o extends n.H{constructor(t,e){super(),this.type=a.D5.LineCurve,this.p0=t,this.p1=e}getPointAt(t){if(!1!==this.defined)return r.HL.pointAtPP(this.p0,this.p1,t);throw Error("defined为false的点不能getPointAt")}getAngleAt(t){return null==this.angle&&(this.angle=(0,s.fv)(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}calcLength(){return this._validPoint()?r.HL.distancePP(this.p0,this.p1):60}calcProjLength(t){return t===a.Nm.ROW?(0,s.Wn)(this.p0.x-this.p1.x):t===a.Nm.COLUMN?(0,s.Wn)(this.p0.y-this.p1.y):0}draw(t,e,i,r,s,n){if(t.moveTo(this.p0.x*r+e,this.p0.y*s+i),n>=1)t.lineTo(this.p1.x*r+e,this.p1.y*s+i);else if(n>0){let a=this.getPointAt(n);t.lineTo(a.x*r+e,a.y*s+i)}}includeX(t){return t>=this.p0.x&&t<=this.p1.x||t>=this.p1.x&&t<=this.p0.x}getYAt(t){if(this.includeX(t)){let e=this.p0,i=this.p1;this.p0.x>this.p1.x&&(e=this.p1,i=this.p0);let r=(t-e.x)/(i.x-e.x);return e.y+r*(i.y-e.y)}return 1/0}}},83962:function(t,e,i){"use strict";i.d(e,{X0:()=>E});var r=i(88504),s=i(41457),n=i(33760),a=i(60452),l=i(58757);class o{get endX(){return this._lastX}get endY(){return this._lastY}constructor(t,e){this.init(t,e)}init(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}bezierCurveTo(t,e,i,r,n,l,o,h){let u=new a.A(new s.E9(this._lastX,this._lastY),new s.E9(t,e),new s.E9(i,r),new s.E9(n,l));u.originP1=this._lastOriginP,u.originP2=h,u.defined=o,this.curves.push(u),this._lastX=n,this._lastY=l,this._lastOriginP=h}closePath(){if(this.curves.length<2)return;let t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}ellipse(){throw Error("SegContext不支持调用ellipse")}lineTo(t,e,i,r){let s=this.addLinearCurve(t,e,i,this._lastOriginP,r);this.curves.push(s),this._lastX=t,this._lastY=e,this._lastOriginP=r}moveTo(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}quadraticCurveTo(t,e,i,r){throw Error("SegContext不支持调用quadraticCurveTo")}clear(){this.curves=[],this.length=NaN}tryUpdateLength(t){return this.getLength(t)}addLinearCurve(t,e,i,r,n){let a=new l.g(new s.E9(this._lastX,this._lastY),new s.E9(t,e));return a.originP1=r,a.originP2=n,a.defined=i,a}getPointAt(t){throw Error("暂未实现")}getCurveLengths(){return[]}getLength(t){var e,i;if(t===n.Nm.COLUMN){if(!this.curves.length)return 0;let t=this.curves[0],i=this.curves[this.curves.length-1],s=null!=(e=i.p3)?e:i.p1;return(0,r.Wn)(t.p0.y-s.y)}if(t===n.Nm.ROW){if(!this.curves.length)return 0;let t=this.curves[0],e=this.curves[this.curves.length-1],s=null!=(i=e.p3)?i:e.p1;return(0,r.Wn)(t.p0.x-s.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((t,e)=>t+e.getLength(),0)),this.length}}class h extends o{bezierCurveTo(t,e,i,r,s,n,a,l){return super.bezierCurveTo(e,t,r,i,n,s,a,l)}lineTo(t,e,i,r){return super.lineTo(e,t,i,r)}moveTo(t,e,i){return super.moveTo(e,t,i)}clear(){return super.clear()}}function u(t,e,i=1){let r=!1;for(let i=0,s=e.length;i<=s;i++)i>=s===r&&((r=!r)?t.lineStart():t.lineEnd()),r&&t.point(e[i])}function d(t,e,i){let s=null!=e?e:(0,r.Wn)(i[i.length-1].x-i[0].x)>(0,r.Wn)(i[i.length-1].y-i[0].y)?n.Nm.ROW:n.Nm.COLUMN;return"monotoneY"===t?new h(t,s):new o(t,s)}class c{constructor(t,e){this.context=t,e&&(this.startPoint=e)}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t)}this._lastDefined=t.defined}tryUpdateLength(){return this.context.tryUpdateLength()}}function p(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;let s=d("linear",i,t);return u(new c(s,r),t,1),s}function g(t,e,i,r,s){t.context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+i)/6,r,t.lastPoint1)}class f{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){2===this._point&&g(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:g(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function m(t,e,i){let r=t._x1-t._x0,s=e-t._x1,n=(t._y1-t._y0)/(r||Number(s<0&&-0)),a=(i-t._y1)/(s||Number(r<0&&-0));return((n<0?-1:1)+(a<0?-1:1))*Math.min(Math.abs(n),Math.abs(a),.5*Math.abs((n*s+a*r)/(r+s)))||0}function y(t,e){let i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function _(t,e,i,r,s){let n=t._x0,a=t._y0,l=t._x1,o=t._y1,h=(l-n)/3;t.context.bezierCurveTo(n+h,a+h*e,l-h,o-h*i,l,o,r,t.lastPoint1)}class v{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:_(this,this._t0,y(this,this._t0),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1)}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=NaN,i=t.x,r=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,r,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(i,r,t);break;case 1:this._point=2;break;case 2:this._point=3,_(this,y(this,e=m(this,i,r)),e,!1!==this._lastDefined1&&!1!==this._lastDefined2,t);break;default:_(this,this._t0,e=m(this,i,r),!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=r,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=!1!==t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class b extends v{constructor(t,e){super(t,e)}point(t){return super.point({y:t.x,x:t.y,defined:t.defined})}}class x{constructor(t,e=.5,i){this.context=t,this._t=e,this.startPoint=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){0<this._t&&this._t<1&&2===this._point&&this.context.lineTo(this._x,this._y,!1!==this._lastDefined,this.lastPoint),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t);else{let r=this._x*(1-this._t)+e*this._t;.5===this._t?this.context.lineTo(r,this._y,!1!==this._lastDefined,this.lastPoint):this.context.lineTo(r,this._y,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(r,i,!1!==this._lastDefined&&!1!==t.defined,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class S extends x{lineEnd(){this.context.closePath()}}function k(t,e,i={}){let{direction:s,startPoint:a}=i;if(t.length<2-Number(!!a))return null;let l=new o("step",null!=s?s:(0,r.Wn)(t[t.length-1].x-t[0].x)>(0,r.Wn)(t[t.length-1].y-t[0].y)?n.Nm.ROW:n.Nm.COLUMN);return u(new x(l,e,a),t,1),l}class A extends c{lineEnd(){this.context.closePath()}}function M(t,e,i,s,n){let a=t._x1,l=t._y1,o=t._x2,h=t._y2;if(t._l01_a>r.Ho){let e=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,i=3*t._l01_a*(t._l01_a+t._l12_a);a=(a*e-t._x0*t._l12_2a+t._x2*t._l01_2a)/i,l=(l*e-t._y0*t._l12_2a+t._y2*t._l01_2a)/i}if(t._l23_a>r.Ho){let r=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,s=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*r+t._x1*t._l23_2a-e*t._l12_2a)/s,h=(h*r+t._y1*t._l23_2a-i*t._l12_2a)/s}t.context.bezierCurveTo(a,l,o,h,t._x2,t._y2,s,t.lastPoint1)}function w(t,e){return function(i,r,s={}){let{direction:n,startPoint:a}=s;if(i.length<2-Number(!!a))return null;if(i.length<3-Number(!!a))return p(i,s);let l=d(t,n,i);return u(new e(l,r,a),i,2),l}}let T=w("catmullRom",class{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let{x:e,y:i}=t;if(this._point){let t=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2):this.context.moveTo(e,i);break;case 1:this._point=2;break;case 2:this._point=3;default:M(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}),C=w("catmullRomClosed",class{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}point(t){let{x:e,y:i}=t;if(this._point){let t=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=i;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=i,t);break;case 2:this._point=3,this._x5=e,this._y5=i;break;default:M(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}});function E(t,e,i){var s,a;switch(e){case"linear":default:return p(t,i);case"basis":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return p(t,e);let s=d("basis",i,t);return u(new f(s,r),t,2),s}(t,i);case"monotoneX":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return p(t,e);let s=d("monotoneX",i,t);return u(new v(s,r),t,2),s}(t,i);case"monotoneY":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return p(t,e);let s=d("monotoneY",i,t);return u(new b(s,r),t,2),s}(t,i);case"step":return k(t,.5,i);case"stepClosed":return function(t,e,i={}){let{direction:s,startPoint:a}=i;if(t.length<2-Number(!!a))return null;let l=new o("step",null!=s?s:(0,r.Wn)(t[t.length-1].x-t[0].x)>(0,r.Wn)(t[t.length-1].y-t[0].y)?n.Nm.ROW:n.Nm.COLUMN);return u(new S(l,.5,a),t,1),l}(t,0,i);case"stepBefore":return k(t,0,i);case"stepAfter":return k(t,1,i);case"catmullRom":return T(t,null!=(s=null==i?void 0:i.curveTension)?s:.5,i);case"catmullRomClosed":return C(t,null!=(a=null==i?void 0:i.curveTension)?a:.5,i);case"linearClosed":return function(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;let s=d("linear",i,t);return u(new A(s,r),t,1),s}(t,i)}}},24806:function(t,e,i){"use strict";i.d(e,{U:()=>l});var r=i(88504),s=i(45273),n=i(88663);let a=r.pi/2;function l(t,e,i,o,h,u,d=!0,c){let p;if(Array.isArray(d)&&(c=d,d=!0),o<0&&(e+=o,o=-o),h<0&&(i+=h,h=-h),(0,s.Z)(u,!0))p=[u=(0,r.Wn)(u),u,u,u];else if(Array.isArray(u)){let t,e,i=u;switch(i.length){case 0:p=[0,0,0,0];break;case 1:p=[t=(0,r.Wn)(i[0]),t,t,t];break;case 2:case 3:p=[t=(0,r.Wn)(i[0]),e=(0,r.Wn)(i[1]),t,e];break;default:(p=i)[0]=(0,r.Wn)(p[0]),p[1]=(0,r.Wn)(p[1]),p[2]=(0,r.Wn)(p[2]),p[3]=(0,r.Wn)(p[3])}}else p=[0,0,0,0];if(o<0||p[0]+p[1]+p[2]+p[3]<1e-12)return t.rect(e,i,o,h);let[g,f,m,y]=[[e,i],[e+o,i],[e+o,i+h],[e,i+h]],_=Math.min(o/2,h/2),v=[Math.min(_,p[0]),Math.min(_,p[1]),Math.min(_,p[2]),Math.min(_,p[3])],b=[g[0]+v[0],g[1]],x=[g[0],g[1]+v[0]],S=[f[0]-v[1],f[1]],k=[f[0],f[1]+v[1]],A=[m[0]-v[2],m[1]],M=[m[0],m[1]-v[2]],w=[y[0]+v[3],y[1]],T=[y[0],y[1]-v[3]];if(t.moveTo(b[0],b[1]),d){if(c&&c[0]?c[0](b[0],b[1],S[0],S[1]):t.lineTo(S[0],S[1]),!(0,n.h6)(S,k)){c&&c[0]&&t.moveTo(S[0],S[1]);let e=S[0],i=S[1]+v[1];t.arc(e,i,v[1],-a,0,!1)}if(c&&c[1]?c[1](k[0],k[1],M[0],M[1]):t.lineTo(M[0],M[1]),!(0,n.h6)(A,M)){let e=M[0]-v[2],i=M[1];c&&c[1]&&t.moveTo(M[0],M[1]),t.arc(e,i,v[2],0,a,!1)}if(c&&c[2]?c[2](A[0],A[1],w[0],w[1]):t.lineTo(w[0],w[1]),!(0,n.h6)(w,T)){let e=w[0],i=w[1]-v[3];c&&c[2]&&t.moveTo(w[0],w[1]),t.arc(e,i,v[3],a,r.pi,!1)}if(c&&c[3]?c[3](T[0],T[1],x[0],x[1]):t.lineTo(x[0],x[1]),!(0,n.h6)(b,x)){let e=b[0],i=b[1]+v[0];c&&c[3]&&t.moveTo(x[0],x[1]),t.arc(e,i,v[0],r.pi,r.pi+a,!1)}}else c&&c[0]?c[0](b[0],b[1],S[0],S[1]):t.lineTo(S[0],S[1]),c&&c[1]?c[1](S[0],S[1],A[0],A[1]):t.lineTo(A[0],A[1]),c&&c[2]?c[2](A[0],A[1],w[0],w[1]):t.lineTo(w[0],w[1]),c&&c[2]?c[2](w[0],w[1],b[0],b[1]):t.lineTo(b[0],b[1]);return c||t.closePath(),t}},54723:function(t,e,i){"use strict";function r(t,e,i){let r={},s=[];return t.forEachChildren(t=>{let{zIndex:i=e}=t.attribute;r[i]?r[i].push(t):(r[i]=[t],s.push(i))},i),s.sort((t,e)=>i?e-t:t-e),{childMap:r,zIdxArray:s}}function s(t,e,i,n=!1,a=!1){let l=!1;if(a)l=!0;else{let i;t.forEachChildren((t,r)=>{let{zIndex:s=e}=t.attribute;if(0===r)i=s;else if(i!==s)return l=!0,!0;return!1},n)}if(l){let{childMap:s,zIdxArray:l}=r(t,e,n),o=!1;for(let t=0;t<l.length&&!o;t++){let e=s[l[t]];a&&e.sort((t,e)=>{var i,r;return(n?-1:1)*((null!=(i=e.attribute.z)?i:0)-(null!=(r=t.attribute.z)?r:0))});for(let t=0;t<e.length;t++)if(i(e[t],t)){o=!0;break}}}else t.forEachChildren(i,n)}function n(t,e,i,r=!1){var s,a,l,o;return s=this,a=void 0,l=void 0,o=function*(){yield t.forEachChildrenAsync(i,r)},new(l||(l=Promise))(function(t,e){function i(t){try{n(o.next(t))}catch(t){e(t)}}function r(t){try{n(o.throw(t))}catch(t){e(t)}}function n(e){var s;e.done?t(e.value):((s=e.value)instanceof l?s:new l(function(t){t(s)})).then(i,r)}n((o=o.apply(s,a||[])).next())})}function a(t,e,i,s=!1){let n=!1;t.forEachChildren((t,e)=>{let{zIndex:r=i}=t.attribute;if(0===e);else if(void 0!==r)return n=!0,!0;return!1},s);let l=null,o=!1;if(n){let{childMap:n,zIdxArray:a}=r(t,i,s),h=!1;for(let t=0;t<a.length&&!h;t++){let i=n[a[t]];for(let t=0;t<i.length;t++){if(o){h=!0,l=i[t];break}i[t]._uid!==e||(o=!0)}}}else t.forEachChildren(t=>o?(l=t,!0):(t._uid===e&&(o=!0),!1),s);return l}i.d(e,{Ud:()=>n,kD:()=>s,qA:()=>a})},58539:function(t,e,i){"use strict";i.d(e,{WD:()=>h,js:()=>l,nV:()=>o});var r=i(97424),s=i(35652),n=i(21777),a=i(30756);function l(t,e){return"end"===t||"right"===t?-e:"center"===t?-e/2:0}function o(t,e,i,r=0){return"middle"===t?-e/2:"top"===t?0:"bottom"===t?r-e:t&&"alphabetic"!==t?0:(i||(i=e),-(e-i)/2-.79*i)}function h(t){let e={},i=t=>/^\d+(\.\d+)?$/.test(`${t}`)?`${t}px`:`${t}`;return["textAlign","fontFamily","fontVariant","fontStyle","fontWeight"].forEach(i=>{t[i]&&(e[(0,r.Z2)(i)]=t[i])}),["fontSize","lineHeight"].forEach(n=>{let a=(0,r.Z2)(n);(0,s.Z)(t[n])||(e[a]=i(t[n]))}),(0,n.Z)(t.maxLineWidth)&&(e["max-width"]=i(t.maxLineWidth)),t.underline?e["text-decoration"]="underline":t.lineThrough&&(e["text-decoration"]="line-through"),t.fill&&(0,a.Z)(t.fill)&&(e.color=t.fill),e}},37967:function(t,e,i){"use strict";i.d(e,{Dn:()=>d,SA:()=>_,VA:()=>k,dZ:()=>x,dj:()=>p,hT:()=>v,jx:()=>m,p9:()=>b,q9:()=>y});var r,s,n=i(61868),a=i(31535),l=i(88504),o=i(41457),h=i(30756);(r=s||(s={}))[r.Top=1]="Top",r[r.Right=2]="Right",r[r.Bottom=4]="Bottom",r[r.Left=8]="Left",r[r.ALL=15]="ALL";let u=[!1,!1,!1,!1],d=t=>{var e;let i=!0;if((0,n.Z)(t,!0)){for(let r=0;r<4;r++)u[r]=t,i&&(i=!(null!=(e=u[r])&&!e));i=t}else if(Array.isArray(t))for(let e=0;e<4;e++)u[e]=!!t[e],i&&(i=!!u[e]);else u[0]=!1,u[1]=!1,u[2]=!1,u[3]=!1;return{isFullStroke:i,stroke:u}},c=[0,0,0,0],p=t=>t?(0,a.Z)(t)?0===t.length?0:1===t.length?t[0]:2===t.length?(c[0]=t[0],c[2]=t[0],c[1]=t[1],c[3]=t[1],c):t:t:0,g=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],f=[1,2,3,0,1,2,3,0];function m(t,e,i,r){for(;t>=l.f7;)t-=l.f7;for(;t<0;)t+=l.f7;for(;t>e;)e+=l.f7;g[0].x=i,g[1].y=i,g[2].x=-i,g[3].y=-i;let s=Math.ceil(t/l.ou)%4,n=Math.ceil(e/l.ou)%4;if(r.add((0,l.mC)(t)*i,(0,l.O$)(t)*i),r.add((0,l.mC)(e)*i,(0,l.O$)(e)*i),s!==n||e-t>l.pi){let t=!1;for(let e=0;e<f.length;e++)if(t||s!==f[e]){if(t&&n===f[e])break;if(t){let t=g[f[e]];r.add(t.x,t.y)}}else{t=!0;let e=g[s];r.add(e.x,e.y)}}}function y(t,e,i){let{x:r,y:s}=(0,l.KU)(t.x,t.y,e.x,e.y,i),{x:n,y:a}=(0,l.KU)(t.x1,t.y1,e.x1,e.y1,i),h=new o.E9(r,s,n,a);return h.defined=e.defined,h}function _(t,e,i){if(!t||!e)return[];Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);let r=[];if(t.length>e.length){r=e.map(t=>{let e=new o.E9(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e});for(let s=0;s<e.length;s++)r[s]=y(t[s],e[s],i)}else{r=e.map(t=>{let e=new o.E9(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e});for(let s=0;s<t.length;s++)r[s]=y(t[s],e[s],i)}return r}function v(t,e){if((0,a.Z)(t)){let i;for(let r=0;r<t.length&&void 0===i;r++)i=t[r][e];return i}return t[e]}class b{constructor(t=b.TimeOut){this.durations=[],this.timeout=t,this.lastDate=0,this.durationsListThreshold=30}call(t){return this.lastDate=Date.now(),setTimeout(()=>{this.appendDuration(Date.now()-this.lastDate),t(0)},this.timeout,!0)}clear(t){clearTimeout(t)}appendDuration(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((t,e)=>t+e,0)/this.durations.length,1e3/60),1e3/30)}}b.TimeOut=1e3/60;let x=new b,S=(t,e)=>(0,h.Z)(t)&&"%"===t[t.length-1]?e*(Number.parseFloat(t.substring(0,t.length-1))/100):t,k=(t,e)=>{let i=S(t,e);return isNaN(i)?i:Math.max(e,i)}},8385:function(t,e,i){"use strict";i.d(e,{D0:()=>r,iR:()=>n,y2:()=>s});let r=Symbol.for("EnvContribution"),s=Symbol.for("VGlobal"),n="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol"},93279:function(t,e,i){"use strict";let r;i.d(e,{n:()=>f});var s=i(35437);let n={Singleton:"Singleton",Transient:"Transient"},a={ConstantValue:"ConstantValue",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid"};class l{constructor(t,e){this.id=s.R.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=a.Invalid,this.constraint=t=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}clone(){let t=new l(this.serviceIdentifier,this.scope);return t.activated=t.scope===n.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.provider=this.provider,t.constraint=this.constraint,t.cache=this.cache,t}}var o=i(76239),h=i(59064);class u{getConstructorMetadata(t){return{compilerGeneratedMetadata:h.Z.getMetadata(o.FL,t),userGeneratedMetadata:h.Z.getMetadata(o.LD,t)||{}}}getPropertiesMetadata(t){throw Error("暂未实现")}}var d=i(19381);let c=(r=o.vO,t=>{let e=e=>{if(null==e)return!1;if(e.key===r&&e.value===t)return!0;if(null==e.constructorArgsMetadata)return!1;let i=e.constructorArgsMetadata;for(let e=0;e<i.length;e++)if(i[e].key===r&&i[e].value===t)return!0;return!1};return e.metaData=new d.S(r,t),e});class p{constructor(t){this._binding=t}inRequestScope(){throw Error("暂未实现")}inSingletonScope(){return this._binding.scope=n.Singleton,this}inTransientScope(){return this._binding.scope=n.Transient,this}whenTargetNamed(t){return this._binding.constraint=c(t),this}}class g{constructor(t){this._binding=t}to(t){return this._binding.type=a.Instance,this._binding.implementationType=t,new p(this._binding)}toSelf(){let t=this._binding.serviceIdentifier;return this.to(t)}toDynamicValue(t){return this._binding.type=a.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new p(this._binding)}toConstantValue(t){return this._binding.type=a.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=n.Singleton,new p(this._binding)}toFactory(t){return this._binding.type=a.Factory,this._binding.factory=t,this._binding.scope=n.Singleton,new p(this._binding)}toService(t){this.toDynamicValue(e=>e.container.get(t))}}let f=new class{constructor(t){let e=t||{};e.defaultScope=e.defaultScope||n.Transient,this.options=e,this.id=s.R.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new u}load(t){let e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}get(t){let e=this._getNotAllArgs(t,!1);return this._get(e)}getAll(t){let e=this._getAllArgs(t);return this._get(e)}getTagged(t,e,i){let r=this._getNotAllArgs(t,!1,e,i);return this._get(r)}getNamed(t,e){return this.getTagged(t,o.vO,e)}isBound(t){return this._bindingDictionary.has(t)}bind(t){let e=new l(t,this.options.defaultScope),i=this._bindingDictionary.get(t)||[];return i.push(e),this._bindingDictionary.set(t,i),new g(e)}unbind(t){this._bindingDictionary.delete(t)}rebind(t){return this.unbind(t),this.bind(t)}_getContainerModuleHelpersFactory(){let t=(t,e)=>{t._binding.moduleId=e},e=e=>i=>{let r=this.bind(i);return t(r,e),r},i=()=>t=>this.unbind(t),r=()=>t=>this.isBound(t),s=e=>i=>{let r=this.rebind(i);return t(r,e),r};return t=>({bindFunction:e(t),isboundFunction:r(),rebindFunction:s(t),unbindFunction:i(),unbindAsyncFunction:t=>null})}_getNotAllArgs(t,e,i,r){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:r}}_getAllArgs(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}_get(t){let e=[];return this._bindingDictionary.get(t.serviceIdentifier).filter(e=>e.constraint(t)).forEach(t=>{e.push(this._resolveFromBinding(t))}),t.isMultiInject||1!==e.length?e:e[0]}_getChildRequest(t){let e=t.implementationType,{userGeneratedMetadata:i}=this._metadataReader.getConstructorMetadata(e),r=Object.keys(i),s=[];for(let t=0;t<r.length;t++){let e=i[t],r={};e.forEach(t=>{r[t.key]=t.value});let n={inject:r[o.B8],multiInject:r[o.Lc]},a=n.inject||n.multiInject,l={serviceIdentifier:a,constructorArgsMetadata:e},h=(this._bindingDictionary.get(a)||[]).filter(t=>t.constraint(l));if(h.length){let t={injectIdentifier:a,metadata:e,bindings:h};s.push(t)}}return s}_resolveFromBinding(t){let e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}_getResolvedFromBinding(t){let e;switch(t.type){case a.ConstantValue:case a.Function:e=t.cache;break;case a.Instance:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}_resolveInstance(t,e){if(t.activated)return t.cache;let i=this._getChildRequest(t);return this._createInstance(e,i)}_createInstance(t,e){return e.length?new t(...this._resolveRequests(e)):new t}_resolveRequests(t){return t.map(t=>t.bindings.length>1?t.bindings.map(t=>this._resolveFromBinding(t)):this._resolveFromBinding(t.bindings[0]))}_saveToScope(t,e){t.scope===n.Singleton&&(t.cache=e,t.activated=!0)}}},69507:function(t,e,i){"use strict";i.d(e,{Gp:()=>r,IT:()=>n,XJ:()=>o,kj:()=>a,no:()=>s,ym:()=>l});let r=Symbol.for("TransformUtil"),s=Symbol.for("GraphicUtil"),n=Symbol.for("LayerService"),a=Symbol.for("StaticLayerHandlerContribution"),l=Symbol.for("DynamicLayerHandlerContribution"),o=Symbol.for("VirtualLayerHandlerContribution")},35238:function(t,e,i){"use strict";i.d(e,{z:()=>n});var r=i(17783),s=i(76620);let n=class{configure(t,...e){t.env===this.type&&t.setActiveEnvContribution(this)}getNativeAABBBounds(t){return new s.FB}removeDom(t){return!1}createDom(t){return null}updateDom(t,e){return!1}getDynamicCanvasCount(){return 999}getStaticCanvasCount(){return 999}getElementById(t){return document.getElementById(t)}getRootElement(){return document.body}loadJson(t){let e=fetch(t).then(t=>t.json());return e.then(t=>({data:t,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(t){return fetch(t).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadBlob(t){return fetch(t).then(t=>t.blob()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}getElementTop(t,e){return 0}getElementLeft(t,e){return 0}getElementTopLeft(t,e){return{top:0,left:0}}loadFont(t,e,i){var r,s,n,a;return r=this,s=void 0,a=function*(){return{loadState:"fail"}},new(n=void 0,n=Promise)(function(t,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function l(t){try{o(a.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n(function(t){t(r)})).then(i,l)}o((a=a.apply(r,s||[])).next())})}isMacOS(){return!1}copyToClipBoard(t){return Promise.resolve(null)}};n=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,r.b)()],n)},95940:function(t,e,i){"use strict";i.d(e,{j:()=>s});var r=i(14226);class s{constructor(t,e,i){this.fontFamily=t,this.textOptions=e,this.textMeasure=i}LayoutBBox(t,e,i,r){if(t.xOffset="left"===e||"start"===e?0:"center"===e?-(t.width/2):"right"===e||"end"===e?-t.width:0,"top"===i)t.yOffset=0;else if("middle"===i)t.yOffset=-(t.height/2);else if("alphabetic"===i){let e=.79;if(1===r.length){let t=r[0];e=t.ascent/(t.ascent+t.descent)}t.yOffset=-(t.height*e)}else t.yOffset=-t.height;return t}GetLayoutByLines(t,e,i,s,n="",a,l){let{lineWidth:o,suffixPosition:h="end",measureMode:u=r.r.actualBounding,keepCenterInLine:d=!1}=null!=l?l:{};t=t.map(t=>t.toString());let c=[],p=[0,0];if("number"==typeof o&&o!==1/0){let e;for(let i=0,r=t.length;i<r;i++){let r=this.textMeasure.measureTextPixelADscentAndWidth(t[i],this.textOptions,u),s=t[i].toString();if(r.width>o){let r=this.textMeasure.clipTextWithSuffix(t[i],this.textOptions,o,n,a,h);s=r.str,e=r.width}else e=r.width;c.push({str:s,width:e,ascent:r.ascent,descent:r.descent,keepCenterInLine:d})}p[0]=o}else{let e,i,r=0;for(let s=0,n=t.length;s<n;s++){i=t[s];let n=this.textMeasure.measureTextPixelADscentAndWidth(t[s],this.textOptions,u);r=Math.max(r,e=n.width),c.push({str:i,width:e,ascent:n.ascent,descent:n.descent,keepCenterInLine:d})}p[0]=r}p[1]=c.length*s,p[0]=c.reduce((t,e)=>Math.max(t,e.width),0);let g={xOffset:0,yOffset:0,width:p[0],height:p[1]};return this.LayoutBBox(g,e,i,c),this.layoutWithBBox(g,c,e,i,s)}layoutWithBBox(t,e,i,r,s){let n=[0,0],a=e.length*s;"top"===r||("middle"===r?n[1]=(t.height-a)/2:"bottom"===r&&(n[1]=t.height-a));for(let a=0;a<e.length;a++)this.lineOffset(t,e[a],i,r,s,n);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:s,textAlign:i,textBaseline:r}}lineOffset(t,e,i,r,s,n){if("left"===i||"start"===i?e.leftOffset=0:"center"===i?e.leftOffset=(t.width-e.width)/2:"right"!==i&&"end"!==i||(e.leftOffset=t.width-e.width),e.topOffset=s/2+(e.ascent-e.descent)/2+n[1],!e.keepCenterInLine){let t=e.ascent+e.descent+0;if(t<s-0&&("bottom"===r?e.topOffset+=(s-t)/2:"top"===r&&(e.topOffset-=(s-t)/2)),"alphabetic"===r){let t=s/(e.ascent+e.descent);e.topOffset=s/2+(e.ascent-e.descent)/2*t+n[1]}}return n[1]+=s,e}}},24053:function(t,e,i){"use strict";i.d(e,{j:()=>h,f:()=>u});var r=i(17783),s=i(14226),n=i(59484),a=i(28580),l=i(30943);let o=class{configure(t,e){this.canvas=t.canvas,this.context=t.context,t.bindTextMeasure(this)}_measureTextWithoutAlignBaseline(t,e,i){this.context.setTextStyleWithoutAlignBaseline(e);let r=this.context.measureText(t);return i?this.compatibleMetrics(r,e):r}_measureTextWithAlignBaseline(t,e,i){this.context.setTextStyle(e);let r=this.context.measureText(t);return i?this.compatibleMetrics(r,e):r}compatibleMetrics(t,e){if(null==t.actualBoundingBoxAscent||null==t.actualBoundingBoxDescent||null==t.fontBoundingBoxAscent||null==t.fontBoundingBoxDescent){t={width:t.width};let{ascent:i,descent:r}=this.measureTextBoundADscentEstimate(e);t.actualBoundingBoxAscent=i,t.actualBoundingBoxDescent=r,t.fontBoundingBoxAscent=i,t.fontBoundingBoxDescent=r}if(null==t.actualBoundingBoxLeft||null==t.actualBoundingBoxRight){t={width:t.width,actualBoundingBoxAscent:t.actualBoundingBoxAscent,actualBoundingBoxDescent:t.actualBoundingBoxDescent,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent};let{left:i,right:r}=this.measureTextBoundLeftRightEstimate(e);t.actualBoundingBoxLeft=i,t.actualBoundingBoxRight=r}return t}estimate(t,{fontSize:e=n.T5.fontSize}){let i=0,r=0;for(let e=0;e<t.length;e++)128>t.charCodeAt(e)?i++:r++;return{width:~~(.8*i*e+r*e),height:e}}measureTextWidth(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}measureTextBoundsWidth(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}measureTextBoundsLeftRight(t,e,i){return this.context?{left:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxLeft,right:i.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(e)}measureTextPixelHeight(t,e,i){var r;return this.context?Math.abs((i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0)).actualBoundingBoxAscent-i.actualBoundingBoxDescent):null!=(r=e.fontSize)?r:n.q9.fontSize}measureTextPixelADscent(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}measureTextBoundHieght(t,e,i){var r;return this.context?Math.abs((i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0)).fontBoundingBoxAscent-i.fontBoundingBoxDescent):null!=(r=e.fontSize)?r:n.q9.fontSize}measureTextBoundADscent(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).fontBoundingBoxAscent,descent:i.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}measureTextBoundADscentEstimate(t){var e;let i=null!=(e=t.fontSize)?e:n.q9.fontSize;return{ascent:.79*i,descent:.21*i}}measureTextBoundLeftRightEstimate(t){var e;let i=null!=(e=t.fontSize)?e:n.q9.fontSize,{textAlign:r}=t;return"center"===r?{left:i/2,right:i/2}:"right"===r||"end"===r?{left:i,right:0}:{left:0,right:i}}measureTextPixelADscentAndWidth(t,e,i){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:this.estimate(t,e).width});let r=this._measureTextWithoutAlignBaseline(t,e,!0);if(i===s.r.actualBounding)return{ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,width:r.width};if(i===s.r.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:r.width});if(i===s.r.fontBounding){let t=r.fontBoundingBoxAscent,e=r.fontBoundingBoxDescent;if(r.actualBoundingBoxDescent&&e<r.actualBoundingBoxDescent){let i=r.actualBoundingBoxDescent-e;e+=i,t-=i}else if(r.actualBoundingBoxAscent&&t<r.actualBoundingBoxAscent){let i=r.actualBoundingBoxAscent-t;t+=i,e-=i}return{ascent:t,descent:e,width:r.width}}return{ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,width:r.width}}measureText(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t)):this.estimate(t,e)}clipTextVertical(t,e,i,r){if(0===t.length)return{verticalList:t,width:0};let{fontSize:s=12}=e;t.forEach(t=>{t.width=0===t.direction?s:this.measureTextWidth(t.text,e)});let n=[],l=0,o=0;for(;o<t.length&&l+t[o].width<i;o++)l+=t[o].width,n.push(t[o]);if(t[o]&&t[o].text.length>1){let s=this._clipText(t[o].text,e,i-l,0,t[o].text.length-1,"end",!1);if(r&&s.str!==t[o].text){let i="",r=0;for(let e=0;e<o;e++){let s=t[e];i+=s.text,r+=s.text.length}i+=t[o].text;let n=r+s.str.length,l=(0,a.SZ)(i,n);(l-=r)!=s.str.length-1&&(s.str=s.str.substring(0,l),s.width=this.measureTextWidth(s.str,e))}n.push(Object.assign(Object.assign({},t[o]),{text:s.str,width:s.width})),l+=s.width}return{verticalList:n,width:l}}clipText(t,e,i,r,s){if(0===t.length)return{str:"",width:0};let n=this.measureTextWidth(t,e);if(n<=i)return{str:t,width:n};if((n=this.measureTextWidth(t[0],e))>i)return{str:"",width:0};let l=this._clipText(t,e,i,0,t.length-1,"end",!1);if(r&&l.str!==t){let i=(0,a.SZ)(t,l.str.length,s);i!==l.str.length&&(i>l.str.length&&(l.wordBreaked=i,i=l.str.length),l.str=t.substring(0,i),l.width=this.measureTextWidth(l.str,e))}return l}_clipText(t,e,i,r,s,n,a){let l;if("start"===n)l=this._clipTextStart(t,e,i,r,s),a&&(l.result=a+l.str);else if("middle"===n){let r=this._clipTextMiddle(t,e,i,"","",0,0,1);l={str:"none",width:r.width,result:r.left+a+r.right}}else l=this._clipTextEnd(t,e,i,r,s),a&&(l.result=l.str+a);return l}_clipTextEnd(t,e,i,r,s){let n;if(r===s){l.Y.getInstance().warn(`【_clipTextEnd】不应该走到这里${t}, ${r}, ${s}`);let i=t.substring(0,s+1);return{str:i,width:this.measureTextWidth(i,e)}}let a=Math.floor((r+s)/2),o=t.substring(0,a+1),h=this.measureTextWidth(o,e);if(h>i){if(o.length<=1)return{str:"",width:0};let s=t.substring(0,a);return(n=this.measureTextWidth(s,e))<=i?{str:s,width:n}:this._clipTextEnd(t,e,i,r,a)}if(h<i){if(a>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};let r=t.substring(0,a+2);return(n=this.measureTextWidth(r,e))>=i?{str:o,width:h}:this._clipTextEnd(t,e,i,a,s)}return{str:o,width:h}}_clipTextStart(t,e,i,r,s){let n,a=Math.ceil((r+s)/2),l=t.substring(a-1,t.length),o=this.measureTextWidth(l,e);if(o>i){if(l.length<=1)return{str:"",width:0};let r=t.substring(a,t.length);return(n=this.measureTextWidth(r,e))<=i?{str:r,width:n}:this._clipTextStart(t,e,i,a,t.length)}if(o<i){if(a<=0)return{str:t,width:this.measureTextWidth(t,e)};let s=t.substring(a-2,t.length);return(n=this.measureTextWidth(s,e))>=i?{str:l,width:o}:this._clipTextStart(t,e,i,r,a)}return{str:l,width:o}}_clipTextMiddle(t,e,i,r,s,n,a,l){let o=t.substring(0,l),h=this.measureTextWidth(o,e);if(h+a>i)return{left:r,right:s,width:n+a};let u=t.substring(t.length-l,t.length),d=this.measureTextWidth(u,e);return h+d>i?{left:o,right:s,width:h+a}:this._clipTextMiddle(t,e,i,o,u,h,d,l+1)}clipTextWithSuffixVertical(t,e,i,r,s,n){let a;if(""===r)return this.clipTextVertical(t,e,i,s);if(0===t.length)return{verticalList:t,width:0};let l=this.clipTextVertical(t,e,i,s);if(l.verticalList.length===t.length&&l.verticalList[l.verticalList.length-1].width===t[t.length-1].width)return l;let o=this.measureTextWidth(r,e);if(o>i)return l;if(i-=o,"start"===n){let n=this.revertVerticalList(t);a=this.clipTextVertical(n,e,i,s);let l=this.revertVerticalList(a.verticalList);l.unshift({text:r,direction:1,width:o}),a.verticalList=l}else if("middle"===n){let n=this.clipTextVertical(t,e,i/2,s),l=this.revertVerticalList(t),h=this.clipTextVertical(l,e,i/2,s);n.verticalList.push({text:r,direction:1,width:o}),this.revertVerticalList(h.verticalList).forEach(t=>n.verticalList.push(t)),a={verticalList:n.verticalList,width:n.width+h.width}}else(a=this.clipTextVertical(t,e,i,s)).verticalList.push({text:r,direction:1,width:o});return a.width+=o,a}revertVerticalList(t){return t.reverse().map(t=>{let e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})})}clipTextWithSuffix(t,e,i,r,s,n,l=!1){if(""===r)return this.clipText(t,e,i,s);if(0===t.length)return{str:"",width:0};let o=this.measureTextWidth(t,e);if(!l&&o<=i)return{str:t,width:o};let h=this.measureTextWidth(r,e);if(h>i)return{str:"",width:0};if(l&&o+h<=i)return{str:t+r,width:o+h};i-=h;let u=this._clipText(t,e,i,0,t.length-1,n,r);if(s&&u.str!==t){let i=(0,a.SZ)(t,u.str.length);i!==u.str.length&&(u.result=t.substring(0,i),u.width=this.measureTextWidth(u.str,e))}else l&&u.str===t&&(u.result=t+r);return u.str=u.result,u.width+=h,u}};o=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,r.b)()],o);let h=Symbol.for("TextMeasureContribution"),u=class extends o{};u=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,r.b)()],u)},69493:function(t,e,i){"use strict";i.d(e,{X:()=>l});var r=i(17783),s=i(35437),n=i(76620),a=i(8992);let l=class{constructor(){this._uid=s.R.GenAutoIncrementId(),this.viewBox=new n.FB,this.modelMatrix=new a.y(1,0,0,1,0,0)}onChange(t){this._onChangeCb=t}configure(t,e){e.env===this.type&&t.setWindowHandler(this)}release(...t){this.releaseWindow()}isVisible(t){return!0}onVisibleChange(t){}getTopLeft(t){return{top:0,left:0}}setViewBox(t){this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2)}getViewBox(){return this.viewBox}setViewBoxTransform(t,e,i,r,s,n){this.modelMatrix.setValue(t,e,i,r,s,n)}getViewBoxTransform(){return this.modelMatrix}};l=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,r.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],l)},3607:function(t,e,i){"use strict";i.d(e,{H:()=>V});var r=i(30756),s=i(76620),n=i(41457),a=i(52650);let l=Object.prototype.hasOwnProperty,o=(t,e)=>null!=t&&l.call(t,e),h=t=>void 0===t;var u=i(21883),d=i.n(u),c=i(30943),p=i(47382);class g extends p.x{constructor(){super(...arguments),this.client={x:0,y:0},this.movement={x:0,y:0},this.offset={x:0,y:0},this.global={x:0,y:0},this.screen={x:0,y:0}}get clientX(){return this.client.x}get clientY(){return this.client.y}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,r,s,n,a,l,o,h,u,d,c,p,g){throw Error("Method not implemented.")}}class f extends g{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw Error("getPredictedEvents is not supported!")}clone(){var t,e,i;let r=new f(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null==(t=this.manager)||t.copyPointerData(this,r),null==(e=this.manager)||e.copyMouseData(this,r),null==(i=this.manager)||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();let s=this.composedDetailPath();return r.detailPath=s&&s.slice(),r.type=this.type,r}}class m extends g{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}clone(){var t,e,i;let r=new m(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null==(t=this.manager)||t.copyWheelData(this,r),null==(e=this.manager)||e.copyMouseData(this,r),null==(i=this.manager)||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();let s=this.composedDetailPath();return r.detailPath=s&&s.slice(),r.type=this.type,r}}m.DOM_DELTA_PIXEL=0,m.DOM_DELTA_LINE=1,m.DOM_DELTA_PAGE=2;var y=i(60557),_=i(41805);function v(t){return"mouse"===t||"pen"===t}class b{constructor(t,e){this.dispatch=new(d()),this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=(t,e)=>{if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.createPointerEvent(t,t.type,e);if(this.dispatchEvent(i,"pointerdown"),"touch"===i.pointerType)this.dispatchEvent(i,"touchstart");else if(v(i.pointerType)){let t=2===i.button;this.dispatchEvent(i,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=i.composedPath(),this.freeEvent(i)},this.onPointerMove=(t,e)=>{var i,r;if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let s=this.createPointerEvent(t,t.type,e),n=v(s.pointerType),a=this.trackingData(t.pointerId),l=this.findMountedTarget(a.overTargets);if(a.overTargets&&l&&l!==this.rootTarget&&l!==s.target){let e="mousemove"===t.type?"mouseout":"pointerout",i=this.createPointerEvent(t,e,l||void 0);if(this.dispatchEvent(i,"pointerout"),n&&this.dispatchEvent(i,"mouseout"),!s.composedPath().includes(l)){let e=this.createPointerEvent(t,"pointerleave",l||void 0);for(e.eventPhase=e.AT_TARGET;e.target&&!s.composedPath().includes(e.target);)e.currentTarget=e.target,this.notifyTarget(e),n&&this.notifyTarget(e,"mouseleave"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(i)}if(l!==s.target){let e="mousemove"===t.type?"mouseover":"pointerover",i=this.clonePointerEvent(s,e);this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover");let r=null==l?void 0:l.parent;for(;r&&r!==this.rootTarget.parent&&r!==s.target;)r=r.parent;if(!r||r===this.rootTarget.parent){let t=this.clonePointerEvent(s,"pointerenter");t.eventPhase=t.AT_TARGET;let e=t.target,i=new Set,r=l;for(;r&&r!==this.rootTarget;)i.add(r),r=r.parent;for(;e&&e!==l&&e!==this.rootTarget.parent;)i.has(e)||(t.currentTarget=e,this.notifyTarget(t),n&&this.notifyTarget(t,"mouseenter")),e=e.parent;this.freeEvent(t)}this.freeEvent(i)}this.dispatchEvent(s,"pointermove"),"touch"===s.pointerType&&this.dispatchEvent(s,"touchmove"),n&&(this.dispatchEvent(s,"mousemove"),this.cursorTarget=s.target,this.cursor=(null==(r=null==(i=s.target)?void 0:i.attribute)?void 0:r.cursor)||this.rootTarget.getCursor()),a.overTargets=s.composedPath(),this.freeEvent(s)},this.onPointerOver=(t,e)=>{var i,r;if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let s=this.trackingData(t.pointerId),n=this.createPointerEvent(t,t.type,e),a=v(n.pointerType);this.dispatchEvent(n,"pointerover"),a&&this.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(this.cursorTarget=n.target,this.cursor=(null==(r=null==(i=n.target)?void 0:i.attribute)?void 0:r.cursor)||this.rootTarget.getCursor());let l=this.clonePointerEvent(n,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==this.rootTarget.parent;)l.currentTarget=l.target,this.notifyTarget(l),a&&this.notifyTarget(l,"mouseenter"),l.target=l.target.parent;s.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(l)},this.onPointerOut=(t,e)=>{if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.trackingData(t.pointerId);if(i.overTargets){let e=v(t.pointerType),r=this.findMountedTarget(i.overTargets),s=this.createPointerEvent(t,"pointerout",r||void 0);this.dispatchEvent(s),e&&this.dispatchEvent(s,"mouseout");let n=this.createPointerEvent(t,"pointerleave",r||void 0);for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),e&&this.notifyTarget(n,"mouseleave"),n.target=n.target.parent;i.overTargets=[],this.freeEvent(s),this.freeEvent(n)}this.cursorTarget=null,this.cursor=""},this.onPointerUp=(t,e)=>{var i;if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let r=_.m.now(),s=this.createPointerEvent(t,t.type,e);if(this.dispatchEvent(s,"pointerup"),"touch"===s.pointerType)this.dispatchEvent(s,"touchend");else if(v(s.pointerType)){let t=2===s.button;this.dispatchEvent(s,t?"rightup":"mouseup")}let n=this.trackingData(t.pointerId),a=this.findMountedTarget(n.pressTargetsByButton[t.button]),l=a;if(a&&!s.composedPath().includes(a)){let e=a;for(;e&&!s.composedPath().includes(e);){if(s.currentTarget=e,this.notifyTarget(s,"pointerupoutside"),"touch"===s.pointerType)this.notifyTarget(s,"touchendoutside");else if(v(s.pointerType)){let t=2===s.button;this.notifyTarget(s,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete n.pressTargetsByButton[t.button],l=e}if(l){let e=this.clonePointerEvent(s,"click");e.target=l,e.path=[],e.detailPath=[],n.clicksByButton[t.button]||(n.clicksByButton[t.button]={clickCount:0,target:e.target,timeStamp:r});let a=n.clicksByButton[t.button];a.target===e.target&&r-a.timeStamp<(null!=(i=this._config.clickInterval)?i:200)?++a.clickCount:a.clickCount=1,a.target=e.target,a.timeStamp=r,e.detail=a.clickCount,v(e.pointerType)?(this.dispatchEvent(e,"click"),2===a.clickCount&&this.dispatchEvent(e,"dblclick")):"touch"===e.pointerType&&this._config.supportsTouchEvents&&(this.dispatchEvent(e,"tap"),2===a.clickCount&&this.dispatchEvent(e,"dbltap")),this.dispatchEvent(e,"pointertap"),this.freeEvent(e)}this.freeEvent(s)},this.onPointerUpOutside=(t,e)=>{if(!(t instanceof f))return void c.Y.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.trackingData(t.pointerId),r=this.findMountedTarget(i.pressTargetsByButton[t.button]),s=this.createPointerEvent(t,t.type,e);if(r){let e=r;for(;e;)s.currentTarget=e,this.notifyTarget(s,"pointerupoutside"),"touch"===s.pointerType?this.notifyTarget(s,"touchendoutside"):v(s.pointerType)&&this.notifyTarget(s,2===s.button?"rightupoutside":"mouseupoutside"),e=e.parent;delete i.pressTargetsByButton[t.button]}this.freeEvent(s)},this.onWheel=(t,e)=>{if(!(t instanceof m))return void c.Y.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event");let i=this.createWheelEvent(t,e);this.dispatchEvent(i),this.freeEvent(i)},this.rootTarget=t,this.mappingTable={},this._config=Object.assign({clickInterval:200},e),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((t,e)=>t.priority-e.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){var e,i,r,s,n,a,l;let o;if(!this.rootTarget)return;let h=this.mappingTable[t.type],u=`${t.canvasX}-${t.canvasY}`;if((null==(e=this._prePointTargetCache)?void 0:e[u])&&(null==(r=null==(i=this._prePointTargetCache)?void 0:i[u])?void 0:r.stage)&&(null==(n=null==(s=this._prePointTargetCache)?void 0:s[u])?void 0:n.stage.renderCount)===(null==(a=this._prePointTargetCache)?void 0:a.stageRenderCount)?o=this._prePointTargetCache[u]:(o=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache={[u]:o,stageRenderCount:null!=(l=null==o?void 0:o.stage.renderCount)?l:-1})),h)for(let e=0,i=h.length;e<i;e++)h[e].fn(t,o);else c.Y.getInstance().warn(`[EventManager]: Event mapping not defined for ${t.type}`)}propagate(t,e){if(!t.target)return;let i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,s=i.length-1;r<s;r++)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}propagationPath(t){let e=[t];for(let i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}notifyTarget(t,e){if(this.pauseNotify)return;e=null!=e?e:t.type;let i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){var r,s;let n=this.allocateEvent(f);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=i||this.pickTarget(null!=(r=n.viewX)?r:n.global.x,null!=(s=n.viewY)?s:n.global.y,n),"string"==typeof e&&(n.type=e),n}createWheelEvent(t,e){var i,r;let s=this.allocateEvent(m);return this.copyWheelData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=e||this.pickTarget(null!=(i=s.viewX)?i:s.global.x,null!=(r=s.viewY)?r:s.global.y,s),s}clonePointerEvent(t,e){let i=this.allocateEvent(f);i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice();let r=t.composedDetailPath();return i.detailPath=r&&r.slice(),i.type=null!=e?e:i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof f&&e instanceof f&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof g&&e instanceof g&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach(i=>{e[i].x=t[i].x,e[i].y=t[i].y}))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=_.m.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);let i=(null==(e=this.eventPool.get(t))?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.detailPath=[],i.target=null,i}freeEvent(t){var e;if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventManager!");let i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),null==(e=this.eventPool.get(i))||e.push(t)}notifyListeners(t,e){let i=t.currentTarget._events[e];if(i)if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(let r=0,s=i.length;r<s&&!t.propagationImmediatelyStopped;r++)i[r].once&&t.currentTarget.removeEventListener(e,i[r].fn,{once:!0}),i[r].fn.call(i[r].context,t);this.emitDelegation(t,e)}emitDelegation(t,e){let i=t.currentTarget._events[y.g];if(i)if("fn"in i)i.fn.call(i.context,t,e);else for(let r=0,s=i.length;r<s&&!t.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,t,e)}pickTarget(t,e,i){let r,s=this.rootTarget.pick(t,e);return r=s&&s.graphic?s.graphic:s&&s.group?s.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=s.params),r}release(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}}let x={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class S{constructor(t){this.resolution=1,this.onPointerDown=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(!t.cancelable&&"cancelable"in t||t.preventDefault());for(let t=0,i=e.length;t<i;t++){let i=e[t],r=this.bootstrapEvent(this.rootPointerEvent,i);this.manager.mapEvent(r)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerMove=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType||this.isEventOutsideOfTargetElement(t))return;let e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){let i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.manager.mapEvent(i)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerUp=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.isEventOutsideOfTargetViewPort(t)?"outside":"",i=this.normalizeToPointerData(t);for(let t=0,r=i.length;t<r;t++){let r=this.bootstrapEvent(this.rootPointerEvent,i[t]);r.type+=e,this.manager.mapEvent(r)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerOverOut=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){let i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.manager.mapEvent(i)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onWheel=t=>{let e=this.normalizeWheelEvent(t);this.manager.mapEvent(e)};let{targetElement:e,resolution:i,rootNode:r,global:s,autoPreventDefault:n=!1,clickInterval:a,supportsTouchEvents:l=s.supportsTouchEvents,supportsPointerEvents:o=s.supportsPointerEvents}=t;this.manager=new b(r,{clickInterval:a,supportsTouchEvents:l}),this.globalObj=s,this.supportsPointerEvents=o,this.supportsTouchEvents=l,this.supportsMouseEvents=s.supportsMouseEvents,this.applyStyles=s.applyStyles,this.autoPreventDefault=n,this.eventsAdded=!1,this.rootPointerEvent=new f,this.rootWheelEvent=new m,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=i,this.setTargetElement(e)}release(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}setCursor(t,e){if(!e&&!this.manager.rootTarget.window._handler.canvas.controled)return;t||(t="default");let{applyStyles:i,domElement:s}=this;if(this.currentCursor===t)return;this.currentCursor=t;let n=this.cursorStyles[t];n?"string"==typeof n&&i?s.style.cursor=n:"function"==typeof n?n(t):"object"==typeof n&&i&&Object.assign(s.style,n):i&&(0,r.Z)(t)&&!o(this.cursorStyles,t)&&(s.style.cursor=t)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;let{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.addEventListener("pointermove",this.onPointerMove,!0),t.addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.addEventListener("mousemove",this.onPointerMove,!0),t.addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;let{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.removeEventListener("pointermove",this.onPointerMove,!0),t.removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.removeEventListener("mousemove",this.onPointerMove,!0),t.removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapToViewportPoint(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}mapToCanvasPoint(t){var e,i;let r=null==(e=this.globalObj)?void 0:e.mapToCanvasPoint(t,this.domElement);if(r)return r;let s=0,n=0;if(t.changedTouches){let e=null!=(i=t.changedTouches[0])?i:{};s=e.clientX||0,n=e.clientY||0}else s=t.clientX||0,n=t.clientY||0;let a=this.domElement.getBoundingClientRect();return{x:s-a.left,y:n-a.top}}normalizeToPointerData(t){let e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(let i=0,r=t.changedTouches.length;i<r;i++){let r=t.changedTouches[i];h(r.button)&&(r.button=0),h(r.buttons)&&(r.buttons=1),h(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),h(r.width)&&(r.width=r.radiusX||1),h(r.height)&&(r.height=r.radiusY||1),h(r.tiltX)&&(r.tiltX=0),h(r.tiltY)&&(r.tiltY=0),h(r.pointerType)&&(r.pointerType="touch"),h(r.pointerId)&&(r.pointerId=r.identifier||0),h(r.pressure)&&(r.pressure=r.force||.5),h(r.twist)&&(r.twist=0),h(r.tangentialPressure)&&(r.tangentialPressure=0),h(r.layerX)&&(r.layerX=r.offsetX=r.clientX),h(r.layerY)&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else this.globalObj.supportsMouseEvents&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof PointerEvent)||(h(t.isPrimary)&&(t.isPrimary=!0),h(t.width)&&(t.width=1),h(t.height)&&(t.height=1),h(t.tiltX)&&(t.tiltX=0),h(t.tiltY)&&(t.tiltY=0),h(t.pointerType)&&(t.pointerType="mouse"),h(t.pointerId)&&(t.pointerId=1),h(t.pressure)&&(t.pressure=.5),h(t.twist)&&(t.twist=0),h(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),e.push(t);return e}normalizeWheelEvent(t){let e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;let{x:i,y:r}=this.mapToCanvasPoint(t);e.canvas.x=i,e.canvas.y=r,e.global.x=i,e.global.y=r,e.offset.x=i,e.offset.y=r;let{x:s,y:n}=this.mapToViewportPoint(e);return e.viewport.x=s,e.viewport.y=n,e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);let{x:i,y:r}=this.mapToCanvasPoint(e);t.canvas.x=i,t.canvas.y=r,t.global.x=i,t.global.y=r,t.offset.x=i,t.offset.y=r;let{x:s,y:n}=this.mapToViewportPoint(t);return t.viewport.x=s,t.viewport.y=n,t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=x[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=_.m.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}isEventOutsideOfTargetViewPort(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){let e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),i=this.domElement.getViewBox(),r=i.width(),s=i.height();return!(e.x<r&&e.y<s&&e.x>0&&e.y>0)}return!1}isEventOutsideOfTargetElement(t){let e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}pauseTriggerEvent(){this.manager.pauseNotify=!0}resumeTriggerEvent(){this.manager.pauseNotify=!1}}var k=i(93279),A=i(18346),M=i(53068),w=i(46560),T=i(85074),C=i(66838),E=i(35437);class B{constructor(){this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=E.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t;let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),e.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),e.graphicService.hooks.onRemove.tap(this.key,this.handleChange))}deactivate(t){let e=t=>t.filter(t=>t.name!==this.key),i=this.pluginService.stage;i&&(i.graphicService.hooks.onAttributeUpdate.taps=e(i.graphicService.hooks.onAttributeUpdate.taps),i.graphicService.hooks.onSetStage.taps=e(i.graphicService.hooks.onSetStage.taps),i.graphicService.hooks.onRemove.taps=e(i.graphicService.hooks.onRemove.taps))}}var P=i(96087);class O{constructor(){this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=E.R.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t,this.dpr=P.w.global.devicePixelRatio,this.refresh()}refresh(){this._refreshByMediaQuery()||this._refreshByRaf()}_refreshByRaf(){let t=P.w.global.getRequestAnimationFrame();this.rafId=t(()=>{P.w.global.devicePixelRatio!==this.dpr&&(this.dpr=P.w.global.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0)),this.refresh()})}_refreshByMediaQuery(){try{let t=`(resolution: ${window.devicePixelRatio}dppx)`,e=()=>{window.devicePixelRatio!==this.dpr&&(this.dpr=window.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0))},i=matchMedia(t);i&&i.addEventListener("change",e),this.autoRefreshCbs||(this.autoRefreshCbs=[]),this.autoRefreshCbs.push(()=>{i&&i.removeEventListener("change",e)})}catch(t){return!1}return!0}deactivate(t){var e;let i=P.w.global.getCancelAnimationFrame();i&&this.rafId&&i(this.rafId),null==(e=this.autoRefreshCbs)||e.forEach(t=>{t()}),this.autoRefreshCbs=void 0}}class I{constructor(){this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=E.R.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t;let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.tap(this.key,(e,i,r)=>{e.glyphHost&&(e=e.glyphHost),e.stage===t.stage&&null!=e.stage&&(this.nextUserParams.startAtId=i._uid,this.renderNextFrame(i))}),e.graphicService.hooks.onClearIncremental.tap(this.key,(e,i)=>{e.stage===t.stage&&null!=e.stage&&(this.nextUserParams.startAtId=e._uid,this.nextUserParams.restartIncremental=!0,this.renderNextFrame(e))}))}deactivate(t){let e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.taps=e.graphicService.hooks.onAddIncremental.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.onClearIncremental.taps=e.graphicService.hooks.onClearIncremental.taps.filter(t=>t.name!==this.key))}renderNextFrame(t){this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,P.w.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){let t=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach(e=>{let i=e.layer;if(!i||!e.layer.subLayers)return;let r=e.layer.subLayers.get(e._uid);r&&r.drawContribution&&r.drawContribution.draw(t.renderService,Object.assign({stage:t,layer:i,viewBox:t.window.getViewBox(),transMatrix:t.window.getViewBoxTransform(),clear:"transparent",renderService:t.renderService,updateBounds:!1,startAtId:e._uid,context:r.layer.getNativeHandler().getContext()},this.nextUserParams))}),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}let R=new s.FB;class L{constructor(){this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=E.R.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,t=>{t&&t===this.pluginService.stage&&t.dirtyBounds.clear()});let e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(t,e,i,r)=>{t.glyphHost&&(t=t.glyphHost),e&&e===this.pluginService.stage&&e.renderCount&&(t.isContainer&&!t.shouldSelfChangeUpdateAABBBounds()||i&&(R.setValue(r.x1,r.y1,r.x2,r.y2),e.dirty(R,t.parent&&t.parent.globalTransMatrix)))}),e.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(t,e,i,r,s)=>{e&&e===this.pluginService.stage&&e.renderCount&&(t.isContainer&&!s||e.dirty(r.globalAABBBounds))}),e.graphicService.hooks.clearAABBBounds.tap(this.key,(t,e,i)=>{e&&e===this.pluginService.stage&&e.renderCount&&e&&e.dirty(i)}),e.graphicService.hooks.onRemove.tap(this.key,t=>{let e=t.stage;e&&e===this.pluginService.stage&&e.renderCount&&e&&e.dirty(t.globalAABBBounds)}))}deactivate(t){let e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.taps=e.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.afterUpdateAABBBounds.taps=e.graphicService.hooks.afterUpdateAABBBounds.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.clearAABBBounds.taps=e.graphicService.hooks.clearAABBBounds.taps.filter(t=>t.name!==this.key),e.hooks.afterRender.taps=e.hooks.afterRender.taps.filter(t=>t.name!==this.key),e.graphicService.hooks.onRemove.taps=e.graphicService.hooks.onRemove.taps.filter(t=>t.name!==this.key))}}var D=i(20420),F=i(69507),z=i(46710),j=i(66778),H=i(27177);let N={BACKGROUND:"white"};class V extends M.ZA{set viewBox(t){this.window.setViewBox(t)}get viewBox(){return this.window.getViewBox()}get x(){return this.window.getViewBox().x1}set x(t){let e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}get y(){return this.window.getViewBox().y1}set y(t){let e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}get width(){return this.window.width}set width(t){this.resize(t,this.height)}get viewWidth(){return this.window.getViewBox().width()}set viewWidth(t){this.resizeView(t,this.viewHeight)}get viewHeight(){return this.window.getViewBox().height()}set viewHeight(t){this.resizeView(this.viewWidth,t)}get height(){return this.window.height}set height(t){this.resize(this.width,t)}get dpr(){return this.window.dpr}set dpr(t){this.setDpr(t)}get background(){var t;return null!=(t=this._background)?t:N.BACKGROUND}set background(t){this._background=t}get defaultLayer(){return this.at(0)}get eventSystem(){return this._eventSystem}get ticker(){return this._ticker}set ticker(t){t.bindStage(this),this._ticker&&this._ticker.removeListener("tick",this.afterTickCb),t.addTimeline(this.timeline),this._ticker=t,this._ticker.on("tick",this.afterTickCb)}constructor(t={}){var e,i;super({}),this.tickedBeforeRender=!0,this._onVisibleChange=t=>{if(!(this._skipRender<0))if(t){if(this.dirtyBounds){let t=this.window.getViewBox();this.dirtyBounds.setValue(t.x1,t.y1,t.width(),t.height())}this._skipRender>1&&this.renderNextFrame(),this._skipRender=0}else this._skipRender=1},this.beforeRender=t=>{this._beforeRender&&this._beforeRender(t)},this.afterClearScreen=t=>{this._afterClearScreen&&this._afterClearScreen(t)},this.afterClearRect=t=>{this._afterClearRect&&this._afterClearRect(t)},this.afterRender=t=>{this.renderCount++,this._afterRender&&this._afterRender(t),this._afterNextRenderCbs&&this._afterNextRenderCbs.forEach(e=>e(t)),this._afterNextRenderCbs=null,this.tickedBeforeRender=!1},this.afterTickCb=()=>{this.tickedBeforeRender=!0,"rendering"!==this.state&&this.renderNextFrame()},this.params=t,this.theme=new w.Q2,this.hooks={beforeRender:new D.n(["stage"]),afterRender:new D.n(["stage"]),afterClearScreen:new D.n(["stage"]),afterClearRect:new D.n(["stage"])},this.global=P.w.global,!this.global.env&&(0,z.kP)()&&this.global.setEnv("browser"),this.window=k.n.get(a.Oo),this.renderService=k.n.get(A.pi),this.pluginService=k.n.get(C.H),this.layerService=k.n.get(F.IT),this.graphicService=k.n.get(H.fB),this.pluginService.active(this,t),this.window.create({width:t.width,height:t.height,viewBox:t.viewBox,container:t.container,dpr:t.dpr||this.global.devicePixelRatio,canvasControled:!1!==t.canvasControled,title:t.title||"",canvas:t.canvas}),this.state="normal",this.renderCount=0,this.tryInitEventSystem(),this._background=null!=(e=t.background)?e:N.BACKGROUND,this.appendChild(this.layerService.createLayer(this,{main:!0})),this.nextFrameRenderLayerSet=new Set,this.willNextFrameRender=!1,this.stage=this,this.renderStyle=t.renderStyle,t.autoRender&&this.enableAutoRender(),t.autoRefresh&&this.enableAutoRefresh(),!1===t.disableDirtyBounds&&this.enableDirtyBounds(),t.enableHtmlAttribute&&this.enableHtmlAttribute(t.enableHtmlAttribute),t.ReactDOM&&this.enableReactAttribute(t.ReactDOM),t.enableLayout&&this.enableLayout(),this.hooks.beforeRender.tap("constructor",this.beforeRender),this.hooks.afterRender.tap("constructor",this.afterRender),this.hooks.afterClearScreen.tap("constructor",this.afterClearScreen),this.hooks.afterClearRect.tap("constructor",this.afterClearRect),this._beforeRender=t.beforeRender,this._afterRender=t.afterRender,this._afterClearScreen=t.afterClearScreen,this._afterClearRect=t.afterClearRect,this.supportInteractiveLayer=!1!==t.interactiveLayer,t.optimize||(t.optimize={tickRenderMode:"effect"}),this.optmize(t.optimize),t.background&&(0,r.Z)(this._background)&&this._background.includes("/")&&this.setAttributes({background:this._background}),this.initAnimate(t),this.rafId=null!=(i=t.rafId)?i:Math.floor(6*Math.random())}initAnimate(t){var e;this.createTicker&&this.createTimeline&&(this._ticker=t.ticker||this.createTicker(this),this._ticker.bindStage(this),"performance"===(null==(e=this.params.optimize)?void 0:e.tickRenderMode)&&this._ticker.setFPS(30),this.timeline=this.createTimeline(),this._ticker.addTimeline(this.timeline),this._ticker.on("tick",this.afterTickCb))}startAnimate(){this._ticker&&this.timeline&&(this._ticker.start(),this.timeline.resume())}pauseRender(t=-1){this._skipRender=t}resumeRender(){this._skipRender=0}tryInitEventSystem(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new S(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}preventRender(t){t?this._skipRender=-1/0:!1!==this.params.optimize.skipRenderWithOutRange?this._skipRender=+!this.window.isVisible():this._skipRender=0}optmize(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}optmizeRender(t=!1){t&&(this._skipRender=this._skipRender<0?this._skipRender:+!this.window.isVisible(),this.window.onVisibleChange(this._onVisibleChange))}getTimeline(){return this.timeline}get3dOptions(t){let{center:e={x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0},light:i={},alpha:r=0,beta:s=0,camera:n,fieldRatio:a=1,fieldDepth:l}=t;return Object.assign(Object.assign({},t),{center:e,light:i,alpha:r,beta:s,camera:n,fieldRatio:a,fieldDepth:l})}set3dOptions(t){var e,i,r,s,n,a;this.option3d=t;let{light:l,center:o,camera:h,alpha:u,beta:d,fieldRatio:c,fieldDepth:p}=this.get3dOptions(t),{dir:g=[1,1,-1],color:f="white",ambient:m}=l,y=(null!=(e=o.x)?e:this.width/2)+(null!=(i=o.dx)?i:0),_=(null!=(r=o.y)?r:this.height/2)+(null!=(s=o.dy)?s:0),v=[y,_,(null!=(n=o.z)?n:0)+(null!=(a=o.dz)?a:0)],b=0,x=0,S=0;h||(b=Math.sin(u)+y,x=Math.sin(d)+_,S=Math.cos(u)*Math.cos(d)*1);let k=j.F.getPlugin("DirectionalLight");k&&(this.light=new k(g,f,m));let A={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:c,fieldDepth:p,viewParams:{pos:[b,x,S],center:v,up:[0,1,0]}};if(this.camera)this.camera.params=A;else{let t=j.F.getPlugin("OrthoCamera");t&&(this.camera=new t(A))}t.enableView3dTransform&&this.enableView3dTransform()}setBeforeRender(t){this._beforeRender=t}setAfterRender(t){this._afterRender=t}afterNextRender(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}enableView3dTransform(){if(this.view3dTranform)return;this.view3dTranform=!0;let t=j.F.getPlugin("ViewTransform3dPlugin");t&&this.pluginService.register(new t)}disableView3dTranform(){this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRender(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new B))}disableAutoRender(){this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRefresh(){this.autoRefresh||(this.autoRefresh=!0,this.pluginService.register(new O))}disableAutoRefresh(){this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableIncrementalAutoRender(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new I))}disableIncrementalAutoRender(){this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableDirtyBounds(){if(this.dirtyBounds)return;this.dirtyBounds=new s.YZ;let t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new L,this.pluginService.register(t))}disableDirtyBounds(){this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableLayout(){if(this._enableLayout)return;this._enableLayout=!0;let t=j.F.getPlugin("FlexLayoutPlugin");t&&this.pluginService.register(new t)}disableLayout(){this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableHtmlAttribute(t){if(this.htmlAttribute)return;let e=j.F.getPlugin("HtmlAttributePlugin");e&&(this.htmlAttribute=t,this.pluginService.register(new e))}disableHtmlAttribute(){this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableReactAttribute(t){if(this.reactAttribute)return;let e=j.F.getPlugin("ReactAttributePlugin");e&&(this.reactAttribute=t,this.pluginService.register(new e))}disableReactAttribute(){this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}getPluginsByName(t){return this.pluginService.findPluginsByName(t)}tryUpdateAABBBounds(){let t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}combineLayer(t,e){throw Error("暂不支持")}createLayer(t,e){if("released"===this.releaseStatus)return;let i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}sortLayer(t){let e=this.children;e.sort(t),this.removeAllChild(),e.forEach(t=>{this.appendChild(t)})}removeLayer(t){return this.removeChild(this.findChildByUid(t))}tryInitInteractiveLayer(){"released"!==this.releaseStatus&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}clearViewBox(t){this.window.clearViewBox(t)}render(t,e){if("released"===this.releaseStatus)return;this.startAnimate();let i=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}combineLayersToWindow(){if("harmony"===this.global.env){let t=this.window.getContext().nativeContext;this.forEachChildren((e,i)=>{if(i>0){let i=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(i)}})}}renderNextFrame(t,e){this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach(t=>{this.nextFrameRenderLayerSet.add(t)}),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getSpecifiedRequestAnimationFrame(this.rafId)(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){if("released"===this.releaseStatus)return;this.startAnimate();let t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}renderLayerList(t,e){let i=[];for(let e=0;e<t.length;e++){let r=t[e];"virtual"===r.layerMode&&(r=r.getNativeHandler().mainHandler.layer),i.includes(r)||i.push(r)}i.forEach(t=>{t.renderCount>this.renderCount||(t.renderCount=this.renderCount+1,t===this.interactiveLayer&&this.dirtyBounds&&this.dirtyBounds.clear(),t.render({renderService:this.renderService,background:t===this.defaultLayer?this.background:void 0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}resizeWindow(t,e,i=!0){this.window.resize(t,e),i&&this.render()}resize(t,e,i=!0){"released"!==this.releaseStatus&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren(i=>{i.resize(t,e)}),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render())}resizeView(t,e,i=!0){"released"!==this.releaseStatus&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren(i=>{i.resizeView(t,e)}),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render())}setViewBox(t,e,i,r,s){let n=!0;"object"==typeof t?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),!1===e&&(n=!1)):(this.viewBox.setValue(t,e,t+i,e+r),!1===s&&(n=!1)),this.forEachChildren(t=>{t.resizeView(this.viewBox.width(),this.viewBox.height())}),n&&this.render()}setDpr(t,e=!0){this.forEachChildren(e=>{e.setDpr(t)}),e&&this.render()}setOrigin(t,e){throw Error("暂不支持")}export(t){throw Error("暂不支持")}pick(t,e){if("released"===this.releaseStatus)return;let i=this.getPickerService().pick(this.children,new n.E9(t,e),{bounds:this.AABBBounds});return!(!(null==i?void 0:i.graphic)&&!(null==i?void 0:i.group))&&i}setToFrame(t){throw Error("暂不支持")}release(){var t,e;super.release(),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach(t=>{t.release()}),this.interactiveLayer&&(this.interactiveLayer.forEachChildren(t=>{t.setStage&&t.setStage(null,null),this.interactiveLayer.removeChild(t)}),this.interactiveLayer.release()),this.window.release(),null==(t=this._ticker)||t.remTimeline(null==this?void 0:this.timeline),null==(e=this._ticker)||e.removeListener("tick",this.afterTickCb),this.renderService.renderTreeRoots=[]}setStage(t){}dirty(t,e){"released"!==this.releaseStatus&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}getLayer(t){return this.children.filter(e=>e.name===t)[0]}renderTo(t){"released"!==this.releaseStatus&&this.forEachChildren((e,i)=>{e.drawTo(t,{renderService:this.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:e===this.defaultLayer?this.background:void 0,clear:0===i,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())})})}renderToNewWindow(t=!0,e){if("released"===this.releaseStatus)return;let i=k.n.get(a.Oo),r=e?-e.x1:0,s=e?-e.y1:0,n=e?e.x2:this.viewWidth,l=e?e.y2:this.viewHeight,o=e?e.width():this.viewWidth,h=e?e.height():this.viewHeight;return i.create({viewBox:{x1:r,y1:s,x2:n,y2:l},width:o,height:h,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(i),i}toCanvas(t=!0,e){if("released"===this.releaseStatus)return;let i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}setCursor(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}getCursor(){return this._cursor}eventPointTransform(t){let e=this.global.mapToCanvasPoint(t,this.window);return this.stage.window.pointTransform(e.x,e.y)}pauseTriggerEvent(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}resumeTriggerEvent(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}getPickerService(){return this.pickerService||(this.pickerService=k.n.get(T.hH)),this.pickerService}reInit(){this.renderService.reInit(),this.pickerService.reInit()}}},52650:function(t,e,i){"use strict";i.d(e,{Il:()=>c,Oo:()=>u,zd:()=>d});var r=i(17783),s=i(25258),n=i(35437),a=i(93279),l=i(20420),o=i(96087),h=i(65323);let u=Symbol.for("VWindow"),d=Symbol.for("WindowHandlerContribution"),c=class extends h.w{get width(){if(this._handler){let t=this._handler.getWH();return this._width=t.width}return this._width}get height(){if(this._handler){let t=this._handler.getWH();return this._height=t.height}return this._height}get dpr(){return this._handler.getDpr()}constructor(){super(),this.hooks={onChange:new l.n(["x","y","width","height"])},this.active=()=>{let t=this.global;t.env&&!this.actived&&(a.n.getNamed(d,t.env).configure(this,t),this.actived=!0)},this._uid=n.R.GenAutoIncrementId(),this.global=o.w.global,this.postInit()}_nativeAddEventListener(t,e,i){return this._handler.addEventListener(t,e,i)}_nativeRemoveEventListener(t,e,i){return this._handler.removeEventListener(t,e,i)}_nativeDispatchEvent(t){return this._handler.dispatchEvent(t)}postInit(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}get style(){var t;return null!=(t=this._handler.getStyle())?t:{}}set style(t){this._handler.setStyle(t)}create(t){var e,i;this._handler.createWindow(t);let r=this._handler.getWH();this._width=r.width,this._height=r.height,t.viewBox?this.setViewBox(t.viewBox):!1!==t.canvasControled?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:null!=(e=t.width)?e:this._width,y2:null!=(i=t.height)?i:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}setWindowHandler(t){this._handler=t}setDpr(t){return this._handler.setDpr(t)}resize(t,e){return this._handler.resizeWindow(t,e)}configure(){throw Error("暂不支持")}release(){return this.global.hooks.onSetEnv.unTap("window",this.active),this.clearAllEventListeners(),this._handler.releaseWindow()}getContext(){return this._handler.getContext()}getNativeHandler(){return this._handler.getNativeHandler()}getImageBuffer(t){return this._handler.getImageBuffer?this._handler.getImageBuffer(t):null}getBoundingClientRect(){return this._handler.getBoundingClientRect()}getContainer(){return this._handler.container}clearViewBox(t){this._handler.clearViewBox(t)}setViewBox(t){this._handler.setViewBox(t)}setViewBoxTransform(t,e,i,r,s,n){this._handler.setViewBoxTransform(t,e,i,r,s,n)}getViewBox(){return this._handler.getViewBox()}getViewBoxTransform(){return this._handler.getViewBoxTransform()}pointTransform(t,e){let i=this._handler.getViewBox(),r={x:t,y:e};return this._handler.getViewBoxTransform().transformPoint({x:t,y:e},r),r.x-=i.x1,r.y-=i.y1,r}hasSubView(){let t=this._handler.getViewBox();return!(0===t.x1&&0===t.y1&&(0,s.Yt)(this.width,t.width())&&(0,s.Yt)(this.height,t.height()))}isVisible(t){return this._handler.isVisible(t)}onVisibleChange(t){return this._handler.onVisibleChange(t)}getTopLeft(t){return this._handler.getTopLeft(t)}};c=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,r.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],c)},46710:function(t,e,i){"use strict";let r;i.d(e,{KV:()=>l,kP:()=>a});var s=i(96087);function n(){if(null==r)try{let t=document.createElement("canvas"),e=t.getContext("2d");(r=!!(window&&t.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&e&&e.isPointInPath&&e.isPointInStroke))&&(r=!!document.createElement)}catch(t){r=!1}}function a(){n();let t=s.w.global&&s.w.global.env;return t?"browser"===t:r}function l(){n();let t=s.w.global&&s.w.global.env;return t?"node"===t:!r}},60557:function(t,e,i){"use strict";i.d(e,{g:()=>r});let r="*"},47382:function(t,e,i){"use strict";i.d(e,{x:()=>s});var r=i(98116);class s{get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get x(){return this.canvas.x}get y(){return this.canvas.y}get canvasX(){return this.canvas.x}get canvasY(){return this.canvas.y}get viewX(){return this.viewport.x}get viewY(){return this.viewport.y}constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=s.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}composedDetailPath(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}_composedDetailPath(t){if(t&&t.graphic){let e=t.graphic;if(e.stage){let i=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(i),this._composedDetailPath(t.params)}}}preventDefault(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch(t){this.nativeEvent.preventDefault&&(0,r.Z)(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch(t){this.nativeEvent.stopPropagation&&(0,r.Z)(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}initEvent(){}initUIEvent(){}clone(){throw Error("Method not implemented.")}}},99014:function(t,e,i){"use strict";i.d(e,{A:()=>s});var r=i(47382);class s extends r.x{constructor(t,e){super(),this.type=t,this.detail=e}}},41805:function(t,e,i){"use strict";i.d(e,{m:()=>r});let r="object"==typeof performance&&performance.now?performance:Date},66778:function(t,e,i){"use strict";i.d(e,{F:()=>r});class r{static registerPlugin(t,e){r._pluginClasses[t]=e}static getPlugin(t){return r._pluginClasses[t]}}r._pluginClasses={}},11971:function(t,e,i){"use strict";i.d(e,{Q:()=>m,w:()=>f});var r=i(45273),s=i(31535),n=i(98706),a=i(88504),l=i(33430),o=i(78388),h=i(37967),u=i(46560),d=i(96087),c=i(27177),p=i(41923);let g=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap",...l.DH];class f extends l.zs{constructor(t){super(t),this.type="arc",this.numberType=c.r_}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{startAngle:t,endAngle:e,outerRadius:i,innerRadius:r}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)&&this._validNumber(r)}getParsedCornerRadius(){let t=this.getGraphicTheme(),{cornerRadius:e=t.cornerRadius,innerPadding:i=t.innerPadding,outerPadding:n=t.outerPadding}=this.attribute,{outerRadius:a=t.outerRadius,innerRadius:l=t.innerRadius}=this.attribute;if(a+=n,l-=i,0===e||"0%"===e)return 0;let o=Math.abs(a-l),h=t=>Math.min((0,r.Z)(t,!0)?t:o*parseFloat(t)/100,o/2);if((0,s.Z)(e)){let t=e.map(t=>h(t)||0);return 0===t.length?[t[0],t[0],t[0],t[0]]:2===t.length?[t[0],t[1],t[0],t[1]]:(3===t.length&&t.push(0),t)}return h(e)}getParsedAngle(){let t=this.getGraphicTheme(),{startAngle:e=t.startAngle,endAngle:i=t.endAngle}=this.attribute,{cap:r=t.cap}=this.attribute,s=i-e>=0?1:-1,l=i-e;if(i=(e=(0,n.gt)(e))+l,r&&(0,a.Wn)(l)<a.f7-a.Ho){let n=1,l=1;r.length&&(n=Number(r[0]),l=Number(r[1]));let{outerRadius:o=t.outerRadius,innerRadius:h=t.innerRadius}=this.attribute,{outerPadding:u=t.outerPadding,innerPadding:d=t.innerPadding}=this.attribute,c=Math.abs((o+=u)-(h-=d))/2,p=c/o;if(c>a.Ho&&o>a.Ho)return{startAngle:e-s*p*n,endAngle:i+s*p*l,sc:s*p*n,ec:s*p*l}}return{startAngle:e,endAngle:i}}getParsePadAngle(t,e){let i=this.getGraphicTheme(),{innerPadding:r=i.innerPadding,outerPadding:s=i.outerPadding,padAngle:n=i.padAngle}=this.attribute,{outerRadius:l=i.outerRadius,innerRadius:o=i.innerRadius}=this.attribute;l+=s,o-=r;let{padRadius:h=(0,a._b)(l*l+o*o)}=this.attribute,u=(0,a.Wn)(e-t),d=t,c=e,p=t,g=e,f=n/2,m=u,y=u;if(f>a.Ho&&h>a.Ho){let i=e>t?1:-1,r=(0,a.ZR)(Number(h)/o*(0,a.O$)(f)),s=(0,a.ZR)(Number(h)/l*(0,a.O$)(f));return(m-=2*r)>a.Ho?(r*=i,p+=r,g-=r):(m=0,p=g=(t+e)/2),(y-=2*s)>a.Ho?(s*=i,d+=s,c-=s):(y=0,d=c=(t+e)/2),{outerStartAngle:d,outerEndAngle:c,innerStartAngle:p,innerEndAngle:g,innerDeltaAngle:m,outerDeltaAngle:y}}return{outerStartAngle:d,outerEndAngle:c,innerStartAngle:p,innerEndAngle:g,innerDeltaAngle:m,outerDeltaAngle:y}}getGraphicTheme(){return(0,u.gh)(this).arc}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateArcAABBBoundsImprecise(t,e,i):this.updateArcAABBBoundsAccurate(t,e,i));let{tb1:s,tb2:n}=d.w.graphicService.updateTempAABBBounds(i);(0,p.E)(t,e,s),i.union(s),s.setValue(n.x1,n.y1,n.x2,n.y2),this.setWidthHeightWithoutTransform(i);let{lineJoin:a=e.lineJoin}=t;return d.w.graphicService.transformAABBBounds(t,i,e,"miter"===a,this),i}updateArcAABBBoundsImprecise(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:s=e.innerRadius}=t,{outerPadding:n=e.outerPadding,innerPadding:a=e.innerPadding}=t;return(r+=n)<(s-=a)&&(r=s),i.set(-r,-r,r,r),i}updateArcAABBBoundsAccurate(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:s=e.innerRadius}=t,{outerPadding:n=e.outerPadding,innerPadding:l=e.innerPadding}=t;if((r+=n)<(s-=l)){let t=r;r=s,s=t}let{endAngle:o=e.endAngle,startAngle:u=e.startAngle}=t;if(u>o){let t=u;u=o,o=t}return r<=a.Ho?i.set(0,0,0,0):Math.abs(o-u)>a.f7-a.Ho?i.set(-r,-r,r,r):((0,h.jx)(u,o,r,i),(0,h.jx)(u,o,s,i)),i}needUpdateTags(t){return super.needUpdateTags(t,g)}needUpdateTag(t){return super.needUpdateTag(t,g)}toCustomPath(){var t,e,i,r;let s=super.toCustomPath();if(s)return s;let n=this.attribute,{startAngle:l,endAngle:h}=this.getParsedAngle(),u=(null!=(t=n.innerRadius)?t:0)-(null!=(e=n.innerPadding)?e:0),d=(null!=(i=n.outerRadius)?i:0)-(null!=(r=n.outerPadding)?r:0),c=(0,a.Wn)(h-l),p=h>l;if(d<u){let t=d;d=u,u=t}if(s=new o.r,d<=a.Ho)s.moveTo(0,0);else if(c>=a.f7-a.Ho)s.moveTo(0+d*(0,a.mC)(l),0+d*(0,a.O$)(l)),s.arc(0,0,d,l,h,!p),u>a.Ho&&(s.moveTo(0+u*(0,a.mC)(h),0+u*(0,a.O$)(h)),s.arc(0,0,u,h,l,p));else{let t=d*(0,a.mC)(l),e=d*(0,a.O$)(l),i=u*(0,a.mC)(h),r=u*(0,a.O$)(h);s.moveTo(0+t,0+e),s.arc(0,0,d,l,h,!p),s.lineTo(0+i,0+r),s.arc(0,0,u,h,l,p),s.closePath()}return s}clone(){return new f(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return f.NOWORK_ANIMATE_ATTR}}function m(t){return new f(t)}f.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},l.Wl)},82794:function(t,e,i){"use strict";let r,s;i.d(e,{X:()=>l,o:()=>a});var n=i(20672);function a(t){return r||(r=n.i.CreateGraphic("text",{})),r.initAttributes(t),r.AABBBounds}function l(t){return s||(s=n.i.CreateGraphic("richtext",{})),s.setAttributes(t),s.AABBBounds}},26635:function(t,e,i){"use strict";i.d(e,{g6:()=>ta,SR:()=>tl});var r=i(88504),s=i(45273);class n{bounds(t,e){if((0,s.Z)(t)){let i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}parseSize(t){return(0,s.Z)(t)?t:Math.min(t[0],t[1])}}function a(t,e,i,s,n){return n?t.arc(i,s,e,0,r.BZ,!1,n):t.arc(i,s,e,0,r.BZ),!1}let l=new class extends n{constructor(){super(...arguments),this.type="circle",this.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0"}draw(t,e,i,r,s){return a(t,this.parseSize(e)/2,i,r,s)}drawOffset(t,e,i,r,s,n){return a(t,this.parseSize(e)/2+s,i,r,n)}drawToSvgPath(t,e,i,r){let s=this.parseSize(t)/2;return`M ${e-s}, ${i} a ${s},${s} 0 1,0 ${2*s},0 a ${s},${s} 0 1,0 -${2*s},0`}},o=new class extends n{constructor(){super(...arguments),this.type="cross",this.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z"}draw(t,e,i,r,s){var n;return n=this.parseSize(e)/6,t.moveTo(-3*n+i,-n+r,s),t.lineTo(-n+i,-n+r,s),t.lineTo(-n+i,-3*n+r,s),t.lineTo(n+i,-3*n+r,s),t.lineTo(n+i,-n+r,s),t.lineTo(3*n+i,-n+r,s),t.lineTo(3*n+i,n+r,s),t.lineTo(n+i,n+r,s),t.lineTo(n+i,3*n+r,s),t.lineTo(-n+i,3*n+r,s),t.lineTo(-n+i,n+r,s),t.lineTo(-3*n+i,n+r,s),t.closePath(),!0}drawOffset(t,e,i,r,s,n){var a;return a=this.parseSize(e)/6,t.moveTo(-3*a+i-s,-a+r-s,n),t.lineTo(-a+i-s,-a+r-s,n),t.lineTo(-a+i-s,-3*a+r-s,n),t.lineTo(a+i+s,-3*a+r-s,n),t.lineTo(a+i+s,-a+r-s,n),t.lineTo(3*a+i+s,-a+r-s,n),t.lineTo(3*a+i+s,a+r+s,n),t.lineTo(a+i+s,a+r+s,n),t.lineTo(a+i+s,3*a+r+s,n),t.lineTo(-a+i-s,3*a+r+s,n),t.lineTo(-a+i-s,a+r+s,n),t.lineTo(-3*a+i-s,a+r+s,n),t.closePath(),!0}};function h(t,e,i,r,s){return t.moveTo(i,r-e,s),t.lineTo(e+i,r,s),t.lineTo(i,r+e,s),t.lineTo(i-e,r,s),t.closePath(),!0}let u=new class extends n{constructor(){super(...arguments),this.type="diamond",this.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z"}draw(t,e,i,r,s){return h(t,this.parseSize(e)/2,i,r,s)}drawFitDir(t,e,i,r,s){return h(t,this.parseSize(e)/2,i,r,s)}drawOffset(t,e,i,r,s,n){return h(t,this.parseSize(e)/2+s,i,r,n)}};function d(t,e,i,r){let s=2*e;return t.rect(i-e,r-e,s,s),!1}let c=new class extends n{constructor(){super(...arguments),this.type="square",this.pathStr="M-0.5,-0.5h1v1h-1Z"}draw(t,e,i,r){return d(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,s){return d(t,this.parseSize(e)/2+s,i,r)}};function p(t,e,i,r,s=0){return t.moveTo(i+e+2*s,e+r+s),t.lineTo(i-e-2*s,e+r+s),t.lineTo(i,r-e-2*s),t.closePath(),!0}class g extends n{constructor(){super(...arguments),this.type="triangleUp",this.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z"}draw(t,e,i,r){return p(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,s){return p(t,this.parseSize(e)/2,i,r,s)}}let f=new g,m=new class extends g{constructor(){super(...arguments),this.type="triangle"}},y=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),_=Math.sin(r.BZ/10)*y,v=-Math.cos(r.BZ/10)*y;function b(t,e,i,s){let n=_*e,a=v*e;t.moveTo(i,-e+s),t.lineTo(n+i,a+s);for(let l=1;l<5;++l){let o=r.BZ*l/5,h=Math.cos(o),u=Math.sin(o);t.lineTo(u*e+i,-h*e+s),t.lineTo(h*n-u*a+i,u*n+h*a+s)}return t.closePath(),!0}let x=new class extends n{constructor(){super(...arguments),this.type="star",this.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z"}draw(t,e,i,r){return b(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,s){return b(t,this.parseSize(e)/2+s,i,r)}},S=(0,r._b)(3);function k(t,e,i,r){let s=e/S,n=s/5;return t.moveTo(0+i,-e+r),t.lineTo(s/2+i,r),t.lineTo(n/2+i,r),t.lineTo(n/2+i,e+r),t.lineTo(-n/2+i,e+r),t.lineTo(-n/2+i,r),t.lineTo(-s/2+i,r),t.closePath(),!0}let A=new class extends n{constructor(){super(...arguments),this.type="arrow",this.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z"}draw(t,e,i,r){return k(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,s){return k(t,this.parseSize(e)/2+s,i,r)}};function M(t,e,i,r){let s=2*e;return t.moveTo(i,-e+r),t.lineTo(s/3/2+i,e+r),t.lineTo(-s/3/2+i,e+r),t.closePath(),!0}let w=new class extends n{constructor(){super(...arguments),this.type="wedge",this.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z"}draw(t,e,i,r){return M(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,s){return M(t,this.parseSize(e)/2+s,i,r)}};function T(t,e,i,r){return t.moveTo(-e+i,r),t.lineTo(i,e+r),!1}let C=new class extends n{constructor(){super(...arguments),this.type="stroke",this.pathStr=""}draw(t,e,i,r){return T(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,s){return T(t,this.parseSize(e)/2+s,i,r)}},E=(0,r._b)(3)/2,B=1/(0,r._b)(12);function P(t,e,i,r){let s=e/2,n=e*B,a=e*B+e,l=-s;return t.moveTo(s+i,n+r),t.lineTo(s+i,a+r),t.lineTo(l+i,a+r),t.lineTo(-.5*s-E*n+i,E*s+-.5*n+r),t.lineTo(-.5*s-E*a+i,E*s+-.5*a+r),t.lineTo(-.5*l-E*a+i,E*l+-.5*a+r),t.lineTo(-.5*s+E*n+i,-.5*n-E*s+r),t.lineTo(-.5*s+E*a+i,-.5*a-E*s+r),t.lineTo(-.5*l+E*a+i,-.5*a-E*l+r),t.closePath(),!1}let O=new class extends n{constructor(){super(...arguments),this.type="wye",this.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z"}draw(t,e,i,r){return P(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,s){return P(t,this.parseSize(e)/2+s,i,r)}};function I(t,e,i,r,s){return t.moveTo(-e+i-2*s,r),t.lineTo(e+i+s,e+r+2*s),t.lineTo(e+i+s,r-e-2*s),t.closePath(),!0}let R=new class extends n{constructor(){super(...arguments),this.type="triangleLeft",this.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z"}draw(t,e,i,r){return I(t,this.parseSize(e)/2,i,r,0)}drawOffset(t,e,i,r,s){return I(t,this.parseSize(e)/2,i,r,s)}};function L(t,e,i,r,s=0){return t.moveTo(i-e-s,e+r+2*s),t.lineTo(e+i+2*s,r),t.lineTo(i-e-s,r-e-2*s),t.closePath(),!0}let D=new class extends n{constructor(){super(...arguments),this.type="triangleRight",this.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z"}draw(t,e,i,r){return L(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,s){return L(t,this.parseSize(e)/2,i,r,s)}};function F(t,e,i,r,s=0){return t.moveTo(i-e-2*s,r-e-s),t.lineTo(i+e+2*s,r-e-s),t.lineTo(i,r+e+2*s),t.closePath(),!0}let z=new class extends n{constructor(){super(...arguments),this.type="triangleDown",this.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z"}draw(t,e,i,r){return F(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,s){return F(t,this.parseSize(e)/2,i,r,s)}},j=(0,r._b)(3);function H(t,e,i,r){let s=e*j;return t.moveTo(i,r+-s/3*2),t.lineTo(e+i,r+s),t.lineTo(i-e,r+s),t.closePath(),!0}let N=new class extends n{constructor(){super(...arguments),this.type="thinTriangle",this.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z"}draw(t,e,i,r){return H(t,this.parseSize(e)/2/j,i,r)}drawOffset(t,e,i,r,s){return H(t,this.parseSize(e)/2/j+s,i,r)}};function V(t,e,i,r){let s=2*e;return t.moveTo(e+i,r-s),t.lineTo(i-e,r),t.lineTo(e+i,s+r),!0}let W=new class extends n{constructor(){super(...arguments),this.type="arrow2Left",this.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5"}draw(t,e,i,r){return V(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,s){return V(t,this.parseSize(e)/4+s,i,r)}};function U(t,e,i,r){let s=2*e;return t.moveTo(i-e,r-s),t.lineTo(i+e,r),t.lineTo(i-e,s+r),!0}let G=new class extends n{constructor(){super(...arguments),this.type="arrow2Right",this.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5"}draw(t,e,i,r){return U(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,s){return U(t,this.parseSize(e)/4+s,i,r)}};function Z(t,e,i,r){let s=2*e;return t.moveTo(i-s,r+e),t.lineTo(i,r-e),t.lineTo(i+s,r+e),!0}let $=new class extends n{constructor(){super(...arguments),this.type="arrow2Up",this.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25"}draw(t,e,i,r){return Z(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,s){return Z(t,this.parseSize(e)/4+s,i,r)}};function Y(t,e,i,r){let s=2*e;return t.moveTo(i-s,r-e),t.lineTo(i,r+e),t.lineTo(i+s,r-e),!0}let X=new class extends n{constructor(){super(...arguments),this.type="arrow2Down",this.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25"}draw(t,e,i,r){return Y(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,s){return Y(t,this.parseSize(e)/4+s,i,r)}};function K(t,e,i,r,s){return t.moveTo(i,r-e),t.lineTo(i,r+e),!0}let q=new class extends n{constructor(){super(...arguments),this.type="lineV",this.pathStr="M0,-0.5L0,0.5"}draw(t,e,i,r,s){return K(t,this.parseSize(e)/2,i,r,s)}drawOffset(t,e,i,r,s,n){return K(t,this.parseSize(e)/2+s,i,r,n)}drawToSvgPath(t,e,i,r){let s=this.parseSize(t)/2;return`M ${e}, ${i-s} L ${e},${i+s}`}};function Q(t,e,i,r,s){return t.moveTo(i-e,r),t.lineTo(i+e,r),!0}let J=new class extends n{constructor(){super(...arguments),this.type="lineH",this.pathStr="M-0.5,0L0.5,0"}draw(t,e,i,r,s){return Q(t,this.parseSize(e)/2,i,r,s)}drawOffset(t,e,i,r,s,n){return Q(t,this.parseSize(e)/2+s,i,r,n)}drawToSvgPath(t,e,i,r){let s=this.parseSize(t)/2;return`M ${e-s}, ${i} L ${e+s},${i}`}};function te(t,e,i,r,s){return t.moveTo(i-e,r-e),t.lineTo(i+e,r+e),t.moveTo(i+e,r-e),t.lineTo(i-e,r+e),!0}let ti=new class extends n{constructor(){super(...arguments),this.type="close",this.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5"}draw(t,e,i,r,s){return te(t,this.parseSize(e)/2,i,r,s)}drawOffset(t,e,i,r,s,n){return te(t,this.parseSize(e)/2+s,i,r,n)}drawToSvgPath(t,e,i,r){let s=this.parseSize(t)/2;return`M ${e-s}, ${i-s} L ${e+s},${i+s} M ${e+s}, ${i-s} L ${e-s},${i+s}`}};function tr(t,e,i,r){return t.rect(i-e[0]/2,r-e[1]/2,e[0],e[1]),!1}function ts(t,e,i,r){let s=e/2;return t.rect(i-e/2,r-s/2,e,s),!1}let tn=new class extends n{constructor(){super(...arguments),this.type="rect",this.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z"}draw(t,e,i,r){return(0,s.Z)(e)?ts(t,e,i,r):tr(t,e,i,r)}drawWithClipRange(t,e,i,r,n,a,l){(0,s.Z)(e)&&(e=[e,e/2]);let o=2*(e[0]+e[1])*n,h=[{x:i+e[0]/2,y:r-e[1]/2},{x:i+e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r-e[1]/2}],u=0,d=h[3];t.moveTo(d.x,d.y);for(let e=0;e<h.length;e++){let i=h[e],r=Math.sqrt((i.x-d.x)*(i.x-d.x)+(i.y-d.y)*(i.y-d.y));if(u+r>o){let e=(i.x-d.x)*(o-u)/r,s=(i.y-d.y)*(o-u)/r;t.lineTo(d.x+e,d.y+s);break}t.lineTo(i.x,i.y),d=i,u+=r}return!1}drawOffset(t,e,i,r,n){return(0,s.Z)(e)?ts(t,e+2*n,i,r):tr(t,[e[0]+2*n,e[1]+2*n],i,r)}},ta={};[l,o,u,c,N,m,x,A,w,C,O,R,D,f,z,W,G,$,X,tn,q,J,ti].forEach(t=>{ta[t.type]=t});let tl={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"}},21054:function(t,e,i){"use strict";i.d(e,{C:()=>c,y:()=>p});var r=i(88504),s=i(33430),n=i(78388),a=i(37967),l=i(46560),o=i(96087),h=i(27177),u=i(41923);let d=["radius","startAngle","endAngle",...s.DH];class c extends s.zs{constructor(t={radius:1}){super(t),this.type="circle",this.numberType=h.Aw}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{startAngle:t,endAngle:e,radius:i}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)}getGraphicTheme(){return(0,l.gh)(this).circle}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateCircleAABBBoundsImprecise(t,e,i):this.updateCircleAABBBoundsAccurate(t,e,i));let{tb1:s,tb2:n}=o.w.graphicService.updateTempAABBBounds(i);return(0,u.E)(t,e,s),i.union(s),s.setValue(n.x1,n.y1,n.x2,n.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,o.w.graphicService.transformAABBBounds(t,i,e,!1,this),i}updateCircleAABBBoundsImprecise(t,e,i){let{radius:r=e.radius}=t;return i.set(-r,-r,r,r),i}updateCircleAABBBoundsAccurate(t,e,i){let{startAngle:s=e.startAngle,endAngle:n=e.endAngle,radius:l=e.radius}=t;return n-s>r.f7-r.Ho?i.set(-l,-l,l,l):(0,a.jx)(s,n,l,i),i}needUpdateTags(t){return super.needUpdateTags(t,d)}needUpdateTag(t){return super.needUpdateTag(t,d)}toCustomPath(){var t,e,i;let r=super.toCustomPath();if(r)return r;let s=this.attribute,a=null!=(t=s.radius)?t:this.getDefaultAttribute("radius"),l=null!=(e=s.startAngle)?e:this.getDefaultAttribute("startAngle"),o=null!=(i=s.endAngle)?i:this.getDefaultAttribute("endAngle");return(r=new n.r).arc(0,0,a,l,o),r}clone(){return new c(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return c.NOWORK_ANIMATE_ATTR}}function p(t){return new c(t)}c.NOWORK_ANIMATE_ATTR=s.Wl},59484:function(t,e,i){"use strict";i.d(e,{F1:()=>o,Iq:()=>C,J7:()=>S,T5:()=>T,Up:()=>m,VF:()=>A,WC:()=>d,YW:()=>B,ZD:()=>k,bZ:()=>v,e9:()=>b,eh:()=>y,h8:()=>x,jK:()=>E,kx:()=>M,pp:()=>h,q9:()=>c,t8:()=>_,th:()=>w,xF:()=>f});var r=i(8992),s=i(88504),n=i(30943),a=i(78388),l=i(14226);let o={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new r.y},h={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},u={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},d=Object.assign({outerBorder:Object.assign(Object.assign({},u),{distance:0}),innerBorder:Object.assign(Object.assign({},u),{distance:0})},u),c={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:"PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,\n    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",fontWeight:"",ellipsis:"…",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:l.r.fontBounding,keepCenterInLine:!1},p=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,autoAnimateTexture:!1,textureRatio:1,textureOptions:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,backgroundKeepAspectRatio:!1,backgroundClip:!0,backgroundScale:1,backgroundOffsetX:0,backgroundOffsetY:0,blur:0,filter:"",cursor:null,html:null,react:null,vue:null},h),d),{alignSelf:"auto"}),{pickStrokeBuffer:0}),g={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},f=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1,clipConfig:null,roughStyle:null},{_debug_bounds:!1}),p),o),m=Object.assign(Object.assign({},f),{startAngle:0,endAngle:s.f7,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),y=Object.assign(Object.assign(Object.assign({},f),g),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),_=Object.assign(Object.assign({},f),{radius:1,startAngle:0,endAngle:s.f7}),v=Object.assign(Object.assign({},f),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1,cornerType:"round"}),b=Object.assign(Object.assign({},f),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),x=Object.assign(Object.assign(Object.assign({},f),g),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),S=Object.assign(Object.assign({},f),{path:new a.r,fillStrokeOrder:1,clipRange:1,customPath:()=>{n.Y.getInstance().warn("空函数")}}),k=Object.assign(Object.assign({},f),{points:[],cornerRadius:0,closePath:!0}),A=Object.assign(Object.assign({},f),{width:100,height:100,spikes:5,thickness:.5}),M=Object.assign(Object.assign({},f),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0,cornerType:"round"});Object.assign(Object.assign({},f),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0,cornerType:"round"});let w=Object.assign(Object.assign({},f),{symbolType:"circle",size:10,keepDirIn3d:!0,clipRange:1}),T=Object.assign(Object.assign(Object.assign({},f),c),{strokeBoundsBuffer:0,keepDirIn3d:!0}),C=Object.assign(Object.assign(Object.assign({},f),c),{upgradeAttrs:null,editable:!1,editOptions:null,ascentDescentMode:"actual",width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),E=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0,maxWidth:500,maxHeight:500},f),{fill:!0,cornerRadius:0,cornerType:"round"}),B=Object.assign(Object.assign({},E),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1})},27177:function(t,e,i){"use strict";i.d(e,{$M:()=>f,Aw:()=>l,B5:()=>m,Hf:()=>d,IJ:()=>n,IO:()=>b,I_:()=>h,Kh:()=>p,Lo:()=>x,Nd:()=>o,PN:()=>u,Ri:()=>a,Us:()=>y,_u:()=>g,fB:()=>_,qm:()=>c,r_:()=>s,tA:()=>v});var r=i(42915);let s=(0,r.Gg)(),n=(0,r.Gg)(),a=(0,r.Gg)(),l=(0,r.Gg)(),o=(0,r.Gg)(),h=(0,r.Gg)(),u=(0,r.Gg)(),d=(0,r.Gg)(),c=(0,r.Gg)(),p=(0,r.Gg)();(0,r.Gg)();let g=(0,r.Gg)();(0,r.Gg)();let f=(0,r.Gg)();(0,r.Gg)();let m=(0,r.Gg)(),y=(0,r.Gg)(),_=Symbol.for("GraphicService"),v=Symbol.for("GraphicCreator"),b={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},x=Object.keys(b)},20672:function(t,e,i){"use strict";i.d(e,{i:()=>r});let r=new class{constructor(){this.store=new Map}RegisterGraphicCreator(t,e){this.store.set(t,e),this[t]=e}CreateGraphic(t,e){let i=this.store.get(t);return i?i(e):null}}},41923:function(t,e,i){"use strict";i.d(e,{E:()=>r});let r=(t,e,i)=>{let{outerBorder:r,shadowBlur:s=e.shadowBlur}=t;if(r){let t=e.outerBorder,{distance:n=t.distance,lineWidth:a=t.lineWidth}=r;i.expand(n+(s+a)/2)}return i}},88758:function(t,e,i){"use strict";i.d(e,{JG:()=>_,M_:()=>y,RT:()=>m});var r,s=i(17783),n=i(41809),a=i(76620),l=i(45273),o=i(20420),h=i(58539),u=i(42915),d=i(53627),c=i(14535),p=i(60027),g=i(27177),f=i(46527);function m(t,e,i){var r;let{x:s=i.x,y:n=i.y,z:a=i.z,dx:l=i.dx,dy:o=i.dy,dz:h=i.dz,scaleX:u=i.scaleX,scaleY:c=i.scaleY,scaleZ:p=i.scaleZ,alpha:g=i.alpha,beta:m=i.beta,angle:y=i.angle,anchor3d:_=e.attribute.anchor,anchor:v}=e.attribute,b=[0,0,0];if(_){if("string"==typeof _[0]){let t=parseFloat(_[0])/100,i=e.AABBBounds;b[0]=i.x1+(i.x2-i.x1)*t}else b[0]=_[0];if("string"==typeof _[1]){let t=parseFloat(_[1])/100,i=e.AABBBounds;b[1]=i.x1+(i.x2-i.x1)*t}else b[1]=_[1];b[2]=null!=(r=_[2])?r:0}if((0,f.TL)(t),(0,f.Iu)(t,t,[s+l,n+o,a+h]),(0,f.Iu)(t,t,[b[0],b[1],b[2]]),(0,f.lM)(t,t,m),(0,f.uD)(t,t,g),(0,f.Iu)(t,t,[-b[0],-b[1],b[2]]),(0,f.mN)(t,t,[u,c,p]),y){let i=d.yp.allocate(),r=[0,0];if(v){if("string"==typeof _[0]){let t=parseFloat(_[0])/100,i=e.AABBBounds;r[0]=i.x1+(i.x2-i.x1)*t}else r[0]=_[0];if("string"==typeof _[1]){let t=parseFloat(_[1])/100,i=e.AABBBounds;r[1]=i.x1+(i.x2-i.x1)*t}else r[1]=_[1]}(0,f.Iu)(i,i,[r[0],r[1],0]),(0,f.jI)(i,i,y),(0,f.Iu)(i,i,[-r[0],-r[1],0]),(0,f.G9)(t,t,i)}}function y(t){let{alpha:e,beta:i}=t.attribute;return e||i}let _=class{constructor(t){this.creator=t,this.hooks={onAttributeUpdate:new o.n(["graphic"]),onSetStage:new o.n(["graphic","stage"]),onRemove:new o.n(["graphic"]),onRelease:new o.n(["graphic"]),onAddIncremental:new o.n(["graphic","group","stage"]),onClearIncremental:new o.n(["graphic","group","stage"]),beforeUpdateAABBBounds:new o.n(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new o.n(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new o.n(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new a.FB,this.tempAABBBounds2=new a.FB}onAttributeUpdate(t){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(t)}onSetStage(t,e){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(t,e)}onRemove(t){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(t)}onRelease(t){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(t)}onAddIncremental(t,e,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(t,e,i)}onClearIncremental(t,e){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(t,e)}beforeUpdateAABBBounds(t,e,i,r){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(t,e,i,r)}afterUpdateAABBBounds(t,e,i,r,s){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(t,e,i,r,s)}clearAABBBounds(t,e,i){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(t,e,i)}updatePathProxyAABBBounds(t,e){let i="function"==typeof e.pathProxy?e.pathProxy(e.attribute):e.pathProxy;if(!i)return!1;let r=new c.C(t);return(0,p.h)(i.commandList,r,0,0),!0}updateHTMLTextAABBBounds(t,e,i,r){let{textAlign:s,textBaseline:n}=t;if(null!=t.forceBoundsHeight){let e=(0,l.Z)(t.forceBoundsHeight)?t.forceBoundsHeight:t.forceBoundsHeight(),r=(0,h.nV)(n,e,e);i.set(i.x1,r,i.x2,r+e)}if(null!=t.forceBoundsWidth){let e=(0,l.Z)(t.forceBoundsWidth)?t.forceBoundsWidth:t.forceBoundsWidth(),r=(0,h.js)(s,e);i.set(r,i.y1,r+e,i.y2)}}combindShadowAABBBounds(t,e){if(e&&e.shadowRoot){let i=e.shadowRoot.AABBBounds;t.union(i)}}transformAABBBounds(t,e,i,r,s){if(!e.empty()){let{scaleX:s=i.scaleX,scaleY:n=i.scaleY,stroke:a=i.stroke,shadowBlur:l=i.shadowBlur,lineWidth:o=i.lineWidth,pickStrokeBuffer:h=i.pickStrokeBuffer,strokeBoundsBuffer:d=i.strokeBoundsBuffer}=t,c=this.tempAABBBounds1,p=this.tempAABBBounds2;if(a&&o){let t=(o+h)/Math.abs(s+n);(0,u.ph)(c,t,r,d),e.union(c),c.setValue(p.x1,p.y1,p.x2,p.y2)}if(l){let{shadowOffsetX:r=i.shadowOffsetX,shadowOffsetY:a=i.shadowOffsetY}=t,o=l/Math.abs(s+n)*2;(0,u.ph)(c,o,!1,d+1),c.translate(r,a),e.union(c)}}if(this.combindShadowAABBBounds(e,s),e.empty())return;let n=!0,l=s.transMatrix;s&&s.isContainer&&(n=1!==l.a||0!==l.b||0!==l.c||1!==l.d||0!==l.e||0!==l.f),n&&(0,a.n2)(e,e,l)}validCheck(t,e,i,r){if(!r||null!=t.forceBoundsHeight||null!=t.forceBoundsWidth||r.shadowRoot||r.isContainer)return!0;let{visible:s=e.visible}=t;return!(!r.valid||!s)||(i.empty()||(r.parent&&i.transformWithMatrix(r.parent.globalTransMatrix),this.clearAABBBounds(r,r.stage,i),i.clear()),!1)}updateTempAABBBounds(t){let e=this.tempAABBBounds1,i=this.tempAABBBounds2;return e.setValue(t.x1,t.y1,t.x2,t.y2),i.setValue(t.x1,t.y1,t.x2,t.y2),{tb1:e,tb2:i}}};_=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,s.b)(),(r=(0,n.f)(g.tA),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],_)},33430:function(t,e,i){"use strict";i.d(e,{zs:()=>q,DH:()=>G,Wl:()=>K});var r=i(76620),s=i(31535),n=i(88504),a=i(8992),l=i(41457),o=i(35652),h=i(30756);let u=t=>new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(t),d=t=>new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(t);var c=i(43562),p=i(21883),g=i.n(p),f=i(30943),m=i(61868),y=i(98116),_=i(35437);class v extends g(){get previousSibling(){return this._prev}get nextSibling(){return this._next}get children(){return this.getChildren()}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}get count(){return this._count}get childrenCount(){return this._idMap?this._idMap.size:0}constructor(){super(),this._uid=_.R.GenAutoIncrementId(),this._firstChild=null,this._lastChild=null,this.parent=null,this._count=1}forEachChildren(t,e=!1){if(e){let e=this._lastChild,i=0;for(;e;){if(t(e,i++))return;e=e._prev}}else{let e=this._firstChild,i=0;for(;e;){if(t(e,i++))return;e=e._next}}}forEachChildrenAsync(t,e=!1){var i,r,s,n;return i=this,r=void 0,s=void 0,n=function*(){if(e){let e=this._lastChild,i=0;for(;e;){let r=t(e,i++);if(r.then&&(r=yield r),r)return;e=e._prev}}else{let e=this._firstChild,i=0;for(;e;){let r=t(e,i++);if(r.then&&(r=yield r),r)return;e=e._next}}},new(s||(s=Promise))(function(t,e){function a(t){try{o(n.next(t))}catch(t){e(t)}}function l(t){try{o(n.throw(t))}catch(t){e(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof s?i:new s(function(t){t(i)})).then(a,l)}o((n=n.apply(i,r||[])).next())})}forEach(t){return this.forEachChildren(t)}appendChild(t,e=!0){if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw Error("【Node::appendChild】不能将父辈元素append为子元素");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}appendChildArrHighPerformance(t,e=!1){return console.error("暂不支持该函数"),t}insertBefore(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw Error("【Node::insertBefore】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertAfter(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw Error("【Node::insertAfter】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertInto(t,e){if(!this._ignoreWarn&&this._nodeList&&f.Y.getInstance().warn("insertIntoKeepIdx和insertInto混用可能会存在错误"),e>=this.childrenCount)return this.appendChild(t);if(this===t)return null;if(t.isAncestorsOf(this))throw Error("【Node::insertBefore】不能将父辈元素insert为子元素");if(t.parent&&t.parent.removeChild(t),t.parent=this,0===e)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{let i=this._firstChild;for(let t=0;t<e;t++){if(!i)return null;t>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}insertIntoKeepIdx(t,e){let i;if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){let i=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,i)}this._nodeList[e]=t;for(let t=e-1;t>=0&&!(i=this._nodeList[t]);t--);if(i)return i._next?this.insertBefore(t,i._next):this.appendChild(t);this._ignoreWarn=!0;let r=this.insertInto(t,0);return this._ignoreWarn=!1,r}removeChild(t){if(!this._idMap||!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){let e=this._nodeList.findIndex(e=>e===t);e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}delete(){this.parent&&this.parent.removeChild(this)}removeAllChild(t){if(!this._idMap)return;this._nodeList&&(this._nodeList.length=0);let e=this._firstChild;for(;e;){let t=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=t}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}replaceChild(t,e){throw Error("暂不支持")}find(t,e=!1){let i=null;return this.forEachChildren((e,r)=>!(e===this||!t(e,r))&&(i=e,!0)),e&&this.forEachChildren(e=>{if(e.isContainer){let r=e.find(t,!0);if(r)return i=r,!0}return!1}),i}findAll(t,e=!1){let i=[];return this.forEachChildren((e,r)=>{e!==this&&t(e,r)&&i.push(e)}),e&&this.forEachChildren(e=>{if(e.isContainer){let r=e.findAll(t,!0);r.length&&(i=i.concat(r))}}),i}getElementById(t){return this.find(e=>e.id===t,!0)}findChildById(t){return this.getElementById(t)}findChildByUid(t){return this._idMap&&this._idMap.get(t)||null}getElementsByName(t){return this.findAll(e=>e.name===t,!0)}findChildrenByName(t){return this.getElementsByName(t)}getElementsByType(t){return this.findAll(e=>e.type===t,!0)}getChildByName(t,e=!1){return this.find(e=>e.name===t,e)}getChildAt(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}at(t){return this.getChildAt(t)}containNode(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;let e=this._firstChild;for(;e;){if(e.containNode(t))return!0;e=e._next}return!1}getRootNode(){let t=this.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t||this}hasChildNodes(){return null!==this._firstChild}addChild(t){return this.appendChild(t)}add(t){return this.appendChild(t)}getChildren(){let t=[],e=this._firstChild;for(;e;)t.push(e),e=e._next;return t}isChildOf(t){return!!this.parent&&this.parent._uid===t._uid}isParentOf(t){return t.isChildOf(this)}isDescendantsOf(t){let e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(null!==e);return!1}isAncestorsOf(t){return t.isDescendantsOf(this)}getAncestor(t){throw Error("暂不支持")}setAllDescendantsProps(t,e){let i=this._firstChild;for(;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}setCount(t){this._count+=t;let e=this.parent;if(e)do e._count+=t,e=e.parent;while(null!==e)}clone(){throw Error("暂不支持")}cloneTo(t){throw Error("暂不支持")}getParent(){return this.parent}del(t){return this.removeChild(t)}addEventListener(t,e,i){let r=(0,m.Z)(i,!0)&&i||(0,c.Z)(i)&&i.capture,s=(0,c.Z)(i)&&i.once,n=(0,y.Z)(e)?void 0:e;return t=r?`${t}capture`:t,e=(0,y.Z)(e)?e:e.handleEvent,s?super.once(t,e,n):super.on(t,e,n),this}on(t,e,i){return this.addEventListener(t,e,i)}removeEventListener(t,e,i){let r=(0,m.Z)(i,!0)&&i||(0,c.Z)(i)&&i.capture,s=(0,y.Z)(e)?void 0:e;t=r?`${t}capture`:t,e=(0,y.Z)(e)?e:e.handleEvent;let n=(0,c.Z)(i)&&i.once;return super.off(t,e,s,n),this}off(t,e,i){return this.removeEventListener(t,e,i)}once(t,e,i){return(0,c.Z)(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}removeAllEventListeners(){return super.removeAllListeners(),this}removeAllListeners(){return this.removeAllEventListeners()}dispatchEvent(t,...e){return super.emit(t.type,t,...e),!t.defaultPrevented}emit(t,e){return this.dispatchEvent(t,e)}release(){this.removeAllListeners()}}var b=i(99014),x=i(47382),S=i(59484),k=i(96087),A=i(78388),M=i(77502),w=i(33760),T=i(14535),C=i(60027),E=i(37967),B=i(26635),P=i(45273);let O=new r.FB;class I{constructor(t,e,i=!1){this.pathStr="",this.type=t,(0,s.Z)(e)?this.svgCache=e:this.path=e,this.isSvg=i}drawOffset(t,e,i,r,s,n,a){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(s=>{t.beginPath(),(0,C.h)(s.path.commandList,t,i,r,e,e),a&&a(s.path,s.attribute)}),!1):((0,C.h)(this.path.commandList,t,i,r,e+s,e+s),!1)}draw(t,e,i,r,s,n){return e=this.parseSize(e),this.drawOffset(t,e,i,r,0,s,n)}parseSize(t){return(0,P.Z)(t)?t:Math.min(t[0],t[1])}drawWithClipRange(t,e,i,r,s,n,a){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(n=>{n.path.drawWithClipRange(t,e,i,r,s),a&&a(n.path,n.attribute)}),!1):(this.path.drawWithClipRange(t,e,i,r,s),!1)}bounds(t,e){if(t=this.parseSize(t),this.isSvg){if(!this.svgCache)return;return e.clear(),void this.svgCache.forEach(({path:i})=>{O.x1=i.bounds.x1*t,O.y1=i.bounds.y1*t,O.x2=i.bounds.x2*t,O.y2=i.bounds.y2*t,e.union(O)})}this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}class R{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}function L(t,e,i,r){let s=t.indexOf(e,i);if(-1===s)throw Error(r);return s+e.length-1}function D(t,e,i,r=">"){let s=function(t,e,i=">"){let r,s="";for(let n=e;n<t.length;n++){let e=t[n];if(r)e===r&&(r="");else if('"'===e||"'"===e)r=e;else if(e===i[0]){if(!i[1]||t[n+1]===i[1])return{data:s,index:n}}else"	"===e&&(e=" ");s+=e}}(t,e+1,r);if(!s)return;let n=s.data,a=s.index,l=n.search(/\s/),o=n,h=!0;-1!==l&&(o=n.substr(0,l).replace(/\s\s*$/,""),n=n.substr(l+1));let u=o;if(i){let t=o.indexOf(":");-1!==t&&(h=(o=o.substr(t+1))!==s.data.substr(t+1))}return{tagName:o,tagExp:n,closeIndex:a,attrExpPresent:h,rawTagName:u}}let F=RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");class z{constructor(t){this.currentNode=null,this.options=t,this.tagsNodeStack=[],this.docTypeEntities={}}addChild(t,e,i){let r=e.tagname;"string"==typeof r&&(e.tagname=r),t.addChild(e)}buildAttributesMap(t,e,i){let r={};if(!t)return;let s=function(t,e){let i=[],r=e.exec(t);for(;r;){let s=[];s.startIndex=e.lastIndex-r[0].length;let n=r.length;for(let t=0;t<n;t++)s.push(r[t]);i.push(s),r=e.exec(t)}return i}(t,F),n=s.length;for(let t=0;t<n;t++){let e=s[t][1],i=s[t][4];e&&(r[e]=void 0===i||(isNaN(i)?i:Number(i)))}return r}parseXml(t){t=t.replace(/\r\n?/g,"\n");let e=new R("!xml"),i=e,r="",s="";for(let n=0;n<t.length;n++)if("<"===t[n])if("/"===t[n+1]){let e=L(t,">",n,"Closing Tag is not closed."),a=s.lastIndexOf(".");s=s.substring(0,a),(i=this.tagsNodeStack.pop())&&i.child&&r&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=r),r="",n=e}else if("?"===t[n+1])n=D(t,n,!1,"?>").closeIndex+1;else if("!--"===t.substr(n+1,3))n=L(t,"--\x3e",n+4,"Comment is not closed.");else{let a=D(t,n,!1),l=a.tagName,o=a.tagExp,h=a.attrExpPresent,u=a.closeIndex;if(l!==e.tagname&&(s+=s?"."+l:l),o.length>0&&o.lastIndexOf("/")===o.length-1){"/"===l[l.length-1]?(l=l.substr(0,l.length-1),s=s.substr(0,s.length-1),o=l):o=o.substr(0,o.length-1);let t=new R(l);l!==o&&h&&(t[":@"]=this.buildAttributesMap(o,s,l)),this.addChild(i,t,s),s=s.substr(0,s.lastIndexOf("."))}else{let t=new R(l);this.tagsNodeStack.push(i),l!==o&&h&&(t[":@"]=this.buildAttributesMap(o,s,l)),this.addChild(i,t,s),i=t}r="",n=u}else r+=t[n];return e.child}}class j{constructor(t){this.options=Object.assign({},j.defaultOptions,t)}valid(t){return t.startsWith("<")}parse(t){var e,i;return!!this.valid&&(e=new z(this.options).parseXml(t),this.options,function t(e,i){let r={};for(let s=0;s<e.length;s++){let n=e[s],a=function(t){let e=Object.keys(t);for(let t=0;t<e.length;t++){let i=e[t];if(":@"!==i)return i}}(n),l="";if(l=void 0===i?a:i+"."+a,void 0!==a&&n[a]){let e=t(n[a],l);Object.keys(e).length,n[":@"]&&function(t,e,i){if(e){let i=Object.keys(e),r=i.length;for(let s=0;s<r;s++){let r=i[s];t[r]=e[r]}}}(e,n[":@"],0),void 0!==r[a]&&r.hasOwnProperty(a)?(Array.isArray(r[a])||(r[a]=[r[a]]),r[a].push(e)):r[a]=e}}return r}(e))}}j.defaultOptions={};var H=i(27177);let N={duration:200,easing:"cubicOut"};var V=i(21288);let W=new r.FB,U=new a.y;new r.FB;let G=["lineWidth","scaleX","scaleY","angle","anchor","visible"],Z=["x","y"],$=["scaleX","scaleY"],Y=["angle"],X=new l.E9,K={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1};class q extends v{static mixin(t){let e=Object.keys(t);for(let i=0;i<e.length;++i){let r=e[i];Object.defineProperty(q.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get AABBBounds(){return this.tryUpdateAABBBounds()}get OBBBounds(){return this.tryUpdateOBBBounds()}get globalAABBBounds(){return this.tryUpdateGlobalAABBBounds()}get transMatrix(){return this.tryUpdateLocalTransMatrix(!0)}get globalTransMatrix(){return this.tryUpdateGlobalTransMatrix(!0)}constructor(t={}){var e;super(),this._AABBBounds=new r.FB,this._updateTag=w.Gz.INIT,this.attribute=t,this.valid=this.isValid(),this.updateAABBBoundsStamp=0,t.background?this.loadImage(null!=(e=t.background.background)?e:t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic)}getGraphicService(){var t,e;return null!=(e=null==(t=this.stage)?void 0:t.graphicService)?e:k.w.graphicService}getAttributes(){return this.attribute}setMode(t){"3d"===t?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}getOffsetXY(t,e=!1){var i,r;let{dx:s=t.dx,dy:n=t.dy}=this.attribute;if(e&&this.parent){let t=this.parent.attribute;X.x=s+(null!=(i=t.scrollX)?i:0),X.y=n+(null!=(r=t.scrollY)?r:0)}else X.x=s,X.y=n;return X}onAnimateBind(t){this._emitCustomEvent("animate-bind",t)}tryUpdateAABBBounds(){let t="imprecise"===this.attribute.boundsMode;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);let e=this.doUpdateAABBBounds(t);return this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),"empty"===this.attribute.boundsMode&&e.clear(),e}tryUpdateOBBBounds(){return(this._OBBBounds||(this._OBBBounds=new r.a5),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp)?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid)?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds)}combindShadowAABBBounds(t){if(this.shadowRoot){let e=this.shadowRoot.AABBBounds.clone();t.union(e)}}doUpdateOBBBounds(){return this._OBBBounds}getClipPath(){let{clipConfig:t}=this.attribute;if(!t)return null;this.clipPathMap||(this.clipPathMap=new Map);let{shape:e}=t,i=this.clipPathMap.get(e)||null;return i||(this.clipPathMap.size>10&&this.clipPathMap.clear(),(i=this.parsePath(e))&&this.clipPathMap.set(e,i)),i}parsePath(t){var e;if(!t)return null;let i=B.g6[t];if(i||(i=q.userSymbolMap[t]))return i;if(!0===((e=t=B.SR[t]||t).startsWith("<svg")||e.startsWith("<?xml"))){let{svg:e}=(new j).parse(t);if(!e)return null;let i=(0,s.Z)(e.path)?e.path:[e.path];W.clear();let r=[];i.forEach(t=>{let e=(new A.r).fromString(t.d),i={};H.Lo.forEach(e=>{t[e]&&(i[H.IO[e]]=t[e])}),r.push({path:e,attribute:i}),W.union(e.bounds)});let a=W.width(),l=W.height(),o=1/(0,n.Fp)(a,l);r.forEach(t=>t.path.transform(0,0,o,o));let h=new I(t,r,!0);return q.userSymbolMap[t]=h,h}let r=(new A.r).fromString(t),a=r.bounds.width(),l=r.bounds.height(),o=1/(0,n.Fp)(a,l);r.transform(0,0,o,o);let h=new I(t,r);return q.userSymbolMap[t]=h,h}doUpdateAABBBounds(t){this.updateAABBBoundsStamp++;let e=this.getGraphicTheme();this._AABBBounds.clear();let i=this.attribute,r=this.updateAABBBounds(i,e,this._AABBBounds,t),{boundsPadding:s=e.boundsPadding}=i,n=(0,E.dj)(s);return n&&r.expand(n),this.clearUpdateBoundTag(),r}updatePathProxyAABBBounds(t){let e="function"==typeof this.pathProxy?this.pathProxy(this.attribute):this.pathProxy;if(!e)return!1;let i=new T.C(t);return(0,C.h)(e.commandList,i,0,0),!0}tryUpdateGlobalAABBBounds(){let t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}tryUpdateGlobalTransMatrix(t=!0){if(this._globalTransMatrix){if(this.parent){let t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!0}tryUpdateLocalTransMatrix(t=!0){return this._transMatrix||(this._transMatrix=new a.y),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}shouldUpdateAABBBounds(){return this.shadowRoot?(!!(this._updateTag&w.Gz.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&w.Gz.UPDATE_BOUNDS)&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}shouldSelfChangeUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&w.Gz.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&w.Gz.UPDATE_BOUNDS)}shouldUpdateLocalMatrix(){return!!(this._updateTag&w.Gz.UPDATE_LOCAL_MATRIX)}isValid(){var t,e;let i=this.attribute;return Number.isFinite((null!=(t=i.x)?t:0)+(null!=(e=i.y)?e:0))}_validNumber(t){return null==t||Number.isFinite(t)}shouldUpdateShape(){return!!(this._updateTag&w.Gz.UPDATE_SHAPE)}clearUpdateShapeTag(){this._updateTag&=w.Gz.CLEAR_SHAPE}containsPoint(t,e,i,r){if(!r)return!1;if(i===w.LZ.GLOBAL){let i=new l.E9(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(i,i),t=i.x,e=i.y}return r.containsPoint(this,{x:t,y:e})}setWidthHeightWithoutTransform(t){this.widthWithoutTransform=t.x2-t.x1,this.heightWithoutTransform=t.y2-t.y1}setAttributesAndPreventAnimate(t,e=!1,i,r){this.setAttributes(t,e,i),this.animates&&this.animates.forEach(e=>{(e.priority!==1/0||r)&&Object.keys(t).forEach(t=>{e.preventAttr(t)})})}setAttributes(t,e=!1,i){(t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,i)}_setAttributes(t,e=!1,i){let r=Object.keys(t);for(let e=0;e<r.length;e++){let i=r[e];this.attribute[i]=t[i]}this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(e||this.needUpdateTags(r))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}setAttribute(t,e,i,r){var s;let n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);n?this._setAttributes(n,i,r):(0,o.Z)(null==(s=this.normalAttrs)?void 0:s[t])?(this.attribute[t]=e,this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(i||this.needUpdateTag(t))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)):this.normalAttrs[t]=e,"background"===t?this.loadImage(e,!0):"shadowGraphic"===t&&this.setShadowGraphic(e)}needUpdateTags(t,e=G){for(let i=0;i<e.length;i++){let r=e[i];if(-1!==t.indexOf(r))return!0}return!1}needUpdateTag(t,e=G){for(let i=0;i<e.length;i++)if(t===e[i])return!0;return!1}initAttributes(t){let e={type:w.Gk.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=w.Gz.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}translate(t,e){var i,r;if(0===t&&0===e)return this;let s={type:w.Gk.TRANSLATE},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,Z,s);n&&(t=n.x,e=n.y,delete n.x,delete n.y,this._setAttributes(n));let a=this.attribute,l=a.postMatrix;return l?k.w.transformUtil.fromMatrix(l,l).translate(t,e):(a.x=(null!=(i=a.x)?i:S.F1.x)+t,a.y=(null!=(r=a.y)?r:S.F1.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(s),this}translateTo(t,e){let i=this.attribute;if(i.x===t&&i.y===e)return this;let r={type:w.Gk.TRANSLATE_TO},s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,Z,r);return s?this._setAttributes(s,!1,r):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)),this}scale(t,e,i){var r,s;if(1===t&&1===e)return this;let n={type:w.Gk.SCALE},l=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,$,n);l&&(t=l.scaleX,e=l.scaleY,delete l.scaleX,delete l.scaleY,this._setAttributes(l));let o=this.attribute;if(i){let{postMatrix:r}=this.attribute;r||(o.postMatrix=r=new a.y),k.w.transformUtil.fromMatrix(r,r).scale(t,e,i)}else o.scaleX=(null!=(r=o.scaleX)?r:S.F1.scaleX)*t,o.scaleY=(null!=(s=o.scaleY)?s:S.F1.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this}scaleTo(t,e){let i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;let r={type:w.Gk.SCALE_TO},s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,$,r);return s?this._setAttributes(s,!1,r):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)),this}rotate(t,e){var i;if(0===t)return this;let r={type:w.Gk.ROTATE},s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,Y,r);s&&(delete s.angle,this._setAttributes(s,!1,r));let n=this.attribute;if(e){let{postMatrix:i}=this.attribute;i||(n.postMatrix=i=new a.y),k.w.transformUtil.fromMatrix(i,i).rotate(t,e)}else n.angle=(null!=(i=n.angle)?i:S.F1.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}rotateTo(t){let e=this.attribute;if(e.angle===t)return this;let i={type:w.Gk.ROTATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,Y,i);return r?this._setAttributes(r,!1,i):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)),this}skewTo(t,e){return this}onAttributeUpdate(t){t&&t.skipUpdateCallback||(this.getGraphicService().onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}update(t){t?(t.bounds&&this.tryUpdateAABBBounds(),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(),this.tryUpdateLocalTransMatrix())}hasState(t){return!(!this.currentStates||!this.currentStates.length)&&(!!(0,o.Z)(t)||this.currentStates.includes(t))}getState(t){var e;return null==(e=this.states)?void 0:e[t]}applyStateAttrs(t,e,i,r){var s,n;if(i){let e,i=Object.keys(t),a=this.getNoWorkAnimateAttr(),l={};i.forEach(i=>{a[i]?(e||(e={}),e[i]=t[i]):l[i]=r&&void 0===t[i]?this.getDefaultAttribute(i):t[i]});let o=null!=(n=null!=(s=this.context&&this.context.stateAnimateConfig)?s:this.stateAnimateConfig)?n:N;this.applyAnimationState(["state"],[{name:"state",animation:{type:"state",to:l,duration:o.duration,easing:o.easing}}]),e&&this.setAttributesAndPreventAnimate(e,!1,{type:w.Gk.STATE})}else this.stopStateAnimates(),this.setAttributesAndPreventAnimate(t,!1,{type:w.Gk.STATE}),this.finalAttribute&&Object.assign(this.finalAttribute,t);this._emitCustomEvent("afterStateUpdate",{type:w.Gk.STATE})}updateNormalAttrs(t){let e={};this.normalAttrs?(Object.keys(t).forEach(t=>{t in this.normalAttrs?(e[t]=this.normalAttrs[t],delete this.normalAttrs[t]):e[t]=this.getNormalAttribute(t)}),Object.keys(this.normalAttrs).forEach(e=>{t[e]=this.normalAttrs[e]})):Object.keys(t).forEach(t=>{e[t]=this.getNormalAttribute(t)}),this.normalAttrs=e}stopStateAnimates(t="end"){this.animates&&this.animates.forEach(e=>{e.stateNames&&(e.stop(t),this.animates.delete(e.id))})}getNormalAttribute(t){var e,i;let r=this.attribute[t];return this.animates?null==(e=this.finalAttribute)?void 0:e[t]:null!=r?r:null==(i=this.finalAttribute)?void 0:i[t]}clearStates(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}removeState(t,e){if(this.currentStates){let i=(0,s.Z)(t)?e=>!t.includes(e):e=>e!==t,r=this.currentStates.filter(i);r.length!==this.currentStates.length&&this.useStates(r,e)}}toggleState(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){let i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}addState(t,e,i){var r;if(this.currentStates&&this.currentStates.includes(t)&&(e||1===this.currentStates.length))return;let s=e&&(null==(r=this.currentStates)?void 0:r.length)?this.currentStates.concat([t]):[t];this.useStates(s,i)}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!((null==(i=this.currentStates)?void 0:i.length)!==t.length||t.some((t,e)=>this.currentStates[e]!==t)))return;let r={};t.forEach(e=>{var i;let s=this.stateProxy?this.stateProxy(e,t):null==(i=this.states)?void 0:i[e];s&&Object.assign(r,s)}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}addUpdateBoundTag(){this._updateTag|=w.Gz.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}addUpdateShapeTag(){this._updateTag|=w.Gz.UPDATE_SHAPE}addUpdateShapeAndBoundsTag(){this._updateTag|=w.Gz.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}updateShapeAndBoundsTagSetted(){return(this._updateTag&w.Gz.UPDATE_SHAPE_AND_BOUNDS)===w.Gz.UPDATE_SHAPE_AND_BOUNDS}clearUpdateBoundTag(){this._updateTag&=w.Gz.CLEAR_BOUNDS}addUpdatePositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=w.Gz.UPDATE_GLOBAL_LOCAL_MATRIX}addUpdateGlobalPositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=w.Gz.UPDATE_GLOBAL_MATRIX}clearUpdateLocalPositionTag(){this._updateTag&=w.Gz.CLEAR_LOCAL_MATRIX}clearUpdateGlobalPositionTag(){this._updateTag&=w.Gz.CLEAR_GLOBAL_MATRIX}addUpdateLayoutTag(){this._updateTag|=w.Gz.UPDATE_LAYOUT}clearUpdateLayoutTag(){this._updateTag&=w.Gz.CLEAR_LAYOUT}needUpdateLayout(){return!!(this._updateTag&w.Gz.UPDATE_LAYOUT)}getAnchor(t,e,i){let r=[0,0],s=()=>{if(e.b)return e.b;let t=this.clone();return t.attribute.angle=0,t.attribute.scaleCenter=null,i&&(t.attribute.scaleX=1,t.attribute.scaleY=1),e.b=t.AABBBounds,e.b};if("string"==typeof t[0]){let e=parseFloat(t[0])/100,i=s();r[0]=i.x1+(i.x2-i.x1)*e}else r[0]=t[0];if("string"==typeof t[1]){let e=parseFloat(t[1])/100,i=s();r[1]=i.y1+(i.y2-i.y1)*e}else r[1]=t[1];return r}doUpdateLocalMatrix(){let{x:t=S.F1.x,y:e=S.F1.y,scaleX:i=S.F1.scaleX,scaleY:r=S.F1.scaleY,angle:s=S.F1.angle,scaleCenter:n,anchor:l,postMatrix:o}=this.attribute,h=[0,0],u={};if(l&&s&&(h=this.getAnchor(l,u)),n&&(1!==i||1!==r)){let a=this._transMatrix;a.reset(),a.translate(h[0],h[1]),a.rotate(s),a.translate(-h[0],-h[1]),a.translate(t,e),h=this.getAnchor(n,u,!0),k.w.transformUtil.fromMatrix(a,a).scale(i,r,{x:h[0],y:h[1]})}else(0,a.X)(this._transMatrix,this._transMatrix.reset(),t,e,i,r,s,l&&h);let d=this.getOffsetXY(S.F1);if(this._transMatrix.e+=d.x,this._transMatrix.f+=d.y,o){let t=U.setValue(o.a,o.b,o.c,o.d,o.e,o.f),e=this._transMatrix;t.multiply(e.a,e.b,e.c,e.d,e.e,e.f),e.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}doUpdateGlobalMatrix(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);let{scrollX:t=0,scrollY:e=0}=this.parent.attribute;this._globalTransMatrix.translate(t,e)}}setStage(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){let e=t.getTimeline();this.animates.forEach(t=>{t.timeline.isGlobal&&(t.setTimeline(e),e.addAnimate(t))})}this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t)}}setStageToShadowRoot(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}onAddStep(t){}onStop(t){t&&this.setAttributes(t,!1,{type:w.Gk.ANIMATE_END})}getDefaultAttribute(t){return this.getGraphicTheme()[t]}getComputedAttribute(t){var e;return null!=(e=this.attribute[t])?e:this.getDefaultAttribute(t)}onSetStage(t,e=!1){this._onSetStage=t,e&&this.stage&&t(this,this.stage)}attachShadow(t){return t&&(t.shadowHost=this),this.shadowRoot=null!=t?t:k.w.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}detachShadow(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot.release(!0),this.shadowRoot=null)}toJson(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map(t=>t.toJson())}}createPathProxy(t){return(0,h.Z)(t,!0)?this.pathProxy=(new A.r).fromString(t):this.pathProxy=new A.r,this.pathProxy}loadImage(t,e=!1){var i;if(!t||e&&!(!(i=t).fill&&!i.stroke))return;this.resources||(this.resources=new Map);let r={data:"init",state:null};this.resources.set(t,r),"string"==typeof t?(r.state="loading",t.startsWith("<svg")?(M.h.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):(u(t)||t.includes("/")||d(t))&&(M.h.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):(0,c.Z)(t)?(r.state="success",r.data=t,this.backgroundImg=this.backgroundImg||e):r.state="fail"}setShadowGraphic(t){t?this.attachShadow().add(t):this.detachShadow()}imageLoadSuccess(t,e,i){if(!this.resources)return;let r=this.resources.get(t);r&&(r.state="success",r.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}imageLoadFail(t,e){if(!this.resources)return;let i=this.resources.get(t);i&&(i.state="fail",e&&e())}_stopAnimates(t){t&&t.forEach(t=>{t.stop()})}stopAnimates(t=!1){this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren(e=>{e.stopAnimates(t)})}release(){this.releaseStatus="released",this.stopAnimates(),k.w.graphicService.onRelease(this)}_emitCustomEvent(t,e){var i,r;if(this._events&&t in this._events){let s=new b.A(t,e);s.bubbles=!1,s.manager=null==(r=null==(i=this.stage)?void 0:i.eventSystem)?void 0:r.manager,this.dispatchEvent(s)}}toCustomPath(){var t,e,i;let r=null==(i=null==(e=(null==(t=this.stage)?void 0:t.renderService)||k.w.renderService)?void 0:e.drawContribution)?void 0:i.getRenderContribution(this);if(r){let t=new V.w(null,1);return r.drawShape(this,t,0,0,{},{}),t.path}return null}}q.userSymbolMap={},q.mixin({dispatchEvent(t){var e;if(!(t instanceof x.x))throw Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=[],t.detailPath&&(t.detailPath=[]),t.target=this,null==(e=null==t?void 0:t.manager)||e.dispatchEvent(t),!t.defaultPrevented},emit(t,e){return this.dispatchEvent(new b.A(t,e))}})},53068:function(t,e,i){"use strict";i.d(e,{ZA:()=>c,sS:()=>p});var r,s,n=i(41457),a=i(96087),l=i(33430),o=i(46560),h=i(33760),u=i(27177),d=i(59484);(r=s||(s={}))[r.LESS_GROUP=0]="LESS_GROUP",r[r.MORE_GROUP=1]="MORE_GROUP";class c extends l.zs{constructor(t){super(t),this.type="group",this.parent=null,this.isContainer=!0,this.numberType=u.I_,this._childUpdateTag=h.Gz.UPDATE_BOUNDS}setMode(t){"3d"===t?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}setTheme(t){return this.theme||(this.theme=new o.Q2),this.theme.setTheme(t,this)}createTheme(){this.theme||(this.theme=new o.Q2)}visibleAll(t){this.setAttribute("visible",t),this.forEachChildren(e=>{e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute("visible",t)})}hideAll(){this.visibleAll(!1)}showAll(){this.visibleAll(!0)}containsPoint(t,e,i){if(i===h.LZ.GLOBAL){let i=new n.E9(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(i,i),this.AABBBounds.contains(i.x,i.y)}return this.AABBBounds.contains(t,e)}shouldUpdateAABBBounds(){return!!super.shouldUpdateAABBBounds()||!!(this._childUpdateTag&h.Gz.UPDATE_BOUNDS)}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);let t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),"empty"===this.attribute.boundsMode&&e.clear(),e}doUpdateLocalMatrix(){let{x:t=d.F1.x,y:e=d.F1.y,dx:i=d.F1.dx,dy:r=d.F1.dy,scaleX:s=d.F1.scaleX,scaleY:n=d.F1.scaleY,angle:a=d.F1.angle,postMatrix:l}=this.attribute;if(0!==t||0!==e||0!==i||0!==r||1!==s||1!==n||0!==a||l)return super.doUpdateLocalMatrix();this._transMatrix.reset()}getGraphicTheme(){return(0,o.gh)(this).group}updateAABBBounds(t,e,i){let r=i;i=i.clone();let{width:s,height:n,path:l,clip:o=e.clip}=t;if(l&&l.length?l.forEach(t=>{i.union(t.AABBBounds)}):null!=s&&null!=n&&i.set(0,0,Math.max(0,s),Math.max(0,n)),!o){this.forEachChildren(t=>{i.union(t.AABBBounds)});let{scrollX:e=0,scrollY:r=0}=t;i.translate(e,r)}return a.w.graphicService.updateTempAABBBounds(i),a.w.graphicService.transformAABBBounds(t,i,e,!1,this),r.copy(i),r}doUpdateAABBBounds(){this.updateAABBBoundsStamp++;let t=super.doUpdateAABBBounds();return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),t}clearUpdateBoundTag(){this._updateTag&=h.Gz.CLEAR_BOUNDS,this._childUpdateTag&=h.Gz.CLEAR_BOUNDS}addUpdateBoundTag(){this._updateTag|=h.Gz.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}addChildUpdateBoundTag(){this._childUpdateTag&h.Gz.UPDATE_BOUNDS||(this._childUpdateTag|=h.Gz.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}getTheme(){return this.theme.getTheme(this)}incrementalAppendChild(t){let e=super.appendChild(t);return this.stage&&e&&(e.stage=this.stage,e.layer=this.layer),this.addUpdateBoundTag(),this.getGraphicService().onAddIncremental(t,this,this.stage),e}incrementalClearChild(){super.removeAllChild(),this.addUpdateBoundTag(),this.getGraphicService().onClearIncremental(this,this.stage)}_updateChildToStage(t){return this.stage&&t&&t.setStage(this.stage,this.layer),this.addUpdateBoundTag(),t}appendChild(t,e=!0){let i=super.appendChild(t);return e&&this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}insertBefore(t,e){return this._updateChildToStage(super.insertBefore(t,e))}insertAfter(t,e){return this._updateChildToStage(super.insertAfter(t,e))}insertInto(t,e){return this._updateChildToStage(super.insertInto(t,e))}removeChild(t){let e=super.removeChild(t);return this.getGraphicService().onRemove(t),t.stage=null,this.addUpdateBoundTag(),e}removeAllChild(t=!1){this.forEachChildren(e=>{this.getGraphicService().onRemove(e),t&&e.isContainer&&e.removeAllChild(t)}),super.removeAllChild(),this.addUpdateBoundTag()}setStage(t,e){this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t),this.forEachChildren(e=>{e.setStage(t,this.layer)}))}addUpdatePositionTag(){super.addUpdatePositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}addUpdateGlobalPositionTag(){super.addUpdateGlobalPositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){let t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!!(this._updateTag&h.Gz.UPDATE_GLOBAL_MATRIX)}_getChildByName(t,e){return this.find(e=>e.name===t,e)}createOrUpdateChild(t,e,i){let r=this._getChildByName(t);return r?r.setAttributes(e):((r=a.w.graphicService.creator[i](e)).name=t,this.add(r)),r}clone(){return new c(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return c.NOWORK_ANIMATE_ATTR}release(t){t&&this.forEachChildren(e=>{e.release(t)}),super.release()}}function p(t){return new c(t)}c.NOWORK_ANIMATE_ATTR=l.Wl},19427:function(t,e,i){"use strict";i.d(e,{B:()=>d,E:()=>u});var r=i(33430),s=i(59484),n=i(46560),a=i(96087),l=i(27177),o=i(41923);let h=["width","height","image",...r.DH];class u extends r.zs{constructor(t){super(t),this.type="image",this.numberType=l.PN,this.loadImage(this.attribute.image)}getImageElement(){let{image:t}=this.attribute;if(!t||!this.resources)return null;let e=this.resources.get(t);return"success"!==e.state?null:e.data}get width(){return this.tryUpdateAABBBounds(),this._actualWidth}get height(){return this.tryUpdateAABBBounds(),this._actualHeight}get repeatX(){var t;return null!=(t=this.attribute.repeatX)?t:"no-repeat"}set repeatX(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}get repeatY(){var t;return null!=(t=this.attribute.repeatY)?t:"no-repeat"}set repeatY(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}get image(){return this.attribute.image}set image(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}imageLoadSuccess(t,e,i){super.imageLoadSuccess(t,e,()=>{this.successCallback&&this.successCallback()}),this.addUpdateBoundTag()}imageLoadFail(t,e){super.imageLoadFail(t,()=>{this.failCallback&&this.failCallback()})}setAttributes(t,e,i){return t.image&&this.loadImage(t.image),super.setAttributes(t,e,i)}setAttribute(t,e,i,r){return"image"===t&&this.loadImage(e),super.setAttribute(t,e,i,r)}getGraphicTheme(){return(0,n.gh)(this).image}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let{maxWidth:r=e.maxWidth,maxHeight:s=e.maxHeight}=t,{width:n,height:a}=t;if(null==n||null==a){let t=this.getImageElement();if(t){let e=t.width,i=t.height;if(null!=n)a=i/e*n;else if(null!=a)n=e/i*a;else{let t=e/i;t>r/s?(n=r,a=r/t):(a=s,n=s*t)}}else n=r,a=s}this._actualWidth=n,this._actualHeight=a,i.set(0,0,n,a)}let{tb1:r,tb2:s}=a.w.graphicService.updateTempAABBBounds(i);return(0,o.E)(t,e,r),i.union(r),r.setValue(s.x1,s.y1,s.x2,s.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,a.w.graphicService.transformAABBBounds(t,i,e,!1,this),i}getDefaultAttribute(t){return s.jK[t]}needUpdateTags(t){return super.needUpdateTags(t,h)}needUpdateTag(t){return super.needUpdateTag(t,h)}clone(){return new u(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return u.NOWORK_ANIMATE_ATTR}}function d(t){return new u(t)}u.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},r.Wl)},73208:function(t,e,i){"use strict";i.d(e,{W:()=>d,x:()=>u});var r=i(33430),s=i(46560),n=i(96087),a=i(37967),l=i(78388),o=i(27177);let h=["segments","points","curveType","curveTension",...r.DH];class u extends r.zs{constructor(t={}){super(t),this.type="line",this.numberType=o.Hf}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;let{points:t,segments:e}=this.attribute;return e?0!==e.length:!!t&&!(t.length<=1)}_interpolate(t,e,i,r,s){"points"===t&&(s.points=(0,a.SA)(i,r,e))}getGraphicTheme(){return(0,s.gh)(this).line}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i):this.updateLineAABBBoundsByPoints(t,e,i)),n.w.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;let{lineJoin:r=e.lineJoin}=t;return n.w.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}updateLineAABBBoundsByPoints(t,e,i,r){let{points:s=e.points,connectedType:n}=t;return s.forEach(t=>{!1===t.defined&&"connect"!==n||i.add(t.x,t.y)}),i}updateLineAABBBoundsBySegments(t,e,i,r){let{segments:s=e.segments,connectedType:n}=t;return s.forEach(t=>{t.points.forEach(t=>{!1===t.defined&&"connect"!==n||i.add(t.x,t.y)})}),i}needUpdateTags(t){return super.needUpdateTags(t,h)}needUpdateTag(t){return super.needUpdateTag(t,h)}toCustomPath(){let t=super.toCustomPath();if(t)return t;let e=this.attribute;t=new l.r;let i=e.segments,r=e=>{if(e&&e.length){let i=!0;e.forEach(e=>{!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),i=!1)})}};return i&&i.length?i.forEach(t=>{r(t.points)}):e.points&&r(e.points),t}clone(){return new u(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return u.NOWORK_ANIMATE_ATTR}}function d(t){return new u(t)}u.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},r.Wl)},88110:function(t,e,i){"use strict";i.d(e,{E:()=>p});var r=i(35652),s=i(30756),n=i(33430),a=i(78388),l=i(46560),o=i(96087),h=i(27177),u=i(41923);let d=["path","customPath",...n.DH];class c extends n.zs{constructor(t){super(t),this.type="path",this.numberType=h.qm}get pathShape(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{path:t}=this.attribute;return null!=t&&""!==t}getParsedPathShape(){let t=this.getGraphicTheme();if(!this.valid)return t.path;let e=this.attribute;return e.path instanceof a.r?e.path:((0,r.Z)(this.cache)&&this.doUpdatePathShape(),this.cache instanceof a.r?this.cache:t.path)}getGraphicTheme(){return(0,l.gh)(this).path}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let t=this.getParsedPathShape();i.union(t.getBounds())}let{tb1:r,tb2:s}=o.w.graphicService.updateTempAABBBounds(i);(0,u.E)(t,e,r),i.union(r),r.setValue(s.x1,s.y1,s.x2,s.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;let{lineJoin:n=e.lineJoin}=t;return o.w.graphicService.transformAABBBounds(t,i,e,"miter"===n,this),i}doUpdateAABBBounds(t){return this.doUpdatePathShape(),super.doUpdateAABBBounds(t)}doUpdatePathShape(){let t=this.attribute;(0,s.Z)(t.path,!0)?this.cache=(new a.r).fromString(t.path):t.customPath&&(this.cache=new a.r,t.customPath(this.cache,this))}needUpdateTags(t){return super.needUpdateTags(t,d)}needUpdateTag(t){return super.needUpdateTag(t,d)}toCustomPath(){return(new a.r).fromCustomPath2D(this.getParsedPathShape(),0,0)}clone(){return new c(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return c.NOWORK_ANIMATE_ATTR}}function p(t){return new c(t)}c.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},n.Wl)},50730:function(t,e,i){"use strict";i.d(e,{p:()=>d});var r=i(33430),s=i(46560),n=i(37967),a=i(78388),l=i(96087),o=i(27177);let h=["points","cornerRadius",...r.DH];class u extends r.zs{constructor(t){super(t),this.type="polygon",this.numberType=o.Kh}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{points:t}=this.attribute;return t&&t.length>=2}getGraphicTheme(){return(0,s.gh)(this).polygon}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||this.updatePolygonAABBBoundsImprecise(t,e,i),l.w.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;let{lineJoin:r=e.lineJoin}=t;return l.w.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}updatePolygonAABBBoundsImprecise(t,e,i){let{points:r=e.points}=t;return r.forEach(t=>{i.add(t.x,t.y)}),i}_interpolate(t,e,i,r,s){"points"===t&&(s.points=(0,n.SA)(i,r,e))}needUpdateTags(t){return super.needUpdateTags(t,h)}needUpdateTag(t){return super.needUpdateTag(t,h)}toCustomPath(){let t=super.toCustomPath();if(t)return t;let e=this.attribute.points;return t=new a.r,e.forEach((e,i)=>{0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)}),t.closePath(),t}clone(){return new u(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return u.NOWORK_ANIMATE_ATTR}}function d(t){return new u(t)}u.NOWORK_ANIMATE_ATTR=r.Wl},28651:function(t,e,i){"use strict";i.d(e,{U:()=>d,f:()=>c});var r=i(33430),s=i(78388),n=i(46560),a=i(96087),l=i(27177),o=i(52250),h=i(41923);let u=["width","x1","y1","height","cornerRadius",...r.DH];class d extends r.zs{constructor(t){super(t),this.type="rect",this.numberType=l._u}isValid(){return super.isValid()&&this._isValid()}_isValid(){return!0}getGraphicTheme(){return(0,n.gh)(this).rect}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let{width:e,height:r}=t,{x1:s,y1:n,x:a,y:l}=t;e=null!=e?e:s-a,r=null!=r?r:n-l,(isFinite(e)||isFinite(r)||isFinite(a)||isFinite(l))&&i.set(0,0,e||0,r||0)}let{tb1:r,tb2:s}=a.w.graphicService.updateTempAABBBounds(i);return(0,h.E)(t,e,r),i.union(r),r.setValue(s.x1,s.y1,s.x2,s.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,a.w.graphicService.transformAABBBounds(t,i,e,!1,this),i}needUpdateTags(t){return super.needUpdateTags(t,u)}needUpdateTag(t){return super.needUpdateTag(t,u)}toCustomPath(){let t=super.toCustomPath();if(t)return t;let e=this.attribute,{x:i,y:r,width:n,height:a}=(0,o.p)(e);return(t=new s.r).moveTo(i,r),t.rect(i,r,n,a),t}clone(){return new d(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return d.NOWORK_ANIMATE_ATTR}}function c(t){return new d(t)}d.NOWORK_ANIMATE_ATTR=r.Wl},93342:function(t,e,i){"use strict";i.d(e,{H:()=>S,p:()=>k});var r=i(30756),s=i(45273),n=i(33430),a=i(59484),l=i(28580);class o{constructor(t,e,i,r,s,n,a,o,h,u,d,c,p,g){this.left=t,this.top=e,this.width=i,this.height=r,this.actualHeight=0,this.bottom=e+r,this.right=t+i,this.ellipsis=s,this.wordBreak=n,this.verticalDirection=a,this.lines=[],this.globalAlign=o,this.globalBaseline=h,this.layoutDirection=u,this.directionKey=l.i7[this.layoutDirection],this.isWidthMax=d,this.isHeightMax=c,this.singleLine=p,g?(g.clear(),this.icons=g):this.icons=new Map}draw(t,e){let{width:i,height:r}=this.getActualSize(),s=this.isWidthMax?Math.min(this.width,i):this.width||i||0,n=this.isHeightMax?Math.min(this.height,r):this.height||r||0;n=Math.min(n,r);let a=0;switch(this.globalBaseline){case"top":a=0;break;case"middle":a=-n/2;break;case"bottom":a=-n}let l=0;"right"===this.globalAlign||"end"===this.globalAlign?l=-s:"center"===this.globalAlign&&(l=-s/2);let o=this[this.directionKey.height];this.singleLine&&(o=this.lines[0].height+1);let h=!1;if("middle"===this.verticalDirection)if(this.actualHeight>=o&&0!==o)for(let i=0;i<this.lines.length;i++){let{top:r,height:s}=this.lines[i];if(r+s<this[this.directionKey.top]||r+s>this[this.directionKey.top]+o)break;let n=!1;this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+o&&(n=!0,h=!0),this.lines[i].draw(t,n,this.lines[i][this.directionKey.left]+l,this.lines[i][this.directionKey.top]+a,this.ellipsis,e)}else{let i=Math.floor((o-this.actualHeight)/2);"vertical"===this.layoutDirection?l+=i:a+=i;for(let i=0;i<this.lines.length;i++)this.lines[i].draw(t,!1,this.lines[i][this.directionKey.left]+l,this.lines[i][this.directionKey.top]+a,this.ellipsis,e)}else if("bottom"===this.verticalDirection&&"vertical"!==this.layoutDirection)for(let i=0;i<this.lines.length;i++){let{top:r,height:s}=this.lines[i],n=o-this.lines[i].top-this.lines[i].height;if(0===o)this.lines[i].draw(t,!1,l,n+a,this.ellipsis,e);else{if(n+s>this[this.directionKey.top]+o||n<this[this.directionKey.top])return h;{let r=!1;this.ellipsis&&this.lines[i+1]&&n-this.lines[i+1].height<this[this.directionKey.top]&&(r=!0,h=!0),this.lines[i].draw(t,r,l,n+a,this.ellipsis,e)}}}else{"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&this.singleLine&&this.isWidthMax&&(l+=this.lines[0].height+1);for(let i=0;i<this.lines.length;i++){"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&(l-=this.lines[i].height+this.lines[i].top);let{top:r,height:s}=this.lines[i];if(0===o)this.lines[i].draw(t,!1,this.lines[i][this.directionKey.left]+l,this.lines[i][this.directionKey.top]+a,this.ellipsis,e);else{if(r+s<this[this.directionKey.top]||r+s>this[this.directionKey.top]+o)return h;{let r=!1;this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+o&&(r=!0,h=!0),this.lines[i].draw(t,r,this.lines[i][this.directionKey.left]+l,this.lines[i][this.directionKey.top]+a,this.ellipsis,e)}}}}return h}getActualSize(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}getRawActualSize(){let t=0,e=0;for(let i=0;i<this.lines.length;i++){let r=this.lines[i];r.actualWidth>t&&(t=r.actualWidth),e+=r.height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}getActualSizeWidthEllipsis(){let t=0,e=0,{width:i,height:r}=this.getRawActualSize();this.width;let s=this.height||r||0;s=Math.min(s,r);let n=this[this.directionKey.height];if(this.singleLine&&(n=this.lines[0].height+1),"middle"===this.verticalDirection)if(this.actualHeight>=n&&0!==n)for(let i=0;i<this.lines.length;i++){let{top:r,height:s}=this.lines[i];if(r+s<this[this.directionKey.top]||r+s>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+n){let r=!0===this.ellipsis?"...":this.ellipsis||"",s=this.lines[i].getWidthWithEllips(r);s>t&&(t=s),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else{this.actualHeight;for(let i=0;i<this.lines.length;i++)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else if("bottom"===this.verticalDirection)for(let i=0;i<this.lines.length;i++){let{top:r,height:s}=this.lines[i],a=n-this.lines[i].top-this.lines[i].height;if(0===n)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height;else if(a+s>this[this.directionKey.top]+n||a<this[this.directionKey.top]);else if(this.ellipsis&&this.lines[i+1]&&a-this.lines[i+1].height<this[this.directionKey.top]){let r=!0===this.ellipsis?"...":this.ellipsis||"",s=this.lines[i].getWidthWithEllips(r);s>t&&(t=s),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else for(let i=0;i<this.lines.length;i++){let{top:r,height:s}=this.lines[i];if(0===n)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height;else if(r+s<this[this.directionKey.top]||r+s>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+n){let r=!0===this.ellipsis?"...":this.ellipsis||"",s=this.lines[i].getWidthWithEllips(r);s>t&&(t=s),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}}var h=i(37967);function u(t,e,i,r){let s=Math.round(t),n=Math.round(i),a=Math.round(e),l=Math.round(r);return{left:t>s?s:s-.5,top:i>n?n:n-.5,right:a>e?a:a+.5,bottom:l>r?l:l+.5}}class d{constructor(t,e,i,r){var s,n;this.fontSize=i.fontSize||16,this.textBaseline=i.textBaseline||"alphabetic",this.ascentDescentMode=r;let a=(0,h.VA)(i.lineHeight,this.fontSize);this.lineHeight="number"==typeof a?a>this.fontSize?a:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;let{ascent:o,height:u,descent:d,width:c}=(0,l.MS)(t,i,this.ascentDescentMode),p=0,g=0,f=0;this.height>u&&(g=Math.ceil(p=(this.height-u)/2),f=Math.floor(p)),"top"===this.textBaseline?(this.ascent=p,this.descent=u-p):"bottom"===this.textBaseline?(this.ascent=u-p,this.descent=p):"middle"===this.textBaseline?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=o+g,this.descent=d+f),this.length=t.length,this.width=c||0,this.text=t||"",this.newLine=e||!1,this.character=i,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,this.space=i.space,this.dx=null!=(s=i.dx)?s:0,this.dy=null!=(n=i.dy)?n:0,"vertical"===i.direction&&(this.direction=i.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}updateWidth(){let{width:t}=(0,l.MS)(this.text,this.character,this.ascentDescentMode);this.width=t,"vertical"===this.direction&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}drawBackground(t,e,i,r,s,n,a){if(""===this.text||"\n"===this.text||!this.character.background||this.character.backgroundOpacity&&!(this.character.backgroundOpacity>0))return;let o=e+i,h=this.text,d=this.left+r;o+=this.top;let c=this.direction;if(this.verticalEllipsis)h=this.ellipsisStr,c="vertical",o-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)h+=this.ellipsisStr,"right"!==n&&"end"!==n||(d-=this.ellipsisWidth);else if("replace"===this.ellipsis){let t=(0,l.Hi)(h,("vertical"===c?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,h.length-1);if(h=h.slice(0,t)+this.ellipsisStr,"right"===n||"end"===n)if("vertical"===c);else{let{width:e}=(0,l.MS)(this.text.slice(t),this.character,this.ascentDescentMode);d-=this.ellipsisWidth-e}}}return Object.assign(Object.assign({},u(d,d+(this.widthOrigin||this.width),e,e+a)),{fillStyle:this.character.background,globalAlpha:this.character.backgroundOpacity})}draw(t,e,i,r,s,n,a){var o;let h=e+i,d=this.text,c=this.left+r+(null!=(o=this.space)?o:0)/2;h+=this.top;let p=this.direction;if(this.verticalEllipsis)d=this.ellipsisStr,p="vertical",h-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)d+=this.ellipsisStr,"right"!==n&&"end"!==n||(c-=this.ellipsisWidth);else if("replace"===this.ellipsis){let t=(0,l.Hi)(d,("vertical"===p?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,d.length-1);if(d=d.slice(0,t)+this.ellipsisStr,"right"===n||"end"===n)if("vertical"===p);else{let{width:e}=(0,l.MS)(this.text.slice(t),this.character,this.ascentDescentMode);c-=this.ellipsisWidth-e}}}switch(this.character.script){case"super":h-=this.ascent*(1/3);break;case"sub":h+=this.descent/2}"vertical"===p&&(t.save(),t.rotateAbout(Math.PI/2,c,h),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(c,h),c=0,h=0);let{lineWidth:g=1}=this.character;if(this.character.stroke&&g&&t.strokeText(d,c+this.dx,h+this.dy),this.character.fill&&t.fillText(d,c+this.dx,h+this.dy),this.character.fill){if(this.character.lineThrough||this.character.underline){if(this.character.underline){let e=1+h,i=u(c,c+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+h,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}if(this.character.lineThrough){let e=1+h-this.ascent/2,i=u(c,c+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+h-this.ascent/2,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}else if("underline"===this.character.textDecoration){let e=1+h,i=u(c,c+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+h,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}else if("line-through"===this.character.textDecoration){let e=1+h-this.ascent/2,i=u(c,c+(this.widthOrigin||this.width),e,e+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(i.left,1+h-this.ascent/2,i.right-i.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}"vertical"===p&&t.restore()}getWidthWithEllips(t){let e=this.text,i="vertical"===t?this.height:this.width;if("hide"===this.ellipsis)return i;if("add"===this.ellipsis)return i+this.ellipsisWidth;if("replace"===this.ellipsis){let t=(0,l.Hi)(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,t)+this.ellipsisStr;let{width:r}=(0,l.MS)(this.text.slice(t),this.character,this.ascentDescentMode);return i+this.ellipsisWidth-r}return i}}var c=i(31535),p=i(19427);class g extends p.E{constructor(t){if(super(t),this._x=0,this._y=0,this._hovered=!1,this._marginArray=[0,0,0,0],"always"===t.backgroundShowMode&&(this._hovered=!0),t.margin){let e=(0,h.dj)(t.margin);this._marginArray="number"==typeof e?[e,e,e,e]:e}this.onBeforeAttributeUpdate=(t,e,i)=>{if((0,c.Z)(i)&&-1!==i.indexOf("margin")||"margin"===i)if(e.margin){let t=(0,h.dj)(e.margin);this._marginArray="number"==typeof t?[t,t,t,t]:t}else this._marginArray=[0,0,0,0]}}get width(){var t;return(null!=(t=this.attribute.width)?t:0)+this._marginArray[1]+this._marginArray[3]}get height(){var t;return(null!=(t=this.attribute.height)?t:0)+this._marginArray[0]+this._marginArray[2]}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();let{width:t=a.jK.width,height:e=a.jK.height}=this.attribute,{backgroundWidth:i=t,backgroundHeight:r=e}=this.attribute;return this._AABBBounds.expand([0,(i-t)/2*2,(r-e)/2*2,0]),this._AABBBounds}setHoverState(t){"hover"===this.attribute.backgroundShowMode&&this._hovered!==t&&(this._hovered=t)}}class f{constructor(t,e,i,r,s,n,a,o){this.left=t,this.width=e,this.baseline=i,this.ascent=r,this.descent=s,this.top=i-r,this.paragraphs=n.map(t=>t),this.textAlign=(this.paragraphs[0]instanceof g?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=a,this.directionKey=l.i7[this.direction],this.actualWidth=0;let h=0;this.paragraphs.forEach((t,e)=>{if(0===e&&t instanceof d){let e=l.cV.exec(t.text);0!==(null==e?void 0:e.index)&&(t.text=t.text.slice(null==e?void 0:e.index),t.updateWidth())}this.actualWidth+=t[this.directionKey.width],h=Math.max(t[this.directionKey.height],h)}),this.height=h,this.blankWidth=o?0:this.width-this.actualWidth,this.calcOffset(e,o)}calcOffset(t,e){let i=this.directionKey,r=this.height,s=this.left,n=0;this.actualWidth<t&&!e&&("right"===this.textAlign||"end"===this.textAlign?s=t-this.actualWidth:"center"===this.textAlign?s=(t-this.actualWidth)/2:"justify"===this.textAlign&&(this.paragraphs.length<2?s=(t-this.actualWidth)/2:n=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map(function(t){t instanceof g?(t["_"+i.x]=s,s+=t[i.width]+n,t["_"+i.y]="top"===t.attribute.textBaseline?0:"bottom"===t.attribute.textBaseline?r-t.height:(r-t.height)/2):(t[i.left]=s,s+=t[i.width]+n)})}draw(t,e,i,r,s,n){if(s&&(e||this.paragraphs.some(t=>t.overflow))){let t=!0,i=!1;for(let e=this.paragraphs.length-1;e>=0;e--){let r=this.paragraphs[e];if(r.overflow)t=t&&""===r.text;else if(t){i=!0;break}}let r=0;if(!i)for(let t=this.paragraphs.length-1;t>=0;t--){let i=this.paragraphs[t];if(i.overflow){if(""===i.text)break;continue}if(i instanceof g)break;if("vertical"===this.direction&&"vertical"!==i.direction){i.verticalEllipsis=!0;break}let n=!0===s?"...":s||"";i.ellipsisStr=n;let{width:a}=(0,l.MS)(n,i.character,i.ascentDescentMode),o=a||0;if(o<=this.blankWidth+r){e&&(i.ellipsis="add");break}if(o<=this.blankWidth+r+i.width){i.ellipsis="replace",i.ellipsisWidth=o,i.ellipsisOtherParagraphWidth=this.blankWidth+r;break}i.ellipsis="hide",r+=i.width}}let a="",o=-1,h=[],u=[h];this.paragraphs.forEach((e,s)=>{if(e instanceof g)return;let n=e.drawBackground(t,r,this.ascent,i,0===s,this.textAlign,this.height);n&&(a===n.fillStyle&&o===n.globalAlpha||(h=[],u.push(h),a=n.fillStyle,o=n.globalAlpha),h.push(n))}),u.forEach(e=>{if(0===e.length)return;let i=e[0],r=e[e.length-1];t.fillStyle=i.fillStyle,t.globalAlpha=i.globalAlpha,t.fillRect(i.left,i.top,r.right-i.left,r.bottom-i.top)}),this.paragraphs.forEach((e,s)=>{if(e instanceof g)return e.setAttributes({x:i+e._x,y:r+e._y}),void n(e,t,i+e._x,r+e._y,this.ascent);let a={x1:this.left,y1:this.top,x2:this.left+this.actualWidth,y2:this.top+this.height};(0,l.p3)(t,e.character),(0,l.nq)(t,e.character,a),e.draw(t,r,this.ascent,i,0===s,this.textAlign,this.height)})}getWidthWithEllips(t){let e=0;for(let i=this.paragraphs.length-1;i>=0;i--){let r=this.paragraphs[i];if(r instanceof g)break;let{width:s}=(0,l.MS)(t,r.character,r.ascentDescentMode),n=s||0;if(n<=this.blankWidth+e){r.ellipsis="add",r.ellipsisWidth=n;break}if(n<=this.blankWidth+e+r.width){r.ellipsis="replace",r.ellipsisWidth=n,r.ellipsisOtherParagraphWidth=this.blankWidth+e;break}r.ellipsis="hide",e+=r.width}let i=0;return this.paragraphs.forEach((t,e)=>{i+=t instanceof g?t.width:t.getWidthWithEllips(this.direction)}),i}}class m{constructor(t){this.frame=t,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=t.layoutDirection,this.directionKey=l.i7[this.direction]}store(t){if(t instanceof g){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];let e=0,i=0;"top"===t.attribute.textBaseline?(e=0,i=t.height):"bottom"===t.attribute.textBaseline?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),0!==t.text.length?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}send(){if(0===this.lineBuffer.length)return;let t=0===this.maxAscent?this.maxAscentForBlank:this.maxAscent,e=0===this.maxDescent?this.maxDescentForBlank:this.maxDescent,i=new f(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,"horizontal"===this.direction?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}deal(t,e=!1){t instanceof g?"horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):0===this.lineBuffer.length?(this.store(t),this.send()):(this.send(),this.deal(t)):"number"!=typeof this.width||this.width<0||(t.newLine&&this.send(),(0!==t.text.length||this.newLine)&&("horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t,e)))}cut(t,e){let i=this[this.directionKey.width]-this.lineWidth||0,r=Math.ceil(i/t[this.directionKey.width]*t.length)||0,s=(0,l.Hi)(t.text,i,t.character,r,"break-word"===this.frame.wordBreak);if(0!==s){let[i,r]=function(t,e){let i=t.text.slice(0,e),r=t.text.slice(e);return[new d(i,t.newLine,t.character,t.ascentDescentMode),new d(r,!0,t.character,t.ascentDescentMode)]}(t,s);this.store(i),e?this.send():this.deal(r)}else 0!==this.lineBuffer.length&&(this.send(),this.deal(t))}}var y=i(46560),_=i(96087),v=i(27177);let b=!1;try{b=Intl&&"function"==typeof Intl.Segmenter}catch(t){b=!1}let x=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity",...n.DH];class S extends n.zs{constructor(t){super(t),this.type="richtext",this._currentHoverIcon=null,this.numberType=v.$M,this.onBeforeAttributeUpdate=(t,e,i)=>{for(let i in t)if("hoverIconId"===i){if(t[i]===e[i])continue;let r=this._frameCache.icons.get(t[i]);this.updateHoverIconState(r)}}}get width(){var t;return null!=(t=this.attribute.width)?t:a.Iq.width}set width(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}get height(){var t;return null!=(t=this.attribute.height)?t:a.Iq.height}set height(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}get maxWidth(){return this.attribute.maxWidth}set maxWidth(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}get maxHeight(){return this.attribute.maxHeight}set maxHeight(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}get ellipsis(){var t;return null!=(t=this.attribute.ellipsis)?t:a.Iq.ellipsis}set ellipsis(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}get wordBreak(){var t;return null!=(t=this.attribute.wordBreak)?t:a.Iq.wordBreak}set wordBreak(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}get verticalDirection(){var t;return null!=(t=this.attribute.verticalDirection)?t:a.Iq.verticalDirection}set verticalDirection(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}get textAlign(){var t;return null!=(t=this.attribute.textAlign)?t:a.Iq.textAlign}set textAlign(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}get textBaseline(){var t;return null!=(t=this.attribute.textBaseline)?t:a.Iq.textBaseline}set textBaseline(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}get textConfig(){var t;return null!=(t=this.attribute.textConfig)?t:a.Iq.textConfig}set textConfig(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}getGraphicTheme(){return(0,y.gh)(this).richtext}static AllSingleCharacter(t){return t.lines?t.lines.every(t=>t.paragraphs.every(t=>!(t.text&&(0,r.Z)(t.text)&&S.splitText(t.text).length>1))):t.every(t=>t.isComposing||!(t.text&&(0,r.Z)(t.text)&&S.splitText(t.text).length>1))}static splitText(t){if(b){let e=new Intl.Segmenter(void 0,{granularity:"grapheme"}),i=[];for(let{segment:r}of e.segment(t))i.push(r);return i}return Array.from(t)}static TransformTextConfig2SingleCharacter(t){let e=[];return t.forEach(t=>{let i=S.splitText(t.text.toString());if((0,r.Z)(t.text)&&i.length>1)for(let r=0;r<i.length;r++){let s=i[r];e.push(Object.assign(Object.assign({},t),{text:s}))}else e.push(t)}),e}updateAABBBounds(t,e,i){var r,s,n,a;let{width:l=e.width,height:o=e.height,maxWidth:h=e.maxWidth,maxHeight:u=e.maxHeight,textAlign:d=e.textAlign,textBaseline:c=null!=(s=null!=(r=t.textBaseline)?r:e.textBaseline)?s:"top",editOptions:p}=t;if(l>0&&o>0)i.set(0,0,l,o);else{let{width:t,height:e}=this.getFrameCache().getActualSize(),r=l||t||0,s=o||e||0;s="number"==typeof u&&s>u?u:s||0,r="number"==typeof h&&r>h?h:r||0,i.set(0,0,r,s)}!p||!p.keepHeightWhileEmpty||i.height()||(null==(n=t.textConfig)?void 0:n.length)||(i.y2=i.y1+(null!=(a=t.fontSize)?a:12),i.x2=i.x1+2);let g=0;switch(c){case"top":g=0;break;case"middle":g=-i.height()/2;break;case"bottom":g=-i.height()}let f=0;switch(d){case"left":f=0;break;case"center":f=-i.width()/2;break;case"right":f=-i.width()}return i.translate(f,g),_.w.graphicService.updateTempAABBBounds(i),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||_.w.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,_.w.graphicService.transformAABBBounds(t,i,e,!1,this),0===i.width()&&0===i.height()&&i.clear(),i}needUpdateTags(t){return super.needUpdateTags(t,x)}needUpdateTag(t){return super.needUpdateTag(t,x)}getFrameCache(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}get cliped(){let t=this.getFrameCache();if(t.actualHeight>t.height)return!0;let{disableAutoWrapLine:e}=this.attribute;if(e)for(let e=0;e<t.lines.length;e++){let i=t.lines[e];for(let t=0;t<i.paragraphs.length;t++){let e=i.paragraphs[t];if(e.overflow&&""!==e.text)return!0}}return!1}combinedStyleToCharacter(t){let{fill:e,stroke:i,fontSize:r,fontFamily:s,fontStyle:n,fontWeight:a,lineWidth:l,opacity:o,fillOpacity:h,lineHeight:u,strokeOpacity:d,upgradeAttrs:c}=this.attribute,p=Object.assign({fill:e,stroke:i,fontSize:r,fontFamily:s,fontStyle:n,fontWeight:a,lineWidth:l,opacity:o,fillOpacity:h,strokeOpacity:d},t);return(null==c?void 0:c.lineHeight)&&(p.lineHeight=u),p}doUpdateFrameCache(t){var e;let{maxWidth:i,maxHeight:r,width:n,height:a,ellipsis:l,wordBreak:h,verticalDirection:u,textAlign:c,textBaseline:p,layoutDirection:f,singleLine:y,disableAutoWrapLine:_,editable:v,ascentDescentMode:b,upgradeAttrs:x}=this.attribute,k=x&&x.multiBreakLine,{textConfig:A=[]}=this.attribute;v&&A.length>0&&!S.AllSingleCharacter(A)&&(A=S.TransformTextConfig2SingleCharacter(A),this.attribute.textConfig=A);let M=[],w=null!=t?t:A;for(let t=0;t<w.length;t++)if("image"in w[t]){let e=this.combinedStyleToCharacter(w[t]);e.lineWidth=void 0;let i=e.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(e.id);if(i)M.push(i);else{let t=new g(e);t.successCallback=()=>{var t;this.addUpdateBoundTag(),null==(t=this.stage)||t.renderNextFrame()},t.richtextId=e.id,M.push(t)}}else{let e=this.combinedStyleToCharacter(w[t]);if((0,s.Z)(e.text)&&(e.text=`${e.text}`),e.text&&e.text.includes("\n")){let i=e.text.split("\n");for(let r=0;r<i.length;r++)if(0===r)M.push(new d(i[r],!1,e,b));else if(i[r]||t===w.length-1)M.push(new d(i[r],!0,e,b));else{let e=this.combinedStyleToCharacter(w[t+1]);M.push(new d(i[r],!0,e,b))}}else e.text&&M.push(new d(e.text,!1,e,b))}let T="number"==typeof i&&Number.isFinite(i)&&i>0,C="number"==typeof r&&Number.isFinite(r)&&r>0,E="number"==typeof n&&Number.isFinite(n)&&n>0&&(!T||n<=i),B="number"==typeof a&&Number.isFinite(a)&&a>0&&(!C||a<=r),P=new o(0,0,(E?n:T?i:0)||0,(B?a:C?r:0)||0,l,h,u,c,p,f||"horizontal",!E&&T,!B&&C,y||!1,null==(e=this._frameCache)?void 0:e.icons),O=new m(P);if(O.newLine=k,_){let t=0,e=!1;for(let i=0;i<M.length;i++){let r=M[i];e?(r.overflow=!0,r.left=1/0,r.top=1/0,r.newLine||P.lines[P.lines.length-1].paragraphs.push(r)):O.deal(r,!0),P.lines.length!==t&&(t=P.lines.length,O.lineBuffer.length=0,r.overflow=!0,r.left=1e3,r.top=1e3,P.lines[P.lines.length-1].paragraphs.push(r),e=!0),r.newLine&&(e=!1,O.lineWidth=0),O.send()}}else for(let t=0;t<M.length;t++)O.deal(M[t]);if(O.send(),!("horizontal"===P.layoutDirection?E:B)){let t=P.getActualSizeWidthEllipsis(),e="horizontal"===P.layoutDirection?t.width:t.height;("horizontal"===P.layoutDirection?T:C)&&(e=Math.min(e,"horizontal"===P.layoutDirection?i:r)),P.lines.forEach(function(t){t.calcOffset(e,!1)})}k&&P.lines.forEach(t=>{let e=t.paragraphs;t.paragraphs=t.paragraphs.filter(t=>""!==t.text),0===t.paragraphs.length&&e.length&&(e[0].text="\n",t.paragraphs.push(e[0]))}),this._frameCache=P}clone(){return new S(Object.assign({},this.attribute))}setStage(t,e){super.setStage(t,e),this.getFrameCache().icons.forEach(i=>{i.setStage(t,e)})}bindIconEvent(){this.addEventListener("pointermove",t=>{let e=this.pickIcon(t.global);e&&e===this._currentHoverIcon||(e?this.setAttribute("hoverIconId",e.richtextId):!e&&this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0))}),this.addEventListener("pointerleave",t=>{this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0)})}updateHoverIconState(t){var e,i,r,s,n;t?(null==(e=this._currentHoverIcon)||e.setHoverState(!1),this._currentHoverIcon=t,this._currentHoverIcon.setHoverState(!0),null==(i=this.stage)||i.setCursor(t.attribute.cursor),null==(r=this.stage)||r.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,null==(s=this.stage)||s.setCursor(),null==(n=this.stage)||n.renderNextFrame())}pickIcon(t){let e,i=this.getFrameCache(),{e:r,f:s}=this.globalTransMatrix;return i.icons.forEach((i,n)=>{var a,l;let o=i.AABBBounds.clone();o.translate(i._marginArray[3],i._marginArray[0]),o.containsPoint({x:t.x-r,y:t.y-s})&&((e=i).globalX=(null!=(a=e.attribute.x)?a:0)+r+i._marginArray[3],e.globalY=(null!=(l=e.attribute.y)?l:0)+s+i._marginArray[0])}),e}getNoWorkAnimateAttr(){return S.NOWORK_ANIMATE_ATTR}}function k(t){return new S(t)}S.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},n.Wl)},28580:function(t,e,i){"use strict";i.d(e,{Hi:()=>g,MS:()=>m,SZ:()=>f,cV:()=>u,i7:()=>a,nq:()=>c,p3:()=>p});var r=i(96087),s=i(29436),n=i(8385);let a={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},l={fontSize:16,fontFamily:n.iR,fill:!0,stroke:!1,fontWeight:"normal",lineHeight:"normal",fontStyle:"normal",textDecoration:"none",textAlign:"left",script:"normal"};String.fromCharCode(160);let o=/\w|\(|\)|-/,h=/[.?!,;:/，。？！、；：]/,u=/\S/,d=(t,e)=>{let i=e.fontSize||16;switch(e.script){case"super":case"sub":i*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:i,fontFamily:e.fontFamily})};function c(t,e,i){let r=e&&e.fill||l.fill;if(!r)return void(t.globalAlpha=0);let{fillOpacity:n=1,opacity:a=1}=e;t.globalAlpha=n*a,t.fillStyle=i?(0,s.L)(t,r,{AABBBounds:i}):r,d(t,e)}function p(t,e){let i=e&&e.stroke||l.stroke;if(!i)return void(t.globalAlpha=0);let{strokeOpacity:r=1,opacity:s=1}=e;t.globalAlpha=r*s,t.lineWidth=e&&"number"==typeof e.lineWidth?e.lineWidth:1,t.strokeStyle=i,d(t,e)}function g(t,e,i,s,n){if(t.length<=1||!e||e<=0)return 0;let a=r.w.graphicUtil.textMeasure,l=s,o=t.slice(0,l),h=Math.floor(a.measureText(o,i).width),u=t.slice(0,l+1),d=Math.floor(a.measureText(u,i).width);for(;h>e||d<=e;){if(h>e?l--:l++,l>t.length){l=t.length;break}if(l<0){l=0;break}o=t.slice(0,l),h=Math.floor(a.measureText(o,i).width),u=t.slice(0,l+1),d=Math.floor(a.measureText(u,i).width)}return n&&(l=f(t,l)),l}function f(t,e,i=!1){let r=e;for(;o.test(t[r-1])&&o.test(t[r])||h.test(t[r]);)if(--r<=0)return i?function(t,e){let i=e;for(;o.test(t[i+1])&&o.test(t[i])||h.test(t[i]);)if(++i>=t.length)return i;return i+1}(t,e):e;return r}function m(t,e,i="actual"){var s;if(""===t)return{ascent:0,height:0,descent:0,width:0};let n=r.w.graphicUtil.textMeasure.measureText(t,e),a={ascent:0,height:0,descent:0,width:0},l="actual"===i?n.actualBoundingBoxAscent:n.fontBoundingBoxAscent,o="actual"===i?n.actualBoundingBoxDescent:n.fontBoundingBoxDescent;"number"!=typeof l||"number"!=typeof o?(a.width=Math.floor(n.width),a.height=e.fontSize||0,a.ascent=a.height,a.descent=0):(a.width=Math.floor(n.width),a.height=Math.floor(l+o),a.ascent=Math.floor(l),a.descent=a.height-a.ascent);let h=null!=(s=e.space)?s:0;return a.width+=h,a}},14861:function(t,e,i){"use strict";i.d(e,{t:()=>p,m:()=>c});var r=i(31535),s=i(33430),n=i(46560),a=i(96087),l=i(78388),o=i(27177),h=i(42915);let u=(t,e,i)=>{let{outerBorder:r,shadowBlur:s=e.shadowBlur,strokeBoundsBuffer:n=e.strokeBoundsBuffer}=t;if(r){let t=e.outerBorder,{distance:a=t.distance,lineWidth:l=t.lineWidth}=r;(0,h.ph)(i,a+(s+l)/2,!0,n)}return i},d=["symbolType","size",...s.DH];class c extends s.zs{constructor(t={symbolType:"circle"}){super(t),this.type="symbol",this.numberType=o.B5}getParsedPath(){return this.shouldUpdateShape()&&(this._parsedPath=this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}getParsedPath2D(t=0,e=0,i=1){let r=null;try{r=new Path2D}catch(t){return null}let s=this.getParsedPath();if(!s)return null;s.draw(r,i,t,e)}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{size:t}=this.attribute;return(0,r.Z)(t)?2===t.length&&t.every(this._validNumber):this._validNumber(t)}doUpdateParsedPath(){let{symbolType:t="circle"}=this.attribute;return super.parsePath(t)}getGraphicTheme(){return(0,n.gh)(this).symbol}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateSymbolAABBBoundsImprecise(t,e,i):this.updateSymbolAABBBoundsAccurate(t,e,i));let{tb1:s,tb2:n}=a.w.graphicService.updateTempAABBBounds(i);u(t,e,s),i.union(s),s.setValue(n.x1,n.y1,n.x2,n.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,this.x1WithoutTransform=i.x1,this.y1WithoutTransform=i.y1;let{lineJoin:l=e.lineJoin}=t;return a.w.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}updateSymbolAABBBoundsImprecise(t,e,i){let{size:s=e.size}=t;if((0,r.Z)(s))i.set(-s[0]/2,-s[1]/2,s[0]/2,s[1]/2);else{let t=s/2;i.set(-t,-t,t,t)}return i}updateSymbolAABBBoundsAccurate(t,e,i){let{size:r=e.size}=t;return this.getParsedPath().bounds(r,i),i}needUpdateTags(t){return super.needUpdateTags(t,d)}needUpdateTag(t){return super.needUpdateTag(t,d)}toCustomPath(){let t=this.getParsedPath(),e=this.attribute.size,i=(0,r.Z)(e)?e:[e,e];return t.path?(new l.r).fromCustomPath2D(t.path,0,0,i[0],i[1]):(new l.r).fromString(t.pathStr,0,0,i[0],i[1])}clone(){return new c(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return c.NOWORK_ANIMATE_ATTR}}function p(t){return new c(t)}c.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},s.Wl)},29411:function(t,e,i){"use strict";i.d(e,{r:()=>_,x:()=>y});var r=i(28504),s=i(31535),n=i(33049),a=i(76620),l=i(88504),o=i(58539),h=i(95940),u=i(96087),d=i(33430),c=i(46560),p=i(37967),g=i(27177),f=i(42915);let m=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp",...d.DH];class y extends d.zs{get font(){let t=this.getGraphicTheme();return this._font||(this._font=(0,r.U)(this.attribute,t)),this._font}get clipedText(){var t;let e=this.attribute,i=this.getGraphicTheme();return Number.isFinite(this.getMaxWidth(i))?(this.tryUpdateAABBBounds(),this.cache.clipedText):(null!=(t=e.text)?t:i.text).toString()}get clipedWidth(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}get cliped(){var t,e;let i=this.getGraphicTheme(),r=this.attribute;if(!Number.isFinite(this.getMaxWidth(i)))return!1;let{text:s}=this.attribute;if(this.tryUpdateAABBBounds(),null==(e=null==(t=this.cache)?void 0:t.layoutData)?void 0:e.lines){let t="";return this.cache.layoutData.lines.forEach(e=>{t+=e.str}),(Array.isArray(s)?s.join(""):s)!==t}return"vertical"===r.direction&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map(t=>t.text).join("")!==r.text.toString():null!=this.clipedText&&this.clipedText!==r.text.toString()}get multilineLayout(){return this.tryUpdateAABBBounds(),this.cache.layoutData}get isMultiLine(){return Array.isArray(this.attribute.text)||"normal"===this.attribute.whiteSpace}constructor(t={text:"",fontSize:16}){super(t),this.type="text",this.numberType=g.Us,this.cache={}}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{text:t}=this.attribute;return(0,s.Z)(t)?!t.every(t=>null==t||""===t):null!=t&&""!==t}getGraphicTheme(){return(0,c.gh)(this).text}doUpdateOBBBounds(){let t=this.getGraphicTheme();this._OBBBounds.clear();let e=this.attribute,{angle:i=t.angle}=e;if(!i){let t=this.AABBBounds;return this._OBBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._OBBBounds}this.obbText||(this.obbText=new y({})),this.obbText.setAttributes(Object.assign(Object.assign({},e),{angle:0}));let r=this.obbText.AABBBounds,{x:s,y:a}=e,l={x:(r.x1+r.x2)/2,y:(r.y1+r.y2)/2},o=(0,n.xj)(l,i,{x:s,y:a});return this._OBBBounds.copy(r),this._OBBBounds.translate(o.x-l.x,o.y-l.y),this._OBBBounds.angle=i,this._OBBBounds}updateAABBBounds(t,e,i){let{text:r=e.text}=this.attribute;Array.isArray(r)?this.updateMultilineAABBBounds(r):this.updateSingallineAABBBounds(r);let{tb1:s}=u.w.graphicService.updateTempAABBBounds(i),{scaleX:n=e.scaleX,scaleY:l=e.scaleY,shadowBlur:o=e.shadowBlur,strokeBoundsBuffer:h=e.strokeBoundsBuffer}=t;if(o){let t=o/Math.abs(n+l);(0,f.ph)(s,t,!0,h),i.union(s)}return u.w.graphicService.combindShadowAABBBounds(i,this),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||u.w.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,(0,a.n2)(i,i,this.transMatrix),i}updateSingallineAABBBounds(t){this.updateMultilineAABBBounds([t]);let e=this.cache.layoutData;if(e&&e.lines&&e.lines.length){let t=e.lines[0];this.cache.clipedText=t.str,this.cache.clipedWidth=t.width}return this._AABBBounds}updateMultilineAABBBounds(t){let e=this.getGraphicTheme(),{direction:i=e.direction,underlineOffset:r=e.underlineOffset}=this.attribute,s="horizontal"===i?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return"horizontal"===i&&r&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+r),s}guessLineHeightBuf(t){return t?.1*t:0}updateHorizontalMultilineAABBBounds(t){var e;let i=this.getGraphicTheme(),r=this.attribute,{fontFamily:s=i.fontFamily,textAlign:n=i.textAlign,textBaseline:a=i.textBaseline,fontSize:l=i.fontSize,fontWeight:o=i.fontWeight,ellipsis:d=i.ellipsis,maxLineWidth:c,stroke:p=i.stroke,wrap:g=i.wrap,measureMode:f=i.measureMode,lineWidth:m=i.lineWidth,whiteSpace:y=i.whiteSpace,suffixPosition:_=i.suffixPosition,ignoreBuf:v=i.ignoreBuf,keepCenterInLine:b=i.keepCenterInLine}=r,x=v?0:this.guessLineHeightBuf(l),S=this.getLineHeight(r,i,x);if("normal"===y||g)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(null==(e=this.cache)?void 0:e.layoutData)){let t=this.cache.layoutData.bbox;return this._AABBBounds.set(t.xOffset,t.yOffset,t.xOffset+t.width,t.yOffset+t.height),p&&this._AABBBounds.expand(m/2),this._AABBBounds}let k=u.w.graphicUtil.textMeasure,A=new h.j(s,{fontSize:l,fontWeight:o,fontFamily:s,lineHeight:S},k).GetLayoutByLines(t,n,a,S,!0===d?i.ellipsis:d||void 0,!1,{lineWidth:c,suffixPosition:_,measureMode:f,keepCenterInLine:b}),{bbox:M}=A;return this.cache.layoutData=A,this.clearUpdateShapeTag(),this._AABBBounds.set(M.xOffset,M.yOffset,M.xOffset+M.width,M.yOffset+M.height),p&&this._AABBBounds.expand(m/2),this._AABBBounds}updateWrapAABBBounds(t){var e,i,r;let n=this.getGraphicTheme(),{fontFamily:a=n.fontFamily,textAlign:l=n.textAlign,textBaseline:o=n.textBaseline,fontSize:d=n.fontSize,ellipsis:c=n.ellipsis,maxLineWidth:p,stroke:g=n.stroke,lineWidth:f=n.lineWidth,wordBreak:m=n.wordBreak,fontWeight:y=n.fontWeight,ignoreBuf:_=n.ignoreBuf,measureMode:v=n.measureMode,suffixPosition:b=n.suffixPosition,heightLimit:x=0,lineClamp:S,keepCenterInLine:k=n.keepCenterInLine}=this.attribute,A=_?0:this.guessLineHeightBuf(d),M=this.getLineHeight(this.attribute,n,A);if(!this.shouldUpdateShape()&&(null==(e=this.cache)?void 0:e.layoutData)){let t=this.cache.layoutData.bbox;return this._AABBBounds.set(t.xOffset,t.yOffset,t.xOffset+t.width,t.yOffset+t.height),g&&this._AABBBounds.expand(f/2),this._AABBBounds}let w=u.w.graphicUtil.textMeasure,T={fontSize:d,fontWeight:y,fontFamily:a,lineHeight:M},C=new h.j(a,T,w),E=(0,s.Z)(t)?t.map(t=>t.toString()):[t.toString()],B=[],P=[0,0],O=1/0;if(x>0&&(O=Math.max(Math.floor(x/M),1)),S&&(O=Math.min(O,S)),"number"==typeof p&&p!==1/0){if(p>0)for(let t=0;t<E.length;t++){let e=E[t],s=!0;if(t===O-1){let i=w.clipTextWithSuffix(e,T,p,c,!1,b,t!==E.length-1),r=w.measureTextPixelADscentAndWidth(i.str,T,v);B.push({str:i.str,width:i.width,ascent:r.ascent,descent:r.descent,keepCenterInLine:k});break}let n=w.clipText(e,T,p,"break-all"!==m,"keep-all"===m);if(""!==e&&""===n.str||n.wordBreaked){if(c){let t=w.clipTextWithSuffix(e,T,p,c,!1,b);n.str=null!=(i=t.str)?i:"",n.width=null!=(r=t.width)?r:0}else n.str="",n.width=0;s=!1}let a=w.measureTextPixelADscentAndWidth(n.str,T,v);B.push({str:n.str,width:n.width,ascent:a.ascent,descent:a.descent,keepCenterInLine:k});let l=n.str.length;if(n.wordBreaked&&(""===e||""!==n.str)&&(s=!0,l=n.wordBreaked),n.str.length===e.length);else if(s){let i=e.substring(l);"keep-all"===m&&(i=i.replace(/^\s+/g,"")),E.splice(t+1,0,i)}}let t=0;B.forEach(e=>{t=Math.max(t,e.width)}),P[0]=t}else{let t,e,i=0;for(let r=0,s=E.length;r<s;r++){if(r===O-1){let t=w.clipTextWithSuffix(E[r],T,p,c,!1,b),e=w.measureTextPixelADscentAndWidth(t.str,T,v);B.push({str:t.str,width:t.width,ascent:e.ascent,descent:e.descent,keepCenterInLine:k}),i=Math.max(i,t.width);break}e=E[r],i=Math.max(i,t=w.measureTextWidth(e,T));let s=w.measureTextPixelADscentAndWidth(e,T,v);B.push({str:e,width:t,ascent:s.ascent,descent:s.descent,keepCenterInLine:k})}P[0]=i}P[1]=B.length*M;let I={xOffset:0,yOffset:0,width:P[0],height:P[1]};C.LayoutBBox(I,l,o,B);let R=C.layoutWithBBox(I,B,l,o,M);return this.cache.layoutData=R,this.clearUpdateShapeTag(),this._AABBBounds.set(I.xOffset,I.yOffset,I.xOffset+I.width,I.yOffset+I.height),g&&this._AABBBounds.expand(f/2),this._AABBBounds}updateVerticalMultilineAABBBounds(t){var e,i;let r,s=this.getGraphicTheme(),n=u.w.graphicUtil.textMeasure,a=this.attribute,{maxLineWidth:h=s.maxLineWidth,ellipsis:d=s.ellipsis,fontFamily:c=s.fontFamily,fontSize:p=s.fontSize,fontWeight:g=s.fontWeight,stroke:m=s.stroke,lineWidth:_=s.lineWidth,verticalMode:v=s.verticalMode,suffixPosition:b=s.suffixPosition}=a,x=this.getLineHeight(a,s,0),{textAlign:S=s.textAlign,textBaseline:k=s.textBaseline}=a;if(!v){let t=S;S=null!=(e=y.baselineMapAlign[k])?e:"left",k=null!=(i=y.alignMapBaseline[t])?i:"top"}if(r=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach(t=>{let e=t.reduce((t,e)=>t+e.width,0);r=(0,l.Fp)(e,r)});let t=(0,o.js)(S,r),e=this.cache.verticalList.length*x,i=(0,o.nV)(k,e,p);return this._AABBBounds.set(i,t,i+e,t+r),m&&this._AABBBounds.expand(_/2),this._AABBBounds}let A=t.map(t=>(0,f.Xk)(t.toString()));A.forEach((t,e)=>{if(Number.isFinite(h))if(d){let i=!0===d?s.ellipsis:d,a=n.clipTextWithSuffixVertical(t,{fontSize:p,fontWeight:g,fontFamily:c},h,i,!1,b);A[e]=a.verticalList,r=a.width}else{let i=n.clipTextVertical(t,{fontSize:p,fontWeight:g,fontFamily:c},h,!1);A[e]=i.verticalList,r=i.width}else r=0,t.forEach(t=>{let e=t.direction===f.m5.HORIZONTAL?p:n.measureTextWidth(t.text,{fontSize:p,fontWeight:g,fontFamily:c});r+=e,t.width=e})}),this.cache.verticalList=A,this.clearUpdateShapeTag(),this.cache.verticalList.forEach(t=>{let e=t.reduce((t,e)=>t+e.width,0);r=(0,l.Fp)(e,r)});let M=(0,o.js)(S,r),w=this.cache.verticalList.length*x,T=(0,o.nV)(k,w,p);return this._AABBBounds.set(T,M,T+w,M+r),m&&this._AABBBounds.expand(_/2),this._AABBBounds}getMaxWidth(t){var e,i;let r=this.attribute;return null!=(i=null!=(e=r.maxLineWidth)?e:r.maxWidth)?i:t.maxWidth}getLineHeight(t,e,i){var r;return null!=(r=(0,p.VA)(t.lineHeight,t.fontSize||e.fontSize))?r:(t.fontSize||e.fontSize)+i}needUpdateTags(t,e=m){return super.needUpdateTags(t,e)}needUpdateTag(t,e=m){return super.needUpdateTag(t,e)}_interpolate(t,e,i,r,s){"text"===t&&(s.text=r)}clone(){return new y(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return y.NOWORK_ANIMATE_ATTR}getBaselineMapAlign(){return y.baselineMapAlign}getAlignMapBaseline(){return y.alignMapBaseline}}function _(t){return new y(t)}y.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},d.Wl),y.baselineMapAlign={top:"left",bottom:"right",middle:"center"},y.alignMapBaseline={left:"top",right:"bottom",center:"middle"}},46560:function(t,e,i){"use strict";i.d(e,{Q2:()=>h,gh:()=>function t(e,i){return e.glyphHost?t(e.glyphHost):i?(e.isContainer,i):function(t){let e;if(e=t.isContainer?t:t.parent){for(;e&&!e.theme;)e=e.parent;return e?(e.theme||e.createTheme(),e.theme.getTheme(e)):u.getTheme()}return null}(e)||e.attachedThemeGraphic&&t(e.attachedThemeGraphic)||u.getTheme()}});var r=i(30943),s=i(59484);let n={arc:s.Up,area:s.eh,circle:s.t8,line:s.h8,path:s.J7,symbol:s.th,text:s.T5,rect:s.kx,polygon:s.ZD,star:s.VF,richtext:s.Iq,richtextIcon:s.YW,image:s.jK,group:s.bZ,glyph:s.e9},a=Object.keys(n);function l(t,e){Object.keys(e).forEach(i=>{t[i]=e[i]})}let o={arc:Object.assign({},n.arc),area:Object.assign({},n.area),circle:Object.assign({},n.circle),line:Object.assign({},n.line),path:Object.assign({},n.path),symbol:Object.assign({},n.symbol),text:Object.assign({},n.text),rect:Object.assign({},n.rect),polygon:Object.assign({},n.polygon),star:Object.assign({},n.star),richtext:Object.assign({},n.richtext),richtextIcon:Object.assign({},n.richtextIcon),image:Object.assign({},n.image),group:Object.assign({},n.group),glyph:Object.assign({},n.glyph)};class h{constructor(){this.initTheme(),this.dirty=!1}initTheme(){this._defaultTheme={},a.forEach(t=>{this._defaultTheme[t]=Object.create(o[t])}),this.combinedTheme=this._defaultTheme}getTheme(t){if(!t||!this.dirty)return this.combinedTheme;let e={},i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}getParentWithTheme(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}applyTheme(t,e,i=!1){if(this.dirty){let s=this.getParentWithTheme(t);if(s){let t=s.theme;(t.dirty||i)&&t.applyTheme(s,e,!0)}this.userTheme?this.doCombine(s&&s.theme.combinedTheme):(s?this.combinedTheme=s.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,r.Y.getInstance().warn("未知错误，走到不应该走的区域里")),this.dirty=!1)}return this.combinedTheme}doCombine(t){let e=this.userTheme,i=this.combinedTheme;a.forEach(r=>{let s=Object.create(o[r]);t&&t[r]&&l(s,t[r]),i[r]&&l(s,i[r]),e[r]&&l(s,e[r]),this.combinedTheme[r]=s}),e.common&&a.forEach(t=>{l(this.combinedTheme[t],e.common)}),this.dirty=!1}setTheme(t,e){let i=this.userTheme;i?Object.keys(t).forEach(e=>{i[e]?Object.assign(i[e],t[e]):i[e]=Object.assign({},t[e])}):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}resetTheme(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}dirtyChildren(t){t.forEachChildren(t=>{t.isContainer&&(t.theme&&(t.theme.dirty=!0),this.dirtyChildren(t))})}}let u=new h},42915:function(t,e,i){"use strict";i.d(e,{Gg:()=>h,Xk:()=>u,b4:()=>a,m5:()=>s,ph:()=>l});var r,s,n=i(96087);function a(t){var e,i,r,s;return e=this,i=void 0,r=void 0,s=function*(){let e=[],i=t.getChildren();yield new Promise(t=>{n.w.global.getRequestAnimationFrame()(()=>{t(null)})}),i.forEach(t=>{t.subLayers.size&&t.subLayers.forEach(t=>{t.drawContribution&&t.drawContribution.hooks&&t.drawContribution.rendering&&e.push(new Promise(e=>{t.drawContribution.hooks.completeDraw.tap("outWait",()=>{t.drawContribution.hooks.completeDraw.taps=t.drawContribution.hooks.completeDraw.taps.filter(t=>"outWait"!==t.name),e(null)})}))})}),yield Promise.all(e)},new(r||(r=Promise))(function(t,n){function a(t){try{o(s.next(t))}catch(t){n(t)}}function l(t){try{o(s.throw(t))}catch(t){n(t)}}function o(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(a,l)}o((s=s.apply(e,i||[])).next())})}function l(t,e,i,r=0){var s,n;return t.expand(e+(r/2+(i?(s=i,n=e,s?n:0):0))),t}let o=0;function h(){return o++}function u(t){let e=[],i=0,r="";for(let n=0;n<t.length;n++)!function(t){if(d.has(t))return!0;if(c.has(t))return!1;let e=!1;return 256>t.codePointAt(0)&&(e=!0),e}(t[n])?(i&&(e.push({text:r,direction:s.VERTICAL}),r="",i=0),e.push({text:t[n],direction:s.HORIZONTAL})):i?r+=t[n]:(i=1,r=t[n]);return r&&e.push({text:r,direction:s.VERTICAL}),e}(r=s||(s={}))[r.HORIZONTAL=0]="HORIZONTAL",r[r.VERTICAL=1]="VERTICAL";let d=new Map;["…","（","）","—","【","】","「","」","《","》"].forEach(t=>d.set(t,!0));let c=new Map;[""].forEach(t=>c.set(t,!0))},94927:function(t,e,i){"use strict";var r,s;i.d(e,{Q:()=>r}),(s=r||(r={}))[s.INITIAL=0]="INITIAL",s[s.RUNNING=1]="RUNNING",s[s.PAUSE=2]="PAUSE"},72949:function(t,e,i){"use strict";var r,s,n,a;i.d(e,{T:()=>r,t:()=>s}),(n=r||(r={})).wait="wait",n.from="from",n.to="to",n.customAnimate="customAnimate",(a=s||(s={}))[a.INITIAL=0]="INITIAL",a[a.RUNNING=1]="RUNNING",a[a.PAUSED=2]="PAUSED",a[a.END=3]="END"},14226:function(t,e,i){"use strict";var r,s;i.d(e,{r:()=>r}),(s=r||(r={}))[s.estimate=0]="estimate",s[s.actualBounding=1]="actualBounding",s[s.fontBounding=2]="fontBounding"},91925:function(t,e,i){"use strict";i.d(e,{rF:()=>tW,WN:()=>tU,VJ:()=>tV});var r,s=i(14364),n=i(17783),a=i(41809),l=i(55551),o=i(73209),h=i(20420),u=i(8385),d=i(35437),c=i(94966),p=i(65323),g=function(t,e){return function(i,r){e(i,r,t)}};let f=class extends p.w{get env(){return this._env}get isImageAnonymous(){return this._isImageAnonymous}set isImageAnonymous(t){this._isImageAnonymous=t}get devicePixelRatio(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}get supportEvent(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent}set supportEvent(t){this._env||this.setEnv("browser"),this.envContribution.supportEvent=t}get supportsTouchEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents}set supportsTouchEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=t}get supportsPointerEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents}set supportsPointerEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=t}get supportsMouseEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents}set supportsMouseEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=t}get applyStyles(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles}set applyStyles(t){this._env||this.setEnv("browser"),this.envContribution.applyStyles=t}constructor(t){super(),this.contributions=t,this._isImageAnonymous=!0,this._performanceRAFList=[],this.eventListenerTransformer=t=>t,this.id=d.R.GenAutoIncrementId(),this.hooks={onSetEnv:new h.n(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}_nativeAddEventListener(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(t,e,i)}_nativeRemoveEventListener(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(t,e,i)}_nativeDispatchEvent(t){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(t)}bindContribution(t){let e=[];if(this.contributions.getContributions().forEach(i=>{let r=i.configure(this,t);r&&r.then&&e.push(r)}),e.length)return Promise.all(e)}getDynamicCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}getStaticCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}setEnv(t,e){if(e&&!0===e.force||this._env!==t)return this.deactiveCurrentEnv(),this.activeEnv(t,e)}deactiveCurrentEnv(){this.envContribution&&this.envContribution.release()}activeEnv(t,e){let i=this._env;this._env=t;let r=this.bindContribution(e);if(r&&r.then)return r.then(()=>{this.envParams=e,this.hooks.onSetEnv.call(i,t,this)});this.envParams=e,this.hooks.onSetEnv.call(i,t,this)}setActiveEnvContribution(t){this.envContribution=t}createCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(t)}createOffscreenCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(t)}releaseCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(t)}getRequestAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}getSpecifiedRequestAnimationFrame(t){this._env||this.setEnv("browser"),this._performanceRAFList[t]||(this._performanceRAFList[t]=new c.A);let e=this._performanceRAFList[t];return t=>e.addAnimationFrameCb(t)}getSpecifiedCancelAnimationFrame(t){if(this._env||this.setEnv("browser"),!this._performanceRAFList[t])return()=>!1;let e=this._performanceRAFList[t];return t=>e.removeAnimationFrameCb(t)}getCancelAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}getElementById(t){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(t):null}getRootElement(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}getDocument(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}mapToCanvasPoint(t,e){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(t,e):null}loadImage(t){return this._env||this.setEnv("browser"),this.envContribution.loadImage(t)}loadSvg(t){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(t)}loadJson(t){return this._env||this.setEnv("browser"),this.envContribution.loadJson(t)}loadArrayBuffer(t){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(t)}loadBlob(t){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(t)}loadFont(t,e,i){var r,s,n,a;return r=this,s=void 0,n=void 0,a=function*(){return this._env||this.setEnv("browser"),this.envContribution.loadFont(t,e,i)},new(n||(n=Promise))(function(t,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function l(t){try{o(a.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n(function(t){t(r)})).then(i,l)}o((a=a.apply(r,s||[])).next())})}isChrome(){return null!=this._isChrome||(this._env||this.setEnv("browser"),this._isChrome="browser"===this._env&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}isSafari(){return null!=this._isSafari||(this._env||this.setEnv("browser"),this._isSafari="browser"===this._env&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}getNativeAABBBounds(t){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(t)}removeDom(t){return this._env||this.setEnv("browser"),this.envContribution.removeDom(t)}createDom(t){return this._env||this.setEnv("browser"),this.envContribution.createDom(t)}updateDom(t,e){return this._env||this.setEnv("browser"),this.envContribution.updateDom(t,e)}getElementTop(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTop(t,e)}getElementLeft(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(t,e)}getElementTopLeft(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(t,e)}isMacOS(){return this._env||this.setEnv("browser"),this.envContribution.isMacOS()}copyToClipBoard(t){return this._env||this.setEnv("browser"),this.envContribution.copyToClipBoard(t)}};f=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,n.b)(),g(0,(0,a.f)(o.Qc)),g(0,(0,l.t)(u.D0)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],f);var m=i(24053),y=i(59484),_=i(21728),v=i(8992),b=i(64067),x=i(96087),S=i(93279),k=i(52650),A=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a},M=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},w=function(t,e){return function(i,r){e(i,r,t)}};let T=class{get canvas(){return this.tryInitCanvas(),this._canvas}get context(){return this.tryInitCanvas(),this._context}constructor(t){this.contributions=t,this.configured=!1,this.global=x.w.global,this.global.hooks.onSetEnv.tap("graphic-util",(t,e,i)=>{this.configured=!1,this.configure(i,e)})}get textMeasure(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}configure(t,e){this.configured||(this.contributions.getContributions().forEach(t=>{t.configure(this,e)}),this.configured=!0)}tryInitCanvas(){if(!this._canvas){let t=b.A.shareCanvas();this._canvas=t,this._context=t.getContext("2d")}}bindTextMeasure(t){this._textMeasure=t}measureText(t,e,i="native"){var r;this.configure(this.global,this.global.env);let s=this.global.measureTextMethod;this.global.measureTextMethod=i;let n={width:this._textMeasure.measureTextWidth(t,e),height:null!=(r=e.fontSize)?r:y.q9.fontSize};return this.global.measureTextMethod=s,n}createTextMeasureInstance(t,e,i){return this.configure(this.global,this.global.env),new _.e(Object.assign({defaultFontParams:{fontFamily:y.q9.fontFamily,fontSize:y.q9.fontSize},getCanvasForMeasure:i||(()=>this.canvas),getTextBounds:void 0,specialCharSet:"-/: .,@%'\"~"+_.e.ALPHABET_CHAR_SET+_.e.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)}drawGraphicToCanvas(t,e,i){if(!e.defaultLayer)return null;let r=S.n.get(k.Oo),s=t.AABBBounds,n=s.width(),a=s.height(),l=-s.x1,o=-s.y1;r.create({viewBox:{x1:l,y1:o,x2:s.x2,y2:s.y2},width:n,height:a,canvas:i,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""});let h=e.params.optimize.disableCheckGraphicWidthOutRange;e.params.optimize.disableCheckGraphicWidthOutRange=!0,e.defaultLayer.getNativeHandler().drawTo(r,[t],{transMatrix:r.getViewBoxTransform(),viewBox:r.getViewBox(),stage:e,layer:e.defaultLayer,renderService:e.renderService,background:"transparent",clear:!0,updateBounds:!1}),e.params.optimize.disableCheckGraphicWidthOutRange=h;let u=r.getNativeHandler();return u.nativeCanvas?u.nativeCanvas:null}};T=A([(0,n.b)(),w(0,(0,a.f)(o.Qc)),w(0,(0,l.t)(m.j)),M("design:paramtypes",[Object])],T),(tP=tO||(tO={}))[tP.transform=0]="transform",tP[tP.matrix=1]="matrix";let C=new v.y,E=class{constructor(){this.matrix=new v.y}init(t){return this.mode=tO.transform,this.originTransform=t,this.matrix.reset(),this}fromMatrix(t,e){return this.mode=tO.matrix,this.outSourceMatrix=t,this.outTargetMatrix=e,this}scaleMatrix(t,e,i){let r=this.outSourceMatrix;if(C.setValue(r.a,r.b,r.c,r.d,r.e,r.f),this.outTargetMatrix.reset(),i){let{x:r,y:s}=i;this.outTargetMatrix.translate(r,s),this.outTargetMatrix.scale(t,e),this.outTargetMatrix.translate(-r,-s)}else this.outTargetMatrix.scale(t,e);return this.outTargetMatrix.multiply(C.a,C.b,C.c,C.d,C.e,C.f),this}rotateMatrix(t,e){let i=this.outSourceMatrix;if(C.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){let{x:i,y:r}=e;this.outTargetMatrix.translate(i,r),this.outTargetMatrix.rotate(t),this.outTargetMatrix.translate(-i,-r)}else this.outTargetMatrix.rotate(t);return this.outTargetMatrix.multiply(C.a,C.b,C.c,C.d,C.e,C.f),this}scale(t,e,i){return this.mode===tO.matrix?this.scaleMatrix(t,e,i):this}rotate(t,e){return this.mode===tO.matrix?this.rotateMatrix(t,e):this}translateMatrix(t,e){let i=this.outSourceMatrix;return C.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(t,e),this.outTargetMatrix.multiply(C.a,C.b,C.c,C.d,C.e,C.f),this}translate(t,e){return this.mode===tO.matrix?this.translateMatrix(t,e):this}simplify(t){return this.mode===tO.matrix?this.simplifyMatrix(t):this}simplifyMatrix(t){return this}};E=A([(0,n.b)(),M("design:paramtypes",[])],E);var B=i(46560),P=i(53068);class O extends P.ZA{get offscreen(){return this.layerHandler.offscreen}get layerMode(){return this.layerHandler.type}get width(){return this.stage?this.stage.width:0}get height(){return this.stage?this.stage.height:0}get viewWidth(){return this.stage?this.stage.viewWidth:0}get viewHeight(){return this.stage?this.stage.viewHeight:0}get dirtyBound(){throw Error("暂不支持")}get dpr(){return this._dpr}constructor(t,e,i,r){var s;super({}),this.stage=t,this.global=e,this.window=i,this.main=r.main,this.layerHandler=r.layerHandler,this.layerHandler.init(this,i,{main:r.main,canvasId:r.canvasId,width:this.viewWidth,height:this.viewHeight,zIndex:null!=(s=r.zIndex)?s:0}),this.layer=this,this.subLayers=new Map,this.theme=new B.Q2,this.background="rgba(0, 0, 0, 0)",this.afterDrawCbs=[]}combineSubLayer(t=!0){let e=Array.from(this.subLayers.values()).sort((t,e)=>t.zIndex-e.zIndex);this.layerHandler.merge(e.map(e=>(e.layer.subLayers.size&&e.layer.combineSubLayer(t),e.layer.getNativeHandler()))),t&&e.forEach(t=>{t.group&&(t.group.incremental=0)}),e.forEach(t=>{x.w.layerService.releaseLayer(this.stage,t.layer)}),this.subLayers.clear()}getNativeHandler(){return this.layerHandler}setStage(t,e){super.setStage(t,this)}pick(t,e){throw Error("暂不支持")}tryRenderSecondaryLayer(t,e){this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach(i=>{i.layer.renderCount=this.renderCount,i.layer.render(t,e)})}render(t,e){var i;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:null!=(i=t.background)?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach(t=>t(this)),this.tryRenderSecondaryLayer(t,e)}resize(t,e){this.layerHandler.resize(t,e)}resizeView(t,e){this.layerHandler.resizeView(t,e)}setDpr(t){this.layerHandler.setDpr(t)}afterDraw(t){this.afterDrawCbs.push(t)}startAnimate(t){throw Error("暂不支持")}setToFrame(t){throw Error("暂不支持")}prepare(t,e){}release(){super.release(),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach(t=>{x.w.layerService.releaseLayer(this.stage,t.layer)})}drawTo(t,e){var i;this.layerHandler.drawTo(t,[this],Object.assign({background:null!=(i=e.background)?i:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach(t=>t(this))}}var I=i(69507);let R=tI=class{static GenerateLayerId(){return`${tI.idprefix}_${tI.prefix_count++}`}constructor(){this.layerMap=new Map,this.global=x.w.global}tryInit(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}getStageLayer(t){return this.layerMap.get(t)}getRecommendedLayerType(t){return t||(0!==this.staticLayerCountInEnv?"static":0!==this.dynamicLayerCountInEnv?"dynamic":"virtual")}getLayerHandler(t){return"static"===t?S.n.get(I.kj):"dynamic"===t?S.n.get(I.ym):S.n.get(I.XJ)}createLayer(t,e={main:!1}){var i;this.tryInit();let r=this.getRecommendedLayerType(e.layerMode);r=e.main||e.canvasId?"static":r;let s=this.getLayerHandler(r),n=new O(t,this.global,t.window,Object.assign(Object.assign({main:!1},e),{layerMode:r,canvasId:null!=(i=e.canvasId)?i:tI.GenerateLayerId(),layerHandler:s})),a=this.layerMap.get(t)||[];return a.push(n),this.layerMap.set(t,a),this.staticLayerCountInEnv--,n}prepareStageLayer(t){let e;t.forEachChildren(t=>{let i=t.getNativeHandler();"virtual"===i.type?(i.mainHandler=e,e.secondaryHandlers.push(i)):(e=i).secondaryHandlers=[]})}releaseLayer(t,e){e.release();let i=this.layerMap.get(t)||[];this.layerMap.set(t,i.filter(t=>t!==e))}layerCount(t){return(this.layerMap.get(t)||[]).length}restLayerCount(t){return 10*("browser"===this.global.env)}releaseStage(t){this.layerMap.delete(t)}};R.idprefix="visactor_layer",R.prefix_count=0,R=tI=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,n.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],R);let L=new s.n(t=>{t(u.y2).to(f).inSingletonScope(),t(k.Oo).to(k.Il),t(I.no).to(T).inSingletonScope(),t(I.Gp).to(E).inSingletonScope(),t(I.IT).to(R).inSingletonScope()});var D=i(18346);let F=new s.n(t=>{t(D.pi).to(D.I2)});var z=i(85074),j=i(41457),H=i(53627),N=i(96141),V=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};let W=class{constructor(){this.order=1}afterPickItem(t,e,i,r,s){if(t.graphic){let e=t.graphic;for(;e.parent;)e=e.parent;e.shadowHost&&(t.params={shadowTarget:t.graphic},t.graphic=e.shadowHost)}return t}};W=V([(0,n.b)()],W);let U=class{constructor(){this.order=1}afterPickItem(t,e,i,r,s){return t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx?this._pickItem(t,e,i,r,s):null}beforePickItem(t,e,i,r,s){return t.attribute.shadowRootIdx<0?this._pickItem(t,e,i,r,s):null}_pickItem(t,e,i,r,s){var n;if(!t.shadowRoot)return null;let{parentMatrix:a}=s||{};if(!a)return null;let l=e.pickContext;l.highPerformanceSave();let o=null==(n=(0,B.gh)(t))?void 0:n[t.type],{shadowPickMode:h=null==o?void 0:o.shadowPickMode}=t.attribute,u=t.shadowRoot,d=H.QE.allocateByObj(a),c=new j.E9(d.a*i.x+d.c*i.y+d.e,d.b*i.x+d.d*i.y+d.f),p=e.pickGroup(u,c,d,r);return l.highPerformanceRestore(),!p.graphic&&p.group&&"full"===h&&(p.graphic=p.group),p}};U=V([(0,n.b)()],U);let G=class{constructor(){this.order=1}beforePickItem(t,e,i,r,s){let n=t.baseGraphic;if(n&&n.parent){let t=new j.E9(i.x,i.y),s=e.pickContext;s.highPerformanceSave();let a=n.parent.globalTransMatrix;a.transformPoint(t,t);let l=n.isContainer?e.pickGroup(n,t.clone(),a,r):e.pickItem(n,t.clone(),a,r);return s.highPerformanceRestore(),l}return null}};G=V([(0,n.b)()],G);let Z=class{constructor(){this.order=1}beforePickItem(t,e,i,r,s){if(!t.in3dMode||r.in3dInterceptor)return null;let n=e.pickContext,a=t.stage;if(!n||!a)return null;if(r.in3dInterceptor=!0,n.save(),this.initCanvasCtx(n),n.camera=a.camera,t.isContainer){let a=(0,N.y)(n,t,()=>e.pickGroup(t,i,s.parentMatrix,r),r);return n.camera=null,r.in3dInterceptor=!1,n.restore(),a}return n.restore(),null}initCanvasCtx(t){t.setTransformForCurrent()}};Z=V([(0,n.b)()],Z);let $=new s.n((t,e,i)=>{i(z.hH)||(t(z.BR).toSelf(),t(z.hH).toService(z.BR)),t(Z).toSelf().inSingletonScope(),t(z.uH).toService(Z),t(U).toSelf().inSingletonScope(),t(z.uH).toService(U),t(G).toSelf().inSingletonScope(),t(z.uH).toService(G),(0,o.yb)(t,z.uH),t(W).toSelf().inSingletonScope(),t(z.tn).toService(W),(0,o.yb)(t,z.tn)});var Y=i(88758),X=i(27177),K=i(20672);let q=new s.n(t=>{t(X.fB).to(Y.JG),t(X.tA).toConstantValue(K.i)});var Q=i(66838),J=function(t,e){return function(i,r){e(i,r,t)}};let te=class{constructor(t){this.autoEnablePlugins=t,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}active(t,e){this.stage=t,this.actived=!0;let{pluginList:i}=e;i&&S.n.isBound(Q.X)&&this.autoEnablePlugins.getContributions().forEach(t=>{i.includes(t.name)&&this.register(t)})}findPluginsByName(t){let e=[];return this.onStartupFinishedPlugin.forEach(i=>{i.name===t&&e.push(i)}),this.onRegisterPlugin.forEach(i=>{i.name===t&&e.push(i)}),e}register(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.push(t):"onRegister"===t.activeEvent&&(this.onRegisterPlugin.push(t),t.activate(this))}unRegister(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1):"onRegister"===t.activeEvent&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1),t.deactivate(this)}release(...t){this.onStartupFinishedPlugin.forEach(t=>{t.deactivate(this)}),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach(t=>{t.deactivate(this)}),this.onRegisterPlugin=[]}};te=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,n.b)(),J(0,(0,a.f)(o.Qc)),J(0,(0,l.t)(Q.X)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],te);let ti=new s.n(t=>{t(Q.H).to(te),(0,o.EM)(t,Q.X)}),tr=new s.n(t=>{(0,o.yb)(t,u.D0)}),ts=new s.n(t=>{t(m.j).to(m.f).inSingletonScope(),(0,o.yb)(t,m.j)});var tn=i(38286);let ta=class{constructor(){this.type="static",this.offscreen=!1,this.global=x.w.global}setDpr(t){this.canvas.dpr=t}init(t,e,i){if(this.layer=t,this.window=e,i.main)this.main=!0,this.context=e.getContext(),this.canvas=this.context.getCanvas();else{let t;this.main=!1,i.canvasId&&(t=this.global.getElementById(i.canvasId)),t||(t=this.global.createCanvas({width:e.width,height:e.height})),t.style&&(t.style["pointer-events"]="none");let r=e.getContext().getCanvas().nativeCanvas,s=(0,tn.JN)({nativeCanvas:t,width:e.width,height:e.height,dpr:e.dpr,id:i.canvasId,canvasControled:!0,container:e.getContainer(),x:r.offsetLeft,y:r.offsetTop});s.applyPosition(),this.canvas=s,this.context=s.getContext()}}resize(t,e){this.canvas.resize(t,e)}resizeView(t,e){}render(t,e,i){var r;if(!this.main){let t=this.window.getContext().getCanvas().nativeCanvas;t&&(this.canvas.x!==t.offsetLeft||this.canvas.y!==t.offsetTop)&&(this.canvas.x=t.offsetLeft,this.canvas.y=t.offsetTop,this.canvas.applyPosition())}e.renderService.render(t,Object.assign(Object.assign({context:this.context,clear:null!=(r=e.background)?r:"#ffffff"},e),i))}merge(t){t.forEach(t=>{let e=t.getContext().canvas.nativeCanvas;this.context.drawImage(e,0,0)})}prepare(t,e){}drawTo(t,e,i){var r;let s=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:s},i),{clear:i.clear?null!=(r=i.background)?r:"#fff":void 0}))}getContext(){return this.context}release(){this.canvas.release()}};ta=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,n.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],ta);let tl=new s.n(t=>{t(ta).toSelf(),t(I.kj).toService(ta)});var to=i(76239);let th=(0,i(17126).v)(to.Lc);var tu=i(54723),td=i(76620),tc=i(31535),tp=i(33049),tg=i(30943),tf=i(65719),tm=i(43722),ty=i(29436),t_=i(19293),tv=function(t,e){return function(i,r){e(i,r,t)}};let tb=class{constructor(t,e){this.contributions=t,this.drawItemInterceptorContributions=e,this._renderInGroup=(t,e,i,r)=>{var s;t?e.forEachChildren(t=>{i.break||(t.isContainer?this.renderGroup(t,i,r):this.renderItem(t,i))}):(0,tu.kD)(e,y.xF.zIndex,t=>{i.break||(t.isContainer?this.renderGroup(t,i,r):this.renderItem(t,i))},!1,!!(null==(s=i.context)?void 0:s.camera))},this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new td.YZ,this.backupDirtyBounds=new td.YZ,this.global=x.w.global,this.layerService=x.w.layerService,(0,tc.Z)(this.contributions)||(this.contributions=[this.contributions]),this.init()}reInit(){this.init(),this.contributions.forEach(t=>{t.reInit()})}init(){this.contributions.forEach(t=>{if(t.style){let e=this.styleRenderMap.get(t.style)||new Map;e.set(t.numberType,t),this.styleRenderMap.set(t.style,e)}else this.defaultRenderMap.set(t.numberType,t)}),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order)}prepareForDraw(t,e){e.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!e.stage.params.optimize.disableCheckGraphicWidthOutRange}draw(t,e){var i;this.prepareForDraw(t,e),e.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(e.renderStyle)||this.defaultRenderMap,this.currentRenderService=t;let{context:r,stage:s,viewBox:n,transMatrix:a}=e;if(!r)return;let l=this.dirtyBounds.setValue(0,0,n.width(),n.height());if(s.dirtyBounds&&!s.dirtyBounds.empty()){let t=(0,tp.di)(l,s.dirtyBounds,!1);l.x1=Math.floor(t.x1),l.y1=Math.floor(t.y1),l.x2=Math.ceil(t.x2),l.y2=Math.ceil(t.y2)}let o=r.dpr%1;(o||.5!==o)&&(l.x1=Math.floor(l.x1*r.dpr)/r.dpr,l.y1=Math.floor(l.y1*r.dpr)/r.dpr,l.x2=Math.ceil(l.x2*r.dpr)/r.dpr,l.y2=Math.ceil(l.y2*r.dpr)/r.dpr),this.backupDirtyBounds.copy(l),r.reset(!1),r.save(),r.setClearMatrix(a.a,a.b,a.c,a.d,a.e,a.f),r.clearMatrix(!1),r.translate(n.x1,n.y1,!0),r.beginPath(),r.rect(l.x1,l.y1,l.width(),l.height()),r.clip(),s.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(t,r,e),(null==(i=t.drawParams)?void 0:i.stage)&&t.drawParams.stage.hooks.afterClearScreen.call(t.drawParams),t.renderTreeRoots.sort((t,e)=>{var i,r;return(null!=(i=t.attribute.zIndex)?i:y.xF.zIndex)-(null!=(r=e.attribute.zIndex)?r:y.xF.zIndex)}).forEach(t=>{t.isContainer?this.renderGroup(t,e,H.QE.allocate(1,0,0,1,0,0)):this.renderItem(t,e)}),r.restore(),r.draw()}doRegister(){throw Error("暂不支持")}_findNextGraphic(t){let e=t.parent,i=t._uid;for(;e;){let t=(0,tu.qA)(e,i,y.xF.zIndex);if(t)return t;i=e._uid,e=e.parent}return null}renderGroup(t,e,i,r){if(e.break||!1===t.attribute.visibleAll)return;if(t.incremental&&(null==e.startAtId||e.startAtId===t._uid))return e.break=!0,void this._increaseRender(t,e);if(this.useDirtyBounds&&!(0,tp.SX)(t.AABBBounds,this.dirtyBounds,!1)&&"empty"!==t.attribute.boundsMode)return;let s,n=i;if(this.useDirtyBounds){s=t_.et.allocateByObj(this.dirtyBounds);let e=t.transMatrix;n=H.QE.allocateByObj(i).multiply(e.a,e.b,e.c,e.d,e.e,e.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(n.getInverse())}e.isGroupScroll=!(!t.attribute.scrollX&&!t.attribute.scrollY),this.renderItem(t,e,{renderInGroupParams:{skipSort:r,nextM:n},renderInGroup:this._renderInGroup}),this.useDirtyBounds&&(this.dirtyBounds.copy(s),t_.et.free(s),H.QE.free(n))}_increaseRender(t,e){let{layer:i,stage:r}=e,{subLayers:s}=i,n=s.get(t._uid);n||(n={layer:this.layerService.createLayer(r),zIndex:s.size,group:t},s.set(t._uid,n));let a=n.layer.getNativeHandler().getContext(),l=n.drawContribution||S.n.get(tf.Pf);l.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),l.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),l.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:l,clear:"transparent",layer:n.layer,context:a,startAtId:t._uid,break:!1})),n.drawContribution=l;let o=this._findNextGraphic(t);if(o)if(o.isContainer&&o.incremental)this._increaseRender(o,e);else{let t=s.get(o._uid);t||(t={layer:this.layerService.createLayer(r),zIndex:s.size},s.set(o._uid,t));let i=t.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:l,clear:"transparent",layer:t.layer,context:i,startAtId:o._uid,break:!1}))}}getRenderContribution(t){let e;return e||(e=this.selectRenderByNumberType(t.numberType,t)),e||(e=this.selectRenderByType(t.type)),e}renderItem(t,e,i){if(this.InterceptorContributions.length)for(let r=0;r<this.InterceptorContributions.length;r++){let s=this.InterceptorContributions[r];if(s.beforeDrawItem&&s.beforeDrawItem(t,this.currentRenderService,e,this,i))return}let r=this.getRenderContribution(t);if(!r)return;let s,n=!1;if(e.isGroupScroll){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;n=!0,this.scrollMatrix||(this.scrollMatrix=H.QE.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-e,-i)}if(n&&(s=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),this.useDirtyBounds&&!t.isContainer&&"empty"!==t.attribute.boundsMode&&!(0,tp.SX)(t.AABBBounds,null!=s?s:this.dirtyBounds,!1)){if(n&&t.parent){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(e,i)}return}let a=null!=e.startAtId&&t._uid!==e.startAtId;if(t._uid===e.startAtId&&(e.startAtId=null),i&&(i.skipDraw=a),a?t.isContainer&&r.draw(t,this.currentRenderService,e,i):r.draw(t,this.currentRenderService,e,i),n&&t.parent){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(e,i)}if(this.InterceptorContributions.length)for(let i=0;i<this.InterceptorContributions.length;i++){let r=this.InterceptorContributions[i];if(r.afterDrawItem&&r.afterDrawItem(t,this.currentRenderService,e,this))return}}selectRenderByType(t){return tg.Y.getInstance().warn("未知错误，不应该走到这里"),null}selectRenderByNumberType(t,e){let i;if(e.attribute.renderStyle){let r=this.styleRenderMap.get(e.attribute.renderStyle);i=r&&r.get(t)}return i||this.currentRenderMap.get(t)||this.defaultRenderMap.get(t)}clearScreen(t,e,i){var r,s,n;let{clear:a,viewBox:l}=i,o=l.width(),h=l.height();if(a){e.clearRect(0,0,o,h),(null==(r=t.drawParams)?void 0:r.stage)&&t.drawParams.stage.hooks.afterClearRect.call(t.drawParams);let i=null==(s=t.drawParams)?void 0:s.stage;if(i&&(e.globalAlpha=null!=(n=i.attribute.opacity)?n:1),i&&i.backgroundImg&&i.resources){let t=i.resources.get(a);t&&"success"===t.state&&t.data&&e.drawImage(t.data,0,0,o,h)}else e.fillStyle=(0,ty.L)(e,a,{AABBBounds:{x1:0,y1:0,x2:0+o,y2:0+h}},0,0),e.fillRect(0,0,o,h)}}afterDraw(t,e){}};tb=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,n.b)(),tv(0,th(tf.uz)),tv(1,(0,a.f)(o.Qc)),tv(1,(0,l.t)(tm.xL)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Array,Object])],tb);var tx=i(24806),tS=i(60738),tk=i(90552),tA=i(33760),tM=i(26036);class tw extends tM.M2{constructor(){super(...arguments),this.time=tA.Oh.beforeFillStroke}drawShape(t,e,i,r,s,n,a,l,o,h,u,d){let{background:c,backgroundMode:p=o.backgroundMode,backgroundFit:g=o.backgroundFit,backgroundKeepAspectRatio:f=o.backgroundKeepAspectRatio,backgroundScale:m=o.backgroundScale,backgroundOffsetX:y=o.backgroundOffsetX,backgroundOffsetY:_=o.backgroundOffsetY}=t.attribute;if(c)if(t.backgroundImg&&t.resources){let i=t.resources.get(c);if("success"!==i.state||!i.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);let r=t.AABBBounds;this.doDrawImage(e,i.data,r,{backgroundMode:p,backgroundFit:g,backgroundKeepAspectRatio:f,backgroundScale:m,backgroundOffsetX:y,backgroundOffsetY:_}),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=c,e.fill(),e.highPerformanceRestore()}}let tT=new tw;var tC=i(46527),tE=function(t,e){return function(i,r){e(i,r,t)}};let tB=class{constructor(t){this.groupRenderContribitions=t,this.numberType=X.I_}reInit(){this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(tT)}drawShape(t,e,i,r,s,n,a,l,o){let{clip:h,fill:u,stroke:d,background:c}=t.attribute;if(!(h||u||d||c))return;o=null!=o?o:(0,B.gh)(t,null==n?void 0:n.theme).group;let{opacity:p=o.opacity,width:g=o.width,height:f=o.height,fillOpacity:m=o.fillOpacity,strokeOpacity:y=o.strokeOpacity,cornerRadius:_=o.cornerRadius,path:v=o.path,lineWidth:b=o.lineWidth,visible:x=o.visible,fillStrokeOrder:S=o.fillStrokeOrder,cornerType:k=o.cornerType,x:A=o.x,y:M=o.y}=t.attribute,w=(0,tS.GT)(p,m,g,f,u),T=(0,tS.Ze)(p,y,g,f),C=(0,tS.dz)(u,c),E=(0,tS.ak)(d,b);if(!t.valid||!x||!h&&(!C&&!E||!(w||T||a||l||c)))return;if(v&&v.length&&s.drawContribution){let t=e.disableFill,i=e.disableStroke,r=e.disableBeginPath;e.disableFill=!0,e.disableStroke=!0,e.disableBeginPath=!0,v.forEach(t=>{s.drawContribution.getRenderContribution(t).draw(t,s.renderService,s,n)}),e.disableFill=t,e.disableStroke=i,e.disableBeginPath=r}else 0===_||(0,tc.Z)(_)&&_.every(t=>0===t)?(e.beginPath(),e.rect(i,r,g,f)):(e.beginPath(),(0,tx.U)(e,i,r,g,f,_,"bevel"!==k));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(tT));let P={doFill:C,doStroke:E};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this._groupRenderContribitions.forEach(n=>{n.time===tA.Oh.beforeFillStroke&&n.drawShape(t,e,i,r,C,E,w,T,o,s,a,l,P)}),h&&e.clip();let O=()=>{P.doFill&&(a?a(e,t.attribute,o):w&&(e.setCommonStyle(t,t.attribute,A-i,M-r,o),e.fill()))},I=()=>{P.doStroke&&(l?l(e,t.attribute,o):T&&(e.setStrokeStyle(t,t.attribute,A-i,M-r,o),e.stroke()))};S?(I(),O()):(O(),I()),this._groupRenderContribitions.forEach(n=>{n.time===tA.Oh.afterFillStroke&&n.drawShape(t,e,i,r,C,E,w,T,o,s,a,l)})}draw(t,e,i,r){var s,n;let a,{context:l}=i;if(!l)return;let{clip:o,baseOpacity:h=1,drawMode:u}=t.attribute,d=l.nativeContext,c=l.canvas.nativeCanvas;if(u>0){let{x:e,y:i,width:r,height:s}=t.attribute,n=l.canvas,a=x.w.global.createCanvas({width:n.width,height:n.height,dpr:1}),o=a.getContext("2d"),h=l.nativeContext.getTransform();o.setTransform(h.a,h.b,h.c,h.d,h.e,h.f),1===u&&(o.save(),o.clearRect(0,0,n.width,n.height),o.beginPath(),o.rect(e,i,r,s),o.clip(),o.drawImage(n.nativeCanvas,0,0,n.width,n.height,0,0,n.displayWidth,n.displayHeight),o.restore()),l.nativeContext=o,n.nativeCanvas=a}o?l.save():l.highPerformanceSave();let p=l.baseGlobalAlpha;l.baseGlobalAlpha*=h;let g=l.modelMatrix;if(l.camera){let e=(0,B.gh)(t,null==r?void 0:r.theme).group,i=H.yp.allocate(),s=H.yp.allocate();(0,Y.RT)(s,t,e),(0,tC.G9)(i,g||i,s),l.modelMatrix=i,H.yp.free(s),l.setTransform(1,0,0,1,0,0,!0)}else l.transformFromMatrix(t.transMatrix,!0);l.beginPath(),r.skipDraw?this.drawShape(t,l,0,0,i,r,()=>!1,()=>!1):this.drawShape(t,l,0,0,i,null,null,null);let{scrollX:f,scrollY:m}=t.attribute;if((f||m)&&l.translate(f,m),r&&r.renderInGroup&&(a=r.renderInGroup(null==(s=r.renderInGroupParams)?void 0:s.skipSort,t,i,null==(n=r.renderInGroupParams)?void 0:n.nextM)),l.modelMatrix!==g&&H.yp.free(l.modelMatrix),l.modelMatrix=g,l.baseGlobalAlpha=p,u>0){let{x:e,y:i,width:r,height:s}=t.attribute,n=l.nativeContext,a=l.canvas.nativeCanvas;d.save(),d.setTransform(l.dpr,0,0,l.dpr,0,0,!0),1===u&&n.rect(e,i,r,s),d.drawImage(a,0,0,a.width,a.height,0,0,l.canvas.displayWidth,l.canvas.displayHeight);let o=n.getTransform();d.setTransform(o.a,o.b,o.c,o.d,o.e,o.f),l.nativeContext=d,l.canvas.nativeCanvas=c,d.restore()}a&&a.then?a.then(()=>{o?l.restore():l.highPerformanceRestore()}):o?l.restore():l.highPerformanceRestore()}};tB=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,n.b)(),tE(0,(0,a.f)(o.Qc)),tE(0,(0,l.t)(tk.jd)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],tB);var tP,tO,tI,tR,tL=i(19721),tD=i(25044),tF=function(t,e){return function(i,r){e(i,r,t)}},tz=function(t,e,i,r){return new(i||(i=Promise))(function(s,n){function a(t){try{o(r.next(t))}catch(t){n(t)}}function l(t){try{o(r.throw(t))}catch(t){n(t)}}function o(t){var e;t.done?s(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(a,l)}o((r=r.apply(t,e||[])).next())})};(r=tR||(tR={}))[r.NORMAL=0]="NORMAL",r[r.STOP=1]="STOP";let tj=class extends tb{constructor(t,e,i,r){super(t,r),this.contributions=t,this.lineRender=e,this.areaRender=i,this.drawItemInterceptorContributions=r,this.rendering=!1,this.currFrameStartAt=0,this.currentIdx=0,this.status=tR.NORMAL,this.checkingForDrawPromise=null,this.hooks={completeDraw:new h.n([])},this.defaultRenderMap.set(this.lineRender.numberType,this.lineRender),this.defaultRenderMap.set(this.areaRender.numberType,this.areaRender)}draw(t,e){return tz(this,void 0,void 0,function*(){if(this.checkingForDrawPromise)return;this.lastRenderService=t,this.lastDrawContext=e,this.checkingForDrawPromise=this.checkForDraw(e);let i=yield this.checkingForDrawPromise;if(this.checkingForDrawPromise=null,i)return;this.currentRenderService=t;let{context:r,viewBox:s}=e;r&&(r.inuse=!0,r.clearMatrix(),r.setTransformForCurrent(!0),r.save(),e.restartIncremental&&this.clearScreen(this.currentRenderService,r,e),r.translate(s.x1,s.y1,!0),r.save(),t.renderTreeRoots.sort((t,e)=>{var i,r;return(null!=(i=t.attribute.zIndex)?i:y.xF.zIndex)-(null!=(r=e.attribute.zIndex)?r:y.xF.zIndex)}).forEach(t=>{this.renderGroup(t,e)}),this.hooks.completeDraw.tap("top-draw",()=>{r.restore(),r.restore(),r.draw(),r.inuse=!1,this.rendering=!1}))})}_increaseRender(t,e){return tz(this,void 0,void 0,function*(){this.rendering=!0,yield this._renderIncrementalGroup(t,e)})}_renderIncrementalGroup(t,e){return tz(this,void 0,void 0,function*(){this.count=t.count,yield new Promise(i=>{this.renderItem(t,e,{drawingCb:()=>tz(this,void 0,void 0,function*(){if(2!==t.count)yield(0,tu.Ud)(t,y.xF.zIndex,(i,r)=>{if(this.status===tR.STOP)return!0;if(i.isContainer||r<this.currentIdx)return!1;let s=this.currFrameStartAt+t.incremental;return r<s&&(this.currentIdx=r+1,this.renderItem(i,e)),r===s-1&&(this.currFrameStartAt=this.currentIdx,this.waitToNextFrame())}),i(!1);else{let r=t.getChildAt(0);if(r.incremental&&r.attribute.segments)for(r.incrementalAt||(r.incrementalAt=0);r.incrementalAt<r.attribute.segments.length;)e.multiGraphicOptions={startAtIdx:r.incrementalAt,length:r.incremental},this.renderItem(r,e),r.incrementalAt+=r.incremental,yield this.waitToNextFrame();else this.renderItem(r,e);i(!1)}})})}),this.hooks.completeDraw.call()})}waitToNextFrame(){return tz(this,void 0,void 0,function*(){return new Promise(t=>{this.global.getRequestAnimationFrame()(()=>{t(!1)})})})}checkForDraw(t){return tz(this,void 0,void 0,function*(){let e=this.rendering;return t.restartIncremental&&(e=!1,yield this.forceStop(),this.resetToInit()),e})}forceStop(){return tz(this,void 0,void 0,function*(){this.rendering&&(this.status=tR.STOP,yield new Promise(t=>{this.hooks.completeDraw.tap("stopCb",()=>{this.status=tR.NORMAL,this.hooks.completeDraw.taps=this.hooks.completeDraw.taps.filter(t=>"stopCb"!==t.name),t(!1)})}))})}resetToInit(){this.currFrameStartAt=0,this.currentIdx=0}renderGroup(t,e){return tz(this,void 0,void 0,function*(){if(!e.break&&!1!==t.attribute.visibleAll)return t.incremental&&e.startAtId===t._uid?(yield this._increaseRender(t,e),void(e.break=!0)):void(yield new Promise(i=>{this.renderItem(t,e,{drawingCb:()=>tz(this,void 0,void 0,function*(){yield(0,tu.Ud)(t,y.xF.zIndex,t=>tz(this,void 0,void 0,function*(){e.break||t.isContainer&&(yield this.renderGroup(t,e))})),i(!1)})})}))})}};tj=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,n.b)(),tF(0,th(tf.uz)),tF(1,(0,a.f)(tL.U)),tF(2,(0,a.f)(tD.K)),tF(3,(0,a.f)(o.Qc)),tF(3,(0,l.t)(tm.xL)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Array,Object,Object,Object])],tj);var tH=i(26227);let tN=new s.n(t=>{t(tM.M2).toSelf().inSingletonScope(),t(tH.$).toSelf().inSingletonScope(),t(tf.Iv).to(tb),t(tf.Pf).to(tj),t(tf.Cb).to(tB).inSingletonScope(),t(tf.uz).toService(tf.Cb),(0,o.yb)(t,tk.jd),t(tM.Sg).toSelf().inSingletonScope(),(0,o.yb)(t,tk.tg),(0,o.yb)(t,tf.uz),t(tm.pN).toSelf().inSingletonScope(),t(tm.xL).toService(tm.pN),(0,o.yb)(t,tm.xL)});function tV(){var t;tV.__loaded||(tV.__loaded=!0,S.n.load(L),S.n.load(q),S.n.load(F),S.n.load($),S.n.load(ti),(t=S.n).load(tr),t.load(ts),t.load(tl),S.n.load(tN))}tV.__loaded=!1,tV();let tW=S.n.get(u.y2);x.w.global=tW;let tU=S.n.get(I.no);x.w.graphicUtil=tU;let tG=S.n.get(I.Gp);x.w.transformUtil=tG;let tZ=S.n.get(X.fB);x.w.graphicService=tZ;let t$=S.n.get(D.pi);x.w.renderService=t$;let tY=S.n.get(I.IT);x.w.layerService=tY},85074:function(t,e,i){"use strict";i.d(e,{BR:()=>s,hH:()=>r,tn:()=>a,uH:()=>n}),Symbol.for("GraphicPicker");let r=Symbol.for("PickerService");Symbol.for("BoundsPicker");let s=Symbol.for("GlobalPickerService"),n=Symbol.for("PickItemInterceptor"),a=Symbol.for("PickServiceInterceptor")},35056:function(t,e,i){"use strict";i.d(e,{f:()=>_});var r=i(76620),s=i(8992),n=i(41457),a=i(17783),l=i(41809),o=i(55551),h=i(54723),u=i(73209),d=i(46560),c=i(59484),p=i(46527),g=i(53627),f=i(96087),m=i(85074),y=function(t,e){return function(i,r){e(i,r,t)}};let _=class{constructor(t,e){this.pickItemInterceptorContributions=t,this.pickServiceInterceptorContributions=e,this.type="default",this.global=f.w.global}reInit(){this._init()}_init(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order),this.pickerServiceInterceptorContributions=this.pickServiceInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order)}pick(t,e,i){let n,a={graphic:null,group:null};i.pickerService=this;let l=i.bounds.width(),o=i.bounds.height();if(!(new r.FB).setValue(0,0,l,o).containsPoint(e))return a;this.pickContext&&(this.pickContext.inuse=!0),i.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);let h=new s.y(1,0,0,1,0,0);for(let r=t.length-1;r>=0&&!(a=t[r].isContainer?this.pickGroup(t[r],e,h,i):this.pickItem(t[r],e,h,i)).graphic;r--)n||(n=a.group);if(a.graphic||(a.group=n),this.pickContext&&(this.pickContext.inuse=!1),this.pickerServiceInterceptorContributions.length)for(let t=0;t<this.pickerServiceInterceptorContributions.length;t++){let r=this.pickerServiceInterceptorContributions[t];r.afterPickItem&&(a=r.afterPickItem(a,this,e,i,{parentMatrix:h}))}return a}containsPoint(t,e,i){var r;return!!(null==(r=this.pickItem(t,e,null,null!=i?i:{pickContext:this.pickContext,pickerService:this}))?void 0:r.graphic)}pickGroup(t,e,i,r){let s={group:null,graphic:null};if(!1===t.attribute.visibleAll)return s;let a=r.pickContext,l=a.modelMatrix;if(a.camera){let e=t.transMatrix,i=g.yp.allocate();if((0,p.B$)(i,e),l){if(i){let t=g.yp.allocate();a.modelMatrix=(0,p.G9)(t,l,i),g.yp.free(i)}}else(0,p.B$)(i,t.globalTransMatrix),a.modelMatrix=i}if(this.InterceptorContributions.length)for(let s=0;s<this.InterceptorContributions.length;s++){let n=this.InterceptorContributions[s];if(n.beforePickItem){let s=n.beforePickItem(t,this,e,r,{parentMatrix:i});if(s)return a.modelMatrix!==l&&g.yp.free(a.modelMatrix),a.modelMatrix=l,s}}let o=t.transMatrix,u=g.QE.allocateByObj(i),f=new n.E9(e.x,e.y);u.transformPoint(f,f);let m=t.AABBBounds.containsPoint(f);if(!m&&!t.stage.camera)return s;let y=this.pickItem(t,f.clone(),i,r);y&&y.graphic&&(s.graphic=y.graphic,s.params=y.params);let _=!1!==t.attribute.pickable&&m;return u.multiply(o.a,o.b,o.c,o.d,o.e,o.f),!1===t.attribute.childrenPickable||y&&y.graphic||(0,h.kD)(t,c.xF.zIndex,a=>{if(a.isContainer){let i=new n.E9(e.x,e.y),l=(0,d.gh)(t).group,{scrollX:o=l.scrollX,scrollY:h=l.scrollY}=t.attribute;i.x-=o,i.y-=h,s=this.pickGroup(a,i,u,r)}else{let l=new n.E9(e.x,e.y);u.transformPoint(l,l);let o=(0,d.gh)(t).group,{scrollX:h=o.scrollX,scrollY:c=o.scrollY}=t.attribute;l.x-=h,l.y-=c;let p=this.pickItem(a,l,i,r);p&&p.graphic&&(s.graphic=p.graphic,s.params=p.params)}return!!s.graphic||!!s.group},!0,!!a.camera),a.modelMatrix!==l&&g.yp.free(a.modelMatrix),a.modelMatrix=l,s.graphic||s.group||!_||t.stage.camera||(s.group=t),g.QE.free(u),s}selectPicker(t){return this.pickerMap.get(t.numberType)||null}};_=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,a.b)(),y(0,(0,l.f)(u.Qc)),y(0,(0,o.t)(m.uH)),y(1,(0,l.f)(u.Qc)),y(1,(0,o.t)(m.tn)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object])],_)},66838:function(t,e,i){"use strict";i.d(e,{H:()=>s,X:()=>r});let r=Symbol.for("AutoEnablePlugins"),s=Symbol.for("PluginService")},42178:function(t,e,i){"use strict";i.d(e,{j:()=>T});var r=i(31535),s=i(88504),n=i(17783),a=i(41809),l=i(55551),o=i(73209),h=i(83962),u=i(46560),d=i(90552),c=i(33760),p=i(60452),g=i(58757),f=i(47275);function m(t,e,i,r){let{offsetX:s=0,offsetY:n=0,offsetZ:a=0}=r||{},l=!0;e.forEach(e=>{e.defined?(l&&t.moveTo(e.p0.x+s,e.p0.y+n,a),(0,f.w)(t,e,1,r),l=!1):l=!0}),l=!0;for(let e=i.length-1;e>=0;e--){let o=i[e];o.defined?(l&&t.lineTo(o.p0.x+s,o.p0.y+n,a),(0,f.w)(t,o,1,r),l=!1):l=!0}t.closePath()}var y=i(27177),_=i(55418),v=i(50614),b=i(26036),x=i(26227),S=i(37967);class k extends x.${constructor(){super(...arguments),this.time=c.Oh.afterFillStroke}drawShape(t,e,i,r,s,n,a,l,o,h,u,d,c){var p,g,f,m;this.textureMap||this.initTextureMap(e,t.stage);let{attribute:y=t.attribute}=c||{},{texture:_=null!=(p=t.attribute.texture)?p:(0,S.hT)(o,"texture"),textureColor:v=null!=(g=t.attribute.textureColor)?g:(0,S.hT)(o,"textureColor"),textureSize:b=null!=(f=t.attribute.textureSize)?f:(0,S.hT)(o,"textureSize"),texturePadding:x=null!=(m=t.attribute.texturePadding)?m:(0,S.hT)(o,"texturePadding")}=y;_&&this.drawTexture(_,t,e,i,r,o,v,b,x)}}let A=new k,M=b.R6;var w=function(t,e){return function(i,r){e(i,r,t)}};let T=class extends v.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=y.Ri,this.builtinContributions=[A,M],this.init(t)}drawLinearAreaHighPerformance(t,e,i,s,n,a,l,o,h,u,d,c,p){var g,f,m;let{points:y}=t.attribute;if(y.length<2)return;e.beginPath();let _=null!=(g=this.z)?g:0,v=y[0];e.moveTo(v.x+l,v.y+o,_);for(let t=1;t<y.length;t++){let i=y[t];e.lineTo(i.x+l,i.y+o,_)}for(let t=y.length-1;t>=0;t--){let i=y[t];e.lineTo((null!=(f=i.x1)?f:i.x)+l,(null!=(m=i.y1)?m:i.y)+o,_)}e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),this.beforeRenderStep(t,e,l,o,!!n,!1,i,!1,h,u,c,null,{attribute:t.attribute});let{x:b=0,x:x=0}=t.attribute;!1!==i&&(c?c(e,t.attribute,h):n&&(e.setCommonStyle(t,t.attribute,b-l,x-o,h),e.fill())),this.afterRenderStep(t,e,l,o,!!n,!1,i,!1,h,u,c,null,{attribute:t.attribute}),(()=>{var i,n;if(s){let{stroke:s=h&&h.stroke}=t.attribute;if((0,r.Z)(s)&&(s[0]||s[2])&&!1===s[1]){if(e.beginPath(),s[0]){e.moveTo(v.x+l,v.y+o,_);for(let t=1;t<y.length;t++){let i=y[t];e.lineTo(i.x+l,i.y+o,_)}}else if(s[2]){let t=y[y.length-1];e.moveTo(t.x+l,t.y+o,_);for(let t=y.length-2;t>=0;t--){let r=y[t];e.lineTo((null!=(i=r.x1)?i:r.x)+l,(null!=(n=r.y1)?n:r.y)+o,_)}}}p?p(e,t.attribute,h):(e.setStrokeStyle(t,t.attribute,b-l,x-o,h),e.stroke())}})()}drawShape(t,e,i,r,n,a,l,o){var d,c,p,g,f,m;let y=(0,u.gh)(t,null==a?void 0:a.theme).area,{fill:_=y.fill,stroke:v=y.stroke,fillOpacity:b=y.fillOpacity,z:x=y.z,strokeOpacity:S=y.strokeOpacity,curveTension:k=y.curveTension,connectedType:A=y.connectedType}=t.attribute,M=this.valid(t,y,l,o);if(!M)return;let{doFill:w}=M,T=M.doStroke&&M.sVisible,{clipRange:C=y.clipRange,closePath:E,points:B,segments:P}=t.attribute,{curveType:O=y.curveType}=t.attribute;function I(t,e){return"connect"!==e?t:t.filter(t=>!1!==t.defined)}if(E&&"linear"===O&&(O="linearClosed"),1===C&&!P&&!B.some(t=>!1===t.defined)&&"linear"===O)return this.drawLinearAreaHighPerformance(t,e,!!_,T,b,S,i,r,y,n,a,l,o);if(t.shouldUpdateShape()){if(P&&P.length){let e,i,r,s=P.map((t,r)=>{if(t.points.length<=1&&0===r)return t.points[0]&&(i={endX:t.points[0].x,endY:t.points[0].y}),null;1===r?e={x:i.endX,y:i.endY}:r>1&&(e.x=i.endX,e.y=i.endY);let s=(0,h.X0)(I(t.points,A),O,{startPoint:e,curveTension:k});return i=s,s}).filter(t=>!!t),n=[];for(let t=P.length-1;t>=0;t--){let e=P[t].points,i=[];for(let t=e.length-1;t>=0;t--)i.push({x:null!=(d=e[t].x1)?d:e[t].x,y:null!=(c=e[t].y1)?c:e[t].y});if(0!==t){let e=P[t-1].points,r=e[e.length-1];r&&i.push({x:null!=(p=r.x1)?p:r.x,y:null!=(g=r.y1)?g:r.y})}i.length>1&&(r=(0,h.X0)(I(i,A),"stepBefore"===O?"stepAfter":"stepAfter"===O?"stepBefore":O,{curveTension:k}),n.unshift(r))}t.cacheArea=n.map((t,e)=>({top:s[e],bottom:t}))}else{if(!B||!B.length)return t.cacheArea=null,void t.clearUpdateShapeTag();{let e=I(B,A),i=[];for(let t=e.length-1;t>=0;t--)i.push({x:null!=(f=e[t].x1)?f:e[t].x,y:null!=(m=e[t].y1)?m:e[t].y});t.cacheArea={top:(0,h.X0)(e,O,{curveTension:k}),bottom:(0,h.X0)(i,"stepBefore"===O?"stepAfter":"stepAfter"===O?"stepBefore":O,{curveTension:k})}}}t.clearUpdateShapeTag()}if(Array.isArray(t.cacheArea)){let a=t.attribute.segments.filter(t=>t.points.length);if(1===a[0].points.length&&a.shift(),1===C){let s=!1;t.cacheArea.forEach((h,u)=>{s||(s=this.drawSegmentItem(e,h,w,b,T,S,a[u],[y,t.attribute],C,i,r,x,t,n,l,o))})}else{let h=C*t.cacheArea.reduce((t,e)=>t+e.top.getLength(),0),u=0,d=!1;t.cacheArea.forEach((c,p)=>{if(d)return;let g=c.top.getLength(),f=(h-u)/g;u+=g,f>0&&(d=this.drawSegmentItem(e,c,w,b,T,S,a[p],[y,t.attribute],(0,s.VV)(f,1),i,r,x,t,n,l,o))})}}else this.drawSegmentItem(e,t.cacheArea,w,b,T,S,t.attribute,y,C,i,r,x,t,n,l,o)}draw(t,e,i,r){let s=(0,u.gh)(t,null==r?void 0:r.theme).area;this._draw(t,s,!1,i,r)}drawSegmentItem(t,e,i,r,s,n,a,l,o,h,u,d,c,p,g,f){return this._drawSegmentItem(t,e,i,r,s,n,a,l,o,h,u,d,c,p,g,f)}_drawSegmentItem(t,e,i,n,a,l,o,h,u,d,f,y,v,b,x,S){if(!(e&&e.top&&e.bottom&&e.top.curves&&e.top.curves.length&&e.bottom.curves&&e.bottom.curves.length))return;t.beginPath();let{points:k,segments:A}=v.attribute,M,w,T=c.Nm.ROW;if(A){let t=A[A.length-1];w=A[0].points[0],M=t.points[t.points.length-1]}else w=k[0],M=k[k.length-1];let C=(0,s.Wn)(M.x-w.x),E=(0,s.Wn)(M.y-w.y);(function(t,e,i,r){var n;let{top:a,bottom:l}=e;if(a.curves.length!==l.curves.length)return;if(i>=1){let e=[],i=[],s=!0;for(let n=0,o=a.curves.length;n<o;n++){let h=a.curves[n];s!==h.defined?(s?(m(t,e,i,r),e.length=0,i.length=0):(e.push(h),i.push(l.curves[o-n-1])),s=!s):s&&(e.push(h),i.push(l.curves[o-n-1]))}return m(t,e,i,r)}if(i<=0)return;let{direction:o}=r||{},{curves:h}=a,u=null!=(n=h[h.length-1].p3)?n:h[h.length-1].p1,d=(0,s.Wn)(u.x-h[0].p0.x),f=(0,s.Wn)(u.y-h[0].p0.y);o=null!=o?o:d>f?c.Nm.ROW:c.Nm.COLUMN,Number.isFinite(d)||(o=c.Nm.COLUMN),Number.isFinite(f)||(o=c.Nm.ROW);let y=i*(o===c.Nm.ROW?d:f),_=0,v=!0,b=[],x=[];for(let e=0,i=a.curves.length;e<i;e++){let s=a.curves[e],n=s.getLength(o),h=(y-_)/n;if(h<0)break;_+=n;let u=null,d=null;v!==s.defined?(v?(m(t,b,x,r),b.length=0,x.length=0):(u=s,d=l.curves[i-e-1]),v=!v):v&&(u=s,d=l.curves[i-e-1]),u&&d&&(h<1&&(u=u.p2&&u.p3?(0,p.m)(u,h)[0]:(0,g.d)(u,h)[0],d=d.p2&&d.p3?(0,p.m)(d,1-h)[1]:(0,g.d)(d,1-h)[1]),u.defined=v,d.defined=v,b.push(u),x.push(d)),u=null,d=null}m(t,b,x,r)})(t,e,u,{offsetX:d,offsetY:f,offsetZ:y,direction:T=null==M.x1?c.Nm.ROW:null==M.y1?c.Nm.COLUMN:Number.isFinite(C+E)?C>E?c.Nm.ROW:c.Nm.COLUMN:c.Nm.ROW}),this.beforeRenderStep(v,t,d,f,!!n,!1,i,!1,h,b,x,null,{attribute:o}),t.setShadowBlendStyle&&t.setShadowBlendStyle(v,o,h);let{x:B=0,x:P=0}=o;return!1!==i&&(x?x(t,o,h):n&&(t.setCommonStyle(v,o,B-d,P-f,h),t.fill())),this.afterRenderStep(v,t,d,f,!!n,!1,i,!1,h,b,x,null,{attribute:o}),(()=>{if(!1!==a)if(S)S(t,o,h);else{let{stroke:i=h&&h[1]&&h[1].stroke}=o;(0,r.Z)(i)&&(i[0]||i[2])&&!1===i[1]&&(t.beginPath(),(0,_.fW)(t,i[0]?e.top:e.bottom,u,T===c.Nm.ROW?"x":"y",{offsetX:d,offsetY:f,offsetZ:y})),t.setStrokeStyle(v,o,B-d,P-f,h),t.stroke()}})(),!1}};T=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,n.b)(),w(0,(0,a.f)(o.Qc)),w(0,(0,l.t)(d.Gq)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],T)},50614:function(t,e,i){"use strict";i.d(e,{Y:()=>c});var r=i(88758),s=i(53627),n=i(60738),a=i(33760),l=i(46527),o=i(46560),h=i(60027),u=i(26036);let d={x:0,y:0,z:0,lastModelMatrix:null};class c{init(t){t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions||(this.builtinContributions=[]),this.builtinContributions.push(u.rJ),this.builtinContributions.push(u.Eo),this.builtinContributions.forEach(t=>this._renderContribitions.push(t)),this._renderContribitions.length&&(this._renderContribitions.sort((t,e)=>e.order-t.order),this._beforeRenderContribitions=this._renderContribitions.filter(t=>t.time===a.Oh.beforeFillStroke),this._afterRenderContribitions=this._renderContribitions.filter(t=>t.time===a.Oh.afterFillStroke))}reInit(){this.init(this.graphicRenderContributions)}beforeRenderStep(t,e,i,r,s,n,a,l,o,h,u,d,c){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach(p=>{(!p.supportedAppName||!t.stage||!t.stage.params||!t.stage.params.context||!t.stage.params.context.appName||(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName))&&p.drawShape(t,e,i,r,s,n,a,l,o,h,u,d,c)})}afterRenderStep(t,e,i,r,s,n,a,l,o,h,u,d,c){this._afterRenderContribitions&&this._afterRenderContribitions.forEach(p=>{(!p.supportedAppName||!t.stage||!t.stage.params||!t.stage.params.context||!t.stage.params.context.appName||(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName))&&p.drawShape(t,e,i,r,s,n,a,l,o,h,u,d,c)})}drawPathProxy(t,e,i,r,s,a,l,u){if(!t.pathProxy)return!1;let d=(0,o.gh)(t,null==a?void 0:a.theme)[t.type.replace("3d","")],{fill:c=d.fill,stroke:p=d.stroke,opacity:g=d.opacity,fillOpacity:f=d.fillOpacity,lineWidth:m=d.lineWidth,strokeOpacity:y=d.strokeOpacity,visible:_=d.visible,x:v=d.x,y:b=d.y}=t.attribute,x=(0,n.Bv)(g,f,c),S=(0,n.Kf)(g,y),k=(0,n.dz)(c),A=(0,n.ak)(p,m);if(!_||!k&&!A||!(x||S||l||u))return!0;e.beginPath();let M="function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy;return(0,h.h)(M.commandList,e,i,r),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,r,k,A,x,S,d,s,l,u),A&&(u?u(e,t.attribute,d):S&&(e.setStrokeStyle(t,t.attribute,i-v,r-b,d),e.stroke())),k&&(l?l(e,t.attribute,d):x&&(e.setCommonStyle(t,t.attribute,i-v,r-b,d),e.fill())),this.afterRenderStep(t,e,i,r,k,A,x,S,d,s,l,u),!0}valid(t,e,i,r){let{fill:s=e.fill,background:a,stroke:l=e.stroke,opacity:o=e.opacity,fillOpacity:h=e.fillOpacity,lineWidth:u=e.lineWidth,strokeOpacity:d=e.strokeOpacity,visible:c=e.visible}=t.attribute,p=(0,n.Bv)(o,h,s),g=(0,n.Kf)(o,d),f=(0,n.dz)(s,a),m=(0,n.ak)(l,u);return!(!t.valid||!c)&&!(!f&&!m)&&!!(p||g||i||r||a)&&{fVisible:p,sVisible:g,doFill:f,doStroke:m}}transform(t,e,i,n=!1){let{x:a=e.x,y:o=e.y,z:h=e.z,scaleX:u=e.scaleX,scaleY:c=e.scaleY,angle:p=e.angle,postMatrix:g}=t.attribute,f=i.modelMatrix,m=i.camera;d.x=a,d.y=o,d.z=h,d.lastModelMatrix=f;let y=m&&(n||(0,r.M_)(t)),_=y?t.transMatrix.onlyTranslate()&&!g:1===u&&1===c&&0===p&&!g;if(y){let n=s.yp.allocate(),a=s.yp.allocate();(0,r.RT)(a,t,e),(0,l.G9)(n,f||n,a),d.x=0,d.y=0,d.z=0,i.modelMatrix=n,i.setTransform(1,0,0,1,0,0,!0),s.yp.free(a)}if(_&&!f){let r=t.getOffsetXY(e);d.x+=r.x,d.y+=r.y,d.z=h,i.setTransformForCurrent()}else if(y)d.x=0,d.y=0,d.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(m&&i.project){let r=t.getOffsetXY(e);d.x+=r.x,d.y+=r.y,this.transformWithoutTranslate(i,d.x,d.y,d.z,u,c,p)}else i.transformFromMatrix(t.transMatrix,!0),d.x=0,d.y=0,d.z=0;return d}transformUseContext2d(t,e,i,r){let s=r.camera;if(this.camera=s,s){let e=t.AABBBounds,s=e.x2-e.x1,n=e.y2-e.y1,a=r.project(0,0,i),l=r.project(s,0,i),o=r.project(s,n,i),h={x:0,y:0},u={x:s,y:0},d={x:s,y:n};r.camera=null;let c=1/(h.x*(d.y-u.y)-u.x*d.y+d.x*u.y+(u.x-d.x)*h.y),p=-(h.y*(o.x-l.x)-u.y*o.x+d.y*l.x+(u.y-d.y)*a.x)*c,g=(u.y*o.y+h.y*(l.y-o.y)-d.y*l.y+(d.y-u.y)*a.y)*c,f=(h.x*(o.x-l.x)-u.x*o.x+d.x*l.x+(u.x-d.x)*a.x)*c,m=-(u.x*o.y+h.x*(l.y-o.y)-d.x*l.y+(d.x-u.x)*a.y)*c,y=(h.x*(d.y*l.x-u.y*o.x)+h.y*(u.x*o.x-d.x*l.x)+(d.x*u.y-u.x*d.y)*a.x)*c,_=(h.x*(d.y*l.y-u.y*o.y)+h.y*(u.x*o.y-d.x*l.y)+(d.x*u.y-u.x*d.y)*a.y)*c;r.setTransform(p,g,f,m,y,_,!0)}}restoreTransformUseContext2d(t,e,i,r){this.camera&&(r.camera=this.camera)}transformWithoutTranslate(t,e,i,r,s,n,a){let l=t.project(e,i,r);t.translate(l.x,l.y,!1),t.scale(s,n,!1),t.rotate(a,!1),t.translate(-l.x,-l.y,!1),t.setTransformForCurrent()}_draw(t,e,i,r,n,a){let{context:l}=r;if(!l)return;let{renderable:o}=t.attribute;if(!1===o)return;l.highPerformanceSave();let{x:h,y:u,z:d,lastModelMatrix:c}=this.transform(t,e,l,i);this.z=d,this.drawPathProxy(t,l,h,u,r,n)||(this.drawShape(t,l,h,u,r,n,null,null,a),this.z=0,l.modelMatrix!==c&&s.yp.free(l.modelMatrix),l.modelMatrix=c),l.highPerformanceRestore()}}},26036:function(t,e,i){"use strict";i.d(e,{Eo:()=>m,M2:()=>c,R6:()=>p,Sg:()=>g,rJ:()=>f});var r=i(17783),s=i(41809),n=i(55551),a=i(46560),l=i(64067),o=i(33760),h=i(73209),u=i(90552),d=function(t,e){return function(i,r){e(i,r,t)}};class c{constructor(){this.time=o.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,l,o,h,u,d,c,p){var g;let{background:f,backgroundOpacity:m=null!=(g=t.attribute.fillOpacity)?g:h.backgroundOpacity,opacity:y=h.opacity,backgroundMode:_=h.backgroundMode,backgroundFit:v=h.backgroundFit,backgroundKeepAspectRatio:b=h.backgroundKeepAspectRatio,backgroundScale:x=h.backgroundScale,backgroundOffsetX:S=h.backgroundOffsetX,backgroundOffsetY:k=h.backgroundOffsetY,backgroundClip:A=h.backgroundClip}=t.attribute;if(f)if(t.backgroundImg&&t.resources){let s=t.resources.get(f);if("success"!==s.state||!s.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){let i=(0,a.gh)(t.parent).group,{scrollX:r=i.scrollX,scrollY:s=i.scrollY}=t.parent.attribute;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(r,s)}A&&e.clip();let n=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,r,h),e.globalAlpha=m*y,this.doDrawImage(e,s.data,n,{backgroundMode:_,backgroundFit:v,backgroundKeepAspectRatio:b,backgroundScale:x,backgroundOffsetX:S,backgroundOffsetY:k}),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,h),e.globalAlpha=m*y,e.fillStyle=f,e.fill(),e.highPerformanceRestore()}doDrawImage(t,e,i,r){let{backgroundMode:s,backgroundFit:n,backgroundKeepAspectRatio:a,backgroundScale:o=1,backgroundOffsetX:h=0,backgroundOffsetY:u=0}=r,d=i.width(),c=i.height(),p=d,g=c;if("no-repeat"===s)if(n)if(a){let r=Math.max(d/e.width,c/e.height);t.drawImage(e,i.x1+h,i.y1+u,e.width*r*o,e.height*r*o)}else t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{let r=e.width*o,s=e.height*o;t.drawImage(e,i.x1+h,i.y1+u,r,s)}else{if(n&&"repeat"!==s&&(e.width||e.height)){let i=e.width,r=e.height;"repeat-x"===s?(p=c/r*i,g=c):"repeat-y"===s&&(g=d/i*r,p=d);let n=t.dpr,a=l.A.allocate({width:p,height:g,dpr:n}),o=a.getContext("2d");o&&(o.inuse=!0,o.clearMatrix(),o.setTransformForCurrent(!0),o.clearRect(0,0,p,g),o.drawImage(e,0,0,p,g),e=a.nativeCanvas),l.A.free(a)}let r=t.dpr,a=t.createPattern(e,s);a.setTransform&&a.setTransform(new DOMMatrix([1/r,0,0,1/r,0,0])),t.fillStyle=a,t.translate(i.x1,i.y1),t.fillRect(0,0,d,c),t.translate(-i.x1,-i.y1)}}}let p=new c,g=class{constructor(t){this.subRenderContribitions=t,this.time=o.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,a,l,o,h,u,d,c){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach(p=>{p.render(t,e,i,r,s,n,a,l,o,h,u,d,c)})}};g=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,r.b)(),d(0,(0,s.f)(h.Qc)),d(0,(0,n.t)(u.tg)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],g);let f=new class{constructor(){this.time=o.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,a,l,o,h,u,d,c){var p,g;let{clipConfig:f}=t.attribute;if(!f)return;let m=t.getClipPath();if(!m)return;let y=!(u||d),_=t.AABBBounds,v=null!=(p=t.attribute.width)?p:_.width(),b=null!=(g=t.attribute.height)?g:_.height();y&&e.save(),e.beginPath(),!1===m.draw(e,[v,b],i+v/2,r+b/2,0)&&e.closePath(),u&&u(e,t.attribute,o,!0),y&&e.clip()}},m=new class{constructor(){this.time=o.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,a,l,o,h,u,d,c){let{clipConfig:p}=t.attribute;p&&t.getClipPath()&&(u||d||e.restore())}}},26227:function(t,e,i){"use strict";i.d(e,{$:()=>l,H:()=>o});var r=i(64067),s=i(33760),n=i(14861),a=i(88504);class l{constructor(){this.time=s.Oh.afterFillStroke,this.useStyle=!0,this.order=10,this._tempSymbolGraphic=null}createCommonPattern(t,e,i,s,n){let a=(t-2*e)/2,l=s.dpr,o=r.A.allocate({width:t,height:t,dpr:l}),h=o.getContext("2d");if(!h)return null;h.inuse=!0,h.clearMatrix(),h.setTransformForCurrent(!0),h.clearRect(0,0,t,t),n(a,h);let u=s.createPattern(o.nativeCanvas,"repeat");return u.setTransform&&u.setTransform(new DOMMatrix([1/l,0,0,1/l,0,0])),r.A.free(o),u}createCirclePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,e)=>{e.fillStyle=i,e.arc(t,t,t,0,a.f7),e.fill()})}createDiamondPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{let s=t/2;r.fillStyle=i,r.moveTo(s,s-e),r.lineTo(e+s,s),r.lineTo(s,s+e),r.lineTo(s-e,s),r.closePath(),r.fill()})}createRectPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,r)=>{r.fillStyle=i,r.fillRect(e,e,2*t,2*t)})}createVerticalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(r,s)=>{s.fillStyle=i,s.fillRect(e,0,2*r,t)})}createHorizontalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(r,s)=>{s.fillStyle=i,s.fillRect(0,e,t,2*r)})}createBiasLRLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{r.strokeStyle=i,r.lineWidth=e,r.moveTo(0,0),r.lineTo(t,t);let s=t/2,n=-s;r.moveTo(s,n),r.lineTo(s+t,n+t),r.moveTo(-s,-n),r.lineTo(-s+t,-n+t),r.stroke()})}createBiasRLLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{r.strokeStyle=i,r.lineWidth=e,r.moveTo(t,0),r.lineTo(0,t);let s=t/2;r.moveTo(t+s,s),r.lineTo(s,s+t),r.moveTo(t-s,-s),r.lineTo(-s,-s+t),r.stroke()})}createGridPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,r)=>{r.fillStyle=i,r.fillRect(e,e,t,t),r.fillRect(e+t,e+t,t,t)})}initTextureMap(t,e){this.textureMap=new Map}drawShape(t,e,i,r,s,n,a,l,o,h,u,d,c){this.textureMap||this.initTextureMap(e,t.stage);let{texture:p=o.texture,textureColor:g=o.textureColor,textureSize:f=o.textureSize,texturePadding:m=o.texturePadding}=t.attribute;p&&this.drawTexture(p,t,e,i,r,o,g,f,m)}drawTexture(t,e,i,s,a,l,o,h,u){var d;let{textureRatio:c=l.textureRatio,textureOptions:p=null}=e.attribute,g=this.textureMap.get(t);if(!g)switch(t){case"circle":g=this.createCirclePattern(h,u,o,i);break;case"diamond":g=this.createDiamondPattern(h,u,o,i);break;case"rect":g=this.createRectPattern(h,u,o,i);break;case"vertical-line":g=this.createVerticalLinePattern(h,u,o,i);break;case"horizontal-line":g=this.createHorizontalLinePattern(h,u,o,i);break;case"bias-lr":g=this.createBiasLRLinePattern(h,u,o,i);break;case"bias-rl":g=this.createBiasRLLinePattern(h,u,o,i);break;case"grid":g=this.createGridPattern(h,u,o,i)}if(p&&p.dynamicTexture){let g,{gridConfig:f={},useNewCanvas:m}=p,y=e.AABBBounds;s=y.x1,a=y.y1;let _=i;if(m){let t=(g=r.A.allocate({width:y.width(),height:y.height(),dpr:i.dpr})).getContext("2d");t.clearRect(0,0,y.width(),y.height()),s=0,a=0,i=t}if(_.save(),e.parent&&!e.transMatrix.onlyTranslate()){let{scrollX:t=0,scrollY:i=0}=e.parent.attribute;_.setTransformFromMatrix(e.parent.globalTransMatrix),_.translate(t,i,!0)}_.setCommonStyle(e,e.attribute,s,a,l),_.clip();let v=y.width(),b=y.height(),x=f.columns?f.columns:Math.ceil(v/h),S=f.rows?f.rows:Math.ceil(b/h),k=f.gutterColumn?f.gutterColumn:2*u,A=f.gutterRow?f.gutterRow:2*u;this._tempSymbolGraphic||(this._tempSymbolGraphic=(0,n.t)({}));let M=f.columns?v/f.columns:h,w=f.rows?b/f.rows:h;this._tempSymbolGraphic.setAttributes({size:[M-k,w-A],symbolType:t});let T=this._tempSymbolGraphic.getParsedPath();for(let t=0;t<S;t++)for(let r=0;r<x;r++){let n=s+h/2+r*h,l=a+h/2+t*h;null==(d=p.beforeDynamicTexture)||d.call(p,i,t,r,S,x,c,e,y.width(),y.height()),i.beginPath(),!1===T.draw(i,Math.min(M-k,w-A),n,l,0)&&i.closePath(),i.fillStyle=o,p.dynamicTexture(i,t,r,S,x,c,e,y.width(),y.height())}m&&(_.globalAlpha=1,_.drawImage(g.nativeCanvas,0,0,g.nativeCanvas.width,g.nativeCanvas.height,y.x1,y.y1,y.width()*_.dpr,y.height()*_.dpr)),_.restore()}else if(g)i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,s,a,l),i.fillStyle=g,i.fill(),i.highPerformanceRestore();else if("wave"===t){i.save(),i.setCommonStyle(e,e.attribute,s,a,l),i.clip();let t=e.AABBBounds;(function(t,e,i,r,s,n,a){let{fill:l="orange",percent:o=.6,frequency:h=4,opacity:u,phi:d=0}=s,{amplitude:c=10}=s;c*=e<=.5?4*e-1:-4*e+3;let p=r*(1-o),g=Math.max(Math.round(i/70),2);t.beginPath(),t.moveTo(0+n,r+a),t.lineTo(0+n,p+a);let f=i/h*e,m=i/Math.PI/(2*h);for(let e=0;e<i;e+=g){let i=c*Math.sin((e+f+d)/m+d);t.lineTo(e+n,p+i+a)}t.lineTo(i+n,r+a),t.closePath(),t.fillStyle=l,isFinite(u)&&(t.globalAlpha=u),t.fill()})(i,c,t.width(),t.height(),Object.assign(Object.assign({},p||{}),{fill:o}),s+t.x1-s,a+t.y1-a),i.restore()}}}let o=new l},90552:function(t,e,i){"use strict";i.d(e,{$K:()=>c,Cs:()=>n,Gq:()=>s,JO:()=>l,Mj:()=>o,OL:()=>r,U7:()=>h,X3:()=>d,d5:()=>u,jd:()=>a,tg:()=>p});let r=Symbol.for("ArcRenderContribution"),s=Symbol.for("AreaRenderContribution"),n=Symbol.for("CircleRenderContribution"),a=Symbol.for("GroupRenderContribution"),l=Symbol.for("ImageRenderContribution"),o=Symbol.for("PathRenderContribution"),h=Symbol.for("PolygonRenderContribution"),u=Symbol.for("RectRenderContribution"),d=Symbol.for("SymbolRenderContribution"),c=Symbol.for("TextRenderContribution");Symbol.for("StarRenderContribution"),Symbol.for("CommonRenderContribution");let p=Symbol.for("InteractiveSubRenderContribution")},33359:function(t,e,i){"use strict";i.d(e,{Er:()=>p,NB:()=>g,d4:()=>c,gq:()=>m,k7:()=>f,sH:()=>d});var r=i(31535),s=i(17783),n=i(29436),a=i(26036),l=i(24806),o=i(33760),h=i(26227),u=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};class d{constructor(){this.time=o.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,s,a,o,h,u,d,c,p,g){let{outerBorder:f,innerBorder:m}=t.attribute,y=f&&!1!==f.visible,_=m&&!1!==m.visible;if(!y&&!_)return;let{cornerRadius:v=d.cornerRadius,cornerType:b=d.cornerType,opacity:x=d.opacity,x:S=d.x,y:k=d.y,scaleX:A=d.scaleX,scaleY:M=d.scaleY,x1:w,y1:T,keepStrokeScale:C=d.keepStrokeScale}=t.attribute,{width:E,height:B}=t.attribute;E=(null!=E?E:w-i)||0,B=(null!=B?B:T-s)||0;let P=(a,o)=>{let h=!(!a||!a.stroke),u="outerBorder"===o?-1:1,{distance:c=d[o].distance}=a,p=C?c:(0,n.D)(e,c,e.dpr),f=i+u*p,m=s+u*p,y=2*p;if(0===v||(0,r.Z)(v)&&v.every(t=>0===t)?(e.beginPath(),e.rect(f,m,E-u*y,B-u*y)):(e.beginPath(),(0,l.U)(e,f,m,E-u*y,B-u*y,v,"bevel"!==b)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),g)g(e,a,d[o]);else if(h){let r=d[o].opacity;d[o].opacity=x,e.setStrokeStyle(t,a,(S-i)/A,(k-s)/M,d[o]),d[o].opacity=r,e.stroke()}};y&&P(f,"outerBorder"),_&&P(m,"innerBorder")}}let c=class{constructor(){this.time=o.Oh.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,a,l,o,h,u,d,c){let{stroke:p=o.stroke}=t.attribute;Array.isArray(p)&&p.some(t=>!1===t)&&(c.doStroke=!1)}};c=u([(0,s.b)()],c);let p=class{constructor(){this.time=o.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,s,n,a,o,h,u,d,c,p){let{x1:g,y1:f,x:m=u.x,y:y=u.y,stroke:_=u.stroke,cornerRadius:v=u.cornerRadius,cornerType:b=u.cornerType}=t.attribute,{width:x,height:S}=t.attribute;if(x=(null!=x?x:g-m)||0,S=(null!=S?S:f-y)||0,Array.isArray(_)&&_.some(t=>!1===t)){if(e.setStrokeStyle(t,t.attribute,i,s,u),!(0===v||(0,r.Z)(v)&&v.every(t=>0===t))){let r,n=0;return(0,l.U)(e,i,s,x,S,v,"bevel"!==b,[,,,,].fill(0).map((a,l)=>(a,o,h,d)=>{_[l]&&(n===l-1&&_[l]===r||(e.setStrokeStyle(t,Object.assign(Object.assign({},t.attribute),{stroke:_[l]}),i,s,u),e.beginPath(),e.moveTo(a,o),r=_[l]),n=l,e.lineTo(h,d),e.stroke(),3===l&&e.beginPath())})),void e.stroke()}if(e.beginPath(),e.moveTo(i,s),_[0]?e.lineTo(i+x,s):e.moveTo(i+x,s),_[1]?e.lineTo(i+x,s+S):e.moveTo(i+x,s+S),_[2]?e.lineTo(i,s+S):e.moveTo(i,s+S),_[3]){let t=_[0]?s-e.lineWidth/2:s;e.lineTo(i,t)}else e.moveTo(i,s);e.stroke()}}};p=u([(0,s.b)()],p);let g=new d,f=h.H,m=a.R6},3783:function(t,e,i){"use strict";i.d(e,{C:()=>u});var r=i(43562),s=i(33760),n=i(26036),a=i(19293),l=i(82794),o=i(24806);class h extends n.M2{constructor(){super(...arguments),this.time=s.Oh.beforeFillStroke}drawShape(t,e,i,s,n,h,u,d,c,p,g,f){var m,y,_,v,b,x,S,k,A,M;let w,{backgroundMode:T=c.backgroundMode,backgroundFit:C=c.backgroundFit,backgroundKeepAspectRatio:E=c.backgroundKeepAspectRatio}=t.attribute,B,{background:P}=t.attribute;if(!P)return;let O=()=>{"richtext"===t.type&&(e.restore(),e.save(),B&&e.setTransformFromMatrix(B,!0,1))};"richtext"===t.type&&(B=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());let I=(0,r.Z)(P)&&P.background,R=t.transMatrix.onlyTranslate();if(I){let e=t.AABBBounds,i=(null!=(m=P.x)?m:e.x1)+(null!=(y=P.dx)?y:0),r=(null!=(_=P.y)?_:e.y1)+(null!=(v=P.dy)?v:0),s=null!=(b=P.width)?b:e.width(),n=null!=(x=P.height)?x:e.height();if(w=a.et.allocate(i,r,i+s,r+n),P=P.background,!R){let t=w.width(),e=w.height();w.set((null!=(S=P.x)?S:0)+(null!=(k=P.dx)?k:0),(null!=(A=P.y)?A:0)+(null!=(M=P.dy)?M:0),t,e)}}else w=t.AABBBounds,R||(w=(0,l.o)(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){let r=t.resources.get(P);if("success"!==r.state||!r.data)return void O();e.highPerformanceSave(),R&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,s,c),this.doDrawImage(e,r.data,w,{backgroundMode:T,backgroundFit:C,backgroundKeepAspectRatio:E}),e.highPerformanceRestore(),e.setTransformForCurrent()}else{let{backgroundCornerRadius:r}=t.attribute;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,s,c),e.fillStyle=P,r?((0,o.U)(e,w.x1,w.y1,w.width(),w.height(),r,!0),e.fill()):e.fillRect(w.x1,w.y1,w.width(),w.height()),e.highPerformanceRestore()}I&&a.et.free(w),O()}}let u=new h},43722:function(t,e,i){"use strict";i.d(e,{pN:()=>g,xL:()=>h});var r=i(17783),s=i(76620),n=i(46527),a=i(20672),l=i(53627),o=i(96141);let h=Symbol.for("DrawItemInterceptor"),u=new s.FB,d=new s.FB;class c{constructor(){this.order=1}afterDrawItem(t,e,i,r,s){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,i,r,s),!1}beforeDrawItem(t,e,i,r,s){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,i,r,s),!1}drawItem(t,e,i,r,s){if(!t.shadowRoot)return!1;let{context:n}=i;if(n.highPerformanceSave(),n.transformFromMatrix(t.transMatrix,!0),r.dirtyBounds&&r.backupDirtyBounds){u.copy(r.dirtyBounds),d.copy(r.backupDirtyBounds);let e=t.globalTransMatrix.getInverse();r.dirtyBounds.copy(r.backupDirtyBounds).transformWithMatrix(e),r.backupDirtyBounds.copy(r.dirtyBounds)}return r.renderGroup(t.shadowRoot,i,l.QE.allocate(1,0,0,1,0,0)),n.highPerformanceRestore(),r.dirtyBounds&&r.backupDirtyBounds&&(r.dirtyBounds.copy(u),r.backupDirtyBounds.copy(d)),!0}}class p{constructor(){this.order=1}afterDrawItem(t,e,i,r,s){return t.attribute._debug_bounds&&this.drawItem(t,e,i,r,s),!1}drawItem(t,e,i,r,s){if(!t.attribute._debug_bounds)return!1;let{context:n}=i;n.highPerformanceSave(),t.parent&&n.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&n.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);let a=t.AABBBounds;return!0!==t.attribute._debug_bounds&&t.attribute._debug_bounds(n,t),n.strokeRect(a.x1,a.y1,a.width(),a.height()),n.highPerformanceRestore(),!0}}let g=class{constructor(){this.order=1,this.interceptors=[new c,new m,new f,new p]}afterDrawItem(t,e,i,r,s){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let n=0;n<this.interceptors.length;n++)if(this.interceptors[n].afterDrawItem&&this.interceptors[n].afterDrawItem(t,e,i,r,s))return!0;return!1}beforeDrawItem(t,e,i,r,s){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let n=0;n<this.interceptors.length;n++)if(this.interceptors[n].beforeDrawItem&&this.interceptors[n].beforeDrawItem(t,e,i,r,s))return!0;return!1}};g=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,r.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],g);class f{constructor(){this.order=1}beforeDrawItem(t,e,i,r,s){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,r,s):this.beforeSetInteractive(t,e,i,r,s))}beforeSetInteractive(t,e,i,r,s){let n=t.interactiveGraphic;if(t.attribute.globalZIndex){n||(n=t.clone(),t.interactiveGraphic=n,n.baseGraphic=t),n.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();let e=i.stage.getLayer("_builtin_interactive");return e&&this.getShadowRoot(e).add(n),!0}if(n){i.stage.tryInitInteractiveLayer();let e=i.stage.getLayer("_builtin_interactive");e&&this.getShadowRoot(e).removeChild(n),t.interactiveGraphic=null,n.baseGraphic=null}return!1}beforeDrawInteractive(t,e,i,r,s){let n=t.baseGraphic,a=!!n.stage,l=n.parent;for(;a&&l&&l.stage!==l;)a=!!l.stage,l=l.parent;if(!a){let e=i.stage.getLayer("_builtin_interactive");return e&&this.getShadowRoot(e).removeChild(t),!0}if(n){this.processing=!0;let{context:t}=i;return t.highPerformanceSave(),t.setTransformFromMatrix(n.parent.globalTransMatrix,!0),n.isContainer?r.renderGroup(n,i,n.parent.globalTransMatrix):r.renderItem(n,i),t.highPerformanceRestore(),this.processing=!1,!0}return!1}getShadowRoot(t){var e;let i=t.getElementById("_interactive_group");return i||((i=a.i.CreateGraphic("group",{})).id="_interactive_group",t.add(i)),null!=(e=i.shadowRoot)?e:i.attachShadow()}}class m{constructor(){this.order=1}beforeDrawItem(t,e,i,r,s){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;let{context:a,stage:h}=e.drawParams;a.canvas,a.save(),this.initCanvasCtx(a),a.camera=h.camera;let u=a.currentMatrix;u.a/=a.dpr,u.b/=a.dpr,u.c/=a.dpr,u.d/=a.dpr,u.e/=a.dpr,u.f/=a.dpr;let d=l.yp.allocate();(0,n.B$)(d,u);let c=a.modelMatrix;if(c){if(d){let t=l.yp.allocate();a.modelMatrix=(0,n.G9)(t,c,d)}}else a.modelMatrix=d;return a.setTransform(1,0,0,1,0,0,!0),t.isContainer?(0,o.y)(a,t,(e,s)=>r.renderGroup(t,i,t.parent.globalTransMatrix,!e&&s),i):r.renderItem(t,i),a.camera=null,a.restore(),a.modelMatrix!==c&&l.yp.free(a.modelMatrix),a.modelMatrix=c,i.in3dInterceptor=!1,!0}initCanvasCtx(t){t.setTransformForCurrent()}}},25044:function(t,e,i){"use strict";i.d(e,{K:()=>h});var r=i(17783),s=i(27177),n=i(46560),a=i(60738),l=i(42178),o=i(55418);let h=class extends l.j{constructor(){super(...arguments),this.numberType=s.Ri}drawShape(t,e,i,r,s,l,o){if(t.incremental&&s.multiGraphicOptions){let{startAtIdx:l,length:h}=s.multiGraphicOptions,{segments:u=[]}=t.attribute;if(l>u.length)return;let d=(0,n.gh)(t).area,{fill:c=d.fill,fillOpacity:p=d.fillOpacity,opacity:g=d.opacity,visible:f=d.visible}=t.attribute,m=(0,a.Bv)(g,p,c),y=(0,a.dz)(c);if(t.valid&&f&&y&&(m||o))for(let s=l;s<l+h;s++)this.drawIncreaseSegment(t,e,u[s-1],u[s],t.attribute.segments[s],[d,t.attribute],i,r)}else super.drawShape(t,e,i,r,s,l,o)}drawIncreaseSegment(t,e,i,r,s,n,a,l){r&&(e.beginPath(),(0,o.hJ)(e.camera?e:e.nativeContext,i,r,{offsetX:a,offsetY:l}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,s,n),e.setCommonStyle(t,s,a,l,n),e.fill())}};h=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,r.b)()],h)},19721:function(t,e,i){"use strict";i.d(e,{U:()=>h});var r=i(17783),s=i(46560),n=i(27177),a=i(60738),l=i(88580),o=i(55418);let h=class extends l.X{constructor(){super(...arguments),this.numberType=n.Hf}drawShape(t,e,i,r,n,l,o,h){if(t.incremental&&n.multiGraphicOptions){let{startAtIdx:e,length:l}=n.multiGraphicOptions,{segments:u=[]}=t.attribute;if(e>u.length)return;let d=(0,s.gh)(t).line,{fill:c=d.fill,stroke:p=d.stroke,opacity:g=d.opacity,fillOpacity:f=d.fillOpacity,strokeOpacity:m=d.strokeOpacity,lineWidth:y=d.lineWidth,visible:_=d.visible}=t.attribute,v=(0,a.Bv)(g,f,c),b=(0,a.Kf)(g,m),x=(0,a.dz)(c),S=(0,a.ak)(p,y);if(!t.valid||!_||!x&&!S||!(v||b||o||h))return;let{context:k}=n;for(let s=e;s<e+l;s++)this.drawIncreaseSegment(t,k,u[s-1],u[s],t.attribute.segments[s],[d,t.attribute],i,r)}else super.drawShape(t,e,i,r,n,l,o,h)}drawIncreaseSegment(t,e,i,r,s,n,a,l){r&&(e.beginPath(),(0,o.V3)(e.nativeContext,i,r,{offsetX:a,offsetY:l}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,s,n),e.setStrokeStyle(t,s,a,l,n),e.stroke())}};h=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,r.b)()],h)},88580:function(t,e,i){"use strict";i.d(e,{X:()=>d});var r=i(31535),s=i(88504),n=i(17783),a=i(46560),l=i(27177),o=i(50614),h=i(55418),u=i(83962);let d=class extends o.Y{constructor(){super(...arguments),this.numberType=l.Hf}draw(t,e,i,r){let s=(0,a.gh)(t,null==r?void 0:r.theme).line;this._draw(t,s,!1,i,r)}drawSegmentItem(t,e,i,s,n,a,l,o,u,d,c,p,g,f,m){var y;if(!e)return;t.beginPath();let _=null!=(y=this.z)?y:0;(0,h.fW)(t,e,u,d,{offsetX:c,offsetY:p,offsetZ:_}),g.cache&&!(0,r.Z)(g.cache)&&g.cache.curves.every(t=>t.defined)&&g.attribute.curveType&&g.attribute.curveType.includes("Closed")&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(g,l,o);let{x:v=0,x:b=0}=l;return!1!==i&&(f?f(t,l,o):n&&(t.setCommonStyle(g,l,v-c,b-p,o),t.fill())),!1!==s&&(m?m(t,l,o):a&&(t.setStrokeStyle(g,l,v-c,b-p,o),t.stroke())),!1}drawLinearLineHighPerformance(t,e,i,r,s,n,a,l,o,h,u,d,c){var p;e.beginPath();let g=null!=(p=this.z)?p:0,{points:f}=t.attribute,m=f[0];e.moveTo(m.x+a,m.y+l,g);for(let t=1;t<f.length;t++){let i=f[t];e.lineTo(i.x+a,i.y+l,g)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o);let{x:y=0,x:_=0}=t.attribute;!1!==i&&(d?d(e,t.attribute,o):s&&(e.setCommonStyle(t,t.attribute,y-a,_-l,o),e.fill())),!1!==r&&(c?c(e,t.attribute,o):n&&(e.setStrokeStyle(t,t.attribute,y-a,_-l,o),e.stroke()))}drawShape(t,e,i,r,n,l,o,h){let d=(0,a.gh)(t,null==l?void 0:l.theme).line,{fill:c=d.fill,stroke:p=d.stroke,fillOpacity:g=d.fillOpacity,strokeOpacity:f=d.strokeOpacity,segments:m,points:y,closePath:_,curveTension:v=d.curveTension,connectedType:b=d.connectedType}=t.attribute;if(!this.valid(t,d,o,h))return;let{curveType:x=d.curveType}=t.attribute;_&&"linear"===x&&(x="linearClosed");let{clipRange:S=d.clipRange,clipRangeByDimension:k=d.clipRangeByDimension}=t.attribute;if(1===S&&!m&&!y.some(t=>!1===t.defined)&&"linear"===x)return this.drawLinearLineHighPerformance(t,e,!!c,!!p,g,f,i,r,d,n,l,o,h);function A(t,e){return"none"===e?t:t.filter(t=>!1!==t.defined)}if(t.shouldUpdateShape()){let{points:e,segments:i}=t.attribute;if(i&&i.length){let e,r;if(t.cache=i.map((t,i)=>{if(t.points.length<=1&&0===i)return t.points[0]&&(r={endX:t.points[0].x,endY:t.points[0].y,curves:[{defined:!1!==t.points[0].defined}]}),null;1===i?e={x:r.endX,y:r.endY,defined:r.curves[r.curves.length-1].defined}:i>1&&(e.x=r.endX,e.y=r.endY,e.defined=r.curves[r.curves.length-1].defined);let s=(0,u.X0)(A(t.points,b),x,{startPoint:e,curveTension:v});return r=s,s}).filter(t=>!!t),"linearClosed"===x){let e;for(let i=0;i<t.cache.length;i++){let r=t.cache[i];for(let t=0;t<r.curves.length;t++)if(r.curves[t].defined){e=r.curves[t].p0;break}if(e)break}t.cache[t.cache.length-1]&&t.cache[t.cache.length-1].lineTo(e.x,e.y,!0)}}else{if(!e||!e.length)return t.cache=null,void t.clearUpdateShapeTag();t.cache=(0,u.X0)(A(e,b),x,{curveTension:v})}t.clearUpdateShapeTag()}if(Array.isArray(t.cache)){let n=t.attribute.segments.filter(t=>t.points.length);if(1===n[0].points.length&&n.shift(),1===S){let s=!1;t.cache.forEach((a,l)=>{s||(s=this.drawSegmentItem(e,a,!!c,!!p,g,f,n[l],[d,t.attribute],S,k,i,r,t,o,h))})}else{let a=S*t.cache.reduce((t,e)=>t+e.getLength(),0),l=0,u=!1;t.cache.forEach((m,y)=>{if(u)return;let _=m.getLength(),v=(a-l)/_;l+=_,v>0&&(u=this.drawSegmentItem(e,m,!!c,!!p,g,f,n[y],[d,t.attribute],(0,s.VV)(v,1),k,i,r,t,o,h))})}}else this.drawSegmentItem(e,t.cache,!!c,!!p,g,f,t.attribute,d,S,k,i,r,t,o,h)}};d=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,n.b)()],d)},65719:function(t,e,i){"use strict";i.d(e,{Cb:()=>o,EY:()=>g,FU:()=>m,Gs:()=>n,Iv:()=>_,O:()=>h,Pf:()=>r,Uj:()=>c,Xe:()=>s,ZT:()=>d,aP:()=>a,e0:()=>y,fS:()=>f,lG:()=>u,tP:()=>p,uz:()=>l});let r=Symbol.for("IncrementalDrawContribution"),s=Symbol.for("ArcRender");Symbol.for("Arc3dRender");let n=Symbol.for("AreaRender"),a=Symbol.for("CircleRender"),l=Symbol.for("GraphicRender"),o=Symbol.for("GroupRender"),h=Symbol.for("LineRender"),u=Symbol.for("PathRender"),d=Symbol.for("PolygonRender"),c=Symbol.for("RectRender");Symbol.for("Rect3DRender");let p=Symbol.for("SymbolRender"),g=Symbol.for("TextRender"),f=Symbol.for("RichTextRender");Symbol.for("Pyramid3dRender");let m=Symbol.for("GlyphRender"),y=Symbol.for("ImageRender");Symbol.for("RenderSelector");let _=Symbol.for("DrawContribution");Symbol.for("StarRender")},60738:function(t,e,i){"use strict";i.d(e,{Bv:()=>l,Eg:()=>p,GT:()=>o,Kf:()=>h,ZN:()=>c,Ze:()=>u,ak:()=>a,dz:()=>n,gI:()=>d});var r=i(31535),s=i(88504);function n(t,e){return!(!t&&!e)}function a(t,e){return((0,r.Z)(t)?t.some(t=>t||void 0===t):!!t)&&e>0}function l(t,e,i){return i&&t*e>0}function o(t,e,i,r,s){return s&&t*e>0&&0!==i&&0!==r}function h(t,e){return t*e>0}function u(t,e,i,r){return t*e>0&&0!==i&&0!==r}function d(t,e,i,r,s,n,a){let l=t-i,o=e-r,h=(a?n:-n)/Math.sqrt(l*l+o*o),u=h*o,d=-h*l,c=t+u,p=e+d,g=i+u,f=r+d,m=(c+g)/2,y=(p+f)/2,_=g-c,v=f-p,b=_*_+v*v,x=s-n,S=c*f-g*p,k=(v<0?-1:1)*Math.sqrt(Math.max(0,x*x*b-S*S)),A=(S*v-_*k)/b,M=(-S*_-v*k)/b,w=(S*v+_*k)/b,T=(-S*_+v*k)/b,C=A-m,E=M-y,B=w-m,P=T-y;return C*C+E*E>B*B+P*P&&(A=w,M=T),{cx:A,cy:M,x01:-u,y01:-d,x11:A*(s/x-1),y11:M*(s/x-1)}}function c(t,e,i,n,a){let l,o,h,u,d=(0,s.Wn)(i-e),c=t.getParsedCornerRadius(),p=(0,r.Z)(c),{outerDeltaAngle:g,innerDeltaAngle:f,outerStartAngle:m,outerEndAngle:y,innerEndAngle:_,innerStartAngle:v}=t.getParsePadAngle(e,i),b=p?c[0]:c,x=p?c[1]:c,S=p?c[2]:c,k=p?c[3]:c,A=Math.max(x,b),M=Math.max(S,k),w=A,T=M,C=a*(0,s.mC)(m),E=a*(0,s.O$)(m),B=n*(0,s.mC)(_),P=n*(0,s.O$)(_);if((M>s.Ho||A>s.Ho)&&(l=a*(0,s.mC)(y),o=a*(0,s.O$)(y),h=n*(0,s.mC)(v),u=n*(0,s.O$)(v),d<s.pi)){let t=function(t,e,i,r,n,a,l,o){let h=i-t,u=r-e,d=l-n,c=o-a,p=c*h-d*u;return p*p<s.Ho?[]:(p=(d*(e-a)-c*(t-n))/p,[t+p*h,e+p*u])}(C,E,h,u,l,o,B,P);if(t){let e=C-t[0],i=E-t[1],r=l-t[0],h=o-t[1],u=1/(0,s.O$)((0,s.Kh)((e*r+i*h)/((0,s._b)(e*e+i*i)*(0,s._b)(r*r+h*h)))/2),d=(0,s._b)(t[0]*t[0]+t[1]*t[1]);T=(0,s.VV)(M,(n-d)/(u-1)),w=(0,s.VV)(A,(a-d)/(u+1))}}return{outerDeltaAngle:g,xors:C,yors:E,xirs:h,yirs:u,xore:l,yore:o,xire:B,yire:P,limitedOcr:w,limitedIcr:T,outerCornerRadiusStart:b,outerCornerRadiusEnd:x,maxOuterCornerRadius:A,maxInnerCornerRadius:M,outerStartAngle:m,outerEndAngle:y,innerDeltaAngle:f,innerEndAngle:_,innerStartAngle:v,innerCornerRadiusStart:k,innerCornerRadiusEnd:S}}function p(t,e,i,r,n,a,l){let{startAngle:o,endAngle:h}=t.getParsedAngle(),u=(0,s.Wn)(h-o),p=h>o,g=!1;if(n<a){let t=n;n=a,a=t}if(n<=s.Ho)e.moveTo(i,r);else if(u>=s.f7-s.Ho)e.moveTo(i+n*(0,s.mC)(o),r+n*(0,s.O$)(o)),e.arc(i,r,n,o,h,!p),a>s.Ho&&(e.moveTo(i+a*(0,s.mC)(h),r+a*(0,s.O$)(h)),e.arc(i,r,a,h,o,p));else{let{outerDeltaAngle:u,xors:f,yors:m,xirs:y,yirs:_,limitedOcr:v,outerCornerRadiusStart:b,outerCornerRadiusEnd:x,maxOuterCornerRadius:S,xore:k,yore:A,xire:M,yire:w,outerStartAngle:T,outerEndAngle:C,limitedIcr:E,innerDeltaAngle:B,innerEndAngle:P,innerStartAngle:O,innerCornerRadiusStart:I,innerCornerRadiusEnd:R,maxInnerCornerRadius:L}=c(t,o,h,a,n);if(u<.001)l&&(l[3]||l[1])&&e.moveTo(i+f,r+m),g=!0;else if(v>s.Ho){let t=(0,s.VV)(b,v),a=(0,s.VV)(x,v),o=d(y,_,f,m,n,t,Number(p)),h=d(k,A,M,w,n,a,Number(p));v<S&&t===a?!l||l[0]?(e.moveTo(i+o.cx+o.x01,r+o.cy+o.y01),e.arc(i+o.cx,r+o.cy,v,(0,s.fv)(o.y01,o.x01),(0,s.fv)(h.y01,h.x01),!p)):e.moveTo(i+o.cx+v*(0,s.mC)((0,s.fv)(h.y01,h.x01)),r+o.cy+v*(0,s.O$)((0,s.fv)(h.y01,h.x01))):!l||l[0]?(e.moveTo(i+o.cx+o.x01,r+o.cy+o.y01),t>0&&e.arc(i+o.cx,r+o.cy,t,(0,s.fv)(o.y01,o.x01),(0,s.fv)(o.y11,o.x11),!p),e.arc(i,r,n,(0,s.fv)(o.cy+o.y11,o.cx+o.x11),(0,s.fv)(h.cy+h.y11,h.cx+h.x11),!p),a>0&&e.arc(i+h.cx,r+h.cy,a,(0,s.fv)(h.y11,h.x11),(0,s.fv)(h.y01,h.x01),!p)):a>0?e.moveTo(i+h.cx+a*(0,s.mC)((0,s.fv)(h.y01,h.x01)),r+h.cy+a*(0,s.O$)((0,s.fv)(h.y01,h.x01))):e.moveTo(i+k,r+n*(0,s.O$)(C))}else!l||l[0]?(e.moveTo(i+f,r+m),e.arc(i,r,n,T,C,!p)):e.moveTo(i+n*(0,s.mC)(C),r+n*(0,s.O$)(C));if(!(a>s.Ho)||B<.001)!l||l[1]?e.lineTo(i+M,r+w):e.moveTo(i+M,r+w),g=!0;else if(E>s.Ho){let t=(0,s.VV)(I,E),n=(0,s.VV)(R,E),o=d(M,w,k,A,a,-n,Number(p)),h=d(f,m,y,_,a,-t,Number(p));if(!l||l[1]?e.lineTo(i+o.cx+o.x01,r+o.cy+o.y01):e.moveTo(i+o.cx+o.x01,r+o.cy+o.y01),E<L&&t===n){let t=(0,s.fv)(h.y01,h.x01);!l||l[2]?e.arc(i+o.cx,r+o.cy,E,(0,s.fv)(o.y01,o.x01),t,!p):e.moveTo(i+o.cx+(0,s.mC)(t),r+o.cy+(0,s.O$)(t))}else!l||l[2]?(n>0&&e.arc(i+o.cx,r+o.cy,n,(0,s.fv)(o.y01,o.x01),(0,s.fv)(o.y11,o.x11),!p),e.arc(i,r,a,(0,s.fv)(o.cy+o.y11,o.cx+o.x11),(0,s.fv)(h.cy+h.y11,h.cx+h.x11),p),t>0&&e.arc(i+h.cx,r+h.cy,t,(0,s.fv)(h.y11,h.x11),(0,s.fv)(h.y01,h.x01),!p)):t>0?e.moveTo(i+h.cx+t*(0,s.mC)((0,s.fv)(h.y01,h.x01)),r+h.cy+t*(0,s.O$)((0,s.fv)(h.y01,h.x01))):e.moveTo(i+y,r+_)}else!l||l[1]?e.lineTo(i+M,r+w):e.moveTo(i+M,r+w),!l||l[2]?e.arc(i,r,a,P,O,p):e.moveTo(i+a*(0,s.mC)(O),r+a*(0,s.O$)(O))}return l?l[3]&&e.lineTo(i+n*(0,s.mC)(o),r+n*(0,s.O$)(o)):e.closePath(),g}},18346:function(t,e,i){"use strict";i.d(e,{I2:()=>o,pi:()=>l});var r,s=i(17783),n=i(41809),a=i(65719);let l=Symbol.for("RenderService");Symbol.for("BeforeRenderConstribution");let o=class{constructor(t){this.drawContribution=t}prepare(t){t&&this.renderTreeRoots.forEach(e=>{this._prepare(e,t)})}_prepare(t,e){t.forEachChildren(t=>{this._prepare(t,e)}),t.update({bounds:e,trans:!0})}prepareRenderList(){}beforeDraw(t){}draw(t){this.drawContribution.draw(this,Object.assign({},this.drawParams))}afterDraw(t){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}reInit(){this.drawContribution.reInit()}render(t,e){this.renderTreeRoots=t,this.drawParams=e;let i=e.updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(e),this.draw(e),this.afterDraw(e),this.drawParams=null}};o=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,s.b)(),(r=(0,n.f)(a.Iv),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],o)},77502:function(t,e,i){"use strict";i.d(e,{h:()=>s});var r=i(96087);class s{static GetImage(t,e){var i;let n=s.cache.get(t);n?"fail"===n.loadState?r.w.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):"init"===n.loadState||"loading"===n.loadState?null==(i=n.waitingMark)||i.push(e):e&&e.imageLoadSuccess(t,n.data):s.loadImage(t,e)}static GetSvg(t,e){var i;let n=s.cache.get(t);n?"fail"===n.loadState?r.w.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):"init"===n.loadState||"loading"===n.loadState?null==(i=n.waitingMark)||i.push(e):e&&e.imageLoadSuccess(t,n.data):(n={type:"image",loadState:"init"},s.cache.set(t,n),n.dataPromise=r.w.global.loadSvg(t),n.dataPromise?(n.waitingMark=[e],n.dataPromise.then(e=>{var i;n.loadState=(null==e?void 0:e.data)?"success":"fail",n.data=null==e?void 0:e.data,null==(i=n.waitingMark)||i.map((i,r)=>{(null==e?void 0:e.data)?(n.loadState="success",n.data=e.data,i.imageLoadSuccess(t,e.data)):(n.loadState="fail",i.imageLoadFail(t))}),n.waitingMark&&(n.waitingMark=[])})):(n.loadState="fail",e.imageLoadFail(t)))}static GetFile(t,e){let i=s.cache.get(t);return i?"fail"===i.loadState?Promise.reject():"init"===i.loadState||"loading"===i.loadState?i.dataPromise.then(t=>t.data):Promise.resolve(i.data):(i={type:e,loadState:"init"},s.cache.set(t,i),"arrayBuffer"===e?i.dataPromise=r.w.global.loadArrayBuffer(t):"blob"===e?i.dataPromise=r.w.global.loadBlob(t):"json"===e&&(i.dataPromise=r.w.global.loadJson(t)),i.dataPromise.then(t=>t.data))}static loading(){setTimeout(()=>{if(!s.isLoading&&s.toLoadAueue.length){s.isLoading=!0;let t=s.toLoadAueue.splice(0,10),e=[];t.forEach(t=>{let{url:i,marks:n}=t,a={type:"image",loadState:"init"};if(s.cache.set(i,a),a.dataPromise=r.w.global.loadImage(i),a.dataPromise){a.waitingMark=n;let t=a.dataPromise.then(t=>{var e;a.loadState=(null==t?void 0:t.data)?"success":"fail",a.data=null==t?void 0:t.data,null==(e=a.waitingMark)||e.map((e,r)=>{(null==t?void 0:t.data)?(a.loadState="success",a.data=t.data,e.imageLoadSuccess(i,t.data)):(a.loadState="fail",e.imageLoadFail(i))}),a.waitingMark&&(a.waitingMark=[])});e.push(t)}else a.loadState="fail",n.forEach(t=>t.imageLoadFail(i))}),Promise.all(e).then(()=>{s.isLoading=!1,this.onLoadSuccessCb.forEach(t=>t()),s.loading()}).catch(t=>{console.error(t),s.isLoading=!1,this.onLoadSuccessCb.forEach(t=>t()),s.loading()})}},0)}static loadImage(t,e){let i=n(t,s.toLoadAueue);if(-1!==i)return s.toLoadAueue[i].marks.push(e),void s.loading();s.toLoadAueue.push({url:t,marks:[e]}),s.loading()}static improveImageLoading(t){let e=n(t,s.toLoadAueue);if(-1!==e){let t=s.toLoadAueue.splice(e,1);s.toLoadAueue.unshift(t[0])}}static onLoadSuccess(t){this.onLoadSuccessCb.push(t)}}function n(t,e){for(let i=0;i<e.length;i++)if(e[i].url===t)return i;return -1}s.cache=new Map,s.isLoading=!1,s.toLoadAueue=[],s.onLoadSuccessCb=[]},20420:function(t,e,i){"use strict";i.d(e,{n:()=>s});class r{constructor(t,e){this._args=t,this.name=e,this.taps=[]}tap(t,e){this._tap("sync",t,e)}unTap(t,e){let i="string"==typeof t?t.trim():t.name;i&&(this.taps=this.taps.filter(t=>!(t.name===i&&(!e||t.fn===e))))}_parseOptions(t,e,i){let r;if("string"==typeof e)r={name:e.trim()};else if("object"!=typeof e||null===e)throw Error("Invalid tap options");if("string"!=typeof r.name||""===r.name)throw Error("Missing name for tap");return Object.assign({type:t,fn:i},r)}_tap(t,e,i){this._insert(this._parseOptions(t,e,i))}_insert(t){let e;"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));let i=0;"number"==typeof t.stage&&(i=t.stage);let r=this.taps.length;for(;r>0;){r--;let t=this.taps[r];this.taps[r+1]=t;let s=t.stage||0;if(e){if(e.has(t.name)){e.delete(t.name);continue}if(e.size>0)continue}if(!(s>i)){r++;break}}this.taps[r]=t}}class s extends r{call(...t){this.taps.map(t=>t.fn).forEach(e=>e(...t))}}},56304:function(t,e,i){"use strict";i.d(e,{s:()=>m});var r=i(88504),s=i(8992),n=i(30943),a=i(28504),l=i(59484),o=i(53627),h=i(46527),u=i(74239),d=i(96087),c=i(29436),p=i(17783);let g=[0,0,0],f=(t,e,i,s,n,a,l,o)=>{if(o)for(;i>e;)i-=r.f7;else for(;i<e;)i+=r.f7;let h=r.pi/3*(i>e?1:-1),u=e,d=u;for(;d!==i;){let e=4*Math.tan(Math.abs((d=h>0?Math.min(d+h,i):Math.max(d+h,i))-u)/4)/3,r=d<u?-1:1,o=Math.cos(u),c=Math.sin(u),p=Math.cos(d),g=Math.sin(d),f=o*a+s,m=c*l+n,y=p*a+s,_=g*l+n,v=a*e*r,b=l*e*r;t.push([f-v*c,m+b*o,y+v*g,_-b*p,y,_]),u=d}},m=class{set fillStyle(t){this.nativeContext.fillStyle=t}get fillStyle(){return this.nativeContext.fillStyle}set font(t){t!==this._font&&(this._font=t,this.nativeContext.font=t)}get font(){var t;return null!=(t=this._font)?t:this.nativeContext.font}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha}get globalAlpha(){return this.nativeContext.globalAlpha}set lineCap(t){this.nativeContext.lineCap=t}get lineCap(){return this.nativeContext.lineCap}set lineDashOffset(t){this.nativeContext.lineDashOffset=t}get lineDashOffset(){return this.nativeContext.lineDashOffset}set lineJoin(t){this.nativeContext.lineJoin=t}get lineJoin(){return this.nativeContext.lineJoin}set lineWidth(t){this.nativeContext.lineWidth=t}get lineWidth(){return this.nativeContext.lineWidth}set miterLimit(t){this.nativeContext.miterLimit=t}get miterLimit(){return this.nativeContext.miterLimit}set shadowBlur(t){this.nativeContext.shadowBlur=t}get shadowBlur(){return this.nativeContext.shadowBlur}set shadowColor(t){this.nativeContext.shadowColor=t}get shadowColor(){return this.nativeContext.shadowColor}set shadowOffsetX(t){this.nativeContext.shadowOffsetX=t}get shadowOffsetX(){return this.nativeContext.shadowOffsetX}set shadowOffsetY(t){this.nativeContext.shadowOffsetY=t}get shadowOffsetY(){return this.nativeContext.shadowOffsetY}set strokeStyle(t){this.nativeContext.strokeStyle=t}get strokeStyle(){return this.nativeContext.strokeStyle}set textAlign(t){this.nativeContext.textAlign=t}get textAlign(){return this.nativeContext.textAlign}set textBaseline(t){this.nativeContext.textBaseline=t}get textBaseline(){return this.nativeContext.textBaseline}get inuse(){return!!this._inuse}set inuse(t){!!this._inuse!==t&&(this._inuse=t,t?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}constructor(t,e){this.fillAttributes=Object.assign(Object.assign({},l.pp),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},l.WC),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},l.q9),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;let i=t.nativeCanvas.getContext("2d");if(!i)throw Error("发生错误，获取2d上下文失败");this.nativeContext=i,this.canvas=t,this.matrix=new s.y(1,0,0,1,0,0),this.stack=[],this.dpr=e,this.applyedMatrix=new s.y(1,0,0,1,0,0),this._clearMatrix=new s.y(1,0,0,1,0,0),this.baseGlobalAlpha=1}reset(t=!0){this.stack.length&&n.Y.getInstance().warn("可能存在bug，matrix没有清空"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new s.y(1,0,0,1,0,0),this.stack.length=0,t&&this.nativeContext.setTransform(1,0,0,1,0,0)}getCanvas(){return this.canvas}getContext(){return this.nativeContext}setTransformForCurrent(t=!1){!t&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}get currentMatrix(){return this.matrix}cloneMatrix(t){return o.QE.allocateByObj(t)}clear(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}restore(){this.nativeContext.restore(),this.stack.length>0&&(o.QE.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0)),this.font="",this._clearFilterStyle=!1,this._clearShadowStyle=!1}highPerformanceRestore(){this.stack.length>0&&(o.QE.free(this.matrix),this.matrix=this.stack.pop())}rotate(t,e=!0){this.matrix.rotate(t),e&&this.setTransformForCurrent()}save(){let t=this.cloneMatrix(this.matrix);this.stack.push(t),this.nativeContext.save()}highPerformanceSave(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}scale(t,e,i=!0){this.matrix.scale(t,e),i&&this.setTransformForCurrent()}setScale(t,e,i=!0){this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}scalePoint(t,e,i,r,s=!0){this.translate(i,r,!1),this.scale(t,e,!1),this.translate(-i,-r,!1),s&&this.setTransformForCurrent()}setTransform(t,e,i,r,s,n,a=!0,l=this.dpr){this.matrix.setValue(l*t,l*e,l*i,l*r,l*s,l*n),a&&this.setTransformForCurrent()}setTransformFromMatrix(t,e=!0,i=this.dpr){this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}resetTransform(t=!0,e=this.dpr){this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}transform(t,e,i,r,s,n,a=!0){this.matrix.multiply(t,e,i,r,s,n),a&&this.setTransformForCurrent()}transformFromMatrix(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}translate(t,e,i=!0){this.matrix.translate(t,e),i&&this.setTransformForCurrent()}rotateDegrees(t,e=!0){let i=t*Math.PI/180;this.rotate(i,e)}rotateAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}rotateDegreesAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}beginPath(){this.disableBeginPath||this.nativeContext.beginPath()}clip(t,e){t?"string"==typeof t?this.nativeContext.clip(t):this.nativeContext.clip(t,e):this.nativeContext.clip()}arc(t,e,i,r,s,n,a){if(a=a||0,this.camera){let l=[];f(l,r,s,t,e,i,i,n);for(let t=0;t<l.length;++t){let e=l[t];this.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5],a)}}else this.nativeContext.arc(t,e,Math.max(0,i),r,s,n)}arcTo(t,e,i,r,s){this.nativeContext.arcTo(t,e,i,r,s)}bezierCurveTo(t,e,i,r,s,n,a){if(a=a||0,this.camera){let l=a,o=a;this.modelMatrix&&((0,h.fF)(g,[t,e,a],this.modelMatrix),t=g[0],e=g[1],l=g[2],(0,h.fF)(g,[i,r,a],this.modelMatrix),i=g[0],r=g[1],o=g[2],(0,h.fF)(g,[s,n,a],this.modelMatrix),s=g[0],n=g[1],a=g[2]);let u=this.camera.vp(s,n,a);s=u.x,n=u.y,t=(u=this.camera.vp(t,e,l)).x,e=u.y,i=(u=this.camera.vp(i,r,o)).x,r=u.y}this.nativeContext.bezierCurveTo(t,e,i,r,s,n)}closePath(){this.nativeContext.closePath()}ellipse(t,e,i,r,s,n,a,l){null==l?this.nativeContext.ellipse(t,e,i,r,s,n,a):this.nativeContext.ellipse(t,e,i,r,s,n,a,l)}lineTo(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[t,e,i],this.modelMatrix),t=g[0],e=g[1],i=g[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.lineTo(t,e)}moveTo(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[t,e,i],this.modelMatrix),t=g[0],e=g[1],i=g[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.moveTo(t,e)}quadraticCurveTo(t,e,i,r,s){if(s=s||0,this.camera){let n=s;this.modelMatrix&&((0,h.fF)(g,[t,e,s],this.modelMatrix),t=g[0],e=g[1],n=g[2],(0,h.fF)(g,[i,r,s],this.modelMatrix),i=g[0],r=g[1],s=g[2]);let a=this.camera.vp(i,r,s);i=a.x,r=a.y,t=(a=this.camera.vp(t,e,n)).x,e=a.y}this.nativeContext.quadraticCurveTo(t,e,i,r)}rect(t,e,i,r,s){s=s||0,this.camera?(this.moveTo(t,e,s),this.lineTo(t+i,e,s),this.lineTo(t+i,e+r,s),this.lineTo(t,e+r,s),this.closePath()):this.nativeContext.rect(t,e,i,r)}createImageData(){let t=arguments;return 2===t.length?this.nativeContext.createImageData(t[0],t[1]):1===t.length?this.nativeContext.createImageData(t[0]):null}createLinearGradient(t,e,i,r){return isFinite(t+e+i+r)||(t=0,e=0,i=0,r=0),this.nativeContext.createLinearGradient(t,e,i,r)}createPattern(t,e){return 0===t.width||0===t.height?null:this.nativeContext.createPattern(t,e)}createRadialGradient(t,e,i,r,s,n){return this.nativeContext.createRadialGradient(t,e,i,r,s,n)}createConicGradient(t,e,i,r){if(this.nativeContext.createConicGradient&&.001>Math.abs(r-i-2*Math.PI))return this.nativeContext.createConicGradient(i,t,e);let s,n=!1,a=this;return{stops:[],addColorStop(t,e){this.stops.push([t,e]),n=!0},GetPattern(l,o,h){return n&&(h||(h=r-i),s=(0,u.Of)(a,this.stops,t,e,h,i,r,l,o),n=!1),s}}}fill(t,e){this.disableFill||(t?this.nativeContext.fill(t):this.nativeContext.fill())}fillRect(t,e,i,r){this.nativeContext.fillRect(t,e,i,r)}clearRect(t,e,i,r){this.nativeContext.clearRect(t,e,i,r)}project(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[t,e,i],this.modelMatrix),t=g[0],e=g[1],i=g[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}return{x:t,y:e}}view(t,e,i){return i=i||0,this.camera?(this.modelMatrix&&((0,h.fF)(g,[t,e,i],this.modelMatrix),t=g[0],e=g[1],i=g[2]),this.camera.view(t,e,i)):[t,e,i]}fillText(t,e,i,r){if(r=r||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[e,i,r],this.modelMatrix),e=g[0],i=g[1],r=g[2]);let t=this.camera.vp(e,i,r);e=t.x,i=t.y}this.nativeContext.fillText(t,e,i)}getImageData(t,e,i,r){return this.nativeContext.getImageData(t,e,i,r)}getLineDash(){return this.nativeContext.getLineDash()}isPointInPath(t,e){return this.nativeContext.isPointInPath(t,e)}isPointInStroke(t,e){return this.nativeContext.isPointInStroke(t,e)}measureText(t,e=d.w.global.measureTextMethod){var i,r;if(!e||"native"===e)return this.nativeContext.measureText(t);this.mathTextMeasure||(this.mathTextMeasure=d.w.graphicUtil.createTextMeasureInstance({},{},()=>this.canvas.nativeCanvas));let s=null!=(i=this.fontFamily)?i:l.q9.fontFamily,n=null!=(r=this.fontSize)?r:l.q9.fontSize;return this.mathTextMeasure.textSpec.fontFamily===s&&this.mathTextMeasure.textSpec.fontSize===n||(this.mathTextMeasure.textSpec.fontFamily=s,this.mathTextMeasure.textSpec.fontSize=n,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(t,e)}putImageData(t,e,i){this.nativeContext.putImageData(t,e,i)}setLineDash(t){let e=arguments,i=this.nativeContext;this.nativeContext.setLineDash?e[0]&&i.setLineDash(e[0]):"mozDash"in i?i.mozDash=e[0]:"webkitLineDash"in i&&(i.webkitLineDash=e[0])}stroke(t){this.disableStroke||(t?this.nativeContext.stroke(t):this.nativeContext.stroke())}strokeRect(t,e,i,r){this.nativeContext.strokeRect(t,e,i,r)}strokeText(t,e,i,r){if(r=r||0,this.camera){this.modelMatrix&&((0,h.fF)(g,[e,i,r],this.modelMatrix),e=g[0],i=g[1],r=g[2]);let t=this.camera.vp(e,i,r);e=t.x,i=t.y}this.nativeContext.strokeText(t,e,i)}drawImage(){let t=this.nativeContext,e=arguments;3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}setCommonStyle(t,e,i,r,s){if(Array.isArray(s)){if(s.length<=1)return this._setCommonStyle(t,e,i,r,s[0]);let n=Object.create(s[0]);return s.forEach((t,e)=>{0!==e&&Object.assign(n,t)}),this._setCommonStyle(t,e,i,r,n)}return this._setCommonStyle(t,e,i,r,s)}_setCommonStyle(t,e,i,r,s){let n=this.nativeContext;s||(s=this.fillAttributes);let{fillOpacity:a=s.fillOpacity,opacity:l=s.opacity,fill:o=s.fill}=e;n.globalAlpha=a*l*this.baseGlobalAlpha,a>1e-12&&l>1e-12&&(n.fillStyle=(0,c.L)(this,o,t,i,r))}setShadowBlendStyle(t,e,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(t,i[0]);let r=Object.create(i[0]);return i.forEach((t,e)=>{0!==e&&Object.assign(r,t)}),this._setShadowBlendStyle(t,e,r)}return this._setShadowBlendStyle(t,e,i)}_setShadowBlendStyle(t,e,i){let r=this.nativeContext;i||(i=this.fillAttributes);let{opacity:s=i.opacity,shadowBlur:n=i.shadowBlur,shadowOffsetX:a=i.shadowOffsetX,shadowOffsetY:l=i.shadowOffsetY,blur:o=i.blur,globalCompositeOperation:h=i.globalCompositeOperation}=e;if(!(s<=1e-12)){if(a||l||n){let{shadowColor:t=i.shadowColor,shadowOffsetX:s=i.shadowOffsetX,shadowOffsetY:a=i.shadowOffsetY}=e;r.shadowBlur=n*this.dpr,r.shadowColor=t,r.shadowOffsetX=s*this.dpr,r.shadowOffsetY=a*this.dpr,this._clearShadowStyle=!0}else this._clearShadowStyle&&(r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0);o?(r.filter=`blur(${o}px)`,this._clearFilterStyle=!0):this._clearFilterStyle&&(r.filter="blur(0px)",this._clearFilterStyle=!1),h?(r.globalCompositeOperation=h,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(r.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1)}}setStrokeStyle(t,e,i,r,s){if(Array.isArray(s)){if(s.length<=1)return this._setStrokeStyle(t,e,i,r,s[0]);let n=Object.create(s[0]);return s.forEach((t,e)=>{0!==e&&Object.assign(n,t)}),this._setStrokeStyle(t,e,i,r,n)}return this._setStrokeStyle(t,e,i,r,s)}_setStrokeStyle(t,e,i,r,s){let n=this.nativeContext;s||(s=this.strokeAttributes);let{strokeOpacity:a=s.strokeOpacity,opacity:l=s.opacity}=e;if(n.globalAlpha=a*l*this.baseGlobalAlpha,a>1e-12&&l>1e-12){let{lineWidth:a=s.lineWidth,stroke:l=s.stroke,lineJoin:o=s.lineJoin,lineDash:h=s.lineDash,lineDashOffset:u=s.lineDashOffset,lineCap:d=s.lineCap,miterLimit:p=s.miterLimit,keepStrokeScale:g=s.keepStrokeScale}=e;n.lineWidth=g?a:(0,c.D)(this,a,this.dpr),n.strokeStyle=(0,c.L)(this,l,t,i,r),n.lineJoin=o,h&&(n.setLineDash(h),n.lineDashOffset=u),n.lineCap=d,n.miterLimit=p}}setTextStyleWithoutAlignBaseline(t,e,i){let r=this.nativeContext;e||(e=this.textAttributes);let{scaleIn3d:s=e.scaleIn3d}=t;t.font?this.font=t.font:this.font=(0,a.U)(t,e,s&&this.camera&&this.camera.getProjectionScale(i));let{fontFamily:n=e.fontFamily,fontSize:l=e.fontSize}=t;this.fontFamily=n,this.fontSize=l,r.textAlign="left",r.textBaseline="alphabetic"}setTextStyle(t,e,i){var r,s;let n=this.nativeContext;e||(e=this.textAttributes),t.font?this.font=t.font:this.font=(0,a.U)(t,e,this.camera&&this.camera.getProjectionScale(i));let{fontFamily:l=e.fontFamily,fontSize:o=e.fontSize}=t;this.fontFamily=l,this.fontSize=o,n.textAlign=null!=(r=t.textAlign)?r:e.textAlign,n.textBaseline=null!=(s=t.textBaseline)?s:e.textBaseline}draw(){}clearMatrix(t=!0,e=this.dpr){this.setTransformFromMatrix(this._clearMatrix,t,e)}setClearMatrix(t,e,i,r,s,n){this._clearMatrix.setValue(t,e,i,r,s,n)}onlyTranslate(t=this.dpr){return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}release(...t){this.stack.forEach(t=>o.QE.free(t)),this.stack.length=0}};m.env="browser",m=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,p.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],m)},36444:function(t,e,i){"use strict";i.d(e,{l:()=>n});var r=i(14364),s=i(42832);function n(t,e){return new r.n(i=>{i(s.r).toDynamicValue(()=>e=>new t(e)).whenTargetNamed(t.env),i(s.A).toDynamicValue(()=>(t,i)=>new e(t,i)).whenTargetNamed(e.env)})}},54611:function(t,e,i){"use strict";i.d(e,{Ns:()=>T});var r,s=i(14364),n=i(8385),a=i(89359),l=i(96087),o=i(17783),h=i(56304);let u=class extends a.u{constructor(t){super(t)}init(t){let{container:e}=t;if("string"==typeof e){let t=l.w.global.getElementById(e);t&&(this._container=t)}else this._container=e;this._context=new h.s(this,this._dpr),this.initStyle()}initStyle(){if(!this.controled)return;let{nativeCanvas:t}=this;t.width=this._pixelWidth,t.height=this._pixelHeight,t.style&&this.setCanvasStyle(t,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(t),this.visiable||this.hide()}hide(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}show(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}applyPosition(){let t=this._nativeCanvas;t.style.position="absolute",t.style.top=`${this._y}px`,t.style.left=`${this._x}px`}resetStyle(t){if(!this.controled)return;let{width:e=this._displayWidth,height:i=this._displayHeight,dpr:r=this._dpr,x:s=this._x,y:n=this._y}=t,{nativeCanvas:a}=this;a.width=e*r,a.height=i*r,a.style&&this.setCanvasStyle(a,s,n,e,i),t.id&&(a.id=t.id),this.visiable||this.hide()}setCanvasStyle(t,e,i,r,s){this.controled&&(t.style.width=`${r}px`,t.style.height=`${s}px`)}toDataURL(t,e){return"image/jpeg"===t?this._nativeCanvas.toDataURL(t,e):"image/png"===t?this._nativeCanvas.toDataURL(t):this._nativeCanvas.toDataURL(t,e)}resize(t,e){this.controled&&(this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.style&&(this._nativeCanvas.style.width=`${t}px`,this._nativeCanvas.style.height=`${e}px`),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}};u.env="browser",u=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,o.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],u);let d=(0,i(36444).l)(u,h.s);var c=i(23364),p=i(69493),g=i(52650),f=i(76620),m=i(8992);let y=r=class extends p.X{get container(){return this.canvas.nativeCanvas.parentElement}static GenerateCanvasId(){return`${r.idprefix}_${r.prefix_count++}`}constructor(){super(),this.type="browser",this._canvasIsIntersecting=!0,this.global=l.w.global,this.viewBox=new f.FB,this.modelMatrix=new m.y(1,0,0,1,0,0)}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return this.canvas.nativeCanvas.getBoundingClientRect()}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t),this.postInit()}postInit(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch(t){console.error("发生错误，该环境不存在IntersectionObserver")}}isElementVisible(t){let e=t.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight;return!(e.right<0||e.bottom<0||e.left>i||e.top>r)}observerCanvas(){this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);let t=new IntersectionObserver((t,e)=>{t.forEach(t=>{this._canvasIsIntersecting!==t.isIntersecting?(this._canvasIsIntersecting=t.isIntersecting,this._onVisibleChangeCb&&this._onVisibleChangeCb(t.isIntersecting)):this._canvasIsIntersecting=t.isIntersecting})});t&&t.observe(this.canvas.nativeCanvas)}createWindowByConfig(t){let e,i=this.global.createCanvas({width:t.width,height:t.height});if(!(e="string"==typeof t.container?this.global.getElementById(t.container):t.container?t.container:this.global.getRootElement()))throw Error("发生错误，containerId可能传入有误");t.offscreen?e=null:e.appendChild(i);let s={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:i,container:e,id:r.GenerateCanvasId(),canvasControled:!0};this.canvas=new u(s)}createWindowByCanvas(t){var e;let i;if("string"==typeof t.canvas){if(!(i=this.global.getElementById(t.canvas)))throw Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else i=t.canvas;if(!i)throw Error("发生错误，传入的canvas不正确");let r=t.width,s=t.height;if(null==r||null==s||!t.canvasControled){let t=i.getBoundingClientRect();r=t.width,s=t.height}let n=t.dpr;null==n&&(n=null!=(e=i.getContext("2d").pixelRatio)?e:i.width/r),this.canvas=new u({width:r,height:s,dpr:n,nativeCanvas:i,canvasControled:t.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e,i){return this.canvas.nativeCanvas.addEventListener(t,e,i)}removeEventListener(t,e,i){return this.canvas.nativeCanvas.removeEventListener(t,e,i)}dispatchEvent(t){return this.canvas.nativeCanvas.dispatchEvent(t)}getStyle(){var t;return null!=(t=this.canvas.nativeCanvas.style)?t:{}}setStyle(t){this.canvas.nativeCanvas.style=t}getBoundingClientRect(){let t=this.canvas.nativeCanvas,e=this.getWH();return t.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:e.width,height:e.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}isVisible(t){return this._canvasIsIntersecting}onVisibleChange(t){this._onVisibleChangeCb=t}getTopLeft(t){return this.global.getElementTopLeft(this.canvas.nativeCanvas,t)}};y.env="browser",y.idprefix="visactor_window",y.prefix_count=0,y=r=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,o.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],y);let _=new s.n(t=>{t(y).toSelf(),t(g.zd).toDynamicValue(t=>t.container.get(y)).whenTargetNamed(y.env)});var v=i(35238),b=i(35437),x=i(70501),S=i(30756);class k{get x1(){return this.dom.getBoundingClientRect().left}get x2(){return this.dom.getBoundingClientRect().right}get y1(){return this.dom.getBoundingClientRect().top}get y2(){return this.dom.getBoundingClientRect().bottom}get width(){return this.dom.getBoundingClientRect().width}get height(){return this.dom.getBoundingClientRect().height}constructor(t){this.dom=t}}function A(t,e=!1){let i=document.createElement("img");if(l.w.global.isImageAnonymous&&(i.crossOrigin="anonymous"),e){let e=new Blob([t],{type:"image/svg+xml"});t=window.URL.createObjectURL(e)}return(i.src=t,i.complete)?Promise.resolve(i):new Promise((t,e)=>{i.onload=()=>{t(i)},i.onerror=()=>{e(Error("加载失败"))}})}let M=class extends v.z{constructor(){super(),this.type="browser",this.supportEvent=!0;try{this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsTouchEvents=!1,this.supportsPointerEvents=!1,this.supportsPointerEvents=!1}this.applyStyles=!0}mapToCanvasPoint(t,e){var i,r;let s=0,n=0,a=0,l=0;if(t.changedTouches){let e=null!=(i=t.changedTouches[0])?i:{};s=e.clientX||0,n=e.clientY||0,a=s,l=n}else s=t.clientX||0,n=t.clientY||0,a=t.offsetX||0,l=t.offsetY||0;if(e){let t,i,a=s,l=n,o=e.getBoundingClientRect(),h=null==(r=e.getNativeHandler)?void 0:r.call(e).nativeCanvas;return h&&(t=o.width/h.offsetWidth,i=o.height/h.offsetHeight),{x:(a-o.left)/((0,x.Z)(t)?t:1),y:(l-o.top)/((0,x.Z)(i)?i:1)}}return{x:a,y:l}}getNativeAABBBounds(t){let e=t;return("string"==typeof t&&(e=(new DOMParser).parseFromString(t,"text/html").firstChild).lastChild&&(e=e.lastChild.firstChild),e.getBoundingClientRect)?new k(e.getBoundingClientRect()):new f.FB}removeDom(t){return t.parentElement.removeChild(t),!0}updateDom(t,e){let{width:i,height:r,style:s}=e;return s&&((0,S.Z)(s)?t.setAttribute("style",s):Object.keys(s).forEach(e=>{t.style[e]=s[e]})),null!=i&&(t.style.width=`${i}px`),null!=r&&(t.style.height=`${r}px`),!0}createDom(t){let{tagName:e="div",parent:i}=t,r=document.createElement(e);if(this.updateDom(r,t),i){let t=(0,S.Z)(i)?this.getElementById(i):i;t&&t.appendChild&&t.appendChild(r)}return r}loadImage(t){return A(t,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(t){return A(t,!0).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}createCanvas(t){var e,i;let r=document.createElement("canvas");t.id&&(r.id=null!=(e=t.id)?e:b.R.GenAutoIncrementId().toString());let s=null!=(i=t.dpr)?i:window.devicePixelRatio;return t.width&&t.height&&(r.style.width=`${t.width}px`,r.style.height=`${t.height}px`,r.width=t.width*s,r.height=t.height*s),r}createOffscreenCanvas(t){var e;let i=null!=(e=t.dpr)?e:window.devicePixelRatio;return new OffscreenCanvas(t.width*i,t.height*i)}releaseCanvas(t){let e;(e="string"==typeof t?document.getElementById(t):t)&&e.parentElement&&e.parentElement.removeChild(e)}getDevicePixelRatio(){return window.devicePixelRatio}getRequestAnimationFrame(){return window.requestAnimationFrame}getCancelAnimationFrame(){return window.cancelAnimationFrame}addEventListener(t,e,i){return document.addEventListener(t,e,i)}removeEventListener(t,e,i){return document.removeEventListener(t,e,i)}dispatchEvent(t){return document.dispatchEvent(t)}getElementById(t){return document.getElementById(t)}getRootElement(){return document.body}getDocument(){return document}release(...t){}getElementTop(t,e){let i=t.offsetTop,r=t.offsetParent;for(;null!==r;)i+=r.offsetTop,r=r.offsetParent;return i}getElementLeft(t,e){let i=t.offsetLeft,r=t.offsetParent;for(;null!==r;)i+=r.offsetLeft,r=r.offsetParent;return i}getElementTopLeft(t,e){let i=t.offsetTop,r=t.offsetLeft,s=t.offsetParent;for(;null!==s;)i+=s.offsetTop,r+=s.offsetLeft,s=s.offsetParent;return{top:i,left:r}}loadFont(t,e,i){var r,s,n,a;return r=this,s=void 0,n=void 0,a=function*(){return new FontFace(t,(0,S.Z)(e)?`url(${e})`:e,i).load().then(function(t){return document.fonts.add(t),{loadState:"success"}}).catch(function(t){return console.error("Failed to load font:",t),{loadState:"fail"}})},new(n||(n=Promise))(function(t,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function l(t){try{o(a.throw(t))}catch(t){e(t)}}function o(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n(function(t){t(r)})).then(i,l)}o((a=a.apply(r,s||[])).next())})}isMacOS(){if(void 0===this._isMacOS)try{this._isMacOS=navigator.platform.toUpperCase().indexOf("MAC")>=0}catch(t){this._isMacOS=!1}return this._isMacOS}copyToClipBoard(t){return navigator.clipboard.writeText(t).then(()=>{}).catch(t=>{})}};M=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,o.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],M);let w=new s.n(t=>{w.isBrowserBound||(w.isBrowserBound=!0,t(M).toSelf().inSingletonScope(),t(n.D0).toService(M))});function T(t,e=!0){T.__loaded||(T.__loaded=!0,t.load(w),t.load(d),t.load(_),e&&(0,c.q)(t))}w.isBrowserBound=!1,T.__loaded=!1},37730:function(t,e,i){"use strict";i.d(e,{sn:()=>A});var r,s=i(14364),n=i(8385),a=i(89359),l=i(17783),o=i(8992),h=i(56304);let u=class extends h.s{constructor(t,e){super(t,e);let i=t.nativeCanvas.getContext("2d");if(!i)throw Error("发生错误，获取2d上下文失败");this.nativeContext=i,this.canvas=t,this.matrix=new o.y(1,0,0,1,0,0),this.stack=[],this.dpr=null!=e?e:1}release(...t){}};u.env="node",u=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],u);var d=i(98116);let c=class extends a.u{constructor(t){super(t)}init(){this._context=new u(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}release(...t){this._nativeCanvas.release&&(0,d.Z)(this._nativeCanvas.release)&&this._nativeCanvas.release()}};c.env="node",c=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],c);let p=(0,i(36444).l)(c,u);var g=i(69493),f=i(35437),m=i(41809),y=i(52650);let _=class extends g.X{get container(){return null}constructor(t){super(),this.global=t,this.type="node"}getTitle(){return""}getWH(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:f.R.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new c(i)}createWindowByCanvas(t){var e;let i=t.canvas,r=null!=(e=t.dpr)?e:1,s=t.width,n=t.height;null!=s&&null!=n&&t.canvasControled||(s=i.width/r,n=i.height/r),this.canvas=new c({width:s,height:n,dpr:r,nativeCanvas:i,canvasControled:t.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}getImageBuffer(t="image/png"){return this.canvas.nativeCanvas.toBuffer(t)}addEventListener(t,e,i){}dispatchEvent(t){return!0}removeEventListener(t,e,i){}getStyle(){}setStyle(t){}getBoundingClientRect(){return null}clearViewBox(t){}};_.env="node",_=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)(),(r=(0,m.f)(n.y2),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],_);let v=new s.n(t=>{t(_).toSelf(),t(y.zd).toDynamicValue(t=>t.container.get(_)).whenTargetNamed(_.env)});var b=i(35238),x=i(37967);let S=class extends b.z{constructor(){super(...arguments),this.type="node",this._lastTime=0,this.supportEvent=!1}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),this.pkg=e)}getDynamicCanvasCount(){return 0}getStaticCanvasCount(){return 999}loadJson(t){let e=fetch(t).then(t=>t.json());return e.then(t=>({data:t,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(t){return fetch(t).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadImage(t){let{loadImage:e}=this.pkg;return e?e(t).then(t=>({loadState:t?"success":"fail",data:t})).catch(()=>({loadState:"fail",data:null})):Promise.reject(Error("node-canvas loadImage could not be found!"))}loadSvg(t){let e=this.pkg.Resvg;if(!e)return Promise.reject(Error("@resvg/resvg-js svgParser could not be found!"));let i=new e(t).render().asPng();return this.loadImage(i)}createCanvas(t){return this.pkg.createCanvas(t.width,t.height)}releaseCanvas(t){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return function(t){return x.dZ.call(t)}}getCancelAnimationFrame(){return t=>{x.dZ.clear(t)}}addEventListener(t,e,i){}removeEventListener(t,e,i){}getElementById(t){return null}getRootElement(){return null}dispatchEvent(t){}release(...t){}createOffscreenCanvas(t){}};S=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)()],S);let k=new s.n(t=>{k.isNodeBound||(k.isNodeBound=!0,t(S).toSelf().inSingletonScope(),t(n.D0).toService(S))});function A(t,e=!0){A.__loaded||(A.__loaded=!0,t.load(k),t.load(p),t.load(v))}k.isNodeBound=!1,A.__loaded=!1},6715:function(t,e,i){"use strict";i.d(e,{o:()=>d});var r=i(41805),s=i(96087),n=i(60557),a=i(21883),l=i.n(a);let o=(t,e)=>{let i=e.x-t.x,r=e.y-t.y;return Math.abs(i)>Math.abs(r)?i>0?"right":"left":r>0?"down":"up"},h=(t,e)=>{let i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return Math.sqrt(i*i+r*r)},u=t=>{let e=t.length;if(1===e)return{x:Math.round(t[0].x),y:Math.round(t[0].y)};let i=0,r=0,s=0;for(;s<e;)i+=t[s].x,r+=t[s].y,s++;return{x:Math.round(i/e),y:Math.round(r/e)}};class d extends l(){constructor(t,e={}){var i,s,n,a,l,d,c,p,g,f;super(),this.cachedEvents=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this.lastTapTarget=null,this.onStart=t=>{this.startTime=r.m.now();let{cachedEvents:e,startPoints:i}=this;t&&e.push(t.clone()),i.length=e.length;for(let t=0;t<e.length;t++){let{x:r,y:s}=e[t],n={x:r,y:s};i[t]=n}if(1!==i.length)this.startDistance=h(i[0],i[1]),this.center=u([i[0],i[1]]);else{let t=e[0];this.pressTimeout=setTimeout(()=>{t.direction="none",t.deltaX=0,t.deltaY=0,t.points=i,this.triggerStartEvent("press",t),this.triggerEvent("press",t),this.eventType="press",this.direction="none",this.pressTimeout=null},this.config.press.time)}},this.onMove=t=>{this.clearPressTimeout();let{startPoints:e,cachedEvents:i}=this;if(!e.length)return;let s=t.clone(),{x:n,y:a,pointerId:l}=s;for(let t=0,e=i.length;t<e;t++)if(l===i[t].pointerId){i[t]=s;break}let u={x:n,y:a},d=i.map(t=>({x:t.x,y:t.y})),c=r.m.now();if(this.prevMoveTime=this.lastMoveTime,this.prevMovePoint=this.lastMovePoint,this.lastMoveTime=c,this.lastMovePoint=u,1===e.length){let t=e[0],i=n-t.x,r=a-t.y,l=this.direction||o(t,u);this.direction=l;let h=this.getEventType(u);return s.direction=l,s.deltaX=i,s.deltaY=r,s.points=d,this.triggerStartEvent(h,s),void this.triggerEvent(h,s)}let{startDistance:p}=this;s.scale=h(d[0],d[1])/p,s.center=this.center,s.points=d,this.triggerStartEvent("pinch",s),this.triggerEvent("pinch",s)},this.onEnd=t=>{let e=t.clone(),{cachedEvents:i,startPoints:s}=this;if(e.points=i.map(t=>({x:t.x,y:t.y})),this.triggerEndEvent(e),1===i.length){let i=r.m.now(),n=this.lastMoveTime;if(i-n<100){let t=n-(this.prevMoveTime||this.startTime);if(t>0){let i=this.prevMovePoint||s[0],r=this.lastMovePoint||s[0],n=h(i,r),a=n/t;if(a>this.config.swipe.velocity&&n>this.config.swipe.threshold)return e.velocity=a,e.direction=o(i,r),this.triggerEvent("swipe",e),this.cachedEvents=[],this.startPoints=[],void this.reset()}}i-this.startTime<this.config.press.time&&(i-this.lastTapTime<this.config.tap.interval&&t.target===this.lastTapTarget?this.tapCount++:this.tapCount=1,this.lastTapTime=i,this.lastTapTarget=t.target,1===this.tapCount?this.triggerEvent("tap",e):2===this.tapCount&&(this.triggerEvent("doubletap",e),this.tapCount=0))}for(let t=0,r=i.length;t<r;t++)if(i[t].pointerId===e.pointerId){i.splice(t,1),s.splice(t,1);break}this.reset(),i.length>0&&this.onStart()},this.element=t,this.tapCount=0,this.lastTapTime=0,this.config={press:{time:null!=(s=null==(i=null==e?void 0:e.press)?void 0:i.time)?s:251,threshold:null!=(a=null==(n=null==e?void 0:e.press)?void 0:n.threshold)?a:9},swipe:{threshold:null!=(d=null==(l=null==e?void 0:e.swipe)?void 0:l.threshold)?d:10,velocity:null!=(p=null==(c=null==e?void 0:e.swipe)?void 0:c.velocity)?p:.3},tap:{interval:null!=(f=null==(g=null==e?void 0:e.tap)?void 0:g.interval)?f:300}},this.initEvents()}initEvents(){let{element:t}=this;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerleave",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}removeEvents(){let{element:t}=this;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerleave",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}release(){this.removeEvents(),this.element=null}getEventType(t){let e,{eventType:i,startTime:s,startPoints:n}=this;return"press"===i?i:(e=r.m.now()-s>this.config.press.time&&h(n[0],t)<this.config.press.threshold?"press":"pan",this.eventType=e,e)}enable(t){this.processEvent[t]=!0}isProcess(t){return this.processEvent[t]}pushEvent(t,e){let{emitThrottles:i}=this,r={type:t,ev:e};for(let e=0,s=i.length;e<s;e++)if(i[e].type===t)return void i.splice(e,1,r);i.push(r)}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}reset(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}triggerEvent(t,e){this.pushEvent(t,e);let{throttleTimer:i,emitThrottles:r}=this;i||(this.throttleTimer=s.w.global.getRequestAnimationFrame()(()=>{s.w.global.getCancelAnimationFrame()(this.throttleTimer),this.throttleTimer=null;for(let t=0,e=r.length;t<e;t++){let{type:e,ev:i}=r[t];this.emitEvent(e,i)}this.emitThrottles.length=0}))}triggerStartEvent(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent(`${t}start`,e))}triggerEndEvent(t){let e=this.processEvent;Object.keys(e).forEach(i=>{this.triggerEvent(`${i}end`,t),"press"===i&&this.triggerEvent(`${i}up`,t),delete e[i]})}emitEvent(t,e){if(!this.element)return;let i=this.element._events[n.g];if(i)if("fn"in i)i.fn.call(i.context,e,t);else for(let r=0,s=i.length;r<s&&!e.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,e,t);this.emit(t,e)}}},23364:function(t,e,i){"use strict";i.d(e,{q:()=>v});var r=i(14364),s=i(85074),n=i(35056),a=i(64067),l=i(17783),o=i(41809),h=i(73209),u=i(55551),d=i(65719),c=i(67653),p=function(t,e){return function(i,r){e(i,r,t)}};let g=class extends n.f{constructor(t,e,i,r){super(i,r),this.contributions=t,this.drawContribution=e,this.pickItemInterceptorContributions=i,this.pickServiceInterceptorContributions=r,this.global.hooks.onSetEnv.tap("canvas-picker-service",(t,e,i)=>{this.configure(i,e)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(t=>{this.pickerMap.set(t.numberType,t)}),super._init()}configure(t,e){this.pickCanvas=a.A.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}pickItem(t,e,i,r){if(!1===t.attribute.pickable)return null;if(this.InterceptorContributions.length)for(let s=0;s<this.InterceptorContributions.length;s++){let n=this.InterceptorContributions[s];if(n.beforePickItem){let s=n.beforePickItem(t,this,e,r,{parentMatrix:i});if(s)return s}}let s=this.pickerMap.get(t.numberType);if(!s)return null;let n=s.contains(t,e,r),a=n?t:null,l={graphic:a,params:n};if(a)return l;if(this.InterceptorContributions.length)for(let s=0;s<this.InterceptorContributions.length;s++){let n=this.InterceptorContributions[s];if(n.afterPickItem){let s=n.afterPickItem(t,this,e,r,{parentMatrix:i});if(s)return s}}return l}};g=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)(),p(0,(0,o.f)(h.Qc)),p(0,(0,u.t)(c.EL)),p(1,(0,o.f)(d.Iv)),p(2,(0,o.f)(h.Qc)),p(2,(0,u.t)(s.uH)),p(3,(0,o.f)(h.Qc)),p(3,(0,u.t)(s.tn)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object,Object,Object])],g);var f=i(27177);let m=class{constructor(){this.type="group",this.numberType=f.I_}contains(t,e,i){return!1}};m=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)()],m);let y=new r.n((t,e,i,r)=>{y.__vloaded||(y.__vloaded=!0,t(c.pE).to(m).inSingletonScope(),t(c.EL).toService(c.pE),(0,h.yb)(t,c.EL))});y.__vloaded=!1;let _=new r.n((t,e,i,r)=>{i(g)||t(g).toSelf().inSingletonScope(),i(s.hH)?r(s.hH).toService(g):t(s.hH).toService(g)});function v(t){t.load(y),t.load(_)}},67217:function(t,e,i){"use strict";i.d(e,{D:()=>n});var r=i(50614),s=i(53627);class n extends r.Y{contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.getGraphicTheme();r.highPerformanceSave();let{x:a,y:l,z:o,lastModelMatrix:h}=this.transform(t,n,r),u=e;if(r.camera){u=e.clone();let i=t.parent.globalTransMatrix;u.x=i.a*e.x+i.c*e.y+i.e,u.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let d=!1;return this.canvasRenderer.drawShape(t,r,a,l,i,null,(t,e,i)=>!!d||(d=t.isPointInPath(u.x,u.y))),this.canvasRenderer.z=0,r.modelMatrix!==h&&s.yp.free(r.modelMatrix),r.modelMatrix=h,r.highPerformanceRestore(),d}}},39468:function(t,e,i){"use strict";i.d(e,{Q:()=>a});var r=i(50614),s=i(29436),n=i(53627);class a extends r.Y{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;r.highPerformanceSave();let a=t.getGraphicTheme(),{x:l,y:o,z:h,lastModelMatrix:u}=this.transform(t,a,r),d=e;if(r.camera){d=e.clone();let i=t.parent.globalTransMatrix;d.x=i.a*e.x+i.c*e.y+i.e,d.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=h;let c=!1;return this.canvasRenderer.drawShape(t,r,l,o,{},null,t=>!!c||(c=t.isPointInPath(d.x,d.y)),(t,e,i)=>{if(c)return!0;let n=e.lineWidth||i.lineWidth,a=e.pickStrokeBuffer||i.pickStrokeBuffer;return r.lineWidth=e.keepStrokeScale||i.keepStrokeScale?n+a:(0,s.D)(r,n+a,r.dpr),c=t.isPointInStroke(d.x,d.y)}),this.canvasRenderer.z=0,r.modelMatrix!==u&&n.yp.free(r.modelMatrix),r.modelMatrix=u,r.highPerformanceRestore(),c}}},21996:function(t,e,i){"use strict";i.d(e,{o:()=>s});var r=i(29436);class s{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode||!this.canvasRenderer)return!0;let{pickContext:s}=null!=i?i:{};if(!s)return!1;let n=t.getGraphicTheme();s.highPerformanceSave();let{x:a=n.x,y:l=n.y}=t.attribute;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);a+=e.x,l+=e.y,s.setTransformForCurrent()}else a=0,l=0,s.transformFromMatrix(t.transMatrix,!0);let o=!1,h=!1;return this.canvasRenderer.drawShape(t,s,a,l,{},null,(t,i,r,s)=>!(!o&&!h)||(o=t.isPointInPath(e.x,e.y),h=s||h,o),(t,i,n,a)=>{if(o||h)return!0;let l=i.lineWidth||n.lineWidth,u=i.pickStrokeBuffer||n.pickStrokeBuffer;return s.lineWidth=i.keepStrokeScale||n.keepStrokeScale?l+u:(0,r.D)(s,l+u,s.dpr),o=t.isPointInStroke(e.x,e.y),h=a||h,o}),s.highPerformanceRestore(),o}}},87431:function(t,e,i){"use strict";i.d(e,{b:()=>h});var r=i(76620),s=i(45273),n=i(31535),a=i(27177),l=i(29436);let o=new r.FB;class h{constructor(){this.type="rect",this.numberType=a._u}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let a=t.getGraphicTheme(),{cornerRadius:h=a.cornerRadius}=t.attribute,{x:u=a.x,y:d=a.y}=t.attribute;r.highPerformanceSave();let c=!0;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(a);u+=e.x,d+=e.y,r.setTransformForCurrent()}else u=0,d=0,c=!1,r.transformFromMatrix(t.transMatrix,!0);let p=!0;if(!c||t.shadowRoot||(0,s.Z)(h,!0)&&0!==h||(0,n.Z)(h)&&h.some(t=>0!==t))p=!1,this.canvasRenderer.drawShape(t,r,u,d,{},null,(t,i,r)=>!!p||(p=t.isPointInPath(e.x,e.y)),(t,i,s)=>{if(p)return!0;let n=i.lineWidth||s.lineWidth,a=i.pickStrokeBuffer||s.pickStrokeBuffer;return r.lineWidth=i.keepStrokeScale||s.keepStrokeScale?n+a:(0,l.D)(r,n+a,r.dpr),p=t.isPointInStroke(e.x,e.y)});else{let{fill:i=a.fill,stroke:r=a.stroke,lineWidth:s=a.lineWidth}=t.attribute;if(i)p=!0;else if(r){let i=t.AABBBounds;o.setValue(i.x1,i.y1,i.x2,i.y2),o.expand(-s/2),p=!o.containsPoint(e)}}return r.highPerformanceRestore(),p}}},67653:function(t,e,i){"use strict";i.d(e,{$Y:()=>n,CV:()=>m,EL:()=>C,ES:()=>v,Ex:()=>h,RC:()=>S,Rz:()=>_,Se:()=>w,Sp:()=>k,TF:()=>x,Uv:()=>g,XN:()=>r,Yr:()=>d,ZY:()=>M,cs:()=>l,e_:()=>f,g2:()=>o,ks:()=>b,nb:()=>u,p1:()=>c,pE:()=>T,t3:()=>s,uV:()=>p,ww:()=>A,xp:()=>a,zT:()=>y});let r=Symbol.for("MathPickerContribution"),s=Symbol.for("MathArcPicker"),n=Symbol.for("MathAreaPicker"),a=Symbol.for("MathCirclePicker"),l=Symbol.for("MathImagePicker"),o=Symbol.for("MathLinePicker"),h=Symbol.for("MathPathPicker"),u=Symbol.for("MathRectPicker"),d=Symbol.for("MathSymbolPicker"),c=Symbol.for("MathTextPicker"),p=Symbol.for("MathPolygonPicker"),g=Symbol.for("MathGlyphPicker"),f=Symbol.for("CanvasArcPicker");Symbol.for("CanvasArc3dPicker");let m=Symbol.for("CanvasAreaPicker"),y=Symbol.for("CanvasCirclePicker"),_=Symbol.for("CanvasImagePicker");Symbol.for("CanvasGifImagePicker");let v=Symbol.for("CanvasLinePicker");Symbol.for("CanvasLottiePicker");let b=Symbol.for("CanvasPathPicker"),x=Symbol.for("CanvasRectPicker");Symbol.for("CanvasRect3dPicker");let S=Symbol.for("CanvasSymbolPicker"),k=Symbol.for("CanvasTextPicker"),A=Symbol.for("CanvasPolygonPicker");Symbol.for("CanvasPyramid3dPicker");let M=Symbol.for("CanvasRichTextPicker"),w=Symbol.for("CanvasGlyphPicker"),T=Symbol.for("CanvasGroupPicker");Symbol.for("CanvasStarPicker");let C=Symbol.for("CanvasPickerContribution")},82421:function(t,e,i){"use strict";i.d(e,{E:()=>p});var r,s=i(14364),n=i(27177),a=i(17783),l=i(41809),o=i(65719),h=i(21996);let u=class extends h.o{constructor(t){super(),this.canvasRenderer=t,this.type="arc",this.numberType=n.r_}};u=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,a.b)(),(r=(0,l.f)(o.Xe),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],u);var d=i(67653);let c=!1,p=new s.n((t,e,i,r)=>{c||(c=!0,t(d.t3).to(u).inSingletonScope(),t(d.XN).toService(d.t3))})},1782:function(t,e,i){"use strict";i.d(e,{P:()=>p});var r,s=i(14364),n=i(67653),a=i(27177),l=i(17783),o=i(41809),h=i(65719),u=i(21996);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="circle",this.numberType=a.Aw}};d=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)(),(r=(0,o.f)(h.aP),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new s.n((t,e,i,r)=>{c||(c=!0,t(n.xp).to(d).inSingletonScope(),t(n.XN).toService(n.xp))})},14526:function(t,e,i){"use strict";i.d(e,{x:()=>l});var r=i(14364),s=i(67653),n=i(98765);let a=!1,l=new r.n((t,e,i,r)=>{a||(a=!0,t(s.cs).to(n.Z).inSingletonScope(),t(n.Z).toService(s.cs))})},98765:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(27177),s=i(17783);let n=class{constructor(){this.type="image",this.numberType=r.PN}contains(t,e,i){let{pickContext:r}=null!=i?i:{};return!!r&&!!t.AABBBounds.containsPoint(e)}};n=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,s.b)()],n)},86298:function(t,e,i){"use strict";i.d(e,{c:()=>p});var r,s=i(14364),n=i(67653),a=i(27177),l=i(17783),o=i(41809),h=i(65719),u=i(21996);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="line",this.numberType=a.Hf}};d=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)(),(r=(0,o.f)(h.O),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new s.n((t,e,i,r)=>{c||(c=!0,t(n.g2).to(d).inSingletonScope(),t(n.XN).toService(n.g2))})},95797:function(t,e,i){"use strict";i.d(e,{t:()=>p});var r,s=i(14364),n=i(67653),a=i(27177),l=i(17783),o=i(41809),h=i(65719),u=i(21996);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="path",this.numberType=a.qm}};d=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)(),(r=(0,o.f)(h.lG),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new s.n((t,e,i,r)=>{c||(c=!0,t(n.Ex).to(d).inSingletonScope(),t(n.XN).toService(n.Ex))})},74403:function(t,e,i){"use strict";i.d(e,{C:()=>p});var r,s=i(14364),n=i(67653),a=i(27177),l=i(17783),o=i(41809),h=i(65719),u=i(21996);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="polygon",this.numberType=a.Kh}};d=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)(),(r=(0,o.f)(h.ZT),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new s.n((t,e,i,r)=>{c||(c=!0,t(n.uV).to(d).inSingletonScope(),t(n.XN).toService(n.uV))})},75639:function(t,e,i){"use strict";i.d(e,{k:()=>c});var r,s=i(14364),n=i(67653),a=i(17783),l=i(41809),o=i(65719),h=i(87431);let u=class extends h.b{constructor(t){super(),this.canvasRenderer=t}};u=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,a.b)(),(r=(0,l.f)(o.Uj),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],u);let d=!1,c=new s.n((t,e,i,r)=>{d||(d=!0,t(n.nb).to(u).inSingletonScope(),t(n.XN).toService(n.nb))})},82727:function(t,e,i){"use strict";i.d(e,{D:()=>l});var r=i(14364),s=i(67653),n=i(98765);let a=!1,l=new r.n((t,e,i,r)=>{a||(a=!0,t(s.cs).to(n.Z).inSingletonScope(),t(n.Z).toService(s.cs))})},88789:function(t,e,i){"use strict";i.d(e,{n:()=>p});var r,s=i(14364),n=i(67653),a=i(27177),l=i(17783),o=i(41809),h=i(65719),u=i(21996);let d=class extends u.o{constructor(t){super(),this.canvasRenderer=t,this.type="symbol",this.numberType=a.B5}};d=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,l.b)(),(r=(0,o.f)(h.tP),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],d);let c=!1,p=new s.n((t,e,i,r)=>{c||(c=!0,t(n.Yr).to(d).inSingletonScope(),t(n.XN).toService(n.Yr))})},35922:function(t,e,i){"use strict";i.d(e,{T:()=>h});var r=i(14364),s=i(67653),n=i(27177),a=i(17783);let l=class{constructor(){this.type="text",this.numberType=n.Us}contains(t,e,i){return!!t.AABBBounds.containsPoint(e)}};l=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,a.b)()],l);let o=!1,h=new r.n((t,e,i,r)=>{o||(o=!0,t(s.p1).to(l).inSingletonScope(),t(s.XN).toService(s.p1))})},52493:function(t,e,i){"use strict";i.d(e,{X:()=>r});let r=(0,i(46710).kP)()},61226:function(t,e,i){"use strict";i.d(e,{x:()=>N});var r,s=i(11971),n=i(20672),a=i(93279),l=i(73209),o=i(14364),h=i(88504),u=i(61868),d=i(17783),c=i(41809),p=i(55551),g=i(46560),f=i(37967),m=i(60738),y=i(74239),_=i(90552),v=i(27177),b=i(50614),x=i(29436),S=i(26036),k=i(33760),A=i(26227);let M=new class{constructor(){this.time=k.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,a,l,o,h,u,d){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{innerPadding:y=o.innerPadding,outerPadding:_=o.outerPadding,startAngle:v=o.startAngle,endAngle:b=o.endAngle,opacity:S=o.opacity,x:k=o.x,y:A=o.y,scaleX:M=o.scaleX,scaleY:w=o.scaleY,keepStrokeScale:T=o.keepStrokeScale}=t.attribute,{innerRadius:C=o.innerRadius,outerRadius:E=o.outerRadius}=t.attribute;E+=_,C-=y;let B=(s,n)=>{let a=!(!s||!s.stroke),{distance:l=o[n].distance}=s,h=T?l:(0,x.D)(e,l,e.dpr),u=l/E,c="outerBorder"===n?1:-1;if(t.setAttributes({outerRadius:E+c*h,innerRadius:C-c*h,startAngle:v-c*u,endAngle:b+c*u}),e.beginPath(),(0,m.Eg)(t,e,i,r,E+c*h,C-c*h),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),d)d(e,s,o[n]);else if(a){let a=o[n].opacity;o[n].opacity=S,e.setStrokeStyle(t,s,(k-i)/M,(A-r)/w,o[n]),o[n].opacity=a,e.stroke()}};g&&B(c,"outerBorder"),f&&B(p,"innerBorder"),t.setAttributes({outerRadius:E,innerRadius:C,startAngle:v,endAngle:b})}},w=A.H,T=S.R6;var C=function(t,e){return function(i,r){e(i,r,t)}};let E=class extends b.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=v.r_,this.builtinContributions=[M,T,w],this.init(t)}drawArcTailCapPath(t,e,i,r,s,n,a,l){let o=l-a,u=t.getParsedAngle(),d=u.startAngle,c=u.endAngle;c=l,(0,h.Wn)(c-d);let p=c>d,g=!1;if(s<n){let t=s;s=n,n=t}let{outerDeltaAngle:f,xors:y,yors:_,xirs:v,yirs:b,limitedOcr:x,outerCornerRadiusStart:S,outerCornerRadiusEnd:k,maxOuterCornerRadius:A,xore:M,yore:w,xire:T,yire:C,limitedIcr:E,innerDeltaAngle:B,innerStartAngle:P,innerCornerRadiusStart:O,innerCornerRadiusEnd:I,maxInnerCornerRadius:R}=(0,m.ZN)(t,d,c,n,s);if(x>h.Ho){let t=(0,h.VV)(S,x),n=(0,h.VV)(k,x),a=(0,m.gI)(v,b,y,_,s,t,Number(p)),l=(0,m.gI)(M,w,T,C,s,n,Number(p));if(x<A&&t===n)e.moveTo(i+a.cx+a.x01,r+a.cy+a.y01),e.arc(i+a.cx,r+a.cy,x,(0,h.fv)(a.y01,a.x01),(0,h.fv)(l.y01,l.x01),!p);else{let t=c-o-.03,a=(0,h.fv)(l.y11,l.x11);e.arc(i,r,s,t,a,!p),n>0&&e.arc(i+l.cx,r+l.cy,n,(0,h.fv)(l.y11,l.x11),(0,h.fv)(l.y01,l.x01),!p)}}else e.moveTo(i+y,r+_);if(!(n>h.Ho)||B<.001)e.lineTo(i+T,r+C),g=!0;else if(E>h.Ho){let t=(0,h.VV)(O,E),s=(0,h.VV)(I,E),a=(0,m.gI)(T,C,M,w,n,-s,Number(p)),l=(0,m.gI)(y,_,v,b,n,-t,Number(p));if(e.lineTo(i+a.cx+a.x01,r+a.cy+a.y01),E<R&&t===s){let t=(0,h.fv)(l.y01,l.x01);e.arc(i+a.cx,r+a.cy,E,(0,h.fv)(a.y01,a.x01),t,!p)}else{s>0&&e.arc(i+a.cx,r+a.cy,s,(0,h.fv)(a.y01,a.x01),(0,h.fv)(a.y11,a.x11),!p);let t=(0,h.fv)(a.cy+a.y11,a.cx+a.x11),l=c-o-.03;e.arc(i,r,n,t,l,p)}}else e.lineTo(i+n*(0,h.mC)(P),r+n*(0,h.O$)(P));return g}drawShape(t,e,i,r,s,n,a,l,o){o=null!=o?o:(0,g.gh)(t,null==n?void 0:n.theme).arc;let{fill:d=o.fill,stroke:c=o.stroke,x:p=o.x,y:_=o.y,fillStrokeOrder:v=o.fillStrokeOrder}=t.attribute,b=this.valid(t,o,a,l);if(!b)return;let{fVisible:x,sVisible:S,doFill:k,doStroke:A}=b,{outerPadding:M=o.outerPadding,innerPadding:w=o.innerPadding,cap:T=o.cap,forceShowCap:C=o.forceShowCap}=t.attribute,{outerRadius:E=o.outerRadius,innerRadius:B=o.innerRadius}=t.attribute;E+=M,B-=w;let P=0,O=((0,u.Z)(T)&&T||T[0])&&"conical"===d.gradient;if(O){let{sc:e,startAngle:i,endAngle:r}=t.getParsedAngle();(0,h.Wn)(r-i)<h.f7-h.Ho&&(P=e||0,d.startAngle-=P,d.endAngle-=P)}let I=!1,{isFullStroke:R,stroke:L}=(0,f.Dn)(c);if((k||R)&&(e.beginPath(),(0,m.Eg)(t,e,i,r,E,B),I=!0,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,k,A,x,S,o,s,a,l),v?(this._runStroke(t,e,i,r,o,A,R,S,l),this._runFill(t,e,i,r,o,k,x,p,_,a)):(this._runFill(t,e,i,r,o,k,x,p,_,a),this._runStroke(t,e,i,r,o,A,R,S,l))),!R&&A&&(e.beginPath(),(0,m.Eg)(t,e,i,r,E,B,L),I||this.beforeRenderStep(t,e,i,r,k,A,x,S,o,s,a,l),l?l(e,t.attribute,o):S&&(e.setStrokeStyle(t,t.attribute,i,r,o),e.stroke())),((0,u.Z)(T)&&T||T[1])&&C){let{startAngle:n,endAngle:u}=t.getParsedAngle();if((0,h.Wn)(u-n)>=h.f7-h.Ho){e.beginPath();let n=Math.abs(E-B)/2/E,{endAngle:h=o.endAngle,fill:u=o.fill}=t.attribute;this.drawArcTailCapPath(t,e,i,r,E,B,h,h+n),I||this.beforeRenderStep(t,e,i,r,k,A,x,S,o,s,a,l),(()=>{if(k&&"conical"===u.gradient){let s=(0,y.MB)(0,0,h,u);a||m.Bv&&(e.setCommonStyle(t,t.attribute,i,r,o),e.fillStyle=s,e.fill())}})(),A&&(l||S&&(e.setStrokeStyle(t,t.attribute,i,r,o),e.stroke()))}}this.afterRenderStep(t,e,i,r,k,A,x,S,o,s,a,l),O&&(d.startAngle+=P,d.endAngle+=P)}_runFill(t,e,i,r,s,n,a,l,o,h){n&&(h?h(e,t.attribute,s):a&&(e.setCommonStyle(t,t.attribute,l-i,o-r,s),e.fill()))}_runStroke(t,e,i,r,s,n,a,l,o){n&&a&&(o||l&&(e.setStrokeStyle(t,t.attribute,i,r,s),e.stroke()))}draw(t,e,i,r){let s=(0,g.gh)(t,null==r?void 0:r.theme).arc;this._draw(t,s,!1,i,r,s)}};E=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,d.b)(),C(0,(0,c.f)(l.Qc)),C(0,(0,p.t)(_.OL)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],E);var B=i(65719);let P=!1,O=new o.n(t=>{P||(P=!0,t(E).toSelf().inSingletonScope(),t(B.Xe).to(E).inSingletonScope(),t(B.uz).toService(B.Xe),t(_.OL).toService(S.Sg),(0,l.yb)(t,_.OL))});var I=i(52493),R=i(21996);let L=class extends R.o{constructor(t){super(),this.canvasRenderer=t,this.type="arc",this.numberType=v.r_}};L=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,d.b)(),(r=(0,c.f)(B.Xe),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],L);var D=i(67653);let F=!1,z=new o.n((t,e,i,r)=>{F||(F=!0,t(D.e_).to(L).inSingletonScope(),t(D.EL).toService(D.e_))});var j=i(82421);function H(){H.__loaded||(H.__loaded=!0,n.i.RegisterGraphicCreator("arc",s.Q),a.n.load(O),a.n.load(I.X?z:j.E))}H.__loaded=!1;let N=H},2316:function(t,e,i){"use strict";i.d(e,{f:()=>D});var r,s=i(21054),n=i(20672),a=i(93279),l=i(73209),o=i(14364),h=i(17783),u=i(41809),d=i(55551),c=i(46560),p=i(27177),g=i(90552),f=i(50614),m=i(29436),y=i(26036),_=i(33760),v=i(26227);let b=new class{constructor(){this.time=_.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,a,l,o,h,u,d){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{radius:y=o.radius,startAngle:_=o.startAngle,endAngle:v=o.endAngle,opacity:b=o.opacity,x:x=o.x,y:S=o.y,scaleX:k=o.scaleX,scaleY:A=o.scaleY,keepStrokeScale:M=o.keepStrokeScale}=t.attribute,w=(s,n)=>{let a=!(!s||!s.stroke),{distance:l=o[n].distance}=s,h=M?l:(0,m.D)(e,l,e.dpr);if(e.beginPath(),e.arc(i,r,y+("outerBorder"===n?1:-1)*h,_,v),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),d)d(e,s,o[n]);else if(a){let a=o[n].opacity;o[n].opacity=b,e.setStrokeStyle(t,s,(x-i)/k,(S-r)/A,o[n]),o[n].opacity=a,e.stroke()}};g&&w(c,"outerBorder"),f&&w(p,"innerBorder")}},x=v.H,S=y.R6;var k=function(t,e){return function(i,r){e(i,r,t)}};let A=class extends f.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=p.Aw,this.builtinContributions=[b,S,x],this.init(t)}drawShape(t,e,i,r,s,n,a,l){let o=(0,c.gh)(t,null==n?void 0:n.theme).circle,{radius:h=o.radius,startAngle:u=o.startAngle,endAngle:d=o.endAngle,x:p=o.x,y:g=o.y,fillStrokeOrder:f=o.fillStrokeOrder}=t.attribute,m=this.valid(t,o,a,l);if(!m)return;let{fVisible:y,sVisible:_,doFill:v,doStroke:b}=m;e.beginPath(),e.arc(i,r,h,u,d),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,v,b,y,_,o,s,a,l);let x=()=>{v&&(a?a(e,t.attribute,o):y&&(e.setCommonStyle(t,t.attribute,p-i,g-r,o),e.fill()))},S=()=>{b&&(l?l(e,t.attribute,o):_&&(e.setStrokeStyle(t,t.attribute,p-i,g-r,o),e.stroke()))};f?(S(),x()):(x(),S()),this.afterRenderStep(t,e,i,r,v,b,y,_,o,s,a,l)}draw(t,e,i,r){let s=(0,c.gh)(t,null==r?void 0:r.theme).circle;this._draw(t,s,!1,i,r)}};A=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,h.b)(),k(0,(0,u.f)(l.Qc)),k(0,(0,d.t)(g.Cs)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],A);var M=i(65719);let w=!1,T=new o.n(t=>{w||(w=!0,t(A).toSelf().inSingletonScope(),t(M.aP).to(A).inSingletonScope(),t(M.uz).toService(M.aP),t(g.Cs).toService(y.Sg),(0,l.yb)(t,g.Cs))});var C=i(52493),E=i(67653),B=i(21996);let P=class extends B.o{constructor(t){super(),this.canvasRenderer=t,this.type="circle",this.numberType=p.Aw}};P=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,h.b)(),(r=(0,u.f)(M.aP),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],P);let O=!1,I=new o.n((t,e,i,r)=>{O||(O=!0,t(E.zT).to(P).inSingletonScope(),t(E.EL).toService(E.zT))});var R=i(1782);function L(){L.__loaded||(L.__loaded=!0,n.i.RegisterGraphicCreator("circle",s.y),a.n.load(T),a.n.load(C.X?I:R.P))}L.__loaded=!1;let D=L},51129:function(t,e,i){"use strict";i.d(e,{M:()=>a});var r=i(53068),s=i(20672);function n(){n.__loaded||(n.__loaded=!0,s.i.RegisterGraphicCreator("group",r.sS))}n.__loaded=!1;let a=n},92875:function(t,e,i){"use strict";i.d(e,{i:()=>H});var r,s=i(19427),n=i(20672),a=i(93279),l=i(73209),o=i(14364),h=i(26036),u=i(90552),d=i(17783),c=i(41809),p=i(55551),g=i(46560),f=i(27177),m=i(31535),y=i(30756),_=i(24806),v=i(50614),b=i(33760),x=i(33359);class S extends x.sH{constructor(){super(...arguments),this.time=b.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,a,l,o,h,u,d){return super.drawShape(t,e,i,r,s,n,a,l,o,h,u,d)}}let k=new S,A=h.R6;var M=i(77502),w=function(t,e){return function(i,r){e(i,r,t)}};let T=["","repeat-x","repeat-y","repeat"],C=class extends v.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=f.PN,this.builtinContributions=[k,A],this.init(t)}drawShape(t,e,i,r,s,n,a,l){let o=(0,g.gh)(t).image,{repeatX:h=o.repeatX,repeatY:u=o.repeatY,x:d=o.x,y:c=o.y,cornerRadius:p=o.cornerRadius,fillStrokeOrder:f=o.fillStrokeOrder,cornerType:y=o.cornerType,image:v}=t.attribute,b=this.valid(t,o,a);if(!b)return;let{fVisible:x,sVisible:S,doFill:k,doStroke:A}=b;if(!v||!t.resources)return;let M=t.resources.get(v);if("success"!==M.state)return;let w=t.width,C=t.height;e.beginPath();let E=!1;0===p||(0,m.Z)(p)&&p.every(t=>0===t)?e.rect(i,r,w,C):((0,_.U)(e,i,r,w,C,p,"bevel"!==y),E=!0),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o);let B=()=>{if(k){if(a)a(e,t.attribute,o);else if(x){e.setCommonStyle(t,t.attribute,i,r,o);let s=0;if("repeat"===h&&(s|=1),"repeat"===u&&(s|=2),s){let t=e.createPattern(M.data,T[s]);e.fillStyle=t,e.translate(i,r,!0),e.fillRect(0,0,w,C),e.translate(-i,-r,!0)}else e.drawImage(M.data,i,r,w,C)}}},P=()=>{A&&(l?l(e,t.attribute,o):S&&(e.setStrokeStyle(t,t.attribute,d-i,c-r,o),e.stroke()))};f?(P(),E&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,r,k,!1,x,!1,o,s,a),B(),E&&e.restore()):(E&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,r,k,!1,x,!1,o,s,a),B(),E&&e.restore(),P()),this.afterRenderStep(t,e,i,r,k,!1,x,!1,o,s,a)}draw(t,e,i){let{image:r}=t.attribute;if(!r||!t.resources)return;let s=t.resources.get(r);if("loading"===s.state&&(0,y.Z)(r))return void M.h.improveImageLoading(r);if("success"!==s.state)return;let{context:n}=e.drawParams;if(!n)return;let a=(0,g.gh)(t).image;this._draw(t,a,!1,i)}};C=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,d.b)(),w(0,(0,c.f)(l.Qc)),w(0,(0,p.t)(u.JO)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],C);var E=i(65719);let B=!1,P=new o.n(t=>{B||(B=!0,t(E.e0).to(C).inSingletonScope(),t(E.uz).toService(E.e0),t(u.JO).toService(h.Sg),(0,l.yb)(t,u.JO))});var O=i(52493),I=i(67653),R=i(21996);let L=class extends R.o{constructor(t){super(),this.canvasRenderer=t,this.type="image",this.numberType=f.PN}};L=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,d.b)(),(r=(0,c.f)(E.e0),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],L);let D=!1,F=new o.n((t,e,i,r)=>{D||(D=!0,t(I.Rz).to(L).inSingletonScope(),t(I.EL).toService(I.Rz))});var z=i(14526);function j(){j.__loaded||(j.__loaded=!0,n.i.RegisterGraphicCreator("image",s.B),a.n.load(P),a.n.load(O.X?F:z.x))}j.__loaded=!1;let H=j},89255:function(t,e,i){"use strict";i.d(e,{N:()=>A});var r,s=i(73208),n=i(20672),a=i(93279),l=i(14364),o=i(19721),h=i(88580),u=i(65719);let d=!1,c=new l.n(t=>{d||(d=!0,t(h.X).toSelf().inSingletonScope(),t(o.U).toSelf().inSingletonScope(),t(u.O).to(h.X).inSingletonScope(),t(u.uz).toService(u.O))});var p=i(52493),g=i(67653),f=i(27177),m=i(17783),y=i(41809),_=i(39468);let v=class extends _.Q{constructor(t){super(),this.canvasRenderer=t,this.type="line",this.numberType=f.Hf}};v=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,m.b)(),(r=(0,y.f)(u.O),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],v);let b=!1,x=new l.n((t,e,i,r)=>{b||(b=!0,t(g.ES).to(v).inSingletonScope(),t(g.EL).toService(g.ES))});var S=i(86298);function k(){k.__loaded||(k.__loaded=!0,n.i.RegisterGraphicCreator("line",s.W),a.n.load(c),a.n.load(p.X?x:S.c))}k.__loaded=!1;let A=k},81428:function(t,e,i){"use strict";i.d(e,{N:()=>I});var r,s=i(88110),n=i(20672),a=i(93279),l=i(73209),o=i(14364),h=i(26036),u=i(90552),d=i(17783),c=i(41809),p=i(55551),g=i(60027),f=i(46560),m=i(27177),y=i(50614);let _=i(26227).H,v=h.R6;var b=function(t,e){return function(i,r){e(i,r,t)}};let x=class extends y.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=m.qm,this.builtinContributions=[v,_],this.init(t)}drawShape(t,e,i,r,s,n,a,l){var o,h,u;let d=null!=(o=this.tempTheme)?o:(0,f.gh)(t,null==n?void 0:n.theme).path,{x:c=d.x,y:p=d.y,fillStrokeOrder:m=d.fillStrokeOrder}=t.attribute,y=null!=(h=this.z)?h:0,_=this.valid(t,d,a,l);if(!_)return;let{fVisible:v,sVisible:b,doFill:x,doStroke:S}=_;if(e.beginPath(),t.pathShape)(0,g.h)(t.pathShape.commandList,e,i,r,1,1,y);else{let s=null!=(u=t.attribute.path)?u:d.path;(0,g.h)(s.commandList,e,i,r,1,1,y)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,r,x,S,v,b,d,s,a,l);let k=()=>{S&&(l?l(e,t.attribute,d):b&&(e.setStrokeStyle(t,t.attribute,c-i,p-r,d),e.stroke()))},A=()=>{x&&(a?a(e,t.attribute,d):v&&(e.setCommonStyle(t,t.attribute,c-i,p-r,d),e.fill()))};m?(k(),A()):(A(),k()),this.afterRenderStep(t,e,i,r,x,S,v,b,d,s,a,l)}draw(t,e,i,r){let s=(0,f.gh)(t,null==r?void 0:r.theme).path;this.tempTheme=s,this._draw(t,s,!1,i,r),this.tempTheme=null}};x=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,d.b)(),b(0,(0,c.f)(l.Qc)),b(0,(0,p.t)(u.Mj)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],x);var S=i(65719);let k=!1,A=new o.n(t=>{k||(k=!0,t(x).toSelf().inSingletonScope(),t(S.lG).to(x).inSingletonScope(),t(S.uz).toService(S.lG),t(u.Mj).toService(h.Sg),(0,l.yb)(t,u.Mj))});var M=i(52493),w=i(67653),T=i(39468);let C=class extends T.Q{constructor(t){super(),this.canvasRenderer=t,this.type="path",this.numberType=m.qm}};C=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,d.b)(),(r=(0,c.f)(S.lG),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],C);let E=!1,B=new o.n((t,e,i,r)=>{E||(E=!0,t(w.ks).to(C).inSingletonScope(),t(w.EL).toService(w.ks))});var P=i(95797);function O(){O.__loaded||(O.__loaded=!0,n.i.RegisterGraphicCreator("path",s.E),a.n.load(A),a.n.load(M.X?B:P.t))}O.__loaded=!1;let I=O},89705:function(t,e,i){"use strict";i.d(e,{M:()=>D});var r,s=i(50730),n=i(20672),a=i(93279),l=i(73209),o=i(14364),h=i(26036),u=i(90552),d=i(31535),c=i(17783),p=i(41809),g=i(55551),f=i(46560),m=i(27177);function y(t,e,i,r){if(e&&e.length){t.moveTo(e[0].x+i,e[0].y+r);for(let s=1;s<e.length;s++)t.lineTo(e[s].x+i,e[s].y+r)}}function _(t,e){return Math.sqrt(t*t+e*e)}function v(t,e,i,r,s){let n=e/i;return{x:t.x-r*n,y:t.y-s*n}}var b=i(50614);let x=i(26227).H,S=h.R6;var k=function(t,e){return function(i,r){e(i,r,t)}};let A=class extends b.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=m.Kh,this.builtinContributions=[S,x],this.init(t)}drawShape(t,e,i,r,s,n,a,l){let o=(0,f.gh)(t,null==n?void 0:n.theme).polygon,{points:h=o.points,cornerRadius:u=o.cornerRadius,x:c=o.x,y:p=o.y,closePath:g=o.closePath,fillStrokeOrder:m=o.fillStrokeOrder}=t.attribute,b=this.valid(t,o,a,l);if(!b)return;let{fVisible:x,sVisible:S,doFill:k,doStroke:A}=b;e.beginPath(),u<=0||(0,d.Z)(u)&&u.every(t=>0===t)?y(e.camera?e:e.nativeContext,h,i,r):function(t,e,i,r,s,n=!0){var a;if(e.length<3)return y(t,e,i,r);let l=0,o=e.length-1;n||(l+=1,o-=1,t.moveTo(e[0].x+i,e[0].y+r));for(let n=l;n<=o;n++){let l=e[0===n?o:(n-1)%e.length],h=e[n%e.length],u=e[(n+1)%e.length],d=h.x-l.x,c=h.y-l.y,p=h.x-u.x,g=h.y-u.y,f=Math.abs(Math.tan((Math.atan2(c,d)-Math.atan2(g,p))/2)),m=Array.isArray(s)?null!=(a=s[n%e.length])?a:0:s,y=m/f,b=_(d,c),x=_(p,g),S=Math.min(b,x);y>S&&(y=S,m=S*f);let k=v(h,y,b,d,c),A=v(h,y,x,p,g),M=2*h.x-k.x-A.x,w=2*h.y-k.y-A.y,T=_(M,w),C=v(h,_(y,m),T,M,w),E=Math.atan2(k.y-C.y,k.x-C.x),B=Math.atan2(A.y-C.y,A.x-C.x),P=B-E;P<0&&(E=B,P=-P),P>Math.PI&&(P-=Math.PI),0===n?t.moveTo(k.x+i,k.y+r):t.lineTo(k.x+i,k.y+r),P&&t.arcTo(h.x+i,h.y+r,A.x+i,A.y+r,m),t.lineTo(A.x+i,A.y+r)}n||t.lineTo(e[o+1].x+i,e[o+1].y+r)}(e.camera?e:e.nativeContext,h,i,r,u,g),g&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,k,A,x,S,o,s,a,l);let M=()=>{k&&(a?a(e,t.attribute,o):x&&(e.setCommonStyle(t,t.attribute,c-i,p-r,o),e.fill()))},w=()=>{A&&(l?l(e,t.attribute,o):S&&(e.setStrokeStyle(t,t.attribute,c-i,p-r,o),e.stroke()))};m?(w(),M()):(M(),w()),this.afterRenderStep(t,e,i,r,k,A,x,S,o,s,a,l)}draw(t,e,i,r){let s=(0,f.gh)(t,null==r?void 0:r.theme).polygon;this._draw(t,s,!1,i,r)}};A=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,c.b)(),k(0,(0,p.f)(l.Qc)),k(0,(0,g.t)(u.U7)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],A);var M=i(65719);let w=!1,T=new o.n(t=>{w||(w=!0,t(M.ZT).to(A).inSingletonScope(),t(M.uz).toService(M.ZT),t(u.U7).toService(h.Sg),(0,l.yb)(t,u.U7))});var C=i(52493),E=i(67653),B=i(21996);let P=class extends B.o{constructor(t){super(),this.canvasRenderer=t,this.type="polygon",this.numberType=m.Kh}};P=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,c.b)(),(r=(0,p.f)(M.ZT),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],P);let O=!1,I=new o.n((t,e,i,r)=>{O||(O=!0,t(E.ww).to(P).inSingletonScope(),t(E.EL).toService(E.ww))});var R=i(74403);function L(){L.__loaded||(L.__loaded=!0,n.i.RegisterGraphicCreator("polygon",s.p),a.n.load(T),a.n.load(C.X?I:R.C))}L.__loaded=!1;let D=L},29624:function(t,e,i){"use strict";i.d(e,{k:()=>R});var r,s=i(28651),n=i(20672),a=i(93279),l=i(73209),o=i(14364),h=i(33359),u=i(26036),d=i(90552),c=i(31535),p=i(17783),g=i(41809),f=i(55551),m=i(46560),y=i(27177),_=i(24806),v=i(60738),b=i(50614),x=function(t,e){return function(i,r){e(i,r,t)}};let S=class extends b.Y{constructor(t){super(),this.graphicRenderContributions=t,this.type="rect",this.numberType=y._u,this.builtinContributions=[h.NB,h.gq,h.k7],this.init(t)}drawShape(t,e,i,r,s,n,a,l,o){o=null!=o?o:(0,m.gh)(t,null==n?void 0:n.theme).rect;let{fill:h=o.fill,background:u,stroke:d=o.stroke,cornerRadius:p=o.cornerRadius,cornerType:g=o.cornerType,opacity:f=o.opacity,fillOpacity:y=o.fillOpacity,lineWidth:b=o.lineWidth,strokeOpacity:x=o.strokeOpacity,visible:S=o.visible,x1:k,y1:A,x:M=o.x,y:w=o.y,fillStrokeOrder:T=o.fillStrokeOrder}=t.attribute,{width:C,height:E}=t.attribute;C=(null!=C?C:k-M)||0,E=(null!=E?E:A-w)||0;let B=(0,v.GT)(f,y,C,E,h),P=(0,v.Ze)(f,x,C,E),O=(0,v.dz)(h,u),I=(0,v.ak)(d,b);if(!t.valid||!S||!O&&!I||!(B||P||a||l||u))return;0===p||(0,c.Z)(p)&&p.every(t=>0===t)?(e.beginPath(),e.rect(i,r,C,E)):(e.beginPath(),(0,_.U)(e,i,r,C,E,p,"bevel"!==g));let R={doFill:O,doStroke:I};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,O,I,B,P,o,s,a,l,R),T?(this._runStroke(t,e,i,r,o,R,P,M,w,l),this._runFill(t,e,i,r,o,R,B,M,w,a)):(this._runFill(t,e,i,r,o,R,B,M,w,a),this._runStroke(t,e,i,r,o,R,P,M,w,l)),this.afterRenderStep(t,e,i,r,O,I,B,P,o,s,a,l)}_runFill(t,e,i,r,s,n,a,l,o,h){n.doFill&&(h?h(e,t.attribute,s):a&&(e.setCommonStyle(t,t.attribute,l-i,o-r,s),e.fill()))}_runStroke(t,e,i,r,s,n,a,l,o,h){n.doStroke&&(h?h(e,t.attribute,s):a&&(e.setStrokeStyle(t,t.attribute,l-i,o-r,s),e.stroke()))}draw(t,e,i,r){let s=(0,m.gh)(t,null==r?void 0:r.theme).rect;this._draw(t,s,!1,i,r,s)}};S=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,p.b)(),x(0,(0,g.f)(l.Qc)),x(0,(0,f.t)(d.d5)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],S);var k=i(65719);let A=!1,M=new o.n(t=>{A||(A=!0,t(S).toSelf().inSingletonScope(),t(k.Uj).to(S).inSingletonScope(),t(k.uz).toService(k.Uj),t(h.Er).toSelf(),t(h.d4).toSelf(),t(d.d5).toService(h.Er),t(d.d5).toService(h.d4),t(d.d5).toService(u.Sg),(0,l.yb)(t,d.d5))});var w=i(52493),T=i(67653),C=i(87431);let E=class extends C.b{constructor(t){super(),this.canvasRenderer=t}};E=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,p.b)(),(r=(0,g.f)(k.Uj),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],E);let B=!1,P=new o.n((t,e,i,r)=>{B||(B=!0,t(T.TF).to(E).inSingletonScope(),t(T.EL).toService(T.TF))});var O=i(75639);function I(){I.__loaded||(I.__loaded=!0,n.i.RegisterGraphicCreator("rect",s.f),a.n.load(M),a.n.load(w.X?P:O.k))}I.__loaded=!1;let R=I},80523:function(t,e,i){"use strict";i.d(e,{v:()=>T});var r,s=i(93342),n=i(20672),a=i(93279),l=i(14364),o=i(17783),h=i(24806),u=i(46560),d=i(27177),c=i(60738),p=i(50614),g=i(3783);let f=class extends p.Y{constructor(){super(),this.numberType=d.$M,this.builtinContributions=[g.C],this.init()}drawShape(t,e,i,r,s){let n=(0,u.gh)(t).richtext,{strokeOpacity:a=n.strokeOpacity,opacity:l=n.opacity,fillOpacity:o=n.fillOpacity,visible:h=n.visible}=t.attribute;if(!t.valid||!h)return;let d=(0,c.Bv)(l,o,!0),p=(0,c.Bv)(l,a,!0);d&&(e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,n),e.translate(i,r),this.beforeRenderStep(t,e,i,r,d,p,d,p,n,s),t.getFrameCache().draw(e,this.drawIcon),this.afterRenderStep(t,e,i,r,d,p,d,p,n,s))}drawIcon(t,e,i,r,s){var n;let a=(0,u.gh)(t).richtextIcon,{width:l=a.width,height:o=a.height,opacity:d=a.opacity,image:c,backgroundFill:p=a.backgroundFill,backgroundFillOpacity:g=a.backgroundFillOpacity,backgroundStroke:f=a.backgroundStroke,backgroundStrokeOpacity:m=a.backgroundStrokeOpacity,backgroundRadius:y=a.backgroundRadius,margin:_}=t.attribute,{backgroundWidth:v=l,backgroundHeight:b=o}=t.attribute;if(_&&(i+=t._marginArray[3],r+=t._marginArray[0]),t._hovered){let t=(v-l)/2,s=(b-o)/2;0===y?(e.beginPath(),e.rect(i-t,r-s,v,b)):(e.beginPath(),(0,h.U)(e,i-t,r-s,v,b,y,!0)),p&&(e.globalAlpha=g,e.fillStyle=p,e.fill()),f&&(e.globalAlpha=m,e.strokeStyle=f,e.stroke())}let x=c&&(null==(n=null==t?void 0:t.resources)?void 0:n.get(c));x&&"success"===x.state&&(e.globalAlpha=d,e.drawImage(x.data,i,r,l,o))}draw(t,e,i){let r=(0,u.gh)(t).richtext;this._draw(t,r,!1,i)}};f=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,o.b)(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],f);var m=i(65719);let y=!1,_=new l.n(t=>{y||(y=!0,t(m.fS).to(f).inSingletonScope(),t(m.uz).toService(m.fS))});var v=i(52493),b=i(67653),x=i(41809);let S=class{constructor(t){this.canvasRenderer=t,this.type="richtext",this.numberType=d.$M}contains(t,e,i){return!!t.AABBBounds.containsPoint(e)}};S=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,o.b)(),(r=(0,x.f)(m.fS),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],S);let k=!1,A=new l.n((t,e,i,r)=>{k||(k=!0,t(b.ZY).to(S).inSingletonScope(),t(b.EL).toService(b.ZY))});var M=i(82727);function w(){w.__loaded||(w.__loaded=!0,n.i.RegisterGraphicCreator("richtext",s.p),a.n.load(_),a.n.load(v.X?A:M.D))}w.__loaded=!1;let T=w},43617:function(t,e,i){"use strict";i.d(e,{W:()=>o});var r=i(53068);class s extends r.ZA{constructor(t){super({x:0,y:0}),this.type="shadowroot",this.shadowHost=t}clearUpdateBoundTag(){super.clearUpdateBoundTag(),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}addUpdateBoundTag(){super.addUpdateBoundTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}addUpdateShapeAndBoundsTag(){super.addUpdateShapeAndBoundsTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){let e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}doUpdateGlobalMatrix(){if(this.shadowHost){let t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}tryUpdateGlobalAABBBounds(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}function n(t){return new s(t)}var a=i(20672);function l(){l.__loaded||(l.__loaded=!0,a.i.RegisterGraphicCreator("shadowRoot",n))}l.__loaded=!1;let o=l},91015:function(t,e,i){"use strict";i.d(e,{k:()=>j});var r,s=i(14861),n=i(20672),a=i(93279),l=i(73209),o=i(14364),h=i(26036),u=i(90552),d=i(65719),c=i(17783),p=i(41809),g=i(55551),f=i(46560),m=i(27177),y=i(50614),_=i(31535),v=i(29436),b=i(33760),x=i(26227);let S=new class{constructor(){this.time=b.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,a,l,o,h,u,d){let c=t.getParsedPath();if(!c)return;let{outerBorder:p,innerBorder:g}=t.attribute,f=p&&!1!==p.visible,m=g&&!1!==g.visible;if(!f&&!m)return;let{size:y=o.size,opacity:_=o.opacity,x:b=o.x,y:x=o.y,scaleX:S=o.scaleX,scaleY:k=o.scaleY,keepStrokeScale:A=o.keepStrokeScale}=t.attribute,M=(s,n)=>{let a=!(!s||!s.stroke),{distance:l=o[n].distance}=s,h=A?l:(0,v.D)(e,l,e.dpr);if(e.beginPath(),!1===c.drawOffset(e,y,i,r,("outerBorder"===n?1:-1)*h)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),d)d(e,s,o[n]);else if(a){let a=o[n].opacity;o[n].opacity=_,e.setStrokeStyle(t,s,(b-i)/S,(x-r)/k,o[n]),o[n].opacity=a,e.stroke()}};f&&M(p,"outerBorder"),m&&M(g,"innerBorder")}},k=new class{constructor(){this.time=b.Oh.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,s,n,a,l,o,h,u,d,c){let{clipRange:p=o.clipRange,x:g=o.x,y:f=o.y,z:m=o.z,size:y=o.size,scaleX:_=o.scaleX,scaleY:v=o.scaleY}=t.attribute,b=t.getParsedPath();b&&p<1&&p>0&&(e.beginPath(),b.drawWithClipRange&&b.drawWithClipRange(e,y,i,r,p,m,(s,n)=>{var a,h,u,c;if(t._parsedPath.svgCache){let e=Object.assign({},n);e.fill=null!=(a=n.fill)?a:t.attribute.fill,e.opacity=null!=(h=n.opacity)?h:t.attribute.opacity,e.fillOpacity=t.attribute.fillOpacity,e.stroke=null!=(u=n.stroke)?u:t.attribute.stroke,e.lineWidth=null!=(c=n.lineWidth)?c:t.attribute.lineWidth,n=e}n.stroke&&(d?d(e,t.attribute,o):l&&(e.setStrokeStyle(t,n,(g-i)/_,(f-r)/v,o),e.stroke()))}),n&&!b.isSvg&&(d?d(e,t.attribute,o):l&&(e.setStrokeStyle(t,t.attribute,(g-i)/_,(f-r)/v,o),e.stroke())))}},A=x.H,M=h.R6;var w=function(t,e){return function(i,r){e(i,r,t)}};let T=class extends y.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=m.B5,this.builtinContributions=[S,M,A,k],this.init(t)}drawShape(t,e,i,r,s,n,a,l,o){var h;o=null!=o?o:(0,f.gh)(t,null==n?void 0:n.theme).symbol;let{size:u=o.size,x:d=o.x,y:c=o.y,scaleX:p=o.scaleX,scaleY:g=o.scaleY,fillStrokeOrder:m=o.fillStrokeOrder,clipRange:y=o.clipRange}=t.attribute,v=this.valid(t,o,a,l);if(!v)return;let{fVisible:b,sVisible:x,doFill:S,doStroke:k}=v,A=t.getParsedPath();if(!A)return;let{keepDirIn3d:M=o.keepDirIn3d}=t.attribute,w=null!=(h=this.z)?h:0;e.beginPath();let T=i,C=r,E=w,B=e.camera;if(M&&B&&e.project){let t=e.project(i,r,w);e.camera=null,(0,_.Z)(u)&&(u[0],u[1]),T=t.x,C=t.y,E=void 0}!1===A.draw(e,u,T,C,E,(s,n)=>{var h,u,f,_;if(t._parsedPath.svgCache){let e=Object.assign({},n);e.fill=null!=(h=n.fill)?h:t.attribute.fill,e.opacity=null!=(u=n.opacity)?u:t.attribute.opacity,e.fillOpacity=t.attribute.fillOpacity,e.stroke=null!=(f=n.stroke)?f:t.attribute.stroke,e.lineWidth=null!=(_=n.lineWidth)?_:t.attribute.lineWidth,n=e}let v=()=>{n.fill&&(a?a(e,t.attribute,o):(e.setCommonStyle(t,n,d-i,c-r,o),e.fill()))},b=()=>{n.stroke&&(l?l(e,t.attribute,o):x&&y>=1&&(e.setStrokeStyle(t,n,(d-i)/p,(c-r)/g,o),e.stroke()))};m?(b(),v()):(v(),b())})&&e.closePath(),e.camera=B,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,o),this.beforeRenderStep(t,e,i,r,S,k,b,x,o,s,a,l),m?(this._runStroke(t,e,i,r,o,k,x,d,c,A,y,p,g,l),this._runFill(t,e,i,r,o,S,b,d,c,A,a)):(this._runFill(t,e,i,r,o,S,b,d,c,A,a),this._runStroke(t,e,i,r,o,k,x,d,c,A,y,p,g,l)),this.afterRenderStep(t,e,i,r,S,k,b,x,o,s,a,l)}_runFill(t,e,i,r,s,n,a,l,o,h,u){n&&!h.isSvg&&(u?u(e,t.attribute,s):a&&(e.setCommonStyle(t,t.attribute,l-i,o-r,s),e.fill()))}_runStroke(t,e,i,r,s,n,a,l,o,h,u,d,c,p){n&&!h.isSvg&&(p?p(e,t.attribute,s):a&&u>=1&&(e.setStrokeStyle(t,t.attribute,(l-i)/d,(o-r)/c,s),e.stroke()))}draw(t,e,i,r){let s=(0,f.gh)(t,null==r?void 0:r.theme).symbol;this._draw(t,s,!1,i,r)}};T=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,c.b)(),w(0,(0,p.f)(l.Qc)),w(0,(0,g.t)(u.X3)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],T);let C=!1,E=new o.n(t=>{C||(C=!0,t(T).toSelf().inSingletonScope(),t(d.tP).to(T).inSingletonScope(),t(d.uz).toService(d.tP),t(u.X3).toService(h.Sg),(0,l.yb)(t,u.X3))});var B=i(52493),P=i(67653),O=i(53627),I=i(67217);let R=class extends I.D{constructor(t){super(),this.canvasRenderer=t,this.type="symbol",this.numberType=m.B5}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let s=t.getParsedPath();if(!r.camera){if(!t.AABBBounds.containsPoint(e))return!1;if(s.isSvg||"imprecise"===t.attribute.pickMode)return!0}r.highPerformanceSave();let n=t.getGraphicTheme(),{x:a,y:l,z:o,lastModelMatrix:h}=this.transform(t,n,r),u=e;if(r.camera){u=e.clone();let i=t.parent.globalTransMatrix;u.x=i.a*e.x+i.c*e.y+i.e,u.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let d=!1;return this.canvasRenderer.drawShape(t,r,a,l,{},null,(t,e,i)=>!!d||(d=t.isPointInPath(u.x,u.y)),(t,e,i)=>{if(d)return!0;let s=e.lineWidth||i.lineWidth,n=e.pickStrokeBuffer||i.pickStrokeBuffer;return r.lineWidth=e.keepStrokeScale||i.keepStrokeScale?s+n:(0,v.D)(r,s+n,r.dpr),d=t.isPointInStroke(u.x,u.y)}),this.canvasRenderer.z=0,r.modelMatrix!==h&&O.yp.free(r.modelMatrix),r.modelMatrix=h,r.highPerformanceRestore(),d}};R=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,c.b)(),(r=(0,p.f)(d.tP),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],R);let L=!1,D=new o.n((t,e,i,r)=>{L||(L=!0,t(P.RC).to(R).inSingletonScope(),t(P.EL).toService(P.RC))});var F=i(88789);function z(){z.__loaded||(z.__loaded=!0,n.i.RegisterGraphicCreator("symbol",s.t),a.n.load(E),a.n.load(B.X?D:F.n))}z.__loaded=!1;let j=z},23112:function(t,e,i){"use strict";i.d(e,{g:()=>D});var r,s=i(29411),n=i(20672),a=i(93279),l=i(73209),o=i(14364),h=i(26036),u=i(90552),d=i(65719),c=i(17783),p=i(41809),g=i(55551),f=i(46560),m=i(27177),y=i(58539),_=i(50614),v=i(53627),b=i(88504),x=i(35652),S=i(37967),k=i(3783),A=function(t,e){return function(i,r){e(i,r,t)}};let M=class extends _.Y{constructor(t){super(),this.graphicRenderContributions=t,this.numberType=m.Us,this.builtinContributions=[k.C],this.init(t)}drawShape(t,e,i,r,s,n,a,l){var o,h,u;let d=(0,f.gh)(t,null==n?void 0:n.theme).text,{text:c,underline:p=d.underline,lineThrough:g=d.lineThrough,keepDirIn3d:m=d.keepDirIn3d,direction:y=d.direction,fontSize:_=d.fontSize,verticalMode:x=d.verticalMode,x:k=d.x,y:A=d.y}=t.attribute,M=null!=(o=(0,S.VA)(t.attribute.lineHeight,_))?o:_,w=this.valid(t,d,a,l);if(!w)return;let{fVisible:T,sVisible:C,doFill:E,doStroke:B}=w,P=!m,O=this.z||0;e.beginPath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,r,E,B,T,C,d,s,a,l),P&&this.transformUseContext2d(t,d,O,e);let I=(s,n,o,h)=>{let u=i+n,c=r+o;if(h){e.highPerformanceSave(),u+=_;let t=v.QE.allocate(1,0,0,1,0,0);t.rotateByCenter(Math.PI/2,u,c),e.transformFromMatrix(t,!0),v.QE.free(t)}B&&(l?l(e,t.attribute,d):C&&(e.setStrokeStyle(t,t.attribute,k-i,A-r,d),e.strokeText(s,u,c,O))),E&&(a?a(e,t.attribute,d):T&&(e.setCommonStyle(t,t.attribute,k-i,A-r,d),e.fillText(s,u,c,O))),h&&(e.highPerformanceRestore(),e.setTransformForCurrent())};if(e.setTextStyleWithoutAlignBaseline(t.attribute,d,O),"horizontal"===y){let{multilineLayout:s}=t;if(!s)return void e.highPerformanceRestore();let{xOffset:n,yOffset:o}=s.bbox;B&&(l?l(e,t.attribute,d):C&&(e.setStrokeStyle(t,t.attribute,k-i,A-r,d),s.lines.forEach(t=>{e.strokeText(t.str,(t.leftOffset||0)+n+i,(t.topOffset||0)+o+r,O)}))),E&&(a?a(e,t.attribute,d):T&&(e.setCommonStyle(t,t.attribute,k-i,A-r,d),s.lines.forEach(s=>{e.fillText(s.str,(s.leftOffset||0)+n+i,(s.topOffset||0)+o+r,O),this.drawUnderLine(p,g,t,(s.leftOffset||0)+n+i,(s.topOffset||0)+o+r,s.descent,(s.descent-s.ascent)/2,O,d,e,{width:s.width})})))}else{let{textAlign:i=d.textAlign,textBaseline:r=d.textBaseline}=t.attribute;if(!x){let e=i;i=null!=(h=t.getBaselineMapAlign()[r])?h:"left",r=null!=(u=t.getAlignMapBaseline()[e])?u:"top"}t.tryUpdateAABBBounds();let{verticalList:s}=t.cache;e.textAlign="left",e.textBaseline="top";let n=M*s.length,a=0;s.forEach(t=>{let e=t.reduce((t,e)=>t+(e.width||0),0);a=(0,b.Fp)(e,a)});let l=0,o=0;"bottom"===r?o=-n:"middle"===r&&(o=-n/2),"center"===i?l-=a/2:"right"===i&&(l-=a),s.forEach((t,e)=>{let r=t.reduce((t,e)=>t+(e.width||0),0),s=a-r,h=l;"center"===i?h+=s/2:"right"===i&&(h+=s),t.forEach(t=>{let{text:i,width:r,direction:s}=t;I(i,n-(e+1)*M+o,h,s),h+=r})})}P&&this.restoreTransformUseContext2d(t,d,O,e),this.afterRenderStep(t,e,i,r,E,B,T,C,d,s,a,l)}draw(t,e,i,r){let s=(0,f.gh)(t,null==r?void 0:r.theme).text,{keepDirIn3d:n=s.keepDirIn3d}=t.attribute;this._draw(t,s,!n,i,r)}drawUnderLine(t,e,i,r,s,n,a,l,o,h,u){if(e+t<=0)return;let{textAlign:d=o.textAlign,fill:c=o.fill,opacity:p=o.opacity,underlineOffset:g=o.underlineOffset,underlineDash:f=o.underlineDash,fillOpacity:m=o.fillOpacity}=i.attribute,_=!(0,x.Z)(u),v=_?u.width:i.clipedWidth,b=_?0:(0,y.js)(d,v),S={lineWidth:0,stroke:c,opacity:p,strokeOpacity:m};if(t){S.lineWidth=t,h.setStrokeStyle(i,S,r,s,o),f&&h.setLineDash(f),h.beginPath();let e=s+n+g;h.moveTo(r+b,e,l),h.lineTo(r+b+v,e,l),h.stroke()}if(e){S.lineWidth=e,h.setStrokeStyle(i,S,r,s,o),h.beginPath();let t=s+a;h.moveTo(r+b,t,l),h.lineTo(r+b+v,t,l),h.stroke()}}};M=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,c.b)(),A(0,(0,p.f)(l.Qc)),A(0,(0,g.t)(u.$K)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],M);let w=!1,T=new o.n(t=>{w||(w=!0,t(d.EY).to(M).inSingletonScope(),t(d.uz).toService(d.EY),t(u.$K).toService(h.Sg),(0,l.yb)(t,u.$K))});var C=i(52493),E=i(67653),B=i(67217);let P=class extends B.D{constructor(t){super(),this.canvasRenderer=t,this.type="text",this.numberType=m.Us}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let s=t.AABBBounds;if(!r.camera)return!!s.containsPoint(e);r.highPerformanceSave();let n=t.getGraphicTheme(),{keepDirIn3d:a=n.keepDirIn3d}=t.attribute,{x:l,y:o,z:h,lastModelMatrix:u}=this.transform(t,n,r,!a);this.canvasRenderer.z=h;let d=e;if(r.camera){d=e.clone();let i=t.parent.globalTransMatrix;d.x=i.a*e.x+i.c*e.y+i.e,d.y=i.b*e.x+i.d*e.y+i.f}let c=!1;return this.canvasRenderer.drawShape(t,r,l,o,{},null,(e,i,r)=>{if(c)return!0;let{fontSize:s=n.fontSize,textBaseline:a=n.textBaseline,textAlign:u=n.textAlign}=t.attribute,p=t.AABBBounds,g=p.height(),f=p.width(),m=(0,y.nV)(a,g,s),_=(0,y.js)(u,f);return e.rect(_+l,m+o,f,g,h),c=e.isPointInPath(d.x,d.y)},(t,e,i)=>c),this.canvasRenderer.z=0,r.modelMatrix!==u&&v.yp.free(r.modelMatrix),r.modelMatrix=u,r.highPerformanceRestore(),c}};P=function(t,e,i,r){var s,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(n<3?s(a):n>3?s(e,i,a):s(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a}([(0,c.b)(),(r=(0,p.f)(d.EY),function(t,e){r(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],P);let O=!1,I=new o.n((t,e,i,r)=>{O||(O=!0,t(E.Sp).to(P).inSingletonScope(),t(E.EL).toService(E.Sp))});var R=i(35922);function L(){L.__loaded||(L.__loaded=!0,n.i.RegisterGraphicCreator("text",s.r),a.n.load(T),a.n.load(C.X?I:R.T))}L.__loaded=!1;let D=L},83143:function(t,e,i){"use strict";var r,s;i.d(e,{_f:()=>r,lK:()=>l,z2:()=>a}),(s=r||(r={})).Identity="identity",s.Linear="linear",s.Log="log",s.Pow="pow",s.Sqrt="sqrt",s.Symlog="symlog",s.Time="time",s.Quantile="quantile",s.Quantize="quantize",s.Threshold="threshold",s.Ordinal="ordinal",s.Point="point",s.Band="band";let n={};function a(t){switch(t){case r.Linear:case r.Log:case r.Pow:case r.Sqrt:case r.Symlog:case r.Time:return!0;default:return!1}}function l(t){switch(t){case r.Ordinal:case r.Point:case r.Band:return!0;default:return!1}}Object.values(r).forEach(t=>{n[t]=!0})},98706:function(t,e,i){"use strict";i.d(e,{Dt:()=>n,LW:()=>h,M4:()=>s,Oy:()=>o,gt:()=>a,op:()=>l,tc:()=>u});var r=i(88504);function s(t){return Math.PI/180*t}function n(t){return 180*t/Math.PI}let a=(t=0)=>{if(t<0)for(;t<-r.BZ;)t+=r.BZ;else if(t>0)for(;t>r.BZ;)t-=r.BZ;return t};function l(t,e,i){return e?{x:t.x+e*Math.cos(i),y:t.y+e*Math.sin(i)}:{x:t.x,y:t.y}}function o(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function h(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function u(t){return(t=h(t))>0&&t<=Math.PI/2?2:t>Math.PI/2&&t<=Math.PI?3:t>Math.PI&&t<=3*Math.PI/2?4:1}},14925:function(t,e,i){"use strict";i.d(e,{eX:()=>v,Il:()=>_});var r=i(45273),s=i(31535),n=i(21777),a=i(35652),l=i(21648);function o(t,e,i){let r=(1-Math.abs(2*(i/=100)-1))*(e/=100),s=r*(1-Math.abs(t/60%2-1)),n=i-r/2,a=0,l=0,o=0;return 0<=t&&t<60?(a=r,l=s,o=0):60<=t&&t<120?(a=s,l=r,o=0):120<=t&&t<180?(a=0,l=r,o=s):180<=t&&t<240?(a=0,l=s,o=r):240<=t&&t<300?(a=s,l=0,o=r):300<=t&&t<360&&(a=r,l=0,o=s),{r:a=Math.round(255*(a+n)),g:l=Math.round(255*(l+n)),b:o=Math.round(255*(o+n))}}function h(t,e,i){t/=255;let r=Math.min(t,e/=255,i/=255),s=Math.max(t,e,i),n=s-r,a=0,l=0,o=0;return(a=Math.round(60*(a=0===n?0:s===t?(e-i)/n%6:s===e?(i-t)/n+2:(t-e)/n+4)))<0&&(a+=360),o=(s+r)/2,{h:a,s:l=+(100*(l=0===n?0:n/(1-Math.abs(2*o-1)))).toFixed(1),l:o=+(100*o).toFixed(1)}}let u=/^#([0-9a-f]{3,8})$/,d={transparent:0xffffff00},c={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function p(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function g(t){return(0,r.Z)(t)?new v(t>>16,t>>8&255,255&t,1):(0,s.Z)(t)?new v(t[0],t[1],t[2]):new v(255,255,255)}function f(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function m(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let y=(t,e)=>{let i=u.exec(t);if(e||i){let t=parseInt(i[1],16),e=i[1].length;return 3===e?new v((t>>8&15)+((t>>8&15)<<4),(t>>4&15)+((t>>4&15)<<4),(15&t)+((15&t)<<4),1):6===e?g(t):8===e?new v(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):null}};class _{static Brighter(t,e=1){return 1===e?t:new _(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return 1===e?t:new _(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){let i=t instanceof _?t:new _(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3();case"wcag":return i.getLuminanceWCAG()}}static parseColorString(t){if((0,n.Z)(d[t])){var e;return e=d[t],(0,r.Z)(e)?new v(e>>>24,e>>>16&255,e>>>8&255,255&e):(0,s.Z)(e)?new v(e[0],e[1],e[2],e[3]):new v(255,255,255,1)}if((0,n.Z)(c[t]))return g(c[t]);let i=`${t}`.trim().toLowerCase(),a=y(i);if(void 0!==a)return a;if(/^(rgb|RGB|rgba|RGBA)/.test(i)){let t=i.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new v(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),parseFloat(t[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(i)){let t=i.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),e=o(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));return new v(e.r,e.g,e.b,parseFloat(t[3]))}}constructor(t){let e=_.parseColorString(t);e?this.color=e:(console.warn(`Warn: 传入${t}无法解析为Color`),this.color=new v(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){let{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){let r=this.color.opacity,s=h(this.color.r,this.color.g,this.color.b),n=o((0,a.Z)(t)?s.h:(0,l.Z)(t,0,360),(0,a.Z)(e)?s.s:e>=0&&e<=1?100*e:e,(0,a.Z)(i)?s.l:i<=1&&i>=0?100*i:i);return this.color=new v(n.r,n.g,n.b,r),this}setRGB(t,e,i){return(0,a.Z)(t)||(this.color.r=t),(0,a.Z)(e)||(this.color.g=e),(0,a.Z)(i)||(this.color.b=i),this}setHex(t){let e=y(`${t}`.trim().toLowerCase(),!0);return null!=e?e:this}setColorName(t){let e=c[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}getLuminanceWCAG(){let t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;return .2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))}clone(){return new _(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){let i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=f(t.color.r),this.color.g=f(t.color.g),this.color.b=f(t.color.b),this}copyLinearToSRGB(t){return this.color.r=m(t.color.r),this.color.g=m(t.color.g),this.color.b=m(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class v{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),(0,n.Z)(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${p(this.r)+p(this.g)+p(this.b)+(1===this.opacity?"":p(255*this.opacity))}`}formatRgb(){let t=this.opacity;return`${1===t?"rgb(":"rgba("}${this.r},${this.g},${this.b}${1===t?")":`,${t})`}`}formatHsl(){let t=this.opacity,{h:e,s:i,l:r}=h(this.r,this.g,this.b);return`${1===t?"hsl(":"hsla("}${e},${i}%,${r}%${1===t?")":`,${t})`}`}toString(){return this.formatHex()}}},88663:function(t,e,i){"use strict";i.d(e,{CE:()=>o,IX:()=>a,VF:()=>function t(e){if(!(0,r.Z)(e))return[e];let i=[];for(let r of e)i.push(...t(r));return i},Z$:()=>l,h6:()=>u,iH:()=>h});var r=i(31535),s=i(40851),n=i(21777);function a(t){return(0,n.Z)(t)?(0,r.Z)(t)?t:[t]:[]}function l(t){if((0,s.Z)(t))return t[t.length-1]}let o=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let s=1;s<t.length;s++){let n=t[s];(null!=(i=null==e?void 0:e(n,r))?i:n-r)>0&&(r=n)}return r},h=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let s=1;s<t.length;s++){let n=t[s];(null!=(i=null==e?void 0:e(n,r))?i:n-r)<0&&(r=n)}return r};function u(t,e){if(!(0,r.Z)(t)||!(0,r.Z)(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}},45103:function(t,e,i){"use strict";i.d(e,{o0:()=>n,b4:()=>s});var r=i(35652);function s(t,e,i=0,n){for((0,r.Z)(n)&&(n=t.length);i<n;){var a;let r=i+n>>>1;((a=t[r])<e?-1:a>e?1:a>=e?0:NaN)>0?n=r:i=r+1}return i}let n=(t,e,i)=>{let r=t,s=e;for(;r<s;){let t=Math.floor((r+s)/2);i(t)>=0?s=t:r=t+1}return r}},21648:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=function(t,e,i){return t<e?e:t>i?i:t}},12319:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=(t,e,i)=>{let[r,s]=t;s<r&&(r=t[1],s=t[0]);let n=s-r;return n>=i-e?[e,i]:[r=Math.min(Math.max(r,e),i-n),r+n]}},92493:function(t,e,i){"use strict";i.d(e,{Z:()=>function t(e,i,n){let u;if(!(0,h.Z)(e)||"object"!=typeof e||i&&i(e))return e;let d=(0,r.Z)(e),c=e.length;u=d?Array(c):"object"==typeof e?{}:(0,s.Z)(e)||(0,l.Z)(e)||(0,o.Z)(e)?e:a(e)?new Date(+e):void 0;let p=d?void 0:Object.keys(Object(e)),g=-1;if(u)for(;++g<(p||e).length;){let r=p?p[g]:g,s=e[r];n&&n.includes(r.toString())?u[r]=s:u[r]=t(s,i,n)}return u}});var r=i(31535),s=i(61868),n=i(93918);let a=t=>(0,n.Z)(t,"Date");var l=i(45273),o=i(30756),h=i(21777)},10391:function(t,e,i){"use strict";i.d(e,{Z:()=>a});var r=i(43562),s=i(70501);let n=!1;try{n="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame}catch(t){n=!1}n=!1;let a=function(t,e,i){let a,l,o,h,u,d,c=0,p=!1,g=!1,f=!0,m=!e&&0!==e&&n;if("function"!=typeof t)throw TypeError("Expected a function");function y(e){let i=a,r=l;return a=l=void 0,c=e,h=t.apply(r,i)}function _(t,e){return m?(cancelAnimationFrame(u),requestAnimationFrame(t)):setTimeout(t,e)}function v(t){let i=t-d;return void 0===d||i>=e||i<0||g&&t-c>=o}function b(){let t=Date.now();if(v(t))return x(t);u=_(b,function(t){let i=t-c,r=e-(t-d);return g?Math.min(r,o-i):r}(t))}function x(t){return u=void 0,f&&a?y(t):(a=l=void 0,h)}function S(...t){let i=Date.now(),r=v(i);if(a=t,l=this,d=i,r){if(void 0===u){var s;return c=s=d,u=_(b,e),p?y(s):h}if(g)return u=_(b,e),y(d)}return void 0===u&&(u=_(b,e)),h}return e=+e||0,(0,r.Z)(i)&&(p=!!i.leading,(g="maxWait"in i)&&(o=Math.max((0,s.Z)(i.maxWait)?i.maxWait:0,e)),f="trailing"in i?!!i.trailing:f),S.cancel=function(){void 0!==u&&function(t){if(m)return cancelAnimationFrame(t);clearTimeout(t)}(u),c=0,a=d=l=u=void 0},S.flush=function(){return void 0===u?h:x(Date.now())},S.pending=function(){return void 0!==u},S}},59225:function(t,e,i){"use strict";i.d(e,{Z:()=>s});var r=i(30756);let s=(t,e,i)=>{let s=(0,r.Z)(e)?e.split("."):e;for(let e=0;e<s.length;e++)t=t?t[s[e]]:void 0;return void 0===t?i:t}},31535:function(t,e,i){"use strict";i.d(e,{Z:()=>s});var r=i(93918);let s=t=>Array.isArray?Array.isArray(t):(0,r.Z)(t,"Array")},40851:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)}},61868:function(t,e,i){"use strict";i.d(e,{Z:()=>s});var r=i(93918);let s=(t,e=!1)=>e?"boolean"==typeof t:!0===t||!1===t||(0,r.Z)(t,"Boolean")},47704:function(t,e,i){"use strict";i.d(e,{Z:()=>h});var r=i(35652),s=i(40851);let n=t=>({}).toString.call(t).replace(/^\[object /,"").replace(/]$/,""),a=Object.prototype,l=function(t){let e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||a)},o=Object.prototype.hasOwnProperty,h=function(t){if((0,r.Z)(t))return!0;if((0,s.Z)(t))return!t.length;let e=n(t);if("Map"===e||"Set"===e)return!t.size;if(l(t))return!Object.keys(t).length;for(let e in t)if(o.call(t,e))return!1;return!0}},98116:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>"function"==typeof t},35652:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>null==t},45273:function(t,e,i){"use strict";i.d(e,{Z:()=>s});var r=i(93918);let s=(t,e=!1)=>{let i=typeof t;return e?"number"===i:"number"===i||(0,r.Z)(t,"Number")}},43562:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>{let e=typeof t;return null!==t&&"object"===e||"function"===e}},80875:function(t,e,i){"use strict";i.d(e,{Z:()=>n});let r=t=>"object"==typeof t&&null!==t;var s=i(93918);let n=function(t){if(!r(t)||!(0,s.Z)(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}},30756:function(t,e,i){"use strict";i.d(e,{Z:()=>s});var r=i(93918);let s=(t,e=!1)=>{let i=typeof t;return e?"string"===i:"string"===i||(0,r.Z)(t,"String")}},93918:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=(t,e)=>Object.prototype.toString.call(t)===`[object ${e}]`},21777:function(t,e,i){"use strict";i.d(e,{Z:()=>r});let r=t=>null!=t},70501:function(t,e,i){"use strict";i.d(e,{Z:()=>s});var r=i(45273);let s=t=>(0,r.Z)(t)&&Number.isFinite(t)},95950:function(t,e,i){"use strict";i.d(e,{Z:()=>o});var r=i(31535),s=i(40851),n=i(80875),a=i(21777);function l(t,e,i){var r,s;(void 0===i||(r=t[e],r===(s=i)||Number.isNaN(r)&&Number.isNaN(s)))&&(void 0!==i||e in t)||(t[e]=i)}function o(t,...e){let i=-1,h=e.length;for(;++i<h;)!function t(e,i,o=!1,h=!1){if(i&&e!==i&&(0,a.Z)(i)&&"object"==typeof i){let u=Object(i),d=[];for(let t in u)d.push(t);let{length:c}=d,p=-1;for(;c--;){let c=d[++p];!(0,a.Z)(u[c])||"object"!=typeof u[c]||h&&(0,r.Z)(e[c])?l(e,c,u[c]):function(e,i,a,o=!1,h=!1){let u=e[a],d=i[a],c=i[a],p=!0;if((0,r.Z)(d)){if(o)c=[];else if((0,r.Z)(u))c=u;else if((0,s.Z)(u)){c=Array(u.length);let t=-1,e=u.length;for(;++t<e;)c[t]=u[t]}}else(0,n.Z)(d)?(c=null!=u?u:{},"function"!=typeof u&&"object"==typeof u||(c={})):p=!1;p&&t(c,d,o,h),l(e,a,c)}(e,i,c,o,h)}}}(t,e[i],!0);return t}},87986:function(t,e,i){"use strict";function r(t,e,i=!0){if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames){let r=Object.getOwnPropertyNames(e);for(let s=0;s<r.length;s++){let n=r[s];"constructor"!==n&&(i?null!=e[n]:null==t[n])&&(t[n]=e[n])}}else{var s=t,n=e,a=i;let r=function(t){if(!t)return[];if(Object.keys)return Object.keys(t);let e=[];for(let i in t)t.hasOwnProperty(i)&&e.push(i);return e}(n);for(let t=0;t<r.length;t++){let e=r[t];(a?null!=n[e]:null==s[e])&&(s[e]=n[e])}}}i.d(e,{jB:()=>r})},25258:function(t,e,i){"use strict";function r(t,e,i=1e-10,s=1e-10){let n=i*Math.max(t,e);return Math.abs(t-e)<=Math.max(s,n)}function s(t,e,i,s){return t>e&&!r(t,e,i,s)}function n(t,e,i,s){return t<e&&!r(t,e,i,s)}i.d(e,{SQ:()=>n,Vy:()=>s,Yt:()=>r})},70527:function(t,e,i){"use strict";i.d(e,{Z:()=>n});var r=i(10391),s=i(43562);let n=function(t,e,i){let n=!0,a=!0;if("function"!=typeof t)throw TypeError("Expected a function");return(0,s.Z)(i)&&(n="leading"in i?!!i.leading:n,a="trailing"in i?!!i.trailing:a),(0,r.Z)(t,e,{leading:n,trailing:a,maxWait:e})}},76620:function(t,e,i){"use strict";i.d(e,{FB:()=>l,YZ:()=>a,a5:()=>o,n2:()=>n});var r=i(31535),s=i(33049);function n(t,e,i){let{x1:r,y1:s,x2:n,y2:a}=e;return i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f)):(t.clear(),t.add(i.a*r+i.c*s+i.e,i.b*r+i.d*s+i.f),t.add(i.a*n+i.c*s+i.e,i.b*n+i.d*s+i.f),t.add(i.a*n+i.c*a+i.e,i.b*n+i.d*a+i.f),t.add(i.a*r+i.c*a+i.e,i.b*r+i.d*a+i.f)),e}class a{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new a(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return(0,r.Z)(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){let r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){let s=this.scalePoints(t,e,i,r);return this.clear().add(s[0],s[1]).add(s[2],s[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return n(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){let{x1:r,y1:s,x2:n,y2:a}=this,l=Math.cos(t),o=Math.sin(t),h=e-e*l+i*o,u=i-e*o-i*l;return[l*r-o*s+h,o*r+l*s+u,l*r-o*a+h,o*r+l*a+u,l*n-o*s+h,o*n+l*s+u,l*n-o*a+h,o*n+l*a+u]}scalePoints(t,e,i,r){let{x1:s,y1:n,x2:a,y2:l}=this;return[t*s+(1-t)*i,e*n+(1-e)*r,t*a+(1-t)*i,e*l+(1-e)*r]}}class l extends a{}class o extends a{constructor(t,e=0){var i;super(t),t&&(this.angle=null!=(i=t.angle)?i:e)}intersects(t){return(0,s.nn)(this,t)}setValue(t=0,e=0,i=0,r=0,s=0){return super.setValue(t,e,i,r),this.angle=s,this}clone(){return new o(this)}getRotatedCorners(){let t={x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2};return[(0,s.xj)({x:this.x1,y:this.y1},this.angle,t),(0,s.xj)({x:this.x2,y:this.y1},this.angle,t),(0,s.xj)({x:this.x1,y:this.y2},this.angle,t),(0,s.xj)({x:this.x2,y:this.y2},this.angle,t)]}}},8992:function(t,e,i){"use strict";i.d(e,{X:()=>a,y:()=>n});var r=i(98706),s=i(88504);class n{constructor(t=1,e=0,i=0,r=1,s=0,n=0){this.a=t,this.b=e,this.c=i,this.d=r,this.e=s,this.f=n}equalToMatrix(t){return this.e===t.e&&this.f===t.f&&this.a===t.a&&this.d===t.d&&this.b===t.b&&this.c===t.c}equalTo(t,e,i,r,s,n){return this.e===s&&this.f===n&&this.a===t&&this.d===r&&this.b===e&&this.c===i}setValue(t,e,i,r,s,n){return this.a=t,this.b=e,this.c=i,this.d=r,this.e=s,this.f=n,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){let t=this.a,e=this.b,i=this.c,r=this.d,s=this.e,a=this.f,l=new n,o=t*r-e*i;return l.a=r/o,l.b=-e/o,l.c=-i/o,l.d=t/o,l.e=(i*a-r*s)/o,l.f=-(t*a-e*s)/o,l}rotate(t){let e=Math.cos(t),i=Math.sin(t),r=this.a*e+this.c*i,s=this.b*e+this.d*i,n=-(this.a*i)+this.c*e,a=-(this.b*i)+this.d*e;return this.a=r,this.b=s,this.c=n,this.d=a,this}rotateByCenter(t,e,i){let r=Math.cos(t),s=Math.sin(t),n=r*this.a-s*this.b,a=s*this.a+r*this.b,l=r*this.c-s*this.d,o=s*this.c+r*this.d,h=r*this.e-s*this.f+((1-r)*e+s*i),u=s*this.e+r*this.f+((1-r)*i-s*e);return this.a=n,this.b=a,this.c=l,this.d=o,this.e=h,this.f=u,this}scale(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}setScale(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}transform(t,e,i,r,s,n){return this.multiply(t,e,i,r,s,n),this}translate(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}transpose(){let{a:t,b:e,c:i,d:r,e:s,f:n}=this;return this.a=e,this.b=t,this.c=r,this.d=i,this.e=n,this.f=s,this}multiply(t,e,i,r,s,n){let a=this.a,l=this.b,o=this.c,h=this.d,u=a*s+o*n+this.e,d=l*s+h*n+this.f;return this.a=a*t+o*e,this.b=l*t+h*e,this.c=a*i+o*r,this.d=l*i+h*r,this.e=u,this.f=d,this}interpolate(t,e){let i=new n;return i.a=this.a+(t.a-this.a)*e,i.b=this.b+(t.b-this.b)*e,i.c=this.c+(t.c-this.c)*e,i.d=this.d+(t.d-this.d)*e,i.e=this.e+(t.e-this.e)*e,i.f=this.f+(t.f-this.f)*e,i}transformPoint(t,e){let{a:i,b:r,c:s,d:n,e:a,f:l}=this,o=i*n-r*s,{x:h,y:u}=t;e.x=n/o*h+-s/o*u+(s*l-n*a)/o,e.y=-r/o*h+i/o*u+-(i*l-r*a)/o}onlyTranslate(t=1){return this.a===t&&0===this.b&&0===this.c&&this.d===t}clone(){return new n(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){let t=this.a,e=this.b,i=this.c,s=this.d,n=t*s-e*i,a={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){let r=Math.sqrt(t*t+e*e);a.rotateDeg=e>0?Math.acos(t/r):-Math.acos(t/r),a.scaleX=r,a.scaleY=n/r,a.skewX=(t*i+e*s)/n,a.skewY=0}else if(0!==i||0!==s){let r=Math.sqrt(i*i+s*s);a.rotateDeg=Math.PI/2-(s>0?Math.acos(-i/r):-Math.acos(i/r)),a.scaleX=n/r,a.scaleY=r,a.skewX=0,a.skewY=(t*i+e*s)/n}return a.rotateDeg=(0,r.Dt)(a.rotateDeg),a}}function a(t,e,i,r,n,a,l,o){let h,u,d=e.a,c=e.b,p=e.c,g=e.d,f=e.e,m=e.f,y=(0,s.mC)(l),_=(0,s.O$)(l);o?(h=o[0],u=o[1]):(h=i,u=r);let v=h-i,b=u-r,x=d*y+p*_,S=c*y+g*_,k=p*y-d*_,A=g*y-c*_;t.a=n*x,t.b=n*S,t.c=a*k,t.d=a*A,t.e=f+d*h+p*u-x*v-k*b,t.f=m+c*h+g*u-S*v-A*b}},41457:function(t,e,i){"use strict";i.d(e,{E9:()=>n,HL:()=>a});var r=i(45273),s=i(88504);class n{constructor(t=0,e=0,i,r){this.x=0,this.y=0,this.x=t,this.y=e,this.x1=i,this.y1=r}clone(){return new n(this.x,this.y)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}set(t,e){return this.x=t,this.y=e,this}add(t){return(0,r.Z)(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}sub(t){return(0,r.Z)(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}multi(t){throw Error("暂不支持")}div(t){throw Error("暂不支持")}}class a{static distancePP(t,e){return(0,s._b)((0,s.sQ)(t.x-e.x,2)+(0,s.sQ)(t.y-e.y,2))}static distanceNN(t,e,i,r){return(0,s._b)((0,s.sQ)(t-i,2)+(0,s.sQ)(e-r,2))}static distancePN(t,e,i){return(0,s._b)((0,s.sQ)(e-t.x,2)+(0,s.sQ)(i-t.y,2))}static pointAtPP(t,e,i){return new n((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}},97424:function(t,e,i){"use strict";i.d(e,{Z2:()=>s,wv:()=>r});let r=(t="")=>{let e={};return t.split(";").forEach(t=>{if(t){let i=t.split(":");if(2===i.length){let t=i[0].trim(),r=i[1].trim();t&&r&&(e[t]=r)}}}),e},s=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase()},33049:function(t,e,i){"use strict";i.d(e,{Jz:()=>o,RA:()=>d,SX:()=>c,di:()=>h,nn:()=>_,qr:()=>p,xj:()=>f});var r,s,n=i(98706),a=i(88504);function l(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1]}function o(t,e,i,r){let s,n,o,h;if(s=t[0],n=e[0],o=i[0],h=r[0],n<s&&([s,n]=[n,s]),h<o&&([h,o]=[o,h]),n<o||h<s||(s=t[1],n=e[1],o=i[1],h=r[1],n<s&&([s,n]=[n,s]),h<o&&([h,o]=[o,h]),n<o||h<s))return!1;let u=[0,0],d=[0,0],c=[0,0];if(l(u,e,t),l(d,r,i),(0,a.Bw)(u,d))return!0;l(c,i,t);let p=(0,a.ir)(c,d)/(0,a.ir)(u,d);return p>=0&&p<=1&&[t[0]+u[0]*p,t[1]+u[1]*p]}function h(t,e,i){if(null===t)return e;if(null===e)return t;let{x11:r,x12:s,y11:n,y12:a,x21:l,x22:o,y21:h,y22:d}=u(t,e,i);return r>=o||s<=l||n>=d||a<=h?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(r,l),y1:Math.max(n,h),x2:Math.min(s,o),y2:Math.min(a,d)}}(r=s||(s={}))[r.NONE=0]="NONE",r[r.BBOX1=1]="BBOX1",r[r.BBOX2=2]="BBOX2";let u=(t,e,i)=>{let r=t.x1,s=t.x2,n=t.y1,a=t.y2,l=e.x1,o=e.x2,h=e.y1,u=e.y2;return i&&(r>s&&([r,s]=[s,r]),n>a&&([n,a]=[a,n]),l>o&&([l,o]=[o,l]),h>u&&([h,u]=[u,h])),{x11:r,x12:s,y11:n,y12:a,x21:l,x22:o,y21:h,y22:u}};function d(t,e,i){if(!t||!e)return s.NONE;let{x11:r,x12:n,y11:a,y12:l,x21:o,x22:h,y21:d,y22:c}=u(t,e,i);return r>o&&n<h&&a>d&&l<c?s.BBOX1:o>r&&h<n&&d>a&&c<l?s.BBOX2:s.NONE}function c(t,e,i){if(t&&e){if(!i)return!(t.x1>e.x2||t.x2<e.x1||t.y1>e.y2||t.y2<e.y1);let{x11:r,x12:s,y11:n,y12:a,x21:l,x22:o,y21:h,y22:d}=u(t,e,!0);return!(r>o||s<l||n>d||a<h)}return!0}function p(t,e,i){if(!e)return!0;if(!i)return t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2;let r=e.x1,s=e.x2,n=e.y1,a=e.y2;return r>s&&([r,s]=[s,r]),n>a&&([n,a]=[a,n]),t.x>=r&&t.x<=s&&t.y>=n&&t.y<=a}function g(t,e){return Math.abs(e[0]*t[0]+e[1]*t[1])}function f({x:t,y:e},i,r={x:0,y:0}){return{x:(t-r.x)*Math.cos(i)-(e-r.y)*Math.sin(i)+r.x,y:(t-r.x)*Math.sin(i)+(e-r.y)*Math.cos(i)+r.y}}function m(t){return{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2}}function y(t,e){let i=e?(0,n.M4)(t.angle):t.angle,r=m(t);return[f({x:t.x1,y:t.y1},i,r),f({x:t.x2,y:t.y1},i,r),f({x:t.x2,y:t.y2},i,r),f({x:t.x1,y:t.y2},i,r)]}function _(t,e,i=!1){let r=y(t,i),s=y(e,i),l=(t,e)=>[e.x-t.x,e.y-t.y],o=l(m(t),m(e)),h=l(r[0],r[1]),u=l(r[1],r[2]),d=l(s[0],s[1]),c=l(s[1],s[2]),p=i?(0,n.M4)(t.angle):t.angle,f=i?(0,n.M4)(90-t.angle):t.angle+a.ou,v=i?(0,n.M4)(e.angle):e.angle,b=i?(0,n.M4)(90-e.angle):e.angle+a.ou;f>a.f7&&(f-=a.f7),b>a.f7&&(b-=a.f7);let x=(t,e,i,r)=>{let s=[Math.cos(e),Math.sin(e)];return t+(g(s,i)+g(s,r))/2>g(s,o)};return x((t.x2-t.x1)/2,p,d,c)&&x((t.y2-t.y1)/2,f,d,c)&&x((e.x2-e.x1)/2,v,h,u)&&x((e.y2-e.y1)/2,b,h,u)}},70016:function(t,e,i){"use strict";i.d(e,{YB:()=>s,up:()=>n,v1:()=>r});let r=(t,e)=>{let{x1:i,x2:r,y1:s,y2:n}=t,a=Math.abs(r-i),l=Math.abs(n-s),o=(i+r)/2,h=(s+n)/2,u=0,d=0;switch(e){case"top":case"inside-top":d=-.5;break;case"bottom":case"inside-bottom":d=.5;break;case"left":case"inside-left":u=-.5;break;case"right":case"inside-right":u=.5;break;case"top-right":u=.5,d=-.5;break;case"top-left":u=-.5,d=-.5;break;case"bottom-right":u=.5,d=.5;break;case"bottom-left":u=-.5,d=.5}return{x:o+=u*a,y:h+=d*l}},s=(t,e)=>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),n=(t,e)=>{let i=[{x:Math.cos(t.angle),y:Math.sin(t.angle)},{x:-Math.sin(t.angle),y:Math.cos(t.angle)},{x:Math.cos(e.angle),y:Math.sin(t.angle)},{x:-Math.sin(e.angle),y:Math.cos(t.angle)}];function r(t,e,i){let r=t.getRotatedCorners().map(t=>t.x*e+t.y*i);return{min:Math.min(...r),max:Math.max(...r)}}let s=0;for(let n of i){let i=r(t,n.x,n.y),a=r(e,n.x,n.y);s=Math.max(s,i.max<a.min?a.min-i.max:a.max<i.min?i.min-a.max:0)}return s}},6201:function(t,e,i){"use strict";function r(t,e,i){let r=0,a=t[0];if(!a)return!1;for(let n=1;n<t.length;n++){let l=t[n];r+=s(a.x,a.y,l.x,l.y,e,i),a=l}let l=t[0];return n(a.x,l.x)&&n(a.y,l.y)||(r+=s(a.x,a.y,l.x,l.y,e,i)),0!==r}function s(t,e,i,r,s,n){if(n>e&&n>r||n<e&&n<r||r===e)return 0;let a=(n-e)/(r-e),l=r<e?1:-1;1!==a&&0!==a||(l=r<e?.5:-.5);let o=a*(i-t)+t;return o===s?1/0:o>s?l:0}function n(t,e){return 1e-8>Math.abs(t-e)}i.d(e,{N0:()=>s,O0:()=>r})},21728:function(t,e,i){"use strict";i.d(e,{e:()=>h});var r=i(21777),s=i(35652),n=i(30756),a=i(31535);let l=t=>{let e=t.charCodeAt(0),i=2===t.length?t.charCodeAt(1):0,r=e;return 55296<=e&&e<=56319&&56320<=i&&i<=57343&&(e&=1023,i&=1023,r=(e<<10|i)+65536),12288===r||65281<=r&&r<=65376||65504<=r&&r<=65510?"F":8361===r||65377<=r&&r<=65470||65474<=r&&r<=65479||65482<=r&&r<=65487||65490<=r&&r<=65495||65498<=r&&r<=65500||65512<=r&&r<=65518?"H":4352<=r&&r<=4447||4515<=r&&r<=4519||4602<=r&&r<=4607||9001<=r&&r<=9002||11904<=r&&r<=11929||11931<=r&&r<=12019||12032<=r&&r<=12245||12272<=r&&r<=12283||12289<=r&&r<=12350||12353<=r&&r<=12438||12441<=r&&r<=12543||12549<=r&&r<=12589||12593<=r&&r<=12686||12688<=r&&r<=12730||12736<=r&&r<=12771||12784<=r&&r<=12830||12832<=r&&r<=12871||12880<=r&&r<=13054||13056<=r&&r<=19903||19968<=r&&r<=42124||42128<=r&&r<=42182||43360<=r&&r<=43388||44032<=r&&r<=55203||55216<=r&&r<=55238||55243<=r&&r<=55291||63744<=r&&r<=64255||65040<=r&&r<=65049||65072<=r&&r<=65106||65108<=r&&r<=65126||65128<=r&&r<=65131||110592<=r&&r<=110593||127488<=r&&r<=127490||127504<=r&&r<=127546||127552<=r&&r<=127560||127568<=r&&r<=127569||131072<=r&&r<=194367||177984<=r&&r<=196605||196608<=r&&r<=262141?"W":32<=r&&r<=126||162<=r&&r<=163||165<=r&&r<=166||172===r||175===r||10214<=r&&r<=10221||10629<=r&&r<=10630?"Na":161===r||164===r||167<=r&&r<=168||170===r||173<=r&&r<=174||176<=r&&r<=180||182<=r&&r<=186||188<=r&&r<=191||198===r||208===r||215<=r&&r<=216||222<=r&&r<=225||230===r||232<=r&&r<=234||236<=r&&r<=237||240===r||242<=r&&r<=243||247<=r&&r<=250||252===r||254===r||257===r||273===r||275===r||283===r||294<=r&&r<=295||299===r||305<=r&&r<=307||312===r||319<=r&&r<=322||324===r||328<=r&&r<=331||333===r||338<=r&&r<=339||358<=r&&r<=359||363===r||462===r||464===r||466===r||468===r||470===r||472===r||474===r||476===r||593===r||609===r||708===r||711===r||713<=r&&r<=715||717===r||720===r||728<=r&&r<=731||733===r||735===r||768<=r&&r<=879||913<=r&&r<=929||931<=r&&r<=937||945<=r&&r<=961||963<=r&&r<=969||1025===r||1040<=r&&r<=1103||1105===r||8208===r||8211<=r&&r<=8214||8216<=r&&r<=8217||8220<=r&&r<=8221||8224<=r&&r<=8226||8228<=r&&r<=8231||8240===r||8242<=r&&r<=8243||8245===r||8251===r||8254===r||8308===r||8319===r||8321<=r&&r<=8324||8364===r||8451===r||8453===r||8457===r||8467===r||8470===r||8481<=r&&r<=8482||8486===r||8491===r||8531<=r&&r<=8532||8539<=r&&r<=8542||8544<=r&&r<=8555||8560<=r&&r<=8569||8585===r||8592<=r&&r<=8601||8632<=r&&r<=8633||8658===r||8660===r||8679===r||8704===r||8706<=r&&r<=8707||8711<=r&&r<=8712||8715===r||8719===r||8721===r||8725===r||8730===r||8733<=r&&r<=8736||8739===r||8741===r||8743<=r&&r<=8748||8750===r||8756<=r&&r<=8759||8764<=r&&r<=8765||8776===r||8780===r||8786===r||8800<=r&&r<=8801||8804<=r&&r<=8807||8810<=r&&r<=8811||8814<=r&&r<=8815||8834<=r&&r<=8835||8838<=r&&r<=8839||8853===r||8857===r||8869===r||8895===r||8978===r||9312<=r&&r<=9449||9451<=r&&r<=9547||9552<=r&&r<=9587||9600<=r&&r<=9615||9618<=r&&r<=9621||9632<=r&&r<=9633||9635<=r&&r<=9641||9650<=r&&r<=9651||9654<=r&&r<=9655||9660<=r&&r<=9661||9664<=r&&r<=9665||9670<=r&&r<=9672||9675===r||9678<=r&&r<=9681||9698<=r&&r<=9701||9711===r||9733<=r&&r<=9734||9737===r||9742<=r&&r<=9743||9748<=r&&r<=9749||9756===r||9758===r||9792===r||9794===r||9824<=r&&r<=9825||9827<=r&&r<=9829||9831<=r&&r<=9834||9836<=r&&r<=9837||9839===r||9886<=r&&r<=9887||9918<=r&&r<=9919||9924<=r&&r<=9933||9935<=r&&r<=9953||9955===r||9960<=r&&r<=9983||10045===r||10071===r||10102<=r&&r<=10111||11093<=r&&r<=11097||12872<=r&&r<=12879||57344<=r&&r<=63743||65024<=r&&r<=65039||65533===r||127232<=r&&r<=127242||127248<=r&&r<=127277||127280<=r&&r<=127337||127344<=r&&r<=127386||917760<=r&&r<=917999||983040<=r&&r<=1048573||1048576<=r&&r<=1114109?"A":"N"};var o=i(28504);class h{constructor(t,e){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet="-/: .,@%'\"~",this._option=t,this._userSpec=null!=e?e:{},this.textSpec=this._initSpec(),(0,r.Z)(t.specialCharSet)&&(this.specialCharSet=t.specialCharSet),this._standardMethod=(0,r.Z)(t.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if((0,s.Z)(this._canvas)&&((0,r.Z)(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),(0,s.Z)(this._canvas)&&"undefined"!=typeof window&&void 0!==window.document&&globalThis&&(0,r.Z)(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),(0,s.Z)(this._context)&&(0,r.Z)(this._canvas)){let t=this._canvas.getContext("2d");(0,r.Z)(t)&&(t.save(),t.font=(0,o.U)(this.textSpec),this._contextSaved=!0,this._context=t)}return!(0,s.Z)(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var t,e,i;let{defaultFontParams:r={}}=this._option,{fontStyle:s=r.fontStyle,fontVariant:a=r.fontVariant,fontWeight:l=null!=(t=r.fontWeight)?t:"normal",fontSize:o=null!=(e=r.fontSize)?e:12,fontFamily:h=null!=(i=r.fontFamily)?i:"sans-serif",align:u,textAlign:d=null!=u?u:"center",baseline:c,textBaseline:p=null!=c?c:"middle",ellipsis:g,limit:f}=this._userSpec,{lineHeight:m=o}=this._userSpec;return(0,n.Z)(m)&&"%"===m[m.length-1]&&(m=o*(Number.parseFloat(m.substring(0,m.length-1))/100)),{fontStyle:s,fontVariant:a,fontFamily:h,fontSize:o,fontWeight:l,textAlign:d,textBaseline:p,ellipsis:g,limit:f,lineHeight:m}}measure(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}fullMeasure(t){let e;if((0,s.Z)(t))return{width:0,height:0};if((0,s.Z)(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);let{fontFamily:i,fontSize:r,fontWeight:n,textAlign:a,textBaseline:l,ellipsis:o,limit:h,lineHeight:u}=this.textSpec;try{let s=this._option.getTextBounds({text:t,fontFamily:i,fontSize:r,fontWeight:n,textAlign:a,textBaseline:l,ellipsis:!!o,maxLineWidth:h||1/0,lineHeight:u});e={width:s.width(),height:s.height()}}catch(i){this._notSupportVRender=!0,e=this.measureWithNaiveCanvas(t)}return e}measureWithNaiveCanvas(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(t){if(!this.initContext())return this._quickMeasureWithoutCanvas(t);let e=this._context.measureText(t),{fontSize:i,lineHeight:r}=this.textSpec;return{width:e.width,height:null!=r?r:i,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}quickMeasure(t){return this._measureReduce(t,this._quickMeasure.bind(this))}_quickMeasure(t){let e={width:0,height:0};for(let i=0;i<t.length;i++){let r=t[i],n=this._measureSpecialChar(r);(0,s.Z)(n)&&h.NUMBERS_CHAR_SET.includes(r)&&(n=this._measureNumberChar()),(0,s.Z)(n)&&["F","W"].includes(l(r))&&(n=this._measureFullSizeChar()),(0,s.Z)(n)&&(n=this._measureLetterChar()),e.width+=n.width,e.height=Math.max(e.height,n.height),(0,s.Z)(n.fontBoundingBoxAscent)||(e.fontBoundingBoxAscent=n.fontBoundingBoxAscent),(0,s.Z)(n.fontBoundingBoxDescent)||(e.fontBoundingBoxDescent=n.fontBoundingBoxDescent)}return e}quickMeasureWithoutCanvas(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(t){let e={width:0,height:0},{fontSize:i,lineHeight:r}=this.textSpec;for(let r=0;r<t.length;r++){let s=["F","W"].includes(l(t[r]))?1:.53;e.width+=s*i}return e.height=null!=r?r:i,e}_measureReduce(t,e){let{fontSize:i,lineHeight:n}=this.textSpec,l={width:0,height:0};if((0,s.Z)(t))return l;if((0,a.Z)(t)){let s=t.filter(r.Z).map(t=>t.toString());return 0===s.length?l:1===s.length?e(s[0]):{width:s.reduce((t,i)=>Math.max(t,e(i).width),0),height:s.length*((null!=n?n:i)+1)+1}}return e(t.toString())}_measureNumberChar(){if((0,s.Z)(this._numberCharSize)){let t=this._standardMethod(h.NUMBERS_CHAR_SET);this._numberCharSize={width:t.width/h.NUMBERS_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return(0,s.Z)(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(h.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if((0,s.Z)(this._letterCharSize)){let t=this._standardMethod(h.ALPHABET_CHAR_SET);this._letterCharSize={width:t.width/h.ALPHABET_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(t){return(0,r.Z)(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}release(){(0,r.Z)(this._canvas)&&(this._canvas=null),(0,r.Z)(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}h.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",h.NUMBERS_CHAR_SET="0123456789",h.FULL_SIZE_CHAR="字"},28504:function(t,e,i){"use strict";function r(t,e={},i){i||(i=1);let{fontStyle:s=e.fontStyle,fontVariant:n=e.fontVariant,fontWeight:a=e.fontWeight,fontSize:l=e.fontSize,fontFamily:o=e.fontFamily}=t;return(s?s+" ":"")+(n?n+" ":"")+(a?a+" ":"")+l*i+"px "+(o||"sans-serif")}i.d(e,{U:()=>r})},30943:function(t,e,i){"use strict";i.d(e,{Y:()=>o});var r,s,n=i(45273);let a="undefined"!=typeof console;function l(t,e,i){let r=[e].concat([].slice.call(i));a&&console[t].apply(console,r)}(r=s||(s={}))[r.None=0]="None",r[r.Error=1]="Error",r[r.Warn=2]="Warn",r[r.Info=3]="Info",r[r.Debug=4]="Debug";class o{static getInstance(t,e){return o._instance&&(0,n.Z)(t)?o._instance.level(t):o._instance||(o._instance=new o(t,e)),o._instance}static setInstance(t){return o._instance=t}static setInstanceLevel(t){o._instance?o._instance.level(t):o._instance=new o(t)}static clearInstance(){o._instance=null}constructor(t=s.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){let e=this._onErrorHandler.findIndex(e=>e===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=s.Info}canLogDebug(){return this._level>=s.Debug}canLogError(){return this._level>=s.Error}canLogWarn(){return this._level>=s.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=s.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):l(null!=(e=this._method)?e:"error","ERROR",t)),this}warn(...t){return this._level>=s.Warn&&l(this._method||"warn","WARN",t),this}info(...t){return this._level>=s.Info&&l(this._method||"log","INFO",t),this}debug(...t){return this._level>=s.Debug&&l(this._method||"log","DEBUG",t),this}}o._instance=null},88504:function(t,e,i){"use strict";i.d(e,{BZ:()=>a,Bw:()=>b,Fp:()=>d,Ho:()=>r,KU:()=>_,Kh:()=>m,O$:()=>p,VV:()=>c,Wn:()=>o,ZR:()=>y,_b:()=>g,f7:()=>l,fv:()=>h,ir:()=>v,mC:()=>u,ou:()=>n,pi:()=>s,sQ:()=>f});let r=1e-12,s=Math.PI,n=s/2,a=2*s,l=2*Math.PI,o=Math.abs,h=Math.atan2,u=Math.cos,d=Math.max,c=Math.min,p=Math.sin,g=Math.sqrt,f=Math.pow;function m(t){return t>1?0:t<-1?s:Math.acos(t)}function y(t){return t>=1?n:t<=-1?-n:Math.asin(t)}function _(t,e,i,r,s){let n=i,a=r;return"number"==typeof t&&"number"==typeof i&&(n=(1-s)*t+s*i),"number"==typeof e&&"number"==typeof r&&(a=(1-s)*e+s*r),{x:n,y:a}}function v(t,e){return t[0]*e[1]-t[1]*e[0]}function b(t,e){return o(t[0]-e[0])+o(t[1]-e[1])<1e-12}},11681:function(t,e,i){"use strict";i.d(e,{o:()=>a});var r=i(70501),s=i(31535),n=i(43562);function a(t){if((0,r.Z)(t))return[t,t,t,t];if((0,s.Z)(t)){let e=t.length;if(1===e){let e=t[0];return[e,e,e,e]}if(2===e){let[e,i]=t;return[e,i,e,i]}if(3===e){let[e,i,r]=t;return[e,i,r,i]}if(4===e)return t}if((0,n.Z)(t)){let{top:e=0,right:i=0,bottom:r=0,left:s=0}=t;return[e,i,r,s]}return[0,0,0,0]}},21883:function(t){"use strict";var e=Object.prototype.hasOwnProperty,i="~";function r(){}function s(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function n(t,e,r,n,a){if("function"!=typeof r)throw TypeError("The listener must be a function");var l=new s(r,n||t,a),o=i?i+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],l]:t._events[o].push(l):(t._events[o]=l,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function l(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(i=!1)),l.prototype.eventNames=function(){var t,r,s=[];if(0===this._eventsCount)return s;for(r in t=this._events)e.call(t,r)&&s.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(t)):s},l.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,n=r.length,a=Array(n);s<n;s++)a[s]=r[s].fn;return a},l.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},l.prototype.emit=function(t,e,r,s,n,a){var l=i?i+t:t;if(!this._events[l])return!1;var o,h,u=this._events[l],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,s),!0;case 5:return u.fn.call(u.context,e,r,s,n),!0;case 6:return u.fn.call(u.context,e,r,s,n,a),!0}for(h=1,o=Array(d-1);h<d;h++)o[h-1]=arguments[h];u.fn.apply(u.context,o)}else{var c,p=u.length;for(h=0;h<p;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),d){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,r);break;case 4:u[h].fn.call(u[h].context,e,r,s);break;default:if(!o)for(c=1,o=Array(d-1);c<d;c++)o[c-1]=arguments[c];u[h].fn.apply(u[h].context,o)}}return!0},l.prototype.on=function(t,e,i){return n(this,t,e,i,!1)},l.prototype.once=function(t,e,i){return n(this,t,e,i,!0)},l.prototype.removeListener=function(t,e,r,s){var n=i?i+t:t;if(!this._events[n])return this;if(!e)return a(this,n),this;var l=this._events[n];if(l.fn)l.fn!==e||s&&!l.once||r&&l.context!==r||a(this,n);else{for(var o=0,h=[],u=l.length;o<u;o++)(l[o].fn!==e||s&&!l[o].once||r&&l[o].context!==r)&&h.push(l[o]);h.length?this._events[n]=1===h.length?h[0]:h:a(this,n)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=i,l.EventEmitter=l,t.exports=l},30939:function(t,e,i){var r=i(25666);function s(e,i){var r=e.geometry,s=r.type;if("LineString"===s)r.coordinates=t.exports.simplify(r.coordinates,i);else if("Polygon"===s||"MultiLineString"===s)for(var n=0;n<r.coordinates.length;n++)r.coordinates[n]=t.exports.simplify(r.coordinates[n],i);else if("MultiPolygon"===s)for(var a=0;a<r.coordinates.length;a++)for(var l=0;l<r.coordinates[a].length;l++)r.coordinates[a][l]=t.exports.simplify(r.coordinates[a][l],i);return e}t.exports=function(t,e,i){return(i||(t=JSON.parse(JSON.stringify(t))),t.features)?function(t,e){for(var i=0;i<t.features.length;i++)t.features[i]=s(t.features[i],e);return t}(t,e):t.type&&"Feature"===t.type?s(t,e):Error("FeatureCollection or individual Feature required")},t.exports.simplify=function(t,e){return r(t,e)}},25666:function(t,e,i){var r=i(45549),s=function(t,e){for(var i=0,n=0,a=1;a<=t.length-2;a++){var l=new r(t[0],t[t.length-1]).perpendicularDistance(t[a]);l>i&&(n=a,i=l)}if(i>e)var o=s(t.slice(0,n),e),h=s(t.slice(n,t.length),e),u=o.concat(h);else u=t.length>1?[t[0],t[t.length-1]]:[t[0]];return u};t.exports=s},45549:function(t){var e=function(t,e){this.p1=t,this.p2=e};e.prototype.rise=function(){return this.p2[1]-this.p1[1]},e.prototype.run=function(){return this.p2[0]-this.p1[0]},e.prototype.slope=function(){return this.rise()/this.run()},e.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},e.prototype.isVertical=function(){return!isFinite(this.slope())},e.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},e.prototype._perpendicularDistanceHorizontal=function(t){return Math.abs(this.p1[1]-t[1])},e.prototype._perpendicularDistanceVertical=function(t){return Math.abs(this.p1[0]-t[0])},e.prototype._perpendicularDistanceHasSlope=function(t){var e=this.slope(),i=this.yIntercept();return Math.abs(e*t[0]-t[1]+i)/Math.sqrt(Math.pow(e,2)+1)},e.prototype.perpendicularDistance=function(t){return this.isVertical()?this._perpendicularDistanceVertical(t):this.isHorizontal()?this._perpendicularDistanceHorizontal(t):this._perpendicularDistanceHasSlope(t)},t.exports=e},72513:function(t,e,i){"use strict";function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{_:()=>r})},84086:function(t,e,i){"use strict";i.d(e,{a:()=>s});var r=i(65751);function s(...t){return(0,r.a)(n,t)}function n(t,e){let i={};for(let r of e)r in t&&(i[r]=t[r]);return i}},51560:function(t,e,i){"use strict";i.d(e,{a:()=>s});var r=i(65751);function s(...t){return(0,r.a)(function t(e,i=[],r=[]){if("function"==typeof e)return e;if("object"!=typeof e||null===e)return structuredClone(e);let s=Object.getPrototypeOf(e);if(!Array.isArray(e)&&null!==s&&s!==Object.prototype)return structuredClone(e);let n=i.indexOf(e);return -1!==n?r[n]:(i.push(e),Array.isArray(e)?function(e,i,r){let s=[];for(let[n,a]of(r.push(s),e.entries()))s[n]=t(a,i,r);return s}(e,i,r):function(e,i,r){let s={};for(let[n,a]of(r.push(s),Object.entries(e)))s[n]=t(a,i,r);return s}(e,i,r))},t)}},24356:function(t,e,i){"use strict";i.d(e,{a:()=>a});var r=i(65751);function s(...t){return(0,r.a)(n,t)}var n=(t,e)=>t.length>=e;function a(...t){return(0,r.a)(l,t)}function l(t,e){if(!s(e,1))return{...t};if(!s(e,2)){let{[e[0]]:i,...r}=t;return r}let i={...t};for(let t of e)delete i[t];return i}},83361:function(t,e,i){"use strict";function r(t){if("object"!=typeof t||null===t)return!1;let e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}i.d(e,{a:()=>n});var s=i(65751);function n(...t){return(0,s.a)(function t(e,i){let s={...e,...i};for(let n in i){if(!(n in e))continue;let{[n]:a}=e;if(!r(a))continue;let{[n]:l}=i;r(l)&&(s[n]=t(a,l))}return s},t)}},2875:function(t,e,i){"use strict";i.d(e,{a:()=>n});var r={done:!1,hasNext:!1};function s(t,...e){let i=t,n=e.map(t=>"lazy"in t?function(t){let{lazy:e,lazyArgs:i}=t;return Object.assign(e(...i),{isSingle:e.single??!1,index:0,items:[]})}(t):void 0),a=0;for(;a<e.length;){var l;if(void 0===n[a]||!("string"==typeof(l=i)||"object"==typeof l&&null!==l&&Symbol.iterator in l)){i=(0,e[a])(i),a+=1;continue}let t=[];for(let i=a;i<e.length;i++){let e=n[i];if(void 0===e||(t.push(e),e.isSingle))break}let s=[];for(let e of i)if(function t(e,i,s){if(0===s.length)return i.push(e),!1;let n=e,a=r,l=!1;for(let[e,r]of s.entries()){let{index:o,items:h}=r;if(h.push(n),a=r(n,o,h),r.index+=1,a.hasNext){if(a.hasMany){for(let r of a.next)if(t(r,i,s.slice(e+1)))return!0;return l}n=a.next}if(!a.hasNext)break;a.done&&(l=!0)}return a.hasNext&&i.push(n),l}(e,s,t))break;let{isSingle:o}=t.at(-1);i=o?s[0]:s,a+=t.length}return i}function n(...t){let e=t.length-a.length;if(1===e){let[e,...i]=t;return s(e,{lazy:a,lazyArgs:i})}if(0===e){let e={lazy:a,lazyArgs:t};return Object.assign(t=>s(t,e),e)}throw Error("Wrong number of arguments")}function a(){let t=new Set;return e=>t.has(e)?r:(t.add(e),{done:!1,hasNext:!0,next:e})}},65751:function(t,e,i){"use strict";function r(t,e,i){let r=t.length-e.length;if(0===r)return t(...e);if(1===r){let r;return r=i=>t(i,...e),void 0===i?r:Object.assign(r,{lazy:i,lazyArgs:e})}throw Error("Wrong number of arguments")}i.d(e,{a:()=>r})},24709:function(t,e,i){"use strict";function r(t,e,i){function r(i,r){var s;for(let n in Object.defineProperty(i,"_zod",{value:i._zod??{},enumerable:!1}),(s=i._zod).traits??(s.traits=new Set),i._zod.traits.add(t),e(i,r),a.prototype)n in i||Object.defineProperty(i,n,{value:a.prototype[n].bind(i)});i._zod.constr=a,i._zod.def=r}let s=i?.Parent??Object;class n extends s{}function a(t){var e;let s=i?.Parent?new n:this;for(let i of(r(s,t),(e=s._zod).deferred??(e.deferred=[]),s._zod.deferred))i();return s}return Object.defineProperty(n,"name",{value:t}),Object.defineProperty(a,"init",{value:r}),Object.defineProperty(a,Symbol.hasInstance,{value:e=>!!i?.Parent&&e instanceof i.Parent||e?._zod?.traits?.has(t)}),Object.defineProperty(a,"name",{value:t}),a}i.d(e,{O7:()=>im,Km:()=>iR,Z_:()=>eQ,Yj:()=>ib,G0:()=>iE,IX:()=>iM,i0:()=>iD,Rx:()=>id,o4:()=>eJ,Ry:()=>iT,IM:()=>iO,S1:()=>i_}),Object.freeze({status:"aborted"}),Symbol("zod_brand");class s extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}let n={};function a(t){return t&&Object.assign(n,t),n}let l=/^[cC][^\s-]{8,}$/,o=/^[0-9a-z]+$/,h=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,u=/^[0-9a-vA-V]{20}$/,d=/^[A-Za-z0-9]{27}$/,c=/^[a-zA-Z0-9_-]{21}$/,p=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,g=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,f=t=>t?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,m=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,y=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,_=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,v=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,b=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,x=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,S=/^[A-Za-z0-9_-]*$/,k=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,A=/^\+(?:[0-9]){6,14}[0-9]$/,M="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",w=RegExp(`^${M}$`);function T(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof t.precision?-1===t.precision?`${e}`:0===t.precision?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}let C=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${e}$`)},E=/^\d+$/,B=/^-?\d+(?:\.\d+)?/i,P=/true|false/i,O=/undefined/i,I=/^[^A-Z]*$/,R=/^[^a-z]*$/;function L(t,e){return"bigint"==typeof e?e.toString():e}function D(t){return{get value(){{let e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function F(t){let e=+!!t.startsWith("^"),i=t.endsWith("$")?t.length-1:t.length;return t.slice(e,i)}let z=Symbol("evaluating");function j(t,e,i){let r;Object.defineProperty(t,e,{get(){if(r!==z)return void 0===r&&(r=z,r=i()),r},set(i){Object.defineProperty(t,e,{value:i})},configurable:!0})}function H(t,e,i){Object.defineProperty(t,e,{value:i,writable:!0,enumerable:!0,configurable:!0})}function N(...t){let e={};for(let i of t)Object.assign(e,Object.getOwnPropertyDescriptors(i));return Object.defineProperties({},e)}function V(t){return JSON.stringify(t)}let W="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function U(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}let G=D(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(t){return!1}});function Z(t){if(!1===U(t))return!1;let e=t.constructor;if(void 0===e)return!0;let i=e.prototype;return!1!==U(i)&&!1!==Object.prototype.hasOwnProperty.call(i,"isPrototypeOf")}let $=new Set(["string","number","symbol"]);function Y(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function X(t,e,i){let r=new t._zod.constr(e??t._zod.def);return(!e||i?.parent)&&(r._zod.parent=t),r}function K(t){if(!t)return{};if("string"==typeof t)return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");t.error=t.message}return(delete t.message,"string"==typeof t.error)?{...t,error:()=>t.error}:t}let q={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Q(t,e=0){for(let i=e;i<t.issues.length;i++)if(t.issues[i]?.continue!==!0)return!0;return!1}function J(t,e){return e.map(e=>(e.path??(e.path=[]),e.path.unshift(t),e))}function te(t){return"string"==typeof t?t:t?.message}function ti(t,e,i){let r={...t,path:t.path??[]};return t.message||(r.message=te(t.inst?._zod.def?.error?.(t))??te(e?.error?.(t))??te(i.customError?.(t))??te(i.localeError?.(t))??"Invalid input"),delete r.inst,delete r.continue,e?.reportInput||delete r.input,r}function tr(t){return Array.isArray(t)?"array":"string"==typeof t?"string":"unknown"}function ts(...t){let[e,i,r]=t;return"string"==typeof e?{message:e,code:"custom",input:i,inst:r}:{...e}}let tn=r("$ZodCheck",(t,e)=>{var i;t._zod??(t._zod={}),t._zod.def=e,(i=t._zod).onattach??(i.onattach=[])}),ta={number:"number",bigint:"bigint",object:"date"},tl=r("$ZodCheckLessThan",(t,e)=>{tn.init(t,e);let i=ta[typeof e.value];t._zod.onattach.push(t=>{let i=t._zod.bag,r=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<r&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value<=e.value:r.value<e.value)||r.issues.push({origin:i,code:"too_big",maximum:e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),to=r("$ZodCheckGreaterThan",(t,e)=>{tn.init(t,e);let i=ta[typeof e.value];t._zod.onattach.push(t=>{let i=t._zod.bag,r=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>r&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value>=e.value:r.value>e.value)||r.issues.push({origin:i,code:"too_small",minimum:e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),th=r("$ZodCheckMultipleOf",(t,e)=>{tn.init(t,e),t._zod.onattach.push(t=>{var i;(i=t._zod.bag).multipleOf??(i.multipleOf=e.value)}),t._zod.check=i=>{if(typeof i.value!=typeof e.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof i.value?i.value%e.value===BigInt(0):0===function(t,e){let i=(t.toString().split(".")[1]||"").length,r=e.toString(),s=(r.split(".")[1]||"").length;if(0===s&&/\d?e-\d?/.test(r)){let t=r.match(/\d?e-(\d?)/);t?.[1]&&(s=Number.parseInt(t[1]))}let n=i>s?i:s;return Number.parseInt(t.toFixed(n).replace(".",""))%Number.parseInt(e.toFixed(n).replace(".",""))/10**n}(i.value,e.value))||i.issues.push({origin:typeof i.value,code:"not_multiple_of",divisor:e.value,input:i.value,inst:t,continue:!e.abort})}}),tu=r("$ZodCheckNumberFormat",(t,e)=>{tn.init(t,e),e.format=e.format||"float64";let i=e.format?.includes("int"),r=i?"int":"number",[s,n]=q[e.format];t._zod.onattach.push(t=>{let r=t._zod.bag;r.format=e.format,r.minimum=s,r.maximum=n,i&&(r.pattern=E)}),t._zod.check=a=>{let l=a.value;if(i){if(!Number.isInteger(l))return void a.issues.push({expected:r,format:e.format,code:"invalid_type",continue:!1,input:l,inst:t});if(!Number.isSafeInteger(l))return void(l>0?a.issues.push({input:l,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!e.abort}):a.issues.push({input:l,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!e.abort}))}l<s&&a.issues.push({origin:"number",input:l,code:"too_small",minimum:s,inclusive:!0,inst:t,continue:!e.abort}),l>n&&a.issues.push({origin:"number",input:l,code:"too_big",maximum:n,inst:t})}}),td=r("$ZodCheckMaxLength",(t,e)=>{var i;tn.init(t,e),(i=t._zod.def).when??(i.when=t=>{let e=t.value;return null!=e&&void 0!==e.length}),t._zod.onattach.push(t=>{let i=t._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(t._zod.bag.maximum=e.maximum)}),t._zod.check=i=>{let r=i.value;if(r.length<=e.maximum)return;let s=tr(r);i.issues.push({origin:s,code:"too_big",maximum:e.maximum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),tc=r("$ZodCheckMinLength",(t,e)=>{var i;tn.init(t,e),(i=t._zod.def).when??(i.when=t=>{let e=t.value;return null!=e&&void 0!==e.length}),t._zod.onattach.push(t=>{let i=t._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(t._zod.bag.minimum=e.minimum)}),t._zod.check=i=>{let r=i.value;if(r.length>=e.minimum)return;let s=tr(r);i.issues.push({origin:s,code:"too_small",minimum:e.minimum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),tp=r("$ZodCheckLengthEquals",(t,e)=>{var i;tn.init(t,e),(i=t._zod.def).when??(i.when=t=>{let e=t.value;return null!=e&&void 0!==e.length}),t._zod.onattach.push(t=>{let i=t._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=i=>{let r=i.value,s=r.length;if(s===e.length)return;let n=tr(r),a=s>e.length;i.issues.push({origin:n,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:i.value,inst:t,continue:!e.abort})}}),tg=r("$ZodCheckStringFormat",(t,e)=>{var i,r;tn.init(t,e),t._zod.onattach.push(t=>{let i=t._zod.bag;i.format=e.format,e.pattern&&(i.patterns??(i.patterns=new Set),i.patterns.add(e.pattern))}),e.pattern?(i=t._zod).check??(i.check=i=>{e.pattern.lastIndex=0,e.pattern.test(i.value)||i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(r=t._zod).check??(r.check=()=>{})}),tf=r("$ZodCheckRegex",(t,e)=>{tg.init(t,e),t._zod.check=i=>{e.pattern.lastIndex=0,e.pattern.test(i.value)||i.issues.push({origin:"string",code:"invalid_format",format:"regex",input:i.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),tm=r("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=I),tg.init(t,e)}),ty=r("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=R),tg.init(t,e)}),t_=r("$ZodCheckIncludes",(t,e)=>{tn.init(t,e);let i=Y(e.includes),r=new RegExp("number"==typeof e.position?`^.{${e.position}}${i}`:i);e.pattern=r,t._zod.onattach.push(t=>{let e=t._zod.bag;e.patterns??(e.patterns=new Set),e.patterns.add(r)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),tv=r("$ZodCheckStartsWith",(t,e)=>{tn.init(t,e);let i=RegExp(`^${Y(e.prefix)}.*`);e.pattern??(e.pattern=i),t._zod.onattach.push(t=>{let e=t._zod.bag;e.patterns??(e.patterns=new Set),e.patterns.add(i)}),t._zod.check=i=>{i.value.startsWith(e.prefix)||i.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:i.value,inst:t,continue:!e.abort})}}),tb=r("$ZodCheckEndsWith",(t,e)=>{tn.init(t,e);let i=RegExp(`.*${Y(e.suffix)}$`);e.pattern??(e.pattern=i),t._zod.onattach.push(t=>{let e=t._zod.bag;e.patterns??(e.patterns=new Set),e.patterns.add(i)}),t._zod.check=i=>{i.value.endsWith(e.suffix)||i.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:i.value,inst:t,continue:!e.abort})}}),tx=r("$ZodCheckOverwrite",(t,e)=>{tn.init(t,e),t._zod.check=t=>{t.value=e.tx(t.value)}});class tS{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if("function"==typeof t){t(this,{execution:"sync"}),t(this,{execution:"async"});return}let e=t.split("\n").filter(t=>t),i=Math.min(...e.map(t=>t.length-t.trimStart().length));for(let t of e.map(t=>t.slice(i)).map(t=>" ".repeat(2*this.indent)+t))this.content.push(t)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(t=>`  ${t}`)].join("\n"))}}let tk=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,L,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},tA=r("$ZodError",tk),tM=r("$ZodError",tk,{Parent:Error}),tw=t=>(e,i,r)=>{let n=r?{...r,async:!1}:{async:!1},l=e._zod.run({value:i,issues:[]},n);if(l instanceof Promise)throw new s;return l.issues.length?{success:!1,error:new(t??tA)(l.issues.map(t=>ti(t,n,a())))}:{success:!0,data:l.value}},tT=tw(tM),tC=t=>async(e,i,r)=>{let s=r?Object.assign(r,{async:!0}):{async:!0},n=e._zod.run({value:i,issues:[]},s);return n instanceof Promise&&(n=await n),n.issues.length?{success:!1,error:new t(n.issues.map(t=>ti(t,s,a())))}:{success:!0,data:n.value}},tE=tC(tM),tB={major:4,minor:0,patch:14},tP=r("$ZodType",(t,e)=>{var i;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=tB;let r=[...t._zod.def.checks??[]];for(let e of(t._zod.traits.has("$ZodCheck")&&r.unshift(t),r))for(let i of e._zod.onattach)i(t);if(0===r.length)(i=t._zod).deferred??(i.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let e=(t,e,i)=>{let r,n=Q(t);for(let a of e){if(a._zod.def.when){if(!a._zod.def.when(t))continue}else if(n)continue;let e=t.issues.length,l=a._zod.check(t);if(l instanceof Promise&&i?.async===!1)throw new s;if(r||l instanceof Promise)r=(r??Promise.resolve()).then(async()=>{await l,t.issues.length!==e&&(n||(n=Q(t,e)))});else{if(t.issues.length===e)continue;n||(n=Q(t,e))}}return r?r.then(()=>t):t};t._zod.run=(i,n)=>{let a=t._zod.parse(i,n);if(a instanceof Promise){if(!1===n.async)throw new s;return a.then(t=>e(t,r,n))}return e(a,r,n)}}t["~standard"]={validate:e=>{try{let i=tT(t,e);return i.success?{value:i.data}:{issues:i.error?.issues}}catch(i){return tE(t,e).then(t=>t.success?{value:t.data}:{issues:t.error?.issues})}},vendor:"zod",version:1}}),tO=r("$ZodString",(t,e)=>{tP.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??C(t._zod.bag),t._zod.parse=(i,r)=>{if(e.coerce)try{i.value=String(i.value)}catch(t){}return"string"==typeof i.value||i.issues.push({expected:"string",code:"invalid_type",input:i.value,inst:t}),i}}),tI=r("$ZodStringFormat",(t,e)=>{tg.init(t,e),tO.init(t,e)}),tR=r("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=g),tI.init(t,e)}),tL=r("$ZodUUID",(t,e)=>{if(e.version){let t={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(void 0===t)throw Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=f(t))}else e.pattern??(e.pattern=f());tI.init(t,e)}),tD=r("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=m),tI.init(t,e)}),tF=r("$ZodURL",(t,e)=>{tI.init(t,e),t._zod.check=i=>{try{let r=i.value.trim(),s=new URL(r);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(s.hostname)||i.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:k.source,input:i.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||i.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:i.value,inst:t,continue:!e.abort})),e.normalize?i.value=s.href:i.value=r;return}catch(r){i.issues.push({code:"invalid_format",format:"url",input:i.value,inst:t,continue:!e.abort})}}}),tz=r("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),tI.init(t,e)}),tj=r("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=c),tI.init(t,e)}),tH=r("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=l),tI.init(t,e)}),tN=r("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=o),tI.init(t,e)}),tV=r("$ZodULID",(t,e)=>{e.pattern??(e.pattern=h),tI.init(t,e)}),tW=r("$ZodXID",(t,e)=>{e.pattern??(e.pattern=u),tI.init(t,e)}),tU=r("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=d),tI.init(t,e)}),tG=r("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=function(t){let e=T({precision:t.precision}),i=["Z"];t.local&&i.push(""),t.offset&&i.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");let r=`${e}(?:${i.join("|")})`;return RegExp(`^${M}T(?:${r})$`)}(e)),tI.init(t,e)}),tZ=r("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=w),tI.init(t,e)}),t$=r("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=RegExp(`^${T(e)}$`)),tI.init(t,e)}),tY=r("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=p),tI.init(t,e)}),tX=r("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=y),tI.init(t,e),t._zod.onattach.push(t=>{t._zod.bag.format="ipv4"})}),tK=r("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=_),tI.init(t,e),t._zod.onattach.push(t=>{t._zod.bag.format="ipv6"}),t._zod.check=i=>{try{new URL(`http://[${i.value}]`)}catch{i.issues.push({code:"invalid_format",format:"ipv6",input:i.value,inst:t,continue:!e.abort})}}}),tq=r("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=v),tI.init(t,e)}),tQ=r("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=b),tI.init(t,e),t._zod.check=i=>{let[r,s]=i.value.split("/");try{if(!s)throw Error();let t=Number(s);if(`${t}`!==s||t<0||t>128)throw Error();new URL(`http://[${r}]`)}catch{i.issues.push({code:"invalid_format",format:"cidrv6",input:i.value,inst:t,continue:!e.abort})}}});function tJ(t){if(""===t)return!0;if(t.length%4!=0)return!1;try{return atob(t),!0}catch{return!1}}let t0=r("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=x),tI.init(t,e),t._zod.onattach.push(t=>{t._zod.bag.contentEncoding="base64"}),t._zod.check=i=>{tJ(i.value)||i.issues.push({code:"invalid_format",format:"base64",input:i.value,inst:t,continue:!e.abort})}}),t1=r("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=S),tI.init(t,e),t._zod.onattach.push(t=>{t._zod.bag.contentEncoding="base64url"}),t._zod.check=i=>{!function(t){if(!S.test(t))return!1;let e=t.replace(/[-_]/g,t=>"-"===t?"+":"/");return tJ(e.padEnd(4*Math.ceil(e.length/4),"="))}(i.value)&&i.issues.push({code:"invalid_format",format:"base64url",input:i.value,inst:t,continue:!e.abort})}}),t2=r("$ZodE164",(t,e)=>{e.pattern??(e.pattern=A),tI.init(t,e)}),t3=r("$ZodJWT",(t,e)=>{tI.init(t,e),t._zod.check=i=>{!function(t,e=null){try{let i=t.split(".");if(3!==i.length)return!1;let[r]=i;if(!r)return!1;let s=JSON.parse(atob(r));if("typ"in s&&s?.typ!=="JWT"||!s.alg||e&&(!("alg"in s)||s.alg!==e))return!1;return!0}catch{return!1}}(i.value,e.alg)&&i.issues.push({code:"invalid_format",format:"jwt",input:i.value,inst:t,continue:!e.abort})}}),t5=r("$ZodNumber",(t,e)=>{tP.init(t,e),t._zod.pattern=t._zod.bag.pattern??B,t._zod.parse=(i,r)=>{if(e.coerce)try{i.value=Number(i.value)}catch(t){}let s=i.value;if("number"==typeof s&&!Number.isNaN(s)&&Number.isFinite(s))return i;let n="number"==typeof s?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return i.issues.push({expected:"number",code:"invalid_type",input:s,inst:t,...n?{received:n}:{}}),i}}),t4=r("$ZodNumber",(t,e)=>{tu.init(t,e),t5.init(t,e)}),t7=r("$ZodBoolean",(t,e)=>{tP.init(t,e),t._zod.pattern=P,t._zod.parse=(i,r)=>{if(e.coerce)try{i.value=!!i.value}catch(t){}let s=i.value;return"boolean"==typeof s||i.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:t}),i}}),t6=r("$ZodUndefined",(t,e)=>{tP.init(t,e),t._zod.pattern=O,t._zod.values=new Set([void 0]),t._zod.optin="optional",t._zod.optout="optional",t._zod.parse=(e,i)=>{let r=e.value;return void 0===r||e.issues.push({expected:"undefined",code:"invalid_type",input:r,inst:t}),e}}),t9=r("$ZodAny",(t,e)=>{tP.init(t,e),t._zod.parse=t=>t}),t8=r("$ZodUnknown",(t,e)=>{tP.init(t,e),t._zod.parse=t=>t}),et=r("$ZodNever",(t,e)=>{tP.init(t,e),t._zod.parse=(e,i)=>(e.issues.push({expected:"never",code:"invalid_type",input:e.value,inst:t}),e)});function ee(t,e,i){t.issues.length&&e.issues.push(...J(i,t.issues)),e.value[i]=t.value}let ei=r("$ZodArray",(t,e)=>{tP.init(t,e),t._zod.parse=(i,r)=>{let s=i.value;if(!Array.isArray(s))return i.issues.push({expected:"array",code:"invalid_type",input:s,inst:t}),i;i.value=Array(s.length);let n=[];for(let t=0;t<s.length;t++){let a=s[t],l=e.element._zod.run({value:a,issues:[]},r);l instanceof Promise?n.push(l.then(e=>ee(e,i,t))):ee(l,i,t)}return n.length?Promise.all(n).then(()=>i):i}});function er(t,e,i,r){t.issues.length&&e.issues.push(...J(i,t.issues)),void 0===t.value?i in r&&(e.value[i]=void 0):e.value[i]=t.value}let es=r("$ZodObject",(t,e)=>{let i,r;tP.init(t,e);let s=D(()=>{var t;let i=Object.keys(e.shape);for(let t of i)if(!(e.shape[t]instanceof tP))throw Error(`Invalid element at key "${t}": expected a Zod schema`);let r=Object.keys(t=e.shape).filter(e=>"optional"===t[e]._zod.optin&&"optional"===t[e]._zod.optout);return{shape:e.shape,keys:i,keySet:new Set(i),numKeys:i.length,optionalKeys:new Set(r)}});j(t._zod,"propValues",()=>{let t=e.shape,i={};for(let e in t){let r=t[e]._zod;if(r.values)for(let t of(i[e]??(i[e]=new Set),r.values))i[e].add(t)}return i});let a=t=>{let e=new tS(["shape","payload","ctx"]),i=s.value,r=t=>{let e=V(t);return`shape[${e}]._zod.run({ value: input[${e}], issues: [] }, ctx)`};e.write("const input = payload.value;");let n=Object.create(null),a=0;for(let t of i.keys)n[t]=`key_${a++}`;for(let t of(e.write("const newResult = {}"),i.keys)){let i=n[t],s=V(t);e.write(`const ${i} = ${r(t)};`),e.write(`
        if (${i}.issues.length) {
          payload.issues = payload.issues.concat(${i}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${s}, ...iss.path] : [${s}]
          })));
        }
        
        if (${i}.value === undefined) {
          if (${s} in input) {
            newResult[${s}] = undefined;
          }
        } else {
          newResult[${s}] = ${i}.value;
        }
      `)}e.write("payload.value = newResult;"),e.write("return payload;");let l=e.compile();return(e,i)=>l(t,e,i)},l=!n.jitless,o=l&&G.value,h=e.catchall;t._zod.parse=(n,u)=>{r??(r=s.value);let d=n.value;if(!U(d))return n.issues.push({expected:"object",code:"invalid_type",input:d,inst:t}),n;let c=[];if(l&&o&&u?.async===!1&&!0!==u.jitless)i||(i=a(e.shape)),n=i(n,u);else{n.value={};let t=r.shape;for(let e of r.keys){let i=t[e]._zod.run({value:d[e],issues:[]},u);i instanceof Promise?c.push(i.then(t=>er(t,n,e,d))):er(i,n,e,d)}}if(!h)return c.length?Promise.all(c).then(()=>n):n;let p=[],g=r.keySet,f=h._zod,m=f.def.type;for(let t of Object.keys(d)){if(g.has(t))continue;if("never"===m){p.push(t);continue}let e=f.run({value:d[t],issues:[]},u);e instanceof Promise?c.push(e.then(e=>er(e,n,t,d))):er(e,n,t,d)}return(p.length&&n.issues.push({code:"unrecognized_keys",keys:p,input:d,inst:t}),c.length)?Promise.all(c).then(()=>n):n}});function en(t,e,i,r){for(let i of t)if(0===i.issues.length)return e.value=i.value,e;let s=t.filter(t=>!Q(t));return 1===s.length?(e.value=s[0].value,s[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:i,errors:t.map(t=>t.issues.map(t=>ti(t,r,a())))}),e)}let ea=r("$ZodUnion",(t,e)=>{tP.init(t,e),j(t._zod,"optin",()=>e.options.some(t=>"optional"===t._zod.optin)?"optional":void 0),j(t._zod,"optout",()=>e.options.some(t=>"optional"===t._zod.optout)?"optional":void 0),j(t._zod,"values",()=>{if(e.options.every(t=>t._zod.values))return new Set(e.options.flatMap(t=>Array.from(t._zod.values)))}),j(t._zod,"pattern",()=>{if(e.options.every(t=>t._zod.pattern)){let t=e.options.map(t=>t._zod.pattern);return RegExp(`^(${t.map(t=>F(t.source)).join("|")})$`)}});let i=1===e.options.length,r=e.options[0]._zod.run;t._zod.parse=(s,n)=>{if(i)return r(s,n);let a=!1,l=[];for(let t of e.options){let e=t._zod.run({value:s.value,issues:[]},n);if(e instanceof Promise)l.push(e),a=!0;else{if(0===e.issues.length)return e;l.push(e)}}return a?Promise.all(l).then(e=>en(e,s,t,n)):en(l,s,t,n)}}),el=r("$ZodIntersection",(t,e)=>{tP.init(t,e),t._zod.parse=(t,i)=>{let r=t.value,s=e.left._zod.run({value:r,issues:[]},i),n=e.right._zod.run({value:r,issues:[]},i);return s instanceof Promise||n instanceof Promise?Promise.all([s,n]).then(([e,i])=>eo(t,e,i)):eo(t,s,n)}});function eo(t,e,i){if(e.issues.length&&t.issues.push(...e.issues),i.issues.length&&t.issues.push(...i.issues),Q(t))return t;let r=function t(e,i){if(e===i||e instanceof Date&&i instanceof Date&&+e==+i)return{valid:!0,data:e};if(Z(e)&&Z(i)){let r=Object.keys(i),s=Object.keys(e).filter(t=>-1!==r.indexOf(t)),n={...e,...i};for(let r of s){let s=t(e[r],i[r]);if(!s.valid)return{valid:!1,mergeErrorPath:[r,...s.mergeErrorPath]};n[r]=s.data}return{valid:!0,data:n}}if(Array.isArray(e)&&Array.isArray(i)){if(e.length!==i.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let s=0;s<e.length;s++){let n=t(e[s],i[s]);if(!n.valid)return{valid:!1,mergeErrorPath:[s,...n.mergeErrorPath]};r.push(n.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}(e.value,i.value);if(!r.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return t.value=r.data,t}let eh=r("$ZodRecord",(t,e)=>{tP.init(t,e),t._zod.parse=(i,r)=>{let s=i.value;if(!Z(s))return i.issues.push({expected:"record",code:"invalid_type",input:s,inst:t}),i;let n=[];if(e.keyType._zod.values){let a,l=e.keyType._zod.values;for(let t of(i.value={},l))if("string"==typeof t||"number"==typeof t||"symbol"==typeof t){let a=e.valueType._zod.run({value:s[t],issues:[]},r);a instanceof Promise?n.push(a.then(e=>{e.issues.length&&i.issues.push(...J(t,e.issues)),i.value[t]=e.value})):(a.issues.length&&i.issues.push(...J(t,a.issues)),i.value[t]=a.value)}for(let t in s)l.has(t)||(a=a??[]).push(t);a&&a.length>0&&i.issues.push({code:"unrecognized_keys",input:s,inst:t,keys:a})}else for(let l of(i.value={},Reflect.ownKeys(s))){if("__proto__"===l)continue;let o=e.keyType._zod.run({value:l,issues:[]},r);if(o instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(o.issues.length){i.issues.push({code:"invalid_key",origin:"record",issues:o.issues.map(t=>ti(t,r,a())),input:l,path:[l],inst:t}),i.value[o.value]=o.value;continue}let h=e.valueType._zod.run({value:s[l],issues:[]},r);h instanceof Promise?n.push(h.then(t=>{t.issues.length&&i.issues.push(...J(l,t.issues)),i.value[o.value]=t.value})):(h.issues.length&&i.issues.push(...J(l,h.issues)),i.value[o.value]=h.value)}return n.length?Promise.all(n).then(()=>i):i}}),eu=r("$ZodEnum",(t,e)=>{tP.init(t,e);let i=function(t){let e=Object.values(t).filter(t=>"number"==typeof t);return Object.entries(t).filter(([t,i])=>-1===e.indexOf(+t)).map(([t,e])=>e)}(e.entries),r=new Set(i);t._zod.values=r,t._zod.pattern=RegExp(`^(${i.filter(t=>$.has(typeof t)).map(t=>"string"==typeof t?Y(t):t.toString()).join("|")})$`),t._zod.parse=(e,s)=>{let n=e.value;return r.has(n)||e.issues.push({code:"invalid_value",values:i,input:n,inst:t}),e}}),ed=r("$ZodLiteral",(t,e)=>{if(tP.init(t,e),0===e.values.length)throw Error("Cannot create literal schema with no valid values");t._zod.values=new Set(e.values),t._zod.pattern=RegExp(`^(${e.values.map(t=>"string"==typeof t?Y(t):t?Y(t.toString()):String(t)).join("|")})$`),t._zod.parse=(i,r)=>{let s=i.value;return t._zod.values.has(s)||i.issues.push({code:"invalid_value",values:e.values,input:s,inst:t}),i}}),ec=r("$ZodTransform",(t,e)=>{tP.init(t,e),t._zod.parse=(t,i)=>{let r=e.transform(t.value,t);if(i.async)return(r instanceof Promise?r:Promise.resolve(r)).then(e=>(t.value=e,t));if(r instanceof Promise)throw new s;return t.value=r,t}});function ep(t,e){return t.issues.length&&void 0===e?{issues:[],value:void 0}:t}let eg=r("$ZodOptional",(t,e)=>{tP.init(t,e),t._zod.optin="optional",t._zod.optout="optional",j(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),j(t._zod,"pattern",()=>{let t=e.innerType._zod.pattern;return t?RegExp(`^(${F(t.source)})?$`):void 0}),t._zod.parse=(t,i)=>{if("optional"===e.innerType._zod.optin){let r=e.innerType._zod.run(t,i);return r instanceof Promise?r.then(e=>ep(e,t.value)):ep(r,t.value)}return void 0===t.value?t:e.innerType._zod.run(t,i)}}),ef=r("$ZodNullable",(t,e)=>{tP.init(t,e),j(t._zod,"optin",()=>e.innerType._zod.optin),j(t._zod,"optout",()=>e.innerType._zod.optout),j(t._zod,"pattern",()=>{let t=e.innerType._zod.pattern;return t?RegExp(`^(${F(t.source)}|null)$`):void 0}),j(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(t,i)=>null===t.value?t:e.innerType._zod.run(t,i)}),em=r("$ZodDefault",(t,e)=>{tP.init(t,e),t._zod.optin="optional",j(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(t,i)=>{if(void 0===t.value)return t.value=e.defaultValue,t;let r=e.innerType._zod.run(t,i);return r instanceof Promise?r.then(t=>ey(t,e)):ey(r,e)}});function ey(t,e){return void 0===t.value&&(t.value=e.defaultValue),t}let e_=r("$ZodPrefault",(t,e)=>{tP.init(t,e),t._zod.optin="optional",j(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(t,i)=>(void 0===t.value&&(t.value=e.defaultValue),e.innerType._zod.run(t,i))}),ev=r("$ZodNonOptional",(t,e)=>{tP.init(t,e),j(t._zod,"values",()=>{let t=e.innerType._zod.values;return t?new Set([...t].filter(t=>void 0!==t)):void 0}),t._zod.parse=(i,r)=>{let s=e.innerType._zod.run(i,r);return s instanceof Promise?s.then(e=>eb(e,t)):eb(s,t)}});function eb(t,e){return t.issues.length||void 0!==t.value||t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}let ex=r("$ZodCatch",(t,e)=>{tP.init(t,e),j(t._zod,"optin",()=>e.innerType._zod.optin),j(t._zod,"optout",()=>e.innerType._zod.optout),j(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(t,i)=>{let r=e.innerType._zod.run(t,i);return r instanceof Promise?r.then(r=>(t.value=r.value,r.issues.length&&(t.value=e.catchValue({...t,error:{issues:r.issues.map(t=>ti(t,i,a()))},input:t.value}),t.issues=[]),t)):(t.value=r.value,r.issues.length&&(t.value=e.catchValue({...t,error:{issues:r.issues.map(t=>ti(t,i,a()))},input:t.value}),t.issues=[]),t)}}),eS=r("$ZodPipe",(t,e)=>{tP.init(t,e),j(t._zod,"values",()=>e.in._zod.values),j(t._zod,"optin",()=>e.in._zod.optin),j(t._zod,"optout",()=>e.out._zod.optout),j(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(t,i)=>{let r=e.in._zod.run(t,i);return r instanceof Promise?r.then(t=>ek(t,e,i)):ek(r,e,i)}});function ek(t,e,i){return t.issues.length?t:e.out._zod.run({value:t.value,issues:t.issues},i)}let eA=r("$ZodReadonly",(t,e)=>{tP.init(t,e),j(t._zod,"propValues",()=>e.innerType._zod.propValues),j(t._zod,"values",()=>e.innerType._zod.values),j(t._zod,"optin",()=>e.innerType._zod.optin),j(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(t,i)=>{let r=e.innerType._zod.run(t,i);return r instanceof Promise?r.then(eM):eM(r)}});function eM(t){return t.value=Object.freeze(t.value),t}let ew=r("$ZodCustom",(t,e)=>{tn.init(t,e),tP.init(t,e),t._zod.parse=(t,e)=>t,t._zod.check=i=>{let r=i.value,s=e.fn(r);if(s instanceof Promise)return s.then(e=>eT(e,i,r,t));eT(s,i,r,t)}});function eT(t,e,i,r){if(!t){let t={code:"custom",input:i,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(t.params=r._zod.def.params),e.issues.push(ts(t))}}Symbol("ZodOutput"),Symbol("ZodInput");let eC=new class t{constructor(){this._map=new Map,this._idmap=new Map}add(t,...e){let i=e[0];if(this._map.set(t,i),i&&"object"==typeof i&&"id"in i){if(this._idmap.has(i.id))throw Error(`ID ${i.id} already exists in the registry`);this._idmap.set(i.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){let e=this._map.get(t);return e&&"object"==typeof e&&"id"in e&&this._idmap.delete(e.id),this._map.delete(t),this}get(t){let e=t._zod.parent;if(e){let i={...this.get(e)??{}};delete i.id;let r={...i,...this._map.get(t)};return Object.keys(r).length?r:void 0}return this._map.get(t)}has(t){return this._map.has(t)}};function eE(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...K(e)})}function eB(t,e){return new tl({check:"less_than",...K(e),value:t,inclusive:!1})}function eP(t,e){return new tl({check:"less_than",...K(e),value:t,inclusive:!0})}function eO(t,e){return new to({check:"greater_than",...K(e),value:t,inclusive:!1})}function eI(t,e){return new to({check:"greater_than",...K(e),value:t,inclusive:!0})}function eR(t,e){return new th({check:"multiple_of",...K(e),value:t})}function eL(t,e){return new td({check:"max_length",...K(e),maximum:t})}function eD(t,e){return new tc({check:"min_length",...K(e),minimum:t})}function eF(t,e){return new tp({check:"length_equals",...K(e),length:t})}function ez(t){return new tx({check:"overwrite",tx:t})}let ej=r("ZodISODateTime",(t,e)=>{tG.init(t,e),eJ.init(t,e)}),eH=r("ZodISODate",(t,e)=>{tZ.init(t,e),eJ.init(t,e)}),eN=r("ZodISOTime",(t,e)=>{t$.init(t,e),eJ.init(t,e)}),eV=r("ZodISODuration",(t,e)=>{tY.init(t,e),eJ.init(t,e)}),eW=(t,e)=>{tA.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:e=>(function(t,e){let i=e||function(t){return t.message},r={_errors:[]},s=t=>{for(let e of t.issues)if("invalid_union"===e.code&&e.errors.length)e.errors.map(t=>s({issues:t}));else if("invalid_key"===e.code)s({issues:e.issues});else if("invalid_element"===e.code)s({issues:e.issues});else if(0===e.path.length)r._errors.push(i(e));else{let t=r,s=0;for(;s<e.path.length;){let r=e.path[s];s===e.path.length-1?(t[r]=t[r]||{_errors:[]},t[r]._errors.push(i(e))):t[r]=t[r]||{_errors:[]},t=t[r],s++}}};return s(t),r})(t,e)},flatten:{value:e=>(function(t,e=t=>t.message){let i={},r=[];for(let s of t.issues)s.path.length>0?(i[s.path[0]]=i[s.path[0]]||[],i[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:i}})(t,e)},addIssue:{value:e=>{t.issues.push(e),t.message=JSON.stringify(t.issues,L,2)}},addIssues:{value:e=>{t.issues.push(...e),t.message=JSON.stringify(t.issues,L,2)}},isEmpty:{get:()=>0===t.issues.length}})};r("ZodError",eW);let eU=r("ZodError",eW,{Parent:Error}),eG=(t,e,i,r)=>{let n=i?Object.assign(i,{async:!1}):{async:!1},l=t._zod.run({value:e,issues:[]},n);if(l instanceof Promise)throw new s;if(l.issues.length){let t=new(r?.Err??eU)(l.issues.map(t=>ti(t,n,a())));throw W(t,r?.callee),t}return l.value},eZ=async(t,e,i,r)=>{let s=i?Object.assign(i,{async:!0}):{async:!0},n=t._zod.run({value:e,issues:[]},s);if(n instanceof Promise&&(n=await n),n.issues.length){let t=new(r?.Err??eU)(n.issues.map(t=>ti(t,s,a())));throw W(t,r?.callee),t}return n.value},e$=tw(eU),eY=tC(eU),eX=r("ZodType",(t,e)=>(tP.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...i)=>t.clone({...e,checks:[...e.checks??[],...i.map(t=>"function"==typeof t?{_zod:{check:t,def:{check:"custom"},onattach:[]}}:t)]}),t.clone=(e,i)=>X(t,e,i),t.brand=()=>t,t.register=(e,i)=>(e.add(t,i),t),t.parse=(e,i)=>eG(t,e,i,{callee:t.parse}),t.safeParse=(e,i)=>e$(t,e,i),t.parseAsync=async(e,i)=>eZ(t,e,i,{callee:t.parseAsync}),t.safeParseAsync=async(e,i)=>eY(t,e,i),t.spa=t.safeParseAsync,t.refine=(e,i)=>t.check(function(t,e={}){return new iX({type:"custom",check:"custom",fn:t,...K(e)})}(e,i)),t.superRefine=e=>t.check(function(t){let e=function(t,e){let i=new tn({check:"custom",...K(void 0)});return i._zod.check=t,i}(i=>(i.addIssue=t=>{"string"==typeof t?i.issues.push(ts(t,i.value,e._zod.def)):(t.fatal&&(t.continue=!1),t.code??(t.code="custom"),t.input??(t.input=i.value),t.inst??(t.inst=e),t.continue??(t.continue=!e._zod.def.abort),i.issues.push(ts(t)))},t(i.value,i)));return e}(e)),t.overwrite=e=>t.check(ez(e)),t.optional=()=>ij(t),t.nullable=()=>iN(t),t.nullish=()=>ij(iN(t)),t.nonoptional=e=>new iU({type:"nonoptional",innerType:t,...K(e)}),t.array=()=>iM(t),t.or=e=>iE([t,e]),t.and=e=>new iB({type:"intersection",left:t,right:e}),t.transform=e=>i$(t,new iF({type:"transform",transform:e})),t.default=e=>{var i,r;return i=t,r=e,new iV({type:"default",innerType:i,get defaultValue(){return"function"==typeof r?r():r}})},t.prefault=e=>{var i,r;return i=t,r=e,new iW({type:"prefault",innerType:i,get defaultValue(){return"function"==typeof r?r():r}})},t.catch=e=>{var i;return new iG({type:"catch",innerType:t,catchValue:"function"==typeof(i=e)?i:()=>i})},t.pipe=e=>i$(t,e),t.readonly=()=>new iY({type:"readonly",innerType:t}),t.describe=e=>{let i=t.clone();return eC.add(i,{description:e}),i},Object.defineProperty(t,"description",{get:()=>eC.get(t)?.description,configurable:!0}),t.meta=(...e)=>{if(0===e.length)return eC.get(t);let i=t.clone();return eC.add(i,e[0]),i},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),eK=r("_ZodString",(t,e)=>{tO.init(t,e),eX.init(t,e);let i=t._zod.bag;t.format=i.format??null,t.minLength=i.minimum??null,t.maxLength=i.maximum??null,t.regex=(...e)=>t.check(function(t,e){return new tf({check:"string_format",format:"regex",...K(e),pattern:t})}(...e)),t.includes=(...e)=>t.check(function(t,e){return new t_({check:"string_format",format:"includes",...K(e),includes:t})}(...e)),t.startsWith=(...e)=>t.check(function(t,e){return new tv({check:"string_format",format:"starts_with",...K(e),prefix:t})}(...e)),t.endsWith=(...e)=>t.check(function(t,e){return new tb({check:"string_format",format:"ends_with",...K(e),suffix:t})}(...e)),t.min=(...e)=>t.check(eD(...e)),t.max=(...e)=>t.check(eL(...e)),t.length=(...e)=>t.check(eF(...e)),t.nonempty=(...e)=>t.check(eD(1,...e)),t.lowercase=e=>t.check(new tm({check:"string_format",format:"lowercase",...K(e)})),t.uppercase=e=>t.check(new ty({check:"string_format",format:"uppercase",...K(e)})),t.trim=()=>t.check(ez(t=>t.trim())),t.normalize=(...e)=>t.check(function(t){return ez(e=>e.normalize(t))}(...e)),t.toLowerCase=()=>t.check(ez(t=>t.toLowerCase())),t.toUpperCase=()=>t.check(ez(t=>t.toUpperCase()))}),eq=r("ZodString",(t,e)=>{tO.init(t,e),eK.init(t,e),t.email=e=>t.check(new e0({type:"string",format:"email",check:"string_format",abort:!1,...K(e)})),t.url=e=>t.check(new e3({type:"string",format:"url",check:"string_format",abort:!1,...K(e)})),t.jwt=e=>t.check(new ih({type:"string",format:"jwt",check:"string_format",abort:!1,...K(e)})),t.emoji=e=>t.check(new e5({type:"string",format:"emoji",check:"string_format",abort:!1,...K(e)})),t.guid=e=>t.check(eE(e1,e)),t.uuid=e=>t.check(new e2({type:"string",format:"uuid",check:"string_format",abort:!1,...K(e)})),t.uuidv4=e=>t.check(new e2({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...K(e)})),t.uuidv6=e=>t.check(new e2({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...K(e)})),t.uuidv7=e=>t.check(new e2({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...K(e)})),t.nanoid=e=>t.check(new e4({type:"string",format:"nanoid",check:"string_format",abort:!1,...K(e)})),t.guid=e=>t.check(eE(e1,e)),t.cuid=e=>t.check(new e7({type:"string",format:"cuid",check:"string_format",abort:!1,...K(e)})),t.cuid2=e=>t.check(new e6({type:"string",format:"cuid2",check:"string_format",abort:!1,...K(e)})),t.ulid=e=>t.check(new e9({type:"string",format:"ulid",check:"string_format",abort:!1,...K(e)})),t.base64=e=>t.check(new ia({type:"string",format:"base64",check:"string_format",abort:!1,...K(e)})),t.base64url=e=>t.check(new il({type:"string",format:"base64url",check:"string_format",abort:!1,...K(e)})),t.xid=e=>t.check(new e8({type:"string",format:"xid",check:"string_format",abort:!1,...K(e)})),t.ksuid=e=>t.check(new it({type:"string",format:"ksuid",check:"string_format",abort:!1,...K(e)})),t.ipv4=e=>t.check(new ie({type:"string",format:"ipv4",check:"string_format",abort:!1,...K(e)})),t.ipv6=e=>t.check(new ii({type:"string",format:"ipv6",check:"string_format",abort:!1,...K(e)})),t.cidrv4=e=>t.check(new ir({type:"string",format:"cidrv4",check:"string_format",abort:!1,...K(e)})),t.cidrv6=e=>t.check(new is({type:"string",format:"cidrv6",check:"string_format",abort:!1,...K(e)})),t.e164=e=>t.check(new io({type:"string",format:"e164",check:"string_format",abort:!1,...K(e)})),t.datetime=e=>t.check(new ej({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...K(e)})),t.date=e=>t.check(new eH({type:"string",format:"date",check:"string_format",...K(e)})),t.time=e=>t.check(new eN({type:"string",format:"time",check:"string_format",precision:null,...K(e)})),t.duration=e=>t.check(new eV({type:"string",format:"duration",check:"string_format",...K(e)}))});function eQ(t){return new eq({type:"string",...K(t)})}let eJ=r("ZodStringFormat",(t,e)=>{tI.init(t,e),eK.init(t,e)}),e0=r("ZodEmail",(t,e)=>{tD.init(t,e),eJ.init(t,e)}),e1=r("ZodGUID",(t,e)=>{tR.init(t,e),eJ.init(t,e)}),e2=r("ZodUUID",(t,e)=>{tL.init(t,e),eJ.init(t,e)}),e3=r("ZodURL",(t,e)=>{tF.init(t,e),eJ.init(t,e)}),e5=r("ZodEmoji",(t,e)=>{tz.init(t,e),eJ.init(t,e)}),e4=r("ZodNanoID",(t,e)=>{tj.init(t,e),eJ.init(t,e)}),e7=r("ZodCUID",(t,e)=>{tH.init(t,e),eJ.init(t,e)}),e6=r("ZodCUID2",(t,e)=>{tN.init(t,e),eJ.init(t,e)}),e9=r("ZodULID",(t,e)=>{tV.init(t,e),eJ.init(t,e)}),e8=r("ZodXID",(t,e)=>{tW.init(t,e),eJ.init(t,e)}),it=r("ZodKSUID",(t,e)=>{tU.init(t,e),eJ.init(t,e)}),ie=r("ZodIPv4",(t,e)=>{tX.init(t,e),eJ.init(t,e)}),ii=r("ZodIPv6",(t,e)=>{tK.init(t,e),eJ.init(t,e)}),ir=r("ZodCIDRv4",(t,e)=>{tq.init(t,e),eJ.init(t,e)}),is=r("ZodCIDRv6",(t,e)=>{tQ.init(t,e),eJ.init(t,e)}),ia=r("ZodBase64",(t,e)=>{t0.init(t,e),eJ.init(t,e)}),il=r("ZodBase64URL",(t,e)=>{t1.init(t,e),eJ.init(t,e)}),io=r("ZodE164",(t,e)=>{t2.init(t,e),eJ.init(t,e)}),ih=r("ZodJWT",(t,e)=>{t3.init(t,e),eJ.init(t,e)}),iu=r("ZodNumber",(t,e)=>{t5.init(t,e),eX.init(t,e),t.gt=(e,i)=>t.check(eO(e,i)),t.gte=(e,i)=>t.check(eI(e,i)),t.min=(e,i)=>t.check(eI(e,i)),t.lt=(e,i)=>t.check(eB(e,i)),t.lte=(e,i)=>t.check(eP(e,i)),t.max=(e,i)=>t.check(eP(e,i)),t.int=e=>t.check(ip(e)),t.safe=e=>t.check(ip(e)),t.positive=e=>t.check(eO(0,e)),t.nonnegative=e=>t.check(eI(0,e)),t.negative=e=>t.check(eB(0,e)),t.nonpositive=e=>t.check(eP(0,e)),t.multipleOf=(e,i)=>t.check(eR(e,i)),t.step=(e,i)=>t.check(eR(e,i)),t.finite=()=>t;let i=t._zod.bag;t.minValue=Math.max(i.minimum??Number.NEGATIVE_INFINITY,i.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(i.maximum??Number.POSITIVE_INFINITY,i.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(i.format??"").includes("int")||Number.isSafeInteger(i.multipleOf??.5),t.isFinite=!0,t.format=i.format??null});function id(t){return new iu({type:"number",checks:[],...K(t)})}let ic=r("ZodNumberFormat",(t,e)=>{t4.init(t,e),iu.init(t,e)});function ip(t){return new ic({type:"number",check:"number_format",abort:!1,format:"safeint",...K(t)})}let ig=r("ZodBoolean",(t,e)=>{t7.init(t,e),eX.init(t,e)});function im(t){return new ig({type:"boolean",...K(t)})}let iy=r("ZodUndefined",(t,e)=>{t6.init(t,e),eX.init(t,e)});function i_(t){return new iy({type:"undefined",...K(t)})}let iv=r("ZodAny",(t,e)=>{t9.init(t,e),eX.init(t,e)});function ib(){return new iv({type:"any"})}let ix=r("ZodUnknown",(t,e)=>{t8.init(t,e),eX.init(t,e)});function iS(){return new ix({type:"unknown"})}let ik=r("ZodNever",(t,e)=>{et.init(t,e),eX.init(t,e)}),iA=r("ZodArray",(t,e)=>{ei.init(t,e),eX.init(t,e),t.element=e.element,t.min=(e,i)=>t.check(eD(e,i)),t.nonempty=e=>t.check(eD(1,e)),t.max=(e,i)=>t.check(eL(e,i)),t.length=(e,i)=>t.check(eF(e,i)),t.unwrap=()=>t.element});function iM(t,e){return new iA({type:"array",element:t,...K(e)})}let iw=r("ZodObject",(t,e)=>{es.init(t,e),eX.init(t,e),j(t,"shape",()=>e.shape),t.keyof=()=>iR(Object.keys(t._zod.def.shape)),t.catchall=e=>t.clone({...t._zod.def,catchall:e}),t.passthrough=()=>t.clone({...t._zod.def,catchall:iS()}),t.loose=()=>t.clone({...t._zod.def,catchall:iS()}),t.strict=()=>{var e;return t.clone({...t._zod.def,catchall:new ik({type:"never",...K(void 0)})})},t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=e=>(function(t,e){if(!Z(e))throw Error("Invalid input to extend: expected a plain object");let i=N(t._zod.def,{get shape(){let i={...t._zod.def.shape,...e};return H(this,"shape",i),i},checks:[]});return X(t,i)})(t,e),t.merge=e=>(function(t,e){let i=N(t._zod.def,{get shape(){let i={...t._zod.def.shape,...e._zod.def.shape};return H(this,"shape",i),i},get catchall(){return e._zod.def.catchall},checks:[]});return X(t,i)})(t,e),t.pick=e=>(function(t,e){let i=t._zod.def,r=N(t._zod.def,{get shape(){let t={};for(let r in e){if(!(r in i.shape))throw Error(`Unrecognized key: "${r}"`);e[r]&&(t[r]=i.shape[r])}return H(this,"shape",t),t},checks:[]});return X(t,r)})(t,e),t.omit=e=>(function(t,e){let i=t._zod.def,r=N(t._zod.def,{get shape(){let r={...t._zod.def.shape};for(let t in e){if(!(t in i.shape))throw Error(`Unrecognized key: "${t}"`);e[t]&&delete r[t]}return H(this,"shape",r),r},checks:[]});return X(t,r)})(t,e),t.partial=(...e)=>(function(t,e,i){let r=N(e._zod.def,{get shape(){let r=e._zod.def.shape,s={...r};if(i)for(let e in i){if(!(e in r))throw Error(`Unrecognized key: "${e}"`);i[e]&&(s[e]=t?new t({type:"optional",innerType:r[e]}):r[e])}else for(let e in r)s[e]=t?new t({type:"optional",innerType:r[e]}):r[e];return H(this,"shape",s),s},checks:[]});return X(e,r)})(iz,t,e[0]),t.required=(...e)=>(function(t,e,i){let r=N(e._zod.def,{get shape(){let r=e._zod.def.shape,s={...r};if(i)for(let e in i){if(!(e in s))throw Error(`Unrecognized key: "${e}"`);i[e]&&(s[e]=new t({type:"nonoptional",innerType:r[e]}))}else for(let e in r)s[e]=new t({type:"nonoptional",innerType:r[e]});return H(this,"shape",s),s},checks:[]});return X(e,r)})(iU,t,e[0])});function iT(t,e){return new iw({type:"object",get shape(){return H(this,"shape",{...t}),this.shape},...K(e)})}let iC=r("ZodUnion",(t,e)=>{ea.init(t,e),eX.init(t,e),t.options=e.options});function iE(t,e){return new iC({type:"union",options:t,...K(e)})}let iB=r("ZodIntersection",(t,e)=>{el.init(t,e),eX.init(t,e)}),iP=r("ZodRecord",(t,e)=>{eh.init(t,e),eX.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function iO(t,e,i){return new iP({type:"record",keyType:t,valueType:e,...K(i)})}let iI=r("ZodEnum",(t,e)=>{eu.init(t,e),eX.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);let i=new Set(Object.keys(e.entries));t.extract=(t,r)=>{let s={};for(let r of t)if(i.has(r))s[r]=e.entries[r];else throw Error(`Key ${r} not found in enum`);return new iI({...e,checks:[],...K(r),entries:s})},t.exclude=(t,r)=>{let s={...e.entries};for(let e of t)if(i.has(e))delete s[e];else throw Error(`Key ${e} not found in enum`);return new iI({...e,checks:[],...K(r),entries:s})}});function iR(t,e){return new iI({type:"enum",entries:Array.isArray(t)?Object.fromEntries(t.map(t=>[t,t])):t,...K(e)})}let iL=r("ZodLiteral",(t,e)=>{ed.init(t,e),eX.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function iD(t,e){return new iL({type:"literal",values:Array.isArray(t)?t:[t],...K(e)})}let iF=r("ZodTransform",(t,e)=>{ec.init(t,e),eX.init(t,e),t._zod.parse=(i,r)=>{i.addIssue=r=>{"string"==typeof r?i.issues.push(ts(r,i.value,e)):(r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=i.value),r.inst??(r.inst=t),i.issues.push(ts(r)))};let s=e.transform(i.value,i);return s instanceof Promise?s.then(t=>(i.value=t,i)):(i.value=s,i)}}),iz=r("ZodOptional",(t,e)=>{eg.init(t,e),eX.init(t,e),t.unwrap=()=>t._zod.def.innerType});function ij(t){return new iz({type:"optional",innerType:t})}let iH=r("ZodNullable",(t,e)=>{ef.init(t,e),eX.init(t,e),t.unwrap=()=>t._zod.def.innerType});function iN(t){return new iH({type:"nullable",innerType:t})}let iV=r("ZodDefault",(t,e)=>{em.init(t,e),eX.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap}),iW=r("ZodPrefault",(t,e)=>{e_.init(t,e),eX.init(t,e),t.unwrap=()=>t._zod.def.innerType}),iU=r("ZodNonOptional",(t,e)=>{ev.init(t,e),eX.init(t,e),t.unwrap=()=>t._zod.def.innerType}),iG=r("ZodCatch",(t,e)=>{ex.init(t,e),eX.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap}),iZ=r("ZodPipe",(t,e)=>{eS.init(t,e),eX.init(t,e),t.in=e.in,t.out=e.out});function i$(t,e){return new iZ({type:"pipe",in:t,out:e})}let iY=r("ZodReadonly",(t,e)=>{eA.init(t,e),eX.init(t,e),t.unwrap=()=>t._zod.def.innerType}),iX=r("ZodCustom",(t,e)=>{ew.init(t,e),eX.init(t,e)})}}]);